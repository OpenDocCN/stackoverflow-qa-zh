# StackOverflow 问答 000553000-000553999

# c# - ASP.NET 事件处理

> ID：553002
> 
> 赞同：0
> 
> 时间：2009-02-16T11:24:19.070
> 
> 标签：c#, asp.net

我为 ASP.Net 创建了一个服务器控件。为了简短而准确，我只列出我所做的事情：

(1) 在 OnInit 中调用 EnsureChildControls

(2)在CreateChildControls中创建动态表：

```
Table aTable = new Table();
aTable.ID = this.ID + "$" + T;
TableRow aRow = new TableRow();
aRow.ID = aTable.ID + "$R" + <COUNTER>.ToString();
TableCell aCell = new TableCell();

createLinkButton(row, col, caption, aCell, aRow.ID);

this.Controls.Add(aTable); 
```

(3) 具有如下功能：

```
void aLinkButton_Command(object sender, CommandEventArgs e)
{
    // Some stuff
    return;
} 
```

(4) 具有如下功能：

```
void createLinkButton(int row, int col, string caption, TableCell aCell, string baseID) {
    LinkButton lb = new LinkButton();
    lb.ID = baseID + "$" + row.ToString() + col.ToString();
    lb.Command += new CommandEventHandler(aLinkButton_Command);
    lb.Text = caption;
    lb.CommandName = "<command>";
    aCell.Controls.Add(lb);
    return;
} 
```

但是：该事件永远不会被调用。href 为回发而重做，但连线事件永远不会被触发。

没有想法了:(

有任何想法吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T11:39:22.340

您将需要在 Postback 上重新创建动态创建的 LinkBut​​ton 以触发关联的 EventHander。我强烈建议您阅读 Scott Mitchell关于该主题的[经典文章，而不是解释整个事情。](http://aspnet.4guysfromrolla.com/articles/092904-1.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T11:33:39.203

您是否将表添加到服务器控件 .Controls 集合中，例如

```
this.Controls.Add(aTable); 
```

从您的代码示例中看起来不像，所以我认为这可能是问题所在

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T12:49:17.027

我认为实现[IPostBackEventHandler 接口](http://msdn.microsoft.com/en-us/library/system.web.ui.ipostbackeventhandler.aspx)可能会有所帮助。

在您的情况下，您可以实现接口，并在 RisePostBackEvent 中调用您的事件处理程序方法。

希望这可以帮助 ！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T04:52:07.990

查看您使用服务器控件的页面（.aspx 文件）。确保在初始请求*和回发请求*中都将控件添加到页面的控件树中。所有事件都在回发请求上处理，如果在回发期间不存在生成事件的控件，则事件处理程序将永远不会触发。

# lotus-notes - 如何选择过去 7 天的所有文件？

> ID：553003
> 
> 赞同：4
> 
> 时间：2009-02-16T11:25:07.180
> 
> 标签：lotus-notes, lotus-domino, lotus-formula

我有一个视图选择公式

```
SELECT @If( @Date(@Now) = @Date(@Created); @All; @False) 
```

我希望它选择过去 7 天的所有文件，而不仅仅是今天的文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-30T12:49:26.560

你需要2个部分。视图选择公式：

```
SELECT isnotyet7daysOld = @True 
```

和一个（或两个）代理，它们按计划运行，并且在“创建或更改文档时”运行。代理看起来像这样（两者）

```
minDate := @Adjust(@Today;0;0;-7;0;0;0);
REM "There are no future documents";
tmpResult := @if(minDate <= @Created;@False;@True);
SELECT tmpResult != isnotyet7daysOld;
FIELD isnotyet7daysOld := tmpResult 
```

对于调整，您需要 0 而不是 null；null 恰好起作用，因为没有名称为 null 的字段或变量，并且@Formula 是宽容的，并使缺失值为 0。 **这里的技巧**：您计算字段 isnotyet7daysOld 对所选文档应该具有的值（这将是更改了 onChange 代理或所有计划代理上的），然后选择仅更改结果不匹配的那些。这样，您可以最大限度地减少文档更新。保存的文档也会直接更新。如果您现在添加一个隐藏的computed-when-composed 字段isnotyet7daysOld，并将@True 作为字段值，您可以可靠地捕获所有文档。而且您只需每晚 (0:01) 运行一次计划代理。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T11:35:22.693

```
SELECT @If( @Date(@Now) < @Date(@Adjust(@Created(), null, null, 7, null, null, null)); @All; @False) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-26T15:26:56.097

这是我所做的（我使用`@TextToTime("Today")`而不是`@Today`避免根据上述警告重建索引）：

```
SELECT (@Created) >= @Adjust(@TextToTime("Today");0;0;-7;0;0;0) 
```

顺便说一句，感谢上述提示。很长一段时间以来，我一直想创建一个这样的视图。我是 z/OS 系统程序员（大型机），并且由于“固定”视图设计公式不是相对日期，因此必须每周重建此视图以使其保持最新状态。我`@TextToTime`从 Notes 帮助中的示例中获得了提示`@Created`（这有一个获取当月文档的示例）。我的 Notes 客户端是 6.5 版。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T12:42:25.123

您需要非常小心其中包含日期的视图选择公式。

如果您使用@Today 或@Now，那么Notes/Domino 将始终认为视图中的所有文档都没有数据，并且每次访问时都必须重建索引。这对于非常小的数据库来说是可以的，但对于较大的数据库来说是一场灾难。

有些人会尝试使用@date("Today") 之类的公式来解决这个问题。Notes/Domino 不会将其识别为基于日期/时间的公式，因为它不包含 @Today 或 @Now，并且最初会起作用。但是你会发现除非索引完全刷新，否则视图不会删除旧文档，这可能很难安排。

解决此问题的最佳方法是让代理每晚运行，以使用正确的固定日期值更新选择公式。[codestore.net](http://condestore.net)的Jake Howlett有一些关于这方面的[优秀](http://www.codestore.net/store.nsf/unid/BLOG-20080311?OpenDocument)文章。

# iphone - 在现有 UIWebView 中加载新网页

> ID：553007
> 
> 赞同：0
> 
> 时间：2009-02-16T11:26:46.740
> 
> 标签：iphone

大家好，我正在开发一个 iPhone 应用程序。因为我面临一个功能模块障碍，我需要在特定的 UIWebView 中加载多个 Web 链接，类似于网页中的 iframe 概念，这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T21:06:31.730

为什么不只使用 iframe？webview 应该正确地呈现它们。

# c# - FormClosing 属性的问题

> ID：553009
> 
> 赞同：1
> 
> 时间：2009-02-16T11:26:59.923
> 
> 标签：c#, winforms, events

我想设置一个属性，当用户单击标题栏中的 X 按钮时，它会检查某些条件是否所有条件都为真，如果不是则退出，然后什么也不做并返回表单..

但我注意到 FormClosing 属性退出应用程序但是这是我的条件......那么如何做我的场景？！？

我正在使用 Visual Studio 2005 - C#

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T11:30:20.443

在`FormClosing`事件中，设置`e.Cancel`为`true`返回之前。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T11:31:52.843

如果您已经为 FormClosing 事件创建了处理程序，只需将该`FormClosingEventArgs.Cancel`属性设置为 True 即可取消窗体的关闭。

```
private void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
  if(myConditionsAreMet == false)
    e.Cancel = true;
} 
```

# python - python excel制作报告

> ID：553019
> 
> 赞同：5
> 
> 时间：2009-02-16T11:30:16.437
> 
> 标签：python, excel

我的任务是将我的代码（fortran）与 py（2.5）连接起来，并在可能的情况下生成一些 excel 报告。第一部分进展顺利 - 已经完成，但现在我正在研究第二部分。

从 python 制作 excel（如果可能的话，2007）工作表有哪些选择？一般来说，我需要将一些数组值放入表格中（格式无关紧要），并从这些表格中绘制一些图表。有没有办法自动做到这一点？一些图书馆？

过去有人做过这样的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T11:49:52.830

您最简单的方法是使用 Python 的[csv](http://www.python.org/doc/2.5.2/lib/module-csv.html)库来创建一个简单的 CSV 文件。Excel 可以毫不费力地导入这些内容。

然后你做 Excel 的东西，用 CSV 表格创建的页面制作图表。

有一些从 Python 中控制 Excel 的方法。有关示例，请参见[http://code.activestate.com/recipes/528870/ 。](http://code.activestate.com/recipes/528870/)该示例引用了其他项目。

此外，您可以使用[pyExcelerator](http://sourceforge.net/projects/pyexcelerator)或[xlwt](http://pypi.python.org/pypi/xlwt)创建更完整的 Excel 工作簿。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T11:45:42.123

我相信你有两个选择：

1.  从 Python 控制 Excel（使用 pywin32，请参阅[此问题](https://stackoverflow.com/questions/441758/driving-excel-from-python-in-windows/445961)）。需要 Windows 和 Excel。
2.  使用[xlwt](http://pypi.python.org/pypi/xlwt)纯 Python 库。

xlwt我没试过，不知道能不能处理图表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T11:59:45.803

[PyExcelerator](http://sourceforge.net/projects/pyexcelerator)有一些你需要解决的怪癖（至少在我上次使用它时是这样），但它会很好地完成这项工作。

我没有尝试过[xlwt](http://pypi.python.org/pypi/xlwt)，但由于它是 PyExcelerator 的一个分支，人们可能会怀疑它具有所有相同的功能，并且希望少一些怪癖。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T20:41:25.597

@S.Lott 涵盖了大部分基础。您也可以考虑生成 HTML `<table>`。这是我通过快速搜索找到的示例：[使用 Python 和 Django 创建 Excel 文件](http://www.developer.com/lang/other/print.php/10942_3727616_2)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T23:53:40.017

[PyPi 上有一个名为xlutils](http://pypi.python.org/pypi/xlutils/)的包，它可能会有所帮助，还有[来自 Chris Withers 的这个演示文稿](http://www.simplistix.co.uk/presentations/python_excel_08/python_excel_08.pdf)（我认为来自上一个 EuroPython 的闪电演讲），您可以在其中看到一些带有 xlrd 和 xlwt 的示例代码。看起来很容易;-)

希望有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-06-05T07:16:48.133

XslxWriter 是一个非常优秀且功能非常完整的 python 包，用于生成 Excel 工作表。

[https://github.com/jmcnamara/XlsxWriter](https://github.com/jmcnamara/XlsxWriter)（文档：[https](https://xlsxwriter.readthedocs.org/index.html) ://xlsxwriter.readthedocs.org/index.html ）。

# windows - 什么是最小的 Windows (PE) 可执行文件？

> ID：553029
> 
> 赞同：39
> 
> 时间：2009-02-16T11:33:44.587
> 
> 标签：windows, winapi, executable, portability, portable-executable

作为编写编译器的先驱，我试图了解 Windows（32 位）可移植可执行文件格式。特别是我想看一个简单的可执行文件的例子，它除了正确加载、运行和退出之外什么都不做。

我尝试编写和编译一个简单的 C 主函数，它只执行生成的 .exe 约 22KB 并包含许多来自 KERNEL32.DLL 的导入（可能由 LIBC 用于设置环境、堆等）。甚至 DOS 标题也可能更小（它当前打印默认的“此程序无法在 DOS 模式下运行”）。

最小的 Windows 32 位可执行文件的结构是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2017-11-15T15:47:44.100

引用自源代码（[创建尽可能小的 PE 可执行文件](http://archive.is/w01DO#selection-265.0-265.44)）：¹

> *   最小的 PE 文件：97 字节
> *   Windows 2000 上最小的 PE 文件：133 字节
> *   通过 WebDAV 下载文件并执行的最小 PE 文件：133 字节
> 
> 由于 PE 文件格式的要求，上述文件是可能的最小 PE 文件，无法进一步改进。

这个结果是通过一些巧妙的 NASM 技巧实现的，例如删除链接到 C 的步骤`stdlib`并删除一些标题字段和数据目录。

完整的源代码如下。它实际上与具有这些修改的文章相同：

*   删除空行
*   `sectalign`标签重命名为`sect_align`. 自从编写此汇编代码以来，`sectalign`它就成为了 NASM 关键字。重命名它以避免警告和错误。

代码如下：

```
; tiny97.asm, copyright Alexander Sotirov

BITS 32
;
; MZ header
; The only two fields that matter are e_magic and e_lfanew

mzhdr:
    dw "MZ"       ; e_magic
    dw 0          ; e_cblp UNUSED

; PE signature
pesig:
    dd "PE"       ; e_cp, e_crlc UNUSED       ; PE signature

; PE header
pehdr:
    dw 0x014C     ; e_cparhdr UNUSED          ; Machine (Intel 386)
    dw 1          ; e_minalloc UNUSED         ; NumberOfSections

;   dd 0xC3582A6A ; e_maxalloc, e_ss UNUSED   ; TimeDateStamp UNUSED

; Entry point
start:
    push byte 42
    pop eax
    ret

codesize equ $ - start

    dd 0          ; e_sp, e_csum UNUSED       ; PointerToSymbolTable UNUSED
    dd 0          ; e_ip, e_cs UNUSED         ; NumberOfSymbols UNUSED
    dw sections-opthdr ; e_lsarlc UNUSED      ; SizeOfOptionalHeader
    dw 0x103      ; e_ovno UNUSED             ; Characteristics

; PE optional header
; The debug directory size at offset 0x94 from here must be 0

filealign equ 4
sect_align equ 4  ; must be 4 because of e_lfanew

%define round(n, r) (((n+(r-1))/r)*r)

opthdr:
    dw 0x10B      ; e_res UNUSED              ; Magic (PE32)
    db 8                                      ; MajorLinkerVersion UNUSED
    db 0                                      ; MinorLinkerVersion UNUSED

; PE code section
sections:
    dd round(codesize, filealign)  ; SizeOfCode UNUSED  ; Name UNUSED
    dd 0  ; e_oemid, e_oeminfo UNUSED ; SizeOfInitializedData UNUSED
    dd codesize  ; e_res2 UNUSED  ; SizeOfUninitializedData UNUSED  ; VirtualSize
    dd start  ; AddressOfEntryPoint  ; VirtualAddress
    dd codesize  ; BaseOfCode UNUSED  ; SizeOfRawData
    dd start  ; BaseOfData UNUSED  ; PointerToRawData
    dd 0x400000  ; ImageBase  ; PointerToRelocations UNUSED
    dd sect_align ; e_lfanew  ; SectionAlignment  ; PointerToLinenumbers UNUSED
    dd filealign  ; FileAlignment  ; NumberOfRelocations, NumberOfLinenumbers UNUSED
    dw 4  ; MajorOperatingSystemVersion UNUSED ; Characteristics UNUSED
    dw 0  ; MinorOperatingSystemVersion UNUSED
    dw 0  ; MajorImageVersion UNUSED
    dw 0  ; MinorImageVersion UNUSED
    dw 4  ; MajorSubsystemVersion
    dw 0  ; MinorSubsystemVersion UNUSED
    dd 0  ; Win32VersionValue UNUSED
    dd round(hdrsize, sect_align)+round(codesize,sect_align) ; SizeOfImage
    dd round(hdrsize, filealign)  ; SizeOfHeaders
    dd 0  ; CheckSum UNUSED
    db 2  ; Subsystem (Win32 GUI)

hdrsize equ $ - $$
filesize equ $ - $$ 
```

要构建到可执行文件中，请使用：

```
nasm -f bin tiny97.asm -o tiny97.exe 
```

对于 GNU/Linux ELF 可执行文件，请参阅文章[“Whirlwind Tutorial on Creating Really Teensy ELF Executables for Linux”](https://archive.is/BcbHc)。**TL;DR** :`1340`字节，使用 NASM

*注意*：此答案是 J... 在 2016 年 12 月 3 日 17:31 的评论的扩展，以保留链接中找到的信息（以防万一也失效）。

* * *

1.  [小PE](http://archive.is/w01DO#selection-35.3-35.20)；亚历山大·索蒂罗夫；已于 2017 年 15 月 11 日 @ 17:50 SAST 观看

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-08-06T03:01:07.480

在 Windows XP (x32) 上，最小的 PE 可执行文件是 97 字节。在 32 位版本的 Vista 和 7 上，最小的 PE 可执行文件是 252 字节。在 64 位版本的 Windows 上，最小的 32 位可执行文件是 268 字节。在[这个论坛上](http://www.pouet.net/topic.php?which=9565)，您可以找到此类可执行文件的位图。

最小的 x64 PE 可执行文件是 268 字节。甚至可以执行这种大小的可执行文件中的每个字节。[您也可以在此论坛](http://www.pouet.net/topic.php?which=9565)上找到链接。

下面的代码是一个大小为 268 字节的 x64 PE（又名 PE32+）可执行文件。

```
; PE64smallest.asm   Aug 19, 2018 (c) DrakoPensulo
; A smallest PE32+ executable (x64)
; 
; Features:
;  - Windows Vista/7/8/10 compatible
;  - Size: 268 bytes (an executable file on x64 Windows cannot be smaller)
;  - No sections
;  - No Data Directories (in particular no imports and no TLS callbacks)
;  - Exits with code 0x2a (this executable does nothing else than that)
;
;
; Compile using FASM (https://flatassembler.net)  command line: fasm.exe PE64smallest.asm

format binary as 'exe' 
use64 

EntryPoint:
db 'MZ'     ; DOS signature
dw 0faceh

dd 00004550h    ; Signature PE\0\0
dw 8664h    ; Machine
dw 0000h    ; NumberOfSections

dd 0facefaceh   ; TimeDateStamp

dd 0facefaceh   ; PointerToSymbolTable

dd 0facefaceh   ; NumberOfSymbols

dw 0        ; SizeOfOptionalHeader      ; must be multiple of 8 not too large 
dw 002fh    ; Characteristics       ; must be bit 1=1 bit 13=0

dw 020Bh    ; PE32+ Magic
db 0fah     ; MajorLinkerVersion
db 0fah     ; MinorLinkerVersion

dd 0facefaceh   ; SizeOfCode

dd 0facefaceh   ; SizeOfInitializedData

dd 0facefaceh   ; SizeOfUninitializedData

dd start    ; AddressOfEntryPoint       ; cannot be smaller than SizeOfHeaders

dd 0facefaceh   ; BaseOfCode

dq 0000000100000000h    ; ImageBase     ; must be multiple of 64k

dd 4        ; SectionAlignment and e_lfanew ; PE header offset in file

dd 4        ; FileAlignment

dw 0faceh   ; MajorOperatingSystemVersiom

dw 0faceh   ; MinorOperatingSystemVersion

dw 0faceh   ; MajorImageVersion

dw 0faceh   ; MinorImageVersion

dw 5        ; MajorSubsystemVersion     ; >3.1 or 4  
dw 0h       ; MinorSubsystemVersion

dd 0facefaceh   ; Win32VersionValue     

dd 0400h    ; SizeOfImage           ; MSB has to be small, must be >0200h

dd start    ; SizeOfHeaders         ; SizeOfHeaders has to be < SizeOfImage

dd 0facefaceh   ; CheckSum

dw 0002h    ; Subsystem 2-GUI 3-CUI
dw 0        ; DllCharacteristics

dd 000cefaceh
dd 0        ; SizeOfStackReserve  upper dword has to be 0, MSB of lower dword has to be small

dd 000cefaceh
dd 0        ; SizeOfStackCommit  upper dword has to be 0, MSB of lower dword has to be small

dd 000cefaceh
dd 0        ; SizeOfHeapReserve  upper dword has to be 0, MSB of lower dword has to be small

dd 000cefaceh
dd 0        ; SizeOfHeapCommit  upper dword has to be 0, MSB of lower dword has to be small

dd 0facefaceh   ; LoaderFlags

dd 0        ; NumberofRvaAndSizes   

dd 0facefaceh
dd 0facefaceh   ; Export Directory Address and Size

dd 0facefaceh
dd 0facefaceh   ; Import Directory Address and Size

dd 0facefaceh   
dd 0facefaceh   ; Resource Directory Address and Size

dd 0facefaceh
dd 0facefaceh   ; Exception Directory Address and Size

dd 0facefaceh
dd 0facefaceh   ; Security Directory Address and Size

dd 0facefaceh
dd 0facefaceh   ; Base Relocation Table Address and Size

    dd 0facefaceh
dd 0facefaceh   ; Debug Directory Address and Size

dd 0facefaceh   
dd 0facefaceh   ; Architecture Specific Data Address and Size

dd 0facefaceh
dd 0facefaceh   ; RVA of GlobalPtr Directory Address and Size

dd 0facefaceh
dd 0facefaceh   ; TLS Directory Address and Size

dd 0facefaceh
dd 0facefaceh   ; Load Configuration Directory Address and Size

dd 0facefaceh
dd 0facefaceh   ; Bound Import Directory Address and Size

dd 0facefaceh
dd 0facefaceh   ; Import Address Table Address and Size

dd 0facefaceh
dd 0facefaceh   ; Delay Load Import Descriptors Address and Size

dd 0facefaceh
dd 0facefaceh   ; COM runtime Descriptors Address and Size

dd 0facefaceh

start:
push 2ah
pop rax
ret     ; Reserved Descriptor 
```

顺便说一句，在此[博客条目中](https://keyj.emphy.de/win32-pe/)，您可以找到一个小型（316 字节）x32 可执行文件，其中包含汇编源代码和许多技术细节。

# java - 无需部署组件即可对 EJB3 组件进行单元测试的最佳方法是什么

> ID：553031
> 
> 赞同：13
> 
> 时间：2009-02-16T11:34:00.997
> 
> 标签：java, jakarta-ee, mocking, ejb-3.0, maven-plugin

我想要一个 JUnit（或其他）系统，可以在模拟环境中测试企业 bean，以便在本地注入所有资源/bean 等。企业 bean 不必完成此操作。应支持各种注入。

*   我想为此提供一个 maven 插件，以便可以从 maven 构建运行测试。
*   在单元测试期间不需要事务，这需要一个完整的容器。

你知道这样的maven插件或者测试框架吗？有经验吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-16T12:21:20.853

不一定是最简单的方法，但我设法使用 JBoss 的可嵌入 EJB3.0 容器来完成这项工作，并在[Java Persistence with Hibernate的主要帮助下](http://www.manning.com/bauer2/)

首先，我不知道 maven 插件/依赖项，所以我必须在本地安装自己的：

(1)`jboss-EJB-3.0_Embeddable_ALPHA_9.zip`从下载中[下载](http://www.jboss.org/jbossejb3/)

(2) 这个 zipfile 包含两个重要的 JAR：

*   `jboss-ejb3-all.jar`
*   `thirdparty-all.jar`

(3) 将这些 JAR 安装到您的本地存储库中（使用您自己的首字母缩写而不是`nkl`）：

```
mvn install:install-file \
    -Dfile=jboss-ejb3-all.jar \
    -DgroupId=nkl.jboss.embedded \
    -DartifactId=jboss-ejb3-all \
    -Dversion=3.0-alpha-9

mvn install:install-file \
    -Dfile=thirdparty-all.jar \
    -DgroupId=nkl.jboss.embedded \
    -DartifactId=thirdparty-all \
    -Dversion=3.0-alpha-9 
```

(4) 如果一切顺利，您现在应该在本地存储库中有两个目录。

(5) 现在将以下依赖项添加到您的`pom.xml`

```
 <dependency>
      <groupId>nkl.jboss.embedded</groupId>
      <artifactId>jboss-ejb3-all</artifactId>
      <version>3.0-alpha-9</version>
    </dependency>
    <dependency>
      <groupId>nkl.jboss.embedded</groupId>
      <artifactId>thirdparty-all</artifactId>
      <version>3.0-alpha-9</version>
    </dependency> 
```

(6) 我还需要为[HSQLDB](http://hsqldb.org/)和[SLF4J添加依赖项](http://www.slf4j.org/)

`conf`（7）你需要将zipfile所在目录下的一些文件复制到`src/main/resources`你的项目目录下：

*   `default.persistence.properties`
*   `ejb3-interceptors-aop.xml`
*   `embedded-jboss-beans.xml`
*   `jndi.properties`

(8) 我在以下位置创建了自己的文件`beans.xml`和`persistence.xml`文件`src/main/resources/META-INF`：

```
<?xml version="1.0" encoding="UTF-8"?>
<deployment xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="urn:jboss:bean-deployer bean-deployer_1_0.xsd" xmlns="urn:jboss:bean-deployer">
  <bean name="messageDSBootstrap" class="org.jboss.resource.adapter.jdbc.local.LocalTxDataSource">
    <property name="jndiName">java:/messageDS</property>
    <property name="driverClass">org.hsqldb.jdbcDriver
    </property>
    <property name="connectionURL">jdbc:hsqldb:test</property>
    <property name="minSize">0</property>
    <property name="maxSize">10</property>
    <property name="blockingTimeout">1000</property>
    <property name="idleTimeout">30000</property>
    <property name="transactionManager">
      <inject bean="TransactionManager" />
    </property>
    <property name="cachedConnectionManager">
      <inject bean="CachedConnectionManager" />
    </property>
    <property name="initialContextProperties">
      <inject bean="InitialContextProperties" />
    </property>
  </bean>
  <bean name="messageDS" class="java.lang.Object">
    <constructor factoryMethod="getDatasource">
      <factory bean="messageDSBootstrap" />
    </constructor>
  </bean>
</deployment>

<persistence xmlns="http://java.sun.com/xml/ns/persistence"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
  http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd"
  version="1.0">
  <persistence-unit name="jpa">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jta-data-source>java:/messageDS</jta-data-source>
    <properties>
      <property name="hibernate.dialect" value="org.hibernate.dialect.HSQLDialect" />
      <property name="hibernate.show_sql" value="true" />
      <property name="hibernate.format_sql" value="true" />
      <property name="hibernate.hbm2ddl.auto" value="create" />
    </properties>
  </persistence-unit>
</persistence> 
```

[(9) 我使用此处](http://docs.jboss.org/ejb3/embedded/embedded.html)的附加信息创建了一个如下所示的单元测试。

```
package org.nkl;

import java.io.File;

import javax.naming.InitialContext;

import org.jboss.ejb3.embedded.EJB3StandaloneBootstrap;
import org.jboss.ejb3.embedded.EJB3StandaloneDeployer;
import org.junit.Test;
import org.nkl.model.MessageHandler;

public class BasicTest {

    @Test
    public void testEjb() throws Exception {
        EJB3StandaloneBootstrap.boot(null);
        EJB3StandaloneBootstrap.deployXmlResource("META-INF/beans.xml");
        EJB3StandaloneDeployer deployer = EJB3StandaloneBootstrap
                .createDeployer();

        deployer.getArchives().add(new File("target/classes").toURI().toURL());

        deployer.create();
        deployer.start();
        InitialContext context = new InitialContext();
        MessageHandler messageHandler = (MessageHandler) context
                .lookup("MessageHandlerBean/local");
        messageHandler.saveMessages();
        messageHandler.showMessages();
        EJB3StandaloneBootstrap.shutdown();
    }
} 
```

(10) 这使用了一个简单的 SLSB，例如：

```
package org.nkl.ejb;

import java.util.List;

import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

import org.nkl.model.Message;
import org.nkl.model.MessageHandler;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@Stateless
public class MessageHandlerBean implements MessageHandler {

    @PersistenceContext
    private EntityManager em;

    Logger logger = LoggerFactory.getLogger(MessageHandlerBean.class);

    public void saveMessages() {
        logger.info("In saveMessages");
        em.persist(new Message("Hello World"));
    }

    @SuppressWarnings("unchecked")
    public void showMessages() {
        logger.info("In showMessages");
        List messages = em.createQuery(
                "select m from Message m order by m.text asc").getResultList();
        for (Object o : messages) {
            logger.info(((Message) o).getText());
        }
    }
} 
```

(11) 和 Message 实体类，如：

```
package org.nkl.model;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.persistence.Table;

@Entity
@Table(name = "MESSAGES")
public class Message {
    @Id
    @GeneratedValue
    @Column(name = "MESSAGE_ID")
    private Long id;
    @Column(name = "MESSAGE_TEXT")
    private String text;
    @ManyToOne(cascade = CascadeType.ALL)
    @JoinColumn(name = "NEXT_MESSAGE")
    private Message nextMessage;

    public Message(String text) {
        this.text = text;
    }

    Message() {}

    // setters/getters not shown.

} 
```

* * *

可以说，在这种方法中存在许多绊脚石。

尤其是与依赖顺序有关。

祝你好运！！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T04:27:35.573

我必须警告 JBoss 嵌入式是一团糟。你不需要相信我的话。亲自查看论坛。它是所有可能的方法。现在事情可能对你有用，但谁知道还有什么错误在等着你……假设你的项目会持续很长时间……那是有风险的。

你可以试试 OpenEJB。它在某些方面（在灵活性方面）受到限制，但它非常易于使用并且完全符合规范。有一些链接，例如[this](http://docs.codehaus.org/display/OPENEJB/Embedding+OpenEJB)和[this](http://openejb.apache.org/embedded-and-remotable.html)。下载并试一试。顺便说一句，OpenEJB 通过阅读 JBoss 嵌入式论坛的帖子引起了我的注意……愤怒的用户指出了替代方案。

就个人而言，我决定为我的项目创建一种模拟容器，让我可以测试几乎任何我需要的东西。对于持久性，我使用 Hibernate Entity Manager + HSQL。我花了一周的时间来实施，但我的团队（到目前为止 2 个）对此非常满意。如果可能的话，我会把它开源。

最后一个选项是[ejb3unit](http://ejb3unit.sourceforge.net/)。

# javascript - 淡入/淡出和创建/隐藏 用 javascript

> ID：553034
> 
> 赞同：3
> 
> 时间：2009-02-16T11:36:19.370
> 
> 标签：javascript, dom, internet-explorer-8, fadeout

我正在运行时创建一些。为此，我正在使用此功能：

```
function creatediv(id, html, left, top) {

if (document.getElementById(id)) 
    {
        document.getElementById(id).style.display='block';
        fadeIn(id, 300);
    }
    else
    {
        var newdiv = document.createElement('div');
        newdiv.setAttribute('id', id);
        newdiv.setAttribute("class", "warningDiv"); 
        newdiv.style.position = "absolute";
        newdiv.innerHTML = html  + '<h1>(click to close)</h1>';
        newdiv.style.left = left;
        newdiv.style.top = top;
        newdiv.onclick=function(e) {
            fadeOutAndHide(id, 300);
        };  
        document.body.appendChild(newdiv);
        fadeIn(id, 300);
    }

} 
```

此功能不适用于 IE，我不知道为什么。我没有收到这个 javascript 的错误警告。这些是淡入功能：

```
function fadeOutAndHide (id,millisec)
{
    var object = document.getElementById(id).style;
    var opacStart = 100;
    var opacEnd=0;
    var speed = Math.round(millisec / 100);
    var timer = 0;

    for(i = opacStart; i >= opacEnd; i--) {
        setTimeout("changeOpac(" + i + ",'" + id + "')",(timer * speed));
        timer++;
    } 

    var elemento = document.getElementById(id);
    if (opacEnd==0){
    elemento.style.display='none';
    }
}

function opacity(id, opacStart, opacEnd, millisec) {
    var speed = Math.round(millisec / 100);
    var timer = 0;

    if(opacStart > opacEnd) {
        for(i = opacStart; i >= opacEnd; i--) {
            setTimeout("changeOpac(" + i + ",'" + id + "')",(timer * speed));
            timer++;
        }
    } else if(opacStart < opacEnd) {
        for(i = opacStart; i <= opacEnd; i++)
            {
            setTimeout("changeOpac(" + i + ",'" + id + "')",(timer * speed));
            timer++;
        }
    }
} 
```

我遇到的另一个问题：淡出功能无法正常工作。div 消失，但是当 div 隐藏时触发事件“click”。这是淡出的功能：

```
function fadeOutAndHide (id,millisec)
{
    var object = document.getElementById(id).style;
    var opacStart = 100;
    var opacEnd=0;
    var speed = Math.round(millisec / 100);
    var timer = 0;

    for(i = opacStart; i >= opacEnd; i--) {
        setTimeout("changeOpac(" + i + ",'" + id + "')",(timer * speed));
        timer++;

    } 

    var elemento = document.getElementById(id);
    if (i==1){
    elemento.style.display='none';
    }
} 
```

那么，我能做些什么来解决这个问题呢？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T11:40:54.537

抱歉，我不知道您的代码有什么问题，但我强烈建议您使用现有的 javascript 库（例如[jQuery](http://docs.jquery.com/Effects/fadeOut#speedcallback)或[mootools](http://demos.mootools.net/Effects#)），它允许您通过一行代码实现淡入/淡出等功能，并且应该可以使用大多数浏览器。

# c# - 如何使用 PagedList 使我产生的 IEnumerable 工作

> ID：553035
> 
> 赞同：3
> 
> 时间：2009-02-16T11:37:59.630
> 
> 标签：c#, ienumerable, yield, pagedlist

我在我的项目中使用了[Troy Goode 的分页列表](http://www.squaredroot.com/post/2008/07/08/PagedList-Strikes-Back.aspx)。
通常你只需给它一个 IEnumerable、一个 startindex 和一个项目计数，它就可以工作了。
但是，现在我正在尝试为它提供一个我生成的 IEnumerable，如下所示：

```
private static IEnumerable<Color> GetColors(Query query)
{
    IndexSearcher searcher = new IndexSearcher(luceneIndexpath);
    Hits hitColl = searcher.Search(query);
    //Get all the unique colorId's
    List<int> ids = new List<int>();            
    int id = 0;
    for (int i = 0; i < hitColl.Length(); i++)
    {
        if (Int32.TryParse(hitColl.Doc(i).GetField("id").StringValue(), out id))
            ids.Add(id);                
    }
    foreach (int uniqueId in ids.Distinct<int>())
    {
        yield return ColorService.GetColor(uniqueId);
    }
} 
```

**--EDIT--** pagedList 有效，但请求我的所有 Color 对象的收益，而不仅仅是分页的对象。这当然会破坏 PagedList 的整个使用，并可能导致大量枚举。

**--EDIT--**
我认为我需要的是一种实现 Count() 的方法，这样我就可以让它从 ids.Distinct(int) 返回计数，而不是通过 ColorService.GetColor() 创建所有对象，然后计算该列表.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T11:45:08.270

1) PagedList 将至少通过它的外观遍历您的数据两次 - 一次计算它，然后一次获取正确的页面。确保这不会搞砸 - 或考虑缓存在列表或其他一些“便宜”缓冲区中以避免必须查询两次。

2）如果您`ToList()`在将结果传递给分页列表之前调用它，它看起来是否正确？

3）如果您只是使用您的`GetColors()`方法并转储它产生的所有内容，*那*看起来正确吗？

基本上，您需要尝试确定问题出在 GetColors、PagedList 还是两者之间的交互上。

编辑：“捷径” Count() 的唯一方法是实现`IList`or `IList<T>`。但是，此时您要么必须正确执行此操作，要么*只需*覆盖`Count`并`IEnumerable`再次实施。我认为调用`ToList()`和使用结果可能会快很多，除非你真的有一个不想保存在内存中的大量列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T11:41:35.330

看起来它会接受`IQueryable<T>`，所以只要打电话`.AsQueryable()`给你`IEnumerable<T>`，它应该可以工作。不过，就我个人而言，我只是使用`.Skip()`and`.Take()`来获取页面 -`[your enumerable].Skip(20).Take(10)`基于页面大小 10 的第 3 页也是如此。您可以轻松地将其包装到扩展方法中：

```
public static IEnumerable<T> GetPage<T>(
    this IEnumerable<T> source,
    int pageIndex, int pageSize)
{
    return source.Skip(pageIndex * pageSize).Take(pageSize);
} 
```

那将是`[your enumerable].GetPage(3, 10)`。

# database - 在 Django 模型中将 NULL 视为“0”

> ID：553038
> 
> 赞同：11
> 
> 时间：2009-02-16T11:38:30.440
> 
> 标签：database, django, model

我在我的 Django 应用程序中使用以下代码：

```
pictures = gallery.picture_set.annotate( score=models.Sum( 'picturevote__value' ) ).order_by( '-score' ) 
```

有一张画廊的桌子。他们每个人都有一些图片。当用户对图片投赞成票或反对票时，将插入“picturevote”中的新行并将其连接到图片。然后我可以得到图片的总分。现在我想按它们的分值排序一个画廊的图片。但是由于表连接，当根本没有投票时，得分的值可能为 NULL。尽管如此，'NULL' 的分数应被视为'0'。

有任何想法吗？

编辑：好的，这里有一些额外的解释：问题是上面示例中的聚合设置`score`为NULL。当我想显示分数时，我使用这样的东西：

```
score = self.picturevote_set.aggregate( models.Sum( 'value' ) )[ 'value__sum' ] or 0 
```

然后聚合导致 NULL（如果没有图片投票行）或某个值。如果为 NULL，or 表达式将其转换为可显示的整数值。但这只是解决了由 NULL 值引起的显示问题。当我想按照`score`第一个代码示例中的这个值对图片进行排序时，所有带有 NULL 的条目都放在有序结果集的末尾。首先是评分为正的图片，然后是评分为负的图片，然后是到目前为止没有投票赞成或反对的图片，因为它们的值为 NULL `score`。

我的问题是如何改变这种行为以使顺序正确。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2015-09-23T07:03:28.477

从 Django 1.8 开始，有一个[`Coalesce`](https://docs.djangoproject.com/en/dev/ref/models/database-functions/#coalesce)数据库功能。您的查询可能如下所示：

```
from django.db.models.functions import Coalesce    

score = self.picturevote_set.aggregate(Coalesce(models.Sum('value'), 0)) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-17T11:30:34.553

在引入注释之前，您可能曾经[`extra`](http://docs.djangoproject.com/en/dev/ref/models/querysets/#extra-select-none-where-none-params-none-tables-none-order-by-none-select-params-none)做过这样的事情，我*认为*在没有投票的情况下应该返回`0`（如果它不用于任何特定的数据库实现，您至少可以直接插入必要的`COALESCE`函数调用 - `COALESCE(SUM(value), 0)`- 使用此方法）：

```
pictures = gallery.picture_set.extra(
    select={
        'score': 'SELECT SUM(value) FROM yourapp_picturevote WHERE yourapp_picturevote.picture_id = yourapp_picture.id',
    },
    order_by=['-score']
) 
```

我看不到任何将您自己的 SQL 添加到新注释内容（我还没有亲自使用过）的内置方法，但看起来您应该能够像这样创建一个新注释：

```
from django.db.models import aggregates
from django.db.models.sql import aggregates as sql_aggregates

class SumWithDefault(aggregates.Aggregate):
    name = 'SumWithDefault'

class SQLSumWithDefault(sql_aggregates.Sum):
    sql_template = 'COALESCE(%(function)s(%(field)s), %(default)s)'

setattr(sql_aggregates, 'SumWithDefault', SQLSumWithDefault) 
```

这看起来相当难看，因为由于查找 SQL 聚合类的方式，您需要将新聚合修补到`django.db.models.sql.aggregates`其中，但我们在这里所做的只是添加一个新聚合，其中子类`Sum`，硬编码对`COALESCE`函数的调用并添加占位符对于默认值，您*必须*将其作为关键字参数提供（至少在这个非常基本的示例实现中）。

这应该让您执行以下操作：

```
pictures = gallery.picture_set.annotate(score=SumWithDefault('picturevote__value', default=0).order_by('-score') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-22T14:05:31.187

根据此[问题](https://code.djangoproject.com/ticket/10929)，您现在可以执行以下操作：

```
score = self.picturevote_set.aggregate((models.Sum('value', default=0)) 
```

如果 sum 的结果为 None 类型，则返回默认值。在这种情况下，数字 0。

注意：它是在 Django V4 中发布的

# c# - “约束类型”在 VB/C# 中有用吗？

> ID：553046
> 
> 赞同：8
> 
> 时间：2009-02-16T11:40:40.420
> 
> 标签：c#, vb.net, types, constraints

## 介绍

这个问题是由 Marc Gravell 的建议提出的，我向该站点发布新的语言功能建议以收集对它们的一般意见。

这个想法是收集他们是否可能有帮助，或者也许已经有另一种方法来实现我所追求的。

## 建议（约束类型）

VB.Net 中的普通变量声明是这样编写的：

```
Dim SomeVariable as SomeType 
```

我建议允许以下表格

```
Dim SomeVariable1 as {SomeType, ISomeInterface}
Dim SomeVariable2 as {SomeType, ISomeInterface, ISomeOtherInterface} 
```

这种语法是从 Vb.Net 的约束泛型风格中借来的

## 为什么允许这样做？...它有什么用？

那么我最初想到的具体情况是定义一个特定的控件子集。我希望为一系列控制工厂创建一个接口，这些工厂将根据一些业务规则提供控制。

这些控件的使用者将通过接口要求创建的所有控件还应该实现一些接口系列（在我的例子中只有一个），这些接口为所有这些控件提供了通常在普通控件中没有的额外设施。

值得注意的是，以下内容目前不起作用。

```
Public Interface ISpecialControl
End Interface

Public Interface IControlProvider
    Function CreateControl(Of T As {Control, ISpecialControl})() As T
End Interface

Public Class SpecialTextBoxProvider
    Implements IControlProvider
    Public Function CreateControl(Of T As {Control, ISpecialControl})() As T Implements IControlProvider.CreateControl
        Return New SpecialTextBox
    End Function
End Class

Public Class SpecialTextBox
    Inherits TextBox
    Implements ISpecialControl
    Public Sub New()

    End Sub
End Class 
```

我认为这转换为 C# 为：

```
public interface ISpecialControl
{
}

public interface IControlProvider
{
    T CreateControl<T>()
        where T : Control, ISpecialControl;
}

public class SpecialTextBoxProvider : IControlProvider
{
    public T CreateControl<T>()
        where T : Control, ISpecialControl
    {
        return new SpecialTextBox();
    }
}

public class SpecialTextBox : TextBox, ISpecialControl
{
} 
```

由于无法将 SpecialTextbox 转换为 T，返回“New SpecialTextbox”的尝试失败。

```
"Value of type 'MyApp.SpecialTextBox' cannot be converted to 'T'" 
```

我意识到我的工厂可以被允许返回简单的控件，如果它们实现了 ISpecialControl，我可以在运行时检查，但这会产生运行时问题，我宁愿在编译时检查，因为即使目前不是一个实际的可能性，这也是一种合乎逻辑的可能性

更新：想法是这些工厂可以位于外部（甚至可能是第三方）程序集中，并且可以依赖于他们想要的任何控件库，创建和返回这些控件的派生类，这些派生类也实现了 ISpecialControl。

这些程序集可以通过自配置反射（第一次通过的反射，然后是配置，然后在进一步运行中使用）定位，并且调用程序集在不知道这些控件将采取何种依赖关系的情况下使用这些程序集。

它确实要求这些工厂是可构造的，而无需传递有关它们期望调用的控件的信息，因为这会破坏这一点。

**那么你觉得……这会有用吗？……有没有更好的方法来实现这一点？有没有办法实现这一目标？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T22:32:40.260

我认为，虽然表面上有用，但这种事情最好由以下两者之一来处理：

*   Duck Typing 通过动态（在 VS2010 中出现）提供了更大的灵活性，尽管消除了类型安全性。
*   通用组成

您的原始示例都不需要，并且可以轻松地像这样工作：

```
public interface IControlProvider<T>
    where T : Control, ISpecialControl
{
    T CreateControl();
}

public class SpecialTextBoxProvider : IControlProvider<SpecialTextBox>
{
    public SpecialTextBox CreateControl()
    {
        return new SpecialTextBox();
    }
} 
```

事实上，鉴于大多数控件都有一个默认的公共构造函数，你可以让它变得更容易：

```
public class ControlProvider : IControlProvider<T>
    where T : Control, ISpecialControl, new()
{
    public T CreateControl()
    {
        return new T();
    }
}

var control = ControlProvider<SpecialTextBox>.CreateControl(); 
```

鉴于调用代码的额外限制不直接对 SpecialTextBox 进行引用依赖，这将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T04:28:10.443

这与[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)有很大不同吗？为什么不只是扩展控件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T12:43:00.643

使用接口组合怎么样？

你有

```
interface IA;
class B; 
```

如果存在，则使用 B 类的接口并制作复合材料

```
interface IB;
interface IAB : IA, IB; 
```

修改类

```
class C : B, IA 
```

实现复合接口（不应该出现问题）

```
class C : B, IAB 
```

您可以使用接口 IAB 作为约束类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T12:51:52.870

我不明白你在提议什么，我认为这是我的问题。

但是，在我看来，您想返回一个实现特定接口的控件。

为什么不能只说该方法返回该特定接口？当您在说“我想返回从 Control 继承的类，并且还实现 ISomeInterface 接口”时，这听起来对我来说。

也许解决方案是将您需要的 Control 部分提取到您自己的接口中，并指定您要返回实现这两者的对象？

像这样：

```
interface IControl { ... }
interface ISomeInterface { ... }

interface IControlInterface : IControl, ISomeInterface { ... } 
```

最后一个接口将指定您需要一个实现两个基接口的对象，这听起来像您想要的，只是您希望其中一个要求是基类，而不是接口。

我认为你可以通过使用接口来解决这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T15:29:40.457

编辑：哦，等等，我没有正确阅读，这是关于将其限制为 2 种类型，而不是选择 2 种类型。我认为你可以解决它类似于下面提到的课程......

我曾经尝试过一个类来模拟这种行为：

```
public class Choice<T1, T2> 
{
    private readonly T1 value1;
    private readonly T2 value2;

    public Choice(T1 value)
    {
        value1 = value;
    }

    public Choice(T2 value) 
    {
        value2 = value;
    }

    public static implicit operator T1(Choice<T1, T2> choice) 
    {
        return choice.value1;   
    }

    public static implicit operator T2(Choice<T1, T2> choice) 
    {
        return choice.value2;   
    }

    public static implicit operator Choice<T1, T2>(T1 choice) 
    {
        return new Choice<T1, T2>(choice);
    }

    public static implicit operator Choice<T1, T2>(T2 choice) 
    {
        return new Choice<T1, T2>(choice);
    }

    public T1 Value1
    {
        get { return value1; }
    }

    public T2 Value2
    {
        get { return value2; }
    }
} 
```

它允许您创建这样的结构：

```
[TestMethod]
public void TestChoice() 
{
    TestChoice("Hello");
    TestChoice(new []{"Hello","World"});
}

private static void TestChoice(Choice<string[], string> choice)
{
    string value = choice;
    string[] values = choice;

    if (value != null)
        Console.WriteLine("Single value passed in: " + value);

    if (values != null) {
        Console.WriteLine("Multiple values passed in ");
        foreach (string s in values)
            Console.WriteLine(s + ",");
    }
} 
```

隐式运算符的缺点是它不会对接口进行隐式转换（它确实可以从接口类型转换），因此在尝试将包含的值从to 转换回时，传入 an`IEnumerable<T>`而不是 a`string[]`将不起作用。`Choice<IEnumerable<T>, T>``IEnumerable<T>`

一般来说，我宁愿只使用重载/接口顺便说一句，所以在这里不要误会我的意思:)

在您使用属性（并且因此不能使用重载）的情况下，它会更有用，例如仅允许`list<string>`或`list<ListItem>`例如的 DataSource 属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T11:51:56.383

它比“受约束的类型”更“受约束的变量” - 但绝对有趣。与通用约束一样，如果存在冲突的成员，可能会有一些解决问题的小问题，但同样的解决方法可能适用于通用约束。

当然，务实的观点是你已经可以投射等，但是你需要保持这两个参考相互更新......

嗯……有趣。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-13T23:45:16.307

这似乎是一个有用的语言功能。除了遵守多个约束之外，可能有类型未知的方法参数，但是没有办法将这样的参数存储在字段中，以便它可以传递给这样的函数，甚至类型转换为通过了。

然而，还有另一种方法可以实现您所追求的基本结果，尽管它有点笨拙。请参阅我的问题[存储实现多个接口并从某个基础（.net）派生的对象，](https://stackoverflow.com/questions/4373259/storing-an-object-that-implements-multiple-interfaces-and-derives-from-a-certain)其中提供了我能够制定的最佳方法。

# .net - 如何在 Windows 上查询打印队列

> ID：553051
> 
> 赞同：3
> 
> 时间：2009-02-16T11:44:08.727
> 
> 标签：.net, windows

我们正在开发一个关键应用程序，需要对打印的文档进行最好的控制。为了确定打印了哪些文档，我们要检查打印机队列。

我们如何查询 Windows 上的打印队列（状态、队列列表、错误...）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T11:45:41.280

[EnumPrinters](http://msdn.microsoft.com/en-us/library/dd162692(VS.85).aspx)获取打印机列表，[EnumJobs](https://msdn.microsoft.com/en-us/library/dd162625(v=vs.85).aspx)获取该打印机的作业列表。[GetJob](http://msdn.microsoft.com/en-us/library/dd144894(VS.85).aspx)获取特定作业的信息，[SetJob](https://msdn.microsoft.com/en-us/library/dd162978(v=vs.85).aspx)更改该作业的设置（暂停或取消）。

在[打印和打印后台处理程序参考](http://msdn.microsoft.com/en-us/library/dd162863(VS.85).aspx)中查看更多信息。

.NET 有[PrintQueue](https://msdn.microsoft.com/en-us/library/system.printing.printqueue(v=vs.110).aspx)和[PrintServer](https://msdn.microsoft.com/en-us/library/system.printing.printserver(v=vs.110).aspx)类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T12:00:57.983

您可能对以下 URL 感兴趣，

[http://www.codeproject.com/KB/printing/printwatchvbnet.aspx](http://www.codeproject.com/KB/printing/printwatchvbnet.aspx)

和

[http://www.codeproject.com/KB/printing/EMFSpoolViewer.aspx](http://www.codeproject.com/KB/printing/EMFSpoolViewer.aspx)

# nhibernate - NHibernate ManyToMany 和急切加载：SetFetchmode 结合 SetResultTransformer 和 SetMaxResult 的奇怪结果集

> ID：553063
> 
> 赞同：4
> 
> 时间：2009-02-16T11:47:36.317
> 
> 标签：nhibernate, many-to-many

我有一个多对多的关系，我试图渴望得到：

```
*.CreateCriteria(typeof(Class1))
.SetFetchMode("Class2", FetchMode.Eager)
.SetResultTransformer(new DistinctRootEntityResultTransformer())
.SetFirstResult(20)
.SetMaxResult(10)
.List<Class1>(); 
```

我想返回第 20-30 行，但我有 12-18 行。为什么？因为 SetResultTransformer 在 SetMaxResult 之后执行。它从第 20 行开始返回 10 行，但随后它被区分（这是一个词吗？）导致第 12-18 行。我完全理解发生了什么，但想不出使用标准的解决方案......

有没有人有解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-08-31T21:13:27.043

这是因为 SetMaxResults 方法在“低级别”工作。我的意思是，SetMaxResults 导致 NHibernate 生成的 SQL 语句包含`TOP`or`LIMIT`子句。

当然，当您使用急切获取模式时，这会导致那些奇怪的结果，因为急切获取模式会导致 JOIN。

因此，如果您有 2 个以一对多关系连接在一起的表，则 NHibernate 返回的记录集例如如下所示

```
1 recordA-fromTable1  1 recordX-fromTable2
2 recordA-fromTable1  2 recordY-fromTable2
3 recordB-fromTable1  3 record2-fromTable2 
```

如果对上述记录集执行“TOP 2”，NHibernate 将只能从中提取一个实体，因为结果集中的前 2 条记录实际上是同一个实体。

我通过使用包含 TOP 子句的分离子查询解决了这个问题，并检索了必须检索的实体的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T20:59:00.797

我实际上并没有尝试过，但它可能会起作用。

```
 *.CreateCriteria(typeof(Class1))
    .SetFirstResult(20)
    .SetMaxResult(10)
    .CreateCriteria("Class2", JoinType.LeftOuterJoin)
    .SetResultTransformer(new DistinctRootEntityResultTransformer())
    .List<Class1>(); 
```

编辑：这不起作用。使用多查询、多条件（或使用新版本的 NH 时的 Future）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T18:21:25.270

我也有同样的问题。使用分离的标准和子查询对以下内容进行改编看起来可能很有希望。当我有时间时，我将对其进行更彻底的试验。

[http://blogs.taiga.nl/martijn/2008/11/20/nhibernate-criteria-queries-across-multiple-many-many-associations/](http://blogs.taiga.nl/martijn/2008/11/20/nhibernate-criteria-queries-across-multiple-many-many-associations/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T06:21:05.497

```
 public List<Employee> getData(int to, int from,
        String searchField, String searchString, String searchOper,
        String sord, String sidx) {

            Criteria hCriteria = null;
    List<Employee> viewDataList = null;
            List<Employee> exactDataList = null;
    try {

        hSession = HibernateSessionFactory.getSession();
        hTransaction = hSession.beginTransaction();
        hCriteria = hSession.createCriteria(Employee.class);

        if (searchString != null && searchField != null
                && searchOper != null) {
            if (searchOper.equalsIgnoreCase("eq"))

                    hCriteria.add(Restrictions
                            .eq(searchField, searchString));

            if (searchOper.equalsIgnoreCase("ne"))
                hCriteria.add(Restrictions.ne(searchField, searchString));
            if (searchOper.equalsIgnoreCase("lt"))
                hCriteria.add(Restrictions.lt(searchField, searchString));
            if (searchOper.equalsIgnoreCase("le"))
                hCriteria.add(Restrictions.le(searchField, searchString));
            if (searchOper.equalsIgnoreCase("gt"))
                hCriteria.add(Restrictions.gt(searchField, searchString));
            if (searchOper.equalsIgnoreCase("ge"))
                hCriteria.add(Restrictions.ge(searchField, searchString));
            if (searchOper.equalsIgnoreCase("cn"))
                hCriteria.add(Restrictions.ilike(searchField, searchString,
                        MatchMode.ANYWHERE));

        }

        if (sord != null && sidx != null && !sidx.equals("")) {
            if (sord.equals("asc"))
                hCriteria.addOrder(Order.asc(sidx));
            else
                hCriteria.addOrder(Order.desc(sidx));

        }

        /*
                    hCriteria.setFirstResult(to);
        hCriteria.setFirstResult(from);
                    */
        hCriteria.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY);
        viewDataList = hCriteria.list();

                  // for limit
                 exactDataList=viewDataList.subList(from,to);

                hTransaction.commit();
    } catch (Exception e) {
        hTransaction.rollback();

    } finally {
        try {
            hSession.flush();
            HibernateSessionFactory.closeSession();
        } catch (Exception hExp) {
        }

    }

    return exactDataList;

} 
```

# java - 监视对集合的更改

> ID：553067
> 
> 赞同：6
> 
> 时间：2009-02-16T11:49:18.323
> 
> 标签：java, observer-pattern, javabeans

假设您有以下 java bean：

```
public class MyBean
{
    private List<String> names = new ArrayList<String>();

    public void addName(String name)
    {
        names.add(name);
        fireNamesPropertyChange(name);
    }
} 
```

您通常如何为集合实现属性更改事件？您是否尝试使用似乎更适用于数组而不是集合的 index 属性？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-16T14:10:11.997

*（**注意**：我在意识到自己的一些错误后更新了这篇文章，所以这不是原来的，而是更精致的）*

为此，我会做两个新接口，`ListListener`然后`Listenable`我会创建一个新类，就像它会通过调用一个（或多个）相关方法来`ListenableArrayList`包装每个方法。在代码中它会是这样的：`List``ListListener`

```
public class ListenableArrayList<T> extends ArrayList<T>
                                    implements Listenable<T> {

    private ArrayList<T> internalList;
    private ListListener<T> listener;

    /* .. */

    public void add(T item) {
        listener.beforeAdd(T item);
        internalList.add(item);
        listener.afterAdd(T item);
    }

    /* .. */

    public void setListener(ListListener<T> listener) {
        this.listener = listener;
    }

}

public interface ListListener<T> {
    /* .. */
    void beforeAdd(T item);
    void afterAdd(T item);
    /* .. */
}

public interface Listenable<T> {
    /* .. */
    void setListener(ListListener<T> listener);
    /* .. */
} 
```

我这样做的原因是允许动态创建真正的临时侦听器，而不是将 ListenableArrayList 绑定到某些特定实现。例如，以下是可能的：

```
Listenable<String> list = new ListenableArrayList<String>();

list.setListener(new ListListener<String>() {
    @Override
    public void beforeAdd(String item) {
        System.out.println("About to add element "+item+"...");
    }
    @Override
    public void afterAdd(String item) {
        System.out.println("...element "+item+" has been added.");
    }
}); 
```

可能有点混乱，但另一方面，这可以很容易地扩展到 Collections、Sets 等等。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-16T14:12:29.277

看看[Glazed Lists](http://publicobject.com/glazedlists/)库，它支持可观察的集合。

如果我自己做，我可能会使用 elementsAdded、elementsRemoved 方法或类似方法创建自定义 Listener 接口:-)（也取决于我的需要）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-16T15:18:28.260

您可以使用 Observable 集合：[https ://commons.apache.org/dormant/events/apidocs/org/apache/commons/events/observable/ObservableCollection.html](https://commons.apache.org/dormant/events/apidocs/org/apache/commons/events/observable/ObservableCollection.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T04:07:39.477

通常我会做以下事情：

```
public class MyBean {
    private PropertyChangeSupport pcs = new PropertyChangeSupport(this);
    private List<String> names = new ArrayList<String>();
    public void addName(String name) {
        names.add(name);
        pcs.firePropertyChange("names", null, Collections.unmodifiableList(names));
    }
    public void addPropertyChangeListener(PropertyChangeListener l) {
        pcs.addPropertyChangeListener(l);
    }
    public void removePropertyChangeListener(PropertyChangeListener l) {
        pcs.removePropertyChangeListener(l);
    }
} 
```

PropertyChangeSupport 代表您管理侦听器并触发事件。

通过将 null 作为“旧值”传递，它会强制触发事件。（无论如何，听众很可能不会真正关心旧值）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-10-23T21:28:23.763

JDK 7+ 解决方案：

```
import javafx.collections.*;
import java.util.*;

public class Test {
    public static void main(String[] args) {
        List<String> list = new ArrayList<>();

        list.add("s1");
        list.add("s2");

        ObservableList<String> observableList = FXCollections.observableList(list);
        observableList.addListener(new ListChangeListener<String>() {
            @Override
            public void onChanged(Change<? extends String> change) {
                while(change.next()){
                    System.out.println("added: " + change.getAddedSubList());
                }
            }
        });

        observableList.add("s3");
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T11:54:06.270

对于摇摆 GUI 事件，我通常只使用[EventListenerList](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/event/EventListenerList.html)为我完成工作。

编辑：关于问题的改写：你如何对待集合，我通常会使用类似于集合类型的事件，因此例如 TreeModel 事件通常需要一个 TreePath 参数，或者对于地图中的某些东西我会指出钥匙。

然而，对于简单的 JavaBeans，最常见的是假设一个列表/数组并只使用索引。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T13:57:05.287

我认为您将需要`fireNamesPropertyAdd`, `fireNamesProperyDelete`。恕我直言，列表级别的通知将不起作用，即使它是一个数组并且添加了一个索引，因为它无法处理删除。如果可以更改某个索引处的元素，您还需要`fireNamesProperyChange`. 除了字符串值之外，将索引作为参数可能会很有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-16T15:15:28.640

你也许在寻找`java.beans.PropertyChangeSupport`？

在我看来，你应该避免`PropertyChangeEvent`. `IndexedPropertyChangeEvent`更糟糕的是，无论如何 Swing 很少使用。最好缩小类型的焦点，并触发 a`javax.swing.event.ChangeEvent`或类似的（甚至只是调用 a `Runnable`）。

对于某些类型（如列表！），Peter Štibraný 在另一篇文章中提到的 Glazed Lists（或等效项）似乎是一个不错的选择。

# jquery - 将元素添加到 jquery 对象

> ID：553068
> 
> 赞同：3
> 
> 时间：2009-02-16T11:49:43.847
> 
> 标签：jquery

我有一个像这样的缓存 jquery 对象设置

```
var comments = $('li.comment'); 
```

在创建新元素时，是否有一种简单的方法来更新**评论**对象而不是重新定义它？我正在寻找类似的东西

```
comments += $('li.newcomment'); 
```

这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T11:51:25.370

```
$("li.comment").add("li.newcomment"); 
```

# asp.net - 将控件动态添加到 ASP.NET AJAX 中的 UpdatePanel

> ID：553073
> 
> 赞同：14
> 
> 时间：2009-02-16T11:51:17.320
> 
> 标签：asp.net, ajax, updatepanel

我有以下非常简单的代码

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager>

<asp:UpdatePanel ID="UpdatePanel1" runat="server">
<ContentTemplate>
    <asp:PlaceHolder ID="PlaceHolder1" runat="server">
    </asp:PlaceHolder>
    <asp:Button ID="Button1" runat="server" Text="Button" onclick="Button1_Click" />
</ContentTemplate>
</asp:UpdatePanel> 
```

和代码隐藏

```
protected void Button1_Click(object sender, EventArgs e)
{
    Literal literal = new Literal();
    literal.Text = DateTime.Now.ToString();
    literal.ID = DateTime.Now.Ticks.ToString();

    // These both work fine the first time the button is clicked
    // but the second time nothing is added.
    UpdatePanel1.ContentTemplateContainer.Controls.Add(literal);
    PlaceHolder1.Controls.Add(literal);
} 
```

我的问题在于 Literal 控件只添加了一次。我搜索了谷歌和博客网站（加上书籍），但没有任何运气。我错过了什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-16T12:22:23.003

在 asp.net 中，ASPX 文件中的控件在每次回发时自动生成。您创建的控件不在 ASPX 代码中，因此框架不会为您创建它们。第一次执行 Button1_Click 方法时，向页面添加了一个额外的控件。第二次执行 Button1_Click 方法时，您在另一个回帖中，而第一个额外的按钮已被遗忘。所以回发的结果是你又得到了一个额外的按钮。

每次单击按钮时都会创建一个额外的控件（尽管每次按下按钮时时间戳都会更新，因为正在重新创建控件）

```
protected void Button1_Click(object sender, EventArgs e)
{
    int count = 0;

    if (ViewState["ButtonCount"] != null)
    {
        count = (int)ViewState["ButtonCount"];
    }

    count++;
    ViewState["ButtonCount"] = count;

    for (int i = 0; i < count; i++)
    {
        Literal literal = new Literal();
        literal.Text = DateTime.Now.ToString();
        literal.ID = DateTime.Now.Ticks.ToString();

        UpdatePanel1.ContentTemplateContainer.Controls.Add(literal);
        PlaceHolder1.Controls.Add(literal);
    }            
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-22T20:32:36.410

我同意上面的答案，但是这种方法不会保存动态控件的状态（或者准确地说，它会保存状态但不会加载它们）。加载视图状态在页面生命周期的加载事件部分调用，它分配回保存在视图状态中的控件值。但是，如果此时未创建控件，则无法使用以前的数据加载它们，因此要保持状态，必须在加载事件时或之前重新创建新控件。

```
protected void Page_Load(object sender, EventArgs e)
{
    //PS: Below approach saves state as id is constant, it simply generates a new control with same id hence viewstate loads the value
    if (IsPostBack)
    {
        int count = 0;

        if (ViewState["ButtonCount"] != null)
        {
            count = (int)ViewState["ButtonCount"];
        }

        count++;
        ViewState["ButtonCount"] = count;

        for (int i = 0; i < count; i++)
        {
            TextBox literal = new TextBox();
            //literal.Text = DateTime.Now.ToString();
            literal.ID = "Textbox" + i.ToString();

            //UpdatePanel1.ContentTemplateContainer.Controls.Add(literal);
            PlaceHolder1.Controls.Add(literal);

        }
    }
} 
```

[动态添加控件](https://stackoverflow.com/questions/4216329/asp-net-dynamically-created-controls-and-postback) [视图状态和回发](https://stackoverflow.com/questions/94696/in-asp-net-during-which-page-lifecycle-event-does-viewstate-get-loaded)

# css - 内部与外部 CSS

> ID：553074
> 
> 赞同：10
> 
> 时间：2009-02-16T11:51:19.723
> 
> 标签：css, httpwebrequest

内部与外部 CSS 的优缺点是什么，考虑速度、请求、缓存等。就我个人而言，我不确定动态页面上的内部 css 是否会缓存..？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-16T11:58:37.910

**内部 CSS 的优点**： - 更快的下载：请记住，您拥有的每个外部样式表都会有一个额外的 HTTP 请求

**外部 CSS 的优点**： - 网站在其所有页面上都有共同的“主题”是很常见的。您可以将所有这些常见样式集中在外部文件中，一次下载即可获得可在多个页面中使用的所需样式：节省下载时间 - 您还可以缓存外部样式并设置适当的到期日期。

反对内部 CSS 的一件事是它可以增加 html 的下载大小。

**最佳方法**： - 根据差异页面中使用的样式混合使用内部 + 外部样式 - 确保在外部样式上设置过期设置并缓存它们。

**与缓存过期设置结合的优势**：Web 应用程序的“外观”受以下因素支配：

*   您通常希望在所有页面上保持相同的“感觉”
*   内容比样式更容易频繁更改

如果您将样式放在外部 CSS 文件中并设置缓存到期时间为 1 个月，那么在此期间所有用户的“启动”延迟将非常低，因为只会下载已更改的内容：样式将从您的浏览器缓存。过期后有人第一次尝试访问您的页面时，浏览器将自动请求刷新。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-16T11:57:03.767

如果页面是可缓存的，则该页面的内部 CSS 也是可缓存的（因为它是页面的一部分）。但是外部样式表的优点是它们可以用于许多页面，并且在可缓存时只被请求一次。

因此，您首先有一个额外的请求（外部样式表），但随后需要在进一步请求时传输较少的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T11:56:46.870

不，他们不会。外部 CSS 可以跨多个页面/请求缓存，此外，您通常可以使用 gzip 压缩这些文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T14:29:50.543

使用外部 CSS 可确保您所有页面的外观保持一致，至少如果您为整个网站使用 1 个 CSS 文件。第一个页面可能会降低速度，但从那时起 CSS 文件会被缓存，因此后续页面实际上会加载得更快。

我偶尔会使用内部 CSS，它非常特定于页面，在其他地方没有用处。切勿将它们排成一行；内联 CSS 很难维护。

# web-services - Web Service 尝试 Giving SoapException，为什么以及该怎么做？

> ID：553097
> 
> 赞同：0
> 
> 时间：2009-02-16T12:00:40.857
> 
> 标签：web-services, soap

我了解了使用 Visual Studio 2008 ASP.Net + VB 制作 Web 服务的基础知识。我得到了“Hello World”的工作，但由于某种原因，我无法让函数方法在没有这个错误的情况下以同样的方式工作，而且我无法在任何地方提供任何信息来处理它。

代码：

```
*网络服务：*

<WebMethod()> _
    Public Sub logEvent(ByVal userId As String, ByVal userGroup As String)

        '这里的方法函数

    结束子

*主页代码隐藏*

    受保护的子 webrefTester()

        暗淡 testi 作为 my_dbServer.Service
        testi = 新的 my_dbServer.Service

        testi.Credentials = System.Net.CredentialCache.DefaultCredentials
        '必须包括这个，因为我使用 urls 而不是本地来模拟
        '预期的功能，所以一开始存在授权问题

        testi.logEvent("userId_0", "Mgmt Services 2010")

    结束子

```

如前所述，hello world 工作正常，所以我在需要使用 web 服务等的解决方案中添加了 web 引用。我似乎无法为 web 服务传递参数，它总是抛出一个肥皂异常。我需要将信息记录到数据库中。

对于第一次使用 Web 服务用户的任何其他提示也将受到欢迎。基本上，我的项目让我做一项服务，该服务可用于各种软件来记录事件信息，例如访问者类型、可能的错误消息等。

再次感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T13:07:29.383

它只是说 SoapException，这是错误消息：
“服务器无法处理请求。---> 对象引用未设置为对象的实例。”

# c# - 与 C# 中类型字符串的关系的主/详细数据网格视图

> ID：553098
> 
> 赞同：4
> 
> 时间：2009-02-16T12:00:55.957
> 
> 标签：c#, datagridview, datarelation

我想在 C# 中使用两个 datagridviews 和 DataRelation 来显示主/详细关系。

主表和明细表之间的关系是来自字符串类型的 ID（并且没有机会将 ID 更改为整数类型）。

更改主表中的行时，似乎 DataGridView 无法更新详细视图。

有谁知道是否可以使用字符串 ID 实现主/详细视图，如果可以，如何实现？还是我必须使用另一家公司的外部 DataGrid？

* * *

## 更新

就个人而言，我认为使用字符串而不是整数没有区别。我唯一能想到的是网格无法使用字符串 ID 关系处理主详细信息视图。

这是一个例子，请创建一个新的VS 2008项目并复制代码。更改连接字符串和数据关系：

```
using System;
using System.Data;
using System.Data.SqlClient;
using System.Windows.Forms;

public class Form1 : System.Windows.Forms.Form
{
    private DataGridView masterDataGridView = new DataGridView();
    private BindingSource masterBindingSource = new BindingSource();
    private DataGridView detailsDataGridView = new DataGridView();
    private BindingSource detailsBindingSource = new BindingSource();

    [STAThreadAttribute()]
    public static void Main()
    {
        Application.Run(new Form1());
    }

    // Initializes the form.
    public Form1()
    {
        masterDataGridView.Dock = DockStyle.Fill;
        detailsDataGridView.Dock = DockStyle.Fill;

        SplitContainer splitContainer1 = new SplitContainer();
        splitContainer1.Dock = DockStyle.Fill;
        splitContainer1.Orientation = Orientation.Horizontal;
        splitContainer1.Panel1.Controls.Add(masterDataGridView);
        splitContainer1.Panel2.Controls.Add(detailsDataGridView);

        this.Controls.Add(splitContainer1);
        this.Load += new System.EventHandler(Form1_Load);
        this.Text = "DataGridView master/detail demo";
    }

    private void Form1_Load(object sender, System.EventArgs e)
    {
        // Bind the DataGridView controls to the BindingSource
        // components and load the data from the database.
        masterDataGridView.DataSource = masterBindingSource;
        detailsDataGridView.DataSource = detailsBindingSource;
        GetData();

        // Resize the master DataGridView columns to fit the newly loaded data.
        masterDataGridView.AutoResizeColumns();

        // Configure the details DataGridView so that its columns automatically
        // adjust their widths when the data changes.
        detailsDataGridView.AutoSizeColumnsMode =
            DataGridViewAutoSizeColumnsMode.AllCells;
    }

    private void GetData()
    {
        try
        {
            // Specify a connection string. Replace the given value with a 
            // valid connection string for a Northwind SQL Server sample
            // database accessible to your system.
            String connectionString =
                "";
            SqlConnection connection = new SqlConnection(connectionString);

            WindowsFormsApplication1.ConcordanceServer.IConcordanceServerToGUI cs = new WindowsFormsApplication1.ConcordanceServer.ConcordanceServerToGUIClient();

            // Create a DataSet.
            DataSet data = new DataSet();
            data.Locale = System.Globalization.CultureInfo.InvariantCulture;

            // Add data from the Customers table to the DataSet.
            SqlDataAdapter masterDataAdapter = new
                SqlDataAdapter("select * from customers", connection);
            masterDataAdapter.Fill(data, "Customers");

            // Add data from the Orders table to the DataSet.
            SqlDataAdapter detailsDataAdapter = new
                SqlDataAdapter("select * from Orders", connection);
            detailsDataAdapter.Fill(data, "Orders");

            // Establish a relationship between the two tables.
            DataRelation relation = new DataRelation("CustomersOrders",
                data.Tables["Customers"].Columns["strID"],
                data.Tables["Orders"].Columns["strID"]);
            data.Relations.Add(relation);

            // Bind the master data connector to the Customers table.
            masterBindingSource.DataSource = data;
            masterBindingSource.DataMember = "Customers";

            // Bind the details data connector to the master data connector,
            // using the DataRelation name to filter the information in the 
            // details table based on the current row in the master table. 
            detailsBindingSource.DataSource = masterBindingSource;
            detailsBindingSource.DataMember = "CustomersOrders";

        }
        catch (SqlException)
        {
            MessageBox.Show("To run this example, replace the value of the " +
                "connectionString variable with a connection string that is " +
                "valid for your system.");
        }
    }
} 
```

# c++ - 我可以在 STL 中禁用异常吗？

> ID：553103
> 
> 赞同：21
> 
> 时间：2009-02-16T12:03:23.097
> 
> 标签：c++, visual-c++, stl, exception-handling

我想禁用在 MSVC 下编译的 C++ 应用程序中的异常。我已将启用 C++ 异常选项切换为 NO，但我收到警告，告诉我使用选项 /Ehsc，但我不想这样做。

* * *

我的代码中没有 try/catch 块，但我使用 STL。我发现使用宏定义 _HAS_EXCEPTIONS=0 应该禁用 STL 中的异常，但我仍然收到如下警告：

* * *

`warning C4275: non dll-interface class 'stdext::exception' used as base for dll-interface class 'std::bad_typeid' see declaration of 'stdext::exception' see declaration of 'std::bad_typeid'`

* * *

有什么方法可以关闭 STL 的异常？

注意：在我的代码中，我也想关闭 RTTI 选项。无论 RTTI 是打开还是关闭，我都会收到相同的警告。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-10-06T07:31:08.153

Microsoft STL 支持异常停用。

对于 MSVC STL，定义宏 _HAS_EXCEPTIONS=0 会在您将应用程序与 libcmt.lib/libcmtd.lib（/MT 或 /MTd 编译器选项）链接时禁用异常。

如果与 msvcrt.lib/msvcrtd.lib（/MD 或 /MDd 编译器选项）链接，则需要再定义一个宏 - _STATIC_CPPLIB。在这种情况下，请在包含任何 STL 代码之前添加以下行：

```
#define _HAS_EXCEPTIONS 0
#define _STATIC_CPPLIB 
```

或将以下内容添加到编译器选项：

```
-D_HAS_EXCEPTIONS=0 -D_STATIC_CPPLIB 
```

请注意，您需要在项目设置中禁用 C++ 异常。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-16T12:32:57.737

您需要使用支持异常停用的 STL。这通常是编译时宏定义。

除非我弄错了，否则 STLPort 提供了 _STLP_USE_EXCEPTIONS=0 和 _STLP_NO_EXCEPTIONS。我不知道程序在这些设置下的表现如何。;)

我认为 MS STL 中也有一些隐藏的标志。

EASTL 开箱即用，禁用异常：

[http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2271.html](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2271.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-16T12:28:13.923

类型 id 与运行时类型标识有关。您可能还想尝试关闭 RTTI。

但是，C++ 标准库的某些部分被指定为抛出异常。如果您禁用它们，您将驶入“未定义行为”的浑浊水域。

# ajax - 优雅降级 - 何时考虑

> ID：553108
> 
> 赞同：7
> 
> 时间：2009-02-16T12:05:03.277
> 
> 标签：ajax, language-agnostic, user-interface, accessibility

在为使用 AJAX 的应用程序设计和构建 UI 时，您何时考虑优雅降级（对于禁用 JavaScript 或正在使用屏幕阅读器的用户）？

*   最后，一旦站点的 AJAX 版本完全完成
*   在每个发展阶段
*   我不
*   还有什么...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-16T12:11:03.780

如今，[渐进增强](http://en.wikipedia.org/wiki/Progressive_Enhancement)通常优于[优雅降级](http://en.wikipedia.org/wiki/Graceful_degradation)——即完全相反的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T12:08:26.670

到目前为止，我采用的方法是编写它以便它在没有 JavaScript 的情况下工作，然后在顶部添加 JavaScript。

这真是[优雅退化](https://duckduckgo.com/html/?q=Wikipedia%20gracefully%20degradation)的逆过程。它强调在您的浏览器和设置允许的情况下增强页面。

[相关文章](http://alistapart.com/articles/progressiveenhancementwithjavascript)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T12:13:33.257

优雅降级可以描述两件事：

1.  它是一种行为（通常是网站或 Web 应用程序），允许网站在禁用某些功能（例如 JavaScript；CSS）时继续运行。

2.  这是一种构建应用程序以在打开的铃声和口哨声的情况下工作的方法，然后用螺栓固定以使其在没有上述噪音制造者的情况下工作。

我假设您在问是否使用后者来实现前者。我肯定会建议实现 1)，因为任何在关闭 JavaScript 的情况下浏览的人（即，很多有计算线索的人；使用基于文本的浏览器的人；使用残疾辅助设备的人）否则将无法使用您的网站。

至于如何做到这一点，[A List Apart](http://alistapart.com)有一篇关于[渐进增强](http://www.alistapart.com/articles/understandingprogressiveenhancement)的好文章值得一看，您首先构建网站以使其基本工作，然后添加 AJAX 等。我更喜欢这种方法，因为它为应用程序的工作奠定了坚实的基础，并且从一开始就具有良好的安全性和功能。未来可以在基础层面对其进行增强，然后添加到 AJAX 层；没有前者，将来很难将优雅降级的组件添加到应用程序中。

无论如何，喜欢这篇文章，如果你想了解更多关于这些东西的信息，*[A List Apart](https://en.wikipedia.org/wiki/A_List_Apart)*是一个很棒的网站！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-16T12:14:33.787

[Jeremy Keith 在他的Hijax](http://domscripting.com/blog/display/41)文章中总结了渐进式增强的论点。

通常，我使用以下代码将“js”类动态应用于 HTML 元素，以针对支持 JavaScript 的浏览器

`<script type="text/javascript">if(h=document.documentElement)h.className+=" js"</script>`

# iphone - 有没有办法从我的 iPhone 应用程序中发送邮件？

> ID：553110
> 
> 赞同：-1
> 
> 时间：2009-02-16T12:06:03.120
> 
> 标签：iphone, email

我想从我的 iPhone 应用程序中发送一封电子邮件，主要是因为我不想退出我的应用程序。有没有办法做到这一点？

解决方案：

1）我发现了这个开源 API： [http ://code.google.com/p/skpsmtpmessage/](http://code.google.com/p/skpsmtpmessage/)

任何人都可以为此编写自己的 smtp 客户端。（如果你能投入那么多时间——那就是）

2) 使用Web 服务发送消息详细信息并在服务器端处理消息发送功能。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T12:38:58.237

*   在你的 Mac 上安装[subversion](http://subversion.tigris.org/getting.html#osx)，以及命令行工具，有各种各样的 GUI 包装器可以用一点谷歌搜索。
*   如果您单击该[项目](http://code.google.com/p/skpsmtpmessage/)上的“源”选项卡，您将看到使用 subversion 获取源的说明

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-08T06:31:24.053

iPhone SDK 3.* 支持从应用程序内部发送电子邮件。除此之外，我还发现了另外两种可以用作替代方案的解决方案（尽管使用 iPhone SDK 3.*，不推荐）：

1）我发现了这个开源 API：[http ://code.google.com/p/skpsmtpmessage/](http://code.google.com/p/skpsmtpmessage/)

任何人都可以为此编写自己的 smtp 客户端。（如果你能投入那么多时间——那就是）

2) 使用Web 服务发送消息详细信息并在服务器端处理消息发送功能。

# image - 负载均衡环境中的图像

> ID：553112
> 
> 赞同：1
> 
> 时间：2009-02-16T12:06:35.130
> 
> 标签：image, webserver

我有一个负载平衡的环境，有超过 10 个运行 IIS 的 Web 服务器。所有网站都在访问托管所有图片的单个文件存储。我们目前有 200GB 的图片 - 我们将它们存储在每个目录 1000 张图片的目录中。现在，所有图像都位于单个存储设备 (RAID 10) 中，连接到用作文件服务器的单个服务器。所有 Web 服务器都连接到同一 LAN 上的文件服务器。我希望改进架构，这样我们就不会出现单点故障。我正在考虑两种选择：

1.  将文件存储复制到所有网络服务器，以便它们都在本地访问数据
2.  将文件存储复制到另一个存储，因此如果当前存储发生问题，我们将能够切换到它。

显然对文件存储所做的主要操作是读，但也有很多写操作。您认为首选的方法是什么？还有什么想法吗？

我目前正在排除使用 CDN，因为它需要对应用程序进行架构更改，而我们现在无法进行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T12:48:30.350

在进行拱形改变之前我通常会考虑的某些事情是

1.  当前拱门的问题是什么
2.  我在当前的拱门上做错了什么。（如果这已经工作了一段时间，小的调整通常会解决很多问题）
3.  会不会让我轻松成长（这里总会有上限）。根据过去的数据增长情况，您可以有效地对其进行规划。
4.  可靠性
5.  易于维护/监控/故障排除
6.  成本

200GB 不是很多数据，您可以使用一些本地解决方案或使用 NAS 之类的东西，这将允许您稍后进行扩展。并拥有它的热插拔副本。

复制到所有网络服务器的存储是一个非常昂贵的设置，正如你所说的有很多写入操作，复制到所有服务器会产生很大的开销（只会随着服务器数量和数据的增长而增加）。并且还存在由其他节点之一提供过时数据的问题。除此之外，对 10 个和不断增长的节点进行故障排除复制问题将变得一团糟。除非文件的查找/读取/写入对时间非常关键，否则复制到所有网络服务器并不是一个好主意。用户（网络）几乎不会注意到加载时间 100 毫秒 - 200 毫秒的差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T13:16:47.973

这类事情有一些[企业](http://www-03.ibm.com/systems/clusters/software/gpfs/index.html) [解决方案。](http://en.wikipedia.org/wiki/Global_File_System)但我不怀疑它们很贵。NAS 不能很好地扩展。而且你有一个不好的单点故障。

有一些方法可以编写代码来帮助解决这个问题。您可以在第一次请求图像时将图像缓存在 Web 服务器上，这将减少图像服务器上的负载。

您可以设置一个主从服务器，这样您就有一个主映像服务器，但其他服务器从该服务器复制。您可以对这些进行负载平衡，并在您的代码中添加一些逻辑，以便如果从属服务器没有图像副本，您可以检查主服务器。您还可以按优先级顺序分配它们，以便如果主服务器不可用，则第一个从服务器成为主服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T13:43:43.930

由于您的存储中的数据非常少，因此购买几个大型 HD 或使用 Web 服务器上的可用空间来保存副本是有意义的。它将减轻您的后端存储系统的压力，当它发生故障时，您仍然可以为您的用户提供内容。更好的是，如果您需要扩展（更多下载），您可以简单地添加一个新服务器，并且后端的压力不会有太大变化。

如果我必须这样做，我会使用[rsync](http://samba.anu.edu.au/rsync/)或[unison](http://www.cis.upenn.edu/~bcpierce/unison/)将图像文件复制到它们在存储设备上的 Web 服务器上完全相同的空间中（这样，您可以使用网络文件系统交换副本随时挂载）。

时不时地运行 rsync（例如在任何上传之后或在晚上一次；您会更好地知道哪种尺寸最适合您）。

更通用的解决方案是使用像 Bittorreent 这样的 P2P 协议。这样，您可以将存储后端上的所有更改发布到 Web 服务器，它们会自动优化更新。

# opengl - 这些矩阵模式有什么区别？

> ID：553117
> 
> 赞同：7
> 
> 时间：2009-02-16T12:08:40.820
> 
> 标签：opengl, theory

`GL_PROJECTION and GL_MODELVIEW.`

我知道还有其他人，但从概念上讲，我无法弄清楚它们之间的区别是什么。在设置模式后加载单位矩阵时，单位矩阵根据模式有何不同？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T13:02:04.187

可以说这`GL_PROJECTION`是用于将*相机*设置为它的样子，广角镜头等，也可以说`GL_MODELVIEW`是用于设置要绘制的*对象，例如空间中的大小和位置等。*

要定位相机，请查看[gluLookAt](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/glu/lookat.html)函数...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T15:58:24.450

矩阵模式不会改变矩阵本身，所以单位矩阵在任何地方都是单位矩阵。

矩阵模式改变以下命令操作的矩阵*。*也就是说，任何后续命令是否与投影矩阵、模型*视图矩阵或纹理矩阵等一起使用。

这听起来可能有点令人困惑，但这是 OpenGL 的设计决策之一——有一堆命令对某个状态或对象进行操作，只有其他状态设置才能确定它们对哪个对象进行操作。

# image-manipulation - 从图像图块制作图像

> ID：553118
> 
> 赞同：0
> 
> 时间：2009-02-16T12:08:54.453
> 
> 标签：image-manipulation

我看过几张图片，它们*通常*用许多较小的图片来做一张脸。

例如，假设他们将 100 张图像平铺在 10x10 网格中，并且以某种方式改变了较小图像的色调/饱和度/颜色，因此当您看到**大图**时，您会看到另一张图像。

问题归结为 - 说你有一个形象。您将对该图像应用哪种算法，以使该图像的平均 RGB 值是您定义的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T13:04:58.797

1.  计算每个图块的色调/饱和度/值（使用 HSV，因为这里的较小差异在人眼看来比在 RGB 空间中更“自然”）
2.  现在为你的大图的每个 n*n 块计算相同的值
3.  找到具有最接近 HSV 值（最小值`sqrt((h1-h2)^2 - (s1-s2)^2 - (v1-v2)^)`）的图块，并将按比例缩小到 n*n 的图块标记到结果中。

要找到图块的 HSV，将所有 RGB 值求和然后将它们除以像素数并将最终的 RGB 三元组转换为 HSV 就足够了。但为了省钱，我建议你试试这两个版本。

查看关于 RGB <-> HSV 转换的[Wikipedia 文章](http://en.wikipedia.org/wiki/HSL_color_space)。

为了改进算法，您可以将每个图块拆分为一个*mm 并计算每个网格元素的平均 HSV。然后，当您寻找匹配项时，照常将大图像划分为 m* m HSV 值。选择与这些 m*m 中的大多数最匹配的图块。这允许算法选择与大图具有相同结构的图块。

对于额外的触摸，尝试创建一个[千兆像素图像](http://en.wikipedia.org/wiki/Gigapixel_image)。

# web-hosting - 如何将我的域重定向到不同的页面或目录？

> ID：553121
> 
> 赞同：2
> 
> 时间：2009-02-16T12:10:00.380
> 
> 标签：web-hosting

请建议使用 .htaccess 以外的其他方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T12:16:14.827

今天真的是作业到期日。

有 httpd.conf (apache) [http://httpd.apache.org/docs/1.3/configuring.html](http://httpd.apache.org/docs/1.3/configuring.html)

或者，强制执行“错误 301 - 重定向”。

或者，您可以在重定向到新网页的网页中放置元刷新。例如
<meta http-equiv="REFRESH" content="0;url= [http://www.the-domain-you-want-to-redirect-to.com](http://www.the-domain-you-want-to-redirect-to.com) ">

或者您可以使用 javascript 强制重定向。

```
<script type="text/javascript">
window.location = "http://www.google.com/"
</script> 
```

然后有诸如反向代理之类的东西可以做你想做的事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T12:24:22.890

根据技术和/或您对 Web 服务器的访问，有多种选择。除了上述之外，您还可以使用服务器端代码重定向，例如在 ASP.Net 中

```
Response.Redirect("http://www.google.co.uk") 
```

我确信有 PHP 和其他各种代码替代方案可以执行相同的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T12:14:59.683

您可以使用 index.html 和 META Refresh 标签进行客户端重定向。

```
 <html>
        <head>
            <meta http-equiv="refresh" content="0;url=http://www.mysite.com/MyDir/MyPage.html" />
        </head>
    </html> 
```

[http://en.wikipedia.org/wiki/Meta_refresh](http://en.wikipedia.org/wiki/Meta_refresh)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T16:31:58.957

实现无关：

以下状态代码可用于 Web 服务器响应：

*   [301 永久搬家](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.2)
*   [302 找到](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.3)

如果您无法访问像样的 Web 服务器，请尝试上面的 Javascript 或 Meta-Tag 方法。

奖励：另一个特定于实现的建议，使用[Hunchentoot](http://weitz.de/hunchentoot)：

```
(redirect "http://otherhost/otherpath") 
```

# asp.net - ASP.Net 实体框架模型

> ID：553129
> 
> 赞同：1
> 
> 时间：2009-02-16T12:13:46.690
> 
> 标签：asp.net, entity-framework

是否可以向我的模型添加数据库中不存在的属性？

例如，我有一个日历表，我想在我的 MVC 控制器中检索这些数据，然后计算出每个条目开始之前的剩余时间并将其返回给视图。所以我希望我的日历模型中的另一个属性保留剩余时间，这是我将在数据库之外生成的值。

我试过只添加属性，但是当我这样做时，我得到了错误，因为属性没有映射到任何东西。

这甚至可能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T12:46:50.650

您应该能够将属性添加到模型，但您将无法使用 LINQ 查询它。LINQ 最终将构建和表达它希望使用 SQL 对数据库运行的内容。那时，您的 LINQ 将无法找到从您的属性到某个字段的映射。

如果您的查询返回您创建属性的实际类型的 IEnumerable，则您的视图可能能够访问它。我不记得 EF 在这种情况下是否坚持映射，它可能会这样做。

如果您想为视图提供一些其他复合类型，您可能会发现可以创建使用 LINQ-to-objects 的后续 LINQ 查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T12:52:45.830

这是一个非持久属性或瞬态。我不太了解实体框架，但通过快速谷歌搜索你应该找到答案。

顺便说一句，您可以在这里找到很多提示： [http ://weblogs.asp.net/zeeshanhirani/archive/2008/12/18/my-christmas-present-to-the-entity-framework-community.aspx](http://weblogs.asp.net/zeeshanhirani/archive/2008/12/18/my-christmas-present-to-the-entity-framework-community.aspx)

在自己快速搜索并在 VS2008 中进行测试后，我看不到从映射中排除属性的方法。也许它需要您手动编辑映射文件？:(

# jquery - jQuery 动画帮助

> ID：553131
> 
> 赞同：0
> 
> 时间：2009-02-16T12:14:00.307
> 
> 标签：jquery, animation

我从查询中返回了动态数量的 div，所有这些都带有类#li。我希望它们都平滑地淡入，而不是仅仅出现。到目前为止，我正在使用此代码：

```
function loadTables() {
                $.get("display.php", { server: Server, username: Username, password: Password, database: Database, content: "tables" },
                    function(data){
                        html = ''
                        $(data).find("table").each(function() {
                            html = html + "<div id='li'>" + $(this).text() + "</div>";
                            });
                        $('#content').html(html);
                        $('#li').hide();
                        $('#li').fadeIn('slow');
                    }
                );
            } 
```

但问题是，动画只适用于第一个 div。它的动画效果很好。但所有其余的只是出现。jQuery.com 上的文档说它对所有匹配的元素都执行此操作，但似乎并没有这样做。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T12:16:24.560

多个元素不能有相同的 id。
尝试将 id 替换为 class。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T12:17:42.750

XML/HTML 中的 ID 是唯一的。您应该将 id 更改为 class，然后调用 $(".li") 如果 $("#li"). jQuery 很可能在第一次出现时停止，因为这是标准的。

# eclipse - 带有 SVNKit 适配器的子剪辑

> ID：553133
> 
> 赞同：24
> 
> 时间：2009-02-16T12:14:35.987
> 
> 标签：eclipse, svn, subclipse, ganymede, svnkit

我有两个问题和一些背景。

我正在将 Subclipse 1.4.x 安装到 Eclipse Ganymede 中，我想我应该使用 SVNKit 适配器。我使用的是 Subversion 1.4.x 附带的 Ubuntu 8.04，因为 JavaHL 适配器需要使用像 SVNKit 这样的纯 Java 解决方案的 Subversion 1.5.x，这似乎是一个很好的解决方案。

**您认为使用 SVNKit 适配器有哪些优点和缺点？**

我找不到任何关于 JNA 库、SVNKit 客户端适配器和 SVNKit 库实际提供的文档。我很想知道我安装了什么。**他们提供什么？**

[![替代文字](https://i.stack.imgur.com/mRrSg.png)](https://i.stack.imgur.com/mRrSg.png)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-16T12:27:58.590

在功能方面，两个套件都提供相同数量的功能。SVNkit 是专门为 Subclipse 开发的，所以这并不奇怪。

速度范围内，它们也相似。这并不奇怪，因为 Subversion 通常受 I/O 限制（等待 SVN 服务器传送数据总是比 SVN 客户端库在您的计算机上执行的时间更长）。

Subversion 1.5 有一些显着的速度改进，但这不适用于您的情况。

主要区别在于您不需要在计算机中安装正确版本的 javahl。对于 Linux，这通常是一个问题，因为这意味着您需要为 Eclipse 设置环境变量 LIBRARY_PATH 以便可以正确加载共享库，如果找不到适合您的包，您可能需要自己编译库需要。在您的情况下，Ubuntu 应该带有一个预编译库，但该库适用于 Subversion 1.5。不过，当您连接到 1.4 服务器时，它应该会优雅地回退。

Subclipse 的人支持 SVNkit，但我过去曾遇到过问题（那是几年前的事了；我很肯定这已经大大改善了）。它们也很快被修复了。

综合考虑，我认为你最好使用 SVNkit，因为它更容易设置。

[编辑] 至于“我应该下载什么”，我认为您需要“SVNKit 适配器（可选）”下面的所有内容，即所有三个组件（请参阅[SVNKit 常见问题解答](https://wiki.svnkit.com/SVNKit_FAQ)）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-16T14:04:17.080

如果可能，我总是建议使用 JavaHL。JavaHL 使用与命令行客户端相同的本机 Subversion 库，因此您可以获得最大的兼容性。当然，正如您所指出的，使用 SVNKit 肯定更容易。我们确实有一个常见问题解答来帮助 JavaHL 正常工作：

[http://subclipse.tigris.org/wiki/JavaHL](http://subclipse.tigris.org/wiki/JavaHL)

至于 JNA 库，我相信 SVNKit 将它用于 Java 无法轻松完成的事情。例如，在 Linux 上使用符号链接和设置文件权限。

# c# - 安装包有问题

> ID：553139
> 
> 赞同：1
> 
> 时间：2009-02-16T12:17:01.953
> 
> 标签：c#, windows-installer

当我第二次使用 msi 文件安装我的应用程序时，我发现了两种不同的行为：

1) 有时它会显示一个警告窗口，通知我您的 PC 中安装了以前的版本。如果要删除它，请转到控制面板。

2) 它显示一个向导，询问我是否要修复或删除该应用程序。

实际上，我不想要第一种行为。我希望他让我修复以前的版本或删除它。怎么做？！？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T12:23:15.310

我找到了解决方案.. 我应该将 DetectNewerInstalledVersion 属性设置为 false，以便它执行第二个行为。

如果我错了，请纠正我

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T23:03:08.820

如果您希望安装程序自动卸载旧版本的应用程序，您可以执行以下操作：

1.  在设置中增加应用的版本号
2.  完成此操作后，VS 会弹出一个对话框，询问您是否需要不同的产品 ID。（回答是/好的）
3.  确保 RemovePreviousVersion 为真。

下次安装时（假设存在旧版本），您的安装程序将自动卸载旧版本并安装新版本。

魔法是由最后一个向导——GroupCode 引起的。guid 在您的产品的所有版本中必须始终相同。所以逻辑是，如果版本号变了，产品代码也变了，但是组码不变，就会发生自动卸载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-08T11:20:06.363

有同样的问题并将 DetectNewerInstalledVersion 设置为 false 解决了它。我相信这个问题是在从 XP 更改为 Win7 时向我介绍的。

# c# - 在命令提示符下编译/执行 C# 源文件

> ID：553143
> 
> 赞同：179
> 
> 时间：2009-02-16T12:20:36.237
> 
> 标签：c#, command-line, compilation, command-prompt

如何从命令提示符窗口编译和执行 .cs 文件？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2009-02-16T12:25:18.800

CSC.exe 是 .NET Framework 中包含的 CSharp 编译器，可用于从命令提示符进行编译。如果使用“/target:exe”，则输出可以是可执行文件“.exe”，也可以是 DLL；如果您使用 /target:library，则 CSC.exe 位于 .NET Framework 目录中，

例如对于 .NET 3.5 `c:\windows\Microsoft.NET\Framework\v3.5\`，.

要运行，首先，打开命令提示符，单击“开始”，然后键入`cmd.exe`.
然后，您可能必须 cd 进入包含源文件的目录。

像这样运行 C# 编译器：

```
 c:\windows\Microsoft.NET\Framework\v3.5\bin\csc.exe 
            /t:exe /out:MyApplication.exe MyApplication.cs  ... 
```

（全部在一条线上）

如果你有多个源模块要编译，你可以把它放在同一个命令行上。如果您有其他程序集要引用，请使用`/r:AssemblyName.dll`.

确保您在其中一个类中定义了一个静态 Main() 方法，以充当“入口点”。

要运行生成的 EXE，请键入`MyApplication`，然后`<ENTER>`使用命令提示符。

[MSDN 上的这篇文章](https://msdn.microsoft.com/en-us/library/ms379563(v=vs.80).aspx)更详细地介绍了命令行编译器的选项。您可以嵌入资源、设置图标、签署程序集——您可以在 Visual Studio 中执行的所有操作。

如果您安装了 Visual Studio，请在“开始菜单”中；在 Visual Studio 工具下，您可以打开“Visual Studio 命令提示符”，它将设置命令行编译所需的所有环境和路径变量。

虽然知道这一点非常方便，但您应该将它与某种构建工具的知识结合起来，例如[NAnt](http://nant.sourceforge.net/)、[MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)、[FinalBuilder](http://www.finalbuilder.com/)等。这些工具提供了一个完整的构建环境，而不仅仅是基本的编译器。

### 在 Mac 上

在 Mac 上，语法类似，只有 C sharp Compiler 被命名为`csc`：

```
$ csc /target:exe /out:MyApplication.exe MyApplication.cs ... 
```

然后运行它：

```
$ mono MyApplication.exe 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-09-09T15:35:56.110

编译 C# 程序的另一种方法**（不使用 Visual Studio 或不安装它）** 是在环境变量中创建一个用户变量，即“PATH”。

在此变量中复制以下路径：

**"C:\Windows\Microsoft.NET\Framework\v4.0.30319"**

或取决于您的 PC 具有哪个 .NET。

因此，您不必每次编译代码时都提及整个路径。只需使用

**“C:\Users\UserName\Desktop>csc [选项] 文件名.cs”**

或者你的代码路径在哪里。

现在你可以走了。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-11-25T06:56:56.090

您可以编译 C# 程序：

**c: > csc Hello.cs**

你可以运行程序

**c: > 你好**

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-11-28T21:56:04.793

对于最新版本，首先打开一个 Powershell 窗口，转到任何文件夹（例如`c:\projects\`）并运行以下命令

```
# Get nuget.exe command line
wget https://dist.nuget.org/win-x86-commandline/latest/nuget.exe -OutFile nuget.exe

# Download the C# Roslyn compiler (just a few megs, no need to 'install')
.\nuget.exe install Microsoft.Net.Compilers

# Compiler, meet code
.\Microsoft.Net.Compilers.1.3.2\tools\csc.exe .\HelloWorld.cs

# Run it
.\HelloWorld.exe 
```

一个示例 HelloWorld.cs

```
using System;

public class HelloWorld {
    public static void Main() 
    {
        Console.WriteLine("Hello world!");
    }
} 
```

您也可以尝试新的 C# 解释器；）

```
.\Microsoft.Net.Compilers.1.3.2\tools\csi.exe
> Console.WriteLine("Hello world!");
Hello world! 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-16T12:42:25.437

虽然知道如何在命令行构建绝对是一件好事，但对于大多数工作来说，使用 IDE 可能更容易。C#[速成版](http://www.microsoft.com/express/vcsharp/)是免费的，而且物有所值；-p

或者，可以使用像[snippy这样的东西来运行 C# 代码片段。](http://csharpindepth.com/Downloads.aspx)

最后 - 请注意命令行是特定于实现的；对于 MS，它是[`csc`](http://msdn.microsoft.com/en-us/library/78f4aasd.aspx); 对于[mono](http://www.mono-project.com/)，它是[`gmcs`](http://www.mono-project.com/CSharp_Compiler)和朋友们......同样，执行：它只是 MS 版本的“exename”，但通常是 mono 的“mono exename”。

最后，很多项目都是用构建脚本工具构建的；[MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)、[NAnt](http://nant.sourceforge.net/)等

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-12-03T23:59:39.417

以下是如何使用独立的 C# 7.0 编译器安装 MSBuild，该编译器不再捆绑在最新的 .Net Framework 4.7 中：

[是否可以在没有 Visual Studio 的情况下安装 C# 编译器？](https://stackoverflow.com/questions/861384/is-it-possible-to-install-a-c-sharp-compiler-without-visual-studio/47624225#47624225)

然后运行

`"C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\MSBuild\15.0\Bin\Roslyn\csc.exe" MyApplication.cs`

将单个源文件编译为可执行文件。

另请注意，.Net Core[不支持](https://stackoverflow.com/questions/46065777/is-it-possible-to-compile-a-single-file-with-net-core/47624617#47624617)在没有预配置项目的情况下编译单个源文件。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-12-29T05:52:26.207

LinqPad 是测试一些 C# 代码的快速方法，而且它是免费的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-16T12:25:57.080

您可以在 VS 命令提示符下构建类文件（以便加载所有必需的环境变量），而不是默认的 Windows 命令窗口。

要了解有关使用 csc.exe（编译器）构建命令行的更多信息，请参阅[本文](http://msdn.microsoft.com/en-us/library/78f4aasd.aspx)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-10-26T11:23:49.143

添加到路径

```
C:\Windows\Microsoft.NET\Framework\v3.5 
```

编译：

```
csc file.cs 
```

执行：

```
file 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-07-18T19:20:53.773

一旦你编写了 c# 代码并保存它。您可以像其他代码一样使用命令提示符来执行它。

在命令提示符中输入文件所在的目录并键入

**编译：**

```
mcs yourfilename.cs 
```

**执行：**

```
mono yourfilename.exe 
```

如果您希望您的 .exe 文件具有不同的名称，请键入

**编译：**

```
mcs yourfilename.cs -out:anyname.exe 
```

**执行：**

```
mono anyname.exe 
```

这应该有帮助！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-12-21T06:14:41.950

在 Windows 系统中，`csc <filname>.cs`当当前目录位于 Microsoft Visual Studio\<Year>\<Version> 时，在命令提示符中使用该命令

有两种方法：

**使用命令提示符：**

1.  开始 --> 命令提示符
2.  使用以下命令将目录更改为 Visual Studio 文件夹：cd C:\Program Files (x86)\Microsoft Visual Studio\2017\ <Version>
3.  使用命令：csc /.cs

**使用开发人员命令提示符：**

1.  开始 --> VS 2017 的开发人员命令提示符（这里的目录已经设置为 Visual Studio 文件夹）

2.  使用命令：csc /.cs

希望能帮助到你！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-10-01T11:01:29.800

如果你已经安装了 Visual Studio，那么你就有了 VS 的开发者命令提示符。您可以使用命令轻松构建您的程序`csc`，并在开发人员命令提示符中使用应用程序的名称运行您的应用程序。

您可以打开开发人员命令提示符，如下所示。

开始 => VS 的开发人员命令提示符

希望这可以帮助！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-10-30T18:38:50.703

`C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\MSBuild\15.0\Bin\Roslyn`

在这里您可以找到支持 c#7 的 c# 编译器，否则它将使用仅支持 c# 5 的 .net 4 编译器

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-06-05T19:17:10.397

**PowerShell 可以开箱即用地执行 C# 代码。**

一个用于编译和执行文件的衬垫：

```
(Add-Type -Path "Program.cs" -PassThru)::Main() #'Main' is the entry point 
```

假设你有一个这样的 .cs 文件：

```
using System;
public class Program
{
    public static void Main()
    {
        Console.WriteLine("Hello from C#");
    }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-08-28T05:36:12.243

```
dotnet 
```

这太旧了。但是，当您提出问题以了解如何在没有 Visual Studio CE 的情况下使用编译器在控制台中使用 C#（如 C 或 C++）时，这是您最终成为初学者的地方（如果您还没有使用它，强烈建议您使用 C#）最终在 .NET 框架、库和 SDK 的术语中变得更加困惑。如果像你这样的人作为一个完整的初学者偶然发现我的答案：

**1.**了解Framework和SDK的区别。

**2.**了解什么是 C#，什么是 .NET。

**3.**这个：[https ://dotnet.microsoft.com/learn/dotnet/hello-world-tutorial/intro](https://dotnet.microsoft.com/learn/dotnet/hello-world-tutorial/intro)

你会在路上捡起剩下的。但我建议不要使用框架，而是使用 SDK 并且主要坚持使用 VS。至于我，我学习 C# 是为了统一，主要是游戏开发。

**谷歌**也是你的朋友。提问，保持好奇。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-11-12T05:22:18.893

如果您设置了正确的系统和环境变量并且您的路径配置正确，我找到了一种简单的方法来执行此操作。

你只需要在项目的目录下运行

`dotnet new console`--> 这将生成所需的文件，例如 .csproj。它还会生成一个 Program.cs 文件，它会自动将其用作入口点，如果您有其他文件使用静态 Main 方法，则可以删除此文件，它应该会自动找到 Main 入口点。

那么你需要做的就是运行 `dotnet run`它应该自动编译和运行

这就是我如何设法让我的项目使用 gitbash 作为我的终端在 vs 代码中工作。我还安装了 VS 2019，我使用了 .net 5.0 框架作为我的系统变量。这是我为基本控制台程序找到的最简单的解决方案。它还允许您在 .csproj 文件中添加自定义导入

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-03-02T14:09:22.787

```
# File    : csharp.ps1
# Purpose : Powershell Script to compile a csharp console application from powershell prompt

try {
    # CSharp Compiler
    #$csc = "C:\Windows\Microsoft.NET\Framework\v3.5\bin\csc.exe"
    $csc = "C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe"
    # NOTE: if this path doesn't work search Framework folder for csc.exe

    $ErrorActionPreference = 'Stop'

    if ($args.Count -eq 0) {
        write-host "`nUSAGE: csharp.ps1 (console_application.cs)"
        exit 1
    }

    $file = $args[0];
    if (-not(test-path $file)) {
        throw "file doesn't exist: $file"   
    }

    $cmd = "$csc /nologo  /t:exe  /out:${file}.exe $file"

    write-host  -ForegroundColor Green "`nx: $cmd"
    invoke-expression $cmd  
}   
catch { 
    write-host -ForegroundColor Red "`nEXCEPTION: $_"
}
finally {
    write-host ""
} 
```

```
// File: helloworld.cs
using System;

namespace MyProgram
{
    class Program
    {
        public static void Main(string[] args)
        {
            Console.Write("Hello World...");
            Console.ReadKey(true);
        }
    }
} 
```

```
PS> .\csharp.ps1 helloworld.cs 
```

# asp.net - 如何从 ASP.net 页面访问主题中的本地资源？

> ID：553147
> 
> 赞同：3
> 
> 时间：2009-02-16T12:23:12.407
> 
> 标签：asp.net, resources, themes

我在 App_Themes 中的主题文件夹*内*的 App_LocalResources 文件夹中放置了一个资源文件，如下所示： \App_Themes\Theme1\App_LocalResources\Resources1.aspx.resx

假设 Web 表单名为 Resources1.aspx 且 Theme="Theme1"，我如何从项目中的 Web 表单访问此文件中的资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T12:38:53.760

您可以使用“资源”表达式从资源文件中提取值，例如：

```
<h1><%$ Resources: H1 %></h1> 
```

或者，特别是如果您在代码隐藏中，请使用 GetLocalResourceObject：

```
h1.InnerText = GetLocalResourceObject ( "H1" ).ToString ( ); 
```

编辑：有时我回答得太快了；从这个意义上说，我不认为主题是可本地化的，但是有一些解决方法。您可以在资源文件中包含特定主题的项目，并根据当前主题访问它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T13:55:17.833

您可以使用以下命令访问位于 \App_GlobalResources\Generic.resx 中的全局资源；

```
<%= Resources.Generic.Cancel %> 
```

本地资源位于 App_LocalResources 文件夹中，不一定必须放在根文件夹中。对于本地资源，它将是；

```
<%$ Resources:Cancel%> 
```

或者

```
string labelCancel = GetLocalResourceObject("Cancel").ToString(); 
```

至于将资源文件放在主题文件夹中；我会保持我的主题和资源分开，并通过使用全局资源以编程方式在站点主页面/基本页面等中的各种资源之间切换。

# ssl-certificate - 是否可以将 SSL 证书从 .key 文件转换为 .pfx？

> ID：553149
> 
> 赞同：19
> 
> 时间：2009-02-16T12:24:14.573
> 
> 标签：ssl-certificate, pfx

有没有办法从 .key 文件转换为 .pfx 文件？谢谢你。

编辑：我只有 .key 文件，但我的托管服务提供商说我可以仅使用该文件将其转换为 .pfx。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-18T23:21:23.487

要检查您的 .key 文件是否包含您需要的所有内容：

```
#check if file contains a valid certificate:
openssl x509 -text -in file.key 
```

它应该打印出证书详细信息。如果它打印一个错误，包括文本“无法加载证书”，那么你的文件是不够的。

```
#check if file contains a valid key:
openssl rsa -text -in file.key
openssl dsa -text -in file.key 
```

上述命令之一应打印出有效的密钥详细信息。另一个将给出文本“期望 rsa 密钥”或“期望 dsa 密钥”的错误。

如果错误文本显示“解密错误”，则您提供的密码无效，或者文件已损坏。

如果错误文本显示“期望：任何私钥”，那么您的文件是不够的。

如果您有一个密钥和一个与该密钥匹配的证书（以及可选的其他一些证书），那么您就有足够的能力将文件转换为 pfx。然后，正如 ISW 所说，这只是一个问题

```
#convert file containing key and certificate(s) to PKCS#12 pfx file.
openssl pkcs12 -export -out file.pfx -in file.key 
```

你就完成了。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-16T12:29:01.817

你可以试试这个
[https://www.sslshopper.com/ssl-converter.html](https://www.sslshopper.com/ssl-converter.html)

```
openssl pkcs12 -export -out certificate.pfx -inkey privateKey.key -in certificate.crt -certfile CACert.crt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T13:48:47.630

根据[OpenSSL Command-Line HOWTO](http://www.madboa.com/geek/openssl/#cert-pkcs12)，它应该可以使用

```
# export mycert.key as PKCS#12 file mycert.pfx
openssl pkcs12 -export -out mycert.pfx -in mycert.key -name "My Certificate" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-04T00:44:16.027

[您可以使用工具http://www.chilkatsoft.com/p/p_347.asp](http://www.chilkatsoft.com/p/p_347.asp)将您的 .key 文件转换为 .pvk ，然后使用 GoDaddy 上的说明将 .scp 和 .pvk 合并为 .pfk。只需确保在生成 .pvk 文件时使用密码即可。

# .net - 项目更改时更新 WPF 列表

> ID：553150
> 
> 赞同：14
> 
> 时间：2009-02-16T12:24:15.057
> 
> 标签：.net, wpf, listbox

我有一个 WPF 列表框，并且添加了一些“FooBar”对象作为项目（通过代码）。FooBars 不是 WPF 对象，只是具有覆盖 ToString() 函数的哑类。

现在，当我更改影响 ToString 的属性时，我希望更新 ListBox。

1.  我怎样才能做到这一点“又快又脏”（比如重新粉刷）。
2.  依赖属性是解决这个问题的方法吗？
3.  是否值得/总是建议为我的 FooBars 创建一个 wpf 包装类？

谢谢...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-16T13:25:38.530

您的类型应该实现`INotifyPropertyChanged`，以便集合可以检测到更改。正如 Sam 所说，`string.Empty`作为论点传递。

您*还需*要让`ListBox`的数据源成为提供更改通知的集合。这是通过`INotifyCollectionChanged`接口（或非 WPF`IBindingList`接口）完成的。

当然，您需要在`INotifyCollectionChanged`成员`INotifyPropertyChanged`项之一触发其事件时触发该接口。值得庆幸的是，框架中有一些类型可以为您提供这种逻辑。可能最合适的一个是`ObservableCollection<T>`。如果您将您的绑定`ListBox`到一个，`ObservableCollection<FooBar>`那么事件链接将自动发生。

在相关说明中，您不必使用`ToString`方法来让 WPF 以您想要的方式呈现对象。你可以使用`DataTemplate`这样的：

```
<ListBox x:Name="listBox1">
    <ListBox.Resources>
        <DataTemplate DataType="{x:Type local:FooBar}">
            <TextBlock Text="{Binding Path=Property}"/>
        </DataTemplate>
    </ListBox.Resources>
</ListBox> 
```

通过这种方式，您可以控制对象所属的对象的呈现方式——在 XAML 中。

**编辑 1**我注意到您的评论是您正在使用该`ListBox.Items`集合作为您的集合。这不会进行所需的绑定。你最好做这样的事情：

```
var collection = new ObservableCollection<FooBar>();
collection.Add(fooBar1);

_listBox.ItemsSource = collection; 
```

我没有检查该代码的编译准确性，但你明白了要点。

**编辑 2**使用`DataTemplate`我上面给出的（我编辑它以适应你的代码）解决了这个问题。

`PropertyChanged`触发不会导致列表项更新似乎很奇怪，但是使用该`ToString`方法并不是 WPF 的预期工作方式。

使用此 DataTemplate，UI 可以正确绑定到确切的属性。

不久前我在这里问了一个关于在[WPF 绑定中进行字符串格式化的](https://stackoverflow.com/questions/447035/what-is-the-wpf-xaml-data-binding-equivalent-of-string-format)问题。您可能会发现它很有帮助。

**编辑 3**我很困惑为什么这仍然不适合你。这是我正在使用的窗口的完整源代码。

后面的代码：

```
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Windows;

namespace StackOverflow.ListBoxBindingExample
{
    public partial class Window1
    {
        private readonly FooBar _fooBar;

        public Window1()
        {
            InitializeComponent();

            _fooBar = new FooBar("Original value");

            listBox1.ItemsSource = new ObservableCollection<FooBar> { _fooBar };
        }

        private void button1_Click(object sender, RoutedEventArgs e)
        {
            _fooBar.Property = "Changed value";
        }
    }

    public sealed class FooBar : INotifyPropertyChanged
    {
        public event PropertyChangedEventHandler PropertyChanged;

        private string m_Property;

        public FooBar(string initval)
        {
            m_Property = initval;
        }

        public string Property
        {
            get { return m_Property; }
            set
            {
                m_Property = value;
                OnPropertyChanged("Property");
            }
        }

        private void OnPropertyChanged(string propertyName)
        {
            var handler = PropertyChanged;
            if (handler != null)
                handler(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

XAML：

```
<Window x:Class="StackOverflow.ListBoxBindingExample.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:StackOverflow.ListBoxBindingExample"
    Title="Window1" Height="300" Width="300">
    <DockPanel LastChildFill="True">
        <Button Click="button1_Click" DockPanel.Dock="Top">Click Me!</Button>
        <ListBox x:Name="listBox1">
            <ListBox.Resources>
                <DataTemplate DataType="{x:Type local:FooBar}">
                    <TextBlock Text="{Binding Path=Property}"/>
                </DataTemplate>
            </ListBox.Resources>
        </ListBox>
    </DockPanel>
</Window> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T13:57:18.297

此处正确的解决方案是为 ListBox IetmsSource 属性使用[ObservableCollection<> 。](http://msdn.microsoft.com/en-us/library/ms668604.aspx)WPF 将自动检测此集合内容中的任何更改，并强制相应的 ListBox 更新以反映更改。

您可能需要阅读此 MSDN 文章以获取更多信息。写它是为了专门解释如何处理这种情况

[http://msdn.microsoft.com/en-us/magazine/dd252944.aspx?pr=blog](http://msdn.microsoft.com/en-us/magazine/dd252944.aspx?pr=blog)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T12:49:08.320

尝试在 FooBar 对象上实现 INotifyPropertyChanged 接口。当它们发生变化时，引发 PropertyChanged 事件，将 string.Empty 作为属性名称传递。这应该够了吧。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T21:58:44.100

这是我为此工作的 C# 代码：

```
using System;
using System.Collections.Generic;
using System.Windows;
using System.Windows.Controls;
using System.ComponentModel;
using System.Collections.ObjectModel;
namespace ListboxOfFoobar
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            ObservableCollection<FooBar> all = (ObservableCollection<FooBar>)FindResource("foobars");
            all[0].P1 = all[0].P1 + "1";
        }
    }
    public class FooBar : INotifyPropertyChanged
    {
        public FooBar(string a1, string a2, string a3, string a4)
        {
            P1 = a1;
            P2 = a2;
            P3 = a3;
            P4 = a4;
        }

        public event PropertyChangedEventHandler PropertyChanged;
        private void NotifyPropertyChanged(String info)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(info));
            }
        }

        private String p1;
        public string P1
        {
            get { return p1; }
            set
            {
                if (value != this.p1)
                {
                    this.p1 = value;
                    NotifyPropertyChanged("P1");
                }
            }
        }
        private String p2;
        public string P2
        {
            get { return p2; }
            set
            {
                if (value != this.p2)
                {
                    this.p2 = value;
                    NotifyPropertyChanged("P2");
                }
            }
        }
        private String p3;
        public string P3
        {
            get { return p3; }
            set
            {
                if (value != this.p3)
                {
                    this.p3 = value;
                    NotifyPropertyChanged("P3");
                }
            }
        }
        private String p4;
        public string P4
        {
            get { return p4; }
            set
            {
                if (value != this.p4)
                {
                    this.p4 = value;
                    NotifyPropertyChanged("P4");
                }
            }
        }
        public string X
        {
            get { return "Foooooo"; }
        }
    }
    public class Foos : ObservableCollection<FooBar>
    {
        public Foos()
        {
            this.Add(new FooBar("a", "b", "c", "d"));
            this.Add(new FooBar("e", "f", "g", "h"));
            this.Add(new FooBar("i", "j", "k", "l"));
            this.Add(new FooBar("m", "n", "o", "p"));
        }
    }
} 
```

这是 XAML：

```
<Window x:Class="ListboxOfFoobar.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:ListboxOfFoobar"
    xmlns:debug="clr-namespace:System.Diagnostics;assembly=System"

    Title="Window1" Height="300" Width="300"        
        >
    <Window.Resources>
        <local:Foos x:Key="foobars" />
        <DataTemplate x:Key="itemTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock MinWidth="80" Text="{Binding Path=P1}"/>
                <TextBlock MinWidth="80" Text="{Binding Path=P2}"/>
                <TextBlock MinWidth="80" Text="{Binding Path=P3}"/>
                <TextBlock MinWidth="80" Text="{Binding Path=P4}"/>
            </StackPanel>
        </DataTemplate>

    </Window.Resources>

    <DockPanel>
        <ListBox DockPanel.Dock="Top"
         ItemsSource="{StaticResource foobars}"
         ItemTemplate="{StaticResource itemTemplate}" Height="229" />
        <Button  Content="Modify FooBar" Click="Button_Click" DockPanel.Dock="Bottom" />
    </DockPanel>
</Window> 
```

按下 Button 会导致第一个 FooBar 的第一个属性被更新并显示在 ListBox 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T12:40:20.573

如果您用来存储项目的集合对象是 observablecollection<>，那么它会为您处理。

即，如果集合被更改，任何绑定到它的控件都将被更新，反之亦然。

# actionscript-3 - 即使使用 setTextFormat() 重置 HTML 样式，TextField() 有时也会保持粗体

> ID：553153
> 
> 赞同：0
> 
> 时间：2009-02-16T12:24:50.343
> 
> 标签：actionscript-3, flex3

为什么 TextField() 有时会像这样保持**BOLDING**（即使使用 setTextFormat() 重置格式）有什么想法吗？：

```
myFormat.bold=false;
defaultTextFormat =myFormat;  
defaultTextFormat.bold = false;
setTextFormat(myFormat);

htmlText("This text is bold even when it should not be.") 
```

PS：TextField 是可编辑的，用户编辑时会出现问题。

更新：我想摆脱所有格式以避免不需要的**BOLD**。TextField 有一个错误，当粗体字被用户退格时，TextField 中的所有内容都会永远加粗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-14T00:59:37.237

我相信使用 TextField 控件，您需要设置 TextFeild.styleSheet 来更改 HTML 样式。尝试这样的事情：

```
var myText:TextField = new TextField();
var style:StyleSheet = new StyleSheet();
var fonts:String = "Helvetica Neue, Arial, _sans";
style = new StyleSheet();
style.setStyle(".body", {fontFamily:fonts, fontSize:"12", fontWeight:"normal", color:"#222222", textDecoration:"none"});
myText.styleSheet = style;
myText.htmlText = "this is bold even when should not"; 
```

# events - 如何使用参数化名称收听所有 Seam 上下文事件？

> ID：553157
> 
> 赞同：2
> 
> 时间：2009-02-16T12:26:20.823
> 
> 标签：events, seam, observer-pattern, jbpm

Seam 将触发与特定范围、任务或流程相关[的不同类型的事件](http://docs.jboss.org/seam/latest/reference/en-US/html/events.html#d0e5252)，并将范围、任务或流程的名称附加到事件的末尾。

如何监听一个类型的所有事件？

例如，对于任何`<name>`我想听的事件，例如：

*   `org.jboss.seam.createProcess.<name>`— 创建进程时调用
*   `org.jboss.seam.endProcess.<name>`— 进程结束时调用
*   `org.jboss.seam.initProcess.<name>`— 当进程与对话相关联时调用
*   `org.jboss.seam.startTask.<name>`— 任务启动时调用
*   `org.jboss.seam.endTask.<name>`— 任务结束时调用

*尽管事先不知道有效名称列表，但*我需要这样做...... :-(

我希望使用@Observer 来创建观察者或类似的东西，并且我将在同一个组件中最多监听两个事件类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T18:37:26.337

您可以通过用您自己的实现替换Seam 的Events 类来轻松做到这一点。然后查找以特定字符串开头的引发事件：

```
@Scope(ScopeType.STATELESS)
@BypassInterceptors
@Name("org.jboss.seam.core.events")
@Install(precedence=APPLICATION)
public class Events extends org.jboss.seam.core.Events
{
   @Override
   public void raiseEvent(String type, Object... parameters )
   {
       super.raiseEvent( type, parameters );

       if ( type.startsWith( "org.jboss.seam.createProcess" ) )
       {
           super.raiseEvent( "org.jboss.seam.createProcess", parameters );
       }
       //etc.
   }
} 
```

您现在可以观察“org.jboss.seam.createProcess”以获取所有 createProcess 事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-27T15:46:43.323

在 if 中，你必须写 super.raiseEvent(...) 否则你会得到一个无限循环。

# asp.net - Visual Studio - 为什么 .ASPX 文件的加载时间比 .ASPX.CS 文件长得多？

> ID：553158
> 
> 赞同：9
> 
> 时间：2009-02-16T12:26:53.303
> 
> 标签：asp.net, visual-studio, editor, designer

这可能是一个愚蠢的问题，但它经常让我烦恼，所以我想在这里问没有什么坏处。

当我打开一个 .ASPX 文件时，Visual Studio 到底在做什么，它比我只打开文件隐藏代码 (.ASPX.CS) 需要的时间长 4-5 秒。

我注意到这种情况发生在 VS 2003、2005 和 2008 以及一台新建的机器上，所以这不是我的开发机器太慢的问题。

它似乎只在特定会话中第一次打开任何 .ASPX 文件时发生。是否有一些处理正在进行，我可以禁用以摆脱这种延迟？

干杯

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-16T12:29:20.053

因为 Visual Studio 必须处理`aspx`文件以在设计视图中表示它们。源文件没有设计视图。

它可能会缓存设计视图所需的内容。这将使下次加载文件时速度更快。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-28T15:21:18.547

我刚刚禁用了 HTML 设计器：

```
Tools -> Options -> HTML Designer ->
"Enable HTML designer" uptick it. 
```

工作得更快。在 VS12 中测试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-16T15:08:51.823

要加快 VS 打开 .aspx 文件的速度，您可以右键单击它们并选择查看标记，这将带您直接进入 HTML，而无需打开设计视图。

当然，当您尝试再次切换到设计视图时，将需要几秒钟来加载页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-05T10:26:27.127

您可以接受 weiran 的建议，或者如果您只想双击 da aspx 文件而没有延迟的麻烦...在 VS 中转到：

工具 -> HTML 设计器 ->

“起始页”部分 - 选择“源视图”

“智能标签”部分 -**取消选中**“自动显示智能标签....查看”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-18T14:40:49.693

另一个可能的原因是本节 Web.Config 中定义的自定义用户控件的数量和复杂性`<system.web>/<pages>/<controls>`。从 Web.Config 中删除它们显着提高了在 Visual Studio（特别是 VS 2010）中加载 aspx 和 ascx 文件的速度。当然，它们需要在使用它们的 aspx/ascx 文件中注册，但我不会为每个文件支付罚金。

# visual-studio - 为什么代码片段在 Visual Studio 中对我不起作用？

> ID：553163
> 
> 赞同：1
> 
> 时间：2009-02-16T12:28:29.930
> 
> 标签：visual-studio, visual-studio-2008

我正在尝试在 VS2008 中使用简单的预安装代码片段。我可以通过右键单击并使用 Insert Snippet... 来插入它们，但我无法在键入时让它们工作。如果我开始输入“for”，我会得到 Intellisense 列表，并且会看到代码片段的条目，但按 Tab 或 Enter 只会插入单词 for，而不是片段。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T12:32:35.117

尝试再次点击标签..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T16:03:24.093

或者以*Emacs*风格

```
ctrl-k ctrl-x 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T15:42:42.780

可能是您使用的任何类型的 VPC 软件拦截了您的选项卡命令，并使用错误的代码将它们注入 VPC。我还没有找到解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T15:44:54.943

您使用的是哪种语言？

C++ 片段在 VS2008 中不起作用。[MS取消了](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=361639)该功能:(

# sql-server - 使用T-sql直接查询TFS Warehouse

> ID：553170
> 
> 赞同：4
> 
> 时间：2009-02-16T12:32:21.620
> 
> 标签：sql-server, tfs

您好我想知道是否有人有任何查询 Team Foundation Server 存储以检索当前工作项信息的经验。据我了解，我需要的信息存储在 TFSWarehouse 数据库中。

我很清楚有提供此功能的 API，我自己也使用过它们。然而，这些都需要在任何将引用 API 的客户端 PC 上安装 Team Explorer。

我想要的只是一个工作项列表，其中包含一些选定的字段，例如标题、状态和创建者。

有没有人自己尝试过，确实有人知道这种方法有什么陷阱吗？

---------- 编辑 16/02

只是在与 TreeUK 交谈后添加。如果有人可能有一个示例查询，或者可能对表结构有一些解释，那将是一件好事吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T13:17:37.910

如果您有权访问托管 TFS 的 SQL 数据库，则可以编写一个查询来提取此信息。

您要查看的数据库是 TFSWarehouse。下面是获取工作项一般信息的查询。

```
select System_Id as WorkItemId, System_Title as Title,
System_State as Status, System_Reason as Reason, 
System_WorkItemType as Type
from [Work Item] 
```

很清楚他们都在做什么，检查该表以获取任何其他感兴趣的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-21T00:55:03.743

TFS 2005，它需要是 [workitemtracking].dbo.[workitemsare]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T19:17:15.493

```
SELECT DISTINCT Top(100) FactWorkItemLinkHistory.WorkItemLinkTypeSK, DimWorkItemLinkType.LinkName, DimWorkItem.System_Id, DimWorkItem.System_Title
FROM FactWorkItemLinkHistory
     INNER JOIN DimWorkItemLinkType ON DimWorkItemLinkType.LinkID = FactWorkItemLinkHistory.WorkItemLinkTypeSK
     INNER JOIN DimWorkItem ON DimWorkItem.System_Id = FactWorkItemLinkHistory.SourceWorkItemID
WHERE FactWorkItemLinkHistory.WorkItemLinkTypeSK = 2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-14T10:09:35.473

TFS 2013，它需要是 [Your Tfs_Warehouse database].dbo.DimWorkItem

```
SELECT System_Id as WorkItemId, System_Title as Title,
System_State as Status, System_Reason as Reason, 
System_WorkItemType as Type
FROM dbo.DimWorkItem 
```

# asp.net - 验证人在 causes JavaScript error

> ID：553172
> 
> 赞同：1
> 
> 时间：2009-02-16T12:32:35.303
> 
> 标签：asp.net, javascript, validation, graceful-degradation, noscript

The following .NET 3.5 code, placed in an aspx file, will trigger a JavaScript error when the page is loaded (for users who have JavaScript enabled):

```
<noscript>
    <asp:TextBox ID="txt" runat="server"></asp:TextBox>
    <asp:RequiredFieldValidator ID="txt_RequiredFieldValidator" runat="server" 
      ControlToValidate="txt"></asp:RequiredFieldValidator>
    <asp:Button ID="btn" runat="server" Text="Button" />
</noscript> 
```

The error happens because the JavaScript generated by the ASP.NET validator control does not contain a null check on before the second code line below:

```
var ctl00_body_txt_RequiredFieldValidator =
  document.all ?
    document.all["ctl00_body_txt_RequiredFieldValidator"] :
    document.getElementById("ctl00_body_txt_RequiredFieldValidator");

ctl00_body_txt_RequiredFieldValidator.controltovalidate = "ctl00_body_txt"; 
```

Can anyone suggest a workaround to this?

* * *

*Footnote:* Why am I doing this? For my non-JavaScript users I am replacing some AJAX functionality with some different UI components, which need validation.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T13:34:14.517

You should add the following to the RequiredFieldValidator:

```
enableclientscript="false" 
```

Seeing as you are using these in <noscript> tags, there is no point in supplying client side vaildation of the controls - they are only going to display if JS is turned off.

This will force the validation to happen (automatically) on the server side for you.

Just make sure you call "[Page.IsValid](http://msdn.microsoft.com/en-us/library/system.web.ui.page.isvalid.aspx)" before you process the response.

See [BaseValidator.EnableClientScript](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.enableclientscript.aspx) for more details.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T12:58:19.703

The javascript is looking for an element contained in the noscript? AFAIK there's no clean way to detect script support from the server side.

I think you'll need to build in a redirect (I've seen this done with a meta-refresh in a header noscript if you don't mind a validation failure) to push noscript users to a "please turnscript on page" or do some surgery to loosen up the validation/control binding which may take some amount of wheel reinventing. This is one of those areas where asp.net's tight coupling between controller and view really punishes.

# java - 即使在用户注销后也在 Windows 中运行 Java 进程

> ID：553175
> 
> 赞同：5
> 
> 时间：2009-02-16T12:33:09.623
> 
> 标签：java, windows, windows-services

我有一个在 Windows 2003 服务器中启动 Java 进程的批处理文件。根据安全策略，如果用户在一段时间内处于非活动状态，则该机器的用户将被强制注销。问题是，当用户注销时，进程也会死掉。

我安排了一个新任务（控制面板-> 计划任务）并选择了“我的计算机启动时”选项，并在那里提供了用户帐户详细信息。但它似乎没有任何效果，用户仍然注销并且进程死亡。是否需要重新启动才能使此更改生效？重新启动后，我会实现我的期望（保持进程活跃）吗？

或者，将此进程作为 Windows 服务运行会解决问题吗？如果是这样，您能否告诉我如何使 Java 程序或批处理文件作为 Windows 服务运行？我宁愿不使用任何其他第三方工具或库。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-16T12:36:38.787

如果您希望它在计划任务下运行，您必须确保您没有选中“仅在用户登录时运行”，这通常意味着您需要提供密码。

Windows 服务将是执行此操作的正常方式：[Java 服务包装器](http://wrapper.tanukisoftware.org/doc/english/introduction.html)是第 3 方，但有很多人使用它。

如果您真的不想使用第 3 方方法，您可以在 Windows NT 或更高版本上使用[svrany.exe (http://support.microsoft.com/kb/137890)](http://support.microsoft.com/kb/137890)，但它不是专门为 Java 设计的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T13:12:57.390

使用 srvany.exe 包装该进程并作为服务启动也可以。

[http://support.microsoft.com/kb/137890](http://support.microsoft.com/kb/137890)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T13:24:55.473

我正在使用[Java Service Wrapper](http://wrapper.tanukisoftware.org)将 java 进程作为 Windows 服务启动。我猜它的工作原理类似于上一篇文章中提到的 srvany.exe。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-15T11:26:51.463

我不知道这是否相关，但我们正在使用 jvm 的标志，因此它不会在注销时关闭

```
"java -Xrs" 
```

[链接到太阳对 -Xrs 的描述](http://java.sun.com/javase/6/docs/technotes/tools/windows/java.html#nonstandard)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-24T17:26:19.113

根据我的分析，

空闲解决方案将编写一个 VC++ (.net) Windows 服务创建程序，以将 .bat / .exe 作为系统服务启动，并带有所有必需的 SCM 回调方法。

**注意**： 1\. 用 srvany.exe 包装进程是行不通的，因为它没有任何对 SCM（服务控制管理器）的回调进程。2\. java service Wrapper 是第三方 API（很多是 LGPL 许可的）。

# silverlight - 克隆控件和数据绑定

> ID：553177
> 
> 赞同：0
> 
> 时间：2009-02-16T12:36:19.740
> 
> 标签：silverlight

我使用[Justin-Josef Angel](http://silverlight.net/forums/t/1730.aspx)克隆控件的“方式”，但遇到了数据绑定问题：例如，如果我将 Text 属性设置为绑定到“{Binding Name}”之类的东西，然后克隆控件，新克隆的控件将 text 属性设置为例如 Joe（评估值）而不是绑定表达式。

任何人都知道如何克隆控件并将克隆的控件进行数据绑定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T13:50:47.173

听起来您正在将已经数据绑定的控件序列化回 xaml，以便反序列化它的克隆。问题是 xaml 编写器不序列化绑定，[它评估它们并序列化结果。](http://msdn.microsoft.com/en-us/library/ms754193.aspx)

有两种方法可以解决这个问题。首先，保留原始 xaml 的副本，其中包含 Binding 标记扩展，然后对其进行反序列化。其次，创建一个 TypeConverter，xaml 编写器将使用它来序列化绑定。[你可以在这里](http://www.codeproject.com/KB/WPF/xamlwriterandbinding.aspx)和[这里](http://www.codeproject.com/KB/WPF/XamlSerializer.aspx)找到几篇关于这样做的文章。

# sql-server - 如何在 Powershell 中获取 SQL 存储过程的内容？

> ID：553179
> 
> 赞同：1
> 
> 时间：2009-02-16T12:36:48.507
> 
> 标签：sql-server, stored-procedures, powershell

我讨厌在树视图中探索代码和数据库结构，我更喜欢使用类似 Powershell 的东西。我需要在 SQL 中做的大部分事情都是探索，即查看表有哪些列或特定的存储过程做了什么。

查看表列就像 ls'ing 表的列目录一样简单，但是如何获取存储过程的内容呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T12:43:18.147

如果您想在 Sql Server 2008 上运行它，那么[这里有一个](http://www.mssqltips.com/tip.asp?tip=1684)可以帮助您的 Cmdlet。

如果您使用的是 Sql Server 2005，那么这里有一个[包含脚本的页面](http://www.powergui.org/thread.jspa?threadID=8042&tstart=0)来帮助您。

[编辑] 您可以使用 SP sp_helptext 查看所需存储过程的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T12:43:29.787

sproc 的文本存在于数据字典表中 顺便说一句[`sys.sql_modules.`](http://msdn.microsoft.com/en-us/library/ms175081.aspx) ，[这个 Stackoverflow 帖子](https://stackoverflow.com/questions/181909/tool-for-scripting-table-data/181942#181942)有一个数据字典逆向工程脚本（除其他外）从该表中获取视图定义的文本 - 逆向工程 sproc 定义的工作原理大致相同。

检索存储过程的程序文本的最小脚本如下所示：

```
select m.definition
  from sys.objects o
  join sys.sql_modules m
    on o.object_id = m.object_id
  join sys.schemas s
    on s.schema_id = o.schema_id
 where s.name = 'foo'   -- Schema name
   and o.name = 'bar'   -- Sproc name 
```

# asp.net - 缓存 VS 会话 VS cookie？

> ID：553185
> 
> 赞同：68
> 
> 时间：2009-02-16T12:41:23.377
> 
> 标签：asp.net, session, cookies, state-management

Cache VS Session VS Cookies 有哪些注意事项？

例如：
我经常使用 Session 变量，当用户开始订购产品然后去吃午饭并在几个小时后回来继续预订时，有时会在预订应用程序中出现问题。我将预订存储在会话中，直到用户确认或中止预订，因此当用户只需单击浏览器中的 X 并且永远不会返回时，我不需要与数据库对话并处理数据库中的中途预订。

我应该为此使用缓存或cookies还是某种组合？

（此外，当应用程序出现错误时，会话对象会自行重置，因此我会遇到更多问题）

我主要在做桌面编程，觉得我在这里缺乏很多知识，所以任何可以扩展在哪里使用缓存、会话、Cookie（或数据库）的人将不胜感激

**编辑：**从答案看来，我想要的是 DB 和 cookie 的组合。

1.  我必须将预订存储在连接到会话 ID 的数据库中
2.  将会话 ID 存储在 cookie 中（加密）。
3.  每个页面都加载检查 cookie 并从数据库中获取预订
4.  我有一个每周运行一次的清理程序，用于清理未完成的预订。

我不能将预订存储为 cookie，因为用户可以更改价格和其他敏感数据，我必须验证所有内容（不能信任数据）。

我做对了吗？

并感谢你们所有人的精彩解释！

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-02-16T12:46:25.440

从桌面应用程序的角度来看，状态管理是掌握 Web 世界的关键。

*   `Session`用于在*服务器*上存储当前 Web 会话的**每个用户**信息。它支持使用数据库服务器作为后端存储。
**   `Cookie`应该用于存储当前 Web 会话的**每个用户信息或***客户端上的***持久**信息，因此客户端可以控制 cookie 的内容。**   `Cache`对象**在单个应用程序中的用户之间共享**。其主要目的是缓存数据存储中的数据，不应用作主存储。它支持*自动失效*功能。*   `Application`对象在用户之间共享以存储**应用程序范围的**状态，并且应该相应地使用。**

 **如果您的应用程序被许多未经身份验证的用户使用，我建议您将数据存储在 cookie 中。如果需要身份验证，您可以手动将数据存储在数据库中，也可以使用 ASP.NET 配置文件管理功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T12:46:43.663

Web 本质上是断开连接的模型，并且提到的选项（会话、应用程序、缓存......）都不够可靠。会话将超时，工作进程回收等。

如果您确实需要长时间可靠地存储用户进度，那么数据库是您唯一的解决方案。如果您有用户配置文件（如果用户必须登录），那么这很简单。如果不是，则生成一个唯一 ID，将其存储在 cookie（或 URL）中，并根据该标识跟踪用户。

只需确保 Id 被加密，然后是 base64 编码的字符串，而不仅仅是一个数值。

编辑：

在您对 Mehrdad Afshari 的原始问题和评论进行额外解释之后，对您来说好的解决方案是使用 Session，但将存储设置为 Sql Server 而不是 InProc。

以下是如何设置的更多详细信息和说明：http: [//msdn.microsoft.com/en-us/library/ms178586.aspx](http://msdn.microsoft.com/en-us/library/ms178586.aspx)

请记住，您仍然会遇到会话超时，但它们会在应用程序池回收后仍然存在，甚至服务器重新启动。

如果你真的需要一个永久存储，数据库的自定义解决方案，正如我最初概述的那样，是唯一的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T12:45:55.303

Session 存储在服务器上默认会在 20 分钟内超时（这个是可调的）。我会将其存储在 cookie 或视图状态（如果可用）中以防止超时。

如果您的状态存储在 InProc（默认设置）中，那么在场中拥有多个服务器也会导致您出现问题，除非您实施了某种“粘性会话”，使用户保持在同一台服务器上农场以供后续调用。

我尽量避免会话（在服务器上增加额外的负载和内存使用），并尽可能关闭视图状态以保持页面大小较小。Cookie 通常是最轻量级的选项，但您的用户可能已将其关闭，您将需要一个后备模式，仍然允许他们使用该网站。

**编辑**（根据提问者的回复添加说明）：

Viewstate 存储在隐藏字段中，是 Viewstate 存储中所有对象的序列化表示。Viewstate 自动用于存储页面的状态，但如果您愿意，您可以通过编程方式显式添加和检索您自己的对象到 Viewstate 和从 Viewstate 中检索。

所以是的，数据集可以存储在 Viewstate 中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T12:55:51.753

你必须知道的第一件事！**cookie 由 session 使用**！服务器知道谁是您的用户，这要归功于每次请求在客户端和服务器之间交换的 cookie（这适用于 HTTP 标头 set-cookie 和 cookie）。

**真正的问题是：**

*   如果你想在导航过程中存储用户信息，那么你应该使用 session.

*   如果您的客户端不支持 cookie，那么您可以决定在每个请求中存储一个 cookie，在 URL 中编码（服务器将使用 URL 而不是 cookie 来为请求找到正确的会话）。

**然后考虑你想在哪里存储你的会话：**
如果你的站点必须具有高disponibility和高性能，那么你不能将会话存储在进程中，而是存储在数据库中。这样，您将能够在多个 Web 服务器之间共享工作。但是您将失去简单性（因为您存储在会话中的对象必须是可序列化的），并且您的网络服务器和数据库服务器之间还有一次往返。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T12:49:33.733

您不应该使用缓存对象来缓存会话数据，因为缓存在所有用户之间共享。相反，您可以使用 Asp.Net[配置文件属性](http://msdn.microsoft.com/en-us/library/2y3fs9xs.aspx)来存储您的数据，或者您可以将事件处理程序添加到 Session_End 事件并在用户离开计算机时间过长时存储数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-04-01T10:08:07.063

**Cookies**以文本文件格式存储在浏览器中。它存储的数据量是有限的。它只允许**4kb[4096bytes]。**它不保存cookies中的多个变量。

我们可以轻松访问 cookie 值。因此**安全性较低**。**setcookie()**函数必须出现**在标签之前**。

**会话**存储在服务器端。它存储无限量的数据。它在会话中保存多个变量。我们无法轻松访问 cookie 值。因此**更安全**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-04-05T04:55:07.163

*   **Cookie**是协作软件之间共享的一条信息，通过将特定于客户端的信息存储在客户端的机器上，然后检索以获取状态信息。

*   选择术语“ **cookie** ”是因为“ *cookie 是一个众所周知的计算机科学术语，用于描述中间人持有的不透明数据*”。这里的术语不透明意味着内容只对服务器而不是客户端感兴趣和相关。浏览器将自动将 cookie 包含在其对 cookie 的原始主机的所有后续请求中。cookie 具有名称和值，以及其他属性，例如域和路径、到期日期、版本号和注释。[更多](https://www.ntu.edu.sg/home/ehchua/programming/webprogramming/HTTP_StateManagement.html)_

饼干版本：

```
Cookie: cookie-name=cookie-value; Comment=text; Domain=domain-name; Path=path-name; Max-Age=seconds; Version=1; Secure 
```

*   服务器端**会话**数据可以存储大量数据，而客户端**cookie**数据的大小有限，从网站发送到服务器，cookie 通常包含参考代码，通过此节省数据传输大小。浏览器关闭后会话立即关闭，但 cookie 存在的时间更长。浏览器将会话 ID 作为 URL 参数、cookie 甚至 HTTP 标头发送到服务器。

*   **缓存**是存储数据的硬件或软件组件，因此可以更快地处理未来对该数据的请求；存储在缓存中的数据可能是早期计算的结果，或者是存储在其他地方的数据的副本。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-08-02T04:01:15.807

我总是对**LocalStorage**、**SessionStorage**和**Cookie**感到困惑，但现在不是了。

只需将这些词链接起来，就可以自我解释他们应该做什么。

**LocalStorage**：本地存储，什么意思，就是你对技术一窍不通的东西，但靠它自己就能猜到。它是一些在本地存储数据的存储。

那是什么。

IT**`without any expiration until user clear it`**通过 JavaScript 代码或清除浏览器缓存将数据存储在浏览器中。

**会话存储**：它似乎也存储数据，但与会话相关，那么它与 localStorage 有何不同？

主要区别在于您的**`session storage data will be deleted once the session is finish or browser tab is closed or the browser is closed`**.

您可以通过设置在浏览器控制台中尝试

```
localStorage.setItem('name' , 'alex')
sessionStorage.setItem('session','seesion value') 
```

**然后关闭选项卡并再次打开，您仍然可以找到 localStorage 数据但没有 sessionStorage 数据。**

**Cookie**：所以这和上面两个完全不同。通常用于服务器端目的的 cookie。

*   存储必须与后续请求一起发送回服务器的数据。
*   它的过期时间因类型而异，过期时间可以从服务器端或客户端（通常从服务器端）设置。
*   Cookies 主要用于服务器端读取（也可以在客户端读取），localStorage 和 sessionStorage 只能在客户端读取。
*   大小必须小于 4KB。
*   通过将 cookie 的 httpOnly 标志设置为 true 可以使 cookie 变得安全。这可以防止客户端访问该 cookie

# php - 如何通过 $_POST 将多个相关值从我的 html 表单发送到服务器？

> ID：553192
> 
> 赞同：0
> 
> 时间：2009-02-16T12:44:04.480
> 
> 标签：php, html, arrays, forms

当我单击一个按钮创建另一个字段时，我打算使用 jQuery 克隆输入字段，但我正在考虑这样做：

`Page One, Page Two, Page Three`<- 然后将其作为一个发送`$_POST`到服务器并让它获取每一页并在“，”逗号上中断，然后将每个插入到我的 POSTS 表中。

关于我将如何做到这一点的任何想法？我会使用explode（）吗？然后在`foreach()`字段中为每个项目运行查询。

因此，如果输入了 5 个以逗号分隔的页面，它将使用`foreach()`.

```
for each(){
  EXECUTE SQL HERE
} 
```

这听起来像是最好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T13:06:01.680

如果您将元素的`name`属性设置`input`为数组的名称，例如`foo[]`，您将能够在处理`$_POST`变量时访问它，例如

```
<input name="foo[]" type="text"/>
<input name="foo[]" type="text"/> 
```

变成两次迭代：

```
foreach ($_POST['foo'] as $foo) {
    // process $foo
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T13:04:51.217

爆炸和 foreach 听起来不错。

但正如 Click Upvote 所指出的：它是用于分页吗？因为那么可能有一种更好的方法来实现这一目标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T13:07:12.130

您可以执行以下操作：

```
<input type="text" name="list[]" />
<input type="text" name="list[]" />
<input type="text" name="list[]" />
<input type="text" name="list[]" /> 
```

每次您需要一个新的输入框时，您都可以这样做

```
$(some_element).append( '<input type="text" name="list[]" />' ); 
```

或与jQuery类似的东西。

然后你的 PHP`$_GET`或`$_POST`变量中有一个数组而不是单个值。所以你可以`$_POST['list']`在foreach中使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T19:09:02.293

我在想，我可以输入：

首页, 产品, 关于, 联系

进入输入字段，然后我的 php 可以使用逗号将其分开，并将每个页面标题插入我的 PAGES 表中。

在 foreach 中运行 SQL。

想法？

# c# - 与 C# 中类型字符串的关系的主/详细数据网格视图

> ID：553194
> 
> 赞同：0
> 
> 时间：2009-02-16T12:45:43.167
> 
> 标签：c#, datagridview, datarelation

我想在 C# 中使用两个 datagridviews 和 DataRelation 来显示主/详细关系。

主表和明细表之间的关系是来自字符串类型的 ID（并且没有机会将 ID 更改为整数类型）。

更改主表中的行时，似乎 DataGridView 无法更新详细视图。

有谁知道是否可以使用字符串 ID 实现主/详细视图，如果可以，如何实现？还是我必须使用另一家公司的外部 DataGrid？

就个人而言，我认为使用字符串而不是整数没有区别。我唯一能想到的是网格无法使用字符串 ID 关系处理主详细信息视图。

更新：问题已解决，问题是一个关系来自类型 nchar 并且在字符串末尾有 blancs。谢谢您的帮助！

这是一个例子，请创建一个新的VS 2008项目并复制代码。更改连接字符串和数据关系：

```
using System;
using System.Data;
using System.Data.SqlClient;
using System.Windows.Forms;

public class Form1 : System.Windows.Forms.Form
{
    private DataGridView masterDataGridView = new DataGridView();
    private BindingSource masterBindingSource = new BindingSource();
    private DataGridView detailsDataGridView = new DataGridView();
    private BindingSource detailsBindingSource = new BindingSource();

    [STAThreadAttribute()]
    public static void Main()
    {
        Application.Run(new Form1());
    }

    // Initializes the form.
    public Form1()
    {
        masterDataGridView.Dock = DockStyle.Fill;
        detailsDataGridView.Dock = DockStyle.Fill;

        SplitContainer splitContainer1 = new SplitContainer();
        splitContainer1.Dock = DockStyle.Fill;
        splitContainer1.Orientation = Orientation.Horizontal;
        splitContainer1.Panel1.Controls.Add(masterDataGridView);
        splitContainer1.Panel2.Controls.Add(detailsDataGridView);

        this.Controls.Add(splitContainer1);
        this.Load += new System.EventHandler(Form1_Load);
        this.Text = "DataGridView master/detail demo";
    }

    private void Form1_Load(object sender, System.EventArgs e)
    {
        // Bind the DataGridView controls to the BindingSource
        // components and load the data from the database.
        masterDataGridView.DataSource = masterBindingSource;
        detailsDataGridView.DataSource = detailsBindingSource;
        GetData();

        // Resize the master DataGridView columns to fit the newly loaded data.
        masterDataGridView.AutoResizeColumns();

        // Configure the details DataGridView so that its columns automatically
        // adjust their widths when the data changes.
        detailsDataGridView.AutoSizeColumnsMode =
            DataGridViewAutoSizeColumnsMode.AllCells;
    }

    private void GetData()
    {
        try
        {
            // Specify a connection string. Replace the given value with a 
            // valid connection string for a Northwind SQL Server sample
            // database accessible to your system.
            String connectionString =
                "";
            SqlConnection connection = new SqlConnection(connectionString);

            // Create a DataSet.
            DataSet data = new DataSet();
            data.Locale = System.Globalization.CultureInfo.InvariantCulture;

            // Add data from the Customers table to the DataSet.
            SqlDataAdapter masterDataAdapter = new
                SqlDataAdapter("select * from customers", connection);
            masterDataAdapter.Fill(data, "Customers");

            // Add data from the Orders table to the DataSet.
            SqlDataAdapter detailsDataAdapter = new
                SqlDataAdapter("select * from orders", connection);
            detailsDataAdapter.Fill(data, "Orders");

            // Establish a relationship between the two tables.
            DataRelation relation = new DataRelation("CustomersOrders",
                data.Tables["Customers"].Columns["strID"],
                data.Tables["Orders"].Columns["strID"]);
            data.Relations.Add(relation);

            // Bind the master data connector to the Customers table.
            masterBindingSource.DataSource = data;
            masterBindingSource.DataMember = "Customers";

            // Bind the details data connector to the master data connector,
            // using the DataRelation name to filter the information in the 
            // details table based on the current row in the master table. 
            detailsBindingSource.DataSource = masterBindingSource;
            detailsBindingSource.DataMember = "CustomersOrders";

        }
        catch (SqlException)
        {
            MessageBox.Show("To run this example, replace the value of the " +
                "connectionString variable with a connection string that is " +
                "valid for your system.");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T15:25:19.083

我查看了您的代码，它看起来基本没问题。请尝试进一步修剪它。

但是我发现字段名称“strId”有点可疑，这真的是数据库中列的名称吗？

提示：在 Relations.Add(relation) 行上打断并仔细检查关系对象。

代码没有显示 bindinsource 组件的制作位置/方式，也许它们设置了一些设计时属性（过滤器）。

# asp.net-mvc - 实体框架 + SQLite 部署

> ID：553203
> 
> 赞同：6
> 
> 时间：2009-02-16T12:48:53.923
> 
> 标签：asp.net-mvc, entity-framework, sqlite, system.data.sqlite

我有一个 ASP.NET MVC 应用程序，它通过实体框架使用 SQLite 数据库。一切都在 VS 2008 的本地开发网络服务器上运行。

但是，将 Web 应用程序部署到我的服务提供商会导致此错误：

```
[ArgumentException: Unable to find the requested .Net Framework Data Provider.  It may not be installed.]
   System.Data.Common.DbProviderFactories.GetFactory(String providerInvariantName) +1308959
   System.Data.EntityClient.EntityConnection.GetFactory(String providerString) +35 
```

服务提供商评论说他们不支持 SQLite。我认为 SQLite 独立于服务提供商的设置，因为它是 App_Data 可部署的。

有没有人成功部署实体框架 + SQLite 的经验？

干杯，-pom-

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-07-11T07:44:23.640

您不太可能再阅读此内容，但您的 app.config（或者，对您而言，web.config）中缺少以下内容：

```
<configuration>
  <system.data>
    <DbProviderFactories>
      <remove invariant="System.Data.SQLite" />
      <add name="SQLite Data Provider" invariant="System.Data.SQLite" 
           description=".Net Framework Data Provider for SQLite"
           type="System.Data.SQLite.SQLiteFactory, System.Data.SQLite" />
    </DbProviderFactories>
  </system.data>
</configuration> 
```

具体来说，如果您在链接到您的网站的库中使用 sqlite，则必须将其添加到**网站的配置文件中 - 而不是库！** 这是因为您加载提供程序的方式：本质上，您是在运行时使用字符串“System.Data.SQLite”确定要加载的 dll，并使用条目程序集的设置来定位适当的提供程序.

***编辑：***顺便说一句，当您编写具有 sqlite 依赖关系的库时，您可以避免这种复杂性。您不需要`DbProviderFactories`在运行时使用来查找 sqlite；您也可以采用编译时依赖关系，这可以更容易管理。然后你可以忽略上面的 app.config 部分，而是替换所有实例：

```
DbProviderFactories.GetFactory("System.Data.SQLite").CreateConnection() 
```

和

```
System.Data.SQLite.SQLiteFactory.Instance.CreateConnection() 
```

如果这样做，您将使用普通库调用来创建连接，并且没有运行时选择 db 提供程序。这可能不太灵活，因为您不能再通过配置文件交换数据提供者，但对于许多库来说就足够了。不幸的是，如果你不控制库代码，这不是一个选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T13:07:37.170

您是否尝试将所需的 DLL (s) 添加到应用程序的 bin 目录中？您可能想查看 Phil Haack 关于[Bin Deploying ASP.NET MVC](http://haacked.com/archive/0001/01/01/bin-deploy-aspnetmvc.aspx)的文章，了解如何自动执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-15T14:27:20.463

SQLite 需要完全信任权限才能部署 ASP.NET 应用程序。许多共享托管服务提供商不允许这样做。你可能不想检查这个。

# sql-server-ce - SQL Server CE：将行插入表的顶部

> ID：553206
> 
> 赞同：2
> 
> 时间：2009-02-16T12:49:24.403
> 
> 标签：sql-server-ce

这可能吗？这样做的原因是我正在使用像队列这样的表，按顺序弹出 TOP(1) 元素进行处理。我想插入一些要立即处理的行。顺便说一句，这是ce 3.5，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T12:56:11.550

您需要一列来维护顺序，无论是身份还是时间戳。然后你可以执行“select top(1) order by x desc”来获取最新的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T13:01:34.313

在您的数据库上创建一个优先级列，然后对其进行排序（连同您的身份）：

```
CREATE TABLE myqueue(priority INT NOT NULL, id INT IDENTITY NOT NULL PRIMARY KEY, payload VARCHAR(200) NOT NULL)

CREATE INDEX ix_myqueue(priority, id)

INSERT
INTO myqueue (priority, payload)
VALUES (0, 'Regular message')

INSERT
INTO myqueue (priority, payload)
VALUES (1, 'Urgent message')

SELECT id, payload
FROM myqueue
ORDER BY priority DESC, id DESC
TOP 1

id | payload
2  | Urgent message

DELETE
FROM mytable
WHERE id = 2

SELECT payload
FROM myqueue
ORDER BY priority DESC, id DESC
TOP 1

id | payload
1  | Regular message

DELETE
FROM mytable
WHERE id = 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T12:53:12.337

1）如果您将表格用作队列，则说明您使用了错误的工具来完成这项工作。表是一组固有的无序数据。这是因为

2) 可以根据任何字段的值对行进行排序。这意味着您可以通过添加具有值（通常是 ID）的行在中间“插入”某些内容，该值的值将位于表中的其他行之前。

为什么要使用数据库表来执行此操作？您显然正在寻找优先级队列。如果您这样做是因为您希望正在处理的作业在软件失败时仍然存在，请考虑将所有项目及其优先级添加到表中，然后将它们取出并将它们插入到适当的优先级队列中软件，将您的数据存储与调度机制分离。

# msbuild - 如果我的 MSBuild 脚本使用批处理在目标上“循环”，那么它的依赖项是否也批处理？

> ID：553209
> 
> 赞同：1
> 
> 时间：2009-02-16T12:50:51.343
> 
> 标签：msbuild

有关一些背景信息，请参阅此 MSDN 帖子：[Using metadata to call a target multiple times with different parameters](http://social.msdn.microsoft.com/Forums/en-US/msbuild/thread/417329cb-a6f6-45dd-9a56-98bb4aee74f9/)

提出的解决方案是在任务的输出属性中使用元数据来强制对任务进行批处理。

碰巧我们的构建步骤被划分为几个目标。我的要求是依赖项在某种内部循环中按顺序运行。

我用以下脚本尝试了这个概念：

```
<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="BuildSolutions"
         xmlns="http://schemas.microsoft.com/developer/msbuild/2003"
         ToolsVersion="3.5">
    <ItemGroup>
        <BuildFile Include="myscript.txt">
          <InstallerFileName>MyInstaller1.msi</InstallerFileName>
          <CustomTwiddleBit>true</CustomTwiddleBit>
          <OtherCustomTwiddleBit>false</OtherCustomTwiddleBit>
        </BuildFile>
        <BuildFile Include="myscript.txt">
          <InstallerFileName>MyInstaller2.msi</InstallerFileName>
          <CustomTwiddleBit>false</CustomTwiddleBit>
          <OtherCustomTwiddleBit>true</OtherCustomTwiddleBit>
        </BuildFile>
    </ItemGroup>

    <Target  
        Name="BuildInstallers" 
        Outputs="OutputDir\%(BuildFile.InstallerFileName)" 
        DependsOnTargets="Step3" 
    >
        <Exec Command="echo %(BuildFile.InstallerFileName)" />
    </Target>

    <Target Name="Step1">  
        <Exec Command="echo step 1 %(BuildFile.InstallerFileName)" /> 
    </Target> 

    <Target Name="Step2" 
            DependsOnTargets="Step1">  
        <Exec Command="echo step 2 %(BuildFile.InstallerFileName)" /> 
    </Target> 

    <Target Name="Step3" 
            DependsOnTargets="Step2">  
        <Exec Command="echo step 3 %(BuildFile.InstallerFileName)" /> 
    </Target>      
</Project> 
```

输出如下：

```
Microsoft (R) Build Engine Version 3.5.30729.1  
[Microsoft .NET Framework, Version 2.0.50727.3053]  
Copyright (C) Microsoft Corporation 2007\. All rights reserved.  

Build started 2/16/2009 20:41:14\.  
Project "D:\Source\test\test.proj" on node 0 (BuildInstallers target(s)).  
  step 1 MyInstaller1.msi  
  step 1 MyInstaller2.msi  
Step2:  
  step 2 MyInstaller1.msi  
  step 2 MyInstaller2.msi  
Step3:  
  step 3 MyInstaller1.msi  
  step 3 MyInstaller2.msi  
BuildInstallers:  
  MyInstaller1.msi  
BuildInstallers:  
  MyInstaller2.msi  
Done Building Project "D:\Source\test\test.proj" (BuildInstallers target(s)).  

Build succeeded.  
    0 Warning(s)  
    0 Error(s)  

Time Elapsed 00:00:00.43 
```

任何想法我如何让输出像这样：

```
step 1 MyInstaller1.msi
step 2 MyInstaller1.msi
step 3 MyInstaller1.msi

step 1 MyInstaller2.msi
step 2 MyInstaller2.msi
step 3 MyInstaller2.msi 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T13:06:25.237

我确定这里的问题是

```
<Exec Command="echo step 1 %(BuildFile.InstallerFileName)" /> 
```

将在 InstallerFileName 输出上一次又一次地迭代。我认为您可以改为调用自定义目标，并且该目标会完成您的每个步骤。使用 MSBuild 任务从主脚本调用此目标，如下所示：

```
<MSBuild Projects="CustomTargets.proj" 
  Targets="BuildInstallers"
  Properties="BuildFile=%(BuildFile.InstallerFileName)" /> 
```

在您的 BuildInstallers 目标中，您将使用

```
<Target ="BuildInstallers" DependsOnTargets="Step3" >
</Target>

<Target Name="Step1">  
    <Exec Command="echo step 1 $(BuildFile)" /> 
</Target> 
```

ETC

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-27T15:25:46.973

当你定义目标和依赖时，你定义了一个依赖树。MSBuild 可以自由地以它认为合适的任何顺序执行目标，包括并行（使用时`/m`），只要该顺序不违反任何依赖关系。

在您的情况下，MSBuild 选择首先运行`step 1 MyInstaller1.msi`+ `step 1 MyInstaller2.msi`，如果您添加`/m`，它们可能会并行运行。如果它们不能并行运行，那可能是您设计中的一个限制 - 可能共享相同的中间文件 - 您应该解决这个问题。

如果您出于无法向 MSBuild 解释的性能原因而希望按这种方式排序输出，我想您可以使用上述`<MSBuild>`hack。

# c - C : 静态数组

> ID：553213
> 
> 赞同：5
> 
> 时间：2009-02-16T12:54:06.483
> 
> 标签：c, arrays

我需要`static void* array[1024];`在库中有一个，并且我需要将每个条目都设置为 NULL。

我的问题是关于将整个数组设置为 NULL 的最佳方法，是`memset (array, NULL, sizeof (void*) * 1024)`最好的解决方案吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-16T13:00:04.333

`static`指针自动初始化为`NULL`. 参见 C99:TC3 6.7.8, §10：

> 如果具有自动存储持续时间的对象未显式初始化，则其值是不确定的。如果具有静态存储持续时间的对象未显式初始化，则：
> 
> *   如果是指针类型，则初始化为空指针；
> *   如果它具有算术类型，则将其初始化为（正或无符号）零；
> *   如果是聚合，则每个成员都根据这些规则（递归地）初始化；
> *   如果是联合，则根据这些规则（递归地）初始化第一个命名成员。

* * *

此外，与其他人所写的相反，

```
memset(array, 0, sizeof(array)); 
```

不保证会产生空指针。在某些系统上，所有位都设置为的指针`0`实际上可能是有效的。对于主流系统，情况并非如此，但对于嵌入式系统，人们永远不知道。

将所有条目设置为空指针的安全方法是自己循环遍历条目并将它们设置为`NULL`，或者使用未初始化的`static`数组，您可以`memcpy()`在要设置的数组上使用该数组`NULL`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-16T12:56:53.967

```
static void* array[1024] = {0}; 
```

或者，正如 kmkaplan 在评论中指出的那样，只是：

```
static void* array[1024]; 
```

虽然我更喜欢第一个解决方案只是为了提醒我它被设置为零（编译器不应该为此生成任何代码，除非它是脑死的）。

您根本不需要 memset 它，因为文件级变量无论如何都初始化为零。

如果您需要在启动后的某个时候将它们**重置为 NULL，请使用：**

```
memset(array, 0, sizeof(array)); 
```

这适用于大多数平台（我见过的每个平台，而且很多），因为空指针通常为零位。但是标准并不能保证这一点，所以在那些不起眼的平台上，这样做更安全：

```
for (i = 0; i < sizeof(array) / sizeof(void*); i++)
    array[i] = NULL; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T13:01:44.563

memset 将在运行时执行此操作。

```
static void* array[1024] = {0}; 
```

Pax 建议将在编译时执行此操作，并且会增加可执行文件的大小。

对于图书馆，我认为 memset 更合适。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T13:05:08.033

所有你需要的是：

```
 static void* array[1024]; 
```

because static variables are initialized to 0 anyways, so you don't really need to initiate this array, it will happen automatically.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T12:56:28.303

不，这是错误的。您没有考虑每个元素的大小。

```
memset(array, 0, sizeof(array)); // this works only on static arrays. 
```

通常你应该使用：

```
memset(array_reference, 0, size_of_array * sizeof(array_element_type)); 
```

# java - RSS4J项目的去向

> ID：553224
> 
> 赞同：1
> 
> 时间：2009-02-16T13:00:24.753
> 
> 标签：java, rss, class-library

任何人都知道 RSS4J 的项目主页是什么。我在 Maven 存储库上找到了几个参考，但找不到原始项目站点。这个项目还活着吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T13:31:17.610

它位于 www.churchillobjects.com，但该域现在已转移到域停放站点。Wayback Machine从 2007 年 2 月开始提供 RSS4J 的[此页面](http://web.archive.org/web/20070202202600/www.churchillobjects.com/c/13005.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T14:01:10.910

看起来[RSS4J](http://rss4j.sourceforge.net/)托管在 SourceForge 上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-01T05:24:54.303

在 SourceForge 中，项目是空的。谢谢土豆头先生。

# asp.net - 在 asp.net 中执行回发操作后刷新页面

> ID：553227
> 
> 赞同：18
> 
> 时间：2009-02-16T13:01:58.727
> 
> 标签：asp.net, postback, refresh

我在我的 asp.net 网格中添加了命令按钮。使用该按钮执行操作后，我们刷新网格以反映新数据。（基本上这个动作复制了网格行）。

现在，当用户使用 刷新页面时`F5`，如果我们选择“重试”，则会显示一条警告消息（将信息重新发送到服务器），该操作会自动重复。

我知道这是 asp.net 中的一个常见问题，我们怎样才能最好地处理这个问题？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-16T13:20:14.923

在 POST 之后搜索 GET - [http://en.wikipedia.org/wiki/Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get) - 基本上，在您完成事件处理后重定向到当前页面。

就像是：

`Response.Redirect(Request.RawUrl)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T13:06:01.573

如果您认为不需要回发范例，则可能需要查看 ASP.NET MVC。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T14:04:05.083

问题是当您按下按钮时，asp.net 按钮会执行表单发布。如果您用链接替换按钮，您的问题应该会消失。您还可以使用一个按钮来执行将 document.location 设置为页面地址的 javascript 函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T13:08:04.233

如果我很好理解，您只需在填充网格之前检查您是否处于回发状态。
假设您在 上执行此`Page_Load`操作，只需将操作用回发测试包围，如下所示：

```
private void Page_Load(object sender, EventArgs e)
{
    if(!this.IsPostBack)
    {
        // populate grid
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T13:20:57.260

您需要调用 response.Redirect(Request.Url.ToString());

或者您可以使用 updatepanel 包装网格，并在每个命令之后将数据源绑定到网格

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-02T19:08:01.557

在你的`<asp:Repeater>`标签里面放这个：

```
EnableViewState="false" 
```

这将导致您的控件在每次页面加载时刷新，无论它是否是回发。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-10-23T13:51:27.163

例如：如果您单击“按钮”，系统将捕获事件“按钮单击”。如果刷新页面，系统将再次执行相同的事件。没有这个问题，在您的活动中插入：在您的活动中

```
private void button_click(object sender, System.EventArgs e)
{
    button.Enabled =false;
    button.Enabled =true;
} 
```

你是什​​么意思？

# maven-2 - 使用 Maven 进行项目分发

> ID：553235
> 
> 赞同：5
> 
> 时间：2009-02-16T13:05:11.637
> 
> 标签：maven-2, distribution, software-distribution

我有一个项目，我通过发送大包来分发。我想知道是否有使用 Maven 分发项目更新的用户友好方式？我需要类似更新 Firefox 或 Acrobat Reader 等软件的方法。检查存储库，警告用户更新，下载和重新配置。所有这些都在一个简单友好的界面中。欢迎替代开源 Java 项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T13:32:46.360

如果您的项目是一个库：您需要设置一个[公共 maven 存储库](http://maven.apache.org/guides/introduction/introduction-to-repositories.html)（或使用 Maven Central）。这样，您的用户可以通过更新他们的 POM 来获取最新版本的库。

如果您的项目是其他项目，您可以使用 Maven 存储库将包保存在一个地方，以便您轻松部署（并为其他所有人轻松下载）。接下来，您需要将您的软件指向该站点并偶尔下载文件“maven-metadata.xml”。当你说“mvn deploy”时，Maven 会为你创建和管理这个文件。该文件包含最新的版本号。

您所要做的就是下载这个小文件并检查它。如果有新版本，请为您的用户打开一个对话框，以便他们决定下载它。我建议将“仅下载”和“下载并升级”作为单独的选项提供，因为用户喜欢在后台下载一段时间，然后在两个项目之间进行安装。他们不喜欢唠叨的对话框（“新版本可用。现在下载并毁掉你的一天？” ...“我五分钟前问过。立即下载！” ...“无论如何下载。在您的硬盘上找到信用卡详细信息. 选择您需要的其他重要软件。现在购买。祝您有美好的一天！" ;) )。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T04:44:50.133

我不认为 maven 有任何标准的方式来提供这个功能。Maven 确实有“发布”和“部署”的概念，但这些不适用于您所描述的场景。

# javascript - Mozilla firefox中没有为javascript函数定义事件？

> ID：553240
> 
> 赞同：6
> 
> 时间：2009-02-16T13:06:56.327
> 
> 标签：javascript, internet-explorer, firefox, cross-browser

```
function onlyNumeric() {   
    if (event.keyCode < 48 || event.keyCode > 57) {
        event.returnValue = false; 
    }

}

onkeypress=onlyNumneric(); 
```

在 IE 中，此代码运行良好。但是，在 Mozilla Firefox 中，该事件是未定义的错误。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-16T13:11:09.937

在 FF/Mozilla 中，事件作为参数传递给您的事件处理程序。使用类似下面的方法来绕过 IE 中缺少的事件参数。

```
 function onlyNumeric(e)
 {
     if (!e) {
        e = window.event;
     }

     ...
 } 
```

您会发现两者之间还有一些其他差异。此[链接](http://www.javascriptkit.com/javatutors/javascriptkey2.shtml)包含有关如何检测以跨浏览器方式按下哪个键的一些信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-29T22:56:46.003

或者很简单，命名*参数* **事件**，它将在所有浏览器中工作。这是一个 jQueryish 示例：

```
 $('#' + _aYearBindFlds[i]).on('keyup', function(event) {
  if(! ignoreKey({szKeyCodeList: gvk_kcToIgnore, nKeyCode: event.keyCode }))  this.value = this.value.replace(/\D/g, '');
  }); 
```

此示例仅允许为年份字段（在每个循环选择器内）输入数字，其中 ingoreKey() 采用 keyCode 列表/数组并比较事件 keyCode 并确定在触发绑定事件之前是否应忽略它。

我通常用于掩码/其他的键是箭头、退格键、制表符，具体取决于上下文/所需的行为。

在大多数浏览器中，您通常也可以使用 event.which 而不是**event.keyCode**，至少当您使用依赖于 event.which 来规范化键和鼠标事件的 jQuery 时。

我不确定在 js 引擎的幕后会发生什么，但似乎 Mozilla FF 尊重更严格的范围，其中，当事件不是时，其他浏览器可能会自动处理**window.event.keyCode**范围显式传递给函数或闭包。

在 FF 中，您还可以通过**window.event**来处理事件（如这里的一些示例所示），这将支持这种想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-09T07:53:04.380

有些浏览器可能不支持 keyCode 你必须使用 keyChar

```
function onlyNumeric() {   
    var chars = event.keyCode | event.keyChar;
    if (chars  < 48 || chars  > 57) {
        event.returnValue = false; 
    }

}

onkeypress=onlyNumneric(); 
```

# c# - 获取所有可用语言的编程方式（在附属程序集中）

> ID：553244
> 
> 赞同：33
> 
> 时间：2009-02-16T13:07:45.047
> 
> 标签：c#, .net, localization, cultureinfo

我正在使用 .resx 文件设计多语言应用程序。

我有一些文件，如 GlobalStrings.resx、GlobalStrings.es.resx、GlobalStrings.en.resx 等。当我想使用它时，我只需要设置 Thread.CurrentThread.CurrentCulture。

问题：我有一个包含所有可用语言的组合框，但我手动加载它：

```
comboLanguage.Items.Add(CultureInfo.GetCultureInfo("en"));
comboLanguage.Items.Add(CultureInfo.GetCultureInfo("es")); 
```

我试过了

```
cmbLanguage.Items.AddRange(CultureInfo.GetCultures(CultureTypes.UserCustomCulture)); 
```

没有任何成功。还尝试了 CultureTypes 中的所有元素，但我只得到一个包含更多我没有使用的语言的大列表，或者一个空列表。

有没有办法只获得支持的语言？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-06-15T09:21:16.810

您可以以编程方式列出应用程序中可用的文化

```
// Pass the class name of your resources as a parameter e.g. MyResources for MyResources.resx
ResourceManager rm = new ResourceManager(typeof(MyResources));

CultureInfo[] cultures = CultureInfo.GetCultures(CultureTypes.AllCultures);
foreach (CultureInfo culture in cultures)
{
    try
    {
        ResourceSet rs = rm.GetResourceSet(culture, true, false);
        // or ResourceSet rs = rm.GetResourceSet(new CultureInfo(culture.TwoLetterISOLanguageName), true, false);
        string isSupported = (rs == null) ? " is not supported" : " is supported";
        Console.WriteLine(culture + isSupported);
    }
    catch (CultureNotFoundException exc)
    {
        Console.WriteLine(culture + " is not available on the machine or is an invalid culture identifier.");
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-08-22T22:41:41.387

基于@hans-holzbart 的回答，但固定为不返回 InvariantCulture 并包装成可重用的方法：

```
public static IEnumerable<CultureInfo> GetAvailableCultures()
{
  List<CultureInfo> result = new List<CultureInfo>();

  ResourceManager rm = new ResourceManager(typeof(Resources));

  CultureInfo[] cultures = CultureInfo.GetCultures(CultureTypes.AllCultures);
  foreach (CultureInfo culture in cultures)
  {
    try
    {
      if (culture.Equals(CultureInfo.InvariantCulture)) continue; //do not use "==", won't work

      ResourceSet rs = rm.GetResourceSet(culture, true, false);
      if (rs != null)
        result.Add(culture);
    }
    catch (CultureNotFoundException)
    {
      //NOP
    }
  }
  return result;
} 
```

使用该方法，您可以获得要添加到某些 ComboBox 的字符串列表，其中包含以下内容：

```
public static ObservableCollection<string> GetAvailableLanguages()
{
  var languages = new ObservableCollection<string>();
  var cultures = GetAvailableCultures();
  foreach (CultureInfo culture in cultures)
    languages.Add(culture.NativeName + " (" + culture.EnglishName + " [" + culture.TwoLetterISOLanguageName + "])");
  return languages;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-10-06T06:54:36.653

这将是基于以下陈述的解决方案之一：
*特定语言的每个附属程序集都具有相同的名称，但位于以特定文化命名的子文件夹中，例如 fr 或 fr-CA。*

```
public IEnumerable<CultureInfo> GetSupportedCulture()
{
    //Get all culture 
    CultureInfo[] culture = CultureInfo.GetCultures(CultureTypes.AllCultures);

    //Find the location where application installed.
    string exeLocation = Path.GetDirectoryName(Uri.UnescapeDataString(new UriBuilder(Assembly.GetExecutingAssembly().CodeBase).Path));

    //Return all culture for which satellite folder found with culture code.
    return culture.Where(cultureInfo => Directory.Exists(Path.Combine(exeLocation, cultureInfo.Name)));
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T13:12:35.863

我不确定获取语言，也许您可​​以扫描安装文件夹中的 dll 文件，但将语言设置为不受支持的语言应该不是问题。

如果找不到特定于文化的文件，.NET 将回退到文化中性资源，因此您可以安全地选择不受支持的语言。

只要您自己控制应用程序，您就可以将可用语言存储在某个应用程序设置中。只需一个带有文化名称的逗号分隔字符串就足够了：“en, es”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-16T21:28:06.623

使用符文格里姆斯塔所说的，我最终得到了这个：

```
string executablePath = Path.GetDirectoryName(Application.ExecutablePath);
string[] directories = Directory.GetDirectories(executablePath);
foreach (string s in directories)
{
    try
    {
        DirectoryInfo langDirectory = new DirectoryInfo(s);
        cmbLanguage.Items.Add(CultureInfo.GetCultureInfo(langDirectory.Name));
    }
    catch (Exception)
    {

    }
} 
```

或其他方式

```
int pathLenght = executablePath.Length + 1;
foreach (string s in directories)
{
    try
    {
        cmbLanguage.Items.Add(CultureInfo.GetCultureInfo(s.Remove(0, pathLenght)));
    }
    catch (Exception)
    {

    }
} 
```

我仍然不认为这是一个好主意......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-08-28T01:20:13.157

指定要搜索的资源类型的通用答案。使用反射但被缓存。

用法：

```
List<string> comboBoxEntries = CommonUtil.CulturesOfResource<GlobalStrings>()
    .Select(cultureInfo => cultureInfo.NativeName)
    .ToList(); 
```

实现（实用程序类）：

```
static ConcurrentDictionary<Type, List<CultureInfo>> __resourceCultures = new ConcurrentDictionary<Type, List<CultureInfo>>();

/// <summary>
/// Return the list of cultures that is supported by a Resource Assembly (usually collection of resx files).
/// </summary>
static public List<CultureInfo> CulturesOfResource<T>()
{
    return __resourceCultures.GetOrAdd(typeof(T), (t) =>
    {
        ResourceManager manager = new ResourceManager(t);
        return CultureInfo.GetCultures(CultureTypes.AllCultures)
            .Where(c => !c.Equals(CultureInfo.InvariantCulture) && 
                        manager.GetResourceSet(c, true, false) != null)
            .ToList();
    });
} 
```

它可能会遇到与接受的答案相同的问题，因为可能会加载所有语言资源。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-05T12:12:45.223

@"Ankush Madankar" 提出了一个有趣的起点，但它有两个问题：1) 还找到了引用程序集资源的资源文件夹 2) 没有找到基本汇编语言的资源

我不会尝试解决问题 2），但对于问题 1），代码应该是

```
public List<CultureInfo> GetSupportedCultures()
{
    CultureInfo[] culture = CultureInfo.GetCultures(CultureTypes.AllCultures);

    // get the assembly
    Assembly assembly = Assembly.GetExecutingAssembly();

    //Find the location of the assembly
    string assemblyLocation =
        Path.GetDirectoryName(Uri.UnescapeDataString(new UriBuilder(assembly.CodeBase).Path));

    //Find the file anme of the assembly
    string resourceFilename = Path.GetFileNameWithoutExtension(assembly.Location) + ".resources.dll";

    //Return all culture for which satellite folder found with culture code.
    return culture.Where(cultureInfo =>
        assemblyLocation != null &&
        Directory.Exists(Path.Combine(assemblyLocation, cultureInfo.Name)) &&
        File.Exists(Path.Combine(assemblyLocation, cultureInfo.Name, resourceFilename))
    ).ToList();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-18T00:47:33.127

**1.**获取**用户**偏好的语言集，按偏好顺序排列：

```
Windows.System.UserProfile.GlobalizationPreferences.Languages; 
```

**2.**获取或设置此上下文（**应用程序**）的语言限定符：

```
Windows.ApplicationModel.Resources.Core.ResourceContext.GetForCurrentView().Languages; 
```

两者都是`List<string>`。

# jquery - jquery href 返回未定义

> ID：553246
> 
> 赞同：1
> 
> 时间：2009-02-16T13:08:07.917
> 
> 标签：jquery

我的 HTML 中有这个

```
<a class="deleteLink" href="system/id">link</a> 
```

然后使用 jQuery，我在 $(document.ready(function()

```
alert($("a.deleteLink").attr("href")); 
```

显示**系统/ID**

但是运行这个：

```
alert($("a.deleteLink").href); 
```

显示**未定义**

如果我像这样将 Id 添加到 a 标签

```
<a id="myId" class="deleteLink" href="system/id">link</a> 
```

然后

```
alert(myId.href); 
```

显示**[http://localhost/system/id](http://localhost/system/id)**这是我想从 jQuery 获得的（所以我可以做类似的事情

```
$.post($("a.deleteLink").href); 
```

谁能帮我从jQuery（1.2.6）中获取完整的href值吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-16T13:21:20.897

$("...") 返回一个 jQuery 对象（也称为“包装集”）。包装集没有 href 属性。如果你这样做：

```
alert($("a.deleteLink")[0].href); 
```

它应该正确返回 href 属性。当您处理“myId”时，您处理的是一个 DOM 元素对象。与包装套装完全不同。我在那里使用的索引运算符是 get(0) 的缩写，它从包装集中返回一个元素。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T13:20:04.610

现在我知道你想做什么了。

试试这个：

```
alert( $("a.deleteLink")[0].href ); 
```

# user-interface - 时间追踪的UI设计

> ID：553248
> 
> 赞同：3
> 
> 时间：2009-02-16T13:08:55.683
> 
> 标签：user-interface, ui-design

我正在尝试为计时系统设计一个界面，让用户“一目了然”地看到还需要完成多少时间。

由于没有固定的工作时间，这使情况变得复杂 - 员工必须在任何给定的工作日至少工作 6 小时，并且在每个月月底该月的每个工作日应该工作 7.5 小时。任何一种方式的7.5小时都可以结转到下个月。员工每月最多可占用 1 个上午和 1 个下午的“弹性”时间。时间需求应该在第二天 10.15 之前记录下来，但是这条规则在繁忙时间是弯曲的，周末，尤其是月底的界限变得更加重要。

那么，什么是最易读的格式来显示当前输入的时间并突出显示未完成条目的接近截止日期，同时仍然让人感觉员工的领先/落后程度（即，如果你那个月还有一周的时间，你提前 8 小时您可以安排一些额外的羽绒被时间）。

我的第一个想法是每天的条形图，在 6 处有一条红线。但这并不能让您了解每天或每月的领先或落后程度，或者您是否接近错过最后期限。 .

![条形图](https://i.stack.imgur.com/YVeuA.png)（请原谅可怕的模型）

也许我试图在一个地方传达太多信息？

--

这是 Dickon Reed 建议的记录时间与所需时间的模型 ![时间与目标的关系图](https://i.stack.imgur.com/BM8ev.png)

--

编辑：这一面非常适合这样的东西。我将在早上讨论其中的一些想法，并希望能在这里发布一些内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T13:52:15.767

“试管/温度计”图像怎么样，就像他们为慈善机构所做的那样……随着时间的推移，它会填满，试图达到一个目标（红线）。

用不同的颜色填充每一天，并相应地标记……如果用户加班 MT，他们可能在星期五之前到达了线路，等等。

类似于： [替代文字 http://goyamarketing.com/blog/wp-content/uploads/2008/11/goal_thermometer.gif](http://goyamarketing.com/blog/wp-content/uploads/2008/11/goal_thermometer.gif)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T18:29:23.150

您的第一个图表可以通过显示剩余时间来改进，如下[所示](http://img11.imageshack.us/img11/6755/20090216203339em2.png)。直到下一个每周/每月截止日期的剩余时间平均分配给截止日期前的剩余天数。所以 UI 会回答这个问题：“我每天需要工作多少小时才能满足我的截止日期？” 如果用户想在一个上午/下午休息（或者我对你的理解有误？），你应该有一个当天的复选框，在检查哪些估计值会相应地调整之后。

您还应该在每个垂直条的顶部显示确切的时间，这样用户就不需要在脑海中估计它（我很懒，只将它们添加到模型中的几个条中）。还要突出显示当天，例如在下图中，这是通过圈出“星期四”并使用粗体字体表示用户今天工作的时间来完成的。您还可以为今天的垂直条使用一些视觉效果。

[改进的条形图 http://img11.imageshack.us/img11/6755/20090216203339em2.png](http://img11.imageshack.us/img11/6755/20090216203339em2.png)

对于您的第二张图表，您还应该将每周或每月的截止日期绘制为水平条。在某些情况下，第二张图表可能会更好，但在这种情况下，我会选择第一张图表（经过我的改进），因为它可能更符合用户的心理模型，这样您还可以可视化每日最少 6 小时某种方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T13:23:15.337

字符条在视觉上看起来不错，但你真正需要知道的是你在你的时间里落后/领先多远。

如果我理解正确，您只对您当前的 Saldo 和您当前的截止日期感兴趣，因此您可以在 2 个单独的字段中显示该信息（例如在图表下方）。当然，您也可以在图表中用一些水平线标记截止日期。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T13:46:41.880

一个饼图怎么样，其中总大小代表最小目标，并为每一天添加饼片，其中实际天数满足最小一种颜色，天数有额外时间，然后将剩余天数填充为灰色切片，其中包含小时数员工将不得不在他们之间平均分配工作？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T15:43:05.733

在 X 轴上带有“经过的工作日”和在 Y 轴上带有“每月所需工作完成的部分”的线图？只有几个数据点，通过直观地推断您是否会早晚达到顶峰应该很清楚。情节看起来像一个不规则的楼梯。

附言。Edward Tufte 的“定量信息的视觉显示”是一本关于这类主题的好书。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-16T23:08:41.700

为了让迪肯·里德的想法更进一步，为什么不将每个点都提前或落后 +/- 小时，基线始终为 0。这样你就有更多的细节。我不确定我是否理解了我的观点，但没有一个例子很难做到，而且我的时间很短。

# sql-server - 将海量数据迁移到 SQL

> ID：553249
> 
> 赞同：3
> 
> 时间：2009-02-16T13:09:16.697
> 
> 标签：sql-server, timeout, migration, wmi, cluster-computing

我需要将大量数据（数百万个文件，TB 级数据）迁移到 SQL 集群。迁移过程被划分为每周迁移，每周有数百个新用户（即请求生成器）。

到目前为止，一切进展顺利，但最近我发现 SQL 集群开始表现得很奇怪。CPU 使用率稳定在 20% 左右，但 SQL 进程不断分配新内存，直到没有剩余内存（约 12GB）。发生这种情况时，该进程会“转储”所有内存并重新开始向 12GB 攀升。在此转储期间，通常会出现服务器无响应并最终超时的情况，而这在这周的迁移中是不可能发生的。

这种分配和转储行为是否常见于 SQL 集群？是否可以对其进行配置以使这种情况永远不会发生，或者至少不会使整个数据库拥塞？有人有大型移民工作的经验吗？

查看事件日志时，我发现在超时之前有一些 WMI 警告。我们正在使用 System Center Operations Manager 2007 来忽略系统，这可以解释这种行为吗？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T13:24:35.240

不，这不是正常行为。

SQL Server 将根据需要动态分配内存，并在面临压力时适当地释放内存。但是，它不应该转储全部内容。

您能否提供有关您的环境的更多详细信息并确定您的 SQL 内存配置是什么。

如果您需要详细的帮助，请随时给我发电子邮件，并请提供 DBCC 命令的结果。

```
DBCC memorystatus 
```

# c# - 如何嵌入媒体播放器

> ID：553253
> 
> 赞同：0
> 
> 时间：2009-02-16T13:11:52.183
> 
> 标签：c#, .net, media

如何在 C# .NET 中嵌入点唱机或媒体播放器？

或者更确切地说，创建一个可以播放 WAV 文件的播放列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T13:18:53.053

您可以嵌入微软媒体播放器 COM 组件并通过代码对其进行控制。

[如何在 C# 中与 Windows Media Player 交互](https://stackoverflow.com/questions/56478/how-to-interact-with-windows-media-player-in-c)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T13:23:19.813

Soundplayer 只播放声音，windows media player 用于在表单上播放音频/视频

[Soundplayer](http://msdn.microsoft.com/en-us/library/system.media.soundplayer.aspx) [Windows 媒体播放器](http://www.c-sharpcorner.com/UploadFile/satisharveti/EnhancedWindowsMediaPlayer07072008021113AM/EnhancedWindowsMediaPlayer.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T15:37:34.813

如果您使用的是 .NET Framework 3.5 和 WPF，您可以尝试 System.Windows.Media.MediaPlayer

[http://msdn.microsoft.com/en-us/library/system.windows.media.mediaplayer.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.mediaplayer.aspx)

# project-management - 评估软件估算：确定不切实际数字的迹象？

> ID：553255
> 
> 赞同：24
> 
> 时间：2009-02-16T13:12:39.373
> 
> 标签：project-management, evaluation, estimation

[在回答Ash](https://stackoverflow.com/users/5023/ash)发布的“<a href="https://stackoverflow.com/questions/549597/dealing-with-awful-estimates/553200#553200">处理糟糕的估计”时，我分享了一些我学到的技巧和个人用来发现弱估计。但我确信肯定还有更多！

在需要对第三方（同事、业务合作伙伴或外部公司）编制的软件项目估算进行快速评估的场景中使用什么启发式方法？

在没有对手头任务的详细了解的情况下，可以发现哪些明显的和不那么明显的软件估计弱的迹象？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-16T13:25:04.083

*   一个人完成了估计，而不是使用基于共识的估计（以充分理解隐含的需求范围），例如[Wideband Delphi](http://en.wikipedia.org/wiki/Wideband_delphi)。
    *   **如果进行估算的人不是执行实施的人，则尤其如此！**- 我曾经在一个项目上工作过，这个项目被别人估计是在提出任何要求之前 60 天。可以说我不是一只快乐的兔子
*   没有时间做文档。
*   没有时间提升（在学习和团队规模方面）。
*   没有列出风险及其对时间尺度的影响。
*   对意外情况没有缓冲 - 就最新要求和风险而言。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-16T18:12:52.457

没有人说过，所以我会的。显而易见的答案是，如果您有软件进度估算，那么这肯定是不切实际数字的迹象。是的，有许多评估软件的方法，但没有一种方法在任何方面、形状或形式上都是准确的。通常发生的情况是设定了最后期限。如果任务被高估，则需要花费额外的时间使结果更好。如果任务被低估了，那么就会牺牲一些东西来满足交付（比如测试和特性）。

我知道这个答案不是人们愿意相信的，但估计总是一种猜测。通常情况下，开发人员甚至无法预测他们将在一天结束时完成多少。您期望他们在几个月/几年后猜测他们甚至不确定真正涉及的事情。

对于您的问题，唯一不会给出不切实际结果的实用答案是使用根据您公司以前的历史提出的猜测的工作表。不幸的是，这并不能解释估算器错过的任务。至少这可能会给出大致数字。

除非你一遍又一遍地开发出相同系统的仿制品，否则任何认为他们已经弄清楚这一点的人都是在自欺欺人。涉及的变量太多了。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-16T13:24:50.933

有两种类型的估算：**任务估算**和**项目估算**。您可以将这些视为大小图片。

项目估算必须是高水平的（粒度通常不小于天），并且必须包括以下内容：

*   高级架构；
*   测试时间；
*   加速时间；
*   缺陷过程；
*   文件时间；
*   相关培训；
*   假设；
*   依赖关系（例如，在 B 团队交付第一阶段之前，A 团队无法做他们需要做的事情）；
*   关键路径（哪些部分可能决定项目是否会滑倒以及滑倒多少）；和
*   风险。

遗漏的东西越多，估计就越不切实际（或冒险）。

第二种任务估计，通常低得多。对于这种估计，它应该只是一个任务分解（没有任务大于 5 天）。

这些并不倾向于解决上述项目，但其中一些可能是相关的，例如关于尚未做出决策的假设（例如生产硬件）。由于相关经验、背景知识或技能（因为那个人或那些人最终可能过度投入），确定谁可以和不能完成任务也可能是值得的。

其他帖子提到测试时间应该等于或超过开发时间。我强烈不同意这一点。我已经看到 8 小时的开发任务导致 100 多个小时的测试时间，而 80 小时的开发任务导致不到 2 小时的测试。在这两种情况下，测试时间都是完全合理的。两者之间没有绝对的相关性。充其量是松散的连接。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-09T15:56:55.357

*   估计是管理层想要被告知的吗？
*   估计是否与下一个版本的计划发货日期吻合？
*   管理层是否奖励给予好消息的人多于给予坏消息的人？
*   在知道谁将从事该项目之前，是否已准备好估算？
*   是否有人想要在功能上实现这一点准备估算？
*   有软件迟到的历史吗？
*   开发人员在项目中途转移到其他任务是否正常？
*   是否有一些或所有开发人员放弃评论错误估计是浪费时间？

数一数你得到“是”或“也许”答案的问题数量……</p>

如果您对上述问题的回答大多是“否”，那么可能值得详细查看估算，看看它是否包括其他人在此线程中列出的任务。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-11T19:02:40.807

哇...我真的很喜欢工具包的答案。

而且我同意任何估算都是有缺陷的，因为它假设估算者比任何估算者在估算项目时实际上拥有更多关于如何解决问题的线索。但是，我认为您仍然需要在开始之前至少估计这座山的大小。一些人认为是否值得尝试做它应该先于任何努力，这就是估计的本质应该是什么。

我确实提出了一些危险估计的指标：

*   **没有交叉引用**——如果估计不能以至少两种不同的方式进行验证，它可能是不可靠的。例如，我所做的最后一次估计，我已经能够将工作分解成小的功能块，并考虑我们的团队花了多长时间来完成类似范围的功能。然后，我能够查看这些成本的总和，并了解相对于我从事的其他项目的范围有多大。这是两种验证方式。
*   **估算器的背景**——如果这是一个从未编写过代码的硬件人员所做的软件估算——要非常害怕。更微妙 - 估算者的背景越接近项目的技术和问题域越好。
*   **细节**- 正如在几篇不同的帖子中所说的几种不同的方式 - 我喜欢查看单个功能的详细信息，以及完成每个功能所需的任务。我看到的大多数估算都没有在正式演示中显示细节，但是如果你问做估算的人，他们应该在某个地方有一个文件。希望它不是沾满啤酒和番茄酱的餐巾纸的背面。:)
*   **记录假设**- 任何估算者都必须对任务做出一些假设。这些应该记录在某个地方，最好是在正式的文书工作中。当我看到一个没有太多记录假设的简短提案时，我总是有点担心。要么是经过深思熟虑而没有与客户沟通，要么是没有经过深思熟虑。老实说，我不确定哪个更糟。不用说，假设也应该是合理的。
*   **Balanced Lifecycle** - 然而任务被分解，设计、代码和测试的比例是多少？文档、与外部系统的集成和发布后支持如何？那些非常重要的额外事情（系统管理员、CM 专家、管理工作）怎么样？
*   **松懈**——我敢肯定，廉价的企业守护进程会来剥我的皮，但时间表和成本应该有一些松懈。如果估计在有经验的人看来是雄心勃勃和激进的，那么它可能太低了。估计几乎永远不会太高。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-16T13:15:58.583

一个很好的启发式方法是查看测试时间是否与开发时间大致相同。这是估计的好兆头。

如果他们不能给你估计的细目，那是一件坏事。通常是许多可能被遗忘的小事的标志。他们不需要提供完整的原始细分，只需提供如下细分：

*   要求
*   发展
*   测试
*   打包和部署
*   等等

他们应该使用标准模板来计算他们的估计。他们不需要在每一列中都有一个数字，但他们使用模板来列出所有可能的任务。这样，在进行估算时，模板就可以用来激发人们的思想。

如果估计过于精确，例如增量为 0.25 小时，那么对我来说，那是一种难闻的气味。

如果缺少诸如需求捕获、测试、部署和移交给任何 Ops 组之类的东西？如果其中任何一个缺失，那就是那种会回来咬你的东西。

**编辑：**要注意的另一件事是旧的“永远完成 90%”的任务。在将任务列为“90% 完成”的进度更新后，您将获得进度更新。这不好！

高温高压

干杯

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-16T13:55:07.007

*   估算的编制者是否可用并愿意与其他高级项目成员讨论？如果没有，这通常是一个问题。

*   在开发人员的经验和技能已知*之前*，是否将估算发送给客户。两点估计可能有所帮助，但仅在一定程度上有所帮助。

*   甚至在有机会查看估算之前，您就会被告知您致力于交付特定日期所描述的所有功能。

（顺便说一句，感谢您回答我的问题。）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-09T16:34:17.653

如果您看到其中的一个或多个，您可能有一个错误的估计：

*   单点估计：估计应该与一系列可能的日期或置信度值相关联
*   任务的粒度不足：一个大的任务桶通常表明功能没有被很好地理解（这尤其是一个问题，因为理解不足的问题通常被低估了）
*   不表达假设和/或风险
*   为通常被跳过或低估的项目（例如构建脚本、文档、部署等）分配的工作量不足

我同意 sateesh 的观点，我真的很喜欢软件估算：史蒂夫·麦康奈尔 (Steve McConnell) 的《揭秘黑色艺术》。他有几个清单，在审查和/或准备估算时很有用。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-15T10:58:01.200

我完全同意 Dunk 的观点，**糟糕的估计的第一个迹象**就是存在大量详细的前期时间表。估计值就是这样，一个近似值，否则我们会称它们为*精确*估计值。因此，它们不应该单独用于项目管理。

要考虑的最重要的一点不是估计的*准确性，而是***一致性**。如果第三方正在为您进行估算，请查看他们成功或失败的历史，与他们过去的客户交谈并确定他们的可靠性。

话虽如此，从敏捷的角度来看，我们试图在项目期间获得更一致的估计的一些方法是：

*   使用相对尺寸标准（S、M、L、XL）而不是基于时间（理想的日子）。
*   关注复杂性而不是时​​间
*   始终使用群体估计而不是单人估计
*   在整个项目中经常收集估算，通常在每个 sprint 开始时
*   使用以前冲刺的反馈来确定故事的复杂性
*   跟踪速度以赋予相对大小以意义
*   频繁和早期的故事回顾以检查/理解任何颠簸

如果您正在与使用这些估算方法的公司打交道，那么您很可能会收到一致的结果，因此会得到更好的结果。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-16T13:17:25.773

3、6 或 12 个月（基本上是任何整数）形式的估计*令人*难以猜测。通常，当您猜测您选择的整数比您认为的要大的时候——季度、半年等——是通常的嫌疑人。我更喜欢根据实际开发迭代（无论它们的大小）进行估计。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-16T13:34:14.563

> 在没有对手头任务的详细了解的情况下，可以发现哪些明显的和不那么明显的软件估计弱的迹象？

在对手头任务没有详细了解的情况下给出的估计通常不好。

也许您可以采取的一般方法是检查需求中的项目是否与估算中的项目相对应。如果您想快速检查相对大小，如果对 100,000 字的简报给出 100 字的估计，那么它就不可能是正确的。

另外（正如其他人所说）检查是否提到了分析、编码、调试、测试、集成、应急等。它表明一些想法已经进入它。

在各个阶段取得成功并签署标准是一个很好的迹象。如果他们有一个确定的点，如果估计是错误的，那么至少完成 10%，那么您就可以及早知道并有机会适应。如果在“完成”之前没有检查点，你可能不知道在那个日期之前你落后了。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-14T15:21:39.517

**给出估价的人与从事这项工作的人有多熟悉？**

我经常看到有一个普通人在做这项工作的估计，即使团队是由背景非常不同的人组成的。很可能任务和专业没有完美结合，你会得到一个 c++ 服务器端程序员，他最终会做你的 gui 或你的数据库......有时团队的经理并不真正欣赏团队成员的优势，所以如果由于他的团队忙于上一个项目而要求他自己提出估算，您会发现所讨论的工作实际上只适合团队的一部分（没有动力，缺乏技能等）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-16T14:09:32.043

评估估算的另一种有用方法是将其与在以前类似项目上花费的实际工作量进行比较。用于比较的最佳数据将是该组织以前完成的项目的工作量数据。如果没有组织的历史数据，您可以尝试将估计与行业范围的基准进行基准比较。

我还要说，如果估计以单个绝对数字（比如 180 天）的形式呈现，那么这不是一个好兆头。单个绝对数字表示估计任务将以 100% 的概率在给定数据上完成。在一个范围内（比如 130 到 180 天）呈现的估计值将表明可以完成任务的范围。

我上面写的大部分内容都归功于这本书：

软件估计：揭秘史蒂夫·麦康奈尔的黑色艺术

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-16T14:27:48.880

我对照人力检查估算值。虽然不是一个非常准确的启发式方法，但很明显，如果某些大型工作只分配了一个或两个开发人员，那么任务估计不正确

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-16T15:03:25.987

一个好的估算将有一个很好的细分，涉及项目的所有阶段。

它几乎肯定不会在业务方便的日期完成。

它将包括各种风险。

它将以置信区间的形式呈现，隐含（10-12 个月）或使用大单位（大约四个季度）。

它将由负责完成项目的人制作，最好是不止一个这样的人。

如果一开始有延迟，最后也会有延迟（表示为从开始开始的 10-12 个月，或者如果我们现在开始，大约是 2010 年 1 季度，而不是像 2010 年 1 月项目尚未开始时那样）。

假设和依赖关系将被清楚且突出地列出。

编辑：这部分取决于项目所处的阶段。早期但精确的估计是一个警告信号，特别是在没有分配置信区间的情况下。这有点像 Procrustean 的估计。

此外，请注意其他开发方法。一个有时间限制的项目可以有一个严格和任意的时间表，但功能集将是灵活的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-10T06:11:26.003

以下任何一项：

*   这是一个大项目，没有描述一个简短的高级策略
*   对项目想要实现的目标没有清晰、简短和简明的愿景
*   该项目不是围绕逐步交付的业务价值构建的
*   团队正试图为一个大项目提供“准确”的估计，进入（或完成）一个漫长的分析阶段？（变化将会到来，并且通常会影响那些如果不付出更大努力就无法轻易量化的估计）
*   整个项目都有“详细”的估算（与之前有关）
*   第一阶段没有详细的估计，或者这些估计有问题。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-15T11:21:40.053

**“四到六周”**，当没有分解成更短的任务时......

# asp.net - 链接列表

> ID：553259
> 
> 赞同：0
> 
> 时间：2009-02-16T13:13:25.517
> 
> 标签：asp.net, vb.net, ajax

我有两张表，一张用于地区，一张用于这些地区，我想自动创建一个链接列表，如下所示：

1.  区域 1 a.区域 1 b.区域 2 c.区域 3
2.  Region2 a.Area1 等

此链接应在我加载页面时自动生成。列表中的项目不仅是文本，当我单击 Area1 时，我将调用一个传递 Area1 Region1 ID 的函数来在我的函数中执行一些操作，请记住，用户可能从 Region1 中单击 Area1，或者可能只是单击 Region1。

我正在使用 asp.net 3.5 和 vb.net 任何帮助或建议将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T15:55:09.933

我认为你的问题没有得到回答的原因是它涉及太多的基本面。如果有人从头开始为您编写所有这些内容，您将很难再进一步。我建议您查看一些 ASP.NET 初学者文章，了解如何编写响应控制事件的代码（例如 LinkBut​​ton 单击）、如何查询数据库、如何动态填充页面等。然后，如果您还有更多具体问题，再问。

# oracle - TopLink Essentials 和 EclipseLink 有什么区别

> ID：553263
> 
> 赞同：8
> 
> 时间：2009-02-16T13:14:59.553
> 
> 标签：oracle, jpa, eclipselink

TopLink Essentials 和 EclipseLink 都源自 Oracle 有什么区别？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-16T13:18:18.237

Toplink Essentials 源自 Oracle，是 JPA 1.0 的参考实现。它是甲骨文商业 TopLink 产品的一个精简版。

TLE 的代码被捐赠给了 Eclipse 基金会，这成为了 EclipseLink。Eclipselink 将成为 JPA 2.0 的参考实现，作为 EJB 3.1/Java EE 6 规范的一部分，预计将在今年由 JavaOne 完成（这也将随着 Glassfish v3 的最终发布而达到高潮）。

现在真的没有理由使用 TLE。EL 1.0.x 是一个明显更好的产品，它包含了 Toplink 的所有功能（以及更多），并且非常好。

# c# - 将 C# 类库用作 COM+ 服务器应用程序

> ID：553273
> 
> 赞同：3
> 
> 时间：2009-02-16T13:20:04.330
> 
> 标签：c#, .net, interop, com-interop, com+

我在 C# 中创建了一个 .NET 类库并将其公开给 COM。它可以作为进程内 COM 服务器正常工作。但是，我想将它用作一个 out-proc COM 服务器，以便将它放在一个单独的进程中。

为此，我尝试创建一个 COM+ 应用程序。我创建了一个空的 COM+ 应用程序并将类库中实现的类添加到其中。当我调用 CoCreateInstance() 来实例化库中实现的类时，COM+ 代理进程遇到访问冲突并终止（崩溃转储如下）。

是否需要采取任何特殊步骤来创建可用作 COM+ 下的进程外 COM 服务器的类库？

COM+ 代理进程因以下故障转储而崩溃：

例外：C0000005
地址：0x000C1618

调用堆栈：
！+ 0xC1618
mscorwks!Ordinal79 + 0xE41C
mscorwks!Ordinal79 + 0xE4AD
mscorwks!CoInitializeEE + 0x563F
mscorwks!CoInitializeEE + 0x5672
mscorwks!CoInitializeEE + 0x57F1
mscorwks!CoInitializeCor + 0x210E
mscorwks!CoInitializeCor + 0x48D
mscorwks!Ordinal79 + 0x16D2
mscorwks!ReleaseFusionInterfaces + 0x20B28
COMSVCS! + 0xC29A2
COMSVCS！+ 0xC2BDA
COMSVCS!CoCreateStdTrustable + 0xCB10
ole32!CoMarshalInterface + 0x2642
ole32!CoInstall + 0x673
ole32!CoQueryAuthenticationServices + 0x1F44
ole32!CoQueryAuthenticationServices + 0x2862
ole32!CoWaitForMultipleHandles + 0xC267
ole32!CoQueryClientBlanket + 0x16CE
ole32!CoCreateObjectInContext + 0xC8E
ole32!CoInstall + 0x87A
ole32!CoWaitForMultipleHandles + 0x10479
ole32!CoMarshalInterface + 0x2808
ole32!CoGetTreatAsClass + 0xBE7
ole32!CoGetTreatAsClass + 0xB9E
ole32!CoMarshalInterface + 0x28F2
ole32!CoMarshalInterface + 0x2642
COMSVCS!CoCreateStdTrustable + 0x106A4
ole32!CoMarshalInterface + 0x2642
ole32!CoPopServiceDomain + 0x14FE
RPCRT4!CheckVerificationTrailer + 0x70
RPCRT4!NdrStubCall2 + 0x215
RPCRT4!CStdStubBuffer_Invoke + 0x82
ole32!StgGetIFillLockBytesOnFile + 0xFC92
ole32!StgFileCLock +
ole32!CoRevokeClassObject + 0xA3E
ole32!CoRevokeClassObject + 0x963
ole32!StgGetIFillLockBytesOnFile + 0xF872
ole32!WdtpInterfacePointer_UserMarshal + 0x80E
ole32!StgGetIFillLockBytesOnFile + 0xF792
RPCRT4!NdrGetTypeFlags + 0x1C9
RPCRT4!NdrGetTypeFlags + 0x12E
RPCRT4!NdrGetTypeFlags + 0x5A
RPCRT4!CreateStubFromTypeInfo + 0x2D7
RPCRT4!CreateStubFromTypeInfo + 0x318
RPCRT4!NdrConformantArrayFree + 0x2CB
RPCRT4!NdrConformantArrayFree + 0x20F
RPCRT4!I_RpcBCacheFree + 0x61C
RPCRT4!I_RpcBCacheFree + 0x43E
RPCRT4!I_RpcBCacheFree + 0x604
kernel32!GetModuleFileNameA + 0x1B4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T14:31:23.613

也许通过这个答案中的 ServicedComponent 示例会有所帮助：

[在 C#/.Net 中创建进程外 COM？](https://stackoverflow.com/questions/446417/create-out-of-process-com-in-c-net)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T12:58:14.507

我建议您改为查看 .Net Remoting。

# c# - 使用 DockPanelWorkspace 时，MdiWindowListItem 的等价物是什么？

> ID：553276
> 
> 赞同：0
> 
> 时间：2009-02-16T13:20:38.150
> 
> 标签：c#, .net, winforms, cab

我们有一个以 DockPanelWorkspace 作为其主要用户界面区域的复合应用程序。上面是一个 MenuStrip，它的 MdiWindowListItem 设置了一个窗口菜单。不幸的是，正如我所担心的那样，窗口菜单没有填充打开的视图。

CAB 中是否有等效项可以使用工作区中打开的视图列表填充菜单？如果没有，我应该如何实现该功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-14T12:20:06.457

MdiWindowListItem 会自动填充为 MdiChild 添加的项目。您必须为停靠窗口开发自定义逻辑，处理以下 .

*   将菜单项添加到窗口菜单（设置为 MdiWindowListItem）
*   关闭相关窗口时删除菜单项
*   EventHandler 用于在单击菜单时选择窗口
*   我不熟悉 DockPanelWorkspace。
    *   所以必须对选择窗口的逻辑进行排序。
    *   DockState 的变化如窗口更改为 MDIChild

# lisp - 以下使用 gensym 的 Common Lisp 宏有什么问题？

> ID：553281
> 
> 赞同：10
> 
> 时间：2009-02-16T13:22:08.663
> 
> 标签：lisp, common-lisp

学习 Common Lisp（使用 GNU CLISP 2.43）.. 所以可能是一个菜鸟错误。示例是“打印 x 和 y 之间的素数”

```
(defun is-prime (n)
  (if (< n 2) (return-from is-prime NIL))

  (do ((i 2 (1+ i)))
      ((= i n) T)
    (if (= (mod n i) 0) 
        (return NIL))))

(defun next-prime-after (n)
  (do ((i (1+ n) (1+ i)))
      ((is-prime i) i)))

(defmacro do-primes-v2 ((var start end) &body body)
  `(do ((,var (if (is-prime ,start)
                  ,start
                  (next-prime-after ,start))
              (next-prime-after ,var)))
       ((> ,var ,end))
     ,@body))

(defmacro do-primes-v3 ((var start end) &body body)
  (let ((loop-start (gensym))
        (loop-end (gensym))) 
    `(do ((,loop-start ,start)
          (,loop-end ,end)
          (,var (if (is-prime ,loop-start)
                    ,loop-start
                    (next-prime-after ,loop-start))
                (next-prime-after ,var)))
         ((> ,var ,loop-end))
       ,@body ))) 
```

do-primes-v2 完美运行。

```
[13]> (do-primes-v2 (p 10 25) (格式 t "~d " p))
11 13 17 19 23

```

接下来我尝试使用 gensym 来避免宏扩展中的命名冲突 - do-primes-v3。但是我被困在一个

```
*** - EVAL：变量 #:G3498 没有值

```

尝试使用宏扩展来查看我是否可以发现错误，但我不能。

```
[16]> (macroexpand-1 `(do-primes-v3 (p 10 25) (格式 t "~d " p)))
（做
 ((#:G3502 10) (#:G3503 25)
  (P (IF (IS-PRIME #:G3502) #:G3502 (NEXT-PRIME-AFTER #:G3502))
     (P))))
 ((> P #:G3503)) (格式 T "~d " P)) ;

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T14:45:57.337

使用`DO*`而不是`DO`.

`DO`在它们尚不可见的范围内初始化*绑定*。 在可见`DO*`的范围内初始化绑定*。*

在这种特殊情况下`var`需要引用其他绑定`loop-start`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T14:25:14.377

您实际上不需要`gensym`这里来避免变量捕获，因为您没有引入任何“宏本地”的变量。当您宏展开您的`do-primes-v2`时，您将看到没有引入宏之外不存在的变量。

但是，您确实需要它来做不同的事情：避免多重评估。

如果你这样调用宏：

```
(do-primes-v2 (p (* x 2) (* y 3))
  （格式“~a~%”p））

```

它扩展到

```
(do ((p (if (is-prime (* x 2)))
            (* x 2)
            （下一个素数（* x 2））
        (p))))
    ((> p (* y 3))
  （格式“~a~%”p））

```

充其量，这是低效的，因为这些乘法是多次完成的。但是，如果您使用具有副作用的函数作为输入，例如`setf`or `incf`，这可能是一个大问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T14:51:56.123

将循环开始和循环结束的绑定移动到封闭的 LET 块或使用 DO*。原因是 DO 中的所有循环变量都是“并行”绑定的，因此对于第一个绑定，（扩展的）循环开始变量还没有绑定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T01:23:04.157

我知道这并不能真正回答你的问题，但我认为它是相关的。根据我的经验，您尝试编写的宏类型是一种非常常见的类型。我对您解决问题的方式的一个问题是它不能处理另一个常见用例：功能组合。

我没有时间强调*使用*宏可能会遇到的一些困难，但是我会强调，如果您构建了面向函数组合的主要迭代器，那么您的宏将变得非常简单，避免了您的问题共。

注意：我对您的一些功能进行了轻微修改。

```
(defun is-prime (n)
  (cond
    ((< n 2)
     nil)
    ((= n 2)
     t)
    ((evenp n)
     nil)
    (t
     (do ((i 2 (1+ i)))
     ((= i n) t)
       (when (or (= (mod n i) 0))
         (return nil))))))

(defun next-prime (n)
  (do ((i n (1+ i)))
      ((is-prime i) i)))

(defun prime-iterator (start-at)
  (let ((current start-at))
    (lambda ()
      (let ((next-prime (next-prime current)))
         (setf current (1+ next-prime))
         next-prime))))

(defun map-primes/iterator (fn iterator end)
  (do ((i (funcall iterator) (funcall iterator)))
      ((>= i end) nil)
    (funcall fn i)))

(defun map-primes (fn start end)
  (let ((iterator (prime-iterator start)))
    (map-primes/iterator fn iterator end)))

(defmacro do-primes ((var start end) &body body)
  `(map-primes #'(lambda (,var)
                   ,@body)
               ,start ,end)) 
```

我也建议您查看[Series](http://series.sourceforge.net/)。生成器模式在 lisp 程序中也很常见。您可能还想查看[Alexandria](http://common-lisp.net/project/alexandria/)，特别是函数 ALEXANDRIA:COMPOSE ，看看您可以用函数组合做什么很酷的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T16:25:52.137

我建议完全避免 DO/DO* 和宏，而是使用[Series](http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node347.html)（可以在[series.sourceforge.net](http://series.sourceforge.net/)上找到其实现）。

如果这太复杂了，那么考虑只使用递归或[生成器](http://en.wikipedia.org/wiki/Generator_(computer_science))（用于按需生成）生成素数列表。

# events - 事件点击：使用 CGEventPost、kCGSessionEventTap、kCGAnnotatedSessionEventTap、CGEventTapPostEvent 改变结果

> ID：553284
> 
> 赞同：5
> 
> 时间：2009-02-16T13:23:11.547
> 
> 标签：events, core-graphics, quartz-graphics, macos-carbon, cgeventtap

从事件水龙头发布事件时，我遇到了一个棘手的问题。我在 kCGHIDEventTap 上点击 NSSystemDefined，然后用一个新事件替换该事件。我遇到的问题是，根据我发布事件的方式，它只能被某些应用程序看到。我的测试应用程序是 Opera、Firefox、Quicksilver 和 Xcode。以下是我在事件点击回调中尝试的不同技术以及结果。我期待每个应用程序采取行动（“正确响应”）；“系统哔”表示没有任何东西绑定到那个键的系统声音。

1.  创建一个新事件，并从回调中返回它。Opera：无响应/系统提示音，Firefox：无响应/系统提示音，Quicksilver：正确响应，Xcode：无响应/系统提示音

2.  创建一个新事件，使用 CGEventPost 发布到 kCGSessionEventTap，返回 null。Opera：无响应/系统提示音，Firefox：无响应/系统提示音，Quicksilver：正确响应，Xcode：无响应/系统提示音

3.  创建一个新事件，使用 CGEventPost 发布到 kCGAnnotatedSessionEventTap，返回 null。Opera：正确响应，Firefox：正确响应，Quicksilver：无响应/系统哔声，Xcode：无响应/系统哔声

4.  创建一个新事件，使用 CGEventTapPostEvent 发布，返回 null。Opera：无响应/系统提示音，Firefox：无响应/系统提示音，Quicksilver：正确响应，Xcode：无响应/系统提示音

5.  创建一个新事件，使用 CGEventPost 发布到 kCGSessionEventTap，并返回新事件。Opera：无响应/系统提示音，Firefox：无响应/系统提示音，Quicksilver：正确响应，Xcode：无响应/系统提示音

6.  创建一个新事件，使用 CGEventPost 发布到 kCGAnnotatedSessionEventTap，并返回新事件。Opera：正确响应和系统哔声，Firefox：正确响应和系统哔声，Quicksilver：正确响应和系统哔声，Xcode：无响应/双系统哔声

7.  创建一个新事件，使用 CGEventTapPostEvent 发布，并返回新事件。Opera：无响应/系统提示音，Firefox：无响应/系统提示音，Quicksilver：正确响应，Xcode：无响应/系统提示音

(6) 是最好的，但用户抱怨正确响应时额外的系统蜂鸣声，我猜这是来自事件的双重发布。我不确定其他组合可以尝试，或者在哪里寻找。任何人都可以提供任何指导吗？有没有什么方法可以同时从我的回调中返回事件并发布到带注释的水龙头而不做两者？

很抱歉这个冗长的问题；我一直在做很多实验。

提前致谢

* * *

更新：这是我用来创建事件点击的代码：

```
CFMachPortRef eventTap;
eventTap = CGEventTapCreate(kCGHIDEventTap, kCGHeadInsertEventTap, 0,CGEventMaskBit(NX_SYSDEFINED) | (1 << kCGEventKeyDown) | (1 << kCGEventKeyUp), myCGEventCallback, (void *)hidEventQueue); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-04-12T22:06:50.047

我想我解决了这个问题。我一直在使用`+[NSEvent keyEventWithType:location:modifierFlags:timestamp:windowNumber:context:characters:charactersIgnoringModifiers:isARepeat:keyCode:]`创建一个 NSEvent，然后返回该事件的`-CGEvent`. 我切换到`CGEventCreateKeyboardEvent`，使用从原始事件创建的事件源`CGEventCreateSourceFromEvent`，并从回调中返回事件。我所有的测试现在都通过了。

# active-directory - Active Directory 中的 LDAP 过滤器字符串长度限制是什么？

> ID：553293
> 
> 赞同：15
> 
> 时间：2009-02-16T13:25:07.580
> 
> 标签：active-directory, ldap

任何人都可以指向我定义 Active Directory 中 LDAP 过滤器字符串的最大允许长度的资源吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-17T13:12:01.207

根据[Technet：Active Directory 搜索的工作原理](http://technet.microsoft.com/en-us/library/cc755809(WS.10).aspx)，服务器尝试处理的最大 LDAP 请求大小默认为 10,485,760 字节。

如果服务器收到大于此值的请求，则关闭连接。希望有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T13:28:56.727

根据[RFC1558](http://www.faqs.org/rfcs/rfc1558.html)中的规范，对 LDAP 过滤器字符串的长度没有硬性限制。但是，不同的实现可能有自己的限制。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-12-10T19:09:38.737

如果您使用 AD 用户和组 GUI 界面来构建查询，则限制为 464 个字符。如果您从命令行使用 dsquery，则不限于 464 个字符。我不知道 dsquery 上过滤器长度的上限，但我认为它符合 LDAP 规范。

# python - 在其他两个日期之间生成一个随机日期

> ID：553303
> 
> 赞同：184
> 
> 时间：2009-02-16T13:30:04.337
> 
> 标签：python, datetime, random

我将如何生成一个必须在另外两个给定日期之间的随机日期？

函数的签名应该是这样的：

```
random_date("1/1/2008 1:30 PM", "1/1/2009 4:50 AM", 0.34)
                   ^                       ^          ^

            date generated has  date generated has  a random number
            to be after this    to be before this 
```

并将返回一个日期，例如：`2/4/2008 7:20 PM`

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2009-02-16T13:35:08.180

将两个字符串都转换为时间戳（以您选择的分辨率，例如毫秒、秒、小时、天等），从后者中减去较早的值，将随机数（假设它分布在 中`range [0, 1]`）乘以该差值，然后再次添加到较早的一个。将时间戳转换回日期字符串，并且您在该范围内有一个随机时间。

Python 示例（输出几乎是您指定的格式，除了`0`填充 - 归咎于美国时间格式约定）：

```
import random
import time

def str_time_prop(start, end, time_format, prop):
    """Get a time at a proportion of a range of two formatted times.

    start and end should be strings specifying times formatted in the
    given format (strftime-style), giving an interval [start, end].
    prop specifies how a proportion of the interval to be taken after
    start.  The returned time will be in the specified format.
    """

    stime = time.mktime(time.strptime(start, time_format))
    etime = time.mktime(time.strptime(end, time_format))

    ptime = stime + prop * (etime - stime)

    return time.strftime(time_format, time.localtime(ptime))

def random_date(start, end, prop):
    return str_time_prop(start, end, '%m/%d/%Y %I:%M %p', prop)

print(random_date("1/1/2008 1:30 PM", "1/1/2009 4:50 AM", random.random())) 
```

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2009-02-16T14:21:56.413

```
from random import randrange
from datetime import timedelta

def random_date(start, end):
    """
    This function will return a random datetime between two datetime 
    objects.
    """
    delta = end - start
    int_delta = (delta.days * 24 * 60 * 60) + delta.seconds
    random_second = randrange(int_delta)
    return start + timedelta(seconds=random_second) 
```

精度为秒。如果需要，您可以将精度提高到微秒，或者减少到半小时。为此，只需更改最后一行的计算。

示例运行：

```
from datetime import datetime

d1 = datetime.strptime('1/1/2008 1:30 PM', '%m/%d/%Y %I:%M %p')
d2 = datetime.strptime('1/1/2009 4:50 AM', '%m/%d/%Y %I:%M %p')

print(random_date(d1, d2)) 
```

输出：

```
2008-12-04 01:50:17 
```

* * *

## 回答 #3

> 赞同：95
> 
> 时间：2011-11-17T16:25:52.387

一个小版本。

```
import datetime
import random

def random_date(start, end):
    """Generate a random datetime between `start` and `end`"""
    return start + datetime.timedelta(
        # Get a random amount of seconds between `start` and `end`
        seconds=random.randint(0, int((end - start).total_seconds())),
    ) 
```

请注意，`start`和`end`参数都应该是`datetime`对象。如果您有字符串，则转换相当容易。其他答案指出了一些方法。

* * *

## 回答 #4

> 赞同：94
> 
> 时间：2013-06-19T13:59:56.863

# 更新的答案

[使用Faker](https://pypi.python.org/pypi/Faker)更加简单。

### 安装

```
pip install faker 
```

### 用法：

```
from faker import Faker
fake = Faker()

fake.date_between(start_date='today', end_date='+30y')
# datetime.date(2025, 3, 12)

fake.date_time_between(start_date='-30y', end_date='now')
# datetime.datetime(2007, 2, 28, 11, 28, 16)

# Or if you need a more specific date boundaries, provide the start 
# and end dates explicitly.
import datetime
start_date = datetime.date(year=2015, month=1, day=1)
fake.date_between(start_date=start_date, end_date='+30y') 
```

# 旧答案

使用雷达非常简单

### 安装

```
pip install radar 
```

### 用法

```
import datetime

import radar 

# Generate random datetime (parsing dates from str values)
radar.random_datetime(start='2000-05-24', stop='2013-05-24T23:59:59')

# Generate random datetime from datetime.datetime values
radar.random_datetime(
    start = datetime.datetime(year=2000, month=5, day=24),
    stop = datetime.datetime(year=2013, month=5, day=24)
)

# Just render some random datetime. If no range is given, start defaults to 
# 1970-01-01 and stop defaults to datetime.datetime.now()
radar.random_datetime() 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2016-02-29T20:52:42.337

这是一种不同的方法-那种工作..

```
from random import randint
import datetime

date=datetime.date(randint(2005,2025), randint(1,12),randint(1,28)) 
```

**更好的方法**

```
startdate=datetime.date(YYYY,MM,DD)
date=startdate+datetime.timedelta(randint(1,365)) 
```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2014-11-08T15:56:45.787

由于 Python 3`timedelta`支持浮点乘法，所以现在你可以这样做：

```
import random
random_date = start + (end - start) * random.random() 
```

鉴于`start`和`end`是类型`datetime.datetime`。例如，要在第二天生成随机日期时间：

```
import random
from datetime import datetime, timedelta

start = datetime.now()
end = start + timedelta(days=1)
random_date = start + (end - start) * random.random() 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-03-06T11:18:51.707

要加入基于 pandas 的解决方案，我使用：

```
import pandas as pd
import numpy as np

def random_date(start, end, position=None):
    start, end = pd.Timestamp(start), pd.Timestamp(end)
    delta = (end - start).total_seconds()
    if position is None:
        offset = np.random.uniform(0., delta)
    else:
        offset = position * delta
    offset = pd.offsets.Second(offset)
    t = start + offset
    return t 
```

我喜欢它，因为它有很好的`pd.Timestamp`功能，可以让我在上面扔不同的东西和格式。考虑以下几个例子......

你的签名。

```
>>> random_date(start="1/1/2008 1:30 PM", end="1/1/2009 4:50 AM", position=0.34)
Timestamp('2008-05-04 21:06:48', tz=None) 
```

随机位置。

```
>>> random_date(start="1/1/2008 1:30 PM", end="1/1/2009 4:50 AM")
Timestamp('2008-10-21 05:30:10', tz=None) 
```

不同的格式。

```
>>> random_date('2008-01-01 13:30', '2009-01-01 4:50')
Timestamp('2008-11-18 17:20:19', tz=None) 
```

直接传递 pandas/datetime 对象。

```
>>> random_date(pd.datetime.now(), pd.datetime.now() + pd.offsets.Hour(3))
Timestamp('2014-03-06 14:51:16.035965', tz=None) 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-08-30T08:04:49.647

将您的日期转换为时间戳并`random.randint`使用时间戳调用，然后将随机生成的时间戳转换回日期：

```
from datetime import datetime
import random

def random_date(first_date, second_date):
    first_timestamp = int(first_date.timestamp())
    second_timestamp = int(second_date.timestamp())
    random_timestamp = random.randint(first_timestamp, second_timestamp)
    return datetime.fromtimestamp(random_timestamp) 
```

然后你可以像这样使用它

```
from datetime import datetime

d1 = datetime.strptime("1/1/2018 1:30 PM", "%m/%d/%Y %I:%M %p")
d2 = datetime.strptime("1/1/2019 4:50 AM", "%m/%d/%Y %I:%M %p")

random_date(d1, d2)

random_date(d2, d1)  # ValueError because the first date comes after the second date 
```

如果您关心时区，您应该只使用我`date_time_between_dates`从[`Faker`](https://pypi.org/project/Faker/)库[中窃取此代码](https://github.com/joke2k/faker/blob/b7a9cbb4432deb76b7e4d5a2755bf7915de2882e/faker/providers/date_time/__init__.py#L1662-L1699)的库，正如另一个答案所暗示的那样。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-05-25T15:53:16.823

这是标题字面意思的答案，而不是这个问题的正文：

```
import time
import datetime
import random

def date_to_timestamp(d) :
  return int(time.mktime(d.timetuple()))

def randomDate(start, end):
  """Get a random date between two dates"""

  stime = date_to_timestamp(start)
  etime = date_to_timestamp(end)

  ptime = stime + random.random() * (etime - stime)

  return datetime.date.fromtimestamp(ptime) 
```

此代码大致基于已接受的答案。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-11-12T09:42:53.567

您可以使用`Mixer`,

```
pip install mixer 
```

和，

```
from mixer import generators as gen
print gen.get_datetime(min_datetime=(1900, 1, 1, 0, 0, 0), max_datetime=(2020, 12, 31, 23, 59, 59)) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-03-06T07:52:53.557

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

"""Create random datetime object."""

from datetime import datetime
import random

def create_random_datetime(from_date, to_date, rand_type='uniform'):
    """
    Create random date within timeframe.

    Parameters
    ----------
    from_date : datetime object
    to_date : datetime object
    rand_type : {'uniform'}

    Examples
    --------
    >>> random.seed(28041990)
    >>> create_random_datetime(datetime(1990, 4, 28), datetime(2000, 12, 31))
    datetime.datetime(1998, 12, 13, 23, 38, 0, 121628)
    >>> create_random_datetime(datetime(1990, 4, 28), datetime(2000, 12, 31))
    datetime.datetime(2000, 3, 19, 19, 24, 31, 193940)
    """
    delta = to_date - from_date
    if rand_type == 'uniform':
        rand = random.random()
    else:
        raise NotImplementedError('Unknown random mode \'{}\''
                                  .format(rand_type))
    return from_date + rand * delta

if __name__ == '__main__':
    import doctest
    doctest.testmod() 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-04-23T08:59:30.020

```
# needed to create data for 1000 fictitious employees for testing code 
# code relating to randomly assigning forenames, surnames, and genders
# has been removed as not germaine to the question asked above but FYI
# genders were randomly assigned, forenames/surnames were web scrapped,
# there is no accounting for leap years, and the data stored in mySQL

import random 
from datetime import datetime
from datetime import timedelta

for employee in range(1000):
    # assign a random date of birth (employees are aged between sixteen and sixty five)
    dlt = random.randint(365*16, 365*65)
    dob = datetime.today() - timedelta(days=dlt)
    # assign a random date of hire sometime between sixteenth birthday and yesterday
    doh = datetime.today() - timedelta(days=random.randint(1, dlt-365*16))
    print("born {} hired {}".format(dob.strftime("%d-%m-%y"), doh.strftime("%d-%m-%y"))) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-16T13:35:26.773

1.  将您的输入日期转换为数字（int、float、任何最适合您使用的日期）
2.  在两个日期数字之间选择一个数字。
3.  将此数字转换回日期。

许多操作系统中已经提供了许多用于将日期转换为数字的算法。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-16T13:36:11.000

你需要随机数做什么？通常（取决于语言）您可以从日期中获取 Epoch 的秒数/毫秒数。因此，对于 startDate 和 endDate 之间的随机日期，您可以这样做：

1.  计算 startDate 和 endDate 之间的毫秒时间（endDate.toMilliseconds() - startDate.toMilliseconds()）
2.  生成一个介于 0 和您在 1 中获得的数字之间的数字
3.  生成一个新的日期，时间偏移 = startDate.toMilliseconds() + 2 中获得的数字

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-16T13:42:23.060

最简单的方法是将两个数字都转换为时间戳，然后将它们设置为随机数生成器的最小和最大界限。

一个快速的 PHP 示例是：

```
// Find a randomDate between $start_date and $end_date
function randomDate($start_date, $end_date)
{
    // Convert to timetamps
    $min = strtotime($start_date);
    $max = strtotime($end_date);

    // Generate random number using above bounds
    $val = rand($min, $max);

    // Convert back to desired date format
    return date('Y-m-d H:i:s', $val);
} 
```

此函数`[strtotime()](http://ie.php.net/strtotime)`用于将日期时间描述转换为 Unix 时间戳，并`[date()](http://ie.php.net/date)`从已生成的随机时间戳中生成有效日期。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-06-26T15:08:01.833

只是添加另一个：

```
datestring = datetime.datetime.strftime(datetime.datetime( \
    random.randint(2000, 2015), \
    random.randint(1, 12), \
    random.randint(1, 28), \
    random.randrange(23), \
    random.randrange(59), \
    random.randrange(59), \
    random.randrange(1000000)), '%Y-%m-%d %H:%M:%S') 
```

日间处理需要一些考虑。使用 28，您就在安全站点上。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-06-21T11:35:34.420

它是@(Tom Alsberg) 的修改方法。我修改它以获取毫秒的日期。

```
import random
import time
import datetime

def random_date(start_time_string, end_time_string, format_string, random_number):
    """
    Get a time at a proportion of a range of two formatted times.
    start and end should be strings specifying times formated in the
    given format (strftime-style), giving an interval [start, end].
    prop specifies how a proportion of the interval to be taken after
    start.  The returned time will be in the specified format.
    """
    dt_start = datetime.datetime.strptime(start_time_string, format_string)
    dt_end = datetime.datetime.strptime(end_time_string, format_string)

    start_time = time.mktime(dt_start.timetuple()) + dt_start.microsecond / 1000000.0
    end_time = time.mktime(dt_end.timetuple()) + dt_end.microsecond / 1000000.0

    random_time = start_time + random_number * (end_time - start_time)

    return datetime.datetime.fromtimestamp(random_time).strftime(format_string) 
```

例子：

```
print TestData.TestData.random_date("2000/01/01 00:00:00.000000", "2049/12/31 23:59:59.999999", '%Y/%m/%d %H:%M:%S.%f', random.random()) 
```

输出：`2028/07/08 12:34:49.977963`

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-12-22T20:57:51.150

这是一个从 emyller 的方法修改的解决方案，它以任何分辨率返回一个随机日期数组

```
import numpy as np

def random_dates(start, end, size=1, resolution='s'):
    """
    Returns an array of random dates in the interval [start, end]. Valid 
    resolution arguments are numpy date/time units, as documented at: 
        https://docs.scipy.org/doc/numpy-dev/reference/arrays.datetime.html
    """
    start, end = np.datetime64(start), np.datetime64(end)
    delta = (end-start).astype('timedelta64[{}]'.format(resolution))
    delta_mat = np.random.randint(0, delta.astype('int'), size)
    return start + delta_mat.astype('timedelta64[{}]'.format(resolution)) 
```

这种方法的部分优点在于`np.datetime64`它非常擅长将事物强制为日期，因此您可以将开始/结束日期指定为字符串、日期时间、pandas 时间戳……几乎任何事情都可以。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-07-10T08:37:47.597

`np.random.randint()`使用,`pd.Timestamp().value`和`pd.to_datetime()`with在两个日期之间创建随机日期的另一种方法`for loop`：

```
# Import libraries
import pandas as pd

# Initialize
start = '2020-01-01' # Specify start date
end = '2020-03-10' # Specify end date
n = 10 # Specify number of dates needed

# Get random dates
x = np.random.randint(pd.Timestamp(start).value, pd.Timestamp(end).value,n)
random_dates = [pd.to_datetime((i/10**9)/(60*60)/24, unit='D').strftime('%Y-%m-%d')  for i in x]

print(random_dates) 
```

输出

```
['2020-01-06',
 '2020-03-08',
 '2020-01-23',
 '2020-02-03',
 '2020-01-30',
 '2020-01-05',
 '2020-02-16',
 '2020-03-08',
 '2020-02-09',
 '2020-01-04'] 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-16T13:37:45.957

从概念上讲，这很简单。根据您使用的语言，您将能够将这些日期转换为一些参考 32 位或 64 位整数，通常表示自纪元（1970 年 1 月 1 日）以来的秒数，也称为“Unix 时间”或自其他任意日期以来的毫秒数。只需在这两个值之间生成一个随机的 32 或 64 位整数。这应该是任何语言的单行。

在某些平台上，您可以将时间生成为双精度（日期是整数部分，时间是小数部分是一种实现）。除了处理单精度或双精度浮点数（C、Java 和其他语言中的“浮点数”或“双精度数”）外，同样的原则也适用。减去差值，乘以随机数（0 <= r <= 1），添加到开始时间并完成。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-11-11T15:00:59.883

在蟒蛇中：

```
>>> from dateutil.rrule import rrule, DAILY
>>> import datetime, random
>>> random.choice(
                 list(
                     rrule(DAILY, 
                           dtstart=datetime.date(2009,8,21), 
                           until=datetime.date(2010,10,12))
                     )
                 )
datetime.datetime(2010, 2, 1, 0, 0) 
```

（需要python`dateutil`库—— `pip install python-dateutil`）

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-06-15T20:22:30.020

使用 ApacheCommonUtils 在给定范围内生成随机长整数，然后在该长整数中创建日期。

例子：

导入 org.apache.commons.math.random.RandomData；

导入 org.apache.commons.math.random.RandomDataImpl；

公共日期 nextDate（日期最小值，日期最大值）{

```
RandomData randomData = new RandomDataImpl();

return new Date(randomData.nextLong(min.getTime(), max.getTime())); 
```

}

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-03-26T04:58:26.463

我使用随机和时间为另一个项目制作了这个。我使用了一种通用格式，您可以在[此处](https://docs.python.org/2/library/time.html#time.struct_time)查看有关 strftime() 中第一个参数的文档。第二部分是一个 random.randrange 函数。它返回参数之间的整数。将其更改为与您想要的字符串匹配的范围。您必须在第二个参数的元组中有很好的参数。

```
import time
import random

def get_random_date():
    return strftime("%Y-%m-%d %H:%M:%S",(random.randrange(2000,2016),random.randrange(1,12),
    random.randrange(1,28),random.randrange(1,24),random.randrange(1,60),random.randrange(1,60),random.randrange(1,7),random.randrange(0,366),1)) 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-04-05T16:51:26.070

Pandas + numpy 解决方案

```
import pandas as pd
import numpy as np

def RandomTimestamp(start, end):
    dts = (end - start).total_seconds()
    return start + pd.Timedelta(np.random.uniform(0, dts), 's') 
```

dts 是以秒为单位的时间戳之间的差异（浮点数）。然后它用于创建介于 0 和 dts 之间的 pandas timedelta，并将其添加到开始时间戳。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-05-08T22:53:19.177

根据 mouviciel 的回答，这里是使用 numpy 的矢量化解决方案。将开始日期和结束日期转换为整数，在它们之间生成一个随机数数组，并将整个数组转换回日期。

```
import time
import datetime
import numpy as np

n_rows = 10

start_time = "01/12/2011"
end_time = "05/08/2017"

date2int = lambda s: time.mktime(datetime.datetime.strptime(s,"%d/%m/%Y").timetuple())
int2date = lambda s: datetime.datetime.fromtimestamp(s).strftime('%Y-%m-%d %H:%M:%S')

start_time = date2int(start_time)
end_time = date2int(end_time)

random_ints = np.random.randint(low=start_time, high=end_time, size=(n_rows,1))
random_dates = np.apply_along_axis(int2date, 1, random_ints).reshape(n_rows,1)

print random_dates 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2018-12-15T07:28:35.913

```
start_timestamp = time.mktime(time.strptime('Jun 1 2010  01:33:00', '%b %d %Y %I:%M:%S'))
end_timestamp = time.mktime(time.strptime('Jun 1 2017  12:33:00', '%b %d %Y %I:%M:%S'))
time.strftime('%b %d %Y %I:%M:%S',time.localtime(randrange(start_timestamp,end_timestamp))) 
```

[参考](https://stackoverflow.com/a/43196777/8079492)

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2021-01-17T01:45:46.667

获取 start_date 和 end_date 之间的随机日期。如果其中任何一个为无，则获取今天和过去 100 年之间的随机日期。

```
class GetRandomDateMixin:
    def get_random_date(self, start_date=None, end_date=None):
        """
        get random date between start_date and end_date.
        If any of them is None, then get random date between
        today and past 100 years.
        :param start_date: datetime obj.
            eg: datetime.datetime(1940, 1, 1).date()
        :param end_date: datetime obj
        :return: random date
        """
        if start_date is None or end_date is None:

            end_date = datetime.datetime.today().date()
            start_date = end_date - datetime.timedelta(
                days=(100 * 365)
            )

        delta = end_date - start_date
        random_days = random.randint(1, delta.days)
        new_date = start_date + datetime.timedelta(
            days=random_days
        )

        return new_date 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-03-01T23:32:26.483

以@Pieter Bos 的回答为基础：

```
import random
import datetime

start = datetime.date(1980, 1, 1)
end = datetime.date(2000, 1, 1)

random_date = start + (end - start) * random.random()
random_date = datetime.datetime.combine(random_date, datetime.datetime.min.time()) 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-04-18T16:43:32.183

关于什么

```
import datetime
import random

def random_date(begin: datetime.datetime, end: datetime.datetime):
    epoch = datetime.datetime(1970, 1, 1)
    begin_seconds = int((begin - epoch).total_seconds())
    end_seconds = int((end - epoch).total_seconds())
    dt_seconds = random.randint(begin_seconds, end_seconds)

    return datetime.datetime.fromtimestamp(dt_seconds) 
```

没有尝试过与 1970 年不同的“纪元”年份，但它可以完成工作

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2021-08-15T04:31:30.903

使用我的[randomtimestamp](https://pypi.org/project/randomtimestamp/)模块。它有 3 个函数，*randomtimestamp*、*random_time*和*random_date*。

下面是*randomtimestamp*函数的签名。它可以生成两年之间的随机时间戳，或者两个日期时间对象（如果你喜欢精确的话）。

可以选择将时间戳作为日期时间对象或字符串。还支持自定义模式（如*strftime*）

```
randomtimestamp(
    start_year: int = 1950,
    end_year: int = None,
    text: bool = False,
    start: datetime.datetime = None,
    end: datetime.datetime = None,
    pattern: str = "%d-%m-%Y %H:%M:%S"
  ) -> Union[datetime, str]: 
```

**例子：**

```
>>> randomtimestamp(start_year=2020, end_year=2021)
datetime.datetime(2021, 1, 10, 5, 6, 19)

>>> start = datetime.datetime(2020, 1, 1, 0, 0, 0)
>>> end = datetime.datetime(2021, 12, 31, 0, 0, 0)

>>> randomtimestamp(start=start, end=end)
datetime.datetime(2020, 7, 14, 14, 12, 32) 
```

**为什么不伪装？**

因为**randomtimestamp**是轻量级和快速的。只要随机时间戳是您唯一需要的东西，*faker*就是一种矫枉过正而且很重（功能丰富）。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2021-10-07T02:29:59.193

生成过去 50 年到过去 30 年之间的随机日期。并且只生成日期。

```
import random
from datetime import date, timedelta
from dateutil.relativedelta import relativedelta

start_date = date.today() - relativedelta(years=50)
end_date = date.today() - relativedelta(years=20)
delta = end_date - start_date
print(delta.days)

random_number = random.randint(1, delta.days)

new_date = start_date + timedelta(days=random_number)
print (new_date) 
```

# string - 如何使用 Flex 在字符串中查找数字？

> ID：553306
> 
> 赞同：1
> 
> 时间：2009-02-16T13:31:12.650
> 
> 标签：string, actionscript-3, apache-flex, flex3

我想在运行时用一个字符替换一个数字，如下所示：

输入：

`ask 1234 question`

结果：

`ask * question`

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T13:40:41.363

使用正则表达式匹配一个数字，然后进行字符串替换。类似于以下内容：

```
var str:String = "ask 1234 question"; // your string
var pattern:RegExp = /\d+/ ; // a regular expression that matches numbers
trace(str.replace(pattern, "*")); 
```

查找 String 和 Regex 的 flex 3.0 文档。快乐编码！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T13:34:46.853

您可以使用[正则表达式](http://livedocs.adobe.com/flex/2/langref/RegExp.html)。

# delphi - Delphi：如何计算大文件的 SHA 哈希

> ID：553310
> 
> 赞同：11
> 
> 时间：2009-02-16T13:33:21.960
> 
> 标签：delphi, sha

嗨，我需要在 5 Gig 文件上生成 SHA

你知道可以做到这一点的非基于字符串的 Delphi 库吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-16T13:46:03.037

您应该使用[DCPcrypt v2](http://www.cityinthesky.co.uk/cryptography.html)并读取缓冲的文件并将缓冲区提供给 SHA 哈希，直到您读取完整的 5GB 文件。

如果您想知道如何读取缓冲的大文件，请参阅我[关于使用自定义缓冲的文件副本](https://stackoverflow.com/questions/438260/delphi-fast-file-copy/438323#438323)的回答。

所以在概念上（没有真正的德尔福代码！）：

```
function GetShaHash(const AFilename: String)
begin
  sha := TSHAHasher.Create;
  SetLength(Result, sha.Size);
  file := OpenFile(AFilename, GENERIC_READ);
  while not eof file do
  begin
     BytesRead := ReadFile(file, buffer[0], 0, 1024 * 1024);
     sha.Update(buffer[0], BytesRead);
  end;
  sha.Final(Result[0]); 
  CloseFile(file);
end; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T15:16:40.010

我会推荐 Wolfgang Ehrhardt 的 CRC/Hash。
[http://home.netsurf.de/wolfgang.ehrhardt/](http://home.netsurf.de/wolfgang.ehrhardt/)

它速度很快，并且“可以使用最新的 Pascal（TP 5/5.5/6、BP 7、VP 2.1、FPC 1.0/2.0/2.2）和 Delphi 版本（使用 V1 到 V7/9/10 进行测试）进行编译”。

我也将它与 D11/D12 一起使用过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T18:32:22.693

如果我没记错的话，Indy 带有几个基于流的哈希方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T13:34:57.853

OpenSSL 有一个 Delphi 接口，不是吗？

那应该为您提供更好的性能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-29T00:11:02.033

@Davy Landman，谢谢，您的回答真的帮了我大忙。这是我最终使用的代码：

```
function HashFileSHA256(const fileName: String): String;
var
  sha256: TDCP_sha256;
  buffer: array[0..1024*1024] of byte;
  i, bytesRead: Integer;
  streamIn: TFileStream;
  hashBuf: array[0..31] of byte;
begin
  // Initialization
  Result := '';
  streamIn := TFileStream.Create(fileName, fmOpenRead);
  sha256 := TDCP_sha256.Create(nil);
  for i:=0 to Sizeof(buffer) do
    buffer[i] := 0;
  for i:=0 to Sizeof(hashBuf) do
    hashBuf[i] := 0;
  bytesRead := -1;

  // Compute
  try
    sha256.Init;
    while bytesRead <> 0 do
    begin
      bytesRead := streamIn.Read(buffer[0], Sizeof(buffer));
      sha256.Update(buffer[0], bytesRead);
    end;
    sha256.Final(hashBuf);
    for I := 0 to 31 do
      Result := Result + IntToHex(hashBuf[i], 2);
  finally
    streamIn.Free;
    sha256.Free;
  end;

  Result := LowerCase(Result);
end; 
```

PS：我是 Pascal 的初学者，所以这段代码很可能很糟糕。但我在 MSYS2 安装程序上对其进行了测试，并且能够验证哈希，这很好。

# jsp - 在 jspx 文件的属性中使用 struts 标签

> ID：553312
> 
> 赞同：1
> 
> 时间：2009-02-16T13:33:54.953
> 
> 标签：jsp, xhtml, struts2, jspx

我有一些旧的 jsp 代码在属性中使用 struts 标签，如下所示：

```
<link href="<s:url value='/styles/layout.css'/>" 
  rel="stylesheet" type="text/css" media="all"/> 
```

我不能让它在 jspx 文件中工作。有没有一个很好的选择来获得相同的功能而没有太多的混乱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T13:40:08.760

试试这个

```
 <c:set var="myUrl"><s:url value='/styles/layout.css'/></c:set>
    <link href="${myUrl}"/> 
```

您可能还想尝试这种形式，但我真的不记得它是否有效：

```
 <s:url value='/styles/layout.css' var="anUrl"/>
    <link href="${anUrl}"/> 
```

# apache-flex - 在弹性图表中使用多个轴和动画

> ID：553316
> 
> 赞同：0
> 
> 时间：2009-02-16T13:34:38.320
> 
> 标签：apache-flex, animation, charts

我必须展示一个包含两个系列的折线图，每个系列都有“日期值”，因为每个系列中的日期可能相距甚远，它们有自己的水平轴。
问题是当我向系列添加动画时，动画开始循环并且永不停止。
我的问题是：*我做错了吗？*或者*这是弹性图表中的错误？* *有谁知道如何解决这个问题？*
这是一个示例代码：`

```
<mx:Script>
    <![CDATA[
        import mx.controls.Alert;
        import mx.collections.ArrayCollection;

        [Bindable]
        private var arr1:ArrayCollection = new ArrayCollection([
            {date_1:"01/2008", value_1:2, date_2:"01/2007", value_2:4},
            {date_1:"02/2008", value_1:5, date_2:"02/2007", value_2:7},
            {date_1:"03/2008", value_1:4, date_2:"03/2007", value_2:3},
            {date_1:"04/2008", value_1:7, date_2:"04/2007", value_2:5}]);

        [Bindable]
        private var arr2:ArrayCollection = new ArrayCollection([
            {date_1:"01/2008", value_1:4, date_2:"01/2007", value_2:7},
            {date_1:"02/2008", value_1:3, date_2:"02/2007", value_2:5},
            {date_1:"03/2008", value_1:5, date_2:"03/2007", value_2:2},
            {date_1:"04/2008", value_1:4, date_2:"04/2007", value_2:5}]);

        private var temp:Boolean = false;

        private function switchGraf():void{
            if( temp){
                series_1.dataProvider = arr1;
                series_2.dataProvider = arr1;

            } else {
                series_1.dataProvider = arr2;
                series_2.dataProvider = arr2;
            }
            temp = !temp;
        }
    ]]>
</mx:Script>

<mx:SeriesSlide direction="right" duration="1000" id="aniShow"/>
<mx:SeriesSlide direction="left" duration="1000" id="aniHide"/>

<mx:ComboBox change="switchGraf()">
    <mx:String>one</mx:String>
    <mx:String>two</mx:String>
</mx:ComboBox>

<mx:LineChart>
    <mx:series>
        <mx:LineSeries id="series_1" yField="value_1" dataProvider="{arr1}" showDataEffect="aniShow" hideDataEffect="aniHide">
            <mx:horizontalAxis>
                <mx:CategoryAxis id="axis_1" categoryField="date_1"/>
            </mx:horizontalAxis>
        </mx:LineSeries>
        <mx:LineSeries id="series_2" yField="value_2" dataProvider="{arr1}">
            <mx:horizontalAxis>
                <mx:CategoryAxis id="axis_2" categoryField="date_2"/>
            </mx:horizontalAxis>
        </mx:LineSeries>
    </mx:series>
    <mx:verticalAxis>
        <mx:LinearAxis minimum="0" maximum="10"/>
    </mx:verticalAxis>
    <mx:horizontalAxisRenderers>
        <mx:AxisRenderer placement="bottom" axis="{axis_1}"/>
        <mx:AxisRenderer placement="top" axis="{axis_2}"/>
    </mx:horizontalAxisRenderers>
</mx:LineChart> 
```

`

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T14:37:30.643

好吧，我没有答案，我不知道为什么会这样。但是我找到了解决问题的方法：
您必须在系列结束时从系列中删除效果，然后在更改系列的数据提供者时需要将它们添加回来，如下所示：

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical" 
backgroundGradientAlphas="[1.0, 1.0]" backgroundGradientColors="[#FFFFFF, #FFFFFF]">

<mx:Script>
    <![CDATA[
        import mx.controls.Alert;
        import mx.collections.ArrayCollection;

        [Bindable]
        private var arr1:ArrayCollection = new ArrayCollection([
            {date_1:"01/2008", value_1:2, date_2:"01/2008", value_2:4},
            {date_1:"02/2008", value_1:5, date_2:"02/2008", value_2:3},
            {date_1:"03/2008", value_1:4, date_2:"03/2008", value_2:5},
            {date_1:"04/2008", value_1:7, date_2:"04/2008", value_2:4}]);

        [Bindable]
        private var arr2:ArrayCollection = new ArrayCollection([
            {date_1:"01/2007", value_1:4, date_2:"01/2007", value_2:7},
            {date_1:"02/2007", value_1:7, date_2:"02/2007", value_2:5},
            {date_1:"03/2007", value_1:3, date_2:"03/2007", value_2:2},
            {date_1:"04/2007", value_1:5, date_2:"04/2007", value_2:5}]);

        private var temp:Boolean = false;

        private function addAnimacion():void{
            serie_1.setStyle("showDataEffect", "aniShow");
            serie_2.setStyle("showDataEffect", "aniShow");
        }

        private function removeAnimacion():void{
            serie_1.setStyle("showDataEffect", "");
            serie_2.setStyle("showDataEffect", "");
        }

        private function switchGraf():void{

            addAnimacion();

            if( temp){
                serie_1.dataProvider = arr1;
                serie_2.dataProvider = arr1;

            } else {
                serie_1.dataProvider = arr2;
                serie_2.dataProvider = arr2;
            }

            temp = !temp;
        }
    ]]>
</mx:Script>

<mx:WipeRight duration="1000" id="aniShow" showTarget="true" effectEnd="removeAnimacion();"/>

<mx:ComboBox change="switchGraf()">
    <mx:String>one</mx:String>
    <mx:String>two</mx:String>
</mx:ComboBox>

<mx:LineChart>
    <mx:series>
        <mx:LineSeries id="serie_1" yField="value_1" dataProvider="{arr1}">
            <mx:horizontalAxis>
                <mx:CategoryAxis id="ejeAct" categoryField="date_1"/>
            </mx:horizontalAxis>
        </mx:LineSeries>
        <mx:LineSeries id="serie_2" yField="value_2" dataProvider="{arr1}">
            <mx:horizontalAxis>
                <mx:CategoryAxis id="ejeAnt" categoryField="date_2"/>
            </mx:horizontalAxis>
        </mx:LineSeries>
    </mx:series>
    <mx:verticalAxis>
        <mx:LinearAxis minimum="0" maximum="10"/>
    </mx:verticalAxis>
    <mx:horizontalAxisRenderers>
        <mx:AxisRenderer placement="bottom" axis="{ejeAct}"/>
        <mx:AxisRenderer placement="top" axis="{ejeAnt}"/>
    </mx:horizontalAxisRenderers>
</mx:LineChart> 
```

希望这对某人有帮助！

# user-interface - wxHaskell 和 Gtk2HS 的相对优点是什么？

> ID：553317
> 
> 赞同：20
> 
> 时间：2009-02-16T13:34:43.423
> 
> 标签：user-interface, haskell, wxhaskell, gtk2hs

哪个更适合使用 Haskell、wxWidgets（通过[wxHaskell](http://haskell.org/haskellwiki/WxHaskell)）或 GTK（通过[Gtk2HS](http://www.haskell.org/gtk2hs/)）开发 GUI 应用程序？

各自的优缺点是什么？它是否因您所针对的平台而异（我主要在 OS X 上工作，但也希望我的程序也可以在 Linux 和 Windows 上工作）？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-02T11:27:19.993

[免责声明：我是 wxHaskell 维护者]

两者都是稳定且相当完整的 GUI 绑定，您可以放心地为大多数项目选择其中任何一个。两者都有某种程度的“高级”Haskell 绑定，但在这两种情况下，您都需要使用相当命令式的“C”风格编码来完成工作。我的印象是 wxHaskell 允许您在更高级别的绑定上花费更多时间，但我没有做太多 GTK2HS，无论如何，您肯定会发现自己正在为这两个库的包装器工作 -而且我认为这两种情况下的整体编程“复杂性”是相似的。

因此，让我们以基本功能为前提，专注于差异。请注意，我真的相信 GTK2HS 是一部出色的作品，如果您选择它，您会很高兴。我在下面所说的大部分内容都是个人对差异的看法，以及我选择自己使用 wxHaskell 的原因。

GTK2HS 有一个更大的团队在做这件事，并且更经常地发布。wxHaskell 更新不那么频繁，但核心团队很活跃，并且有定期的错误修复，但主要新功能的添加速度比我们想要的要慢（我们都有日常工作）。

wxHaskell 在所有支持的平台上开箱即用地提供真正的原生应用程序外观。当然，GTK2HS 在 Linux 上是原生的，并且在 Windows 上具有相当不错的原生主题（即足以满足除了学究之外的所有人......），但在 OSX 上具有 GTK 外观和感觉，并且取决于安装了 X11。我相信一个 OSX 'native' GTK 库正在开发中，但被认为相对不成熟。一旦这稳定下来，GTK2HS 应该能够轻松地受益于相同的“部分原生”外观和感觉（例如[GTK OSX screenshot](http://developer.imendio.com/sites/developer.imendio.com/files/screenshot-gimp.png)）。

如果您不在 Linux 上，wxHaskell 可能更容易构建（如果您使用 Linux 托管，GTK2HS 可能更容易），但说实话，两者的构建都非常复杂，因为在这两种情况下都存在大量依赖项。

分发基于 wxHaskell 的应用程序稍微容易一些（恕我直言），因为它具有较少的库依赖关系。我在 Windows 上主要使用 InnoSetup 分发应用程序，在 OSX 上作为 App 包分发。我承认只需要少量的额外工作，GTK2HS 也可以做到这一点，所以这可能是支持 wxHaskell 的最弱论据。

我个人认为 wxHaskell 对闭源（例如商业）开发更友好。当然，这是无休止的火焰战争的主题，所以我只会说 wxHaskell 是在[wxWidgets 许可](http://www.wxwidgets.org/about/newlicen.htm)下的，它明确地允许闭源开发。GTK2HS 是 LGPL，因此您需要询问您的律师——尽管我必须明确指出，许多人和公司已经得出结论，LGPL 与商业开发兼容；我工作的公司的律师认为这不适合我们的项目。

我认为如果 Linux 是我的主要开发和交付平台，我可能会使用 GTK2HS。然而事实并非如此：我主要向 Windows 提供偶尔的 OSX，我认为 wxHaskell 更适合这些平台，尽管这两个选项都支持所有三个平台。

我希望这对您的选择有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T09:33:29.207

一个考虑因素是，目前让 wxHaskell 在 Mac OS X 上本地工作稍微容易一些。GTK2HS 依赖于 GTK，它确实有一个在 Mac OS X 上使用本地小部件的实现，但该实现不像 wxWidgets 实现那样容易构建对于 Mac OS X 是。

因此，如果你想开发在没有 X11.app 的情况下运行的代码，目前你最好使用 wxHaskell。

但是请注意，这正在迅速改变： [http](http://www.haskell.org/haskellwiki/Gtk2Hs#Using_the_GTK.2B_OS_X_Framework) ://www.haskell.org/haskellwiki/Gtk2Hs#Using_the_GTK.2B_OS_X_Framework 展示了如何在 Mac OS X 上使用 GTK2HS 和原生 GTK+。

GTK2HS 的一大优势是其对 GLADE 的支持，使简单 UI 的开发非常快速。wxHaskell 中更高级别的组合器减轻了大部分优势，但它们确实需要更深入地了解您希望界面的外观和行为方式，因此更难以探索性方式使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-20T05:07:14.573

我有相当不完整的信息，但是由于您还没有答案，也许不完整的信息总比没有好。

要问的问题是：该工具包只是对类 C 功能的包装，还是有一个额外的层为工具包提供了一个更“原生 Haskell-like”API？当 wxHaskell 在 Haskell 研讨会上首次发布时，原生 Haskell API 的开发看起来非常有希望，但仍然不完整。看起来 wxHaskell 的“Haskellized”API 似乎仍在开发中，而 Gtk2Hs 项目根本没有提到这个问题。出于这个原因，我推荐 wxHaskell。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-03T01:04:29.400

就个人而言，我会研究某种反应式包/扩展。它似乎与范式更接近。您可以以声明方式执行它，而不是命令式地指定图形内容。示例（不代表任何特定语言或实现）：

```
x, y, z              :: Int
click, buttonclicked :: Bool
x = <X coordinate of mouse>
y = <Y coordinate of mouse>
click = <Whether mouse button is currently being pressed>
z = x + y
buttonclicked = (x == 10 && y == 10 && click) 
```

每次 x 和 y 更改时，Buttonclicked 和 z 都会自动更新。

然后你可以在某个地方有一些看起来像这样的逻辑：

```
if buttonclicked then <do something> else <do something else> 
```

不过，这一切都非常模糊。看看一些真正的反应式接口

# git - 如何在没有 sudo 访问权限的情况下将 Gitosis 安装到我的服务器？

> ID：553329
> 
> 赞同：1
> 
> 时间：2009-02-16T13:39:00.853
> 
> 标签：git, sudo, gitosis

我正在尝试遵循[这些命令](http://eagain.net/gitweb/?p=gitosis.git;a=blob;f=README.rst)。

我在没有 sudo 访问权限的情况下管理将 Git 安装到我的服务器。但是，我需要 sudo 访问权限才能添加新用户：[请参阅此](https://stackoverflow.com/questions/553279/how-can-i-run-sudo-commands-without-sudo-access)。如果没有 sudo 访问权限，Gitosis 似乎很难安装。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T21:14:53.157

请参阅[页面](http://www.simplicidade.org/notes/archives/2008/09/installing_gito.html)以获取答案。

# asp.net-mvc - 如何使用 Windsor 将依赖项注入 ActionFilterAttributes

> ID：553330
> 
> 赞同：17
> 
> 时间：2009-02-16T13:39:10.277
> 
> 标签：asp.net-mvc, dependency-injection, castle-windsor

看到[NInject 如何做到这一点](http://codeclimber.net.nz/archive/2009/02/10/how-to-use-ninject-to-inject-dependencies-into-asp.net-mvc.aspx)并且[AutoFac 可以做到这一点后，](http://www.jeremyskinner.co.uk/2008/11/08/dependency-injection-with-aspnet-mvc-action-filters/)我试图弄清楚如何使用 Castle Windsor 将依赖项注入 MVC ActionFilters

目前我正在使用一个丑陋的静态 IoC 帮助类来解决来自构造函数代码的依赖关系，如下所示：

```
public class MyFilterAttribute : ActionFilterAttribute
{    
  private readonly IUserRepository _userRepository;
  public MyFilterAttribute() : this(IoC.Resolve<IUserRepository>()) { }
  public MyFilterAttribute(IUserRepository userRepository)
  {
     _userRepository = userRepository;
  }
} 
```

我很想从我的过滤器中删除那个静态反模式 IoC 的东西。

关于我将如何与温莎城堡一起做这件事的任何提示？

不，改变 DI 框架不是一种选择。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-11-06T12:41:11.617

当我需要这个时，我在其他人使用 Ninject 和 Windsor 所做的工作的基础上，获得[对我的 ActionFilters 的属性注入依赖项](http://weblogs.asp.net/psteele/archive/2009/11/04/using-windsor-to-inject-dependencies-into-asp-net-mvc-actionfilters.aspx)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-16T14:06:56.747

制作一个通用属性： MyFilterAttribute 与 ctor 以 Type 作为参数 - 即类似这样的东西：

```
public class MyFilterAttribute : ActionFilterAttribute {
    public MyFilterAttribute(Type serviceType) {
        this.serviceType = serviceType;
    }

    public override void OnActionExecuting(FilterExecutingContext c) {
        Container.Resolve<IFilterService>(serviceType).OnActionExecuting(c);
        // alternatively swap c with some context defined by you
    }

    // (...) action executed implemented analogously

    public Type ServiceType { get { return serviceType; } }
    public IWindsorContainer Container { set; get; }
} 
```

然后使用与您所指的两篇文章相同的方法，以控制如何调用操作，并将您的 WindsorContainer 手动注入到属性中。

用法：[MyFilter(typeof(IMyFilterService))]

然后，您的实际过滤器将在一个实现 IMyFilterService 的类中，该类又应该实现 IFilterService ，它可能看起来像这样：

```
public interface IFilterService {
    void ActionExecuting(ActionExecutingContext c);
    void ActionExecuted(ActionExecutedContext c);
} 
```

这样，您的过滤器甚至不会绑定到 ASP.NET MVC，并且您的属性只是一段元数据——它实际上应该是这样的！:-)

# c# - 检测不可用的池化 SqlConnections

> ID：553331
> 
> 赞同：1
> 
> 时间：2009-02-16T13:39:43.143
> 
> 标签：c#, sql-server, ado.net, connection-pooling, application-role

当我尝试使用[sp_setapprole](http://msdn.microsoft.com/en-us/library/ms188908.aspx)在 SqlConnection 上设置应用程序角色时，有时会在 Windows 事件日志中收到以下错误...

> 连接已被删除，因为打开它的主体随后假定了一个新的安全上下文，然后尝试在其模拟的安全上下文下重置连接。不支持此方案。请参阅联机丛书中的“模拟概述”。）

...并且在我的应用程序中引发了匹配的异常。

这些是池连接，并且曾经有一段时间连接池与应用程序角色不兼容 - 事实上，Microsoft 的旧建议是[禁用连接池](http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q229564)(!!) 但随着[sp_unsetapprole](http://msdn.microsoft.com/en-us/library/ms365415.aspx)的引入，现在（理论上）可以在将连接返回到池之前清理连接。

我相信这些错误发生在（出于未知原因）sp_unsetapprole 在关闭并返回到连接池之前未在连接上运行时。当这个连接从池中返回时，sp_approle 就注定会失败。

我可以捕获并处理此异常，但我更愿意检测即将发生的故障并完全避免异常（以及事件日志中的消息）。

是否可以在不引起异常的情况下检测到问题？

欢迎提出想法或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T13:43:42.747

这是在逻辑上进行，并且没有太多使用 sp_setapprole 的经验，但是在进行调用之前是否无法检查安全上下文？或者先检查安全权限和上下文？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T16:00:19.147

看起来您正在调用 sp_setapprole 但没有调用 sp_unsetapprole 然后让连接返回到池中。

我建议使用带有 IDisposable 实现的结构（或类，如果您必须跨方法使用它），它将为您解决这个问题：

```
public struct ConnectionManager : IDisposable
{
    // The backing for the connection.
    private SqlConnection connection;

    // The connection.
    public SqlConnection Connection { get { return connection; } }

    public void Dispose()
    {
        // If there is no connection, get out.
        if (connection == null)
        {
            // Get out.
            return;
        }

        // Make sure connection is cleaned up.
        using (SqlConnection c = connection)
        {
            // See (1).  Create the command for sp_unsetapprole
            // and then execute.
            using (SqlCommand command = ...)
            {
                // Execute the command.
                command.ExecuteNonQuery();
            }
        }
    }

    public ConnectionManager Release()
    {
        // Create a copy to return.
        ConnectionManager retVal = this;

        // Set the connection to null.
        retVal.connection = null;

        // Return the copy.
        return retVal;        
    }

    public static ConnectionManager Create()
    {
        // Create the return value, use a using statement.
        using (ConnectionManager cm = new ConnectionManager())
        {
            // Create the connection and assign here.
            // See (2).
            cm.connection = ...

            // Create the command to call sp_setapprole here.
            using (SqlCommand command = ...)
            {
                // Execute the command.
                command.ExecuteNonQuery();

                // Return the connection, but call release
                // so the connection is still live on return.
                return cm.Release();
            }
        }
    }
} 
```

1.  您将创建与调用 sp_setapprole 存储过程相对应的 SqlCommand。您也可以生成 cookie 并将其存储在私有成员变量中。
2.  这是您创建连接的地方。

客户端代码如下所示：

```
using (ConnectionManager cm = ConnectionManager.Create())
{
    // Get the SqlConnection for use.
    // No need for a using statement, when Dispose is
    // called on the connection manager, the connection will be
    // closed.
    SqlConnection connection = cm.Connection;

    // Use connection appropriately.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-25T15:47:38.927

不，这是不可能的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-14T13:51:10.813

这有点脏，但是如果您的原始用户有权`VIEW SERVER STATE`,`select * from sys.sysprocesses`将在角色不活动时返回所有进程，并在当前进程处于活动状态时返回单行。

# cocoa-touch - 如何在 iPhone 上更长时间地显示启动画面？

> ID：553336
> 
> 赞同：49
> 
> 时间：2009-02-16T13:41:12.300
> 
> 标签：cocoa-touch, splash-screen

如何在 iPhone 上显示比默认时间更长的启动画面？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-16T13:53:19.710

阅读 Apple iPhone 人机界面指南 (HIG)。“启动屏幕”不应该用于品牌或显示徽标，它应该看起来像应用程序的默认状态，因此它看起来可以快速启动。

让它在那里停留更长时间将违反HIG。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-16T13:53:16.683

最简单的方法是创建一个 UIImageView，其图像是您的 Default.png。在您的 applicationDidFinishLaunching: 方法中，将该图像视图添加到您的窗口，并在您希望启动屏幕消失时将其隐藏。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-27T04:04:57.923

我需要这样做以阻止显示表视图，直到通过网络加载数据。我使用了我在这里找到的一个变体：

[http://michael.burford.net/2008/11/fading-defaultpng-when-iphone-app.html](http://michael.burford.net/2008/11/fading-defaultpng-when-iphone-app.html)

在您的 App Delegate 的界面中：

```
 @interface AppDelegate : NSObject 
{
  UIImageView *splashView;
} 
```

在实施中：

```
 @implementation AppDelegate
- (void)applicationDidFinishLaunching:(UIApplication *)application {

  // After this line: [window addSubview:tabBarController.view];

  splashView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];
  splashView.image = [UIImage imageNamed:@"Default.png"];
  [window addSubview:splashView];
  [window bringSubviewToFront:splashView];

  // Do your time consuming setup

  [splashView removeFromSuperview];
  [splashView release];
} 
```

确保资源中有 Default.png

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2011-01-31T19:49:04.317

in your appDelegate , theres a method called applicationDidFinishedLaunching use a sleep function. Pass a digit in the sleep function for the no. of seconds you want to hold screen.

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
{    
    [window makeKeyAndVisible];
    [window addSubview:viewController.view];
    sleep(5);
    return YES;
} 
```

I searched so much for this thing and everybody gave their own complex point of view. I couldn't find a simple way that would just let me do it.

KISS ( Keep it simple and Smart :) I avoided the actual as its offensive.

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-10-27T17:57:19.143

我做得很简单，通过让我的 rootViewController 推送一个 modalViewController，从 UIViewController 的一个子类中的“Splash.nib”加载，我称为“SplashViewController”。确切的电话是：

```
- (void) viewDidLoad {
SplashViewController *splashScreen = [[[SplashViewController alloc]    
        initWithNibName:@"SplashViewController" bundle:nil] autorelease];
[self presentModalViewController:splashScreen animated:NO];
//continue loading while MVC is over top... 
```

当您启动应用程序时，它会立即弹出，就像启动屏幕一样。然后，SplashViewController nib 只是一个全屏 UIImageView，带有一个 splash png，320x480。在 1 秒的 NSTimer 之后（似乎还有更多的东西妨碍了），它会触发 timerFireMethod，这是一个自定义方法，它只调用

```
[self dismissModalViewControllerAnimated:YES]; 
```

然后模态 VC 只是向下滑动并离开，留下我的顶部 tableView。好消息是，当 MVC 启动时，由于模态视图控制器的独立性，底层表***可以继续加载。***所以，我不认为这违反了 HIG，实际上确实允许更快的启动。你更愿意看什么，一张可爱的图片，还是一个空的默认视图（打鼾）？

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-10-04T10:17:22.963

即使它违反了指导方针，但如果你仍然想这样做而不是更好的方法而不是睡眠线程

```
//Extend the splash screen for 3 seconds.
[[NSRunLoop currentRunLoop] runUntilDate:[NSDate dateWithTimeIntervalSinceNow:3]]; 
```

这样主线程就不会被阻塞，如果它正在监听任何通知和其他一些与网络相关的东西，它仍然会继续。

**斯威夫特的更新：**

```
 NSRunLoop.currentRunLoop().runUntilDate(NSDate(timeIntervalSinceNow:3)) 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2012-08-27T14:01:36.170

是的，最简单的方法是（记住将“default.png”添加到目标 -> [yourProjectName]：在“xCode”中启动图像）：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    [NSThread sleepForTimeInterval:3.0];
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-16T14:19:03.190

使您的应用程序需要更长的时间来加载。

严肃地说，Paul Tomblin 是正确的，这通常不是一个好主意。Default.png 是一种机制，旨在通过保持“空”屏幕截图使您的应用看起来加载速度更快。将它用于启动画面是一种轻微的滥用，但故意使启动画面出现的时间超过它需要的时间几乎是病态的。（它还会降低您的用户体验。请记住，启动屏幕可见的每一秒都是用户不耐烦地盯着您的徽标，发誓他们会切换到他们能找到的第一个体面的竞争对手的一秒。）

如果你试图覆盖某种二次加载——例如，如果界面已经加载并且你只是在等待从网络获取一些数据——那么它可能没问题，Ben Gottlieb 的方法很好。我建议添加一个进度条或微调器，让用户清楚地知道确实发生了一些事情。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-07-18T14:32:40.993

只需使用睡眠（以秒为单位的时间）；在您的 applicationDidFinishedLaunching 方法中

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-07-13T17:31:44.583

这是我的简单闪屏代码。'splashView' 是包含图像徽标、UIActivityIndi​​cator 和“Load..”标签（添加到我在 IB 中的“MainWIdow.xib”中）的视图的出口。活动指示器在 IB 中设置为“动画”，然后我生成一个单独的线程来加载数据。完成后，我删除 splashView 并添加我的正常应用程序视图：

```
-(void)applicationDidFinishLaunching:(UIApplication *)application {
    [window addSubview:splashView];
    [NSThread detachNewThreadSelector:@selector(getInitialData:) 
                                 toTarget:self withObject:nil];
}

-(void)getInitialData:(id)obj {
    [NSThread sleepForTimeInterval:3.0]; // simulate waiting for server response
    [splashView removeFromSuperview];
    [window addSubview:tabBarController.view];
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-11-13T03:50:42.997

```
 Inside your AppDelegate.m

    - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
    {
        // Sleep is code to stop the slash screen for 5MoreSeconds
        sleep(5);

        [self initializeStoryBoardBasedOnScreenSize];
        return YES;
    } 
```

//VKJ

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-07-19T15:22:03.493

在 Xcode 6.3 中，您可以显示启动 screen.xib 甚至在其上放置一个指示器，首先它将显示默认启动屏幕，它被 nib 替换，因此用户不知道它已更改，然后如果所有内容都已加载隐藏它 ：-）

```
 func showLaunchScreen() {
    // show launchscreen
    launchView = NSBundle.mainBundle().loadNibNamed("LaunchScreen", owner: self, options: nil)[0] as! UIView
    launchView.frame = self.view.bounds;
    self.view.addSubview(launchView)

    // show indicator
    launchScreenIndicator = UIActivityIndicatorView(frame: CGRectMake(0, 0, 50, 50)) as UIActivityIndicatorView
    launchScreenIndicator.center = CGPointMake(self.view.center.x, self.view.center.y+100)
    launchScreenIndicator.hidesWhenStopped = true
    launchScreenIndicator.activityIndicatorViewStyle = UIActivityIndicatorViewStyle.Gray
    launchView.addSubview(launchScreenIndicator)
    self.view.addSubview(launchView)
    launchScreenIndicator.startAnimating()

    self.navigationController?.setNavigationBarHidden(self.navigationController?.navigationBarHidden == false, animated: true) //or animated: false
}

func removeLaunchScreen() {
    println("remove launchscreen")
    self.launchView.removeFromSuperview()
    self.launchScreenIndicator.stopAnimating()
    self.navigationController?.setNavigationBarHidden(false, animated: true)
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-19T23:30:17.913

编写一个实际的闪屏类。

这是我最近在我的 iPhone in Action 博客中发布的可免费使用的启动画面：http: [//iphoneinaction.manning.com/iphone_in_action/2009/03/creating-a-splash-screen-part-one.html](http://iphoneinaction.manning.com/iphone_in_action/2009/03/creating-a-splash-screen-part-one.html)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-01-15T16:13:59.303

最简单的方法是将应用程序的主线程置于睡眠模式一段所需的时间。假设“Default.png”存在于您的应用程序包中，只要主线程处于睡眠状态，它就会一直显示：

```
 -(void)applicationDidFinishLaunching:(UIApplication *)application {
    [NSThread sleepForTimeInterval:5];
    window = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds]; 
    [window setBackgroundColor:[UIColor yellowColor]];
    [window makeKeyAndVisible];
} 

```

正如您已经意识到的那样，这是一个非常糟糕的主意，但它应该可以正常工作......

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-09-27T12:00:50.533

根据 Apple HIG，您不应该这样做。但是，如果您的应用程序需要出于特定目的这样做，您可以这样做：

*   在您的 AppDelegate.m 中导入 <unistd.h>
*   在“应用程序 didFinishLaunchingWithOptions:”方法的第一行写入以下行

    `sleep(//your time in sec goes here//)`;

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-05-16T10:48:14.327

只需在 applicationDidFininshLaunchings 方法中让窗口休眠几秒钟

示例：睡眠（3）

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-12-02T10:23:00.970

我这样做如下：

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"LaunchScreen" bundle:nil];
    UIViewController *viewController = [storyboard instantiateViewControllerWithIdentifier:@"splashView"];
    self.window.rootViewController = viewController; 
```

注意：LaunchScreen 是启动故事板，splashView 是故事板标识符

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-27T08:26:49.667

For stylish splash screen tutorial check out this [http://adeem.me/blog/2009/06/22/creating-splash-screen-tutorial-for-iphone/](http://adeem.me/blog/2009/06/22/creating-splash-screen-tutorial-for-iphone/)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-12-08T18:01:57.753

我所做的是在初始屏幕中显示一个 modalview 控制器，然后在几秒钟后将其关闭

```
 - (void)viewDidLoad
{
    [super viewDidLoad];
    ....
  saSplash = [storyboard instantiateViewControllerWithIdentifier:@"SASplashViewController"];
    saSplash.modalPresentationStyle = UIModalPresentationFullScreen;
    [self presentModalViewController: saSplash animated:NO];
}

-(void) dismissSASplash {
    [saSplash dismissModalViewControllerAnimated:NO];

} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-12-15T17:23:19.313

我同意在应用程序启动时有一个启动屏幕是有意义的——尤其是如果它需要首先从网站获取一些数据。

至于关注 Apple HIG - 看看 (MobileMe) iDisk 应用程序；在您注册会员详细信息之前，该应用程序会在快速显示全屏视图之前显示典型的 uitableview Default.png。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-02-11T12:27:45.343

**斯威夫特 2.0**

在 didFinishLaunchingWithOptions: 委托方法中使用以下行：

```
func application(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?) -> Bool {
    NSThread.sleepForTimeInterval(5.0)
    return true
} 
```

**但我推荐这个：**

将您的图像作为子视图放在主视图顶部的 UIImageView 全屏中，从而覆盖您的其他 UI。设置一个计时器以在几秒钟后将其删除（可能带有效果），现在显示您的应用程序。

```
import UIKit
    class ViewController: UIViewController
    {
        var splashScreen:UIImageView!
        override func viewDidLoad()
        {
            super.viewDidLoad()
            self.splashScreen = UIImageView(frame: self.view.frame)
            self.splashScreen.image = UIImage(named: "Logo.png")
            self.view.addSubview(self.splashScreen)

            var removeSplashScreen = NSTimer.scheduledTimerWithTimeInterval(3.0, target: self, selector: "removeSplashImage", userInfo: nil, repeats: false)
        }
        func removeSplashImage()
        { 
            self.splashScreen.removeFromSuperview()
        }
    } 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-09-23T14:32:31.990

这里已经发布了很多选项，但是我今天遇到了 cocoapod，它允许您将您的内容显示`LaunchScreen.xib`为初始视图控制器：

[https://github.com/granoff/LaunchScreen](https://github.com/granoff/LaunchScreen)（另请参阅[作者的这篇博文，了解更多实现细节](http://blog.hawkimedia.com/2014/10/dynamic-interactive-launch-screens/)。）

这似乎是一种相当直接的方法，并且比此处发布的绝大多数答案更好。（当然，直到`LaunchScreen`首先引入文件才可能实现。）可以在视图顶部显示活动指示器（或您想要的任何其他内容）。

至于您为什么要这样做，令我惊讶的是，没有人提到围绕这类事情经常有出版商和/或合作伙伴的要求。这在游戏中很常见，但广告资助的应用程序也是如此。

另请注意，这确实与 HIG 背道而驰，但在应用程序启动后等待加载任何内容也是如此。请记住，HIG 是指导方针，而不是要求。

最后一点：这是我个人的意见，任何时候实现这样的初始屏幕，您都应该能够点击以将其关闭。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-06-03T07:55:03.900

启动应用程序时会显示默认图像 (default.png)。

因此，您可以添加一个新的视图控制器，它将在应用程序 didFinishLoading 中显示该默认图像。

因此，通过这种逻辑，您可以将默认图像显示更长的时间。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-08-31T10:59:06.083

**斯威夫特版本：**

在 AppDelegate 中添加这一行

```
func application(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?) -> Bool {

    NSThread.sleepForTimeInterval(2.0)//in seconds

    return true
} 
```

# version-control - 管理多个代码分支和交付

> ID：553338
> 
> 赞同：11
> 
> 时间：2009-02-16T13:42:51.937
> 
> 标签：version-control, project-management

我为一家小型的单一产品、单一客户公司工作，该公司正在向单一产品、多客户公司转型。即使我们只有一个客户，我们也有不同的项目，有不同的交付日期，但对于每个项目，我们都能够交付最新的月度版本，我们将其保存在单独的代码分支中，以防万一”必须为该特定版本提供错误修复。

最近，我们获得了一些新客户，并且出现了一个新问题：总部通常会解决（不破坏功能）许多不同的客户特定问题，并不是所有客户都想要所有的变化，而是更愿意樱桃-pick修复和功能。

您对这种情况是否有任何经验，以及如何在不因测试和工作而超负荷的情况下实际处理它（我们每月的发布测试大约需要 3 天的计算机时间）？明智的版本控制，你如何管理（我猜 cvs 最终将不得不离开......）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T13:58:19.870

最简单的解决办法就是把产品切成核心产品，把每个功能切成一个插件。这样，每个客户都可以挑选他们想要的功能。但即使是这种解决方案也可能很快让一家小公司不堪重负。

实际上，您通常处于更糟糕的情况：您有一个新功能可以帮助客户 A 并为客户 B 破坏某些东西（例如，客户 B 还没有准备好修改他们的数据库，并且新功能在没有更改的情况下无法工作，所以这实际上使新版本无法用于客户 B)。如果你很大，你可以简单地忽略客户 B。

就目前而言，您确实需要找到一种方法来说服您的客户继续前进。最简单的方法是金钱：告诉他们获得量身定制的产品要花多少钱，如果你能找到适合每个人的解决方案，他们将节省多少。邀请你的客户过来，一起建立一个变更清单，让每个人都同意这个计划。

此外，您确实必须进行自动单元测试，因此您可以 100% 确定今天离开家的产品不可能比您四个星期前销售的产品更差。

即使有最好的版本控制系统（对我来说，那就是[git](http://git-scm.com/)），如果你不能让每个人都朝着同一个方向发展，你也无法解决你得到的扇出（当然，除了你可以真正将每个客户拆分成一个插件）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T14:01:31.360

我们有一个（相当专业的）产品和多个（但只有数百个）客户的类似设置，他们都想要自己的宠物功能。

据我所知，您可以走“现成”路线，您的产品不是特定于客户的，您添加的任何功能都是为了产品的利益（可能应客户的要求）；或者你走定制的咨询路线，每个客户都有自己独特的产品版本。

如果您的客户都需要基本相同的产品，那么您应该走第一条路线，这意味着所有功能都适用于所有客户。

隐藏功能很容易，维护多个并发版本是一场**噩梦！**

如果您的客户要求挑选他们的功能，一个可行的解决方案是为每个功能维护分支，然后非常小心地从您的总分支复制相关更改。

这意味着您的提交需要尽可能原子化——只修复一个问题——并且任何更改都不应该直接进入客户分支。但这种方法仍然非常危险。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T13:58:00.433

在这种情况下可以使用 CVS（尽管我建议您查看其他选项，例如 SVN）。

我从事过一些类似的项目。我们所做的是为系统的核心功能创建一个 Commom 分支，为产品的每个变体创建一个“客户”分支，这样您就可以实现每个客户端的特定功能和错误修复，并且仍然在“commom”中使用相同的更改"适用于产品的所有变体。

这种方法需要大量的配置管理工作（合并和构建），因此您可能希望有一个特定的人来处理这些任务。

编辑：

另外，您应该（如果还没有）有一个错误跟踪系统，您应该在其中记录您正在处理的客户端/分支。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T19:02:06.497

仅支持头/主干，除非有一个分支具有主线中不存在的错误修复/功能。

我知道你说有些客户不希望这样，但我已经看到了许多分支机构支持的最终结果。你不希望出现这种情况。这是一场噩梦，会削弱您的开发、产品和测试团队。

不要这样做。

坚定点。

# asp.net - 如何将其子项与 Nhibernate 位于同一表中的项映射？

> ID：553339
> 
> 赞同：0
> 
> 时间：2009-02-16T13:43:10.157
> 
> 标签：asp.net, nhibernate, nhibernate-mapping, mapping

我正在尝试构建一个消息传递系统，为此我有下面的表定义

信息

```
Id
From
To
Body
ParentId // Subcollection, i want to get Asnwers (Message.ParentId== Message.Id)
IsRead 
```

我在 Message.cs 中有这个

```
IList<Message> Answers; 
```

我已经尝试过了，但它给了我主集合中的所有消息和所有答案。

**但我不希望答案被视为一条消息（如主要项目）。**

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="RealEstate.Core" namespace="RealEstate.Core.Domain">
  <class name="Message" table="Message" lazy="true">
    <id column="id" type="Int64" name="Id">
      <generator class="native" />
    </id>
    <property name="From" column="[From]" type="Int64" />
    <property name="To" column="[To]" type="Int64" />
    <property name="Body" column="Body" />
    <property name="ParentId" column="ParentId" type="Int64" />
    <property name="SenderType" column="SenderType" type="Byte" />
    <property name="IsRead" column="IsRead" type="Boolean" />

    <bag name="Answers" lazy="true" cascade="delete">
      <key column="ParentId" />
      <one-to-many class="Message"/>
    </bag>

  </class>
</hibernate-mapping> 
```

如何进行这种映射，它们在同一张表中？

非常感谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T15:12:16.370

在尝试回答之前，我强烈建议您**搜索[NHibernate 用户组](http://groups.google.com/group/nhusers)**，因为有大量有用的 NHibernate 人员潜伏在那里回答各种问题。

但是让我看看我是否可以在这里提供帮助。

嗯，我不完全确定我理解这个问题。你说：

> 我已经尝试过了，但它给了我主集合中的所有消息和所有答案。
> 
> 但我不希望答案被视为一条消息（如主要项目）。

您的意思是该`Answers`集合包含数据库中的所有答案吗？

您可以发布更多代码，显示您正在运行的查询和课程代码吗？

您在场景中遇到的一个潜在问题是`ParentId`可能`NULL`在数据库中。这在映射一对多时给 NHibernate 带来了问题。

尝试使关联[双向（文档参考）](http://www.hibernate.org/hib_docs/nhibernate/html/collections.html)。这有时有助于避免一些陷阱。

为此，请将其添加到您的课程中

```
public class Message {
  ///<summary>Reference to parent message</summary>
  public Message Parent {get;set;}

  //... rest of class 
```

将此添加到您的映射中：

```
<bag name="Answers" lazy="true" cascade="delete" inverse="true">
   <key column="ParentId" />
   <one-to-many class="Message"/>
</bag>

<many-to-one name="Parent"/> 
```

这`inverse=true`将使 NHibernate 管理来自 Parent 属性的关系，而不是集合。这是必要的，因为 ParentId 可以为空。

在您的代码中，`myMessage.Answers.Add( blah );`您可以使用`answer.Parent = myMessage`. 当然，您可以编写很好的辅助方法来使其更有意义。

```
someMessage.AddAnswer( someAnswer ); 
```

看起来像这样：

```
public void AddAnswer(Message answer)
{
   answer.Parent = this;  
   if( ! this.Answers.Contains(answer) )
      this.Answers.Add(answer);
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T15:28:39.047

你想映射一棵树吗？也许这会有所帮助： [如何在 nhibernate 中映射树](http://web.archive.org/web/20090806071731/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/05/14/how-to-map-a-tree-in-nhibernate.aspx)

# wcf - 404 BadRequest 使用 IIS 主机标头通过外部 IP 公开 WCF 服务

> ID：553346
> 
> 赞同：3
> 
> 时间：2009-02-16T13:47:58.880
> 
> 标签：wcf, iis-6, networking, wcf-binding

我们在 Windows Server 2003 上托管 WCF Web 服务。该服务器只有 2 个内部 IP。我们希望将服务暴露在外部。这是通过将外部 IP 映射到服务的防火墙完成的。

因此，我需要修改服务以显示内部链接的外部 IP。这不是问题，因为它只能在外部使用。

更改 IIS 中的主机标头值会从 IIS 给出“错误请求（无效主机名）”响应。我还在 web.config 中的端点条目中添加了一个“地址”值......但它仍然只是指向内部机器名称。有任何想法吗？

编辑：我可以验证 IIS7 具有完全相同的行为。地址无效。不同的主机名给出了无效的主机名错误。真的没有办法呈现不同的（虚构的）IP吗？：/

编辑2：

```
<system.serviceModel>
    <bindings>
        <basicHttpBinding>
            <binding name="BasicAnonymous">
                <security mode="None"/>
            </binding>
        </basicHttpBinding>
    </bindings>
    <behaviors>
        <serviceBehaviors>
            <behavior name="Extended">
                <serviceMetadata httpGetEnabled="true"/>
                <dataContractSerializer maxItemsInObjectGraph="2147483646"/>
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <diagnostics>
        <messageLogging logEntireMessage="true" logMalformedMessages="false" logMessagesAtServiceLevel="false" logMessagesAtTransportLevel="true" maxMessagesToLog="3000"/>
    </diagnostics>
    <services>
        <service behaviorConfiguration="Extended" name="AnCWCFWebService.ProductInfoProvider">
            <endpoint address="" binding="basicHttpBinding" name="ASMX" bindingConfiguration="BasicAnonymous" contract="AnCWCFWebService.Interfaces.IProductInfoProvider"/>
        </service>
    </services>
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T12:13:39.123

## 404 BadRequest 由于 IIS 配置...

如果您在尝试修改 IIS 中的主机标头后收到来自 IIS 的 404 BadRequest 错误，这很常见，但有一个修复方法！

## 通过更改 IIS 配置进行修复

WCF 如何支持每个站点指定的多个 IIS 绑定？： http:
[//tinyurl.com/55q5hg](http://tinyurl.com/55q5hg)

## **通过修改 WCF 代码进行修复**

或者，以下文章解释了一位开发人员如何结合配置和代码解决此问题：

**嗯，这很有趣！WCF、SSL 和主机头的冒险**
[http://geekswithblogs.net/rakker/archive/2008/07/03/123562.aspx](http://geekswithblogs.net/rakker/archive/2008/07/03/123562.aspx)

文章引用了两个重要的链接...

第一个解释了如何在 IIS 中正确设置主机头：

*   为 SSL 主机头 (IIS 6.0) 配置服务器绑定：http: [//www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/8d9f2a8f-cd23-448c-b2c7-f4e87b9e2d2c.mspx? mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/8d9f2a8f-cd23-448c-b2c7-f4e87b9e2d2c.mspx?mfr=true)

让主机头工作后，你会发现......

> “您不能有多个 IIS 主机标头，否则 wcf 将中断”

在这篇文章中找到了解决这个限制的解决方案，上面的 GeeksWithBlogs.net 文章也有评论，提供了增强的变体：

*   WCF：这个集合已经包含了一个地址为 http：http:
    [//tinyurl.com/62yssd](http://tinyurl.com/62yssd)

如果您仍然遇到问题，请在下面的评论中告诉我们...

* * *

## 如果服务不工作...

我对 WCF 的经验是，它有时非常棘手，尤其是在配置方面。如果一个人遵循最佳实践并且没有做任何非标准的事情，那么绝大多数部署问题都是由于配置文件错误造成的。

理论上（实际上并没有那么多，由于架构差异），在 IIS 上设置 WCF 服务应该与为 Web 应用程序或 ASMX Web 服务设置一个典型的虚拟目录和相应的应用程序没有什么不同。

因此，我建议如果这是您向 Internet 公开的第一个 WCF 服务，请遵循公开您的第一个网站时所采用的相同简单方法。基本上，创建一个新的示例“WCF 服务应用程序”（在 C# 或 VB 的 Web 部分下的“添加新项目”对话框中可用）。

一旦你让它工作，按照你的部署实践将它移动到生产沙箱中并在本地测试它。此沙盒最好已经安装了一些网站或 Web 服务，并且已知可以从 Internet 访问，以便消除对典型网络配置问题的任何疑问。如果您有一个示例 ASMX Web 服务已经成功地从该服务器公开到 Internet，那将是最好的。

接下来，尝试从 Web 浏览器测试 ASMX 和 WCF 服务，无论是在服务器本地，还是在其他桌面内部，最后是外部。

## 测试网址

我们想要测试从 Web 浏览器访问标准 SVC 和 ASMX 文件的各种可用和相关的 URL 风格。结果应该是相似的，在窗口中有关于服务渲染的摘要页面。不同之处在于，如果 web.config 文件中没有禁用该功能，则 ASMX Web 服务的摘要可能允许您在服务上执行 Web 方法。

比较浏览器获取以下 URL 样式的结果...

*   http:// **localhost** /WcfService1/Service1。**服务端**
*   http:// **localhost** /WcfService1/Service1。**asmx**
*   http:// **MachineName 或 MachineFQN** /WcfService1/Service1。**服务端**
*   http:// **MachineName 或 MachineFQN** /WcfService1/Service1。**asmx**
*   http:// **MachineLocalIP#1** /WcfService1/Service1。**服务端**
*   http:// **MachineLocalIP#1** /WcfService1/Service1。**asmx**
*   http:// **MachineLocalIP#2** /WcfService1/Service1。**服务端**
*   http:// **MachineLocalIP#2** /WcfService1/Service1。**asmx**
*   http://**外部**IP/WcfService1/Service1。**服务端**
*   http://**外部**IP/WcfService1/Service1。**asmx**

所有这些测试都应该返回相似的结果。

## 检测服务方法

如果您愿意，请从 Web 浏览器开始并在 ASMX Web 服务上为任何经过测试的 URL 测试一些 Web 方法。您很快就会看到我们也可以用不同的方式测试 ASMX Web 服务......

接下来，我们将使用Visual Studio 2008 发行版 ( **C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE** ) 中的**WcfTestClient.exe**应用程序在 WCF 服务和 ASMX Web 服务上测试 Web 方法。

 **您将需要通过**File->Add Service 菜单项添加服务**，为您希望测试的每个服务 URL 输入上面的 URL。确保包含 SVC 和 ASMX 文件的文件名。如果一切顺利，由 web.config 文件中元素的“httpGetEnabled”属性启用的 MEX 端点`<serviceMetadata/>`将返回实用程序运行所需的数据，从而使用我们的服务方法清单填充树像这样：

![http://i.stack.imgur.com/mNK8l.jpg](https://i.stack.imgur.com/mNK8l.jpg)

从这一点来看，参考以下资源将很有用：

*   WCFTestClient：http: [//msdn.microsoft.com/en-us/library/bb552364.aspx](http://msdn.microsoft.com/en-us/library/bb552364.aspx)
*   Visual Studio 2008 中 WCF 的新增功能：http: [//msdn.microsoft.com/en-us/magazine/cc163289.aspx](http://msdn.microsoft.com/en-us/magazine/cc163289.aspx)

## 结论

如果您做到了这一点，那么我预计不会出现任何其他问题，您现在应该尝试将示例设置与您尝试发布到 Internet 的 WCF 服务进行比较，希望差异会很明显。

请记住在诊断期间将 WCF 服务视为 ASMX Web 服务，假设已知 web.config 已正确设置。

如果您仍然无法正常工作，请查看本指南以获取更多技术建议：

*   部署 IIS 托管的 WCF 服务：http: [//msdn.microsoft.com/en-us/library/aa751792.aspx](http://msdn.microsoft.com/en-us/library/aa751792.aspx)

最后，如果一切都失败了，只需将您的 WCF 服务包装在一个 ASMX Web 服务中：

*   如何：也将 WCF 服务公开为 ASMX Web 服务： http: [//kjellsj.blogspot.com/2006/12/how-to-expose-wcf-service-also-as-asmx.html](http://kjellsj.blogspot.com/2006/12/how-to-expose-wcf-service-also-as-asmx.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T10:03:00.940

您只需要在 IIS 中配置您的主机头，以便 WSDL 引用中的链接将使用主名称而不是本地机器名称。

查看 [配置 IIS 主机标头的步骤，以便 WCF 将在 WSDL 引用中使用域名。](http://www.codemeit.com/wcf/wcf-wsdl-xsdimport-schemalocations-link-to-local-machine-name-not-domain-name-while-hosted-in-iis.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T13:34:22.593

为什么不给服务器分配一个新的 IP 地址，而不是乱用主机名呢？Windows Server 可以有多个 IP 地址用于同一个 NIC。

[这](http://www.windowsnetworking.com/articles_tutorials/Understanding-Advanced-TCP-IP-Settings-Windows-2003.html)是一篇讨论它的文章。

# windows - 适用于 Windows 的命令行对话框工具

> ID：553352
> 
> 赞同：6
> 
> 时间：2009-02-16T13:50:57.313
> 
> 标签：windows, shell, scripting, console, cdialog

我需要一个类似于 cdialog（或whiptail）的对话工具，但可以在 Windows 上运行。

我有 MinGW 并且从源代码编译一些东西没有问题，但是我所知道的唯一 cdialog 和whiptail 都包含特定于 UNIX 的代码，因此它们不会在 Windows 上编译。

有没有我可以使用的替代品？我宁愿不必自己弄清楚和替换特定于平台的代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-10-22T01:52:07.233

Windows有一个[对话框端口。](http://andrear.altervista.org/home/cdialog.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T09:04:25.233

[我记得为此目的使用wxCocoaDialog](http://code.google.com/p/wxcocoadialog/)的 E 文本编辑器：

> wxCocoaDialog 是用于 OS X 的 CocoaDialog 应用程序的多平台端口，它允许通过命令行应用程序使用常见的 GUI 控件，例如文件选择器、文本输入、进度条、是/否确认等。它非常适合在 shell 和 Perl 脚本（或 Ruby、Python 或...等）中使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T08:51:13.127

你看过 Cygwin ( [http://www.cygwin.com/](http://www.cygwin.com/) ) 而不是 MinGW 吗？Cygwin 提供了一个非常类似于 Unix/Linux 的环境，以至于大多数 Unix 程序可以在不改变的情况下构建。但是，根据您想要对结果执行的操作，Cygwin 的许可可能是个问题。

# asp.net - 最佳实践 ASP.NET 成员资格：同一数据存储中的用户表？

> ID：553353
> 
> 赞同：15
> 
> 时间：2009-02-16T13:51:02.913
> 
> 标签：asp.net, database, security, asp.net-membership

使用 ASP.NET Membership Security 模型的表扩展我的业务数据库是否更好。或者我应该有一个不同的数据存储，我只管理身份和角色......基本上是 1 或 2 个数据库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T14:04:45.627

这可能取决于规模。如果它是一个企业解决方案，其中不同的应用程序共享一个会员来源，答案很简单——将它们分开。可能还有性能原因导致您希望将此数据与应用程序的其余部分分开。例如，可以说这些表不属于数据仓库。

2 个数据库解决方案唯一没有给您的是参照完整性。如果您扩展您的成员表以保存有关用户的更多应用程序特定详细信息，并且这些表需要链接到主数据库，那么您可能希望将它们保持在一起。否则，您将需要某种复制作业来为您维护它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T13:52:42.677

这是相当主观的，但除非这些用户将使用多个数据库，否则我会说将它们保存在同一个数据库中。

如果这些用户和角色在多个数据库中使用，我只会为用户和角色使用单独的数据库。

所以不，我永远不会使用两个。但是，我可能会使用三个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T16:13:10.827

Which database platform are you using? If one that supports schemas within a database, e.g. SQL Server 2008, then you can put your membership tables into their own schema, for neatness. You can also add cross-schema foreign keys if required.

# eclipse - 如何在 Eclipse 中安装 JIRA-Dashboard？

> ID：553354
> 
> 赞同：0
> 
> 时间：2009-02-16T13:51:58.107
> 
> 标签：eclipse, jira

尝试添加服务器时出现 javax.mail.internet.MimeMultipart 错误

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T23:15:22.953

您应该为最新版本的 Eclipse 安装 JIRA Mylyn 插件，而不是 Dashboard。前几天我这样做了，它开箱即用（在 JIRA 中启用 RPC 之后）。

# dashboard - 有没有办法使用 Bugzilla 进行 JIRA-Dashboard 风格的项目管理/概述？

> ID：553365
> 
> 赞同：3
> 
> 时间：2009-02-16T13:56:59.390
> 
> 标签：dashboard, bugzilla

我需要路线图视图、整体错误图、一个屏幕上的多条信息 - 这可以与 Bugzilla 一起使用吗？基于 Eclipse 的插件等是可用的……但是像 yoxel 这样需要访问 Bugzilla SQL DB 本身的解决方案可能不可行。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T09:15:32.200

这可能有点偏离轨道，但你看过Deskzilla吗？您可以使用嵌套查询和表格分布来构建项目分解或路线图。虽然它没有图表。

伊戈尔

*免责声明：我为 Deskzilla 背后的公司 ALM Works 工作。*

# mysql - 需要 MySQL 4 来忽略 ALTER TABLE 错误

> ID：553369
> 
> 赞同：4
> 
> 时间：2009-02-16T13:57:43.477
> 
> 标签：mysql, alter-table, mysql4

我有一个在某些条件下自动执行的 MySQL 脚本。该脚本执行一个`ALTER TABLE`命令，因为数据库中需要该列，但它可能有也可能没有...

`ALTER TABLE`如果列不存在或忽略此单个命令的*重复列*错误并允许脚本执行继续，是否可以让 MySQL 4 执行语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-18T05:21:26.960

ALTER [IGNORE] TABLE 只会忽略某些错误，例如添加新的 UNIQUE 索引时出现重复键错误或 SQL 模式错误。

[http://dev.mysql.com/doc/refman/4.1/en/alter-table.html](http://dev.mysql.com/doc/refman/4.1/en/alter-table.html)

有关您正在使用的“脚本”的更多详细信息将有助于回答问题。例如，在 python 中，错误会引发异常，然后可以捕获并处理或忽略该异常。

[编辑] 从下面的评论中，您似乎正在寻找 mysql -f 命令行选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-18T05:33:00.440

在尝试添加列之前，您可以先检查表架构吗？但是，我强烈怀疑您需要动态添加列的设计。有些事情不太对劲。你能详细解释一下这个要求吗？我敢肯定还有其他更清洁的方法。

# python - Windows Server 2008 还是 Vista？

> ID：553372
> 
> 赞同：1
> 
> 时间：2009-02-16T13:58:23.023
> 
> 标签：python, windows-vista, windows-server-2008, windowsversion

从 Python 脚本检查我是在 Windows Vista 还是 Windows Server 2008 上的简单（实施）方法是什么？

`platform.uname()`对两个版本给出相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T14:13:51.533

正如另一个问题中提到的，万无一失（我认为）的方法是使用 win32api.GetVersionEx(1)。版本号和产品类型的组合将为您提供当前运行的 Windows 平台。例如。版本号“6.*”和产品类型 VER_NT_SERVER 的组合是 Windows Server 2008。

您可以在[msdn上找到有关不同组合的信息](http://msdn.microsoft.com/en-us/library/ms724833(VS.85).aspx "微软")

# asp.net - 从 Javascript 调用 ASP.NET Web 服务时出错

> ID：553377
> 
> 赞同：0
> 
> 时间：2009-02-16T13:58:54.050
> 
> 标签：asp.net, javascript, web-services

我正在尝试从 Javascript 调用 ASP.NET Web 服务，但它无法识别 Web 方法，即使我完全限定了名称，我也在试图找出问题所在。

这是我的 web.config 文件的一部分：

```
<httpHandlers>
        <remove verb="*" path="*.asmx"/>
        <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
</httpHandlers> 
```

这是我的网络服务声明

```
[WebService(Namespace = "http://tempuri.org")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
[System.Web.Script.Services.ScriptService]
public class SavingService : System.Web.Services.WebService
{
    [WebMethod]
    public static void SaveToDB(string runCode, string container, 
        string productType, string inspector, string[][] scoregrid, string notes) 
```

这是javascript（QCApp4是我项目的命名空间）：

```
function PrepToSave()
{
    ....
    QCApp4.SavingService.SaveToDB(codev, containerv, prodtype, inspector, scoregrid, notes);
} 
```

scoregrid 在 js 端使用 Array() 命令声明为锯齿状二维数组。这是我对 Web 服务参数的唯一担心。

这是服务参考：

```
<asp:ScriptManager id="scriptmng" runat="server">
<Services>
<asp:ServiceReference Path="~/SavingService.asmx" />
</Services>
</asp:ScriptManager> 
```

无论是直接调用 web 方法，还是像 SavingService.SaveToDB 那样调用它，或者使用完整的限定符，我都会遇到错误。我得到的错误说 SaveToDB 没有定义。SavingService 未定义，QCApp4 未定义，取决于输入的限定名称的第一部分是什么。

我错过了什么吗？有什么我设置不正确的吗？

事实证明，我已将 WebMethod 设为静态，当然现在我在以下错误控制台中遇到错误：

错误：[异常...“'Sys.Net.WebServiceFailedException：Sys.Net.WebServiceFailedException：服务器方法'SaveToDB'失败并出现以下错误：System.NullReferenceException--对象引用未设置为对象的实例。' 调用方法时：[nsIDOMEventListener::handleEvent]" nsresult:"0x8057001c (NS_ERROR_XPC_JS_THREW_JS_OBJECT)"位置：""数据：无]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T15:03:31.197

如果你`InlineScript`在元素上设置属性`ServiceReference`，它会写出与 HTML 内联的 JavaScript 方法，这样你就可以准确地看到你需要调用什么，或者你是否调用了错误的东西：

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
    <Services>
        <asp:ServiceReference Path="~/SavingService.asmx" InlineScript="true" />
    </Services>
</asp:ScriptManager> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T13:37:32.587

我用这个搞砸了两件事。我回去发现了我之前看过的关于设置这些网络服务的视频。

我意识到，我不小心把 web 方法设置为静态，也忘记添加回调方法参数。一旦我添加了一个 on complete 和一个 on 错误处理程序，它就可以正常工作，在错误控制台中没有错误。

# asp.net - “Webservice”这个词是否暗示了一种特定的格式？

> ID：553379
> 
> 赞同：2
> 
> 时间：2009-02-16T14:00:29.287
> 
> 标签：asp.net, web-services

当我与来自 Microsoft ASP.NET 世界的开发人员交谈时，他使用了“Webservice”这个词，这个词是否在每种情况下都暗示一种特定的数据格式（XML？SOAP？）？

或者它只是你可以通过 http(s) 调用的任何东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T14:02:21.997

在我看来，它可以是 http/https 上的任何东西，并且旨在由应用程序而不是用户的浏览器调用。

特别是，REST 和 SOAP 在传递参数和返回结果的方式上大不相同

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T14:01:36.027

术语**Web 服务**本身与语言无关。

[这](http://en.wikipedia.org/wiki/Web_service)是一个不错的概述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T14:04:05.020

如果 Asp.Net 开发人员说 WebService，您几乎可以打赌他们正在谈论 XML/SOAP。

然而，这并非普遍正确。我认为如果 1) 数据源可通过网络获得，或者 2) 它是一个网址，可以在给定一组输入的情况下提供返回信息，则可以将任何东西称为 WebService。

例如，StackOverflow.com 允许对用户页面进行屏幕抓取，以便构建第 3 方应用程序。它不是专门的 XML/SOAP，但我认为它是一种 Web 服务（格式 #1）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T14:04:15.300

根据我的经验，这完全取决于您在与谁交谈。对于一些 ASP.Net 开发人员来说，这只是 SOAP 对于其他人来说它包括其他东西，如 REST。如果您打算在规范中使用该术语，那么更具体一点是个好主意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T14:30:59.450

我只能同意 Paul 的观点，通过网络查询的任何内容，使用 http(s) 协议而不是面向浏览器。但是任何 Web 服务也应该具有被发现的功能（WDSL 等）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-30T13:07:17.843

我个人的意思是任何 HTTPHandler！

这意味着在 ASP.NET 下，页面是返回 HTML 的 Web 服务。

WCF 扩展了这个概念，因为默认情况下，ASP.NET 中的 WCF 服务请求由模块而不是处理程序处理。

所以实际上任何网络请求都是一项服务。

通常，尽管 ASP.NET 开发人员将引用 SOAP，除非他们使用前缀即 WCF Webservices，

# java - 这种 LILO 最有效的收集？

> ID：553390
> 
> 赞同：2
> 
> 时间：2009-02-16T14:02:44.867
> 
> 标签：java, data-structures

我正在编写与客户端通信的最近网络消息列表。基本上我只想要一个存储最多 X 个消息对象的列表。列表达到所需大小后，应删除列表中最旧的（第一个）项目。收藏品需要维持秩序，而我需要做的就是

1.  遍历它，
2.  在末尾添加一个项目，并且
3.  如果 #2 太长，请从头开始删除一个项目。

最有效的结构/数组/集合/方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-16T14:05:53.690

您想使用[Queue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Queue.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T14:04:39.980

我不认为 LILO 是真正的术语......但你正在寻找一个 FIFO 队列

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T14:08:28.583

您可以为此使用[ArrayList 。](http://java.sun.com/javase/6/docs/api/index.html?java/util/concurrent/ArrayBlockingQueue.html)今天的计算机复制数据的速度如此之快，除非您的列表可以包含数十亿个元素，否则这无关紧要。

性能信息：在我的双核上复制 1000 万个元素需要[13 毫秒（13 毫秒） 。](http://blog.pdark.de/2008/08/another-lesson-on-performance.html)*因此，除非*您的用例有很大不同，否则即使考虑最佳数据结构也是浪费。在这种情况下：您有超过 1000 万个元素，而您的应用程序除了插入和删除元素之外什么都不做。如果您以任何方式对插入/删除的元素进行操作，则此操作所花费的时间可能会超过插入/删除的成本。

乍一看，链表似乎更好，但在分配内存时需要更多时间，而且代码更复杂（所有指针都在更新）。所以运行时间更差。在 Java中使用[LinkedList](http://java.sun.com/javase/6/docs/api/index.html?java/util/concurrent/ArrayBlockingQueue.html)的唯一优点是该类已经实现了 Queue 接口，因此在您的代码中使用它更自然（使用 peek() 和 pop()）。

[编辑] 那么让我们来看看效率。什么是效率？最快的算法？占用最少行数的那个（因此具有最少的错误）？最容易使用的算法（= 开发人员端的代码最少 + 错误更少）？性能最好的算法（并不总是最快的算法）？

让我们看一些细节： LinkedList 实现了队列，因此使用列表的代码更简单一些（list.pop() 而不是 list.remove(0)）。但是 LinkedList 将为每个 add() 分配内存，而 ArrayList 只为每 N 个元素分配一次内存。为了进一步减少这种情况，ArrayList 将分配 N*3/2 个元素，因此随着列表的增长，分配的数量将减少。如果事先知道列表的大小，ArrayList 只会分配一次内存。这也意味着 GC 需要清理的杂物更少。所以从性能的角度来看，ArrayList 在平均情况下胜出一个数量级。

仅当多个线程访问数据结构时才需要同步版本。在 Java 5 中，其中许多都看到了显着的速度提升。如果您有多个线程放置和弹出，请使用[ArrayBlockingQueue](http://java.sun.com/javase/6/docs/api/index.html?java/util/concurrent/ArrayBlockingQueue.html)但在这种情况下，尽管分配性能不佳，但[LinkedBlockingQueue](http://java.sun.com/javase/6/docs/api/index.html?java/util/concurrent/ArrayBlockingQueue.html)可能是一个选项，因为只要队列大小>，实现可能允许同时从两个不同的线程推送和弹出= 2（在这种特殊情况下， to 线程不必访问相同的指针）。要决定这一点，唯一的选择是运行分析器并测量哪个版本更快。

也就是说：任何关于性能的建议在 90% 的情况下都是错误的，除非它有衡量的支持。今天的系统已经变得如此复杂，并且在后台发生了如此多的事情，以至于仅仅一个人不可能理解甚至列举所有起作用的因素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T14:12:45.233

我第二个@rich-adams re：队列。特别是，由于您提到响应网络消息，我认为您可能想要一些能够很好地处理并发的东西。查看[ArrayBlockingQueue](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ArrayBlockingQueue.html)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T15:57:35.403

根据您的第三个要求，我认为您将不得不扩展或包装现有的实现，我建议您从[ConcurrentLinkedQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html)开始。

使用任何类型的阻塞队列的其他建议会导致您走错路。在移除另一个元素之前，阻塞队列不允许您将元素添加到完整队列中。此外，它们会在等待该操作发生时阻塞。根据您自己的要求，这不是您想要的行为。您希望在将新元素添加到完整队列时自动删除第一个元素。

在 ConcurrentLinkedQueue 周围创建一个包装器应该相当简单，重写[offer](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html#offer(E))方法来检查[大小](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ConcurrentLinkedQueue.html#size())和容量（你的包装器类将保持容量）。如果它们相等，您的 offer 方法将需要在添加新元素之前轮询队列以删除第一个元素。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T14:07:15.560

您可以使用普通的旧 ArrayList。添加时，只需执行（假设 ArrayList 称为 al）

```
if (al.size() >= YOUR_MAX_ARRAY_SIZE)
{
  al.remove(0);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T14:09:21.717

我认为你想要实现一个`Queue<E>`你有 peek、pull 和 remove 方法的地方，就像头上没有任何东西一样，直到计数超过你想要的阈值。您可能想要包装现有的实现之一。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-16T14:06:41.380

[LinkedList](http://java.sun.com/j2se/1.5.0/docs/api/java/util/LinkedList.html)应该是您正在寻找的

# visual-studio-2008 - 自定义 Visual Studio 起始页

> ID：553392
> 
> 赞同：3
> 
> 时间：2009-02-16T14:03:50.527
> 
> 标签：visual-studio-2008, configuration

有没有办法自定义 VS 2008 起始页？我想显示一个网站（一个 Sharepoint 站点）而不是新闻源，但我找不到解决方案。

**更新：**

关于[Kashes 的回答](https://stackoverflow.com/questions/553392/customizing-visual-studio-start-page/553417#553417)：“但它只接受 RSS 提要。” <-悲伤但真实。

> 工具->选项->环境->启动

将下拉菜单更改为“打开主页”。

> 工具->选项->环境->网页

将您的主页设置为您想要的任何内容。

这就是我目前所做的 - 但是你会用最近打开的项目丢失起始页 - 如果你可以用主页替换 Feed 会很好 - 但看起来这是不可能的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T14:11:33.753

工具 -> 选项 -> 环境 -> 启动

将下拉菜单更改为打开主页...

工具 -> 选项 -> 环境 -> Web 浏览器 -> 网页

将您的主页设置为您想要的任何内容...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T14:10:35.473

您可以在注册表中编辑 URL HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\9.0Exp\Configuration\StartPage

但它只接受 RSS 提要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T14:19:56.247

总结@Khash 和@JPunyons 的答案：

Visual Studio 让您可以选择显示基于 RSS 提要的起始页或显示主页（可以是 Internet 上的任何页面）。您可以更改从**`Tools / Options / Environments / Startup / At startup`**组合框中显示哪一个。

如果您选择起始页，您可以从**`Tools / Options / Environments / Startup / Start Page news channel`**.

如果您选择主页，则可以从 修改 URL **`Tools / Options / Environments / Web Browser / Home Page`**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-07T21:46:49.480

如果您使用的是 Visual Studio 2008 Professional，则需要更改 HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\9.0\StartPage 中 NewsChannel 的值。

# javascript - 如何在 jQuery 中“淡出”和“删除”一个 div？

> ID：553402
> 
> 赞同：250
> 
> 时间：2009-02-16T14:06:02.643
> 
> 标签：javascript, jquery

我正在尝试为 div 提供淡出效果并在单击图像时删除该 div(id = "notification")。

这就是我这样做的方式：

```
<a onclick="$("#notification").fadeOut(300,function() { $("#notification").remove(); });" class="notificationClose "><img src="close.png"/></a> 
```

这似乎不起作用。我需要做什么来解决这个问题？

* * *

## 回答 #1

> 赞同：475
> 
> 时间：2009-02-16T14:09:16.957

试试这个：

```
<a onclick='$("#notification").fadeOut(300, function() { $(this).remove(); });' class="notificationClose "><img src="close.png"/></a> 
```

我认为你周围的双引号`onclick`使它不起作用。:)

**编辑**：正如下面所指出的，内联 javascript 是邪恶的，你应该`onclick`把它从 jQuery 的[`click()`](http://docs.jquery.com/Events/click)事件处理程序中取出来。这就是现在很酷的孩子们正在做的事情。

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2009-02-16T14:11:00.543

你真的应该尝试在一个单独的文件中使用 jQuery，而不是内联。这是您需要的：

```
<a class="notificationClose "><img src="close.png"/></a> 
```

然后`<script>`至少在标签中或在外部 JavaScript 文件中位于页面底部。

```
$(".notificationClose").click(function() {
    $("#notification").fadeOut("normal", function() {
        $(this).remove();
    });
}); 
```

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2012-01-20T00:11:58.543

如果你在几个不同的地方使用它，你应该把它变成一个插件。

```
jQuery.fn.fadeOutAndRemove = function(speed){
    $(this).fadeOut(speed,function(){
        $(this).remove();
    })
} 
```

进而：

```
// Somewhere in the program code.
$('div').fadeOutAndRemove('fast'); 
```

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2009-02-16T14:09:13.743

你试过这个吗？

```
$("#notification").fadeOut(300, function(){ 
    $(this).remove();
}); 
```

也就是说，使用当前的**this**上下文来定位内部函数中的元素而不是 id。我一直使用这种模式——它应该可以工作。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-10-07T23:22:15.897

如果您像我一样来自谷歌搜索并希望删除带有酷动画的 html 元素，那么这可以帮助您：

```
$(document).ready(function() {

    var $deleteButton = $('.deleteItem');

    $deleteButton.on('click', function(event) {

        event.preventDefault();

        var $button = $(this);

        if(confirm('Are you sure about this ?')) {

            var $item = $button.closest('tr.item');

            $item.addClass('removed-item')

                .one('webkitAnimationEnd oanimationend msAnimationEnd animationend', function(e) {

                    $(this).remove();
            });
        }

    });

});
```

```
/**
 * Credit to Sara Soueidan
 * @link https://github.com/SaraSoueidan/creative-list-effects/blob/master/css/styles-3.css
 */

.removed-item {
    -webkit-animation: removed-item-animation .8s cubic-bezier(.65,-0.02,.72,.29);
    -o-animation: removed-item-animation .8s cubic-bezier(.65,-0.02,.72,.29);
    animation: removed-item-animation .8s cubic-bezier(.65,-0.02,.72,.29)
}

@keyframes removed-item-animation {
    0% {
        opacity: 1;
        -webkit-transform: translateX(0);
        -ms-transform: translateX(0);
        -o-transform: translateX(0);
        transform: translateX(0)
    }

    30% {
        opacity: 1;
        -webkit-transform: translateX(50px);
        -ms-transform: translateX(50px);
        -o-transform: translateX(50px);
        transform: translateX(50px)
    }

    80% {
        opacity: 1;
        -webkit-transform: translateX(-800px);
        -ms-transform: translateX(-800px);
        -o-transform: translateX(-800px);
        transform: translateX(-800px)
    }

    100% {
        opacity: 0;
        -webkit-transform: translateX(-800px);
        -ms-transform: translateX(-800px);
        -o-transform: translateX(-800px);
        transform: translateX(-800px)
    }
}

@-webkit-keyframes removed-item-animation {
    0% {
        opacity: 1;
        -webkit-transform: translateX(0);
        transform: translateX(0)
    }

    30% {
        opacity: 1;
        -webkit-transform: translateX(50px);
        transform: translateX(50px)
    }

    80% {
        opacity: 1;
        -webkit-transform: translateX(-800px);
        transform: translateX(-800px)
    }

    100% {
        opacity: 0;
        -webkit-transform: translateX(-800px);
        transform: translateX(-800px)
    }
}

@-o-keyframes removed-item-animation {
    0% {
        opacity: 1;
        -o-transform: translateX(0);
        transform: translateX(0)
    }

    30% {
        opacity: 1;
        -o-transform: translateX(50px);
        transform: translateX(50px)
    }

    80% {
        opacity: 1;
        -o-transform: translateX(-800px);
        transform: translateX(-800px)
    }

    100% {
        opacity: 0;
        -o-transform: translateX(-800px);
        transform: translateX(-800px)
    }
}
```

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>JS Bin</title>
</head>
<body>

  <table class="table table-striped table-bordered table-hover">
    <thead>
      <tr>
        <th>id</th>
        <th>firstname</th>
        <th>lastname</th>
        <th>@twitter</th>
        <th>action</th>
      </tr>
    </thead>
    <tbody>

      <tr class="item">
        <td>1</td>
        <td>Nour-Eddine</td>
        <td>ECH-CHEBABY</td>
        <th>@__chebaby</th>
        <td><button class="btn btn-danger deleteItem">Delete</button></td>
      </tr>

      <tr class="item">
        <td>2</td>
        <td>John</td>
        <td>Doe</td>
        <th>@johndoe</th>
        <td><button class="btn btn-danger deleteItem">Delete</button></td>
      </tr>

      <tr class="item">
        <td>3</td>
        <td>Jane</td>
        <td>Doe</td>
        <th>@janedoe</th>
        <td><button class="btn btn-danger deleteItem">Delete</button></td>
      </tr>
    </tbody>
  </table>

<script src="https://code.jquery.com/jquery.min.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" type="text/css" />

</body>
</html>
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-17T11:49:06.650

.fadeOut('slow', this.remove);

* * *

## 回答 #7

> 赞同：-10
> 
> 时间：2014-04-24T20:18:50.547

采用

```
.fadeOut(360).delay(400).remove(); 
```

# search - 使用 Lucene.net 索引多语言内容

> ID：553404
> 
> 赞同：5
> 
> 时间：2009-02-16T14:06:50.600
> 
> 标签：search, localization, lucene.net, multilingual

我使用[Lucene.net](http://incubator.apache.org/lucene.net/)来索引网站上的内容和文档等。索引非常简单，格式如下：

```
LuceneId - Lucene 的唯一 id (TypeId + ItemId)
TypeId - 文本类型（例如页面内容、产品、公共文档等）
ItemId - 网页 id、文档 id 等。
文本 - 索引的文本
标题 - 与搜索结果一起显示的网页标题、文档名称等

```

我有这些选项来调整它以提供多语言内容：

1.  为每种语言创建一个单独的索引。例如 Lucene-enGB、Lucene-frFR 等。
2.  保留一个索引并向其添加一个额外的“语言”字段以过滤结果。

哪个是最好的选择 - 或者还有其他选择吗？我以前没有使用过多个索引，所以我倾向于第二个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T17:02:23.067

我有 [2]，但我遇到的一个问题是我不能根据语言使用不同的分析器。我已经组合了我想要的语言的停用词，但是我失去了分析器将提供的更高级的东西的能力，比如词干等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-26T20:39:13.310

您可以消除选项 1 和 2。
您可以使用一个索引，并且包含阿拉伯语单词的字段为每个字段创建两个字段：如果您有字段“**文本**”可能包含阿拉伯语或英语内容 ==>

*   **为“ Text** ”创建 2 个字段：1 个字段，“ **Text** ”，使用标准分析器进行索引/搜索，另一个字段“ **Text_AR** ”，使用 arabicAnalyzer。为了实现这一点，您可以使用 [PreFieldAnalyzerWrapper](http://lucenenet.apache.org/docs/3.0.3/dc/df9/class_lucene_1_1_net_1_1_analysis_1_1_per_field_analyzer_wrapper.html#details)

# .net - string1 >= string2 未在 Linq to SQL 中实现，有什么解决方法吗？

> ID：553407
> 
> 赞同：10
> 
> 时间：2009-02-16T14:07:32.673
> 
> 标签：.net, linq-to-sql, string-comparison

如何在 Linq to SQL 中执行 string1 >= string2？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-16T14:19:52.143

如果您正在寻找`=>`通常写成的，`>=`那么您不能直接使用字符串执行此操作。您可以通过[CompareTo](http://msdn.microsoft.com/en-us/library/system.string.compareto.aspx)获得相同的行为：

```
string1.CompareTo(string2) >= 0 
```

在这种情况下，结果小于或等于 0 意味着`string1`将在之前排序`string2`，因此更大。

仅供参考`=>`，C# 中的运算符仅用于 lambda 表达式的定义。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-16T14:13:59.350

C# Linq To Sql 不支持 string1 >= string2。String 类根本不覆盖 >= 运算符。它只覆盖 != 和 == 运算符。您可以通过尝试编译以下方法来验证这一点

```
public static void Example() {
  int val = "foo" >= "bar";
} 
```

如果您想与 LinqToSql 中的字符串进行比较，您应该能够使用静态[String.Compare(string,string)](http://msdn.microsoft.com/en-us/library/84787k22.aspx)方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-16T14:15:13.077

您不能对字符串使用大于或等于运算符，因为没有明确的方法来说明您在说什么。如果它们实际上是您可能想要做的数字。

```
var query = from c in dc.Customers
            where c.CustomerID >= Int32.Parse("32")
            select c; 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-16T14:14:48.553

我不确定您要在这里做什么，但字符串直接转换为 Linq 到 SQL 查询。

你能举一个你正在尝试的例子吗？

这是一个基本的示例用法：

```
string string2 = "test";

using (MyDataContext dc = new MyDataContext())
{
   // without lambdas
   var query1 = from item in dc.Items
               where item.Value == string2
               select item;

   // with lambdas
   var query2 = dc.Items.Where(item=>item.string1 == string2);
} 
```

# javascript - 在 Javascript 中创建带有附件的电子邮件时出现问题

> ID：553416
> 
> 赞同：4
> 
> 时间：2009-02-16T14:10:27.080
> 
> 标签：javascript, outlook

我正在通过调用下面的代码并添加附件来启动电子邮件创建。

我希望用户能够输入收件人，并修改消息的内容，所以我不会立即发送。

为什么第二次调用该方法时会出现 RangeError？
（第一次正常工作。）

```
function NewMailItem(p_recipient, p_subject, p_body, p_file, p_attachmentname)
{
   try 
   {
     var objO = new ActiveXObject('Outlook.Application');
     var objNS = objO.GetNameSpace('MAPI');
     var mItm = objO.CreateItem(0);
     mItm.Display();
     if (p_recipient.length > 0) 
     {
       mItm.To = p_recipient;
     }
     mItm.Subject = p_subject;
     if (p_file.length > 0) 
     {
      var mAts = mItm.Attachments;
      mAts.add(p_file, 1, p_body.length + 1, p_attachmentname);
     }
     mItm.Body = p_body;
     mItm.GetInspector.WindowState = 2;
   } catch(e) 
   { 
     alert('unable to create new mail item'); 
   } 
} 
```

mAts.add 行上发生错误。因此，当它尝试附加文档时，它会失败。

文件名 (p_file) 也是图像的 http 地址。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-22T15:42:14.753

不能在 IE 之外工作，用户需要在机器上安装 Outlook 并在其上配置帐户。您确定要以这种方式发送电子邮件吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T14:53:19.927

我正在用这个小片段尝试它，它完美地工作：

```
var objO = new ActiveXObject('Outlook.Application');
var mItm = objO.CreateItem(0);

var mAts   = mItm.Attachments;
var p_file = [
  "http://stackoverflow.com/content/img/vote-arrow-up.png",
  "http://stackoverflow.com/content/img/vote-arrow-down.png"
];
for (var i = 0; i < p_file.length; i++) {
  mAts.add(p_file[i]);
} 
```

请注意，我省略了所有可选参数`Attachments.Add()`。该方法默认在最后添加附件，这似乎是您想要的。

你可以试试这个独立的片段吗？如果它对您有用，请逐步将您的代码减少到这个绝对最小值，您会发现导致错误的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T23:33:50.693

首先做 mItm.display() 然后写 mItm.GetInspector.WindowState = 2; 这会起作用

# winapi - Win32 BitBlt -- 水平镜像

> ID：553424
> 
> 赞同：0
> 
> 时间：2009-02-16T14:13:03.597
> 
> 标签：winapi, image, gdi, mirror

所以我读到 StretchBlt 可以通过否定 nWidthSrc/Dest 和 nHeightSrc/Dest 参数来水平和/或垂直镜像图像。我希望这个功能没有 StretchBlt 的性能开销。我用 BitBlt 尝试了同样的技术，但没有奏效。

有没有办法用像 BitBlt 这样简单的东西来镜像图像，而不需要 StretchBlt 的过度杀伤力？或者如果源和目标大小相同，StretchBlt 是否不会影响性能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T15:11:02.347

BitBlt 只会对有问题的单个像素执行数学运算（或异或等），它不会以任何方式调整图像大小。这正是 StretchBlt 的用途，并且 StretchBlt（与任何其他图形调整大小操作相比）非常快，因为在大多数情况下它可以使用显卡来加速其性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T14:32:58.447

所有 Win32 功能都可能会被极度优化。

是什么让您认为 StretchBlt 会在性能上大受打击？

您是否使用 StretchBlt 分析过您的应用程序？

您可以自己反转所有位图数据，看看是否可以做得更好 StretchBlt。

这是一个可能对您有所帮助的链接：

[http://www.codeguru.com/cpp/gm/bitmap/specialeffects/article.php/c1739](http://www.codeguru.com/cpp/g-m/bitmap/specialeffects/article.php/c1739)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T14:25:04.127

要镜像图像，您只需要以相反的顺序遍历像素。例如，如果您想水平镜像，您只需要执行以下操作：

1.  将图像画布扩展为两倍大小
2.  从图像的底部开始，从上到下将像素写入镜像区域。
3.  从左到右执行第 3 步。

我不知道您使用的是什么语言，但它们中的大多数都允许您使用 GDI 单独操作像素或位。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T14:45:28.510

除非您知道有关图像的一些额外信息（例如，有一个边框，因此您不必翻转某些像素，否则您不会比 StretchBlt 更有效率。

# hibernate - 如何从 EJB3/JPA 中的集合中急切地获取单个“默认”实体

> ID：553429
> 
> 赞同：0
> 
> 时间：2009-02-16T14:14:16.417
> 
> 标签：hibernate, jpa, ejb-3.0, entity-relationship, one-to-many

我有一个带有多个电话号码的 Person 实体。

```
 @OneToMany(mappedBy="person", cascade=CascadeType.ALL)
 public Set<PhoneNumberOfPerson> getPhoneNumbers() {
    return phoneNumbers;
 } 
```

现在我想为急切获取的 Person 实现一个“获取默认电话号码”方法。此默认电话号码是 phoneNumbers 集中的电话号码之一。有没有办法做到这一点？

我试图实现这一点的原因是在一个页面上列出了这个默认电话号码，该页面列出了数据库中的“所有”人员。

作为一名 JPA 初学者，我最初使用以下方法进行了尝试：

```
@Transient
public PhoneNumberOfPerson getDefaultPhoneNumber(){
    if(this.getPhoneNumbers().size()==0)
        return null;

    return this.getPhoneNumbers().iterator().next();

} 
```

但这当然会导致列表页面非常缓慢。

那么有没有办法定义一个瞬态属性，该属性根据某些查询从实体集合中获取单个实体？我使用 Hibernate 作为我的持久性提供程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T17:24:17.323

您最好的选择可能是在 PhoneNumbers 表中有一个字段来指示它是默认号码，然后对返回 Person(s) 的查询执行 JOIN FETCH。

```
select p from Person p JOIN FETCH p.phoneNumbers as ph where ph.default = true 
```

如果一个人可能没有电话号码，则使用左连接。

# project-management - 您是针对现有应用程序进行编码还是在处理新项目？

> ID：553432
> 
> 赞同：4
> 
> 时间：2009-02-16T14:15:17.053
> 
> 标签：project-management

当前的经济低迷对您/您的团队的工作方式有何影响？

与大约一年前的全新开发相比，我倾向于做更多的改进。

这个问题是在另一个酒吧谈话中提出的，当时我们正在讨论是否适合支持应用程序或从事新项目 - 在可预见的未来，随着公司在所有领域削减成本，这将更加稳定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T14:19:18.527

我主要致力于扩展现有的应用程序。我想说这可能也是这两种选择中更安全的一种。人们很可能已经在使用现有的应用程序，因此您无需说服他们，开始使用它对他们来说是有利的。从业务的角度来看，证明一项费用的合理性比尝试增加一项费用要容易得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T14:21:03.187

第 3 项：重写现有应用程序（曾经为我工作的人*suuuuccccckkkked*）。

不过，总体而言，肯定会看到大规模或新项目的低迷，这相当于节省而不是支出的编程。实际上，这就是字面意思，这是摆脱衰退的一个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T15:06:01.517

好问题。我目前正在与拥有良好客户和可观收入的项目合作。所以，经济下滑影响不大。

我的建议是，如果在选择增强现有项目或新项目之间进行选择，最好选择现有项目产生收入。研发项目的投资可能会减少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T15:22:45.190

我相信对现有项目的“支持”和错误修复不会给您带来太多挑战并因此获得经验。对于职业生涯来说，这可能是一个巨大的时间浪费。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T19:26:34.567

我正在将现有的业务应用程序移植到一个新平台，该平台结合了现有应用程序的一些工作方面以及一些新的东西。

它是新的，因为一切都从 Windows 窗体到 ASP.NET AJAX，当涉及到 GUI 和基于事件的方面时，该过程涉及到一些变化，但它也部分适用于现有的东西，因为业务规则是同样的，数据库也是一样的，尽管我们已经根据需要逐步进行改进。

另一方面，我为杂货店工作的公司受到了更多人在家吃饭的积极影响，因此尽管在密歇根州，但公司的一切进展顺利，我们可以负担得起将这个应用程序移到 Intranet 上。

这样做的好处是我可以学习所有新平台的东西，但我们不必走出去为一些新的用例获取用户输入，而且我们可以使用我们收到的输入WinForms 版本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T14:20:46.030

我正在重写我们现有的应用程序。原始应用程序的基本设计不够灵活，无法满足我们的新业务需求。结合有问题的编码实践（模型、视图和控制缺乏分离以及老化技术与许多“NIH”综合症），我们决定重写我们应用程序的非中心部分是最好的。

可悲的是，我不能完全确定我是否 100% 有资格胜任这项工作，但是，我似乎是我们团队中最有资格的人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-19T14:24:16.180

我 90% 的工作是维护，或者看起来是。但令人惊讶的是，我有大约四个新开发项目正在进行或正在筹备中。

# java - 实现客户端 - 主服务器/从服务器应用程序 java

> ID：553435
> 
> 赞同：0
> 
> 时间：2009-02-16T14:16:30.450
> 
> 标签：java, client

我们有一个具有不同布局的字符串处理服务（c++，使用标准输入/输出），每个布局单独运行（最终将在不同的机器上运行），每个布局都需要时间来加载，这就是为什么它必须在之后继续运行首轮。

我必须实现一个带有客户端的系统，该系统将要求主服务器将其连接到实际运行相关布局服务的相关从属服务器。从服务器将从客户端传递的数据传递给服务，完成后将在主服务器上可供其他客户端使用。

问题是实现服务器的最佳方式是什么？我应该在从属/主控之间保持开放连接，直到该过程完成以通知主控连接结束，还是在同步函数中保留某种 var 来检查？

我忽略的任何其他重要输入（或其他设计）也非常受欢迎，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T16:08:07.093

假设你不能替换 C++ 的东西，这就是我会怎么做的。

我会设置一台主服务器。该服务器将运行一个接受请求的进程（可能通过 HTTP，所以它是一个 Web 服务），我会让它读取请求，解析它是什么，然后调用正确的从属服务器。基本上它充当代理。一旦它收到来自从属的响应，它就会将其转发回调用者。这里的简单性意味着如果您开始收到更多的一种类型的请求，您可以为该请求设置额外的服务器并对它们进行循环请求。

从站将是打开 C++ 程序并转发输入和检索输出的 Web 服务。这就是它所做的一切。

我不会费心保持打开的连接（根据您的描述，从属和 C++ 程序之间的连接除外）。只需对这些东西使用网络请求就可以在此过程中保持主从之间的连接打开，但这应该不是问题。这样您就不必担心这个细节。

现在，如果我是你，我会认真考虑用 Java 重新实现 C++ 代码或通过 JNI 或其他方式调用它。如果你可以避免它，我认为避免围绕 C++ 的 Java 包装器将是一个很好的设计目标。Java 可以在启动期间执行任何昂贵的过程，然后像 C++ 代码一样在内存中准备好东西。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T16:24:04.700

根据您的可伸缩性需求，您可能需要查看[Java NIO 包](http://today.java.net/cs/user/print/a/350)。这将为您提供构建可扩展、非阻塞服务器实现的起点。

# svn - Tortoise SVN 命令问题

> ID：553439
> 
> 赞同：2
> 
> 时间：2009-02-16T14:18:57.917
> 
> 标签：svn, version-control, tortoisesvn, diff

我正在尝试使用 Tortoise SVN 命令行实用程序 TortoiseProc.exe。文档建议这样的命令行：

```
"TortoiseProc.exe" /command:diff afile.cpp` 
```

应该做一个差异并在配置的差异查看器中显示结果（在我的情况下是 Tortoise 自己的），但没有发生任何事情 - 查看器没有启动并且没有错误消息出现。

如果我做：

```
svn diff afile.cpp 
```

从同一个目录中，我得到了正常的 Subversion 差异文本输出。

路径没问题，从上下文菜单中乌龟工作正常，那我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T14:31:04.770

您需要`/path:`在源文件的名称之前放置：

```
"TortoiseProc.exe" /command:diff /path:afile.cpp 
```

在我的 TortoiseSVN 上测试。

见[http://tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-automation.html](http://tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-automation.html)

# c# - C#, Linq2SQL: Creating a predicate to find elements within a number of ranges

> ID：553443
> 
> 赞同：8
> 
> 时间：2009-02-16T14:19:55.903
> 
> 标签：c#, linq-to-sql, generics, extension-methods, predicate

Lets say I have something called Stuff in my database, with a property called Id. From the user I get a sequence of selected Range objects (or rather I create them from their input) with the Ids they want. A stripped down version of that struct looks like this:

```
public struct Range<T> : IEquatable<Range<T>>, IEqualityComparer<Range<T>>
{
    public T A;
    public T B;
    public Range(T a, T b)
    {
        A = a;
        B = b;
    }
    ...
} 
```

So one could for example have gotten:

```
var selectedRange = new List<Range<int>>
    {
        new Range(1, 4),
        new Range(7,11),
    }; 
```

I then want to use that to create a predicate to select only things which have a value between those. For example, using the [PredicateBuilder](http://www.albahari.com/nutshell/predicatebuilder.aspx), I can for example do that this way:

```
var predicate = PredicateBuilder.False<Stuff>();
foreach (Range<int> r in selectedRange)
{
    int a = r.A;
    int b = r.B;
    predicate = predicate.Or(ø => ø.Id >= a && ø.Id <= b);
} 
```

and then:

```
var stuff = datacontext.Stuffs.Where(predicate).ToList(); 
```

Which works! What I would like to do now, is to create a generic extension method to create those predicates for me. Kind of like this:

```
public static Expression<Func<T,bool>> ToPredicate<T>(this IEnumerable<Range<int>> range, Func<T, int> selector)
{
    Expression<Func<T, bool>> p = PredicateBuilder.False<T>();
    foreach (Range<int> r in range)
    {
        int a = r.A;
        int b = r.B;
        p = p.Or(ø => selector(ø) >= a && selector(ø) <= b);
    }
    return p;
} 
```

Problem here, is that it crashes with a NotSupportedException because of the selector(ø) call: `Method 'System.Object DynamicInvoke(System.Object[])' has no supported translation to SQL.`

I guess that is understandable. But is there any way to get around this? What I would like to end up with is so that I could just do:

```
var stuff = datacontext.Stuffs.Where(selectedRange.ToPredicate<Stuff>(ø => ø.Id)); 
```

Or even better, create something that returns an IQueryable so that I could just do:

```
var stuff = datacontext.Stuffs.WhereWithin<Stuff>(selectedRange, ø => ø.Id); // Possibly without having to specify Stuff as type there... 
```

So, any ideas? I would really like to get this working, cause if not I will get A LOT of those foreach blocks of code, creating predicates...

* * *

**Note 1:** Of course, would be nice if I could expand to more than int, like DateTime and such, but not sure how that ends up with using the >= and <= operators... Does CompareTo work with linq-to-sql? If not there is no problem creating two. One for int and one for DateTime, since that is mostly the types this will be used for.

**Note 2:** It is going to be used for reporting, where the user is going to be able to narrow down what comes out, based on different things. Like, I want this report for those people and those dates.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T14:27:09.973

The use with generics is problematic, since C# doesn't support operators on generics - meaning you'd have to write the expression manually. And as we've already seen, string works differently. But for the rest, how about something like (untested):

(**edited** for multiple ranges)

```
 public static IQueryable<TSource> WhereBetween<TSource, TValue>(
        this IQueryable<TSource> source,
        Expression<Func<TSource, TValue>> selector,
        params Range<TValue>[] ranges)
    {
        return WhereBetween<TSource,TValue>(source, selector,
            (IEnumerable<Range<TValue>>) ranges);
    }

    public static IQueryable<TSource> WhereBetween<TSource, TValue>(
        this IQueryable<TSource> source,
        Expression<Func<TSource, TValue>> selector,
        IEnumerable<Range<TValue>> ranges)
    {
        var param = Expression.Parameter(typeof(TSource), "x");
        var member = Expression.Invoke(selector, param);
        Expression body = null;
        foreach(var range in ranges)
        {
            var filter = Expression.AndAlso(
                Expression.GreaterThanOrEqual(member,
                     Expression.Constant(range.A, typeof(TValue))),
                Expression.LessThanOrEqual(member,
                     Expression.Constant(range.B, typeof(TValue))));
            body = body == null ? filter : Expression.OrElse(body, filter);
        }            
        return body == null ? source : source.Where(
            Expression.Lambda<Func<TSource, bool>>(body, param));
    } 
```

Note; the use of Expression.Invoke means it will probably work on LINQ-to-SQL but not EF (at the moment; hopefully fixed in 4.0).

With usage (tested on Northwind):

```
Range<decimal?> range1 = new Range<decimal?>(0,10),
                range2 = new Range<decimal?>(15,20);
var qry = ctx.Orders.WhereBetween(order => order.Freight, range1, range2); 
```

Generating TSQL (re-formatted):

```
SELECT -- (SNIP)
FROM [dbo].[Orders] AS [t0]
WHERE (([t0].[Freight] >= @p0) AND ([t0].[Freight] <= @p1))
OR (([t0].[Freight] >= @p2) AND ([t0].[Freight] <= @p3)) 
```

Just what we wanted ;-p

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T14:29:37.877

You are getting that error, because everything for LINQ to SQL needs to be in the form of an [Expression](http://msdn.microsoft.com/en-us/library/bb335710.aspx). Try this

```
public static Expression<Func<T,bool>> ToPredicate<T>(
    this IEnumerable<Range<int>> range, 
    Expression<Func<T, int>> selector
) {
    Expression<Func<T, bool>> p = PredicateBuilder.False<T>();
    Func<T, int> selectorFunc = selector.Compile();
    foreach (Range<int> r in range)
    {
        int a = r.A;
        int b = r.B;
        p = p.Or(ø => selectorFunc(ø) >= a && selectorFunc(ø) <= b);
    }
    return p;
} 
```

Notice that I compile the selector before using it. This should work with out a hitch, I have used something like it in the past.

# apache-flex - 泛型（向量）如何在 AVM 中工作？

> ID：553445
> 
> 赞同：15
> 
> 时间：2009-02-16T14:20:23.373
> 
> 标签：apache-flex, generics, vector, avm2

Flash Player 10 中添加了对泛型的支持（目前只有[Vector.<*>](http://livedocs.adobe.com/flex/3/langref/Vector.html)，并且被 Adob​​e 称为“后缀类型参数”），但唯一的[AVM2 文档](http://www.adobe.com/devnet/actionscript/articles/avm2overview.pdf)没有描述如何访问这些对象。

具体来说，我注意到一个新的操作码 (0x53) 和一个新的多名称类型 (0x1D) 似乎相关，但它们的用法没有记录。

*注意：这个问题是用已知的答案创建的，因为在这里比在我的博客或 Adob​​e Bug DB 上更容易找到。*

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-16T14:24:49.400

我在这方面所做的逆向工程工作不包括声明您自己的泛型类型，尽管这很有可能。

对声明（无参数）泛型类型（Vector）的引用是通过常规限定名称进行的（尽管任何多名称都应该这样做）。

对类型化泛型类型（Vector.<int> 与 Vector.<> 相对）的引用是由一种新的多名称类型 (0x1D) 进行的，我称之为 GenericName。GenericName 的格式如下：

```
[Kind] [TypeDefinition] [ParamCount] [Param1] [Param2] [ParamN] 
```

在哪里：

*   [TypeDefinition] 是一个 U30 入多名表
*   [ParamCount] 是 U8 (U30?) 有多少个类型参数
*   [ParamX] 是一个 U30 进入多名称表。

显然，泛型通常还不被支持，所以 ParamCount 将始终为 1（对于 Vector.<*>）。

另一个有趣的事情是如何创建类的实例。在 Flash 10 (0x53) 中添加了一个新的操作码，我将其称为 MakeGenericType。MakeGenericType 使用以下堆栈声明：

```
TypeDefinition, ParameterType1, ParameterTypeN -> GenericType 
```

它还有一个参数，一个 U8（U30？），指定堆栈上有多少个参数。您通常会看到 MakeGenericType 像这样使用：

```
GetLex [TypeDefinitionMultiname]
GetLex [ParameterTypeMultiname]
MakeGeneric [ParamCount]
Coerce [GenericNameMultiname]
Construct [ConstructorParamCount] 
```

所以如果你有以下...

```
GetLex __AS3__.vec::Vector
GetLex int
MakeGeneric 1
Coerce __AS3__.vec::Vector.<int>
Construct 0 
```

您现在将拥有一个 Vector.<int> 的实例

# ruby - 在 Ruby 中，为什么 nil.id 返回 4？

> ID：553449
> 
> 赞同：35
> 
> 时间：2009-02-16T14:23:33.663
> 
> 标签：ruby

这一直困扰着我很长一段时间。

```
>> nil.id
(irb):2: warning: Object#id will be deprecated; use Object#object_id
=> 4 
```

为什么 nil.id 是 4？（或 nil.object_id 如果你想对弃用挑剔）

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-16T14:25:43.533

这是因为 nil 是语言初始化时创建的对象，而该对象的 id 恰好总是 4。

有关为什么 id 恰好是 4 的更多信息，请参阅[此](http://neeraj.name/blog/articles/662-why-the-id-of-nil-is-4-in-ruby)博客文章。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-18T03:52:05.800

我一直认为这是一个很酷的复活节彩蛋：在日本 4 是死亡人数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-16T15:09:12.710

这是因为每个对象的 id 必须以某种方式在 C Ruby 解释器中表示。数字被映射到 (number*2)+1，真实性得到 0，虚假性得到 2，nil 剩下 4 个。这只是一个奇怪的实现问题或泄漏的抽象。除非您想编写一个 Ruby 解释器，否则您不必担心它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-02T09:58:57.163

如果你在 irb 中尝试这个，你会得到 4

```
irb
>> NIL.id
(irb):7: warning: Object#id will be deprecated; use Object#object_id
=> 4 
```

在 ruby​​ 日本人设置 nil 方法调用它返回 4 这是他们将 4 设置为“危险”或“死亡”的语言标准

# jquery - jQuery AJAX 字符编码

> ID：553463
> 
> 赞同：60
> 
> 时间：2009-02-16T14:30:49.807
> 
> 标签：jquery, ajax, character-encoding

我目前正在编写一个法语网站。有一个日程安排页面，旁边的链接可用于加载另一天的日程安排。

这是我用来执行此操作的 JS：

```
 <script type="text/javascript">
    function load(y) {
        $.get(y,function(d) {
            $("#replace").html(d);
            mod();
        });
    }
    function mod() {
        $("#dates a").click(function() {
            y = $(this).attr("href");
            load(y);
            return false;
        });
    }
    mod();
    </script> 
```

实际的 AJAX 就像一个魅力。我的问题在于对请求的响应。

因为是法语网站，所以有很多重音字母。出于这个原因，我正在使用 ISO-8859-15 字符集。但是，在对我的 AJAX 请求的响应中，重音符号变为 ?，因为字符编码似乎已更改回 UTF-8。

我该如何避免这种情况？我已经尝试在请求的文档顶部添加一些 PHP 来设置字符集：

```
<?php header('Content-Type: text/html; charset=ISO-8859-15'); ?> 
```

但这似乎也不起作用。有什么想法吗？

此外，当你们中的任何人都在看这里时......为什么在加载新页面时最右边的列似乎变小了，导致表格扭曲并且每个`<li>`都`<td>`换行到下一行？

干杯

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-02-16T15:04:47.060

在 AJAX 调用上指定内容类型解决了我在挪威网站上的问题。

```
$.ajax({
        data: parameters,
        type: "POST",
        url: ajax_url,
        timeout: 20000,
        contentType: "application/x-www-form-urlencoded;charset=ISO-8859-15",
        dataType: 'json',
        success: callback
}); 
```

您还必须在服务器上指定字符集。

```
<?php header('Content-Type: text/html; charset=ISO-8859-15'); ?> 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-16T14:33:50.457

UTF-8 应该处理所有重音和外来字符 - 为什么不在您的数据源上使用它呢？

**编辑**
[[测试文件的存档副本。](https://web.archive.org/web/20090220110811/http://blog.yoavfarhi.com/test.html)] 与您的数据

首先，一切都应该是 UTF-8。我在 notepad++ 中加载了文件，转换为 utf-8 并手动将字符更改为重音。一旦完成，一切都会像魅力一样工作。

顺便说一句，除非您的服务器被定义为 php-process .html 文件，否则您使用 ajax 加载的文件不会获得您的 iso 字符集。如果您坚持使用 iso 字符集，请请求 php 文件而不是 html 文件，并在标题中定义字符集（而不是在文件本身中）

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2010-01-25T07:15:06.100

```
$str=iconv("windows-1250","UTF-8",$str); 
```

最终是什么帮助了我

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-16T14:53:27.930

您需要将服务器设置为使用 ISO-8859-15 作为字符编码（添加适当的 HTTP 标头）。在 html 正文中执行此操作无济于事。

我可以看到这条线

```
<?php header('Content-Type: text/html; charset=ISO-8859-15'); ?> 
```

在您的 html 的来源。这不应该发生。使用实时 HTTP 标头我看不到适当的字符集 HTTP 标头。将它用于您的第一页和 ajax 服务。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-05-11T23:42:25.933

我强烈建议使用 javascript escape() 方法

您可以通过获取这样的表单值来将其与 jQuery 一起使用：

```
var encodedString = escape($("#myFormFieldID").val()); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-02-10T01:15:05.140

对于我的 PHP 应用程序，解决方案是为每个变量包含 utf8_decode 函数`$_POST`。

例如：（服务器端）

```
if( strtoupper($_SERVER['REQUEST_METHOD']) == "POST" ){
$variable = htmlentities($_POST['variable']); // wrong
$variable = htmlentities( utf8_decode($_POST['variable']) ); // right
} 
```

阿布拉索斯！！！（再见！！！）

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-16T15:00:14.590

打印出ajax文件中的变量时。放一个

```
htmlentities() 
```

在他们周围，看看它是否有效。在冰岛 ajax 应用程序中为我工作。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-06-03T23:15:28.273

我在西班牙门户网站的内容评论系统中工作时遇到了类似的问题。经过几个小时的搜索，最终解决了我的问题，而不是弄乱 jQuery 字符集，似乎无论如何都使用 utf-8，它是在处理的 PHP 中从 utf-8 解码回 ISO-8859-1 ajax POST。在 PHP 中有一个内置函数 ， `utf8_decode()`所以我对注释字符串做的第一件事是：

```
$comentario = utf8_decode($_POST['comentario']); 
```

（然后我使用`nl2br()`和`htmlentities()`PHP 函数来准备要使用 html 实体而不是特殊字符存储的文本）

祝你好运与和平！塞巴

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-02-26T13:24:26.537

尽管指定了以下内容，但瑞典/挪威字母显示为问号时遇到了问题：

```
contentType: "application/json; charset=utf-8", 
```

这是通过添加`encodeURIComponent`到字符串来解决的。

```
url: "/set_comment.do?text=" + encodeURIComponent(comment), 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-06-23T11:36:09.277

我一直在摆弄这个问题，发现这个解决方案适用于 Firefox 和 safari（是的，我目前在 Mac 上）。

收到请求时，我在这里做了一个 content-type=iso-8859-1 ：

```
if (window.XMLHttpRequest) { // Mozilla, Safari, ...
  httpRequest = new XMLHttpRequest();
        if (httpRequest.overrideMimeType) {
            httpRequest.overrideMimeType('text/xml; charset=ISO-8859-1');
        }
    } 
```

如果有人发现这在 ie 中不起作用，请告诉我。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-05-15T22:01:15.360

我的页面也有类似的 ASP 问题。我已经解决了：

1）在Jquery ajax方法调用的ASP文件的开头插入指令：

```
Response.Charset = "windows-1252" 
```

在未定义字符集之前的我的 asp 页面中，我使用 ANSI 编码保存了我的文件（使用文本编辑器作为记事本++）

2) 在使用 jquery ajax 方法调用 ASP 文件的 html 文件中，我插入了您在下面看到的参数 content-type：

```
$.ajax({         
data: parameters,         
type: "POST",         
url: ajax_url,
datatype: 'html',         
contentType: "text/html;charset=windows-1252", 
```

简而言之，重要的是在您的 ASP 文件中定义称为字符集。奇怪的是，我看到我的 jquery 适用于 windows-1252 但不适用于 ISO-8859-1 字符集：在这种情况下 jquery ajax 方法给出了一个例外。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-09-10T20:17:19.783

我尝试了许多建议来读取带有德语特殊字符（ä、ö、ü）的文本文件。到底：

```
 $.ajax({
        async:false,
        type: "GET",
        url: "data/FileName.txt",
        dataType: "text",
        contentType: "application/x-www-form-urlencoded;charset=UTF-8",
        success: function (data) {
           alert(data);
        }
    }); 
```

让我读入特殊字符，但只有在我**以 UTF-8 格式明确保存 FileName.txt 之后**。在 Windows 编辑器中保存文本文件的标准格式是**ANSI**而不是**UTF-8，**但如果您“另存为”并使用保存按钮旁边的下拉框或使用更好的编辑器开始，则可以更改它。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-08-04T18:12:10.673

我不同意一切都必须是 UTF-8，你可以让它与 ISO 8859 完美配合，我同意了，请在此处阅读我的回复。

[我在stackoverflow中的回复](https://stackoverflow.com/questions/965150/jquery-ajax-post-and-encoding/1229012#1229012)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-06-08T17:55:49.810

```
<script type="text/javascript">
  function GetContent(idUser){ 
    $.ajaxSetup({
      url: 'ping.php'
    });

    $.ajax({
      type: "POST",
      url: "blablabla.php",
      dataType: "text",
      data: ({ParamUserID:idUser}),// here we def wich variabe is assiciated
      contentType: "application/x-www-form-urlencoded; charset=iso-8859-1",
      success: function(html) {
        $('#user_specified_content').html(html);
      }
    });     
  }
</script> 
```

这是我从 blabla.php 页面获取内容的脚本。

当我收到关于成功的数据时，我的口音不会出现。

`.success`我自己找到了一个非常好的工作解决方案，用于从函数中获取带有重音的数据

在我的 blabla 页面上。我这样做是为了解决我的问题：

我`utf8_encode(place your data here)`在我的 php 文件中使用。请参阅下面的实际操作：

```
while( $row = sqlsrv_fetch_array($recordset) )
{                           
    <option value="<?php echo $row["xyz"]; ?>"><?php echo utf8_encode($row["gName"]) . ' | ' . utf8_encode($row["gManagerName"]); ?></option>                           
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-08-29T16:05:57.470

我曾尝试使用 $.ajax 读取本地 json/文本文件，但编码起初不起作用。我通过将 json 文件保存为 UTF-8 编码使其工作。这可以通过Windows记事本简单地完成。使用“另存为”，然后在文件名下方您可以将编码设置为UTF-8。

祝你好运！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-16T15:13:30.657

我对以下页面有同样的问题：

*   正常调用时显示正常
*   通过 ajax 请求调用时特殊字符弄乱了

为了解决问题（使用php），我使用了`utf8_encode()`or `htmlentities()`on source data。两者都有效，我在不同的项目中使用过它们。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-11-05T18:06:49.760

刚换成`{"type":"GET"}`和`{"type":"POST"}`像魅力一样工作`ISO-8859-1`

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-03-23T12:09:13.100

如果整个应用程序使用 ISO-8859-1，您可以修改您的 jquery.js 替换所有出现的`encodeURIComponent`by `escape`（在当前 jquery 脚本中有 2 个出现要替换 - 1.5.1）

有关更多信息，请参见[encodeUIComponent](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/encodeURIComponent)和[escape](https://developer.mozilla.org/en/DOM/window.escape)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-05-21T08:02:21.643

我遇到了同样的问题并尝试了几种方法。我找到了解决方案。如果您为“接受”设置请求标头，如下所示；

```
$.ajax({
        data: parameters,
        type: "POST",
        url: ajax_url,
        dataType: 'json',
        beforeSend : function(xhr) {
            xhr.setRequestHeader('Accept', "text/html; charset=utf-8");
        },
        success: callback
}); 
```

你会看到所有的字符看起来都是正确的

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-07-07T18:27:23.100

我提出这个问题的问题与提问者完全相同。这里的答案非常有用，我尝试了几乎每一个建议的答案。不过，这里没有一个答案对我有用——我的问题可能略有不同。许多人似乎就是这种情况。在最终得到答案之前，我尝试了很多。

所以现在我要添加到已经很长的答案列表中，我自己的解决方案解决了我的编码问题。

我只做了两件事。在我添加的数据库连接脚本中：

```
mysql_set_charset('utf8',$connection); 
```

除此之外：

*   我将所有文件的编码更改为 UTF-8

关键是一切都必须具有相同的编码。在创建新的 php 文件时，对于脚本来说，仅仅改变脚本中的编码是不够的——文件本身必须正确编码。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2013-08-11T15:31:04.043

如果您使用 CodeIgniter，您可以通过在加载任何视图之前将以下代码添加到控制器来解决此问题（假设您已`charset`在配置中正确设置。如果没有，只需将`charset=whateveryouwant`.

```
$this->output->set_header('Content-type: text/html; charset='.$this->config->item('charset')); 
```

我这样做的方法是将该行添加到 MY_Controller 的构造函数中，这是我所有控制器的超类，这样我可以确保在任何地方都不会出现编码问题。

顺便说一句，这不会影响 JSON 返回（以 UTF-8 编码）。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-11-04T18:32:59.840

我有类似的问题。我有带有法语文本的 json 数据的文本文件。显示某些字符时总是出现问题。在我的例子中，JavaScript 程序使用 Ajax 来检索 json 文本文件，如下所示：

```
$.ajax({
    async: false,
    type: 'GET',
    url: 'some-url',
    success: function(data, status) {
        mainController.constructionStageMaster = data.records;
     }
}); 
```

返回的数据总是有不正确的重音法语字母。

json 文本如下所示：

```
{
    "records": [
        {
            "StageDesc": "Excavation, Fondation et Bases",
            "Allowed": 9,
            "Completed": 0,
            "TotalCompleted": ""
        },
        {
            "StageDesc": "Étanchement et Remblayage",
            "Allowed": 3,
            "Completed": 0,
            "TotalCompleted": ""
        },
        {
            "StageDesc": "Encadrement et revÃªtement mural intermÃ©diaire",
            "StageDesc_fr": "Encadrement et revÃªtement mural intermÃ©diaire np++",
            "StageDesc_fr2": "Encadrement et revêtement mural intermédiaire",
            "Allowed": 15,
            "Completed": 0,
            "TotalCompleted": ""
        }
        ...
    ]
} 
```

请注意，在上面的示例数据中，第 3 个元素，我放置了带有正确`é`和不正确`Ãª`法语重音字母的文本。

供您参考，似乎有一些使用`ISO-8859-1`字符编码的 Eclipse 项目的全局配置。在您的情况下，它可能是不同的编码。

在检查了上面的解决方案并玩了这个项目之后，这就是解决我的问题的方法：

*   找到正确显示法语文本的文本来源
*   复制文字
*   转到 Eclipse，打开包含数据的文本文件
*   在资源管理器中右键单击文件，打开属性，然后将编码更改为`ISO-8859-1`
*   修复文本，使其正确显示。使用复制/粘贴或键盘
*   您可能必须使用键盘箭头键（左/右）来确保没有隐藏的罪魁祸首字母会以有趣的形状显示在 HTML 上。删除这样的隐藏字母
*   保存文件

现在，在我的例子中，我没有在 Ajax 调用中指定任何编码选项，它工作正常。另外，如果我用 json 数据更改文本文件的编码，它仍然可以正常工作。

塔雷克

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-04-26T23:01:43.177

jQuery 默认采用 UTF-8，要更改此默认值，请执行以下操作：

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js">
</script>
<script>
  $.ajaxSettings.mimeType="*/*; charset=ISO-8859-15";// set you charset
</script> 
```

这对我来说很好用！... ;))...

# bash - SSH，输入命令但没有执行，不能输入任何东西

> ID：553466
> 
> 赞同：3
> 
> 时间：2009-02-16T14:31:13.147
> 
> 标签：bash, ssh

我使用了该命令`tar -x file.tar.gz`，但由于某种原因或任何原因，它失败了。然后我被卡住了，无法输入任何内容，但无法运行更多命令。按 Enter 只会给我一个新行。我也不知道如何摆脱它（逃避等不起作用）。我可以恢复工作的唯一方法是关闭腻子并重新连接。

有没有办法让它恢复正常，这样我就可以继续前进，因为一直关闭它很烦人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T14:33:03.407

尝试按 CTRL+C :) 这将取消/杀死/停止正在运行的命令！

但是最好的解压方法是使用 -v 来详细输出：

```
tar -zxvf yourfile.tar.gz 
```

有了这个，您可能会发现您的文件比您想象的取消归档花费的时间更多；）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-16T14:35:03.823

Ctrl-C 可用于向挂起的可执行文件发送中断，但这取决于应用程序来处理它。Ctrl-Z 将使您脱离正在运行的可执行文件，但您需要手动终止该进程。

你做错的是你没有压缩档案。

试试这个

tar -zxf 文件.tar.gz

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T14:34:14.887

如果要退出它，请按 CTRL+c。如果您想保留它但能够在它工作时编写更多命令，请按 CTRL+z 和 bg。然后它将在后台工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T14:44:56.513

您的命令失败，因为它正在尝试读取标准输入。这是因为您从未使用“f”选项告诉它 tar 文件的名称。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T14:48:43.713

一个好主意是使用[GNU screen](http://en.wikipedia.org/wiki/GNU_Screen)。这样，当命令挂起时，您可以打开另一个屏幕并查看系统（例如 top 以查看 tar 是否仍在工作），或者您可以通过按 (strg+a) + k 硬杀来终止进程屏幕会话中正在运行的进程。Screen 还有一个很好的功能，即使您的 SSH 连接断开，您的进程也会继续运行。这是救命稻草！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T15:01:07.303

正如其他人指出的那样，您的 tar 调用正在等待命令行上的输入。您也可以使用 Ctrl-D 向 tar 进程指示 EOF。

# version-control - 版本控制系统的历史可视化工具？

> ID：553478
> 
> 赞同：27
> 
> 时间：2009-02-16T14:36:28.703
> 
> 标签：version-control, visualization, gource

具体来说，我正在寻找一些东西，给定一个文件和一个 SVN 历史，将插入和删除显示为一个漂亮的动画。

也就是说：我认为版本控制可视化工具列表可能是一个有用的资源。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-02-17T09:21:31.463

[http://code.google.com/p/gource/](http://code.google.com/p/gource/)看起来很漂亮

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-16T15:02:46.940

我不确定漂亮，但**[Codewarm](http://code.google.com/p/codeswarm/)**肯定是我见过的最令人印象深刻的“提交历史可视化”工具之一。

[![替代文字](https://i.stack.imgur.com/BJUPL.png)](https://i.stack.imgur.com/BJUPL.png)
[（来源：[infovis-wiki.net](http://www.infovis-wiki.net/images/7/7f/Ogawa08codeswarm.png)）]

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-16T15:11:12.003

在更实际的方式中，您还可以考虑**[SVN Time-Lapse View](http://code.google.com/p/svn-time-lapse-view/)**

> SVN Time-Lapse View 是一个跨平台查看器，可下载文件的所有修订版，并让您通过拖动滑块滚动浏览它们。
> 当您滚动时，您会看到当前修订版和先前修订版的视觉差异。
> 因此，您可以看到文件是如何演变的，并且您可以轻松找到行出现、消失或更改的修订版本。

（在“动画”方面不大，但仍然有用）

![带注释的窗口截图](https://i.stack.imgur.com/59Wu0.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T15:05:49.677

大多数 VCS 都有 Web 或 GUI 界面，例如 gitk、hgk 等。它显示了回购生命周期中的各种“分支”和“合并”，但如果你想要更漂亮的东西，那么 Codewarm 就是你的答案:)

# c# - 互斥：这样安全吗？

> ID：553480
> 
> 赞同：1
> 
> 时间：2009-02-16T14:36:43.880
> 
> 标签：c#, .net, multithreading, mutual-exclusion

这种互斥模式是否像我认为的那样安全？如果是这样，你怎么称呼它？

```
lock (_lock) {
    if (_flag) return;
    else _flag = true;
}
try {
    //critical code...
}
finally {
    _flag = false;
} 
```

我想确保关键部分，但没有其他线程堆积等待获取锁。显然，我确保标志没有设置在其他任何地方。有没有更好的办法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-16T14:41:00.360

不，那不安全。如果要确保互斥而不阻塞，可以使用 Monitor.TryEnter：

```
if (Monitor.TryEnter(lockObj, 0)) {
    // got the lock !
    try {
        // code
    }
    finally { // release the lock
        Monitor.Exit(lockObj);
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T14:40:57.647

你看过[`Monitor.TryEnter`](http://msdn.microsoft.com/en-us/library/4tssbxcw.aspx)吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T22:15:20.427

互斥模式的正确性取决于赋值 _flag=false 是原子的。想象一下如果分配可能被另一个线程中断会发生什么。如果分配的中间结果可能被测试解释为错误，则一个分配可能导致多个线程进入临界区。

互斥模式的正确性还取决于编译器中是否缺少可能重新排列语句顺序的优化。想象一个“智能”编译器，它会将赋值 _flag=false 向上移动，因为 _flag 在中间的代码中没有被引用（并且中间的代码不会抛出异常）。然后编译器可以优化锁定部分中的部分以读取

```
if(_flag) return; 
```

这两个模式为什么会失败的例子都是高度推测性的，我认为你可以安全地假设它有效。但是，如果存在另一个可以根据需要工作的选项，您最好使用它（请参阅其他帖子）。如果同一代码中有其他开发人员，则无需考虑该模式是否有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T15:24:48.900

`lock(Object)`一个简单的陈述不会起作用吗？在幕后，它在块`Monitor`内创建和关键部分`try... finally`。

```
private static readonly Object lockMe = new Object();
lock(lockMe)
{
    // critical code
} 
```

# asp.net - 如何从 ASP.NET 主题中排除特定的 CSS 文件？

> ID：553482
> 
> 赞同：4
> 
> 时间：2009-02-16T14:37:44.160
> 
> 标签：asp.net, themes

我正在制作一个必须在 FF/IE6/IE7/Opera/Safari 上正确呈现的网站。IE6 是一个较晚的要求（当我完成所有其他浏览器时），它必须是可用的，不一定与其他浏览器相同。现在我正在对其进行调整，以便它也可以在 IE6 上使用。

为此，我在我的主题中创建了另一个样式表，名为`IE6_override.css`. 您可能已经猜到了，我希望它仅在浏览器为 IE6 时应用。有条件的评论非常适合这一点。

唯一的问题是 - ASP.NET`<link>`为主题文件夹中的每个 CSS 文件呈现一个标签，因此在所有浏览器上无条件地包含此文件。

我想坚持主题，因为我们以后可以为我们的应用程序创建更多皮肤是完全可行的（如果客户愿意的话）。

有什么办法可以让 ASP.NET 从它的自动包含中排除这个特定的 .CSS 文件？

**补充：**感谢您的回答！最后我找到了解决方法。由于我之前[询问过](https://stackoverflow.com/questions/519945/how-to-style-input-typetext-in-ie6-css)的其他一些样式问题，我也不得不使用 IE6 解决方法 Javascript。因此，我在所有特定于 IE6 的规则前面加上了一个*`.ie6_dummy`*类选择器，然后在页面加载时在 JS 中将其删除。:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-10-18T10:29:34.460

是的，您可以...您可以在后面的代码中删除特定的页眉控件。css 文件是通过主题自动添加的，但您可以在之后再次删除它们。例如，您可以放入主文件的页面加载：

```
Page.Header.Controls.Remove(YourCssFile); 
```

或者，如果您想同时删除所有 css 文件：

```
var themePath = string.Format("~/App_Themes/{0}", Page.Theme);
var removeCandidate = Page.Header.Controls.OfType<HtmlLink>().Where(link => link.Href.StartsWith(themePath)).ToList();
removeCandidate.ForEach(Page.Header.Controls.Remove); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T14:45:57.713

我不认为你可以。正是出于这个原因，我们停止使用 App_Themes 文件夹。这也让我们不必为每个 css 文件加上一个数字前缀，以便它们以正确的顺序加载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T14:57:16.827

事实上，不可能排除特定的 CSS 文件。[但是，这里](http://adam.kahtava.com/journal/2008/04/07/AReflectionOnThemesSkinsAndCascadingStyleSheetsCSSInASPNET20AFinalConclusion.aspx)似乎有几种解决方法。我建议通读这些并选择合适的解决方案（如果有的话）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T14:58:31.317

网上有一些帖子似乎可以解决您的问题 - 寻找“asp.net 主题中的条件评论”我遇到了这些看起来可能有帮助的帖子：

1.  [如何使用 StylePlaceholder 和 Style 控件控制 ASP.NET 主题中的样式表](http://www.egil.dk/2008/11/30/how-to-take-control-of-style-sheets-in-aspnet-themes-with-the-styleplaceholder-and-style-control/)
2.  [主题中的条件样式表](http://msdn.microsoft.com/en-us/asp.net/aa336613.aspx)

第一个也将解决主题样式表的媒体问题。

# javascript - Flash 没有与我的应用程序内浏览器中的 Javascript 交互

> ID：553485
> 
> 赞同：1
> 
> 时间：2009-02-16T14:39:07.260
> 
> 标签：javascript, flash, security, xulrunner

我有一个嵌入`xulrunner`基于浏览器的应用程序。

我必须在其中加载一些与一些 javascript 对话以更新浏览器标题的 Flash 内容。

从 Firefox 启动但不在我的应用程序中时，Flash 内容可以正常工作。我尝试了一个包含一些 javascript 的示例 html 文件，它们工作正常。当我在服务器上有 Flash 内容时，它甚至可以工作。只有当我尝试通过本地机器上的 flash 运行 js 时，我才会看到这个问题。

我想这一定与`xulrunner`. 有人可以帮我弄清楚问题可能是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T14:56:34.067

看看[这个答案](https://stackoverflow.com/questions/542747/flash-develop-publishing/542879#542879)，它可能会解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T14:45:24.543

您还可以从应用程序本身更改浏览器标题...

```
import mx.managers.IBrowserManager;
import mx.managers.BrowserManager;

private var bm:IBrowserManager = BrowserManager.getInstance();
bm.init("", "New Browser Title"); 
```

# css - IE 中有哪些 CSS 错误？

> ID：553488
> 
> 赞同：4
> 
> 时间：2009-02-16T14:40:07.743
> 
> 标签：css, internet-explorer

我在 IE 对 CSS 的解释中发现了一些对错误或问题的引用，但这些信息似乎相当分散。如果存在这样的概述，我想要一个指向全面概述的指针。

**编辑：**微软已经愿意列出 IE 的 CSS 问题（感谢 mouviciel->sanchothefat），但显然他们不会提供解决方法。所以解决方法也会很好。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T14:43:10.620

查看[怪癖模式](http://www.quirksmode.org/css/contents.html)。它是跨浏览器的 CSS 兼容性的绝佳资源。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T14:50:44.987

我发现避免痛苦的最佳策略是遵循以下规则：

1.  首先构建更兼容且对开发人员友好的浏览器，例如 firefox，稍后在 IE（以及 safari/chrome(webkit) 和 opera）中进行彻底测试
2.  使用严格的文档类型——避免怪癖模式，因为怪癖根据定义不是标准的
3.  使用[重置样式表](https://stackoverflow.com/questions/167531/is-it-ok-to-use-a-css-reset-stylesheet)
4.  使用 jQuery 或 Prototype 之类的 javascript 框架 - 它们可以隐藏一些 javascript 和 DOM 不兼容性。
5.  使用良好的语义布局 - 对于行为不端的浏览器，它更有可能很好地降级
6.  接受它不会是完美的，不要担心真正的小差异

遵循这些规则，我一开始就没有那么多问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T15:05:35.700

我，我使用“ [Internet Explorer Exposed](http://www.positioniseverything.net/explorer.html) ”。非常有深度的资源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T14:43:03.803

我发现自己经常提到这个页面：

[http://www.webcredible.co.uk/user-friendly-resources/css/internet-explorer.shtml](http://www.webcredible.co.uk/user-friendly-resources/css/internet-explorer.shtml)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T14:44:09.497

[您可以通过咨询这个SO question](https://stackoverflow.com/questions/495050/list-of-css-features-not-supported-by-ie6)找到一些答案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-16T14:49:18.500

对于下拉列表：

```
<select>
    <option value="1">1</option>
    ...
    <option value="N">N</option>
</select> 
```

CSS 边框样式不起作用：

如果您尝试：

```
select
{
    border: solid 1px #0000ff;
} 
```

什么都不会发生。

此外，提交按钮的宽度将与按钮文本成比例地扩展，直到您为其指定样式：

```
input[type="submit"]
{
overflow:visible;
} 
```

以及许多其他有趣的事情。:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-17T11:36:32.527

[我以PositionIsEverything](http://positioniseverything.net/)发誓。

他们维护大多数浏览器中的错误/怪异列表。查看他们详尽的[Internet Explorer 错误](http://positioniseverything.net/explorer.html)列表，希望您觉得它足够全面。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-16T15:12:22.830

[quirksmode](http://quirksmode.org)已经发布，但我将添加[On having layout](http://www.satzansatz.de/cssd/onhavinglayout.html)，它解释了 IE 的许多古怪之处的原理之一。

# asp.net - Winforms、ASP.NET、WPF 的语法高亮文本框

> ID：553492
> 
> 赞同：12
> 
> 时间：2009-02-16T14:40:28.367
> 
> 标签：asp.net, wpf, winforms, syntax-highlighting, components

我正在寻找一个语法高亮的文本框组件，最好是免费的，有源代码，并且能够在 Winforms、ASP.NET 和 WPF 中使用。此外，它不仅应该支持显示，还应该支持编辑内容。

我发现了[适用于 ASP.NET 的出色的免费 ActiPro SyntaxHighlighter，](http://www.actiprosoftware.com/Products/DotNet/ASPNET/CodeHighlighter/Default.aspx)但不幸的是，这仅适用于 ASP.NET，它仅以语法突出显示的方式显示文本，它没有编辑功能.....

我也知道作为[SharpDevelop](http://www.sharpdevelop.com/OpenSource/SD/Default.aspx)`ICSharp Text Editor`一部分的组件，但那是一个独立的但仅限 Winforms 的解决方案。

有谁知道一个组件，它有一个核心来处理语法高亮（可配置，所以我可以将它用于 C# 代码、XML 和 HTML 文件等），并且它具有三个用于 Winforms、ASP.NET 的“皮肤”和WPF？我真的更喜欢有*一个*核心来完成繁重的工作，并且三个 UI 共享该核心代码......

欢迎任何指针和提示！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T03:50:06.030

我和你在一起，马克：我很想看到一个可扩展的语法高亮框架，它可以生成一个标记化的“文档”对象，然后可以通过每个显示框架的控件显示该对象。这样解析器/标记器可以编写一次！

我能说的最好的就是[这个线程](https://stackoverflow.com/questions/394751/anyone-know-a-code-editor-i-can-embed-in-a-wpf-window-or-windows-forms)表明[ActiProSoftware](http://www.actiprosoftware.com/Products/DotNet/ASPNET/CodeHighlighter/Default.aspx)正在为他们的语法荧光笔开发 WPF 控件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-28T04:48:04.337

或许可以考虑用于 Web 的[CodeMirror](http://codemirror.net/)项目。显然，这不适用于您所要求的 WPF，但它适用于任何 Web 框架 - Webforms、ASP.NET MVC、纯 HTML、PHP 等。

> CodeMirror 是一个 JavaScript 库，可用于为类似代码的内容（计算机程序、HTML 标记等）创建一个相对舒适的编辑器界面。如果已经为您正在编辑的语言编写了解析器（请参阅下面的支持语言列表），代码将被着色，并且编辑器将帮助您进行缩进。

解析器：

*   JavaScript
*   XML/HTML
*   CSS
*   HTML 混合模式
*   SPARQL
*   HTML+PHP 混合模式
*   Python
*   卢阿
*   红宝石
*   SQL
*   PLSQL
*   差异
*   时髦的
*   C＃
*   方案
*   爪哇
*   XQuery
*   OmetaJS
*   自由标记

执行：

```
<textarea  rows="30" cols="120" id="someCode" >
    //some comments
    var foo = "bar";
</textarea> 
```

您包含 2 个 .js 引用，然后这段 JavaScript 将您的 textarea 元素替换为新的语法高亮元素。

```
<script type="text/javascript">
    var textarea = document.getElementById('someCode');
    var editor = new MirrorFrame(CodeMirror.replace(textarea), {
        height: "350px",
        content: textarea.value,
        parserfile: ["tokenizejavascript.js", "parsejavascript.js"],
        stylesheet: "css/jscolors.css",
        path: "js/",
        autoMatchParens: true
    });
</script> 
```

[CodeMirror 手册有帮助](http://codemirror.net/manual.html)。

还可以考虑[基于 JavaScript 的源代码编辑器比较的 WikiPedia 条目](http://en.wikipedia.org/wiki/Comparison_of_JavaScript-based_source_code_editors)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-18T01:39:17.087

所有这些平台都是完全不同的，每个平台都有自己的渲染显示方法。所以不会有任何通用的控制功能。每个平台都有单独的控件

但是，可以实现 Web 控件并在页面中使用它。那么winforms或者wpf中的浏览器对象就可以使用页面地址来显示了

# c++ - 在哪里可以找到适用于 Windows Mobile 的灵活日志库？

> ID：553503
> 
> 赞同：1
> 
> 时间：2009-02-16T14:45:16.247
> 
> 标签：c++, logging, windows-mobile

任何人都可以建议任何开放和免费的库来登录用 C++ 编写的 Windows Mobile 应用程序吗？

如果它支持记录到文件、系统日志（会很好）和记录级别，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T16:08:13.833

也许您可以查看来自[http://pt-framework.sourceforge.net/](http://pt-framework.sourceforge.net/)的日志记录是否符合您的需要。我不知道是否支持系统日志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T00:45:33.840

据我所知没有。

您很可能必须寻找可用的源代码日志库。Windows Mobile 几乎可以编译大多数 win32 代码而无需或很少更改，因此任何 win32 日志库都应该可以工作。

通常，我会根据自己的喜好构建自己的日志记录代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T19:25:26.457

我目前在我的一个紧凑框架项目中使用 log4net。不过，它可能不适合生产，因为 dll 是 220k！

# sql-server - MSSQL 上标量 UDF 中的 NULL 参数

> ID：553515
> 
> 赞同：8
> 
> 时间：2009-02-16T14:49:53.600
> 
> 标签：sql-server, short-circuiting, user-defined-functions

[如果参数为空，则标量 UDF（请参阅CREATE FUNCTION](http://msdn.microsoft.com/en-us/library/ms186755(SQL.90).aspx) ）的选项“RETURNS NULL ON NULL INPUT”会停止执行函数体并简单地返回 NULL。

也就是说，它短路了。

有谁知道它如何处理多个参数？

将具有多个参数的函数调用短路会很有用，例如第一个参数是否至少为 NULL。

当我有时间时，我将使用分析器来尝试跟踪 udf 调用。我已经搜索过，但找不到任何东西.. 更有可能我没有使用正确的搜索词。

同时，有没有人有任何想法或经验？

也欢迎来自其他 RDBMS 世界的答案。这是一个 ANSI 设置，我在搜索中看到了 DB2 和 MySQL 的结果

编辑，基于评论：仅适用于非 CLR 函数

干杯小号

编辑：我不需要运行探查器。嗬！这演示了以下行为：

```
CREATE FUNCTION dbo.ufnTest (
    @dummy tinyint
)
RETURNS tinyint
WITH RETURNS NULL ON NULL INPUT
AS
BEGIN
    RETURN 1
END
GO
SELECT dbo.ufnTest(0), dbo.ufnTest(NULL)
GO

ALTER FUNCTION dbo.ufnTest (
    @dummy tinyint
)
RETURNS tinyint
--WITH RETURNS NULL ON NULL INPUT
AS
BEGIN
    RETURN 1
END
GO
SELECT dbo.ufnTest(0), dbo.ufnTest(NULL)
GO

ALTER FUNCTION dbo.ufnTest (
    @dummy tinyint,
    @dummy2 tinyint
)
RETURNS tinyint
WITH RETURNS NULL ON NULL INPUT
AS
BEGIN
    RETURN 1
END
GO
SELECT dbo.ufnTest(0, 2), dbo.ufnTest(NULL, 2), dbo.ufnTest(0, NULL)
GO

ALTER FUNCTION dbo.ufnTest (
    @dummy tinyint,
    @dummy2 tinyint
)
RETURNS tinyint
--WITH RETURNS NULL ON NULL INPUT
AS
BEGIN
    RETURN 1
END
GO
SELECT dbo.ufnTest(0, 2), dbo.ufnTest(NULL, 2), dbo.ufnTest(0, NULL)
GO 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-17T10:00:35.877

**是的，如果它的****任何**参数是，指定的函数`RETURNS NULL ON NULL INPUT`将短路。**`NULL`**

 **[文档](http://msdn.microsoft.com/en-us/library/ms186755.aspx)确实建议了这一点，尽管它不清楚并且似乎仅指 CLR 函数。（我认为这是微软试图澄清在中`NULL`指定的行为`CREATE FUNCTION`将覆盖`OnNullCall`CLR 方法上的属性。）

我已经在 SQL2005 和 SQL2008 中使用非 CLR 函数对此进行了测试，它的短路完全符合预期。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T15:06:44.217

> > 有谁知道它如何处理多个参数？

您的链接中的解释是否足够，或者您是否正在寻找不同的方法？

> 如果在 CLR 函数中指定了 RETURNS NULL ON NULL INPUT，则表明当它接收的**任何**参数为 NULL 时，SQL Server 可以返回 NULL，而无需实际调用函数体

# .net - Winforms 风格/UI 外观和感觉提示

> ID：553518
> 
> 赞同：8
> 
> 时间：2009-02-16T14:50:23.520
> 
> 标签：.net, winforms, user-interface

从多年的 asp.net 开发回到 winforms 应用程序。

寻找有关如何“样式化”winform 的建议和技巧，类似于我在 asp.net 中使用 CSS/母版页的方式。

我对如何在一个地方更新某些类型的控件的字体/颜色感兴趣。如何保持布局的一致性。

任何指针/文章表示赞赏。

仅供参考...WPF 不是该项目的选项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T15:11:00.273

您可以创建所需的不同标准控件的自定义版本，从原始版本继承，但将自定义样式应用于自定义版本。这将为您提供一个更改组件类型样式的单一位置。您还可以让每个控件将样式对象作为系统范围样式的参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T15:23:20.900

除非您正在创建某种步行信息亭应用程序，否则我建议您不要在应用程序中乱用 Windows 通用控件的外观。

对于桌面应用程序而言，与其他 Windows 应用程序的一致性通常被认为比任何设计奇思妙想都更重要。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T15:42:14.753

自定义控件是实现此目的的典型方式。如果您有一个想要反复使用的标签控件，请从它继承并设置您自己的属性。

虽然它可能看起来有点乏味，但它确实是使用 WinForms 的最佳方式。WinForms 不是为此而设计的，就像 WPF 一样。

希望有帮助！

# silverlight - 为什么silverlight中的双向绑定不起作用？

> ID：553521
> 
> 赞同：2
> 
> 时间：2009-02-16T14:51:05.390
> 
> 标签：silverlight, data-binding, two-way-binding

根据 Silverlight TwoWay 绑定的工作原理，当我更改 FirstName 字段中的数据时，它应该更改 CheckFirstName 字段中的值。

为什么不是这样？

## 回答：

谢谢杰夫，对其他人来说就是这样：这是[带有可下载代码的完整解决方案](http://tanguay.info/web/index.php?pg=codeExamples&id=61)。

XAML：

```
<StackPanel>
    <Grid x:Name="GridCustomerDetails">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="300"/>
        </Grid.ColumnDefinitions>

        <TextBlock VerticalAlignment="Center" Margin="10" Grid.Row="0" Grid.Column="0">First Name:</TextBlock>
        <TextBox Margin="10" Grid.Row="0" Grid.Column="1" Text="{Binding FirstName, Mode=TwoWay}"/>

        <TextBlock VerticalAlignment="Center" Margin="10" Grid.Row="1" Grid.Column="0">Last Name:</TextBlock>
        <TextBox Margin="10" Grid.Row="1" Grid.Column="1" Text="{Binding LastName}"/>

        <TextBlock VerticalAlignment="Center" Margin="10" Grid.Row="2" Grid.Column="0">Address:</TextBlock>
        <TextBox Margin="10" Grid.Row="2" Grid.Column="1" Text="{Binding Address}"/>

    </Grid>

    <Border Background="Tan" Margin="10">
        <TextBlock x:Name="CheckFirstName"/>
    </Border>

</StackPanel> 
```

后面的代码：

```
public Page()
{
    InitializeComponent();

    Customer customer = new Customer();
    customer.FirstName = "Jim";
    customer.LastName = "Taylor";
    customer.Address = "72384 South Northern Blvd.";

    GridCustomerDetails.DataContext = customer;

    Customer customerOutput = (Customer)GridCustomerDetails.DataContext;
    CheckFirstName.Text = customer.FirstName;

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T15:21:09.063

您的`Customer`类型必须支持[`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged(VS.95).aspx)才能让绑定知道您的`FirstName`属性值何时更改。

本[教程](http://www.silverlight.net/learn/data-networking/binding/silverlight-data-binding)可以帮助您使代码正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-02T08:53:46.620

解决方案是使用元素绑定`CheckFirstName`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-20T14:49:26.850

Grid 容器内的控件不知道 FirstName、LastName 和 Address 是什么。我认为您需要将网格绑定到代码隐藏中的对象：

```
<Grid x:Name="GridCustomerDetails" DataContext="Customer"> 
```

现在，该容器内的每个控件都可以绑定到 Customer 的属性。你像这样绑定它：

```
<TextBox Margin="10" Grid.Row="0" Grid.Column="1" 
         Text="{Binding Path=FirstName, Mode=TwoWay}"/> 
```

在您后面的代码中，确保“客户”是一个类对象，并且是公开声明的。

如果这不起作用，请尝试在顶部的页面声明和命名空间中添加 x:Name=""。

我希望这有帮助！

# cross-browser - 使用 YUI 浏览器历史类的 Ajax 和浏览器历史

> ID：553527
> 
> 赞同：0
> 
> 时间：2009-02-16T14:52:23.720
> 
> 标签：cross-browser, extjs, yui, browser-history

我有一个 Ajax 丰富的应用程序，它显示一个包含 100 个 url 的网格。当您单击网格的任何行时，它会在网格中加载该 URL 的预览。同样在网格的 onload 事件上，我执行了几个触发许多 AJAX 查询的操作。

我使用 YUI 浏览器历史记录类来启用浏览器后退按钮。它适用于 FF3，但在 Safari 中，整个页面似乎“有时”会重新加载。同样在 IE 中，浏览器会干扰我的 iframe。

此外，如果我复制粘贴 URL，我不会得到预期的状态。即#token中定义的那个

这些是已知问题还是我犯了错误？

当涉及许多状态更改时，启用浏览器以进行操作是否是个好主意？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-18T15:39:43.790

如果你有能力，我会改用 Ext 2.2 的新 History 对象而不是 YUI。我认为您可能会获得更好的跨浏览器支持。

尽管可能很麻烦，但我肯定会认为状态管理很重要，以避免用户使用后退按钮时出现问题。

# visual-studio-2005 - 如何从 RDLC 报告的文件中加载字体？

> ID：553533
> 
> 赞同：4
> 
> 时间：2009-02-16T14:54:58.423
> 
> 标签：visual-studio-2005, .net-2.0, fonts, rdlc

在 Visual Studio 2005 中，如何从文件加载字体并将其用于 RDLC 报告？

由于[这个](https://stackoverflow.com/questions/544972/load-fonts-from-file-on-a-c-application)问题，我知道如何从文件中加载字体，但我无法在 RDLC 报告中使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-17T00:01:49.763

如果您只需要一个或两个标题或条形码列的字体，那么您可以在图像类型的数据集上创建一个列，并将图像预先制作为位图的文本

```
// From dreaming in code
/// <summary>
/// Function for converting text to a Bitmap object
/// </summary>
/// <param name="width">Width of the image</param>
/// <param name="height">Height of the image</param>
/// <param name="str">String to be converted</param>
/// <param name="textColor">Color we want the text</param>
/// <param name="recColor">Color we want the background</param>
/// <param name="f">Name of the font we want used</param>
/// <returns></returns>
/// <remarks></remarks>
public Bitmap ConvertTextToBitmap(ref int width, ref int height, ref string str, ref Color textColor, ref Brush recColor, ref string fontName)
{
    using (Bitmap bmp = new Bitmap(width, height)) 
    {
        using (Graphics gfx = Graphics.FromImage((Image)bmp)) 
        {
            gfx.SmoothingMode = SmoothingMode.AntiAlias;
            Font font = new Font(fontName, 11, FontStyle.Regular, GraphicsUnit.Pixel);
            gfx.FillRectangle(Brushes.Transparent, new Rectangle(0, 0, bmp.Width, bmp.Height));
            gfx.FillRectangle(recColor, 0, 0, width, height);
            gfx.DrawString(str, font, new SolidBrush(textColor), 2, 3);
            bmp.Save(Application.StartupPath + "\\" + str + ".bmp", ImageFormat.Bmp);
            return bmp;
        }
    }
} 
```

您还可以制作自定义报告项来替换默认文本框等，但从所有经验来看，这些都是一个大 PITA

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T23:22:59.363

似乎唯一的方法是在 Windows 上安装字体并像系统上可用的任何其他字体一样使用它。

# programming-languages - 使困惑。OO 本质上是命令式的还是多范式？

> ID：553536
> 
> 赞同：3
> 
> 时间：2009-02-16T14:56:07.190
> 
> 标签：programming-languages, paradigms

当我通读 stackoverflow 的答案和问题时，我得到的印象是 OO 被划分为本质上是必要的。

但是，OO 不只是一种将代码和数据划分为现实世界对象的方法吗？

如果是这样，为什么要放弃其他较低级别的范例来在这样的平台上工作？

IOW，默认情况下不可变的基于对象的泛型类型系统将是功能性第一语言的工作方式，默认情况下可变的基于对象的泛型类型系统将是命令式语言的世界。

还是我完全错过了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-16T15:07:03.573

**没有**。OO 和命令式是两个正交的概念。

例如：

*   Common Lisp 对象系统是 Lisp OO 的一个例子，可能是最复杂的对象系统。
*   OCaml 是一种具有对象系统和支持面向对象组织的模块系统的函数式语言
*   Scala 是一种函数式语言，具有非常灵活的 OO 系统
*   Haskell 允许您使用更高种类的多态性编写面向对象的代码

面向对象有很多不同的方法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T14:59:35.013

大多数 OO 语言都是命令式的，但您*可以*以某种函数式风格使用它们。一些函数式语言位于 OO 框架之上（.NET 上的 F# 是最明显的例子）权衡一些“纯度”，以便在适当的情况下使用一个庞大的框架。

我认为“主要是面向对象”的语言还有*很大*的空间可以做更多的事情来帮助以函数式编程方式进行编程——更好地支持不变性是最明显的特性，可能其次是更好的类型推断。（至少在谈到 C# 时，这可能是传统语言试图涉足函数式大门的最重要的例子。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-16T15:15:49.577

**是的。**面向对象是一种编程风格，它允许程序员将程序表示为一组有状态的对象，这些对象进行操作和交互（通常通过动态类型语言中的消息传递和静态类型语言中的方法调用），并以特定的顺序进行。

状态、动作和序列是过程编程中的概念，在非单子函数式编程中不存在（单子用于在纯函数式语言 Haskell 中实现状态、动作和序列，否则不会有这些概念）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T15:20:14.527

从不同的角度来看，大多数人喜欢命令式思考（而不是递归或 RPN）。由此可见，大多数语言都是命令式的。

当然，使用非命令式方法（例如用户界面）来表达（或解决）许多问题要简单得多，但大多数人对这种方法并不感到满意。有些人不喜欢离开人迹罕至的道路，而另一些人则确实很难进行必要的心理改变以从这方面解决问题（考虑方法调用和递归而不是变量和循环）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-01T11:09:06.117

我仍然坚信面向对象本质上是一个必要的概念。但是，由于 [最近的一个问题](https://stackoverflow.com/questions/4854774/c0x-as-functional-language)让我对编程范式进行了更多思考，所以我整理了一个更全面的答案，这有点离题，但顺便也回答了你的问题：

两种主要的编程范式是*声明范式*，程序员写下抽象关系（从而告诉编译器他想要*什么*）和*命令式范式*，程序员写下算法（从而告诉计算机*如何*得到他想要的东西） .

范式与先验的语言无关——它更多地是关于您如何思考和构建程序的一种方式。但是，一种语言使用范式的容易程度存在差异：语言语义和语法导致了一种惯用的代码编写方式。

声明性语言的一个例子是 Prolog，命令式语言的一个例子是 Fortran（*Real Programmer 可以用任何语言编写 FORTRAN 程序*）。

作为同时具有命令性和声明性的代码示例，请考虑 Perl6 中斐波那契序列的以下实现：

```
my @fibonacci-sequence := 0, 1, * + * ... *; 
```

这显然是对序列的声明性描述。然而，作为`*`有效`...`的 Perl6 运算符——whatever-star 可用于创建 lambda 表达式，序列运算符用于创建惰性列表——它也是调用运行时固有代码的命令式语句。

让我们考虑一些其他的编程范式，特别是函数式和面向对象的编程。

*函数范式*本质上是声明性的，因为它将计算建模为集合之间的关系。

*面向对象范式*本质上是命令式的，因为它将计算建模为有状态对象之间的通信，称为消息传递。

有些语言是纯粹的，这意味着所有计算都符合范式。例如，Haskell 是一种纯函数式语言，Smalltalk 是一种纯面向对象的语言。

但是，这并不意味着函数式语言相应。面向对象语言阻止命令式响应。声明式编程。在实践中，你经常使用命令式的函数——你输入一个输入值来得到一个输出值。面向对象的编程正好相反：对象接受的一组消息声明了它的接口。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T17:48:16.480

*有些人不同意 OO 是一个必要的概念，所以这是我的推理。*

面向对象要点：

1.  对象保持状态（即对其他对象的引用）
2.  对象接收（和处理）消息
3.  处理消息可能会导致
    *   发送到对象本身或其他对象的消息
    *   对象状态的变化

这意味着 oo 编程需要*object(!) 持有的*可变状态。如果您通过创建一系列对象来模拟状态变化，那么您就是在破坏这些不变量，就这么简单。

*Flamebait：*如果您不同意这种面向对象的定义，请与 Alan Kay 一起讨论。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-21T10:01:13.387

许多不同的概念促成了面向对象编程的概念。[维基百科](http://en.wikipedia.org/wiki/Object-oriented_programming)列出了其中的大部分。

我将通过使用[Objects with Behaviors](http://en.wikipedia.org/wiki/Object_%28computer_science%29)来描述 OOP 的本质。

维基百科通过以下三个属性来描述**对象：**

1.  **身份**：一个对象区别于其他对象的属性
2.  **State**：描述存储在对象中的数据
3.  **行为**：描述对象接口中可以使用对象的方法

很多面向对象的语言都有类的概念，但实际上也有像 JavaScript 这样[的基于原型的语言。](http://en.wikipedia.org/wiki/Prototype-based_programming)

函数式语言也可以使用类（例如 Haskell 中的类型类）。但是仅仅因为它们有类并不意味着它们是面向对象的或允许面向对象的编程。以 Haskell 为例：你甚至没有对象！没有“身份”这样的概念！您所能做的就是编写纯函数！

仅仅因为有人使用了一个名为“类”的术语，这并不意味着他们正在做面向对象的编程！

OOP 是关于具有行为的有状态对象。尽管对象的行为不必修改该对象，因为可以创建新对象，但您将完全放弃对对象的需求。您将不再需要身份，因为对一个对象的更改是否由对同一对象的其他引用反映并不重要，因为不再有任何更改。您所需要的只是用于数据隐藏和封装的值（没有身份）和模块和/或类。

所以**是**的，命令式编程是 OOP 所固有的。

# iphone - 子类化 iPhone 的 UIControls

> ID：553539
> 
> 赞同：0
> 
> 时间：2009-02-16T14:56:38.717
> 
> 标签：iphone, uicontrol

通过哪些方法可以扩展 UIControl 属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-01T08:07:26.073

这应该有助于事情发展：
[https ://developer.apple.com/documentation/uikit/uicontrol#1968627](https://developer.apple.com/documentation/uikit/uicontrol#1968627)

> 覆盖`sendAction(_:to:for:)`现有子类的方法以观察或修改动作方法对控件关联目标的调度
> 
> 覆盖`beginTracking(_:with:)`、`continueTracking(_:with:)`、`endTracking(_:with:)`和`cancelTracking(with:)`方法以跟踪控件中发生的触摸事件。

# c# - 如何创建重复的允许属性

> ID：553540
> 
> 赞同：107
> 
> 时间：2009-02-16T14:57:01.650
> 
> 标签：c#, attributes

我正在使用从属性类继承的自定义属性。我这样使用它：

```
[MyCustomAttribute("CONTROL")]
[MyCustomAttribute("ALT")]
[MyCustomAttribute("SHIFT")]
[MyCustomAttribute("D")]
public void setColor()
{

} 
```

但是会显示“重复的 'MyCustomAttribute' 属性”错误。
如何创建重复的允许属性？

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2009-02-16T14:59:36.120

将一个`AttributeUsage`属性粘贴到您的 Attribute 类上（是的，这很拗口）并设置`AllowMultiple`为`true`：

```
[AttributeUsage(AttributeTargets.Method, AllowMultiple = true)]
public sealed class MyCustomAttribute: Attribute 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-16T15:00:36.180

AttributeUsageAttribute ;-p

```
[AttributeUsage(AttributeTargets.Method, AllowMultiple = true)]
public class MyAttribute : Attribute
{} 
```

但是请注意，如果您使用 ComponentModel ( `TypeDescriptor`)，则每个成员仅支持一个属性实例（每个属性类型）；原始反射支持任意数量...

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-09-02T04:07:34.310

[Anton 的解决方案](https://stackoverflow.com/questions/553540/how-to-create-duplicate-allowed-attribute/553551#553551)是正确的，但还有[另一个问题](https://stackoverflow.com/questions/848669/allowmultiple-does-not-work-with-property-attributes/1365669#1365669)。

简而言之，除非您的自定义属性覆盖 TypeId，否则通过它访问它`PropertyDescriptor.GetCustomAttributes()`只会返回您的属性的单个实例。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-03-03T09:37:34.960

默认情况下，`Attribute`s 仅限于对单个字段/属性/等应用一次。您可以从[MSDN](https://msdn.microsoft.com/en-us/library/system.attribute(v=vs.110).aspx#Syntax)[上的类定义中`Attribute`](https://msdn.microsoft.com/en-us/library/system.attribute(v=vs.110).aspx#Syntax)看到这一点：

```
[AttributeUsageAttribute(..., AllowMultiple = false)]
public abstract class Attribute : _Attribute 
```

因此，正如其他人所指出的，所有子类都以相同的方式受到限制，如果您需要同一属性的多个实例，则需要显式设置`AllowMultiple`为`true`：

```
[AttributeUsage(..., AllowMultiple = true)]
public class MyCustomAttribute : Attribute 
```

在允许多次使用的属性上，[您还应该覆盖该`TypeId`属性](https://msdn.microsoft.com/en-us/library/6w3a7b50(v=vs.110).aspx#Remarks)以确保诸如此类的属性[`PropertyDescriptor.Attributes`](https://msdn.microsoft.com/en-us/library/system.componentmodel.memberdescriptor.attributes(v=vs.110).aspx) 按预期工作。最简单的方法是实现该属性以返回属性实例本身：

```
[AttributeUsage(..., AllowMultiple = true)]
public class MyCustomAttribute : Attribute
{
    public override object TypeId
    {
        get
        {
            return this;
        }
    }
} 
```

（发布这个答案不是因为其他人错了，而是因为这是一个更全面/规范的答案。）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-09-18T13:39:52.730

添加 AttributeUsage 后，请确保将此属性添加到 Attribute 类

```
public override object TypeId
{
  get
  {
    return this;
  }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-16T15:09:58.873

作为替代方案，请考虑重新设计您的属性以允许序列。

```
[MyCustomAttribute(Sequence="CONTROL,ALT,SHIFT,D")] 
```

或者

```
[MyCustomAttribute("CONTROL-ALT-SHIFT-D")] 
```

然后解析值以配置您的属性。

有关此示例，请查看[www.codeplex.com/aspnet](http://www.codeplex.com/aspnet)上 ASP.NET MVC 源代码中的 AuthorizeAttribute 。

# c++ - 我可以在 C++ 中嵌套 try-catch 块吗？

> ID：553543
> 
> 赞同：23
> 
> 时间：2009-02-16T14:57:24.317
> 
> 标签：c++, exception, nested

我可以嵌套 try-catch 块吗？例如：

```
 void f()
{
    try
    {
        //Some code 
        try
        {
             //Some code 
        }
        catch(ExceptionA a)
        {
            //Some specific exception handling
        }
        //Some code
    }
    catch(...)
    {
        //Some exception handling
    }
}//f 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-16T15:01:27.550

是的，完全合法。

虽然最好将内部方法移到另一种方法中，这样它看起来更干净，而且您的方法更小

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-16T15:09:06.860

如前所述，这是可能的，但是您必须在其中看到“失败”方案。如果在第一个 try-catch-block 中捕获了您的异常，则它不会被外部 catch-block 捕获。但是，如果它没有被内部 catch 块捕获，它将尝试在外部 catch 块中找到匹配的异常处理程序。

您还可以通过`throw;`在内部异常处理程序中使用，将异常进一步明确地引发到下一个异常处理程序。

例如这段代码：

```
try
{
    try
    {
        throw std::runtime_error("Test");
    }
    catch (std::runtime_error& e)
    {
        std::cerr << "Inner Exception-Handler: " << e.what() << std::endl;
        throw;
    }
}
catch (std::exception& e)
{
    std::cerr << "Outer Exception-Handler: " << e.what() << std::endl;
}
```

将导致：

```
内部异常处理程序：测试
外部异常处理程序：测试
```

这是有效的，因为[std::runtime_error 派生自 std::exception](http://cplusplus.com/reference/std/stdexcept/runtime_error.html)。您还应该注意，在这样一个简单的示例中，也可以将 catch 块一个接一个地编写，但是如果您想在第一个 catch 块之后执行其他代码，则必须嵌套它们。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-16T15:25:33.123

是的，这是合法的。正如[ouster](https://stackoverflow.com/questions/553543/can-i-have-nested-try-catch-blocks-in-c/553559#553559)所说，处理它的一种方法是将内部 try-catch 块放在它自己的函数中，并从外部 try-catch 块中调用该函数。

另一种处理它的方法是使用多个 catch 块。

```
void f()
{
    try
    {
        //Some code that throws ExceptionA
        //Some code that throws ExceptionB
    }
    catch(ExceptionA ea)
    {
        //Some exception handling
    }
    catch(ExceptionB eb)
    {
        //Some exception handling
    }
}//f 
```

这里要注意的是 catch 块中异常类型的特殊性。如果 ExceptionB 在上面的示例中扩展了 ExceptionA，那么 ExceptionB 块将永远不会被调用，因为任何被抛出的 ExceptionB 都将由 ExceptionA 块处理。在处理异常类层次结构时，您必须以最具体到最不具体的顺序对 catch 块进行排序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T15:00:25.197

是的你可以。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T15:23:12.193

它是合法的，但除非你从你的内部 catch() 中抛出一个异常，否则它并不是那么有用。例如，您可能想要捕获系统级异常，但为了代码清晰而抛出您自己的异常对象。

# c# - 在 Windows 应用程序中存储登录信息

> ID：553544
> 
> 赞同：2
> 
> 时间：2009-02-16T14:57:57.903
> 
> 标签：c#, winforms, session, login

在 web 应用程序中，用户登录信息通常存储在会话中，但是 windows 应用程序呢？使用单例是正确的做法吗？我应该只使用静态属性吗？

假设我将登录信息存储在静态属性 ApplicationController 中。登录用户。当用户成功登录时，将设置该属性。在成功登录之前，LoggedInUser 返回 null。然后，当从我的 OrderListPresenter 类调用示例 OrdersService 时，我使用 LoggedInUser 作为参数。

```
var service = new OrdersService();
var orderCollection = service.GetOrdersByUserID(
    ApplicationController.LoggedInUser.ID); 
```

好的，这可行，但它也使编写单元测试更加困难。我不喜欢使用单元测试中的单例/静态成员。

也许我可以将 ApplicationController 注入每个需要访问登录用户的类？还有其他想法吗？

您认为处理此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T15:04:18.963

我将创建一个包含 CurrentUser 字段的 CurrentContext 对象并将其传递给我的所有演示者。

[避免使用单例](http://misko.hevery.com/2008/08/17/singletons-are-pathological-liars/)，这可能会给单元测试带来问题，或者如果您决定稍后扩展您的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T14:59:54.200

注射是一个很好的答案。您可能会发现其他有用的东西放入 . 中`ApplicationController`，并且它使单元测试变得容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T03:44:08.840

根据您希望对用户身份执行的操作，考虑将其放入 System.Threading.Thread.CurrentPrincipal。如果您的应用程序具有 SecurityPermissionFlag.ControlPrincipal 权限，则只需设置 CurrentPrincipal 即可。另请注意，System.Environment.UserName 具有登录的 Windows 用户身份。

当内置类型已经存在并且执行您想要的（或接近）时，滚动您自己的类型总是有成本的。

# oop - 您将如何设计 OO 类来处理密码系统及其密钥

> ID：553545
> 
> 赞同：0
> 
> 时间：2009-02-16T14:58:07.807
> 
> 标签：oop, encryption, cryptography, key

这是一个比我[之前](https://stackoverflow.com/questions/495172/straddling-checkboard-algorithm-improvement)的问题更广泛但相关的问题。

我想在 Ruby 中实现老式的加密系统，例如[ADFGVX](http://en.wikipedia.org/wiki/ADFGVX)、[VIC 密码](http://en.wikipedia.org/wiki/VIC_cipher)等，主要是为了好玩。这些密码系统建立在更通用的系统之上，如替换（单字母，如 Caesar 或多字母，如 Vigenere）和转置（简单，双）。我的问题实际上是如何创建类层次结构来处理密码系统和密钥。

像 Vigenere < Substitution < SimpleCipher 之类的东西？钥匙呢？一些替换键在使用前被压缩（“ARABESQUE”变成“ARBESQU”），而大多数转置键没有，依此类推。

现在，我有一个非常基本的[设计文档](http://dev.keltia.net/projects/old-crypto/repository/entry/DESIGN.txt)（我说*basic*），我想了想，我似乎找不到令人满意的方法，所以我来这里是为了你的智慧。

实现将在 Ruby 中进行，但除非设计必须使用多重继承，否则它与 Ruby 本身无关。

[Mercurial 中的](http://dev.keltia.net/projects/old-crypto/repository)概念证明（尚未可运行且可能错误）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T15:35:42.693

想想类签名。每个加密算法都有两种方法，`encrypt()`和`decrypt()`，并且您必须考虑块密码和流密码（即，许多算法需要固定大小的块中的数据。）

但是，一旦您低于该级别，这些方法将看起来完全不同，并且在该级别上没有很多共享行为。

所以我怀疑你想要的是更多的模块或混合结构，而不是继承。仅仅因为您有分类法，并不意味着分类法应该是继承层次结构。

关于这类事情有很多很好的讨论；找谈是否`Ostrich < Bird`。看，鸟`fly()`……除了鸵鸟。

# java - 有没有办法获取在 JVM 中运行的所有 Spring 应用程序上下文的列表？

> ID：553546
> 
> 赞同：7
> 
> 时间：2009-02-16T14:58:14.627
> 
> 标签：java, spring, servlets

我希望能够从我的 servlet 容器中运行的 Web 应用程序中获取所有 Spring 应用程序上下文的列表。这样我就可以重新初始化上下文，而无需重新启动或重新加载我的容器或 web 应用程序。

这可能吗？如果是这样，怎么做？无论如何，是否可以通过 Servlet API 获取在 servlet 容器实例上运行的所有 servlet 上下文的列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T15:37:57.137

否 - 两个问题。

访问所有 servlet 上下文将是一个安全问题。您将能够检查和/或操作其他网络应用程序。唯一知道所有 servlet 上下文的是容器本身。但这是内部实现，没有api。

Spring 上下文访问是类似的，但是如果您指的是一个 web 应用程序中的所有 Spring 上下文，它们将创建一个层次结构 - 例如那些用于控制器的层次结构。在根 spring 上下文中实现一个`org.springframework.context.ApplicationListener`as bean（由 中`org.springframework.web.context.ContextLoaderListener`配置的初始化`web.xml`）可以通知您有关上下文启动、停止、关闭或刷新的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T15:41:12.807

**[编辑：这并没有真正的帮助，因为每个 web.xml 都必须有相同的监听器]**

您可以让[ServletContextAttributeListener](http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletContextAttributeListener.html)监听标准[WebApplicationContext](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/web/context/WebApplicationContext.html#ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE)属性的插入，然后通知一些集中式监视器？

未测试：

```
public class SpringWACListener implements ServletContextAttributeListener {
    public void attributeAdded(ServletContextAttributeEvent scab) {
        if (WebApplicationContext.
            ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE.
            equals(scab.getName()) {
            myCentralisedMonitor.notify("added");
        }
    }
    // same for others
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T01:48:07.193

你可以试试 Spring Application Management Suite

[http://www.springsource.com/products/ams](http://www.springsource.com/products/ams)

虽然不知道所涉及的成本是多少，但无法想象它很便宜。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T15:16:50.027

曾经有，它被称为 [getServlets]( [http://java.sun.com/products/servlet/2.2/javadoc/javax/servlet/ServletContext.html#getServlet(java.lang.String))](http://java.sun.com/products/servlet/2.2/javadoc/javax/servlet/ServletContext.html#getServlet(java.lang.String)))；但是，它现在已被弃用，没有替代方法，这意味着拥有这样的方法可能会使实施规范变得过于繁琐。从规范的JavaDoc：

> 获取Servlet
> 
> 公共 java.util.Enumeration getServlets()
> 
> 已弃用。从 Java Servlet API 2.0 开始，没有替代品。
> 
> 此方法最初定义为返回此 servlet 上下文已知的所有 servlet 的枚举。在此版本中，此方法始终返回一个空枚举，并且仅保留二进制兼容性。此方法将在 Java Servlet API 的未来版本中永久删除。

您的容器可能会实现类似的方法，但它将是非标准的，您必须深入研究它的文档或告诉我们您正在使用哪个容器。

# visual-studio - Visual Studio 规范化不一致的行尾是什么意思？

> ID：553548
> 
> 赞同：265
> 
> 时间：2009-02-16T14:59:05.123
> 
> 标签：visual-studio, line-endings

Visual Studio 偶尔会告诉我：

> 以下文件中的行尾不一致。你想规范化行尾吗？

然后它给了我一个带有不同标准或其他东西的下拉列表，例如 Windows、Mac、Unix 和几个 Unicode 标准。

这是什么意思，如果我点击会发生什么`Yes`？

* * *

## 回答 #1

> 赞同：233
> 
> 时间：2009-02-16T15:02:03.400

这通常意味着您的行以回车/换行对以外的内容结尾。当您从网页复制并粘贴到代码编辑器中时，通常会发生这种情况。

规范化行尾只是确保所有行尾字符都是一致的。它可以防止一行以 or 结尾`\r\n`而另一行以`\r`or结尾`\n`；第一个是 Windows 线端对，而其他通常用于 Mac 或 Linux 文件。

由于您在 Visual Studio 中进行开发，因此您显然希望从下拉列表中选择“Windows”。:-)

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2009-02-16T15:02:48.453

有些行以`\n`.

其他一些行以 . 结尾`\r\n`。

Visual Studio 建议您使所有行的结尾都相同。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2011-02-12T02:33:05.573

如果您使用的是 Visual Studio 2012：

转到菜单*文件*→*高级保存选项*→ 选择*行尾*类型为*Windows (CR LF)*。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2017-04-10T14:40:35.563

要打开/关闭该选项，请从*菜单*栏中执行以下步骤：

*工具*→*选项*→*环境*→*文档*→*检查加载时是否一致的行尾*

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-02-16T15:05:07.900

您正在编辑的文件已使用其他不使用相同行尾的编辑器进行编辑，从而导致文件具有混合行尾。

用于行尾的 ASCII 字符是：

CR、回车
LF、换行

Windows = CRLF
Mac OS 9 或更早版本 = CR
Unix = LF

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-16T15:05:23.157

维基百科[换行文章](http://en.wikipedia.org/wiki/Newline#Common_problems)可能会对您有所帮助。这是一段摘录：

> 不同的换行约定通常会导致在不同类型的系统之间传输的文本文件显示不正确。例如，源自 Unix 或 Apple Macintosh 系统的文件在 Microsoft Windows 上运行的某些程序上可能显示为单行长。相反，当在 Unix 系统上查看源自 Windows 计算机的文件时，额外的 CR 可能显示为 ^M 或在每行的末尾或作为第二个换行符。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-16T15:05:33.157

这意味着，例如，您的某些文本行以 a `<Carriage Return><Linefeed>`（Windows 标准）结尾，而有些`<Linefeed>`则仅以 a 结尾（Unix 标准）。

如果您单击“是”，这些源文件中的行尾将被转换为具有所有相同的格式。

这不会对编译器产生任何影响（因为行尾仅算作空格），但它可能会对其他工具产生一些影响（例如，版本控制系统上的“差异”）。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-10-12T00:44:28.577

当您从网络复制粘贴某些内容时，您可能会得到不一致的行尾。
为了解决这个问题，您可以使用 Visual Studio 扩展“行尾统一器”，它可以在保存文件时自动使行尾一致。

[![在此处输入图像描述](https://i.stack.imgur.com/7f2DN.png)](https://i.stack.imgur.com/7f2DN.png)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-09-22T23:10:00.057

这不仅仅是 Visual Studio ......它是任何读取文件、编译器、链接器等的工具都必须能够处理它。

通常（对于软件开发）我们接受多平台行尾问题，但让版本控制软件处理它。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2020-07-24T12:11:53.117

**行尾**也称为**换行符**、**行尾 (EOL)**或**换行符**，是字符编码规范（例如 ASCII 或 EBCDIC）中的控制字符或控制字符序列，用于表示一行文本的结束和开始一个新的。**当您按下Enter 键**时，一些文本编辑器会设置/实现此特殊字符。

**回车**、换**行**字符是行尾 ( **EOL** )的ASCII 表示。他们将结束一个字符串的当前行，并开始一个新的。

但是，在操作系统级别，它们的处理方式不同：

*   **回车 ("CR") 字符 (ASCII 13\0x0D, \r)**：将光标移动到行首而不前进到下一行。此字符在 Commodore 和早期 Macintosh 操作系统（Mac OS 9 和更早版本）中用作换行符。

*   **换行符 ("LF") 字符 (ASCII 10\0x0A, \n)**：将光标向下移动到下一行，而不返回到行首。此字符在基于 Unix 的系统（Linux、macOS X、Android 等）中用作换行符。

*   **回车换行 ("CRLF") 字符 (0x0D0A, \r\n)**：这实际上是两个 ASCII 字符，是 CR 和 LF 字符的组合。它将光标向下移动到下一行和该行的开头。此字符在大多数其他非 Unix 操作系统（包括 Microsoft Windows 和 Symbian OS）中用作换行符。

在 Visual Studio 中规范化不一致的行尾意味着选择一种字符类型用于所有文件。它可能是：

*   **回车换行 ("CRLF") 字符**
*   **换行（“LF”）字符**
*   **回车 ("CR") 字符**

但是，您可以使用根目录中的文件以更好的方式进行设置，`.gitattributes`以避免将文件从一个操作系统移动到另一个操作系统时发生冲突。

`.gitattributes`只需在应用程序的根目录中创建一个名为的新文件：

```
touch .gitattributes 
```

并在其中添加以下内容：

```
# Enforce Unix newlines
* text=auto eol=lf 
```

这会强制使用 Unix**换行符换行符**。

**注意**：如果这是一个已经存在的项目，只需运行此命令以使用新定义的行结尾更新应用程序的文件，如`.gitattributes`.

```
git rm --cached -r .
git reset --hard 
```

就这样。

**我希望这有帮助**

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-08-17T15:57:49.450

Visual Studio 2008 有一个加载项，可在保存文件时转换行尾格式。你可以在这里下载：http: [//grebulon.com/software/stripem.php](http://grebulon.com/software/stripem.php)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-05-21T18:34:53.800

我在 VS 2019 中遇到了这个问题，并通过在为 Unix 设置之前为 Windows 设置 LineBreak 配置来解决它。

`Tools > Options > Format on Save > Settings > LineBreak: Windows`

# database-design - 数据库中的计算字段与复杂查询（使用 JPA）

> ID：553576
> 
> 赞同：1
> 
> 时间：2009-02-16T15:05:12.550
> 
> 标签：database-design, jpa

我们有一个库存控制系统，可以管理某些物品进出业务或给定位置的流动。我们在数据库中有记录，代表库存的移动以及入库和出库。

如果您将所有入库交货相加，然后将出库交货相加，然后从另一个中减去一个，您就有了当前的库存水平。要查找给定位置的当前数量，您还必须包含移动记录。

这显然会导致一些非常复杂的查询，只是为了获取当前的库存水平。比这更糟糕的是，我们使用的 JPA 无法在 QL 中处理所有这些，因此我们最终不得不使用本机查询或查询大型结果集并在应用程序中处理结果。

显然，添加数量字段会使生活更轻松，但在技术上是多余的，并且必须针对每次库存变动进行更新。

你会走哪条路？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T15:55:53.567

我假设您已经对数据库结构进行了相当多的规范化，因此您没有多余的列，因此质疑是否需要将看似多余的数据添加回设计中。

我倾向于添加数量列*，前提*是您可以确保当本地库存水平发生变化时，该列中的数据可以保持一致，无论是通过数据库中的触发器还是应用程序中的附加代码来处理这个问题。指定确保一致性所需的工作，如果它的影响看起来仍然小于运行您正在考虑作为替代方案的潜在大型查询，并且您可以通过类似的努力来实现它们（并可能获得性能优势，如好），我很想添加列和必要的代码以确保其一致性。

我在这里可以看到的危险（这就是为什么我说我倾向于添加该列并且没有说“Nike”）是确保数据一致性所需的努力可能比人们想象的要高，你最终会三个月后的实施和数据一致性问题半生不熟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T16:07:57.547

有几个想法需要考虑：

### 有 StockLevel 实体吗？

显然，我不知道您当前的域模型/表是什么样的，但也许您可以拥有一个 StockLevel 实体：

```
// annotations not shown
public class StockLevel {
    private Item item;  // unidirectional one-to-one?
    private int inbound;
    private int outbound;
    public int getInbound ...
    public int getOutbound ...
    public int getLevel ... // derived from other two
    // setters
} 
```

您是否需要确保 StockLevel 实体始终在与库存变动相同的事务中更新？然而，这些 StockLevel 可能会成为争论的根源。

### 使用特定于数据库的解决方案

您可以考虑使用数据库触发器来防止需要不断地重新计算相同的数字。

您还可以使用存储过程来隐藏数据库如何从调用者那里计算库存水平。因此，您可以先将查询移至 SP，然后在维护相同应用程序代码的同时研究其他方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T16:11:28.757

这是计算列的理想选择。您可以获得数量列的好处，而不必担心必须与其他字段保持同步。

# c# - LINQ 查询毫无例外地跳过。为什么？

> ID：553587
> 
> 赞同：1
> 
> 时间：2009-02-16T15:08:18.830
> 
> 标签：c#, .net, linq, lambda

我有一个获取嵌套数组作为参数的方法：

```
Number[][] data 
```

其中 Number 是我非常简单的类，它继承自 INotifyPropertyChange。

然后我有这样的声明：

```
double[] max = (double[])data.Select(crArray => crArray.Select( cr => cr.ValueNorm ).Max()); 
```

当我试图在调试器中观看它时，它只是跳过它，整个方法虽然没有弹出异常。

答案是什么？什么是更好的方法。

当然，我可以使用循环——但它看起来又脏又长。所以LINQ是可取的

PS我正在使用VS2008 SP1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T15:12:06.900

通常这种行为意味着您的源代码文件不是最新的。尝试从输出目录中删除所有 .bin 和 .pdb 文件并重建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T15:12:12.783

您确定 Select 方法返回一个数组吗？铸造 + 泛型 = 代码异味

试试这个：

```
double[] max = data
  .Select(crArray => crArray.Select( cr => cr.ValueNorm ).Max())
  .ToArray(); 
```

* * *

转换方法 - (ToArray) 分配一个新数组并填充它。受方法的限制。

Down Casting - 允许您更改对对象实例的**引用类型。**仅允许实际实例类型或实例类型继承自的某些类型。其他任何事情都会产生运行时异常。

显式转换运算符 - 使用向下转换的语法，达到转换的效果。这真的是一种转换方法。对于试图理解选角的人来说，这是一个无穷无尽的困惑之源。

考虑这段代码：

```
// reference type is IEnumerable<string>, instance type is string[]
IEnumerable<string> myArray =
  new string[3] { "abc", "def", "ghi" };
// reference type is IEnumerable<string>, instance type is ???
IEnumerable<string> myQuery = myArray
  .Select(s => s.Reverse().ToString());

//Cast - works
string[] result = (string[]) myArray;
//Cast - runtime exception: System.InvalidCastException
result = (string[])myQuery;
//Conversion - works
result = myQuery.ToArray(); 
```

为什么你没有在 vs 中得到运行时异常？我不知道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T16:02:19.137

您是否尝试遍历 max ？我认为这没有抛出，因为您没有遍历请求的结果（Linq 仅在第一次调用 GetEnumerator.

ToArray 方法遍历请求的可枚举项，并复制数组中的所有内容。我认为这就是区别。

# sql-server - 如何使用 sql server 2008 安全地销毁一些数据？（使用 DoD 安全擦除或等效方法）

> ID：553590
> 
> 赞同：7
> 
> 时间：2009-02-16T15:09:04.663
> 
> 标签：sql-server, sql-server-2008

我的一个客户希望我对他的一些旧数据进行定期“真实”销毁，我正在评估最好的方法。

数据在一个表中，我想销毁其中包含的一些行。

我可以通过在另一台计算机上删除/导出数据库/对硬盘驱动器消磁/重新导入保存的数据来手动执行此操作，但我需要一个自动解决方案。

**是否有等效于 delete（如 delete * from foo）命令，它可以安全地销毁数据（使用 DoD 安全擦除，或类似的东西？）**

您是否看到执行此自动删除的其他方法？

顺便说一句，我知道有人检索我使用 sql delete 命令销毁的一些数据的可能性很小，但我的一些客户需要它。所以请不要把这个问题变成关于数据处理程序主题的全球辩论！

**编辑**：我要解决的问题不是“我应该如何销毁数据以使其无法恢复”，而是“如何让我的客户相信他们的数据无法恢复”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T15:30:07.373

使用某种形式的加密将数据字段存储在表中。

当您决定“删除”时，请使用新密钥重新加密您将继续使用的数据。丢弃旧密钥，并删除使用旧密钥加密的行。收缩。

即使有人恢复了行，没有旧密钥也没有人能够恢复数据。只需确保旧密钥确实被丢弃 - 您只能将它放在单个 USB 记忆棒上，然后销毁记忆棒等。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-25T17:07:01.903

来自[在线书籍](http://msdn.microsoft.com/en-us/library/dd408732.aspx)：

> 从表中删除操作或导致行移动的更新操作可以通过删除对行的引用来立即释放页面上的空间。但是，在某些情况下，该行可以物理地保留在数据页上作为幻影记录。后台进程会定期删除幽灵记录。数据库引擎不会在响应查询时返回此残留数据。但是，在数据或备份文件的物理安全存在风险的环境中，您可以使用**`sp_clean_db_free_space`**这些幽灵记录来清除它们。

这应该将您的“免费”数据页清零。如果使用了即时初始化，也可以使用它，但您决定改为将页面归零。

要回答您更新的问题，“我怎样才能让我的客户相信他们的数据无法恢复”，BOL 条目清楚地说明了这一点，“后台进程会定期删除幽灵记录。”

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T15:24:02.177

基本上，没有。标准操作不会这样做，如果这样做，数据仍然可以从事务日志等中重建。可能最接近的方法是在外部进行，将数据库复制并清除到另一台设备，然后进行高-旧设备上的质量擦洗删除，但作为一名安全人员，我什至不确定我什至想说这是一个 sssured delet。

安全删除是一个难题。使用加密方法可能会做得更好，例如 Radia Perlman 的“ephemerizer”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T15:22:48.420

我不确定这是否符合国防部的要求，但至少我会经历以下几点。

1.  以标准方式删除记录
2.  对数据库进行新备份（以备将来使用）
3.  使用符合标准的标准文件删除过程删除所有现有备份（因为它们有数据）
4.  收缩数据库以释放已删除记录中未使用的空间。

我认为这会让你非常接近，但关键是收缩操作的管理，我不能 100% 确定它是如何清除/处理数据的。其次，在我看来，如果您正在查看风险点，那么删除旧备份将是“最大的风险”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T15:33:05.180

实际上，检索被破坏的数据的机会`DELETE`非常大，接近`100%`:)

您删除的数据保存在事务日志中，这是事务工作方式的一部分。在其他情况下，您要么无法进行`ROLLBACK`交易，要么`COMMIT`需要永远进行交易（就像在旧版本中一样`PostgreSQL`）。

在不弄乱数据文件的情况下，您可以做的最好的事情是：

1.  删除您的数据。
    *   `UPDATE`对表执行多次s 销毁旧数据。
    *   执行几个大事务**并提交它们**以使事务日志被截断。究竟有多少取决于您的日志大小。
    *   `CleanSweep`旧事务日志占用的磁盘空间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T15:37:02.557

删除数据。在新硬盘上进行简单的备份和恢复并刻录旧硬盘。

破坏物体是真正让人们相信“东西”真的消失了的唯一方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-20T08:01:03.860

好吧，我只是在这里玩，但你试试这个，它会相当安全。

不要使用典型的备份。

编写模式脚本，如果你还没有的话。

编写所有数据的脚本，以便可以使用包含许多 INSERT 语句的脚本插入所有当前数据。显然，已删除的数据不会显示在此文件中。当然，您将希望使用批量插入和所有这些来将数据放回那里。

现在使用[sdelete](http://technet.microsoft.com/en-us/sysinternals/bb897443.aspx)删除与数据库关联的所有数据文件和日志。现在，从插入脚本恢复。:)

顺便说一句，你的问题和你所做的编辑，说你不想要一个解决方案，但一个不与你的整个问题相矛盾的理由。无论如何，不​​这样做的一个很好的理由是没有人这样做。如果您想在计算领域做一些其他人没有做的事情（除了创建某种全新的应用程序或类似的东西），那可能是个坏主意。据我所知，没有学术或国防部论文描述了这样做的方法。

更大的问题是，哪些信息会从您删除的记录中“泄露”到未删除的记录中。请注意，这里我的意思是信息流意义上的“泄漏”。

虽然，老实说，我上面概述的方法基本上可以实现您的目标。

# c# - 将枚举绑定到 LINQ 和 SelectListItem

> ID：553597
> 
> 赞同：4
> 
> 时间：2009-02-16T15:10:44.377
> 
> 标签：c#, asp.net-mvc, linq, forms

我正在尝试绑定以下枚举

```
public enum CertificateTypes : byte
{
    None = 0,
    Original = 1,
    AuthenticatedCopy = 2,
    Numbered = 3
} 
```

到`tinyint`数据库上的列。但是，在创建 SelectListItems 并调用时，例如，`Person.CertificateTypes.Original.ToString() I get this:`

 ````
<option value="Original">Original</option> 
```` 

`which is not bindable to a byte? column. How should I do this? Should I explicitly set the value to "1" on the `Value` property of the SelectListItem`? 或者有没有办法让这项工作“自动”？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-16T15:43:59.243

如果你想自动使用，你可以使用

```
var enumValues = Enum.GetValues(typeof(CertificateTypes)).Cast<CertificateTypes>().Select(e => (byte)e);
var selectList = new SelectList(enumValues); 
```

这里的问题是您只会获取字节，因此您可能需要选择一种新类型，例如...

```
var enumValues = Enum.GetValues(typeof(CertificateTypes)).Cast<CertificateTypes>()
                                                         .Select(e => new KeyValuePair<byte, string>((byte)e, e.ToString()));
var selectList = new SelectList(enumValues, "Key", "Value"); 
```

这只会从枚举中获取可能的值并将其转换为 CertificateTypes 的 IEnumerable，然后获取每个值并将其转换为新的 KeyValuePair。

需要注意的一点是，如果您的枚举具有 [Flags] 属性，通常最好只将枚举设为复数形式。否则我会把它命名为单数。

一定要爱LINQ！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T15:30:39.617

不过，由于我没有经验，不确定以下内容如何转换为`SelectListItems`ASP.NET/MVC 中的 a，但也许这可以使用。

* * *

当然，您必须专门将枚举转换为它的底层类型`(byte)Person.CertificateTypes.Original`，以便让它与数据库很好地对话。

在 WinForms 中，我使用 an `IList`of`KeyValuePair<byte,string>`绑定到 a `ComboBox`，使用如下内容：

```
foreach (Enum value in Enum.GetValues(typeof(CertificateTypes))
    MyBindingIList.Add(new KeyValuePair<byte,string>((byte)value, value.ToString())); 
```

然后我绑定并将其`ComboBox`设置`DisplayMember`为`"Value"`和。（您可以将and切换为对您有意义的任何内容。对我来说，密钥来自数据库，因此成为数字类型是有意义的。）`ValueMember``"Key"``Key``Value``KeyValuePair`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T15:28:26.427

我真的怀疑调用`ToString()`枚举会返回 xml ......你能澄清发生了*什么*吗？您可能希望将枚举转换为字节/整数（并且大部分时间都以数字形式工作），或者`Enum.Parse`在某个时候使用 - 但如果不了解您是如何将它连接在一起的，就很难说...

# c# - WPF图像到字节[]

> ID：553611
> 
> 赞同：16
> 
> 时间：2009-02-16T15:12:58.227
> 
> 标签：c#, wpf, image, bytearray

我正在尝试从 to 转换`System.Windows.Controls.Image`，`byte[]`但我不知道 Image 类中的哪个方法可以帮助解决这个问题，顺便说一下，我真的不知道该怎么做，因为在我的 LINQ 模型中，该字段显示为`Binary`类型，我必须更改如果我想像`byte[]`类型一样保存它？

我发现这里发布的代码，但没有使用 WPF：

```
Bitmap newBMP = new Bitmap(originalBMP, newWidth, newHeight);
System.IO.MemoryStream stream = new System.IO.MemoryStream();
newBMP.Save(stream, System.Drawing.Imaging.ImageFormat.Bmp);
PHJProjectPhoto myPhoto = new PHJProjectPhoto {
    ProjectPhoto = stream.ToArray(), // <<--- This will convert your stream to a byte[] 
    OrderDate = DateTime.Now, 
    ProjectPhotoCaption = ProjectPhotoCaptionTextBox.Text,
    ProjectId = selectedProjectId
}; 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-02-16T20:33:40.233

真正的解决方案...如果您的 ORM 上的数据库映射字段为 Byte[] / byte[] / Bynary 时，如果想从 System.Windows.Control.Image 保存 jpg 图像

```
public byte[] getJPGFromImageControl(BitmapImage imageC)
{
       MemoryStream memStream = new MemoryStream();              
        JpegBitmapEncoder encoder = new JpegBitmapEncoder();
        encoder.Frames.Add(BitmapFrame.Create(imageC));
        encoder.Save(memStream);
        return memStream.ToArray();
} 
```

调用为：

```
getJPGFromImageControl(firmaUno.Source as BitmapImage) 
```

希望有帮助:)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-16T16:21:42.193

我不知道您的 Image 是如何声明的，但假设我们有这个 XAML 声明：

```
<Image x:Name="img">
    <Image.Source>
        <BitmapImage UriSource="test.png" />
    </Image.Source>
</Image> 
```

然后您可以将 test.png 的内容转换为字节数组，如下所示：

```
var bmp = img.Source as BitmapImage;

int height = bmp.PixelHeight;
int width  = bmp.PixelWidth;
int stride = width * ((bmp.Format.BitsPerPixel + 7) / 8);

byte[] bits = new byte[height * stride];
bmp.CopyPixels(bits, stride, 0); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T19:01:40.063

```
public byte[] BufferFromImage(BitmapImage imageSource)
{        
    Stream stream = imageSource.StreamSource;
    byte[] buffer = null;

    if (stream != null && stream.Length > 0)
    {
        using (BinaryReader br = new BinaryReader(stream))
        {
            buffer = br.ReadBytes((Int32)stream.Length);
        }
    }

    return buffer;
} 
```

将是另一种方式，但不同之处在于这比第一个解决方案具有更少的 bytes[x]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-16T17:10:34.230

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private void btnBrowse_Click(object sender, RoutedEventArgs e)
    {
        var of = new OpenFileDialog();
        of.Filter = "Image files (*.png;*.jpeg)|*.png;*.jpeg|All files (*.*)|*.*";
        var res = of.ShowDialog();
        if (res.HasValue)
        {
            imgPreview.Source = new BitmapImage(new Uri(of.FileName));

            var t = Utils.ConvertBitmapSourceToByteArray(imgPreview.Source as BitmapSource);
            var d = Utils.ConvertBitmapSourceToByteArray(new BitmapImage(new Uri(of.FileName)));
            var s = Utils.ConvertBitmapSourceToByteArray(imgPreview.Source);
            var enc = Utils.ConvertBitmapSourceToByteArray(new PngBitmapEncoder(), imgPreview.Source);
            //imgPreview2.Source = Utils.ConvertByteArrayToBitmapImage(enc);
            imgPreview2.Source = Utils.ConvertByteArrayToBitmapImage2(enc);
            //var i = 0;

        }
        else
        {
            MessageBox.Show("Select a currect file...");

        }
    }

} 
```

*/util.cs/* _ _

```
public class Utils
{
    public static byte[] ConvertBitmapSourceToByteArray(BitmapEncoder encoder, ImageSource imageSource)
    {
        byte[] bytes = null;
        var bitmapSource = imageSource as BitmapSource;

        if (bitmapSource != null)
        {
            encoder.Frames.Add(BitmapFrame.Create(bitmapSource));

            using (var stream = new MemoryStream())
            {
                encoder.Save(stream);
                bytes = stream.ToArray();
            }
        }

        return bytes;
    }

    public static byte[] ConvertBitmapSourceToByteArray(BitmapSource image)
    {
        byte[] data;
        BitmapEncoder encoder = new JpegBitmapEncoder();
        encoder.Frames.Add(BitmapFrame.Create(image));
        using (MemoryStream ms = new MemoryStream())
        {
            encoder.Save(ms);
            data = ms.ToArray();
        }
        return data;
    }
    public static byte[] ConvertBitmapSourceToByteArray(ImageSource imageSource)
    {
        var image = imageSource as BitmapSource;
        byte[] data;
        BitmapEncoder encoder = new JpegBitmapEncoder();
        encoder.Frames.Add(BitmapFrame.Create(image));
        using (MemoryStream ms = new MemoryStream())
        {
            encoder.Save(ms);
            data = ms.ToArray();
        }
        return data;
    }
    public static byte[] ConvertBitmapSourceToByteArray(Uri uri)
    {
        var image = new BitmapImage(uri);
        byte[] data;
        BitmapEncoder encoder = new JpegBitmapEncoder();
        encoder.Frames.Add(BitmapFrame.Create(image));
        using (MemoryStream ms = new MemoryStream())
        {
            encoder.Save(ms);
            data = ms.ToArray();
        }
        return data;
    }
    public static byte[] ConvertBitmapSourceToByteArray(string filepath)
    {
        var image = new BitmapImage(new Uri(filepath));
        byte[] data;
        BitmapEncoder encoder = new JpegBitmapEncoder();
        encoder.Frames.Add(BitmapFrame.Create(image));
        using (MemoryStream ms = new MemoryStream())
        {
            encoder.Save(ms);
            data = ms.ToArray();
        }
        return data;
    }

    public static BitmapImage ConvertByteArrayToBitmapImage(Byte[] bytes)
    {
        var stream = new MemoryStream(bytes);
        stream.Seek(0, SeekOrigin.Begin);
        var image = new BitmapImage();
        image.BeginInit();
        image.StreamSource = stream;
        image.EndInit();
        return image;
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-08-14T23:15:01.447

我喜欢命名空间中的编码器和解码器：[System.Windows.Media.Imaging](https://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapencoder(v=vs.110).aspx)

```
public static class Extensions {        

    public static byte[] ToByteArray(this BitmapSource bitmapSource) {

        var encoder = new JpegBitmapEncoder();
        encoder.Frames.Add(BitmapFrame.Create(bitmapSource));

        using (var stream = new MemoryStream()) {
            encoder.Save(stream);
            return stream.ToArray();
        }
    }

    public static BitmapSource ToBitmapSource(this byte[] bytes) {

        using (var stream = new MemoryStream(bytes)) {
            var decoder = new JpegBitmapDecoder(stream, BitmapCreateOptions.None, BitmapCacheOption.Default);
            return decoder.Frames.First();
        }
    }
} 
```

你可以像这样使用它：

```
var bytes = bitmapSource.ToByteArray(); 
```

或者像这样：

```
var bitmapSource = bytes.ToBitmapSource(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-05-06T06:48:42.483

这对我有用：

```
MemoryStream stream = (MemoryStream)bitmapImage.StreamSource;
byte[] data = stream.ToArray(); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-02-02T16:19:35.170

您还可以使用 BitmapSources 的 CopyPixels 方法

```
int stride = snapshot.PixelWidth * (snapshot.Format.BitsPerPixel / 8);
byte[] data = new byte[stride * snapshot.PixelHeight];
snapshot.CopyPixels(data, stride, 0);
var memoryStream = new MemoryStream(data); 
```

# php - PHPExcel：双/浮点的科学记数法

> ID：553626
> 
> 赞同：0
> 
> 时间：2009-02-16T15:17:33.753
> 
> 标签：php, excel, double, instance, notation

问题如下：我们正在创建一个类 testObject 的实例，并用一个 double 填充一个 var。

TestExcel 类从 PhpExcel 扩展而来，当我们将对象 testObject 提交到构造函数时，我们会在执行 var_dump 时获得 var 的科学记数法。

任何人都可以帮助我们。我和我的同事不明白如何通过扩展 phpExcel 类来更改实例的内容。

当我们不做扩展时， var_dump 返回正确的符号。-- 200000 做扩展时得到科学记数法 -- 2.0E+5

```
// instance of the testObject

$number = new testObject();
$number->setNumber((double)200000);

// contruct testExcelClass
$excel = new TestExcel($number);

// Class TestObject      
class testObject {

      private $number;

      public function setNumber($number){
          $this->number = $number;
      }

      public function getNumber(){
          return $this->number;
      }

}

// class test excell extends from phpexcel (http://www.codeplex.com/PHPExcel) 
class TestExcel extends PHPExcel  {

    private $number;

    public function __construct($number){
      parent::__construct();

      $this->number = $number;
      print_r($this->number); exit();

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T21:38:34.070

您可能应该将单元格的格式设置为具有所需的数字格式。我不确定确切的功能，请查看文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T11:02:31.757

在 PHP 5.2.6 中显示错误的符号似乎是一个问题。

php 5.2.8 解决了这个错误。

# asp.net - 奇怪的麻烦 - 无法将 javascript 分配给链接按钮

> ID：553628
> 
> 赞同：3
> 
> 时间：2009-02-16T15:18:17.120
> 
> 标签：asp.net, button, hyperlink

我似乎事先多次管理相同的任务；但目前我完全被最简单的事情困住了，这让我很恼火

我需要将 javascript 分配给 ASP.Net 链接按钮（或超链接，没关系） 什么似乎更容易？

我用这样的代码做了十亿次

```
 //lbHeader.Attributes.Add("onclick",
        //    string.Format("ToggleSelectionPopup('{0}');return false;", panelContainer.ClientID)); 
```

但它不起作用。我得到的 HTML 包含 javascript:__doPostback (blahblahblah) 并忽略了我的客户端“onclick”功能。相反，当我单击按钮时页面会回发（尽管“onclick”功能正确附加在“查看页面源”HTML中

我尝试应用一些技巧和方法，例如以下

1）用超链接替换LinkBut​​ton - 效果仍然相同，当我点击href时页面转发到“NavigateURL”。

2）在声明性布局中分配“OnClientClick”属性 - 效果相同，页面无论如何都会回发并忽略“onclick”

3) 将“javascript:ToggleSelectionPopup(blahblahblah)”指定为超链接的 NavigateURL 和链接按钮的 PostBackURL。也不起作用

这两种技巧都没有帮助。我做错了什么，有什么想法吗？

我只需要摆脱该控件的糟糕服务器性能，但我该怎么做呢？当然，我可以手动使用 " 制作 LiteralControl，但我不想使用这种粗略的方法。

帮助高度赞赏

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T15:41:29.187

You could use the LinkButton control and add a javascript function call to OnClientClick. This will be called before the clientside validation and before the postback (obviously). Should you need to execute this after validation but before the postback then you could call the clientside validation manually in your OnClientClick using 'Page_ClientValidate()';

```
<script type="text/javascript">
function someJsYouWant()
{
  alert('HelloSO');
}
</script>

 <asp:LinkButton ID="btnSearch" 
         runat="server"
         OnClientClick="Page_ClientValidate(); someJsYouWant();"
         onclick="btnSearch_OnClick">Search</asp:LinkButton> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T15:28:18.283

ASP.NET 控件 Button 和 LinkBut​​ton 将始终进行回发。您可能使用 OnClientClick 属性添加的 javascript 将在回发之前执行，但不会阻止回发。

您可以通过以下方式使用 HyperLink 控件：

```
<asp:HyperLink runat="server" ID="hyperlink1" NavigateUrl="JavaScript:alert('!');">Test</asp:HyperLink> 
```

我注意到您正在使用变量名 lbHeader。您确定将 javascript 添加到正确的控件而不是某些随机标签中吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T15:30:52.223

作为一个选项，您可以尝试**HtmlAnchor**控件。

在 onclick 属性**返回 false；**足以停止重定向。

```
<a href="not_importans.htm" onclick="javascript:someothermethod();return false;">Trial Link</a> 
```

但你的代码看起来不错。你检查你的 LinkBut​​ton 的 HTML 输出吗？**也许分配给onclick**属性的其他代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T15:48:25.287

As I'm not into .NET, but in Html/Javascript/Ajax, maybe I'm wrong, but if you use the onclick way, for some browsers, you will also have to add : **href="javascript:void(0);"**. This way, only the onclick will be executed.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T16:13:10.467

It is a bit unclear what you are trying to do. You have an invalid if statement in your javascript. Try this (it works - I tried it):

```
hrefHeader.NavigateUrl = String.Format("javascript:toggleSelectionPopup('{0}');", panelContainer.ClientID); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T10:57:59.017

谢谢大家，问题已经解决了

javascript:void(0) 似乎是正确的方法。

通过以下方式描述了我的超链接

```
<asp:Hyperlink  ID="hrefHeader" Text="lbHeader" runat="server"  Font-Size="Large" Font-Italic="true" 
 CausesValidation="False"  NavigateUrl="javascript:void(0);" ForeColor="#0033CC" >
</asp:Hyperlink> 
```

“onclick”开始开火。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T15:35:57.467

~~您是否只是忘记`"javascript:"`在字符串的开头放置？~~[傻我]

我用于这种事情的代码如下所示：

```
myLinkButton.SetAttribute("onclick", "javascript:if(someCondition()) return false;"); 
```

...但我想这与`Attributes.Add`.

您的代码对我来说看起来不错。我的猜测是该属性被页面生命周期中的其他内容覆盖。在页面的 Render 中添加一个断点并在那里查看您的 LinkBut​​ton 的属性集合。还要检查呈现的 HTML，看看你的 javascript 是否出现在那里。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-16T16:34:05.003

您确定在您的调用中没有收到运行时错误`toggleSelectionPopup`吗？

# visual-c++ - 音频编程入门

> ID：553646
> 
> 赞同：19
> 
> 时间：2009-02-16T15:21:40.857
> 
> 标签：visual-c++, audio, multimedia

我正在寻找为 Windows 音频构建一些压缩接口，我想知道是否有人可能知道一些提示/技巧？我想构建我自己的软件均衡器，它将与整个 Windows 音频系统一起工作，而不仅仅是一个特定的程序。我知道这是可以做到的——我的声卡内置了一个，但没有足够的频道满足我的口味。

我对音频编程完全陌生，但我真的很想闯入它并弄脏我的手。如果您能想到任何教程/参考/文章/建议，我很想听听！

我正在使用 Visual Studio C++ 2008。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-16T15:30:20.010

如果你想接触 DSP 的东西，我建议你从 VST 编程开始。编写插件是一种很好的方式来处理实时音频操作，而不必担心连接到系统硬件、驱动程序等。基本上，定序器会为您处理所有这些，并且您的插件只接收一个带有浮点数据的缓冲区，您可以直接对其进行操作。

总的来说，这比尝试编写一个插件来操作通过系统音频流的数据要容易得多。此外，Windows 音频 API 自 Vista 以来发生了显着变化，并且根据您使用的 Windows 版本，您必须遵循不同的约定才能使您的东西正常工作。

但再次——从简单开始。获取[VST SDK](http://ygrabit.steinberg.de/~ygrabit/public_html/index.html)，查看一些[教程](http://www.axiworld.be/vst.html)，然后从小步骤开始。:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-17T10:31:37.567

以下是一些对我非常有用的链接：

1.  Tammo Hinrichs "kb" 的演示组 Farbrausch关于音频编程的[文章。](http://blog.kebby.org/?p=34)还有一段 Tammo 在[这里](http://www.scene.org/file.php?file=/parties/2005/breakpoint05/seminars/bp05_seminars_-_tammo_kb_hinrichs_-_practical_softsynth_design_-_xvid.avi&fileinfo.)举办的研讨会的视频。

2.  Jari Kleimola 硕士论文[“软件声音合成器的设计与实现”](http://kotisivut.fonet.fi/~jkleimol/home.htm)。超过 100 页有关音频编程的内容。

3.  [C++ 中的综合工具包](http://ccrma.stanford.edu/software/stk/)。大学开发的高级音频工具包。该工具包的主要作者是 Perry Cook，他还写了一本书：“Real Sound Synthesis for Interactive Applications”。

4.  [Petter 博士的“基本声音理论与合成”](http://www.drpetter.se/article_sound.html)文章。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T10:10:21.843

尝试使用[musicdsp](http://www.musicdsp.org/)存档以获得一些好的音频效果示例代码。KvR[开发者论坛](http://www.kvraudio.com/forum/viewforum.php?f=33)也是获得有关编写 VST 和一般效果的帮助的好地方。

至于 Windows 音频 API，有很多。最广泛支持的称为[WinMM](http://msdn.microsoft.com/en-us/library/ms713499(VS.85).aspx)。最新和最伟大的是随 Vista 引入的新[WASAPI接口。](http://msdn.microsoft.com/en-us/library/dd371455(VS.85).aspx)

最后，要实现系统范围的均衡器效果，您可能需要查看较低级别的接口，例如[sAPO](http://msdn.microsoft.com/en-us/library/bb981490.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T08:55:28.760

对 VST 编程的一个温和介绍是 SynthEdit... www.synthedit.com，它提供了一个拖放编程环境，可以编写您自己的 C++ 插件。您可以通过拖放来完成“无聊”位（GUI 设计），以及 C++ 中的“有趣”算法位。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-16T15:38:02.533

您可能需要看一下[DirectSound](http://en.wikipedia.org/wiki/DirectSound)，但请记住，它很快就会被 XAudio2 取代 - 可能在 Windows 7 中。我认为 DirectSound 将继续支持一段时间，因为它已经存在了很长时间.

# ruby-on-rails - 使用 Ruby on Rails 安排发送电子邮件任务的最佳方式是什么？

> ID：553648
> 
> 赞同：10
> 
> 时间：2009-02-16T15:22:29.527
> 
> 标签：ruby-on-rails, scheduling, scheduled-tasks

我想安排一个日常任务：每天早上 7 点，我想发送一封电子邮件（无需人工干预）。

我正在研究 RoR 框架，我想知道最好的方法是什么？

我听说过 BackgrounDRB、OpenWFEru 调度程序或基于 Cron 的东西，但我是新手，不明白哪一个是为我的需要而设计的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-16T18:37:47.937

另一种选择是创建一个由 cron 作业运行的 rake 任务。为此，请创建一个文件`some_file.rake`并将其放入您的`lib/tasks`文件夹中。您的文件可能如下所示：

导轨 2.x：

```
task :send_daily_mail, :needs => :environment do
    Model.send_daily_mail
end 
```

导轨 3.x：

```
task :send_daily_mail => :environment do
    Model.send_daily_mail
end 
```

然后使用 cron 尽可能频繁地执行它：

```
cd /path/to/app && /usr/bin/rake send_daily_mail 
```

`RAILS_ENV=production`请注意，如果您的应用程序默认处于开发模式，您可能需要放入您的 crontab。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-16T16:01:40.697

[我对这篇博文中讨论的](http://intridea.com/2009/2/13/dead-simple-task-scheduling-in-rails?blog=company)[rufus-scheduler](http://github.com/jmettraux/rufus-scheduler/tree/master) gem印象深刻（并计划尝试）

他是这样描述的：

```
scheduler = Rufus::Scheduler.start_new  

scheduler.every("1m") do  
   DailyDigest.send_digest!  
end 
```

..这看起来很简单。我想知道添加基于 HTML 的配置有多容易？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T23:17:14.677

BackgroundRB 是我使用的，它工作得很好。我有几封由 BackgroundRB 生成的电子邮件正在发送。我也有其他任务。因为它同时启用计划任务和异步任务（比正常客户端/服务器响应周期花费更长的任务）。

我使用它，我对它非常满意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T15:35:00.153

将一个类方法添加到将为您处理此问题的模型之一。现在尝试使用运行器脚本执行该方法

```
./script/runner "MyModel.send_daily_mail" RAILS_ENV=production 
```

确保一切正常。如果是这样，那么我们需要通过正确设置项目的路径来使命令普遍工作。

```
cd /path/to/my/rails/project && ./script/runner "MyModel.send_daily_mail" RAILS_ENV=production 
```

现在更改为任何随机目录并运行该命令。如果它运行正常，请运行`crontab -e`并在其中插入命令，以便每天早上 7 点运行。如果你用谷歌搜索它们，那里有很多关于 cron 格式的解释，应该很容易弄清楚。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T07:01:50.290

正如公认的答案已经说过的那样，执行 rake 任务和 cron 作业。但是，请注意，更新 cron 文件本身是一项手动任务。如果您在开发过程中不更改它，那可能会很好。否则，在这里你可以让 Capistrano 为你做这件事：http: [//push.cx/2008/deploying-crontab-with-your-rails-app](http://push.cx/2008/deploying-crontab-with-your-rails-app)

# parsing - QTP：获取电子邮件中所有链接的列表

> ID：553649
> 
> 赞同：1
> 
> 时间：2009-02-16T15:22:38.263
> 
> 标签：parsing, automated-tests, qtp, extraction

我正在 Mercury/HP QuickTest Pro 9.1 中“开发”一个测试计划，我必须在其中提取电子邮件中所有链接的列表并对每个链接执行逻辑。

在这种情况下，我使用的是 Webmail，因此邮件将显示为网页；虽然我希望以后使用 Outlook 来复制更真实的 UX。

我是开发人员，而不是测试人员。任何人都可以为我提供一些将执行此提取的“代码”吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T02:27:59.040

您可以调用该`ChildObjects`方法以返回给定类型的子对象的集合。例如，要获取 Google 主页上所有 Link 对象的列表：

```
set oDesc = Description.Create()
oDesc("micclass").Value = "Link"
set links = Browser("title:=Google").Page("title:=Google").ChildObjects(oDesc)
For i = 0 To links.Count-1
    reporter.ReportEvent micInfo, links(i).GetROProperty("text"), ""
Next 
```

因此，您只需识别包含电子邮件正文的 Web 元素并将其用作搜索的父元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T16:04:36.300

如果您最终选择了 Outlook 路线，则可以使用 Outlook API 来完成，而无需使用 QTP 的 GUI 代码。

```
sServer = "your.server.address.here" '"your.server.address.here"
sMailbox = "JoeSmith" '"mailboxName"

' build the ProfileInfo string
sProfileInfo = sServer & vbLf & sMailbox

' create your session and log on    
Set oSession = CreateObject("MAPI.Session")
oSession.Logon "", "", False, True, 0, True, sProfileInfo

' create your Inbox object and get the messages collection
Set oInbox = oSession.Inbox
Set oMessageColl = oInbox.Messages

' get the first message in the collection
Set oMessage = oMessageColl.GetFirst

If oMessage Is Nothing Then
   MsgBox "No messages found"
Else
   ' loop through inbox
   Do
     With oMessage
        ' message data:
        Debug.Print .Subject & vbCrLf & .TimeReceived & vbCrLf & .Text
        ' this triggers the clever Outlook security dialog:
        'Debug.Print .Sender(1) & vbCrLf & .Recipients(1)
        Debug.Print
     End With

     Set oMessage = oMessageColl.GetNext
   Loop Until oMessage Is Nothing
End If

'Logoff your session and cleanup
oSession.Logoff

Set oMessage = Nothing
Set oMessageColl = Nothing
Set oInbox = Nothing
Set oSession = Nothing 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-12T07:54:26.763

```
'write qtp script to display names of links in  jkcwebsite page
Option explicit
Dim bro,url,n,desc,childs,i
bro="c:\Program Files\Internet Explorer\IEXPLORE.EXE"
url="http://ieg.gov.in/"
invokeapplication bro&" "&url
'create description for link type
Set desc=description.Create
desc ("micclass").value="link"
'get all links in jkc page
Set childs=browser("title:=Jawahar Knowledge Center").Page("title:=Jawahar Knowledge Center").ChildObjects(desc)
For i=0 to childs.count-1 step 1
    n=childs(i).getroproperty("name")
    print n
Next
n=childs.count
browser("title:=Jawahar Knowledge Center").Close 
```

# logging - 如何在mysql 5中记录特定表的插入/更新查询

> ID：553656
> 
> 赞同：0
> 
> 时间：2009-02-16T15:24:19.507
> 
> 标签：logging, mysql5

有谁知道是否可以在 mysql 5 中记录特定表的所有插入/更新查询？

我们有多个应用程序查询同一个数据库，因此在数据访问层（两个许多应用程序）中实现这一点是非常不现实的，如果我们可以在数据库的配置文件中打开一个开关就容易多了。我意识到我们可以记录所有查询，但这会对性能造成很大影响。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-16T16:36:36.387

这个东西叫做“审计追踪”。谷歌应该会给你相当多的答案。

# sql - 在 SQL 查询中转义句点字符

> ID：553669
> 
> 赞同：0
> 
> 时间：2009-02-16T15:28:11.230
> 
> 标签：sql, lotus-notes, escaping

编辑：刚刚意识到额外结果的原因是查询中的另一行！不要认为我有足够的代表来结束这个问题。

我正在编辑一些正在搜索 Lotus Notes 数据库的现有 SQL 代码。

我有这条线：

```
@Contains(Title; "blah blah 1.5") 
```

并且我只想返回那些在标题中完全包含给定字符串的记录。

目前它返回包含“blah blah 1”的所有记录，例如我得到“blah blah 1.1”、“blah blah 1.2”等。

我的猜测是我需要逃避'。但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T15:34:19.717

我认为您只需要测试是否相等，而不是使用全文搜索运算符：

```
WHERE Title = 'blah blah 1.5' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T15:45:22.127

我不是 100% 确定，但我认为解决方案是引用你想要的短语；就像是：

```
@Contains(Title; "'blah blah' AND '1.5'") 
```

至少，这就是我认为你在 MS SQL Server 中想要的（虽然我认为语法是 CONTAINS(Title, '"blah blah" AND "1.5"') ）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T11:26:39.150

在 Notes/Domino 公式语言中，@Contains 只是进行简单的子字符串比较。如果第二个参数是（或等于）第一个参数的子字符串，则返回 true(1)，否则返回 false(0)。在这种情况下，一个简单的相等运算符可能更合适。

```
Title="blah blah 1.5" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T15:12:09.420

我假设您的示例实际上是在编辑 Lotus Notes 搜索公式而不是 SQL 查询。CONTAINS 函数的 SQL 格式不使用分号分隔参数，并且函数名称中没有 @ 符号。

按照这个假设，您需要将搜索公式更改为简单的 Title = "blah blah 1.5"，并且在您的视图或搜索中，您将获得标题与该确切短语相同的所有文档。

# javascript - 在运行时将变量更改为文字？

> ID：553672
> 
> 赞同：0
> 
> 时间：2009-02-16T15:28:23.493
> 
> 标签：javascript, mootools

我是 javascript 的初学者，我想不出解决以下问题的方法。我在这个例子中使用了 Mootools，虽然这不是 Mootools 的问题：

```
for (var i = 0; i < 5; i++) {
    myElement[i].addEvent('click', function () { otherFunction(i); });
} 
```

每当有人单击 myElement 时，调用 otherFunction（好）但传递 5（坏）。我知道这是因为它在循环完成后（当他们单击元素时）访问我，但除了单调之外，我想不出任何替代方案

```
switch(i) {
    case 1: myElement[i].addEvent('click', function () { otherFunction(1); }); break;
    case 2: myElement[i].addEvent('click', function () { otherFunction(2); }); break;
    // ...
} 
```

必须有更好的方法......我觉得我错过了一些明显的东西

更新：向 myElement 添加了 [i] 索引（哎呀）

谢谢，卡梅伦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T15:41:48.827

您的代码是闭包的一个示例 - 匿名函数引用*i*的最后一个值，因为它有效地保留了外部范围以供以后在调用函数时使用。

这是您可以修复它的一种方法：

```
function getClickHandler(i)
{ 
   return function () { otherFunction(i); }
}

for (var i = 0; i < 5; i++) {
    myElement.addEvent('click', getClickHandler(i));
} 
```

这会将闭包的创建移动到另一个范围，该范围将“保留” *i的每个值*

另一种方法是简单地拥有一个单击处理程序，该处理程序可以分配给每个元素并确定从事件对象中单击了哪个（假设您要将这些处理程序附加到不同的元素，尽管您的代码建议您需要多个处理程序*相同*的元素，这有点奇怪:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T15:41:31.370

我同意评论质疑为什么一个元素需要五个点击处理程序，但是要完成你想要的，你需要使用闭包。

看看这个关于[JavaScript 教程的教程](http://www.jibbering.com/faq/faq_notes/closures.html)。

更新：对于一些代码/语法示例，请查看[我在此处](https://stackoverflow.com/questions/341723/event-handlers-inside-a-javascript-loop-need-a-closure)就同一主题提出的这个问题 - 使用事件处理程序的闭包。

# c++ - 我什么时候可以使用前向声明？

> ID：553682
> 
> 赞同：653
> 
> 时间：2009-02-16T15:31:06.277
> 
> 标签：c++, forward-declaration, c++-faq

我正在寻找何时允许在另一个类的头文件中对一个类进行前向声明的定义：

我是否可以为基类、作为成员的类、通过引用传递给成员函数的类等执行此操作？

* * *

## 回答 #1

> 赞同：1043
> 
> 时间：2009-02-16T16:24:25.573

把自己放在编译器的位置上：当你前向声明一个类型时，编译器只知道这个类型存在；它对其大小、成员或方法一无所知。这就是为什么它被称为*不完整类型*。因此，您不能使用该类型来声明成员或基类，因为编译器需要知道该类型的布局。

假设以下前向声明。

```
class X; 
```

这是您可以做和不能做的事情。

**你可以用不完整的类型做什么：**

*   将成员声明为指向不完整类型的指针或引用：

    ```
    class Foo {
        X *p;
        X &r;
    }; 
    ```

*   *声明*接受/返回不完整类型的函数或方法：

    ```
    void f1(X);
    X    f2(); 
    ```

*   *定义*接受/返回指向不完整类型的指针/引用的函数或方法（但不使用其成员）：

    ```
    void f3(X*, X&) {}
    X&   f4()       {}
    X*   f5()       {} 
    ```

**你不能用不完整的类型做什么：**

*   将其用作基类

    ```
    class Foo : X {} // compiler error! 
    ```

*   用它来声明一个成员：

    ```
    class Foo {
        X m; // compiler error!
    }; 
    ```

*   *使用该类型定义*函数或方法

    ```
    void f1(X x) {} // compiler error!
    X    f2()    {} // compiler error! 
    ```

*   使用其方法或字段，实际上试图取消引用类型不完整的变量

    ```
    class Foo {
        X *m;            
        void method()            
        {
            m->someMethod();      // compiler error!
            int i = m->someField; // compiler error!
        }
    }; 
    ```

* * *

对于模板，没有绝对的规则：是否可以使用不完整的类型作为模板参数取决于模板中使用该类型的方式。

例如，`std::vector<T>`要求其参数是完整类型，`boost::container::vector<T>`而不需要。有时，仅当您使用某些成员函数时才需要完整类型；例如[，情况就是这样。`std::unique_ptr<T>`](https://stackoverflow.com/questions/6012157/is-stdunique-ptrt-required-to-know-the-full-definition-of-t)

一个文档齐全的模板应该在其文档中指出其参数的所有要求，包括它们是否需要是完整的类型。

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-02-16T15:35:40.777

主要规则是您只能前向声明其内存布局（以及成员函数和数据成员）不需要在您前向声明它的文件中知道的类。

这将排除基类和除通过引用和指针使用的类之外​​的任何东西。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-07-21T07:44:43.663

[Lakos](https://rads.stackoverflow.com/amzn/click/com/0201633620)区分类用法

1.  *in-name-only*（前向声明就足够了）和
2.  *in-size*（需要类定义）。

我从未见过它发音更简洁:)

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-02-16T16:03:23.160

除了指向不完整类型的指针和引用，您还可以声明指定参数和/或返回值不完整类型的函数原型。但是，您不能*定义*具有不完整参数或返回类型的函数，除非它是指针或引用。

例子：

```
struct X;              // Forward declaration of X

void f1(X* px) {}      // Legal: can always use a pointer
void f2(X&  x) {}      // Legal: can always use a reference
X f3(int);             // Legal: return value in function prototype
void f4(X);            // Legal: parameter in function prototype
void f5(X) {}          // ILLEGAL: *definitions* require complete types 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2015-10-31T05:00:34.153

到目前为止，没有一个答案描述了何时可以使用类模板的前向声明。所以，就这样吧。

一个类模板可以转发声明为：

```
template <typename> struct X; 
```

按照[接受答案](https://stackoverflow.com/a/553869/434551)的结构，

这是您可以做和不能做的事情。

**你可以用不完整的类型做什么：**

*   将成员声明为指向另一个类模板中不完整类型的指针或引用：

    ```
    template <typename T>
    class Foo {
        X<T>* ptr;
        X<T>& ref;
    }; 
    ```

*   将成员声明为指向其不完整实例之一的指针或引用：

    ```
    class Foo {
        X<int>* ptr;
        X<int>& ref;
    }; 
    ```

*   声明接受/返回不完整类型的函数模板或成员函数模板：

    ```
    template <typename T>
       void      f1(X<T>);
    template <typename T>
       X<T>    f2(); 
    ```

*   声明接受/返回其不完整实例之一的函数或成员函数：

    ```
    void      f1(X<int>);
    X<int>    f2(); 
    ```

*   定义函数模板或成员函数模板，它们接受/返回指向不完整类型的指针/引用（但不使用其成员）：

    ```
    template <typename T>
       void      f3(X<T>*, X<T>&) {}
    template <typename T>
       X<T>&   f4(X<T>& in) { return in; }
    template <typename T>
       X<T>*   f5(X<T>* in) { return in; } 
    ```

*   定义接受/返回指向其不完整实例之一的指针/引用的函数或方法（但不使用其成员）：

    ```
    void      f3(X<int>*, X<int>&) {}
    X<int>&   f4(X<int>& in) { return in; }
    X<int>*   f5(X<int>* in) { return in; } 
    ```

*   将其用作另一个模板类的基类

    ```
    template <typename T>
    class Foo : X<T> {} // OK as long as X is defined before
                        // Foo is instantiated.

    Foo<int> a1; // Compiler error.

    template <typename T> struct X {};
    Foo<int> a2; // OK since X is now defined. 
    ```

*   使用它来声明另一个类模板的成员：

    ```
    template <typename T>
    class Foo {
        X<T> m; // OK as long as X is defined before
                // Foo is instantiated. 
    };

    Foo<int> a1; // Compiler error.

    template <typename T> struct X {};
    Foo<int> a2; // OK since X is now defined. 
    ```

*   *使用该类型定义*函数模板或方法

    ```
    template <typename T>
      void    f1(X<T> x) {}    // OK if X is defined before calling f1
    template <typename T>
      X<T>    f2(){return X<T>(); }  // OK if X is defined before calling f2

    void test1()
    {
       f1(X<int>());  // Compiler error
       f2<int>();     // Compiler error
    }

    template <typename T> struct X {};

    void test2()
    {
       f1(X<int>());  // OK since X is defined now
       f2<int>();     // OK since X is defined now
    } 
    ```

**你不能用不完整的类型做什么：**

*   使用其实例之一作为基类

    ```
    class Foo : X<int> {} // compiler error! 
    ```

*   使用它的一个实例来声明一个成员：

    ```
    class Foo {
        X<int> m; // compiler error!
    }; 
    ```

*   *使用其实例之一定义*函数或方法

    ```
    void      f1(X<int> x) {}            // compiler error!
    X<int>    f2() {return X<int>(); }   // compiler error! 
    ```

*   使用其实例之一的方法或字段，实际上试图取消引用类型不完整的变量

    ```
    class Foo {
        X<int>* m;            
        void method()            
        {
            m->someMethod();      // compiler error!
            int i = m->someField; // compiler error!
        }
    }; 
    ```

*   创建类模板的显式实例化

    ```
    template struct X<int>; 
    ```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-16T15:40:14.290

在您仅使用指向类的指针或引用的文件中。并且不应调用那些指针/引用的成员/成员函数。

with `class Foo;`//前向声明

我们可以声明 Foo* 或 Foo& 类型的数据成员。

我们可以用 Foo 类型的参数和/或返回值声明（但不能定义）函数。

我们可以声明 Foo 类型的静态数据成员。这是因为静态数据成员是在类定义之外定义的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-07-06T02:54:30.330

我将其作为单独的答案而不仅仅是评论，因为我不同意 Luc Touraille 的答案，不是出于合法性，而是出于强大的软件和误解的危险。

具体来说，我对您希望界面用户必须知道的内容的隐含合同有疑问。

如果您要返回或接受引用类型，那么您只是说它们可以传递一个指针或引用，而这些指针或引用又可能只通过前向声明才知道。

当您返回不完整的类型时`X f2();`，您是在说您的调用者**必须**具有 X 的完整类型规范。他们需要它才能在调用站点创建 LHS 或临时对象。

同样，如果您接受不完整的类型，则调用者必须已经构造了作为参数的对象。即使该对象作为函数的另一个不完整类型返回，调用站点也需要完整声明。IE：

```
class X;  // forward for two legal declarations 
X returnsX();
void XAcceptor(X);

XAcepptor( returnsX() );  // X declaration needs to be known here 
```

我认为有一个重要原则，即标头应提供足够的信息来使用它，而无需依赖其他标头。这意味着当您使用它声明的任何函数时，头文件应该能够包含在编译单元中而不会导致编译器错误。

**除了**

1.  如果这种外部依赖是**期望**的行为。除了使用条件编译之外，您还可以有一个*有据可查的*要求，要求他们提供自己的标头声明 X。这是使用 #ifdefs 的替代方法，并且可以是引入模拟或其他变体的有用方法。

2.  重要的区别是一些模板技术，您明确不希望实例化它们，只是为了避免有人对我发脾气。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-16T15:34:12.293

只要您不需要定义（想想指针和引用），您就可以摆脱前向声明。这就是为什么大多数情况下您会在标头中看到它们，而实现文件通常会为适当的定义提取标头。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-16T16:28:02.070

我遵循的一般规则是不包含任何头文件，除非我必须这样做。因此，除非我将类的对象存储为我的类的成员变量，否则我不会包含它，我只会使用前向声明。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-16T15:36:47.747

当您想使用其他类型（类）作为类的成员时，通常需要在类头文件中使用前向声明。您不能在头文件中使用前向声明的类*方法*，因为此时 C++ 还不知道该类的定义。这是您必须移入 .cpp 文件的逻辑，但如果您使用的是模板函数，您应该将它们减少到仅使用模板的部分并将该函数移到标题中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-16T15:36:56.390

假设前向声明将使您的代码编译（创建obj）。但是，除非找到定义，否则链接（exe 创建）将不会成功。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-06-08T18:35:58.603

我只想添加一件重要的事情，您可以使用 Luc Touraille 的答案中未提及的转发类来做。

**你可以用不完整的类型做什么：**

*定义*接受/返回指向不完整类型的指针/引用并将该指针/引用转发给另一个函数的函数或方法。

```
void  f6(X*)       {}
void  f7(X&)       {}
void  f8(X* x_ptr, X& x_ref) { f6(x_ptr); f7(x_ref); } 
```

一个模块可以将一个前向声明类的对象传递给另一个模块。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-07-13T15:33:27.900

正如，Luc Touraille 已经很好地解释了在哪里使用和不使用类的前向声明。

我将补充一下为什么我们需要使用它。

我们应该尽可能使用前向声明来避免不必要的依赖注入。

As `#include` header files are added on multiple files therefore, if we add a header into another header file it will add unwanted dependency injection in various parts of source code which can be avoided by adding `#include` header into `.cpp` files wherever possible rather than adding to another header file and use class forward declaration wherever possible in header `.h` files.

# concurrency - 什么是协程？

> ID：553704
> 
> 赞同：253
> 
> 时间：2009-02-16T15:36:43.613
> 
> 标签：concurrency, language-agnostic, terminology, coroutine

什么是协程？它们与并发有什么关系？

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2009-02-16T15:46:32.623

Coroutines and concurrency are largely orthogonal. Coroutines are a general control structure whereby flow control is cooperatively passed between two different routines without returning.

The 'yield' statement in Python is a good example. It creates a coroutine. When the 'yield ' is encountered the current state of the function is saved and control is returned to the calling function. The calling function can then transfer execution back to the yielding function and its state will be restored to the point where the 'yield' was encountered and execution will continue.

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2015-07-01T03:11:11.883

来自[Lua](http://feistyduck.myshopify.com/products/programming-in-lua)中的“编程`Coroutines`”部分：

> 协程类似于线程（在多线程的意义上）：它是一行执行，有自己的堆栈、自己的局部变量和自己的指令指针；但它与其他协程共享全局变量和大部分其他内容。线程和协程之间的主要区别在于，在概念上（或字面意思，在多处理器机器中），具有线程的程序并行运行多个线程。另一方面，协程是协作的：在任何给定时间，具有协程的程序只运行它的一个协程，并且这个正在运行的协程只有在它明确请求暂停时才会暂停其执行。

所以重点是：**协程是“协作的”。即使在多核系统中，任何时候也只有一个协程在运行（但多个线程可以并行运行）。协程之间是非抢占式的，运行中的协程必须显式放弃执行。**

对于“ `concurrency`”，您可以参考 Rob Pike 的[幻灯片](http://talks.golang.org/2012/concurrency.slide#6)：

> 并发是独立执行计算的组合。

所以在协程A的执行过程中，它把控制权交给了协程B。一段时间后，协程B又把控制权交给了协程A。由于协程之间存在**依赖**关系，必须串联运行，所以两个协程**不是并发**的。

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2018-12-07T05:21:20.860

尽管这是一个技术问题，但我发现大多数答案都过于技术化。我很难理解协程过程。我有点明白，但我没有同时明白。

我发现这个答案非常有帮助：

[https://dev.to/thibmaek/explain-coroutines-like-im-five-2d9](https://dev.to/thibmaek/explain-coroutines-like-im-five-2d9)

引用 Idan Arye 的话：

> 为了建立你的故事，我会这样说：
> 
> 你开始看动画片，但它是介绍。不用看介绍，而是切换到游戏并进入在线大厅 - 但它需要 3 名玩家，而且只有你和你的妹妹在里面。无需等待其他玩家加入，而是切换到您的作业，并回答第一个问题。第二个问题有一个指向您需要观看的 YouTube 视频的链接。你打开它 - 它开始加载。您无需等待它加载，而是切换回卡通。介绍已经结束，大家可以观看。现在有广告 - 但同时第三位玩家加入了，所以你切换到游戏等等......
> 
> 这个想法是，你不只是快速切换任务，让它看起来像你在一次做所有事情。您利用等待某事发生的时间（IO）来做其他需要您直接关注的事情。

一定要检查链接，还有更多我无法引用的内容。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2016-06-21T16:35:25.427

协程类似于子程序/线程。不同之处在于，一旦调用者调用了子例程/线程，它就永远不会返回调用者函数。但是协程可以在执行几段代码后返回给调用方，允许调用方执行一些自己的代码并返回到协程停止执行的点并从那里继续。IE。协程有多个入口和出口点

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2017-10-07T13:38:44.340

*   协程是 Kotlin 语言中可用的强大功能
*   协程是一种编写异步、非阻塞代码（以及更多）的新方法
*   协程是轻量级线程。轻量级线程意味着它不会映射到本机线程，因此它不需要处理器上的上下文切换，因此它们更快。
*   它不映射到本机线程
*   协程和线程都是多任务处理。但不同之处在于线程由操作系统管理，协程由用户管理。

基本上，有两种类型的协程：

1.  无堆叠
2.  堆积如山

Kotlin 实现了无堆栈协程——这意味着协程没有自己的堆栈，因此它们不会映射到本机线程。

这些是启动协程的函数：

```
launch{}

async{} 
```

您可以从这里了解更多信息：

[https://www.kotlindevelopment.com/deep-dive-coroutines/](https://www.kotlindevelopment.com/deep-dive-coroutines/)

[https://blog.mindorks.com/what-are-coroutines-in-kotlin-bf4fecd476e9](https://blog.mindorks.com/what-are-coroutines-in-kotlin-bf4fecd476e9)

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2020-06-24T18:48:16.583

我发现此[链接](https://www.educative.io/edpresso/what-is-a-coroutine)的解释非常简单。[除了这个答案](https://stackoverflow.com/a/62162266/5335565)中的最后一个要点外，这些答案都没有试图解释并发性与并行性。

1.  什么是并发（程序）？

**引**自传奇人物乔·阿姆斯特朗的“编程 Erlang”：

> 并发程序可以在并行计算机上运行得更快。

*   并发程序是用并发编程语言编写的程序。我们出于性能、可伸缩性或容错性的原因编写并发程序。

*   并发编程语言是一种具有用于编写并发程序的显式语言结构的语言。这些结构是编程语言的一个组成部分，并且在所有操作系统上的行为方式都相同。

*   并行计算机是具有多个可以同时运行的处理单元（CPU 或内核）的计算机。

所以并发与并行是不一样的。您仍然可以在单核计算机上编写并发程序。分时调度器会让您感觉您的程序正在同时运行。

并发程序有可能在并行计算机中并行运行，但**不能保证**。操作系统可能只给你一个内核来运行你的程序。

因此，**并发是来自并发程序的软件模型**，并不意味着您的程序可以在物理上并行运行。

2.  协程和并发

> “协程”一词由两个词组成：“co”（合作）和“routines”（函数）。

一个。它实现并发还是并行？

为简单起见，让我们在**单核**计算机上讨论它。

并发是通过操作系统的时间共享来实现的。线程在其分配的时间范围内在 CPU 内核上执行其代码。它可以被操作系统抢占。它也可能将控制权交给操作系统。

另一方面，协同程序将控制权交给线程内的另一个协同程序，而不是操作系统。因此，一个线程中的所有协程仍然利用该线程的时间框架，而不会将 CPU 内核让给操作系统管理的其他线程。

因此，您可以认为协程由用户而不是操作系统（或准并行）**来实现分时。**协程在分配给运行这些协程的线程的同一核心上运行。

协程是否实现了并行性？如果它是受 CPU 限制的代码，则不会。就像分时共享一样，它让您感觉它们是并行运行的，但它们的执行是交错的，而不是重叠的。如果它是 IO 绑定的，是的，它通过硬件（IO 设备）而不是您的代码实现并行。

湾。与函数调用的区别？

[![在此处输入图像描述](https://i.stack.imgur.com/NMETU.png)](https://i.stack.imgur.com/NMETU.png)

如图所示，它不需要调用`return`来切换控制。它可以在没有`return`. 协程在当前函数帧（堆栈）上保存和共享状态。因此，它比函数轻量级得多，因为您不必将寄存器和局部变量保存到堆栈并在`call ret`.

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-06-02T22:20:25.880

协程是一种特殊的子程序。与传统子程序中存在的调用者和被调用子程序之间的主从关系不同，调用者和被调用协程更加公平。

*   协程是具有多个条目并自行控制它们的子程序——在 Lua 中直接支持

*   也称为对称控制：调用者和被调用的协程在更平等的基础上

*   协程调用被命名为简历

*   协程的第一次恢复是到它的开头，但随后的调用在协程中最后执行的语句之后的点处进入

*   协程重复地相互恢复，可能永远

*   协程提供程序单元（协程）的准并发执行；它们的执行是交错的，但不重叠

[![示例 1](https://i.stack.imgur.com/udtJn.png)](https://i.stack.imgur.com/udtJn.png) [![示例 2](https://i.stack.imgur.com/2tZaW.png)](https://i.stack.imgur.com/2tZaW.png)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2021-09-07T09:56:32.080

## 协程作为并发的实现和多线程的替代方案。

协程是实现并发的单线程解决方案。

```
 A-Start ------------------------------------------ A-End   
           | B-Start -----------------------------------------|--- B-End   
           |    |      C-Start ------------------- C-End      |      |   
           |    |       |                           |         |      |
           V    V       V                           V         V      V      
1 thread->|<-A-|<--B---|<-C-|-A-|-C-|--A--|-B-|--C-->|---A---->|--B-->| 
```

与多线程解决方案相比：

```
thread A->|<--A|          |--A-->|
thread B------>|<--B|            |--B-->|
thread C ---------->|<---C|             |C--->| 
```

* * *

*   协程是异步编程的一种实现，异步编程是用来实现并发的。
*   许多语言使用协程实现异步编程。其他答案表明 Python、Kotlin、Lua、C++ 已经这样做了。
*   最有用/通常用于涉及 I/O 绑定问题的场景，例如在获取数据时呈现 UI，或从多个数据源下载。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-04-12T04:01:34.870

另一方面，python`gevent`库是一个`coroutine`基于网络库的网络库，它为您提供异步网络请求等类似线程的功能，而无需创建和销毁线程的开销。使用的`coroutine`库是`greenlet`.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-05-31T08:58:29.713

来自[Python 协程](https://docs.python.org/3/reference/compound_stmts.html#coroutine-function-definition)：

> Python 协程的执行可以在很多时候暂停和恢复（参见协程）。在协程函数体内，await 和 async 标识符成为保留关键字；await 表达式、async for 和 async with 只能在协程函数体中使用。

来自[协程 (C++20)](https://en.cppreference.com/w/cpp/language/coroutines)

> 协程是一个可以暂停执行以稍后**恢复****的** 函数。协程是无堆栈的：它们通过返回调用者来暂停执行。这允许异步执行的顺序代码（例如，在没有显式回调的情况下处理非阻塞 I/O），并且还支持惰性计算无限序列和其他用途的算法。

 ****与其他人的答案比较：**

在我看来，**后面恢复**的部分是核心区别，就像@Twinkle 的一样。
尽管文档的许多领域仍在进行中，但是，这部分与大多数答案相似，除了@Nan Xiao 的

> 另一方面，协程是协作的：在任何给定时间，具有协程的程序只运行它的一个协程，并且这个正在运行的协程只有在它明确请求暂停时才会暂停其执行。

由于引用自Program in Lua，可能与语言有关（目前对Lua不熟悉），并非所有文档都提到了**唯一的**一部分。

**与并发的关系：**[协程 (C++20)](https://en.cppreference.com/w/cpp/language/coroutines)
中有一个“执行”部分。此处引用太长。 除了细节之外，还有几个状态。

```
When a coroutine begins execution  
When a coroutine reaches a suspension point  
When a coroutine reaches the co_return statement  
If the coroutine ends with an uncaught exception  
When the coroutine state is destroyed either because it terminated via co_return or uncaught exception, or because it was destroyed via its handle 
```

作为@Adam Arold 在@user217714 的回答下的评论。是并发。
但它与多线程不同。 [来自 std::thread](https://en.cppreference.com/w/cpp/thread/thread)

> 线程允许多个函数同时执行。线程在构造相关线程对象后立即开始执行（等待任何 OS 调度延迟），从作为构造函数参数提供的顶级函数开始。顶级函数的返回值被忽略，如果它通过抛出异常终止，则调用 std::terminate。顶级函数可以通过 std::promise 或通过修改共享变量（可能需要同步，参见 std::mutex 和 std::atomic）将其返回值或异常传达给调用者

由于它是并发的，它的工作方式就像多线程，特别是在等待是不可避免的时候（从操作系统的角度来看），这也是它令人困惑的原因。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-12-03T01:16:30.073

如果您仍然感到困惑，这里有一个非常简单的理解 a 的方法`co-routine`。首先，什么是a `routine`？用外行人的话说，例行公事是我们一次又一次地做的事情（例如，你早上的例行公事）。相似地。在编程语言中，a`routine`是一段我们反复使用的代码，例如`a function`. 现在，如果您查看 a 的一般特征`function or routine`（注意：我谨慎地交替使用这两个术语），只要函数需要输出结果，它就会占用一些输入并占用 CPU 线程。意思是，`functions or routines`在你的代码中阻塞调用。然而，一个`co-routine`是一种特殊的例程，可以与其他例程同时共存（co-routine 一词的“co”部分来自于此），我们可以在异步编程的帮助下在编程语言中实现这一点。在异步编程中，当一个协程在等待某件事发生时（例如，磁盘 io），另一个协程将开始工作，当这个协程处于等待状态时，另一个协程最终将处于活动状态减少我们代码的等待时间。

如果你理解了上面的内容，让我们看看如何在 Python 中创建协程函数。您可以定义一个协程函数如下 -

```
async def my_coroutine_function():
    return 123 
```

`await`您可以通过在协程前面添加来调用上述协程-

```
my_result = await my_coroutine_function() 
```

总而言之，

当你在看电视节目时，一旦广告出现，你就拿起手机给朋友发短信——你刚刚做的就是异步编程。当您的电视节目（协同程序）处于等待状态时，您继续并让您的其他协同程序（给您的朋友发短信）处于活动状态。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-03-24T20:01:57.613

我将扩展 @user21714 的答案。协程是不能同时运行的独立执行路径。它们依赖于控制器（例如`python`控制器库）来处理这些路径之间的切换。但是为了使这个工作协程本身需要调用`yield`或类似的结构，允许它们的执行被暂停。

相反，线程在独立的计算资源上运行并且彼此并行。由于它们位于不同的资源上，因此无需调用*yield*来允许其他执行路径继续进行。

您可以通过启动一个多线程程序（例如一个`jvm`应用程序）来看到这种效果，其中所有八个超线程内核都被利用：您可能会在或`core i7`中看到 797% 的利用率。相反，当运行一个典型的程序时——即使是一个带有或的程序——利用率将达到 100%。即*一*台机器超线程。`Activity Monitor``Top``python``coroutines``python threading`

 ** * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-12-06T14:48:11.543

[[同步​​与异步]](https://stackoverflow.com/a/49386140/4770877)

[[并发与并行]](https://stackoverflow.com/a/63744581/4770877)

通常我们的想法是——协程是轻量级线程，它们允许我们以同步的方式编写异步、非阻塞代码

至于 Kotlin 协程：

协程是一个合成的糖/附加层，它允许你以**非阻塞方式**运行一个大任务并且**没有回调**。协程由一些类( `Job`, `Dispatcher`, `Scope`, `Builder`) 和`body`

[![在此处输入图像描述](https://i.stack.imgur.com/EZMsx.png)](https://i.stack.imgur.com/EZMsx.png)

让我们回顾一些例子

```
suspend fun downloadFile(): File {
    //logic
}

suspend fun saveFile(file: File) {
    //logic
}

GlobalScope.launch {
    val downloadResult = downloadFile() //suspend function
    show(downloadResult) //UI 
    saveFile(downloadResult) //suspend function
} 
```

它创建具有功能`Continuation`的类`state machine``invokeSuspend()`

```
class Continuation {
    File file;

    void invokeSuspend(Object result) {
        switch (label) {
            case 0: {
                label = 1;
                downloadFile(this); //suspend function
                return;
            }
            case 1: {
                file = (File) result;
                show(file); //UI
                saveFile(file, this); //suspend function
                return;
            }
        }
    }
} 
```

**暂停**

*   只是使用的标记`Continuation`- 将延续传递给函数
*   划分状态机，这意味着它**可以**暂停机器
*   应该在里面使用回调`Continuation.resume() -> Continuation.invokeSuspend()`

`coroutine`行为完全取决于库实现的要点

# .net - 州/地区/省的命名约定

> ID：553705
> 
> 赞同：25
> 
> 时间：2009-02-16T15:36:44.237
> 
> 标签：.net, localization, naming-conventions, state, region

我正在建立一个代表美国州或加拿大省的课程。类应该叫什么？

一些想法：

*   **Region：**问题在于 .Net 有一个 RegionInfo 类，它使用术语 Region 来表示一个国家（而不是一个州或省）。
*   **状态：**问题在于它可能会导致与应用程序状态或会话状态等混淆......
*   **省：**可以工作，但非常以加拿大为中心。就是感觉不对。

* * *

**编辑：** GeographicalRegion 似乎是要走的路。它甚至可以用作其他地理区域类型（即：国家）的基类，并且仍然有意义。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-16T15:39:34.447

GeographicalRegion 将是我的选择。它非常简短且完全明确，并且与省或州等实际类型的区域没有任何含义。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-16T15:41:07.720

绝对不要使用“State”——太令人困惑了，“Territory”也有 .ca 含义。维基百科建议“Subnational”或“SubnationalDivision”会很好。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-16T15:59:21.843

State 的一个更通用的名称，适用于世界任何地方，是 CountrySubdivision，或只是 Subdivision。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-09-10T13:45:49.050

`administrative_area_level_1`谷歌在他们的地理编码器中使用了这个术语。

**Administrative_area_level_1**表示国家级以下的一级民事实体。在美国，这些行政级别是州。并非所有国家都表现出这些行政级别。 **Administrative_area_level_2**表示国家级以下的二级民事实体。在美国，这些行政级别是县。并非所有国家都表现出这些行政级别。 **Administrative_area_level_3**表示国家级以下的三级民事实体。这种类型表示轻微的民事部门。并非所有国家都表现出这些行政级别。

参考：[http ://code.google.com/apis/maps/documentation/geocoding/#Types](http://code.google.com/apis/maps/documentation/geocoding/#Types)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-16T15:51:51.080

我认为没有问题`State`；在您使用它的上下文中，我不希望与应用程序状态有任何混淆。在您使用它的任何地方，您也会指代`Country`、`StreetName`和`PostCode`，对吗？同样，如果您选择命名它`Region`。

不过，我不喜欢`Region`，因为它相当模糊。各种事物都是区域。如果有人问我住在哪个地区，我可能会说中西部。或者西半球。或拉姆齐县。这一切都取决于上下文。

你和那些在你的项目上工作的人应该已经知道上下文，所以使用一个有意义的词。不要担心这个词在其他上下文中是否有意义；你没有和那些一起工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-05T16:31:02.737

经过一番考虑，我意识到在我的情况下，要求是指定要搜索的区域，所以我选择了**IAreaLocator**。这个想法是实现的区域定位器将允许指定非有限区域。它们可以是地理围栏、州、省、国家等。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-16T15:41:12.167

州或省

# c - 这真的是缓冲区溢出吗？

> ID：553708
> 
> 赞同：3
> 
> 时间：2009-02-16T15:36:48.433
> 
> 标签：c, static-analysis, buffer-overflow, string-literals

我们使用的静态分析工具将类似于以下的 C 代码标记为严重缓冲区溢出。

```
#define size 64
char  buf [size + 1] = "";
memset (buf, 0, size + 1); 
```

该工具的错误信息是： **Buffer Overflow** (Array Index Out of Bounds): The array 'buf' size is 1\. Array 'buf' may use the 0..64 index。

这是合法的吗？将字符数组分配给空字符串是否真的导致其长度减少到单个字节，就好像它被定义为一样`char buf [] = "";`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-16T15:40:25.833

除了 char buf[size+1] 因为 size 是运行时值而无法编译的事实之外，假设您可以将 buf 构建为大小为 65 的数组，那么 memset(buf, 0, 65) 不会溢出。

很可能你的工具被你的语法问题弄糊涂了。

[编辑：更多信息]

根据对我原始帖子的评论，我提出以下建议：

```
#define size 64
char buf[size+1];
strcpy(buf, "");
memset(buf, 0, size+1); 
```

我相信 Rob Kennedy 是正确的；您的工具使用空字符串初始值设定项作为数组大小，而不是静态数组声明。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T01:38:07.053

将 "" 分配给 buf[size+1] 不会重置 buf 的大小，但它没有意义，因为它复制了后续 memset 所做的一小部分（并且它混淆了您的静态分析工具 - 您可能想要归档针对它的错误报告）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T02:06:19.170

这不是缓冲区溢出。

这可能是一种更清洁的方法。当然它需要更少的代码行。

```
#define size 64
char buf[size + 1] = {0}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T15:44:21.427

这是合法的 - 缓冲区足够大。该工具警告您 size_t 可能大于 int 并且尝试将其用作索引器可能会导致不可预测的结果。

# c# - 如何同步这些线程以避免数据损坏？

> ID：553737
> 
> 赞同：2
> 
> 时间：2009-02-16T15:43:35.733
> 
> 标签：c#, multithreading

TL;DR 版本：我有两个线程。其中一个可能需要 Interrupt() 另一个，但前提是另一个线程正在处理与受第一个线程影响的对象相关的数据。我怎样才能根据某些条件只中断（）第二个线程。

我一直在开发一个程序，该程序启动两个线程来处理套接字数据并使用信息更新 GUI。两个线程（topologyThread 和 dataThread）处理我的应用程序的两个不同方面，即我们的无线传感器网络的拓扑更改通知，以及用于接收和处理来自无线传感器网络的数据的数据信息。

当数据进入dataThread时，有可能数据包所代表的网络成员已经被topologyThread移除，因此不应该被处理。所以，我在想，使用 Thread.Interrupt() 方法可以让我立即通知 dataThread 拓扑的变化，并防止我们在尝试使用网络成员的数据更新 GUI 时看到的一些问题不再连接。我的问题是：如何判断 dataThread 是否需要中断？我不希望它在为仍然连接的网络成员处理数据时引发异常，但如果它正在为随后断开的网络成员处理数据，我希望它被中断。

场景一：

*   数据来自 dataThread。
*   dataThread 确保网络成员仍然是网络的一部分。
*   dataThread 将数据处理到最后并更新 GUI

场景二：

*   数据来自 dataThread。
*   dataThread 确保网络成员仍然是网络的一部分。
*   网络成员已断开连接，因此不会进行任何处理。

场景 3：

*   数据来自 dataThread。
*   dataThread 确保网络成员仍然是网络的一部分。
*   dataThread 开始处理数据
*   topologyThread 收到网络成员断开连接的通知并将其从拓扑中删除。
*   dataThread 尝试为不再连接的网络成员更新 GUI。

这是我正在尝试编写的场景 3。在我们的测试中，这种情况是侧边栏中的树视图冻结并且必须终止应用程序。但是如果受topologyThread影响的对象是dataThread当前正在作用的对象，我只需要中断dataThread。

谢谢阅读。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T15:53:14.477

你不应该打断你的线程。使用 EventWaitHandles 对这些进行编程可能会更安全，它可以根据您想要实现的目标触发信号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T16:03:55.810

> dataThread 尝试为不再连接的网络成员更新 GUI。

如果您让 topologyThread 在网络成员不再连接时设置一个标志，并让 dataThread 在尝试更新 GUI 之前检查该标志怎么办？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T16:00:23.383

Interrupt() 仅在线程被阻塞时才有效……因此您需要另一种机制来停止处理。如果您有一个正在处理数据的循环，最好的方法是有一个变量，如果它被设置，它将终止处理。

这就是我将如何做到的......

```
Thread dataThread;
bool continueProcessing = true;
String currentNetworkMember = "";

public NotifyMemberRemoved(String member)
{
   if (currentNetworkMember == member)
   {
         continueProcessing = false;
         // Incase the thread is blocked...
         dataThread.Interrupt();
   }
}

public void ProcessingLoop()
{
    while (true)
    {
        currentNetworkMember = GetMemberToProcess();
        continueProcessing = true;
        while (continueProcessing)
        {
            try 
            {
               // Process data...
               ReadDataChunk();
               ProcessDataChunk();
            }
            catch (InterruptedException e)
            {
               // Whatever interrupted us must have set continueProcessing to false...
            }
        }
        UpdateGUI();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T16:04:04.810

基础版。增强以满足您的需求。

```
public class CancellationInfo {
    bool _Cancel = false;
    bool _Sync = new object();
    public bool Requested { get { lock(_Sync) { return _Cancel; } }
    public void Request() { lock(_Sync) _Cancel = true; }
}

public class ThreadActions {
    private CancellationInfo Cancel = new CancellationInfo;
    public void FirstThreadAction() {
        while(true) {
            //Process some stuff.
            if(condition)
               Cancel.Request();
        }
    }
    public SecondThreadAction() {
        while(true) {
            if(Cancel.Requested)
                break;
            //Process some stuff.
        }
    }
} 
```

# user-interface - 多平台 .net 应用程序的 UI

> ID：553746
> 
> 赞同：1
> 
> 时间：2009-02-16T15:46:41.107
> 
> 标签：user-interface, multiplatform

我想让我的程序在 Linux 上运行，但我不知道如何处理 UI。现在我正在使用 WPF，但 Mono 可能不会很快支持它。UI 控件由非 UI 代码直接编辑。

切换到 Windows 窗体将是最简单的，但我认为它在 Linux 上看起来并不好。

我现在的梦想是拥有某种抽象 UI，它提供标准控件（带有标准成员），并使非 UI 代码远离其他代码。因此，我必须将抽象 UI 中的更改转换为具体 UI。这将是很多工作，但代码将是高度可重用的。

你会怎么做，你对最后一个想法有什么看法？

（如果它不需要在 Windows 上安装任何新东西，那就太好了。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T16:02:30.337

我自己没有使用过，但你可以看看[wx.NET](http://wxnet.sourceforge.net/)，它是[wxWidget](http://www.wxwidgets.org/)的 .net 包装器（我已经将后者用于跨平台 UI 设计并且非常喜欢它们 :-)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T15:50:08.853

一个简单的建议可能是[GTK#](http://www.mono-project.com/GtkSharp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T15:55:18.343

我一直使用 Gtk#，但它在 Windows 应用程序中真的*很难*看，你可以在 Mono 的最后一个版本中使用 Windows Forms 2.0。或者您甚至可以使用此[http://code.google.com/p/qt4dotnet/将 Trolltech 的 Qt 4 与 .net 一起使用](http://code.google.com/p/qt4dotnet/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-21T13:00:07.787

我现在使用实现 IButton 等接口的 Wrapper 类。

如果它长期有效，我会将代码上传到某个地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-22T18:59:35.527

您可能正在寻找类似[Eto.Forms](https://github.com/picoe/Eto)的东西，它是一个 .NET 库，可让您编写单个通用 UI，然后使用 WinForms、GTK# 或 MonoMac/Cocoa 将其转换为本机工具包。

使用这种方法的好处是您的应用程序在每个平台上都看起来是原生的。

还有 WPF 和 iOS 端口正在开发中，您可以在它们准备好时切换到它们。

# jsp - Spring MVC Webapp：在哪里存储常见图像的路径？

> ID：553749
> 
> 赞同：1
> 
> 时间：2009-02-16T15:49:18.793
> 
> 标签：jsp, spring-mvc, themes, jstl, resourcebundle

我正在构建一个使用 Tiles/JSP 作为视图技术的 Spring MVC Web 应用程序。以前我将常见图像的路径存储在 Common 类中：

```
 public final static String IMG_BREADCRUMBS_NEXT = "/shared/images/famfam/bullet_arrow_right.png"; 
```

然后我会在jsp中使用这个类来获取图像src

```
 <img src="<%= Common.IMG_BREADCRUMBS_NEXT %>"/> 
```

我想摆脱我的 jsp 代码中的 scriptlet 并改用 jstl 等。存储此类信息的最佳方式是什么？是资源包吗？你是怎么解决这个问题的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T05:55:10.083

最后我使用了 Spring 的主题支持来实现我想要的。在我的视图代码中，我使用`<spring:theme code=""/>`标签来获取图像文件的路径：

```
 <img src="<spring:theme code="theme.images.actions.edit.link"/>" /> 
```

这个标签的行为类似于任何`<fmt:message>`或`<spring:message>`标签，但它有自己的“消息包”。我的 applicationContext 中的必要配置是：

```
 <!-- 
    ========================================================= 
    Themes
    =========================================================
  -->
<bean id="themeResolver" class="org.springframework.web.servlet.theme.SessionThemeResolver">
    <property name="defaultThemeName" value="themes.default"/>
</bean>
<bean id="themeSource" class="org.springframework.ui.context.support.ResourceBundleThemeSource" /> 
```

我的应用程序的所有主题都存储在`/WEB-INF/classes/themes/`. 默认主题属性在`/WEB-INF/classes/themes/default.properties` 它看起来像这样：

```
 ...
 theme.images.actions.show.link=/@contextPath@/shared/images/famfam/zoom.png
 theme.images.actions.delete.link=/@contextPath@/shared/images/famfam/cross.png
 ... 
```

要更改我的应用程序的主题（和图标），我使用 ThemeChangeInterceptor（在 applicationContext 中）

```
<!--
========================================================= 
Theme resolving
=========================================================
--> 
<bean id="themeChangeInterceptor" class="org.springframework.web.servlet.theme.ThemeChangeInterceptor">
    <property name="paramName" value ="theme" />
</bean> 
```

这使用户能够通过`"&theme=themes.default"`或`"&theme=themes.alternative"`请求参数切换主题。

我的设置的一个关键部分是`@contextPath@`在主题属性文件中。这在 Ant 构建过程中被替换为开发/测试/生产环境的正确上下文路径。我的 build.xml 的关键部分是：

```
 <!-- copy all common themes to classes -->
    <copy todir="${build.war}/WEB-INF/classes/themes" overwrite="true" filtering="true">
        <fileset dir="resources/themes" includes="**/*.properties" />
        <filterchain>
           <replacetokens>
                <token key="contextPath" value="${setup.contextPath}"/>
            </replacetokens>
        </filterchain>
    </copy> 
```

我希望这能给你一个关于 Spring Web 应用程序主题的“运行开始”。在我看来，这种设置可以很容易地改变应用程序的外观和感觉。

参考：

*   春季主题：[http ://static.springframework.org/spring/docs/3.0.x/spring-framework-reference/html/ch16s07.html](http://static.springframework.org/spring/docs/3.0.x/spring-framework-reference/html/ch16s07.html)
*   FamFam 图标： http: [//www.famfamfam.com/lab/icons/silk/](http://www.famfamfam.com/lab/icons/silk/)
*   Ant 复制任务：[http ://ant.apache.org/manual/Tasks/copy.html](http://ant.apache.org/manual/Tasks/copy.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T16:05:35.867

在应用程序范围内使用配置 bean，因此您可以编写类似

```
<img src="${configuration.imagePath}/icon.png"> 
```

我不使用 Spring，但您可能可以使用依赖注入来做类似于我们在 JBoss 和 Seam 中所做的事情。

基本上，我们有一个名为 Configuration 的 POJO 类，它的属性是应用程序的配置参数，从 XML 配置（实际上是 JBoss MBean，但这是题外话）加载。在这个例子中，我们的 bean 会有一个`getImagePath()`方法。

Seam 将负责在“应用程序”范围内实例化配置 bean 的单个实例，以便它始终可以在表达式中使用，就像上面的那个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-06T20:58:04.807

使用基于数据库确定主题的类不是更健壮吗？这将允许用户管理主题，甚至根据时间或用户代理实现主题？

是否可以这样做并同时使用弹簧主题，以将主题保存在用户会话中？

# java - 使用 JDBC 在 Sybase 中检查列是否自动递增

> ID：553751
> 
> 赞同：1
> 
> 时间：2009-02-16T15:50:07.933
> 
> 标签：java, jdbc, metadata, sybase

要检查列是否自动递增，我可以执行以下操作

```
Connection con = ...    
DatabaseMetaData meta = con.getMetaData();
ResultSet metaCols = meta.getColumns(catalog, schema, table, "%");
while ( metaCols.next() )   
     String value = rs.getString("IS_AUTOINCREMENT")    
  ... 
```

除了 Sybase 数据库外，工作正常。我已经使用 jTDS 和 JConnect 驱动程序进行了尝试，但是使用这两个驱动程序我都得到了这个异常：

```
java.sql.SQLException: Invalid column name IS_AUTOINCREMENT. 
```

是否有另一个 get 发现，Sybase 中的列是否自动递增？我认为“IS_AUTOINCREMENT”是 JDBC4 的一项功能，而 jTDS 是 JDBC4 兼容的驱动程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T16:31:56.053

Sybase 使用“identity”列而不是“default autoincrement”，这就是我相信您会收到此消息的原因。

尝试检查 TYPE_NAME 列是否包含关键字“身份”。

身份列的行为也有点不同，但这是一个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T13:10:26.983

抱歉，我误解了你在下面使用 sp_help 发现如果标识列包含 1 则该列是标识。

还有其他可用的方法。如果我知道您会对 SQL 命令（例如 sp_help、sp_columns 和从 systemtables 中进行选择）感到满意，那么我可以在几秒钟内给您答案，我当时正专注于 Java 方法。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T09:30:53.157

您使用的是哪个版本的 JConnect？尝试使用 6。它应该可以使用：

数据库元数据.getTypeInfo()

PS。对不起，新来的网站，没有足够的积分来评论你的帖子:(

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T12:16:25.067

sp_help 提供了我需要的所有信息。此 SP 返回几个 ResultSet。第三个 ResultSet 包含我需要的信息。

```
Statement stmt = con.createStatement();
stmt.executeQuery("sp_help " + table);
stmt.getMoreResults();
stmt.getMoreResults();
ResultSet rs = stmt.getResultSet();
//...
while( rs.next() )
   boolean identity = rs.getBoolean("Identity"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-25T22:28:16.390

这是获取身份信息的最简单方法

```
 ResultSet tableInfo = tableInfoQuery.executeQuery("SELECT * FROM " + tableName + " WHERE 1=2");
ResultSetMetaData rsMetaData = tableInfo.getMetaData();
for (int i = 1; i < = rsMetaData.getColumnCount(); i++)
{rsMetaData.isAutoIncrement(i);} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-19T07:57:53.307

如果要查询以检查列是否标识，可以使用 system table `syscolumns`。因此，根据[sybase 信息中心](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc36274.1570/html/tables/X14340.htm)`status`，syscolumns中列的值 128是标识。

```
select * from sysobjects so
inner join syscolumns sc on so.id=sc.id
where so.name='EX_EMPLOYEE' and sc.name='ID' and sc.status=128 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-08-07T14:15:13.470

```
Connection conn; <...create connection...>
ResultSet rs1 = conn.createStatement().executeQuery("SELECT * FROM table1");
ResultSetMetaData rsmd1 = rs1.getMetadata();
for (int i=1;i<rsmd1.getColumnCount();i++) { 
switch (rsmd1.getColumnTypeName(i).toUpperCase())
  case "ID":
    System.out.println("Identity column: " + rsmd1.getColumnName(i));
    break;
  default: 
}
} 
```

# java - JFlex 中可以继承吗？

> ID：553757
> 
> 赞同：0
> 
> 时间：2009-02-16T15:51:51.097
> 
> 标签：java, parsing, xpath, jflex, jsyntaxpane

我对 JFlex 和 JSyntaxPane 还很陌生，尽管我已经设法[为 XPath 编写了一个词法分析器](http://code.google.com/p/jsyntaxpane/source/browse/branches/r095/jsyntaxpane/src/main/jflex/jsyntaxpane/lexers/xpath.flex)。

我发现自己遇到的问题是我正在开发一个项目，该项目支持具有一些专有特性的 XPath 子集。恶心我知道。

如果这是一个常规的 Java 问题，我会转向继承，但似乎不可能通过让一个词法分析器扩展先前生成的词法分析器来实现继承。

例如

```
import jsyntaxpane.Token;
import jsyntaxpane.TokenType;

%% 

%public
%class ProprietaryLexer
%extends XPathLexer
%unicode
%char
%type Token 
```

这似乎会导致大量错误告诉我我无法扩展某些最终方法。这是 JSyntaxpane 中 DefaultJFlexLexer 特有的问题，还是我做错了？有没有人遇到过类似的情况，并找到了一种在一堆词法分析器中实现某种特殊继承的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T16:39:04.383

JFlex 会生成几个最终方法，因此会出现错误。我可以想到两种可能的解决方法：

1.  只需将规则复制`XPathLexer`到`ProprietaryLexer`并根据需要扩展它们。
2.  （危险）将骨架文件修改为没有最终方法，然后照常进行。我从来没有尝试过这个，所以我不能保证它甚至会编译。

`%inherit`不过，如果 JFlex 有一个命令，那肯定会很好。

# javascript - 像javascript一样在as3中转义字符

> ID：553758
> 
> 赞同：2
> 
> 时间：2009-02-16T15:52:05.150
> 
> 标签：javascript, actionscript-3, utf-8

我无法在 as3 中转义特殊字符。

```
trace( escape("who are ü?") ); 
```

返回谁%20are%20%uFFFD%3F

或者

```
trace( encodeURIComponent("who are ü?") ); 
```

返回谁%20are%20%EF%BF%BD%3F

而在 javascript 这个

```
alert( encodeURIComponent("who are ü?") ); 
```

返回谁%20are%20%C3%BC%3F

和

```
alert( escape("who are ü?") ); 
```

返回谁%20are%20%FC%3F

有什么建议如何让 as3 像 javascript 一样返回转义的特殊字符？为什么 as3 明显窒息？

（这是一个很好的参考：[http](http://www.ultrashock.com/forums/actionscript/as3-escape-vs-as2-escape-122046.html) ://www.ultrashock.com/forums/actionscript/as3-escape-vs-as2-escape-122046.html ）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T16:31:41.530

看起来 AS 将字符串转义为 UTF-16，而 Javascript 示例转义为 UTF-8。[`escape`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions#escape_and_unescape_functions%28Obsoleted_above_JavaScript_1.5%29)没有定义如何处理非 ascii 字符，因此从 JavaScript 1.5 开始它已被弃用。您应该改用该函数[`encodeURIComponent`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURIComponent)，该函数被定义为转义为 UTF-8 - 这在不同的实现中应该是一致的。如果您需要 AS 行为，我认为 Javascript 中没有本机函数，但您可以使用[此处](http://rishida.net/scripts/uniview/conversion.php)提供的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T03:18:57.560

尽管我的 IDE (intellij) 正在显示、保存和加载特殊字符，但它们被保存在 1252 中。切换到 UTF-8 已解决此问题。

# java - 有没有办法更改 JDialog 的所有者？

> ID：553759
> 
> 赞同：7
> 
> 时间：2009-02-16T15:52:17.867
> 
> 标签：java, swing, jdialog

我有一个非常具体的问题，我想知道是否有办法更改 JDialog 的所有者（可以使用构造函数设置）。我想没有“官方”的可能性（除了黑客），但我想确保我没有错过任何东西。关于该主题的任何想法或提示都会有所帮助，已经谢谢...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T05:26:06.130

如果您的问题是关于如何在应用程序生命周期中重用对话框，那么更好的方法是：

1.  将所有对话框内容定义为 JPanel 子类
2.  并用现有的 JPanel 子类实例实例化一个新的 JDialog

对于第 2 点，您当然可以对面板使用惰性求值（仅在首次使用时实例化，然后重用）。

您还需要让您的面板实现一些（您自己的）接口，允许您重新初始化它们以便在新的 JDialog 中重用（重新初始化通常意味着擦除所有字段内容，或将这些字段设置回它们的默认值）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T16:37:11.033

我能想到的唯一事情属于不安全的黑客攻击（使用反射并更改所有者，但这可能会在不同版本的 JVM 下发生变化（即使来自同一平台上的同一供应商））。

也许你要问的一个更好的问题是“这就是我正在尝试做的......我真的需要更改对话框的所有者还是有更好的方法”？我正在想办法想改变主人的理由，但我想不出任何...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T17:09:34.037

Ĵ：

当表格单元格中的文本太长而无法显示时，我也需要在我的应用程序中使用单个“全局”对话框来提供“注释”对话框。在这种情况下，用户可以悬停或右键单击单元格并获得一个显示整个文本的对话框。但是，我希望对话框快速显示，尤其是在悬停时，所以我想简单地显示和隐藏它。我决定创建这个对话框并将其存储在主类中，并以应用程序框架为所有者。然后，只要拥有者是框架的任何视图需要注释对话框，视图就可以从主类中获取它。在对话框需要注释对话框的那些实例中，父对话框可以创建具有适当所有者的注释对话框的新实例。由于这些父对话框（至少在我的应用程序中）在关闭时被释放，额外的注释对话框实例将超出范围并被垃圾收集。希望有帮助。

# c# - 无法在异常构造函数中写入字符串

> ID：553762
> 
> 赞同：2
> 
> 时间：2009-02-16T15:54:00.810
> 
> 标签：c#, .net, visual-studio-2008

当我将字符串传递给异常参数时，Visual Studio 似乎会抱怨。

```
if (str1 == null || str2 == null)
{
    throw new ArgumentNullException("lmkl");
} 
```

Visual Studio 说它无法解析 symbol `"lmkl"`。

如果我有一个字符串变量（例如上面`throw new... string s = "test";`）并将其作为异常参数包含在内，Visual Studio 对此非常满意。

是什么赋予了？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T15:58:41.627

采用单个字符串参数的重载构造函数的文档`ArgumentNullException`指出该参数应为：

```
导致异常的参数的名称。
```

目前，如果您的代码抛出异常，您将不知道哪个参数为空。

建议重写为

```
if (str1 == null) throw new ArgumentNullException("str1");
if (str2 == null) throw new ArgumentNullException("str2"); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-16T16:12:06.663

**实际上，Visual Studio根本**不关心这个。我假设您安装了[ReSharper](http://www.jetbrains.com/resharper/)？这验证了许多常见错误，包括不正确使用模式等`ArgumentException`。它还具有更好的`null`检查 - 不完全是“合同”，但仍然很有帮助。

只有当它可以看到以已知模式使用的字符串文字时，它才会尝试这样做 - 追逐如何分配变量的分析对于实际分析来说实在是太多了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-19T11:02:21.870

如果您使用的是 ReSharper，这应该会抑制警告（假设 str1 是您的参数的名称）：

```
throw new ArgumentNullException(nameof(str1)); 
```

# javascript - jQuery selector context question

> ID：553766
> 
> 赞同：6
> 
> 时间：2009-02-16T15:54:52.213
> 
> 标签：javascript, jquery

I'm trying to do make the following selection:

```
$(".program", row) 
```

Where "row" is a jQuery object containing two table rows. One of the tr's has the class 'program". This selector doesn't seem to find it. However the following works:

```
$(".title", row) 
```

where div.title is a descendant of tr.program.

If I use a jQuery object as a selector context, am I not able to match top-level elements of that jQuery object?

thanks,

-Morgan

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T18:11:08.453

看起来您正在尝试从您已经选择的元素中选择元素（驻留在 jQuery 对象中）。

就 jQuery 而言，上下文就像指定父级一样 - 上下文是您在 DOM 树中查找的内容之上的某个节点。上下文是 jQuery 将在其中查找您指定的选择器的位置。

如果我对您尝试做的事情是正确的，那么这应该有效：

```
row.filter('.program');

// And then:
row.filter('.program').find('.title'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T16:24:10.643

~~我的理解是上下文需要是根级别，即您要在其中进行选择的父级。~~

**编辑：** 现在已经完成了一些阅读，您应该能够匹配上下文的顶级元素（默认上下文是`document`）。

[Beardscratchers](http://beardscratchers.com/journal/jquery-its-all-about-context)有一篇关于在 jQuery 选择器中使用上下文的好文章。通常，您应该尝试将元素 id 作为 jQuery 包装集的上下文传递，因为它是定位元素的最高效方式。

在内部，选择器上下文是用`.find`方法实现的，所以`$(selector, context)`等价于`$(context).find(selector)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T16:13:03.353

You're on the right path with descendants. Passing context to a selector searches for all descendants found in that context.

In your case, since the object is not a "parent containing two rows", but rather "a collection of rows", .program is not selectable. Since .title **is** an actual descendant in your collection, it is selectable.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-16T16:06:28.907

You most certainly are able to match the top level elements. Could we see the source you're using? Your code should be working, so there's probably a problem in the HTML itself.

# regex - Wordpress 永久链接：仅使用 URL 中的 post_id

> ID：553767
> 
> 赞同：1
> 
> 时间：2009-02-16T15:55:07.000
> 
> 标签：regex, wordpress, .htaccess, seo, permalinks

我正在尝试为我的 wordpress 博客设置 SEO 友好的 URL，同时仍然可以灵活地随意更改帖子的标题。

我的永久链接结构是这样的：

> %post_id%/%postname%

但是，我希望 wordpress 在查找合适的帖子时只考虑 URL 中的 %post_id% （​​有点像 stackoverflow 上的这里）

例如：

**[https://stackoverflow.com/users/810/crossbrowser与](https://stackoverflow.com/users/810/crossbrowser)****[https://stackoverflow.com/users/810/hello-world](https://stackoverflow.com/users/810/hello-world)**相同

我希望所有这些都指向同一个帖子，即 id 为 345 的帖子：

```
http://myblog.com/345/the-name-of-the-post
http://myblog.com/345/any-text
http://myblog.com/345 
```

* * *

该文档提到了一些似乎我正在尝试做的事情：[Long permalinks](http://codex.wordpress.org/Using_Permalinks#Long_Permalinks)，但我无法让它工作。

这是我的 .htaccess 文件：

```
RewriteEngine on
RewriteBase /

# Let wordpress use pretty permalinks
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]

# From the example in the documentation
#RewriteRule /post/([0-9]+)?/?([0-9]+)?/?$ /index.php?p=$1&page=$2 [QSA] 
```

* * *

**更新**

[我一直在这个在线正则表达式测试工具](http://www.gskinner.com/RegExr/)中尝试这个 RewriteRule ，但是当我把它放在我的 .htaccess 中时它不起作用（就在 RewriteBase 之后）：

```
RewriteRule ^([0-9]+)/?([a-zA-Z0-9\-]+)/?$ index.php?p=$1 [QSA] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T16:09:20.743

您可以尝试以下规则：

```
RewriteRule ^(\d+)(/[^/]*)?$ index.php?id=$1 [L,QSA] 
```

但我不知道替换是否正确。你必须自己检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T19:49:59.247

通过使用这个[工具](http://www.gskinner.com/RegExr/)，我能够构建一个匹配列表中所有内容的表达式：

```
http://myblog.com/435
http://myblog.com/435/the-post-title
http://myblog.com/435/the-po
http://myblog.com/435/asdf
http://myblog.com/435/the-9887-title
http://myblog.com/435/123 
```

表达式为：

```
http://myblog.com/([0-9]+)/?([a-zA-Z0-9\-]+)/? 
```

这将转化为这条规则：

```
RewriteRule ^([0-9]+)/?([a-zA-Z0-9\-]+)/?$ index.php?p=$1 [QSA] 
```

但是，它不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T20:42:37.637

我的回答并没有直接回答你的问题，但我认为我有几点值得注意。

> 我正在尝试为我的 wordpress 博客设置 SEO 友好的 URL，同时仍然可以灵活地随意更改帖子的标题。

我没有立即看到你追求的好处。

包含 %post_id% 的明显缺点是它使 URL 更长并且包含非语义信息。Wordpress 已经以两种方式处理这种情况：

1.  当您更改已发布帖子的标题时，网址（永久链接/帖子名称）不会更改。

2.  如果您确实更改了永久链接，旧的永久链接将继续工作并重定向到新的永久链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T17:54:32.627

我几乎通过使用它来工作：

```
RewriteEngine on
RewriteBase /

RewriteRule ^([0-9]+)?/?(^/+)?/?$ /index.php?p=$1 [QSA]

# Allow pretty permalinks
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

但是，它并不总是有效，我不确定我理解为什么（或为什么它应该有效）

它适用于这些：

```
http://myblog.com/435
http://myblog.com/435/the-post-title
http://myblog.com/435/the-po 
```

但不是这些：

```
http://myblog.com/435/asdf (when there's no dash)
http://myblog.com/435/the-9887-title (whenever there's a number in the post title) 
```

有什么帮助吗？

# windows - 在 Windows XP 中使用多个视频卡进行 OpenGL 渲染

> ID：553769
> 
> 赞同：8
> 
> 时间：2009-02-16T15:55:18.200
> 
> 标签：windows, opengl, rendering, nvidia

我正在为 Windows XP 开发一个 OpenGL 应用程序。目标机器有 2 个 NVIDIA GeForce 9800GT 显卡，因为应用程序需要输出 2 个模拟视频流，所以需要这些显卡。

应用程序本身有两个 OpenGL 窗口，每个视频卡一个。每个视频卡都连接到一个监视器。至于代码，它基于一个[最小的 OpenGL 示例](http://www.opengl.org/resources/code/samples/win32_tutorial/minimal.c)。

我如何知道应用程序是否同时使用两个视频卡进行渲染？

目前，我不在乎该应用程序是仅在 Windows XP 上运行还是仅在 NVIDIA 显卡上运行，我只需要知道两者是如何工作的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-11T22:07:06.497

我认为您需要阅读**WGL_nv_gpu_affinity**扩展。您创建亲和力掩码并结合使用 wglMakeCurrent()。这里有一些提示：

[http://developer.download.nvidia.com/opengl/specs/WGL_nv_gpu_affinity.txt](http://developer.download.nvidia.com/opengl/specs/WGL_nv_gpu_affinity.txt)

[来自 NVidia.com 的 PDF](http://www.nvidia.com/content/nvision2008/tech_presentations/Professional_Visualization/NVISION08-8MP_HDR.pdf)

干杯！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T04:16:49.277

我相信您可以从基于 OpenGL 的应用程序的[gDEBugger](http://www.gremedy.com/)获得此类信息。

如果事实证明您没有同时使用这两张卡，您可以查看[Equalizer](http://www.equalizergraphics.com/)进行并行渲染，这是一个很棒的项目。

# c# - 有关自定义 Web 控件的更多信息？

> ID：553771
> 
> 赞同：1
> 
> 时间：2009-02-16T15:55:24.973
> 
> 标签：c#, asp.net, servercontrols

在我目前工作的地方，我们使用了很多手工制作的自定义 Web 控件来处理下拉列表、自动完成框等内容，虽然我在这些控件中添加了一些东西，但我从来没有真正觉得我完全理解我在做什么.

所以，我的问题是，有没有什么好书可以帮助我理解/构建一些自定义 web 控件？

我的环境：.net、c# 3.0、linq 等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T15:58:17.913

这里有一些很好的链接：

[http://msdn.microsoft.com/en-us/library/zt27tfhy.aspx](http://msdn.microsoft.com/en-us/library/zt27tfhy.aspx)
[http://www.15seconds.com/issue/020430.htm](http://www.15seconds.com/issue/020430.htm)
[http://dotnetslackers.com/articles/aspnet/BuildingGroupBoxControl.aspx](http://dotnetslackers.com/articles/aspnet/BuildingGroupBoxControl.aspx)

开发服务器控件也是了解更多关于 ASP.NET 生命周期的好方法。

# asp.net - 如何在 Javascript onunload 元素中进行异步调用？

> ID：553782
> 
> 赞同：2
> 
> 时间：2009-02-16T15:59:51.327
> 
> 标签：asp.net, javascript, html

我有一个系统，当用户查看该项目时，项目被锁定（在数据库中有一个标志）。

目前，该项目仅在用户执行特定操作时解锁。

但是，当用户通过任何方法离开页面时，我想调用一个 webservice / ashx 页面，该页面将解锁该项目，但不会阻止页面更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T16:08:56.017

你所描述的是不可能的。JavaScript 线程/运行时位于加载页面的范围内，因此当页面卸载时，JavaScript 也会被卸载。当异步调用返回并且浏览器已经离开页面时，用户会得到一个 JS 错误。

您可以使您的 Web 服务/AJAX 调用同步并阻塞，直到服务器返回响应，但这当然意味着页面将在卸载之前等待响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T16:35:12.613

在页面加载时使用“心跳”功能保持锁处于活动状态怎么样？每隔 15 秒左右调用一次服务器来更新锁。对您的服务器端代码进行编程，以便如果没有听到来自页面的“心跳”，锁定将在 20 秒后超时。当用户离开页面时，心跳会停止，最多20秒后释放锁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T20:24:34.170

通过使用 body onbeforeunload 事件，我设法让它在 IE7 和 Firefox 3 中工作。我使用 XmlHttpHandler 调用解锁查询的 asp.net http 处理程序。我必须将 state changed 事件处理程序设置为 null，因此它返回时没有 javascript 错误。

事件触发并且页面更改，而不是延迟用户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T16:37:47.257

我认为您应该能够对您的服务器进行同步 XHR 调用。

如果您使用 jQuery：

```
$.ajax({
  async:false,
  url:"your_page.html",
  data:"unlock=true",
  type:"POST"
}).responseText; 
```

因为它不是异步的，理论上它应该暂停浏览器执行，直到返回此调用的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-29T10:17:56.237

这可以使用 Beacon API 解决。

更多关于它[在这里](https://developer.mozilla.org/en-US/docs/Web/API/Beacon_API)

# python - 你可以使用字符串来实例化一个类吗？

> ID：553784
> 
> 赞同：48
> 
> 时间：2009-02-16T16:00:26.787
> 
> 标签：python, design-patterns, reflection

我正在使用构建器模式来分离一堆不同的配置可能性。基本上，我有一堆名为 ID 的类（类似于 ID12345）。这些都继承自基础构建器类。在我的脚本中，每次运行此应用程序时，我都需要为每个类（大约 50 个）实例化一个实例。所以，我想看看是否不做这样的事情：

```
ProcessDirector = ProcessDirector()
ID12345 = ID12345()
ID01234 = ID01234()

ProcessDirector.construct(ID12345)
ProcessDirector.construct(ID01234)

ID12345.run()
ID01234.run() 
```

我可以做这样的事情吗（我知道这不起作用）：

```
IDS = ["ID12345", "ID01234"]

ProcessDirector = ProcessDirector()
for id in IDS:
  builder = id() #some how instantiate class from string
  ProcessDirector.construct(builder)
  builder.run() 
```

这样，当我将来需要添加一个新的时，我所要做的就是将 id 添加到 IDS 列表中，而不是在整个代码中添加新的 ID。

## 编辑

根据数据的来源，似乎有一些不同的意见。这些 ID 被输入到其他人无权访问的文件中。我不是从命令行读取字符串，我希望将来在添加新 ID 时能够做的改动很少。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-02-16T20:34:50.760

如果你想避免 eval()，你可以这样做：

```
id = "1234asdf"
constructor = globals()[id]
instance = constructor() 
```

前提是该类在您当前的范围中定义（或导入）。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-16T22:18:24.443

不确定这是您想要的，但它似乎是一种更 Pythonic 的方式来实例化字符串中列出的一堆类：

```
class idClasses:
    class ID12345:pass
    class ID01234:pass
# could also be: import idClasses

class ProcessDirector:
    def __init__(self):
        self.allClasses = []

    def construct(self, builderName):
        targetClass = getattr(idClasses, builderName)
        instance = targetClass()
        self.allClasses.append(instance)

IDS = ["ID12345", "ID01234"]

director = ProcessDirector()
for id in IDS:
    director.construct(id)

print director.allClasses
# [<__main__.ID12345 instance at 0x7d850>, <__main__.ID01234 instance at 0x7d918>] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-16T18:17:22.727

**`eval()`如果你能帮助它，**永远不要**使用它。Python 有**很多**更好的选择（调度字典，`getattr()`等等），你不应该使用被称为`eval()`.**

 *** * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-16T18:46:28.167

最简单的方法是创建一个字典。

```
class A(object): 
    pass
class B(object): 
    pass

namedclass = {'ID12345': A, 'ID2': A, 'B': B, 'AnotherB': B,  'ID01234': B} 
```

然后使用它（您的代码示例）：

```
IDS = ["ID12345", "ID01234"]

ProcessDirector = ProcessDirector()
for id in IDS:
    builder = namedclass[id]() 
    ProcessDirector.construct(builder)
    builder.run() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-09T15:45:45.580

我决定将接受的[答案](https://stackoverflow.com/a/554812/4329358)和对接受的答案的[评论放在一起。](https://stackoverflow.com/questions/553784/can-you-use-a-string-to-instantiate-a-class#comment6664728_554812)我还添加了重载`__getitem__`，所以这看起来更像是工厂模式。

```
import sys
import traceback
import ipdb

class CarTypes:
    class Toyota:
        def __repr__(self):
            return "Toyota()"
        def __str__(self):
            return "Instance of Toyota() class"
    class Nissan:
        def __repr__(self):
            return "Nissan()"
        def __str__(self):
            return "Instance of Nissan() class"

class Car:
    def __init__(self):
        self._all_classes = {}

    def construct(self, builder_name):
        setattr(self, builder_name, CarTypes())
        try:
            target_class = getattr(CarTypes, builder_name)
            instance = target_class()
            self._all_classes[builder_name] = instance
        except AttributeError:
            print("Builder {} not defined.".format(builder_name))
            traceback.print_stack()

    def __getitem__(self, type_name):
        return self._all_classes[type_name]

    def car_type(self, type_name):
        return self._all_classes[type_name]

IDS = ["Toyota", "Nissan", "Unknown"]

director = Car()
for id in IDS:
    director.construct(id)

print(director["Toyota"])
print(director["Nissan"])
print(director.car_type("Toyota"))
print(director.car_type("Nissan")) 
```

**编辑**：我添加了一些错误处理。

**编辑**：放置在[许可的知识共享许可](https://creativecommons.org/licenses/by/4.0/)下。享受。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T18:08:37.943

你的问题中缺少一些东西，所以我不得不猜测省略的东西。随时编辑您的问题以纠正遗漏。

```
class ProcessDirector( object ):
    # does something

class ID12345( SomeKindOfProcess ):
    pass

class ID001234( SomeKindOfProcess ):
    pass

idList= [ID12345, ID01234]

theProcessDirector = ProcessDirector()
for id in idList:
  builder = id() #Instantiate an object from the class object
  theProcessDirector.construct(builder)
  builder.run() 
```

这非常有效。它不会从字符串实例化——实际上你并不经常想要这个。有时，但很少。更常见的是，您需要从中获取实例对象的类对象列表。

如果您实际上是从命令行获取类名，那么您将进行以下小的更改。

```
validClasses = [ ID12345, ID01234 ]
validMap = dict( ( (c.__name__, c) for c in validClasses ) )
nameStrings = [ "ID12345", "ID01234" ] # from your command-line 
idList= [ validMap[s] for s in nameStrings ] 
```

其他一切都保持不变。

[此外，如果可能，请尝试以小写字母开头的实例变量名称。以大写字母开头的名称通常是类名。]

**编辑**

已删除`eval`。尽管这`eval()`绝对**不是** 一个安全漏洞。仅当有人专门授予恶意用户访问权限时，评估（and `exec`and ）才会成为问题。`execfile`

# c++ - C++ to C# Translator

> ID：553788
> 
> 赞同：0
> 
> 时间：2009-02-16T16:00:48.157
> 
> 标签：c++, code-translation

i found a translator for c++ to c# , but it doesn't work. (Code2Code.net)

Test with cout

```
int main(int argc, char** argv)
{
cout << "Hello World";
return 0;
} 
```

The Results becomes

```
public static int Main(string [] argv) 
{ 
cout << "Hello World"; 
return 0; 
} 
```

My Question to you, is = is it any other translator that works for C++ to C# (dont need to be free)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T16:05:18.817

I am not aware of any as this kind of translation would be *very* difficult to do. You are trying to translate code that was written in an unmanaged language into a language that is managed. Even if you were able to translate the code you would have almost every method marked as `unsafe` which would negate most of the benefits of moving to C# in the first place.

This seems like a bad idea - you ought to be thinking about rewriting the application from scratch.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T16:18:07.227

My suggestions would be to initially use C++/CLI to port over the C++ code to a managed environment. Once working in the managed world, build new code in C# around it. If there are key areas of the existing code that are actively changing, consider porting to C# at that point.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T16:11:46.867

I don't think any translation engine for C++ -> C# could do more than safe a bit of typing on boilerplate code (fix basic syntax) - as the frameworks used in C++ and C# are fundamentally different, and you will run into problems as soon as the translator has to deal with pointers arithmetics and stuff like this.

Given the complex syntax of C++ and the crazy stuff you can do with it (think [Boost](http://www.boost.org)) I guess any translator would run into serious trouble sooner or later. See [this blog post](http://blogs.msdn.com/brada/archive/2005/02/28/382083.aspx) for some alternative suggestions.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T19:38:46.003

Code2Code.net 明确声明

> 您接受此页面只完成了一半的工作。
> 
> ...
> 
> 在大多数情况下，翻译后的代码甚至无法编译。

# .net - .NET Word 2003 加载项可以安装在 GAC 之外吗？

> ID：553794
> 
> 赞同：4
> 
> 时间：2009-02-16T16:02:38.870
> 
> 标签：.net, ms-word, gac

我创建了一个 Word 加载项组件和一个用于安装该组件的 Visual Studio 安装项目。

在安装了 Office 2003 的干净机器上，似乎无法在 Word 中加载加载项组件。

谷歌搜索该问题表明这是因为该程序集不受信任。我使用命令行工具完全信任程序集：

```
caspol -af AssemblyName.dll 
```

这没有任何区别，并且组件仍未在 Word 中加载。caspol 打印出一条消息*“因为所有 GAC 程序集总是获得完全信任，所以完全信任列表不再有意义。您应该安装在 GAC 中的安全策略中使用的任何程序集以确保它们是受信任的”*

更改安装程序以将程序集放入 GAC 中可以使其在 Word 中正确加载。但是该组件将来可能必须使用公共程序集，在我们的其他 .NET 应用程序之间共享，并且将这些库添加到 GAC 是不可取的。

有谁知道如何设置安全性以允许在 GAC 外部安装组件时加载组件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T11:23:15.507

您可以手动运行以下命令来设置安全性，以允许 word 从 GAC 外部运行程序集。这将创建一个具有完全信任的新组，这就是允许程序集运行的原因。

```
caspol.exe -u -addgroup All_Code -url "\*"  FullTrust -n AssemblyName.dll 
```

Microsoft 在以下[指向 MSDN 的站点链接中](http://msdn.microsoft.com/en-us/library/bb332052.aspx)提供了一个安装程序自定义操作示例，这将允许您将此命令作为安装程序自定义操作包含在内。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T16:28:17.607

您绝对不必将程序集安装到 GAC，也不必在加载项程序集上定义任何安全策略。

您是否将 .NET 2.0 与 Office 2003 一起使用？Office 2003 和 Office XP 在加载 .NET 2.0 插件时都存在问题。它们使用 .NET 1.1 Framework 加载（如果机器上存在，这很可能）。**[因此，您需要使用 Microsoft .NET Framework 2.0 (KB908002) 的共享加载项支持更新](http://support.microsoft.com/kb/908002)**修补您的 Office 安装。

您绝对应该将此补丁包含在安装程序的先决条件中。

[在此问题的答案中](https://stackoverflow.com/questions/436958/-net-app-config-question)找到更多详细信息。

当然，您必须在目标系统上安装正确版本的 PIA（几乎忘记了这一点，错误或缺少 PIA 是加载项无法加载的主要问题之一）。

**更新**：KB908002 需要 PC 上的 VS 2005 才能将共享加载项支持更新添加到安装项目的先决条件对话框中。在这种情况下，必须使用以下解决方法：

如果您使用的是 Visual Studio 2008，那么您必须按照下面提到的[解决方法来获取在添加先决条件对话框下列出的 KB908002：](http://blogs.msdn.com/brijs/archive/2008/11/28/issue-prerequisites-packages-is-not-available-for-the-office-add-in-setup-project-developed-using-visual-studio.aspx)

> 1.  在安装了 Visual Studio 2005 的机器上下载并安装此修复程序。
> 2.  导航到*C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\BootStrapper\Packages*，找到 KB908002 文件夹。
> 3.  登录到安装了 Visual Studio 2008 的机器并将 KB908002 文件夹复制到*C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages*
> 4.  现在，如果您转到 Visual Studio 2008 机器上的先决条件列表，您会看到列出的修复程序。

您根本不需要 VS 2005 的另一个选择是：

> 1.  将修复下载到临时文件夹。
> 2.  打开命令提示符，导航到修复程序所在的文件夹并启动以下命令以从自解压安装文件中提取文件：
>     
>     
>     
>     ```
>     vs2005-kb908002-enu-x86.exe /C /T:C:\KB908002\
>     cd \KB908002 
>     ```
>     
>     
>     
>     现在文件夹 C:\KB908002 将包含三个文件，vs2005-kb908002-enu-x86.exe /C /T:C:\tmp\KB908002\tmp、setup.exe 和 bootstrapper.msi
>     
>     
> 3.  我们对 bootstapper.msi 的内容感兴趣，所以我们提取这个文件的内容：
>     
>     
>     
>     ```
>     msiexec /a bootstrapper.msi /qb TARGETDIR=C:\KB908002\tmp\
>     cd tmp 
>     ```
>     
>     
> 4.  最后，我们将解压出来的packages文件夹复制到Windows SDK的bootstrapper文件夹中
>     
>     
>     
>     ```
>     xcopy /E "C:\KB908002\tmp\SDK\BootStrapper\Packages" "C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages" 
>     ```
>     
>     
> 5.  现在，如果您转到 Visual Studio 2008 中的先决条件列表，您会看到列出的修复程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T16:15:05.563

我不认为将加载项程序集放入 GAC 是强制性的。我认为您只是缺少部署中的一步。

诸如 MS Word 之类的办公应用程序通过读取某些注册表项来加载它们的加载项。您很可能不会在部署期间创建这些条目。

要了解所有这些注册业务的详细信息，请参阅[本文](http://msdn.microsoft.com/en-us/library/bb386106.aspx)。另外要阅读有关部署 Office 插件的一般信息，请参阅[这篇](http://msdn.microsoft.com/en-us/library/ms269007(VS.80).aspx)文章

# java - 阅读具有依赖关系的 Jena OntModel

> ID：553810
> 
> 赞同：1
> 
> 时间：2009-02-16T16:06:20.280
> 
> 标签：java, owl, jena

我对本体和耶拿的概念不熟悉，所以我不确定我的措辞是否正确..

我需要将一系列连接的 owl 文件（通过命名空间依赖项？）读入内存中的 Jena 模型（OntModel？），以便可以运行推理。我该怎么做呢？文件的顺序重要吗？我是否需要调用特定方法来“运行推理引擎”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T15:41:19.303

这就是我所做的。它似乎工作

```
 OntModel model = ModelFactory.createOntologyModel();
    for (OwlFile referencedOntology: referencedOntologyList) {
        model.getDocumentManager().addAltEntry( referencedOntology.getNamespace(), referencedOntology.getURI());
    }
    model.read(ontology.getURI()); 
```

该`OwlFile`对象包含本体文件的 URI 及其名称空间。

`referencedOntologyList`包含引用`OwlFile`的列表

`ontology`是`OwlFile`包含主要本体。

# javascript - 如何从 ASP.NET 变量中提供 JavaScript 变量数据？

> ID：553813
> 
> 赞同：27
> 
> 时间：2009-02-16T16:07:41.447
> 
> 标签：javascript, asp.net, escaping, scorm

我已经为我们的 LMS 创建了一个 SCORM API，现在我正在使用硬编码的 userID 和 courseID 变量（引用数据库中事物的变量）。我需要传递真实的用户 ID 和课程 ID，而不是使用硬编码的。我知道用户 ID 存储在会话中，并且课程 ID 是从启动页面传递过来的。

如何将它们放入 JavaScript，以便可以将它们包含在对处理 SCORM 调用的 .ashx 的调用中？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-02-16T16:13:54.350

大概~~最好的~~最容易将它们公开为页面的属性（或母版页，如果在每个页面上使用）并通过页面指令引用它们。

```
 <script type="text/javascript">
     var userID = '<%= UserID %>';
     var courseID = '<%= CourseID %>';

     .... more stuff....
 </script> 
```

然后在 Page_Load（或母版页的 Page_Load）上设置值。

```
 public void Page_Load( object source, EventArgs e )
  {

        UserID = Session["userID"];
        CourseID = Session["courseID"];
        ...
  } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-01-02T19:23:55.213

[@tvanfosson 的回答](https://stackoverflow.com/a/553836/505893)是我过去通常是如何做到这一点的，但只是想想一些更优雅的东西。以为我会把这个扔出去。

您可以在代码隐藏中设置一个 HashTable 并初始化一个`JavaScriptSerializer`：

```
Protected json As New System.Web.Script.Serialization.JavaScriptSerializer
Protected jsvars As New Hashtable 
```

然后像这样设置变量：

```
jsvars.Add("name", "value") 
```

然后将变量序列化为页面中的 JavaScript：

```
<script type="text/javascript">
    var vars = <%=json.Serialize(jsvars)%>;
    alert(vars.name);
</script> 
```

这可以确保所有变量都被正确转义，并且如果您需要使用大量变量，还可以最大限度地减少代码。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-16T18:06:09.883

这里的所有答案都暗示了类似的东西

```
var userID = '<%= UserID %>'; 
```

如果您嵌入的变量可以包含任意字符串数据，那么都缺少一些重要的东西。嵌入的字符串数据需要转义，这样如果它包含反斜杠、引号或不可打印的字符，它们就不会导致您的 Javascript 出错。

[Rick Strahl 对这里](http://www.west-wind.com/weblog/posts/114530.aspx)需要的转义代码有一些建议。使用 Rick 的代码，嵌入变量将如下所示：

```
var userId = <%= EncodeJsString(UserID) %>; 
```

请注意，现在没有引号，Rick 的代码用引号将转义的字符串包装起来。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-16T16:11:39.037

[本文](http://weblogs.asp.net/jgalloway/archive/2008/02/10/getting-javascript-and-asp-net-talking-outside-of-ajax.aspx)介绍~~最务实的解决方案~~几个实用的解决方案来解决您的问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-16T18:55:42.603

以下是您必须采取的步骤：

在您的页面后面的代码中：

```
private int _userId;
private int _courseId;
protected int CourseId
{
  get { return _courseId;}
  set { _courseId = value;}
}
protected int UserId
{
 get { return _userId;}

set { _userId = value;}
} 
```

第 2 步：根据您的要求，您现在必须设置这些属性。问题是这些属性应该在它们被 JavaScript 引用之前设置。`Page_Load`在事件中可能是这样的：

```
_userId = Session["userId"];
_courseId = Request.QueryString["CourseId"] != null ? Request.QueryString["CourseId"] : String.empty; 
```

当然，您可以根据您的要求将它们解析为适当的类型。

最后，您可以在 JavaScript 中引用它们，如下所示：

```
var currentUserId = '<% = UserId %>';
var currentCouseId = '<% = CourseId %>'; 
```

这绝对应该有效。我已经多次使用这种方法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-11-16T17:59:55.070

在[将 .NET 服务器端数据传递给 JavaScript](https://blog.mariusschulz.com/2014/02/05/passing-net-server-side-data-to-javascript)中，我列出了各种方法，包括：

1.  通过发出 AJAX 请求获取数据
2.  通过外部 JavaScript 文件加载数据
3.  使用 SignalR 打开持久连接
4.  将数据附加到 HTML 元素
5.  将数据直接分配给 JavaScript 变量
6.  将 .NET 对象序列化为 JavaScript 文字

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T16:12:07.007

我不确定 SCORM 或 .ashx 文件（没有经验），但就从 ASP.NET 获取值而言，你可以做各种各样的事情，比如

```
var xyz = '<%= variable %>'; 
```

从您的 ASP.NET 页面中。有多种方法可以完成此操作，但最终结果是 ASP.NET 页面呈现发送到浏览器的 HTML（或 JavaScript）中的变量值。

这是一个通用的 ASP.NET 和 JavaScript 答案，可能有更优雅的解决方案适合您。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-16T16:36:46.933

您还可以使用 HTTP cookie。如果您还需要向另一个方向传递值，那么这种方法很好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-19T17:31:43.377

我正在做同样的事情。我只是在 API 对象的构造函数中传递初始化时可能需要的任何值。我没有看到关于如何创建 API 对象的任何要求，只是它在 SCO 代码中的位置。

# postgresql - 如何知道 postgresql 8.3 中时间戳的时区

> ID：553822
> 
> 赞同：17
> 
> 时间：2009-02-16T16:09:21.913
> 
> 标签：postgresql, timezone

我正在使用 postgresql 8.3，我想知道特定时间戳（表中的列）的时区。

在文档中我找到了关键字[“时区”](http://www.postgresql.org/docs/8.3/static/functions-datetime.html)

但我不明白如何将它应用到表格的列中。是否可以 ？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-16T16:22:06.110

我假设您有一个名为的列，该列具有table 中`ct`的类型。然后你可以使用：`TIMESTAMPTZ``t`

```
SELECT EXTRACT(TIMEZONE FROM ct) FROM t; 
```

以秒为单位获取时区的偏移量。它`3600`从`UTC`/给你，`GMT`这意味着要么`GMT+1`，`CET`要么什么。返回的值取决于您的`TIMEZONE`设置。

示例（我住在德国，实际时区是`GMT+1`/ `CET`）：

```
test=# select '2008-01-01 12:00:00 GMT+5'::timestamptz;
      timestamptz       
------------------------
 2008-01-01 18:00:00+01

test=# set timezone to 'gmt';
SET
test=# select '2008-01-01 12:00:00 GMT+5'::timestamptz;
      timestamptz       
------------------------
 2008-01-01 17:00:00+00 
```

如您所见，它始终在配置的时区输出任何内容。因此，您将获得的偏移量`EXTRACT(TIMEZONE FROM ...)`取决于您的`TIMEZONE`设置。给出的时区`INSERT`丢失了，因为它不值得保存。重要的是一切都是正确的，这不应该取决于`TIMEZONE`设置。PostgreSQL 在这方面做得很好。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-30T20:49:21.140

“PostgreSQL 在这方面做得很好。”

我真的很喜欢 PostgreSQL，但在这个特殊的特性中它做得不好。时区不仅偏移到 GMT。时区严格遵守暗示夏令时的政治规则。由于有很多时区具有相同的偏移量和不同的夏令时规则 - 当 PG 忘记原始时区时，它实际上会丢失信息。

就个人而言，我以“美国/纽约”的形式分别存储重要的日期的原始时区。如果有人有更好的解决方案-欢迎。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-09T21:19:17.090

在 Postgres 中，即使您将日期时间值存储在具有时区数据类型的*时间戳中，原始输入时区也会丢失。*

**缺点：**
假设我有日期时间数据（以及时区信息），说明人们何时在世界各地使用他们的 Facebook 应用程序。现在我将这些值存储在时区数据类型的*时间戳中。*随机一天，我想看看人们在早上与晚上相比使用他们的 FB 应用程序的频率有多大，以及是否在不同国家/地区看到了相同的趋势。但是等等，我不再有时区信息。坐在华盛顿特区，我可以看到美国东部标准时间上午 10 点，这项活动如何席卷全球。

**优点：**
如果您正在比较两个具有相同时区时间戳的数据源，但其中一个存储为本地手表显示的内容，而另一个则通过将其转换为 UTC 来存储。在这里，您可以做的只是将时间戳存储在 timestamptz 数据类型中并告诉它属于哪个时区，然后您可以轻松地比较它们。
例如，
PST 时区的活动记录在`2014-10-19 10:23:54`. 现在两个独立的数据源分别存储它。Datasource1 将其存储为`2004-10-19 10:23:54 PST`，Datasource2 将其存储为`2014-10-19 18:23:54 UTC`。如果它们存储在*timestamptz*数据类型中，它将在您执行时显示相同的时间

```
SELECT datasource1.time, datasource2.time 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-19T23:03:55.433

由于 timestampz 是在 ZULU/GMT 时间的瞬间记录的，它永远不会改变它的偏移量（因为它是参考），所以没有必要记录时区。您只需在过去、现在或未来将偏移量添加/减去 GEOPOLITICAL 时区偏移量。

您*确实*需要知道当时适用于过去和现在的时间所在位置的确切地理政治时区。

对于时间目的的未来实例，这可能会变得更加成问题。它应该仍然有效。想想日落。如果某个位置地球有日落@午夜 ZULU 时间（北半球冬季在大西洋或加拿大北部到阿拉斯加的某个地方），并且该时间假定为该位置的晚上 8 点（-4:00 偏移）当您将其记录在系统中并将其记录为“未来的冬季日期晚上 8:00”时，它将在数据库中记录为格林威治标准时间 24:00。

现在，地球上的那个位置在地理相关的时间推算中得到了它的* ss和大拇指它的鼻子，并称他们的时区 - '+11:55'。因此，对于他们来说，当英格兰的午夜（格林威治标准时间午夜）时，他们希望将其称为上午 11:55，这完全是他们的选择。当任何计算机想要显示该位置（即地缘政治时区）的未来日期时，即使太阳正在落山，它们也会将其称为上午 11:55。当然，这将是您计划的那一天 :-) 他们的问题。

# silverlight - 使用代码隐藏而不是 xaml 在 TreeView 中放置复选框

> ID：553823
> 
> 赞同：0
> 
> 时间：2009-02-16T16:09:51.177
> 
> 标签：silverlight

我创建了一个 (System.Windows.Controls.Primitives.)Popup，其中包含一个 Treeview，我正在填充从文件中读取的数据。弹出窗口是在代码中而不是在 xaml 中创建的。我想以与 Silverlight 工具包中的 CheckedTreeViewItemSample.xaml 类似的方式将复选框添加到树视图。

我无法将 xaml 转换为代码，因为我并不真正了解 HierarchicalDataTemplate 的工作原理以及绑定的工作原理。事实上，我发现 Silverlight 对象模型相当混乱！

我已经做了很多搜索，但我还没有找到如何在代码隐藏中做到这一点。我是否需要定义 xaml 并使用 XamlReader？

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T00:43:51.697

您需要将控件放入要添加的 treeviewitems 的 header 属性中：

```
 var myTreeViewItem = new TreeViewItem();
        var myContentHolder = new StackPanel();
        var myCheckBox = new CheckBox();
        TextBlock myTextBlock = new TextBlock();
        myTextBlock.Text = "blah";
        //add more controls
        myContentHolder.Children.Add(myCheckBox);
        myContentHolder.Children.Add(myTextBlock);
        myTreeViewItem.Header = myContentHolder; 
```

瞧。老实说，您是在第一次使用 Silverlight 时执行此操作，然后尝试使用 xaml 执行此操作，并且永远不会再使用代码执行此操作。如果您将要在标题中使用的控件包装为用户控件，也会容易得多。然后您可以将该自定义控件放入另一个文件（当然是基于 xaml 的；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T14:46:56.887

这会在我的电脑上引发错误。在代码隐藏中，我唯一可以放在标题中的东西是文本。

（我相信它与这个[http://silverlight.codeplex.com/WorkItem/View.aspx?WorkItemId=2597](http://silverlight.codeplex.com/WorkItem/View.aspx?WorkItemId=2597)有关）

# c# - 使用 XmlSerializer 序列化整数数组

> ID：553824
> 
> 赞同：4
> 
> 时间：2009-02-16T16:10:51.207
> 
> 标签：c#, .net, serialization, xna

`XmlSerializer`我在尝试为我正在处理的 XNA 项目序列化多维整数数组时遇到问题。我能够顺利地序列化所有其他数据（布尔值、字符串，甚至颜色等）。我还看到很多人声称它们`XmlSerializer`也可以原生处理（一维）整数数组。多维数组是否有限制，或者这里发生了什么？

以下是相关代码：

```
int[,,] scoredata = scores;  // Populated with data elsewhere 

filename = Path.Combine(container.Path, "scoredata.sav"); 
stream = File.Open(filename, FileMode.Create); 
serializer = new XmlSerializer(typeof(int[,,])); 
serializer.Serialize(stream, scoredata);  // This line throws the exception. 
stream.Close(); 
```

我收到的例外是

> System.Xml.dll 中出现“System.InvalidOperationException”类型的未处理异常。生成 XML 文档时出错。

我也尝试过将此数组用作结构中的成员变量（我的所有其他玩家数据都存储在其中），但是在这样做时我也遇到了同样的异常，这让我相信它不是简单的语法错误或类似的东西。

我是否需要重组我的代码以通过一维数组进行序列化，还是我忽略了一些东西？

提前致谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-16T16:17:02.347

阅读内部异常：

*   反映类型“SomeType”时出现错误。无法序列化类型为“System.Int32[,,]”的成员“SomeType.Data”，有关更多详细信息，请参见内部异常。
*   无法序列化 System.Int32[,,] 类型的对象。不支持多维数组。

所以不：不支持多维数组。您可能必须将其作为一维数组填充...您可以通过拥有一个单独的属性来执行此翻译：

```
[XmlIgnore]
public int[, ,] Data { get; set; }

[XmlElement("Data"), Browsable(false)]
[EditorBrowsable(EditorBrowsableState.Never)]
public int[] DataDto
{
    get { /* flatten from Data */ }
    set { /* expand into Data */ }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-27T15:42:40.603

我花了一段时间才弄清楚应该在 Marc 的 get 和 set 大括号中加入什么来展平和扩展多维数组。

这是我的二维数组解决方案。

就我而言，我在编译时知道其中一个维度是 4，因此我不必（以某种方式）存储数组维度。

```
 [XmlIgnore]
    public int[,] Readings { get; set; }
    [XmlArray("Readings")]
    public int[] ReadingsDto { 
        get { return Flatten(Readings); }
        set { Readings = Expand(value, 4); }
    }

    public static T[] Flatten<T>(T[,] arr)
    {
        int rows0 = arr.GetLength(0);
        int rows1 = arr.GetLength(1);
        T[] arrFlattened = new T[rows0 * rows1];
        for (int j = 0; j < rows1; j++)
        {
            for (int i = 0; i < rows0; i++)
            {
                var test = arr[i, j];
                arrFlattened[i + j * rows0] = arr[i, j];
            }
        }
        return arrFlattened;
    }
    public static T[,] Expand<T>(T[] arr, int rows0)
    {
        int length = arr.GetLength(0);
        int rows1 = length / rows0;
        T[,] arrExpanded = new T[rows0, rows1];
        for (int j = 0; j < rows1; j++)
        {
            for (int i = 0; i < rows0; i++)
            {
                arrExpanded[i, j] = arr[i + j * rows0];
            }
        }
        return arrExpanded;
    } 
```

# agile - 有没有一种方法可以在不记录完成一项任务所花费的时间的情况下衡量敏捷开发的成本？

> ID：553843
> 
> 赞同：6
> 
> 时间：2009-02-16T16:17:07.010
> 
> 标签：agile, scrum

想象一下场景，一家企业正在考虑使用 Scrum 方法进行敏捷开发。他们已经为团队系统实施了 Scrum，每个人都对此非常满意。然而，企业希望将他们的开发成本资本化，并要求修改 Scrum 积压工作项模板以包含完成任务所花费的时间。这个想法是他们需要知道开发人员花费了多少时间进行生产性工作，即他们花费了多少时间来添加新功能。

业务中的一些人（包括我自己）遇到的问题是，记录你在某事上花费了多少时间，这违背了 Scrum 的目标。从首席开发人员的角度来看，我只想知道我们有这么多时间来做这么多工作。我们记录了任务还剩下多少时间，我们可以看到我们离实现目标还有多远。

也许我错过了重点？你告诉我。但是，如果有人知道一种我们可以在不记录我们花在做某事上的确切时间的情况下工作的方式，并且仍然取悦投资资金的人，那么您的回答将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T04:41:06.270

作为一名开发经理，我有兴趣确保开发顺利进行（通过 Scrum），并且每个项目都考虑到时间，这样我们就知道我们把钱花在了哪里（时间跟踪）。

因此，在冲刺期间，团队成员被要求更新未完成任务的剩余时间以计算燃尽图。它不应该超过几分钟。由于我们使用 Scrum，团队决定任务，我不在乎谁在做什么，只要我们有燃尽图。

我还要求他们跟踪每个项目的时间，这不是很详细。我不想跟踪他们的每一分钟。此信息用于了解发布版本需要多长时间或开发产品需要多少资金。

由于我们使用 Scrum，时间跟踪非常简单，因为团队的所有成员都在很长一段时间内从事同一个项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T03:22:31.670

Scrum 不是死板的，它完全取决于适应性和适合您的需求。

你为什么不以小时而不是故事点来估计故事。我们也面临同样的情况，我们开始在几个小时内进行估算。每天根据估计的时间，开发人员记录他们在一个故事上工作了多少时间。每天可以看到故事需要多少时间，最后可以看到估计和实际花费的时间。我们使用 XPlanner 来跟踪这一点，开发人员每天需要一分钟来记录时间。基于此信息，您始终可以测量有助于下一次迭代的速度。

除了与项目相关的故事外，我们还记录了在其他活动中浪费的时间，例如会议、环境停机、生产支持等。在一段时间内，这些信息为我们提供了很多信息，我们设法减少了很多浪费的时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T03:41:10.593

第一个问题是——您是咨询店还是内部 IT 店。如果是前者，那么可能需要实际值才能让他们正确地向客户收费。如果是后者，而你们都是有薪水的，那么原因就不清楚了。我总是怀疑任何想知道“程序员花了多少时间从事生产性工作”的经理。这是一个度量标准，我告诉任何形式的敏捷开发团队的关键之一是，为了团队同意的明确目的，应该捕获度量标准。

我会问“问题背后的问题”是什么——或者管理层真正在寻找什么。为什么他们关心开发人员的生产力？他们是否很难向*他们的*经理解释发生了什么？是否有可以概括的团队指标？

简而言之——你的经理可以被认为是团队的客户，所以找出你的客户想要什么，并找出最好的方式——作为一个团队——来提供它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T16:28:13.787

Scrum 和其他敏捷开发方法在双方参与的人员之间存在信任时效果最佳。管理层需要相信开发人员努力工作并且工作良好。开发人员需要相信管理层尊重他们的意见，并要求他们根据业务需求做适当的工作。如果没有这种信任，您的流程将无法正常运行。没有环境是完美的，但在某些时候，信任问题可能会变得非常糟糕，以至于变得不可行。

话虽如此，作为一名开发人员，我必须“仅仅因为”做很多事情。例如，我必须做这种事情，因为这就是整个组织的工作方式——包括开发人员。我可以忍受这一点。我会说跟踪你的时间，但从冲刺开始计划。有意义地记录您的“非生产性”时间——如技术研究、办公任务等——无论它们是什么——以便业务人员明白即使不开发代码，你也始终保持高效。

**编辑**哦-如果时间跟踪活动特别繁重，例如填写详细的每日日志，请确保您非常清楚地跟踪跟踪时间所花费的时间，以便他们知道活动的成本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T16:23:31.817

我们已经使用 Agile/SCRUM 大约 2 年了，我们从未记录过实际情况。

似乎时不时地试图让每个人都记录这些信息。这通常是由于糟糕的 sprint 造成的，而责任完全在于糟糕的估计。但是很容易忘记把这些标记下来——尽管我相信只要有足够的“温和的刺激”，它就会成为习惯。

我一次又一次地看到的想法 - 并且我同意的一个 - 是您的*速度*应该回答您（或产品所有者）需要询问的有关任务进度的任何问题。

# c++ - SetOaNoCache 在哪里定义？

> ID：553846
> 
> 赞同：4
> 
> 时间：2009-02-16T16:17:58.193
> 
> 标签：c++, visual-studio-2008, disable-caching

尝试**禁用**BSTR 缓存：

```
SetOaNoCache(); 
```

VC++ 编译器**构建输出**：

*   `'SetOaNoCache': identifier not found`

**不想**使用：

*   OANOCACHE=1

**问题：**

*   [SetOaNoCache](http://msdn.microsoft.com/en-us/library/ms644360.aspx) 在哪里**定义**- 头文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T16:26:22.247

它没有在头文件中定义，它在 OLEAUT32.dll 中。你可以这样称呼它：

```
typedef int (*SETOANOCACHE)(void);

void DisableBSTRCache()
{
    HINSTANCE hLib = LoadLibrary("OLEAUT32.DLL");
    if (hLib != NULL)
    {
        SETOANOCACHE SetOaNoCache = (SETOANOCACHE)GetProcAddress(hLib, "SetOaNoCache");
        if (SetOaNoCache != NULL)
            SetOaNoCache();
        FreeLibrary(hLib);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T16:28:31.757

它不是。从 C++ Builder 附带的 Win32 API 库中：

```
Requirements

Windows XP: Requires Windows XP Service Pack 2 or later.

Windows 95/98: Not supported.

Header: Not supplied. Declare prototype as shown.

Library: Use oleaut32.lib. 
```

原型如图：

```
inline void TurnOffCache ()
{
// Function prototype.
extern "C" SetOaNoCache(); 
// Turn off BSTR caching.
SetOaNoCache();
} 
```

# database - 第一范式和时间数据

> ID：553856
> 
> 赞同：2
> 
> 时间：2009-02-16T16:22:19.993
> 
> 标签：database, database-normalization

第一个范式表示行排序无关紧要。这是否意味着以日期作为键的一部分的表不是 1NF？例如，考虑一个股票价格表，其中日期/时间是 PK 的一部分。在这种情况下，您可以通过按日期对数据进行排序并选择前 1 行来获得最新价格。这是否意味着要实现 1NF，您需要将表拆分为：1）TickerCurrentPrice（每个股票代码 1 行）2）TickerHistoricalPrice 谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T16:32:14.073

`1NF`是表示*关系*的表的方面，而不是表本身。

如果您的关系说`ticket HAS price`这是`1NF`违规行为，因为您无法通过查看单个记录来确定是 a`ticket` `HAS`还是`HAS NOT`the 。`price`您需要获取此票的所有价格并选择其中的最后一个，这违反`non-ordering rule`了`1NF`.

如果您的关系说`ticket HAD BEGUN TO COST price ON date`，那`1NF`没关系，因为每条记录都说明了它所说的内容：*this* `ticket` cost *this* `price` from *this* `date`。

因此，我们说这个表`1NF`在*表示*第一个关系时不符合，但在*表示*第二个时符合。

当然，桌子本身保持不变。

这并不意味着您需要拆分表格。

的全部意义`relational databases`在于您可以使用`relational operators`将一种关系转换为另一种关系。

`relation`什么是`RDBMS`？这是一张表格，显示了它们之间存在这种关系的**所有可能值的****所有**组合。

 **例如，如果我们需要对从`1`到的自然数构建等式关系`5`，我们有这个表：

```
1 1
2 2
3 3
4 4
5 5 
```

此表中出现的所有对都处于等式关系；所有没有出现的对都不是。我们在这里看不到`(2, 3)`，或者`(4, 5)`，因为它们不相等。

但是您不需要将整对保存在数据库中。您保留单个值并编写查询：

```
SELECT n1.number, n2.number
FROM number n1, number n2
WHERE n1.number = n2.number 
```

，这会给你同样的结果。

实际上，范式允许您在数据库中保留*最简单的*关系表，并使用`SQL`查询从它们构造更复杂的关系。

在您的情况下，如果您以下列方式编写查询（或定义视图）：

```
SELECT ticket, price
FROM mytable
WHERE (ticket, date) IN (
  SELECT ticket, MAX(date)
  FROM mytable
  GROUP BY
    ticket
  ) 
```

`ticket HAS price`，您从 ( )获得关系 ( )`ticket HAD BEGUN TO COST price ON date`就像您将整个表保存在数据库中一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T16:31:08.397

不，“选择...按...排序”不违反 1NF。违反 1NF 的行（和列）排序更多地是关于“从 XYZ 中选择 *；然后从顶部选择第三行，从左起第四列”的情况。是的，我见过这样的数据库设计。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T17:56:55.757

这意味着如果要记录数据的某些排序（如按日期），则应**明确**记录它，例如在日期列中。错误的做法是仅将排序**隐含**在磁盘上行的物理顺序中（假设您无论如何都可以控制它）。换句话说，您必须按某个列排序才能按该顺序取回数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T16:27:50.930

不，这意味着没有内在的秩序。如果您想要最后价格的日期，您必须`select max(date)`从您的表格中获取。

# c# - What are the similarities and differences between Java Annotations and C# Attributes?

> ID：553857
> 
> 赞同：50
> 
> 时间：2009-02-16T16:22:29.837
> 
> 标签：c#, java, attributes, annotations, custom-attributes

I have a Java library I'm considering porting to C#. The Java library makes extensive use of annotations (at both build time and run time.)

I've never used C# attributes, but understand that they are the rough equivalent of Java annotations.

If I proceed with the port using attributes to replace annotations, what do I need to know? What's going to be the same? Different? What's going to bite me?

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-17T13:31:47.553

两种语言对何时可访问元数据的控制是不同的。

**Java 提供[java.lang.annotation.Retention](http://java.sun.com/javase/6/docs/api/java/lang/annotation/Retention.html)注解和[java.lang.annotation.RetentionPolicy](http://java.sun.com/javase/6/docs/api/java/lang/annotation/RetentionPolicy.html)枚举**来控制注解元数据何时可访问。选择从`Runtime`（最常见的 - 类文件中保留的注释元数据）到`Source`（编译器丢弃的元数据）不等。你用这个标记你的自定义注释接口 - 例如：

```
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.CLASS)
public @interface TraceLogging {
  // etc
} 
```

将允许您在运行时反映您的自定义`TraceLogging`注释。

**C# 使用**由编译时符号驱动的**[ConditionalAttribute](http://msdn.microsoft.com/en-us/library/system.diagnostics.conditionalattribute.aspx)****属性。**所以 C# 中的类似示例是：

```
[Conditional("TRACE")]
public class TraceLoggingAttribute : Attribute
{
  // etc
} 
```

这将导致编译器仅在定义符号`TraceLogging`时才为您的自定义属性吐出元数据。`TRACE`

*注意。默认情况下，属性元数据在 C# 中在运行时可用 - 仅当您想更改它时才需要。*

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-16T16:32:34.587

Java 注释的一个重要方面我还没有详细研究过：您可以编写在 javac 中使用注释的代码（我相信从 Java 6 开始）[作为元编程的一种形式](http://java.sun.com/j2se/1.5.0/docs/guide/apt/GettingStarted.html)。

[诚然， PostSharp](https://www.postsharp.net/)允许类似的东西。

（这远不是唯一的区别，但这是我现在有时间的全部。）

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-02-17T13:06:43.807

**一个有趣的区别是 C# 允许模块和程序集级别的属性。** 这些将应用于您的模块或程序集，并且可以通过正常方式通过反射获得。Java 不提供对 jar 文件的反射，因此无法使用 jar 级别的注释。

事实上，这在 Visual Studio 中很常见，`AssemblyInfo.cs`在根项目级别调用一个文件，其中包含例如：

```
[assembly: AssemblyVersionAttribute("1.2.3.4")]
[assembly: AssemblyTitleAttribute("My project name blah blah")]
... 
```

Java 中没有等效的 jar 级别注释（尽管从 jdk5 开始，有一点使用的包级别注释机制 - 感谢[mmeyers](https://stackoverflow.com/users/13531/mmyers)指出这一点）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-16T19:27:02.233

按照乔恩所说的...

Java 5 和 Java 6 都允许元编程。Java 5 使用单独的 apt 工具；Java 6 将其集成到编译器中。（虽然 Java 5 apt 在 Java 6 中仍然可用）

不幸的是，每个都使用不同的 API。

我目前正在为我的 Bean 注释使用 Java 5 API

有关示例，请参见[http://code.google.com/p/javadude/wiki/Annotations](http://code.google.com/p/javadude/wiki/Annotations)（注意：我目前正在进行一些重大更新，其中一些更改了 API。）

非常酷的东西……——斯科特

# visual-studio-2008 - 空白自动格式 - ReSharper 和 VS2008 互相争斗！

> ID：553862
> 
> 赞同：1
> 
> 时间：2009-02-16T16:23:17.823
> 
> 标签：visual-studio-2008, formatting, resharper, whitespace

考虑以下代码行：

```
things.Add(new Thing { ID = null, Name = "a thing" }); 
```

您看到的空白格式是我在键入结尾时得到的`;`。

现在，如果我要求 Visual Studio 重新格式化我的代码，或者我键入关闭`}`它会重新格式化：

```
things.Add(new Thing{ID = null, Name = "a thing"}); 
```

我更喜欢第一种格式。

我正在使用 ReSharper 4.0 和 Visual Studio 2008 SP1。

我怎样才能让他们就大括号周围的空格达成一致？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T17:48:26.510

我也遇到了这个问题，虽然我已经学会了忍受它，但你的问题让我想解决它。

事实证明 VS 中有一个选项应该有所帮助：

> `Tools -> Options -> Text Editor -> C# -> Formatting`

取消选择*自动格式化已完成的块`}`*以及您认为令人反感的任何其他选项。

[将来，您可以在R# Jira 站点](http://www.jetbrains.net/jira/browse/RSRP)上提交缺陷。搜索此站点以查看是否已经发布了您的问题的解决方案。

您是否尝试过[R# 4.5 Nightly Builds](http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+4.5+Nightly+Builds)？

**编辑**根据您的评论：

> *我喜欢格式化的所有其他方面，所以不想关闭该选项。*

我会禁用所有 Visual Studio 格式，只使用 ReSharper 格式。它的可配置性更高。这不能达到你想要的吗？

# asp.net - ASP.NET 内容/功能与设计/布局/样式

> ID：553863
> 
> 赞同：1
> 
> 时间：2009-02-16T16:23:30.910
> 
> 标签：asp.net, development-process

在使用 ASP.NET 开发 Web 应用程序时，您是否有任何关于如何将内容/功能的开发与设计分开，从而使两者可以分别并行开发的提示？

情况是：

*   客户已就他们想要的功能达成一致
*   客户正在改变他们对页面外观（样式和布局）的看法
*   网页设计师不是专家：
    *   不是从头开始开发干净的基于 CSS 的布局
    *   正在从 3rd 方站点获取各种基于表格的布局（使用 CSS），用作布局的示例/原型以与客户讨论

鉴于此，如何在基于表格的布局最终确定之前开始编码功能？

我认为一种方法可能是：

*   编码功能（包括在每个页面上创建活动元素）而不关心（指定）它们的布局和样式
*   然后，最后，在设计师和客户就设计达成一致后，将活动元素剪切并粘贴到设计师的原型页面中。

这是唯一的还是最好的方法？还有哪些其他方法？有任何提示、提示或技巧可以使这更容易吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T21:14:34.143

在开始进行任何编码之前，最好有一个视觉“骨架”布局。原因是，如果你有一个布局原型，那么你就可以迭代地让你的客户给你关于布局的反馈。如果我是你，我会完全放弃基于表格的布局。原因是，在 Webforms 中，如果您不使用母版页，那么您将不得不单独编辑每个页面（或围绕相同的复制布局制作大量控件）。有几种方法可以做到这一点：

如果您知道您将使用 CSS（提示、提示），那么我会查看可用的各种选项：[Ironmyers CSS Layouts](http://layouts.ironmyers.com/)、[Layout Gala (40 CSS stylesheets)](http://blog.html.it/layoutgala/)和我最喜欢的[Open Source Web Design CSS Layouts](http://www.oswd.org/)和选择一个您认为与您将要使用的布局“最接近”的布局。它不需要是完美的，它只需要是一个骨架。

由于网站通常有两列或三列，顶部有一个水平菜单（Stack Overflow 就是一个很好的例子），你可能想要寻找那种类型的骨架。然后，您所要做的就是在您想要调整布局时编辑样式表。

您无需成为专家即可执行此操作；但它会让您快速了解网站的外观以及各个部分如何组合在一起。

使用基于 CSS 的布局进行原型设计有多种优势：

*   如果您更改布局，您可以查找/替换 CSS 类 ID 以更改它（或使用您最喜欢的脚本语言为您完成）
*   在开发后端时，您可以花**很少的**时间来处理布局
*   已有的布局允许您编辑 CSS，然后点击刷新立即查看更改；根本不必用 HTML 涂鸦。

您当前的方法与干净分离相冲突，鉴于您的问题，您知道情况就是这样：使用现成的 CSS 模板，您可以在几分钟内完成原型的设计并解决它，而不是花时间尝试使用表格完成布局。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T16:30:10.893

这可能看起来有点激烈，但一种方法是让您的 Web 应用程序基于服务。这意味着您的所有业务逻辑都将封装在您的 Web 服务器将调用的一个或多个服务中。

这使您在网站本身上拥有最少的服务器端代码，所有这些代码都将围绕数据的动态显示。这意味着您可以继续在服务中开发您想要的所有应用程序逻辑，并让您的设计团队为客户端破解 UI 内容，而无需踩到任何脚趾。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-16T18:05:31.947

这个问题没有简单的答案，但我会先让你的设计师更容易一些——首先放下基本的 CSS 元素。例如，如果您知道配色方案，那么您已经有了背景。你可能已经知道你是要选择宽的还是窄的。所以，你已经有了样式表的开始：

```
*
{
   margin: 0;
   padding: 0;
}

body
{
   background-color:#827575;
   color: #c6d3d5;
   font: 75%/1.5em Verdana, Helvetica, Geneva, &quot;Helvetica Neue&quot;, sans-serif;
} 

`#container
{
    margin-top: 30px;
    text-align: left;   
    margin-right: auto;
    margin-left: auto; 
}

`#content
{ 
    margin-right: auto;
    margin-left: auto;
    width: 850px;
    margin-top: 10px;
} 
```

将容器 div 和其中的内容 div 放置在母版页中 - 围绕主要内容占位符。现在，您有一些工作要做。*你的人现在*可以在内容页面中使用表格，并在需要时应用内联样式。稍后，另一位知识更丰富的设计师会出现并将所有 CSS 移动到样式表中。只是一个实用的建议，让它继续前进:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T21:41:35.717

大多数情况下，我按照您在此处定义的方式工作：

> 编码功能（包括在每个页面上创建活动元素）而不关心（指定）它们的布局和样式
> 
> 然后，最后，在设计师和客户就设计达成一致后，将活动元素剪切并粘贴到设计师的原型页面中。

首先，我开发应用程序、实体、数据层和可重用实用程序类的主干。同时，设计师创造了一个设计，我们将它们展示给客户。

当我开发应用程序的功能时，设计就准备好了。我只是在页面上添加链接文本框按钮。只为设计添加了休息和空间。

当我们准备好进行第一个演示时，我会应用该设计。这个化妆操作是工作中最无聊的部分。特别是如果客户想要智能电网。但它只发生一两次。

**编辑（开始）：**

首先，我将重复出现的部分拆分为自定义控件。我将母版页添加为容器。我将自定义控件添加到母版页中。那么环境就准备好了。

然后我开始将母版页引用添加到我的活动页面，并在必要时将 css 引用或其他 html 元素添加到活动页面中。我的意思是我不会重写我的活动页面。大多数工作由母版页和自定义控件完成。我只向我的活动页面添加一个表格和一些 css 引用。

**编辑（完）**

我使用**CSS**、**ASP.NET 主题**、**母版页**和**自定义控件**来简化设计并最小化与设计相关的文件。

# c# - 即使表单没有焦点也能拦截按键

> ID：553870
> 
> 赞同：5
> 
> 时间：2009-02-16T16:24:32.530
> 
> 标签：c#, .net, winforms

我已经构建了一个 winforms 应用程序，它通过覆盖 ProcessCmdKey 方法来检查 CTR+ALT+S 和 CTRL+ALT+E 按键。这很好用，但是如果屏幕保护程序打开然后关闭，则表单没有焦点并且按键不会被拦截。即使表单没有焦点，我如何才能收到这些？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-16T18:49:30.513

Alexander Werner 在 Code Project 上有一个“[系统热键组件](http://www.codeproject.com/KB/miscctrl/systemhotkey.aspx)”项目，它将 RegisterHotkey() API 包装到一个非常容易实现的用户控件中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-16T18:35:08.630

我知道两种方法：

1.  [RegisterHotKey()](http://msdn.microsoft.com/en-us/library/ms646309.aspx) - 您可以使用 RegisterHotKey() 函数来定义系统范围的热键。如果用户按下热键，Windows 会发送 WM_HOTKEY 消息。

2.  [Win32 Hooks](http://msdn.microsoft.com/en-us/library/ms997537.aspx) - 这是一个旧的 API，最初设计用于支持基于计算机的培训 (CBT) 应用程序，但我相信 Windows 仍然支持它。该 API 允许您拦截并可能修改任何窗口的消息、鼠标操作和击键。

这些是 Win32 API，而不是 .NET API，但 .NET 使用 Windows 的相同底层组件，因此这些方法应该适用于 .NET。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-01-09T10:18:56.320

我知道很久以前就有人问过这个问题，但是如果有人来这里，它可能是解决方案：

只需将`KeyPreview`（您的表单的）属性设置为`True`. 这样，您的表单将`KeyPress`在任何其他控件之前处理事件，即使其中一个控件具有焦点

我有一个非常相似的问题。在此处检查：[带有控件的表单级别的 KeyPress](https://stackoverflow.com/questions/48011654/keypress-at-form-level-with-controls/48164235)

希望能帮助到你

# python - 谁能提供一种更 Pythonic 的方式来生成 morris 序列？

> ID：553871
> 
> 赞同：5
> 
> 时间：2009-02-16T16:24:53.870
> 
> 标签：python, sequences, itertools

我正在尝试在 python中生成[莫里斯序列。](http://www.ocf.berkeley.edu/~stoll/answer.html)我目前的解决方案如下，但我觉得我只是用python写了c。任何人都可以提供更pythonic的解决方案吗？

```
def morris(x):
    a = ['1', '11']
    yield a[0]
    yield a[1]
    while len(a) <= x:
        s = ''
        count = 1
        al = a[-1]
        for i in range(0,len(al)):
            if i+1 < len(al) and al[i] == al[i+1]:
                count += 1
            else:
                s += '%s%s' % (count, al[i])
                count = 1
        a.append(s)
        yield s
a = [i for i in morris(30)] 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-16T18:07:12.907

[`itertools.groupby`](http://docs.python.org/library/itertools.html#itertools.groupby)似乎非常适合！只需定义一个`next_morris`函数如下：

```
def next_morris(number):
    return ''.join('%s%s' % (len(list(group)), digit)
                   for digit, group in itertools.groupby(str(number))) 
```

就这样！！！看：

```
print next_morris(1)
11
print next_morris(111221)
312211 
```

* * *

我可以用它来制作发电机：

```
def morris_generator(maxlen, start=1):
    num = str(start)
    while len(num) < maxlen:
        yield int(num)
        num = next_morris(num) 
```

用法：

```
for n in morris_generator(10):
    print n 
```

结果：

```
1
11
21
1211
111221
312211
13112221 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T18:01:25.573

```
from itertools import groupby, islice

def morris():
    morris = '1'
    yield morris
    while True:
        morris = groupby(morris)
        morris = ((len(list(group)), key) for key, group in morris)
        morris = ((str(l), k) for l, k in morris)
        morris = ''.join(''.join(t) for t in morris)
        yield morris

print list(islice(morris(), 10)) 
```

首先，我会让迭代器无限，让消费者决定他想要多少。这样他就可以得到每个比 x 短的莫里斯数或前 x 个数，等等。

那么显然没有必要将以前的莫里斯数字的整个列表存储在一个列表中，因为递归只是`n := f(n-1)`无论如何。

最后，使用 itertools 给它一个功能性的触摸总是值得一两个极客点；）我将生成器表达式分成几行以使其更容易看。

这个解决方案的主要丑陋之处在于`len()`不能在迭代器上调用，并在我们需要 str 的地方给了我们一个 int。另一个小问题是嵌套的 str.join) 将整个事物再次展平为一个 str 。

如果要从任意数字开始序列，请定义如下函数：

```
def morris(morris=None):
    if morris is None:
        morris = '1'
[...] 
```

如果你想翻转那个生成器，你可以这样写：

```
def morris():
    morris = '1'
    yield morris
    while True:
        print morris
        morris = ''.join(''.join(t) 
                     for t in ((str(len(list(group))), key) 
                        for key, group in groupby(morris)))
        yield morris 
```

我不确定我是否喜欢分成两个函数，但这似乎是最易读的解决方案：

```
def m_groupby(s):
    for key, group in groupby(s):
        yield str(len(list(group)))
        yield key

def morris():
    morris = '1'
    yield morris
    while True:
        morris = ''.join(m_groupby(morris))
        yield morris 
```

希望你喜欢！

# sql - 基本 SQL 问题 - 数据类型选择

> ID：553877
> 
> 赞同：1
> 
> 时间：2009-02-16T16:26:14.210
> 
> 标签：sql, database

我目前正在 Oracle 中创建一个小表，但不确定为特定列选择哪种数据类型。

该列标记为“留”，我希望它只包含“短”、“中”和“长”这些值。最终目标是将这些值放在表单内的下拉列表中。

我在这里选择“char(6)”的数据类型是否正确？

那么是否可以使用 Oracle 表单生成器将其变成值列表？

感谢您的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T16:32:54.787

首先，我将列命名为“StayDuration”或“StayLength”，因为“Stay”本身仍然有点令人困惑。完成后，我看到了两种可接受的方法：

*   将您的长度放在一个单独的表中，并让您现有的列将外键存储到该表中。
*   存储一个整数，这样整数的值可以通过一个简单的公式轻松地扩展为停留长度障碍的实际值。（例如：“短期”停留可能是 1 天或更短，“中”停留可能是一周或更短，然后其他一切都很长，您可以使用 0、1 和 7 作为整数。

我倾向于避免在此处直接存储 varchar 类型的数据。它需要更多的存储空间，并且很容易导致输入错误或过时的数据。

混合方法也是可能的，这样第一个选项中的新表中的“键”映射到第二个中提出的整数值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T16:29:25.890

基本上有3个选项：

*   一些数据库专门针对这种情况支持 Enum 类型。（不确定甲骨文）
*   您可以使用 char(6)
*   您可以使用 int 并将它们在应用程序级别映射到适当的类型。

我会说 Enum 是“最干净”的选项。但是一些 ORM 不能正确地支持这一点。

这个 SO 问题对您来说可能很有趣：

[如何在 Oracle 中使用枚举？](https://stackoverflow.com/questions/203469/how-to-use-enums-in-oracle)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T16:33:01.527

使用 VARCHAR2(6)。CHAR(6) 具有空白填充语义，使用起来很奇怪；这也意味着您每次使用“Long”这个词时都会存储完整的 6 个字符。几乎没有令人信服的理由使用 CHAR 代替 VARCHAR2。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-16T17:39:12.493

如果有可用的 ENUM 类型，请使用它。否则，我建议两种选择：

*   将其存储为单个字节（或可用的最小整数类型）。然后，您可以随意转换应用程序中的枚举。我认为这是最干净的方法，并且可以很好地绑定到`ComboBox`es 作为键值对。

*   您还可以将字符串存储在单独的表中，并将现有列作为此新表的外键。然后很容易在此表上加入并获得快速的字符串查找以显示在您的表单上。但是，这是额外的开销，并且可能会将您的字符串放在两个位置 - 您的应用程序*和*数据库。此外，如果您想进行本地化，您将面临真正的麻烦。

* * *

如果您想围绕此列构建任何应用程序逻辑，我不建议您使用字符串 (VARCHAR / CHAR) 选项。您将整天都在比较字符串，恕我直言，这相当丑陋和缓慢。与简单的整数类型相比，它们的排序和查询速度也较慢。（但是，在您的示例中您*是*安全的，因为您可以只比较第一个字符“S”、“M”或“L” - 一个字节。但是您必须专门指示它以这种方式排序和查询.)

如果您只是想显示该值，则可以使用字符串，但请记住大小。通过存储字符串，您的数据库可以很容易地膨胀：

*   CHAR(6) 的 1,000,000 行比使用单个字节多 5,000,000 字节。
*   使用 VARCHAR(6) 将为 1,000,000 行额外产生 5 = 4,000,000 字节的平均长度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T16:36:59.100

使用值为 'S'、'M'、'L' 的 CHAR(1)；可选地将列链接到第二个表，其中 S/M/L 是主键，“small/medium/long”是 varchar(255) 解释。这样，您就有了最佳的代码大小（1 个字节尽可能短），同时仍然能够在报告中打印“好”的名称。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T17:56:50.967

如果您想这样做，使用数字数据类型可以更容易地按大小对事物进行排序。我不能代表 Oracle，但很多时候，使用单个字节并不能为您节省太多，因为无论如何它都会被塞进一个 4 字节的字中。

此外，您现在只有三种尺寸，但将来您可能会拥有更多。使用单个字符可以使区分 XL 和 XXL 尺寸成为真正的挑战。

根据您正在处理的应用程序的类型，如果您需要本地化您的应用程序，将呈现给用户的字符串存储在数据库中可能会产生影响。如果您将整个数据库作为应用程序的一部分提供，只要您将它们放在查找表中，这没什么大不了的。例如，如果您正在处理需要让不同用户以不同语言访问同一个数据库的 Web 应用程序，则可能会导致一些问题。

# .net - 为 .NET Web 应用程序中的每个用户保存一个自定义 int 值

> ID：553881
> 
> 赞同：1
> 
> 时间：2009-02-16T16:27:07.610
> 
> 标签：.net

.NET 是否支持为每个（登录的）用户保存自定义 int 值？

我可以使用 HttpContext.User 属性或其他东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T16:32:38.563

您将需要查看 HttpContext 上的 Session 属性。该属性返回的 HttpSession 允许存储在会话级别范围内的值（通过索引器）。此会话是映射到单个用户的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-08T18:18:40.000

是否需要在会话之间持久化？然后您可以查看 ASP.NET 用户配置文件服务 - 工作得非常好，高度可配置。

请参阅有关它的这些文章：

*   [ASP.NET 2.0 中的个性化和用户配置文件](http://msdn.microsoft.com/en-us/magazine/cc163724.aspx)
*   [ASP.NET 2.0 中的配置文件](http://www.odetocode.com/articles/440.aspx)
*   [ASP.NET 2.0 快速入门教程](http://quickstarts.asp.net/quickstartv20/aspnet/doc/profile/default.aspx)

马克

# design-patterns - 实现“脏”标志功能的不同方法

> ID：553882
> 
> 赞同：45
> 
> 时间：2009-02-16T16:27:37.140
> 
> 标签：design-patterns

几乎每个程序员一生都做过一次：如果变量的值发生变化，则设置一些标志。总是有很多属性，如果有变化，你想跟踪

1.  在任何财产
2.  在特定属性
3.  或在某些属性中

**除了在每次属性更改时更新标准对象范围的脏标志之外，**我对在上述情况下实现“脏标志”功能的不同方式感兴趣。**肯定有比在每个 setter 中添加*“dirty = true”*更好的方法：它看起来很丑，而且是一项乏味的工作。**

 *** * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-16T16:34:06.033

对于我的 DAO，我保留了从数据库中检索到的原始值的副本。当我发送它进行更新时，我只是将原始值与当前值进行比较。它的处理成本有点高，但比每个属性都有一个脏标志要好得多。

编辑以进一步证明没有脏标志：如果属性返回其原始值，则无法反映这一点，脏标志继续脏，因为原始值丢失。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-16T16:36:13.487

我曾经有一个基础实体类，提供脏/删除逻辑。

在编写实体子类时，您可以执行以下操作：

```
public string Name
{
    get { return name; }
    set { setValue("Name", value); }
} 
```

这很好用，但有“丑陋的弦”病......

今天你可以使用 Lambda 表达式来排除字符串：

```
set {setValue(x => x.Name, value);} 
```

或者，我认为这是最好的解决方案，您可以使用[AOP](https://en.wikipedia.org/wiki/Aspect-oriented_programming)：

[https://www.postsharp.net/](https://www.postsharp.net/)

这样，您可以按属性定义操作。您创建一个属性并指定当用户更改关联的属性时，实体会变脏。

此外，您可以在您的类（基本实体）中保留一个属性列表，该列表将记住更改的属性，并从您的 AOP 代码访问该列表。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-16T16:37:56.570

我创建了一个名为的类`DirtyValue<T>` ，它有一个原始值和一个当前值。在第一次使用时，它会设置原始值和当前值。连续调用只设置当前值。

您可以通过比较两者来判断它是否发生了变化，并使用名为 IsDirty() 的只读 bool 属性。使用这种技术，您还可以访问原始值。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-16T16:34:11.197

如果您正在设置“脏”标志，请意识到您正在保持状态。在某些时候，您需要根据该状态采取行动，否则您不需要保留标志。那么问题就变成了：是否有另一种方法来触发所需的操作？发送某种消息？谁使用“脏”状态并采取行动，该通知是否有更清晰的界面？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-16T18:01:40.207

在某些具有数据写入任务和独立读取任务的情况下，我为每个任务分配了一个`updateCount`变量。生产者每次写入时都会增加其计数。每当阅读器醒来并发现其计数小于生产者的计数时，它都会使用当前值进行更新。您需要对计数器溢出进行一些特殊处理，但这很容易实现。

我已经成功地在模拟中使用了这种技术——生产者是物理循环，读者是 3d 显示器。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-16T16:32:53.197

我会将changed() 放在每个setter 中，即调用一个私有方法而不是仅仅更改一个标志。然后该方法可以设置一个标志或进行任何需要的处理，例如它还可以通知任何观察者。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-16T20:42:01.680

显式方法的一个有趣的替代`dirty=true`方法是使用保护页，尽管在大多数情况下它可能是过度的并且通常不适用。将内存页面设置为只读（例如，在 Windows 上使用[VirtualProtect()](http://msdn.microsoft.com/en-us/library/aa366898(VS.85).aspx)）并在程序尝试写入页面时捕获信号/异常。记录页面已被修改，然后将页面的保护标志更改为可写并恢复执行。

这是操作系统通常采用的技术，用于确定在从 RAM 中逐出页面之前是否需要将页面写入交换文件。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-12-31T16:48:52.703

您可能希望查看覆盖域对象的 gethashcode 和 equals 方法，并按对象键将原始哈希码存储在哈希表中。然后创建一个接受对象的进程，在哈希表中找到它的键并比较哈希值。

*   如果哈希相同，则没有变化。（不要发送到存储库或数据库）
*   如果散列不同，则对象有变化。（更新）
*   如果未找到密钥，则对象是新的。（插入）
*   不知道如何确定是否需要删除对象，而不是根据请求处理删除并且不对其使用哈希码跟踪。

我没有尝试过，哈希表可能不是跟踪对象键/哈希值的最佳方法。它将通过仅跟踪哈希码和键来节省内存。我不是 100% 确定，但我认为一些 orm 可能会在他们的数据上下文/跟踪对象中使用这种方法。

# excel - 打开分号分隔的 CSV 文件

> ID：553888
> 
> 赞同：6
> 
> 时间：2009-02-16T16:29:17.107
> 
> 标签：excel, vba, csv, excel-2000

如何在 Excel 2000 中使用 VBA 打开分号分隔的 CSV 文件？

**样本数据**

```
An ID;TEST20090222
A Name;Firstname Surname
A Date;11.05.2000

Country:;SomeCountryName
Currency;EUR
CostA;
CostB;
CostC;
Part1;10;20;30
Part2;;;;
Part3;34;56;87 
```

**代码**

在带有 VBA 6.5.1025 的 Excel **2003** 11.8231.8221 SP3 中，我可以使用以下 VBA 代码打开一个以分号分隔的文件：

```
Workbooks.OpenText filename:=myFilename, _
    DataType:=xlDelimited, Semicolon:=True, Local:=True 
```

但是，当使用 VBA 6.5.1025 在 Excel **2000** 9.0.8961 SP1 中运行相同的代码时，出现以下错误：

> 编译错误：未找到命名参数

那是——我认为——因为 Excel 2000 不知道命名参数“Local”。

因此，我删除了“Local:=True”部分。但问题是 CSV 文件中的一整行被写入一个单元格，而不是被分成单独的分号分隔的部分。

我在互联网上搜索了一个解决方案，但没有找到任何有用和简洁的东西。

有任何想法吗？

**[更新 17.02.2009]**

我用宏记录器尝试了*[用户 lc的建议。](https://stackoverflow.com/users/44853/lc)*然而，结果令人困惑。

当我使用菜单 File->Open... 打开 CSV 文件，然后选择 CSV 文件时，分号分隔的数据被正确解析。并且记录的代码很简单：

```
Workbooks.Open filename:= _
               "D:\testdata\Example 01 CSV\input.csv" 
```

但是当我在宏中使用该 VBA 代码时，每一行都会再次出现在一个单元格中。

根据*[用户 barrowc](https://stackoverflow.com/users/53614/barrowc)*的建议，我还将 Windows 的“区域和语言选项”设置从“德语（瑞士）”更改为“英语（美国）”。即使重新启动 Excel，也没有任何改变，同样的问题。

我想知道为什么它在*[用户 Remou](https://stackoverflow.com/users/2548/remou)*的系统上工作。您有哪些区域和语言设置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T16:27:38.650

**[2009 年 2 月 22 日更新]**

同时，我通过自己编写导入函数而不是使用 Workbooks.OpenText 解决了这个问题。

我只是将 CSV 文件作为文本文件打开，逐行读取，将每一行拆分为分号分隔的元素，然后将每个元素写入一个单元格。

```
Sub ImportCSVFile(filepath As String)
    Dim line As String
    Dim arrayOfElements
    Dim linenumber As Integer
    Dim elementnumber As Integer
    Dim element As Variant

    linenumber = 0
    elementnumber = 0

    Open filepath For Input As #1 ' Open file for input
        Do While Not EOF(1) ' Loop until end of file
            linenumber = linenumber + 1
            Line Input #1, line
            arrayOfElements = Split(line, ";")

            elementnumber = 0
            For Each element In arrayOfElements
                elementnumber = elementnumber + 1
                Cells(linenumber, elementnumber).Value = element
            Next
        Loop
    Close #1 ' Close file.
End Sub 
```

从 Shasur 获得灵感：http: [//vbadud.blogspot.com/2007/06/vba-read-text-files-with-leading.html](http://vbadud.blogspot.com/2007/06/vba-read-text-files-with-leading.html)

我仍然不知道为什么`Workbooks.OpenText`不能在我的系统上运行，即使它似乎可以在*[用户 Remou](https://stackoverflow.com/users/2548/remou)*的系统上运行。我想这可能与操作系统语言（英语）以及区域和语言设置（德语、瑞士）有关，但我不确定。

无论如何，解决方法对我有用。谢谢大家的建议和帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-16T17:45:42.633

不确定，但您可以尝试录制一个宏来做同样的事情并检查它产生的 VBA 代码。你可能会得到关于缺少什么的提示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T18:00:41.503

我发现这在 Excel 2000 中对我有用：

```
Workbooks.OpenText filename:=myFilename, _
    DataType:=xlDelimited, Semicolon:=True 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T22:30:42.853

这是`OpenText`Excel 2000 中的方法：

> **开放文本方法**
> 
> 将文本文件加载并解析为新工作簿，其中包含已解析的文本文件数据的单个工作表。
> 
> **句法**
> 
> *表达式*.OpenText（*文件名、原点、开始行、数据类型、文本限定符、连续分隔符、制表符、分号、逗号、空格、其他、其他字符、字段信息、小数分隔符、千分隔符*）
> 
> [来源](http://msdn.microsoft.com/en-gb/library/aa273712(office.10).aspx)

这是 Excel 2003 版本：

> **OpenText 方法 [Excel 2003 VBA 语言参考]**
> 
> 将文本文件加载并解析为新工作簿，其中包含已解析的文本文件数据的单个工作表。
> 
> *表达式*.OpenText（*FileName、Origin、StartRow、DataType、TextQualifier、ConsecutiveDelimiter、Tab、分号、逗号、空格、Other、OtherChar、FieldInfo、TextVisualLayout、DecimalSeparator、ThousandsSeparator、TrailingMinusNumbers、Local*）
> 
> [来源](http://msdn.microsoft.com/en-gb/library/aa195814(office.11).aspx)

所以`Local`确实是 Excel 2003 的一个新参数，在 Excel 2000 中不起作用

不知道错误行为的原因。`Local`参数定义为：

> ***本地*** 可选**变体**。如果机器的区域设置应用于分隔符、数字和数据格式，请指定**True 。**

您可能需要仔细检查 Excel 2000 PC 上的区域设置，并检查是否有任何可能导致数据被错误解释的内容。此外，尝试在 Excel 2000 方法中显式指定`DecimalSeparator`和`ThousandsSeparator`参数，看看是否有帮助

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-05-27T14:24:40.947

另一种解决方法 - 只需将 .csv 文件重命名为 .txt 并使用 OpenText 方法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-12-08T19:06:02.457

我更喜欢：

```
Workbooks.Open fileName:=myFilename, UpdateLinks:=False, Local:=True 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-21T11:57:33.347

通常逗号作为分隔符被勾选为真，它通常是小数分隔符。添加 DecimalSeparator:="," 和 Bob 是你的叔叔

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-04T15:03:49.720

重新有什么想法吗？

如果您想使用 excel 为其他人修复文件，请在文件的第一行添加此文件，不带引号，后跟换行符：“sep=;”

手动打开愚蠢文件的一种简单方法是将扩展名重命名为 .txt 或 .htm，然后从 excel 中使用 File - Open。

从 VBA 中，我建议在 MSDN 中查找该方法并手动指定每个参数，我的经验是这消除了大多数区域问题。

# .net - 调试 Interwoven Worksite Web 服务

> ID：553890
> 
> 赞同：0
> 
> 时间：2009-02-16T16:29:35.997
> 
> 标签：.net, web-services, api, document-management

***编辑：****目前使用 VB.Net 和 Visual Studio 2008 从 Windows 控制台应用程序调用 Web 服务*

我们正在使用 Interwoven Worksite Web 服务，并且在调试它们时遇到了问题。Web 服务返回以下错误：

> *“无法访问该对象。它可能已被删除，或者您可能没有安全访问权限。”*

但是，没有比服务提供的更多细节了。我已经阅读了 Interwoven 的官方文档，发现它非常无用。

是否有人对 Worksite Web 服务有任何实际经验（他们专门与 Worksite Web 产品一起提供，不要与我们在 Web 服务中使用的 COM API 混淆）。

我在工地上进行了搜索并交织在一起，在这里没有找到任何东西，所以我不确定那里的任何人都能提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-26T18:53:47.450

是的 - 使用过它并且遇到过同样的问题。通常出现该错误时，您没有提供完整和/或正确的名字信息，例如错误的 dms 名称、错误的对象 ID。我使用 fiddler 查看在基本网站 Web 产品上来回传递的信息，以查看它们如何格式化那些有很大帮助的相同 ID。我希望这有帮助。

# xml - XSLT 中的命名空间

> ID：553904
> 
> 赞同：4
> 
> 时间：2009-02-16T16:33:04.053
> 
> 标签：xml, xslt, namespaces

我正在使用 XSLT 来重构 XML 文件。以下代码将所有子节点复制到一个新的 XML 文件中：

```
<!--Add all child elements of the zzz node-->
<xsl:template match="zzz">
    <Trade>
        <xsl:attribute name="ID">
            <xsl:value-of select="TradeId" />
        </xsl:attribute>
        <xsl:copy-of select="*"></xsl:copy-of>
    </Trade>
</xsl:template> 
```

我想修改代码，以便将节点放入源文档中没有的特定命名空间中。我需要改变什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T18:12:37.543

**前两个答案（由 teun 和 Craig Bovis 提供）不正确**——请参阅我对每个答案的评论。

**将给定元素移动到新命名空间的正确方法包括重新创建此元素，如下所示**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="zzz">
      <trade ID="{TradeId}">
        <xsl:apply-templates select="*[not(self::TradeId)]"/>
      </trade>
    </xsl:template>

    <xsl:template match="zzz/*">
      <xsl:element name="{name()}" namespace="my:Trade">
        <xsl:copy-of select="@* | node()"/>
      </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下源 XML 文档时**：

```
<zzz>
    <TradeId>153</TradeId>
    <x:item xmlns:x="x:x">A</x:item>
    <x:item xmlns:x="x:x">B</x:item>
    <x:item xmlns:x="x:x">C</x:item>
</zzz> 
```

**产生所需的结果**：

```
<trade ID="153">
   <x:item xmlns:x="my:Trade">A</x:item>
   <x:item xmlns:x="my:Trade">B</x:item>
   <x:item xmlns:x="my:Trade">C</x:item>
</trade> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T17:49:47.257

您可以像这样在样式表中包含命名空间：

```
<!--Add all child elements of the zzz node-->
<xsl:template match="zzz" xmlns:my="your target ns">
<my:Trade>
<xsl:attribute name="my:ID" >
<xsl:value-of select="TradeId" />
</xsl:attribute>
<xsl:copy-of select ="*"></xsl:copy-of>
</my:Trade>
</xsl:template> 
```

编辑：正如 Dimitre 所指出的，这*不会*将复制的节点放入新的命名空间，只会将 Trade 元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T19:45:15.200

Dimitre Novatchev 的解决方案很好，但我还要注意，如果您也需要更改嵌套元素的命名空间，以下方法会更好：

```
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output omit-xml-declaration="yes" indent="yes"/>

  <xsl:template match="zzz">
    <trade ID="{TradeId}">
      <xsl:apply-templates select="*[not(self::TradeId)]" mode="change-ns"/>
    </trade>
  </xsl:template>

  <xsl:template match="@*|node()" priority="-10" mode="change-ns">
    <xsl:copy/>
  </xsl:template>

  <xsl:template match="*" mode="change-ns">
    <xsl:element name="{name()}" namespace="my:Trade">
      <xsl:apply-templates select="@*|node()" mode="change-ns"/>
    </xsl:element>
  </xsl:template>
</xsl:stylesheet> 
```

例如，如果您有以下输入文档

```
<trade ID="153">
  <x:item xmlns:x="my:Trade" someattr="1">
    <x:subitem anotherattr="2">A1</x:subitem>
    <x:subitem anotherattr="3">A2</x:subitem>
  </x:item>
  <x:item xmlns:x="my:Trade">B</x:item>
  <x:item xmlns:x="my:Trade">C</x:item>
</trade> 
```

你会得到

```
<zzz>
  <TradeId>153</TradeId>
  <x:item xmlns:x="x:x" someattr="1">
    <x:subitem anotherattr="2">A1</x:subitem>
    <x:subitem anotherattr="3">A2</x:subitem>
  </x:item>
  <x:item xmlns:x="x:x">B</x:item>
  <x:item xmlns:x="x:x">C</x:item>
</zzz> 
```

添加属性以证明它们被正确复制，并且分离模式用于名称空间更改模板，以便它们不会干扰其他代码，以防您想将它们用作更大样式表的一部分。

# c# - 如何扩展标记的枚举

> ID：553905
> 
> 赞同：1
> 
> 时间：2009-02-16T16:33:19.453
> 
> 标签：c#

我有这样的组合键

```
Keys key=Keys.Control | Keys.Shift | Keys.D ... 
```

我不知道如何将键变量扩展为单独的键值。也许像这样

```
foreach(Keys k in key)
{
   MessageBox.Show(k.ToString());
} 
```

这对我来说似乎很愚蠢。这该怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-16T16:39:01.373

参见键的定义。除以下值外，所有值都充当正常的互斥值：

```
//     The bitmask to extract a key code from a key value.
KeyCode = 65535,
//     The SHIFT modifier key.
Shift = 65536,
//     The CTRL modifier key.
Control = 131072,
//     The ALT modifier key.
Alt = 262144, 
```

因此，您需要检查的只是 alt、control 和 shift。要获取非移位键，请使用

```
Keys value = key & Keys.KeyCode 
```

确定是否按下了 shift、alt 或 control

```
bool altValue = key & Keys.Alt
bool controlValue = key & Keys.Control
bool shiftValue = key & Keys.Shift 
```

就是这样

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T17:57:19.280

假设它是一个基于 int 的枚举，其组件值为 1、2、4... 2^n，您可以使用：

```
public static IEnumerable<T> DecomposeEnum<T>(T value) where T : struct
{
    int intValue = (int)(object) value;
    for (int bit = 0; bit < 32 && intValue >> bit != 0; bit++)
    {
        int candidate = 1 << bit;
        if ((candidate & intValue) != 0)
        {
            yield return (T) (object) candidate;
        }
    }
} 
```

这在装箱和拆箱方面非常严峻，但它*主要是*有效的。为什么大部分？好吧，让我们试试这个：

```
static void Main()
{
    Keys keys = Keys.Control | Keys.Shift | Keys.D;
    foreach (Keys key in DecomposeEnum(keys))
    {
        Console.WriteLine(key);
    }
} 
```

结果是：

```
MButton
64
Shift
Control 
```

这是因为“D”不是由单个位表示，而是由位的组合表示。

上面的代码适用于“纯”标志类型（这就是我将其留在此处的原因），但如果您特别想使用 Keys，则可能需要查看其他地方。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-16T19:36:20.650

```
Keys key = Keys.Control | Keys.Shift | Keys.D;

foreach (string s in key.ToString().Split(','))
{
    Keys k = (Keys) Enum.Parse(typeof(Keys), s.Trim());

    Console.WriteLine(k);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T17:45:27.127

标记的枚举只是很好的旧位字段，因此您必须使用位操作来查看设置了哪些值，例如：

```
foreach(Key i in Enum.GetValues(typeof(Keys)))
{
    if(key & i !=0)
        MessageBox.Show(i);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T17:45:31.573

```
 foreach(int keyValue in Enum.GetValues(typeof(Keys)))
    {
        if(k & keyValue != 0)
           Console.WriteLine(((Key)keyValue).ToString() + " is pressed");
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-16T18:04:50.510

```
int i = 1;
while (key > 0) {
    if ((key & (Keys)i) > 0)
        DoSomething();
    i <<= 1;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-16T21:27:37.233

Keys 枚举具有 [Flags] 属性，因此 keys.ToString() 已经输出“Control, Shift, D”，而无需您执行所有这些操作。

# jsp - JSP 标签：在评估正文内容之前*对其进行操作

> ID：553914
> 
> 赞同：1
> 
> 时间：2009-02-16T16:36:01.630
> 
> 标签：jsp

在第一次评估之前，我无法弄清楚如何操纵正文内容。有人知道怎么做吗？

[在第一次评估后，我确实成功地操作了它，通过覆盖 doAfterBody() 方法使用 BodyTagSupport 类]。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T20:42:13.613

您可能正在寻找[BodyTag](http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/jsp/tagext/BodyTag.html) .doInitBody()

> 准备评估身体。此方法由 JSP 页面实现对象在 setBodyContent 之后和第一次评估正文之前调用。对于空标签或 doStartTag() 方法返回 SKIP_BODY 或 EVAL_BODY_INCLUDE 的非空标签，不会调用此方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T17:49:57.630

我有点不确定你想做什么，因为 jsp 标签基本上是编译成代码的。但是标签（及其主体）会产生一个称为 jsp 片段的输出，并且可以对其进行操作。

请原谅使用简单的标记语法，但您基本上可以使用

<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>

这定义了一个变量，您可以使用其他函数操作该变量。您可以稍后将此变量的内容发送到输出流。

# iis - 访问 SQL Server 2005 Reporting Services 报表管理器时返回 HTTP 400

> ID：553916
> 
> 赞同：0
> 
> 时间：2009-02-16T16:36:24.453
> 
> 标签：iis, reporting-services, reportingservices-2005

我有一个新的 SQL 2005 报告服务安装，但它不起作用。

数据库访问工作正常。

我设置了一个新的 IIS 站点，将其设置为在端口 90 上运行。它有两个虚拟文件夹 - Reports 和 ReportServer。我可以很好地访问 ReportServer，但是 Reports（报告管理器）会引发 HTTP 400 错误。

我已经更改了 rsreportserver.config 和 RSWebApplication.config 中的 URL，但它仍然会引发该错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-16T18:04:11.073

[下载Fiddler](http://www.fiddler2.com/Fiddler2/version.asp)的副本。检查以确保您的浏览器请求是您认为的那样。观察每个请求，尤其是生成 HTTP/400 的请求。你觉得这个要求好看吗？这将为您提供故障排除的基础。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T14:20:22.807

我在另一台服务器上修复了它 - 解决方案只是删除包含报表服务器和报表管理器的 IIS 站点，然后创建一个新的 IIS 站点，配置 IP 和端口映射并重新创建虚拟目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T17:47:16.513

报告服务配置工具是否报告任何错误？它在服务器上的事件日志中记录了什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T22:14:16.153

配置工具说一切都很好。

报告服务的事件日志中没有记录任何内容。

在报告服务跟踪日志中，我只能找到初始化项（设置变量的默认值）。

当我查看 IIS 日志时，我可以看到一个匿名请求来自我的 IP 地址到 /Reports，它被拒绝，然后它通过 Windows 身份验证返回，仅此而已。/Reports 不会向 /ReportServer 发出请求，它不会将我重定向到 /Reports/Folder - 我认为这是它应该做的，对吧？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-21T13:08:35.847

最后我经理来解决它。

我所做的是我删除了 IIS 网站，从普通网站（监听所有 IP 地址）开始，并在数据库中的本地管理员和 sa 上运行报告服务。

然后，确认它正在工作，我一步一步地走了：

*   更改了 IP 地址
*   更改端口
*   降低本地用户权限
*   降低数据库权限

在每一步之后，一切仍然正常。

我不知道到底是什么问题，但这有帮助。

我有另一台服务器显示相同的问题，我将从删除并重新创建网站开始（我认为这解决了问题）并会让你知道。

# .net - 实体框架和多对多查询不可用？

> ID：553918
> 
> 赞同：16
> 
> 时间：2009-02-16T16:36:36.463
> 
> 标签：.net, entity-framework, many-to-many

我正在尝试 EF，我根据多对多关系进行了大量过滤。例如，我有人员、位置和人员位置表来链接两者。我还有一个角色和角色表。

```
EDIT: Tables:

Person (personid, name)

Personlocation (personid, locationid)

Location (locationid, description)

Personrole (personid, roleid)

Role (roleid, description) 
```

EF 会给我人员、角色和位置实体。编辑：由于 EF**不会**生成 personlocation 和 personrole 实体类型，因此它们不能在查询中使用。

如何创建查询以向我提供给定位置的所有具有给定角色的人员？

在 SQL 中，查询将是

```
select p.*
from persons as p
join personlocations as pl on p.personid=pl.personid
join locations       as l  on pl.locationid=l.locationid
join personroles     as pr on p.personid=pr.personid
join roles           as r  on pr.roleid=r.roleid
where r.description='Student' and l.description='Amsterdam' 
```

我看过，但似乎找不到*简单*的解决方案。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-07-23T21:46:06.617

**笔记：**

由于它在 EF v1 中，我们不会**像**LINQ2SQL 那样将**PersonLocation**和**PersonRole**生成为实体（上面的答案是演示 LINQ2SQL 场景，不适用于该问题。）

**解决方案1：**

```
Persons.Include("Role").Include("Location") // Include to load Role and Location
       .Where(p => p.Role.Any(r => r.description == "Student") 
       && p.Location.Any(l => l.description == "Amsterdam")).ToList(); 
```

这看起来不错且简单明了，但这会生成丑陋的 SQL 脚本，并且它的性能还可以。

**解决方案2：**

这是故障。

```
 // Find out all persons in the role
   // Return IQuerable<Person> 
  var students = Roles.Where(r => r.description == "Student")
                      .SelectMany(r => r.Person);

  // Find out all persons in the location
  // Return IQuerable<Person>  
  var personsInAmsterdam = Locations.Where(l=> l.description == "Amsterdam")
                                    .SelectMany(l=>l.Person);

  // Find out the intersection that gives us students in Admsterdam.
  // Return List<Person>
     var AdmsterdamStudents = students.Intersect(personsInAmsterdam).ToList(); 
```

将上述三个步骤合二为一：

```
 //Return List<Person>
 var AdmsterdamStudents = Roles.Where(r => r.description == "Student")
                              .SelectMany(r => r.Person)
                              .Intersect
                              ( 
                                Locations
                                .Where(l=> l.description == "Amsterdam")
                                .SelectMany(l=>l.Person)
                               ).ToList(); 
```

这有点冗长。但这会生成干净的 SQL 查询并且执行良好。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-16T18:42:47.317

在 Lambda 中：

```
 var persons = Persons.Where(p=>(p.PersonLocations.Select(ps=>ps.Location)
   .Where(l=>l.Description == "Amsterdam").Count() > 0)
    && (p.PersonRoles.Select(pr=>pr.Role)
   .Where(r=>r.Description == "Student").Count() > 0)); 
```

**查询结果：**

```
SELECT [t0].[personId] AS [PersonId], [t0].[description] AS [Description]
FROM [Persons] AS [t0]
WHERE (((
    SELECT COUNT(*)
    FROM [personlocations] AS [t1]
    INNER JOIN [Locations] AS [t2] ON [t2].[locationid] = [t1].[locationid]
    WHERE ([t2].[description] = @p0) AND ([t1].[personid] = [t0].[personId])
    )) > @p1) AND (((
    SELECT COUNT(*)
    FROM [PersonRoles] AS [t3]
    INNER JOIN [Roles] AS [t4] ON [t4].[roleid] = [t3].[roleid]
    WHERE ([t4].[description] = @p2) AND ([t3].[personid] = [t0].[personId])
    )) > @p3) 
```

**使用包含（）：**

```
var persons = Persons
            .Where(p=>(p.Personlocations.Select(ps=>ps.Location)
            .Select(l=>l.Description).Contains("Amsterdam")) && 
            (p.PersonRoles.Select(pr=>pr.Role)
            .Select(r=>r.Description).Contains("Student"))); 
```

**查询结果：**

```
SELECT [t0].[personId] AS [PersonId], [t0].[description] AS [Description]
FROM [Persons] AS [t0]
WHERE (EXISTS(
    SELECT NULL AS [EMPTY]
    FROM [personlocations] AS [t1]
    INNER JOIN [Locations] AS [t2] ON [t2].[locationid] = [t1].[locationid]
    WHERE ([t2].[description] = @p0) AND ([t1].[personid] = [t0].[personId])
    )) AND (EXISTS(
    SELECT NULL AS [EMPTY]
    FROM [PersonRoles] AS [t3]
    INNER JOIN [Roles] AS [t4] ON [t4].[roleid] = [t3].[roleid]
    WHERE ([t4].[description] = @p1) AND ([t3].[personid] = [t0].[personId])
    )) 
```

**使用加入（）：**

```
var persons = Persons
        .Join(Personlocations, p=>p.PersonId, ps=>ps.Personid,
(p,ps) => new {p,ps})
.Where(a => a.ps.Location.Description =="Amsterdam")
        .Join(PersonRoles,
pr=> pr.p.PersonId, r=>r.Personid,(pr,r) => new {pr.p,r})
.Where(a=>a.r.Role.Description=="Student")
        .Select(p=> new {p.p}); 
```

查询结果：

```
SELECT [t0].[personId] AS [PersonId], [t0].[description] AS [Description]
FROM [Persons] AS [t0]
INNER JOIN [personlocations] AS [t1] ON [t0].[personId] = [t1].[personid]
INNER JOIN [Locations] AS [t2] ON [t2].[locationid] = [t1].[locationid]
INNER JOIN [PersonRoles] AS [t3] ON [t0].[personId] = [t3].[personid]
INNER JOIN [Roles] AS [t4] ON [t4].[roleid] = [t3].[roleid]
WHERE ([t4].[description] = @p0) AND ([t2].[description] = @p1) 
```

您可能希望使用大数据进行更快的测试。

祝你好运。

朱利亚诺·莱梅斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-19T19:59:09.577

找到有关此的更多信息，实体处理多对多的方式和原因：

[ASP.NET 博客 - 实体框架中的多对多映射](http://weblogs.asp.net/zeeshanhirani/archive/2008/08/21/many-to-many-mappings-in-entity-framework.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T20:03:00.150

好的，据我所知，LINQ 没有任何规定。Lambda 表达式确实适用于 any()。

# asp.net - 自定义 ASP.NET MVC 404 错误页面的路由

> ID：553922
> 
> 赞同：120
> 
> 时间：2009-02-16T16:37:04.920
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-routing, http-status-code-404, custom-error-pages

当有人在 ASP.NET MVC 中键入的 URL 未调用有效操作或控制器时，我试图创建一个自定义 HTTP 404 错误页面，而不是显示通用的“找不到资源”ASP.NET 错误。

我不想使用 web.config 来处理这个问题。

有没有什么我可以做的路由魔法来捕捉任何无效的 URL？

**更新：**我尝试了给出的答案，但是我仍然收到丑陋的“找不到资源”消息。

**另一个更新：**好的，显然 RC1 发生了一些变化。我什至尝试专门在 an 上捕获 404 `HttpException`，但它仍然只是给我“找不到资源”页面。

我什至使用了 MvcContrib 的资源功能，但什么也没有——同样的问题。有任何想法吗？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2011-09-16T08:58:14.337

我尝试在生产服务器上启用自定义错误 3 小时，似乎我找到了最终解决方案，如何在没有任何路由的 ASP.NET MVC 中执行此操作。

要在 ASP.NET MVC 应用程序中启用自定义错误，我们需要（IIS 7+）：

1.  在 web config`system.web`部分下配置自定义页面：

    ```
    <customErrors mode="RemoteOnly"  defaultRedirect="~/error">
        <error statusCode="404" redirect="~/error/Error404" />
        <error statusCode="500" redirect="~/error" />
    </customErrors> 
    ```

    `RemoteOnly`意味着在本地网络上你会看到真正的错误（在开发过程中非常有用）。我们还可以为任何错误代码重写错误页面。

2.  设置魔术响应参数和响应状态码（在错误处理模块或错误句柄属性中）

    ```
     HttpContext.Current.Response.StatusCode = 500;
      HttpContext.Current.Response.TrySkipIisCustomErrors = true; 
    ```

3.  在 web config 部分下设置另一个魔术设置`system.webServer`：

    ```
    <httpErrors errorMode="Detailed" /> 
    ```

这是我发现的最后一件事，之后我可以在生产服务器上看到自定义错误。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-08-17T16:00:29.883

我通过创建返回本文中的视图的 ErrorController 使我的错误处理工作。我还必须将“Catch All”添加到 global.asax 中的路线。

如果它不在 Web.config.. 中，我看不到它如何到达这些错误页面中的任何一个？我的 Web.config 必须指定：

```
customErrors mode="On" defaultRedirect="~/Error/Unknown" 
```

然后我还补充说：

```
error statusCode="404" redirect="~/Error/NotFound" 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-11-03T12:07:57.367

[来源](http://yassershaikh.com/how-to-handle-404-not-found-errors-effectively-with-asp-net-mvc-4/)

[NotFoundMVC](https://github.com/andrewdavey/NotFoundMvc) - 只要在 ASP.NET MVC3 应用程序中找不到控制器、操作或路由，就会提供用户友好的 404 页面。将呈现一个名为 NotFound 的视图，而不是默认的 ASP.NET 错误页面。

您可以使用以下方法通过 nuget 添加此插件：Install-Package NotFoundMvc

NotFoundMvc 在 Web 应用程序启动期间自动安装。它处理 404 HttpException 通常由 ASP.NET MVC 抛出的所有不同方式。这包括缺少的控制器、动作和路由。

**分步安装指南：**

1 - 右键单击​​您的项目并选择管理 Nuget 包...

2 - 搜索`NotFoundMvc`并安装它。 ![在此处输入图像描述](https://i.stack.imgur.com/YKPRh.png)

3 - 安装完成后，两个文件将添加到您的项目中。如下图所示。

![在此处输入图像描述](https://i.stack.imgur.com/ozMbX.png)

4 - 打开 Views/Shared 中新添加的 NotFound.cshtml 并随意修改。现在运行应用程序并输入错误的 url，您将看到一个用户友好的 404 页面。

![在此处输入图像描述](https://i.stack.imgur.com/3S68S.png)

不再，用户会收到类似的错误消息`Server Error in '/' Application. The resource cannot be found.`

希望这可以帮助 ：）

PS：感谢[Andrew Davey](http://aboutcode.net/)制作了这么棒的插件。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-03-15T06:20:26.173

在 web.config 中尝试此操作以替换 IIS 错误页面。我猜这是最好的解决方案，它也发出正确的状态码。

```
<system.webServer>
  <httpErrors errorMode="Custom" existingResponse="Replace">
    <remove statusCode="404" subStatusCode="-1" />
    <remove statusCode="500" subStatusCode="-1" />
    <error statusCode="404" path="Error404.html" responseMode="File" />
    <error statusCode="500" path="Error.html" responseMode="File" />
  </httpErrors>
</system.webServer> 
```

[Tipila 提供](http://tipila.com/tips/21/use-custom-error-pages-aspnet-mvc)的更多信息- 使用自定义错误页面 ASP.NET MVC

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-03-19T21:58:42.860

此解决方案不需要更改 web.config 文件或包罗万象的路由。

首先，像这样创建一个控制器；

```
public class ErrorController : Controller
{
    public ActionResult Index()
    {
        ViewBag.Title = "Regular Error";
        return View();
    }

    public ActionResult NotFound404()
    {
        ViewBag.Title = "Error 404 - File not Found";
        return View("Index");
    }
} 
```

然后在“Views/Error/Index.cshtml”下创建视图为；

```
 @{
      Layout = "~/Views/Shared/_Layout.cshtml";
  }                     
  <p>We're sorry, page you're looking for is, sadly, not here.</p> 
```

然后在 Global asax 文件中添加以下内容，如下所示：

```
protected void Application_Error(object sender, EventArgs e)
{
        // Do whatever you want to do with the error

        //Show the custom error page...
        Server.ClearError(); 
        var routeData = new RouteData();
        routeData.Values["controller"] = "Error";

        if ((Context.Server.GetLastError() is HttpException) && ((Context.Server.GetLastError() as HttpException).GetHttpCode() != 404))
        {
            routeData.Values["action"] = "Index";
        }
        else
        {
            // Handle 404 error and response code
            Response.StatusCode = 404;
            routeData.Values["action"] = "NotFound404";
        } 
        Response.TrySkipIisCustomErrors = true; // If you are using IIS7, have this line
        IController errorsController = new ErrorController();
        HttpContextWrapper wrapper = new HttpContextWrapper(Context);
        var rc = new System.Web.Routing.RequestContext(wrapper, routeData);
        errorsController.Execute(rc);

        Response.End();
} 
```

如果您在执行此操作后仍然收到自定义 IIS 错误页面，请确保在 Web 配置文件中将以下部分注释掉（或为空）：

```
<system.web>
   <customErrors mode="Off" />
</system.web>
<system.webServer>   
   <httpErrors>     
   </httpErrors>
</system.webServer> 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-02-16T17:40:51.630

只需在路线表的末尾添加捕获所有路线并显示您想要的任何页面。

请参阅：[我如何制作一条捕获所有路由来处理 ASP.NET MVC 的“404 页面未找到”查询？](https://stackoverflow.com/questions/310580/how-can-i-make-a-catch-all-route-to-handle-404-page-not-found-queries-for-asp)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2015-05-25T08:30:58.610

如果你在 MVC 4 中工作，你可以观看[这个](http://thirteendaysaweek.com/2012/09/25/custom-error-page-with-asp-net-mvc-4/)解决方案，它对我有用。

将以下 Application_Error 方法添加到我的`Global.asax`：

```
protected void Application_Error(object sender, EventArgs e)
{
    Exception exception = Server.GetLastError();
    Server.ClearError();

    RouteData routeData = new RouteData();
    routeData.Values.Add("controller", "Error");
    routeData.Values.Add("action", "Index");
    routeData.Values.Add("exception", exception);

    if (exception.GetType() == typeof(HttpException))
    {
        routeData.Values.Add("statusCode", ((HttpException)exception).GetHttpCode());
    }
    else
    {
        routeData.Values.Add("statusCode", 500);
    }

    IController controller = new ErrorController();
    controller.Execute(new RequestContext(new HttpContextWrapper(Context), routeData));
    Response.End(); 
```

控制器本身非常简单：

```
public class ErrorController : Controller
{
    public ActionResult Index(int statusCode, Exception exception)
    {
        Response.StatusCode = statusCode;
        return View();
    }
} 
```

[在 GitHub 上查看 Mvc4CustomErrorPage](https://github.com/13daysaweek/Mvc4CustomErrorPage)的完整源代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-27T15:35:27.837

我有同样的问题，你必须做的是，而不是在你的 Views 文件夹的 web.config 文件中添加 customErrors 属性，你必须将它添加到你的项目根文件夹的 web.config 文件中

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-22T16:13:23.400

这是真正的答案，它允许在单个位置完全自定义错误页面。无需修改 web.config 或创建单独的代码。

也适用于 MVC 5。

将此代码添加到控制器：

```
 if (bad) {
            Response.Clear();
            Response.TrySkipIisCustomErrors = true;
            Response.Write(product + I(" Toodet pole"));
            Response.StatusCode = (int)HttpStatusCode.NotFound;
            //Response.ContentType = "text/html; charset=utf-8";
            Response.End();
            return null;
        } 
```

基于[http://www.eidias.com/blog/2014/7/2/mvc-custom-error-pages](http://www.eidias.com/blog/2014/7/2/mvc-custom-error-pages)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-03-11T16:00:00.610

我会讲一些具体的案例，

如果您在 HomeController 中使用“PageNotFound 方法”，如下所示

```
[Route("~/404")]
public ActionResult PageNotFound()
{
  return MyView();
} 
```

这行不通。但是您必须清除如下所示的路线标签，

```
//[Route("~/404")]
public ActionResult PageNotFound()
{
  return MyView();
} 
```

如果您将其更改为 web.config 中的方法名称，**则它可以工作。** 但是不要忘记在 web.config 中执行如下代码

```
<customErrors mode="On">
  <error statusCode="404" redirect="~/PageNotFound" /> 
 *// it is not "~/404" because it is not accepted url in Route Tag like [Route("404")]*
</customErrors> 
```

# 3d - 切片 NURBS 曲面

> ID：553928
> 
> 赞同：4
> 
> 时间：2009-02-16T16:38:20.983
> 
> 标签：3d, slice, geometry-surface, nurbs, geometry-slice

我有一个[NURBS 曲面](http://en.wikipedia.org/wiki/NURBS)，它有 4 个弯曲的边缘。*（我有 4 个贝塞尔曲线点）*

我想用在轴上的切片平面*（不如 3DSMAX 先进！）*对 NURBS 曲面进行切片，并计算切片平面和 NURBS 曲面相交的曲线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T21:10:22.163

嗯..“NURBS”中的 R 是理性的。这是两个多项式的除法。您的（轴对齐）平面为您提供了一组非常简单有趣的点，(x,y,z) 使得 z 是给定的 z。解决。也许不是很有帮助。这更像你的想法吗[？](http://www.risc.uni-linz.ac.at/projects/basic/cgal/workdone/nurbs-97-30.ps.gz)

# asp.net-mvc - In MVC, how do I return a string result?

> ID：553936
> 
> 赞同：677
> 
> 时间：2009-02-16T17:44:58.220
> 
> 标签：asp.net-mvc, ajax, actionresult

In my AJAX call, I want to return a string value back to the calling page.

Should I use `ActionResult` or just return a string?

* * *

## 回答 #1

> 赞同：1151
> 
> 时间：2009-02-16T17:47:51.753

You can just use the [`ContentResult`](https://msdn.microsoft.com/en-us/library/system.web.mvc.contentresult.aspx "MSDN documentation") to return a plain string:

```
public ActionResult Temp() {
    return Content("Hi there!");
} 
```

[`ContentResult`](https://msdn.microsoft.com/en-us/library/system.web.mvc.contentresult.aspx "MSDN documentation") by default returns a `text/plain` as its [contentType](https://en.wikipedia.org/wiki/Media_type "Wikipedia"). This is overloadable so you can also do:

```
return Content("<xml>This is poorly formatted xml.</xml>", "text/xml"); 
```

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2009-02-16T23:29:58.390

You can also just return string if you know that's the only thing the method will ever return. For example:

```
public string MyActionName() {
  return "Hi there!";
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2016-04-27T14:18:44.853

```
public ActionResult GetAjaxValue()
{
   return Content("string value");
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-05-04T08:20:09.967

As of 2020, using [`ContentResult`](https://msdn.microsoft.com/en-us/library/system.web.mvc.contentresult.aspx) is still the right approach as proposed [above](https://stackoverflow.com/a/553952/2484903), but the usage is as follows:

```
return new System.Web.Mvc.ContentResult
{
    Content = "Hi there! ☺",
    ContentType = "text/plain; charset=utf-8"
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-10T16:58:12.647

There Are 2 ways to return a string from the controller to the view:

First

> You could return only the string, but it will not be included in your .cshtml file. it will be just a string appearing in your browser.

Second

> You could return a string as the Model object of View Result.

Here is the code sample to do this:

```
public class HomeController : Controller
{
    // GET: Home
    // this will return just a string, not html
    public string index()
    {
        return "URL to show";
    }

    public ViewResult AutoProperty()
    {   
        string s = "this is a string ";
        // name of view , object you will pass
        return View("Result", s);

    }
} 
```

In the view file to run **AutoProperty**, It will redirect you to the **Result** view and will send **s**
code to the view

```
<!--this will make this file accept string as it's model-->
@model string

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Result</title>
</head>
<body>
    <!--this will represent the string -->
    @Model
</body>
</html> 
```

> I run this at http://localhost:60227/Home/AutoProperty.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-16T12:45:51.257

```
public JsonResult GetAjaxValue() 
{
  return Json("string value", JsonRequetBehaviour.Allowget); 
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-17T14:01:52.517

you can just return a string but some API's do not like it as the response type is not fitting the response,

```
[Produces("text/plain")]
public string Temp() {
    return Content("Hi there!");
} 
```

this usually does the trick

# visual-studio - 将文件添加到项目时会引发什么事件？

> ID：553938
> 
> 赞同：1
> 
> 时间：2009-02-16T17:45:13.803
> 
> 标签：visual-studio, vsx, extensibility

在项目（.vcproj 或 .csproj）中添加/删除新文件或现有文件时会引发哪些事件？

我实际上想处理所有可能的事件，这些事件可能会根据添加或删除的项目项改变项目结构。

这是在为 Visual Studio 创建加载项的上下文中。任何人都可以告诉我至少事件名称，以便我查找吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-16T19:39:53.293

也许你需要听听 Namespace EnvDTE 中 ProjectsEvents 的 ItemAdded、ItemRemoved、ItemRenamed。这里是[MSDN](http://msdn.microsoft.com/en-us/library/envdte.projectsevents(VS.80).aspx)链接。

# c# - C# 在计时器中添加和删除事件

> ID：553942
> 
> 赞同：8
> 
> 时间：2009-02-16T17:45:34.473
> 
> 标签：c#, event-handling

我正在尝试从计时器中添加和删除事件，并且我有以下代码：

```
Timer myTimer = new Timer(); // Windows.Forms Timer

public void addEvent(MyDelegate ev)
{
    myTimer.Tick += new EventHandler(ev);
}

public void removeEvent(MyDelegate ev)
{
    myTimer.Tick -= new EventHandler(ev);
} 
```

我不知道如果我在尝试以这种方式添加和删除代表时做了任何愚蠢的事情，我可以添加代表并让它们按预期触发。但是，当我尝试删除这些事件时，它们会继续在 Timers Tick 上触发。

任何人都可以看到明显的错误吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-16T18:00:28.307

我相信这段代码：

```
myTimer.Tick -= new EventHandler(ev); 
```

创建一个新的 EventHandler 对象。它永远不会删除现有的 EventHandler。要获得您想要的功能，您应该将 EventHandlers 而不是 MyDelegates 传递给 add 和 remove 方法：

```
Timer myTimer = new Timer(); // Windows.Forms Timer

public void addEvent(EventHandler ev)
{
    myTimer.Tick += ev;
}

public void removeEvent(EventHandler ev)
{
    myTimer.Tick -= ev;
} 
```

调用代码必须跟踪添加的 EventHandler，以便在取消订阅时可以传入相同的 EventHandler 对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T21:55:54.667

初始代码工作正常，只要传入的 ' '是`MyDelegate`同一个对象实例（例如，如果有一个包含该实例的类级字段，或者如果您在这里遵循其他几个人的建议并保留该对象(s) 在字典中)。`ev``addEvent``removeEvent``MyDelegate``MyDelegate`

我怀疑问题是代码调用`addEvent`并`removeEvent`传递`MyDelegate`指向某个处理程序方法的新实例，如下所示：

```
addEvent(new MyDelegate(this.HandlerMethod));
// ... do some stuff
removeEvent(new MyDelegate(this.HandlerMethod)); 
```

在这种情况下`addEvent`，并且`removeEvent`正在创建`EventHandler`指向不同方法地址的委托，即使这些委托又指向同一个方法（`this.HandlerMethod`）。这是因为`EventHandler`委托`add`和`remove`create 指向`MyDelegate.Invoke()`不同`MyDelegate`实例上的方法，而不是直接指向`this.HandlerMethod`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-16T18:00:36.527

您的问题来自于使用辅助方法来执行此操作。没有它们，它可以按预期工作，有了它们，它不知道要解开什么。

要解决此问题，您需要维护一个字典，其值是在挂钩方法中创建的 EventHandler，以便以后可以删除该值。

就像是：

```
var handlers = new Dictionary<MyDelegate, EventHandler>();

public void addEvent(MyDelegate ev)
{
    var handler = new EventHandler(ev);
    handlers.Add(ev, handler);
    myTimer.Tick += handler;
}

public void removeEvent(MyDelegate ev)
{
    myTimer.Tick -= handlers[ev];
} 
```

如果元素存在，您应该添加适当的检查。

您还可以更改参数类型，它将按预期工作。

```
public void addEvent(EventHandler ev)
{
    myTimer.Tick += ev;
}

public void removeEvent(EventHandler ev)
{
    myTimer.Tick -= ev;
}

addEvent(new EventHandler(...));
removeEvent(new EventHandler(...)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T17:51:24.287

您应该可以通过引用您的偶数处理方法的名称来取消订阅，如下所示：

```
public void removeEvent(MyDelegate ev)
{
    myTimer.Tick -= ev as EventHandler;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-16T18:01:40.177

我不知道你做错了什么，但我对定时器使用的通常方法是订阅`Tick`事件，然后在你不想接收事件时禁用定时器，当你重新启用做。

如果您有多个事件处理程序连接到事件，可能对您没有帮助，但希望有一些用处。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-02T23:55:34.793

这应该有效：

```
private void timer_Tick(object sender, EventArgs e)
{
    try
    {
        // Disallow re-entry
        timer.Tick -= timer_Tick;
        . . .
    }
    finally
    {
        timer.Tick += timer_Tick;
    }
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-16T17:55:45.277

添加和删​​除事件处理程序时，您每次都在为您的委托创建一个新的包装器。因此，在您的 remove 方法中，它试图删除一个*新*的EventHandler 对象，该对象从未作为事件的侦听器首先添加。

如果您想继续使用这种类型的设置，您可以将您的 EventHandlers 粘贴到字典中。在 addEvent 方法中，将新创建的 EventHandler 粘贴到字典中，在 removeEvent 方法中，从字典中拉出 EventHandler 并将其删除，而不是实例化一个新的。

# sql - 需要 SQL 业务逻辑

> ID：553944
> 
> 赞同：0
> 
> 时间：2009-02-16T17:45:57.717
> 
> 标签：sql

我正在寻找具有业务逻辑的难以理解、大型、纯可读且不支持的 SQL 脚本。我需要一些夸张的东西来说明代码与 SQL 业务逻辑。可能你有一个吗？

更新：我正在寻找可怕的 SQL 示例。我不是在寻找这些风格的业务逻辑的比较。可能是你开始继承可怕的 SQL 逻辑的任务，你可以分享它。这可能是荒谬的、有趣的或类似的。实际上，不需要逻辑查询也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T17:49:19.143

任何带触发器的东西。它们将代码隐藏在意想不到的地方，并产生难以调试的副作用。当然，触发器有它们的位置，但您绝对需要谨慎使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T18:44:27.920

公平的比较将在代码与 sql 中显示*相同*的业务逻辑

其他任何事情都在将苹果与橙子进行比较——或者更糟糕的是，堆叠甲板以支持已成定局

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T18:01:20.270

我发布了一些我在现实世界中遇到的讨厌的 SQL：

[在存储过程中嵌入 UI 逻辑](https://stackoverflow.com/questions/346659/what-are-the-most-common-sql-anti-patterns/346850#346850)

[数据库搜索的一个抱歉的借口](https://stackoverflow.com/questions/434414/what-is-the-most-evil-code-you-have-ever-seen-in-a-production-enterprise-environm/434562#434562)（该帖子的底部附近）

也许一个更简单的例子是使用游标来执行可以使用基本 SQL 更容易完成的功能。例如，将使用 WHERE 或 GROUP BY 子句的简单查询与使用游标实现相同功能的存储过程进行比较。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T17:53:09.010

用糟糕的 SQL 来证明你的观点是行不通的，因为它不能证明除了人们可以编写糟糕的 SQL 之外的任何东西。可能存在与您想要证明的完全相反的错误代码。

您可能想研究描述现有开发团队的能力。如果编码是他们的强项而不是 SQL，那么这就是应该采取的路线。

# mysql - MySql搬家的区别？

> ID：553950
> 
> 赞同：1
> 
> 时间：2009-02-16T17:47:46.620
> 
> 标签：mysql, math, calculated-columns

假设我有这个代码

```
create temporary table somedata (a integer);
insert into somedata (a) values (11), (25), (62); --#these values are always increasing
select * from somedata; 
```

给这个

```
+--+
|a |
+--+
|11|
|25|
|62|
+--+ 
```

如何计算一列值“b”，其中每个值是当前行中“a”值与前一行中“a”值之间的差值？

```
+--+--+
|a |b |
+--+--+
|11| 0| # ie 11-11 since theres no preceding row
|25|14| # ie 25-11
|62|37| # ie 62-25 etc
+--+--+ 
```

这在 openoffice 或 excel 中是如此明显，以至于我觉得在 MySql 的网站或其他任何地方都没有找到如何做到这一点有点傻。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T17:55:21.453

如果您有一个 auto_increment 列来为每一行提供自己的 id 会更容易 - 然后您可以在 (alias2.id=alias1.id+1) 上加入表并计算与 alias2.a-alias1.a 的差异

事实上，我认为唯一的方法是使用子查询来获取小于当前行值的最大值 a，这将非常低效。

因此，如果可以，请修改您的架构！

```
create table somedata (
    id int auto_increment not null, 
    a integer, 
    primary key(id)
);
insert into somedata (a) values (11), (25), (62); 

select a2.a,ifnull(a2.a-a1.a, 0) as diff  
from somedata  as a1 
right join somedata  as a2 on (a2.id=a1.id+1);

+------+------+
| a    | diff |
+------+------+
|   11 |    0 |
|   25 |   14 |
|   62 |   37 |
+------+------+ 
```

如果您不想要第一个零结果，请使用内连接而不是右连接。

*编辑：有关此想法的更完整演练，请参阅本文：[计算连续行之间的差异](http://www.onlamp.com/pub/a/onlamp/excerpt/mysqlckbk/index3.html?page=2)*

# debugging - 当我执行 ctrl c 时调试分段错误

> ID：553956
> 
> 赞同：27
> 
> 时间：2009-02-16T17:48:27.027
> 
> 标签：debugging, gdb, copy-paste

取消程序时出现分段错误。我正在使用 gdb 进行调试，问题是当我在调试时按 Ctrl-C 时，gdb 不会取消程序并执行它应该做的就是停止它。

我想要的是执行 Ctrl-C 并且不允许 gdb 停止它。有没有办法做到这一点？还有其他调试建议吗？我不能使用 printf ，因为我真的不清楚问题出在哪里。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-02-16T18:07:34.780

gdb 正在拦截信号。当您按下 CTRL-C 时，实际上是在使终端驱动程序生成一个 SIGINT。

您需要做的是让 GDB 使用**signal**命令生成 SIGINT。语法是

> > 信号*编号*

man signal 会告诉你信号编号（在这种情况下，SIGINT 是信号 2，所以`signal 2`会这样做。）

### 更新

果然可以使用符号名。 `info signal`会告诉你所有的名字等。

哦，顺便说一句，很可能您为 SIGINT 安装了信号处理程序，并且参数不正确。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-02-16T19:08:32.637

`handle SIGINT noprint pass`另一种方法是在运行程序之前通过在 gdb 提示符下键入来阻止 gdb 捕获 SIGINT 。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-16T17:54:04.110

一种选择是将不在调试器中运行时生成的核心文件加载到 gdb 中。在 gdb 中，键入`core-file [filename]`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-26T04:52:23.873

您还可以从另一个终端发送 CTRL-C（又名 SIGINT）：kill -INT

# apache-flex - flex 3 和 itemRenderers

> ID：553964
> 
> 赞同：-1
> 
> 时间：2009-02-16T17:50:41.403
> 
> 标签：apache-flex, flex3, itemrenderer

我有一个数据网格，其中一列我使用项目渲染器来显示内容。我想知道是否可以在 itemRenderer 的脚本块内访问数据网格的数据提供者内容。

目前，我可以使用 data.variableName 访问项目渲染器中组件中的 dataprovider。

我希望能够在脚本块中对这个变量进行一些错误处理，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-16T18:07:02.160

您可以指定自己的 ItemRenderer 组件。在该组件的 MXML 中，您可以随意使用 Script 块。

只需将该组件指定为 ItemRenderer，如下所示：

```
<mx:DataGrid dataProvider="{ac}">
mx:columns>
    <mx:DataGridColumn>
        <mx:itemRenderer>
            <mx:Component>
                <local:YourRenderer />  
            </mx:Component>
        </mx:itemRenderer>
    </mx:DataGridColumn>
</mx:columns>
</mx:DataGrid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-16T18:08:56.757

谢谢，

实际上我正在寻找的是一种方法来访问存储在我的 itemRenderer 脚本块内的数据对象中的属性，结果你可以在这里调用 data.variableName 并且它工作正常，无论如何谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T18:09:56.240

内联 itemrenderer 将具有 outerDocument 属性。这指的是托管数据网格和 itemrenderer 的文档。因此，您可以访问数据网格，从而访问它的数据提供者。

```
outerDocument.myDataGrid.dataProvider 
```

# c# - ICSharpcode TextEditor 中的自动换行

> ID：553972
> 
> 赞同：2
> 
> 时间：2009-02-16T17:53:57.650
> 
> 标签：c#, text-editor, icsharpcode

我正在使用 ICSharpcode 文本编辑器，并且正在寻找一种在其中进行自动换行的方法。除了源代码之外，还有其他文档吗？到目前为止，我唯一的文档是[Code Project 文章](http://www.codeproject.com/KB/edit/TextEditorControl.aspx)和[Kaxaml](http://www.codeplex.com/Kaxaml/SourceControl/ListDownloadableCommits.aspx)的源代码。最重要的是，如何在编辑器中打开 WordWrap？其次，我是否缺少编辑器的任何文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-20T06:09:23.740

`ICSharpCode.TextEditor`尚不支持自动换行。它将在 SharpDevelop 4 中支持它。请参阅[此](http://community.icsharpcode.net/search/SearchResults.aspx?q=word+wrap&o=Relevance)[论坛帖子](http://community.icsharpcode.net/forums/p/8879/24725.aspx#24725)等。[您可以从他们的构建服务器](http://build.sharpdevelop.net/BuildArtefacts/)下载 SharpDevelop 4 Alpha 。

为了实现对自动换行的支持，您将不得不跳很多圈。这些箍都会着火。如果你***真的***需要这个，在 SharpDevelop 3 中，一个寻找自动换行代码的好地方是Jon T 建议的[DeveloperFusion 。](http://www.developerfusion.co.uk/show/4646/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-19T17:50:49.023

我找到了有关编辑器的以下信息：

[http://community.icsharpcode.net/forums/p/100/19865.aspx](http://community.icsharpcode.net/forums/p/100/19865.aspx)

发帖人不确定原生自动换行支持，但提供了一个链接到处理自动换行的包装器：

[http://www.developerfusion.co.uk/show/4646/](http://www.developerfusion.co.uk/show/4646/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-20T06:17:11.600

自动换行很难正确处理，而且渲染器仍然很快。

# c++ - 为什么 (int)55 == 54 在 C++ 中？

> ID：553974
> 
> 赞同：20
> 
> 时间：2009-02-16T17:54:15.687
> 
> 标签：c++, fibonacci

所以我正在学习C++。我已经完成了“C++ 编程语言”和“Effective C++”，并且正在运行 Project Euler。问题 1...邓佐。问题2...不是那么多。我在 VS2008 上的 Win32 控制台应用程序上工作。

低于 400 万的斐波那契数列的所有偶数项的总和是多少？

它不起作用，所以我减少了一个 100 个测试用例......

这是我写的...

```
// Problem2.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
using namespace std;

int _tmain(int argc, _TCHAR* argv[])
{
    cout << "Project Euler Problem 2:\n\n";
    cout << "Each new term in the Fibonacci sequence is generated by adding the previous two terms. By starting with 1 and 2, the first 10 terms will be:\n\n";
    cout << "1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...\n\n";
    cout << "Find the sum of all the even-valued terms in the sequence which do not exceed four million.\n\n";
    cout << "Answer:  " << Solve();
}

double Solve() {
    int FibIndex = 0;
    double result = 0.0;
    double currentFib = GenerateNthFibonacciNumber(FibIndex);
    while (currentFib < 100.0){
        cout << currentFib << " " << (int)currentFib << " " << (int)currentFib % 2 << "\n";
        if ((int)currentFib % 2 == 0){
            result += currentFib;
            cout<<(int)currentFib;
        }
        currentFib = GenerateNthFibonacciNumber(++FibIndex);
    }
    return result;
}

double GenerateNthFibonacciNumber(const int n){
    //This generates the nth Fibonacci Number using Binet's Formula
    const double PHI = (1.0 + sqrt(5.0)) / 2.0;
    return ((pow(PHI,n)-pow(-1.0/PHI,n)) / sqrt(5.0));
} 
```

这是输出...

> 欧拉计划问题 2：
> 
> 斐波那契数列中的每个新项都是通过添加前两项来生成的。从 1 和 2 开始，前 10 个术语将是：
> 
> 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...
> 
> 求序列中所有不超过四百万的偶数项之和。
> 
> 0 0 0
> 1 1 1
> 1 1 1
> 2 2 0
> 3 3 1
> 5 5 1
> 8 8 0
> 13 13 1
> 21 21 1
> 34 34 0
> 55 54 0
> 89 89 1
> 答案：99

所以我有三列调试代码...从生成函数返回的数字，(int)generatedNumber 和 (int)generatedNumber % 2

所以在第 11 个学期，我们有

55,54,0

为什么 (int)55 = 54？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-02-16T17:58:03.197

强制转换为`int`截断数字 - 就像你打电话一样`floor(currentFib)`。因此，即使`currentFib`is `54.999999`...（一个非常接近 55 的数字，在打印时会四舍五入），`(int)currentFib`也会产生 54。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-16T17:59:04.020

由于浮点舍入，这 55 行正在计算类似 54.99999 的值。将 double 转换为 int 会立即截断 .99999。

在我的机器上，打印一列显示`(currentFib-(int)currentFib)`会显示 1.42109e-14 顺序的错误。所以它更像是 0.999999999999986。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-16T17:59:47.030

好的，简短的回答是，在任何情况下都不应该 (int)55 == 54，所以你需要开始问自己相关的代码行到底在做什么。

`==`第一个问题：与类型转换相比，绑定的强度如何？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-16T18:28:39.830

Shog9 说得对，如果要将事物转换为整数，则使用 double 类型来解决此类问题并不是最好的方法。如果您的编译器支持它，您应该使用 long long 或其他一些 64 位整数类型，这几乎肯定会保存小于 400 万斐波那契数列的所有偶数项之和的结果。

如果我们使用斐波那契数列遵循奇偶奇偶奇偶奇偶模式的事实......下面的东西应该可以解决问题。

```
...
unsigned int fib[3];
fib[0]=1;
fib[1]=1;
fib[2]=2;

unsigned long long sum=0;

while(fib[2]<4000000)
{
    sum+=fib[2];

    fib[0]=(fib[1]+fib[2]);
    fib[1]=(fib[2]+fib[0]);
    fib[2]=(fib[0]+fib[1]);
}

std::cout<<"The sum is: "<<sum<<". \n";
.... 
```

那应该可以解决问题，可能还有更快的方法，但是这个方法非常直接且易于阅读。

看着它，我意识到您可能会使用标准的无符号 32 位整数作为总和数，但我会保留它以防万一。

此外，您的代码对生成第 n 个斐波那契数函数进行了大量函数调用。一个体面的优化编译器会内联这些调用，但如果不这样做，事情就会变慢，因为函数调用比其他技术更昂贵。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-16T20:49:57.463

我 100% 同意 shog9 的回答——使用你用来计算斐波那契的算法，你必须非常小心浮点值。我发现页面[cubbi.com: fibonacci numbers in c++](http://cubbi.com/fibonacci/c++.html "cubbi.com：C++ 中的斐波那契数")似乎显示了其他获取它们的方法。

我四处寻找一个关于如何让 GenerateNthFibonacciNumber 的实现处理返回双精度 54.999999 的情况的好主意，但是当你转换为 int 或 long 时，你会得到 54。

[我在C++ Rounding](http://www.codingforums.com/archive/index.php/t-10827.html "C++ 舍入")遇到了似乎是一个合理的解决方案，我在下面的代码中对其进行了调整。

此外，这不是什么**大**问题，但您可能希望预先计算 PHI，然后将其作为参数传递或将其作为全局引用 - 现在您每次调用函数时都会重新计算它。

```
double GenerateNthFibonacciNumber(const int n)
{
        //This generates the nth Fibonacci Number using Binet's Formula   
        const double PHI = (1.0 + sqrt(5.0)) / 2.0;
        double x = ((pow(PHI,n)-pow(-1.0/PHI,n)) / sqrt(5.0));
        // inspired by http://www.codingforums.com/archive/index.php/t-10827.html
        return ((x - floor(x)) >= 0.5) ? ceil(x) : floor(x);
} 
```

最后，这是我如何重写您的 Solve() 方法，以便 GenerateNthFibonacciNumber(FibIndex) 仅在代码中的一个位置调用。我还将包含当前偶数斐波那契项的当前运行总计的列添加到您的输出中：

```
double Solve() {
    long FibIndex = 0;
    double result = 0.0;
    double oldresult = 0.0;
    int done = 0;
    const double PHI = (1.0 + sqrt(5.0)) / 2.0;

    while (!done)
    {
        double currentFib = GenerateNthFibonacciNumber(++FibIndex);
        if ((int)currentFib % 2 == 0)
        {
            oldresult = result;

            if (currentFib >= 4000000.0)
            {
                done = 1;
            }
            else
            {
                result += currentFib;
            }

        }
        cout << currentFib << " " << (int)currentFib << " " << (int)currentFib % 2 << " " << (int)result << "\n";       
    }
    return result;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-17T03:07:10.567

我知道这对您的真正问题没有帮助，但您提到您正在学习 C++。出于学习目的，我建议尽可能接近 ANSI。我认为这是`/Za`在 MSVC 上（您可能正在使用的）或`-ansi -pedantic`GCC 上。

特别是，您应该使用这些签名之一， `main`直到您有充分的（特定于平台的）理由不这样做：

```
int main(int argc, char *argv[]);
int main(int argc, char **argv); // same as the first
int main(); 
```

...而不是任何特定于平台的版本，例如这个（仅限 Windows）示例：

```
#include <windows.h> // defines _TCHAR and _tmain
int _tmain(int argc, _TCHAR* argv[]); // win32 Unicode vs. Multi-Byte 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-17T09:33:39.373

以上所有关于整数数学不要使用浮点值的建议都值得注意！

如果您想要整数“舍入”正浮点值，以便小数分量低于 0.5 的值舍入到下一个最小整数，而小数部分的值 0.5 或更大的值舍入到下一个更高的整数，例如

```
0.0 = 0
0.1 = 0
0.5 = 1
0.9 = 1
1.0 = 1
1.1 = 1
...etc... 
```

将 0.5 添加到您要投射的值。

```
double f0 = 0.0;
double f1 = 0.1;
double f2 = 0.5;
double f3 = 0.9;

int i0 = ( int )( f0 + 0.5 );  // i0 = 0
int i1 = ( int )( f1 + 0.5 );  // i1 = 0
int i2 = ( int )( f2 + 0.5 );  // i2 = 1
int i3 = ( int )( f3 + 0.5 );  // i3 = 1 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T17:17:08.167

打破生成的代码，有时浮点数的行为与我们在长表达式中使用时的想法不同......打破代码并检查它。

# c#-3.0 - 如何使用 Func 声明方法 作为输入参数？

> ID：553990
> 
> 赞同：1
> 
> 时间：2009-02-16T17:59:21.600
> 
> 标签：c#-3.0, functional-programming

嗨，

我正在写一个可以帮助我进行单元测试的课程。该类提供了对异常执行断言的方法。

到目前为止，我能够编写将没有参数且没有返回值的函数作为输入的方法。为此，我使用 System.Action - 委托。我的课看起来像这样：

```
internal static class ExceptionAssert
{
    /// <summary>
    /// Checks to make sure that the input delegate throws a exception of type TException.
    /// <para>
    /// The input delegate must be a method with no parameters and return type void!
    /// </para>
    /// </summary>
    /// <typeparam name="TException">The type of exception expected.</typeparam>
    /// <param name="methodToExecute">The method to execute.</param>
    public static void Throws<TException>(Action methodToExecute) where TException : System.Exception
    {
        try
        {
            methodToExecute();
        }
        catch (Exception e)
        {
            Assert.IsTrue(e.GetType() == typeof(TException), "Expected exception of type " + typeof(TException) + " but type of " + e.GetType() + " was thrown instead.");
            return;
        }
        Assert.Fail("Expected exception of type " + typeof(TException) + " but no exception was thrown.");
    } 
```

在单元测试中，我现在可以写：

```
ExceptionAssert.Throws<ArgumentNullException>(theProxy.LoadProduct,productNumber); 
```

现在我想写更多的方法，这些方法将方法作为输入，带参数和返回值。据我了解，通用 Func 应该服务于这个。方法签名应该是这样的：

```
public static void Throws<TException>(Func<T, TResult> methodToExecute, T methodArgument) where TException : System.Exception 
```

但这不会编译。我总是必须编写像 Func 这样的显式类型，而不是泛型。怎么了？应该可以以通用方式声明它，因为 LINQ 就是这样工作的。

编辑：

申报所有内容是个好主意，而不仅仅是一半。结果：

```
/// <summary>
/// Contains assertion types for exceptions that are not provided with the standard MSTest assertions.
/// </summary>
/// <typeparam name="T">The type of the input arguments.</typeparam>
/// <typeparam name="TResult">The type of the result.</typeparam>
/// <remarks>
/// The standard test framework has an Attribute called <see cref="ExpectedExceptionAttribute">ExpectedExceptionAttribute</see>. This attribute has two
/// main disadvantages:
/// <para>
/// 1\. The unit test stops at the line which throws the expected exception. If you want to test a method which throws a bunch of exceptions
/// you must write a test for each exception.
/// 2\. The attribute does not specify exactly where the exception has to be thrown. So if a method call earlier than expected throws
/// suddenly the same exception, the whole test is still o.k.
/// </para>
/// So this class can be used like the common assertions. You can test a method at a specific line in the test for a specific exception.
/// </remarks>
internal static class ExceptionAssert<T,TResult>
{
    /// <summary>
    /// Checks to make sure that the input delegate throws a exception of type TException.
    /// <para>
    /// The input delegate must be a method with no parameters and return type void!
    /// </para>
    /// </summary>
    /// <typeparam name="TException">The type of exception expected.</typeparam>
    /// <param name="methodToExecute">The method to execute.</param>
    public static void Throws<TException>(Action methodToExecute) where TException : System.Exception
    {
        try
        {
            methodToExecute();
        }
        catch (Exception e)
        {
            Assert.IsTrue(e.GetType() == typeof(TException), "Expected exception of type " + typeof(TException) + " but type of " + e.GetType() + " was thrown instead.");
            return;
        }
        Assert.Fail("Expected exception of type " + typeof(TException) + " but no exception was thrown.");
    }

    /// <summary>
    /// Checks to make sure that the input delegate throws a exception of type TException with a specific exception message.
    /// <para>
    /// The input delegate must be a method with no parameters and return type void!
    /// </para>
    /// </summary>
    /// <typeparam name="TException">The type of exception expected.</typeparam>
    /// <param name="expectedMessage">The expected exception message.</param>
    /// <param name="methodToExecute">The method to execute.</param>
    /// <remarks>
    /// This method asserts if the given message and the message of the thrown exception are not equal!
    /// </remarks>
    public static void Throws<TException>(string expectedMessage, Action methodToExecute) where TException : System.Exception
    {
        try
        {
            methodToExecute();
        }
        catch (Exception e)
        {
            Assert.IsTrue(e.GetType() == typeof(TException), "Expected exception of type " + typeof(TException) + " but type of " + e.GetType() + " was thrown instead.");
            Assert.AreEqual(expectedMessage, e.Message, "Expected exception with a message of '" + expectedMessage + "' but exception with message of '" + e.Message + "' was thrown instead.");
            return;
        }
        Assert.Fail("Expected exception of type " + typeof(TException) + " but no exception was thrown.");
    }

    /// <summary>
    /// Checks to make sure that the input delegate throws a exception of type TException with a specific exception message.
    /// <para>
    /// The input delegate must be a method with ONE parameter and return type!
    /// </para>
    /// </summary>
    /// <typeparam name="TException">The type of the exception.</typeparam>
    /// <param name="methodToExecute">The method to execute.</param>
    /// <param name="argument">The argument to input.</param>
    public static void Throws<TException>(Func<T,TResult> methodToExecute, T argument) 
        where TException : System.Exception
    {
        try
        {
            methodToExecute(argument);
        }
        catch (Exception e)
        {
            Assert.IsTrue(e.GetType() == typeof(TException), "Expected exception of type " + typeof(TException) + " but type of " + e.GetType() + " was thrown instead.");
            return;
        }
        Assert.Fail("Expected exception of type " + typeof(TException) + " but no exception was thrown.");
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-16T18:06:29.197

您也应该“声明” T 和 TResult，例如

```
public static void Throws<T, TResult, TException>(Func<T, TResult> methodToExecute, T methodArgument) where TException : System.Exception 
```

否则编译器不知道 T 和 TResult 是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-16T18:10:32.573

这编译：

```
 public static void Throws<TException, T, TResult>(Func<T, TResult> methodToExecute, T methodArgument) where TException : System.Exception 
```

这会给你想要的结果吗？***************