# StackOverflow 问答 11908000-11908999

# firefox - Firefox CSS：破折号上的断字

> ID：11908002
> 
> 赞同：0
> 
> 时间：2012-08-10T19:25:02.867
> 
> 标签：firefox, css, word-wrap

我有一个包含文本 Snow-boarding 的 HTML 元素，容器元素没有足够的空间来容纳一行中的文本，所以我需要将它分成两行。

在 Chrome 中，这是自动完成的（我猜它假设它是两个词，并在第一行留下“Snow-”，在第二行留下“boarding”）。然而，在 Firefox 中，它只是将其保留在一行中，并延伸到容器之外。我正在考虑使用 CSS 属性“word-wrap”，它确实破坏了这个词，但它并没有在破折号中破坏它（它在一行中留下“Snow-boardi”，在另一行中留下“ng”）。

这是 jsFiddle：http: [//jsfiddle.net/jSrLb/5/](http://jsfiddle.net/jSrLb/5/)

有什么办法吗？

谢谢

# javascript - 在后面的代码中返回“完整”clientID（asp.net VB）

> ID：11908003
> 
> 赞同：1
> 
> 时间：2012-08-10T19:25:07.673
> 
> 标签：javascript, asp.net, vb.net, clientid

所以我在访问 ASP.NET 用户控件的正确 clientID 属性时遇到了问题。

我的主要问题是我正在尝试使用 VB 代码隐藏返回控件的完整 ClientID 字段。我的控件（以及浏览器中显示的内容）的预期值是：

*   ctl00_ContentPlaceHolder1_ctl05_txtAnswer

但我只在代码隐藏中得到“txtAnswer”。

我在这里找到了类似的东西：

[ASP.Net：ClientID 在用户控件的代码隐藏中不正确](https://stackoverflow.com/questions/3562198/asp-net-clientid-not-correct-in-code-behind-of-a-user-control)

这篇文章建议在 onPreRender 或 onPageLoad 等期间添加 onClick 事件，但我还有其他情况：

*   我的用户控件（文本框）旨在从数据库“预加载”值（如果同一用户之前曾尝试访问表单），或者如果 isPostBack == true。

*   因为我正在从数据库中读取答案，并且因为有 JS 函数（它使用*getElementByID()* JS 函数），所以控件需要访问用户数据......

*   目前该控件有一个成员函数*loadQuestions(key parameters)*从数据库中加载特定的问题。

*   更多上下文：我正在更新一些具有硬编码（在客户端 ASPX 文件中）控件元素的旧代码，但现在控件是在运行时动态构建的（即，插入到客户端页面中的占位符中）。

*   我尝试过使用不同的 ClientIDMode 设置（根据[http://msdn.microsoft.com/en-us/library/system.web.ui.clientidmode.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.clientidmode.aspx)），但到目前为止还没有骰子......我正在使用.NET 4.0，所以我知道我可以通过“静态”clientIDmode 直接编辑 ClientID，但我还没有尝试过......

现在我在想我应该将所有定义内容的东西“预先加载”到对象的构造函数中，然后应用所有定义内容的东西，然后在控件的数据之后建立 onClick 属性人口稠密？

以供参考：

这是控件的 ASP 标记：

```
<%@ Control Language="VB" AutoEventWireup="false" CodeFile="RBHorizWithText.ascx.vb" Inherits="Apps_Controls_RBHorizWithText" %>
<%@ Register Assembly="txtBoxLengthValidator" Namespace="txtBoxLengthValidator" TagPrefix="cc1" %>

<asp:Panel ID="pnlPreamble" runat="server">
    <div id="divPreamble" runat="server" style="padding-bottom:15px"></div>
</asp:Panel>

<asp:Panel ID="pnlQuestion" runat="server">
    <div id="divQuestion1" runat="server"></div>

    <div id="divRBL" runat="server"  style="padding-left: 20px"> 
      <asp:Table ID="tblAnswers" runat="server" CellPadding="0" CellSpacing="0">
      </asp:Table>
    </div>

    <div id="divQuestion2" runat="server" style="padding-left: 20px; padding-top: 10px"></div>
    <div id="divAnswer2" runat="server" style="padding-left:20px; padding-top: 5px; text-align: left" align="left">
        <div>
            <cc1:TextBoxLengthValidator 
                ID="tblvAnswer" 
                    ControlToValidate="txtAnswer" 
                    runat="server" 
                    ErrorMessage="Maximum length is 255 Characters" 
                    MaximumLength="255" 
                    Display="Dynamic"
                    ForeColor="Red">
            </cc1:TextBoxLengthValidator>    
        </div>

        <div><asp:TextBox ClientIDMode = "Predictable" ID = "txtAnswer" runat="server" Width="600px" Rows="3" TextMode="MultiLine"></asp:TextBox></div>

    </div>

</asp:Panel> 
```

这是调用 JS 函数的 VB 代码隐藏（为简洁而编辑）中的函数......

```
Public Sub LoadQuestions(ByVal objQRBL As Question, ByVal objQText As Question, ByVal dicAnswers As Dictionary(Of Integer, QuestionAnswer), ByVal LoadAnswers As Boolean)
        'This is a function from RBHorizWithText user control that has two member controls: a radio button and a text box (first 2 params).
        'dicAnswers are the user's answers stored either in HttpContext.Current, or as global memory objects...

        _lstRadioButtons = New List(Of RadioButton)
        Me.tblAnswers.Rows.Clear()
        'txtAnswer is a member control of type textBox...
        Me.txtAnswer.Text = String.Empty

        '.
        'Stuff to build out <tr> and <td> question display elements to format/store control...
        '.

        Dim trw As New TableRow
        Dim iCount As Integer = 0

        For Each objA As QuestionAnswer In objQRBL.AnswerList           

            Dim objRB As New RadioButton

            objRB.ID = objA.QuestID & ";" & objA.AnswerID
            objRB.GroupName = "rb" & objA.QuestID
            objRB.Text = objA.AnswerText

            'This is the main area where I'm having trouble:  
            '   At runtime, Me.txtAnswer.ClientID should evaluate to: "ctl00_ContentPlaceHolder1_ctl05_txtAnswer"
            '   Instead I'm getting:    "txtAnswer"

            If objQText.ParentReqResponseCode.IndexOf(";" & objA.ResponseCode & ";") <> -1 Then
                objRB.Attributes.Add("onclick", "txtBoxEnable('" & Me.txtAnswer.ClientID & "');")
            Else
                objRB.Attributes.Add("onclick", "txtBoxDisable('" & Me.txtAnswer.ClientID & "','" & objQText.InnerText & "');")
            End If

            tcl.Controls.Add(objRB)
            trw.Cells.Add(tcl)

            _lstRadioButtons.Add(objRB)

            iCount += 1
        Next

        'Other stuff to handle formatting and behavior of other controls...

    End Sub 
```

以下是 JS 函数，它们存在于项目的母版页上：

```
function txtBoxEnable(elID) {                     
    var el = document.getElementById(elID);
    el.style.backgroundColor = '#f4df8d';
    el.value = '';
    el.disabled = '';           
}

function txtBoxDisable(elID, innerText) {
    var el = document.getElementById(elID);
    el.value = innerText;
    el.style.backgroundColor = '#ffffff';
    el.disabled = 'disabled';
} 
```

非常感谢！-刘易斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:25:24.347

> 我尝试过使用不同的 ClientIDMode 设置（根据 [http://msdn.microsoft.com/en-us/library/system.web.ui.clientidmode.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.clientidmode.aspx)），但到目前为止还没有骰子......我正在使用.NET 4.0，所以我知道我可以通过“静态”clientIDmode 直接编辑 ClientID，但我还没有尝试过......

试试吧，它会彻底解决你的问题。您在标记上分配的任何 ID 都将是您在服务器端检索到的 ID。ID 前面没有额外的垃圾。

# actionscript-3 - ComboBox(evt.target) - 这是什么意思？

> ID：11908007
> 
> 赞同：0
> 
> 时间：2012-08-10T19:25:31.097
> 
> 标签：actionscript-3, flash, actionscript

阅读**ComboBox**组件 →[链接](http://help.adobe.com/en_US/ActionScript/3.0_UsingComponentsAS3/WS5b3ccc516d4fbf351e63e3d118a9c65b32-7fa9.html#WS21F56975-ABB2-4c0d-892D-5D7480375617)

最后一个代码示例有这一行`request.url = ComboBox(evt.target).selectedItem.data;`

是什么`ComboBox(evt.target)`意思？类型铸造？为什么要键入 cast？

出于好奇，我也`changeHandler()`用它替换了最后一行：`ComboBox(evt.target).selectedIndex = -1;`. 有用。由于我没有引用`aCb`实例，它是否使处理程序功能更加灵活？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T19:32:46.603

您将事件的触发器转换为`ComboBox`. 你这样做是为了明确地说这个变量是这种类型的。大多数时候您不必这样做，但是当您这样做时，您会获得这些优势

1.  当您检查类型是什么时
2.  您可以在 IDE 中将 Class 类型（在本例中为 Combo Box）中的所有方法作为自动完成选项
3.  `evt.target`如果毕竟不是 ComboBox 类型，将抛出错误
4.  也是它是什么变量的视觉指示器。重新访问代码时非常有用

# java - 为角色添加健康条

> ID：11908011
> 
> 赞同：0
> 
> 时间：2012-08-10T19:25:53.633
> 
> 标签：java, image

我需要一个健康条来根据角色的剩余 HP 递减。但是我不知道该怎么做，因为我的游戏加载图像的方式

```
ImageIcon ii = new ImageIcon("Textures/Health/Health100.png");
healthBar = ii.getImage(); 
```

我需要将其更改为将“Health100.png”中的 100 替换为当前健康的字符。但我认为我不能用变量替换 100，所以我不知道该怎么做。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T19:32:29.000

您可以创建一个正确尺寸（宽度/高度）的 BufferedImage 实例并直接绘制到它的 Graphics 对象使用 Java2D API。您可以在角色的健康变化时刷新图像，而无需依赖物理图像文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T19:29:19.150

你不能简单地将健康连接到字符串中吗？例如

```
int health = 100; // change this variable as appropriate
ImageIcon ii = new ImageIcon("Textures/Health/Health" + health + ".png"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-10T19:33:46.560

您可以预加载图像，这将比随着健康状况波动而重新加载图像更好。

当你加载你的游戏

```
 for (int i = 0; i < 100; ++i)
   healthImg[i] = new ImageIcon("Textures/Health/Health" + health + ".png"); 
```

然后在你的游戏循环中

```
 healthBar = healthImg[health]; 
```

但正如另一个 Jeff 建议的那样，你最好不要使用图像（除非你的健康栏非常漂亮）

# wcf - 带有 WCF4 自托管服务的 Autofac（无 .svc）

> ID：11908016
> 
> 赞同：3
> 
> 时间：2012-08-10T19:26:13.833
> 
> 标签：wcf, dependency-injection, autofac

对于没有 .svc 的自托管服务，是否需要指定服务实现类型和宿主工厂？当我尝试运行下面的控制台应用程序时，我收到一个错误，即没有默认构造函数，所以似乎我的容器注册没有被使用。我错过了什么？

```
var builder = new ContainerBuilder();
builder.Register(c => new GenericRepository()).As<IRepository>();
builder.Register(c => new BusinesLogic(c.Resolve<IRepository>())).As<IBusinesLogic>();
builder.Register(c => new MyService(c.Resolve<IBusinesLogic>())).As<IMyService>();

using (IContainer container = builder.Build())
{
    var address = new Uri("net.tcp://localhost:8523/MyService");
    var host = new ServiceHost(typeof(MyService), address);

    host.AddServiceEndpoint(typeof(IMyService), new NetTcpBinding(), string.Empty);
    host.AddDependencyInjectionBehavior<IMyService>(container);
    host.Description.Behaviors.Add(new ServiceMetadataBehavior { HttpGetEnabled = false });
    host.Open();

    Console.WriteLine("Navigate to the following URI to see the service.");
    Console.WriteLine(address);
    Console.WriteLine("Press enter to exit...");
    Console.ReadLine();

    host.Close();
    Environment.Exit(0);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:03:22.383

我想我已经弄清楚了我在 Alex Meyer-Gleaves 的博客文章中遗漏了什么。我需要调用 ComponentRegistry.TryGetRegistration

[https://alexmg.com/posts/self-hosting-wcf-services-with-the-autofac-wcf-integration](https://alexmg.com/posts/self-hosting-wcf-services-with-the-autofac-wcf-integration)

这是我更新的代码：

```
var builder = new ContainerBuilder();
builder.Register(c => new GenericRepository()).As<IRepository>();
builder.Register(c => new BusinessLogic(c.Resolve<IRepository>())).As<IBusinessLogic>();
builder.Register(c => new MyService(c.Resolve<IBusinessLogic>())).As<IMyService>();

using (IContainer container = builder.Build())
{
    var address = new Uri("net.tcp://localhost:8523/MyService");
    var host = new ServiceHost(typeof(MyService), address);

    host.AddServiceEndpoint(typeof(IMyService), new NetTcpBinding(), string.Empty);

    IComponentRegistration registration;
    if (!container.ComponentRegistry.TryGetRegistration(new TypedService(typeof(IMyService)), out registration))
    {
        Console.WriteLine("The service contract has not been registered in the container.");
        Console.ReadLine();
        Environment.Exit(-1);
    }

    host.Description.Behaviors.Add(new AutofacDependencyInjectionServiceBehavior(container, typeof(MyService), registration));
    host.Description.Behaviors.Add(new ServiceMetadataBehavior { HttpGetEnabled = false });
    host.Open();
    Console.WriteLine("Navigate to the following URI to see the service.");
    Console.WriteLine(address);
    Console.WriteLine("Press enter to exit...");
    Console.ReadLine();

    host.Close();
    Environment.Exit(0);
} 
```

# python - 函数如何稳定地引用自身？

> ID：11908017
> 
> 赞同：12
> 
> 时间：2012-08-10T19:26:19.053
> 
> 标签：python, introspection

[原始版本中的代码严重混乱。即使在我修复了代码之后，帖子中仍然存在几个非常令人困惑的错别字。我相信我最终也修复了所有这些问题。深表歉意。]

下面的两个调用会`alias`产生不同的输出，因为与变量关联的对象`my_own_id`在两个调用之间会发生变化：

```
>>> def my_own_id():
...     me = my_own_id
...     return id(me)
... 
>>> alias = my_own_id
>>> alias()
4301701560
>>> my_own_id = None
>>> alias()
4296513024 
```

我可以`me`在定义中分配什么，`my_own_id`以便其输出在变量的后续重新定义中保持不变`my_own_id`？（IOW，所以内部`me`变量总是引用同一个函数对象？）

（我可以得到当前帧（用`inspect.currentframe()`），但它只包含对当前代码对象的引用，而不是对当前函数的引用。）

PS这个问题的动机只是为了更好地了解Python。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:37:50.490

似乎引用`my_own_id`将`'my_own_id'`在全局命名空间字典中查找，因此它始终是函数定义中使用的名称。由于该名称可以分配给不同的值，因此检索到的值也可以更改。如果您创建`me`一个默认参数，您可以在函数定义时将其分配给函数本身，以保持对实际函数的引用。

您可以使用这个装饰器，它隐式地将原始函数本身作为第一个参数传递。

```
>>> from functools import wraps
>>> def save_id(func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            return func(func, *args, **kwargs)
        return wrapper

>>> @save_id
def my_own_id(me): # me is passed implicitly by save_id
    return id(me)

>>> alias = my_own_id
>>> alias()
40775152
>>> my_own_id = 'foo'
>>> alias()
40775152 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T19:58:21.013

实际上，如果您只依赖函数名，如果该名称在全局变量空间中被覆盖（在定义函数的模块中），则使用函数名的引用将失败

更简单、更易于维护的方法是为此编写一个装饰器，它将提供一个`nonlocal`包含对函数本身的引用的变量。

```
from functools import wraps

def know_thyself(func):
   @wraps(func):
   def new_func(*args, **kwargs):
        my_own_id = func
        return func(*args, **kwargs)
   return new_func 
```

并可用作：

```
>>> @know_thyself
... def my_own_id():
...     me = my_own_id
...     return id(me)
... 
```

还有另一种可能的方法，远非如此干净，使用帧内省并重新使用相同的目标代码重新构建一个新函数。我在这篇关于 Python 中的自引用 lambda 表达式的帖子中使用了这个：http: [//metapython.blogspot.com.br/2010/11/recursive-lambda-functions.html](http://metapython.blogspot.com.br/2010/11/recursive-lambda-functions.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T09:55:28.130

```
import inspect
def _this_fn():
    try:
        frame = inspect.currentframe().f_back
        code = frame.f_code
        return frame.f_globals[code.co_name]
    finally:
        del code
        del frame

def myfunc(*parms):
    print _this_fn()

>>> myfunc(1)
<function myfunc at 0x036265F0>
>>> myfunc
<function myfunc at 0x036265F0> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T20:11:20.160

好吧，如果您不介意调用一个函数（将所需的函数放入全局范围），您可以包装该函数以保护其定义：

```
>>> def be_known():
...     global my_own_id
...     def _my_own_id():
...         return id(_my_own_id)
...     my_own_id = _my_own_id
... 
>>> be_known()
>>> my_own_id()
140685505972568
>>> alias, my_own_id = my_own_id, None
>>> alias()
140685505972568 
```

请注意，受保护的函数必须使用非本地名称而不是全局名称来调用自身。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-10T20:15:58.227

装饰器方法可能是最好的方法。这里还有一些好玩的：

1.  劫持函数参数之一以提供静态变量。

    ```
    def fn(fnid=None):
        print "My id:", fnid
    fn.func_defaults = (id(fn),) 
    ```

2.  这里有几种获取当前函数的方法：[Python code to get current function into a variable?](https://stackoverflow.com/questions/4492559/python-code-to-get-current-function-into-a-variable) ; 其中大部分涉及在各种地方搜索 currentframe.f_code。这些工作无需对原始功能进行任何修改。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-10T20:59:35.853

[Luke](https://stackoverflow.com/a/11908652/5987)有一个想法，但似乎没有开发它：使用可变的默认参数来保存函数对象中的值。默认参数值仅在定义函数时评估一次，之后保留其先前的值。

```
>>> def my_own_id(me=[None]):
    if not me[0]:
        me[0] = my_own_id
    return id(me[0])

>>> alias = my_own_id
>>> alias()
40330928
>>> my_own_id = None
>>> alias()
40330928 
```

这需要您小心，不要使用参数调用函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-10T20:00:31.917

这是由于范围

```
>>> def foo():
...     x = foo
...     print x
... 
>>> foo()
<function foo at 0x10836e938>
>>> alias = foo
>>> alias()
<function foo at 0x10836e938>
>>> foo = None
>>> alias()
None
>>> foo = []
>>> alias()
[]
>>> del foo
>>> alias()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 2, in foo
NameError: global name 'foo' is not defined
>>> 
```

# jquery - 是否可以将选择选项更改绑定到功能？

> ID：11908018
> 
> 赞同：0
> 
> 时间：2012-08-10T19:26:21.560
> 
> 标签：jquery

我正在尝试检测选择选项中的任何更改并将其绑定到函数。到目前为止，我正在使用 DOMSubtreeModified 事件来检测此更改，但如果从选择中删除选项，它不会显示正确的计数。

```
$('#employee').bind("DOMSubtreeModified", function() {
  alert($('#employee option').size());
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:54:37.030

我没有找到任何解决方案，所以我继续使用 Javascript 计时器。这是一个 hack，但对我们有用。

# matlab - 颜色图的范围

> ID：11908028
> 
> 赞同：0
> 
> 时间：2012-08-10T19:27:25.287
> 
> 标签：matlab, plot, matlab-figure, color-mapping

`colormap`范围如何`matlab`？下面的示例似乎表明它不是词法范围的，因为在代码块中设置的值可以在该块之外访问。

```
% example 1
for i=1:3
    colormap('gray');
    subplot(2,2,i);
    imagesc(eye(5));
end
subplot(2,2,4);
imagesc(eye(5)); 
```

此外，它的定义似乎取决于是否调用了其他函数（例如`figure`）。在以下两个示例中，`colormap`似乎是根据是否调用其他函数来动态限定范围的。

```
% example 2
colormap(gray);
for i=1:4
    subplot(2,2,i);
    imagesc(eye(5));
end

% example 3
colormap(gray);
figure;
for i=1:4
    subplot(2,2,i);
    imagesc(eye(5));
end 
```

在“示例 2”中，灰色映射应用于每个`image`. 在“示例 3”中，每个 都使用默认值`colormap`( `jet`) `image`，这表明调用该函数会`figure`取代以前的`colormap`定义，将它们重置为默认值。还有哪些其他函数调用具有此属性？

最后，调用的效果是`colormap('default')`什么？鉴于我之前的假设，即调用将`figure`重置`colormap`为默认值，以下代码不会像我预期的那样生成带有`gray` `colormap`. 相反，所有数字都使用`jet` `colormap`. 在什么意义上已经`gray` `colormap`被默认了？

```
% example 4
colormap(gray);
colormap('default');
figure;
for i=1:4
    subplot(2,2,i);
    imagesc(eye(5));
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:18:10.857

同一图中的所有相关图形对象共享一个颜色图。`'colormap'`每个图形都在属性中维护一个颜色图。例如：`get(gcf,'colormap')`。

`colormap('NAME')`适用于当前数字。这具有的效果`set(gcf,'ColorMap',cm)`。

`colormap(axisHandle,..)`或`colormap(figurehandle, ...)`明确标识正在设置其颜色图的图形。请注意，`colormap(axisHandle,..)`语法仍然设置图形的颜色图，它只是使用 axisHandle 的 parent 属性来确定正在设置的图形。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T11:31:27.097

正如[@Pursuit](https://stackoverflow.com/a/11908680/97160)解释的那样，一个图形只有一个颜色图，它被包含在其中的所有轴/图像应用。尽管如此，还是有办法克服这个问题：

> [如何在单个图中使用多个颜色图？](http://www.mathworks.com/support/solutions/en/data/1-GNRWEH/index.html)

File Exchange 上还有一个方便的[提交：](http://blogs.mathworks.com/pick/2009/07/24/using-multiple-colormaps-in-a-single-figure/)

> [freezeColors / unfreezeColors](http://www.mathworks.com/matlabcentral/fileexchange/7943)

# android - Android：我可以在此活动之外的代码中获取活动布局的 ID

> ID：11908029
> 
> 赞同：0
> 
> 时间：2012-08-10T19:27:26.877
> 
> 标签：android, layout, android-activity

我有一个普通的类（不是一个活动），它引用了一个活动。是否有可能以及如何获取该活动用作内容视图的布局文件的 ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T19:40:29.143

正如 wsanville 指出的那样，您可以将用于布局的 int 传递给您拥有的非活动类的构造函数。我假设您正在活动的 onCreate 方法中构建所述类。所以：

```
public void onCreate(bundle icicle){
  ...other stuff...
  setContentView(R.id.layout_id);
  OtherClass myClass = new OtherClass(R.id.layout_id);

  ...other stuff...

} 
```

[不幸的是，我在Activity](http://developer.android.com/reference/android/app/Activity.html)文档中找不到“get”版本的`setContentView`方法。

# java - ArrayList 初始容量和 IndexOutOfBoundsException

> ID：11908037
> 
> 赞同：26
> 
> 时间：2012-08-10T19:28:04.020
> 
> 标签：java, string, arraylist

考虑这个示例代码：

```
List<String> myList = new ArrayList<String>(7);
myList.add(5, "Hello");
myList.removeAll(Collections.singleton(null));

System.out.println(myList.size() + " objects:" );
for (String s : myList) {
    System.out.println("\t" + s);
} 
```

`myList`使用初始容量 7 进行初始化，然后下一行尝试在位置 5 处添加字符串“Hello”。这将引发 IndexOutOfBoundsException：

> 线程“主”java.lang.IndexOutOfBoundsException 中的异常：索引：5，大小：0

我查看了[这个](https://stackoverflow.com/questions/4172480/whats-meant-by-parameter-int-initial-capacity-in-an-arraylist)关于“初始容量”在 ArrayList 方面的含义的问题。我知道这个特定的构造函数正在为 7 个 String 元素分配空间，如果我们尝试将 8 个元素添加到列表中，它将不得不分配更多空间。

我*不*明白的是为什么它没有创建一个大小为 7 的“空”列表，每个索引都有空值，类似于我们声明`String[] myArray = new String[7]`. 我记得了解到 ArrayList 是 Java 对动态数组的实现，所以我期待类似的行为。如果我在声明时实际上没有分配 7 个字符串的空间`new ArrayList<String>(7)`，那么实际发生了什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-10T19:31:36.997

> 我不明白的是为什么它没有创建一个大小为 7 的“空”列表，每个索引都有空值，类似于我们声明 String[] myArray = new String[7] 时会发生的情况。

这在某些情况下会很有用......而在其他情况下则没有用。很多时候，你有一个你要创建的列表大小的*上限*（或者至少是一个猜测），但是你填充它......并且你*不*希望有一个大小错误的列表。 ..所以你必须在“设置”值时维护一个索引，然后再设置大小。

> 我记得了解到 ArrayList 是 Java 对动态数组的实现，所以我期待类似的行为。

不，真的不是。这是一个可以调整大小并在幕后*使用数组的列表。*尽量不要将其视为一个数组。

> 如果我在声明 new 时实际上没有分配 7 个字符串的空间`ArrayList<String>(7)`，那么实际发生了什么？

您*确实*有 7 个字符串引用的空间。*缓冲区*大小（即容量）至少为 7，但列表的逻辑*大小*仍为 0 - 您还没有向其中添加任何内容。这就像你有一张足够长 7 行的纸，但你还没有写任何东西。

如果你*想要*一个预填充列表，你可以很容易地编写一个方法来创建一个：

```
public static List<T> createPrefilledList(int size, T item) {
    ArrayList<T> list = new ArrayList<T>(size);
    for (int i = 0; i < size; i++) {
        list.add(item);
    }
    return list;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-10T19:34:51.877

**数组的初始容量**与其**大小**（即数组包含的元素数量）之间存在差异。它的大小用于确定您是否尝试访问超出范围的索引。

这是[`ArrayList.java`](http://www.docjar.com/html/api/java/util/ArrayList.java.html)执行此检查的方法：

```
 private void rangeCheckForAdd(int index) {
   if (index < 0 || index > this.size)
     throw new IndexOutOfBoundsException(outOfBoundsMsg(index));
 } 
```

如您所见，它与阵列的初始容量无关。它仅基于它包含的元素数量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T19:32:21.260

初始容量只做一件事：它给出了后备阵列应该有多大的建议（不是要求）。从逻辑上讲，在有或没有建议的情况下允许哪些操作或建议是什么之间没有区别。唯一的变化将是作为优化建议可能发生或不发生的内部操作。

您只能像这样“添加”到数组中已经存在的位置。位置 5 之前的元素尚不存在，因此会引发异常。从[Javadoc](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html#add%28int,%20E%29)：

> 抛出：IndexOutOfBoundsException - 如果索引超出范围 (index < 0 || index > size())

# objective-c - 如何循环并在数组中添加重复项

> ID：11908038
> 
> 赞同：1
> 
> 时间：2012-08-10T19:28:07.967
> 
> 标签：objective-c, ios, loops

我有一个带有 Orders 数组的字典，其中包含金额和订单 `Orders = ("3 White Shirts", "8 White Shirts", "4 blue shorts")`

我将如何遍历它并添加重复订单的数量，以便结果字符串或数组是 `Orders = ("11 White Shirts", "4 blue shorts") or myString ="11 White Shirts, 4 blue shorts"`

我正在考虑某种子字符串来检查产品是否相同，但不确定如何从重复订单中获取要添加的正确数量

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:31:49.550

好的，这是一种方法（我能想到的最短的方法）：

```
// Assuming that 'orders' is the array in your example
NSMutableDictionary *orderDict = [[NSMutableDictionary alloc] init]; 

for (NSString *order in orders)
{
    // Separate the string into components
    NSMutableArray *components = [[order componentsSeparatedByString:@" "] mutableCopy];

    // Quantity is always the first component
    uint quantity = [[components objectAtIndex:0] intValue];
    [components removeObjectAtIndex:0];

    // The rest of them (rejoined by a space is the actual product)
    NSString *item = [components componentsJoinedByString:@" "];

    // If I haven't got the order then add it to the dict
    // else get the old value, add the new one and put it back to dict
    if (![orderDict valueForKey:item])
        [orderDict setValue:[NSNumber numberWithInt:quantity] forKey:item];
    else{
        uint oldQuantity = [[orderDict valueForKey:item] intValue];
        [orderDict setValue:[NSNumber numberWithInt:(oldQuantity+quantity)] forKey:item];
    }
} 
```

这会给你一个这样的字典：

```
{
    "White Shirts" = 11;
    "blue shorts" = 4;
} 
```

因此，您可以遍历键并生成一个字符串数组，如下所示：

```
NSMutableArray *results = [[NSMutableArray alloc] initWithCapacity:0];
for (NSString *key in [orderDict allKeys])
{
    [results addObject:[NSString stringWithFormat:@"%@ %@", [orderDict valueForKey:key], key]];
} 
```

最后会给你：

```
(
    "11 White Shirts",
    "4 blue shorts"
) 
```

PS。如果您不使用 ARC，请不要忘记释放！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T19:42:33.240

您需要解析字符串以提取两条信息：订单数量，它是一个数值，以及项目标识，它可能仍然是一个字符串。

使用 NSMutableDictionary 将项目标识映射到表示当前订单数量的数值，否则检索旧总数并将当前订单添加到其中，然后更新字典。

最后迭代字典并将每个键值对转换回字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:09:12.627

因为它看起来像你的数组包含字符串对象，我会做这样的事情：

```
#import <Foundation/Foundation.h>

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        NSArray *ordersAsStrings = [NSArray arrayWithObjects:@"7 white shirts", @"4 blue jeans", @"3 white shirts", @"4 blue jeans", nil];
        NSMutableDictionary *combinedQuantities = [NSMutableDictionary new];
        NSMutableArray *combinedOrdersAsStrings = [NSMutableArray new];

        // take each string and break it up into the quantity and the item
        for (NSString *orderAsString in ordersAsStrings) {
            NSInteger scannedQuantity = 0;
            NSString *scannedItem = nil;
            NSScanner *scanner = [NSScanner scannerWithString:orderAsString];
            [scanner scanInteger:&scannedQuantity];
            [scanner scanCharactersFromSet:[[NSCharacterSet illegalCharacterSet] invertedSet] intoString:&scannedItem];

            // if the item is already in combinedOrders
            if ([combinedQuantities.allKeys containsObject:scannedItem] == YES) {
                // update quantity
                NSNumber *existingQuantity = [combinedQuantities objectForKey:scannedItem];
                NSInteger combinedQuantity = existingQuantity.integerValue + existingQuantity.integerValue;
                [combinedQuantities setObject:[NSNumber numberWithInteger:combinedQuantity] forKey:scannedItem];
            } else {
                // otherwise add item
                NSNumber *quantity = [NSNumber numberWithInteger:scannedQuantity];
                [combinedQuantities setObject:quantity forKey:scannedItem];
            }
        }

        // change combined quantities back into strings
        for (NSString *key in combinedQuantities.allKeys) {
            NSNumber *quantity = [combinedQuantities objectForKey:key];
            NSString *orderAsString = [NSString stringWithFormat:@"%ld %@", quantity.integerValue, key];
            [combinedOrdersAsStrings addObject:orderAsString];
        }

        NSLog(@"Combined Orders: %@", combinedOrdersAsStrings);
    }
    return 0;
} 
```

# android - Android：静态字段和内存泄漏

> ID：11908039
> 
> 赞同：26
> 
> 时间：2012-08-10T19:28:14.293
> 
> 标签：android, memory, memory-leaks, android-activity, android-context

我一直在研究在创建视图时防止上下文/活动内存泄漏的最佳实践，但对于类中的静态字段，我似乎无法找到明确的答案。

假设我有一个这种形式的代码：

```
public class MyOuterClass extends Activity{
   private MyInnerClass;
   MyInnerClass = (MyInnerClass) findViewById(<XML call here>);
   MyInnerClass.myXInt = 3;

   // onCreate(), onResume(), etc.

   public static class MyInnerClass extends SurfaceView implements Runnable{
      // Safe variables?
      private static int myXInt, myYInt;
      private static boolean myBoolean;
      // Potentially safe?
      private static Canvas myCanvas;
      // Definitely bad.
      private static Context myContext;

      public MyInnerClass(Context context){
         myContext = context;        // This is bad.
      }
   }
} 
```

我对 JVM 实际上认为 MyInnerClass 的 ClassLoader 是什么感到有些困惑。从技术上讲，因为它是一个 SurfaceView 对象，所以一旦应用程序实例化 MyInnerClass 一次（这发生在 View 第一次膨胀时），静态变量似乎应该始终存在，然后保持在那里直到应用程序本身终止。如果是这样，是什么阻止位图和画布对象保持打开状态并填满堆？

我看到的唯一声明是你不能像我在构造函数中显示的那样泄漏静态上下文，但它永远不会超出这个范围。这真的是你唯一不能做的事情吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-08-10T20:18:24.350

在 Java/Android 中，`static`变量或常量不会被垃圾回收。一旦持有它的类通过类加载器加载，它就会停留在那里。对于您的应用程序中的所有类，类加载器始终是相同的，并且它具有对您的所有类的静态引用（例如`MyInnerClass.class`）。由于类加载器不会消失，因此您的类也不会这样做，因为它们被引用，因此不可回收。

就像你的例子一样

```
public class SomeClass extends SurfaceView {
  private static Context myContext;

  public MyInnerClass(Context context){
     myContext = context;        // This is bad.
  }
} 
```

那确实很糟糕。即使不存在对`SomeClass`存在的引用（例如`Activity`，显示您的自定义已结束），对（以及任何其他变量/常量`SurfaceView`的静态引用将保留。您可以认为它们都已泄漏，因为不可能对它们进行垃圾收集等。如果你有一个常规变量引用某个东西，那么一旦包含该变量的实例不再引用它，整个实例包括它对其他东西的引用都可以并且将会被垃圾收集。Java甚至可以很好地处理循环引用。`Context``static``SomeClass``Context`

对于常量，您希望发生这种情况，这通常还不错，因为常量的数量和它们占用的内存量并不大。常量也不（不应该）引用其他占用大量内存的实例，例如`Context`or `Bitmap`。

除了通过静态变量创建内存泄漏的可能性之外，如果您不想同时为所有实例提供一个单一的东西，您也可能会产生问题。例如，如果您将您的 保存`Bitmap`在`SurfaceView`一个`static`变量中，您就不能有两个不同的图像。即使两个`SurfaceView`s 没有同时显示，您也可能会遇到问题，因为每个新实例都可能会覆盖旧图像，如果您返回另一个实例，您会`SurfaceView`意外显示错误的图像。我几乎可以肯定你不想在`static`这里使用。

您的内部类是 a 的`static class`事实并不意味着您必须使用静态变量 - 它只是意味着它的行为更像是一个`static`方法，因为它不能在您的类中使用实例变量（那些不是`static`）。

为了避免内存泄漏，您根本不应该使用静态变量。除非您做特殊的事情（例如计算类的实例），否则无需使用它们。常数很好。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-02-19T18:50:30.427

本文讨论可变静态字段：http: [//javabook.compuware.com/content/memory/problem-patterns/memory-leaks.aspx](http://javabook.compuware.com/content/memory/problem-patterns/memory-leaks.aspx)。基本上，避免使用它们并改用常量。

# c# - UB：C# 的 Regex.Match 在匹配时返回整个字符串而不是部分

> ID：11908044
> 
> 赞同：4
> 
> 时间：2012-08-10T19:28:37.963
> 
> 标签：c#, regex, right-to-left

注意力！这与正则表达式问题无关[，匹配整个字符串而不是](https://stackoverflow.com/questions/3975297/regex-problem-matches-the-whole-string-instead-of-a-part)**部分**

* * *

大家好。我试着做

```
Match y = Regex.Match(someHebrewContainingLine, @"^.{0,9} - \[(.*)?\s\d{1,3}"); 
```

除了其他 VS 希伯来语怪癖（在编辑字符串时，您如何将 ] 替换为 [ ？），它偶尔会返回疯狂的结果：

```
Match.Captures.Count = 1;
Match.Captures[0] = whole string! (not expected)
Match.Groups.Count = 2; (not expected)
Match.Groups[0] = whole string again! (not expected)
Match.Groups[1] = (.*)? value (expected). 
```

`Regex.Matches()`以同样的方式行事。

这种行为的一般原因是什么？`Regex.Match("-היי45--", "-(.{1,5})-")` *注意：在简单的测试字符串（例如（示例显示不正确！，请查看页面的源代码））*上，它不会以这种方式起作用，正则表达式一定有一些东西使它变得贪婪。匹配的字符串包含`[ .... ]`，但简单地将它们添加到测试字符串不会产生相同的效果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T19:46:22.393

当我第一次开始使用 .NET 正则表达式时，我也遇到了这个问题。理解这一点的方法是理解`Group`成员`Match`是嵌套成员。您必须遍历`Groups`才能降低捕获量。组也有`Capture`成员。有点像顶部的`Match`“组”，因为它代表整个字符串与您的表达式的成功“匹配”。单个输入字符串可以有多个匹配项。该`Captures`成员代表您的完整表达的匹配。

只要你有一个单一的捕获，`Group[1]`将永远是你感兴趣的数据。看看[这个页面](http://msdn.microsoft.com/en-us/library/hs600312.aspx)。示例 2 和 3 中的源代码经过硬编码以打印出来`Groups[1]`。

请记住，单个捕获可以在单个匹配操作中捕获多个子字符串。如果是这种情况，那么您会看到`Match.Groups[1].Captures.Count`大于 1。另外，我认为如果您将多个匹配的文本行传递给单个`Match`调用，那么您会看到`Match.Captures.Count`大于 1，但每个顶层`Match.Captures`都是完整的与您的完整表达式匹配的字符串。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T19:46:19.843

模式中有一个捕获组；即第 1 组。

总是有第 0 组，即整场比赛。

所以一共有2组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T21:20:36.677

我的测试正则表达式与项目范围内的任何其他正则表达式都不同（当 Perl 人来到 C# 时会发生这种情况），因为它没有前瞻/后瞻。所以这个发现需要一些时间。

现在，为什么我们应该将 Regex 行为称为**undocumented**，而不是**undefined**：

让我们对`"1.234567890"`.

*   类似 PCRE 的语法：`(.)\.2345678`
*   前瞻语法：`(.)(?=\.\d)`

当您进行正常匹配时，无论您将父大小放在哪里，结果都是从行的整个匹配部分复制的；如果存在前瞻，则复制不属于它们的任何内容。

因此，比赛将返回：

*   PCRE：（`1.2345678` 在 2300，这看起来像原始字符串，我开始在这里大喊大叫）
*   展望：`1`

# sql - 子记录的计数或布尔值

> ID：11908045
> 
> 赞同：0
> 
> 时间：2012-08-10T19:28:40.700
> 
> 标签：sql, sql-server, sql-server-2008

想要返回结果中每条记录的子记录计数吗？

```
lists
listid,name
----------------
1,foods
2,fruits
3,veggies
4,counties
5,blah /* other list types */

listitems
listid,listitemId,listname
----------------
1,1,fruits
2,1,veggies
3,3,carrots
4,3,broccoli 
```

这是我必须使用的查询：

```
declar @listid int
select @listid = 1 --as an example
select * from listitems where listid=@listid

results:
1,1,fruits
2,1,veggies 
```

**目标：我想在这个例子中显示水果和蔬菜的物品数量**

```
listitems
listitemid,listid,name,childcount
1,1,fruits,0
2,1,veggies,2 
```

这是我想出答案的方法：

```
select *,
(
    select (select case when COUNT(*)>0 then 1 else 0 end as reccount 
    from ListItems li3 where li3.listid = l.listid) 
    from Lists l where li2.name = l.listname
) as haschildrecords
 from ListItems li2 where listid=1 
```

我仍在决定是否要返回计数或位...

这是正确的还是最好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:48:45.893

这就是你所追求的吗？

```
select
  lists.listid,
  lists.name, 
  count(distinct listitemid) as itemcount, 
  convert(bit,sign(count(distinct listitemid) ) ) as itemexists    
from
  lists 
     left join
  listitems on lists.listid = listitems. listid
group by 
  lists.listid,lists.name 
```

我不知道，但如果你正在构建一个层次结构，那么你会想看看`common table expressions`, 和/或`HierarchyID`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T18:14:11.130

```
select *,
(
    select (select case when COUNT(*)>0 then 1 else 0 end as reccount 
    from ListItems li3 where li3.listid = l.listid) 
    from Lists l where li2.name = l.listname
) as haschildrecords
 from ListItems li2 where listid=1 
```

# vb.net - VB.NET FromEventPattern

> ID：11908049
> 
> 赞同：3
> 
> 时间：2012-08-10T19:28:45.153
> 
> 标签：vb.net, observablecollection, system.reactive, c#-to-vb.net

我是 Reactive Extension 的新手，不幸的是我们使用的是 VB.NET，所以我在将 C# 示例转换为 VB.NET 时遇到了一些麻烦。
我正在尝试创建一个简单的 ObservableCollection(of String) 并订阅它。每当将字符串添加到集合中时，我都想将其写出到控制台。
我正在尝试将此示例翻译为 VB.NET，但遇到了麻烦。

```
var x = Observable.FromEventPattern<NotifyCollectionChangedEventHandler, NotifyCollectionChangedEventArgs>(
    handler => (sender, e) => handler(sender, e),
    handler => theList.CollectionChanged += handler,
    handler => theList.CollectionChanged -= handler);
} 
```

我已经走了这么远，但无法让它发挥作用，我敢肯定这很简单，但我是新手。

```
Dim changes = Observable.FromEventPattern(Of System.Collections.Specialized.NotifyCollectionChangedEventHandler, NotifyCollectionChangedEventArgs) _
(Function(handler) Function(sender, args) handler(sender, args), _
Function(handler) AddHandler theList.CollectionChanged, AddressOf handler, _
Function(handler) RemoveHandler theList.CollectionChanged, AddressOf handler) 
```

感谢@Gideon Engelberth 帮助我删除了不需要的`AddressOf`
这编译得很好：

```
Dim changes = Observable.FromEventPattern(Of 
              System.Collections.Specialized.NotifyCollectionChangedEventHandler, _
              NotifyCollectionChangedEventArgs) _
              (Function(handler) Sub(sender, args) handler(sender, args), _
              Sub(handler) AddHandler theList.CollectionChanged, handler, _
              Sub(handler) RemoveHandler theList.CollectionChanged, handler) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T23:29:31.803

根据要求，我通常这样做：

```
Dim c As New ObservableCollection(Of String)
Dim obs = Observable.FromEventPattern(Of NotifyCollectionChangedEventHandler, 
                                         NotifyCollectionChangedEventArgs)(
                Sub(h) AddHandler c.CollectionChanged, h,
                Sub(h) RemoveHandler c.CollectionChanged, h) 
```

由于`h`已经是委托变量，因此您不需要 AddressOf 运算符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:09:43.840

`AddHandler`and`RemoveHandler`调用不返回值，因此您不能将它们与`Function`. 尝试使用`Sub`代替最后两个参数。

```
Dim changes = Observable.FromEventPattern(Of System.Collections.Specialized.NotifyCollectionChangedEventHandler, NotifyCollectionChangedEventArgs) _
(Function(handler) Function(sender, args) handler(sender, args), _
Sub(handler) AddHandler theList.CollectionChanged, AddressOf handler, _
Sub(handler) RemoveHandler theList.CollectionChanged, AddressOf handler) 
```

# javascript - Express.JS 无法识别所需 js 文件的功能

> ID：11908054
> 
> 赞同：1
> 
> 时间：2012-08-10T19:29:10.013
> 
> 标签：javascript, express

尽管我已经导入了包含我将使用的函数的 JS 文件，但 Node.JS 说它是未定义的。

```
require('./game_core.js');

Users/dasdasd/Developer/optionalassignment/games.js:28
    thegame.gamecore = new game_core( thegame );
                       ^
ReferenceError: game_core is not defined 
```

你知道有什么问题吗？Game_core 包含以下功能：

```
var game_core = function(game_instance){....}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T19:39:54.410

添加到 game_core.js 的末尾：

```
module.exports = {  
    game_core : game_core  
} 
```

到games.js：

```
var game_core = require('./game_core').game_core(game_istance); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T19:40:27.760

要求 Node 中的模块不会将其内容添加到全局范围。每个模块都包装在自己的范围内，因此您必须[导出公共名称](http://nodejs.org/api/modules.html#modules_module_exports)：

```
// game_core.js
module.exports = function (game_instance){...}; 
```

然后在主脚本中保留对导出对象的引用：

```
var game_core = require('./game_core.js');
...
thegame.gamecore = new game_core( thegame ); 
```

您可以在文档中阅读有关它的更多信息：[http ://nodejs.org/api/modules.html#modules_modules](http://nodejs.org/api/modules.html#modules_modules)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T19:43:55.730

另一种方法：

```
if( 'undefined' != typeof global ) {
    module.exports = global.game_core = game_core;
} 
```

# git - 将 GIT 子模块打包到 svn 中

> ID：11908058
> 
> 赞同：0
> 
> 时间：2012-08-10T19:29:17.670
> 
> 标签：git

这就是问题所在。我是一个大型团队的一员，从事一个（你猜对了）大型项目。我们正在使用各种支持 git 的项目，例如 jquery、backbone、underscore、timezoneJS、momentjs、backbone.grid 等。我们还获得了一些共享的“架构”资源，这些资源在另一个项目中是需要的。

该公司主要在 SVN 上运行，但我认为我们的项目在 GIT 上是有意义的——我们可以停止将这些外部资源保留在我们的仓库中，而是从“真相的来源”中获取它们。更重要的是，我们在项目之间使用的共享资源可以在一个上进行编辑以修复错误，然后该编辑可以相对轻松地在项目之间进行共享。

我认为有一种方法可以通过 SVN 做到这一点，但我离 SVN 专家还很远。

无论如何，问题如下：是否有可能，或者是否有工具，使用 git 子模块获取 git repo，将其全部打包并将其提交给 SVN，并附上适当的变更日志？我们还需要回读更改，因为一些文件会根据各种构建内容自动更新。我调查了 subgit，但这似乎不支持这一点。

关于项目设置的一些信息：

项目#1：

*   源代码
    *   架构——公司范围内的东西和whatsits
        *   lib --jquery、moment 等
    *   project#1files -- 项目特定文件
    *   索引.html
    *   引导数据文件

项目#2：

*   源代码
    *   架构——公司范围内的东西和whatsits
        *   lib --jquery、moment 等
    *   project#2files -- 项目特定文件
    *   索引.html
    *   引导数据文件

..你可以看到基本流程:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2022-02-18T01:10:59.877

如果您想迁移到 GIT，因为您提到它对您的团队更有意义，您应该能够使用[git svn](https://git-scm.com/docs/git-svn)获取提交并将它们推送到 GIT 存储库（可能每个项目一个？）。

一个不太理想和 hack-ish 的选项是将您的 GIT 克隆提交到您的 SVN 存储库。SVN 对二进制文件相当好，所以这样做不会太累...不过，几乎不推荐，因为您的 SVN 存储库中有一堆 GIT 元数据，并且在您想要更新时必须获取并提交您的外部依赖项（不必要地增加了存储库的大小而收效甚微）。

我自己几乎不是 SVN 或 GIT 专家，所以我不知道是否有（可能）更好的方法。如果您的公司仅仅因为公司的其他人使用 SVN 而反对让您的团队切换到 GIT，那么您最好尝试改变企业文化。

# asp.net-mvc - 无法加载文件或程序集“EntityFramework (1)”

> ID：11908059
> 
> 赞同：0
> 
> 时间：2012-08-10T19:29:17.743
> 
> 标签：asp.net-mvc, asp.net-mvc-3, visual-studio-2010, visual-web-developer-2010

错误如下：
`C:\Users\[username]\Google Drive\VS2010\Projects\[project name]\[project name]\Views\Show\EditOrder.cshtml: ASP.NET runtime error: Could not load file or assembly 'EntityFramework (1)' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference.`

大家好，
这里有一个奇怪的问题。*似乎*随机我的项目完全**无聊**。一点背景知识：这是一个 ASP.Net MVC3 (.Net Framework 4) 项目，我主要在 Visual Web Developer 2010 Express 中编写。我说主要是因为您会在上面的详细错误中注意到我已将其存储在我的 Google Drive 上。我正在将这个项目来回同步到我的新开发笔记本电脑，并安装了 Visual Studio 2010 Professional。这可能不是一个好主意，但我想要一种简单的方法来在我的台式机（办公室）、家里（在我的开发笔记本电脑上）和在路上（同样是开发笔记本电脑）上处理它。

关于可能发生的事情以及如何解决此问题的任何想法？

更多背景知识，现在我记起来了……我在将它发布到我们的本地 IIS 6 服务器时遇到了问题。我意识到我必须将它添加`_bin_deployableAssemblies`到包中才能工作。在某个时候，我从项目中删除了它们并重新添加了它们。大约在那个时候，或者至少在几个小时内，这个问题开始发生了*。*

我能不能吃饱？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:40:15.227

您的 MVC 3 项目引用了一个版本的 Entity Framework，但实际上在尝试解决对出现此错误的计算机上的 Entity Framework 的引用时找到了不同的版本。

最简单的解决方案可能是在您收到错误的当前计算机上更新到当前版本的 Entity Framework。

如果您在常规文本编辑器（例如记事本）中打开项目的 .csproj 文件，您应该会看到与此类似的一行：

```
<Reference Include="EntityFramework, Version=4.3.1.0, Culture=neutral, PublicKeyToken=b77a5c561934e089, processorArchitecture=MSIL">
  <SpecificVersion>False</SpecificVersion>
  <HintPath>..\packages\EntityFramework.4.3.1\lib\net40\EntityFramework.dll</HintPath>
</Reference> 
```

这将告诉您您的应用程序期望找到的版本。如果你看到

```
<SpecificVersion>False</SpecificVersion> 
```

然后可以使用预期版本或更高版本。

解决此类加载问题的另一种方法是使用[Fusion Log Viewer](http://msdn.microsoft.com/en-us/library/e74a18c4.aspx)，它将向您显示失败的绑定尝试以及加载程序尝试的内容（*确保*您以管理员身份运行它，否则它将默默地什么都不做）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:28:29.680

该死的奇怪..

查看我的 /[Project Name]/bin 文件夹，我发现了 4 个奇怪的文件：

```
EntityFramework (1).dll
EntityFramework (1).xml
[Project Name] (1).dll
[Project Name] (1).pdb 
```

无论如何，在删除他们并进行重建之后，一切都很好！

*（有人对这种情况的发生方式*或*原因*有任何想法吗？可能是 Google Drive 的问题，现在我正在考虑它......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-03T16:24:02.440

对我来说，这是一个 Google Drive 问题。如果您删除 Project/bin 文件夹中所有以 (1) 结尾的文件，它应该可以解决问题。

# c - 在 for 循环中使用 fork() 时，进程如何分支？

> ID：11908060
> 
> 赞同：-2
> 
> 时间：2012-08-10T19:29:17.540
> 
> 标签：c, unix, operating-system, fork

`fork()`循环外的调用很容易弄清楚，但是当它们在循环内时，我发现很难。任何人都可以用这样一个例子来形象地解释流程是如何分支的吗？

```
#include <stdio.h>

int main(){
    int i; 
    for(i=0;i<2;i++)
    {
        fork();
        printf("hi");
        fork();
    }
    exit(0);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:48:06.353

理想情况下，情况会是这样：

*   每个进程打印一个“hi”（简写为proc）
*   每个分叉使进程数量翻倍（每个进程产生一个子进程）

可以通过跟踪每个事件来完成计算：

*   开始：1个过程
*   分叉：2 x 1 = 2 个过程
*   打印：2 procs -> **2 hi**
*   分叉：2 x 2 = 4 个过程
*   分叉：2 x 4 = 8 触发
*   打印：8 procs -> **8 hi**
*   分叉：2 x 8 触发 -> 16 触发

现在我们把hi的数量加起来：

2 + 8 = **10 个 hi**

但是，情况不一定如此。在不同的系统上，您可能会得到不同的结果。

调用 fork() 会产生一个与父进程相同的子进程。如果在打印 stdout 时完成了任何*缓冲*，并且在下一次分叉之前没有刷新缓冲区，那么孩子将在“不应该”时出现打印。有关缓冲的一些详细信息，请参阅[此](https://stackoverflow.com/questions/1716296/why-does-printf-not-flush-after-the-call-unless-a-newline-is-in-the-format-strin "这个")问题。

这会导致在不同的系统中打印不同数量的 hi。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T19:33:01.630

只需展开循环：

```
int main() {
    int i;
    fork();
    printf("hi");
    fork();
    fork();
    printf("hi");
    fork();
    exit(0);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:58:35.400

我用过这段代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main(){
    int i; 
    for(i=0;i<2;i++)
    {
        fork();
        printf("hi from pid %d\n",getpid());
        fork();
    }
    exit(0);
} 
```

现在我已经将输出通过管道传输到 fk.out。

```
[aft@kruki sf]$ cat fk.out 
hi from pid 6698
hi from pid 6698
hi from pid 6699
....................... 
```

现在看看这个：

```
[aft@kruki sf]$ cat fk.out | awk '{print $4}' | sort | uniq | wc -l

8 
```

在那里，你有它，你有 8 个进程！不要指望你好。因为标准输入缓冲区会来回切换，所以计算 hi 将是模棱两可的。

# javascript - 对 JSON 的 Ajax 请求不起作用？

> ID：11908062
> 
> 赞同：0
> 
> 时间：2012-08-10T19:29:22.667
> 
> 标签：javascript, jquery, ajax, json, api

我正在尝试从提供 JSON 响应的 API 中获取一些数据。我对这一切都是全新的。有人可以看看我的代码并告诉我是否有语法原因它不起作用？我想点击按钮并弹出一个警报，其中包含从请求发回的数据。我认为这是您可以做的最基本的编程事情，但我似乎无法让它发挥作用。

```
<head>

<script type="text/javascript">
$.ajax({
    type: 'GET',
    url: 'http://openapi.etsy.com/v2/teams/8787?api_key=********&fields=name',
    async: false,
    jsonpCallback: 'jsonCallback',
    contentType: "application/json",
    dataType: 'jsonp',
    success: function(data)
    {
        alert(data)
    }
})
</script>

</head>
<body>
<button onClick="$.ajax()">Run Code</button>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:35:43.350

使用 jQuery 不显眼地添加事件处理程序以`button`使用`id`.

```
<head>

</head>
<body>
<button id="button">Run Code</button>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
$('#button').click(function(e){e.preventDefault();
$.ajax({
    type: 'GET',
    url: 'http://openapi.etsy.com/v2/teams/8787?api_key=********&fields=name',
    async: false,
    jsonpCallback: 'jsonCallback',
    contentType: "application/json",
    dataType: 'jsonp',
    success: function(data)
    {
        alert(data)
    }
})
});
</script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T19:35:59.697

我重写了你的代码：

```
<head>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.0.min.js"></script>
<script type="text/javascript">

function doStuff() {
    $.ajax({
        type: 'GET',
        url: 'http://openapi.etsy.com/v2/teams/8787?api_key=********&fields=name',
        async: false,
        jsonpCallback: 'jsonCallback',
        contentType: "application/json",
        dataType: 'jsonp',
        success: function(data)
        {
            alert(data)
        }
    });
}
</script>

</head>
<body>
<button onClick="doStuff()">Run Code</button>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T19:36:29.777

是的，有几个问题：

1.  您正在使用 jQuery，但您没有加载它。
2.  您尝试在页面加载时调用该调用。
3.  事件`onclick`处理程序尝试`$.ajax()`错误地调用 call（它没有任何参数）。

这大概就是全部了。

# html - 元刷新在 Firefox 中不起作用

> ID：11908063
> 
> 赞同：0
> 
> 时间：2012-08-10T19:29:25.833
> 
> 标签：html, meta-tags

我正在使用元刷新，`<meta HTTP-EQUIV="REFRESH" CONTENT="0; URL=javascript:window.open('home.asp?uuid=123','_top');">`它适用于除 Firefox 之外的所有其他浏览器。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-17T08:37:20.203

在 Firefox 中，自动刷新默认是禁用的。

在浏览器中启用自动刷新：

1.  在浏览器的位置栏中输入**about:config**
2.  出现一条消息：点击接受
3.  搜索*块自动刷新*
4.  将*access.blockautorefresh*从**false**更改为**true**

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-27T23:05:58.047

只需将所需的 (id) 放入 Action 元素中，如下所示：

我试过用PHP代码..

```
$q = $_GET['id'];
...
echo"<meta http-equiv='refresh' content='0;URL=home.php?q=".$q."' />";

<form role="form" action="home.php?q=<?php echo $q; ?>" method="POST"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-15T17:50:23.253

```
accessibility.blockautorefresh TRUE 
```

不会停止 HTML 或基于 Java 的刷新 - 网站管理员通过链式刷新（通常以 1 秒间隔）来拉皮条他们的页面点击是很常见的。我了解`accessibility.blockautorefresh`、庆祝、更改了值，并对它不适用于基于 HTML/Java 的刷新感到非常失望。

我绝对鄙视那些使用我的设备来伪造页面点击量的网络开发人员。每个其他主要浏览器都可以管理它。我专门使用 Firefox 是因为它提供的控制级别并且非常喜欢 Firefox，但我不得不回到 Internet Explorer，直到 Firefox 赶上来。

# html - 图片在下载后没有正确调整大小；他们停留在 10x10 像素

> ID：11908069
> 
> 赞同：0
> 
> 时间：2012-08-10T19:29:49.397
> 
> 标签：html, css

我的 CSS 有一个奇怪的场景，发生在所有浏览器中：

有时，当出现新图像时，它会使用我的 CSS 中指定的最小宽度/最小高度大小来显示。如果我只是调整浏览器的大小（拖动一个角），问题就会消失，图像会以完整、正确的分辨率正确显示。事实上，这种情况甚至不会每次都发生。当第一次看到图像时，它只会发生大约 5-10% 的时间。例如，如果我清除浏览器上的缓存然后重新加载，问题就会变得更加普遍。

这是 Chrome 元素面板的图片，显示正在应用最小宽度/高度 (10px) 而不是“自然”分辨率： ![在此处输入图像描述](../Images/4bab1760a5087bedf3a049708976b2ce.png)

这是它在屏幕上的实际样子：

![在此处输入图像描述](../Images/04721dccc50b53e97ed5d16b59afb743.png)

图像的边框正在通过我的 CSS 应用...

```
.streamifiedPostImageContainer {
    margin-top: 5px;
    overflow: hidden;
    width: 100%;
}
.streamifiedPostImage {
    float: left;
    margin-right: 8px;
    max-width: 100%;
}
.streamifiedPostImage img {
    border: 3px solid #FFF;
    max-width: 100%;
    max-height: 100%;
    min-width: 10px;
    min-height: 10px;
    box-shadow: 0px 1px 8px 1px rgba(0, 0, 0, .3);
} 
```

我已经使用元素面板来检查所有样式。元素面板显示 10x10 像素的“计算”大小，但所有“样式”都正确匹配我的 CSS（上图），没有说明为什么它会使用最小宽度/高度而不是（正确的）图像宽度/高度.

再一次，最奇怪的是，这只是通过拖动浏览器上的一个角或重新加载页面来修复自己。似乎在缓存的图像和应用的 CSS 之间存在某种竞争条件，因为它只发生大约 5-10% 的时间，但它确实发生在所有浏览器上。

# go - 在具有空接口的“通用”代码中强制执行类型

> ID：11908074
> 
> 赞同：2
> 
> 时间：2012-08-10T19:30:03.957
> 
> 标签：go

抱歉标题模棱两可。

我正在阅读这本书[http://algs4.cs.princeton.edu/home/](http://algs4.cs.princeton.edu/home/)，我认为在 Go 中实现示例作为学习练习会很好，但是这本书使用 Java 作为其语言来描述代码.

前几章中的一章讨论了设置一些核心数据类型/容器样式类以供以后重用，但我在尝试将它们融入 Go 设置时遇到了麻烦，主要是因为这些数据类型似乎很喜欢使用 Java 泛型。

例如，我编写了以下代码

```
package bag

type T interface{}
type Bag []T

func (a *Bag) Add(t T) {
    *a = append(*a, t)
}

func (a *Bag) IsEmpty() bool {
    return len(*a) == 0
}

func (a *Bag) Size() int {
    return len(*a)
} 
```

这在原则上有效，因为我可以将项目添加到 a`Bag`并检查它的大小和所有内容。然而这也意味着下面的代码是合法的

```
a := make(bag.Bag,0,0)
a.Add(1)
a.Add("Hello world!")
a.Add(5.6)
a.Add(time.Now()) 
```

我只是想知道是否有任何方法可以强制执行该类型，使其符合类似于

```
Bag<T> bagOfMyType = new Bag<T>() 
```

例如

```
Bag<Integer> bagOfInts = new Bag<Integer>() 
```

我知道 Go 没有泛型，它们也不是真正的 Go Way，但我只是想知道是否有可能在编译时“强制”任何东西（可能不是）

对不起，很长的帖子

**编辑：**好的，所以我一直在进一步研究这个问题，我几乎已经放弃了泛型方面的事情（我知道这不在 Go 的路线图上）所以我正在考虑做类似的事情具有接口的 Haskell 类型类，例如

```
type T interface{}
type Bag interface {
    Add(t T)
    IsEmpty() bool
    Size() int
}

type IntSlice []int

func (i *IntSlice) Add(t T) {
    *i = append(*i, t.(int)) // will throw runtime exception if user attempts to add anything other than int
}

func (i *IntSlice) IsEmpty() bool {
    return len(*i) == 0
}

func (i *IntSlice) Size() int {
    return len(*i)
} 
```

问题在于类型强制仅在运行时强制执行。

有人知道如何改进吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T20:52:48.577

我自己是 Go 新手，所以我很好奇是否有人会有更好的答案，但这是我的看法：

您希望编译时强制执行，当`Add()`在 an 上调用时`IntSlice`，它的参数是 an `int`。好吧，这是你如何做到的：

```
func (i *IntSlice) Add(t int) {
    *i = append(*i, t)
} 
```

由于没有泛型，因此`Add()`每种类型的方法都会有所不同`Bag`，因此`Bag`接口（假设您需要它）变为：

```
type Bag interface {
    IsEmpty() bool
    Size() int
} 
```

这对我来说是有道理的，因为你不能`Bag`绕过并把任何东西扔进去。知道某物是 a`Bag`并不足以知道如何调用`Add()`它；你必须知道`Bag`你正在处理的是什么类型的。

您可以使接口特定于类型，例如`IntBag`，但由于实际上只有一种类型会满足该接口，因此您最好摆脱接口并将名称更改为`IntSlice`to `IntBag`。

基本上，这意味着完全放弃任何类似泛型的东西，而只是使用一些方法来创建一个类型，这些方法可以满足您的需求：

```
type IntBag []int

func (b *IntBag) Add(i int) {
    *b = append(*b, i)
}

func (b IntBag) IsEmpty() bool {
    return len(b) == 0
}

func (b IntBag) Size() int {
    return len(b)
} 
```

**更新：**有时泛型真的会派上用场。在我看来，我们只能根据具体情况选择最适合给定问题的方法。使用空接口和反射，您可以获得一些类似泛型的行为，但它往往很丑陋，并且您放弃了一些编译时类型检查。或者你放弃泛型并有一些代码重复。或者你只是用完全不同的方式来做。

几周前我问了一个问题，关于我应该如何使用 Go 来处理在我看来需要类层次结构的问题。答案基本上是没有通用的解决方案；这都是个案。我认为这同样适用于泛型：Go 中没有泛型，也没有将基于泛型的解决方案转换为 Go 的通用解决方案。

在很多情况下，您可能会在另一种语言中使用泛型，但接口在 Go 中完全足够（或真正闪耀）。您在这里的示例是接口并不是真正合适的替代品。另请参阅：[Go Vs。泛型](http://code.google.com/p/go-wiki/wiki/GoVsGenerics)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-23T20:21:51.057

我非常精通围棋。泛型是一个备受争议的话题，目前还没有与 Java 泛型或 C++ 模板类似的东西。目前的约定是使用空接口实现“通用”类型，然后用特定类型实现包装它，以确保仅使用该类型的元素。`container/list`这是来自 Go 标准库的示例。

[http://play.golang.org/p/9w9H1EPHKR](http://play.golang.org/p/9w9H1EPHKR)

```
package main

import (
    "container/list"
    "fmt"
)

type IntList struct {
    innerList *list.List
}

func NewIntList() *IntList {
    return &IntList{list.New()}
}

func (l *IntList) Add(i int) {
    // this is the only way to add an element to the list,
    // and the Add() method only takes ints, so only ints
    // can be added
    l.innerList.PushBack(i)
}

func (l *IntList) Last() int {
    lastElem := l.innerList.Back()

    // We can safely type-assert to an int, because Add()
    // guarantees that we can't put a non-int into our list
    return lastElem.Value.(int)
}

func main() {
    l := NewIntList()
    l.Add(5)
    l.Add(4)
    l.Add(3)
    l.Add(2)
    l.Add(1)
    fmt.Println("Expecting 1; got:", l.Last())
} 
```

# php - 错误“为 foreach() 提供的参数无效”

> ID：11908082
> 
> 赞同：-2
> 
> 时间：2012-08-10T19:31:08.057
> 
> 标签：php, mysql

```
include_once 'include/connect_db.php';
$query="SELECT tm FROM schedule WHERE val='BT009';";
$result=ejecutar_query($query);

$rows = array();

if ($result && mysql_num_rows($result)) {
    foreach ($result as $row):
        $rows[] = $row['tm'];
        echo $row['tm'];       
    endforeach;
} 
```

我确定 SQL 查询应该返回 1 个条目。但是，回显输出“数组”。错误消息是：为 foreach() 提供的参数无效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:32:35.880

该错误告诉您一切：`$result`实际上不是数组（或至少不是填充数组）。

你不能`echo`一个数组。对它执行一个`var_dump()`或`print_r`。

此外，您`$rows = array();`在循环之前设置。WTF，伙计？

你本质上是在说“对于这个空数组的每个索引......做一些事情。”

而是尝试：

```
if (is_array($result) && count($result)) { ... } 
```

如果`$result`是来自 mysql 查询的结果集，并且您想遍历*该*结果集，请尝试以下操作：

```
if (mysql_num_rows($result)) {
    while ($row = mysql_fetch_array($result)) {
        // do stuff
    }
} 
```

**请注意：**您应该停止使用`mysql_*`函数。它们正在被弃用。而是使用[PDO](http://php.net/manual/en/book.pdo.php)（从 PHP 5.1 开始支持）或[mysqli](http://php.net/manual/en/book.mysqli.php)（从 PHP 4.1 开始支持）。如果您不确定要使用哪一个，[请阅读这篇文章](http://net.tutsplus.com/tutorials/php/pdo-vs-mysqli-which-should-you-use/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T19:35:48.070

我假设 $result 是一个 MySQL 结果集，在这种情况下你不只是迭代它，你需要使用一些方法将结果集转换为一个数组，如：

```
while($row = mysqli_fetch_array($result)) {
    $rows[] = $row['tm'];
    echo $row['tm'];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T19:38:38.230

改变你的 for 循环：

```
while($row = mysql_fetch_array($result)) {
    $rows[] = $row['ETA'];
    echo $row['ETA'];
}
print_r($rows); // To double check 
```

# c# - C# MVC 解决方案？

> ID：11908083
> 
> 赞同：0
> 
> 时间：2012-08-10T19:31:09.543
> 
> 标签：c#, janus, telerik-open-access

我最近的任务是更新用 C# 完成的系统。我来自 Kohana MVC 基于 Web 的开发，但有 C# 经验。

问题是：我的解决方案是一些“奇怪”的命名约定。我想知道它可能是什么以及如何在 VS 2010 Ultimate 中加载解决方案。

```
MySolution.BusinessLogic
MySolution.Common
MySolution.Contracts
MySolution.DataAccess
MySolution.DatabaseInstaller
MySolution.Entities
MySolution.Reporting
MySolution.UI
MySolution.UIControls 
```

这是如何运作的？我需要单独编辑每个文件夹还是有办法在我的开发人员 IDE 中加载整个解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T19:34:54.997

应该有一个`.sln`解决方案文件，可能在项目根文件夹中。这通常是您在 Visual Studio 中打开的内容。您可以打开单个项目文件 ( `.csproj`)，但使用包含所有必需项目的解决方案会更容易/更好。

# caching - 使用 ehcahce 优于静态 HashMap 的优势

> ID：11908084
> 
> 赞同：9
> 
> 时间：2012-08-10T19:31:26.207
> 
> 标签：caching, static, annotations, ehcache

我一直使用 java 单例类来满足我的基本缓存需求。
现在该项目正在使用 ehcache 并且没有深入研究源代码，我无法弄清楚单例模式有什么问题。

即使用ehcahce框架除了缓存可以通过xml配置和注解不用写样板代码（即静态HashMap）来完成之外还有什么好处

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T19:47:46.280

这取决于您对缓存机制的需求。Ehcache 提供了很多很酷的功能，需要大量精心设计的代码手动完成：

*   LRU、LFU 和 FIFO 缓存驱逐策略
*   灵活配置
*   持久性
*   复制
*   还有很多 ...

我建议您在[http://ehcache.org/about/features](http://ehcache.org/about/features)上查看它们，然后确定您的项目中是否真的需要一些东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T09:37:56.517

最重要的一个：

**溢出到磁盘的能力**——这是你在普通的 HashMap 中没有的东西，写这样的东西绝非易事。EhCache 可以像配置键值数据库一样简单。

即使您不使用溢出到磁盘，也有一个大型**样板文件可以**用您自己的实现来编写。如果可以加载整个数据库，那么使用具有写入持久性和启动时恢复的内存数据库将是解决方案。但是内存是有限的，你必须从内存中**删除元素。**但是哪一个，基于什么？此外，您必须断言缓存元素不会太旧。旧的元素应该被替换。如果您需要从缓存中删除元素，则应从**过时**的元素开始。但是当用户请求某些东西时你应该这样做吗？它会减慢请求。还是开始自己的线程？

**使用 EhCache，您可以在其中解决和测试**所有这些问题的库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T18:06:49.617

还有一个 ehcache 的集群闭源版本，它允许您拥有分布式缓存。这可能是您可能要考虑使用 ehcache 的原因之一。

# sql-server - 引用 SSIS 包中的变量

> ID：11908086
> 
> 赞同：0
> 
> 时间：2012-08-10T19:31:38.197
> 
> 标签：sql-server, sql-server-2008, ssis

我有一个 SSIS 包，它遍历一个表，并且对于表中的每一行，将来自两个不同列的值作为参数传递给存储过程。至少，这是它应该做的。它实际上做的是给我这个错误：

```
[Execute SQL Task] Error: Executing the query "EXEC sproc_AccessImport @mAccessLocation (SELECT M..." failed with the following error: "Must declare the scalar variable "@mAccessLocation".". Possible failure reasons: Problems with the query, "ResultSet" property not set correctly, parameters not set correctly, or connection not established correctly. 
```

我按照[本教程](http://www.mssqltips.com/sqlservertip/1437/dynamically-build-connection-objects-for-ms-access-databases-in-ssis/)制作了获取信息的部分，并且应该执行存储过程的代码是：

```
EXEC sproc_AccessImport @mAccessLocation (SELECT MVID FROM tbl_AccessMailDataFiles WHERE FileLocation = @mAccessLocation) 
```

我一直在网上四处寻找，但没有发现任何有用的东西。这是我第一次使用 SSIS，所以我怀疑我只是做错了什么。有谁知道那到底是什么？谢谢。

编辑：我尝试使用以下选项将变量映射为参数：

```
Variable Name:  User::mAccessLocation
Direction:      Input
Data Type:      VARCHAR
Parameter Name: Path
Parameter Size: 200 
```

并将 SQL 查询更改为：

```
EXEC sproc_AccessImport @Path (SELECT MVID FROM tbl_AccessMailDataFiles WHERE FileLocation = @Path) 
```

它现在给了我错误：

```
[Execute SQL Task] Error: Executing the query "EXEC sproc_AccessImport @Path (SELECT MVID FROM tb..." failed with the following error: "Must declare the scalar variable "@Path".". Possible failure reasons: Problems with the query, "ResultSet" property not set correctly, parameters not set correctly, or connection not established correctly. 
```

所以，真的，同样的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:00:12.433

根据您的包的设置方式，您可能需要将 SSIS 变量映射到执行 SQL 任务中的参数。您看到的具体错误最有可能是因为您使用的是 OLEDB 连接，并且该语句可能应该是

```
EXEC sproc_AccessImport ? (SELECT MVID FROM tbl_AccessMailDataFiles WHERE FileLocation = ?) 
```

如果您遵循链接到的示例，那么您会将 User::mAccessLocation 映射到第一个和第二个参数。我希望这是有道理的，但我不是 100% 知道你是如何设置的。

# ruby-on-rails - CanCan通过id授权

> ID：11908090
> 
> 赞同：0
> 
> 时间：2012-08-10T19:32:01.277
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cancan

我在 Rails 中有一个多对多的关系，一个用户拥有并属于许多 user_types，反之亦然。那么 user_type 有很多角色。

role_fruits 表的示例表：

> role_id：1，fruit_id：6

角色表示例：

> id：1，姓名：Bannana Worker

用户示例表：

> id：1，用户名：employee143

水果表示例：

> id: 6, name: 香蕉

在模型中

# 用户.rb

```
has_and_belongs_to_many :roles 
```

# 角色.rb

```
has_and_belongs_to_many :users 
```

现在，我想要完成的是让具有“Bannana Worker”（id 1）角色的用户能够访问它，而没有它的用​​户则不能进入它。

## 伪代码看起来像这样：

如果 user.roles 包含水果 id 然后可以：管理，水果

我怎样才能用 cancan 完成这个，如果不可能，什么是好的替代宝石？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:41:04.470

尝试这样的事情`ability.rb`

```
can :manage Fruit do |fruit|
  user.roles.exists?(fruit.id)
end 
```

在你的控制器中你可以做

```
def your_action
  @fruit = ...

  authorize! :manage, @fruit

  #  ...
end 
```

# javascript - Emberjs - 将参数动态绑定到视图

> ID：11908096
> 
> 赞同：1
> 
> 时间：2012-08-10T19:32:22.657
> 
> 标签：javascript, model-view-controller, ember.js

我正在尝试为我的模型中的一组选定参数创建可编辑视图。

[jsfiddle值一千字！](http://jsfiddle.net/ZVFH2/5/)

如您所见，它将内容链接到实际字符串 - 而不是路径，就像在工作（但不是动态）的第二个 ParameterView 中一样。

我看过[这篇文章](https://stackoverflow.com/questions/10406771/what-is-the-ideal-way-to-create-view-instance-specific-bindings-in-emberjs)，但这是一个非常笨拙的解决方案，尤其是当我每个模型有大约 20 个左右的参数时，有四个不同的模型。

有任何想法吗？提前感谢您分享您的脑力。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:07:06.373

不确定我理解得很好，它对你有用吗？[http://jsfiddle.net/Sly7/ZVFH2/9/](http://jsfiddle.net/Sly7/ZVFH2/9/)

***更新***

我想我找到了一种方法，通过在运行时定义绑定，使用该`bind()`函数。

见：http: [//jsfiddle.net/Sly7/ZVFH2/34/](http://jsfiddle.net/Sly7/ZVFH2/34/)

# javascript - Javascript - 移动滑动滚动

> ID：11908101
> 
> 赞同：1
> 
> 时间：2012-08-10T19:32:40.457
> 
> 标签：javascript, html, windows-phone-7, scroll, touch

我正在尝试使用 Javascript 实现某种类型的基于触摸的滚动。我找到了一些选项，[this](http://james.lin.net.nz/2010/09/27/javascript-swipe-demo-works-both-with-finger-ipad-and-mouse-pc/)和[this](http://touchswipedemo.celestialcitizen.jit.su/)，但在 Windows Phone 7 设备上都不起作用。我的网站主要用于我的 Windows Phone 应用程序，因此它们无法运行。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-10T19:43:25.407

查看 jQuery 的移动 UI。它专为移动设备而构建。此外，您还可以将其用作包装器，以移动友好的方式向您展示内容。

[http://jquerymobile.com/](http://jquerymobile.com/)

# python - 检查连接，如果没有可用连接则退出

> ID：11908105
> 
> 赞同：0
> 
> 时间：2012-08-10T19:32:47.917
> 
> 标签：python, wxpython

我正在制作一个需要互联网连接的 wxpython 应用程序。所以，我需要检查连接是否存在，如果没有，则退出。所以我的代码看起来像这样。

```
class Example(wx.Frame):

    def __init__(self, parent, title):
        super(Example, self).__init__(parent, title=title, 
            size=(700,650))
        self.InitUI()
        self.Centre()

#*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.
#--------------------------------------------------------------------------------

        favicon = wx.Icon(ICON_PATH, wx.BITMAP_TYPE_ICO)
        wx.Frame.SetIcon(self, favicon)
        self.Show()     

    def InitUI(self):
        #checkConnection()
        checkInstances()

        panel = wx.Panel(self)

        font = wx.SystemSettings_GetFont(wx.SYS_SYSTEM_FONT)
        font.SetPointSize(9)

        font1 = wx.SystemSettings_GetFont(wx.SYS_SYSTEM_FONT)
        font1.SetPointSize(10)

#Layout 

        vbox = wx.BoxSizer(wx.VERTICAL)

        hbox1 = wx.BoxSizer(wx.HORIZONTAL)
        st1 = wx.StaticText(panel, label='Select Slot :')
        st1.SetFont(font1)
        hbox1.Add(st1, flag=wx.ALL, border=8)

        try:
            handler = urllib.urlopen("http://%s/api/get-slots/?api_key=%s"%(BASE_DOMAIN, API_KEY))
        except:

            wx.MessageBox("Error communicating with the server.", 'WARNING',wx.OK |wx.ICON_INFORMATION)
            handler = None
            sys.exit(0) 
```

所以我想检查上面的那个链接（一些链接），如果它失败了，我会显示一个消息框，然后我退出。当我运行此程序（关闭互联网）时，该应用程序确实显示消息，单击确定后，另一个回溯框打开并打印

```
SystemExit:0 
```

它实际上并没有退出。尝试使用 self.Close 也。那也不行。想到我们一运行应用程序就创建一个检查连接功能。

```
def checkConnection():

    try:
        test = urllib.urlopen("http://www.google.com")
    except:
        sys.exit(0) 
```

把它放在

```
 def InitUI(self):
        checkConnection()
        .........
        ......... 
```

这也做了同样的事情。那么有什么方法可以避免打印并实际退出？

`os._exit`有效，但我只是认为这也`sys.exit`应该有效。所以有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:41:56.200

代替`sys.exit`（或`os._exit`）使用

```
self.Destroy() 
```

`os._exit`在不调用任何清理处理程序的情况下突然停止进程，通常不应使用（除非[在 fork 之后停止子进程](http://docs.python.org/library/os.html#os._exit)）。

`sys.exit`引发 SystemExit 异常。`wxpython`必须捕获此异常并选择在不退出应用程序的情况下打印错误消息。

`self.Destroy()`应该退出应用程序。

* * *

```
try:
    test = urllib.urlopen("http://www.google.com")
except IOError:
    wx.MessageBox("Error communicating with the server.")
    self.Destroy() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T04:43:11.757

通过调用退出 wx.App 事件循环`wx.GetApp().Exit()`。

# php - PHP - 以 HTML 形式设置值

> ID：11908108
> 
> 赞同：0
> 
> 时间：2012-08-10T19:33:01.347
> 
> 标签：php

我是 PHP 新手，想创建一个简单的网站来管理我的 CD 收藏。

**我连接到 MySQL 数据库并为每个表创建一个 PHP 数组。**

不，我希望能够在 HTML 表单中编辑我的 CD 并将其提交回 MySQL 数据库。

**为此，我创建了一个 for 循环并将每个数组变量放入 HTML 表单中，因此我可以通过提交更新我的数据库来编辑文本和。**

*我知道我的问题有答案：[stackoverflow Answer](https://stackoverflow.com/questions/3317730/putting-a-php-variable-in-a-html-form-value)*

但是这个解决方案对我不起作用。

一条线：

```
echo "<input name="Titel" type="text" size="30" value="<?php echo $alben[$i]['Titel']; ?>">"; 
```

这条线不起作用，我不明白为什么。

有人可以帮忙吗？

编辑：如果我只是说：

```
echo $alben[$i]['Titel']; 
```

这项工作。但是使用 HTML-Form 我收到此错误消息：

```
 syntax error, unexpected T_STRING, expecting ',' or ';' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:39:23.143

```
`Because you need escape the quotes and remove the 2nd echo

```
echo "<input name="Titel" type="text" size="30" value="<?php echo $alben[$i]['Titel']; ?>">"; 
```

into

```
echo "<input name=\"Titel\" type=\"text\" size=\"30\" value=\"" . $alben[$i]['Titel'] . "\">"; 
```

period is string concatination
"a" . "b" becomes "ab"` 
```

 `* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T19:39:45.150

如果你在 php 标签中使用这个：

```
<?php
...
echo '<input name="Titel" type="text" size="30" value="'. $alben[$i]['Titel']; .'">"';
..
?> 
```

如果您在 html 中，请使用以下命令：

```
<input name="Titel" type="text" size="30" value="<?php echo $alben[$i]['Titel']; ?>"> 
````

# python - 在 Appegine 中使用带有 WSGI/threadsafe 的“安全”和“登录”处理程序

> ID：11908109
> 
> 赞同：1
> 
> 时间：2012-08-10T19:33:03.720
> 
> 标签：python, google-app-engine, wsgi

从 Appengine 文档中我非常不清楚如何同时使用`app.yaml`配置设置和`webapp2`框架。

例如，文档建议：

```
- url: /youraccount/.*
  script: accounts.py
  login: required
  secure: always 
```

但是，那`accounts.py`是 CGI 形式；`main.app`与处事方式不兼容。

以下是我尝试过的一些排列，但由于各种原因**失败了：**

```
- url: /.*
  script: main.app

- url: /admin/.*
  secure: always
  login: required 
```

以上失败，因为需要脚本

```
- url: /.*
  script: main.app

- url: /admin/.*
  script: main.app
  secure: always
  login: required 
```

上面的失败是因为`secure`and`login`指令似乎被忽略了。

```
- url: /.*
  script: main.app

- url: /admin/.*
  script: admin.py
  secure: always
  login: required 
```

以上失败是因为处理程序的 CGI 样式与`threadsafe`.

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T19:37:57.787

这个：

```
- url: /.*
  script: main.app

- url: /admin/.*
  script: main.app
  secure: always
  login: required 
```

[自顶向下搜索](https://developers.google.com/appengine/docs/python/config/appconfig#Required_Elements)`app.yaml`文件中的处理程序，并使用第一个可能的匹配项。因此，“和指令似乎被忽略”的症状是因为 URL 与第一个指令 ( ) 匹配，而不是应用您的其他选项。`secure``login``- url: /.*`

基本上，切换顺序，首先使用最具体的模式。

```
- url: /admin/.*
  script: main.app
  secure: always
  login: required

- url: /.*
  script: main.app 
```

# php - PHP邮件功能不从Gmail地址发送

> ID：11908110
> 
> 赞同：0
> 
> 时间：2012-08-10T19:33:11.073
> 
> 标签：php, forms, email, gmail

我正在尝试使此联系表格正常工作，但它似乎无法发送标头说它来自 gmail 地址我觉得雅虎地址也混合了那些不起作用的地址。这是似乎对此很重要的代码。如果主持人很重要，我会在 Dreamhost 上。请告诉我。

```
 if(!is_array($contact_information_type))
{
    $contact_information_type = Array();
}

if($_POST){
    $contact_name = trim(stripslashes($_POST["contact_name"]));
    $contact_company = trim(stripslashes($_POST["contact_company"]));
    $contact_address1 = trim(stripslashes($_POST["contact_address1"]));
    $contact_address2 = trim(stripslashes($_POST["contact_address2"]));
    $contact_city = trim(stripslashes($_POST["contact_city"]));
    $contact_state = trim(stripslashes($_POST["contact_state"]));
    $contact_zip = trim(stripslashes($_POST["contact_zip"]));
    $contact_country = trim(stripslashes($_POST["contact_country"]));
    $contact_phone = trim(stripslashes($_POST["contact_phone"]));
    $contact_fax = trim(stripslashes($_POST["contact_fax"]));
    $contact_email = trim(stripslashes($_POST["contact_email"]));
    $contact_comments = trim(stripslashes($_POST["contact_comments"]));
if($contact_name == ""){ $errors_array[] = "Name is required."; }
if($contact_company == ""){ $errors_array[] = "Company name is required."; }
        if($contact_city == "") { $errors_array[] = "City is required."; }

if($contact_state == ""){ $errors_array[] = "State is required."; }

if($contact_country == "") { $errors_array[] = "Country is required.";}
elseif($contact_country == "United States" ) 
{if($contact_zip != "" && !preg_match("/(^\d{5}$)|(^\d{5}-\d{4}$)/", $contact_zip)){       $errors_array[] = "Incorrect Zip. (e.g. 60660 or 60660-1234)"; };}
elseif($contact_country == "Canada" ){if($contact_zip != "" && !preg_match("/^[ABCEGHJ-    NPRSTVXY]{1}[0-9]{1}[ABCEGHJ-NPRSTV-Z]{1}[ ]?[0-9]{1}[ABCEGHJ-NPRSTV-Z]{1}[0-9]{1}$/i",     $contact_zip)){ $errors_array[] = "Incorrect Zip. (e.g. M4C 1B5 or M4C1B5)"; };}
                                                                                                                                                                                                                                else {;}

    if($contact_phone == ""){ $errors_array[] = "Phone is required."; }
    if($contact_phone != "" && !preg_match("/(^\d{3}-\d{3}-\d{4}$)|  (^\d{10}$)/", $contact_phone)){ $errors_array[] = "Incorrect Phone. (e.g. 123-123-1234)"; }
    if($contact_fax != "" && !preg_match("/(^\d{3}-\d{3}-\d{4}$)|(^\d{10}$)/",   $contact_fax)){ $errors_array[] = "Incorrect Fax. (e.g. 123-123-1234)"; }
    if($contact_email == ""){ $errors_array[] = "E-mail is required."; }
    if($contact_email != "" && !preg_match("/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+\.  [a-zA-Z0-9-.]+$/", $contact_email)){ $errors_array[] = "Incorrect E-mail. (e.g.   youremail@domain.com)"; }
if($contact_comments == ""){ $errors_array[] = "Comments are required."; }
    if(sizeof($errors_array) == 0){
        $contact_information_type = implode(", ",     $contact_information_type);

$email_message = <<<MESSAGE
The contact form on www.rotaryvalve.com has been filled out with the following information:

Name: ${contact_name}
Company: ${contact_company}
Address 1: ${contact_address1}
Address 2: ${contact_address2}
City: ${contact_city}
State: ${contact_state}
Zip: ${contact_zip}
Country: ${contact_country}
Phone: ${contact_phone}
Fax: ${contact_fax}
E-mail: ${contact_email}
Comments/Products of Interest: ${contact_comments}
MESSAGE;

        $email_adds = array("sales-team@wmwmeyer.com", "dan@danbaran.com");
        $email_from = $contact_email;
        $email_subject = "Customer Request/Comment";
        foreach($email_adds as $email_to){
            mail ($email_to, $email_subject, $email_message, "From: ".$email_from." <".$email_from.">");
        } 
```

本质上，如果在表格上填写的contact_email（代码未包含，对不起，您认为您不需要它，但如果您需要，请告诉我）是一个gmail帐户，它似乎没有发送，请帮我解决这个问题.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:40:12.583

问题是没有被发送，还是没有被接收。我很确定问题不在于正在发送的电子邮件，而是当收件人的电子邮件服务收到它时会发生什么。它可能被归类为垃圾邮件，因为他们可以看到它不是从 GMail 邮件服务器发送的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T19:56:16.470

由于 gmail.com 域上的 SPF 记录很可能会将电子邮件标记为垃圾邮件，因此接收服务器或客户端可能会将电子邮件归类为垃圾邮件。

但是，您可以发送带有在联系表单中输入的电子邮件的“回复”标题的电子邮件。这将使电子邮件有更好的机会通过垃圾邮件过滤器，如果收件人点击其客户端中的“回复”按钮，电子邮件将默认发送到此地址。

# php - 将 SQL 数据插入 HTML 文本区域

> ID：11908111
> 
> 赞同：1
> 
> 时间：2012-08-10T19:33:13.670
> 
> 标签：php, mysql, html, sql

我一直在 stackoverflow 上阅读很多问题，这些问题让我的生活更轻松，尽管我第一次问一些问题。

这是我的问题。我需要能够将 SQL 数据库中的不同值插入到选定的 <textarea> 字段中，具体取决于在同一表单上的 <select> 输入中选择的选项。

基本思想是我想从数据库中编辑新闻，编辑标题和正文。为此，我想通过从我的 SQL 数据库中获取它们来向用户显示包含我的数据库的（标题/正文）数据。用户在数据库中可能有多个条目，因此当我在 <select> 组合框中选择一个条目时，我想将内容更改为来自 db.xml 中所选条目的内容。

由于我的英语很差，这是一个难以表达的简单想法......

HTML 表单或多或少如下：

```
<form action="edit.php" method="post">
    <select name="id">
       <option value="1">Option 1</option>
       <option value="2">Option 2</option>
    </select>
    <textarea name="newsBody"></textarea>
    <input name="submit" type="submit" value="Edit" />
</form> 
```

SQL 数据库结构大致如下：

数据库名称：数据库

DB 表：新闻（字段 id、正文、标题、作者、时间戳）

我希望能够从我的 <select> 中选择新闻，获取他们的“id”/“option value”，然后从 DB 中获取正确的值，并将其显示在相应的 <textarea> 中。

我是网站编码的新手，只是作为一种爱好来做，所以我在 PHP、MySQL 方面的知识非常基础。我不提供任何 PHP 代码或选项，只是因为我不知道如何解决它……虽然我可以理解 sql、php 语法。

我想使用 <select> 事件 'onchange' 和 javascript，但无法使其工作......我也不能使用 jQuery / ajax，可能是因为缺乏有用的例子！

希望有人理解并提供解决方案！

提前谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:49:44.583

您可以使用 Ajax。

创建以下`.html`页面：

```
<html>

    <head>

        <script>

            function showData(str)
            {
                if (str=="")
                {
                    document.getElementById("ajax-content").innerHTML="";
                    return;
                } 

                // Code for IE7+, Firefox, Chrome, Opera, Safari
                if (window.XMLHttpRequest)
                {
                    xmlhttp=new XMLHttpRequest();
                }

                // Code for IE6, IE5
                else
                {
                    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
                }

                xmlhttp.onreadystatechange=function()
                {
                    if (xmlhttp.readyState==4 && xmlhttp.status==200)
                    {
                        document.getElementById("ajax-content").innerHTML=xmlhttp.responseText;
                    }
                }

                xmlhttp.open("GET","showData.php?id="+str,true);

                xmlhttp.send();
            }

        </script>

    </head>

    <body>

    <form>

        <select name="news" onchange="showData(this.value)">
            <option value="">Select ID:</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
        </select>

    </form>

    <div id="ajax-content"></div>

    </body>

</html> 
```

以下`.php`脚本（`showData.php`在我的示例中）：

```
<?php

    // Receive variable from URI
    $id=$_GET["id"];

    // Connect to your database
    $con = mysql_connect('localhost', 'user1591005', 'stackOverflow');
    if (!$con)
    {
        die('Could not connect: ' . mysql_error());
    }

    // Select your database
    mysql_select_db("myDatabase", $con);

    // Select all fields from your table
    $sql="SELECT * FROM news WHERE id = '".$id."'";

    $result = mysql_query($sql);

    while($row = mysql_fetch_array($result))
    {
        echo "<input type='text' value='" . $row['title'] . "'>";
        echo "<textarea>" . $row['content'] . "</textarea>";
    }

    // Close the connection
    mysql_close($con);

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T19:40:05.843

好吧，我在午餐前给你一个快速的想法...... :)

1.  设置 AJAX 请求以将选定的下拉框值传递给 PHP 脚本。

2.  在此 PHP 脚本中，从数据库中获取所选值的数据。

3.  返回数据并将文本框的值设置为该值。

[发送 AJAX 请求](http://www.w3schools.com/ajax/ajax_xmlhttprequest_send.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T19:41:04.127

看来您需要为此使用 AJAX 和 Mysql+PHP。首先是从表中收集数据。例如`$result = mysql_query('SELECT * FROM new_table WHERE author = author's id')` ，第二件事是输出带有表格结果的 html 代码，您可以使用`foreach()`循环来执行此操作。然后，您需要使用 ajax（来自 jQuery 框架）并在用户选择时再次从数据库中提取数据。希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T19:50:09.600

要从数据库中获取数据，您必须使用服务器端语言，例如 PHP。要对`<select>`元素的变化做出反应，您必须使用 JavaScript。AJAX 将弥合两种语言之间的差距。

首先编写一些 JavaScript 来进行查询。如果您使用 jQuery，这非常简单。

```
 <script>
            var selector = $("#mySelectorID"); // first select the <select> elm
            selector.change(function(e) { // attach a function to it's change event
                    jQuery.get("getContents.php", // when it changes, make an AJAX call
                            {id:selector.val()}, // passing the value of the <select> as data
                            function(returnVal) { // after a successful AJAX ...
                                    $("#myTextAreaID").val(returnVal); // ... set the textarea to the correct value
                            });
            });
    </script> 
```

然后创建一个新的 php 文件（稍微简化，但这会起作用）：

```
<?php
    $id = $_GET['id']; // get the id that was passed through the URL

    $connection = mysql_connect("hostname","username","password"); // connect to db

    mysql_select_db("database", $connection ); // select the db

    $result = mysql_query("SELECT * FROM news WHERE ID = $id"); // make SQL query

    if ($row = mysql_fetch_array($result)) { // fetch the first row
            echo $row['body']; // output the contents of the row
    }

    connection mysql_close($connection ); // close the connection
?> 
```

有关使用 jQuery 进行 AJAX 的更多信息：http: [//api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-10T20:18:17.580

我想象你想在扩展到 Ajax 之前开发一个简单的 html/PHP 解决方案......

```
<?php
$title = "" ; // set the variables
$body = "" ;
$action = "" ;
$submit = "Edit";

if(isset($_POST['id']) && (int) $_POST['id'] > 0 ){
// a positive integer was sent to your form 
// so now construct your sql statement: ie
// "select title, body from new where id= " . $_POST['id'] ;
// assign your rows to your variables 
// $title = $row['title'] ;
// $body = $row['body'] ;
// now re-use your empty form to display the variables
// re-assign the form variables
// $action = "save.php" ;
// $submit = "Save changes";
}
?>

// have the form submit to itself by default
<form action="<?php echo $action; ?>" method="post">
<select name="id">
<option value="1" <?php if($_POST['id'] == 1 ) echo "selected=selected; ?>>Option 1</option>
<option value="2" <?php if($_POST['id'] == 1 ) echo "selected=selected; ?>>Option 2</option>
</select>
 // have your html form values the same name as your db table columns
    <input type="text" name="title" value="<?php echo $title; ?>"/>
    <textarea name="body"><?php echo $body; ?></textarea>
    <input name="submit" type="submit" value="<?php echo $submit; ?>" />
</form> 
```

save.php 然后将新值存储在您的数据库中，并可能重定向回此页面...

我真的在减少这个，你可能会从数据库中的一个选择中生成你的 id，它们可能是 id，按字母顺序排列的标题：

一个大故事 一个大故事

ETC

还有很多其他因素需要考虑，但这是解决问题的一种方法。

# macos - 从 Quicktime 电影中获取 EXIF 信息

> ID：11908113
> 
> 赞同：0
> 
> 时间：2012-08-10T19:33:24.170
> 
> 标签：macos, cocoa, quicktime, exif

对于 JPG 图像，我可以只使用 CGImageSourceCopyPropertiesAtIndex 从图像中获取 EXIF 信息的各个位。但是，此 API 不适用于 quicktime 电影文件。

我可以使用哪些类似的 Cocoa API 从 Quicktime 电影文件中提取 EXIF 信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:38:47.387

EXIF 是图像文件的标准，而不是电影的标准。没有为电影定义 EXIF 信息，相应地也没有 API 可以从快速电影文件中检索它们。

# php - php 注意：未定义索引：在第 55 行登录 C:\xampp\htdocs\index.php

> ID：11908115
> 
> 赞同：1
> 
> 时间：2012-08-10T19:33:30.100
> 
> 标签：php

> **可能重复：**
> [PHP：“注意：未定义的变量”和“注意：未定义的索引”](https://stackoverflow.com/questions/4261133/php-notice-undefined-variable-and-notice-undefined-index)

我收到警告。我想照顾它。这是有问题的代码

```
if ($_REQUEST['login']) $user = $_REQUEST['login'];
elseif ($_COOKIE['user']) $user = $_COOKIE['user'];

if ($_REQUEST['encpas']) $pass = $_REQUEST['encpas'];
elseif ($_COOKIE['pass']) $pass = $_COOKIE['pass'];

if ($_REQUEST['randsess']) $sess = $_REQUEST['randsess'];
elseif ($_COOKIE['sess']) $sess= $_COOKIE['sess']; 
```

我不知道如何摆脱它们。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T19:38:26.057

检查您的变量以查看它们是否设置并具有值：

```
if ( isset($_REQUEST['login']) ) { 
    $user = $_REQUEST['login'];
} elseif ( isset($_COOKIE['user']) ) {
    $user = $_COOKIE['user'];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T19:40:01.903

在检查索引是否为真之前，尝试使用 isset() 检查索引是否已初始化。 [http://au.php.net/manual/en/function.isset.php](http://au.php.net/manual/en/function.isset.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T19:40:25.010

您应该使用 array_key_exists 或 isset。根据一些基准，最后一个更快。

```
if( isset( $_REQUEST['login'] ) ) {
  $user = $_REQUEST['login'];
} 
```

isset 不将 NULL 计为值。

请注意这一点，因为以下原因：

```
index.php?login=&otherstuff 
```

将使用空值设置登录。但它会被设置。

# compiler-construction - 如何构建我自己的 opengl 着色器编译器？

> ID：11908121
> 
> 赞同：0
> 
> 时间：2012-08-10T19:34:17.540
> 
> 标签：compiler-construction, glsl

GLSL 和 CG 工具包根本不足以满足我的需求，看来我唯一的选择就是编写自己的编译器。我基本上需要一个二进制着色器结构图，这样我就可以自己从脚本中构建它。

编辑：好的，我想我正在寻找的是 arb 程序集的二进制结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:05:14.143

> 如何构建我自己的 opengl 着色器编译器？

你没有。至少，不是按照你的意思。

OpenGL 没有定义二进制或汇编交换格式。OpenGL 本身直接将 GLSL 编译成对象。即使您可以查询二进制数据，OpenGL 也没有提供解释二进制数据实际*存储*什么的方法。它依赖于实现。NVIDIA 和 AMD 将存储不同的信息，这将与英特尔存储的不同。每一代硬件都会发生变化。等等。

您可以编写生成*GLSL*的编译器。但仅此而已。

如果您愿意坚持使用 NVIDIA，他们一直很擅长使 ARB 汇编语言保持最新。但显然，任何这样的代码都是 NVIDIA 独有的。

# javascript-events - 停止滚动在浏览器中弹跳

> ID：11908122
> 
> 赞同：1
> 
> 时间：2012-08-10T19:34:24.287
> 
> 标签：javascript-events

我在 windows8 触摸屏设备上使用 IE10 浏览器来测试我的网页。我的网页前端是基于 JSP 和 Javascript 构建的。

我的问题是，当用户触摸他们的浏览器，向下拖动手指时，浏览器会在我加载的网页上方显示一个空白点？

有没有办法在浏览器中禁用它。或任何我可以处理的javascript。

# apache - htaccess 移到 vhost 玩得不好

> ID：11908123
> 
> 赞同：0
> 
> 时间：2012-08-10T19:34:28.723
> 
> 标签：apache, redirect, vhosts

我想移动我的 .htaccess 文件 - 重定向到我的 vhost conf 文件...

这是有效的 - 但 htaccess 重定向不是......

```
<VirtualHost *:80>
ServerName  dev.x.com
ServerAlias dev.x.com
DocumentRoot    "C:/wwwroot/x"
Alias       /modules/    "C:/wwwroot/x/_my_modules/"
ErrorLog    "C:/wwwroot/x/_my_logs/error.log"
CustomLog   "C:/wwwroot/x/_my_logs/access.log" combined
<Directory  "C:/wwwroot/x/_my_logs/" >
    Options FollowSymLinks
    AllowOverride All
    Order deny,allow
    Deny from all
    Satisfy all
</Directory>
</VirtualHost> 
```

然后我做了这个 -

```
<VirtualHost *:80>
    ServerName  dev.x.com
    ServerAlias dev.x.com
    DocumentRoot    "C:/wwwroot/x"
    Alias       /modules/    "C:/wwwroot/x/_my_modules/"
    ErrorLog    "C:/wwwroot/x/_my_logs/error.log"
    CustomLog   "C:/wwwroot/x/_my_logs/access.log" combined
    <Directory  "C:/wwwroot/x/_my_logs/" >
        Options FollowSymLinks
        AllowOverride All
        Order deny,allow
        Deny from all
        Satisfy all
    </Directory>

    RewriteEngine on

    # if requested URI is not a file and not a directory
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d

    # externally redirect to /newLocation/{URI}
    # RewriteRule (.*) index.php?_req=$1 [L]

    # could use a redirect to a new directory --- 
    RewriteRule ^ /_mf_modules%{REQUEST_URI} [L,R=301]
</VirtualHost> 
```

我的目标是：我希望将任何不存在的“目录”请求重新路由到 _my_modules 目录中该名称的目录。

如果文件不存在，我想重定向到 _my_modules 目录中该名称的目录。

因此，如果 www.x.com/xxx 是 url ......并且 'xxx' 目录不存在，我会重定向到 www.x.com/_my_modules/xxx

同样明智的是，如果请求 www.x.com/xxx.php - 但 xxx.php 不存在，它们将被重定向到 www.x.com/_my_modules/xxx

*   但是（即使每个目录中都有一个 index.php），这些总是会导致 eURL 重定向到这个...

    在此服务器上找不到请求的 URL /modules/modules/modules/modules/modules/modules/modules/modules/modules/modules/modules/modules/modules/modules/modules/modules/modules/modules/modules/_my_modules/ .

所以我受够了，把 vhost 文件改回原来的样子，重新启动 Apache，它仍然在重定向，我无法摆脱这种行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T07:24:28.300

您可以将 RewriteRules 从 .htaccess 移动到 VirtualHost 环境，方法是将它们放在`<Directory>`您的 vhost 配置中的环境中。

在您的情况下，请尝试将您的重写规则剪切并粘贴到`<Directory "C:/wwwroot/x/_my_logs/" >`

如果你真的想把它们放在 VirtualHost 环境中，你必须修改它们的路径：.htaccess 中的 RewriteRules 或相对于目录，VirtualHost 中的 RewriteRules 是绝对文件系统的根或 DocumentRoot。

重写示例：

```
RewriteCond %{REQUEST_FILENAME} !-f 
```

应该在虚拟主机中：

```
RewriteCond /your/documentroot/%{REQUEST_FILENAME} !-f 
```

重写示例：

```
RewriteRule (.*) /your/documentroot/index.php?_req=$1 [L] 
```

应该在虚拟主机中：

```
RewriteRule (.*) index.php?_req=$1 [L] 
```

# android - 如何使 MapView 上的 ZoomControl 透明？

> ID：11908125
> 
> 赞同：1
> 
> 时间：2012-08-10T19:34:36.790
> 
> 标签：android, controls, zooming, android-mapview, transparent

我`MapView`已经透明的上有一堆按钮，所以我想让底部的内置缩放控件也透明。`getZoomControl()`on已`MapView`弃用。任何人都知道如何`Buttons`在没有 的情况下掌握控制权`getZoomControl`？

**编辑：**

所以我想通了。事实证明，它`ZoomButtonsController`有一个容器，它只是一个`ViewGroup`. 我可以通过该容器子项进行解析，以找到一个 instanceof a 的对象`ZoomControl`，它是 a 的下线实例`ViewGroup`。我可以解析 的子项`ZoomControl`以获取`ZoomButtons`它包含的内容。 `getBackground()`的`ZoomButton`和`setAlpha()`。

这是我的代码：

```
android.widget.ZoomButtonsController zbc = mapView.getZoomButtonsController();
    ViewGroup container = zbc.getContainer();
    for (int i = 0; i < container.getChildCount(); i++) {
        View child = container.getChildAt(i);
        if (child instanceof ZoomControls) {
            ViewGroup zoomC = (ViewGroup)child;
            for (int j = 0; j < zoomC.getChildCount(); j++) {
                View btn = zoomC.getChildAt(j);
                if ( btn instanceof ZoomButton ) { 
                    ((ZoomButton)btn).getBackground().setAlpha(120);
                }
            }
            break;
        } 
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T19:37:44.833

删除内置的缩放按钮并使用您自己的按钮并设置它们的操作以执行缩放操作。您可以使按钮看起来像您想要的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:24:29.733

尝试按照文档中的建议使用[setBuiltInZoomControls(boolean)](https://developers.google.com/maps/documentation/android/reference/com/google/android/maps/MapView#setBuiltInZoomControls%28boolean%29)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:07:29.183

据我了解，它已被弃用，`android.view.View`但它位于`android.widget.ZoomButtonsController`. 不确定这是否有帮助。让我知道。

[这是一些文档。](http://developer.android.com/reference/android/widget/ZoomButtonsController.html#getZoomControls%28%29)

# css - 换行适用于除 IE 以外的所有浏览器

> ID：11908140
> 
> 赞同：0
> 
> 时间：2012-08-10T19:35:56.280
> 
> 标签：css, iframe, word-wrap

我在页面上有一个小部件，它为源调用另一个脚本。像这样：

```
<!-- Beginning of widget code. -->
<div id="xyz_widget" ></div>
<script id="bootstrap" type="text/javascript" src="<some location>/bootstrap.js?" charset="utf-8">
</script> 
```

在 bootstrap.js 中存在这个 iframe 代码：

```
<iframe style='background:transparent;overflow:hidden;border:0px;height:100%;width:100%' 
frameborder='0' border='0' marginwidth='0' marginheight='0' "width='100%' height='100%' 
allowTransparency='true'
src='"+buildBaseUrl (pUri)+"/widget/widget.jsp?"+pUri.query+"'>
</iframe> 
```

我的问题是我无法在框架内包装长文本。所以 11111111111111111111111111111111111111111111 超出了框架宽度。我试过 word-wrap:break-word 但它没有帮助。

我还应该提到这个问题只存在于 IE 中。FF、Chrome、Safari 一切正常。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:41:22.713

看看这个 css 属性[-ms-word-wrap](http://msdn.microsoft.com/en-us/library/ie/ms531186%28v=vs.85%29.aspx)，在`iframe`加载的页面中放一个`div`这样的

```
<div style="word-wrap:break-word;width:100%;left:0">
    ... //content on the page
</div> 
```

希望有帮助，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:40:08.440

请试试：

```
.wrapWords {
    width: 300px;
    white-space:      pre-wrap; /* css-3 */
    white-space: -moz-pre-wrap; /* Mozilla, since 1999 */
    white-space:     -pre-wrap; /* Opera 4-6 */
    white-space:   -o-pre-wrap; /* Opera 7 */

    word-wrap: break-word; /* Internet Explorer 5.5+ */
} 
```

# cuda - 澄清 CUDA 中的内存事务

> ID：11908142
> 
> 赞同：6
> 
> 时间：2012-08-10T19:36:05.143
> 
> 标签：cuda, gpu

我对性能指南章节中 CUDA 编程指南 4.0 第 5.3.2.1 节中的以下语句感到困惑。

```
Global memory resides in device memory and device memory is accessed
via 32-, 64-, or 128-byte memory transactions. 

These memory transactions must be naturally aligned:Only the 32-, 64- , 
128- byte segments of device memory 
that are aligned to their size (i.e. whose first address is a 
multiple of their size) can be read or written by memory 
transactions. 
```

1）我对设备内存的理解是线程对设备内存的访问是未缓存的：因此，如果线程访问内存位置`a[i]`，它将仅`a[i]`获取`a[i]`. 所以第一个陈述似乎与此相矛盾。或者我在这里误解了“内存事务”这个短语的用法？

2）第二句话似乎不是很清楚。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T20:03:14.007

1.  *每个 warp*执行内存事务。所以 32 字节事务是 8 位类型的 warp 大小的读取，64 字节事务是 16 位类型的 warp 大小的读取，而 128 字节事务是 32 位类型的 warp 大小的读取。
2.  这只是意味着所有读取都必须与自然字长边界对齐。warp 不可能读取具有 1 字节偏移量的 128 字节事务。有关更多详细信息，请参阅[此答案](https://stackoverflow.com/a/11832846/681865)。

# asp.net-mvc-3 - 如何在 MVC 3 中异步执行方法？

> ID：11908147
> 
> 赞同：1
> 
> 时间：2012-08-10T19:36:43.170
> 
> 标签：asp.net-mvc-3, asynchronous, parallel-processing

是否可以在 MVC3 Action 方法中异步/并行调用方法？

```
public ActionResult CreateUser(string name,string password)
{
 int newUserId=  myRepositary.CreateUser(name,password)
 if(newUserID>0)
 {
   //i want to execute this asycn /parallel ?
   UpdateUserIDINRelatedTables();
 }
 return RedirectToAction("AccountCreated");
}
public void UpdateUserIDINRelatedTables()
{
  //I will  update the userId in few another tables.

} 
```

`UpdateUserIDINRelatedTables`做一些后端工作将新的 USERID 关联到一些其他表。我想在`AccountCreated`执行 CreateUser 方法后立即重定向到视图（不想等到`UpdateUserIDInRelatedTables()`方法完成执行。有什么想法吗？（在 C# 4，MVC3 中）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-08T05:47:32.300

尝试异步控制器。这可能会对您有所帮助 [http://msdn.microsoft.com/en-us/library/ee728598(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ee728598(v=vs.100).aspx)

# java - Java 神秘的 NullPointerException

> ID：11908148
> 
> 赞同：-6
> 
> 时间：2012-08-10T19:36:45.410
> 
> 标签：java

所以我手上有点神秘。我将一些参数传递给一个方法，但该方法永远不会执行。我已经检查以确保所有参数本身都不为空。它甚至不执行方法中的第一行（一个简单的`System.out.println()`）。知道问题可能是什么吗？

这是正在审查的方法：

```
public static void passedTest(String title, String startPhase, String endPhase,
            String startTime, String endTime, long startMilli, long endMilli, String testNum) {
        System.out.println("PASSED");
        endMilli = System.currentTimeMillis();
        totalLength += (endMilli - startMilli);
        passedCount++;
        try {
            out.newLine();
            out.write("Test Case " + testNum);
            out.newLine();
            out.newLine();
            out.write(title + " --- " + startPhase.toUpperCase() + " to "
                    + endPhase.toUpperCase());
            out.newLine();
            out.write("PASSED");
            out.newLine();
            out.write("__________________________________________");
            out.newLine();
            out.write("");
            out.newLine();
            out.write("\tSTARTED:  " + startTime);
            out.newLine();
            out.write("\tENDED:    " + endTime);
            out.newLine();
            out.write("\tDURATION: " + timeConverter(endMilli - startMilli));
            out.newLine();
            out.write("");
            out.newLine();
            out.write("--------------------------------------------------------------------------------------------------------------------------------------------------");
            out.newLine();
            out.write("--------------------------------------------------------------------------------------------------------------------------------------------------");
            out.newLine();
        } catch (IOException e) {

        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T19:49:16.890

如果方法中的第一行没有被执行，那么该方法就不会被调用。有可能*它*实际上已被执行并`System.out`已被重定向，因此它不会打印到控制台而是打印到其他地方。

使用调试器，在您认为调用*此*方法的所有代码行上设置断点，调试并单步执行该方法。也许你最终会去别的地方...

# wcf - WCF 操作合同

> ID：11908153
> 
> 赞同：20
> 
> 时间：2012-08-10T19:37:07.337
> 
> 标签：wcf, operationcontract

什么是 WCF 操作合同？我真的不明白它的作用

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-08-13T20:05:38.767

WCF 使用选择加入模型来定义属于其合同之一的内容。在服务契约接口中，只有用修饰过`[OperationContract]`的方法才会暴露给客户端。这意味着，在下面的接口中，如果在 WCF 服务中使用，客户端可以调用 Add 和 Subtract 操作，但不能调用 Multiply。

```
[ServiceContract]
public interface ICalculator
{
    [OperationContract]
    int Add(int x, int y);

    [OperationContract]
    int Subtract(int x, int y);

    // Not decorated
    int Multiply(int x, int y);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-06-01T23:27:53.210

您希望能够从客户端调用用户的每个方法都必须像这样声明。

# c# - 使用反射调用静态方法

> ID：11908156
> 
> 赞同：130
> 
> 时间：2012-08-10T19:37:23.903
> 
> 标签：c#, reflection, dynamic

我在命名空间中有几个静态类，`mySolution.Macros`例如

```
static class Indent{    
     public static void Run(){
         // implementation
     }
     // other helper methods
} 
```

**所以我的问题是如何在反射的帮助下调用这些方法？**

如果方法不是静态的，那么我可以执行以下操作：

```
var macroClasses = Assembly.GetExecutingAssembly().GetTypes().Where( x => x.Namespace.ToUpper().Contains("MACRO") );

foreach (var tempClass in macroClasses)
{
   var curInsance = Activator.CreateInstance(tempClass);
   // I know have an instance of a macro and will be able to run it

   // using reflection I will be able to run the method as:
   curInsance.GetType().GetMethod("Run").Invoke(curInsance, null);
} 
```

我想让我的课程保持静态。我怎样才能用静态方法做类似的事情？

**简而言之**，我想调用命名空间 mySolution.Macros 中所有静态类的所有 Run 方法。

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2012-08-10T19:39:27.470

正如[MethodInfo.Invoke 的文档](http://msdn.microsoft.com/en-us/library/a89hcwhh.aspx)所述，静态方法的第一个参数被忽略，因此您可以只传递 null。

```
foreach (var tempClass in macroClasses)
{
   // using reflection I will be able to run the method as:
   tempClass.GetMethod("Run").Invoke(null, null);
} 
```

正如评论指出的那样，您可能希望在调用时确保该方法是静态的`GetMethod`：

```
tempClass.GetMethod("Run", BindingFlags.Public | BindingFlags.Static).Invoke(null, null); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-11-09T14:31:45.237

通过只创建一次委托（也不需要实例化类来调用静态方法），你可以真正地、真正地、真正地优化你的代码。我做了一些非常相似的事情，我只是在帮助类的帮助下将一个委托缓存到“运行”方法:-)。它看起来像这样：

```
static class Indent{    
     public static void Run(){
         // implementation
     }
     // other helper methods
}

static class MacroRunner {

    static MacroRunner() {
        BuildMacroRunnerList();
    }

    static void BuildMacroRunnerList() {
        macroRunners = System.Reflection.Assembly.GetExecutingAssembly()
            .GetTypes()
            .Where(x => x.Namespace.ToUpper().Contains("MACRO"))
            .Select(t => (Action)Delegate.CreateDelegate(
                typeof(Action), 
                null, 
                t.GetMethod("Run", System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.Public)))
            .ToList();
    }

    static List<Action> macroRunners;

    public static void Run() {
        foreach(var run in macroRunners)
            run();
    }
} 
```

这种方式要快得多。

如果您的方法签名与 Action 不同，您可以将 Action 中的 type-casts 和 typeof 替换为任何所需的 Action 和 Func 泛型类型，或者声明您的 Delegate 并使用它。我自己的实现使用 Func 来漂亮地打印对象：

```
static class PrettyPrinter {

    static PrettyPrinter() {
        BuildPrettyPrinterList();
    }

    static void BuildPrettyPrinterList() {
        printers = System.Reflection.Assembly.GetExecutingAssembly()
            .GetTypes()
            .Where(x => x.Name.EndsWith("PrettyPrinter"))
            .Select(t => (Func<object, string>)Delegate.CreateDelegate(
                typeof(Func<object, string>), 
                null, 
                t.GetMethod("Print", System.Reflection.BindingFlags.Static | System.Reflection.BindingFlags.Public)))
            .ToList();
    }

    static List<Func<object, string>> printers;

    public static void Print(object obj) {
        foreach(var printer in printers)
            print(obj);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-02-19T10:42:07.893

将调用方法的类：

```
namespace myNamespace
{
    public class myClass
    {
        public static void voidMethodWithoutParameters()
        {
            // code here
        }
        public static string stringReturnMethodWithParameters(string param1, string param2)
        {
            // code here
            return "output";
        }
    }
} 
```

**使用反射**调用 myClass 静态方法：

```
var myClassType = Assembly.GetExecutingAssembly().GetType(GetType().Namespace + ".myClass");

// calling my void Method that has no parameters.
myClassType.GetMethod("voidMethodWithoutParameters", BindingFlags.Public | BindingFlags.Static).Invoke(null, null);

// calling my string returning Method & passing to it two string parameters.
Object methodOutput = myClassType.GetMethod("stringReturnMethodWithParameters", BindingFlags.Public | BindingFlags.Static).Invoke(null, new object[] { "value1", "value1" });
Console.WriteLine(methodOutput.ToString()); 
```

注意：我不需要实例化 myClass 的对象来使用它的方法，因为我使用的方法是`static`.

很棒的资源：

*   [C# 反射的工作原理](https://stackify.com/what-is-c-reflection/)
*   [MethodBase.Invoke 方法](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.methodbase.invoke?redirectedfrom=MSDN&view=net-5.0#System_Reflection_MethodBase_Invoke_System_Object_System_Object___)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-11T03:45:35.083

我更喜欢简单...

```
private void _InvokeNamespaceClassesStaticMethod(string namespaceName, string methodName, params object[] parameters) {
    foreach(var _a in AppDomain.CurrentDomain.GetAssemblies()) {
        foreach(var _t in _a.GetTypes()) {
            try {
                if((_t.Namespace == namespaceName) && _t.IsClass) _t.GetMethod(methodName, (BindingFlags.Static | BindingFlags.Public))?.Invoke(null, parameters);
            } catch { }
        }
    }
} 
```

用法...

```
 _InvokeNamespaceClassesStaticMethod("mySolution.Macros", "Run"); 
```

但如果您正在寻找更强大的东西，包括处理异常......

```
private InvokeNamespaceClassStaticMethodResult[] _InvokeNamespaceClassStaticMethod(string namespaceName, string methodName, bool throwExceptions, params object[] parameters) {
    var results = new List<InvokeNamespaceClassStaticMethodResult>();
    foreach(var _a in AppDomain.CurrentDomain.GetAssemblies()) {
        foreach(var _t in _a.GetTypes()) {
            if((_t.Namespace == namespaceName) && _t.IsClass) {
                var method_t = _t.GetMethod(methodName, parameters.Select(_ => _.GetType()).ToArray());
                if((method_t != null) && method_t.IsPublic && method_t.IsStatic) {
                    var details_t = new InvokeNamespaceClassStaticMethodResult();
                    details_t.Namespace = _t.Namespace;
                    details_t.Class = _t.Name;
                    details_t.Method = method_t.Name;
                    try {
                        if(method_t.ReturnType == typeof(void)) {
                            method_t.Invoke(null, parameters);
                            details_t.Void = true;
                        } else {
                            details_t.Return = method_t.Invoke(null, parameters);
                        }
                    } catch(Exception ex) {
                        if(throwExceptions) {
                            throw;
                        } else {
                            details_t.Exception = ex;
                        }
                    }
                    results.Add(details_t);
                }
            }
        }
    }
    return results.ToArray();
}

private class InvokeNamespaceClassStaticMethodResult {
    public string Namespace;
    public string Class;
    public string Method;
    public object Return;
    public bool Void;
    public Exception Exception;
} 
```

用法几乎一样...

```
_InvokeNamespaceClassesStaticMethod("mySolution.Macros", "Run", false); 
```

# api - 使用 Zend 创建安全 REST API 的最佳方法是什么？

> ID：11908163
> 
> 赞同：1
> 
> 时间：2012-08-10T19:38:05.570
> 
> 标签：api, zend-framework, rest

我一直在寻找很多关于 REST API 和安全性的问题，并发现了一些有趣的信息，但仍有一件事我不明白。

因此，我有一个使用 Zend Framework 开发的 REST API，通过 https 通道进行基本身份验证（因此，如果我了解我所阅读的内容，登录/密码在发送时会被加密）。此 API 的目的是由 Android/iPhone 应用程序调用，并且仅对拥有登录名和密码的人可用

所以，目前，为了调用 API，登录名和密码总是随调用一起发送，所以，我在每次调用时检查它们（结果是它调用数据库只是为了在每次调用 API 时进行身份验证）。

是否有某种会话管理（如在 Web 开发中）来避免这种情况？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T19:45:35.753

REST API 应该是无状态的，但是您可以使用在首次提交用户名 + 密码后获得的一些密钥来使用请求签名。

换句话说，不要每次都发送用户名和密码，只需使用一次，即可获取密钥。

您可以查看几个签署请求的 API，例如。一些实现 OAuth。

# c - 如何在 C 中创建一个 char 指针数组？

> ID：11908164
> 
> 赞同：0
> 
> 时间：2012-08-10T19:38:09.263
> 
> 标签：c

我必须使用最佳和优化的方法在 C 中创建一个大小为 10000000 的 char 指针数组。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T19:48:03.110

我认为这会做（虽然没有检查空值）：

```
int i;
int num_arrays;
char **huge_char_array;
num_arrays = 10; //number of arrays you want.
huge_char_array = (char **)malloc(sizeof(char *) * num_arrays);
for(i = 0; i < num_arrays; i++)
{
    huge_char_array[i] = (char *)malloc(sizeof(char) * 10000000);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T19:53:41.503

我相信这是最佳方式，因为只有一个动态分配，减少了堆碎片带来的开销和分配时间。您可以使用 STRING_INDEX 实用函数来访问第 n 个字符串。

此外，使用 calloc() 而不是 malloc() 将缓冲区清零以确保所有字符串都是 NUL 终止的。

```
#define STRING_SIZE 10000000
#define NUM_STRINGS 10

#define STRING_INDEX(array, string_idx) ((array) + (string_idx) * STRING_SIZE)

int main(int argc, char **argv) {
    char *array_of_strings = calloc(NUM_STRINGS, STRING_SIZE);

    // Access 8th character of 7th string
    char c = STRING_INDEX(array_of_strings, 7)[8];

    // Use array

    // Free array when done
    free(array_of_strings);

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T19:46:36.093

```
char *arr[SOME_SIZE];
for(int i = 0; i < SOME_SIZE; ++i) {
    arr[i] = malloc(10000000);
    if(!arr[i])
        // allocation failed, do something
} 
```

只需意识到您为*数组中的每个元素*分配了 ~9.5MB （即`SOME_SIZE * 10000000`总字节数）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T19:49:52.800

我处理的每个请求都分配了 50K，这导致了内存碎片。所以我切换到分配 50k * 100 = 5MB 并在需要再分配一个时重用池。如果请求增加到超出我的池容量，我将池大小加倍以避免内存碎片。基于此，我建议在您的情况下分配大量内存 10 * 10000000 以重用它。很抱歉，我不能在这里分享处理池的代码。还要使用 malloc 和 free，不要使用 new 和 delete。

malloc 不会通过异常，如果没有可用内存，它只会返回 null 。

如果您坚持对每个元素单独使用 malloc，您可以创建一个具有最大大小的堆以避免碎片，在这种情况下，您将必须定义堆大小。

请参考 MSDN 以获取有关如何创建和使用堆或 Windows 用户可用的其他分配方法的更多详细信息。 [http://msdn.microsoft.com/en-us/library/windows/desktop/aa366533(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366533(v=vs.85).aspx)

# javascript - javascript生成一个可变长度的数字

> ID：11908165
> 
> 赞同：-1
> 
> 时间：2012-08-10T19:38:12.503
> 
> 标签：javascript, variables, random, numbers

> **可能重复：**
> [在特定范围内的 Javascript 中生成随机数？](https://stackoverflow.com/questions/1527803/generating-random-numbers-in-javascript-in-a-specific-range)

如果我输入长度为 4，我需要返回 0 9999 之间的数字。

我希望它是 0 填充（0004），但这可能是另一个功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:43:50.200

```
for(var x = 5, i = 0, y = ""; i < x​;​ ++i, y +​​= "9");
Math.floor(Math.random()*parseInt(y)); //random number 
```

​ 在 for 循环中，x 将是您的输入长度。如果需要，您也可以将 x 的定义移到循环之外。

你也可以试试这个，看看哪个跑得更快（可能是第一个，fyi）：

```
for(var x = 5, y = "", i = 0; i < x; ++i, y += Math.floor(Math.random()*9));
parseInt(y); //random number 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T19:55:02.610

```
function getRandom(c){
    var r = (Math.random() * Math.pow(10, c)).toFixed(0);
    while(r.length != c)
        r = "0" + r; 
    return r;
}

getRandom(3); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T19:48:54.117

好吧，这里是数字部分。您可能可以弄清楚填充部分。

```
function makeNumber(number){
    var nines = "";
    var returnNumber = "";
    for(var i = 0; i < number; i++)
    {
         nines+= "9";  
    }
    for(var i = 0; i < number; i++)
    {
        var returnNumber += String(Math.Random() * parseInt(nines));
    }
    return returnNumber;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T20:02:37.580

有点草率但有效：

```
var length = 4; //<-- or get however you want
var big = "";
for (i=0; i<length; i++) {
    big = big + "9";
}
var big = parseInt(big);
var random = Math.floor(Math.random() * big).toString();
var random_len = random.toString().length;
if (random_len < length) {
    var random_padded = random.toString()
    padding = length - random_len;
    for (i=0; i<padding; i++) {
        random_padded = "0" + random_padded;
    }
    random = random_padded
}
alert(random); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-10T19:43:14.003

由于它是 javascript，因此您可能希望在这种情况下利用其弱类型。一种特殊的黑客方式是生成 0-9 之间的 n 个数字并使用字符串连接。

这篇文章似乎有答案：[JavaScript 表达式在每种情况下生成一个 5 位数字](https://stackoverflow.com/questions/2175512/javascript-expression-to-generate-a-5-digit-number-in-every-case) ，您可以使用连接填充。

编辑：所以这是我的实现：

```
function random(x){
  var rand = Math.floor(Math.random() * Math.pow(10,x));
  var dummy = rand;
  while (dummy<Math.pow(10,x-1)){
    rand = "0" + rand;
    dummy = dummy*10;
  }
  return rand;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-10T19:46:52.430

尝试这个：

```
function getNumber(range){
var max = Math.pow(10,range);

var num = Math.Random() * max;
} 
```

至于`zerofill`你最好尝试内森在他的评论中提出的[建议](https://stackoverflow.com/questions/1267283/how-can-i-create-a-zerofilled-value-using-javascript)

# cocoa-touch - 是否可以在 iPhone 上自定义“X 想使用您当前的位置”？

> ID：11908171
> 
> 赞同：4
> 
> 时间：2012-08-10T19:38:21.647
> 
> 标签：cocoa-touch

是否可以在 iPhone 上设置位置警报框的样式：“（应用程序名称）想使用您当前的位置”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T19:44:24.740

不，它是旨在保护隐私的操作系统级功能。

如果可以定制，有人会把它改成“你喜欢小猫吗？” 并且能够访问喜欢小猫的人的位置信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-10T19:46:17.703

您只能通过设置的[purpose](https://developer.apple.com/library/ios/documentation/CoreLocation/Reference/CLLocationManager_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instp/CLLocationManager/purpose)属性告诉用户使用其位置的原因`CLLocationManager`。

**编辑：** 该`purpose`属性在 iOS 6 中已弃用。但有一个替代品。对于 iOS 6 及更高版本，您应该`NSLocationUsageDescription`在 Info.plist 文件中添加密钥。如果您的应用程序面向低于 6.0 的 iOS 版本，您可能需要同时执行这两项操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T19:49:25.410

不，这是一项系统功能，但您可以提供一个描述文本来说明您为什么要使用用户位置，此文本将添加到对话框中。您需要为此使用的属性被调用`purpose`，并且是`CLLocationManager`类的属性。

请查看此文档：http: [//developer.apple.com/library/ios/ipad/#documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html#//apple_ref/doc/uid/TP40007125](http://developer.apple.com/library/ios/ipad/#documentation/CoreLocation/Reference/CLLocationManager_Class/CLLocationManager/CLLocationManager.html#//apple_ref/doc/uid/TP40007125)

# objective-c - Objective-C中的可变大小数组？

> ID：11908174
> 
> 赞同：4
> 
> 时间：2012-08-10T19:38:30.983
> 
> 标签：objective-c, arrays, variable-length-array

好的，显然这有效：

```
void foo(size_t s) {
    int myArray[s];
    // ... use myArray...
} 
```

这真的合法吗？我的意思是，它必须是，因为它可以编译（C 编译器会拒绝它为非常量）。我的问题的第一部分是：这是如何工作的？我假设它在堆栈上分配它？这与使用不同`alloca()`吗？

实际上，我发现了一些执行此操作的代码：

```
void bar(size_t chunkSize) {
    CFReadStreamRef foo = NULL;
    // ...some stuff to init foo...

    while (stuffToDo) {
        UInt8 buffer[chunkSize];
        // ...read some data from stream into buffer
        //    using CFReadStreamRead()...
    }
} 
```

这行得通。但是，当我将缓冲区分配从循环内部移动到函数的第一行（就在`foo`声明之前）时，函数...停止工作。在调试器中，它首先访问局部变量，然后...退出。我没有看到任何异常被抛出，它没有崩溃，它只是程序继续运行（实际上函数返回一个字符串，返回值是`NULL`，这是返回变量被初始化的值）。我不确定发生了什么事。我的问题的第二部分是，鉴于第一部分，到底发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T19:40:30.897

它在 C99 中是合法的，虽然很危险，而且是的 - 就像`alloca`.

因为它就像 alloca，所以在堆栈上分配时需要合理大小的数组。如果长度为零，我不确定这是否被定义，但如果数组“足够大”这样做，你肯定会导致堆栈溢出。

至于发生了什么——如果尺寸合理，将其拉出循环应该没有什么区别。我怀疑您看到未定义的行为是因为参数值太大（或者可能为 0）——您应该验证`chunkSize`参数。程序集会告诉您为什么将其从循环中拉出来会有所不同（假设程序中的其他所有内容都格式正确）。

# image - CSS背景图像不显示

> ID：11908176
> 
> 赞同：0
> 
> 时间：2012-08-10T19:38:37.153
> 
> 标签：image, google-chrome, background

我在主页上有以下代码：

```
<ul id="slides1">
<li>
<!-- About-->
<a href="index.html"><div class="logo"></div></a>
<div class="sub1"> </div>
<a href="#" style="display:block;"> <img src="images/nadpisi/about.png" class="nadpis1"></a>
<img id="i1" src="images/MiddleBg/first.jpg"/>
</li>
</ul> 
```

在这里，我在 class=logo 中有徽标，并且 div class sub1 在 css 文件中有背景图片：

```
.sub1{
  background-image: url(../images/sub1/about.png);
  width: 600px;
  height: 100px;
  position: absolute;
  z-index: 7;
  top: 270px;
  margin-left: 490px;
  background-repeat: no-repeat; 
  }
  .logo {
    background-image: url(../images/LOGO.png);
     width: 229px;
     height: 129px;
     background-repeat: no-repeat;
     position: absolute;
     z-index: 10;
     top: 80px;
     margin-left: 490px;
     } 
```

当我用 Chrome 打开页面时，这些徽标和 sub1 背景图像都不会显示，但会显示它们之后的图像，但是当我转到浏览器的地址栏并按 Enter 时，它们会显示。什么问题，谁能帮忙？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T19:42:27.207

可能找不到您的图像。最有可能是您的路径有问题。检查图像是否在开发者控制台中加载。

# android - 如何在 Eclipse、API 16 (fontFamily) 中使用原生 Android OS 4.1 Roboto 字体

> ID：11908180
> 
> 赞同：3
> 
> 时间：2012-08-10T19:38:51.140
> 
> 标签：android, eclipse, fonts, android-4.2-jelly-bean, font-family

随着 4.1 jellybean，Robot 开始出现在整个系统 UI 中。我想在 Eclipse 中使用新属性“fontFamily”，如本页 “**字体家族”部分所述：http:** [//developer.android.com/about/versions/android-4.1.html#UI](http://developer.android.com/about/versions/android-4.1.html#UI)

目标是在所有支持它的设备上使用 Roboto（不包括在 /assets 中），并让字体在所有非 4.0+ 设备上优雅地降级为 Droid sans。同样，不想包含在我的 .apk 中，明白这很容易做到。

希望看到有关通过 API 16 成功使用 fontFamily 的示例代码或反馈。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T21:13:55.940

它非常简单，因为旧版本的 Android 将忽略他们不理解的 xml 属性，您可以将其设置在您的文本视图或应用程序的样式中。或者您可以在代码中手动设置它，但那是更多的工作：p

如果你使用的是普通版的 Roboto，你不需要做任何特别的事情，它是 4.0+ 中的默认设置（你可能需要一个基于全息的主题，我不记得了），并且可以使用 Roboto 粗体和斜体使用 TextView 的 TextStyle 属性。

在xml中

```
<TextView
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:fontFamily="sans-serif-light"
      /> 
```

或者在代码中

```
if(Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN){
    textView.setTypeface(Typeface.create("sans-serif-light", Typeface.NORMAL));         
} 
```

# c++ - 为什么委托或闭包通常被称为真正的“面向对象的函数指针”？

> ID：11908184
> 
> 赞同：3
> 
> 时间：2012-08-10T19:39:05.830
> 
> 标签：c++, oop, delegates, closures, function-pointers

例如，考虑 C#

> > 与 C 或 C++ 中的函数指针不同，委托是面向对象的、类型安全的和安全的。
> 
> 来源：http: [//msdn.microsoft.com/en-us/library/aa288459%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/aa288459%28v=vs.71%29.aspx)

现在只讨论 C++，真正的区别是什么，OO 前景中缺少什么？

也来自另一个来源

> > 大多数 C++ 程序员从未使用过成员函数指针，这是有充分理由的。它们有自己奇怪的语法（例如 ->* 和 .* 运算符），很难找到关于它们的准确信息，而且你可以用它们做的大部分事情都可以通过其他方式做得更好。这有点可耻：编译器编写者实现适当的委托实际上比实现成员函数指针更容易！
> 
> 来源： http: [//www.codeproject.com/Articles/7150/Member-Function-Pointers-and-the-Fastest-Possible](http://www.codeproject.com/Articles/7150/Member-Function-Pointers-and-the-Fastest-Possible)

我发现很多 C++ 程序都使用这种`->*`语法，我不觉得这很奇怪或奇怪；关于代表的这种潜力和对指针的攻击，我不明白这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:15:36.867

成员指针和真正的闭包之间的区别在于闭包包含函数*和*关联的状态。两者密不可分。

成员指针*只是*函数。为了调用成员指针，您必须*提供*状态。

这是函数指针和函子之间的区别。函数对象保存要调用的函数（作为 的重载`operator()`），但它也*可以*有成员。这些成员可以是私有的，从而提供封装。函数对象是 C++ 规则的对象，因此它具有明确的生命周期。它是根据 C++ 规则构造和销毁的。

函数指针没有生命周期；它始终存在（除非它为 NULL）。它没有要封装的状态。

因此，它不是一个闭包，因为它不能*关闭*任何东西。

That's why C++11 lambdas are implemented as explicit objects. That way, they can close over things. They have encapsulated state.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T20:11:59.457

我认为人们很难编写它们，但它们的行为就像普通指针一样，如果它们为 NULL 则执行它们是错误的。如果它们被正确编写和使用，那么它们就没有错。我从来没有真正遇到过问题，也许除了忘记正确的语法。

在 c++11 中，您可以使用 std::function<> 类，它是函数指针的包装器。您可以将它用于函数、成员函数、函数对象和 lambda。

例如：

```
void foo(int x);
std::function<void(int)> f=foo;
f(1); 
```

或更简单（在 VS2010 中工作）：

```
void foo(int x);
std::function<decltype(foo)> f=foo;
f(1); 
```

参考：[http ://en.cppreference.com/w/cpp/utility/functional/function](http://en.cppreference.com/w/cpp/utility/functional/function)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T19:46:59.917

成员函数指针不是成员函数。C/C++ 中的函数指针是危险的，因为它们可能指向已释放的内存或随时设置为 NULL。通常会避免使用它们，但并不总是使用诸如 boost::bind 或交换打印功能之类的东西。

因此，一般来说，它们并不比标准指针更危险。但是，您通常可以通过在其他地方调用对象的成员方法或静态函数来避免使用函数指针。它编译为在内部使用函数指针，但是当它被调用时，您可以更好地保证该函数的存在。

# c# - 无法从数据绑定的 Winforms DateTimePicker 中跳出

> ID：11908185
> 
> 赞同：-2
> 
> 时间：2012-08-10T19:39:07.410
> 
> 标签：c#, winforms, datetimepicker

使用多个数据绑定控件构建表单，并注意到不能离开表单上的 Datetimepicker 或组合框。

```
 // signoutAfterDateTimePicker
        // 
        this.signoutAfterDateTimePicker.DataBindings.Add(new System.Windows.Forms.Binding("Value", this.clientBindingSource, "SignoutAfter", true));
        this.signoutAfterDateTimePicker.Format = System.Windows.Forms.DateTimePickerFormat.Time;
        this.signoutAfterDateTimePicker.Name = "signoutAfterDateTimePicker"; 
```

由于我在 Datetime 选择器上找不到任何内容，但发现了与 [Cannot tab out of databound Winforms dropdown list](https://stackoverflow.com/questions/290629/cannot-tab-out-of-databound-winforms-dropdown-list)类似的问题。所以发布了这个链接，讨论如何修复下拉列表。认为那些有 DateTimePicker 问题的人也会发现该链接很有用。

解决方法是将 CausesValidation 设置为 false。

```
this.signoutAfterDateTimePicker.CausesValidation = false; 
```

当然，您可能想要实际验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:39:07.410

答案是将 CausesValidation 设置为 False - 就像上面的链接所暗示的那样。

# vim - 返回到 vim 中的 } - 相当于 [} 或 ]{

> ID：11908188
> 
> 赞同：4
> 
> 时间：2012-08-10T19:39:16.320
> 
> 标签：vim

在 vim 中，我可以点击`[{`返回到第一个无与伦比的位置`{`或`]}`继续前进。有什么东西（短）可以`[}`让我回到上一个`}`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T23:35:45.587

我不相信有一个内置的命令可以做你想做的事。我认为添加一个简单的映射是最简单的

```
map <Leader>} ?}<Cr> 
```

让你点击leader}（leader是\，如果你没有重新映射它）并回到最近的}。

# java - 卡片布局不起作用

> ID：11908194
> 
> 赞同：3
> 
> 时间：2012-08-10T19:39:46.770
> 
> 标签：java, swing, awt, layout-manager, cardlayout

我正在开发一个用户登录的小游戏。登录后，您将能够进入主菜单。我正在使用不工作的 CardLayout。有一些包含面板名称的最终字符串。我已经调试了一段时间，我确定可以到达这段代码。欢迎任何提示。谢谢！

```
/*
 * showPanel()
 * Method to switch to a different panel
 * @author Rick Slinkman
 */
public void showPanel(String newPanel) 
{
    game.setCurrentPanel(newPanel);
    cardLayout.show(mainpanel, newPanel);
    revalidate();
    repaint();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:29:54.920

唯一出错的是我没有重新验证持有卡片的 JPanel。这就是解决方案！感谢大家努力帮助我。

```
/*
 * showPanel()
 * Method to switch to a different panel
 * @author Rick Slinkman
 */
public void showPanel(String newPanel) 
{
        game.setCurrentPanel(newPanel);
    this.cardLayout = (CardLayout) cards.getLayout();
    cardLayout.show(cards, "" + newPanel);
    cards.revalidate();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:12:49.723

如果您调用此方法，您的代码在任何地方都不需要 repaint() Swing 将在看到布局更改时重新绘制布局，删除方法调用 repaint。

# java - 使用 url 在 Blobstore 中插入 Blob

> ID：11908199
> 
> 赞同：0
> 
> 时间：2012-08-10T19:40:07.980
> 
> 标签：java, google-app-engine, blobstore

嗨，我是谷歌应用引擎的新手。我通过本[教程](https://developers.google.com/appengine/docs/java/blobstore/overview)

我成功地运行了这些示例项目。在此我必须上传一个文件，然后它返回相同的文件。但是我使用这个 url 给出了一个 url，我必须将一个文件上传到 blobstore。然后再次下载它。任何人都可以帮助如何通过网址上传文件。这是 index.jsp 文件的代码

```
<%@ page import="com.google.appengine.api.blobstore.BlobstoreServiceFactory" %>
<%@ page import="com.google.appengine.api.blobstore.BlobstoreService" %>

<%
    BlobstoreService blobstoreService = BlobstoreServiceFactory.getBlobstoreService();
%>

<html>
    <head>
        <title>Upload Test</title>
    </head>
    <body>
        <form action="<%= blobstoreService.createUploadUrl("/upload") %>" method="post" enctype="multipart/form-data">
            <input type="text" name="foo">
            <input type="file" name="myFile">
            <input type="submit" value="Submit">
        </form>
    </body>
</html> 
```

这是serve.java代码

```
package org.ritesh;
import java.io.IOException;

import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.google.appengine.api.blobstore.BlobKey;
import com.google.appengine.api.blobstore.BlobstoreService;
import com.google.appengine.api.blobstore.BlobstoreServiceFactory;

public class Serve extends HttpServlet {
    private BlobstoreService blobstoreService = BlobstoreServiceFactory.getBlobstoreService();

public void doGet(HttpServletRequest req, HttpServletResponse res)
    throws IOException {
        BlobKey blobKey = new BlobKey(req.getParameter("blob-key"));
        blobstoreService.serve(blobKey, res);
    }
} 
```

UploadServlet 代码在这里

```
package org.ritesh;

import java.io.IOException;
import java.util.Map;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.google.appengine.api.blobstore.BlobKey;
import com.google.appengine.api.blobstore.BlobstoreService;
import com.google.appengine.api.blobstore.BlobstoreServiceFactory;

public class UploadServlet extends HttpServlet {

    private BlobstoreService blobstoreService = BlobstoreServiceFactory.getBlobstoreService();

    public void doPost(HttpServletRequest req, HttpServletResponse res)
        throws ServletException, IOException {

        Map<String, BlobKey> blobs = blobstoreService.getUploadedBlobs(req);
        BlobKey blobKey = blobs.get("myFile");

        if (blobKey == null) {
            res.sendRedirect("/");
        } else {
            res.sendRedirect("/serve?blob-key=" + blobKey.getKeyString());
        }
    }
} 
```

它运行良好，请建议任何修改，以便通过 url 上传文件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T00:51:17.820

如果您希望用户将文件发布到您自己的 URL，那么您需要使用[Files API](https://developers.google.com/appengine/docs/java/blobstore/overview#Writing_Files_to_the_Blobstore)来写入 blobstore。

但是，如果可以的话，使用您已经在处理上传的方法可能会更好。它允许上传更大的文件，并且很可能更有效，因为上传是由 Google 基础架构而不是您的应用程序实例处理的。

# vim - 当它们已经垂直打开时在vim中水平打开不同的文件（不关闭文档）

> ID：11908215
> 
> 赞同：2
> 
> 时间：2012-08-10T19:41:00.117
> 
> 标签：vim

> **可能重复：**
> [在 Vim 中快速从垂直拆分切换到水平拆分](https://stackoverflow.com/questions/1269603/to-switch-from-vertical-split-to-horizontal-split-fast-in-vim)

我的版本控制系统在 vim 中垂直打开了三个文件。有没有办法在不关闭文档的情况下将拆分更改为水平？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T19:48:30.200

这应该可以解决您的问题。

```
Ctrl-W t Ctrl-W K 
Ctrl-W w Ctrl-W K 
```

# android - 与安卓 RIL 通信

> ID：11908220
> 
> 赞同：4
> 
> 时间：2012-08-10T19:41:19.273
> 
> 标签：android, ril

我正在寻求访问以获取无法通过 api 获得的 android 设备上的低级网络信息。有没有办法与 RIL 交谈以获取更多信息？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-07T19:15:04.057

是的。我实际上是在搞同样的事情。我的硬件使用 GSM 无线电，一切都围绕着 android 内部 API。（使用“[android] internal API”进行stackoverflow搜索，您将获得大量有关如何访问它的信息）。就我而言，我对 GSM 上的数据链路感兴趣。因此，它位于 frameworks/base/telephony/java/com/android/internal/telephony/DataConnectionTracker.java 中的 android 源代码中。如果您对 SMS、SIM 卡、语音通话或标准“公共”API 上不可用的其他功能感兴趣，请查看文件夹 frameworks/base/telephony/java/com/android/internal/telephony 和名称与它的作用非常相关。至于明确的文档，我没有找到。我认为它'

# c# - 匹配 a 但忽略作为 b 子串的 a 的模式

> ID：11908222
> 
> 赞同：1
> 
> 时间：2012-08-10T19:41:31.917
> 
> 标签：c#, regex, pattern-matching

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:49:01.407

为什么不在匹配模式中包含 t1？

```
string pattern = " from t1";
string answer=Regex.Relace(q , pattern , ",field3 from t1"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T19:51:07.387

您正在尝试限制替换的数量，听起来，所以看起来这个问题已经在这里得到了回答：

[如何正则表达式搜索/替换.NET中字符串中的第一次出现？](https://stackoverflow.com/questions/148518/how-to-regex-search-replace-only-first-occurrance-in-a-string-in-net)

[编辑：] 回复第一条评论：

抱歉，不知道 FROM 是一个示例还是您实际尝试做的事情。试图替换不基于可控字符串的东西是有问题的。如果您不控制所有输入的字符串，您可能还必须处理以下情况：

```
SELECT [From], [To], [Email], [Subject] FROM EmailsSent 
```

最终结果是您的正则表达式将不得不前后查看以检查括号和括号，因为您不能 100% 控制它给出的字符串。我要提醒您，您正在做的事情听起来像是一种不好的做法，只有在没有其他选择的情况下才应该这样做。看一下前瞻/后向信息，您应该可以在 google 上搜索更多信息：

[http://openmymind.net/2011/2/16/Regex-Positive-Negative-Look-Ahead-Behind/](http://openmymind.net/2011/2/16/Regex-Positive-Negative-Look-Ahead-Behind/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T03:30:37.423

```
string q = "select field1,field2 from t1 where field1 in (select field1 from t2 where t2.field2>5)";

Regex r=new Regex(@"from.*$");
string s=r.Replace(q,",field3 $0");//output 
```

# windows-phone-7 - 跨平台 javascript MP3 播放器无法在 Windows 手机上运行

> ID：11908223
> 
> 赞同：1
> 
> 时间：2012-08-10T19:41:34.657
> 
> 标签：windows-phone-7, mp3, windows-phone

我正在使用这个媒体播放器，以便我可以在网站上播放 mp3 音频文件，它们可以在所有浏览器和智能手机上运行 - [http://mediaelementjs.com/](http://mediaelementjs.com/)

但是我刚刚被告知它不适用于 Windows Phone。windows phone 和它内置的浏览器有什么关系？如果这个插件甚至支持 IE6，但它不能与 Windows Phone 一起使用，那就太糟糕了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-08T09:44:21.500

这**确实**支持 Windows Phone。只需在其网站上向下滚动，您就会看到支持图表。

这个插件使用 Flash 来填充 HTML5 视频标签。所以它支持 IE6 但不支持不支持 HTML5 和 Flash 的浏览器。这意味着它可以支持 WP7.5（IE9 手机）但不支持 WP7.0（IE7 手机）。

# php - MediaElement.js - 多个播放器，一个播放器已经开始播放一个播放器后无法播放视频

> ID：11908226
> 
> 赞同：0
> 
> 时间：2012-08-10T19:41:54.350
> 
> 标签：php, mediaelement.js

我正在尝试找出 MediaElement.js 播放器的一个棘手问题。我在页面的多个位置使用播放器，所有这些位置都是视频文件。这些视频文件都指向同一个 url，这是一个文件下载脚本，用于流式传输给定 id 的文件。每个文件都有一个唯一的 id，这意味着给 MediaElement 播放器的 url 的类型是“/fileDownload.php?fileId={some file id}”

当我在其中一个视频上按播放时，它可以正常加载并开始流式传输视频。但是，当我暂停视频并尝试播放另一个视频时，它根本不会加载它们，并且会像加载它们一样永远旋转。在页面刷新之前，视频不会播放。

我对 MediaElement 播放器的实现并不十分熟悉。是否有可能发生这种情况，因为 MediaElement.js 无法处理来自相同 URL 但具有不同 GET 参数的文件？

# django - django jquery ajax 登录

> ID：11908229
> 
> 赞同：0
> 
> 时间：2012-08-10T19:41:59.620
> 
> 标签：django, jquery, login

# 视图.py

```
def loginajax(request):
    form = LoginForm(request.POST)
    #redirect_to = request.REQUEST.get(REDIRECT_FIELD_NAME, '')
    if request.POST:
            #errors = manipulator.get_validation_errors(request.POST)
        if form.is_valid():   
            if request.is_ajax: 
                user = authenticate(username = request.POST['username'],password = request.POST['password'])
                if user is not None:
                    redirect_to = '/home/%s/'%user
                else:
                    redirect_to = '/accounts/activate/'
                return HttpResponse(redirect_to)
            else:
                return HttpResponse("False")
        else:
           return HttpResponse(form.errors) 
```

# 脚本.js

```
$('#loginform').submit(function(e){
    $.ajax({
        type:"POST",
        url:"/accounts/login/ajax/",
        data:$('#loginform').serialize(),
        success: function(msg){
            window.location = msg;
        }
    });
    e.preventDefault();             
}); 
```

# 怀疑

我无法理解它何时返回重定向字符串，它说用户未通过身份验证并将我重定向到注册页面，请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:15:53.127

你忘了（从 django.contrib.auth 导入验证，登录）

```
login( request, user ) 
```

前

```
redirect_to = '/home/%s/'%user 
```

authenticate(...) 只是测试用户名和密码是否正确。

# c# - 删除指定用户创建的所有文件

> ID：11908230
> 
> 赞同：5
> 
> 时间：2012-08-10T19:42:01.740
> 
> 标签：c#, ntfs, quota

我有启用配额的驱动器，我想从该驱动器中删除由指定用户（实际上是一组使用特殊帐户运行的应用程序）创建的所有文件。如何在不递归检查 HDD 上的所有文件和文件夹的情况下执行此操作是否由指定用户创建？我只需要获得“迭代器”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:37:51.510

看看下面的例子

```
 [Test]
    public void Test()
    {
        string user = @"Domain\UserName";
        var files = Directory.EnumerateFiles(@"C:\TestFolder")
            .Where(x => IsOwner(x, user));
        Parallel.ForEach(files, File.Delete);
    }

    private static bool IsOwner(string filePath, string user)
    {
        return string.Equals(File.GetAccessControl(filePath).GetOwner(typeof (NTAccount)).Value, user,
                             StringComparison.OrdinalIgnoreCase);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T12:48:41.970

实际上，您可以使用 USN Change Journal迭代且*非常有效地执行此操作，请参阅*[http://msdn.microsoft.com/en-us/library/windows/desktop/aa363798.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363798.aspx)。通过正确使用过滤，您可以获得特定用户在特定时间段内创建的文件列表。

另一方面，这种技术相当复杂，适用于时间要求严格的应用；如果效率不是您的应用程序的重点，我会选择更简单的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T19:54:02.173

在提高性能方面，我认为您可以在使用递归算法搜索文件和文件夹时使用任务并行库。

另一种方式，你可以做到这一点[Lucence](http://lucene.apache.org/core/)是一个有用的搜索框架，它已经发布了 .NET 版本

# iphone - Xcode 项目中无法识别 SInt8

> ID：11908231
> 
> 赞同：0
> 
> 时间：2012-08-10T19:42:10.327
> 
> 标签：iphone, xcode, types

我有一个项目，我正在使用来自 aurioTouch 示例项目的一些代码。出于某种原因，任何具有 SInt8 类型的行都会不断给我一个“解析问题：未知类型 SInt8”错误。我不知道是什么原因造成的，因为这应该内置在 iPhone SDK 中。

有什么我可能忽略的可能导致这个问题的东西吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:37:28.780

SInt8 是 CoreFoundation 的一部分。你必须

```
#include <CoreFoundation/CoreFoundation.h> 
```

访问它，以及 UInt8、SInt16、UInt16 等。

# android - Android：确保EditText下的视图不被键盘隐藏

> ID：11908243
> 
> 赞同：3
> 
> 时间：2012-08-10T19:43:28.780
> 
> 标签：android, android-edittext, android-softkeyboard, textview

一个简单的问题：无论我使用adjustPan还是adjustResize，我在编辑文本下方都有一个实时“剩余文本”视图。我想确保显示 TextView （否则，这毫无意义。）有什么想法吗？

# google-chrome - 调试“元素不可点击”错误

> ID：11908249
> 
> 赞同：442
> 
> 时间：2012-08-10T19:44:09.200
> 
> 标签：google-chrome, selenium, selenium-webdriver, automated-tests

我只在 Chrome 中看到这个。

完整的错误消息如下：

> “org.openqa.selenium.WebDriverException：元素在点 (411, 675) 不可点击。其他元素将收到点击：...”

“将收到点击”的元素位于相关元素的一侧，而不是在它的顶部，也没有重叠，也没有在页面上移动。

我尝试添加偏移量，但这也不起作用。该项目在显示的窗口上，无需滚动。

* * *

## 回答 #1

> 赞同：362
> 
> 时间：2013-11-04T07:05:40.343

这是由以下3种类型引起的：

**1.该元素是不可见的点击。**

使用**Actions**或**JavascriptExecutor**使其点击。

按操作：

```
WebElement element = driver.findElement(By("element_path"));

Actions actions = new Actions(driver);

actions.moveToElement(element).click().perform(); 
```

通过 JavascriptExecutor：

```
JavascriptExecutor jse = (JavascriptExecutor)driver;

jse.executeScript("scroll(250, 0)"); // if the element is on top.

jse.executeScript("scroll(0, 250)"); // if the element is on bottom. 
```

或者

```
JavascriptExecutor jse = (JavascriptExecutor)driver;

jse.executeScript("arguments[0].scrollIntoView()", Webelement); 
```

然后点击元素。

**2.页面在点击元素之前被刷新。**

为此，让页面等待几秒钟。

**3\. 元素是可点击的，但上面有一个微调器/叠加层**

下面的代码将等到覆盖消失

```
By loadingImage = By.id("loading image ID");

WebDriverWait wait = new WebDriverWait(driver, timeOutInSeconds);

wait.until(ExpectedConditions.invisibilityOfElementLocated(loadingImage)); 
```

然后点击元素。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2014-04-02T10:26:06.177

您也可以使用 JavaScript 单击，然后不需要滚动。

```
IJavaScriptExecutor ex = (IJavaScriptExecutor)Driver;
ex.ExecuteScript("arguments[0].click();", elementToClick); 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2012-10-02T13:34:05.170

chromedriver 中似乎有一个错误（问题是它被标记为无法修复）-> [GitHub Link](http://code.google.com/p/selenium/issues/detail?id=2766)

（也许在[FreedomSponsors](http://www.freedomsponsors.org/)上悬赏？）

评论 #27 建议了一个解决方法。也许它会为你工作-

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2013-02-24T09:30:50.240

我有同样的问题，尝试了所有提供的解决方案，但它们对我不起作用。最终我使用了这个：

```
JavascriptExecutor js = (JavascriptExecutor) driver;
js.executeScript("var evt = document.createEvent('MouseEvents');" + "evt.initMouseEvent('click',true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0,null);" + "arguments[0].dispatchEvent(evt);", findElement(element)); 
```

希望这可以帮助

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2016-08-25T14:54:46.290

哇，这里有很多答案，还有很多好答案。

我希望我能从我的经验中添加一些东西。

伙计们，在我的情况下，偶尔会有一个 cookie 覆盖隐藏该元素。滚动到元素也可以；但以我的拙见（就我而言，不是每个人的灵丹妙药），最简单的解决方案就是全屏显示（我在屏幕窗口的 3/4 上运行我的脚本）！所以我们开始：

```
driver.manage().window().maximize(); 
```

希望有帮助！

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2019-06-09T07:35:03.977

您需要在该元素上使用焦点或滚动。您可能还必须使用显式等待。

```
WebElement firstbutton= driver.findElement(By.xpath("Your Element"));
Actions actions = new Actions(driver);
actions.moveToElement(element);
actions.perform(); 
```

或者

该元素不可点击，因为它上面有一个 Spinner/Overlay：

```
By loadingImage = By.id("loading image ID");
WebDriverWait wait = new WebDriverWait(driver, timeOutInSeconds);
wait.until(ExpectedConditions.invisibilityOfElementLocated(loadingImage)); 
```

或者

```
Point p= element.getLocation();
Actions actions = new Actions(driver);
actions.moveToElement(element).movebyoffset(p.x,p.y).click().perform(); 
```

或者

如果仍然无法使用`JavascriptExecutor`

```
JavascriptExecutor executor = (JavascriptExecutor)driver;
executor.executeScript("arguments[0].click();", firstbutton); 
```

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2013-06-28T14:39:45.847

我在硒驱动的 Chrome 窗口打开太小的情况下看到了这一点。要单击的元素不在视口中，因此它失败了。

这听起来合乎逻辑......真正的用户必须调整窗口大小或滚动，以便可以看到元素并实际上单击它。

在指示 selenium 驱动程序适当地设置窗口大小后，这个问题对我来说就消失了。[此处](http://selenium.googlecode.com/git/docs/api/java/org/openqa/selenium/WebDriver.Window.html)描述了webdriver API 。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2015-02-18T12:24:30.213

使用 xvfb-run 无头运行测试时出现此错误。他们在本地完美地工作。使用 chrome，webdriver / chromedriver / chrome / java 等的版本都相同。

chromedriver 中的“无法修复”错误 - Tony Lâmpada 指出的[GitHub 链接表明这可能与屏幕上可见/不可见有关。](http://code.google.com/p/selenium/issues/detail?id=2766)

xvfb-run 的帮助消息显示如下：

```
-s ARGS   --server-args=ARGS    arguments (other than server number and
                                "-nolisten tcp") to pass to the Xvfb server
                                (default: "-screen 0 640x480x8") 
```

更改 xvfb 的分辨率使错误消失：

```
xvfb-run -s "-screen 0 1280x1024x16" ... 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2013-11-14T13:34:29.360

我也曾为这个问题而苦苦挣扎。代码在 FF 中运行良好，在 Chrome 上失败。我试图做的是单击一个复选框 - 如果它不在视图中，我会滚动查看然后单击。即使在 Chrome 中滚动到视图中，只有复选框的底部几个像素不可见，因此 webdriver 拒绝单击它。

我的解决方法是这样的：

```
WebElement element = _sectorPopup.findElement(...);

((Locatable) element).getCoordinates().inViewPort();
try {
    element.click();
} catch (Exception e) {
    new Actions(getWebDriver()).sendKeys(Keys.PAGE_DOWN).perform();
    element.click();
} 
```

Chrome 也有 sendKeys 的问题，有时需要使用 Actions。显然，您需要知道哪个方向以及您需要走多少，因此您的里程可能会有所不同。但我更喜欢这个而不是 javascript hack，所以我在这里发布它以防其他人会发现它有用。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2013-05-24T10:13:06.407

红宝石/watir-webdriver/chrome

我使用以下技巧，似乎它有效：

```
#scroll to myelement
@browser.execute_script "window.scrollTo(#{myelement.element.wd.location[0]},#{myelement.element.wd.location[1]})"

# click myelement
myelement.when_present.fire_event("click") 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2014-06-20T14:16:56.430

首先，尝试获取最新的 Chrome 驱动程序并检查它是否可以解决问题。

就我而言，它没有解决问题。但是，到目前为止，以下解决方案对我有用。以下是 C# 代码，但您可以在特定语言中遵循相同的逻辑。我们在这里所做的是，

第 1 步：使用 Selenium Actions 对象关注元素，

第2步：然后单击元素

第 3 步：如果出现异常，则通过 Selenium 浏览器驱动程序的“ExecuteScript”方法执行 javascript 脚本，在元素上触发 javascript“Click”事件。

您也可以跳过第 1 步和第 2 步，也可以只尝试第 3 步。第 3 步可以自行运行，但我注意到在一种情况下出现了一些奇怪的行为，其中第 3 步即使成功单击了元素，也会在单击元素后导致代码的其他部分出现意外行为。

```
 try
            {
                //Setup the driver and navigate to the web page...
                var driver = new ChromeDriver("folder path to the Chrome driver");
                driver.Navigate().GoToUrl("UrlToThePage");

                //Find the element...
                var element = driver.FindElement(By.Id("elementHtmlId")); 

                //Step 1
                new Actions(driver).MoveToElement(element).Perform();  

                //Step 2
                element.Click();
            }
            catch (Exception)
            {
                //Step 3
                driver.ExecuteScript("document.getElementById('elementHtmlId').click();");

            } 
```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2016-10-01T13:19:47.183

使用**量角器**时，这对我有帮助：

```
var elm = element(by.css('.your-css-class'));
browser.executeScript("arguments[0].scrollIntoView();", elm.getWebElement());
elm.click(); 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2014-08-18T21:13:21.813

我根据 Tony Lâmpada 的回答中的评论制作了这种方法。它工作得很好。

```
def scroll_to(element)
  page.execute_script("window.scrollTo(#{element.native.location.x}, #{element.native.location.y})")
end 
```

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2017-02-12T07:03:45.470

我在 python 中运行 selenium 脚本时遇到了同样的问题。这是我用来单击元素的内容：

```
from selenium.webdriver.common.action_chains import ActionChains

ActionChains(driver).click(element).perform() 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2021-06-18T12:22:06.393

今天我遇到了同样的问题。如果我说我是如何解决问题的，你不相信我。

`By maximizing the browser size`

是的，这是一个指针问题，意味着浏览器的大小。为此，您只需要手动或通过代码最大化窗口大小。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2012-12-26T07:32:08.583

我遇到了一个类似的问题，我必须一个接一个地检查两个复选框。但是我在上面的错误中得到了相同的结果。因此我在检查复选框的步骤之间添加了等待......它工作得很好。以下是步骤：-

```
 When I visit /administrator/user_profiles
  And I press xpath link "//*[@id='1']"
  Then I should see "Please wait for a moment..."
  When I wait for 5 seconds
  And I press xpath link "//*[@id='2']"
  Then I should see "Please wait for a moment..."
  When I visit /administrator/user_profiles_updates 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2013-02-05T16:37:49.280

显然，这是 Chrome 驱动程序二进制文件中“无法修复”错误的结果。

一个对我有用的解决方案（我们的里程可能会有所不同）可以在这个 Google Group 讨论中找到，评论 #3：

[https://groups.google.com/forum/?fromgroups=#!topic/selenium-developer-activity/DsZ5wFN52tc](https://groups.google.com/forum/?fromgroups=#!topic/selenium-developer-activity/DsZ5wFN52tc)

相关部分就在这里：

> 从那以后，我通过直接导航到跨度的父锚点的 href 解决了这个问题。
> 
> driver.Navigate().GoToUrl(driver.FindElement(By.Id(embeddedSpanIdToClick)).FindElement(By.XPath("..")).GetAttribute("href"));

在我的例子中，我使用的是 Python，所以一旦我得到了想要的元素，我就简单地使用了

```
driver.get(ViewElm.get_attribute('href')) 
```

但是，我希望这仅适用于您尝试单击的元素是链接...

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2014-04-24T16:14:51.830

Re Tony Lâmpada 的回答，评论 #27 确实为我解决了这个问题，除了它提供了 Java 代码并且我需要 Python。这是一个 Python 函数，它滚动到元素的位置，然后单击它。

```
def scroll_to_and_click(xpath):
    element = TestUtil.driver.find_element_by_xpath(xpath)
    TestUtil.driver.execute_script('window.scrollTo(0, ' + str(element.location['y']) + ');')
    element.click() 
```

这解决了我在 Chrome 34.0 中的问题。它对 Firefox 28.0 和 IE 11 没有任何危害；这些浏览器不会出现问题，但是在单击之前滚动到元素的位置仍然不是一件坏事。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2016-12-27T14:57:20.777

**错误信息的解释**：

错误消息只是说，您要单击的元素存在，但它不可见。它可能被某些东西覆盖或暂时不可见。

元素在测试时不可见的原因可能有很多。请重新分析您的页面并为您的案例找到合适的解决方案。

**特殊情况的解决方案**：

就我而言，当我刚刚单击的屏幕元素的工具提示弹出我要单击的下一个元素时，就会发生此错误。**散焦**是我需要的解决方案。

*   **如何散焦的快速解决方案**是单击屏幕另一部分中的其他元素，这些元素分别“无”。单击操作后没有任何反应。
*   **正确的解决方案**是调用`element.blur()`弹出工具提示的元素，这会使工具提示消失。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2018-06-28T09:58:08.773

此错误的原因是您尝试单击的元素不在浏览器的视口（用户看到的区域）中。所以克服这个问题的方法是首先滚动到所需的元素，然后执行点击。

Javascript：

```
async scrollTo (webElement) {
    await this.driver.executeScript('arguments[0].scrollIntoView(true)', webElement)
    await this.driver.executeScript('window.scrollBy(0,-150)')
} 
```

爪哇：

```
public void scrollTo (WebElement e) {
    JavascriptExecutor js = (JavascriptExecutor) driver; 
    js.executeAsyncScript('arguments[0].scrollIntoView(true)', e)
    js.executeAsyncScript('window.scrollBy(0,-150)')
} 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2016-04-29T15:21:56.693

如果在驱动程序尝试单击它时元素改变了位置，则可能会发生这种情况（我在 IE 中也看到过这种情况）。驱动程序保留初始位置，但当它实际点击它时，该位置不再指向该元素。顺便说一句，FireFox 驱动程序没有这个问题，显然它以编程方式“点击”元素。

无论如何，当您使用动画或简单地动态更改元素的高度（例如`$("#foo").height(500)`）时，可能会发生这种情况。您需要确保仅在元素的高度“稳定”后单击元素。我最终得到了如下所示的代码（C# 绑定）：

```
if (!(driver is FirefoxDriver))
{
    new WebDriverWait(driver, TimeSpan.FromSeconds(10)).Until(
        d => d.FindElement(By.Id(someDynamicDiv)).Size.Height > initialSize);
} 
```

如果您无法轻松查询动画或任何其他因素，您可以使用等待元素静止的“通用”方法：

```
var prevLocation = new Point(Int32.MinValue, Int32.MinValue);
int stationaryCount = 0;
int desiredStationarySamples = 6; //3 seconds in total since the default interval is 500ms
return new WebDriverWait(driver, timeout).Until(d => 
{
    var e = driver.FindElement(By.Id(someId));
    if (e.Location == prevLocation)
    {
        stationaryCount++;
        return stationaryCount == desiredStationarySamples;
    }

    prevLocation = e.Location;
    stationaryCount = 0;
    return false;
}); 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2016-09-15T10:01:21.837

我遇到了这个，因为这个元素上有一个加载对话框封面。我通过在使用 this 元素之前添加一个等待来简单地解决它。

```
try {
        Thread.sleep((int) (3000));
    } catch (InterruptedException e) {
        //
        e.printStackTrace();
    } 
```

希望这有帮助！

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2013-08-29T11:34:49.283

我在使用[clj-webdriver](https://github.com/semperos/clj-webdriver/) （Selenium 的 clojure 端口）时遇到了同样的问题。为方便起见，我只是将之前的解决方案翻译成 clojure。您可以在单击之前调用此函数或进行任何操作以避免该问题。

```
(defn scrollTo
  "Scrolls to the position of the given css selector if found"
  [q]
  (if (exists? q) 
    (let [ loc (location-once-visible q) jscript (str "window.scrollTo(" (:x loc) "," (:y loc) ")") ] 
      (execute-script jscript)))) 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2014-12-15T19:51:05.383

我遇到了这个错误，因为我测试了悬停，然后需要单击工具提示下方的链接。解决方案是在`page.find('.sp-logo').hover`之前添加`click_link`以消除工具提示。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2014-10-02T13:51:58.267

也许这不是真正干净的解决方案，但它有效：

```
try:
    el.click()
except WebDriverException as e:
    if 'Element is not clickable at point' in e.msg:
        self.browser.execute_script(
            '$("{sel}").click()'.format(sel=el_selector)
        )
    else:
        raise 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2015-05-19T18:23:37.597

有趣的是，我一直在查看各种回复，没有人尝试过显而易见的事情，当然，我也没有。如果您的页面多次使用相同的 id，就像我的一样，（“newButton”，）并且您想要的不是第一个找到的，那么您很可能会收到此错误。最简单的事情（C#）：

```
var testIt = driver.FindElements(By.Id("newButton")); 
```

请注意，它是 FindElements，而不是 FindElement。

然后测试看看有多少结果从检索中返回。如果是第二个，则可以使用：

```
testit[1].Click(); 
```

或者让任何重复使用 id 的人来修复它们。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2015-12-01T16:22:41.003

在测试了所有提到的建议后，没有任何效果。我做了这个代码。它有效，但并不漂亮

```
public void click(WebElement element) {
    //https://code.google.com/p/selenium/issues/detail?id=2766 (fix)
    while(true){
        try{
            element.click();
            break;
        }catch (Throwable e){
            try {
                Thread.sleep(200);
            } catch (InterruptedException e1) {
                e1.printStackTrace();
            }
        }
    }
}

public void click(String css) {
    //https://code.google.com/p/selenium/issues/detail?id=2766 (fix)
    while(true){
        try{
            driver.findElement(By.cssSelector(css)).click();
            break;
        }catch (Throwable e){
            try {
                Thread.sleep(200);
            } catch (InterruptedException e1) {
                e1.printStackTrace();
            }
        }
    }
} 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2018-10-30T08:23:22.773

当您使用大于 1024x768 的分辨率时，请尝试最大化浏览器。

```
driver.manage().window().maximize(); 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2019-04-28T11:50:03.793

由于同样的原因，我也被卡了两天，实际上滚动会使其工作，因为可能是数据无法正确加载，这可能会一次又一次地导致同样的错误。

我所做的是，我随机向下滚动，一次是（0，-500），然后是（0,400），然后是（0.-600），您可以根据您的使用情况赋予这些滚动值。只需将其滚动到您要单击的内容的位置。

```
driver.execute_script("scrollBy(0,-500);")
sleep(5)

driver.execute_script("scrollBy(0,400);")
sleep(5)

driver.execute_script("scrollBy(0,-600);")
sleep(5) 
```

它真的有效:)

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2017-06-13T21:17:26.243

我做了一种蛮力的点击，它对我有用。

```
try:
    elem.click()
except:
    print "failed to click"
    size = elem.size
    mid_of_y = int(size["height"])/2
    stepts_to_do_to_left = int(size["width"])
    while stepts_to_do_to_left > 0:
        try:
            print stepts_to_do_to_left, mid_of_y
            action = webdriver.common.action_chains.ActionChains(driver)
            action.move_to_element_with_offset(elem, mid_of_y, stepts_to_do_to_left)
            action.click()
            action.perform()
            print "DONE CLICK"
            break
        except:
            pass 
```

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2017-06-06T19:34:13.463

如果你已经`jQuery`在页面上加载，你可以执行下面的 javascript 命令：

```
"$('#" + element_id + "').click()" 
```

使用 python 执行器的示例：

```
driver.execute_script("$('#%s').click()" % element_id) 
```

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2013-02-21T08:16:34.327

我有同样的问题，它是由 div 和 div 内的链接之间的 id 冲突引起的。所以司机点击了 div 而不是我想要的链接。我更改了 div id，它工作正常。

前：

```
<div id="logout"><a id="logout" href="logoutLink">logout</a></div> 
```

后：

```
<div id="differentId"><a id="logout" href="logoutLink">logout</a></div> 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2014-04-10T09:52:36.053

我遇到了同样的问题，并且显示的可见元素出现“其他元素将收到点击”错误。我发现没有其他解决方案可以使用 javascript 触发点击。

我更换了：

```
WebElement el = webDriver.findElement(By.id("undo-alert"));
WebElement closeButton = el.findElement(By.className("close"));
// The following throws 'Element is not clickable at point ... Other element 
// would receive the click'
closeButton.click(); 
```

和：

```
((JavascriptExecutor) webDriver).executeScript(
    "$('#undo-alert').find('.close').click();"
); 
```

一切都很好

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2014-12-17T18:09:59.737

我有另一个错误，`find_link`在 Chrome 和 Poltergeist 上无法单击带有 EM 标记和其中一些文本的 A 标记，尽管它在 Firefox 和 rack_test 中运行良好。解决方案是替换`click_link(link)`为：

```
find('a em', text: link).click 
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2014-12-04T13:11:20.300

我遇到了同样的问题，花了几个小时寻找解决方案。我尝试使用量角器单击长 ngGrid 底部的单元格。这是我的 ngGrid html 的快照：

```
....many rows here..
<!- row in renderedRows ->
   <!- column in renderedColumns ->
   <div ...> <a ngclick="selectRow(row)"...>the test link 100000</a>...
.... 
```

所有点击功能都不起作用。解决方案是在元素的当前范围内使用[评估：](http://angular.github.io/protractor/#/api?view=ElementArrayFinder.prototype.evaluate)

```
element(by.cssContainingText("a", "the test link 100000"))
    .evaluate("selectRow(row)") 
```

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2015-05-07T18:08:19.180

在 Visual Studio 2013 中，如果启用 BrowserLink - 它会在屏幕底部显示 BrowserLink 导航栏。如果您要单击的项目位于该导航栏后面，则会出现错误。禁用 BrowserLink 为我解决了这个问题。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2015-06-17T14:52:00.837

在尝试单击页面上的一个单选按钮时，我遇到了同样的异常。我在 Javascript 下使用并使用 IJavaScriptExecutor 执行。C# 示例

```
string script=" function clickCharity() {"+
"var InputElements = document.getElementsByName('Charity');"+
  "for (i=0; i<InputElements.length; i++){"+
    "if(InputElements[i].getAttribute('value') == 'true')"+
    "{"+
        "InputElements[i].click();"+
    "}"+
"}"+
"}";
var js=WebDriver as IJavaScriptExecutor;
js.ExecuteScript(script); 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2016-02-20T00:13:46.267

你可以用 JS 模拟点击：

```
public void click(WebElement element) {
    JavascriptExecutor js =(JavascriptExecutor)driver;
    js.executeScript("document.elementFromPoint(" + element.getLocation().x + "," + element.getLocation().y + ").click();");
} 
```

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2015-10-07T14:56:12.293

代替

```
webdriver.findElement(By.id("id1")).click(); 
```

尝试使用

```
click(By.id("id1"));

void click(final By byLocator) {
    waitFor(new ExpectedCondition<Boolean>() {
        @Override
        public Boolean apply(WebDriver driver) {
            WebElement element = driver.findElement(byLocator);
            if (element.isDisplayed()) {
                try {
                    element.click();
                    return true;
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
            return false;
        }

        @Override
        public String toString() {
            return "Element located " + byLocator + " clicked";
        }
    });
} 
```

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2021-01-02T18:02:44.297

单击 Angular Material 菜单中的按钮时，我遇到了这个确切的问题。每当我点击菜单内的按钮时，`.cdk-overlay-pane`都会收到点击。解决方法是增加`z-index`菜单内的按钮个数。

```
.cdk-overlay-pane button {
  z-index: 1001;
} 
```

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2020-03-06T05:07:00.040

如果您在模态（弹出）中遇到此问题，请注意，可能是在当前顶级模态下方存在具有相同属性的另一个元素。这让我大吃一惊，只需增加选择器的特异性以将范围缩小到您仅尝试单击的模态范围。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2015-03-16T16:51:41.653

我面临同样的问题，我使用了延迟，它在我身边工作得很好。页面正在刷新并获取其他定位器。

```
Thread.sleep(2000);
        Click(By.xpath("//*[@id='instructions_container']/a")); 
```

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2013-07-30T13:42:03.060

在 Drupal 中使用[Selenium](https://drupal.org/project/Selenium)时：

```
 // Get element.
    $element = $this->driver->getElement('xpath=//input');        
    // Get screen location.
    $location = $element->getLocation();
    // To make sure that Chrome correctly handles clicking on the elements 
    // outside of the screen, we must move the cursor to the element's location.
    $this->driver->moveCursor($location['x'], $location['y']);

    // Optionally, set some sleep time (0.5 sec in the example below) if your
    // elements are visible after some animation.
    time_nanosleep(0, 500000000);

    // Click on the element.
    $element->click(); 
```

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2013-04-30T18:48:28.390

我遇到了这个问题，它似乎是（在我的情况下）通过单击一个在单击的元素前面弹出一个 div 的元素引起的。我通过将我的点击包裹在一个大的'ol try catch块中来解决这个问题。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2018-04-21T12:48:30.830

在 Rselenium 中，当链接位于顶部窗口边框时，代码多次成功使用时会发生这种情况。简单的解决方案是使用 sendKeysToElement() 如下。

```
if (unlist(webElem$isElementDisplayed())) {
    webElem$sendKeysToElement(list(key = "up_arrow"))  # Add "up arrow"..
    webElem$clickElement()  # ... before $clickElement 
```

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2016-04-18T07:15:28.167

如果您在 conf.js 文件中使用以下行，请将其注释掉并重试

```
browser.ignoreSynchronization = true; 
```

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2021-03-25T19:41:47.847

如果您尝试单击 a`input`或`button`即，也会发生`disabled`这种情况，在这种情况下，没有任何内容与元素重叠，但它不可单击。

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2019-07-11T10:45:01.387

这可能对使用 WebdriverIO 的人有所帮助：

```
function(){
    var runInBrowser = function(argument) { 
        argument.click();
    };
    var elementToClickOn = browser.$('element');
    browser.execute(runInBrowser, elementToClickOn);
} 
```

来源：[https ://www.intricatecloud.io/2018/11/webdriverio-tips-element-wrapped-in-div-is-not-clickable/](https://www.intricatecloud.io/2018/11/webdriverio-tips-element-wrapped-in-div-is-not-clickable/)

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2021-05-14T17:10:19.750

可能有很多因素会引发此错误。首先，在 selenium webdriver 捕获元素之后，dom 可能会发生变化，或者元素中使用的所有 java 脚本在捕获元素之前没有成功加载。要解决这个问题，我们需要使用 javascript 等待或 ajax 等待，如下所示。

```
wait = new WebDriverWait(driver, 30);
wait.until((ExpectedCondition<Boolean>) wd -> ((JavascriptExecutor) wd).executeScript("return document.readyState").equals("complete"));
        e_driver = new EventFiringWebDriver(driver); 
```

其次，大多数提供软件质量保证服务的公司的工程师都尝试使用 java 脚本执行器进行点击操作。

如果这也不起作用，则使用 Actions 类执行操作。

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2018-10-28T12:47:58.917

```
WebDriverWait wait = new WebDriverWait(driver, TimeSpan.FromSeconds(15));
wait.Until(SeleniumExtras.WaitHelpers.ExpectedConditions.ElementToBeClickable(By.<Id or anything>)); 
```

希望这可以帮助。

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2017-10-12T15:12:49.117

就我而言，它在 Firefox 中有效，但在 Chrome 中失败。在 Chrome 中，它在将 Chrome 驱动程序版本更新到最新后得到修复。

# datetime - 经典 asp 中与 DateTime.TryParse() 最接近的等价物是什么？

> ID：11908250
> 
> 赞同：0
> 
> 时间：2012-08-10T19:44:13.680
> 
> 标签：datetime, asp-classic, vbscript

我需要在经典 asp 中对一些用户提供的字符串进行一些验证，以确保它们是有效的日期。如何在检查类型不匹配异常时将字符串解析为日期...

到目前为止，它看起来比我想象的要困难得多！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T19:58:47.343

你可以用[`IsDate`](http://www.devguru.com/technologies/vbscript/13938.asp)这个。

这确定该值是日期还是可以转换为日期。

例如（从[这里](http://qtp.blogspot.ca/2009/01/vbscript-date-time-functions.html)），

```
x = "January 12, 2009"
if IsDate(x) then
    msgbox(CDate(x))
end if 
```

**输出：**

```
1/12/2009 
```

# haskell - Haskell FFI：结构内的函数指针

> ID：11908254
> 
> 赞同：4
> 
> 时间：2012-08-10T19:44:31.993
> 
> 标签：haskell, struct, function-pointers, ffi

假设我在 C 中有这个结构：

```
/* C */
struct foo {
  char *name;
  int (*links)(foo*);
  /* ... */
}; 
```

如果我有`x :: Ptr Foo`，我如何在不使用的情况下获得`FunPtr`to ？我想避免这种情况，因为 Haddocks 中关于函数和非函数具有不同地址范围（可能还有大小？）的警告，因此转换可能会在这些平台上导致问题行为。`x``links``castPtrToFunPtr`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:24:21.117

...好吧，那算了。:)

万一其他人想知道这一点，您可以使用 hsc2hs `#peek`（等）将字段读取为 a `FunPtr a`，并且它似乎可以正常工作。

# html - 关于 ActionLinks 和普通 a-tag 超链接的小型 MVC 样式问题

> ID：11908256
> 
> 赞同：0
> 
> 时间：2012-08-10T19:44:40.323
> 
> 标签：html, css, ajax, asp.net-mvc-3

我刚刚解决了一个无法通过 ActionLink 解决的问题（据我所知），因此我使用了常规超链接。

当这两个链接在页面上呈现时，它们的样式非常相似，因为它们传递了相同的 css 条件，但是它们在我注意到的两种方式上并不完全相同：

*   文本可以在超链接上选择，而 ActionLink 上没有
*   将鼠标悬停在 ActionLink 上时，光标变为手形而不是指针，超链接与指针保持一致。

我的印象是 ActionLink 呈现了一个超链接，这可以解释为什么它们都由 css 设置样式，但显然存在一些差异。

有谁知道如何解决这个问题，或者建议另一种解决方案来用超链接替换 ​​ActionLink 以调用 AJAX 函数（返回 PartialView）？

**更新**

这是呈现的 HTML。第一个是超链接，第二个是 ActionLink。

```
<li><a id="load-partial">Test</a></li> 
<li><a href="/Contact/List">Contact</a></li> 
```

我在超链接中有一个 id 的原因是它会运行以下脚本以在特定的`div`. 我似乎无法使用 ActionLink 复制它，因为它只是在没有布局视图且完全未格式化的情况下自行返回视图。

```
<script>
$(document).ready(function () {
    $('#load-partial').click(function () {
        $.ajax({
            url: '/Contact/List/',
            datatype: 'html',
            success: function (data) {
                $('#adminmain').empty().html(data);
            }
        });
    });
});
</script> 
```

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T19:48:27.217

ActionLink 只不过是发出 HTML *A*标记的服务器端辅助方法。没有什么特别的。

如果您发现行为/呈现方面的差异，请查看呈现的 HTML 源代码并在其中查找差异。

使用 ActionLink 无法完成的事情很少，需要您手动编码*A*标签。您是否针对使用它无法解决的问题发布了单独的问题？

**更新**（基于您发布的 HTML）

超链接缺少*href*，因此单击时不会执行任何操作。

如果您需要向 ActionLink 添加 ID，可以执行以下操作：

```
@Html.ActionLink("Contact (this is the text)", "List", "Contact", 
    new { someQueryStringParameter = 42 }, 
    new { id="load-partial" }) 
```

该示例显示了如何生成

```
<a id="load-partial" href="/Contact/List?someQueryStringParameter=42">Contact (this is the text)</a> 
```

请记住，ID 在给定的 HTML 页面上应该是唯一的。

# android - 什么是 Context.getExternalMediaDir()？

> ID：11908261
> 
> 赞同：6
> 
> 时间：2012-08-10T19:45:06.440
> 
> 标签：android, media, image, android-sdcard

[Javadoc for Environment.getExternalStoragePublicDirectory()](http://developer.android.com/reference/android/os/Environment.html#getExternalStoragePublicDirectory%28java.lang.String%29)中的示例提到`Context.getExternalMediaDir()`但此方法在我的 Android API 版本中不可用，我无法在任何版本的任何地方找到它的文档。这是一个错字还是从未发布的东西？

```
void createExternalStoragePublicPicture() {
    // Create a path where we will place our picture in the user's
    // public pictures directory.  Note that you should be careful about
    // what you place here, since the user often manages these files.  For
    // pictures and other media owned by the application, consider
    // Context.getExternalMediaDir().
    File path = Environment.getExternalStoragePublicDirectory(
            Environment.DIRECTORY_PICTURES); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-10T18:47:51.230

不，这不再是错字了，这是 Android L Preview 上的一种新方法

基本上，谷歌的天才们在 /Android/data/ 文件夹中放置了一个“.nomedia”文件，这使得在您的文件夹中使用 MediaScannerConnection scanFile() 方法的任何尝试都失败了。因此，如果您有一个创建或下载媒体的应用程序，您现在可能正在做一些杂技来扫描该媒体并将其提供给您的提供商，除非您有新的 API，我们没有，因为其他所有手机都在运行更老的安卓...

目前我们的解决方法是自己扫描文件并将它们插入匹配的内容提供程序中。

例如，对于图像，已经有一种方法可以使用 **[MediaStore.Images.Media.insertImage (ContentResolver cr, String imagePath, String name, String description)](http://developer.android.com/reference/android/provider/MediaStore.Images.Media.html#insertImage(android.content.ContentResolver,%20java.lang.String,%20java.lang.String,%20java.lang.String))**

[我们今天在一次讨论](https://code.google.com/p/android/issues/detail?can=2&q=&colspec=ID%20Type%20Status%20Owner%20Summary%20Stars&groupby=&sort=&id=68056)中发布了这个解决方案，几分钟后，一位来自 Google 的工程师告诉我们 Context.getExternalMediaDir() 据称它将为您提供对 MediaScanning 友好的辅助外部存储（又名 Sd 卡）上的私有路径。

“新的 android.content.Context.getExternalMediaDirs() 返回所有共享存储设备上这些目录的路径。”

我的猜测（我没有测试过）是目录路径将类似于

/存储/extSdCard/Android/媒体/

开始管理 SD 卡使用开发决策的人真是个白痴，过去几周我们在 Google-Android 上看到的大量错误判断、糟糕的决策和他妈的让我想起了微软.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T20:01:50.293

我相信它只是名称不正确；我想他们的意思是说“ `Context.getExternalFilesDir()`”。这可能是一个错字，或者该方法可能稍后被重命名。

根据评论中的解释（“*应用程序拥有的图片和其他媒体*”），它与[`getExternalFilesDir(String type)`](http://developer.android.com/reference/android/content/Context.html#getExternalFilesDir%28java.lang.String%29)“*应用程序可以放置其拥有的持久文件的位置*”的解释非常吻合。请注意，您*可以*传递`null`to `getExternalFilesDir`，它返回根目录，或指定返回您要查找的文件夹类型。

我会说，我在这里有点推测。然而，这似乎是对这种看似不存在的方法最有可能的解释。

# c++ - 使用 SendInput 函数模拟输入

> ID：11908262
> 
> 赞同：1
> 
> 时间：2012-08-10T19:45:21.857
> 
> 标签：c++, windows, winapi

下面的程序没有做任何事情，尽管预计会模拟每秒按“a”和“b”。为什么它不起作用？

```
#include <Windows.h>
#include <iostream>

using namespace std;

const int INPUTS = 4;

int main()
{
    INPUT inputArray[INPUTS];

    INPUT input;

    input.type = INPUT_KEYBOARD;

    //Press 'a' key
    input.ki.wVk = 0x41;
    input.ki.wScan = MapVirtualKey(0x41,MAPVK_VK_TO_VSC);
    inputArray[0] = input;

    //Release 'a' key
    input.ki.dwFlags = KEYEVENTF_KEYUP;
    inputArray[1] = input;

    //Press 'b' key
    input.ki.dwFlags = 0;
    input.ki.wVk = 0x42;
    input.ki.wScan = MapVirtualKey(0x42,MAPVK_VK_TO_VSC);
    inputArray[2] = input;

    //Release 'b' key
    input.ki.dwFlags = KEYEVENTF_KEYUP;
    inputArray[3] = input;

    Sleep(5000);

    std::cout<<"GO!!!\n";

    for(int i=0; i<100; i++)
    {
        SendInput(sizeof(inputArray),inputArray,sizeof(INPUT));
        Sleep(1000); //Don't remove!
    }       

    std::cout<<GetLastError()<<std::endl;

    system("Pause");
    return 0;
} 
```

最后一个错误是

> ERROR_NOACCESS
> 
> 998 (0x3E6)
> 
> 对内存位置的无效访问。

但我不知道是什么原因造成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:00:11.170

尝试

```
SendInput(INPUTS, inputArray, sizeof(INPUT)); 
```

并检查返回值是否非零。事实上，它应该等于发送的输入数，在本例中为 4。

如果被另一个线程或 UIPI（[用户界面特权隔离](http://en.wikipedia.org/wiki/User_Interface_Privilege_Isolation)）阻塞，该函数可能会失败

为了避免其他问题，您可能需要检查当前键盘状态以及`SendInput`添加到输入流中，并且在运行时按下的其他键可能会干扰它。

出于好奇，您要模拟什么动作？对任何应用程序“伪造”用户输入通常不是一种非常优雅的做法。

# php - 谷歌地图 JSON 和 Wordpress

> ID：11908264
> 
> 赞同：1
> 
> 时间：2012-08-10T19:45:23.710
> 
> 标签：php, mysql, json, wordpress, google-maps

我的 wordpress 网站中有一张谷歌地图，这张地图收集了从帖子创建的标记。为了更好地解释，用户添加一个项目，然后根据位置将该项目放置在地图上，然后需要总计总库存。每个位置应该只生成一个标记和该标记产品的总库存。我有一些选择下拉列表让用户过滤标记，并在更改时更新一个 ajaxed php 文件，该文件构建一个结果的 json 文件，然后映射 javascript 循环并显示该文件。

我显示了所有内容，但是我无法按位置和要显示的总库存对标记进行分组。我认为最终的解决方案是让生成 json 文件的 php 脚本为每个位置创建一个带有总数的标记，从而无需使用 javascript 进行过滤。这是我创建 JSON 文件的 PHP。

```
<?php 

//Header
include "../../../../wp-blog-header.php";

global $wpdb; 
//$wpdb->show_errors();

$eq_type = $_GET['eq_type'];
$sql = " SELECT wp_posts.ID, wp_postmeta.meta_value, wp_postmeta.meta_key
FROM wp_posts 
LEFT JOIN wp_postmeta
ON wp_posts.ID = wp_postmeta.post_id
WHERE wp_posts.post_type = 'equipment'
AND wp_posts.post_status = 'publish'
AND wp_postmeta.meta_key NOT LIKE '%_yoast_wpseo%'
AND wp_postmeta.meta_key NOT LIKE '%_edit%'
";
$posts = $wpdb->get_results($sql);
$arr = array();
foreach ($posts as $post):
$arr["item-".$post->ID][$post->meta_key] = $post->meta_value;   
//print $post->ID.' - '.$post->meta_key." - ".$post->meta_value."<br />";
endforeach;

$fp = fopen('../json/json-equipment.json', 'w');
fwrite($fp, json_encode($arr));
fclose($fp);

?> 
```

它会生成这样的 JSON 输出......

```
 {
     "item-111":
      {"eq_type":"Dump Truck","eq_region":"Alberta","eq_total_inventory":"123"},
     "item-112":
      {"eq_type":"Dump Truck","eq_region":"British Columbia","eq_total_inventory":"234"},
     "item-113":
      {"eq_type":"Dump Truck","eq_region":"British Columbia","eq_total_inventory":"23"},
     "item-114":
      {"eq_type":"Digger","eq_region":"Manitoba","eq_total_inventory":"23"}
    } 
```

所以希望我已经足够清楚了，每个位置只需要生成一个标记，每个位置的总库存加起来按类型和/或区域过滤......但是分组和总计才是真正难倒的我。询问任何信息！

# css - 使用 CSS 对图像进行圆角处理

> ID：11908266
> 
> 赞同：0
> 
> 时间：2012-08-10T19:45:30.180
> 
> 标签：css, rounded-corners

在这个论坛和其他人中进行了一些调查，但我不太清楚我遇到的问题是什么..

我在一个滑块内的一个类上设置了一个边框半径，它从圆角开始，但是随着下一张幻灯片通过每个图像，它们恢复为非圆角。

有问题的网站在这里：http: [//goo.gl/8i8g2](http://goo.gl/8i8g2)

促销图片部分是我遇到问题的部分..

**修复了链接**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T19:55:50.373

我认为您需要添加：

```
.nivo-slice
{
    -webkit-border-radius:15px;
    -moz-border-radius:15px;
    border-radius:15px;
} 
```

到您的 CSS 文件。

## 编辑：

正如 Edward Ruchevits 在下面指出的，您可能还想添加：

```
-khtml-border-radius:15px;
-o-border-radius:15px; 
```

支持其他浏览器。

这在> IE9 中应该可以正常工作。您可能还想添加`<meta http-equiv="X-UA-Compatible" content="IE=edge">`到您的标题中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:04:31.507

顺便说一句，**snuffn**的答案并不完整，还有两个选择：对于旧 IE 和 Linux 用户。

```
.nivo-slice
{
    behavior: url("border-radius.htc");

       -moz-border-radius: 15px; /* Firefox */
    -webkit-border-radius: 15px; /* Safari and Chrome */
     -khtml-border-radius: 15px; /* Linux browsers */
            border-radius: 15px; /* Opera 10.50, IE and CSS3 */
} 
```

要使用`behavior`，您需要从[Google Code](http://code.google.com/p/curved-corner/)下载相应的文件。

# continuous-integration - 包含触发构建的 Perforce 更改列表的 Jenkins 变量是什么？

> ID：11908267
> 
> 赞同：9
> 
> 时间：2012-08-10T19:45:31.867
> 
> 标签：continuous-integration, jenkins, perforce

我有一个 Jenkins 作业集来轮询 Perforce 的更改并在提交更改列表时构建。

我想将构建工件部署到包含更改列表作为路径一部分的文件夹 - 例如 D:\JenkinsBuilds\$JOB_NAME\$PERFORCE_CHANGELIST\

包含触发构建的 Perforce 更改列表编号的 Jenkins 变量是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-10T22:15:39.793

它称为 P4_CHANGELIST。

有关更多详细信息，请参阅[插件文档](https://wiki.jenkins-ci.org/display/JENKINS/Perforce+Plugin)的“高级配置”部分。

# css - 用户选择跨越多个元素

> ID：11908275
> 
> 赞同：4
> 
> 时间：2012-08-10T19:46:21.040
> 
> 标签：css, firefox

我想禁用特定元素的文本选择。例如：

```
p {
    -moz-user-select: none
}

span {
    -moz-user-select: text
} 
```

​</p>

```
<div>
    <p>first paragraph</p>
    <span>first span</span>
    <p>second paragraph</p>
    <span>second span</span>
</div> 
```

​ 第一段和第二段不能单独选择。但是，如果我选择第一个跨度并向下拖动以选择第二个跨度，则第二个段落将在此过程中被选中。我想防止这种情况（它在 WebKit 中按预期运行）。

我正在使用 Firefox 14.0.1。JSFiddle 供参考：http: [//jsfiddle.net/GFNDY/](http://jsfiddle.net/GFNDY/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T00:58:14.827

由于选择仅“显然”包含`<p>`s （例如，如果您复制，则只有非`<p>`标签保存在剪贴板中），所以您需要做的就是确保浏览器不会对其着色；这可以通过使用 CSS`::selection`说明符（`::-moz-selection`对于 Mozilla）覆盖默认选择样式来完成。

所以CSS会有类似的东西：

```
p::-moz-selection {
    background: transparent;
    color: #000000;
} 
```

这是您的演示的修改版本，其行为符合预期：[Link](http://jsfiddle.net/GFNDY/9/)。
希望对您有所帮助！

# php - 在 XML 标记中

> ID：11908285
> 
> 赞同：2
> 
> 时间：2012-08-10T19:46:57.400
> 
> 标签：php, xml, parsing, xml-parsing, cdata

我有一个用 PHP 文件解析的 XML 文件。我必须包含许多需要 CDATA 才能正确解析的“特殊”字符。

有没有办法告诉我的 PHP 文件读取所有标签，就好像标签的乞讨和和有一个块一样？

截至目前，对于每个 XML 标签，我必须创建一个 CDATA 块：

```
<tag><![CDATA[blah.......]]></tag> 
```

有没有办法设置它，我不必每次都为我的 XML 中的evey标签编写 CDATA？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:48:12.850

CDATA 是个坏主意！它有很多问题。相反，您应该做的是使用`htmlspecialchars()`每个值。

好吧..保持你的反对票！以下是 CDATA 的一些问题。

首先，最简单的：你不能逃避这个`]]>`序列。这可能看起来没什么大不了的，但是如果您选择任何“转义字符序列”的方法，您真的应该选择一个每个序列都可以转义的方法。

现在来说大一点：CDATA 通常被用作将 Latin1 数据注入 UTF-8 文档的黑客手段。人们认为，我在 XML 中有一个转义问题，所以我将使用 CDATA 作为解决方法。

在 CDATA中允许*任何*字符序列，并且 XML 文档的指定字符编码在此块中不再相关。但是，任何类型的文本实际上都具有字符编码，而不是转换编码（您应该做什么），而是通过将其包装在 CDATA 中来“破解”它。

这也不是一种对二进制数据进行编码的可行方法，因为仍然不允许使用控制字符。

所以，CDATA 有点暗示“这里是龙”，这里有一些字节不是指定的编码，我只能告诉你没有控制字符。

这对消费者来说是个坏主意，因为关于字符编码的所有假设现在都不复存在了。

以下是一些链接：

*   [xml 中的 CDATA .. 坏主意？](http://www.rooftopsolutions.nl/blog/184)
*   [维基百科 CDATA，编码问题](https://en.wikipedia.org/wiki/CDATA#Issues_with_encoding)
*   奖励：遇到问题的消费者方面的某个人：[读取具有特殊字符的 CDATA 部分的问题（ISO-8859-1 编码）](https://stackoverflow.com/questions/997236/problems-reading-cdata-section-with-special-chars-iso-8859-1-encoding)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T21:02:09.690

您没有具体告诉我们您指的是什么“特殊字符”，但我假设您的意思是某种重音字符，或非拉丁字母中的字符等？

在大多数情况下，可以通过使用 UTF-8 字符集输出文档来解决问题。

在其余情况下，可以通过使用 XML 实体来解决——例如`&#160;`.

这两个都是比使用 CDATA 更​​好的解决方案。

# c++ - OpenGL glBegin vs Vertex Buffer Arrays VBO

> ID：11908289
> 
> 赞同：0
> 
> 时间：2012-08-10T19:47:05.403
> 
> 标签：c++, opengl

我想制作一个 OpenGL 游戏，但现在意识到我在学校学到的东西 -> 直接通过 glBegin/glEnd 绘制对象 -> 是老派而且很糟糕。互联网上的读数我看到顶点缓冲区对象和 GLSL 是 3d 编程的“正确”方法。

**1)**我应该使用 OpenGL 的 glDrawArrays 还是 glDrawElements？

**2)**对于有许多实体/地面/对象的游戏，渲染函数必须是许多 glDrawArrays()：

```
foreach(entity in entities):
    glDrawArrays(entitiy->arrayFromMesh()) //Where we get an array of the mesh vertex points 
```

或者只有一个 glDrawArrays() 封装了每个实体：

```
glDrawArrays(map->arrayFromAllMeshes()) 
```

**3)**现在是否每个图形层（例如 DirectX）都标准化了顶点缓冲区对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:07:18.167

> 1) 我应该使用 OpenGL 的 glDrawArrays 还是 glDrawElements？

这取决于您的源数据是什么样的。`glDrawArrays`稍微简单一点，因为您只需要绘制一个顶点流，但`glDrawElements`在您有许多顶点由多个三角形共享的情况下很有用。如果您只是绘制精灵，那么`glDrawArrays`可能是最简单的，但`glDrawElements`对于您想要节省缓冲区空间的大型复杂网格很有用。

> 2）对于具有许多实体/地面/对象的游戏，渲染函数必须是多个glDrawArrays（）还是只有一个封装每个实体的glDrawArrays（）：

同样，这在某种程度上是可选的，但请注意，您不能在 drawarrays 调用中间更改程序状态。所以这意味着任何两个需要不同状态的对象（不同的纹理、不同的着色器、不同的混合设置）都必须有一个单独的绘制调用。但是，有时将尽可能多的**相似**事物分组到一个绘图调用中对性能很有帮助。

> 3) 现在是否每个图形层（例如 DirectX）都标准化了顶点缓冲区对象？

DirectX 确实有类似的概念，是的。

# python - 如何导入自定义 json 模块而不是 python 2.7 中的默认模块？

> ID：11908290
> 
> 赞同：2
> 
> 时间：2012-08-10T19:47:08.563
> 
> 标签：python, json

假设我的目录结构是：

```
C:\Scripts\myscript.py
C:\Scripts\customjson\json.py 
```

myscript.py python 脚本在顶部有：

```
sys.path.append(os.path.join(os.path.dirname(sys.argv[0]), 'customjson'))
import json 
```

问题是，我有一个“customjson”文件夹，其中包含我想要使用的 json.py，而不是 Python 2.7 附带的默认 json 包。如何使脚本使用“customjson”而不是标准 json？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:50:36.790

尝试首先将您的 customjson 目录插入`sys.path`：

```
sys.path.insert(0, os.path.join(os.path.dirname(sys.argv[0]), 'customjson'))
import json 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:10:25.657

你可以使用这样的东西：

```
import sys
_orig_path = sys.path
sys.path = ["C:\Scripts\customjson"]
import json
sys.path = _orig_path 
```

但是，当然，该代码是不可移植的。为了使其可移植，您可以使用：

```
import sys, os
_orig_path = sys.path
sys.path = [
    os.path.abspath(os.path.join(os.path.dirname(__file__), "customjson")),
]
import json
sys.path = _orig_path 
```

或者，您可以重命名`json.py`为，例如`json2.py`. 然后导入它：

```
import json2 
```

或者，如果您绝对需要将其命名`json`：

```
import json2 as json 
```

..是的，第二个看起来更好，不是吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:17:23.090

我说：让你的`customjson`文件夹成为一个[package](http://www.python.org/doc/essays/packages.html)。

这简单：

1.  `__init__.py`在您的 customjson 文件夹中创建一个名为的文件。如果您不想在包级别定义任何特殊内容，则该文件可以为空。
2.  更改您的`import`声明以引用包中的模块（即`import customjson.json`）。
3.  更改对模块的引用以使用完整路径 (customjson.json.whatever)，或者进一步更改您的`import`语句以包含 as`as`子句 ( `import customjson.json as json`)。如果您使用`from ... import ...`语法，则这是不必要的。虽然使用`as`子句可能比重写您的访问更容易，但它可能会使任何其他阅读您的代码并期望它使用标准 json 模块的程序员感到困惑。

鉴于您在问题中描述的文件夹布局，如果您走这条路线，您根本不需要弄乱模块搜索路径，因为运行脚本的当前文件夹始终包含在路径中，这就是 customjson 包所在的位置位于。

# javascript - 监听鼠标事件……除了 div 的溢出：滚动滚动条？

> ID：11908292
> 
> 赞同：2
> 
> 时间：2012-08-10T19:47:19.747
> 
> 标签：javascript, jquery

`$(document)` *除了*div 的溢出：滚动滚动条之外，关于如何监听 mousedown 的任何建议？

我不确定滚动条*是*什么元素来引用它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:54:53.847

您可以自己检查目标：

```
$(document).on('mousedown', function(e) {
    console.log(e.target);
}); 
```

[**小提琴**](http://jsfiddle.net/zaLWX/)

滚动条不是真正的元素，单击处理程序将不起作用，但似乎 mousedown 已被触发，但只会为您提供滚动条所属的元素。

要排除滚动条，我猜你必须弄清楚它的大小，然后检查 mousedown 上的鼠标位置，看看它是否在滚动条区域内。

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T17:29:08.787

```
<div class='scrollHolder' style='overflow:scroll;'>
<div class='scrollContent'>
</div>
</div>

$(document).on( "mousedown", function( event )
{
    var onScrollbar = false;
    if (event.target.className == "scrollHolder")
    {   
        var s_c = $(event.target).children(".scrollContent");

        if (event.pageX-s_c.offset().left > s_c.innerWidth())
        {
            onScrollbar  = true;
        }
    }
}); 
```

# api - Foursquare 页面更新与照片

> ID：11908295
> 
> 赞同：0
> 
> 时间：2012-08-10T19:47:37.967
> 
> 标签：api, foursquare

我已经成功实现了新的“pageupdates/add”API，只需喊一声（即没有照片或特别）。现在我想添加对在页面更新上设置照片的支持。我假设应该首先调用“photos/add”入口点来添加照片，然后在 pageupdate add 调用中使用返回的照片 ID。我的问题是，应该如何添加照片？换句话说，是否应该将照片添加到场地（即指定场地Id）？可以将照片标记为私有，以便仅在页面更新时可见吗？我想确保我使用的是为此用例设计的 API。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:08:00.523

用于将照片添加到页面更新的 API 端点/行为尚未最终确定，也尚未发布。当它可用时会通知你。

# java - gwt-query：调整事件大小

> ID：11908300
> 
> 赞同：1
> 
> 时间：2012-08-10T19:48:09.613
> 
> 标签：java, gwt, resize, gwtquery

我想知道是否有某种解决方法可以在 GWT 查询上捕获调整大小事件的完成。我已经尝试通过 $().resize() 来做到这一点，但这并不好。我也想过要捕捉 mouseout 事件，但它在离开 resize ui-grab 图标时不起作用。

任何的想法？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T07:45:39.437

```
$(GQuery.window).resize(new Function(){
    public void f(){
      //Do something here when the window is resized
    }
} 
```

应该可以工作（仅在窗口元素上发送调整大小事件）。如果没有，请在此处打开一个问题：[http ://code.google.com/p/gwtquery/issues/list](http://code.google.com/p/gwtquery/issues/list)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-09-25T19:03:11.983

请参阅[此](https://stackoverflow.com/questions/4880862/when-does-the-resize-stop-event-called-jquery-ui)线程。这似乎是获得您想要的东西的好方法。

# c# - 必须声明标量变量“@dom”

> ID：11908305
> 
> 赞同：2
> 
> 时间：2012-08-10T19:48:34.050
> 
> 标签：c#, tsql, c#-4.0

这有点令人困惑，因为它之前工作过，我添加了 1 个小改动，我在我的 Web 应用程序中收到了这个错误消息。（我确实有其他案例，为简单起见，我只是取出了其他案例）

之前工作的原始代码：

```
ALTER PROCEDURE [dbo].[GetRoles]
(@reportid Decimal, @dom varchar(10))

AS
DECLARE @sql varchar(2000) 
SELECT @sql = 
Case @reportid

WHEN 1 THEN
 'select u.id as userId, u.domain, u.isAdmin, u.email, u.canReport, a.[site], a.bldgNum,  a.dataCenterNum, l.shortName, l.[description], a.canApprove, a.canComplete
    from locAdmin a
    inner join location l on  (a.site=l.site and a.bldgNum = l.bldgNum and a.dataCenterNum = l.dataCenterNum)
    right outer join [user] u on u.id=a.userId and u.domain=a.domain
    where u.isAdmin = 1'
End

EXEC (@sql) 
```

我做的唯一改变是添加

```
and u.domain = @dom' 
```

在最后的 u.isAdmin = 1' 之后，看起来像这样

```
where u.isAdmin = 1 and u.domain = @dom' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T18:50:28.060

您不需要动态 SQL 来编写此查询。

请这样做：

```
ALTER PROCEDURE [dbo].[GetRoles]
(
   @reportid Decimal,
   @dom varchar(10)
)
AS

 select u.id as userId, u.domain, u.isAdmin, u.email, u.canReport, 
        a.[site], a.bldgNum,  a.dataCenterNum, 
        l.shortName, l.[description],
        a.canApprove, a.canComplete
 from locAdmin a
 inner join location l
    on a.site=l.site and a.bldgNum = l.bldgNum and a.dataCenterNum = l.dataCenterNum
 right outer join [user] u 
    on u.id=a.userId and u.domain=a.domain
 where u.isAdmin = 1 and u.domain = @dom and @reportid = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T13:55:53.440

您需要`@dom`在执行动态 SQL 时添加为参数。

替换`EXEC (@sql)`为`exec sp_executesql @sql, N'@dom varchar(10)', @dom`并更改`DECLARE @sql varchar(2000)`为`DECLARE @sql nvarchar(2000)`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T19:53:43.177

您需要将变量的值实际添加到动态 SQL 中：

```
'THE REST OF YOUR QUERY
where u.isAdmin = 1 and u.domain = ''' + @dom + '''' 
```

这是因为您的动态 SQL 是您要执行的另一个 SQL 语句，因此不知道`@dom`原始语句中的参数。

# cocoa-touch - 如何在 iOS 设备上显示自定义信号强度显示

> ID：11908309
> 
> 赞同：0
> 
> 时间：2012-08-10T19:48:56.353
> 
> 标签：cocoa-touch

我们的应用无法使用状态栏，我们想在 iOS 设备上显示自定义信号强度？那可能吗？

# javascript - 关于如何在同一页面上多次调用 javascript 函数的建议

> ID：11908312
> 
> 赞同：1
> 
> 时间：2012-08-10T19:49:02.227
> 
> 标签：javascript, multiple-instances

所以，我有以下代码片段：

```
Script.js-

var menuSlider=function(){
var m,e,g,s,q,i; e=[]; q=8; i=8;
return{
    init:function(j,k){
        m=document.getElementById(j); e=m.getElementsByTagName('li');
        var i,l,w,p; i=0; l=e.length;
        for(i;i<l;i++){
            var c,v; c=e[i]; v=c.value; if(v==1){s=c; w=c.offsetWidth; p=c.offsetLeft}
            c.onclick=function(){menuSlider.mo(this)}; /*c.onmouseout=function(){menuSlider.mo(s)};*/
        }
        g=document.getElementById(k); g.style.width=(w)+'px'; g.style.left=(p)+'px';
    },
    mo:function(d){
        clearInterval(m.tm);
        var el,ew; el=parseInt(d.offsetLeft); ew=parseInt(d.offsetWidth);
        m.tm=setInterval(function(){menuSlider.mv(el,ew)},i);
    },
    mv:function(el,ew){
        var l,w; l=parseInt(g.offsetLeft); w=parseInt(g.offsetWidth);
        if(l!=el||w!=ew){
            if(l!=el){var ld,lr,li; ld=(l>el)?-1:1; lr=Math.abs(el-l); li=(lr<q)?ld*lr:ld*q; g.style.left=(l+li)+'px'}
            if(w!=ew){var wd,wr,wi; wd=(w>ew)?-1:1; wr=Math.abs(ew-w); wi=(wr<q)?wd*wr:wd*q; g.style.width=(w+wi)+'px'}
        }else{clearInterval(m.tm)}
}};}(); 
```

-

```
style2.css-
...
#slide {position:absolute; top:6px; height:13px; background:#4A7AFF; z-index:10} 
```

我以非常标准的方式从我的 HTML 文档中调用 javascript：

```
...
script type="text/javascript" language="javascript" src="script.js"></script>
</head>
<body onload="global.menuSlider.init('menu','slide')">
... 
```

基本上，我想尝试在我的 HTML 文档中调用此滑块的几个实例。我尝试将函数包装在另一个函数中：

```
(var global=function () {var menuSlider=function(){...}};}();}());\ 
```

然后调用全局函数而不是 menuSlider 函数（尝试遵循**[此处](https://stackoverflow.com/a/6423305/738448%22here%22)**给出的建议，但没有运气（显然没有工作）。

这就是我从 index.html 中调用它的方式：

```
<script type="text/javascript" language="javascript" src="script.js"></script>
</head>
<body onload="menuSlider.init('menu','slide')">
<div class="menu">
    <ul id="menu">
        <li value="1"><a style="cursor:pointer">1</a></li>
        <li value="2"><a style="cursor:pointer">2</a></li>
        <li value="3"><a style="cursor:pointer">3</a></li>
        <li value="4"><a style="cursor:pointer">4</a></li>
        <li value="5"><a style="cursor:pointer">5</a></li>
        <li value="6"><a style="cursor:pointer">6</a></li>
    </ul>
    <div id="slide"></div>
</div> 
```

当我说它不起作用时，我的意思是如果我尝试调用该函数两次（例如：

```
<div class="menu">
    <ul id="menu">
        <li value="1"><a style="cursor:pointer">1</a></li>
        <li value="2"><a style="cursor:pointer">2</a></li>
        <li value="3"><a style="cursor:pointer">3</a></li>
        <li value="4"><a style="cursor:pointer">4</a></li>
        <li value="5"><a style="cursor:pointer">5</a></li>
        <li value="6"><a style="cursor:pointer">6</a></li>
    </ul>
    <div id="slide"></div>
</div><div class="menu">
    <ul id="menu">
        <li value="1"><a style="cursor:pointer">1</a></li>
        <li value="2"><a style="cursor:pointer">2</a></li>
        <li value="3"><a style="cursor:pointer">3</a></li>
        <li value="4"><a style="cursor:pointer">4</a></li>
        <li value="5"><a style="cursor:pointer">5</a></li>
        <li value="6"><a style="cursor:pointer">6</a></li>
    </ul>
    <div id="slide"></div>
</div> 
```

滑动条的背景和数值出现了两次，但滑动条的实际功能部分（读作：滑块）只在第一个条上有效（而且效果不佳）。

我想我只调用一次函数，或者，如果我不止一次调用它，也许我正在调用函数的两个实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:34:57.207

听起来你想要的东西更像一个类，你可以从中实例化更多而不是实例？

这个怎么样？[http://ejohn.org/blog/simple-class-instantiation/](http://ejohn.org/blog/simple-class-instantiation/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-13T17:58:41.837

In HTML, the id attributes must be unique. Try

```
<div class="menu">
    <ul id="menuA">
        <li value="1"><a style="cursor:pointer">1</a></li>
        <li value="2"><a style="cursor:pointer">2</a></li>
        <li value="3"><a style="cursor:pointer">3</a></li>
        <li value="4"><a style="cursor:pointer">4</a></li>
        <li value="5"><a style="cursor:pointer">5</a></li>
        <li value="6"><a style="cursor:pointer">6</a></li>
    </ul>
    <div id="slideA"></div>
</div><div class="menu">
    <ul id="menuB">
        <li value="1"><a style="cursor:pointer">1</a></li>
        <li value="2"><a style="cursor:pointer">2</a></li>
        <li value="3"><a style="cursor:pointer">3</a></li>
        <li value="4"><a style="cursor:pointer">4</a></li>
        <li value="5"><a style="cursor:pointer">5</a></li>
        <li value="6"><a style="cursor:pointer">6</a></li>
    </ul>
    <div id="slideB"></div>
</div> 
```

In your javascript:

```
window.onload = function () {
     menuSlider.init('menuA','slideA');
     menuSlider.init('menuB','slideB');
}; 
```

# c# - C# 和基类到派生类转换

> ID：11908314
> 
> 赞同：0
> 
> 时间：2012-08-10T19:49:16.343
> 
> 标签：c#, casting, type-conversion

我想将基类实例列表中的信息投影到派生类实例列表中，但我一直遇到强制转换异常。这是我正在尝试做的一个例子......我如何让它工作？

以下代码在[http://ideone.com/CaXQS](http://ideone.com/CaXQS)上，如果有帮助的话……在此先感谢！

```
using System;
using System.Collections.Generic;

namespace AddingReversedNumbers
{
        public class MyDerivedClass : MyBaseClass, IMyInterface
        {
                public int InterfaceProperty { get; set; }
                public int DerivedClassProperty { get; set; }
                public List<int> DerivedClassList { get; set; }
        }

        public class MyBaseClass
        {
                public int BaseClassProperty { get; set; }
        }

        public interface IMyInterface
        {
                int InterfaceProperty { get; set; }
        }

        class Program
        {
                static void Main()
                {
                        //// This code works just fine.
                        //var derivedList = new List<MyDerivedClass>();
                        //derivedList.Add(new MyDerivedClass { BaseClassProperty = 10, DerivedClassProperty = 20, InterfaceProperty = 30 });
                        //derivedList.Add(new MyDerivedClass { BaseClassProperty = 20, DerivedClassProperty = 40, InterfaceProperty = 60 });
                        //var baseList = derivedList.ConvertAll(x => (MyBaseClass)x);

                        // This code breaks when ConvertAll() is called.
                        var baseList = new List<MyBaseClass>();
                        baseList.Add(new MyBaseClass{ BaseClassProperty = 10 });
                        baseList.Add(new MyBaseClass{ BaseClassProperty = 20 });
                        var derivedList = baseList.ConvertAll(x => (MyDerivedClass)x);
                }
        }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T19:52:59.210

在您的`ConvertAll`代码中，您*只是在*投射。您不能将基类实例强制转换为派生类实例。例如，你希望演员`object`做`FileStream`什么？它会引用哪个文件？

如果要在投影中创建*新*对象`ConvertAll`，只需执行以下操作：

```
var derivedList = baseList.ConvertAll
      (x => new MyDerivedClass { BaseClassProperty = x.BaseClassProperty }); 
```

# jquery - 检查cookie是否已过期，如果是则注销用户

> ID：11908322
> 
> 赞同：1
> 
> 时间：2012-08-10T19:49:53.100
> 
> 标签：jquery, cookies

我注意到当您在 facebook 上的“会话”已过期时，会出现一个弹出窗口，提示您将被注销，我如何定期检查 cookie 是否已过期？我试过这个：

```
 setInterval(function() {
    if($.cookie('id') == null) {
        location.reload;
    }
},60000); 
```

更新：对不起，我注意到我并没有说我想用带有 ajax 的 mysql 查询来更新“状态”。这不是问题，但如果我想这样做，我需要在 cookie 中设置的 ID，但如果它已过期，我不能这样做：/，我是否需要在用户登录时设置另一个具有长日期过期的 cookie ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T19:56:00.310

仅使用 cookie 来跟踪用户是否登录存在安全风险。最好结合使用 cookie/服务器端会话。大多数框架/CMS 都使用这种结构。由于 facebook 一直在与用户通信，因此很可能每次进行 AJAX 调用时，它都会在响应中寻找表明会话无效的内容。

如果您使用会话，则需要与服务器保持某种持续的通信以实现此目的。

```
var check = setInterval(function() {
    $.ajax( {
        url : '/authorize/ajax/',
        dataType: 'json',
        success : function(data) {
            if(data.unauthorized) 
                window.location.href="/login/";
            }
        }
    } );

},5000); 
```

# c# - 在服务器上工作，但发布后我收到错误

> ID：11908328
> 
> 赞同：0
> 
> 时间：2012-08-10T19:50:31.540
> 
> 标签：c#, asp.net, application-pool

我有 ASP.NET v3.5 网站项目。我的项目在服务器上的visual stduio上工作。但发布后，我得到了错误。

“无法加载程序集'App_Web_wkfb1ehc'。请确保在访问页面之前对其进行编译。”

我认为这是一个应用程序池问题，但我不知道如何解决

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:03:35.330

这很烦人，因为我以前见过这个，我试图回忆我们是如何修复它的。

我们所做的一件事是完全删除`bin`服务器上站点文件夹的内容，然后重新部署。基本上，当您编译站点的代码时，VS 将为 DLL 文件生成这些“App_Web_*”名称，有时会为页面代码隐藏编译一个新的 DLL 文件，但该页面的旧 DLL 会挂在`bin`文件夹中，这可能会导致您看到的错误（至少我认为那是我们认为问题所在:)）

您可以做的另一件事是为您的项目设置固定的 DLL 命名。可以在此处找到有关如何执行此操作的信息：http: [//msdn.microsoft.com/en-us/library/aa992037](http://msdn.microsoft.com/en-us/library/aa992037%28v=vs.80%29.aspx) (v=vs.80).aspx 。如果您在更改该设置后仍然遇到问题，请查看此 SO 问题：

[ASP.NET WebForms 部署 - 设置已编译的 \bin 目录 DLL 名称](https://stackoverflow.com/questions/3837508/asp-net-webforms-deployment-setting-the-compiled-bin-directory-dll-names)

# dojo - dojo 1.7 IE9 小部件函数调用未触发

> ID：11908332
> 
> 赞同：0
> 
> 时间：2012-08-10T19:50:40.913
> 
> 标签：dojo, widget, internet-explorer-9

我正在尝试向自定义调色板添加一个按钮，以调用位于使用小部件的工作区中的函数“uiFileInputDlg”。upbtn 出现在托盘上，但它没有触发在 postcreate 中连接的 DoUpload 函数，然后调用“uiFileInputDlg”。在 Firefox 中完美运行。我们是用户 dojo 1.7.2

------------模板-------------

```
<div class="dijitInline dijitColorPalette">
    <div class="dijitColorPaletteInner" data-dojo-attach-point="divNode" role="grid" tabIndex="${tabIndex}">
    </div>    
    <button type="button" id="upbtn"
        data-dojo-type="dijit.form.Button"
        data-dojo-props="id:'upbtn'"
        data-dojo-attach-point="btnUpNode">
        上传新图片
    </按钮>
</div>

```

-------------------------小工具------------------------ ---

//dojo.provide("meemli.UploadPalette"); 定义（['dojo/_base/declare', 'dijit/_WidgetBase', 'dijit/_TemplatedMixin', 'dojo/i18n!dijit/nls/common', 'dojo/text!./templates/UploadPalette.html', ' dijit/_WidgetsInTemplateMixin', 'dojo/_base/lang' ], function(declare, w, t, i18n, template, witm, lang){ console.log('meemli.UploadPalette: 需要 dijit/nls/common.js INSTEAD OF dojo/nls/common' + i18n.invalidMessage);

```
 return declare("meemli.UploadPalette",
    [dijit._Widget, dijit._Templated],
    {
    // summary: A keyboard accessible color-picking widget
    // description:
    //  Grid showing various colors, so the user can pick a certain color
    //  Can be used standalone, or as a popup.
    //
    // example:
    // |    <div dojoType="dijit.ColorPalette"></div>
    //
    // example:
    // |    var picker = new dijit.ColorPalette({ },srcNode);
    // |    picker.startup();
    //
    // defaultTimeout: Number
    //      number of milliseconds before a held key or button becomes typematic
    defaultTimeout: 500,

    // timeoutChangeRate: Number
    //      fraction of time used to change the typematic timer between events
    //      1.0 means that each typematic event fires at defaultTimeout intervals
    //      < 1.0 means that each typematic event fires at an increasing faster rate
    timeoutChangeRate: 0.90,

    // palette: String
    //      Size of grid, either "7x10" or "3x4".
    palette: "3x3",

    //_value: String
    //      The value of the selected color.
    value: null,

    //_currentFocus: Integer
    //      Index of the currently focused color.
    _currentFocus: 0,

    // _xDim: Integer
    //      This is the number of colors horizontally across.
    _xDim: null,

    // _yDim: Integer
    ///     This is the number of colors vertically down.
    _yDim: null,

    // _palettes: Map
    //      This represents the value of the colors.
    //      The first level is a hashmap of the different arrays available
    //      The next two dimensions represent the columns and rows of colors.
    _palettes: {
        "3x3": [],
        "3x2": ["/images/icons/1.png", "/images/icons/2.png", "/images/icons/3.png","/images/icons/4.png", "/images/icons/5.png", "/images/icons/6.png"]
    },

    // _imagePaths: Map
    //      This is stores the path to the palette images
//  _imagePaths: {
//      "3x3": dojo.moduleUrl("dijit", "templates/icons3x3.png")
//  },

    // _paletteCoords: Map
    //      This is a map that is used to calculate the coordinates of the
    //      images that make up the palette.
    _paletteCoords: {
        "leftOffset": 3, "topOffset": 3,
        "cWidth": 50, "cHeight": 50

    },

    // templatePath: String
    //      Path to the template of this widget.
//  templateString: dojo.cache("meemli", "templates/UploadPalette.html"),
    templateString: template,

    // _paletteDims: Object
    //      Size of the supported palettes for alignment purposes.
    _paletteDims: {
        "3x3": {"width": "156px", "height": "156px"}, // 48*3 + 3px left/top border + 3px right/bottom border...
        "3x2": {"width": "156px", "height": "109px"} // 48*3 + 3px left/top border + 3px right/bottom border...
    },

    // tabIndex: String
    //      Widget tabindex.
    maxCols: 3,
    tabIndex: "0",
    _curIndex: 0,

    DoUpload: function(){
        alert('hello');
        uiFileInputDlg(); // function out in the workspace
    },

    _addImage: function(url) {
        row = Math.floor(this._curIndex / this.maxCols);
        col = this._curIndex - (row * this.maxCols);
        this._curIndex++;
        this._yDim = Math.floor(this._curIndex / this.maxCols);
        this._xDim = this._curIndex - (row * this.maxCols);

        var imgNode = dojo.doc.createElement("img");
        imgNode.src = url;
        //imgNode.style.height = imgNode.style.width =  "48px";

        var cellNode = dojo.doc.createElement("span");
        cellNode.appendChild(imgNode);
        cellNode.connectionRefs = new Array();
        dojo.forEach(["Dijitclick", "MouseEnter", "Focus", "Blur"], function(handler) {
            cellNode.connectionRefs.push(this.connect(cellNode, "on" + handler.toLowerCase(), "_onCell" + handler));
        }, this);

        this.divNode.appendChild(cellNode);

        var cellStyle = cellNode.style;
        cellStyle.top = this._paletteCoords.topOffset + (row * this._paletteCoords.cHeight) + "px";
        cellStyle.left = this._paletteCoords.leftOffset + (col * this._paletteCoords.cWidth) + "px";
        cellStyle.height = this._paletteCoords.cHeight + "px";
        cellStyle.width = this._paletteCoords.cWidth + "px";
        // console.debug( "tlhw: " + cellStyle.top + ", " + cellStyle.left + ", " + cellStyle.height + ", " + cellStyle.width );

        // adjust size when the bits come...
//      this.xh = this.xw = "32px";
//console.log('this.xh => ' + this.xh);     
        dojo.connect( imgNode,"onload", this, function() {
//console.log('IN: CONNECT...this.xh => ' + this.xh);       
            this.xh = imgNode.height;
            this.xw = imgNode.width;
            this.xh = (this.xh==0) ? this.xh="32px" : (this.xh + "");
            this.xw = (this.xw==0) ? this.xw="32px" : (this.xw + "");
//          var h = parseInt( this.xh );
//          var w = parseInt( this.xw );
            var hArr = this.xh.split('p');
            var wArr = this.xw.split('p');
            var h =hArr[0];
            var w = wArr[0];

            var THUMBNAIL_MAX_WIDTH = 50;
            var THUMBNAIL_MAX_HEIGHT = 50;

            var hLim = Math.min(THUMBNAIL_MAX_HEIGHT, this._paletteCoords.cHeight);
            var wLim = Math.min(THUMBNAIL_MAX_WIDTH, this._paletteCoords.cWidth);

            var scale = 1.0;

            if( h > hLim || w > wLim ) {
                if( h / w < 1.0 ) { // width is bigger than height
                    scale = wLim / w;
                }
                else {
                    scale = hLim / h;
                }
            }

            imgNode.style.height = (scale * h) + "px";
            imgNode.style.width = (scale * w) + "px";
            console.debug( imgNode.src + ' loaded.'
                + "old: h " + h + ", w " + w + ", scale " + scale
                + ". new: h " + imgNode.style.height + ", w " + imgNode.style.width );
        } );
        if(dojo.isIE){
            // hack to force event firing in IE
            // image quirks doc'd in dojox/image/Lightbox.js :: show: function.
//          imgNode.src = imgNode.src;
        }

        dojo.attr(cellNode, "tabindex", "-1");
        dojo.addClass(cellNode, "imagePaletteCell");
        dijit.setWaiRole(cellNode, "gridcell");
        cellNode.index = this._cellNodes.length;
        this._cellNodes.push(cellNode);

    },

    _clearImages: function() {
        for(var i = 0; i < this._cellNodes.length; i++) {
            this._cellNodes[i].parentNode.removeChild(this._cellNodes[i]);
        }
        this._currentFocus = 0;
        this._curIndex = 0;
        this._yDim = 0;
        this._xDim = 0;
        this._cellNodes = [];
    },

    setImages: function(imageList) {
        this._clearImages();
        for(var i = 0; i < imageList.length; i++) {
            this._addImage(imageList[i]);
        }
    },

    postCreate: function(){
        // A name has to be given to the colorMap, this needs to be unique per Palette.
        dojo.mixin(this.divNode.style, this._paletteDims[this.palette]);
//      this.imageNode.setAttribute("src", this._imagePaths[this.palette]);
        this.domNode.style.position = "relative";
        this._cellNodes = [];   
        this.setImages(this._palettes[this.palette]);
        this.connect(this.divNode, "onfocus", "_onDivNodeFocus");
        this.connect(this.btnUpNode, "onclick", "DoUpload");

        // Now set all events
        // The palette itself is navigated to with the tab key on the keyboard
        // Keyboard navigation within the Palette is with the arrow keys
        // Spacebar selects the color.
        // For the up key the index is changed by negative the x dimension.     

        var keyIncrementMap = {
            UP_ARROW: -this._xDim,
            // The down key the index is increase by the x dimension.   
            DOWN_ARROW: this._xDim,
            // Right and left move the index by 1.
            RIGHT_ARROW: 1,
            LEFT_ARROW: -1
        };
        for(var key in keyIncrementMap){
            this._connects.push(dijit.typematic.addKeyListener(this.domNode,
                {keyCode:dojo.keys[key], ctrlKey:false, altKey:false, shiftKey:false},
                this,
                function(){
                    var increment = keyIncrementMap[key];
                    return function(count){ this._navigateByKey(increment, count); };
                }(),
                this.timeoutChangeRate, this.defaultTimeout));
        }
    },

    focus: function(){
        // summary:
        //      Focus this ColorPalette.  Puts focus on the first swatch.
        this._focusFirst();
    },

    onChange: function(url, hsz, wsz){
        // summary:
        //      Callback when a image is selected.
        // url, hsz, wsz, strings
        //      height and width string .
//      console.debug("img selected: "+url);
    },

    _focusFirst: function(){
        this._currentFocus = 0;
        var cellNode = this._cellNodes[this._currentFocus];
        window.setTimeout(function(){dijit.focus(cellNode);}, 0);
    },

    _onDivNodeFocus: function(evt){
        // focus bubbles on Firefox 2, so just make sure that focus has really
        // gone to the container
        if(evt.target === this.divNode){
            this._focusFirst();
        }
    },

    _onFocus: function(){
        // while focus is on the palette, set its tabindex to -1 so that on a
        // shift-tab from a cell, the container is not in the tab order
        dojo.attr(this.divNode, "tabindex", "-1");
    },

    _onBlur: function(){
        this._removeCellHighlight(this._currentFocus);
        // when focus leaves the palette, restore its tabindex, since it was
        // modified by _onFocus().
        dojo.attr(this.divNode, "tabindex", this.tabIndex);
    },

    _onCellDijitclick: function(/*Event*/ evt){
        // summary:
        //      Handler for click, enter key & space key. Selects the color.
        // evt:
        //      The event.
        var target = evt.currentTarget;
        if (this._currentFocus != target.index){
            this._currentFocus = target.index;
            window.setTimeout(function(){dijit.focus(target);}, 0);
        }
        this._selectColor(target);
        dojo.stopEvent(evt);
    },

    _onCellMouseEnter: function(/*Event*/ evt){
        // summary:
        //      Handler for onMouseOver. Put focus on the color under the mouse.
        // evt:
        //      The mouse event.
        var target = evt.currentTarget;
        window.setTimeout(function(){dijit.focus(target);}, 0);
    },

    _onCellFocus: function(/*Event*/ evt){
        // summary:
        //      Handler for onFocus. Removes highlight of
        //      the color that just lost focus, and highlights
        //      the new color.
        // evt:
        //      The focus event.
        this._removeCellHighlight(this._currentFocus);
        this._currentFocus = evt.currentTarget.index;
        dojo.addClass(evt.currentTarget, "imagePaletteCellHighlight");
    },

    _onCellBlur: function(/*Event*/ evt){
        // summary:
        //      needed for Firefox 2 on Mac OS X
        this._removeCellHighlight(this._currentFocus);
    },

    _removeCellHighlight: function(index){
        dojo.removeClass(this._cellNodes[index], "imagePaletteCellHighlight");
    },

    _selectColor: function(selectNode){ 
        // summary:
        //      This selects a color. It triggers the onChange event
        // area:
        //      The area node that covers the color being selected.
        var img = selectNode.getElementsByTagName("img")[0];
        this.onChange(this.value = img.src, this.xh, this.xw);
    },

    _navigateByKey: function(increment, typeCount){
        // summary:
        //      This is the callback for typematic.
        //      It changes the focus and the highlighed color.
        // increment:
        //      How much the key is navigated.
        // typeCount:
        //      How many times typematic has fired.

        // typecount == -1 means the key is released.
        if(typeCount == -1){ return; }

        var newFocusIndex = this._currentFocus + increment;
        if(newFocusIndex < this._cellNodes.length && newFocusIndex > -1)
        {
            var focusNode = this._cellNodes[newFocusIndex];
            focusNode.focus();
        }
    }
}); 
```

});

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:19:27.987

更新

```
this.connect(this.btnUpNode, "onclick", "DoUpload"); 
```

成为

```
this.connect(this.btnUpNode, "onClick", "DoUpload"); 
```

`onclick`是一个dom事件，`onClick`是一个dijit事件。由于您使用的是 dijit 按钮，因此您希望使用后者。

# c# - 水晶报表程序集无法加载

> ID：11908338
> 
> 赞同：0
> 
> 时间：2012-08-10T19:51:29.247
> 
> 标签：c#, asp.net, crystal-reports, crystal-reports-2008

我已经在我的 Windows 2008 服务器中安装了 64 位，当我尝试

```
* Crystal Report XI R2 service pack 6 

* Crystal Reports XI Release 2 
```

在 asp.net 页面中打开我的水晶报告，我得到

```
"Crystal report assembly 11.5 cannot be loaded" 
```

当我转到服务器中的程序集文件夹时，我可以看到 CrystalDecisions.CrystalReports.Engine 指向 11.5.3700.0

任何想法为什么它不加载水晶报告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T19:55:08.223

我想到了两件事。

1.  检查 asp.net 所指的确切版本号。
2.  我不确定这是否适用于网站，我认为应该如此。查看构建目标是 x86 还是任何 cpu。将目标更改为 X86 通常可以解决这些问题。假设安装在 64 位系统上的水晶报表版本实际上只有 32 位。

# java - 静态变量引用的对象的垃圾收集

> ID：11908342
> 
> 赞同：3
> 
> 时间：2012-08-10T19:51:53.780
> 
> 标签：java, memory-management, static, garbage-collection

```
class StaticTest{

public static SomeClass statVar = new SomeClass();

} 
```

在此之后，如果我们`StaticTest.statVar`随机访问和分配一些新对象，那么这些对象什么时候会被垃圾回收呢？答：在正常的垃圾收集时间。

但是如果 this`statVar`引用了一些实例变量（对象）呢？

不清楚？

好的，静态变量的生命周期是直到类卸载。在 Web 应用程序中，我们在静态上下文中初始化许多东西。如果我们为这个静态上下文提供了一些对象引用但我们没有释放它们，那么它是如何被垃圾收集的？

我很乐意就此进行讨论。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T19:52:41.010

静态变量引用的对象将在类卸载时被垃圾收集。因此，在类卸载之前，静态引用所引用的对象都不会被 GC 处理（因为堆中始终存在对对象的可访问引用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:02:11.323

静态对象引用通常被认为是 GC 根，并且它们指向的任何东西（以及被这些对象绑定的任何东西）都将被认为是活动的。如果您希望它们引用的对象成为垃圾回收的主题，您将需要清除对它们的引用（当然还有所有其他引用）。

**如果**您的类不再被引用**并且**您的 JVM 设置为收集未使用的类，则 thinksteep 的答案适用。我不会屏住呼吸等待那一刻。

只要您保留引用的数据，答案就是它们不会被清除。当您拥有 GC 时，这是协议中最基本的部分。

作为旁注，我很少认为将事物保持在网络应用程序中的静态上下文中是一个好主意，除非它是一个单例对象或该网络应用程序的所有用户共享的东西。在那种情况下，只要您的应用服务器正在运行，您为什么要清理它？这没有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T19:57:20.327

考虑内存中的对象，而不是变量。`statVar`是对内存中某个对象的引用。如果您在其他地方保留对同一对象的引用，则在该引用被释放之前，该对象将不会被 GC。`statVar`类是否被卸载并消失并不重要，因为这只是对仍然有引用的 Object 的另一个引用。因此，在这种情况下将不会对其进行清洁。

# c# - 用它发布 json 会中断

> ID：11908346
> 
> 赞同：1
> 
> 时间：2012-08-10T19:52:24.093
> 
> 标签：c#, javascript, jquery, vb.net

为什么如果我将 a 添加`<br />`到“名称”属性中，ajax 不会发布到后面的代码中，但如果我不添加它，那么它可以正常工作？

下面的 JSON 数组是这样自动生成的：

```
//        var tableOBJ = [];
//
//
//        $("table tr").each(function () {
//
//            var r = new rowOBJ(

//                $(this).find('td').eq(0).val(),
//                $(this).find('td').eq(1).text()
//                                   
//                                    );
//
//            tableOBJ.push(r);
//
//        });

var myJS = 
[
{"name":"d <br />","surname":"cxzc"},
{"name":"d ","surname":"cxzc"},
{"name":"d ","surname":"cxzc"},
{"name":"d ","surname":"cxzc"},
{"name":"d ","surname":"cxzc"}
];

 var gg = { "myText": JSON.stringify(myJS) };

 //var gg = JSON.stringify({ "myText": myJS }); //this does not work either, code-behind does not see it at all

        $.ajax({
            type: "POST",
            url: "send.aspx",
            data: gg,
            success: function (data) {
                //pass

            },
            error: function () {
                //fail

            }
        });

    }); 
```

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    Dim s As String = HttpContext.Current.Request.Form("myText")

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:55:32.693

您必须对 html 进行编码或更改配置以允许该类型的请求。作为安全措施，Asp.net 正在阻止 html 在请求中被接受。

[MSDN](http://msdn.microsoft.com/en-us/library/system.web.configuration.pagessection.validaterequest.aspx#Y0)

```
<ConfigurationPropertyAttribute("validateRequest", DefaultValue := True)> _ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T19:56:24.510

$.ajax 方法认为它通过智能猜测来发送 HTML 数据。所以如果你添加

```
dataType:'json' 
```

到 ajax 调用的参数列表中，它应该可以解决您的问题。

# ruby-on-rails - 获取上周轨道上的热门文章

> ID：11908350
> 
> 赞同：0
> 
> 时间：2012-08-10T19:52:44.363
> 
> 标签：ruby-on-rails, ruby, activerecord

希望这是一个相对简单的解决方案。我有一个帖子表和一个喜欢表。用户可以喜欢一个帖子，所以帖子有_很多喜欢和喜欢属于_to个帖子。

考虑到这一点，我将如何获得上周最受欢迎的帖子（按赞）？我想将解决方案简化为一个查询，因为将查询限制在上周应该可以避免任何扩展问题（我认为）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:12:30.750

首先，您需要一个表示一周前日期时间的变量。我认为它会是这样的：

```
one_week_ago = Time.now - 1.week 
```

在比较前 n 个帖子的所有帖子之前，您必须计算每个帖子在上周的点赞数并将其存储在一个变量中。

```
likes_for_last_week = post.likes.where("created_at > ?", one_week_ago).count 
```

您可以将所有这些存储在一个数组中：

```
[[post,likes_for_last_week][post,likes_for_last_week]...] 
```

然后使用 <=> 运算符进行排序。

请原谅我的简短，但由于我是一个相当新手的程序员，所以这么多的指导需要我进行大量的研究。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:54:01.630

我建议使用命名范围来执行此操作。

您的 SQL 查询将类似于：

```
SELECT post_id, count(post_id) as count FROM "likes" 
GROUP BY post_id ORDER BY count desc LIMIT 3 
```

您可以在 Like 类中使用以下内容：

```
scope :popular, select("post_id, count(post_id) as count").group(:post_id).order("count desc").limit(3) 
```

然后，当您想要最受欢迎的帖子时，您会这样做

```
@popular = Like.popular
@popular[0].post_id # this will be the id of the Post
@popular[0].count   # this will be the count of likes for that Post 
```

这样做的一个优点是它将显示有史以来最受欢迎的帖子。如果您想将赞限制在上周内给出的赞，您可以将上面的 select 语句放入 a`lambda {}`并`where("created_at < ?", DateTime.now - 1.week)`在`select`. 你甚至可以传入一个参数来控制过滤的距离。更多详细信息请参阅[ActiveRecord 指南中有关传递参数的详细信息](http://guides.rubyonrails.org/active_record_querying.html#passing-in-arguments)

# android - IllegalAccessException - 从不可序列化继承的对象的序列化

> ID：11908353
> 
> 赞同：1
> 
> 时间：2012-08-10T19:52:50.360
> 
> 标签：android, serialization, deserialization

我得到 android.widget.ImageView; 尝试反序列化我以前序列化的对象时出现 IllegalAccessException

```
 File presetFile = new File("pathToFile");

        FileInputStream fis = new FileInputStream(presetFile);      
        ObjectInputStream ois = new ObjectInputStream(fis);
        Preset preset = (Preset) ois.readObject(); 
```

我猜ImageView有一些限制，解释如下：

```
public class Preset implements Serializable {

    private Date dateOfCreation;
    private int bpm;
    private SoundSwitch[][] switches; 
```

最后是 SoundSwitch 类头

```
public class SoundSwitch extends ImageView implements Serializable{
} 
```

那是因为我继承的 ImageView 没有实现 Serializable 吗？我是否必须放弃反序列化此类对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T00:34:21.537

这是因为`ImageView`您继承自是不可序列化的*并且*没有公共的无参数构造函数。显然它有一个受保护的或包访问或私有的。

# android - android：自定义 SimpleCursorAdapter 不加载所有数据

> ID：11908359
> 
> 赞同：1
> 
> 时间：2012-08-10T19:53:30.733
> 
> 标签：android, simplecursoradapter

需要帮助，我有一个 listview 活动，我想为每个项目显示几个文本字段加上 2 个按钮（例如具有呼叫按钮和文本消息按钮的联系人应用程序。阅读教程我发现了如何让按钮可点击，但现在我的文本视图（除 1 之外的所有）不显示除我留在布局文件中的股票文本之外的任何数据。1 文本视图确实显示了我需要的数据。在我的自定义 SCA 中没有我给它提供了特定的数据，所以我假设它发生在后台。

我的 R.id.company_address_details_phone 无需我进行任何操作即可加载所需的数据，但我的 ViewHolder 中的其他 TextView 均不显示任何数据。连接到我的呼叫按钮的 For 循环确实从我的光标输出数据，所以我知道这不是我缺少数据。任何和所有的帮助表示赞赏。

作为旁注，当第一次编写代码并且没有使用自定义 SimpleCursorAdapter 时，我的所有文本视图都按预期填充（我只是无法单击按钮）。这使我假设我的 CompanyActivity 类没有错误，但是我的 CompanyDetailsCursroAdapter 类中缺少某些内容。

****编辑****** 所以在我回头尝试了一些东西之后，我正在回答我自己的问题。我的视图没有被填充，我只是将我的一个视图设置为默认文本，使其看起来好像是从我的数据库中提取的。我现在使用以下代码使用从光标适配器传递给我的自定义光标适配器的数据填充我的视图。我想知道这是否是最好的方法，或者是否有更简化或 android 批准的方法。

```
 viewHolder.addressTextView.setText(companyDetailsCursor.getString(companyDetailsCursor.getColumnIndex("AddressStreet")));
        viewHolder.cityTextView.setText(companyDetailsCursor.getString(companyDetailsCursor.getColumnIndex("AddressCity")));
        viewHolder.stateTextView.setText(companyDetailsCursor.getString(companyDetailsCursor.getColumnIndex("AddressState")));
        viewHolder.zipTextView.setText(companyDetailsCursor.getString(companyDetailsCursor.getColumnIndex("AddressZip")));
        viewHolder.phoneTextView.setText(companyDetailsCursor.getString(companyDetailsCursor.getColumnIndex("AddressPhone"))); 
```

CompanyDetailsCursorAdapter.java

```
public class CompanyDetailsCursorAdapter extends SimpleCursorAdapter implements Filterable{
private final Context context;
private int layout;
Cursor companyDetailsCursor;

public CompanyDetailsCursorAdapter(Context context, int layout, Cursor c, String[] from, int[] to) {
    super(context, layout, c, from, to);

    this.context = context;
    this.layout = layout;
    this.companyDetailsCursor = c;
}

static class ViewHolder {
    protected TextView addressTextView;
    protected TextView cityTextView;
    protected TextView stateTextView;
    protected TextView zipTextView;
    protected TextView phoneTextView;

    protected ImageButton callButton;
    protected ImageButton mapButton;
}

@Override
public View getView(final int position, View convertView, ViewGroup parent) {
    ViewHolder viewHolder;

    if (convertView == null) {
        final LayoutInflater inflater = LayoutInflater.from(context);
        convertView = inflater.inflate(R.layout.company_address_details, null);

        convertView.setOnClickListener(new OnClickListener(){

            public void onClick(View v) {
                // TODO Auto-generated method stub

            }

        });

        viewHolder = new ViewHolder();
        viewHolder.addressTextView = (TextView) convertView.findViewById(R.id.company_address_details_street);
        viewHolder.cityTextView = (TextView) convertView.findViewById(R.id.company_address_details_city);
        viewHolder.stateTextView = (TextView) convertView.findViewById(R.id.company_address_details_state);
        viewHolder.zipTextView = (TextView) convertView.findViewById(R.id.company_address_details_zip);
        viewHolder.phoneTextView = (TextView) convertView.findViewById(R.id.company_address_details_phone);

        viewHolder.callButton = (ImageButton) convertView.findViewById(R.id.company_address_details_call_button);

        viewHolder.callButton.setOnClickListener(new OnClickListener(){

            public void onClick(View v) {
                companyDetailsCursor.moveToPosition(position);
                if (RouteTrackerGlobal.APP_DEBUG) { Log.d(RouteTrackerGlobal.APP_TAG,"getview position set to " + String.valueOf(position));}
                for (int i = 0; i < companyDetailsCursor.getColumnCount();i++){
                    Log.i(RouteTrackerGlobal.APP_TAG, companyDetailsCursor.getString(i));
                }
            }

        });

        convertView.setTag(viewHolder);

    } else {
        viewHolder  = (ViewHolder) convertView.getTag();
    }

    return convertView;

} 
```

公司活动.java

```
public class CompanyActivity extends ListActivity {
DbAdapter dbAdapter;
int companyID;

Context context = this;

Cursor companyDetailsCursor;
@Override
public void onCreate(Bundle savedInstanceBundle) {
    super.onCreate(savedInstanceBundle);

    dbAdapter = new DbAdapter(this);

    setContentView(R.layout.company_activity);

    Bundle companyActivityBundle = getIntent().getExtras();

    companyID = companyActivityBundle.getInt("CompanyID");

    ListView list = getListView();

    list.setOnItemLongClickListener(new OnItemLongClickListener(){

        public boolean onItemLongClick(AdapterView<?> arg0, View arg1,
                int arg2, long arg3) {
            // TODO Auto-generated method stub
            return false;
        }

    });
}

@Override
public void onPause() {
    dbAdapter.close();
    super.onPause();
}

@Override
public void onResume() {
    dbAdapter.open();
    super.onResume();
    loadDetails();
}

@Override
protected void onListItemClick (ListView l, View v, int position, long id){
    //TODO: When item in list clicked, call activity to display address and directions
}

public void loadDetails() {
    TextView companyLabel = (TextView) findViewById(R.id.company_activity_company_label);

    companyDetailsCursor = dbAdapter.getCompanyDetails(companyID);
    startManagingCursor(companyDetailsCursor);

    companyDetailsCursor.moveToFirst();

    companyLabel.setText(companyDetailsCursor.getString(companyDetailsCursor.getColumnIndex("CompanyName")));

    String[] columns = new String[] {"AddressPhone", "AddressStreet", "AddressCity", "AddressState", "AddressZip"};
    int[] to = new int[] {R.id.company_address_details_phone, R.id.company_address_details_street, R.id.company_address_details_city, R.id.company_address_details_state, R.id.company_address_details_zip};

    CompanyDetailsCursorAdapter companyDetailsAdapter = new CompanyDetailsCursorAdapter(context, R.layout.company_address_details, companyDetailsCursor, columns, to);
    setListAdapter(companyDetailsAdapter);

} 
```

}

Company_Address_Details.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <RelativeLayout android:layout_width="fill_parent"
        android:layout_height="wrap_content" >
        <TextView
            android:id="@+id/company_address_details_phone"
            style="@style/company_address_listview"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:text="@string/company_address_details_phone_default" />
        <ImageButton android:id="@+id/company_address_details_call_button"
            style="@style/company_address_listview"
            android:layout_alignParentRight="true"
            android:layout_centerInParent="true"
            android:background="@android:color/transparent"
            android:src="@android:drawable/sym_action_call"
            android:contentDescription="@string/company_address_details_phone_hint"/>
    </RelativeLayout>

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_toLeftOf="@+id/company_address_details_call_button1"
            android:orientation="vertical" >

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content" >

                <TextView
                    android:id="@+id/company_address_details_street"
                    style="@style/company_address_listview"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="@string/company_address_details_street_default" />
            </LinearLayout>

            <RelativeLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content" >

                <TextView
                    android:id="@+id/company_address_details_city"
                    style="@style/company_address_listview"
                    android:layout_width="wrap_content"
                    android:layout_alignParentLeft="true"
                    android:layout_centerVertical="true"
                    android:text="@string/company_address_details_city_default" />

                <TextView
                    android:id="@+id/company_address_details_state"
                    style="@style/company_address_listview"
                    android:layout_centerInParent="true"
                    android:layout_centerVertical="true"
                    android:text="@string/company_address_details_state_default" />

                <TextView
                    android:id="@+id/company_address_details_zip"
                    style="@style/company_address_listview"
                    android:layout_alignParentRight="true"
                    android:layout_centerVertical="true"
                    android:text="@string/company_address_details_zip_default" />

            </RelativeLayout>

        </LinearLayout>

        <ImageButton
            android:id="@+id/company_address_details_call_button1"
            style="@style/company_address_listview"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_centerHorizontal="false"
            android:layout_centerInParent="false"
            android:layout_centerVertical="true"
            android:background="@android:color/transparent"
            android:contentDescription="@string/company_address_details_phone_hint"
            android:paddingLeft="20dp"
            android:src="@android:drawable/ic_dialog_map" />

    </RelativeLayout>

</LinearLayout> 
```

# php - 如何获取特定类别 Wordpress 帖子的标题、图片和摘录

> ID：11908361
> 
> 赞同：1
> 
> 时间：2012-08-10T19:53:35.380
> 
> 标签：php, wordpress

我想获取特定 WordPress 类别的帖子标题、图片和摘录。我正在使用下面的代码来获取特定类别的帖子标题。

```
global $post;
$myposts = get_posts('numberposts=5&category_name=Cooling Towers');
foreach($myposts as $post) :
?>
<li><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></li>
<?php endforeach; ?> 
```

任何想法，我如何获得特定 WordPress 类别的帖子图片和摘录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T23:48:11.530

你可以用这个

```
<?php
    query_posts( array('posts_per_page'=>5, 'category_name'=>'Cooling Towers') );
    while ( have_posts() ) : the_post();
?>
    <h2><a href="<?php the_permalink(' ') ?>" title="<?php the_title(); ?>"><?php the_title(); ?></a></h2>
    <?php if ( has_post_thumbnail() ): // check for the featured image ?>
    <a href="<?php the_permalink(' ') ?>" title="<?php the_title(); ?>" class="opacity"><?php the_post_thumbnail(); ?></a> <!--echo the featured image-->
<?php
    endif;
    the_excerpt(); // echo the excerpt
    endwhile;
    wp_reset_query(); // resets main query
?> 
```

# python - 按时间对字典中的字典进行排序的最有效方法是什么（对于评论树）？

> ID：11908366
> 
> 赞同：3
> 
> 时间：2012-08-10T19:53:56.457
> 
> 标签：python, list, sorting, dictionary, tree

我正在尝试对具有如下结构的评论树进行排序：

```
unsorted_dict = {
  1: [id, poster, time, comment, {
    2: [id, poster, time, comment, {
      3: [id, poster, time, comment]
    }]
  }],
  2: [id, poster, time, comment, {
      2: [id, poster, time, comment, {
        3: [id, poster, time, comment]
      }]
  }]
} 
```

如果`sort = newest`，我想生成一个排序列表/字典，其结构与上面相同，但每个级别按时间降序排序：

```
sorted_output = [
                 [1,'toplevel', 10:00pm, 'words...', [
                    [2,'secondlevel', 5:00pm, 'words...',
                       [3,'thirdlevel', '3:00pm', 'comment...'],
                       [4,'thirdlevel', '2:00am','comment']
                    ],
                    [5,'secondlevel', 4:00pm, 'words...', [
                       [6,'thirdlevel', '3:00pm', 'comment...'],
                       [7,'thirdlevel', '2:00pm','comment'],
                       [8,'thirdlevel', '1:00pm','comment']
                    ]
                  ],
                  [9,'toplevel', 9:00pm, 'words...', [
                    [10,'secondlevel', 7:00pm, 'words...',
                       [11,'thirdlevel', '4:00pm', 'comment...'],
                       [12,'thirdlevel', '3:00pm','comment']
                    ],
                    [13,'secondlevel', 6:00pm, 'words...', [
                       [14,'thirdlevel', '3:00pm', 'comment...'],
                       [15,'thirdlevel', '2:00pm','comment'],
                       [16,'thirdlevel', '1:00pm','comment']
                    ]
                  ]
                 ] 
```

对字典的每一级进行排序并重建最终排序列表的最有效方法是什么？

注意：树的上限为 3 级

奖励：另外，我想将原始海报评论放在每个级别的顶部，按时间排序。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:17:57.487

你应该能够排序这个把字典变成一个列表，排序，然后递归

```
def nested_sort(hsh):
    lst = list(hsh.iter_items()) # structure this however you want,e.g., build an object
                                #   with the subhash - [1,name, etc. {}]
    lst.sort()
    new_lst = []
    for sub_hsh in lst:  # get the subhash out however you structure it above
        new_lst += nested_sort(sub_hsh);  # recurse 
```

# php - PHP 我收到此代码错误

> ID：11908370
> 
> 赞同：0
> 
> 时间：2012-08-10T19:54:12.493
> 
> 标签：php, mysql, apache, xampp

```
$mysql = mysql_query("SELECT pass, user, id, folder, http, spacelimit, language, theme, permbrowse, permupload, permcreate, permuser, permadmin, permdelete, permmove, permchmod, permget, permdeleteuser, permedituser, permmakeuser, permpass, permrename, permedit, permsub, formatperm, status, recycle, permprefs FROM ".$GLOBALS['config']['db']['pref']."users WHERE user='".mysql_real_escape_string($user)."'");
    list ($dbpass, $dbuser, $userid, $userdir, $http, $limit, $language, $theme, $permbrowse, $permupload, $permcreate, $permuser, $permadmin, $permdelete, $permmove, $permchmod, $permget, $permdeleteuser, $permedituser, $permmakeuser, $permpass, $permrename, $permedit, $permsub, $formatperm, $status, $recycle, $permprefs) = mysql_fetch_row($mysql); 
```

错误在第 3 行。它说

> 警告：mysql_fetch_row() 期望参数 1 是资源，布尔值在第 83 行的 C:\xampp\htdocs\index.php 中给出

我尝试查找它，但无法找到修复程序。

我知道有些方法已被弃用，但我只是想解决这个问题，这样我就可以完成 2 项工作（目前）。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T19:57:17.600

你在跑`mysql_query(mysql_query(...))`。

```
$mysql = "SELECT pass, user, id, folder, http, spacelimit, language, theme, permbrowse, permupload, permcreate, permuser, permadmin, permdelete, permmove, permchmod, permget, permdeleteuser, permedituser, permmakeuser, permpass, permrename, permedit, permsub, formatperm, status, recycle, permprefs FROM ".$GLOBALS['config']['db']['pref']."users WHERE user='".mysql_real_escape_string($user)."'"; 

echo $mysql; // Get the output here and run it directly to see if it succeeds

$result = mysql_query($mysql) or die(mysql_error()); // add `or die(mysql_error())` to output an error if the query fails 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T19:57:07.753

阅读[mysql_query 的文档](http://php.net/manual/en/function.mysql-query.php)！如果查询因任何原因失败，它将返回 FALSE。您可以使用[mysql_error](http://php.net/manual/en/function.mysql-error.php)找出原因。

# wpf - 取消和放弃实体框架和 WPF 中的更改

> ID：11908376
> 
> 赞同：1
> 
> 时间：2012-08-10T19:54:38.643
> 
> 标签：wpf, entity-framework, architecture, mvvm

我正在开发一个系统，用户需要填写表格，并且此信息存储在数据库中。在其中一个屏幕中，我有以下流程：

*   在一个项目中，他可以添加多个订单。
*   每个添加的订单都会打开一个配置屏幕，可以设置订单的内部信息。也可以将项目添加到订单中。
*   每个添加的项目都会打开一个配置屏幕，允许用户设置内部信息。

综上所述，流程为Project -> Order -> Item，其中“A -> B”表示A包含0、1或更多B。

该项目正在使用带有实体框架的 WPF 来管理数据库访问。我将实体数据库映射中的实体直接绑定到屏幕中。通过这种方式，我们对 WPF 有一些“优势”，例如，非空字段被涂成红色。而且，代码要简单得多。实体仅在保存项目时更新（或添加）到数据库中。因此，可以编辑项目，然后可以编辑订单，并且仅在保存项目时才保存它们，因为它们依赖于要保存的项目 ID。

但是，直接使用映射实体有一个很大的问题：假设用户在 Order 中编辑了一个 Item。然后，他再次对其进行编辑，但这一次，用户没有按“确定”，而是按“取消”。必须还原所做的更改。但是，之前的状态丢失了，因为它没有在数据库中更新并且由于 WPF 绑定而被更改。

防止此问题的最佳方法是什么？我不知道在实体框架中创建克隆是否效果很好。并且创建仅在单击确认命令时将其值传输到对象的变量将违反 MVVM 模式，并且会使我失去我已经谈到的“优势”。

请帮我！

谢谢！

# javascript - StopPropagation 将始终对属于同一个父亲的元素起作用？

> ID：11908384
> 
> 赞同：1
> 
> 时间：2012-08-10T19:55:12.780
> 
> 标签：javascript, jquery, stoppropagation

我有一个`<aside>`里面的菜单。鼠标进出关闭和打开菜单。我得到了一个绝对位于菜单上方的外部元素。它在side dom之外。在进入和离开时防止其冒泡不会产生任何影响。

我以为我会防止冒泡到文档，所以它仍然会捕获，但似乎没有。看来stoppedBubble元素需要嵌套在side里面。

我对吗？谢谢！

**>>>> 编辑 >>>>**

[我创建了一个 JsFiddle](http://jsfiddle.net/neoswf/pXgPG/7)来演示这个问题。

第一个示例取自[https://developer.mozilla.org](https://developer.mozilla.org/en-US/docs/Gecko_DOM_Reference/Examples#Example_5%3a_Event_Propagation)。其次是我的补充。

我已经得到了答案。**只有当我站在**监听元素的范围内时，我才能取消冒泡。我无法**从外部**取消Bubble/stopPropagation 。

# java - 如何使用 Java 获取上传到 Amazon S3 的文件的进度状态

> ID：11908385
> 
> 赞同：9
> 
> 时间：2012-08-10T19:55:21.547
> 
> 标签：java, amazon-web-services, amazon-s3, file-upload, progress-bar

我正在使用 Java 将多个文件上传到 Amazon S3。

我正在使用的代码如下：

```
MultipartHttpServletRequest multipartRequest = (MultipartHttpServletRequest) request;
MultiValueMap < String,
MultipartFile > map = multipartRequest.getMultiFileMap();
try {
    if (map != null) {
        for (String filename: map.keySet()) {
            List < MultipartFile > fileList = map.get(filename);
            incrPercentge = 100 / fileList.size();
            request.getSession().setAttribute("incrPercentge", incrPercentge);
            for (MultipartFile mpf: fileList) {

                /*
         * custom input stream wrap to original input stream to get
         * the progress
         */
                ProgressInputStream inputStream = new ProgressInputStream("test", mpf.getInputStream(), mpf.getBytes().length);
                ObjectMetadata metadata = new ObjectMetadata();
                metadata.setContentType(mpf.getContentType());
                String key = Util.getLoginUserName() + "/" + mpf.getOriginalFilename();
                PutObjectRequest putObjectRequest = new PutObjectRequest(
                Constants.S3_BUCKET_NAME, key, inputStream, metadata).withStorageClass(StorageClass.ReducedRedundancy);
                PutObjectResult response = s3Client.putObject(putObjectRequest);

            }
        }
    }
} catch(Exception e) {
    e.printStackTrace();
} 
```

我必须创建自定义输入流以获取 Amazon S3 使用的数字字节。我从这里的问题中得到了这个想法：[Upload file or InputStream to S3 with a progress callback](https://stackoverflow.com/questions/3739626/upload-file-or-inputstream-to-s3-with-a-progress-callback)

我的`ProgressInputStream`课程代码如下：

```
package com.spectralnetworks.net.util;
import java.io.IOException;
import java.io.InputStream;

import org.apache.commons.vfs.FileContent;
import org.apache.commons.vfs.FileSystemException;

public class ProgressInputStream extends InputStream {
    private final long size;
    private long progress,
    lastUpdate = 0;
    private final InputStream inputStream;
    private final String name;
    private boolean closed = false;

    public ProgressInputStream(String name, InputStream inputStream, long size) {
        this.size = size;
        this.inputStream = inputStream;
        this.name = name;
    }

    public ProgressInputStream(String name, FileContent content)
    throws FileSystemException {
        this.size = content.getSize();
        this.name = name;
        this.inputStream = content.getInputStream();
    }

    @Override
    public void close() throws IOException {
        super.close();
        if (closed) throw new IOException("already closed");
        closed = true;
    }

    @Override
    public int read() throws IOException {
        int count = inputStream.read();
        if (count > 0) progress += count;
        lastUpdate = maybeUpdateDisplay(name, progress, lastUpdate, size);
        return count;
    }@Override
    public int read(byte[] b, int off, int len) throws IOException {
        int count = inputStream.read(b, off, len);
        if (count > 0) progress += count;
        lastUpdate = maybeUpdateDisplay(name, progress, lastUpdate, size);
        return count;
    }

    /**
     * This is on reserach to show a progress bar
     * @param name
     * @param progress
     * @param lastUpdate
     * @param size
     * @return
     */
    static long maybeUpdateDisplay(String name, long progress, long lastUpdate, long size) {
        /* if (Config.isInUnitTests()) return lastUpdate;
        if (size < B_IN_MB/10) return lastUpdate;
        if (progress - lastUpdate > 1024 * 10) {
            lastUpdate = progress;
            int hashes = (int) (((double)progress / (double)size) * 40);
            if (hashes > 40) hashes = 40;
            String bar = StringUtils.repeat("#",
                    hashes);
            bar = StringUtils.rightPad(bar, 40);
            System.out.format("%s [%s] %.2fMB/%.2fMB\r",
                    name, bar, progress / B_IN_MB, size / B_IN_MB);
            System.out.flush();
        }*/
        System.out.println("name " + name + "  progress " + progress + " lastUpdate " + lastUpdate + " " + "sie " + size);
        return lastUpdate;
    }
} 
```

但这不能正常工作。它立即打印到文件大小，如下所示：

```
name test  progress 4096 lastUpdate 0 sie 30489
name test  progress 8192 lastUpdate 0 sie 30489
name test  progress 12288 lastUpdate 0 sie 30489
name test  progress 16384 lastUpdate 0 sie 30489
name test  progress 20480 lastUpdate 0 sie 30489
name test  progress 24576 lastUpdate 0 sie 30489
name test  progress 28672 lastUpdate 0 sie 30489
name test  progress 30489 lastUpdate 0 sie 30489
name test  progress 30489 lastUpdate 0 sie 30489 
```

并且实际上传需要更多时间（打印行后超过 10 次）。

我应该怎么做才能获得真正的上传状态？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-14T14:53:12.547

通过使用以下代码，我得到了问题的答案，这是获得真实进度状态的最佳方式

```
ObjectMetadata metadata = new ObjectMetadata();
metadata.setContentType(mpf.getContentType());

String key = Util.getLoginUserName() + "/"
        + mpf.getOriginalFilename();
metadata.setContentLength(mpf.getSize());
PutObjectRequest putObjectRequest = new PutObjectRequest(
                Constants.S3_BUCKET_NAME, key, mpf.getInputStream(),
                metadata)
        .withStorageClass(StorageClass.ReducedRedundancy);

putObjectRequest.setProgressListener(new ProgressListener() {
        @Override
        public void progressChanged(ProgressEvent progressEvent) {
            System.out.println(progressEvent
                    .getBytesTransfered()
                    + ">> Number of byte transfered "
                    + new Date());
            progressEvent.getBytesTransfered();
            double totalByteRead = request
                    .getSession().getAttribute(
                                                    Constants.TOTAL_BYTE_READ) != null ? (Double) request
                                            .getSession().getAttribute(Constants.TOTAL_BYTE_READ) : 0;

            totalByteRead += progressEvent.getBytesTransfered();
            request.getSession().setAttribute(Constants.TOTAL_BYTE_READ, totalByteRead);
            System.out.println("total Byte read "+ totalByteRead);

            request.getSession().setAttribute(Constants.TOTAL_PROGRESS, (totalByteRead/size)*100);
        System.out.println("percentage completed >>>"+ (totalByteRead/size)*100);   
        if (progressEvent.getEventCode() == ProgressEvent.COMPLETED_EVENT_CODE) {
            System.out.println("completed  ******");
        }
    }
});
s3Client.putObject(putObjectRequest); 
```

我之前的代码的问题是，我没有在元数据中设置内容长度，所以我没有得到真正的进度状态。下面的行是从 PutObjectRequest 类 API 复制的

构造一个新的 PutObjectRequest 对象以将数据流上传到指定的存储桶和键。构建请求后，用户还可以选择指定对象元数据或标准 ACL。

数据流的内容长度必须在对象元数据参数中指定；Amazon S3 要求在上传数据之前将其传入。未能指定内容长度将导致输入流的整个内容在内存中本地缓冲，以便可以计算内容长度，这可能会导致负面的性能问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T02:54:37.340

我假设您使用的是适用于 Java 的 AWS 开发工具包。

您的代码正在正常工作：它显示每次读取 4K 时正在调用 read。您的想法（在消息中更新）也是正确的：AWS 开发工具包提供 ProgressListener 作为通知应用程序上传进度的一种方式。

“问题”在于 AWS SDK 的实施，它缓冲的文件大小超过了约 30K 的文件（我假设它是 64K），因此您没有收到任何进度报告。

尝试上传一个更大的文件（比如 1M），你会看到这两种方法都能给你更好的结果，毕竟以今天的网络速度报告 30K 文件的进度甚至不值得。

如果您想要更好的控制，您可以使用[S3 REST 接口](http://docs.amazonwebservices.com/AmazonS3/latest/API/RESTObjectPUT.html)（这是 AWS Java 开发工具包最终使用的接口）自己实现上传，这不是很困难，但需要一些工作。如果你想走这条路，我建议你找一个计算会话授权令牌的例子，而不是[自己做](http://docs.amazonwebservices.com/AmazonS3/latest/dev/RESTAuthentication.html#ConstructingTheAuthenticationHeader)（对不起，我的搜索 foo 现在还不够强大，无法链接到实际的示例代码。）但是，一旦你完成了所有这些麻烦您会发现您实际上希望在套接字流上有一个 64K 缓冲区以确保快速网络中的最大吞吐量（这可能是 AWS Java SDK 的行为方式。）

# mysql - 是否可以合并来自两个 MySQL 服务器的转储？

> ID：11908386
> 
> 赞同：1
> 
> 时间：2012-08-10T19:55:26.207
> 
> 标签：mysql, merge, mysqldump

我有两台mysql服务器，都是master。在他们的本地网络出现一些问题后，他们失去了彼此的联系，但继续工作了一段时间，没有任何同步。两者都存储了这段时期的一些数据，丢失部分数据会很糟糕。

是否可以将这些服务器的转储与任何实用程序合并？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:16:07.067

我认为您会发现 pt-table-sync 很有帮助。但请确保在备份数据时使用它以确保安全，并在使用它后重置复制，因为如果没有，您所做的更改将被复制到原始服务器。

# facebook - 以双倍标题显示的操作

> ID：11908393
> 
> 赞同：0
> 
> 时间：2012-08-10T19:55:57.123
> 
> 标签：facebook, action, facebook-opengraph

我们的活动出现了两次重复的标题。理想情况下，我们希望站点名称显示在第二行。我们的 og: 元数据中有标题、站点名称和描述。

有没有办法配置这些事件以正确显示这些字段？

![头衔翻倍](../Images/bbc6cc0fe3a8c0f33717479cc9ad5008.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T18:29:12.127

我们在 facebook 开发者界面中找到了配置部分来改变这一点。它位于 Apps > Edit Open Graph > Aggregations >（事件类型名称）下，然后您可以更改标题行。

# joomla - 是否可以在 Joomla 中使用 LDAP 实现 SSO？

> ID：11908395
> 
> 赞同：1
> 
> 时间：2012-08-10T19:56:02.227
> 
> 标签：joomla, active-directory, ldap, single-sign-on, joomla2.5

我意识到 Joomla 支持 LDAP，但我不希望我的整个数据库转移到 Joomla 数据库（原因很明显）。我希望实施 SSO 以防止这种情况发生。这可能吗？经过几天的谷歌搜索和阅读不同的文章，我在网上找不到任何好的信息。我认为也许 JAuthTools 可以帮助我做到这一点，但即使有围绕该扩展的 wiki，我也找不到任何关于它的 SSO 支持的好信息。如果有人知道如何做到这一点，那就太好了。用户当前存储在 Active Directory 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:38:32.837

据我所知，[JAuthTools不再积极维护，而是用于 Joomla！](http://extensions.joomla.org/extensions/access-a-security/site-access/authentication-cloud-based/158)1.5。

我们所做的最后一次 SSO 集成是使用[JMapMyLDAP](http://extensions.joomla.org/extensions/access-a-security/authentication-cloud-based/18108)，它似乎工作得很好，而且它的最后一次更新还不到一个月前。

# c# - c# excel beforesave线程

> ID：11908397
> 
> 赞同：1
> 
> 时间：2012-08-10T19:56:11.260
> 
> 标签：c#, multithreading, excel, vsto

我尝试创建 ac# excel 2007 Add-In，并且我想做“更快”的“beforeSave”方法。我只是使用一个线程（并尝试任务和 task.factory），但它总是说同样的错误。

编码。

```
private void ThisAddIn_Startup(object sender, System.EventArgs e)
    { 
         this.Application.WorkbookBeforeSave += new Microsoft.Office.Interop.Excel.AppEvents_WorkbookBeforeSaveEventHandler(Application_WorkbookBeforeSave);

}// thisAddIn_startup method end
public void Application_WorkbookBeforeSave(Microsoft.Office.Interop.Excel.Workbook Wb, bool SaveAsUI, ref bool Cancel)
    {
         backendworker bwfs = new backendworker();// its a custom standalone class!
         Task task1 = new Task(() => bwfs.MyBeforeSave(this.Application.ActiveWorkbook));
         task1.Start();
}// application_workbookbeforesave method end 
```

后勤班：

```
public class backendworker
{

    // BeforeSave method
    public void MyBeforeSave(Microsoft.Office.Interop.Excel.Workbook Wb)
    {
          Wb.SaveCopyAs("c:\\temp\\temp.xls");
    }// method end
}// class end 
```

没有线程（任何类型）都可以，它可以保存整个工作簿。但。对于任何多线程解决方案，它的抛出错误。（*来自 HRESULT 的异常：0x800AC472*）

知道我做错了什么吗？或者想法如何解决它？:D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:07:35.040

通过多个线程与 Excel 交互有点棘手——[这里](http://msdn.microsoft.com/en-us/library/8sesy69e%28v=vs.100%29.aspx)有一个 MSDN 条目。这是因为您通过 COM 与 Excel 交互，COM 使用线程单元；然而，.NET 没有。特别是，Excel 使用 Single-Treaded Apartment (STA)，这意味着为与 Excel 交互而创建的所有新线程都必须设置为 STA 状态：

```
thread.SetApartmentState(ApartmentState.STA); 
```

在与 Excel 交互之前。

根据链接的 MSDN 文章，这仍然留下了可能遇到的问题的完整列表。总的来说，除非确实有必要，否则**我不建议在多个线程中与 Excel 进行交互。**不与 Excel 交互的后台工作人员没有问题，但通过后台线程与 Excel 应用程序交互太麻烦，不值得。

# css - 在 CSS 中设置背景颜色和背景图像

> ID：11908399
> 
> 赞同：1
> 
> 时间：2012-08-10T19:56:20.717
> 
> 标签：css

我在背景颜色上设置背景图像时遇到问题：这是我的示例，以便您了解我的意思：[**JSFiddle**](http://jsfiddle.net/vmvXA/9/)

现在这是功能性 CSS 部分：

```
#tancan{
    background-color: #ebebeb;
    background-image: url('http://lamininbeauty.co.za/images/products/tancan2.jpg');
} 
```

正如您在 JSFiddle 中看到的那样，背景图像重复出现。如果我使用 no-repeat 作为属性，图像就会消失。

另外，我希望背景图像向右浮动，并且图像是否应该大于包含的 div，如何使其按比例适合？- 就像你会`<img/>`使用`width: 100%`and使图像标签适合`height: 100%`？

我不想使用 HTML 图像标签，它会容易得多，但我不想使用它有几个原因。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T19:58:20.127

试试这个 - [http://jsfiddle.net/vmvXA/17/](http://jsfiddle.net/vmvXA/17/)

```
#tancan {
    background: #ebebeb url('http://lamininbeauty.co.za/images/products/tancan2.jpg') no-repeat top right;
} 
```

并使背景图像不超过其父容器，您可以使用`background-size: contain`- [http://jsfiddle.net/vmvXA/22/](http://jsfiddle.net/vmvXA/22/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T20:02:34.397

您不能只添加`no-repeat`to `background-image`，因为`background-image`它是一个仅指图像本身的特定属性。如果您想在一个声明中添加所有内容，请设置`background`：

```
background: url('http://lamininbeauty.co.za/images/products/tancan2.jpg') #ebebeb no-repeat top right; 
```

或将其全部分开，由您决定：

```
background-color: #ebebeb;
background-image: url('http://lamininbeauty.co.za/images/products/tancan2.jpg');
background-repeat: no-repeat;
background-position:top right;
background-size: contain; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T20:02:45.503

[这是小提琴](http://jsfiddle.net/transparent/vmvXA/24/)。

```
 background:#ebebeb url('http://lamininbeauty.co.za/images/products/tancan2.jpg') no-repeat right top; 
```

为了使代码更短，可以在一个属性中指定所有设置。这称为“速记属性”。

要使所有图片都适合它的父级，请添加 style 属性`background-size:contain;`。

更新了小提琴。

# javascript - 停止光标，直到在 javascript 的 textarea 中更改文本

> ID：11908406
> 
> 赞同：0
> 
> 时间：2012-08-10T19:56:48.583
> 
> 标签：javascript, jquery, cursor, textarea

试图允许用户输入文本区域，但如果看到某个单词，我希望光标停止，直到该单词被删除。

我找到了这个词，但我找不到让光标停止的方法。

关于我如何在 javascript 中执行此操作的任何想法

```
 $(function() {
            $('#ideacomment').bind('keyup', function(e){
                var characterLimit = 300;
                charactersUsed = $(this).val().length;

                if(charactersUsed > characterLimit){
                    charactersUsed = characterLimit;
                    $(this).val($(this).val().substr(0, characterLimit));
                    $(this).scrollTop($(this)[0].scrollHeight);
                }
                var charactersRemaining = characterLimit - charactersUsed;
                $('#remainingCharacters').html(charactersRemaining);

                 var words = $('#ideacomment').val().split(/\b[\s,\.-:;]*/);
                 var wordcount = words.length;
                 var nonewords = new Array("f**k", "you");
                 var nonewordcount = nonewords.length;
                //console.log(nonewordcount + ' is the count');

                for(var i = 0; i < wordcount; i++) {

                    for(var t = 0; t < nonewordcount; t++) {
                        if(words[i] == nonewords[t]) {
                            message('No swearing please! <br><br> This post will not succeed!<br><br> Please remove it before you continue!', '430');
                            }
                        }
            }
            });

      }); 
```

上面的代码计算字符数并检查每个单词。我是否愿意并且我尝试过但没有成功是让它好像空间用完了。但是我一直无法使用与限制器相同的代码来实现它？

这是新代码。但仍然无法正常工作：

```
 $(function() {
            $('#ideacomment').bind('keyup', function(e){
                var characterLimit = 300;
                charactersUsed = $(this).val().length;

                if(charactersUsed > characterLimit){
                    charactersUsed = characterLimit;
                    $(this).val($(this).val().substr(0, characterLimit));
                    $(this).scrollTop($(this)[0].scrollHeight);
                }
                var charactersRemaining = characterLimit - charactersUsed;
                $('#remainingCharacters').html(charactersRemaining);

                 var nonewords = new Array("hey", "you");
                 var nonewordcount = nonewords.length;
                 for(var t = 0; t < nonewordcount; t++) {
                     if ($(this).val().indexOf(nonewords[t]) != -1) {
                        message('No swearing please! <br><br> This post will not succeed!<br><br> Please remove it before you continue!', '430');
                         var keycode = e.charCode || e.keyCode;
                            console.log(keycode);
                            if (keycode !== 8 && keycode !== 46)
                                return false;
                                }   
    }

                 });
            }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:13:02.187

您可以检查正在按下哪个键，如果它不是 a`Backspace`或则阻止它`Delete`。这是一个简化的示例：

```
$(function() {
    $('#textbox').keydown(function(e) {
        if ($(this).val().indexOf('test') != -1) {
            var keycode = e.charCode || e.keyCode;
            if (keycode !== 8 && keycode !== 46)
                return false;
        }
    });
});​ 
```

**[jsFiddle 演示](http://jsfiddle.net/CpTFd/)**

由于您似乎已经有了文本检查和通知部分，所以您真正缺少的只是按键阻止部分。

# google-chrome - 如何在本地测试 Chromium/Chrome 扩展的内联安装？

> ID：11908413
> 
> 赞同：11
> 
> 时间：2012-08-10T19:57:20.667
> 
> 标签：google-chrome, google-chrome-extension

我正在尝试根据本文档（[https://developers.google.com/chrome/web-store/docs/inline_installation](https://developers.google.com/chrome/web-store/docs/inline_installation)）测试 Chrome Webstore 的内联安装功能。我正在本地开发它以进行测试，并且不能轻松且经常将我的更改推送到现场。

我如何在本地测试内联安装，因为内联安装取决于您在网站管理员工具中验证的网站？

**代码**

```
if (!chrome.app.isInstalled) {
    chrome.webstore.install(undefined, undefined, function(err) {
        console.log(err);
    });
} 
```

这将返回：

```
Installs can only be initiated by the Chrome Web Store item's verified site 
```

显然 localhost 不是经过验证的站点。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-11T08:35:15.990

来自[Google 的使用内联安装指南](https://developers.google.com/chrome/web-store/docs/inline_installation)：“请注意，如果您验证域的所有权（例如[http://example.com](http://example.com)），您可以从任何子域或页面启动内联安装”。

因此，如果您确实拥有一个域，您可以验证它，然后模拟您的本地计算机是您验证域的子域。

例如，如果您向 Google 验证域 example.com，则可以在 hosts 文件中包含以下内容：

```
127.0.0.1 local.example.com 
```

然后您可以通过[http://local.example.com](http://local.example.com)访问您的本地服务器（可能需要在您的本地网络服务器上进行一些配置）。如果您将 Chrome Webstore 中的项目与 example.com 相关联，您将能够从本地页面开始内联安装。

# jquery - 对控制器中定义的方法的 Ajax 调用返回 [object Object]

> ID：11908419
> 
> 赞同：0
> 
> 时间：2012-08-10T19:57:57.903
> 
> 标签：jquery, ruby-on-rails, ajax, callback

我正在关注这个[SO 答案](https://stackoverflow.com/a/5933309/1393002)，所以我试图调用我定义的这个方法：

```
class IngredientsController < ApplicationController
  ...
  def get_restaurant_id(menu_id)
    Menu.find_by_id(menu_id).restaurant_id.to_i
  end 
```

通过 AJAX 调用：

```
m_id = $('#dish_menu_id').val()
$.ajax "/ingredients/get_restaurant_id(" + m_id + ")" 
```

我已经这样定义了我的**routes.rb**：

```
resources :ingredients do
  get :get_restaurant_id, on: :collection
end 
```

但我`console.log($.ajax "/ingredients/get_restaurant_id(" + m_id + ")")`显示此错误消息：

```
GET http://localhost:3000/ingredients/get_restaurant_id(1) 404 (Not Found) 
```

**我不确定我做错了什么。`m_id`还有另一种通过 AJAX 调用传递参数的方法吗？**

**理想情况下，我希望 AJAX 调用返回餐厅 ID 的整数值。**

PS——这是我在[最初的 SO 帖子](https://stackoverflow.com/questions/11906452/how-to-make-a-simple-sql-query-in-jquery-to-find-one-id-from-another)中提出的关于我试图克服的问题的替代解决方案。

* * *

## 编辑 1

我现在对使用 GET/POST 所做的事情有了更好的理解（我希望），所以我重新定义了我的方法：

**成分控制器.rb**

```
def get_restaurant_id
  Menu.find_by_id(params[:m_id]).restaurant_id
end 
```

但我得到一个`Template is missing`and `500 Internal Server Error`。

我知道这没有模板。那么有什么方法可以让它执行一个简单的 SQL 查询来获取餐厅 ID 并将其返回给 Ajax 调用？

所以我的 Ajax 调用现在看起来像这样：

```
$.ajax "/ingredients/get_restaurant_id?m_id=" + m_id 
```

* * *

## 编辑2：几乎就在那里

我将方法更改为：

```
def get_restaurant_id
  menu_id = params[:m_id]    
  r_id = Menu.find_by_id(params[:m_id]).restaurant_id.to_s
  render :json => r_id 
end 
```

现在在我的 Ajax 中，我得到了一个`Object`在该`responseText`领域内有答案的答案，但我似乎无法访问它。

我试过这个：

```
r_id = $.ajax "/ingredients/get_restaurant_id?m_id=" + m_id
alert "After call to get_restaurant_id " + r_id.responseText 
```

但把它当作`undefined`.

我的`Object`控制台日志中的内容如下所示：

```
...
readyState: 4
responseText: "1"
setRequestHeader: function ( name, value ) {
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:36:52.617

我能够弄清楚。这是我所做的：

**restaurant_controller.rb**

```
def get_restaurant_id 
  r_id = Menu.find_by_id(params[:m_id]).restaurant_id.to_s
  render :json => r_id 
end 
```

由于我将我的方法移动到`restaurants_controller`from 中`ingredients_controller`，因此请确保您也更新您的`routes.rb`方法以反映此更改。所以它看起来像这样：

```
resources :restaurants do
  get :get_restaurant_id, on: :collection
end 
```

我的 jQuery/Ajax 现在看起来像这样：

```
m_id = $('#dish_menu_id').val() # To get the menu_id from the dropdown menu
r_id = "" # restaurant_id variable

# Call my get_restaurant_id method
request = $.ajax
  type: 'GET'
  url: "/restaurants/get_restaurant_id?m_id=" + m_id
  async: false
  success: (text) ->
    r_id = text

  console.log(request) # Just for programming purpose to show what I'm getting from AJAX 
```

现在你`r_id`将持有的整数值`restaurant_id`

# php - 尝试使用 PHP 从日历中获取事件列表

> ID：11908420
> 
> 赞同：2
> 
> 时间：2012-08-10T19:57:59.157
> 
> 标签：php, google-api, google-calendar-api

我正在尝试从日历中获取事件列表。我正在查看developers.google.com/google-apps/calendar/v3/reference/calendarList/list

我假设 $service 是从 $cal = new apiCalendarService($client); 创建的 该文档不是很具体。

当我尝试执行下面的代码时，我收到错误 PHP Fatal error: Call to a member function getItems() on a non-object

但如果我这样做，它会起作用

```
$calendarList = $cal->calendarList->listCalendarList();
print "<h1>Calendar List</h1><pre>" . print_r($calendarList, true) . "</pre>"; 
```

另外，如果我尝试示例代码@

developers.google.com/google-apps/calendar/v3/reference/events/list#examples 我得到了同样的错误 PHP 致命错误：调用非对象上的成员函数 getItems()

这有效：

```
$events = $cal->events->listEvents('rtparies@gmail.com');    print "<h1>Events</h1><pre>" . print_r($events, true) . "</pre>";[/PHP] 
```

这失败了：

```
foreach($events->getItems()as $event){
echo $event->getSummary(); 
```

}

我无法想象所有这些例子都是不好的，所以对我做错了什么有什么建议吗？

示例如下：

```
$calendarList = $service->calendarList->listCalendarList();
while(true){
  foreach($calendarList->getItems()as $calendarListEntry){
      echo $calendarListEntry->getSummary();
   }
  $pageToken = $calendarList->getNextPageToken();
  if($pageToken){
      $optParams = array('pageToken'=> $pageToken);
      $calendarList = $service->calendarList->listCalendarList($optParams);
  }else{
      break;
  }
} 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-14T17:13:52.793

您需要`$calendarList`像当前代码那样获取对象，而不是数组。

利用

```
$client->setUseObjects(true); 
```

就在之前

```
$service = new apiCalendarService($client); 
```

解释：

```
$events = $cal->events->listEvents('rtparies@gmail.com'); 
```

返回一个数组。如果您不需要对象进行进一步处理，这将是可以的。

由于需要对象，因此需要将对象的使用设置为 true：

```
$client->setUseObjects(true); 
```

现在，

```
$events = $cal->events->listEvents('rtparies@gmail.com'); 
```

仍在工作，唯一的区别是您现在有一个对象，您可以将其用于此行下方的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T16:01:23.647

尝试更新您的代码：

```
 foreach($calendarList->getItems()as $calendarListEntry){
    echo '<h1>event->getSummary()='.$event->getSummary().'</h1>';
    $client->setUseObjects(true);   
    $events = $cal->events->listEvents($event->id);
    echo 'events=<pre>'; print_r($events); echo '</pre>';       
 } 
```

# php - mysql中的重复票号

> ID：11908421
> 
> 赞同：0
> 
> 时间：2012-08-10T19:58:16.863
> 
> 标签：php, mysql

我想查找我的表中是否有任何重复的票号。我下面的代码显示了类表中的第一个票号，即 1039，如果有重复，我想显示。1039 不是重复的。我的问题是什么？

```
$query = "SELECT ticket, COUNT(ticket) AS NumOccurrences FROM classes GROUP BY ticket HAVING (COUNT(ticket) > 1)";
$result = mysql_query($query) or die(mysql_error());    
while($row = mysql_fetch_array($result))    
{
$ticket = $row['ticket'];
}

if($result)
{
echo $ticket. "<br/>";
echo "there are " . mysql_num_rows($result) . " tickets ";
}

else
{
echo "no duplicate ";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:02:22.303

您需要一个`GROUP BY`条款，否则您将计算所有门票。

```
SELECT ticket, COUNT(*) c FROM classes GROUP BY ticket HAVING (c > 1) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-10T20:02:42.617

尝试

```
SELECT ticket, COUNT(ticket) as `count` FROM classes GROUP BY ticket WHERE `count` > 1 
```

# orbeon - 使用 Orbeon 访问以前版本的表单定义

> ID：11908422
> 
> 赞同：1
> 
> 时间：2012-08-10T19:58:19.233
> 
> 标签：orbeon, xforms

Orbeon 似乎不支持表单版本控制。当对表单定义进行更改时，表单构建器将仅显示表单的最新版本。我们正在使用 MySql 来存储我们的数据，我注意到表单定义没有在数据库中被覆盖。新行添加了一个新的时间戳。

我们的一个要求是表单的旧版本必须是可跟踪的。至少我们需要能够查看旧版本的表单。如何才能做到这一点？我能想到的唯一方法是在每次更新表单定义时创建一个以修订命名的表单实例。有没有人找到更好的方法来处理 Orbeon 中的版本控制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T00:24:44.423

目前，包括即将推出的 Orbeon Forms 4.0，Orbeon Forms 中没有适当的表单版本控制功能（但我们[对如何实现这一点有一些想法](http://wiki.orbeon.com/forms/projects/form-runner-builder/form-builder-versioning)）。

如果您想要的是使用给定版本的表单定义输入的表单数据始终加载相同版本的表单定义，那么不幸的是，该功能不存在。

现在，正如您在使用 MySQL 或 Oracle 时注意到的那样，表单数据和表单定义实际上从未从数据库中删除。但这更像是一种审计功能，而不是版本控制功能。有了这个，如果您只想查找或恢复旧版本的表单，您可以使用 SQL 查询来执行此操作。

# java - Java 允许将 int 隐式转换为 float。为什么？

> ID：11908429
> 
> 赞同：9
> 
> 时间：2012-08-10T19:58:31.640
> 
> 标签：java

在 Java 中，我们可以将 int 隐式转换为 float，这可能会导致精度损失，如下面的示例代码所示。

```
public class Test {
    public  static void main(String [] args) {
        int intVal = 2147483647;
        System.out.println("integer value is " + intVal);
        double doubleVal = intVal;
        System.out.println("double value is " + doubleVal);
        float floatVal = intVal;
        System.out.println("float value is " + floatVal);
        }
} 
```

输出是

```
integer value is 2147483647
double value is 2.147483647E9
float value is 2.14748365E9 
```

当精度损失时，允许将 int 隐式转换为 float 的原因是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T20:05:48.847

你可能想知道：

> 为什么在丢失信息时这是一种*隐式转换？*这不应该是*显式*转换吗？

你当然有一个很好的观点。但是语言设计者决定，如果目标类型的范围足够大，则允许隐式转换，即使可能会损失精度。请注意，重要的是*范围*，而不是精度。float 比 int 具有更大的范围，因此它是一种隐式转换。

[Java 规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.1.2)说明如下：

> int 或 long 值到 float 或 long 值到 double 的扩大转换可能会导致精度损失 - 也就是说，结果可能会丢失值的一些最低有效位。在这种情况下，生成的浮点值将是整数值的正确舍入版本，使用 IEEE 754 舍入到最近模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-26T01:16:33.120

将整数类型转换为使用相同位数的浮点类型可能会导致精度损失，但会自动完成。“精度损失”意味着一些不太重要的数字可能会变成零，但最重要的数字和数字的大小将保持不变。回想一下，浮点数只有大约七个十进制数字的精度。例如，将 int 123456789 转换为 float 123456700.0 会降低精度。

# sql - MS Access SQL 查询 - 查询表达式中的语法错误（缺少运算符）

> ID：11908441
> 
> 赞同：4
> 
> 时间：2012-08-10T19:59:52.447
> 
> 标签：sql, database, vba, ms-access, vbscript

我试图了解为什么我的查询（如下）在运行时在 MS Access Sql 查询编辑器（sqlview）中显示错误消息。

```
SELECT *
FROM tblUSPS
INNER JOIN   tblProductUSPS 
ON tblProductUSPS.[PRODUCTUSPS_USPS] = tblUSPS.[USPS_CODE] 
INNER JOIN  tblAttribute 
ON tblUSPS.USPS_ID = tblAttribute.ATTRIBUTE_USPSID 
```

据我所知，如果我删除任何一个 INNER 连接行，则下面的脚本。例如，此脚本运行时没有错误

```
SELECT *
FROM tblUSPS
INNER JOIN   tblProductUSPS 
ON tblProductUSPS.[PRODUCTUSPS_USPS] = tblUSPS.[USPS_CODE] 
```

这也是

```
SELECT *
FROM tblUSPS  
INNER JOIN  tblAttribute ON tblUSPS.USPS_ID = tblAttribute.ATTRIBUTE_USPSID 
```

但是当我合并时，出现了问题，我无法找到它，所以我需要一些帮助来识别它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-10T20:02:32.497

Access 对括号有强烈的意见。

```
SELECT *
  FROM 
(tblUSPS
INNER JOIN   tblProductUSPS 
   ON tblProductUSPS.[PRODUCTUSPS_USPS] = tblUSPS.[USPS_CODE] )
INNER JOIN  tblAttribute 
   ON tblUSPS.USPS_ID = tblAttribute.ATTRIBUTE_USPSID 
```

# memory - 内存和数据组装

> ID：11908442
> 
> 赞同：0
> 
> 时间：2012-08-10T19:59:53.463
> 
> 标签：memory, assembly

我无法弄清楚在汇编表中的不同情况下如何处理数据。

我有以下简单的程序：

```
section .data
        Digits:  db "0123456789ABCDEF"
        Sums:    dd 15,12,6,0,21,14,4,0,0,19
        Sums2:   db 15,12,6,0,21,14,4,0,0,19

section .text   
global _start

_start:
    nop                    ; Put your experiments between the two nops...
    mov ecx,2
    mov al, byte [Sums+ecx*2]
    mov bl, byte [Sums2+ecx*2]
    mov dl, byte [Digits+ecx*2]
    nop 
```

现在，当我逐条调试它时，我查看寄存器并且无法理解发生了什么。

```
rcx --> as expected it contains the decimal 2
rdx --> as expected it contains the hexadecimal 34 which represents the decimal 4
rax --> has c which represents new page
rbx --> has 15 which represents negative acknowledge (NAK character) 
```

我希望在 rax 中找到 6 个，在 rbx 中找到 1 个。我无法弄清楚为什么它没有发生。我在一个小端架构上。谢谢

# html5-video - 将视频从多个摄像头流式传输到 html5 播放器

> ID：11908443
> 
> 赞同：0
> 
> 时间：2012-08-10T20:00:00.793
> 
> 标签：html5-video, h.264, red5, ogg, webm

我试图找出一种方法，让服务器具有通过 USB（火线，等等）连接的摄像头（或多个摄像头），然后将视频流式传输给用户。

到目前为止的想法是拥有一个 red5 服务器，它将摄像头馈送作为 H.264 流进行流式传输，并让一个 Html5 播放器（如带有 Flash 后备的 VideoJS）播放视频。[查看http://en.wikipedia.org/wiki/HTML5_video#Browser_support](http://en.wikipedia.org/wiki/HTML5_video#Browser_support)上的浏览​​器支持图表，我可以看到我还需要 WebM 和/或 Ogg 流。

关于如何做到这一点的任何建议？是否可以通过某些（首选 .NET）Web 应用程序路由流并动态重新编码视频？虽然我猜这需要一些强大的硬件 :) 是否有另一台支持所有三种格式的媒体服务器？

谢谢你的想法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:26:29.443

您可以使用 IceCast 服务器。通过 ffmpeg2theora 将相机的输出转换为 Ogg，并通过 oggfwd 将其通过管道传输到 IceCast。然后让 HTML5 <video> 从 IceCast 服务器播放。为我工作的 Firefox。

例如

# 将 DVB-T 接收器调入频道

(tzap -c channels-4.conf -r "TV Rijnmond" > /dev/null 2>&1 &)

# 将 DVB-T 输出转换为 Ogg 并通过管道转换为 IceCast

ffmpeg2theora --no-skeleton -f mpegts -a 0 -v 5 -x 320 -y 240 -o /dev/stdout /dev/dvb/adapter0/dvr0 2>/tmp/dvb-ffmpeg.txt | oggfwd 127.0.0.1 8000 w8wood /cam3.ogg > /tmp/dvb-oggfwd.txt 2>&1

# ruby-on-rails - 带有葡萄的 Rails 中的仅 API 应用程序？

> ID：11908451
> 
> 赞同：3
> 
> 时间：2012-08-10T20:00:41.760
> 
> 标签：ruby-on-rails, ruby-on-rails-3, api, grape-api

我有一个关于 Grape 用于构建仅 API 的 rails 应用程序的问题。正如我在 github 文档中所读到的，Grape 可以作为 API 安装在现有的 rails 应用程序中。是否可以用它编写仅 API 的应用程序？我是对的，我在使用 Grape 时不再需要 Rails 控制器了吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T23:25:49.387

你说的对。

另外，如果我没记错的话，你甚至根本不需要 Rails。Grape 是一个可以独立运行的微框架。但是，如果您计划扩展并合并活动记录/模型等，则可以安装 Grape 并按照自己的步调进行扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T18:46:20.120

是的。葡萄在机架上工作。有关示例，请参见[https://github.com/dblock/grape-on-rack 。](https://github.com/dblock/grape-on-rack)

# excel - Excel 宏选择整个表格行，剪切并粘贴到另一个表格，然后删除原始行

> ID：11908453
> 
> 赞同：0
> 
> 时间：2012-08-10T20:00:47.373
> 
> 标签：excel, vba

我正在尝试创建一个将执行以下操作的宏：

1.  识别我的活动单元格并选择这些单元格的整个表格行。剪掉所有这些行。
2.  将它们粘贴到不同工作表上的另一个表中（在表的末尾添加到已经存在的任何内容）。
3.  返回原始工作表并删除现在为空的行。

我对VBA有很好的了解。我能够根据我的活动单元格选择整行。但如果我选择多个单元格（例如，B4、B5 和 B6），它只会选择一行而不是全部三行。此外，我一直无法让它只选择表格行，而不是整个行。

这是我开始使用的第一行代码。但它没有 A：选择多行或 B：仅选择表格的行单元格。

```
ActiveCell.EntireRow.Select 
```

任何和所有的帮助将不胜感激。即使只是对上述部分步骤的帮助也可以帮助我。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:56:35.863

```
Sub Tester()

Dim rng As Range

    Set rng = Application.Intersect(Selection.EntireRow, _
                    Selection.Parent.ListObjects(1).Range)

    If Not rng Is Nothing Then
        'rng.Font.Color = RGB(255, 0, 0) 'do something with rng
    End If

End Sub 
```

# php - 每行仅显示 3 个 foreach 结果

> ID：11908454
> 
> 赞同：1
> 
> 时间：2012-08-10T20:00:51.637
> 
> 标签：php, foreach

我的脚本如下

```
$output="<table class='products'><tr>"; 
while($info = mysql_fetch_array( $data )) { 
    //Outputs the image and other data
    $output.= "<td>
    <img src=http://localhost/zack/sqlphotostore/images/"   .$info['photo'] ." width=323px ></img> 
    <b>Name:</b> ".$info['name'] . "
    <b>Email:</b> ".$info['email'] . " 
    <b>Phone:</b> ".$info['phone'] . "</td> "; 
}
$output.="<tr></table>";
print $output;
?> 
```

它以长水平线显示所有结果我如何打破结果，以便它们在 3 次计数后显示在新行中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:08:36.030

保留一个计数器，每3张图片输出一个新的表格行

```
$output="<table class='products'>"; 

$counter = 0;
while($info = mysql_fetch_array( $data )) 
{  
    if( $counter % 3 == 0 )
        $output .= '<tr>';

    $output .= "<td>";
    $output .= "<img src=http://localhost/zack/sqlphotostore/images/".$info['photo'] ." width=323px ></img>";
    $output .= "<b>Name:</b> ".$info['name'];
    $output .= "<b>Email:</b> ".$info['email'];
    $output .= "<b>Phone:</b> ".$info['phone']."</td> ";

    if( $counter % 3 == 0)
         $output .= "</tr>";

    $counter++;
}
$output.="</table>";
print $output;
?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T20:04:54.533

添加一个计数器并在每次达到 3 的倍数时开始一个新行。

```
$counter = 0;
while($info = mysql_fetch_array($data)) {
   if ($counter++ % 3 == 0) {
       if ($counter > 0) {
           $output .= "</tr>";
       }
       $output .= "<tr>";
   }
   // stuff
}
if ($counter > 0) {
    $output .= "</tr>";
}

$output .= "</table>"; 
```

**请注意：**它可能无助于回答您的问题，但您应该停止使用`mysql_*`函数。它们正在被弃用。而是使用[PDO](http://php.net/manual/en/book.pdo.php)（从 PHP 5.1 开始支持）或[mysqli](http://php.net/manual/en/book.mysqli.php)（从 PHP 4.1 开始支持）。如果您不确定要使用哪一个，[请阅读这篇文章](http://net.tutsplus.com/tutorials/php/pdo-vs-mysqli-which-should-you-use/)。

# sql - 现有表上的派生/计算列

> ID：11908456
> 
> 赞同：1
> 
> 时间：2012-08-10T20:00:56.613
> 
> 标签：sql, sql-server, tsql, calculated-columns

我已经为这个问题发疯了一段时间，我正在寻求帮助。

我有带有值的 SQL Server 表，如下所示：

```
Account - Date - Amount - Summary 
10000 - 2010-1-1 - 50.00 - 0.00 
10000 - 2010-2-1 - 50.00 - 0.00 
10000 - 2010-3-1 - 50.00 - 0.00 
10000 - 2010-4-1 - 50.00 - 0.00 
10000 - 2010-5-1 - 50.00 - 0.00 
10000 - 2010-6-1 - 50.00 - 0.00 
10000 - 2010-7-1 - 50.00 - 0.00 
10000 - 2010-8-1 - 50.00 - 0.00 
10000 - 2010-9-1 - 50.00 - 0.00 
10000 - 2010-10-1 - 50.00 - 0.00 
10000 - 2010-11-1 - 50.00 - 0.00 
10000 - 2010-12-1 - 50.00 - 600.00 
10000 - 2011-1-1 - 25.00 - 0.00
10000 - 2011-2-1 - 25.00 - 0.00
10000 - 2011-3-1 - 50.00 - 0.00
10000 - 2011-4-1 - 50.00 - 0.00
10000 - 2011-5-1 - 50.00 - 0.00
10000 - 2011-12-1 - 25.00 - 825.00
10000 - 2012-1-1 - 100.00 - 0.00
10000 - 2012-2-1 - 200.00 - 0.00
10000 - 2012-3-1 - 100.00 - 0.00
10000 - 2012-5-1 - 100.00 - 0.00
10000 - 2012-6-1 - 100.00 - 0.00
10000 - 2012-8-1 - 100.00 - 0.00
10000 - 2012-12-1 - 100.00 - 1625.00
10001 - 2010-1-1 - 50.00 - 0.00 
10001 - 2010-2-1 - 60.00 - 0.00 
10001 - 2010-12-1 - 60.00 - 170.00 
10001 - 2011-1-1 - 50.00 - 0.00
10001 - 2011-2-1 - 50.00 - 0.00
10001 - 2011-3-1 - 50.00 - 0.00
10001 - 2011-4-1 - 50.00 - 0.00
10001 - 2011-6-1 - 50.00 - 0.00
10001 - 2011-8-1 - 50.00 - 0.00
10001 - 2011-10-1 - 50.00 - 0.00
10001 - 2011-12-1 - 50.00 - 570.00 
```

这是表的基本快照。“摘要”列给出了年底“金额”的总数（基于“日期”列），但仅当 MONTH(Date) = '12' 时。数百个帐户都以这种方式进行，大约还有 4 年的时间。我想在这个现有表中添加一列，名为“SummaryPreviousYear”。SummaryPreviousYear 列应包含 MONTH(Date) = '12' 和上一年的金额之和。我想在帐号上加入此列，以便它位于摘要列旁边并提供一个值，就像摘要值一样，但 SummaryPreviousYear 值需要在整个列中出现，而不是就在月份是 12 的地方。例如，以下行：

前：

```
Account - Date - Amount - Summary 
10001 - 2011-10-1 - 50.00 - 0.00
10001 - 2011-12-1 - 50.00 - 570.00 
```

后：

```
Account - Date - Amount - Summary - SummaryPreviousYear
10001 - 2011-10-1 - 50.00 - 0.00 - 170.00
10001 - 2011-12-1 - 50.00 - 570.00 - 170.00 
```

谁能帮我这个？我在这里拉了两天的头发，需要创建这个数据集，这样我才能继续我的报告开发。不幸的是，DBA 不在现场。从字面上看，我无能为力。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:12:36.773

为什么要为数据库中的每一行复制此摘要和上一年的摘要数据？这是浪费和不必要的。最好有另一个包含前一年摘要的表，每年一行，您可以加入到该表中。而且，我认为根本不需要摘要列。为什么不创建一个在月份为 12 时计算摘要的视图，并为任何不等于 12 的月份返回零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:13:31.500

```
SELECT 
    t.Account,
    t.Date,
    t.Amount,
    t.Summary,
    s.Summary as SummaryPreviousYear
FROM TestTable t    
JOIN (
    SELECT
        Account,
        DATEPART(YEAR, Date) as Year,
        SUM(Amount) as Summary
    FROM TestTable
    GROUP BY Account, DATEPART(YEAR, Date)
) s
    ON s.Account = t.Account
    AND s.Year = DATEPART(YEAR, Date) - 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:18:20.680

```
SELECT    l.*, 
          q.summary AS SummaryPreviousYear
FROM      lists l
LEFT JOIN 
     (
          SELECT    Date, 
                    Summary
          FROM      lists 
          WHERE     MONTH(Date) = 12
     ) AS q  
          ON YEAR(l.Date) = YEAR(q.Date) + 1 
```

# javascript - window.returnValue 为 IE7 返回 undefined

> ID：11908457
> 
> 赞同：1
> 
> 时间：2012-08-10T20:01:09.327
> 
> 标签：javascript, internet-explorer, internet-explorer-7

我正在编写一个 Intranet 系统，我必须使用 IE 7。

在 IE7 中有一个名为“window.showmodaldialog”的方法，它应该返回在模式中传递的值，如：window.returnValue =“some string”。

我的代码是 index.jsp

```
var result = window.showmodaldialog(url) 
```

模态的.jsp：

```
window.returnValue = "some string" 
```

但是当我关闭模式时，“结果”变量总是未定义的。域和协议相同。并且 window.opener 是未定义的。

在 modal.jsp 中，遗留系统会进行一些刷新和重定向，我们必须保持这种方式。这是问题吗？如果是，有办法解决吗？我真的需要继续使用window.returnValue，因为系统可以打开其他我没有源的模型。

编辑：添加有关 modal.jsp 的更多信息：

```
 var jsonReturn = {"one_tag": "some value", "id": "id"};
 jsonReturn = JSON.stringify(jsonReturn);
 window.returnValue = jsonReturn;
 window.close(); 
```

一些选择框向modal.jsp提交表单，使得页面刷新。

# android - 需要来自 xml 属性自定义小部件的图像 ID

> ID：11908458
> 
> 赞同：4
> 
> 时间：2012-08-10T20:01:12.057
> 
> 标签：android, android-drawable, custom-widgets, android-custom-attributes

我有一个自定义控件（现在非常简单），就像一个按钮。它需要显示未按下和按下的图像。它在活动中出现多次，并且根据使用的位置具有不同的图像对。想想工具栏图标 - 与此类似。

这是我的布局的摘录：

```
<TableLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  xmlns:MyApp="http://schemas.android.com/apk/res/com.example.mockup"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent" >

  <TableRow>
    <com.example.mockup.ImageGestureButton
      android:id="@+id/parent_arrow"
      android:src="@drawable/parent_arrow"
      MyApp:srcPressed="@drawable/parent_arrow_pressed"
      ... />
     ...
  </TableRow>
</TableLayout> 
```

attrs.xml：

```
<?xml version="1.0" encoding="utf-8"?> 
<resources> 
    <declare-styleable name="ImageGestureButton"> 
        <attr name="srcPressed" format="reference" /> 
    </declare-styleable> 
</resources> 
```

而且，在 R.java 中，人们发现：

```
public static final class drawable {
    public static final int parent_arrow=0x7f020003;
    public static final int parent_arrow_pressed=0x7f020004;
    ...
} 
```

在小部件实例化期间，我想确定活动 xml 中声明的 id。我怎么做？我已经尝试过了（我用工作代码更新了我的原始帖子；所以，以下工作。）

```
public class ImageGestureButton extends ImageView
   implements View.OnTouchListener
{
  private Drawable unpressedImage;
  private Drawable pressedImage;

  public ImageGestureButton (Context context, AttributeSet attrs)
  {
    super(context, attrs);
    setOnTouchListener (this);

    unpressedImage = getDrawable();

    TypedArray a = context.obtainStyledAttributes (attrs, R.styleable.ImageGestureButton, 0, 0);
    pressedImage = a.getDrawable (R.styleable.ImageGestureButton_srcPressed);
  }

  public boolean onTouch (View v, MotionEvent e)
  {
    if (e.getAction() == MotionEvent.ACTION_DOWN)
    {
      setImageDrawable (pressedImage);
    }
    else if (e.getAction() == MotionEvent.ACTION_UP)
    {
      setImageDrawable (unpressedImage);
    }

    return false;
  }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-10T23:10:15.327

如果你想获得可绘制使用[TypedArray.getDrawable()](http://developer.android.com/reference/android/content/res/TypedArray.html#getDrawable%28int%29)。在您的示例中，您使用的是 getString()。

在您的`declare-styleable`使用中

```
 <attr name="srcPressed" format="reference" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-26T22:02:16.200

如果你想要 Drawable 的实际资源 ID，而不是完全解析的 Drawable，你可以这样做：

```
TypedArray a = context.obtainStyledAttributes( attrs, R.styleable.FooLayout );
TypedValue value = new TypedValue();
a.getValue( R.styleable.FooLayout_some_attr, value );
Log.d( "DEBUG", "This is the actual resource ID: " + value.resourceId ); 
```

# jquery - 如果用户单击单个记录，防止多选输入框取消选择所有选项

> ID：11908463
> 
> 赞同：1
> 
> 时间：2012-08-10T20:01:28.620
> 
> 标签：jquery

如果用户在不使用按钮的情况下单击单个记录，是否有办法防止多选输入框取消选择所有选项`Ctrl`？

这样，他们必须单击列表中的项目以打开或关闭它，并且其他值将始终保持选中或未选中，除非用户明确单击它们以切换其选定状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:12:05.283

您可以钩住选项单击，然后如果没有选择，请重新选择该项目：

```
$("option").click(function (e) 
    {
        if ($(this).attr("selected") != "selected")
        {
            if($(this).parent().find("option:selected").length == 0)
                $(this).attr("selected", "selected");
        }           
    });​ 
```

小提琴：http: [//jsfiddle.net/johnkoer/7GZkL/12/](http://jsfiddle.net/johnkoer/7GZkL/12/)

# android - Android：ViewFlipper 重置我的选取框 TextView

> ID：11908471
> 
> 赞同：5
> 
> 时间：2012-08-10T20:02:15.943
> 
> 标签：android, textview, viewflipper

我的应用程序包含一个 ViewFlipper，并且在同一个活动中，一个 TextView 中的选取框文本。TextView 不在 ViewFlipper 内。ViewFlipper 稍后以编程方式填充。当 Viewflipper 转换发生时，选框文本重置，返回到初始位置......谁知道为什么会发生这种情况？我该如何解决？

```
//VIEWFLIPPER
<ViewFlipper
            android:id="@+id/vfHome"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:flipInterval="5000" >
        </ViewFlipper>

//...

//MARQUEE TEXT
<TextView
            android:id="@+id/tvHome"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:clickable="true"
            android:ellipsize="marquee"
            android:focusable="true"
            android:focusableInTouchMode="true"
            android:gravity="center_vertical"
            android:lines="1"
            android:marqueeRepeatLimit="marquee_forever"
            android:paddingTop="2dp"
            android:paddingLeft="5dp"
            android:paddingRight="5dp"
            android:scrollHorizontally="true"
            android:scrollbars="horizontal"
            android:singleLine="true"
            android:text=""
            android:textColor="#EEE"
            android:textSize="13dp" >
        </TextView> 
```

谢谢

# matlab - 在 matlab 中使用可视化 C++ 编译器

> ID：11908473
> 
> 赞同：0
> 
> 时间：2012-08-10T20:02:21.200
> 
> 标签：matlab, compiler-construction, loadlibrary

我在 Matlab 中安装了两个编译器：LCC 和 Visual C++ 2008

我想在 matlab 中加载一个 C++ 头文件，但是当我想这样做时，matlab 使用 LCC 而不是

Visual C++ 并给我一些警告。

我用了：

```
 mex -setup
 mbuild -setup 
```

但是 Matlab 仍然使用 LCC 来加载我的 C++ 头文件

```
>> loadlibrary('DLLing.dll', 'DLLTutorial.h') 
```

警告：来自 C 预处理器的消息：

lcc 预处理器错误：C:\Users\MAHNAZ\Documents\MATLAB\DLLTutorial.h:3 找不到包含文件

我怎么能对使用 Visual c++ 编译器而不是 LCC 的 Matlab 说？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:18:50.243

您使用的是什么版本的 MatLab？它可能不假设您在计算机上安装的 Microsoft SDK 的版本。这不是一个真正的答案，但我还不能发表评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T04:07:08.547

根据您的描述，在您键入 之后`mex -setup`，MATLAB 应该问您的第一件事是：

```
Please choose your compiler for building external interface (MEX) files:
Would you like mex to locate installed compilers [y]/n? 
```

在此之后，您应该按`y`，然后您应该会看到可用编译器的列表。从他们中选择一个合适的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T11:22:24.017

您使用的是哪个版本的 Windows，它是 32 位还是 64 位（Windows 和安装的 MATLAB 版本都有问题）？

查看 R2008a 的存档文档（您必须登录才能查看该页面），[似乎](http://www.mathworks.com/help/releases/R2008a/techdoc/ref/loadlibrary.html#brkxrbh-1)LOADLIBRARY 在 64 位平台上需要 VS2005（如果它不可用，可能默认为 LCC）。事实是它没有明确说明它如何确定要使用的编译器。（如果你能做到，你可以`edit loadlibrary.m`跟踪执行，看看为什么它最终会调用 LCC 而不是 Visual C++）

将此与[当前](http://www.mathworks.com/help/techdoc/ref/loadlibrary.html)的R2012a 帮助页面进行比较，其中明确指出您必须选择带有`mex -setup`.

请注意，LCC 编译器将不再随未来版本一起提供。

# java - Java: How to mirror console output to file

> ID：11908485
> 
> 赞同：2
> 
> 时间：2012-08-10T20:03:12.387
> 
> 标签：java, file, console, mirror

I need to monitor console output in Java, I have tried several different ways of retrieving the output as it is streamed, but I fell into a few pitfalls (looping the same output, only one part of output being captured, losing output) and have decided to go about it a different way.

I am developing a Java plugin for a server of the popular game, Minecraft, and I need to be able to monitor console output from other plugins.
I think a good way to do this is by redirecting console output to file, and then set up a recurring async task that checks the file, carries out anything it needs to do, and then clears the file for more input. I think I can do this with a simple use of System.setOut(PrintStream stream); and one of the many guides I can find on Google.

But there is a problem, and that is why I am asking here today. I need console output to stay on the console like normal, hence "mirroring". I cannot edit any of the plugins to output somewhere else, it needs to be from what my Java plugin can do and that only. Sure, maybe on every scheduled check on the file I could reprint it all back to the console but that would result in blocks being printed at a time, which would not be ideal. I do hope this is possible. Thank you!

**EDIT:** I don't think I explained fully. "plugins"'s classes are run by the program that I am developing for. I cannot change how classes are run and I cannot change how other plugins print to console. I also do not want to direct console output to files for logging, that idea is only to keep it in a temporary place while it is parsed. Ideally, I need to pass each line of console output to a function (`parseString(String line)`) which carries out operations depending on the contents of the line. Also, I don't understand how I can read stream contents line-by-line properly, so if someone has any idea on how to, please let me know. :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:20:05.660

Capture System.out before changing it, and use [TeeOutputStream](http://commons.apache.org/io/apidocs/org/apache/commons/io/output/TeeOutputStream.html):

```
OutputStream myCaptureStream = ...;
PrintStream original = System.out;
OutptStream outputtee = new TeeOutputStream(originalOut, myCaptureStream);
PrintStream printTee = new PrintStream(outputTee);
System.setOut(printTee); 
```

### Convert output stream (myCaptureStream) to an input stream

*   Use [Java standard library PipedOutputStream](http://docs.oracle.com/javase/6/docs/api/java/io/PipedOutputStream.html): `new PipedOutputStream`; read carefully - you'll need your reader running on another thread.
*   Convert the input stream to a [Reader](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/InputStream.html),
*   and that to a [BufferedReader](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/BufferedReader.html).

BufferedReader gives you a `readLine` method.

Pseudo code:

```
// Feed myCaptureStream to TeeOutputStream
OutputStream myCaptureStream = new PipedOutputStream();

// Prepare to capture data being written to that output stream
InputStream myCaptureAsInputStream = new PipedInputStream(myCaptureStream);
Reader myCaptureReader = new InputStreamReader(myCaptureAsInputStream);
BufferedReader myCaptureBuffered = new BufferedReader(myCaptureReader, 1024);

// This must run on separate reader thread; in spin loop:
myCaptureBuffer.readLine 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T20:16:39.550

You can change the System.out and System.err to be references to your own custom PrintStreams. This solution is cross platform, unlike using a platform specific helper executable such as `tee`.

[Documentation for System.setOut(PrintStream)](http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#setOut(java.io.PrintStream))

You can write your own PrintStream Subclass that looks something like:

```
class MirroringPrintStream extends PrintStream
{
    PrintStream first, second;

    public MirroringPrintStream(PrintStream first, PrintStream second)
    {
        // fail now rather than later
        if (first == null || second == null) throw new NullPointerException();

        this.first = first;
        this.second = second;
    }

    @override
    // methods go here (I do believe there are rather a lot of them, but they will all look the same)
} 
```

You can then use `System.setOut(new MirroringPrintStream(System.out, myLogStream))` where `myLogStream` is the PrintStream you opened to your log file. I'm not sure how this will handle appending to a file that something else periodically truncates, you might want to experiment with that a bit.

All else fails, go to irc.esper.net and ask about it in #risucraft

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:09:32.720

Assuming this is a friendly takeover of console output, why not log to your own stream and mirror that to the console?

# javascript - 通过单击获取表单数据并使用 highchart 中的数据绘制图表

> ID：11908489
> 
> 赞同：-1
> 
> 时间：2012-08-10T20:03:21.320
> 
> 标签：javascript, jquery, highcharts

我想加载表单数据并将其发送到服务器，然后使用返回的数据绘制图表。如果表单的输入字段有默认数据并且我评论它工作正常

```
//$("button").click(function(){ 
```

如果默认文本字段为空，我不会得到任何图表。我尝试了不同的方法，但仍然无法通过单击按钮从表单中加载它。我现在被困了2天。请帮忙。提前致谢。这是代码

```
<script type="text/javascript">
var chart = null;
var dataString = [];
$(document).ready(function() {
    $("button").click(function() {
        $(function() {
            var city1 = $("#city1").val();
            var city2 = $("#city2").val();
            dataString = {
                city1: city1,
                city2: city2
            };

            requestData();
        });
    });

    function requestData() {
        $.ajax({
            url: 'array.php',
            type: 'POST',
            data: dataString,
            success: function(point) {
                var chartSeriesData = [];
                var chartCategory = [];
                $.each(point, function(i, item) {
                    var series_name = item.name;
                    var series_data = item.data2;
                    var cagory = series_name;

                    var series = {
                        name: series_name,
                        data: item.data2
                    };
                    chartSeriesData.push(series);
                    chartCategory.push(series_name);
                });
                chart = new Highcharts.Chart({
                    chart: {
                        renderTo: 'container',
                        defaultSeriesType: 'column',
                    },
                    title: {
                        text: 'Real time data from database'
                    },
                    xAxis: {
                        categories: chartCategory
                    },
                    yAxis: {
                        minPadding: 0.1,
                        maxPadding: 0.1,
                        title: {
                            text: 'Value',
                            margin: 40
                        }
                    },
                    series: chartSeriesData
                });
            },
            cache: false
        });
    }
});​
</script> 
```

这是正文部分

```
<body>

<div id="container" style="min-width: 200px; height: 400px; margin: 0 auto"></div>

<div id="city_form">
  <form name="contact" action="" method="post">
      <label for="city1" id="city1_label">First city</label>
      <input type="text" name="city1" id="city1" size="30" value="Amsterdam" />

      <label for="city2" id="email_label">Second city</label>
      <input type="text" name="city2" id="city2" size="30" value="London" />
      <button>Click me</button> 
  </form>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T06:19:23.047

您在这里做了很多错误的事情，正如wirey指出的那样，其他您必须阻止单击按钮时提交表单。诶？当您单击提交按钮时，其默认操作是提交表单并将您带到`action`页面。您确实附加了一个附加的 eventListener，它会进行此 ajax 调用，然后绘制图表，但该按钮仍将执行其默认操作，即。带你到`action`页面，在你的情况下是同一个页面，所以你甚至没有意识到发生了这样的事情，你可能已经注意到闪烁或页面重新加载？

jQuery 允许通过调用事件对象上的方法来阻止此默认操作，该`preventDefault()`方法作为第一个参数传递给事件侦听器。你可以在这里阅读更多关于它的信息[http://api.jquery.com/event.preventDefault/](http://api.jquery.com/event.preventDefault/) 试试这个，让我们知道它是否有帮助。

HTML

```
<div id="city_form">
  <form name="contact" action="" method="post">
      <label for="city1" id="city1_label">First city</label>
      <input type="text" name="city1" id="city1" size="30" value="Amsterdam" />

      <label for="city2" id="email_label">Second city</label>
      <input type="text" name="city2" id="city2" size="30" value="London" />
      <button id="btnGet">Click me</button>
  </form>
</div> 
```

JS

```
$("#btnGet").click(function(evt) {
    evt.preventDefault();
    var city1 = $("#city1").val();
    var city2 = $("#city2").val();
    var dataString = {
        city1: city1,
        city2: city2
    };
    requestData(dataString);

}); 
```

jsFiddle @ [http://jsfiddle.net/jugal/V5zt9/6/](http://jsfiddle.net/jugal/V5zt9/6/)

# ant - 向没有标签的元素添加 Clearcase 标签的 Ant 脚本

> ID：11908490
> 
> 赞同：1
> 
> 时间：2012-08-10T20:03:26.453
> 
> 标签：ant, clearcase

我正在尝试创建一个 Ant 脚本，它将在 ClearCase 中创建一个标签，然后将该标签应用于最新版本没有标签的任何文件的最新版本。

我正在使用它来创建标签：

```
<ccmklbtype typename="${label.name}" failonerr="false" 
 ordinary="true" comment="${label.comment}"/> 
```

当我使用它来添加标签时：

```
<ccmklabel viewpath="${view.path}" comment="${label.comment}" recurse="true"
 typename="${label.name}" replace="false" version="\main\${side.branch}\LATEST"/> 
```

当然，它是将标签添加到视图路径中的所有内容。我想要的行为是仅在该项目在最新版本上还没有标签时才添加标签。

我可以通过命令提示符执行所需的操作，但我正在尝试查看是否可以通过 Ant 完成。

有没有人有任何想法？

看起来没有办法只标记还没有名字的东西。相反，我将其设置为在 ANT 中使用一个 exec 块，如果它尚未使用之前使用的标签之一进行标记，它将标记任何内容：

```
<target name="add_labels" description="Look for LATEST code that does not have a previous version label already on it.  Skip the 0 generation as that is brought in from a previous release.">
<exec executable="cleartool" dir="${view.path}">
<arg value="find" />
<arg value="." />
<arg value="-ver" />
<arg value="version(\main\${side.branch}\LATEST)&amp;&amp;!version(\main\${side.branch}\0)${history.check}" />
<arg value="-exec" />
<arg value="cleartool mklabel -replace ${label.name} %CLEARCASE_XPN%" />
</exec>
</target> 
```

它似乎在测试中起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:20:09.847

查看 的[手册页`ccmklabel`](http://nantcontrib.sourceforge.net/release/latest/help/tasks/ccmklabel.html)，您会看到：

> `replace bool`
> 如果`true`，则允许在同一分支上替换相同类型的标签。
> 默认值为`false`.

因此`replace=true`，如果一个文件在最新版本上没有标签，它将被放置（或移动到）所述`LATEST`版本。

* * *

在[OP ruminator](https://stackoverflow.com/users/1413502/ruminator)的情况下，他只想在版本还没有标签的情况下添加标签。

2种方法是可能的：

*   `ccmklabel`在已经只选择了您要标记的版本的视图中。
    很难做到，因为配置规范中唯一可用的**[版本选择器](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/version_selector.htm)**`\main\${side.branch}\'{!lbtype(MY_TEST)}`是，它选择未标记为 ' `MY_TEST`' 的最后一个版本（并且不完全符合初始选择标准）

*   不要在 ant 脚本中使用 ccmklabel，直接调用 insteald cleartool find 指令（比视图配置规范更精确，可以组合更多的版本选择器）。
    这就是[OP 反刍者](https://stackoverflow.com/users/1413502/ruminator)在他的问题更新中说明的内容：

find 查询侧重于`LATEST`没有正确标签的版本：

```
<exec executable="cleartool" dir="${view.path}">
  <arg value="find" />
  <arg value="." />
  <arg value="-ver" />
  <arg value="version(\main\${side.branch}\LATEST)&amp;&amp;!version(\main\${side.branch}\0)${history.check}" />
  <arg value="-exec" />
  <arg value="cleartool mklabel -replace ${label.name} %CLEARCASE_XPN%" />
</exec> 
```

# ant - Ant 与 JUnit 任务 - OutOfMemoryError

> ID：11908497
> 
> 赞同：2
> 
> 时间：2012-08-10T20:04:34.473
> 
> 标签：ant, junit, out-of-memory

我有一个有趣的问题。我正在使用 Ant，它通过 build.xml 元素执行 JUnit 测试（由 50 个测试组成的测试套件）。问题是我收到 OutOfMemoryError。

我使用 ANT_OPTS 参数扩大了堆空间，但没有帮助。当我在 Eclipse 中执行相同的测试套件时——一切都很好——由于 GC，内存被释放。

我认为这个问题与 Ant 及其 JUnit 任务有关。

也许记录测试是原因（但另一方面，我有 printsummary="false"，[也许 outputtoformatters 也应该设置为 false ？？？]）。

我的第二个猜测是 TEST***.xml 文件（在测试结束时生成）保存在内存中并在测试结束时刷新。有没有办法减少该文件中的日志？

各位大侠，请给我一些线索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:18:33.427

您需要在 junit 任务中设置 maxmemory 属性。请参阅[Ant 文档](http://ant.apache.org/manual/Tasks/junit.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T12:27:32.773

总而言之，我想说问题的根源在于日志记录。日志被发送到流并且没有被刷新。关闭日志后 - 一切都很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-11T03:05:43.203

默认情况下，fork 模式是关闭的。请尝试打开 fork 模式并将 forkmode 设置为[pertest](http://ant.apache.org/manual/Tasks/junit.html)。

# javascript - 清空并追加元素的扩展高度

> ID：11908498
> 
> 赞同：0
> 
> 时间：2012-08-10T20:04:37.737
> 
> 标签：javascript, jquery

我正在运行这段代码：

```
$('#storeTable').empty();

$('#storeTable').append("<tr>");
$('#storeTable').append("<td>");
$('#storeTable').append(returnData["1"]["ID"]);
$('#storeTable').append("</td>");
$('#storeTable').append("</tr>"); 
```

但是，如果我在一个页面加载中多次运行它，“storeTable”元素会随着每次运行而变得越来越高。我是否遗漏了一些明显的东西，这是 jQuery/JavaScript 的问题，是我的浏览器（Chrome）的错，还是我做错了什么？

代码显然需要改进，我只是想获得页面动态部分的基本实现。

如果您想了解任何其他详细信息，请询问，而不是在不发表评论的情况下投反对票。

storeTable 当然也是一个表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:07:32.007

您不能使用`.append()`附加部分 HTML。. `append()`只附加整个形成的对象，当它附加它们时，它会将它们附加为目标对象的最后一个子对象。

除此之外，一些浏览器正在选择如何在表格中创建/删除内容。

假设`#storeTable`是`<table>`标签，您可以指定`.html()`一次创建一个全新的表：

```
$("#storeTable").html("<tr><td>" + returnData["1"]["ID"] + "</td></tr>"); 
```

工作演示：http: [//jsfiddle.net/jfriend00/5BVdX/](http://jsfiddle.net/jfriend00/5BVdX/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:13:12.457

```
$('#storeTable').empty();

// Will create three rows, one after another
$('#storeTable').append("<tr><td>123</td></tr>");
$('#storeTable').append("<tr><td>456</td></tr>");
$('#storeTable').append("<tr><td>789</td></tr>");

// Will create three rows, each next replaces previous
$('#storeTable').html("<tr><td>123</td></tr>");
$('#storeTable').html("<tr><td>456</td></tr>");
$('#storeTable').html("<tr><td>789</td></tr>"); 
```

# jquery - 使用 Div 保持文本移动

> ID：11908500
> 
> 赞同：0
> 
> 时间：2012-08-10T20:04:39.037
> 
> 标签：jquery, html, css

我正在尝试让图像在滚动时消失——我已经做到了。

然而，正如你[在这里](http://cargocollective.com/btatest)看到的那样，它下面的文本和菜单离图片太远了——当我把浏览器缩小时，距离会增加。

我想保持文本在滚动时覆盖图像的方式；与此类似的风格[。](http://fearthegrizzly.com/)

为缺少 JSFiddle 道歉——似乎无法让它工作。

我试图用[这个](http://jsfiddle.net/xQQrg/1/)来改变它，但我失去了在图像上滚动的文本（比如 FearTheGrizzly 参考）。

简而言之——我想让文本靠近顶部的图像；并让它随着浏览器移动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:34:08.543

问题是，当您调整浏览器大小时，您的背景图像会改变高度（由于`background-size:100% auto;`，但元素本身不会更新。您可以通过 CSS 而不是仅背景图像实际调整 div 的大小来解决此问题，但让我们假设你不想那样做。在这种情况下，你需要使用 JavaScript 调整 div 的大小，以便其余内容出现在正确的位置：

```
$(document).ready(function() {
    $homeDiv = $('.home'); 
    $(window).resize(); //call this onload to make sure the div is initially right
});
$(window).resize(function() {
    ($homeDiv).height($(window).width()/1440 * 600);
    console.log($(window).width()/1440 * 600);
}); 
```

当然，那么你的淡入淡出可能不会像你期望的那样表现，所以也改变`'opacity'`你的 JS 中的行：

```
 'opacity' : 1 - windowScroll / ($(window).width()/1440 * 600 - 30) 
```

这确实取决于您的图像具有一致的尺寸。我敢肯定，有很多方法可以在不知道这一点的情况下做到这一点，但这是最简单的。

# ruby-on-rails-3 - 如何使用普通控制器测试来测试“捕获所有路线”？

> ID：11908504
> 
> 赞同：5
> 
> 时间：2012-08-10T20:05:14.503
> 
> 标签：ruby-on-rails-3, routing, actioncontroller

*注意：根据 RafaeldeF.Ferreira 的建议，这个问题自其原始形式以来已被大量编辑。*

我的基于 JSON 的应用程序需要在给出错误路由时返回一些合理的东西。我们已经知道以下内容`rescue_from ActionController::RoutingError`在 Rails 3.1 和 3.2 中不起作用：

```
# file: app/controllers/application_controller.rb
class ApplicationController < ActionController::Base
  protect_from_forgery
  rescue_from ActionController::RoutingError, :with => :not_found
  ...
end 
```

（这在[https://github.com/rails/rails/issues/671](https://github.com/rails/rails/issues/671)中有详细记录。）因此，我实现了 José Valim 在[此博客条目（第 3 项）](http://blog.plataformatec.com.br/2012/01/my-five-favorite-hidden-features-in-rails-3-2/)中描述的内容，详细信息如下所示。

但是测试它一直存在问题。此控制器 rspec 测试：

```
# file: spec/controllers/errors_controller.rb
require 'spec_helper'
require 'status_codes'
describe ErrorsController do
  it "returns not_found status" do
    get :not_found
    response.should be(StatusCodes::NOT_FOUND)
  end
end 
```

失败：

```
ActionController::RoutingError: No route matches {:format=>"json", :controller=>"sites", :action=>"update"} 
```

然而这个集成测试调用 ErrorsController#not_found 并成功：

```
# file: spec/requests/errors_spec.rb
require 'spec_helper'
require 'status_codes'

describe 'errors service' do
  before(:each) do
    @client = FactoryGirl.create(:client)
  end

  it "should catch routing error and return not_found" do
    get "/v1/clients/login.json?id=#{@client.handle}&password=#{@client.password}"
    response.status.should be(StatusCodes::OK)
    post "/v1/sites/impossiblepaththatdoesnotexist"
    response.status.should be(StatusCodes::NOT_FOUND)
  end
end 
```

那么：有没有办法使用普通控制器测试来测试“捕获所有路线”？

## 实施细节

如果您想查看实现，这里是相关的代码片段

```
# config/routes.rb
MyApp::Application.routes.draw do
  ... all other routes above here.
  root :to => "pages#home"
  match "/404", :to => "errors#not_found"
end

# config/application.rb
module MyApp
  class Application < Rails::Application
    config.exceptions_app = self.routes
    ...
  end
end

# config/environments/test.rb
MyApp::Application.configure do
  ...
  config.consider_all_requests_local       = false
  ...
end

# app/controllers/errors_controller.rb
class ErrorsController < ApplicationController
  def not_found
    render :json => {:errors => ["Resource not found"]}, :status => :not_found
  end
end 
```

# iphone - 让网站用户知道有可用的 iOS 应用程序

> ID：11908506
> 
> 赞同：0
> 
> 时间：2012-08-10T20:05:35.423
> 
> 标签：iphone, html, css, ios, ipad

在 iOS6 中，当用户访问您的网站并使用 iOS 设备时，有一种简单的方法可以让用户选择下载您的应用程序。

（我知道如何检测用户代理，编写 js 等等。只是想看看是否有人为此编写了一个快速的不错的库。）

但是，既然这还不可用，有没有什么好的解决方案可以让我们的用户知道我们有一个应用程序，并让他们下载它？但是，如果他们已经下载了消息，或者关闭了该对话框，就再也不要显示消息了吗？

**编辑：** 这是我过去使用过的，但删除它是因为我觉得它对用户来说很烦人。只是寻找轻量级的例子。

```
/**
 * Checks if this device is an iphone
 *
 * @version $Revision: 0.1
 */
puc.isIphone = function(){
    return (
        (navigator.platform.indexOf("iPhone") != -1) ||
        (navigator.platform.indexOf("iPod") != -1)
    );
}//end

/**
 * Checks if this device is an ipad
 *
 * @version $Revision: 0.1
 */
puc.isIpad = function(){
    return (navigator.platform.indexOf("iPad") != -1);
}//end

/**
* Function that checks if we are using a mobile browser and presents an option to view a differnt site
*
* @access public
*/
puc.mobile = function() {

    if (puc.isIphone() || puc.isIpad()) {

        // Add link to remove cookie
        $('#copyright').append('<p><a id="remove-iphone-cookie">Reset Mobile Preferences</a></p>');

        // Allow Deleting of the cookie
        $('#remove-iphone-cookie').click(function() {
            $.cookie('use_mobile', null);
            alert('Preferences have been reset.');
            return false;
        });

        if ($.cookie('use_mobile') == null) {

            var conf = confirm('Would you like to download the PUC Mobile iOS app?');
            if (conf) {
                document.location = 'http://itunes.apple.com/us/app/puc/id424617272?mt=8&ls=1';
                $.cookie('use_mobile', 'true');
            } else {
                // Never ask them again, unless they empty their cookies
                $.cookie('use_mobile', 'false');    
            }

        }//end

    }//end if mobile

}//end mobile 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:10:29.617

您问题的第一部分很简单，您可以检测浏览器上的用户代理（iPhone、iPod、iPad 等的搜索...更多信息：http: [//p2p.wrox.com/content/articles/identifying -iphone-safari-user-agent](http://p2p.wrox.com/content/articles/identifying-iphone-safari-user-agent) )

你问题的第二部分是你会在哪里出现不足。您将无法确定用户是否安装了该应用程序，因为 Apple 不会在其生态系统之外（尤其是通过网络）共享任何用户信息。因此，您需要至少在第一次向所有用户显示信息。然后，您可以设置一个 cookie 来跟踪他们看到的信息，但不能保证该 cookie 存在多长时间。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T23:53:31.717

好吧，您可以找出是否安装了应用程序。

如果应用程序侦听自定义 url 方案，您只需尝试使用它打开一个 url，如果浏览器在设置的超时后仍位于页面上，则未安装。这是您实现打开应用程序或应用程序商店的链接。

这很棘手，因为如果确实安装了该应用程序，您将无法取消，该链接将始终打开您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T22:28:09.057

一旦检测到 iOS 设备，例如此处的第二个示例 (http://www.w3schools.com/js/js_popup.asp)，您始终可以使用 JavaScript 发送确认警报，而不是“您按下确定”重定向到AppStore URL，它将自动在 AppStore 中打开

# java - 具有受保护类的继承

> ID：11908507
> 
> 赞同：1
> 
> 时间：2012-08-10T20:05:40.660
> 
> 标签：java, inheritance

这是继承的代码示例，代码功能正常。我无法理解此代码的输出，请向我解释。

```
class R {
    private void S1() {
        System.out.println("R:S1");
    }

    protected void S2() {
        System.out.println("R:S2");
    }

    protected void S1S2() {
        S1();
        S2();
    }
}

class S extends R {
    private void S1() {
        System.out.println("S:S1");
    }

    protected void S2() {
        System.out.println("S:S2");
    }
}

public class Inheritance {
    public static void main(String srgs[]) {
        new S().S1S2();
    }
} 
```

输出是：

```
R:S1
S:S2 
```

为什么第一次调用 R 类的 S1 而第二次调用 S 类的 S2。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:08:42.283

`R.S1`是*private*，所以它不会被多态调用，`S.S1`也不会覆盖它。

`R.S2`是*受保护*的，所以`S.S2`覆盖它，当你调用`S2`一个实例时`S2`（即使它只是*静态*地知道是一个实例`R`），`S.S2`将被调用。

从[JLS 的第 8.4.8.1 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.8.1)：

> 在类 C 中声明的实例方法 m1 覆盖在类 A 中声明的另一个实例方法 m2，前提是满足以下所有条件：
> 
> *   C 是 A 的子类。
>     
>     
> *   m1 的签名是 m2 签名的子签名（第 8.4.2 节）。
>     
>     
> *   任何一个：
>     
>     
>     *   m2 是公共的、受保护的或在与 C 相同的包中声明为具有默认访问权限，或
>         
>         
>     *   m1 覆盖方法 m3（m3 不同于 m1，m3 不同于 m2），这样 m3 会覆盖 m2。

注意`m2`不能是私人的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:13:51.310

在 R 中，S1 是私有的，因此不能被覆盖。因此，在 R#S1S2 中对 S1 的调用总是调用 R#S1。S 中的 S1 完全不相关。[旁注：你需要更好的名字。]

但是 S2 不是私有的，所以它可以被覆盖 - 它是。

由于知道私有函数不能被覆盖，Java VM 可以获得良好的性能提升。任何东西，甚至是后代类，都不应该受到类的私有细节的影响。

# c# - 在 Redis 中使用 DateTime 键存储对象

> ID：11908512
> 
> 赞同：2
> 
> 时间：2012-08-10T20:06:00.290
> 
> 标签：c#, redis, servicestack

我想将对象存储在 Redis 中，其中键不是整数 ID，而是 DateTime 类型的属性。可能吗？如何告诉 Redis 哪些属性是关键？仅仅是任何名为“Id”的属性吗？

如果我像这样将对象缓存：

```
var redisClient = new RedisClient("localhost", 30050);
using (var myRedis = redisClient.As<MyObject>())
{
    myRedis.Store(myObject);
} 
```

我以后怎样才能得到它？

```
var redisClient = new RedisClient("localhost", 30050);
using (var myRedis = redisClient.As<MyObject>())
{
    myRedis.GetById(?????????);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T01:37:06.240

Unix 时间戳作为整数将在 Redis 中很好地工作。如果您需要时区支持，您可能需要额外的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-30T01:30:57.527

如果您将 MyObject 类设置为：

```
class MyObject : IHasId<DateTime>
{
  public DateTime Id {get;set;}
  .......
} 
```

然后它应该可以正常工作。Redis 并不关心你的“Id”是什么。ServiceStack Typed redis 客户端很关心，因为它需要您的“Id”属性并使用它来存储您的对象。如果您想使用日期时间作为密钥，那就这样吧。

稍后您可以通过将日期时间传递给 client.GetById() 来获取它。也就是说，除非您定义基于日期时间的密钥的粒度级别，否则管理起来似乎有些棘手。我的意思是，你需要决定你是否只关心日期部分，或者你是否关心日期+时间到分钟，或者日期+时间到秒等。

另外 - 您应该将您的 redis 客户端代码更改为：

```
using(var client = new RedisClient("..."))
{
         var myRedis = client.As<MyObject>();
         ......
} 
```

As() 返回的类型化 redis 客户端实际上并未处理其连接，因此您编写的代码将使连接保持打开状态。

# php - 在php中使用ms sql加载带有空格的表列名

> ID：11908513
> 
> 赞同：0
> 
> 时间：2012-08-10T20:06:09.257
> 
> 标签：php, sql

我正在使用 php 连接到我的 ms sql 服务器。我正在使用 php 5.3，使用 microsoft 数据库 dll 进行连接。我遇到的问题是，在我的数据库中，我有表格，其中列的名称有空格，这意味着有一个名为 bills 的表格，其中有一列名为“托运人代码”或“托运人名称”……类似的东西……我想知道如何使用 fetch_object 读取行

```
while($row = sqlsrv_fetch_object($stmt))
{
  echo "<li>" . $row->Code . $row->MasterId  . "</li>";
  echo "<li>". $row->Shipper Code . "</li>";   <== HERE HOW I MUST PUT SHIPPER CODE?
} 
```

我必须使用 () 或 {} 还是 []...

提前谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:09:34.780

您应该避免在列名或对象名中使用空格。如果您想分隔字符串，请改用下划线`_`。这将保留可读性并确保可以正确访问该项目。

除此之外，您可以使用以下内容：

```
while($row = sqlsrv_fetch_object($stmt)) {
   $results[] = $row;
   echo "<li>" . $results['Code'] . $results['MasterId']  . "</li>";
   echo "<li>". $results['Shipper Code'] . "</li>";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:45:49.033

我已经得到了答案。我只需要使用“{”和“}”。像这样的东西

```
while($row = sqlsrv_fetch_object($stmt))
{

    echo "<li>" . $row->{"Num"} . $row->{"MasterId"}  . "</li>";
    echo "<li>". $row->{"Shipper Code"}. "</li>";
} 
```

感谢你的帮助。

# html - 使用 top.window 刷新来维护 iFrame？

> ID：11908515
> 
> 赞同：0
> 
> 时间：2012-08-10T20:06:11.860
> 
> 标签：html, iframe, frame, deprecated

这对于框架来说很自然，但对于 iframe 则不然。使用 iframe 刷新 top.window 也会重新加载 iframe。那么使用框架对吗？嗯，不。他们以无限的智慧反对它。

所以如果我遵守规则，我会失去这个功能吗？

我必须引入一个外部站点并将其放置在框架/iframe 中，它将处理框架/iframe 内的所有内容。URL mysite.com 默认有一个带有 example.com 的 frame/iframe。然后，当用户在 frame/iframe 中导航内容时，转到 example.com/about.html，然后决定重新加载 top.window，我不希望它返回 example.com，而是留在 example。 com/关于。

使用已弃用的框架，这可以工作。使用“正确”的 iframe，这是行不通的。我能做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:11:42.780

您可以通过哈希从子页面与不同域上的父页面进行通信。您必须控制两个域才能做到这一点，但这绝对是一种选择。您需要做的是每次页面更改时，您都会使用 iframe 中内容的当前 url 更新 iframe 上的哈希值。

[http://www.shubho.net/2010/08/cross-domain-communication-between.html](http://www.shubho.net/2010/08/cross-domain-communication-between.html)

# bash - 模拟 find 命令：为什么我的代码不能正确递归？

> ID：11908517
> 
> 赞同：0
> 
> 时间：2012-08-10T20:06:18.100
> 
> 标签：bash, shell, directory

我的任务是编写一个 Unix shell 脚本，它询问用户目录的名称，然后像`find`.

这是我到目前为止所拥有的：

```
#!/bin/bash
dir_lister()
{
    cd "$1"
    echo "$1"
    list=$(ls -l ${1})

    nolines=$(echo "$list" | awk 'END{printf "%d",NF}')

    if [ $nolines -eq 2 ]
    then

        echo "$1"

        return
    fi

    filelist=$(echo "$list" | grep ^-.*)
    dirlist=$(echo "$list" | grep ^d.*)

    filename=$(echo "$filelist"| awk '{printf "%s\n",$NF}')
    present=$(pwd)
    echo "$filename"| awk -v pres=$present '{printf "%s/%s\n",pres,$0}'

    dirlist2=$(echo "$dirlist" | awk '{printf "%s\n",$NF}')

    echo "$dirlist2" | while IFS= read -r line;
    do
        nextCall=$(echo "$present/$line");
        dir_lister $nextCall;
        cd ".."
    done
    cd ".."
}

read -p "Enter the name of the direcotry: " dName

dir_lister $dName 
```

问题是，在三个目录的深度之后，这个脚本进入了一个无限循环，我不明白为什么。

编辑：

这是我在查看您的答案后提出的代码，它的目录深度仍然不超过 1：

```
#!/bin/bash

shopt -s dotglob # don't miss "hidden files"
shopt -s nullglob # don't fail on empty directories

list_directory()
{
    cd "$2"
    cd "$1"
    ##echo -e "I am called \t $1 \t $2"
    for fileName in "$1/"* 
    do
        ##echo -e "hello \t $fileName"
        if [ -d "$fileName" ];
        then
            echo "$fileName"
            list_directory $fileName $2

        else
            echo "$fileName"
        fi
    done

}
read -p "Enter the direcotory Name: " dirName
var=$(pwd)
list_directory $dirName $var 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:07:06.960

好的，这是在目录中列出文件的完全错误的方法（请参阅[ParsingLs](http://mywiki.wooledge.org/ParsingLs)）。我会给你这些片段，你应该能够将它们组合成一个工作脚本。

将其放在脚本的顶部：

```
shopt -s dotglob # don't miss "hidden files"
shopt -s nullglob # don't fail on empty directories 
```

然后，您可以使用以下命令轻松循环目录内容：

```
for file in "$directory/"* ; do
   #...
done 
```

测试是否有目录：

```
if [ -d "$file" ] ; then
   # "$file" is a directory, recurse...
fi 
```

# python - 忘记声明变量

> ID：11908518
> 
> 赞同：1
> 
> 时间：2012-08-10T20:06:28.607
> 
> 标签：python, interpreter

如果在循环内，是否可以在循环的后续迭代期间实例化要操作的对象，并且在离开循环范围时仍然可用？

这是我认为可能有效的一个简单示例：

```
>>> for i in range(2):
...   r = [] if r is None else r
...   r.append[i]
...
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
NameError: name 'r' is not defined 
```

这是我使用 NameError 异常的第二次尝试：

```
>>> for i in range(2):
...   try:
...     r = r
...   except NameError:
...     r = []
...   r.append(i)
...
>>> 
```

~~我怀疑我一直试图做的事情实际上是被禁止的，但我不明白为什么会这样。~~

~~有人可以帮我解释一下吗？~~

编辑：

所以第二种方法有效，但它很冗长。有没有快速的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T20:08:33.080

它没有被禁止，但它被积极劝阻。除非出现极端情况，否则绝不应被`NameError`抓获*；*始终在循环外绑定名称，即使 to `None`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T20:36:28.533

您可以通过以下方式了解该名称是否在您的当地人中：`name in locals()`关于您的问题：

```
>>> 'r' in locals()
False
>>> for i in range(2):
    if 'r' not in locals(): r = []
    r.append(i)

>>> r
[0, 1]
>>> 
```

我同意伊格纳西奥·巴斯克斯-艾布拉姆斯的观点；这不是很好的风格。请在循环之前做你需要做的事情。

# android - 没有让我的行值从我的 SQLite DB 显示在我的 Listview 中？

> ID：11908522
> 
> 赞同：0
> 
> 时间：2012-08-10T20:06:39.290
> 
> 标签：android, sqlite, android-listview, simplecursoradapter

我一直在努力创建一个包含行的列表视图，这些行值显示存储在我的数据库中的信息。我的问题是如何解决出现“列_id 不存在”的错误？我在网上查看过，我发现您应该使用 as 定义列“_id”，但是当我这样做时它就失败了。也许我错过了一些东西，但在尝试了几种不同的方法后，我仍然得到了那个错误。有任何想法吗？

这是定义我的查询的方法：

```
 String sql = "create table " + TABLE + "(" + C_ID + " int primary key, " +
    C_WORKOUT_NAME + " text, " + C_CLASSNAME + " text, " + C_CREATED_AT + " text)";

    db.execSQL(sql); 
```

这是将数据库值传递到我的行的代码：

```
@Override
protected void onResume(){
    super.onResume();

    cursor = db.query(DBHelper1.TABLE, null, null, null, null, null, 
    DBHelper1.C_CREATED_AT + " DESC");
    startManagingCursor(cursor);

    adapter = new SimpleCursorAdapter(this, R.layout.row, cursor, FROM, TO);
    list.setAdapter(adapter);
} 
```

我也有

```
 static final string C_ID= "_id" 
```

08-10 19:47:52.176: INFO/ActivityManager(67): 开始: Intent {cmp=edu.njit.hss/.History } 来自 pid 440 08-10 19:47:52.596: DEBUG/AndroidRuntime(440):关闭 VM 08-10 19:47:52.596: WARN/dalvikvm(440): threadid=1: thread exiting with unaught exception (group=0x40015560) 08-10 19:47:52.626: ERROR/AndroidRuntime(440): FATAL例外：主要 08-10 19:47:52.626：错误/AndroidRuntime（440）：java.lang.RuntimeException：无法恢复活动 {edu.njit.hss/edu.njit.hss.History}：java.lang.IllegalArgumentException ：列 '_id' 不存在 08-10 19:47:52.626: 错误/AndroidRuntime(440): 在 android.app.ActivityThread.performResumeActivity(ActivityThread.java:2095) 08-10 19:47:52.626: 错误/ AndroidRuntime(440): 在 android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2110) 08-10 19:47:52.626:错误/AndroidRuntime(440)：在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1643)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:51:26.523

就个人而言，我需要更多信息来帮助你。它什么时候给出这个错误？当您显示的代码中没有对该列的请求时，怎么能说该列不存在？（我猜它是它的任何其他部分）

作为一个起点，我建议你看看数据库：

*   如果您没有 root 设备，请在模拟器中执行您的应用程序
*   从 DDMS 中提取文件 - 转到文件树并导航到 /data/data/your.app.package/databases/yourDatabaseName
*   使用 sqlite 浏览器（Lita、SQLiteDBBrowser）打开它，查看它的外观并在此处更新信息（如果您仍然需要它）

...我们会在这里等你:)

# wordpress - Google Chome - 侧边栏仅在某些计算机上看起来损坏

> ID：11908523
> 
> 赞同：0
> 
> 时间：2012-08-10T20:06:41.943
> 
> 标签：wordpress, google-chrome, sidebar

我目前在网上有一个 WordPress 主题，看起来工作正常，但我的一位客户指出，谷歌浏览器中的博客页面布局已损坏。侧边栏出现在页面内容的正下方。所以我检查了他的网站和我的演示，它确实看起来很糟糕。所以我和另一个程序员谈过，他说它没有坏，他也使用最新版本的 Chrome。我从来没有遇到过这样的问题，它适用于某些人，但不适用于其他人。

编辑：感谢 Joseph Erickson 解决了这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:15:39.897

看起来它与.的宽度有关`#sidebar`。如果你把它缩小一点，它会合适的。

*为什么*会这样？谁知道。这些带有浮点数的小像素偏移可能很难追踪。我建议不要尝试将所有东西如此紧密地组合在一起，并在将两个固定宽度的浮动元素放在同一个元素中时留出一些回旋余地。

# sql-server - 如何从批处理文件启动多个 sqlcmd 窗口？

> ID：11908524
> 
> 赞同：0
> 
> 时间：2012-08-10T20:06:58.107
> 
> 标签：sql-server, batch-file

如何从一个批处理文件中启动多个都指向同一个数据库的 sqlcmd 窗口？例如，当我运行 .bat 文件时，我希望它根据我传递给它的参数（例如 5）生成 N 个窗口。这 5 个窗口中的每一个都应该在我的桌面上打开，并且都连接到同一个数据库。这就是我想做的第一件事。一旦我有了这个工作，我希望这 5 个窗口中的每一个都运行一个不同的 .sql 脚本，该脚本执行插入、查询、更新、删除、调用存储过程......基本上模拟生产环境以帮助我们进行调试工作（在用户负载下）。我想在执行时在 sqlcmd 窗口中看到每个 .sql 指令的输出。

我发现：

[http://hammerora.sourceforge.net/](http://hammerora.sourceforge.net/)

这是一个专注于 TPC-C 负载测试的 GUI 工具，但它并不是我想要的。我提出它是因为它是一个类似的概念，我只想由较小规模的批处理文件驱动（例如，最多 20 个并发用户）。

我在 90 年代后期为 Oracle 可伸缩性测试创建了一个这样的系统，但从那时起我就退出了数据库业务，不记得如何去做以及支持 SQL Server 需要有多大的不同。所以我知道这在 Oracle 中是可能的，但只是不确定 SQL Server 是否具有命令行工具和脚本功能。

有没有人知道如何才能完成这项工作？

前任。创建一个`launch3users.bat`如下所示的文件：

```
sqlcmd -d MichaelTest -run this 1.sql file
Pause

sqlcmd -d MichaelTest -run this 2.sql file
Pause

sqlcmd -d MichaelTest -run this 3.sql file
Pause 
```

其中每一个都会产生一个 sqlcmd 窗口并运行适当的 .sql 脚本，该脚本可以执行 DML 操作或称为存储过程。

谢谢，迈克尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:49:39.437

您只需将“开始”添加到命令的开头。

```
start sqlcmd -d MichaelTest -i 1.sql

start sqlcmd -d MichaelTest -i 2.sql

start sqlcmd -d MichaelTest -i 3.sql 
```

# java - 在 Java 应用程序中嵌入迷你语言的好方法/工具是什么？

> ID：11908525
> 
> 赞同：3
> 
> 时间：2012-08-10T20:07:00.413
> 
> 标签：java, interpreter, dsl, evaluation

我正在尝试解决以下问题：

*   我有一个 Java 应用程序（不是我编写的），其目的是获取 2 个报告文件（只是逗号分隔的表格输出），并将文件的每一行和每一列逐个单元格地相互比较 - 基本上，用于回归测试。

*   我想用以下功能增强它：

    *   假设我做了一个软件更改，导致 C1 列中的所有值都增加了 100%。

    *   在比较特定列“C1”时，软件当前会报告 C1 中 100% 的值发生了变化。

    *   我想要做的是**能够将回归测试器配置为不简单地比较“在第 1 行中的 C1 在两个文件中是否相同”，而是将预先配置的比较规则/公式应用于该字段，例如“确保文件#2 中的 C1 值是文件#1 中 C1 值的 2 倍"**。这样，我不仅可以抑制 100% 的虚假回归错误，即每行的 C1 列不匹配，而且还可以使用新软件捕获 C1 列不完全 100% 大的任何实际错误。

以前在 Perl 中编写此类功能时，解决方案非常简单 - 只需将**自定义的每列比较器配置编码到存储在配置文件中的 Perl 散列中**，散列键是列，散列值是用于比较 2 个值的 Perl 子例程我想要的任何复杂方式。

显然，这种方法不适用于 Java，因为我不能在 Java 中编写自定义比较器逻辑，并且在不同的运行时让 Java 不同地评估/编译/执行这些比较器。

这意味着我需要提出一些特定于领域的可解释语言，我的不同之处将解释/评估/执行。

由于我对 Java 生态系统和库不是很熟悉，所以我问：

**为可配置的比较器逻辑实现此 DSL 的一个好的解决方案是什么？**

我的要求是：

*   解决方案必须“像啤酒一样免费”

*   解决方案必须是“收缩包装”。例如，一个现有的库，我可以简单地放入我的代码中，添加配置文件，然后让它工作。

    要求我编写自己的 BNF 语法并提供我必须编写自己的解释器的通用语法解析器的东西是不可接受的。

*   就数据处理和语法丰富而言，该解决方案必须相当灵活。例如：

    *   您至少应该能够从 DSL 中传入 - 并引用/地址 - 整行数据作为哈希

    *   它应该有相当完整的语法；至少进行基本的字符串操作（连接、子字符串，理想情况下是某种级别的正则表达式匹配和替换）；基本算术，包括`abs(val1 - val2) > tolerance`在浮点 #s 上执行的能力；和基本的流程控制/逻辑，例如条件和理想循环。

*   该解决方案应该相当快，并且必须是可扩展的。例如，比较 100x100 大小的文件不应该花费 10 分钟和 10-20 个自定义列。

如果重要的话，目标环境是 Java 1.6

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:42:35.970

有多种动态 JVM 编程语言可以轻松集成到 Java 应用程序中，而无需付出太多努力。我认为值得研究[Groovy](http://groovy.codehaus.org/Embedding+Groovy)和/或[Scala](http://www.codecommit.com/blog/java/interop-between-java-and-scala)。

另一种可能的选择是使用[XText](http://www.eclipse.org/Xtext/)或[XTend](http://www.eclipse.org/xtend/)创建您自己的 DSL 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T22:56:43.860

每当谈到 Java 中的动态特性时，我都会想到 Janino，这是一个迷人的运行时和内存编译器。在您的情况下，它会为您提供类似于纯 Java 的 eval(...) 的内容，请参阅：[http ://docs.codehaus.org/display/JANINO/Basic#Basic-expressionevaluator](http://docs.codehaus.org/display/JANINO/Basic#Basic-expressionevaluator)

这里的要点是您的测试配置没有 DSL，但您可以使用纯 Java 语法在测试配置中编写自定义表达式。

下面提出的解决方案无法满足的唯一要求是您可以从配置文件中处理整行。该解决方案假定您编写了一个 Java 测试类，它逐个值（或更好地逐对）遍历您的测试数据，并使用您配置的表达式来比较单个值。所以动态部分是表达式，静态部分是测试数据的迭代。

但是所需的代码非常小且简单，如下所示：

配置文件（Java 属性语法，键是列名，值是测试表达式）：

```
# custom expression for column C1
C1  = a == 2 * b           
# custom expression for column C4
C4  = a == b ^ 2           
# custom expression for column C47
C47 = Math.abs(a - b) < 1 
```

测试代码草图：

```
// read config file into Properties
Properties expressions = Properties.load(....);

// Compile expressions, this could also be done lazily
HashMap<String, ExpressionEvaluator> evals = new HashMap<String, ExpressionEvaluator>();
for (String column : expressions.stringPropertyNames()) {
    String expression = expressions.getProperty(column);
    ExpressionEvaluator eval = new ExpressionEvaluator(
        expression,                  // expression
        boolean.class,               // expressionType
        new String[] { "a", "b" },   // parameterNames
        new Class[] { int.class, int.class } // parameterTypes, depends on your data
    );
    evals.put(column, eval);
}

// Now for every value pair (a, b) check if a custom expression is defined 
// for the according column and if yes execute: 
Boolean correct = (Boolean) theEvalForTheColumn.evaluate(
    new Object[] { a, b }          // parameterValues
);
if (!correct) throw Exception("Wrong values..."); 
```

正如 Janino 页面上所说，编译表达式的性能非常好（它们是真正的 java 字节码），只有编译会减慢进程。因此，如果您有许多自定义表达式，但它应该随着值数量的增加而很好地扩展，这可能是一个问题。hth。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T23:10:19.803

不需要嵌入式语言。将您的比较器定义为接口。

您可以使用 class.forName(name) 加载在运行时定义接口的类，其中名称可以通过命令行参数或任何其他方便的方式指定。

你的比较器类看起来像

```
class SpecialColumn3 implements ColumnCompare
{ boolean compare(String a,String b) {...}
} 
```

# c# - 如何将 KeyedCollection 设为只读？

> ID：11908527
> 
> 赞同：3
> 
> 时间：2012-08-10T20:07:11.890
> 
> 标签：c#, .net, collections, keyedcollection

首先让我解释一下为什么我使用 KeyedCollection。我正在构建一个 DLL，并且我有一个需要添加到集合中的项目列表，并让它们保持我放置它们的顺序，但我还需要通过它们的索引和键来访问它们（键是我已经定义的对象的属性）。如果有其他更简单的集合可以做到这一点，请告诉我。

好的，现在我需要能够在 DLL 内部向此集合添加项目，但我需要它以只读方式对 DLL 的最终用户公开可用，因为我不希望他们删除/更改我添加的项目.

我已经搜索了这个网站，其他网站，一般的谷歌，我还没有找到一种方法来获得某种只读的 KeyedCollection。我最接近的是这个页面（[http://www.koders.com/csharp/fid27249B31BFB645825BD9E0AFEA6A2CCDDAF5A382.aspx?s=keyedcollection#L28](http://www.koders.com/csharp/fid27249B31BFB645825BD9E0AFEA6A2CCDDAF5A382.aspx?s=keyedcollection#L28)）但我不能让它工作。

**更新：**

我看了看那些C5课程。那，连同你的其他评论，帮助我更好地理解如何创建我自己的只读类，它似乎工作。但是，当我尝试将常规的转换为只读的时，我遇到了问题。我得到一个编译时无法转换错误。这是我创建的代码（第一个小类是我最初拥有的）：

```
public class FieldCollection : KeyedCollection<string, Field>
{
    protected override string GetKeyForItem(Field field)
    {
        return field.Name;
    }
}

public class ReadOnlyFieldCollection : KeyedCollection<string, Field>
{
    protected override string GetKeyForItem(Field field)
    { return field.Name; }

    new public void Add(Field field)
    { throw new ReadOnlyCollectionException("This collection is read-only."); }

    new public void Clear()
    { throw new ReadOnlyCollectionException("This collection is read-only."); }

    new public void Insert(int index, Field field)
    { throw new ReadOnlyCollectionException("This collection is read-only."); }

    new public bool Remove(string key)
    { throw new ReadOnlyCollectionException("This collection is read-only."); }

    new public bool Remove(Field field)
    { throw new ReadOnlyCollectionException("This collection is read-only."); }

    new public bool RemoveAt(int index)
    { throw new ReadOnlyCollectionException("This collection is read-only."); }
} 
```

如果我定义了这个变量：

```
private FieldCollection _fields; 
```

然后这样做：

```
public ReadOnlyFieldCollection Fields;
Fields = (ReadOnlyFieldCollection)_fields; 
```

它无法编译。它们都继承自同一个类，我认为它们会“兼容”。如何将集合转换（或公开）为我刚刚创建的只读类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:20:03.680

我也不知道任何内置解决方案。这是我在评论中给出的建议的一个例子：

```
 public class LockedDictionary : Dictionary<string, string>
    {
        public override void Add(string key, string value)
        {
            //do nothing or log it somewhere
            //or simply change it to private
        }

        //and so on to Add* and Remove*

        public override string this[string i]
        {
            get
            {
                return base[i];
            }
            private set
            {
                //...
            }
        }
    } 
```

您将能够遍历 KeyValuePair 列表和其他所有内容，但不能用于编写操作。请务必根据您的需要键入它。

* * *

**编辑** 为了有一个排序列表，我们可以将基类从更改`Dictionary<T,T>`为 a `Hashtable`。

它看起来像这样：

```
 public class LockedKeyCollection : System.Collections.Hashtable
    {
        public override void Add(object key, object value)
        {
            //do nothing or throw exception?
        }

        //and so on to Add* and Remove*

        public override object this[object i]
        {
            get
            {
                return base[i];
            }
            set
            {
                //do nothing or throw exception?
            }
        }
    } 
```

用法：

```
 LockedKeyCollection aLockedList = new LockedKeyCollection();

        foreach (System.Collections.DictionaryEntry entry in aLockedList)
        {
            //entry.Key
            //entry.Value
        } 
```

不幸的是，我们无法更改方法的访问修饰符，但我们可以覆盖它们以不做任何事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-13T17:09:06.377

编辑以修改我的原始答案。显然，我没有足够的咖啡因这个上午。

您应该查看 C5 集合库，它为集合和字典提供只读包装器，以及 CLR 团队忘记的其他内容：

[http://www.itu.dk/research/c5/](http://www.itu.dk/research/c5/)

您还可以通过 NuGet 在[http://www.nuget.org/packages/C5获取 C5 Collections 库](http://www.nuget.org/packages/C5)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-05T00:07:09.157

有两个额外的选项可供您使用，将来可能更适合类似的需求。第一个选项最简单，需要的代码最少；第二个需要更多的脚手架，但最适合与现有实现共享只读成员`KeyedCollection<TKey, TValue>`。

### 选项 1：源自`ReadOnlyCollection<TValue>`

在这种方法中，您从索引器派生`ReadOnlyCollection`然后添加`this[TKey key]`索引器。这*类似于*@AndreCalil 上面采用的方法，除了`ReadOnlyCollection` *已经*为每个可写入口点抛出一个`NotSupportedException`，所以你在那里被覆盖。

这是微软内部`ReadOnlyKeyedCollection<TKey, TValue>`在`System.ServiceModel.Internals`程序集中使用的方法（[源代码](http://referencesource.microsoft.com/#System.ServiceModel.Internals/System/Runtime/ReadOnlyKeyedCollection.cs)）：

```
class ReadOnlyKeyedCollection<TKey, TValue> : ReadOnlyCollection<TValue> {

  KeyedCollection<TKey, TValue> innerCollection;

  public ReadOnlyKeyedCollection(KeyedCollection<TKey, TValue> innerCollection) : base(innerCollection) {
    Fx.Assert(innerCollection != null, "innerCollection should not be null");
    this.innerCollection = innerCollection;
  }

  public TValue this[TKey key] {
    get {
      return this.innerCollection[key];
    }
  }

} 
```

### 选项 2：装饰现有的`KeyedCollection<TKey, TValue>`

该`ReadOnlyCollection<TValue>`方法唯一真正的缺点是它不会从您的`KeyedCollection<TKey, TValue>`实现中继承任何逻辑。如果您有很多自定义逻辑，那么您可能会选择在现有实现上使用[装饰器模式。](https://en.wikipedia.org/wiki/Decorator_pattern)这看起来像：

```
class MyReadOnlyKeyedCollection : MyKeyedCollection, IReadOnlyCollection<TValue> {

  MyKeyedCollection innerCollection;

  public MyReadOnlyKeyedCollection(MyKeyedCollection innerCollection) : base() {
    this.innerCollection = innerCollection;
  }

  protected override InsertItem(Int32 index, TItem item) {
    throw new NotSupportedException("This is a read only collection");
  }
  //Repeat for ClearItems(), RemoveItem(), and SetItem()

  public override void YourWriteMethod() {
    throw new NotSupportedException("This is a read only collection");
  }
  //Repeat for any other custom writable members

  protected override IList<T> Items { 
    get {
      return.innerCollection.ToList();
    }
  }
  //This should cover all other entry points for read operations

  public override Object YourReadMethod() {
    this.innerCollection.YourReadMethod();
  }
  //Repeat for any other custom read-only members

} 
```

`KeyedCollection<TKey, TItem>`然而，这显然需要编写更多代码，而且只有在现有界面上有大量自定义代码时才有意义；否则，第一种方法更有意义。鉴于此，最好通过[扩展方法](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/extension-methods)或在 C# 8.0 中的[默认接口方法](https://github.com/dotnet/csharplang/blob/master/proposals/default-interface-methods.md)集中该逻辑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-13T00:40:38.257

答案永远不会太晚！

最简单的路径：

*   `IReadOnlyCollection<T>`
*   使其工作的最小设置，即没有比较器和内部字典

代码：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Linq;
using JetBrains.Annotations;

namespace Z
{
    public abstract class ReadOnlyKeyedCollection<TKey, TValue> : IReadOnlyCollection<TValue>
    {
        private readonly IReadOnlyCollection<TValue> _collection;

        protected ReadOnlyKeyedCollection([NotNull] IReadOnlyCollection<TValue> collection)
        {
            _collection = collection ?? throw new ArgumentNullException(nameof(collection));
        }

        public TValue this[[NotNull] TKey key]
        {
            get
            {
                if (key == null)
                    throw new ArgumentNullException(nameof(key));

                foreach (var item in _collection)
                {
                    var itemKey = GetKeyForItem(item);

                    if (Equals(key, itemKey))
                        return item;
                }

                throw new KeyNotFoundException();
            }
        }

        #region IReadOnlyCollection<TValue> Members

        IEnumerator IEnumerable.GetEnumerator()
        {
            return GetEnumerator();
        }

        public IEnumerator<TValue> GetEnumerator()
        {
            return _collection.GetEnumerator();
        }

        public int Count => _collection.Count;

        #endregion

        public bool Contains([NotNull] TKey key)
        {
            if (key == null)
                throw new ArgumentNullException(nameof(key));

            return _collection.Select(GetKeyForItem).Contains(key);
        }

        protected abstract TKey GetKeyForItem(TValue item);
    }
} 
```

# c++ - C++ 无法将数据输入到私有向量中（无效使用）

> ID：11908532
> 
> 赞同：0
> 
> 时间：2012-08-10T20:07:24.487
> 
> 标签：c++, vector

我有一个“帐户”类的向量。它对 BankingSystem 类是私有的。这是我如何定义它们的。

账户类：

```
struct newAccount
{
string firstName;
string lastName;
string accountPass;
int accountID;
float accountBalance;

}; //end of structure newAccount

class Account
{
    string firstName;
    string lastName;
    string accountPass;
    int accountID;
    float accountBalance;

private:
    int depositAmount;
    int withdrawAmount;

public:
    static newAccount createAccount( int, float, string, string, string );  //creates new account
    void deposit( int );    //deposits money into account
    void withdraw(int);     //withdrawals money from account
    int retdeposit() const; //function to return balance amount
    friend class BankingSystem;

}; //end of class Account 
```

银行系统类：

```
class BankingSystem
{
    int accountID;
    char fileName;

private:
    std::vector<Account> accounts_;

public:
    static void addAccount();
    static void storeAccount( newAccount );
    void deleteAccount();
    void accountInquiry();
    void saveAccounts();
    void loadAccountsFromFile();
    friend class Account;

}; // end of class BankingSystem 
```

我正在尝试以这种方式将新帐户存储在向量中。

1) BankingSystem.h 中的 addAccount 函数

```
void BankingSystem::addAccount()
{
int ID;
float balance;
std::string pass, first, last;

cout << "\n\t Enter the Account ID: ";
cin >> ID;
cout << "\n\t Enter the passcode: ";
cin >> pass;
cout << "\n\t Enter Client's first name: ";
cin >> first;
cout << "\n\t Enter Client's last name: ";
cin >> last;
cout << "\n\t Enter starting balance: ";
cin >> setw(6) >> balance;

storeAccount( Account::createAccount( ID, balance, pass, first, last ) );

return;

} 
```

2) 在 Account.h 中创建帐户

```
newAccount Account::createAccount( int ID, float balance, string first, string last, string pass )
{    
newAccount a;
a.accountID = ID;
a.accountBalance = balance;
a.firstName = first;
a.lastName = last;
a.accountPass = pass;

return a;

} 
```

3) BankingSystem.h 中的 storeAccount

```
void BankingSystem::storeAccount( newAccount a )
{
accounts_.push_back(a);

} 
```

除了将数据存储在向量中之外，一切正常。该行`accounts_.push_back(a);`有此错误；“在静态成员函数中无效使用成员 'accounts_'。”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:11:23.870

静态方法无权访问类实例（否`this`），因此在内部`storeAccount`并且`addAccount`该成员`accounts_`不存在。

仅供参考：return 语句之后不会执行任何操作，因此该行在`cout << "\n\t Account ID: " << a.accountID << " added successfully.";`您当前的代码中相当无用。

考虑以下实现以供参考：

```
using namespace std;

class Account
{
private: // data members
    string firstName;
    string lastName;
    string accountPass;
    int accountID;
    float accountBalance;

public:
    // constructor that initializes members
    Account(int id, float bal, const string& fname, const string& lname, const string& pass)
        : accountID(id), accountBalance(bal), firstName(fname), lastName(lname), accountPass(pass) {}

}; //end of class Account

class BankingSystem
{
private: // data members
    int accountID;
    char fileName;
    vector<Account> accounts_;

public:
    void addAccount()
    {
        int ID;
        float balance;
        string pass, first, last;

        // prompt input, initialize values, etc

            // construct a new Account from values and add it to vector
        accounts_.push_back(Account(ID, balance, first, last, pass));
    }
    void storeAccount( const Account& newAccount )
    {
            // add an already initialized account
        accounts_.push_back(newAccount);
    }

}; // end of class BankingSystem 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:13:46.587

静态成员函数对成员变量没有任何特殊访问权限，例如`accounts_`.

`addAccount`并且`storeAccount`是静态成员函数。你一定是有原因的，但这是一个错误。删除该静态，您将删除此错误。我猜你会有一个不同的问题。如果是这样，请提出另一个问题并找出解决该问题的正确方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:14:06.837

该方法是静态的，因此它没有“this”指针，因此它不知道您要访问哪个对象的 accounts_ 变量。此外，您将永远不会在 createAccount() 上看到该打印输出，因为它是在返回调用之后。

# c# - 显示会员值有错误，如何解决？

> ID：11908534
> 
> 赞同：0
> 
> 时间：2012-08-10T20:07:29.727
> 
> 标签：c#, c#-4.0

我正在从列表中的数据库中检索整个数据？现在我有四个类：

学生班级：

```
public class StudentTable
{
    public string StudentID { get; set; }
    public string StudentName { get; set; }

    public StudentTable()
    {
    }

    public StudentTable(string aStudentID, string aStudentName)
    {
        StudentID = aStudentID;
        StudentName = aStudentName;
    }
} 
```

课程班

```
public class CourseTable
{
    public string CourseID { get; set; }
    public string CourseName { get; set; }
    public int Credits { get; set; }

    public CourseTable()
    {
    }

    public CourseTable(string aCourseID, string aCourseName, int aCredits)
    {
        CourseID = aCourseID;
        CourseName = aCourseName;
        Credits = aCredits;
    }
} 
```

招生班

```
public class Enrollment
{
    public StudentTable StudentData { get; set; }
    public CourseTable CourseData { get; set; }
    public DateTime DOE { get; set; }

    public Enrollment()
    {
    }

    public Enrollment(StudentTable aStudentData, CourseTable aCourseData, DateTime aDOE)
    {
        StudentData = aStudentData;
        CourseData = aCourseData;
        DOE = aDOE;
    }
} 
```

StudentScore类：

```
public class StudentScore
{

    public Enrollment EnrollmentData { get; set; }
    public int Score { get; set; }

    public StudentScore()
    {
    }

    public StudentScore(Enrollment aEnrollmentData, int aScore)
    {
        EnrollmentData = aEnrollmentData;
        Score = aScore;
    }
} 
```

我通过查询从数据库中检索数据现在我想从列表中显示 StudentID 但在 StudentScore 类中我有 EnorllmentData 而不是 StudentID。

```
try
{
    var aStudentScore = EnrollmentDB.GetAllScore();
    comboBox3.DataSource = aStudentScore;

    comboBox3.DisplayMember = "StudentID";
    comboBox3.ValueMember = "CourseID";
    //comboBox3.ValueMember = "Score";
}
catch (Exception ex)
{
    MessageBox.Show(ex.Message, ex.GetType().ToString());
} 
```

它向我显示了一个 DisplayMember 错误，你能帮我解决它吗，因为 StudentScore 类中没有 StudentID 变量，所以我如何显示 StudentScore 类中的 StudentID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:12:51.610

您的`StudentScore`类型不公开`StudentID`or `CourseID`，但这就是您要绑定的内容。你希望它如何工作？

您*也许*可以使用：

```
comboBox3.DisplayMember = "EnrollmentData.StudentData.StudentID";
comboBox3.ValueMember = "EnrollmentData.CourseData.CourseID"; 
```

...这取决于您使用的任何绑定是否能够以这种方式导航属性。

`StudentTable`顺便说一句，您对and类型的命名`CourseTable`是不合适的-它的实例不代表 a-`StudentTable`它代表表中的*一行*。只是调用这些类型`Student`会`Course`更有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:15:27.107

因此，首先您遇到了**无法绑定到新的显示成员**错误，Jon 通过向您展示如何使用点符号来解决该错误。

之后，您现在会收到**Unable to cast**错误。如果没有看到 GetAllScore 方法，我无法确切地说出原因。但是，您可以自己在代码中完成繁重的工作，并使绑定变得简单，方法是向 StudentScore 添加只读属性以返回您想要用作显示和值成员的内容。（我不得不说，使用 StudentID 作为 DisplayMember 和 CourseID 作为 ValueMember 对我来说没有任何意义。）

将这样的内容添加到您的 StudentScore：

```
public String UseAsDisplayMember
{
    get 
    {
        return EnrollmentData.StudentData.StudentID; 
    }
}
public string UseAsValueMember
{
    get 
    {
        return EnrollmentData.CourseData.CourseID; 
    }
} 
```

然后将数据绑定设置为：

```
comboBox3.DisplayMember = "UseAsDisplayMember";
comboBox3.ValueMember = "UseAsValueMember"; 
```

这应该让你工作，但感觉更像是一种创可贴，而不是真正的修复。

# php - jQuery 高度和宽度无法正常工作

> ID：11908536
> 
> 赞同：0
> 
> 时间：2012-08-10T20:07:32.703
> 
> 标签：php, jquery, html, codeigniter

我有一个宽度大于高度的图像，它仍然使用 jQuery 中的第二个 if 语句输出。我确实相信这可能与输出多个图像文件的 PHP 部门有关。所以我把id选择器改成了类选择器，但它不想让步。有人知道我做错了什么吗？我已经在这个问题上触底了。

```
<?php $userid = $this->session->userdata('userid');
      $selectedId = $_REQUEST['id'];      
      $query1 = $this->db->query("SELECT * FROM userProfilePhotos p, userProfileAlbums a WHERE p.isAlbumCover = 'Yes' AND p.userid = a.userid AND a.userid = '{$selectedId}' AND a.albumId = p.albumId");
        foreach($query1->result() as $row1) {?>

    <script type="text/javascript">
    $(document).ready(function() {
    function heightOverWidth() {
        return '<div style="width: 102px; height: 136px; border-radius: 3pt; background-color: white; border: 1px solid #C1C1C1; padding: 10pt">'+
               '<img id="profileImg" alt="" height="130" src="<?=base_url().$row1->imgURI?>" width="100" />'+
               '</div><span class="link-font3"><?=$row1->albumName?></span> <span class="font1"> - <?=$row1->albumDesc?></span>';
    }
    var img = $(".profileImg");
    if (img.width() >= img.height()) {
        alert("1");
    } if (img.height() >= img.width()) {
        $("#albumList").append(heightOverWidth());
    }
    });
    </script>

<?php list($width, $height, $type, $attr) = getimagesize(base_url() . $row1->imgURI); ?>
<div id="albumList" style="padding: 10pt">
<img class="profileImg" style="display: none" alt="" height="<?=$height?>" width="<?=$width?>" src="<?=base_url().$row1->imgURI?>" />
</div>

<?php } ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:21:56.843

将 width() 更改为 attr('width') 和高度相同。这将读取您的宽度/高度属性，而不是尝试获取实际的宽度和高度。您的解决方案不能用作具有 display:none 的元素，没有任何可见的尺寸。

# jquery - AJAX HTML 数据没问题，但是 find 返回 null

> ID：11908537
> 
> 赞同：0
> 
> 时间：2012-08-10T20:07:33.753
> 
> 标签：jquery, ajax

我正在使用 $.get 获取 HTML 文档（也尝试过 $.ajax）：

```
$.get('/products/', function(data) {
    $('.content .article').remove();
    $('.content').prepend($(data).find('.article'));
}); 
```

检查数据是否正常：

```
alert(data); 
```

它可以毫无问题地打印html文件。但是当我尝试打印时：

```
alert($(data).find('.article').html()); 
```

或者

```
alert($('.article', data).html()); 
```

它总是打印空。

我在这里发现了一个类似的问题：[Extract part of HTML document in jQuery](https://stackoverflow.com/q/2137811)，但解决方案对我不起作用。

编辑：内容 o 生成的 HTML。

```
<!DOCTYPE html>
<html><head></head><body>

<div class="article"><h1>Lorem Ipsum</h1>
<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
</div>

</body></html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:22:44.643

嗯，如果你把内容放上去就好了，`data`但从我得到的信息中，我可以告诉你这些事情......

* * *

首先，您在最后一个`.content`语句之后缺少顶部示例的引用。

看这里：

```
$('.content').prepend($(data).find('.article')); 
```

更正为：

```
$('.content').prepend($(data).find('.article')); 
```

* * *

然后，尝试做`console.log($(data));`并确保您的字符串正确转换为 jQuery 对象。

另一件事，尝试做`console.log($(data).find('.article'));`并确保它返回的不仅仅是一个元素，因为`.html()`从很多元素中做可能会返回`null`

而且，如果有多个元素并且假设您只想要第一个，请执行以下操作：

```
var articles = $(data).find('.article');
var firstArticle = articles.first().html(); 
```

或者，如果您想在所有文章中循环，请执行以下操作以获取每个`html`：

```
$.each($(data).find('.article'), function(index, value){
   console.log($(this).html());
}); 
```

* * *

如果对您没有任何效果，那么我可以告诉您`data`在将其转换为 jQuery 对象之前尝试检查字符串的确切值。

* * *

## 解决了

*   当从jQuery 中的页面获取时，您的`data`from 回调是这样组成的：`string``/products/``$.get`

![在此处输入图像描述](../Images/3f00abca612fbd23d07bb1fd2101c8fb.png)

*   如您所见，当转换`data`为`$(data)`并尝试查找`.article`时将失败，因为该对象不仅由一个元素组成。

*   所以你的代码必须修改为：

    ```
    $.get('/products/', function(data){
        $('.content .article').remove();
        $('.content').prepend($(data).eq(1));
    }); 
    ```

*   现在一切都将正常工作，因为您的代码将从您的对象中仅找到第二个元素（文章 html - 根据数组索引的第一个元素）`$(data)`，然后将其放入您的`.content`div 中。

希望这会有所帮助:-) 我测试过并且它正在工作。

**PS。不要忘记总是打印元素，正如我在开始回答时告诉你的那样，尝试`console.log($(data));`知道它是如何组成的！**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-12T22:32:59.773

试试这个：

```
$(data).filter('.article'); 
```

这就是我将数据字符串转换为 jQuery 对象时得到的结果：

```
[div.article, div.nav] 
```

好像当你转换一个代表整个 HTML 文档的字符串时，jQuery 只收集正文中的项目。

# windows - 通过 rundll32 在 dll 中运行完整的 Windows 应用程序

> ID：11908541
> 
> 赞同：1
> 
> 时间：2012-08-10T20:07:50.847
> 
> 标签：windows, visual-studio-2010, createwindow, rundll32

有没有人有一个将完整的 WIN32 Windows 应用程序构建为 dll 的示例？

我想导出一个函数，通过 rundll32 调用它，并拥有一个完整的 Windows 应用程序，其中包含装饰、菜单、加速器和弹出的所有内容。

我知道rundll32的调用约定：

```
void CALLBACK TestEntryW(HWND hWnd, HINSTANCE hInst, LPWSTR pszCmdLine, int nCmdShow); 
```

我可以通过以下命令从该函数中提取一个 MessageBox：`rundll32.exe test3.dll,TestEntry other params and args`

我可以通过获取 DLL 的句柄并在我的调用中`GetModuleHandle("test3.dll")`使用它来从我的 DLL 加载资源。这似乎也适用，但我还没有工作（婴儿步骤..）。`hInst``LoadString``LoadIcon``LoadAccelerators`

我可以通过使用这些字符串和图标来注册一个 Windows 类`RegisterClassEx`，但我必须使用父类`hInst`，否则我`ERROR_CANNOT_FIND_WND_CLASS`在调用`CreateWindow`. 我认为这是预期的。

但是，当我尝试在 中使用该类时`CreateWindow`，它返回 NULL，而`GetLastError`.

我可以检索使用从 rundll32 传递的 hInst 的窗口类`GetWindowsLong(hWnd, GWL_ATOM)`。将它用于 lpClassName，我可以拉出一个没有菜单和加速器的装饰窗口，但它有点时髦，因为 rundll 的窗口类通常只用于它的消息队列。我尝试使用子类化窗口`SetWindowsLong`来替换`WndProc`和调用`CallWindowProc`而不是`DefWindowProc`在我的 dll 中`WndProc`。

由于无法在 MSVC++ 2010 Express 中调试它，我受到了阻碍。我用适当的条目替换了项目的命令和命令参数，因此它可以正确启动它，但它抱怨没有 rundll32.exe 的调试信息，并且断点等不起作用。

有任何想法吗？我在正确的轨道上吗？

# css - 通过 LESS 向 Bootstrap 添加填充

> ID：11908543
> 
> 赞同：0
> 
> 时间：2012-08-10T20:08:02.770
> 
> 标签：css, twitter-bootstrap, less

我以这种方式在引导程序中向 div 添加填充 10px：

html:

```
<div class="span12 padded"></div> 
```

my.less 文件：

```
.padded {padding: @gridGutterWidth/2;}
.span1.padded {width: (@gridColumnWidth * 1) + (@gridGutterWidth * 0) - @gridGutterWidth;}
.span2.padded {width: (@gridColumnWidth * 2) + (@gridGutterWidth * 1) - @gridGutterWidth;}
.span3.padded {width: (@gridColumnWidth * 3) + (@gridGutterWidth * 2) - @gridGutterWidth;}

... all other spans in same way 
```

这工作没有问题。我正在尝试对其进行修改以使其更加通用，但无法使其正常工作：

html:

```
<div class="span12 padded20"></div> 
```

my.less 文件：

```
@padding10 = 10px;
@padding20 = 20px;
@padding30 = 30px;
@padding40 = 40px;

.padded10 {padding: @padding10;}
.padded20 {padding: @padding20;}
.padded30 {padding: @padding30;}
.padded40 {padding: @padding40;}

.span1.padded10 {width: (@gridColumnWidth * 1) + (@gridGutterWidth * 0) - (@padding10 * 2);}
.span2.padded10 {width: (@gridColumnWidth * 2) + (@gridGutterWidth * 1) - (@padding10 * 2);}
.span3.padded10 {width: (@gridColumnWidth * 3) + (@gridGutterWidth * 2) - (@padding10 * 2);}

... same way for all spans and padding types 
```

为什么第二种方式不向跨度添加任何填充？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:21:25.343

使用`:`, 不在`=`变量赋值中。

```
@padding10: 10px;
@padding20: 20px;
@padding30: 30px;
@padding40: 40px; 
```

通常，您可以使用[此编译器](http://winless.org/online-less-compiler)来检查您的`LESS`代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T12:57:07.880

由于您使用较少，您不妨让它为您完成工作。将此与其他引导程序较少的文件一起添加。在引导程序和响应式 css 之后包含它。这可以扩展到包括流体和偏移布局，但我不使用它们。

```
// REPEAT VARIABLES
// -------------------------
// Required since we compile the responsive stuff separately
@import "variables.less"; // Modify this for custom colors, font-sizes, etc

// Padding mixin
.padding (@gridColumnWidth, @gridGutterWidth,@padding) {
    // PadX mixin accepting column numbers greater than zero
    .padX (@index) when (@index > 0) {

        // Write out the span number using escaping
        (~".span@{index}.padded@{padding}") { 
            // Call the .pad mixin below with the column number
            .pad(@index); 
        }

        // Decrement the index and calls itself again
        // This is the less version of a for loop
        .padX(@index - 1);
    }

    // Catch the zero valued index essentially terminating the loop
    .padX (0) {}    

    // Mixin for padding
    .pad(@columns) {
        width: (@gridColumnWidth * @columns) + (@gridGutterWidth * (@columns - 1) 
                - (@padding * 2));
    }

    // This will be written out
    (~".padded@{padding}")  {
        // Trick to add px to the end of your padding
        padding: 0px+@padding;
    }

    // Call the padX mixin with gridColumns as starting value
    .padX(@gridColumns);
}

// grid.less overide
// -------------------------
// Call the padding mixin
.padding(@gridColumnWidth, @gridGutterWidth, 10);
.padding(@gridColumnWidth, @gridGutterWidth, 20);

// responsive overides
// -------------------------
//Kill these if not using responsive
@media (min-width: 768px) and (max-width: 979px) {
  // Fixed grid
  .padding(@gridColumnWidth768, @gridGutterWidth768,10);
  .padding(@gridColumnWidth768, @gridGutterWidth768,20);
}

@media (min-width: 1200px) {
  // Fixed grid
  .padding(@gridColumnWidth1200, @gridGutterWidth1200,10);
  .padding(@gridColumnWidth1200, @gridGutterWidth1200,20);
} 
```

您可以在这个很棒的[编译器](http://winless.org/online-less-compiler)中对其进行测试，但是您需要粘贴 variables.less 内容或必需的变量来代替 @import。

# r - 将数据集导入矩阵

> ID：11908544
> 
> 赞同：0
> 
> 时间：2012-08-10T20:08:15.900
> 
> 标签：r, csv, dataset

亲爱的 StackOverflow 社区，

我有一个来自我的大学项目的数据集，我正在尝试解析和运行一些计算。它看起来类似于：

```
Month,1,2,3,3,4,4,5,6,7
x.1,0,0,0,0,0,0,0,0,0
x.2,0,0,0,0,0,0,0,0,0
x.3,0,0,0,6,5,5,,,15
x.4,0,0,0,7,7,,,,15
x.5,1,1,1,11,7,5,,,0
x.6,1,1,1,14,6,,,,0
x.7,1,1,1,17,5,,,,15
x.8,1,1,1,21,4,,,,15
x.9,0,0,0,1,1,1,1,1,0
x.10,0,0,0,1,1,1,1,1,0
x.11,1,0,0,1,1,1,1,1,0
x.12,0,0,0,0,0,0,0,0,1
x.13,0,0,0,0,0,0,0,0,0
x.14,0,1,0,0,0,0,0,0,0
x.20,orchid,,,orchid,rose,orchid,orchid,orchid,
x.23,0,0,0,1,1,1,1,1,1
x.24,,,,,buttercup,buttercup,buttercup,buttercup,lilac
x.25,0,0,0,1,1,0,1,1,1
x.26,,,,17,,,,,15
x.27,,,,999,,,,,15 
```

然后我尝试像这样导入它：

```
data <- read.csv("~/data_munging/data.csv", header=F)
my_matrix <- as.matrix(data) 
```

这里的问题是数据集的第一列实际上是变量的名称，而`as.matrix()`不是将其读取为行（变量）名称。

（一些数据也有漏洞，但我会留下另一个问题）。

我是 R 新手，想知道我在做什么错™？

**更新：** 根据贾斯汀的评论，这是导入数据集及其`str()`产生的方法：

```
> sample_data <- read.csv("~/data_munging/sample_data.csv", header=F)
> str(sample_data)
'data.frame':   28 obs. of  10 variables:
 $ V1 : Factor w/ 28 levels "Month","x.1","x.10",..: 1 2 13 22 23 24 25 26 27 28 ...
 $ V2 : Factor w/ 4 levels "","0","1","orchid": 3 2 2 2 2 3 3 3 3 2 ...
 $ V3 : int  2 0 0 0 0 1 1 1 1 0 ...
 $ V4 : int  3 0 0 0 0 1 1 1 1 0 ...
 $ V5 : Factor w/ 12 levels "","0","1","11",..: 8 2 2 9 10 4 5 6 7 3 ...
 $ V6 : Factor w/ 9 levels "","0","1","4",..: 4 2 2 5 7 7 6 5 4 3 ...
 $ V7 : Factor w/ 7 levels "","0","1","4",..: 4 2 2 5 1 5 1 1 1 3 ...
 $ V8 : Factor w/ 6 levels "","0","1","5",..: 4 2 2 1 1 1 1 1 1 3 ...
 $ V9 : Factor w/ 6 levels "","0","1","6",..: 4 2 2 1 1 1 1 1 1 3 ...
 $ V10: Factor w/ 6 levels "","0","1","15",..: 5 2 2 4 4 2 2 4 4 2 ... 
```

我认为它应该是一个矩阵的原因是因为它以这种方式读取`Month`作为一个因素，它的水平是行名而不是​​飞蛾（一年中的月份）。

**更新 2：**现在使用 CSV 中的原始数据集。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:33:22.970

矩阵和数据帧有一个转置方法，它返回一个矩阵。：

```
tdat <- t( read.table(text="Month,1,2,3,3,4,4,5,6,7
 x.1,0,0,0,0,0,0,0,0,0
 x.2,0,0,0,0,0,0,0,0,0
 x.3,0,0,0,6,5,5,,,15
 x.4,0,0,0,7,7,,,,15
 x.5,1,1,1,11,7,5,,,0
 x.6,1,1,1,14,6,,,,0
 x.7,1,1,1,17,5,,,,15
 x.8,1,1,1,21,4,,,,15
 x.9,0,0,0,1,1,1,1,1,0
 x.10,0,0,0,1,1,1,1,1,0
 x.11,1,0,0,1,1,1,1,1,0
 x.12,0,0,0,0,0,0,0,0,1
 x.13,0,0,0,0,0,0,0,0,0
 x.14,0,1,0,0,0,0,0,0,0
 x.20,orchid,,,orchid,rose,orchid,orchid,orchid,
 x.23,0,0,0,1,1,1,1,1,1
 x.24,,,,,buttercup,buttercup,buttercup,buttercup,lilac
 x.25,0,0,0,1,1,0,1,1,1
 x.26,,,,17,,,,,15
 x.27,,,,999,,,,,15", sep=",", header=FALSE, as.is=TRUE) )
 # It might not be immediately obvious that the transpose function converts to matrix
 newdat <- tdat[-1, ]
 colnames(newdat) <- dat[1,]
 newdat <- as.data.frame(newdat)   
# when converted back , everything is factors. Will need to convert to get numeric
  newdat[ , -grep("20|24", names(newdat) ) ] <- 
                    lapply(newdat[ , -grep("20|24", names(newdat) )], 
                             function(x) as.numeric( as.character(x) ))
# Need to use grep to convert character-names to numeric so can use negative indexing
# and used the redundant `as.numeric(as.character(x))` to illustrate good practice. 
```

导致：

```
> newdat
    Month x.1 x.2 x.3 x.4 x.5 x.6 x.7 x.8 x.9 x.10 x.11 x.12 x.13 x.14   x.20 x.23      x.24 x.25 x.26 x.27
V2      3   2   2   3   3   4   4   3   3   2    2    3    2    2    3 orchid    2              2    1    1
V3      1   1   1   2   2   2   2   2   2   1    1    1    1    1    2   <NA>    1      <NA>    1   NA   NA
V4      2   1   1   2   2   2   2   2   2   1    1    1    1    1    1   <NA>    1      <NA>    1   NA   NA
V5      4   2   2   6   5   5   5   5   5   3    3    3    2    2    3 orchid    3              3    3    3
V6      5   2   2   5   5   7   6   6   6   3    3    3    2    2    3   rose    3 buttercup    3    1    1
V7      5   2   2   5   1   6   1   1   1   3    3    3    2    2    3 orchid    3 buttercup    2    1    1
V8      6   2   2   1   1   1   1   1   1   3    3    3    2    2    3 orchid    3 buttercup    3    1    1
V9      7   2   2   1   1   1   1   1   1   3    3    3    2    2    3 orchid    3 buttercup    3    1    1
V10     8   2   2   4   4   3   3   4   4   2    2    2    3    2    3           3     lilac    3    2    2 
```

我确实注意到有可能是缺失值指示符的 999 值，以及因子列中缺失的两个不同值。这是 read.table 如何输入列的副作用。它“认为” V3 和 V4 列是数字的，并将连续逗号作为真正的缺失处理，而所有其他列（在换位之前）被视为因子或字符变量，并且连续逗号变成了“”，这是不一样的作为 _NA_character 或因子的 NA。

# html - 将 html5 播放器悬停在 chrome 中不起作用

> ID：11908547
> 
> 赞同：0
> 
> 时间：2012-08-10T20:08:35.890
> 
> 标签：html, google-chrome, video, hover

我正在尝试在鼠标悬停时播放 html 5 视频。它在 Firefox 和 safari 中运行良好，只是在 chrome 中，当我悬停时视频空白，只有在我将鼠标悬停在页面上的另一个元素上后才可见....

这是网站：[www.manart.de](http://www.manart.de)

这是代码：

```
 <div id="wrapper">
    <video id="video-example" width="880" height="495" poster="fileadmin/cover.png" loop>
    <source src="fileadmin/schiffchen.ogg.ogv" type="video/ogg"></source>
    <source src="fileadmin/schiffchen.mp4" type="video/mp4"></source>
    </video>    
    </div><!--end wrapper-->

    <script src="fileadmin/js.js"></script> 
```

这是js：

```
 document.addEventListener('mouseover',hoverVideo,false);
    var vid = document.getElementById('video-example');
    function hoverVideo(e)
    {   
    if(e.target == vid)
    {
    vid.play();
    this.addEventListener('mouseout',hideVideo,false);
    }

    } 
```

谢谢帮忙！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T22:45:08.030

这有点奇怪，但是如果您删除海报框架（我还确保`hideVideo`定义了该方法以避免引发异常），它就可以工作（[小提琴](http://jsfiddle.net/VVe47/2/)）。

我尝试使用 a`JPG`而不是 a`PNG`作为具有相同结果的海报框架（[小提琴](http://jsfiddle.net/DCfdA/)）。当您用声音替换视频时，很明显视频正在播放，但它是不可见的（[小提琴](http://jsfiddle.net/Cc2YW/2/)）。

对我来说看起来像是 Chrome 中的一个错误，但当我搜索时谷歌并没有抛出太多问题（也许我的术语是错误的）。

因此，快速修复可能是简单地删除海报框架，因为 Chrome 会在加载后显示视频的第一帧，无论如何可能非常接近您正在寻找的内容。

**更新：**

[或者，您可以在类似问题上](https://stackoverflow.com/questions/9565363/video-element-disappears-in-chrome-when-not-using-controls)使用此线程中详述的 hack，该问题涉及在播放开始之前向播放器动态添加控件并立即再次删除它们（[小提琴](http://jsfiddle.net/EGqjM/)）。作者通过验证 Chrome 19 中未出现该问题，确认该问题为 Chrome 中的错误。

**HTML：**

```
<div id="wrapper">
    <video id="video-example" poster="http://www.manart.de/fileadmin/cover.png" width="880" height="495" loop>
      <source id='mp4'
        src="http://www.manart.de/fileadmin/schiffchen.mp4"
        type='video/mp4'>
      <source id='ogv'
        src="http://www.manart.de/fileadmin/schiffchen.ogg.ogv"
        type='video/ogg'>
    </video>    
</div> 
```

**JavaScript：**

```
var vid = document.getElementById('video-example');
// add the listener directly to the video element
vid.addEventListener('mouseover',hoverVideo,false);

function hoverVideo(e) {   
    if (vid.getAttribute('controls') != 'true') {
        vid.setAttribute('controls', 'true');                    
    }
    vid.play();
    vid.removeAttribute('controls');
    vid.addEventListener('mouseout',hideVideo,false);
}

function hideVideo(e) {
    // do whatever you were going to do here, but omitting
    // the method completely causes an exception
    //vid.pause();   

    // clean up the listener when finished
    vid.removeEventListener('mouseout', hideVideo);
} 
```

# c - 三元运算符的不寻常使用

> ID：11908550
> 
> 赞同：2
> 
> 时间：2012-08-10T20:08:52.360
> 
> 标签：c, ternary

我是 C 的新手，我理解为什么三元运算符很有用，代码比 if/else 块少。

我得到了一些 C 代码来维护，我注意到的一件事是以前的程序员使用了像这样的三元运算符

```
myInt = (!myInt) ? MACRO1 : MACRO2; 
```

这是否完成与此完全相同的事情：

```
myInt = myInt ? MACRO2 : MACRO1; 
```

这只是一种风格吗？也许考虑“如果不是”myInt 而不是“如果”是有意义的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T20:11:02.937

是的，这段代码完成了完全相同的事情。它仅取决于编写条件时使用的逻辑 - 因此可以将其归结为样式（即您更容易想到的那个）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T20:11:12.497

是的，你是对的。似乎该代码的创建者想让表达式比它需要的更混乱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T20:19:07.477

我更喜欢第二个例子，因为它没有使用反向逻辑，因此更容易理解并且更少混乱。

```
myInt = myInt ? MACRO2 : MACRO1; 
```

# sql - 将日期时间与 nvarchar 结合

> ID：11908551
> 
> 赞同：-2
> 
> 时间：2012-08-10T20:08:53.690
> 
> 标签：sql, sql-server, tsql

我在 DB 中有两列：`StartDate`（datetime 列）和`StartTime`（nvarchar 列）。 `StartDate`包含事件应该开始的日期。 `StartTime`包含事件应该开始的时间。它是 24 小时格式（例如，22:00 或 12:00）。

我需要结合`StartDate`在`StarTime`子句中使用它`WHERE`并将结果与​​变量进行比较。它看起来像：

```
WHERE COMBINED_STARTDATE_WITH_STARTIME >= @DATETIME_VARIABLE 
```

我正在使用 SQL SERVER 2008。这是现有的数据库设计，不想更改它。可能，我可以创建第三列并将 datetime + startdate 组合成一列，但我正在寻找另一种解决方案（不涉及数据库）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:16:13.480

你可以使用这样的东西：

```
WHERE 
dateadd(minute, cast(right(starttime, 2) as int),
    dateadd(hour, cast(left(starttime, 2) as int), startdate)) >= @DATETIME_VARIABLE 
```

[SQL Fiddle 与 DateTime 转换](http://sqlfiddle.com/#!3/0eb43/8)

如果开始时间是，`null`那么您可以使用`IsNull()`该值：

```
WHERE
dateadd(minute, cast(right(isnull(starttime, 0), 2) as int),
    dateadd(hour, cast(left(isnull(starttime, 0), 2) as int), startdate)) >= @DATETIME_VARIABLE 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/0eb43/22)

当然，如果您使用的是 SQL Server 2008+，您可以将您的值转换为时间：

```
WHERE startdate + IsNull(StartTime, '00:00') >= @DATETIME_VARIABLE 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/0eb43/31)

# python - 在 python 中向鼻子测试添加更多测试模式？

> ID：11908552
> 
> 赞同：1
> 
> 时间：2012-08-10T20:08:55.453
> 
> 标签：python, nosetests

所以我有一个名为“test”的目录，里面还有几个目录，里面有很多测试。如何添加这样的模式，以便鼻子测试确定这些测试并运行它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:15:56.277

您可以`nosetests`使用选项 运行`-i` `--include`：

```
-i REGEX, --include=REGEX
                      This regular expression will be applied to files,
                      directories, function names, and class names for a
                      chance to include additional tests that do not match
                      TESTMATCH.  Specify this option multiple times to add
                      more regular expressions [NOSE_INCLUDE] 
```

# data-structures - 收集分析数据的更好的想法/数据结构

> ID：11908554
> 
> 赞同：2
> 
> 时间：2012-08-10T20:08:56.843
> 
> 标签：data-structures, clojure

我正在收集分析数据。我正在使用包含许多其他嵌套地图的主地图。

考虑到地图是不可变的，许多新地图将被分配。（是的，这在 Clojure 中很有效）。
我使用的基本操作是 update-in ，非常方便更新给定路径的值或为不存在的值创建绑定。

一旦达到特定点，我就会将该数据结构保存到数据库中。

在 Clojure 中更有效地收集这些数据会有什么更好的主意？瞬态数据结构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:33:23.550

与所有优化一样，**首先测量**，如果地图更新是一个瓶颈，那么切换到瞬态地图是一个相当无干扰的代码更改。如果您发现 GC 开销是真正的罪魁祸首，因为它通常是持久性数据结构，并且瞬态没有足够的帮助，那么**将数据收集到一个列表中并将其批量添加到一个瞬态映射**中，该映射持久化并保存到数据库中最终可能是一个更有效但更大的变化。添加到列表会产生非常少的 GC 开销，因为与添加到映射不同，旧的头不需要被丢弃和 GCd

# php - 是否可以仅使用 PHP/HTML 从受保护的目录中读取？

> ID：11908560
> 
> 赞同：0
> 
> 时间：2012-08-10T20:09:16.403
> 
> 标签：php, html

我有一个目录，其中包含在特定日期之前不应该在世界范围内访问的数据。

当然，该目录不应该通过网络浏览器直接在世界范围内可读。我目前用 .htpasswd 和 .htaccess 解决了这个问题。

但是，上一级目录有一个世界可读的 .php 文件。PHP 文件根据日期有条件地生成`<img .../>`从受保护目录中读取的基本 HTML 标记（例如 ）。

不幸的是，在我的测试中，.php 文件需要身份验证才能加载数据。我的问题是我是否在尝试做一些根本不可能的事情，或者我是否可以对其进行调整以使其发挥作用。另外，如果可能的话，是否还有其他我应该知道的问题（安全或其他）？

附加信息：

*   如果可能的话，我宁愿不使用 Javascript。
*   PHP 5.3 可用。
*   关于解决方案的任何其他想法（我已经想到了一个 cron-job，我可能会这样做）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:25:09.677

我猜您可能遇到的一个问题是，如果您尝试`<img src="protected.jpg" />`从不受保护的 php 文件中输出，您将能够显示 HTML，但不能显示图像文件本身。

如果我正确理解你想要做什么，你需要：

*   在 PHP 中编写某种代理脚本，以控制对每个文件的访问（这有点乏味，需要生成正确的标头 + mime 类型）。
*   使用时间/日期条件直接从 .htaccess 控制访问，这可能是您的最佳选择。见那里：[http ://www.askapache.com/htaccess/time_hour-rewritecond-time.html](http://www.askapache.com/htaccess/time_hour-rewritecond-time.html)

**编辑：代理示例：**我似乎无法在线找到示例，所以这是我希望控制从 PHP 对文件的访问时经常使用的功能（例如，这可能是需要从 $ 验证其访问权限的敏感数据_SESSION 或 DB 值）：

```
function send_binary_data($path, $mimetype, $filename = null){

    @ob_clean();

    if($filename === null) $filename = basename($path);
    $size = filesize($path);

    //no-cache
    header('Cache-Control: no-cache, must-revalidate, public');
    header('Pragma: no-cache');

    //binary file
    header('Content-Transfer-Encoding: binary');

        //mimetype
    header('Content-Type: ' . $mimetype);
    header('Content-Length: ' . $size);
    header('Content-Disposition: inline; filename=' . $filename);
    header('Content-Description: ' . $filename);

    $chunksize = 1 * (1024 * 1024);
    $buffer = '';
    $handle = fopen($path, 'rb');

    if ($handle === false) {
        return false;
    }

    while (!feof($handle)) {
        $buffer = fread($handle, $chunksize);
        print $buffer;
    }

    $result = fclose($handle);
    unset($handle);
    $handle = null;

    die();

} 
```

当然，您仍然需要限制来自 .htaccess 的直接访问，但如果是代理，您会将所有请求重定向到不受保护的代理脚本，如下所示：

```
RewriteEngine ON
RewriteRule ^(.*)$ /proxy.php?file=$1 [NC,QSA] 
```

proxy.php 将包含以下内容：

```
if(!isset($_GET['file'])) die('file not set');
$file = $_GET['file'];

//perform all your custom checking, including security checks due to retrieving data from $_GET, and if access is granted :

$path = 'yourpath/'.$file;
$mimetype = 'defineregardingyour/ownrules';
send_binary_data($path, $mimetype); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:17:21.843

.htaccess 仅用作直接从 Internet 到目录的访问控制。

PHP 访问由 chmod 权限控制。尝试将其更改为 755。您仍然可以使用 .htaccess 文件对其进行密码保护或任何其他类型的保护。

考虑到添加的注释，我假设您正在尝试在输出中包含受保护目录内的图像。自然，未经身份验证的用户无法访问它们……否则您为什么要保护它们？

您可以将需要全世界可访问的文件添加到您的 .htaccess 文件中。

# java - Eclipse：有没有办法区分 jar 和项目？

> ID：11908561
> 
> 赞同：1
> 
> 时间：2012-08-10T20:09:28.760
> 
> 标签：java, eclipse

我有一个 .jar 文件，它代表我试图弄乱的插件。这是插件的旧版本，而新版本是由其他人编写的。我有这个较新的版本作为一个项目。

较新的项目充满了 .java 文件，而旧插件充满了 .class 文件。我可以将 jar 作为项目导入，但它仍然是所有类文件。class文件和java文件的区别不是特别大，我想看看它们之间的区别。但是，当我现在这样做时，文本比较会将 .class 文件从其在编辑器中的正常表示更改为二进制表示。我知道如果它们是相同类型的文件，我可以选择两者并点击“比较”。如何在 .class 和 .java 文件之间执行此操作，或者如何以仍然允许我比较两者的方式将一个转换为另一个？

真正最好的是，如果我有某种方法可以通过将 .class 文件转换为 .java 文件来编辑 jar。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:21:27.210

您似乎需要一个反编译器来将 Java .class 文件（字节码）转换回其原始 .java 源文件（文本）。然后你可以比较这两个文本文件。这似乎很有用：http: [//java.decompiler.free.fr](http://java.decompiler.free.fr)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:32:20.357

您可以使用 SOOT (http://www.sable.mcgill.ca/soot/) 来执行此操作。有两种可能的方法：

1.  在 SOOT 中使用 Dava 将 .class 文件反编译成 .java 文件，然后比较 .java 文件。
2.  将 .class 和 .java 文件都转换为 SOOT 中称为 Jimple 的中间表示，并比较 Jimple 文件。

我认为第二种方法更合理，因为：

1.  在第一种方法中，一些 Java 文件是手动开发的，而另一些是机器生成的。对它们进行比较会产生难以阅读的结果。
2.  Jimple 表示非常接近 Java 源代码并且相对容易阅读。在这种统一的机器生成格式上读取差异结果要容易得多。此外，如果您愿意，您可以将所有 Jimple 文件转换回 Java 源代码（嗯，这是第三种方法......）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T20:38:35.490

因为它是一个插件，所以我可以将它作为一个插件项目导入，并且有一个包含源文件夹的框。当我检查我是否可以访问 .java 代码并且能够成功区分时。

# jquery - jQuery：在悬停时淡入 1 个元素，同时以平滑的方式淡出许多其他元素

> ID：11908562
> 
> 赞同：0
> 
> 时间：2012-08-10T20:09:30.257
> 
> 标签：jquery

在我的页面中，我有几个 div。当用户将鼠标悬停在 1 个 div 上时，我想淡出除用户悬停的元素之外的所有其他元素。但是，这适用于下面的代码：当用户将鼠标快速移动到所有项目上时，看起来好像每个项目的淡入淡出过程都在排队，即使用户不再移动鼠标，淡出也会继续，直到队列是空的。要进行测试，请检查下面的代码并将鼠标从左向右移动并注意效果。

我想要实现的是用户悬停在其上的当前项目的不透明度为 1，而其他项目的不透明度为 0.7。我怎样才能做到这一点？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<script type="text/javascript" src="/script/jquery-1.4.2.min.js"></script>
<style>
body{background-color:Red;}

.elementhighlight
{
    font-weight:bold !important;
    color:#FFF !important;
}

.elementhovered{background-color:#AE2460 !important;}

.element 
{
width:140px;
height:130px;
padding-left:4px;
padding-right:4px;
float:left;
cursor:pointer;
}

.element0{background-color:#FFF;}
.element1{background-color:#E6E4E0;}

.element .title,.element1 .title{
font: 12px Helvetica, verdana !important;    
text-align:center;
padding-top:4px;
padding-bottom:4px;
color:#666666;
}

</style>

</head>

<script language="javascript" type="text/javascript">

$(document).ready(function () {        
    $('.element').hover(function () {
        var curelement = $(this);            
        curelement.fadeTo(500, 1.0);
        curelement.addClass('elementhovered');

        curelement.stop().fadeTo(500, 1.0);
        $('.element').not('.elementhovered').stop().fadeTo(500, 0.7); 
        curelement.find('.title').addClass('elementhighlight');
    },
    function () {
        $('.element').fadeTo(300, 1.0);
        var curelement = $(this);
        curelement.removeClass('elementhovered');
        curelement.find('.title').removeClass('elementhighlight');
    });
});
</script>

<body>

<div class="element element0">
    <div class="title">Item</div>
</div>
<div class="element element1">
    <div class="title">Item</div>
</div>
<div class="element element0">
    <div class="title">Item</div>
</div>
<div class="element element1">
    <div class="title">Item</div>
</div>
<div class="element element0">
    <div class="title">Item</div>
</div>
<div class="element element1">
    <div class="title">Item</div>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:12:56.993

您可以添加`.stop()`阻止队列建立：

```
curelement.stop().fadeTo(500, 1.0);

$('.element').not('.elementhovered').stop()fadeTo(500, 0.7); 
```

# asp.net - 为什么我的 TextBoxWatermarkExtender 只加载一个 CSS 类？

> ID：11908569
> 
> 赞同：0
> 
> 时间：2012-08-10T20:09:58.133
> 
> 标签：asp.net, css, ajaxcontroltoolkit

我在 TextBox 上使用了 TextBoxWatermarkExtender，它工作得几乎完美。功能就在那里：占位符文本在输入其他文本或 TextBox 具有焦点时消失。但是，它似乎只能加载一个 CSS 类，即 TexBox 的类。我正在使用团队代码，解决方案中的其他地方是 TextBoxWatermarkExtender，它使用的类与其附加的文本框不同，所以我知道这是可能的。发生的情况是 TextBoxWatermarkExtender 似乎使用了我不能拥有的默认 CSS。相关代码如下，如果您需要我的其他任何东西，请告诉我。

TextBoxWatermarkExtender 的代码：

```
<asp:RadioButton id="FunctionalityTypeText" GroupName="FunctionalityTypes"  runat="server"/>
<asp:TextBox runat="server" id="tbFunctionalities" CssClass="AddTaskForceDetails" MaxLength="240"></asp:TextBox>
<AjaxControlToolkit:TextBoxWatermarkExtender ID="TextBoxWatermarkExtender2" 
    runat="server" TargetControlID="tbFunctionalities"
    WatermarkText="Custom..." WatermarkCssClass="AddTaskForceDetails"/> 
```

有效的 CSS 类：

```
.AddTaskForceDetails
{
    width: 425px;
    margin: 5px;
} 
```

我想使用的 CSS 类：

```
.Watermark
{
    width: 425px;
    margin: 5px;
    color: Gray;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T02:44:43.547

您是否尝试过使用内联 CSS，只是为了看看会发生什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T13:20:47.673

好吧，我不确定发生了什么，但我的 TextBoxWatermarkExtender 现在可以正常工作了。它所属的表单有自己的 CSS，主要解决方案不是每次都加载 CSS。自己在浏览器中加载表单 ASPX 文件会显示更新的 CSS，而下次我运行该解决方案时，CSS 仍然存在。所以，蒂姆，谢谢你的建议，但我想解决这个问题只是运气。

# c# - 当内存中的 RAM 不足时，我们会遇到什么异常？

> ID：11908570
> 
> 赞同：0
> 
> 时间：2012-08-10T20:10:04.393
> 
> 标签：c#

如果我正在做一个递归算法来遍历一棵树……我知道它有很多数据，巨大的……大约 20 分钟后，我得到一个“堆栈溢出”异常。但是 StackOverFlow 可能是因为代码中的其他一些错误，可能是因为无限循环......所以我只是想确保我在 VisualStudio 中遇到的这个 SOF 错误是因为我的递归算法用完了 RAM，而不是因为其他错误...当我们在递归算法中耗尽内存时，我们是否有特殊类型的错误消息或异常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:13:10.267

如果内存不足，则会出现[OutOfMemory 异常](http://msdn.microsoft.com/en-us/library/system.outofmemoryexception.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T20:13:05.447

`System.OutOfMemoryException`

[http://msdn.microsoft.com/en-us/library/system.outofmemoryexcetion.aspx](http://msdn.microsoft.com/en-us/library/system.outofmemoryexcetion.aspx)

同样正如@SLaks 指出的`StackoverflowException`那样，由于内存不足，永远不会发生。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T20:14:05.963

内存不足时会抛出[System.OutOfMemoryException 。](http://msdn.microsoft.com/en-us/library/system.outofmemoryexception.aspx)[System.StackOverflowException](http://msdn.microsoft.com/en-us/library/system.stackoverflowexception.aspx)是您使用递归超复杂或没有终止案例的东西破坏了调用堆栈。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T20:14:32.090

您必须报告“低 RAM”的最接近的事情是[OutOfMemoryException](http://msdn.microsoft.com/en-us/library/system.outofmemoryexception.aspx)，但这只是在无法为下一个操作分配足够的连续 RAM 时。这并不意味着主机内存不足。

StackOverflowException 可能包含这个作为内部异常，但我不确定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-10T20:24:46.123

如果你的树很深，为什么不管理自己的堆栈而不是使用递归呢？就像是：

```
Stack<Node> stack = new Stack<Node>();
stack.Push(rootNode);
Node currentNode;
while( (currentNode = stack.Pop()) != null)
{
    foreach(var childNode in currentNode.Children)
    {
        stack.Push(childNode);
    }
    //process this node.
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-10T21:01:55.047

我给自己做了一个小递归实验，在耗尽堆栈空间之前给了我大约 87000 次迭代。方法调用总是使用堆栈而不是堆。如果有一种方法可以创建基于堆的堆栈，那么您可能会做得更多。在这方面，请阅读以下文章（尽管它可能不适用于 C#！）：

[仅使用堆区域的递归](https://stackoverflow.com/questions/2807131/recursion-using-only-heap-area)

另外，看看这个...

[http://joel.inpointform.net/software-development/explanation-of-stack-heap-and-recursion-causing-stack-overflow/](http://joel.inpointform.net/software-development/explanation-of-stack-heap-and-recursion-causing-stack-overflow/)

编辑。在回答你的问题...

通常情况是，如果您的应用程序试图超出堆栈空间，您将收到 StackOverflowException。如果您的应用程序试图超出堆空间，您将收到 OutOfMemoryException

# c++ - void* 指针的右转换

> ID：11908572
> 
> 赞同：1
> 
> 时间：2012-08-10T20:10:12.970
> 
> 标签：c++, casting

我正在尝试实现一个 C++ 类，它的`value`字段可以指向任何东西（有点像 boost::any）。目前我执行以下操作：

```
class MyClass {
  void* value;
  template<typename T>
  Myclass(const &T v) {
    value = (void*)(new T(v));
  }
}; 
```

现在的问题是实现一个 getValue() 操作，该操作创建具有正确类型的内部值的副本：

```
template<typename T>
T getValue() {
 return *value;
} 
```

在这里它不能工作，因为我试图取消引用 void* 指针。我想知道我应该使用哪个强制转换（static_cast？dynamic_cast？其他...），以便 *value 正确转换为 T 对象，如果 value 最初不是这种类型，则会引发异常？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:13:52.000

你不能取消引用 a `void*`，它根本没有意义。为什么不让类本身通用？然后你可以拥有：

```
template<typename T>
class MyClass {
  T* value;

  MyClass(const T& v) {
    value = new T(v);
  }

  T getValue() {
    return *value;
  }
}; 
```

确保创建一个析构函数，该析构函数释放`value`并遵循[The Rule of Three](http://en.wikipedia.org/wiki/Rule_of_three_%28C++_programming%29)。如果不需要，您还可以制作一个`getValue`返回`const T&`( `const`reference to ) 的版本以避免复制。`T`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T00:48:48.023

> which cast (static_cast?dynamic_cast? other...) 我应该使用这样 *value 被正确转换为 T 对象

如果您必须进行此转换，那么您应该使用`static_cast`，它通常旨在（除其他外）反转任何标准转换。从任何对象指针类型到 都有一个标准转换`void*`，并且您的 getter 将其反转，因此请使用为此设计的转换：

```
return *static_cast<T*>(value); 
```

您还应该从构造函数中删除 C 样式转换，或者将其替换为 a `static_cast`。

A`reinterpret_cast`也可以，但是“过大”。一般来说，您应该使用尽可能严格的强制转换，同时仍然执行您需要的转换。

> 如果 value 最初不是这种类型，则会引发异常

你在那里不走运 - 一旦你将指针转换为`void*`. 您的代码依赖于调用者以`getValue`正确的类型调用。例如，考虑如果原始类型是`char`- 在 C++ 中只有一个字节，没有为任何类型信息留出空间来允许编译器检查`getValue`.

`dynamic_cast`在某些有限的情况下会检查类型，但由于您的模板是完全通用的，因此这些有限的情况可能不适用。

如果你不喜欢这样，你可以改变你的类，除了对象指针之外，还存储一个指向对象的指针`type_info`（由于使用了`typeid`运算符）。请参阅标准标题`<typeinfo>`。然后，您可以将构造函数`type_info`中类型的对象与 in 类型的对象进行比较，如果它们不匹配则抛出。`T``type_info``T``getValue`

正如您所说，您的课程旨在有点像`boost::any`，并且`getValue`就像`any_cast`。您可以查阅该类的源代码和文档，以了解执行您想要的操作所需的技巧。如果有一个简单的方法来做到这一点，那么`boost::any`将是一个简单的类！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:14:52.560

你不能。C++ 不提供这种机制，至少不直接提供，对于`void*`. A`void*`没有计算机需要确定它是什么的*任何信息，并且尝试“检查”它是否是有效的“随便你投它”是不可能的，因为没有特定的标志。*

不过，有一些选择。第一种是使用某种通用基类，类似于 Java 的 Object，并从中派生所有其他类。`dynamic_cast`现在将以您想要的方式工作（`NULL`如果对象不是您将其转换为的类的有效对象，则返回）。

另一个是简单地跟踪你自己是什么类型的对象。这意味着`void*`用另一个值来增加它，该值告诉您需要将其转换为什么。

但实际上，这些东西都不是好主意。我认为几乎可以肯定你的设计的其他方面应该改变而不是使用这些。使用模板，如@EdS。建议，例如，是一个非常好的选择。

# jquery - 从 ajax 模式对话框返回一个值到主视图

> ID：11908576
> 
> 赞同：0
> 
> 时间：2012-08-10T20:10:45.090
> 
> 标签：jquery, asp.net-mvc-3, razor

我正在使用 jQuery 打开一个模态对话框，如下所示：

```
$('#AddCustomerDialog').dialog(
    {
    autoOpen: false,
    width: 400,
    resizable: false,
    modal: true,
    buttons:
    {
        "Done": function () {
        $(this).dialog('close');
        }
    }
});

$('#AddCustomerLink').click(function () {
    linkObj = $(this);
    var dialogDiv = $('#AddCustomerDialog');
    var viewUrl = "/Cases/AddCustomer";
    $.get(viewUrl, function(data) {
        dialogDiv.html(data);
        //open dialog
        dialogDiv.dialog('open');
    });
    return false;
    });
}); 
```

对话框上部分视图的目的是“即时”输入新的客户记录。我想让新的客户 ID 返回到调用视图，但我不确定如何使用我正在使用的代码执行此操作。任何建议或示例将不胜感激。

****编辑 2012 年 8 月 16 日*****

那么我应该用控制器动作做这样的事情吗？

```
public JsonResult AddCustomer()
{
    var result = ...insert statement here

    ...linq select to get new customerid
    {
       CustomerID = c.CustomerID
       ...
    };
return Json(variable, JsonRequestBehavior.AllowGet); 
} 
```

我知道这很混乱，但是有了这个基本想法，这会给我我需要的东西吗？

R

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:51:03.360

您可以使用“完成”按钮单击回调，例如

```
if (!$("#AddCustomerDialog form").valid())
    return false;
var postUrl = $("#AddCustomerDialog form").attr('action');
$.post(postUrl, $(containerSelector + ' form').serialize(),
        function (result) {
            $("#AddCustomerDialog").dialog("close");
            var addedCustomerId = result.Id;
        }); 
```

AddCustomer 操作（用于发布请求）也应该以 Json 格式返回添加的客户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:40:59.050

在您的 html 页面脚本中声明一个变量，现在在您的 php 代码的返回数据中添加一个带有变量名称的 echo 脚本并在此处设置您想要的 id

在你的脚本中： var foo;

在你的 php 代码中

```
echo 'data for insert in div';
echo '<script>foo=id_you_want</script>';
exit(); 
```

有了这个，您在 html 页面中使用新客户的 id 设置 foo var 并可以使用它

# javascript - JavaScript：不仅仅是倒计时/倒计时脚本

> ID：11908579
> 
> 赞同：1
> 
> 时间：2012-08-10T20:11:03.137
> 
> 标签：javascript

我真的希望这里有人可以帮助我……尽管解释我正在寻找的东西有点复杂。

基本上我正在寻找一个“倒计时/倒计时”javascript -*听起来很简单，对吧？*

我发现了很多此类脚本的变体，但没有一个符合以下要求。

我特别需要的是一个脚本，它在页面加载时从 36000 秒开始倒计时。当达到 0 秒。立即开始倒计时至 36000 秒。

同时，我有这两个 div 应该既受脚本影响又受脚本影响：

```
<style>
.indicator {
width: 20px;
height: 8px;
}
</style>

<div class="percent">100%</div>
<div class="indicator"></div> 
```

如您所见，第一个 div 的 innerHTML 开始时为 100%，当脚本每 360 秒计数一次时，应减少 1。 *（例如：当计算超过第 3600 秒时，innerHTML 应该是 90%）*

第二个 div 的宽度为 20px，当脚本每 1800 秒计数一次时，它应该减少 1px。 *（例如：当计算超过第 3600 秒时，宽度应为 18px）*

*   36000 秒。= 100% = 20 像素
*   18000 秒。= 50% = 10 像素
*   3600 秒。= 10% = 2 像素
*   1800 秒。= 5% = 1 像素
*   360 秒。= 1% = 0像素

如前所述，脚本应在达到 0 秒时开始向上倒计时。发生这种情况时，第二个 div 的 className 应该从**指示符**更改为**充电**，第一个 div 的 innerHTML 应该根据 sec 的过去计数适当增加。 *（就像脚本倒数时一样）*

但是，当计数达到第 36000 秒时。它不应该只是重新开始倒计时，而是停在那里并将第二个 div 的 className 从**charging**更改为**charged**。不用说，此时第一个 div 的 innerHTML 应该是 100%。从这里开始，脚本只会在点击第二个 div 时开始倒计时，在这种情况下，第二个 div 的 className 应该从**charged** back 变为**indicator**。

此外，每当单击第二个 div 时，倒计时/倒计时将被反转，同时更改其类名。

*   **倒计时**：`<div class="indicator"></div>`
*   **计数**：`<div class="charging"></div>`

我为冗长的解释和我糟糕的英语语法道歉......

希望有人能够理解这一点:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:51:35.787

你为什么不使用像每 10 秒调用一次的计时器（因为你的变化点 mod 10 = 0），并检查变量是否处于这些值之一。例如：

```
var totalTime = 36000;
var timeLeft = totalTime;

setInterval(countdown, 10000);

function countdown()
{
    timeLeft -= 10;

    //Change innerhtml to timeLeft/totalTime * 100 + "%";
} 
```

至少我认为这应该让你开始。不过，您可能会改用 setTimeout，这样您最终可以结束递减，并开始递增。

[http://www.w3schools.com/js/js_timing.asp](http://www.w3schools.com/js/js_timing.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:01:58.967

这是新代码。它似乎可以正常工作，但它使用了 100 秒，并且由于某种原因，点击 ID 不再有效。您应该能够弄清楚它适用于您的特定秒设置。这是一个演示：http: [//jsfiddle.net/6anju/7/](http://jsfiddle.net/6anju/7/)

```
$(document).ready(function(){
    count_down(); //<-- When the page loads

    $('.indicator').click(function() {
        /** This works.. Just make sure you change the ID's properly **/
    });

    //*  Not working correctly. jQuery version type correct? *//
    $('#charging').click(function() {
        // Change ID back:
        var change_id = document.getElementById('charging');
        change_id.id = "indicator";
        count_down();
    });

    $('#charged').click(function() {
        // Change ID back:
        var change_id = document.getElementById('charged');
        change_id.id = "indicator";
        count_down();
    });

});

function count_down() {

    var counter = 100000; // 100 seconds
    var change_width_every = 5; // Change every 5 seconds
    var current_width = 20;  // Current width in px
    var current_percent = 100; // Current percent

    // Count down and run every 1 second
    var count_down = setInterval(function() {

        counter = counter - 1000; // Take a second away
        current_percent--; // Take away 1 percent
        change_width_every--;  // Take away 1 from the 5 seconds befor width change
        document.getElementById('percent').innerHTML = current_percent + "%"; // Edit the percent div

        if (change_width_every <= 0) { // If we exhaust our 5
            current_width--; // Edit your current width integer
            document.getElementById('indicator').style.width = current_width + "px"; // update the battery
            change_width_every = 5; // reinitialize
        }

        if (counter <= 0) {
            clearInterval(count_down); // kill the counter
            count_up(); // start counting up
        }

    }, 1000);
}

function count_up() {

    var counter = 0;
    var change_width_every = 5
    var current_width = 0;
    var current_percent = 0;
    // change the id to charging:
    var change_id = document.getElementById('indicator');
    change_id.id = 'charging';

    var counting = setInterval(function() {

        counter = counter + 1000;
        current_percent++;
        change_width_every--;
        document.getElementById('percent').innerHTML = current_percent + "%";

        if (change_width_every <= 0) {
            current_width++;
            document.getElementById('charging').style.width = current_width + "px";
            change_width_every = 5 // reinitialize
        }

        if (counter >= 100000) {
            change_id = document.getElementById('charging');
            change_id.id = "charged";
            clearInterval(counting);
        }

    }, 1000);

} 
```

​</p>

# r - R randomForest 的 rfcv 方法实际上是否说明了它选择了哪些功能？

> ID：11908582
> 
> 赞同：5
> 
> 时间：2012-08-10T20:11:15.780
> 
> 标签：r, machine-learning, classification, random-forest, feature-selection

在创建具有更多树的最终随机森林之前，我想使用 rfcv 从数据集中剔除不重要的变量（如果这不是使用此函数的方法，请更正并通知我）。例如，

```
>     data(fgl, package="MASS")
>     tst <- rfcv(trainx = fgl[,-10], trainy = fgl[,10], scale = "log", step=0.7)
>     tst$error.cv
        9         6         4         3         2         1 
0.2289720 0.2149533 0.2523364 0.2570093 0.3411215 0.5093458 
```

在这种情况下，如果我正确理解结果，似乎我们可以删除三个变量而不会产生负面影响。然而，

```
>     attributes(tst)
$names
[1] "n.var"     "error.cv"  "predicted" 
```

这些插槽都没有告诉我可以从数据集中无害地删除的前三个变量实际上是什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-11T12:11:08.093

我认为 的目的`rfcv`是确定您的准确性与您使用的变量数量之间的关系。当您有 10 个变量时，这似乎没有用，但是当您有数千个变量时，了解这些变量“增加”了多少预测能力非常方便。

您可能已经发现，这段代码

```
rf<-randomForest(type ~ .,data=fgl)
importance(rf) 
```

为您提供每个变量的相对重要性。

# php - PHP中的复合模式，如何设计类以解决扩展两个类的需要

> ID：11908586
> 
> 赞同：1
> 
> 时间：2012-08-10T20:11:27.553
> 
> 标签：php, class, design-patterns, class-design, composite

我正在使用[复合模式](http://www.giorgiosironi.com/2010/01/practical-php-patterns-composite.html)来拥有可重用的元素来构建页面。为此，我有一个简单的界面来驱动模式

```
interface Ai1ec_Renderable {
    /**
     * This is the main function, it just renders the method for the element,
     * taking care of childrens ( if any )
     */
    public function render();
} 
```

由于只允许某些元素有子元素，因此我创建了一个抽象类来添加该行为

```
abstract class Ai1ec_Can_Have_Children {
    /**
     *
     * @var array
     */
    protected $renderables = array();
    /**
     * Adds a renderable child to the element
     * 
     * @param Ai1ec_Renderable $renderable
     */
    public function add_renderable_children( Ai1ec_Renderable $renderable ) {
        $this->renderables[] = $renderable;
    }
} 
```

所以如果对象可以有孩子，它会扩展抽象类。出现问题是因为我有第二个用于 html 元素的抽象类

```
abstract class Ai1ec_Html_Element {
    /**
     *
     * @var string
     */
    protected $id;
    /**
     *
     * @var array
     */
    protected $classes = array();
    /**
     *
     * @param $id string        
     */
    public function set_id( $id ) {
        $this->id = $id;
    }

    public function add_class( $class ) {
        $this->classes[] = $class;
    }
    protected function create_class_markup() {
        if (empty( $this->classes )) {
            return '';
        }
        $classes = implode( ' ', $this->classes );
        return "class='$classes'";
    }
    protected function create_attribute_markup( 
        $attribute_name, 
        $attribute_value
    ) {
        if (empty( $attribute_value )) {
            return '';
        }
        return "$attribute_name='$attribute_value'";
    }
} 
```

The problem is that all the objects of the composite must implement the interface, some of them must extend only the first class ( can_have_children ) but not the second ( this is because they are higher level abstraction that configure another renderable object to do the job ), some of them the second but not the first and some of them both classes.

Have i done somthing wrong while designing my classes?How do i come out of it? The most obvious way is to make a class duplicating some code

```
abstract class Ai1ec_Can_Have_Children extends Ai1ec_Html_Element {
    /**
     *
     * @var array
     */
    protected $renderables = array();
    /**
     * Adds a renderable child to the element
     * 
     * @param Ai1ec_Renderable $renderable
     */
    public function add_renderable_children( Ai1ec_Renderable $renderable ) {
        $this->renderables[] = $renderable;
    }
} 
```

this would work, but it's a smell that something is not right, as i would need to duplicate code if i add something to Can_Have_Children. What should i do?

P.S. No traits, i support 5.2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T23:49:41.303

It seems there are two major responsibilities here: rendering and having children. So I would start with two separate interfaces:

```
interface Renderable {
  public function render();
}

interface Container {
  public function addChild(Renderable $renderable);
} 
```

Then have a concrete implementation of `Container` (not abstract):

```
class BasicContainer implements Container, Renderable {
  /* similar to your Ai1ec_Can_Have_Children class */
} 
```

Then you can define your HTML element classes as follows, using composition instead of inheritance for adding container functionality:

```
abstract class HtmlElement implements Renderable {
  /* similar to your Ai1ec_Html_Element class */
}

abstract class ContainerHtmlElement extends HtmlElement implements Container {
  private $container = new BasicContainer();

  public function addChild(Renderable $renderable) {
    $this->container->addChild($renderable);
  }

  public function render() {
    parent::render();
    $this->container->render();
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-30T12:20:48.013

Two important Design Pattern principles can be found here:

1.  Program to an interface and not an implementation
2.  Favor object composition over inheritance

If you look at the original class diagram in the GoF book, you'll see that the Component interface has two implementations: Leaf and Composite. The Leaf participant only implements the Operation() and none of the others. For example, consider the following:

```
 <?php
class Leaf implements IComponent
{
    private $sName;
    public function __construct($sNodeName)

    {
        $this->sName=$sNodeName;
    }

    /* None of this batch of methods are used by Leaf */
    /* However in order to correctly implement the interface */
    /* you need some kind of implementation */
    public function add(IComponent $comOn){}
    public function remove(IComponent $comGone){}
    public function getChild($someInt){}

    /* Some userful content is required for the operation */
    public function operation()
    {
        echo $this->sName . "<br />";
    }
}

?> 
```

So while the Leaf participant in the pattern only implements the operation() method, it has dummy implementations of the other interface methods. You can find more details at:

[http://www.php5dp.com/the-composite-design-pattern-in-php-part-i-from-conceptual-to-practical/](http://www.php5dp.com/the-composite-design-pattern-in-php-part-i-from-conceptual-to-practical/)

and

[http://www.php5dp.com/category/design-patterns/composite/](http://www.php5dp.com/category/design-patterns/composite/)

The Composite is one of the few where you'll find this kind of "one-wing" implementation.

# regex - 如何为地址和地名编写一个相当复杂的python正则表达式？

> ID：11908589
> 
> 赞同：1
> 
> 时间：2012-08-10T20:11:40.977
> 
> 标签：regex

我正在尝试将一个营业地点名称和地址与另一个可能重复的营业地点名称和地址进行比较。问题是，姓名和地址通常是由人们手动输入的，因此显然存在各种差异。

这里有些例子：

St. vs. St. vs. Street

圣。14 vs. Ste 14 vs. Suite 14 vs. #14

NE 39th Ave. vs. 39th Ave. vs. 39th Avenue vs. NE 39th Avenue

还有更多是可能的......

我想在我的程序中编写一个正则表达式（使用 python）来比较将捕获这些细微差异的名称和地址。实际上，我经常看到看起来完全一样的地址，但对于少数不一样的地址，我不希望正则表达式完全拒绝它并说它们不一样。

有时同样适用于地名。（真实）示例：

“埃尔多拉多”与“埃尔多拉多墨西哥餐厅”

“东亚特兰大咖啡店”与“乔的东亚特兰大咖啡店”

“乡村餐厅”与“爸爸的村庄”<----我检查时它们的地址和电话号码完全相同，所以从技术上讲它们是重复的

“DJR 清洁企业”与“DJR 清洁企业公司”

如果您对如何执行此操作或代码想法有任何建议，我将不胜感激，因为我现在只知道如何做简单的正则表达式。我从来没有遇到过这么大的问题...

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T03:51:08.023

正如评论中的每个人都提到的那样，这个问题不太适合单个正则表达式。我最近在同一领域做了很多工作，我首先要说的是，你永远无法做到 100% 完美。这是一个“尽可能好”的问题。

专注于地址比较组件，我发现的最佳策略如下：

1.  将地址标记为单个单词（从而忽略奇怪的标点符号等）并重新加入字符串。

2.  从最后，搜索国家或州（从预定义的列表中） - 如果找到，则删除并存储。我们从结尾开始搜索，因为地址的结尾似乎比开头更容易预测！

3.  `(\d{4})`从最后开始，使用其中 4 是位数搜索邮政编码或邮政编码- 如果找到则删除并存储。将 4 替换为您的目标国家/地区的数字或数字。

4.  从最后开始，搜索郊区 - 如果找到则删除并存储。我们有一个预定义的哈希图/字典或郊区，这很有帮助。最好将每个匹配项存储起来以备后用，以帮助选择最佳匹配项（例如，检查邮政/邮政编码匹配）。如果您有该数据，也许您还可以从邮政编码中查找郊区。

5.  最后是找到街道地址！非常困难，因为有很多格式：

    1.  我用它来提取 unit/shop/suite/site/factory/lot 组件：

        `(unit|unt|un|u|shop|shp|suite|ste|se|site|factory|fy|lot|lt)s?(\s|\.)?(\w?\d+\w?)`

    2.  我生成了一个序数正则表达式来提取级别/楼层：

        `((\w??\d+\w??|g|grnd|ground|lower|first|second|third|fourth|fifth|sixth|seventh|eighth|nineth|tenth|eleventh|twelth|1st|2st|3rd|4th|5th|6th|7th)(?:\s*|\.*|\s*)*(level|lvl|l|floor|flr|fl|f)`

    3.  删除其他组件后，您通常只剩下类似于街道地址的东西。我用它来提取它：

        `\d+(\s*-\s?\d*|\s*)?\D+(highway|freeway|alley|arcade|avenue|boulevard|bypass|chase|circle|circlet|circuit|circus|close|court|cove|crescent|drive|esplanade|fairway|garden|gardens|grove|lane|mall|mews|parade|parkway|place|plaza|promenade|quay|ridge|ridgeway|road|row|square|street|terrace|walk|way|Al|ar|ave|blvd|by|cc|ch|ci|cs|cct|cres|cr|cst|dip|dr|ed|ent|es|fry|fo|fmn|fwy|hwy|int|la|lp|mi|mr|pde|pwy|ps|pt|pro|qs|ra|rge|rd|rty|rw|sp|st|tce|tk|trl|tn|vs|wk|wy|cl|ct|cy|ce|cro|dl|el|gp|gns|gl|gm|gr|hts|lkt|me|pl|pa|rt|ri|sh|sq|tp|tr|vl|vw|dv|bvd)\b`

就像有人说的那样，这不是一个简单的过程。使用上述算法，我们能够得到相当不错的结果。以这种方式解析两个地址后，您可以比较组件以确定它们是否相同。

还值得注意的是不同国家如何使用不同的地址格式。由于我们正在查看澳大利亚地址，因此您可能需要稍作修改。我想，原则是一样的。

希望这会有所帮助。

# ruby-on-rails - Rails Parsing YAML 文件 - 每个方法都有一个过滤器

> ID：11908596
> 
> 赞同：1
> 
> 时间：2012-08-10T20:12:02.343
> 
> 标签：ruby-on-rails, ruby, web-applications

我有以下 YAML 文件：

```
---
main-menu:
  - item: Test1
    param: value
  - item: Test2
    param: value
  - notitem: Test3
    param: value 
```

我正在尝试`item`像这样解析所有条目：

```
#Load menu file
menu = YAML.load_file(file)

#Recursive parse function
parse = lambda do |node|
  node.each do |item|
    if !item['item'].nil? then
     .. do something with item ..
    end #end if
  end #end each
end #end parse

#Return the main menu
parse.call(menu['main-menu']) 
```

哪个工作得很好......有没有更简单的方法来过滤掉所有不是`item`using的条目`node.each`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:20:48.787

不是我能看到的。`node`是一个`Array`对象`Hash`，因此需要先有条件地检查每个对象`.. do something with item ..`。`node.each`你可以稍微清理一下`next`

```
menu = YAML.load_file(file)

parse = lambda do |node|
  node.each do |item|
    next unless item.include?('item')
    # .. do something with item ..
  end
end

parse.call(menu['main-menu']) 
```

您也可以[`reject`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-reject)使用块调用

```
menu = YAML.load_file(file)

parse = lambda do |node|
  node.reject { |n| !n.include?('item') }.each do |item|
    # .. do something with item ..
  end
end

parse.call(menu['main-menu']) 
```

虽然我不知道这真的“更容易”！

# android - WRITE_SECURE_SETTINGS + 根

> ID：11908599
> 
> 赞同：2
> 
> 时间：2012-08-10T20:12:09.817
> 
> 标签：android, root

我的应用程序为用户提供了授予 root 访问权限以允许访问某些系统功能 (NFC) 的选项。默认情况下，它从不要求 root。

因此，在授予权限后，我认为它应该可以工作，但我仍然感到害怕：

```
08-10 22:06:49.320: W/System.err(9421): Caused by: java.lang.SecurityException: WRITE_SECURE_SETTINGS permission required: Neither user 10174 nor current process has android.permission.WRITE_SECURE_SETTINGS. 
```

错误。我错过了什么吗？我正在请求`WRITE_SECURE_SETTINGS`许可，所以不能这样。

有趣的是我有 NFC 启用/禁用工作，但是在我安装了一个新的 Rom 之后，我一直收到这个错误。它从 4.0.3 更新到 4.0.4，但据我所知，有问题的代码没有任何变化……有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T23:01:26.537

> 我错过了什么吗？

您缺少`WRITE_SECURE_SETTINGS`权限。

> 我要求获得 WRITE_SECURE_SETTINGS 权限，所以这不可能。

AFAIK，作为 root 与权限无关，直接。要持有`WRITE_SECURE_SETTINGS`，您的应用程序必须使用与固件签名相同的签名证书进行签名，*或者*安装在系统分区上。作为根不是这些东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-30T00:06:10.913

您可以让您的应用程序以 root 身份运行。例如，我在`WRITE_SECURE_SETTINGS permission required`运行时遇到错误：

```
String output = ProcessUtils.runProcess(MainService.this, "wm", "overscan", "0,0,10,10"); 
```

但我通过以下方式解决了这个问题（在有根设备上）：

```
String output = ProcessUtils.runProcess(MainService.this, "su", "0", "sh", "-c", "wm overscan 0,0,10,10"); 
```

# c# - maskedTextBox 中的百分比显示不正确

> ID：11908606
> 
> 赞同：0
> 
> 时间：2012-08-10T20:12:49.907
> 
> 标签：c#, winforms, asp.net-3.5, string-formatting, maskedtextbox

我试图在 MaskedTextBox 中显示一个百分比，字符串在其“40.99”中传递，但是当它显示在表单上时，它是“409.9%”。

填充值

```
 if (_person.Percentage != null)
    maskedTextBoxPercentage.Text = _person.Percentage.ToString();
 else
 {
    maskedTextBoxPercentage.Text = 0.00.ToString();
 } 
```

maskedTextBoxPercentage 属性

```
 this.maskedTextBoxPercentage.Location = new System.Drawing.Point(437, 125);
 this.maskedTextBoxPercentage.Mask = "000.00%";
 this.maskedTextBoxPercentage.Name = "maskedTextBoxPercentage";
 this.maskedTextBoxPercentage.Size = new System.Drawing.Size(129, 20);
 this.maskedTextBoxPercentage.TabIndex = 65; 
```

![在此处输入图像描述](../Images/c41cba1a846d9329e0949e2f23d2aea8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:30:13.607

尝试这个 ：

```
try
            {
                this.maskedTextBoxPercentage.Mask = "00.00%";

            }
            catch (Exception)
            {
                this.maskedTextBoxPercentage.Mask = "000%";
            } 
```

或者你也可以试试这个：

```
try
        {
            this.maskedTextBoxPercentage.Mask = "00.00%";

        }
        catch (Exception)
        {
            this.maskedTextBoxPercentage.Text = "100%";
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:16:14.150

如果您希望它显示“40.99%”，请将您的掩码更改为“00.00%”

# asp.net-mvc - 通用代码的 mvc 最佳实践

> ID：11908608
> 
> 赞同：3
> 
> 时间：2012-08-10T20:12:52.937
> 
> 标签：asp.net-mvc

我有一个 MVC 应用程序。以下代码在一个控制器和多个控制器中的多个位置使用。我想将此代码放在一个地方并从每个位置调用它。在 MVC 中做到这一点的最佳方法是什么？

下面的代码从数据库中获取一行并创建可以从视图中读取的 ViewData。使用网络表单，我将在一个类中创建一个公共子并传递年份和月份值。有没有办法让这段代码成为模型的一部分？

```
var monthlyexpenseincome = (from vu_monthlyresult in dbBudget.vu_MonthlyResults
                            where vu_monthlyresult.Month == defaultmonth && vu_monthlyresult.Year == defaultyear
                            select vu_monthlyresult).Single();

var yearlyexpenseincome =  (from vu_yearlyresult in dbBudget.vu_YearlyResults
                            where vu_yearlyresult.Year == defaultyear
                            select vu_yearlyresult).Single();

ViewData["MonthlyExpenses"] = monthlyexpenseincome.Expenses;
ViewData["MonthlyIncome"] = monthlyexpenseincome.Income;
ViewData["MonthlyProfit"] = monthlyexpenseincome.Income - monthlyexpenseincome.Expenses; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:23:08.160

一般来说，如果你有跨多个控制器的公共代码，你可以创建另一个继承自 Controller 的类，并将你的方法保留在那里，让你的个人控制器继承这个新类

```
public class BaseController : Controller
{
   protected string GetThatInfo()
   {
      //do your magic logic and return some thing useful
      return "This is demo return.Will be replaced";
   }
} 
```

现在你可以为你的其他控制器继承这个

```
public class UserController: BaseController 
{
  public ActionResult Index()
  {
    return VieW();
  } 
} 
```

**但在您的情况下，您正在获取的数据是特定于您的域数据的**。所以我建议你把它移到另一个类（比如一个新的服务/业务层）

```
public static class ProfitAnalysis
{
  public static decimal GetTotalExpense()
  {
     //do your code and return total
  }

} 
```

你可以从任何你想要的地方调用它

```
decimal totalExp=ProfitAnalysis.GetTotalExpense(); 
```

**而且您很快就会意识到，使用如此之多`ViewData`会使您的代码难以阅读和维护。不要等到那一天。切换到强类型类来传递数据。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:17:26.480

您应该将查询放在“业务层”中，这只是您调用以执行业务逻辑的类。然后你可以在任何你喜欢的地方重用它，只需实例化业务类并使用它。如果它们不需要状态，您也可以将方法设为静态，那么您甚至不必实例化它。

例如：

```
var expenseService = new expenseService();

ViewData["MonthlyExpenses"] = expenseService.GetMonthlyExpenses(); 
```

# c++ - C++ 双向迭代器前缀增量

> ID：11908614
> 
> 赞同：3
> 
> 时间：2012-08-10T20:13:14.323
> 
> 标签：c++, iterator, bidirectional

观察 1：C++ 输出迭代器需要`&r == &++r`，而输入迭代器没有提到这个要求。参见 [C++11: 24.2.{3,4}]

观察 2：前向、双向和随机访问迭代器满足输入迭代器要求 [24.2.{5,6,7}:1]，但不一定满足输出迭代器要求，除非它们是*可变*的[24.2.1:4]。

观察 3：双向迭代器添加前缀递减操作，符合要求`&r == &--r`[24.2.6]。

那么，*恒定*的双向迭代器必须满足`&r == &--r`但不一定满足`&r == &++r`，而*可变*的双向迭代器必须同时满足两者，这是真的吗？

你能解决这个要求如何影响实现吗？

* * *

下面的 MvG 提出了我真正想说的问题：

*   常量 Forward 迭代器什么时候不满足`&r == &++r`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:22:29.037

> 你能解决这个要求如何影响实现吗？

显而易见的答案是`operator++()`or`operator--()`方法 must `return *this`，而单独的函数`Foo& operator++(Foo& arg)`必须返回其参数。由于无论如何这是明智的做法，因此大多数实现都不必担心。

更复杂的问题是“什么时候（例如前向输入）迭代器*不*遵循上述方法才有意义”。我还想不出一个合理的例子。即使对于常量输入迭代器，其*类型*也`++r`必须是对迭代器类型的引用。[因此，正如@Bo Persson 在他的回答](https://stackoverflow.com/a/11909189/1468366)中提到的那样，任何形式的“代理对象”只有在该代理对象是迭代器类的子类时才有效。似乎没有多大意义。

我有一种感觉，`&r == &++r`对于输出迭代器的情况，要求只是被遗忘了。我怀疑该规范的作者是否有任何特定的用例无法满足此要求。但我猜，所以我期待这个问题的更可靠的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:02:02.370

这是一种制定需求的间接方式，没有明确指定特定的实现。特别是不能返回代理对象`&r == &++r`的说法。`++r`结果必须是相同的迭代器。

这里与通常的方式`mutable`并不完全相反`const`，而是意味着可写，并且再次指代输出迭代器的要求。

双向迭代器当然必须同时支持`++p`和`--p`（根据定义），但不必是可写/可变的。

这些类别在读/写和向前/向后可移动之间并不完全正交，因此各个需求并不是独立的，因为它们本来可以是独立的。这会引起一些混乱。

我不确定您的结论是否来自观察结果，但不认为这将是实施的重要自由。事实上，你必须支持类似的东西 `*++p`并`*p++`设置大部分限制。

# php - 执行时间和内存使用是 PHP 唯一相关的性能指标吗？CPU呢？

> ID：11908615
> 
> 赞同：2
> 
> 时间：2012-08-10T20:13:27.060
> 
> 标签：php, oop, memory, cpu-time

我正在使用具有 ActiveRecord 系统的 PHP 框架。我很快就遇到了 ActiveRecord 的问题，它使用大量内存并且对于具有大量结果的复杂查询执行时间很长。

对于我的参考页面（生成包含 10,000 个对象的数组的脚本），我设法将内存消耗从 100+ MB 减少到 ~15 MB，并将执行时间从 5+ 秒减少到 ~1.5 秒。

这两个度量是唯一需要考虑的，还是我应该查看通过 PHP 提供给我的其他度量？

通过更改将事物存储在对象变量中的函数以动态计算它，我已经实现了大部分改进。因此我很关心 CPU，因为在我的本地主机上测试没有 CPU 短缺......然而，在实际环境中，由于其他请求等原因，CPU 不断被使用。但是如何测量 PHP 中的 CPU 消耗？

示例：每当实例化活动记录时，字段、规则和关系都会在每个对象实例内的私有属性中设置。我已将其更改为函数，始终编译并返回值，而不是使用对象属性。

**让内存来做：**

```
class Record {
  private $relations;
  private $fields;
  function __construct() {
    $this->setRelations();
    $this->setFields();
  }
  private function setRelations() {
    // This process of getting predefined relations, checking for correct data,
    // and some other calculations is done once, on every construct.
    // The result is stored in $this->relations;
    // This costs memory!
  }
  private function setFields() {
    // This process of getting predefined fields, checking for correct data,
    // and some other calculations is done once, on every construct.
    // The result is stored in $this->fields;
    // This costs memory!
  }
  private function getRelations() {
    // This is fast. Loading the set relations from memory.
    return $this->relations;
  }
  private function getFields() {
    // This is fast. Loading the set relations from memory.
    return $this->fields;
  }
} 
```

**让 CPU 来做：**

```
class Record {
  function __construct() {
    // Drop the setter methods. Let the CPU work when using the getters.
  }
  private function getRelations() {
    // This process of getting predefined relations, checking for correct data,
    // and some other calculations is done once, on every getFields()
    // This costs CPU!
    return $relations;
  }
  private function getFields() {
    // This process of getting predefined fields, checking for correct data,
    // and some other calculations is done once, on every getFields()
    // This costs CPU!
    return $fields;
  }
} 
```

我的两个主要问题是：

1.  **什么是更好的？**
2.  **如何测量 CPU 消耗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:17:41.653

您在这里忘记了一个非常重要的因素：您的数据库。确保它已正确编入索引。执行查询分析以查看在最坏情况下检查了多少行。10 次中有 9 次是数据库而不是利用它的代码导致性能问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:19:41.050

您可能将执行时间测量为挂钟时间，这将受到 CPU 正在执行的其他事情以及您的进程是否阻塞的影响。例如，当您进行数据库调用时，挂钟会在 CPU 空闲时继续运行。这个空闲时间可以用来处理其他请求，即使它看起来很忙。

使用[XHProf](https://github.com/facebook/xhprof/)等分析器来测量整个应用程序中的精确内存、CPU 和挂钟成本。它测量每个函数所花费的时间和消耗的内存，包括和不包括它们调用的其他函数，允许您深入了解您的应用程序。

至于哪个更重要 - 时间或内存 - 这取决于整个应用程序配置文件。如果您有大量占用大量内存的请求，您将需要定制新请求以使用更多 CPU。反过来也一样。此外，当您尝试同时处理更多请求时，在短时间内占用大量内存更重要。

# imagemagick - Imagemagick 和 3Drotate

> ID：11908616
> 
> 赞同：0
> 
> 时间：2012-08-10T20:13:30.140
> 
> 标签：imagemagick

我最近不得不将我的站点从一台服务器移动到另一台服务器，看起来[Fred 的 3Drotate 脚本](http://www.fmwconcepts.com/imagemagick/3Drotate/index.php)创建的文件中包含 Imagemagick 设置而不是图像数据。当我第一次运行脚本时，我收到以下错误：

```
expr: warning: unportable BRE: `^[0-9][0-9]*$': 使用 `^' 作为基本正则表达式的第一个字符是不可移植的；它被忽略了
expr: 警告: 不可移植 BRE: `^[+-][0-9][0-9]*$': 使用 `^' 作为基本正则表达式的第一个字符是不可移植的；它被忽略了
expr: warning: unportable BRE: `^[0-9]*[\\.][0-9]*$': 使用 `^' 作为基本正则表达式的第一个字符是不可移植的；它被忽略了
expr: 警告: 不可移植 BRE: `^[+-][0-9]*[\\.][0-9]*$': 使用 `^' 作为基本正则表达式的第一个字符是不可移植的；它被忽略了

```

我能够通过删除“^”字符的每个实例来解决这个问题。该脚本运行并创建了一个几百 KB 的文件，但其内容似乎是一个配置，例如：

```
id=MagickCache
quantum-depth=16
class=DirectClass  colors=0  matte=False
columns=500  rows=500 depth=8
colorspace=sRGB
compression=JPEG  quality=75
units=PixelsPerInch
resolution=72x72
page=500x500+0+0
rendering-intent=Perceptual
gamma=0.454545
red-primary=0.64,0.33  green-primary=0.3,0.6  blue-primary=0.15,0.06
white-point=0.3127,0.329
date:create=2012-08-10T20:44:21-07:00
date:modify=2012-08-10T20:44:21-07:00
jpeg:colorspace=2
jpeg:sampling-factor=2x2,1x1,1x1 
```

有任何想法吗？我正在运行 imagemagick 版本 6.7.8-9，它比我原来的服务器上的版本更新~~，但是我不知道那是哪个版本~~。

**更新：**
我在使用 Fred 于 2010 年 3 月 11 日修订的 3DRotate 的 CentOS 机器上。ImageMagick 是 6.7.8-9 版本，而我的旧服务器，也是 CentOS 使用的是 6.7.6-0 版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:01:16.827

[**Fred 的 3Drotate 脚本**](http://www.fmwconcepts.com/imagemagick/3Drotate/index.php)对我来说仍然可以正常工作。我没有理由抱怨。

这是在 Mac OS X Lion 上，带有 Bash 版本`GNU bash, Version 4.2.37(2)-release`....

强烈建议您重新下载脚本并重试。如果您想报告错误，您应该提供有关您的操作系统、Bash 和 ImageMagick 版本的信息...

哦，[***另请参阅此页面***](http://www.fmwconcepts.com/imagemagick/index.php)，其中指出...

*   ...您需要 ImageMagick v6.3.5.0 或更高版本才能使脚本正常工作，
*   ...提供一些有关故障排除的提示和
*   ...告诉您作者的电子邮件地址，以便您可以联系他讨论您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T17:52:57.690

随着最近在 IM 6.7.6.7 和 IM 6.7.8.3 之间对 ImageMagick 的更改，颜色空间变化和灰度变为线性，我最近不得不检查所有脚本并进行适当的更改。到目前为止，我的脚本只完成了一部分，但已经修复了大约 1/3 到 1/2，但自 2011 年 11 月 26 日的最后一次更改以来，3Drotate 不需要任何更改。但是你的版本太旧了，所以你需要更新。您似乎遇到的问题可能相关，也可能不相关。但似乎与 unix 实用程序 expr 有关。我会确保您安装了该版本的当前版本。在我的 Mac OSX Snow Leopard 上的 IM 6.7.6.0 和 6.7.8.9 上，以下内容对我来说都非常好

3Drotate pan=45tilt=45 auto=zc mandril.jpg mandril_test.jpg

我要问的第一个问题是您的确切命令行是什么。如您所见，这些参数与我的其他脚本有些不同，因为它们包含等号。

如果您仍然有问题，请向我或 ImageMagick Discourse 论坛报告，网址为[http://www.imagemagick.org/discourse-server/viewforum.php?f=1](http://www.imagemagick.org/discourse-server/viewforum.php?f=1)

弗雷德

# mysql - 非常慢的 MySQL 查询

> ID：11908621
> 
> 赞同：0
> 
> 时间：2012-08-10T20:14:03.420
> 
> 标签：mysql, sql

这个查询需要很长的时间来执行。持续时间/获取：89.778 秒/0.000 秒

这是查询：

```
SELECT tblcompanyoperat.COPSCountry,
       AVG(tbldshipfees.Dship Total AnnualUSD) / 
                              AVG(tblcopsyearonyear.COPSMinWageUSD) AS Expr1
FROM (SELECT tblcopsyearonyear.Company NAME,
          tblcopsyearonyear.COPSCountry,
          MAX(tblcopsyearonyear.COPSFinYearEnd) AS MaxOfCOPSFinYearEnd
      FROM tblcopsyearonyear
      GROUP BY tblcopsyearonyear.Company NAME,
        tblcopsyearonyear.COPSCountry
      ORDER BY tblcopsyearonyear.COPSCountry,
        MAX(tblcopsyearonyear.COPSFinYearEnd)) AS qryCOPSLatestInfoYr,
     ((tblcompany 
       INNER JOIN tblcompanyoperat 
       ON tblcompany.CompName = tblcompanyoperat.Company NAME) 
      INNER JOIN tblcopsyearonyear 
      ON tblcompanyoperat.COMPOPID = tblcopsyearonyear.COMPOPID)
INNER JOIN (tbldirectorships 
            INNER JOIN tbldshipfees 
            ON tbldirectorships.DIRECTORSHIPSID = bldshipfees.DSHIPID) 
ON tblcompany.CompName = tbldirectorships.DSHIPCOMPANYLINK
WHERE blcompany.CompSector = 'Retail'
GROUP BY tblcompany.CompSector, 
         blcompanyoperat.COPSCountry,
         tbldshipfees.DSHIP Position
HAVING (AVG(tblcopsyearonyear.COPSMinWageUSD) IS NOT NULL
        AND tbldshipfees.DSHIP Position LIKE 'Chief%')
ORDER BY MAX(qryCOPSLatestInfoYr.MaxOfCOPSFinYearEnd); 
```

除了索引之外，我还可以使用哪些优化来加快速度？解释扩展输出：

```
id selet_type   table                 type possible_keys                                          key                         key_len  ref                                       rows filtered Extra
1, PRIMARY,     tblcompany,           ref, PRIMARY,tblSECTORStblCOMPANY,                          tblSECTORStblCOMPANY,       768,     const,                                    7,   100.00,  Using where; Using index; Using temporary; Using filesort
1, PRIMARY,     tblcompanyoperat,     ref, PRIMARY,CompanyName,                                   CompanyName,                768,     lrsmnc.tblcompany.CompName,               3,   100.00,  Using where
1, PRIMARY,     tblcopsyearonyear,    ref, PRIMARY,COMPOPID,                                      COMPOPID,                   4,       lrsmnc.tblcompanyoperat.COMPOPID,         1,   100.00, 
1, PRIMARY,     tbldirectorships,     ref, PRIMARY,DIRECTORSHIPSID,tblCOMPANYtblDIRECTORSHIPS,    tblCOMPANYtblDIRECTORSHIPS, 768,     lrsmnc.tblcompanyoperat.Company Name,     12,  100.00,  Using where; Using index
1, PRIMARY,     tbldshipfees,         ref, DSHIPID,tbldshipfeesDSHIPID,                           DSHIPID,                    4,       lrsmnc.tbldirectorships.DIRECTORSHIPSID,  1,   100.00, 
1, PRIMARY,     <derived2>,           ALL,                                                                                                                                       310, 100.00,  Using join buffer
2, DERIVED,     tblcopsyearonyear,    ALL,                                                                                                                                       523, 100.00,  Using temporary; Using filesort 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:33:01.087

`tbldshipfees.DSHIP Position LIKE 'Chief%'`从`HAVING`子句移到子句`WHERE`将缩短执行时间。这有两个原因。

首先，没有对出现在`HAVING`MySQL 子句中的项目进行优化。这意味着不能使用索引排除项目（如`EXPLAIN`上面的计划中所示。

其次，因为该`HAVING`子句是在将数据返回给客户端之前立即应用的。结果，在所有操作（聚合函数、ORDER BY 等）被删除之前，时间都不必要地花费在它们上，从而增加了处理时间。

参考： [http ://dev.mysql.com/doc/refman/5.5/en/select.html](http://dev.mysql.com/doc/refman/5.5/en/select.html)

此外，出于未来维护的原因，建议从隐式连接更改为显式连接，根据 X-Zero 的评论。这可能会带来额外的性能优势，因为它减少了数据库服务器所需的优化。

# php - Symfony2中，渲染时如何区分两个choice_widgets

> ID：11908622
> 
> 赞同：0
> 
> 时间：2012-08-10T20:14:03.417
> 
> 标签：php, forms, symfony

在 Symfony2 中，我有一个自己的类型`ProvinceType`是choice_widget。

我已经覆盖了`form_div_layout.html.twig`使一些小部件看起来像网站的其余部分。

但我不知道如何区分普通的choice_widget（用于Symfony2 中的一般选择）和我的ProvinceType 选择小部件，我希望它更宽一些。

对此有任何线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:52:10.417

在您的 FormType 中的此字段上设置特定的标签属性/类（label_attr），然后使用 css 以您的方式呈现它，与其他字段不同

# c# - 在线程中调用互操作 Excel 函数时出现 CastError？

> ID：11908625
> 
> 赞同：1
> 
> 时间：2012-08-10T20:14:09.657
> 
> 标签：c#, excel, excel-interop

我有一个具有此功能的 excel 插件类：

```
public void testRibbon()
{
     Excel.Workbook workbook = this.Application.ActiveWorkbook;      
     Excel.Worksheet activeSheet = workbook.Sheets[1];
     Excel.Range range = activeSheet.get_Range(JOB_ID_FIELD + HEADER_ROW, TOTAL_STATUS_PERCENTAGE_KEY_FIELD + (10 + 1).ToString());
     range.get_Range("C4").Value = "test Ribbon complete";
} 
```

在功能区中，我添加了一个按钮，按下该按钮将在线程中调用 testRibbon：

```
private void process_Click(object sender, RibbonControlEventArgs e)
{
    Thread processThread = new Thread(delegate(){
        Globals.ExcelAddin.testRibbon();
    });
    processThread.Start();
} 
```

这会导致转换错误：

> 无法将“System.__ComObject”类型的 COM 对象转换为接口类型“Microsoft.Office.Interop.Excel._Workbook”。此操作失败，因为 IID 为“{000208DA-0000-0000-C000-000000000046}”的接口的 COM 组件上的 QueryInterface 调用因以下错误而失败：加载类型库/DLL 时出错。（来自 HRESULT 的异常：0x80029C4A (TYPE_E_CANTLOADLIBRARY)）。

如果我不使用新线程，则不会发生强制转换错误。

**编辑**：尝试使用任务工厂，同样的错误：

```
var task2 = Task.Factory.StartNew(
() =>
{
     Globals.BobStats.testRibbon();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:47:56.350

在 Excel 中使用多线程毫无意义，因为 Excel 的 COM 接口基本上是单线程的（请参阅[本文](http://msdn.microsoft.com/en-us/library/8sesy69e%28v=vs.100%29.aspx)）。加载项中可能有进一步的限制。

但是我不得不说我真的不明白错误消息想说什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:30:25.777

我认为目前，您正在通过 COMObject 连接到接口类型“工作簿”......它会自动创建一个新的非托管线程，并且当您 Start() 时会与您的线程一起崩溃。具体来说，当你创建线程对象时，它会将一些数据结构保存到共享内存中并且没有使用 Start() 所以线程此时没有执行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T21:42:36.690

当您从工作线程中使用 Excel 接口方法时，需要对方法调用进行*封送*处理。换句话说，需要从创建应用程序对象的线程进行调用。与在 .NET gui 应用程序中使用 Control.Invoke() 或 Dispatcher.Invoke() 的想法相同。

为了使它工作，COM 需要知道该方法的参数是什么，以便它可以正确地复制它们。这种信息需要 .NET 中的 Reflection 等价物。这需要元数据，描述 COM 方法的元数据存储在类型库中。Excel 的类型库作为资源存储在 Excel.exe 中。

查找类型库是这里出了问题。此信息存储在注册表中，并且由于某种原因在您的计算机上损坏。`HKLM\SOFTWARE\Classes\TypeLib\{00020813-0000-0000-C000-000000000046}\1.7\0\win32`尽管它取决于 Office 的确切版本，但最有可能遭到破坏的密钥。您可以从 SysInternals 的 ProcMon 实用程序中获得更多信息，您会看到您的程序正在搜索密钥。

这种事故很少仅限于一把钥匙。您需要让您的计算机再次正常运行并重新安装 Office。

哦，请记住，代码实际上并没有在工作线程上运行。这需要在该工作线程上创建 Application 对象并在启动之前调用 SetApartmentState() 使其成为 STA。

# scala - 用宏隐藏闭包样板？

> ID：11908626
> 
> 赞同：1
> 
> 时间：2012-08-10T20:14:11.937
> 
> 标签：scala, scala-2.10, scala-macros

给定一个示例闭包，在这种情况下，它返回字符串中的单词数（带有附加的任意运算符）。

```
val myfunc = (s: String) => Option(s).map(_.split(" ").size).filter(_ >= 2) 
```

有没有办法可以隐藏一些样板，以便我可以编写：

```
val myfunc = given[String].map(_.split(" ").size).filter(_ >= 2) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:23:03.537

如果您可以使用两个括号和一个下划线，则不需要宏：

```
class Given[A] {
  def apply[B](f: Option[A] => B): A => B = (a: A) => f(Option(a))
}
def given[A] = new Given[A] 
```

在行动：

```
scala> val myfunc = given[String](_.map(_.split(" ").size).filter(_ >= 2))
myfunc: String => Option[Int] = <function1>

scala> List("salmon cod herring","tuna").map(myfunc)
res4: List[Option[Int]] = List(Some(3), None) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T21:14:08.573

我怀疑。宏用类型检查的东西替换它所在的函数调用。那么，`given[String]`在你的例子中你会用什么代替？如果你用 替换它`(s: String) => Option(s)`，你会得到这个：

```
((s: String) => Option(s)).map(_.split(" ").size).filter(_ >= 2) 
```

这不像你想要的那样工作。您希望更改整条生产线，但这是不会发生的。

# jquery - jQuery手机底部空间

> ID：11908635
> 
> 赞同：1
> 
> 时间：2012-08-10T20:14:54.987
> 
> 标签：jquery, css, jquery-mobile

我正在创建我的网站的移动版本，它在页面底部有一个巨大的空间。我已经尽我所能删除它，但它甚至没有膨胀。有关如何解决此问题的任何建议。这是[链接](http://www.mobile.siteripe.com)

我试过像

```
body {
margin-bottom: -25px;} 
```

它仍然没有工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T06:22:51.150

是的，固定位置的页脚是要走的路：

```
<div data-role="footer" data-position="fixed">
<a href="#" data-rel="back">OK</a>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T21:39:57.383

经过几次实验，我用下面的 CSS 行解决了这个问题：

```
#footer {
    color:#FFC;
    height:40px;
    position:fixed;
    border-top: solid 1px #FFC;
    padding: 0;
    bottom: 0;      
}

#page {
    text-align: center;
    border-bottom: solid 1px #FFC;
    height: auto;
    padding: 0;
    bottom: 0;
} 
```

我确实为数据角色页脚提供了一个名为 #footer 的 ID

# jquery - 在不覆盖 renderItem 的情况下附加到 jquery 自动完成 renderItem

> ID：11908637
> 
> 赞同：1
> 
> 时间：2012-08-10T20:14:59.660
> 
> 标签：jquery, autocomplete

有几篇关于覆盖 jquery 的 ui.autocomplete 的 renderItem 的帖子。简单地附加它怎么样？

我的自动完成搜索结果与此代码配合得很好——但我的麻烦是使用 ._renderItem 函数会阻止所选结果出现在输入标签中。有人可以帮助选择功能吗？

我的代码（部分）：

```
$j('.searchInput').autocomplete({
        source: BASE_URL + "include/php/nocache/jquery_search_autocomplete.php",
        select: function(event, ui) {
            // move search term into input
            console.log(ui);
        }
}).data( "autocomplete" )._renderItem = function( ul, item )  {
            var li = $j( "<li class='autoli'></li>" );
            li.data( "item.autocomplete", item );
            if ( ( item.category_title )) {
                li.append( "<a>" + item.category_title + "</a>" )
                li.append( "<a>" + item.title + "</a>" )
                li.append( "<img class='autoimg' src='" + BASE_URL + 'images/category/tnails_75/' + item.category_id  + '.jpg' +  "' />" )
            }
            if ( ( item.search_phrase )) {
                li.append( "<a>" + item.search_phrase + "</a>" )
                li.append( "<a>" + item.title + "</a>" )
                li.append( "<img class='autoimg' src='" + BASE_URL + 'images/category/tnails_75/' + item.category_id  + '.jpg' +  "' />" )
            }
            if ( ( item.web_supplier_sku )) {
                li.append( "<a href='" + item.url +  "'>" + item.web_supplier_sku + "</a>" )
                li.append( "<a href='" + item.url +  "'>" + item.web_name + "</a>" )
                li.append( "<img class='autoimg' src='" + BASE_URL + 'images/sku/tnails_75/' + item.qm_sku  + '.jpg' +  "' />" )
            }
            li.appendTo( ul );
            return li;
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T05:23:54.277

您在寻找 _renderMenu 吗？这使您可以自己创建菜单。但是您仍然必须遍历每个项目以为其赋予 data() 属性，否则它将无法工作。

这是我的：

```
var userTemplate = Handlebars.compile( $("#userItem").html() );

// ... later in the code: The renderMenu function...
_renderMenu: function(ul, items) {

 items.forEach(function(person) {
  ul.append(
    $( userTemplate({items: person}) ).data("ui-autocomplete-item", person)
  );
 });

 return ul;
} 
```

# google-app-engine - 根据好友列表从 GAE 中检索高分

> ID：11908638
> 
> 赞同：0
> 
> 时间：2012-08-10T20:15:10.610
> 
> 标签：google-app-engine

我有一个使用 GAE 作为后端的 Facebook 应用程序，并实现了一个简单的评分系统。真实模型中的关卡数据和多用户的可能性稍微有点杂乱，但简化版本如下：

```
class score(db.Model):
    value = db.IntegerProperty()
    user = db.StringProperty() 
```

我已经显示了全球前十的分数，但**我还想要显示一个用户朋友的前十分数的选项**。在 SQL 环境中，我会执行类似 SELECT * FROM scores WHERE user1 IN (...friendslist...) 或 user2 IN (...friendslist...) ORDER BY value LIMIT 10 之类的操作。在非关系数据库中“ IN" 查询的成本很高，特别是在 GAE 中，它们一次仅限于 30 个值的块。以这种方式实现查询并不理想。

我目前的解决方案是使用 key_name = facebook id 存储每个分数（*应用程序只存储他们的最高分数，因此重复键没有问题*），然后使用 score.get_by_key_name(...friendslist...)。这种方法的问题很多：我必须查询每个朋友，这会返回一个未排序的所有朋友分数的列表，然后需要用代码对其进行解析。

通过 memcache 缓存每个分数实体，我稍微减轻了负载，但是如果数据存储区填充了许多分数，memcache 将无法很好地扩展，这仍然是一种昂贵且痛苦的方式来执行关系数据库中的简单操作。**在 Google App Engine 中有没有更好的方法来做到这一点？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:53:32.990

为什么不将**前十名的分数**写入每个用户的实体？

用户 1 的新分数为 100！是的！

用户 1 有一个包含 20 个朋友的列表。

获取 20 位好友的列表，并将 100 加到每个实体的最高分数字段中（如果是前 20 位之一）。

缺点：每次用户获得新的高分时，您将拉取他们所有朋友的实体并可能更新它们。注意你的读写成本 当然，如果一个用户连续获得几个高分，也许朋友的值会被 memcached。

优点：您可以为每个最高分条目添加时间戳，跟踪用户上次玩的时间，并突出显示自用户上次玩以来的新高分！只是一个想法...

# php - PHP 手动 JSON 编码 -- parseError

> ID：11908639
> 
> 赞同：0
> 
> 时间：2012-08-10T20:15:16.573
> 
> 标签：php, jquery, ajax, json

$.ajax 给了我一个关于我的 PHP 脚本返回的一些 JSON 的解析错误。我在某种程度上使用扩展我的 PDO 语句的函数手动编码 JSON，希望为非常大的数据集节省一些内存。

为什么这行不通？如果我在编辑器中将响应文本复制/粘贴到 JSON.parse 中，它可以正常工作。所以这可能是一些逃避问题？

此外，如果我取出前三行（编码 x、y 和行）并将其返回一个数组，它就可以正常工作。只是不像我拼凑的对象。

```
public function toJSON ($x, $y) {

  echo "{x:" . json_encode($x) . ",";
  echo "y:" . json_encode($y) . ",";
  echo "rows:[";

  $i = 0;

  while ($row = $this->fetch(PDO::FETCH_ASSOC)) {

    if ($i) echo ",";
    echo json_encode($row, JSON_NUMERIC_CHECK);

    if ($i > 0 && $i % 100 === 0) {
      ob_flush();   
      flush();
    }

    $i++;
  }
  echo "]}\n";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:25:25.887

你确定你把它放在正确的格式？

你的名字需要用引号引起来，因为它是一个字符串。如果您的值是一个字符串，它也需要在引号中。

前任/

`echo "{x:" . json_encode($x) . ",";`

需要像这样：

`echo '{"x":' . json_encode($x) . ',';`

# c++ - 良好的 IDE，带有用于 Linux 中 C++ 的 GUI 的良好分析器

> ID：11908646
> 
> 赞同：1
> 
> 时间：2012-08-10T20:15:49.620
> 
> 标签：c++, ide, profiler

我想在一个地方（又名 GUI）拥有我需要的所有工具。

有一个带有分析器的 IDE 还是一个为好的分析器提供插件的 IDE？

我不只是在寻找一个分析器，我想把所有东西都放在一个地方，从编辑器到分析器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:20:38.017

Qtcreator [http://qt-project.org/downloads#qt-creator](http://qt-project.org/downloads#qt-creator)
您可以将它与 [valgrind一起使用](http://www.developer.nokia.com/Community/Wiki/Using_valgrind_with_Qt_Creator)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T20:21:38.340

比起任何其他 IDE，我更喜欢 Netbeans。它有一个内置的分析器，并且完成功能是无与伦比的。它提供了许多类似于 eclipse 的插件，但几乎所有的功能都与它捆绑在一起。

除了在 Eclipse 中，Netbeans 中的 C++ 支持由核心团队开发。感觉与整体 UI 更加一致。

只是我的两分钱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:18:51.270

这可能是最好的事情之一：http: [//www.eclipse.org/cdt/](http://www.eclipse.org/cdt/)

# php - 将子域指向我的应用程序

> ID：11908655
> 
> 赞同：0
> 
> 时间：2012-08-10T20:16:12.620
> 
> 标签：php, dns, subdomain, cname

所以基本思想与 tumblr 和其他一些应用程序使用的相同。通过 CNAME（或更好的选择）将客户端域名的子域指向他们的应用程序登录。

**例如**

1.  客户的域名是client.com。
2.  应用程序登录是 client.myapp.com。
3.  将 login.client.com 指向 client.myapp.com。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:40:04.567

确保您仅将“登录名”命名为 client.myapp.com。如果您添加“login.client.com”，它可能无法正常工作。

# jquery - jQuery - 将类添加到 li，默认从其他类中删除

> ID：11908658
> 
> 赞同：0
> 
> 时间：2012-08-10T20:16:13.830
> 
> 标签：jquery

尝试为 iframe 中播放的缩略图视频添加边框。

```
$('document').ready(function(){

    $("#video-thumbs li").click(function(e){
        e.preventDefault();
        $("#video-thumbs li").addClass("current").not(this).removeClass("current");
      });

});

```

```
<iframe width="1020" height="574" id="myvideo" src="http://www.youtube.com/embed/Qdse1SEBimw" frameborder="0" allowfullscreen=""></iframe>
<ul id="video-thumbs">
    <li class="current" style="margin-left: 0;">
    <div id="playbtn" onclick="document.getElementById('myvideo').src='http://www.youtube.com/embed/Qdse1SEBimw'"></div>
    <img src="files/lamb.png" width="326" height="181">
    </li>
    <li>
    <div id="playbtn" onclick="document.getElementById('myvideo').src='http://www.youtube.com/embed/WZknytdWWhI'"></div>
    <img src="files/tuna.png" style="width: 326px">
    </li>
    <li style="margin: 0 0 0 11px">
    <div id="playbtn" onclick="document.getElementById('myvideo').src='http://www.youtube.com/embed/BAembvTjChs'"></div>
    <img src="files/myers.png" width="326" height="181">
    </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:19:23.163

切换你的逻辑：

```
$('document').ready(function(){

    $("#video-thumbs li").click(function(e){
        e.preventDefault();
        $("#video-thumbs li").removeClass("current"); // Remove all instances
        $(this).addClass("current"); // Add `.current` to $(this) object only
    });

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:52:09.700

尝试以不同的方式构建 HTML，并删除那些难看的 onclick 函数：

```
<iframe width="1020" height="574" id="myvideo" src="http://www.youtube.com/embed/Qdse1SEBimw" frameborder="0" allowfullscreen=""></iframe>
<ul id="video-thumbs">
    <li style="margin-left: 0;">
        <div class="playbtn" data-url='http://www.youtube.com/embed/Qdse1SEBimw'></div>
        <img src="files/lamb.png" width="326" height="181" class="current">
    </li>
    <li>
        <div class="playbtn" data-url='http://www.youtube.com/embed/WZknytdWWhI'></div>
        <img src="files/tuna.png" style="width: 326px">
    </li>
    <li style="margin: 0 0 0 11px">
        <div class="playbtn" data-url='http://www.youtube.com/embed/BAembvTjChs'></div>
        <img src="files/myers.png" width="326" height="181">
    </li>
</ul>​​​​​​​​​ 
```

现在做一些 jQuery 的东西：

```
$(function(){
    $("#video-thumbs li").on('click', function(){
        $(this).find('img').addClass("current").end()
               .siblings().find('img').removeClass("current");
        $("#myvideo").prop('src', $(this).find('div').data('url'));
    });
});​ 
```

它应该可以正常工作吗？这是一个[**小提琴**](http://jsfiddle.net/BBMkn/2/)

# eclipse - 我应该如何将现有的 java 项目放入一个新的 svn 存储库中，以便通过带有 subclipse 的 eclipse 访问？

> ID：11908659
> 
> 赞同：0
> 
> 时间：2012-08-10T20:16:31.670
> 
> 标签：eclipse, svn, tortoisesvn, subclipse, visualsvn-server

我现在在我的笔记本电脑上安装了 VisualSVN、subclipse、eclipse indigo 和 tortoiseSVN。这仅适用于本地机器上的代码，并且 SVN 设置为 localhost 服务实例，因此我为我的个人开发项目进行了版本控制。

我的问题是，我应该如何将我的项目放入 svn 中？我开始通过 subclipse/eclipse 导入存储库，但我现在还需要乌龟，还是不管我如何将项目导入 svn？我确实看到，如果项目已经在 Eclipse 中，它不会让我进行导入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:28:08.523

我可以通过 eclipse 将我的项目提交到 SVN 中的存储库，而无需使用 tortoise svn，因此不需要它。要将新项目添加到存储库，我右键单击 Eclipse 中的项目并转到团队并共享项目。然后将项目更新提交到存储库，我去团队然后提交。到目前为止，这对我有用。

# sql-server - 命名视图的最佳实践

> ID：11908662
> 
> 赞同：0
> 
> 时间：2012-08-10T20:16:55.620
> 
> 标签：sql-server, sql-server-2008, tsql, views

例如，我有一个 Cars_Import 的表名

我需要一个将被调用的视图来获取要导入的数据，并且该视图运行并执行将数据导入 Cars_Import 表的工作。

我的问题是，我不能将视图命名为相同，我必须区分它，因为我猜 SQL 服务器将同名对象视为冲突，无论它是什么类型的对象。

因此，对于普遍接受的命名约定的最佳实践，当您有 2 个彼此真正相关的对象时，并且我知道在名称中附加 tbl、vw 等内容并不是一个好习惯，您会怎么做建议在这里作为与 Cars_Import 相关的视图名称？

例如，我不希望视图切换它会起作用，但对我来说似乎很乱，例如 Import_Cars

那么这里关于命名表及其相关视图的建议是什么，它将从该表中获取我们需要的所有数据？没有业务逻辑，它只是抓取数据，我们将把它导入数据仓库，所有数据都是最初的样子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:21:20.097

视图实际上是一个我不介意描述它是什么的前缀或后缀的地方。与比较表或存储过程时（因为它们的使用方式不同，这很明显）不同，表和视图在很大程度上是可互换的。所以我发现这种区分在逆向工程或对代码进行故障排除时很有帮助（我说的是当你在一段代码中遇到名称时，而不是通过对象资源管理器浏览对象，这使得事情在定义上更加明显）。

您的命名方案取决于您，并且您在这里基本上不会得到“正确”的答案，除了您应该始终如一地单方面地应用您的约定，并尽您所能确保您的全部时间都投入其中并遵循它。但我会说我不会对这样的事情犹豫不决：

```
Table: dbo.Cars_Import
View:  dbo.View_Cars_Import 
```

但对我来说，这似乎意味着视图可能只是位于表格上方的东西（比如美化输出、添加或隐藏列等），而不是提供表格的东西。所以我有点同意@HABO 的观点，也许有更好的方法来命名这个描述它的作用的视图。

# java - StringBuffer 的最大大小

> ID：11908665
> 
> 赞同：5
> 
> 时间：2012-08-10T20:17:00.210
> 
> 标签：java, stringbuffer

为什么会`StringBuffer`限制它的大小？

我浏览了一些链接： http: [//www.coderanch.com/t/540346/java/java/maximum-size-hold-String-buffer](http://www.coderanch.com/t/540346/java/java/maximum-size-hold-String-buffer)。

是因为 count 成员变量，它是一个 int 吗？

假设我们有 2^31-1 个字符，`StringBuffer`并且我们在其中追加了一些字符`StringBuffer`。Count 成员变量将增加附加的字符数，如果 Count 变量已经达到最大值 (2^31-1)，它将恢复为某个负值。

为什么会抛出错误？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-10T20:19:30.123

因为 stringbuffer 在内部使用了一个数组，并且一个数组可以容纳的最大元素数是 2^31-1 如果你在达到这个值后增加它会变成负数并抛出错误

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T20:24:03.847

`StringBuffer`使用`char[]`.
在 Java 中，数组**只能通过整数**进行索引，这意味着数组索引的最大值是`Integer.MAX_VALUE`- 1（即 2^31 - 1）。这意味着Java中数组的大小不能大于`Integer.MAX_VALUE`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-02T12:04:44.507

答案因系统架构而异。

*当我在 2012 年发布答案时，这台旧机器*

> 最大字符长度 = **37748734**
> 
> Java版本：1.6.0_35
> 
> 操作系统：Windows 7
> 
> 系统架构：32位（x86）
> 
> 内存：2 GB
> 
> 处理器：奔腾双核 E5800 3.20GHz

*2016年*

> 最大字符长度 = **301989886**
> 
> Java版本：1.8
> 
> 操作系统：Ubuntu 14 LTE 和 Windows 7
> 
> 系统架构：64位（x86_64）
> 
> 内存：8 GB
> 
> 处理器：Intel(R) Core(TM) i3-4130 CPU @ 3.40GHz

自己运行这个程序

```
 StringBuffer strbTest = new StringBuffer();
        long len = 0;
        try {
            System.out.println("Wait.... til number not generated.");

            while(true) {
                strbTest.append("a");
                len++;
            }
        } catch (OutOfMemoryError e) {
            System.out.println("Max length on your system is "+len);
            System.out.println("Error");
        }
        System.out.println("End"); 
```

输出

```
Max length on your system is 37748734 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T20:19:35.993

如果您在缓冲区中接近 2^31 个字符，那么您做错了，而且您早就用完了内存。

# dll - 如何在没有 vsdrfcomselfreg 的情况下注册 DLL

> ID：11908667
> 
> 赞同：1
> 
> 时间：2012-08-10T20:17:14.103
> 
> 标签：dll, com, registry, installation

我正在创建一个 Visual Studio 安装和部署项目以在目标机器上安装一个 DLL。我尝试了许多配置和许多注册表修改无济于事。我终于能够使用 vsdrfcomselfreg 安装和注册 DLL，但是我在网上看到的所有地方似乎都认为这种方法不正确。

我想知道的是，这种方法是否有类似的结果是可以接受的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T14:17:35.697

传统的 COM DLL 在 IDE 的 register 属性中会有以下选择：

*   vsdrfCOMSelfReg
*   vsdrfCOM
*   vsdrfCOMRelativePath

看这里：

[http://www.simple-talk.com/2005/04/25/getting-started-with-setup-projects/](http://www.simple-talk.com/2005/04/25/getting-started-with-setup-projects/)

# c# - 单击动态添加的按钮时，如何触发 aspx 脚本？

> ID：11908668
> 
> 赞同：0
> 
> 时间：2012-08-10T20:17:17.103
> 
> 标签：c#, javascript, jquery, asp.net, event-handling

这是上下文：

我正在构建一个 .aspx 页面，该页面允许用户管理我们在服务器上拥有的一些 xml 文档。页面内容是使用 AJAX 加载的，因此按钮和表单会动态添加到文档中。

如果我有在.aspx 页面加载到客户端计算机之前在它中创建的静态按钮，我可以很容易地将一个事件附加到它。但是，我使用 jQuery 动态地添加和删除按钮和表单。

这是一个简化的示例：

在下面的 jsFiddle 中，我假设 html 文档包含以下脚本：

```
<script language="C#" type="text/C#" runat="server">
void SaveAllChanges(Object sender, EventArgs e)
{
    Button clickedButton = (Button)sender;
    clickedButton.Text = "foobar";
}
</script> 
```

而且我有一个包含以下内容的javascript文件：

```
$('button.buttonGenerator').click(function() {

    $('.buttonContainer').append(
        '<button onclick="SaveAllChanges">' +
        'Save All Changes!' +
        '</button>'
    );

}); 
```

显然，我正在创建的按钮无法以现在的方式运行 SaveAllChanges 函数。我添加了 onclick 属性，以伪代码风格显示我需要发生的事情。

如何使动态添加的按钮可以运行我在文档顶部的脚本标记中定义的 C# 方法？

这是jsfiddle：http: [//jsfiddle.net/2XwRJ/](http://jsfiddle.net/2XwRJ/)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:21:07.283

您可以为所有必须保存更改的按钮提供一个通用类（例如 class="ajaxButton"），并使用一个 jQuery 方法来响应与该类匹配的元素上的单击事件（使用[live](http://api.jquery.com/live/)以便反映对 DOM 的更新）。

```
$("button.ajaxButton").live("click", function(){
  // Perform your Ajax callback to run server-side code
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:23:28.480

你需要做的是使用类似 ..

```
$(document).ready(function() {
  $('button.buttonGenerator').click(function() {
    $('.buttonContainer').append(
        '<button id="#dynamicCommentButton" onclick="SaveAllChanges">' +
        'Save All Changes!' +
        '</button>'
    );
  });
  $(document).on('click', '#dynamicCommentButton', function() {
    alert($(this).attr('id'));
  });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-11T14:59:07.770

您将无法像在此处那样添加按钮，因为此处的代码只是将其添加为 HTML DOM 元素，并且该`onclick`属性将位于客户端元素上。因此，单击该按钮将尝试触发一个`SaveAllChanges`javascript 函数

```
$('.buttonContainer').append(
        '<button onclick="SaveAllChanges">' +
        'Save All Changes!' +
        '</button>'
 ); 
```

最好的办法是`SaveAllChanges`在 javascript 中创建该函数，然后您可以从那里处理它。我看到你能够做到这一点的两种方法是：

1.  有一个 http 端点设置（脚本服务、web api 或只是发布到一个页面），您可以使用您的 javascript 中的 Ajax 调用它。然后，您可以传递任何需要的参数。
2.  您可以在页面上有一个隐藏元素和隐藏按钮，以便在调用 javascript 时填充您需要的任何参数，然后单击隐藏按钮并返回页面。

我个人会从用户体验的角度选择第一种方法，因为页面不会每次都回发。我使用了类似于第二种方法的东西，效果很好，但感觉很笨拙。

# wordpress - 自定义侧边栏中小部件的显示 [wordpress]

> ID：11908671
> 
> 赞同：0
> 
> 时间：2012-08-10T20:17:22.590
> 
> 标签：wordpress

目前在侧边栏注册期间，我们可以提及“before_widget”和“after_widget”。但这限制了我们可以包装小部件的范围。

有没有一种方法可以在侧边栏中以任何我想要的方式显示小部件

例如

```
<?php foreach($widgets as $widget): ?>
   <div>
    <h1>heading</h1>
    <p>details</p>
    <?=widget->show()?>
   </div> 
<?php endforeach; ?> 
```

谢谢。

# mysql - 带有子查询的mysql查询

> ID：11908674
> 
> 赞同：-2
> 
> 时间：2012-08-10T20:17:39.300
> 
> 标签：mysql, subquery

我有一个 mysql 表，其中包含人名（id、name）和另一个在培训课程中存在的表（id_training、id_person、date）。我需要做一个 mysql 查询来了解从今天开始的最后两个月没有参加任何培训课程的人。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:20:25.417

```
SELECT p.name
FROM people AS p
LEFT JOIN training AS t
ON p.id = t.id_person
AND date > NOW() - INTERVAL 2 MONTH
WHERE t.id_person IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:22:22.770

`training sessions.id_person`people, people.id 中的主键是外键吗？另外，训练季节中日期属性的数据类型是什么？如果它是总天数，那么你会想要做这样的事情：

```
SELECT people.id, people.name
FROM people, training sessions
WHERE training sessions.id_person = people.id AND where training sessions.date !< 60 
```

# c# - 使用从 WinForms 到 WPF 的放大 API

> ID：11908676
> 
> 赞同：3
> 
> 时间：2012-08-10T20:17:47.337
> 
> 标签：c#, wpf, winforms, magnification

我在网上找到了一个在 WinForms 中使用 Magnification API 的[库](http://delphi32.blogspot.com/2010/09/windows-magnification-api-net.html)，它工作得很好。我试图让它与 WPF 一起工作，但没有运气，没有异常或错误，一切似乎都很好。我开始认为它不适用于 WPF。

WinForms 代码：

```
public class Magnifier : IDisposable
{
    private Form form;
    private IntPtr hwndMag;
    private float magnification;
    private bool initialized;
    private RECT magWindowRect = new RECT();
    private System.Windows.Forms.Timer timer;

    public Magnifier(Form form)
    {
        if (form == null)
            throw new ArgumentNullException("form");

        magnification = 2.0f;
        this.form = form;
        this.form.Resize += new EventHandler(form_Resize);
        this.form.FormClosing += new FormClosingEventHandler(form_FormClosing);

        timer = new Timer();
        timer.Tick += new EventHandler(timer_Tick);

        initialized = NativeMethods.MagInitialize();
        if (initialized)
        {
            SetupMagnifier();
            timer.Interval = NativeMethods.USER_TIMER_MINIMUM;
            timer.Enabled = true;
        }
    }

    void form_FormClosing(object sender, FormClosingEventArgs e)
    {
        timer.Enabled = false;
    }

    void timer_Tick(object sender, EventArgs e)
    {
        UpdateMaginifier();
    }

    void form_Resize(object sender, EventArgs e)
    {
        ResizeMagnifier();
    }

    ~Magnifier()
    {
        Dispose(false);
    }

    protected virtual void ResizeMagnifier()
    {
        if ( initialized && (hwndMag != IntPtr.Zero))
        {
            NativeMethods.GetClientRect(form.Handle, ref magWindowRect);
            // Resize the control to fill the window.
            NativeMethods.SetWindowPos(hwndMag, IntPtr.Zero,
                magWindowRect.left, magWindowRect.top, magWindowRect.right, magWindowRect.bottom, 0);
        }
    }

    public virtual void UpdateMaginifier()
    {
        if ((!initialized) || (hwndMag == IntPtr.Zero))
            return;

        POINT mousePoint = new POINT();
        RECT sourceRect = new RECT();

        NativeMethods.GetCursorPos(ref mousePoint);

        int width = (int)((magWindowRect.right - magWindowRect.left) / magnification);
        int height = (int)((magWindowRect.bottom - magWindowRect.top) / magnification);

        sourceRect.left = mousePoint.x - width / 2;
        sourceRect.top = mousePoint.y - height / 2;

        // Don't scroll outside desktop area.
        if (sourceRect.left < 0)
        {
            sourceRect.left = 0;
        }
        if (sourceRect.left > NativeMethods.GetSystemMetrics(NativeMethods.SM_CXSCREEN) - width)
        {
            sourceRect.left = NativeMethods.GetSystemMetrics(NativeMethods.SM_CXSCREEN) - width;
        }
        sourceRect.right = sourceRect.left + width;

        if (sourceRect.top < 0)
        {
            sourceRect.top = 0;
        }
        if (sourceRect.top > NativeMethods.GetSystemMetrics(NativeMethods.SM_CYSCREEN) - height)
        {
            sourceRect.top = NativeMethods.GetSystemMetrics(NativeMethods.SM_CYSCREEN) - height;
        }
        sourceRect.bottom = sourceRect.top + height;

        if (this.form == null)
        {
            timer.Enabled = false;
            return;
        }

        if (this.form.IsDisposed)
        {
            timer.Enabled = false;
            return;
        }

        // Set the source rectangle for the magnifier control.
        NativeMethods.MagSetWindowSource(hwndMag, sourceRect);

        // Reclaim topmost status, to prevent unmagnified menus from remaining in view. 
        NativeMethods.SetWindowPos(form.Handle, NativeMethods.HWND_TOPMOST, 0, 0, 0, 0,
            (int)SetWindowPosFlags.SWP_NOACTIVATE | (int)SetWindowPosFlags.SWP_NOMOVE | (int)SetWindowPosFlags.SWP_NOSIZE);

        // Force redraw.
        NativeMethods.InvalidateRect(hwndMag, IntPtr.Zero, true);
    }

    public float Magnification
    {
        get { return magnification; }
        set
        {
            if (magnification != value)
            {
                magnification = value;
                // Set the magnification factor.
                Transformation matrix = new Transformation(magnification);
                NativeMethods.MagSetWindowTransform(hwndMag, ref matrix);
            }
        }
    }

    protected void SetupMagnifier()
    {
        if (!initialized)
            return;

        IntPtr hInst;

        hInst = NativeMethods.GetModuleHandle(null);

        // Make the window opaque.
        form.AllowTransparency = true;
        form.TransparencyKey = Color.Empty;
        form.Opacity = 255;

        // Create a magnifier control that fills the client area.
        NativeMethods.GetClientRect(form.Handle, ref magWindowRect);
        hwndMag = NativeMethods.CreateWindow((int)ExtendedWindowStyles.WS_EX_CLIENTEDGE, NativeMethods.WC_MAGNIFIER,
            "MagnifierWindow", (int)WindowStyles.WS_CHILD | (int)MagnifierStyle.MS_SHOWMAGNIFIEDCURSOR |
            (int)WindowStyles.WS_VISIBLE,
            magWindowRect.left, magWindowRect.top, magWindowRect.right, magWindowRect.bottom, form.Handle, IntPtr.Zero, hInst, IntPtr.Zero);

        if (hwndMag == IntPtr.Zero)
        {
            return;
        }

        // Set the magnification factor.
        Transformation matrix = new Transformation(magnification);
        NativeMethods.MagSetWindowTransform(hwndMag, ref matrix);
    }

    protected void RemoveMagnifier()
    {
        if (initialized)
            NativeMethods.MagUninitialize();
    }

    protected virtual void Dispose(bool disposing)
    {
        timer.Enabled = false;
        if (disposing)
            timer.Dispose();
        timer = null;
        form.Resize -= form_Resize;
        RemoveMagnifier();
    }

    #region IDisposable Members

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    #endregion
} 
```

在 WPF 代码中，我刚刚修改了 Magnifer 类：

```
public class Magnifier : IDisposable
{
    private Window window;
    private IntPtr hwnd;
    private IntPtr hwndMag;
    private float magnification;
    private bool initialized;
    private RECT magWindowRect = new RECT();
    private DispatcherTimer timer;

    public Magnifier(Window window)
    {
        if (window == null)
            throw new ArgumentNullException("form");

        hwnd = new WindowInteropHelper(window).Handle;
        magnification = 2.0f;
        this.window = window;
        this.window.SizeChanged += form_Resize;
        this.window.Closing += form_FormClosing;

        timer = new DispatcherTimer();
        timer.Tick += timer_Tick;

        initialized = NativeMethods.MagInitialize();
        if (initialized)
        {
            SetupMagnifier();
            timer.Interval = TimeSpan.FromMilliseconds(NativeMethods.USER_TIMER_MINIMUM);
            timer.IsEnabled = true;
        }
    }

    void form_FormClosing(object sender, CancelEventArgs e)
    {
        timer.IsEnabled = false;
    }

    void timer_Tick(object sender, EventArgs e)
    {
        UpdateMaginifier();
    }

    void form_Resize(object sender, RoutedEventArgs e)
    {
        ResizeMagnifier();
    }

    ~Magnifier()
    {
        Dispose(false);
    }

    protected virtual void ResizeMagnifier()
    {
        if (initialized && (hwndMag != IntPtr.Zero))
        {
            NativeMethods.GetClientRect(hwnd, ref magWindowRect);
            // Resize the control to fill the window.
            NativeMethods.SetWindowPos(hwndMag, IntPtr.Zero,
                magWindowRect.left, magWindowRect.top, magWindowRect.right, magWindowRect.bottom, 0);
        }
    }

    public virtual void UpdateMaginifier()
    {
        if ((!initialized) || (hwndMag == IntPtr.Zero))
            return;

        POINT mousePoint = new POINT();
        RECT sourceRect = new RECT();

        NativeMethods.GetCursorPos(ref mousePoint);

        int width = (int)((magWindowRect.right - magWindowRect.left) / magnification);
        int height = (int)((magWindowRect.bottom - magWindowRect.top) / magnification);

        sourceRect.left = mousePoint.x - width / 2;
        sourceRect.top = mousePoint.y - height / 2;

        // Don't scroll outside desktop area.
        if (sourceRect.left < 0)
        {
            sourceRect.left = 0;
        }
        if (sourceRect.left > NativeMethods.GetSystemMetrics(NativeMethods.SM_CXSCREEN) - width)
        {
            sourceRect.left = NativeMethods.GetSystemMetrics(NativeMethods.SM_CXSCREEN) - width;
        }
        sourceRect.right = sourceRect.left + width;

        if (sourceRect.top < 0)
        {
            sourceRect.top = 0;
        }
        if (sourceRect.top > NativeMethods.GetSystemMetrics(NativeMethods.SM_CYSCREEN) - height)
        {
            sourceRect.top = NativeMethods.GetSystemMetrics(NativeMethods.SM_CYSCREEN) - height;
        }
        sourceRect.bottom = sourceRect.top + height;

        if (this.window == null)
        {
            timer.IsEnabled = false;
            return;
        }

        //if (this.window.IsDisposed)
        //{
        //    timer.IsEnabled = false;
        //    return;
        //}

        // Set the source rectangle for the magnifier control.
        NativeMethods.MagSetWindowSource(hwndMag, sourceRect);

        // Reclaim topmost status, to prevent unmagnified menus from remaining in view. 
        NativeMethods.SetWindowPos(hwnd, NativeMethods.HWND_TOPMOST, 0, 0, 0, 0,
            (int)SetWindowPosFlags.SWP_NOACTIVATE | (int)SetWindowPosFlags.SWP_NOMOVE | (int)SetWindowPosFlags.SWP_NOSIZE);

        // Force redraw.
        NativeMethods.InvalidateRect(hwndMag, IntPtr.Zero, true);
    }

    public float Magnification
    {
        get { return magnification; }
        set
        {
            if (magnification != value)
            {
                magnification = value;
                // Set the magnification factor.
                Transformation matrix = new Transformation(magnification);
                NativeMethods.MagSetWindowTransform(hwndMag, ref matrix);
            }
        }
    }

    protected void SetupMagnifier()
    {
        if (!initialized)
            return;

        IntPtr hInst;

        hInst = NativeMethods.GetModuleHandle(null);

        // Make the window opaque.
        //form.AllowTransparency = true; (done in xaml)
        //window.Background = Brushes.Transparent; (done in xaml)
        //window.Opacity = 255;

        // Create a magnifier control that fills the client area.
        NativeMethods.GetClientRect(hwnd, ref magWindowRect);
        hwndMag = NativeMethods.CreateWindow((int)ExtendedWindowStyles.WS_EX_CLIENTEDGE, NativeMethods.WC_MAGNIFIER,
            "MagnifierWindow", (int)WindowStyles.WS_CHILD | (int)MagnifierStyle.MS_SHOWMAGNIFIEDCURSOR |
            (int)WindowStyles.WS_VISIBLE,
            magWindowRect.left, magWindowRect.top, magWindowRect.right, magWindowRect.bottom, hwnd, IntPtr.Zero, hInst, IntPtr.Zero);

        if (hwndMag == IntPtr.Zero)
        {
            return;
        }

        // Set the magnification factor.
        Transformation matrix = new Transformation(magnification);
        NativeMethods.MagSetWindowTransform(hwndMag, ref matrix);
    }

    protected void RemoveMagnifier()
    {
        if (initialized)
            NativeMethods.MagUninitialize();
    }

    protected virtual void Dispose(bool disposing)
    {
        timer.IsEnabled = false;
        //if (disposing)
        //    timer.Dispose();
        timer = null;
        window.SizeChanged -= form_Resize;
        RemoveMagnifier();
    }

    #region IDisposable Members

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    #endregion
} 
```

XAML：

```
<Window x:Class="WpfApplication11.MagnifierWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MagnifierWindow" Height="350" Width="525" AllowsTransparency="True" WindowStyle="None">

<Window.Background>
    <SolidColorBrush />
</Window.Background> 
```

- 要使用这个类，我只是在 Form/Window 的构造函数中初始化它。

- 我在 WPF 中所做的更改：

*   添加了“hwnd”字段，在放大镜构造函数中对其进行了初始化。
*   将 System.Windows.Forms.Timer 替换为 System.Windows.Threading.DispatcherTimer。
*   将 form.Resize 更改为 window.SizeChanged 并将 form.FormClosing 更改为 window.Closing。但这无关紧要吗？
*   在 UpdateMagnifier() 中注释了 if (this.window.IsDisposed)，因为 Window 中没有 IsDisposed 属性。
*   在 Dispose() 中评论了一个处置检查。

- 由于字符限制，我无法添加本机方法和结构。

帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-02T02:24:08.370

您应该在加载窗口的 Loaded 事件中初始化放大镜，并且可以检索窗口句柄。否则，它始终为零。

```
public Magnifier(Window window)
{
    if (window == null)
        throw new ArgumentNullException("form");

    hwnd = new WindowInteropHelper(window).Handle;
    magnification = 2.0f;
    this.window = window;
    this.window.SizeChanged += form_Resize;
    this.window.Closing += form_FormClosing;

    timer = new DispatcherTimer();
    timer.Tick += timer_Tick;
    Loaded+=MainWindow_Loaded;
}

void MainWindow_Loaded(object sender, RoutedEventArgs e)
{
    initialized = NativeMethods.MagInitialize();
    if (initialized)
    {
        handle = new WindowInteropHelper(this).Handle;
        SetupMagnifier();
        timer.Interval = TimeSpan.FromMilliseconds(NativeMethods.USER_TIMER_MINIMUM);
        timer.Start();// = true;
    }
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2021-06-19T11:13:37.987

在 windowsform 中使用这个放大镜类。

```
 public Home()
    {
    InitializeComponent();
    Magnifier mg = new Magnifier(this);
    } 
```

# tsql - 存储过程作为视图或调用函数

> ID：11908678
> 
> 赞同：0
> 
> 时间：2012-08-10T20:17:58.157
> 
> 标签：tsql, function, stored-procedures, view

我可以使用存储过程来诱导系统视图吗？例如我有它：

```
CREATE PROCEDURE DBO.status_serwer
AS
BEGIN
EXECUTE msdb.dbo.sysmail_help_status_sp
END 
```

Sysmail_help_status 过程返回服务器的状态：'stopped' 或'started' 现在，我可以将 start_serwer 过程作为视图或函数调用吗？有人帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:39:44.690

好吧，如果你查看那个存储过程，你可以抓住它运行的查询并稍微修改它，这样你就可以在其他地方使用它，就像这样；

```
SELECT 
    CASE (SELECT COUNT(*) FROM msdb.sys.service_queues WHERE name = N'ExternalMailQueue' AND is_receive_enabled = 1) 
        WHEN 0 THEN 'STOPPED' 
        ELSE 'STARTED' 
        END AS 'sysmail_status' 
```

以下是原文供参考：

```
ALTER PROCEDURE [dbo].[sysmail_help_status_sp]
  WITH EXECUTE AS 'dbo'
AS
BEGIN
    IF NOT EXISTS (SELECT * FROM sys.service_queues WHERE name = N'ExternalMailQueue' AND is_receive_enabled = 1)
       SELECT 'STOPPED' AS Status
    ELSE
       SELECT 'STARTED' AS Status
END 
```

# python - 按日期键对python字典进行排序

> ID：11908686
> 
> 赞同：2
> 
> 时间：2012-08-10T20:18:39.800
> 
> 标签：python, datetime, data-structures

我有一个像下面这样的字典，并试图通过键（它们是日期时间对象）对其进行排序：

```
def t(date_st):
    return datetime.strptime(date_st, '%d-%m-%Y')

def sort_dict_data(data):
keylist = data.keys()
keylist.sort()
sorted_x = {}
for key in keylist:
    sorted_x.update({datetime.strftime(key, '%d-%m-%Y'):data.get(key)})
return sorted_x

print sort_dict_data({t('07-07-2012'): 3.5, t('09-07-2012'): 9.0, t('08-07-2012'): 5.0})
results: {'07-07-2012': 3.5, '09-07-2012': 9.0, '08-07-2012': 5.0} 
```

我怎么能得到这样的：

```
{'07-07-2012': 3.5, '08-07-2012': 5.0, '09-07-2012': 9.0} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:22:11.330

字典没有可靠的顺序。

您可以使用 an[`OrderedDict`](http://docs.python.org/library/collections.html#collections.OrderedDict)来代替。

```
def sort_dict_data(data):
    return OrderedDict((datetime.strftime(k, '%d-%m-%Y'), v)
                       for k, v in sorted(data.iteritems())) 
```

在线查看它：[ideone](http://ideone.com/MyrSj)

注意`OrderedDict`顺序是按*插入*顺序，而不是按键顺序。上面的代码将项目插入到`OrderedDict`键顺序中，为您提供所需的结果。但重要的是要记住，以后对字典所做的任何添加都将出现在最后，而不是根据键顺序出现在正确的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:30:49.400

OrderedDict 保留插入顺序（年表），而不是键顺序。普通的字典也不保留。

对于按键排序的字典，您可能需要 Treap、红黑树或计算机科学已知的许多其他树数据结构之一。

Treaps 平均速度很快，但偶尔会有点慢，因为它会重新平衡自己。

红黑树是众所周知的，相对复杂（与树相比），并且平均性能良好。他们的主要好处是他们没有高度可变的性能，使他们有时在用户界面中很好。

我最近对类似于 dicts 但具有排序键的数据结构进行了性能比较。可以在这里找到：[http ://stromberg.dnsalias.org/~strombrg/python-tree-and-heap-comparison/](http://stromberg.dnsalias.org/~strombrg/python-tree-and-heap-comparison/)

# ruby-on-rails - 运行 rails 服务器时的 SegFault

> ID：11908687
> 
> 赞同：4
> 
> 时间：2012-08-10T20:18:45.723
> 
> 标签：ruby-on-rails, ruby, segmentation-fault, rvm

出于某种原因，当我运行我的应用程序时，会选择两个版本的 Ruby：

```
[edarroyo:~/Development/sample_app]$ rails server

/Users/edarroyo/.rvm/gems/ruby-1.9.3-p194/gems/pg-0.14.0/lib/pg_ext.bundle: [BUG] Segmentation fault
ruby 1.8.7 (2012-02-08 patchlevel 358) [universal-darwin12.0] 
```

如何阻止我的应用程序选择这两个版本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T00:12:44.713

1) 确保使用 gcc-4.2 安装 ruby​​ - 它可以防止使用 clang/llvm 编译 ruby​​ 时发生的随机失败

2）确保你使用红宝石：

```
rvm use 1.9.3 --default 
```

我已经添加了默认开关——所以 ruby​​ 用于每个新的 shell 会话。

# php - iOS + PHP 登录最佳实践

> ID：11908688
> 
> 赞同：3
> 
> 时间：2012-08-10T20:18:49.123
> 
> 标签：php, iphone, objective-c, authentication, login

我正在构建一个从我的服务器访问 MySQL 数据库的应用程序，我正在从应用程序发送数据并从服务器接收 PHP 响应。我正在尝试使用这个数据库为这个应用程序创建一个登录系统。

过程是什么？构建这个的最佳实践是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-10T20:39:32.147

您必须在您的应用程序中存储某种会话值并将其与您的请求一起发送。您也许可以利用 PHP 会话来执行此操作，但我通常更喜欢为 API 密钥创建数据库条目。成功登录后，将为该用户生成一个 API 密钥并存储在设备上。然后在每个请求上，您将传递用户名/api 密钥组合以在服务器端进行身份验证。如果您希望将代码库扩展到 android/blackberry/toaster 烤箱，此方法将很容易移植。它构成了一个非常便携的身份验证系统。此外，这使您不必将密码存储在设备上，这是一个安全问题。

这就是一个程序员选择这样做的方式。

# javascript - 在事件上使用 jquery 时出现意外的令牌

> ID：11908697
> 
> 赞同：0
> 
> 时间：2012-08-10T20:19:16.417
> 
> 标签：javascript, jquery

我正在尝试绑定到一个类的单击事件，但继续收到此错误：

```
Uncaught SyntaxError: Unexpected token ; 
```

我的 jquery 和 HTML

```
function loadData() {

  isLoading = true;
  $('#loaderCircle').show();

  $.post(apiURL, { f: 'gridview', start: pgStart, end: pgEnd, params: $("#search_basic_form_id").serialize() }, function(data){
        if (data.success) {
            // Create HTML for the images.
            var html = '';

            $.each(data.profiles, function() {

                html += '<li><div class="image-wrapper">';
                html += '<div class="image-options">';
                html += '<a href="#" id="imgoption_'+this.user_id+'" class="favoriteButton" title="Add Favorite"><br>Favorite</a>';
                html += '</div>';
                html += '<a href="/view_profile.php?id='+this.user_id+'">';
                html += '<img src="'+this.file_name+'" width=200px; height="'+this.height+'px" style="border:0;">';
                html += '</a>';

                // Image title.
                html += '<p>'+this.name+' '+this.age+'</p>';
                html += '<p>'+this.city+', '+this.state+'</p>';
                html += '</div>';
                html += '</li>';                    
            });

            // Add image HTML to the page.
            $('#tiles').append(html);

            // Apply layout.
            applyLayout();

            pgStart = data.start;
            pgEnd = data.end;

        }
    }, "json");
};

$(document).ready(function() {

    // Load first data from the API.
    loadData();

    $('.favoriteButton').on('click', function(e) {
        e.preventDefault();

        alert("Favorite Clicked");
    });
... 
```

不知道为什么我会收到此错误，但它指向 jquery 调用中的最后一个分号。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:27:07.497

啊，我想明白了。试试这个为您的文档准备好：

```
$(document).ready(function() { 
```

不同的是缺少新的。

# php - 为什么这段代码会导致解析错误？

> ID：11908703
> 
> 赞同：0
> 
> 时间：2012-08-10T20:19:40.457
> 
> 标签：php, syntax-error

错误信息：

> 解析错误：语法错误，第 135 行 C:\xampp\htdocs\index.php 中的意外“{”

代码：

```
if(isset($_REQUEST['d'])
{ // LINE 135 IS THIS ONE
    $d = $_REQUEST['d'];

    if ($d) {
        while (preg_match('/\\\/',$d)) $d = preg_replace('/\\\/','/',$d);
        while (preg_match('/\/\//',$d)) $d = preg_replace('/\/\//','/',$d);
        while (preg_match('/\.\.\//',$d)) $d = preg_replace('/\.\.\//','/',$d);
        if ($d[strlen($d)-1] != '/') $d = $d.'/';
        if ($d == '/') $d = '';
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-10T20:20:25.770

您缺少一个右括号：

```
if ( isset($_REQUEST['d'] ) ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T20:28:26.433

Yan 得到了主要答案，但您在第一个正则表达式中也缺少反斜杠：

```
 while (preg_match('/\\\/',$d)) $d = preg_replace('/\\\/','/',$d);
                          ^                              ^ 
```

前两个在模式中插入一个文字反斜杠，而第三个反斜杠实际上是在最后转义模式分隔符，导致一个未终止的模式。

# facebook - Facebook like 按钮在某些元素后面弹出

> ID：11908708
> 
> 赞同：0
> 
> 时间：2012-08-10T20:20:00.493
> 
> 标签：facebook, popup, facebook-like, overflow, z-index

在我的网站上，当我按下“赞”按钮时弹出的评论框位于页面的某些元素后面，我真的不知道如何修复它。

两天来，我一直在努力处理 z-index 属性，但没有结果，现在我通过将父 div 的溢出属性从隐藏更改为可见/自动找到了解决方案，它可以工作！但是我无法使用此修复程序，因为该 div 已将溢出设置为隐藏，因为我正在使用 slimScroll 插件来自定义滚动条...

[这](http://www.decorative.ro/en/figurative-art)是网站，只需单击任何图像并按“赞”按钮即可查看会发生什么。

弹出窗口的右侧和左侧集成在一个表格中......我在想，如果我删除表格并只使用 div，修复会更容易吗？

谢谢！

# liferay - Liferay 从本地迁移到实时站点

> ID：11908715
> 
> 赞同：0
> 
> 时间：2012-08-10T20:20:25.880
> 
> 标签：liferay, liferay-6

![在此处输入图像描述](../Images/f3b14e69de35e42acbdb49f032f9aafc.png)

我从 livesite 下载了 Liferay 文件，为一些本地开发设置本地环境。下载文件后，我运行 catalina 文件 ( `./catalina.sh start`) 但不幸的是我收到了 404 错误。

我不确定从哪里开始在本地设置 Liferay。

*   我认为当我从实时服务器转移到本地机器时，我应该做一些初始设置。
*   我想我还需要连接我的数据库。我现在拥有数据库的本地副本，并且已经导入 MySQL。我只需要连接它们（我猜输入我的数据库用户和密码）。
*   除了下载文件和启动服务器之外，我真的没有做任何其他事情，因为我不确定我应该做什么设置和配置。

我是 Liferay 的新手，我为我的愚蠢道歉。

* * *

**编辑**

我的`portal-ide.properties`设置：

![在此处输入图像描述](../Images/74a4580b1b6027614794ce16390b30ad.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T06:57:54.047

请参阅门户根文件夹中的 portal-ext.properties 或其他 *.properties 文件。

有关错误详细信息，请参阅 liferay/tomcat/logs/catalina.out 中的日志文件

# jsf - 如何配置战争以依赖战争中的导出库而不是服务器中的库？

> ID：11908720
> 
> 赞同：2
> 
> 时间：2012-08-10T20:20:55.853
> 
> 标签：jsf, jakarta-ee, jboss, jboss-4.2.x

我想在 JBoss 4.2 中部署战争，但我无法控制它的目录，所以我无法替换`jsf-impl.jar`and `jsf-api.jar`。

我的问题是：如何配置战争以依赖战争中的`jsf-impl.jar`和`jsf-api.jar`导出而不是服务器中的这个库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T02:34:31.920

这取决于使用的服务器。对于 JBoss 4.2 和更高版本，您可以通过将以下上下文参数添加到 webapp 的`web.xml`.

```
<context-param>
     <param-name>org.jboss.jbossfaces.WAR_BUNDLES_JSF_IMPL</param-name>
     <param-value>true</param-value>
</context-param> 
```

# iphone - App Store 指南 2.6 在其指定容器区域之外读取或写入数据的应用程序将被拒绝

> ID：11908722
> 
> 赞同：1
> 
> 时间：2012-08-10T20:21:02.640
> 
> 标签：iphone, nsurlconnection, appstore-approval

我想知道是否遵循以下准则：

> 2.6“在指定容器区域外读写数据的应用将被拒绝”

意味着您无法读取从`NSUrlConnection`. 在我的应用程序中，我从我的网站下载页面源并将其解析为可用数据。这不会违反指导方针，对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:27:06.450

不，这根本不是这个意思。你没事。指南 2.6 旨在引用试图访问应用程序沙箱之外的系统文件（*即*在手机上）的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:31:18.490

我已经发布了几个完全符合您描述的应用程序：它们从 Web 服务器获取数据，将其解析为一些数据，然后在本地缓存。因此，我可以根据我的经验确认这是完全支持的行为，符合 App Store 指南。

# python - 使用 Python 的 os.walk 函数和 ls 命令获得不同的结果

> ID：11908725
> 
> 赞同：4
> 
> 时间：2012-08-10T20:21:09.687
> 
> 标签：python, linux, bash, python-2.7

```
#!/bin/python
import os
pipe=os.popen("ls /etc -alR| grep \"^[-l]\"|wc -l")         #Expr1
a=int(pipe.read())
pipe.close()
b=sum([len(files) for root,dirs,files in os.walk("/etc")])  #Expr2
print a
print b
print "a equals to b ?", str(a==b)  #False
print "Why?" 
```

**Expr1**的功能和**Expr2**的功能有什么**区别**？我认为**Expr1**给出了正确的答案，但不确定。

 ******* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:48:25.860

**简短的回答：**

`ls -laR | grep "^[-l]"`计算目录的符号链接。它匹配任何以目录开头`l`并包含符号链接的行。

相反，`[files for root, dirs, files in os.walk('/etc')]` **不计入目录的符号链接**。它忽略所有目录并仅列出文件。

* * *

**长答案：**

以下是我识别差异的方法：

```
import os
import subprocess
import itertools

def line_to_filename(line):
    # This assumes that filenames have no spaces, which is a false assumption
    # Ex: /etc/NetworkManager/system-connections/Wired connection 1
    idx = line.rfind('->')
    if idx > -1:
        return line[:idx].split()[-1]
    else:
        return line.split()[-1] 
```

`line_to_filename`尝试在`ls -laR`.

这定义`expr1`并且`expr2`本质上与您的代码相同。

```
proc=subprocess.Popen(
    "ls /etc -alR 2>/dev/null | grep -s \"^[-l]\" ", shell = True,
    stdout = subprocess.PIPE)         #Expr1
out, err = proc.communicate()
expr1 = map(line_to_filename, out.splitlines())

expr2 = list(itertools.chain.from_iterable(
    files for root,dirs,files in os.walk('/etc') if files))  #Expr2

for expr in ('expr1', 'expr2'):
    print '{e} is of length {l}'.format(e = expr, l = len(vars()[expr])) 
```

这会从中删除名称`expr1`也位于`expr2`：

```
for name in expr2:
    try:
        expr1.remove(name)
    except ValueError:
        print('{n} is not in expr1'.format(n = name)) 
```

删除共同共享的文件名后`expr1`，`expr2`

```
print(expr1) 
```

产量

```
['i386-linux-gnu_xorg_extra_modules', 'nvctrl_include', 'template-dkms-mkdsc', 'run', '1', 'conf.d', 'conf.d'] 
```

然后我过去常常`find`在其中找到这些文件，`/etc`并试图猜测这些文件有什么不寻常之处。它们是目录（而不是文件）的符号链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:32:55.537

如果您使用 walk，则忽略错误（请参阅[此](http://docs.python.org/library/os.htm)内容），并且 ls 会针对每个错误发送一条消息。这些算作文字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:43:36.383

在我的机器上，/etc 是 /private/etc 的符号链接，因此`ls /etc`只有一行输出。给出和`ls /etc/`之间的预期等价。`ls``os.walk`******

# git - 我可以从 .git 目录中恢复未提交的文件吗？

> ID：11908729
> 
> 赞同：1
> 
> 时间：2012-08-10T20:21:19.940
> 
> 标签：git

* * *

编辑：感谢大家的回复，但我很抱歉 - 我正在查看一个旧文件（我没有处理过），当我备份目录时，我的应用程序的最新版本*被复制了。*

* * *

我正在开发一个应用程序，但在格式化驱动器/重新安装操作系统之前忘记提交更改。我确实事先复制了我的应用程序目录（包括 .git 目录）。

是否可以恢复我正在处理但在备份时未提交的文件？

我已经恢复了应用程序的备份目录，但它似乎是最后一次提交的状态。

如果不可能，因为没有那么多更改，这不是什么大问题，但仍然 - 最好不要丢失任何工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:34:40.790

这取决于您是否隐藏了更改，我认为。如果你没有，我会说不。

如果您还没有考虑过存储，也许您应该在将来考虑它。存储允许您保留代码的工作备份，而无需提交它。这样，如果您的代码处于混乱、无法使用的状态，您可以在不提交的情况下备份它。

[藏匿](http://git-scm.com/book/en/Git-Tools-Stashing)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T20:34:54.077

很抱歉，您无法使用 Git[取回未提交的更改。](https://stackoverflow.com/questions/3240436/git-recover-uncommitted-changes)但是@sehe对其他地方可以找到您的更改有一些[很好的建议。](https://stackoverflow.com/a/5788069/581584)

1.  您的编辑器是否自动保存每个文件的备份？（例如 Vim 的 bak~ 文件）
2.  /tmp 或 C:\Temp。
3.  Eclipse 本地设置

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T20:31:03.467

不。如果 git 从未被告知更改（通过提交），那么它如何检索更改？

也就是说，如果您想要 git 知道的任何更改、存储等的列表，您可以使用它`git reflog`来查看所有最近的操作。

# actionscript-3 - DataProvider 的文章示例有效，但同时发出 TypeError: Error #1009

> ID：11908730
> 
> 赞同：0
> 
> 时间：2012-08-10T20:21:21.220
> 
> 标签：actionscript-3, flash, actionscript

在`DataProvider` [这里阅读](http://help.adobe.com/en_US/ActionScript/3.0_UsingComponentsAS3/WS5b3ccc516d4fbf351e63e3d118a9c65b32-7fce.html#WS5b3ccc516d4fbf351e63e3d118a9c65b32-7fb3)

第二个代码示例显示列表中选定项目的数据，位于`TextArea`. 这篇文章的代码虽然做了它应该做的事情，但给了我以下错误：

> TypeError：错误 #1009：无法访问空对象引用的属性或方法。在 fl.controls::TextArea/drawLayout() 在 fl.controls::TextArea/draw() 在 fl.core::UIComponent/callLaterDispatcher()

这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:42:13.053

原来我还必须`TextArea`在我的库中拥有控件。

# mono - 与 bool Type.op_Equality (Type, Type) 的 Mono 兼容性

> ID：11908731
> 
> 赞同：6
> 
> 时间：2012-08-10T20:21:24.903
> 
> 标签：mono

我正在考虑从 VS2010 更改为 Mono，因此我通过 MoMA 运行我的程序集，看看我在过渡时可能遇到多少困难。在生成的报告中，我发现我不断收到此错误：

```
bool Type.op_Equality (Type, Type)  Implement it properly once 4.0 impl details are known. 
```

我检查了类状态页面，发现 bool Type.op_Equality 在 mscorlib.dll（系统命名空间）中被列为 4.5 和 4.0 中的 TODO，它正在等待实现细节。这让我想到了我的问题：

**有谁知道实施细节是否/何时可用？或者如果我忽略了这个 TODO，我的代码还能工作吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T23:20:16.173

我还没有听说过与 Mono 的 Type.op_Equality 实现相关的任何错误（这并不意味着当然没有）。

真正知道您的代码是否可以工作的唯一方法是在单声道上进行尝试。MoMA 只是一个指南，而不是一个预言，因此它列出了*潜在*的问题（具有不同程度的严重性）。

对于 Mono 中的任何特定代码，还可以检查源代码以查看您在 MoMA 中收到的消息是否影响到您。

例如：[https](https://github.com/mono/mono/blob/master/mcs/class/corlib/System/Type.cs#L482) ://github.com/mono/mono/blob/master/mcs/class/corlib/System/Type.cs#L482 。

# php - 从 wordpress 中的静态资源中删除查询字符串

> ID：11908738
> 
> 赞同：0
> 
> 时间：2012-08-10T20:21:42.710
> 
> 标签：php, wordpress, function, add-filter

我想删除 wordpress 中的查询字符串，我写过：

```
function _remove_script_version( $src ){
$parts = explode( '?', $src );
return $parts[0];
}
add_filter( 'script_loader_src', '_remove_script_version', 15, 1 );
add_filter( 'style_loader_src', '_remove_script_version', 15, 1 ); 
```

但我需要忽略一个查询字符串：

[http://maps.googleapis.com/maps/api/js](http://maps.googleapis.com/maps/api/js)

我该怎么写？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:02:02.517

例如，如果您不想删除`3.4.1`此 URL 中包含的版本`http://maps.googleapis.com/maps/api/js?sensor=false&v=3&language=en%C2%AEion=US&ver=3.4.1`

```
function _remove_script_version($src) {
    preg_match(
        "#^(https?)://([.0-9a-zA-Z-]+)(/?.*?)([^/]*)$#",
        $src,
        $queryStringPartsArray
    );
    $endOfUrlArray = explode('?', $queryStringPartsArray[4]);
    $paramsArray = explode('&', $endOfUrlArray[1]);
    foreach($paramsArray as $param) {
        $parts = explode('=', $param);
        if(($parts[1] == "ver") && !preg_match("/3.4.1/", $parts[1])) {
            return $queryStringPartsArray[1]."://".
                   $queryStringPartsArray[2].
                   $queryStringPartsArray[3].
                   $endOfUrlArray[0];
        }
    }
} 
```

# jquery - 幻灯片中的另一个幻灯片

> ID：11908740
> 
> 赞同：0
> 
> 时间：2012-08-10T20:21:48.623
> 
> 标签：jquery, slideshow

我想知道是否可以在幻灯片而不是图像中嵌入动画幻灯片？基本上我有一个设计，其中有多个版本，我希望彼此重叠，所以我制作了一个简单的 jquery 幻灯片来做到这一点（基于[本教程](http://jonraasch.com/blog/a-simple-jquery-slideshow)），但我希望它作为我的设计页面的一部分自己的幻灯片（动画 gif 原则上起到了作用，但要么太大要么质量差）......

感谢您的帮助和耐心！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:48:44.230

它可能，但你必须开发自己的画廊，因为所有免费的互联网 jquery gals 只显示图片或视频......一个想法，它下载一个简单的画廊并将其插入另一个画廊，例如你链接中的简单 jquery 画廊，制作一些gals并将每个gals插入[任何滑块](http://css-tricks.com/examples/AnythingSlider/)中，您应该在另一个幻灯片中插入幻灯片......

# sql-server - 如何将 SQL BACKUP 命令的结果输出到 Delphi 程序中？

> ID：11908741
> 
> 赞同：5
> 
> 时间：2012-08-10T20:21:51.227
> 
> 标签：sql-server, delphi, ado

从 SQL Server Management Studio 以交互方式运行 SQL 命令的用户可见的 sql 命令输出与执行 ADO 命令或 ADO 查询对象返回的输出不同。

```
USE [DBNAME] 
BACKUP DATABASE [DBNAME] TO 
 DISK = 'C:\SqlBackup\Backup.mdf' 
```

成功完成输出是这样的：

```
Processed 465200 pages for database 'DBNAME', file 'filename' on file 2.
Processed 2 pages for database 'DBNAME', file 'filename_log' on file 2.
BACKUP DATABASE successfully processed 465202 pages in 90.595 seconds (40.116 MB/sec). 
```

当我使用上面设置的 CommandText 或 SQL 执行 TADOCommand 或 TADOQuery 时，我没有得到任何这样的输出。如何从 SQL 命令的执行中读取这个“辅助输出”？我希望也许通过一些原始的 ADO 操作，我可能能够执行命令并取回上面的信息，以取得成功，以及执行 Sql 备份时的任何错误。

**更新**：下面的答案对我来说比我天真的尝试更好，它没有工作，使用普通的 Delphi TADOCommand 和 TADOConnection 类：

*   创建 TADOCommand 和 TADOConnection。
*   执行命令。
*   获取信息消息。

我在自己的编码尝试中遇到的问题是，我的第一个命令是“use dbname”，而我在代码中遍历的唯一记录集是“use dbname”命令的结果，而不是我正在执行的第二个命令。下面接受的答案遍历从执行 ADO 命令返回的所有记录集，因此它工作得更好。由于我在后台线程中执行所有这些操作，我实际上认为最好还是创建原始 Com 对象，并避免在我的线程中出现任何 VCL 纠缠。如果有人感兴趣，下面的代码可能是一个不错的组件，请告诉我，我可能会制作一个开源的“SQL Backup for Delphi”组件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-13T09:24:55.047

这是一个例子。我已经用 D7 和 MSSQL2000 对其进行了测试。它会将来自服务器的所有消息添加到 Memo1：

```
29 percent backed up.
58 percent backed up.
82 percent backed up.
98 percent backed up.
Processed 408 pages for database 'NorthWind', file 'Northwind' on file 1.
100 percent backed up.
Processed 1 pages for database 'NorthWind', file 'Northwind_log' on file 1.
BACKUP DATABASE successfully processed 409 pages in 0.124 seconds (26.962 MB/sec). 
```

此外，如果需要很长时间，请考虑不在主线程中实现 WHILE 循环。

```
uses AdoInt,ComObj;
.....

procedure TForm1.Button1Click(Sender: TObject);
var cmd  : _Command;
    Conn : _Connection;
    RA   : OleVariant;
    rs   :_RecordSet;
    n    : Integer;
begin
  Memo1.Clear;

  Conn := CreateComObject(CLASS_Connection) as _Connection;
  Conn.ConnectionString := 'Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=NorthWind;Data Source=SQL_Server';
  Conn.Open(Conn.ConnectionString,'','',Integer(adConnectUnspecified));

  cmd := CreateComObject(CLASS_Command) as _Command;
  cmd.CommandType := adCmdText;
  cmd.Set_ActiveConnection(Conn);
  cmd.CommandText := 'BACKUP DATABASE [NorthWind] TO  DISK = N''c:\sql_backup\NorthWind'' WITH  INIT ,  NOUNLOAD ,  NAME = N''NortWind backup'',  NOSKIP ,  STATS = 10,  NOFORMAT;';
  rs:=cmd.Execute(RA,0,Integer(adCmdText));

  while (rs<>nil) do
  begin
   for n:=0 to(Conn.Errors.Count-1)do begin
    Memo1.Lines.Add(Conn.Errors.Item[n].Description);
   end;
   rs:=rs.NextRecordset(RA);
  end;

  cmd.Set_ActiveConnection(nil);
  Conn.Close;
  cmd  := nil;
  Conn := nil;
end; 
```

我为存储过程找到[了这个线程（俄语） ，并为 BACKUP 命令更正了它。](http://www.sql.ru/forum/actualthread.aspx?bid=20&tid=92662#676355)

# read-eval-print-loop - 带有命令行历史和制表符补全的 mit-scheme REPL

> ID：11908746
> 
> 赞同：26
> 
> 时间：2012-08-10T20:22:40.580
> 
> 标签：read-eval-print-loop, mit-scheme

我正在阅读[SICP](http://mitpress.mit.edu/sicp/full-text/book/book.html)，我正在通过[homebrew](https://github.com/mxcl/homebrew/blob/master/Library/Formula/mit-scheme.rb)[`mit-scheme`](http://www.gnu.org/software/mit-scheme/)安装在我的 os x 10.8 笔记本电脑上。

一切都像宣传的那样工作，但是我很容易在 REPL 中为 Python 和 Node.js 等运行时获得选项卡完成和命令行历史记录。

我不是在寻找任何繁重的任务，但是这些功能在现代 REPL 中很容易获得（它只是Python 中的[一个简单的启动文件](http://docs.python.org/library/readline.html#example)，可以[在 Node.js 中用几行](https://gist.github.com/3317494)代码实现）。

是否有一种简单的方法可以在 mit-scheme REPL 中获得选项卡完成和命令历史记录，而无需重型应用程序或不必切换到 emacs（即在 xterm 终端中）？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-08-11T18:02:49.470

安装[readline 包装器](http://utopia.knoware.nl/~hlub/rlwrap/README.txt)：

`brew install rlwrap`

安装后，`rlwrap scheme`将为您提供持久的历史记录、paren 匹配和制表符补全。我通常将 rlwrap 与以下参数一起使用：

-r 将所有在输入和输出中看到的单词放在完成列表中。

-c 完整的文件名

-f 指定用于制表符完成的单词列表。我正在使用[MIT Scheme Reference Manual](http://www.gnu.org/software/mit-scheme/documentation/mit-scheme-ref/Binding-Index.html#Binding-Index)中的绑定精简列表。[您可以在此 gist](http://gist.github.com/3325982)中找到它，而不是在此处重新发布该列表。我将此文件存储在“$HOME”/scheme_completion.txt

`rlwrap -r -c -f "$HOME"/scheme_completion.txt scheme`

```
1 ]=> (flo:a <tab tab>
flo:abs    flo:acos   flo:asin   flo:atan   flo:atan2  
1 ]=> (flo:abs -42.0)

;Value: 42. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-19T10:39:16.280

我实际上建议您使用[Emacs](https://www.gnu.org/software/emacs/)，并在其中使用[Geiser](https://www.nongnu.org/geiser/)来访问 REPL 并帮助编辑方案文件。它还可以轻松处理各种方案 REPL，例如[Chez Scheme](https://cisco.github.io/ChezScheme/)、[Racket](https://racket-lang.org/)、[MIT Scheme](https://www.gnu.org/software/mit-scheme/)、[Guile](https://www.gnu.org/software/guile/)、[Chicken](http://call-cc.org/)、[Gambit](http://gambitscheme.org/wiki/index.php/Main_Page)和[Chibi Scheme](http://synthcode.com/scheme/chibi/)。[Emacs](https://www.gnu.org/software/emacs/)仍然非常适合与 Scheme 和 LISP 一起使用。强烈推荐。

# nuget - Nuget 包没有安装到单个项目中？

> ID：11908748
> 
> 赞同：1
> 
> 时间：2012-08-10T20:22:43.600
> 
> 标签：nuget

我已将几个 Nuget 包添加到我的多项目解决方案中，没有任何问题。但是，当我添加这个包时**——ews.x64**（Exchange Web 服务 API）—— *Nuget 不允许我将它添加到任何特定的项目*中。

包子文件夹是正常创建的：

```
D:\TFSSource\Exchange\Utilities\Src\ExchangePurge\packages\EWS.x64.1.2 
```

但是当您尝试管理解决方案的已安装包时，“管理 Nuget 包”对话框仅提供此特定包的**卸载**按钮。所有其他包都有**管理**按钮，允许将它们添加到单个项目中。

同样有趣的是，这个包出现在一个名为**.nuget的新创建的解决方案文件夹下的****packages.config**文件中？有什么想法可能导致这种情况吗？

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T16:43:33.147

看起来这是一个解决方案级别的包，一个没有项目特定内容或库的包。该软件包可能已正确安装并且一次可用于所有项目。

来源：[NuGet 常见问题解答](http://docs.nuget.org/docs/start-here/nuget-faq#What_is_the_difference_between_a_project-level_package_and_a_solution-level_package%3f)**

# c# - 将二维数组从后面的代码传递给 javascript

> ID：11908754
> 
> 赞同：0
> 
> 时间：2012-08-10T20:23:04.997
> 
> 标签：c#, javascript

我有一个从数据库获得的 DataTable，我想在后面的代码中创建一个二维数组（一旦我得到 DataTable ..），然后将它作为二维数组传递给 Javascript。

这就是我试图编写的代码：

```
int[,] videoQarray = new int[dt_questionVideo.Rows.Count,dt_questionVideo.Columns.Count ];
        string[,] videoQarrayTitle = new string[dt_questionVideo.Rows.Count, dt_questionVideo.Columns.Count ];

        for (var i = 0; i < dt_questionVideo.Rows.Count ; i++)
        {
            for (int j = 0; j < dt_questionVideo.Columns.Count; j++)
            {

                videoQarray[i,j] = Convert.ToInt32(dt_questionVideo.Rows[i][0]);
                videoQarrayTitle[i,j] = dt_questionVideo.Rows[i][1].ToString();   
            }
        }

        string createArrayScript = string.Format("var videQarray = [{0}];", string.Join(",", videoQarray));
        createArrayScript += string.Format("var videQarrayList = [{0}];", string.Join(",", videoQarrayTitle));

        Page.ClientScript.RegisterStartupScript(this.GetType(), "registerVideoQArray", createArrayScript, true); 
```

好吧，在浏览器控制台中，它说 videoQarray 没有定义..我想知道我该如何正确地做到这一点..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:00:35.090

可能变量是在函数内部定义的，因此对于代码的其他部分是隐藏的。尝试“var”的“window.videoQArray”：

```
string createArrayScript = string.Format("window.videQarray = [{0}];", string.Join(",", videoQarray));
createArrayScript += string.Format("window.videQarrayList = [{0}];", string.Join(",", videoQarrayTitle)); 
```

编辑：这是一个二维数组（好的，你在问题中写得很清楚，但我没有看到）。使用`JavaScriptSerializer`：

```
var serializer = new JavaScriptSerializer();
string createArrayScript = string.Format("window.videQarray = {0};", serializer.Serialize(videoQarray));
createArrayScript += string.Format("window.videQarrayList = {0};", serializer.Serialize(videoQarrayTitle)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-06T08:44:14.787

使用以下功能：

```
 public static string ArrayToString2D(string[,] arr)
    {
        StringBuilder str = new StringBuilder();
        str.Append("[['");
        for (int k = 0; k < arr.GetLength(0); k++)
        {
            for (int l = 0; l < arr.GetLength(1); l++)
            {
                if (arr[k, l] == null)
                    str.Append("','");
                else
                    str.Append(arr[k, l].ToString() + "','");
            }
            str.Remove(str.Length - 2, 2);
            str.Append("],['");
        }
        str.Remove(str.Length - 4, 4);
        str.Append("]]");
        return str.ToString();
    } 
```

在后面的代码中具有以下属性：

```
private string[,] upperLabels ;
    public string UpperLabel
    {
        get
        { return Utils.ArrayToString2D(upperLabels); }
    } 
```

在 javascript 中使用以下内容：

```
var upperSplitted = <%=UpperLabel%> ;
var value = upperSplitted[0][0]; 
```

# android - android原生代码安全

> ID：11908755
> 
> 赞同：3
> 
> 时间：2012-08-10T20:23:24.013
> 
> 标签：android, security, permissions, native

Android 如何对原生代码进行安全检查？假设我们在 AndroidManifest.xml 中声明了权限 X，这是否意味着我们在本机代码中继承了相同的权限 X？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:18:10.253

> Android 如何执行安全检查？

基本上有两种强制执行权限的方式。

*   首先在内核级别：每个已安装的应用程序都分配有一个唯一的（linux）用户 ID，每次启动您的应用程序时，Android 都会生成一个进程并将该进程的用户 ID 设置为您的应用程序用户 ID。现在访问例如文件系统或某些硬件功能（如网络）是通过使用标准的 linux 组权限系统来强制执行的。例如，仅允许网络组访问网络，如果您在清单中请求网络权限，您的应用用户就是该组的一部分。

*   用户空间中的安全性，例如访问某些`ContentProvider`s 或发送广播消息等，根本无法中继到操作系统。因此，一旦您从 Java 或本机代码调用方法，您就可以（非常）确定最终有一些软件检查，以确保您不能做您没有权限的事情。NDK API 很可能会简单地调用（可能是间接地）一些 Java 方法，因此可能不需要对本机代码和 Java 代码进行单独检查（但我知道这是如何完成的）。

您很可能可以通过使用本机代码来规避一些 Java 检查，例如 UI 线程上的网络应该可以工作（如果您有网络权限）。也有可能存在只能通过使用本机代码来利用的漏洞，但应该很少见。到底你使用什么类型的代码并不重要。

@user827992

> NDK 只是为 dalvik 生成一些经过消化的机器代码，在 C/C++ for Android 中没有可用的 API；对于使用需要特定权限的特定 API 集，您没有问题，因为您甚至根本无法编写代码并首先访问 API。

不正确，用 C/C++ 编写的本机代码在应用程序的编译时以 CPU 的本机机器代码编译，并在运行时由 CPU 直接执行，不涉及 dalvik。如果你通过 JNI（通过 NDK API）调用一些 Java 方法，你会回到 dalvik。NDK 还提供了很多 Android API，这就是它存在的原因。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-10T20:36:10.630

根据“Android逻辑”，至少有两个原因没有必要这样做：

*   你总是需要编写一些java代码来制作你的应用程序，所以你的入口点总是java语言和你的java应用程序；你不能只用 C/C++ 代码做一个 apk。
*   NDK 只是为 dalvik 生成一些经过消化的机器代码，在 C/C++ for Android 中没有可用的 API；对于使用需要特定权限的特定 API 集，您没有问题，因为您甚至根本无法编写代码并首先访问 API。

最后，只需将 android 视为一个 java 应用程序，您可以在其中使用 C/C++ 编写您自己的业务逻辑来处理繁重的计算内容，Google 在 API 和策略方面为您提供的所有内容都应该只与 Java 相关语。

# java - Java 方法重载错误

> ID：11908758
> 
> 赞同：1
> 
> 时间：2012-08-10T20:23:28.460
> 
> 标签：java, jakarta-ee

我有这个 getResult() 输入参数略有变化。one Mapvalue 作为字符串数组 one 和字符串 anor 。

但我看到一个错误：不会重载支持泛型？

```
public class App 
{

public void getResult(Map<String, String[]> map) {

}
public void getResult(Map<String, String> map) {

} 
```

}

我看到这个错误：方法 getResult(Map) 具有与 App 类型中的另一个方法相同的擦除 getResult(Map) 我猜 java 将两者都视为 Maps，这个错误也是如此。

模仿这种行为的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:26:09.367

*重载的规则之一是具有类型参数的方法在擦除后*不能具有相同的签名。请参阅[Java 语言规范，第 8.4.8.3 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.8.3)。规范中的相关文本是：

> 如果类型声明 T 具有成员方法 m [1]并且存在在 T 中声明的方法 m [2]或 T 的超类型，则这是编译时错误：. . m [1]或某些方法 m [1覆盖（直接或间接）的签名与 m] [2]或某些方法 m [2]覆盖（直接或间接）的签名具有相同的擦除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T20:26:26.637

方法参数只考虑对象的类型，而不考虑对象上的任何泛型。因此，无论它们的泛型类型如何，具有 Map 参数的两个方法都将被视为相同。

# vba - 更改数据透视表上的页面过滤器

> ID：11908759
> 
> 赞同：1
> 
> 时间：2012-08-10T20:23:33.873
> 
> 标签：vba, excel, excel-2007, pivot-table

如果我不能这样做，我可能会使用多个数据透视表，但我还是想尝试一下。

基本上，我有一张包含大量行（45k+）的工作表，我想使用数据透视表将项目组合在一起，以便我只能获得唯一性，然后在 Access 数据库中匹配它们并仅添加新项目。我必须对几列执行此操作，因此我认为使用 VBA 过滤表可能是一个很好的解决方案，尽管我无法实现它。从 MSDN 我了解到可以使用 PivotFields.Add 添加过滤器，尽管我收到错误“参数或不正确的过程调用”（或类似的东西）。这是我尝试过的：

```
Me.PivotTables("tcd_transits").PivotFields("NOTE").ClearAllFilters
Me.PivotTables("tcd_transits").PivotFields("NOTE").PivotFilters.Add _
                xlValueEquals, "NOTE", "RUBRIQUES" 
```

第一行有效地清除了过滤器，但第二行没有在“注意”上为“RUBRIQUES”添加过滤器并抛出我上面提到的错误。我是完全偏离了这里的道路还是我错过了一个细节？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:28:19.007

在这里找到它：

[http://excel.bigresource.com/Track/excel-0anuDfeJ/](http://excel.bigresource.com/Track/excel-0anuDfeJ/)

解决方案是使用`PivotFields.CurrentPage`

```
 Me.PivotTables("tcd_transits").PivotFields("NOTE").CurrentPage = "TRANSITS" 
```

# c# - 当我使用 jQuery 模型加载一个 aspx 页面时，我无法使用该 aspx 页面的服务器端方法

> ID：11908762
> 
> 赞同：0
> 
> 时间：2012-08-10T20:24:12.530
> 
> 标签：c#, jquery, asp.net, modal-dialog, popupwindow

当我使用下面的代码使用 jQuery 模型将 aspx 页面加载到弹出窗口时。

```
function OpenExceptions() {
$('#Equipmentdialog').load('Popups/Test1.aspx', function () {
   $(this).dialog({
        modal: true,
        width: 900,
        height: 400
    });
}); 
```

}

我无法在 Test1.Aspx 方法中调用任何服务器端方法（C# 按钮单击），当我调用服务器端事件时，我得到资源未找到异常？

有人可以解释一下是什么原因吗？

谢谢

更新：这是我得到的错误

![在此处输入图像描述](../Images/2e5316226ce1f2ec7af16cbd1ca7dd0d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T02:48:36.877

我查看了您的示例项目，您遇到的问题很容易解释，但恐怕它不会那么简单。

首先，我将解释导致异常的原因。

当对话框加载时，它将其内容设置为页面生成的任何输出`Test.aspx`。由于页面在您导航到它时会生成此 HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head><title>

</title></head>
<body>
    <form name="form1" method="post" action="Test.aspx" id="form1">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKMTI2NTY4ODI3MWRkmRTYlsUe3rVbAI2jDoNeA5EPuo8=" />
</div>

<div>

    <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWAgKd2MeEBAKM54rGBl+Fr2fdw6uP6072WYTIw/gz9N5E" />
</div>
    <div>
        <span id="Label1">Label</span>
        <br />
        <br />
        <input type="submit" name="Button1" value="Button" id="Button1" />

    </div>
    </form>
</body>
</html> 
```

对话框最终显示一个表单，其操作设置为`Test.aspx`; 因此，当您单击`Button`对话框上的 时，它会尝试将表单回发到`Test.aspx`但它没有找到它，因为此页面在里面`Popups/Test.aspx`。现在，为了“修复它”（我在引号中这么说是因为它不会真正修复任何东西），您可以通过蛮力更改对话框的 HTML；做这样的事情：

```
function OpenExceptions() {
            $('#Equipmentdialog').load('Popups/Test.aspx #form1', function (response, status, xhr) {
                response = response.replace('action="Test.aspx"', 'action="Popups/Test.aspx"'); //Make sure the form's action is accurate
                $(this).html(response);
                $(this).dialog({
                    modal: true,
                    width: 900,
                    height: 400
                });
            });
        } 
```

现在，当您单击 时，`Button`您将不再收到`Resource Not Found Exception`; 但是，由于这会导致正常回**发，对话框将消失**，按钮将回发页面，页面上的标签将显示当前日期和时间。

同样，这一切都发生了，因为您正在执行正常的回发而不是 Ajax 请求。`Button`如果页面中的`Test.aspx`执行 Ajax 请求但不是您使用更新面板和脚本管理器时获得的那种请求，我的上述方法将起作用。由于它们在内部工作的方式，您将无法使用这些工具......

如果您希望在您的应用程序中使用 Ajax，我建议您将 WCF Web 服务与 JQuery 结合使用。网上有很多关于这个主题的好教程。

我希望我的回答至少可以帮助您理解为什么这对您不起作用，以及如果您继续使用这种方法，为什么它不会起作用。您可以应用许多技巧来使其正常工作，但我想不出一个可以易于维护和扩展的单一方法。最好的方法是使用 WCF Web 服务（或页面方法）和 JQuery 正确地执行 Ajax。

# android - 我需要设置我的 android 应用程序的活动来读取我想要制作的自定义文件类型。如何？

> ID：11908764
> 
> 赞同：0
> 
> 时间：2012-08-10T20:24:15.267
> 
> 标签：android

首先，我需要创建一个名为 .apw 的文件类型，以便让 mmy 公司知道我发送的所有文本文件都将以这种类型发送。

另外，我需要让我的 android 应用程序的活动能够读取这个文件。我所做的只是设置了 Android Manifest 活动。我需要知道要添加或更改什么以及如何设置布局 xml 和 java 类文件。

它不会让我把它放在我的代码中，所以我将提供详细信息，活动是 .APWF，标题名称是查看 .APW 文件，我将其设置为仅纵向模式

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:44:39.647

如果您正在寻找一些文件管理，这肯定会很方便：

```
package utils;

import java.io.*;
import java.nio.ByteBuffer;
import java.util.Arrays;

public class Files {

private static final String file_name = "descrambler_wordlist.txt";

public static byte[][] dictionary;
private static int dic_words = 0;
public final static int WORDS_NO = 234204;

private static ByteBuffer currentlyParsingB;

public static void parseDictionary()
{
    FileInputStream fis;
    File file = new File(file_name);
    int len = 1024 * 512; //512KB
    currentlyParsingB = ByteBuffer.allocate(24);

    //currentlyParsing = new byte[24];
    dictionary = new byte[WORDS_NO][];

    try {
        fis = new FileInputStream(file);
    } catch (FileNotFoundException e1) {
        fis = null;
        e1.printStackTrace();
    }
    byte[] b = new byte[len];
    int bread;

    try {
        fis = new FileInputStream(file);

        while((bread = fis.read(b, 0, len))!=-1)
            parseBlock(b, bread);

        fis.close();

    } catch (IOException e) {
        e.printStackTrace();
    }
}

private static void parseBlock(byte[] b, int l)
{
    byte b1;

    for(int j=0; j<l; j++)
    {
        b1 = b[j];

        if(b1==10)
        {
            dictionary[dic_words] = Arrays.copyOf(currentlyParsingB.array(), currentlyParsingB.position());
            currentlyParsingB.clear();
            //word_pos = 0;
            dic_words++;
        }
        else
        {
            currentlyParsingB.put(b1);
            //currentlyParsing[word_pos] = b1;
            //word_pos++;
        }
    }
}
} 
```

这是来自字典解析器的旧代码。那里有额外的东西，但我想你可以很容易地找到你需要的东西。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:38:13.810

您可能正在寻找意图过滤器。

这个问题应该会有所帮助：[特定文件扩展名的 Android 意图过滤器？](https://stackoverflow.com/questions/1733195/android-intent-filter-for-a-particular-file-extension)

# .net - stream.Take(16) <-- 制作 16 字节的数组？

> ID：11908765
> 
> 赞同：0
> 
> 时间：2012-08-10T20:24:20.393
> 
> 标签：.net, stream

我觉得问得很傻，但是...

使用 C#/.NET 我有一个流，我编写了自己的扩展函数来读取短（或内置字节）。

我可以使用什么东西来创建一个 X 长度的数组（在我的示例中为 16）并返回一个字节数组？否则抛出异常？ReadByte 是这样做的，并且是内置的。在 .NET 框架中应该有类似我所要求的内容

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:29:25.360

> 我可以使用什么东西来创建一个 X 长度的数组（在我的示例中为 16）并返回一个字节数组？

对于字节数据，您只需调用[Stream.Read](http://msdn.microsoft.com/en-us/library/system.io.stream.read.aspx)：

```
byte[] values = new byte[16];
int read = theStream.Read(values, 0, 16);
// Make sure you read all 16... 
```

或者，您可以使用[BinaryReader.ReadBytes](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.readbytes.aspx)：

```
byte[] values = theStream.ReadBytes(16); 
```

如果你想处理短数据，我会为[BinaryReader](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.aspx)创建一个扩展方法：

```
public static short[] ReadInt16Array(this BinaryReader reader, int elementsToRead)
{
     short[] results = new short[elementsToRead];
     for (int i=0;i<elementsToRead;++i)
        results[i] = reader.ReadInt16();
     return results;
} 
```

# php - 从脚本插入事件到谷歌日历

> ID：11908768
> 
> 赞同：0
> 
> 时间：2012-08-10T20:24:36.683
> 
> 标签：php, oauth-2.0, google-calendar-api

任何人都知道在不依赖当前登录用户的情况下直接验证和发布到日历的正确方法吗？几周前，我构建了一个使用标准 Oauth 2.0 协议的日历，但这依赖于用户浏览器存储的会话。我有一个日历，我想将事件传递给我正在使用基本 PHP 框架编写的应用程序。我更关心其他人正在使用的最佳实践。你的答案可能很简单，不要这样做。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:08:18.380

使用 OAuth 2 和授权代码流（Web 服务器流），并启用离线。存储刷新令牌（无限期地持续到用户撤销），即使用户当前未登录，您也可以将事件上传到 Google 日历。

更多信息： [https ://developers.google.com/accounts/docs/OAuth2WebServer#offline](https://developers.google.com/accounts/docs/OAuth2WebServer#offline)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:34:56.693

使用这个库尝试 Zend_Gdata_Calendar，您可以从谷歌日历中插入或获取来自任何用户（显然使用正确的用户名和密码）的事件，并与您自己的日历集成或显示它..这里有一个简短的例子：

```
 $service = Zend_Gdata_Calendar::AUTH_SERVICE_NAME;
    $client = Zend_Gdata_ClientLogin::getHttpClient('gmail@user.com',    'gmailpassword', $service);
    $service = new Zend_Gdata_Calendar($client);

    $query = $service->newEventQuery();
    $query->setUser('default');
    $query->setVisibility('private');

    try {
         $eventFeed = $service->getCalendarEventFeed($query);
    } catch (Zend_Gdata_App_Exception $e) {
        echo "Error: " . $e->getMessage();
    }

    echo "<ul>";
    foreach ($eventFeed as $event) {
     echo "<li>" . $event->title . " (Event ID: " . $event->id . ")</li>";

    }
    echo "</ul>";

    $eventURL = "http://www.google.com/calendar/feeds/default/private/full/Dir0FthEpUbl1cGma1lCalendAr";

    try {
        $event = $service->getCalendarEventEntry($eventURL);

        echo 'Evento: ' . $event->getTitle() .'<br>';
        echo 'detalles: ' . $event->getContent().'<br>';
        foreach ($event->getWhen() as $dato)
        {
            echo 'inicia: ' . substr($dato->startTime, 0,-19) . ' a las: ' . substr($dato->startTime, 11,-10) .'<br>';
            echo 'termina: ' .substr($dato->endTime,0,-19) . ' a las: ' . substr($dato->endTime,11,-10) .'<br>';

        }  

    } catch (Zend_Gdata_App_Exception $e) {
        echo "Error: " . $e->getMessage();
    } 
```

有了这个，您可以添加、更新、编辑或删除日历表单中的事件，任何用户都有邮件和密码......

# .net - WCF 数据服务和 OData 中的派生实体类型

> ID：11908769
> 
> 赞同：1
> 
> 时间：2012-08-10T20:24:42.783
> 
> 标签：.net, wcf, wcf-data-services, odata

我第一次检查 WCF 数据服务和 OData，我想知道在实体模型中使用继承是否是不好的做法？它似乎没有得到很好的支持。

例如，我遇到了 OData 问题，我想过滤派生类型的属性。但似乎只能过滤基本类型的属性？

这失败了：http://[localhost]:8080/Entities?$filter=startswith(Text,'bla')

无论如何，创建非派生实体类型并具有接口以“协调”不同实体类型中的属性是否更好？

例如：

EntityBase -> Id, ParentId

笔记本：EntityBase -> 标题

注意：EntityBase -> 文本

或者

IEntity -> Id, ParentId

笔记本：IEntity -> Id、ParentId、Title

注意：IEntity -> Id、ParentId、Text

* * *

为什么 5.1.0-rc1 仍然不支持 $format-tag？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T07:25:41.697

$format 将很快得到支持。由于意识形态原因和有简单的解决方法，这一直是较低优先级。在此之前，您可以使用Pablo 在博客中提到的[JSONP 属性。](http://blogs.msdn.com/b/pablo/archive/2009/02/25/adding-support-for-jsonp-and-url-controlled-format-to-ado-net-data-services.aspx)无论如何，在接下来的几个月中，您应该会看到我们的堆栈支持 URL 中的 $format。

至于派生类型，据我所知，大多数操作*应该可以正常工作。*要过滤派生类型的属性，您需要先转换为该类型。例如，在我的 Scratch 服务中，我有以下类：

```
namespace Scratch.Web
{
    public abstract class Product
    {
        public int ID { get; set; }
        public string Name { get; set; }
        public Product RelatedProduct { get; set; }
    }

    public class DiscountedProduct : Product
    {
        public double Discount { get; set; }
        public ICollection<Category> Categories { get; set; }
    }

    // ...
} 
```

这使我能够发出如下查询（这将获得折扣大于 10 的所有打折产品）：

```
http://localhost:59803/ScratchService.svc/Products/Scratch.Web.DiscountedProduct?$filter=Discount gt 10.0 
```

在 URL 中，注意转换为我要过滤的类型（使用完全限定的实体类型名称）。

# java - 合金 API 导致 java.lang.UnsatisfiedLinkError

> ID：11908773
> 
> 赞同：1
> 
> 时间：2012-08-10T20:24:58.993
> 
> 标签：java, api, alloy

我目前正在使用 Alloy Analyzer API 来构建程序，并获得了一些特殊的行为。具体来说，如果我打开一个文件并解析它（使用 CompUtil.parseEverything），然后创建一个新命令并在解析的文件上调用 TranslateAlloyToKodkod.execute_command，并使用带有 UNSAT 核心的 MiniSat 新创建的命令，它运行良好。但是，稍后在执行中，我的程序解析第二个输入文件（也使用 CompUtil.parseEverything），获取另一个世界，发出一个新命令，然后我尝试再次调用 TranslateAlloyToKodkod.execute_command，它会引发以下错误：

`ERROR: class edu.mit.csail.sdg.alloy4.ErrorFatal: The required JNI library cannot be found: java.lang.UnsatisfiedLinkError: no minisatproverx5 in java.library.path edu.mit.csail.sdg.alloy4compiler.translator.TranslateAlloyToKodkod.execute_command(TranslateAlloyToKodkod.java:390)`

有谁知道为什么这是第二次抛出，但不是第一次？

总而言之，我有类似以下内容：

```
Module someWorld = CompUtil.parseEverything_fromFile(rep, null, "someFile.als");
//For the following, "sig" is a sig in someWorld.getAllReachableSigs();
Command command = sig.not();
A4Options options = new A4Options();
options.solver = A4Options.SatSolver.MiniSatProverJNI;
A4Solution ans = 
    TranslateAlloyToKodkod.execute_command(rep, someWorld, command, options);
//No thrown error
Module someOtherWorld = CompUtil.parseEverything_fromFile(rep, null, "someOtherFile.als");
//For the following, "sig" is a sig in someOtherWorld.getAllReachableSigs();
Command commandTwo = sig.not();
A4Solution ansTwo = 
    TranslateAlloyToKodkod.execute_command(rep, someOtherWorld, commandTwo, options);
//Thrown error above. Why? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-11T01:37:30.133

我试图重现这种行为，但我不能。如果我不将 MiniSat 二进制文件添加到 LD_LIBRARY_PATH 环境变量中，我会在我第一次调用`execute_command`. 配置 LD_LIBRARY_PATH 后，异常不会发生。

要配置 LD_LIBRARY_PATH：

(1) 如果使用 Eclipse，您可以右键单击其中一个源文件夹，选择 Build Path -> Configure Build Path，然后在“Source”选项卡上确保“Native library location”指向 MiniSat 所在的文件夹二进制文件驻留。

(2) 如果从 shell 运行，只需将带有 MiniSat 二进制文件的文件夹的路径添加到 LD_LIBRARY_PATH，例如`export LD_LIBRARY_PATH=alloy/extra/x86-linux:$LD_LIBRARY_PATH`.

这是我正在运行的确切代码，一切正常

```
public static void main(String[] args) throws Exception {
    A4Reporter rep = new A4Reporter();

    A4Options options = new A4Options();
    options.solver = A4Options.SatSolver.MiniSatProverJNI;

    Module someWorld = CompUtil.parseEverything_fromFile(rep, null, "someFile.als");
    Command command = someWorld.getAllCommands().get(0);
    A4Solution ans = TranslateAlloyToKodkod.execute_command(rep, someWorld.getAllReachableSigs(), command, options);
    System.out.println(ans);

    Module someOtherWorld = CompUtil.parseEverything_fromFile(rep, null, "someOtherFile.als");
    Command commandTwo = someOtherWorld.getAllCommands().get(0);
    A4Solution ansTwo = TranslateAlloyToKodkod.execute_command(rep, someOtherWorld.getAllReachableSigs(), commandTwo, options);
    System.out.println(ansTwo);
} 
```

“someFile.als”是

```
sig A {}
run { some A } for 4 
```

和“someOtherFile.als”

```
sig A {}
run { no A } for 4 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-06T17:54:52.107

I use alloy4.2.jar as a library in my eclipse plugin project.

```
A4Reporter rep = new A4Reporter();
Module world = CompUtil.parseEverything_fromFile(rep, null, "civi.als");
A4Options options = new A4Options();
options.solver = A4Options.SatSolver.SAT4J;
options.skolemDepth = 1; 
```

When I use SAT4J, the default solver, the problem mentioned here will not show up. But another exception comes out. The reason is that my civi.als file need Integer model, which located in alloy4.2.jar under the folder /models/util/. But when I run the application, it tries to find the file util/Integer.als directly. That causes the exception. Is it possible to fix that problem?

Besides, I also tried to put the alloy4.2.jar in eclipse plugin project and run my application as an eclipse application (running my application as a plugin). With the default solver, the application has no problem at all. But when I switch to MiniSatProverJNI, the problem mentioned here comes out (I have set the alloy4.2.jar as classpath).

# c# - 如果我知道背景颜色，如何创建图像的轮廓？

> ID：11908775
> 
> 赞同：6
> 
> 时间：2012-08-10T20:25:12.653
> 
> 标签：c#, algorithm, image-processing, bitmap, outline

我想创建一个简单的程序，您可以打开任何给定的图像并选择 2 种颜色：`BackgroundColor`和`OutlineColor`. 然后在“对象”周围画一个轮廓。

到目前为止，这是我的代码：

```
 for (int y = 1; y < height - 1; y++) //iterate trough every pixel 
        {                                    //in my bitmap
            for (int x = 1; x < width - 1; x++)
            {
                //i want to put a pixel only if the the curent pixel is background
                if (bitmap.GetPixel(x, y) != BackgroundColor)
                    continue;

                var right = bitmap.GetPixel(x + 1, y);
                var down = bitmap.GetPixel(x, y + 1);
                var up = bitmap.GetPixel(x, y - 1);
                var left = bitmap.GetPixel(x - 1, y);
                //get the nearby pixels
                var neibours = new List<Color> {up, down, left, right};

                var nonBackgroundPix = 0;
                //then count how many are not outline nor background color
                foreach (Color neibour in neibours)
                {
                    if (neibour != BackgroundColor && neibour != OutlineColor)
                    {
                        nonBackgroundPix++;
                    }
                }
                //finaly put an outline pixel only if there are 1,2 or 3 non bg pixels
                if (nonBackgroundPix > 0 && nonBackgroundPix < 4)
                {
                    bitmap.SetPixel(x, y, OutlineColor);
                }
            }
        } 
```

当我运行我的代码并输入 ![前](../Images/db6ffe64fd8a54e37b60647d92a6c67c.png) 我得到 的时，问题就来了![后](../Images/c4d1d05f08f6a5650a3c779ff19cf660.png)

而我想要的是 ![想](../Images/fd5e6ffd95d96d348159b2dd0c497fd3.png)

如果您在我的代码中发现问题，请知道更好的算法来执行此操作或以某种方式设法做到这一点，请告诉我。提前谢谢各位！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:40:50.197

### 问题：

您正在将背景颜色更改为非背景颜色，然后由后续像素检查拾取。

### 解决方案：

我建议存储一个带有像素“稍后更改”的新数组，然后在映射完整图像后返回并设置它们。（此外，您可以立即更改它，然后将标志添加到您可以检查的像素，但这是您需要实现的更多逻辑，例如检查布尔数组）

# linux - Shell 脚本：“local foo”和“local foo=”之间有区别吗？

> ID：11908776
> 
> 赞同：3
> 
> 时间：2012-08-10T20:25:14.000
> 
> 标签：linux, shell, centos

我在 CentOS 上的 /etc/init.d/functions 中找到了以下代码。

```
status() {
    local base pid lock_file= pid_file=
    ... 
```

声明了 4 个变量。其中两个未初始化，base 和 pid。但其余的都是用空值、lock_file 和 pid_file 初始化的。

我测试了以下代码，没有发现任何差异。

```
local a b=

echo "a is $a, length is ${#a}"
echo "b is $b, length is ${#b}" 
```

它们之间有什么区别吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-12T23:35:28.877

是的，有*区别*。考虑以下函数：

```
x() {
    local a b=

    echo ${a-X}
    echo ${b-X}
} 
```

调用此函数会`bash-4.x`产生以下输出：

```
$ x
X

$ 
```

如果未设置参数，则`${parameter−word}` [参数扩展](http://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html)扩展为`word`（在这种情况下`X`）的扩展，或者如果设置了参数值，则扩展为参数值。

从示例输出中，很明显`local a`未设置变量`a`，而`local b=`将其显式设置为空 (null) 字符串。

**编辑：**

另一方面，`bash-3.x`你得到这个：

```
$ x

$ 
```

对函数内的调用`set`验证`local a`in`bash-3.x`将该变量初始化为空字符串。然而，这似乎是一个错误。从`bash`变更日志：

> 本文档详细介绍了此版本 bash-4.0-beta 与先前版本 bash-4.0-alpha 之间的更改。
> 
> ...
> 
> e. 修复了导致局部变量使用空字符串创建值而不是没有值的错误。

# django - Django：如何在单元测试中隐藏 Traceback 以提高可读性？

> ID：11908784
> 
> 赞同：5
> 
> 时间：2012-08-10T20:26:16.920
> 
> 标签：django, unit-testing

我发现为一个简单的失败的单元测试获取如此多的细节有点烦人。除了实际定义的断言消息之外，是否可以抑制所有内容？

```
Creating test database for alias 'default'...
.F
======================================================================
FAIL: test_get_sales_item_for_company (my_app.tests.SalesItemModelTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/home/kave/projects/my/my_app/tests.py", line 61, in test_get_sales_item_for_company
    self.assertEqual(sales_items.count(), 1, 'Expected one sales item for this company, but got %s' % sales_items.count())
AssertionError: Expected one sales item for this company, but got 2

----------------------------------------------------------------------
Ran 2 tests in 0.313s

FAILED (failures=1)
Destroying test database for alias 'default'... 
```

我觉得这有点不必要。我需要知道失败的测试名称（方法）和断言消息。真的不需要回溯..

```
Traceback (most recent call last):
  File "/home/kave/projects/my/my_app/tests.py", line 61, in test_get_sales_item_for_company
    self.assertEqual(sales_items.count(), 1, 'Expected one sales item for this company, but got %s' % sales_items.count()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T23:08:28.630

猴子修补救援。您可以通过子类化 Django 的 TestCase 来摆脱失败的回溯，而无需触及 Django 安装，如下所示：

```
import types
from django.utils.unittest.result import failfast
from django.test import TestCase

@failfast
def addFailureSansTraceback(self, test, err):
    err_sans_tb = (err[0], err[1], None)
    self.failures.append((test, self._exc_info_to_string(err_sans_tb, test)))
    self._mirrorOutput = True

class NoTraceTestCase(TestCase):
    def run(self, result=None):
        result.addFailure = types.MethodType(addFailureSansTraceback, result)
        super(NoTraceTestCase, self).run(result) 
```

现在只需将您的测试用例作为`NoTraceTestCase`替代的子类，`TestCase`您就可以开始了。没有更多的失败追溯。（请注意，异常仍会打印回溯。如果您愿意，您可以类似地修补这些。）

以下是它的工作原理（感谢[Jason Pratt 关于猴子修补的快速课程](https://stackoverflow.com/questions/972/adding-a-method-to-an-existing-object)）：

1.  Django 的测试运行程序为每个测试运行调用 TestCase 的`run`方法。该`result`参数是`django.utils.unittest.result.TestResult`类的一个实例，它处理向用户显示测试结果。每当测试失败时，`run`进行以下调用：`result.addFailure(self, sys.exc_info())`. 这就是回溯的来源——作为返回的元组中的第三项`sys.exc_info()`。

2.  `run`现在，只需用原始代码的副本覆盖并根据需要对其进行调整即可。但是这个`run`方法有 75 行长，需要改变的只是那一行，无论如何，为什么要错过猴子修补的乐趣呢？

3.  该`result.addFailure`赋值将传递给 NoTraceTestCase 方法`addFailure`的`result`对象中的`run`方法更改为新定义的`addFailureSansTraceback`函数——该函数首先转换为`result`与`types.MethodType`.

4.  该`super`调用调用 Django 现有的 TestCase `run`。现在，当现有代码运行时，调用`addFailure`实际上将调用新版本，即`addFailureSansTraceback`.

5.  `addFailureSansTraceback`执行原始版本的`addFailure`操作——复制两行代码——除了添加一行替换回溯`None`（使用的赋值`err_sans_tb`而不是`err`下一行）。就是这样。

6.  注意原来`addFailure`有一个`failfast`装饰器，所以是导入和使用的。老实说，我没有看过它的作用！

免责声明：我没有彻底研究过 Django 的测试代码。这只是让它在常见情况下工作的快速补丁。使用风险自负！

# facebook - Facebook 测试用户数量的上限异常低

> ID：11908785
> 
> 赞同：-1
> 
> 时间：2012-08-10T20:26:18.230
> 
> 标签：facebook, testing

我正在尝试使用 facebook 开发人员应用程序中的“角色”选项卡设置测试用户，但它限制了我可以添加的测试用户数量为 6，即使这个[http://developers.facebook.com/docs/test_users /](http://developers.facebook.com/docs/test_users/)链接说最多可以加500！当我尝试通过在下拉菜单上选择 10 来添加更多内容时，它似乎正在做一些处理，但是当它完成时没有添加任何内容。

有谁知道我为什么被限制在这个数字上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T00:43:41.470

Facebook 用于创建和管理测试用户的界面简直就是地狱。[获取免费的 FacebookTestUserManager](http://fbtum.codeplex.com/)（仅限 Windows）并免去您的麻烦。它比 Facebook 的网络界面少错误。

如果你在 Mac 上，谷歌周围还有其他独立的测试用户管理器。

# javascript - JS中使用canvas对重力的小模拟

> ID：11908786
> 
> 赞同：4
> 
> 时间：2012-08-10T20:26:25.373
> 
> 标签：javascript, simulation

所以，我正在尝试创建几个圆圈，然后我希望它们掉下来。下面是代码和演示：[demo](http://jsfiddle.net/fGChQ/) FireBug 告诉我没有为未定义的对象定义方法“move”，所以当我想创建一个对象数组时一定有问题。纠正我的错误并考虑到我刚刚开始学习 JS 中的面向对象编程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T21:07:00.943

与其创建多个事件，不如创建一个事件并在其中循环：

```
 setInterval(function(){
    ctx.clearRect(0,0,1000,1000);  //Clear the canvas here
    for (i = 0;i<bubble.length;++i)
    {
      bubble[i].move();
      bubble[i].redraw();
    }
  },32); 
```

问题是范围问题。您编写它的方式`i`在它们执行的所有事件中的值为 10。

工作小提琴：http: [//jsfiddle.net/some/fGChQ/16/](http://jsfiddle.net/some/fGChQ/16/)

您的另一个问题是您在重绘中清除了画布......对于每个圆圈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:17:50.943

我已经对此进行了[分叉](http://jsfiddle.net/zrHuC/1/)，以解决循环问题，清除画布矩形似乎也存在问题，导致了一些干扰

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-10T20:56:38.967

```
for (i = 0;i<bubble.length - 1; ++i)
{
    console.log(bubble[i].y)
    setInterval(function(){
        bubble[i].move();
        bubble[i].redraw();
    },32);
} 
```

bubble.length 为 10，数组索引为 0-9。bubble[10] 未定义，因此您不能在其上调用方法 move 。

# bash - 计算目录的内容

> ID：11908791
> 
> 赞同：1
> 
> 时间：2012-08-10T20:27:38.260
> 
> 标签：bash, shell, unix

所以我知道如何计算目录中的文件数 - 我会使用`for filename in *`循环然后测试文件名以符合我的目的，但是我无法弄清楚如何遍历目录然后计算如何许多（子）目录都在其中。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:34:10.077

您可以使用`-d`.

您可以使用查找：`find . -mindepth 1 -maxdepth 1 -type d`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:50:24.603

```
((n=0))
for fn in *
do
   [[ -d "${fn}" ]] && ((n=1+${n}))
done 
```

保留一个计数器，只为目录增加它......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T21:03:06.513

你想做什么？看一下`wc`命令。具体来说`wc -l`，它计算输出中的行数。您可以使用一整套生成输出的命令，然后将其通过管道传输到`wc -l`. 注意向文件添加页眉和页脚的命令（如`ls -l`）。

这里有些例子：

这将计算所有不以开头的文件和目录`.`：

```
$ ls | wc -l 
```

这与您在问题中的 for 循环相同。

这将计算所有文件和目录，包括那些*隐藏*的文件和目录。请注意，`ls -A`而不是`ls -a`. 第一个不会列出`.`并`..`作为文件，而第二个将：

```
$ ls -A | wc -l 
```

这将计算整个目录树中的所有文件和目录

```
$ find . | wc -l 
```

这只会计算整个目录树中的目录

```
$ find . -type d| wc -l 
```

这将计算整个目录树中的所有文件

```
$ find . -type f | wc -l 
```

ls - 这将限制您当前目录中的目录数量

```
$ find . -mindepth 1 -maxdepth 1 -type d | wc -l 
```

而且，您可以使用它来将其分配给变量：

```
$ num_of_files=$(find . -type f | wc -l) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T21:11:24.913

这是计算目录或使用目录名称做事的方法。

```
#!/bin/bash

old_IFS=$IFS
IFS=$'\n' 
array=($(ls -F /foo/bar/ | grep '/$')) # this creates an array named "array" that holds
IFS=$old_IFS                           # all the directory names located in /foo/bar/

echo ${#array[@]} # this will give you the number of directories in /foo/bar/

for ((i=0; i<${#array[@]}; i++))
do
echo ${array[$i]} # this will output a list of all the directories
done 
```

或者你可以：

```
ls -F /foo/bar/ | grep '/$' | cat > directorynames.txt 
```

and then count the number of lines. or you could get rid of the cat and just put the above in a for loop that would count up for every newline character.

# php - 为什么在 AJAX 请求中显示在页面上单击的先前链接的文本？

> ID：11908793
> 
> 赞同：1
> 
> 时间：2012-08-10T20:27:40.647
> 
> 标签：php, javascript, jquery, html, ajax

这是一个引导模式，我将 AJAX 请求的结果放入

```
<div class="modal hide" id="myModal">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">×</button>
    <h3>Modal header</h3>
  </div>
  <div id="modal-body"></div>
  <div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal">Close</a>
  </div>
</div> 
```

javascript代码看起来像这样

```
<script type="text/javascript">
  $('#myModal').modal('hide');
  $('div.divBox a').click(function(){
    var vendor = $(this).text();
    console.log(vendor);
    $('#myModal').on('show', function(){          
      $.ajax({
        type: "GET",
        url: "ip.php",
        data: "id=" + vendor,
        success: function(html){
          $("#modal-body").html(html);              
        }
      });           
    });
  });
  $('#myModal').on('hide', function () {
    $("#modal-body").empty();
    <?php unset($_GET); ?>;
  })
</script> 
```

ip.php**文件**是

锚链接代码如下所示

```
 <tbody>
              <?php foreach ($rowarr as $k => $v) { ?>
                <tr>
                  <td><?php echo $k ?></td>
                  <td>
                    <div class="divBox">
                      <a data-toggle="modal" href="#myModal"><?php echo $v; ?></a>
                    </div>
                  </td>
                </tr>
              <?php } ?>
            </tbody> 
```

$k 是一个数字。$v 是一个包含空格和特殊字符的名称。

console.log(vendor) 显示了我在 CDT 中单击的链接的文本。但是模态的输出发生了变化。它遍历我之前单击的所有链接文本，并不断替换它们，最后以最新的链接文本结束。

因此，如果按此顺序单击链接，控制台输出将如下所示

```
Microsoft Corporation
IBM Corp
Hewlett-Packard
Apple 
```

模式中的文本将以

```
Array ( [id] => Microsoft Corporation ) 
```

然后替换为

```
Array ( [id] => IBM Corp ) 
```

然后替换为

```
Array ( [id] => Hewlett-Packard) 
```

然后结束

```
Array ( [id] => Apple ) 
```

什么是跟踪页面上点击的链接？每次点击新链接时都需要重置它吗？

编辑：回应“你试过什么？”

我`$("#modal-body").empty();`在那里添加了，希望它可能是我需要清除的模态体。不是这样。然后我想也许 GET 变量需要在关闭模式时重置，所以我添加了`<?php unset($_GET); ?>;`. 但是 print_r($_GET) 显示该数组仅包含一个数组元素，而不是之前单击的所有链接。所以我不知道点击链接的历史记录在哪里存储。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:49:23.047

所以基本上，每次你点击一个`divBox`链接时，它都会为`myModal`'show'事件添加一个新的处理程序。所以基本上在点击 5 个不同的`divBox`链接后，`myModal`'s show 事件将循环通过 5 个不同的处理函数。

基本上，您需要在添加新的之前删除先前添加的“显示”处理程序。

```
$('#myModal').off('show'); 
```

[在 jQuery 中删除事件处理程序的最佳方法？](https://stackoverflow.com/questions/209029/best-way-to-remove-an-event-handler-in-jquery)

# python - 布尔值在python中是可变的吗？

> ID：11908795
> 
> 赞同：3
> 
> 时间：2012-08-10T20:27:51.443
> 
> 标签：python, django, boolean

我在python中有以下代码：

```
def update(request, id):
  success = 0

  try:
    product = Mattress.objects.get(id=id)
    success = 1
  except Mattress.DoesNotExist:
    pass

  if success == 1:
    return render_to_response("success.html")
  else:
    return render_to_response('failure.html') 
```

此代码是检查“成功”布尔值的有效方法吗？如果代码通过了try语句，“success”会变为1还是保持为0？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-10T20:33:38.567

回答你的问题：

> 布尔值在python中是可变的吗？

是和不是。分配了布尔值的变量（可能总是，并且在这种情况下肯定）是可变的，是的。它们也不限于被分配布尔值，因为变量不是静态类型的。

但是布尔值`True`和`False`它们本身是不可变的。它们是无法修改的单例。

查看您的实际代码：

```
if success = 1: 
```

不是有效的语法，你想要一个`==`那里。此外，惯用语你不应该使用`0`and`1`作为成功和失败的值，你应该使用`True`and `False`。所以你应该重构为这样的东西：

```
def update(request):
    success = False

    try:
        product = Mattress.objects.get(id=id)
        success = True
    except Mattress.DoesNotExist:
        pass

    if success:
        return render_to_response("success.html")
    else:
        return render_to_response('failure.html') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:29:47.317

是的。`success`成功时将更改为 1。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T20:34:20.070

这个片段有一些问题。

1.  首先，您没有使用布尔类型。Python 的布尔值是`True`和`False`。
2.  其次，您没有在 if 语句中进行比较。该行在 Python 3 中无效。您要查找的是：`if success == 1:`或`if success == True:`
3.  无论布尔值的不变性如何，您仍然可以将布尔值分配给变量。我相信它们被存储为原始类型，因此它们与任何其他原始类型一样不可变。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T20:36:48.523

您应该考虑使用实际的布尔值而不是整数。您可以设置`success`为`true`or `false`，Python 会将它们解释为值 1 和 0 的关键字。使用数字可能有点棘手，因为某些语言解释的东西不同。在某些语言中，0 是`false`但除 0 之外的任何值都被考虑`true`。但是，您的问题的答案是肯定的，它会正常工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-10T23:16:20.590

可能您提出的问题甚至与您要解决的问题无关。我认为有一种 Pythonic 方式可以通过以下方式实现您想要的：

```
def update(request):
    try:
        product = Mattress.objects.get(id=id)
    except Mattress.DoesNotExist:
        template_name = 'failure.html'
    else:
        template_name = 'success.html'

    return render_to_response(template_name) 
```

基本上，如果抛出异常，即您将呈现的模板将是'failure.html'。另一方面，如果查询成功执行，将呈现“success.html”。

# ios - 多个 UIPickerViews - 没有 .xib

> ID：11908797
> 
> 赞同：1
> 
> 时间：2012-08-10T20:27:59.540
> 
> 标签：ios, objective-c, uiview, uipickerview

我有一个看法。我希望能够在`UIPickerView`其中放入 1-3 秒。s的数量`UIPickerView`由变量的值决定`myVariable`。每个`UIPickerView`都是不同的。的一些值`myVariable`意味着视图中只有一个`UIPickerView`，但有些值意味着我必须在视图中放置 2 或 3 个，并且它将垂直布局（因此一个`UIPickerView`直接在另一个上方）。现在，每一种情况`myVariable`意味着它只需要 1 `UIPickerView`，我将它们放在这样的视图中：

```
if (myVariable == kNeedsOnlyOnePicker)
{
    myPicker = [[UIPickerView alloc] initWithFrame:self.view.frame];
    [myPicker setDelegate:self];
    [myPicker setDataSource:self];
    myPicker.showsSelectionIndicator = YES;
    [self.view addSubview:myPicker];
} 
```

但是，我只是不确定如何告诉代码是这样的：

```
if (myVariable == kNeedsTwoPickers)
{
     // put myPicker and myOtherPicker in self.view, 
     // and put myPicker above myOtherPicker.
} 
```

我有一种预感，我将无法使用 .xib 来执行此类操作，因为我将无法设置不同的布局（例如，选择器 2 上方的选择器 1，选择器 3 上方的选择器 2，只有选择器 3 ）。

TL;DR 我如何以编程方式说“这个子视图将高于另一个子视图”或“这个选择器将高于另一个选择器”？

具体的方法/例子和/或一般的想法会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T16:13:52.193

我发现我可以为子视图设置框架并计算它的坐标。

```
- (void)layout
{
    for (int i= 0; i < [self.view.subviews count]; i++)
    {
        // calculate x, y, width, and height
        UIView *subview = [self.view.subviews objectAtIndex:i];

        subview.frame = CGRectMake(x, y, width, height);
    }
} 
```

# css - 轻松删除未使用的 css 属性

> ID：11908799
> 
> 赞同：2
> 
> 时间：2012-08-10T20:28:14.170
> 
> 标签：css, dreamweaver

由于某些原因，我使用了很多代码段，比如来自很多网站的模板、侧边栏等。因此，在我的代码中，我有许多未使用的 CSS 属性。Dreamweaver 或任何其他程序中是否有任何命令可以轻松删除未使用的 css 属性？我问这个是因为删除它们需要几个小时。图片多少钱：）谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:33:04.230

你有网站在线吗？如果是这样，你可以试试这个网站[删除未使用的 CSS](http://unused-css.com/)。

另请查看以下 SO 问题，他们提到了评论中指出的[Dust-Me 选择器](https://addons.mozilla.org/en-us/firefox/addon/dust-me-selectors/)：

*   [如何在网站中找到未使用的图像和 CSS 样式？](https://stackoverflow.com/questions/33242/how-can-i-find-unused-images-and-css-styles-in-a-website)
*   [如何识别未使用的 CSS 定义](https://stackoverflow.com/questions/135657/tool-to-identify-unused-css-definitions)

# cocoa-touch - 预期标识符错误？

> ID：11908800
> 
> 赞同：0
> 
> 时间：2012-08-10T20:28:15.763
> 
> 标签：cocoa-touch, input, identifier

嗨所以我正在尝试创建一个 if 语句......如果精灵被触摸......那么就会发生一些事情

但是，由于某种原因，我收到了预期的已识别错误，并且我一生都无法弄清楚为什么？

感谢您提供的任何帮助和知识`meKKInput* input = [KKInput sharedInput];`

```
KKInput* input = [KKInput sharedInput];

if([input isAnyTouchOnNode:kan touchPhase:[KKTouchPhaseAny]])
    {
        for ( int x = 105.0f; x < 100000 ; ++x)
        {
            for ( int y = 50.0f; y < 100000 ; ++y)
            {
                kan.position = CGPointMake((x),(y));
            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:42:47.987

`KKTouchPhaseAny`必须删除（可能是枚举）周围的方括号。

# asp.net-mvc-3 - 为什么这不加载到 https 中？

> ID：11908804
> 
> 赞同：2
> 
> 时间：2012-08-10T20:28:26.153
> 
> 标签：asp.net-mvc-3, https, requirehttps, requiressl

在 asp.net mvc 3 中，我有一个具有 ssl 证书的站点，并且在 https 中运行得很好。唯一暴露的页面是登录页面。无论出于何种原因，它都不会在 https 中加载。这是我的相关代码（如果我遗漏了一些内容，将根据要求发布更多内容）。

网络配置

```
<compilation debug="false" targetFramework="4.0">
<authentication mode="Forms">
    <forms loginUrl="~/Account/LogOn" timeout="2880"  requireSSL="true"/>
</authentication> 
```

全球.asax

```
public static void RegisterRoutes(RouteCollection routes)
{
 routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
 routes.MapRoute(
  "Default", // Route name
  "{controller}/{action}/{id}", // URL with parameters
  new { controller = "Account", action = "LogOn", id = UrlParameter.Optional }
 );
} 
```

账户控制人

```
#if !DEBUG
    [RequireHttps]
#endif
public class AccountController : Controller
{
 public ActionResult LogOn()
    {
        return View();
    }
} 
```

当登录视图加载时，它不在 Https 中。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:51:50.153

构建站点时，您需要将构建目标设置为发布。您将在 Visual Studio 中看到如下所示的下拉列表，将其更改为发布并重建，然后发布您的站点：

![在此处输入图像描述](../Images/cdc0f77ae1a6b03ec4e78dbea8fe7348.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:27:06.123

您需要添加`[RequireHttps]`，所以它看起来像这样：

```
[RequireHttps]
public ActionResult LogOn()
{
    return View();
} 
```

这将强制它使用`Https`.

**编辑**

也许您需要将以下内容添加到您`Web.Config`的`<system.webServer>`部分：

```
<rewrite>
  <rules>
    <rule name="Secure Account Controller" enabled="true" stopProcessing="true">
      <match url="^account" ignoreCase="true" />
      <conditions logicalGrouping="MatchAll" trackAllCaptures="true">
        <add input="{HTTPS}" pattern="off" />
        <add input="{HTTP_HOST}" pattern="([^/:]*?):[^/]*?" />
      </conditions>
      <action type="Redirect" url="https://{C:1}:44300{URL}" />
    </rule>
  </rules>
</rewrite> 
```

# python - Pythonland 中的 Rubyist：元组的真实示例是什么？

> ID：11908808
> 
> 赞同：2
> 
> 时间：2012-08-10T20:28:37.670
> 
> 标签：python, ruby, tuples

> **可能重复：**
> [为什么我们需要 Python 中的元组（或任何不可变数据类型）？](https://stackoverflow.com/questions/2174124/why-do-we-need-tuples-in-python-or-any-immutable-data-type)

我正在学习 Python，并且有 Ruby 的背景。从来没有元组，我无法想象为什么我需要它们，或者为什么 Python 如此依赖它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T20:47:35.117

棋盘上一个正方形的坐标是很好地使用元组的一个例子。我通常使用由元组索引的 Python dict 来实现多维数组，而不是 list-of-lists 或 numpy 或数组模块：

```
board = {}
board[ 3, 6 ] = "black queen"
board[ 0, 0 ] = "white king" 
```

您不能将可变（如列表）用作字典键，因此您需要一个元组。

有时你会发现自己想要从一个函数返回多个值——一个表示成功或失败的布尔值加上一个描述失败模式的字符串，例如：

```
if trickyOperationSucceeds():
    return True,"Success!"
return False,"The tricky thing failed!" 
```

这不是一个经常使用的模式，但有时它会让你摆脱麻烦。您也可以在此处使用列表；只是按照惯例，您通常会改用元组。

在考虑如何表示必须一起传递的独立值时，元组、字典和类之间几乎是一个连续统一体。考虑三种表示复合回报的方式：

```
(False, "The tricky thing failed!")
{ "status": False, "message": "The tricky thing failed!" }
ResultObject( status=False, message="The tricky thing failed!" ) 
```

如果您的代码中只有一个地方执行此操作，则元组因其简洁而具有吸引力。如果您经常使用这种模式，并在不同模块之间来回传递这些结果对，您可能会“升级”到 dict，其中元素具有有意义的键。如果这些结果成为您软件设计的主要部分，您可能会再次将它们升级为对象类的实例。这是形式和易用性之间的平衡。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T20:35:19.263

元组只是一个不可变的序列，因此您不能分配给元组的各个项目。一个示例可能是一组 xy 坐标，例如`(5, 10), (-3, 20), (0, 0)`. 如果您需要更新其中一些坐标，您可以重新创建元组，例如

```
coord = (5, 10)
# Our thing moves
newCoord = (coord[0] + dx, coord[1] + dy) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T20:41:44.753

元组应该用于异构数据；它是 C`struct`或 Pascal 的Python 等价物`record`。将元素附加到这种类型没有意义，因此不需要它是可变的。与用于同质数据的列表对比：

```
people = [(u'Bob', 24), (u'Sally', 27)]
polygon = [(1, 1), (2, 3), (0, 0)] 
```

# scala - scala我如何使用get in class选项

> ID：11908811
> 
> 赞同：-2
> 
> 时间：2012-08-10T20:29:09.430
> 
> 标签：scala

> **可能重复：**
> [为什么 Option[T] ？](https://stackoverflow.com/questions/2079170/why-optiont)

我的项目有问题

如何从值中检索数据：[some (test)] 并且只取 ​​(test) 的值。并使用get方法？

或者

我如何改变值的形式：[some (test)] to "test" just

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T21:03:12.520

基本上，永远不要使用 get() 。没有任何情况下它是比替代品更好的选择。选项是在类型系统中指示函数可能不会返回您想要的内容的一种方式。您可能会将其视为包含 0 或 1 个事物的集合。

查看[API 文档](http://www.scala-lang.org/api/current/index.html#scala.Option)，其中显示了处理选项的几种不同方法；作为使用 map/flatMap、getOrElse 的集合，用于理解和模式匹配。

例如地图：

```
val maybeData : Option[String] = Some("test")  // or None
val maybeResult = maybeData.map(x : String => doSomethingWithAString(x)) 
```

如果 MaybeData 为 None，则什么也不会发生。如果是 Some()，您将返回一个包含 doSomethingWithAString() 结果的选项。请注意，这将是 Option[B]，其中 B 是 doSomethingWithAString 的返回类型。

例如getOrElse：

```
val maybeData : Option[String] = Some("test")  // or None
val result : String = maybeData.getOrElse("N/A") 
```

如果 data 为 Some，则结果为“test”，否则为“N/A”。

例如模式匹配：

```
val maybeData : Option[String] = Some("test")  // or None
val result : String = maybeData match {
  case Some(x) => doSomethingWithAString(x)
  case None => "N/A"
} 
```

你得到了图片（注意这假设 doSomethingWithAString 返回字符串）。

如果你使用 get() 并且可能数据为 None，你会得到处理空指针等价物的乐趣。没有人想要那样。

# python - TypeError：“int”对象没有属性“__getitem__”

> ID：11908818
> 
> 赞同：1
> 
> 时间：2012-08-10T20:29:56.317
> 
> 标签：python, pygame

我正在尝试用 pygame 中的 rects 制作游戏表面。我不确定问题到底是什么，但我相信它与创建矩形时列表的实际迭代有关。对不起，这里的菜鸟。:)

```
import pygame

w = 800
h = 600
board_pos = 0, 0
tile = 27
playfield = 0

class Board(object):
    def __init__(self, surface, pos, tile_size):
        self.surface = surface
        self.x, self.y = pos
        self.tsize = tile_size
        self.color = 50, 50, 50

        playfield = [list(None for i in xrange(22)) for i in xrange(10)]  

    def draw(self):
        for i in xrange(10):
            for j in xrange(22):
                playfield[i][j] = pygame.draw.rect(self.surface, self.color,
                                                  (self.x + (i * self.tsize),
                                                   self.y + (j * self.tsize),
                                                   self.tsize, self.tsize))

pygame.display.init()
screen = pygame.display.set_mode((w, h))

board = Board(screen, board_pos, tile)
board.draw()

while __name__ == '__main__':
    pygame.display.flip() 
```

我不断收到此错误：

```
Traceback (most recent call last):
  File "C:\Documents and Settings\Administrator\My
Documents\Dropbox\Programming\DeathTris
\test2.py", line 30, in <module>
    board.draw()
  File "C:\Documents and Settings\Administrator\My
Documents\Dropbox\Programming\DeathTris
\test2.py", line 24, in draw
    self.tsize, self.tsize))
TypeError: 'int' object has no attribute '__getitem__' 
```

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-10T20:34:11.420

您的行在函数`playfield = [list(None for i in xrange(22)) for i in xrange(10)]`内部创建了一个局部变量`__init__`。该变量在`__init__`函数返回后消失。稍后，`draw`当您执行 时`playfield[i][j]`，您正在访问 的全局值`playfield`，该值仍然为 0（因为您在开始时将其初始化为 0）。

If you want to overwrite the global playfield from inside your `__init__`, you need to do `global playfield` before you assign to it. (But. . . why are you using a global variable for this anyway?)

# java - Eclipse 仅从测试文件夹加载 log4.properties

> ID：11908820
> 
> 赞同：1
> 
> 时间：2012-08-10T20:30:16.600
> 
> 标签：java, eclipse, tomcat, maven, log4j

我正在使用 Eclipse Helios、maven 2.0.4 和 Eclipse 的 maven 插件。

好吧，我用这句话导入了一个Maven WebProject到eclipse：
mvn org.apache.maven.plugins:maven-eclipse-plugin:2.6:eclipse -Dwtpversion=2.0

该项目在“src/test/resources”和另一个“src/main/resources”中有一个 log4j.properties 文件。

当我通过 Eclipse 将 WebProject 运行到 Tomcat 6.0 中时（单击 Run As..），该项目从“src/test/resources”而不是“src/main/resources”加载 log4j.properties。我不知道为什么。此外，我在 Tomcat 文件夹 (\lib) 中放置了一个 log4j.properties，该项目仍然从“src/test/resources”加载文件。

您能否对这个问题有所了解？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:32:54.027

我认为，如果在项目设置的 Assembly 部分中，在所有其他文件夹之后有一行测试资源是可能的。

希望能帮助到你。

# recursion - C++ CLI：防止函数返回调用者的方法？

> ID：11908821
> 
> 赞同：0
> 
> 时间：2012-08-10T20:30:24.653
> 
> 标签：recursion, c++-cli, stack-overflow

也许有一个花哨的术语。可以说我有这个代码：

```
void a(){
  b();
}

void b(){
  c();
}

void c(){
  a();
  // do something
  if (FLAG_COMPLETE){
      return;
  }
} 
```

问题是它会继续 a->b->c->a->b->c 直到 FLAG_COMPLETE 上升。之后它将通过所有这些电话按顺序追溯。有没有办法避免被调用者返回调用者函数？我知道在组装中这很容易做到。

我正在使用 C++ CLI。我想通过循环调用函数来避免堆栈溢出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T22:02:26.400

如果我在字里行间读到，听起来您希望`a()`, then `b()`, then的内容`c()`永远运行，直到`FLAG_COMPLETE`设置？如果是这样，那为什么不明确地这样做呢？

```
void RunUntilComplete()
{
    while(!FLAG_COMPLETE)
    {
        ContentsOfA();
        ContentsOfB();
        ContentsOfC();
    }
} 
```

# objective-c - self.view removeFromSuperview 崩溃

> ID：11908826
> 
> 赞同：0
> 
> 时间：2012-08-10T20:30:58.817
> 
> 标签：objective-c, xcode, view

我希望这是我一段时间以来的最后一个问题，我通过以下方式打开一个 xib 文件：

```
Results1 *myView1 = [[Results1 alloc]initWithNibName:@"Results1" bundle:nil];
    [self.view addSubview:myView1.view]; 
```

我在第二个 xib 文件上有一个按钮：

```
-(IBAction)Button1:(id)sender
{

    [self.view removeFromSuperview];
} 
```

每次都崩溃：

```
0xecf09b:  movl   8(%edx), %edi 
```

我有链接的意见

我不确定这是否是问题所在：

```
@interface TestTypingToolViewController ()

{
    NSString *iResults1;
    NSString *iResults2;
    NSString *iResults3;
    NSString *iResults4;
    NSString *iResults5;
    NSString *Segment;
    NSDictionary *ResultsData;
}

@end 
```

谢谢大家的帮助，大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T17:55:09.467

问题是我需要关闭自动引用计数并且一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:45:03.220

您似乎遇到了僵尸问题，即某些对象在某些时候被释放，但您尝试通过一些（悬空）引用进行访问。[您可以通过启用僵尸检测](https://stackoverflow.com/questions/5386160/how-to-enable-nszombie-in-xcode)来获得更多信息。

实际上，我的猜测是您可以通过存储`Results1 *myView1`类的属性来解决此问题。实际上，在您的代码中，所发生的事情是`myView1.view`由`self.view`;保留。while`myView1`存储在局部变量中，因此当不再使用该变量时，应该释放对象（在 ARC 下）。您在这两个对象的生命周期之间存在不匹配，这可能导致崩溃。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-21T22:44:27.233

类名.h

`@property (nonatomic, strong) UIViewController *myView1;`

类名.m

```
@synthersize myView1; 
```

// 在 -(void)viewDidLoad

```
self.myView1 = [[Result1 alloc] init];
[self.view addSubview:self.myView1.view]; 
```

# c# - 不知道如何在 C# 中循环遍历 (n) 个嵌套对象

> ID：11908827
> 
> 赞同：1
> 
> 时间：2012-08-10T20:31:01.473
> 
> 标签：c#, asp.net, loops, recursion

我查看了这篇文章，看看是否可以以此为起点，但我认为它并没有解决我的特定问题。[C#：N 个 For 循环](https://stackoverflow.com/questions/2129341/c-n-for-loops)

我有以下代码：

```
int criteriaCount = rule.SearchCriteria.Criteria.Count();
string criteria = "";
        for (int i = 0; i < criteriaCount; i++)
        {
            if (rule.SearchCriteria.Criteria[i].Criteria.Count() > 0)
            {
                criteria += string.Format("({0}" + System.Environment.NewLine, rule.SearchCriteria.Criteria[i].Display);
                criteria += string.Format("{0})" + System.Environment.NewLine, rule.SearchCriteria.Criteria[i].Criteria[i].Display);
            }
            else
            {
                criteria += string.Format("[{0}]" + System.Environment.NewLine, rule.SearchCriteria.Criteria[i].Display);
            }
        } 
```

稍微解释一下，您有 SearchCriteria 和 Array of Criteria[]。我可以遍历它并从每个 Criteria 对象中获取我需要的关注，正如你所看到的那样。

我也在深入研究第二级，所以 SearchCriteria.Criteria[n].Criteria[n] 我可以放置一个 for 循环并在那里抓取任何嵌套值。

我无法弄清楚的部分是如何解释可变数量的嵌套 Criteria 对象？我可能有这个：

```
SearchCriteria.Criteria[n].Criteria[n] ... (repeat a hundred times)... .Criteria[n] 
```

所以它可能有无限数量的嵌套对象和无限数量的兄弟对象（Criteria[0], Criteria[1] ... Criteria[100000] 就是我的意思）。

有没有办法让我遍历所有这些？我听说递归循环可能是答案，我隐约理解这个概念，但我不知道如何获得孩子和兄弟姐妹的数量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T20:37:10.777

递归循环的基本概念定义如下。您将受限于堆栈上的可用空间。

```
private String GetSearchCriteria(Citeria root) {

  String result = root.Display;

  foreach (Criteria child in root.Criteria) {
    result += GetSearchCriteria(child);
  }

  return result;

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T20:44:56.857

使用递归，在你的情况下你可以使用这样的东西......

```
 private static string DisplayCriteria(Criteria criteriaObject)
        {
            string criteria = "";
            foreach(Criteria c in criteriaObject)
            {
                if (c.Criteria.Count() > 0)
                {
                    criteria += string.Format("({0}" + System.Environment.NewLine, c.Display);
                    criteria += string.Format("{0})" + System.Environment.NewLine, DisplayCriteria(c.Criteria));
                }
                else
                {
                    criteria += string.Format("[{0}]" + System.Environment.NewLine, c.Display);
                }
            }
            return criteria;
        }

        // your code  ...
        DisplayCriteria(rule.SearchCriteria.Criteria);
        // your code  ... 
```

我不确定那里的新行，您可以稍后添加/删除它们

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T20:45:32.660

您需要将您的方法变成“递归方法”......一种调用自身来处理无限嵌套的方法，例如：

```
public string ParseCriteria( Criteria criteria ) {
    string result = "(";
    result += criteria.Display;
    foreach( var criteria in criteria.Criteria) {
        result += ParseCriteria( criteria )
    }
    return result;
} 
```

然后，在您现有的代码中使用类似的内容。

```
foreach( var criteria in rule.SearchCriteria.Criteria ) {
    string result += ParseCriteria(criteria);
} 
```

字符串连接并不理想，而且我的示例格式不正确......但希望你明白这一点。

# c++ - main() 是用自动变量创建的，如果是，它的目的是什么？

> ID：11908832
> 
> 赞同：1
> 
> 时间：2012-08-10T20:31:21.147
> 
> 标签：c++, stack, activation-record

*我在函数调用堆栈*部分阅读了我的教科书并遇到了这个问题：

> 激活记录告诉main如何返回操作系统（即转移到返回地址R1）并包含main的自动变量（即a，它被初始化为10）的空间

这对我来说是个新闻，所以我的问题是：

1.  是否创建了自动变量？
2.  它的目的是什么？
3.  它的价值总是一样的吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:42:24.517

该段落引用了您教科书中的示例程序。在该示例程序中，声明了一个名为的自动变量并将`a`其初始化为 10。

示例程序可能如下所示：

```
int main () {
  int a = 10;
  return 42;
} 
```

> 是否创建了自动变量？

仅当您声明一个时。

> 它的目的是什么？

该段落描述了您在程序中使用的普通自动变量，用于您自己的目的。

> 它的价值总是一样的吗？

不。

# php - SQL INSERT 拒绝错误

> ID：11908833
> 
> 赞同：0
> 
> 时间：2012-08-10T20:31:23.047
> 
> 标签：php, sql

以下 SQL 查询导致错误：

```
INSERT INTO members.signIns
(employeeid, date, timeIn, timeOut, timeIn2, timeOut2, timeIn3, timeOut3, timeIn4, timeOut4)
 VALUES (1, 2012-08-10, 21-28, 21-28, 21-28, 21-28, 21-28, 21-28, 21-28, 21-28); 
```

> 错误：对表 'signIns' 的用户 'waycov_scanlock'@'66.40.52.44' 拒绝 INSERT 命令

我的托管服务提供商说它与此代码有关，而不是设置问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T20:34:36.757

不，这是权限问题。如果你有大量的语法错误，你会收到一条语法错误消息。

您对任何这些值都没有引号，因此所有这些`-`都被视为算术减法，因此您实际上是在尝试插入

```
1, 1994, -7, -7, -7, -7, etc... 
```

您的查询在语法上很好，但没有这些引号在逻辑上是无效的。它应该是：

```
VALUES (1, '2012-08-10', '21-28', etc...) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:33:34.383

用户`waycov_scanlock`无权访问该表；干净利落。

让您的托管服务提供商为您运行此查询：

```
GRANT SELECT,INSERT,ADD,UPDATE,DELETE ON members.* TO waycov_scanlock@'66.40.52.44' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:37:14.980

您没有登录表的**INSERT**权限

确保您的数据库名称是成员。

你也必须在这样的值周围加上引号 21-28

# forms - Zend Form - “同步”中的两个选择菜单

> ID：11908836
> 
> 赞同：0
> 
> 时间：2012-08-10T20:31:48.837
> 
> 标签：forms, validation, zend-framework, select, sync

一段时间以来，我一直试图找出答案，但仍然一无所获。有两个选择菜单，它们具有相同数量的选项和值。说

```
Select A
"one"=>1
"two"=>2
"three"=>3
Select B
"one"=>One
"two"=>Two
"three"=>Three 
```

Zend Form 和 validate 有没有办法让它们“同步”。所以如果我选择 SelectB=>Three，它会自动选择 SelectA=>3，反之亦然。还是仅使用自定义验证器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-12T11:10:25.883

JavaScript 解决方案的工作原理如下：

1.  修改你的 form.php

    `$A->setOptions(array('onchange'=>'mapIt(this.id)')); $B->setOptions(array('onchange'=>'mapIt(this.id)'));`

**和**

1.  将以下 JavaScript 函数添加到您的视图中

`function mapIt(id){
if(id == 'A'){ document.getElementById('B').value = document.getElementById(id).value; }else{ document.getElementById('A').value = document.getElementById(id).value; } }`

# magento - Magento Mage_Core_Block_Template 分配（）

> ID：11908838
> 
> 赞同：1
> 
> 时间：2012-08-10T20:31:51.750
> 
> 标签：magento

什么时候使用 assign() vs setData() 是可取的

我可以看到在核心代码库中对 assign 的使用有限，但不清楚何时更喜欢这种使用而不是简单的 setData

此功能是否已弃用或有特定用途？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T23:17:19.363

AFAICT 没有明确的使用先例。

ed 的值`assign()`存储在`_viewVars`数组中并`extract()`ed 到本地范围 in `Mage_Core_Block_Template::fetchView()`; 随心所欲地使用它。

# ios - 如何找到 UIWebView 的最后加载（就绪状态 4）

> ID：11908839
> 
> 赞同：9
> 
> 时间：2012-08-10T20:32:00.070
> 
> 标签：ios, xcode, uiwebview, uiwebviewdelegate

我的`didFinishLoad`方法有问题，`UIWebView`因为它一直在射击。我想尝试estimatedProgress[解决方案](http://winxblog.com/2009/02/iphone-uiwebview-estimated-progress/)，但不幸的是我不知道在哪里可以找到这些框架。我正在运行 Mountain Lion 并使用最新版本的 XCode。此外，对于 UIWebView 多次触发，这是最好的方法还是有新的方法。SO上似乎有一个javascript[答案](https://stackoverflow.com/questions/1422146/webviewdidfinishload-firing-too-soon)，但这对我不起作用。那是在 2009 年，我听说 Apple 拒绝任何使用私有 API 的应用程序。请帮帮我！

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T23:45:42.683

如何跟踪未完成请求的数量？我编写了一些似乎有效的测试代码：

```
@interface WebViewDelegate : NSObject<UIWebViewDelegate>
@property ( nonatomic ) NSUInteger numberOfRunningRequests ;
@end

@implementation WebViewDelegate

-(void)webViewDidStartLoad:(UIWebView *)webView
{
    self.numberOfRunningRequests = self.numberOfRunningRequests + 1 ;
}

-(void)webViewDidFinishLoad:(UIWebView *)webView
{
    self.numberOfRunningRequests = self.numberOfRunningRequests - 1 ;
    if ( self.numberOfRunningRequests == 0 )
    {
        NSLog(@"done!\n") ;
    }
}

@end

@implementation AppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    self.window.backgroundColor = [UIColor whiteColor];
    [self.window makeKeyAndVisible];

    UIWebView * webView = [[ UIWebView alloc ] initWithFrame:self.window.bounds ] ;
    static WebViewDelegate * delegate = nil ;
    delegate = [[ WebViewDelegate alloc ] init ] ;
    webView.delegate = delegate ;

    [self.window addSubview:webView ] ;
    NSURLRequest * request = [ NSURLRequest requestWithURL:[ NSURL URLWithString:@"http://stackoverflow.com"] ];
    [ webView loadRequest:request ] ;
    return YES;
}

@end 
```

（创建一个 Xcode 示例项目并用这个替换你的 AppDelegate.m）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T00:56:51.553

如果框架是指在您链接到的页面上的代码中导入的 .h 文件，[这里是](http://ariweinstein.com/WebViewHeaders.zip)直接下载它们的链接。如需进一步帮助，您需要详细说明。

**编辑：**另外，请参阅：[用于异步 Web 服务调用的 NSURLConnection NSURLRequest 代理](https://stackoverflow.com/a/1959327/716216)

链接的答案解释了如何`NSURLRequest`请求连接并为请求的不同状态获取不同的回调，例如`- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data`

# google-drive-api - 谷歌驱动器文件夹信息

> ID：11908841
> 
> 赞同：0
> 
> 时间：2012-08-10T20:32:12.830
> 
> 标签：google-drive-api, readonly

我想使用 Google Drive 将各种文件夹中的文件推送到远程计算机上。我希望这是一种单向交易，因此使用计算机的人无法写入 Google Drive。

但是，当我使用以下[C# 代码从 Google Docs](https://developers.google.com/google-apps/documents-list/#retrieving_a_list_of_collections)获取文件时，我只获取文件名，而不是它们将在远程计算机上的目录。这不起作用，因为不同目录中的某些文件具有相同的名称。有没有办法以编程方式从这些文件中获取目录信息？

或者，如果我可以将 Google Drive 文件夹设置为只读，那将实现我的目标并且可能更容易。这可以做到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:30:00.837

您应该使用 Google Drive API[列出所有文件](https://developers.google.com/drive/v2/reference/files/list)并检查`parents`每个文件的字段以将这些文件映射到文件夹中：

[https://developers.google.com/drive/v2/reference/files#resource](https://developers.google.com/drive/v2/reference/files#resource)

# javascript - 在战争中包含缩小的 JavaScript 文件

> ID：11908842
> 
> 赞同：0
> 
> 时间：2012-08-10T20:32:12.940
> 
> 标签：javascript, scala, sbt, xsbt-web-plugin

我正在使用 sbt-js 0.3 来构建一个 Scalatra Web 项目。我在`build.sbt`.

```
(webappResources in Compile) <+= (resourceManaged in Compile)

(resourceGenerators in Compile) <+= (JsKeys.js in Compile)

(compile in Compile) <<= compile in Compile dependsOn (JsKeys.js in Compile) 
```

当我运行`compile`压缩文件时，确实会在`target/scala_2.9.1`文件夹中生成。`package`但是当我使用（来自 xsbt-web-plugin）或`assembly`（来自 sbt-assembly）时，我无法在战争中获得这些文件。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:18:52.690

查看[xsbt-web-plugin](https://github.com/siasia/xsbt-web-plugin/blob/master/src/main/scala/com/github/siasia/WarPlugin.scala)似乎默认情况下从 sourceDirectory/webapp 复制并在 target/webapp 中组装所有内容。

[我认为您需要按此处](https://github.com/siasia/xsbt-web-plugin/wiki/Massage-WAR)所示按摩您的 WAR （除了复制而不是删除）或重新配置以将您的缩小 JS 包含在 webappResources 设置中。

# cocos2d-iphone - 图片不会显示

> ID：11908844
> 
> 赞同：0
> 
> 时间：2012-08-10T20:32:21.247
> 
> 标签：cocos2d-iphone

使用 cocos2d 我将图像放在桌面上并将它们拖到我项目中的资源文件中。它以前有效，但不再有效。有什么技巧可以解决这个问题吗？

错误：

> 012-08-10 15:30:55.884 再次[9753:1be03] cocos2d：无法在 CCTextureCache 中添加图像：soundoff.png

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:40:50.573

您可以观察到这种行为的两个可能原因：

1.  文件名包含混合的小写/大写；这是典型的，因为 iOS 区分大小写，而 MacOS 不区分；因此，它可能会在模拟器中工作，但在设备上失败；或者，如果您通过更改大写/小写来重命名文件（例如，将 soundOff 更改为 soundoff），MacOS 上的构建系统将不会认为重命名的文件与原始文件不同，并且不会将其包含在构建中；

2.  该文件实际上并未添加到目标的“复制阶段”（检查目标的构建阶段）。

希望能帮助到你。

# php - 仅将关联数组元素转换为对象

> ID：11908850
> 
> 赞同：1
> 
> 时间：2012-08-10T20:32:54.883
> 
> 标签：php

我的阵列

```
$arr = array(
  "name" => "Prakash",
  "tall" => "maybe",
  "nick_names" => array ("p", "b", "bee", "prak", "new_names" => array("short_name" =>   "sn", "long_name" => "ln"))
); 
```

我希望能够创建一个可以通过属性访问值的对象。

例如

```
 $obj->name // "PRAKASH"
 $obj->nick_names // array("p", "b", "bee", "prak", "new_names" => (object)) 
```

我怎么能得到这个？

我似乎能够通过

```
$obj = json_decode(json_encode($arr)); 
```

但显然这不是正确的做法。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:34:21.947

您可以将其转换为`stdClass`：

```
$obj = (stdClass) $arr; 
```

请注意，在 PHP 中，数组远远优于`stdClass`任何可以想象的方式。

*   更好的性能
*   更好的穿越能力
*   更好的可读性（IMO）

# c# - 如何在 C# 中筛选 3 层深度

> ID：11908851
> 
> 赞同：0
> 
> 时间：2012-08-10T20:33:01.000
> 
> 标签：c#, screen-scraping

我有一个 url (http://www2.anac.gov.br/aeronaves/cons_rab.asp) 我需要以编程方式发布表单数据。也就是说，以编程方式，我想选择正确的单选按钮并单击提交按钮。如果你去上面的网址，我需要选择的单选按钮是“modelo”。单击“确定”按钮将返回一个包含 20k+ 链接的表单。

然后我想遍历所有 20k+ 链接并抓取链接指向的页面。最后，我将从最后一页获取信息并将数据放入 Excel 电子表格中。

进入第三页以抓取信息的最佳方式是什么？我研究了 HTML Agility Pack、HTTPWebRequest 和 WebBrowser 控件，但我不确定该使用哪一个。

更新：在第一页上，我必须选择一个单选按钮，然后模拟一个按钮单击，将表单发布回自身。结果页面包含我感兴趣的 20K+ 链接；但是，每个链接都是一个 javascript 函数调用。JS 函数获取链接文本，将其放在文本框中，然后单击提交按钮。我怎么能自动化呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:37:19.807

您应该能够使用 HTML Agility 包做您想做的事情：

*   [http://htmlagilitypack.codeplex.com/](http://htmlagilitypack.codeplex.com/)

*   [http://www.leeholmes.com/blog/2010/03/05/html-agility-pack-rocks-your-screen-scraping-world/](http://www.leeholmes.com/blog/2010/03/05/html-agility-pack-rocks-your-screen-scraping-world/)

您还应该考虑 iRobot：

*   [http://irobotsoft.com/](http://irobotsoft.com/)

还：

1）你试过什么？

2）你走了多远？你遇到了什么问题/疑问？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:14:58.983

你试过[硒](http://seleniumhq.org/)吗？它使用 webdriver，我已经使用它完成了几个屏幕抓取应用程序，并且从未遇到过问题，即使使用实时应用程序也是如此。您可以将它与 C# 一起使用来驱动浏览器并获取您需要的内容。

# javascript - 使用jquery获取选择器下的元素

> ID：11908858
> 
> 赞同：-2
> 
> 时间：2012-08-10T20:33:28.137
> 
> 标签：javascript, jquery, jquery-selectors

我有一个选择器，我可以在其中获得这样的第一个元素：

```
$("#MyControl")[0] 
```

除了像数组一样访问元素之外，是否可以使用函数获取元素？

我想要做的是将此元素传递给带有 .call() 的函数以定义上下文。

这是一个例子：

```
$(document).ready(function () {
    $(document).on("change", "#MyControl", setActivityControlsState);
});

setActivityControlsState: function () {
    var selector = "#automaticActivityCreation";

    if ($(selector).length > 0) {
        if ($.isNumeric(this.value) && this.value > 0)
            $(selector).show();
        else
            $(selector).hide();
    }
}

referenceFormOnSuccess: function (data) {
    setActivityControlsState.call($("#MyControl")[0]);
} 
```

正如您在 refreshFormOnSuccess 函数中看到的那样，我必须用 $("#MyControl")[0] 定义“this”。

我只是想知道是否有更好的方法来做到这一点。

*请注意，我不想使用 $(this).val() 之类的东西访问我的控件的值*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:43:04.610

我是否可以建议进行小型重组以减轻这种需求：

```
$(document).ready(function () {
    $(document).on("change", "#MyControl", setActivityControlsState);
});

setActivityControlsState: function () {
    // cache jquery object instead of just the selector 
    // for better memory management
    var automaticActivityCreation = $("#automaticActivityCreation");

    if (automaticActivityCreation.length > 0) {
        if ($.isNumeric(this.value) && this.value > 0)
            automaticActivityCreation.show();
        else
            automaticActivityCreation.hide();
    }
}

referenceFormOnSuccess: function (data) {
    // fire the change event which will tap 
    // the listener you set up in .ready
    $("#MyControl").trigger('change'); 
} 
```

但如果你真的想用 jquery 获取对象，你确实有一些选择：

```
// jQuery select #MyControl and get as dom element with array
$("#MyControl")[0]

// jQuery select #MyControl and get as dom element with .get
$("#MyControl").get(0) 
```

但是因为您使用的是带有 ID 的元素，并且一次只能使用一个 ID，所以您真的不需要 jquery

```
document.getElementById('MyControl') 
```

或者

```
referenceFormOnSuccess: function (data) {
    setActivityControlsState.call(document.getElementById('MyControl'));
} 
```

# php - Symfony2 明文用户不工作

> ID：11908861
> 
> 赞同：2
> 
> 时间：2012-08-10T20:33:43.610
> 
> 标签：php, security, symfony

我尝试通过将其配置到 secery.yml 中来配置一个简单的安全管理区域。我使用了 Symfony 的示例：

```
 security:
        firewalls:
            secured_area:
                pattern:    ^/
                anonymous: ~
                http_basic:
                    realm: "Secured Admin Area"

        access_control:
            - { path: ^/admin, roles: ROLE_ADMIN }

        providers:
            in_memory:
                users:
                    ryan:  { password: ryanpass, roles: 'ROLE_USER' }
                    admin: { password: kitten, roles: 'ROLE_ADMIN' }

        encoders:
            Symfony\Component\Security\Core\User\User: plaintext 
```

我有用户名/密码提示，但夫妻 ryan:ryanpass 和 admin:kitten 不起作用。有什么不对 ？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T07:36:25.197

我认为您需要在您的情况下将提供程序名称添加到 http_basic 部分：

```
http_basic:
    realm: "Secured Admin Area"
    provider: in_memory 
```

# python - 系统地删除一段文本（正则表达式？）

> ID：11908870
> 
> 赞同：0
> 
> 时间：2012-08-10T20:34:23.153
> 
> 标签：python, regex

我有以下格式的文本：

```
 <cast_member billing="top">
            <display_name>Elijah Wood</display_name>
            <character_name>#9 (voice)</character_name>
            <locales>
                <locale name="ko-KR">
                    <display_name>일라이자 우드</display_name>
                </locale>
                <locale name="cmn-Hant">
                    <display_name>伊利亞伍德&lt;/display_name>
                </locale>
            </locales>
        </cast_member>
        <cast_member billing="top">
            <display_name>Peter Pan</display_name>
            <character_name>#8 (voice)</character_name>
        </cast_member> 
```

当标签存在时，我将如何删除`<locales>`标签内和包含的所有内容。上面的输入将如下所示：

```
 <cast_member billing="top">
            <display_name>Elijah Wood</display_name>
            <character_name>#9 (voice)</character_name>
        </cast_member>
        <cast_member billing="top">
            <display_name>Peter Pan</display_name>
            <character_name>#8 (voice)</character_name>
        </cast_member> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:48:47.020

永远不要使用正则表达式来解析 HTML 或 XML。请改用出色的[lxml](http://lxml.de/)库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T22:00:52.227

This will do the job in pure Python without Regex but it might destroy indentation and/or leave blank lines where text has been cut out

```
<cast_member billing="top">
    <display_name>Elijah Wood</display_name>
    <character_name>#9 (voice)</character_name>

</cast_member>
<cast_member billing="top">
    <display_name>Peter Pan</display_name>
    <character_name>#8 (voice)</character_name>
</cast_member> 
```

here's the code:

```
with open('data') as f:
    text = f.read()

oTag = "<locales>"
cTag = "</locales>"

newText = ''
p = 0
s = text.find(oTag, p)
while s > -1:
    e = text.find(cTag, s)
    if e == -1:
        # ERROR: no closing tag
        pass
    newText += text[p:s]
    p = e + len(cTag)
    s = text.find(oTag, p)
newText += text[p:]

print newText, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:46:51.520

您可以使用正则表达式和正则表达式替换功能

“字符串”.replace(/s/, '') -> “字符串”

您可以创建一个看起来像这样的正则表达式： /(\s+.+){0,}</locales>/ -> 这将匹配打开和关闭语言环境标记，以及介于两者之间的任何内容。

[http://rubular.com/r/WTfo0b2bet](http://rubular.com/r/WTfo0b2bet)看看它的实际效果

myXMLstring.replace(/(\s+.+){0,}</locales>/, '')

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T20:56:25.677

Here is what I ended up doing, using lxml:

```
cast_name = node.xpath("//package/video/cast/cast_member/display_name")
character_name = node.xpath("//package/video/cast/cast_member/character_name")
combined_cast = zip(cast_name, character_name)
cast = [(item1.text, item2.text) for item1, item2 in combined_cast]

[(Elijah Wood,#9 (voice)), (Peter Pan, #8 (voice))] 
```

# oracle - “伪造”Oracle 数据库

> ID：11908875
> 
> 赞同：2
> 
> 时间：2012-08-10T20:34:51.783
> 
> 标签：oracle, rdbms

在工作中测试我的应用程序的 QA 部门使用他们共享的 Oracle 数据库。随着他们的案件发生变化，事情变得非常棘手。提交的错误报告 + 我花时间只是为了找出测试用例已被更改 = 浪费时间。

我希望 dev 和 qa 都在我们的机器上运行我们自己的 Oracle 副本，这样我们就可以保护我们的数据并追逐我们的尾巴......更少。

据我所知，问题是我们没有为所有这些许可证提供资金。使用开源数据库是行不通的，因为我们有各种各样的 PL/SQL 包和触发器，我确信它们将我们与 Oracle 联系在一起。

有谁知道“伪造”Oracle 数据库的方法（或者可能是开源产品）？根本没有性能要求。我不是指模拟对象（我们确实将其用于单元测试），而是实际的“在端口上侦听您的请求”RDMS。这是一个长镜头，但我不得不问。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-10T20:39:08.023

为此，请使用 Oracle Express。

[http://www.oracle.com/technetwork/products/express-edition/overview/index.html](http://www.oracle.com/technetwork/products/express-edition/overview/index.html)

> Oracle 数据库 11g 快捷版
> 
> 免费开发、部署和分发
> 
> Oracle Database 11g Express Edition (Oracle Database XE) 是基于 Oracle Database 11g 第 2 版代码库的入门级、占用空间小的数据库。它可以免费开发、部署和分发；快速下载；并且易于管理。
> 
> Oracle Database XE 是一个很好的入门数据库，用于：
> 
> 从事 PHP、Java、.NET、XML 和开源应用程序的开发人员
> 
> 需要免费的入门数据库进行培训和部署的 DBA
> 
> 希望免费分发初始数据库的独立软件供应商 (ISV) 和硬件供应商
> 
> 需要免费课程数据库的教育机构和学生
> 
> 借助 Oracle Database XE，您现在可以使用功能强大、经过验证、行业领先的基础架构来开发和部署应用程序，然后在必要时进行升级，而无需进行昂贵且复杂的迁移。
> 
> Oracle Database XE 可以安装在具有任意数量 CPU 的任何大小的主机上（每台机器一个数据库），但 XE 将存储多达 11GB 的用户数据，使用多达 1GB 的内存，并在主机上使用一个 CPU。
> 
> 通过由 Oracle 员工和社区专家监控的免费 Oracle 论坛提供支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T20:39:14.327

您可以使用免费的 Oracle XE (Express Edition)。

你可以[在这里](http://www.oracle.com/technetwork/products/express-edition/overview/index.html)下载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T20:41:27.263

假设每个开发人员在他们的个人数据库副本中需要少于 11 GB 的数据，您是否考虑过使用Oracle 数据库的免费[快速版？](http://www.oracle.com/technetwork/products/express-edition/downloads/index.html)您可以将其安装在本地计算机上，甚至可以免费将其部署到生产环境中。您不能使用企业版功能，但基本的 PL/SQL 应该与您现在使用的任何版本的数据库完全一样。

然而，这对我来说并不明显，这确实是解决您遇到的问题的方法。如果测试用例在没有将信息传达给开发人员的情况下发生更改，或者一个人所依赖的测试数据正在被其他人更改，那么创建更多具有相同数据的更多副本的数据库实例不太可能有很大帮助。如果您有数据库的本地副本，则需要某种方法来获取所有对象（表、包、触发器等）的当前版本。您需要某种方式来获取特定测试人员所依赖的数据。您需要某种方式将您的更改从您的机器转移到共享数据库中，而这种方式不会影响其他开发人员所做的更改。这些障碍都不是不可逾越的，但它们确实需要一个非常可靠的构建和部署过程——否则，您最终会陷入混乱，您的数据库中的代码版本与其他所有人数据库中的代码版本略有不同，并且您系统中的测试数据略有不同与 QA 使用的测试数据相比，这些特征会导致许多错误在一个系统上可重现，但在另一个系统上则无法重现。如果您当前的构建和部署过程甚至无法确保在调查错误时测试用例不会发生变化，我倾向于认为添加更多实例会使问题变得更糟，而不是更好。s 数据库和系统中的测试数据与 QA 使用的测试数据的特征略有不同，这会导致在一个系统上可重现但在另一个系统上无法重现的许多错误。如果您当前的构建和部署过程甚至无法确保在调查错误时测试用例不会发生变化，我倾向于认为添加更多实例会使问题变得更糟，而不是更好。s 数据库和系统中的测试数据与 QA 使用的测试数据的特征略有不同，这会导致在一个系统上可重现但在另一个系统上无法重现的许多错误。如果您当前的构建和部署过程甚至无法确保在调查错误时测试用例不会发生变化，我倾向于认为添加更多实例会使问题变得更糟，而不是更好。

# java - Java - FloatBuffers 的可用内存

> ID：11908878
> 
> 赞同：2
> 
> 时间：2012-08-10T20:34:56.547
> 
> 标签：java, memory-management

我是 java 新手（以前是 C#），我不明白如何释放非托管资源。

我像这样创建 FloatBuffer 我`FloatBuffer buffer = FloatBuffer.allocate(length);` 如何释放它？没有免费、处置或删除方法

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T20:37:59.197

Java 中的所有内存管理都是自动处理的（除了与本机代码接口有关的少数情况）。

当不再有对您声明的 FloatBuffer 的引用时，它将有资格进行垃圾回收。此后的某个时间，垃圾收集器将运行并释放其使用的内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:37:05.583

a 的取消分配`FloatBuffer`与大多数其他对象的处理方式相同（总是有一个例外......）。

一旦你不再拥有对该对象的引用，GC 就会在它认为合适的时候做它的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T20:38:10.463

垃圾收集器在不再需要时处理它，即在当前活动对象图中无法访问它。

# mysql - Mysql多次插入支持多少个扩展值？

> ID：11908880
> 
> 赞同：0
> 
> 时间：2012-08-10T20:35:09.080
> 
> 标签：mysql

我们都知道在一个查询中使用多个插入比运行多个查询要好。但是，我不知道 Mysql 最多支持多少个这些多个扩展值？我在网上搜索但没有找到正确的答案。我只是想知道这一点。

例子，

`INSERT INTO tbl_name VALUES(1, 'John Doe'), (2, 'Peter England'), ....`

我记得当我使用一些 MVC 框架时，它试图在一个查询中触发成百上千的插入，我曾经收到某种错误消息，例如`Mysql server has gone away`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:38:28.047

您的查询的最终长度限制由[max_allowed_pa​​cket](http://dev.mysql.com/doc/refman/5.6/en/server-system-variables.html#sysvar_max_allowed_packet)设置设置 - 如果您超过该设置，查询将被截断并且几乎肯定会变得无效。

虽然执行多值插入更有效，但不要过分尝试执行数千个值集。尝试拆分它，这样你最多只做几百个，并且一定要确保查询字符串的长度不会接近 max_allowed_pa​​cket。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:38:37.437

多次插入的限制，就像您正在谈论的那样，将受到数据包限制的约束。

见：[http ://dev.mysql.com/doc/refman/5.1/en/packet-too-large.html](http://dev.mysql.com/doc/refman/5.1/en/packet-too-large.html)

这将影响所有查询类型，而不仅仅是插入。

为了添加更多上下文，您所说的[MySQL 服务器已消失](http://dev.mysql.com/doc/refman/5.0/en/gone-away.html)的错误将是超出数据包限制的结果。来自页面的引用：

> 如果您向服务器发送不正确或太大的查询，您也可能会收到这些错误。如果 mysqld 收到一个**太大**或乱序的数据包，它会假定客户端出现问题并关闭连接。如果您需要大查询（例如，如果您使用大 BLOB 列），您可以通过设置服务器的**max_allowed_pa​​cket**变量来增加查询限制，该变量的**默认值为 1MB**。您可能还需要增加客户端的最大数据包大小。有关设置数据包大小的更多信息，请参见第 C.5.2.10 节，“数据包太大”。

# ruby-on-rails - Rails：如何安装 CanCan？

> ID：11908881
> 
> 赞同：2
> 
> 时间：2012-08-10T20:35:14.360
> 
> 标签：ruby-on-rails, ruby

我已经安装了 CanCan`gem 'cancan'`并向 Gemfile 添加了行。冉`bundle`。

我`app/models/ability.rb`用代码创建：

```
class Ability
  include CanCan::Ability
  def initialize(user)
    user ||= User.new # guest user (not logged in)
    if user.admin?
      can :manage, :all
    end
  end
end 
```

**ActiveAdmin**和**Devise**已安装并插入。

我添加`if cannot?`到 app/admin/codes.rb：

```
ActiveAdmin.register Code do
  if cannot? :manage, Code
    flash[:notice] = "Access denied"
    redirect_to '/'
  end

  index do
    column :id
    column :title
    column :author
    column :created_at
    column :updated_at
    column :language
    default_actions
  end
end 
```

rails 无法启动服务器或打开 rails 控制台：

```
app/admin/codes.rb:2:in `block in <top (required)>': undefined method `cannot?'
for #<ActiveAdmin::ResourceDSL:0x4ae7fe8> (NoMethodError) 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:10:46.497

cancan 方法被添加到所有控制器和模型中，而不是其他任何东西，因此您需要在 ActiveAdmin 类中手动包含 cancan 方法。考虑遵循此处的模式：

[https://github.com/ryanb/cancan/blob/master/lib/cancan/controller_additions.rb](https://github.com/ryanb/cancan/blob/master/lib/cancan/controller_additions.rb)

有类似的东西`include CanCan::ControllerAdditions`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:28:51.380

我做到了。
我已经附加了在控制器上下文中执行的代码：

```
 controller do
    before_filter :check_admin

    def check_admin
      if cannot? :manage, Code
        flash[:alert] = "Access denied!"
        redirect_to '/admin'
      end
    end
  end 
```

# iphone - KVO：显然相同的“有效” keyPath 会产生不同的结果

> ID：11908886
> 
> 赞同：0
> 
> 时间：2012-08-10T20:35:24.600
> 
> 标签：iphone, objective-c, ios, cocoa-touch, key-value-observing

我已经为 KVO 的设置苦苦挣扎了几个小时，但我设法让它工作：

这有效：

```
 [self addObserver:self forKeyPath:@"session.loginState" options:0 context:nil]; 
```

这不会：

```
 [self addObserver:self.session forKeyPath:@"loginState" options:0 context:nil]; 
```

请注意，`self.session`懒惰地创建了一个空`Session`对象，因此 self.session 永远不会`nil`。但是，似乎：

1.  的密钥路径`session.loginState`与`self`...不一样
2.  从 KVO 的角度来看`loginState`的关键路径`self.session`

为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T20:43:50.413

你有你的观察者和向后观察者。尝试

```
[self.session addObserver:self forKeyPath:@"loginState" options:0 context:nil]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T21:07:32.520

使用此代码：

```
 [self addObserver:self forKeyPath:@"session.loginState" options:0 context:nil]; 
```

您将 self 添加为`self`keypath的观察者`session.loginState`，这是有效的`self.session.loginState`。

在这段代码中：

```
 [self addObserver:self.session forKeyPath:@"loginState" options:0 context:nil]; 
```

您正在添加`self.session`作为`self`'s keypath的观察者`loginState`，这是有效的`self.loginState`。

# c++ - QML 双向 C++ 绑定不再接收更改

> ID：11908890
> 
> 赞同：4
> 
> 时间：2012-08-10T20:35:56.137
> 
> 标签：c++, qt4, qml, qt-quick

我面临一个大问题，即需要很长时间才能修复，因为我不知道原因以及如何修复它。问题很简单：我有一个示例 QML 组件定义为：

```
Rectangle {
    id: rect
    property bool test: myclass.testproperty

    Rectangle {
        width: 50
        height: 50
        visible: parent.test
    }
} 
```

我连接了一个 MouseArea onClicked 信号来执行此操作：

```
test = !test 
```

所以我切换布尔变量的值。为了使用 READ、WRITE 和 NOTIFY 信号将值从 C++ 推送到 QML 以及从 QML 推送到 C++ Q_PROPERTY，我使用了这个

```
Binding {
    target: myclass
    property: "testproperty"
    value: rect.test
} 
```

在我单击 mouseArea 之前一切正常，因此我通过绑定推送更改。之后，每次我尝试从 C++ 设置新的属性值时，我都看不到 QML 有任何变化，就像绑定被破坏一样。但是，如果我尝试单击 MouseArea，我仍然会调用 C++ 类的 setTestProperty 方法。基本上，它与 C++ -> QML 方式不同步。为什么？我找不到问题，发出信号是因为 QSignalSpy 给我 1 作为使用后发出的次数

```
emit this->testPropertyChanged(newvalue) 
```

**编辑**

这里是一个例子：基本上我们在这里使用具有相同确切信号的 QString 属性。唯一改变的是，我没有使用 Rectangle QML 元素并绑定到自己的属性，而是使用了 TextInput 元素

```
TextInput {
    id: mytext
    text: myclass.testproperty
}

Binding {
    target: myclass
    property: "testproperty"
    value: mytext.text
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-11T09:58:40.217

这里没有问题。这是一个标准的 QML 绑定行为。当您在 JavaScript 代码中更改某些 QML Widget 的属性时，对它的所有声明性绑定都将终止。您可以选择在事件处理程序的 JS 代码中手动使用声明性绑定或更新值。

**编辑**

```
Rectangle {
    id: rect

    // Establishing initial value for 'test' property via QML binding
    property bool test: myclass.testproperty

    // Manual update of 'test' property when binding will be broken
    Connections {
        target: myclass
        onTestpropertyChanged: {
            rect.test = xxx
        }
    }
} 
```

# jquery - 在 .each() 范围内使用变量

> ID：11908891
> 
> 赞同：0
> 
> 时间：2012-08-10T20:36:06.827
> 
> 标签：jquery

我之前得到了一些关于这段代码的帮助，但我遇到了另一个问题。如何修改每个函数内的变量并在该范围之外使用它们？
这是我的代码的简单解释：对于每个网页，获取元素的内容并将它们插入到数组中。在此之后，操作数组以创建消息并向浏览器发送警报。

**HTML**

```
<div id="insert"></div> 
```

**Javascript**

```
$(document).ready(function() {
    userid = 17320;
    courseid = 4745;

    allLessonsArray = script(userid, courseid);

    function script(userid, courseid) {
        var lessonInTopicSectionArray = new Array();
        lessonInTopicSectionArray['Floods, external'] = 376;
        var allLessonsArray = new Array();

        $.each(lessonInTopicSectionArray, function(name, lesson) {
            lastAttempt = 0;
            url = '---------/learn/mod/lesson/report.php?id=' + lesson + '&action=reportdetail&userid=' + userid + '&try=' + lastAttempt;
            var lessonArray = new Array();

            $.get(url, function(data) {
                var page = $(data);                
                $('tr.r1.lastrow td.cell.c0').html(page).each(function(index, content) {
                    score = parseInt(content.substr(content.length - 1));
                    lessonArray[index] = score;
                });

                allLessonsArray[name] = lessonArray;
            });

        });
        return allLessonsArray;
    }

    var message = "";

    $.each(allLessonsArray, function(name, lessonArray) {
        if (!message) {
            message = "<li>Lesson <b>" + name + "</b> scores are:</li>";
        }
        else {
            message = message + "<li>Lesson <b>" + name + "</b> scores are:</li>";
        }

        probability = lessonArray[0];
        humanImpact = lessonArray[1];
        infrastructureImpact = lessonArray[2];
        communityImpact = lessonArray[3];
        training = lessonArray[4];
        preparedness = lessonArray[5];
        message = message + "<ul><li>Probability score: " + probability + "</li><li>Human Impact score: " + humanImpact + "</li><li>Public Health Infrastructure Impact score: " + infrastructureImpact + "</li><li>Community Impact score: " + communityImpact + "</li><li>Training score: " + training + "</li><li>Preparedness score: " + preparedness + "</li></ul>";
        risk = (probability / 3) * ((humanImpact + infrastructureImpact + communityImpact + training + preparedness) / 15);
        message = message + "<p>Risk of <b>" + name + "<b> is" + risk + ".</p>";

    });

    $('#insert').html(message);

});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:42:07.053

您需要在范围之外定义该变量。

```
var myvar = [];
$.each(
// stuff happens to myvar
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:26:55.307

范围似乎是正确的。

也许您的问题与`$.each()`不迭代以`Array`a`String`作为索引的元素有关。

[在此处](http://jsfiddle.net/GDCm3/14/)尝试以下操作，您只会得到一个弹出窗口`0 -> 1`：

```
var list = new Array();
list['Floods, external'] = 376;
list[0] = 1;

$.each(list, function(index, item) {
    alert(index + " -> " + item);
});​ 
```

从 jQuery 的`$.each()` [文档](http://api.jquery.com/jQuery.each/)页面：

***描述**：通用迭代器函数，可用于无缝迭代对象和数组。具有长度属性的数组和类数组对象（例如函数的参数对象）**由数字索引迭代**，从 0 到 length-1。其他对象通过其命名属性进行迭代。*

您可以通过以下方式完成等效操作：

```
var list = new Array();
list[0] = {name : 'Floods, external', value : 376};

$.each(list, function(index, item) {
    alert(item.name + " -> " + item.value);
});​ 
```

# selenium - Selenium IDE，在目标中使用通配符，使用 name= 和 id=

> ID：11908893
> 
> 赞同：1
> 
> 时间：2012-08-10T20:36:21.387
> 
> 标签：selenium, ide

我是 selenium 的新手，甚至是编程语言的新手。我正在为我公司的客户服务软件（我们销售杂志订阅）创建一个测试场景。问题是，某些字段在目标中具有不同的名称和标识符。两个例子——

```
id=address_menu_71736039

name=auto_renew_47457811 
```

数字每次都在变化。我之前发布了一个关于 xpath 的问题，但是这段代码似乎更简单，而且这个技巧不起作用）。有任何想法吗？我会很感激的！

# conditional-comments - 是否可以在 Chrome Frame 中使用条件注释？

> ID：11908896
> 
> 赞同：1
> 
> 时间：2012-08-10T20:37:01.270
> 
> 标签：conditional-comments, google-chrome-frame

使用时...

```
<!--[if lte IE 8]> <html class="ie8-7-6"> <![endif]-->
.ie8-7-6 .loginForm {display:none;} /* The login form is hidden. */ 
```

和

```
.ie8-7-6 .yourbrowserisold {display:block;} /* and some nice graphics 
appear to indicate it doesn't support IE6, 7, or 8\. */ 
```

所以效果很好，我提供了一个下载 Chrome Frame 的链接。

但是现在，如果安装了 Chrome Frame，我希望它做相反的事情。

```
<!--[if CF]><html class="chrome-frame><![endif]--> 
.chrome-frame .yourbrowserisold {display:none;}
.chrome-frame .loginForm {display:block;} 
```

但

```
<!--[if CF]><html class="chrome-frame><![endif]--> 
```

不起作用，我需要出现登录表单。

我用谷歌搜索了几十个网站，如果......我找不到答案

一种。甚至可以使用条件语句？

湾。还是只有javascript才有可能？

有什么帮助吗？

------更新------------ 这是一个检测是否安装了 Google Frame 的脚本。

```
$(document).ready(function() {
     if( $.browser.chromeframe != window.externalHost) {alert("You are using chrome frame. You rock!"); } 
else { alert("You are not using chrome frame."); }
}); 
```

仅供参考：您可以将自己的 jQuery 添加到上述脚本中以针对 Chrome Frame 用户。

----- 演示：[https ://dev.clientwhys.com/index-dummy-ie.iml](https://dev.clientwhys.com/index-dummy-ie.iml)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T04:44:37.933

检测您是否在 IE 内的 Chrome Frame 中的最佳方法是检查

```
var isChromeFrame = !!window.externalHost; 
```

这仅在 Chrome Frame 内可用。目前，Chrome Frame 没有类似条件注释的构造。

更多信息请访问[http://www.chromium.org/developers/how-tos/chrome-frame-getting-started/understanding-chrome-frame-user-agent](http://www.chromium.org/developers/how-tos/chrome-frame-getting-started/understanding-chrome-frame-user-agent)。

但是对于您的情况，如果用户已经安装了 Chrome Frame，并且您通过`chrome=1`标志触发它，那么他们将永远不会在 IE 条件注释中看到任何内容。

# sharepoint-2010 - Sharepoint 自定义声明提供程序和 Sharepoint 配置文件“声明”数据映射

> ID：11908898
> 
> 赞同：1
> 
> 时间：2012-08-10T20:37:06.280
> 
> 标签：sharepoint-2010, provider, claims-based-identity

我有一个自定义声明提供程序，它在 Sharepoint 2010 上使用 IP-STS。我希望来自 IP-STS 的特定声明映射 Sharepoint 用户配置文件。即：将[http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress](http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress)声明映射到共享点用户配置文件上的“工作电子邮件”字段

我想在用户第一次登录时自动执行此操作，无需任何额外步骤。

我们怎样才能做到这一点？仅供参考，我一直在努力研究它：

即使我在安装声明提供程序时映射它，这样：

```
$map = New-SPClaimTypeMapping "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress" -IncomingClaimTypeDisplayName "Email" -SameAsIncoming 
```

我在 Sharepoint 用户个人资料上看不到正确的信息。

有什么帮助吗？

提前致谢

# android - 类似 Chrome 的菜单显示

> ID：11908908
> 
> 赞同：2
> 
> 时间：2012-08-10T20:37:49.060
> 
> 标签：android, android-layout, options-menu

我正在尝试查找有关如何创建一个看起来像 Android 版 chrome 菜单顶部的菜单的信息。我尝试过为 Android 4.0 实现图标，但没有运气。尝试了谷歌搜索，但我唯一找到的答案是当 API >= 11 时无法实现图标。

那么 Chrome 是如何做到的呢？它专为 4.0+ 的设备而设计！

![在此处输入图像描述](../Images/0479f593c5786580cf49512803d3fe15.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T05:59:15.370

使用弹出列表窗口来实现这一点。由于您可以将页眉和页脚添加到任何列表，您可以创建一个带有后退和星号选项的线性布局。将该视图添加到弹出窗口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-27T09:01:31.453

任何`ListView`都可以与 关联`HeaderViewListAdapter`，使用它您可以将单独的布局作为页眉和/或页脚附加到您的列表视图。

正如[Vinodkumar](https://stackoverflow.com/a/12085581/408150)所说，您也可以使用`ListPopupWindow`with `HeaderViewListAdapter`s。

在 Android 参考中：[HeaderViewListAdapter](http://developer.android.com/reference/android/widget/HeaderViewListAdapter.html)和[ListPopupWindow](http://developer.android.com/reference/android/widget/ListPopupWindow.html)

# webview - 在 Basic4Android 中显示基本网页？

> ID：11908914
> 
> 赞同：1
> 
> 时间：2012-08-10T20:38:04.863
> 
> 标签：webview, basic4android

我到处寻找广告，只是找不到一个好的答案。我到处找，但一无所获也阅读了所有的 html 和 webview 教程。所以我所做的是我在basic4android中有一个新项目。我想要做的就是显示一个全屏的网页。我尝试了许多不同的代码，我在[这里找到了一个](http://www.basic4ppc.com/forum/basic4android-updates-questions/10465-how-display-website.html)有意义但仍然不适合我的代码。**但是有没有人可以告诉我如何在 Basic4Android 中显示一个基本网页？？？**

```
Sub MyOfficeWeb
  Dim myw As WebView
  myw.Initialize("myw")
  Activity.AddView(myw, 0, 0, 100%x, 100%y) 'Your options for size here
  myw.LoadUrl("http://www.yourwebsite.com")
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T09:56:02.387

它对我很好。这是我的完整代码：

```
Sub Process_Globals
End Sub

Sub Globals
End Sub

Sub Activity_Create(FirstTime As Boolean)
  MyOfficeWeb
End Sub

Sub MyOfficeWeb
  Dim myw As WebView
  myw.Initialize("myw")
  Activity.AddView(myw, 0, 0, 100%x, 100%y) 'Your options for size here
  myw.LoadUrl("http://www.stackoverflow.com")
End Sub

Sub Activity_Resume
End Sub

Sub Activity_Pause (UserClosed As Boolean)
End Sub 
```

# objective-c - 子类可以访问此方法吗？

> ID：11908915
> 
> 赞同：0
> 
> 时间：2012-08-10T20:38:09.013
> 
> 标签：objective-c, subclass, class-method

这是类中的类方法代码的一部分`BNRItem`，它返回一个`id`对象。作者写道，分配时要使用关键字self，这样子类也可以访问该方法。但是子类不会因为它返回一个类型的对象而无法使用这个方法`BNRItem`吗？你能告诉我我在这里缺少什么吗？;p

```
BNRItem *newItem = [[self alloc] initWithItemName:randomName
                                   valueInDollars:randomValue
                                     serialNumber:randomSerialNumber];
return newItem; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:42:27.810

Self 是指调用该方法的实际类。如果子类重写了这个方法，self 就不再引用 BNRItem，而是引用子类本身。

# php - 根据现有十六进制值列表确定最接近的十六进制颜色

> ID：11908918
> 
> 赞同：3
> 
> 时间：2012-08-10T20:38:15.440
> 
> 标签：php, colors

我有两个数组，一个数组包含将使用的十六进制颜色值，而另一个数组包含冗余的十六进制值，需要与参考数组匹配，并将其值更新为参考的索引。

例如，这是我将要检查的参考的示例（缩短版）。

```
$ref_array = array(4 => '000000', 66 => 'C31AOC', 162 => 'AD2823'); 
```

这是需要尽可能接近参考匹配的数组。

```
$orig_array = array('1' => '2be944', 2 => '2f3136', 3 => '88110d'); 
```

他们不是 orig_array 不是为了反对 ref_array。

我不确定这在 PHP 中是否可行，但假设 orig_array 中的第一个元素是绿色，并且在参考数组中最接近的颜色是 2be944，因此将为该示例创建一个新数组，如下所示：

```
$new_array('2be944' => 4) 
```

它保存 orig_array 的索引值

我将如何做到这一点或类似的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-10T21:01:24.137

除了对此事的科学方法...

请记住，十六进制颜色代码由三个 2 位十六进制数字（RGB 值）组成！所以你不能一次全部完成，因为前两位数字会增加你的十进制值太多）......

这就是我将如何做到的。

您可以将颜色代码分成 3 个部分：

*   R = 2B --> 43 十进制
*   G = E9 --> 233 十进制
*   B = 44 --> 68 十进制

然后，您可以将每种颜色与参考进行比较（也将它们分成 R/G/B）。

如果您添加差异，则组合差异最小的那个应该提供接近的颜色相似性......

虽然，正如黄昏已经提到的，颜色感知是一个主观问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-10T21:05:24.080

有几种方法可以做到这一点。您需要一个函数来查找 2 个十六进制值之间的值差异。您可以随心所欲地实现它。将其转换为十进制以查找差异可能更容易。如果您的数组尚未根据十六进制值排序，那么您可以做的是获取数组的每个值并比较它并将差异和索引存储在 2 个变量中。遍历数组并将该值与数组中的每个值进行比较，每当您发现差异小于存储在变量中的差异时，您应该使用新的较小差异更新临时索引和差异变量。这不是很有效，因为它需要您遍历整个数组。

例如，在这个列表中：`0 1 4 8 13 19`如果你想找到哪个数字的值最接近这个数字，`10`那么你需要做的就是找到 10 适合该列表的位置，然后将它与之前和之后的元素进行比较，你就会有你的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:43:08.590

有多种方法可以测量两种颜色的“差异”。哪些比其他更“正确”是一种主观问题。

[维基百科在色差](http://en.wikipedia.org/wiki/Color_difference)下有一篇关于此事的文章。准备让你的头有点旋转。

# python - Python解析日志文件实时提取事件

> ID：11908919
> 
> 赞同：7
> 
> 时间：2012-08-10T20:38:24.957
> 
> 标签：python, linux, logging

我有一个将消息记录到文件的进程。

我想实现另一个进程（在 Python 中）来解析这些日志（因为它们被写入文件），过滤我感兴趣的行，然后根据第一个进程的状态执行某些操作。

在我继续自己编写一些东西之前，我想知道是否有 Python 中的库可以做这样的事情。

此外，关于如何实现类似 Python 的想法将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-10T21:10:13.617

C 程序通常会寻找当前位置以清除任何“文件结束”标志。但正如[@9000 正确指出的那样](https://stackoverflow.com/a/11909244/1468366)，python 显然会处理这个问题，因此即使它已到达文件末尾，您也可以重复读取同一个文件。

不过，您可能需要处理不完整的行。如果您的应用程序将其日志写入片段，那么您要确保处理整行，而不是那些片段。下面的代码将实现这一点：

```
f = open('some.log', 'r')
while True:
    line = ''
    while len(line) == 0 or line[-1] != '\n':
        tail = f.readline()
        if tail == '':
            time.sleep(0.1)          # avoid busy waiting
            # f.seek(0, io.SEEK_CUR) # appears to be unneccessary
            continue
        line += tail
    process(line) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-10T21:05:49.633

无需运行`tail -f`。普通的 Python 文件应该可以工作：

```
with open('/tmp/track-this') as f:
  while True:
    line = f.readline()
    if line:
      print line 
```

这东西的工作原理几乎一模一样`tail -f`。通过在另一个终端中运行来检查它：

```
echo "more" >> /tmp/track-this
# alt-tab here to the terminal with Python and see 'more' printed
echo "even more" >> /tmp/track-this 
```

`/tmp/track-this`在运行 Python 代码段之前不要忘记创建。

解析和采取适当的行动取决于你。可能应该在单独的线程/进程中执行长时间的操作。

停止条件也取决于您，但`^C`可以正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T21:12:51.727

谢谢大家的回答。我也发现了这个。 [http://www.dabeaz.com/generators/follow.py](http://www.dabeaz.com/generators/follow.py)

# javascript - 用剩余空间截断字符串

> ID：11908923
> 
> 赞同：0
> 
> 时间：2012-08-10T20:38:56.457
> 
> 标签：javascript, jquery

我有一个列表，其中每个 li 元素在一个 div "main" 中包含两个 div：

*   div "main" 有一个固定的宽度（比如 200px），

*   div "part1" 具有可变宽度（包含的文本和图像的宽度）

=> 我希望 div "part2" 中的文本的宽度与 div "main" 减去 div "part1" 的宽度相同（剩余空间）

前任：

```
...
<li>
   <div class="main">   
          <div class="part1">A</div>
          <div class="part2">BlaBlaBla</div>
   </div>   
</li>
<li>
   <div class="main">   
          <div class="part1">ABC</div>
          <div class="part2">BlaBlaBla</div>
   </div>   
</li>
<li>
   <div class="main">   
          <div class="part1">ABCDE</div>
          <div class="part2">BlaBlaBla</div>
   </div>   
</li>
... 
```

它应该显示：

```
A BlaBla...
ABC BlaB...
ABCDE Bl... 
```

我试过但它不起作用：

```
$(function(){
  $(".part1").each(function(){
    var $this = $(this);
    var $len = 0;
    var $len = $this.outerWidth();
    var $lenParent =$this.parent().outerWidth();        
    var newText2 = $this.next('.part2').text().substring(0,$lenParent-$len); 
    $this.next('.part2').innerHtml(newText2+"...");
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:42:09.370

你不需要 JavaScript，它可以用样式来完成。将 part1 和 part2 的 css 更改为 display:inline

```
.part1,.part2
{
    display:inline;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:55:17.847

现在可以使用这个完整解决方案所建议的`display: inline`of`Thinking Sites`的答案和椭圆样式：`epascarello`

```
.main{
    width: 100px;
    border: 1px solid red;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;
}

.part1, .part2{
    display: inline;
} 
```

见[**演示**](http://jsfiddle.net/FranWahl/2PAJG/2/)

# hadoop - 从 Windows 使用 java 访问 HDFS

> ID：11908925
> 
> 赞同：1
> 
> 时间：2012-08-10T20:38:59.270
> 
> 标签：hadoop, hdfs

我有一个 Cloudera Hadoop 安装，我想编写一个 Java 程序来从 Windows 机器上的文件系统读/写。这应该可能吗？

我的程序很简单：

```
public class HadoopReader {
static {
    URL.setURLStreamHandlerFactory(new FsUrlStreamHandlerFactory());
}

public static void main(String[] args) throws Exception {
    System.out.println("okay");
    InputStream in = null;
    try {
        in = new URL("hdfs://HOST/PATH").openStream();
        IOUtils.copyBytes(in, System.out, 4096, false);
    } finally {
        IOUtils.closeStream(in);
    }
}
} 
```

但我收到此错误：

```
Exception in thread "main" java.lang.StackOverflowError
at java.net.URLStreamHandler.parseURL(Unknown Source)
at sun.net.www.protocol.file.Handler.parseURL(Unknown Source)
at java.net.URL.<init>(Unknown Source)
at java.net.URL.<init>(Unknown Source)
at sun.misc.URLClassPath$FileLoader.getResource(Unknown Source)
at sun.misc.URLClassPath$FileLoader.findResource(Unknown Source)
at sun.misc.URLClassPath$1.next(Unknown Source)
at sun.misc.URLClassPath$1.hasMoreElements(Unknown Source)
at java.net.URLClassLoader$3$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader$3.next(Unknown Source)
at java.net.URLClassLoader$3.hasMoreElements(Unknown Source)
at sun.misc.CompoundEnumeration.next(Unknown Source)
at sun.misc.CompoundEnumeration.hasMoreElements(Unknown Source)
at java.util.ServiceLoader$LazyIterator.hasNext(Unknown Source)
at java.util.ServiceLoader$1.hasNext(Unknown Source)
at org.apache.hadoop.fs.FileSystem.loadFileSystems(FileSystem.java:2117)
at org.apache.hadoop.fs.FileSystem.getFileSystemClass(FileSystem.java:2128)
at org.apache.hadoop.fs.FsUrlStreamHandlerFactory.createURLStreamHandler(FsUrlStreamHandlerFactory.java:66)
... 
```

我正在使用 Cloudera 4 的“源”下载中的 jars（以前，我下载了旧版本的 Hadoop，虽然 URL 似乎解析得很好，但版本不匹配）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-26T08:35:05.033

尝试

```
 Configuration conf = new Configuration();
    confVirtual.set("fs.default.name", "hdfs://ip:port");
    confVirtual.set("mapred.job.tracker", "hdfs://ip:port");
    FileSystem fs = FileSystem.get(conf); 
```

通过这种方式访问​​你的 HDFS 集群后，你可以通过 FSDataOutputStream/FSDataInputStream 类进行读/写操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T18:19:44.997

您应该使用 hadoop FileSystem 类。IOUtils 与 hadoop 无关，您正在做的事情无法正常工作。

看看这个方法[Path.getFileSystem](http://hadoop.apache.org/common/docs/r0.20.2/api/org/apache/hadoop/fs/Path.html#getFileSystem%28org.apache.hadoop.conf.Configuration%29)

将 hadoop core-site.xml 与您要连接的 hdfs 文件系统 url 一起使用。理想情况下，从 hdfs 本身的 Namenode 获取此 xml 的副本。把它放在你的类路径中，你就可以使用所有的 hdfs 客户端 api。

# amazon-s3 - 使用 AWS S3 访问日志来跟踪下载

> ID：11908930
> 
> 赞同：3
> 
> 时间：2012-08-10T20:39:13.957
> 
> 标签：amazon-s3

我们正在尝试使用 S3 访问日志来跟踪文件的下载。如果一些日志条目丢失，我们可以接受。我们试图弄清楚如何处理 206 HTTP 状态码。由于它没有获得完整的文件，我们不能将其算作下载。但我们也不能打折，因为它是下载的一部分。有谁知道如何去做？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T19:35:41.767

Amazon S3 日志不包含任何标记文件下载请求完成的内容。

解决方法：在引用标头中添加对文件请求唯一的随机 ID。Amazon 在 S3 日志中记录引用者标头。Total downloads 是随机 ID 的总数，其中发送的字节总数大于或等于发送的字节数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-29T20:34:09.357

我的想法是计算发送的字节数，然后除以应该知道的对象大小。有人看到这种方法有问题吗？

# javascript - 弹出第二个 Visualforce/Apex 页面后返回 Visualforce/Apex

> ID：11908931
> 
> 赞同：1
> 
> 时间：2012-08-10T20:39:19.107
> 
> 标签：javascript, salesforce, apex-code, visualforce

我希望能够在离开特定的 visualforce 页面后返回它。

程序如下：
1) 代表将出现在 visualforce 页面上，然后单击将向他们展示案例的按钮。
2）用户决定他们不能工作，所以他们点击我创建的称为返回队列的javascript按钮。这只是弹出的另一个 visualforce 页面。
3）这会弹出一个visualforce页面，让他们输入原因并单击保存。
4) 我希望在此处加载原始的 visualforce 页面。

你如何从弹出的visualforce页面开始？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-11T15:39:28.007

尝试使用它从弹出窗口中重新定位父窗口：

对于自定义 Visualforce 页面：

```
window.opener.location = '/apex/yourCustomPageName'; 
```

对于标准 Salesforce 页面布局：

```
window.opener.location = '/' + standardPageId; 
```

# c# - IEnumerable<> 返回 null

> ID：11908932
> 
> 赞同：1
> 
> 时间：2012-08-10T20:39:26.720
> 
> 标签：c#, asp.net, asp.net-mvc, model, ienumerable

我在我的代码中返回一个空值：**（var cat 行）**

```
public class CategoryItemsViewModel
{
    public ICategoriesRepository categoriesRepository;

    public IEnumerable<Categories> GetCategories()
    {
        var cat = categoriesRepository.Categories;

        return cat;

    }
} 
```

这是界面：

```
namespace SportsStore.Domain.Abstract
{
    public interface ICategoriesRepository
    {
        IQueryable<Categories> Categories { get; }
        void SaveCategory(Categories category);
        void DeleteCategory(Categories category);
    }
} 
```

这是课程：

```
namespace SportsStore.Domain.Entities
{
    public class Categories
    {
        [Key]
        public int CategoryID { get; set; }
        public string CategoryName { get; set; }
    }

} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:58:28.600

到目前为止，您所拥有的一切都很好-只是不完整。

您也不需要其他人建议的二传手——事实上，在这种情况下，最好不要二传手。

您确实需要接口 ICategoriesRepository 的具体实现，例如：

```
public class CategoriesRepository : ICategoriesRepository
{
    private readonly ModelContainer db= new ModelContainer();

    public IQueryable<Categories> Categories 
    { 
        get
        {
            return this.db.Categories;
        }
    }

    public void SaveCategory(Categories category)
    {
        // TODO
    }

    public void DeleteCategory(Categories category)
    {
        // TODO
    }
} 
```

然后您需要在视图模型中添加一行：

```
public class CategoryItemsViewModel
{
    public ICategoriesRepository categoriesRepository;

    public IEnumerable<Categories> GetCategories()
    {
        // This is to instantiate your repository.  It may be a better idea to do this
        // when it is declared, above.
        categoriesRepository = new CategoriesRepository();

        var cat = categoriesRepository.Categories;

        return cat;

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:42:36.710

您没有对对象`null`中的`Categories`属性进行任何设置`ICategoriesRepository`，并且您不能使用给定的接口设置任何内容。您有一个带有自动 getter 和 no setter 的属性。这意味着它永远只能返回`null`。如果有一个设置器（公共或私有），那么您可以将*它*设置为其他东西。（您还需要有一行代码来实际执行此操作。）您还可以使用自定义 getter，它实际上返回的内容不仅仅是支持字段。（这对于派生数据很常见。）

# php - 访问使用 php 动态创建的数组

> ID：11908937
> 
> 赞同：0
> 
> 时间：2012-08-10T20:39:52.547
> 
> 标签：php, arrays

在执行期间，所有错误都保存到这样的数组中：

```
$this->errors[$section] = $e->getMessage(); 
```

问题是，在执行之后，我必须发布所有部分，包括那些尝试与错误连接的错误的部分。当我尝试：

```
echo $this->errors[$section]; 
```

这是我得到的警告：

```
Warning: Illegal offset type in .... 
```

[动态访问 PHP 数组](https://stackoverflow.com/questions/3235632/dynamic-access-to-a-php-array)中描述的解决方案没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:45:18.633

如果您还没有设置`$section`，那么 PHP 将不知道要返回什么。

假设您的部分是具有某种 ID 号或字符串的数组：

```
$errors[$section['id']] = $e->getMessage();
...
foreach($errors as $error){
    print_r($error);
} 
```

我有一种感觉，您的问题在于 $section 不再设置为您在第二个代码块中想要的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:42:12.990

使用前检查索引是否有效：

```
if (array_key_exists($section, $this->errors) ) { 
    echo $this->errors[$section]; 
} 
```

# php - 如何正确使用 parseJSON？

> ID：11908940
> 
> 赞同：0
> 
> 时间：2012-08-10T20:40:01.727
> 
> 标签：php, javascript, mysql, json

> **可能重复：**
> [如何将 json 字符串发送回 jquery](https://stackoverflow.com/questions/10454516/how-to-send-a-json-string-back-to-jquery)

我需要运行**myquery.php**，然后我需要在 JavaScript 函数**createChartControl**中使用这个 php 代码的输出。下面是我的完整代码。`alert(returned_array)`问题是没有出现Alert 消息 ( )，并且函数**createChartControl**没有执行。我单独测试**了 myquery.php**，它工作正常。

```
<script>
function updateList(){
    $.ajax({
        url: "myquery.php",
        type: 'GET',  
        data: { query: "SELECT tm FROM schedule WHERE val='BT009';" }, 
        dataType: 'json',
        success: function (data) { 
                 var returned_array = $.parseJSON(data);
                 alert(returned_array);
                 createChartControl('schedule', returned_array);
        }
   })
}

$(document).ready(function() {
    updateList();
});
</script>

<script type="text/javascript" language="JavaScript">
function createChartControl(htmlDiv1,data)
{
//...
}
</script>

<?php
include_once 'include/connect_db.php';

    $query = $_GET['query'];    

    $condb = connectDB();
    $result=execute_query($query);
    closeDB($condb);

    $rows = array();

    while($row = mysql_fetch_array($result)) {
            $rows[] = $row['tm'];
    }   

    return $rows;
?> 
```

**更新**：仍然说：你的 ajax 刚刚失败

```
function updateList(){
   $.ajax({
          url: 'myquery.php',
          type: 'POST',
          data: {'query': "SELECT tm FROM schedule WHERE val='BT009';" }
        }).done(function(data) {
           console.log(data);
//         createChartControl('schedule', returned_array);
        }).fail(function() {
           console.log('Your ajax just failed');
    });
} 
```

**我的查询.php**

```
<?php
include_once 'include/connect_db.php';

if (isset($_POST['query'])) {
    $query = $_POST['query'];   

    echo($query);

    $condb = connectDB();
    $result=execute_query($query);
    closeDB($condb);

    $rows = array();

    if ($result && mysql_num_rows($result)) {
        while($row = mysql_fetch_array($result)) {
            $rows[] = $row['tm'];
        }
    }   

    echo json_encode($rows);
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:42:34.050

答案是您不在这种情况下使用它。如果您`dataType: 'json'`在 jQuery AJAX 调用上指定，它会自动将响应解析为 JSON。

如果解析成功（服务器返回有效的 JSON），则将结果对象传递给`success`回调函数。如果解析失败，`error`则执行回调函数（如果已指定）。

# php - 根据内容中的日期获取最后几周的 MySQL 行

> ID：11908944
> 
> 赞同：0
> 
> 时间：2012-08-10T20:40:16.243
> 
> 标签：php, mysql, sql, date

我想根据表行中的日期从我的 MySQL 表中获取前 N 周的数据。

想象一下，当前周是第 30 周，我的行中包含第 29、28、26 和 12 周的数据。

如果我想要基于今天日期的最后两周行，那很容易，但我希望它基于行上的时间戳。

因此，如果 N = 2，我想要第 29 周和第 28 周的所有行。如果 N = 3，我想要第 29 周、第 28 周和第 26 周，无论我在哪一周获取它。

我可以使用 PHP 并根据估计的输出进行猜测，但也许我可以利用一些 MySQL 功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T21:03:32.637

一种方法是使用查询获取您想要返回的周集，然后将该查询用作您可以加入的内联视图。

像这样的东西：

```
SELECT t.*
  FROM (SELECT s.week FROM tab s GROUP BY s.week ORDER BY s.week DESC LIMIT 3) r
  JOIN tab t
    ON t.week = r.week 
```

内联视图（别名为`r`）获取表中最近 N 个周值的列表。（这假设 week 列是可排序的，就像它是一个整数一样。

它连接到表中，使用 ON 子句将表返回的行限制为那些周值与内联视图返回的行匹配的行。

**注意：**列上的索引`week`可以为大量行和`week`列上的高基数提供显着的性能优势。

**注意：**`IN (subquery)`对于大型表，执行 JOIN 操作与使用谓词之间可能存在性能差异，如下例所示。对于大多数大型集合以及我所做的查询，我发现 JOIN 通常执行得更好。但是您可能想同时测试两者，看看哪个更适合您。（在小桌子上，这两种方式都不重要；性能差异在真正的大桌子上变得显着。）

```
SELECT t.*
  FROM tab t
 WHERE t.week
    IN (SELECT s.week FROM tab s GROUP BY s.week ORDER BY s.week DESC LIMIT 3) r 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T20:46:28.383

尝试这样的事情（代码未测试）：

```
SELECT ... FROM table WHERE week IN (
    SELECT DISTINCT week FROM table ORDER BY weeks DESC LIMIT 3
) 
```

基本上，只需使用`DISTINCT`关键字来获取数据库中实际存在的周的列表，然后使用`ORDER BY ... DESC LIMIT 3`来获取最近的三个周。

我在一个子查询中执行此操作，以便您可以将其用作 PHP 中的一次调用，而不是调用数据库，在 PHP 中解析，然后重新提交，这样 MySQL 通常会执行得更快。

# canvas - 如何实现单个画布缩放/平移

> ID：11908947
> 
> 赞同：1
> 
> 时间：2012-08-10T20:40:31.400
> 
> 标签：canvas, zooming, pan

我有一个画布元素（填充手动制作的像素值，而不是现有图像），我想在该画布上实现缩放/平移控件，是否有任何现有的库可以做到这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T14:57:45.410

您可能不会找到*仅*专门解决缩放和平移的库，但如果您使用通用画布库，例如[EaselJS](http://www.createjs.com/#!/EaselJS)或[KineticJS](http://www.kineticjs.com/)，则很容易实现。

在这种情况下，您可以有一个代表“视口”（您添加到 DOM 的画布）的画布，以及另一个代表“绘图”（可能比视口大）的画布。然后使用缩放因子和平移在视口画布中绘制“绘图”画布。然后可以通过鼠标交互来更改缩放和平移值，例如鼠标滚轮（或触摸设备的捏合）以及分别单击和拖动。

如果您使用库，您最终将编写更少的代码和更易读的代码。这些库使跟踪和操作画布中的“对象”变得更加容易。它们还简化了鼠标交互，因此我绝对建议您检查一下。

# wordpress - 创建没有管理菜单链接的 Wordpress 子菜单

> ID：11908948
> 
> 赞同：0
> 
> 时间：2012-08-10T20:40:42.507
> 
> 标签：wordpress

我正在开发一个插件。这是源代码：

```
add_action('admin_menu', 'hotel_bid_hook');
function hotel_bid_hook()
{
    add_submenu_page("edit.php?post_type=oteller","Hotel Bids", "Hotel Bids", "manage_options", "hotel-bids", "hotel_bid_page");
}
function hotel_bid_page() {
        // Displays a list of bids for hotels and an EDIT button for every bid
} 
```

如您所见，有一个列出所有出价的酒店出价页面。我也想再创建一页。此页面有一个用于编辑出价的 HTML 表单。我正在像这样修改我的源代码：

```
add_action('admin_menu', 'hotel_bid_hook');
function hotel_bid_hook()
{
    add_submenu_page("edit.php?post_type=oteller","Hotel Bids", "Hotel Bids", "manage_options", "hotel-bids", "hotel_bid_page");
    add_submenu_page("edit.php?post_type=oteller","Edit Hotel Bids", "Edit Hotel Bids", "manage_options", "edit-hotel-bid", "edit_hotel_bid");
}
function hotel_bid_page() {
        // Displays a list of bids for hotels and an EDIT button for every bid
        // Edit buttons will be like this : <a href="?page=edit-hotel-bid&hotelID=1">
}
function edit_hotel_bid()
{
   // HTML Web form
} 
```

但这一次，在**oteller** custom post type下有一个**Edit Hotel Bids**链接。

 **![在此处输入图像描述](../Images/c07538f16827393e42d0f6aeb299838b.png)

此处不应有“**编辑酒店出价**”链接。此页面将仅显示用户单击编辑按钮。我应该使用哪个功能而不是`add_submenu_page()`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:11:06.777

在这个问题上找到答案：[https ://wordpress.stackexchange.com/questions/1778/admin-config-screen-without-menu/1812#1812](https://wordpress.stackexchange.com/questions/1778/admin-config-screen-without-menu/1812#1812)**

# php - ajax从输入框中更新php变量而不提交

> ID：11908949
> 
> 赞同：-6
> 
> 时间：2012-08-10T20:40:47.667
> 
> 标签：php, ajax, variables, inputbox

所以我试图在输入框中输入一些我想动态存储在变量中的东西。然后在记录表旁边有一个超链接，它将采用此变量（.php?S=$inputboxvariable）并转到下一个 php 页面，该页面将使用此变量的值执行 sql 语句。

我不想在此提交、_GET 或 _POST 甚至 SESSION 变量。

请帮忙。我知道编码会有所帮助，但我不知道如何，只需一个基本代码就足够了。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:46:17.480

您不想使用 get、post 或 session 来传递变量，但您的示例使用了这个：

```
(.php?S=$inputboxvariable) 
```

这将使用 GET 传递变量。

如果你真的想避免使用这些，

1.  使用数据库来存储数据。

2.  使用文件来存储数据。

也许你可以告诉我你为什么要避免 get、post 或 session 变量，我会更好地理解你想要完成什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T21:09:33.787

好吧，我明白你现在的要求了。下面的 javascript 将从您的页面调用处理 SQL 的外部脚本 (ajax/myscripthere.php)。

在 php 脚本中，如果这不是 AJAX 调用，我们只需像往常一样处理我们的 SQL。

如果这符合您的期望，请接受答案:)

javascript:

```
<script>
    var xmlHttpReq = false;

    // Set ID Equal to your input box ID
    input_box_value = document.getElementById("inputboxvariable").value;

    if(window.XMLHttpRequest) {
        self.xmlHttpReq = new XMLHttpRequest();
    }
    else if(window.ActiveXObject) {
        self.xmlHttpReq = new ActiveXObject("Microsoft.XMLHTTP");
    }

    // Set filename equal to your PHP script
    self.xmlHttpReq.open('POST', "ajax/myscripthere.php", true);

    self.xmlHttpReq.onreadystatechange = function()
    {
        if(self.xmlHttpReq.readyState == 4)
        {
            // Update is complete
        }
    };

    self.xmlHttpReq.send("value="+input_box_value);
</script> 
```

PHP：

```
<?php
if(isset($_POST['value']))
{
    $conn = new mysqli("host", "username", "password", "db_name")
                 or die ('Error: '.mysqli_connect__error());

    // Make Correct SQL Query (i dont know your DB)
    $query = "UPDATE table_name SET col=".$_POST['value']." WHERE xxxxxx;";

    $result = @$conn->query($query);

    $conn->close();
?> 
```

# android - Android 应用程序在三星 Galaxy S3 上崩溃（内存不足错误）

> ID：11908956
> 
> 赞同：15
> 
> 时间：2012-08-10T20:41:34.097
> 
> 标签：android

我有一个 Android 应用程序可以拍摄一些照片，重新调整它们的大小并将它们发送到后端服务器。此应用程序在除三星 Galaxy S3 之外的所有其他手机（姜饼和冰淇淋三明治）上运行良好。每当它拍摄照片并尝试重新调整大小时，它就会耗尽内存。最初我认为这是调整大小部分的问题，我用 insamplesize 实现了位图对象并尝试了所有方法，但它仍然不断崩溃。然后我意识到，当应用程序一开始启动时，它会占用大量内存。在 HTC 和所有其他手机上，当我的应用程序启动时，它使用了大约 4 MB，但在 Galaxy S3 上，它使用了大约 30 MG - 几乎是 10 倍。我似乎无法弄清楚是什么导致它消耗了更多的内存。我正在正确回收所有对象和布局（我认为）。

```
public static void resizeImage(String pathOfInputImage,
        String pathOfOutputImage) {
    try {
        int inWidth = 0;
        int inHeight = 0;
        float factor;

        InputStream in = new FileInputStream(pathOfInputImage);

        BitmapFactory.Options options = new BitmapFactory.Options();
        options.inJustDecodeBounds = true;
        BitmapFactory.decodeStream(in, null, options);
        inWidth = options.outWidth;
        inHeight = options.outHeight;

        in.close();
        in = null;

        options = null;         

        if (inWidth > inHeight) {
            factor = (float) inHeight / 480;
        } else {
            factor = (float) inWidth / 480;
        }           
        options = new BitmapFactory.Options();

        Bitmap roughBitmap;

        if(Build.VERSION.SDK_INT < 12) {
            System.gc();
        }

        try
        {
            in = new FileInputStream(pathOfInputImage);
            options.inSampleSize = 4;
            roughBitmap = BitmapFactory.decodeStream(in, null, options);
        }
        catch (OutOfMemoryError e)
        {
                roughBitmap = Utils.fetchRoughBitmap(pathOfInputImage, factor);
            }
        finally
        {
            roughBitmap = Utils.fetchRoughBitmap(pathOfInputImage, factor);
            }

        in.close();
        in = null;

        boolean rotate = false;
        Bitmap rotatedBitmap = null;

        if (isNeedToRotate(pathOfInputImage)) {
            rotate = true;
            Matrix m = new Matrix();

            m.postRotate(90);
            try
            {
                rotatedBitmap = Bitmap.createBitmap(roughBitmap, 0, 0,
                        roughBitmap.getWidth(), roughBitmap.getHeight(), m,
                        true);
            }
            catch (OutOfMemoryError e)
            {
                rotatedBitmap = Bitmap.createBitmap(roughBitmap, 0, 0,
                        roughBitmap.getWidth()/2, roughBitmap.getHeight()/2, m,
                        true);
            }
        }

        if (rotate) {
            Utils.log(TAG, "Rotate Invoked :------->");
            int temp = inHeight;

            inHeight = inWidth;
            inWidth = temp;
        }

        options.inSampleSize = Math.round(factor);

        float dstWidth = (int) inWidth / factor;
        float dstHeight = (int) inHeight / factor;

        Bitmap resizedBitmap;
        if (rotate) {
            try
            {
                resizedBitmap = Bitmap.createScaledBitmap(rotatedBitmap,
                        (int) dstWidth, (int) dstHeight, true);
            }
            catch (OutOfMemoryError e)
            {
                resizedBitmap = Bitmap.createScaledBitmap(rotatedBitmap,
                        (int) dstWidth/2, (int) dstHeight/2, true);
            }

        } else {

            try
            {
                resizedBitmap = Bitmap.createScaledBitmap(roughBitmap,
                    (int) dstWidth, (int) dstHeight, true);
            }
            catch (OutOfMemoryError e)
            {
                resizedBitmap = Bitmap.createScaledBitmap(roughBitmap,
                        (int) dstWidth/2, (int) dstHeight/2, true);
            }
        }

        try 
        {
            FileOutputStream out = new FileOutputStream(pathOfOutputImage);
            resizedBitmap.compress(Bitmap.CompressFormat.PNG, 80, out);
        }
        catch (Exception e) {
            Utils.log("Image", e.getMessage() + e);
        }

        //Free up the memory.
        roughBitmap.recycle();
        resizedBitmap.recycle();

        if (rotatedBitmap != null) {
            rotatedBitmap.recycle();
        }

    } catch (IOException e) {
        Utils.log("Image", e.getMessage() + e);
    }
}

private static Bitmap fetchRoughBitmap(String pathOfInputImage, float factor)
{
    Bitmap roughBitmap = null;
    try
    {
        FileInputStream in = new FileInputStream(pathOfInputImage);
        BitmapFactory.Options options = new BitmapFactory.Options();
        options.inSampleSize = Math.round(factor);
        roughBitmap = BitmapFactory.decodeStream(in, null, options);
        return roughBitmap;
    }
    catch (OutOfMemoryError mem_error)
    {
        return Utils.fetchRoughBitmap(pathOfInputImage, factor+1);
    }
    catch (FileNotFoundException e)
    {
        //return Utils.fetchRoughBitmap(pathOfInputImage, factor+1);
        return roughBitmap;
    }
} 
```

这段代码运行良好，因为我通过递归循环运行它，直到它没有耗尽内存，但我得到的图像只有大约 300x300 像素，我需要它至少为 640x480。我的问题是：

1.  谁能告诉我为什么 Galaxy S3 在首次加载我的应用程序时使用高达 90% 的内存，而不是 HTC 手机上的 60%。
2.  在重新调整大小的代码中是否有任何错误导致我的应用程序内存不足。

任何帮助将不胜感激，因为我已经在这个问题上花了 3 天时间:-(。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-07T05:29:59.260

嗯...我知道这是一个老问题了，但这就是我的想法。

Galaxy S3 使用 xhdpi 密度，因此在启动时分配更大的堆大小，（据我所知，32mb）

但是如果您的 res 目录中没有任何 xhdpi 资源，那么它将调用 drawable 中的任何默认图像或从最接近 xhdpi 密度的 hdpi 调用任何默认图像。

然后它将扩展图像以适应其需要，并且在此阶段扩展图像将占用大量内存，（可能）导致内存不足问题。

您可以通过启用**[屏幕兼容模式](http://developer.android.com/guide/practices/screen-compat-mode.html)**来解决此问题，或者您可以创建（如果默认情况下不存在）drawable-xhdpi，为 xhdpi 设备（如 Galaxy S3 ）提供**[适当的资源。](http://developer.android.com/guide/practices/screens_support.html)**

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-10-31T19:26:59.093

哇。数周以来，我们一直在努力解决 S3 上的内存不足问题。最后，应用了该线程中的一种技术。

在我们的应用程序中，我们让 drawable-hdpi 拥有应用程序的所有图像。在大多数手机上，我们没有问题。在 S3 上，该应用程序将占用 2 倍的内存，然后遇到内存不足的问题。

我刚刚创建了与 drawable-hdpi 文件夹具有相同内容的 drawable-xhdpi 文件夹并在 S3 上运行它。立即注意到内存占用是 1/2，并且没有内存不足的问题。

这是一次令人沮丧的经历。希望其他人知道寻找这个线程并节省数小时的调试时间。

谢谢

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-11T20:09:38.157

我自己解决了这个问题。内存不足的应用程序不必对上述代码执行任何操作。我添加了 MAT，我看到位图对象从以前的视图中保持活动状态。所以我从视图中删除了图形，它解决了内存问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T01:37:42.070

```
I overwrote the onDestroy method and added the following line: layout.setBackgroundDrawable(null);. Please let me know if this worked or didn't work for you. 
```

– 用户881148

酷，它对我有用......在布局上添加了一些背景图片。从位图转换后，我不使用 BitmapDrawables 或 Bitmap，而是使用 Drawables。

```
Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.drawable.outerspace);
Drawable bitDraw = new BitmapDrawable(getResources(), bitmap);

main.setBackgroundDrawable(bitDraw); 
```

我的问题是正在使用 S3 的所有设备（这很烦人）。但该应用程序现已启动并运行！谢谢...user881148

# c# - 使用 Office 15 和 VS 2012 C# 创建 Excel 工作簿

> ID：11908961
> 
> 赞同：1
> 
> 时间：2012-08-10T20:41:53.603
> 
> 标签：c#, office-interop, visual-studio-2012

我试图创建一个新的 Excel 工作簿，但它不起作用。我将 Visual Studio 2012 与 .Net Freamework 4.5 和 Microsoft Office 15 一起使用。

我在看这些文章：

[http://csharp.net-informations.com/excel/csharp-excel-tutorial.htm](http://csharp.net-informations.com/excel/csharp-excel-tutorial.htm)

[http://www.codeproject.com/Articles/248531/Export-Excel-File-for-Csharp](http://www.codeproject.com/Articles/248531/Export-Excel-File-for-Csharp)

如果我尝试创建一个`new ApplicationClass("ApplicationClass xlsApp = new ApplicationClass();")`，我会收到此错误：

> “无法嵌入 Microsoft.Office.Interop.Excel.ApplicationClass'。请改用适用的界面。”

我用`Microsoft.Office.Interop.Excel`.

你知道解决办法吗？先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:43:46.357

正如错误明确指出的那样，

> 请改用适用的接口。

写`new Application()`。
即使`Application`是一个接口，编译器也会将其转换为适当的 COM 激活码。

该错误是由嵌入式 PIA 引起的；禁用它（在参考属性中）也将修复它。

# jquery - JSON jQuery 问题：未捕获的 SyntaxError：意外令牌：

> ID：11908971
> 
> 赞同：1
> 
> 时间：2012-08-10T20:42:34.410
> 
> 标签：jquery, json

我正在编写一个 jQuery 调用来从 memegenerator.net API 检索 JSON 数据。但是，使用下面的代码，每当我在 Chrome 中测试它时，我都会得到一个*Uncaught SyntaxError: Unexpected token :错误。*我尝试删除回调=？这引发了另一个错误。

每当我直接访问 URL 时，它都会返回正常。

JSFiddle 中的 JSLint 将返回的 JSON 声明为有效。

关于如何使这个电话成功的任何想法？

```
<script>
$(document).ready(function() {
    $.ajax({
        type: 'GET',
        url: 'http://version1.api.memegenerator.net/Instances_Select_ByNew?languageCode=en&pageIndex=0&pageSize=12&urlName=Insanity-Wolf?callback=?',
        dataType: 'json',
        success: function() {
            console.log('Success!');
        },
        error: function() {
            console.log('Uh Oh!');
        }
    });
});​      
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T20:47:34.447

听起来像是跨域错误。`jsonp`如果不使用服务器上的代理脚本，则不能使用 ajax 从域以外的域请求内容。（如果使用 php，它将是一个[cURL 请求](http://php.net/manual/en/book.curl.php)）

[在ajax 文档页面](http://api.jquery.com/jQuery.ajax/)上查找 jsonp

卷曲请求：

```
$cURL = curl_init();
curl_setopt($cURL, CURLOPT_URL, 'http://version1.api.memegenerator.net/Instances_Select_ByNew?languageCode=en&pageIndex=0&pageSize=12&urlName=Insanity-Wolf');
curl_setopt($cURL, CURLOPT_HEADER, 0 );
curl_setopt($cURL, CURLOPT_SSL_VERIFYPEER, false );
curl_setopt($cURL, CURLOPT_SSL_VERIFYHOST, false );
curl_setopt($cURL, CURLOPT_RETURNTRANSFER, true);
$output = curl_exec($cURL);
curl_close($cURL);
echo $output;
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:50:14.490

由于浏览器安全限制，大部分“Ajax”请求都受同源策略的约束；请求无法从不同的域、子域或协议成功检索数据。你需要jsonp。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T20:51:19.327

该 api 要么不支持 JSONP，要么正在寻找与`callback`.

另外，您的网址应该是

```
http://version1.api.memegenerator.net/Instances_Select_ByNew?languageCode=en&pageIndex=0&pageSize=12&urlName=Insanity-Wolf&callback=? 
```

注意`&`代替`?`

此外， dataType 应该是`"jsonp"`

# android - 我如何将 Bitmap 或 Drawable 从一个 Activity 传递到另一个？

> ID：11908978
> 
> 赞同：0
> 
> 时间：2012-08-10T20:42:47.590
> 
> 标签：android, android-intent, bitmap

我想将 Bitmap 或 Drawable 从一个 Activity 传递给另一个，现在我正在这样做：

```
 EventPhoto photo = (EventPhoto) parent.getItemAtPosition(position);

            BitmapDrawable test = (BitmapDrawable) photo.getDrawable();
            Bitmap bitmap = test.getBitmap();
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            bitmap.compress(Bitmap.CompressFormat.PNG, 0, baos); 
            byte[] b = baos.toByteArray();

            Intent intent = new Intent(EventDetailActivity.this, ImageExpandActivity.class);
            System.out.println(b.length); //B LENGTH = 908k
            intent.putExtra("image",b);
            startActivity(intent); 
```

我的问题是当我尝试使用 putExtra 时，他没有发送任何异常，什么也没有，但没有响应并且 Android 杀死应用程序，为什么会发生这种情况？我正在考虑它的大小，因为当我传递一个小图像时一切正常。

我正在寻找并找到一些这样的解决方案：[如何将位图从一个活动传递到另一个活动，](https://stackoverflow.com/questions/8255123/how-to-pass-bitmap-from-one-activity-to-another) 但我想使用 putExtra，有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:31:08.967

如果您只是暂时需要这些数据，我不会去光盘（文件、数据库等）。我会采用你同样的方法。

你有几个选择。只需选择更适合您的应用程序的内容即可。

*   公共静态类，在您的代码中始终可用。这种助手可以方便地管理诸如共享偏好或您可能需要在那里的一些全局信息之类的事情

*   [Singleton](http://www.roseindia.net/java/beginners/SingletonPattern.shtml)，这个模式和前一个非常相似。主要区别在于，在这种情况下，您只有一个类的实例（在静态中没有实例，只是访问变量和方法）。每当您在应用程序的整个生命周期中需要任何参考实例时，此模式都会很有帮助。

*   扩展应用。这比其他两个更进一步。您有一个在整个生命周期中可用的应用程序实例。通常你可能想在那里管理一些其他的东西，比如推送、错误通知、服务等。[示例](https://github.com/JlUgia/ants_approach/blob/master/src/ugia/ants/application/AntsApplication.java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T12:43:12.423

好吧，我找不到任何不同的解决方案，所以我解决了这个问题： [如何将位图从一个活动传递到另一个活动](https://stackoverflow.com/questions/8255123/how-to-pass-bitmap-from-one-activity-to-another)

我之前给出的带有静态属性的相同链接：

```
public static Bitmap getBitmap(){
   return bitmap;
} 
```

# java - 单身人士适合这种设计吗？

> ID：11908982
> 
> 赞同：0
> 
> 时间：2012-08-10T20:43:15.597
> 
> 标签：java, design-patterns, singleton

我的模型已经实现，我正在研究一个视图。

我有一个名为 Helper 的类，它是我的控制器的一部分。Helper 类的目的是包含模型的“主副本”。其他类将调用 Helper 方法来请求它们自己的模型副本（整个或特定部分）。Helper 也是唯一应该允许对模型进行更改的类。

我正在处理的视图包含一个名为 DrawingPanel 的 JPanel。DrawingPanel 的 paint() 方法被覆盖，以便在绘制自身之前从 Helper 检索模型。

将 Helper 类实现为单例是实现此目标的最佳方式，还是有更好/更简单/更优雅的方式来实现我的目标？

我想我也应该提前知道我的 Helper 作为单例实现是否需要线程安全。gui 是在 Swing 中设计的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T22:33:37.633

至于大写-S“Singleton”是否合适……问问自己这个……

> 第二次实例*肯定会导致我的程序死亡*吗？

（我的意思是“确定”和“死亡”。不仅仅是“可能”......而且不仅仅是关于哪个实例是“官方”实例的一些混淆。如果程序崩溃，内爆，打开虫洞，放火你的狗等*完全由于第二个实例的存在*，答案是“是”。如果你不确定，假设“否”，直到你有充分的证据。）

如果答案是“是”，那么您*可能*有使用 Singleton 的有效案例。如果不是，那么您就是在滥用它，并且有一个更好的解决方案： **只是不要创建第二个实例。**

使用 Singleton 有几个错误的原因：

*   “我希望能够使用我的对象，而无需在应用程序中传递它。” 你猜怎么了？你所拥有的是一个美化的全局变量。当它藏在某个阶级的内心深处时，它甚至比它坐在外面让全世界都看到更邪恶。 **如果你想使用一个全局，那么使用一个该死的全局。** 不要将它隐藏在吸气剂后面，并认为人们不会注意到。

*   “我只需要其中一个。” 往上看。 **你只需要一个？只*创建*一个。** 不管你现在是否需要它，你有充分的理由*强迫*它永远存在吗？如果你将来想要另一个怎么办？您不仅让创建另一个类变得很痛苦，而且您可能已经以一种只能存在一个的方式构建您的类——并且将有很多“设计”要撤消。

*   “能说出来很方便`MySingleton.getInstance()`。” 是的，直到你开始关心测试。看，每次调用 时`MySingleton.getInstance()`，您都添加了一个假设，即这是该对象可以是唯一的类型。如果你开始搞乱单元测试，你的测试将毫无用处，因为它们都依赖于那个实例的行为——甚至是测试运行的顺序。即使是全球性的可测试性也没有那么糟糕，而且有点糟糕。（另外，请参阅上面的“......没有在应用程序周围传递它”。）

单例问题的解决方案一般是**依赖注入**。大话，但前提非常*非常简单；*非框架版本基本上是，“对象需要完成其工作的外部东西？将它传递给构造函数。” 据说有 DI 容器库/包可以简化这一点，但这一切都只是*告诉*对象使用什么，而不是让它自己去寻找东西。所以你**将你的一个实例传递给需要它的对象，**它永远不必说`MySingleton.`什么——甚至不*关心*那个对象是否是单例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T20:55:45.940

如果您只想拥有`Helper`该类的一个实例，那么单例是一种强制执行的方法。如果您的助手类包含任何非全局状态，那么单例可能不合适。也可以有多个助手实例共享一个主模型。

不过要小心单例，因为你的代码很快就会充满

```
MySingleton.getInstance() 
```

这也很难模拟进行测试（请参阅[http://jeffstorey.blogspot.com/2009/08/spring-managed-singletons-for.html](http://jeffastorey.blogspot.com/2009/08/spring-managed-singletons-for.html)）。如果您使用的是依赖注入框架，我建议将单例注入相关类（或使用注册表模式[http://martinfowler.com/eaaCatalog/registry.html](http://martinfowler.com/eaaCatalog/registry.html)之类的东西来查找单例对象，以便您仍然可以模拟用于测试）。

我在这里的回答只是一些指导，真正的答案就像很多软件问题是“视情况而定”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-10T20:57:04.993

我会说是的，看起来你想让它成为一个单身人士。另外，是的，如果您使用多个线程，则需要使其成为线程安全的。还有一件事，重命名它，“Helper”对于一个类来说是一个可怕的名字。把它命名为它的作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T20:57:00.000

我会说不，您应该避免使用提供“对服务的全局访问”的单例。

请参阅下面的链接和除外。

[http://blogs.msdn.com/b/scottdensmore/archive/2004/05/25/140827.aspx](http://blogs.msdn.com/b/scottdensmore/archive/2004/05/25/140827.aspx)

> 最终发生的情况是，设计中的依赖关系隐藏在代码中，通过检查类和方法的接口是不可见的。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-10T20:55:22.260

> 将 Helper 类实现为单例是实现此目标的最佳方式，还是有更好/更简单/更优雅的方式来实现我的目标？

如果您的意图是让`Helper`您的所有应用程序都使用一个单一的，那么是的，单例是要走的路。

> 我想我也应该提前知道我的 Helper 作为单例实现是否需要线程安全。

如果它将被多个线程访问，是的，它必须是线程安全的

# android - android 中的 sql 事务失败后究竟会发生什么？

> ID：11908984
> 
> 赞同：2
> 
> 时间：2012-08-10T20:43:37.687
> 
> 标签：android

如果您正在使用事务并且 sql 操作失败，我知道它会回滚所有更改，但是它会在 finally 语句之后停止所有代码还是会继续运行其余代码？

下面的代码看起来是正确的还是我应该使用 catch 语句？是否可以出于测试目的模拟错误？

```
public static boolean updateSuccessful = false;

updateToVersion2();
//Does anything after here still run on error?

if(!updateSuccessful) {
    deleteAndRecreateDatabase();
}

public void updateToDbVersion2() {
    this.myDataBase.beginTransaction();
    try {
        this.myDataBase.execSQL("UPDATE myRecords SET column = 'newValue1' WHERE _id = 1");
        this.myDataBase.execSQL("UPDATE myRecords SET column = 'newValue2' WHERE _id = 2");
        this.myDataBase.setTransactionSuccessful();
        // This is not reached on update error, right?
        updateSuccessful = true;
    } finally {
        this.myDataBase.endTransaction();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T21:55:13.640

你应该捕捉到异常！为什么你把它遗漏了让代码闻起来很糟糕......

如果在您结束事务的部分之间确实发生了异常`execSQL`，`setTransactionSuccessful`并最终落入`finally`您结束事务的部分，该怎么办？

代码可能是这样的：

```
public void updateToDbVersion2() {
    boolean fubar = false;
    this.myDataBase.beginTransaction();
    try {
        this.myDataBase.execSQL("UPDATE myRecords SET column = 'newValue1' WHERE _id = 1");
        this.myDataBase.execSQL("UPDATE myRecords SET column = 'newValue2' WHERE _id = 2");
        this.myDataBase.setTransactionSuccessful();
        // This is not reached on update error, right?
        updateSuccessful = true;
    } catch(Exception ex){
        fubar = true;
        // Do whatever is needed to be done such as logcat FOR debugging ONLY!
    } finally {
        if (!fubar){
            // No exceptions occurred, OK to end transaction
            this.myDataBase.endTransaction();
        }
    }
} 
```

请注意对`finally`子句的条件检查如何确保防止潜在的混乱并确保数据完整性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T20:53:43.283

有一组例外

[http://developer.android.com/reference/android/database/SQLException.html](http://developer.android.com/reference/android/database/SQLException.html)

以及网络上的一些相关示例和建议

[Android数据库错误？](https://stackoverflow.com/questions/1598461/android-database-error)

[为什么 SQLException 不能捕获 SQLiteExcpetion？](https://stackoverflow.com/questions/8159809/why-doesnt-sqlexception-catch-sqliteexcpetion)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-10T21:22:41.793

交易本身作为一个整体。它要么成功要么失败，这意味着您要么在数据库中获得所有数据，要么一无所获（当然是在此事务中）。如果事务在某个时候失败，它应该首先进入“catch”部分，然后再进入“finally”。

正如 user827992 所指出的，捕获异常会很有趣。那里可能有一些额外的（也许是有价值的）信息。

# iis - 无论如何都会发生 302 重定向到 HTTPS！为什么？？IIS/ASP.net/Ektron

> ID：11908985
> 
> 赞同：1
> 
> 时间：2012-08-10T20:43:40.697
> 
> 标签：iis, https, http-status-code-302

花了几个小时看这个..希望有人有一个想法..

我在互联网上有一个 Ektron 站点。由于某种原因，现在当您转到主页时，它所做的第一件事就是 302 重定向到该站点的 https 版本。我们在根目录上创建一个空白 test.html 文件，然后它仍然这样做..所以我想这意味着它必须是 IIS 服务器..

任何想法是什么迫使这个？当我在机器上并浏览它时，它工作正常.. 但从外部它继续访问 https

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T20:48:26.753

嗯，通常它在 IIS/web.config 中设置为始终对站点使用 SSL。但是你提到它只有在从外部访问时才会这样做，所以它看起来像是一些代理/网络设置。

# c# - 将连接查询的输出保存到数据表

> ID：11908986
> 
> 赞同：0
> 
> 时间：2012-08-10T20:43:43.457
> 
> 标签：c#, join, datatable

我正在尝试使用 C# 中的查询连接两个数据表。

我有两个数据表，`Crops`并且`HailGridLatLon`.

Crops 包含列`hail_grid_id`, `value`, `count`, `year`。

`HailGridLatLon`包含列`hail_grid_id`, `lat`, `lon`.

我需要提取数据表中每个对应的`lat`和值。`lon``hail_grid_id``Crops`

我的问题是，在执行连接查询后，我需要将纬度和经度的结果值保存到数据表中的新列中`Crops`。我发现的有关连接查询和选择子句的所有内容都只会将结果打印到控制台，根本不会保存它们。

这是我正在运行的查询代码：

```
var results = from table1 in Crops.AsEnumerable()
                      join table2 in HailGridLatLon.AsEnumerable() on table1[0] equals table2[0]
                      select new
                      {
                          hail_grid_id = table1[0], value = table1[1], count = table1[2], year = table1[3], latitude = table2[1], longitude = table2[2]
                      }; 
```

我知道要将值打印到屏幕上，我需要这个循环：

```
foreach (var item in results)
        {
            Console.WriteLine(String.Format("{0} {1} {2} {3} {4} {5}", item.hail_grid_id, item.value, item.count, item.year, item.latitude, item.longitude));
        } 
```

但就像我说的，我需要保存纬度和经度，以便将它们添加到数据表中。或者只是将存储在结果中的信息保存到新的数据表中。有没有办法做到这一点？我似乎基本上有一个对象类型“结果”，但是有没有办法将它转换为任何其他变量类型，最好是数据表？

ps 我知道这可以通过嵌套的 for 循环来完成，但是这些表很大，这样的方法需要 24 小时以上才能完成。

# c# - 基于元组或嵌套字典有什么好处吗？

> ID：11908991
> 
> 赞同：21
> 
> 时间：2012-08-10T20:44:08.777
> 
> 标签：c#, dictionary

我一直在寻找一种方法来存储和检索 C# 的通用 Dictionary 类提供的多个键上的值。

在网络上搜索（[以及 SO 本身](https://stackoverflow.com/questions/2877660/composite-key-dictionary)）向我展示了几个选项：

**基于元组的字典**

.NET 4.0 使支持泛型 Tuple<,> 类变得容易。这意味着您可以使用任意元组制作字典，即

*   `var myDict = new Dictionary<Tuple<Char, Int>, MyClass>();`

**嵌套字典**

我了解到您还可以在字典中嵌套字典，这使得访问存储的结果类似于访问 N 维数组。例如：

```
Dictionary<int, Dictionary<int, Dictionary<Char, MyClass>>> 
```

然后可以通过以下方式访问：`MyClass foo = MyData[8][3]['W'];`

**分隔连接键字典**

但是，虽然两者都*适用*于复杂数据和自定义类，但我想知道它们是否总是必要的。至少对于原始数据，将键与分隔符连接起来似乎同样有效。

```
//keys are char + int
Dictionary<string, MyClass> myDict = New Dictionary<string, Myclass>();
String input = myChar + "|" + myInt
MyClass foo = myDict[input] 
```

是否有任何情况使这些方法中的一种优于另一种？他们会有相似的表演时间吗？还是应该关注哪种方法提供最干净、最容易维护的代码？

想法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-10T20:46:44.880

**分隔连接键字典**

我会避免这种方法的原因至少有三个：

*   这是魔术。键的类型中没有任何内容可以告诉您如何构造它或它代表什么。
*   如果分隔符意外地作为值之一出现，您的方法将失败。
*   转换为字符串，以及这些字符串的比较可能（稍微）比使用两种原始类型慢。

**嵌套字典**

这解决了分隔符的问题，但引入了一些新问题：

*   插入新值很困难，因为对于每个嵌套级别，您必须检查该键是否已经存在。如果没有，您将需要创建一个新字典作为值。这使得使用字典更加困难。
*   会有更多的内存和性能开销。

**基于元组的字典**

在您发布的方法中，这可能是最好的。

但是您可以更进一步，`struct`为您的密钥创建一个命名的不可变对象。这将使您的字典更易于使用，因为键的部分可以具有有用的名称。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-01-13T12:13:08.900

> 还是应该关注哪种方法提供最干净、最容易维护的代码？

除非您的重点是编写噩梦般的、令人生畏的代码，否则您应该避免使用字符串定界和连接方法，这是不言而喻的邪恶。

在基于元组和嵌套字典的方法之间进行选择取决于您的上下文。调整性能？或者调整可读性？我先讲后者。

**从可维护性的角度来看**，

*   实现如下所示的功能要容易得多：

    ```
    var myDict = new Dictionary<Tuple<char, int>, MyClass>(); 
    ```

    比

    ```
    var myDict = new Dictionary<char, Dictionary<int, MyClass>>(); 
    ```

    从被叫方。在第二种情况下，每次添加、查找、删除等都需要对多个字典进行操作。

*   此外，如果您的复合键将来需要一个更多（或更少）字段，您将需要在第二种情况（嵌套字典）中大量更改代码，因为您必须添加更多嵌套字典和后续检查。

**从性能的角度来看**，您可以得出的最佳结论是自己衡量。但是您可以事先考虑一些理论上的限制：

*   在嵌套字典的情况下，为每个键（外部和内部）添加一个额外的字典将产生一些内存开销（比创建元组所需要的更多）。

*   在嵌套字典的情况下，添加、更新、查找、删除等每个基本操作都需要在两个字典中执行。现在有一种情况，嵌套字典方法*可以*更快，即，当正在查找的数据不存在时，因为中间字典可以绕过完整的哈希码计算和比较，但是应该再次确定它的时间。在存在数据的情况下，它应该更慢，因为查找应该执行两次（或三次，取决于嵌套）。

*   关于元组方法，.NET 元组在用作集合中的键时并不是性能最高的，因为它的[`Equals`实现`GetHashCode`会导致值类型的装箱](https://stackoverflow.com/questions/21084412/net-tuple-and-boxing)。

总的来说，我发现很少需要嵌套字典方法。赔率是一个人不想要它。我更喜欢基于元组的方法，但是您应该编写一个具有更好实现的自己的元组，在这种情况下`char`，`int`我更喜欢将其设为（不可变）结构。

一个非常相关的问题：[元组（或数组）作为 C# 中的字典键](https://stackoverflow.com/questions/955982/tuples-or-arrays-as-dictionary-keys-in-c-sharp)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-07-21T19:32:15.030

我想补充一下上面的答案，在某些情况下（取决于数据的分布方式），嵌套字典在内存占用方面比复合键字典好得多（这反过来可能会带来更好的性能总体）。这样做的原因是嵌套可以节省您为键保存重复值的需要，这在大型字典中将使额外字典的占用空间可以忽略不计。

例如，假设我需要一个具有（男/女）、（婴儿/年轻/老人）、（年龄）复合键的字典。

让我们用复合键字典保存一些值：

```
(male, baby, 1)
(male, baby, 2)
(male, baby, 3)
(male, young, 21)
(male, young, 22)
(male, young, 23)
(male, old, 91)
(male, old, 92)
(male, old, 93)
(female, baby, 1)
(female, baby, 2)
(female, baby, 3)
(female, young, 21)
(female, young, 22)
(female, young, 23)
(female, old, 91)
(female, old, 92)
(female, old, 93) 
```

现在让我们将相同的值保存在字典字典中：

```
male -> baby ->  1
                 2
                 3
        young -> 21
                 22
                 23
        old  ->  91
                 92
                 93
female -> baby ->1
                 2
                 3
        young -> 21
                 22
                 23
        old  ->  91
                 92
                 93 
```

在复合键方法中，我将“男性”和“女性”的副本保存了 9 次，而不是字典中的单个副本。事实上，我保存了 54 项和 26 项，内存占用量增加了一倍。该示例还有助于可视化差异，查看第二个样本与第一个样本相比有多少“空白”空间，这些都是我们不需要保存的值。

对于那些仍然不相信的人，这里有一个示例测试：

```
 Dictionary<Tuple<int, int, int>, int> map1 = new Dictionary<Tuple<int, int, int>, int>();
    Dictionary<int, Dictionary<int, Dictionary<int, int>>> map2 = new Dictionary<int, Dictionary<int, Dictionary<int, int>>>();

    public void SizeTest()
    {
        for (int x = 0; x < 30; x++)
        {
            for (int y = 0; y < 100; y++)
            {
                for (int z = 0; z < 600; z++)
                {
                    addToMap1(x, y, z, 0);
                    addToMap2(x, y, z, 0);
                }
            }
        }
        int size1 = GetObjectSize(map1);
        int size2 = GetObjectSize(map2);

        Console.WriteLine(size1);
        Console.WriteLine(size2);
    }

    private void addToMap1(int x, int y, int z, int value)
    {
        map1.Add(new Tuple<int, int, int>(x, y, z), value);
    }

    private void addToMap2(int x, int y, int z, int value)
    {
        map2.GetOrAdd(x, _ => new Dictionary<int, Dictionary<int, int>>())
            .GetOrAdd(y, _ => new Dictionary<int, int>())
            .GetOrAdd(z, _ => value);
    }

    private int GetObjectSize(object TestObject)
    {
        BinaryFormatter bf = new BinaryFormatter();
        MemoryStream ms = new MemoryStream();
        byte[] Array;
        bf.Serialize(ms, TestObject);
        Array = ms.ToArray();
        return Array.Length;
    }

    public static TResult GetOrAdd<TKey, TResult>(this Dictionary<TKey, TResult> map, TKey key, Func<TKey, TResult> addIfMissing)
    {
        TResult result;
        if (!map.TryGetValue(key, out result))
        {
            result = addIfMissing(key);
            map[key] = result;
        }
        return result;
    } 
```

此测试返回 ~30MB 与 ~70MB 支持字典字典。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-10T20:47:45.850

您描述的所有选项都非常相似 - 至于性能，您需要针对您的特定使用场景测试每个选项，但对于小型集合，它们不太可能有太大差异。

它们也都受到可读性的影响——很难构造它们并从类型中梳理出含义。

相反，最好创建一个直接描述数据的类型——好的命名有很长的路要走。

# android - 使用带有登录系统的 invalidateOptionsMenu() (Android)

> ID：11908996
> 
> 赞同：4
> 
> 时间：2012-08-10T20:44:46.797
> 
> 标签：android, android-optionsmenu

我试图让我的选项菜单重绘（从同一个活动中），我称之为登录对话框。

这里是设置。从应用程序中的任何活动中，用户可以单击溢出/选项菜单并单击登录。弹出一个对话框，他们有望成功登录。对话框然后完成（）的。如果您单击菜单，它仍然显示“登录” - 而不是“注销”。看来我没有使用 invalidateOptionsMenu 对吗？这是代码：

调用对话框的选项菜单代码：

```
case R.id.Login:
        Intent i = new Intent(this, Login.class);
        startActivityForResult(i, 0);
        return true; 
```

Login.class 是一个对话框。当用户单击对话框中的提交按钮时，会发生这种情况：

```
 // set log in var's here

        Intent in = new Intent();
        setResult(1, in);
        finish(); 
```

然后回到原始活动：

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    if (resultCode == 1) {

        MyActivity.this.invalidateOptionsMenu();

    }
} 
```

使用 Toast，我已经确认正在调用“1”。

如何使菜单无效并重新绘制，以便它包含注销选项（因为用户现在已登录？）

编辑：

```
@Override
public boolean onPrepareOptionsMenu(Menu menu) {

    MenuItem Rules = menu.findItem(R.id.Rules);
    MenuItem About = menu.findItem(R.id.About);
    MenuItem Profile = menu.findItem(R.id.Profile);
    MenuItem Login = menu.findItem(R.id.Login);
    MenuItem Logout = menu.findItem(R.id.Logout);

    // set the menu options depending on login status
    if (LoggedStatus == true) {
        // show the log out option
        Logout.setVisible(true);
        Login.setVisible(false);

        Rules.setVisible(true);
        Profile.setVisible(true);
        About.setVisible(true);
    } else {
        // show the log in option
        Logout.setVisible(false);
        Login.setVisible(true);

        Rules.setVisible(true);
        Profile.setVisible(false); // hide
        About.setVisible(true);
    }

    return true;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-13T21:32:14.737

我会仔细看看这个：http: [//developer.android.com/guide/topics/ui/menus.html#ChangingTheMenu](http://developer.android.com/guide/topics/ui/menus.html#ChangingTheMenu)

`invalidateOptionsMenu()`在 Android 3.0+ 上调用会调用`onPrepareOptionsMenu()`. A`Menu`被传递给该方法，并且您想使用该对象对菜单进行更改，无论是添加还是删除菜单项。

请记住这一点`onPrepareOptionsMenu()`：

> 您必须返回 true 才能显示菜单；如果您返回 false 则不会显示。

编辑：抱歉，我以某种方式错过了最底部的代码。让我快速检查一下。

编辑2：你忘了打电话`super.onPrepareOptionsMenu(menu);`

edit3：既然您已经确定菜单确实有效，唯一可能导致它不显示的是`LoggedStatus`. 确保它被正确修改应该可以解决所有问题。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-12-12T02:41:31.263

@KickingLettuce

将其转换为 MenuItem 类型。Android 无法确定“setVisible”是否适用或是否可以调用“Rules”变量。

MenuItem Rules = (MenuItem) menu.findItem(R.id.Rules);

那可行。希望能帮助到你 ：）

# jquery - html5视频悬停改变另一个元素的不透明度

> ID：11908998
> 
> 赞同：1
> 
> 时间：2012-08-10T20:44:54.760
> 
> 标签：jquery, html, video, html5-video, video.js

所以我在这里有一个页面：[http](http://www.ruffcuts.com.sg/work/bosch.htm) ://www.ruffcuts.com.sg/work/bosch.htm以及其他一些页面。

我希望将鼠标悬停在视频元素上，然后更改前面草图像的不透明度（id=plax-sphere-52 src=homehead6.png），以便可以看到播放器的控件。

但不知何故，它不起作用！我试过了

```
$('#videocontain').mouseover(function() {
$('img#plax-sphere-52').css('opacity', '0.6');
});
$('#videocontain').mouseout(function() {
$('img#plax-sphere-52').css('opacity', '1');
}); 
```

和其他类似的编码，但它只是不起作用。

会不会在某个地方发生冲突，或者我只是简单地编码错了？顺便使用[http://videojs.com/](http://videojs.com/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T22:00:09.017

我在您的页面上看到一个破坏 jQuery 的错误。

```
Uncaught TypeError: Object [object Object] has no method 'plaxify' ruffcutsprod.js:4

$
undefined 
```

除此之外，我没有看到任何问题。您可以尝试 mousemove 而不是 mouseover。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T22:04:56.827

事件`mouseover/mouseout`冒泡。因此，当您的鼠标进入视频标签时，会在容器 div 上触发 mouseout 事件，并在视频 div 上触发 mouseenter。

因此，当鼠标移动到视频中时，mouseover 触发，将不透明度设置为 0.6，然后 mouseout 立即触发并将不透明度设置回 1.0

尝试使用`mouseentter/mouseleave`不会冒泡的事件，或者您可以测试事件的来源是包装 div，而不是该 div 中的任何元素。