# StackOverflow 问答 11567000-11567999

# django - 使用要求中的 pip install 缺少分发规范错误

> ID：11567008
> 
> 赞同：14
> 
> 时间：2012-07-19T18:22:27.977
> 
> 标签：django, virtualenv, pip

我刚刚创建了一个新的 virtualenv，我想在其中运行我的`pip install`. 但是，我收到此错误：

```
raise ValueError("Missing distribution spec", line)
ValueError: ('Missing distribution spec', '/path/to/dir/requirements.txt') 
```

我的**requirements.txt**：

```
Django==1.3
Jinja2==2.6
MySQL-python==1.2.3
PIL==1.1.7
Pygments==1.5
Sphinx==1.1.3
Werkzeug==0.8.3
django-debug-toolbar==0.9.4
django-excel-response==1.0
django-extensions==0.8
docutils==0.9.1
ipython==0.12
wsgiref==0.1.2 
```

出了什么问题？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-19T18:44:02.870

你一定做错了什么。类似: `pip install path/to/requirements.txt`，但要求文件必须使用`-r`参数传递：

`pip install -r path/to/requirements.txt`

拥抱。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-06-09T12:53:12.443

如果有人在与我相同的变体中运行，我想完成答案：我在 Windows 环境（Windows 7）上运行所有东西。在powershell下，我跑了

```
pip freeze > requirements.txt 
```

当我在新的 virtualenv 上进行测试时，我遇到了与上面相同的错误。问题是编码问题（呃）：确保 requirements.txt 文件是用 UTF-8 编写的（没有 BOM）。Notepad++ 或 sublime text 可以确保这一点。

希望它可以帮助其他任何人，因为上面的答案还不够。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-13T15:19:45.943

我的问题最终是在某些终端中， - 并且 - 看起来完全一样。我有 -r 并且它抛出了这个错误。你想要-r。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-22T06:28:49.050

如果您要推送到 Azure，即使使用 utf-8，您也可能会遇到此问题：

ValueError: ('缺少分发规范', '\xef\xbb\xbfDjango==1.11.4')

安全的方法是将 requirements.txt 保存为 ansi 文件。

好吧，鉴于您在 Windows 上运行

# android - 权限拒绝：广播 Intent android.provider.Telephony.SMS_RECEIVED

> ID：11567010
> 
> 赞同：0
> 
> 时间：2012-07-19T18:22:30.540
> 
> 标签：android, permissions, sms, broadcastreceiver, manifest

您好，我是 Android 新手，即使在我的清单文件中拥有所需的 SMS 权限后，我也遇到了这个问题。我尝试了几种方法，但它不再起作用了知道吗？

AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.phonefinder2"
        android:versionCode="1"
    android:versionName="1.0">
    <uses-sdk android:minSdkVersion="8" />

        <uses-permission android:name="android.permission.ACCESS_GPS" />
    <uses-permission android:name="android.permission.ACCESS_LOCATION" />    
   <uses-permission android:name="android.permission.RECEIVE_SMS" />
   <uses-permission android:name="android.permission.READ_SMS" />

    <application android:icon="@drawable/ic_launcher">

        <activity android:name=".PhoneFinder" android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <receiver android:name=".FinderReceiver" android:enabled="true" android:exported="false" android:permission="android.permission.RECEIVE_SMS"> 
            <intent-filter > 
                <action android:name="android.provider.Telephony.SMS_RECEIVED" android:priority="999"/> 
            </intent-filter> 
        </receiver>
    </application>

</manifest> 
```

错误：

```
07-19 19:23:25.915: D/SntpClient(66): request time failed: java.net.SocketException: Address family not supported by protocol
07-19 19:23:29.444: W/ActivityManager(66): Permission denied: checkComponentPermission() reqUid=10042
07-19 19:23:29.454: W/ActivityManager(66): Permission Denial: broadcasting Intent { act=android.provider.Telephony.SMS_RECEIVED (has extras) } from com.android.phone (pid=124, uid=1001) requires android.permission.RECEIVE_SMS due to receiver com.example.phonefinder2/com.example.phonefinder2.FinderReceiver
07-19 19:23:29.544: V/Telephony(235): getOrCreateThreadId uri: content://mms-sms/threadID?recipient=83380222
07-19 19:23:29.616: V/Telephony(235): getOrCreateThreadId cursor cnt: 1
07-19 19:23:30.126: D/Mms:app(235): getSmsNewMessageNotificationInfo: count=19, first addr=83380222, thread_id=1
07-19 19:23:30.194: W/NotificationService(66): STOP command without a player
07-19 19:23:30.305: D/MediaPlayer(66): Couldn't open file on client side, trying server side
07-19 19:23:30.334: E/MediaPlayerService(34): Couldn't open fd for content://settings/system/notification_sound
07-19 19:23:30.334: E/MediaPlayer(66): Unable to to create media player
07-19 19:23:30.354: W/NotificationService(66): error loading sound for content://settings/system/notification_sound
07-19 19:23:30.354: W/NotificationService(66): java.io.IOException: setDataSource failed.: status=0x80000000
07-19 19:23:30.354: W/NotificationService(66):  at android.media.MediaPlayer.setDataSource(Native Method)
07-19 19:23:30.354: W/NotificationService(66):  at android.media.MediaPlayer.setDataSource(MediaPlayer.java:716)
07-19 19:23:30.354: W/NotificationService(66):  at android.media.MediaPlayer.setDataSource(MediaPlayer.java:671)
07-19 19:23:30.354: W/NotificationService(66):  at com.android.server.NotificationPlayer$CreationAndCompletionThread.run(NotificationPlayer.java:88) 
```

FinderReceiver.java：

```
package com.example.phonefinder2;

import android.app.Notification;   
import android.app.NotificationManager;   
import android.app.PendingIntent;   
import android.content.BroadcastReceiver;   
import android.content.Context;   
import android.content.Intent;   
import android.content.SharedPreferences;   
import android.location.Location;   
import android.location.LocationManager;   
import android.os.Bundle;   
import android.telephony.SmsManager;   
import android.telephony.SmsMessage;   
import android.util.Log;
import android.widget.Toast;

public class FinderReceiver extends BroadcastReceiver {
    private static final String SMS_RECEIVED = "android.provider.Telephony.SMS_RECEIVED";
    private static final String TAG = "Logging Activity";

    Context context;   
    @Override    
    public void onReceive(Context context, Intent intent) {  
        Log.v(TAG, "New Broadcast Receiver");
        this.context = context;   
        SharedPreferences passwdfile = context.getSharedPreferences(    
                PhoneFinder.PASSWORD_PREF_KEY, 0); 

        Log.v(TAG, PhoneFinder.PASSWORD_PREF_KEY);

        String correctMd5 = passwdfile.getString(PhoneFinder.PASSWORD_PREF_KEY,    
                null);    

        Log.v(TAG, correctMd5);

        if (correctMd5 != null) {    
            Log.v(TAG, "MD5 is not null");

            if (intent.getAction().equals(SMS_RECEIVED)) {
              Log.v(TAG, "Intent SMS RECEIVED success");
              Bundle bundle = intent.getExtras();   
              if (bundle != null) {
              Object pdus[] = (Object[]) bundle.get("pdus");
              SmsMessage smsMessage[] = new SmsMessage[pdus.length];   

//              for(int i = 0; i < smsMessage.length; i++)
              for(int i = 0; i < pdus.length; i++) {   
                  smsMessage[i] = SmsMessage.createFromPdu((byte[])pdus[i]);   
                if (smsMessage[i].getMessageBody().contains("RING:")) {    
                    String[] tokens = smsMessage[i].getMessageBody().split(":");    
                    if (tokens.length >= 2) {    
                        String md5hash = PhoneFinder.getMd5Hash(tokens[1]);    

                        if (correctMd5.equals(md5hash)) {    
/*                            String to = smsMessage[i].getOriginatingAddress (); 
                            SmsManager sm = SmsManager.getDefault(); 

                             sm.sendTextMessage (to, null, "success!", null, null);
                            NotificationManager nm =  
                                (NotificationManager) context.getSystemService (Context.NOTIFICATION_SERVICE); 
                            Notification notification = new Notification(android.R.drawable.ic_dialog_info, "Alert", System.currentTimeMillis());
                            PendingIntent contentIntent = PendingIntent.getActivity (context, 0, new Intent (context, PhoneFinder.class), 0);
                            notification.setLatestEventInfo (context, "GPS address", "You have been detected", contentIntent);
                            nm.notify (R.string.service_start, notification);*/
                            this.abortBroadcast();
                            Toast toast = Toast.makeText(context, "Ring success!", Toast.LENGTH_LONG); 
                            toast.show();
                        }    
                    }    
                } 
                }   
            }    
    }
        }
}    
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T04:32:14.943

我设法通过更改以下内容来修复它：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android" package="com.example.phonefinder2" android:versionCode="1" android:versionName="1.0">

    <uses-permission android:name="android.permission.BROADCAST_SMS"/>
    <uses-permission android:name="android.permission.ACCESS_GPS" />
    <uses-permission android:name="android.permission.ACCESS_LOCATION" />    
    <uses-permission android:name="android.permission.READ_SMS" />
    <uses-permission android:name="android.permission.SEND_SMS" />

    <application android:icon="@drawable/ic_launcher">

        <activity android:name=".PhoneFinder" android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <receiver android:name=".FinderReceiver" android:enabled="true" android:exported="true" android:permission="android.permission.BROADCAST_SMS"> 
            <intent-filter android:priority="1000"> 
                <action android:name="android.provider.Telephony.SMS_RECEIVED"/> 
            </intent-filter> 
        </receiver>

     </application>

     <uses-sdk android:minSdkVersion="8" />
     <uses-permission android:name="android.permission.RECEIVE_SMS" />

</manifest> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:19:48.407

改变：

```
<receiver android:name=".FinderReceiver" android:enabled="true" android:exported="false"> 
<intent-filter> 
  <action android:name="android.provider.Telephony.SMS_RECEIVED" android:priority="999"/> 
</intent-filter> 
</receiver> 
```

至：

```
 <receiver android:name=".FinderReceiver" android:enabled="true" android:exported="false" android:permission="android.permission.RECEIVE_SMS"> 
  <intent-filter> 
      <action android:name="android.provider.Telephony.SMS_RECEIVED" android:priority="999"/> 
  </intent-filter> 
</receiver> 
```

您还需要接收器中的权限标签。

编辑：

将属性 android:exported="false" 更改为 android:exported="true"

# wcf - Silverlight + WCF 服务

> ID：11567013
> 
> 赞同：0
> 
> 时间：2012-07-19T18:22:52.547
> 
> 标签：wcf, silverlight, web-services, service

我尝试在 Visual Studio 2010 中创建 WCF 服务，它似乎可以工作，因为当我使用 WCF 测试客户端调试 VS 时，我可以连接到该服务并运行命令。但是，当我尝试从我的 Silverlight 应用程序运行命令时，我收到一条错误消息，指出我的跨域不起作用。我已经从我的 silverlight 应用程序和 wcf 客户端中包含了我的代码。

***服务***

**客户端访问策略.xml**

```
`<?xml version="1.0" encoding="utf-8"?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="SOAPAction">
        <domain uri="*"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy>` 
```

**应用程序配置**

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>

  <system.web>
    <compilation debug="true" />
  </system.web>
  <!-- When deploying the service library project, the content of the config file must be added to the host's 
  app.config file. System.Configuration does not support config files for libraries. -->
  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="SqlServerServiceBinding" maxBufferPoolSize="2147483647"
                 maxBufferSize="2147483647" maxReceivedMessageSize="2147483647">
          <readerQuotas  maxDepth="2147483647" maxStringContentLength="2147483647" maxArrayLength="2147483647" maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" />
        </binding>
      </basicHttpBinding>
    </bindings>

    <!--<behaviors>
      <serviceBehaviors>
        <behavior name="SqlServerServiceBehavior">
          <serviceMetadata httpGetEnabled="true" />
          <serviceDebug includeExceptionDetailInFaults="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors>-->

    <services>
      <service name="SqlServerService.Service1">
        <host>
          <baseAddresses>
            <add baseAddress = "http://localhost:8085/" />
          </baseAddresses>
        </host>
        <!-- Service Endpoints -->
        <!-- Unless fully qualified, address is relative to base address supplied above -->
        <endpoint address ="" binding="basicHttpBinding" contract="SqlServerService.IService1">
          <!-- 
              Upon deployment, the following identity element should be removed or replaced to reflect the 
              identity under which the deployed service runs.  If removed, WCF will infer an appropriate identity 
              automatically.
          -->
          <!--<identity>
            <dns value="localhost"/>
          </identity>-->
        </endpoint>
        <!-- Metadata Endpoints -->
        <!-- The Metadata Exchange endpoint is used by the service to describe itself to clients. --> 
        <!-- This endpoint does not use a secure binding and should be secured or removed before deployment -->
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, 
          set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="True"/>
          <!-- To receive exception details in faults for debugging purposes, 
          set the value below to true.  Set to false before deployment 
          to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="False" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>

</configuration> 
```

**服务1.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.Text;

namespace SqlServerService
{
    // NOTE: You can use the "Rename" command on the "Refactor" menu to change the class name "Service1" in both code and config file together.
    public class Service1 : IService1
    {
        public CompositeType executeScriptWithReturn(String command_string)
        { 
            CompositeType cs = new CompositeType();
            Userful_Commands.sql_server_commands sql = new Userful_Commands.sql_server_commands("Server=localhost;Database=kenticoTest;Integrated Security=SSPI;");

            cs.DtValue = command_string;//sql.executeScriptWithReturn("SELECT * FROM tblBugs");
            return cs;
        }
    }
} 
```

**IService1.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.Text;

namespace SqlServerService
{
    // NOTE: You can use the "Rename" command on the "Refactor" menu to change the interface name "IService1" in both code and config file together.
    [ServiceContract]
    public interface IService1
    {
        [OperationContract]
        CompositeType executeScriptWithReturn(String command_string);

        // TODO: Add your service operations here
    }

    // Use a data contract as illustrated in the sample below to add composite types to service operations
    [DataContract]
    public class CompositeType
    {
        public String dt;

        [DataMember]
        public String DtValue
        {
            get { return dt; }
            set { dt = value; }
        }
    }
} 
```

***银光***

**ServicesReferences.ClientConfig**

```
<configuration>
  <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding_IService1" maxBufferSize="2147483647"
          maxReceivedMessageSize="2147483647">
          <security mode="None" />
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="http://localhost:8085/" binding="basicHttpBinding"
        bindingConfiguration="BasicHttpBinding_IService1" contract="ServiceReference1.IService1"
        name="BasicHttpBinding_IService1" />
    </client>
  </system.serviceModel>
</configuration> 
```

**MainPage.xaml.cs**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using Silverlight;
using SilverlightSQLServer;

namespace SilverlightApplication1
{
    public partial class MainPage : UserControl
    {
        public MainPage()
        {
            InitializeComponent();
        }

        private void loaded_up(object sender, RoutedEventArgs e)
        {
            //SilverlightApplication1.ServiceReference1.Service1Client sc = new ServiceReference1.Service1Client();
            //sc.executeScriptWithReturnCompleted += completed;
            //sc.executeScriptWithReturnAsync("TEST COMMAND");
            ServiceReference1.Service1Client ws = new ServiceReference1.Service1Client();

            ws.executeScriptWithReturnCompleted += completed;
            ws.executeScriptWithReturnAsync("TESTCOMMAND");
        }

        private void completed(object sender, SilverlightApplication1.ServiceReference1.executeScriptWithReturnCompletedEventArgs e)
        {
            SilverlightApplication1.ServiceReference1.CompositeType serviceResp = e.Result;
            e = e;

        }
    }
} 
```

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:14:06.560

I have wrestled with this myself. The simplest solution I have found is to put the WCF service in the Solution that hosts your silverlight application. Right click on that project (The .Web one that has the ClientBin folder) select add item and select WCF service. Put your code in that service and your cross domain issues go away. Of course if you want to host the service somewhere else then this wont help you.

# c# - WinForm 离屏防止

> ID：11567016
> 
> 赞同：0
> 
> 时间：2012-07-19T18:23:00.747
> 
> 标签：c#, winforms

按照我[之前的帖子](https://stackoverflow.com/questions/11531088/form-move-inside-client-desktop-area)

当用户进行拖放时，我可以防止 winform 离开屏幕，但是我注意到当我移动表单时，鼠标光标似乎运行得很快，实际上，当拖放完成时，鼠标光标出现在离开表格的位置。有什么方法可以防止这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:58:27.463

[这个 mdsdn 页面](http://msdn.microsoft.com/en-us/library/system.windows.forms.cursor.position.aspx)会告诉你如何移动光标。

但是，根据您指出的上一篇文章，您似乎在玩弄 Windows。

除非您正在处理的计算机将被可能会走来并为下一个人搞砸的人在公共场合使用，否则您可能会认为这样的事情会让用户感到沮丧而不是他们的帮助。

一个非常新手的用户可能会意外丢失您的应用程序的窗口，但如果他们是每天使用 PC 的员工，他们最终将不得不弄清楚这一点。

同时，你会让任何习惯了电脑的人感到沮丧——并让他们发疯。

此外，您正在为自己做更多的工作，而没有获得任何额外的功能。

我不确定您要做什么，当然我在这方面可能是错误的，但通常情况下，不玩这些东西既容易又好。

# python - Python子进程包不报子进程错误？

> ID：11567017
> 
> 赞同：1
> 
> 时间：2012-07-19T18:23:03.070
> 
> 标签：python, linux, subprocess

在某些机器上，对于以下代码

```
p = subprocess.Popen(cmd, stdout = subprocess.PIPE, stderr = subprocess.STDOUT);
out, err = p.communicate() 
```

该脚本只会挂起`p.communicate()`并且不会返回。

在我手动运行命令后，我终于看到了错误消息。

为什么会这样，我应该如何解决？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:17:12.400

尽量`stderr = subprocess.PIPE`不要`stderr = subprocess.STDOUT`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T21:48:36.557

我猜你的程序永远不会结束？

当您调用communicate() 时，它在不同的操作系统下做不同的事情。但它总是等待启动的进程自行退出，例如。调用 p.wait()。p.wait() 仅在进程终止时终止。

解决方案：

*   您可以复制 subprocess.Popen._communicate 的源代码并对其进行更改，使其不使用 wait() 而是使用 time.sleep 和一些超时
*   您编写自己的代码来读取 stdout 和 stderr 并在程序输出太多 stderr 时停止
*   您更改了文件的 main() 函数，该函数永远不会以这种方式进行

方式

```
def main():
    ## here is you program code

if __name__ == '__main__':
    import thread, sys, time
    _id = thread.start_new(main, ())
    time.sleep(1)
    t = time.time() + 100 # execute maximum 100 + 1 seconds
    while t > time.time() and _id in sys._current_frames():
        time.sleep(0.001) 
```

如果您想查看 subprocess 的来源，您可以在`subprocess.__file__`.

# java - 我可以通过模拟检查数据库查询的返回值吗？

> ID：11567018
> 
> 赞同：0
> 
> 时间：2012-07-19T18:23:13.250
> 
> 标签：java, unit-testing, testing, easymock

所以对于我的单元测试，我使用的是easymock。我有一个 findProject 方法，它查询数据库并返回项目列表。我已经模拟了返回 entityManger 的对象（我正在使用 JPA 和 Hibernate）。所以它类似于：mockedRepository.findList() 返回项目列表。所以现在这是一个模拟对象。所以在这些情况下，我无法检查 findList 的返回值。正确的？因为这是一个模拟对象，它只返回我想要的。所以如果你想测试这种查询数据库的方法，我们不能使用模拟。正确的？我可以检查是否已使用 easyMocking 调用了这些方法。正确的？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T14:05:31.890

我建议使用简单的内存 Java SQL 数据库，例如[H2](http://www.h2database.com/html/main.html)或[HSQL](http://hsqldb.org/)。而不是嘲讽。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T13:04:54.437

> 所以如果你想测试这种查询数据库的方法，我们不能使用模拟。正确的？

正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T19:14:44.480

你至少有两个选择：

1.  使用创建您自己的实例并在您的存根中`EntityManager`使用`Persistence.createEntityManagerFactory("persistence_unit_name").createEntityManager()`它或注入被测对象。
2.  使用类似[jpa-unit](http://code.google.com/p/jpa-unit/)的东西来为你做这件事。

我个人对项目中的每个查询都使用第二个选项。我使用这个库来测试查询是否在没有任何解析异常或其他东西的情况下执行。前段时间我试图测试查询是否返回了我希望它们返回的内容（这个库还可以帮助你设置数据库并用测试数据填充它 - 比如 dbunit），但由于它很麻烦，我放弃了它。

# matlab - MATLAB 编译器处理来自无关工具箱的 mcc.enc

> ID：11567019
> 
> 赞同：3
> 
> 时间：2012-07-19T18:23:14.900
> 
> 标签：matlab, matlab-deployment, matlab-compiler, mcc

我正在使用 mcc 编译我的 MATLAB 项目。我正在使用的机器上安装了许多 MATLAB 工具箱，但我的代码只需要几个（例如 distcomp 和图像）。但是，每当我运行 mcc 时，它最终都会为许多工具箱“处理”mcc.enc 文件，包括那些我的代码不需要的工具箱。

这是 mcc 输出的开头（我正在运行它以`-R '-nodisplay'`与我正在使用的集群兼容）。

```
Warning: No display specified.  You will not be able to display graphics on the screen.
Compiler version: 4.15 (R2011a)
Processing /cm/shared/apps/matlab/7.12.0/toolbox/matlab/mcc.enc
Processing /cm/shared/apps/matlab/7.12.0/toolbox/distcomp/mcc.enc
Processing /cm/shared/apps/matlab/7.12.0/toolbox/images/mcc.enc
Processing /cm/shared/apps/matlab/7.12.0/toolbox/stats/mcc.enc
Processing /cm/shared/apps/matlab/7.12.0/toolbox/shared/imageslib/mcc.enc
Processing /cm/shared/apps/matlab/7.12.0/toolbox/shared/system/mcc.enc
Processing /cm/shared/apps/matlab/7.12.0/toolbox/shared/spcuilib/mcc.enc
Processing /cm/shared/apps/matlab/7.12.0/toolbox/control/mcc.enc
Processing /cm/shared/apps/matlab/7.12.0/toolbox/shared/controllib/engine/mcc.enc
Processing /cm/shared/apps/matlab/7.12.0/toolbox/shared/controllib/general/mcc.enc
Processing /cm/shared/apps/matlab/7.12.0/toolbox/signal/mcc.enc
Processing /cm/shared/apps/matlab/7.12.0/toolbox/nnet/mcc.enc 
```

我注意到在我的桌面上运行 mcc 时它也会做同样的事情。其中一些 mcc.enc 文件（尤其是 .../signal/mcc.enc 和 .../nnet/mcc.enc）需要比 mcc 的其余部分执行更多的时间来处理。有没有办法排除处理不需要的 mcc.enc 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T14:53:25.157

使用 MATLAB IDE 中的“部署工具”，转到项目设置，然后从“路径上的工具箱”选项卡中，取消选择所有不需要的工具箱。

![截屏](../Images/2b3ed1b1ed04585cbec473dc72f9383e.png)

此外，还有一个`mcc`参数[`-N`](http://www.mathworks.com/help/toolbox/compiler/mcc.html#br2jars-76)可以清除路径中的所有文件夹，只保留核心 MATLAB 文件夹。

> -N 清除路径
> 
> 传递 -N 有效地清除除以下核心文件夹之外的所有文件夹的路径（此列表会随时间变化）：
> 
> *   matlabroot/工具箱/matlab
> *   matlabroot/工具箱/本地
> *   matlabroot/工具箱/编译器/部署
> 
> 它还保留编译时出现在 MATLAB 路径上的上述列表的所有子文件夹。在命令行中包含 -N 允许您从原始路径替换文件夹，同时保留包含文件夹的相对顺序。出现在原始路径上的包含文件夹的所有子文件夹也包括在内。此外，-N 选项保留用户已包含在路径中但不在 matlabroot/toolbox 下的所有文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-07T07:28:54.940

我建议使用 Matlab 中央文件交换中的 «fdep» 函数：

[http://www.mathworks.com/matlabcentral/fileexchange/17291-fdep--a-pedestrian-function-dependencies-finder](http://www.mathworks.com/matlabcentral/fileexchange/17291-fdep--a-pedestrian-function-dependencies-finder)

此函数应用于程序的主要函数，将告诉您正在使用的工具箱以及正在使用的所有函数（递归地，因此列出了所有基本函数，您不应错过任何函数）。减少最终 exe 的大小和编译时间非常有用。

# ajax - JSON 存储的 AJAX 请求参数。ExtJS

> ID：11567024
> 
> 赞同：0
> 
> 时间：2012-07-19T18:23:42.290
> 
> 标签：ajax, json, extjs, parameters, url-parameters

我想将**一些参数串到一个地址中，我可以在浏览器中查看 AJAX 请求**……我想这就是我的意思，尽管我不太喜欢谈论 AJAX。我只是一个新手前端 Web 应用程序程序员。

因此，首先，我有一个带有组合框的 ExtJS 应用程序。据我所知，它由 JSON 文件中的项目填充。这是应用程序代码片段：

```
 items: [{
                xtype : 'combobox',
                queryMode : 'remote',
                fieldLabel: 'twittersearch',
                typeAhead : true,
                allowBlank : applicationtype === 'relatedanalysis' ? true : false,
                hideTrigger : false,
                editable : false,
                multiSelect : true,
                minChars : 1,
                store : 'smcc.TwitterSearch',
                displayField : 'id',
                name : 'twittersearch',
                listConfig: {
                    getInnerTpl: function() {
                        return  '<div><img src="../media/com_concilium/images/twitter/{sn}-logo-med.png" />{id}</div>';
                    }
                }
            } 
```

所以我了解商店在 extJS MVC 设置中的工作方式。此处的文档：http: //docs.sencha.com/ext-js/4-0/#! [/api/Ext.form.field.ComboBox-cfg-store](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.form.field.ComboBox-cfg-store)

因此，我使用 Windows 资源管理器在所有组件文件的根目录中搜索了“twittersearch”，以找到正确的 twittersearch.js 存储文件。这里是：

```
Ext.define('Container.store.smcc.TwitterSearch', {
extend : 'Ext.data.Store',
model : 'Container.model.smcc.TwitterSearch',
autoLoad : false,

proxy : {
    type : 'ajax',
    url : './',
    extraParams : {
        option : 'com_concilium',
        view : 'smcc',
        format : 'raw',
        controller : 'smcc',
        task : 'getSocalMediaStream'
    },
    reader : {
        type : 'json',
        root : 'rows',
        totalProperty: 'row_count'
    }
}, 
```

});

那么这些信息是否足以创建地址并查看数据？我认为它类似于 urlbase/index.php?option=com_concilium&view=smcc&format=raw&controller=smcc&task=getSocialMediaStream

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T04:45:46.093

您应该能够创建商店

```
var store = Ext.create('Container.store.smcc.TwitterSearch'); 
```

然后打电话

```
store.load(); 
```

如果您使用 Chrome 浏览器，您应该会在 Chrome 开发者工具网络面板中看到网络请求。

[https://developers.google.com/chrome-developer-tools/docs/network](https://developers.google.com/chrome-developer-tools/docs/network)

我建议尝试使用 jsfiddle.net 复制sencha[示例](http://docs.sencha.com/ext-js/4-1/#!/example)，它可以让您轻松地“摆弄”代码。

# ruby-on-rails - 通过 ssh 与 ruby 进行 MYSQL 连接

> ID：11567025
> 
> 赞同：0
> 
> 时间：2012-07-19T18:23:45.713
> 
> 标签：ruby-on-rails, ruby, rubygems

我有两台主机：我的笔记本电脑和我需要连接到的 MYSQL 服务器。

对服务器的唯一访问是通过 ssh（使用公钥认证）。从那里我可以连接到 mysql 并发送查询。

我怎样才能在红宝石中做到这一点？我可以像这样连接到我的主机

```
Net::SSH.start(ssh_host, ssh_user, :port => ssh_port, :keys => keys, :passphrase => passphrase) do |ssh|
  result = ssh.exec!('ls')
  puts result
end 
```

但我不知道如何从这里开始:(有没有人遇到过同样的问题？

# ide - IDE设置的动态文件路径？

> ID：11567026
> 
> 赞同：0
> 
> 时间：2012-07-19T18:23:54.417
> 
> 标签：ide, filepath, application-settings, usb-flash-drive

您可以为闪存 USB 上的 Windows 应用程序设置动态添加驱动器号吗？

它会是一个环境变量吗？如果是，它会被称为什么？->（即*%root%/Qt/4.8.1/bin*）

**问题示例：**

我在我的闪存驱动器上安装了 Qt SDK 1.2.1，以便在没有环境的任何工作站上即插即用。问题是如果驱动器号未分配为与我安装时相同，则无法链接或编译。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:38:28.503

一种方法（如果您的 IDE 支持）可能是使用环境变量来引用驱动器名称。然后当你知道字母时，设置环境。var 到适当的值。

*注意*：根据您的操作系统，您可能需要重新启动 IDE 以获取环境中的更改。多变的

# java - 应用引擎java openid教程错误

> ID：11567028
> 
> 赞同：0
> 
> 时间：2012-07-19T18:23:56.337
> 
> 标签：java, google-app-engine, openid, guice

我正在逐字阅读本教程：

[https://developers.google.com/google-apps/marketplace/tutorial_java](https://developers.google.com/google-apps/marketplace/tutorial_java#Structure-ListingDev)

*   部署到我的应用引擎应用 id nimbits-domains。我在 web.xml 中设置了我的消费者密码和 api 密钥。可下载的示例编译和部署正常。当我通过市场将应用程序添加到我的域，然后启动应用程序时，我的应用程序引擎日志中出现错误：

    来自 servlet javax.servlet.UnavailableException 的未捕获异常：com.google.inject.ProvisionException：Guice 配置错误：

    ```
    1) Error injecting constructor, java.lang.NullPointerException
      at com.google.code.samples.apps.marketplace.openid.appengine.AppEngineTrustsRootProvider.<init>(AppEngineTrustsRootProvider.java:33)
      while locating com.google.code.samples.apps.marketplace.openid.appengine.AppEngineTrustsRootProvider
      while locating com.google.step2.xmlsimplesign.TrustRootsProvider
        for parameter 0 at com.google.step2.xmlsimplesign.CachedCertPathValidator.<init>(CachedCertPathValidator.java:61)
      while locating com.google.step2.xmlsimplesign.CachedCertPathValidator
        for parameter 0 at com.google.step2.xmlsimplesign.Verifier.<init>(Verifier.java:51)
      while locating com.google.step2.xmlsimplesign.Verifier
        for parameter 1 at com.google.step2.discovery.LegacyXrdsResolver.<init>(LegacyXrdsResolver.java:91)
      while locating com.google.step2.discovery.LegacyXrdsResolver
      while locating com.google.step2.discovery.XrdDiscoveryResolver
        for parameter 1 at com.google.step2.discovery.Discovery2.<init>(Discovery2.java:167)
      while locating com.google.step2.discovery.Discovery2
        for parameter 1 at com.google.step2.ConsumerHelper.<init>(ConsumerHelper.java:60)
      while locating com.google.step2.ConsumerHelper 
    ```

我想知道示例代码是否已过时。特别是 GuiceModule 中的这种方法：

```
 /**
     * Overrides for running on GAE.  Need to ue special HTTP fetchers & explicitly set the trust roots
     * since the built-in java equivalents are not available when running in GAE's sandbox.
     */
    public static class AppEngineModule extends AbstractModule {
        @Override
        protected void configure() {
            bind(HttpFetcher.class)
                .to(AppEngineHttpFetcher.class).in(Scopes.SINGLETON);
            bind(TrustRootsProvider.class)
                .to(AppEngineTrustsRootProvider.class).in(Scopes.SINGLETON);
            bind(org.openid4java.util.HttpFetcher.class)
                .to(Openid4javaFetcher.class)
                .in(Scopes.SINGLETON);
         }
    } 
```

有谁知道将 OpenID 和 Google Apps 与 Java 和 GAE 一起使用的工作示例？这个样品是坏的还是我的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:39:20.587

apps-marketplace-resources 项目中的[helloworld-java](http://code.google.com/p/apps-marketplace-resources/source/browse/#svn/trunk/helloworld-java)示例应该与 App Engine 兼容。如果它对您不起作用，那么样本可能已过时。

但是，我的理解是，使用 OAuth 2（而不是 OpenID 单点登录 + 自动将 OAuth 范围列入白名单）现在是市场应用程序可接受的方法。这在 App Engine 上得到了更好的支持（通过各种 Google 编写的客户端库）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T13:10:56.903

我多次阅读教程，它已经过时了。通过下载 eclipse、（我使用 intellij）安装 google 工具，并使用提供的 UI 将应用程序发布到市场，我能够在 App Marketplace 上获得一个使用 SSO 的测试项目。那么至少我有一些工作要做。

# extjs - 在 ExtJS 自定义渲染器中，如何判断列标题是否已被单击？

> ID：11567034
> 
> 赞同：0
> 
> 时间：2012-07-19T18:24:24.653
> 
> 标签：extjs, extjs3

我有一个带有自定义渲染器的 ExtJs EditorGridPanel。基本思想是当需要注册一个项目时显示一个复选框，当一个项目已经注册时显示文本已注册。除了单击标题，整个网格重新渲染并且每个单元格切换之外，一切都在流畅地工作。此外，排序不起作用。如何判断何时单击了标题，以便我的所有复选框都不会切换？如何修复列的排序？现在它没有排序。在此先感谢您的帮助。

```
var colModel = new Ext.grid.ColumnModel(
    {
    columns: [
        { id: 'ItemOid', header: "ItemOid", width: 100, sortable: true, locked: true, dataIndex: 'ItemOid', hidden: true },
        { id: 'nNumber', header: "N-#", width: 100, sortable: true, locked: true, dataIndex: 'NNumber' },
        { header: "Make", width: 150, sortable: true, dataIndex: 'Make' },
        { header: "Model", width: 150, sortable: true, dataIndex: 'Model' },
        { header: "Register",
            width: 55,
            sortable: true,
            dataIndex: 'Register',
            xtype: 'checkcolumn',
            renderer: renderFunction
        }
    ]
    });

function renderFunction(value, metaData, record, rowIndex, colIndex, store) {

    if (!store.getAt(rowIndex).data['ItemNeedsRegistered'])
        return 'Registered';

    var isRegistered = store.getAt(rowIndex).data['Registered'];
    var renderString;

    if (initialItemRender || isRegistered) {
        renderString = '<input type="checkbox" id="chkRegistered' + rowIndex + '" />';
        store.getAt(rowIndex).data['Registered'] = false;
    } else {
        renderString = '<input type="checkbox" checked="yes" id="chkRegistered' + rowIndex + '" />';
        store.getAt(rowIndex).data['Registered'] = true;
    }

    return renderString;
}

var grid = new Ext.grid.EditorGridPanel({
        store: itemStore,
        cm: colModel,
        sm: new Ext.grid.RowSelectionModel({ singleSelect: true }),
        viewConfig: {
            forceFit: true
        },
        height: 100,
        split: true,
        region: 'north'
    }); 
```

这是我的第二次尝试，也失败了，尝试更新基础值并且它不检查或取消检查。

```
function renderFunction(value, metaData, record, rowIndex, colIndex, store) {

    if (!store.getAt(rowIndex).data['ItemNeedsRegistered'])
        return 'Registered';

    var isRegistered = store.getAt(rowIndex).data['Registered'];
    var renderString;

    if (initialItemRender || !isRegistered) {
        renderString = '<input type="checkbox" id="chkRegistered' + rowIndex + '"' 
        + ' onClick="updateStoreOnClick(' + rowIndex + ', true);"'
        + ' />';
    } else {
        renderString = '<input type="checkbox" checked="yes" id="chkRegistered' + rowIndex + '"'
        + ' onClick="updateStoreOnClick(' + rowIndex + ', false);"'                
        + ' />';
    }

    return renderString;
}

function updateStoreOnClick(rowIndex, value) {
    store.getAt(rowIndex).data['Registered'] = value;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T15:43:17.040

发生切换问题是因为您`Registered`在呈现期间直接更新每个记录的属性。下一次渲染网格时（例如，排序时），所有记录`Registered`属性的值都是与它们开始时相反的布尔值。您可能不应该在渲染期间更改这些属性，而是在保存之前找到一种从复选框中获取正确值的方法。

对于排序，您可以在记录上手动创建一个数字属性，其中包含专门用于排序的半任意值。例如，调用属性`RegisteredSort`并为其赋予以下值：

*   1 — 不需要注册的项目
*   2 — 注册项目
*   3 — 未注册项目

然后，您使用该`RegisteredSort`属性作为该`dataIndex`列的 ，而不是`Registered`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T14:57:58.953

我相信当您单击标题时 rowIndex 将为 0 ......添加怎么样

```
if(rowIndex == 0) return; 
```

到 renderFunction 的顶部？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T12:49:19.337

我最终做了一个自定义检查列：

```
 //#region Custom Check Column
    AVRMS.AircraftRegisterCheckColumn = Ext.extend(Ext.grid.Column, {
    /**
        * @private
        * Process and refire events routed from the GridView's processEvent method.
        */
        processEvent: function(name, e, grid, rowIndex, colIndex) {
            if (name == 'mousedown') {
                var record = grid.store.getAt(rowIndex);

                if (grid.store.getAt(rowIndex).data['AircraftNeedsRegistered'])
                    record.set(this.dataIndex, !record.data[this.dataIndex]);

                return false; // Cancel row selection.
            } else {
                return Ext.grid.ActionColumn.superclass.processEvent.apply(this, arguments);
            }
        },

        renderer: function(v, p, rec, rowIndex, colIndex, store) {
            if (!store.getAt(rowIndex).data['AircraftNeedsRegistered'])
                return store.getAt(rowIndex).data['Status'];

            p.css += ' x-grid3-check-col-td';
            return String.format('<div class="x-grid3-check-col{0}">&#160;</div>', v ? '-on' : '');
        },

        // Deprecate use as a plugin. Remove in 4.0
        init: Ext.emptyFn
    });

    Ext.reg('airRegChkCol', AVRMS.AircraftRegisterCheckColumn);

    // register ptype. Deprecate. Remove in 4.0
    Ext.preg('airRegChkCol', AVRMS.AircraftRegisterCheckColumn);

    // register Column xtype
    Ext.grid.Column.types.airRegChkCol = AVRMS.AircraftRegisterCheckColumn;

    //#endregion

//#region ColumnModel
var colModel = new Ext.grid.ColumnModel(
    {
        columns: [
            { id: 'AircraftOid', header: "AircraftOid", width: 100, sortable: true, locked: true, hideable: false, dataIndex: 'AircraftOid', hidden: true, menuDisabled: true },
            { id: 'nNumber', header: "N-Number", width: 75, sortable: true, locked: true, hideable: false, dataIndex: 'NNumber', menuDisabled: true },
            { header: "Make", width: 150, sortable: true, hideable: false, dataIndex: 'Make', menuDisabled: true },
            { header: "Model", width: 150, sortable: true, hideable: false, dataIndex: 'Model', menuDisabled: true },
            {
                header: "Airworthy",
                width: 75,
                sortable: true,
                hideable: false,
                dataIndex: 'Airworthy',
                menuDisabled: true,
                renderer: function (value, metaData, record, rowIndex, colIndex, store) {
                    if (value == true)
                        return 'Yes';
                    return 'No';
                },
                editor: new Ext.form.ComboBox({
                    id: 'makeCombo',
                    typeAhead: true,
                    store: airworthy,
                    triggerAction: 'all',
                    forceSelection: true,
                    mode: 'local',
                    allowBlank: false,
                    selectOnFocus: true,
                    lazyRender: true,
                    listClass: 'x-combo-list-small'
                })
            },
            {
                id: 'Register',
                header: "Select to Register",
                width: 75,
                sortable: true,
                dataIndex: 'Register',
                xtype: 'airRegChkCol',
                hideable: false,
                menuDisabled: true
            }]
    });

//#endregion

//#region grid
var grid = new Ext.grid.EditorGridPanel({
    store: aircraftStore,
    cm: colModel,
    sm: new Ext.grid.RowSelectionModel({ singleSelect: true }),
    viewConfig: {
        forceFit: true
    },
    height: 100,
    split: true,
    region: 'north'
});
//#endregion 
```

# javascript - 通道 Google App Engine channel.open() 不起作用

> ID：11567035
> 
> 赞同：2
> 
> 时间：2012-07-19T18:24:27.757
> 
> 标签：javascript, python, google-app-engine, channel-api

打开频道时出现问题。我在服务器端有这个：

```
 def get(self):
        user = users.get_current_user()
        if not user:
            self.redirect(users.create_login_url(self.request.uri))
            return
        channel_id=str(str(random.randint(0,1000)))
        token = channel.create_channel(channel_id)
        template_values = {
                           'token': token,
                           'me': user.user_id()
                           }

        logger.debug("Token: %s user:%s %s %s" % (token,user.user_id(),user.nickname(),user.email()))
        self.response.out.write(template.render('templates/index.html', template_values)) 
```

这在 HTML (templates/index.html) 上

```
<html>
<head>
  <script type="text/javascript" src="/_ah/channel/jsapi"></script>
</head>
<body>
    {{ token }}
    <script>alert("a0");
        var token = {{ token }};
        alert("a1");
        var channel = new goog.appengine.Channel(token);
        alert("a2");
        var socket = channel.open();
        alert("a3");

        socket.onopen = function(){
            alert("open");
        };

        socket.onmessage = function(m){
            var data = $.parseJSON(m.data);
            alert(data)
        };
        socket.onerror =  function(err){
            alert("Error => "+err.description);
        };
        socket.onclose =  function(){
            alert("channel closed");
        };
  </script>
</body>
</html> 
```

我发出警报以查看是否一切正常，但 a0 a1 a2 被提出，而 a3 没有。哪里有问题？为什么 channel.open() 不起作用？

PS：有没有办法在javascript中追踪这些错误？比猜测错误在哪里更有效的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T07:39:19.867

我有同样的问题。它在本地主机上运行良好，但在我上传后无法正常工作。似乎令牌并不总是开始正确格式化，您需要修剪它们。

因此，以下带有“1”的警报，但随后崩溃：

```
if(user != null)
{
    $.get("tutorial",{channelKey:userId} ,function(data) {alert(data); token = data;
    alert(userId);
    channel = new goog.appengine.Channel(data);
    alert(1);
    socket = channel.open();
    alert(2);
    socket.onopen = onOpened;
    alert(3);
    socket.onmessage = onMessage;
    alert(4);
    socket.onerror = onError;
    alert(5);
    socket.onclose = onClose;
    alert(6);
}); 
```

如果您将其更改为：

```
if(user != null)
{
    $.get("tutorial",{channelKey:userId} ,function(data) {alert(data); token = data;
    alert(userId);
    channel = new goog.appengine.Channel(data.trim());
    alert(1);
    socket = channel.open();
    alert(2);
    socket.onopen = onOpened;
    alert(3);
    socket.onmessage = onMessage;
    alert(4);
    socket.onerror = onError;
    alert(5);
    socket.onclose = onClose;
    alert(6);
}); 
```

但是，它可以完美运行并打开通道！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:38:36.260

要进行调试，请使用 Firebug 或 Chrome 调试器。您可以通过在 Javascript 中添加行来将消息记录到控制台：

```
window.console.log("Message") 
```

仔细检查您为“令牌”获得的值是否确实是正确的令牌。

# python - 平铺地图和精灵：我做对了吗？

> ID：11567039
> 
> 赞同：2
> 
> 时间：2012-07-19T18:24:52.363
> 
> 标签：python, 2d, tiles, pyglet

我正在用 Python + pyglet 开发一个老式的 2D RPG。

该地图由几层（最多 10 层）组成，每一层都由正方形瓦片（32x32 像素）组成。精灵（派对角色、NPC 和其他一些东西）在两层之间绘制（通常就在最后一层之前）。

为了渲染它，我使用一个带有许多 OrderedGroups 的 Batch：每层一组，每个精灵一组。

sprite 的问题是它们必须按 y 值的递减顺序呈现，因此组排列如下（假设地图中有 3 层，并且必须在最后一个之前绘制 2 个 sprite）：

```
g[0] = OrderedGroup(0) : first layer
g[1] = OrderedGroup(1) : second layer

g[2] = OrderedGroup(2) : empty, serves as a base for the following :
OrderedGroup(0, parent = g[2]) : the highest sprite
OrderedGroup(1, parent = g[2]) : the lowest sprite

g[3] = OrderedGroup(3) : the third layer 
```

当我将图层精灵添加到批处理时，我指定它们是静态的。当我添加派对精灵时，它们是“动态的”。

所以我的第一个问题：既然它们都属于同一个批次，是不是很矛盾？（换一种说法：“静态”或“动态”是精灵对象还是批处理的属性？）（注意：我确切地说我对 OpenGL 的了解很少，也不知道批处理和组是如何实现的）

目前，性能是正确的（我想要 60 fps，并且我有最多 8 个移动精灵），但是当移动精灵超过 8 个时，性能会迅速下降（这在最终游戏中不应该发生，但我想要我的引擎是最高效的，无需在 C/ASM 中翻译部件）。

所以我的第二个问题：我选择的策略（使用批处理，并且尽可能少）是好的策略吗？

提前感谢您的回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-22T12:39:37.547

我不是 Pyton 或 Pyglet 用户，但这里有一些提示：

1.  **你使用 OpenGL**

    所以你不需要任何`Y`和或视图平面排序渲染。**Z-Buffer**将为您完成此操作，因此绘制顺序可以是任何...除非您使用透明图块（在这种情况下您别无选择）。

2.  **你提供代码**

    但它实际上并没有说明什么，请确保您不对渲染中的任何内容进行排序/分组。似乎您在每一帧上都创建了有序列表，这可能会非线性地影响性能。通常对于硬件加速的代码来说一切都很好，直到你遇到一些关键的瓶颈，然后一切都突然变糟了！！！

3.  **将图层地图保存在单独的 2D 地图中**

    那么你根本不需要任何排序/分组。如果对象从一层到另一层，则只需相应地更新展位层

# php - PHP Clean URL 未按预期工作

> ID：11567042
> 
> 赞同：-1
> 
> 时间：2012-07-19T18:25:00.583
> 
> 标签：php, apache, .htaccess, clean-urls

我正在尝试使用 .htaccess 文件来更改我的网址

```
xxx/table/change.php?id=1 
```

至

```
xxx/table/change/1 
```

我的 .htaccess 文件中有以下代码，该文件位于我网站的根文件夹中。

```
RewriteEngine On
RewriteRule ^change/([^/\.]+)/?$ change.php?id=$1 [L]
RewriteRule ^change/([^/\.]+)/?$ change.php?id=$1 [L] 
```

但是，当我重新启动 Apache 并访问所需的 URL 时，它仍然显示为

```
xxx/table/change.php?id=1 
```

有什么建议么？

httpd.conf 文件中未注释 mod_rewrite。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:27:56.797

你怎么用

```
change/(\d+)$ change.php?id=$1 [L] 
```

那是你访问的时候

```
xxx/table/change/1 
```

你没有被重定向或 404，你得到了正确的页面。那是你要找的吗？

# ruby-on-rails-3 - rails 3单表继承与多种形式

> ID：11567044
> 
> 赞同：0
> 
> 时间：2012-07-19T18:25:13.433
> 
> 标签：ruby-on-rails-3, single-table-inheritance

我已经设置了一个使用单表继承的 Rails 应用程序，但我需要为我的子类设置一个不同的表单。该应用程序保留了一系列安全威胁指标，例如恶意 IP 地址。所以我有一个名为 Indicator 的类，它包含大部分信息。但是，如果指标是恶意软件哈希，我需要收集更多信息。所以我创建了另一个名为 MalwareIndicator 的类，它继承自 Indicator。一切都很好。

我希望我的路线安静且看起来不错，所以我在 config/routes.rb 文件中有这个

```
resources :indicators
resources :malware, :controller => "indicators", :type => "MalwareIndicator" 
```

这很好用。我有所有这些路由都指向我的单个控制器。但是在控制器中我不确定如何处理多种形式。例如，如果有人去恶意软件/新的指标#New 函数被调用，它能够找出用户想要创建一个 MalwareIndicator。那么我的 respond_to 块必须是什么样子才能将用户发送到正确的表单？现在它仍然将用户发送到新的指标表单。

```
 def new
    if params[:type] == "MalwareIndicator"
        @indicator = MalwareIndicator.new
    else
        @indicator = Indicator.new
    end
    @pagename = "New Indicator(s)"

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @indicator }
    end
  end 
```

我觉得我很接近。另一方面，我可能做错了所有事情，所以如果有人想扇我一巴掌并说“别当个笨蛋”，我也会感激不尽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:15:56.833

I usually try to avoid STI because there are only troubles with that (image third indcator with different attributes and fourth and fifth with more fields and before you realize you end up with huge table where most columns are unused). To answer your question: you can create different `new` views for different classes and respond like that:

```
respond_to do |format|
  format.html { render action: "new_#{@indicator.class.to_s.underscore}"   }
  format.json { render json: @indicator }
end 
```

that should render `new_indicator.html.erb` or `new_malware_indicator.html.erb` depends on `@indicator` class.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T14:36:27.310

我在视图本身中处理了它。恶意软件的路由条目导致控制器接收类型参数，控制器使用该参数创建正确类的实例。在 new.html.erb 文件中，我把它放在最后：

```
<%= render :partial => @indicator.class.to_s.downcase %> 
```

因此，如果控制器创建了 MalwareIndicator，则@indicator.class.to_s.downcase 将返回malwareindicator。我有一个名为 _malwareindicator.html.erb 的部分文件，其中包含正确的格式。

因此，如果我必须创建指标类的另一个后代，我可以将另一个资源条目添加到路由文件并创建一个名为 _whateverindicator.html.erb 的部分，它应该可以正常工作。

# iphone - 为什么我的 NSRange 总是 0？

> ID：11567049
> 
> 赞同：0
> 
> 时间：2012-07-19T18:25:41.770
> 
> 标签：iphone, objective-c, ios, calculator, nsrange

我想为我的计算器应用程序实现一个删除键。我的伪代码是：

```
foo = length of current number
bar = length of current number-1

current number = current number with character at index (foo-bar) removed 
```

为了在 Objective-C 中做到这一点，我尝试使用 NSRange 函数以及 StringbyappendingString 方法来实现它：

```
- (IBAction)DelPressed {
if ([self.display.text length] >=2)
{

    int len = [self.display.text length];//Length of entire display

    //Add to the brainlong printing out the length of the entire display
    self.brainlog.text = [NSString stringWithFormat:@"Len is %g",len];

    int le  = ([self.display.text length]-1);//Length of entire display - 1
    NSString *lestring = [NSString stringWithFormat:@"LE is %g",le];

    //Add to the brainlog printing out the length of the display -1
    self.brainlog.text = [self.brainlog.text stringByAppendingString:lestring];    

    NSRange range = NSMakeRange(le, len);//range only includes the last character

    self.display.text = [self.display.text stringByReplacingCharactersInRange:range withString:@" "];//Replace the last character with whitespace
} 
```

Brainlog 的输出（即 le 和 len 的长度）是：

```
Len is -1.99164 Le is -1.99164 
```

很难看，但这是我使用 iOS 模拟器输入计算器的数字的图像： ![iOS sim 图片](../Images/8c915de56a095dbc9de945d3da3b5aac.png)

我试图更改 le 的值（即，使其显示长度为 -3 或 -5 等），并且 le 和 len 仍然相同。

我还尝试使 le 参考 len：

```
 int len = [self.display.text length];//Length of entire display
    //Add to the brainlong printing out the length of the entire display
    self.brainlog.text = [NSString stringWithFormat:@"Len is %g",len];

    int le = len-1; 
```

但是两者的价值观还是一样的。如何使用 NSRange 删除显示的最后一个字符？

**编辑**：使用达斯汀的修复，我现在将一个相当冗长的函数简化为 6 行代码：

```
 -(IBAction)DelPressed{
    if ([self.display.text length] >=2)
    {
         self.display.text = [self.display.text substringToIndes:[self.display.text length] -1];
    }
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T18:31:30.417

改为使用`substring`；如果您只想删除最后一个字符，那就更好了。

进一步来说，`substringToIndex(/*length-1*/)`

如果您需要使用字符串做其他事情，请查看[此参考](http://www.techotopia.com/index.php/Working_with_String_Objects_in_Objective-C#Searching_for_a_Substring)

# prolog - Prolog 差异列表：代码适用于 SWI 和 GNU Prolog，但不适用于 Yap

> ID：11567050
> 
> 赞同：3
> 
> 时间：2012-07-19T18:25:45.970
> 
> 标签：prolog, yap

当我在 GNU Prolog 和 SWI Prolog 上运行此代码时，它会正确计算差异列表中的元素数量。然而，Yap 进入了一个无限循环。

```
count(X-X1,0) :- unify_with_occurs_check(X,X1), !.
count([H|T]-T1,N) :- count(T-T1,M), N is M+1.

?- count([1,2|A]-A,N). 
```

为什么 Prolog 解释器（如 Yap）在询问此查询时不会终止？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T13:32:46.183

Yap 5.1.3 中似乎有一个错误

较新的版本（用 Yap 6.2.2 测试）工作正常：

```
?- count([1,2|A]-A,N).
   N = 2 
```

# parser-generator - 什么解析器生成器软件在 C# 上运行，使用左递归解析语言并可以生成抽象语法树？

> ID：11567051
> 
> 赞同：3
> 
> 时间：2012-07-19T18:25:47.063
> 
> 标签：parser-generator, compiler-compiler

我花了一上午的时间来了解 ANTLR 的基础知识，才发现它只是 LL。我需要在我的语法中保留左递归，以便语法树具有从左到右的关联性。

**编辑 2：** 最近我需要另一个解析器生成器。虽然 MPEx 和 MPPG 工作，但配置起来有些冗长，所以我想我会再看一遍。这次我遇到了 Hime Parser Generator——在一两个小时内，我就有一个解析器将基本表达式转换为可以编译和调用的 LINQ 表达式。这很简单，我推荐它而不是 MPEx 和 MPPG。

**编辑 1：** GOLD Parser 可以满足我的需要，但它的源不可用，因此无法使用它。

MPlex 和 MPPG 是 Microsoft 的官方产品，分别是 Lex/Flex 和 Bison/Yacc。关于它们的文档并不多，它们也不是上述开源项目的完全克隆，但可以用这些来做我需要的事情。如果你不需要处理现实世界的政治，我推荐 GOLD，因为它有一个很好的调试 GUI 和一切，但如果你被迫开源或微软官方项目，MPLex 和 MPPG可能是要走的路。请注意，上述两个应用程序实际上只是 GPLEX 和 GPPG 的衍生产品。后两者可能比微软的衍生产品更新，因为我认为微软放弃了这个项目。我能找到的有关 Microsoft 衍生产品的唯一文档包含在 VS 2008 SDK 中的两个 PDF 文件中。微软拿走了pdf' 尽管随 VS 2010 SDK 一起提供了 exe，但还是解释了它们的用法。不过，看起来 pdf 和 exe 都不会随 2012 一起提供。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:52:40.577

生成 C# 代码的更流行的方法之一是：[GOLD Parsing System](http://goldparser.org/) (LALR)。

有关许多解析器生成器的比较，请参阅：[http ://en.wikipedia.org/wiki/Comparison_of_parser_generators](http://en.wikipedia.org/wiki/Comparison_of_parser_generators)

# android - 为什么 DialogFragment 不能是内部类？

> ID：11567052
> 
> 赞同：10
> 
> 时间：2012-07-19T18:25:52.257
> 
> 标签：android, android-dialogfragment

如果我将我的`DialogFragment`声明为**内部**类，我得到一个`InstantiationException`on `orientation change`，即重新创建实例时，它表示没有公共构造函数，类不是公共的等。事实上，一切都是`public`，默认构造函数就位。如果我只是将它`DialogFragment`移到一个单独的文件中 - 一切都会好起来的。我不是在寻找解决方法，我只是想了解为什么会这样。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T18:59:46.433

这似乎是 Java 中基于如何`Fragments`创建和重新创建的限制。

似乎所有`Fragment`s 在某些情况下都必须重新实例化^([[1]](https://stackoverflow.com/questions/8275571/android-fragment-re-instantiation-error))，例如方向变化（我会在初始化时猜测，这取决于 s 的`Fragment`创建方式）。这意味着它将从您的外部类外部重新实例化。`static`但是，不能从外部类外部实例化非内部类。^([[2]](http://www.javaworld.com/javaworld/javaqa/1999-08/01-qa-static2.html))还有其他情况`Fragment`需要从课堂外与 a 进行沟通。^([[3]](https://groups.google.com/forum/#!msg/adt-dev/Y4gKHH-KAOs/-AmrPhydUm4J))

# android - 使用异步任务从 url 加载位图并处理并发

> ID：11567056
> 
> 赞同：0
> 
> 时间：2012-07-19T18:26:07.750
> 
> 标签：android, bitmap, android-asynctask

[我使用了与Multithreading For performance](http://android-developers.blogspot.in/2010/07/multithreading-for-performance.html)链接中所示相同的代码，但我无法在屏幕上看到图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:57:13.497

Dear Its 2012 尝试使用最新功能下载图像或其他内容

它有以下内容：1）进度条2）在下载管理器类中提供url 3）注册BroadcastReceiver以在下载后获取下载数据。

[下载管理器类示例](http://www.vogella.com/blog/2011/06/14/android-downloadmanager-example/)

希望这是最简单的一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:11:20.270

相信我，如果出于 UI 目的，您不想自己手动完成。如果您只想向用户显示图片，那么在 Android 上太乱了。只需在这些场景中使用[http://loopj.com/android-smart-image-view/](http://loopj.com/android-smart-image-view/)，它还包括缓存，并将帮助您解决 Android 容易出现的内存不足问题。

当你开始工作时，一定要阅读 SmartImageViews 内部的工作原理，你可能会学到一些东西。

# asp.net - 如何在 https 上运行特定页面

> ID：11567057
> 
> 赞同：0
> 
> 时间：2012-07-19T18:26:08.337
> 
> 标签：asp.net, appharbor

我使用了一个规则将页面重定向到 https。以下是 web.config 中的规则：

```
 <rules>

      <rule name="HTTPs Redirect" stopProcessing="true">
        <match url="(.*)" />
        <conditions>
          <add input="{ALL_HTTP}" matchType="Pattern"
               pattern="HTTP_X_FORWARDED_PROTO:https" ignoreCase="true" negate="true" />            
        </conditions>
        <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" />
      </rule>
  </rewrite> 
```

此规则将所有页面重定向到 https，但我想重定向我的应用程序的某些页面，例如如果我有两个页面 test.aspx 和 test1.aspx，那么我想将 test.aspx 重定向到 https，将 test1.aspx 重定向到 http。怎么可能。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-21T02:13:30.923

`match`您可以详细说明元素中已有的 url 正则表达式（[详细信息](https://stackoverflow.com/questions/7304689/iis-7-redirect-using-conditions)），也可以添加[其他条件](https://stackoverflow.com/questions/10678956/iis-url-rewrite-rule-redirect-with-mask)。

# c# - 我们应该把我们的枚举放在哪里？

> ID：11567061
> 
> 赞同：4
> 
> 时间：2012-07-19T18:26:24.017
> 
> 标签：c#, java, c++, coding-style, enums

当我用 Java 开发时，一个简短的问题总是困扰着我。我实际上使用了很多不同的枚举，但我从来不知道应该把它们放在哪里。通常，我创建一个名为*enumeration*的特殊包，我很确定这不是最佳实践。我应该将我的枚举直接放在与其最所属的类组相同的包中吗？

另外，对于另一种语言（C# 或 C++）是否也一样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T18:35:49.177

最好的决定取决于枚举的使用方式。

例如

*   如果枚举只在一个类中使用，则可以将其设为该类的内部类
*   如果一个类（例如`A`）比其他类（例如，其他类调用`A`具有枚举类型参数的方法）更多地使用枚举；您可能希望将其放在与其中相同的包/命名空间`A`中。

一般来说，根据使用最多的位置找到最佳的包/命名空间

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:35:17.763

当我的应用程序变得足够大时，我们实际上将所有枚举迁移到了一个 C# csproj/DLL 文件。该文件非常小，但由于它与所有应用程序完全分离，这意味着：

*   人们总是知道在哪里可以找到枚举
*   减少两次“重新创建”相同枚举的可能性
*   它可以直接用于服务器应用程序和客户端应用程序，以确保两者使用相同的定义

我并不是说这对每个人来说都是最好的解决方案，但它确实减少了我们的麻烦程度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T18:36:44.720

枚举的声明和放置遵循与其他变量关于可见性和块层次结构的声明和放置相同的规则。这意味着如果您将枚举的代码放在 A 类中，那么该枚举将属于 A 类。

我也在广泛使用枚举，为了创建一个干净且正确的模型，我尝试做的是将枚举放在它所属的位置，因为大多数时候我会在这个地方使用它——不管它是否是一个命名空间，一个类或嵌套类。当我从其他任何地方使用枚举时，我将不得不明确需要使用枚举的父范围，它再次对语义进行建模 - 如果编码正确 - 最好。

所以这主要是一个与对象相关的现实世界映射、语义一致性和代码可重用性的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T18:37:10.760

我不了解 Java 或 C#，但在 C++ 中，如果 C++ 类规范与类密切相关，我总是将其放入。如果它在不同的类中使用，我将它保存在一个单独的头文件中（在一个单独的命名空间中，其中保存了系统特定的枚举和常量）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T19:18:55.317

使用嵌套命名空间（请参阅此处的其他线程：[有关此的更详细信息](https://stackoverflow.com/questions/213637/where-is-the-best-place-to-locate-enum-types/11567737#11567737)）。主要的是它减少了相关子系统外部的依赖关系。

所以在枚举头文件中你得到：

```
// MyEnumHeader.h
// Consolidated enum header file for this dll,lib,subsystem whatever.
namespace MyApp
{
  namespace MyEnums
  {
    enum SomeEnum { EnumVal0, EnumVal1, EnumVal2 };
  };
}; 
```

然后在类头文件中你得到：

```
// MyInterfaceHeader.h
// Class interfaces for the subsystem with all the expected dependencies.

#include "MyEnumHeader.h"

namespace MyApp
{
  class MyInterface
  {
  public:
    virtual void DoSomethingWithEnumParam (MyEnums::SomeEnum enumParam) = 0;
  };
}; 
```

然后在客户端代码中使用“使用”语法：

```
using namespace MyApp::MyEnums; 
```

# html - 摆脱文本和 td 边框之间的空间

> ID：11567063
> 
> 赞同：0
> 
> 时间：2012-07-19T18:26:32.003
> 
> 标签：html, css, html-table, valign

我有一个`<td>`that has`valign="bottom"`和包含在 td has 中的文本`font-size:100px`。

如何摆脱`<td>`.

请在此处找到示例代码 [http://jsfiddle.net/jM8JC/1/](http://jsfiddle.net/jM8JC/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:32:53.820

While you can do this, you shouldn't. The reason there's extra space between the the lower edge of the word and the bottom border is that's where the lower parts, the [descender](http://en.wikipedia.org/wiki/Descender) of the `y`, `g`, etc, goes: [http://jsfiddle.net/davidThomas/jM8JC/17/](http://jsfiddle.net/davidThomas/jM8JC/17/) (in this demo I've set `line-height` to `1` (no unit), which places the bottom edge of the `y` against the lower border.

Adjusting the [`line-height` to `0.65`](http://jsfiddle.net/davidThomas/jM8JC/24/) places the lower edge of the word `test` against the bottom border, but it's a fairly arbitrary measurement, and dependent upon the `font-size` used, and, probably, the particular browser.

And if you add `overflow: hidden` you can also hide the descending portion of the `y` if you wish: [http://jsfiddle.net/davidThomas/jM8JC/25/](http://jsfiddle.net/davidThomas/jM8JC/25/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:30:36.310

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T18:30:49.617

You can specify `line-height:75px`for the `TD`

```
<table border="1" cellpadding="0" cellspacing="0" width="100%" height="200px">
    <tr>
        <td valign="bottom" class="test" style="font-size:100px; line-height:75px;">
            test
        </td>
    </tr>
</table>​ 
```

See an updated fiddle here: [http://jsfiddle.net/jM8JC/22/](http://jsfiddle.net/jM8JC/22/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T18:31:12.303

Just set a line height smaller than text size. Like this: [http://jsfiddle.net/jM8JC/16/](http://jsfiddle.net/jM8JC/16/)

# asp.net - 如何为数据库编写类语句

> ID：11567067
> 
> 赞同：-3
> 
> 时间：2012-07-19T18:26:46.097
> 
> 标签：asp.net, database, linq, linq-to-sql

在VB中：

```
db = New DBDataContext(c:\path\db.mdf) 
```

如何编写类语句来声明 DBDataContext：

```
Class DBDataContext
     **what code goes here**
End Class 
```

我在 LINQ-SQL 中为 Table1 创建了一个 dbml 文件。有人可以给我一些提示，我可以通过它来制作这个 Class 声明。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:04:19.393

您是否在 VB 中寻找这样的示例：

```
Using db = New DbDataContext()
    Try
        db.Connection.Open()
        db.Transaction = db.Connection.BeginTransaction()

        Using command = db.Connection.CreateCommand()
            command.Transaction = db.Transaction
            command.CommandText = File.ReadAllText("/path/to/file.sql")
            command.ExecuteNonQuery()
        End Using

        db.Transaction.Commit()
    Catch e As Exception
        db.Transaction.Rollback()
        Throw e
    Finally
        db.Connection.Close()
    End Try
End Using 
```

# email - 请求的邮箱不支持指定的 RequestServerVersion

> ID：11567071
> 
> 赞同：3
> 
> 时间：2012-07-19T18:27:16.357
> 
> 标签：email, send, exchangewebservices

我正在尝试使用 Exchange Web 服务发送电子邮件。

下面是代码：

```
ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010);
service.Url = new Uri("https://mail.mydomain.com/ews/Exchange.asmx");
service.Credentials = new WebCredentials("Username", "Password", "Domain");
EmailMessage message = new EmailMessage(service);
message.Subject = "SEND!";
message.Body = "Please work.";
message.Sender = new EmailAddress("myemailaddress@mydomain.com");
message.ToRecipients.Add("myemailaddress@mydomain.com");
message.Save();

message.SendAndSaveCopy(); 
```

但我收到以下错误：

> “请求的邮箱不支持指定的 RequestServerVersion”

帮助？

# git - 我如何知道 git 中的子模块是否已更改？

> ID：11567073
> 
> 赞同：1
> 
> 时间：2012-07-19T18:27:29.493
> 
> 标签：git, git-submodules

目前我的父项目中有一些子模块。如何判断其中一个子模块最近是否发生了变化，我需要做一个

```
git submodule foreach git pull origin master 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T18:40:55.020

子模块只不过是嵌套的 git 存储库。

试试这个命令，我没有任何带有子模块的存储库来测试它。

```
git submodule foreach 'echo $path `git status`' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:36:56.610

```
git pull --recurse-submodules=yes 
```

# python - 从第二个蜘蛛读取的文件被截断

> ID：11567075
> 
> 赞同：0
> 
> 时间：2012-07-19T18:27:42.187
> 
> 标签：python, python-2.7, scrapy

我正在使用scrapy来抓取一些数据。我有 2 只蜘蛛 = 蜘蛛 a 和 b

蜘蛛 a 获取一些数据并将其写入文件。蜘蛛 b 读取该数据。

问题是蜘蛛 b 得到一个空文件。

我可以看到蜘蛛完成工作后文件已填充。

我花了几个小时才弄清楚这一点。

代码片段：

# 蜘蛛甲

```
f = open('file.txt', 'a+')
f.write("str")
f.write("\n")
f.close() 
```

# 蜘蛛 b

```
f = open('file.txt')
for line in f:
  print line
f.close() 
```

什么都没有出来，这有什么问题？

编辑：我让它工作。我用'a'打开一个文件写一行然后关闭文件。这适用于所有线路。

修改了代码片段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:29:06.937

（1）你想要`f.close()`而不是`f.close`“蜘蛛b”。现在的方式是，您*没有*正确关闭文件，因此它的缓冲区没有被刷新。

此外，关于您在“spider a”中使用[f.flush()](http://docs.python.org/library/stdtypes.html?highlight=flush#file.flush)，请确保您了解文档中的此注释：

> 注意 flush() 不一定将文件的数据写入磁盘。使用 **flush()**后跟**os.fsync()**来确保这种行为。

事实上，除非你有充分的理由，否则最好只`close()`使用文件。如果您确实有/想要刷新它，请确保您也使用[os.sfsync()](http://docs.python.org/library/os.html#os.fsync)。

(2) 也，而不是

```
for line in f:
   print f 
```

试试这个：

```
for line in f:
   print line 
```

最后一点，看看使用`with`来管理打开的文件。例如

```
with open('file.txt') as f:
   # put file related actions here
   for line in f:
      print line 
```

将在块末尾或遇到异常时自动关闭文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:54:57.473

您的示例没有显示任何问题，除了您使用`f.close()`and制作的两个拼写错误`print line`。我的猜测是在您的真实代码中，您尝试遍历 b 中的文件，然后等待 a 添加更多数据，然后 b 尝试继续交互。你不能这样做。如果迭代器结束，则无法恢复。解决这个问题的最简单方法是使用 f.readline() 重写代码：

```
while True:
    line = f.readline()
    if not line:
        break
    print line 
```

# vb.net - 在 Visual Basic.NET 中获取睡眠/休眠和恢复/唤醒事件

> ID：11567076
> 
> 赞同：8
> 
> 时间：2012-07-19T18:27:42.253
> 
> 标签：vb.net, winapi, system-calls

我有与一些外部服务器通信的 VB.NET 应用程序（通过 Intranet 维护登录会话），我想监听睡眠/休眠事件，这样当它发生时，我想在计算机进入睡眠状态之前注销现有的会话系统，而我的应用程序将继续在后台运行，但不会做任何事情。

反之亦然，当计算机从休眠状态恢复或从睡眠状态唤醒时，我想立即登录服务器。

如何获取这些事件并执行我的代码？我相信这与我应该在 VB 中使用的 Win32 API 有关。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-22T06:01:40.743

如果您的应用程序正在使用窗口并且可以读取消息循环，您可以简单地订阅[Microsoft.Win32.SystemEvents.PowerModeChanged](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.powermodechanged.aspx)，例如：

```
AddHandler Microsoft.Win32.SystemEvents.PowerModeChanged, AddressOf SystemEvents_PowerModeChanged

Private Sub SystemEvents_PowerModeChanged(ByVal sender As Object, ByVal e As PowerModeChangedEventArgs)

    Select Case e.Mode
        Case PowerModes.Resume
        Case PowerModes.StatusChange
        Case PowerModes.Suspend
    End Select

End Sub 
```

否则，例如，如果您正在使用服务，则必须创建一个如此处所述的隐藏表单[（向下滚动到“示例 2”）](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-30T10:31:21.650

试试下面：

重新启动电脑

```
System.Diagnostics.Process.Start("Shutdown", " -r -t 00") 
```

关闭电脑

```
System.Diagnostics.Process.Start("Shutdown", " -s -t 00") 
```

# perl - perl 不能使用字符串作为数组引用

> ID：11567081
> 
> 赞同：3
> 
> 时间：2012-07-19T18:27:56.760
> 
> 标签：perl, reference, perl-data-structures

我有 4 个应用程序。我们称它们为：App1、App2、App3 和 App4。

对于这些应用程序中的每一个，我都有一个数组：例如：

```
my @App1_links = (...some data...);
my @App2_links = (...some data...);
my @App3_links = (...some data...);
my @App4_links = (...some data...); 
```

现在我的代码中有一个循环通过这 4 个应用程序，我打算做这样的事情：

```
my $link_name = $app_name . "_links";
    where $app_name will be App1, App2 etc...

and then use it as : @$link_name 
```

现在这段代码做了我不使用时打算做的事情：`use strict`但不是

```
The error is: Can't use string ("App1_links") as an ARRAY ref while "strict refs" in use at code.pm line 123. 
```

如何使用`use strict`.

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T18:41:02.337

您正在`$link_name`用作[符号引用](http://perldoc.perl.org/perlref.html#Symbolic-references)，这是不允许的`use strict 'refs'`。
尝试改用哈希，例如

```
my %map = (
    App1 => \@App1_links,
    ...
);
my $link_name = $map{$app_name}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T18:47:23.440

正如我在其他地方所说，[当您发现自己为变量名添加整数后缀时，请考虑“我应该使用数组”](https://stackoverflow.com/questions/1829922/concatenating-variable-names-in-c/1829927#1829927)。

```
my @AppLinks = (
    \@App1_links,
    \@App2_links,
    \@App3_links,
    # ...
);

for my $app ( @AppLinks ) {
    for my $link ( @$app ) {
        # loop over links for each app
    }
} 
```

或者

```
for my $i ( 0 .. $#AppLinks ) {
    printf "App%d_links\n", $i + 1;
    for my $link ( @{ $AppLinks[$i] } ) {
        # loop over links for each app
    }
} 
```

# c++ - 断言失败 - 在 Unity-Xbox 上崩溃

> ID：11567084
> 
> 赞同：2
> 
> 时间：2012-07-19T18:27:57.697
> 
> 标签：c++, visual-studio-2008, unity3d, xbox360

Unity-Xbox 崩溃后，我在 xbWatson 中不断收到此错误：

```
Assertion failed: pDestination, file c:\program files (x86)\microsoft xbox 360 sdk\include\xbox\xnamathconvert.inl, line 7124 
```

假设我对 c++ 几乎一无所知，这个错误通常意味着什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:31:44.063

错误的含义是程序员进行了检查（称为*断言*）以查看是否一切都符合他们的预期并且检查失败。如果你能弄清楚来自哪里`pDestination`（很可能必须根据它的值来猜测），你也许可以对它做点什么——无法从错误本身中分辨出来

# perl - 在 perl 中使用散列替代 foreach 循环

> ID：11567086
> 
> 赞同：4
> 
> 时间：2012-07-19T18:27:59.070
> 
> 标签：perl

我有两个文件，一个带有文本，另一个带有键/哈希值。我想用哈希值替换键的出现。以下代码执行此操作，我想知道是否有比我正在使用的 foreach 循环更好的方法。

谢谢大家

*编辑：我知道使用它有点奇怪*

```
s/\n//;
s/\r//; 
```

*而不是 chomp，但这适用于具有混合行尾字符的文件（在 Windows 和 linux 上编辑）而 chomp（我认为）不适用。*

带有键/哈希值的文件 (hash.tsv)：

```
strict  $tr|ct
warnings    w@rn|ng5
here    h3r3 
```

带有文本的文件（doc.txt）：

```
Do you like use warnings and strict?
I do not like use warnings and strict.
Do you like them here or there?
I do not like them here or there?
I do not like them anywhere.
I do not like use warnings and strict.
I will not obey your good coding practice edict. 
```

perl 脚本：

```
#!/usr/bin/perl

use strict;
use warnings;
open (fh_hash, "<", "hash.tsv") or die "could not open file $!";
my %hash =();
while (<fh_hash>)
{
    s/\n//;
    s/\r//;
    my @tmp_hash = split(/\t/);
    $hash{ @tmp_hash[0] } = @tmp_hash[1];
}
close (fh_hash);
open (fh_in, "<", "doc.txt") or die "could not open file $!";
open (fh_out, ">", "doc.out") or die "could not open file $!";
while (<fh_in>)
{
    foreach my $key ( keys %hash )
    {
        s/$key/$hash{$key}/g;
    }
    print fh_out;
}
close (fh_in);
close (fh_out); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:17:43.613

您可以将整个文件读入一个变量，并为每个 key-val 一次替换所有出现。

就像是：

```
use strict;
use warnings;

use YAML;
use File::Slurp;
my $href = YAML::LoadFile("hash.yaml");
my $text = read_file("text.txt");

foreach (keys %$href) {
    $text =~ s/$_/$href->{$_}/g;
}
open (my $fh_out, ">", "doc.out") or die "could not open file $!";
print $fh_out $text;
close $fh_out; 
```

产生：

```
Do you like use w@rn|ng5 and $tr|ct?
I do not like use w@rn|ng5 and $tr|ct.
Do you like them h3r3 or th3r3?
I do not like them h3r3 or th3r3?
I do not like them anywh3r3.
I do not like use w@rn|ng5 and $tr|ct.
I will not obey your good coding practice edict. 
```

为了缩短代码，我使用了 YAML 并将您的输入文件替换为：

```
strict: $tr|ct
warnings: w@rn|ng5
here: h3r3 
```

并使用 File::Slurp 将整个文件读入变量。当然，你可以在没有 File::Slurp 的情况下“slurp”文件，例如：

```
my $text;
{
    local($/); #or undef $/;
    open(my $fh, "<", $file ) or die "problem $!\n";
    $text = <$fh>;
    close $fh;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T21:06:58.650

一个问题

```
for my $key (keys %hash) {
    s/$key/$hash{$key}/g;
} 
```

是不是没有正确处理

```
foo => bar
bar => foo 
```

而不是交换，你最终得到所有“foo”或所有“bar”，你甚至无法控制哪个。

```
# Do once, not once per line
my $pat = join '|', map quotemeta, keys %hash;

s/($pat)/$hash{$1}/g; 
```

您可能还想处理

```
foo  => bar
food => baz 
```

通过采取最长的而不是可能以“吟游诗人”结尾。

```
# Do once, not once per line
my $pat =
   join '|',
    map quotemeta,
     sort { length($b) <=> length($a) }
      keys %hash;

s/($pat)/$hash{$1}/g; 
```

# php - 决定使用哪个 HTML 代码的 PHP 函数？

> ID：11567093
> 
> 赞同：-1
> 
> 时间：2012-07-19T18:28:59.520
> 
> 标签：php, html, if-statement

我正在寻找一个函数，比如 php 的 if else 语句，它将执行某些 html 代码。

例如：

```
<?php>
$result = 1;

if ($result == 1)
<?>

html code

else

html code 
```

因此，根据从 php 脚本获取的结果变量，输出某个 html 页面。我试过回显整个 html 页面，但它只显示 html 代码-> 标签等。

希望你能明白我想要表达的意思，询问你是否需要任何澄清问题。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T18:32:32.717

那应该工作：

```
<?php
    $result = 1;
    if($result==1) {
?>
        html code
<?php
    } else {
?>
        html code
<?php
    } 
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T18:36:14.620

> 我在使用 if else 语句时遇到的问题是，为了显示 html，我必须退出 php 编码。因此，if else 语句将不起作用。（[链接](https://stackoverflow.com/questions/11567093/php-function-that-decides-which-html-code-to-use#comment15301625_11567093)）

这并不完全正确。您可以使用以下方法：

```
<?php
// Do evaluations

if ( $result == "something" )
{
?>
    <p>Example HTML code</p>
<?php
} elseif ( $result == "another thing")
{
?>
    <span>Different HTML code</p>
<?php
} else {
?>
    <h4>Foobar.</h4>
<?php
}

// Rest of the PHP code
?> 
```

或者，如果您不想*退出 PHP 编码*，可以使用`echo`or`print`语句。例子：

```
<?php
// Evaluations

if ( $result == "foo" )
{
    echo "<p>Bar.</p>";
} else {
    echo "<h4>Baz</p>";
}

// Some else PHP code
?> 
```

请注意正确的`'`字符顺序`"`。如果您的 HTML 标记有参数，您应该注意您的步骤并使用以下方法之一：

```
echo "<span class=\"foo\">bar</span>";
echo '<span class="foo">bar</span>"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T18:53:49.547

如果你想评估一些 PHP 并稍后打印 HTML 结果，你可以使用这样的东西

```
<?php
$output = "";
if ( $result == "something" ) {
    $output = '<p>Example HTML code</p>';
} else if ( $result == "another thing") {
    $output = '<span>Different HTML code</p>';
} else {
    $output = '<h4>Foobar.</h4>';
}

// Output wherever you like
echo $output;
?> 
```

编辑（因为我不确定你在做什么；所以我只是提出不同的想法）：

如果您尝试输出整个页面，使用`header('location: newPage.html');`而不是`$output`. 这会将浏览器重定向到一个全新的网页。或者你也可以`include newPage.html`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T18:32:45.710

很接近：

```
<?php
$result = 1;    
if ($result == 1){
?>    
html code    
<?php } //close if
else {
?>    
html code    
<?php
} //close else
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T18:33:38.787

你可以回显类似这样的html代码

```
<?php
$result = 1;
if ($result == 1){
echo "<h1>I love using PHP!</h1>";
}
?> 
```

如果 Result 为 1，这将输出

```
**I love using PHP!** //but slightly bigger since its H1 
```

# java - 使用 min 或 max 等聚合函数时，resultsetmetadata.getScale() 返回 0

> ID：11567099
> 
> 赞同：0
> 
> 时间：2012-07-19T18:29:30.800
> 
> 标签：java, oracle, jdbc, metadata

在 java 应用程序中，我从 oracle 数据库中选择数值。我需要知道所选值的逗号右边的位数，所以我使用了Class的`getScale()`方法。`ResultSetMetaData`只要我在我的`select`声明中不使用诸如 min、max... 之类的聚合函数，这种方法就可以正常工作。使用 min 或 max`getScale()`时返回 0。`ColumnType`仍然与`(NUMERIC)`列值相同。

任何想法可能是什么原因？此外，我仍在寻找一种不太尴尬的解决方法。

我们用：`oci driver, Java 6, Oracle 10g`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T03:56:57.833

一般来说，任何表达式的规模都是未知的。例如，`AVG`数字列的 不能依赖于该列的原始比例。由客户来处理。`SUM`除非您有实际值，否则您怎么知道 a 的精度？同样，通过`RTRIM`or`REPLACE`函数返回的字符串的长度是多少？在查看整个结果集的实际值之前，您无法知道。

也许在 SQL 本身中，您可以知道合适的比例是多少。这个问题建议使用`cast`适当的类型。

[ResultSetMetaData getScale 返回 0](https://stackoverflow.com/questions/5354176/resultsetmetadata-getscale-returns-0)

在你的情况下，你问的是`min`and `max`。它们的特殊之处在于它们保持了色谱柱的比例和精度。也许不在驱动程序中，但从逻辑上讲，它们确实如此。如果您*必须*知道比例，则可以使用方法查看列本身的元数据，而不是结果集的元数据`java.sql.DatabaseMetadata`。

# php - 使用 DB 类时无法使用 PDO 方法

> ID：11567101
> 
> 赞同：0
> 
> 时间：2012-07-19T18:29:47.067
> 
> 标签：php, oop, pdo

嘿伙计们，我确定我又做错了，但我试图从我的类数据库中实例化一个 PDO 数据库处理程序，从我的 class.admin.php 的类 AdminSession 中的文件 class.database.php，有些东西我的依赖注入有点奇怪，它不允许我正确使用 PDO 的方法；像 fetch()、prepare() 等等。

class.database.php 文件

```
class Database
{
    public $db;   // handle of the db connection

    private static $dsn="mysql:host=server2.com;dbname=database";
    private static $user="user";
    private static $pass="pass";
    private static $instance;

    public function __construct () 
    {
        $this->db = new PDO(self::$dsn,self::$user,self::$pass,$self::$opts);
        $this->db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        $this->db->setAttribute(PDO::MYSQL_ATTR_INIT_COMMAND, "SET NAMES 'utf8'");

        switch($_SERVER['ENVIRONMENT']) {
            case 'staging':
                self::$dsn="mysql:host=server1.com;dbname=database";
                self::$user="user";
                self::$pass="pass";
                break;
            default:
                self::$dsn="mysql:host=server2.com;dbname=database";
                self::$user="user";
                self::$pass="pass";
        }

    }

    public static function getInstance()
    {
        if(!isset(self::$instance))
        {
            $object= __CLASS__;
            self::$instance=new $object;
        }
        return self::$instance;
    }

} 
```

这是我的 class.admin.php 的最顶层，以及一个引发错误的方法。现在我得到的错误

**PHP 致命错误：调用未定义的方法第 230 行**

如果我使用`$this->db-prepare($sql)`

或者

**PHP 致命错误：在非对象行 230 上调用成员函数 prepare()**

如果我使用`$db-prepare($sql)`

```
require('library/class.database.php');

class AdminSession {
    static $abs_path;

    public function __construct(Database $db) {
        session_start();

        self::$abs_path = dirname(dirname(__FILE__));
        if($_SERVER['REQUEST_METHOD'] == 'POST') {

            $this->post = $_POST; // filter_input_array(INPUT_POST, FILTER_SANITIZE_STRING);

            if(get_magic_quotes_gpc ()) {
                //get rid of magic quotes and slashes if present
                array_walk_recursive($this->post, array($this, 'stripslash_gpc'));
            }
        }

        $this->get = $_GET; // filter_input_array(INPUT_GET, FILTER_SANITIZE_STRING);
        array_walk_recursive($this->get, array($this, 'urldecode'));
    }

// other methods

    private function checkDB($username, $password) {
        $sql = "SELECT * FROM users WHERE username=:username";
        try {

            $db             = Database::getInstance();
            $stmt           = $db->prepare($sql);

                $stmt->bindParam("username", $username);
                $stmt->execute();

            $user           = $stmt->fetchAll(PDO::FETCH_OBJ);

            $db = null;

            if($user) {
                //general return
                if(is_object($user[0]) && md5($user[0]->password) == $password) {
                    return true;
                } else {
                    return false;
                }
            } else {
                return false;
            }

        } catch(PDOException $e) {
            echo '{"error":{"text":'. $e->getMessage() .'}}';
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:12:01.240

您不能将逻辑放入类定义中。相反，在构造函数中确定这些变量的值。该开关将在方法中起作用，但在定义成员时不起作用。

**编辑：**我真的觉得错过这个很傻。连接是在 switch 语句之前建立的。我不知道它会解决第二组问题......但它现在可以正常处理原始问题。

```
class Database
{
    public $db;   // handle of the db connection

    private static $opts = array(PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES utf8');
    private static $dsn="mysql:host=server2.com;dbname=database";
    private static $user="user";
    private static $pass="pass";
    private static $instance;

    public function __construct () 
    {
        switch($_SERVER['ENVIRONMENT']) {
            case 'staging':
                self::$dsn="mysql:host=server1.com;dbname=database";
                self::$user="user";
                self::$pass="pass";
                break;
            default:
                self::$dsn="mysql:host=server2.com;dbname=database";
                self::$user="user";
                self::$pass="pass";
        }

        $this->db = new PDO(self::$dsn,self::$user,self::$pass,$self::$opts);
        $this->db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    }

    public static function getInstance()
    {
        if(!isset(self::$instance))
        {
            $object= __CLASS__;
            self::$instance=new $object;
        }
        return self::$instance;
    }

} 
```

# mysql - 这个ERD有意义吗？

> ID：11567107
> 
> 赞同：1
> 
> 时间：2012-07-19T18:30:47.873
> 
> 标签：mysql, entity-relationship, erd

我正在尝试复制一个电子邮件服务提供商，其中可以存储电子邮件并根据订阅者发送电子邮件。我专注于数据结构 atm，但我不禁想到我可能做错了什么。

正如您在图中看到的，对于订阅者、列表和订阅者列表的关系。我正在尝试实现..

一个订阅者可以是许多列表的一部分，但一个列表可以包含许多订阅者。

这张图在这个问题上有意义吗？

谢谢

![在此处输入图像描述](../Images/b6d15d97e0e0e7cfcc15d8f6c31b59d7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:38:52.600

在我看来很好。因为订阅者和列表之间存在多对多关系，所以需要一个映射表（订阅者列表）来保存这些关系。

如果您从整体上询问 ERD，很难说它是否是您所需要的。关于有很多列表的订阅者和有很多订阅者的列表，你这样做的方式就是要走的路。

编辑：我不确定为什么您在订阅者表中有一个名为 Lists 的列。SubscriberList 表应该包含所有 Subscriber 和 Lists 之间的映射，并且试图在其他任何地方复制这些数据将会产生非规范化问题。

EDIT2：在这些多对多关系中，我一直想到的经典例子是用户和角色。在几乎任何复杂的 Web 应用程序中，您都有很多用户和多个角色。允许用户拥有多个角色（并且每个角色拥有多个用户）的唯一方法是创建一个映射表，如您在 ERD 中所示。

在这篇文章“多对多关系”标题下的 1/3 处可以找到一个很好的简短和中肯的解释：http: [//www.deeptraining.com/litwin/dbdesign/FundamentalsOfRelationalDatabaseDesign.aspx](http://www.deeptraining.com/litwin/dbdesign/FundamentalsOfRelationalDatabaseDesign.aspx)

# jquery - 下拉菜单闪烁，Firefox 除外

> ID：11567110
> 
> 赞同：0
> 
> 时间：2012-07-19T18:30:53.513
> 
> 标签：jquery, html, css, firefox, drop-down-menu

我遇到了与此类似的问题[Drop Down Box Keeps flickering -](https://stackoverflow.com/questions/1430183/drop-down-box-keeps-flickering-jquery-and-css)当我将鼠标移到 JQuery 和 CSS 上时，下拉菜单会闪烁，但它似乎不会在 Firefox 中发生。我在鼠标悬停事件中放置了一个警报，发现每次我`<li>`在菜单内从一个移动到另一个时都会触发警报。这是它背后的html代码的重要部分。

```
<!--// HEADER BAR //-->
<div id="header">
<!--// NAVIGATION LINKS //-->
<div id="navigation">
    <!--// AUTHENTICATED //-->
    <div id="options" class="authenticated">
        <ul>
        <li><a href="javascript: toggleAccount()" class="account" title="Account">/</a></li>
        </ul>
    </div>
    <!--// ACCOUNT MENU //-->
    <div id="account_container" style="display: none;" onmouseout="hideAccount();">
        <div id="account">
            <ul>
            <li>Options...</li>
            </ul>
        </div>
    </div>
</div>
</div> 
```

如您所见，“account_container”div 是下拉菜单。它首先出现在用户单击经过身份验证的帐户 li 时，然后在用户再次单击 li 或鼠标移出时消失。导航 div 在 css 中将其高度设置为 40px，所以我认为这可能是链接问题中的定位问题，但是将高度设置为 auto 并没有解决它，我无法将帐户容器取出导航栏，因为这会弄乱它的定位。为什么浏览器会检测到从一个菜单项切换到另一个菜单项作为 mouseout 事件，我该如何防止它？

![有问题的菜单](../Images/484038675359340f3466b846ffa73be6.png)

编辑：

我可以做类似安迪 E 对[这个问题](https://stackoverflow.com/questions/8850673/drop-down-menu-onmouseout-getting-invoked-on-the-child-node-when-set-in-the-p)的回答吗？我可以更改`onmouseout="hideAccount()"`并`onmouseout="hideAccount.call(this)"`检测鼠标是否位于 hideAccount 函数内下拉菜单的子元素上吗？如果是这样，我会怎么做？作为参考，这里是 hideAccount 函数：

```
function hideAccount(){
//alert("mouse out!");
$(".account_container").hide();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T19:30:24.367

通过将 hideAccount 函数更改为此解决它：

```
function hideAccount(event){
var to = event.relatedTarget || event.toElement;
if(this.contains(to)){
    return;
}
else{
    $(this).hide();
}
} 
```

问题是除了 Firefox 之外的每个浏览器都检测到从 account_container 到它的任何子级的移动作为 mouseout。从技术上讲，当鼠标悬停在容器内的某个列表元素上时，由于某种原因，它不再位于容器本身之上。我猜firefox是唯一一个在隐藏之前检查鼠标是否移动到子元素的浏览器。修复它的方法是在 javascript 中检查我是否在尝试隐藏之前移动到子元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T20:04:35.140

尝试这个：

```
 function toggleAccount(e){
     e.preventDefault();
     $("#account_container").toggle();   
   } 
```

# visual-studio-2010 - ADO 实体数据模型设计器在带有 EF 5 的 VS 2012 RC 中不可用？

> ID：11567111
> 
> 赞同：0
> 
> 时间：2012-07-19T18:30:57.167
> 
> 标签：visual-studio-2010, visual-studio, entity-framework-5

我使用 EF 5 RC 将 VS 2010 升级到 2012 RC，但 ADO 实体数据模型设计器不再可用。在这种情况下，如何使用 edmx 从数据库中更新 edmx？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T16:17:43.370

弄清楚：需要从包中安装 EF 工具。

# c++ - 从源代码项目中提取所有功能的工具

> ID：11567112
> 
> 赞同：4
> 
> 时间：2012-07-19T18:31:00.937
> 
> 标签：c++, c, parsing

我正在尝试构建一个可用工具列表，用于解析完整的源代码包并将所有函数/方法提取为单独的部分。我的目标是运行一个工具或脚本，立即知道包中有多少个函数，并根据需要轻松地逐个检查完整的分段函数集。

现在我正在使用 NiCad 克隆检测工具，其中包括一个用 TXL（一种树转换语言）编写的提取脚本。每个函数都被拉出并存储为 XML 文档中的唯一实体，因此处理函数列表非常方便。NiCad 包括用于 C、Java 和 Python 的提取工具。我最关心的是 C，但其余的可用也很好。我们还没有设置 C++ 解析器——那会很方便。

我还使用了 Doxygen，它具有识别调用图的额外好处。不过，这些文件中有很多标记，因此解析 Doxygen 的输出以将它们放入一个简单的函数列表中需要做一些额外的工作。

有没有人使用过提取全套功能/方法的工具？您有建议或警告吗？如果你自己写了，它在某个地方可用吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T07:36:49.627

你可以使用 linux 的 nm 工具。“nm 用于列出目标文件中的符号”。请参阅 nm 的手册页以获取更多详细信息；此处复制示例 nm 供您参考。

```
void fun1() {
    return;
}

void fun() {
     fun1();
}
int main()
{
     fun();
     return 0;
} 
```

运行“nm a.out | grep T”的上述程序的Nm

```
08048470 T __libc_csu_fini
08048400 T __libc_csu_init
080484ac T _fini
080482b8 T _init
08048320 T _start
080483d9 T fun
080483d4 T fun1
080483e3 T main 
```

# sql - ASP Classic & SQL 日期超出范围错误

> ID：11567115
> 
> 赞同：0
> 
> 时间：2012-07-19T18:31:12.767
> 
> 标签：sql, date, asp-classic

我正在将 ASP 经典应用程序移动到新服务器。我没有开发这个应用程序，我没有使用 ASP 的经验，希望有人能指导我。

应用程序中的一个页面会删除此错误：

```
Microsoft OLE DB Provider for ODBC Drivers error '80040e07' 

[Microsoft][ODBC SQL Server Driver][SQL Server]The conversion of a varchar data type to a datetime data type resulted in an out-of-range value. 

/clientname/Admin/EntregasProcess.asp, line 49 
```

我读到可能是日期格式，所以我将其更改为 yyyy-mm-dd。

现在它显示了这一点：

```
Microsoft OLE DB Provider for ODBC Drivers error '80040e07' 

[Microsoft][ODBC SQL Server Driver][SQL Server]The conversion of a varchar data type to a datetime data type resulted in an out-of-range value. 

/clientname/Admin/EntregasProcess.asp, line 62 
```

数据库上的日期格式是这样写的：

```
2006-07-31 00:00:00.000 
```

这是asp文件的代码：

```
<%@ Language=VBScript %>
<!--#include file="StrConn.asp"-->
<%

if Session("Role") <> "AD" Then 'AD=Administrador, CG = Consulta Gral.
Response.Redirect "../home.asp"
end if

%>

<%

Dim month_number, year_number, day_number, tituloEntrega, Estatus, idCuestionario, date_number

month_number = Request.Form("month_number")
year_number = Request.Form("year_number")
day_number = Request.Form("day_number")
tituloEntrega = trim(Request.Form("tituloEntrega"))
idCuestionario = Request.Form("idCuestionario")
Estatus = Request.Form("Estatus")
idEntrega = Request.Form("idEntrega")
<!--BITACORA::ESC::Oscar Salgado 20090729-->
bitacora = Request.Form("bitacora")
page = Request.Form("page")
<!--=====================================-->

date_number = dateSerial(year_number,month_number+1,day_number)

Set Conn = Server.CreateObject("ADODB.Connection")
Conn.Open strConnPortal

<!--BITACORA::ESC::Oscar Salgado 20090729-->
SQL="Delete from dbo.tbBitacoraShow where idCuestionario = " & idCuestionario
conn.execute(SQL)
if bitacora = "1" Then
    SQL="Insert into dbo.tbBitacoraShow(idCuestionario) values(" & idCuestionario & ")"
end if
conn.execute(SQL)
<!--=====================================-->

Select Case Request.Form("btnGo")

    Case "Agregar"
    if trim(tituloentrega) <> "" Then
        SQL = "Insert into tbEntregas(TituloEntrega,Date,Estatus,IDCuestionario) values('" & _
            tituloEntrega & "','" & date_number & _
            "'," & estatus & ",'" & idCuestionario & "')"
        conn.Execute sql
    end if

    'Response.Write SQL
    'Response.End

    Case "Actualizar"

    SQL = "update tbEntregas Set TituloEntrega = '" & tituloEntrega & _
        "',Date='" & date_number & " ',Estatus=" & estatus & _
        ",IdCuestionario='" & idCuestionario & "' Where idEntrega = " & idEntrega

    conn.Execute sql

    'Response.Write SQL
    'Response.End

End Select

Response.Redirect "Entregas.asp?idEntrega="&idEntrega&"&page="&page

%> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:39:03.280

好的，当您的查询未正确参数化时，这是一个常见问题。我认为这是一种不好的做法。

当开发人员将日期格式硬编码到应用程序中时，就会出现此问题。它受以下一种或多种因素的影响：

*   IIS/Web 服务器中区域/语言设置的更改
*   数据库用户中语言设置的更改

日期必须采用 ODBC 规范格式 ('yyyy-mm-dd hh:MM:ss') 以避免任何问题。这是通用格式，您可以避免我之前提到的任何因素。

我给你3个可能的解决方案：

**正确的方法**是使用“.CreateParameter()”方法在 ASP 中使用“ADODB.Command”对象正确参数化您的查询并将其附加到命令中。问题是您需要添加大量附加代码才能实现此目的。

**示例代码**

```
'-------------------------------------------------------------------'
Set oCmd = Server.CreateObject("ADODB.Command")
oCmd.CommandText = sSQL
set oCmd.ActiveConnection= oConn
Set oPar = oCmd.CreateParameter("initial_date",7,1,,dDate) 'Date
oCmd.Parameters.Append(oPar)
'-------------------------------------------------------------------' 
```

**实用的方法**是将硬编码格式更改为规范格式，以避免当前和将来可能出现的问题。

**快速解决**方法是更改​​ Web 服务器中的区域设置或数据库服务器中的语言设置，以匹配您过去的实现。

这个怎么做：

首先，您需要知道开发人员在应用程序中使用的格式：例如在墨西哥，格式为 dd/mm/yyyy，服务器通常为英文 (mm/dd/yyyy)

Web 服务器 - 区域设置

![区域设置 Windows 7](../Images/578635958c1a596a6319e701847e48ae.png)

![在此处输入图像描述](../Images/a508adcae2076adf7e21c74c7a0bec03.png)

默认语言设置 - 数据库服务器

打开 SQL Server Management Studio 转到图像显示的部分并选择

访问应用程序数据库的用户

![SQL 管理工作室](../Images/f926a7a8850ea295a882f8b0e78f8204.png)

将默认语言更改为应用程序使用的日期格式

![用户语言设置](../Images/b674901afb50b0fd1ab4a8d75eff22b8.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-01T05:00:33.867

ASP 从操作系统而不是从数据库中获取日期，这是一个常见错误，但可以通过以下方式解决：

```
<%
' Date dd/mm/yyyy
Session.lcid=2057 '= UK English
%> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T20:03:29.363

尝试将插入日期行位更改为

```
SQL = "Insert into tbEntregas(TituloEntrega,Date,Estatus,IDCuestionario) values('" & _  
        tituloEntrega & "',Convert(datetime, '" & date_number & "')," & estatus & ",'" & idCuestionario & "')" 
```

和更新到

```
SQL = "update tbEntregas Set TituloEntrega = '" & tituloEntrega & _  
    "', Convert(datetime, '" & date_number & "'),Estatus=" & estatus & _  
    ",IdCuestionario='" & idCuestionario & "' Where idEntrega = " & idEntrega 
```

您还应该知道，这段代码是`SQL Injection`等待发生的攻击

# jquery - 选择带括号 [] 的 jquery 元素

> ID：11567116
> 
> 赞同：3
> 
> 时间：2012-07-19T18:31:17.013
> 
> 标签：jquery

为什么这不起作用

```
$('div.note')[0].removeClass('hidden'); 
```

我从萤火虫那里得到这个错误：

```
TypeError: note.removeClass is not a function 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T18:32:15.267

`$('div.note')[0]`给你一个 javascript 对象，而不是 jQuery 对象，removeClass 是一个 jQuery 方法。在使用 jQuery 方法之前，您需要将其转换为 jQuery 对象。

尝试这个，

```
$($('div.note')[0]).removeClass('hidden'); 
```

或者

```
$('div.note').eq(0).removeClass('hidden'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T18:33:54.293

如果您对括号的使用不严格，那么使用`.eq()`会更加简化。

```
$('div.note').eq(0).removeClass('hidden'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T18:47:15.177

基本上，将每个 jQuery 调用视为给您一个如下所示的对象：

```
var myPosts = $(".posts");

// To help make sense of it, myPosts looks something like this.
myPosts === {
   elements : [ /* all of your returned elements */ ]
   helpfulMethod : function () { for (element in elements) { /* .... */ } },
   otherHelpfulMethod : function () { for (element in elements) { /*...*/ } }
} 
```

如果你说：

```
var element = myPosts.elements[0];
element.otherHelpfulMethod(); 
```

它会向你吐出错误。

添加 .element 的方法是事后将数组称为“this”。

你也可以这样做：

```
for (i in arr; ....) {
    this[i] = arr[i];
} 
```

并获得相同的效果。

所以调用 myPosts[0] 只会得到 HTML 元素。然后您需要将其包装在 jQuery 对象中以使用辅助方法，或者您需要使用 jQuery 辅助函数来访问该特定元素。

# ruby - 如何使 Struct.new 生成的每个类都有一个类方法？

> ID：11567117
> 
> 赞同：0
> 
> 时间：2012-07-19T18:31:18.867
> 
> 标签：ruby

我的问题是，我有一堆扩展 Struct.new 的类。现在我需要为它们添加一个通用的类方法。如果 Struct 是一个“普通”超类，我将能够在其上定义一个类方法，然后每个子类也将具有该方法。

鉴于事实并非如此，我该如何复制这种行为？例如，

```
class Foo < Struct.new(:foo); end
Foo.respond_to?(:perform) #=> true
class Bar < Struct.new(:bar); end
Bar.respond_to?(:perform) #=> true 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:12:04.400

为什么不能在 Struct 上定义方法？

```
def Struct.perform
end

class Foo < Struct.new(:foo); end
Foo.respond_to?(:perform) #=> true
class Bar < Struct.new(:bar); end
Bar.respond_to?(:perform) #=> true 
```

# string - 在散列中的所有值周围添加“”

> ID：11567118
> 
> 赞同：3
> 
> 时间：2012-07-19T18:31:19.940
> 
> 标签：string, perl

我试图用单引号将我的哈希中的所有值括起来。这是我的代码。

```
 foreach(values(%properties_hash))
    {
            print "'".$_."'\n";
    } 
```

现在我正在打印。我将如何实际增加价值。这也打印

```
'logs
'format/systemout-2010-format.txt
'analyze 
```

它只打印第一个'。为什么会这样？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T18:41:54.957

您的代码正在运行。

```
my %h = (
        'a' => 1,
        'b' => 2,
        'c' => 3,
        'd' => 4,
);

foreach(values(%h)) {
        print "'".$_."'\n";
} 
```

印刷

```
'3'
'1'
'2'
'4' 
```

您的字符串可能以“\r”结尾，因此结尾“'”打印在第一个“'”上，因此看不到最后一个撇号。尝试：

```
foreach(values(%h)) {
        s/[\r\n]//g;
        print "'".$_."'\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:33:41.710

这个怎么样？

```
foreach (keys %properties_hash) {
  $properties_hash{$_} = "'$properties_hash{$_}'\n";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T18:36:36.887

```
for (values %properties_hash) {
    $_ = "'$_'";
} 
```

但你为什么要这样做？

请注意，如果任何值中包含撇号，这将不会产生正确引用的字符串。

至于您缺少的报价，也许这些字符串中有回车符，而第二个报价覆盖了第一个？

# three.js - 透明面球体three.js

> ID：11567119
> 
> 赞同：0
> 
> 时间：2012-07-19T18:31:26.983
> 
> 标签：three.js, geometry, webgl, transparent

我正在尝试用three.js 做一个webGL 透明面球体

此处提供测试代码：WebGL Fiddle：http: [//jsfiddle.net/zbWMv/](http://jsfiddle.net/zbWMv/)

我尝试了很多东西，但我无法让它发挥作用。

我在渲染器代码中看到对面部渲染进行了排序，首先进行不透明，然后以相反的顺序透明。

所以我真的不知道下一步该怎么做......

在 canvas2D 中也是如此，效果很好。帆布 2D 小提琴：http: [//jsfiddle.net/HHUaF/](http://jsfiddle.net/HHUaF/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T20:10:57.990

好的，我成功地找到了一种使用混合的解决方案。

感谢所有试图在 IRC 上帮助我的人！

这是小提琴：http: [//jsfiddle.net/zbWMv/6/](http://jsfiddle.net/zbWMv/6/)

这不是完美的阴影，但它比以前更好;）

# sql - 客户端如何取消活动的 Oracle 查询？

> ID：11567127
> 
> 赞同：4
> 
> 时间：2012-07-19T18:31:46.697
> 
> 标签：sql, oracle

我有一个活动的 Oracle 操作需要很长时间。如何在不终止会话的情况下以编程方式取消操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T18:32:09.753

OCI 库提供此功能。典型示例是客户端在长时间运行的操作期间按下 control-C，通过信号处理程序重新获得对程序的控制，然后取消长时间运行的操作。

在内部，客户端将通过 TCP 连接发送紧急消息，服务器端将通过 SIGURG 处理程序处理终止。客户端操作将收到此状态。

```
ORA-01013 ("user requested cancel of current operation") 
```

*   C/C++：

`OCIBreak()`

[http://docs.oracle.com/cd/B10500_01/appdev.920/a96584/oci16m96.htm](http://docs.oracle.com/cd/B10500_01/appdev.920/a96584/oci16m96.htm)

[http://docs.oracle.com/cd/A97630_01/appdev.920/a96584/oci02bas.htm](http://docs.oracle.com/cd/A97630_01/appdev.920/a96584/oci02bas.htm) （在“取消呼叫”处）

*   Python（cx_Oracle）：

`conn.cancel()`

[http://cx-oracle.sourceforge.net/html/connection.html](http://cx-oracle.sourceforge.net/html/connection.html)

# android - SharedPreferences 应用程序上下文与活动上下文

> ID：11567134
> 
> 赞同：58
> 
> 时间：2012-07-19T18:32:10.290
> 
> 标签：android, sharedpreferences, android-context

我正在使用多个 SharedPreferences 在我的应用程序中存储数据。一些偏好用于很多活动。

我知道 SharedPreferences 在内部由映射支持以实现快速读取访问，并在更改设置时写入 sdcard。

我想知道如果许多活动都访问共享首选项，哪种方式更好：

1.  使用活动上下文在每个活动中实例化它。
2.  在每个活动中实例化它，但使用应用程序上下文。
3.  将它放在例如Application 类中并在那里只实例化一次，类似于单例。

如果我使用 1\. 解决方案，是否每个活动都有一个 sharedpreference 对象？当 Activity 被销毁时，sharedpreference 的内部映射会被销毁吗？

如果我使用 2\. 解决方案，尽管我在每个活动中调用 getSharedPreferences，但是否只有一个实例？只要应用程序还活着，内部映射是否会在内存中？

希望有人知道Android如何在内部处理它。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-07-19T19:20:21.943

值得查看显示实例（无论是一个实例还是一个实例）共享相同静态地图的[来源](http://grepcode.com/file_/repository.grepcode.com/java/ext/com.google.android/android/2.3.7_r1/android/app/ContextImpl.java/?v=source)。`Context``Activity``Application``HashMap<String, SharedPreferencesImpl>`

`SharedPreferences`因此，每当您通过相同名称请求一个实例时，`Context.getSharedPreferences(name, mode)`您都会获得相同的实例，因为它首先检查映射是否已经包含`SharedPreferences`键的实例（这是传递的名称）。一旦`SharedPreferences`实例被加载，它将不会再次加载，而是从地图中获取。

所以实际上你走哪条路并不重要，重要的是使用相同的名称以便从应用程序的不同部分获得相同的首选项。但是，为首选项创建一个“访问点”可能是一个加号。所以它可能是在`Application.onCreate()`.

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-07-19T19:05:57.873

`SharedPreferences`由 Android 作为单例在内部进行管理。您可以使用以下方法获取任意数量的实例：

```
context.getSharedPreferences(name, mode); 
```

只要您使用相同的**名称**，您将始终获得相同的**实例**。因此不存在并发问题。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-07-19T18:39:17.987

我更喜欢使用**单例**类作为首选项， *通过应用程序上下文初始化首选项一次*。创建 getter 和 setter(get/put) 方法来添加、更新和删除数据。

这样，它将创建一次实例，并且更具可读性和可重用性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-12T17:06:32.807

我们可以创建一个 Preferences Singleton 类并在扩展的 Application 类中使用 applicationContext 创建该类的实例，因此我们可以在整个应用程序中使用该对象我已经创建了一个 sharedPreferenceManager 类并通过提供 applicationContext 创建一个静态对象。现在静态对象可以在项目中的任何地方访问

```
public class App extends Application {
    public static App myApp;
    public static PreferenceManagerSignlton preferenceManagerSingleton;
    @Override
    public void onCreate() {
        super.onCreate();
        myApp = this;
        preferenceManagerSingleton = new PreferenceManagerSignlton();
        preferenceSingleton.initialize(getApplicationContext());
    }
}
```

访问项目中的静态对象

```
App.myapp.PreferenceManagerSignltonz.getSavedValue();
```

# jakarta-ee - NameNotFoundException EJB localbinding 有时发现有时不

> ID：11567135
> 
> 赞同：0
> 
> 时间：2012-07-19T18:32:12.500
> 
> 标签：jakarta-ee, jboss, ejb, jndi

我们有 Jboss 4.2 和很少的耳朵。

一个应用程序具有带有本地和远程绑定的 EJB。另一个使用这个 EJB。之前一切正常。

但是从上周开始发生了一些奇怪的事情——有时 JNDI 查找可以找到这个 EJB，但有时（在大多数情况下）它会得到 NameNotFoundException。

这怎么可能。问题可能出在哪里？

# ruby - 我如何删除字符串周围的引号

> ID：11567140
> 
> 赞同：1
> 
> 时间：2012-07-19T18:32:23.297
> 
> 标签：ruby, string

嗨，我想删除这个字符串周围的引号

```
str =  "[Date.UTC(2012,07,03,04,07,09),2.0]" 
```

想要这样的结果

```
 [Date.UTC(2012,07,03,04,07,09),2.0] 
```

任何帮助将不胜感激...

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T18:34:16.320

我想你想要[`eval`](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-eval)。它接受一个字符串并将其评估为 ruby​​ 代码。

```
str = "[Date.UTC(2012,07,03,04,07,09),2.0]"
a = eval str 
```

顺便说一句，这个字符串不是有效的 ruby​​ 代码。主要是因为`09`被解析为八进制数，并且`09`不是有效的八进制数。其次，类上没有`UTC`方法`Date`（无论如何在标准库中）。

## 编辑

如果您想获取此字符串并将其传递给 javascript，则只需在模板中呈现它。

```
# action.html.erb
<%= javascript_tag do %>    
  <%= str %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T18:35:47.393

如果您真的只是在询问字符串操作...如果引号位于字符串的开头和结尾...

```
str = "abcdef"
trimmed = str[1..-2] #equals "bcde" 
```

# macos - 为什么 RVM 在 mac osx 上破坏了我的 MANPATH？

> ID：11567147
> 
> 赞同：0
> 
> 时间：2012-07-19T18:32:41.960
> 
> 标签：macos, rvm, manpage

自从安装 RVM 后，我的联机帮助页就坏了。当前版本的 man 不使用 MANPATH 变量，那么为什么将其设置为 .rvm/man 以及为什么该文件夹中没有完整的手册页目录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:32:41.960

显然在脚本 ~/.rvm/scripts/initialize 中有一个设置 MANPATH 和导出的小块。只需将此块注释掉即可。现代联机帮助页动态计算路径。

违规行是：

```
#  if [[ -z "${MANPATH:-}" ]]
#  then
#    export MANPATH="${rvm_man_path}"
#
#  elif ! [[ ":${MANPATH}:" =~ ":${rvm_man_path}:" ]]
#  then
#    export MANPATH="${MANPATH}:${rvm_man_path}"
#  fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T01:44:13.113

正如@Ashely 在评论中指出的那样，这已经得到修复，正确的方法是更新 RVM：`rvm get head`并根据安装类型打开新的终端/重新登录。

# jersey - 如何记录 Jersey 看到的原始休息请求/响应？

> ID：11567152
> 
> 赞同：3
> 
> 时间：2012-07-19T18:32:51.263
> 
> 标签：jersey

我在 apache tomcat 上部署了一个基于 Jersey 的 REST 服务。我想记录对调查提出的原始请求/响应。我要查找的数据是 URL 和正文（在 POST/PUT 消息的情况下）。

如何启用此日志记录？

# c# - 如何在 asp.net webforms 中动态添加数据输入表单

> ID：11567155
> 
> 赞同：0
> 
> 时间：2012-07-19T18:33:01.880
> 
> 标签：c#, asp.net, webforms

我必须在 asp.net 网络表单中创建一个数据输入表单，用户可以在其中输入多个成员详细信息。每个成员详细信息将包含大约二十个数据项，例如名字、姓氏、出生日期等。输入的成员数量可以是 1 到 20 之间的任意值。

一旦所有成员进入或进入过程中，他们应该能够转到上一个或下一个条目并进行更改。本质上应该有一个将遍历页面的下一个和上一个按钮。最后，单击“保存”按钮时，应保存所有输入的数据。

我创建了一个 UserControl，其中包含用于输入数据的所有文本框。我创建了五个硬编码面板，它们显示用户控件五次。这使得可以进入的成员总数为五个。

当单击下一个按钮时，我想用动态添加的面板替换这个硬编码模型。

请让我知道如何实现这一目标。或者如果有更好的架构，请告诉我。我尝试了向导控件，但是在维护之前输入的值和使用 Next 和 Previous 按钮遍历数据方面太麻烦了。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-06T11:35:10.013

您可以使用以下方法将控件动态添加到页面：

```
Page.Controls.Add(new MyControl()); 
```

您必须为在控件中输入的数据找到一个临时存储区，例如 Session。

```
Session["addedControls"] = myControls; 
```

您可以跟踪他们添加的控件数量，然后循环并将所有数据保存到您正在使用的任何永久存储中。

这里有一个例子：http: [//howto.jamescarnley.com/2008/05/adding-fields-dynamically-in-aspnet.html](http://howto.jamescarnley.com/2008/05/adding-fields-dynamically-in-aspnet.html)

将整个控件存储在会话中确实有它的缺点，例如所涉及的开销，您可以只存储更有效的数据，但要付出更多的努力来实现。这也只有在他们启用了 cookie 时才有效。

或者，您可以为他们提供一个下拉列表，以选择他们希望创建的条目数，并通过调用 Page.Controls.Add 所需的次数来显示该控件数。然后最后将它们全部保存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T12:29:50.437

您可以在 javascript 中轻松地动态添加输入新成员所需的控件。你的提议对我来说听起来像是一场噩梦。我会建立一个页面，其中包含添加成员和“添加成员”按钮的控件。单击“添加成员”按钮时 - 我会将成员保存到数据库中，检索在此会话中添加的成员列表 - 并在页面“添加成员”区域右侧的列表中显示成员的名称. 如果他们想审查成员，他们可以单击他们的名字，您可以显示该成员已准备好进行编辑。或者他们可以添加另一个成员，直到他们完成。您正在尝试做的事情将成为管理的噩梦，并且不会让用户更容易使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-21T16:01:30.890

使用动态控件将非常困难并且对用户不友好，因为它可能需要刷新页面或使用更新面板

在您的情况下，我建议使用 Knockout 从 JavaScript 完成所有操作，这是一个完整的示例[Knockout Grid](http://knockoutjs.com/examples/gridEditor.html)

确保在添加或编辑网格后，您将使用 JSON.Stringify 将 JavaScript 对象序列化为字符串，并将此文本添加到隐藏字段。

提交表单时，只需获取隐藏字段值，使用 newtonsoft json 库将字符串转换为对象，并免费使用该对象，该对象将成为您的模型列表（例如：订单）。

与动态控制器相比，这更易于管理和用户友好

# python - 模型的 Python 干净导入 - SQL Alchemy

> ID：11567157
> 
> 赞同：4
> 
> 时间：2012-07-19T18:33:03.680
> 
> 标签：python, flask, flask-sqlalchemy

我有一个具有以下目录结构的烧瓶应用程序：

*   我的应用程序/
    *   应用程序.py
    *   `__init__.py`
    *   楷模/
        *   `__init__.py`
        *   用户.py

这些模型使用 Flask-SQLAlchemy，因此，它们需要`db`从`application.py`

用户.py：

```
import sys,os
sys.path.append('/path/to/application/package')

from testapp import db

class User(db.Model):
    id = db.Column(db.Integer,primary_key=True)
    username = db.Column(db.String(255),unique=True)
    age = db.Column(db.Integer)

    def __init__(self,username,age):
        self.username = username
        self.age = age

    def __repr__(self):
        return '<User %r>' % self.username 
```

因为任何模型都需要访问应用程序的 SQLAlchemy 实例、`db`属性，所以我必须将整个包放在路径上，然后从主应用程序模块导入。为了理智起见，我想将模型保存在单独的文件中。我需要将路径代码放在每个模型的顶部吗？有没有更好的办法？我宁愿没有这样的完整路径输入，因为它们可能被部署到具有不同目录结构的不同主机上。理想情况下，会有某种方法在内部处理路径，因此当它通过我用作另一个用户时，`mod_wsgi`我不必手动更改代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T21:26:04.423

***第一种方法：***

我最终得到了以下结构：

*   **project_root** *— 还包含一些配置、.gitignore 文件等*
    *   开始.py
    *   **烧瓶根**
        *   __init__.py
        *   应用程序.py
        *   **模块_1**
            *   __init__.py
            *   模型.py
        *   **模块_2**
            *   __init__.py
            *   模型.py

最上面的 start.py 只是运行应用程序：

```
#! /usr/bin/env python
from flask_root import applicaiton

if __name__ == '__main__':
    application.manager.run() 
```

Python在你的脚本开始的目录中[搜索包](http://docs.python.org/tutorial/modules.html#the-module-search-path)，所以现在你不需要将它们添加到 sys.path （对我来说，修改 sys.path 看起来很难看）。现在您有了完整的**flask_root** python 包，您可以从应用程序的任何位置从中导入所有内容：

```
from flask_root.application import db 
```

* * *

***第二种方法：***

如果你从它的目录启动你的 Flask 应用程序，

```
./application.py runserver 
```

你开始的目录不能作为 python 包访问，即使它有 __init__.py 。

不过，使用您的目录布局，您可以执行以下技巧：

**模型/__init__.py**：

```
from application import db
... 
```

**模型/user.py**：

```
from . import db
... 
```

第一种方法更干净和通用。当您需要在多个 Flask 项目之间共享相同的蓝图时，第二个可能很有用。

# firefox - 更新 Firefox 14.0.1 后 Firebug 不工作（检查元素不显示 HTML）

> ID：11567160
> 
> 赞同：3
> 
> 时间：2012-07-19T18:33:14.450
> 
> 标签：firefox, browser, firefox-addon, firebug

Firebug 在 Mozilla Firefox V 14.0.1 自动更新后停止工作。

我已经更新了我的 Firebug，但它仍然无法正常工作。“检查元素”不显示 HTML。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T19:59:20.913

找到了解决方案

Firebug 在自动更新 Mozilla firefox V 14.0.1 后停止工作我已经更新了我的 Firebug，但它仍然无法正常工作因为您可以按照步骤为您添加星标，firebug 检查元素不起作用

只需按照以下步骤

打开以下链接

[http://ftp.mozilla.org/pub/mozilla.org/firefox/releases/latest/](http://releases.mozilla.org/pub/mozilla.org/addons/1843/)

或赢得 32

[http://ftp.mozilla.org/pub/mozilla.org/firefox/releases/latest/win32/xpi/](http://ftp.mozilla.org/pub/mozilla.org/firefox/releases/latest/win32/xpi/)

下载 firebug-1.10.0b4-fx.xpi 12-Jul-2012 05:25 1.5M

或最新版本

保存在硬盘上 用火狐打开下载文件 点击安装，FireBug 再次出现，让您再次玩网络......:)

它对我有用

有关更多信息，请查看以下链接。

[http://oolu.com/Seva/FireIssue.aspx/](http://ooolu.com/Seva/FireIssue.aspx/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-28T17:39:03.287

[在他们的页面](https://addons.mozilla.org/en-US/firefox/addon/firebug/)上检查 Firebug 的兼容性表，并确保您的版本与您的 Firefox 版本兼容。

# uiview - UIImageView 仅裁剪一些子视图

> ID：11567161
> 
> 赞同：2
> 
> 时间：2012-07-19T18:33:17.980
> 
> 标签：uiview, uiimageview, uibutton, subview

我有一个内容模式为 Aspect Fill 的 UIImageView，它正在剪切它的子视图。现在我想添加一个按钮作为子视图，它应该在边缘突出大约 20px。

问题是界面构建器中的“剪辑子视图”选项会剪切子视图（如预期的那样）。

有没有可能得到我想要的？有任何想法吗？谢谢，致以诚挚的问候，朱利安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-25T22:35:52.513

以防万一其他人像我一样偶然发现这一点。我发现我的解决方案是将`clipsToBounds`图像视图设置为 FALSE：

```
[_myImageView addSubview:_myButton];
_myImageView.clipsToBounds = NO; 
```

现在我的按钮与图像视图的边缘重叠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-22T23:44:08.773

将 UIButton 添加到 UIImageView 的超级视图中，它不会被剪裁。

# facebook - Facebook FQL 查询或

> ID：11567162
> 
> 赞同：0
> 
> 时间：2012-07-19T18:33:24.110
> 
> 标签：facebook, facebook-fql, fql.multiquery

我正在尝试在 FQL 查询中创建 OR 子句。

这是我的查询：

```
SELECT post_id, message, permalink, likes, actor_id, created_time FROM stream  WHERE 
(source_id = xxx1 AND message != '' AND actor_id = xxx2) 
OR 
(source_id = xxx2 AND actor_id = xxx1) 
```

在全球范围内，我想检索 2 个 Facebook 用户之间的所有消息。如果我删除 OR 子句，我确实以一种方式接收消息，但添加 OR 会删除我拥有的每条消息，就好像 '(' 不起作用。

如果您需要测试此查询，请继续：http: [//developers.facebook.com/tools/explorer](http://developers.facebook.com/tools/explorer) 并使用 read_stream 权限创建和访问令牌（扩展权限）

我也想使用 UNION，但 FQL 不支持它。也许我可以使用 FQL 多个查询，但我仍然被 UNION 丢失阻止。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:34:00.580

您可以使用子查询来实现所需的结果，如下所示：

```
SELECT post_id, message FROM stream 
WHERE 
    (
      post_id in (select post_id from stream where actor_id = uid0 and source_id  = uid1) 
    or  
      post_id in (select post_id from stream where actor_id = uid1 and source_id  = uid0)
    ) 
    and message != '' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T19:11:01.813

complex857 提供的答案是正确的，但我想补充一些信息。要使此查询起作用，您必须在查询中添加一个 LIMIT / OFFSET 子句。

```
SELECT post_id FROM stream
    WHERE 
        (post_id IN (SELECT post_id FROM stream WHERE source_id = uid0 AND actor_id = uid1 LIMIT 1000 OFFSET 0)
            OR 
        post_id IN (SELECT post_id FROM stream WHERE source_id = uid1 AND actor_id = uid0 LIMIT 1000 OFFSET 0))
    AND message != ''; 
```

希望这会有所帮助:)

# python - 每次迭代只产生一次

> ID：11567164
> 
> 赞同：5
> 
> 时间：2012-07-19T18:33:29.583
> 
> 标签：python, generator

我正在尝试使用生成器进行类型转换，但是一旦成功产生值，我想移动到迭代器中的下一个元素。在表达式成功的情况下，我当前的尝试将产生多个值：

```
def type_convert(data):
    for item in data:
        try:
            yield int(item)
        except (ValueError, TypeError) as WrongTypeError:
            pass
        try:
            yield float(item)
        except (ValueError, TypeError) as WrongTypeError:
            pass
        yield item 
```

这是如何实现的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T18:41:03.440

您应该能够`continue`像其他任何循环一样执行此循环：

```
try:
    yield int(item)
    continue
except (ValueError, TypeError) as WrongTypeError:
    pass 
```

作为旁注，我一直认为`continue`这个控制结构是一个奇怪的名字......

而且，这是您更正的代码：

```
def type_convert(data):
    for item in data:
        try:
            yield int(item)
            continue
        except (ValueError, TypeError) as WrongTypeError:
            pass
        try:
            yield float(item)
            continue
        except (ValueError, TypeError) as WrongTypeError:
            pass
        yield item

for a in type_convert(['a','1','1.0']):
    print (a) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T18:42:37.280

我不知道它是否在每个 try 块调用 next()，但如果这是你关心的问题，你为什么不这样做

```
try:
  item =  int(item)
except (ValueError, TypeError) as WrongTypeerror
   try:
       item = float(item)
   except (ValueError, TypeError) as WrongTypeError
       pass
yield item 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T20:28:22.867

这是一个笼统的答案：

```
def type_convert(*args):
    datatypes = []
    for arg in args:
        if type(arg) == type(type):
            datatypes += [arg]
        else:
            data = arg
    for item in data:
        for datatype in datatypes:
            try:
                yield datatype(item)
                break
            except (ValueError, TypeError) as WrongTypeError:
                pass
        else:
            yield item  # unable to convert to any datatype

for a in type_convert(int, float, ['a','1','1.0']):
    print (a) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T18:47:29.730

这有效：

```
def type_convert(data):
    for item in data:
        try:
            yield int(item)
            continue
        except (ValueError, TypeError) as WrongTypeError:
            pass
        try:
            yield float(item)
            continue
        except (ValueError, TypeError) as WrongTypeError:
            pass
        yield item 
```

这是结果：

```
>>> list(type_convert(["13", 3.5, True]))
[13, 3, 1] 
```

# powershell - PowerShell - 获取 AD 中所有非禁用用户的密码过期

> ID：11567165
> 
> 赞同：5
> 
> 时间：2012-07-19T18:33:32.160
> 
> 标签：powershell, passwords

我的目标是在 powershell 中创建一个对象，显示所有非禁用用户的 AD 显示名称和密码到期日期。这相对容易。但是，日期以不可读的格式检索，因此我转换了日期。

创建包含我想要的数据的两个变量正在工作。问题是当我尝试组合这两个变量时，我得到一个带有两个标题的单个对象，但下面的两列是空的。

我在 Win 7 Pro SP1 上使用 PowerShell V2

任何想法可能是什么问题？

```
# Get users DisplayName and password expiration time from AD
$msdsComputed = Get-ADUser -filter {Enabled -eq $True -and PasswordNeverExpires -eq  $False} -Properties "DisplayName", "msDS-UserPasswordExpiryTimeComputed" |  
        Where-Object {$_.DisplayName -ne $null} 

# Convert date to human readable format
$ExpiryDate = $msdsComputed | Foreach-Object {
             ([datetime]::FromFileTime(($_)."msDS-UserPasswordExpiryTimeComputed")) 
                          } | Select-Object "DateTime"

$combined = @{            
              DisplayName   = $msdsComputed.DisplayName
              ExpiryDate    = $ExpiryDate.DateTime
             }
New-Object PSObject -Property $combined | ConvertTo-Csv -NoTypeInformation 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T18:56:20.913

这是您的脚本的修订版本，没有循环问题：

```
$reportObject = @()
$userList = Get-ADUser -filter {Enabled -eq $True -and PasswordNeverExpires -eq  $False} -Properties "DisplayName", "msDS-UserPasswordExpiryTimeComputed" |  Where-Object {$_.DisplayName -ne $null}
$userList | %{

    $output = "" | Select DisplayName, ExpiryDate
    $output.DisplayName = $_.DisplayName
    $output.ExpiryDate = ([datetime]::FromFileTime($_."msDS-UserPasswordExpiryTimeComputed")).DateTime
    $reportObject += $output
    #Next 2 Lines provide debugging... I'm not sure the date time portion will work without having AD to play with
    $output | fl *
    ([datetime]::FromFileTime($_."msDS-UserPasswordExpiryTimeComputed")).DateTime 
}

$reportObject | Convertto-CSV -NoTypeInformation 
```

# c# - 实体框架代码优先保存类型为字符串

> ID：11567167
> 
> 赞同：3
> 
> 时间：2012-07-19T18:33:38.200
> 
> 标签：c#, entity-framework-4.1

我首先使用实体​​框架代码，并且有一些具有这样的 System.Net.Mail.MailAddress 类型的类。

```
public class Person 
{
 public MailAddress Email { get; set; }
} 
```

当 EF 尝试创建数据库时，我收到此错误

```
"Problem in mapping fragments starting at line 6 No mapping for properties Person.Email" 
```

如何告诉 EF 将 Email.ToString() 的结果保存到数据库，然后我可以创建一个新的 MailAddress(stringOfEmail); 在对象上设置值时？

还是我最好将电子邮件的数据类型更改为字符串并在其他地方处理验证？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T18:40:04.807

一种可能的方法是让`MailAddress`属性不映射到数据库，但有第二个属性。就像是：

```
public class Person
{
    public string EmailString { get; set; }

    [NotMapped]
    public MailAddress Email
    {
        get { return new MailAddress(this.EmailString); }
        set { this.EmailString = value.ToString(); }
    }
} 
```

有关`[NotMapped]`属性的信息，请参见此处：[如何不首先保留属性 EF4 代码？](https://stackoverflow.com/questions/3595404/how-not-persist-property-ef4-code-first)

# xml - 如何从通过 rs232 连接的 CO2 记录仪读取和显示数据？

> ID：11567171
> 
> 赞同：1
> 
> 时间：2012-07-19T18:33:45.290
> 
> 标签：xml, serial-port, arduino

我有一台 Licor CO2-Logger (Li-820) 用于科学实验。Li-820 输出模拟信号（电压）并通过 RS232 端口提供串行通信。我想嗅探与 arduino uno 的串行通信，并在 LCD 显示器上显示 CO2 值，以便我可以控制记录在计算机系统中的模拟信号。我想同时显示模拟和数字信号。

我使用 rs232 电平转换器将 Licor CO2 分析仪连接到 arduino uno，我可以使用 arduino 串行监视器和嗅探器程序成功嗅探 COM 端口。通过 rs232 端口，Li-820 设备输出一个类似 xml 的行，如下所示：

```
<li820><data><celltemp>5.1252350e1</celltemp><cellpres>9.7159633e1</cellpres><co2>5.2527637e2</co2><co2abs>7.7893261e-2</co2abs><ivolt>1.1386718e1</ivolt><raw>3950702,3808028</raw></data></li820> 
```

我想用 arduino uno 解析相关部分的信息，即“5.2527637e2”（“CO2”值），然后首先将其输出到串行监视器。接下来，我将在 LCD 显示器上显示该值。这最后一步应该是一个小问题。

那么，如何解析相关位的信息，然后将其显示到串行监视器上。

我在网上查了很多例子。来自此处（[http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl?num=1287446626](http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl?num=1287446626)）和此处（[使用 Arduino Duemilanove 和 Cutedigi RS-的 RS-232 通信）的工作代码的修改版本232 接口](http://stackoverflow.com/questions/8370918/rs-232-communication-using-an-arduino-duemilanove-and-the-cutedigi-rs-232-interf)）是我得到的最接近的。

我知道一些用于 arduino 平台的 xml 库。但是，我首先无法访问 xml 行。

## 评论

我已经在 [electronics.stackexchange.com] 上发布了这个问题，但是那里的一些好人建议我也在这里发布这个问题。由于声誉低下，我无法迁移问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:49:58.180

不确定这`#include <regex>`是否适用于 Arduino IDE，但这里有一个片段会有所帮助。

此外，作为免责声明，我建议使用 XML 解析器，但我知道 IDE 是否也可以使用它，而且对于 arduino 来说，这似乎有很多 cpu 开销。

[这是](http://softwareramblings.com/2008/07/regular-expressions-in-c.html)对以下代码的一个很好的理解。

```
#include <regex>

using namespace std::tr1;

string seq = "<li820><data><celltemp>5.1252350e1</celltemp><cellpres>9.7159633e1</cellpres><co2>5.2527637e2</co2><co2abs>7.7893261e-2</co2abs><ivolt>1.1386718e1</ivolt><raw>3950702,3808028</raw></data></li820>";
regex rgx("(<co2>).*(<co2>)");
smatch result;
regex_search(seq, result, rgx);
for(size_t i=0; i<result.size(); ++i)
{
    //tinker with this to find the correct result index.
    cout << result[i] << endl;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:32:46.763

虽然您可以使用重（慢）正则表达式或 xml 解析器，但我会使用一个简单的解决方案。如果数据行一致，那么我们只需要第7个“>”和第8个“<”之间的数据。

```
int i = 0;
int start = -1;
int end = 0;

string data = "<li820><data><celltemp>5.1252350e1</celltemp><cellpres>9.7159633e1</cellpres><co2>5.2527637e2</co2><co2abs>7.7893261e-2</co2abs><ivolt>..."

string result = "";

for(i=0;i<7;i++)
{
     start = data.indexOf('>', start + 1 )
}
end = data.indexOf('<', start++);

result = data.substring(start, end - start);

Serial.print("co value = );
Serial.println(result); 
```

# c++ - 查找 NaN 错误的原因

> ID：11567173
> 
> 赞同：2
> 
> 时间：2012-07-19T18:34:14.827
> 
> 标签：c++, nan

我在这部分代码中遇到了 NaN 错误：

```
void Robot::updatePos(int msTime){
    if(vel_left==vel_right){
        pos_x-=vel_right*msTime*0.001*sin(orientation);
        pos_y-=vel_right*msTime*0.001*cos(orientation);
    }
    else{
        int sign=1;
        if(vel_left<vel_right) sign=-1;
        float centre_x, centre_y;

        float right_rad=width/(vel_left/vel_right-1);

        centre_x=pos_x-cos(orientation)*(right_rad+width/2);
        centre_y=pos_y-sin(orientation)*(right_rad+width/2);
        cout << "centre" << centre_x << "right_rad" << right_rad << endl;
        orientation+=sign*vel_right*msTime/right_rad;

        pos_x=centre_x+cos(orientation)*(right_rad+width/2);
        pos_y=centre_y+sin(orientation)*(right_rad+width/2);
    }
    while(orientation>M_PI) orientation-=2*M_PI;
    while(orientation<-M_PI) orientation+=2*M_PI;
    cout << "pos_x: " << pos_x << " pos_y: " << pos_y <<
                " orientation: " << orientation << endl;
} 
```

所有的类变量都是浮点数。您知道可能导致此错误的原因吗？

编辑：对不起，应该指定。该函数在一个循环中运行）我得到以下变量的 NaN center_x（在第一次通过循环中确定然后是 nan），pos_x，center_y（在第一次通过循环中确定然后是 nan），pos_y，方向。right_rad=0。显然问题出在“其他”部分。

好的，缩小到这一行：float right_rad=width/(vel_left/vel_right-1); 由于某种原因，结果为 0。

问题解决了。非常感谢你们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T18:48:58.543

如果`right_rad`= 0，那么您将在此处除以零：

```
orientation+=sign*vel_right*msTime/right_rad; 
```

除此之外，我看不出你会得到 NaN 的任何理由。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:49:00.990

不幸的是，我没有足够的代表来发表评论，但是`orientation`当您输入该功能时，它的价值是什么？这似乎是所有变量的共同因素`NaN`。如果您正在执行`sin`或`cos`处理尚未初始化的变量，或者是无穷大或 NaN，您将返回 NaN。

# ubuntu - 你如何设置 .vimrc

> ID：11567176
> 
> 赞同：29
> 
> 时间：2012-07-19T18:34:25.393
> 
> 标签：ubuntu, vim

如何在 Ubuntu 上设置 .vimrc 文件？

这没有帮助：http: [//vim.wikia.com/wiki/Open_vimrc_file](http://vim.wikia.com/wiki/Open_vimrc_file)

1.  你在哪里创建它？
2.  里面的格式是什么？

我知道我想放进去的东西，只是不知道怎么做。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-07-19T18:39:18.630

**在哪里：**

在 UN*X 系统上，您的 .vimrc 属于您的*主目录*。在终端输入：

```
cd $HOME
vim .vimrc 
```

这将更改为您的主目录并使用 vim 打开 .vimrc。在 vim 中，添加您知道要放入的命令，然后键入`:wq`以保存文件。

现在再次打开 vim。进入 vim 后，您只需键入：`:scriptnames`即可打印已获取的脚本列表。.vimrc 的完整路径应该在该列表中。作为您的命令是否已执行的附加检查，您可以：

*   向 .vimrc添加一个`echo "MY VIMRC LOADED"`命令，当你再次运行 vim 时，你应该会看到*MY VIMRC LOADED*打印在终端中。`echo`一旦您确认 your.vimrc 正在加载，请删除该命令。
*   在 .vimrc 中设置一个变量，`echo`一旦加载 vim 就可以了。在 .vimrc 添加一行，如`let myvar="MY VIMRC LOADED"`. `echo myvar`然后在命令行中打开 vim 类型。你应该看到你的消息。

**格式：**

您的 .vimrc 的格式是它包含 Ex 命令：您可以在 vim 命令行中键入的任何内容`:`，但在您的 .vimrc 中，请不要使用`:`.

您已经提到`:set ruler`：只有这个命令的 .vimrc 看起来像：

```
set ruler 
```

搜索*例如 vimrc*并查看结果。[这个链接](http://vim.wikia.com/wiki/Example_vimrc)是一个很好的起点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-19T19:58:18.230

.vimrc 应该在你的主目录中。.vimrc 可以根据您的需要进行更多交互。这是 .vimrc 的示例

```
filetype indent on
set ai
set mouse=a
set incsearch
set confirm
set number
set ignorecase
set smartcase
set wildmenu
set wildmode=list:longest,full 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-21T21:41:03.010

“.vimrc”（vim 资源配置）文件提供了每次启动时配置 Vim 的初始化设置。该文件可以在`"$HOME/.vimrc"`linux/OSX 和`"$HOME/_vimrc"`Window 用户中找到。在 Vim 中，输入 ":echo $HOME" 以查看 $HOME 对您的系统的值

例如，我们可以在您的`.vimrc`文件中进行以下设置。

```
 set hlsearch: Enable search highlighting
    set ignorecase: Ignore case when searching
    set incsearch: Incremental search that shows partial matches. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-02T14:07:41.447

`~/.vimrc`使用打开vim `vim ~/.vimrc`，把它放进去：

```
set paste
set nonumber
set hlsearch 
```

保存文件并使用`:wq`. `.vimrc`重新打开 Vim 编辑器时将使用其中的更改。

# ruby-on-rails - 如何将变量从实例方法传递到控制器？

> ID：11567177
> 
> 赞同：0
> 
> 时间：2012-07-19T18:34:27.617
> 
> 标签：ruby-on-rails, actionview, actioncontroller

我需要为每个具有电子邮件参数的用户（管理部分）调用方法。这是在 PayPal 中付款的功能，但在某些情况下我不能使用重定向。

我认为payments.erb的代码：

```
 % @users.each do |user| %>
<li>
  <%= user.email %>
  <%= link_to "Pay", user.pay(user.email) %>
</li> 
```

支付方式代码

```
def pay email
//making post request to PayPal
//res = clnt.post(uri, data, header)
//if res.status ==200
//redirect_to PayPal
//else redirect_to :back
end 
```

我如何传递参数或如何重新组织这一切？我需要在页面控制器中创建一个操作，还是可以使用一些 after_call_pay 功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T03:38:50.913

我认为您应该以表格而不是链接来处理此问题。

如果支付是一种与用户对象相关联的方法，那么您可能需要执行以下操作：

看法 -

```
<%= form_for @user, :url => { :action => "make_payment" } do |f| %>
    #any form fields associated with making the payment (ie credit card number)
    <%= f.submit %>
<% end %> 
```

这会将表单路由到 Users_controller 和名为“make_payment”的操作。确保在 config/routes 文件中提供此操作的路由，因为如果您使用标准资源路由，则无法访问。

控制器 -

```
def make_payment
   @user = User.find(params[:id])
   user.submit_payment(params[:credit_card_num])
   redirect_to @user
end 
```

那应该完成您想要做的事情。在此处查看有关 Rails 表单助手的更多说明[http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-form_for)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:53:57.803

响应实例方法不是控制器的工作。响应*请求*是控制器的工作。

因此，您希望能够链接到响应 mydomain.com/users/1/pay 或类似内容的操作。

在路线中

```
resources :users do
  member do
    post 'pay'
  end
end 
```

然后在你的控制器中

```
def pay
  @user = User.find(params[:id])
  #route user to paypal or somewhere else based on some condition
end 
```

最后在视图中

```
<%= link_to "Pay", pay_user_path(user) %> 
```

# verilog - 我的 I2C 链接有什么问题？它在不应该的时候切换 LED

> ID：11567179
> 
> 赞同：1
> 
> 时间：2012-07-19T18:34:43.190
> 
> 标签：verilog, i2c, led

我有两个通过 I2C 连接到我的 Arduino 的 Lattice 芯片。每个 Lattice 板包含 8 个 LED。我的 Arduino 是大师。

[照片](http://i.stack.imgur.com/MDcOx.jpg)

我的目标是驱动每个板上的 LED。

到目前为止一切顺利，但存在一些错误。我通过告诉格子板开始这个过程，我正在寻址，我即将发送我希望它驱动的引脚。我现在通过发送一个设置为 10 的字节来做到这一点。在此之后，我发送我希望它以这样的字节驱动的引脚，10110111，其中索引 0 是第一个 LED，索引 1 是第二个 LED，依此类推，依此类推到 8。

用于此的 Verilog 代码：

```
if(adr_match & bit_DATA & data_phase & op_write & getDrive == 1'b1) begin
    drivePins[bitcnt] <= SDAr;
    if (bitcnt == 0) begin
        getDrive = 1'b0;
    end
end

if (adr_match & bit_DATA & data_phase & op_write & (IOout == 10) & bitcnt == 0) getDrive = 1'b1; 
```

最后我发送一个字节，一个 11，它告诉 Lattice 板它的设置并驱动连接到 8 个 LED 的引脚。

```
if (adr_match & bit_DATA & data_phase & op_write & IOout == 11 & bitcnt == 0) begin
    led0 = drivePins[0];
    led1 = drivePins[1];
    led2 = drivePins[2];
    led3 = drivePins[3];
    led4 = drivePins[4];
    led5 = drivePins[5];
    led6 = drivePins[6];
    led7 = drivePins[7];
end 
```

其余代码基于[此处](http://www.fpga4fun.com/I2Cslave1.html)的 I2C 从机实现。

我的问题是，如果我从 Arduino 发送 drivePins 字节，第一个索引中有 1 （例如 0000110 **0**），那么它会吓坏并打开它不应该打开的 LED。LED 模式最终看起来像这样：11110110，来自这个 11111110。那么有人知道发生了什么吗？

在 Arduino 上，我正在使用 Wire 库。

```
Wire.beginTransmission(2);
Wire.write(10);
Wire.endTransmission();

Wire.beginTransmission(2);
Wire.write(~(10101011));
Wire.endTransmission();

Wire.beginTransmission(2);
Wire.write(11);
Wire.endTransmission(); 
```

传输看起来像这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T22:48:44.977

问题是在 bitcnt 0 上运行代码。它没有更新字节中的第 0 个索引。我在我的数据字节之后发送了一个 9h 位，一个 Ak 位，并在接收该字节时运行代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T21:04:01.273

我的回答可能完全不正确，因为问题中缺少很多信息，但是在最低有效位引起的问题让我认为您可能对 I2C 地址有些混淆。你能检查一下主人是否发送了这样的命令：

开始 - Lattice1AddressWrite(lsb==0) - 0x0A - LedPatterSingleByte - 0x0B - 停止

有多个开始或停止将改变字节的含义。

如果这不能解决您的问题，请您提供一些信息/伪代码，大师。我需要一些信息来说明这一点。

# algorithm - 如何跟踪fifo查询的最大值/最小值

> ID：11567180
> 
> 赞同：4
> 
> 时间：2012-07-19T18:34:51.147
> 
> 标签：algorithm

我有 fifo 查询我放置和弹出双打的位置。每次更新后，我需要最大值和最小值。我不需要查询中这些值的位置（或索引）。如何有效地做到这一点？log(N) 甚至可能是 O(1)？

upd：找到这个[实现一个队列，其中push_rear()、pop_front()和get_min()都是常数时间操作](https://stackoverflow.com/questions/4802038/implement-a-queue-in-which-push-rear-pop-front-and-get-min-are-all-consta)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T18:53:53.697

这是一个棘手的问题。考虑以下：

假设在任何给定时间您的 fifo 的大小是 N。假设您只用一对浮点数跟踪最小值和最大值。假设 fifo 的大小保持合理不变。

因此，我们可以假设队列上的一项“操作”在逻辑上由一次推送和一次弹出组成。

假设您正在比较两种处理方法：一种使用堆对，另一种使用简单的比较和搜索。

对于堆方法：

每个操作，你推送到列表和两个堆，然后从列表和两个堆中弹出。堆操作总是O(log(n))，列表操作是O(1)，所以N很大，一个操作的时间复杂度是O(log(N))的平均情况。重要的是要注意，无论当前弹出的元素是最小元素还是最大元素，堆操作总是如此复杂。因此，N 个操作的时间复杂度为 O(N*log(N))。

对于天真的方法：

每个操作，你推送和弹出列表，并将弹出的项目与存储的最小值和最大值进行比较。如果该项目与其中任何一个相同，则在列表中搜索具有相同价值的项目（在这种情况下，您会提前中断）或以其他方式搜索整个列表的其余部分，直到找到下一个最佳元素。然后，您使用下一个最佳值更新最小值/最大值。此方法具有 O(1) 典型情况和 O(N) 最坏情况（最小值或最大值需要更新）。重要的是要注意，对于某个范围的 N 数字，您需要更新 min 和 max 的次数变为一个常数，而您不需要更新的次数为 N。因此，N 个操作的时间复杂度为在）。天真的案例实际上比更高级的解决方案要好。

也就是说，我认为堆不能有效地删除元素，所以那样你会遇到很多麻烦。

因此，考虑以下伪代码：

```
queue fifo;
float min, max;

void push(float f)
{
    if (fifo.size == 0)
    {
        min = f;
        max = f;
    }
    else if (f > max) max = f;
    else if (f < min) min = f;

    fifo.push(f);
}

float pop()
{
    if (fifo.size == 0) return (*((float *)NULL)); // explode
    float f = fifo.pop();
    if (fifo.size == 0)
    {
        min = NaN;
        max = NaN;
        return f;
    }
    if (f == max) search_max(fifo);
    if (f == min) search_min(fifo);
    return f;
}

search_max(queue q)
{
    float f = min;
    for (element in q)
    {
        if (element == max) return;
        if (element > f) f = element;
    }
    max = f;
}

search_min(queue q)
{
    float f = max;
    for (element in q)
    {
        if (element == min) return;
        if (element < f) f = element;
    }
    min = f;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:38:58.467

如何使用堆（[http://en.wikipedia.org/wiki/Heap_%28data_structure%29](http://en.wikipedia.org/wiki/Heap_%28data_structure%29)）。你可以有两个堆。一个用于提取最小值，一个用于最大值（因为单个堆不能同时提取最小值和最大值）。它也不需要任何空间开销，Big O 是 log n。

# iphone - GameKit 适用于游戏以外的应用程序

> ID：11567183
> 
> 赞同：2
> 
> 时间：2012-07-19T18:35:08.767
> 
> 标签：iphone, objective-c, ios, bluetooth, gamekit

这似乎是一个愚蠢的问题，但 GameKit 可以用于游戏以外的应用程序吗？也就是说，Apple 会批准将 GameKit 用于蓝牙用途但不将其用于游戏的应用程序吗？还是他们会基于“滥用硬件/软件”或任何规则而拒绝它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T18:50:16.480

来自 Apple 的“Game Kit Programming Guide”：

> 点对点连接允许您的游戏在多个基于 iOS 的设备之间创建自组织蓝牙或本地无线网络。尽管设计时考虑到了游戏，**但该网络对于应用程序用户之间的任何类型的数据交换都很有用**。例如，应用程序可以使用对等连接来共享电子名片或其他数据。

这清楚地回答了你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:48:19.403

是的，GameKit 可以用于游戏以外的东西，事实上，在某些情况下它比使用其他通信框架更好，因为在两个设备之间创建本地网络连接是荒谬的，你可以发送任何你想要的数据通过您创建的连接。

# google-chrome - 在谷歌浏览器扩展中，我可以在基本或摘要身份验证后连接到 api

> ID：11567186
> 
> 赞同：0
> 
> 时间：2012-07-19T18:35:20.520
> 
> 标签：google-chrome, google-chrome-extension

我想连接到使用 Basic 或 Digest Auth 的 API，这样用户才能完全使用扩展，只有在他登录 API 后，扩展才会通过 API 发送和接收消息，并根据发送的响应执行操作通过 API。

谷歌浏览器扩展是否可以进行这种身份验证？我可以要求用户通过作为扩展的一部分的弹出 HTML 文件提供用户 ID/密码（或 API 密钥）吗？或者我是否必须在 Chrome 本身中打开一个新选项卡并要求用户通过该选项卡进行身份验证...

这是从 Google Chrome 扩展程序验证到基于 Web 的 API 的最佳/理想方式...任何指南或操作指南对我来说非常有帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:29:39.720

您可以使用弹出窗口或新选项卡身份验证，任何一种方式都可以。

# php - mod_rewrite 掩码文件夹名称

> ID：11567187
> 
> 赞同：1
> 
> 时间：2012-07-19T18:35:28.653
> 
> 标签：php, sql, mod-rewrite, directory, mask

希望执行以下操作：

`domain.com`- 直接使用不同于各个城市的独特文件进行根目录。

`domain.com/city_name`- 此文件夹将包含 CMS 元素和基于用户最终所在城市的个人内容。

最终，控制 CMS 的所有文件都将在其中，`/city_name`但我分页了一个名为 pageLoader.php?page=$1 的文件，因此我可以执行`$_GET[''];`并请求他们输入的城市名称，例如：`domain.com/vancouver`

所以，我需要做的是“屏蔽” city_name 文件夹

```
/vancouver, /los-angeles etc... 
```

这可能吗？我将如何去做这件事。

在项目的最后期限并且难以弄清楚这一点时，任何回应都非常有用。

谢谢。

编辑：当有人输入 /vancouver 时，基本上需要读取 /city_name 文件夹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:58:11.507

首先，您使用的是 Apache 还是 IIS？无论如何，我想您可以执行以下操作...

在 .htaccess (Apache) 中：

```
RewriteEngine On

RewriteCond %(REQUEST_FILENAME) -d

RewriteRule ^(.*)$ index.php?page=$1 
```

在 web.config (IIS)

```
<rule name="rewrite" stopProcessing="true" >
    <match url="^(.*)$" ignoreCase="true" />
    <conditions logicalGrouping="MatchAll" trackAllCaptures="false">
        <add input="%(REQUEST_FILENAME)" matchType="IsDirectory" negate="true" />
    </conditions>
    <action type="Rewrite" url="index.php?page={R:1}" appendQueryString="false" />
</rule> 
```

# php - Symfony2：设置 cookie

> ID：11567194
> 
> 赞同：10
> 
> 时间：2012-07-19T18:35:54.810
> 
> 标签：php, cookies, symfony

我正在尝试在登录控制器中设置一个 cookie 以实现“记住我”系统。即使我使用了我在网上找到的确切代码，但对我来说事情还是出错了。我希望你能帮我弄清楚我错过了什么。

让我们看一下代码：

```
public function loginAction(Request $request) {
// Receiving the login form
// Get Doctrine, Get EntityManager, Get Repository
if(/* form information matche database information */) {
     // Creating a session => it's OK
     // Creating the cookie
     $response = new Response();
     $response->headers->setCookie(new Cookie("user", $user));
     $response->send();
     $url = $this->generateUrl('home');
     return $this->redirect($url);

} else 
     return $this->render('***Bundle:Default:Login.html.php');
} 
```

我包括了这些：

```
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\HttpFoundation\Cookie; 
```

请注意，登录工作正常，会话已创建，但 cookie 尚未创建。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-06-28T07:42:19.910

代替：

```
$response->send(); 
```

尝试使用：

```
$response->sendHeaders(); 
```

在此之后，您应该能够重定向。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-07-20T05:11:15.657

默认情况下[Symfony\Component\HttpFoundation\Cookie](http://api.symfony.com/2.7/Symfony/Component/HttpFoundation/Cookie.html)被创建为[HttpOnly](https://www.owasp.org/index.php/HttpOnly)，这会触发支持浏览器的安全措施；这有助于减轻 javascript 中可能出现的某些 XSS 攻击。

`$httpOnly`要在这样的浏览器设置参数中公开 cookie `false`：

```
new Cookie('user', $user, 0, '/', null, false, false); //last argument 
```

值得注意的是，在此编辑时，框架配置为默认*不*使用 HttpOnly cookie：请参阅[说明书 (cookie_httponly)](http://symfony.com/doc/current/reference/configuration/framework.html#cookie-httponly)。

# xml - xslt - 将节点分类到不同的 div

> ID：11567198
> 
> 赞同：0
> 
> 时间：2012-07-19T18:36:03.357
> 
> 标签：xml, xslt, xslt-1.0

我不得不说 xslt 不是我最好的技能之一 :( 我已经阅读了很多关于将节点分类到不同组中的内容，并且我设法将不同的问题分类到不同的组中。但我现在的问题是，我必须对相同的对象再次分组。

我的 xml 结构看起来像这样

```
<issues>
  <issue status="open" type="Bug">
    <fix_versions>6.14.0</fix_versions>
    <title>issue1</title>
    <description>Description</description>
  </issue>
  <issue status="open" type="Feature">
    <fix_versions>6.13.0</fix_versions>
    <title>issue2</title>
    <description>Description</description>
  </issue>
  <issue status="open" type="Improvement">
    <fix_versions>6.14.0</fix_versions>
    <title>issue3</title>
    <description>Description</description>
  </issue> 
```

我想要的是有一个这样的html结构：

```
<div class="version">
  <a>6.14.0</a>
  <div class="issues">
    <div class="Bugs">
      <a href="">issue1</a>
    </div>
    <div class="Improvements">
      <a href="">issue3</a>
    </div>
  </div>
</div>

<div class="version">
  <a>6.13.0</a>
  <div class="issues">
    <div class="features">
      <a href="">issue2</a>
    </div>
  </div>
</div> 
```

但我得到的是：

```
<div class="version">
  <a>6.14.0</a>
  <div class="issues">
    <a href="">issue1</a>
    <a href="">issue3</a>
  </div>
</div>

<div class="version">
  <a>6.13.0</a>
  <div class="issues">
    <a href="">issue2</a>
  </div>
</div> 
```

到目前为止，这是我的 xslt：

```
 <xsl:for-each select="//issue[generate-id(.)=generate-id(key('versions', fix_versions)[1])]">
    <xsl:sort select="fix_versions" order="descending"/> 
    <div class="release">
        <a href="" class="version"><xsl:value-of select="fix_versions"/></a>
        <div class="version" style="display:none;">
        <xsl:for-each select="key('versions', fix_versions)">

            <xsl:if test="@type='Bug'">

              <xsl:value-of select="title"/>

    </xsl:if>

        </xsl:for-each>

        </div>
   </div>
  </xsl:for-each> 
```

我只需要一个可能性来对“”中的问题进行排序并将它们放入不同的 div 中。这对我来说就足够了。

你有什么建议吗？尝试了很多，但没有任何效果:(非常感谢

编辑2：

我对 xsl 属性和 php + xsl 的美元符号有一些问题：/ 这就是结构的样子

```
<?php
function releaseNotes() {
 $xsl = <<<EOB

 <xsl:attribute name="version"><xsl:value-of select="fix_versions"/></xsl:attribute>
 <xsl:value-of select="$version"/>

 EOB;
 $xmldoc = new DOMDocument('1.0', 'utf-8');
 $xmldoc->load($source);
 $xsldoc = DOMDocument::loadXML($xsl);

 $proc = new XSLTProcessor();
 $proc->importStyleSheet($xsldoc);
 return $proc->transformToXML($xmldoc);
}
?> 
```

任何想法，这可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:13:27.717

您快到了。如何保持简单：

```
<xsl:template match="issues">
  <xsl:for-each select="
    //issue[generate-id(.) = generate-id(key('versions', fix_versions)[1])]
  ">
    <xsl:sort select="fix_versions" order="descending"/> 

    <xsl:variable name="issueGroup" select="key('versions', fix_versions)" />

    <div class="release">
      <a href="" class="version">
        <xsl:value-of select="fix_versions"/>
      </a>
      <div class="issues">
        <div class="Bugs">
          <xsl:apply-templates select="$issueGroup[@type = 'Bug']" />
        </div>
        <div class="Improvements">
          <xsl:apply-templates select="$issueGroup[@type = 'Improvement']" />
        </div>
        <div class="Features">
          <xsl:apply-templates select="$issueGroup[@type = 'Feature']" />
        </div>
      </div>
    </div>
  </xsl:for-each>
</xsl:template>

<xsl:template match="issue">
  <div class="issue_{@type}">
    <a href=""><xsl:value-of select="title" /></a>
    <div><xsl:value-of select="description" /></div>
  </div>
</xsl:template> 
```

您当然可以添加另一个按and对元素进行`<xsl:key>`分组的方法，但是对于这种情况，它可能会变得不必要地复杂。`<issue>``fix_versions``@type`

# r - R中的src（）命令出错

> ID：11567204
> 
> 赞同：2
> 
> 时间：2012-07-19T18:36:33.720
> 
> 标签：r

昨天我在 Stats Exchange 上发布了[这个问题](https://stats.stackexchange.com/questions/32582/interpreting-a-weak-model-proceeding-from-there)，根据我得到的回复，我决定使用 R 的 src() 函数进行一些分析。它是“敏感性”包的一部分。

我安装包没有问题，然后尝试了以下命令：

```
sens <- src(seminars, REV, rank=TRUE, nboot=100) 
```

`sens`是存储测试结果的新变量

`seminars`是我使用`read.csv()`命令从 CSV 文件导入的数据框

`REV`是变量/列的名称`seminars`和我想要的响应变量

当我运行命令时，出现以下错误：

```
Error in data.frame(Y = y, X) : object 'REV' not found 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:42:10.167

来自 src 的文档

```
 y: a vector containing the responses corresponding to the design
      of experiments (model output variables). 
```

输入需要是一个向量（显然），并且您正在尝试传入一个名称（甚至不引用该名称）。由于在全局环境中没有定义 REV（我猜是由于错误消息），它不知道该怎么做。

通过阅读文档，听起来您想要做的是将`sensitivity[,-which(colnames(sensitivity) == "REV")]`（只是设计矩阵-您不想包含响应）传入 x 和`sensitivity[,"REV"]`y 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-16T08:50:49.423

此错误与 data.frame X=seminars 包含值为 0 的因素有关，这在构建回归系数时会产生错误。您可以先删除它们，因为它们不会影响输出的方差。

# mysql - 如何为 MySQL 设置默认访问权限

> ID：11567209
> 
> 赞同：0
> 
> 时间：2012-07-19T18:36:49.813
> 
> 标签：mysql, sql

我确信这是一个简单的问题，但我似乎无法在任何地方找到答案。

当我登录到命令行 mysql 程序时，我想通过键入来获得 root 访问权限`mysql`。但是，我需要输入`mysql -uroot -p`，然后输入我的密码。我怎样才能改变这个？

谢谢，
亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:43:42.277

[这](http://www.avajava.com/tutorials/lessons/how-do-i-log-on-to-mysql-automatically.html)是一个关于让 MySql 自动登录的教程。

只需按照步骤操作，您应该可以通过键入 登录 MySql `mysql`，如下图所示： ![在此处输入图像描述](../Images/3992dafc30fefc516e8231d0c8686393.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:05:33.353

当你第一次安装 mysql 时，你应该做的第一件事就是给 root@localhost 一个密码。要将密码设置为`mys3cr3t`，请运行以下命令：

```
UPDATE mysql.user SET password=password('mys3cr3t')
WHERE host='localhost' and user='root';
FLUSH PRIVILEGES;
EXIT 
```

现在，您必须使用`mysql -uroot -p`

接下来，您需要清除所有安全隐患。有一个脚本叫做`mysql_secure_installation`. 尽快运行它。这是做什么：[https ://dba.stackexchange.com/a/13350/877](https://dba.stackexchange.com/a/13350/877)

如果不这样做，则可能会发生磁盘级数据库攻击：[https ://dba.stackexchange.com/a/13363/877](https://dba.stackexchange.com/a/13363/877)

要测试您是否具有正确的用户身份验证，请运行以下命令：

```
SELECT USER(),CURRENT_USER(); 
```

这个查询告诉你什么？？？

[USER()](http://dev.mysql.com/doc/refman/5.5/en/information-functions.html#function_user)报告您如何尝试在 MySQL 中进行身份验证

[CURRENT_USER()](http://dev.mysql.com/doc/refman/5.5/en/information-functions.html#function_current-user)报告您是如何被允许在 MySQL 中进行身份验证的

如果`CURRENT_USER()`举报匿名用户，赶紧跑`mysql_secure_installation`！！！

# authentication - 就安全性而言，基本/摘要身份验证是否足以使用 Google Chrome 扩展程序中的 API？

> ID：11567210
> 
> 赞同：1
> 
> 时间：2012-07-19T18:36:50.770
> 
> 标签：authentication, google-chrome, google-chrome-extension

谷歌浏览器扩展的基本/摘要身份验证是否足以验证基于 Web 的 API？有人可以入侵它吗？我认为我不需要 OAuth，因为 API 不是第 3 方 API，而是我的服务的一部分（我计划为此创建一个 API 和将使用该 API 的 Google Chrome 扩展......）

# objective-c - 打开枚举

> ID：11567211
> 
> 赞同：1
> 
> 时间：2012-07-19T18:36:54.527
> 
> 标签：objective-c, enums, switch-statement

我有以下代码：

```
switch (self.status) {
    case refused:
        message=NSLocalizedString(@"booking refused", nil);
        break;
    case accepted:
        message=NSLocalizedString(@"booking accepted", nil);
        break;
    case taxiAborted:
        message=NSLocalizedString(@"booking aborted", nil);
        break;
    case near:
        message=NSLocalizedString(@"booking aborted", nil);
        break;
    case completed:
        message=NSLocalizedString(@"booking completed", nil);
        break;
    default:
        break;
} 
```

永远不会进入开关内部：既没有达到默认情况，也没有达到正确的值。在我的例子中，self.status 的值为“active”，它是以下枚举的一部分：

```
typedef enum {
requested = 0,
refused = 1,
    accepted =2,
    taxiAborted=3,
    near = 4,
    running= 5,
    completed = 6,
    userAborted=7
} statuses; 
```

我做错了什么？

# android - 如何在Android中按下按钮时将背景设置为随机颜色？

> ID：11567212
> 
> 赞同：4
> 
> 时间：2012-07-19T18:36:57.810
> 
> 标签：android, background-color

我正在编写一个应用程序，每次按下按钮时都会更改活动的背景颜色。这就是我到目前为止所拥有的。但它不工作！我究竟做错了什么？

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button b = (Button) findViewById(R.id.button1);        
    final View a = findViewById(R.id.m);        
    final Random color = new Random();
    final Paint p = new Paint();

    b.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

             p.setARGB(256,color.nextInt(256),color.nextInt(256),color.nextInt(256));                  
        a.setBackgroundColor((p.getColor()));

        }
    });
} 
```

它在我传递一种颜色时起作用，例如 a.setBackgroundColor(Color.GREEN);

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-25T13:58:01.543

可能为时已晚，但我一直在寻找同样的东西，当我阅读这个帖子时，我想出了问题的解决方案。

您将 256 用于 alpha，并将 256 用于最大随机数。但要使用的值是 0-255。如果你改变它会运作良好。

```
Random color = new Random();
a.setBackgroundColor(Color.argb(255, color.nextInt(255), color.nextInt(255), color.nextInt(255))); 
```

干杯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T19:25:29.320

我不确定这是否可行（但值得一试）：

尝试在 onClick() 语句中初始化 color = new Random()。

```
b.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v) {
         color = new Random();
         p.setARGB(256,color.nextInt(256),color.nextInt(256),color.nextInt(256));                  
    a.setBackgroundColor((p.getColor()));

    }
}); 
```

另外，看看这个问题：

[Android：点击时生成随机颜色？](https://stackoverflow.com/questions/5280367/android-generate-random-color-on-click)

似乎它正在尝试实现类似的目标。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-28T06:04:39.207

对于随机颜色我写了一个方法（你需要 import android.graphics.Color; import java.util.Random;）：

```
int randomColor() {
    Random r = new Random();
    int red = r.nextInt(256);
    int green = r.nextInt(256);
    int blue = r.nextInt(256);
    return Color.rgb(red, green, blue);
} 
```

然后我就这样使用它：

```
Paint p = new Paint();
p.setColor(randomColor()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T18:41:17.507

看起来您走在正确的道路上。不要忘记获取种子，否则您每次都会获得相同的“随机”值。

```
Random color = new Random(System.currentTimeMillis()); 
```

尝试将其包装在一个帖子中。

```
view.post(new Runnable() {
      @Override
      public void run() {
          // setbackground here
      }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-02T08:41:49.147

```
p.setARGB(200,color.nextInt(256),color.nextInt(256),color.nextInt(256));                  
a.setBackgroundColor((p.getColor())); 
```

# windows - 使用 OAuth 从 Windows 应用程序访问 Google App Engine 应用程序

> ID：11567213
> 
> 赞同：2
> 
> 时间：2012-07-19T18:36:59.033
> 
> 标签：windows, google-app-engine, oauth

我们有一个基于 Google App Engine 构建的应用程序。我们现在需要编写一个 Windows 7 托盘应用程序来访问我们的 GAE 应用程序提供的服务。这意味着我们需要首先与我们的应用程序建立 OAuth 连接，并且我们发现很难找到有关如何完成此操作的信息。

我们已经成功地使用 Google 的[OAuth2 API .net 客户端](https://code.google.com/p/google-api-dotnet-client/wiki/OAuth2)建立了从我们的 Windows 应用程序到 Google API 的可信连接，但这似乎并没有让我们访问 Google App Engine，它似乎位于不同的部分醚。

所以首先，我想问一下，我们对 Google App Engine 仅支持 OAuth 1.0 而不支持 OAuth 2 的理解是否正确，因为 Google API 的其余部分似乎支持？

其次，（假设上述答案是肯定的）是否有人知道有人已经成功地从 Windows .NET (C#) 应用程序到 Google App Engine 应用程序的 OAuth 1.0 连接的任何信息或示例代码？找到这样一个例子对我们有很大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T10:35:45.567

Google App Engine 仅支持[Oauth 1.0](https://developers.google.com/appengine/docs/java/oauth/overview?hl=it)，它仍然是一个实验性功能。

不得不处理一个 .NET C# 应用程序，我会以这种方式进行：

1.  获取[DevDefined OAuth](http://code.google.com/p/devdefined-tools/wiki/OAuth)包
2.  在这里查看[ExampleConsumerSite](https://github.com/bittercoder/DevDefined.OAuth-Examples/tree/master/src/ExampleConsumerSite)
3.  在 C# 中移植[Java](http://fabiouechi.blogspot.it/2011/11/using-google-oauth-java-client-to.html)或[Python中解释的相对简单的步骤](http://ikaisays.com/2011/05/26/setting-up-an-oauth-provider-on-google-app-engine/)

# mysql - 最新 MySQL 中的存储过程与普通 SQL 查询？

> ID：11567215
> 
> 赞同：2
> 
> 时间：2012-07-19T18:37:09.833
> 
> 标签：mysql, stored-procedures

我想知道在最新的 MySQL 中使用存储过程是否有任何性能优势？

由于普通 SQL 也像存储过程一样工作，因为 db 进行语法检查，计划被选择、编译和缓存。

最新版本有什么好处？由于仍然很少有公司主要使用存储过程。

提前致谢， 凯西尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-27T18:37:00.753

DB 和 App Server 在本地时，性能差异不大。当 DB 和 App Server 位于不同的地方时，性能会存在差异，这是正常情况。

# node.js - 无法在 express.js 中设置 https

> ID：11567217
> 
> 赞同：3
> 
> 时间：2012-07-19T18:37:16.287
> 
> 标签：node.js, ssl, https, express

我非常关注本教程（我发现的所有其他教程看起来都一样）

[http://www.hacksparrow.com/express-js-https.html](http://www.hacksparrow.com/express-js-https.html)

我的代码如下：

```
// dependencies
var express = require('express')
  , https = require('https')
  , fs = require('fs');

var privateKey = fs.readFileSync('./ssl/rp-key.pem').toString();
var certificate = fs.readFileSync('./ssl/rp-cert.pem').toString();

var app = express.createServer({
  key : privateKey
, cert : certificate
});

...

// start server
https.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

该应用程序在 sudo node app 之后启动正常

```
Express server listening on port 443 
```

现在当我卷曲

```
curl https://localhost/ 
```

我明白了

```
curl: (35) Unknown SSL protocol error in connection to localhost:443 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:17:55.613

从现在通过 npm 发布的 Express 3.x 开始，“app()”-应用程序函数发生了变化。[https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x](https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x)上有迁移信息。express 2.x SSL 教程不再适用。express 3.x 的正确代码是：

```
// dependencies
var express = require('express')
  , https = require('https')
  , fs = require('fs');

var privateKey = fs.readFileSync('./ssl/rp-key.pem').toString();
var certificate = fs.readFileSync('./ssl/rp-cert.pem').toString();

var options = {
  key : privateKey
, cert : certificate
}
var app = express();

...

// start server
https.createServer(options,app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

# wordpress - 将 Wordpress.com 博客迁移/映射到 TYPO3 驱动域上的子域

> ID：11567218
> 
> 赞同：0
> 
> 时间：2012-07-19T18:37:31.813
> 
> 标签：wordpress, typo3

*   我有一个博客 `test.wordpress.com`
*   我有一个由 TYPO3 提供支持的网站 `www.mysite.com`
*   我想将我的 wordpress 博客重定向（映射）到`www.blog.mysite.com`
*   我想`mysite.com`保持不变，我的博客由`wordpress.com`
*   我需要在 TYPO3 中做些什么才能使迁移正常工作吗？我需要手动在 TYPO3 中创建子域吗？
*   遵循 wordpress 的建议 - 更改 c 名称就足够了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:48:40.047

不，您不需要通过 TYPO3 映射它。

最好在您的 HTTP 服务器（可能是 Apache）上使用一些重定向 - 很可能在某个管理面板或`.htaccess`文件中。

这就是我现在能给出的所有建议。向您的主机管理员寻求域重定向的支持。如果不可能，您*可以*在 TYPO3 中执行此操作，但这没有任何意义。

# mysql - 平均使用 MySQL 的天数

> ID：11567219
> 
> 赞同：0
> 
> 时间：2012-07-19T18:37:33.107
> 
> 标签：mysql, average

我试图获取用户关闭票证与打开“下一张”票证之间的平均天数。

下面是我的 MySQL 表的示例。您会注意到 Mike 创建了 3 张工单，间隔 9 天（7 月 1 日-7 月 10 日）和 5 天（7 月 10 日-7 月 15 日），平均间隔为 7 天。我似乎无法弄清楚如何寻找最后解决的日期，有人有什么想法吗？这是我到目前为止所拥有的：

```
SELECT 
  Name, 
  Created, 
  Resolved, 
  avg(datediff("Last Ticket Resolved", created) AS last_tket_open 
FROM 
  MyTable 
WHERE 
  Name='Mike'

Name   Created  Resolved
----   -------  --------
Mike   July  1   July  1
Jill   July  2   July  3    
Mike   July 10   July 10
Harry  July 11   July 11
Mike   July 15   July 15 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:23:03.750

```
SELECT a.name, 
       AVG(DATEDIFF(a.resolved, b.created)) AS avgdays
FROM
(
   SELECT name, resolved, @val1:=@val1+1 AS rn
   FROM tbl
   CROSS JOIN (SELECT @val1:=0) val1_init
   WHERE name = 'Mike'
   ORDER BY resolved
) a
INNER JOIN
(
   SELECT created, @val2:=@val2+1 AS rn
   FROM tbl
   CROSS JOIN (SELECT @val2:=1) val2_init
   WHERE name = 'Mike'
   ORDER BY resolved
) b ON a.rn = b.rn 
```

* * *

## [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/2299f/27/0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:53:00.133

试试这个：

```
SELECT
  t1.Name,
  AVG( datediff( t2.Created, t1.Resolved )) AS avg_days_between_tickets
FROM
  MyTable t1,
  MyTable t2
WHERE
      t2.Name = t1.Name
  AND t2.Created = ( SELECT MIN( Created ) 
                     FROM MyTable 
                     WHERE Name = t1.Name 
                       AND Created > t1.Resolved )
GROUP BY
  t1.Name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:14:05.047

```
select 
  Name,
  AVG( datediff( next_created, resolve )) AS avg_time
from (select
  t1.Name,
  t1.Created,
  t1.Resolved,
  min(t2.Created) as next_created
from mytable t1
join myTable t2 on t1.Name = t2.Name and t2.Created > t1.Resolved
group by 1,2,3) x
group by 1; 
```

请注意，此查询不使用相关子查询（由于编码方式依赖于行中的值而对每一行执行的查询），因此它应该执行得很好。

# php - 如何在顶部获取 div 对象

> ID：11567225
> 
> 赞同：0
> 
> 时间：2012-07-19T18:37:56.537
> 
> 标签：php, css, html

我正在使用以下代码

```
<?php
$link= $_SERVER['HTTP_HOST'];
echo "<div id='link' style='position: relative; margin: 60 auto; width: 70%; top: -10px;
height: 100%;'>{$link}";

?> 
```

该代码工作正常，但我在页面上有其他内容。这使得上面的代码根据我设置页边距的方式将我的内容向下或向上移动。

我想要做的是让我的回声文本出现在我的内容上。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:39:34.410

使用位置：绝对；

```
<?php
$link= $_SERVER['HTTP_HOST'];
echo "<div id='link' style='position: absolute; width: 70%; top: 0px;
height: 100%;'>{$link}</div>";
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:41:32.753

可能你最好的选择是使用 position: absolute 而不是 relative。如果您需要调整与 div 相比的间距，则将其余内容向下推一些边距。

确保设置 left: 和 top: 属性以确保跨浏览器的一致性。

# ruby-on-rails-3 - CanCan：参数数量错误（1 代表 0）

> ID：11567227
> 
> 赞同：1
> 
> 时间：2012-07-19T18:38:05.087
> 
> 标签：ruby-on-rails-3, cancan

我似乎无法让 CanCan 工作。事实证明，这非常令人沮丧，尤其是当我遵循规则手册并尝试似乎在阳光下所有技巧以使其发挥作用时。

我正在使用 Rails 3.1.2、Devise 2.1.2 和 CanCan 1.6.8。我建立了一个单独的角色模型，正如 RyanB[在这里](https://github.com/ryanb/cancan/wiki/Separate-Role-Model)描述的那样。

这是我的代码。

**1) 能力.rb**

```
class Ability
  include CanCan::Ability

  def initializer(user)
    user ||= User.new  # For users with no account

    if (user.has_role?(:admin)) || (user.has_role?(:mod))
      can :manage, :all

    elsif user.has_role?(:registered)
      can :read, :all
      can :create, :all

      can :update, Question do |question|
        question.try(:user) == (user || user.has_role?(:admin) || user.has_role?(:mod))
      end

      can :destroy, Question do |question|
        question.try(:user) == (user || user.has_role?(:admin) || user.has_role?(:mod))
      end

    else
      can :read, :all        
    end
  end
end 
```

**2）has_role？user.rb 中的定义**

```
def has_role?(role_sym)
  roles.any? { |r| r.name.underscore.to_sym == role_sym }
end 
```

**3) 过滤器前的控制器**

```
before_filter :authenticate_user!, :except => :show

load_and_authorize_resource
skip_authorize_resource :only => :show 
```

使用 CanCan 授权任何控制器都会导致所有操作出现相同的错误。

**编辑：堆栈跟踪**

```
cancan (1.6.8) lib/cancan/controller_additions.rb:352:in `initialize'
cancan (1.6.8) lib/cancan/controller_additions.rb:352:in `new'
cancan (1.6.8) lib/cancan/controller_additions.rb:352:in `current_ability'
cancan (1.6.8) lib/cancan/controller_resource.rb:207:in `current_ability'
cancan (1.6.8) lib/cancan/controller_resource.rb:77:in `load_collection?'
cancan (1.6.8) lib/cancan/controller_resource.rb:33:in `load_resource'
cancan (1.6.8) lib/cancan/controller_resource.rb:25:in `load_and_authorize_resource'
cancan (1.6.8) lib/cancan/controller_resource.rb:10:in `block in add_before_filter'
activesupport (3.2.1) lib/active_support/callbacks.rb:429:in `_run__458654864__process_action__156152648__callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.1) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.1) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.1) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.1) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.1) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.1) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.1) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.1) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.1) lib/action_controller/metal/params_wrapper.rb:205:in `process_action'
activerecord (3.2.1) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.1) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.1) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.1) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.1) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.1) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:66:in `call'
actionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:66:in `dispatch'
actionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:30:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:589:in `call'
warden (1.2.1) lib/warden/manager.rb:35:in `block in call'
warden (1.2.1) lib/warden/manager.rb:34:in `catch'
warden (1.2.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/cookies.rb:338:in `call'
activerecord (3.2.1) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.1) lib/active_support/callbacks.rb:405:in `_run__446710069__call__461654473__callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.1) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.1) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.1) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.1) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.1) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/static.rb:53:in `call'
railties (3.2.1) lib/rails/engine.rb:479:in `call'
railties (3.2.1) lib/rails/application.rb:220:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.1) lib/rails/rack/log_tailer.rb:14:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
/home/administrator/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
/home/administrator/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
/home/administrator/.rvm/rubies/ruby-1

.9.3-p125/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T06:47:21.130

好吧，看来，我没有遵守规则手册的所有规则。虽然我看不出这怎么可能是个问题。为了让它工作，我删除了我手动创建的***能力.rb***文件，并使用`rails g cancan:ability`命令在同一目录中生成相同的文件，并使用相同的代码。现在它就像一个魅力。

# apache - 别名模块不起作用

> ID：11567229
> 
> 赞同：1
> 
> 时间：2012-07-19T18:38:07.423
> 
> 标签：apache

在我的 apache 服务器（在 windows7 上）的 httpd.conf 文件中，我使用了***LoadModule alias_module modules/mod_alias.so*** 然后我用以下内容修改了 httpd.conf：

<IfModule alias_module>
    ***别名 /b /blog***
    ScriptAlias /cgi-bin/ "cgi-bin/"
</IfModule>

在我重新启动服务器并在地址栏中键入 localhost/b 后，它没有重定向到 localhost/blog。我不知道为什么。你能帮我吗，非常感谢任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:51:47.503

别名声明与重定向不同。

```
Alias /b /blog 
```

告诉 Apache 使*您的文件系统上*存在的文件在 URL 处可用的路径`/blog`（这在 Windows 上没有多大意义）下可用`http://myserver.com/b`，即请求`http://myserver.com/b/something.html`将尝试`/blog/something.html`从您的文件系统返回文件的内容，如果那样则失败文件不存在 - 浏览器地址栏仍会显示`http://myserver.com/b/something.html`.

听起来你所追求的是

```
Redirect /b http://myserver.com/blog 
```

在这种情况下，请求`http://myserver.com/b/something.html`将导致 HTTP 重定向，浏览器的地址栏将更改为`http://myserver.com/blog/something.html`.

当然，您需要确保`/blog`正确解析，`Alias`如果它不在`DocumentRoot`.

```
Alias /blog "C:/web/blog"
<Directory "C:/web/blog">
  Order allow,deny
  Allow from all
</Directory> 
```

# c - mingw32 显示对所有 gtk 函数的未定义引用

> ID：11567233
> 
> 赞同：1
> 
> 时间：2012-07-19T18:38:24.660
> 
> 标签：c, gcc, gtk, mingw, msys

我正在尝试编译以下代码，base.c

```
#include <glib/gerror.h>
#include <gtk/gtk.h>
#include <gdk-pixbuf/gdk-pixbuf.h>

int main( int   argc,
          char *argv[] )
{
    GtkWidget *window;

    gtk_init (&argc, &argv);

    window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
    gtk_widget_show  (window);

    gtk_main ();

    return(0);
}
/* example-end */ 
```

我编译它使用

```
gcc -Wall base.c -o base `pkg-config --cflags --libs gtk+-2.0` 
```

我在 MinGW 中收到的消息是

C:\Users\Sunny\AppData\Local\Temp\cc4eIpLM.o:base.c:(.text+0x34)：未定义引用`gtk_init_abi_check`

`collect2: ld return 1 exit status`

我收到相同的消息`gtk_window_new`，`gtk_widget_show`并且`gtk_main`

我感觉这可能与以下问题有关：

1) 当用 gtk 编译 c 程序时，我应该把它们保存在哪里。在某处的mingw文件夹中？

2）我目前已将此附加到我的系统变量路径中：`C:\gtk\bin\;C:\msys\1.0\bin;C:\mingw\bin` 是否正确？

3) mingw32 找不到库。当我下载 msys 和 mingw 时，我应该对它们做些什么吗？

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T08:16:03.340

[https://mail.gnome.org/archives/gtk-app-devel-list/2010-February/msg00036.html](https://mail.gnome.org/archives/gtk-app-devel-list/2010-February/msg00036.html)

# android - 当我告诉它时屏幕不会变暗

> ID：11567243
> 
> 赞同：0
> 
> 时间：2012-07-19T18:39:34.010
> 
> 标签：android

当我从通知中调用活动时，我试图让我的屏幕变暗。这是我正在使用的代码：

```
WindowManager.LayoutParams lp = getWindow().getAttributes();
lp.screenBrightness = 0.01f;
getWindow().setAttributes(lp); 
```

也许我在这里做错了什么，如果是这样，有人可以告诉我发生了什么以及为什么它没有按预期的方式工作？！

```
import android.app.Activity;
import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;

public class NoteMe extends Activity {
/** Called when the activity is first created. */
NotificationManager nm;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    String title = "Example text";
    String contentText = "Full hello world!";
    String text = "Starting Notification!";

    nm = (NotificationManager) this
            .getSystemService(Context.NOTIFICATION_SERVICE);
    long when = System.currentTimeMillis();
    int icon = R.drawable.ic_launcher;

    Intent intent = new Intent(getBaseContext(), MainActivity.class);
    PendingIntent contentIntent = PendingIntent.getActivity(
            getBaseContext(), 0, intent, 0);

    Notification notification = new Notification(icon, text, when);
    notification.setLatestEventInfo(getBaseContext(), title, contentText,
            contentIntent);
    notification.flags = Notification.FLAG_ONGOING_EVENT;
    int NOTIFICATION_ID = 10;
    nm.notify(NOTIFICATION_ID, notification);
}
} 
```

这是请求的代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:44:06.407

尝试这样的事情 - 设置属性后刷新屏幕。

```
 WindowManager.LayoutParams lp = getWindow().getAttributes();
    lp.screenBrightness =0.01f
    getWindow().setAttributes(lp);

    startActivity(new Intent(this,RefreshScreen.class)); 
```

因此，刷新屏幕的一个技巧是启动虚拟活动，而不是在创建该虚拟活动时调用 finish(); 所以亮度的变化才会生效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:51:42.957

您发布的代码只会使您的应用程序的屏幕变暗。如果那是你想要的，那很好。但是如果你想在手机上调暗屏幕那么你需要改变系统设置[System.SCREEN_BRIGHTNESS](http://developer.android.com/reference/android/provider/Settings.System.html#SCREEN_BRIGHTNESS)

```
 // turn on manual control of system screen brightness
    Settings.System.putInt(getContentResolver(), Settings.System.SCREEN_BRIGHTNESS_MODE, Settings.System.SCREEN_BRIGHTNESS_MODE_MANUAL);

    final int dimBrightnessValue = 96;  // valid values 0-255
    // change the brightness value
    System.putInt(getContentResolver(), System.SCREEN_BRIGHTNESS, dimBrightnessValue); 
```

您还需要将以下内容添加到 AndroidManifest.xml

```
<!-- Needed for changing screen brightness -->
<uses-permission android:name="android.permission.WRITE_SETTINGS" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T18:52:32.970

您的代码是 100% 正确的。有两种可能，第一种可能性最大

1）活动没有被取消通知。我相信有一种特殊的方式可以让您从涉及待处理意图的通知中触发。我猜这就是问题所在。只是为了确保在 onCreate 和 onStart 中放置一些断点以查看它是否被调用。或者只是在你的代码附近放一个日志语句，看看它是否被调用。我猜它永远不会被调用。

2）您所做的调整 0.1f 是不可见的变化。

请查看此内容并确保收到通知：

[http://www.vogella.com/articles/AndroidNotifications/article.html](http://www.vogella.com/articles/AndroidNotifications/article.html)

我看到的一个区别是 getContextBase() 与 this

如果不是这样，它看起来可能 MainActivity.class 清单声明可能不正确。

# c# - 需要记录以下请求所花费的时间？

> ID：11567249
> 
> 赞同：0
> 
> 时间：2012-07-19T18:39:54.820
> 
> 标签：c#, .net, wcf, c#-4.0

我在这里使用小型 C# .net 测试客户端执行 WCF 服务测试。我如何记录以下项目所花费的时间：-

1.  响应的传输时间。
2.  数据反序列化所需的时间。

我如何在 .net 中使用 WCF 服务代理来获得这些时间？

任何其他方式（由于此处的管理策略问题而无法使用 Soap UI 和提琴手）将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:46:46.857

我建议你看看

[http://miniprofiler.com/](http://miniprofiler.com/)

我在生产网站中使用过它，它对我来说确实很神奇。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:45:44.330

您可以尝试 Chris Patterson 的新基准测试框架[benchmarque](http://lostechies.com/chrispatterson/2012/07/18/benchmarque-comparative-benchmarking-for-net/?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed:%20LosTechies%20%28LosTechies%29)：

> 什么是基准测试？
> 
> Benchmarque（发音为 bench-mar-key）允许您使用 .NET 创建比较基准。比较基准的一个示例是评估执行操作的两种或多种方法，例如 for()、foreach() 或 LINQ 在枚举项目数组时是否更快。虽然此示例通常属于过度优化类别，但有许多相关算法可能需要在周期很重要时进行比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T18:43:00.560

最终的后备是秒表，这至少适用于反序列化。

```
var stopWatch = new Stopwatch();

stopWatch.Start();

// you call here

stopWatch.Stop();

var time = stopWatch.ElapsedTicks; 
```

# objective-c - 将 UISliders 值显示为 %

> ID：11567252
> 
> 赞同：1
> 
> 时间：2012-07-19T18:40:19.417
> 
> 标签：objective-c, ios, xcode, cocoa-touch, uislider

我有一个 UILabel，它当前在 UISlider 上将值显示为 0 和 1 之间的值，以 0.1 为增量（因此它会显示 .1 或 .2 或 .3 等，最多为 1）。但是我想将此值显示为 100 中的百分比，但我对格式化浮点数不太熟悉。这是我现在拥有的代码：

```
sliderLabel.text = [NSString stringWithFormat:@"%.1f", [[f numberFromString:thresholdFile] floatValue]]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T18:45:49.403

哈哈，这可能很棘手......来自[`printf`](http://www.cplusplus.com/reference/clibrary/cstdio/printf/)文档：

> .nu​​mber
> 对于 e、E 和 f 说明符：这是要在小数点后打印的位数。

因此，您真正想要的是：

```
[NSString stringWithFormat:@"%f %%", [mySlider value] * 100]; 
```

让我们分解一下，好吗？

1.  `%f`：打印参数列表中的第一个浮点数，即：

    ```
    [mySlider value] * 100 
    ```

    请注意`* 100`那里的部分，它将 范围内的数字转换为 范围`0 ... 1`内的数字`0 ... 100`。`round()`如果您不想要小数百分比，您可能希望调用此选项。

2.  `%%`：打印出一个实际的`%`字符。这是因为`printf`搜索以字符开头的开关，`%`所以如果我们在字符串中有一个逐字记录，它会抛出一个嘶嘶声。因此，我们用另一个来逃避它`%`（就像我们用反斜杠一样），这很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T18:46:57.373

只需将值乘以 100

```
sliderLabel.text = [NSString stringWithFormat:@"%f %%",(/*name of slider*/.value)*100]; 
```

# objective-c - 沿 Y 轴和 X 轴独立缩放核心图

> ID：11567254
> 
> 赞同：2
> 
> 时间：2012-07-19T18:40:20.633
> 
> 标签：objective-c, xcode, xcode4.3, core-plot

我正在使用下面的代码沿 X 轴 Y 轴滚动我的核心图并进行缩放。它工作正常。但是当我放大我的核心情节时，它会在两个方向上放大。如果我沿 x 方向捏合，我希望绘图沿 X 缩放，如果沿 Y 方向捏合，则缩放 Y。有人可以帮我解决这个问题吗？

```
-(CGPoint)plotSpace:(CPTPlotSpace *)space willDisplaceBy:(CGPoint)displacement
{
    return CGPointMake(displacement.x, displacement.y);
}

-(CPTPlotRange *)plotSpace:(CPTPlotSpace *)space willChangePlotRangeTo:(CPTPlotRange *)newRange forCoordinate:(CPTCoordinate)coordinate
{                                                                                                                                                                                                                                           
    // Adjust axis to keep them in view at the left and bottom;
    // adjust scale-labels to match the scroll.

    CPTXYAxisSet *axisSet = (CPTXYAxisSet *)self.hostView.hostedGraph.axisSet;
    if (coordinate == CPTCoordinateX) {
        axisSet.yAxis.orthogonalCoordinateDecimal = newRange.location;
    }

    else {
        axisSet.yAxis.titleLocation = CPTDecimalFromFloat(newRange.locationDouble +                                                  (newRange.lengthDouble / 2.0F));
    }

    return newRange;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:40:52.070

将坐标轴和标题保持在正确位置的最简单方法是使用`axisConstraints`坐标轴并将其保留为`titleLocation`默认的 NAN。这将减轻您的代表更新这些项目的责任，您可以专注于缩放。

在这两个委托方法中，您只需要`-plotSpace:willChangePlotRangeTo:forCoordinate:`. 另一个仅在滚动时调用。

决定是否要允许在 x 或 y 中进行缩放（请参阅原始问题评论中的链接）。检查`coordinate`委托方法中的参数；返回`newRange`以允许缩放或`[space plotRangeForCoordinate:coordinate]`恢复原始范围并防止缩放。

如果您需要使用自己的手势识别器来检测捏合角度，`allowPinchScaling`请在托管视图上设置为 NO 以禁用内置识别器。将您自己的识别器添加到托管视图。在处理程序方法中，决定要缩放哪个轴（如果有）并相应地调整适当的绘图范围。如果你这样做，你根本不需要绘图空间委托。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T15:32:33.983

我正在使用 UIPinchGestureRecognizer 计算 X 和 Y 坐标的变化，然后确定绘图范围应该改变的方向（X 或 Y）。它工作正常，但不像常规缩放那样平滑，并且响应较晚。有人可以建议我一个更好的方法来做到这一点

```
- (void)handlePinchGesture:(UIPinchGestureRecognizer *)gestureRecognizer{
       if ([gestureRecognizer state] == UIGestureRecognizerStateBegan){

        CGPoint translation = [gestureRecognizer locationInView:hostView];
       NSLog(@"Sender value %f %f", translation.x,translation.y );
        initialX = translation.x;
        initialY = translation.y;        
        return;   
} 
else if ([gestureRecognizer state] == UIGestureRecognizerStateBegan || [gestureRecognizer state] == UIGestureRecognizerStateChanged){
                NSLog(@"inside else");
        CGPoint currentTouchLocation = [gestureRecognizer locationInView:hostView];
        NSLog(@"currentTouchLocation = %f and  %f and ",currentTouchLocation.x, currentTouchLocation.y);
            finalX = currentTouchLocation.x;
            finalY = currentTouchLocation.y;
                  }
}
-(CPTPlotRange *)plotSpace:(CPTPlotSpace *)space willChangePlotRangeTo:(CPTPlotRange *)newRange forCoordinate:(CPTCoordinate)coordinate
{
    float x = fabsf(finalX - initialX) ;
    float y = fabsf(finalY - initialY);
    NSLog(@"pinch x = %f  pinch y = %f", x, y);
      CPTPlotRange *updatedRange = nil;

    if (x > y) {
        switch ( coordinate ) {
            case CPTCoordinateX:
                NSLog(@"x is greater than y change x-range");

                if (newRange.locationDouble < 0.0F ) {
                    CPTMutablePlotRange *mutableRange = [[newRange mutableCopy] autorelease];
                  mutableRange.location = CPTDecimalFromFloat(0.0);
                    updatedRange = mutableRange;
                }
                else {
                    updatedRange = newRange;
               }
                break;
            case CPTCoordinateY:
                NSLog(@"x is greater than y keep y range constant");

                updatedRange = ((CPTXYPlotSpace *)space).yRange;
                break;

        }

            }

    if (x < y) {
        switch ( coordinate ) {
            case CPTCoordinateX:
                NSLog(@"y is greater than x keep x-range constant");

                updatedRange = ((CPTXYPlotSpace *)space).xRange;
                                break;
            case CPTCoordinateY:
                if (newRange.locationDouble < 0.0F) {
                    NSLog(@"y is greater than x increase y range");
                    CPTMutablePlotRange *mutableRange = [[newRange mutableCopy] autorelease];
                  //  mutableRange.location = CPTDecimalFromFloat(0.0);
                    updatedRange = mutableRange;
                }
                else {
                   updatedRange = newRange;
                }

                break;

        }

    }
    if (x == y) {
        switch ( coordinate ) {
            case CPTCoordinateX:
                NSLog(@"y is equal to  x keep x-range constant");
                updatedRange = ((CPTXYPlotSpace *)space).xRange;
                break;
            case CPTCoordinateY:
                NSLog(@"y is equal to x keep y-range constant");
                //NSLog(@"%d", CPTCoordinateY);
                updatedRange = ((CPTXYPlotSpace *)space).yRange;
                break;

        }

    }

      return updatedRange;

} 
```

# ruby-on-rails - 将 Rails 应用程序连接到 microsoft access

> ID：11567256
> 
> 赞同：2
> 
> 时间：2012-07-19T18:40:24.960
> 
> 标签：ruby-on-rails, ms-access

我有一个客户希望将数据从表单传输到访问数据库。我看到了一些用于导轨的 odbc 连接器，但它只是旧项目。

我可以在 CSV 中导出/导入数据，但我想要更简单的解决方案。

您知道是否有将 Rails 与 Access 连接的解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:57:38.540

如果他的 access 数据库不存在，那么一个好的解决方案是使用 MySQL 数据库创建一个 rails 应用程序，然后使用 microsoft access 作为 mysql db (OBDC) 的前端。Ref [Access 作为 MySQL 的前端](http://dev.mysql.com/doc/refman/5.1/en/connector-odbc-examples-tools-with-access.html#connector-odbc-examples-tools-with-access-linked-tables)

因此，他可以通过访问查看 mysql 数据库中的所有数据，并且如果他愿意，可以轻松地将整个数据库导入他的本地机器，但这不是必需的。

# html - 图片在 IE9 中被复制？

> ID：11567257
> 
> 赞同：0
> 
> 时间：2012-07-19T18:40:27.203
> 
> 标签：html, css, internet-explorer, internet-explorer-9

Internet Explorer 9 不正确地呈现[我的网页](http://element17.com/)，我不知道为什么。它正在复制每个缩略图，其中一个显示淡入效果，另一个显示放大镜图像。在 Chrome 和 Firefox（版本分别为 21.0.1180.49 和 14.0.1）中可以看到正确的功能。谁能建议为什么会发生这种情况？CSS 在[这里](http://element17.com/css/main.css)。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:43:23.430

介意先验证页面吗？ [http://validator.w3.org/check?uri=http%3A%2F%2Felement17.com%2F&charset=%28detect+automatically%29&doctype=Inline&group=0](http://validator.w3.org/check?uri=http%3A%2F%2Felement17.com%2F&charset=%28detect+automatically%29&doctype=Inline&group=0)

# asp.net - ASP.NET MVC 4 - 应用程序不接受新的连接字符串 - AppHarbor 部署问题

> ID：11567260
> 
> 赞同：3
> 
> 时间：2012-07-19T18:40:34.847
> 
> 标签：asp.net, asp.net-mvc, entity-framework, entity-framework-4.1, appharbor

我目前正在开发一个 ASP.NET MVC 4 项目，该项目使用 Entity Framework 4.3 和 CodeFirst 方法，使用简单的 POCO 类。另外，我使用 SQL Server Express 作为开发数据库。

在构建了我的类并设置了连接字符串之后，我运行了我的项目，它为我生成了一个 SQL Server Express 数据库，没有任何问题。

但问题是我正在尝试部署到 AppHarbor 并且我遇到了连接字符串的问题。AppHarbor 要求您将 SQL Server 安装为“附加组件”并将连接字符串配置为具有一个别名，该别名会将其 Sequilizer 连接字符串注入您从 GitHub 推送的项目中。

这是他们有关其工作原理的文档：http: [//support.appharbor.com/kb/add-ons/using-sequelizer](http://support.appharbor.com/kb/add-ons/using-sequelizer)

我相信我的所有这些设置都是正确的，但是我的应用程序读取连接字符串的方式似乎存在问题。

这是我在本地机器上使用的开发连接字符串：

```
<connectionStrings>
    <add name="DefaultConnection" 
         connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=aspnet-FranchiseManager-201275154247;Integrated Security=True" 
         providerName="System.Data.SqlClient" />
</connectionStrings> 
```

AppHarbor Sequilizer 连接字符串如下所示：

```
<connectionStrings>    
    <add
      name="DefaultConnection"
      connectionString="Server=0691298f-d461-40cc-86d6-a089016ba88d.sqlserver.sequelizer.com;Database=<removed hash value>;User ID=<removed hash value>;Password=<removed hash value>;"
      providerName="System.Data.SqlClient"
    />
  </connectionStrings> 
```

第一个连接 - 由我的 EF 在本地生成 - 工作得很好。第二个 - 由 Sequilizer 创建 - 没有被我的应用程序读取。

**但是 - 我可以通过 SQL Server Management Studio 连接到 Sequilizer 数据库。** 所以它一定是我的应用程序吧？

为了解决我到 AppHarbor 的部署问题，我将它们的连接字符串硬编码到我的应用程序中，而不是由 EF 自动生成并在我的本地机器上测试的连接字符串。

这是我所做的：

1.  用提供的 AppHarbor 替换了 Web.config 中的连接字符串，
2.  清洗溶液，
3.  重建解决方案

但是当我运行应用程序时，它仍在使用 EF 生成的原始数据库——这一定意味着它仍在读取旧的连接字符串。

**似乎更改连接字符串是不够的。为了替换连接字符串，我还应该更改我的应用程序中的哪些内容？**

任何建议表示赞赏 - 谢谢！

* * *

编辑

* * *

这是我的 DbContext 类：

```
public class FranchiseManagerContext : DbContext
    {
        public DbSet<FranchiseSet> FranchiseSets { get; set; }
        public DbSet<Franchise> Franchises { get; set; }

    } 
```

这适用于名为“DefaultConnection”的连接字符串。

在这种情况下，EF 如何知道将 DbContext 与连接字符串匹配，但如果您更改字符串的名称，它就无法做到这一点？

**更新**

我想我从这个 SO 答案中知道它现在是 [什么： SQL Server 连接字符串中的“初始目录”有什么意义？](https://stackoverflow.com/questions/1949774/what-is-the-point-of-initial-catalog-in-a-sql-server-connection-string)

看起来 Initial Catalog 属性指定了在 Entity Framework 首次启动时要使用的特定数据库。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-20T02:26:25.793

您必须指定您希望 DbContext 加载的连接字符串的名称。它无法神奇地猜测您希望它使用名为`DefaultConnection`. 有一个启发式表示，如果没有指定名称，它将寻找一个连接字符串，并将其`name`设置为继承自的类的名称`DbContext`。IE。如果你有：

```
MyAwesomeDatebase : DbContext 
```

...然后实体框架将开箱即用：

```
<add name="MyAwesomeDatebase" connectionString="blah" providerName="System.Data.SqlClient" /> 
```

...但如果你有：

```
<add name="DefaultConnection" connectionString="blah" providerName="System.Data.SqlClient" /> 
```

...那么它将无法工作，因为实体框架无法知道`MyAwesomeDatebase`与`DefaultConnection`.

要使其工作，请执行以下操作：

```
public class MyAwesomeDatebase : DbContext
{
    public MyAwesomeDatebase() : base("DefaultConnection")
} 
```

......你是金色的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:28:54.347

好的，我想我终于得到了这个工作。

我在 AppHarbor 文档的任何地方都找不到它（也许它是特定于 .net mvc 的东西？），但连接字符串必须与我的 DbContext 类同名。

通过查看有关 SO 的其他一些问题，我找到了一些提示。

对于可能遇到相同问题的其他任何人：

1.  确保 Web.config 中 ConnectionString 的 name 属性与您的 DbContext 类同名
2.  提交项目并将其推送到您的仓库
3.  确保 AppHarbor 上的别名名称与您的连接字符串相同
4.  **在第 3 步之后**在 app Harbor 上部署新构建（这是获取新连接字符串名称所必需的）

之后，我的应用程序获取了 Sequilizer 数据库，现在可以正常工作了。

# sqlalchemy - 使用 contains_eager 进行正确的 SqlAlchemy 查询

> ID：11567266
> 
> 赞同：4
> 
> 时间：2012-07-19T18:41:05.223
> 
> 标签：sqlalchemy

我有一个查询，我找到了一个可行的解决方案。我不确定我是否正确执行了查询，我希望能找到答案。表格如下所示：

![所有者](../Images/9de4e3d55e83d01905a3f2e3fd1834fe.png)

查询是：

```
q = session.query(Person).outerjoin(PetOwner).join(Animal).options(contains_eager("petowner_set"), contains_eager("petowner_set.animal")) 
```

将其与宠物主人联系起来的人有关系。

`person`如果连接 from to`petowner`和 join from `petowner`to`animal`都是内连接或外连接，这将很容易。但是，从`person`to连接`petowner`是外连接，从`petowner`to连接`animal`是内连接。为此，我向`contains_eager`选项添加了两个调用。

这是完成此任务的正确方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T09:15:04.787

**简短回答：** *据我所知，您应该同时使用`outerjoin`两者，除非您不想看到`Persons`谁没有动物*。

**首先**，让我们看一下`JOIN`s：

*   `both INNER`：在这种情况下，您的查询结果将**仅**返回那些`Person`至少有一只动物的 s（假设 any`PetOwner.animal`不可为空）
*   `OUTER for PetOwner, INNER for Animal`：与上面相同（再次假设 any`PetOwner.animal`不可为空）
*   `both OUTER`: 你的查询结果将返回**所有** `Person`s 而不管他们是否`Animal`拥有

**那么**，怎么`contains_eager`办？根据[文件](http://docs.sqlalchemy.org/en/rel_0_7/orm/loading.html#sqlalchemy.orm.contains_eager)，

> ... 将向查询指示应该从当前查询中的列中急切地加载给定的属性。

这意味着当您访问 时`Person.petowner_set`，不需要额外的数据库查询，因为 SA 将从您的原始查询加载关系。这绝对不会影响您的`JOINs`工作方式，只会影响关系的加载。这只是一个数据加载优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-11-14T07:34:01.540

我认为唯一的区别是您应该将调用链接到`contains_eager`，如下所示：

```
q = (session.query(Person)
    .outerjoin(PetOwner)
    .join(Animal)
    .options(
      contains_eager("petowner_set").contains_eager("petowner_set.animal")
    )
) 
```

见：[https ://docs.sqlalchemy.org/en/latest/orm/loading_relationships.html#controlling-loading-via-options](https://docs.sqlalchemy.org/en/latest/orm/loading_relationships.html#controlling-loading-via-options)

# kohana - Kohana - 验证 ORM

> ID：11567269
> 
> 赞同：-1
> 
> 时间：2012-07-19T18:41:18.470
> 
> 标签：kohana, kohana-3, kohana-orm, kohana-3.2, kohana-db

我现在使用 Kohana 有一段时间了。我使用“has_many”、“has_one”、“belongs_to”没有问题，我的问题是：

如果我有 2 个这样的表：

tbl_foo1

```
id | tbl_foo2_id | field1
-------------------------
1  | 2           | bar
2  | 1           | foo 
```

tbl_foo2

```
id | field1
-----------
1  | foo
2  | bar 
```

我必须有这样的关系： tbl_foo1 属于 tbl_foo2 并且 tbl_foo2 有很多 tbl_foo1 到目前为止一切都很好。

问题是当我尝试将关系保存在控制器中时。所以我有这个代码：

```
$t1 = ORM::factory('tbl_foo1')->values($values, $expected)->create();
$t2 = ORM::factory('tbl_foo2', $_POST['id']);
$t1->tbl_foo2_id = $t2;
$t1->save(); 
```

好的，这应该可行，但我认为这不是最好的解决方案，也不是最漂亮的。有 2 个原因，1 因为性能 - 它执行 3 个查询（1 保存 $t1，2 查找 $t2，3 保存 $t2 与 $t1 的关系）和 2 因为它可能保存空记录，因为它没有t 验证 $t2 中记录的存在。

所以我的主要问题是，这应该怎么做？

* * *

**我自己的解决方案**

我使用了 biakaveron 给我的解决方案，谢谢。但是仍然存在验证问题..所以我花了一些时间想出了一个解决方案，使用相同的示例：

```
$t2 = ORM::factory('tbl_foo2', $_POST['id']);
$t1 = ORM::factory('tbl_foo1')->values($values, $expected);
$t1->foo2 = $t2; // foo2 is a belongs_to relationship
$t1->create(); 
```

在`tbl_foo1`模型中我添加了规则功能：

```
public function rules()
{
    'foo2_id' => array('not_empty')
} 
```

所以这样一来，我就不必再做一次查询了，这对性能有好处，而且是一种简单的方法。它可以工作，因为当 ORM 试图找到模型的 id 时`tbl_foo2`，如果没有找到，它会返回 NULL，所以无论如何它都会为空！

**注意：**我也使用了数据库事务（因为这只是过程的一部分），所以如果其中一个查询由于某种原因中断，那么不会运行任何查询。请记住，您必须使用一个支持事务的数据库引擎（我的是 InnoDB）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:04:07.870

1 您可以使用对象保存模型`belongs_to`：

```
$t2 = ORM::factory('tbl_foo2', $this->request->post('id'));
if (!$t2->loaded()) 
{
    // wrong ID for tbl_foo2
}

$t1 = ORM::factory('tbl_foo1')->values($values, $expected);
$t1->foo2 = $t2; // foo2 is a belongs_to relationship
$t1->create(); 
```

2 检查`tbl_foo2_id`特殊回调。

# grails - 加载 BuildConfig 时出错 (Grails 2.1.0)

> ID：11567274
> 
> 赞同：2
> 
> 时间：2012-07-19T18:41:27.797
> 
> 标签：grails

我已经绞尽脑汁好几个小时试图弄清楚这一点。每当我尝试对新创建的 Grails 项目（使用全新的 Grails 安装）执行任何类型的操作时，都会收到以下错误消息：

```
Error There was an error loading the BuildConfig: ivy pattern must be absolute: 
${HOME}/.m2/alpha/repository/[organisation]/[module]/[revision]/[module]-[revision](-
[classifier]).pom (Use --stacktrace to see the full trace) 
```

我可以推断出我的安装存在问题，但正如我所说，它是全新安装，所以我不确定是什么导致了这个问题。

我正在运行Win7。任何帮助将非常感激。

编辑：

```
grails.servlet.version = "2.5" // Change depending on target container compliance (2.5 or 3.0)
grails.project.class.dir = "target/classes"
grails.project.test.class.dir = "target/test-classes"
grails.project.test.reports.dir = "target/test-reports"
grails.project.target.level = 1.6
grails.project.source.level = 1.6
//grails.project.war.file = "target/${appName}-${appVersion}.war"

grails.project.dependency.resolution = {
    // inherit Grails' default dependencies
    inherits("global") {
        // specify dependency exclusions here; for example, uncomment this to disable ehcache:
        // excludes 'ehcache'
    }
    log "error" // log level of Ivy resolver, either 'error', 'warn', 'info', 'debug' or 'verbose'
    checksums true // Whether to verify checksums on resolve

    repositories {
        inherits true // Whether to inherit repository definitions from plugins

        grailsPlugins()
        grailsHome()
        grailsCentral()

        mavenLocal()
        mavenCentral()

        // uncomment these (or add new ones) to enable remote dependency resolution from public Maven repositories
        //mavenRepo "http://snapshots.repository.codehaus.org"
        //mavenRepo "http://repository.codehaus.org"
        //mavenRepo "http://download.java.net/maven/2/"
        //mavenRepo "http://repository.jboss.com/maven2/"
    }
    dependencies {
        // specify dependencies here under either 'build', 'compile', 'runtime', 'test' or 'provided' scopes eg.

        // runtime 'mysql:mysql-connector-java:5.1.20'
    }

    plugins {
        runtime ":hibernate:$grailsVersion"
        runtime ":jquery:1.7.1"
        runtime ":resources:1.1.6"

        // Uncomment these (or add new ones) to enable additional resources capabilities
        //runtime ":zipped-resources:1.0"
        //runtime ":cached-resources:1.0"
        //runtime ":yui-minify-resources:0.1.4"

        build ":tomcat:$grailsVersion"

        runtime ":database-migration:1.1"

        compile ':cache:1.0.0.RC1'
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:52:50.903

问题暂时解决了。

这是一个 Maven 问题，我最初没有考虑过。出于某种原因，/Users/USERNAME/.mp2/settings.xml 中的 localRepository 标记无法解析 HOME 的路径，因此将 ${HOME} 替换为 C:/Users/USERNAME 就可以了。奇怪，但它现在有效。如果有人有更好的解决方案，请告诉我！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-06T01:16:12.283

我的解决方案有点不同：

(1) 创建一个指向您的 .m2 存储库位置的变量：

```
def localMavenRepo = "file://" + new File(System.getProperty('user.home'), '.m2/repository').absolutePath 
```

(2) 创建存储库条目：

```
repositories { 
    ... 
    mavenRepo name: 'Local', root: localMavenRepo 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T22:34:18.277

我通过将`M2_REPO`环境变量设置为绝对路径解决了这个问题。在 Linux 上：

```
export M2_HOME=/home/chris/.m2/repository/ 
```

在 Windows 上，您可以在系统属性对话框中设置环境变量（系统属性的快捷方式是*WindowsKey* + *PauseKey*）。转到*系统属性*->*高级*->*环境变量*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T17:58:33.993

I also got the same problem. I think it's not Maven problem, it's Apache Ivy's problem.

I think Apache Maven 2/3 works well, it's just that Apache Ivy didn't pick the correct Maven folder. The Apache Ivy didn't expand the ${user.home} as it should.

# jsf - 了解 JSF 中的 HttpServletRequest 和 cookie

> ID：11567277
> 
> 赞同：0
> 
> 时间：2012-07-19T18:41:40.650
> 
> 标签：jsf, jakarta-ee, cookies

为了在 JSF 中创建“记住我”登录，我试图了解 Cookie 的工作原理。我使用 JSF 创建了一个全新的 Web 应用程序，这个 bean 创建了一个会话到期的 Cookie：

**CookieBean**类

```
@ManagedBean
@ViewScoped
public class CookieBean implements Serializable {
    public void create() {
        ExternalContext ec = FacesContext.getCurrentInstance().getExternalContext();
        ec.addResponseCookie("MyTestCookie", "Hello Cookie", null);
    }    
} 
```

并且**index.xhtml**有这个主体：

```
<h:form>
    <h:commandButton value="Create Cookie!" action="#{cookieBean.create()}" >
        <f:ajax render="@form" />
    </h:commandButton>
    <p></p>
    <h:outputText value="Cookie value: #{cookie['MyTestCookie'].value}" /> 
</h:form> 
```

结果，当页面第一次加载时，没有 cookie，这是正确的，因为这是应用程序第一次运行，并且没有 cookie。

单击按钮一次后，不会显示任何 cookie。为什么？按钮调用该`cookieBean#create()`方法，并且 ajax 标记应该强制重新评估`outputText`组件。这应该生成一个`HttpSerlvetRequest`带有cookie的......或不？cookie 仅在我再次按下按钮后才会显示！

更令人惊讶的是，当我按下`refresh`浏览器的按钮时，cookie 没有显示，尽管我希望看到它，因为旧会话仍然存在。

就像（重新）加载页面不会向服务器发送 HttpServletRequest 一样......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T03:50:22.680

`#{cookie}`指的是当前**HTTP 请求**的 cookie 。如果你添加一个新的 cookie，那么它只会出现在 HTTP 响应中，但是与这个 HTTP 响应相关联的 HTTP 请求当然还没有 cookie。它仅存在于后续请求中，具体取决于 cookie 的年龄。

在呈现 HTTP 请求的 HTTP 响应期间，您基本上需要在之后发送重定向以使 cookie 可用。

至于刷新问题，请求很可能是在浏览器缓存中重新执行的。

# github - Git推送不起作用

> ID：11567285
> 
> 赞同：6
> 
> 时间：2012-07-19T18:42:20.510
> 
> 标签：github

我正在使用两个分支**test**和**main**。

所以，在**主**分支上，我做了：

```
git merge test 
```

一切都很顺利。所有更改都已合并。

然后将其推送到远程**主服务器**，我做了：

```
git push 
```

但它似乎什么也没做，它说：

```
Total 0 (delta 0), reused 0 (delta 0)
To git@github.com:Company/My-App.git
b878c9d..0dc7fbe  main -> main 
```

如果推送确实顺利进行，我认为它不应该在 Total 上面显示为零。

如何推送我的**主**分支？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T19:33:10.380

这只是意味着 git 不写任何对象。当所有对象都已经在远程并且合并时，您只需将标签“main”移动到最新提交，就会发生这种情况。我只是做了一个快速测试来证明：

```
 ~/workspace
    $ git clone git@github.com:korin/test_merge.git
    Cloning into 'test_merge'...
    remote: Counting objects: 3, done.
    remote: Total 3 (delta 0), reused 0 (delta 0)
    Receiving objects: 100% (3/3), done.

    ~/workspace
    $ cd test_merge
    ~/workspace/test_merge

    $ git co -b test
    Switched to a new branch 'test'

    ~/workspace/test_merge
    $ echo 'a' > a

    ~/workspace/test_merge
    $ git add .

    ~/workspace/test_merge
    $ git ci -m 'a'
    [test 9953350] a
     1 file changed, 1 insertion(+)
     create mode 100644 a

    ~/workspace/test_merge
    $ git push --set-upstream origin test
    Counting objects: 4, done.
    Delta compression using up to 4 threads.
    Compressing objects: 100% (2/2), done.
    Writing objects: 100% (3/3), 273 bytes, done.
    Total 3 (delta 0), reused 0 (delta 0)
    To git@github.com:korin/test_merge.git
     * [new branch]      test -> test
    Branch test set up to track remote branch test from origin.

    ~/workspace/test_merge
    $ g co master
    Switched to branch 'master'

    ~/workspace/test_merge
    $ g merge test
    Updating f5e0184..9953350
    Fast-forward
     a |    1 +
     1 file changed, 1 insertion(+)
     create mode 100644 a

    ~/workspace/test_merge
    $ g push
    Total 0 (delta 0), reused 0 (delta 0)
    To git@github.com:korin/test_merge.git
         f5e0184..9953350  master -> master 
```

# cuda - 启动 cuda（使用库或 API）

> ID：11567288
> 
> 赞同：0
> 
> 时间：2012-07-19T18:42:38.997
> 
> 标签：cuda

我想用 C++ 启动 CUDA，我熟悉 C++、Qt 和 C#。

但我想知道最好从 CUDA 库中使用 - 在高级 - 或 CUDA API - 在较低级别 - ？

我从 API 开始而不使用 CUDA 驱动程序会更好吗？（我从“ *cuda by example* ”开始并行了解它的概念）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:45:11.300

既然你熟悉C/C++，你最好使用更高级的API，CUDA C或C for CUDA，这样更方便易写，因为它包含了对C语言的最小扩展集和运行时库。

较低级别的 API，即 CUDA 驱动程序 API，通过公开较低级别的概念提供额外级别的控制，需要更多代码，更难编程和调试，但提供更好的控制级别，并且与语言无关，因为它处理二进制或汇编代码。

[有关详细信息，请参阅CUDA 编程指南](http://developer.download.nvidia.com/compute/DevZone/docs/html/C/doc/CUDA_C_Programming_Guide.pdf)的第 3 章。

# javascript - CryptoJS 和 Pycrypto 一起工作

> ID：11567290
> 
> 赞同：5
> 
> 时间：2012-07-19T18:42:58.860
> 
> 标签：javascript, python, encryption, pycrypto, cryptojs

我正在使用 CryptoJS (v 2.3) 在 Web 应用程序中加密一个字符串，我需要在服务器上用 Python 解密它，所以我使用的是 PyCrypto。我觉得我错过了一些东西，因为我不能让它工作。

这是JS：

```
Crypto.AES.encrypt('1234567890123456', '1234567890123456',
                   {mode: new Crypto.mode.CBC(Crypto.pad.ZeroPadding)})
// output: "wRbCMWcWbDTmgXKCjQ3Pd//aRasZ4mQr57DgTfIvRYE=" 
```

蟒蛇：

```
from Crypto.Cipher import AES
import base64
decryptor = AES.new('1234567890123456', AES.MODE_CBC)
decryptor.decrypt(base64.b64decode("wRbCMWcWbDTmgXKCjQ3Pd//aRasZ4mQr57DgTfIvRYE="))
# output: '\xd0\xc2\x1ew\xbb\xf1\xf2\x9a\xb9\xb6\xdc\x15l\xe7\xf3\xfa\xed\xe4\xf5j\x826\xde(m\xdf\xdc_\x9e\xd3\xb1' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-06-23T18:51:17.553

这是 CryptoJS 3.1.2 的版本。始终注意以下事项（在两种语言中使用相同）：

*   操作模式（在这种情况下为 CBC）
*   填充（在这种情况下为零填充；最好使用 PKCS#7 填充）
*   密钥（相同的推导函数或清除密钥）
*   编码（密钥、明文、密文等的编码相同）
*   IV（在加密期间生成，用于解密）

如果将字符串作为`key`参数传递给 CryptoJS`encrypt()`函数，则该字符串用于派生用于加密的实际密钥。如果您希望使用密钥（有效大小为 16、24 和 32 字节），则需要将其作为 WordArray 传递。

CryptoJS 加密的结果是一个 OpenSSL 格式的密文字符串。要从中获取实际的密文，您需要访问其`ciphertext`上的属性。

每次加密的 IV 必须是随机的，这样它在语义上是安全的。这样，攻击者只看密文就无法判断多次加密的相同明文是否实际上是相同的明文。

下面是我做的一个例子。

JavaScript：

```
var key = CryptoJS.enc.Utf8.parse('1234567890123456'); // TODO change to something with more entropy

function encrypt(msgString, key) {
    // msgString is expected to be Utf8 encoded
    var iv = CryptoJS.lib.WordArray.random(16);
    var encrypted = CryptoJS.AES.encrypt(msgString, key, {
        iv: iv
    });
    return iv.concat(encrypted.ciphertext).toString(CryptoJS.enc.Base64);
}

function decrypt(ciphertextStr, key) {
    var ciphertext = CryptoJS.enc.Base64.parse(ciphertextStr);

    // split IV and ciphertext
    var iv = ciphertext.clone();
    iv.sigBytes = 16;
    iv.clamp();
    ciphertext.words.splice(0, 4); // delete 4 words = 16 bytes
    ciphertext.sigBytes -= 16;

    // decryption
    var decrypted = CryptoJS.AES.decrypt({ciphertext: ciphertext}, key, {
        iv: iv
    });
    return decrypted.toString(CryptoJS.enc.Utf8);
} 
```

带有 pycrypto 的 Python 2 代码：

```
BLOCK_SIZE = 16
key = b"1234567890123456" # TODO change to something with more entropy

def pad(data):
    length = BLOCK_SIZE - (len(data) % BLOCK_SIZE)
    return data + chr(length)*length

def unpad(data):
    return data[:-ord(data[-1])]

def encrypt(message, key):
    IV = Random.new().read(BLOCK_SIZE)
    aes = AES.new(key, AES.MODE_CBC, IV)
    return base64.b64encode(IV + aes.encrypt(pad(message)))

def decrypt(encrypted, key):
    encrypted = base64.b64decode(encrypted)
    IV = encrypted[:BLOCK_SIZE]
    aes = AES.new(key, AES.MODE_CBC, IV)
    return unpad(aes.decrypt(encrypted[BLOCK_SIZE:])) 
```

**警告：**请记住，python2 和 pycrypto 都已过时，因此必须调整代码以适应 python3 和 pycryptodome。

* * *

**其他注意事项：**

您似乎想使用密码作为密钥。密码短语通常是人类可读的，但密钥不是。您可以使用 PBKDF2、bcrypt 或 scrypt 等功能从密码短语派生密钥。

上面的代码并不完全安全，因为它缺乏身份验证。未经身份验证的密文可能会导致可行的攻击和未被注意的数据操纵。通常采用 encrypt-then-MAC 方案和良好的 MAC 函数，例如 HMAC-SHA256。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2020-07-25T05:02:14.697

**注意： js 和 python 中的 salt , iv , padding 应该相同**

生成 salt 和 iv 值并将其转换为字节字符串 uisng CryptoJS.enc.Utf8.parse()

js文件

```
var encrypted = CryptoJS.AES.encrypt(JSON.stringify(json_data), CryptoJS.enc.Utf8.parse(data['salt']) , { iv: CryptoJS.enc.Utf8.parse(data['iv']) , mode: CryptoJS.mode.CBC , padding: CryptoJS.pad.Pkcs7});
en_data = encrypted.ciphertext.toString(CryptoJS.enc.Base64) 
```

**将此加密数据发送到 python 文件**

蟒蛇文件

```
from Crypto.Util.Padding import pad, unpad

ct = request.POST['encrypted_data']
data = base64.b64decode(ct)
cipher1 = AES.new(salt, AES.MODE_CBC, iv)
pt = unpad(cipher2.decrypt(data), 16)
data = json.loads(pt.decode('utf-8')) 
```

默认情况下，pycrypto 中的 pad 和 upad 使用 pkcs#7

**salt 和 iv 值应该是字节字符串**

# c++ - 将长字符流写入文本文件QT C++

> ID：11567295
> 
> 赞同：2
> 
> 时间：2012-07-19T18:43:22.913
> 
> 标签：c++, qt, text, serial-port

我正在尝试编写一个程序，该程序将创建一个文本文件并写入我从串行端口读取的字符流。我只是想了解如何让代码连续写入数据而不覆盖以前写入的数据，因为我需要它来保持发送的每个字符。我编写此代码作为测试，但我无法让它连续编写文本。它写一次然后停止。

```
#include <QFile>
#include <QTextStream>
int main() {
int test = 0;
while(test < 2){
QString filename = "Data.txt";
QFile file(filename);
if (file.open(QIODevice::ReadWrite)) {
    QTextStream stream(&file);
    stream << "one thing to test" << endl;
    test++;
  }
 }
} 
```

有人有什么建议吗？

-谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:48:41.183

默认情况下，打开时`QIODevice::ReadWrite`会在写入时截断文件。根据[文档](http://doc.qt.nokia.com/4.7-snapshot/qiodevice.html)，`QIODevice::Append`将在文件末尾打开文件进行写入。

如果你真的想读写，你可以**在**`QIODevice::seek()`写入之前到文件末尾。

# c# - C# 中的变量泛型返回类型

> ID：11567300
> 
> 赞同：21
> 
> 时间：2012-07-19T18:43:42.473
> 
> 标签：c#, generics

有没有办法让一个方法从一个方法返回多个泛型类型中的任何一个？例如，我有以下内容：

```
public static T ParseAttributeValue<T>(this XElement element, string attribute)
    {
        if(typeof(T) == typeof(Int32))
        {
            return Int32.Parse(element.Attribute(attribute).Value);
        }

        if(typeof(T) == typeof(Double))
        {
            return Double.Parse(element.Attribute(attribute).Value);
        }

        if(typeof(T) == typeof(String))
        {
            return element.Attribute(attribute).Value;
        }

        if(typeof(T) == typeof(ItemLookupType))
        {
            return Enum.Parse(typeof(T), element.Attribute(attribute).Value);
        }
    } 
```

（这只是一个非常快速的模型，我知道任何生产代码都需要在空检查等方面更加彻底......）

但是编译器不喜欢它，抱怨`Int32`不能隐式转换为`T`（它也不适用于强制转换）。我可以理解。在编译时它无法知道是什么`T`，但我会事先检查它。无论如何我可以完成这项工作吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-19T18:55:27.027

我过去做过这些类型的泛型方法。获得类型推断的最简单方法是提供通用转换器函数。

```
public static T ParseAttributeValue<T>
          (this XElement element, string attribute, Func<string, T> converter)
{
  string value = element.Attribute(attribute).Value;
  if (String.IsNullOrWhiteSpace(value)) {
    return default(T);
  }

  return converter(value);
} 
```

你可以像下面这样使用它：

```
int index = element.ParseAttributeValue("index", Convert.ToInt32);
double price = element.ParseAttributeValue("price", Convert.ToDouble); 
```

你甚至可以提供自己的函数并享受世界上所有的乐趣（甚至返回匿名类型）：

```
ItemLookupType lookupType = element.ParseAttributeValue("lookupType",
  value => Enum.Parse(typeof(ItemLookupType), value));

var item = element.ParseAttributeValue("items",
  value => {
    List<string> items = new List<string>();
    items.AddRange(value.Split(new [] { ',' }));
    return items;
  }); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-19T23:03:34.180

.Net 已经有一堆很棒的字符串转换例程可以使用！A`TypeConverter`可以为您完成大部分繁重的工作。然后您不必担心为内置类型提供自己的解析实现。

请注意，`TypeConverter`如果您需要处理以不同文化表达的解析值，则可以使用 API 的语言环境感知版本。

以下代码将使用默认区域性解析值：

```
using System.ComponentModel;

public static T ParseAttributeValue<T>(this XElement element, string attribute)
{
    var converter = TypeDescriptor.GetConverter(typeof(T));
    if (converter.CanConvertFrom(typeof(string)))
    {
        string value = element.Attribute(attribute).Value;
        return (T)converter.ConvertFromString(value);
    }

    return default(T);
} 
```

这适用于许多内置类型，您可以使用 a 装饰自定义类型，`TypeConverterAttribute`以允许它们也参与类型转换游戏。这意味着将来您将能够解析新类型，而无需更改`ParseAttributeValue`.

请参阅：http: [//msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-19T18:46:46.653

为什么你完全使用类型参数作为返回类型？这会起作用，只需要在调用后进行强制转换：

```
public static Object ParseAttributeValue<T>(this XElement element, string attribute)
{
    if(typeof(T) == typeof(Int32))
    {
        return Int32.Parse(element.Attribute(attribute).Value);
    }

    if(typeof(T) == typeof(Double))
    {
        return Double.Parse(element.Attribute(attribute).Value);
    }

    if(typeof(T) == typeof(String))
    {
        return element.Attribute(attribute).Value;
    }

    if(typeof(T) == typeof(ItemLookupType))
    {
        return Enum.Parse(typeof(T), element.Attribute(attribute).Value);
    }
} 
```

或者更好：

```
public static Int32 ParseAsInt32(this XElement element, string attribute)
{
    return Int32.Parse(element.Attribute(attribute).Value);
}

// etc, repeat for each type 
```

第二种方法还有一个额外的好处，即内联的可能性要高得多，而且它（对于像 Int32 这样的值类型）将避免对值进行装箱/拆箱的需要。这两者都会使该方法执行得更快一些。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-19T18:55:38.803

不确定这是否正是您想要的，但是如果您`object`先转换为然后转换为`T`

```
 public static T ParseAttributeValue<T>(this XElement element, string attribute)
    {
        if (typeof(T) == typeof(Int32))
        {
            return (T)(object)Int32.Parse(element.Attribute(attribute).Value);
        }

        if (typeof(T) == typeof(Double))
        {
            return (T)(object)Double.Parse(element.Attribute(attribute).Value);
        }

        if (typeof(T) == typeof(String))
        {
            return (T)(object)element.Attribute(attribute).Value;
        }

        return default(T);
    } 
```

但是，您仍然必须`T`在编译时提供，调用如下方法：

```
int value = element.ParseAttributeValue<int>("attribute"); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-19T18:55:57.043

这里有两种方法...

```
 static T ReadSetting<T>(string value)
    {
        object valueObj = null;
        if (typeof(T) == typeof(Int32))
            valueObj = Int32.Parse(value);
        return (T)valueObj;
    }
    static dynamic ReadSetting2<T>(string value)
    {
        if (typeof(T) == typeof(Int32))
            return Int32.Parse(value);
        throw new UnsupportedException("Type is unsupported");
    }
    static void Main(string[] args)
    {
        int val1 = ReadSetting<Int32>("2");
        int val2 = ReadSetting2<Int32>("3");
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-19T18:57:48.190

使用 C++ 模板，这种事情会起作用，但前提是每段代码都处于不同的、单独的专业化中。使这项工作起作用的原因是未编译未使用的函数模板（或更准确地说：未完全实例化），因此如果模板的副本用不同的类型实例化，则一段代码将无效的事实不会过来。

C# 是不同的，AFAIK 没有泛型的专门化。在 C# 的限制范围内完成您正在尝试做的事情的一种方法是创建一个具有更抽象返回类型的函数，并仅使用 ParseAttributeValue 将其强制转换为 T。

所以你会有：

```
private static Object AbstractParseValue(System.Type t, XElement element, string attribute) 
```

和

```
public static T ParseAttributeValue<T>(this XElement element, string attribute)
{
     return (T)AbstractParseValue(typeof(T), element, attribute);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-19T23:23:02.863

我建议不要在每次执行例程时都测试类型参数，而应该创建一个像这样的通用静态类：

```
内部静态类 ElementParser<T>
{
  public static Func<XElement, string, T> Convert = InitConvert;

  T DefaultConvert(XElement 元素，字符串属性)
  {
    返回默认值（T）；// 或者可能抛出异常，或者其他
  }

  T InitConvert(XElement 元素，字符串属性)
  {
    if (ElementParser<int>.Convert == ElementParser<int>.InitConvert)
    { // 任何类型的第一次
      转换 = 默认转换；// 可能会覆盖下面的这个赋值
      ElementParser<int>.Convert =
        （XElement 元素，字符串属性）=>
          Int32.Parse(element.Attribute(attribute).Value);
      ElementParser<double>.Convert =
        （XElement 元素，字符串属性）=>
          Int32.Parse(element.Attribute(attribute).Value);
      // 其他类型的等等
    }
    else // 我们做了其他类型，但不是这个类型，我们没有为它做任何好事
    {
      转换 = 默认转换；
    }
    返回转换（元素，属性）；      
  }
}
public static T ParseAttributeValue（这个 XElement 元素，字符串属性）
{
  ElementParser<T>.Convert(元素, 属性);
}

```

使用这种方法，只需在第一次使用特定类型时进行特殊处理。之后，可以仅使用单个通用委托调用来执行转换。一旦可以轻松添加任意数量的类型，甚至允许在运行时为任何所需类型注册转换器。

# java - Powermock Mockito：我试图存根的方法最终被调用

> ID：11567304
> 
> 赞同：2
> 
> 时间：2012-07-19T18:44:01.477
> 
> 标签：java, unit-testing, junit4, mockito, powermock

我正在尝试测试 a`class A`反过来自动装配 a `class B`：

```
public class A {

   @Autowired
   private B b;

   public int foo(int x, int y) {
       int z = b.bar(x, y, false);
       //do something with z
       return z;
   }
} 
```

我将 junit 与 and 一起使用`powermock`并`mockito`尝试`foo`在`class A`.

```
@RunWith(PowerMockRunner.class)
@PrepareForTest(A.class)
public class TestA {

     @Test
     private void testFoo() {
        B b = PowerMockito.mock(B.class);
        when(b.bar(2,3,false)).thenReturn(5);
        A a = PowerMockito.spy(new A());
        Whitebox.setInternalState(a, "b", b);

        int z = a.foo(2,3);
        Assert.assertEquals(10,z);
     }

} 
```

当我尝试运行测试时，我`NullPointerException`从内部得到一个`class B`. 使用调试器后，我发现在 stub 的`bar`方法之后`B class`，该`bar`方法被调用。这种情况下出现空指针异常是正常的，因为B类没有正确初始化。

谁能解释为什么会发生这种情况以及我能做些什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:03:19.230

我不是 PowerMockito 用户，但你不需要使用`@PrepareForTest(B.class)`吗？我认为注释适用于您正在模拟的类，它是最终的或具有静态的，而不是用于被测类。

另外，你为什么`spy()`在A上使用？也许您的示例代码没有公开它，但我看不到它的用途。此外，您真的需要`PowerMockito.spy()`A，还是仅仅使用 Mockito 的 spy() 就足够了（即，A 和 B 都是*最终*的和/或具有您需要访问/模拟/验证的静态数据）？

我能问一下你为什么使用 PowerMockito 而不仅仅是 Mockito 吗？如果只是在 A 内部设置私有 B `Whitebox`，则可以单独使用 Mockito 来做到这一点。您只需在测试方法之外将 A 和 B 声明为：

```
@InjectMocks A a = new A();
@Mock B b; 
```

它会将所有@Mock 模拟（即，`b`）注入A。

PowerMock 在模拟静态方法或最终类/方法的情况下最有用。

# c++ - 计算点向量的平均值

> ID：11567307
> 
> 赞同：10
> 
> 时间：2012-07-19T18:44:06.407
> 
> 标签：c++, opencv

我在 OpenCV 中有一个二维点的向量

```
std::vector<cv::Point2f> points; 
```

我想计算 x 和 y 坐标的平均值`points`。就像是：

```
cv::Point2f mean_point; //will contain mean values for x and y coordinates
mean_point = some_function(points); 
```

这在 Matlab 中很简单。但我不确定我是否可以利用一些高级 OpenCV 函数来完成同样的任务。有什么建议么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-19T18:58:36.817

`InputArray`在这里做得很好。你可以简单地打电话

```
cv::Mat mean_;
cv::reduce(points, mean_, 01, CV_REDUCE_AVG);
// convert from Mat to Point - there may be even a simpler conversion, 
// but I do not know about it.
cv::Point2f mean(mean_.at<float>(0,0), mean_.at<float>(0,1)); 
```

细节：

在较新的 OpenCV 版本中，`InputArray`引入了数据类型。这样，可以将矩阵 (cv::Mat) 或向量作为参数发送到 OpenCV 函数。A`vector<Vec3f>`将被解释为具有三个通道、一行且列数等于向量大小的浮点矩阵。因为没有数据被复制，所以这种透明转换非常快。

优点是您可以使用更适合您的应用程序的任何数据类型，同时您仍然可以使用 OpenCV 函数来简化对它的数学运算。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-19T18:53:36.290

由于 OpenCV`Point_`已经定义了`operator+`，这应该相当简单。首先我们对这些值求和：

```
cv::Point2f zero(0.0f, 0.0f);

cv::Point2f sum  = std::accumulate(points.begin(), points.end(), zero); 
```

然后我们除以得到平均值：

```
Point2f mean_point(sum.x / points.size(), sum.y / points.size()); 
```

...或者我们可以使用`Point_`'s `operator*`：

```
Point2f mean_point(sum * (1.0f / points.size())); 
```

不幸的是，至少据我所知，`Point_`没有定义`operator /`，所以我们需要乘以倒数而不是除以大小。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-19T18:57:24.040

您可以使用 stl 的[std::accumulate](http://www.sgi.com/tech/stl/accumulate.html)如下：

```
cv::Point2f sum = std::accumulate(
    points.begin(), points.end(), // Run from begin to end
    cv::Point2f(0.0f,0.0f),       // Initialize with a zero point
    std::plus<cv::Point2f>()      // Use addition for each point (default)
);
cv::Point2f mean = sum / points.size(); // Divide by count to get mean 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T18:51:46.483

将它们全部加起来并除以总点数。

# c# - 在设计公共 API 时，我们应该避免将 IEnumerable 作为输入吗？

> ID：11567308
> 
> 赞同：3
> 
> 时间：2012-07-19T18:44:14.130
> 
> 标签：c#, api, ienumerable, lazy-evaluation

考虑以下示例。

假设我开发了一个第三方将使用的库。该库有一个接受的方法`IEnumerable`，这很好，因为它从传递的集合的实现中抽象出来。但是，当我检索输入参数时会发生惰性求值。

```
public interface IStorage<in T>
{
  void Store(IEnumerable<T> values);
}

public class FileStorage<T> : IStorage<T>
{
  public void Store(IEnumerable<T> values)
  {
    foreach (var value in values) { /*Evaluation of IEnumerable*/}
  }
} 
```

一些客户通过以下方式使用我的库：

```
 IEnumerable<int> values;
  try
  {
    values = new[] { "1", "2", "three" }.Select(int.Parse);
  }
  catch (Exception)
  {
    values = Enumerable.Empty<int>();
  }

  var storage = new FileStorage<int>();
  storage.Store(values); 
```

`Store`这将导致发生评估的方法内部出现异常。如果我设计了`Store`要采取的方法，`List<T>`我会确定它是 Ts 的安全可枚举集合。问题是我们在设计 API 时是否应该避免`IEnumerable`，或者我们是否应该在需要时允许并在安全上下文中枚举它，因为它可能会引发异常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:15:42.010

根据 Krzysztoc Cwalina 和 Brad Adams 的**框架设计指南**一书。

[http://blogs.msdn.com/b/kcwalina/archive/2008/01/03/frameworkdesignguidelines2ndedition.aspx](http://blogs.msdn.com/b/kcwalina/archive/2008/01/03/frameworkdesignguidelines2ndedition.aspx)

建议您这样做...

摘自第 252 页 (8.3.1)

> **集合参数**
> 
> 务必使用最不专业的类型作为参数类型。大多数将集合作为参数的成员使用 IEnumerable 接口

```
 public void PrintNames(IEnumerable<string> names) {
      foreach(string name in names) {
          Console.WriteLine(name);
      } } 
```

> 避免使用 ICollection 或 ICollection 作为参数来访问 Count 属性。
> 
> 而是考虑 IEnumerable 或 IEnumerable 并动态检查对象是否实现 ICollection 或 ICollection

顺便说一句，这是一本很棒的书，值得一读，目前真的很喜欢。PS 写这篇文章的人帮助编写了 .NET 框架

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:51:20.503

就我个人而言，我认为从您的方法内部引发的异常没有问题。
这*是*一个错误，您的 API 的用户应该知道它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T18:54:26.100

您的客户的代码有问题的事实不是您的问题。如果他们希望他们的程序正常工作，请告诉他们停止编写错误代码。您无法保护他们免受这些查询被延迟评估并且他们显然不知道这一点的事实。

您的客户有责任处理枚举集合时发生的事情，*如果*他们向您传递了一个惰性求值的集合，那么*他们*有责任确保这种惰性求值不会抛出（如果这些是您定义的参数） . 打破这个不变量是*他们的*问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T18:53:19.930

是的，将最抽象的接口作为库中的参数是一种很好的做法。您以这种方式定义这些项目的合同。

如果只需要能够枚举一个集合，IEnumerable 是一个非常不错的选择。

如果您希望能够添加、索引等项目，IList 是正确的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T18:59:31.420

附带说明一下，这里的问题不在于您的 API 采用 IEnumerable。实际问题出在 .Select 调用上。延迟评估是 LINQ 的一项功能，而不是 IEnumerable 接口的一项功能。

所以是的，您应该将 IEnumerable 作为参数。资源的加载和管理完全在客户端的控制之下，而不是你的。仅仅因为客户端可能会传入一些可能导致延迟报告异常的 IEnumerable 实现，这并不足以成为牺牲 API 的可维护性和灵活性的充分理由。

# mysql - 如何停止除一个以外的任何应用程序用户的mysql表选择查询？

> ID：11567309
> 
> 赞同：1
> 
> 时间：2012-07-19T18:44:19.670
> 
> 标签：mysql, transactions, cakephp-1.2

我知道我的问题与事务或表锁有关，但我无法管理它。我的 PHP 应用程序必须从表中选择一些值，然后它必须遍历结果以更新同一结果中的一些值。我希望应用程序在有选择查询运行时停止任何用户选择，直到循环完成。

我使用锁表写入，但它阻止了应用程序进行更新。我的应用程序是基于 CakePHP 1.2.11 构建的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:34:15.387

我认为出了点问题，因为您的脚本应该能够在为用户写入锁定时更新表上的数据，检查这个 URL，我希望它会有所帮助。 [何时以及如何锁定表](http://www.brainbell.com/tutors/php/php_mysql/When_and_how_to_lock_tables.html)

# ruby-on-rails - 活动管理员导航链接

> ID：11567312
> 
> 赞同：4
> 
> 时间：2012-07-19T18:44:48.517
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, rubygems

除了注册页面/模型之外，您如何将自己的自定义链接动态添加到 ActiveAdmin 全局导航标题？例如，如果我想要一个可以将用户引导到我的主页的链接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-15T14:05:40.777

似乎 ActiveAdmin 让它变得更容易了。我升级到 0.6.2 版，您可以在导航的任何位置添加自定义链接（下面的示例将添加一个自定义菜单项和一个自定义下拉菜单）：

在 # config/initializers/active_admin.rb

```
ActiveAdmin.setup do |config|
  config.namespace :admin do |admin|
    admin.build_menu do |menu|
      menu.add :label => "My Custom Link", :url => "/", :priority => 0

      menu.add :label => "Pages" do |pages|
        pages.add :label => "Homepage", :url => "/admin/homepage"
        pages.add :label => "About Us", :url => "/admin/about-us"
        pages.add :label => "Facebook", :url => "http://www.facebook.com", :html_options => { :target => "_blank" }
      end
    end
  end
end 
```

如果您已经注册了带有“页面”作为父菜单的模型（即：在您的 app/admin/ 文件夹中，带有 的模型`menu :priority => 2, parent: 'Pages'`），它也会自动保留这些模型！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T21:07:42.190

通过将 ActiveAdmin::MenuItem 添加到当前的 AdminAdmin 控制器，我设法做到了这一点。例如，

```
ActiveAdmin.register User, :name_space => :example_namespace do
  controller do
    private
    def current_menu
      item = ActiveAdmin::MenuItem.new :label => "Link Name", :url => 'http://google.com'
      ActiveAdmin.application.namespaces[:example_namespace].menu.add(item)
      ActiveAdmin.application.namespaces[:example_namespace].menu
    end
  end
end 
```

我基本上创建了一个新的**ActiveAdmin::MenuItem**并将其添加到具有命名空间**example_namespace的当前 ActiveAdmin 菜单中，并在****current_menu**方法的末尾返回菜单。注意：**current_menu**是**ActiveAdmin**期望的方法，所以不要更改它的名称。您可以添加任意数量的项目，这些项目中的每一个都将转换为导航标题上的链接。请注意，这适用于 ActiveAdmin 版本 > 0.4.3，因此如果您想为版本 <= 0.4.3 执行此操作，您可能需要自己进行挖掘。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-25T15:23:55.003

```
ActiveAdmin.register AdminPage do
  menu :url => proc{ "#{AppConfig.url}/checkins/#{current_admin_user.try(:id)}" }
end 
```

在这里，您可以使用 URL 参数中的任何 db 字段值来构造您自己的 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T09:57:47.163

您可以在活动管理员初始化程序中配置站点标题。例如：

```
 config.site_title_link = "/" 
```

这将为您提供指向您的根页面的链接。

# jquery - 通过内联编辑在 Struts2 jQuery Grid 中编辑多行

> ID：11567316
> 
> 赞同：0
> 
> 时间：2012-07-19T18:45:10.553
> 
> 标签：jquery, jqgrid, struts2, grid, inline-editing

```
 The struts2-jQuery grid offers a wide variety of edit features. But for one of our requirements, the Out-of-the-Box 'Edit' feature in this grid is not suitable. we want to customize it as follows.. 
```

**我们的要求是**：

1.  用户应该能够一次编辑多于 1 行 - 根据默认的开箱即用实现，在每次编辑行之后，用户必须执行保存操作（通过按 Enter 或单击 Save 按钮）才能继续编辑下一行
2.  使用 TAB 在行之间移动以进行编辑
3.  “批量/批量保存”操作可以将所有已编辑的行数据发送到我的操作，然后我们可以从那里进行批量保存数据库操作

    **我们的做法**：

**自定义 1**：在所有行的第一列上添加“编辑/取消”按钮（每行没有保存按钮）。单击编辑后，特定行变为可编辑
**自定义 4**：在网格工具栏中添加一个新的“批量保存”图像按钮
**自定义 5**：单击“批量保存”时，收集所有已编辑的行数据（以及 id）和在 Action 中将其作为数组接收以执行“批量更新”数据库操作

```
We got our inspiration from the 'Custom Edit' posted @ www.trirand.com/blog/jqgrid/jqgrid.html 
```

** 是否有人遇到过类似的要求或对 Struts2-jQuery Grid 进行过类似的自定义？**

```
I am surprised that the grid does not offer this 'Multi Row Edit' by default. 
```

**

> 更新1：

**

在网格上实现自定义“批量/批量保存”功能的过程中，我们遇到了一些问题..想与大家分享..在我们努力修复它们的同时..感谢有人可以提出指点在他们..

1.  我们希望通过自定义的“全部保存”网格工具栏按钮保存数据后刷新网格。单击此按钮后，我们将向将执行保存所有修改数据的操作发出 Ajax 发布请求。

2.  编辑后导航离开时（不保存），显示警报以保存修改后的数据

3.  当用户在编辑列时点击“Enter”时，防止页面发布到 Action 类

4.  添加自定义复选框并将这些值用于自定义删除操作（因为通过多选选项生成的复选框会导致多重编辑出现问题）

5.  在 S2J Grid 中编辑规则功能以调用自定义 javascript 验证

**

> 更新 2：

**

我们无法识别以下答案之一中提到的 bindKeys，同时这是我们的方法。这个实现还有很多开放的目标，我们仍在努力解决。

第 1 步：在网格中使用以下内容为每行数据创建自定义的“编辑”和“取消”按钮 `onGridCompleteTopics="createbuttons"`，这里的 createbuttons 是我们自定义编写的 jScript 函数。

```
 $.subscribe('createbuttons',function(event,data)
             {

                    var ids = jQuery("#gridtable").jqGrid('getDataIDs');
                for(var i=0;i < ids.length;i++)
                {
                    var cc = ids[i];
                    var rowData = jQuery('#gridtable').jqGrid('getCell',cc,'name');

                    edit = "<input  type='image' class='ui-icon ui-icon-pencil' onblur='check()'  style='display:inline;'  onclick=\"javascript:editCurrentRow('"+cc +"');\" />";
                    cncl = "<input  type='image' class='ui-icon ui-icon-cancel' style='display:inline;'    onclick=\"javascript:removeCurrentRow('"+ cc +"');\" />";

                    jQuery("#gridtable").jqGrid('setRowData',ids[i],{Buttons:edit+cncl});

                }

                }); 
```

第 2 步：在网格中添加一个自定义按钮，这将是一个自定义编写的 javascript 函数，它将收集所有已编辑行的数据并将 Ajax 发布到我们的 Struts2 Action 类。从那里我们创建这个输入的数组以将其传递给 Oracle 过程并在过程中执行 DB 操作（插入/更新）（使用 FORALL INSERT/UPDATE）

```
navigatorExtraButtons="{                                
                                saveall:{
                                      title:'Save Alls',                                      
                                      onclick:function(){call_function_save()}
                                      }
                                  }" 
```

第 3 步：我们将以下代码添加到所有文本框单元格中，以防止在按 Enter 时发布页面

```
<sjg:gridColumn name="name" index="name" 
            title="Name" formatter="String" editable="true" editoptions="{ dataEvents: [
        { 
            type: 'keydown', 
            fn: function(e) { 
                var key = e.charCode || e.keyCode;
                if (key == 13)//enter
                {
                    return false;
                }
            }
        } 
    ]}"
           edittype="text" /> 
```

我会让每个人都了解我们的进展，但是我们现在面临一个新的挑战，为此我在[这里](https://stackoverflow.com/questions/11642242/how-to-increase-jqgrid-toolbar-navbar-icon-size-for-visual-accessibility) 和[这里发布了另一个问题](https://stackoverflow.com/questions/11642741/prevent-row-becoming-editable-during-double-click-jqgrid)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T06:02:22.153

嗨朋友们，我使用内联编辑得到了上述问题的解决方案。批量保存：

可以使用 java 脚本进行批量保存。使用 java 脚本，我们读取所有网格值，然后通过网络将其发送到我们的动作类

谢谢，

如果对编码有任何帮助，我将发送给您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T07:20:52.157

我认为您需要查看[此处](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3ainline_editing)`inline`的编辑并实施您可以在[此处](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3amethods)找到的内容。如果您在实施它时遇到问题，请告诉我。`bindKeys`

```
bindKeys

Parameters:

{ 
  onEnter: null, 
  onSpace: null, 
  onLeftKey: null, onRightKey: null, 
  scrollingRows : true 
} 
```

# sql - 将条件放在内部联接的 ON 子句与主查询的 where 子句之间是否存在逻辑差异？

> ID：11567318
> 
> 赞同：4
> 
> 时间：2012-07-19T18:45:12.880
> 
> 标签：sql, join

考虑这两个相似的 SQL

（ON 子句中的条件）

```
select t1.field1, t2.field1
from
table1 t1 inner join table2 t2 on t1.id = t2.id and t1.boolfield = 1 
```

（WHERE 子句中的条件）

```
select t1.field1, t2.field1
from
table1 t1 inner join table2 t2 on t1.id = t2.id
where t1.boolfield = 1 
```

我已经对此进行了一些测试，并且可以看到将条件放在两个不同位置以进行外部连接之间的区别。但是在内部连接的情况下，结果集会有所不同吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T18:59:43.557

对于 INNER JOIN，没有有效的区别，尽管我认为第二个选项更干净。

对于 LEFT JOIN，有很大的不同。ON 子句指定将从表中选择哪些记录进行比较，而 WHERE 子句过滤结果。

示例 1：返回 tbl 1 中的所有行并将它们与 tbl2 中具有 boolfield=1 的适当行匹配

```
Select *
From tbl1
  LEFT JOIN tbl2 on tbl1.id=tbl2.id and tbl2.boolfield=1 
```

示例 2：将仅包括 tbl1 中与 tbl2 中具有 boolfield=1 的匹配行的行。它连接表，然后过滤掉不满足条件的行。

```
Select *
From tbl1
  LEFT JOIN tbl2 on tbl1.id=tbl2.id
WHERE tbl2.boolfield=1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T18:53:14.003

在您的特定情况下， t1.boolfield 指定了一个附加选择条件，而不是两个表之间匹配记录的条件，因此第二个示例更正确。

如果您正在谈论将匹配记录的条件放在 ON 子句中而不是 WHERE 子句中的情况，[请参阅此问题](https://stackoverflow.com/questions/1018822/inner-join-on-vs-where-clause?rq=1)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T18:59:41.380

两个版本都返回相同的数据。

虽然这对于内部联接是正确的，但对于外部联接却不是这样。

从风格上讲，还有第三种可能性。除了你的两个，还有：

```
select t1.field1, t2.field1
from (select t1.*
      from table1 t1
      where t1.boolfield = 1
     ) t1 inner join
     table2 t2
    on t1.id = t2.id 
```

哪个更可取取决于您要突出显示的内容，以便您（或其他人）稍后可以理解和修改查询。我通常更喜欢第三个版本，因为它强调查询只使用表中的某些行——布尔条件非常接近指定表的位置。

在另外两种情况下，如果您的查询很长，那么要弄清楚“t1”的真正含义可能会有问题。我认为这就是为什么有些人更喜欢将条件放在 ON 子句中的原因。其他人更喜欢 WHERE 子句。

# java - Eclipse JFrame 警告

> ID：11567322
> 
> 赞同：0
> 
> 时间：2012-07-19T18:45:25.687
> 
> 标签：java, eclipse

我经常使用 JFrame，因为它们是应用程序，它们显然需要一个

```
public static void main(String[] args) 
```

方法。他们还需要 main() 中的行

```
myJFrame g = new myJFrame(); 
```

在 Eclipse 中，我收到关于变量 g 的警告：“从不读取局部变量 g”，但如果我省略该行，程序将无法运行。为什么我需要那条线，如果 g 是必不可少的，为什么上面会有警告？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T18:54:32.347

回答您的问题 - 可能您调用所有必要的方法（如`setVisible(true)`等）在`myJFrame`构造函数中运行应用程序。如果是这样 - 你不需要`g`局部变量 - 你以后永远不会使用它（查看警告）。

第一件事`main`- 是所有 Java 应用程序的起点。第二件事，如果您在`JFrame`构造函数中做所有事情，那么您只需要行

```
new myJFrame(); //in Java it's convention to use first letter 
                //upper-case class names -> MyJFrame 
```

下面是在应用程序中运行第一个窗口的简单标准方法。

```
public final class App {
    public static void main(final String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                MainWindow frame = new MainWindow();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setVisible(true);
            }
        });
    }
} 
```

在`MainWindow`课堂上，您只创建 Swing 组件等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:55:08.057

警告意味着您声明了一个局部变量/指针（在这种情况下称为 g ），但从未在代码中的任何地方实际使用它。有了警告，程序应该可以正常运行，但是你有一个额外的“指针”指向你从未使用过的 JFrame。

如果你想从你调用的方法访问你的 JFrame，`myJFrame g = new myJFrame();`你应该保持这种方式。否则`new myJFrame();`就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T18:54:38.227

如果您不打算引用此对象，则初始化此对象就足够了。

```
new myJFrame(); 
```

# silverlight - 将命令注入 ViewModel

> ID：11567323
> 
> 赞同：2
> 
> 时间：2012-07-19T18:45:27.763
> 
> 标签：silverlight, mvvm, dependency-injection, unity-container

我试图弄清楚将一个`ICommand`注入我的 ViewModel 的正确方法是什么。

鉴于我的 ViewModel 看起来像这样。

```
public class ViewModel : IViewModel
{
    ICommand LoadCommand { get; }
    ICommand SaveCommand { get; }
} 
```

我目前在我的构造函数中这样做

```
public ViewModel(IRepository repository, IErrorLog errorLog, IValidator validator)
{
    LoadCommand = new LoadCommandImpl(repository, errorLog);
    SaveCommand = new SaveCommandImpl(repository, errorLog, validator);
} 
```

请注意，除了构建命令之外，ViewModel 根本不使用这些参数。

虽然我尝试在注入的接口中包含尽可能多的逻辑，但命令中仍然存在逻辑。

这样做似乎更合适

```
public ViewModel(ICommand loadCommand, ICommand saveCommand)
{
    LoadCommand = loadCommand;
    SaveCommand = saveCommand;

    LoadCommand.SetViewModel(this);
    SaveCommand.SetViewModel(this);
} 
```

但是要做到这一点，我需要像这样进行 Unity 注册。这不是世界末日，但似乎很痛苦。

```
container.RegisterType<ICommand, LoadCommandImpl>("loadCommand");
container.RegisterType<ICommand, SaveCommandImpl>("saveCommand");

container.RegisterType<IViewModel, ViewModel>(
    new InjectionConstructor(
        new ResolvedParameter<ICommand>("loadCommand"),
        new ResolvedParameter<ICommand>("SaveCommand"))); 
```

或者，我可以制作`ILoadCommand`和`ISaveCommand`接口，但这些接口将是空的或可能实现`ICommand`.

我不是任何这些解决方案的忠实粉丝。这里推荐的方法是什么？

**编辑以回应盲人**

让我们暂时假设这不是命令。

```
public ViewModel(IFoo foo)
{
    Bar = new Bar(foo);
} 
```

在我看来，只注入 IBar 会更合适

```
public ViewModel(IBar bar)
{
    Bar = bar;
} 
```

但现在我有`Bar1`和`Bar2`。所以我可以做

```
public ViewModel(IFoo foo)
{
    Bar1 = new Bar1(foo);
    Bar2 = new Bar2(foo);
} 
```

或者

```
public ViewModel(IBar bar1, IBar bar2)
{
    Bar1 = bar1;
    Bar2 = bar2;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T06:56:08.307

此行为不包含在 Unity 中，但不难改装。

```
var container = new UnityContainer();
container.AddNewExtension<MapParameterNamesToRegistrationNamesExtension>();
container.RegisterType<ICommand, LoadCommand>("loadCommand");
container.RegisterType<ICommand, SaveCommand>("saveCommand");
container.RegisterType<ViewModel>(new MapParameterNameToRegistrationName());
var vm = container.Resolve<ViewModel>();
Assert.IsType(typeof(LoadCommand), vm.LoadCommand);
Assert.IsType(typeof(SaveCommand), vm.SaveCommand);

public class MapParameterNamesToRegistrationNamesExtension : UnityContainerExtension
{
  protected override void Initialize()
  {
    var strategy = new MapParameterNamesToRegistrationNamesStrategy();
    this.Context.Strategies.Add(strategy, UnityBuildStage.PreCreation);
  }
}
public class MapParameterNamesToRegistrationNamesStrategy : BuilderStrategy
{
  public override void PreBuildUp(IBuilderContext context)
  {
    if (context.Policies.Get<IMapParameterNameToRegistrationNamePolicy>(context.BuildKey) == null)
    {
      return;
    }
    IPolicyList resolverPolicyDestination;
    IConstructorSelectorPolicy selector = context.Policies.Get<IConstructorSelectorPolicy>(context.BuildKey, out resolverPolicyDestination);
    var selectedConstructor = selector.SelectConstructor(context, resolverPolicyDestination);
    if (selectedConstructor == null)
    {
      return;
    }
    var parameters = selectedConstructor.Constructor.GetParameters();
    var parameterKeys = selectedConstructor.GetParameterKeys();
    for (int i = 0; i < parameters.Length; i++)
    {
      Type parameterType = parameters[i].ParameterType;
      if (parameterType.IsAbstract || parameterType.IsInterface)
      {
        IDependencyResolverPolicy resolverPolicy = new NamedTypeDependencyResolverPolicy(parameterType, parameters[i].Name);
        context.Policies.Set<IDependencyResolverPolicy>(resolverPolicy, parameterKeys[i]);
      }
    }
    resolverPolicyDestination.Set<IConstructorSelectorPolicy>(new SelectedConstructorCache(selectedConstructor), context.BuildKey);
  }
}
public class MapParameterNameToRegistrationName : InjectionMember
{
  public override void AddPolicies(Type serviceType, Type implementationType, string name, IPolicyList policies)
  {
    policies.Set<IMapParameterNameToRegistrationNamePolicy>(new MapParameterNameToRegistrationNamePolicy(), new NamedTypeBuildKey(implementationType, name));
  }
}
public interface IMapParameterNameToRegistrationNamePolicy : IBuilderPolicy
{
}
public class MapParameterNameToRegistrationNamePolicy : IMapParameterNameToRegistrationNamePolicy
{
} 
```

代码和测试可以[在 CodePlex 上的 TecX 项目](http://tecx.codeplex.com)的源代码中找到。项目*TecX.Unity*（文件夹*注入*）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T08:53:39.653

你为什么不创建一个命令工厂

```
 public class CommandFactory (IUnityContainer container) : ICommandFactory
{
    public ICommand CreateSaveCommand()
    {
       return container.Resolve("SaveCommand");
    }
    public ICommand CreateLoadCommand()
     {
        return container.Resolve("LoadCommand");
    }
}

public ViewModel(ICommandFactory commandFactory)     
{         
    LoadCommand = commandFactory.CreateLoadCommand();         
    SaveCommand = commandFactory.CreateSaveCommand();         
} 
```

# c - 在 C 程序中重新初始化库变量

> ID：11567324
> 
> 赞同：2
> 
> 时间：2012-07-19T18:45:29.013
> 
> 标签：c, linux, service, shared-libraries

我正在尝试编写一个程序，我必须通过（共享）库调用一些函数（其源代码可用）。库的 C 代码有几个全局变量，许多函数会更改这些全局变量的值。我在我的程序中必须做的事情要求我所做的每个函数调用都可以使用一组新的变量。

例如，让这个函数成为库的一部分：

```
int x = 1;

int foo()  
{  
    int a = 0;
    //do somethings to 'a'
    //...
    x++;
    return a;
} 
```

现在，每次我`foo()`从我的程序中调用时，值`x`都会从 1 更新到 2，然后是 3，然后是 4，依此类推……我尝试构建一个程序，以便每次`foo()`调用时，它都会看到 x = 1。

很抱歉，我对 C/linux 如何处理这些变量空间的知识还不够，所以这个问题可能看起来很模糊。以上只是一个小例子；实际上，有很多变量几乎不可能手动重置它们的值。

编译该库和/或在我的程序中使用它以刷新变量的最佳方法可能是什么？

（附带说明一下，我还想做的是并行化对 foo() 的调用，但由于共享变量，我不能这样做。）

编辑：在处理一些 Web 开发项目时，我曾经将一些代码封装在 Web 服务中，然后从主程序中调用这些服务。C/Linux 中是否存在类似的框架？请注意，函数正在返回数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T18:50:22.787

*您已经发现全局变量（或一般的全局状态）是一个非常糟糕的主意*的主要原因之一。

由于您可以访问源代码，因此我建议您花一些时间来重构源代码。

您可以使用以下策略实现并行调用*foo的能力：*

*   将所有全局变量收集到一个*struct*中。*称它为Context*之类的东西。
*   更改作用于全局变量的每个函数以获取指向*Context*的指针，并更改函数以更新*Context*中的变量而不是更新全局变量。
*   现在每个想要使用该库的线程都可以创建一个新的*Context*并将其传递给*foo*和相关函数。

[如果对源代码进行这样的更改不可行，您可以通过启动子进程](http://www.yolinux.com/TUTORIALS/ForkExecProcesses.html)来使用多个 CPU 内核。每个子进程都有自己的内存空间。该选项不如使用多线程有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:16:41.550

我没有详细的答案。但您可以尝试以下方法之一：

1.  卸载和加载库
2.  尝试清除库的 .bss 并用库中的值填充 .data 部分（参考 dl_iterate_phdr() 调用）。

# ruby-on-rails - Rails i18n 找不到我的自定义错误消息

> ID：11567325
> 
> 赞同：0
> 
> 时间：2012-07-19T18:45:31.620
> 
> 标签：ruby-on-rails, internationalization

我的语言环境有什么问题：

我越来越：

```
Hotel translation missing: pt-BR.activemodel.errors.models.hotel_selector.attributes.id.must_be_filled 
```

而我的 yml 是这样的：

```
pt-BR:
  activemodel:
    attributes:
      csv_invite:
        file_path: Arquivo
        group_id: Grupo
      hotel_selector:
        id: Hotel
    errors:
      models:
        hotel_selector:
          id:
            must_be_filled: deve ser preenchido 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:46:30.277

我忘记了`attributes`钥匙。傻我。

# networking - 更好地理解 sockt - 可以使用相同的原始套接字从不同的接口发送数据吗？

> ID：11567328
> 
> 赞同：0
> 
> 时间：2012-07-19T18:45:44.017
> 
> 标签：networking, network-programming

我阅读了[原始套接字教程](http://www.tenouk.com/Module43a.html) 以实现我自己的桥接（我从一侧捕获包并通过原始套接字将它们发送到另一个接口）。我来自Java世界，所以低级编程对我来说很陌生，所以请原谅我的无知。

我实现了一个网桥，所以我需要将流量从 A 发送到接口 B，反之亦然。我创建了一个原始套接字，并使用它通过 2 个不同的接口向两台服务器发送数据。为什么不使用同一个套接字从接口 A 或 B 发送数据？我问这是一个好习惯吗？问题等

如果您能在下划线中向我说明套接字是如何不绑定到物理接口的，那就太好了。这就是我觉得同一个原始套接字用于为不同接口发送数据的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T06:56:52.923

对两个不同的接口使用相同的原始套接字是没有问题的。调用发送时，在具体接口中的使用就完成了。

# html - 字体在相同的系统、相同的浏览器、不同的分辨率上看起来不同

> ID：11567329
> 
> 赞同：2
> 
> 时间：2012-07-19T18:45:45.223
> 
> 标签：html, css, fonts

我的电脑装有 Windows 7 和 Firefox 14，笔记本电脑上有相同的系统和浏览器，字体看起来完全不同我不知道为什么，分辨率可能与它有关吗？

我的 PC 上的分辨率是 1920x1080，而我的笔记本电脑上的分辨率是 1280x720，页面是固定宽度并且可以正确缩放。在页面文本的某些部分，笔记本电脑上的字母之间的距离似乎有所不同。

我在整个站点上使用标准字体系列：`Century Gothic, sans-serif;`在我的 PC 上没问题，但在我的笔记本电脑上看起来更像 Arial。

我怀疑解决方案，但也许我错了，还有其他可能导致这种行为的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:53:57.387

您需要将其括在引号中。`font-family: "Century Gothic", sans-serif;`. 很可能一台机器正在渲染默认`sans-serif`字体。

也可能是您的笔记本电脑上未安装 Century Gothic。

# jquery - $('#id').toggle() 正在将 style="display:none" 更改为 style="" 而不是所需的 style="display:inline"

> ID：11567331
> 
> 赞同：0
> 
> 时间：2012-07-19T18:45:49.917
> 
> 标签：jquery, css

我有：

```
<a id = "button" style="display:inline"></a>
<a id = "buttonPressed" style="display:none"></a> 
```

我正在使用

```
$('#button, #buttonPressed').click(function(event) {
    $('#button, #buttonPressed').toggle();
    //Do other stuff
}) 
```

“display:inline”按钮会根据需要更改为“display:none”，但“display:none”按钮会更改为 style=""，而不是所需的“display:inline”。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:48:19.920

为这些标签添加一个类。创建一个在规则中强制内联显示的 css 规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:49:47.717

这在[jsfiddle中工作正常](http://jsfiddle.net/dmase05/DjHNb/)

因此，您的页面上可能还有其他一些冲突的代码？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T18:50:58.233

你可以试试`toggleClass()`：

```
.hidden {
   display: none
} 
```

```
<a id="button">click1</a>
<a id="buttonPressed" class="hidden">click2</a> 
```

```
$('#button, #buttonPressed').click(function(event) {
    $('#button, #buttonPressed').toggleClass('hidden');
}) 
```

[演示](http://jsfiddle.net/bR2aG/)

# c# - 使用 List 动态填充 asp.net Gridview

> ID：11567332
> 
> 赞同：2
> 
> 时间：2012-07-19T18:45:59.837
> 
> 标签：c#, asp.net, gridview

我有一个以列表格式返回的员工记录列表。如何动态填充网格视图？

```
ePremiumSubscriber.Subscriber PremSubData = new ePremiumSubscriber.Subscriber();
List<ePremiumSubscriber.Subscriber> premSubList = new List<ePremiumSubscriber.Subscriber>();

ePremiumCustomerDAL.SearchPremSubscriberData(premSubList, sqlQuery);  

DataTable dtSearchResults = new DataTable();
dtSearchResults.Columns.Add("psLastName", System.Type.GetType("System.String"));
dtSearchResults.Columns.Add("psFirstName", System.Type.GetType("System.String")); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T18:51:16.643

在 asp.net 页面中放置一个 GridView 控件，然后您可以按照他的方式进行操作

```
GridView1.DataSource = dtSearchResults ;

GridView1.DataBind(); 
```

# jquery - 如何在一个元素上使用 errorPlacement

> ID：11567336
> 
> 赞同：0
> 
> 时间：2012-07-19T18:46:17.060
> 
> 标签：jquery, forms, validation, jquery-validate

我正在为表单使用 jQuery Validation 插件。当表单未经过验证时，我会收到正确的错误消息，我只想将它放在另一个位置。

现在错误标签显示在第一个复选框标签下（检查 1）。我想出现在#messageBox div 中。

这是我认为可行的....但它没有:(

**html:**

```
<div class="form_row">
<div class="buttonColumn">
<label><input type="checkbox" name="program[]" class="isChecked error">Check 1</label>
<label><input type="checkbox" name="program[]" class="isChecked error">Check 2</label>
<label><input type="checkbox" name="program[]" class="isChecked error">Check 3</label>
<label><input type="checkbox" name="program[]" class="isChecked error">Check 4</label>
</div>
<div id="messageBox"></div> 
```

**jQuery：**

```
$('#custom_form').validate({
    rules: {
        "program[]": {
            required: true,
            minlength: 1,
        },
        errorPlacement: function(error, element) {
            if (element.attr("program[]") == "program[]") {
                error.appendTo('#messageBox');
            }
        },
        messages: {
            "program[]": "Please choose a program.",
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:54:01.273

我认为如果你有问题。

element.attr("program[]") == "program[]" 应该是 element.attr("name") == "program[]"

# node.js - coffeescript 中 array.forEach() 的正确语法

> ID：11567341
> 
> 赞同：5
> 
> 时间：2012-07-19T18:46:44.223
> 
> 标签：node.js, syntax, coffeescript

我在coffeescript中有以下代码递归列出目录（从javascript转换）：

```
fs = require 'fs'

walk = (dir, done) ->
  results = []
  fs.readdir dir, (err, list) ->
    return done(err) if err
    pending = list.length
    return done(null, results) unless pending
    list.forEach (file) ->
      file = "#{dir}\\#{file}"
      fs.stat file, (err, stat) ->
        if stat and stat.isDirectory()
          walk file, (err, res) ->
            results = results.concat(res)
            done null, results  unless --pending
        else
          results.push file
          done null, results  unless --pending

walk __dirname, (err, results) ->
  throw err if err
  console.log results 
```

正如你所看到的，我正在使用`list.forEach (file) ->`它并且它正在工作。但是当我尝试用`for file in list`then 替换它时，它无法正常工作。我做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T19:05:17.007

您正在循环中定义一个函数。JS 中的一个常见陷阱。您需要关闭迭代器。

`for file in list then do (file) =>`

# c# - TSQL BULK INSERT 行错误导致 C# 异常

> ID：11567344
> 
> 赞同：3
> 
> 时间：2012-07-19T18:46:52.990
> 
> 标签：c#, sql-server-2008, tsql, csv, ado.net

我正在处理非常大的分隔文件。这些文件已经过预处理，以确保字段和行分隔符有效。有时会处理未通过 TSQL 约束的行（通常是数据类型问题）。在这种情况下，“修复”输入数据不是一种选择。

我们用于`MAXERRORS`设置可接受的输入错误数量并`ERRORFILE`记录失败的行。

批量插入在 SSMS 中完成，每个失败行的消息窗口中记录了严重级别为 16 的错误消息。尝试通过 C#`SqlCommand`类执行此代码会导致在生成第一个严重级别 16 错误消息时引发异常，从而导致批处理失败。

有没有办法通过 C# 和 SqlCommand 之类的东西完成操作并忽略 SQL 错误消息？

示例命令：

```
BULK INSERT #some-table FROM 'filename' 
WITH(FIELDTERMINATOR ='\0',ROWTERMINATOR ='\n',FIRSTROW = 2, MAXERRORS = 100, ERRORFILE = 'some-file') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:57:47.397

为什么不使用[SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)，然后捕获使用[SqlRowsCopied](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.sqlrowscopied.aspx)事件复制的行。这将更接近地模仿`BULK INSERT`T-SQL 命令。

**编辑**：看起来错误处理对于 SqlBulkCopy 来说不是那么健壮。但是，这是一个似乎可以满足您要求的示例：

[http://www.codeproject.com/Articles/387465/Retrieving-failed-records-after-an-SqlBulkCopy-exc](http://www.codeproject.com/Articles/387465/Retrieving-failed-records-after-an-SqlBulkCopy-exc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:18:40.290

由于 .NET 支持 SQL 形式的所有数据类型，因此您应该能够在 .NET 中使用 TryParse 来捕获任何转换错误。您还需要在 SQL 数据范围内进行测试。关于文本需要测试长度。如果我解析一些 CSV，我会在一些非常大的插入上执行此操作。TryParse 非常快。比 Try Catch 更好，因为它没有抛出和错误的开销。

为什么不插入 .NET C#。有一个用于批量复制的类。我在解析时使用 TVP 异步插入，一次执行 10,000 个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-23T20:06:02.707

似乎对于有错误但仅由 SQL 计数的每一行都会引发异常。但是，它也被传递回 C#（在我的例子中是 SSIS）。我发现使用 TRY/CATCH 逻辑包装大容量插入并在发生超过 MAXERRORS 时使用 THROW（重新抛出异常）对我有用。

BEGIN TRY BULK INSERT #some-table FROM 'filename' WITH(FIELDTERMINATOR ='\0',ROWTERMINATOR ='\n',FIRSTROW = 2, MAXERRORS = 100, ERRORFILE = 'some-file') END TRY BEGIN CATCH THROW; 结束捕获

# c++ - C++ 程序在访问一个巨大的数组时冻结

> ID：11567345
> 
> 赞同：1
> 
> 时间：2012-07-19T18:46:52.830
> 
> 标签：c++, arrays, vector

在[另一个问题](https://stackoverflow.com/questions/11531714/how-to-compile-a-vector-with-huge-amount-of-data-in-c)中，我问如何编译一个包含大量数据的向量，因为我想要一个包含 107776 个条目的字典的向量，但我无法编译它。

由于[这个答案](https://stackoverflow.com/a/11531937/1529630)的代码，我解决了它：

```
char const * const dict[] = {"aaron",...}; 
```

但现在的问题是，当我尝试访问一个条目时......

```
cout<<dict[431104]<<endl; 
```

...程序冻结，Windows 想要关闭它。

为什么会这样？我该如何解决？

**编辑**：对不起，这是我的错。正如 tbroberg 和 Seth Carnegie 在[这个答案](https://stackoverflow.com/a/11567681/1529630)中注意到的那样，错误是我认为这`sizeof(dict)`是数组的长度（而不是`sizeof(dict)/sizeof(*dict)`）。因此，431104 远远超出了数组的范围（其长度为 107776）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:09:30.977

您正在堆栈上分配 107776 `char*`s，这可能足以导致计算机上的堆栈溢出。您可以尝试`char*`在堆上分配 s 并使用初始化列表：

```
const char** dict = new const char*[107776] {"aaron",...};

// ... use dict

delete[] dict; 
```

那应该可以解决问题（如果问题是堆栈大小，我认为是这样）。

另外，我刚刚注意到您的索引 431104 远远超出了数组的范围，数组的大小为 107776（我之前误读为 100 万）。您确定您的问题不仅仅是超出范围的索引吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:21:52.303

尝试把`static`之前`const`：

```
static const char *const dict [] = { "a...", ... 
```

现在它被分配在初始化的数据段中。根据您的平台和编译器/链接器的能力，它可能会起作用。

操作系统通常会负责缓存/交换这些数据，所以如果数据真的不可变，它是首选方法。

# telerik-grid - 为什么 ViewData 不起作用

> ID：11567346
> 
> 赞同：1
> 
> 时间：2012-07-19T18:46:56.393
> 
> 标签：telerik-grid, telerik-mvc

我有 MVC2 视图，其中有一个网格和图像按钮。单击图像按钮时，会将网格的 currentPage、filter 和 orderBy 字段的数据传递给另一个控制器。代码是，

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<MaintenanceEditableViewModel>" %>

"Image button"
<a href="<%: Url.Action("ExportToExcel", "ExportExcelButton", new { resourceId = ViewData["resourceId"], pagenum = ViewData["page"], orderBy = ViewData["orderBy"], filter = ViewData["filter"] }) %>">
<img src='<%: Url.Content("~/Content/Images/ExportExcelButton.gif") %>' /></a>

"Grid"
<%= Html.Telerik().Grid<MaintenanceAthletesResultsViewModel>()
.Name("Grid")
.TableHtmlAttributes(new { style = "font-size:8pt;" })
.HtmlAttributes(new { style = "height:335px" })
.DataKeys(k => k.Add(k2 => k2.ResultID))
.DataBinding(dataBinding => dataBinding.Ajax()
.Select("AthletesResultsAjax", "Maintenance")
...

"Action to initialize the grid in Maintenance controller"
public ActionResult AthletesResults(string id, bool editable)
{
ViewData["resourceId"] = id;
this._resourceBL.PopulateMaintenanceResourcesViewData(id, this.SelectedSport());

MaintenanceEditableViewModel model = new MaintenanceEditableViewModel { Editable = editable };
return View(model);
}

[GridAction]
public ActionResult AthletesResultsAjax(string id, int page, string orderBy, string filter)
{
List<MaintenanceAthletesResultsViewModel> model = null;

if (!string.IsNullOrEmpty(id))
{
ViewData["page"] = page;
ViewData["orderBy"] = orderBy;
ViewData["filter"] = filter;

model = this._resourceBL.GetMaintenanceAthletesResultsViewModel(int.Parse(id));
}

return View(new GridModel(model));
}

public ActionResult ExportToExcel(string resourceId, string pagenum, string orderBy, string filter) 
```

奇怪的是，只有 ViewData["resourceId"] （在视图初始化时设置）能够被传递。3个参数，ViewData["page"], ViewData["orderBy"], ViewData["filter"]（在grid ajax action中设置）不能传递。所有 3 在 ExportToExcel 中都是空的，所以我认为它们没有正确存储在 ViewData 中（我不确定按下图像按钮时如何检查 ViewData）。我很困惑，需要帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T16:57:19.353

我认为问题在于 ViewData 主要用于将数据从 Controller 传递到 View，在您的情况下，您有 Controller -> View -> Controller。我认为 Telerik 知识库有一个很好的解决方案，如何为您的导出操作提供额外的数据。[Telerik 知识库](http://www.telerik.com/support/kb/aspnet-mvc/grid/export-to-excel.aspx)

```
<%= Html.ActionLink("Export to Excel", "Export", new { page = 1, orderBy = "~", filter = "~"}, new { id = "exportLink" }) %>

<script type="text/javascript">
    function onDataBound() {
        var grid = $(this).data('tGrid');
        var $exportLink = $('#exportLink');
        var href = $exportLink.attr('href');
        href = href.replace(/page=([^&]*)/, 'page=' + grid.currentPage);
        href = href.replace(/orderBy=([^&]*)/, 'orderBy=' + (grid.orderBy || '~'));
        href = href.replace(/filter=(.*)/, 'filter=' + (grid.filterBy || '~'));
        $exportLink.attr('href', href);
    }
</script> 
```

当数据被接收并呈现（OnDataBound）到屏幕时，脚本会动态更新 Export-links url。然后它应该在控制器端很好地绑定。

如果您更熟悉 JavaScript，那么您可能应该在导出按钮上放置一个单击事件，并在 JavaScript 端发出 GET 请求。那么你就没有做出丑陋的 url 修改。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:02:31.100

我看不到您将这些参数发送到 AthletesResultsAjax 操作的方式/位置。您使用的 dataBinding.Ajax().Select() 函数的签名仅指定操作和控制器名称。它如何知道这些值是什么？您需要指定一个 routeValues 对象以将适当的数据发送到控制器操作。如果您调试代码并在您的 ajax 操作中放置一个断点，实际值是否通过？我可能会在这里很忙，但我认为您的问题更多的是在这方面，而不是数据如何存储在 ViewData 中。

# powershell - 使用 SoapUI 运行 VMWare powerCLI 命令

> ID：11567349
> 
> 赞同：3
> 
> 时间：2012-07-19T18:47:04.863
> 
> 标签：powershell, vmware, soapui, powercli

我有一个带有 PowerCLI 命令（如 Connect-VIServer 等）的 powershell 脚本文件。在将库引用添加到 VMWare PowerCLI 后，我可以在 PowerGUI 中运行脚本文件，但我不知道如何通过 SoapUI 运行它。我猜它也不适用于常规的 Powershell CLI。有什么办法可以使这项工作？如果有帮助，这是错误：

```
The term 'Connect-VIServer' is not recognized as the name of a cmdlet, function
, script file, or operable program. Check the spelling of the name, or if a pat
h was included, verify that the path is correct and try again.
At Test.ps1:10 char:23
+ $vm = Connect-VIServer <<<<  -Server $vcenterIP -User $vcenterUser -Password 
$vcenterPW
    + CategoryInfo          : ObjectNotFound: (Connect-VIServer:String) [], Co 
   mmandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T18:58:38.147

尝试在脚本的开头调用它：

```
Add-PSSnapin "VMware.VimAutomation.Core" | Out-Null
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-21T02:56:27.907

您不能在 Powershell 主机之外执行 PowerCLI 命令。

要将管理单元添加到任何 Powershell 主机，请使用 Tomas 提到的命令：

```
Add-PSSnapin VMware.VimAutomation.Core 
```

# c# - 使用 OpenCV 打开和关闭

> ID：11567350
> 
> 赞同：5
> 
> 时间：2012-07-19T18:47:12.753
> 
> 标签：c#, opencv

您如何使用 OpenCV 和 C# 实现图像处理、打开和关闭的技术？谁能给我一个例子？

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T09:51:14.790

如果您使用 EmguCV（如 go4sri 假设的那样），则打开 EmguCV 的代码片段将如下所示：

```
Image<Gray, Byte> src = new Image<Gray, Byte>( "Your Image.png" );
Image<Gray, Byte> dst = new Image<Gray, Byte>( src.Width, src.Height );
StructuringElementEx element = new StructuringElementEx( 3, 3, 1, 1, Emgu.CV.CvEnum.CV_ELEMENT_SHAPE.CV_SHAPE_CROSS );

CvInvoke.cvMorphologyEx( src, dst, IntPtr.Zero, element, CV_MORPH_OP.CV_MOP_OPEN, 1 );

ImageViewer.Show( dst, "Your morphed Image" ); 
```

对于关闭，您只需要替换 Enum

```
CV_MORPH_OP.CV_MOP_CLOSE 
```

有关这些功能的更多信息，请访问[EmguCV Doc](http://www.emgu.com/wiki/files/2.4.2/document/Index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T04:27:40.803

我假设您正在使用[EmguCV](http://www.emgu.com/wiki/index.php/Main_Page)。您可以使用`MorphologyEx`实现简单和复杂的基于形态学操作的方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:35:58.677

要实现开放，您调用 erode 后跟 dilate。关闭是通过调用先扩张然后腐蚀来完成的。

参考：

[http://opencv.willowgarage.com/documentation/image_filtering.html](http://opencv.willowgarage.com/documentation/image_filtering.html)

[http://opencv.itseez.com/doc/tutorials/imgproc/opening_closing_hats/opening_closing_hats.html](http://opencv.itseez.com/doc/tutorials/imgproc/opening_closing_hats/opening_closing_hats.html)

# forms - 使用用户不希望使用的数值来编码隐藏的 html 字段，这是在 HTML 语义上更正确的方法

> ID：11567354
> 
> 赞同：0
> 
> 时间：2012-07-19T18:47:40.117
> 
> 标签：forms, html

在我的示例中，该值将始终为整数。不希望用户更改该字段的值。

```
<input type="hidden" value="14" name="user_id" readonly/>
<input type="number" value="14" name="user_id" class="hidden" readonly/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:49:55.077

从书上看，正确的答案是`<input type="hidden" etc... />`因为用户代理已经有了如何与这些字段交互的规则。

无论是否使用 CSS，您的字段都不会显示，并且对于可访问性等更好。用户无法与隐藏字段进行交互（javascript 或在本地编辑代码除外）。我仍然会验证该值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T19:23:32.633

使字段隐藏*在 HTML*中的唯一方法是使用`type="hidden"`. 您可能被 HTML5 功能误导了`type="number"`。它不能与编程中的类型变量或数据格式中的字段类型真正相提并论。相反，它旨在创建适合输入数字数据的专用用户界面（例如旋转框，可能仍允许键入数字）。这将毫无意义，因为您不期望甚至不允许用户在此处输入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T18:49:42.907

我真的认为这一点都不重要，因为使用 JavaScript 或 CSS，（相对）知识渊博的用户都可以访问它们。但是，作为个人喜好，我总是使用`type="hidden"`，因为这似乎是它的创建目的。

不过，我建议您选择您喜欢的任何一种，然后始终如一地使用该方法，但这实际上是一个纯粹个人喜好的问题。

# c# - 为什么我的 CheckedListBox 的 ItemText 被视为“0”？

> ID：11567356
> 
> 赞同：0
> 
> 时间：2012-07-19T18:47:56.487
> 
> 标签：c#, winforms, checkedlistbox

使用此代码：

```
for (int i = 0; i <= (checkedListBoxPlatypi.Items.Count - 1); i++)
{
    if (checkedListBoxPlatypi.GetItemCheckState(i) == CheckState.Checked)
    {
        ReturnListPlatypi.Add(ParsePlatypusID(checkedListBoxPlatypi.GetItemText(i)));
    }
} 
```

...和一个 CheckedListBox*确实*通过（FriendlyPlatypus 是一个带有内容的字符串）分配了文本：

```
checkedListBoxPlatypi.Items.Add(FriendlyPlatypus); 
```

...ParsePlatypusID() 正在传递“0”...???

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:49:34.920

我假设您没有在列表框中添加“i”，因此该对象不会有任何文本。你只需要直接的对象：

```
for (int i = 0; i <= (checkedListBoxPlatypi.Items.Count - 1); i++)
{
    if (checkedListBoxPlatypi.GetItemCheckState(i) == CheckState.Checked)
    {
        ReturnListPlatypi.Add(ParsePlatypusID(checkedListBoxPlatypi.Items[i].ToString()));
    }
} 
```

事实上，如果您已经通过数据绑定添加了一个对象，并且您想直接进入“DisplayMember”字段，您可以使用：

```
for (int i = 0; i <= (checkedListBoxPlatypi.Items.Count - 1); i++)
{
    if (checkedListBoxPlatypi.GetItemCheckState(i) == CheckState.Checked)
    {
        ReturnListPlatypi.Add(ParsePlatypusID(checkedListBoxPlatypi.GetItemText( checkedListBoxPlatypi.Items[i])));
    }
} 
```

# python - 扫描 MySQL 表以获取更新 Python

> ID：11567357
> 
> 赞同：1
> 
> 时间：2012-07-19T18:48:04.390
> 
> 标签：python, mysql

我正在创建一个依赖于 MySQL 表中信息的 GUI，我想要做的是在每次使用新数据更新表时显示一条消息。我不知道如何做到这一点，或者即使它是可能的。我有检索最新 MySQL 更新的代码，但我不知道每次新数据进入表时如何发送消息。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:18:49.913

非常简单直接的解决方案就是从您的表中轮询最新的自动增量 id，并将其与您在之前的轮询中看到的进行比较。如果它更大——你有新数据。这称为“主动轮询”，实现起来很简单，如果您不经常这样做就足够了。因此，您必须将最后一个 id 值存储在 GUI 中的某个位置。请注意，当您重新启动 GUI 应用程序时，此存储的值将重置——一定要考虑在 GUI 启动时要做什么。可能您只需要跟踪 GUI 运行时发生的插入——然后，在 GUI 启动时，您只需要轮询并存储当前 id 值，然后定期轮询并对其更改做出反应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:43:48.673

@spacediver 提供了一些关于主动轮询方法的好建议。我还想发布一些其他选项。

您可以使用某种类型的消息传递来在客户端之间传递通知。ZeroMQ、twisted 等提供这些功能。一种方法是让更新客户端发出消息以及他们成功的数据库插入。客户端都可以收听通知通道，而不是总是轮询数据库。

如果您无法控制向执行插入的客户端添加更新消息，您还可以查看[此链接](http://electricsheep.androiddreams.org/wordpress/2010/10/27/triggering-shell-scripts-from-mysql/)以使用数据库触发器调用脚本，该脚本只会向您的消息传递框架发出更新消息。它解释了安装 UDF 扩展以允许您在触发器中运行 sys_exec 命令并调用简单脚本。

这样，客户只需响应通知，而不是定期检查。

# java - 仅从字符串的一部分中删除 html

> ID：11567358
> 
> 赞同：2
> 
> 时间：2012-07-19T18:48:09.600
> 
> 标签：java, regex

我有以下代码应该从字符串的一部分中删除所有 HTML，该字符串由美元符号引用（可能更多）。这很好用，但我还需要保留那些美元符号。任何建议，谢谢

```
private static String removeMarkupBetweenDollars(String input){
    if ((input.length()-input.replaceAll("\\$","").length())%2!=0)
    {
        throw new RuntimeException("Missing or extra: dollar");
    }
    Pattern pattern = Pattern.compile("\\$(.*?)\\$",Pattern.DOTALL);
    Matcher matcher = pattern.matcher(input);

    StringBuffer sb =new StringBuffer();

    while(matcher.find())
         { //prepending does NOT work, if sth. is in front of first dollar
        matcher.appendReplacement(sb,matcher.group(1).replaceAll("\\<.*?\\>", ""));
        sb.append("$"); //note this manual appending
    }
    matcher.appendTail(sb);
    System.out.println(sb.toString());

    return sb.toString();
} 
```

感谢帮助！

```
 String input="<p>$<em>something</em>$</p>  <p>anything else</p>";
    String output="<p>$something$</p>  <p>anything else</p>"; 
```

更复杂的输入输出：

```
String input="<p>$ bar  <b>foo</b>  bar <span style=\"text-decoration: underline;\">foo</span>  $</p><p>another foos</p> $ foo bar <em>bar</em>$";
String output="<p>$ bar  foo  bar foo  $</p><p>another foos</p> $ foo bar bar$" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:12:21.937

只需对您的代码进行一些小调整：

```
private static String removeMarkupBetweenDollars(String input) {
    if ((input.length() - input.replaceAll("\\$", "").length()) % 2 != 0) {
        throw new RuntimeException("Missing or extra: dollar");
    }

    Pattern pattern = Pattern.compile("\\$(.*?)\\$", Pattern.DOTALL);
    Matcher matcher = pattern.matcher(input);

    StringBuffer sb = new StringBuffer();

    while (matcher.find()) {
        String s = matcher.group().replaceAll("<[^>]+>", "");
        matcher.appendReplacement(sb, Matcher.quoteReplacement(s));
    }
    matcher.appendTail(sb);

    return sb.toString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:58:30.710

```
String output = input.replaceAll("\\$<.*?>(.*?)<.*?>\\$", "\\$$1\\$"); 
```

正则表达式中的一个关键点是`?`in `.*?`- 这意味着“非贪婪”匹配，这反过来意味着“尽可能少地消耗输入”。如果没有这个，正则表达式将尝试尽可能多地消耗 - 直到`$<html>foo</html>$`输入中后续出现的结尾（如果存在）。

这是一个测试：

```
public static void main(String[] args) throws Exception {
    String input = "<p>$<em>something</em>$</p> <p>and $<em>anything</em>$ else</p>";
    String output = input.replaceAll("\\$<.*?>(.*?)<.*?>\\$", "\\$$1\\$");
    System.out.println(output);
} 
```

输出：

```
<p>$something$</p> <p>and $anything$ else</p> 
```

# c# - 使用 WinRT 中的 Azure 托管库

> ID：11567359
> 
> 赞同：2
> 
> 时间：2012-07-19T18:48:10.573
> 
> 标签：c#, azure, microsoft-metro, windows-runtime

是否可以使用托管库从 WinRT 组件访问 Azure？

据我了解，我无法在 WinRT/Metro 配置文件中引用托管库 dll。

我可以使用 REST API (http://msdn.microsoft.com/en-us/library/windowsazure/dd179355) 但更喜欢托管 API。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T08:07:25.960

无法从 Metro 应用程序中调用这些库的当前版本 (1.7)。对于其中的大多数，无论如何都可以从 WinRT 组件调用并没有多大意义。

您引用的链接本质上具有三组不同的库-

*   **存储客户端库**这些用于访问 Azure 存储。这些本质上是围绕相应 REST API 的包装器。
*   **ServiceRuntime 库**这些用于从 Azure 上正在运行的租户中访问租户/角色/实例属性。
*   **诊断库**这些库用于配置运行中的 Azure 应用程序的日志并将其写入 Azure 存储帐户。

让存储客户端库可从 Metro 应用程序调用是完全有意义的，但 1.7 中不提供支持。您可能不得不推出自己的 REST 调用。[通过查看 MS在此处](https://github.com/WindowsAzure/azure-sdk-for-java)开源的相应 Java 代码，您可以很好地了解如何编写此代码。

对于另外两个，使用这些库的应用程序将在 Windows Azure VM 上运行。因此，您不需要在 Metro 应用程序中使用它们。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-29T22:38:18.023

新版本的 Windows Azure 存储客户端库支持 Windows 应用商店应用程序。[请在用于 Windows 运行时](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/11/05/windows-azure-storage-client-library-for-windows-runtime.aspx)的 Windows Azure 存储客户端库中找到更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T10:02:54.540

Windows Azure 托管库中的某些类依赖于 Metro 中不可用的桌面组件。例如，表存储客户端依赖于 WCF 数据服务。因此，您不能在 Metro 应用程序中使用这些程序集。请使用 REST API，或在 Windows Azure 中创建一个托管服务来执行与 Windows Azure 相关的所有任务，并让您的 Metro 应用程序与您自己的服务进行通信。适用于 Windows 8 的 Windows Azure 工具包也可能有所帮助：[http](http://watwindows8.codeplex.com/) ://watwindows8.codeplex.com/ 。

此致，

明旭。

# jquery - 使用 jQuery 在 IE6 中禁用和启用下拉菜单

> ID：11567363
> 
> 赞同：1
> 
> 时间：2012-07-19T18:48:19.730
> 
> 标签：jquery, internet-explorer, internet-explorer-6, html-select

我在用

```
selectElement.attr('disabled', 'disabled'); 
```

禁用 IE6 中的下拉菜单，并使用

```
selectElement.removeAttr('disabled'); 
```

重新启用它。但它仍然被禁用并显示为灰色。有人有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T20:38:33.510

*   首先要检查：您的 jQuery 版本。
    我发现[this reference](http://forum.jquery.com/topic/jquery-remove-attribute-disabled-from-select-ie6) to an jQuery bug in IE6 with `removeAttr`on `select`elements。此错误在 1.6.2 中，并被标记为已修复。确保您使用的是最新版本的 jQuery，目前是 1.7.2。

*   要检查的第二件事：您的 HTML。
    我找到[了这个论坛帖子](http://forum.jquery.com/topic/jquery-remove-attribute-disabled-from-select-ie6)，似乎 IE6 要求元素具有相同的`id`属性`name`才能工作。

*   第三个建议：
    尝试使用 jQuery 的`.prop()`和`.removeProp()`方法而不是`attr`方法。（手册页：[http](http://api.jquery.com/prop/) ://api.jquery.com/prop/和[http://api.jquery.com/removeprop/](http://api.jquery.com/removeprop/)）

最后，我再重复一遍可能已经对你说过很多次的话：请停止支持 IE6。我们越早忘记这个浏览器就越好。

It's worth pointing out that jQuery are planning to drop support for IE6, IE7 and IE8 (yes, all three of them) in v2.0, due out some time in the middle of next year. You'll still be able to use older versions of jQuery, of course, but it does make the point about how far behind you are if you're still on IE6.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:51:21.957

这似乎是 IE6/IE7 的一个有据可查的问题。

快速谷歌搜索揭示了这种潜在的解决方法：[http ://www.goodercode.com/wp/disable-select-options-internet-explorer-jquery/](http://www.goodercode.com/wp/disable-select-options-internet-explorer-jquery/)

# opengl-es - OpenGL：在3点之间绘制曲线

> ID：11567371
> 
> 赞同：1
> 
> 时间：2012-07-19T18:49:24.117
> 
> 标签：opengl-es, cocos2d-iphone, bezier

基本上，我希望在 openGL 中的 3 个点之间绘制一条曲线，如下图所示。我发现了几段代码，它们对于使用 4 个点绘制贝塞尔曲线很有用，但对于 3 个点，我真的没有成功。

![在此处输入图像描述](../Images/5bd674980639abcbe5211ee55b9cf67e.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T20:18:58.290

根据贝塞尔曲线的定义，您有以下公式（对于每个 x、y 分量）：

```
x(t) = (1-t)^3*p1x + 3*t*(1-t)^2*c1x + 3*t^2*(1-t)*c3x + t^3*p3x
y(t) = (1-t)^3*p1y + 3*t*(1-t)^2*c1y + 3*t^2*(1-t)*c3y + t^3*p3y 
```

![贝塞尔结构](../Images/3a3e9a47b0bfeb69303184c5a8d7e5b5.png)

在您的情况下，您知道中间点`(p2x,p2y)`。您也可以假设`c1x` 和 `c2x`具有相同的值；和 that`c1y` 也 `c2y`有相同的价值

所以我们有以下方程在 t=0.5

```
p2x = (3/4)*c1x+(p1x+p3x)/8
p2y = (3/4)*c1y+(p1y+p3y)/8 
```

解决了`c1x=c2x`_`c1y=c2y`

```
c1x = c2x = -(p1x-8*p2x+p3x)/6
c1y = c2y = -(p1y-8*p2y+p3y)/6 
```

给出最终的 Bezier 方程，以点`(p1x,p1y)`和`(p2x,p2y)`的形式使用`(p3x,p3y)`：

```
x(t) =    (1-t)^3 *      [p1x]
     + 3*t*(1-t)^2 * [-(p1x-8*p2x+p3x)/6]
     + 3*t^2*(1-t) * [-(p1x-8*p2x+p3x)/6]
     +    t^3 *          [p3x]

y(t) =    (1-t)^3 *      [p1y]
     + 3*t*(1-t)^2 * [-(p1y-8*p2y+p3y)/6]
     + 3*t^2*(1-t) * [-(p1y-8*p2y+p3y)/6]
     +    t^3 *          [p3y] 
```

**概括**

尝试四个控制点

1.  `( p1x, p1y )`
2.  `( -(p1x-8*p2x+p3x)/6, -(p1y-8*p2y+p3y)/6 )`
3.  `( -(p1x-8*p2x+p3x)/6, -(p1y-8*p2y+p3y)/6 )`
4.  `( p3x, p3y )`

这是我用`p1=(0,0)`,`p2=(2,2)`和制作的一个例子`p3=(4,-1)`。我计算了以下控制点

1.  `( 0, 0 )`
2.  `( 2, 17/6 )`
3.  `( 2, 17/6 )`
4.  `( 4, -1)`

结果如下所示：

![导出图](../Images/dea2e033b05ace30af177b04c523a0ad.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:17:24.310

听起来你想要一个[Hermite spline](http://en.wikipedia.org/wiki/Cubic_Hermite_spline#Finite_difference)。

# javascript - 在 jquery 下拉菜单中自动完成

> ID：11567372
> 
> 赞同：3
> 
> 时间：2012-07-19T18:49:24.673
> 
> 标签：javascript, jquery-ui

我有一个下拉列表，其中包含我的客户的个人资料名称。

随着客户数量的增长，我需要一个自动完成功能，这样我就能够找到具有建议的特定用户，而不是被迫在下拉列表中查找每个现有用户。

以下代码从数据库中获取数据：

```
$.getJSON(
            "profiles/custoomer.aspx?callback=?",
            {},
            function (data) {
                $.each(data, function (value, name) {
                    $('<option>').attr('value', value).text(name).appendTo('#customer_profile');
                });
            }
            ); 
```

如何添加自动完成功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:56:51.413

您是否尝试使用自动完成组件？这是他的文档，它易于使用且易于定制！

[http://jqueryui.com/demos/autocomplete/](http://jqueryui.com/demos/autocomplete/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T12:54:52.250

尝试使用下面的示例，不要忘记包含[Jquery](http://jqueryui.com/home)最新文件；) Njoy Bro

```
<script>
    $(function() {
        var availableTags = [
            "ActionScript",
            "AppleScript",
            "Asp",
            "BASIC",
            "C",
            "C++",
            "Clojure",
            "COBOL",
            "ColdFusion",
            "Erlang",
            "Fortran",
            "Groovy",
            "Haskell",
            "Java",
            "JavaScript",
            "Lisp",
            "Perl",
            "PHP",
            "Python",
            "Ruby",
            "Scala",
            "Scheme"
        ];
        $( "#tags" ).autocomplete({
            source: availableTags
        });
    });
    </script>

<div class="demo">

<div class="ui-widget">
    <label for="tags">Tags: </label>
    <input id="tags">
</div>

</div><!-- End demo -->

<div style="display: none;" class="demo-description">
<p>The Autocomplete widgets provides suggestions while you type into the field. Here the suggestions are tags for programming languages, give "ja" (for Java or JavaScript) a try.</p>
<p>The datasource is a simple JavaScript array, provided to the widget using the source-option.</p>
</div><!-- End demo-description --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-14T15:50:30.560

```
 $(function() {
                var availableTags = ["ribstar","major"];                    
                $( "#search" ).autocomplete({
                  source: availableTags,
                  select: function( event, ui ) 
                        { 
                              var $this = $(this).val(ui.item.label);
                              $('#sub_cat').children('[name="'+$this.val()+'"]').attr('selected', true);
                        }  
                });
              }); 
```

和html部分

```
<div class="ui-widget"><label for="tags">Search: </label><input type="text" name="search" id="search"></div>
<select name="sub_cat" id="sub_cat">
  <option value="1" name="ribstar">ribstar</option>
  <option value="2" name="major">major</option>
</select> 
```

# hadoop - 改善 hadoop 中的负载平衡

> ID：11567373
> 
> 赞同：0
> 
> 时间：2012-07-19T18:49:28.657
> 
> 标签：hadoop, mapreduce

我有以下字符串作为键。从下面的代码中，我看到所有的键都指向同一个减速器，尽管有很多减速器。最后，同一个减速器超载。我想，每个键（字符串），去一个不同的减速器。请帮我解决这个问题。谢谢！

```
String a = "71 1 2";
String b = "72 1 1";
String c = "70 1 3";

int hash_a = a.hashCode();
int hash_b = b.hashCode();
int hash_c = c.hashCode();

int part_a = hash_a % 10;
int part_b = hash_b % 10;
int part_c = hash_c % 10;

System.out.println("hash a: "+hash_a+" part_a: "+part_a);
System.out.println("hash b: "+hash_b+" part_b: "+part_b);
System.out.println("hash c: "+hash_c+" part_c: "+part_c);

Output:

hash a: 1620857277 part_a: 7
hash b: 1621780797 part_b: 7
hash c: 1619933757 part_c: 7 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:30:53.693

一种选择是您定义一个自定义[分区](http://hadoop.apache.org/common/docs/r0.20.0/api/org/apache/hadoop/mapred/Partitioner.html)器而不是使用默认的 HashPartitioner 来确保您的密钥在您的减速器中均匀分布。

# php - 如何在 Symfony 2 中使用 git？

> ID：11567374
> 
> 赞同：7
> 
> 时间：2012-07-19T18:49:31.620
> 
> 标签：php, git, symfony, composer-php

我用 Composer 安装了 Symfony 2（遵循“主”指南），它创建了这个 .git/config 文件：

```
[core]
    repositoryformatversion = 0
    filemode = true
    bare = false
    logallrefupdates = true
[remote "origin"]
    fetch = +refs/heads/*:refs/remotes/origin/*
    url = git://github.com/symfony/symfony-standard
    pushurl = git@github.com:symfony/symfony-standard.git
[branch "master"]
    remote = origin
    merge = refs/heads/master
[remote "composer"]
    url = git://github.com/symfony/symfony-standard
    fetch = +refs/heads/*:refs/remotes/composer/* 
```

我不想干涉 Composer 在这里所做的事情，因为我不知道它是如何工作的，并且我希望将来能够更新供应商。

那么如何为“myapp”添加我自己的存储库并提交/推送到它？我通常做'git remote add origin ...'并且只使用它，但现在文件中有两个存储库，加上我需要添加的一个。

**更新**

我用这个命令安装了 Symfony2：

```
$ php composer.phar create-project symfony/framework-standard-edition myapp 
```

这创建了 myapp/ 并安装了 Symfony2 + 依赖项。但是现在 composer.json 看起来还没有准备好用于我的项目，看起来我的项目本身就是 Symfony2（我认为）：

```
{
    "name": "symfony/framework-standard-edition",
    "description": "The \"Symfony Standard Edition\" distribution",
    "autoload": {
    "psr-0": { "": "src/" }
    },
    "require": {
    "php": ">=5.3.3",
    "symfony/symfony": "2.1.*",
    "doctrine/orm": "2.2.*",
    "doctrine/doctrine-bundle": "dev-master",
    "twig/extensions": "dev-master",
    "symfony/assetic-bundle": "dev-master",
    "symfony/swiftmailer-bundle": "dev-master",
    "symfony/monolog-bundle": "dev-master",
    "sensio/distribution-bundle": "dev-master",
    "sensio/framework-extra-bundle": "dev-master",
    "sensio/generator-bundle": "dev-master",
    "jms/security-extra-bundle": "1.1.*",
    "jms/di-extra-bundle": "1.0.*"
    },
    "scripts": {
    "post-install-cmd": [
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::buildBootstrap",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::clearCache",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile"
    ],
    "post-update-cmd": [
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::buildBootstrap",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::clearCache",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile"
    ]
    },
    "config": {
    "bin-dir": "bin"
    },
    "minimum-stability": "dev",
    "extra": {
    "symfony-app-dir": "app",
    "symfony-web-dir": "web"
    }
} 
```

**大师指南**

*   [http://symfony.com/doc/master/book/installation.html](http://symfony.com/doc/master/book/installation.html)（第一步，下载symfony，我使用了composer命令，如下图：http: [//symfony.com/download](http://symfony.com/download)）
*   [http://symfony.com/doc/master/cookbook/workflow/new_project_git.html](http://symfony.com/doc/master/cookbook/workflow/new_project_git.html)（这个似乎已经过时了，因为它说我们必须做'git init'，但是git repo已经由composer创建）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T21:54:49.460

您可以安全地删除*.git*文件夹并运行*git init*来初始化您自己的存储库，就像@m2mdas 建议的那样。

Composer 在这里没有做任何特别的事情。它只是克隆[symfony-standard](https://github.com/symfony/symfony-standard)项目，然后安装它的依赖项。

Composer 会克隆存储库，但它不需要*.git*文件夹来工作。事实上，我认为它不应该默认克隆项目。可能他们会在未来的版本中修复它。

Composer 使用*composer.json*文件，您应该使用这个文件管理所有依赖项。您可以安全地对其进行编辑以添加或删除包。

然后，要更新软件包，只需运行：

```
php composer.phar update 
```

从 composer.json 中删除的所有包都将被删除，您添加的包将被安装。现有软件包将更新到最新版本。

您应该将生成的 composer.lock 文件存储在您的存储库中，以确保您在运行时始终获得相同版本的依赖项：

```
php composer.phar install 
```

composer.lock 会在您第一次运行 install 和每个更新命令时更新。

# c# - 以编程方式从文件创建图像 asp.net C#

> ID：11567379
> 
> 赞同：0
> 
> 时间：2012-07-19T18:49:48.897
> 
> 标签：c#, asp.net, image

我正在用 asp.net C# 编写项目。我想通过以下代码以编程方式创建图像：

```
protected void Page_Load(object sender, EventArgs e)
        {
            Image image = new Image();
            image.ID = "image11";
            image.ImageUrl = "a.jpg";
            image.ImageAlign = ImageAlign.AbsMiddle;
            image.Visible = true;

        } 
```

但是当我运行项目时什么都没有显示。如何通过在.cs文件中编写代码从文件创建图像并在页面中显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:53:52.153

此时，您刚刚创建了一个图像，但尚未将其添加到要显示的控件或页面上下文中。你基本上说

```
int x = 10; 
```

但后来从未对 x 做过任何事情。

ASP.NET 使用组合，因此它维护一个控件集合，每个控件还包含一个子节点集合。您需要将图像添加到容器中。例如，如果您想将图像添加到名为 myPanel 的面板中，则应为

```
myPanel.Controls.Add(image); 
```

看看[这篇文章](http://msdn.microsoft.com/en-us/library/kyt0fzt1.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:58:03.493

您已创建图像控件，但尚未将其添加到表单中。编写以下代码以将图像控件添加到您的表单中。

```
form1.Controls.Add(image); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-11T07:38:49.493

您将需要创建面板，然后必须将该图像添加到面板。

```
Panel Panel1= new Panel();
form1.Controls.Add(image); 
```

# c# - 转换字典 到带有键的对象集合

> ID：11567382
> 
> 赞同：1
> 
> 时间：2012-07-19T18:50:09.867
> 
> 标签：c#

有没有办法转换`Dictionary<string, obj>`为对象集合，使得集合中的每个对象都包含键作为另一个属性

这是 obj 的类 def

```
class someclass
{
  string property1;
  string property2;
} 
```

转换后，我希望集合中的每个对象都像

```
obj.property1
obj.property2
obj.Key 
```

从那以后我一直在努力解决这个问题，我寻求一些帮助。有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:53:01.847

就像是

```
var myCollection = from de in myDictionary 
                   select new
                   {
                       de.Value.property1,
                       de.Value.property2,
                       de.Key
                   }.ToList();  // or .ToArray() 
```

应该做的伎俩。

这将返回具有您请求的属性的新匿名类型的列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T18:57:26.100

您还可以（除了[匿名类型 apporach](https://stackoverflow.com/a/11567427/284240)）使用`List<Tuple<string, string, string>>`：

```
var list= dictionary
         .Select(kv => Tuple.Create(kv.Value.property1, kv.Value.property2, kv.Key))
         .ToList();

foreach(var item in list)
{
   Console.WriteLine("property1:{0 property2:{1} key:{2}"
                     , item.Item1
                     , item.Item2
                     , item.Item3);
} 
```

与匿名类型相比的优点是您可以`Tuple`轻松地从方法中返回。

**编辑**：第三个选项（我最喜欢的）是简单地创建您在某处声明的类的实例。这是理想的方式。我不知道为什么我认为您想要“即时”上课。

```
class someOtherClass
{
    public string property1{ get; set; };
    public string property2{ get; set; };
    public string Key{ get; set; };
}

List<someOtherClass> objects = dictionary
.Select(kv => new someOtherClass(){
     property1 = kv.Value.property1, 
     property2 = kv.Value.property2, 
     Key       = kv.Key 
 })
.ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T23:20:02.010

如果您不想像这样存储结果，则可以使用匿名类型：例如，如果您只是想将其用作数据源。

```
var res = myDictionary.Select(pair => new { pair.Key, pair.Value.Property1, pair.Value.Property2 }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T19:20:21.707

其他答案都很好，所以这只是一个补充。

您可以使用`Length`三个数组：

```
var arrays = myDictionary
    .Select(kv => new[] { kv.Value.property1, kv.Value.property2, kv.Key, }); 
```

或者你可以写一个新的类

```
class SomeclassAndKey
{
  public string property1;
  public string property1;
  public string Key;
} 
```

然后说

```
var someclassAndKeys = myDictionary
    .Select(kv => new SomeclassAndKey { property1 = kv.Value.property1, property2 = kv.Value.property2, Key = kv.Key, }); 
```

`.ToList()`在每种情况下，如果您不想推迟枚举并得到一个完整的结果，您可以追加`List<>`。

# java - Java 运行时 ClassNotFoundException

> ID：11567383
> 
> 赞同：3
> 
> 时间：2012-07-19T18:50:10.473
> 
> 标签：java, json, classpath, noclassdeffounderror

刚刚有一个关于我遇到的奇怪运行时错误的问题。我正在使用一个 JSON 服务器，该服务器在外部源提示时使用 JSON 对象进行响应。然而，就目前而言，我只是试图在发送 JSON 对象之前启动并运行它。我的代码在没有指定任何类路径的情况下进行编译，但是在运行时，它会抛出`NoClassDefFoundError`如下所示：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/commons/lang/exception/NestableRuntimeException
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
at ExampleServer.sendData(ExampleServer.java:76)
at ExampleServer.runServer(ExampleServer.java:30)
at ExampleServer.main(ExampleServer.java:15)
   Caused by: java.lang.ClassNotFoundException: org.apache.commons.lang.exception.NestableRuntimeException
at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
... 15 more 
```

我的代码如下：

```
import java.io.*;
import java.net.ServerSocket;
import java.net.Socket;
import java.lang.*;
import net.sf.json.*;

public class ExampleServer{

private DataOutputStream output;
private DataInputStream input;
private ServerSocket server;
private Socket connection;

public static void main(String[] args){
    new ExampleServer().runServer();
}

public void ExampleServer(){
    System.out.println("Server object created");
}

public void runServer(){
    try{
        server = new ServerSocket(12345,100);
        while(true){
            try{
                waitForConnection();
                getStreams();
                processConnection();
                sendData("Text");
            } catch(Exception e){
                System.out.println("Server Terminated Exception.");
            } finally {
                closeConnection();
            }
        }
    } catch(Exception e){
        e.printStackTrace();
    }
}

private void waitForConnection(){
    try{
        System.out.println("Waiting for connection.");
        connection = server.accept();
        System.out.println("Connection received from " + connection.getInetAddress().getHostName());
    } catch (IOException e){
        System.out.println(e);
    }
}

private void getStreams() throws IOException{
    output = new DataOutputStream(connection.getOutputStream());
    input = new DataInputStream(connection.getInputStream());
    System.out.println("Got streams");
}

private void processConnection() throws IOException{
    sendData("This is a test message");
}

private void closeConnection(){
    try{
        if(output != null && connection != null){
            sendData("SEVER>>> TERMINATE");
            output.close();
            connection.close();
        }
    } catch (IOException e){
        e.printStackTrace();
    }
}

private void sendData(String message){
    try{
        JSONObject g = new JSONObject();
        g.put("message", message);
        System.out.println(g.toString());
    } catch (Exception e){
        System.out.println("Error writing object");
    }
} 
```

}

并且 JSON 文件夹与 位于同一目录中`ExampleServer.java`，JSON 类`net/sf/json`位于我的导入中指定的位置。为什么它直到运行时才起作用？由于某种原因，我的类路径不正确吗？包含必要的类路径的适当语法是什么？

提前致谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-19T18:58:09.610

从[json-lib 主页](http://json-lib.sourceforge.net/)：

> Json-lib 在您的类路径中需要（至少）以下依赖项：
> 
> 1.  雅加达公共语言 2.5
> 2.  雅加达 commons-beanutils 1.8.0
> 3.  jakarta commons-collections 3.2.1
> 4.  雅加达公共日志记录 1.1.1
> 5.  ezmorph 1.0.6

您的实现编译仅表明编译器可以找到正确的类和方法。然而，这些类和方法的实现可能依赖于其他库。

可以在[此处](http://json-lib.sourceforge.net/dependencies.html)找到有关项目依赖项的更多信息。

# algorithm - 寻找一种将宽度分配到列的算法

> ID：11567388
> 
> 赞同：2
> 
> 时间：2012-07-19T18:50:25.640
> 
> 标签：algorithm, perl

我想将数据库表打印到 STDOUT。如果表格宽度大于屏幕宽度，我想以相同的百分比剪切列（除非表格宽度达到`min_width`），直到表格适合屏幕。我试图用发布的子程序来解决这个问题。有人知道解决这个问题的更短更优雅的算法吗？

```
sub cal_size {
    my ( $maxcols, $ref ) = @_;         
    # $maxcols => screen width
    # $ref => ref to an AoA; holds the table
    my ( $max ) = cal_tab( $ref );
    # $max => ref to an array; holds the length of the longest string of each column
    # $tab = 2;
    if ( $max and @$max ) {
        my $sum = sum( @$max ) + $tab * @$max; 
        $sum -= $tab;
        my @max_tmp = @$max;
        my $percent = 0;
        while ( $sum > $maxcols ) {
            $percent += 0.5;
            if ( $percent > 99 ) {
                return;
            }
            my $count = 0;

            for my $i ( 0 .. $#max_tmp ) {
                # $min_width => columns width should not be less than $min_width if possible 
                next if $min_width >= $max_tmp[$i]; 
                # no need to cut if the column width id less than min_width
                next if $min_width >= minus_x_percent( $max_tmp[$i], $percent ); 
                # don't cut if column width become less than min_width 
                $max_tmp[$i] = minus_x_percent( $max_tmp[$i], $percent );
                $count++;
                last if $sum <= $maxcols;   
            }
            $min_width-- if $count == 0 and $min_width > 1; 
            # if no cuts but $sum > $maxcols reduce $min_width
            $sum = sum( @max_tmp ) + $tab * @max_tmp; 
            $sum -= $tab;
        }
        my $rest = $maxcols - $sum;
        while ( $rest > 0 ) { # distribute the rest
            my $count = 0;
            for my $i ( 0 .. $#max_tmp ) {
                if ( $max_tmp[$i] < $max->[$i] ) {
                    $max_tmp[$i]++;
                    $rest--;
                    $count++;
                    last if $rest < 1;
                }
            } 
            last if $count == 0;
            last if $rest < 1;
        }
        $max = [ @max_tmp ] if @max_tmp;
    }
    return $max;
}

sub minus_x_percent {
    my ( $value, $percent ) = @_;
    return int $value - ( $value * 1/100 * $percent );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T00:45:00.210

如果不是因为字段宽度的下限，这个问题会很简单。一旦一个字段不能变得更小，只有较大的字段才有资格进行缩放，因此计算会根据所有字段、没有字段或某些字段是否已缩小到其限制而有所不同。

缩放有几个*波段*，每个唯一的字段宽度一个。由于字段按等比例缩小，其中最小的字段将首先达到最小字段大小限制。之后，只有大于最小尺寸的列可以进一步减少，直到第二小的列也达到限制。

这一直持续到所有列都达到其最小大小，之后可用空间在列之间平均分配。

该程序实现了该算法的计算，我认为可以满足您的要求。

请注意，返回的字段宽度是浮点值，您必须根据需要对其进行四舍五入。

```
use strict;
use warnings;

use List::Util 'max';

my $min_col_width = 10;
my $tab = 2;

my $widths = recalc_widths(80, [ 10, 15, 20, 25, 30 ]);
print join '  ', map sprintf('%.3f', $_), @$widths;
print "\n";

sub recalc_widths {

  my ($target, $widths) = @_;
  $target -= (@$widths - 1) * $tab;

  my @sorted_widths = sort { $a <=> $b } @$widths;

  my $num_limited = 0;
  my $adjustable_total_width = 0;
  $adjustable_total_width += $_ for @sorted_widths;

  while (@sorted_widths) {

    my $boundary = $sorted_widths[0];

    my $scale = ($target - $num_limited * $min_col_width) / $adjustable_total_width;

    if ($boundary * $scale >= $min_col_width) {
      return [ map max($_ * $scale, $min_col_width), @$widths ];
    }

    while (@sorted_widths and $sorted_widths[0] == $boundary) {
      shift @sorted_widths;
      $adjustable_total_width -= $boundary;
      $num_limited++;
    }
  }

  return [ ($target / $num_limited) x $num_limited ];
} 
```

**输出**

```
10.000  10.333  13.778  17.222  20.667 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-19T19:17:36.097

我认为最好使用 CPAN 中的适当模块。如果您可以计算每列的宽度，则使用[Text::Format配置每一行打印](http://search.cpan.org/perldoc?Text%3A%3AFormat)

# r - 条件 ..count.. 对 faceting 变量求和

> ID：11567389
> 
> 赞同：10
> 
> 时间：2012-07-19T18:50:38.203
> 
> 标签：r, ggplot2

*我正在尝试用一个方面内*落入该桶的观察百分比来注释条形图。这个问题与这个问题非常密切相关： [在分类变量的图表中显示 % 而不是计数，](https://stackoverflow.com/questions/3695497/ggplot-showing-instead-of-counts-in-charts-of-categorical-variables)但是分面的引入引入了皱纹。相关问题的答案是使用带有文本 geom 的 stat_bin，然后按如下方式构造标签：

```
 stat_bin(geom="text", aes(x = bins,
         y = ..count..,
         label = paste(round(100*(..count../sum(..count..)),1), "%", sep="")
         ) 
```

这适用于无面情节。然而，对于构面，这个 sum(..count..) 是对整个观察集合求和，而不考虑构面。下图说明了这个问题——请注意，面板内的百分比总和不是 100%。

![在此处输入图像描述](../Images/1e0a6b0e8181ffa140c3f05e20bbef16.png)

这是上图的实际代码：

```
 g.invite.distro <- ggplot(data = df.exp) +
 geom_bar(aes(x = invite_bins)) +
 facet_wrap(~cat1, ncol=3) +
 stat_bin(geom="text", aes(x = invite_bins,
         y = ..count..,
         label = paste(round(100*(..count../sum(..count..)),1), "%", sep="")
         ),  
         vjust = -1, size = 3) +
  theme_bw() + 
scale_y_continuous(limits = c(0, 3000)) 
```

更新：根据要求，这是一个重现问题的小例子：

```
df <- data.frame(x = c('a', 'a', 'b','b'), f = c('c', 'd','d','d'))
ggplot(data = df) + geom_bar(aes(x = x)) +
 stat_bin(geom = "text", aes(
         x = x,
         y = ..count.., label = ..count../sum(..count..)), vjust = -1) +
 facet_wrap(~f) 
```

![在此处输入图像描述](../Images/5484d3531100c01de28865a42871a92e.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T21:57:45.653

**更新** `geom_bar`需要`stat = identity`.

有时在调用 ggplot 之外更容易获得摘要。

```
df <- data.frame(x = c('a', 'a', 'b','b'), f = c('c', 'd','d','d'))

# Load packages
library(ggplot2)
library(plyr)

# Obtain summary. 'Freq' is the count, 'pct' is the percent within each 'f'
m = ddply(data.frame(table(df)), .(f), mutate, pct = round(Freq/sum(Freq) * 100, 1)) 

# Plot the data using the summary data frame
ggplot(data = m, aes(x = x, y = Freq)) + 
   geom_bar(stat = "identity", width = .7) +
   geom_text(aes(label = paste(m$pct, "%", sep = "")), vjust = -1, size = 3) +
   facet_wrap(~ f, ncol = 2) + theme_bw() +
   scale_y_continuous(limits = c(0, 1.2*max(m$Freq))) 
```

![在此处输入图像描述](../Images/cb3e5538b51ffb211977c222a2d96888.png)

# iphone - 带有当前时间的 UILabel

> ID：11567392
> 
> 赞同：6
> 
> 时间：2012-07-19T18:50:47.237
> 
> 标签：iphone, objective-c, ios

我有一个 UILabel，我想显示当前时间 (HH:mm)（与状态栏中的时间相同）。

如何更新标签以更改为新时间？如果我安排一个间隔为 60 秒的 NSTimer，那么如果计时器在系统时间的分钟更改之前触发，那么标签可能会超时一分钟？

可以将计时器的间隔设置为 1 秒，还是会使用比必要更多的资源？还是有另一种方法来确保标签与状态栏时钟保持同步（最好是准确的，但 1 秒 lee 方式可以）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T19:03:21.547

Dispatch 是你的朋友：

```
void runBlockEveryMinute(dispatch_block_t block)
{
    block(); // initial block call

    // get the current time
    struct timespec startPopTime;
    gettimeofday((struct timeval *) &startPopTime, NULL);

    // trim the time
    startPopTime.tv_sec -= (startPopTime.tv_sec % 60);
    startPopTime.tv_sec += 60;

    dispatch_time_t time = dispatch_walltime(&startPopTime, 0);

    __block dispatch_block_t afterBlock = ^(void) {
        block();

        dispatch_after(dispatch_time(DISPATCH_TIME_NOW, NSEC_PER_SEC * 60), dispatch_get_main_queue(), afterBlock);
    };

    dispatch_after(time, dispatch_get_main_queue(), afterBlock); // start the 'timer' going
} 
```

这将同步到纳秒，并且仅在分钟更改时调用。我相信这是适合您情况的最佳解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:56:43.043

> 可以将计时器的间隔设置为 1 秒，还是会使用比必要更多的资源？

取决于你在做什么。如果您要计算 pi 的前一百万位数字，或渲染数百个 3-D 对象，您将需要每个可以节省的处理器周期。如果 CPU 大部分时间都处于空闲状态，您不妨使用这些周期来使您的界面看起来不错。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T19:41:58.880

```
//Create a timer...
timer = [NSTimer scheduledTimerWithTimeInterval:0.25
                                                 target:self
                                               selector:@selector(tick:)
                                               userInfo:NULL
                                                repeats:YES];
//Function to update time
- (void)tick:(NSTimer*)t
{
    NSDate *now = [NSDate date];
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateFormat:@"HH:mm:ss"];
    NSString *timeString = [dateFormatter stringFromDate:now];
    [uilabel setText:timeString];
} 
```

您的计时器将始终“延迟”一段时间，因为没有“委托”功能可以调用来实现此类功能。

我会坚持使用计时器，但 Richard J. Ross III 提到的调度也是有效的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-29T14:57:39.420

没有 gettimeofday 或块的秒精度同步更新。弱指针并`dispatch_async`防止保留循环。

```
- (void)updateTimeLabel
{
    if (!timeFormatter) {
        timeFormatter = [NSDateFormatter new];
        timeFormatter.dateStyle = NSDateFormatterNoStyle;
        timeFormatter.timeStyle = NSDateFormatterShortStyle;
    }
    NSDate *currentTime = [NSDate date];
    NSTimeInterval delay = [[currentTime nextMinute] timeIntervalSinceDate:currentTime];

    timeLabel.text = [timeFormatter stringFromDate:currentTime];

    __weak id weakSelf = self;
    dispatch_async(dispatch_get_main_queue(), ^{
        [weakSelf performSelector:@selector(updateTimeLabel) withObject:nil afterDelay:delay];
    });
} 
```

用 0 秒获得下一分钟。

```
@implementation NSDate (Utils)
- (NSDate *)nextMinute {
    NSCalendar *calendar = [NSCalendar currentCalendar];

    NSDateComponents *comps = [calendar components:(NSCalendarUnit) NSUIntegerMax fromDate:self];
    comps.minute += 1;
    comps.second = 0;

    return [calendar dateFromComponents:comps];
}
@end 
```

我认为理查德的回答中有一个带有块的保留周期（它可以用 __weak+dispatch_async 修复）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T18:55:38.650

我想我会在后台线程中运行一个延迟 1 秒的 NSTimer，让它运行的方法检查当前时间 (HH:mm) 到标签中显示的当前时间。如果匹配就扔掉，如果是新的，更新标签。

如果您担心性能，在您第一次返回后，找出距离下一分钟还有多少秒，并让它运行计时器运行那么长时间。然后在第一次更新后让计时器以 60 秒的间隔运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-19T18:55:46.273

一秒钟是正确的答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-19T19:05:57.593

也许你可以设置两个定时器。第一个（触发一次）用于同步第二个定时器，间隔为 60s，使其在系统时间到达 HH:00 时触发；

# objective-c - 如何结束使用 detachNewThreadSelector 创建的轮询线程？

> ID：11567396
> 
> 赞同：0
> 
> 时间：2012-07-19T18:50:49.873
> 
> 标签：objective-c, ios, multithreading, nsthread

我正在使用`detachNewThreadSelector` [ref](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsthread_Class/Reference/Reference.html#//apple_ref/occ/clm/NSThread/detachNewThreadSelector:toTarget:withObject:)和`toTarget`self 创建一个新线程。

该线程的目的是轮询运动并在适当的时候加载图像-它循环并且仅当主线程中的原子布尔设置为true时才退出-这是在对象中设置的`dealloc`。

问题是由此引起的（来自 detachNewThreadSelector 参考）：

> aTarget 和 anArgument 对象在分离线程执行期间被保留，然后被释放

这意味着我的对象将始终具有（最小）保留计数 1 - 因为线程不断轮询。`dealloc`因此永远不会被调用。

所以我的问题是：**考虑到轮询线程的存在，我如何释放我的对象？**

我现在唯一的想法是创建一个对象的destroyThread函数，它设置结束线程bool，它将从我希望对象被销毁的任何地方*调用*。这似乎容易出错，有更好的解决方案吗？

提前致谢。

**更新**

我有另一个解决方案的想法 - 在线程中我检测保留计数是否为一 - 如果它是一，那么我知道线程正在保持对象处于活动状态，所以我打破循环并调用 dealloc。这是一个强大的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:12:29.480

首先，避免`detachNewThreadSelector:`。几乎可以肯定，使用调度队列或`NSOperationQueue`. 即使您需要手动创建一个线程（这在现代 ObjC 中极为罕见），最好创建显式`NSThread`对象并保留它们，而不是使用`detachNewThreadSelector:`它创建一个您无法再直接与之交互的线程。

对于特定问题，如果您创建自己的线程，那么您需要将该 bool 设置为`dealloc`. 这意味着程序的其他部分需要告诉您关闭。您不能以这种方式被释放并使用手动线程自动清理自己。

* * *

编辑：永远不要打电话给`retainCount`. 没有涉及的解决方案`retainCount`是一个好的解决方案。撇开`retainCount`在更一般的情况下使用的各种实际问题不谈，在这种情况下，它与您手动引用计数有关。您应该尽快切换到 ARC，并且`retainCount`在 ARC 中是非法的（在 ARC 之前它应该是非法的，但他们终于有了一个很好的借口来强迫这个问题）。如果您无法在 ARC 中实施您的解决方案，那么它不太可能是一个好的解决方案。

同样，最好的解决方案是使用 GCD 调度队列（或操作，通常使用调度队列实现）。对于几乎所有问题，它都比手动线程管理更加高效和有效。

如果您必须为遗留代码使用手动线程并且需要维护这种自动销毁，则解决方案是拥有该线程的辅助对象。您的对象拥有辅助对象，该对象与线程有一个保留循环。当您的对象被释放时，它会告诉线程关闭，从而中断保留循环，并且帮助对象消失。这是管理保留循环的标准方法。

有关更多信息，请参阅 Apple 的[Migrating Away From Threads](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/ThreadMigration/ThreadMigration.html)。

# linux - 移动已编译的 Haskell 程序

> ID：11567399
> 
> 赞同：10
> 
> 时间：2012-07-19T18:51:14.943
> 
> 标签：linux, haskell, ghc

我想在一个 Linux 机器上编译一个 Haskell 程序，然后在另一个 Linux 机器上运行它。但是，这似乎根本不起作用。我收到有关缺少库的错误。

大概当我安装 GHC 时，包管理器也会安装它需要的所有库和东西。[我有些恼火地注意到，至少有一个打包系统无法安装 GCC，而 GHC 显然无法在没有...的情况下运行...] 但是，当然，目标系统没有安装这些依赖项。因此，如果我将编译后的二进制文件复制到目标系统，它就无法运行。

有没有办法解决这个问题？我习惯于使用 Windows，如果您在其中编译某些东西，它只*适用*于所有 Windows 系统。（至少，直到你真正尝试使用非标准工具，如数据库访问或其他东西......）像这样的一些神秘的胡言乱语。

只是为了让事情变得有趣：我只有对目标机器的 FTP 访问权限，而不是 shell 访问权限。我什至不完全确定它运行的是什么操作系统。所以我可以随心所欲地更改我的*构建机器，但除了将文件复制到**目标*机器之外，我无法对目标机器做任何事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T19:12:02.040

在这方面，Linux 的行为与 Windows 类似。如果您在 Linux 上编译 Haskell 可执行文件，它将在任何具有正确库的 Linux 发行版上运行。问题是在 Windows 中，Haskell 可执行文件不是用动态版本的 libgmp 编译的。它们是用静态版本编译的（以便将库编译成可执行文件），这正是因为在分发可执行文件时在 Windows 上处理 dll 非常困难。在 Linux 上安装新库相对容易。

您可以做的是将 libgmp.so.10（可能是指向不同文件的符号链接）从 /usr/lib 复制到与可执行文件相同的目录中。然后，您可以在启动可执行文件之前将 LD_LIBRARY_PATH 环境变量设置为“.”，即当前目录。这将使 Linux 在与其启动的可执行文件相同的目录中查找库，从而找到该库。这可以通过启动器脚本完成：

```
#!/bin/sh
export LD_LIBRARY_PATH=.
`dirname "$0"`/myexecutable "$@" 
```

保存此脚本并将其标记为可执行文件`chmod +x myscript`将使您的可执行文件工作。

您可以使用该`ldd`命令来检查您的可执行文件可能需要哪些其他库并且不在目标系统上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T20:13:05.067

If you wish to move executable between machines, you have to link in statically, making single executable without external library dependencies. How to do it depends on compiler, and ghc has -static flag, that 'links static version of haskell libraries'.

btw, check, that you do not try to run 64-bit executable on 32 bit machine. 32-bit executable on 64 bit machine should work in most cases, but... well, it depends on configuration of target box, so check that this is not the case as well.

# html - 从 HTML 在 Excel 中打开纯文本文件？

> ID：11567406
> 
> 赞同：0
> 
> 时间：2012-07-19T18:51:43.550
> 
> 标签：html, hyperlink

我想创建一个 HTML 页面，其中包含指向在 Excel 中打开的各种文档的链接。问题是文档是纯文本文件。我不希望它们在记事本中打开，而是在 Excel 中打开。有没有办法在 HTML 文档中做到这一点？（使用 JavaScript 很好。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:53:12.100

这由最终用户的操作系统以及默认情况下它如何读取 MIME 类型来处理。这不是您可以在代码中处理的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:04:23.970

我认为没有跨浏览器兼容版本的方法可以做到这一点。事实上，我认为只有在使用 Internet Explorer 时才能这样做，所以在这样做之前，请考虑那些在 Mac 和 Linux 上无法安装最新版本 IE 的用户，或者在 Windows 上不想使用 IE 的用户。但是，使用 Javascript 和 ActiveX 对象，有[这个脚本](http://www.oshyn.com/_blog/Software_Development/post/10_Lines_or_Less_-_Export_HTML_Table_to_Excel/)可以将 HTML 表格更改为 Excel 文件。

# c# - 从文件中删除第一行

> ID：11567410
> 
> 赞同：21
> 
> 时间：2012-07-19T18:52:08.863
> 
> 标签：c#, c++, performance, file, io

> **可能重复：**
> [在 C# 中删除文本文件的第一行](https://stackoverflow.com/questions/7008542/removing-the-first-line-of-a-text-file-in-c-sharp)

从一个巨大的（想想 2-3 GB）文件中删除第一行的最快和最聪明的方法是什么？

*   我认为，您可能无法避免逐块重写整个文件，但我可能错了。

*   可以使用内存映射文件以某种方式帮助解决这个问题吗？

*   是否可以通过直接在文件系统（例如 NTFS）上操作来实现这种行为 - 例如，更新相应的`inode`数据并更改文件起始扇区，从而忽略第一行？如果是，这种方法是否真的很脆弱，或者还有许多其他应用程序，除了它`OS`本身做类似的事情？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-19T19:07:07.800

`NTFS`默认情况下，大多数卷（但重要的是不是全部！）以`4096`字节块的形式存储数据。这些由`$MFT`记录引用，您无法直接编辑，因为操作系统不允许（出于理智的原因）。因此，没有任何技巧可用于对文件系统进行操作以执行您想要的操作（换句话说，您不能直接反向截断 NTFS 上的文件，即使是文件系统块大小的数量。）

由于文件存储在文件系统中的方式，唯一的答案是您必须直接重写整个文件。或者找出一种不同的方式来存储您的数据。一个 2-3GB 的文件是庞大而疯狂的，特别是考虑到您提到的行意味着该数据至少部分是文本信息。

您应该考虑将这些数据放入数据库吗？或者至少更有效地组织它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-19T19:21:16.107

您可以用 覆盖要擦除的每个字符`'\x7f'`。然后，在读取文件时，您的阅读器会忽略该字符。当然，这假设您有一个从不使用该`DEL`字符的文本文件。

```
std::istream &
my_getline (std::istream &in, std::string &s,
            char del = '\x7f', char delim = '\n') {
    std::getline(in, s, delim);
    std::size_t beg = s.find(del);
    while (beg != s.npos) {
        std::size_t end = s.find_first_not_of(del, beg+1);
        s.erase(beg, end-beg);
        beg = s.find(del, beg+1);
    }
    return in;
} 
```

正如 Henk 指出的那样，你可以选择一个不同的角色作为你的`DELETE`. 但是，优点是无论您要删除哪一行（不限于第一行），该技术都有效，并且不需要对文件系统进行处理。

使用修改后的阅读器，您可以定期对文件进行“碎片整理”。或者，当内容被流式传输/合并到不同的文件或归档到不同的机器时，碎片整理可能会自然发生。

**编辑：**您没有明确说出来，但我猜这是针对某种日志记录应用程序，其目标是设置日志文件大小的上限。但是，如果这是目标，那么只使用一组较小的日志文件会容易得多。假设您维护了大约 10MB 的日志文件，总日志限制为 4GB。所以这将是大约 400 个文件。如果启动了第 401 个文件，对于写在那里的每一行，您可以`DELETE`在第一个文件的连续行上使用标记。当所有行都被标记为删除时，可以删除文件本身，再次留下大约 400 个文件。只要在删除行时第一个文件没有关闭，就没有隐藏的 O(n ^(2 ) 行为。)

但更简单的方法是让您的日志系统保持第 1 和 401 文件原样，并在移动到第 402 文件时删除第 1 文件。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-19T19:02:23.730

即使您可以删除前导块，它也至少是一个扇区（512 字节），可能与行的大小不匹配。

考虑一个包装器（甚至可能是一个帮助文件）从某个偏移量开始读取。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-19T19:07:46.313

想法（没有魔法尘埃，只有下面的努力）：

使用用户模式文件系统，例如[http://www.eldos.com/cbfs/](http://www.eldos.com/cbfs/)或[http://dokan-dev.net/en/](http://dokan-dev.net/en/)来包裹你的真实文件系统，并创建一个小型簿记系统来跟踪有多少文件在前面被“吃掉”。在某些时候，当文件变得太大时，将文件重写为另一个文件并重新开始。

那个怎么样？

编辑：

如果您使用虚拟文件系统，那么您可以使用更小的（256mb）文件片段，您可以将它们粘合到一个具有所需偏移量的“虚拟”文件中。这样你就不需要重写文件了。

更多的：

反思用 'nothing' 覆盖前几行的想法 - 不要那样做，而是在文件的前面添加一个 64 位整数，并使用您喜欢的任何方法跳过那么多字节，因为`Stream`将包装原始流并偏移其中的读数的示例推导。

我想如果您选择在“客户端”端使用包装器可能会更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-20T00:45:12.807

将文件一分为二，第一个是较小的块。删除第一行，然后与另一行连接。

# java - 在同一服务器上使用 Java Applet 访问服务器文件

> ID：11567413
> 
> 赞同：0
> 
> 时间：2012-07-19T18:52:19.737
> 
> 标签：java, file-io, applet, streaming

作为一种个人项目，我正在尝试开发一个 Java 小程序，它将从我将托管在与小程序相同的机器上的音乐集合中流式传输。我知道当您在小程序中请求文件时，它会在访问小程序的计算机的文件中查找它们。但是，我想访问与小程序位于同一服务器上的文件。

我的意图是，当客户端想要流式传输特定歌曲时，服务器将开始加载数据并将数据流式传输到客户端。我认为使用 Java 中的 URL 类可以做到这一点，但这不会只是为了回到同一个服务器来获取它的文件而上网吗？或者它会识别出这些文件是本地文件并在不上网的情况下访问它们吗？

**简介：** 小程序访问托管在与其自身相同的服务器上的文件的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:57:43.197

小程序在客户端机器上运行。为了访问文件，您将在服务器端实现功能以将这些文件公开给您的客户端。在 Java 中有多种方法可以做到这一点 - 最常见的是：
1）自定义[servlet](http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/Servlets2.html)或
2）[Web 服务](http://docs.oracle.com/cd/E17802_01/webservices/webservices/docs/2.0/tutorial/doc/)

以下是一些可能有用的文章链接：

*   [Web 服务可以返回流吗？](https://stackoverflow.com/questions/132590/can-a-web-service-return-a-stream)
*   [FileServlet 从绝对路径服务](http://balusc.blogspot.com/2007/07/fileservlet.html)

*顺便说一句，我认为你的问题很广泛。您可能必须调查上述一种或两种方法，尝试实施其中一种，然后带着更具体的问题回到 SO。*

# c++ - 重载 << 运算符错误

> ID：11567415
> 
> 赞同：2
> 
> 时间：2012-07-19T18:52:25.963
> 
> 标签：c++, operator-overloading

我在此运算符重载上遇到错误。这是我得到的错误：

> Angle.cpp:466: 错误：'(+out)->std::basic_ostream<_Elem, _Traits>::operator<< [with _Elem = char, _Traits = std::char_traits ](((const Angle*)this)->Angle::getDegrees()) << "\37777777660"'

这是我的类来重载`<<`运算符

```
#ifndef OUTPUTOPS_H
#define OUTPUTOPS_H 1

#include <ostream>
#include "BoolOut.h"

// Prints the output of an object using cout. The object
// must define the function output()
template< class T >
std::ostream& operator<<(std::ostream& out, const T& x)
{
    x.output(out);

    return out;
}

#endif // OUTPUTOPS_H 
```

问题发生在这里：

```
void Angle::output(std::ostream& out) const
{
    out << getDegrees() << "°";
} 
```

奇怪的是，这不是来自`getDegrees()`字符串而是来自字符串。我尝试将字符串更改为“hello”之类的内容，以确保它不是符号，但我收到了同样的错误。

以下是不相关代码的其余代码：

```
// Angle.h

#include "OutputOps.h"
// End user added include file section

#include <vxWorks.h>
#include <ostream>

class Angle {

public:
    // Default constructor/destructor
    ~Angle();

    // User-defined methods
    //
    // Default Constructor sets Angle to 0.
    Angle();
    //
    ...
    // Returns the value of this Angle in degrees.
    double getDegrees() const;
    ...
    // Prints the angle to the output stream as "x°" in degrees
    void output(std::ostream& out) const;

};

#endif // ANGLE_H

//  File Angle.cpp

#include "MathUtility.h"
#include <math.h>
// End user added include file section

#ifndef Angle_H
#include "Angle.h"
#endif

Angle::~Angle()
{
    // Start destructor user section
    // End destructor user section
}

//
// Default Constructor sets Angle to 0.
Angle::Angle() :
radians( 0 )
{
}

...
//
// Returns the value of this Angle in degrees.
double Angle::getDegrees() const
{
    return radians * DEGREES_PER_RADIAN;
}

//
// Returns the value of this Angle in semicircles.
...

//
// Prints the angle to the output stream as "x°" in degrees
void Angle::output(std::ostream& out) const
{
    out << getDegrees() << "°";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:00:50.437

这是因为你在重载的 operator<< 中使用了模板，但这个重载不在类中，所以你不能设置 typename T。换句话说，你必须为你想要的每种类型的变量重载 operator<<在也是模板的类中使用或重载此运算符。例如：

```
std::ostream& operator<<(std::ostream& out, const Angle& x)
{
    x.output(out);

    return out;
} 
```

此错误意味着编译器无法预测将在那里使用哪种变量。

* * *

您为所有可能的数据重载此运算符，因此当您传递返回 double 的 getDegrees() 函数时，我不认为 x.output(out); 会工作;）（提示 x 将是双倍的）

# git - git子模块更新和身份验证

> ID：11567418
> 
> 赞同：2
> 
> 时间：2012-07-19T18:52:34.410
> 
> 标签：git, git-submodules

我刚刚开始使用 git，就像这一秒一样。我被邀请使用一个包含 som 子模块的项目，并且通过我的 github 帐户获得了许可。当我克隆 repo 时，我遇到了一些错误：

```
git submodule init
Submodule 'js/Common/enginelite' (git@github.com:clientName/EngineLite.git) registered for path 'js/Common/enginelite' 
```

到目前为止看起来不错...

```
git submodule update
Cloning into 'js/Common/enginelite'...
Permission denied (publickey).
fatal: The remote end hung up unexpectedly 
```

所以我的问题是......在此期间有没有办法传递凭据？有什么我必须在本地或在 github 上做的吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T03:26:26.683

查看`js/Common/enginelite`是否有一个名为 .git 的目录编辑文本文件`.git/config`。如果有一个名为 .git 的文件，它将有一行读取 'gitdir: ...' 查找该目录并在`config`那里编辑文件。希望文件的内容会告诉您可以在哪里添加您的用户名@。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:01:53.277

由于子模块是一个单独的 git 存储库，我最好的猜测是您需要通过您的 github 帐户获取权限才能访问主 git 存储库 EngineLit.git

我猜权限不是由子模块继承的。

# android - 在 Android 中创建 .nonmedia 文件不起作用

> ID：11567423
> 
> 赞同：0
> 
> 时间：2012-07-19T18:52:44.357
> 
> 标签：android, file, sd-card

我的应用程序从 sd 卡创建和使用一些图像。这些图像显示在设备的图库中，但我不希望这样。所以我试图在这个目录中创建一个 .nonmedia 文件，但我的问题是这个文件不会被创建。

继承人的代码：

```
public void createNonmediaFile(){
    String text = "NONEMEDIA";
    String path = Environment.getExternalStorageDirectory().getPath() + "/" +  AVATARS + "/.nonmedia";
    FileOutputStream fos;
    try {
        fos = new FileOutputStream(path);
        fos.write(text.getBytes());
        fos.close();
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

没有例外。

我想这与“。”有关。在名字里。如果我尝试相同的方法，则会创建文件。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:58:21.130

尝试使用以下示例

```
 File file = new File(directoryPath, ".nomedia");
    if (!file.exists()) {
        try {
            file.createNewFile();
        }
        catch(IOException e) {

        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:08:09.257

在您的 android-manifest 文件中添加以下权限：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

然后下面的代码应该可以正常工作：

```
private static final String AVATARS = "avatars";
public void createNonmediaFile(){
    String text = "NONEMEDIA";
    String path = Environment.getExternalStorageDirectory().getPath() + "/" +  AVATARS + "/.nonmedia";
    String f = Environment.getExternalStorageDirectory().getPath() + "/" +  AVATARS ;
    FileOutputStream fos;
    try {
        File folder = new File(f);
        boolean success=false;
        if (!folder.exists()) {
            success = folder.mkdir();
        }
        if (true==success) {
            File yourFile = new File(path);
            if(!yourFile.exists()) {
                yourFile.createNewFile();
            } 
        } else {
        // Do something else on failure 
        }
        fos = new FileOutputStream(path);
        fos.write(text.getBytes());
        fos.close();
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

# .htaccess - 1&1 服务器上的访问被拒绝

> ID：11567424
> 
> 赞同：3
> 
> 时间：2012-07-19T18:52:46.347
> 
> 标签：.htaccess, upload, hosting, http-status-code-404

我在 1&1 服务器上托管网站时遇到问题（购买的软件包是 SmartWeb M）。我将所有内容上传到 public_html 文件夹（在你问之前 - 是的，index.html 位于文档根目录中，而不是子文件夹之一）。然后，当我尝试在浏览器中调用该页面时，出现以下错误：

禁止的

您无权访问此服务器上的 /index.html。

此外，在尝试使用 ErrorDocument 处理请求时遇到 404 Not Found 错误。

因为我在正手牌上找不到任何 .htaccess，所以我创建了一个，希望能解决它 - 什么也没有。3 多天以来，我一直在等待 1 和 1 帮助台的答复，我对他们的服务感到有点生气。

谁能帮我解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T19:37:36.647

事实证明，我的文件确实有错误的权限。确保让它们达到-755！

# r - 在R中提取自组织地图的bin属性

> ID：11567425
> 
> 赞同：2
> 
> 时间：2012-07-19T18:52:59.093
> 
> 标签：r, cluster-analysis, som

我正在尝试在 R 编程中使用 SOM 对大量数据进行聚类。示例代码在这里：

```
> library("kohonen")
> data("wines")
> wines.sc <- scale(wines)
> set.seed(7)
> wine.som <- som(data = wines.sc, grid = somgrid(5, 4, "hexagonal"))
> plot(wine.som, main = "Wine data") 
```

现在我有两个问题：

1.  如何提取 bin 属性以找出每一行数据属于哪个 bin？（例如，我想知道每个葡萄酒数据行属于哪个 bin）。
2.  如何保存 SOM 并在新数据集上对其进行测试？

# azure - Azure 上的类似 PiCloud 的服务？

> ID：11567428
> 
> 赞同：1
> 
> 时间：2012-07-19T18:53:09.660
> 
> 标签：azure

我正在寻找类似于 PiCloud 的 Windows Azure 上的执行环境：

1.  排队的工作
2.  CPU 以小增量充电（PiCloud 为 1ms）

有人知道这样的服务吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:18:45.507

不失手。Windows Azure 更像亚马逊，因为您可以获得按小时计费的专用 VM。我不相信有人已经在它上面创建了一个多租户工作处理框架，他能够收回花费在客户工作上的时间。

不过，对于初创公司来说，这听起来像是一个有趣的想法。:)

# python - 从 beanstalkd 获取工作 - 超时异常

> ID：11567431
> 
> 赞同：0
> 
> 时间：2012-07-19T18:53:14.337
> 
> 标签：python, timeout, jobs, beanstalkd, beanstalkc

我正在使用`Python 2.7`, `beanstalkd server`with `beanstalkc`作为客户端库。

处理每个作业大约需要 500 到 1500 毫秒，具体取决于作业的大小。

我有一份`cron`工作将继续向 beanstalkd 队列添加工作，还有一个“工人”将在无限循环中运行，获取工作并处理它们。

例如：

```
def get_job(self):
    while True:
        job = self.beanstalk.reserve(timeout=0)
        if job is None:
            timeout = 10 #seconds
            continue
        else:
            timeout = 0 #seconds
            self.process_job(job) 
```

这导致`"timed out"`异常。

这是从队列中拉出作业的最佳做法吗？

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T22:57:07.300

调用`beanstalk.reserve(timeout=0)`意味着等待 0 秒让作业变得可用，因此它会立即超时，除非作业在被调用时已经在队列中。如果您希望它永远不会超时，请使用`timeout=None`（或省略 timeout 参数，因为`None`它是默认值）。

# c++ - curand，推力：：随机

> ID：11567432
> 
> 赞同：0
> 
> 时间：2012-07-19T18:53:16.030
> 
> 标签：c++, cuda

我想在 .cu 格式文件中使用 drand48 获得随机统一数，为什么我总是给我 3.90799e-14 这个值

我的代码在 ran_uniform_test.cu

```
#include <iostream>
int main( int argc, char** argv) 
{ 
    std::cout<<drand48()<<"\n"; 
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:17:03.473

您应该在使用之前调用[`srand48`](http://pubs.opengroup.org/onlinepubs/007908799/xsh/srand48.html)（或`seed48`，或） ：`lcong48`[`drand48`](http://pubs.opengroup.org/onlinepubs/007908799/xsh/drand48.html)

> srand48()、seed48() 和 lcong48() 是初始化入口点，其中一个应在调用 drand48()、lrand48() 或 mrand48() 之前调用。（虽然不建议这样做，但如果在没有事先调用初始化入口点的情况下调用 drand48()、lrand48() 或 mrand48()，则会自动提供常量默认初始化值。） erand48()、nrand48() 和jrand48() 函数不需要首先调用初始化入口点。

像这样使用：

```
#include <iostream>
#include <ctime>
#include <cstdlib>

int main(int argc, char *argv[])
{
    // A common random seed strategy is to use the current time
    srand48(time(NULL));

    std::cout << drand48() << std::endl;
    std::cout << drand48() << std::endl;
    std::cout << drand48() << std::endl;
    std::cout << drand48() << std::endl;

    return 0;
} 
```

# ms-access - 如果值为空，QRY 返回错误？

> ID：11567433
> 
> 赞同：2
> 
> 时间：2012-07-19T18:53:18.540
> 
> 标签：ms-access

我正在运行以下表达式来比较 2 个日期的差异。如果两个日期都在单元格中，我希望它返回 0，但如果 Date2 为空白，我希望显示差异。现在，如果 date2 中没有日期，我只会得到 #ERROR。任何想法将不胜感激。

```
expr2: NetWorkDays([Date1],[Date2])

Option Compare Database 

Public Function NetWorkdays(dteStart As Date, dteEnd As Date) As Integer 

Dim intGrossDays As Integer 
Dim dteCurrDate As Date 
Dim i As Integer 

intGrossDays = DateDiff("d", dteStart, dteEnd) 
NetWorkdays = 0 

For i = 0 To intGrossDays 
dteCurrDate = dteStart + i 
If Weekday(dteCurrDate, vbMonday) < 6 Then 
End If 
Next i 

End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:01:07.860

如果您不`NetWorkdays = 0`从函数中删除 ，该函数将始终返回 0 ，并且如果您不在 if 语句中将调用函数的位置换行，您将继续收到错误，如下所示：

```
If Not IsNull(Date2) Then
txtResult = NetWorkdays(Date1, Date2)
Else
txtResult = 0
End If 
```

txtResult 是您要在其中显示结果的文本框。

您可能想查看此链接[http://msdn.microsoft.com/en-us/library/bb258196(v=office.12).aspx](http://msdn.microsoft.com/en-us/library/bb258196(v=office.12).aspx)。这是一个设计用于计算两个日期之间的工作日数的函数。

使用这个函数，你应该得到你想要的结果，如下所示：

```
If Not IsNull(Date2) Then
txtResult = 0
Else
txtResult = Work_Days(Date1, Now())
End If 
```

# sql-server-2008 - 使用 openxml 获取祖先标签名称

> ID：11567440
> 
> 赞同：0
> 
> 时间：2012-07-19T18:53:49.360
> 
> 标签：sql-server-2008, openxml

我正在尝试使用 sql server 2008 中的 open xml 获取祖先标签名称。这是我到目前为止所尝试的：

```
SELECT * FROM OPENXML(@idoc, '/Envelope/Body/*/TagParent/Tag')
WITH (
    [Name]    varchar(max) '../@mp:parentLocalName'
) 
```

我需要获取第三个标签的名称，*。我可以成功运行 parentlocalname 和 localname，但对父母的父母没有任何作用。我已经尝试了上面的许多变体，它只是错误地说没有定义命名空间 mp。是否甚至可以获取该名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:16:23.813

这有点笨拙，但应该可以工作，`../../.`您要寻找的父母的路径在哪里。

```
SELECT Name.value('local-name((*)[1])','nvarchar(100)') 
FROM OPENXML(@idoc, '/Envelope/Body/*/TagParent/Tag')
WITH (
    [Name]    xml '../../.'
) 
```

[工作示例。](https://data.stackexchange.com/stackoverflow/query/75716)

# r - car::Anova 获得不与主体内因素相互作用的协变量的方法

> ID：11567446
> 
> 赞同：3
> 
> 时间：2012-07-19T18:54:00.723
> 
> 标签：r, anova

我想使用 ANCOVA 运行，`car::Anova`但无法确定是否有办法仅将协变量添加为主要效果（即，不应与任何东西交互）。

据我了解 ANCOVA，协变量只是添加到模型中的另一个主要效应（即，另一个效应），从而控制该协变量的整体加性影响。接下来，协变量不与其他因素相互作用。但是，我不能添加`Anova`不与主体内因素相互作用的变量（即，我的最终模型似乎不是 ANCOVA）。

让我用一个例子来说明我的问题`?Anova`。`OBrienKaiser`数据集在 (`treatment`和`gender`) 之间有 2 个，在 (和`phase`)`hour`因子内有 2 个。现在假设我们还记录了`age`参与者的 ，并希望将其作为协变量添加到任何分析中。

```
require(car)
set.seed(1)

n.OBrienKaiser <- within(OBrienKaiser, age <- sample(18:35, size = 16, replace = TRUE))

# the next part is taken from ?Anova
# I only modified the mod.ok <- ... call by adding + age
phase <- factor(rep(c("pretest", "posttest", "followup"), c(5, 5, 5)), levels=c("pretest", "posttest", "followup"))
hour <- ordered(rep(1:5, 3))
idata <- data.frame(phase, hour)

mod.ok <- lm(cbind(pre.1, pre.2, pre.3, pre.4, pre.5, post.1, post.2, post.3, post.4, post.5, 
          fup.1, fup.2, fup.3, fup.4, fup.5) ~  treatment*gender + age, data=n.OBrienKaiser)
(av.ok <- Anova(mod.ok, idata=idata, idesign=~phase*hour, type = 3)) 
```

如结果所示，结果包含与协变量的交互作用`age`，即主体内（或重复测量）因素`phase`及其`hour`交互作用`phase:hour`：

```
Type III Repeated Measures MANOVA Tests: Pillai test statistic
                            Df test stat approx F num Df den Df Pr(>F)  
(Intercept)                  1     0.129     1.33      1      9  0.278  
treatment                    2     0.443     3.58      2      9  0.072 .
gender                       1     0.305     3.95      1      9  0.078 .
age                          1     0.054     0.52      1      9  0.490  
treatment:gender             2     0.222     1.28      2      9  0.323  
phase                        1     0.418     2.87      2      8  0.115  
treatment:phase              2     0.871     3.47      4     18  0.029 *
gender:phase                 1     0.084     0.37      2      8  0.703  
age:phase                    1     0.393     2.59      2      8  0.136  
treatment:gender:phase       2     0.545     1.69      4     18  0.197  
hour                         1     0.565     1.95      4      6  0.222  
treatment:hour               2     0.580     0.72      8     14  0.676  
gender:hour                  1     0.310     0.68      4      6  0.633  
age:hour                     1     0.508     1.55      4      6  0.301  
treatment:gender:hour        2     0.707     0.96      8     14  0.504  
phase:hour                   1     0.975     9.56      8      2  0.098 .
treatment:phase:hour         2     1.145     0.50     16      6  0.873  
gender:phase:hour            1     0.693     0.56      8      2  0.770  
age:phase:hour               1     0.974     9.40      8      2  0.100 .
treatment:gender:phase:hour  2     1.314     0.72     16      6  0.723  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 
```

我的问题是：是否**可以运行 ANCOVA，`car::Anova`如果可以，是否可以指定此 ANCOVA 而无需任何交互`age`？**

* * *

**更新**（2012 年 7 月 22 日）：我在[R-help](http://thread.gmane.org/gmane.comp.lang.r.general/270226)上问过这个问题，但到目前为止没有任何回应。如果有消息，我会在这里发布。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T13:45:50.617

我在 R-help 上问了这个问题，这开始了与 John Fox（后来由 Peter Dalgaard 加入）的有益讨论。不幸的是，它被分成了两个线程：[一](http://thread.gmane.org/gmane.comp.lang.r.general/270226)，[二](http://thread.gmane.org/gmane.comp.lang.r.general/270271/focus=270275)。

妙语是：“对象内对比由 Anova() 构造为在设计的行基础上是正交的，因此您应该能够安全地忽略（由于某种原因让我无法理解）您的影响不感兴趣。” （约翰福克斯）

所以这个问题的答案是：**没有人不能，但这没关系，因为这些相互作用不会改变其他影响，因为它们是正交的。**

# windows-8 - WinJS 共享目标重定向

> ID：11567458
> 
> 赞同：0
> 
> 时间：2012-07-19T18:54:42.403
> 
> 标签：windows-8, winjs

在 WinJS 中，是否可以在使用共享魅力激活页面后重定向页面？

所以我的目标页面是/pages/target/target.html。在 .js 中，我想做类似的事情；

`WinJS.Navigation.navigate("/pages/anotherpage/anotherpage.html");`

它似乎没有引发错误，但它没有离开目标页面。

我想根据用户输入重定向页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:20:50.050

这类似于另一个问题： [How to navigate between different html pages in Windows 8 Metro application using javascript?](https://stackoverflow.com/questions/11559490/how-to-navigate-between-different-html-pages-in-windows-8-metro-application-usin/11563958#11563958)

但是，如果您实际上正在执行页面导航（例如 window.location 更改），那么您将面临共享内容的激活信息将不可用的挑战；您的脚本上下文在页面导航上被拆除，因此您将无法轻松抓住它。

# android - 阻止应用程序安装

> ID：11567460
> 
> 赞同：0
> 
> 时间：2012-07-19T18:54:44.283
> 
> 标签：android, installation, sleep

我正在寻找一种方法来停止安装 Android 应用程序。下载后使其休眠或阻止安装的东西。基本上，我正在尝试找到一种方法来做到这一点，以便我可以检查的另一个程序是恶意软件。Android系统中有什么可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:54:43.773

> Android系统中有什么可以做到这一点吗？

幸运的是，没有，出于明显的安全原因。欢迎您创建自己的 ROM mod，其中包含包含您的代码的修订版 Android，并集成到软件包安装过程中。

# javascript - Dojo 无模式警报显示

> ID：11567462
> 
> 赞同：0
> 
> 时间：2012-07-19T18:54:52.327
> 
> 标签：javascript, dojo

我正在尝试使用 Dojo 显示一个警报框。警报框行为将是无模式的。所有工作都是通过具有 addScript/CSS 功能的 Javascript 完成的，这些功能可以正常工作。虽然我不能使用 Dojo 显示警报。这是我的代码：

//Dojo 主题和库

```
addStylesheet('http://ajax.googleapis.com/ajax/libs/dojo/1.5/dijit/themes/claro/claro.css');
    addStylesheet('http://ajax.googleapis.com/ajax/libs/dojo/1.5/dijit/themes/tundra/tundra.css');
    addScript('http://ajax.googleapis.com/ajax/libs/dojo/1.5/dojo/dojo.js');

    //dojo.require("dojo.ready");
    //dojo.require("dijit.Dialog");

    var dojoDialogBox = document.createElement('script');
    dojoDialogBox.innerHTML = 'require(["dojo/ready", "dijit/Dialog"], function(ready, Dialog){ ready(function(){ myDialog = new Dialog({ title: "My Dialog", content: "Test content.", style: "width: 300px" }); }); });';
    document.getElementsByTagName('head')[0].appendChild(dojoDialogBox);

    function myFuncc() {
        myDialog.show();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T13:06:18.153

```
<script>
  addStylesheet('http://ajax.googleapis.com/ajax/libs/dojo/1.5/dijit/themes/claro/claro.css');
  addStylesheet('http://ajax.googleapis.com/ajax/libs/dojo/1.5/dijit/themes/tundra/tundra.css');
  addScript('http://ajax.googleapis.com/ajax/libs/dojo/1.5/dojo/dojo.js');
</script>
<!--
     closing script tag here will allow dojo.js script 
     tag to get written - otherwise
     'require' is an undefined
-->
<script>
  require(["dijit/Dialog", "dojo/domReady!"], function(Dialog){
    myDialog = new Dialog({
         title: "My Dialog",

         // since we are inside a require(function() {}) closure, lets set an ID
         // so that externally (from outside this require function) we can get the dialog

         id:'myDialog',
         content: "Test content.",
         style: "width: 300px"
    });
  });
  function myFuncc() {
      dijit.byId('myDialog').show();
  }
</script> 
```

# ios - 在滚动视图上有效地添加多个子视图

> ID：11567468
> 
> 赞同：0
> 
> 时间：2012-07-19T18:55:28.340
> 
> 标签：ios, views

如果我们需要在单个可滚动屏幕上添加多个视图，比如一个 tableview、一个 mapview 和 2 或 3 个视图，那么最有效的方法是什么？从内存管理的角度来看，它是否适合应用程序？请分享你的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:34:59.760

以下是您可以通过编程方式执行此操作的方法：只需将它们添加到您的 viewDidLoad（或者可能是您的 viewWillAppear）方法中。

```
- (void) viewWillLoad
{
    self.myScrollView = [[UIScollView alloc] init];
    //Configure scrollview here (frame, contentsize, contentoffset...etc)

    UITableView *table = [[UITableView alloc] init];
    //Configure table here (frame...etc)

    [self.myScrollView addSubview:tableView];
    //Continue adding other subviews here
} 
```

或者，您可以使用情节提要直观地做到这一点。只需将您想要的视图拖到故事板上，然后 cntrl 拖到您的 .m 或 .h 文件。

是的，iOS 设计用于一次显示多个视图。这是合适的。

# javascript - IE 9 jQuery 未设置输入值

> ID：11567469
> 
> 赞同：1
> 
> 时间：2012-07-19T18:55:35.060
> 
> 标签：javascript, jquery, input, internet-explorer-9, file-io

我的问题很简单：

我有一个输入文件字段，我想将其限制为仅通过 Jquery 接受 .GIF，如果格式错误，请将输入值设置为空白。

问题是在 IE9 上，`.val('')`不起作用。有任何想法吗？

我的 jQuery：

```
$('input[type=file]').change(function() {
    var val = $(this).val();
    switch (val.substring(val.lastIndexOf('.') + 1).toLowerCase()) {
    case 'gif':
        break;
    default:
        // error message here
        alert("Wrong Format");
        $(this).val('');
        break;
    }
});​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:03:04.510

从 IE8 开始，它是只读的尝试：

```
$("input[type='file']").replaceWith($("input[type='file']").clone(true)); 
```

从这里挑选： [SO Anwser](https://stackoverflow.com/questions/10327860/empty-input-type-file-doesnt-work-in-ie)

# ruby-on-rails - 乘客错误：没有这样的文件或目录 - config/environment.rb

> ID：11567475
> 
> 赞同：1
> 
> 时间：2012-07-19T18:55:51.000
> 
> 标签：ruby-on-rails, ruby-on-rails-3, apache, ubuntu, passenger

我正在尝试将我的第一个 Rails 应用程序部署到使用 Capistrano 部署的 Ubuntu/Apache/Passenger 服务器上。我已经设置了一个虚拟主机来指向一个目录，我的所有 Rails 应用程序都将存在：

这是我的虚拟主机文件：

```
<VirtualHost *:80>
    ServerName rails.mydomain.com
    ServerAlias rails.mydomain.com
    DocumentRoot /var/www/vhosts/rails.mydomain.com
    <Directory /var/www/vhosts/rails.mydomain.com>
            Allow from all
            AllowOverride all
            Options -MultiViews -Indexes
    </Directory>

    # PassengerAppRoot /var/www/vhosts/rails.mydomain.com
    RailsBaseURI /myappname
    # RailsBaseURI /myappname2
    # RailsBaseURI /myappname3

    Include /etc/apache2/production-expires.conf
    CustomLog /var/log/apache2/rails.mydomain.com-access_log common
    ErrorLog /var/log/apache2/rails.mydomain.com-error_log
</VirtualHost> 
```

加载 rails 应用程序（rails.mydomain.com/myappname）后，我得到：

```
Error message:
     No such file or directory - config/environment.rb
Exception class:
    Errno::ENOENT
Application root:
    /var/www/vhosts/rails.mydomain.com 
```

config/environment.rb 在那里，我在运行 cap deploy 后通过 SSH 验证了它的存在。

所以我错过了什么，我觉得有些东西没有正确指向，你可以看到应用程序根指向我的 /rails.mydomain.com 文件夹，而不是实际的 /rails.mydomain.com/myappname 文件夹。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T17:26:39.580

您是否将 myappname 符号链接到应用程序的公共目录？

```
ln -s /path/to/the/myappname/public/ /var/www/vhosts/rails.mydomain.com/myappname 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:24:31.443

根据[乘客文档](http://www.modrails.com/documentation/Users%20guide%20Apache.html)（请参阅“3.1\. 部署到虚拟主机的根目录”），您需要将 DocumentRoot 设置为应用程序的公共目录。尝试这个：

```
DocumentRoot /var/www/vhosts/rails.mydomain.com/public
<Directory /var/www/vhosts/rails.mydomain.com/public>
            Allow from all
            Options +MultiViews
</Directory> 
```

# php - 自定义 joomla 模块以显示类别列表布局

> ID：11567479
> 
> 赞同：0
> 
> 时间：2012-07-19T18:56:05.210
> 
> 标签：php, joomla, joomla2.5

您好我想构建一个显示类别文章的模块（不幸的是我不能使用本机模块，因为这些类别有其他前缀）。类似于原生的 joomla 模块。

我知道如何连接到表

```
$db =& JFactory::getDBO(); 
```

查询有效：

```
$query = "SELECT title FROM rsc_content WHERE catid=68"; 
```

可能会在（？）之后发生的事情：

```
$db->setQuery($query); 
```

然后我不知道......有什么想法吗？

（我有一个代码可以使用 joomla 代码检索一篇文章：

```
<?php $db =& JFactory::getDBO(); 
$query = "SELECT introtext FROM rsc_content WHERE id=49 ";
$db->setQuery($query);
$text= $db->loadResult();
echo $text;
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T06:41:30.407

首先从数据库中获取您需要的内容：

```
<?php 
$db =& JFactory::getDBO(); 
$db->setQuery("SELECT title FROM rsc_content WHERE catid=68");
$list= $db->loadResultArray(); 
```

然后遍历结果列表并显示内容：

```
foreach($list as $title) {
  echo $title . "<br />";
} 
```

# amazon-ec2 - IAM 角色临时凭证可以在 cloudformation 模板中使用吗？

> ID：11567480
> 
> 赞同：11
> 
> 时间：2012-07-19T18:56:11.933
> 
> 标签：amazon-ec2, amazon-web-services, amazon-iam, amazon-cloudformation, cloud-init

我正在构建一个需要访问私有 S3 存储桶以下载我的应用程序的最新版本的堆栈。我正在使用[IAM 角色](https://stackoverflow.com/questions/11365730/how-can-i-securely-download-a-private-s3-asset-onto-a-new-ec2-instance-with-cl)，这是一项相对较新的 AWS 功能，它允许为 EC2 实例分配特定角色，然后将这些角色与 IAM 策略相结合。不幸的是，这些角色带有在实例化时生成的临时 API 凭证。这不是很严重，但它迫使我做这个 cloud-init 脚本之类的事情（简化为相关位）：

```
#!/bin/sh

# Grab our credentials from the meta-data and parse the response
CREDENTIALS=$(curl -s http://169.254.169.254/latest/meta-data/iam/security-credentials/s3access)
S3_ACCESS_KEY=$(echo $CREDENTIALS | ruby -e "require 'rubygems'; require 'json'; puts JSON[STDIN.read]['AccessKeyId'];")
S3_SECRET_KEY=$(echo $CREDENTIALS | ruby -e "require 'rubygems'; require 'json'; puts JSON[STDIN.read]['SecretAccessKey'];")
S3_TOKEN=$(echo $CREDENTIALS | ruby -e "require 'rubygems'; require 'json'; puts JSON[STDIN.read]['Token'];")

# Create an executable script to pull the file
cat << EOF > /tmp/pullS3.rb
require 'rubygems'
require 'aws-sdk'
AWS.config(
    :access_key_id     => "$S3_ACCESS_KEY",
    :secret_access_key => "$S3_SECRET_KEY",
    :session_token     => "$S3_TOKEN")
s3 = AWS::S3.new()
myfile = s3.buckets['mybucket'].objects["path/to/my/file"]
File.open("/path/to/save/myfile", "w") do |f|
    f.write(myfile.read)
end
EOF

# Downloading the file
ruby /tmp/pullS3.rb 
```

首先也是最重要的：这很有效，而且效果很好。尽管如此，我很想使用 CloudFormation 对源访问的现有支持。具体来说，[`cfn-init`](http://docs.amazonwebservices.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html#aws-resource-init-sources)支持使用[身份验证资源](http://docs.amazonwebservices.com/AWSCloudFormation/latest/UserGuide/aws-resource-authentication.html)来获取受保护的数据，包括 S3 存储桶。无论如何可以从内部获取这些密钥`cfn-init`，或者可能将 IAM 角色绑定到身份验证资源？

我想另一种选择是将我的来源放在其他经过身份验证的服务之后，但目前这不是一个可行的选择。

另一个有希望的线索是[AWS::IAM::AccessKey 资源，](http://docs.amazonwebservices.com/AWSCloudFormation/latest/UserGuide/quickref-iam.html#scenario-iam-accesskey)但文档不建议它可以与角色一起使用。反正我要试试。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-26T11:59:56.647

我不确定何时添加了支持，但您可以同时使用 IAM 角色来验证[AWS::CloudFormation::Init](http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-init.html)`files`中的 S3 下载和`sources`部分。

只需使用[`roleName`](http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-authentication.html#cfn-cloudformation-authentication-rolename)而不是`accessKeyId`& `secretKey`（有关详细信息，请参阅[AWS::CloudFormation::Authentication](http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-authentication.html)），例如：

```
"Metadata": {
    "AWS::CloudFormation::Init": {
        "download": {
            "files": {
                "/tmp/test.txt": {
                    "source": "http://myBucket.s3.amazonaws.com/test.txt"
                }
             }
        }
    },
    "AWS::CloudFormation::Authentication": {
        "default" : {
            "type": "s3",
            "buckets": [ "myBucket" ],
            "roleName": { "Ref": "myRole" }
        }
    }
} 
```

经测试`aws-cfn-bootstrap-1.3-11`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T11:11:40.640

我设法让这个工作。我使用的是来自此交换的代码： [https ://forums.aws.amazon.com/message.jspa?messageID=319465](https://forums.aws.amazon.com/message.jspa?messageID=319465)

该代码不使用 IAM 策略，而是使用 AWS::S3::BucketPolicy。

云形成代码片段：

```
"Resources" : {     

"CfnUser" : {
  "Type" : "AWS::IAM::User",
  "Properties" : {
    "Path": "/",
    "Policies": [{
      "PolicyName": "root",
      "PolicyDocument": { "Statement":[{
        "Effect"   : "Allow",
        "Action"   : [
          "cloudformation:DescribeStackResource",
          "s3:GetObject"
        ],
        "Resource" :"*"
      }]}
    }]
  }
},

"CfnKeys" : {
  "Type" : "AWS::IAM::AccessKey",
  "Properties" : {
    "UserName" : {"Ref": "CfnUser"}
  }
},

"BucketPolicy" : {
  "Type" : "AWS::S3::BucketPolicy",
  "Properties" : {
    "PolicyDocument": {
      "Version"      : "2008-10-17",
      "Id"           : "CfAccessPolicy",
      "Statement"    : [{
        "Sid"        : "ReadAccess",
        "Action"     : ["s3:GetObject"],
        "Effect"     : "Allow",
        "Resource"   : { "Fn::Join" : ["", ["arn:aws:s3:::<MY_BUCKET>/*"]]},
        "Principal"  : { "AWS": {"Fn::GetAtt" : ["CfnUser", "Arn"]} }
      }]
    },
    "Bucket" : "<MY_BUCKET>"
  }
},

"WebServer": {  
  "Type": "AWS::EC2::Instance",
  "DependsOn" : "BucketPolicy",
  "Metadata" : {

    "AWS::CloudFormation::Init" : {
      "config" : {

        "sources" : {
          "/etc/<MY_PATH>" : "https://s3.amazonaws.com/<MY_BUCKET>/<MY_FILE>"
        }

      }
    },

    "AWS::CloudFormation::Authentication" : {
      "S3AccessCreds" : {
        "type" : "S3",
        "accessKeyId" : { "Ref" : "CfnKeys" },
        "secretKey" : {"Fn::GetAtt": ["CfnKeys", "SecretAccessKey"]},
        "buckets" : [ "<MY_BUCKET>" ]
      }
    }
  },

  "Properties": {
    "ImageId" : "<MY_INSTANCE_ID>", 
    "InstanceType" : { "Ref" : "WebServerInstanceType" },
    "KeyName" : {"Ref": "KeyName"},
    "SecurityGroups" : [ "<MY_SECURITY_GROUP>" ],

    "UserData"       : { "Fn::Base64" : { "Fn::Join" : ["", [
      "#!/bin/bash\n",

      "# Helper function\n",
      "function error_exit\n",
      "{\n",
      "  cfn-signal -e 1 -r \"$1\" '", { "Ref" : "WaitHandle" }, "'\n",
      "  exit 1\n",
      "}\n",

      "# Install Webserver Packages etc \n",
      "cfn-init -v --region ", { "Ref" : "AWS::Region" },
      "    -s ", { "Ref" : "AWS::StackName" }, " -r WebServer ",
      "         --access-key ", { "Ref" : "CfnKeys" },
      "         --secret-key ", {"Fn::GetAtt": ["CfnKeys", "SecretAccessKey"]}, " || error_exit 'Failed to run cfn-init'\n",

      "# All is well so signal success\n",
      "cfn-signal -e 0 -r \"Setup complete\" '", { "Ref" : "WaitHandle" }, "'\n"

    ]]}}        
  }
} 
```

显然用您的值替换 MY_BUCKET、MY_FILE、MY_INSTANCE_ID、MY_SECURITY_GROUP。

# javascript - 你能从方法外部识别事件的调用者吗？

> ID：11567483
> 
> 赞同：1
> 
> 时间：2012-07-19T18:56:22.173
> 
> 标签：javascript, jquery

一些神秘的东西正在隐藏一个 div，我不知道它是什么。

我很好奇是否有办法绑定被隐藏的 div，记录导致它被隐藏的原因。

通过这种方式，我可以看到我的问题的根源在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:40:55.643

您最喜欢的浏览器调试器（javascript 开发者控制台，通常通过 提供`F12`）将允许您为事件侦听器设置断点。

# ruby-on-rails - 根据数字列验证用户输入，如果为真则发送到购物车

> ID：11567484
> 
> 赞同：0
> 
> 时间：2012-07-19T18:56:26.227
> 
> 标签：ruby-on-rails, ruby

我在此列值中询问[了输入数据库的问题？](https://stackoverflow.com/questions/11565420/column-value-for-input-into-database) 但还是不明白！我有一个报价项目，我试图让用户在此页面上看到报价输入框。

用户在表格中输入一个数字，然后根据数据库中称为底价的列进行验证

这是我尚未完成的验证，我试图弄清楚我需要做什么才能为 tommrow 完成此操作，我不知道如何将它们放在一起。

```
class Reserve_price < ActiveRecord::Base
  belongs_to :line_item

  validate :ensure_meets_reserve_price

  private
  def ensure_meets_reserve_price
    if amount < self.line_item.reserve_price
      errors.add(:amount, "does not meet reserve price")
    end
  end

end 
```

# javascript - 如何验证 ssl 没有通过浏览器中的代理等拦截？

> ID：11567486
> 
> 赞同：1
> 
> 时间：2012-07-19T18:56:35.760
> 
> 标签：javascript, validation, ssl, https, certificate

最近我安装了 fiddler，它确实允许我从任何浏览器查看（解密）我的 Ssl 请求。

虽然它不合法，但一些防火墙还允许安装一些根证书，然后防火墙可以监控和跟踪 https 协议。

我们通过 ssl 提供敏感信息，以及如何通过代理或提琴手之类的工具检查和防止此类拦截。

有 JavaScript API 吗？应该有一些东西，我可以检查页面加载。

```
$( function() {
    if(!isSSLValid())
    {
        alert('Your traffic is monitored...');
        location.href = '/SSLInstructions.html';
    }
}); 
```

将其视为移动或标签浏览器，在 iOS 中无法查看证书，只有一个图标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:21:24.670

[（这与Security.SE 上的这个问题](https://security.stackexchange.com/q/16293/2435)非常相似。）

作为客户端，您可以通过检查其证书来验证您的 SSL/TLS 连接没有被 MITM 代理（Fiddler 或其他）拦截。这就是拥有证书来验证服务器的全部目的。

您只能允许 Fiddler 查看流量，因为您选择验证其证书。同样，MITM 代理服务器（主要用于企业环境）需要在客户端机器上安装其 CA 证书。在发生这种情况的环境中，客户端无论如何都不能真正控制他们使用的机器：他们将自己的管理委托给控制该代理的任何人。

最终，客户端的唯一责任是检查 (a) SSL/TLS 是否使用以及 (b) 它是否正确使用（使用他们可以信任的证书，用于他们最初打算与之通信的机器）。（有关更多详细信息，请参阅[Webmasters.SE 上的更长解释](https://webmasters.stackexchange.com/a/28443/11628)。）

> 如何验证 ssl 没有通过浏览器中的代理等拦截？

告诉您的用户不要忽略警告。如果在他们的机器上安装了具有匹配 CA 证书的公司代理，他们原则上可以查看证书的详细信息。如果他们不信任他们为此使用的机器，他们应该使用他们自己的，来自一个允许他们不被拦截的网络。

不幸的是，移动设备在检查这些细节方面确实很差，但作为服务器，你无能为力。

检查客户端是否收到与服务器发送的相同的服务器证书的一种方法是要求客户端证书身份验证，这将使客户端使用自己的私钥签署握手（包括服务器证书），因此服务器可以检查签名是否符合预期。这需要更多的基础设施来处理客户端证书（并且您需要向您的用户展示如何使用它们）。

**编辑**：关于您的评论。

> 这是 ssl 的缺陷，我们无法检查是否有人在看，它违背了它的全部目的。

并非如此，即使在现实生活中，用户最终也有责任检查它正在与什么/谁交谈。如果您填写了正确的表格以通过代理投票并将投票权委托给某人，或者如果您将您的身份证和送货单交给某人从邮局为您取件，则由您来确保您相信那个人。如果您将您的银行密码提供给某人并且他们为您打电话给您的银行，您的银行将无法判断这是否是您：就它而言，您是通过这些凭据识别的。

只有用户可以检查它是否在与正确的服务器通信：如果不是，则合法服务器没有与用户联系，因此它根本无法发出任何警告表明正在发生错误。

您将永远无法强迫用户从您的服务器与正确的服务器对话，因为您无法控制他们的行为。他们可以将密码提供给他们想要的任何人，而你不会知道。（你最多可以教他们不要这样做。）

您可以做的是防止您的服务器将数据提供给不是您的用户的人。按照现实生活中的类比，这可以通过使用您坚持该人在场的机制来完成（您不允许某人为其他人行事，即使他们出现了另一个人的 ID）。这可以在使用客户端证书时通过 SSL/TLS 完成：只有私钥的持有者可以被认证，没有中间方。（当然，从实际的角度来看，用户必须确保他们不提供他们的私钥。）

# android - 从内部存储文件中读取 (Android)

> ID：11567490
> 
> 赞同：0
> 
> 时间：2012-07-19T18:56:45.633
> 
> 标签：android

如何从内部存储文件中读取特定数据。例如，我存储了 1\. 设备 2\. 时间（纪元格式） 3\. 按钮文本

```
 CharSequence cs =((Button) v).getText();
            t = System.currentTimeMillis()/1000;
    s = cs.toString();
    buf = (t+"\n").getBytes();
    buf1 = (s+"\n").getBytes();

    try {
        FileOutputStream fos = openFileOutput(Filename, Context.MODE_APPEND);
        fos.write("DVD".getBytes());
        fos.write(tab.getBytes());
        fos.write(buf);
        fos.write(tab.getBytes());
        fos.write(buf1);
        //fos.write(tab.getBytes());
        //fos.write((R.id.bSix+"\n").getBytes());
        fos.write(newline.getBytes());
        //fos.flush();
        fos.close();

    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

那么在阅读时，我们如何才能从文件中只读取价格呢？（使用 fos.read()）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:23:01.730

我建议以更结构化的方式编写文件，如下所示：

```
long t = System.currentTimeMillis()/1000;
String s = ((Button) v).getText();
DataOutputStream dos = null;
try {
    dos = new DataOutputStream(openFileOutput(Filename, Context.MODE_APPEND));
    dos.writeUTF("DVD");
    dos.writeLong(t); // Write time
    dos.writeUTF(s); // Write button text
} catch (FileNotFoundException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} finally {
    if (dos != null) {
        try {
            dos.close();
        } catch (IOException e) {
            // Ignore
        }
    }
} 
```

要读回来，是这样的：

```
DataInputStream dis = null;
try {
    dis = new DataInputStream(openFileInput(Filename));
    String dvd = dis.readUTF();
    long time = dis.readLong();
    String buttonText = dis.readUTF();
} catch (FileNotFoundException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} finally {
    if (dis != null) {
        try {
            dis.close();
        } catch (IOException e) {
            // Ignore
        }
    }
} 
```

# php - 5.2 服务器上的 PHP 5.3 代码？

> ID：11567491
> 
> 赞同：0
> 
> 时间：2012-07-19T18:56:48.520
> 
> 标签：php, arrays, php-5.3, php-5.2

现在我的虚拟主机只有一个最大 php 数为 5.2 的服务器。我没有意识到这一点，并且完全在 Xamp 上使用 5.3.1 服务器进行了编码。是否有任何类型的 php 脚本或可以让我在 5.2 服务器上运行 5.3 代码的东西。我遇到问题的特定行之一是：

```
$files = array_diff( scandir( __DIR__ . '/data' ), array('.','..') );
require __DIR__ . '/views/view_index.php'; 
```

在大约该行的 php 只是不读取，并且有问题。view_index.php 独立工作，但上面的行似乎不起作用，因为我需要传递该变量以将某些文件名读入下拉选择器。虽然，我有更多的问题，其中大部分需要很长时间才能解决。是否有任何类型的脚本来简化这个过程。我一直在四处寻找，找不到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:01:37.660

至于您编写的特定 __DIR__ 问题，您可以进行搜索和替换并将其更改为任何地方：

```
dirname(__FILE__) 
```

这应该与 __DIR__ 相同。

# csv - 向量格式向量中两个 CSV 文件的 clojure 连接

> ID：11567493
> 
> 赞同：0
> 
> 时间：2012-07-19T18:56:57.523
> 
> 标签：csv, clojure

我是clojure的新手，想正确地做到这一点。我有来自两个 CSV 文件的两个带有日期戳数据的数据源。我已将它们放入矢量格式的矢量中。我想做一个连接（外连接）类型的数据组合。

```
;--- this is how I am loading the data for each file.... works great ---
(def csvfile (slurp "table.csv"))
(def csvdat (clojure.string/split-lines csvfile))
(def final (vec (rest (map (fn [x] (clojure.string/split x #",")) csvdat)))) 
```

CSV 文件 1：日期值 1 值 2 值 3

CSV 文件 2：日期值 A 值 B 值 C

向量格式的结果向量：日期 value1 value2 value3 valueA valueB valueC

我有几个丑陋的想法，我只想做最好的丑陋想法。:)

选项 1：按顺序获取一组唯一的时间，并将两个向量向量中的所有数据映射到一个新的向量向量 选项 2：有没有聪明的方法可以将两个向量向量映射到一个新向量向量（比我的经验更高级的映射）

做“加入”的最常见的方法是什么？我应该做地图吗？我喜欢向量，因为在加入 csv 后我将进行大量范围计算，例如将窗口（行组）向下移动到加入数据的行中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-05-14T10:23:53.773

您的数据：

```
(def csv1 [["01/01/2012" 1 2 3 4]["06/15/2012" 38 24 101]])
(def csv2 [["01/01/2012" 99 98 97 96]["06/15/2012" 28 101 43]]) 
```

将 CSV 的向量表示向量转换为映射：

```
(defn to-map [v] (into {} (map (fn [[date & data]] [date data]) v))) 
```

合并地图：

```
(merge-with into (to-map csv1) (to-map csv2)) 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-19T19:07:56.143

据我了解，您的数据看起来像这样：

```
(def csv1 [["01/01/2012" 1 2 3 4]["06/15/2012" 38 24 101]])
(def csv2 [["01/01/2012" 99 98 97 96]["06/15/2012" 28 101 43]]) 
```

好吧，你可以用它来制作地图。

```
repl-test.core=> (map #(hash-map (keyword (first %1)) (vec (rest %1))) csv1)
({:01/01/2012 [1 2 3 4]} {:06/15/2012 [38 24 101]}) 
```

现在，您有另一个 csv 文件，它的顺序可能相同，也可能不同（上面的 csv2）。

假设我取一行 csv1：

```
(def l1 (first csv1))
["01/01/2012" 1 2 3 4] 
```

并从这一行 csv2 中连接相同日期的向量

```
(concat (hash-map (keyword (first l1)) (vec (concat (rest l1) [44 43 42]))))
([:01/01/2012 [1 2 3 4 44 43 42]]) 
```

我将把函数的编写留给你作为练习。

这是你想做的吗？

* * *

以下是使用 lein new bene-csv 后的一些组件：

## 项目.clj

```
(defproject bene-csv "1.0.4-SNAPSHOT"
  :description "A csv parsing library"
  :dependencies [[org.clojure/clojure "1.4.0"]
                 [clojure-csv/clojure-csv "1.3.2"]
                 [util "1.0.2-SNAPSHOT"]]

  :aot [bene-csv.core]
  :omit-source true) 
```

## core.clj（只是标题）

```
(ns bene-csv.core
  ^{:author "Charles M. Norton",
    :doc "bene-csv is a small library to parse a .csv file.
        Created on March 8, 2012"}
  (:require [clojure.string :as cstr])
  (:require [util.core :as utl])
  (:use clojure-csv.core)) 
```

## core.clj 中的例程来解析 csv 文件

```
(defn ret-csv-data
    "Returns a lazy sequence generated by parse-csv.
     Uses utl/open-file which will return a nil, if
     there is an exception in opening fnam.

     parse-csv called on non-nil file, and that
     data is returned."

    [fnam]
    (let [  csv-file (utl/open-file fnam)

            inter-csv-data (if-not (nil? csv-file)
                             (parse-csv csv-file)
                             nil)

            csv-data (vec 
             (filter 
              #(and pos? (count %) (not (nil? (rest %)))) 
                 inter-csv-data))]

            (pop csv-data))) 
```

# asp.net-mvc-3 - 验证 HTML 时出错：标签元素的 for 属性必须引用表单控件

> ID：11567494
> 
> 赞同：8
> 
> 时间：2012-07-19T18:56:57.583
> 
> 标签：asp.net-mvc-3, html, validation

我不知道为什么在[http://validator.w3.org/check](http://validator.w3.org/check)检查我的页面时不断收到此错误 错误是：

```
Line 46, Column 68: The for attribute of the label element must refer to a form control. 
<label class="environment-label" for="environment_form">Environments:</label> 
```

我相信我为我`label`的外部表单提供了一个 id 参考，为什么它一直在困扰我这个错误？

```
<div>
    <form id="environment_form" method="post">
        <div class="styled-select">
            <label class="environment-label" for="environment_form">Environments:</label>
            <select name="environment_dropdown" onchange="selectionChanged()">
                <option @(ViewData["selection"] == null || string.IsNullOrEmpty(ViewData["selection"].ToString()) ? "selected" : "")>select one</option>
                @foreach (string name in Model) { 
                    <option @(ViewData["selection"] != null && ViewData["selection"].Equals(name) ? "selected" : "")> 
                        @name
                    </option>
                }
            </select> 
        </div>
    </form>
</div> 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-19T18:59:21.753

你有这个：

```
for="environment_form" 
```

它直接引用表格！但是“for”属性应该引用表单的一个元素，在您的情况下是选择。因此，在您的选择中添加一个“id”属性并更改“for”，如下例所示：

```
<label class="environment-label" for="environment_dropdown">Environments:</label>
<select name="environment_dropdown" id="environment_dropdown" onchange="selectionChanged()"> 
```

# django - 具有多对多字段的 Django Dajax 验证模型

> ID：11567495
> 
> 赞同：0
> 
> 时间：2012-07-19T18:57:04.470
> 
> 标签：django, validation, many-to-many, dajaxice

我正在使用 django 和 dajax，并且正在尝试验证具有多对多字段的项目。我正在使用 django 表单为此模型创建表单。当我使用提交按钮提交表单并在选择框中选择了至少 1 到 x 个项目时，模型得到验证。当我使用 dajax 时，模型只会验证我是否选择了选择框中的至少 2 个项目。

有谁知道为什么会发生这种情况？

模型

```
#Hints
class Hint(models.Model):
title = models.TextField(max_length=200)
body = models.TextField()
industryType = models.ManyToManyField(IndustryType)
screen = models.ManyToManyField(Screen)

#Creates form for a hint
class HintForm(ModelForm):

class Meta:
    model = Hint
    #widgets = {'industryType': CheckboxSelectMultiple, 'screen': CheckboxSelectMultiple }
    industryType = ModelMultipleChoiceField(queryset=IndustryType.objects.all(),
                                                widget=CheckboxSelectMultiple()) 
```

模板：

```
<form id="hintForm"  action="." method="post">

{% csrf_token %}
<table>
{{ form.as_table }}
</table>
<input type="submit" value="Submit"/>
</form>

<input type="button"  onclick="send_form();" value="Add Hint" />

<script>
function send_form(){
    data = $('#hintForm').serializeObject();

    // jQuery
    // If you are using jQuery, you need this form->object serializer
    // https://github.com/cowboy/jquery-misc/blob/master/jquery.ba-serializeobject.js
        alert(data['screen'])
        Dajaxice.THE.send_form(Dajax.process,{'hintform':data});
        return(false)
}

</script> 
```

视图中的代码

```
def addHint(request):
if request.method == 'POST': # If the form has been submitted...
    form = HintForm(request.POST) # A form bound to the POST data
    if form.is_valid(): # All validation rules pass
        # Process the data in form.cleaned_data
        #savedHint = form.save()
        #messages.success(request, '{0} has been added.'.format(savedHint))
        print "Success"
else:

    form = HintForm() # An unbound form

return render_to_response('manage/screens/form.html', {
    'form': form, 'breadcrumName' : 'Add Screen' }, context_instance=RequestContext(request)) 
```

AJAX.py

```
@dajaxice_register
def send_form(request, hintform):
    dajax = Dajax()
    form = HintForm(hintform)
    print form
    if form.is_valid():

        dajax.alert("This form is_valid")
    else:

        dajax.alert("Not Valid")
    return dajax.json() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T02:57:52.033

在我切换到不同的序列化对象函数之前，我在使用 Dajax 序列化表单数据时遇到了问题。我意识到这不是对您的问题的全面且经过测试的答案，但您可以试一试这个备用序列化功能：

[https://github.com/danheberden/serializeObject](https://github.com/danheberden/serializeObject)

也许还为您的序列化表单对象做一些萤火虫/控制台输出，以查看它是否/如何被修改。

干杯

# ruby - 运行 Rake 会加载它的测试套件？

> ID：11567501
> 
> 赞同：0
> 
> 时间：2012-07-19T18:57:31.623
> 
> 标签：ruby, rspec, rake

在某些时候，我开始在运行`rake`任务时获得测试输出，但我不知道为什么。

```
$ rake -T
(task output)
Loaded suite /Users/tsigo/.rbenv/versions/1.9.2-p290/bin/rake
Started

Finished in 0.000398 seconds.

0 tests, 0 assertions, 0 failures, 0 errors, 0 skips

Test run options: --seed 30951 
```

并且`rails c`行为也很奇怪：

```
$ rails c
Loading development environment (Rails 3.1.6)
irb(main):002:0> Rails.version
=> "3.1.6"
irb(main):003:0> RUBY_VERSION
=> "1.9.2"
irb(main):004:0> exit
/Users/tsigo/.rbenv/versions/1.9.2-p290/lib/ruby/1.9.1/minitest/unit.rb:581:in `block in process_args': invalid option: --rubygems (OptionParser::InvalidOption)
  from /Users/tsigo/.rbenv/versions/1.9.2-p290/lib/ruby/1.9.1/minitest/unit.rb:560:in `new'
  from /Users/tsigo/.rbenv/versions/1.9.2-p290/lib/ruby/1.9.1/minitest/unit.rb:560:in `process_args'
  from /Users/tsigo/.rbenv/versions/1.9.2-p290/lib/ruby/1.9.1/minitest/unit.rb:591:in `run'
  from /Users/tsigo/.rbenv/versions/1.9.2-p290/lib/ruby/1.9.1/minitest/unit.rb:508:in `block in autorun' 
```

最后，在我的 RSpec 套件中，如果出现故障，它不会显示文件和行信息，从而使任何输出几乎无用：

```
Failures:

  1) Test
     Failure/Error: false.should be_true
       expected: true
            got: false
~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/formatters/base_formatter.rb:16:in `expand_path': No such file or directory - getcwd (Errno::ENOENT)
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/formatters/base_formatter.rb:16:in `relative_path'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/formatters/base_formatter.rb:126:in `backtrace_line'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/formatters/base_formatter.rb:114:in `block in format_backtrace'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/formatters/base_formatter.rb:114:in `map'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/formatters/base_formatter.rb:114:in `format_backtrace'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/formatters/base_text_formatter.rb:154:in `dump_backtrace'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/formatters/base_text_formatter.rb:20:in `block in dump_failures'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/formatters/base_text_formatter.rb:17:in `each'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/formatters/base_text_formatter.rb:17:in `each_with_index'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/formatters/base_text_formatter.rb:17:in `dump_failures'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/reporter.rb:98:in `block in notify'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/reporter.rb:97:in `each'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/reporter.rb:97:in `notify'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/reporter.rb:81:in `finish'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/reporter.rb:36:in `report'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/command_line.rb:25:in `run'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/runner.rb:80:in `run_in_process'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/runner.rb:69:in `run'
  from ~/.rbenv/versions/1.9.3-p125/lib/ruby/gems/1.9.1/gems/rspec-core-2.8.0/lib/rspec/core/runner.rb:10:in `block in autorun' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T03:41:33.090

原来这是由`shoulda`宝石引起的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-26T13:36:46.270

尝试添加

```
gem 'test-unit' 
```

到特定组中的 Gemfile，然后运行 ​​bundle install 来安装 gem。

# sql-server-ce - Umbraco - SQL Server CE - 存在文件共享冲突。不同的进程可能正在使用该文件

> ID：11567504
> 
> 赞同：0
> 
> 时间：2012-07-19T18:57:46.240
> 
> 标签：sql-server-ce, connection-string, umbraco

我已将配置为使用 SQL Server CE 的 Umbraco 4.7.2 安装到 GoDaddy 4GH 共享主机帐户中。最初，该站点按预期运行。但是，我很快意识到不允许后续/并发连接，并且收到以下内容：

> System.Data.SqlServerCe.SqlCeException：存在文件共享冲突。不同的进程可能正在使用该文件。[ ..\App_Data\Umbraco.sdf ]

我做了一些研究，我知道 SQL Server CE 不允许多个连接，但我很难相信 Umbraco 会提供 SQL Server CE 作为选项，如果它不能允许多个访问者导航一个地点。

我尝试根据其他资源修改连接字符串，但没有任何运气。这是我当前的连接字符串：

```
datalayer=SQLCE4Umbraco.SqlCEHelper,SQLCE4Umbraco;data source=|DataDirectory|\Umbraco.sdf;file mode=read write;persist security info=false; 
```

我尝试了不同的文件模式，例如`Read Only`没有`Shared Read`运气。你如何克服这个问题？这是托管环境的问题还是连接字符串的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T20:18:18.297

看起来您的托管环境可能不支持使用 SQL CE 数据库。

根据此页面[http://support.godaddy.com/help/article/4883/4gh-frequently-asked-questions](http://support.godaddy.com/help/article/4883/4gh-frequently-asked-questions)它不能支持：

> 并发文件在多个会话或并发线程中写入同一个文件。受影响资源的示例：基于文件的数据库和跨会话日志文件（这些问题在 4GH 环境中由于额外的容量而被夸大了）。

看起来它实际上是一个分布式环境，它在多个服务器之间共享文件系统，这会导致锁定问题。

所以我想解决方案是转向传统的托管产品，只有一台服务器。

当使用 SQL 服务器（非 CE）时，Umbraco 确实支持在分布式环境中运行，但这需要您预先了解所有服务器，因为它需要调用其他实例以刷新缓存等，并且我不要认为您可以使用当前的托管产品来实现这一点。

您可以尝试在当前设置中将数据库升级到完整的 SQL 服务器，但我不确定它是否能正常工作。

# c - 如何使用 cups API 添加 System V 过滤器？

> ID：11567507
> 
> 赞同：1
> 
> 时间：2012-07-19T18:57:48.800
> 
> 标签：c, linux, printing, cups

我需要以编程方式将打印机添加到安装了 System V 过滤器的杯子中。现在我正在使用以下代码来创建添加打印机的请求：

```
pstRequest = ippNew();

pstRequest->request.op.operation_id = CUPS_ADD_PRINTER;
pstRequest->request.any.request_id  = 1;

ippAddString(pstRequest, IPP_TAG_OPERATION, IPP_TAG_CHARSET, "attributes-charset", NULL, "us-ascii");
ippAddString(pstRequest, IPP_TAG_OPERATION, IPP_TAG_LANGUAGE, "attributes-natural-language", NULL, "en");

ippAddString(pstRequest, IPP_TAG_OPERATION, IPP_TAG_NAME, "requesting-user-name", NULL, cupsUser());
ippAddString(pstRequest, IPP_TAG_OPERATION, IPP_TAG_URI, "device-uri", NULL, szUri);
ippAddString(pstRequest, IPP_TAG_OPERATION, IPP_TAG_URI, "printer-uri", NULL, szPrinterUri);
ippAddInteger(pstRequest, IPP_TAG_PRINTER, IPP_TAG_ENUM, "printer-state", IPP_PRINTER_IDLE);
ippAddBoolean(pstRequest, IPP_TAG_PRINTER, "printer-is-accepting-jobs", true); 
```

为了交谈：

```
szUri        = "serial:/dev/pts/12?baud=2400+bits=7+parity=none+flow=none";
szPrinterUri = "ipp://localhost/printers/myptr"; 
```

这似乎正确地将打印机添加到 cups 系统，因为我可以使用以下命令向它发送打印：

```
lp -d myptr test.print 
```

我的第一个想法是将我想用作过滤器的文件复制到`/etc/cups/interfaces`目录中并调用它`myptr`。我这样做了，给了它正确的用户、组和权限，但它似乎不起作用。我什至尝试`sleep 60`在脚本的前面加上 a ，但它从未出现在`ps`.

我尝试使用`lpadmin`如下方式添加打印机，它可以正常工作：

```
lpadmin -h localhost -p myptr2 -v "serial:/dev/pts/12?baud=2400+bits=7+parity=none+flow=none" -i /tmp/my.serial.filter 
```

我必须打电话`cupsaccept`，`cupsenable`然后，但打印机工作正常，它通过我的过滤器发送打印。 `lpadmin`正确地将`my.serial.filter`文件从其中复制`/tmp`并`/etc/cups/interfaces`命名`myptr2`，就像我在程序中所做的那样，而且，对于我的一生，我在任何杯子配置文件中都找不到对过滤器的任何引用，这让我觉得我错过了步。尽管如此，`myptr2`我添加的打印机`lpadmin`可以正常工作，而`myptr`我使用 API 添加的打印机在打印时不会*通过*过滤器进行打印*。*

在我进行的各种 Google 搜索中，我已经阅读了[CUPS 实施](http://www.cups.org/documentation.php/spec-ipp.html)和[HTTP 和 IPP API 文档](http://www.cups.org/documentation.php/api-httpipp.html)，我最接近的是，在前者中，有一条关于[CUPS-Add-Modify的评论-打印机操作](http://www.cups.org/documentation.php/spec-ipp.html#CUPS_ADD_MODIFY_PRINTER)显示：

> CUPS-Add-Modify-Printer 请求可以选择后跟要用于打印机的 PPD 文件或 System V 接口脚本。“ppd-name”属性使用本地 CUPS PPD 文件覆盖附加到请求末尾的任何文件。

这导致我尝试使用

```
ippAddString(pstRequest, IPP_TAG_PRINTER, IPP_TAG_NAME, "ppd-name", NULL, szFilter); 
```

将 szFilter 设置为`"/tmp/my.serial.filter"`and `"/etc/cups/interfaces/myptr"`（当然，在单独的测试中），但无济于事。

谁能告诉我哪里可能出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:51:38.593

好的，我从 cups 源代码库中获得了 lpadmin 的源代码，答案比我尝试的要容易得多。显然，我在最初的帖子中没有包含足够的来源。在上面的代码片段之后，我调用了以下代码：

```
pstHttpServer = httpConnectEncrypt("localhost", ippPort(), cupsEncryption());
pstResponse   = cupsDoFileRequest(pstHttpServer, pstRequest, "/admin/", NULL);
ippDelete(pstResponse);
httpClose(pstHttpServer); 
```

（当然还有适用的错误检查）

我的问题的答案在于我`NULL`作为第四个参数传递给`cupsDoFileRequest`. 如上所述，“CUPS-Add-Modify-Printer 请求可以选择后跟 PPD 文件或 System V 接口脚本。” 我没有将两者联系在一起，但那句话是指其中的第四个参数`cupsDoFileRequest`，如果我放置过滤器的路径，`"/tmp/my.serial.filter"`请求成功`my.serial.filter`并被正确复制到`/etc/cups/interfaces`as 中`myptr`，之后我的所有打印`myptr`都通过过滤器符合预期。

因此，最终的解决方案是将`pstResponse`上面的行更改如下：

```
pstResponse   = cupsDoFileRequest(pstHttpServer, pstRequest, "/admin/", "/tmp/my.serial.filter"); 
```

# css - 用伪应用 CSS 三角形

> ID：11567508
> 
> 赞同：1
> 
> 时间：2012-07-19T18:57:59.393
> 
> 标签：css, icons, pseudo-element

我已经设法在纯 css 中创建了一个重新加载图标，但它使用的字符可能会在某些系统上中断。我知道可以[在 css 中创建一个三角形](http://css-tricks.com/snippets/css/css-triangle/)，并且可以将其[应用于伪元素](http://nicolasgallagher.com/an-introduction-to-css-pseudo-element-hacks/)，但我无法复制我的重新加载图标的结果。

[在这里](http://jsfiddle.net/codemastercode/xas5w/)摆弄它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T19:10:36.713

怎么样

```
.reload.b::before {
    content:'';
    top: -4px;
    left: 3px;
    border-top: 3px solid transparent;
    border-bottom: 3px solid transparent;
    border-left: 4px solid grey;
    z-index: 1;
} 
```

**演示** [http://jsfiddle.net/xas5w/2/](http://jsfiddle.net/xas5w/2/)

# git - 可以增加远程 git 存储库（不是 git hub）在等待密码时挂起的时间段吗？

> ID：11567510
> 
> 赞同：1
> 
> 时间：2012-07-19T18:58:00.360
> 
> 标签：git, git-clone, git-bash

我正在运行一个 bash 脚本，除了一些安装之外，它还执行几个 git 克隆操作。尝试克隆时，如果远程服务器在短时间内没有输入密码，则会挂起。

但是，由于某些安装需要很长时间，我无法（并且可能不必）监控脚本的进度，等待“git clone”需要密码的情况。我希望能够让它运行并且任何时候都需要密码它会继续等待密码而不挂断

我的问题是如何增加远程端在挂断前等待的时间？我是 git repo 所在的远程服务器的所有者。

注意：我不想使用无密码 SSH 或类似的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:05:47.883

我建议不要使用基于密码的方法，而是设置基于 SSH 密钥的身份验证，这样您就无需等待了。

[如何生成公共 SSH 密钥](https://stackoverflow.com/questions/3828823/git-how-to-generate-public-key)

希望有帮助

# javascript - 对象字面量内的 Javascript 对象字面量

> ID：11567522
> 
> 赞同：0
> 
> 时间：2012-07-19T18:59:05.010
> 
> 标签：javascript, oop, object

在下面的 JavaScript 示例中，我们是否将 2 个对象字面量视为对象字面量的属性？

```
dw_Tooltip.content_vars = {
link1: {
    img: 'images/dw-btn.gif',
    txt: 'dyn-web button',
    w: 100
},
link2: {
    img: 'images/dot-com-btn.gif',
    txt: 'dyn-web.com button',
    w: 184
} 
```

}

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T19:02:55.683

是的。

link1 和 link2 是 content_vars 对象的属性。但是，link1 和 link2 本身就是对象，具有自己的属性。

您可以在其他对象或数组中嵌套无限数量的对象或数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:02:32.170

是的。这是完全有效的。您可以像这样多次嵌套对象自由主义者。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T19:02:58.693

您会看到一个对象`dw_Tooltip`的属性`content_vars`是一个具有 2 个对象的对象，`link1`并且`link2`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T19:03:26.120

是的我们是。`link1`并且`link2`是对象字面量，它们是对象字面量的属性`content_var`。

# mysql - 按时间和基于 ID 的首次出现对表进行排序

> ID：11567528
> 
> 赞同：1
> 
> 时间：2012-07-19T18:59:31.353
> 
> 标签：mysql, group-by, sql-order-by

我正在寻找一个日志表，以便根据 id 的第一次出现按 id 分组。在下面的示例中，我有一个表“test”，我想按 id 对表进行分组，以便所有 id 都在一起，即列出所有“623”条目，然后列出所有“444”条目。我希望“623”条目排在第一位，因为第一个“623”记录在第一个“444”条目之前。

输入：

```
╔═══════╦════════════╦═════╗
║  uid  ║    time    ║ id  ║
╠═══════╬════════════╬═════╣
║  001  ║  01:45:10  ║ 623 ║
║  002  ║  02:45:20  ║ 444 ║
║  003  ║  03:45:30  ║ 444 ║
║  004  ║  04:45:40  ║ 623 ║
║  005  ║  05:45:50  ║ 623 ║
║  006  ║  06:45:00  ║ 444 ║
╚═══════╩════════════╩═════╝ 
```

输出：

```
╔═══════╦════════════╦═════╗
║  uid  ║    time    ║ id  ║
╠═══════╬════════════╬═════╣
║  001  ║  01:45:10  ║ 623 ║
║  004  ║  04:45:40  ║ 623 ║
║  005  ║  05:45:50  ║ 623 ║
║  002  ║  02:45:20  ║ 444 ║
║  003  ║  03:45:30  ║ 444 ║
║  006  ║  06:45:00  ║ 444 ║
╚═══════╩════════════╩═════╝ 
```

我最接近的是：

```
select time, id from test group by id, time

    ╔═══════╦════════════╦═════╗
    ║  uid  ║    time    ║ id  ║
    ╠═══════╬════════════╬═════╣
    ║  002  ║  02:45:20  ║ 444 ║
    ║  003  ║  03:45:30  ║ 444 ║
    ║  006  ║  06:45:00  ║ 444 ║
    ║  001  ║  01:45:10  ║ 623 ║
    ║  004  ║  04:45:40  ║ 623 ║
    ║  005  ║  05:45:50  ║ 623 ║
    ╚═══════╩════════════╩═════╝ 
```

但这不完全是因为它是按 id 排序的。我不确定让所有“623”条目首先列出的正确语法是什么，因为第一个“623”记录在第一个“444”条目之前。

提前感谢您的帮助。

**得到了答案：**

```
SELECT test.time, test.id FROM
(
    (SELECT DISTINCT id FROM test ORDER BY time ASC) as distinct_test
    LEFT JOIN 
    test ON distinct_test.id = test.id
) 
```

现在我看到它是有道理的。感谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:15:18.953

就像是...

```
 SELECT test.id,
             test.time
        FROM (SELECT DISTINCT id
                FROM test
            ORDER BY time ASC) distinct_test
  RIGHT JOIN test ON distinct_test.id = test.id 
```

这可能行不通，但至少可以让你上路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:34:05.557

唔？

```
SELECT time, id FROM test group by id, time order by id desc 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T19:34:29.070

这是您需要使用的代码；我在您的数据上对其进行了测试，并且有效。它与 Jason Swett 的基本相同，只是您必须使用 a`LEFT OUTER JOIN`而不是 a `RIGHT OUTER JOIN`。

```
SELECT t.id, t.time
FROM (SELECT DISTINCT id
      FROM `table`
      ORDER BY time ASC) distinct_t
LEFT OUTER JOIN `table` t ON distinct_t.id = t.id; 
```

# python - 从python命令行参数中过滤整数

> ID：11567534
> 
> 赞同：1
> 
> 时间：2012-07-19T18:59:46.070
> 
> 标签：python

所以我写了一个程序，我想给它传递一个文件名和一个整数，或者只是一个整数。确定哪个参数是整数的最佳方法是什么？这就是我所拥有的：

```
import sys

if len(sys.argv) > 1):
    for e in sys.argv:
        try:
            bio = map(e, int)
        except:
            pass 
```

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T19:09:12.557

`isdigit()`您可以使用 string方法检查参数是否为整数：

```
import sys

if len(sys.argv) > 1:
    for e in sys.argv:
        if e.isdigit():
            # all characters in e are digits and there is at least one character in e
        else:
            # it is possibly your filename argument 
```

但是，我应该鼓励你给 argparse 库一个机会：http: [//docs.python.org/dev/library/argparse.html](http://docs.python.org/dev/library/argparse.html)

```
import argparse
parser = argparse.ArgumentParser(description = 'A simple description')

parser.add_argument('-f', action = 'store', dest =  'filename', required = False)
parser.add_argument('-n', action = 'store', dest = 'n', required = True, type=int)

arguments = parser.parse_args()

print arguments.n
print arguments.filename 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T19:04:22.450

```
def isint(val):
    try:
       int(val)
       return True
    except:
       return False

int_args = filter(isint,sys.argv)
not_int_args = set(sys.argv) - set(int_args) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T19:11:01.780

```
if len(sys.argv) == 1: #user passed in only one argument. It must be an integer.
    bio = int(sys.argv[0])
elif len(sys.argv) == 2: #user passed in two arguments: filename and integer.
    filename = sys.argv[0]
    bio = int(sys.argv[1])
else: #user didn't pass in the right number of arguments
    raise Exception("Expected one or two arguments") 
```

# ruby-on-rails - 当 gem 的主类名不同时，如何编写 Gemspec？

> ID：11567535
> 
> 赞同：0
> 
> 时间：2012-07-19T18:59:49.497
> 
> 标签：ruby-on-rails, rubygems, gem, bundler, jrubyonrails

我有一个 Gemfile 作为 rails 应用程序的一部分，我正在将其转换为 gem。

```
gem "jruby-openssl", "0.7.4"
gem "nokogiri"
gem 'xml-simple', :require => 'xmlsimple'
gem "httpclient" 
```

如何为我创建的 gem 编写 .gemspec 文件？我写的 gemspec 是这样的。

```
Gem::Specification.new do |s|
   s.name = "my_gem"
   s.platform    = Gem::Platform::RUBY
   s.authors     = [""]
   s.email       = [""]
   s.homepage    = ""
   s.summary     = %q{MyGem}
   s.description = %q{MyGem}
   s.files = Dir["{app,lib,config,public,db}/**/*"] + ["Rakefile", "Gemfile"]

   s.require_paths = ["lib"]
   s.add_dependency 'nokogiri', '>= 1.5.0'
   s.add_dependency('xml-simple') 
   s.add_dependency 'httpclient'
end 
```

但是，不会调用 xmlsimple 对象，因为 add 依赖项不能采用与常规 gem 调用相同的参数。如何编写 gemspec 来调用 xmlsimple ，就像它在 Gemfile 中所做的那样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T20:10:35.030

你可以做：

```
s.add_dependency 'xml-simple' 
```

就像你已经拥有的一样。但是，当您的应用程序（可能在内部`lib/yourgem.rb`）需要库时，您可以：

```
require 'xmlsimple' 
```

代替：

```
require 'xml-simple' 
```

我发现了一个使用 xml-simple 的 gem，它可能对您的参考有用。 [https://github.com/stjohncj/RESTRack](https://github.com/stjohncj/RESTRack)

# batch-file - 等到命令完成批处理

> ID：11567536
> 
> 赞同：1
> 
> 时间：2012-07-19T18:59:55.847
> 
> 标签：batch-file, wait

```
In my batch script I have the following:

if somecondition (
   exit
) else ( 
    for /F "USEBACKQ tokens=4,6,8" %%a in (systeminfo ^| qgrep -e "System Up Time:") do set days=%%a&set hours=%%b&set minutes=%%c
    set /A timepassed=%days%*24*60+%hours%*60+%minutes%
   if "%timepassed%" leq 30 (
   echo %timepassed% 
   ) else (
   echo %time$  
   ) 
) 
```

有什么方法可以确保在将变量 timepassed 与值 30 进行比较之前设置它？有时，如果运行这部分代码，timepassed 似乎被评估为 "" 而不是它应该是什么。

谢谢你的时间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:28:24.220

好吧，您在一个块中设置一个环境变量并在同一个块中读取它。这不起作用，因为在*解析*`cmd`语句时扩展环境变量，而不是在执行语句时（并且块是语句，因此在您进入块之前，块内部已经被它的值替换）。*`%timepassed%`*

 *要将变量扩展移动到语句的运行时添加

```
setlocal enabledelayedexpansion 
```

在批次开始时`!timepassed!`使用`%timepassed%`. 对于在块中设置和使用的其他变量也是如此。*

# java - 在关闭钩子中中断Java中的所有线程

> ID：11567538
> 
> 赞同：4
> 
> 时间：2012-07-19T18:59:57.977
> 
> 标签：java, multithreading, shutdown-hook

我有一个简单的 java 程序，它创建了一系列存储在本地 tmp 目录中的临时文件。我添加了一个简单的关闭挂钩，它遍历所有文件并删除它们，然后在退出程序之前删除 tmp 目录。这是代码：

```
Runtime.getRuntime().addShutdownHook(new Thread(new Runnable() {
    @Override
    public void run() {
        File tmpDir = new File("tmp/");
        for (File f : tmpDir.listFiles()) {
            f.delete();
        }
        tmpDir.delete();
    }
})); 
```

我的问题是创建这些文件的线程在启动关闭挂钩时可能没有终止，因此可能在`listFiles()`调用之后创建了一个文件。这会导致 tmp 目录不会被删除。我想出了 2 hacks:

黑客＃1：

```
Runtime.getRuntime().addShutdownHook(new Thread(new Runnable() {
    @Override
    public void run() {
        File tmpDir = new File("tmp/");
        while (!tmp.delete()){
                for (File f : tmpDir.listFiles()) {
                f.delete();
            }
        }
    }
})); 
```

黑客＃2：

```
Runtime.getRuntime().addShutdownHook(new Thread(new Runnable() {
    @Override
    public void run() {
        try{
            Thread.sleep(1000);
        } catch(InterruptedException e){
            e.printStackTrace();
        }
        File tmpDir = new File("tmp/");
        for (File f : tmpDir.listFiles()) {
            f.delete();
        }
            tmpDir.delete();
        }
})); 
```

两者都不是特别好的解决方案。理想的做法是让关闭钩子等到所有线程都终止后再继续。有谁知道这是否可以做到？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T19:05:27.770

只需跟踪所有正在运行的线程，然后`.join()`在关闭程序之前跟踪它们。

这是对问题标题的回答，因为 ewok 说他不能使用`.deleteOnExit()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-07T01:33:05.533

**更新：** [Tyler Heiks](https://stackoverflow.com/users/1489700/tyler-heiks)准确地指出**deleteOnExit()**不是一个有效的解决方案，因为 OP 尝试了它并且它没有工作。我正在提供替代解决方案。这又是间接的，但主要是因为使用线程和 ShutdownHook 的原始设计存在致命缺陷。

使用**finally**块删除临时文件。

依赖 ShutdownHooks 进行资源管理是一个非常糟糕的主意，并且使得代码很难在更大的系统中编写或重用。将资源从一个线程传递到另一个线程是一个更糟糕的主意。文件和流等资源是线程之间共享的最危险的东西之一。从中获得的收益可能很少，每个线程使用库的**createTempFile方法独立获取临时文件并使用****try/finally**管理它们的使用和删除会更有意义。

处理系统上的临时文件的惯例是将它们视为块框，其中：

1.  磁盘上的位置是不透明的（与程序无关且不直接由程序使用）
2.  文件名无关紧要
3.  文件名保证是互斥的

如果您自己手动创建和命名临时文件，则上述第三项很难实现。在最坏的情况下（凌晨 3 点寻呼机有人吗？），它很可能会变得脆弱和失败。

您提出的算法可以删除由巧合共享同一父目录的其他进程创建的文件。对于其他程序的稳定性来说，这不太可能是一件好事。

这是高级流程：

1.  使用**Files.createTempFile()**获取**路径**（或使用**File.createTempFile()**使用旧的 Java 7 之前的代码**文件**）
*******   根据需要使用临时文件*   删除文件******

 ******这类似于**InputStream**或其他需要手动管理的资源。

显式资源管理的一般模式（当**AutoCloseable**和**try-with-resources**不可用时）如下。

```
Resource r = allocateResource();
try {
   useResource(r);
} finally {
   releaseResource(r);
} 
```

在**Path**的情况下，它看起来像这样：

```
Path tempDir = Paths.get("tmp/);
try {
    Path p = Files.createTempFile(tempDir, "example", ".tmp");
    try {
       useTempFile(f);
    } finally {
       Files.delete(f);
    }
} finally {
    Files.delete(tempDir);
} 
```

在 Java 7 之前的旧版本中，与**File**的使用如下所示：

```
File tempDir = new File("tmp/");
try {
    File f = File.createTempFile(tempDir, "example", ".tmp");
    try {
       useTempFile(f);
    } finally {
       if (!f.delete()) {
          handleFailureToDeleteTempFile(f);
       }
    }
} finally {
    if (!tempDir.delete()) {
        handleFailureToDeleteTempDir(tempDir);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-20T14:01:44.063

泰勒说了什么，但更详细一点：

*   保留对关闭钩子可以访问它们的线程的引用。
*   让线程上的关闭挂钩调用中断。
*   检查线程的代码以确保它们确实响应中断（而不是吃掉 InterruptedException 并在很多代码中犯错）。中断应该提示线程停止循环或阻塞，结束未完成的业务，并终止。
*   对于在完成之前不想继续的每个线程，检查线程是否处于活动状态，如果是，则对其调用 join，设置超时以防它无法在合理的时间内完成，在这种情况下，您可以决定是否删除文件。******

# haskell - 如何在haskell中创建类型类的子类型类？

> ID：11567540
> 
> 赞同：1
> 
> 时间：2012-07-19T19:00:05.837
> 
> 标签：haskell, types, typeclass

我们可以创建`Sub Type`in`Type Class`吗`haskell`？`sub-typing`最多可以去多少级`Type Class`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T19:58:21.053

是的，可以在 Haskell 中创建某种子类。它看起来基本上是这样的：

```
class Parent a where
    ...

class Parent a => Child a where
    ... 
```

那么任何实例`Child`也必须是 的实例`Parent`。

例如，参见[`Applicative`](http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Control-Applicative.html#t%3aApplicative)类。

我也不认为对子类化的“级别”有限制，因为（我猜是这样）子类化可以作为相应实例的类字典的顺序联合，其中包含它们各自的多态函数实现，并且似乎没有边界对于这本词典的增长。

# c++ - 将 int 包装在一个类中会有任何性能损失吗？

> ID：11567547
> 
> 赞同：14
> 
> 时间：2012-07-19T19:00:45.600
> 
> 标签：c++

我有一个包含许多向量、集合和地图的项目。在大多数情况下，键/索引是一个整数。我正在考虑创建小类，例如：

```
class PhoneRepoIx //index into map {phone_number => pointer}
{
public:
  int n;
};

class PersonIx //index into map {social_security_number => pointer}
{
public:
  int n;
}; 
```

我会招致任何速度或内存损失吗？有了内存，我 90% 确信每个实例没有内存成本，只有每个类类型。速度我不清楚。

**动机：** 使用上述方法，编译器会为我做一些额外的类型检查。此外，通过精心选择的显式类型名称，我的代码的读者将更容易看到我在做什么。到目前为止，我在任何地方都使用 int 并且我选择了变量名来表达每个索引是什么。有了以上内容，我的变量名可能会更短。

注意： Tyepdefs 没有完全解决我的问题，因为编译器不会做任何额外的类型检查，内部所有类型都只是 int。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T19:43:11.013

不同的编译器有不同的优化能力和不同的错误。理论上可以以精确的零开销编译它。你的编译器会达到这个理论极限吗？答案是肯定的“也许”。至少某些编译器至少在某些时候会这样做。

更有趣的问题是您是否应该担心可能的性能下降。这个问题的答案是强烈的“不”。直到您的程序确实显示了不可接受的性能数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T19:31:44.317

我会建议使用模板来获得你想要的。

```
template <typename T>
struct Index {
    Index(int value) : value(value) {}
    int value;
}; 
```

这就像使用。

```
struct PhoneRepoIx {};
Index<PhoneRepoIx> PhoneIndex(1);
list[PhoneIndex.value]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-19T19:52:38.137

在这个类上通常会调用两个函数：

*   构造函数
*   operator<（因为 STL map 是一个树 impl，所以键应该支持这个）

我认为上面的答案“别担心”听起来不错（配置文件然后优化）。但是要弄清楚为什么这不会导致任何放缓（猜测）：

*   构造函数：一个体面的编译器没有理由不能将其转换为堆栈指针增量（为 int 腾出空间），然后设置可用空间。
*   operator<：一个体面的编译器没有理由不能内联两个对象的“n”之间的简单比较。

# javascript - 使用 for in 时不直观的 javascript 行为

> ID：11567551
> 
> 赞同：0
> 
> 时间：2012-07-19T19:01:03.277
> 
> 标签：javascript, arrays, for-loop

> **可能的重复：**
> [带有数组的 JavaScript “For ...in”](https://stackoverflow.com/questions/500504/javascript-for-in-with-arrays)

我使用 for-in 迭代遍历了各种数组，结果各不相同：

```
var my_array1 = {"foo":2, "bar":3};
var my_array2 = new Array(
'foo',
'bar'
);
var my_array3 = ["foo","bar"];

for (var key in my_array1){
alert(key); // outputs key
}

for (var key in my_array2){
alert(key); // outputs index integer not value
}

for (var key in my_array3){
alert(key); // outputs index integer not value
} 
```

非关联数组上的 for-in 迭代是否有理由只给出索引而不是像 python 中的实际值？

对于非关联数组，使用 for(var index in my_array) 是否比使用 for(var index=0; index<my_array.length; index++) 有优势？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:09:03.357

[for..in](https://developer.mozilla.org/en/JavaScript/Reference/Statements/for...in)迭代属性，而不是值。

如上面的链接所述，使用它而不是使用数组的常规[for的一个理论上的缺点是，](https://developer.mozilla.org/en/JavaScript/Reference/Statements/for) [ECMAScript 规范](http://es5.github.com/#x12.6.4)中没有定义属性的迭代顺序（参见本节下的文本），并且依赖于这个实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:09:02.997

简单地：

您的第一个数组不是数组。这是一个对象字面量。

将其视为一个类的实例，其中所有属性和方法都是公共的。如果您真的非常想要，您可以将其视为单例，除非没有其他语言创建的任何全局范围问题，尝试制作单例。

所以在 javascript`for (key in obj) {}`中意味着遍历类实例的属性。用于`for (i = 0, length = x; i < length; i += 1) {}`遍历数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:09:38.477

我猜原因基本上可以归结为设计 Javascript 'in' 运算符的方式。这种行为类似于其他一些语言，在对象/哈希的情况下，键是“foo”和“bar”，而对于数组，键是索引。我看不出对数组使用“标准”循环和“for in”循环之间有很大区别，但为了清楚起见，我倾向于使用标准符号，除非我使用类似 . each() 函数会为我处理它。

# java - Scala 如何处理 Java 风格的包语句

> ID：11567556
> 
> 赞同：3
> 
> 时间：2012-07-19T19:01:19.107
> 
> 标签：java, scala, packages, scalac

这听起来很尴尬。我的目的是了解 Scala 如何处理以 Java 风格编写的包语句。为此，我编写了一个小示例类（我将其命名为 DinnerTimeP.scala，如下所示：

```
package dinnertime
 class Dinner { 
  val veggie = "broccoli"
   def announceDinner(veggie: String) {
   println("Dinner happens to be tasteless " + veggie + " soup")
  }
 } 
```

我有一个名为 scaladev 的文件夹，我在该文件夹下创建了包文件夹 Dinnertime。在这个包下生活着 DinnerTimeP.scala。然后在 DOS 命令上导航到晚餐时间并使用 scalac 编译文件 DinnerTimeP（名称听起来很傻），如下所示。

```
C:\scala-2.9.1.final\scala-2.9.1.final\scaladev\dinnertime>set CLASSPATH=.;C:\scala-  2.9.1.final\scala-2.9.1.final\scaladev

C:\scala-2.9.1.final\scala-2.9.1.final\scaladev\dinnertime>scalac DinnerTimeP.scala 
```

我希望找到在 DinnerTime 文件夹下生成的 Dinner.class，并且位于源文件 DinnerTimeP.scala 旁边。为了确认我的理解，我在同一个文件夹下创建了一个 HelloWorld.java 程序：

```
package dinnertime;

public class HelloWorld {
  public static void main(String[] args) {
  System.out.println("Hello World");
} 
```

}

我在命令行编译HelloWorld.java如下：C:\scala-2.9.1.final\scala-2.9.1.final\scaladev\dinnertime>javac HelloWorld.java

HelloWorld.class 文件是在其源文件旁边生成的。这正是我想在 Scala 源文件及其编译文件中看到的确切情况。相反，我在包文件夹 Dinnertime 中看到了一个由 Scala 生成的新包文件夹。

这可能是幼稚的。我可能背叛了对 Scala 和包的基本理解，但我对这种行为感到困惑。这是我无法向自己解释的问题：为什么要为新生成的类文件创建嵌套包。这是我希望通过自己的真诚努力解决的问题因为我目前对 Scala 的经验有限，所以我求助于 stackoverflow 上的 Scala 大师来帮助我了解发生了什么为什么？这个嵌套包是否有理由由 Scala 而不是由 Java 创建？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T19:08:57.180

首先尝试从根目录编译，所以这`dinnertime`是一个子目录：

```
$ javac dinnertime/HelloWorld.java 
```

和：

```
$ scalac dinnertime/Dinner.scala 
```

它们都产生相同的输出，即在这两种情况下，`.class`文件都放在`dinnertime`子目录下。

当您在包中运行编译器时，就会出现差异。事实证明`javac`它足够聪明，可以将目标二进制文件相对于根目录，而不是当前的目录。这不是`scalac`始终使用当前目录作为基础的情况。您可以使用`-d`参数轻松解决此问题：

```
$ cd dinnertime
$ scalac -d .. Dinner.scala 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T19:28:07.137

[Tomasz](https://stackoverflow.com/users/605744/tomasz-nurkiewicz) [解释](https://stackoverflow.com/a/11567673/53013)了让它工作所需的一切，所以让我解释一下原因。

Scala 不要求源文件位于反映包的目录层次结构中。也就是说，`Dinner.scala`可以在*任何地方*：这根本不重要。

而且，要非常清楚，即使您有一个复杂的包层次结构，很深并且每个级别都有多个子包，*您也可以将所有源文件放在一个目录*中。Scala 文件所在的目录*不相关*。

很抱歉这么强调它，但是来自 Java 可能很难掌握这一点。

好的，现在，如何解释`dinnertime/Dinner.class`？好吧，*JVM*要求将类文件放在与包名对应的目录层次结构中，因此即使 Scala 源文件可以放在任意目录中，scalac 也必须生成一个目录结构反映包名的输出。

因此，要查看所有内容，Scala 并不关心您在哪个目录中，因此它忽略了您在名为`dinnertime`. 但是，由于源代码表明该类位于名为 的包中`dinnertime`，因此它创建了这样的目录并将类文件放入其中。它假定它的基础是当前目录，可以`-d`根据 Tomasz 的回答使用参数进行更改。

# javascript - 如何将一个 div 放在另一个 div 中？

> ID：11567559
> 
> 赞同：0
> 
> 时间：2012-07-19T19:01:37.557
> 
> 标签：javascript, html

我试图将一个 div 放在另一个 div 中

```
<div id="test">
<img src="img/sky.jpg">
this is a test
</div>

function inner(){
var abc = document.getElementById("test");
document.getElementById("main").innerHTML = abc;
}
</script> 
```

它不起作用。有可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T19:03:04.920

使用[.appendChild()](https://developer.mozilla.org/en/DOM/Node.appendChild)：

```
document.getElementById("main").appendChild( abc ); 
```

# c - 在 Ubuntu 中无法使用 getchar 打印字符数

> ID：11567560
> 
> 赞同：0
> 
> 时间：2012-07-19T19:01:45.877
> 
> 标签：c, ubuntu, getchar

我是 C 和 Ubuntu 的新手。我编写了一个非常简单的程序来计算使用`while`和的字符数`getchar()`。该程序是：

```
#include <stdio.h>

main()  {

    int i;
    int c= 0;

    while ( ( i = getchar() ) != EOF ){
        c++ ;
    }
    printf( "%d characters\n" , c) ;

    return 0;
} 
```

我保存它并使用`gcc c1.c -o c1`. 没有报告错误。我使用`./c1`. 我将输入输入为*daniweb*，然后按 Enter，但显示计数。什么地方出了错？是无限循环吗？如何`getchar()`确定`EOF`何时从键盘输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T17:45:09.150

按 Enter 会向您的程序发送一个换行符，而不是 EOF。正如其他人已经提到的，使用 Ctrl+D 发送 EOF。如果您想停止在换行符上读取字符，请将您的 while 循环更改为：

```
while ( ( i = getchar() ) != '\n' ){
c++ ;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T16:09:17.527

在终端上，您可以通过按 Ctrl+D 将 EOF 发送到应用程序。你也可以这样做：

```
echo "blablub" | ./yourprogram 
```

计算 blablub 中有多少个字符。在这种情况下，EOF 会自动发送。

# ios - iOS 使用两个视图控制器增加内存使用量

> ID：11567562
> 
> 赞同：1
> 
> 时间：2012-07-19T19:01:54.840
> 
> 标签：ios, xcode, memory

我有两个 ViewControllers.. 第一个是 UIButtons 网格，第二个是基于他们按下的按钮的详细描述。

我期望在他们按下 UIButton，然后按下导航栏中的后退按钮后，内存的净变化应该为零。

相反，我看到内存增加，我不知道为什么。当用户单击返回按钮时会发生什么？如何完全解除详细的 ViewController，从内存中完全释放它？我有什么具体的事情要做吗？

弧，xcode 4.2.1，iOS 5.0+

谢谢！

编辑：我使用了泄漏工具，没有发现泄漏。在 prepareForSegue 中，我将一个作为 NSDictionary 的应用程序对象传递给我的新 ViewController。

```
-(IBAction)toApp:(UIButton*)sender {   
[self performSegueWithIdentifier:@"showApp" sender:sender];
}

- (void) prepareForSegue:(UIStoryboardSegue *)segue sender:(UIButton*)sender {
    AppViewController* vc = [segue destinationViewController];
    vc.app = [self.apps objectAtIndex:sender.tag];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:07:11.090

您可能有一个保留循环。使用带有[Heapshot](http://www.friday.com/bbum/2010/10/17/when-is-a-leak-not-a-leak-using-heapshot-analysis-to-find-undesirable-memory-growth/)的 Instruments 中的 Allocations 工具找到它。

# android-ndk - Android NDK JNI Rot13 算法不工作；与 gcc 相同的算法效果很好 - 想法？

> ID：11567563
> 
> 赞同：1
> 
> 时间：2012-07-19T19:01:57.927
> 
> 标签：android-ndk, java-native-interface

我正在尝试使用 NDK 实现 Rot13 算法，并且对于操作字符串缓冲区的所有不同方法，我似乎无法让原始字符串缓冲区在算法进行时获取新值。每次在 linux 上使用 gcc 时，相同的代码都有效。我认为它可能是优化器，但是将 APP_OPTIM := debug 添加到我的 Android.mk 也不起作用。任何想法或帮助都会很棒！

```
#define LOGI(...) ((void)__android_log_print(ANDROID_LOG_INFO, "FOO", __VA_ARGS__))

jbyteArray Java_NativeUtils_foo(JNIEnv* env, jobject obj, jstring item)
{
  int upper, i, a, c;
    char p[9];
    const char *d;

    //char *p = item;
    const char *s = (*env)->GetStringUTFChars(env, item, 0);
    //len = (*env)->GetStringUTFLength(env, item);
    //** make a copy
    strncpy(p, s, 8);
    p[8] = '\0';
    (*env)->ReleaseStringUTFChars(env, item, s);
    LOGI("GG1");
    LOGI(p);

    for (i=0; p[i] != 0; i++) {
      LOGI("GG2");
      a =~ (int)p[i];

      c = ~a-1 / ( ~(a|32) / 13*2-11 ) * 13;
      p[i] = (char)c;
      //** for log output
      d = (const char *)&c;
      LOGI(d);
    }

    LOGI("GG3");
    LOGI(p);

    //** convert back to a Java type
    jbyteArray out = (*env)->NewByteArray(env, 8);
    (*env)->SetByteArrayRegion(env, out, 0, 8, (jbyte *)p);
    LOGI("GG4");
    LOGI(out);

    return out;
} 
```

输出：

```
 ( 3521): GG1
    ( 3521): 12345693
    ( 3521): GG2
    ( 3521): 1
    ( 3521): GG2
    ( 3521): 2
    ( 3521): GG2
    ( 3521): 3
    ( 3521): GG2
    ( 3521): 4
    ( 3521): GG2
    ( 3521): 5
    ( 3521): GG2
    ( 3521): 6
    ( 3521): GG2
    ( 3521): 9
    ( 3521): GG2
    ( 3521): 3
    ( 3521): GG3
    ( 3521): 12345693
    ( 3521): GG4
    ( 3521): ??
   -( 3521): Rot13 in:12345693... out:12345693... 
```

> ```
> the input is the same as the output and not shifted by 13 !
> 
> ===============
> GCC version 
> ```

```
 #include <stdio.h>
    #include <string.h>

    main(int argc, char** argv) {
      int upper, i, a, c;
      char p[9];
      char *in;

      in = argv[1];

      strncpy(p, in, 8);
      p[8] = '\0';
      printf("in ...%s... p ...%s...", in, p);

      for (i=0; p[i] != 0; i++) {
        a =~ (int)p[i];
        c = (~a-1 / ( ~(a|32) / 13*2-11 ) * 13);
        p[i] = (char)c;
      }

      printf("out ...%s...", p);

      //while(a=~getchar())putchar(~a-1/(~(a|32)/13*2-11)*13);}
    } 
```

> 输出：$./a.out Freddy in ...Freddy... p ...Freddy...out ...Serqql...
> 
> ```
> $./a.out Serqql
> in ...Serqql... p ...Serqql...out ...Freddy... 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T06:22:28.220

在 ROT13 算法中，唯一改变的字符是字母，数字保持不变。 `ROT13('12345693')` **等于**`'12345693'`。_

# magento - Magento 索引页面加载但所有其他页面出现 404 错误

> ID：11567564
> 
> 赞同：2
> 
> 时间：2012-07-19T19:02:13.090
> 
> 标签：magento, http-status-code-404

目前，当我离开工作主页时，我正在努力处理显示 404 错误的类别和产品。

我能够安装 Magento，并且正在使用现有工作站点的副本。目的是将这个新站点用作我的开发沙箱。我正在使用 Magento 1.11。这也是一个多商店网站。

我尝试过的事情：重新索引目录 URL 重写，不幸的是，这永远不会完成。

为了尝试解决这个问题，我删除了所有锁定文件，然后我还删除了表中的所有条目`core_url_rewrite`。

我还将`core_config_data`表中的基本 URL 更改为我的新 URL。

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-25T13:16:17.690

就像[Fiasco Labs](https://stackoverflow.com/users/722112/fiasco-labs)所说的，您可能打开了 URL 重写：

`System -> Configuration -> General -> Web -> Search Engine Optimizations -> Use Server Rewrites`但没有`mod_rewrite`安装/启用。

在您的主机上安装/启用它，或者只是打开服务器 rewrites `off`。

另一个原因，如果您`mod_rewrite`已安装/启用，您的 Magento 根目录中可能缺少`.htaccess`文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-19T10:27:23.963

即使启用了 mod_rewrite，该错误也可能是 apache 的错误配置。查看 etc/httpd/conf/httpd.conf 文件。找到定义的部分（标准 Apache 配置目录）。你应该找到：

> 允许覆盖所有

如果有一个

> AllowOverride 无

将其更改为全部，神奇的事情发生了。然后使用以下命令重新启动 Apache：

> sudo 服务 httpd 重启

# node.js - WebStorm 如何以 root 身份运行 nodejs 来执行 shell 命令？

> ID：11567565
> 
> 赞同：3
> 
> 时间：2012-07-19T19:02:22.743
> 
> 标签：node.js, sudo, webstorm

如何通过具有 root 权限的 WebStorm IDE 运行 node.js 应用程序，以便让 node.js 运行 shell 命令？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T01:12:21.500

最简单的方法是使用 root 运行 WebStorm 本身，父节点进程将继承权限。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-08T17:35:29.477

正如 CrazyCoder 所提到的，可以使用 shell 脚本来执行此操作。详细地说，脚本看起来像这样：

```
#!/bin/bash
sudo /path/to/node "$@" 
```

此外，还需要运行`sudo visudo`并添加以下行：

```
username ALL=(ALL) NOPASSWD: /path/to/node 
```

最后，需要`chmod +x`脚本，然后将脚本的路径指定为 WebStorm 中节点的路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-19T17:19:55.427

[WS=网络风暴]

如果您还想在 WS 中调试它，请稍作变体/添加：（不以 root 身份运行 WS）：

要点：WS 终端窗口 + 调试端口 + 远程调试配置

1.  我正在使用 nodemon，所以仍然想使用它
2.  打开终端窗口（在 WS 内：工具->打开终端..）
3.  在终端运行`sudo nodemon --debug=40155 --nolazy server.js`（40155 是稍后连接的调试端口，您可以只运行`node`而不是`nodemon`）
4.  [按照此处](http://www.jetbrains.com/webstorm/webhelp/running-and-debugging-node-js.html#d110618e555)的说明在 WS 中创建远程调试配置并将端口设置为 40155
5.  选择该调试配置并点击 WS 调试按钮
6.  设置断点和利润:)

然后很容易返回到 WS 终端窗口并重新运行服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-11T08:27:49.977

添加到 krisp 的答案：您可能还希望从 WS 配置中传递环境变量以工作。

要做到这一点，像这样添加`-E`到`sudo`scipt

```
#!/bin/bash
sudo -E node "$@" 
```

# dynamics-crm-2011 - 缺少默认 Silverlight 初始屏幕（但仅在 CRM 2011 中）？

> ID：11567570
> 
> 赞同：0
> 
> 时间：2012-07-19T19:02:33.057
> 
> 标签：dynamics-crm-2011, silverlight-5.0

奇怪的事情正在发生。

我的用于 CRM 2011 的 Silverlight 应用程序缺少它们的默认加载启动画面。

`RooVisual`我可以在不设置元素的情况下创建一个简单的 Silverlight 应用程序...

```
 //this.RootVisual = new MainPage(); 
```

这将产生“无限加载”的效果。通常，如果我通过调试器运行它或将它托管在 IIS 中，它就像您所期望的那样：我得到了典型的 SL 加载指示器。但是，如果我将它放在 CRM 2011 网络资源中（无论是本地 CRM 安装还是在线，似乎都无关紧要）并将其用作表单的一部分，我只会得到一个白色矩形。

现在，到目前为止，我所有的 SL 控件都用于本地安装，因此不存在加载时间。但是，我正在创建一个最终可能会在线使用的解决方案，并保持原样，客户可能会认为应用程序已挂起或崩溃，而实际上它仍在下载。

我也尝试过使用自定义闪屏，结果相同。

什么可能是错的？这是我错过的一些记录（或未记录：P）的 CRM 功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T20:12:53.373

那么在我们的 CRM 2011 环境中，它们总是显示 Silverlight 加载屏幕，所以我不确定它们为什么不显示给您。

您是否只尝试过通用的 3rd 方 silverlight 应用程序？

您可以做的一件事是拥有一个带有加载屏幕的 HTML Web 资源，然后使用您的 silverlight 应用程序隐藏加载屏幕（只有在加载后才会这样做）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T08:23:44.390

我已经解决了！

事实证明，问题在于以 .xap 结尾的 CRM 资源命名，例如`new_mySL.xap`.

我可以发誓我们在旧项目中没有这样做，并且启动画面工作正常......因此，我不知道是否有一些 CRM 更新改变了这一点，或者我的想法可能只是在玩诡计我的（很可能是后者）。

# c - 未声明的变量和预期的标识符错误

> ID：11567572
> 
> 赞同：1
> 
> 时间：2012-07-19T19:02:37.697
> 
> 标签：c, tcp, network-programming, compiler-errors

我正在尝试创建一个能够创建和发送 tcp 包的程序，但在编译时不断收到这些错误。

```
error: expected identifier or ‘(’ before ‘,’ token 
```

和

```
error: ‘sin’ undeclared (first use in this function)
error: ‘din’ undeclared (first use in this function) 
```

现在我确信这些是非常明显的结果，但我对这段代码视而不见，无法理解它。功能如下：

```
int send_tcp()
        {
            int sock, one = 1;
            char buffer[PCKT_LEN];
            struct sockaddr_in, sin, din;
            const int *val = &one;

            sock = socket(PF_INET, SOCK_RAW, IPPROTO_TCP);
            if (sock < 0)
                {
                    printf("\nError: socket()\n\n");
                    exit (-1);
                }
            else
                    printf ("\nsocket() - Using SOCK_RAW and TCP protocol is OK.\n\n");

            /* Size of the headers */           
            struct ipheader *ip = (struct ipheader *) buffer;
            struct tcpheader *tcp = (struct tcpheader *) (buffer + sizeof (struct ipheader));
            memset (buffer, 0, PCKT_LEN);

            /* IP attributes */
            ip->iph_ihl = 5;
            ip->iph_ver = 4;
            ip->iph_tos = 16;
            ip->iph_len = sizeof(struct ipheader) + sizeof(struct tcpheader);
            ip->iph_id = htons(54321);
            ip->iph_offset = 0;
            ip->iph_ttl = 64;
            ip->iph_protocol = 6;
            ip->iph_chksum = 0; 

            ip->iph_sourceip = sip;
            ip->iph_destip = dip;

            /* TCP attributes */
            tcp->tcph_sourceport = sport;
            tcp->tcph_destport = dport;

            tcp->tcph_seqnum = htonl(1);
            tcp->tcph_acknum = 0;
            tcp->tcph_offset = 5;
            tcp->tcph_syn = 1;
            tcp->tcph_ack = 0;
            tcp->tcph_win = htons(32767);
            tcp->tcph_chksum = 0; 
            tcp->tcph_urgptr = 0;

            ip->iph_chksum = checksum ((unsigned short *) buffer, (sizeof (struct ipheader )+ sizeof (struct tcpheader)));

            /* Address family */ 
            sin.sin_family = AF_INET;
            din.sin_family = AF_INET;

            /* Source port */
            sin.sin_port = sport;
            din.sin_port = dport;

            /* Source IP */
            sin.sin_addr.s_addr = sip;
            din.sin_addr.s_addr = dip;      

            /* Tell the Kernel we're building our own packet */
            if ((setsockopt(sock, IPPROTO_IP, IP_HDRINCL, (char *)&one, sizeof (one))) < 0)
                {
                    printf("\nError: Can't set socketoptions\n\n");
                    return (-1);
                }

            /* Send */
            if (sendto(sock, buffer, ip->iph_len, 0, (struct sockaddr *)&sin, sizeof(sin)) < 0)
                {
                    printf("\nError: Can't send packet\n\n");
                    return (-1);
                }

            else
                    printf("Packet sent to %s", dip); 

            close(sock);
        } 
```

我的印象是：

```
struct sockaddr_in, sin, din; 
```

就足够了，但显然不是。这也是预期标识符错误消息指向的行。我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T19:04:22.347

去掉第一个逗号

```
 struct sockaddr_in, sin, din;
                   ^
                   ^ 
```

`sockaddr_in`是一个结构的名称，所以我假设您在上面的行中尝试声明两个`sockadddr_in`名为`sin`and类型的变量`din`。如果是这样，您需要删除该逗号，因为在`struct sockaddr_in`. 您所做的与尝试以下操作相同：

```
 int, a,b; 
```

它也不会在类型名之后立即编译，`int`编译器需要一个变量名。

删除该逗号，您应该不再收到编译错误。

# android - Android - 如何使用简单 api 反序列化包含对象列表的 xml

> ID：11567573
> 
> 赞同：3
> 
> 时间：2012-07-19T19:02:36.700
> 
> 标签：android, xml-deserialization

我需要使用简单的 api 反序列化对对象的 xml 响应。当我反序列化一个对象时，它工作得很好，但是当我尝试反序列化一个内联列表时，我得到一个异常：org.simpleframework.xml.core.ElementException: Element 'Person' does not have a match in class MyPersons at line 3.

将不胜感激我做错了什么的线索或反序列化具有复杂对象的内联列表的工作示例。

谢谢。

附件是我的对象的简化示例：

我的xml：

```
<Persons>
    <Person>
        <Info> 
            <ID>1</ID>
            <Name>A</Name>
        </Info>
        <Address>aaa</Address> 
        <Products> 
            <Product>
                <Name>foo</Name> 
                <Product>foofoo</Product> 
            </Product> 
            <Product>
                <Name>bar</Category>
                <Product>barbar</Product> 
            </Product>
        </Products>
    </Person>
    <Person>
        <Info> 
            <ID>2</ID>
            <Name>B</Name>
        </Info>
        <Address>bbb</Address> 
        <Products> 
            <Product>
                <Name>foo2</Name> 
                <Product>foofoo2</Product> 
            </Product> 
            <Product>
                <Name>bar2</Category>
                <Product>barbar2</Product> 
            </Product>
        </Products>
    </Person>
</Persons> 
```

我的对象：

```
@Root(name="Persons")
public class MyPersons {

    @ElementList(inline=true)
    private List<Person> persons;
}

@Root
public class Person {

    @Element
    private Info Info;

    @Element(required=false)
    private String Address;

    @ElementList
    private List<Product> Products;

    public Person(@Element(name="Info") Info Info){

        this.Info = Info;
        //doing some logic 
    }
}

public class Product {

    @Element
    private String Name; 
    @Element
    private String Product;
}

@Root
public class Info {

    @Element(required=false)
    private String ID;  
    @Element
    private String Name;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-21T02:52:56.100

我很抱歉花了这么长时间回复你。如果您现在还没有解决问题，我对您的示例进行了一些尝试，并设法找到了解决方案。它实际上非常简单，而且你真的很接近让它自己工作。请忽略我之前的评论，因为这不会让您更接近解决问题。

您需要更改两件事才能使其正常工作：

首先，添加`entry="Person"`到 中的元素列表中`MyPersons`，结果将如下所示：

```
@ElementList(entry="Person", inline=true)
private List<Person> persons; 
```

其次，如果您打算在提供的 xml 示例上对其进行测试，请修复一些名称条目以具有正确的结束标记。例如：`<Name>bar</Category>`，这显然会破坏 xml 结构的有效性。我很确定这只是一个错字，并且您的实时数据中不存在相同的错误。

# android-emulator - Android模拟器GPU模拟支持哪些显卡？

> ID：11567574
> 
> 赞同：6
> 
> 时间：2012-07-19T19:02:45.417
> 
> 标签：android-emulator, hardware-acceleration

我有用于 ICS 的 HD7690M XT（6770M 的超频版本）和 Android 模拟器（sdk 工具 rev.20）无法启动硬件 OpenGL ES 仿真，并显示以下错误消息：

> 模拟器：错误：无法加载 OpenGLES 仿真库：无法加载 DLL！
> 模拟器：警告：无法使用软件渲染器初始化 OpenglES 模拟。

并且使用软件渲染器我得到了非常糟糕的颜色分辨率（请参阅随附的屏幕截图）。我怀疑这是由于软件渲染器（在模拟早期版本的 Android 中没有这样的问题）。有可以运行硬件仿真的人看到这个问题吗？

[![在此处输入图像描述](../Images/14639481159865e7f8e1974b26672b96.png)](https://i.stack.imgur.com/iSIko.png)

[![在此处输入图像描述](../Images/bcfdfde64df292e705ccec29299ac474.png)](https://i.stack.imgur.com/1qZdg.png)

硬件 GPU 仿真可以在哪些显卡上运行？（可以通过执行查看详细的调试信息`$ emulator -avd your_avd_name -verbose`）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-01T12:26:34.293

我在我的 Windows 7（64 位）机器上遇到了同样的问题。原因是`libOpenglRender.DLL`无法定位。我添加`C:\Program Files (x86)\Android\android-sdk\tools\lib`到`PATH`变量中，现在可以启动模拟器而没有错误消息。但是，与您的屏幕截图相比，我看不出图形质量有什么不同。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-08-10T04:42:19.953

将以下文件从 SDK\tools\lib 复制到 SDK\tools。

1.  libEGL_translator.dll
2.  libGLES_CM_translator.dll
3.  libGLES_V2_translator.dll
4.  libOpenglRender.dll

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-16T10:02:33.823

将所有 dll 文件从 tools\lib 复制到工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-04T06:12:18.807

将 toos\lib 添加到 PATH 可以，您唯一需要记住的是将其添加到 PATH 的 HEAD 中，而不是末尾。检查这篇文章： [https ://code.google.com/p/android/issues/detail?id=33336](https://code.google.com/p/android/issues/detail?id=33336)

# javascript - Backbone.js：仅渲染集合中的最后一个模型，显示模型总数

> ID：11567575
> 
> 赞同：3
> 
> 时间：2012-07-19T19:02:47.973
> 
> 标签：javascript, backbone.js

我有一个基本的backbone.js 应用程序，它呈现一组模型。我想修改为仅渲染最后一个模型，并显示模型总数的数字。到目前为止，这是我的代码：

```
 var Thing = Backbone.Model.extend({
 });

 var ThingView = Backbone.View.extend({
    el: $('body'),
     template: _.template('<h3><%= title %></h3>'),

     render: function(){
         var attributes = this.model.toJSON();
         this.$el.append(this.template(attributes));
     }
 });

 var ThingsList = Backbone.Collection.extend({
   model: Thing
});

var things = [
  { title: "Macbook Air", price: 799 },
  { title: "Macbook Pro", price: 999 },
  { title: "The new iPad", price: 399 },
  { title: "Magic Mouse", price: 50 },
  { title: "Cinema Display", price: 799 }
];

var thingsList = new ThingsList(things);

var ThingsListView = Backbone.View.extend({
   el: $('body'),
   render: function(){
     _.each(this.collection.models, function (things) {
            this.renderThing(things);
        }, this);
    },

  renderThing: function(things) {
    var thingView = new ThingView({ model: things }); 
    this.$el.append(thingView.render()); 
  }

});

var thingsListView = new ThingsListView( {collection: thingsList} );
thingsListView.render(); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-19T19:09:42.827

使用以下命令从集合中获取最后一个模型[`at()`](http://documentcloud.github.com/backbone/#Collection-at)：

```
// this.collection.length - 1 is the index of the last model in the collection
var last_model = this.collection.at(this.collection.length - 1); 
```

您的`render()`函数将如下所示：

```
render: function(){
    var last_model = this.collection.at(this.collection.length - 1);
    this.renderThing(last_model);
} 
```

[`length`](http://documentcloud.github.com/backbone/#Collection-length)使用属性获取集合中模型的总数：

```
var total = this.collection.length; 
```

编辑添加 Backbone 为[`last()`](http://underscorejs.org/#last)每个集合提供了一个方法，由 Underscore JS 提供（感谢[@RocketR](https://stackoverflow.com/users/486820/rocketr)指出这一点）。因此，上面可以更容易地写成如下：

```
var last_model = this.collection.last(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-13T14:09:46.810

我曾尝试使用该`collection.length`功能，但一直失败，但了解基础知识有所帮助：

要获得我推荐的第一个模型：

```
var firstModel = Models.at(0);      
alert(firstModel.get("attribute")); 
```

要获取模型集合中的最后一个模型：

```
var lastModel = Models.pop();
var lastModelId = lastModel .get("id"); 
```

# mysql - 如何计算 user_id 在表中的次数？

> ID：11567579
> 
> 赞同：1
> 
> 时间：2012-07-19T19:02:57.960
> 
> 标签：mysql

考虑以下 MySQL 表：

```
user_id
-------
1
1
2
3
3
3
3 
```

我想要一个输出：

```
user_id  cnt
-------------
1        2
2        1
3        4 
```

我虽然这会发生这种情况，但它不会：

```
SELECT user_id, COUNT(1) FROM table GROUP BY user_id 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:06:57.743

```
SELECT user_id, COUNT(*) FROM table GROUP BY user_id; 
```

顺便说一句，还有好奇心：

```
SELECT user_id, SUM(1) FROM table GROUP BY user_id 
```

两者都会给你你想要的输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:08:37.163

尝试这个：

SELECT user_id, COUNT(user_id) as cnt FROM table GROUP BY user_id

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T19:10:41.223

```
SELECT user_id, count(user_id) as total FROM temp group by user_id; 
```

查询产生了这个。

```
user_id  total
-------------
1        2
2        1
3        4 
```

# java - 为什么我的 listview 适配器没有在新视图上显示正确的布局？

> ID：11567585
> 
> 赞同：0
> 
> 时间：2012-07-19T19:03:12.123
> 
> 标签：java, android

我有一个基于 android 中的 MMS 和 SMS 数据库的自定义光标适配器。代码如下所示：

```
@Override
public View newView(Context context, Cursor cursor, ViewGroup parent) {

    Message m = Message.getMessage(context, cursor); // gets message from cursor
    int t = m.getType(); // this gets the type of message it is .. 2 = recv, 1 = sent

    switch(t){
    case Message.MMS_IN: // 128
        return mInflater.inflate(R.layout.messagelist_item_recv, parent, false);
    case Message.MMS_OUT: // 132
        return mInflater.inflate(R.layout.messagelist_item_sent, parent, false);
    case Message.SMS_IN: // 2
        return mInflater.inflate(R.layout.messagelist_item_recv, parent, false);
    case Message.SMS_OUT: // 1
        return mInflater.inflate(R.layout.messagelist_item_sent, parent, false);
    default:
        return null;
    }
} 
```

`R.layout.messagelist_item_sent`用于发送消息，用于`R.layout.messagelist_item_recv`接收消息。但是查看我的消息，当列表视图正确显示时首先显示的行，但是当我将列表视图上升到新视图时，布局混淆了。recv 布局是发送的布局应该位于的位置，反之亦然。有谁知道为什么会出现这种问题？

*** 编辑 ****

```
@Override
public int getItemViewType(int position) {
     // move the cursor to the position
Cursor c = (Cursor)getItem(position);
Message m = Message.getMessage(context, c);

if (isInbox(m.getType())){
   inflater.inflate(recv view);
 // it's been shortened 
} else {
   inflater.inflate(send view);   
// and determine the correct type of row layout
     // return 0 or 1
     // use the code that you currently have from the newView method
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T19:53:44.510

> 但是查看我的消息，当列表视图正确显示时首先显示的行，但是当我将列表视图上升到新视图时，布局混淆了。

这可能是因为您没有正确处理`ListView`回收机制。不会为每一行调用该`newView`方法，当没有用于行布局的回收视图时调用它（就像`ListView`第一次显示时一样，这就是行以正确顺序显示的原因）。否则，`ListView`将使用可能是也可能不是正确类型的视图的回收视图。

您应该使用方法`getViewTypeCount()`和`getItemViewType()`. 该方法`getViewTypeCount()`将返回两个（因为您有两种类型的行？！？），然后实现逻辑以确定正确的行类型`getItemViewType`：

```
@Override
public int getViewTypeCount() {
    return 2;
}

@Override
public int getItemViewType(int position) {
     Cursor c = (Cursor)getItem(position);
     Message m = Message.getMessage(context, c);
     switch(m.getType()){
         case Message.MMS_IN: // 128
             return 1;
         case Message.MMS_OUT: // 132
             return 0;
         case Message.SMS_IN: // 2
             return 1;
         case Message.SMS_OUT: // 1
             return 0;
         default:
             return 0;
      }
} 
```

然后在`newView`方法中：

```
@Override
public View newView(Context context, Cursor cursor, ViewGroup parent) {
    int rowType = getItemViewType(cursor.getPosition());
    if (rowType == 0){
        return mInflater.inflate(R.layout.messagelist_item_sent, parent, false);
    } else if (rowType == 1){    
        return mInflater.inflate(R.layout.messagelist_item_recv, parent, false);
    } else {
        return null;
    }
} 
```

# java - java中的秒表

> ID：11567586
> 
> 赞同：0
> 
> 时间：2012-07-19T19:03:18.423
> 
> 标签：java, timer, stopwatch

我试图在java中制作一个秒表，看起来像00:00:00，一旦按下按钮就会开始计数。出于某种原因，它不起作用，但我确信我缺少一些东西。

```
for (;;)
    {
    if (pause == false)
            {
               sec++; 

               if (sec == 60)
               {
                   sec = 0;
                   mins++;
               }
                   if (mins == 60)
                   {
                       mins = 0;
                       hrs++;
                   }

               String seconds = Integer.toString(sec);
               String minutes = Integer.toString(mins);
               String hours = Integer.toString(hrs);

               if (sec <= 9)
               {
                   seconds = "0" + Integer.toString(sec);
               }
               if (mins <= 9)
               {
                   minutes = "0" + Integer.toString(mins);
               }
               if (hrs <= 9)
               {
                   hours = "0" + Integer.toString(hrs);
               }

               jLabel3.setText(hours + ":" + minutes + ":" + seconds);
            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:11:26.387

我不确定问题是什么，但是把这个块放在一个`for(;;)`循环中绝对是致命的。

尝试这样的事情，而不是`for`循环：

```
// "1000" here means 1000 milliseconds (1sec). 
new Timer( 1000, new ActionListener(){
  public void actionPerformed( ActionEvent e ){
    if( pause == false ){ 
      // ... code from above with the for(;;)
    }
  }
}.start(); 
```

您可以阅读[计时器类的文档以](http://docs.oracle.com/javase/7/docs/api/javax/swing/Timer.html)获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:10:01.420

第一件事是迭代在不到一秒的时间内执行，所以你会有“糟糕的时间”。

您可能需要使用诸如`System.currentTimeMillis()`精确程序之类的方法，更了解如何处理[time](http://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html)的库，甚至可能需要在程序中简单地休眠 1 秒（但这不会很精确）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:11:12.343

我将假设，（因为您没有提供任何证据表明其他情况），这只是从 Main-Class 中“按原样”执行的。你会注意到你的数字增长得非常快，根本不像秒表。在每次迭代之间使用`Thread.sleep(1000)`第二遍。

编辑：如果您的暂停按钮不起作用，我会假设您正在使用 Swing，并且该按钮挂在事件线程上并且没有执行任何操作。一个简单的解决方法是制作`pause -> static`并使用 a`swing-worker`来执行暂停按钮尝试启动的方法。

# nosql - 什么是 BigData 和 NoSQL，两者都有什么好书？

> ID：11567590
> 
> 赞同：2
> 
> 时间：2012-07-19T19:03:30.407
> 
> 标签：nosql, bigdata

我知道我在问两个问题。但是有人可以告诉我大数据是什么意思。此外，NoSQL 与传统 SQL 有何不同。

最后，您能否推荐一些好的/最好的书籍或教程/网站，这些主题可以让新手提升水平。

请回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T16:15:06.337

“大数据”是一个流行词，这意味着它为不同的人定义了不同的（尽管相关的）事物。

有些人将其用于专门研究“大数据”的数据库软件，有些人将其用于操作大型数据集的整个基础架构，有些人将其用于大型数据集本身（结构化、半结构化和非结构化）。

“大数据”数据集至少具有一个不同的属性：由于它们的大尺寸和/或缺乏结构，它们被认为隐藏了有价值的信息和关系。每个“大数据”项目的最终目标都是以高效和可重复的方式发现这些有价值的知识。

“大数据”有多大？足够大，以至于几年前它需要在所有三个方面投资数百万美元：硬件、软件和开发。今天，您可能仍然需要大量（但较少）的投资，但可能只需要这 3 项中的 2 项。

# image - 对图像使用版本控制 (SVN)

> ID：11567591
> 
> 赞同：0
> 
> 时间：2012-07-19T19:03:32.283
> 
> 标签：image, svn, filesystems, storage

我们将图像以以下格式存储在文件系统中。这样 Web 应用程序就可以通过 http 服务器访问带有 url (http://imageserver.domain.com/items/it1/small.jpg) 的图像。

> 现在，为了让图形团队能够访问这些图像以进行添加/更新，我正在考虑为文件夹“items”设置一个 SVN 代表。这被认为是最佳实践吗？有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:08:49.533

我一直听说仅将文本置于源代码控制之下被认为是“良好做法”。话虽如此，我已经看到公司肯定会将图像放入他们的存储库中。其他人则创建了一些迂回的方法，例如让 IIS 中的虚拟目录指向共享文件服务器。我更喜欢后者，因为它不需要很长时间来关闭分支。另一方面，它没有提供 SC 会提供的历史数据——当然，如果需要的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:08:50.147

它当然是可行的，但是我建议您有 2 个文件夹：一个包含要供您的 Web 应用程序使用的图像“工作集”，另一个供您的图形团队在必要时访问。这样一来，您的团队就可以使用大量图像，同时避免任何可能的图像链接损坏或 Web 应用程序内部的其他问题。

最好安全地玩IMO。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T19:08:54.473

> 我正在考虑为文件夹“items”设置一个 SVN 代表。这被认为是最佳实践吗？

这是一种可以接受的做法。图像很小，而且不太可能改变。

> 有什么建议么？

为您的图形艺术家写一份备忘单，以便他们可以毫无问题地签出和提交图像。备忘单将特定于他们使用的图形工具和他们对 Subversion 的访问。

# vim - 你能在 vim 中做交互式宏或录音吗？

> ID：11567596
> 
> 赞同：6
> 
> 时间：2012-07-19T19:03:56.910
> 
> 标签：vim, macros

我想定义一个 vim 宏，在某些时候会中断用户输入，这可能吗？

编辑：原来是录音（q），而不是宏

可以在录音中使用输入命令，但麻烦多于其价值。

我首先将插入输入转义映射到一个键

```
:map <F2> a<C-R>=input('input: ')<CR> 
```

然后我在 q 寄存器中做了这个录音

```
name: 
```

并将其粘贴到新标签中

```
iname: ^[ 
```

在最后一次逃脱之后，我按下`<C-V><F2>`了这条线：

```
iname ^[^[OQ 
```

我拉回 q 缓冲区然后使用宏，让我使用输入函数。它有效，但非常糟糕。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:06:29.877

是的。见功能`input({prompt}, [, {text} [, {completion}] ])`。甚至还有 `inputdialog({prompt} [, {text} [, {cancelreturn}]])`, 用于弹出对话框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-20T06:48:24.563

如果您`input()`在映射或宏中使用，剩余的字符将被视为输入，这不是您想要的。Vim 提供`inputsave()`和`inputrestore()`函数来临时暂停从映射字符流中读取。

根据 mogelbrod 的回答，这是行不通的；作为`itest`输入读入：

```
oBEFORE ^R=input('prompt> ')^Mitest 
```

但这确实：

```
function! Input()
    call inputsave()
    let text = input('prompt> ')
    call inputrestore()
    return text
endfunction
oBEFORE ^R=Input()^Mitest 
```

不幸的是，因为`<C-R>`需要一个表达式，我们不能将命令内联，而必须定义一个单独的`Input()`函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T20:16:31.170

不幸的是，这似乎是不可能的。您可以在宏内部触发`input()`，但之后似乎无法继续，因为记录的任何其他输入都插入到输入提示中。

将该行拖入一个命名寄存器 ( `"qY`) 并运行它 ( `@q`) 来尝试一下。
注意：将`^R`and替换`^M`为 Ctrl-V Ctrl-R/M（请参阅`:help i_CTRL-V`）。

*   `oBEFORE ^R=input('prompt> ')` *- 作品*
*   `oBEFORE ^R=input('prompt> ')^Mitest` *- 有效，但插入`itest`到提示中*
*   `oBEFORE ^R=input('prompt> ')<CR>test` *- 失败*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-29T17:53:36.523

我已经从这个线程和其他线程收集了信息并编写了这个脚本：

```
function! MacroInterrupt()
    "call inputsave()
    if strlen(reg_recording()) == 0
        if mode() == 'n'
            call inputsave()
            let tmp_col = col('.')
            let tmp_line = line('.')
            let text = input('input:')
            let line = getline('.')
            call setline('.', strpart(line, 0, col('.') - 1) . text . strpart(line, col('.') - 1))
            call cursor(tmp_line, tmp_col + strlen(text))
            call inputrestore()
            return text
        else
            call inputsave()
            let text = input('input:')
            call inputrestore()
            return text
        endif
    else
        echo "Interrupt added to macro"
        call setreg(reg_recording(), getreg(reg_recording()) . "\<F2>")
        "echo getreg("q")
    endif
    "call inputrestore()
endfunction

map <F2> :call MacroInterrupt() <CR>
inoremap <buffer><expr> <F2> MacroInterrupt() 
```

我希望这可以帮助特别是尝试相同的人。

# android - 资源到位图的转换导致质量很差

> ID：11567599
> 
> 赞同：2
> 
> 时间：2012-07-19T19:04:04.893
> 
> 标签：android

我以前从未真正注意到它，但是当我使用 setImageBitmap 更改 imageview 的图像时，使用使用 BitmapFactory 从资源中解码的位图，然后图像质量下降，我不知道为什么。

我什至玩过 BitmapFactoryOptions 之类`options.inPreferredConfig`的 , `options.inJustDecodeBounds`, `options.inDither`，但结果几乎相同；质量差的图像。

另一方面，如果我只使用 setImageResource，图像不会变质并且质量可能最好。

所以基本上这两个代码

1.  `Bitmap b=BitmapFactory.decodeResource(getResources(), R.drawable.keypad,options); iv.setImageBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.keypad))`

2.  `iv.setImageResource(R.drawable.messages);`

导致不同的图像质量。

谁能解释为什么？以及如何使用代码 1 解决此质量问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:40:28.223

如果您使用该`BitmapFactory.decodeResource`方法有模糊的图像，您可以使用以下代码：

```
Options options = new BitmapFactory.Options();
options.inScaled = false;
Bitmap b = BitmapFactory.decodeResource(getResources(), path, options);
iv.setImageBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.keypad)); 
```

将 class 的`inScaled`参数设置`BitmapFactory.Options`为 false，将防止在低屏幕分辨率下出现模糊图像，因为它会防止缩放，如上[一个 SO 问题的答案中所述。](https://stackoverflow.com/a/4822358/1482726)也许你已经尝试过了，但我认为值得一提。

# python - for 循环中出现无法解释的语法错误

> ID：11567607
> 
> 赞同：-3
> 
> 时间：2012-07-19T19:04:27.817
> 
> 标签：python, syntax

我在第二行到最后一行出现语法错误，但不知道为什么。它似乎与之前的第 2 行相同，但由于某种原因，我遇到了语法错误。我已经尝试过在它和它之前的行之间有和没有空行，结果相同。

```
## numlist = some list
array_size = 20
for row in xrange(array_size):
    for col in xrange(array_size):
        if(col<=(array_size-4)):
            check(sum(numlist[row][col:col+4])
        if(row<=(array_size-4)):
            check(sum([numlist[row+i][col] for i in range(4)])) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T19:07:14.827

您缺少`')'`第一个语句下方语句的`if`结束语。

```
check(sum(numlist[row][col:col+4])
                                  ^ 
```

应该

```
check(sum(numlist[row][col:col+4]))
                                  ^ 
```

*注意*：使用具有[匹配/突出显示括号](http://en.wikipedia.org/wiki/Brace_matching)的功能的编辑器是一个非常有用的工具，可以节省您花时间查找此类错误的时间。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T19:07:05.480

```
check(sum(numlist[row][col:col+4]) 
```

应该：

```
check(sum(numlist[row][col:col+4])) 
```

注意最后的额外括号

# c# - 如何删除和重写数据表中的行并以不同的顺序从 datarow[] 数组中写回它们？

> ID：11567610
> 
> 赞同：0
> 
> 时间：2012-07-19T19:04:44.917
> 
> 标签：c#, datarow

我尝试将数据表行保存到 datarow[] 数组，然后删除数据表行并以不同的顺序将它们从 datarow[] 数组重写到数据表中。但是当我从数据表中删除它们时，我无法从 datarow[] 数组中访问它们。

我不知道我这样做是否正确，或者我是否完全脱离了基地，但我迫切需要帮助。

这就是我想要做的：

我有一个 8 行的数据表。我希望能够以某种方式遍历 8 行并根据某些标准对它们重新排序。

例如，我的行有一个发票号、行号和零件号作为关键字段。根据标准，我可能需要将第 6、7、8 行作为第 1、2、3 行放在开头，然后将其余行向下移动。

如果有人有想法请回复....这是一个紧迫的问题。

谢谢你，

山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:07:47.037

使用 DataView 查看行，因为它可以像这样排序。

```
dataTable.DefaultView.Sort = "columnNameA, columnNameB desc"; 
```

然后将列表（无论您使用什么）绑定到 DataView。

哦，这里有一些关于[Sort](http://msdn.microsoft.com/en-us/library/system.data.dataview.sort.aspx)属性的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:21:42.633

你可以尝试这样的事情：

```
 DataTable table = new DataTable();
        table.Columns.Add("Invoice", typeof(string));
        table.Columns.Add("Line", typeof(int));
        table.Columns.Add("Part", typeof(string));

        for (int i = 1; i <= 9; i++)
            table.Rows.Add("Invoice " + i, i, "Part " + i);
        //reorder them:
        int[] orders = { 6, 7, 8, 1, 2, 3, 4, 5 };
        DataTable table2 = table.Clone();
        DataRow row;
        for (int i = 0; i < orders.Length; i++)
        {
            row = table2.NewRow();
            row["Invoice"] = table.Rows[orders[i]]["Invoice"];
            row["Line"] = table.Rows[orders[i]]["Line"];
            row["Part"] = table.Rows[orders[i]]["Part"];
            table2.Rows.Add(row);
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:14:01.717

如果您使用 DataRow：

```
var dr = table.Rows[0]; 
```

然后从表中删除该行，`dr`也会被删除。这是同一行。这解释了你的问题。

至于解决方案，不要对 DataTable 中的行重新排序。相反，添加另一个名为 的列`RowOrder`，对其进行修改以更改顺序，然后根据该列对 DataTable 进行排序，正如@mperrenoud03 向您展示的那样：

table.DefaultView.Sort = "RowOrder";

并使用默认视图。

# r - 操作系统之间产生不同的随机数

> ID：11567613
> 
> 赞同：7
> 
> 时间：2012-07-19T19:04:53.327
> 
> 标签：r, random

有没有人对 set.seed 根据操作系统（OS）给出不同结果的情况有任何经验。我记得之前在 R 的一个课程中遇到过类似的情况，尽管将起始种子设置为相同的值，但有些人使用 rnorm 生成不同的随机序列。现在，我自己在上一门课程，并没有遇到与 rnorm 相同的问题；无论操作系统如何，我所有的学生都会得到相同的序列。有趣的是，MASS 包的 mvrnorm 函数似乎也存在同样的问题。

任何见解将不胜感激 - 马克

这个例子：

```
require(MASS)
set.seed(123)
a <- rnorm(10, mean=10, sd=3)
b <- rnorm(10, mean=5, sd=2)
df <- data.frame(a,b)
C <- cov(df)
M <- mvrnorm(n=10, c(10,5), C)

df
C
M 
```

在我的 Windows 7 OS 64 位版本的 R 2.14.1 上运行：

```
> df
           a        b
1   8.318573 7.448164
2   9.309468 5.719628
3  14.676125 5.801543
4  10.211525 5.221365
5  10.387863 3.888318
6  15.145195 8.573826
7  11.382749 5.995701
8   6.204816 1.066766
9   7.939441 6.402712
10  8.663014 4.054417
> C
         a        b
a 8.187336 3.431373
b 3.431373 4.310385
> M
              a        b
 [1,] 13.270535 6.158603
 [2,] 10.375011 5.737871
 [3,] 13.514105 5.476411
 [4,] 12.681956 5.020646
 [5,] 12.352333 4.927746
 [6,] 15.177508 6.810387
 [7,]  8.114377 2.925225
 [8,]  9.529744 4.834451
 [9,] 12.903550 7.232715
[10,]  6.251907 3.481789 
```

编辑：了解是否有人没有得到这些结果以及使用了哪些操作系统或 R 版本可能会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:34:24.043

我听说有人更改 RNGKind，有时通过加载和运行更改生成器的包或进行更改的其他脚本而没有意识到这一点。如果是这种情况，那么相同的种子将导致不同的随机数。重新运行 R（不加载不同的包或其他脚本）应该从相同的种子生成相同的随机数。

# c# - 将 C# 应用程序转换为 C++ 枚举

> ID：11567614
> 
> 赞同：1
> 
> 时间：2012-07-19T19:05:08.583
> 
> 标签：c#, c++, enums

我在我的 C# 项目中使用过`Enum.GetValues`and `Enum.GetName`，想知道标准 C++ 库中是否有某种替代方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:18:59.007

你可以自己上课。

小部件.h：

```
#include <map>
#include <string>

using namespace std;

class Widget
{
public:
    static Widget VALUE1, VALUE2, VALUE3;

    type GetValue();
    string GetName();
    bool Widget::operator==(const Widget& other) const;

private:
    // specific traits should be declared here
    int i;

    Widget(string name, int value);
    static map<Widget, string> names;
} 
```

小部件.cpp：

```
Widget::VALUE1 = Widget("VALUE1", 1);
// others

Widget::Widget(string name, int value)
{
    i = value;
    Widget::names[name] = *this; // this should happen after all initialization is done
}

bool Widget::operator==(const Widget& other) const
{
    return (this->i == other.i);
} 
```

注意：这可能并不完美。它未经测试，而且不太可能在第一次尝试时神奇地起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:09:47.397

没有简单的方法可以做到这一点。关于这个主题有一些 SO 问题（虽然不完全是这个问题）：

[有没有一种简单的方法可以将 C++ 枚举转换为字符串？](https://stackoverflow.com/questions/201593/is-there-a-simple-script-to-convert-c-enum-to-string#)

[如何轻松地将 C++ 枚举映射到字符串](https://stackoverflow.com/questions/207976/how-to-easily-map-c-enums-to-strings)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:10:13.467

如果您需要获取所有可能名称和相关 int 值的所有功能，我会使用 stl::map。

通常，在 c++ 和使用枚举中，您必须查看文档以获取所有可能的枚举值或使用命名空间，或者让 IDE 在您编程时告诉您哪些可用。

有时，在编写枚举时，我会在所有命名值前面加上一些信息，表明它们属于哪个枚举。

# c# - 如何获取 RSS 提要的流量统计信息？

> ID：11567616
> 
> 赞同：1
> 
> 时间：2012-07-19T19:05:27.117
> 
> 标签：c#, asp.net, rss, sitecore, sitecore6

我们正在使用[Sitecore CMS 动态](http://www.sitecore.net/)生成我们的 RSS 提要。

在 RSS Feed 上获取流量统计信息（即跟踪）的最佳方法是什么？

我现在正在研究的解决方案是：

1.  使用重定向页面到您的 RSS 提要并在此重定向页面上添加您的 Google Analytics（分析）代码。
2.  [跟踪图像](http://ryanfarley.com/blog/archive/2004/06/10/773.aspx)。不确定这个解决方案。
3.  根据 IP 地址、浏览器信息等将命中记录到数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:47:17.983

如果您正在寻找的只是针对您的提要的“命中”，那么您应该能够从 IIS 日志中得到它。

# asp.net-mvc - 防止 Telerik 窗口在 onClose 客户端事件中关闭

> ID：11567624
> 
> 赞同：0
> 
> 时间：2012-07-19T19:06:05.150
> 
> 标签：asp.net-mvc, events, telerik, window

当用户尝试通过单击右上角的“X”关闭窗口时，我正在尝试显示确认对话框。如果用户选择“确定”选项，我想继续关闭窗口，但如果用户按下“取消”按钮，我想阻止窗口关闭。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T19:28:53.690

对于剃须刀：

```
@(Html.Telerik().Window()
    .Name("Window")
    .ClientEvents(events =>
        .OnClose("preventClose")))

<script type="text/javascript">
    function preventClose(e)
    {
        var shouldClose = confirm("Are you sure you want to close?");

        if (!shouldClose)
        {
            e.preventDefault();
        }
    }
</script> 
```

测试和工作。请注意，当他们单击 X 或如果您调用此函数时会调用此函数，`$("#Window").data("tWindow").close();`除非您进行了一些验证检查，如我演示的那样，您将无法关闭窗口。我看不到区分单击 X 和`$(window).close()`手动调用的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T14:34:39.967

我能够自己找出解决问题的方法：

如果你这样做`e.preventDefualt();`，`onClose`它会阻止窗口关闭。文档中提到该`onClose`事件是**可取消**的，但没有说明如何取消该`onclose`事件。

# recursion - 在 Clojure 中打结：没有（显式、丑陋）突变的循环引用？

> ID：11567625
> 
> 赞同：3
> 
> 时间：2012-07-19T19:06:12.280
> 
> 标签：recursion, clojure, lazy-evaluation

在我对[Clojure For Comprehension 示例](https://stackoverflow.com/questions/11530574/clojure-for-comprehension-example/11553140#11553140)的回答中，我有一个处理自己的输出的函数：

```
(defn stream [seed]
  (defn helper [slow]
    (concat (map #(str (first slow) %) seed) (lazy-seq (helper (rest slow)))))
  (declare delayed)
  (let [slow (cons "" (lazy-seq delayed))]
    (def delayed (helper slow))
    delayed))

(take 25 (stream ["a" "b" "c"]))
("a" "b" "c" "aa" "ab" "ac" "ba" "bb" "bc" "ca" "cb" "cc" "aaa" "aab" "aac" 
"aba" "abb" "abc" "aca" "acb" "acc" "baa" "bab" "bac" "bba") 
```

它通过创建一个前向引用 ( `delayed`) 来工作，该引用用作惰性序列 ( `slow`) 中的第二个条目。该序列被传递给惰性函数，然后该函数的输出（惰性序列的第一部分，不需要评估`delayed`）然后用于设置 的值`delayed`。

这样我就“打结”了。但这在 Haskell 中做得更优雅（例如[“打结”的解释</a>）。鉴于 Clojure 有`delay`and `force`，我想知道是否有更好的方法来完成上述操作？](https://stackoverflow.com/questions/357956/explanation-of-tying-the-knot)

 [`delayed`那么问题是：在上面的代码中是否可以以某种方式避免（丑陋的，显式的）突变（of ）？显然（？）你仍然需要突变，但它可以被“惰性”结构隐藏吗？

[昨晚我还在试图理解如何做到这一点时，遇到了一个类似标题的问题；在上面的代码运行之前没有人回复，所以我删除了它，但我对这种方法并不满意，所以我再试一次。]](https://stackoverflow.com/questions/357956/explanation-of-tying-the-knot) 

[另请参阅：](https://stackoverflow.com/questions/357956/explanation-of-tying-the-knot)[Clojure 循环数据结构是否必须涉及 ref 之类的构造？](https://stackoverflow.com/questions/11568036/must-clojure-circular-data-structures-involve-constructs-like-ref#comment15304387_11568036)（有点令人沮丧的是人们在重复问题）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T20:47:36.083

我不确定我能否回答一般情况的问题，但这个功能似乎可以解决特殊情况。

```
(defn stream
  [seed]
  (let [step (fn [prev] (for [p prev s seed] (str p s)))]
    (for [x (iterate step seed) y x] y))) 
```

虽然我遇到了一个大的内存不足异常`(dorun (take ...))`。所以这个功能可能有问题。

# c# - 使用 JIRA SOAP API 访问解析类

> ID：11567629
> 
> 赞同：0
> 
> 时间：2012-07-19T19:06:26.597
> 
> 标签：c#, api, soap, jira

当用户关闭 JIRA 问题时，他们会选择“解决类别”，例如“用户错误”、“服务请求”等。

是否可以使用 SOAP API 查看该字段的值？我查看了我的问题的“解决方案”字段，但如果问题打开，它们总是空白，如果关闭，它们总是为“6”（因此“解决方案”不能与“解决方案”相同）。

任何信息将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:26:39.047

行。所以你想得到'Resolution Class'字段值。它很可能是一个自定义字段。因此，您必须使用 getCustomFields() where RemoteField.getName() == "Resolution Class" 找到该字段的 id。然后您可以在您的问题上调用 getCustomFieldValues() 以获取自定义字段的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:50:19.990

您正在寻找 getResolutions 方法。

> RemoteResolution[] getResolutions(java.lang.String token) 抛出 RemotePermissionException、RemoteAuthenticationException
> 
> 返回 JIRA 中所有问题解决方案的数组。
> 
> 参数： token - SOAP 身份验证令牌。
> 
> 返回： RemoteResolution 对象数组
> 
> 抛出： - RemotePermissionException - 如果不允许用户在此上下文中执行此操作。- RemoteAuthenticationException - 如果令牌无效或 SOAP 会话已超时

# php - 使用 PHP 从网页中提取特定数据

> ID：11567632
> 
> 赞同：7
> 
> 时间：2012-07-19T19:06:26.570
> 
> 标签：php, html, screen-scraping

> **可能的重复：**
> [PHP 中的 HTML 抓取](https://stackoverflow.com/questions/34120/html-scraping-in-php)

我想知道是否有任何方法可以从网页中获取特定的文本字符串，该字符串不时使用 PHP 进行更新。我搜索了“整个互联网”，但一无所获。刚刚看到preg_match可以做到，但是不明白怎么用。

想象一个网页包含以下内容：

```
<div name="changeable_text">**GET THIS TEXT**</div> 
```

[`file_get_contents`](http://pt.php.net/manual/en/function.file-get-contents.php "文件获取内容")在将页面放入变量后，如何使用 PHP 进行操作？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-19T19:12:24.927

您可以使用[`DOMDocument`](http://php.net/domdocument)，如下所示：

```
$html = file_get_contents( $url);

libxml_use_internal_errors( true);
$doc = new DOMDocument;
$doc->loadHTML( $html);
$xpath = new DOMXpath( $doc);

// A name attribute on a <div>???
$node = $xpath->query( '//div[@name="changeable_text"]')->item( 0);

echo $node->textContent; // This will print **GET THIS TEXT** 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T19:11:24.547

你可能想看看

> 简单的 HTML DOM 库

这里有一个小教程：http: [//www.developertutorials.com/tutorials/php/easy-screen-scraping-in-php-simple-html-dom-library-simplehtmldom-398/](http://www.developertutorials.com/tutorials/php/easy-screen-scraping-in-php-simple-html-dom-library-simplehtmldom-398/)

那是一个屏幕抓取 API，可让您向其提供 html，然后以类似 jQuery 的语言获取其中的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T20:29:48.313

```
$delements= file_get_html('url will go here'); 

foreach($elements->find('element') as $ele) {

    //traverse according to your preferences

} 

//return or output 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T19:31:54.967

你说的是[数据抓取](http://en.wikipedia.org/wiki/Data_scraping)：从人类可读的输出中提取数据的行为。在您的情况下，这是`<div>`标签之间的任何内容。使用[PHP DOM](http://www.php.net/manual/en/intro.dom.php)的扩展来获取您想要的标签并提取数据。谷歌搜索一个 PHP DOM 教程。

# c# - 自定义 SharePoint 2007 子网站导航控件

> ID：11567638
> 
> 赞同：0
> 
> 时间：2012-07-19T19:06:45.577
> 
> 标签：c#, sharepoint-2007, navigation, sitemapprovider

我被要求创建一个允许在 SharePoint 2007 网站的子网站之间进行自定义导航的 asp.net UserControl。这些网站模仿了一个学校结构，每个学期都有不同的班级。这是网站结构的简化版本：

```
Site Root
    Search
    Semester1
        Class Group 1
            Class 1
                Page1.aspx
                Page2.aspx
            Class 2
                Page1.aspx
                Page2.aspx
        Class Group 2
            Class 3
                Page1.aspx
                Page2.aspx
            Class 4
                Page1.aspx
                Page2.aspx
    Semester2
        Class Group 1
            Class 1
                Page1.aspx
                Page2.aspx
            Class 2
                Page1.aspx
                Page2.aspx
        Class Group 2
            Class 3
                Page1.aspx
                Page2.aspx
            Class 4
                Page1.aspx
                Page2.aspx
    Some Other Subsites 
```

UserControl 将放置在类的 .aspx 页面上。它的目的是允许用户导航到不同类组之间的相同页面。

EG 假设我在 Semester1/Class Group 1/Class 1/Page2.aspx。UserControl 将允许我选择 Semester1 下的任何其他课程。选择后，它会自动导航到 [选定的类]/Page2.aspx（因为我目前在 Page2.aspx 上）。

在今天之前，我从未使用过 SiteMapProvider。到目前为止，我只设法以编程方式遍历站点结构并使用默认的 CombinedNavSiteMapProvider PortalSiteMapProvider 将简单的站点地图打印到页面。我认为我需要但不知道该怎么做是：

*   获取/构建部分站点地图数据结构，其中根节点是当前页面的父学期。如有必要，这可以是我自己在代码中构建的数据结构。我想将此绑定到菜单控件。此外，我希望根菜单项具有自定义文本，例如“更改课程”而不是第 1 学期。

从那里，我想我可以使用菜单事件来处理导航。如果我在 Semester1/Class Group 1/Class 1/Page2.aspx，则 UserControl 的菜单示例：

```
 Change Class
        Class Group 1
            Class 1
            Class 2
        Class Group 2
            Class 3
            Class 4 
```

我怎样才能完成上面的项目符号？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T21:39:20.257

我没有发现任何优雅的东西。我最终将一个 asp.net 菜单绑定到 CombinedNavSiteMapProvider，然后在 DataBound 事件处理程序中，我修改了代码中的菜单项。我插入一个根“更改类”项，然后使用一点递归方法将任何具有子项的菜单项的 IsSelectable 设置为 false。

# iphone - 使用 Jeff Lamarches 脚本加载模型

> ID：11567640
> 
> 赞同：0
> 
> 时间：2012-07-19T19:06:53.110
> 
> 标签：iphone, objective-c, ios, opengl-es

我正在尝试使用 Jeff Lamarches python 脚本将 3D 模型加载到场景中，以将 3D 模型导出到 Blender 中的 Objective C 头文件中。

我正在使用 Blender 版本：2.63a

从这里得到 Lamarche 的脚本：[https ://github.com/jlamarche/iOS-OpenGLES-Stuff](https://github.com/jlamarche/iOS-OpenGLES-Stuff)

我做了什么

*   按照说明中的说明安装脚本
*   使用默认立方体打开搅拌器
*   试图导出默认 3D 的 Objective C 头文件

头文件是在没有任何顶点数据的情况下生成的，知道为什么会这样吗？请提供任何可能帮助我将 3D 模型及其纹理加载到 iOS GL 上下文中的参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T06:40:10.823

您必须处于编辑模式。确保打开立方体并保存 png 并将其加载到 xcode 中。如果这不起作用，也可以在编辑模式下尝试，单击网格->面->三角面。

# javascript - 关于相同类型元素的元素索引？

> ID：11567642
> 
> 赞同：0
> 
> 时间：2012-07-19T19:07:01.317
> 
> 标签：javascript, jquery

> **可能重复：**
> [获取所选元素的位置，而不是 DOM 中元素的索引](https://stackoverflow.com/questions/11423357/get-position-of-selected-elements-not-index-of-element-in-dom)

使用 JQuery，获取元素索引的最佳方法是什么？

```
<span/>
<span/>
<div/>
<span/> <-- index of this guy in regard to just span tags? (answer: 2) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:03:04.890

通过比较元素引用如何使用 jQuery 执行此操作的示例：

jQuery解决方案：

```
var tested_element = document.getElementById('tested');
alert( $('#test').children('span').index(tested_element) ); // result: 2 
```

javascript解决方案：

```
var tested = document.getElementById('tested');
var container = document.getElementById('test');
var node = container.childNodes[0];
var position = 0;
while ( node && node != tested ){
    if (node.nodeType == 1 && node.tagName == 'SPAN') {
        position++;
    }
    node = node.nextSibling;
}
if (!node) {
    position = -1; // element not found
}
alert(position); 
```

测试的html：

```
<div id="test">
    <span>A</span>
    <span>B</span>
    <div>C</div>
    <span id="tested">D</span>
    <span>E</span>
</div> 
```

# java - Hibernate/JPA 双向级联 saveOrUpdate

> ID：11567644
> 
> 赞同：1
> 
> 时间：2012-07-19T19:07:02.763
> 
> 标签：java, hibernate, jpa, hibernate-4.x

我正在尝试为 2 个实体（新闻和标签）建立多对多双向关系。

但是当我尝试保存或更新新闻（已设置）时，它总是以某种方式保存一组新的标签，即使标签中已经填充了 id

我的注释有问题吗？

新闻.java

```
 @Id
    @GeneratedValue(generator = "increment")
    @GenericGenerator(name = "increment", strategy = "increment")
    @Column(name = "NEWS_ID")
    public Long getId() {
        return id;
    }

    @ManyToMany(fetch = FetchType.LAZY,  cascade = {CascadeType.PERSIST, CascadeType.MERGE})
    @Cascade( org.hibernate.annotations.CascadeType.SAVE_UPDATE )
    @JoinTable(name = "NEWS_TAGS", joinColumns = @JoinColumn(name = "NEWS_ID"), inverseJoinColumns = @JoinColumn(name = "TAG_ID"))
    public Set<Tag> getTags() {
        return tags;
    } 
```

标签.java

```
 @Id
    @GeneratedValue(generator = "increment")
    @GenericGenerator(name = "increment", strategy = "increment")
    @Column(name = "TAG_ID")
    public Long getId() {
        return id;
    }

    private Collection<News> news;

    @JsonIgnore
    @ManyToMany(cascade = { CascadeType.PERSIST, CascadeType.MERGE }, mappedBy = "tags")
    public Collection<News> getNews() {
        return news;
    } 
```

新闻DAO

```
public void save(News news){
         this.hibernateSessionFactory.getCurrentSession().saveOrUpdate(news);
    } 
```

我想要做的是，当我保存“新闻”时，如果标签存在，相关的集合将被忽略，如果标签不存在，将插入新的，这可能吗？

请指教

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:03:43.643

问题是您的对象（标签）没有“连接”。我的意思是休眠不知道您的对象，当您尝试保存新闻时，休眠将始终将您的标签视为新对象。尝试在保存或更新之前从 db 获取 Tag 对象并使用此对象。

# mod-rewrite - 如何使用 mod_write 从 url 中删除 index.php，同时仍然允许 php 查看包含 index.php 的路径？

> ID：11567652
> 
> 赞同：1
> 
> 时间：2012-07-19T19:07:19.513
> 
> 标签：mod-rewrite

在过去的 3 天里，我一直在玩 Apache 的 mod_rewrite，试图让它从我的 url 中删除 index.php，而 php 仍然需要在路径中看到它。

```
Essentially PHP needs to see this
http://example.com/index.php/Page/Param1/Param2

While the user needs to see this
http://example.com/Page/Param1/Param2 
```

我现在拥有的是 htaccess 文件中的以下内容

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?$1 [L,QSA]

RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s(.*)/index\.php [NC]
RewriteRule ^ /%1 [R=301,L] 
```

取自另一页，与我需要的很接近。然而，这似乎切断了`http://example.com/`部分之后的一切。如何让 mod_rewrite 向用户显示一件事并让 php 看到其他内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T01:08:51.327

这条规则：

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s(.*)/index\.php [NC]
RewriteRule ^ /%1 [R=301,L] 
```

需要看起来像这样：

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\ /index\.php(.*)\  [NC]
RewriteRule ^ /%1 [R=301,L] 
```

另请注意，`RewriteRule ^(.*)$ index.php?$1 [L,QSA]`它不会创建一个看起来像这样的 URI `/index.php/Page/Param1/Param2`，它会创建一个看起来像这样的查询字符串：`/index.php?Page/Param1/Param2`。这根本不是您所说的 PHP 需要看到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T03:39:01.160

这是您可以在 .htaccess（在 DOCUMENT_ROOT 下）中使用的修改后的代码，用于从 URI 中删除 index.php：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule (?!^index\.php)^(.+)$ /index.php/$1 [L,NC]

RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s(.*)/index\.php(/[^\s\?]+)? [NC]
RewriteRule ^ %1%2 [R=302,L] 
```

一旦您对它工作正常感到满意，请将 R=302 更改为 R=301。

# ruby-on-rails-3 - Rails App 不适用于生产环境

> ID：11567654
> 
> 赞同：0
> 
> 时间：2012-07-19T19:07:40.460
> 
> 标签：ruby-on-rails-3, nginx, passenger

我有一个使用 Nginx + 乘客设置的 rails 应用程序。当我进行 rails_env 开发时；在我的 nginx.conf 上一切正常，但是当我删除它以便应用程序在生产环境中获取服务器时它只是不起作用，似乎它没有加载宝石或其他东西。随意看看这里的错误[www.luisurraca.co.cc](http://www.luisurraca.co.cc)

```
error message:
undefined method `has_attached_file' for #<Class:0x00000003b0be10>
Exception class:
NoMethodError 
```

现在它指的是回形针 gem，但是如果我开始从 gemfile 中删除 gem，它将显示来自其他 gem 的错误等等。

任何想法可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:01:38.503

您可能在开发组中定义了回形针/任何东西，但它没有安装`bundle install --deployment`. 要查看已安装的 gems，请`bundle show`不要`gem list`。

您是否为 nginx 指定了 ruby​​ 路径？它应该是这样的：

```
 http {
        passenger_root /home/rlisowski/.rvm/gems/ruby-1.9.3-p194/gems/passenger-3.0.13;
        passenger_ruby /home/rlisowski/.rvm/wrappers/ruby-1.9.3-p194/ruby; 
        # .... 
```

# image - 图像配准：跨参考转换模板时获得重叠区域以进行相似性度量

> ID：11567655
> 
> 赞同：2
> 
> 时间：2012-07-19T19:07:45.643
> 
> 标签：image, opencv, registration

当我们将一个图像注册到另一个图像（相同大小）时，我们将模板图像转换为参考图像。

假设模板部分重叠到参考边界区域，我们如何提取重叠区域来计算相似性度量...（例如使用 ncc 或 mi）

同样，搜索范围是多少

opencv中的任何参考示例或代码？

提前致谢

# apache - 未找到 Apache 2.2 VirtualHosts URL

> ID：11567660
> 
> 赞同：0
> 
> 时间：2012-07-19T19:07:53.003
> 
> 标签：apache, apache2, virtualhost, vhosts, virtual-hosts

我希望你能帮忙。我有一个现有的 Apache 2.2 服务器，它为我维护的网站提供服务。我正在尝试为同事添加其他网站。这样做后，当我尝试访问 URL 时，我得到以下信息：

> 未找到 在此服务器上未找到请求的 URL /。

这是我的 httpd-vhosts.conf 文件的摘要。我有三个新的、大致相同的主机无法正常工作。只有 NDV 和默认值有效。

```
NameVirtualHost *:80

<VirtualHost anycast.ns.cs.boeing.com:80>
        ServerName anycast.ns.cs.boeing.com
        ServerAdmin aodhan.hoffman@boeing.com
        DocumentRoot "/opt/www/anycast"

        ScriptAlias /cgi-bin "/opt/www/anycast/cgi-bin/"
        ErrorLog "logs/grant_error_log"
        CustomLog "logs/grant_access_log" common
</VirtualHost>

<VirtualHost *:80>
        ServerAdmin aodhan.hoffman@boeing.com
        DocumentRoot "/opt/httpd/manual"
        ServerAlias ntpm-application-01.ns.cs.boeing.com
        ErrorLog "logs/error_log"
        CustomLog "logs/access_log" common
</VirtualHost>

<VirtualHost *:80>
        ServerAdmin aodhan.hoffman@boeing.com
        DocumentRoot "/opt/www/ndv/html"
        ServerName ndv.web.boeing.com
        ScriptAlias /cgi-bin/ "/opt/www/ndv/cgi-bin/"
        ErrorLog "logs/error_log"
        CustomLog "logs/access_log" common
</VirtualHost>

<Directory "/opt/www/ndv/html/" >
        Options Indexes FollowSymLinks Includes 
        AddType text/html .shtml
        AddOutputFilter INCLUDES .shtml 
        Order allow,deny
        Allow from all
</Directory>

<Directory "/opt/www/anycast/html/" >
        Options Indexes FollowSymLinks Includes 
        Order allow,deny
        Allow from all
</Directory> 
```

根据上面的配置，这就是服务器所看到的。

```
$ sudo bin/apachectl -S

VirtualHost configuration:
wildcard NameVirtualHosts and _default_ servers:
*:80                   is a NameVirtualHost
         default server ntpm-application-01.ns.cs.boeing.com (/opt/httpd/conf/extra/httpd-vhosts.conf:30)
         port 80 namevhost ntpm-application-01.ns.cs.boeing.com (/opt/httpd/conf/extra/httpd-vhosts.conf:30)
         port 80 namevhost ndv.web.boeing.com (/opt/httpd/conf/extra/httpd-vhosts.conf:39)
         port 80 namevhost anycast.ns.cs.boeing.com (/opt/httpd/conf/extra/httpd-vhosts.conf:48)
         port 80 namevhost ntpget.ns.cs.boeing.com (/opt/httpd/conf/extra/httpd-vhosts.conf:60)
         port 80 namevhost dnsdig.ns.cs.boeing.com (/opt/httpd/conf/extra/httpd-vhosts.conf:70)
Syntax OK 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:25:09.927

您似乎混合了配置方法：

```
NameVirtualHost *:80

<VirtualHost *:80>
ServerName www.domain.tld
ServerAlias domain.tld *.domain.tld
DocumentRoot /www/domain
</VirtualHost>

<VirtualHost *:80>
ServerName www.otherdomain.tld
DocumentRoot /www/otherdomain
</VirtualHost> 
```

这是 Apache Docs 关于基于名称的 VHosts 的示例。

我可以在您的配置 VirtualHost 中看到没有 * -> anycast.ns.cs.boeing.com:80

以及没有服务器名称的虚拟主机，例如 ServerAlias ntpm-application-01.ns.cs.boeing.com，它有一个别名，但没有名称。

我会开始平衡示例中的配置，然后尝试 apache 是否对此更满意。

简而言之：确保每个条目都有 *:80 和服务器名称。

编辑：此配置未经测试，但可能对您有用

```
NameVirtualHost *:80

<VirtualHost *:80>
        ServerName anycast.ns.cs.boeing.com

        ServerAdmin aodhan.hoffman@boeing.com
        DocumentRoot "/opt/www/anycast/html"

        ScriptAlias /cgi-bin "/opt/www/anycast/cgi-bin/"
        ErrorLog "logs/grant_error_log"
        CustomLog "logs/grant_access_log" common

        <Directory "/opt/www/anycast/html/" >
            Options Indexes FollowSymLinks Includes 
            Order allow,deny
            Allow from all
        </Directory>        
</VirtualHost>

<VirtualHost *:80>
        ServerName ntpm-application-01.ns.cs.boeing.com

        ServerAdmin aodhan.hoffman@boeing.com
        DocumentRoot "/opt/httpd/manual"

        ErrorLog "logs/error_log"
        CustomLog "logs/access_log" common
</VirtualHost>

<VirtualHost *:80>
        ServerName ndv.web.boeing.com

        ServerAdmin aodhan.hoffman@boeing.com
        DocumentRoot "/opt/www/ndv/html"

        ScriptAlias /cgi-bin/ "/opt/www/ndv/cgi-bin/"
        ErrorLog "logs/error_log"
        CustomLog "logs/access_log" common

        <Directory "/opt/www/ndv/html/" >
            Options Indexes FollowSymLinks Includes 
            AddType text/html .shtml
            AddOutputFilter INCLUDES .shtml 
            Order allow,deny
            Allow from all
        </Directory>
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-21T19:33:25.867

我的建议是打开并阅读 apache 生成的所有日志。这将为您提供问题所在的线索。`"/private/var/log/apache2/error_log"`我在 Mac 中阅读了日志并找到了我的线索：`DocumentRoot [/path/to/rootdir] does not exist.`

我打开了 vhost 文件，发现我没有用双引号将根目录封装，而是使用了其他看起来像双引号的字符。我用真正的双引号替换了它们，重新启动了 apache，然后错误就消失了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-14T17:41:49.460

对我有用的是卸载和升级（在我的情况下为 Wampserver）您正在使用的软件。

# install4j - 如何使用试用版通过 telnet 运行 Windows 安装程序？

> ID：11567662
> 
> 赞同：0
> 
> 时间：2012-07-19T19:08:05.457
> 
> 标签：install4j

我正在评估我们公司的 install4j。

我们构建了一个 win32 安装程序，并且我们正在尝试建立一个持续集成环境来对其进行测试。

CI 服务器能够使用 FTP 将安装程序上传到 windows 目标机器（这是一个虚拟化环境），并运行看起来像这样的批处理脚本

```
cd c:\tmp\upload\
my_installer.exe -q -varfile response.varfile -console 
```

目前我们正在使用 install4j 5 的试用版。

当安装程序从命令行运行（通过远程桌面上的 cmd.exe）时，我会看到一个弹出窗口，警告试用版。安装被冻结，直到我单击确定。

当安装程序从 telnet 运行时，该命令会挂起并且永远不会返回。我相信原因是那个弹出窗口。

要全面评估 install4j，我们需要能够了解它如何适合我们的 CI 流程。

有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T09:13:52.977

这是评估版本的限制，使用永久许可证密钥将不会显示评估对话框并且问题将消失。

# javascript - 谷歌地图样本阅读数据

> ID：11567664
> 
> 赞同：1
> 
> 时间：2012-07-19T19:08:18.243
> 
> 标签：javascript, google-maps

我正在查看谷歌地图示例 [http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/examples/simple_example.html](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/examples/simple_example.html)

它似乎正在从以下位置读取数据：http: [//google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/src/data.json](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/src/data.json)

使用 firebug 运行 firefox，var data.photos 会被数据填充。

有人可以解释这是怎么发生的吗？我一定在代码中遗漏了一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T11:55:42.940

data.json 中的数据对象在包含在页面中时可用。

数据.json：

```
 var data = { "count": 10785236,
        "photos": [{"..... 
```

# sql-server - 非规范化购买商品的数据

> ID：11567665
> 
> 赞同：0
> 
> 时间：2012-07-19T19:08:29.957
> 
> 标签：sql-server, database, sql-server-2008-r2

我有下表：

```
BoughtItems 

UserID  ItemID  StoreID  Quantity  Price
1       1       1        1         1
1       4       1        2         3
1       5       2        1         3 
```

让我们假设`BoughtItems`表中每个用户的项目不超过五个。

我想拥有来自某个 StoreID 的所有客户和所有购买的商品，采用这种格式......对于 StoreID = 1，结果将是：

```
UserID  Item1ID  Item2ID  Item3ID  Item4ID  Item5ID
1       1        4        [empty]  [empty]  [empty] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:27:44.690

```
DECLARE @StoreID INT;

SET @StoreID = 1;

;WITH x AS
(
  SELECT UserID, ItemID, 
    rn = ROW_NUMBER() OVER (PARTITION BY UserID ORDER BY ItemID)
  FROM dbo.BoughtItems
  WHERE StoreID = @StoreID
)
SELECT UserID,
    Item1ID = MAX(CASE WHEN rn = 1 THEN ItemID END),
    Item2ID = MAX(CASE WHEN rn = 2 THEN ItemID END),
    Item3ID = MAX(CASE WHEN rn = 3 THEN ItemID END),
    Item4ID = MAX(CASE WHEN rn = 4 THEN ItemID END),
    Item5ID = MAX(CASE WHEN rn = 5 THEN ItemID END)
FROM x WHERE rn <= 5
GROUP BY UserID; 
```

# python - 计算多对多关系中的行数（SQLAlchemy）

> ID：11567666
> 
> 赞同：13
> 
> 时间：2012-07-19T19:08:31.083
> 
> 标签：python, sqlalchemy

我说博客条目和标签之间存在多对多的关系。现在我想知道特定标签有多少条目。

想象以下模型（简化）：

```
rel_entries_tags = Table('rel_entries_tags', Base.metadata,
  Column('entry_id', Integer, ForeignKey('entries.id')),
  Column('tag_id', Integer, ForeignKey('tags.id'))
)

class Entry(Base):
  __tablename__ = 'entries'

  id = Column(Integer, primary_key=True)
  title = Column(String(80))
  text = Column(Text)

  tags = relationship('Tag', secondary=rel_entries_tags, backref=backref('entries'))

  def __init__(self, title, text):
    self.title = title
    self.text = text
    self.tags = tags    

class Tag(Base):
  __tablename__ = 'tags'

  id = Column(Integer, primary_key=True)
  name = Column(String(80), unique=True, nullable=False)

  def __init__(self, name):
    self.name = name 
```

我计算标签条目数量的方法是`len(db_session.query(Tag).get(1).entries)`. 问题是，当它获取`db_session.query(Tag).get(1).entries`SQLAlchemy 时选择所有条目及其所有列作为标记，但是，我只想要条目的数量，而不是条目本身。这个问题有更优化的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-19T20:01:12.470

```
session.query(Entry).join(Entry.tags).filter(Tag.id==1).count() 
```

或者如果您已经有标签

```
session.query(Entry).with_parent(mytag, "entries").count() 
```

# javascript - 使用 d3.js 将 SVG 转为画布

> ID：11567668
> 
> 赞同：18
> 
> 时间：2012-07-19T19:08:41.903
> 
> 标签：javascript, node.js, select, svg, d3.js

有没有人在创建 d3.js 可视化时尝试使用 svg 到画布库？我尝试使用 canvg.js 和 d3.js 从 android 2.3 应用程序 webview 中将 svg 转换为画布，但是当我调用时：

```
svg.selectAll(".axis")
    .data(d3.range(angle.domain()[1]))
    .enter().append("g")
    .attr("class", "axis")
    .attr("transform", function(d) { return "rotate(" + angle(d) * 180 / Math.PI + ")"; })
    .call(d3.svg.axis()
        .scale(radius.copy().range([-5, -outerRadius]))
        .ticks(5)
        .orient("left"))
    .append("text")
    .attr("y", 
        function (d) {
            if (window.innerWidth < 455){
                console.log("innerWidth less than 455: ",window.innerWidth);
                return -(window.innerHeight * .33);
            }
            else {
                console.log("innerWidth greater than 455: ",window.innerWidth);
                return -(window.innerHeight * .33);
            }
        })
    .attr("dy", ".71em")
    .attr("text-anchor", "middle")
    .text(function(d, i) { return capitalMeta[i]; })
    .attr("style","font-size:12px;"); 
```

我收到错误：未捕获的 TypeError：无法调用`setProperty`null [http://mbostock.github.com/d3/d3.js?2.5.0:1707的方法](http://mbostock.github.com/d3/d3.js?2.5.0:1707)

某种无头浏览器应用程序或服务器端 js 解析器会起作用吗？有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2014-05-14T23:46:52.623

这是您可以将 svg 写入画布的一种方法（然后将结果另存为 png 或其他格式）：

```
// Create an export button
d3.select("body")
    .append("button")
    .html("Export")
    .on("click",svgToCanvas);

var w = 100, // or whatever your svg width is
    h = 100;

// Create the export function - this will just export 
// the first svg element it finds
function svgToCanvas(){
    // Select the first svg element
    var svg = d3.select("svg")[0][0],
        img = new Image(),
        serializer = new XMLSerializer(),
        svgStr = serializer.serializeToString(svg);

    img.src = 'data:image/svg+xml;base64,'+window.btoa(svgStr);

    // You could also use the actual string without base64 encoding it:
    //img.src = "data:image/svg+xml;utf8," + svgStr;

    var canvas = document.createElement("canvas");
    document.body.appendChild(canvas);

    canvas.width = w;
    canvas.height = h;
    canvas.getContext("2d").drawImage(img,0,0,w,h);
    // Now save as png or whatever
}; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-06-28T20:37:37.750

@ace 的答案非常好，但是它不处理外部 CSS 样式表的情况。我下面的示例将自动为生成的图像设置原始 SVG 外观的样式，即使它从单独的样式表中提取样式也是如此。

```
// when called, will open a new tab with the SVG
// which can then be right-clicked and 'save as...'
function saveSVG(){

    // get styles from all required stylesheets
    // http://www.coffeegnome.net/converting-svg-to-png-with-canvg/
    var style = "\n";
    var requiredSheets = ['phylogram_d3.css', 'open_sans.css']; // list of required CSS
    for (var i=0; i<document.styleSheets.length; i++) {
        var sheet = document.styleSheets[i];
        if (sheet.href) {
            var sheetName = sheet.href.split('/').pop();
            if (requiredSheets.indexOf(sheetName) != -1) {
                var rules = sheet.rules;
                if (rules) {
                    for (var j=0; j<rules.length; j++) {
                        style += (rules[j].cssText + '\n');
                    }
                }
            }
        }
    }

    var svg = d3.select("svg"),
        img = new Image(),
        serializer = new XMLSerializer(),

    // prepend style to svg
    svg.insert('defs',":first-child")
    d3.select("svg defs")
        .append('style')
        .attr('type','text/css')
        .html(style);

    // generate IMG in new tab
    var svgStr = serializer.serializeToString(svg.node());
    img.src = 'data:image/svg+xml;base64,'+window.btoa(unescape(encodeURIComponent(svgStr)));
    window.open().document.write('<img src="' + img.src + '"/>');
}; 
```

并且，要完成，调用该函数的按钮：

```
// save button
d3.select('body')
    .append("button")
    .on("click",saveSVG)
    .attr('class', 'btn btn-success') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-09T10:43:12.450

我没有尝试过库，但是 在 MDN 上的[这篇文章之后将 d3 生成的 SVG 渲染到画布上。](https://developer.mozilla.org/en/docs/HTML/Canvas/Drawing_DOM_objects_into_a_canvas)

这段代码是 MDN 和一些 jQuery 的快速混搭，你需要整理一下，它没有错误或平台检查，但它有效，我希望它有所帮助。

```
$(document.body).append(
    '<canvas id="canvas" width="'+diameter+'" height="'+diameter+'"></canvas>'
);

// https://developer.mozilla.org/en/docs/HTML/Canvas/Drawing_DOM_objects_into_a_canvas
var el = $($('svg')[0]);
var svgMarkup = '<svg xmlns="http://www.w3.org/2000/svg"'
+ ' class="'  + el.attr('class') +'"'
+ ' width="'  + el.attr('width') +'"'
+ ' height="' + el.attr('height') +'"'
+ '>'
+ $('svg')[0].innerHTML.toString()+'</svg>';
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");
var DOMURL = this.URL || this.webkitURL || this;
var img = new Image();
var svg = new Blob([svgMarkup], {type: "image/svg+xml;charset=utf-8"});
var url = DOMURL.createObjectURL(svg);
img.onload = function() {
    ctx.drawImage(img, 0, 0);
    alert('ok');
    DOMURL.revokeObjectURL(url);
};
img.src = url; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T05:52:01.777

您是否在支持 SVG 的浏览器上尝试过相同的代码来查看是否是 webview 的问题？然后尝试使用 canvg 的[示例或](http://jsfiddle.net/plaliberte/HAXyd/)[使用](http://bl.ocks.org/2294676)DOM 序列化的示例。对于服务器端渲染，您可以从[这个示例](https://github.com/mbostock/d3/blob/master/examples/node-canvas/us-counties.js)开始，了解如何使用 Node.js 将其渲染到画布服务器端。

# javascript - 将 js 代码转换为 jQueryMobile 时出错

> ID：11567674
> 
> 赞同：0
> 
> 时间：2012-07-19T19:09:02.067
> 
> 标签：javascript, jquery, jquery-mobile, timer

我有一个用于计时器的 javascript/jquery 代码[http://jsfiddle.net/9773D/ 。](http://jsfiddle.net/9773D/)

我正在尝试将它移植到 jQuery Mobile 代码，但我对 pageinit、bind、live 等窗口事件感到困惑。

在代码中，我看到错误是因为在代码中调用它之前，tick() 函数中的某些元素没有加载到 DOM 中。有人可以帮助我更正我的代码。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:17:30.543

我把你的线路改为

`var timeDisplay = $(".time")[0];`

这解决了它。

**编辑：**

*添加说明：*

由于您使用的是 innerHTML 而不是`$('.time').html("")`，因此您需要将 timeDisplay 设置为 HTML 节点，因为`innerHTML`它是节点的属性，而不是 selector 返回的 jQuery 对象`$('.time')`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:28:34.403

这是一个 jsfiddle，它展示了如何以更 jquery'sh 的方式完成它。[http://jsfiddle.net/9773D/1/](http://jsfiddle.net/9773D/1/)

```
timedisplay.innerHtml = "" //does not work since timedisplay is a jquery object 
//timedisplay[0] is the html object so on that innerHtml does work 
```

但是jquery有这个功能`.html("");`

```
timedisplay.html(""); // is a bit cleaner 
```

# internet-explorer - 哪种模式与JSP交叉兼容

> ID：11567678
> 
> 赞同：0
> 
> 时间：2012-07-19T19:09:10.377
> 
> 标签：internet-explorer, jsp, firefox, google-chrome, tomcat

我正在设计我的网站`jsp`。我正在使用`Apache tomcat`服务器来运行我的网站。我的网站在`Firefox`和`Chrome`. 然而，`Internet Explorer 8`它的行为异常。
在 Internet Explorer 中，存在一些用于查看 Web 的模式。我的问题是，`mode`在设计网页时，哪个是交叉兼容和高度可接受的`jsp`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T17:22:48.267

很可能，这与 JSP 无关。JSP 只是混合 Java 和 HTML 代码的一种方式。HTML 代码中一定有一些 IE8 不喜欢的东西。

将模式设置为怪癖或标准模式可能会有所帮助，但没有一种模式可以让所有浏览器的行为都相同。不过，您可以在此处找到有关浏览器模式的完整讨论：http: [//hsivonen.iki.fi/doctype/](http://hsivonen.iki.fi/doctype/)

你还能尝试什么？

*   使用 IE8 内置的开发人员工具（请参阅此答案：[How to debug Javascript with IE 8](https://stackoverflow.com/questions/1306232/how-to-debug-javascript-with-ie-8)）检查 IE8 是否在控制台中为您提供任何错误消息。
*   在您的应用程序中添加调试信息，以查看似乎已损坏的代码周围发生了什么
*   问一个没有“行为异常”字样的问题。相反，请告诉我们您所看到的和您的期望，我们可能会提供帮助。

# jquery - 由于变量范围，jQuery第一次单击不起作用

> ID：11567684
> 
> 赞同：0
> 
> 时间：2012-07-19T19:09:38.820
> 
> 标签：jquery, variables, scope, click, each

我正在尝试提取包含在 YouTube 视频的 URL 中的视频 ID，然后将该 ID 存储在一个变量中，我可以在创建 iframe 以嵌入 YouTube 视频时引用该变量。

下面是我的代码：

```
 $(".result").live("click", function () {
       var result_number = 0;
       youtubequery = "https://gdata.youtube.com/feeds/api/videos?category=Music&q=thesongstitle&v=2&alt=json&max-results=5";
       youtubeid = "";
       $.getJSON(youtubequery, function (vid_data) {
           $.each(vid_data.feed.entry, function (e, vid) {
               if (e == result_number) {
                   youtubeid = vid.id.$t.substring(27);
               }
           });
       });
       iframehtml = "<iframe height='300' width='400' src='http://www.youtube.com/embed/" + youtubeid + "?autoplay=1' frameborder='0' allowfullscreen></iframe>";
       $("#youtube_vid").html(iframehtml);
   }); 
```

当我第一次单击“结果”类的 div 时，YouTube ID 不包含在存储在变量 iframehtml 中的 iframe html 中。但是，当我第二次单击它时，一切都按预期工作。有谁知道这可能是什么原因造成的？当我包含 iframehtml 变量的创建和将 html 放入#youtube_vid 的行时，我能够让它工作，但由于我网站的功能，我无法以这种方式对其进行编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:14:34.827

您的 getJSON 函数正在执行异步 http get 请求。因此，当您调用它时，它会在数据从请求中返回之前返回。当您再次单击 .result 时，数据已返回。试着把

```
iframehtml = "<iframe height='300' width='400' src='http://www.youtube.com/embed/" + youtubeid + "?autoplay=1' frameborder='0' allowfullscreen></iframe>";
$("#youtube_vid").html(iframehtml); 
```

在您的 getJSON 回调函数中，在 html 显示之前会有延迟，但它会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:14:45.607

您填写 ID 字段的`$.each()`位置在 AJAX 回调函数中异步运行，但您正在尝试立即使用该变量。

您还需要`iframe`在回调函数期间添加：

```
$(".result").live("click", function () {
    var result_number = 0;
    var youtubequery = "https://gdata.youtube.com/feeds/api/videos?category=Music&q=thesongstitle&v=2&alt=json&max-results=5";
    $.getJSON(youtubequery, function (vid_data) {
        var youtubeid;
        $.each(vid_data.feed.entry, function (e, vid) {
            if (e == result_number) {
                youtubeid = vid.id.$t.substring(27);
            }
        });
        iframehtml = "<iframe height='300' width='400' src='http://www.youtube.com/embed/" + youtubeid + "?autoplay=1' frameborder='0' allowfullscreen></iframe>";
        $("#youtube_vid").html(iframehtml);
    });
}); 
```

FWIW，您可能更喜欢在您的标记中预先创建`iframe`所需的大小，然后只需设置`.src`属性即可开始加载。见[http://jsfiddle.net/alnitak/z4rQg/](http://jsfiddle.net/alnitak/z4rQg/)

# javascript - 是否可以监控 Safari 扩展中的所有网络流量？

> ID：11567689
> 
> 赞同：12
> 
> 时间：2012-07-19T19:10:22.517
> 
> 标签：javascript, safari-extension

由于较新版本的 Safari（我正在运行 5.2 版）似乎已从“窗口”菜单中删除了“活动”查看器，因此我想编写一个扩展程序以恢复此功能。但是，为了做到这一点，我认为我需要能够查看该窗口/选项卡中请求的 URL。对于 Chrome，有一个[“webRequest”API](http://code.google.com/chrome/extensions/trunk/webRequest.html)可以执行此操作，但我似乎无法在 Safari 中找到要执行此操作的内容。有人可以告诉我这是否可能，如果可以，我接下来应该去哪里看？提前致谢。

到目前为止，我能得到的最多的是使用注入的启动脚本，如下所示：

```
function trackRequests() {
    console.log(event.timeStamp + ": " + event.type, event.url, event);
}
document.addEventListener("beforeload", trackRequests, true); 
```

但是，这并不足以满足我需要的功能。例如，如果指定的 URL 没有协议，例如“//example.com/file.txt”，这是所有处理程序看到的；它不知道使用了什么实际协议或请求是否被允许。

似乎[Apple 论坛](https://discussions.apple.com/thread/4138462?start=0&tstart=0)、[MacDailyNews](http://macdailynews.com/2012/08/10/the-top-10-most-missed-features-apple-removed-from-os-x-mountain-lion/)和[ArsTechnica](http://arstechnica.com/apple/2012/08/the-10-features-removed-from-mountain-lion-that-we-miss-the-most/)上的一些人表示希望在 Safari 中也恢复此功能。 [这是 MacRumors.com](http://forums.macrumors.com/showthread.php?t=1411248)和[另一个](http://forums.macrumors.com/showthread.php?p=15330042#post15330042).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T10:32:46.570

在 Windows 上，我会使用 Fiddler，但由于您似乎使用的是 Mac，这里有一些替代方案：

[http://alternativeto.net/software/fiddler/?platform=mac](http://alternativeto.net/software/fiddler/?platform=mac)

希望这可以帮助！

干杯!

# c# - 无法在确认框中使用 \n 获取新行

> ID：11567692
> 
> 赞同：0
> 
> 时间：2012-07-19T19:10:39.337
> 
> 标签：c#, javascript

下面是我的代码

```
btnDelete.Attributes.Add("onclick", "{return ConfirmAction('You are about to Delete Order . Please Note \r\n  1\. Order no longer can be retrieved \r\n 2\. Changes to the order are not saved. \r\n Are you sure you wish to continue to Delete?')};"); 
```

我希望确认框显示带有是和取消按钮的消息，如下所示：

您即将删除订单。请注意： 1.订单无法
找回
2.订单更改未保存
您确定要继续删除吗？

我尝试了 "\n" 、 '\n' 和 "\r\n" ，但仍然无法插入行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:12:58.950

您在字符串中有一个字符串，因此您需要转义反斜杠：

```
btnDelete.Attributes.Add("onclick", "{return ConfirmAction('You are about to Delete Order . Please Note \\n  1\. Order no longer can be retrieved \\n 2\. Changes to the order are not saved. \\n Are you sure you wish to continue to Delete?')};"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:16:41.347

```
String buttonString = "{return ConfirmAction('You are about to Delete Order . Please Note \r\n  1\. Order no longer can be retrieved \r\n 2\. Changes to the order are not saved. \r\n Are you sure you wish to continue to Delete?')};"
buttonString = buttonString.Replace("\r\n", Environment.NewLine);
btnDelete.Attributes.Add("onclick", buttonString); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:12:46.667

我不知道您正在使用的组件，但是您尝试过`<br />`吗？如果它接受 HTML，那可能会起作用:)

# java - 可视化逻辑流程的程序

> ID：11567697
> 
> 赞同：2
> 
> 时间：2012-07-19T19:11:07.040
> 
> 标签：java, cobol, flow, visualize

我在一个企业系统中工作，我们刚刚收到一个旧的 COBOL 文件，里面装满了业务规则。它是为变量赋值的大量 IF ELSE 语句集合。是否有一个程序可以让我输入所有这些 IF ELSE 逻辑语句并查看最后的整体流程？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:42:29.047

我使用我们心爱的谷歌发现了这个：

[http://www.aivosto.com/visustin.html](http://www.aivosto.com/visustin.html)
[http://www.aivosto.com/visustin/help/cobol.html](http://www.aivosto.com/visustin/help/cobol.html)
[http://www.usflowchart.com/](http://www.usflowchart.com/)

另外，我建议您在提问之前搜索 StackOverflow：
[迁移 COBOL 代码](https://stackoverflow.com/questions/3597331/migrate-cobol-code)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T14:16:46.357

IBM 的 Rational Developer for z/OS 对此有很多帮助——它将格式化和缩进您的源文件以便于人类理解；它将为您提供树线轮廓视图；有一些报告和 UML 扩展可用，尽管我从未将它们与 Cobol 一起使用，而且我不知道那里的支持级别。

有许多工具可以将 Cobol 代码可视化为流程图或其他表示形式。将“可视化 cobol”插入 google 将为您提供许多其他选项。

# php - 修复git中的行尾

> ID：11567698
> 
> 赞同：0
> 
> 时间：2012-07-19T19:11:08.073
> 
> 标签：php, git, github

当我推送我修改过的文件时，并没有显示与 github 中文件的正确差异。我的意思实际上是

我使用 Windows 7 作为操作系统，我从 git hub 提取的文件是 unix 行结尾。在我编辑文件并将它们推送到 repo 之后，在 github 上很难找出我为我的合作者所做的更改。我尝试使用 notepad++ 中的“编辑-> EOL 转换-> unix”手动修复它们。对于某些文件，它正在工作，而有些则无法工作。我需要有人可以帮助我将文件行结尾设置为默认设置，如 unix 或按原样制作它们，这意味着当我下载它们时它们是 unix 并希望它们以 unix 行结尾。

我也尝试了织梦者的偏好，但没有奏效。请帮帮我

*这是我关于堆栈溢出的第一个问题，如果解释不好请忽略。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T06:02:39.507

Git 提供了处理换行问题的选项。这是 Git Book（也称为 Pro Git）中关于配置的一章，顺便说一句，这是一个了不起的资源。我建议阅读全文。

[http://git-scm.com/book/en/Customizing-Git-Git-Configuration#Formatting-and-Whitespace](http://git-scm.com/book/en/Customizing-Git-Git-Configuration#Formatting-and-Whitespace)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:14:30.580

您将需要检查 Git 中的行尾设置。在这里阅读：[https ://help.github.com/articles/dealing-with-line-endings](https://help.github.com/articles/dealing-with-line-endings)

# mysql - 尝试使用 netbeans 程序将图像保存在 mysql 数据库中

> ID：11567699
> 
> 赞同：0
> 
> 时间：2012-07-19T19:11:09.960
> 
> 标签：mysql, image

我正在构建一个食物菜单程序，用户将插入类别代码、类别名称并浏览合适的图像，该图像将作为 BLOB 存储在数据库中，然后单击保存。但是我在我的程序中遇到了这样的异常。

`com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '?,?,?)' at line 1`

这是我的代码：

```
package Frames;

import Methods.DB_Con;
import com.mysql.jdbc.Connection;
import com.mysql.jdbc.PreparedStatement;
import com.mysql.jdbc.Statement;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.util.Random;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;

/**
 *
 * @author ASHAN
 */
public class AddCategory extends javax.swing.JFrame {

    String filename = null;
    int s = 0;
    byte[] cat_image = null;

    /** Creates new form AddMenu */
    public AddCategory() {
        initComponents();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">
    private void initComponents() {

        jLabel12 = new javax.swing.JLabel();
        jButton1 = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        codetext = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        cat_name = new javax.swing.JTextField();
        jButton3 = new javax.swing.JButton();
        jTextField2 = new javax.swing.JTextField();
        jButton4 = new javax.swing.JButton();
        jDesktopPane1 = new javax.swing.JDesktopPane();
        jLabel2 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jLabel12.setFont(new java.awt.Font("Tahoma", 0, 36));
        jLabel12.setForeground(new java.awt.Color(255, 0, 0));
        jLabel12.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel12.setText("Add Category");
        jLabel12.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED, null, new java.awt.Color(0, 153, 255), null, null));

        jButton1.setText("Browse for Image");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jButton2.setText("Generate Code");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText("Category Name");

        jButton3.setText("Save");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        jButton4.setText("Back");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });

        jLabel2.setBounds(0, 0, 150, 130);
        jDesktopPane1.add(jLabel2, javax.swing.JLayeredPane.DEFAULT_LAYER);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(216, 216, 216)
                .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 280, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(229, Short.MAX_VALUE))
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jButton2, javax.swing.GroupLayout.DEFAULT_SIZE, 119, Short.MAX_VALUE)
                        .addGap(138, 138, 138)
                        .addComponent(codetext, javax.swing.GroupLayout.DEFAULT_SIZE, 159, Short.MAX_VALUE))
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                        .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, 119, Short.MAX_VALUE)
                        .addGap(138, 138, 138)
                        .addComponent(cat_name, javax.swing.GroupLayout.DEFAULT_SIZE, 159, Short.MAX_VALUE)))
                .addGap(299, 299, 299))
            .addGroup(layout.createSequentialGroup()
                .addGap(194, 194, 194)
                .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(55, 55, 55)
                .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(271, Short.MAX_VALUE))
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jButton1, javax.swing.GroupLayout.DEFAULT_SIZE, 119, Short.MAX_VALUE)
                .addGap(138, 138, 138)
                .addComponent(jTextField2, javax.swing.GroupLayout.DEFAULT_SIZE, 159, Short.MAX_VALUE)
                .addGap(76, 76, 76)
                .addComponent(jDesktopPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 147, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(76, 76, 76))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(20, 20, 20)
                .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(58, 58, 58)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton2)
                    .addComponent(codetext, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(cat_name, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(73, 73, 73)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jButton1)
                    .addComponent(jTextField2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 125, Short.MAX_VALUE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jButton3)
                    .addComponent(jButton4))
                .addGap(42, 42, 42))
            .addGroup(layout.createSequentialGroup()
                .addGap(251, 251, 251)
                .addComponent(jDesktopPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(107, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
        JFileChooser chooser = new JFileChooser();
        chooser.showOpenDialog(null);
        File f = chooser.getSelectedFile();
        filename = f.getAbsolutePath();
        jTextField2.setText(filename);

        try {
            File image = new File(filename);
            FileInputStream fis = new FileInputStream(image);
            ByteArrayOutputStream bos = new ByteArrayOutputStream();

            byte buf[] = new byte[1024];
            for (int readNum; (readNum = fis.read(buf)) != -1;) {

                bos.write(buf, 0, readNum);
            }
            cat_image = bos.toByteArray();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, e);
        }
    }                                        

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {                                         
        Random rand = new Random();
        int n = rand.nextInt(90000) + 10000;

        codetext.setText(Integer.toString(n));

    }                                        

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {                                         

        try {

            Connection con = DB_Con.getConnection();
            String sql = "insert into category (cat_code,cat_name,cat_image) values (?,?,?)";
            PreparedStatement st = (PreparedStatement) con.prepareStatement(sql);

            //int code=Integer.parseInt(codetext.getText());
            // st.setInt(1, code);
            st.setString(1, codetext.getText());
            st.setString(2, cat_name.getText());
            st.setBytes(3, cat_image);

            st.execute(sql);

            st.close();

            JOptionPane.showMessageDialog(null, "Details Successfully Added");
        } catch (Exception e) {
            // JOptionPane.showMessageDialog(null, e);
            System.out.println(e);
        }
    }                                        

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {
        AddMenuMain am = new AddMenuMain();
        am.setVisible(true);
        this.setVisible(false);
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                new AddCategory().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify
    private javax.swing.JTextField cat_name;
    private javax.swing.JTextField codetext;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JDesktopPane jDesktopPane1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JTextField jTextField2;
    // End of variables declaration
} 
```

有人对我可能做错的事情有任何建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T16:19:18.743

```
st.setString(1, "\'"+codetext.getText()+"\'");
            st.setString(2,"\'"+ cat_name.getText()+"\'");
            st.setBytes(3, "\'"+cat_image+"\'"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-12T12:42:03.247

试试这个 `st.execute();`代替`st.execute(sql);`

# nservicebus - 单个消息的多个 saga 映射

> ID：11567706
> 
> 赞同：0
> 
> 时间：2012-07-19T19:11:41.920
> 
> 标签：nservicebus, saga

我需要将一条消息映射到多个 saga 实例。我该怎么做？

我想到了一个实用服务，它接收该消息并将其副本发送到所有 saga 实例。但是这个解决方案需要所有 sagaIds 的这项服务的知识。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-21T10:32:33.343

目前在单个端点上不支持此功能。如果您希望多个 saga 处理同一消息，则该消息需要由多个端点处理。

您能否以不同的方式设计您的解决方案，而不需要为每条消息调用多个 saga？

# javascript - CSSHttpRequest - javascript 不起作用转移

> ID：11567707
> 
> 赞同：-1
> 
> 时间：2012-07-19T19:11:43.500
> 
> 标签：javascript, cross-domain

我生成完整的 html+css+javascript 页面，并通过 CSSHttpRequest 将其粘贴到其他主机上。

但是 javascript 在粘贴的页面上不起作用（http://learnit.by/test/）。

```
<!-- language: lang-html -->
<script type="text/javascript" src="csshttprequest.js"></script> 
<script type="text/javascript">
    CSSHttpRequest.get("irus.streetball.name/bsuir/encoded.css";, callback); 

    function callback(data) {
        document.getElementById('put_here').innerHTML = data;
    };
</script> 

<div id="put_here"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:31:42.440

好吧，我可以看到一些语法错误，它们是否是导致您的问题的原因是另一回​​事，但它们可能不是唯一的问题。

```
CSSHttpRequest.get("http://irus.streetball.name/bsuir/encoded.css", callback); 

function callback(data) {
    document.getElementById('put_here').innerHTML = data;
} 
```

我在 url 和函数后面去掉了一个分号。您可能还需要像我所做的那样添加 http:// 。这样做的原因是，如果没有它，它将充当相对 url（或者我相信）。

您可以在匿名中交替编写回调，尽管这不应该产生如下影响：

```
 CSSHttpRequest.get("http://irus.streetball.name/bsuir/encoded.css", function(data) {
    document.getElementById('put_here').innerHTML = data;
 }); 
```

# numpy - 检查 numpy.linalg.lstsq 找到收敛的速度有多快

> ID：11567710
> 
> 赞同：1
> 
> 时间：2012-07-19T19:11:49.373
> 
> 标签：numpy

我有一个关于 NumPy 模块 linalg.lstsq(a,b) 的问题。有没有可能检查这种方法找到收敛的速度有多快？我的意思是一些表明计算收敛速度有多快的特征？提前感谢您的头脑风暴。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T22:45:42.427

Numpy 函数`linalg.lstsq`使用奇异值分解 (SVD) 来解决最小二乘问题。因此，如果您的矩阵`A`是`n`by `n`，它将需要`n^3`翻牌。

更准确地说，我认为该函数使用 Householder Bidiagonalization 来计算 SVD，因此，如果您的矩阵为`m`，`n`则复杂度将为`O(max(m, n) * min(m, n)^2)`。

# ruby - ruby Array.inspect 与 Array[element].to_s

> ID：11567713
> 
> 赞同：1
> 
> 时间：2012-07-19T19:12:03.413
> 
> 标签：ruby, linux, arrays, string

我正在处理一个`books`复杂对象的数组，我们将其称为 ，我们将其称为`Book`。问题是当我调用时`puts "#{books.inspect}"`，ruby 输出一个二进制流（不可读的 utf8 字符）。但是，当我调用 时`puts #{books[0].to_str}"`，我会得到一个简短、漂亮的输出来描述相关`book`问题。不确定它是否相关，但它`Book`是一个子类（我们可以称它为父类`Item`），并且`books.length=1`

[Ruby](http://ruby-doc.org/core-1.9.2/Array.html)暗示了这一点，`.to_s`并且`.inspect`是同义词，但它们在实践中显然提供了不同的结果。有谁知道为什么会发生这种情况，您能否就如何从整个图书收藏中获得我想要的出色输出提供建议？

杂项信息：

```
[chk ~ ]$ ruby -v
ruby 1.9.2p290 (2011-07-09 revision 32553) [x86_64-linux] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:17:30.057

```
class Myclass
    def to_s
        'my string representation'
    end
    def inspect
        'my inspection'
    end
end
a= [Myclass.new]
p a
puts a

outputs ::
[my inspection]
my string representation 
```

为数组中的每个元素调用检查方法。如果未定义该方法，您将获得默认的类表示。您只需要定义`inspect`.

你总是可以这样做：

```
def inspect
  self.to_s
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:18:59.353

`books.inspect`并且`books[0].to_s`绝对不一样。第一个是对对象`inspect`方法的`book`调用，它是一个数组。第二个是对对象`to_s`方法的`books[0]`调用，无论它包含在数组中的是什么。由于你没有具体说明究竟是什么`books[0]`，恐怕我不能再说什么了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-27T01:59:21.617

`books`是一个数组，所以调用`books.inspect`就是调用`Array#inspect`。该方法通过调用`.inspect`元素来工作，所以在这种情况下`Book#inspect`.

对对象进行字符串插值`"Here's some info #{value}"`调用，无论其类是什么。`.to_s``value`

将这些放在一起作为示例`"Books #{books}"`将调用`Array#to_s`（它是 的别名`Array#inspect`）调用`Book#inspect`以生成输出字符串。

当您希望事情始终如一地工作时，您应该定义`inspect`并创建`to_s`别名`inspect`as is done 在`Array`类中作为示例。例如

```
class MyClass
  def inspect
    'my string representation'
  end
  alias_method :to_s, :inspect
end 
```

有时您可能希望它们有所不同，这对调试和更常见的输出`.inspect`很有用。`.to_s`在这种情况下，您将使用不同的代码定义它们中的每一个。

# ios - iOS UIImagePicker didFinishPickingMediaWithInfo Vs editingInfo

> ID：11567716
> 
> 赞同：1
> 
> 时间：2012-07-19T19:12:20.910
> 
> 标签：ios, uiimagepickercontroller

我正在尝试创建一个应用程序，它可以从相机拍照，也可以从图库中拍照。

但我遇到的问题是，

当我选择从相机拍照时，它工作正常，我正在使用

```
 - (void) imagePickerController: (UIImagePickerController *) pickerr didFinishPickingMediaWithInfo: (NSDictionary *) info; 
```

但是当我去画廊拍照时，使用

```
 - (void)imagePickerController:(UIImagePickerController *)pickerr didFinishPickingImage:(UIImage *) image editingInfo:(NSDictionary *)editingInfo; 
```

执行上述方法并再次保存我选择的图片。

如果我评论第一种方法，那么我可以在 UIImageView 中显示选定的图像。

应该改变什么，以便两者都能完美地工作。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:21:02.480

在**iOS 3.0**`imagePickerController:didFinishPickingImage:editingInfo:`中已弃用

 **试试这个方法`imagePickerController:didFinishPickingMediaWithInfo:`**

# java - 更改jtable列标题的背景颜色

> ID：11567721
> 
> 赞同：0
> 
> 时间：2012-07-19T19:12:40.660
> 
> 标签：java, colors, jtable

我有一个有四列的表格，我希望每个列的标题都是不同的颜色。我只希望列头有颜色，而不是列中的其余单元格。我尝试使用 DefaultTableCellRenderer，但它使除列标题之外的每个单元格都变成红色。我可以在我的代码（如下）中进行哪些更改以单独为每个列标题分配颜色？

```
class CustomRenderer extends DefaultTableCellRenderer{

public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column)
{
    Component c = super.getTableCellRendererComponent(table, value, isSelected, hasFocus, 3, 3);
    c.setBackground(new java.awt.Color(255,72,72));
    return c;
}

}

    table.setDefaultRenderer(Object.class, new CustomRenderer()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:26:54.497

恐怕您无法轻松设置每种颜色。

```
// Get the column header for your specific column
JTableHeader th = table.getTableHeader();
TableColumnModel tcm = th.getColumnModel();
TableColumn tc = tcm.getColumn(column);

/* Create a new renderer for column headers, and
pass in the column number so you can differntiate
which column will be which color. */
tc.setCellRenderer(new headerCellRenderer(column)); 
```

不过，这应该适合您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-26T10:50:20.510

下面是我在 Netbeans GUI 项目中的解决方案：

[![不同颜色的jtable列标题](../Images/70a3ce5e9bcf4f065e8defdc727f4d8e.png)](https://i.stack.imgur.com/83xrt.png)

制作不同颜色的列标题，我有以下 3 个步骤： 1.在我的项目包中构建一个类。例如，我在我的项目包中制作了“blueHeaderRender.java”。 [![在此处输入图像描述](../Images/22dfcfa13de54e85c2f427d917d6b95d.png)](https://i.stack.imgur.com/csBf9.png) [![在此处输入图像描述](../Images/6da70fac25baaf4c297e1777d7fca4f5.png)](https://i.stack.imgur.com/ofayQ.png)

2.  在你的项目中使用这个类。我的GUI项目代码如下：

    private void sqquery1ActionPerformed(java.awt.event.ActionEvent evt) {
    //刷新jtable数据 DefaultTableModel model = (DefaultTableModel) jtps.getModel(); 模型.setRowCount(0); DefaultTableModel model02 = (DefaultTableModel) jtsc.getModel(); model02.setRowCount(0); 连接连接 = getConnection(); 字符串 date1=getdate01.getText(); 字符串 date2=getdate02.getText(); DateFormat df=new SimpleDateFormat("yyyy-MM-dd"); if(jDateChooser1.getDate()!=null&jDateChooser2.getDate()!=null){ getdate01.setText(df.format(jDateChooser1.getDate())); getdate02.setText(df.format(jDateChooser2.getDate())); } 其他{ getdate01.setText(""); getdate02.setText(""); }

    ```
    if(!"".equals(getdate01.getText())&!"".equals(getdate02.getText())){
        String query001 =" SELECT * FROM pscard_in_out WHERE CAST(datetime AS date) BETWEEN '"+getdate01.getText()+"' AND '"+getdate02.getText()+"'  ";

        String query002 =" SELECT * FROM sccard_in_out WHERE CAST(datetime AS date) BETWEEN '"+getdate01.getText()+"' AND '"+getdate02.getText()+"'  ";
        try {
            pstmt = (PreparedStatement) conn.prepareStatement(query001);
            rs = pstmt.executeQuery();

            jtps.setModel(DbUtils.resultSetToTableModel(rs));  //neen import rs2xml.jar  in libraries
            jtps.getColumnModel().getColumn(2).setHeaderRenderer(new blueHeaderRenderer());
            jtps.getColumnModel().getColumn(4).setHeaderRenderer(new blueHeaderRenderer());
            jtps.getColumnModel().getColumn(3).setHeaderRenderer(new redHeaderRenderer());
            jtps.getColumnModel().getColumn(5).setHeaderRenderer(new redHeaderRenderer());
            // resizing the column width
            jtps.getColumnModel().getColumn(0).setPreferredWidth(40);
            jtps.getColumnModel().getColumn(1).setPreferredWidth(190);
            jtps.setAutoResizeMode(JTable.AUTO_RESIZE_LAST_COLUMN);

            while (rs.next()){}

            pscardSum();
            pstmt.close();
            rs.close();
            conn.close();

        } catch (SQLException ex) {
        }

    } 
    ```

    }

顺便说一句，如果你想在不同的列标题中使用另一种颜色，你可以在你的项目中制作更多的类以在你的项目中使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-22T03:35:46.597

> 上面标有绿色复选标记的代码是正确的，但只是设置了非标题单元格的属性。请注意，TableColumn 类方法 setCellRenderer() 和 setHeaderRenderer() 之间存在差异。

[具有多种颜色的标题单元格和非标题黄色单元格的结果表](https://i.stack.imgur.com/j1woZ.png)

```
/********************* FULL WORKING IMPLEMENTATION. *************************
  -Table with custom header (multiple colors) and custom non-header cells.
  -Cells' manipulated properties are colors, font, opacity and border types.*/

        import java.awt.Color;
        import java.awt.Component;
        import java.awt.Dimension;
        import java.awt.Font;
        import java.awt.GridLayout;
        import javax.swing.BorderFactory;
        import javax.swing.JComponent;
        import javax.swing.JFrame;
        import javax.swing.JLabel;
        import javax.swing.JPanel;
        import javax.swing.JScrollPane;
        import javax.swing.JTable;
        import javax.swing.border.Border;
        import javax.swing.table.AbstractTableModel;
        import javax.swing.table.TableCellRenderer;
        import javax.swing.table.TableColumn;

        public class CustomHeaderTable  extends JPanel
        {
            CustomHeaderTable()
            {
                super(new GridLayout(1,0));

                JTable table = new JTable(new MyTableModel());
                table.setPreferredScrollableViewportSize(table.getPreferredSize());
                table.setFillsViewportHeight(true);
                table.setPreferredScrollableViewportSize(new Dimension(500, 70));

                //Setting header cells
                CustomCellRenderer customHeaderCellRenderer = 
                        new CustomCellRenderer(Color.white,
                                               Color.red,
                                               new Font("Consolas",Font.BOLD,14),
                                               BorderFactory.createEtchedBorder(),
                                               true);

                for(int columnIndex = 0; columnIndex < table.getTableHeader().getColumnModel().getColumnCount(); columnIndex++)
                {
                    TableColumn tc = table.getTableHeader().getColumnModel().getColumn(columnIndex);    
                    tc.setHeaderRenderer(customHeaderCellRenderer);
                }

                //Setting non-heather's cells colors, font, borders, and opacity
                CustomCellRenderer customNonHeaderCellRenderer = 
                        new CustomCellRenderer(Color.blue,
                                               Color.yellow,
                                               new Font("Courier",Font.PLAIN,12),
                                               BorderFactory.createLineBorder(Color.gray),
                                               true);

                for(int columnIndex = 0; columnIndex < table.getTableHeader().getColumnModel().getColumnCount(); columnIndex++)
                {
                    TableColumn tc = table.getTableHeader().getColumnModel().getColumn(columnIndex);    
                    tc.setCellRenderer(customNonHeaderCellRenderer);
                }

                JScrollPane scrollpane = new JScrollPane(table);
                add(scrollpane);
            }

            public class CustomCellRenderer extends JLabel implements TableCellRenderer
            {
                public CustomCellRenderer(Color foregroundColor, Color backgroundColor, Font font, Border border, boolean isOpaque)
                {
                    setFont(font);
                    setOpaque(isOpaque);
                    setForeground(foregroundColor);
                    setBackground(backgroundColor);
                    setBorder(border); 
                }

                @Override
                public Component getTableCellRendererComponent(JTable table, Object value,
                        boolean isSelected, boolean hasFocus, int row, int column) 
                {
                    setText(value.toString());
                    return this;
                }
            }

            class MyTableModel extends AbstractTableModel 
            {
                private String[] columnNames = {"First Name",
                                                "Last Name",
                                                "Sport",
                                                "# of Years",`enter code here`
                                                "Vegetarian"};
                private Object[][] data = {
                {"Kathy", "Smith",
                 "Snowboarding", new Integer(5), false},
                {"John", "Doe",
                 "Rowing", new Integer(3), true},
                {"Sue", "Black",
                 "Knitting", new Integer(2), false},
                {"Jane", "White",
                 "Speed reading", new Integer(20), true},
                {"Joe", "Brown",
                 "Pool", new Integer(10), false}
                };

                public int getColumnCount() 
                {
                    return columnNames.length;
                }

                public int getRowCount() 
                {
                    return data.length;
                }

                public String getColumnName(int col) 
                {
                    return columnNames[col];
                }

                public Object getValueAt(int row, int col) 
                {
                    return data[row][col];
                }

                public Class getColumnClass(int c) 
                {
                    return getValueAt(0, c).getClass();
                }

                public boolean isCellEditable(int row, int col) 
                {
                    if (col < 3) 
                    {
                        return false;
                    } 
                    else 
                    {
                        return true;
                    }
                }
            }

            public static void createAndShowGUI()
            {
                JFrame frame = new JFrame("CustomHeaderTable");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

                JComponent newContentPane = new CustomHeaderTable();
                newContentPane.setOpaque(true);
                frame.setContentPane(newContentPane);

                frame.pack();
                frame.setLocationRelativeTo( null );
                frame.setVisible(true);
            }

            public static void main(String[] args) {
                javax.swing.SwingUtilities.invokeLater(new Runnable() {
                    public void run() {
                        createAndShowGUI();
                    }
                });
            }
        } 
```

# asp.net-mvc - 如何将列表添加到视图模型 MVC

> ID：11567723
> 
> 赞同：2
> 
> 时间：2012-07-19T19:12:46.013
> 
> 标签：asp.net-mvc, c#-4.0, viewmodel

我将 MVC 3 与 View Model 一起使用，在我的情况下，我有一个 View Model，它应该显示一个项目列表以及一个用于插入一些输入的表单。

我的视图有问题，因为我无法将用于插入数据的表单与视图模型相关联，你能告诉我我做错了什么吗？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.ComponentModel.DataAnnotations;
using TestGuestBook.Models;

namespace TestGuestBook.ViewModel
{
    public class ListAddCommentsViewModel
    {
        public int CommentId { get; set; }

        [Required]
        public string Nominative { get; set; }

        [Email]
        public string Email { get; set; }

        [Required]
        public string Content { get; set; }

        public List<Comment> CommentItems { get; set; }
    }
} 
```

看法

```
@model IEnumerable<TestGuestBook.ViewModel.ListAddCommentsViewModel>

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>ListAddCommentsViewModel</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.CommentId)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.CommentId)
            @Html.ValidationMessageFor(model => model.CommentId)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Nominative)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Nominative)
            @Html.ValidationMessageFor(model => model.Nominative)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Email)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Email)
            @Html.ValidationMessageFor(model => model.Email)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Content)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Content)
            @Html.ValidationMessageFor(model => model.Content)
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
}

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table>
    <tr>
        <th>
            CommentId
        </th>
        <th>
            Nominative
        </th>
        <th>
            Email
        </th>
        <th>
            Content
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.CommentId)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Nominative)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Email)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Content)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { /* id=item.PrimaryKey */ }) |
            @Html.ActionLink("Details", "Details", new { /* id=item.PrimaryKey */ }) |
            @Html.ActionLink("Delete", "Delete", new { /* id=item.PrimaryKey */ })
        </td>
    </tr>
}

</table> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T19:15:38.700

您不需要将 a 传递`Collection`给您的视图。ViewModel 的一个对象就足够了。您`ViewModel`已经拥有收藏收藏品的财产（清单`Comments`）

因此，在您的`GET`Action 中，仅将此 viewModel 的一个实例返回给 View

```
public ActionResult GetComments(int postId)
{
  var viewModel=new ListAddCommentsViewModel();
  viewModel.CommentItems =db.GetComments(postId);
  return View(viewModel);
} 
```

现在在您的视图中，让它绑定到单个实例`ListAddCommentsViewModel`

```
@model TestGuestBook.ViewModel.ListAddCommentsViewModel 
```

在您的视图中，要显示您的评论列表，`Model.CommentItems`请在您的`ViewModel`

```
@foreach (var item in Model.CommentItems) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.CommentId)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Nominative)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Email)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Content)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new {  @id=item.PrimaryKey  }) |
            @Html.ActionLink("Details", "Details", new {  @id=item.PrimaryKey  }) |
            @Html.ActionLink("Delete", "Delete", new { @id=item.PrimaryKey  })
        </td>
    </tr>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-12T06:18:31.030

这是最好的解决方案，我检查了几乎所有信息，这是一个有效的解决方案！谢谢

```
 public  ActionResult UploadFile(UploadFileViewModel model)
    {
        if (ModelState.IsValid)
        {
            var file = model.File;
            var parsedContentDisposition =
            ContentDispositionHeaderValue.Parse(file.ContentDisposition);
            var filename = Path.Combine(_environment.WebRootPath,
                "Uploads", parsedContentDisposition.FileName.Trim('"'));
            file.SaveAsAsync(filename);
        }

        return View();
    } 
```

# php - PHP 注册表单验证

> ID：11567725
> 
> 赞同：5
> 
> 时间：2012-07-19T19:12:47.987
> 
> 标签：php, forms, validation

我在提交时有这个简单的表单，它会被重定向到`submit.php`，如果有错误它会显示错误消息`submit.php`。现在我想要将错误消息显示回表单页面。

```
<html>
<head>
<? require_once('lib.php'); ?>
</head>
<body>
<form name="my-form" id="my-form" method="post" action="submit.php">
        Your name:
        <input name="name" value="" size="30" maxlength="255" />
        Your email:
        <input name="email" value="" size="30" maxlength="255" />
        Your favourite color:
            <select name="fav_color">
                <option value="">-select please-</option>
                <option value="Black">Black</option>
                <option value="White">White</option>
                <option value="Blue">Blue</option>
                <option value="Red">Red</option>
                <option value="Yellow">Yellow</option>
            </select>
        Your comment:
        <textarea name="comment" rows="6" cols="35"></textarea>
    <input type="submit" value="Submit" />         
</form>
</body>
</html>
<?php

require_once('lib.php');

function getErrors($postData,$rules){

  $errors = array();

  // validate each existing input
  foreach($postData as $name => $value){

    //if rule not found, skip loop iteration
    if(!isset($rules[$name])){
        continue;       
    }

    //convert special characters to HTML entities
    $fieldName = htmlspecialchars($name);

    $rule = $rules[$name];

    //check required values
    if(isset($rule['required']) && $rule['required'] && !$value){
        $errors[] = 'Field '.$fieldName.' is required.';
    }

    //check field's minimum length
    if(isset($rule['minlength']) && strlen($value) < $rule['minlength']){
         $errors[] = $fieldName.' should be at least '.$rule['minlength'].' characters length.';    
    }

    //verify email address     
    if(isset($rule['email']) && $rule['email'] && !filter_var($value,FILTER_VALIDATE_EMAIL)){
      $errors[] = $fieldName.' must be valid email address.';
    }

    $rules[$name]['found'] = true;

  }

  //check for missing inputs
  foreach($rules as $name => $values){
    if(!isset($values['found']) && isset($values['required']) && $values['required']){
      $errors[] = 'Field '.htmlspecialchars($name).' is required.';
    }

  }

  return $errors;
}

$errors = getErrors($_POST,$validation_rules);

if(!count($errors)){
  echo 'Your form has no errors.';
}
else{  
  echo '<strong>Errors found in form:</strong><ul><li>';
  echo join('</li><li>',$errors);
  echo '</li></ul><p>Correct your errors and try again.</p>';
}
?> 
```

由于此 php 代码在同一页面上显示错误消息。我想在`form.php page`. 有没有人帮我这样做..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:19:21.790

[本文](http://en.wikipedia.org/wiki/Post/Redirect/Get)介绍了您的解决方案。

您应该创建一个验证器脚本（例如 validate.php）并在那里提交表单以进行验证。如果验证失败，验证器脚本应该返回一个（JSON、XML、任何你想要的）验证错误数组。否则 - 返回重定向链接。

因此，当您在表单上单击“提交”时，应该会发生对 validator.php 的 AJAX 请求，而不是重定向。

您应该考虑使用框架来解决此类问题。这将节省大量的编码时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:55:36.633

一个简单的解决方案是将您的注册页面作为您的表单操作，并将 php 代码包装为：

```
if(isset($_POST['submit'])){
    //php code here
} 
```

然后，您可以复制 php 代码并将其粘贴到 html 页面的开头。然后将您的表单操作设置为您的页面。

如果你想在处理 PHP 代码时隐藏部分表单，你可以这样做::

```
echo '<style>.style1 {display: none }</style>"; 
```

*或者您甚至可以在注册后以相同的形式向用户显示自定义消息：*

```
echo '<div class="highlight"><p class="textcenter"><h5>You have successfully registered for blah blah blah.</h5></p><p>Thank you!</p><style>.style1 {display: none }</style>"; 
```

请注意，我假设您的 body 标签的其余部分是带有 class 的样式`stlye1`。

这也确保了只有在 html 页面中需要的文本，即当用户提交表单时才加载*可见文本。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-30T18:43:02.927

正如 Sergey Eremin 所指出的，为这类任务考虑一个框架是件好事。

无论如何，这就是我在 PHP 中的做法。所有代码都包含一页（submit.php）。因此，表单提交给自己。当用户打开 submit.php 时，会显示该表单。当他们点击提交时，程序会检查是否提供了姓名、有效的电子邮件、喜欢的颜色和评论。如果其中没有一个为空且电子邮件有效，则程序将显示“一切正常”。否则，它将用户重定向回表单并指向未正确填写的字段。并且用户之前提供的每个数据都通过重定向 URL 传递。使用 $_GET 它被检索并显示在表单中，因此用户不需要从头开始重新输入所有内容。

请不要忘记在插入数据库之前清理/转义数据。

希望这可以帮助。

```
<?php 
    //if the form has been submitted
    if (isset($_POST['submit'])){

        //extract data submitted through the form and assign date to variables
        $name = $_POST['name'];
        $email = $_POST['email'];
        $favoriteColor = $_POST['fav_color'];
        $comment = $_POST['comment'];

        //pattern against which to check email validity
        $good_email = "[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}";

        //if provided data is valid (email especially) and no form field has been left empty display "everything is okay" 
        if(strlen($name) > 0 && strlen($email) > 0 && preg_match("/$good_email/", $email, $regs) && strlen($favoriteColor) > 0 && strlen($comment) > 0){
            echo "Everything is okay";
        }
        //otherwise redirect the user back to the form and indicate errors that they need to correct
        else{

            //build an error message string where the user is shown where the issue is
            $error_message = "There are errors with your form."; //starting point for the error message 

            //if message has been left empty let the user know that the name is required
            if(strlen($name) == 0){
                $error_message .= "<br/>Name is required";
            }
            //if the email is left empty let the user know that an email is required 
            if(strlen($email) == 0){
                $error_message .= "<br/>Email is required";
            }
            //if the email does not match the pattern ($good_email) let the user know that the email they have supplied is invalid 
            if(!(preg_match("/$good_email/", $email, $regs))){
                $error_message .= "<br/>Email is not valid";
            }
            //if the a favorite color has not been selected let the user know that they need to select a favorite color
            if(strlen($favoriteColor) == 0){
                $error_message .= "<br/>Favorite color can not be left empty";
            }
            //if the comment is left empty let the user know that comment is required
            if(strlen($comment) == 0){
                $error_message .= "<br/>Comment is required";
            }
            //if any field is left empty or the email is invalid redirect the user back to the form along with the data they submitted 
            header("Location: submit.php?&submittedName=$name&error=$error_message&submittedEmail=$email&submittedColor=$favoriteColor&submittedComment=$comment");
        }
    }
    //if no submission display the form
    else{
?>
<html>
<head>

</head>
<body>

<?php
    //display the error message 
    //error message is passed through the url
    if (isset($_GET['error']))
    {
        echo "<p style='color:red'>".$_GET['error']."</a>";
    }
?>
<form name="my-form" id="my-form" method="post" action="submit.php">
        Your name:
        <input name="name" value="<?php if($_GET['error']) { echo $_GET['submittedName'];} //if there's been an error with form submission display the name the user prevously submitted ?>" size="30" maxlength="255" />
        Your email:
        <input name="email" value="<?php if($_GET['error']) { echo $_GET['submittedEmail'];} //if there's been an error with form submission display the email the user prevously submitted ?>" size="30" maxlength="255" />
        Your favorite color:
            <select name="fav_color">
                <option value="">-select please-</option>
                <option value="Black">Black</option>
                <option value="White">White</option>
                <option value="Blue">Blue</option>
                <option value="Red">Red</option>
                <option value="Yellow">Yellow</option>
            </select>
        Your comment:
        <textarea name="comment" rows="6" cols="35"><?php if($_GET['error']) { echo $_GET['submittedComment'];} //if there's been an error with form submission display the comment the user prevously submitted ?></textarea>
    <input type="submit" value="Submit" name="submit"/>         
</form>
</body>
</html>
<?php
}
?> 
```

# ruby-on-rails - 密码更改后，Devise 正在注销用户

> ID：11567732
> 
> 赞同：5
> 
> 时间：2012-07-19T19:13:47.987
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise

我正在使用设计，当用户更改密码时，网站会将其注销。我在网上读到，添加 sign_in 可以解决问题，但无法正常工作，并且在更改密码时用户会被注销。这是我的代码

```
if @user.errors[:base].empty? and @user.update_attributes(params[:user])
  sign_in(current_user, :bypass => true)
  flash[:success] = "User account has been successfully updated"
  redirect_to edit_user_path(params[:site_id], @user)
else
  render :action => :edit, :status => :unprocessable_entity
end 
```

我假设这会起作用，但无论我做什么，我仍然会被注销....任何丢失或可能一个设计设置已关闭...任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-19T19:55:19.893

我通常[遵循这些](https://github.com/plataformatec/devise/wiki/How-To:-Allow-users-to-edit-their-password)说明并且它有效。也许你应该做

```
sign_in(@user, :bypass => true) 
```

代替

```
sign_in(current_user, :bypass => true) 
```

# .net - 拆分容器 SplitterDistance 更改无需用户干预

> ID：11567738
> 
> 赞同：4
> 
> 时间：2012-07-19T19:14:14.380
> 
> 标签：.net, winforms, splitcontainer

我的 Winforms 应用程序在数据库中保存和恢复其 GUI 状态。一切正常，除了拆分容器的 SplitterDistance。

该值已从 DB 正确加载和设置，但是当我退出应用程序**而不**接触拆分器时，我希望它保存相同的值。但它保存了初始值减去 25 个像素。如果我多次打开和关闭应用程序，拆分器距离每次减少 25 像素。

它不是自定义控件，只是一个普通的旧 .NET SplitContainer。仅以编程方式访问该控件以加载其初始 SplitterDistance 并在退出时将其保存，仅此而已。

我该如何解决这个问题？

**更新**： spl 的`FixedPanel`属性最初设置为`None`. 尝试将其设置为`Panel1`and `Panel2`; 在这两种情况下，当我保存时，SplitterDistance 都会**增长50 像素。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-01-20T18:41:58.707

[下载示例应用程序](https://drive.google.com/open?id=1cJb7aIRgovEgjjos35_jW6jEHc6ZLWf9)

```
 // my splitContainer1 is Horizontal so i used splitContainer1.ClientSize.Height 
        // if you have splitContainer1 is Vertical use splitContainer1.ClientSize.Width
        // without FixedPanel save and load """  
        // loading SplitterDistance from ini file
        int splitContainery = 0;
        splitContainery = (Win32.GetPrivateProfileInt(PluginName, "splitContainer", 0, iniFilePath));
        splitContainer1.SplitterDistance = splitContainer1.ClientSize.Height - splitContainery;

        // saving splitContainer1.SplitterDistance to ini file
        int hhkt = splitContainer1.ClientSize.Height - splitContainer1.SplitterDistance;
        Win32.WritePrivateProfileString(PluginName, "splitContainer", hhkt.ToString(), iniFilePath); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:26:17.327

拆分容器内是否有用户控件，并且可能当它们全部加载时，它会与包含它的用户控件一起调整大小。

要解决此问题，请设置**FixedPanel**属性并观察它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-08T05:43:38.160

我使用上述响应如下（我的分离器是垂直的）：

```
private void Form1_Load(object sender, EventArgs e) 
{
    int splitContainery = Properties.Settings.Default.SplitterDistance;
    if(splitContainery < splContainer.ClientSize.Width)
        splContainer.SplitterDistance = splContainer.ClientSize.Width - splitContainery;
}

private void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    int splitContainery = splContainer.ClientSize.Width - splContainer.SplitterDistance;
    Properties.Settings.Default.SplitterDistance = splitContainery;
    Properties.Settings.Default.Save();            
} 
```

我为 splContainer.SplitterDistance 创建了 PropertyBinding，但没有将它绑定到属性，只是为了将它放在 ApplicationSettings 文件中。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-08-28T02:01:25.653

```
int splitContainery = Properties.Settings.Default.SplitterDistance; 
```

例如，如果我可以使用`Properties.Settings.Default.SplitterDistance`，我将永远无法使用*ini*文件

# android - 在android中将视图添加到滚动视图

> ID：11567740
> 
> 赞同：0
> 
> 时间：2012-07-19T19:14:22.463
> 
> 标签：android, view, scrollview, gif, ondraw

我在滚动视图中有一个相对布局，然后我使用以下代码创建了一个新视图：

```
public class DrawView extends View {
    Paint paint = new Paint();

    public DrawView(Context context) {
        super(context);            
    }

    @Override
    public void onDraw(Canvas canvas) {
        paint.setColor(Color.BLACK);
        paint.setStrokeWidth(2);
        paint.setStyle(Paint.Style.STROKE);
        canvas.drawRect(5, 5, 140, 140, paint);

    }
} 
```

然后我尝试使用 layout.addView(DrawView) 将新视图添加到相对布局中，因此它可以与其余内容一起滚动，但不起作用，没有任何显示..

我错过了什么吗？

编辑：

```
DrawView formas;
GifMovieView gif;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    final RelativeLayout layout = new RelativeLayout(this);
    final ScrollView scrollView = new ScrollView(this);
    //gif = new GifMovieView(this, t_img);
    formas = new DrawView(this);

    layout.addView(formas);
    scrollView.addView(layout);

    this.setContentView(scrollView);    
    inicializar();
    load(layout);   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:38:14.907

您可能希望`onMeasure()`在 DrawView 中覆盖。否则，您的视图将具有 0x0 像素的大小。

你可以从简单的事情开始

```
@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    setMeasuredDimension(200, 200);
} 
```

只是为了证明它有效，但您需要根据您的视图内容做一些更有意义的事情。

从[这篇文章](http://developer.android.com/guide/topics/ui/custom-components.html)开始，查看有关覆盖`onDraw()`和`onMeasure()`

# objective-c - Objective-c 从按钮选择器访问类变量

> ID：11567741
> 
> 赞同：1
> 
> 时间：2012-07-19T19:14:29.647
> 
> 标签：objective-c

我在这样的类的 init 方法中初始化 UIButton：

```
UIButton* upButton=[[UIButton alloc] initWithFrame:CGRectMake(2*stepX, 13*stepY,2*stepX,stepY)];
[upButton setTitle:@"UP" forState:UIControlStateNormal];
[upButton setBackgroundColor:[UIColor blueColor]];
[upButton addTarget:self action:@selector(pressedUp) forControlEvents:UIControlEventTouchUpInside]; 
```

在pressedUp 方法中，我需要使用该类中的变量（NSInteger* 和我的类 hero*）。所以我在做：

```
hero*h=self.mainHero;
NSInteger*m=self.map; 
```

但后来在代码中，我可以轻松地使用 hero 类（更改位置等），但它无法使用 self.map（数组中的可怕整数而不是 0 和 1）......如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:25:35.550

从您最后的评论看来，问题是由于一个悬空引用：您创建一个局部变量`lvl1Map[]`，将其分配给`self.map`，然后退出初始化程序。此时，`lvl1Map[]`已经消失了，但`map`是指向内存中它曾经所在的区域。

`lvl1Map`您可以通过声明静态来解决此问题：

```
NSInteger lvl1Map[]={...};
[self setMap:lvl1Map]; 
```

# javascript - 内联 javascript onclick 事件

> ID：11567749
> 
> 赞同：15
> 
> 时间：2012-07-19T19:14:54.897
> 
> 标签：javascript

这是我的html代码

```
<a href="#" onclick="return clickHandler()">Hit</a> 
```

这是我的 javascript 文件

```
function clickHandler(evt) {
    var thisLink = (evt)?evt.target:Window.event.srcElement;
    alert(thisLink.innerHTML);
    return false;
} 
```

但是当我点击点击链接时，它会重定向。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-30T12:21:39.863

如果您希望阻止默认值，则需要传入事件。

html:

```
<a href="#" onclick="runFunction(event)">Hit</a> 
```

脚本：

```
function runFunction (evt) {
    evt.preventDefault();
    evt.stopPropagation();
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-19T19:28:39.930

为了将两个非常正确的答案联系在一起，发生的事情是你已经在你写的地方内联了一个函数`onclick="return runFunction();"`

如果你看一下，它真正在做的是这样的：

```
var link = document.getElementById("myLink");

link.onclick = function () { runFunction(); }; 
```

看到问题了吗？

我`runFunction`的调用根本没有传入任何事件对象。...这意味着这`var thisLink = (evt) ?`将返回 false，这意味着它将尝试在 oldIE 模式下运行。

通过写作`onclick="runFunction"`，这与说：

```
link.onclick = runFunction; 
```

这意味着当 onclick 事件发生时，会调用 runFunction，并且在 W3C 兼容的浏览器中，它会被发送一个事件对象。

这就是该解决方案有效的原因。

避免这种混淆的最好方法是从 JavaScript 内部处理 JavaScript，并在 HTML 内部处理 HTML，这样您就不必担心字符串如何转换为代码。

现在，为了让所有这些工作，并防止重定向，你想要这样做：

对于 W3C 浏览器（传递事件参数的浏览器）：

```
function runFunction (evt) {

    // stops the default-action from happening
    // means you need to find another way to fire it, if you want to later
    evt.preventDefault();

    // stops higher-up elements from hearing about the event
    // like if you stop a submit button from "clicking", that doesn't stop the form
    // from submitting
    evt.stopPropagation();

    //the oldIE versions of both of these are
    event.cancelBubble = true;
    event.returnValue = false;    
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:21:21.977

当我将您的代码插入 chrome 时，我在控制台中得到了这个错误： Uncaught TypeError: Cannot read property 'srcElement' of undefined

如果 javascript 在处理过程中爆炸，它根本没有机会返回，因此浏览器倾向于在异常发生后忽略 onclick 处理程序中的内容。

既然它被炸毁了……锚标签的默认行为，就是把你送到href说去的任何地方。

尝试将函数的内容包装在 try/catch 块中，看看如果这种事情困扰你会发生什么。

# visual-studio - 默认情况下，如何在 Visual Studio XML 编辑器中打开 resx 文件？

> ID：11567750
> 
> 赞同：30
> 
> 时间：2012-07-19T19:15:01.187
> 
> 标签：visual-studio, visual-studio-2010, ide, resources, resx

我想要默认的“查看代码”视图（xml 编辑器），以便我可以使用 R# 文件结构窗口中的功能。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-07-20T16:29:42.887

1.  右键单击资源文件
2.  选择`Open With`
3.  选择`XML (Text) Editor`或`XML (Text) Editor with Encoding`
4.  在对话框的右侧，单击`Set as Default`

# javascript - Javascript 图像翻转与 onclick 切换

> ID：11567751
> 
> 赞同：0
> 
> 时间：2012-07-19T19:15:04.777
> 
> 标签：javascript, jquery

我目前有代码来翻转图像链接，如下所示：

```
<a id="show" href="#"><img src="images/show-me.png" border=0 onmouseover="this.src='images/show-me_over.png';" onmouseout="this.src='images/show-me.png'"></a> 
```

单击它会显示一个 div

```
jQuery(document).ready(function(){
    jQuery("#show").toggle(
        function(){
            jQuery('#home-hidden-extra').animate({'height': '480px'} ,1000);},
        function(){
            jQuery('#home-hidden-extra').animate({'height': '0px'} ,1000);}
    );
}); 
```

我想做但我找不到/弄清楚的是在隐藏div时使用show_me.png和show_me-over.png，然后在显示div时使用hide_me.png和hide_me-over.png。

实现这一目标的最简单方法是什么？

再次感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:12:59.703

您应该将静态悬停样式添加到 CSS。定义

```
.linkShow {
    background-image: url("images/show_me.png");
}

.linkShow:hover {
    background-image: url("images/show_me_hover.png"); 
}

.linkHide {
    background-image: url("images/hide_me.png");
}

.linkHide:hover {
    background-image: url("images/hide_me_hover.png"); 
} 
```

然后将这些类添加到带有 jquery 的链接中。

```
$("#show").removeClass().addClass("linkShow"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T20:18:30.950

这应该有效：

**HTML**

```
 <a id="show" href="#">
      <img id="the-image" src="images/show-me.png" />
    </a> 
```

**JS**

```
 $(document).ready(function(){
    setupHover(); /* Defined below */
    $('#show').toggle(function(){
        $('#home-hidden-extra').animate({'height': '480px'} ,1000);
        setupHover();
    },function(){
        $('#home-hidden-extra').animate({'height': '0px'} ,1000);
        setupHover();
    });
  });

  function setupHover(){
      /* Unbind existing hover handlers */
      $('#show').unbind('mouseenter mouseleave');

      /* Use the correct image filenames depending on the situation */

      if($('#home-hidden-extra').height() > 0){
        images = ['show-me.png','show-me_over.png'];
      }
      else {
        images = ['hide_me.png','hide_me-over.png'];
      }
      $('#show').hover(function(){
          $('#the-image').attr('src','images/' + images[1]);
        },function(){
          $('#the-image').attr('src','images/' + images[0]);
        });
  } 
```

# javascript - Rails：在 Javascript 中添加和插入代码

> ID：11567752
> 
> 赞同：0
> 
> 时间：2012-07-19T19:15:15.533
> 
> 标签：javascript, ruby-on-rails, append, interpolation

我有一个灯箱，我想在其中渲染 Rails 部分，如下所示：

```
var data = "render :conversations => new";
$('#lightbox').append('#{escape_javascript(data)'); 
```

不幸的是，这会导致灯箱中出现文本“render :conversations => new”，而不是实际呈现。我认为这是因为我在附加部分而不是在运行时渲染它。我遵循了关于[这个线程](https://stackoverflow.com/questions/3416460/render-a-partial-from-jquery-and-haml)的建议，但收效甚微。它建议我在附加行前面添加一个“！=”，如下所示：

```
!= "$('#lightbox').append('#{escape_javascript(data)');" 
```

由于“！=”，这会引发语法错误。也许我用错了这个符号，但我在谷歌上找不到任何关于它的信息。我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:47:29.187

我想你想做：

```
$('#lightbox').append('#{escape_javascript(render :conversations => new)'); 
```

但我真的不明白您的代码如何导致附加文本“render :conversations => new”。`var data = "render :conversations => new";`看起来像 JavaScript 并且`escape_javascript(data)`是服务器端 ruby​​，所以它不知道`data`. 我还注意到 the`#{`没有结尾`}`。这真的是您测试的确切代码吗？

# android - Android 库项目和单元测试

> ID：11567754
> 
> 赞同：7
> 
> 时间：2012-07-19T19:15:32.593
> 
> 标签：android, unit-testing, junit

我正在开发一个用于与 Web 服务交互的 Android 库，并且我正在尝试开发一些单元测试来检查它的工作情况。

当我运行指定的测试时，我收到以下错误：

```
[2012-07-19 15:12:09 - MMWebAPI] Could not find MMWebAPI.apk!
[2012-07-19 15:12:10 - MMWebAPITest] Test run failed: Unable to find instrumentation target package: com.webapi.mmwebapi 
```

其中`MMWebAPI`是图书馆，并且不产生`.apk`.

我正在寻找单元测试 Android 项目的权威指南，具体来说，什么可以测试，什么不能测试（在这种情况下，网络操作是库的核心），一步一步的教程也会有很大的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T20:31:02.553

Android 测试框架不允许在没有依赖于该库的应用程序项目的情况下测试 Android 库。请看这个[答案](https://stackoverflow.com/a/10173034/265597)。

[你可以在这里](http://developer.android.com/tools/testing/index.html)找到关于测试 Android 项目的很好的介绍。如果您的代码不使用 android-specific 方法您可以使用 JUnit 进行测试 + 一些模拟库。在其他测试框架中， [Robotium](http://code.google.com/p/robotium/)和[Robolectric](https://github.com/robolectric/robolectric)似乎是最受欢迎的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T22:54:26.490

此[答案在更新中提到的内容可能是](https://stackoverflow.com/a/10173034/265597)[此处](http://dtmilano.blogspot.ca/2012/04/android-testing-library-projects.html)逐步解释的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-18T11:31:48.240

确保您的检测标记在清单标记而不是应用程序标记下

# xcode - 使用 IBOutletCollections 访问 xcode 数组。脑洞大开。

> ID：11567760
> 
> 赞同：0
> 
> 时间：2012-07-19T19:16:13.947
> 
> 标签：xcode, arrays, uiimage, iboutletcollection

我有 2 个数组。一个是按钮的集合。另一个应该是字典数组。我正在使用 [arrayListName count] 在控制台的数组中记录对象的长度/大小/计数：

```
2012-07-19 19:56:59.001 ABC[3224:707] lastest_badge_outlet_collection count: 4
2012-07-19 19:56:59.007 ABC[3224:707] badges_array count: 1 
```

好的，所以当运行这个循环时，我想用数组中存在的每个字典（即 badges_array）中的键值“name”填充图像。目前我有字典存储在该数组中（这很好）。但是，当我通过循环运行它时，它总是会填充第三个图像

```
for(int i = 0; i < [lastest_badge_outlet_collection count]; i++){
        UIButton *button = [lastest_badge_outlet_collection objectAtIndex:i];
        if(i < [badges_array count]){
            NSDictionary *badge_d = [badges_array objectAtIndex:i];
            NSString *badge_d_image_string = [badge_d objectForKey:@"image"];
            UIImage *badge_d_image = [UIImage imageNamed: badge_d_image_string];
            [[button imageView] setImage:badge_d_image];
            [[button imageView] setContentMode: UIViewContentModeScaleAspectFit];
            [button setAlpha:1.0f];
        } else {
            [button setAlpha:0.5f];
        }
    } 
```

从理论上讲，它应该填充第一张图像。为什么要这样做？例如，它如何决定商品在奥特莱斯系列中的顺序...

脑子里糊涂了。

我尝试通过按顺序将它们连接起来，将它们一个接一个地重新连接到集合中，但没有成功....

这是一个屏幕截图。

谢谢！

![难以置信](../Images/3959442c2093585107b2df49da0c2b0e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:38:54.350

我认为没有办法预测 IBOutletCollection 的顺序。

我想您需要做的是在使用之前对集合进行排序。

您可以`tag`为每个按钮设置属性并按这些数字对其进行排序。

检查[此](https://stackoverflow.com/a/6757217/609086)答案以获取更多详细信息。

# html - 网站显示问题取决于计算机

> ID：11567762
> 
> 赞同：1
> 
> 时间：2012-07-19T19:16:21.120
> 
> 标签：html, css, xhtml

在五台不同的计算机上使用相同的分辨率，相同的浏览器（firefox 14.01），其中 1 个是 mac，3 个在 ubuntu 上运行，最后一个在 Windows 7 上。

所有测试都是在没有任何插件的干净浏览器上执行的......

我们也试过换屏，没有什么不同，是浏览器有问题，还是有。

另外，使用萤火虫，我比较了每个元素，它们都是相同的，除了我的链接（）在 2 台计算机上多了 2 个像素。

我在每个浏览器（Opera、Chrome、Firefox、Safari、IE 7-8-9）上都试过了，当我在 Firefox 上没有它时我没有问题，但是当我这样做时，我确实有问题每个浏览器...

我有许多 html 元素的显示问题。

所以这是我的问题：什么可能导致这种情况？

**这是我的 HTML 代码：**

```
<td style="text-align:center">
    <a style="margin-right: 10px;" href="#">
        <img alt="View" src="/statics/images/Form/view.png">
     </a>

    <a style="margin-right: 10px;">
        <img alt="Edit" src="/statics/images/Form/edit.png">
    </a>

    <a style="margin-right: 10px;" href="#" >
        <img alt="Delete" src="/statics/images/Form/delete.png">
    </a>
</td> 
```

**这是我的 a 的 CSS 代码**

```
a {
    margin-right: 10px;
    cursor: pointer;
    text-decoration: underline;
} 
```

**这是图片：**

当它不工作时： ![不工作](../Images/604ffbb2b856cb2bd6d5fa4b49af8be2.png)

当它工作时：![在职的](../Images/64b7ed8278b472649d400c6899c4ba06.png)

任何建议表示赞赏！

谢谢你们...

我们发现添加一个 1 px 的 padding-top （我们认为这不是我们的问题，因为它来自宽度）取决于它所看到的计算机......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:46:20.007

不妨试试这个，然后尝试减小宽度：

```
<td style="text-align:center; width: 200px"> 
```

由于您使用链接包装图像，因此您有可能给它一个边框（这适用于非常旧的浏览器，并且不应在 css 重置时发生，但是......）

```
a img { border: 0 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:48:02.870

尝试将您的设置`a`为：

```
a {
    margin-right: 10px;
    text-decoration: none;
}

td a {
    display: inline-block;
    width: 27px;
} 
```

我把 27px 作为简单测试的宽度，根据你的图像大小应用它。

您也可以尝试将固定宽度应用于您的`td`，足以嵌套您的三个图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:38:58.327

一种 {

```
margin-right: 10px; 
text-decoration: none; 
```

}

一：悬停{

```
margin-right: 10px; 
text-decoration: underline; 
```

}

1.  删除内联样式标签
2.  为所有标签添加 href 更好地使用 javascript:void() 或 javascript:; 代替 ＃

# php - 如何在使用 PHP/HTML 更新时保存下拉列表选择？

> ID：11567763
> 
> 赞同：2
> 
> 时间：2012-07-19T19:16:23.150
> 
> 标签：php, html

我想创建一个下拉列表，允许用户选择从数据库中提取的值。当基于所选值更新页面时，该选项将恢复为“原始”默认选项。当页面更新时，如何允许选择的值保存并保留？

```
// Drop Down Menu to choose Session

if (isset($_POST['action']))
{
    $action = $_POST['action'];
    $session = $_POST['session'];
}
else
{
    $action = "";

    if (!isset($_POST['session']))
    {
        $session = "";
    }
    else
    {
        $session = $_POST['session'];
    }
}

?>

<form name='update' action='emailinquiry_webinarnew.php' method='POST'>
Session: 
<select name='session'>
    <?php

    $query = "SELECT distinct session FROM web_attendees";
    $result = mysql_query($query) or die(mysql_error());

    while ($row = mysql_fetch_assoc($result))
    {
        echo "<option>".$row['session']."</option>";
    }
    ?>
</select>
<input type='submit' name="ViewButton" value='View'/>

</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:29:43.997

```
while ($row = mysql_fetch_assoc($result))  {
    if($row['session']==$session){
        echo "<option selected='selected' >".$row['session']."</option>";
    } else {
        echo "<option >".$row['session']."</option>";
    }
} 
```

希望它对你有用...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:29:58.337

只需在打印选项的 while 循环中添加这样的条件以添加`selected="selected"`默认情况下将选择该选项的选项：

```
while ($row = mysql_fetch_assoc($result))
{
    $selected = '';
    if (isset($_POST['session']) && $row['session'] == $_POST['session'])
        $selected = ' selected="selected"';

    echo "<option{$selected}>".$row['session']."</option>";
} 
```

# php - PHP 图片上传 MySQL

> ID：11567765
> 
> 赞同：1
> 
> 时间：2012-07-19T19:16:29.990
> 
> 标签：php, mysql, image, upload

几天以来一直在尝试清除我将图像上传到文件夹并链接到 MySQL 的错误。我已经发布了我的问题，但更改了一些代码，这就是我想再次发布它的原因。对不起，如果我垃圾邮件。

这是我的代码“adresse-bearbeiten.php”

```
<?php 
require_once ('konfiguration.php');
$target = "images/";
$target = $target . basename( $_FILES['photo']['name']);

    function sanitize( $input ){
    return mysql_real_escape_string( htmlspecialchars( stripslashes( trim( $input ) ) ) ); 
    }

    if(isset($_POST['title']))
        {

            $title          = sanitize($_POST['title']);
            $description    = sanitize($_POST['description']);
            $applepart      = sanitize($_POST['applepart']);
            $partnumber     = sanitize($_POST['partnumber']);
            $productcode    = sanitize($_POST['productcode']);
            $compatibility  = sanitize($_POST['compatibility']);
            $image          = sanitize($_FILES['photo']['name']);
            $price          = sanitize($_POST['price']);
            $insert         = mysql_query("INSERT INTO `adressbuch` (`title`,`description`,`applepart`,`partnumber`,`productcode`,`compatibility`,`photo`,`price`) VALUES ('$title','$description','$applepart','$partnumber','$productcode','$compatibility','$image','$price')");

            if(move_uploaded_file($_FILES['photo']['tmp_name'], $target))
            {

            echo "The file ". basename( $_FILES['photo']['name']). " has been uploaded, and your information has been added to the directory";
            }
            else {

            echo "Sorry, there was a problem uploading your file.";
            }

            if (!$insert)
            {
              die('Not saved: ' . mysql_error());
        }
    }
?>

        <form method="POST" action="<?php echo $_SERVER['PHP_SELF']; ?>">
          <span>Neuer Eintrag:</span> <br />
          <span>Title</span><input type="text" name="title" /> <br />
          <span>Description</span><textarea cols="16" rows="5"  name="description"></textarea> <br />
          <span>Apple Part</span><input type="text" name="applepart" /> <br />
          <span>Part Number</span><input type="text" name="partnumber" /> <br />
          <span>Product Code</span><input type="text" name="productcode" /> <br />
          <span>Compatibility</span><input type="text" name="compatibility" /> <br />
          <span>Image</span><input type="file" name="photo" /> <br />
          <span>Price</span><input type="text" name="price" /> <br />
          <input type="submit" value="Speichern"/> <br />
        </form> 
```

MySQL的

```
CREATE TABLE IF NOT EXISTS `adressbuch` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `title` text,
  `description` text,
  `applepart` text,
  `partnumber` text,
  `productcode` text,
  `compatibility` text,
  `photo` text,
  `price` text,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=26 ; 
```

下面列出了我得到的错误

*   注意：未定义索引：/Users/fatih/Sites/phpform/neu/adresse-bearbeiten.php 第 11 行中的照片
*   注意：未定义索引：/Users/fatih/Sites/phpform/neu/adresse-bearbeiten.php 第 18 行中的照片
*   注意：未定义索引：/Users/fatih/Sites/phpform/neu/adresse-bearbeiten.php 第 23 行中的照片
*   抱歉，上传您的文件时出现问题。

如果有人能告诉我我做错了什么会很高兴吗？问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:20:47.953

我会检查以下内容：

1.  你的表格`enctype`设置为`multipart/form-data`? 它应该是。( `<form enctype="multipart/form-data">`)

2.  当您`echo '<pre>';print_r($_FILES);exit;`在代码中的某个地方执行某个操作时会发生什么？它会输出有关您上传文件的一些信息吗？它应该。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:20:35.577

你检查过apache错误日志吗？你有目标文件夹的权限吗？

我一直在我工作的公司使用类似的系统，我遇到的常见错误是：

1）目标文件夹的权限 1.1）www-data 必须对目标文件夹具有权限（如果您运行 Linux） 2）站点定义（启用站点的文件夹）中的 Apache 配置，您在其中设置了一些指令，例如 root_dir。这样 Apache 可以限制对不在 root_dir 中的文件夹的访问。（例如 /var/www）。

```
Make a print_r($_FILES); 
```

用**isset**检查是否有任何东西来，否则放一些东西。

例子：

```
 $T3 = isset($_POST['T3']) ? $_POST['T3'] : NULL; 
```

您是否检查过 PHP 参考中的错误？**photo**未设置，这意味着该值不会出现，您正在尝试使用它。

# java - 限制数字开关/如果选项？

> ID：11567767
> 
> 赞同：0
> 
> 时间：2012-07-19T19:16:40.980
> 
> 标签：java

**小免责声明**我是 Java 新手，这是我正在尝试编写的第一个真正的程序。

我目前正在编写一个包含 3 个班级的程序。第一个是带有一个 JComboBox、4 个 JButton 和 20 个 JTextField 的 GUI。

第二个从 JComboBox 框中获取信息，并使用一组 if 语句为 4 个 JButton 提供标签。

第三个填充 JTextFields 当其中一个 JButton 被单击时，取决于单击的按钮和使用一组 switch 语句在 JComboBox 中的选择。

前 2 类工作正常，第三类工作正常，直到我输入 x 数量的开关，然后我开始出现错误。

我的第三类代码的一个小例子是

```
switch (hiddenText) {
        case "Abecean Longfin":
        if (command.equals("Weakness to Frost")){
        gui.r1.setText("Elves Ear");
        gui.r2.setText("Fire Salts");
        gui.r3.setText("Ice Wraith Teeth");
        gui.r4.setText("White Cap");
        gui.r5.setText("");
        gui.r6.setText("");
        gui.r7.setText("");
        gui.r8.setText("");
        gui.r9.setText("");
        gui.r10.setText("");
        gui.r11.setText("");
        gui.r12.setText("");
        gui.r13.setText("");
        gui.r14.setText("");
        gui.r15.setText("");
        gui.r16.setText("");
        gui.r17.setText("");
        gui.r18.setText("");
        gui.r19.setText("");
        gui.r20.setText("");

        }
        if (command.equals("Fortify Sneak")){
        gui.r1.setText("Beehive Husk");
        gui.r2.setText("Frost Mirriam");
        gui.r3.setText("Hawk Feathers");
        gui.r4.setText("Human Flesh");
        gui.r5.setText("Powdered Mammoth Tusk");
        gui.r6.setText("Purple Mountain Flower");
        gui.r7.setText("");
        gui.r8.setText("");
        gui.r9.setText("");
        gui.r10.setText("");
        gui.r11.setText("");
        gui.r12.setText("");
        gui.r13.setText("");
        gui.r14.setText("");
        gui.r15.setText("");
        gui.r16.setText("");
        gui.r17.setText("");
        gui.r18.setText("");
        gui.r19.setText("");
        gui.r20.setText("");
        }
        if (command.equals("Weakness to Poison")){
        gui.r1.setText("Bleeding Crown");
        gui.r2.setText("Chaurus Eggs");
        gui.r3.setText("Deathbell");
        gui.r4.setText("Giant Lichen");
        gui.r5.setText("Pine Thrush Egg");
        gui.r6.setText("Sabre Cat Tooth");
        gui.r7.setText("Small Antlers");
        gui.r8.setText("");
        gui.r9.setText("");
        gui.r10.setText("");
        gui.r11.setText("");
        gui.r12.setText("");
        gui.r13.setText("");
        gui.r14.setText("");
        gui.r15.setText("");
        gui.r16.setText("");
        gui.r17.setText("");
        gui.r18.setText("");
        gui.r19.setText("");
        gui.r20.setText("");
        }
        if (command.equals("Fortify Restoration")){
        gui.r1.setText("Cyrodilic Spadetail");
        gui.r2.setText("Salt Pile");
        gui.r3.setText("Small Antlers");
        gui.r4.setText("Small Pearl");
        gui.r5.setText("");
        gui.r6.setText("");
        gui.r7.setText("");
        gui.r8.setText("");
        gui.r9.setText("");
        gui.r10.setText("");
        gui.r11.setText("");
        gui.r12.setText("");
        gui.r13.setText("");
        gui.r14.setText("");
        gui.r15.setText("");
        gui.r16.setText("");
        gui.r17.setText("");
        gui.r18.setText("");
        gui.r19.setText("");
        gui.r20.setText("");
        }
        break; 
```

总共有 92 个案例，每个案例有 4 个 if 语句，程序运行良好，直到我达到 57 个案例和 2 个 if 语句，然后我在 IDE 的类选项卡标题中得到一个错误符号（使用 NetBeans），但不在代码中本身。

当我编译并运行代码时，出现一个错误框，显示“一个或多个项目编译时出现错误”，但如果我选择运行，就我所见，程序将运行良好。

我尝试过以各种方式编写代码。例如，最初使用 if 语句并且最初将类​​ 2 和 3 作为同一个类，并且在达到 x 数量的选择时我总是会遇到此错误。

在以前的版本中，我有时会在 IDE 的类选项卡标题中出现错误符号，而不是像往常一样出现在代码中，但是当尝试运行程序时它根本无法运行并给出了一些我不能的类路径错误现在似乎重现，所以无法发布确切的代码。

从我已经完成的测试中。例如，删除不同的代码部分似乎是在添加 x 数量的选项时发生的。即我可以添加第 52 个案例和第 3 个 if 语句并且出现错误，但是如果我删除了之前的 if 语句，那么有 52 个案例和 2 个 if 语句，然后一切正常。

从实验来看，我可以使用的 switch/if 语句的数量似乎是有限的，尽管从环顾四周我理论上可以有无限的数量？

所以我的问题是，我可以使用的开关/if 语句的数量是否有限制，或者当我输入 x 个开关/if 语句时是否有其他原因导致错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:19:49.687

您需要将数据与代码分开。将所有数据粘贴到地图和列表的组合中，并使用一些简单的通用代码来更新 gui 元素。

```
// setup data code
List<String> elements = Arrays.asList("Elves Ear", "Fire Salts", ...);
Map<String,List<String>> elementMap;
elementMap.put("Weakness to Frost");

// setup ui code
List<String> elements = elementMap.get(command);
initUI(elements);

public void initUI(List<String> elements) {
  gui.r1.setText(elements.get(0));
  // ...
} 
```

请注意，您可以将所有文本字段保存在列表中，然后更新代码为：

```
public void initUI(List<String> elements) {
  for(int i = 0; i< textFields.size(); ++i) {
    textFields.get(i).setText(elements.get(i));
  }
} 
```

一般来说，如果你发现自己写了很多重复的代码，那么你可能做错了。

另外，正如@thatidiotguy 在评论中指出的那样，随着您的前进，您可以像我的示例一样将数据从代码中移出并移到某种单独的配置文件中。

# jquery - 在jQuery中选择多个带有分页的图像

> ID：11567773
> 
> 赞同：0
> 
> 时间：2012-07-19T19:16:55.030
> 
> 标签：jquery, jquery-ui, jquery-plugins

我想知道是否有人知道符合以下特征的 jQuery 插件：

*   它显示图像列表。
*   这个列表可以分页（避免出现滚动条）。
*   它可以选择多个图像（带有复选框或以其他方式）。

我找到了这样的选项：

*   [multiselect](http://loudev.com/#demos)：但它包含滚动条并且结果尺寸太小，我需要调整更好的尺寸（尤其是宽度）。

*   [fcbklistselection](http://www.emposha.com/javascript/fcbklistselection-like-facebook-friends-selector.html)：它有类似的“缺点”。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T07:45:52.107

I found a solution to my problem. The [smartpagination](http://www.egrappler.com/jquery-pagination-plugin-smart-paginator/) jquery plugin allows to include "elements" that can be set on demand, in my case, the checkbox and the image (contained in a *li*), with the **dataelement** option.

# javascript - 使用 d3.js 和 raphael

> ID：11567776
> 
> 赞同：2
> 
> 时间：2012-07-19T19:17:08.883
> 
> 标签：javascript, jquery, raphael, d3.js

我很难过，因为[d34raphael](http://webmonarch.github.com/d34raphael/usage.html)工具上的文档不多。

我正在尝试使用 raphael从 d3.js 重现此示例： [http ://bl.ocks.org/d/1249394/。](http://bl.ocks.org/d/1249394/)这个想法是能够将其运行到不支持 svg 的 ie8 中。

我最关心的是用 raphael 代码替换“g”svg 节点。

例如如何将这些 statemetns 转换为 d34raphael：

```
var node = vis.selectAll("g.node")
   .data(nodes, function(d) { return d.id || (d.id = ++i); }); 
```

或者

```
var nodeEnter = node.enter().append("g")
    .attr("class", "node")
    .attr("transform", function(d) { return "translate(" + source.y0 + "," + source.x0 + ")"; })
    .on("click", click); 
```

我已经阅读了关于 d34raphael 的文档，但它没有用。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T18:47:41.250

拉斐尔不使用 g 元素，但有一些集合的概念。d34raphael 直接使用它：

```
paper.setStart()
...
paper.setFinish().transform(["t", margins.top, margins.left]); 
```

但这对于直接翻译 d3 代码不是很有用。我建议你扁平化你的数据和所有逻辑来定位你的元素，而不是让你的元素有一个组的孩子。

# java - Handler.postDelayed() 导致巨大的 android.os.message 堆大小

> ID：11567778
> 
> 赞同：0
> 
> 时间：2012-07-19T19:17:18.927
> 
> 标签：java, android, memory, memory-leaks, handler

嗨，我的应用程序中有多个处理程序，玩了大约 5 分钟后，android.os.message 的保留堆大小为 10mb。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:20:27.270

1.  使用一个处理程序而不是多个处理程序并将所有内容发布到它

2.  用于`Message.obtain()`创建消息，而不是构造函数

3.  避免 postDelayed

# objective-c - 对 App Store 应用程序的 CLI 支持

> ID：11567779
> 
> 赞同：0
> 
> 时间：2012-07-19T19:17:20.320
> 
> 标签：objective-c, macos, cocoa, app-store, command-line-interface

有没有办法向通过 Mac AppStore 下载的*沙盒应用程序添加命令行界面？*

类似于 XCode 命令行工具的东西，不要只使用整个可执行文件名称和路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:19:16.437

这无法完成 - 应用商店规则不允许在应用程序包之外安装代码。如果您想为您的用户提供 CLI 界面，您必须将其作为应用商店之外的单独下载提供。

# sharepoint - Powershell 运行空间池能否建立远程连接并加载管理单元？

> ID：11567783
> 
> 赞同：1
> 
> 时间：2012-07-19T19:17:22.133
> 
> 标签：sharepoint, powershell, powershell-2.0

我正在开发一个多租户 SharePoint 预配应用程序，并计划使用 Powershell 进行大部分预配。我想使用远程 Powershell 从未安装 SharePoint 的服务器调用我的 cmdlet。但是，在我可以运行任何 SharePoint cmdlet 之前，必须将 SharePoint 管理单元加载到运行空间中。不幸的是，在创建运行空间池时，我找不到同时提供连接信息和管理单元的方法。

带连接的运行空间池

```
 Dim connectionUrl = New Uri(String.Format("http://{0}/wsman/", remoteServer))
    Dim connectionInfo = New WSManConnectionInfo(connectionUrl)

    Me._runspacePool = RunspaceFactory.CreateRunspacePool(10, 20, connectionInfo) 
```

带有管理单元的运行空间池

```
 Dim sessionState = InitialSessionState.Create("Microsoft.Sharepoint.Powershell")
    Me._runspacePool = RunspaceFactory.CreateRunspacePool(sessionState) 
```

有谁知道这样做的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:01:22.267

如果您按照以下说明操作，您应该能够像在服务器上一样运行任何 SharePoint cmdlet。

[http://blogs.msdn.com/b/opal/archive/2010/03/07/sharepoint-2010-with-windows-powershell-remoting-step-by-step.aspx](http://blogs.msdn.com/b/opal/archive/2010/03/07/sharepoint-2010-with-windows-powershell-remoting-step-by-step.aspx)

如果您在设置时遇到任何问题，请告诉我...我最近自己完成了它并且运行良好。

# plugins - Gradle 中的全局插件

> ID：11567786
> 
> 赞同：4
> 
> 时间：2012-07-19T19:17:28.000
> 
> 标签：plugins, gradle

我使用 Gradle 作为我的 Scala 项目的构建工具。我也在使用 Eclipse 进行开发，所以我总是`apply plugin: 'eclipse'`在我的构建文件中使用。

还有一种方法可以定义`apply plugin`全局吗？SBT已经具备了[这样的功能](https://github.com/harrah/xsbt/wiki/Getting-Started-Using-Plugins)。我想要这个的原因是，使用我的项目的其他开发人员可能不使用 Eclipse，而是使用另一个 IDE，他们必须根据需要更改构建脚本。如果有一个全局配置文件，可以把个人配置放在那里，不会与其他配置冲突。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-20T04:01:57.003

您可以将其放入`~/.gradle/init.gradle`：

```
rootProject.allprojects {
    apply plugin: "eclipse"
} 
```

这种方法的缺点是它使构建的可重复性降低。人们现在需要添加一些东西来`init.gradle`使构建工作（某些方面）。因此，我建议在主构建脚本中应用 Eclipse 插件；它不会伤害不使用它的人。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-19T22:12:39.117

您可以`build.gradle`在[buildSrc](http://gradle.org/docs/current/userguide/organizing_build_logic.html#sec%3abuild_sources)中创建一个实现您的自定义逻辑的。只是不要将其签入版本控制。要将其应用于多个项目，您可以创建一个中央`buildSrc`目录并在要应用它的项目中创建符号链接。

# c++-cli - C++ 语法错误：缺少 ';' 在'<'之前

> ID：11567792
> 
> 赞同：0
> 
> 时间：2012-07-19T19:17:42.657
> 
> 标签：c++-cli

呃，我有一个问题，我不明白......

```
class ManagedGlobals
{
public: gcroot<Editor^> MainEditor;
}; 
```

为什么我的编译器给我：

```
syntax error : missing ';' before '<' 
```

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:24:50.317

你做了这个了吗？

```
#include <vcclr.h>
using namespace System; 
```

[这是使用 gcroot 的完整示例](http://msdn.microsoft.com/en-us/library/481fa11f%28v=vs.100%29.aspx)。

# c++ - C++：静态和动态库（编译和运行）

> ID：11567798
> 
> 赞同：1
> 
> 时间：2012-07-19T19:18:13.720
> 
> 标签：c++, dll, static, compilation

我正在做一个几乎完成的图书馆项目。所以我现在给它一个测试运行。我运行我的测试项目没有问题。但是我不完全确定我是否做得对。主要是因为我不太了解到底发生了什么（至少我不完全确定）。

我已经编译了 DLL 和静态库 (.a)。对于我的测试项目，我正在使用我的库中的标题并链接到静态库。我可以编译。但是似乎我还需要可执行文件所在的 DLL 才能运行。

所以据我了解，我使用静态库进行编译，但我没有将它完全嵌入到我的可执行文件中，因此在运行时它正在寻找 DLL？

我的困惑来自于我读到静态库通常嵌入到可执行文件中的事实。但这不是只有在编译器选项中指定时才会发生吗？

我对我目前的情况感到很困惑。有人可以澄清一下吗？

编辑：我正在使用 GCC。Codelite 作为我的 IDE。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:54:22.200

lib 在编译时是静态的（不能在运行时动态链接）。所以你是正确的，lib被“嵌入”在可执行文件中。更准确地说，lib 链接到编译器为构建 exe 文件而生成的其他目标文件。一个库不能链接到另一个库，只有 exe 或 dll 可以链接到一个库。

dll在exe运行时由exe动态链接。dll就像另一个exe，但它的入口函数是“dllmain”而不是“main”。dll 可以像 exe 一样用 lib 构建。dll 还可以在运行时链接到其他 dll 以与这些 dll 的功能进行交互。dll 的接口由 def 文件定义。

至于为什么您的项目需要 dll，您可能需要检查项目中 LoadLibrary 的调用。

# asp.net-mvc - 如何在设计 MVC 应用时考虑到视图审计？

> ID：11567799
> 
> 赞同：0
> 
> 时间：2012-07-19T19:18:16.297
> 
> 标签：asp.net-mvc

我们将使用 MVC 4 构建一个应用程序。一个关键要求是视图级审计。换句话说，我们必须能够显示访问视图/屏幕的人员（例如人员详细信息）、创建视图的参数以及访问视图的时间。这是一个新的应用程序，所以我们几乎可以做任何需要做的事情来满足这个要求。

数据库将是 SQL Server 2008。数据访问将包括 EF 4.x，可能是 5.x，但不确定。

我的问题是，如何开始设计此功能？那里有任何示例应用程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:32:38.787

不要介意在视图级别进行审核。我认为审计行动更好。您可以使用全局操作过滤器（例如[此处](http://weblogs.asp.net/gunnarpeipman/archive/2010/08/15/asp-net-mvc-3-global-action-filters.aspx)）来执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:29:23.287

EF 不适用于视图。您可能会更好地使用您手动编写代码的直接 ADO.NET 持久层，或者 Linq2Sql 在使用视图方面会更好一些（尽管您仍然必须手动连接它们）。nHibernate 可能是最好的 ORM 使用。

编辑：

@user1469655 - 你对 MVC 的工作原理有一个非常根本的误解。“视图”不是页面。这是一个模板。您可能认为的“页面”（即访问特定的 url）实际上是两个不同事物的组合，一个路由和一个动作。一个动作可以导致一个特定的模板（视图）渲染，但动作和视图之间不一定是 1:1 的相关性。

“动作”是控制器的方法。这通过路由映射到 URL。通常（但不一定），这意味着这样的事情：

```
http://www.my.site/controller/action 
```

当用户访问此 URL 时，它会调用 action 方法，并可能会呈现视图。不同的action可以渲染同一个view，因为这无非就是一个html模板，任何action方法都可以随意渲染。

因此，您想要做什么取决于您实际记录的内容。记录对视图的访问没有任何意义，因为这实际上没有任何意义。您要做的是通过操作记录访问，甚至可能通过路由记录访问。

最简单的方法是使用在每个操作之前调用的全局操作过滤器，在该过滤器中，您可以记录您需要的信息（用户 ID、日期、时间、操作、引荐来源网址等）.. 它得到呼吁采取每一个行动。但是，它不会被忽略的路由调用（例如像 javascript、图像、css、直接下载的文件等内容）。如果您需要记录这些，则需要通过操作控制对它们的访问。

这里有一个关于动作过滤器的很好的教程

[http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/understanding-action-filters-cs](http://www.asp.net/mvc/tutorials/older-versions/controllers-and-routing/understanding-action-filters-cs)

# django - 如何从 Django 代码访问 urls.py 中的所有 url？

> ID：11567800
> 
> 赞同：3
> 
> 时间：2012-07-19T19:18:19.007
> 
> 标签：django

> **可能重复：**
> [确定完整的 Django url 配置](https://stackoverflow.com/questions/1828187/determine-complete-django-url-configuration)

如何从 Django 代码访问 urls.py 中的所有 url？

我想获取列出的所有 url 的列表，`urls.py`并在另一个 Django 视图中遍历它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:21:54.563

请参阅这个相关的 StackOverflow[问题](https://stackoverflow.com/questions/1828187/determine-complete-django-url-configuration)和[答案](https://stackoverflow.com/a/1829565/654031)。同样在评论中，有人发布了[这个精彩的脚本](http://code.activestate.com/recipes/576974/)：

```
import urls

def show_urls(urllist, depth=0):
    for entry in urllist:
        print "  " * depth, entry.regex.pattern
        if hasattr(entry, 'url_patterns'):
            show_urls(entry.url_patterns, depth + 1)

show_urls(urls.urlpatterns) 
```

# string - R：从 FUN(1.01) 返回“1.0”？

> ID：11567802
> 
> 赞同：2
> 
> 时间：2012-07-19T19:18:39.040
> 
> 标签：string, r, xtable

我想将一个数字转换为指定数量的有效数字，例如一些`"1.0"`从`FUN(1.01)`. （我需要一个字符，因为该值将用于`xtable`.

我怀疑这是微不足道的，但我遇到了麻烦。

这是我尝试过的：

```
> signif(1.01, 2)
[1] 1
> round(1.01, 2)
[1] 1.01
> format(1.01, digits = 2)
[1] "1"
> as.character(trunc(1.20, 3))
[1] "1"
> as.character(round(1.01, digits = 2))
[1] "1" 
```

有没有可以做到这一点的功能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T19:21:43.883

尝试`?sprintf`：

```
> sprintf("%0.1f", 1.01)
[1] "1.0" 
```

还有`format`and `formatC`，您可能会发现它对用户更友好：

```
> format(1.01,digits=1,nsmall=1)
[1] "1.0"
> formatC(1.01,digits=1,format="f")
[1] "1.0" 
```

# ruby - 使用 capistrano 部署应用程序后权限被拒绝

> ID：11567810
> 
> 赞同：1
> 
> 时间：2012-07-19T19:19:10.553
> 
> 标签：ruby, ruby-on-rails-3, deployment, capistrano

我有一个`deploy.rb`这样的

```
set :application, "api"
set :repository,  "git@github.com/org/api.git"

default_run_options[:pty] = true
set :scm_passphrase, "passwd"

set :scm, :git

set :user, "deploy"
set :use_sudo, false
set :deploy_to, "/var/www"
set :deploy_via, :remote_cache

role :web, "192.168.0.95"                          # Your HTTP server, Apache/etc
role :app, "192.168.0.95"                          # This may be the same as your `Web` server
role :db,  "192.168.0.95", :primary => true # This is where Rails migrations will run
role :db,  "192.168.0.95" 
```

如您所见，我正在部署到我们的 Intranet...
之后，我`bundle exec foreman start`在我们的服务器上执行，当我访问该应用程序时，我看到了：

```
Permission denied - /var/www/releases/20120719190900/tmp/cache 
```

我试图 chmod 和 chown 我们的 www 文件夹，但没有任何改变......
我在这里错过了什么？
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T05:58:12.990

你可以试试`set :use_sudo, true`而不是假的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T12:05:19.507

我刚刚在文件夹`cache`中创建了文件`tmp`夹并且它有效！奇怪的事情...

# mysql - 在 2 列 = 1 列上加入 mysql 表两次

> ID：11567815
> 
> 赞同：0
> 
> 时间：2012-07-19T19:19:42.380
> 
> 标签：mysql

我有一个包含消息的数据库。消息存储在一个表中，用户信息存储在另一个表中。在message表中，有一个author_id列，代表user表中作者的user_id，有所有message列，还有一个to_address，代表user表中“u_”+user_id的串联。有什么我可以加入这两个表的，以便它在 author_id 和 to_address 中显示用户名而不是 ID。

我试过了

```
SELECT  username, ..., username
  FROM msgs
    INNER JOIN users
      ON user_id=author_id AND concat("u_",user_id)=to_address; 
```

有明显错误我尝试使用子查询，例如

```
SELECT
  ( SELECT username 
      FROM users
        INNER JOIN msgs
          ON user_id=author_id
  ) AS "From",
  ( SELECT username
      FROM users
        INNER JOIN msgs
          ON CONCAT("u_",user_id)=to_address
  ) AS "To",
  ( SELECT timestamp(message_time) FROM msgs
  ) AS "Sent",
  ( SELECT message_subject FROM msgs
  ) AS "Subject",
  ( SELECT message_text AS "Message" FROM msgs
  ) AS "Message" 
```

并得到“子查询返回超过 1 行”。有什么方法可以让我成功地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:24:11.020

听起来你想要这样的东西：

```
SELECT
    from_user.username AS "From",
    to_user.username AS "To",
    timestamp(msgs.message_time) AS "Sent",
    msgs.message_subject AS "Subject",
    msgs.message_text AS "Message"

FROM msgs

INNER JOIN users AS from_user
ON msgs.author_id = from_user.user_id

INNER JOIN users AS to_user
ON msgs.to_address = CONCAT("u_", to_user.user_id); 
```

基本上，您将`users`表连接到`msgs`表两次，为表的每个实例赋予不同的名称和不同的连接条件。然后，您可以从表的特定实例中选择特定列`users`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:26:38.993

我想你想做类似的事情

```
SELECT msgs.*,
       authors.whatever,
       addresses.to_address
  FROM msgs
  JOIN users AS authors ON msgs.author_id = authors.id
  JOIN users AS addresses ON msgs.address_id = addresses.id 
```

我的查询可能不精确，但您可能可以看到我在这里做什么。

顺便说一句，我建议[不要缩写 msgs](http://jasonswett.net/blog/save-time-by-thinking-less-not-by-typing-less/)并[使用单数表名](http://jasonswett.net/blog/why-database-table-names-should-be-singular/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:28:51.753

您需要两个连接，因为您想获得两个单独的用户：

```
select f.username, t.username
from msgs m
inner join users f on f.user_id = m.author_id
inner join users t on concat("u_", t.user_id) = m.to_address 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T19:40:04.220

这将返回与“author_id”和“to_address”关联的用户名，使用相关的子查询，而不是使用 JOIN。（使用 JOIN 是通常的方法，但使用相关子查询的方法为您提供了一些额外的灵活性。

```
SELECT (SELECT u.username 
          FROM users u 
            ON u.user_id = CONCAT("u_",u.user_id) = m.to_address
         ORDER BY u.username LIMIT 1
       ) AS to_username
     , (SELECT a.username 
          FROM users a 
            ON a.user_id = m.author_id
           ORDER BY a.username LIMIT 1
       ) AS author_username
     , m.*
  FROM msgs m 
```

注意：这与 INNER JOIN 有点不同，因为当找不到与 to_address 或 author_id 匹配的用户名时，它将从 msg 返回一行。）

注意：这假设 user_id 在 users 表中是唯一的。

注意：如果用户表中的用户名列不为 NULL，那么您可以模拟 INNER JOIN，并且如果未找到 author_id 或 to_address 的匹配用户名，则通过添加

```
HAVING to_username IS NOT NULL
   AND author_username IS NOT NULL 
```

# objective-c - Jeff Lamarches 脚本如何将纹理绑定到对象

> ID：11567819
> 
> 赞同：0
> 
> 时间：2012-07-19T19:20:04.613
> 
> 标签：objective-c, ios, opengl-es, glkit

> **可能重复：**
> [使用 Jeff Lamarches 脚本加载模型](https://stackoverflow.com/questions/11567640/loading-model-using-jeff-lamarches-script)

伙计们，这听起来可能是个新手问题，我对 GLKit 和 OpenGL 还是很陌生

我正在使用此处（[https://github.com/jlamarche/iOS-OpenGLES-Stuff](https://github.com/jlamarche/iOS-OpenGLES-Stuff)）的 Jeff Lamarches scipt 从 Blender 生成 Objective C 头文件。

假设我创建了一个立方体并在 Blender 中使用一些图像假设 image.png 进行了 UV 映射。

所以基本上我想了解标题中关于3D模型上纹理映射的信息保存在哪里？因为我只看到其中的顶点坐标和法线。

在他的 MeshVertexModel 示例中是一个三字段数组，即

```
...
    {/*v:*/{-0.351562, 0.828125, -0.242188}, /*n:*/{-0.183599, 0.982971, 0.005310}, /*t:*/{0.954205, 0.958702}},
... 
```

但是我从生成的头文件中得到的只是以下格式

```
...
    {/*v:*/{-0.351562, 0.828125, -0.242188}, /*n:*/{-0.183599, 0.982971, 0.005310}},
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:15:52.433

发现类似问题也有**Wavefront export**，这里[http://projects.blender.org/tracker/index.php?func=detail&aid=30317&group_id=9&atid=498](http://projects.blender.org/tracker/index.php?func=detail&aid=30317&group_id=9&atid=498) in 2.63 Blender。

只是替换`uv_layer = me.uv_textures.active.data`by`uv_layer = me.tessface_uv_textures.active.data`有助于生成纹理坐标。

更新：对于球体和立方体，脚本无法正常工作，即对于立方体，它不会生成任何顶点，而对于球体，它确实会生成一个圆的顶点，对于其他复杂的对象，补丁可以正常工作并正确生成所有数据。

# php - 登录身份验证令牌php ..卡住

> ID：11567820
> 
> 赞同：0
> 
> 时间：2012-07-19T19:20:09.203
> 
> 标签：php

当用户注册帐户时，会创建一个包含列的表；用户 ID 和令牌。这是因为如果用户在不同的计算机上登录时检查记住我，每台计算机都有不同的令牌。

注册.php

```
//user specific table created    
$create = $connectdb->prepare("CREATE TABLE `user-:username` (userid INT, token varchar(200)");
                        $executequery = $create->execute(array("username"=>$username)); 
```

这是 login.php 的片段；我创建令牌，将令牌存储在 cookie 中并将令牌插入到该用户特定的表中

```
 if($remember==1) {
                            $token = md5(uniqid('',true));
                            setcookie('token',$token,time()+60*60*24*365);

                            $rememberquery = $connectdb->prepare("INSERT INTO `user-:username` VALUES ('',:username,:token)");
                            $rememberquery->execute(array(":username"=>$username,":token"=>$token));
$_SESSION['username'][0] = $username;       
$_SESSION['username'][1] = $userid;                 
                            } 
```

现在我被卡住了（假设我已经正确地完成了前面的操作）。何时/如何检查 cookie 令牌到数据库令牌？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T19:37:53.007

正确的身份验证很难正确进行，因此您必须不时扮演一个小黑客才能使事情基本正确。首先，您应该阅读[会话管理备忘单](https://www.owasp.org/index.php/Session_Management_Cheat_Sheet)和 owasp 页面。

在本次讲座之后，您应该了解会话管理的注意事项。但是，如果您需要记住我的备忘单；）它应该是这样的：

*   值应该是完全随机的，或者密码学强（这可能很棘手）
*   应在接收时进行验证
*   永远不要相信你从 cookie 中得到的东西，所以如果没有适当的验证，将用户名存储在 cookie 中是一个非常非常非常糟糕的主意
*   如果会话过期创建一个新的，用你的表中的数据填充它，瞧，
*   如果您需要保留某些内容，请使用数据库而不是 cookie cookie 不好且不值得信赖；）

[微软的Threats and countermeasures](http://www.microsoft.com/en-us/download/details.aspx?id=24696)也是一个很好的出版物，它可以帮助你很多。

# objective-c - 在 Objective-C 中打印一行 10 次？

> ID：11567823
> 
> 赞同：0
> 
> 时间：2012-07-19T19:20:20.027
> 
> 标签：objective-c

我知道打印线是`NSLog`. 如何在 Objective-C 中打印一行 10 次？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-19T21:24:31.523

我还没有机会重构，但是这样的事情应该可以工作！

```
for(int i = 0; i < 10; i++)
{
    if(i == 0)
        NSLog(@"A line");
    else if (i == 1)
        NSLog(@"A line");
    else if (i == 2)
        NSLog(@"A line");
    else if (i == 3)
        NSLog(@"A line");
    else if (i == 4)
        NSLog(@"A line");
    else if (i == 5)
        NSLog(@"A line");
    else if (i == 6)
        NSLog(@"A line");
    else if (i == 7)
        NSLog(@"A line");
    else if (i == 8)
        NSLog(@"A line");
    else if (i == 9)
        NSLog(@"A line");
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-07-19T20:16:12.380

另一个`while`循环选项。

```
//
//  main.m
//  Pritner
//
//  Created by Joshua Caswell on 7/19/12.
//

#import <Foundation/Foundation.h>
#import <objc/runtime.h>

// A Pritner instance holds and displays a passed-in string. The string is publicly
// unchangeable.
@interface Pritner : NSObject

+ (id)pritnerWithLine: (NSString *)newLine;
- (void)printLine;

@property (readonly, copy, nonatomic) NSString * line;

@end

// Extension to manage "class variable" for counting number of created instances
@interface Pritner ()

+ (NSUInteger)numPritnersCreated;
+ (void)setNumPritnersCreated:(NSUInteger)n;
+ (NSUInteger)maxNumPritners;

@property (readwrite, copy, nonatomic) NSString * line;

- (id)initWithLine: (NSString *)line;

@end

@implementation Pritner

@synthesize line;

+ (id)pritnerWithLine: (NSString *)newLine {
    id newInstance = [[self alloc] initWithLine:newLine];
    if( newInstance ){
        NSUInteger createdSoFar = [self numPritnersCreated];
        // Only allow maxNumPritners to ever be created; keeping track of them
        // is the client's problem.
        if( createdSoFar >= [self maxNumPritners] ){
            abort();
        }
        [self setNumPritnersCreated:createdSoFar + 1];
    }

    return newInstance;
}

// Fake class variable using associated objects; keep count of created instances 
char numPritnerKey;
+ (NSUInteger)numPritnersCreated {
    NSNumber * n = objc_getAssociatedObject(self, &numPritnerKey);
    if( !n ){
        n = [NSNumber numberWithUnsignedInteger:0];
        [self setNumPritnersCreated:0];
    }
    return [n unsignedIntegerValue];
}

+ (void)setNumPritnersCreated:(NSUInteger)n {
    objc_setAssociatedObject(self, 
                             &numPritnerKey, 
                             [NSNumber numberWithUnsignedInteger:n], 
                             OBJC_ASSOCIATION_RETAIN);
}

// Maximum number of instances ever allowed to be created
+ (NSUInteger)maxNumPritners {
    return 10;
}

- (id)initWithLine: (NSString *)newLine {

    self = [super init];
    if( !self ) return nil;

    line = [newLine copy];

    return self;
}

- (void)printLine {
    NSLog(@"%@", [self line]);
}

@end

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        while( YES ){
            Pritner * p = [Pritner pritnerWithLine:@"I figure, if you're going to build a time machine out of a car, why not do it with some style?"];
            [p printLine];
        }

    }
    return 0;
} 
```

请不要在现实生活中使用它。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-07-20T03:27:30.440

不要忘记“Objective-C”中的“对象”。

```
NSArray *lines = [@"123456789" componentsSeparatedByCharactersInSet:[NSCharacterSet alphanumericCharacterSet]];
[lines enumerateObjectsUsingBlock:^(id obj, NSUInteger i, BOOL* stop) {
    NSLog(@"a line");
}]; 
```

如果您认为 Objective-C 对 Smalltalk 的根源不够真实，您可以执行以下操作。

```
typedef void (^LoopBlock)(NSNumber*);
@interface NSNumber (loop)
-(void)to:(NSNumber*)upTo do:(LoopBlock)block;
-(void)timesRepeat:(LoopBlock)block;
@end

@implementation NSNumber (loop)
static NSString *loopSeparator = @"_";
-(void)to:(NSNumber*)upTo do:(LoopBlock)block {
    [   [   [@"" stringByPaddingToLength:[upTo unsignedIntegerValue]-[self unsignedIntegerValue]
                              withString:loopSeparator
                         startingAtIndex:0
            ] componentsSeparatedByString:loopSeparator
        ] enumerateObjectsUsingBlock:^(id obj, NSUInteger i, BOOL* stop) {
            block([NSNumber numberWithUnsignedInteger:i+[self unsignedIntegerValue]]);
        }
    ];
}

-(void)timesRepeat:(LoopBlock)block {
    [[NSNumber numberWithUnsignedInteger: 1] to:self do:block];
}
@end

int main() {
    @autoreleasepool {
        [[NSNumber numberWithInt:10] 
          timesRepeat:^(NSNumber* i){
                NSLog(@"a line");
            }];
    }
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-07-19T19:48:44.993

以另一种方式使用[Grand Central Dispatch ：](http://developer.apple.com/library/mac/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/doc/uid/TP40008079-CH2-SW5)

```
dispatch_apply(10, dispatch_get_main_queue(), ^(size_t curr_iteration){
    NSLog(@"a line");
}); 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-07-19T19:44:48.013

使用递归：

```
print(10);

void print(int i){
   if(i == 0)
      return;
   NSLog(@"print this line");
   print(i - 1);
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-07-19T19:39:00.950

使用 goto 语句：

```
 int i = 0;
print:
  NSLog(@"print this line");
  if (i++ < 10) goto print; 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-07-19T19:21:48.103

使用 for 循环：

```
for (int i = 0; i < 10; i++) {
    NSLog(@"print this line");
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-07-19T19:44:58.000

使用 Grand Central Dispatch：

```
__block int i = 0;
__block dispatch_block_t print_block = ^() {
    NSLog(@"print this line");
    i += 1;
    if (i < 10) dispatch_sync(dispatch_get_main_queue(), print_block);
}
dispatch_sync(dispatch_get_main_queue(), print_block); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-19T19:36:43.120

使用 while 循环：

```
int i = 0;
while (i < 10) {
    NSLog(@"print this line");
    i += 1;
} 
```

# vb.net - 是否有相当于 umask for Windows 或其他解决方案？

> ID：11567826
> 
> 赞同：1
> 
> 时间：2012-07-19T19:20:30.443
> 
> 标签：vb.net, permissions, ntfs, umask

我有一个创建文件夹树并设置权限的 VB.NET 应用程序。

我希望应用程序创建的文件夹的权限对普通用户来说是只读的。但我希望用户能够在他们制作的这棵树中创建和删除文件/目录。

我遇到的问题是用户创建的文件/目录与父目录具有相同的权限（Windows umask 是复制父目录）。

因此，用户要么拥有太多权力，要么可以从应用程序创建的树中删除文件夹。或者用户没有足够的权力并且无法删除他们在应用程序创建的目录树中创建的文件/文件夹。

我无法使用 ACL 传播和继承属性解决此问题： [VB.NET 应用程序正在对目录设置受限文件权限，这错误地限制了用户在同一目录中创建的文件](https://stackoverflow.com/questions/11551429/vb-net-app-is-setting-restricted-file-permissions-on-a-directory-which-is-incor)

有什么想法或其他方法可以解决这个问题吗？谢谢，迈克

# java - 如何获取用于访问Java网站的地址

> ID：11567828
> 
> 赞同：0
> 
> 时间：2012-07-19T19:20:34.847
> 
> 标签：java, html, applet, ip-address, lighttpd

我很抱歉我的问题措辞很糟糕，但我不知道该怎么说。

无论如何，我有一个嵌入网页的 Java Applet。然后使用网络服务器 lighttpd 将该网页放在网络中。我需要从 Java 小程序中（通过从网络上的不同计算机访问的网页）获取运行服务器的计算机的 IPv4 地址（这是输入访问页面的地址，例如“http://192.168 .1.123"）。我已经尝试了所有我发现或能想到的东西，但到目前为止没有任何效果。如果可以的话请帮忙。

眼镜：

```
-Eclipse Helios
-Windows 7
-lightTPD for windows
-webpage is html document 
```

如果您需要更多信息，请发送电子邮件或评论！

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:31:20.860

用 php 用 java applet 生成页面怎么样？然后，您可以将服务器的 IP 作为参数传递给小程序。

[http://docs.oracle.com/javase/tutorial/deployment/applet/param.html](http://docs.oracle.com/javase/tutorial/deployment/applet/param.html)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-19T19:42:11.687

您可以从 HttpServletRequest 类中获取此信息。包括几种可能有用的方法。请参阅以下文档作为资源：

[接口 ServletRequest](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html)

[接口 HttpServletRequest](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html)

编辑：

如果您对此投了反对票，请随意发表评论，如果您有更好的方式来访问服务器信息，而不是从请求中访问。如果您觉得这个答案不合适，我很想知道您将如何完成它。

考虑到这也与此处接受的答案有关： [从 JSP 请求/会话对象中获取服务器 IP 地址，因此反对票尤其令人烦恼](https://stackoverflow.com/questions/3177203/get-server-ip-address-from-jsp-request-session-object)

在这里： [在 Java 中获取应用程序服务器名称或 ip 和端口](https://stackoverflow.com/questions/1826977/get-application-server-name-or-ip-and-port-in-java)

它也记录在这里：

[获取本地机器的 IP 地址和主机名](http://www.exampledepot.com/egs/java.net/Local.html)

# javascript - 带有 Instagram JSON 的 jQuery AJAX $.each

> ID：11567834
> 
> 赞同：0
> 
> 时间：2012-07-19T19:21:06.147
> 
> 标签：javascript, jquery, ajax, instagram

我使用 ajax 函数将更多照片加载到页面中。我将此功能用于用户上传的图像及其提要，它们都在 API url 的末尾使用“max_id”参数...当我尝试将此功能用于喜欢时，它不起作用，因为喜欢的媒体url 以“max_like_id”结尾。我不知道为什么，但也许你们可以帮助我！这是我的所有代码：

```
<script type="text/javascript">
$(document).ready(function() {
  $('#more').click(function() {
var user   = $(this).data('user'),
maxid = $(this).data('maxid');

$.ajax({
type: 'GET',
url: 'ajaxloadlikes.php',
data: {
  user: user,
  max_like_id: maxid
},
dataType: 'json',
cache: false,
success: function(data) {
$.each(data.images, function(i, img) {
$('ul#photos').append('<a href="/media.php?user=' + img.user + '&id=' + img.id + '"><img src="' + img.url + '" alt="" /></a>');
});
// Store new maxid
$('#more').data('maxid', data.next_id);
 }
});
 });
});

</script>

<a id="more" data-maxid="'.$liked_media->pagination->next_max_like_id.'" data-user="self'">Load More</a> 
```

然后我的 ajaxloadlikes.php 有这个：

```
$maxID = $_GET['max_like_id'];
$userID = $_GET['user'];
$accessID = **access token**;

$next = "https://api.instagram.com/v1/users/self/media/liked?access_token={$accessID}&max_like_id={$maxID}";

$json = file_get_contents($next);

$media = json_decode($json);

// Collect everything for json output
$images = array();
foreach ($media->data as $data) {
$images[] = array('id' => $data->id, 'url' => $data->images->low_resolution->url, 'user' => $data->user->username);
}

echo json_encode(array('next_id' => $mine->pagination->next_max_like_id, 'images' => $images)); 
```

如果我将 $next url 设置为“max_id”而不是“max_like_id”，它只会一遍又一遍地加载相同的图像......

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:53:17.630

根据提供的代码，您似乎错误地引用了您的对象。`data.data[i]`指的是返回的对象，`data`，然后是 of 中的一个属性`data`--中的一个属性`data.data`，然后它看起来是一个数组，如使用`[i]`. 但是，我没有看到您声明的位置`i`或`data`对象中的属性。

由于缺乏支持信息，我在示例中做了一些假设：

```
var data = {
    "next_id": "*next-id*",
    "images": [
        {
        "id": "*image id*",
        "url": "*image low_resolution link*",
        "user": "*user*"},
    {
        "id": "*image id*",
        "url": "*image low_resolution link*",
        "user": "*user*"}
    ]
};

var json = data.images;

for(var i = 0; i < json.length; i++) {
    var img = json[i];
    var item = '<li><div class="image"><a href="/media.php?user=' + img.user + '&id=' + img.id + '"><img src="' + img.url + '" alt="" /></a><a href="/media.php?user=' + img.user + '&id=' + img.id + '"><img class="hoverimage" src="/zoom.png" alt="" /></a></div></li>';
    $('ul#photos').append(item);
} 
```

演示： [//jsfiddle.net/DdqxT/](http://jsfiddle.net/DdqxT/)

上面的代码采用`data`对象，然后循环遍历`images`属性以返回其数组中的对象。

我在您的问题中注意到的一件事是您拥有`img.user.`不应包含尾随的`.`.

# php - 当mysql时间戳> 20分钟时要删除的时间戳比较

> ID：11567835
> 
> 赞同：3
> 
> 时间：2012-07-19T19:21:10.887
> 
> 标签：php, mysql, timestamp, comparison, sql-delete

我想做一些不复杂的事情，但即使我尝试了很多事情，我也没有成功......

首先，我有一个带有一行时间戳类型的数据库mysql。我在其中插入日期如下的元素：

```
$date = date('Y-m-d H:i:s', time());
$req =mysql_query("INSERT INTO my_table (id, departement, voie, date,message)
    VALUES ('', '$departement_token', '$voie_token','$date' , '$message_token')"); 
```

此代码行的结果是一个日期元素，如下所示：`2012-07-19 20:18:17`

我想用 a 删除所有元素，但`date > current date + 20 minutes`我没有成功......

我试过这个：

```
mysql_query("DELETE FROM my_table WHERE  DATE_SUB(date,INTERVAL 20 MINUTE) ORDER BY date"); 
```

还有这个：

```
$req=mysql_query("DELETE FROM my_table WHERE date >= TIMESTAMPADD(MINUTE,-20,NOW())
                  ORDER BY date"); 
```

还有这个：

```
$timePlus20min = time() + 1200;
//et on compare les deux dates
$req = mysql_query(
    "DELETE FROM my_table WHERE UNIX_TIMESTAMP(date) >= '$timePlus20min' ORDER BY date"); 
```

但这些都不起作用。你能帮我吗，我认为这不是太难，但我没有想法......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T14:45:03.883

```
$period=date('Y-m-d H:i:s',time()-(60*60*6)); // 6 hour before

"SELECT * FROM limitlessisa WHERE UNIX_TIMESTAMP(REG) > UNIX_TIMESTAMP('$period')";

REG // timestamp row name 
```

这是有效的。列出数据前 6 小时

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T19:37:06.070

在所有查询中，您都忘记了`WHERE`关键字，因此它们在语法上是错误的。此外，该`ORDER BY`语句没有效果，因为您没有执行`SELECT`查询。没有可以订购的结果。相反，单个表`DELETE`查询返回[已删除行数的计数](http://dev.mysql.com/doc/refman/5.5/en/delete.html)。

```
DELETE FROM my_table WHERE date >= DATE_ADD(NOW(), INTERVAL 20 MINUTE); 
```

由于我不知道您的表结构，因此我使用下表尝试了此查询：

```
CREATE TABLE `datetest` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `date` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=3 ; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T19:29:37.243

试试这个 ：

```
$req=mysql_query("DELETE FROM my_table WHERE date <= ".date("Y-m-d H:i:s", mktime(date("H"), date("i")-20, date("s"), date("m"), date("d"), date("Y"))); 
```

Bonne chance à toi / 祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T19:29:49.087

试试这个：

```
DELETE FROM my_table WHERE UNIX_TIMESTAMP(date) > 60 * 60 * 20 + UNIX_TIMESTAMP(); 
```

# c# - 通过服务交付时，如何让 HTML5 视频在 chrome 中擦洗？

> ID：11567837
> 
> 赞同：1
> 
> 时间：2012-07-19T19:21:15.303
> 
> 标签：c#, google-chrome, html5-video, seek

因此，由于内容与我的服务器应用程序的虚拟目录位于不同的驱动器上，我不得不实现文件获取服务。

我能够获取文件大小。然后我想设置内容标题，以便浏览器知道总大小，从而知道如何按比例查找栏。

在这里我设置了总大小标题：

```
 string bytes = Convert.ToString( fInfo.Length );                   
   Response.AddHeader("Content-Length", bytes );
   Response.AddHeader("Content-Range", "bytes 0-" + bytes + "/" + bytes); 
```

导致：

```
Content-Length: 1389363
Content-Type: video/ogg
Content-Range: bytes 0-1389363/1389364 
```

我下载了生成的文件并确认字节匹配。在 Firefox 中运行良好，在 chrome 中都很古怪。**在 chrome 中，它播放到最后，但不移动搜索栏，然后在到达结尾时在当前时间显示负无穷大。另外，我根本无法清理视频，大概是因为它的持续时间无效。**

直接在chrome中播放同一个文件可以正常工作，所以也许它是chrome希望firefox不提供as#%t的一些内容标题？

有任何想法吗？长度单位错误？内置服务器端 g-zip 编码干扰？

我正在使用标准视频对象：

```
<video class="videoplayer" controls="" autoplay="autoplay" tabindex="0">
<source type="video/ogg" src="http://vb_html.dev/GetFile.aspx?filename=c:/_assets/4c2c09c2-f2ff-e011-a992-009056af18ff/softsignage/softsignage-00000000600.ogv"></source>
Your browser does not support the video tag.
</video> 
```

有关更多参考，这是我传递文件数据的方式：

```
 FileStream mystream = new FileStream(anyFilePath, FileMode.Open, FileAccess.Read);
                    byte[] buffer = new byte[4096];
                    using (BinaryReader reader = new BinaryReader(mystream))
                    {

                        while (true)
                        {
                            int bytesRead = mystream.Read(buffer, 0, buffer.Length);
                            if (bytesRead == 0) break;
                            Response.OutputStream.Write(buffer, 0, bytesRead);
                        }
                    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T09:21:28.890

尝试将状态码设置为 206：

```
response.StatusCode = 206; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-29T22:40:59.033

基本上，您希望以字节为单位获取请求范围，并返回文件的该部分。您可以在 MVC 中使用

```
 RangeFileStreamResult(Stream fileStream, string contentType, string fileName, DateTime modificationDate); 
```

使用此库[http://mvcresumingactions.codeplex.com/中的 Codeplex 示例](http://mvcresumingactions.codeplex.com/)

--

# windows-phone-7 - 使用 c# 为 wp7 应用程序显示随机画布

> ID：11567848
> 
> 赞同：0
> 
> 时间：2012-07-19T19:21:46.067
> 
> 标签：windows-phone-7, random

我正在为 Windows 7 创建一个问答游戏。每个问题都会在新画布中打开。如何随机化画布视图，以便玩家每次玩游戏时都会收到随机问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T08:42:02.290

不确定您到底要达到什么目标，但看起来很简单。您需要做的就是选择一个随机画布并显示它？

看看 windowsphone 的 wordastic。它有一个视图，我随机更改显示的数据。

# php - 单击页面元素并将它们用作表单数据

> ID：11567860
> 
> 赞同：2
> 
> 时间：2012-07-19T19:22:46.840
> 
> 标签：php, javascript, jquery, mysql, html

我正在制作一个有照片页面的网站。在照片页面上，我想要相册和单张照片。我还希望用户能够创建新专辑，只需单击我的“+创建专辑”按钮，然后只需单击他们希望存储在该专辑中的图像即可。我不确定我需要知道该怎么做。我知道如何创建一个表单，这基本上是我需要的，并使用 php 将数据存储在我的数据库中以创建相册，但我不知道该怎么做是让用户从我的表单中输入值只需在相册中单击他们想要的图像。这是一个带有步骤的插图。

![专辑创作过程](../Images/afa32bc46771dcea9281d6ea335bd57a.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T19:34:08.567

基本上要回答您关于“如何将用户定义的值从图像获取到表单”的问题，您可以使用它：

### 演示

[http://jsfiddle.net/insertusernamehere/DdNZz/](http://jsfiddle.net/insertusernamehere/DdNZz/)

### JavaScript

```
$(document).ready(function () {

    // add event handler to the image
    $('#image').click( function(event) {

        // put value into the input field
        $('#input').val( $(this).data('myvalue') );
    });
}); 
```

### HTML

```
<img id="image" src="http://lorempixel.com/output/nightlife-q-c-200-200-4.jpg" data-myvalue="image one clicked" alt="">
<input type="text" id="input" value=""> 
```

使用`data-*`-attribute 可以让您指定自己的值，并且是完全有效的 HTML5，而旧版浏览器也可以毫无问题地处理它。

但是关于您的想法还有很多要考虑的事情，我不确定这对于关于 SO 的问答是否过多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:30:21.050

```
<img class="click-the-picture" src="photo1.jpg">
<img class="click-the-picture" src="photo2.jpg">
<img class="click-the-picture" src="photo3.jpg">

<form id="theform">
<button>Save</button>
</form>

<script>
$(function(){
   $('.click-the-picture').live('click',function(){
       $('#theform').append('<input type="hidden" name="photo[]" value="' + $(this).attr('src') + '"');
   });
});
</script> 
```

您可以尝试使用此代码为每次图片点击生成隐藏输入，然后将它们发送到数据库

# java - Java 的 Graphics.drawImage 产生不准确的图像

> ID：11567861
> 
> 赞同：1
> 
> 时间：2012-07-19T19:22:50.223
> 
> 标签：java, image, rendering

我正在尝试将一个图像绘制到另一个图像上，`graphics.drawImage()`但它只适用于某些图像，而其他图像则搞砸了。我的代码在下面，当它进入方法时，我确保`texture`它是正确的图像，所以绝对不是它。有任何想法吗？

```
private BufferedImage currentSheet;
public void swapRegionWithTexture(Rectangle region, Image texture) {
    Graphics sheetGraphics = currentSheet.createGraphics();
    for (int ix = region.x; ix < region.x + region.width; ix++) {
        for (int iy = region.y; iy < region.y + region.height; iy++) {
            currentSheet.setRGB(ix, iy, 0x000000);
        }
    }
    sheetGraphics.drawImage(texture, region.x, region.y, null);
    sheetGraphics.dispose();
} 
```

总体思路是：

1.  抓取要绘制的图形。
2.  清除将要绘制的图形部分。
3.  在图形上的给定位置绘制图像。
4.  处理图形。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:32:18.570

因此，您当前的原子步骤是：

*   创建一个新的缓冲图像
*   向该缓冲图像写入原始纹理的一些疯狂操作（看起来你正在反转它？）
*   将**原始**图像写入当前工作表。

那么如果你改变这个怎么办

```
sheetGraphics.drawImage(texture, region.x, region.y, null); 
```

对此

```
sheetGraphics.drawImage(bufferedTexture, region.x, region.y, null); 
```

否则，您会花时间反转图像并放入缓冲纹理，然后永远不会对该缓冲区做任何事情......所以您可能打算在某处使用该缓冲纹理。

# jquery - jQGrid 拖放到 DIV 上

> ID：11567866
> 
> 赞同：2
> 
> 时间：2012-07-19T19:23:04.253
> 
> 标签：jquery, jqgrid

我让我的 jQGrid 拖放到另一个 jQGrid 上，但是有没有办法将一行拖放到 DIV`append()`上并将行的 ID 拖放到 DIV 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-04T13:36:35.823

我创建了一个工作 jsfiddle - 检查这个。[http://jsfiddle.net/NishitDhakar/skJa5/](http://jsfiddle.net/NishitDhakar/skJa5/)

```
var data = [[48803, "DSK1", "02200220", "OPEN"], [48769, "APPR", "77733337", "ENTERED"], [48813, "DSK1", "02200220", "OPEN"], [58769, "APPR", "77733337", "ENTERED"]];

$("#grid").jqGrid({
    datatype: "local",
    height: 250,
    colNames: ['Inv No', 'Portfolio Details', 'Number', 'Status'],
    colModel: [{
        name: 'id',
        index: 'id',
        width: 60,
        sorttype: "int"},
    {
        name: 'Portfolio',
        index: 'Portfolio',
        width: 90,
        sorttype: "date"},
    {
        name: 'number',
        index: 'number',
        width: 80,
        sorttype: "float"},
    {
        name: 'status',
        index: 'status',
        width: 80,
        sorttype: "float"}
    ],
    caption: "Drag Drop Example",
});

var names = ["id", "Portfolio",  "number", "status"];
var mydata = [];

for (var i = 0; i < data.length; i++) {
    mydata[i] = {};
    for (var j = 0; j < data[i].length; j++) {
        mydata[i][names[j]] = data[i][j];
    }
}

for (var i = 0; i <= mydata.length; i++) {
    $("#grid").jqGrid('addRowData', i + 1, mydata[i]);
}

$("#grid").jqGrid('setGridParam', {ondblClickRow: function(rowid,iRow,iCol,e){alert('double clicked');}});
$("#grid").jqGrid('setGridParam', {gridComplete: makeGridRowsDraggable($("#" + this.id))});

function makeGridRowsDraggable(grid) {
    createDroppableElements();
    $("#grid").val(new Date().getTime());
    var $searchResultsGrid = grid;
    var searchResultsRows = $("#grid .ui-row-ltr");

    searchResultsRows.draggable({ appendTo: "body" }); searchResultsRows.draggable({
        create: function (event, ui) { }
    });

    searchResultsRows.css("cursor", "move").draggable("option", "helper", "clone").draggable({
        revert: "true",
        appendTo: 'body',
        cursor: "move",
        snap: "true",
        cursorAt: {
            top: 10,
            left: -5
        },
        helper: function (event) {
            //get a hold of the row id
            var rowId = $(this).attr('id');

            //my code
            var rowData = jQuery("#grid").getRowData(rowId);
            Id = "Portfolio ID : " + parseInt(rowData['id']);
            //set the data on this to the value to grab when you drop into input box
            $(this).data('colValue', Id);
            var dialog = ($('#DragableWidget').length > 0) ? $('#DragableWidget') :
                         $('<div id="DragableWidget" class="draggedValue ui-widget-header ui-corner-all"></div>').appendTo('body');
            dialog.html(Id);
  return dialog;
        }
        , start: function (event, ui) {
            //fade the grid
            $(this).parent().fadeTo('fast', 0.5);
        }
        , stop: function (event, ui) {
            $(this).parent().fadeTo(0, 1);
        }
    });
}

function createDroppableElements() {
    $("#txtinputFieldOne, #txtinputFieldTwo").droppable({
        tolerance: 'pointer',
        hoverClass: 'active',
        activate: function (event, ui) {
            $(this).addClass("over");
        },
        deactivate: function (event, ui) {
            $(this).removeClass("over");
        },

        drop: function (event, ui) {
            var theValue = ui.draggable.data('colValue');
            updateTextValue($(this), theValue);
        }
    });
}

function updateTextValue(txtTarget, theValue) {
    txtTarget.val(theValue);
} 
```

# java - 从 Java 到 Scala：SensorManager

> ID：11567873
> 
> 赞同：1
> 
> 时间：2012-07-19T19:24:05.890
> 
> 标签：java, android, scala

Scala/Android 新手问题。我正在尝试将这个简单的代码从 Java 重写为 Scala。Java工作代码：

```
private final SensorEventListener mAccListener = new SensorEventListener() {
    public void onSensorChanged(SensorEvent event) {
        // ... some code
    }
};

@Override    
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    findViewById(R.id.start).setOnClickListener(this);        

    mSensorManager = (SensorManager)getSystemService(Context.SENSOR_SERVICE);
    mAccSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);

    mSensorManager.registerListener(mAccListener, mAccSensor,
            SensorManager.SENSOR_DELAY_GAME);
} 
```

...和斯卡拉：

```
package com.example.hello

import android.app.Activity
import android.content.Context
import android.content.Context
import android.hardware.Sensor
import android.hardware.SensorManager
import android.os.Bundle
import android.os.Bundle
import android.view.View.OnClickListener
import android.view.View
import android.view.View
import android.widget.Toast
import android.widget.Toast
import android.hardware.SensorEventListener

class HelloAndroid extends Activity {

  def mAccListener (v: View) {
    // ... some code
  }

  override def onCreate(savedInstanceState : Bundle) {
    super.onCreate(savedInstanceState)
    setContentView(R.layout.main)

    findViewById(R.id.start).setOnClickListener(new View.OnClickListener() {
      def onClick(v: View) {
        Toast.makeText(v.getContext, "Hello World", Toast.LENGTH_LONG).show()
      }
    })

        val mSensorManager = getSystemService(Context.SENSOR_SERVICE).asInstanceOf[SensorManager]
        val mAccSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER)

        mSensorManager.registerListener(mAccListener(_), mAccSensor,
                SensorManager.SENSOR_DELAY_GAME)

  }
} 
```

错误是 Eclip 状态：

```
Multiple markers at this line
    - missing arguments for method mAccListener in class HelloAndroid; follow this method with `_' if you want to treat it as a partially applied function
    - overloaded method value registerListener with alternatives: (android.hardware.SensorEventListener,android.hardware.Sensor,Int,android.os.Handler)Boolean <and> 
     (android.hardware.SensorEventListener,android.hardware.Sensor,Int)Boolean <and> (android.hardware.SensorListener,Int,Int)Boolean <and> (android.hardware.SensorListener,Int)Boolean 
     cannot be applied to (android.view.View => Unit, android.hardware.Sensor, Int) 
```

据我了解，Scala 找不到从哪个类调用方法？我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:44:31.760

“mAccListener(_)”创建一个 android.view.View => Unit 类型的函数。但是没有任何版本的 registerListener 具有这样的功能。

Java 版本传入一个 SensorListener。Scala版本不应该做同样的事情吗？

您可能正在考虑从 View => Unit 到 SensorListener 的隐式转换......如果是这样，您需要自己构建它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:47:45.293

在这些更正之后它可以工作：

```
class HelloAndroid extends Activity {

    def mAccListener() :SensorListener = new SensorListener {
        def onSensorChanged(x1: Int, x2: Array[Float]) = {
            var t=findViewById(R.id.acc).asInstanceOf[TextView]
            var x = x2(0).toString
            t.setText(x)
        }

        def onAccuracyChanged(a: Int, b: Int) = {
          //TODO
        }
    }

    override def onCreate(savedInstanceState : Bundle) {

    //...            

        mSensorManager.registerListener(mAccListener, SensorManager.SENSOR_DELAY_GAME)

  }
} 
```

但我不明白为什么在 Java 和 Scala 中相同的函数采用不同的值。它既不方便又令人困惑：

```
+-------------------+------------------------------+---------------------------+
| Api Function      | Java                         | Scala                     |
+-------------------+------------------------------+---------------------------+
| onSensorChanged   | SensorEvent event            | x1: Int, x2: Array[Float] |
| onAccuracyChanged | Sensor sensor, int accuracy  | a: Int, b: Int            |
+-------------------+------------------------------+---------------------------+ 
```

有人可以解释一下吗？

# database - 在 Visual Studio 中生成 ERD 图

> ID：11567876
> 
> 赞同：18
> 
> 时间：2012-07-19T19:24:20.383
> 
> 标签：database, visual-studio, entity-relationship, erd, entity-relationship-model

为了为新项目创建 ERD 图，我一直在使用 Visual Studio 的实体框架设计器。本质上，我正在创建一个“虚拟项目”，通过 Nuget 添加实体框架并绘制图表（*我不使用微软的实体框架，因此是虚拟项目*）。

是否有另一种方法可以在 Visual Studio 2010 Ultimate 中本地创建此类图表？

![实体框架设计器](../Images/a0477f77674f07762ac38a37b792394c.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2019-03-22T05:18:22.770

# c++ - linux中的pthread_mutex_t是否是可重入的（如果一个线程试图获取它已经持有的锁，则请求成功）

> ID：11567877
> 
> 赞同：4
> 
> 时间：2012-07-19T19:24:22.890
> 
> 标签：c++, c, linux, multithreading

我来自 Java，所以我熟悉同步而不是互斥锁。我想知道 pthread_mutex_t 是否也是可重入的。如果没有，还有另一种机制吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T19:31:00.453

这取决于互斥体类型，默认情况下不进行检查，并且尝试在同一线程中多次锁定它会导致未定义的行为。[在这里](http://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_mutex_lock.html)阅读。

您可以创建一个类型的互斥锁，`PTHREAD_MUTEX_RECURSIVE`以便能够递归锁定它，这是通过向[pthread_mutex_init](http://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_mutexattr_settype.html) 提供具有所需互斥锁类型的[pthread_mutexattr_t来完成的](http://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_mutex_init.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T19:31:09.787

根据[手册](http://linux.die.net/man/3/pthread_mutex_lock)，您可以将互斥对象声明为 PTHREAD_MUTEX_RECURSIVE：

> 如果互斥锁类型是 PTHREAD_MUTEX_RECURSIVE，则互斥锁应维护锁计数的概念。当线程第一次成功获取互斥锁时，锁计数应设置为 1。每次线程重新锁定此互斥体时，锁定计数应加一。每次线程解锁互斥锁时，锁计数应减一。当锁计数达到零时，互斥锁将可供其他线程获取。如果一个线程试图解锁一个它尚未锁定的互斥锁或一个已解锁的互斥锁，将返回一个错误。

另请参见[pthread_mutex_attr_settype](http://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_mutexattr_settype.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-02T19:02:35.323

默认情况下，`pthread_mutex`不是递归的，但有一种方法可以将其初始化为递归：

```
 pthread_mutexattr_t Attr;
      pthread_mutexattr_init(&Attr);
      pthread_mutexattr_settype(&Attr, PTHREAD_MUTEX_RECURSIVE);
      pthread_mutex_init(&_mutex, &Attr); 
```

# oracle - Oracle 每日计数/一年内的平均值

> ID：11567880
> 
> 赞同：0
> 
> 时间：2012-07-19T19:24:43.017
> 
> 标签：oracle, count, average

我在特定时间段内提取两条信息，但我想获取一个标签的每日平均值和另一个标签的每日计数。我不确定如何在特定时间段内计算每日平均值，有人可以提供一些建议吗？以下是我关于如何处理此问题的第一个想法，但是更改每个日期会很烦人。感谢任何帮助谢谢

```
SELECT COUNT(distinct chargeno), to_char(chargetime, 'mmddyyyy')  AS chargeend 
FROM batch_index WHERE plant=1 AND chargetime>to_date('2012-06-18:00:00:00','yyyy-mm-dd:hh24:mi:ss') 
AND chargetime<to_date('2012-07-19:00:00:00','yyyy-mm-dd:hh24:mi:ss')
group by chargetime; 
```

* * *

```
The working version of the daily sum
SELECT to_char(bi.chargetime, 'mmddyyyy') as chargtime, SUM(cv.val)*0.0005 
FROM Charge_Value cv, batch_index bi WHERE cv.ValueID =97
AND bi.chargetime<=to_date('2012-07-19','yyyy-mm-dd')
AND bi.chargeno = cv.chargeno AND bi.typ=1
group by to_char(bi.chargetime, 'mmddyyyy') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:34:57.180

似乎在第一个你想将组更改为当天 - 而不是时间......（另外我认为你不需要指定所有这些 0 秒......）

```
SELECT COUNT(distinct chargeno), to_char(chargetime, 'mmddyyyy')  AS chargeend 
FROM batch_index WHERE plant=1 AND chargetime>to_date('2012-06-18','yyyy-mm-dd') 
AND chargetime<to_date('2012-07-19','yyyy-mm-dd')
group by to_char(chargetime, 'mmddyyyy') ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T20:00:06.853

不是 100% 我在关注您的问题，但是如果您只想进行汇总（总和，平均），那么就这样做。我扔了汇总，以防万一那是你要找的

```
with  fakeData as(
  select trunc(level *.66667) nr 
      , trunc(2*level * .33478) lvl --these truncs just make the doubles ints
      ,trunc(sysdate+trunc(level*.263784123)) dte --note the trunc, this gets rid of the to_char to drop the time
  from dual
connect by level < 600
) --the cte is just to create fake data
--below is just some aggregates that may help you
select sum(nr) daily_sum_of_nr
     , avg(nr) daily_avg_of_nr
     , count(distinct lvl) distinct_lvls_per_day
     , count(lvl) count_of_nonNull_lvls_per_day
     , dte days
  from fakeData
 group by rollup(dte) 
```

--如果您希望查询提供范围的总数，您可以使用汇总（[http://psoug.org/reference/rollup.html](http://psoug.org/reference/rollup.html)）

# vb.net - 如何在 VB.Net 组合框中水平对齐文本

> ID：11567883
> 
> 赞同：0
> 
> 时间：2012-07-19T19:24:49.523
> 
> 标签：vb.net, combobox

我找不到允许我在 vb.net 组合框中对齐文本的属性。文本框具有 TextAlign 属性，但组合框没有。组合框是否使用了另一个属性？还是有其他方法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T20:05:16.947

如果组合`DropDownStyle`设置为`DropDownList`您可以通过所有者绘制项目来完成。为此，请将其`DrawMode`属性设置为`OwnerDrawFixed`并在`DrawItem`事件中添加如下内容：

```
If e.Index >= 0 Then
    Using st As New StringFormat With {.Alignment = StringAlignment.Far}
        e.Graphics.DrawString(sender.Items(e.Index).ToString, e.Font, Brushes.Black, e.Bounds, st)
    End Using
End If 
```

# javascript - 如何在事件或手动启动 CKeditor 插件？

> ID：11567885
> 
> 赞同：2
> 
> 时间：2012-07-19T19:24:53.583
> 
> 标签：javascript, plugins, event-handling, callback, ckeditor

所以我使用 setData 来预填充 CKeditor 内容区域，其中包含一些要与用户输入一起发送的信息：

```
CKEDITOR.on( 'instanceReady', function( ev ) {

           CKEDITOR.instances.ckeditor99.setData( messageTemplate1, function() {

           this.checkDirty();  // true

           });
}); 
```

在将“mesageTemplate1”中的内容设置为 CKeditor 内容区域之前，我应用了一些 JavaScript 来清理它。在此之后，我再次使用 JS 删除包含我刚刚插入 CKeditor 内容区域的信息的 div。删除后，我想启动一个自定义 CKeditor 插件来处理 CKeditor 中的内容。在删除使用的 div 后启动此插件很重要，因为插件针对 ID 并且如果两个 div 都存在（页面上和 ckeditor 中的某处）插件首先针对不在 CKeditor 内容区域中的那个，因此留下那个在ck区域原封不动。

这是我在上一个[问题](https://stackoverflow.com/questions/11328681/how-to-block-editing-on-certain-part-of-content-in-ckeditor-textarea)中从堆栈成员那里获得的插件（它阻止对某些内容区域的编辑） ：

```
/*
  Plugin that prevents editing of elements with the "non-editable" class as well as elements outside of blocks with "editable" class.
*/

//* **************************  NOTES  ***************************  NOTES  ****************************
/*
  The "lastSelectedElement" variable is used to store the last element selected.

  This plugin uses the "elementspath" plugin which shows all elements in the DOM
  parent tree relative to the current selection in the editing area.

  When the selection changes, "elementsPathUpdate" is fired,
  we key on this and loop through the elements in the tree checking the classes assigned to each element.

  Three outcomes are possible.

  1) The non-editable class is found:
  Looping stops, the current action is cancelled and the cursor is moved to the previous selection.
  The "selectionChange" hook is fired to set the reverted selection throughout the instance.

  2) The editable class is found during looping, the "in_editable_area" flag is set to true.

  3) Neither the editable or the non-editable classes are found (user clicked outside your main container).
  The "in_editable_area" flag remains set to false.

  If the "in_editable_area" flag is false, the current action is cancelled and the cursor is moved to the previous location.
  The "selectionChange" hook is fired to set the reverted selection throughout the instance.

  If the "in_editable_area" flag is true,
  the "lastSelectedElement" is updated to the currently selected element and the plugin returns true.

---------------
  If you don't want the elements path to be displayed at the bottom of the editor window,
  you can hide it with CSS rather than disabling the "elementspath" plugin.

  The elementspath plugin creates and is left active because we are keying on changes to the path in our plugin.
  #cke_path_content
  {
    visibility: hidden !important;
  }

---------------
  CSS Classes and ID that the plugin keys on. Use defaults or update variables to use your preferred classes and ID:

  var starting_element_id = ID of known editable element that always occurs in the instance.
  Don't use elements like <table>, <tr>, <br /> that don't contain HTML text.
  Default value = cwjdsjcs_editable_id

  var editable_class = class of editable containers.
  Should be applied to all top level elements that contain editable elements.
  Default = cwjdsjcs_editable

  var non_editable_class = class of non-editable elements within editable containers
  Apply to elements where all child elements are non-editable.
  Default = cwjdsjcs_not_editable

*/

//* **************************  END NOTES  ***************************  END NOTES  ****************************

// Register the plugin with the editor.
// http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.plugins.html

CKEDITOR.plugins.add( 'cwjdsjcsconfineselection',
{

  requires : [ 'elementspath' ],

  // The plugin initialization logic goes inside this method.
  // http://docs.cksource.com/ckeditor_api/symbols/CKEDITOR.pluginDefinition.html#init
  init: function( editor )
  {
    editor.on( 'instanceReady', function( instance_ready_data )
    {

      // Create variable that will hold the last allowed selection (for use when a non-editable selection is made)
      var lastSelectedElement;
      editor.cwjdsjcs_just_updated = false;

      // This section starts things off right by selecting a known editable element.
      // *** Enter the ID of the element that should have initial focus *** IMPORTANT *** IMPORTANT ***
      var starting_element_id = "cwjdsjcs_editable_id";

      var resInitialRange = new CKEDITOR.dom.range( editor.document );

      resInitialRange.selectNodeContents( editor.document.getById( starting_element_id ) );
      resInitialRange.collapse();

      var selectionObject = new CKEDITOR.dom.selection( editor.document );

      editor.document.focus();
      selectionObject.selectRanges( [ resInitialRange ] );

      var sel = editor.getSelection();
      var firstElement = sel.getStartElement();
      var currentPath = new CKEDITOR.dom.elementPath( firstElement );

      // Set path for known editable element, fire "selectionChange" hook to update selection throughout instance.
      editor._.selectionPreviousPath = currentPath;
      editor.fire( 'selectionChange', { selection : sel, path : currentPath, element : firstElement } );
    }); // *** END - editor.on( 'instanceReady', function( e )

    // When a new element is selected by the user, check if it's ok for them to edit it,
    // if not move cursor back to last know editable selection
    editor.on( 'elementsPathUpdate', function( resPath )
    {
      // When we fire the "selectionChange" hook at the end of this code block, the "elementsPathUpdate" hook fires.
      // No need to check because we just updated the selection, so bypass processing.
      if( editor.cwjdsjcs_just_updated == true )
      {
        editor.cwjdsjcs_just_updated = false;
        return true;
      }

      var elementsList = editor._.elementsPath.list;
      var in_editable_area = false;
      var non_editable_class = "cwjdsjcs_not_editable";
      var editable_class = "cwjdsjcs_editable";

      for(var w=0;w<elementsList.length;w++){
        var currentElement = elementsList[w];

        // Sometimes a non content element is selected, catch them and return selection to editable area.
        if(w == 0)
        {
          // Could change to switch.
          if( currentElement.getName() == "tbody" )
          {
            in_editable_area = false;
            break;
          }

          if( currentElement.getName() == "tr" )
          {
            in_editable_area = false;
            break;
          }
        }

        // If selection is inside a non-editable element, break from loop and reset selection.
        if( currentElement.hasClass(non_editable_class) )
        {
          in_editable_area = false;
          break;
        }

        if( currentElement.hasClass(editable_class) ) {
          in_editable_area = true;
        }
        console.log(currentElement);
        console.log(currentElement.getName());
      }

      // if selection is within an editable element, exit the plugin, otherwise reset selection.
      if( in_editable_area ) {
        lastSelectedElement = elementsList[0];
        return true;
      }

      var resRange = new CKEDITOR.dom.range( editor.document );

      resRange.selectNodeContents( lastSelectedElement );
      resRange.collapse();
      editor.getSelection().selectRanges( [ resRange ] );
      //resRange.endContainer.$.scrollIntoView();

      // Open dialog window:
      // It tells user they selected a non-editable area and cursor has been returned to previous selection
     currentEditorName = editor.name;
      openResDefaultDialog(currentEditorName);

      try
      {
        var sel = editor.getSelection();
        var firstElement = sel.getStartElement();
        var currentPath = new CKEDITOR.dom.elementPath( firstElement );
        editor.cwjdsjcs_just_updated = true;

        editor._.selectionPreviousPath = currentPath;
        editor.fire( 'selectionChange', { selection : sel, path : currentPath, element : firstElement } );

      }
      catch (e)
      {}
    });
  } // *** END - init: function( editor )
}); // ************************************************************************************* END - CKEDITOR.plugins.add 
```

这是设置为 CKeditor 内容区域的 div：

```
<table id="messageTemplate1" class="message cwjdsjcs_editable">
    <tbody>
        <tr>
            <td class="cwjdsjcs_not_editable" contenteditable="false">
            </td>
            <td id="cwjdsjcs_editable_id">

            </td>
        </tr>

        <tr class="cwjdsjcs_not_editable" contenteditable="false">
            <td colspan="2">
                &nbsp;

                <!-- Begin Original Content -->
                <table class="hide" style="font-size: 12px; display:none;">
                    <tbody>
                        <tr class="hide">
                            <td>
                            Application sent by <strong><a href="http://www.globalcastingcenter.com/talent/jack-bolton">Matt Faro</a></strong> for Audition: <a href="http://www.globalcastingcenter.com:80/CustomContentRetrieve.aspx?ID=4185493">Actors Needed</a>
                            </td>
                        </tr>
                        <tr class="hide">
                            <td>
                            Reply to applicant directly: mantas@mantas.co or visit full profile: http://www.globalcastingcenter.com/talent/jack-bolton
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table class="hide" style="font-size: 12px; display:none;">
                    <tbody>
                        <tr class="hide">
                            <td><strong>Short Profile Summary:</strong></td>
                        </tr>
                    </tbody>
                </table>
                <table class="hide" style="font-size: 12px; display:none;">
                    <tbody>
                        <tr class="hide">
                            <td>
                            <a href="http://www.globalcastingcenter.com/talent/jack-bolton"><img alt="" src="http://globalcastingcenter.com/talent_images/4164035_258551_foto.png?Action=thumbnail&amp;Width=144&amp;Height=215" /></a>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table style="font-size: 12px; display:none;" class="hide">
                    <tbody>
                        <tr class="hide">
                            <td><strong>Areas:</strong></td>
                            <td>Actor,Extra</td>
                        </tr>
                        <tr class="hide">
                            <td><strong>Country:</strong></td>
                            <td>WORLDWIDE,Any</td>
                        </tr>
                        <tr class="hide">
                            <td><strong>Age:</strong></td>
                            <td>26</td>
                        </tr>
                    </tbody>
                </table>

            </td>
        </tr>
    </tbody>
</table> 
```

我在这里粘贴了很多东西，但这一切都归结为一个问题，我是否可以以及如何手动启动ckeditor插件，或者在删除事件完成后最好。我也确实问是否有任何更合理的解决方案来解决我的问题。也许插件启动时间并非如此。

谢谢

**编辑：**

在 setData 之后启动 cwjdsjcsconfineselection 的插件脚本：

// JavaScript 文档

```
CKEDITOR.plugins.add('cwjdsjcsconfineselection',
{

    requires : [ 'elementspath' ],

    init: function(editor)
    {

/*        editor.on( 'confineselection', function( confineselection_data )
    {

            alert ("Blocker is on!");

        }); // editor on END

*/      

        editor.on( 'confineselection', function( confineselection_data )
    {
        alert ("Plugin fired!");

      // Create variable that will hold the last allowed selection (for use when a non-editable selection is made)
      var lastSelectedElement;
      editor.cwjdsjcs_just_updated = false;

      // This section starts things off right by selecting a known editable element.
      // *** Enter the ID of the element that should have initial focus *** IMPORTANT *** IMPORTANT ***
      var starting_element_id = "cwjdsjcs_editable_id";

      var resInitialRange = new CKEDITOR.dom.range( editor.document );

      resInitialRange.selectNodeContents( editor.document.getById( starting_element_id ) );
      resInitialRange.collapse();

      var selectionObject = new CKEDITOR.dom.selection( editor.document );

      editor.document.focus();
      selectionObject.selectRanges( [ resInitialRange ] );

      var sel = editor.getSelection();
      var firstElement = sel.getStartElement();
      var currentPath = new CKEDITOR.dom.elementPath( firstElement );

      // Set path for known editable element, fire "selectionChange" hook to update selection throughout instance.
      editor._.selectionPreviousPath = currentPath;
      editor.fire( 'selectionChange', { selection : sel, path : currentPath, element : firstElement } );
    }); // *** END - editor.on( 'instanceReady', function( e )

    // When a new element is selected by the user, check if it's ok for them to edit it,
    // if not move cursor back to last know editable selection
    editor.on( 'elementsPathUpdate', function( resPath )
    {
      // When we fire the "selectionChange" hook at the end of this code block, the "elementsPathUpdate" hook fires.
      // No need to check because we just updated the selection, so bypass processing.
      if( editor.cwjdsjcs_just_updated == true )
      {
        editor.cwjdsjcs_just_updated = false;
        return true;
      }

      var elementsList = editor._.elementsPath.list;
      var in_editable_area = false;
      var non_editable_class = "cwjdsjcs_not_editable";
      var editable_class = "cwjdsjcs_editable";

      for(var w=0;w<elementsList.length;w++){
        var currentElement = elementsList[w];

        // Sometimes a non content element is selected, catch them and return selection to editable area.
        if(w == 0)
        {
          // Could change to switch.
          if( currentElement.getName() == "tbody" )
          {
            in_editable_area = false;
            break;
          }

          if( currentElement.getName() == "tr" )
          {
            in_editable_area = false;
            break;
          }
        }

        // If selection is inside a non-editable element, break from loop and reset selection.
        if( currentElement.hasClass(non_editable_class) )
        {
          in_editable_area = false;
          break;
        }

        if( currentElement.hasClass(editable_class) ) {
          in_editable_area = true;
        }
        console.log(currentElement);
        console.log(currentElement.getName());
      }

      // if selection is within an editable element, exit the plugin, otherwise reset selection.
      if( in_editable_area ) {
        lastSelectedElement = elementsList[0];
        return true;
      }

      var resRange = new CKEDITOR.dom.range( editor.document );

      resRange.selectNodeContents( lastSelectedElement );
      resRange.collapse();
      editor.getSelection().selectRanges( [ resRange ] );
      //resRange.endContainer.$.scrollIntoView();

      // Open dialog window:
      // It tells user they selected a non-editable area and cursor has been returned to previous selection
     currentEditorName = editor.name;
      openResDefaultDialog(currentEditorName);

      try
      {
        var sel = editor.getSelection();
        var firstElement = sel.getStartElement();
        var currentPath = new CKEDITOR.dom.elementPath( firstElement );
        editor.cwjdsjcs_just_updated = true;

        editor._.selectionPreviousPath = currentPath;
        editor.fire( 'selectionChange', { selection : sel, path : currentPath, element : firstElement } );

      }
      catch (e)
      {}
    }); // Blocker source END

        editor.on( 'instanceReady', function( ev )
                {       
                    var messageTemplate1 = $("#messageTemplate1").html();

                    CKEDITOR.instances.ckeditor99.setData( messageTemplate1, function() 

                    {
                        alert ("setData done!");             
                        this.checkDirty();  // true

                    }); 

                    CKEDITOR.instances.ckeditor99.fire( 'confineselection' );

                });

    } // init END

}); // Plugin add END 
```

表格周围出现的转换句柄仍然存在问题。这仅在 Firefox 中发生，这是视频：[http](http://screencast.com/t/lxKJWb6NI) : //screencast.com/t/lxKJWb6NI 有时刷新后此框会消失，有时不会。如果您想现场测试，登录详细信息在我的评论中。

这是我的配置：

```
CKEDITOR.editorConfig = function( config )
{

    config.toolbar = 'MyToolbar';

    config.toolbar_MyToolbar =
    [

        { name: 'clipboard', items : [ 'Undo','Redo' ] },           
        { name: 'styles', items : ['FontSize' ] },
        { name: 'basicstyles', items : [ 'Bold','Italic'] },
        { name: 'paragraph', items : ['Outdent','Indent' ] },

    ];
    config.startupShowBorders = false;
    config.disableObjectResizing = true;

    config.removePlugins = 'contextmenu';
    config.forcePasteAsPlainText = true;   
    config.pasteFromWordRemoveFontStyles = true;
    config.pasteFromWordRemoveStyles = true;
    config.extraPlugins = 'cwjdsjcsconfineselection';

}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T16:11:22.890

删除 div 后尝试触发事件：

```
CKEDITOR.instances.ckeditor99.fire( 'confineselection' ); 
```

* * *

将这行插件代码更改为：

```
 editor.on( 'instanceReady', function( instance_ready_data )
    { 
```

对此：

```
 editor.on( 'confineselection', function( confineselection_data )
    { 
```

您可能希望将在 elementsPathUpdate 上触发的代码块移动到另一个代码块中。所以这：

```
 editor.on( 'confineselection', function( confineselection_data )
    {
      ......................................................
      ......................................................
      // Set path for known editable element, fire "selectionChange" hook to update selection throughout instance.
      editor._.selectionPreviousPath = currentPath;
      editor.fire( 'selectionChange', { selection : sel, path : currentPath, element : firstElement } );
    }); // *** END - editor.on( 'instanceReady', function( e )

    // When a new element is selected by the user, check if it's ok for them to edit it,
    // if not move cursor back to last know editable selection
    editor.on( 'elementsPathUpdate', function( resPath )
    {
      ......................................................
      ......................................................
      catch (e)
      {}
    }); 
```

变成这样：

```
 editor.on( 'confineselection', function( confineselection_data )
    {
      ......................................................
      ......................................................
      // Set path for known editable element, fire "selectionChange" hook to update selection throughout instance.
      editor._.selectionPreviousPath = currentPath;
      editor.fire( 'selectionChange', { selection : sel, path : currentPath, element : firstElement } );

      // When a new element is selected by the user, check if it's ok for them to edit it,
      // if not move cursor back to last know editable selection
      editor.on( 'elementsPathUpdate', function( resPath )
      {
        ......................................................
        ......................................................
        catch (e)
        {}
      });      

    }); // *** END - editor.on( 'instanceReady', function( e ) 
```

# python - 从 subprocess.Popen 同步获取 STDOUT 和 STDERR

> ID：11567892
> 
> 赞同：0
> 
> 时间：2012-07-19T19:25:14.950
> 
> 标签：python, subprocess, popen

我正在寻找一些简单的实用程序来调用本机可执行文件/脚本。我已经相当熟悉使用`subprocess.Popen`打开进程，但我不明白如何在 Python 中有效地同步访问子进程的 STDOUT 和 STDERR。我知道我可以将它传递给一个类似`file`的对象并且它会正常工作，但我该怎么做呢？我不想将它写入实际的文件系统文件，那么我该怎么做呢？我需要`mmap.mmap()`内存文件 API 吗？

我想做这样的事情：

```
class CoolReader():

    def __init__(self, target):
        self.target = target 

    def write(self, output):
        self.target.append({timestamp: time.time(), value: output})

stdoutLines = []
stderrLines = []

stdoutReader = CoolReader(stdoutLines)
stderrReader = CoolReader(stderrLines)

subprocess.Popen("ls", stdout=stdoutReader, stderr=stderrReader) 
```

有没有更好的方法来做到这一点？我基本上希望每次将一行写入 STDOUT 或 STDERR 时都会触发一个侦听器，以将文件行同步写入数组或其他东西。我怎么能/应该这样做？

# mysql - 如何将 SQL 表中的 2 列连接到另一个 SQL 表中的一列？

> ID：11567894
> 
> 赞同：0
> 
> 时间：2012-07-19T19:25:20.850
> 
> 标签：mysql, sql, join

我正在使用 MYSQL。我的数据库中有两个表。

表 1：'courseTable' 有两列：

```
courseId
courseName 
```

表 2：“prereqTable”有两列：

```
courseId
prereqCourseId 
```

表 2 中的两列都对应于表 1 中的 courseId。我正在尝试运行一个查询，该查询将生成一个表，其中包含 courseId 的 courseName 和 prereqCourseId 的 courseName。

我被困在这里：

```
SELECT `course`.courseName, `prereq`.prereqCourseId FROM `course`
LEFT OUTER JOIN `prereq`
ON `course`.courseId = `prereq`.courseId 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:33:23.400

您需要参考 prereqTable 表两次加入课程表

```
SELECT a.courseName,c.courseName
FROM courseTable AS a
LEFT OUTER JOIN prereqTable AS b ON a.courseId=b.courseId
LEFT OUTER JOIN courseTable AS c ON b.prereqCourseId=c.courseId 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:39:09.857

如果你想加入同一个表两次，你必须使用别名。

```
SELECT p.name AS parent, c.name AS child
  FROM relations AS r
  LEFT JOIN nodes AS p
    ON(p.id=r.parent)
  LEFT JOIN nodes AS c
    ON(c.id=r.child ) 
```

这`AS`是可选的，但建议使用，因为它提高了可读性并表明您不只是忘记了逗号。比较：

```
SELECT  a b, c d, e, f, g, h i, ...

SELECT a AS b, c AS d, e, f, g, h AS i, ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:30:59.473

可以将同一个表连接两次，您只需为每个实例中的表分配不同的别名，以便您可以从表的适当实例中选择列。像这样：

```
SELECT
    `course_main`.courseName,
    `course_prereq`.courseName AS `prereqCourseName`

FROM `course` AS `course_main`

LEFT OUTER JOIN `prereq`
ON `course_main`.courseId = `prereq`.courseId

LEFT OUTER JOIN `course` AS `course_prereq`
ON `course_prereq`.courseId = `prereq`.prereqCourseId 
```

# wcf - 内部具有多个异步调用的异步 WCF 服务

> ID：11567895
> 
> 赞同：1
> 
> 时间：2012-07-19T19:25:24.783
> 
> 标签：wcf, asynchronous, task-parallel-library, async-await

我在 WCF 中有一个 Web 服务，它消耗一些外部 Web 服务，所以我想做的是使这个服务异步以释放线程，等待所有外部服务完成，然后将结果返回给客户端.

# 使用框架 4.0

```
public class MyService : IMyService
{
    public IAsyncResult BeginDoWork(int count, AsyncCallback callback, object serviceState)
    {    
        var proxyOne = new Gateway.BackendOperation.BackendOperationOneSoapClient();
        var proxyTwo = new Gateway.BackendOperationTwo.OperationTwoSoapClient();

        var taskOne = Task<int>.Factory.FromAsync(proxyOne.BeginGetNumber, proxyOne.EndGetNumber, 10, serviceState);
        var taskTwo = Task<int>.Factory.FromAsync(proxyTwo.BeginGetNumber, proxyTwo.EndGetNumber, 10, serviceState);

        var tasks = new Queue<Task<int>>();
        tasks.Enqueue(taskOne);
        tasks.Enqueue(taskTwo);

        return Task.Factory.ContinueWhenAll(tasks.ToArray(), innerTasks =>
        {
            var tcs = new TaskCompletionSource<int>(serviceState);
            int sum = 0;

            foreach (var innerTask in innerTasks)
            {
                if (innerTask.IsFaulted)
                {
                    tcs.SetException(innerTask.Exception);
                    callback(tcs.Task);
                    return;
                }

                if (innerTask.IsCompleted)
                {
                    sum = innerTask.Result;
                }
            }

            tcs.SetResult(sum);

            callback(tcs.Task);
        });
    }

    public int EndDoWork(IAsyncResult result)
    {
        try
        {
            return ((Task<int>)result).Result;
        }
        catch (AggregateException ex)
        {
            throw ex.InnerException;
        }

    }
} 
```

我的问题是：

1.  此代码使用三个线程：一个在 BeginDoWork 中实例化，另一个在代码进入匿名方法 ContinueWhenAll 时实例化，最后一个在执行回调时实例化，在本例中为 EndDoWork。这是正确的还是我在通话中做错了什么？我应该使用任何同步上下文吗？注意：主线程上的同步上下文为空。

2.  如果我在线程之间“共享”信息会发生什么，例如回调函数？这会导致性能问题还是匿名方法就像我可以共享数据的闭包？

# 使用 Framework 4.5 和 Async and Await

现在有了 Framework 4.5，代码似乎比以前简单多了：

```
 public async Task<int> DoWorkAsync(int count)
    {
        var proxyOne = new Backend.ServiceOne.ServiceOneClient();
        var proxyTwo = new Backend.ServiceTwo.ServiceTwoClient();

        var doWorkOne = proxyOne.DoWorkAsync(count);
        var doWorkTwo = proxyTwo.DoWorkAsync(count);

        var result = await Task.WhenAll(doWorkOne, doWorkTwo);

        return doWorkOne.Result + doWorkTwo.Result;
    } 
```

但是在这种情况下，当我调试应用程序时，我总是看到代码是在同一个线程上执行的。所以我的问题是：

3.. 当我在等待“awaitable”代码时，该线程是否被释放并返回线程池执行更多请求？

3.1。如果是这样，我想当我从等待任务中获得结果时，执行会在之前调用的同一线程上完成。那可能吗？如果该线程正在处理另一个请求会发生什么？

3.2 如果不是，如何释放线程以将其发送回具有 Asycn 和 Await 模式的线程池？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:52:02.367

> 1\. 此代码使用三个线程：一个在 BeginDoWork 中实例化，另一个在代码进入匿名方法 ContinueWhenAll 时实例化，最后一个在执行回调时实例化，在本例中为 EndDoWork。这是正确的还是我在通话中做错了什么？我应该使用任何同步上下文吗？

最好根据“任务”而不是“线程”来思考。您在这里确实有三个任务，每个任务都将在线程池上运行，一次一个。

> 2\. 如果我在线程之间“共享”信息，例如回调函数，会发生什么？这会导致性能问题还是匿名方法就像我可以共享数据的闭包？

您不必担心同步，因为这些任务中的每一个都不能同时运行。`BeginDoWork`在返回之前注册延续，所以当延续可以运行时它实际上已经完成。`EndDoWork`在继续完成之前可能不会被调用；但即使是，它也会阻塞，直到继续完成。

（从技术上讲，延续*可以*在完成之前开始运行`BeginDoWork`，但`BeginDoWork`只是在那个时候返回，所以没关系）。

> 3\. 当我在等待“awaitable”代码时，该线程是否被释放并返回线程池执行更多请求？

是的。

> 3.1。如果是这样，我想当我从等待任务中获得结果时，执行会在之前调用的同一线程上完成。那可能吗？如果该线程正在处理另一个请求会发生什么？

不会。您的主机（在本例中为 ASP.NET）可以`async`在它碰巧可用的任何线程上继续执行这些方法。

这是非常安全的，因为一次只执行一个*线程*。

PS我推荐

```
var result = await Task.WhenAll(doWorkOne, doWorkTwo);
return result[0] + result[1]; 
```

代替

```
var result = await Task.WhenAll(doWorkOne, doWorkTwo);
return doWorkOne.Result + doWorkTwo.Result; 
```

因为在编程`Task.Result`中应该避免。`async`

# jquery - 如何使用 jquery ui 自动完成清除选择选项？

> ID：11567903
> 
> 赞同：0
> 
> 时间：2012-07-19T19:26:09.460
> 
> 标签：jquery, jquery-ui-autocomplete

我正在使用 jquery-ui-1.8.21 自动完成并让它从数据库中检索数据。现在我有两个问题——我在网上搜索过，但没有人回答我的问题——它正在检索邮政编码列表，但是当从选项中选择一个时，选项/选项/菜单列表仍保留在屏幕上。当通过输入键选择或通过鼠标单击更好时，如何使列表清除/消失？

这是我的jQuery代码：

```
$(document).ready(function() {
            $("#container").hide();
            $("#autocomplete").val("");
            $("#autocomplete").focus();
            $("#autocomplete").autocomplete({
                autoFocus: true,
                source: "search.php",
                minLength: 2, //search after two characters
                //change: function(event, ui) { ... }
                select: function(event, ui) {
                    //do something
                    $("#autocomplete").val(ui.item.autocomplete);
                    $("#container").hide().fadeIn(3000);
                }
            });
        }); 
```

我的下一个问题是 - 我怎样才能限制选择只从前到后匹配？例如，我开始输入 55 并获得所有以 55 开头的邮政编码，但也包括任何 55 的邮政编码，例如 50055，但我只想要那些以 55 开头的邮政编码。

在此先感谢您的帮助！

# delphi - Delphi 记录到资源

> ID：11567906
> 
> 赞同：0
> 
> 时间：2012-07-19T19:26:26.280
> 
> 标签：delphi, delphi-7

> **可能重复：**
> [如何在资源中存储设置](https://stackoverflow.com/questions/3267071/how-to-store-settings-in-resource)

我有一条包含字符串、整数等的记录。该记录用作稍后读取的文件的设置。如何将记录转换为二进制数据（或字符串）并将其保存为 RCDATA 并将其读回记录？如果可能，仅限本机代码和/或 WinAPI。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:13:24.457

关于 RCDATA：

我问谷歌“资源编辑器开源delphi”，它告诉我[http://melander.dk/reseditor/](http://melander.dk/reseditor/)

这个程序肯定可以读写资源。

该页面的页脚还包含指向另外三个同样可以执行此操作的开源 delphi 程序的链接。

所以我希望你能在那里找到你需要的东西。在一堆其他有用的代码中:-)

* * *

但是 - 你想用什么 RCDATA ？？？什么文件？一些DLL？还是您自己的项目 EXE？RCDATA 用于读取，而不是写入。这不是典型的用途。如果加载了 DLL 或 EXE - 您将无权写入文件 new RCDATA。而你自己运行的 EXe 始终是打开的。

* * *

关于转向二进制 - 这非常依赖于您使用的数据类型。在您显示数据之前 - 没有人能够肯定地告诉您。

大多数懒惰的方法是：1）从 TComponent 制作镜像类，并发布属性镜像记录字段。从记录中分配这些属性并执行 TComponent.SaveToStream。2) 使用 Progdigy 的 JsonObject 制作 JSon 格式的文本文件 3) 使用一些 XML 来保存/读取。例如，更高版本的 Delphi 中的 TXMLDocument（但如果使用 nil Owner 创建它有其陷阱）或 Jedi CodeLib 具有 XML。

您可以在 Torry.net 上搜索大量 XML 或 JSON 库。

但最重要的是 - 谷歌“在 Delphi 中序列化”并找到详细说明问题和解决方案的教程。

# curl - 使用 mozilla cacert.pem 文件，报错：无法获取本地颁发者证书

> ID：11567913
> 
> 赞同：1
> 
> 时间：2012-07-19T19:27:01.643
> 
> 标签：curl, openssl, libcurl

我有一个使用 libcurl 的程序，但出现错误：

```
* successfully set certificate verify locations:
*   CAfile: c:\MinGW_New\ssl\misc\demoCA\cacert.pem
  CApath: none
* SSL certificate problem: unable to get local issuer certificate
* Closing connection #0`enter code here` 
```

我试图从[http://curl.haxx.se/ca/cacert.pem](http://curl.haxx.se/ca/cacert.pem)文件附加 mozilla 证书，但我仍然得到同样的错误。

知道我做错了什么吗？

我将 curl 中的 CAINFO 选项设置为我的 mozilla 证书的正确路径。该部分已验证工作。

我需要签署我的 mozilla pem 文件吗？我使用openssl，你是怎么做到的？

# jqgrid - jqGrid：如何在不同页面上使用多选

> ID：11567915
> 
> 赞同：7
> 
> 时间：2012-07-19T19:27:27.980
> 
> 标签：jqgrid, paging, multi-select

简单的问题，很难找到答案：

如果我尝试以编程方式选择一行，我使用这个：

```
$('#grid').jqGrid('setSelection', rowId); 
```

问题是它只选择当前可见页面上的行。如果*rowId*在另一个页面上，则不会被选中。

更多信息：我的目标是在第一次加载页面时选择多行（分布在多个页面上）。

谢谢，拉斐尔

PS：这个人也有同样的问题。还没有答案： [如果启用了分页，jqgrid 多选只会选择当前页面上的行。如何让它跨页面选择行？](https://stackoverflow.com/questions/4710780/jqgrid-multiselect-only-selects-rows-on-the-current-page-if-paging-is-enabled)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T19:51:55.090

对，jqGrid 只会选择当前页面上的行。为了选择其他行，您需要维护所选 ID 的列表并手动选择它们。

为此，您需要向`loadComplete`事件添加代码以搜索当前页面并选择以下任何行：

```
var ids = grid.jqGrid('getDataIDs');
for (var i = 0; i < ids.length; i++){
    if (selected[ids[i]] === true ){
        grid.setSelection(ids[i], false);
    }
} 
```

您还需要向您的`onSelectRow`和`onSelectAll`事件添加代码以调整`selected`用户选择/取消选择行时的内容：

```
onSelectRow: function(rowid, status){
    selected[rowid] = status;
    setSelectedDeviceCount();
},

onSelectAll: function(rowids, status){
    for (var i = 0; i < rowids.length; i++){
        selected[rowids[i]] = status;
    }
} 
```

这有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-23T06:38:42.480

请看这个： [https ://stackoverflow.com/a/24941828/136219](https://stackoverflow.com/a/24941828/136219)

一种实现您正在寻找的东西的方法。

# php - 如何使用 CASE 语句为查询中的匹配项分配值？

> ID：11567918
> 
> 赞同：1
> 
> 时间：2012-07-19T19:27:32.707
> 
> 标签：php, mysql, case, mysql-num-rows

假设您正在运行一个查询，并且您有很多不同的用户输入可能找不到完全匹配的内容。现在是否可以执行以下操作？

```
$query = "SELECT *,
              CASE matchingValues
                  WHEN $field1 LIKE '$a' THEN value = '1' ELSE value = '0'
                  WHEN $field2 LIKE '$b' THEN value = '1' ELSE value = '0'
                  WHEN $field3 LIKE '$c' THEN value = '1' ELSE value = '0'
                  WHEN $field4 LIKE '$d' THEN value = '1' ELSE value = '0'
                  WHEN $field5 LIKE '$e' THEN value = '1' ELSE value = '0'
              END AS score
              FROM . $usertable
              WHERE
                  $field1 LIKE '$a' AND
                  $field2 LIKE '$b' AND
                  $field3 LIKE '$c' AND
                  $field4 LIKE '$d' AND
                  $field5 LIKE '$d'
              ORDER BY score DESC";

if($result = mysql_query($query)) {

    if(mysql_num-rows($result)==NULL) {
    echo 'No Results Found';

    }else{

    .... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T20:03:51.483

是的，这是可能的，尽管您会在没有`WHERE`子句的情况下这样做，并且您希望将所有输​​入相加而不是使用 a`CASE`来获得总分。由于每个`LIKE`语句都返回布尔值 1 或 0，因此您只需将它们相加即可找出您有多少匹配项。如果`HAVING`您只想返回实际匹配的行，则子句会限制返回得分 > 0 的行。

```
 SELECT *,
      (($field1 LIKE '$a') +
      ($field2 LIKE '$b') +
      ($field3 LIKE '$c') +
      ($field4 LIKE '$d') +
      ($field5 LIKE '$e')) AS score
  FROM . $usertable
  HAVING score > 0
  ORDER BY score DESC"; 
```

我们假设您已经将`%`通配符添加到`LIKE`变量中，并且在您的查询中使用它们之前已正确转义。

然而，虽然您可以这样做（穷人的全文搜索），但 MySQL 提供了[跨 MyISAM 表的多个列创建全文索引](http://dev.mysql.com/doc/refman/5.0/en/fulltext-boolean.html)的可能性。

### 更新：要人为地给它们加权...

如果您需要对它们进行加权，请使用`CASE`语句并为前几项添加更高的数字：

```
 SELECT *,
      (CASE WHEN ($field1 LIKE '$a') THEN 5 ELSE 0 END +
      CASE WHEN ($field2 LIKE '$b') THEN 4 ELSE 0 END +
      CASE WHEN ($field3 LIKE '$c') THEN 3 ELSE 0 END +
      CASE WHEN ($field4 LIKE '$d') THEN 2 ELSE 0 END +
      CASE WHEN ($field5 LIKE '$e') THEN 1 ELSE 0 END) AS score
  FROM . $usertable
  HAVING score > 0
  ORDER BY score DESC"; 
```

要强制执行第一个匹配，请将其放在您的`WHERE`子句中。

```
 SELECT *,
      (($field1 LIKE '$a') +
      ($field2 LIKE '$b') +
      ($field3 LIKE '$c') +
      ($field4 LIKE '$d') +
      ($field5 LIKE '$e')) AS score
  FROM . $usertable
  WHERE $field1 LIKE '$a'
  HAVING score > 0
  ORDER BY score DESC"; 
```

`MATCH`同样，要明确一点 - MySQL 的全文索引和关键字中已经内置并优化了一个非常密切相关的功能。

# powershell - 捕获工作流中的错误

> ID：11567920
> 
> 赞同：3
> 
> 时间：2012-07-19T19:27:40.400
> 
> 标签：powershell, workflow-foundation, powershell-3.0

我一直在玩 PS 3.0 RC 中的 PowerShell 工作流，到目前为止，我很喜欢。但是，您可以在工作流程中使用和不能使用的东西有很多限制。我目前挂断的一个是 $Error 变量。调用我的工作流程时，我收到以下错误：

```
The variable 'Error' cannot be used in a script workflow. 
```

有谁知道如何在工作流程中捕获错误文本，或者如果您不熟悉工作流程，有关于错误捕获替代方法的建议吗？我一直在四处寻找，几乎找不到有关工作流程细节的信息。谢谢！

我正在尝试做这样的事情：

```
workflow Get-LoggedOnUser{
    param([array]$computers,[System.Management.Automation.PSCredential]$credential)

    foreach -parallel($computer in $computers) {
        $response = $null
        $errorMessage = $null
        If (Test-Connection -ComputerName $computer -count 1 -quiet) {
            Try {
                $ErrorActionPreference = "Stop"
                $response = Get-WMIObject -PSCredential $credential -PSComputername $computer -query "Select UserName from Win32_ComputerSystem"
                $Error
            }
            Catch {
                $errorMessage = $Error[0].exception
            }
            Finally {
                $errorActionPreference = "Continue"
            }
        }
        Else {
            $errorMessage = "No response"
        }   
        $output = [PSCustomObject]@{
            Name = $computer
            User = $response.UserName
            Error = $errorMessage
        }
        $output
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-20T16:06:10.913

我最终通过将工作流的大部分逻辑封装在一个 InlineScript 块中来解决这个问题。这样，工作流的每个循环仍然并行运行（这是我想要的），但我可以在工作流中自由使用普通的 PowerShell cmdlet、参数和变量（包括 $Error）：

```
workflow Get-LoggedOn {
param(
    [array]$computers,
    [System.Management.Automation.PSCredential]$Credential
    )
    ForEach -parallel ($computer in $computers) {
    InlineScript {
        Try {
            $ErrorActionPreference = "Stop"
            $response = Get-WMIObject -computername $using:computer -credential $using:Credential -query "select UserName from Win32_ComputerSystem"
        }
        Catch {
            $errorMessage = $Error[0].Exception
        }
        Finally {
            $ErrorActionPreference = "Continue"
        }
        $output = [PSCustomObject]@{
            Name = $using:computer
            User = $response.UserName
            Error = $errorMessage
        }
        $output
    }
} 
```

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T07:02:33.197

您可以尝试像在 V2 中那样做（未在 V3 中测试，但我认为它有效）

```
Catch {
                $errorMessage = $_            }
} 
```

在catch 返回`Get-Member`：`$_`

```
 TypeName: System.Management.Automation.ErrorRecord

Name                  MemberType     Definition
----                  ----------     ----------
Equals                Method         bool Equals(System.Object obj)
GetHashCode           Method         int GetHashCode()
GetObjectData         Method         System.Void GetObjectData(System.Runtime.Serialization.SerializationInfo info, 
                                     System.Runtime.Serialization.StreamingContext context)
GetType               Method         type GetType()                                        
ToString              Method         string ToString()                                     
CategoryInfo          Property       System.Management.Automation.ErrorCategoryInfo CategoryInfo {get;}
ErrorDetails          Property       System.Management.Automation.ErrorDetails ErrorDetails {get;set;} 
Exception             Property       System.Exception Exception {get;}                                 
FullyQualifiedErrorId Property       System.String FullyQualifiedErrorId {get;}                        
InvocationInfo        Property       System.Management.Automation.InvocationInfo InvocationInfo {get;} 
PipelineIterationInfo Property       System.Collections.ObjectModel.ReadOnlyCollection`1[[System.Int32, mscorlib, 
                                     Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]] 
                                     PipelineIterationInfo {get;}
TargetObject          Property       System.Object TargetObject {get;}                             
PSMessageDetails      ScriptProperty System.Object PSMessageDetails {get=& { Set-StrictMode -Version 1; 
                                     $this.Exception.InnerException.PSMessageDetails };} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-27T13:16:13.710

在 Powershell 工作流中，您无法使用 $error 变量。至少根据我的经验，您必须使用以下方法：

```
Try {
     Throw "This is an error exception."
}
Catch {
     $errorMessage = $_
}

$errorMessage 
```

# c# - c# create 7z archive, then Can not open file "name.7z" as an archive

> ID：11567923
> 
> 赞同：0
> 
> 时间：2012-07-19T19:27:48.163
> 
> 标签：c#, archive, 7zip

我正在尝试压缩一些文件夹。它们有不同的路径，不会属于同一个目录。

我测试了我要给出的命令行参数，它可以工作，但我无法从 c# 中让它工作：

```
string destination = "some path\\name.7z";
string pathToZip = "path to zip\\7z.exe";  // or 7za.exe
ProcessStartInfo p = new ProcessStartInfo();
p.FileName = pathToZip;
p.Arguments = "a \"" + destination + "\" \"";
// room for the foreach - but even one directory doesn't work right now
   p.Arguments += directoryPath + "\" \"";
p.Arguments += "\" -mx=9 -aoa";
Process x = Process.Start(p); 
```

使用 7z.exe 我会眨眼；使用 7za.exe，我获得了典型的命令行 zip 序列，文件通过压缩，添加到存档，然后创建存档。

然后我去它并右键单击，打开或双击......我知道它是一个无效的存档（`Can not open file "name.7z" as an archive`）。尝试使用 7za 的命令行来提取 - 同样的事情。

编辑：我找到了解决方案：

我的问题是**-aoa**选项（我用于覆盖） - 删除它后，它起作用了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:40:58.023

这段代码对我有用，包含一个包含文件的目录：

```
string destination = @"c:\my test.7z";
string pathToZip = @"C:\Program Files\7-Zip\7z.exe";
string directoryPath = @"c:\my test";

ProcessStartInfo p = new ProcessStartInfo();
p.FileName = pathToZip;
p.Arguments = string.Format("a -mx=9 \"{0}\" \"{1}\"", destination, directoryPath);

Process x = Process.Start(p); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:32:47.030

`7za.exe`是命令行程序，你应该在这种情况下使用它。

为什么要添加`""`到命令行？这可能会导致您的问题。

另外，确保你把你`"`的东西放在周围，最后不要用两个垫子，这只会导致问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:43:23.720

如果命令行工作，也许只是使用不同的启动功能；带exe路径的那个，第二个参数中的命令行参数。

[看这里](http://msdn.microsoft.com/en-us/library/h6ak8zt5.aspx)。

如果命令行有效，这可能是最好的方法。

# c# - 如何修复“对象引用未设置为对象的实例”？

> ID：11567927
> 
> 赞同：1
> 
> 时间：2012-07-19T19:28:26.603
> 
> 标签：c#, asp.net-mvc, dependency-injection, ninject, asp.net-mvc-4

我在 Visual Studio 2012 RC 中创建了一个 mvc4 项目，并使用 nuget 添加了 ninject.mvc3 包。它创建了标准的 NinjectWebCommon.cs 文件，我编辑了 RegisterServices 方法，如下所示：

```
private static void RegisterServices(IKernel kernel)
        {
            kernel.Bind<IProfileRepository>().To<ProfileRepository>().InSingletonScope(); 
        } 
```

这是我的界面和配置文件存储库类：

```
public interface IProfileRepository
    {
        void CreateProfile(UserProfile profile);
    }

public class ProfileRepository : IProfileRepository
    {
        private EFDbContext context = new EFDbContext();

        public void CreateProfile(UserProfile userProfile)
        {
            context.UserProfiles.Add(userProfile);
            context.SaveChanges();
        }

    } 
```

我想在我的帐户控制器中访问我的 IProfileRepository，如下所示：

```
 private readonly IProfileRepository profileRepository;

        public AccountController(IProfileRepository repo){
            profileRepository = repo;
        }
        [AllowAnonymous]
        [HttpPost]
        public ActionResult Register(RegisterModel model)
        {
            if (ModelState.IsValid)
            {
                // Attempt to register the user
                MembershipCreateStatus createStatus;
                Membership.CreateUser(model.UserName, model.Password, model.Email, passwordQuestion: null, passwordAnswer: null, isApproved: true, providerUserKey: null, status: out createStatus);

                if (createStatus == MembershipCreateStatus.Success)
                {
                    profileRepository.CreateProfile(new UserProfile
                    {
                        UserId = (Guid)Membership.GetUser(HttpContext.User.Identity.Name).ProviderUserKey,
                        FirstName = model.FirstName,
                        LastName = model.LastName,
                        School = model.School,
                        Major = model.Major
                    });
                    FormsAuthentication.SetAuthCookie(model.UserName, createPersistentCookie: false);
                    return RedirectToAction("Index", "Home");
                }
                else
                {
                    ModelState.AddModelError("", ErrorCodeToString(createStatus));
                }
            }

            // If we got this far, something failed, redisplay form
            return View(model);
        } 
```

调用我的对象时出现错误，因此它可能没有被注入`Object reference not set to an instance of an object`。`profileRepostory`有谁知道出了什么问题？谢谢！

编辑：这是我的 global.asax 文件：

```
public class MvcApplication : System.Web.HttpApplication
    {
        protected void Application_Start()
        {
            AreaRegistration.RegisterAllAreas();

            FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
            RouteConfig.RegisterRoutes(RouteTable.Routes);
            BundleConfig.RegisterBundles(BundleTable.Bundles);
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T20:54:00.320

除非您更改了配置，否则 Ninject 将抛出一个`ActivationException`而不是注入`null`一个依赖项。你应该检查哪个对象是真的`null`。

例如，允许匿名访问是一个巨大的提示，`HttpContext.User`它是空的。

# javascript - 需要根据条件运行一个函数

> ID：11567929
> 
> 赞同：0
> 
> 时间：2012-07-19T19:28:29.100
> 
> 标签：javascript, readonly

我正在尝试为几个复选框分配一个功能，但我只想根据条件添加它们，在这种情况下是表单的步骤号。这是使复选框在被选中（或未被选中）后只读的一种迂回方式。因此，在第 1 步，我希望用户选择 cb1 或 cb2，但在第 2 步，我想分配不会更改复选框值的函数。

我究竟做错了什么？

```
function functionOne() {
    this.checked = !this.checked
};
if (document.getElementById("stepNumber").value == 2) {
    document.getElementById("cb1").setAttribute("onkeydown", "functionOne(this)");
    document.getElementById("cb2").setAttribute("onkeydown", "functionOne(this)");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:07:42.667

为什么不在选择上禁用复选框？

```
Function onCheck(elm)
{
    document.getElementById("cbValue").value = elm.value;
    elm.disabled = true;
}

<input id="cbValue" type="hidden" /> 
```

使用隐藏的输入字段允许表单将数据发送回服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T20:10:31.917

这是一个需要 jquery 的解决方案，但您可以使用 .click 功能在单击复选框后禁用复选框。

这是一个工作示例：

[http://jsfiddle.net/uPsm7/](http://jsfiddle.net/uPsm7/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:33:58.040

您在参数中传递元素，所以使用它：

```
function functionOne(elem) {
    elem.checked = !elem.checked
}; 
```

* * *

您还可以使用属性：

```
document.getElementById("cb1").onkeydown = functionOne;
document.getElementById("cb2").onkeydown = functionOne;

function functionOne() {
    this.checked = !this.checked
}; 
```

# python - 导入 pynotify 时出现 GTK 错误

> ID：11567930
> 
> 赞同：2
> 
> 时间：2012-07-19T19:28:31.927
> 
> 标签：python, gtk

导入 pynotify 时，我总是收到那些讨厌的 GTK 警告：

```
** (process:25512): WARNING **: Trying to register gtype 'GMountMountFlags' as enum when in fact it is of type 'GFlags'
** (process:25512): WARNING **: Trying to register gtype 'GDriveStartFlags' as enum when in fact it is of type 'GFlags'
** (process:25512): WARNING **: Trying to register gtype 'GSocketMsgFlags' as enum when in fact it is of type 'GFlags' 
```

问题是，我不知道如何压制它们，我试过：

```
>>> import sys
>>> from io import BytesIO
>>> sys.stderr = BytesIO()
>>> sys.stdout = BytesIO()
>>> print 's'
>>> import pynotify

** (process:25512): WARNING **: Trying to register gtype 'GMountMountFlags' as enum when in fact it is of type 'GFlags'

** (process:25512): WARNING **: Trying to register gtype 'GDriveStartFlags' as enum when in fact it is of type 'GFlags'

** (process:25512): WARNING **: Trying to register gtype 'GSocketMsgFlags' as enum when in fact it is of type 'GFlags' 
```

不起作用，我尝试了另一件事：

```
with warnings.catch_warnings():
    warnings.simplefilter('error')
    import pynotify 
```

这也无济于事。

似乎 GTK 消息到达不同的`stderr`. 任何想法如何抑制它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T15:02:23.173

要抑制这些消息，您需要通过其文件描述符重定向 stderr：

```
import os
from contextlib import contextmanager

@contextmanager
def suppress_output(fd):
    """
    Suppress output to the given ``fd``::

       with suppress_fd(sys.stderr):
           # in this block any output to standard error is suppressed

    ``fd`` is an integral file descriptor, or any object with a ``fileno()``
    method.
    """
    if hasattr(fd, 'fileno'):
        # we were given a file-like object with an underlying fd
        if hasattr(fd, 'flush'):
            # flush Python-side buffers before redirecting
            fd.flush()
        # get the fd to redirect
        fd = fd.fileno()

    # duplicate the file descriptor to restore it eventually
    oldfd = os.dup(fd)
    try:
        # open the trash can
        devnull = os.open(os.devnull, os.O_WRONLY)
        try:
            # point the file descriptor to the trash can
            os.dup2(devnull, fd)
        finally:
            # close the old trash can descriptor, we don't need it anymore
            # since the fd now points to the trash can
            os.close(devnull)
        # enter the callers block
        yield
        # restore the file descriptor
        os.dup2(oldfd, fd)
    finally:
        # close the duplicated copy of the original fd, we don't need it
        # anymore now that fd is restored
        os.close(oldfd) 
```

这个函数的使用很简单：

```
import sys

with suppress_output(sys.stderr):
    import pynotify 
```

# c# - 如何将无界复选框列添加到绑定到数据源的网格视图？

> ID：11567933
> 
> 赞同：0
> 
> 时间：2012-07-19T19:28:38.120
> 
> 标签：c#, asp.net

我拥有的 gridview 以 SQLDataSource 为界。我想为填充的每一行添加一个复选框。我该如何做到这一点，以及在选中/取消选中时如何让复选框回发？

这是我的网格视图代码：

```
<asp:GridView ID="GridView2" runat="server" CellPadding="3"
        ForeColor="#333333" GridLines="None" DataSourceID="dsWarningDay" 
        AllowSorting="True" SortedAscendingHeaderStyle-CssClass="sortasc-header" 
        SortedDescendingHeaderStyle-CssClass="sortdesc-header"
        AllowPaging="True" PageSize="17" PagerSettings-Mode="NextPreviousFirstLast" 
        ShowHeaderWhenEmpty="True" PagerStyle-Font-Names="WebDings" PagerStyle-Font-Size="Medium"
        PagerSettings-FirstPageText=" 7 " PagerSettings-PreviousPageText=" 3 " 
        PagerSettings-NextPageText=" 4 " PagerSettings-LastPageText=" 8 " 
          Font-Size="Small">
        <AlternatingRowStyle BackColor="White" ForeColor="#333333" />
        <EditRowStyle BackColor="#999999" />
        <FooterStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
        <HeaderStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />

<PagerSettings FirstPageText=" 7 " LastPageText=" 8 " Mode="NextPreviousFirstLast" NextPageText=" 4 " PreviousPageText=" 3 "></PagerSettings>

        <PagerStyle BackColor="#5D7B9D" ForeColor="White" HorizontalAlign="Center" />
        <RowStyle BackColor="#DCE2E8" ForeColor="#333333" />
        <SelectedRowStyle BackColor="#E2DED6" Font-Bold="True" ForeColor="#333333" />

<SortedAscendingHeaderStyle CssClass="sortasc-header"></SortedAscendingHeaderStyle>

<SortedDescendingHeaderStyle CssClass="sortdesc-header"></SortedDescendingHeaderStyle>
     </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:34:18.447

在你的gridview中放一个这样的templateField

```
<asp:TemplateField>
    <ItemTemplate>
        <asp:CheckBox ID="CheckBox1" runat="server" />
    </ItemTemplate>
</asp:TemplateField> 
```

# jquery - 用于远程响应的 PHP 和 Ajax 侦听器

> ID：11567935
> 
> 赞同：0
> 
> 时间：2012-07-19T19:28:47.773
> 
> 标签：jquery, ajax, listener

我需要有关如何实现这一目标的指导：

用户来到 www.mysite.com/submit.php 并填写他们需要输入电话号码的表格（用于验证目的），我希望在提交表格时发生：

1.  弹出窗口 - 或一些会告诉他们的叠加层......请等待呼叫（并将阻止他们点击背景中的链接）
2.  在后台请求被发送到远程服务器，该服务器将进行呼叫并要求他们在接听电话后输入密码。
3.  我将从服务器以 GET 格式收到响应，例如：www.mysite.com/submit.php?pincheck=success
4.  现在基于 ?pincheck （成功或失败）我想将它们重定向到相应的页面（success.php 或 failed.php）

任何想法如何做到这一点以及使用什么？阿贾克斯.. jQuery ???

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:41:10.683

1- 带有模式的覆盖将完成第 1 部分，但他们总是可以使用 URL 离开您的网站。

2-取决于表单是否提交。您可以获取数据，对其进行 JSON 化，然后进行 ajax 请求，这将做同样的事情，而无需整个跳跃。

3-这将通过等待用户输入内容来完成。您可以使用 asp.net 让表单在输入时对服务器执行 ping 操作并进行回发，但我会做的是当您从 2 执行 AJAX 请求时，返回与用户相关的唯一 ID（数据库中的主键） . 当用户输入密码短语时，它将提交带有 pinn 和隐藏字段用户数据的第二个表单。（提示：您需要在 db 表上设置一个时间戳，这样它在调用时间内只能使用 15 分钟。

4-如果您使用的是 AJAX，我假设您是第 3 部分，您可以获取响应文本并检查“1”或“0”。如果为 1，则重定向到成功，否则重定向到开头。

我不知道你是否想要代码示例，但只是看看这个，使用 ajax ......它将是 1 个页面客户端，具有 2 个不同的服务器页面。如果您使用 ASP.NET，则只需 1 页即可完成。

其他需要注意的事项：我不知道服务器将如何进行调用，因此您可能需要调查一下。我知道您可以从网络服务器发送文本等，但我不确定自动电话。

自然，这将需要一个数据库、一个服务器脚本或 2 个和 1 个前端。很直接。另外，作为提示，对于页面上的模式，您应该确保有一些东西让他们知道服务器将调用它们，gif 或图像足够简单，底部有输入标签和一个提交锚标记。

编辑：除了电话，我想说，如果你很快的话，这大约是 2 个小时的编程。4如果soso，6如果你不知道你在做什么。:)

# jquery - 尝试测试 Vimeo 和 YouTube 播放时在本地计算机上加载时，fancyBox 2 官方 DEMO 抛出错误

> ID：11567941
> 
> 赞同：0
> 
> 时间：2012-07-19T19:29:11.707
> 
> 标签：jquery, html, video, fancybox

我正在编写纯 HTML 和 CSS，并从本地硬盘驱动器直接在浏览器中加载文件。

FancyBox 2 正在加载灯箱效果，所以我知道脚本正在运行，但在尝试播放视频时收到以下错误消息：

```
"This webpage is not found
No webpage was found for the web address: file://player.vimeo.com/video/25634903?hd=1&autoplay=1&show_title=1&show_byline=1&show_portrait=0&color=&fullscreen=1
Error 6 (net::ERR_FILE_NOT_FOUND): The file or directory could not be found." 
```

`file://`请注意，即使我指定的 HREF URL是，脚本仍试图从中加载视频`HTTP://vimeo/25634903`

然后我在本地浏览器中加载了演示文件，尝试播放 youtube 和 vimeo 视频示例，我收到了同样的错误。该演示确实可以正确加载图像，但不能正确加载视频。

我可以在 fancBox js 文件中进行一些调整以允许我在本地使用它吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:42:46.710

If you simply open a html file in the browser it load the file with `file://` scheme. Most good scripts are designed to use protocol relative URLs, by giving urls as `//<url>`. For eg, if the page is loaded as `https` scheme, it automatically loads `https://<url>`.

That is one of the reasons why it is always a good idea to test java script/html on a real web server instead of opening the file directly.

Also, some browsers with no-script or similar plugins disable certain js functionality for scripts loaded as `file://`

# c# - 如何将多线程与顺序需求混合？

> ID：11567945
> 
> 赞同：-1
> 
> 时间：2012-07-19T19:29:25.923
> 
> 标签：c#, multithreading

我有一个程序可以处理来自经纪人的价格数据。伪代码如下：

```
 Process[] process = new Process[50];

 void tickEvent(object sender, EventArgs e)
 {
    int contractNumber = e.contractNumber;

    doPriceProcess(process[contractNumber], e);
 } 
```

现在我想使用多线程来加速我的程序，如果数据是不同的合同号，我想触发不同的线程来加速这个过程。但是，如果数据来自同一个合同，我希望程序等到当前进程完成，然后再继续下一个数据。我该怎么做？

你能提供一些代码吗？

先谢谢了~

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:56:30.133

您需要在这里做出许多高级别的架构决策：

您预计该经纪人会产生多少滴答声？

毕竟，你应该在这里有一些好心的调度员。

以下是对基本上要做的事情的一些简单描述：

*   将传入的刻度封装在包中，最好的单个命令具有所需的所有数据

*   有一个队列，您可以轻松（并且线程安全）存储这些命令

*   有一个调度程序，它接收队列中的一个项目并分配一些工作人员来执行命令（或让命令自行执行）

*   拥有一个工人，您可以拥有多个线程、进程或任何东西来无缝地处理多个命令

*   也许您想对输入队列进行一些调度，具体取决于您希望每个时间单位能够完成多少请求。

以下是一些可能有用的更多信息：

[C#中的命令模式](http://www.dofactory.com/Patterns/PatternCommand.aspx)

[反应堆模式（附示例代码）](http://en.wikipedia.org/wiki/Reactor_pattern)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:37:07.520

`Process`我不会持有一个 es数组，而是持有一个`BlockingCollection`s 数组。每个阻塞集合可以对应一个特定的合约。然后，您可以让生产者线程将工作添加到相应合约队列的末尾，并且您可以让生产者队列使用这些集合的结果。您可以确保每个线程（我会为此使用线程，而不是进程）处理 1-n 个不同的队列，但每个队列不超过一个线程处理。这样，您可以确保不会并行处理同一合同中的任何工作。

`Task`可以使用 C# 的类有效地处理此线程方面的问题。对于您的消费者，您可以为每个`BlockingCollection`. 该任务的主体几乎就是：

```
foreach(SomeType item in blockingCollections[contractNumber].GetConsumingEnumerable())
  processItem(item); 
```

但是，通过使用`Task`s，您可以让计算机按照它认为合适的方式安排它们。如果它注意到他们中的大多数人坐在空队列上等待，它将只有几个（或只有一个）实际线程在它正在使用的任务之间旋转。如果他们试图做的足够多，并且您的计算机可以清楚地支持额外线程的负载，它将添加更多（可能会随着它的进行动态添加/删除）。通过让比你或我更聪明的人来处理调度，它更有可能在没有不足或过度并行化的情况下变得高效。

# php - 使用php进行dom解析不区分大小写

> ID：11567951
> 
> 赞同：0
> 
> 时间：2012-07-19T19:29:54.407
> 
> 标签：php, html-parsing, domxpath

我在 php 中使用 domxpath 解析 html，并从网页中提取描述。但是我面临的问题是它区分大小写并且如果以不同的大小写写任何东西都会出错。这是我的代码：

```
$d=new DOMDocument();
$d->loadHTML($source);
$domx = new DOMXPath($d);
$description=$domx->query("//meta[@name='description']")->item(0)->getAttribute('content'); 
```

当一切都是小写时，它工作正常，但如果任何其他情况下写的都会出错。是否有任何标志或东西可以使 domxpath 不区分大小写。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:32:39.337

这可能是作弊，但这有帮助吗？

```
$d=new DOMDocument();
$d->loadHTML(mb_strtolower($source)); 
```

这将使所有内容也变成小写...

# sql - Oracle - 更新排序表

> ID：11567955
> 
> 赞同：0
> 
> 时间：2012-07-19T19:30:13.767
> 
> 标签：sql, oracle

我发现一个没有主键的旧表，为了添加一个，我必须添加一个新列并用序列值填充它。我有另一列包含创建记录的时间，所以我想将序列值插入到按时间列排序的表中。

我不知道该怎么做。我尝试使用 PL\SQL - 我为查询创建了一个游标，该游标返回带有 ORDER BY 的表，然后更新游标返回的每条记录，但它不起作用。

有没有一种聪明的工作方式来做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:53:36.550

另一种选择是只使用相关子查询，使用嵌套子查询的皱纹来生成行号。设置一些示例数据：

```
create table t42 (datefield date);
insert into t42 (datefield) values (sysdate - 7);
insert into t42 (datefield) values (sysdate + 6);
insert into t42 (datefield) values (sysdate - 5);
insert into t42 (datefield) values (sysdate + 4);
insert into t42 (datefield) values (sysdate - 3);
insert into t42 (datefield) values (sysdate + 2);

select * from t42;

DATEFIELD
---------
12-JUL-12
25-JUL-12
14-JUL-12
23-JUL-12
16-JUL-12
21-JUL-12 
```

然后添加并填充新列：

```
alter table t42 add (id number);

update t42 t1 set t1.id = (
    select rn from (
        select rowid, row_number() over (order by datefield) as rn
        from t42
    ) t2
    where t2.rowid = t1.rowid
);

select * from t42 order by id;

DATEFIELD         ID
--------- ----------
12-JUL-12          1
14-JUL-12          2
16-JUL-12          3
21-JUL-12          4
23-JUL-12          5
25-JUL-12          6 
```

由于这是一个合成键，使其与另一列的顺序相匹配似乎有点毫无意义，但我想不会造成任何伤害。

* * *

完成任务：

```
alter table t42 modify id not null;

alter table t42 add constraint t42_pk primary key (id); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T19:36:22.500

*   首先，创建新字段并允许空值。

*   然后，从其他表或查询中更新字段。最好的方法是使用[合并](http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_9016.htm)语句。

这是文档中的示例：

```
MERGE INTO bonuses D
   USING (SELECT employee_id, salary, department_id FROM employees
   WHERE department_id = 80) S
   ON (D.employee_id = S.employee_id)
   WHEN MATCHED THEN UPDATE SET D.bonus = D.bonus + S.salary*.01
     DELETE WHERE (S.salary > 8000)
   WHEN NOT MATCHED THEN INSERT (D.employee_id, D.bonus)
     VALUES (S.employee_id, S.salary*.01)
     WHERE (S.salary <= 8000); 
```

*   最后，[将此新字段设置为非 null](http://dba-oracle.com/t_alter_table_modify_column_syntax_example.htm)并将其提升为主键。

这里的例句：

```
ALTER TABLE 
   customer 
MODIFY 
   ( 
   your_new_field varchar2(100) not null
   )
;
ALTER TABLE 
   customer 
ADD CONSTRAINT customer_pk PRIMARY KEY (your_new_field)
; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T20:16:07.583

一种简单的方法是创建一个新表，其中包含所有其他列的新列：

```
create table newt (
    newtID int primary key not null,
    . . .
) 
```

然后将所有旧数据插入其中：

```
insert into newt
    select row_number() over (order by <CreatedAt>), t.*
    from t 
```

（您可以替换所有列，而不是使用“*”。按名称列是更好的做法。这更短，另外，我不知道列名。）

如果您更改表格以添加列，则该列将出现在末尾。我发现主键很尴尬。但是，如果您这样做，您可以将其更新为：

```
with t as (select row_number() over (order by <CreatedAt>) as seqnum, t.*
           from t
          )
update t
    set newtID = seqnum 
```

# c# - 使用 Javascript 解码 SecurityElement.Escape 的正确方法

> ID：11567958
> 
> 赞同：0
> 
> 时间：2012-07-19T19:30:28.257
> 
> 标签：c#, javascript, asp.net

我尝试了几种方法来使用 javascript 解码编码的 xml。由于某种原因，他们都忽略了 ' 这导致它失败。我可以做一个 string.replace 来解决这个问题，但想知道为什么会发生这种情况，或者我是否应该使用其他一些方法。

我尝试了 decodeURIComponent 以及我在 SO 上找到的另一种方法，它将内容放在一个 div 中，然后将其拉回。两者都忽略了'。我还尝试了 unescape，但奇怪的是什么也没做。这是我正在解码的 xml 块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T12:10:43.097

这是我能找到的唯一方法，因为没有人回应：

函数 HtmlDecode(input) { var e = document.createElement('div'); e.innerHTML = 输入；返回 e.childNodes.length === 0 ？"" : e.childNodes[0].nodeValue.replace(/'/g, "'");
}

# c# - 在 ASP.NET 应用程序中获取当前用户名

> ID：11567965
> 
> 赞同：8
> 
> 时间：2012-07-19T19:31:19.443
> 
> 标签：c#, asp.net

我正在运行一个需要能够读取当前用户的登录 ID 的网页。这是我正在使用的代码：

```
string id = System.Security.Principal.WindowsIdentity.GetCurrent().Name; 
```

目前这会返回正确的登录名，但是当我在此方法中使用它时：

```
protected Boolean isPageOwner()
{
    string id = System.Security.Principal.WindowsIdentity.GetCurrent().Name;
    alert("User: " + id);
    if (id.Equals(pageOwnerID))
    {
        return true;
    }
    if (accessPermission.ContainsKey(id))
    {
        return true;
    }
    return false;
} 
```

即使返回的 id 与 pageOwnerID 相同，该方法也会返回 false。我真的不确定我的哪一部分有问题。

附带说明一下，我的登录 ID 的格式为 string1/string2，但代码将其检索为 string1 + string2 而不带斜杠。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T20:28:41.083

尝试使用它来检索用户名....

```
if (System.Web.HttpContext.Current.User.Identity.IsAuthenticated)
{
   string username = System.Web.HttpContext.Current.User.Identity.Name;
} 
```

听起来好像没有使用 Windows 身份验证 - 您需要禁用匿名访问并启用 Windows 集成安全性。

将此添加到您的 web.config...

```
<system.web>
 <authentication mode="Windows"/>
  <authorization>
    <deny users="?"/> 
  </authorization>
</system.web> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-10T07:21:04.143

如果您需要任何层（或解决方案中的项目）中当前登录用户的身份，请使用：

`string userId = Thread.CurrentPrincipal.Identity.GetUserId();`

# javascript - 我怎样才能有一个prototype.js 模板编码HTML 实体？

> ID：11567968
> 
> 赞同：2
> 
> 时间：2012-07-19T19:31:37.680
> 
> 标签：javascript, prototypejs, html-entities

如果我有一个从 JavaScript 对象生成 HTML 代码的[prototype.js 模板](http://prototypejs.org/api/template)，我怎样才能让它自动转义 JavaScript 对象数据中的 HTML 实体，以便 HTML 不会中断？

示例 JavaScript 代码：

```
var data = {
    name: 'Josh',
    url: 'http://josh.gitlin.name/',
    statement: 'I\'m a JavaScript and PHP developer. Find me on Stack Overflow and say "hi"!'
}

var template = new Template(
    '<div><label>Name: <input name=\"name\" value=\"#{name}\"></label></div>'+
    '<div><label>URL: <input name=\"url\" value=\"#{url}\"></label></div>'+
    '<div><label>Personal Statement: <input name=\"statement\" value=\"#{statement}\"></label></div>'
);

$('test').update(template.evaluate(data)); 
```

[上面的 JSFiddle 代码](http://jsfiddle.net/HtRmS/)

上面的代码会产生一个格式错误的`<input>`标签，因为`data.statement`它包含一个引号`"`。如何在不修改对象或克隆对象`Template`的情况下自动转义上述示例中的 HTML 实体？​</p> `data``data`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:57:01.110

为了做到这一点，需要做两件事：

1.  类的`escape`方法`Template`必须知道转义 HTML 实体
2.  [`escapeHTML`Prototype.js 添加到`String`对象](http://prototypejs.org/api/string)的方法必须扩展为将引号编码为`&quot;`实体。（可能还有更多。现在太*简单*了......）

这两者都可以通过以下代码实现：

```
String.prototype.escapeHTML = String.prototype.escapeHTML.wrap(function(proceed){
    return proceed().replace(/"/g,'&quot;');
});

Template.addMethods({
    evaluateEscapeHTML: function(object) {
        if (object && Object.isFunction(object.toTemplateReplacements))
          object = object.toTemplateReplacements();

        return this.template.gsub(this.pattern, function(match) {
          if (object == null) return (match[1] + '');

          var before = match[1] || '';
          if (before == '\\') return match[2];

          var ctx = object, expr = match[3],
              pattern = /^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;

          match = pattern.exec(expr);
          if (match == null) return before;

          while (match != null) {
            var comp = match[1].startsWith('[') ? match[2].replace(/\\\\]/g, ']') : match[1];
            ctx = ctx[comp];
            if (null == ctx || '' == match[3]) break;
            expr = expr.substring('[' == match[3] ? match[1].length : match[0].length);
            match = pattern.exec(expr);
          }

          return before + String.interpret(ctx).escapeHTML();
        });
    }
}); 
```

**这段代码将扩展 Prototype.js`evaluateEscapeHTML`并向 Templates 添加一个新方法**，所以这段代码应该运行*一次*，从那时起，任何一个`Template`都会有一个新`evaluateEscapeHTML`方法：

```
var template = new Template(
    '<div><label>Name: <input name=\"name\" value=\"#{name}\"></label></div>'+
    '<div><label>URL: <input name=\"url\" value=\"#{url}\"></label></div>'+
    '<div><label>Personal Statement: <input name=\"statement\" value=\"#{statement}\"></label></div>'
);

$('test').update(template.evaluate(data)); 
```

[JSFiddle 来测试这个](http://jsfiddle.net/PabjP/3/)

请注意，我必须*从*prototype.js 1.7 版的类中*复制*整个方法。这有一个主要缺点，如果该方法的未来版本得到改进，我的代码也需要改进。但是，我找不到更好的方法来做到这一点。 *`evaluate``Template``evaluate`*

 *对我所做的方法的具体修改`evaluate`是更改此行：

```
return before + String.interpret(ctx); 
```

至：

```
return before + String.interpret(ctx).escapeHTML(); 
```

就是这样，这就是为什么我无法以某种方式`extend`或`wrap`其余代码如此遗憾的原因......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T19:58:06.250

阅读源代码，模板中没有任何内容可以转义 html。此外，提供`String#escapeHTML`的内容非常糟糕，因为它试图用正则表达式（wtf2）剥离标签（wtf），甚至不转义引号。

您可以使用以下方法手动转义您的字符串：

```
function escapeHTML(text) {
    var map = {
        "&" : "amp",
        "'": "#39",
        '"': "quot",
        "<": "lt",
        ">": "gt"

    };

    return text.replace( /[&'"<>]/g, function(m) {
        return "&" + map[m] + ";";
    });
} 
```*

# javascript - 如何翻转 Twitter Bootstrap 的工具提示

> ID：11567969
> 
> 赞同：5
> 
> 时间：2012-07-19T19:31:41.127
> 
> 标签：javascript, css, twitter-bootstrap, tooltip

我正在使用 Twitter 的 Bootstrap 来实现工具提示。目前，工具提示显示在链接上方。我希望工具提示出现在链接下方。我该怎么做呢？

我正在触发工具提示，它清楚地表明“底部”，但它不想为我工作......

```
<script>$('#home').tooltip('hide bottom')</script> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T19:42:48.437

```
$('#tooltip').tooltip({
    placement : 'left',
    title : 'first tooltip'
}); 
```

在`<script>`标签内或单独的 JavaScript 文件中使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T19:38:22.157

假设您使用的是最新的 Bootstrap，您将使用“底部”的位置。您可以通过创建工具提示时的选项来执行此操作：`$("#tt").tooltip({placement: "bottom"});`或通过元素上的数据属性：`<span data-placement="bottom" ...>tooltip!</span>`我相信。

您可以在[Bootstrap 工具提示](http://twitter.github.com/bootstrap/javascript.html#tooltips)部分找到有关工具提示的更多信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-19T19:39:08.973

在引导网站上，它们显示了工具提示的选项。其中一个选项是`placement` 可以设置为顶部、底部、右侧或左侧。

因此，当您为工具提示添加脚本时，请选择这样的选项

```
$('#example').tooltip({placement: "bottom"}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T19:41:35.073

引导工具提示有一个“放置”选项。您可以像这样将其设置为“底部”：

```
$('#home').tooltip({
    placement : "bottom"
}); 
```

请参阅他们的官方网站以获取参考资料（[v.2.3.3](http://getbootstrap.com/2.3.2/javascript.html#tooltips)）或（[v.3](http://getbootstrap.com/javascript/#tooltips)）。

# ruby-on-rails - 在 if 语句中创建一个评估为 false 的对象

> ID：11567979
> 
> 赞同：0
> 
> 时间：2012-07-19T19:32:31.950
> 
> 标签：ruby-on-rails, ruby, if-statement

所以我想这样做是因为我认为这是最惯用的出错方式。

例如：

```
User < ActiveRecord::Base
  def add_email?
    ...
    #in the case that it does have an error
    MyErrorObjectThatEvaluatesToFalse.new("The email is already taken")
  end

  def is_valid_user?
    ...
    MyErrorObjectThatEvaluatesToFalse.new("Username is not set")
    ...
  end
end

...

SomeController
    ...
    if error = user.add_email?
      render_error_msg(error.message) and return
    elsif error = user.is_valid_user?
      render_error_msg(error.message) and return
    end
    ...
end 
```

我尝试了以下解决方案之一，但它没有我想要的功能：

```
 class A
    def ==(comp)
      false
    end
  end

  a = A.new
  if a
    puts "'a' evaluated to true"
  else
    puts "'a' evaluated to false"
  end

  #=> 'a' evaluated to true 
```

有没有办法做这样的事情，或者有其他人找到了一种处理错误的方法，它比当前使用 user.valid 的组合间接获取消息的 rails 方法更好？和用户错误？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:52:45.180

我不建议将其作为验证方法，但是要定义一个在比较器上返回 false 的类：

```
class A
  def ==(comp)
    false
  end
end

A.new == "a"   #false
A.new == true  #false
A.new == false #false
A.new == nil   #false 
```

我建议使用 rails 的[内置验证](http://guides.rubyonrails.org/active_record_validations_callbacks.html#validations-overview)。

```
class User < ActiveRecord::Base
  validates :username, :presence => true
end

user = User.new
user.errors #["username must not be blank"] 
```

# c++ - 使用 C++ 在 DLL 中进行子类化

> ID：11567985
> 
> 赞同：0
> 
> 时间：2012-07-19T19:33:14.570
> 
> 标签：c++, dll

我正在开发一个需要读取多种文件格式并合并数据的应用程序。因为我们将来可能希望支持其他格式，所以文件阅读器必须开发为 DLL，并在运行时根据用户输入加载。我通常会一次加载两个 DLL。
我在想我可以创建一个抽象接口（[像这样](http://www.codeproject.com/Articles/28969/HowTo-Export-C-classes-from-a-DLL#CppMatureApproach)），但是如果我在每个（子类）DLL 类中使用工厂函数，当我加载两个 DLL 时，这两个函数定义会相互干扰。我错过了什么吗？有一个更好的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:54:02.057

**（从评论升级）**

如果您使用[LoadLibrary](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684175%28v=vs.85%29.aspx)加载 DLL，您将获得 DLL 的句柄 - 您必须稍后在[FreeLibrary](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683152%28v=vs.85%29.aspx)中使用它来卸载 DLL！

获取句柄后，您可以调用[GetProcAddress](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683212%28v=vs.85%29.aspx)来获取指向函数的指针。

示例代码：

```
auto library = LoadLibrary("sample.dll");
//test if library is null => error handling
auto func = GetProcAddress(library, "function");
//test if func is null => error handling
//you may need to cast func to a different function pointer
auto plugin = func();

//after use:
auto result = FreeLibrary(library);
//test for error 
```

正如我在评论中已经提到的：**永远不要从另一个上下文**（其他 DLL 或 EXE）释放分配在 DLL 中的内存！

# java - 如何在我的活动中编辑元素的属性？

> ID：11567986
> 
> 赞同：0
> 
> 时间：2012-07-19T19:33:16.740
> 
> 标签：java, android

我是一个完整的菜鸟，我正在尝试使用我的代码随着时间的推移减少图像的填充。到目前为止我有这个：

```
 public void growPotato() {
    long base = System.currentTimeMillis();
    long WorkingNum = 0;
    while(growing && WorkingNum > 5 ) {
        WorkingNum = 150 - ((System.currentTimeMillis() - base)/100);
        ImageView PotatoPicture = (ImageView) findViewById(R.id.imageView1);
        PotatoPicture.SetPadding(WorkingNum);
    } 
```

'WorkingNum = 150 -' 说我缺少一个 ';' 对于“LocalVariableDeclarationAssignment”。但我的主要问题是我收到错误：“ImageView 类型的方法 SetPadding(long) 未定义”......我该如何解决或解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:43:48.023

代替：

```
PotatoPicture.SetPadding(WorkingNum); 
```

你应该打电话：

```
PotatoPicture.setPadding(WorkingNum, WorkingNum, WorkingNum, WorkingNum) 
```

Java 区分大小写，因此 setPadding 和 SetPadding 不是同一种方法。阅读 API 了解更多详情：[ImageView.setPadding(int, int, int, int)](http://developer.android.com/reference/android/view/View.html#setPadding%28int,%20int,%20int,%20int%29)。

在大多数 Java 命名约定中，局部变量应以小写字母（或下划线）开头。

# java - 如何在 Windows 上测试 Unix 上的 java 程序？

> ID：11567989
> 
> 赞同：1
> 
> 时间：2012-07-19T19:33:22.843
> 
> 标签：java, windows, unix

问题：我正在开发一个在 Unix 环境中执行一些文件操作的工具，但是我的开发环境是 Windows，我如何测试我正在做的事情。

有什么方法可以模拟我的程序在 Unix 环境中运行，仅用于测试目的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T19:36:48.320

您可以运行安装了 Linux的虚拟机（例如[VMware ）来测试您的程序。](http://www.vmware.com/products/player/)

如果您与 Linux 机器在同一个网络上，您可以将 VNC 合二为一并远程测试您的程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T19:36:26.010

Java 是跨平台的（感谢 JVM），因此您无需担心特定于操作系统的细节，但有一个例外：目录分隔符。Windows 使用`\`，Unix 使用`/`. 为了确保完全兼容，您需要[在 File 中使用分隔符](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html#separator)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-19T19:49:07.040

您无需安装即可运行 Ubuntu。[从磁盘甚至 USB 运行它](http://www.ubuntu.com/download/help/try-ubuntu-before-you-install)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-20T01:32:23.220

你可以：

安装Linux[`virtual machine`](http://en.wikipedia.org/wiki/Virtual_machine)

下载一些可以运行的发行版[`live cd`](http://en.wikipedia.org/wiki/Live_CD)；

在硬盘上安装 Linux（这是一件好事 :-)），在[`multi boot`](http://en.wikipedia.org/wiki/Multi_boot)；

# java - 并发消费者但确保订单

> ID：11567992
> 
> 赞同：3
> 
> 时间：2012-07-19T19:33:34.010
> 
> 标签：java, jms, eai, enterprise-integration

我有一个以非常高的速率（> 100,000/sec）填充的 JMS 队列。

每秒也可能有多条与同一实体有关的消息。（对 entity 的多次更新，每次更新都作为不同的消息。）

另一方面，我有一个消费者处理此消息并将其发送到其他应用程序。

现在，由于消费者无法应对传入消息的速度，整个设置正在放缓。

因为，消费者处理消息的速率有一个 SLA，所以我一直在玩弄让多个消费者并行行动以加快流程的想法。

所以，我想做的是

*   多个消费者在队列上独立行动。
*   每个消费者都可以自由地获取任何消息。
*   抓取消息后，确保它是实体的最新版本。为此，我可以检查处理该实体的应用程序。
*   如果它不是最新的，请升级版本并重试。

到目前为止，我一直在查找集成模式和 JMS 文档，但没有成功。

我欢迎以更优雅的方式解决这个问题的想法以及 Java 世界中任何已知的 API、模式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T19:42:13.893

[ActiveMQ 用一个叫做“消息组”的概念](http://activemq.apache.org/message-groups.html)解决了这个问题。虽然它不是 JMS 标准的一部分，但[一些与 JMS 相关的产品的工作方式类似](https://www.google.com/search?q=jms%20message%20groups&oq=jms%20message%20groups)。基本思想是将每条消息分配给一个“组”，该“组”指示相关且必须按顺序处理的消息。然后进行设置，以便每个组仅交付给一个消费者。因此，您可以获得组之间的负载平衡，但保证组内的按顺序交付。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T18:56:53.270

大多数 EIP 框架和 ESB 都有可定制的重测序器。如果实体的数量不是太大，您可以为每个实体设置一个队列并在开始时重新排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-31T15:00:49.783

对于那些对解决此问题的方法感兴趣的人：

*   使用[收件人列表](http://www.eaipatterns.com/RecipientList.html)EAI 模式

由于问题是关于 JMS 的，我们可以看看[Apache Camel 网站上](http://camel.apache.org/recipient-list.html)的一个例子。

[这种方法与CBR](http://www.eaipatterns.com/ContentBasedRouter.html)和[选择性消费者](http://www.eaipatterns.com/MessageSelector.html)等其他模式不同，因为消费者不知道它应该处理什么消息。让我把它放在一个现实世界的例子中：

我们有一个订单管理系统 (OMS)，它发送订单以由 ERP 处理。然后订单经过 6 个步骤，每个步骤都会在 Order_queue 上发布一个事件，通知新订单的状态。这里没什么特别的。OMS 使用该队列中的事件，但*必须*以它们发布的相同顺序处理每个订单的事件。每分钟发布的消息速率远大于消费者的吞吐量，因此延迟会随着时间的推移而增加。

解决方案要求：

*   并行消费，包括尽可能多的消费者，以将队列大小保持在合理的数量。
*   保证每个订单的事件都以相同的发布顺序进行处理。

实施：

**在 OMS 方面** 负责将订单发送到 ERP 的 OMS 流程确定将处理某个订单的所有事件的消费者，并将接收者名称与订单一起发送。这个过程如何知道收件人应该是什么？好吧，您可以使用不同的方法，但我们使用了一种非常简单的方法：[Round Robin](http://en.wikipedia.org/wiki/Round-robin_scheduling)。

**在 ERP 上** 因为它为每个订单保留了收件人的姓名，所以它只是设置了要传递给所需收件人的消息。

**在 OMS 消费者** 上，我们部署了 4 个实例，每个实例使用不同的收件人名称并同时处理消息。

可以说我们创造了另一个瓶颈：数据库。但事实并非如此，因为订单行上没有并发。

一个缺点是，将订单发送到 ERP 的 OMS 流程必须了解有多少收件人正在工作。

# javascript - html5可以自动全屏吗？

> ID：11567993
> 
> 赞同：7
> 
> 时间：2012-07-19T19:33:38.303
> 
> 标签：javascript, jquery, html, fullscreen

我基于 Using the Fullscreen API in web browsers (http://hacks.mozilla.org/2012/01/using-the-fullscreen-api-in-web-browsers ) for fullscreen ，但只能通过点击事件或控制台萤火虫，而不是提交事件或鼠标悬停或类似的自动。是否可以在没有点击事件或类似事件的情况下使用 html5 自动全屏？

编辑：如果不可能，我理解安全性和可访问性的原因，但在某些环境中，这可能是有希望的。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-19T19:36:11.737

不，这是不可能的——出于安全原因，访问全屏需要用户的“许可”，因此与浏览器输入事件相关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T19:58:25.733

不，那是不可能的。出于安全考虑，`requestFullScreen()`必须由直接用户操作（如单击）触发。这与弹出窗口相同。

阅读[https://wiki.mozilla.org/Security/Reviews/Firefox10/CodeEditor/FullScreenAPI](https://wiki.mozilla.org/Security/Reviews/Firefox10/CodeEditor/FullScreenAPI)和[https://wiki.mozilla.org/Gecko:FullScreenAPI](https://wiki.mozilla.org/Gecko:FullScreenAPI)以供参考。

# symfony1 - 使用 sfGuard 插件按 UserProfile 字段过滤

> ID：11567995
> 
> 赞同：1
> 
> 时间：2012-07-19T19:33:53.140
> 
> 标签：symfony1, symfony-1.4, sfguard

在 Symfony 1.4 中使用 sfGuard 插件时，如何按 sfGuardUserProfile 字段进行过滤？

我认为这是标准的，我创建了一个 sf_guard_user_profile 表来保存名字、姓氏等字段。

我的管理索引页面有一个相当丰富的用户列表。我可以按用户名过滤就好了。但我无法按 sf_guard_user_profile 表中的字段进行过滤，例如 last_name。

我的 generator.yml 看起来像

```
generator:
  class: sfPropelGenerator
  param:
    model_class: sfGuardUser

    config:
      list:
        display: [=username, first_name, last_name, last_login, role]
        batch_actions: []

      filter:
        display: [username]

      form:
        class: myGuardUserAdminForm 
```

我可以通过更改为：

```
filter:
    class: sfGuardUserProfileFormFilter 
```

但是当我提交该表单并为 last_name 提供有效值时，它不会过滤。返回所有记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T13:10:06.267

添加`sfGuardUserProfileFormFilter`为过滤器类不是过滤 first_name、last_name 和其他配置文件字段的正确方法。

相反，您必须在过滤器显示列表中添加一个需要过滤的字段，例如：

```
filter:
    display: [username, first_name, last_name] 
```

然后你必须`sfGuardUserProfileFormFilter`合并`sfGuardUserFormFilter`：

```
public function configure()
{
    parent::configure();

    $this->mergeForm(new sfGuardUserProfileFormFilter());
} 
```

最后为要过滤的合并表单的每个字段添加`sfGuardUserFormFilter`一个函数（推进符号）。对于 first_name，我们有：`addMyFieldColumnCriteria``sfGuardUserProfileFormFilter`

```
 protected function addFirstNameColumnCriteria(Criteria $criteria, $field, $values)
    {
        if (!is_array($values))
            return;

        $criteria->addJoin(sfGuardUserPeer::ID, sfGuardUserProfilePeer::USER_ID, Criteria::INNER_JOIN);

        if (isset($values['is_empty']) && $values['is_empty'])
        {
            $criteria->add($field, null, Criteria::ISNULL);
            $criteria->addOr($field, '', Criteria::EQUAL);
        }
        else
        {
            $value = $values['text'];
            if ($value == '')
                return;
            $criteria->add($field, '%'.$value.'%', Criteria::LIKE);
        }
    } 
```