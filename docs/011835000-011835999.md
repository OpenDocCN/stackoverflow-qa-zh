# StackOverflow 问答 11835000-11835999

# android - Android 布局仅在 oncreate 方法完成后显示

> ID：11835000
> 
> 赞同：0
> 
> 时间：2012-08-06T19:54:48.380
> 
> 标签：android, layout, freeze, oncreate

我创建了（我认为是）一个简单的 JAVA 纸牌游戏。在 JAVA 中，游戏加载布局（框架）并显示 ImageButtons，该按钮由每个玩家的方形持卡人图像组成。然后，持卡人会一张一张地从牌堆中随机抽取卡片。

因此，在 Android 中的 onCreate 方法中，我的初始布局由带有持卡人图像的卡片组成，然后我在 onCreate 方法中运行一个方法来处理卡片。我遇到的问题是初始布局根本没有出现。显示的是已填充持卡人的最终布局。该程序甚至没有显示它们，因为它们是单独处理的我认为也许我需要运行 AsyncTask 但我的处理方法中确实没有任何“主要”指令，这似乎需要它。

我是 Android 开发的相对新手，我想我想知道，如果这么简单的东西会挂起我的原始布局，如果不是从 onCreate 方法调用的方法，主要应用程序指令会去哪里？为什么不只是显示我的原始布局，然后继续 UI 线程，一张一张地更新卡片？

更新：

不幸的是，它仍然不起作用。我的 onCreate 看起来像这样：

```
public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            player1Card1B = (ImageButton) findViewById(R.id.p1C1Bref);
            player1Card2B = (ImageButton) findViewById(R.id.p1C2Bref);
            player1Card3B = (ImageButton) findViewById(R.id.p1C3Bref);
            player2Card1B = (ImageButton) findViewById(R.id.p2C1Bref);
            player2Card2B = (ImageButton) findViewById(R.id.p2C2Bref);
            player2Card3B = (ImageButton) findViewById(R.id.p2C3Bref);
            player3Card1B = (ImageButton) findViewById(R.id.p3C1Bref);
            player3Card2B = (ImageButton) findViewById(R.id.p3C2Bref);
            player3Card3B = (ImageButton) findViewById(R.id.p3C3Bref);
            player4Card1B = (ImageButton) findViewById(R.id.p4C1Bref);
            player4Card2B = (ImageButton) findViewById(R.id.p4C2Bref);
            player4Card3B = (ImageButton) findViewById(R.id.p4C3Bref);

            newDeckCard = (ImageButton) findViewById(R.id.newCardDeckBref);
            discardDeckCard = (ImageButton) findViewById(R.id.discardCardDeckBref);
            knockButton = (ImageButton) findViewById(R.id.knockBref);

            player1Card1B.setOnClickListener(this);
            player1Card2B.setOnClickListener(this);        
            player1Card3B.setOnClickListener(this);
            newDeckCard.setOnClickListener(this);
            discardDeckCard.setOnClickListener(this);
            knockButton.setOnClickListener(this);
    }

and my onStart like this:

     @Override
    protected void onStart() {
        // TODO Auto-generated method stub
        super.onStart();

        shuffle();
        deal();
    } 
```

我只是得到一个显示“主要”的白屏，然后最终显示的卡片已经填充。我什至没有得到在 onCreate 方法中读取的占位符。当我删除 deal() 方法时，会显示占位符卡。当我把它放回去时，占位符卡没有出现，只有发牌出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:26:59.857

您应该将填充卡片的代码移动到您的活动`onResume()`方法中 - 可能是某种随着时间的推移而`AsyncTask`开始`onResume()`工作的方法，以便用户可以直观地看到更改。

`onResume()`当 Android 实际在屏幕上显示您的活动时调用该方法；如果您确实完成了所有工作中的`onCreate()`所有工作，那么您的应用程序将在您的应用程序出现在屏幕上之前完成 - 这会产生您所看到的结果。

谷歌有[一些关于活动生命周期如何工作的很好的在线文档](http://developer.android.com/training/basics/activity-lifecycle/starting.html)。

# c - 为什么/C 允许隐式函数和无类型变量声明？

> ID：11835001
> 
> 赞同：17
> 
> 时间：2012-08-06T19:54:51.770
> 
> 标签：c, history, language-design, implicit-declaration

为什么语言允许隐式声明函数和无类型变量是明智的？我知道 C 是旧的，但允许省略声明并默认为`int()`（或`int`在变量的情况下）对我来说似乎并不那么理智，即使在那时也是如此。

那么，它最初为什么会被引入呢？它真的有用吗？它实际上（仍然）使用吗？

*注意：我意识到现代编译器会给你警告（取决于你传递的标志），你可以禁止这个特性。那不是问题！*

* * *

例子：

```
int main() {
  static bar = 7; // defaults to "int bar"
  return foo(bar); // defaults to a "int foo()"
}

int foo(int i) {
  return i;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-06T20:12:44.453

这是通常的故事——*歇斯底里的葡萄干*（又名“历史原因”）。

一开始，运行 C 的大型计算机（DEC PDP-11）有 64 KiB 的数据和代码（后来每个 64 KiB）。您可以使编译器运行的复杂程度受到限制。事实上，有人怀疑您是否可以使用 C 等高级语言编写 O/S，而不需要使用汇编程序。所以，有大小限制。此外，我们谈论的是很久以前，在 1970 年代初到中期。总的来说，计算不像现在那样成熟（特别是编译器还不太了解）。此外，衍生出 C 的语言（B 和 BCPL）是无类型的。所有这些都是因素。

从那时起，该语言已经发展（谢天谢地）。正如在评论和被否决的答案中广泛指出的那样，在严格的 C99 中，隐式`int`变量和隐式函数声明都已过时。然而，大多数编译器仍然识别旧语法并允许使用它，或多或少地警告，以保持向后兼容性，以便旧源代码继续像往常一样编译和运行。C89 在很大程度上标准化了语言，如 warts ( `gets()`) 等等。这是使 C89 标准可接受的必要条件。

使用旧符号的旧代码仍然存在——我花了很多时间研究一个古老的代码库（最古老的部分大约在 1982 年），它仍然没有完全转换为到处的原型（这让我非常恼火，但是在拥有数百万行代码的代码库上，一个人只能做这么多）。其中很少有`int`变量“隐含”；有太多地方没有在使用前声明函数，还有一些地方函数的返回类型仍然是隐式的`int`。如果您不必处理这些混乱，请感谢那些在您之前走过的人。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-06T20:26:34.140

参见 Dennis Ritchie 的“C 语言的发展”：[http ://cm.bell-labs.com/who/dmr/chist.html](http://cm.bell-labs.com/who/dmr/chist.html)

例如，

> 与创建 B 期间普遍存在的语法变化相比，BCPL 的核心语义内容——它的类型结构和表达式评估规则——保持不变。两种语言都是无类型的，或者更确切地说，只有一种数据类型，“单词”或“单元格”，一种固定长度的位模式。这些语言中的内存由此类单元格的线性数组组成，单元格内容的含义取决于所应用的操作。例如，+ 运算符只是使用机器的整数加法指令将其操作数相加，而其他算术运算同样不知道其操作数的实际含义。因为内存是一个线性数组，所以可以将单元格中的值解释为该数组中的索引，而 BCPL 为此提供了一个运算符。在原始语言中，它拼写为 rv，后来拼写为 !，而 B 使用一元 *。因此，如果 p 是一个包含另一个单元格的索引（或地址或指针）的单元格，则 *p 引用指向的单元格的内容，可以是表达式中的值，也可以是赋值的目标.

这种无类型在 C 中一直存在，直到作者开始将其移植到具有不同字长的机器上：

> 在此期间，尤其是在 1977 年左右，语言变化主要集中在考虑可移植性和类型安全性，以应对我们在将大量代码移至新的 Interdata 平台时预见和观察到的问题。当时的 C 仍然表现出其无类型起源的强烈迹象。例如，指针与早期语言手册或现存代码中的完整记忆索引几乎没有区别。字符指针和无符号整数的算术性质的相似性使得很难抗拒识别它们的诱惑。添加了无符号类型以使无符号算术可用，而不会与指针操作混淆。类似地，早期的语言允许整数和指针之间的赋值，但这种做法开始受到反对；发明了一种类型转换的符号（称为 Algol 68 示例中的“强制转换”）以更明确地指定类型转换。被 PL/I 的例子所迷惑，早期的 C 并没有将结构指针牢固地绑定到它们所指向的结构上，并且允许程序员编写指针->成员几乎不考虑指针的类型；这样的表达式被不加批判地视为对指针指定的内存区域的引用，而成员名称仅指定了偏移量和类型。并允许程序员编写指针->成员几乎不考虑指针的类型；这样的表达式被不加批判地视为对指针指定的内存区域的引用，而成员名称仅指定了偏移量和类型。并允许程序员编写指针->成员几乎不考虑指针的类型；这样的表达式被不加批判地视为对指针指定的内存区域的引用，而成员名称仅指定了偏移量和类型。

编程语言随着编程实践的变化而发展。在现代 C 和现代编程环境中，许多程序员从未编写过汇编语言，整数和指针可互换的概念似乎几乎是深不可测和不合理的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-06T20:27:08.987

对于“为什么”的最佳解释可能来自[这里](https://www.bell-labs.com/usr/dmr/www/chist.html)：

> 在同类语言中，C 语言最有两个特点：数组和指针之间的关系，以及声明语法模仿表达式语法的方式。它们也是其最常受到批评的功能之一，并且经常成为初学者的绊脚石。在这两种情况下，历史事故或错误都加剧了他们的困难。其中最重要的是 C 编译器对类型错误的容忍度。**从上面的历史可以清楚地看出，C 是从无类型语言演变而来的**. 它并没有突然出现在它的早期用户和开发者眼中，是一种拥有自己规则的全新语言。相反，随着语言的发展，我们必须不断地调整现有程序，并为现有的代码体留出余地。（后来，标准化 C 的 ANSI X3J11 委员会将面临同样的问题。）

系统编程语言不一定*需要*类型；你在乱搞字节和单词，而不是浮点数、整数、结构和字符串。类型系统是零零散散地移植到它上面的，而不是从一开始就成为语言的一部分。随着 C 从主要是一种系统编程语言转变为一种通用编程语言，它在处理类型方面变得更加严格。但是，即使范式来来去去，遗留代码是永远的。仍然有*很多*代码依赖于隐含`int`的，标准委员会不愿意破坏任何有效的东西。这就是为什么花了将近 30 年才摆脱它的原因。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-08-06T20:26:55.620

很久很久以前，在 K&R 之前的 ANSI 时代，函数看起来与今天完全不同。

```
add_numbers(x, y)
{
    return x + y;
}

int ansi_add_numbers(int x, int y); // modern, ANSI C 
```

当您调用类似的函数`add_numbers`时，调用约定有一个重要区别：调用函数时所有类型都被“提升”。所以如果你这样做：

```
// no prototype for add_numbers
short x = 3;
short y = 5;
short z = add_numbers(x, y); 
```

发生的事情是`x`被提升为`int`，`y`被提升为`int`，并且默认情况下假定返回类型为`int`。同样，如果你通过 a`float`它被提升为加倍。这些规则确保原型不是必需的，只要您获得正确的返回类型，并且只要您传递了正确数量和类型的参数。

请注意，原型的语法是不同的：

```
// K&R style function
// number of parameters is UNKNOWN, but fixed
// return type is known (int is default)
add_numbers();

// ANSI style function
// number of parameters is known, types are fixed
// return type is known
int ansi_add_numbers(int x, int y); 
```

过去的一个常见做法是在大多数情况下避免使用头文件，而只是将原型直接粘贴到您的代码中：

```
void *malloc();

char *buf = malloc(1024);
if (!buf) abort(); 
```

如今，头文件在 C 中被认为是必要的邪恶，但正如现代 C 衍生品（Java、C# 等）已经摆脱了头文件一样，老前辈们也不太喜欢使用头文件。

## 类型安全

根据我对 C 之前的旧时代的了解*，*并不总是有很多静态类型系统。一切都是`int`，包括指针。在这种古老的语言中，函数原型的唯一意义就是捕捉数量错误。

因此，如果我们假设首先将函数添加到语言中，然后再添加静态类型系统，则该理论解释了为什么原型是可选的。这个理论还解释了为什么数组在用作函数参数时会衰减为指针——因为在这个 proto-C 中，数组只不过是指针，它会自动初始化为指向堆栈上的某个空间。例如，可能会出现以下情况：

```
function()
{
    auto x[7];
    x += 1;
} 
```

## 引文

*   [C 语言的发展，Dennis M. Ritchie](http://cm.bell-labs.com/who/dmr/chist.html)

关于无类型：

> 两种语言 [B 和 BCPL] 都是无类型的，或者更确切地说，只有一种数据类型，即“单词”或“单元格”，一种固定长度的位模式。

关于整数和指针的等价：

> 因此，如果`p`是一个包含另一个单元格的索引（或地址或指针）的单元格，`*p`则引用指向的单元格的内容，或者作为表达式中的值，或者作为赋值的目标。

由于尺寸限制而省略了原型的理论的证据：

> 在开发过程中，他不断地与内存限制作斗争：每种语言的添加都会使编译器膨胀，使其几乎无法适应，但每次利用该功能进行的重写都会减小其大小。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-06T20:33:57.907

一些值得深思的食物。（这不是一个答案；我们实际上知道答案——它允许向后兼容。）

人们应该先看看 COBOL 代码库或 f66 库，然后再说明**为什么 30 年左右没有清理干净！**

`gcc`默认情况下不会发出任何警告。

吐出正确的`-Wall`东西`gcc -std=c99`

```
main.c:2: warning: type defaults to ‘int’ in declaration of ‘bar’
main.c:3: warning: implicit declaration of function ‘foo’ 
```

`lint`现代内置的功能`gcc`正在显示其颜色。

`lint`有趣的是，安全的现代克隆`lint`——我的意思是`splint`——默认情况下只给出一个警告。

```
main.c:3:10: Unrecognized identifier: foo
  Identifier used in code has not been declared. (Use -unrecog to inhibit
  warning) 
```

`llvm`C 编译器`clang`也有一个内置的静态分析器，`gcc`默认情况下会吐出两个警告。

```
main.c:2:10: warning: type specifier missing, defaults to 'int' [-Wimplicit-int]
  static bar = 7; // defaults to "int bar"
  ~~~~~~ ^
main.c:3:10: warning: implicit declaration of function 'foo' is invalid in C99
      [-Wimplicit-function-declaration]
  return foo(bar); // defaults to a "int foo()"
         ^ 
```

人们过去认为我们不需要向后兼容 80 年代的东西。必须清理或替换所有代码。但事实证明并非如此。许多生产代码停留在史前**非标准**时代。

编辑：

在发布我的之前，我没有查看其他答案。我可能误解了海报的意图。但问题是有一段时间你手动编译代码，并使用切换将二进制模式放入内存中。他们不需要“类型系统”。Richie 和 Thompson 摆在面前的 PDP 机器也不是这样：

不要看胡须，看看我听说用于引导机器的“切换”。

![K&R](../Images/f0311b6105f6a7f3e25d7b2533567af7.png)

还可以看看他们在本文中是如何引导 UNIX 的。它来自 Unix 第 7 版手册。

[http://wolfram.schneider.org/bsd/7thEdManVol2/setup/setup.html](http://wolfram.schneider.org/bsd/7thEdManVol2/setup/setup.html)

问题的关键是他们不需要那么多软件层来管理具有 KB 大小内存的机器。Knuth 的 MIX 有 4000 个单词。您不需要所有这些类型来对 MIX 计算机进行编程。在这样的机器中，您可以愉快地将整数与指针进行比较。

我想**他们为什么这样做**是不言而喻的。所以我专注于**还有多少需要清理**。

# spring-ws - 使用 Jaxb2marshaller 和 spring-ws 自定义验证错误消息

> ID：11835005
> 
> 赞同：3
> 
> 时间：2012-08-06T19:55:14.643
> 
> 标签：spring-ws, jaxb2, unmarshalling, xml-validation

我有一个正在运行的 spring-ws 项目，它可以使用 Jax2b 解组请求，但是当整数/布尔值的解组失败时，我会收到一条几乎没有细节的错误消息，而且通常没有无效元素的名称。例如：

```
org.springframework.oxm.UnmarshallingFailureException: JAXB unmarshalling exception; nested     exception is javax.xml.bind.UnmarshalException
 - with linked exception:
[org.xml.sax.SAXParseException; cvc-datatype-valid.1.2.1: '' is not a valid value for 'integer'.] 
```

这也成为来自我的 Web 服务的 SOAPFault 响应的内容。

我正在尝试更改消息以包含元素名称。我正在使用 ValidationEventHandler 通过从事件处理程序中抛出 RuntimeException 来更改消息，但它仅在某些情况下有效。

### 验证事件处理程序：

```
@Component
public class ValidationEventHandlerImpl implements ValidationEventHandler {

    @Override
    public boolean handleEvent(ValidationEvent event) {

        String message = event.getMessage();
        String linkedMessage = "";
        if(event.getLinkedException() != null)
            linkedMessage = event.getLinkedException().toString();

        boolean ignoreValidationEvent = true;            
        if(message.contains("NumberFormatException") || 
                message.contains("is not a valid value") || 
                linkedMessage.contains("NumberFormatException") || 
                linkedMessage.contains("is not a valid value")){
            ignoreValidationEvent = false;
        }

        if(ignoreValidationEvent){
            return true;
        }else{
            String nodeName = "";
            if(event.getLocator() != null && event.getLocator().getNode() != null)
                nodeName = event.getLocator().getNode().getNodeName();

            //This is the important line
            throw new RuntimeException("Error parsing '" + nodeName + "': " + event.getMessage());

        }
    }

} 
```

### 它成功地改变了：

```
JAXB unmarshalling exception; nested exception is javax.xml.bind.UnmarshalException: Not a number: 32g321
 - with linked exception:
[java.lang.NumberFormatException: Not a number: 32g321] 
```

**到：** RuntimeException 消息：“ *java.lang.RuntimeException：解析“MyNodeName”时出错：不是数字：32g321* ”

（事件严重性：错误）

### 但是当我想要改变它时它**不起作用：**

```
JAXB unmarshalling exception; nested exception is javax.xml.bind.UnmarshalException
 - with linked exception:
[org.xml.sax.SAXParseException; cvc-datatype-valid.1.2.1: '' is not a valid value for 'integer'.] 
```

**to：** RuntimeException 消息：“ *java.lang.RuntimeException：解析 'MyNodeName' 时出错：'' 不是 'integer' 的有效值*”。

RuntimeException 被忽略，而 SAXParseException 被抛出并添加到 SOAPFault 响应中。

（事件严重性：FATAL_ERROR）

### Jaxb2Marshalling 的 Spring 配置：

```
<bean id="jaxb2MarshallerContact" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
    <property name="classesToBeBound">
        <list>
            <value>com.model.oxm.ContactRequest</value>
            <value>com.model.oxm.ContactResponse</value>
        </list>
    </property>
    <property name="marshallerProperties">
        <map>
            <entry>
                <key>
                    <util:constant static-field="javax.xml.bind.Marshaller.JAXB_FORMATTED_OUTPUT" />
                </key>
                <value type="boolean">true</value>
            </entry>
            <entry>
                <key>
                    <util:constant static-field="javax.xml.bind.Marshaller.JAXB_FRAGMENT" />
                </key>
                <value type="boolean">true</value>
            </entry>
        </map>
    </property>
    <property name="schema" ref="ContactServiceSchema" />
    <property name="validationEventHandler" ref="validationEventHandlerImpl" />
</bean>

<bean id="ContactServiceSchema" class="org.springframework.core.io.ClassPathResource">
    <constructor-arg value="WEB-INF/schemas/ContactService.xsd" />
</bean> 
```

### 端点：

```
@Endpoint
public class ContactEndpoint {

    private Logger logger = Logger.getLogger(ContactEndpoint.class);

    @Autowired
    private ContactService contactService;

    private static final String NAMESPACE_URI = "http://mydomain/schemas";

    @PayloadRoot(namespace = NAMESPACE_URI, localPart = "ContactRequest")     
    @ResponsePayload
    public ContactResponse handleContactRequest(@RequestPayload ContactRequest contactRequest) throws Exception {
    ... 
```

*   如何返回自定义消息而不是 SAXParseException 消息？

*   有没有更好的方法来实现这一点，例如使用 ValidationErrorHandler？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T13:00:35.197

我终于找到了解决这个问题的方法。我没有从 ValidationEventHandler 中抛出一个新的 RuntimeException，而是将其添加为事件链接异常的抑制异常：

```
event.getLinkedException().addSuppressed(new RuntimeException(errorMessage)); 
```

在端点中，我改为更改了 RequestPayload 肥皂信封。marshallingService 包装了 jax2bmarshaller：

```
@PayloadRoot(namespace = NAMESPACE_URI, localPart = "ContactRequest")     
@ResponsePayload
public ContactResponse handleContactRequest(@RequestPayload  SoapEnvelope soapEnvelope) throws Exception {
    ContactRequest contactRequest = marshallingService.unmarshalContact(soapEnvelope.getBody().getPayloadSource()); 
```

marshallingService 捕获异常，提取我抑制的异常消息并抛出它：

```
((UnmarshalException) xmlMappingException.getCause()).getLinkedException().getSuppressed()[0].getLocalizedMessage(); 
```

这不是一个优雅的解决方案，但端点会产生比以前更好的错误消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T08:48:54.273

你试过用`PayloadValidatingInterceptor`吗？据我所知，这将在解组之前验证消息。也许这会让你更深入地了解出了什么问题。

您可以简单地在应用程序配置中进行设置：

```
private ClassPathResource yourXsdFile = new ClassPathResource("xsd.xsd");

@Bean
public PayloadValidatingInterceptor validatingInterceptor() {
    PayloadValidatingInterceptor interceptor = new PayloadValidatingInterceptor();
    interceptor.setSchema(yourXsdFile);
    interceptor.setAddValidationErrorDetail(true);

    return interceptor;
}

@Bean
public PayloadRootAnnotationMethodEndpointMapping endpointMapping() {
    PayloadRootAnnotationMethodEndpointMapping mapping = new PayloadRootAnnotationMethodEndpointMapping();
    mapping.setInterceptors(new EndpointInterceptor[]{
        validatingInterceptor()
    });

    return mapping;
} 
```

有关更多信息，请查看[api 文档](http://static.springsource.org/spring-ws/sites/2.0/apidocs/org/springframework/ws/client/support/interceptor/PayloadValidatingInterceptor.html)。

# ruby-on-rails - ActionDispatch::Session::SessionRestoreError 可以被救出吗？

> ID：11835007
> 
> 赞同：5
> 
> 时间：2012-08-06T19:55:27.070
> 
> 标签：ruby-on-rails

偶尔中断更改会导致 ActionDispatch::Session::SessionRestoreError 异常。能够做这样的事情来自动清除无效会话会很棒：

```
class ApplicationController < ActionController::Base
  rescue_from ActionDispatch::Session::SessionRestoreError do |exception|
    reset_session
    redirect_to :home
  end
end 
```

这不起作用——我假设是因为异常发生在较低的 ActionDispatch 层。有没有办法从这些错误中恢复？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-03T23:29:54.137

它可以。稳健的解决方案如下：

1.  打开`config/initializers/secret_token.rb`
2.  更改 的值`YourApp::Application.config.secret_token`，例如将最后一个字符替换为其他字符
3.  重启 Rails 服务器

我知道它不能直接解决相关问题并且自动化它相对困难并且不是一个好主意（自动重写应用程序配置），但它可能是一个（昂贵的）选项。

我经历了将大块写入会话的情况，因此您还可以确保根据任何大量数据存储检查您的会话并将其转换到数据库中。

# eclipse - FDT 挂起启动

> ID：11835018
> 
> 赞同：1
> 
> 时间：2012-08-06T19:56:12.890
> 
> 标签：eclipse, fdt

我一直无法启动 FDT。它保持在加载屏幕上。我已经卸载并重新安装了 FDT，但仍然无法打开它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T19:56:12.890

真的很难说会发生什么。听起来这与您的工作区未正确访问有关。

以下是一些可以尝试的事情：

*   尝试删除您的工作区或在启动时选择其他工作区。（很可能会修复它）
*   运行“ [eclipse -clean](https://stackoverflow.com/questions/7058782/how-to-force-eclipse-to-ask-for-default-workspace) ”参数。
*   如果这不起作用，请尝试删除硬盘上的“FDT”文件夹：主页>图书馆>应用程序支持> FDT

# objective-c - NSTimer 精度

> ID：11835023
> 
> 赞同：2
> 
> 时间：2012-08-06T19:56:21.847
> 
> 标签：objective-c, ios, nstimer

我目前正在开发一个应用程序，该应用程序需要以精确的间隔播放声音文件，这些间隔的持续时间是可变的。

我似乎记得被告知 NSTimer 只是在指定的持续时间后将操作放入堆栈，而不是在指定的持续时间后运行操作。这意味着如果在它之前的堆栈上有很多其他操作，它就不会被及时调用。

我想知道这是否确实正确，如果是，是否有任何方法可以保证在指定的持续时间后运行操作。

*在任何人第一次评论声音文件可能会延迟之前，它们已经预先加载以避免这种情况。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T20:00:06.667

在[Apple 的 NSTimer 文档的第一段中，](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSTimer_Class/Reference/NSTimer.html)您会发现：

> 定时器不是实时机制；它仅在已添加计时器的运行循环模式之一正在运行并且能够检查计时器的触发时间是否已过时触发。由于典型的运行循环管理的各种输入源，计时器的时间间隔的有效分辨率被限制在 50-100 毫秒的数量级。如果计时器的触发时间发生在长时间调用期间或运行循环处于不监视计时器的模式下，则计时器不会触发，直到运行循环下次检查计时器。 **因此，定时器触发的实际时间可能是计划触发时间之后的一个重要时间段。**

所以你肯定会在你预定的发射时间*之后*运行（或播放你的声音，在你的情况下） ，但不一定完全*在*你的时间。

# emacs - 使 Windows 路径在 Emacs Lisp 中有用

> ID：11835026
> 
> 赞同：2
> 
> 时间：2012-08-06T19:56:28.613
> 
> 标签：emacs, lisp, elisp

如果我将 Windows 路径（例如“C:\foo\bar\bat”）复制到 Windows 剪贴板，我可以将其粘贴到 Emacs 缓冲区中，但不能用它做很多其他事情，因为反斜杠显然是被解释的作为逃脱。我该怎么做才能使 Emacs Lisp 中的字符串可解析？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:10:42.333

如果您希望将反斜杠解释为反斜杠，则应使用双反斜杠

IE

```
**("C:\\foo\\bar\\bat")**
```

# c# - 如何从拆分表中删除一行？

> ID：11835037
> 
> 赞同：0
> 
> 时间：2012-08-06T19:57:44.420
> 
> 标签：c#, entity-framework

我有两张桌子。一个包含二进制数据，另一个包含元数据。我试图从两个表中删除整行，但不断收到错误：

> 遇到无效数据。缺少必需的关系。
> 检查 StateEntries 以确定违反约束的来源。

其余的信息不是很有帮助。这是我目前的代码。

```
var attachment = _attachmentBinaryRepository.Single(w => w.Id == id);
                _attachmentBinaryRepository.Delete(attachment);
                _unitOfWork.Commit();
                return true; 
```

我被交给了这个项目，但了解表格拆分的基础知识。我只是迷失了删除两者。我假设，这段代码只是试图从一个表中删除，但在包含二进制数据的那个表上。

有人有建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T13:45:04.510

我没有代码，但我最终通过从关系中的所有表中检索相应的行来解决这个问题。这些行然后删除没有任何麻烦。

# php - 我如何像聊天室一样使用 JQuery 循环 mysql 查询？

> ID：11835040
> 
> 赞同：-6
> 
> 时间：2012-08-06T19:57:49.770
> 
> 标签：php, jquery, mysql

我想继续检查`mysql`数据库中的行查询，就像聊天室不断查询和加载新消息一样。实际上，在新消息输入数据库时​​检查和加载它们。

此外，有关如何在检索新查询时添加声音效果的任何提示？非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:10:14.823

您正在寻找的是一个重复的、定时的民意调查。您可以使用 javascript 的[`setTimeout()`方法](http://www.electrictoolbox.com/using-settimeout-javascript/)来做到这一点。

至于播放声音，我帮不了你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:10:23.637

如果每当你想在数据插入数据库时​​执行一个动作，就是使用触发器。

[http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html](http://dev.mysql.com/doc/refman/5.0/en/create-trigger.html)

但是这个动作只能是另一个数据库动作，这意味着你不能让你的 php 脚本得到通知。

因此，在您的情况下，最好每 5 分钟或您喜欢的任何时间间隔运行一次 cron 作业。

试试这些链接：

[http://www.wrockyourweb.com/cron-job-mysql](http://www.werockyourweb.com/cron-job-mysql)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T20:23:34.013

```
var auto_refresh = setInterval(
function ()
{
    // call your php through ajax -- which inturn checks your db
    $.ajax({
      url: "script.php",
      type: "POST",
      data: {id : menuId},
      dataType: "json",
      success: function(){
        alert('success');
                    //if there is data to be populated, play sound and populate you div/textarea

      }       
    });
 }, 10000); // refresh every 10000 milliseconds 
```

对于声音，您可以尝试这种[跨平台、跨浏览器的方式来使用 jQuery 1.4 播放声音？](https://stackoverflow.com/questions/2769077/cross-platform-cross-browser-way-to-play-sound-using-jquery-1-4)，我从未尝试过，但答案已被接受，所以应该可以。如果它不起作用，你也可以试试这个[https://github.com/admsev/jquery-play-sound](https://github.com/admsev/jquery-play-sound)

# javascript - 如何将模态滑到一边 - 显示其他模态（如向导......）

> ID：11835041
> 
> 赞同：4
> 
> 时间：2012-08-06T19:57:56.017
> 
> 标签：javascript, jquery, twitter-bootstrap, jquery-animate, modal-dialog

在下面的小提琴中，我实现了两个像向导一样的模式：

```
$('#jumptosecondmodal').click(function(e) {
    $('#secondmodal').modal('show');
    $('#firstmodal').modal('hide');
}) 
```

[http://jsfiddle.net/nV8XZ/show](http://jsfiddle.net/nV8XZ/show)

[http://jsfiddle.net/nV8XZ/](http://jsfiddle.net/nV8XZ/)

我不需要在模态之间切换（显示/隐藏），而是需要将第一个模态放在一边，直到消失，从而显示第二个模态。

编辑：

我已经设法实现了滑动，但它只在第一次运行时按预期工作。连续运行不滑动而是切换（直到页面刷新）

见：http: [//jsfiddle.net/nV8XZ/22](http://jsfiddle.net/nV8XZ/22)

编辑2：

感谢ridecar2的帮助，

这是一个增强的工作版本：

[http://jsfiddle.net/nV8XZ/27/show](http://jsfiddle.net/nV8XZ/27/show)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:05:18.710

您可以尝试`fadeIn`和`fadeOut`方法：

```
$('#jumptosecondmodal').click(function(e) {
    $('#firstmodal').fadeOut(400, function(){
        $(this).modal('hide')
        $('#secondmodal').fadeIn().modal('show')
    })
}) 
```

[演示](http://jsfiddle.net/nV8XZ/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T13:47:28.857

在您以后的 jsFiddle 中，您需要执行以下操作：

```
$('#jumptosecondmodal').click(function(e) {
  $('#secondmodal').width('1px');
  $('#secondmodal').modal('show');
  $('#secondmodal').animate({width: 400}, 2500, function(){
    $('#firstmodal').modal('hide');
  })
}) 
```

`$('#secondmodal').width('1px');`是重要的一行，因为它每次使用时都会将第二个模态区域的宽度设置回 1px。

# ruby-on-rails-3 - best_in_place 日期选择器格式

> ID：11835042
> 
> 赞同：4
> 
> 时间：2012-08-06T19:57:58.240
> 
> 标签：ruby-on-rails-3, jquery-ui, datepicker, date-format, best-in-place

在 Rails 项目中，我正在使用`best_in_place`datepicker 并且在日期格式方面遇到了一些问题。

生成的html `best_in_place`：

```
<span class="best_in_place pull-right" id="best_in_place_task_5_deadline" 
 data-url="/projects/4/tasks/5" data-object="task" data-attribute="deadline" 
 data-type="date" data-original-content="2012-08-16">16 Aug</span> 
```

正如您从`data-original-content`日期格式中看到的那样`yy-mm-dd`，但是当我选择日期时，我得到了这样的东西`09/03/1916`

我尝试将日期格式设置为`application.js`：

```
$.datepicker.setDefaults({ dateFormat: 'yy-mm-dd' }); 
```

但这没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T01:47:38.603

这对我来说并不明显，我必须查看代码源

```
jQuery(function($){
  $.extend($.fn.datepicker.defaults, { format: 'dd-mm-yy' });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-18T15:24:39.890

更新（取自[文档](https://api.jqueryui.com/1.10/datepicker/)）

```
$.datepicker.setDefaults({
    dateFormat: 'dd/mm/yy',
}); 
```

# java - EC_GENERIC_REDIRECTVIEW 仅在生产服务器上和 30 秒负载后不起作用

> ID：11835045
> 
> 赞同：0
> 
> 时间：2012-08-06T19:58:19.283
> 
> 标签：java, websphere-7, websphere-commerce, wcs

我有一个想了解的案例。这是命令作业后重定向到页面的两种不同方式：（在 WCS7 上）

第一的：

```
TypedProperty rspProp = new TypedProperty();
rspProp.put(ECConstants.EC_VIEWTASKNAME, ECConstants.EC_GENERIC_REDIRECTVIEW);
rspProp.put(ECConstants.EC_URL, "AddressBookForm");
setResponseProperties(rspProp); 
```

第二：

```
TypedProperty rspProp = new TypedProperty();
rspProp.put(ECConstants.EC_VIEWTASKNAME, "AddressBookForm");
setResponseProperties(rspProp); 
```

如果命令的处理时间少于 30 秒，则两种解决方案都有效。但是如果命令花费超过 30 秒，第一种方式显示“连接重置”浏览器错误页面（在 FF、IE、Chrome 上相同）。

我尝试在我的本地工具包上重现，但即使该过程需要超过 30 秒，我也无法重现。（我一直尝试到 20 分钟：/）。

我想了解为什么执行时间会破坏 RedirectView？为什么它只发生在实时服务器上？

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T04:49:43.593

不知道为什么 RedirectView 的执行仅在 prod 服务器的情况下会中断。但是正如您在上面所说的重定向流将比正常的前向视图花费更多的时间。

同一主题的 PFB url。让我知道这是否有助于您解决问题，

[http://deepakpadmakumar.blogspot.com/2012/05/forward-view-and-redirect-view-in-wcs.html](http://deepakpadmakumar.blogspot.com/2012/05/forward-view-and-redirect-view-in-wcs.html)

# c++ - 多线程和多核的区别

> ID：11835046
> 
> 赞同：54
> 
> 时间：2012-08-06T19:58:20.753
> 
> 标签：c++, multithreading, multicore

我有几个小问题。

首先，多线程和多核之间有区别吗？它们是完全不同的两个东西，还是多线程在需要时使用多个内核？

其次，大多数内核都有两个线程，但是在分析我的应用程序时，我注意到许多不同的线程，从线程 128 到线程 3460。是什么决定了您的计算机有多少线程？

谢谢

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-08-06T20:29:32.523

> 首先，多线程和多核之间有区别吗？

**是的。**

多线程和多核是适用于不同计算领域的不同术语。

*   多核是指具有多个逻辑 CPU 内核并且可以同时物理执行多条指令的计算机或处理器。计算机的“核心数”是计算机拥有的核心总数：计算机可能有多个处理器，每个处理器可能有多个核心；核心数是所有处理器上的核心总数。

*   多线程是指可以通过同时在多个内核上运行来利用多核计算机的程序。一般来说，两倍的内核等于两倍的计算能力（对于支持多线程的程序），尽管有些问题受到 CPU 使用率以外的因素的限制；这些问题不会从多线程中获得如此巨大的收益。

    需要注意的是，性能并不是程序使用多线程的唯一原因。稍后再谈。

> 它们是完全不同的两个东西，还是多线程在需要时使用多个内核？

**它们是相关的，但又是分开的。**

如果多个内核可用，支持多线程的程序可以使用多个内核。

> 大多数内核都有两个线程，但在分析我的应用程序时，我注意到许多不同的线程，从线程 128 到线程 3460。

**操作系统分配线程编号，以便跟踪它们。**

您将运行的大多数程序都不需要同时运行 3400 个线程。此外，正在运行的线程将消耗所有内核。您的 CPU 不能一直 100% 运行的唯一原因是操作系统知道如何暂停处理器，这基本上使它停止一切并等待发生某些事情（例如 IO 事件或时钟滴答声）。一次只能在一个内核上运行一个线程。不同的线程运行实际上只是线程跳到CPU上并运行了很短的时间，然后被其他也需要运行的线程切换出去。

> 是什么决定了您的计算机有多少线程？

**所有进程中的线程总数。此外，大多数操作系统都施加了一个硬限制，即不能超过的现有线程的最大数量。**

一个进程就是一个程序（你可能知道这一点）。多线程是每个进程拥有多个线程的过程（许多进程不会创建多个线程，因为它们不必这样做）。Windows 对您可以创建的线程数没有硬性限制（至少自 XP 以来没有。不会对 w98 和以前的版本说任何话），但是您可以创建的线程数当然受到内存量的限制你有。

> 您说某些程序出于性能以外的原因使用多个线程。

**有时能够多任务处理是件好事，即使不是同时处理。**

有时程序需要在特定时间做特定的事情。一个经常被引用的例子是一个带有可见窗口的程序。该程序可能会进行密集的后台数字运算，但如果它仍然可以响应用户事件（例如单击按钮和调整其大小），它将使它受益。这可以通过异步处理来完成，这将需要你的一个线程每隔一段时间重复检查 GUI 工作，暂停它正在做的事情，并处理一段时间的 GUI。很多事情都是这样做的。

另一种可能更好的处理方法是使用线程。您的程序不必担心在数字运算和 GUI 管理之间来回切换，操作系统会为您管理。即使您只有一个内核，您仍然可以运行多个线程，并且您的操作系统将尽最大努力确保所有正在运行的进程中的所有正在运行的线程都获得它们公平的 CPU 时间份额。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-06T20:03:07.697

核心数和线程数是解耦的。您可以在单个内核上运行多个线程，并且尽管存在更多内核，但您可能会遇到只有一个线程运行的情况（尽管我无法想到会发生这种情况的现实生活场景）。假设多核是一种硬件特性，而线程数是操作系统域和在其上运行的进程的一部分。

*当然，对于单核，您不能同时*运行多个线程。操作系统必须不断地在线程之间来回切换。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-20T14:14:13.083

> 大多数内核有两个线程

在这里，我认为您混淆了重载术语“线程”。正如其他答案正确指出的那样，线程通常指的是“软件”概念。但有时它也被用作“硬件”概念。当一个“核心”有两个“线程”时（就像在许多新的英特尔芯片中一样），这意味着核心可以运行两个并行线程，就好像有两个核心一样。然而，这通常称为超线程。看：

[http://en.wikipedia.org/wiki/Hyper-threading](http://en.wikipedia.org/wiki/Hyper-threading)

因此，如果您有 N 个线程（我的意思是软件线程，在您的应用程序中创建的，或者只是通过同时运行不同的应用程序）和 M 个处理器（作为内核，或上面解释的硬件线程），会发生以下情况：

*   N<=M: then the Operating System should assign each thread a different processor. Then the application threads run truly in parallel.
*   N>M: then some threads have to share a processor.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-08-06T20:04:04.807

单核上的线程通常意味着您可以创建 x 个线程，并且每个线程都将被赋予设定的运行时间（线程量子）。当线程切换时，这称为上下文切换，所有这一切都需要一些时间，因此需要进行一些基准测试以找到每个内核具有的理想线程数。

如果大部分工作都受 CPU 限制，那么产生数百个线程就没有什么意义了，因为这不太可能提高性能（实际上可能会使情况变得更糟，记住上下文切换不是免费的）。然而，为 I/O 绑定的工作执行此操作可能会有所帮助，因为当系统忙于执行此工作时，可以为另一个线程分配 cpu 时间。

拥有额外的物理内核意味着两件事可以在硬件级别真正并行运行。

# knockout.js - 淘汰赛 - 事件似乎在页面加载时触发？

> ID：11835047
> 
> 赞同：2
> 
> 时间：2012-08-06T19:58:22.003
> 
> 标签：knockout.js

我有一个 ViewModel，它有一个像这样的下拉列表：

```
<select data-bind="options: orderDropdown,
    value: selectedOrder, 
    optionsCaption: '---',
    event: { change: loadOrderDetails }">
</select> 
```

然后`loadOrderDetails`设置如下：

```
// loads details of selected order
self.loadOrderDetails = function () {
    $.ajax({
        url: "/api/OrderDetails",
        data: { id: self.selectedOrder() },
        type: "GET",
        success: function (data) {
            self.orderDetails(data);
        }
    });
} 
```

问题是，当我在控制台中查看时，这个事件似乎在页面加载时触发：

`GET http://localhost:52559/api/OrderDetails 400 (Bad Request)`

知道如何防止它在页面加载时触发吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:37:25.490

我对淘汰赛选项绑定的经验是，如果没有定义值，它将在加载时触发更新。

因此，如果“selectedOrder”只是一个没有值的 ko.observable()，那么它会将其值设置为“orderDropdown”数组中的第一项。这将导致您的更改事件触发。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-26T23:00:19.483

这对我有用。

```
<select data-bind="options: orderDropdown,
    value: selectedOrder, 
    optionsCaption: '---',
    event: { change: function() { loadOrderDetails() } }">
</select> 
```

我从这个特定的答案中得到了解决方案： [https ://stackoverflow.com/a/10119888/1301774](https://stackoverflow.com/a/10119888/1301774)

# asp.net - Visual Studio 2010 对象未设置为对象的实例

> ID：11835048
> 
> 赞同：0
> 
> 时间：2012-08-06T19:58:24.270
> 
> 标签：asp.net, .net, visual-studio-2010, c#-4.0

我知道有很多这样的问题，但我还没有看到任何与我的问题相匹配的问题。首先，我确实安装了 Visual Studio 2012 RC（因为已卸载）。每当我在 VS 2010 或 2012 中构建时，我都会得到“对象未设置为对象的实例”，但仅在发布网站时才会出现。

当我打开诊断调试时，解决方案构建时没有错误，并且在推送 App_Code 文件夹时会发生此错误。同样的解决方案从未出现过此错误，它突然出现，我无法弄清楚如何解决问题。

我已经卸载并重新安装了 Visual Studio 2010，我已经手动将所有网页和中间层类库中的所有代码复制到一个新项目中。我已经尝试了一切，不知道如何解决这个问题。

有任何想法吗？

# c# - DataControlField 中的 FindControl

> ID：11835049
> 
> 赞同：1
> 
> 时间：2012-08-06T19:58:25.090
> 
> 标签：c#, asp.net

我创建了一个自定义`DataControlField`，用于`DetailsView`显示可编辑的时间表。这些自定义字段中的每一个都有传入的 DataSourceID 字符串，用于填充用户可以选择的值。

如果 DetailsView 处于*编辑*模式，它将显示 a`DropDownList`让用户从来自 a 的项目列表中进行选择`SqlDataSource`。在*ReadOnly*模式下，显示所选值的全名。

我在*ReadOnly*模式下遇到的问题是，我只有传入的 SqlDataSource 的 ID，当尝试将其转换为实际的 SqlDataSource 对象时，它返回 null。

我已将完整的对象放在底部，以防将来对任何人有用，我也尝试这样做。

代码前面看起来像这样

```
<asp:DetailsView ID="dvPayPeroid1" runat="server"
    AutoGenerateRows="False"
    CssClass="DetailsView"
    DataSourceID="sqlMyScheduleData"
    DefaultMode="ReadOnly"
    GridLines="None">
    <FieldHeaderStyle CssClass="DetailsViewHeader" />
    <Fields>
        <asp:BoundField DataField="FirstDayOfWeek" HeaderText="Week Starting" HtmlEncode="false" DataFormatString="{0:MM/dd/yyyy}" ReadOnly="true" />
        <my:ScheduleField DataField="1" HeaderText="Sunday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="2" HeaderText="Monday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="3" HeaderText="Tuesday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="4" HeaderText="Wednesday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="5" HeaderText="Thursday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="6" HeaderText="Friday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="7" HeaderText="Saturday" DataSourceID="sqlReasonCodes" />
        <asp:BoundField DataField="FirstDayOfSecondWeek" HeaderText="Week Starting" HtmlEncode="false" DataFormatString="{0:MM/dd/yyyy}" ReadOnly="true" />
        <my:ScheduleField DataField="8" HeaderText="Sunday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="9" HeaderText="Monday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="10" HeaderText="Tuesday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="11" HeaderText="Wednesday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="12" HeaderText="Thursday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="13" HeaderText="Friday" DataSourceID="sqlReasonCodes" />
        <my:ScheduleField DataField="14" HeaderText="Saturday" DataSourceID="sqlReasonCodes" />
    </Fields>
</asp:DetailsView>

<asp:SqlDataSource ID="sqlReasonCodes" runat="server" 
    CacheDuration="500"
    ConnectionString="<%$ ConnectionStrings:MyConnectionString %>"
    EnableCaching="true"
    SelectCommand="ReasonSelectActive" SelectCommandType="StoredProcedure">
</asp:SqlDataSource> 
```

当我将 DetailsView 置于编辑模式时，效果很好。失败的地方是 ReadOnly 模式，它在*DataField*属性中传递值，例如“P”代表“PTO”，“W”代表“Working”，“R”代表“Requested Day Off”，等等。

我的麻烦是将 DataField 转换为其相应的长名称。目前我正在使用这段代码来获取 SqlDataSource。

```
Page page = (Page)HttpContext.Current.Handler;
SqlDataSource sds = (SqlDataSource)page.FindControl(this.DataSourceID);
DataView dv = (DataView)sds.Select(DataSourceSelectArguments.Empty); 
```

这里**sds**对象为空。

我的问题是，如何将控件名称的字符串转换为具有 DataControlField 的对象？

下面的代码供参考，如果有人对改进代码有任何建议，请告诉。

```
public class ScheduleField : DataControlField
{
    #region Properties
    public string CssClass
    {
        get
        {
            object value = ViewState["CssClass"];

            if (value != null)
                return value.ToString();

            return "MetricStatus";
        }

        set
        {
            ViewState["CssClass"] = value;
            OnFieldChanged();
        }
    }

    public string DataSourceID
    {
        get
        {
            object value = ViewState["DataSourceID"];

            if (value != null)
                return Convert.ToString(value);

            return "";
        }

        set
        {
            ViewState["DataSourceID"] = value;
            OnFieldChanged();
        }
    }

    public string DataField
    {
        get
        {
            object value = ViewState["DataField"];

            if (value != null)
                return Convert.ToString(value);

            return "";
        }

        set
        {
            ViewState["DataField"] = value;
            OnFieldChanged();
        }
    }
    #endregion

    #region Constructors
    public ScheduleField()
    {

    }

    #endregion

    #region Abstract / Override Implementations
    protected override DataControlField CreateField()
    {
        return new BoundField();
    }

    public override void InitializeCell(DataControlFieldCell cell, DataControlCellType cellType, DataControlRowState rowState, int rowIndex)
    {
        base.InitializeCell(cell, cellType, rowState, rowIndex);

        // add controls to the cell here.

        if (cellType == DataControlCellType.DataCell)
        {
            if ((rowState & DataControlRowState.Edit) > 0)
                cell.DataBinding += new EventHandler(cell_DataBinding_Edit);
            else if (rowState == DataControlRowState.Normal || rowState == DataControlRowState.Alternate)
                cell.DataBinding += new EventHandler(cell_DataBinding_Normal);
            else
                throw new Exception("Unhandled rowState: " + rowState.ToString());
        }
    }

    #endregion

    #region Events
    private void cell_DataBinding_Edit(object sender, EventArgs e)
    {
        DataControlFieldCell cell = (DataControlFieldCell)sender;
        object dataItem = DataBinder.GetDataItem(cell.NamingContainer);
        string sDataField = DataBinder.GetPropertyValue(dataItem, DataField).ToString();

        DropDownList ddlReason = new DropDownList();
        ddlReason.Items.Add(new ListItem("<none>", ""));
        ddlReason.AppendDataBoundItems = true;
        ddlReason.DataSourceID = this.DataSourceID;
        ddlReason.DataTextField = "Name";
        ddlReason.DataValueField = "Short";
        ddlReason.SelectedValue = sDataField;

        cell.Controls.Add(ddlReason);
    }

    private void cell_DataBinding_Normal(object sender, EventArgs e)
    {
        DataControlFieldCell cell = (DataControlFieldCell)sender;
        object dataItem = DataBinder.GetDataItem(cell.NamingContainer);
        string sDataField = DataBinder.GetPropertyValue(dataItem, DataField).ToString();

        Page page = (Page)HttpContext.Current.Handler;
        SqlDataSource sds = (SqlDataSource)page.FindControl(this.DataSourceID);
        DataView dv = (DataView)sds.Select(DataSourceSelectArguments.Empty);
        DataTable dt = dv.ToTable();

        foreach (DataRow dr in dt.Rows)
        {
            if (dr["Short"].ToString() == sDataField)
                sDataField = dr["Name"].ToString();
        }

        Label lblReason = new Label();
        lblReason.Text = sDataField;

        cell.Controls.Add(lblReason);
    }

    #endregion

    #region Methods

    // no methods

    #endregion
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T18:18:13.210

而不是`.parent.parent`... 使用：

```
ContentPlaceHolder cph = (ContentPlaceHolder)this.Page.Master.FindControl("ContentPlaceHolderID"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T17:44:08.573

好吧，这似乎是一个完整的 hack，但这是我能够引用`SqlDataSource`.

```
ContentPlaceHolder cph = (ContentPlaceHolder)cell.Parent.Parent.Parent.Parent;
SqlDataSource sds = (SqlDataSource)cph.FindControl("sqlReasonCodes");
DataView dv = (DataView)sds.Select(DataSourceSelectArguments.Empty); 
```

看来，由于我使用的`MasterPage`是普通的 Page 对象，因此在其他区域中并不存在您所期望的。

我愿意接受比整件事更好的想法`.Parent.Parent.Parent.Parent`。

# paypal - 贝宝定期付款负面测试

> ID：11835050
> 
> 赞同：2
> 
> 时间：2012-08-06T19:58:42.143
> 
> 标签：paypal, recurring-billing

我正在尝试使用 PayPal 提供的定期付款 API。

当我使用快速结账令牌或信用卡详细信息创建定期付款时，付款总是成功的。

这里有关于如何测试错误条件的说明[http://www.paypalobjects.com/en_US/ebook/PP_Sandbox_UserGuide/testing_error_conditions.html](http://www.paypalobjects.com/en_US/ebook/PP_Sandbox_UserGuide/testing_error_conditions.html) 即您可以指定例如 cvv2=116 并且它会为 doDirectPayment 产生错误，但确实如此似乎不适用于经常性付款。

有没有办法在沙盒中模拟失败的定期付款？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T14:47:02.893

对于那些追随我的脚步的人：这里有 Payflow Pro 定期计费指南[，](https://www.x.com/sites/default/files/pp_payflowpro_recurringbilling_guide.pdf)您可以在那里找到“测试定期计费”部分。“一个人可以使用交易量来生成特定的结果值”。

# jquery - jQuery Mobile 页面加载代码仅在第一次执行

> ID：11835056
> 
> 赞同：0
> 
> 时间：2012-08-06T19:58:57.823
> 
> 标签：jquery, ajax, jquery-mobile, pageload

在 jQuery Mobile 中，我试图在加载时在页面上运行脚本。如果不满足某些条件，我会重定向到另一个页面。例如 PageA --> 单击指向 PageB 的链接 --> 执行页面加载逻辑 --> 重定向到 PageC。我第一次导航到 PageB 时一切正常。如果我然后返回到 PageA 并重复导航到 PageB，则不会发生重定向（不执行页面加载逻辑）。如果我重新加载 PageA 并重试，重定向会发生。

似乎是某种缓存问题？或者也许我应该使用另一种类型的页面加载事件？如何确保每次点击页面时都执行页面加载逻辑？

这是代码的简化版本。该脚本在 jqm 和 jqm 移动脚本之后的头部调用。

```
$(document).bind('pageload', function (evt,data) {

    // I need the url to see if the page needs the logic executed on it
    var page = $.mobile.path.parseUrl(""+ data.url +"");
    if (page == "PageB"){
        logicRequired = "yes";    
    }
    switch (logicRequired)
    {
    //==========================
    case 'yes':

        // AJAX call to determine if redirect is needed
        $.ajax({
        url: "scripts/file.php",
        async: false,
        cache: false,
        success: function (data){
            if(data.status == 'success') {
              // do some stuff

            } else if(data.status == 'error') {
              //redirect to another page
              window.location.replace('redirectPage.html');
            }
        },
        error: function(data){
            //alert("There was an error in the ajax call");
        },
      });
      break;
      }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:09:33.960

`pageload`每次将外部伪页面带入 DOM 时仅触发一次。因此，如果您导航回该页面，该事件将不会再次触发。但是，您可以使用在`pagebeforeshow`首次访问伪页面以及随后访问伪页面时触发的事件。

您还可以使用该`data-cache="false"`属性标记特定的伪页面，以便 jQuery Mobile 在用户导航离开伪页面后删除伪页面。

# database - 是否有用于在不同数据库供应商之间复制数据的特定工程技术/设计？

> ID：11835066
> 
> 赞同：0
> 
> 时间：2012-08-06T19:59:48.933
> 
> 标签：database, replication, database-replication

我有一个客户端，它有许多网站在许多不同的数据库和数据库供应商上运行，从 Oracle 到 SQL 服务器再到 MySQL。数据库确实共享一些信息，特别是成员姓名和联系信息等。

由于时间限制，我们没有时间将所有数据合并到一个数据库中，所有站点都从一个数据库运行。因此，中期解决方案（2-3 年）是在所有数据库中同步这些数据。这将包括：插入、更新和删除。

是否有特定的技术可以提供解决方案。我不一定要寻找供应商的工具，而更多的是一种工程实践，一种从解决方案架构师级别提供解决方案的设计模式。如果这确实存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T14:27:38.580

首先，你需要意识到。您的问题不是“数据库复制”。它是表复制和共享。

鉴于供应商的多样性，您将希望使用“基本”SQL 自己编写自定义代码。特别是，您不希望遇到不同版本的数据库突然不兼容的情况，因此您的复杂异构解决方案不再有效。

我强烈建议您将共享信息分离到单独的数据库中。您提到的所有供应商都支持单个服务器上的多个数据库。将公共信息与其他信息分开将使维护这些数据和传播更改变得更加容易。它还可能开放使用内置数据库复制来共享数据的能力。而且，您甚至可能会发现基于云的解决方案最终可以通过将所有请求发送到中央数据库来解决复制问题。

# android - android viewpager - 刷卡

> ID：11835072
> 
> 赞同：1
> 
> 时间：2012-08-06T20:00:18.567
> 
> 标签：android, android-activity, android-viewpager, swipe

我读过这篇关于 viewpager 的博客：

[http://android-developers.blogspot.sk/2011/08/horizo​​ntal-view-swiping-with-viewpager.html](http://android-developers.blogspot.sk/2011/08/horizontal-view-swiping-with-viewpager.html)

我有一个问题；我可以用它在未知数量的活动之间滑动吗？因为在示例中是 5 个选项卡，您可以在它们之间滑动，但我需要一些可以在活动之间永远滑动的东西。将具有 onSwipeRight 或 left 方法的东西，在那里增加一些整数并显示适当的活动。我不能用片段来做，因为它给了我一些空指针异常——我认为我想要的接口不能用片段来完成。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:50:19.507

考虑使用 Fragments 来浏览它们。

# html - 使用ajax读取div内的文本文件

> ID：11835075
> 
> 赞同：-1
> 
> 时间：2012-08-06T20:00:23.870
> 
> 标签：html, ajax

我只是想读取一个 div 中的 html 文件，现在它不起作用，因此我尝试读取一个名为 a.txt 的简单文本文件，该文本文件包含 3 行“asdasdas”之类的东西。

它只是不起作用，按下段落标签后正在调用该函数，这是代码：

```
function New()
{       
    var xmlhttp;
    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    }
    else
    {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            document.getElementById("divfull").innerHTML = xmlhttp.responseText;
        }
    }
    xmlhttp.open("GET","a.txt",true);
    xmlhttp.send(null);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T01:24:32.740

Where exactly do you get the syntax error?

Try using jQuery:

```
$.ajax({
    type: 'get'
    url: '', //LOCATION OF TEXT FILE
    success: function(data) {
        $('#divfull').html(data);
    }
}); 
```

Since its jQuery it will take care of the browser type (so you won't have to create an ActiveXObject for older IE versions). Plus, its fewer lines of code.

# java - 从 pom.xml 下载依赖项的 API

> ID：11835076
> 
> 赞同：2
> 
> 时间：2012-08-06T20:00:31.970
> 
> 标签：java, maven

我正在尝试编写一个将 maven pom.xml 文件作为输入并执行以下操作的 java 程序：

1.  下载所有依赖项
2.  将 jars 添加到类路径
3.  执行 java 代码（从 jar 中加载）

是否可以？任何实现上述＃1的示例代码将不胜感激

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T20:08:32.963

您的要求正是[Maven Exec 插件](http://mojo.codehaus.org/exec-maven-plugin/)已经完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T15:01:15.333

**如果您绝对必须在 Java 应用程序中执行此操作：**

Maven 用于进行依赖解析的库称为 Aether。如果您查看 Sonatype 站点上的[文档](https://docs.sonatype.org/display/AETHER/Home)，这里有一个如何执行步骤 1 的示例。依赖项解析过程的一部分将使您能够访问依赖项列表，然后您可以循环访问以构建您的类路径。

对于第 3 步，您可以使用 ProcessBuilder 并将目标 Java 应用程序作为使用 Aether 构建类路径的 JVM 的子进程启动。

**如果可以使用 shell 脚本：**

您可以使用`mvn dependency:get -Dartifact=[group]:[artifact]:[version]`将工件下载到本地存储库。

然后您可以使用`mvn dependency:build-classpath`来生成类路径字符串。

然后，您可以使用 -cp 选项简单地执行 java。您还必须知道您想要的主类是什么，或者您可以根据工件和版本号计算主 jar 的名称并将其传递给 -jar。

**如果您能够在部署环境中获取主项目的 pom.xml：**

你可以只使用`mvn exec:java -DmainClass=com.company.package.YourMainClass`. 这个选项是迄今为止最简单的，但它确实有在 maven JVM 中执行的缺点，而且据我所知，没有分叉单独进程的选项。此外，您需要有一个完整的 pom 来完成这项工作，这并不总是很方便。

# php - 目录和动态分页 PHP

> ID：11835079
> 
> 赞同：0
> 
> 时间：2012-08-06T20:00:41.533
> 
> 标签：php, javascript, css, directory

我在一个动态分页网站上工作（基本上是单击一个链接，它会在没有页面刷新（ajax）的情况下加载内容。

我的问题是当我`example.com/first/second`弄乱了 javascript 和 css 目录时（因为浏览器找不到它们，因为它正在做`/first/example.css`而不是`/example.css`）。我试着做：

```
 $Dots = $_SERVER['DOCUMENT_ROOT']; 
```

并在链接到我的 css/javascript 之前添加它。这不起作用，那我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:05:37.750

设置css文件的绝对路径

/path/to/css_file.css （注意斜线前面的路径）

你应该对 javascript 文件做同样的事情

# objective-c - 我应该释放添加到从文件初始化的字典中的对象吗？

> ID：11835080
> 
> 赞同：0
> 
> 时间：2012-08-06T20:00:45.930
> 
> 标签：objective-c, ios

我正在从 .plist 加载字典，如下所示：

```
switches = [NSMutableDictionary dictionaryWithContentsOfFile:
                    [[NSBundle mainBundle] pathForResource:@"Switches" ofType:@"plist"]];
[switches retain]; 
```

现在我需要向它添加一个新条目（这是另一个字典）。要创建字典并添加它，我这样做：

```
 NSMutableDictionary *newObject = [[NSMutableDictionary alloc]init];
    [switches setObject:newObject forKey:@"MyNewObject"]; 
```

我必须释放`newObject`吗？我的意思是，我认为`switches`无论如何都会处理它，对吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:28:44.023

是的，您应该在将 newObject 添加到字典后释放它。由于字典将为保留计数添加 +1，并且当您使用“alloc”作为对象初始化的一部分时，您的保留计数已经为 1。

```
NSMutableDictionary *newObject = [[NSMutableDictionary alloc]init];
    [switches setObject:newObject forKey:@"MyNewObject"];
[newObject release]; 
```

或者

```
NSMutableDictionary *newObject = [[[NSMutableDictionary alloc]init]autorelease];
    [switches setObject:newObject forKey:@"MyNewObject"]; 
```

或者

```
NSMutableDictionary *newObject = [NSMutableDictionary dictionary];
    [switches setObject:newObject forKey:@"MyNewObject"]; 
```

也是可以接受的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T20:04:15.167

字典保留您放入其中的对象（所有可可集合都这样做），因此您确实需要释放`newObject`.

或者，您可以将其创建为自动释放对象，如下所示：

```
NSMutableDictionary *newObject = [NSMutableDictionary dictionary]; 
```

这样您就不需要`newObject`显式释放。

# internet-explorer-8 - IE8 最小宽度和绝对定位问题

> ID：11835089
> 
> 赞同：0
> 
> 时间：2012-08-06T20:01:18.610
> 
> 标签：internet-explorer-8, css-position, css

我有一个下拉菜单，它的触发器是一个可以是可变长度的用户名。在下拉菜单中有按钮。为了让设计在用户名很长时看起来不错，我将按钮设置为下拉宽度：100%，并且为了在用户名很短时看起来不错，我设置了最小宽度。

除了 IE8，所有浏览器都运行良好。

在这个 jsfiddle 中，我简化了代码，并且下拉菜单始终“打开”。我也做了两个版本，一个长名字，一个短名字。

如果您在 IE8 中查看它，当用户名很短时，下拉菜单会错误地移到一边。似乎当您在绝对定位的元素上设置最小宽度时，IE8 不喜欢它。

[http://jsfiddle.net/ntS3t/](http://jsfiddle.net/ntS3t/)

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:05:38.560

我在这里有一个更新的小提琴：http: [//jsfiddle.net/WrXas/2/](http://jsfiddle.net/WrXas/2/)

我将此添加到**.fs-top-nav li**以便顶级菜单项不会换行并中断到下一行

```
white-space: nowrap; 
```

我将这些添加到**.fs-top-nav li > a**因为 min-width 在顶级项目上更有意义。我还居中对齐它以获得更好的视觉外观。

```
min-width: 147px;
text-align: center; 
```

我从**.fs-top-nav .fs-top-nav-profile .fs-top-nav-drop**中删除了这一行。我相信这就是导致下拉 div 位置奇怪的原因。

```
min-width: 147px; 
```

# sql - SQL Server 2008 中子查询的性能

> ID：11835094
> 
> 赞同：0
> 
> 时间：2012-08-06T20:01:45.527
> 
> 标签：sql, performance, sql-server-2008

这两个查询都做同样的事情，其中​​一个的运行速度大约是另一个的 2.5 倍

慢查询

```
select sc.countyName
        ,(
    --this adds the distinct number of people who received rehab    
    select count(distinct p2.patientid)
        from statecounties as sc2
        inner join Patient as p2 on p2.stateCode=sc2.stateCode
        and p2.countyCode = sc2.countyCode
        and sc2.stateCode='21'
        inner join Claims as c on c.patientid=p2.patientid
        and c.admissiondate = p2.admissiondate
        and c.dischargedate = p2.dischargedate
        where sc2.countyName=sc.countyname and c.hcpcs in ('97001', '9339', '97002')

     ) as rehabClaims
     --this is the total number of people from each county that visited a hospital with a DRG stroke admission
     ,count(*) as visitCounts
     ,(
    --this adds the distinct number of people who received rehab    
    select count(distinct p2.patientid)
        from statecounties as sc2
        inner join Patient as p2 on p2.stateCode=sc2.stateCode
        and p2.countyCode = sc2.countyCode
        and sc2.stateCode='21'
        inner join Claims as c on c.patientid=p2.patientid
        and c.admissiondate = p2.admissiondate
        and c.dischargedate = p2.dischargedate
        where sc2.countyName=sc.countyname and c.hcpcs in ('97001', '9339', '97002')

     )/count(*) as visitCounts
     from StateCounties as sc
    inner join Patient as p on p.stateCode=sc.stateCode
    and p.countyCode=sc.countyCode
    where sc.stateCode='21'
    group by sc.countyName
    having count(*) > 30 
```

快速查询

```
select *, round(cast(rehabclaims as float)/VisitCounts *100,2) as percentRehab
from
(
select sc.countyName
        ,(
    --this adds the distinct number of people who received rehab    
    select count(distinct p2.patientid)
        from statecounties as sc2
        inner join Patient as p2 on p2.stateCode=sc2.stateCode
        and p2.countyCode = sc2.countyCode
        and sc2.stateCode='21'
        inner join Claims as c on c.patientid=p2.patientid
        and c.admissiondate = p2.admissiondate
        and c.dischargedate = p2.dischargedate
        where sc2.countyName=sc.countyname and c.hcpcs in ('97001', '9339', '97002')

     ) as rehabClaims
     --this is the total number of people from each county that visited a hospital with a DRG stroke admission
    ,count(*) as visitCounts
    from StateCounties as sc
    inner join Patient as p on p.stateCode=sc.stateCode
    and p.countyCode=sc.countyCode
    where sc.stateCode='21'
    group by sc.countyName
    having count(*) > 30
) t 
```

主要区别在于第一个中的除法是在`sub selects`他们自己身上完成的，而在更快的查询中它使用子查询（如果我的行话错误，请道歉）。我更喜欢第二种方式，因为它更容易阅读 columnName/otherColumnName 而不是输入整个表达式。似乎这种情况通常也更快。这是有原因的，还是只是轶事（适用适当的索引）

# c++ - 不暂停执行的 C++ 循环

> ID：11835095
> 
> 赞同：-1
> 
> 时间：2012-08-06T20:01:54.950
> 
> 标签：c++, dll

我有一个我在其他地方使用的 dll 文件，但在 dll 文件中，我有一个类需要由其中的函数非常频繁地更新。然后我想创建一个循环，每次通过都执行该函数。但即便如此，它也会暂停使用 dll 的线程，因为它被困在循环中（等待它结束）。因此，我的程序冻结了。

那么，如何在不冻结线程的情况下创建此循环。

PS。我虽然尝试过使用 Timer(.net)，但我真的想排除托管代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:12:14.783

好吧，如果没有任何代码示例，很难给你一个准确的答案，但基本上你需要一个新的线程。创建新线程的方式取决于您/您使用的 API。你可以使用 .NET，你可以使用 Lirik 建议的 boost，WINAPI 等等。这一切都归结为：C++ 中的线程是特定于平台的（请参阅[C++ 中线程的简单示例](https://stackoverflow.com/questions/266168/simple-example-of-threading-in-c)）。因此，如果没有更多关于操作系统和编译器的详细信息，一个工作代码示例实际上是不可能的。由于“执行暂停”可能只是一个无限循环，因此您可能需要考虑阅读一些关于 C++ 中的线程的材料。

如果功能已经封装在一个类中，那就太好了，因为您可以将正确启动和结束线程的责任交给类本身，而调用线程并不知道它的任何信息。

# javascript - Node.js 模块的异步初始化

> ID：11835096
> 
> 赞同：22
> 
> 时间：2012-08-06T20:01:55.543
> 
> 标签：javascript, node.js, asynchronous

我想以异步方式初始化模块并提出一些想法。我需要带有来自 Mongo 和其他数据的集合列表的 DB 对象，但`./`为了简洁起见，其中的文件列表会做。

我无法导出函数或类，因为我`require('db')`每次都需要返回相同的对象。

* * *

**首先**，我想到的最简单的方法是稍后分配`module.exports`并`Object`填充它：

```
var exports = {};
module.exports = exports;

require('fs').readdir('.', function(err, files) {
  exports.error = err;
  exports.files = files;
}); 
```

坏事——我真的不知道从外面什么时候列表准备好了，也没有检查错误的好方法。

* * *

**我想出的**第二种**`EventEmitter`方法是继承并通知每个人数据库已准备好或发生错误。如果一切正常 - 继续。**

 **```
var events = require('events');
var util = require('util');

function Db() {
  events.EventEmitter.call(this);
  this.ready = false;
  this.files = null;
  this.initialize();
}

util.inherits(Db, events.EventEmitter);

Db.prototype.initialize = function() {
  if (this.ready)
    return this.emit('ready');

  var self = this;
  require('fs').readdir('.', function(err, files) {
    if (err)
      return self.emit('error', err);

    self.files = files;
    self.ready = true;
    self.emit('ready');
  });
};

module.exports = new Db(); 
```

* * *

**现在**我认为这更合理：

```
// db.js
var exports = {init: init};
module.exports = exports;

function init(callback) {
  callback = (typeof callback === 'function') ? callback : function() {};
  require('fs').readdir('.', function(err, files) {
    delete exports.init;
    exports.result = files; // that's pretty much what I need,
                            // so don't mind result slightly differs
                            // from previous cases
    callback(err);
  });
} 
```

```
// main.js
var db = require('./db');

// check for `db.init` presence maybe...

db.init(function(err) {
  return err ? console.error('Bad!')
             : console.log(db); // It works!
}); 
```

* * *

我应该选择什么，为什么？这种想法总体上有多糟糕，尤其是我的选择？

感谢您的反馈。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-25T21:15:50.970

**TL;DR：**如果您只是打算在启动时读取本地文件，请使用`readdirSync()`而不是。`readdir()`如果您计划实际从远程数据库读取数据或在运行时执行任何 I/O，请使用您的选项 #2 - 回调。下面的解释和代码示例。

**详细解释：**

虽然起初这似乎是一个与模块/依赖项/需求相关的问题，但实际上并非如此。这是一个关于如何处理**异步代码**的通用问题。让我解释：

`require()`基本上是唯一在整个节点中广泛使用的处理 I/O的**同步函数（它需要文件系统中的其他模块）。**同步意味着它实际上将其数据作为返回值返回，而不是调用回调。

异步编程中最基本的 101 规则是：

> 您**永远无法**获取异步代码并为其创建同步 API。

`require`使用被调用的特殊**同步**版本。由于模块实际上只在程序开始时加载，因此它在读取模块时阻止 node.js 执行这一事实不是问题。`readFile``readFileSync`

但是，在您的示例中，您尝试执行额外的**异步 I/O** -`readdir()`在 require 阶段完成。因此，您要么需要使用此命令的**同步**版本，要么需要更改 API...

所以这就是你问题的背景。

您确定了两个基本选项：

1.  使用*承诺*`EventEmitter`（与您的示例基本相同）
2.  使用*回调*（您的第二个示例很好地说明了这一点），第三个是：
3.  使用名为的命令的**同步**版本`readdir()``readdirSync()`

出于简单的原因，我会使用**选项 #3** - 但前提是您计划在启动时仅读取几个文件，如您的示例所暗示的那样。如果稍后您的 DB 模块实际上要连接到数据库 - 或者如果您计划在运行时执行任何此操作，请立即跳船并使用异步 API。

已经没有多少人记得这一点了，但 Promise 实际上是如何在 node.js 中处理异步的原始默认设置。然而，在节点 0.1.30 中，promises 被[删除](https://github.com/joyent/node/commit/bb0d1e)并由带有`function(err, result)`签名的标准化回调替换。这主要是出于简单的原因。

如今，绝大多数异步调用都将此标准回调作为最后一个参数。您的数据库驱动程序执行此操作，您的 Web 框架执行此操作 - 它无处不在。你应该坚持流行的设计并使用它。

> 偏爱承诺或事件的唯一原因是，如果您有**多种不同的结果**可能会发生。例如，可以打开、接收数据、关闭、刷新等套接字。

这不是你的情况。你的模块总是做同样的事情（读取一些文件）。所以**选项＃2**是（除非你可以保持**同步**）。

最后，这里是稍微改写的两个获胜选项：

**同步选项：**
*仅适用于启动时的本地文件系统*

```
// db.js
var fs = require('fs');
exports = fs.readdirSync('.');

// main.js
var db = require('./db');
// insert rest of your main.js code here 
```

**异步选项：**
*当您想使用 DB 等时。*

```
// db.js
var fs = require('fs'), cached_files;

exports.init = function(callback) {
  if (cached_files) {
    callback(null, cached_files);
  } else {
    fs.readdir('.', function(err, files) {
      if (!err) {
        cached_files = files;
      }
      callback(err, files);
    });
  }
};

// main.js
require('./db').init(function(err, files) {
  // insert rest of your main.js code here
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T23:02:33.593

一般来说，在模块中有任何状态都是非常糟糕的主意。模块应该公开函数，而不是数据（是的，这需要稍微改变你的代码结构）。只需将对您的数据的引用作为参数传递给模块函数。

（**编辑：**刚刚意识到这是您上一个示例的方法。我投票赞成）

模块1：

```
module.exports = function(params, callback) { ... } 
```

模块2：

```
var createSomething = require('module1');
module.exports = function(params, callback) { 
   ...
   var db = createSomething(params, function(err, res) {
       ...
       callback(err, res);
   }
} 
```

主要代码：

```
var createSomethingOther = require('module2');
createSomethingOther(err, result) {
    // do stuff
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T08:41:32.230

在我这边，这样的模块是一个接受回调的函数（如果在内部配置了 Promise 也会返回 Promise （参见[https://github.com/medikoo/deferred](https://github.com/medikoo/deferred)））；

回调的唯一问题是，按照惯例，它总是应该在 nextTick 中调用，因此即使在收集了所有数据后调用模块函数，您仍然应该在带有结果集的下一个刻度中调用回调。**

# ios - SBJson 和 Facebook iOS SDK 错误“'NSData' 没有可见的@interface 声明选择器'JSONValue'”

> ID：11835104
> 
> 赞同：0
> 
> 时间：2012-08-06T20:02:29.977
> 
> 标签：ios, xcode, facebook, sdk, sbjson

我收到一条错误消息：

`"no visible @interface for 'NSData' declares the selector 'JSONValue'"`??

当我有一个数据流 (NSDAta) NSDictionary * dict = [data JSONValue]; 时会发生这种情况

我只有 facebook SDK 附带的 SBJson 文件。有人可以帮助我了解发生了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:10:51.607

您的“数据”实际上应该是一个“ `NSString`”对象。

然后你可以做这样的事情（假设 JSON 数据在名为“data”的变量中）：

```
NSString *json_string = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding]; 
if(json_string)
{
    NSDictionary * facebookDict = [json_string JSONValue];
} 
```

还要确保您`#import "NSString+SBJSON.h"`在此代码所在的 .m 文件的顶部有“”。

# php - 根据 url 更改 CodeIgniter 控制器目录

> ID：11835107
> 
> 赞同：1
> 
> 时间：2012-08-06T20:02:56.880
> 
> 标签：php, codeigniter-2, codeigniter-routing

我是 CodeIgniter 的新手，我必须制作一个位于子域上的移动网站。根据您是否是移动设备，唯一要加载的不同内容是`controllers`目录，应用程序文件夹的所有其余部分都适用于两个版本。如何告诉 CodeIgniter`controllers`根据某些参数对特定目录收费？

或者，这不是使用 CodeIgniter 基于子域管理移动网站的最佳方式吗？我想访问相同的自定义库和模型。

谢谢指导，我迷路了！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:51:21.760

我建议不要创建多个控制器目录。对于您网站的大部分内容，控制器逻辑很可能是相同的。您可以在控制器中创建单独的函数，以应对移动版本和桌面版本不同的情况。

首先，我建议让所有控制器都继承自自定义控制器。请参阅 Phil Sturgeon 关于[保持干燥](http://philsturgeon.co.uk/blog/2010/02/CodeIgniter-base-Classes-Keeping-it-DRY)的帖子。实现此功能后，您可以在此自定义“母”控制器中检查请求是来自移动设备还是桌面设备，并且所有后代控制器都会知道它。使用[CodeIgniter 的 native](http://codeigniter.com/user_guide/libraries/user_agent.html) `$this->agent->is_mobile()`：

```
class MY_Controller extends CI_Controller{
    function __construct(){
        parent::__construct();
        $this->data['agent'] = ($this->agent->is_mobile())? 'mobile' : 'desktop';
        $this->load->vars($this->data);
    }
} 
```

改变的是您的演示文稿，而不是您的控制器。现在您知道了请求的来源（代理），您可以渲染适当的内容：

在您的目录中创建两个`views`目录。

```
views
    desktop
    mobile 
```

在调用您的意见时：

`$this->load->view($this->data['agent'] . "/theview");`

关于您在评论中提到的 ajax 请求——您可以检查那些使用[CodeIgniter 的本机](http://codeigniter.com/user_guide/libraries/input.html) `$this->input->is_ajax_request()`函数的请求。当用户单击您网站上的链接或按钮并触发控制器时，无论是在移动设备还是桌面设备上，他们通常会共享类似的功能（例如数据库写入）......但您可以使用该`is_ajax_request()`功能来区分并提供适合的响应该平台。

建议查看[我](https://stackoverflow.com/a/9540985/568884)对视图结构的另一个 StackOverflow 问题的回答以获取更多信息。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:18:48.107

你会想看看[路由](http://codeigniter.com/user_guide/general/routing.html)来做你想做的事情。我不确定您为什么需要不同的控制器，因为我假设您显示的数据对于每个页面（移动设备与非移动设备）都是相同的 - 只是布局会更改以更好地适应移动平台。如果是这种情况，您需要做的就是在根据用户代理收集/处理控制器中的所有数据之后加载不同的视图（分别为移动/桌面视图） - 您甚至不需要不同的视图子域更不用说另一组控制器了。*这*就是 MVC 的力量。

# ios - 在 3d 空间中沿 x 轴旋转平面时，如何计算底边的高度？

> ID：11835111
> 
> 赞同：1
> 
> 时间：2012-08-06T20:03:16.120
> 
> 标签：ios, rotation, core-animation, trigonometry

在我的 iOS 应用程序中，我有一个视图，我正在 3D 空间中的 X 轴上平移。视图的锚点位于顶部中心。如果我旋转视图 M_PI 度数，它看起来会变平。我需要屏幕底部和旋转视图的底部边缘之间的 X 像素（基本上，底部边缘离地的高度需要为 X 像素）。我如何计算这个 M_PI 的百分比？

这是一个例子。在这种情况下，视图的高度为 100 像素，我需要将其旋转一定百分比的 M_PI，以便距离屏幕底部边缘 40 像素。

![图像](../Images/e2f3159582ed81107968077212173bb3.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:15:30.070

这是相当简单的三角函数。如果您想要形状底部和屏幕底部之间的距离为 40 像素，那么形状的顶部边缘和底部边缘之间的距离为 60 像素。你知道在旋转之前你的形状是 100 像素高，所以要找到角度，只需使用 arccos(60/100) = 53.13º = .295167 * M_PI。

# php - 从表中检索所有数据，然后计算另一个中有多少结果

> ID：11835117
> 
> 赞同：3
> 
> 时间：2012-08-06T20:03:32.067
> 
> 标签：php, mysql

我想知道这是否可能只使用一个 MySQL 查询。

我正在做的是一个标签系统。因此，我有两个表：

`Tags, id | heading`

`Tagged, id | image_id | tag_id | timestamp | strength`

一切正常，但现在我已经到了向我的用户显示标签并计划按标签使用次数对它们进行排序的阶段。

所以简而言之，我需要一些可以执行以下操作的东西，

1.  获取当前显示的图像的所有标签，例如`id = 34`.
2.  计算标签被使用了多少次。
3.  按这些结果排序标签列表，从高到低。

现在我已经尝试研究连接、左连接等，但是这一切看起来都非常压倒性，我发现很难掌握它。

如果有人可以轻松地解释如何做到这一点，那就太好了！

**编辑**

我目前有这个

```
SELECT tags.id, COUNT( tagged.id ) AS count
FROM tags
INNER JOIN tagged ON tags.id = tagged.tag_id
WHERE tagged.image_id =  '1'
GROUP BY tags.id
ORDER BY count DESC 
```

这只返回标签被标记到当前 image_id 的次数，我将如何使它从所有图像中计数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:08:34.787

您可以使用`GROUP BY`将相同的标签组合在一起，并使用`COUNT()`来计算它们：

```
 SELECT tags.id  as id,
         COUNT(1) as cnt
    FROM tags INNER JOIN tagged
      ON tags.id = tagged.tag_id
GROUP BY tags.id
ORDER BY cnt DESC 
```

这就是它的确切作用：

*   连接获取标记中的每个条目，并将其与其对应的标记配对。
*   然后我们按标签 id 分组，这样每个 id 只能得到一个条目。
*   该`COUNT`函数计算每组中有多少元素。
*   我们最终按数量降序排列，将最受欢迎的标签放在最前面。

此外，如果您希望每张图像都可以使用多个标签进行标记，您需要将图像信息移动到其自己的表格中，并创建一个单独将两者链接在一起的表格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T20:14:09.887

您可以优化您的 SQL 查询来为您完成工作：

```
SELECT tags.id, COUNT(id) AS count
FROM tags
INNER JOIN tagged ON tags.id = tagged.tag_id
WHERE tagged.image_id = 34;
GROUP BY tags.id 
```

这将选择设置为在图像 id 上标记的每个标签，`34`然后获取使用该标签的图像总数。[JOIN 的可视化解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T20:10:51.527

您可能处于应该拥有一个包含两个表之间关系的中间表的地步，通常称为“[规范化](http://databases.about.com/od/specificproducts/a/normalization.htm)”。

```
tag_image_table
=========

tag | image
===========
1 | 23
99| 23 
```

它表示与 2 个标签相关联的图像 #23。

这使得选择与标签关联的所有图像以及与图像关联的所有标签变得更加容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T22:18:10.420

要获得标记的全局使用，您可能需要重新加入标记表，因为您正在对原始标记表应用 where 条件。试试这个：

```
SELECT 
    t2.id,
    COUNT(t3.tag_id) AS global_count,
    GROUP_CONCAT(t3.image_id) AS images_with_tag
FROM 
    tagged t1
    JOIN tags t2 ON t2.id = t1.tag_id
    LEFT JOIN tagged t3 ON t3.tag_id = t2.id
WHERE t1.image_id = 1
GROUP BY t2.id
ORDER BY global_count DESC 
```

# html - 如何测试我的网站以查看它是否适用于多个浏览器？

> ID：11835138
> 
> 赞同：-3
> 
> 时间：2012-08-06T20:05:18.583
> 
> 标签：html, css

如何测试我的网站以查看它是否适用于多个浏览器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:07:48.003

试试这个：[http ://browsershots.org/](http://browsershots.org/)

你输入你的 URL 和你想要检查的浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T20:09:00.100

如果你自己检查一下会好很多。网上有很多免费工具。例如[http://browsershots.org](http://browsershots.org)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T20:24:58.000

如果你想测试同一个浏览器的多个版本（例如，Windows XP Service Pack 1 和 Windows XP Service Pack 2 上的 IE8），像之前提到的 BrowserShots 这样的东西很好。

但是，对于浏览器的基线，您将希望真正拥有一台运行浏览器的机器。考虑在构建站点时哪些浏览器很重要。很多人已经放弃了对 IE6 的支持，但可能对您（或您的客户）来说，它仍然是必需的——特别是看看这个网站的真实统计数据。

您需要考虑为每个浏览器提供的支持级别。例如，如果某些东西在 Chrome 中需要 1 秒，而在 IE9 中需要 3 秒，是否可以？在旧浏览器中用基于图像的渐变替换 CSS 渐变是否值得？

最后，请记住，虽然 BrowserShots 之类的工具可以帮助您处理 CSS，但它无法检查 JavaScript，因为 IE7 等浏览器与 Chrome 或 Firefox 相比性能受到很大影响，尤其是在处理密集图形（如 SVG）或使用 XPath 进行操作时选择器（缺乏原生支持）。

**没有什么比在真正的浏览器中测试更好的了**。虽然这听起来像是 alec 的聪明答案，但如果您是专业人士，这应该是您的主要浏览器中的最低要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T20:17:12.100

我在浏览[jQuery.org](http://jquery.org)时遇到了[**BrowserStack** .com](http://www.browserstack.com)。这是他们赞助商的名单：http: [//jquery.org/sponsors/](http://jquery.org/sponsors/)

我知道这是一项付费服务​​，但没有等待时间，而且您的网站不会出现在[browsershots.org](http://browsershots.org)等最新截图中。

# mysql - MySQL将逗号分隔的字符串拆分为临时表

> ID：11835155
> 
> 赞同：32
> 
> 时间：2012-08-06T20:07:45.523
> 
> 标签：mysql, regex

您可以使用 RegEx 将逗号分隔的字符串解析为 MySQL 中的临时表吗？

```
'1|2|5|6' into temp table with 4 rows. 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-08-06T20:14:59.043

[这与Can Mysql Split a column](https://stackoverflow.com/questions/1096679/can-mysql-split-a-column)几乎是同一个问题？

MySQL 没有拆分字符串功能，因此您必须解决问题。使用上面答案页面上列出的方法之一拆分数据后，您可以对数据执行任何操作。

您可以遍历该自定义函数并在它返回空时中断，您必须玩并学习一些语法（或者至少我会），但是 mysql 中 FOR 循环的语法在这里： [http://www.roseindia .net/sql/mysql-example/for.shtml](http://www.roseindia.net/sql/mysql-example/for.shtml)

您可以对其进行迭代，增加以下函数中的位置：

```
CREATE FUNCTION SPLIT_STR(
  x VARCHAR(255),
  delim VARCHAR(12),
  pos INT
)
RETURNS VARCHAR(255)
RETURN REPLACE(SUBSTRING(SUBSTRING_INDEX(x, delim, pos),
       LENGTH(SUBSTRING_INDEX(x, delim, pos -1)) + 1),
       delim, ''); 
```

（来源：[https](https://blog.fedecarg.com/2009/02/22/mysql-split-string-function/) ://blog.fedecarg.com/2009/02/22/mysql-split-string-function/ ）

如果未找到匹配项，则应返回 ''，因此如果未找到匹配项，则中断循环。这将允许您仅使用 mysql 解析拆分字符串并将插入查询运行到临时表中。但是人为什么不直接使用像 php 这样的脚本语言来完成这种工作呢？:(

循环语法代码：

```
DELIMITER $$  

CREATE PROCEDURE ABC(fullstr)

   BEGIN
      DECLARE a INT Default 0 ;
      DECLARE str VARCHAR(255);
      simple_loop: LOOP
         SET a=a+1;
         SET str=SPLIT_STR(fullstr,"|",a);
         IF str='' THEN
            LEAVE simple_loop;
         END IF;
         #Do Inserts into temp table here with str going into the row
         insert into my_temp_table values (str);
   END LOOP simple_loop;
END $$ 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-05-24T09:02:41.503

我找到了很好的解决方案

[https://forums.mysql.com/read.php?10,635524,635529](https://forums.mysql.com/read.php?10,635524,635529)

感谢彼得布劳利

> 技巧：将 csv 字符串上的 Group_Concat() 结果按摩到 Insert...Values... 字符串中：

```
drop table if exists t;
create table t( txt text );
insert into t values('1,2,3,4,5,6,7,8,9');

drop temporary table if exists temp;
create temporary table temp( val char(255) );
set @sql = concat("insert into temp (val) values ('", replace(( select group_concat(distinct txt) as data from t), ",", "'),('"),"');");
prepare stmt1 from @sql;
execute stmt1;
select distinct(val) from temp;
+------+
| val  |
+------+
| 1    |
| 2    |
| 3    |
| 4    |
| 5    |
| 6    |
| 7    |
| 8    |
| 9    |
+------+ 
```

此外，如果您只想将某个表加入 id 列表，则可以使用 LIKE 运算符。有我的解决方案，我从博客文章 url 中获取 id 列表，将它们转换为逗号分隔的列表，以逗号开头和结尾，然后使用 LIKE 运算符通过 id 列表加入相关产品。

```
SELECT b2.id blog_id, b2.id_list, p.id
FROM (
    SELECT b.id,b.text,
    CONCAT(
        ",",
            REPLACE(
                EXTRACTVALUE(b.text,'//a/@id')
                , " ", ","
            )
        ,","
    ) AS id_list
    FROM blog b
) b2
LEFT JOIN production p ON b2.id_list LIKE CONCAT('%,',p.id,',%')
HAVING b2.id_list != '' 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-13T09:42:49.733

```
DELIMITER $$  

CREATE PROCEDURE SPLIT_VALUE_STRING()

    BEGIN

        SET @String      = '1,22,333,444,5555,66666,777777';
        SET @Occurrences = LENGTH(@String) - LENGTH(REPLACE(@String, ',', ''));
        myloop: WHILE (@Occurrences > 0)
        DO 
            SET @myValue = SUBSTRING_INDEX(@String, ',', 1);
            IF (@myValue != '') THEN
            /* my code... */
            ELSE
                LEAVE myloop; 
            END IF;
            SET @Occurrences = LENGTH(@String) - LENGTH(REPLACE(@String, ',', ''));
            IF (@occurrences = 0) THEN 
                LEAVE myloop; 
            END IF;
            SET @String = SUBSTRING(@String,LENGTH(SUBSTRING_INDEX(@String, ',', 1))+2);
        END WHILE;                  

   END $$ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-04T16:27:49.870

我已经这样做了，因为当您没有表值等时：

```
select *
from(
    select c, SUBSTRING_INDEX(SUBSTRING_INDEX('1|2|5|6', '|', c+1), '|', -1) as name
    from(
        SELECT (TWO_1.SeqValue + TWO_2.SeqValue + TWO_4.SeqValue + TWO_8.SeqValue + TWO_16.SeqValue + TWO_32.SeqValue) c
        FROM (
            SELECT 0 SeqValue UNION ALL SELECT 1 SeqValue) TWO_1
            CROSS JOIN (SELECT 0 SeqValue UNION ALL SELECT 2 SeqValue) TWO_2
            CROSS JOIN (SELECT 0 SeqValue UNION ALL SELECT 4 SeqValue) TWO_4
            CROSS JOIN (SELECT 0 SeqValue UNION ALL SELECT 8 SeqValue) TWO_8
            CROSS JOIN (SELECT 0 SeqValue UNION ALL SELECT 16 SeqValue) TWO_16 
            CROSS JOIN (SELECT 0 SeqValue UNION ALL SELECT 32 SeqValue) TWO_32
    ) as b
    WHERE c <= (CHAR_LENGTH('1|2|5|6') - CHAR_LENGTH(REPLACE('1|2|5|6', '|', '')))
) as a; 
```

可能不是最好的答案，但在没有函数和过程的帮助下工作，没有额外的表格等。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-08-18T16:50:11.423

```
select distinct
  SUBSTRING_INDEX(SUBSTRING_INDEX('1,2,3,4', ',', numbers.n), ',', -1) name
from
  (select @rownum := @rownum + 1 as n
from YourTable
cross join (select @rownum := 0) r
) numbers 
order by
   n 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-06T20:15:34.597

您可以在 MySQL 中使用正则表达式来指定复杂搜索的模式，您无法解析字符串。

但是您可以在 REPLACE 和 CONCATENATE 的帮助下构建 INSERT 查询以将数据保存到临时表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-17T18:02:20.207

如果您尝试拆分的文本包含多字节字符，则此方法将因 LENGTH 计算不正确而失效。对于这种情况，使用 CHAR_LENGTH 而不是 LENGTH 的以下版本可以工作：

```
CREATE DEFINER=`root`@`localhost` FUNCTION `strSplit`(
           `src` MEDIUMTEXT CHARACTER SET utf8, 
           `delim` VARCHAR(12), 
           `pos` INTEGER
          )
    RETURNS mediumtext
    LANGUAGE SQL
    NOT DETERMINISTIC
    CONTAINS SQL
    SQL SECURITY DEFINER
    COMMENT ''
BEGIN
  DECLARE output MEDIUMTEXT CHARACTER SET utf8;
  SET output = REPLACE(SUBSTRING(SUBSTRING_INDEX(src, delim, pos) ,  
              CHAR_LENGTH(SUBSTRING_INDEX(src, delim, pos - 1)) + 1) , delim , '');
  IF output = '' THEN SET output = null; END IF;
  RETURN output;
END 
```

参考：[http ://www.shakedos.com/2011/Nov/23/mysql-split-string-function-fix-split_str.html](http://www.shakedos.com/2011/Nov/23/mysql-split-string-function-fix-split_str.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-23T02:23:55.263

只是因为我真的很喜欢复活旧问题：

```
CREATE PROCEDURE `SPLIT_LIST_STR`(IN `INISTR` TEXT CHARSET utf8mb4, IN `ENDSTR` TEXT CHARSET utf8mb4, IN `INPUTSTR` TEXT CHARSET utf8mb4, IN `SEPARATR` TEXT CHARSET utf8mb4)
BEGIN
    SET @I = 1;
    SET @SEP = SEPARATR;
    SET @INI = INISTR;
    SET @END = ENDSTR;
    SET @VARSTR = REPLACE(REPLACE(INPUTSTR, @INI, ''), @END, '');
    SET @N = FORMAT((LENGTH(@VARSTR)-LENGTH(REPLACE(@VARSTR, @SEP, '')))/LENGTH(@SEP), 0)+1;

    CREATE TEMPORARY TABLE IF NOT EXISTS temp_table(P1 TEXT NULL);

    label1: LOOP
        SET @TEMP = SUBSTRING_INDEX(@VARSTR, @SEP, 1);
        insert into temp_table (`P1`) SELECT @TEMP;
        SET @I = @I + 1;
        SET @VARSTR = REPLACE(@VARSTR, CONCAT(@TEMP, @SEP), '');
        IF @N >= @I THEN
          ITERATE label1;
        END IF;
        LEAVE label1;
      END LOOP label1;
    SELECT * FROM temp_table;
    END 
```

产生：

```
P1
1
2
3
4 
```

使用时`CALL SPLIT_LIST_STR('("', '")', '("1", "2", "3", "4")', '", "');`

稍后我可能会弹出以使代码更潮一点！干杯!

# advantage-database-server - Advantage Database 9.1，用PK创建表

> ID：11835157
> 
> 赞同：3
> 
> 时间：2012-08-06T20:07:58.303
> 
> 标签：advantage-database-server

```
create table WEBLOG
(
ORDERNO CHAR(9) NOT NULL,
USERNAME CHAR(50) NOT NULL,
ACTION CHAR(255) NOT NULL,
NOTE MEMO,
UPDATEDATE DATE NOT NULL,
UPDATETIME TIME NOT NULL,
IP CHAR(15),
PK CHAR(36) NOT NULL,
PRIMARY KEY(PK)
) 
```

上面的查询不起作用，错误消息说，

```
ERROR IN SCRIPT: poQuery: Error 7200:  AQE Error:  State = HY000;   NativeError = 2215;  [iAnywhere Solutions][Advantage SQL Engine]Invalid create options:  
NOCPTRANS and nullable column type options are only valid with ADS_VFP table type. -- Location of error in the SQL statement is: 23 (line: 3 column: 1) 
```

该查询有什么问题？

我的优势数据库版本是 9.1。

有人知道，请给我建议。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:32:38.787

此错误是由使用 引起的`NOT NULL`，它仅在 ADS_VFP (Visual FoxPro) 表类型上受支持。

使用 Advantage处理的通常方法`NOT NULL`是通过 ADS 数据字典建立连接，然后改用`CONSTRAINT NOT NULL`语法。但是，它不适用于`free table`（不在数据字典中的表）连接 - 尝试仅将其更改为`CONSTRAINT NOT NULL`在空闲表上会导致错误`The field-level or record-level constraint is invalid. Field level constraints are not supported on free table.`

这记录在[ADS 9.1 帮助](http://devzone.advantagedatabase.com/dz/webhelp/Advantage9.1/Advantage.htm)中，特别是在[CREATE TABLE](http://devzone.advantagedatabase.com/dz/webhelp/Advantage9.1/create_table.htm)下：

> vfp 选项 ::= NULL | 非空 | NOCPTRANS
> 
> 这些选项适用于 Visual FoxPro 表 (ADS_VFP)，并可与自由表和数据字典表一起使用。NULL（和 NOT NULL）选项指示列是否能够在物理上保存 NULL 值。这与 NOT NULL 约束不同。如果创建 Visual FoxPro 列时没有使用 NULL 选项，则如果尝试在该列中存储 NULL，则会产生错误。NOCPTRANS 选项适用于 Visual FoxPro 字符和备注字段类型。如果提供此选项，则不会跨代码页转换数据（ANSI/OEM 转换）。

顺便说一句，当您在 中遇到语法错误`ARC32`，并且您的 SQL 的结构与您的一样时，光标位于导致错误的行上。在这种情况下，错误是在第一个列定义 ( `ORDERNO CHAR(9) NOT NULL`) 上引起的。更改该单列定义以删除`NOT NULL`使错误发生在下一行。

# php - 在表达式引擎插件中缓存

> ID：11835158
> 
> 赞同：1
> 
> 时间：2012-08-06T20:08:04.263
> 
> 标签：php, performance, codeigniter, caching, expressionengine

我正在构建一个附加组件`ExpressionEngine 2.x`，我想在服务器上缓存一些数据。具体来说，我想缓存解析模板的结果，这样我就不必为同一个请求再次解析它。

目前我正在使用`$_SESSION`，但这只缓存该用户。理想情况下，我想将每个人的缓存存储在内存或磁盘上。我也尝试过`$this->EE->session->cache`，但这只缓存当前请求。我已经查看了 CodeIgnitor 的缓存驱动程序，但我不确定如何在我的 ExpressionEngine 插件中让它工作：http: [//codeigniter.com/user_guide/libraries/caching.html](http://codeigniter.com/user_guide/libraries/caching.html)

我也可以使用`Memcache`或写入文件，但由于它需要在许多不同的设置上工作，所以不能保证会安装 Memcache 或会有任何可写文件夹。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:54:02.703

我曾经重写了部分 CI 缓存机制。也许这对你有任何帮助。它是一个“缓存”一切功能。我把它写成对系统文件的覆盖。

其中有一个使用示例。应该很简单。使用此代码，您可以缓存任何函数结果，甚至在会话/请求之间共享。

[http://codeigniter.com/forums/viewthread/221313/](http://codeigniter.com/forums/viewthread/221313/)

或者这个：

[https://github.com/EllisLab/CodeIgniter/issues/1646](https://github.com/EllisLab/CodeIgniter/issues/1646)

如果您不需要这个新功能，您可以使用它作为如何使用标准 CI 缓存机制的示例。

像这样：

```
class your_class extends CI_Model
{
    // ------------------------------------------------------------------------

    function __construct( )
    {
        $cache_adapter = 'apc';
        $this->load->driver( 'cache', array( 'adapter' => $cache_adapter, 'backup' => 'dummy' ) );
        $this->cache->{$cache_adapter}->is_supported( );
    }

    // ------------------------------------------------------------------------

    public function your_function( $arg )
    {
        $result = $this->cache->get( __CLASS__ . __METHOD__ . serialize( $arg ) );

        if ( empty( $result ) )
        {
            $result = ... /* your calculation here */

            $this->cache->save( __CLASS__ . __METHOD__  . serialize( $arg ) );
        }
        return $result;
    }
} 
```

我用于缓存的键是所谓的重整函数名。如果您的函数的结果完全取决于它的参数（应该如此），您可以按原样使用它。对于密钥的紧凑性，您可以对其进行哈希处理。像这样：

```
 public function your_function( $arg )
    {
        $result = $this->cache->get( md5( __CLASS__ . __METHOD__ . serialize( $arg ) ) );

        if ( empty( $result ) )
        {
            $result = ... /* your calculation here */

            $this->cache->save( md5( __CLASS__ . __METHOD__  . serialize( $arg ) ) );
        }
        return $result;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T01:36:40.277

最简单的方法：指导您的附加组件的用户使用 EE 的本机标签缓存来提高性能。标签缓存适用于每个 EE 标签，与用户无关。

或者，您可以在安装时创建一个数据库表来保存您的缓存数据并使用它。根据您缓存的数据量和类型，它可能会也可能不会产生性能提升。

# c# - Azure DownloadText 和 UploadText C#

> ID：11835160
> 
> 赞同：2
> 
> 时间：2012-08-06T20:08:17.527
> 
> 标签：c#, css, azure, blob

我是 Azure 的新手，遇到了一个奇怪的问题。

我有一个 Web 应用程序，用户能够修改和保存`.css`文件，该文件稍后会包含在页面中。

我通过创建 CloudBlob 实例、调用`.DownloadText()`、下载当前 css、修改它然后再次上传它来做到这一点`.UploadText()`

问题是 css 不会被 Chrome 或 Firefox 解释，但它可以在 Internet Explorer 中工作。这意味着当页面中包含css文件时会下载css文件，我可以使用开发人员工具或Firebug看到更改，但它们不会在页面中应用（但在IE中有效）。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:12:05.257

您是否将内容类型设置为 text/css？

```
blob.Properties.ContentType = @"text/css"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T20:18:00.477

检查响应的内容类型。我想我应该是 text/css

# .htaccess - 允许目录访问某些 IP 地址

> ID：11835163
> 
> 赞同：1
> 
> 时间：2012-08-06T20:08:33.453
> 
> 标签：.htaccess, directory, directory-permissions

我在一个网站上工作，我需要一个对公众禁用的目录。

我想知道是否有一种方法可以将所有用户重定向到网页，除非我指定一些允许进入目录的 IP 地址

我对 .htaccess 文件了解不多，但是我可以用它来做到这一点吗？

谢谢彼得

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T20:12:08.373

您可以使用以下代码简单地做到这一点。

```
order deny,allow
deny from all
allow from x.x.x.x
allow from x.x.x.x
allow from x.x.x.x 
```

使用上述行，保持顺序相同很重要。**在允许来自特定地址之前**拒绝所有人将只允许访问少数 IP，而在拒绝**之前**允许将拒绝对所有人的访问。

有关更多信息，请尝试在 google 中搜索 htaccess 拒绝/允许命令。

# javascript - jQuery 'shake' 函数显示错误

> ID：11835168
> 
> 赞同：0
> 
> 时间：2012-08-06T20:08:53.430
> 
> 标签：javascript, jquery, html, jquery-animate

我在这里建立了一个简单的随机问题生成器：http: [//jsfiddle.net/thevenin/hddMV/](http://jsfiddle.net/thevenin/hddMV/)

出于某种原因，当错误消息出现并在屏幕上晃动时，有时会在显示屏右侧留下一个黑条。此问题随机发生，也随机消失。是什么导致了这个问题？

我为我不专业的编码提前道歉>.<

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:16:19.727

我在chrome中也遇到过这个问题，它似乎是浏览器渲染错误。

这是一个解决方案。那就是打电话

```
$('#background').fadeOut(0,function() {$('#background').fadeIn(0); } ); 
```

动画完成后，将显示刷新为 alt-tab 进出浏览器或更改选项卡会删除该行。

为了使顺序正确，我更改了代码，以便每个动画在前一个完成运行时发生。

[http://jsfiddle.net/hddMV/7/](http://jsfiddle.net/hddMV/7/)

# html - 居中 1 个 div 浮动 th

> ID：11835173
> 
> 赞同：1
> 
> 时间：2012-08-06T20:09:17.273
> 
> 标签：html, css-float, center

我正在尝试学习如何在容器 div 中创建两个 div。我希望容器内的 div 并排放置，一个居中（相对于标题），另一个浮动右侧。

你可以在这里看到：http: [//jsfiddle.net/mariabarrette/KjvZA/3/](http://jsfiddle.net/mariabarrette/KjvZA/3/)

我希望“主” div 位于标题的中心，并希望“侧边栏”向右浮动。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:18:35.327

我认为，如果您将侧边栏 div 放在主 div 之前并设置自动边距，它应该可以正常工作。前提是您有足够的空间将两个 div 都放在封闭的 div 宽度上。请参阅[http://jsfiddle.net/KjvZA/16/](http://jsfiddle.net/KjvZA/16/)（但未注册，因此可能不会持续）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:19:33.873

看起来你已经完成了大部分工作。如果我对您的理解正确，应该这样做：

1.  删除文本对齐：中心；来自“容器” div
2.  SEt header的宽度为：width:285px; （与内容相同）。

那是你想要做的吗？

# asp.net - SSRS - 全局参数

> ID：11835175
> 
> 赞同：1
> 
> 时间：2012-08-06T20:09:38.307
> 
> 标签：asp.net, .net, reporting-services

我在自定义网站上几乎没有不同的报告。顶部有一个菜单栏，其中一个选项卡是报告。如果我将鼠标悬停在该选项卡上，我可以在其下方看到报告列表。单击时有一个单独的“过滤器”按钮弹出一个窗口以设置所有参数，然后单击生成报告以根据参数选择查看报告（默认参数也会生成报告，因此您不必这样做即可查看报告第一次）。现在，我从菜单栏从一份报告转到另一份报告。我必须经历相同的选择参数过程（如果我想更改默认值）并过滤第二份报告的数据。

有没有办法为一个报告设置参数，转到菜单栏/报告选项卡并选择另一个报告，其中参数值与以前的报告相同？

谢谢

* * *

好吧，“我”不一定维护自定义网站。如果我进入 ReportServer 并查看报告，我会在呈现的报告顶部列出所有参数。但是，该网站有一个弹出窗口（可能是javascript？？），您可以在其中拥有所有参数和带有每个参数值的下拉列表...您单击菜单栏下方的“过滤器”按钮并打开它窗口，您可以在其中选择每个参数/层次结构的值，然后单击“生成”，报告将使用过滤后的数据刷新。但是，当我从菜单栏转到不同的报告时，参数重置为一些默认值......我想要那些值与先前生成的报告中的值相同...有帮助吗？

# opencart - 计算 opencart 的零售价格

> ID：11835177
> 
> 赞同：0
> 
> 时间：2012-08-06T20:09:47.260
> 
> 标签：opencart, rounding

也许有人有线索。我想在 opencart 中将零售价格四舍五入到不错的数字。

基本计算为：（应产生 1,50 欧元 - 2,00 欧元 - 2,50 欧元等）

```
 $price = sprintf("%.2f", round($pice * 2) / 2); 
```

我以为我会在 controler/product/product.php 中这样做，但这不起作用。我不想编辑所有主题 .tpl 所以它必须在 opencart 代码中完成。

现在我有了这个，但我得到的价值是 0.49 欧元或 0.99 欧元

```
 $price_new = $this->tax->calculate($result['price'],                        $result['tax_class_id'], $this->config->get('config_tax'));
        $price_new_1 = count($price_new , 2)/2-0.01;
    $price_complete = $this->currency->format($price_new_1);
    $spec_price_new = $this->tax->calculate($result['special'], $result['tax_class_id'], $this->config->get('config_tax'));
    $spec_price_new_1 = round($spec_price_new, 2)/2-0.01;
    $spec_price_complete = $this->currency->format($spec_price_new_1);

    if (($this->config->get('config_customer_price') && $this->customer->isLogged()) || !$this->config->get('config_customer_price')) {
                $price = $price_complete;
            } else {
                $price = false;
            }

            if ((float)$result['special']) {
                $special = $spec_price_complete;
            } else {
                $special = false;
            } 
```

没有导致价格的旧尝试：

```
 if (($this->config->get('config_customer_price') && $this->customer-                     >isLogged()) || !$this->config->get('config_customer_price')) {
           $price = sprintf("%.2f", round($this->currency->format($this-  >tax->calculate($result['price'], $result['tax_class_id'], $this->config-  >get('config_tax'))) * 2) / 2);

        } else {
           $price = false;
        }

        if ((float)$result['special']) {
           $special = sprintf("%.2f", round($this->currency->format($this->tax->calculate($result['special'], $result['tax_class_id'], $this->config->get('config_tax')))* 2) / 2);
        } else {
           $special = false;
        } 
```

我也试过这样：

```
 // round price calculation
        $normaloldprice = $this->currency->format($this->tax- >calculate($product_info['price'], $product_info['tax_class_id'], $this->config->get('config_tax')));
        $newprice = round($normaloldprice * 2)/2;

        $specialoldprice = $this->currency->format($this->tax->calculate($product_info['special'], $product_info['tax_class_id'], $this->config->get('config_tax')));
        $newspecialprice = round($specialoldwprice * 2)/2;

        $oldtaxprice = $this->currency->format((float)$product_info['special'] ? $product_info['special'] :                                                  $product_info['price']);
        $newtaxprice = round($oldtaxprice * 2)/2;
        // end round price calculation

        if (($this->config->get('config_customer_price') &&           $this->customer->isLogged()) || !$this->config->get('config_customer_price')) {
            $this->data['price'] = $newprice;
        } else {
            $this->data['price'] = false;
        }

        if ((float)$product_info['special']) {
            $this->data['special'] = $newspecialprice;
        } else {
            $this->data['special'] = false;
        }

        if ($this->config->get('config_tax')) {
            $this->data['tax'] = $newtaxprice;
        } else {
            $this->data['tax'] = false;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T01:58:59.890

对于一个干净清晰的解决方案，这个模块将满足您的需求。

[http://www.opencart.com/index.php?route=extension/extension/info&extension_id=10351](http://www.opencart.com/index.php?route=extension/extension/info&extension_id=10351)

# java - 套接字连接 - 消息顺序？

> ID：11835182
> 
> 赞同：2
> 
> 时间：2012-08-06T20:10:00.843
> 
> 标签：java, sockets

我正在编写一个套接字连接。服务器和客户端。服务器等待连接，`socket.accept();`然后可以处理所有传入的消息。

到目前为止一切顺利，但我该如何控制这些消息？目前，我只看到例如服务器需要某个消息，而客户端必须发送此消息。这可能是一条`String`信息。但是如果客户端发送另一个消息，例如一个`Integer`？如何让服务器期待不同的消息？并根据参数类型和参数个数，决定执行哪个方法？

或者一个套接字只是用于在客户端和服务器之间以众所周知的顺序交换消息？

特别是我正在寻找像在服务器端提供例如`processInteger`和方法的东西。`getString()`如果我从客户端发送消息，基于这些消息我想执行任何一个或其他方法。我可以通过客户端以某种方式控制消息发送到哪个方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:16:53.567

Unix 风格的套接字（如 Java 所使用的）不呈现传递结构化（“类型化”）数据的[抽象](http://en.wikipedia.org/wiki/Abstraction)。相反，它们代表任意字节流。唯一能说明这一点的是客户端和服务器就如何通信（协议）达成一致。正如您可能从文档中注意到的那样，实际从 Socket 中获取数据的唯一方法是使用 getInputStream()，它允许您读取（），它为您提供单个`byte`或`byte[]`.

例如，如果客户端要发送 a `String`，也许它会将 'str' 作为消息的前三个字节，如果它是 an `Integer`，它是 'int'，或者 'dbl'`Double`等等。如果服务器知道前三个字节表示数据的类型，那么它就能够使用它来确定如何读取消息的其余部分。这是基本上所有网络的基础——客户端和服务器使用相同的“语言”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:20:14.673

Java 教程页面很容易解释它：[Java 教程：套接字](http://docs.oracle.com/javase/tutorial/networking/sockets/index.html)。

您可以发送可序列化对象发送它并在服务器上反序列化。当然，可序列化类必须在客户端和服务器中都定义。

您可以使用 ObjectInputStream 和 ObjectOutputStream 来读取和写入这些对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T20:22:13.293

套接字连接用于传输您想要的任何类型的消息。消息的“原始”字节通过它发送。消息的格式不取决于套接字（字符数据——字符串、整数或其他类型的对象、二进制数据等）；由你决定。消息（请求和响应）的顺序也由您定义。消息格式、顺序和其他行为一起被称为传输和/或消息“协议”。

您可以定义和实现自己的协议，也可以使用现有的协议，或协议的组合，例如 HTTP、RMI、XML、json 等。

祝你好运！汤姆

# visual-c++ - 在 C++ 中比较两个 GUID 是否相等

> ID：11835183
> 
> 赞同：5
> 
> 时间：2012-08-06T20:10:05.590
> 
> 标签：visual-c++, guid, equality

我正在寻找在 C++ 中比较两个 GUID 是否相等的最简单方法。当然，有一个预定义的功能。

该解决方案需要与[Visual C++ 2010](https://en.wikipedia.org/wiki/Visual_C%2B%2B#32-bit_and_64-bit_versions)一起使用。

我说的是 Guiddef.h 中定义的 GUID：

```
typedef struct _GUID {
    unsigned long  Data1;
    unsigned short Data2;
    unsigned short Data3;
    unsigned char  Data4[ 8 ];
} GUID; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-06T20:15:11.133

也许您想要[IsEqualGUID](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680575%28v=vs.85%29.aspx)（它在幕后使用 memcmp）或只是使用`operator==`（它为您调用 IsEqualGUID）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T20:14:17.217

== 运算符是否没有重载来为您执行此操作？或使用[IsEqualGUID](http://msdn.microsoft.com/en-us/library/ms680575%28VS.85%29.aspx)。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2020-09-25T13:29:38.097

Wine 实现在这里：[https ://source.winehq.org/source/dlls/ole32/compobj.c](https://source.winehq.org/source/dlls/ole32/compobj.c)

快速简单明了：

```
 /***********************************************************************
 *           IsEqualGUID [OLE32.@]
 *
 * Compares two Unique Identifiers.
 *
 * PARAMS
 *  rguid1 [I] The first GUID to compare.
 *  rguid2 [I] The other GUID to compare.
 *
 * RETURNS
 *  TRUE if equal
 */
#undef IsEqualGUID 
BOOL WINAPI IsEqualGUID(
    REFGUID rguid1, REFGUID rguid2)  {
  return !memcmp(rguid1, rguid2, sizeof(GUID));
} 
```

这将与任何 Visual Studio 版本一起编译。那也是 C，所以 C++ 爱好者可能会把它包起来`extern "C" { }`

# wpf - C1FlexGrid 宽度

> ID：11835186
> 
> 赞同：2
> 
> 时间：2012-08-06T20:10:11.840
> 
> 标签：wpf, componentone, c1flexgrid

我开始为我的 WPF Caliburn.Micro 应用程序使用 ComponentOne 的 C1FlexGrid。我想知道如何将列设置为最大内容宽度。我尝试将其设为自动，但所有列的宽度仍然相同。

我这样应用 AutoSizeColumns：

```
 protected override void OnViewAttached(object view, object context)
  {
      var View = (FirstDataEntryView)view;
      View.EnrollmentFiles.AutoSizeColumns(0, 4, 5);
  } 
```

但这没有帮助......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T18:00:06.387

由于虚拟化，使用 GridLength.Auto 通常不适用于这些列宽。FlexGrid 有几种方法可以自动调整列的大小，但列必须是可见的，否则它们将不会被计算并且将保持静态宽度。 [这](https://gist.github.com/f5bdb54009b71466d271)是一个**非常**不值得生产的示例，说明如何执行此操作。FWIW 这就是我从不喜欢 ComponentOne 控件的原因——感觉就像它们被困在 WinForms 模式中。

编辑：为特定于 CM 的用法添加一些代码。

```
protected override void OnViewAttached(object view, object context) {
    View = (YourViewType)view;
    View.flexGrid.AutoSizeColumns(0,4,5);
} 
```

至于从视图模型访问视图是否与 MVVM 理论“兼容”——从技术上讲不是，但有时您被迫使用无法通过 XAML 自动配置的控件，并且您不能使用由于某种原因，View 的代码隐藏。

# symfony - symfony 2 path() 方法在哪里定义

> ID：11835189
> 
> 赞同：-1
> 
> 时间：2012-08-06T20:10:21.603
> 
> 标签：symfony

我想看看它是如何工作的。特别是如果它正在对“_”进行分解，或者它正在根据您传入的参数搜索路由以查找等效键。

我搜索了文档、“网络”和我的代码库，但没有太多关于它所在位置的信息。symfony 文档在构建链接时使用它。

```
 {# src/Acme/TaskBundle/Resources/views/Default/new.html.twig #}
    <form action="{{ path('task_new') }}" method="post" {{ form_enctype(form) }}>
        {{ form_widget(form) }}

        <input type="submit" />
    </form> 
```

* * *

看起来它使用了路由文件中的密钥。所以下面的代码：

```
 {{ path('_welcome') }} 
```

将在您的路由中寻找带有“_welcome”键的路由。

yaml

```
 _welcome:
        pattern:   /
        defaults:  { _controller: AcmeDemoBundle:Main:homepage } 
```

php

```
 use Symfony\Component\Routing\RouteCollection;
    use Symfony\Component\Routing\Route;

    $collection = new RouteCollection();
    $collection->add('_welcome', new Route('/', array(
        '_controller' => 'AcmeDemoBundle:Main:homepage',
    )));

    return $collection; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:04:43.603

这是定义在

[https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Twig/Extension/RoutingExtension.php](https://github.com/symfony/symfony/blob/master/src/Symfony/Bridge/Twig/Extension/RoutingExtension.php)

它利用

[https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Routing/Generator/UrlGenerator.php](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Routing/Generator/UrlGenerator.php)

无论如何，我可以确认它没有在“_”上做任何爆炸

# ios - 媒体查询在 iOS 版 Chrome 中无法正常工作

> ID：11835192
> 
> 赞同：4
> 
> 时间：2012-08-06T20:10:35.163
> 
> 标签：ios, google-chrome, css, media-queries

我一直在开发移动优先网站，发现我的媒体查询在 Chrome for iOS 中无法正常工作。似乎无论我使用什么尺寸的设备（iPhone、iPad）和查看它的方向，页面都显示了基线（移动）样式和“481px 以上”样式的混合版本。我上传了一个小的截图画廊（带有描述）来说明这个问题。

[http://imgur.com/a/6Ee7C](http://imgur.com/a/6Ee7C)

[您可以在http://dev.thesmackpack.com](http://dev.thesmackpack.com)上看到该页面。CSS 是未缩小的，以防您可以通过在其中四处寻找任何东西来学习。媒体查询在我测试过的所有其他浏览器中都能正常工作，只有 Chrome for iOS 给我这些问题。

编辑：它似乎在我发现要测试的其他一些设备上运行良好。但是我无法在我的 iPhone 和 iPad 上让它成为 UN-break，而这些是我正在开发网站的设备，所以问题仍然是一个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T21:33:30.000

看起来 chrome 只是不会放开它的缓存。我尝试删除缓存、历史记录等。没有影响。重新安装应用程序并加载所有正确的样式。看起来他们有一些错误要修复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T20:20:26.357

尝试用分号分隔您的视口元数据

`<meta name="viewport" content="width=device-width; initial-scale=1.0">`

如果失败，您可能需要限制缩放

```
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;"> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T14:27:16.040

不幸的是，这个问题似乎已经神奇地解决了。我认为这可能与 Chrome 的“请求桌面站点”功能有关，但我并不肯定。希望我对未来的问题有一些更好的建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T18:14:13.827

确保您没有复制粘贴太多`@media`单词，例如

```
@media screen and (max-width: 1200px), @media screen and (max-device-width: 1200px), @media screen and (max-height: 720px), @media screen and (max-device-height: 720px){
  ...
} 
```

一开始应该只有一个`@media`！这是很常见的错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-16T06:14:52.783

不确定这是否有帮助，但我发现我的样式表在 Chrome iOS 中中断了一半（但在我尝试过的所有其他浏览器和设备上都可以正常工作，包括媒体查询），直到我将头部标签中的样式表链接设为完整的 url - " http://www.directory/style.css”，而不仅仅是相对文件路径（“/style.css”，或其他）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-24T01:10:01.633

我遇到了类似的问题。@Nick Simpson-Deeks 回答对我有用（样式表的完整 URL 路径）。同样有效的是将媒体查询放在单独的样式表中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-01T00:29:23.010

问题不在于单独文件中的@media css。移动 chrome 缓存像疯了一样，它看起来像你通过将它移动到不同的工作表来修复它的原因是因为 chrome 认为它是新的并且还没有缓存它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-24T19:03:21.957

首先 ！**确保您的浏览器在没有任何缩放的情况下 100% 显示页面。**如果它放大它会搞乱所有的媒体查询计算:)

# ruby - 如何使用 ruby 日期常量 GREGORIAN、JULIAN、ENGLAND 甚至 ITALY

> ID：11835193
> 
> 赞同：0
> 
> 时间：2012-08-06T20:10:34.617
> 
> 标签：ruby, datetime, date, time, julian-date

'因为大写，它们是常量。

我在学习 ruby​​ 的 Date 助手时很开心。

```
1.9.3p125 :057 > Date::ABBR_MONTHNAMES
 => [nil, "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"] 
1.9.3p125 :058 > Date::ABBR_DAYNAMES
 => ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"] 
1.9.3p125 :059 > Date::MONTHNAMES
 => [nil, "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"] 
1.9.3p125 :060 > Date::DAYNAMES
 => ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"] 
1.9.3p125 :070 > Date::MONTHNAMES[Time.new.month]
=> "August" 
```

好玩的东西！但是 GREGORIAN、JULIAN、ENGLAND 和 ITALY (!) 常量呢？它们有什么用/我如何使用它们？我可以输出：

```
1.9.3p125 :061 > Date::GREGORIAN
 => -Infinity 
1.9.3p125 :062 > Date::JULIAN
 => Infinity 
1.9.3p125 :063 > Date::ENGLAND
 => 2361222 
```

或者

```
1.9.3p125 :067 > Date.new
 => #<Date: -4712-01-01 ((0j,0s,0n),+0s,2299161j)> 
1.9.3p125 :068 > Date.new.new_start(Date::JULIAN)
 => #<Date: -4712-01-01 ((0j,0s,0n),+0s,Infj)> 
1.9.3p125 :069 > Date.new.new_start(Date::ENGLAND)
 => #<Date: -4712-01-01 ((0j,0s,0n),+0s,2361222j)> 
```

从下面看起来，朱利安是一个差了几天的日历。我记得几个世纪前了解了日历重置，所以这是有道理的，但是英格兰和意大利以及它们将如何使用对我来说仍然不清楚。

```
1.9.3p125 :076 > Date.new(1977,7,1).new_start(Date::ENGLAND)
 => #<Date: 1977-07-01 ((2443326j,0s,0n),+0s,2361222j)> 
1.9.3p125 :077 > Date.new(1977,7,1).new_start(Date::ITALY)
 => #<Date: 1977-07-01 ((2443326j,0s,0n),+0s,2299161j)> 
1.9.3p125 :078 > Date.new(1977,7,1).new_start(Date::JULIAN)
 => #<Date: 1977-06-18 ((2443326j,0s,0n),+0s,Infj)> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-06-29T02:30:41.133

在西方世界，通常使用年、月和日来表示日期。如果我们日历的定义在过去没有改变，这将是表达历史上任何一天的完美方式。

我们今天所知道的日历是由 Julius Cesar 引入的，因此被称为儒略历。不幸的是，它有一个小缺陷：儒略历使用每四年闰年的概念来弥补一年不是正好有 365 天而是大约 365.25 天这一事实。然而这并不完全正确。一年实际上要短一些，如果你每四年添加一个闰年，这个错误将累积数百年，迟早你会失去一整天。

今天我们每四年有一个闰年，但如果一年可以被 100 整除，除非它也可以被 1000 整除，否则闰年不会。这样做大约是一年 365.2425 天。改革被称为格里高利历，是由教皇格里高利十三世提出的。更复杂的是，公历并不是同时在每个国家推出的。如果没有这个开关，儒略历到今天已经关闭了 13 天。

在 Ruby 中创建 Date 对象时，可以使用以下四个常量之一：

```
Date.new(2019, 6, 29, Date::ITALY)
Date.new(2019, 6, 29, Date::ENGLAND)
Date.new(2019, 6, 29, Date::GREGORIAN)
Date.new(2019, 6, 29, Date::JULIAN) 
```

如果您使用`Date::ITALY`（如果您根本没有指定任何内容，这是默认设置），则 1582-10-15 之前的日期将被解释为儒略历的日期，所有其他日期都被解释为公历的日期。1582-10-15 是意大利引入公历的日期。

如果使用`Date::ENGLAND`，则 1752-09-14 之前的日期被解释为儒略历的日期，所有其他日期被解释为公历的日期。1752-09-14 是大英帝国以及美洲殖民地引入公历的日期。

如果使用`Date::GREGORIAN`，则 Date 对象的行为就像公历一直存在，无论是哪个日期。所有日期，甚至改革之前的日期都被解释为公历日期。

如果您使用`Date::JULIAN`，则 Date 对象将表现得好像此日期重组从未存在过一样。所有日期均根据儒略历进行解释。

什么是正确的值？好吧，没有。如果您不想处理历史日期，则除此之外的任何值`Date::JULIAN`都可以。如果您需要处理历史日期，您需要知道这些日期指的是哪个日历。

最后，除了传递这些常量之一，您还可以传递一个整数值，该整数值被解释为切换到公历的儒略日数。这很有用，因为某些国家/地区在不同的日期切换，没有任何可用的常数表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-04T01:44:42.240

您可以进入 ext/date/date_core.c 并获取那里的值。它们是常量，是的，但您问如何使用它们。你的问题应该是如何提取它们。给定用于创建所需时间和日期的数据，用于计算 Date 和 DateTime 对象。

例如，这将是一个具有特定值的元素。

```
#<DateTime: 2017-01-06T12:05:55+00:00 ((2457760j,43555s,553855002n),+0s,2299161j)> 
```

注意到所有的部分了吗？其中两个在数字后有 j。计算这些是这些常量的用途，并且是类对象的一部分。有许多使用它们的方法和许多类型。一个很好的阅读是维基百科上的朱利安日。查看所有这些不同值的表格。历史也很有趣，因为它们与[迈克尔](https://stackoverflow.com/users/220147/michael-kohl)提到的内容有关。

至于您为其中两个返回的值，请注意它们也是类。这也很奇怪，因为这与您的系统可以在时间上向前或向后多远处理数字有关。

[无穷](https://en.wikipedia.org/wiki/Infinity#Computing)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-06T21:04:14.277

所有常量都在[文档](http://ruby-doc.org/stdlib-1.9.3/libdoc/date/rdoc/Date.html#method-i-italy)中进行了解释。根据经验，如果以下解释对您没有任何意义，您可能根本不需要担心这些常量。

> ENGLAND 英格兰及其殖民地历法改革日的儒略日编号。
> 
> GREGORIAN 公历改革日期的儒略日数
> 
> ITALY 意大利和一些天主教国家历法改革日的儒略日编号。
> 
> JULIAN 预测儒略历的历法改革日期的儒略日数

以下是有关不同日历系统的更多信息：

*   [http://en.wikipedia.org/wiki/Julian_calendar](http://en.wikipedia.org/wiki/Julian_calendar)
*   [http://en.wikipedia.org/wiki/Gregorian_calendar](http://en.wikipedia.org/wiki/Gregorian_calendar)

# java - 连接错误 JPA 和 named_queries xml 的预期路径

> ID：11835195
> 
> 赞同：0
> 
> 时间：2012-08-06T20:10:39.793
> 
> 标签：java, hibernate, jpa

由于这个错误，我对 JPA 和 Hibernate 感到非常困惑。

这是堆栈异常

```
2012-08-07 03:55:04,277 ERROR [org.hibernate.hql.PARSER] (HDScanner)  Path expected for join!
2012-08-07 03:55:04,299 ERROR [org.hibernate.impl.SessionFactoryImpl] (HDScanner) Error in named query: getTotalCallReportsFromQuarter
org.hibernate.QueryException: Unable to resolve path [care.quarter], unexpected token [care] [SELECT count(noOfCallReports) FROM com.business.model.base.CareCallReport JOIN Relationships with CareCallReport.clientAccountNo=Relationships.clientAccountNo where UID = :UID and care.quarter = :quarter and care.year = :year] 
```

这是我计划加入的两个实体：

```
CareCallReport.java
@Entity
@Table(name = "CARE_CALLREPORT")
public class ICareCallReport implements Serializable {

    private static final long serialVersionUID = 1L;

    @Id
    @Column(name = "ClientAccountNo", nullable = false, length = 7)
    private String clientAccountNo;

    @Column(name = "NoOfCallReports", nullable = false, length = 11)
    private int noOfCallReports;

    @Column(name = "Quarter", nullable = false, length = 11)
    private int quarter;

    @Column(name = "QtrYear", nullable = false, length = 4)
    private int year;

    ... Getters and Setters 
```

和另一个实体

```
ITRelationships.java
@Entity
@Table(name = "IT_RELATIONSHIPS")
public class ITRelationships implements Serializable {

    @Id
    @Column(name = "ClientID",nullable = false, length = 7)
    private String clientID;

    @Column(name = "ClientAccountNo", nullable = false, length = 7)
    private String clientAccountNo;

    @Id
    @Column(name = "UID", nullable = false, length = 6)
    private String UID;

    @Column(name = "Quarter", nullable = false, length = 11)
    private int quarter;

    @Column(name = "QtrYear", nullable = false, length = 4)
    private int year;

    Getters and Setters 
```

我写的 JQL 方法是这样的：

```
<access>FIELD</access>
<named-query name="getTotalCallReportsFromQuarter">
    <query>
        <![CDATA[
        SELECT count(noOfCallReports)
        FROM CareCallReport JOIN ITRelationships
        with CareCallReport.clientAccountNo = ITRelationships.clientAccountNo
        where UID = :uid
            and care.quarter = :quarter
            and care.year = :year
        ]]> 
    </query>
</named-query> 
```

我做错了什么？这是我第一次接触 JPA。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:27:50.267

您在查询 ( `icare`) 中使用别名但未定义它。此外，只有在实体之间存在关联（OneToOne、OneToMany、ManyToOne 或 ManyToMany）时，才能进行连接。假设你没有，查询应该是

```
SELECT count(care.noOfCallReports)
    FROM CareCallReport care, ITRelationships relationship
    where relationship.UID = :uid
        and care.quarter = :quarter
        and care.year = :year
        and care.clientAccountNo = relationship.clientAccountNo 
```

HQL 和关联在[Hibernate 文档](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#queryhql-joins)中有很好的描述。阅读。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T20:49:10.720

您似乎忘记在查询中使用别名。

但我还是想再解释一下。使用 JPA/Hibernate，您不仅可以将 DB 中的表映射到 POJO（实体），还可以映射关系。

如果我理解正确的话，从 IT_RELATIONSHIPS 到 CARE_CALLREPORT 是一对一的关系。在面向对象的术语中，ITRelationships 引用了 ICareCallReport。

此外，ClientAccountNo 实际上不是 IT_RELATIONSHIPS 实体的属性，它只是对 CARE_CALLREPORT 实体的引用。

```
ITRelationships.java
@Entity
@Table(name = "IT_RELATIONSHIPS")
public class ITRelationships implements Serializable {

    @Id
    @Column(name = "ClientID",nullable = false, length = 7)
    private String clientID;

    @OneToOne
    @JoinColumn(name="ClientAccountNo")
    private ICareCallReport careCallReport;

    .... 
```

现在查询变得简单多了。记住这不是 SQL，这是对象查询。

```
 <named-query name="getTotalCallReportsFromQuarter">
    <query>
        <![CDATA[
        SELECT itr.careCallReport.noOfCallReports
        FROM ITRelationships itr
        where itr.UID = :uid
            and itr.careCallReport.quarter = :quarter
            and itr.careCallReport.year = :year
        ]]> 
    </query>
    </named-query> 
```

# c++ - 在 Visual Studio 2010 中设置 OGRE

> ID：11835201
> 
> 赞同：0
> 
> 时间：2012-08-06T20:10:59.607
> 
> 标签：c++, visual-studio-2010, ogre

使用[本](http://www.ogre3d.org/tikiwiki/tiki-index.php?page=Setting%20Up%20An%20Application%20-%20Visual%20Studio)教程，我设法安装和设置（至少部分）食人魔。唯一的问题似乎是 VS 找不到 OGRE 包含文件 (.h)。

C/C++ - 常规 - 其他包含目录如下所示：

```
$(OGRE_HOME)\include
$(OGRE_HOME)\include\OGRE
$(OGRE_HOME)\include\OIS
$(OGRE_HOME)\include\Samples\Common\include
$(OGRE_HOME)\include\boost 
```

我也试过跑步

```
notepad.exe "%OGRE_HOME%\include\OGRE\OgreCamera.h" 
```

检查 OGRE_HOME 是否设置正确。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T08:13:01.227

在 VS 设置中，您需要在其他目录中添加指向 OGRE 包含的包含目录。我是从头顶写的，所以我不记得确切的位置，但我相信你会找到它。

如果您仍然有问题，我可以在我回到家时检查确切的位置。

AFAIK：OGRE_HOME 适用于命令行工具和编译器，但不适用于 VS 本身。

# jquery - jQuery、Twitter 引导程序：如何根据操作生成警报（和文本）？

> ID：11835202
> 
> 赞同：1
> 
> 时间：2012-08-06T20:11:05.367
> 
> 标签：jquery

这是我的警报 html

```
<div id="feature" class="feature">
    <div id="alerts">
    </div>
    # other html data
</div> 
```

这是我的`Ajax`电话

```
 // send the data to the server using .ajax() or .post()
        $.ajax({
            type: 'POST',
            url: 'addVideo',
            data: {
                video_title: title,
                playlist_name: playlist,
                url: id,
                success: notify('success', 'saved!')
                error: notify('failure', 'not saved!')
            }, 
```

这是`notify`函数的外观

```
function notify(notify_type, msg) {
    var alerts = $('#alerts');
    alerts.append('<a class="close" data-dismiss="alert" href="#">×</a>');
    if (notify_type == 'success') {
      alerts.addClass('alert alerts-success').fadeIn('fast');
    }
    if (notify_type == 'failure') {
      alerts.addClass('alert alerts-error').fadeIn('fast');
    }
} 
```

我在这里使用参考 - [http://twitter.github.com/bootstrap/components.html#alerts](http://twitter.github.com/bootstrap/components.html#alerts) 当我在 Firebug 上调试时，我看到**没有找到选择器的元素：“#alerts”** 虽然我可以看到 div视图源代码中的标签，一定有什么问题？

**需要** - 根据响应，我想自动在文本中插入适当的警报

我正在学习 jQuery，我确信这有错误，但无法理解失败的地方

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:15:03.740

您的函数中有一些错误`ajax`，您已将`success`函数放在对象中并错过了 a `)`，请尝试以下操作：

```
 $.ajax({
        type: 'POST',
        url: 'addVideo',
        data: {
            video_title: title,
            playlist_name: playlist,
            url: id },
        success: notify('success', 'saved!'),
        error: notify('failure', 'not saved!')
        }) 
```

# ssl - openssl ssl_connect 永远阻塞 - 如何设置超时？

> ID：11835203
> 
> 赞同：14
> 
> 时间：2012-08-06T20:11:19.527
> 
> 标签：ssl, openssl

当用 openssl 编写的服务器没有调用 SSL_accept 时，客户端的 SSL_connect 将永远阻塞。openssl -SSL_CTX_set_timeout , SSL_SESSION_set_timeout 中有一些超时功能，但这些对 SSL_connect 没有影响。

当例如 ssl 服务器出现故障并在进行 SSL 握手之前进入循环时，真的没有办法为 SSL_connect 设置超时吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-08T10:30:09.923

OpenSSL 库在处理套接字相关问题方面为您提供了最大的灵活性。您的情况下的`SSL_connect`块，因为您必须将它与阻塞套接字一起使用。请与非阻塞套接字一起使用，在这种情况下它将返回 -1。如果你调用`SSL_get_error`函数，这将给你`SSL_ERROR_WANT_READ`或`SSL_ERROR_WANT_WRITE`错误取决于 tcp recv 或 send 分别无法完成操作。

当获得`SSL_ERROR_WANT_WRITE`/时`SSL_ERROR_WANT_READ`，您必须通过将套接字传递给适当`fd_set`的和超时来调用 select 函数。如果选择超时，您可以认为您`SSL_connect`已经超时。

**注意：**`SSL_SESSION_set_timeout`用于设置与 SSL 恢复相关的会话超时值 。它们与超时连接无关。

下面的链接应该对您有所帮助（尤其是第二个链接，第 6 节讨论多路复用 I/O）：

*   [第1部分](https://github.com/smbutton/DataCommProject/blob/master/openssl-examples-20020110/openssl-examples-20020110/part1.pdf)
*   [第2部分](https://github.com/smbutton/DataCommProject/blob/master/openssl-examples-20020110/openssl-examples-20020110/part2.pdf)

# iphone - 从自身移除 KVO

> ID：11835208
> 
> 赞同：0
> 
> 时间：2012-08-06T20:11:39.343
> 
> 标签：iphone, key-value-observing

我正在为我的 NSOperationQueue 注册回调，如下所示：

```
[self.queue addObserver:self forKeyPath:@"operationCount" options:NSKeyValueObservingOptionNew context:NULL]; 
```

因为我有一个用于长任务的过期处理程序，所以我在 operationCount 的回调中执行此操作。我基本上是在队列中的 NSOperation 完成后尝试保存状态，然后稍后恢复。所以我这样做：

```
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
    if ([keyPath isEqualToString:@"operationCount"]) {
        NSNumber *num = [change objectForKey:NSKeyValueChangeNewKey];
        self.progress = (1.0 - (double)[num integerValue] / self.totalPackets);

        if ([UIApplication sharedApplication].backgroundTimeRemaining <= MIN_BACKGROUND_TIME) {
            // Background time is almost up, save the state and resume later
            NSLog(@"running out of time");
            [self.queue cancelAllOperations];
            [self.queue removeObserver:self forKeyPath:@"operationCount" context:NULL];

            if (self.patientProcessingTaskID != UIBackgroundTaskInvalid) {
                [[UIApplication sharedApplication] endBackgroundTask:self.patientProcessingTaskID];
                self.patientProcessingTaskID = UIBackgroundTaskInvalid;
            }
        }

        if (self.queue.operationCount == 0) {
            NSLog(@"no more operations");
            [self.queue removeObserver:self forKeyPath:@"operationCount" context:NULL];

            if (self.patientProcessingTaskID != UIBackgroundTaskInvalid) {
                [[UIApplication sharedApplication] endBackgroundTask:self.patientProcessingTaskID];
                self.patientProcessingTaskID = UIBackgroundTaskInvalid;
            }
        }
    }
} 
```

它不像我预期的那样工作。我单步执行代码，我看到 [self.queue removeObserver:..] 开始运行。但是，我仍然最终在我的 obserValueForKeyPath: 方法中得到一个回调，我不确定为什么（假设我将自己作为 self.queue 的观察者删除了。我是否正确删除了 self？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-03T19:34:03.667

你确定你只打`-addObserver:...`一次？如果您`-addObserver:...`多次调用，您将收到多个回调，`-observeValueForKeyPath:...`并且您必须`-removeObserver:`为每次调用调用一次`-addObserver:...`才能停止接收回调。

我在这里也看到了另一个问题；以我的经验，调用`addObserver:...`or `removeObserver:...`in `observeValueForKeyPath:...`（对于相同的 keyPath）是一个麻烦的秘诀。您尚未发布带有“确凿证据”堆栈框架的崩溃跟踪，但是在通知期间添加和删除相同关键路径的观察者可能会导致间歇性崩溃。我凭经验观察到，通知给定属性的观察者的顺序是不确定的，因此即使在通知处理程序中添加或删除观察者有时有效，它也可能在不同情况下任意失败。（我假设在 KVO 的内部某个地方有一个无序的数据结构，它可以以不同的顺序枚举，可能基于指针的数值或类似的任意值。）

您可以使用 GCD 或`-performSelector:withObject:afterDelay:`在 runloop 的当前迭代完成后删除您的观察。但是，这并不能保证您不会再收到任何通知，因此如果您需要该保证，则必须针对这种情况构建一个侦听器状态检查。

最后，请为所有 KVO 遵守使用上下文。有关详细信息，请参阅我在[此处](https://stackoverflow.com/questions/12719864/best-practices-for-context-parameter-in-addobserver-kvo/14162363#14162363)发布的说明。

# java - 如何将 maven 版本从 3.XX 降级到 2.2.1？

> ID：11835211
> 
> 赞同：1
> 
> 时间：2012-08-06T20:11:54.547
> 
> 标签：java, maven, pom.xml

我在构建一个需要 maven 2.2.1 才能构建的项目时遇到了麻烦。如何降级 maven 版本？

编辑：更多信息

我正在尝试从命令行构建项目。我正在本地构建这个。我目前安装了 3.0.4 版本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T20:28:36.643

您可以安装多个版本的 Maven。您没有提供很多其他必要的信息 - 例如您的意思是在您的构建环境中还是在您的本地机器上。

如果您的本地机器（我假设）是指在 eclipse（或其他 IDE）中还是从命令行。从命令行，我很确定您需要做的就是重新定义 MAVEN_HOME。在 Eclipse 中，您可以转到 Preferences->Maven->Installations。单击添加按钮并放入您的 2.2.1 安装，然后单击它作为默认设置并尝试以这种方式构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T07:30:07.120

可能发生的问题是在报告领域。其他事情应该没有任何问题。

# django - 如何为使用选项定义的模型字段创建 html 下拉/选择菜单（Django）

> ID：11835212
> 
> 赞同：1
> 
> 时间：2012-08-06T20:11:55.623
> 
> 标签：django, django-models, django-forms, django-templates

我在 Django 中有以下模型：

```
class Product(models.Model):
  CONDITION_CHOICES = (
   ('N', 'New'),
   ('UN', 'Used - Like New'),
   ('UV', 'Used - Very Good'),
   ('UG', 'Used - Good'),
   ('UA', 'Used - Acceptable'),
 )
 condition = models.CharField(max_length=3, choices=CONDITION_CHOICES) 
```

我打算从这个模型中创建一个表单：

```
class MattressForm(ModelForm):
  class Meta:
    model = Product 
```

最终结果（在模板/html 中）将是一个下拉/选择菜单，用户可以在其中选择一个选项。

我不知道如何为这个特定选项编写 html。我不想使用像 {{ form.as_p }} 等综合标签，因为我打算自己自定义表单中的每个字段。

有谁知道如何为这种类型的模型字段创建下拉/选择菜单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:24:04.573

`CharField`应该是`ChoiceField`一个.

创建一个表格：

```
condition = models.ChoiceField(max_length=3, choices=CONDITION_CHOICES) 
```

# .net - VS编码时看到库，构建时找不到

> ID：11835213
> 
> 赞同：0
> 
> 时间：2012-08-06T20:11:58.837
> 
> 标签：.net, fluent-nhibernate

我有一个应用程序，它的主窗体必须注入两个存储库，用于它必须使用的几个数据库。这两个存储库都位于同一解决方案中的 MyApp.Persistence 项目中，并且都位于“MyApp.Persistence”命名空间中。Visual Studio（至少是 ReSharper）知道引用是有效的，并且可以将我从构造函数的使用带到构造函数的定义，并且不会标记任何错误。对象浏览器还看到 MyApp.Persistence 具有同名的命名空间，在其下是存储库。

但是，在构建解决方案时，我收到一个编译错误，提示“名称空间 'MyApp' 中不存在类型或名称空间名称 'Persistence'（您是否缺少程序集引用？）”。完全重建并不能解决它。重新启动VS并不能解决它。删除并重新添加引用并不能解决它。给出此错误的项目有很多其他对其他没有错误的解决方案项目的引用。帮助？

**PS：**一件事；虽然 IDE 不会在构造函数的使用上给出内联错误，但它也不会像通常对类型名称使用所做的那样对类型名称进行颜色编码为蓝色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:47:29.130

找到了。主应用程序项目已设置为使用 .NET 4 Client Profile 构建，但持久性库使用完整的 V4 框架。希望这种情况有一个更好的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:20:59.807

首先要尝试的是删除 bin/obj 文件夹下的所有文件。
其次是查看文件是否没有被您的其他操作破坏。查看 bin/debug 中的内容。

# javascript - 是否有取消 window.onbeforeunload 的回调

> ID：11835217
> 
> 赞同：32
> 
> 时间：2012-08-06T20:12:09.350
> 
> 标签：javascript

我没有这方面的实际用例，但我很好奇，如果用户在触发 window.onbeforeunload 时点击“留在此页面上”，是否有办法做出反应（回调）。

[http://jsfiddle.net/rWHU9/](http://jsfiddle.net/rWHU9/)

```
function warning(){
    if(true){
      console.log('leaving');
      return "You are leaving the page";
    }
}
window.onbeforeunload = warning;​ 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-08-06T20:24:14.823

留在页面没有回调，但离开页面有回调，`window.unload`.

尝试在 中设置超时`beforeunload`，然后在卸载中清除它。如果你留下，超时将运行，否则将被清除。

```
var timeout;

function warning() {
    timeout = setTimeout(function() {
        alert('You stayed');
    }, 1000);
    return "You are leaving the page";
}

function noTimeout() {
    clearTimeout(timeout);
}

window.onbeforeunload = warning;
window.unload = noTimeout;​ 
```

演示：http: [//jsfiddle.net/aPwfz/1/](http://jsfiddle.net/aPwfz/1/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-06T20:21:43.077

简短的回答：不，目前还没有回调或任何*直接*的方法来拦截“留在此页面上”事件。

但是，您可以稍微作弊并创建如下构造：

```
function warning() {
    setTimeout(function() {
        setTimeout(function() {
            alert('user choosed to stay on this site: ' + location.href);
        }, 100);
    },1);
    return "You are leaving the page";
}
window.onbeforeunload = warning;​ 
```

由于问题是*模态对话框*，因此在`setTimeout`您确认该模态框之前不会触发回调。但正如您现在正确假设的那样，如果您单击“离开此站点”，这也会触发。所以这很棘手。要解决这个问题，您需要增加`setTimeout`以使浏览器有足够的时间访问`unload`该页面。

为什么会有两个`setTimeout()`的嵌套？好吧，一旦弹出模式对话框，计时器就会“运行”。所以我们不想在模式对话框关闭之前运行那个计时器。一旦发生这种情况，我们的内在`setTimeout`就会随着时间的推移启动并做一些事情。

我认为大多数现实世界场景的现实价值是关于`2.000`内部的 ms`setTimeout`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-06T20:20:25.277

告诉用户单击取消的唯一方法是触发 a`setTimeout`并查看它是否触发。没有办法从系统的`confirm`-esque 框中询问返回。

[http://jsfiddle.net/rWHU9/2/](http://jsfiddle.net/rWHU9/2/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-13T05:23:02.157

在返回“这里的问题”之前，尝试触发 setTimeout 作为第一个调用任何其他函数的代码（比如 5-10 秒）。IE

```
window.onbeforeunload = confirmExit;
function confirmExit() {
    setTimeout("thisFunction;", 10000);
    return "do you realy want to close?";
} 
```

并取消 onbeforeclose 这对我有用：尝试一个空函数：

```
window.onbeforeunload = function(){}; 
```

谢谢，祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-19T11:36:09.993

```
$(window).bind('beforeunload', function(){
     return '\n Your custom message';
 }); 
```

附加了'beforeunload'事件，当你关闭页面，点击返回按钮或重新加载页面时，一个确认框会提示你是否真的想去，选择确定退出页面：取消停止页面退出并停留在同一页面上。

# extjs4.1 - 如何获取正在扩展的类的名称

> ID：11835218
> 
> 赞同：5
> 
> 时间：2012-08-06T20:12:08.593
> 
> 标签：extjs4.1, extjs-mvc

我有几个扩展 AbstractFormGrid 的网格。拥有一个对象（可能是网格或不是网格）如何检查该对象是否扩展了 AbstractFormGrid。我设法使用 Ext.getName(object) 或 object.self.getName() 获取对象类名称，但我无法获取“父”类。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-06T21:34:49.653

该属性`this.superclass`将返回父类。

正如你提到的，这很有效：

```
Ext.getClass(object).superclass.self.getName() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-28T12:36:21.850

更直接的方法是使用私有属性 $className：

```
object.superclass.$className 
```

每个类都从 Ext.Base 继承这个属性

# spring - maven缺少工件烦人的错误

> ID：11835221
> 
> 赞同：-1
> 
> 时间：2012-08-06T20:12:40.410
> 
> 标签：spring, hibernate, maven, myeclipse

为什么 maven 总是给我这个愚蠢的错误？

```
06/08/12 22.06.39 CEST: Missing artifact javassist:javassist:jar:3.9.0:compile 
```

我还尝试在 pom.xml 中手动添加依赖项，但仍然出现此错误....我在 spring 8.6 中使用 myeclipse 有时当我将休眠性质添加到我的项目时会发生这种情况，有时什么都不碰，有时会添加 rcp依赖关系，ecc ecc

我真的想离开这种有问题的构建插件：|

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T04:27:04.380

`stupid`这个错误没有任何问题。Maven Central 中没有版本`3.9.0`。我能看到的最接近的是[3.9.0.GA](http://search.maven.org/#artifactdetails%7Cjavassist%7Cjavassist%7C3.9.0.GA%7Cjar)

# c++ - 如何在 C++ 中使用字符串修饰符创建新字符串？

> ID：11835224
> 
> 赞同：0
> 
> 时间：2012-08-06T20:12:48.713
> 
> 标签：c++, string, writetofile

我想以某种格式将时间戳写入文件。

有没有办法使用修饰符创建一个新字符串（参见下面的 printf 代码）？还是有另一种方法可以在 TextStream 中使用字符串修饰符？

```
printf("%02d-%02d-%02d_%02d:%02d:%02d.%02d\n", 
       st.wYear, st.wMonth, st.wDay, st.wHour, st.wMinute, st.wSecond, st.wMilliseconds); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T20:19:08.633

一种类型安全的替代方案，无需担心缓冲区大小，将直接在输出流上或在以下位置使用[IO 操纵器](http://en.cppreference.com/w/cpp/io/manip)[`std::ostringstream`](http://en.cppreference.com/w/cpp/io/basic_ostringstream)：

```
#include <iostream>
#include <string>
#include <sstream>
#include <iomanip>

int main()
{
    std::ostringstream s;
    s << std::setfill('0')
      << std::setw(2) << 1 << ':' // st.wYear, etc
      << std::setw(2) << 97 << ':'
      << std::setw(2) << 4;

    std::cout << s.str() << "\n";

    return 0;
} 
```

* * *

此外，先前的答案说明了`int`进入 a 的方法`std::string`：[将 int 附加到 std::string](https://stackoverflow.com/questions/10516196/append-an-int-to-a-stdstring/10516313#10516313)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T20:14:56.467

如果你使用[`sprintf`](http://www.cplusplus.com/reference/clibrary/cstdio/sprintf/)而不是`printf`，你想要的字符串被写入`char`缓冲区而不是打印。

```
sprintf(buffer, "%02d-%02d-%02d_%02d:%02d:%02d.%02d\n", 
        st.wYear, st.wMonth, st.wDay, st.wHour, st.wMinute, st.wSecond, st.wMilliseconds); 
```

您还可以使用[Boost 格式库](http://www.boost.org/doc/libs/1_42_0/libs/format/doc/format.html)。

# c++ - 程序跳过 cin.getline()

> ID：11835226
> 
> 赞同：5
> 
> 时间：2012-08-06T20:13:04.003
> 
> 标签：c++, arrays, string, character-arrays

我制作了这个程序，它可以获取用户的地址、姓名和工作。然后它将所有内容放入一个字符串并输出该字符串。（我知道有更好的方法来做到这一点）

```
char str[600];
char adrs[200];
char name[10];
char wrk[200];
cout<<"Enter your name and press ENTER: ";
cin.getline(name,10);
cout<<"\nEnter your adress and press ENTER:";
cin.getline(adrs,200);
cout<<"\nEnter your workplace and press ENTER:";
cin.getline(wrk,200);
strcpy(str,"My name is ");
strcat(str,name);
strcat(str,"\nand i live at ");
strcat(str,adrs);
strcat(str, "\nI also work at ");
strcat(str, wrk); strcat(str, "\n\n");
cout<<str<<endl; 
```

在这里，当我写一个超过 10 个字符的名称时，该程序确实采用了用户输入的前 9 个字符，但之后它会跳过`cin.getline()`程序中的所有下一个字符，然后转到输出`str`并结束程序。

为什么会发生这种情况以及如何解决？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T20:24:51.927

每次使用 cin 时，它都会将输入的每个字符存储在内存中，直到遇到换行符。这块内存称为输入缓冲区。您第一次调用`cin.getline()`请求一个包含 10 个字符的字符串，包括终止 NULL 字符。但是，cin 很高兴地读取用户键入的字符，直到他按下 Enter 键。如果用户键入的字符超过 9 个，则将`cin`剩余的字符存储在输入缓冲区中，并在以后的输入操作中使用它们。例如，如果用户键入 15 个字符，则调用`cin.getline()`将前 9 个字符存储在 c-string 数组中。再次调用`cin.getline()`将继续读取已输入的剩余部分。

要解决此问题，您应该使用[`cin.ignore()`](http://en.cppreference.com/w/cpp/io/basic_istream/ignore)跳过此换行符。我强烈建议您熟悉 C++ 库的在线参考。我最喜欢的两个是[http://www.cplusplus.com](http://www.cplusplus.com)和[http://www.cppreference.com](http://www.cppreference.com)。

**编辑：**为了使我的答案完整，我还需要添加`cin.getline()`如果输入缓冲区中的字符多于请求的字符，将设置失败位。在`cin`用于任何其他输入操作之前，您必须调用`cin.clear()`以清除失败位。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T15:06:00.187

当读取过长的字符串时，`ios_base::failbit`为流设置 ，并且针对流的所有后续操作都将失败。您需要使用以下命令重置故障[`ios::clear`](http://www.cplusplus.com/reference/iostream/ios/clear/)：

```
if (cin.fail())
    cin.clear(); 
```

清除错误后，您可能希望忽略该行的其余部分[`istream::ignore`](http://www.cplusplus.com/reference/iostream/istream/ignore/)。

**编辑：**我需要一个有用的提示来弄清楚如何`ignore`正确使用。这是完整的解决方案。

```
cout<<"Enter your name and press ENTER: ";
cin.getline(name,10);
if (cin.fail())
{
    cin.clear();
    cin.ignore(numeric_limits<streamsize>::max(), '\n');
} 
```

我建议将所有代码放入一个函数中，以便您可以在每个`getline`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T20:44:26.503

`cin.getline(name,10);`从输入中读取最多九个字符，如果有换行符则提前停止。如果这 9 个字符中没有换行符，它将不会触及该行的其余部分，并且下一次调用`getline`将继续读取该行的其余部分。

如果您只想忽略输入行的其余部分，则可以改用：

```
cin.get(name, 10);
cin.ignore(INT_MAX, '\n'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T21:10:09.903

free 函数`std::getline`对`std::string`s 进行操作，这比字符数组更容易处理。特别是，`std::getline`允许​​任意大的输入线。

尝试这个：

```
std::string str;
std::string adrs;
std::string name;
std::string wrk;
cout<<"Enter your name and press ENTER: ";
std::getline(std::cin, name);
cout<<"\nEnter your adress and press ENTER:";
std::getline(std::cin, adrs);
... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T21:04:31.640

你的逻辑是合理的，问题是当你声明一个大小为 10 的 char 数组时，你实际上并没有得到 10 个位置来放置字符，你只得到了 9 个。最后一个保留以表示字符串的结尾。[这里][1] 是一个参考，您想了解更多关于这个问题的信息：

只需声明比您想要的数字多一个字符。关于如何刷新流、忽略行的其余部分等，您也可以使用许多出色的技巧。

祝你好运！

# ruby - 检查哈希键是否出现在一行中

> ID：11835230
> 
> 赞同：0
> 
> 时间：2012-08-06T20:13:47.670
> 
> 标签：ruby, hash

我正在尝试逐行浏览文件，如果该行包含哈希键，我想打印该值。例如：

```
Months = { "January" => 1,
           "February" => 2,
           "March" => 3
         } 
```

如果我有一个文件包含：

```
February
January
March 
```

我希望输出为：

```
2
1
3 
```

谁能给我一些快速的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T23:06:07.803

假设数据结构如下：

```
data = 'Months = { "January" => 1,
  "February" => 2,
  "March" => 3
}' 
```

这将扫描它以查找与月份名称相关的数字：

```
months_to_find = %w[January February March]
months_re = Regexp.new(
  '(%s) .+ => \s+ (\d+)' % months_to_find.join('|'), 
  Regexp::IGNORECASE | Regexp::EXTENDED
)
Hash[*data.scan(months_re).flatten]['January'] # => 1 
```

魔法发生在这里：

```
months_re = Regexp.new(
  '(%s) .+ => \s+ (\d+)' % months_to_find.join('|'), 
  Regexp::IGNORECASE | Regexp::EXTENDED
) 
```

它创建了这个正则表达式：

```
/(January|February|March) .+ => \s+ (\d+)/ix 
```

将额外的月份添加到`months_to_find`.

如果数据更改为：

```
data = 'Months = { "The month is January" => 1,
  "The month is February" => 2,
  "The month is March" => 3
}' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T20:20:42.410

```
months = { "January" => 1, "February" => 2, "March" => 3 }

File.open('yourfile.txt').each_line do |line|
  result = months[line.strip]
  puts result if result
end 
```

# jquery - 服务器端验证错误后如何重置表单验证？

> ID：11835235
> 
> 赞同：0
> 
> 时间：2012-08-06T20:14:11.257
> 
> 标签：jquery, ruby-on-rails-3, validation

我有一个 from，用户将在其中填写一个唯一的数字，否则 rails 将响应错误：“已被占用”

我`validates_uniqueness_of`在模型上使用，所以一切都很好。

问题是当出现“已经被占用”的错误信息时，我无法再提交表单，即使我清除了文本框，似乎表单验证器也卡住了..

我试过`$("#class_room_form").validate().resetForm();`了，但是没有用，我还是不能提交表格..

任何想法 ？

# wpf - 在 PlacementTarget 的中心和底部对齐的弹出窗口

> ID：11835237
> 
> 赞同：4
> 
> 时间：2012-08-06T20:14:28.823
> 
> 标签：wpf, xaml, popup, controltemplate

我基本上是在尝试在按钮悬停时实现弹出窗口。当用户将鼠标悬停在按钮上时，我希望弹出窗口出现。如果不是，我只想显示标签。它有点像一个工具提示，只是我不希望 Popup 在经过一段时间后消失。我有点让它在按钮上使用 ControlTemplate 工作，但有两个警告：

1.  ~~当我将鼠标悬停在按钮下方的区域上时，屏幕会在弹出窗口和标签之间闪烁。~~
2.  我希望弹出窗口底部和中心对齐。

**Xaml 代码：**

```
<Window>
    <Window.Resources>
        <Style x:Key="LabelStyle" TargetType="Label">
            <Setter Property="Margin" Value="0, 0, 0, 5" />
            <Setter Property="Width" Value="58" />
            <Setter Property="Height" Value="28" />
            <Setter Property="Padding" Value="1, 0, 1, 0" />
        </Style>

        <ControlTemplate x:Key="ButtonControlTemplate" TargetType="Button">
            <StackPanel>
                <Button Width="48" Height="48" Background="White" Name="ItemButton">
                    <ContentPresenter Content="{TemplateBinding Property=ContentControl.Content}" />
                </Button>
                <Label Style="{StaticResource LabelStyle}" VerticalContentAlignment="Top" HorizontalContentAlignment="Center" Name="ItemLabel">
                    <TextBlock TextWrapping="Wrap" TextAlignment="Center" FontSize="11" LineHeight="13" LineStackingStrategy="BlockLineHeight">
                        Hello World!
                    </TextBlock>
                </Label>
                <Popup Name="ItemPopup" Placement="Bottom" PlacementTarget="{Binding ElementName=ItemButton}">
                    <TextBlock Background="Red">Hello World!</TextBlock>
                </Popup>
            </StackPanel>
            <ControlTemplate.Triggers>
                <Trigger SourceName="ItemButton" Property="IsMouseOver" Value="True">
                    <Setter TargetName="ItemLabel" Property="Visibility" Value="Hidden" />
                    <Setter TargetName="ItemPopup" Property="IsOpen" Value="True" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </Window.Resources>

    <StackPanel>
        <Button Background="Green" Template="{StaticResource ButtonControlTemplate}">
            <Image Source="http://leduc998.files.wordpress.com/2010/10/msft_logo.jpg" />
        </Button>
    </StackPanel>
</Window> 
```

**编辑：**修复了闪烁问题。只需要将弹出窗口的位置设置为底部和中心。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T15:19:11.580

我最终不得不编写一个转换器，根据弹出窗口的高度和放置目标将其向下移动。

使用这样的多重绑定将信息传递到我的 VerticalOffset 转换器中：

```
<MultiBinding Converter="{StaticResource PopupVerticalAligner}">
    <Binding RelativeSource="{RelativeSource Self}" Path="PlacementTarget.ActualHeight" />
    <Binding RelativeSource="{RelativeSource Self}" Path="ActualHeight" />
</MultiBinding> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:21:30.713

您是否尝试过 MouseEnter 事件？然后您可以在 DispatcherTimer 上打开弹出窗口，然后再次将其关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-29T21:27:55.893

添加到 sohum 的[答案](https://stackoverflow.com/a/11955535/625919)中，这就是我如何让我的 ListView-Popup 底部在 ToggleButton 下居中。它根据列表视图的宽度正确地水平偏移。我还留下了一些让切换按钮直观行为的点点滴滴，比如再次单击切换按钮以隐藏弹出窗口。

```
<ToggleButton x:Name="ParentToggleButton" IsChecked="{Binding ToggleButtonStatus}" IsHitTestVisible="{Binding ElementName=ToggledPopup, Path=IsOpen, Converter={StaticResource BoolToInvertedBoolConverter}}" >
  <ToggleButton.Content>...</ToggleButton.Content>
</ToggleButton>
<Popup PlacementTarget="{Binding ElementName=ParentToggleButton}"  Placement="Bottom" StaysOpen="False" IsOpen="{Binding ToggleButtonStatus}" x:Name="ToggledPopup">
  <Popup.HorizontalOffset>
    <MultiBinding Converter="{StaticResource CenterToolTipConverter}">
      <Binding RelativeSource="{RelativeSource Self}" Path="PlacementTarget.ActualWidth"/>
      <Binding ElementName="INeedYourWidth" Path="ActualWidth"/>
    </MultiBinding>
  </Popup.HorizontalOffset>
  <ListView x:Name="INeedYourWidth" ItemsSource="{Binding ItemsSource}" >
    <ListView.ItemTemplate>
      <DataTemplate>...</DataTemplate>
    </ListView.ItemTemplate>
  </ListView>
</Popup> 
```

BoolToInvertedBoolConverter 如果为 false 则返回 true ，如果为 true 则返回 false （以允许弹出窗口在用户尝试取消切换时折叠），并且可以在 sohum 的[链接](https://stackoverflow.com/a/10972517/625919)中找到 CenterToolTipConverter 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-01T07:58:32.830

更好的是把你的*PlacementTarget*控件放在 a 中`Grid`，并使你的`Popup`控件成为同一个子控件，`Grid`同时保持`Placement=Bottom`. 这将`Popup`在 PlacementTarget 控件下显示您的底部居中。没有转换器，没有样式，简单的 XAML。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-20T13:13:47.273

虽然这已经是一个老问题了，但我也有同样的需求——我需要能够将 a`Popup`与其放置目标对齐。对转换器解决方案不满意，我提出了自己的解决方案，使用附加的依赖属性，我在这里与您和任何有相同需求的人分享。

> 注意：此解决方案**不包括如何`Popup`在鼠标悬停**时显示 a 。它只涵盖了最棘手的部分 -`Popup`与其放置目标的对齐。有几种方法可以显示`Popup`鼠标悬停，例如使用**Triggers**或**Bindings**，这两种方法都在 StackOverflow 上广泛介绍。

# 附加依赖属性解决方案

此解决方案使用单个静态类公开一些**附加的依赖属性**。使用这些属性，您可以水平或垂直对齐 a`Popup`到 its`PlacementTarget`或 its 。仅当'属性的值表示一条边（、或）时`PlacementRectangle`才会发生对齐。`Popup``Placement``Left``Top``Right``Bottom`

## 执行

弹出属性.cs

```
using System;
using System.Windows;
using System.Windows.Controls.Primitives;
using System.Windows.Media;

namespace MyProjectName.Ui
{
    /// <summary>
    /// Exposes attached dependency properties that provide 
    /// additional functionality for <see cref="Popup"/> controls.
    /// </summary>
    /// <seealso cref="Popup"/>
    /// <seealso cref="DependencyProperty"/>
    public static class PopupProperties
    {

        #region Properties

        #region IsMonitoringState attached dependency property

        /// <summary>
        /// Attached <see cref="DependencyProperty"/>. This property 
        /// registers (<b>true</b>) or unregisters (<b>false</b>) a 
        /// <see cref="Popup"/> from the popup monitoring mechanism 
        /// used internally by <see cref="PopupProperties"/> to keep 
        /// the <see cref="Popup"/> in synchrony with the 
        /// <see cref="PopupProperties"/>' attached properties. A 
        /// <see cref="Popup"/> will be automatically unregistered from
        /// this mechanism after it is unloaded.
        /// </summary>
        /// <seealso cref="Popup"/>
        private static readonly DependencyProperty IsMonitoringStateProperty
            = DependencyProperty.RegisterAttached("IsMonitoringState",
                typeof(bool), typeof(PopupProperties),
                new FrameworkPropertyMetadata(false,
                    FrameworkPropertyMetadataOptions.None,
                    new PropertyChangedCallback(IsMonitoringStatePropertyChanged)));

        private static void IsMonitoringStatePropertyChanged(
            DependencyObject dObject, DependencyPropertyChangedEventArgs e)
        {
            Popup popup = (Popup)dObject;
            bool value = (bool)e.NewValue;
            if (value)
            {
                // Attach popup.
                popup.Opened += Popup_Opened;
                popup.Unloaded += Popup_Unloaded;

                // Update popup.
                UpdateLocation(popup);
            }
            else
            {
                // Detach popup.
                popup.Opened -= Popup_Opened;
                popup.Unloaded -= Popup_Unloaded;
            }
        }

        private static bool GetIsMonitoringState(Popup popup)
        {
            if (popup is null)
                throw new ArgumentNullException(nameof(popup));
            return (bool)popup.GetValue(IsMonitoringStateProperty);
        }

        private static void SetIsMonitoringState(Popup popup, bool isMonitoringState)
        {
            if (popup is null)
                throw new ArgumentNullException(nameof(popup));
            popup.SetValue(IsMonitoringStateProperty, isMonitoringState);
        }

        #endregion

        #region HorizontalPlacementAlignment attached dependency property

        public static readonly DependencyProperty HorizontalPlacementAlignmentProperty
            = DependencyProperty.RegisterAttached("HorizontalPlacementAlignment",
                typeof(AlignmentX), typeof(PopupProperties),
                new FrameworkPropertyMetadata(AlignmentX.Left,
                    FrameworkPropertyMetadataOptions.None,
                    new PropertyChangedCallback(HorizontalPlacementAlignmentPropertyChanged)),
                new ValidateValueCallback(HorizontalPlacementAlignmentPropertyValidate));

        private static void HorizontalPlacementAlignmentPropertyChanged(
            DependencyObject dObject, DependencyPropertyChangedEventArgs e)
        {
            Popup popup = (Popup)dObject;
            SetIsMonitoringState(popup, true);
            UpdateLocation(popup);
        }

        private static bool HorizontalPlacementAlignmentPropertyValidate(object obj)
        {
            return Enum.IsDefined(typeof(AlignmentX), obj);
        }

        public static AlignmentX GetHorizontalPlacementAlignment(Popup popup)
        {
            if (popup is null)
                throw new ArgumentNullException(nameof(popup));
            return (AlignmentX)popup.GetValue(HorizontalPlacementAlignmentProperty);
        }

        public static void SetHorizontalPlacementAlignment(Popup popup, AlignmentX alignment)
        {
            if (popup is null)
                throw new ArgumentNullException(nameof(popup));
            popup.SetValue(HorizontalPlacementAlignmentProperty, alignment);
        }

        #endregion

        #region VerticalPlacementAlignment attached dependency property

        public static readonly DependencyProperty VerticalPlacementAlignmentProperty
            = DependencyProperty.RegisterAttached("VerticalPlacementAlignment",
                typeof(AlignmentY), typeof(PopupProperties),
                new FrameworkPropertyMetadata(AlignmentY.Top,
                    FrameworkPropertyMetadataOptions.None,
                    new PropertyChangedCallback(VerticalPlacementAlignmentPropertyChanged)),
                new ValidateValueCallback(VerticalPlacementAlignmentPropertyValidate));

        private static void VerticalPlacementAlignmentPropertyChanged(
            DependencyObject dObject, DependencyPropertyChangedEventArgs e)
        {
            Popup popup = (Popup)dObject;
            SetIsMonitoringState(popup, true);
            UpdateLocation(popup);
        }

        private static bool VerticalPlacementAlignmentPropertyValidate(object obj)
        {
            return Enum.IsDefined(typeof(AlignmentY), obj);
        }

        public static AlignmentY GetVerticalPlacementAlignment(Popup popup)
        {
            if (popup is null)
                throw new ArgumentNullException(nameof(popup));
            return (AlignmentY)popup.GetValue(VerticalPlacementAlignmentProperty);
        }

        public static void SetVerticalPlacementAlignment(Popup popup, AlignmentY alignment)
        {
            if (popup is null)
                throw new ArgumentNullException(nameof(popup));
            popup.SetValue(VerticalPlacementAlignmentProperty, alignment);
        }

        #endregion

        #region HorizontalOffset attached dependency property

        public static readonly DependencyProperty HorizontalOffsetProperty
            = DependencyProperty.RegisterAttached("HorizontalOffset",
                typeof(double), typeof(PopupProperties),
                new FrameworkPropertyMetadata(0d,
                    FrameworkPropertyMetadataOptions.None,
                    new PropertyChangedCallback(HorizontalOffsetPropertyChanged)),
                new ValidateValueCallback(HorizontalOffsetPropertyValidate));

        private static void HorizontalOffsetPropertyChanged(
            DependencyObject dObject, DependencyPropertyChangedEventArgs e)
        {
            Popup popup = (Popup)dObject;
            SetIsMonitoringState(popup, true);
            UpdateLocation(popup);
        }

        private static bool HorizontalOffsetPropertyValidate(object obj)
        {
            double value = (double)obj;
            return !double.IsNaN(value) && !double.IsInfinity(value);
        }

        public static double GetHorizontalOffset(Popup popup)
        {
            if (popup is null)
                throw new ArgumentNullException(nameof(popup));
            return (double)popup.GetValue(HorizontalOffsetProperty);
        }

        public static void SetHorizontalOffset(Popup popup, double offset)
        {
            if (popup is null)
                throw new ArgumentNullException(nameof(offset));
            popup.SetValue(HorizontalOffsetProperty, offset);
        }

        #endregion

        #region VerticalOffset attached dependency property

        public static readonly DependencyProperty VerticalOffsetProperty
            = DependencyProperty.RegisterAttached("VerticalOffset",
                typeof(double), typeof(PopupProperties),
                new FrameworkPropertyMetadata(0d,
                    FrameworkPropertyMetadataOptions.None,
                    new PropertyChangedCallback(VerticalOffsetPropertyChanged)),
                new ValidateValueCallback(VerticalOffsetPropertyValidate));

        private static void VerticalOffsetPropertyChanged(
            DependencyObject dObject, DependencyPropertyChangedEventArgs e)
        {
            Popup popup = (Popup)dObject;
            SetIsMonitoringState(popup, true);
            UpdateLocation(popup);
        }

        private static bool VerticalOffsetPropertyValidate(object obj)
        {
            double value = (double)obj;
            return !double.IsNaN(value) && !double.IsInfinity(value);
        }

        public static double GetVerticalOffset(Popup popup)
        {
            if (popup is null)
                throw new ArgumentNullException(nameof(popup));
            return (double)popup.GetValue(VerticalOffsetProperty);
        }

        public static void SetVerticalOffset(Popup popup, double offset)
        {
            if (popup is null)
                throw new ArgumentNullException(nameof(offset));
            popup.SetValue(VerticalOffsetProperty, offset);
        }

        #endregion

        #endregion Properties

        #region Methods

        private static void OnMonitorState(Popup popup)
        {
            if (popup is null)
                throw new ArgumentNullException(nameof(popup));

            UpdateLocation(popup);
        }

        private static void UpdateLocation(Popup popup)
        {
            // Validate parameters.
            if (popup is null)
                throw new ArgumentNullException(nameof(popup));

            // If the popup is not open, we don't need to update its position yet.
            if (!popup.IsOpen)
                return;

            // Setup initial variables.
            double offsetX = 0d;
            double offsetY = 0d;
            PlacementMode placement = popup.Placement;
            UIElement placementTarget = popup.PlacementTarget;
            Rect placementRect = popup.PlacementRectangle;

            // If the popup placement mode is an edge of the placement target, 
            // determine the alignment offset.
            if (placement == PlacementMode.Top || placement == PlacementMode.Bottom
                || placement == PlacementMode.Left || placement == PlacementMode.Right)
            {
                // Try to get the popup size. If its size is empty, use the size 
                // of its child, if any child exists.
                Size popupSize = GetElementSize(popup);
                UIElement child = popup.Child;
                if ((popupSize.IsEmpty || popupSize.Width <= 0d || popupSize.Height <= 0d)
                    && child != null)
                {
                    popupSize = GetElementSize(child);
                }
                // Get the placement rectangle size. If it's empty, get the 
                // placement target's size, if a target is set.
                Size targetSize;
                if (placementRect.Width > 0d && placementRect.Height > 0d)
                    targetSize = placementRect.Size;
                else if (placementTarget != null)
                    targetSize = GetElementSize(placementTarget);
                else
                    targetSize = Size.Empty;

                // If we have a valid popup size and a valid target size, determine 
                // the offset needed to align the popup to the target rectangle.
                if (!popupSize.IsEmpty && popupSize.Width > 0d && popupSize.Height > 0d
                    && !targetSize.IsEmpty && targetSize.Width > 0d && targetSize.Height > 0d)
                {
                    switch (placement)
                    {
                        // Horizontal alignment offset.
                        case PlacementMode.Top:
                        case PlacementMode.Bottom:
                            switch (GetHorizontalPlacementAlignment(popup))
                            {
                                case AlignmentX.Left:
                                    offsetX = 0d;
                                    break;
                                case AlignmentX.Center:
                                    offsetX = -(popupSize.Width - targetSize.Width) / 2d;
                                    break;
                                case AlignmentX.Right:
                                    offsetX = -(popupSize.Width - targetSize.Width);
                                    break;
                                default:
                                    break;
                            }
                            break;
                        // Vertical alignment offset.
                        case PlacementMode.Left:
                        case PlacementMode.Right:
                            switch (GetVerticalPlacementAlignment(popup))
                            {
                                case AlignmentY.Top:
                                    offsetY = 0d;
                                    break;
                                case AlignmentY.Center:
                                    offsetY = -(popupSize.Height - targetSize.Height) / 2d;
                                    break;
                                case AlignmentY.Bottom:
                                    offsetY = -(popupSize.Height - targetSize.Height);
                                    break;
                                default:
                                    break;
                            }
                            break;
                        default:
                            break;
                    }
                }
            }

            // Add the developer specified offsets to the offsets we've calculated.
            offsetX += GetHorizontalOffset(popup);
            offsetY += GetVerticalOffset(popup);

            // Apply the final computed offsets to the popup.
            popup.SetCurrentValue(Popup.HorizontalOffsetProperty, offsetX);
            popup.SetCurrentValue(Popup.VerticalOffsetProperty, offsetY);
        }

        private static Size GetElementSize(UIElement element)
        {
            if (element is null)
                return new Size(0d, 0d);
            else if (element is FrameworkElement frameworkElement)
                return new Size(frameworkElement.ActualWidth, frameworkElement.ActualHeight);
            else
                return element.RenderSize;
        }

        #endregion Methods

        #region Event handlers

        private static void Popup_Unloaded(object sender, RoutedEventArgs e)
        {
            if (sender is Popup popup)
            {
                // Stop monitoring the popup state, because it was unloaded.
                SetIsMonitoringState(popup, false);
            }
        }

        private static void Popup_Opened(object sender, EventArgs e)
        {
            if (sender is Popup popup)
            {
                OnMonitorState(popup);
            }
        }

        #endregion Event handlers

    }
} 
```

## 这个怎么运作

上面的代码创建了一个静态类，它公开了`Popup`控件的 4 个附加依赖属性。即，它们是`HorizontalPlacementAlignment`、`VerticalPlacementAlignment`和。`HorizontalOffset``VerticalOffset`

`HorizontalPlacementAlignment`和`VerticalPlacementAlignment`附加的依赖属性允许您将弹出窗口相对于它的`PlacementTarget`or对齐`PlacementRectangle`。为此，该机制使用`Popup.HorizontalOffset`和`Popup.VerticalOffset`属性来定位`Popup`.

因为机制使用`Popup.HorizontalOffset`和`Popup.VerticalOffset`属性来工作，所以这个类提供了自己的`HorizontalOffset`和`VerticalOffset`属性（附加的依赖属性）。`Popup`除了对齐之外，您还可以使用它们来调整位置。

`Popup`每次`Popup`打开时，该机制都会自动更新位置。但是，当弹出窗口大小发生变化或放置目标或放置矩形大小发生变化时，它的位置不会自动更新。尽管如此，只要投入更多的工作，该功能就可以轻松实现。

# 使用示例

`Popup`您将在下面的示例中使用附加属性。在这个例子中，我们有一个简单的`Button`和一个`Popup`. 与 '的`Popup`底部对齐并以' 的中心`Button`水平居中显示。`Button`

```
<Button x:Name="MyTargetElement">My Button</Button>
<Popup xmlns:ui="clr-namespace:MyProjectName.Ui"
    PlacementTarget="{Binding ElementName=MyTargetElement}"
    Placement="Bottom"
    ui:PopupProperties.HorizontalPlacementAlignment="Center"
    ui:PopupProperties.VerticalOffset="2">
</Popup> 
```

通过将`ui:PopupProperties.HorizontalPlacementAlignment="Center"`和添加`ui:PopupProperties.VerticalOffset="2"`到 a `Popup`，它将与其放置目标的水平中心对齐，并具有 2 个 WPF 单位的垂直偏移量。

注意 上的`xmlns:ui="clr-namespace:MyProjectName.Ui"`使用`Popup`。此属性仅从项目的命名空间导入类型，并通过使用XAML 属性上`MyProjectName.Ui`的前缀使它们可用。`ui:`在示例中，`Popup`为简单起见，此属性设置在 上，但您通常会将其设置在您的`Window`或`ResourceDictionary`使用这些自定义附加依赖项属性的位置。

# 结论

使用附加的依赖属性来实现此功能背后的想法是使其在 XAML 中的使用尽可能简单。对于简单的一次性需求，使用转换器可能更易于实现。但是，在这种情况下，使用附加的依赖属性可能会提供一种更加动态和使用友好的方法。

# css - 当最后一个图像或 div 从浏览器顶部到达指定点时，如何锁定或修复滚动？

> ID：11835242
> 
> 赞同：0
> 
> 时间：2012-08-06T20:14:45.637
> 
> 标签：css, html, scroll, position, height

嗨，我对 html 和 CSS 很陌生，遇到了一个问题，我似乎无法在任何地方找到解决方案。我问过同样困惑的网页设计朋友，希望有人能提供帮助。

此链接将您带到我正在处理的项目页面：http: [//dl.dropbox.com/u/25715164/project01.html](http://dl.dropbox.com/u/25715164/project01.html)

我遇到了一个巨大的问题，即如何限制滚动，直到页面上的最后一个 div 与标题下方对齐。目前，当通过填充屏幕边缘的浏览器窗口查看时，它可以正常工作，第二张图像正好在标题行下方对齐。但是，当您开始缩放浏览器窗口时，div 没有正确排列，并且在标题和图像之间留下一个奇怪的大间隙，或者图像太远超出屏幕顶部。如果你按照链接，你会希望看到我的意思？

我已经尝试过使用边距、填充、div 高度，并且正在考虑最后一张图片是否是页脚，但我没有设法破解它！

我认为这可能很简单，因为页面应该在顶部包含一个固定的 div 标题，然后内容会滚动，直到最终图像的顶部距离浏览器窗口顶部大约 30px，此时滚动将被禁用- 我完全被难住了，您能提供的任何帮助将不胜感激。html 和外部 CSS 复制如下。[我使用dreamweaver cs6的新液体布局开始这个网站，但缩放有点小故障，经过大量研究建议通常指向一个固定的像素相对定位的容器div，以页面为中心，里面有绝对定位的div]

提前致谢。

```
/* html */

<!doctype html>
<!--[if lt IE 7]> <html class="ie6 oldie"> <![endif]-->
<!--[if IE 7]>    <html class="ie7 oldie"> <![endif]-->
<!--[if IE 8]>    <html class="ie8 oldie"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="">
<!--<![endif]-->
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Untitled Document</title>
<link href="boilerplate.css" rel="stylesheet" type="text/css">
<link href="main.css" rel="stylesheet" type="text/css">
<!-- 
To learn more about the conditional comments around the html tags at the top of the     file:
paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/

Do the following if you're using your customized build of modernizr     (http://www.modernizr.com/):
* insert the link to your js here
* remove the link below to the html5shiv
* add the "no-js" class to the html tags at the top
* you can also remove the link to respond.min.js if you included the MQ Polyfill in your     modernizr build 
-->
<!--[if lt IE 9]>
<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<script src="respond.min.js"></script>
</head>
<body>

<div class="gridContainer clearfix">

<div id="fixedtop1">
    <div id="center250a">
            <div id="SiteHeadingPortfolio_test">PORTFOLIO</div> 
      <div id="SiteHeaderPSIdesign_test"> &nbsp;: PRODUCT / SERVICE / INTERACTION DESIGN</div>
      <div id="HorizontalRule_test"><hr></div>
    </div>
</div>

<div class="project01_wrap"><img src="images/test.png"></div>
<div class="project02_wrap"><img src="images/test.png"></div>

</div>
<p>&nbsp;</p>

</body>
</html>

/* CSS CODE */

@charset "UTF-8";
@import url("webfonts/Ben_Sans_Bold/stylesheet.css");
@import url("webfonts/Ben_Sans_Regular/stylesheet.css");
@import url("webfonts/Ben_Sans_Light/stylesheet.css");
@import url("webfonts/Ben_Sans_RegularItalic/stylesheet.css");

img, object, embed, video {
max-width: 100%;
}
/* IE 6 does not support max-width so default to width 100% */
.ie6 img {
width:100%;
}

/*
Dreamweaver Fluid Grid Properties
----------------------------------
dw-num-cols-mobile:     4;
dw-num-cols-tablet:     8;
dw-num-cols-desktop:    10;
dw-gutter-percentage:   20;

Inspiration from "Responsive Web Design" by Ethan Marcotte 
http://www.alistapart.com/articles/responsive-web-design

and Golden Grid System by Joni Korpi
http://goldengridsystem.com/
*/

/* Mobile Layout: 480px and below. */

.gridContainer {
width: 370px;
padding-left: 0%;
padding-right: 0%;
margin: auto;
}

/* Desktop Layout: 769px to a max of 1232px.  Inherits styles from: Mobile Layout and Tablet Layout. */

@media only screen and (min-width: 480px) {
.gridContainer {
width: 1000px;
max-width: 1000px;
padding-left: 0;
padding-right: 0;
padding-top: 10px;
position: relative;
margin-top: 0px;
margin-right: auto;
margin-bottom: 0px;
margin-left: auto;
left: 0px;
top: 0px;
}
#SiteHeadingPortfolio {
width: 78px;
display: block;
font-family: "Ben Sans Bold";
font-size: 11.5px;
font-weight: bold;
letter-spacing: 1px;
left: 10px;
top: 10px;
position: absolute;
}
body {
text-align: center;
}

.SiteHeaderPSIdesign {
margin-top: 2px;
font-family: "Ben Sans Regular";
font-size: 10px;
font-weight: normal;
position: absolute;
width: 350px;
left: 38px;
letter-spacing: 1px;
top: 9px;
}

.HorizontalRule {
left: 10px;
top: 22px;
height: 0px;
width: 980px;
position: absolute;
font-family: "Ben Sans Regular";
font-size: 5px;
letter-spacing: 2px;
}
.button_01 {
position: absolute;
height: 185px;
width: 173px;
left: 15px;
top: 38px;
}
.button_image {
position: absolute;
height: 131px;
width: 173px;
}
.button_Title {
position: absolute;
width: 173px;
top: 135px;
font-family: "Ben Sans Regular";
font-size: 11px;
text-align: left;
}
.button_Text {
position: absolute;
width: 160px;
top: 149px;
font-family: "Ben Sans Regular";
font-size: 9px;
left: 15px;
text-align: left;
text-transform: uppercase;
color: #333;
line-height: 14px;
word-spacing: 1.5pt;
}

/* Project Page begins here - TESTING -. */

.project01_wrap {
width: 980px;
height: 670px;
position: absolute;
left: 10px;
top: 38px;
}

.project02_wrap {
width: 980px;
height: 764px;
position: absolute;
left: 10px;
top: 800px;
}

#fixedtop1 { position: fixed; top: 10px; left: 0; right: 0; border: none; z-index: 50;     background-color: #FFFFFF; }
#center250a {
width: 980px;
margin: auto;
background-color: #FFFFFF;
}

#SiteHeadingPortfolio_test {
width: 78px;
display: block;
font-family: "Ben Sans Bold";
font-size: 11.5px;
font-weight: bold;
letter-spacing: 1px;
position: absolute;
}

#SiteHeaderPSIdesign_test {
margin-left: 28px;
margin-top: 1.5px;
font-family: "Ben Sans Regular";
font-size: 10px;
font-weight: normal;
position: absolute;
width: 350px;
letter-spacing: 1px;
}

#HorizontalRule_test {
margin-left: 0px;
top: 12px;
height: 0px;
width: 980px;
position: absolute;
font-family: "Ben Sans Regular";
font-size: 5px;
letter-spacing: 2px;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:29:53.667

当您尝试依赖客户端视口的大小时，您将进入非常棘手的领域。

如果你真的打算这样做，有两种方法可以尝试。首先使用 JS/jQuery 检测视口大小并动态更改页面以获得所需的效果，或者使用 CSS 媒体查询来做同样的事情。

实际上，尽管使用其中任何一种技术都需要付出很多努力而回报却很少。为什么不简单地让您的固定位置标题具有白色背景，以便它后面的任何内容看起来都不错？

# android - 移除 ImageButton 的图片资源

> ID：11835251
> 
> 赞同：9
> 
> 时间：2012-08-06T20:15:17.960
> 
> 标签：android, drawable, imagebutton

我有一个透明的 ImageButton。单击时，按钮的 ImageResource 设置为我的 drawable-hdpi 文件夹中的可绘制对象（基本上，图像显示在透明 ImageButton 的顶部）。我正在使用该`ImageButton.setImageResource()`方法来做到这一点。我的问题是，我怎样才能删除图像资源，以便再次只有一个透明图像按钮。当然，我需要能够在 java 中做到这一点，而不是 XML。我尝试了以下失败的方法：`ImageButton.setImageResource(null);` 我也环顾四周，找不到答案......在此先感谢您的帮助。

编辑：谢谢大家的回答.. Péter Varga 的回答正是我所需要的，所以这就是我要做的。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-08-06T20:22:26.030

尝试设置`imageButton.setImageResource(android.R.color.transparent)`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-05-29T16:43:54.863

```
imageButton.setBackgroundResource(0); 
```

文档说：

> 资源应引用 Drawable 对象或 0 以移除背景

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T20:24:12.490

通常，人们在 drawable 文件夹中创建 null_image.xml 资源文件，并在需要清除背景时使用此资源：

null_image.xml 内容：

```
<?xml version="1.0" encoding="utf-8"?>
<shape
    xmlns:android="http://schemas.android.com/apk/res/android">
    <solid
        android:color="#0000" />
    <size
        android:width="1dp"
        android:height="1dp" />
</shape> 
```

当您需要清除背景时 - 只需致电：

```
ImageButton.setImageDrawable(R.drawable.null_image); 
```

不知道为什么 CSimth 没有发表他的评论作为答案......对我来说是正确的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T20:31:40.997

我不确定它是否有效，但我认为你可以回收`ImageButton`'s drawable。

尝试类似：

```
ImageButton imbBtn = (ImageButton) findBiewById(R.id.imbBtn);

imgBtn.getDrawable().recycle(); 
```

我以前从未尝试过，如果它对你有用，请告诉我。

# delphi - DataSnap 服务器抱怨服务器方法不存在 ...Delphi 2010 DataSnap

> ID：11835253
> 
> 赞同：0
> 
> 时间：2012-08-06T20:15:29.527
> 
> 标签：delphi, delphi-2010, datasnap

我有一个带有这样的服务器方法的 DataSnap 服务器：

```
function TServerMethods1.selectFalzUser(Usuario: string) : TDataSet; 
```

现在，在使用 TSQLServerMethod 的 DataSnap 客户端上，我在设计模式下成功连接到服务器，拉取服务器的方法列表...选择“selectFalzUser”...我可以成功看到我的参数，Usuario 作为输入和输出 TDataset参数...当尝试将我的 SqlServerMethod 设置为活动时...我收到以下错误：

> 错误 远程错误：在服务器方法列表中找不到 TServerMethods1.selectFalzUserwhereUsuario 方法。

为什么 Delphi 将 'whereUsuario' 字符串附加到方法名称？显然 TServerMethods1.selectFalzUserwhereUsuario 不存在。

问候

萨盖里诺。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:07:06.207

如果没有看到更多代码，很难说为什么它没有正确报告方法名称。但是，听起来您使用 DataSnap 并不完全正确。以下是我为几个项目成功完成的工作：

您必须在 DataSnap 服务器中的类定义`{$METHODINFO ON}`之前和`TServerMethods`类定义之后包含。`{$METHODINFO OFF}`然后编译并运行您的 DS 服务器。

在客户端，添加一个`TSQLConnection`组件并设置其属性以连接到您的列表 DS 服务器。然后右键单击`TSQLConnection`并选择`Generate DataSnap client classes`。将此保存为类似`ProxyMethods.pas`内容并将其包含在您的客户项目中。然后您可以访问`ProxyMethods`该类以调用任何`TServerMethods`在服务器上发布的内容。

此外，返回`TDataSet`不适用于我描述的方法，因为`TDataSet`它不是可编组的数据类型，但 OleVariant 是。我在返回 a 方面取得了很好的成功`TClientDataSet.Data`，然后在客户端我可以直接将其分配给`Data`client-side 的属性`TClientDataSet`。

# asp.net - Server.Transfer 上发生的 Thread.Abort 错误

> ID：11835255
> 
> 赞同：0
> 
> 时间：2012-08-06T20:15:31.693
> 
> 标签：asp.net

在某些情况下，我会遇到一些错误`Server.Transfer`。

威胁已经被清除了。

```
at System.Web.HttpServerUtility.ExecuteInternal(IHttpHandler handler, TextWriter writer, Boolean preserveForm, Boolean setPreviousPage, VirtualPath path, VirtualPath filePath, String physPath, Exception error, String queryStringOverride)     
at System.Web.HttpServerUtility.Execute(String path, TextWriter writer, Boolean preserveForm)     
at System.Web.HttpServerUtility.Transfer(String path)     
at App._Default.TransferToCheckLoginPage() in blahblah\Default.aspx.vb:line 31     
at App._Default.Page_Load(Object sender, EventArgs e) in blahblah\Default.aspx.vb:line 18 
```

威胁已经被清除了。

```
at System.Threading.Thread.AbortInternal()     
at System.Threading.Thread.Abort(Object stateInfo)     
at System.Web.HttpResponse.End()     
at System.Web.HttpServerUtility.Transfer(String path)     
at App.ASPX.ck_login.TransferToStartPage() in blahblah\ck_login.aspx.vb:line 45     
at App.ASPX.ck_login.Page_Load(Object sender, EventArgs e) in blahblah\ck_login.aspx.vb:line 33 
```

现在奇怪的是传输完成（在某些情况下它没有完成，这就是我对这个错误感兴趣的原因）

在 server.transfer 期间会发生哪些 ASP.Net 生命周期事件？

在一种情况下，当 Server.Transfer() 指向具有扩展名 .aspx （没有页面指令）但内联 asp 调用 <% %> （并且它有一个指向正常的 .aspx 页面）

由于这是一个当前部署的应用程序，如果我不需要，我不希望对其进行太多更改。我更感兴趣的是知道`Server.Transfer`进程中的什么会中止线程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:19:05.983

来自[文档](http://msdn.microsoft.com/en-us/library/y4k58xk7.aspx)：

> 转移到的页面应该是另一个 .aspx 页面。例如，转移到 .asp 或 .asmx 页面是无效的。Transfer 方法保留 QueryString 和 Form 集合。
> 
> Transfer 调用 End，完成时会引发 ThreadAbortException 异常。

Response.Redirect 也是如此（默认情况下，尽管您可以覆盖它。）您可以忽略这些错误。

*但是，即使处理在原始页面上结束，处理也应该在转移到的页面上继续*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:18:18.537

是的，它确实。你可以放心地忽略它

> 此行为是设计使然。

[http://support.microsoft.com/kb/312629](http://support.microsoft.com/kb/312629)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T20:18:40.227

据我所知，在`Server.Transfer`系统抛出 Thread abort 异常，并开始执行新的页面循环。另一方面`Response.Redirect`，此方法正确结束响应并向客户端发送状态 302，

```
HTTP 1.0 302 Object Moved 
Location: http://www.google.com 
```

比客户端请求在响应中指定的新页面`location`。

# ruby-on-rails-3 - 无法在 Windows 中安装 Rails Gem capybara-webkit

> ID：11835260
> 
> 赞同：2
> 
> 时间：2012-08-06T20:15:43.457
> 
> 标签：ruby-on-rails-3, windows-7, capybara

我正在尝试运行需要“capybara-webkit”gem 的 Rails 应用程序。我已经安装了 0.12.1 版本，但是应用程序要求 0.10.1。我只是无法让它工作，即使我确定其他所有东西都已安装。我想知道路径或 Qt 版本是否不兼容或不正确？

当我尝试安装 gem 时，我收到以下错误消息：

**错误：（gem install capybara-webkit -v '0.10.1'）**

```
 Installing capybara-webkit (0.10.1) with native extensions 
 Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

     C:/RUBY/RailsInstaller/Ruby1.9.3/bin/ruby.exe extconf.rb 

 Gem files will remain installed in 

 C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/capybara-webkit-0.10.1 for 

 inspection.
 Results logged to C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/capybara-

 webkit-0.10.1/./gem_make.out 
```

**gem_make.out：**

```
 C:/RUBY/RailsInstaller/Ruby1.9.3/bin/ruby.exe extconf.rb 
```

**extconf.rb：**

```
 require File.join(File.expand_path(File.dirname(__FILE__)), "lib","capybara_webkit_builder")
 CapybaraWebkitBuilder.build_all 
```

我确定我安装了正确的软件（如下所示）。

**跑步：**

> Windows 7（64 位）Ruby 1.9.3 Rails 3.2.6 QT 4.8.2 DevKit 32 4.5.2

**红宝石：**

```
 RUBYGEMS VERSION: 1.8.16
 RUBY VERSION: 1.9.3 (2012-02-16 patchlevel 125) [i386-mingw32]
 INSTALLATION DIRECTORY: C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1
 RUBY EXECUTABLE: C:/RUBY/RailsInstaller/Ruby1.9.3/bin/ruby.exe
 EXECUTABLE DIRECTORY: C:/RUBY/RailsInstaller/Ruby1.9.3/bin
 RUBYGEMS PLATFORMS:
   ruby
   x86-mingw32
 GEM PATHS:
    C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1
    C:/Users/COMPAQ/.gem/ruby/1.9.1
 GEM CONFIGURATION:
    :update_sources => true
    :verbose => true
    :benchmark => false
    :backtrace => false
    :bulk_threshold => 1000
 REMOTE SOURCES:
    http://rubygems.org/
 ----------------------
 IDE: JetBrains RubyMine 4.0.3, build #RM-117.230
 OS: Windows 7 6.1[x86]
 Java: 1.6.0_29-b11
 RubyMine SDK Environment:
 Sdk: ruby-1.9.3-p125
 Sdk Version: ver.1.9.3p125 p125
 Ruby Interpreter: C:/RUBY/RailsInstaller/Ruby1.9.3/bin/ruby.exe
 RVM Sdk: no
 Sdk Language Level: 1.9
 Sdk Load Path:
      C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1
      C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby/1.9.1/i386-msvcrt
      C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/site_ruby
      C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/vendor_ruby/1.9.1
      C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/vendor_ruby/1.9.1/i386-msvcrt
      C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/vendor_ruby
      C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1
      C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/i386-mingw32
      C:/Program Files (x86)/JetBrains/RubyMine 4.0.2/rubystubs19
 Sdk Gem paths: 
      C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems
      C:/Users/COMPAQ/.gem/ruby/1.9.1/gems
      C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/bundler/gems
      C:/Users/COMPAQ/.gem/ruby/1.9.1/bundler/gems 
```

**环境路径：**

用户：

> ;%HOMEDRIVE%\ANDROID\SDK\tools;C:\RUBY\RailsInstaller\Ruby1.9.3\bin;C:\RUBY\RailsInstaller\DevKit\bin;C:\RUBY\QT\bin

系统：

> C:\RUBY\RailsInstaller\Git\cmd;C:\RUBY\RailsInstaller\Ruby1.9.3\bin;C:\Program Files\Common Files\Microsoft Shared\Windows Live;C:\Program Files (x86)\Common Files \Microsoft Shared\Windows Live;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;C:\Program Files (x86)\Common Files\ Teleca Shared;C:\Program Files (x86)\Windows Live\Shared;C:\Program Files (x86)\QuickTime\QTSystem\;C:\RUBY\RailsInstaller\Git\bin;C:\RUBY\QT\bin

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:10:33.493

确保您已安装[支持 mingw32 的 Qt v4.7.4](ftp://ftp.qt.nokia.com/qt/source/qt-win-opensource-4.7.4-mingw.exe)并将 Qt 的 bin 目录添加到 PATH。`Ruby193\devkit\mingw`在安装过程中，当询问 MinGW 路径时选择您的目录。

我之前遇到过同样的问题，这是我找到的最快的解决方案。

较新版本的 Qt 仍然存在与 Windows 的兼容性问题。但是，如果您决定尝试一下，请查看[Error while building native extensions for capybara-webkit](https://stackoverflow.com/questions/12936623/error-while-building-native-extensions-for-capybara-webkit/13163846)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-13T09:51:13.757

您尚未将 mingw 路径添加到您的环境中，因此构建过程无法进行。您必须遵循[https://github.com/thoughtbot/capybara-webkit/wiki/Installing-Qt-and-compiling-capybara-webkit](https://github.com/thoughtbot/capybara-webkit/wiki/Installing-Qt-and-compiling-capybara-webkit)并正确获取所有依赖项版本。

# python - 我如何进行这样的列表更改？

> ID：11835268
> 
> 赞同：0
> 
> 时间：2012-08-06T20:16:21.853
> 
> 标签：python

我需要一个 python 程序，它以列表开头，`a=[1]`然后将其更改为`2`then `3`...`5`然后添加另一个元素，列表变为`1,1`then`1,2`等，直到它变为`5,5`并添加另一个元素，然后变为`1,1,1`并继续，直到它有 11 个元素等于 5 所以它以`5,5,5,5,5,5,5,5,5,5,5`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:20:41.553

```
from itertools import chain, product

n = range(1, 6)
for a in chain.from_iterable(product(n, repeat=i) for i in range(1, 12)):
    # do whatever you want to with a 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T20:20:58.077

您可以将`for`循环与`itertools.product()`：

```
from itertools import product

for n in range(1, 12):
    for a in product(range(1, 6), repeat=n):
        # Do whatever you want to do for each of the tuples 
```

这不会创建在每次迭代中更改的单个列表，而是为每次迭代创建一个新元组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T20:22:32.147

由于这似乎是一个家庭作业问题，你只会得到一个让你走上正轨的答案。

在我看来，您想要以下行为：

```
[1]
[2]
[3]
[4]
[5]
[1,1]
[1,2]
[1,3]
[1,4]
[1,5]
[2,5] 
```

所以看起来你是在向前添加元素，然后向后增加它们。

我会查找模块化算术，看看如何使递增向后将列表清回 1。

一旦你这样做了，考虑 (x mod 4) + 1 的范围。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T21:05:56.743

这是一个函数，它可以在其进程的任何状态下接收此列表并知道如何处理它。抱歉，答案很长，我想提供尽可能多的帮助。我知道代码不是最好的。

```
def growth(mylist):
    new = False
    i = 0
    mylist = [r for r in reversed(mylist)]
    while new is False:
        if mylist[i] < 5:
            mylist[i] += 1
            break
        elif i == len(mylist)-1:
            new = True
        else:
            i+=1
        if i >= len(mylist):
            break
    if new == True:
        mylist = [1 for r in xrange(len(mylist)+1)]
    mylist = [r for r in reversed(mylist)]
    return mylist 
```

一些测试：

```
#get at start:
a = [1]
print a
for i in xrange(10):
    a = growth(a)
    print a 
```

结果：

```
>>> 
[1]
[2]
[3]
[4]
[5]
[1, 1]
[1, 2]
[1, 3]
[1, 4]
[1, 5]
[2, 5] 
```

和

```
print    
#get in middle:
a = [1,3]
print a
for i in xrange(10):
    a = growth(a)
    print a 
```

结果：

```
>>>
[1, 3]
[1, 4]
[1, 5]
[2, 5]
[3, 5]
[4, 5]
[5, 5]
[1, 1, 1]
[1, 1, 2]
[1, 1, 3]
[1, 1, 4] 
```

最后：

```
print
#get late:
a = [1,1,3,5]
print a
for i in xrange(10):
    a = growth(a)
    print a 
```

结果：

```
>>>
[1, 1, 3, 5]
[1, 1, 4, 5]
[1, 1, 5, 5]
[1, 2, 5, 5]
[1, 3, 5, 5]
[1, 4, 5, 5]
[1, 5, 5, 5]
[2, 5, 5, 5]
[3, 5, 5, 5]
[4, 5, 5, 5]
[5, 5, 5, 5] 
```

# mysql - 有人知道如何扩展 Amazon RDS 只读副本吗？

> ID：11835271
> 
> 赞同：16
> 
> 时间：2012-08-06T20:16:45.917
> 
> 标签：mysql, amazon-web-services, replication, amazon-rds

我最近设置了一个只读副本，以减轻我的 Amazon 多可用区 RDS 实例的一些读取负载。亚马逊文档明确指出，“由您的应用程序决定读取流量如何在您的只读副本中分布”。

有没有人想出一种可管理的方式来扩展只读副本？将我的应用程序的不同部分硬编码以从特定副本读取，这似乎不是一个非常可扩展的解决方案。有没有一种类似于将 EC2 实例放在负载均衡器后面的方法来设置它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T08:58:42.143

[AWS 工程师在此处](http://www.quora.com/What-is-the-best-way-to-distribute-read-traffic-among-Amazon-RDS-read-replicas)对这个问题提供了一些见解。

以下是他的回应片段：

> 一般来说，您可以在以下 3 个逻辑位置对流量进行负载平衡：
> 
> *   应用层 - 创建多个连接池并将所有读取发送到只读副本。
> *   Web 框架/中间件 - 一些 Web 框架具有对多个数据库的内置支持 [1]。
> *   外部代理 - 您可以使用外部代理，如 MySQLproxy [2]。
> 
> [1] - [https://docs.djangoproject.com/en/dev/topics/db/multi-db/](https://docs.djangoproject.com/en/dev/topics/db/multi-db/)
> 
> [2] - [https://launchpad.net/mysql-proxy](https://launchpad.net/mysql-proxy)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-30T11:26:20.527

我认为[HAProxy](http://cbonte.github.com/haproxy-dconv/configuration-1.5.html)将是在多个只读副本之间进行负载平衡的不错选择。你可以有这样的配置：

```
 listen mysql-cluster 0.0.0.0:3306
     mode tcp
     balance roundrobin
     option mysql-check user root

     server db01 x.x.x.x:3306 check
     server db02 x.x.x.x:3306 check
     server db03 x.x.x.x:3306 check 
```

其中 xxxx 是副本端点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-31T19:37:59.310

我一直在搞乱使用 Route 53 加权 CNAME 来负载平衡 RDS 只读副本（和源）。我目前有 readdb.example.com 的 3 个 CNAME 记录集。

第一个指向 db.example.com 上的源数据库。这是为了防止出现复制错误。应用程序可以回退到原始数据库进行读取。或者，如果您愿意，您可以让源承担一定比例的读取负载，具体取决于您设置权重的方式。路由策略设置为加权。我将源的权重设置为 1，因此读取负载的负担非常小。TTL 设置为低。我尝试了从 1 到 10 的值。我现在将其保留为 10。您还必须输入任何唯一字符串（“源数据库”）的集合 ID。

第二个记录集指向其中一个只读副本 (readdb1.blahblah.rds.amazonaws.com)。路由策略是加权的，TTL 和以前一样是 10。它还需要一个唯一的 Set ID。我将这个重量设置在 5-50 之间，具体取决于。这个，我确实与健康检查相关联，你必须提前创建。您可能可以使用指向副本的简单运行状况检查，但我做了一些不同的事情。

我在我的每个应用程序服务器上都放了一个这样的文件（我使用的是 PHP Elastic Beanstalk，但你可以在我假设的其他设置/语言中做类似的事情）：

```
<?php if($instanceid = $_GET["id"]): ?>
<?php
exec("aws rds describe-db-instances --db-instance-identifier " . escapeshellarg($instanceid), $rdsinfo);
$rdsinfo = implode(' ',$rdsinfo);
$rdsinfo = json_decode($rdsinfo, true);
if($rdsinfo["DBInstances"][0]["StatusInfos"][0]["Normal"] && $rdsinfo["DBInstances"][0]["DBInstanceStatus"] === "available"){
    echo "GOOD!";
    }
else {
    echo "BAD!";
    };
/* Then there's some other stuff in here that is a little unrelated to the question */
?>
<?php endif ?> 
```

此文件使用安装在 Elastic Beanstalk 应用程序上的 AWS 命令​​行界面，并且只需要提前指定 AWS_ACCESS_KEY_ID、AWS_DEFAULT_REGION 和 AWS_SECRET_KEY 的环境变量。然后，您进行指向[http://www.example.com/rdshealthcheck/rdsshealthcheck.php?id=readdb1](http://www.example.com/rdshealthcheck/rdsshealthcheck.php?id=readdb1)的 Route 53 健康检查。您将搜索字符串设置为“GOOD！” 我认为搜索字符串的费用为 1 美元/月/健康检查，这似乎是合理的。

如果您有第二个只读副本，您可以创建另一个指向[http://www.example.com/rdshealthcheck/rdsshealthcheck.php?id=readdb2](http://www.example.com/rdshealthcheck/rdsshealthcheck.php?id=readdb2)或其他名称的运行状况检查。

我实际上此时只使用了一个只读副本，但它比我的源数据库大得多。这对我来说更经济，因为我的源数据库是多可用的。我保留第三个记录集和第二个健康检查，以防第一个副本给我带来问题。这样，我不必等待第一个删除再重新启动它。相反，我立即删除第一个并使用第三个记录集中指定的名称（和第二个健康检查）启动第二个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-19T11:09:31.633

我想建议更方便的方法。
即，使用[Amazon Route 53进行](http://aws.amazon.com/route53/)[DNS 循环](http://en.wikipedia.org/wiki/Round-robin_DNS)。

正如您在[本文](http://www.think-lamp.com/2012/12/weighted-round-robin-dns-for-route53/)中看到的，
[Amazon Route 53](http://aws.amazon.com/route53/)可以使用多个 CNAME 进行循环。

那么你需要做的就是

1.  在 Route 53 的“创建记录集”。
2.  更新应用程序的配置文件。

就我而言，这种方法效果很好。

# javascript - 在这个受限的设置中， eval() 会导致安全问题吗？

> ID：11835272
> 
> 赞同：5
> 
> 时间：2012-08-06T20:16:49.680
> 
> 标签：javascript, security

我正在写一个包含一些数学练习的网站。我不在乎用户是否试图作弊，所以我通过 Javascript 更正答案

在我的具体情况下，我在表单中有一个字段。我想让用户输入一个数学表达式（比如 3/2）并使用它的结果来判断用户是否正确。为此，我会使用 eval。

我的 javascript 永远不会直接从 URL 中读取，而只是从表单中读取。不会存储此页面的任何结果以显示给任何用户（也许我们稍后会保留统计分析的结果，然后通过 PHP 将其存储在数据库中，但话又说回来，我可能需要清理 PHP 本身的任何输入，怕用户直接用POST）

有什么可能出错？=P

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T20:19:56.813

您需要确保不会有任何非法内容进入`eval`可能会破坏脚本的内容（这可能是有意或无意的 - 不是攻击，而是用户错误）。我会说要么在 eval 之前验证该字段以确保它是算术的，而且只有这样。

不管用例如何，`eval`一般来说，在任何编程语言中都被普遍认为是一种糟糕的做法。当然，这里没有真正的安全问题，但干净和可靠的代码是有价值的。

我建议看一下[Javascript Expression Evaluator](http://silentmatt.com/javascript-expression-evaluator/)来代替`eval`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T20:22:03.333

> 有什么可能出错？

由于 Javascript 都是客户端，并且您没有向服务器发送或保存任何内容，因此实际上什么都没有。聪明的用户可以通过破坏自己的页面或通过将脚本放入框中来弹出警报来自娱自乐，但他们也可以通过开发人员控制台来做到这一点。只要一切都保持在 Javascript 端，*您*就应该非常安全，并且可以通过简单的页面刷新来修复任何损坏。

尽管如此，经过更多思考，通过至少一种基本方式验证输入以避免副作用似乎是一个好主意和好实践。虽然 OP 询问它是否安全，而不是它是否专业，但似乎值得一提的是，一个坚实、专业的感觉页面应该确保输入只有预期的效果。

# django - Django：TemporaryUploadedFile生命的控制时间

> ID：11835274
> 
> 赞同：2
> 
> 时间：2012-08-06T20:17:01.790
> 
> 标签：django, file-upload

我的 django 应用程序中有表单。用户可以在提交表单之前预先上传文件。在上传文件的处理程序中，我使用 TemporaryUploadedFile。所以 - 文件存储在 /tmp 目录中。此处理程序将响应发送到表单 - JSON 对象，其中包含文件路径和文件扩展名。此信息以数组形式收集。

提交表单后，该数组将被序列化。这就是问题所在 - 当表单处理程序接收表单数据和文件名数组并尝试访问这些文件时 - 这是错误“没有这样的文件”。

所以，我的问题是 - 我该如何解决这个问题？也许我可以将这些文件的生命周期设置为更长的时间？或者也许我应该使用 UploadedFile 而不是 TemporaryUploadedFile。

蒂亚！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:11:20.853

`TemporaryUploadedFile`使用`tempfile.NamedTemporaryFile`. [Python 文档](http://docs.python.org/library/tempfile)有这样的说法：

> ```
> tempfile.NamedTemporaryFile([mode='w+b'[, bufsize=-1[, suffix=''[, prefix='tmp'[, dir=None[, delete=True]]]]]]) 
> ```
> 
> 此函数的操作与 TemporaryFile() 完全一样，除了文件保证在文件系统中具有可见名称（在 Unix 上，目录条目未取消链接）。该名称可以从文件对象的名称属性中检索。在命名的临时文件仍处于打开状态时，是否可以使用该名称再次打开文件，因平台而异（在 Unix 上可以这样使用；在 Windows NT 或更高版本上不能）。*如果 delete 为真（默认），则文件一关闭就会被删除*（强调我的）。
> 
> 返回的对象始终是类文件对象，其文件属性是底层的真实文件对象。这个类文件对象可以在 with 语句中使用，就像普通文件一样。

因此，这里的默认行为是在文件关闭后立即删除文件，这将在初始处理后自动删除。所以你有两个选择。您可以子类[`TemporaryUploadedFile`](https://github.com/django/django/blob/1.3.1/django/core/files/uploadedfile.py)化并覆盖该`__init__`方法，以便您可以传递`delete=False`给`tempfile.NamedTemporaryFile`（但是您需要记住在完成后手动删除文件以避免旧临时文件的堆积），或者您可以确保移动您的`TemporaryUploadedFile`在处理上传返回之前的其他地方，然后将新位置发回。

它不适合使用`UploadedFile`，因为它是一个基类，并且本身不打算被实例化。

# encryption - 实例化 MD5CryptoServiceProvider 时出现 bcrypt.dll 异常

> ID：11835277
> 
> 赞同：0
> 
> 时间：2012-08-06T20:17:18.730
> 
> 标签：encryption, .net-4.0, md5

我们在我们的应用程序中使用 MD5 哈希算法。我们的一位用户在线上遇到以下异常

```
Dim hasher=new MD5CryptoServiceProvider 
```

例外状态（荷兰语）

> 异常：System.DllNotFoundException；源 Kan DLL bcrypt.dll niet laden：Ongeldige toegang tot geheugenlocatie。（Uitzondering van HRESULT：0x800703E6）；消息： bij Microsoft.Win32.Win32Native.BCryptGetFipsAlgorithmMode(Boolean& pfEnabled) bij System.Security.Cryptography.CryptoConfig.get_AllowOnlyFipsAlgorithms() bij System.Security.Cryptography.MD5CryptoServiceProvider..ctor()

这意味着由于对内存位置的无效访问，无法加载 brcrypt.dll。

brcrypt.dll 存在于用户的 Sytem32 文件夹中。

这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T20:48:55.043

客户的电脑很快就崩溃了，不得不修理。重新安装了 Windows。问题消失了。

# php - 为什么我不能提交表格？PHP 卷曲

> ID：11835283
> 
> 赞同：0
> 
> 时间：2012-08-06T20:18:07.730
> 
> 标签：php, post, curl

我正在尝试编写一个脚本来获取我当月的数据使用情况，并导航我正在使用 cURL 的 url。不幸的是，我不熟悉它。到目前为止，这是我的代码：

```
<?php

$url = 'https://apps.nwtel.ca/cable_usage/login.jsp' ;
$id = "------------" ;

$ch = curl_init() ;
curl_setopt( $ch, CURLOPT_URL, "$url" ) ;
curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true ) ;
curl_setopt( $ch, CURLOPT_POST, true ) ;
curl_setopt( $ch, CURLOPT_SSL_VERIFYPEER, false ) ;
curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, true ) ;

$data = array(
    'MAC' => "$id",
    'submit_btn' => 'submit'
) ;

curl_setopt( $ch, CURLOPT_POSTFIELDS, $data ) ;
$output = curl_exec( $ch ) ;
curl_close( $ch ) ;

echo "$output\n" ;

?> 
```

但由于某种原因，这不起作用。我尝试了很多变化，但输出总是相同的。它给了我原始页面。有谁知道我做错了什么？几个小时以来，我一直在努力解决这个问题。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:25:07.633

我不是 100% 确定，但是在查看了 url 的来源之后，我觉得你应该卷曲表单的动作，而不是表单所在的页面。你正在模拟提交，因此你应该尝试将表单内容提交给表单的操作。

```
<form method="post" action="j_security_check" id="usage_login">
    <input type="hidden" name="j_target_url" value="secured/index.jsp" />
    <div class="form_input">
    <label for="MAC">HFC or CM MAC Address:</label>
    <input type="Text" name="MAC" id="MAC" onKeyPress="onKeyPress(this.form)" />
    <a href="#mac_num_help" title="Your HFC or CM MAC Address is located on the sticker on the bottom of your modem" class="help">MAC Address Help</a>
    <input type="hidden" name="j_username" id="j_username" />
    </div>
    <div class="form_input">
    <input type="hidden" name="j_password" id="j_password" maxlength="6" size="7" value="123456" />
    </div>
    <div class="form_input">
    <label for="submit_btn">&nbsp;</label>
    <input type="submit" name="submit_btn" id="submit_btn" value="Submit" onclick="fixAndSubmit(this.form)" />
    </div>
</form> 
```

尝试改变：

```
$url = 'https://apps.nwtel.ca/cable_usage/login.jsp' ; 
```

至

```
$url = 'https://apps.nwtel.ca/cable_usage/j_security_check' ; 
```

也改变

```
$data = array(
    'MAC' => "$id",
    'submit_btn' => 'submit'
) ; 
```

至

```
$data = array(
    'MAC' => "$id",
    'submit_btn' => 'submit',
    'j_password' => '123456',
    'j_username' => '3D3D3D3D3D3D' //should be your MAC address all capitalize without using special characters
    'j_target_url' => 'secured/index.jsp'
) ; 
```

# android - WebView 不显示 gmail 消息

> ID：11835287
> 
> 赞同：0
> 
> 时间：2012-08-06T20:18:19.387
> 
> 标签：android, webview, gmail

我正在尝试创建一个应用程序来访问 gmail 帐户。我使用了带有 WebViewClient 的 WebView 并加载了网址[http://www.gmail.com](http://www.gmail.com)。请参阅下面的代码

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.email_main_layout);

    mWebView = (WebView) findViewById(R.id.webview);

    mWebView.getSettings().setJavaScriptEnabled(true);
    mWebView.getSettings().setPluginState(PluginState.ON);
    mWebView.getSettings().setAppCacheEnabled(true);
    mWebView.setWebViewClient(new EmailWebViewClient());
    mWebView.loadUrl("http://www.gmail.com");
} 
```

该网站正常加载。但是，登录后，电子邮件消息不显示，仅显示进度加载和其他选项。由于我可以在 android 浏览器中使用 gmail，我必须在我的 webview 中进行哪些设置才能正确显示 gmail？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:36:49.893

在 webview 属性中缺少设置的 DOM 存储

```
mWebView.getSettings().setDomStorageEnabled(true); 
```

# excel - 在 excel 2007 中使用交集查找列标题？

> ID：11835294
> 
> 赞同：0
> 
> 时间：2012-08-06T20:18:47.450
> 
> 标签：excel, excel-2007, vba

是否可以找到多个数据交集的列名。

例如：

```
name one two three four
Jon   A   B    A     C
Don   B   A    C     B
Ron   C   B    A     C 
```

条件是找到“Jon”和“A”的交集并返回列名。所以我的预期回报是“一”和“三”。

可以在公式中执行此操作，还是使用 vba 会更好。

在任何一种情况下，你能给我一个如何设置的例子吗？

谢谢。

更新：

我找到了一个公式来返回列名，（ExcelForum）：

```
=IF(SUMPRODUCT(((Data!$A$3:$A$54=$A$28)*(Data!$B$3:$AC$54=$G$25)))>0,INDEX(Data!$B$2:$AC$2,MATCH
($G$25,INDEX(Data!$B$3:$AC$54,MATCH($A$28,Data!$A$3:$A$54,0),0),0)),"") 
```

现在我意识到，如果我有多个其他列名与条件匹配的实例，我将不得不遍历列名，检查每个列名的相同条件，从而捕获所有符合条件的名称。

任何有关如何在 vba 中进行设置的帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:39:16.093

在尽可能多的单元格上输入数组函数，因为有可能要返回的列名。

**编辑**：更新为在返回数组作为行与列之间自动切换，并消除列名之间的间隙。

```
Function GetColumns(tbl As Range, rowName As String, val As String)

    Dim arr()
    Dim f As Range, x As Integer, numCols As Integer
    Dim i As Integer

    numCols = tbl.Columns.Count
    ReDim arr(1 To numCols - 1)
    i = 1

    Set f = tbl.Columns(1).Find(rowName, , xlValues, xlWhole)
    If Not f Is Nothing Then
        For x = 1 To numCols - 1
            If f.Offset(0, x).Value = val Then
                arr(i) = tbl.Cells(1, x + 1)
                i = i + 1
            End If
        Next x
    End If

    'fill the rest of the array
    For x = i To UBound(arr)
        arr(x) = ""
    Next x

    If Application.Caller.Rows.Count = 1 Then
        GetColumns = arr 'array formula in a row
    Else
        GetColumns = Application.Transpose(arr) 'in a column
    End If
End Function 
```

# php - arsort() 不稳定

> ID：11835295
> 
> 赞同：1
> 
> 时间：2012-08-06T20:18:50.613
> 
> 标签：php, sorting

**编辑：**[使用 PHP 的 uasort 进行排序时，](https://stackoverflow.com/questions/4353739/)这个问题似乎与Preserve key order (stable sort) 重复

有人一直在假设它是稳定排序的情况下对`arsort()`解析的数组进行排序。`HTTP_ACCEPT_LANGUAGE`但它不是：[https://bugs.php.net/bug.php?id=53553](https://bugs.php.net/bug.php?id=53553)。现在我有一个错误，我有点茫然如何在不求助于黑客的情况下修复错误。

我有来自移动客户端的这个标头：

```
HTTP_ACCEPT_LANGUAGE: de-CH, en-US 
```

这被解析为：

```
Array (
    [de-CH] => 1
    [en-US] => 1
) 
```

解析后`arsort($array, SORT_NUMERIC)`用于对它们的q值对应的语言进行排序。但是因为德语和英语具有相同的 q 值，所以`arsort()`交换了德语和英语。如何对数组进行排序以保留插入顺序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:44:40.463

如果您只是在寻找首选语言，则不需要对数组进行排序：

```
<?php

function findPrefferedLanguage($languages) {
  foreach ($languages as $lang => $weight) {
    if (empty($key) || ($weight > $languages[$key])) {
      $key = $lang;
    }
  }

  return $key;
}

$foo = array('es' => .6, 'en' => 1, 'fr' => 1, 'de' => .5);    

var_dump(findPrefferedLanguage($foo)); // en 
```

仓促测试......可能有一些边缘情况会产生错误/警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:33:18.593

您的问题不是排序函数的不稳定性质，而是您有两个具有相同值的元素，但您希望一个元素在另一个之前排序。

如果`de-CH`应该加权高于`en-US`，表明客户更喜欢德语而不是英语，那么*不要给他们两个值`1`*。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-15T18:25:22.470

足够疯狂的PHP :)

**它已经在文档中提到**

[http://php.net/manual/en/function.arsort.php](http://php.net/manual/en/function.arsort.php)

> 如果两个成员比较相等，则它们在排序数组中的相对顺序是未定义的。

有趣的是，它在 PHP 7 中的工作方式不同

# mercurial - Mercurial - 多个头阻止推送，因为命名分支是在中途完成的

> ID：11835296
> 
> 赞同：0
> 
> 时间：2012-08-06T20:18:52.443
> 
> 标签：mercurial

我已经从默认（唯一）分支克隆了存储库。做了很多工作，有很多提交。我最终想将当前更改作为单独的开发流推送回存储库。所以我做了一个 hg 分支 8-2-。拉取当前在存储库中的内容（仍然只有默认分支）。合并对我的东西的更改。现在，当我尝试执行 hg push --new-branch 时，仍然会收到多头警告：

> 中止：推送创建新的远程头 57550f12d0f6！（你忘记合并了吗？使用 push -f 强制）

做了一个汞头：

> 变更集：132:8ab701e45e38 分支：8-2- 标签：tip 父级：131:3f2c30e8396d 父级：129:a45e28d1ef1b 用户：
> Vance Neff 日期：2012 年 8 月 6 日星期一 14:55:14 -0400 摘要：合并意外头部
> 
> 变更集：129:a45e28d1ef1b 用户：Vance Neff 日期：2012 年 8 月 2 日星期四 14:15:08 -0400 摘要：为变更集 7d88ac157486 添加了标签 8-1-29
> 
> 变更集：113:57550f12d0f6 用户：Vance Neff 日期：2012 年 8 月 2 日星期四 18:29:32 -0400 摘要：为变更集 4ab1691d7120 添加了标签 8-2-29

我看到有问题的头是在我执行 hg 分支 8-2-，变更集 113 之前的最后一次提交。

我该如何解决这个问题？注意：我已经阅读了所有关于在这里使用命名分支的警告。为时已晚。

谢谢万斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T09:34:53.530

I can’t see exactly what you did there and the current state of your repository, but it looks like you need to merge the two changesets on `default` together.

```
hg update 129
hg merge 113
hg commit -m "merge" 
```

After that you will only have one head on `default` again and all is well.

Alternatively, you can use the `strip` command to remove all your (un-pushed) changes that went wrong. Then you can redo them. Note, make sure only to strip changesets appearing in `hg outgoing` so that you don’t remove any public changesets.

Tip: when I don’t feel confident about a command I’m about to run, I usually make a clone or copy of the repository before executing it, so that I can always easily revert back to the original state. One of the blessings of DVCS :).

# mysql - mySQL 用变量搜索和替换函数

> ID：11835297
> 
> 赞同：1
> 
> 时间：2012-08-06T20:18:54.110
> 
> 标签：mysql, replace

我试图自己解决这个问题（我查看了[这个](https://stackoverflow.com/questions/3630944/mysql-search-replace-with-wildcards-query)stackoverflow 问题），但我碰壁了！

我想做一个“查找和替换”mySQL 查询，将记录中的 html 链接转换为新格式。我认为最简单的方法是创建一个要替换的术语字典。问题是我不知道字典的语法。这是基本的查询思想：

```
 /*dictionary of terms to replace*/
    @dic = '/site1', '/site2,' '/site3,'

    /*create dictionary of replacement terms*/
    @rep = '/newsite1', '/newsite2', '/newsite3'

    UPDATE table_name 
    SET body = REPLACE(body, @dic, @replace)
    where content_id = 11; 
```

感谢您提供的任何指导！

# c# - C#等待while循环的一部分完成以执行另一个动作

> ID：11835299
> 
> 赞同：1
> 
> 时间：2012-08-06T20:18:58.247
> 
> 标签：c#

我正在尝试将一个值转换为另一个值。我正在使用 streamreader/writer 导入一个文本文件。我想知道我是否可以让 if 语句中的 while 循环的一部分等到循环的其余部分完成，然后再编写它应该写的内容。我知道这可能是一个简单的问题，但出于某种原因，我可以把手指放在上面。我没有使用多线程处理并且想远离异步。

```
using (StreamReader reader = new StreamReader(convertInput))
{
    string line;
    writer.WriteLine(formatter, "Original Value", "Converted Value");
    writer.WriteLine(formatter, "--------------", "---------------");
A:  while ((line = reader.ReadLine()) != null)
    {
            string str2BeConverted = line;
            long numHexToDex;
            if ((Int64.TryParse(line, NumberStyles.HexNumber, null, out numHexToDec)) == false)
            {
                    writer.WriteLine();
                    writer.Write(line + " " + "is not a Hexadecimal value.");
                    goto A;
            }

            Int64.TryParse(line, NumberStyles.HexNumber, null, out numHexToDec);
            string lineChanged = numHexToDec.ToString("G");
    }
} 
```

我想等到所有成功解析的值都被写入，然后再写入最后没有的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T20:24:30.027

最简单的方法是将这些写入某种缓冲区，例如 StringBuilder，然后在处理完所有成功的元素后将 StringBuilder 的内容写入：

```
using (StreamReader reader = new StreamReader(convertInput))
{
    string line;
    Stringbuilder builder = new StringBuilder();
    writer.WriteLine(formatter, "Original Value", "Converted Value");
    writer.WriteLine(formatter, "--------------", "---------------");
    while ((line = reader.ReadLine()) != null)
    {
            string str2BeConverted = line;
            long numHexToDex;
            if ((Int64.TryParse(line, NumberStyles.HexNumber, null, out numHexToDec)) == false)
            {

                    builder.AppendLine();
                    builder.Append(line + " " + "is not a Hexadecimal value.");
                    continue; //there is ALWAYS an alternative to goto
            }

            Int64.TryParse(line, NumberStyles.HexNumber, null, out numHexToDec);
            string lineChanged = numHexToDec.ToString("G");
    }

    writer.Write(builder.ToString();
} 
```

此外，正如许多评论所说，使用`goto`的代码永远不是好代码。总有一些你可以做的更正确的事情，在这种情况下它非常简单（`continue`关键字将绕过循环块的其余部分，重新​​评估 while 条件，并在指示时进一步迭代）。

# html - 404 错误将“警报”句子从 python 传递到 html 页面，但仅传递一个单词没有错误

> ID：11835306
> 
> 赞同：0
> 
> 时间：2012-08-06T20:19:22.640
> 
> 标签：html, python-2.7, alert

**更新**：我收到的错误消息是 404 Resource not found。

```
"GET /unexpected/The%20Notebook%20name%20is%20taken%20already HTTP/1.1" 404 - 
```

发生该错误时，URL 如下所示。

```
http://localhost:8088/unexpected/The%20Notebook%20name%20is%20taken%20already 
```

我试图为我的应用程序中的用户错误创建一种“警报”系统非常糟糕。在我看来，单词之间的空格是问题所在。但必须有一种简单、优雅的方式来做到这一点。

在下面的两行中，上一行有效，但下一行无效。

```
return webapp2.redirect("/unexpected/%s" % 'Hello')
# return webapp2.redirect("/unexpected/%s" % 'The Notebook name is taken already') 
```

对应的定义如下。在这里，我希望注释掉的行会起作用，但它也不会。

```
class Unexpected(BaseHandler):

    def get(self, reason):
        template_values = {'reason':reason}
        path = os.path.join(TEMPLATE_DIR, 'unexpected.html')
        self.response.out.write(template.render(path, template_values))
        # return webapp2.redirect('/unexpected/%s/ % reason')

app = webapp2.WSGIApplication([
        ('/', MainPage), 
        ('/unexpected/([\w]+)', Unexpected)]) 
```

如何获取发送到`unexpected.html`页面的消息？我以前用 javascript Alerts 做过这个，但我试图不在这里使用 javascript。

```
{% extends "base.html" %}
{% block content %}

This unexpected result occurred: {{ reason }}
<br >
Click the back button and edit your entry.

{% endblock content %} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:26:42.407

我的问题是我试图在`def get(`没有数据存储模型的情况下将信息传输到`def get(`. 我已经定义了一个`def get(`使用名为的数据存储模型，该模型将`Trans`包含在我的句子中的此类事务信息存储在名为 的变量中`reason`。

```
class Trans(db.Model):
    reason = db.StringProperty() 
```

我的模型命名`Unexpected`如下所示。

```
class Unexpected(BaseHandler):

    def get(self):
    trans=Trans.get_by_key_name('reason')
    template_values = {'trans':trans}
        path = os.path.join(TEMPLATE_DIR, 'unexpected.html')
        self.response.out.write(template.render(path, template_values)) 
```

我的python代码如下。

```
reason='That Notebook name is taken already.'
    trans = Trans(key_name='reason')
    trans.reason=reason
    trans.put()
    template_values = {'trans':trans}
    path = os.path.join(TEMPLATE_DIR, 'unexpected.html')
    self.response.out.write(template.render(path, template_values)) 
```

我的`unexpected.html`代码如下。

```
{% extends "base.html" %}
{% block content %}
This unexpected result occurred: <emph style="font-weight: bold">{{ trans.reason }}</emph>
<br /><br />
<label>Click the "Ok" button and to go back to the previous page so you can edit your entry .
</label>
<form action="" method="post">
<input type="hidden" name="reason" value=""></input><br />
  <input type="submit" value="Ok"/>
</form>
{% endblock content %} 
```

# ruby-on-rails - 当连接表中有额外的属性时，通过关联保存has_many, :through

> ID：11835311
> 
> 赞同：0
> 
> 时间：2012-08-06T20:19:51.220
> 
> 标签：ruby-on-rails, activerecord, has-many-through

这个问题之前好像被问过很多次了，但是我没有看到任何地方都得到了满意的回答。

我有三个表/模型：

```
skill
----------------------------------
id
label

user
----------------------------------
id
username
(many other irrelevant attributes)

user_skill
----------------------------------
id
user_id
skill_id
current_proficiency_level
interest_level 
```

所以每个用户都有任意数量的技能，每个用户都可以指出他现在对该技能的熟练程度（也许我是 PHP 的 2 级）然后你的兴趣水平是什么（但也许我想学习 PHP，所以我的兴趣水平是8）。

我想知道保存这些`UserSkill`记录的最简单、“最默认”的方式是什么。

我们现在不用担心我的`User`对象获取`UserSkill`记录的格式。让我们假设我有一些用户，并且我想在保存对象`UserSkill`时保存 10 条记录`User`。我该怎么做？

（顺便说一下，我一般都相当精通 Rails，我只是还没有费心去找出进行这种保存的“正确”方法。所以如果你参考其他 Rails 术语/实践，我'可能会知道你在说什么。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:37:54.103

通常，`has_many :through`如果要操作连接表，则使用。

参见这里，例如： http: [//guides.rubyonrails.org/association_basics.html#choosing-between-has_many-through-and-has_and_belongs_to_many](http://guides.rubyonrails.org/association_basics.html#choosing-between-has_many-through-and-has_and_belongs_to_many)

在任何一种情况下，您都将以相同的方式将技能添加到用户：`@user.skills << a_skill_object`或`@user.skills = array_of_skill_objects`（这将删除已与 关联的任何技能`@user`）。

建立关联后，可以手动设置连接表上的属性：`@user.user_skills.first.current_proficiency_level = 42`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T20:16:18.167

我最终做了`@user.user_skills = (values)`。

# symfony - 我如何将 url 地址写入 symfony2 的 Resource/Public 中的 javascript 库中？

> ID：11835313
> 
> 赞同：0
> 
> 时间：2012-08-06T20:19:54.293
> 
> 标签：symfony

> 我正在创建一个库，我需要在其中使用 url 链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:41:51.317

也许你想使用这个包：

[http://knpbundles.com/FriendsOfSymfony/FOSJsRoutingBundle](http://knpbundles.com/FriendsOfSymfony/FOSJsRoutingBundle)

# sharepoint - Sharepoint 2010 - XSL：添加到 ItemStyle.xsl 时导入不起作用

> ID：11835315
> 
> 赞同：0
> 
> 时间：2012-08-06T20:19:58.460
> 
> 标签：sharepoint, xslt, sharepoint-2010, sharepoint-designer

我目前有自定义 XSL 文件，我通过在代码视图中手动添加内容查询 Web 部件的 ItemXslLink 属性将这些文件添加到内容查询 Web 部件中。我一直在阅读可以使用 XSL 文件中的 XSL:import 标记来引用外部 XSL 样式表。我不希望在 ItemStyle.xsl 中输入自定义模板，因为这很混乱并且可能被覆盖。

我一直非常密切地按照以下链接中的说明进行操作，并且自定义 XSL 没有出现在我的内容查询 Web 部件的项目样式下拉列表中。[http://spxslt.codeplex.com/wikipage?title=Usage](http://spxslt.codeplex.com/wikipage?title=Usage)

这是我的导入代码，包含在与 ItemStyle.xsl 相同的 XSL 样式表文件夹中。引用的文件是具有适当样式表封闭标记的适当 XSL。

```
<xsl:stylesheet 
version="1.0" 
exclude-result-prefixes="x d xsl msxsl cmswrt"
xmlns:x="http://www.w3.org/2001/XMLSchema" 
xmlns:d="http://schemas.microsoft.com/sharepoint/dsp" 
xmlns:cmswrt="http://schemas.microsoft.com/WebParts/v3/Publishing/runtime"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
<xsl:import href="MyCustomXsl.xsl" /> 
```

关于为什么这个看似简单的 xsl:import 不起作用的任何想法？非常感谢您的帮助，因为此功能将为我正在从事的项目提供出色的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T02:17:50.793

提供此 MyCustomXsl.xsl 的路径可能是明智的，因为省略它可能会导致某些错误。

# asp.net - 间歇性问题 - 发送重复的电子邮件

> ID：11835317
> 
> 赞同：0
> 
> 时间：2012-08-06T20:20:01.040
> 
> 标签：asp.net, vb.net, email

我有一些代码可以在我的 APP_CODE 目录中发送电子邮件：

将消息暗淡为 Mail.MailMessage = New Mail.MailMessage(strFrom, strSendTo)

```
 Dim SMTP_Client As Mail.SmtpClient = New Mail.SmtpClient("mymailserver.mycompany.com")

    'Send email
    Try
        message.Priority = Mail.MailPriority.Normal
        message.IsBodyHtml = True
        message.Subject = strSubject
        message.Body = strBody & vbCrLf & vbCrLf & vbCrLf & vbCrLf & "THIS IS AN AUTOMATED MESSAGE. DO NOT REPLY."
        SMTP_Client.Send(message) 
```

问题是一些用户会**间歇性地**收到重复的电子邮件。这似乎不是代码问题。当我单步执行代码时，我可以看到发送电子邮件的调用只触发一次。我想可能是在 Page_Load 中调用了代码，但是单步执行代码会在我的按钮单击事件之前显示 Page_Load 触发。

我想知道这是否不是我们的 SMTP 中继的问题；如果是，有谁知道我应该告诉我的服务器管理员监控的事情？

**编辑**

在发送电子邮件之前，有一些代码会检查两个表单字段的值。第二个字段在页面加载期间更新，我可以看到如果值相同，则不会触发电子邮件。当我进行更改时，电子邮件会被发送，但我总是收到一封且只有一封。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:14:01.773

恕我直言，您的第一步应该是将问题隔离到代码或交换服务器。您可以通过在代码中添加一些日志记录来做到这一点。

每次通过代码发送电子邮件时，记录此事件以及所有相关信息（即：发送日期、电子邮件地址、发送电子邮件的进程等）。

现在，当您收到重复的电子邮件时，您可以检查日志以查看代码是否多次发送电子邮件。

在您开始深入研究问题之前隔离这一事实肯定会为您节省一些时间来查找问题。

# objective-c - html 实时流从 php 服务器接收帧或视频？

> ID：11835318
> 
> 赞同：0
> 
> 时间：2012-08-06T20:20:03.317
> 
> 标签：objective-c, ios, macos

我想知道是否可以使用我的 php 服务器中的 flash 传输实时视频并将其发送到我的 iphone？我在想如果闪光灯不起作用，我会逐帧传输它。我需要帮助来寻找可以让我从我的 php 服务器接收实时视频的源代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:57:11.763

好吧，您需要将视频转换为 hls 以将其传输到 iphone。您无法从闪存服务器流式传输到 iPhone。只要输入具有周期性 I 图片，您就可以简单地将您的内容（无需重新编码）重新组合到 hls。要了解细节，请阅读以下内容：http: [//www.ioncannon.net/programming/452/iphone-http-streaming-with-ffmpeg-and-an-open-source-segmenter/](http://www.ioncannon.net/programming/452/iphone-http-streaming-with-ffmpeg-and-an-open-source-segmenter/)

如果您不介意使用命令行工具，请使用 ffmpeg。它应该能够接收您的实时流，然后从中创建一个 hls 输出。确保转储到 http 服务器，您可以从 iPhone 访问内容。

# javascript - Highstock 图表在清除后不显示

> ID：11835320
> 
> 赞同：0
> 
> 时间：2012-08-06T20:20:12.740
> 
> 标签：javascript, jquery, highcharts, highstock

我正在尝试制作一个简单的页面，其中在页面加载和两个按钮上会有一个 Highstock 图表，一个用于删除图形，另一个用于重新加载它。但是，一旦单击第一个按钮以清除内部图表的容器，随后单击第二个按钮不会重新加载图表。我怎样才能重新加载它？小提琴位于[http://jsfiddle.net/Cupidvogel/DCkmN/](http://jsfiddle.net/Cupidvogel/DCkmN/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:24:32.640

当您出于某种原因清除它时，您会丢失图表选项数组。您可以像[这样](http://jsfiddle.net/5eWn7/)在函数本身中创建它。

或者更好的是把它移到它自己的函数中，这样你就可以像[这样](http://jsfiddle.net/FvhZ8/1/)重用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T20:49:11.640

如果您调试，您会看到 chartingOptions 没有被清除。它的系列属性在构造函数调用后立即变为空。对我来说似乎是一个错误。或者可能是为了避免克隆系列选项中包含的大量数据，而只是使用相同的对象来绘制图表。

这就是源代码所说的，

```
 userOptions.series = null; 
```

userOptions.series 属性在被复制后被故意设置为 null 以进行构造。

```
 /**
    * The chart class
    * @param {Object} options
    * @param {Function} callback Function to run when the chart has loaded
    */
    function Chart(userOptions, callback) {
    // Handle regular options
    var options,
    seriesOptions = userOptions.series; // skip merging data points to increase performance
    userOptions.series = null; 
```

# jquery - Jquery从SerialScroll onBefore函数返回pos vairable

> ID：11835322
> 
> 赞同：0
> 
> 时间：2012-08-06T20:20:15.077
> 
> 标签：jquery, variables, serialscroll

我正在为我的公司开发一个滚动站点，我们正在使用 SerialScroll 来完成滚动。令人沮丧的是，我终其一生都找不到实现后退按钮的好方法，即使用户体验不需要它起作用，我的老板也有一个糟糕的经历，以前的合同开发人员花了一年时间修复最后一个站点上的后退按钮。所以他们甚至不愿意在这个问题上听我的。

serialScroll 使用一个常量变量作为位置，我的想法，虽然可能很天真，但会找到一种方法来从 serialScroll 函数外部更新该位置变量。这样当点击后退按钮时，我可以更新serialScroll位置？？？我终生无法找到解决方案，或者是否有可能？任何帮助将不胜感激。

这是我当前的功能：

```
$(function(){
var next_btn = $('#sec0_nav a.next');
var prev_btn = $('#sec0_nav a.prev').hide();

        $('#wrapper').serialScroll({
            target:'#sec',
            items:'.prod_list', 
            prev: prev_btn,
            next: next_btn, 
            axis:'x',
            navigation:'#prod_nav li a',
            duration:500,
            force:true,
            cylce: false,

            onBefore:function( e, elem, $pane, $items, pos ){

                prev_btn.add(next_btn).show();  
                    if( pos == 0 )prev_btn.hide();
                else if( pos == $items.length -1 )
                    next_btn.hide();

                    $('.prod_list').removeClass('current'); 

        },//end onBefore    

        onAfter:function(elem) {
            var posPlace = (elem).id; 
                location.hash = posPlace; 
                    $(elem).addClass('current');

            }//End onAfter

    });//end serialScroll

 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T14:51:35.430

实际上，在 Dreamweaver 中打开类文件有一种非常可悲的方式。如果您使用dreamweaver 的搜索功能，它搜索文件并且您为类文件设置了extensions.txt，那么dreamweaver 将搜索类文件并返回resutls。之后，您现在可以双击结果，它将在 Dreamweaver 中打开类文件。这是 Adob​​e 为了打开类文件而忘记禁用的唯一地方。

# java - android - dropbox api - 如何查找和上传文件

> ID：11835323
> 
> 赞同：0
> 
> 时间：2012-08-06T20:20:18.543
> 
> 标签：java, android, file, upload, dropbox

我正在使用 Dropbox api，我想在 Dropbox 上上传一个文件。Dropbox 中将有一个同名文件需要被覆盖。

我试过这段代码来找到文件profiles.txt，然后上传它，但我总是找不到文件。

```
// create the file
FileOutputStream file = openFileOutput("profiles.txt", MODE_WORLD_READABLE);
// download the contents from the online file into the newly created file
DropboxFileInfo info = mDBApi.getFile("/profiles.txt", null, file, null);
// close the file
file.flush();
file.close();

// read the file
FileInputStream fstream = openFileInput("profiles.txt");
InputStreamReader isr = new InputStreamReader(fstream);
char[] inputBuffer = new char[7];
isr.read(inputBuffer);
String readString = (new String(inputBuffer)).trim();
int id = Integer.parseInt(readString);

// record your id
SharedPreferences mySharedPreferences = getSharedPreferences("User_info_file", MODE_PRIVATE);
SharedPreferences.Editor editor = mySharedPreferences.edit();
editor.putString("TEXT_ID_KEY", readString);
editor.commit();

// create the new file with the new id
file = openFileOutput("profiles.txt", MODE_WORLD_READABLE);
OutputStreamWriter osw = new OutputStreamWriter(file);
osw.write(String.format("%d", id+1));
osw.flush();
osw.close();

File file2 = new File("profiles.txt");
String ab_path = (Tab_User_InfoActivity.this).getCacheDir().getAbsolutePath() + File.separator + "profiles.txt";
FileInputStream inputStream = new FileInputStream(ab_path); // CRASH HERE
Entry newEntry = mDBApi.putFile("profiles.txt", inputStream, file2.length(), null, null); 
```

但我不断收到未找到文件的异常。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:19:15.063

您实际上可能需要为您的应用程序指定缓存路径，以确保文件位于您可以访问的位置，即：基于此设置文件名：

```
context.getCacheDir().getAbsolutePath() + File.separator + "profiles.txt" 
```

# mysql - 从两个单独的 mysql 数据库表中获取总数

> ID：11835326
> 
> 赞同：-2
> 
> 时间：2012-08-06T20:20:30.120
> 
> 标签：mysql, html-table, sum

目前我正在处理 Mysql 数据库上的两个单独的表，ITEM，CUSTOMER。详情如下

```
ITEM
Id
Name
Cost
Payment Balance
CustomerName

CUSTOMER
Id
CustomerName
Balance 
```

我需要完成两个任务：

1.  当我向项目数据库插入记录时，应更新客户数据库上的余额字段。

2.  当我看到客户购买的所有商品时，应计算该客户的余额总额。

请帮忙。

目前我正在使用以下代码：

```
$Id=$_GET['Id'];
........
$query = "SELECT Item.id, Item.Name, Item.Cost, Item.PaymentBalance,Item FROM Item INNER JOIN customer ON customer.CustomerName = visam.CustomerName where customer.Id='$Id'";
$result = mysql_query($query) or die(mysql_error());

<?php
while($rows=mysql_fetch_array($result)){
?>
<tr>
<td width="20px" ><? echo $rows['id']; ?></td>
<td width="310px" ><? echo $rows['Name']; ?> </td>
<td width="310px" ><? echo $rows['Cost']; ?> </td>
<td width="210px" ><? echo $rows['PaymentBalance']; ?> </td> 
```

结果现在正确显示，但我不知道如何在页面末尾获取付款余额总额。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:27:21.297

```
<?php $total_balance=0; ?>

..// your while loop

<?php $total_balance+=$rows['PaymentBalance']; ?>

..// end while loop

<?php var_dump($total_balance); ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:28:30.473

我建议将余额显示为表格的最后一行

```
while($rows=mysql_fetch_array($result)){
$balance += $rows['PaymentBalance'];
<tr>
<td width="20px" ><? echo $rows['id']; ?></td>
<td width="310px" ><? echo $rows['Name']; ?> </td>
<td width="310px" ><? echo $rows['Cost']; ?> </td>
</tr>
}
<tr>
<td width="210px" ><? echo $balance; </tr>?> 
```

**编辑**

**另外我认为如果**它代表你的“成本”的总和，你可以不把余额放在你的表中......这样

```
$balance += $rows['Cost']; 
```

# java - 数据库和 Linux 服务器上的编码不匹配

> ID：11835340
> 
> 赞同：0
> 
> 时间：2012-08-06T20:21:04.373
> 
> 标签：java, linux, encoding, utf-8, iso-8859-1

我有一个使用编码 ISO8859_1 的数据库。我有一个 Spring MVC 应用程序，它从服务器获取数据并将其显示在网页上。但是，我的 Linux 服务器具有默认编码 UTF-8。我正在使用 JDBC 连接从数据库中获取数据。问题是数据库中的数据在到达服务器时会被垃圾值破坏，因为存在编码不匹配。当我尝试将字符串的编码从结果集转换为 UTF-8 时，我最终得到一个包含“？”的字符串。它试图将垃圾字符串编码为 UTF-8，这就是我最终得到问号字符串的原因。我一直在尝试解决这个问题一段时间。如果有人遇到过这种情况，那么我很乐意在这里为您解答。（PS：我无法更改数据库或服务器的编码）

# javascript - 在jquery mobile中离开页面时结束SetInterval函数

> ID：11835343
> 
> 赞同：2
> 
> 时间：2012-08-06T20:21:11.033
> 
> 标签：javascript, jquery, jquery-mobile, webcam, setinterval

我正在整理一个 jquery 移动网站，其中包括几个用于网络摄像头的单独页面 (*.htm)。在那些页面上，我正在加载一个设置间隔函数，该函数每隔几秒刷新一次从相机抓取的图像并模拟视频。

但是，当我使用导航链接或后退按钮从网络摄像头页面 (webcam.htm) 导航到 index.htm 时，就会出现问题，webcam.htm 页面仍保留在 DOM 中，并且每隔几秒钟就会拉出图像。

用户离开时如何清除页面或至少 endinterval？

```
<script type="text/javascript">
    function camfresh() {
        setInterval(function(){ $("#rmcam").attr("src", "image.jpg?"+new Date().getTime());},2000);
    }
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:24:12.917

您可以使用`pageshow`和`pagehide`事件来启动和停止间隔：

```
var myInterval;
$(document).delegate('.ui-page', 'pageshow', function () {

    //note that `this` refers to the current `data-role="page"` element

    //cache `this` for later (inside the setInterval anonymous function)
    var $this = $(this);

    myInterval = setInterval(function(){
        $this.find("#rmcam").attr("src", "image.jpg?"+new Date().getTime());
    }, 2000);
}).delegate('.ui-page', 'pagehide', function () {
    clearInterval(myInterval);
}); 
```

您可以将`.ui-page`选择器更改为更具体（目前它们将选择每个伪页面）。

# javascript - 附加 POST 数据 javascript

> ID：11835346
> 
> 赞同：1
> 
> 时间：2012-08-06T20:21:18.357
> 
> 标签：javascript, jquery

使用 Javascript 和/或 Jquery 如何将 POST 数据附加到要提交的表单中。我的服务器端代码将检查发布数据字典是否包含某个键。

我已经在代码中有一个表格。所以我只想使用 javascript 为 POST 数据添加一个新键。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:29:49.127

使用 jQuery：

```
var $input = $('<input>').attr(
{
    type: 'hidden',
    id: 'input_id',
    name: 'input_name',
    value: 'input_value'
}).appendTo('#form_name');

$('#form_name').submit(); 
```

这是你想做的吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T20:31:38.860

快速示例

您可以添加隐藏输入，例如：

```
var yourValue = 123;
$('form').append('<input type="hidden" id="yourData" name="yourData" value="'+ yourValue +'"/>'); 
```

所以你得到：

```
<input type="hidden" id="yourData" name="yourData" value="123"/> 
```

当您提交时，您将发送“yourData”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T20:25:21.623

尝试拦截提交事件并：

*   序列化表单，添加你需要添加和使用的`$.post(url, data, function(){});`功能。
*   注入带有额外隐藏输入字段的表单，然后通过 jquery 提交

# javascript - 组件是 HTML5 的属性还是 protoype.js 的东西？

> ID：11835347
> 
> 赞同：5
> 
> 时间：2012-08-06T20:21:25.170
> 
> 标签：javascript, html, prototypejs

**组件**是HTML5 的属性还是prototype.js 的一部分？我没有任何运气在网上找到有关此的信息。我认为组件和属性的术语过于笼统，无法很好地搜索。

示例（来自[http://flixster.rottentomatoes.com/](http://flixster.rottentomatoes.com/)）：

```
<li id="" class="active" component="NavigationButton">
    ...
</li> 
```

然后看一下 nav 元素和其中包含的 li 元素。不知道如何在此处粘贴 HTML 作为示例。注意：随时编辑我的代码以举例

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:30:03.637

它是组件对象模型读取的自定义属性，它是一些自定义框架。

它读取属性如下：

```
tags.each(function(tag) {
    var name = $(tag).readAttribute("component");
    try {
        new Component[name](tag);
    } catch (err) {
        console.error("Error initializing Component." + name + " - " + err);
    }
}); 
```

基本上根据属性值创建一个新的组件实例。IE 如果一个元素有`component="Form"`，框架将`Component.Form`围绕该元素创建一个新实例。它非常[灵活](http://www.adobe.com/products/flex.html)。

# html - 多张图片下方的文字对齐

> ID：11835351
> 
> 赞同：0
> 
> 时间：2012-08-06T20:21:35.003
> 
> 标签：html, css, image

我有四个图像，它们水平放置在彼此旁边。我正在尝试将文本放在每个图像下方。这就是我现在所拥有的。

**HTML**

```
<div class="team">
<h3>Our Team</h3>
<img src="image.jpg" width="200px" height="200px" hspace="20" /> <h3>John Doe</h3>
<p>Text</p>
<p>Text</p>
<img src="image.jpg" width="200px" height="200px" hspace="20" /> <h3>John Doe</h3>
<p>Text</p>
<p>Text</p>
<img src="image.jpg" width="200px" height="200px" hspace="20" /> <h3>John Doe</h3>
<p>Text</p>
<p>Text</p>
<img src="image.jpg" width="200px" height="200px" hspace="20" /> <h3>John Doe</h3>
<p>Text</p>
<p>Text</p>
</div> 
```

**CSS**

> .team { 显示：块；浮动：底部；填充：10px；边距：15px；}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:29:58.420

您将不得不将其中的每一个包装在具有“display:inline-block;”样式的 div 标签中。- 像这样：

```
<div style="display:inline-block;">
    <img src="image.jpg" width="200px" height="200px" hspace="20" /> 
    <br><h3>John Doe</h3>  
    <br><p>Text</p>  
    <br><p>Text</p> 
</div>        
<div style="display:inline-block;">
    <img src="image.jpg" width="200px" height="200px" hspace="20" /> 
    <br><h3>John Doe</h3>  
    <br><p>Text</p>  
    <br><p>Text</p> 
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:33:31.043

浮动：底部？？

如果你想居中，你需要 4 个独立的 div 彼此相邻浮动，包含在父 div 中。简单的。

```
<div class="left">img,p</div> 
```

CSS

```
.left {
    Float: left;
    //add padding and margins
} 
```

这就是你需要的。不能全部写出来，在 iPad 上很累。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T20:34:13.273

据我了解，你想要它：http: [//jsbin.com/welcome/8969](http://jsbin.com/welcome/8969)

# hadoop - 如何编写简单的 map-reduce 作业以将制表符分隔的文本文件转换为序列文件？

> ID：11835355
> 
> 赞同：1
> 
> 时间：2012-08-06T20:21:52.303
> 
> 标签：hadoop, mapreduce, mahout

我想将一个文本文件作为映射器的输入并输出一个序列文件。如何为此编写一个简单的 map-reduce 作业？文本文件将具有制表符分隔值。例如输入：group1 1 2 3 4 5
对于这样的输入，我想创建输出序列文件，其键为“group1”，其值应为 1 2 3 4 5 的向量。

我该如何写这些作业？另外我觉得在这种情况下我不需要减速器。在这种情况下如何编写身份缩减器作业？我可以跳过编写减速器工作吗？

感谢任何帮助。问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T18:57:51.433

是的，您可以跳过编写`Reducer`. 将此设置为简单`Reducer.class`。也叫`setNumReduceTasks(0)`. 您`Mapper`应该使用`TextInputFormat`,作为键`Long`/`Text`值输入。是`Text`线。根据需要将其分解，并将键/值输出为，例如，`Text`和`Text`。指定`SequenceFileOutputFormat`写入序列文件。

我仍然不知道你为什么要这样做，但这就是你这样做的方式。

# objective-c - 浮点值不起作用

> ID：11835356
> 
> 赞同：-3
> 
> 时间：2012-08-06T20:21:54.457
> 
> 标签：objective-c, ios

好的，我一直在尝试使浮点值起作用。我有两个字段名称`RingNumber`和`NumberOfSides`

我正在尝试将它们加在一起。

这是我的代码。这里可能出了什么问题？根据教程，这一切都是正确的。

```
float x = ([RingNumber.text floatValue]);
float y = x+([NumberOfSides.text floatValue]);

Answer.text = [[NSString alloc] initWithFormat:@"%2.f", y]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:04:59.947

这行得通吗？

```
Answer.text = [NSString stringWithFormat:@"%f", y]; 
```

# javascript - 如何将 DOM 元素绑定到自定义 $.touchpress 事件？

> ID：11835357
> 
> 赞同：0
> 
> 时间：2012-08-06T20:21:54.967
> 
> 标签：javascript, jquery

我想创建一个自定义事件，称为`touchpress`可以使用通常的 JQuery 绑定对象的自定义事件`.bind()`。

这是我目前如何为按钮设计触摸屏：

```
$("#myButton").bind("touchstart", function() {
    var startTime = new Date().getTime();
}).touchend(function() {
    var duration = new Date().getTime() - startTime;
}); 
```

但我希望能够将任何元素绑定到此事件并简单地触发 touchpress 事件

```
$("#myButton").bind("touchpress", onTouchPress); 
```

我尝试使用触发器：

```
$(document).trigger("touchpress", duration); 
```

但不知道将其绑定到什么。我也不知道将 touchstart 事件绑定到什么......有人想帮我把这些东西粘在一起吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:59:49.407

一个`touchpress`包装：

```
$.fn.touchpress = function(fn){
  var startTime;
  return this.on({
    "touchpress": fn,
    "touchstart": function(){
      startTime = new Date().getTime();
    },
    "touchend": function(){
      var duration = new Date().getTime() - startTime;
      $(this).trigger("touchpress", duration);
    }
  });
}; 
```

用法：

```
$("span").touchpress(function(evt, duration){
  console.log(duration);
}); 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:31:07.837

HTML：

```
<div id="main_content"></<div> 
```

JS代码：

```
document.getElementById('main_content').ontouchstart=onStartFunction;
/* or for multiple elements using jquery*/
$('.myBtns').each(function(){
   this.ontouchstart=onStartFunction;
});

function onStartFunction(e){

      //e.stopPropagation(); // if necessary

      // your code goes here

} 
```

你可以绑定你喜欢的每个事件 ontouchstart、ontouchmove、ontouchend 等。如果你使用 e.stopPropagation() 这将防止事件冒泡

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T20:24:50.470

javascript 区分大小写。

你绑定一个`touchPress`事件，然后触发一个`touchpress`. 这些不是同一个事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T20:25:29.633

事件冒泡上升到 dom 树。

因此，如果将处理程序附加到“myButton”，则需要直接在元素或该元素的子元素上触发事件。

**绑定**：附加一个函数，该函数将在事件到达具有该函数绑定到该事件的元素时触发

**触发**：从源元素向上触发事件，直到到达顶部元素或处理程序调用 event.stopPropagation();

例子：

dom结构：

```
document->body->div->button[id=myButton] 
```

您可以在 dom 中的任何元素上绑定任何事件

如果从按钮 [id=myButton] 触发，则事件冒泡

```
button[id=myButton]->div->body->document 
```

在你的情况下：

```
$("#myButton").trigger("touchpress"); //this triggers the handler that will respond to touchpress 
```

如果您不/想知道触发事件所需的元素来源，您可以为这些元素添加一个标记类并手动触发每个元素的事件

```
$('.has-touchpress-handler').trigger('touchpress'); 
```

# ruby-on-rails - 在 has_many 中更新模型：通过关联

> ID：11835358
> 
> 赞同：0
> 
> 时间：2012-08-06T20:21:57.227
> 
> 标签：ruby-on-rails, model, has-many-through

我有两个模型，Designer 和 Influence。他们彼此之间存在“has_many”关系：通过称为 Relation 的连接模型。

我想使用一个表单来使用来自影响模型的信息来创建/更新设计器模型。是否可以通过设计器控制器中的创建/更新操作来创建关系对象？还是我需要创建一个关系控制器？

我当前的代码如下，并导致 DesignersController#Update 中出现 NoMethodError。

**设计师.rb**

```
attr_accessible :name, :relation, :influence
has_many :relations
has_many :influences, :through => relations 
```

**影响力.rb**

```
attr_accessible :name, :relation, :designer
has_many :relations
has_many :designers, :through => :relations 
```

**关系.rb**

```
attr_accessible :designer_id, :influence_id
belongs_to :designer
belongs_to :influence 
```

**设计师/_form.html.erb**

```
<%= form_for @designer do |f| %>

  <%= f.label :name %><br />
  <%= f.text_field :name %>

  <%= f.label :influence %><br />
  <%= f.collection_select :influence, Influence.order(:name), :id, :name, include_blank: true %>

  <%= f.submit %>

<% end %> 
```

**设计师_控制器.rb**

```
def update
  @designer = current_designer
  ** Is there a way to create a new relation object here? ** 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:07:57.317

有两种通用方法可以做到这一点。您可以直接创建一个 Relations 对象，也可以使用 Designer 关联创建一个 Influence 对象，并且会自动创建一个：

`Relation.create relation_attributes`

或者

`@designer.influences.create influence_attributes`（这会创建一个新的 Relation 对象）

# c# - 使用 MSBuild，我可以签署在文件中指定密码的应用程序吗？

> ID：11835370
> 
> 赞同：2
> 
> 时间：2012-08-06T20:22:35.977
> 
> 标签：c#, .net, msbuild

当我签署应用程序时，我通常会运行如下命令行指令：

```
msbuild /p:project=whatever;platform=all;configuration=sign;KeyFile=key.pfx;Password=pass;RunCodeAnalysis=false;StyleCopEnabled=false 
```

除了在命令行上指定密码之外，是否有一个 MSBuild 属性可以让我指定一个包含密码的文件？如果没有，是否有任何推荐的签名程序，其中密码是间接指定的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:33:56.193

如果可以使用 BAT/CMD 文件而不是直接调用 MSBuild：

您可以将文件的内容插入到调用 MSBuild 的行中`set /p`

```
set /p MyPassword = <  path\to\file\Password.txt
msbuild ...;Password=%MyPassword%; 
```

# c# - 通过 c# .net 窗口应用程序打印账单

> ID：11835371
> 
> 赞同：4
> 
> 时间：2012-08-06T20:22:48.603
> 
> 标签：c#, .net, crystal-reports

我编写了一个计费软件。现在我想以特定格式打印这张账单。我为此阅读了 printDocument 和 printDialog 工具。但是我必须为我们在 printdocument 中绘制的每个字符串或线条提供 x 和 y 轴位置。

是否有任何 GUI 类型工具，所以我可以在其位置格式化所有账单字段，并从后端传递数据，这样每次它都会打印具有不同价值的相同账单我传递。

任何人都可以建议我从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:19:27.817

如果我必须在没有任何其他工具的情况下从头开始执行此操作，我会利用 HTML（可能是您可以访问其他工具、水晶报告或 SSRS，这会更容易）。HTML 专为布局设计而设计，.NET 为 HTML 提供了很多支持。（虽然我最近没有研究过它，但我确信有一些工具可以在应用程序中显示 HTML 并将其发送到打印机。）

HTML 作为 XML 适合于模板化，或者您可以利用许多现有的工具（请参阅 Mustache 等）。.NET 内置了模板，但一些可用的工具更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:39:12.690

您可以使用本地报告（rdlc）。检查这篇关于代码项目的文章：

[没有 SQL Server Reporting Services 的 Microsoft 报告](http://www.codeproject.com/Articles/25222/Microsoft-Reporting-without-SQL-Server-Reporting-S)

[Microsoft 报告服务 - 第二部分](http://www.codeproject.com/Articles/38554/Microsoft-Reporting-Services-Part-II)

# javascript - 将相同的表单动态显示/添加到具有不同字段的页面

> ID：11835377
> 
> 赞同：0
> 
> 时间：2012-08-06T20:23:08.303
> 
> 标签：javascript, jsp

如果在按钮旁边添加一个按钮，我的`index.jsp`外观将如何，按下该按钮时将显示另一个与前一个相同的搜索表单（如下所示），但具有不同的参数或字段，例如等。示例：`Add more``Process``age``year``<!-- how will I change the cloned form instead of displaying Car reg: <input type="text" name="car" /> to show age: <input type="text" name="age" /> -->` `<!-- how will I change the cloned form instead of displaying <input type="button"
onClick="addMoreForm('age')" value="Add More" /> to show <input type="button" onClick="delete('age')" value="delete" /> --> </div>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T13:24:39.307

这可能会让你开始......

您可以创建一个按钮或锚`<a>`链接（任何您喜欢的）来调用该函数：

```
<input type="button" onClick="addMoreForm('the parameters come here*')" value="Add More" /> 
```

*   该方法可能类似于：formName、fieldName、fieldType、formAction、formMethod 等`parameters`通过**javascript 创建表单**，这里有一些在 javascript 中创建元素的链接（是一个元素 :-)）：`addMoreForm`**`<form>`**
***   [http://www.dustindiaz.com/add-and-remove-html-elements-dynamically-with-javascript/](http://www.dustindiaz.com/add-and-remove-html-elements-dynamically-with-javascript/)*   与 jQuery：[jQuery document.createElement 等效？](https://stackoverflow.com/questions/268490/jquery-document-createelement-equivalent/268520#268520)*   [https://stackoverflow.com/a/327068/468763](https://stackoverflow.com/a/327068/468763)*   [https://stackoverflow.com/a/867981/468763](https://stackoverflow.com/a/867981/468763)**

 ****或者**

*   您可以传递要复制的表单的`formName`and ，同样是一些链接：`formId`
*   [https://stackoverflow.com/a/921302/468763](https://stackoverflow.com/a/921302/468763)
*   [https://stackoverflow.com/a/710347/468763](https://stackoverflow.com/a/710347/468763)
*   一个使用纯 javacript 进行**克隆**的示例，我正在克隆您`form1`以创建一个容器，例如您将在其中创建`form2`的标签：`addingMoreId``<div>``form2`

    ```
    var form2 = document.getElementById("form1").cloneNode(true);
    form2.setAttribute("name", "form2");
    form2.setAttribute("id", "form2");
    document.getElementById("addingMoreId").appendChild(form2); 
    ```

**PS：**为了与浏览器兼容，您可以使用[jQuery](http://jquery.com/)或[YUI](http://yuilibrary.com/)之类的 javascript 库。

**编辑：**这是一个示例代码，您可以在此代码中进行很多改进，也可以使其更通用。

```
<input type="button" onClick="addMoreForm('age')" value="Add More" />

<div id="addingMoreId">
    <!-- This is empty, the form2 will be created here -->
    <!-- So it is not required that the form be present here -->
</div>

<!-- This script tag goes into the <head> tag -->
<script>
    // this function will create the form2 in the div
    // you agree or not, you need to learn a lot more about Javascript :-)
    function addMoreForm(fieldName) {
        var form2 = document.getElementById("form1").cloneNode(true);
        form2.setAttribute("name", "form2");
        form2.setAttribute("id", "form2");
        document.getElementById("addingMoreId").appendChild(form2);
        form2.car.setAttribute("name", fieldName); // one way to access the element inside a form: "form2.car", where "car" is the name of the element created inside the form2
        form2.elements[fieldName].setAttribute("id", fieldName); // another way to access the element inside a form: "form2.elements["car"]"
    }
</script> 
```

让我们希望这会有所帮助:-)**

# android - HTML5 - Android 平板电脑 - 输入类型编号

> ID：11835378
> 
> 赞同：3
> 
> 时间：2012-08-06T20:23:09.410
> 
> 标签：android, html, types, input, numbers

晚安，伙计们，

我正在使用带数字的输入类型，但该字段是带有逗号和点的货币值。更多 Android 打开键盘时只有数字，没有逗号或点。

Galaxy Tab 10.1 上的示例错误

[http://pastie.org/5063487](http://pastie.org/5063487)

或者

[http://jsfiddle.net/F8EPw/](http://jsfiddle.net/F8EPw/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T00:59:39.447

尝试使用`<input type="number" step="any" />` 更多的解释可以在[这里找到](http://blog.isotoma.com/2012/03/html5-input-typenumber-and-decimalsfloats-in-chrome/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T11:28:01.053

我已经测试过这个解决方案，即使使用没有结果的模式。当我试图告诉点或逗号时，根本就没有动作。

例子：

```
<input type="text" name="test" pattern="\d*" />

<input type="number" step="0.01" pattern="\d+(\.\d*)?">

<input type="number" min="0" max="999" step="0.000001" pattern="\d+(\.\d*)?" /> 
```

啊，我使用的是 Android 3.2 em Samsung Tab 10.1

# dialog - xpages extlib 对话框。当用户按下退出键或单击 X 时需要捕获

> ID：11835379
> 
> 赞同：1
> 
> 时间：2012-08-06T20:23:12.677
> 
> 标签：dialog, xpages

如果用户按下“确定”或“取消”按钮，我有一个很好用的对话框。但是，如果他们按下 Escape 键或单击 X 关闭对话框，我需要运行一些代码。我曾尝试将代码放入 onHide 和 onClose 和 onUnload 事件中，但无济于事。

有人对此有任何想法吗？

// 部分代码清单 . . .

```
<xe:dialog id="dialogUserCreds"
     title="#{javascript:viewScope.dialogUserCredsTitle;}">
    <xe:this.onHide><![CDATA[
       var url = "/xpVendorApplication.xsp";
       context.redirectToPage(url);]]>
        </xe:this.onHide>
    <xe:this.onClose><![CDATA[
           var url = "/xpVendorApplication.xsp";
           context.redirectToPage(url);]]>
         </xe:this.onClose>
</xe:dialog> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T05:16:37.353

正如您在评论中提到的，您已经找到了 onHide() 的 CSJS 事件。这仅接受客户端 javascript，但您的部分代码清单显示您正在尝试使用服务器端 javascript。

在这种情况下，您将需要使用 window.location(url) 调用来执行 CSJS 重定向。

# scala - 方法参数是隐含的吗？- 使用 scala 2.10 反射

> ID：11835380
> 
> 赞同：2
> 
> 时间：2012-08-06T20:23:28.503
> 
> 标签：scala, reflection, scala-2.10

给定一个反射方法：

```
scala> val sortMethod = typeOf[::[_]].member(newTermName("sorted"))
sortMethod: reflect.runtime.universe.Symbol = method sorted

scala> sortMethod.typeSignature
res122: reflect.runtime.universe.Type = [B >: A](implicit ord: scala.math.Ordering[B])Repr 
```

找出方法是否具有隐式参数（在 scala 2.10-M4+ 中）的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T23:16:53.757

```
scala> import scala.reflect.runtime.universe._
import scala.reflect.runtime.universe._

scala> val sortMethod = typeOf[::[_]].member(newTermName("sorted")).asMethod
sortMethod: reflect.runtime.universe.MethodSymbol = method sorted

scala> sortMethod.params // `params` has been added only a few days ago
res0: List[List[reflect.runtime.universe.Symbol]] = List(List(value ord))

scala> sortMethod.params(0)(0).asTerm.isImplicit
res2: Boolean = true

scala> sortMethod.params(0)(0) hasFlag Flag.IMPLICIT
res3: Boolean = true 
```

如果您问我喜欢哪种方式，我建议您使用`isXXX`方法。首先，这是一种一致的测试方式，因为只有十几个公共标志，但要测试的东西要多得多（例如`isStable`or `isSynthetic`）。其次，标志比它们看起来更复杂（例如，几个标志名称可能对应于标志掩码中的同一位），因此`isXXX`方法提供了更好的封装。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T21:57:39.943

现在，我不认为你可以。`isImplicit`是[在 6 天前添加](https://github.com/scala/scala/commit/027b00171c0d92ec669deaa471966e6468c6b8cf)的，因此您应该能够在夜间构建或在下一个里程碑版本中使用。

# java - 解析 html 并获取应用的元素样式

> ID：11835383
> 
> 赞同：2
> 
> 时间：2012-08-06T20:23:37.463
> 
> 标签：java, html, css

我想使用 Java 库来解析 HTML。

我还希望能够为文本元素获取应用的 css 样式。目前我只想知道字体样式和大小。

样式可以直接应用，也可以从 css 文件应用。我意识到它也可以使用 JavaScript 应用，但我现在不需要这种支持。

目前我正在查看[Jsoup](http://jsoup.org/)，但我没有看到这样的支持。还有其他我可以使用的库吗？如果我不必使用完整的浏览器引擎来获得此功能，那就更好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:31:51.850

CSSParser[至少](http://cssparser.sourceforge.net/)允许解析 CSS 文档并迭代不同的样式规则。在[寻找在 java 中寻找 CSS 解析器](https://stackoverflow.com/questions/1513587/looking-for-a-css-parser-in-java)的问题的[答案](https://stackoverflow.com/a/1857265/658718)中，您将找到一个示例用法。

CSSParser 是 W3C 的[SAC 的 Java 实现：CSS 的简单 API](http://www.w3.org/Style/CSS/SAC/)

> SAC 1.0 是 CSS 解析器的标准接口，应该与 CSS1、CSS2、CSS3（目前正在开发中）和其他 CSS 派生语言一起使用。

但这会迫使你在 JSoup 和 CSSParser 之间滚动你自己的实现。在 Java中实现`getComputedStyle`方法的唯一项目是[Lobo Java Browser](http://lobobrowser.org/java-browser.jsp)。不幸的是，自 2009 年起停产，但我认为这不会产生问题。

至少他们提供了这种方法：

[`public org.lobobrowser.html.style.AbstractCSS2Properties getComputedStyle(java.lang.String pseudoElement`)](http://lobobrowser.org/cobra-api/org/lobobrowser/html/domimpl/HTMLElementImpl.html#getComputedStyle%28java.lang.String%29)

# c# - DataGridView 中的滚动器更改 LargeChange 和最大值

> ID：11835386
> 
> 赞同：1
> 
> 时间：2012-08-06T20:23:49.923
> 
> 标签：c#, winforms, user-interface, datagridview

我正在尝试实现我的 DataGridView 的类似 Excel 的行为。为此，我制作了自己的课程：

```
class CustomDataGridView : DataGridView 
```

在构造函数中，我将 Horizo​​ntalScrollBar 的属性 SmallChange、LargeChange 和 Maximum 的值设置为我需要的值。但是在应用程序启动后，我在调试器中看到这些值在某处发生了某种变化。有没有人遇到过这样的事情？有没有可能处理这种情况？

# java - 让 JSON 字符串跨越多个 Socket receive()

> ID：11835391
> 
> 赞同：1
> 
> 时间：2012-08-06T20:24:08.753
> 
> 标签：java, android, json, sockets

现在我可以通过网络将 JSON 字符串发送到我的 Android 应用程序。唯一的问题是，这些消息目前不超过几百个字符。这将很快扩展到每个 JSON 字符串数千个字符。如何确保在将其发送到解析器之前已收到整个 JSON 字符串（否则会崩溃）？

例如，我如何在线程中接收数据的基本方式：

```
while (true) 
{
    try 
    {
        // Read from the DataInputStream
        bytes = mmDataIn.read(buffer); //buffer is a 4096 size byte[]
        Log.d("JSON", "dataread: " + String.valueOf(bytes)); //only prints stuff > 0
        parseJSON(buffer); //will not work unless full JSON
    } 
    catch (IOException e) 
    {
        Log.e("JSON", "disconnected", e);
        break;
    }
} 
```

我打算使用 StringBuilder 来拼凑 JSON 字符串，但我不知道如何判断它何时完成。

我在读这个：[如何在 java 中识别 InputStream 的结尾](https://stackoverflow.com/questions/5562370/how-to-identify-end-of-inputstream-in-java)

但是对于 JSON 字符串，最好的方法是什么？我假设这很常见，并且有一种标准的处理方式。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:48:45.410

如果接收到的数据多于缓冲区可以容纳的数据，则必须选择更大的缓冲区，或者重复将输入流读入缓冲区，并连接生成的 json，然后再将其传递给 parseJSON 方法。

对于任何 InputStream，如果 read 返回 -1，则表示已到达输入流的末尾，因此这也适用于您的 DataInputStream。

干杯，汤姆

# ruby-on-rails-3 - `updated_at` 时间不反映我的时区

> ID：11835395
> 
> 赞同：0
> 
> 时间：2012-08-06T20:24:14.407
> 
> 标签：ruby-on-rails-3, heroku, timezone

我试图`updated_at`在我的应用程序中获取时间戳以反映我的时区。它们在本地正确显示，但是当它们在`production`Heroku 上时，它们会反映标准 UTC。我已将此添加到我的 Heroku 配置中：

`$ heroku config:add TZ=America/Minneapolis`

在我的`application.rb`我还添加了：

```
config.time_zone = 'Central Time (US & Canada)'
config.active_record.default_timezone = 'Central Time (US & Canada)' 
```

Heroku 上的时间戳仍然显示 UTC 时间，我是 UTC/GMT -5:00。任何人都知道我错过了什么或做错了什么？

* * *

## 更新

* * *

当我在我的项目中显示时，我会在每个文本的底部`entries`包含时间戳。时间戳显示 UTC 时间，我希望它们显示我在中央时区更新它的时间，这样时间不会比我做的时间早 5 小时。`updated_at``entry`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:40:48.003

更新以回答更新后的问题。

如果您的应用程序的时区始终为“中央”，您可以为 ApplicationController 设置时区

```
Time.zone = 'Central Time (US & Canada)' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:41:22.620

我正在显示时间戳`entry.updated_at.localtime.strftime('* %a, %b %-e, %Y @ %l:%M%p')`。我认为那里的`localtime`方法与它有关。我删除`localtime`并添加`%Z`到`strftime`参数的末尾以添加缩写时区。现在它显示了我想要的方式。我不确定是如何`localtime`影响它的，但删除它似乎已经解决了这个问题。

# python - 为什么从 git repo 进行 pip 安装时 #egg=foo

> ID：11835396
> 
> 赞同：116
> 
> 时间：2012-08-06T20:24:15.323
> 
> 标签：python, package, pip

当我执行“pip install -e ...”从 git repo 安装时，我必须指定 #egg=somename 或 pip 抱怨。例如：

```
pip install -e git://github.com/hiidef/oauth2app.git#egg=oauth2app 
```

这个“鸡蛋”字符串有什么意义？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-08-06T20:33:33.050

per pip install -h “egg” 字符串是作为安装的一部分检出的目录

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2019-04-04T23:56:19.140

一个 Egg 只是[一些捆绑的 python 代码](https://stackoverflow.com/questions/2051192/what-is-a-python-egg)。在 git url 中，egg 是项目名称。 [VCS 支持](https://pip.pypa.io/en/stable/topics/vcs-support/)

通常我们从 Pypi 安装 python 包，所以你只指定包名称和版本（或者如果你不指定，它假定最新版本）。Pypi 然后搜索你想要的鸡蛋并 pip 安装它。 `pip install celery`将安装最新发布的 egg 并`pip install celery[redis]`安装包含相同 celery 包的不同 egg 并从 celery 的 setup.py 中列为 redis 依赖项的任何包中安装最新的 egg。

使用 git 和 gitlab 路径，您可以指定`/{user|group}/{repository}.git@{tag}#egg={package-name}`. `#egg=celery`和之间有区别`#egg=celery[redis]`，但它们都来自相同的源代码。

除了实际标签之外，“标签”还可以是分支或提交哈希。`master`如果您不指定，则假定为。

例如，`git+https://github.com/celery/celery.git#egg=celery==4.3.0`将检查主分支并安装它。即使您指定了版本号，安装时也不会考虑它。*版本号被忽略*

通过 git 或其他 VCS url 安装时，您将需要找到所需版本的标签或哈希。例如，`git+https://github.com/celery/celery.git@v4.3.0#egg=celery`它将签出标记为“v4.3.0”的提交，然后从该源代码安装包。假设维护者没有严重错误地标记他们的存储库，您可以获得您想要的版本。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-04-11T06:52:14.810

[https://pip.pypa.io/en/stable/reference/pip_install/#vcs-support](https://pip.pypa.io/en/stable/reference/pip_install/#vcs-support)说：

> pip 在其依赖逻辑中使用 url 后缀“egg=-”的“项目名称”组件在 pip 下载和分析元数据之前识别项目。鸡蛋名称的可选“版本”组件在功能上并不重要。它仅提供关于正在使用的版本的人类可读线索。对于 setup.py 不在项目根目录中的项目，使用“子目录”组件。“子目录”组件的值应该是从项目根目录开始到 setup.py 所在位置的路径。

由此我推断出 egg 值仅用于依赖检查，因此我认为按照惯例，`some-pypi-package-name`应该使用包名（ie），而不是任何包含的文件夹（ie `some_pypi_package_name`）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-08-06T20:31:19.193

您必须包含 #egg=Package 以便 pip 知道该 URL 会发生什么。请参阅[https://pip.pypa.io/en/stable/reference/pip_install/#vcs-support](https://pip.pypa.io/en/stable/reference/pip_install/#vcs-support)

[更多关于鸡蛋](http://mrtopf.de/blog/en/a-small-introduction-to-python-eggs/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-25T06:19:12.597

引用[手册](https://pip.pypa.io/en/stable/topics/vcs-support/#url-fragments)：

> pip 查看 VCS URL 的 2 个片段：
> 
> egg：用于指定在 pip 的依赖解析逻辑中使用的“项目名称”。例如：egg=project_name
> 
> 子目录：用于指定 Python 包的路径，当它不在 VCS 目录的根目录中时。例如：pkg_dir

# perl - 如何使用 Perl 将日期时间转换为 Unix 时间戳

> ID：11835397
> 
> 赞同：-1
> 
> 时间：2012-08-06T20:24:21.930
> 
> 标签：perl

我有一个显示为的日期时间`06 August 2012 21:02:00`，需要使用 Perl 将其转换为 Unix 时间戳。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T20:48:00.280

如果您想保留核心模块，请使用`Time::Piece`（在 Perl 5.10 上可用）：

```
use Time::Piece;
my $t = Time::Piece->strptime(shift,"%d %B %Y %H:%M:%S");
print $t->epoch, "\n";

./mypl "06 August 2012 21:02:00"
1344286920 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-06T20:28:20.153

```
use Date::Parse; 
print str2time('06 August 2012 21:02:00'); 
```

# javascript - Javascript 密码不应包含超过两个连续字符的用户帐户名或用户全名部分

> ID：11835413
> 
> 赞同：0
> 
> 时间：2012-08-06T20:25:12.560
> 
> 标签：javascript, jquery, regex, passwords

我需要实现客户端密码验证，以便密码不应包含用户的帐户名或超过两个连续字符的用户全名部分。

我在客户端公开用户名和全名。但到目前为止，我无法弄清楚在客户端实现的正则表达式或任何其他方法。

例子

```
username: test20@xyz.com
password: Usertest123 --> this should fail the validation since it contains "test" in both password and username. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:38:10.480

我只能这么想：

```
var name = "test20@xyz", password = "usertest123"

var partsOfThreeLetters = name.match(/.{3}/g).concat(
                           name.substr(1).match(/.{3}/g),
                           name.substr(2).match(/.{3}/g) );
new RegExp(partsOfThreeLetters.join("|"), "i").test(password); // true 
```

但我认为正则表达式在这里不是合适的工具，因为它需要转义等。您最好使用简单的`substr`/`indexOf`算法（请参阅[JavaScript 不区分大小写的字符串比较](https://stackoverflow.com/questions/2140627/)，[如何检查字符串是否包含 JavaScript 中的子字符串？](https://stackoverflow.com/q/1789945/)） .

# xml - 将 xml 元素内容拆分为固定行数

> ID：11835414
> 
> 赞同：1
> 
> 时间：2012-08-06T20:25:13.257
> 
> 标签：xml, templates, xslt, split, xslt-2.0

我真的很感激这个任务的解决方案，它让我发疯。

我有一个 xml 元素，里面有自由文本，它可以有 2 个字符或整个段落

> `<Description>text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text </Description>`

我需要一个 XSL 模板来生成这个输出：

11 行，每行 80 个字符。

例如对于上述元素，结果将是这样的：

![在此处输入图像描述](../Images/bacbecda81f3dafd9866f44cfa0e8a96.png)

我一直在尝试使用标记化功能，但根本没有成功。提前致谢。

杰拉尔多

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T03:27:24.977

**I. 这是一个 XSLT 1.0 解决方案**（XSLT 2.0 解决方案要容易得多）：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:variable name="vLine" select=
"concat('**********',
        '**********',
        '**********',
        '**********',
        '**********',
        '**********',
        '**********',
        '**********'
        )
"/>

 <xsl:template match="/*">
     <xsl:copy>
       <xsl:variable name="vsplitResult">
           <xsl:call-template name="split">
             <xsl:with-param name="pText" select="translate(., '&#xA;', '')"/>
           </xsl:call-template>
       </xsl:variable>

       <xsl:variable name="vnumLines" select=
       "ceiling(string-length($vsplitResult) div 81)"/>

       <xsl:choose>
        <xsl:when test="$vnumLines > 11">
          <xsl:value-of select="substring($vsplitResult, 1, 81*11 -1)"/>
        </xsl:when>
        <xsl:otherwise>
          <xsl:variable name="vremLines" select="11 - $vnumLines"/>

          <xsl:value-of select="substring($vsplitResult, 1, 81*($vnumLines -1))"/>

          <xsl:call-template name="padRight">
           <xsl:with-param name="pText" select="substring($vsplitResult,81*($vnumLines -1)+1)"/>
          </xsl:call-template>

          <xsl:for-each select="(document('')//node())[not(position() > $vremLines)]">
            <xsl:value-of select="concat('&#xA;', $vLine)"/>
          </xsl:for-each>
        </xsl:otherwise>
       </xsl:choose>
     </xsl:copy>
 </xsl:template>

 <xsl:template name="split">
  <xsl:param name="pText" select="."/>
  <xsl:param name="pLineLength" select="80"/>

  <xsl:if test="$pText">
   <xsl:value-of select="substring($pText, 1, $pLineLength)"/>
   <xsl:if test="string-length($pText) > $pLineLength">
    <xsl:text>&#xA;</xsl:text>
   </xsl:if>

   <xsl:call-template name="split">
     <xsl:with-param name="pText" select="substring($pText, $pLineLength+1)"/>
     <xsl:with-param name="pLineLength" select="$pLineLength"/>
   </xsl:call-template>
  </xsl:if>
 </xsl:template>

 <xsl:template name="padRight">
  <xsl:param name="pText"/>
  <xsl:param name="pTotatLength" select="80"/>

  <xsl:value-of select=
  "concat($pText,
          substring($vLine, 1, $pTotatLength - string-length($pText))
          )"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<Description>
text text text text text text text text text text text text text
text text text text text text text text text text text text text text text
text text text text </Description> 
```

**产生了想要的正确结果（我正在使用该`*`字符以查看究竟生成了什么）**：

```
<Description>text text text text text text text text text text text text texttext text text t
ext text text text text text text text text text text texttext text text text **
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************</Description> 
```

* * *

**二、XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0"   xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:param name="pLineLength" select="80" as="xs:integer"/>
 <xsl:param name="pTotalLines" select="11"  as="xs:integer"/>
 <xsl:param name="pPadChar" select="'*'" as="xs:string"/>

 <xsl:variable name="vLine" as="xs:string" select=
      "string-join(
                   (for $i in 1 to $pLineLength
                     return $pPadChar
                    ),
                   ''
                   )
     "/>
  <xsl:template match="/*">
   <xsl:variable name="vText" select="translate(., '&#xA;', '')"/>

   <xsl:copy>
     <xsl:value-of separator="&#xA;" select=
       "(for $numlines in string-length($vText) idiv $pLineLength +1,
             $line in 1 to $numlines
          return
             if($line ne $numlines)
               then substring($vText, 
                              1 + ($line -1)*$pLineLength, 
                              $pLineLength)
               else
                for $lastLine in substring($vText, 
                                           1 + ($line -1)*$pLineLength, 
                                           $pLineLength)
                 return
                   concat($lastLine, 
                          substring($vLine, 
                                    1, 
                                    $pLineLength - string-length($lastLine))
         ),

        (for $numlines in string-length($vText) idiv $pLineLength +1,
             $rem in 1 to $pTotalLines - $numlines
          return
             $vLine)
          )
       "/>
   </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于同一个 XML 文档（如上）时，会产生相同的正确结果**：

```
<Description>text text text text text text text text text text text text texttext text text t
ext text text text text text text text text text text texttext text text text **
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************
********************************************************************************</Description> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T15:44:52.287

这是最终的解决方案：

```
 ...
    <xsl:variable name="lineCount" select="11"/>
    <xsl:variable name="charPerLine" select="20"/>
    ...

<ElementX>
                        <xsl:call-template name="Texts">
                                    <xsl:with-param name="string" select="bi:fillText(../bi:SalesOrder/bi:Notes/bi:Description,$charPerLine*$lineCount)"/>
                                    <xsl:with-param name="Position">1</xsl:with-param>
                                    <xsl:with-param name="charLength" select="$charPerLine"/>
                                    <xsl:with-param name="lineCount" select="$lineCount"/>
                            </xsl:call-template>
                        </ElementX>

<!--Template to fill string. ..example 11 lines, 80 characters each.--> 
<xsl:template name="Texts">
    <xsl:param name="string"/>
    <xsl:param name="Position"/>
    <xsl:param  name="charLength" />
    <xsl:param name="lineCount"/>

    <xsl:variable name="line" select="substring($string,1,$charLength)"/>
    <xsl:variable name="rest" select="substring($string, $charLength+1)"/>
    <xsl:if test="$line">
        <xsl:value-of select="$line"/>
        <xsl:if test="$Position != $lineCount"> 
                <xsl:text>&#x0A;</xsl:text> 
        </xsl:if>
    </xsl:if>
    <xsl:if test="$rest and $Position &lt; $lineCount">
        <xsl:call-template name="Texts">
            <xsl:with-param name="string" select="$rest"/>
            <xsl:with-param name="Position" select="$Position+1"/>
            <xsl:with-param name="charLength"  select="$charLength"/>
            <xsl:with-param name="lineCount" select="$lineCount"/>
        </xsl:call-template>
    </xsl:if>
</xsl:template>

<xsl:function name="bi:fillText">
    <xsl:param name="value"/>
    <xsl:param name="lengthMax"/>
    <xsl:variable name="j" select="$lengthMax - string-length($value)"/>

    <xsl:value-of select="concat($value,string-join(
               (for $i in 1 to $j
                 return ' '
                ),
               ''
               ) )"/>
</xsl:function> 
```

# fortran - 这个 Fortran 代码有什么作用？

> ID：11835420
> 
> 赞同：1
> 
> 时间：2012-08-06T20:25:48.733
> 
> 标签：fortran

我得到了一些 Fortran 代码（我相信是 90），我正试图弄清楚它的作用。我不知道 Fortran，但知道 Perl。

这是我无法弄清楚的片段：

```
 fmly='I:\CEX\Fmly'
  fmlyfile=fmly(1:23)//yearqtr(qtrcnt)
  open(unit=13,file=fmlyfile) 
```

我知道这`//`是一个连接运算符，但我对这`fmly(1:23)`部分的作用感到困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:30:09.603

`fmly(1:23)`正在将字符串`fmly`从一个位置切到另一个`1`位置`23`。请注意，在 Fortran 中，字符串索引从 开始，`1`而不是从`0`. `fmly(1:23)`相当于`fmly(:23)`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T21:30:57.487

`string(A:B)`是一个子字符串，选择字符串 A 到 B 的字符`string`。 `fmly`用少于 23 个字符进行初始化，因此尾随字符将为空白。之后，它将与字符串数组的元素`yearqtr`（或者可能是字符串值函数 yearqtr）连接。

# linq-to-sql - 将 linq 到 sql 视图结果映射到实体 - 如何更改 group by 子句？

> ID：11835421
> 
> 赞同：1
> 
> 时间：2012-08-06T20:25:54.043
> 
> 标签：linq-to-sql

假设我有一个非常简单的数据库图：

![在此处输入图像描述](../Images/da3814f638996b43f849c66b06b401e0.png)

以及对它的看法：

```
 create view vTraining
as
select t.Id as TrainingId,t.[Status]  , 
t.[User], t.Title,t.Organisation,t.[Month],t.[Year], 
s.Id as SubjectId, s.Name as SubjectName,
c.Text as Comment
from Training t
join Subject s on s.Training = t.Id
join Comment c on c.Training = t.Id 
```

带有样本数据：

![在此处输入图像描述](../Images/d0cbcebd1d9ad37227e1c659452d2941.png)

如您所见，这是一个包含三个主题的单一培训。我想通过 linq to sql 将此结果映射到此结构：

```
public class ViewModel
    {
        public string Comment { set; get; }
        public List<Item> Trainings { set; get; }
    }

    public class Item
    {
        public int TrainingId { set; get; }
        public int User { set; get; }
        public int Status { set; get; }
        public string Title { set; get; }
        public string Organisation { set; get; }
        public int? Month { set; get; }
        public int Year { set; get; }
        public List<KeyValuePair<int, string>> Subjects { set; get; }
    } 
```

这是我创建的查询：

```
 var data = (from training in dc.vTrainings
                            group training by new
                           {
                               training.TrainingId,
                               training.Status,
                               training.Month,
                               training.Organisation,
                               training.Title
                           }
                                into g
                                select new ViewModel()
                                {
                                    Comment = g.Select(x =>
                                    x.Comment).First(),
                                    Trainings = g.Select(
                                     x => new Item()
                                     {
                                         Month = x.Month,
                                         Organisation = x.Organisation,
                                         Title = x.Title,
                                         Year = x.Year,
                                         Subjects = g.Select(
                                         z => new KeyValuePair<int, string>(z.SubjectId, z.SubjectName)).ToList()
                                     }).ToList()

                                })//.GroupBy(x => x.Trainings).Select(x => x.Key)
                                    .ToList(); 
```

不幸的是，我得到的结果不是我想要的： ![在此处输入图像描述](../Images/5c42458b6cb07477ff44ec818e0bcadd.png)

ViewModel 对象只创建可以的对象，但对于每个单独的主题，都会创建新的项目（应该是一个）。Subjets 列表已正确创建。我试图创建第二组，以及其他一些东西，但这是我现在能得到的最好结果。如何编写此查询以获取一个 ViewModel 对象，该对象具有一个 Item 对象和三个主题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T07:42:37.770

我终于得到了正确的结果：

```
var data = (from g in
                                (from training in dc.vTrainings
                                 where training.Status ==1
                                 group training
                                 by new
                                {
                                    training.TrainingId,
                                    training.Status,
                                    training.Month,
                                    training.Organisation,
                                    training.Title
                                }
                                     into g
                                     select g).AsEnumerable()

                            select new ViewModel()
                            {
                                Comment = g.Select(x =>
                                x.Comment).FirstOrDefault(),
                                Trainings = g.GroupBy(x => x.Status).Select(
                                 x => new Item()
                                 {
                                     Month = g.Key.Month,
                                     Organisation = g.Key.Organisation,
                                     Title = g.Key.Title,
                                     Subjects = (from i in g select new KeyValuePair<int, string>(i.SubjectId, i.SubjectName)).ToList()
                                 }).ToList()
                            }).ToList(); 
```

此查询仅适用于一次培训，但对我来说这不是问题，因为我按最新状态对其进行了过滤。我仍然很好奇如何为不止一次培训编写它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T07:19:16.547

尝试这个：

```
 var trainings =
                dc.vTrainings
                    .GroupBy(
                        t => new
                        {
                            t.TrainingId,
                            t.Status,
                            t.Month,
                            t.Organisation,
                            t.Title,
                            t.User,
                            t.Year
                        },
                        t =>
                        new
                        {
                            t.SubjectId,
                            t.SubjectName
                        })
                    .ToList()
                    .Select(
                        t =>
                            new Item
                            {
                                TrainingId = t.Key.TrainingId,
                                Status = t.Key.Status,
                                Month = t.Key.Month,
                                Organisation = t.Key.Organisation,
                                Title = t.Key.Title,
                                User = t.Key.User,
                                Year = t.Key.Year,
                                Subjects =
                                    t.Select(s => new KeyValuePair<int,string>(s.SubjectId,s.SubjectName)).ToList()
                            }); 
```

# ipad - fancybox2 iframe 在 ipad 上使用移动 safari 滚动

> ID：11835423
> 
> 赞同：0
> 
> 时间：2012-08-06T20:26:05.993
> 
> 标签：ipad, iframe, safari, scroll, fancybox

有谁知道在使用 iframe 和 fancybox2 时可以轻松进行滚动的修复方法？使用移动 safari 的 ipad 似乎仍然不允许滚动条或触摸滚动

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T11:34:26.207

不显示滚动，只需打开具有框架内容高度的fancybox，然后用户将像在通常的窗口中一样滚动弹出窗口。

在 iframe 模板中添加移动元数据：

```
 <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/> 
```

像这样调用fancybox：

```
 if( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
       $("a.fancybox").fancybox({
            'scrolling' : 'yes',
            'type'      : 'iframe',
            'autoSize'  : true,
            'autoResize': true,
            'fitToView' : false 
        });
   } 
```

您可能想要设置宽度。

这对我行得通。

# ruby-on-rails - 将 Rails Inflections 与 `rails generate` 一起使用

> ID：11835428
> 
> 赞同：2
> 
> 时间：2012-08-06T20:26:34.117
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我正在尝试生成一个名为 的模型`ClassAttendance`，但 Rails 一直在命名迁移`class_attendances`。我尝试通过将以下代码放入以下代码来纠正此问题`\config\initializers\inflections.rb`：

```
ActiveSupport::Inflector.inflections do |inflect|
  inflect.uncountable "attendance"
end 
```

这似乎在 rails 控制台中工作正常：

```
$ rails console
Loading development environment (Rails 3.2.6)
irb(main):001:0> "attendance".pluralize
=> "attendance" 
```

不幸的是，rails 模型生成器似乎不受影响：

```
$ rails generate model ClassAttendance 
      invoke  active_record
      create    db/migrate/20120806201910_create_class_attendances.rb
      create    app/models/class_attendance.rb
      invoke    rspec
      create      spec/models/class_attendance_spec.rb 
```

它与此有关吗？

```
irb(main):002:0> "class_attendance".pluralize
=> "class_attendances" 
```

还是我没有看到其他问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:52:45.200

这是解决方法，您需要将其`inflections.rb`放在`config/initializers/`. 所以你`config/initializers/inflections.rb`会是

```
ActiveSupport::Inflector.inflections 做 |inflect|
  inflect.uncountable %w( 出勤等级_attendance ClassAttendance)
结尾

```

# php - 我需要按照从 mysql 获取的顺序排列我的结果

> ID：11835433
> 
> 赞同：0
> 
> 时间：2012-08-06T20:27:10.533
> 
> 标签：php, arrays, json, classification

我有一个如下的数据库表：

```
id | igroup | title     | url          | text
1  |   gr1  | Title 1   | urltoimage1  | text1
2  |   gr1  | Title 2   | urltoimage2  | text2
3  |   gr2  | Title 3   | urltoimage3  | text3
4  |   gr2  | Title 4   | urltoimage4  | text4 
```

**我的意思是，我想要一个多维数组（用于上述结构），如下所示；**

```
$result[gr1] = [Title 1|urltoimage1][Title 2|urltoimage2]
$result[gr2] = [Title 3|urltoimage3][Title 4|urltoimage4] 
```

最后，我将`$result`通过 JSON 将此数组发送到页面。

因此，在我的页面中，我将为分类图片库安排这些值，例如：

```
Group 1(caption text)
--------
image1 image2 (clickable images)

Group 2(caption text)
--------
image3 image4 (clickable images) 
```

编辑：我通过 igroup 更正了组字段。

问题已修改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:36:04.293

您将需要使用`ORDER BY`添加到查询中的语句来获取结果。

```
SELECT id, igroup, title, url, text
FROM images
ORDER BY igroup; 
```

> **警告：**
> 
> 请不要使用`mysql_*`函数来编写新代码。它们不再被维护并且社区已经开始了[弃用过程](http://news.php.net/php.internals/53799)。看到[**红框**](http://uk.php.net/manual/en/function.mysql-connect.php)了吗？
> 
> 相反，您应该了解[准备好的语句](http://en.wikipedia.org/wiki/Prepared_statement)并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)。[本文](http://php.net/manual/en/mysqlinfo.api.choosing.php)应该提供一些有关决定使用哪个 API 的详细信息。对于 PDO，这里有一个[很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

示例代码：

```
$result = mysql_query(THE_STATEMENT_ABOVE);

$groups = array();
while ( $row = mysql_fetch_assoc($result) )
    $groups[ $row['igroup'] ][] = $row; 
```

这将建立一个很好的`$groups`数组。要解析上面创建的数组，您可以使用[迭代器](http://php.net/manual/en/class.iterator.php)或简单的[`foreach`](http://php.net/manual/en/control-structures.foreach.php)构造。

```
foreach ( $groups as &$one_group ) {
    print("Group 1: <br>");

    foreach ( $one_group as &$one_image ) {
        // Here you have the contets of the previously fetched $row rows of the result.
        print('<a href="' .$one_image['url']. '">' .$one_image['title']. '</a><br>');
    }
} 
```

这会给你一个很好的输出，如下所示：

```
Group 1:
Image 1 (clickable)
Image 2 (clickable)

Group 2:
Image 3 (clickable)
Image 4 (clickable) 
```

**不再适用：**此外，您应该避免将`GROUP`其用作字段名称，因为它是[MySQL 的保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)之一。

**编辑：**我还将字段名称更正为`igroup`.

# php - 通过 Facebook 检索 jpeg 图像会大大降低质量。

> ID：11835435
> 
> 赞同：1
> 
> 时间：2012-08-06T20:27:20.220
> 
> 标签：php, facebook, image, image-processing, facebook-php-sdk

我一直在努力解决将图像保存为 jpeg 质量的问题。作为我学位的一个项目，我正在制作一个应用程序，我在 facebook 上上传图像。

我有一个漂亮的彩色图像，我将像素值打乱以获得映射图像。然后我把它上传到脸书上。当我下载并将像素移回原始图像时，它的质量损失太大了。

以下是原始、映射和检索的图像：

![原来的](../Images/7c4e61cd47b79c51251951dbf34a7372.png) ![蒙面](../Images/48fbbe452f1fe8be4ed5de801bc3491e.png) ![检索图像](../Images/d0275913cc43799f8b720f98398d0227.png)

我尝试了许多策略，例如使用 png 文件，这些都有效。但是，目前，无论图像是什么，facebook 都会将其转换为 jpeg。因此，如果我将 maskedimage.png 上传到 facebook，它会将其转换为 .jpg 并丢失一些像素相关值，这最终不会给我正确的图像来检索原始图像。

我正在使用 PHP 和 facebook-php sdk。

请建议。
谢谢
-考尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:32:38.517

你被困住了。JPEG是一种有损算法，它依赖于人类视觉特征来掩盖不准确之处。通过加扰像素，您改变了损失的性质，使其不再不可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T08:22:27.453

这主要不是关于 JPEG 有损；这是关于 Facebook 强制图像重新压缩，即使您在上传时选中“高质量”。

您可以做的最好的事情是将源图像分辨率加倍，对于纯色，请尝试引入噪声。此[GD.SE 问题中的详细信息](https://graphicdesign.stackexchange.com/questions/3134/facebook-ways-to-preserve-image-quality-of-uploaded-images)

[请注意，至少自2012 年 6 月](http://www.vancouverpov.ca/wp/social-media/tips-to-improve-facebook-cover-photo-quality/#comment-5483)以来，上传 <100kb 的图像的技巧不再有效。

# iphone - 如何使用 NSCalendar 获取星期几？

> ID：11835437
> 
> 赞同：0
> 
> 时间：2012-08-06T20:27:21.603
> 
> 标签：iphone, ios, xcode

我想得到星期几，最好是从 1 到 7 的整数……这可能吗？

这就是我目前必须得到的当前小时、分钟和秒......

```
NSCalendar *gregorian = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
NSDateComponents *dateComponents = [gregorian components:(NSHourCalendarUnit  | NSMinuteCalendarUnit | NSSecondCalendarUnit ) fromDate:[NSDate date]];

NSInteger hour = [dateComponents hour];
NSInteger minute = [dateComponents minute];
NSInteger second = [dateComponents second]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:32:00.313

你可以使用这个：

```
NSDateComponents *weekdayComponents =[gregorian components:NSWeekdayCalendarUnit fromDate:myDate];

NSInteger weekday = [weekdayComponents weekday]; 
```

或者与您已有的代码集成：

```
NSDateComponents *dateComponents = [gregorian components:(NSHourCalendarUnit  | NSMinuteCalendarUnit | NSSecondCalendarUnit | NSWeekdayCalendarUnit) fromDate:[NSDate date]];

NSInteger weekday = [dateComponents weekday]; 
```

这将使您获得 1 .. 7 的值，其中 1 是星期日。

希望有帮助。

# mysql - Mysql - 根据条件删除重复行的 sql 查询

> ID：11835439
> 
> 赞同：3
> 
> 时间：2012-08-06T20:27:28.083
> 
> 标签：mysql, sql

我有一个包含近 100 万条记录的数据库表 - 当我编写查询以查看其中有多少是重复的 - 有接近 90K 记录是重复的 - 重复是指具有相同电子邮件地址的记录 - 就像一个电子邮件地址- 可能有 10 条记录。

样本数据

```
身份证 | 姓名 | 电子邮件 | 电话
 1 | 美国广播公司 | abc@gmail.com | 12345
 2 | 定义 | def@gmail.com | 12533
 3 | 美国广播公司 | abc@gmail.com |
 4 | 嗨| hij@gmail.com | 50633   
 5 | 美国广播公司 | abc@gmail.com | 12345
 6 | 定义 | def@gmail.com |

```

1）ID是表的自增主键

2）如果有两条记录，例如 def@gmail.com - 我需要保留有电话的记录并删除另一条记录

3）现在以 abc@gmail.com 为例 - 有 3 条记录 - 没有手机的一条被删除 - 现在从剩下的两条中删除 - 尽管两者都有所有数据 - 保留第一条并删除第二条

是否可以根据条件编写删除语句，或者是否有更简单的方法来完成此操作。

一个可以玩的 SQLfiddle - [http://sqlfiddle.com/#!2/cf8c7](http://sqlfiddle.com/#!2/cf8c7)

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:57:51.247

```
DELETE FROM phoney ph
WHERE ph.zphone IS NULL
AND EXISTS (SELECT *
        FROM phoney ex
        WHERE ex.zname = ph.zname
        AND ex.zemail = ph.zemail
        AND ex.zphone IS NOT NULL
        );

DELETE FROM phoney ph
WHERE ph.zphone IS NOT NULL
AND EXISTS (SELECT *
        FROM phoney ex
        WHERE ex.zname = ph.zname
        AND ex.zemail = ph.zemail
        AND ex.id < ph.id
        );

SELECT * FROM phoney; 
```

结果：

```
DELETE 2
DELETE 1
 id | zname |    zemail     | zphone 
----+-------+---------------+--------
  1 | abc   | abc@gmail.com | 12345
  2 | def   | def@gmail.com | 12533
  4 | hij   | hij@gmail.com | 50633 
```

注意：您*可以*组合两个删除查询，但这会导致 WHERE 子句中的 AND/OR 条件混乱，这*很*容易出错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-09T12:52:57.417

试试下面的查询：

```
DELETE b.* FROM table1 a INNER JOIN table1 b ON a.name = b.name AND a.id < b.id 
```

# css - 身体上的边距没有被覆盖？

> ID：11835441
> 
> 赞同：-1
> 
> 时间：2012-08-06T20:27:29.890
> 
> 标签：css, margin

我的页面顶部有一个固定的 div，但由于某种原因，当它应该与屏幕顶部齐平时，它上方有一个间隙。

在检查 HTML 时，我发现 body 似乎有 8px 的 margin-top。我实现了 normalize.css 来解决问题（因为它在以后很有用）现在在我的 Chrome 工具中它显示为被覆盖（margin-top:8px 已被删除并且 normalize.css margin:0; 是不是）但是它似乎没有对设计做出任何改变？

可以在这里找到：

[http://www.haselden.co.uk/james/docs/index.html](http://www.haselden.co.uk/james/docs/index.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:32:50.637

尝试为#navigation 设置此样式：

```
#navigation {
    position: fixed;
    height: 100px;
    top: 0;
    width: 100%;
    background-image: url('images/stripes_bg.png');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:43:00.787

`h1`in`#wrapper #top`有一个向下推的边距，也创建了向下`#wrapper`推`#navigation`元素的边距。如果你`top-margin`从 中删除它`h1`，一切都会像你想要的那样向上滑动。

# google-drive-api - 用于执行存储在 Google 驱动器中的文件的本地备份的脚本

> ID：11835442
> 
> 赞同：0
> 
> 时间：2012-08-06T20:27:30.433
> 
> 标签：google-drive-api, google-apps

我即将将所有重要文件存储在 Google Drive 上。在这样做之前，我想确保我有一个正确的备份，以防我意外删除文件。

有一些工具可以执行 Google Drive 的备份/恢复（例如 backupify）。但是，我想保持简单，并在我的 PC 上运行一个脚本，假设每天备份一次存储在 Google Drive 中的文件。

有没有人有脚本来执行这个？该脚本可以在 PC 或 Mac 上。

非常感谢你的帮助 ！

雨果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T20:45:42.110

保存文件本地备份的最简单方法可能是安装 Google Drive 应用程序。有适用于 PC 和 Mac 的版本：

[http://support.google.com/drive/bin/answer.py?hl=en&answer=2374989](http://support.google.com/drive/bin/answer.py?hl=en&answer=2374989)

周杰伦

# html - 为什么 iframe 在嵌入到 Web 应用页面时不加载？

> ID：11835444
> 
> 赞同：3
> 
> 时间：2012-08-06T20:27:51.253
> 
> 标签：html, google-apps-script, iframe, web-applications

我尝试将此 html 代码加载到 Google 脚本中：

`<iframe src="http://www.w3schools.com"></iframe>`

保存名为“page”的文件，然后在 Google 脚本中使用它：

`function doGet() { return HtmlService.createHtmlOutputFromFile('page'); }`

它查看 iframe，但没有内容。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:47:47.410

您不能在 Apps 脚本中显示 iframe。

# php - CI 中的表单类或控制器

> ID：11835445
> 
> 赞同：0
> 
> 时间：2012-08-06T20:27:53.683
> 
> 标签：php, codeigniter

我将如何创建以下内容：

I am looking to create a dropdown menu full of form input types but when one is selected I would like it to create the respective html for the input and save it to the database. 我将使用codeigniter。

**例子：**

如果我从下拉菜单中选择文本区域，它将创建`<textarea></textarea>`，然后我可以将其转义并将其保存到数据库中。

到目前为止，我已经提出了以下代码

```
 if (isset($_REQUEST['general_options'])) 
        {

            $optionName  = $_REQUEST['general_options'];

            $optionValue = strtolower(str_replace(" ", "", $_REQUEST['general_options']));

            //$this->load->view( $page, $data, FALSE);
            echo form_label($optionName, $optionValue);
            echo form_input($optionValue, '', '');
        }` 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:40:15.697

除非您每次做出选择时都打算重新加载页面，否则最好的选择是合并诸如 jQuery 之类的东西，它是一个 javascript 库。

然后你可以做类似的事情

```
<select id="mySelect">
   <option value="none" selected="selected">---Select---</option>
   <option value="textarea">Textarea</option>
</select>

<div id="appendElem"></div>

<script type="text/javascript">
   $('#mySelect').change(function()
   {
      if($(this+' option:selected').val() == "textarea")
      {
          $('#appendElem').html('<textarea>Some Text...</textarea>');
      }
   })
</script> 
```

值得一提的一点是因为 Codeigniter 有一个表单助手类，并通过其文档表明它是在页面上构建表单的唯一方法。标准 HTML 表单在您的视图中同样有效。

# c# - PDF 将零件编号转换为链接

> ID：11835446
> 
> 赞同：2
> 
> 时间：2012-08-06T20:27:55.083
> 
> 标签：c#, pdf, adobe, ghostscript

我有一个非常大的 PDF 目录，其中包含超过 50K 的零件编号。想编写一个将零件编号转换为可点击链接的过程。一直在使用 Acrobat、iTextSharp、PDFSharp 和其他一些工具，但似乎看不到以前是否做过类似的事情？

我是否需要手动更新每个链接，或者是否有希望使这个过程自动化？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T17:46:43.413

[使用Docotic.Pdf 库](https://bitmiracle.com/pdf-library/)可以轻松完成此任务。

该库可以从具有边界矩形的页面中检索所有单词。此外，该库可以在 PDF 页面的指定位置创建超链接。

这是您的任务的简短示例。以下代码打开指定文件，查找所有以 L 开头的单词并将这些单词“转换”为链接。

```
public static void makeWordsHyperlinks(string file, string outputFile)
{
    using (PdfDocument pdf = new PdfDocument(file))
    {
        foreach (PdfPage page in pdf.Pages)
        {
            PdfCollection<PdfTextData> words = page.GetWords();
            foreach (PdfTextData word in words)
            {
                // let's take anything starting from L
                // you can discriminate words as you like, of course
                if (word.Text.StartsWith("L", StringComparison.InvariantCultureIgnoreCase))
                {
                    // build lookup query. you can use any url, of course
                    string lookupUrl = string.Format(@"https://www.google.ru/#q={0}", word.Text);

                    // let's draw rectangle around word.
                    // just to make links easier to find
                    page.Canvas.DrawRectangle(word.Bounds, PdfDrawMode.Stroke);

                    page.AddHyperlink(word.Bounds, new Uri(lookupUrl));
                }
            }
        }

        pdf.Save(outputFile);
    }
} 
```

我假设您的零件编号类似于 XXX-YYYYY。如果您的零件编号由几个单词组成，那么任务会有点困难。您将需要组合单词及其边界矩形。

免责声明：我为图书馆的供应商工作。

# php - 来自 PHP-MySQL 查询的键控 JSON 字典响应

> ID：11835450
> 
> 赞同：1
> 
> 时间：2012-08-06T20:28:12.950
> 
> 标签：php, mysql, arrays, json, dictionary

我有两个 MySQL 表，一个用于水果，一个用于蔬菜，我想查询这些表的内容并在一个大型 JSON 字典中返回两组结果，以 Fruits 为键以返回水果数组，以蔬菜为键以返回蔬菜大批。它目前不起作用（返回 null）。

这是我当前的代码：

```
//query each table for every object
$fruitResult = mysql_query("SELECT * FROM Fruits");
$vegResult = mysql_query("SELECT * FROM Vegetables");

//set up an array for each kind of object
$fruits = array();
$vegetables = array();

while ($fruitRow = mysql_fetch_assoc($fruitResult)) {
    //add each result from Fruit table to array
    $fruits[] = $fruitRow;
}
while ($vegRow = mysql_fetch_assoc($vegResult)) {
    //add each result from Veggie table to array
    $vegetables[] = $vegRow;
}

//create dictionary
$dictionary = array("Fruit"=>$fruits,"Vegetables"=>$vegetables);

echo json_encode($dictionary); 
```

我可以把这些东西分开，然后

```
echo json_encode($fruits);
echo json_encode($vegetables); 
```

但是随后返回了两个单独的数组。任何人都可以解释一下吗？
我希望我的回复看起来像这样：

```
[{"Fruit":
    [{"id":"0","name":"apple","color":"red"},
    {"id":"1","name":"strawberry","color":"red"},
    {"id":"2","name":"grape","color":"purple"}],
{"Vegetables":
    [{"id":"0","name":"pea","color":"green"},
    {"id":"1","name":"asparagus","color":"green"},
    {"id":"2","name":"corn","color":"yellow"}]
}] 
```

# r - 如何更改 ggplot2 中的线条和形状颜色？

> ID：11835451
> 
> 赞同：4
> 
> 时间：2012-08-06T20:28:13.090
> 
> 标签：r, ggplot2

我有一个像这样的数据框：

```
x <- data.frame(time = c('1', '2', '3'), perc = c(0.2, 0.4, 0.6, 0.3, 0.55, 0.69, 0.2, 0.22, 0.35), type=c(rep('a', 3), rep('b', 3), rep('c', 3))) 
```

并想做这样的情节（下），但使用这些不同的颜色`c('#0023a0', '#f9a635', '#bebec0')`：

```
ggplot(x, aes(time, perc, group=type, colour=type, shape=type)) + geom_point(size=4) + geom_line(size=1) 
```

![在此处输入图像描述](../Images/1a0646e7082236e3965c150089da28ad.png)

我已经尝试过使用`scale_colour_hue`,`scale_shape_discrete`和的不同方法`scale_fill_manual`，但没有任何成功。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T20:34:01.403

你到底尝试了什么？这似乎对我有用：

```
ggplot(x, aes(time, perc, group = type, pch = type, colour = type)) + 
  geom_point() +
  geom_line() +
  scale_colour_manual(values= c('#0023a0', '#f9a635', '#bebec0')) 
```

![在此处输入图像描述](../Images/e83dc884fcb60d49cc0bd7debeda6aa5.png)

# javascript - Chrome 扩展与 USB 驱动器同步文件

> ID：11835452
> 
> 赞同：1
> 
> 时间：2012-08-06T20:28:13.823
> 
> 标签：javascript, html, web-applications, google-chrome-extension

chrome 扩展是否可以在 USB 驱动器和主 HDD 之间同步文件和目录？
例如，这对于从数码相机轻松下载照片可能很有用。

要实现此功能，需要两个主要部分：

1.  对本地硬盘驱动器的读写访问
2.  对 USB 驱动器的读写访问

#1 包含在 HTML5 文件系统 API 中（例如 ，请参见[此处）。](http://www.html5rocks.com/en/tutorials/file/filesystem/)

#2 是有问题的部分，因为我不知道有任何可用的机制允许这样做。
有可能以某种方式利用[USB 实验 api](http://developer.chrome.com/trunk/apps/experimental.usb.html)来实现大容量存储设备协议。但是，我对 USB 协议的了解太有限，无法知道这是否真的可行或可能涉及什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-07T11:55:32.120

一种可能的解决方案（尽管它是一个大锤子）是使用本[机主机](https://developer.chrome.com/extensions/messaging#native-messaging)- 基本上，一个具有完整操作系统 API 的单独程序，并且您的扩展程序与之通信。

缺点包括本机主机不能与 Web Store 中的扩展程序捆绑在一起，这与 NPAPI 插件（不再是一个选项）不同。

`chrome.usb`另一个答案中提到的`chrome.fileSystem`API 不适用于 Chrome 扩展程序，仅适用于应用程序。

# .htaccess - 使用特定域的 .htaccess 重定向到 HTTPS

> ID：11835453
> 
> 赞同：16
> 
> 时间：2012-08-06T20:28:16.633
> 
> 标签：.htaccess, redirect, https

我目前有 2 个域可以访问我服务器上的同一文件夹：metrikstudios.com 和 ziced.com。

我希望通过**http://metrikstudios.com**进入的用户被重定向到**https://metrikstudios.com**，并且通过[http://ziced.com](http://ziced.com)进入的用户不要被重定向到[https://ziced.com](https://ziced.com) .

我目前在我的 .htaccess 上有这个

```
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} 
```

谢谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-08-06T20:36:05.723

您可以简单地添加另一个 RewriteCond 来检查主机是否为 metrikstudios.com

```
RewriteCond %{HTTP_HOST} ^metrikstudios\.com [NC] 
```

它应该是这样的：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^metrikstudios\.com [NC]
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-02-02T18:06:24.053

上面接受的解决方案仅将`non-www`域从重定向`http`到`https`。

如果您想重定向您的域的两个版本，`www`将以下内容放在您的 http 到 https 规则上方或 行之前：`non-www``ssl``RewriteCond``RewriteCond %{HTTPS} off`

```
RewriteCond %{HTTP_HOST} ^(www\.)?example.com$ [NC] 
```

这是将特定域重定向到 https 的完整规则。

```
RewriteEngine on

# First we will check the host header (url)
#if it's www.example.com or example.com
RewriteCond %{HTTP_HOST} ^(www\.)?example.com$ [NC]
# now we will check the https header
# if https is off (Is non-ssl)
RewriteCond %{HTTPS} off
#redirect the request to https
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [NE,L,R=301] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-12-05T06:55:40.960

有时您可能只想在实时服务器上重定向并保留其本地设置。例如，如果在本地机器上，您已经注册了名为的本地主机`www.mysite.loc`并在此主机上设置了项目的本地实例。

在这种情况下，这也可能对某人有所帮助：

```
RewriteEngine On
RewriteCond %{HTTPS} =off
RewriteCond %{HTTP_HOST} !.loc$ [NC]
RewriteRule ^.*$ https://%{SERVER_NAME}%{REQUEST_URI} [R,L] 
```

where `!.loc$`- 如果主机以 . 结尾，则忽略重定向到 https 的规则`.loc`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-29T22:15:50.330

# Linux 和 cPanel 基于 Linux 的帐户使用

***.htaccess***

# 处理重定向的文件。

> 注意：如果您需要创建 .htaccess 文件，可以使用控制面板的文件管理器（Web & Classic / cPanel）。

在您的 .htaccess 文件中使用以下代码会自动将访问者重定向到您网站的 HTTPS 版本：

```
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
If you have an existing .htaccess file: 
```

**不要重复 RewriteEngine On。确保以 RewriteCond 和 RewriteRule 开头的行紧跟在已经存在的 RewriteEngine On 之后。**

# Windows 和 Plesk

## 基于 Windows 的帐户使用 web.config 文件来处理重定向。

**注意：如果您需要创建 web.config 文件，您可以使用控制面板的文件管理器（Web & Classic / Plesk）。**

在您的 web.config 文件中使用以下代码会自动将访问者重定向到您网站的 HTTPS 版本：

```
<configuration>
<system.webServer>
<rewrite>
    <rules>
    <rule name="HTTP to HTTPS redirect" stopProcessing="true"> 
    <match url="(.*)" /> 
    <conditions> 
        <add input="{HTTPS}" pattern="off" ignoreCase="true" />
    </conditions> 
    <action type="Redirect" redirectType="Permanent" url="https://{HTTP_HOST}/{R:1}" />
</rule>   
    </rules>
</rewrite>
</system.webServer>
</configuration> 
```

如果您有现有的 web.config 文件：

确保您有以下部分（即开始和结束标签）： system.webServer（包含重写） 重写（包含规则） 规则（包含一个或多个规则部分） 插入任何不存在的部分。在规则部分中插入整个规则部分，包括匹配、条件和操作。 **注意：您正在将规则（不带“s”）插入规则（带“s”）部分。**

# mysql - 如何查询具有子域级别的域名？

> ID：11835454
> 
> 赞同：0
> 
> 时间：2012-08-06T20:28:16.147
> 
> 标签：mysql

我有一个字段包含域名。域名的等级不同。例如，我有一些 like:`shopping.yahoo.com`和一些 as`www.mail.yahoo.com`和一些 as`yahoo.com`而另一些 as: `www.yahoo.com`。

我需要查询所有超过二级域名的域名。即，不仅仅是格式：（`domain.ext`例如：`shopping.yahoo.com`或`www.shopping.yahoo.com`或`men.shopping.yahoo.com`）。

我不是 Mysql 专家，但我需要做这个查询。对不起这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:35:57.143

您可以根据这样的周期数进行查询

```
SELECT * from table where domain_field LIKE('%.%.%') 
```

# c# - c# mysql语句字符串

> ID：11835462
> 
> 赞同：0
> 
> 时间：2012-08-06T20:28:37.087
> 
> 标签：c#, mysql, string-literals

我正在寻找在 c# 中处理 mysql 字符串语句的最有效方法。以下伪代码示例显示了一个 @ 字符串文字，其中我在字符串中有 2 个变量需要用变量内容替换。c# 中是否有一种有效且简单的方法来执行此操作？

```
string region = "northwest";
string market = "Canada";

string stm = @"
    select distinct(position)
      from plan 
     where region = 'region'
       and market = 'market'
"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:32:19.373

使用如下参数：

```
string stm = @"
    select distinct(position)
      from plan 
     where region = @region
       and market = @market
";

MySqlCommand cmd = new MySQLCommand(stm);
cmd.Parameters.AddWithValue("@region",regionvalue);
cmd.Parameters.AddWithValue("@market",marketvalue); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:29:45.287

当然是。

使用[SqlParameter](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.aspx)类将“区域”和“市场”值注入*最终*`SQL string`

有关`INSERT`声明的完整示例，请查看

**编辑**

作为正确的*破折号*，用于访问的有效类`MySQL` *可能是* `MySqlParameter`.

[C# – Sql 参数源代码 – 插入语句](http://idealprogrammer.com/net-languages/code-samples/sql-parameters-insert-statement/)

# android - android，从资产中读取 jpg 图像

> ID：11835463
> 
> 赞同：2
> 
> 时间：2012-08-06T20:28:38.440
> 
> 标签：android

我从资产文件夹加载图像，但我有一个问题。

从资产和资源加载的相同图像的尺寸不同 - 分辨率。

为了从资产中获取图像，我使用以下方法：

```
AssetManager am=this.getAssets();
            try {
                Bitmap bmp = BitmapFactory.decodeStream(am.open("imgs/a.jpg"));
                imageViewDraw.setImageBitmap(bmp);
            } catch (IOException e) {

                e.printStackTrace();
            } 
```

从 R.drawable 加载的同一图像的输出和资产在图像上

有人能告诉我为什么以及如何从资产中读取图像，但分辨率应该与 R.drawable 相同吗？

![输出图像](../Images/4746895d8c098585fffd076c8b182f44.png)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:58:30.167

您需要将 setDrawable 与缩放的可绘制对象一起使用。

imageView.setImageDrawable(new BitmapDrawable(getContext().getResources(),bitmap));

这也是为什么不推荐使用其他没有获取 getResources() 参数的方法的原因，它会在这种情况下处理缩放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:41:58.613

如果要将位图加载到 Imageview，请使用 scaleType 和 adjustViewbounds 参数。因此，例如在 XML 中：

```
 <ImageView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:adjustViewBounds="true"
                        android:scaleType="centerInside" /> 
```

问题是，当您从资产目录加载图像时，系统不会对您的位图应用任何缩放或处理，而是在使用可绘制文件夹时，android 会尝试根据设备的分辨率缩放图像。

因此，获得完全相同结果的唯一真正方法是为 imageview 使用固定大小，理想情况下，您应该在 dps 中指定它，理想情况下，您应该将该值放在 dimens.xml 文件中，以便您可以为各种系统更改该值配置

# dependency-injection - 如何使用 CDI 注入带有参数化构造函数的类实例（仅限 Java EE 6）

> ID：11835464
> 
> 赞同：3
> 
> 时间：2012-08-06T20:28:40.950
> 
> 标签：dependency-injection, java-ee-6, cdi

我是 CDI 的新手，尝试搜索用法，找不到任何东西，所以发布了这个问题。我试图弄清楚如何仅使用 CDI 注入带有参数化构造函数的类的实例。我没有使用 Spring，所以在 Spring 中如何完成并没有帮助。这是我创建的一个示例，用于显示问题所在。我的@Inject 在这种情况下不起作用。

```
 public class A 
    {
        public A(boolean deliverFromLocalWarehouse)
        {
            if(deliverFromLocalWarehouse)
            {
                wareHouseId = new Integer(10); 
            }
            else 
            {
                wareHouseId = new Integer(100);
            }
        }

        public void deliver()
        {
            //get wareHouse address by Id and initiate delivery.   
        }

        private Integer wareHouseId = null;
    }

    public class B 
    {

        @Inject
        private A a;
    } 
```

谢谢斯里克里希纳卡拉瓦查拉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:38:11.687

如果构造函数参数应该来自一个bean，我想你可以简单地注释它：

```
public A(@Inject boolean localWarehouse) { ... 
```

并将其注入

```
@Inject A a; 
```

如果您想要 A 的两个不同实例（具有不同的构造函数参数），您可以对它们进行子类化：

```
public AForLocalWarehouse extends A {
    public AForLocalWarehouse() {
        super(true);
    }
} 
```

并注入它们

```
@Inject AForLocalWarehouse a; 
```

或使用带有[限定符的](http://docs.oracle.com/javaee/6/tutorial/doc/gjbck.html)[生产者方法](http://docs.oracle.com/javaee/6/tutorial/doc/gkgkv.html)：

```
@Produces @LocalWarehouse
public A localWarehouse() { return new A(true); }

@Produces @RemoteWarehouse
public A remoteWarehouse() { return new A(false); } 
```

并注入它们

```
@Inject @LocalWarehouse A a;
@Inject @RemoteWarehouse A a; 
```

# php - 在 Symfony 2 和 Doctrine 中设置多对一关系时出现奇怪的异常

> ID：11835467
> 
> 赞同：1
> 
> 时间：2012-08-06T20:28:56.083
> 
> 标签：php, symfony, doctrine

尝试更新实体时出现以下异常：

```
The form's view data is expected to be of type scalar, array or an instance of \ArrayAccess, but is an instance of class Proxies__CG__\Acme\DemoBundle\Entity\TicketCategory. You can avoid this error by setting the "data_class" option to "Proxies__CG__\Acme\DemoBundle\Entity\TicketCategory" or by adding a view transformer that transforms an instance of class Proxies__CG__\Acme\DemoBundle\Entity\TicketCategory to scalar, array or an instance of \ArrayAccess. 
```

创建的时候没有问题，关系OK。但是，在更新时，出现了这个奇怪的异常。我的实体设置如下：

```
class Ticket
{
    // ...

    /**
    * @var TicketCategory
    *
    * @ORM\ManyToOne(targetEntity="TicketCategory")
    * @ORM\JoinColumn(name="category_id", referencedColumnName="id")
    */
    protected $category;

    // ...
}

class TicketCategory
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var string $title
     *
     * @ORM\Column(name="title", type="string", length=255)
     * @Assert\NotBlank()
     */
    private $title;

    // ...
} 
```

形式

```
class TicketType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('title', 'text', array(
                    'error_bubbling' => true,
                )
            )
            ->add('category', 'text', array(
                    'error_bubbling' => true,
                )
            )
        ;
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'Acme\DemoBundle\Entity\Ticket',
            'csrf_protection' => false,
        ));
    }

    public function getName()
    {
        return '';
    }
} 
```

有什么想法吗，伙计们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:22:13.913

问题是：

```
 $builder
        ->add('category', 'text', array(
                'error_bubbling' => true,
            )
        )
    ; 
```

字段`category`声明为“文本”类型，因此您只能将标量（字符串、布尔值等）传递给它。也就是说，您只能指定`Ticket`标量的（类）属性。

在`Ticket`类`category`中它是一个实体，因此会发生错误。

在不知道你想要完成什么的情况下，我想你想让用户为票选择一个类别，所以我会这样做：

```
 $builder
        ->add('category', 'entity', array(
                'label'    => 'Assign a category',
                'class'    => 'Acme\HelloBundle\Entity\TicketCategory',
                'property' => 'title',
                'multiple' => false
            )
        )
    ; 
```

更多关于[实体字段类型](http://symfony.com/doc/current/reference/forms/types/entity.html)。

**编辑**：不知道你是否省略了它，但`Ticket`没有名为“title”的属性。

# ruby-on-rails - 在 Rails 中管理 URL 参数

> ID：11835471
> 
> 赞同：1
> 
> 时间：2012-08-06T20:29:19.410
> 
> 标签：ruby-on-rails, url, rest, acts-as-taggable-on

现在我发现在 Rails 中构建路由和 URL 是半混淆的。我目前已为显示/过滤数据时传入的标签匹配以下内容。

```
match '/posts/standard/' => 'posts#standard'
match '/posts/standard/:tags' => 'posts#standard', :as => :post_tag
match '/posts/standard/:tags' => redirect { |params| "/posts/standard/#{params[:tags].gsub(' ', '+')}" }, :tags => /.+/ 
```

但是，现在我想添加一个只能采用一种状态的“技能”参数；但是，我对如何在我的 URL 中构建它感到非常困惑。我不能简单地...

```
match '/posts/standard/:tags/:skill' => 'posts#standard', as => post_tag, as: => post_skill 
```

所以，此时我对此感到非常困惑，Rails 是否为构建 URL 提供任何类型的帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:34:49.693

一种方法是保持你的主要路线

```
match '/posts/standard/:tags' => 'posts#standard', :as => :post_tag 
```

并将附加的 URL 参数作为参数处理。网址看起来像：

```
/posts/standard/1?skill=something 
```

并且很容易注入额外的参数，例如

```
link_to post_tag_path(:skill=> 'something') 
```

然后你的控制器会做

```
def standard
   if params[:skill] == 'something'
     ...
   else 
     ...
   end
end 
```

另外，不确定这一点，但是您的路线中的第一行 'match '/posts/standard/' => 'posts#standard' 可能会捕获您的所有路线，因为有匹配项。如果是这种情况，只需将其移至第一行之后。

# r - 使用 tcltk 输出热图

> ID：11835472
> 
> 赞同：0
> 
> 时间：2012-08-06T20:29:27.407
> 
> 标签：r, indexing, dataframe, heatmap

```
require(tcltk)  
ttMain <- tktoplevel()  
tktitle(ttMain) <- "ttMain"  
launchDialog <- function() {  
    ReturnVal <- modalDialog("First Gene", "Enter A Gene Name", "")  
    if (ReturnVal == "ID_CANCEL") return()  
    tkmessageBox(title = "Heatmap",  
        message = paste("Hello, ", ReturnVal, ".", sep = ""))  
}   
launchDlg.button <- tkbutton(ttMain, text = "Launch Dialog", command = launchDialog)  
tkpack(launchDlg.button) 
```

我想重写代码的最后一行以使**消息**返回热图。我有一个包含所有必要数据（以数字形式表示基因表达的数据）的数据框，称为 pedM，ReturnVal 表示该数据框中的列名（特定基因）。请帮忙。

任何可以提供的提示都会很棒。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:25:40.687

这是一个可能有帮助的例子。您的代码使用 modalDialog AFAIK 不存在的函数。这是一个如何滚动自己的示例

```
library(tcltk)  
library(tcltk2)

tkinput <- function(parent, title, label, okButLabel="Ok", posx=NULL, posy=NULL) {
  if(!require(tcltk2)) stop("This function requires the package tcltk2.")
  if(!require(tcltk)) stop("This function requires the package tcltk.")

  # param checks
  if(!is.character(title)) stop("invalid title argument - character required.")
  if(!is.character(label)) stop("invalid label argument - character required.")

  # toplevel
  tclServiceMode(FALSE) # don't display until complete
  win <- tktoplevel(parent)
  #win <- .Tk.subwin(parent)
  tkwm.title(win, title)
  tkwm.resizable(win, 0,0)
  #tkconfigure(win, width=width, height=height)

  # commands
  okCommand <- function() if(!tclvalue(bookmVar)=="") tkdestroy(win) else tkfocus(te)
  cancelCommand <- function () {
    tclvalue(bookmVar) <- ""
    tkdestroy(win)
  }
  tkwm.protocol(win, "WM_DELETE_WINDOW", cancelCommand)

  # pack 
  f <- tk2frame(win)
  w <- tk2label(f, text=label, justify="right")
  tkpack(w, side="left", padx=5)
  bookmVar <- tclVar("")
  te <- tk2entry(f, textvariable=bookmVar, width=40)
  tkpack(te, side="left", padx=5, fill="x", expand=1)
  tkpack(f, pady=5)
  f <- tk2frame(win)
  w <- tk2button(f, text=okButLabel, command=okCommand)
  tkpack(w, side="left", padx=5)
  w <- tk2button(f, text="Cancel", command=cancelCommand)
  tkpack(w, side="left", padx=5)
  tkpack(f, pady=5)

  # position
  if(is.null(posx)) posx <- as.integer((as.integer(tkwinfo("screenwidth", win)) - as.integer(tkwinfo("width", win))) / 2.)
  if(is.null(posy)) posy <- as.integer((as.integer(tkwinfo("screenheight", win)) - as.integer(tkwinfo("height", win))) / 2.)
  geom <- sprintf("+%d+%d", posx, posy)
  #print(geom)
  tkwm.geometry(win, geom)

  # run
  tclServiceMode(TRUE)
  ico <- tk2ico.load(file.path(R.home(), "bin", "R.exe"), res = "R")
  tk2ico.set(win, ico)
  tk2ico.destroy(ico)
  tkfocus(te)
  tkbind(win, "<Return>", okCommand)
  tkbind(win, "<Escape>", cancelCommand)
  tkwait.window(win)
  tkfocus(parent)
  return(tclvalue(bookmVar))
} 
```

要绘制热图而不是消息框，您可以使用该`tkrplot`函数

```
library(tkrplot)

heat_example <- function() {
    x  <- as.matrix(mtcars)
    rc <- rainbow(nrow(x), start=0, end=.3)
    cc <- rainbow(ncol(x), start=0, end=.3)
    hv <- heatmap(x, col = cm.colors(256), scale="column", 
        RowSideColors = rc, ColSideColors = cc, margins=c(5,10),
        xlab = "specification variables", ylab= "Car Models",
        main = "heatmap(<Mtcars data>, ..., scale = \"column\")")
}

launchDialog <- function() {  
    ReturnVal <- tkinput(parent=ttMain, title="First Gene", label="Enter A Gene Name")  
    if (ReturnVal == "") return()  

    hmwin <- tktoplevel(ttMain)
    img <- tkrplot(hmwin, heat_example)
    tkpack(img, hmwin)
}   

ttMain <- tktoplevel()  
tktitle(ttMain) <- "ttMain"  
launchDlg.button <- tkbutton(ttMain, text = "Launch Dialog", command = launchDialog)  
tkpack(launchDlg.button, ttMain) 
```

此代码生成热图，但也给出了我无法解决的错误消息。也许这里的其他人可以找到问题。

# asp.net-mvc - 我们如何使用 ASP.NET MVC 4 和 MEF 2 支持模块化和可测试的模式？

> ID：11835473
> 
> 赞同：4
> 
> 时间：2012-08-06T20:29:27.517
> 
> 标签：asp.net-mvc, asp.net-mvc-4, mef

我们正在尝试使用 MEF 2 和 ASP.NET MVC 4 来支持可扩展的应用程序。这个问题实际上有两个部分（希望没关系，所以上帝）：

1.  ~~**我们如何使用 Microsoft.Composition 和 MVC 容器代码（[MEF/MVC 演示源](http://mef.codeplex.com/SourceControl/changeset/view/703624739918#oob%2fdemo%2fMicrosoft.Composition.Demos.Web.Mvc%2fCompositionProvider.cs)）来替换 Ninject 作为我们的 DI `ICoreService`、`ICoreRepository`、`IUnitOfWork`和`IDbContext`？**
    *看起来我们不能同时使用 Ninject 和 MVC 容器（我相信很多人都在说“duh”），所以如果可能的话，我们想使用 MEF。我尝试删除 Ninject 并`[Export]`在每个相关实现上设置属性，除了 Web 项目之外还跨越两个程序集，但`Save()`未能坚持没有错误。我将其解释为单例问题，但不知道如何解决（包括`[Shared]`）。*~~

2.  **我们如何在运行时动态加载多个程序集？**
    *我了解如何使用`CompositionContainer.AddAssemblies()`来加载特定的 DLL，但是为了使我们的应用程序能够正确扩展，我们需要更类似于我（模糊地）理解“完整”MEF 中的目录的方式，这些目录已从 Microsoft.Composition 包中删除（我认为？）; 允许我们加载所有`IPluggable`（或其他）程序集，这些程序集将包括它们自己的 UI、服务和存储库层，并与核心服务/存储库相关联。*

**编辑 1**[多读](http://blogs.msdn.com/b/bclteam/archive/2012/03/02/introducing-mef-lightweight-composition-and-an-updated-composition-provider-for-asp-net-mvc-nick.aspx)
一点解决了第一个问题，这确实是一个单例问题。附加到 CoreDbContext 解决了持久性问题。当我简单地尝试时，它将“单例化”扩展到应用程序级别（交叉请求）并抛出异常，指出编辑的对象已经在 EF 缓存中。`[Shared(Boundaries.HttpRequest)]``[Shared]`

**编辑 2**
我使用迭代程序集从下面的 Nick Blumhardt 的答案中加载“肉”来更新我的 Global.asax.cs 代码。他的代码中的标准 MEF 2 容器在我的代码中不起作用，可能是因为我使用的是 MEF 2(?) MVC 容器。摘要：下面列出的代码现在可以按需要工作。

* * *

CoreDbContext.cs (Data.csproj)

```
[Export(typeof(IDbContext))]
[Shared(Boundaries.HttpRequest)]
public class CoreDbContext : IDbContext { ... } 
```

CoreRepository.cs (Data.csproj)

```
[Export(typeof(IUnitOfWork))]
[Export(typeof(ICoreRepository))]
public class CoreRepository : ICoreRepository, IUnitOfWork
{
    [ImportingConstructor]
    public CoreRepository(IInsightDbContext context)
    {
        _context = context;
    }

    ... 
} 
```

CoreService.cs (Services.csproj)

```
[Export(typeof(ICoreService))]
public class CoreService : ICoreService
{
    [ImportingConstructor]
    public CoreService(ICoreRepository repository, IUnitOfWork unitOfWork)
    {
        _repository = repository;
        _unitOfWork = unitOfWork;
    }

    ... 
} 
```

用户控制器.cs (Web.csproj)

```
public class UsersController : Controller
{
    [ImportingConstructor]
    public UsersController(ICoreService service)
    {
        _service = service;
    }

    ... 
} 
```

Global.asax.cs (Web.csproj)

```
public class MvcApplication : System.Web.HttpApplication
{
    protected void Application_Start()
    {
        CompositionProvider.AddAssemblies(
            typeof(ICoreRepository).Assembly,
            typeof(ICoreService).Assembly,
        );

        // EDIT 2 -- 
        // updated code to answer my 2nd question based on Nick Blumhardt's answer
        foreach (var file in System.IO.Directory.GetFiles(Server.MapPath("Plugins"), "*.dll"))
        {
            try
            {
                var name = System.Reflection.AssemblyName.GetAssemblyName(file);
                var assembly = System.Reflection.Assembly.Load(name);
                CompositionProvider.AddAssembly(assembly);
            }
            catch
            {
                // You'll need to craft exception handling to
                // your specific scenario.
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:36:41.207

MEF 不打算用作 DI 框架。这意味着您应该将您的“插件”（无论它们是什么）组合与您的基础设施依赖项分开，并通过 MEF 实现前者，而后者通过您喜欢的任何 DI 框架实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T10:01:20.193

我认为对于MEF能做什么和不能做什么存在一些误解。

最初 MEF 被设想为纯粹的可扩展性架构，但随着框架发展到其第一个版本，它也可以作为 DI 容器得到完全支持。MEF 将为您处理依赖注入，并通过它的`ExportProvider`体系结构来处理。也完全可以将[其他 DI 框架与 MEF](http://www.fidelitydesign.net/?p=159)一起使用。所以实际上有很多方法可以实现：

1.  构建一个`NinjectExportProvider`您可以插入 MEF 的工具，因此当 MEF 搜索可用的导出时，它将能够询问您的 Ninject 容器。
2.  使用 Common Services Locator 模式的实现在 MEF 和 Ninject 之间架起桥梁，反之亦然。

因为您使用 MEF 来实现可扩展性，所以您可能希望使用前者，因为这会将您的 Ninject 组件暴露给 MEF，而 MEF 又将它们暴露给您的插件。

要考虑的另一件事有点令人失望，实际上在 ASP.NET 上自动插入诸如 Wordpress*的功能的空间并不大。*ASP.NET 是一个编译和托管的环境，因此您要么通过在运行时手动加载程序集来求助于后期绑定，要么重新启动应用程序以获取新插件，这有点违背了能够通过应用程序插入新的扩展。

我的建议是规划您的架构，以便在启动时选择任何可扩展点，并假设任何核心更改都需要部署和应用程序重新启动。

就直接提出的问题而言：

1.  `CompositionProvider`实例中的接受在`ContainerConfiguration`内部用于创建`CompositionContainer`提供者使用的。因此，您可以将其用作自定义容器实例化方式的点。`ContainerConfiguration`支持一个`WithProvider`方法：

    `var configuration = new ContainerConfiguration().WithProvider(new NinjectExportDescriptorProvider(kernel));` `CompositionProvider.SetConfiguration(configuration);`

`NinjectExportDescriptorProvider`可能在哪里：

```
public class NinjectExportDescriptorProvider: ExportDescriptorProvider
{
  private readonly IKernel _kernel;

  public NinjectExportDescriptorProvider(IKernel kernel)
  {
    if (kernel == null) throw new ArgumentNullException("kernel");

    _kernel = kernel;
  }

  public override IEnumerable<ExportDescriptorPromise> GetExportDescriptors(
    CompositionContract contract, DependencyAccessor dependencyAccessor)
  {
    var type = contract.ContractType;

    if (!_kernel.GetBindings(type).Any())
      return NoExportDescriptors;

    return new[] {
      new ExportDescriptorPromise(
        contract,
        "Ninject Kernel",
        true, // Hmmm... need to consider this, setting it to true will create it as a shared part, false as new instance each time,
        NoDependencies,
        _ => ExportDescriptor.Create((c, o) => _kernel.Get(type), NoMetadata)) };
    }      
  }
} 
```

**注意：我没有对此进行测试，这都是理论，并且基于以下示例`AppSettingsExportDescriptorProvider`：[http ://mef.codeplex.com/wikipage?title=ProgrammingModelExtensions](http://mef.codeplex.com/wikipage?title=ProgrammingModelExtensions)**

它与使用标准不同`ExportProvider`，因为使用`CompostionProvider`是围绕轻量级组合构建的。但本质上，您正在结束对 Ninject 内核的访问，并将其提供给您的`CompositionContainer`.

1.  与添加特定的新提供程序（见上文）一样，您可以使用`ContainerConfiguration`来读取可用的程序集，可能类似于：

    `var configuration = new ContainerConfiguration().WithAssemblies(AppDomain.GetAssemblies())`

同样，我还没有测试所有这些，但我希望它至少为您指明了正确的方向。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T04:00:36.953

如果我理解正确，您正在寻找将从目录加载所有程序集并将它们加载到容器中的代码；这是这样做的骨架：

```
var config = new ContainerConfiguration();
foreach (var file in Directory.GetFiles(@".\Plugins", "*.dll"))
{
   try
   {
       var name = AssemblyName.GetAssemblyName(file);
       var assembly = Assembly.Load(name);
       config.WithAssembly(assembly);
   }
   catch
   {
       // You'll need to craft exception handling to
       // your specific scenario.
   }
}
var container = config.CreateContainer();
// ... 
```

Hammett 讨论了这种情况，并在此处显示了 F# 中更完整的版本：http: [//hammett.castleproject.org/index.php/2011/12/a-decent-directorycatalog-implementation/](http://hammett.castleproject.org/index.php/2011/12/a-decent-directorycatalog-implementation/)

请注意，这不会检测应用程序启动后添加到目录中的程序集 - Microsoft.Composition 不适合这种用途，因此如果插件集发生更改，最好的办法是使用目录观察程序检测它并提示用户重启应用。！

# mysql - 如何确定每个样本在mysql中的每日累计值？

> ID：11835476
> 
> 赞同：0
> 
> 时间：2012-08-06T20:29:44.260
> 
> 标签：mysql, join

我有一个运行总数的 mysql 表：

```
+---------------------+--------+
| Timestamp           | Total  |
+---------------------+--------+
| 2012-07-04 05:35:00 |  1.280 | 1.280-1.280 = 0
| 2012-07-04 09:25:00 |  2.173 | 2.173-1.280 = 0.893
| 2012-07-04 09:30:00 |  2.219 | 2.219-1.280 = 0.939
| 2012-07-04 15:00:00 |  7.778 | 7.778-1.280 = 6.498
| 2012-07-04 21:05:00 | 13.032 | 13.032-1.280 = 11.752
| 2012-07-04 22:00:00 | 13.033 | 13.033-1.280 = 11.753
| 2012-07-05 05:20:00 | 13.033 | 13.033-13.033 = 0
| 2012-07-05 07:10:00 | 13.140 | 13.140-13.033 = 0.107
| 2012-07-05 10:15:00 | 14.993 | 14.993-13.033 = 1.960
| 2012-07-05 11:35:00 | 16.870 | 16.870-13.033 = 3.837
+---------------------+--------+ 
```

我正在寻找的是一个查询，它确定每个时间间隔的累计每日增长。我试图展示期望的结果以及每一行背后的计算。我已经尝试了几件加入的事情，但不知何故我无法确定每天的起始值是多少。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:46:58.657

我无法保证此查询的效率，但它确实为您提供了您正在寻找的结果：

```
SELECT t1.`Timestamp`, t1.`Total`, 
      CASE WHEN t1.`timestamp` =
            (SELECT MIN(t2.`Timestamp`)
             FROM myTable t2 
             WHERE DATE(t2.`Timestamp`)=DATE(t1.`Timestamp`)) 
        THEN 0
        ELSE t1.`Total` - (SELECT MIN(t3.`Total`)
              FROM myTable t3
              WHERE DATE(t3.`Timestamp`)=DATE(t1.`Timestamp`))         
        END AS Diff
FROM myTable t1
ORDER BY `Timestamp` 
```

**替代解决方案（我认为更有效）**

```
SELECT  t1.`Timestamp`, t1.`Total`, (t1.`Total` - d1.MinVal) diff
FROM myTable t1 
  INNER JOIN 
     (SELECT DATE(`Timestamp`) ts_date,
             MIN(`Total`) AS MinVal
      FROM myTable
      GROUP BY ts_date) d1
  ON DATE(t1.`Timestamp`) = d1.ts_date 
```

# java - .delete() 的冗余使用

> ID：11835487
> 
> 赞同：0
> 
> 时间：2012-08-06T20:30:33.497
> 
> 标签：java, file-io

我正在尝试创建一种在数据收集程序中重命名日志文件的方法，但是`IOException`在访问一次后不久尝试访问日志文件时（对于第二次数据跟踪）会抛出一个（不经常）。

我不知道是因为调用了`.delete()`还是我必须确保在访问文件之前关闭文件。我真的坚持这个。这是我正在研究的方法。

```
public static void renameFile(String oldName, String newName) throws IOException
{
    File srcFile = new File(oldName).getAbsoluteFile();
    boolean bSucceeded = false;
    try 
    {
        File destFile = new File(newName).getAbsoluteFile();
        if (destFile.exists()) 
        {
            if (!destFile.delete()) 
            {
                throw new IOException(oldName + " was not successfully renamed to  " + newName + ", could not perform !destFile.delete()");                 
            }
        }
        if (!srcFile.renameTo(destFile))
        {
            throw new IOException(oldName + " was not successfully renamed to " + newName + ", could not rename source file");          
        } 
        else 
        {
            bSucceeded = true;
        }
    } 
    finally 
    {
        if (bSucceeded) 
        {
            srcFile.delete();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:35:55.663

代码看起来没问题，但正如您所提到的，您必须确保在调用此方法之前关闭文件。在 Unix 上，这可能有效，但在 Windows 上，您绝对不能重命名或删除具有打开文件描述符的文件。

# css - css中固定高度元素下的流体Div？

> ID：11835489
> 
> 赞同：0
> 
> 时间：2012-08-06T20:30:35.650
> 
> 标签：css

我想知道当固定宽度占用一定数量的窗口时，是否有一种方法可以让一个元素利用它所拥有的剩余窗口空间来伸展自己。

例如

```
 <div id ="first">
   This div will ALWAYS be fixed at 20px height
   </div>
   <div id="second">
      This div will take up 100% of the remaining space between the top div (first div that is 20px high ) and the bottom of the window. 
     </div> 
```

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:45:28.637

[这是使用固定定位](http://jsfiddle.net/Lp4Vm/)的示例：

```
html, body {
    margin:0;
    padding:0;
    height:100%;
}
#first {
    height:20px;
    background:yellow;
    position:fixed;
    top:0;
    left:0;
    right:0;
    z-index:1;
}
#second {
    padding-top:20px;
    height:100%;
    background:pink;
    -webkit-box-sizing:border-box;
    -moz-box-sizing:border-box;
    -ms-box-sizing:border-box;
    -o-box-sizing:border-box;
    box-sizing:border-box;
    overflow:auto;
} 
```

还有一个使用[相对定位](http://jsfiddle.net/Lp4Vm/1/)：

```
html, body {
    margin:0;
    padding:0;
    height:100%;
}
#first {
    height:20px;
    background:yellow;
    position:relative;
    z-index:1;
}
#second {
    margin-top:-20px;
    padding-top:20px;
    height:100%;
    background:pink;
    -webkit-box-sizing:border-box;
    -moz-box-sizing:border-box;
    -ms-box-sizing:border-box;
    -o-box-sizing:border-box;
    box-sizing:border-box;
    overflow:auto;
} 
```

两者都假设以下 HTML：

```
<div id ="first">
   This div will ALWAYS be fixed at 20px height
</div>
<div id="second">
   This div will take up 100% of the remaining space between the top div (first div that is 20px high ) and the bottom of the window.
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T20:53:06.897

如果你从[这里](http://ryanfait.com/sticky-footer/)借用粘性页脚的想法，并调整它以获得一个固定的页眉，它看起来像[这样（小提琴）](http://jsfiddle.net/xLe3T/4/)。

的HTML：

```
 <div id ="first">
   This div will ALWAYS be fixed at 20px height

</div>
   <div id="second">
       <div id="push"></div>
      This div will take up 100% of the remaining space between the top div (first div that is 20px high ) and the bottom of the window. 
     </div>​ 
```

的CSS：

```
 #first {
  height: 20px; 

}
#push {
  height: 20px; 
  background: #fcc;  
}
html, body {
    height: 100%;
}
#second {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: -20px 0;
    background: #cfc;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-06T20:43:03.630

这是你想要的吗？

[http://jsfiddle.net/xvnCd/](http://jsfiddle.net/xvnCd/)

在您的第一句话中，您说“固定宽度”，但在代码中您说的是高度，所以我不确定这是否是您要找的。

请注意，此版本将在视口底部丢失 20 像素，因此它可能适合您，也可能不适合您，具体取决于您需要如何使用它。

# java - 清理和构建后旧服务提供者仍然存在

> ID：11835490
> 
> 赞同：0
> 
> 时间：2012-08-06T20:30:43.930
> 
> 标签：java, lookup, openide

我在应用程序（不是 NetBeans 平台应用程序）中使用 org.openide.util.Lookup 作为独立库。

我到处看到它说您可以通过执行清理和构建来摆脱使用 @ServiceProvider 注释的旧类中的 META-INF/服务条目，但无论我清理/清理和构建/重新启动 NetBeans/重新启动多少次它仍然记得旧注释的计算机。我什至查看了大量的配置文件，看看它是否在某处缓存引用。

我发现可行的唯一方法是创建一个新项目，并且在向其添加 @ServiceProvider 注释后永远不要删除或重构任何类。这非常令人沮丧。

有谁知道从生成的 META-INF/services 文件中获取这些旧类引用的灵丹妙药？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T02:00:56.973

我不完全确定这就是发生在你身上的事情，但我遇到了类似的问题，删除的菜单项仍然出现在 layer.xml 中。我发现解决方案是进行干净的构建，关闭 Netbeans（假设这是您使用的 IDE），然后转到 C:\Users\my Username\AppData\Local\NetBeans\ 或其等效项，并删除 Cache 文件夹. 如果你得到它，请告诉我这是否有效。

# asp.net-mvc-3 - asp.net mvc 应用程序会话变量在 IIS 6 中为空

> ID：11835492
> 
> 赞同：1
> 
> 时间：2012-08-06T20:30:52.650
> 
> 标签：asp.net-mvc-3, iis-6, session-variables

在本地一切正常，但是当我将应用程序部署到 IIS 6 服务器时，所有会话变量都为空。

在应用程序中，我使用会话变量，例如，如下所示：

`System.Web.HttpContext.Current.Session["test"] = "test123";`

`var test = System.Web.HttpContext.Current.Session["test"];`

在我的 web.config 我有元素： `<sessionState mode="InProc" timeout="20" />`

在 IIS 的应用程序配置选项中，选中“启用会话状态”选项并将会话超时设置为 20 分钟。

有谁知道我如何为此应用程序启用会话？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:57:16.590

我能想到的最好的解释是：

1.  在您的代码中的某处有一个`Session.Abandon()`或`Session.Clear()`

2.  在您的应用程序中抛出了一个相当严重的异常，该异常正在杀死应用程序域并取消与它的会话。检查您的 Windows 事件日志（应用程序和系统）以查看是否有任何未处理的工作进程或 ASP.NET 异常被抛出。

3.  您的应用程序的应用程序池设置已被修改，可能会导致池比预期更快地回收。

4.  您在破坏会话 cookie 的服务器前面有一个负载平衡器或某种代理。或者，如果您的设置是负载平衡环境，则未在负载平衡器上配置粘性会话。

尝试使用进程外会话管理器，例如 SQL 状态管理器：

> [http://msdn.microsoft.com/en-us/library/ms229862(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms229862%28v=vs.100%29.aspx)
> 
> [http://msdn.microsoft.com/en-us/library/ms178581](http://msdn.microsoft.com/en-us/library/ms178581)

# c# - 如何“逐页”将 Excel 工作簿保存或导出为 PDF 文件？

> ID：11835494
> 
> 赞同：2
> 
> 时间：2012-08-06T20:31:05.823
> 
> 标签：c#, .net, excel, excel-interop, worksheet

我的代码的问题是它要么保存工作簿中所有工作表中的所有页面，要么只保存“from”和“to”参数指定的范围内的页面。

我正在使用的 excel 文件有 7 个工作表，每个工作表可以有任意数量的页面。例如，如果我指定要导出“从 1 到 4”，则只有第一个工作表的前 4 页将导出为 PDF 文档，而不是前 4 个工作表的所有页面。

有人可以告诉我如何实现我想要做的事情吗？下面的代码不是我想要的：

```
application.ActiveWorkbook.ExportAsFixedFormat(
      Microsoft.Office.Interop.Excel.XlFixedFormatType.xlTypePDF,
      path,
      Excel.XlFixedFormatQuality.xlQualityStandard,
      true,
      true,
      1,
      4,
      false,
      Missing.Value); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T22:41:37.150

如果您`ActiveSheet.ExportAsFixedFormat`在选择多张纸后使用，我认为它会做您想要的（只要您的打印区域设置在每张选定的纸上）。

沿着这些线的原始记录宏：

```
 Sheets(Array("Sheet1", "Sheet2")).Select

    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
    "C:\Documents and Settings\yourusername\Desktop\Book1.pdf", _  
    Quality:=xlQualityStandard, _
    IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= False 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T18:45:58.903

这是答案：ActiveSheet.PageSetup.Pages.Count

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-06T20:40:26.877

```
Public Sub Export(ParamArray ToPrint() As Variant)

'hide all sheets
For Each Sheet In ActiveWorkbook.Sheets

    Sheet.Hide

Next Sheet

'unhide sheets to print
For Each pageNo In ToPrint

ActiveWorkbook.Sheets(pageNo).Show

Next pageNo

'do the export
    Worksheet.ExportAsFixedFormat _
        Microsoft.Office.Interop.Excel.XlFixedFormatType.xlTypePDF, _
        Path, _
        Excel.XlFixedFormatQuality.xlQualityStandard, _
        True, _
        True, _
        Nothing, _
        Nothing, _
        False, _
        Missing.Value

'unhide all sheets
For Each Sheet In ActiveWorkbook.Sheets

    Sheet.Show

Next Sheet 
```

结束子

通过传入逗号分隔的要导出的工作表列表来调用它

```
Export 1, 2, 4 
```

# nstextview - NSTextView 未将属性应用于新插入的文本

> ID：11835497
> 
> 赞同：1
> 
> 时间：2012-08-06T20:31:13.277
> 
> 标签：nstextview, nsattributedstring

我有一个`NSTExtView`并且正在为某些范围的文本设置属性，使用`[theTextView.textStorage addAttribute: value: range:]`

例如，我使用突出显示一个范围`[theTextView.textStorage addAttribute:NSBackgroundColorAttributeName value:[NSColor yellowColor] range:theSelectedRange];`

问题是当我在该范围内手动键入新文本时，它没有突出显示。它将突出显示的范围分成 2 个范围，并在它们之间插入非突出显示的文本。有没有办法使新插入的文本也被突出显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T21:09:10.347

当用户在您的 NSTextView 中键入新内容时，插入点将使用与当前字体相关联的任何属性（如果有）。这也称为文本视图的“typingAttributes”。在大多数情况下，用户将使用黑色和白色背景进行打字。

现在，由于您正在突出显示（而不是进行选择），您需要做的是在光标的插入点处选取当前颜色。

您可以通过以下方式获取属性：

```
// I think... but am not 100% certain... the selected range
// is the same as the insertion point.
NSArray * selectedRanges = [theTextView selectedranges];
if(selectedRanges && ([selectedRanges count] > 0))
{
    NSValue * firstSelectionRangeValue = [selectedRanges objectAtIndex: 0];
    if(firstSelectionRangeValue)
    {
        NSRange firstCharacterOfSelectedRange = [firstSelectionRangeValue rangeValue];

        // now that we know where the insertion point is likely to be, let's get
        // the attributes of our text
        NSSDictionary * attributesDictionary = [theTextView.textStorage attributesAtIndex: firstCharacterOfSelectedRange.location effectiveRange: NULL];

        // set these attributes to what is being typed
        [theTextView setTypingAttributes: attributesDictionary];

        // DON'T FORGET to reset these attributes when your selection changes, otherwise
        // your highlighting will appear anywhere and everywhere the user types.
    }
} 
```

我根本没有测试或尝试过这段代码，但这应该能让你到达你需要的地方。

# python - Matplotlib 日期索引格式

> ID：11835500
> 
> 赞同：2
> 
> 时间：2012-08-06T20:31:30.387
> 
> 标签：python, matplotlib

我正在使用 matplotlib 绘制一些财务数据。但是，在其默认配置中，matplotlib 会插入空白来代替丢失的数据。该文档建议使用[日期索引格式化程序](http://matplotlib.sourceforge.net/examples/api/date_index_formatter.html)来解决此问题。

但是，可以在页面上提供的示例中看到：

*   格式已从“2008 年 9 月 3 日”=>“2008-09-03”更改
*   图表不再以最终样本结束，而是填充到“2008-10-14”。

如何在保留此默认行为的同时仍避免数据中的空白？

**编辑**

来自文档的示例代码，顶部带有所需的刻度。

```
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.mlab as mlab
import matplotlib.cbook as cbook
import matplotlib.ticker as ticker

datafile = cbook.get_sample_data('aapl.csv', asfileobj=False)
print 'loading', datafile
r = mlab.csv2rec(datafile)

r.sort()
r = r[-30:]  # get the last 30 days

# first we'll do it the default way, with gaps on weekends
fig = plt.figure()
ax = fig.add_subplot(111)
ax.plot(r.date, r.adj_close, 'o-')
fig.autofmt_xdate()

# next we'll write a custom formatter
N = len(r)
ind = np.arange(N)  # the evenly spaced plot indices

def format_date(x, pos=None):
    thisind = np.clip(int(x+0.5), 0, N-1)
    return r.date[thisind].strftime('%Y-%m-%d')

fig = plt.figure()
ax = fig.add_subplot(111)
ax.plot(ind, r.adj_close, 'o-')
ax.xaxis.set_major_formatter(ticker.FuncFormatter(format_date))
fig.autofmt_xdate()

plt.show() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:45:27.217

好吧，我将回答简单的部分：获取`Sept 03 2008`而不是`2008-09-03`使用`strftime('%b %d %Y')`：

```
def format_date(x, pos=None):
    thisind = np.clip(int(x+0.5), 0, N-1)
    result = r.date[thisind].strftime('%b %d %Y')
    return result 
```

PS。中的最后一个日期`r.date`是`Oct 14 2008`，所以我认为为其添加一个刻度线并不是一件坏事。你确定你不想要吗？

# eclipse - Eclipse 自己将 java 文件恢复到更旧的版本？

> ID：11835510
> 
> 赞同：1
> 
> 时间：2012-08-06T20:32:35.270
> 
> 标签：eclipse

我不知道这是怎么发生的，但是在重构变量名（最终的静态 int）之后，该文件显示了同一文件的更早版本，**无法恢复我投入的所有工作时间**。

这对我来说似乎是一个错误或......“未记录的功能”（即不幸的组合键，即使存储在文件中也会删除数小时的工作）？

有没有人经历过这个？

这是 Eclipse 众所周知的行为吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T13:56:32.740

### 从地方历史中恢复工作

尝试使用 Eclipse 的“本地历史”功能恢复丢失的工作。

右键单击一个文件，然后单击`Compare With -> Local History...`如下：

![地方历史](../Images/bf2a535638e908e40081826522fceb88.png)

一旦你这样做了，你应该会看到一个带有时间戳条目的历史视图，如下所示：

![在此处输入图像描述](../Images/2c866744fa7631c0228997ca271f4de5.png)

双击这些应该允许您转到文件的特定版本。如果您在世界末日重构之前进入带时间戳的条目，您应该能够恢复您的工作。

有关更多详细信息，请参阅**[此](http://help.eclipse.org/juno/index.jsp?topic=/org.eclipse.platform.doc.user/gettingStarted/qs-55.htm)**Eclipse 帮助页面。

### 本地历史偏好

此功能对于恢复原本会丢失的工作非常有用。为了增加每个文件的历史记录量 ( `Maximum Entries per file`) 和此历史记录的寿命 ( `Days to keep Files`)，请尝试通过以下方式增加默认值`Preferences -> Workspace -> Local History`：

![在此处输入图像描述](../Images/1c1222a2fc22faa510ad364881c51b62.png)

# c# - 获取没有 Child 的 XElements 的值

> ID：11835512
> 
> 赞同：0
> 
> 时间：2012-08-06T20:32:39.187
> 
> 标签：c#, linq

当没有更多孩子时，如何获得 a 的值`Node`？`XDocument`

```
<Contacts>
      <Company>
          <Name>Testing</Name>
          <ID>123</ID>
      </Company>
</Contacts> 
```

在这种情况下，我想获取`<Name>`and`<ID>`元素的值，因为其中没有子元素。

我正在尝试以下

```
protected void LeXMLNode(HttpPostedFile file)
{
    XmlReader rdr = XmlReader.Create(file.FileName);            
    XDocument doc2 = XDocument.Load(rdr);            

    foreach (var name in doc2.Root.DescendantNodes().OfType<XElement>().Select(x => x.Name).Distinct())
    {
        XElement Contact = (from xml2 in doc2.Descendants(name.ToString())                                    
                            where xml2.Descendants(name.ToString()).Count() == 0
                            select xml2).FirstOrDefault();

        string nome = name.ToString();
    }           
} 
```

但没有成功，因为我的 foreach 全部通过`Elements`，我只想获得`Elements`没有孩子的价值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:42:55.323

```
document.Root.Elements("Company").Elements()
                .Where(item => !item.HasElements).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:41:04.697

请参阅：http `XElement.HasElements`: [//msdn.microsoft.com/en-us/library/system.xml.linq.xelement.haselements.aspx](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.haselements.aspx)

# ios - 初学者使用标签栏和 SelectedIndex？

> ID：11835517
> 
> 赞同：1
> 
> 时间：2012-08-06T20:32:52.820
> 
> 标签：ios, tabs, uitabbarcontroller, selectedindex

我已经在 IB 中 100% 构建了一个应用程序，而无需编码。我的编码背景很少，所以请回答。:)

我需要一种方法让按钮（位于我的标签栏控制器之外）将我带到我的标签栏控制器中的特定标签。当我只是在 IB 中做一个模态链接时，它会带我到那里，但底部的标签栏控制器不见了。

我该怎么做？（带有示例的具体细节将不胜感激）

下面回答：

我自己想出来的......对于那些可能正在寻找类似解决方案的人......

我所做的只是在我的初始视图控制器中创建一个名为 globalVariable 的全局变量。

```
//myview.h
#ifndef Globals_h
#define Globals_h

extern NSInteger globalVariable;

#endif 
```

使用模式推送到我的标签栏控制器的四个按钮填充该视图。这些按钮中的每一个都有一个更改 globalVariable 值的操作。

```
//myview.m
- (IBAction)button1Action:(id)sender {
    globalVariable = 0;
}
- (IBAction)button2Action:(id)sender {
    globalVariable = 1;
}
//etc etc 
```

然后在标签栏控制器中，只需将您的 selectedIndex 设置为 viewDidLoad 中的 globalVariable

```
//tabbarcontroller.m
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.selectedIndex = globalVariable;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T05:27:56.873

我自己想出来的......对于那些可能正在寻找类似解决方案的人......

我所做的只是在我的初始视图控制器中创建一个名为 globalVariable 的全局变量。

```
//myview.h
#ifndef Globals_h
#define Globals_h

extern NSInteger globalVariable;

#endif 
```

使用模式推送到我的标签栏控制器的四个按钮填充该视图。这些按钮中的每一个都有一个更改 globalVariable 值的操作。

```
//myview.m
- (IBAction)button1Action:(id)sender {
    globalVariable = 0;
}
- (IBAction)button2Action:(id)sender {
    globalVariable = 1;
}
//etc etc 
```

然后在标签栏控制器中，只需将您的 selectedIndex 设置为 viewDidLoad 中的 globalVariable

```
//tabbarcontroller.m
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.selectedIndex = globalVariable;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T03:17:55.303

让 IB 为您的按钮设置修饰操作

在该方法中，您希望访问作为当前控制器父级的标签栏控制器

```
UITabBarController tbc = (UITabBarController) [self parentviewcontroller];
tbc.selectedIndex = 2;  //or whatever the index you need 
```

# c++ - Visual Studio 2010 外部工具转到位置

> ID：11835525
> 
> 赞同：1
> 
> 时间：2012-08-06T20:33:38.283
> 
> 标签：c++, visual-studio-2010

我为自己创建了一个自定义外部工具，使用 Vera++ 进行代码格式化。我通过外部工具选项让它在 Visual Studio 2010 中工作。我目前将 Vera++ 的所有输出都转到 VS2010 的输出窗口。我的问题是，有什么方法可以设置我的输出，以便 Visual Studio 让我双击一行，它会带我到行号？

# c# - Linq 表达式：使用通用 DbSet 创建最大查询

> ID：11835526
> 
> 赞同：2
> 
> 时间：2012-08-06T20:33:41.610
> 
> 标签：c#, entity-framework, lambda, generic-programming, dbset

为了简化为单元测试创​​建假数据，我想要一个可以创建通用实体的函数（我将其用作许多其他类的基础对象）。该实体有一个索引，为了生成一个新索引，我想简单地找到当前最高的数字并加一个。

我将 Index 用于许多其他类，并希望使此功能尽可能通用。*我的问题是我不知道如何在我的通用函数中指定要使用的 DbSet* `GetMaxID`。

这是我到目前为止得到的：

```
private Entity CreateGenericEntity()
{
    return new Entity()
    {
        Guid = Guid.NewGuid(),
        Index = GetMaxID<Entity>(x => x.Index) + 1,
    };
}

private int GetMaxID<TEntity>(Expression<Func<TEntity, int>> expression)
{
    return _repository.Set<TEntity>().Max(expression);
} 
```

`_repository`有一堆不同的 IDbSets 属性，比如

```
public IDbSet<Customers> Customers{ get; set; }

public IDbSet<Orders> Orders{ get; set; } 
```

等等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T20:14:19.633

我发现我错过了 TEntity 的声明，这是通过附加`where TEntity : class`到我的函数来修复的。`int?`为了处理查询返回空值的情况，我还必须将表达式更改为接受。完整的功能是这样的（如果有人感兴趣的话）

```
private int GetMaxID<TEntity>(Expression<Func<TEntity, int?>> expression) where TEntity : class
{
    return _repository.Set<TEntity>().Max(expression) ?? 0;
} 
```

# javascript - 返回没有名称的 JSON 对象

> ID：11835528
> 
> 赞同：2
> 
> 时间：2012-08-06T20:33:49.423
> 
> 标签：javascript, jquery, json

我从服务器返回以下 JSON

```
{
    "someStuff": {
        "": {
            "foo": 0
        },
        "moreStuff": {
            "foo": 2
        }
    }
} 
```

如您所见， someStuff 中的第一个节点未命名。

有没有办法处理这个是JavaScript，例如，我怎样才能选择一个没有名字的节点？

我知道正确的解决方案是在生成 JSON 的代码中命名节点，但我正在寻找一个肮脏的修复方法，直到我可以联系开发人员:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-06T20:35:54.477

`.foo`与 相同`["foo"]`，因此`[]`只要名称不是标识符就使用。

```
myObjectFromJSON.someStuff[""].foo 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T20:36:20.133

试试这个：

```
data.someStuff[''].foo 
```

[http://jsfiddle.net/GSWg9/](http://jsfiddle.net/GSWg9/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T20:38:03.970

```
$(function(){

  var data={ "someStuff": {
                             "": { "foo": 0 },
                             "moreStuff": {"foo": 2 }
                           }
           }

    $.each(data.someStuff,function(index,item){

         alert(item.foo);
    });

}); 
```

示例：http: [//jsfiddle.net/kshyju/hURDH/4/](http://jsfiddle.net/kshyju/hURDH/4/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T20:43:28.517

诀窍是使用 [] 运算符，如下例所示：

```
a = $.parseJSON('\
    {\
        "someStuff": {\
            "": {\
                "foo": 0\
            },\
            "moreStuff": {\
                "foo": 2\
            }\
        }\
    }\
');
a.someStuff[''].foo === 0  // returns true 
```

# c++ - 基于布尔值更新 GUI

> ID：11835533
> 
> 赞同：0
> 
> 时间：2012-08-06T20:34:02.937
> 
> 标签：c++, visual-studio-2008, c++-cli

尝试根据我的程序中布尔值的状态使某些按钮/文本字段变灰。布尔值会跟踪与子系统的连接是否仍在运行。初始化为 false 直到它连接，然后看门狗从那里保持更新。

这可能通过程序的执行多次发生，因此我想制作某种监视器，它只监视布尔值的状态并适当地更新 GUI/按钮属性。

我最初的想法是为此创建某种事件处理程序，但在我的搜索中，我在 C# 中发现了一些称为“属性”的东西，这可能会使这变得更加容易。不幸的是，我无法找到有关此技术的大量信息（此处的初始线程：[How to trigger event when a variable's value is changed?](https://stackoverflow.com/questions/5842339/how-to-trigger-event-when-a-variables-value-is-changed)）

所以我来找你们，希望你们能给我一个关于最好的方法的想法。

谢谢，

编辑:: 不确定是否重要，但布尔值被声明为外部。这可能会使事情变得更容易，因为我注意到在许多情况下在类之间进行通信时使用观察者模式，这不是这个问题的关注点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:41:08.567

C# 属性只是为获取/设置对象中的变量提供专门的语法。由于它们只是专门的方法，因此您可以真正添加您想要的任何其他功能。根据您的描述，我可能会建议使用侦听器...动作侦听器使用称为“观察者”的模式，这完全符合您在这种情况下尝试执行的操作。你可以谷歌“观察者模式”，你会得到更多关于如何使用它的信息，并创建你自己的变体，你可能会或可能不会决定这样做:)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:44:59.173

让我给你一个简单的例子：

```
button1.IsEnabled = false; 
```

要禁用按钮或文本字段，您只需这样做。

# javascript - 在插入的 HTML 中调用带有参数的 Javascript 函数

> ID：11835536
> 
> 赞同：0
> 
> 时间：2012-08-06T20:34:15.370
> 
> 标签：javascript, function, insert

好的，所以我有一个变量、一个函数和一个无序列表。我运行这段代码：

```
var someid = '501bc5210642741838000000';
var liststring = '<li class="ui-state-default" id="'+someid+'">'+
                 '<button type="button" class="del" onclick="newfunction('+someid+');" >X</button>Slide</li>';
$('ul').append(liststring); 
```

对于 someid 的不同值，此代码重复多次。

函数 newfunction() 如下所示：

```
var newfunction = function(someid){
$('#'+someid).remove();
//some other stuff; the above is the important bit
} 
```

这应该使得当单击按钮时，它将 someid 传递给 newfunction()，该函数具有 jQuery 代码，可从 DOM 中删除包含该按钮的列表元素。

搞砸的一点是我将列表元素等包含在一个字符串中以将其附加到列表 HTML 中。我验证了代码是否可以正常工作——我手动编写了两个列表元素，它运行得很好。我可能缺少一些语法 - 我缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:37:50.643

尝试在变量周围添加引号，使其打印为字符串而不是变量名。

```
'<button type="button" class="del" onclick="newfunction(\''+someid+'\');" >X</button>Slide</li>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T20:38:53.090

尝试将 someid 放在引号中，例如

```
onclick="newfunction(\'' + someid + '\');" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T20:38:24.713

您应该能够只使用`live`- 方法：

```
$(function() {
    $('li.ui-state-default').live('click', function() {
        $(this).remove();
    });
}); 
```

请注意，较新版本的 jQuery 已弃用此功能，它使用 now `on`。

更多信息[在这里](http://api.jquery.com/live/)。

lg,

弗洛

# php - 如何在保存之前更改 Symfony 表单数组值？

> ID：11835537
> 
> 赞同：1
> 
> 时间：2012-08-06T20:34:21.030
> 
> 标签：php, symfony1, symfony-1.4

我有一个表单，提交后，我可以使用以下方式查看表单值：`var_dump($this->form->getValues();`。我的表单值之一（来自多选小部件）是这样的：

```
["cat_list"]=>
  array(1) {
    [0]=>
    string(1) "1"
  } 
```

我希望在保存表单之前向该数组附加一个值。我该怎么做呢？我以为我可以这样做：

```
$values = $this->form->getValues();
array_push($values['cat_list'], '99'); // <--- 99 is the number I want to append
$this->form->setCatList($values['cat_list']);
$this->form->save(); 
```

但这不起作用：

`Call to undefined method FrontendOfferForm::setCatList.`

有什么线索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-11T21:35:02.437

在验证之前初始化表单的操作中（通常在创建或更新函数中），只需将一个空对象传递给表单，该对象的值已设置为任意要添加的值。

让我们将您的表单称为 myModelForm 并将您的模型称为 myModel。

在动作中（在 processForm 之前）

```
$obj = new myModel();
$obj->setCatList(array(99));
$this->form = new myModelForm($obj); 
```

这应该工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:49:20.353

您应该`doUpdateObject`以 cals 的形式覆盖函数。

```
protected function doUpdateObject($values)
{
  parent::doUpdateObject($values);

  if (isset($values['cat_list']))
  {
    $carList = is_array($values['cat_list']) ? $values['cat_list'] : array($values['cat_list']);
    array_push($catList, 99);
    $this->getObject()->setCatList($catList)
  }
} 
```

就是这样。你应该只`$this->form->save()`在行动中打电话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T07:25:30.333

除了@1ed 的方法，您应该有其他方法。

保存表单时，它会返回对象。因此，您必须先保存表单，然后更新`cat_list`：

```
$values = $this->form->getValues();
$object = $this->form->save();

array_push($values['cat_list'], '99'); // <--- 99 is the number I want to append
$object->setCatList($values['cat_list']);
$object->save(); 
```

`99`顺便说一句，如果您从@1ed 中选择解决方案，您应该使用外部参数来定义您的`99`.

喜欢：

```
$this->form->catListExtraValue = 99;
$this->form->save(); 
```

然后：

```
public $catListExtraValue = null;

protected function doUpdateObject($values)
{
  parent::doUpdateObject($values);

  if (isset($values['cat_list']) && null !== $this->catListExtraValue)
  {
    $carList = is_array($values['cat_list']) ? $values['cat_list'] : array($values['cat_list']);
    array_push($catList, $this->catListExtraValue);
    $this->getObject()->setCatList($catList)
  }
} 
```

# javascript - 我需要在点击时运行两个函数。即使嵌套在一起，我也无法让它们同时工作

> ID：11835540
> 
> 赞同：6
> 
> 时间：2012-08-06T20:34:29.580
> 
> 标签：javascript, validation, function, onclick, delay

HTML 是：

```
<input name="submit"
       type="submit"
       class="button"
       value="Click Here"
       tabindex="13"
       onclick="return ValidateForm();" /> 
```

ValidateForm() 函数具有所有常用的表单验证代码。我无法运行的另一个功能（除了它本身它工作正常..example

```
<input name="submit"
       type="submit"
       class="button"
       value="Click Here"
       tabindex="13"
       onclick="disDelay(this);" /> 
```

我尝试将它们都放在 onclick ...示例之后

```
<input name="submit"
       type="submit"
       class="button"
       value="Click Here"
       tabindex="13"
       onclick="return ValidateForm(); disDelay(this);" /> 
```

我还尝试将代码放在同一个函数中，但没有成功。

函数 disDelay() 是

```
function disDelay(obj){
    obj.setAttribute('disabled','disabled');
    setTimeout(function(){obj.removeAttribute('disabled')},10000);
} 
```

它被用作延迟，以防止表单从多次点击中获得重复提交。现在延迟为 10 秒，仅用于测试目的。我需要验证和延迟才能一起工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T20:41:14.380

返回第一个函数的值会终止单击处理程序。从本质上讲，这就是您尝试合并时所做的事情：

```
<input name="submit" type="submit" class="button" 
       value="Click Here" tabindex="13" 
       onclick="return submit_Click(this);" />

<script type="text/javascript">
    function submit_Click(sender) {
        return ValidateForm(); 
        disDelay(sender); // !!! This call is unreachable !!!
    }
</script> 
```

这是纠正它的一个简单选项：

```
<input name="submit" type="submit" class="button" 
       value="Click Here" tabindex="13" 
       onclick="return submit_Click(this);" />

<script type="text/javascript">
    function submit_Click(sender) {
        var r = ValidateForm(); 
        disDelay(sender); // It seems like you would only want to call this
                          // function if the form is validate, so there should
                          // probably be an if-statement surrounding it. However,
                          // I'll leave that up to you.
        return r;
    }
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T20:42:17.740

You almost had it, just reverse the order of the function calls.

```
<input name="submit" type="submit" class="button" value="Click Here" tabindex="13" onclick="disDelay(this); return ValidateForm(); " /> 
```

The return from ValidateForm is going to cause the rest of the code to be unreachable so it must be last.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T20:43:53.917

In your onclick string the disDelay(this) is not getting called because you return the response from ValidateForm(), so the second statement never executes.

If you absolutely must use the onclick attribute inside the html, try:

```
<input name="submit" type="submit" class="button" value="Click Here" tabindex="13" onclick="disDelay(); return ValidateForm();" /> 
```

# mysql - 运行“rake db:migrate”时出现 MySQL 错误

> ID：11835541
> 
> 赞同：0
> 
> 时间：2012-08-06T20:34:32.187
> 
> 标签：mysql, ruby-on-rails, ruby, rake

有人对如何解决此错误有任何建议吗？

```
Tipsy:todoodly admin$ rake db:migrate
rake aborted!
dlopen(/Users/admin/.rvm/gems/ruby-1.9.3-p125/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle, 9): Library not loaded: /usr/local/lib/libmysqlclient.18.dylib
  Referenced from: /Users/admin/.rvm/gems/ruby-1.9.3-p125/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle
  Reason: no suitable image found.  Did find:
    /usr/lib/libmysqlclient.18.dylib: mach-o, but wrong architecture - /Users/admin/.rvm/gems/ruby-1.9.3-p125/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle

(See full trace by running task with --trace) 
```

我尝试使用 .dmg 文件重新安装 MySQL，但仍然遇到问题。

上网后也试过了，还是不行

```
sudo install_name_tool -change libmysqlclient.16.dylib /usr/local/mysql/lib/libmysqlclient.16.dylib ~/.rvm/gems/ruby-1.9.3-p125/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:46:32.747

不确定它是否会起作用，但将其粘贴到终端中：

```
export DYLD_LIBRARY_PATH=”$DYLD_LIBRARY_PATH:/usr/local/mysql/lib/” 
```

# php - 有没有办法从 Lotus Notes 访问 MySQL 和/或 PHP 页面？

> ID：11835544
> 
> 赞同：0
> 
> 时间：2012-08-06T20:34:50.717
> 
> 标签：php, mysql, lotus-notes, lotus-domino

我在 LAMP 服务器上提供了一个完整的互联网应用程序，我可以完全访问（root）所有服务器设置和网页文件。不幸的是，由于政策的原因，它不能在公司以外的地方访问。

但是，我们将 Lotus Notes 用于电子邮件/数据库系统，它可以从任何有 Internet 连接的地方完全访问。所有用户都安装了 Notes 客户端，并且交互可以是一种方式（MySQL --> Domino Server）。管理层无需担心通过 Lotus Notes 进行的访问或安全性。

有没有办法让笔记访问我的 LAMP 服务器，或者提供网页和文件，或者开发一个快速界面来访问 MySQL 数据库？

我假设 Domino 服务器可以通过 ODBC 访问 MySQL，但我不确定从这里去哪里。

提前感谢您的任何帮助或指导！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T15:18:44.527

由于您有旧的 Notes 客户端，因此 IBM 最新的 XPages 技术是不可能的——除非您的 Domino 服务器已经为 HTTP 开放，在这种情况下，您可以使用 Domino 上的 XPages 从 MySQL 获取信息并将其提供给浏览器。这将是最新的技术方向。

但总的来说，答案是肯定的，Domino 服务器可以通过多种方式访问​​ MySQL 数据，如果您不需要使用所有最新的玩具，可以使用一些旧的备用工具来完成工作。有一个名为 Domino Enterprise Connection Services 或 DECS 的 IBM 解决方案，它执行 Notes 数据库和关系数据库之间的实时映射。[您可以在此处](https://www.ibm.com/developerworks/lotus/documentation/decs/)找到有关它的信息。另一个名为 Lotus Enterprise Integrator 或 LEI 的 IBM 解决方案专为 Notes 数据库和关系数据库之间的批量传输操作而设计。[您可以在此处](https://www.ibm.com/developerworks/lotus/documentation/lei/)找到有关它的信息。您还可以将 Lotus 公式语言中的 @DbLookup 函数或 LotusScript 代码中的 LCLSX（LotusScript 连接器扩展）用于 Notes 数据库中的事件或代理。

# jquery - 使用jquery清除span的内部html

> ID：11835546
> 
> 赞同：1
> 
> 时间：2012-08-06T20:35:02.437
> 
> 标签：jquery

我正在使用下面的代码来比较通过和确认密码文本字段。它工作正常，但问题是如果输入不匹配的密码，它会显示错误“密码不匹配”，然后如果我匹配密码，它会在旧错误旁边显示“密码匹配”。所以它的显示就像'密码不匹配密码匹配'（请参阅图片以供参考..[***错误图片***](http://i.imgur.com/NBR7z.jpg)

. 如何在显示消息之前清除跨度。

```
 $(confPassword).live('blur', function() {
    alert(password.value);
    if (password.value != 'Password') {
        alert("hi");
        if (password.value == confPassword.value) {
            alert("match");
            setupConfirmControl(confPassword, astConfPassword, lblConfPassword, true);
        }
        else {
            alert("dont match");
            setupConfirmControl(confPassword, astConfPassword, lblConfPassword, false);
        }
    }
});

function setupConfirmControl(elemObj, id, labelTxt, addToParent) {
    var ConfirmPass = document.createElement('span');
    ConfirmPass.setAttribute('class', 'ClsConfirmPass');
    ConfirmPass.setAttribute('id', 'span' + id);
    ConfirmPass.innerHTML = '';
    if (addToParent) {
        ConfirmPass.innerHTML = 'Passwords match';
        elemObj.parentNode.insertBefore(ConfirmPass, elemObj);
    }
    else {
        ConfirmPass.innerHTML = 'Passwords do not match';
        elemObj.parentNode.insertBefore(ConfirmPass, elemObj);
    }
    showConfirmPassWord(id);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:39:31.217

问题是您每次都在函数中创建一个*新的，只需检查一个跨度是否存在，如果存在，则使用该跨度：* `span`

```
function setupConfirmControl(elemObj, id, labelTxt, addToParent) {
    var ConfirmPass = document.getElementById('span' + id);
    if (!ConfirmPass){
        ConfirmPass = document.createElement('span');
        ConfirmPass.setAttribute('class', 'ClsConfirmPass');
        ConfirmPass.setAttribute('id', 'span' + id);
        ConfirmPass.innerHTML = '';
    }

    if (addToParent) {
        ConfirmPass.innerHTML = 'Passwords match';
        elemObj.parentNode.insertBefore(ConfirmPass, elemObj);
    }
    else {
        ConfirmPass.innerHTML = 'Passwords do not match';
        elemObj.parentNode.insertBefore(ConfirmPass, elemObj);
    }
    showConfirmPassWord(id);
} 
```

这有效地分配了先前创建的`span`元素（`id`等于`'span' + id`，假设它们对于同一字段的错误消息是常量）。然后，如果`id`文档中没有该元素（`!ConfirmPass`），则创建该元素。

这样，任何先前写入的内容`span`都将通过设置`innerHTML`.

# asp.net-mvc - TDD：在 ASP.NET MVC 3 中测试 DataAnnotations 的最佳实践是什么？

> ID：11835561
> 
> 赞同：16
> 
> 时间：2012-08-06T20:36:47.230
> 
> 标签：asp.net-mvc, unit-testing, tdd, data-annotations

我正在参与一个使用 ASP.NET MVC 3 和 DataAnnotations 的项目。我们在 ViewModels 类中有 DataAnnotations。

你如何为这些验证编写单元测试？

视图模型示例：

```
public class AchievementVM
{
    [Required(ErrorMessage = "The title field is required.")]
    [StringLength(100, ErrorMessage = "Title must be 100 characters or less.")]
    public string Title { get; set; }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-16T18:40:23.063

.NET 框架带有一个[Validator](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.validator.aspx)类，它可以单独运行您的验证逻辑。要测试的代码可能如下所示：

```
var achievement = new AchievementVM();
var context = new ValidationContext(achievement, 
    serviceProvider: null, items: null);
var results = new List<ValidationResult>();

var isValid = Validator.TryValidateObject(achievement, context, results, true);

Assert.IsTrue(results.Any(vr => vr.ErrorMessage == "The title field is required."));

achievement.Title = "Really really long title that violates "
    + "the range constraint and should not be accepted as "
    + "valid input if this has been done correctly.";

Validator.TryValidateObject(achievement, context, results, true);

Assert.IsTrue(results.Any(vr => vr.ErrorMessage == "Title must be 100 characters or less.")); 
```

无需自定义实用程序来搜索属性的存在。Validator 类为您完成工作并填充与 MVC 基础结构相同的 ValidationResult 集合。

可以在[K. Scott Allen 的博客](http://odetocode.com/Blogs/scott/archive/2011/06/29/manual-validation-with-data-annotations.aspx)上找到有关此方法的优秀文章。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T00:04:56.830

由于这些注释是非常声明性的，编写单元测试几乎没有意义，它只是检查（通过反射）方法是否被注释 - 测试只是复制生产代码。这仍然会留下注释没有按照框架期望的方式使用的可能性（可能它们是错误的注释，它们位于错误的位置，或者它们缺少一些额外的配置）。

因此，有意义的测试不是单元测试，而是确保系统正确检测注释的集成测试。为了保持速度合理，尝试通过实例化尽可能少的框架（这需要对框架有深入的了解 - [RTFS](http://catb.org/jargon/html/R/RTFS.html)），使这些集成测试尽可能集中。如果不出意外，端到端测试可以通过解析 HTML 并检查在字段中输入无效数据时是否显示验证错误来检查注释的正确使用。

应该只需要编写几个集成/端到端测试来确保已启用验证。当它们都以相同的方式工作时，不需要测试每个字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T23:42:04.740

请参阅此处：[单元测试 ASP.NET DataAnnotations 验证](https://stackoverflow.com/questions/2167811/unit-testing-asp-net-dataannotations-validation)

此外，您可以使用反射来查看类的属性是否具有任何必要的属性。

# c# - Windows Phone 应用程序中的 XamlParseException

> ID：11835566
> 
> 赞同：0
> 
> 时间：2012-08-06T20:37:02.577
> 
> 标签：c#, .net, windows-phone-7

我正在尝试创建我的第一个 Windows 手机应用程序，但我不断收到这个“XamlParseException”。看起来错误来自 InitializeComponent() 方法，这令人震惊，因为它是由 VS 自动创建的。

这是例外：

XamlParseException 未能分配给属性“System.Windows.FrameworkElement.Loaded”。[行：14 位置：39]

这是后面的代码：

```
namespace WinHomeWork1
{
    public partial class MainPage : PhoneApplicationPage
    {
        // Constructor
        public MainPage()
        {
           InitializeComponent();
        }

        private void PhoneApplicationPage_Loaded(object sender, TextChangedEventArgs e)
        {
            myTextBox.Focus();
        }

        private void ClickMe_Click(object sender, RoutedEventArgs e)
        {
            if (myTextBox.Text.CompareTo("1 2 3 4") == 0)
            {
                myTextBlock.Text = "You have won!";
            }
            else
                myTextBlock.Text = "You have Lost";
        }
}
} 
```

这是 Xaml 代码：

```
<phone:PhoneApplicationPage 
    x:Class="WinHomeWork1.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d" d:DesignWidth="480" d:DesignHeight="768"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    SupportedOrientations="Portrait" Orientation="Portrait"
    shell:SystemTray.IsVisible="True" Loaded="PhoneApplicationPage_Loaded">

    <!--LayoutRoot is the root grid where all page content is placed-->
    <Grid x:Name="LayoutRoot" Background="Transparent">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!--TitlePanel contains the name of the application and page title-->
        <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="12,17,0,28">
            <TextBlock x:Name="ApplicationTitle" Text="Brahman Initiative" Style="{StaticResource PhoneTextNormalStyle}"/>
            <TextBlock x:Name="PageTitle" Text="108 mintes" Margin="9,-7,0,0" Style="{StaticResource PhoneTextTitle1Style}"/>
        </StackPanel>

        <!--ContentPanel - place additional content here-->
        <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
            <TextBox Height="72" HorizontalAlignment="Left" Margin="0,6,0,0" Name="myTextBox" Text="" VerticalAlignment="Top" Width="460" />
            <Button Content="Go" Height="74" HorizontalAlignment="Left" Margin="234,88,0,0" Name="ClickMe" VerticalAlignment="Top" Width="222" Click="ClickMe_Click" />
            <TextBlock Height="68" HorizontalAlignment="Left" Margin="12,88,0,0" Name="myTextBlock" Text="" VerticalAlignment="Top" Width="200" />
        </Grid>
    </Grid>

    <!--Sample code showing usage of ApplicationBar-->
    <!--<phone:PhoneApplicationPage.ApplicationBar>
        <shell:ApplicationBar IsVisible="True" IsMenuEnabled="True">
            <shell:ApplicationBarIconButton IconUri="/Images/appbar_button1.png" Text="Button 1"/>
            <shell:ApplicationBarIconButton IconUri="/Images/appbar_button2.png" Text="Button 2"/>
            <shell:ApplicationBar.MenuItems>
                <shell:ApplicationBarMenuItem Text="MenuItem 1"/>
                <shell:ApplicationBarMenuItem Text="MenuItem 2"/>
            </shell:ApplicationBar.MenuItems>
        </shell:ApplicationBar>
    </phone:PhoneApplicationPage.ApplicationBar>-->

</phone:PhoneApplicationPage> 
```

该程序只有 3 个元素，1）一个 TextBox 2）一个 TextBlock 和一个 3）按钮。用户在文本框中输入数据然后单击“开始”按钮，如果输入为“1 2 3 4”，则应用程序将在文本块中显示“你赢了”，如果输入了任何其他输入，它将显示“你输了”。请帮助，我不知道任何 Xaml，所以我无法使用 Xaml 代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T23:03:17.433

您的错误是由于 PhoneApplicationPage_Loaded 事件处理程序方法造成的。它应该是这样的：

```
private void PhoneApplicationPage_Loaded(object sender, RoutedEventArgs e)
{
    myTextBox.Focus();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T23:04:41.333

`e`将您的参数更改为类`PhoneApplicationPage_Loaded`的实例 `RoutedEventArgs`：

```
private void PhoneApplicationPage_Loaded(object sender, RoutedEventArgs e)
{
    myTextBox.Focus();
} 
```

# java - jaudiotagger java - MP3AudioHeader 无法解析

> ID：11835567
> 
> 赞同：0
> 
> 时间：2012-08-06T20:37:11.950
> 
> 标签：java, mp3

我正在尝试使用 jaudiotagger 从我最近的副项目的 mp3 文件中检索 id3 标签，但我遇到了这个问题..我无法运行程序，因为我收到这个错误说“MP3AudioHeader 无法解决”..但是如您所见，我已导入所需的所有内容...任何建议都会有所帮助，这是我从网站上复制的代码

```
import org.jaudiotagger.*;
 public class mainClass
{
public static void main(String[] args)
{
    // the file we are going to read
    File oSourceFile = new File("/Users/tushar_chutani/Music/iTunes/iTunes Media/Music/Fun_/We Are Young (feat. Janelle Monáe) - Single/01 We Are Young (feat. Janelle Monáe).mp3");

    MP3File f      = (Mp3File)AudioFileIO.read(oSourceFile);
    MP3AudioHeader audioHeader = f.getAudioHeader();
    audioHeader.getTrackLength();
    audioHeader.getSampleRateAsNumber();
    mp3AudioHeader.getChannels();
    mp3AudioHeader.isVariableBitRate();
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T12:33:21.607

你的代码是正确的，错误是它不是（Mp3File）它的（MP3File）'p'应该是大写字母。正确的是：-

```
MP3File f  = (MP3File)AudioFileIO.read(oSourceFile); 
```

# linux - 在压缩包目录中搜索文件？

> ID：11835578
> 
> 赞同：2
> 
> 时间：2012-08-06T20:38:05.110
> 
> 标签：linux, command, find

所以我有一个 tarball 目录。即/home/username/dir_w_tarballs。在其中一个 tarball 中是来自曾经在这里工作的工程师的许可证密钥。如何在目录中的每个 tarball 中搜索特定文件？类似的东西`find . -name some_file`？我知道我可以使用`tar -jtvf file.tar.bz2`. 我希望范围更广一些。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:42:07.973

这个怎么样：

```
find -name '*.tar' -o -name '*.tar.*' | while read f; do
    tar -tf "$f" | grep some_file | sed "s|^|$f:|"
done 
```

它将递归查找当前目录下的所有压缩包，列出每个压缩包，`grep`用于搜索特定文件，然后`sed`将压缩包名称添加到每个匹配项，以便您能够判断哪个压缩包包含每个匹配项...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-26T11:18:26.233

您可以使用 tar 和 grep 命令以及 bash for 循环来搜索特定文件或模式。只需更改<模式>：

```
for i in *.tar.gz; 
do echo $i; 
tar tf $i| grep <pattern>; 
echo '------------'; 
done 
```

它遍历文件夹中的每个文件并仅提取树内容并通过它们进行 grep。

如果要递归搜索：

```
find . -type f -name "*.tar.gz" | while read f; do echo $f; tar tf $f| grep db_dump ;done 
```

# asp.net - 选择“键”时传递“值”-MVC/字典对象

> ID：11835583
> 
> 赞同：1
> 
> 时间：2012-08-06T20:38:21.363
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, dictionary, actionlink

我正在用这样的键值对填充字典对象..

```
 Dictionary<string, string> twoValues = new Dictionary<string, string>();

        foreach (var item in query)
        {
            twoValues.Add(item.Name, item.Id);
        }

        return twoValues; 
```

我将这些值对返回到控制器并填充 MVC 模型（选择列表）

```
 model.Names = new SelectList(twoValues.Keys);
 model.Ids   = new SelectList(twoValues.Values);
 return model; 
```

在视图中，我有一个操作链接和一个下拉菜单。下拉列表填充了字典的键值（在这种情况下，键是文本名称，值是 ids）

```
//Action link 

<%=Html.ActionLink("link", "Method", "Controller", new { Id = ??  })%>

//Drop down   

<%=Html.DropDownList("names", Model.Names, "")%> 
```

如何通过操作链接将与下拉列表中所选名称关联的 ID 传递给控制器​​？

我尝试在带有 id 的名称旁边放置另一个下拉列表.. 但不知何故，我需要维护两个下拉列表之间的链接.. 因为我在视图中分离字典键值对以进行显示...

我可以有类似...

```
//Action link 

<%=Html.ActionLink("link", "Method", "Controller", new { Id = ??  })%>

//Drop down   

<%=Html.DropDownList("names", Model.Names, "")%>     
<%=Html.DropDownList("ids", Model.Ids, "")%> 
```

如何通过所选“名称”下拉列表的操作链接传递 id。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:45:39.467

你需要对`click`事件做一些 javascript 技巧。读取下拉列表的选定值并构建 url 并导航到该值。

```
@Html.ActionLink("Link","Method","Controller",null,new { @class="hackLink"})

<script type="text/javascript">
  $(function(){
      $(".hackLink").click(function(e){
       e.preventDefault();   //Prevent default link click behaviour
       var item=$(this);
       var selectedVal=$("#names").val();
       var newUrl=item.attr("href")+"?id="+selectedVal;
       window.location.href=newUrl; 
      });

  });

</script> 
```

假设`names`是您的 DropDown 的 ID。

或者，您可以监听`change`Dropdown 的事件，然后设置`href`链接的 value 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:08:31.433

我建议创建一个下拉菜单，其中选项的值等于您的 id 字段，文本等于您的姓名。您应该能够使用以下内容创建它：

**控制器**：

```
IEnumerable<SelectListItem> items = yourQueryCode.Select(c => new SelectListItem
               {
                 Value = c.ID.ToString(), 
                 Text = c.Name
               });

ViewBag.Names = items; 
```

**HTML**：

```
<%= Html.DropDownList("Names", (IEnumerable<SelectListItem>) ViewBag.Names) %> 
```

这将允许您在执行此操作时将 ID 链接到名称作为下拉列表的值`$('#dropdown').val()`。

最好将 SelectList 作为返回视图的模型的一部分，但上述方法也可以。当您切换到通过模型返回时，只需进行一些小的更改，并且过渡非常简单。希望这足以让您朝着正确的方向前进。

# ruby-on-rails - 使用 capistrano、passenger 和 apache 部署 rails

> ID：11835584
> 
> 赞同：0
> 
> 时间：2012-08-06T20:38:23.837
> 
> 标签：ruby-on-rails, apache, deployment, capistrano, passenger

我最近建立了一个 VPS 并正在尝试部署一个 rails 应用程序。我观看了一个截屏视频：[http](http://railscasts.com/episodes/335-deploying-to-a-vps) : //railscasts.com/episodes/335-deploying-to-a-vps，它解释了如何使用 nginx 设置 capistrano 和 unicorn，但也给出了 apache 的示例。

我按照在线指南设置乘客并修改了 railscasts capistrano 食谱。当我运行`cap deploy:setup`一些目录时，会在我的服务器上的应用程序根目录中创建一些目录。然后，当我运行`cap deploy`rails 应用程序时，它会被放入发布文件夹和以时间戳命名的目录中。所以这部分似乎工作得很好。

所以有一段时间，当我导航到[http://dev.gregchapple.com/site/index](http://dev.gregchapple.com/site/index)时，我收到了一些乘客错误，说某些 gem 丢失了，所以我使用 bundler 将它们安装在服务器上，然后错误就消失了。这就是当前问题出现的时候。现在，当我访问[http://dev.gregchapple.com/site/index](http://dev.gregchapple.com/site/index)时，它只显示：“我们很抱歉，但出了点问题。”

apache 日志包含以下内容：

```
cache: [GET /site/index] miss
cache: [GET /] miss 
```

有谁知道问题是什么？我的 apache 配置文件已更改为将文档根设置为乘客文档指定的公共目录。我不知道问题是什么，它让我发疯！

任何帮助是极大的赞赏 ：）

# 更新

这是 production.log 文件出现的内容：

```
Started GET "/site/index" for 109.255.221.170 at 2012-08-06 13:26:13 -0700

Mysql2::Error (Access denied for user 'root'@'localhost' (using password: NO)):
mysql2 (0.3.11) lib/mysql2/client.rb:44:in `connect'
mysql2 (0.3.11) lib/mysql2/client.rb:44:in `initialize'
activerecord (3.2.1) lib/active_record/connection_adapters/mysql2_adapter.rb:16:in `new'
activerecord (3.2.1) lib/active_record/connection_adapters/mysql2_adapter.rb:16:in `mysql2_connection'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:277:in `new_connection'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:287:in `checkout_new_connection'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:235:in `block (2 levels) in checkout'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:230:in `loop'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:230:in `block in checkout' /home/greg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:229:in `checkout'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:95:in `connection'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:374:in `retrieve_connection'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_specification.rb:168:in `retrieve_connection'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_specification.rb:142:in `connection'
activerecord (3.2.1) lib/active_record/query_cache.rb:67:in `rescue in call'
activerecord (3.2.1) lib/active_record/query_cache.rb:61:in `call'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.1) lib/active_support/callbacks.rb:405:in `_run__3520547282522082875__call__1971459733125288916__callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.1) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.1) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.1) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.1) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.1) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
rack-cache (1.2) lib/rack/cache/context.rb:136:in `forward'
rack-cache (1.2) lib/rack/cache/context.rb:245:in `fetch'
rack-cache (1.2) lib/rack/cache/context.rb:185:in `lookup'
rack-cache (1.2) lib/rack/cache/context.rb:66:in `call!'
rack-cache (1.2) lib/rack/cache/context.rb:51:in `call'
railties (3.2.1) lib/rails/engine.rb:479:in `call'
railties (3.2.1) lib/rails/application.rb:220:in `call'
railties (3.2.1) lib/rails/railtie/configurable.rb:30:in `method_missing'
passenger (3.0.15) lib/phusion_passenger/rack/request_handler.rb:96:in `process_request'
passenger (3.0.15) lib/phusion_passenger/abstract_request_handler.rb:516:in `accept_and_process_next_request'
passenger (3.0.15) lib/phusion_passenger/abstract_request_handler.rb:274:in `main_loop'
passenger (3.0.15) lib/phusion_passenger/rack/application_spawner.rb:206:in `start_request_handler'
passenger (3.0.15) lib/phusion_passenger/rack/application_spawner.rb:171:in `block in handle_spawn_application'
passenger (3.0.15) lib/phusion_passenger/utils.rb:470:in `safe_fork'
passenger (3.0.15) lib/phusion_passenger/rack/application_spawner.rb:166:in `handle_spawn_application'
passenger (3.0.15) lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'
passenger (3.0.15) lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'
passenger (3.0.15) lib/phusion_passenger/abstract_server.rb:180:in `start'
passenger (3.0.15) lib/phusion_passenger/rack/application_spawner.rb:129:in `start'
passenger (3.0.15) lib/phusion_passenger/spawn_manager.rb:253:in `block (2 levels) in spawn_rack_application'
passenger (3.0.15) lib/phusion_passenger/abstract_server_collection.rb:132:in `lookup_or_add'
passenger (3.0.15) lib/phusion_passenger/spawn_manager.rb:246:in `block in spawn_rack_application'
passenger (3.0.15) lib/phusion_passenger/abstract_server_collection.rb:82:in `block in synchronize'
<internal:prelude>:10:in `synchronize'
passenger (3.0.15) lib/phusion_passenger/abstract_server_collection.rb:79:in `synchronize'
passenger (3.0.15) lib/phusion_passenger/spawn_manager.rb:244:in `spawn_rack_application'
passenger (3.0.15) lib/phusion_passenger/spawn_manager.rb:137:in `spawn_application'
passenger (3.0.15) lib/phusion_passenger/spawn_manager.rb:275:in `handle_spawn_application'
passenger (3.0.15) lib/phusion_passenger/abstract_server.rb:357:in `server_main_loop'
passenger (3.0.15) lib/phusion_passenger/abstract_server.rb:206:in `start_synchronously'
passenger (3.0.15) helper-scripts/passenger-spawn-server:99:in `<main>' 
```

# 更新 2

## 数据库.yml

```
development:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: gregchapple_development
  pool: 5
  host: localhost
  username: root
  password: *****
  socket: /tmp/mysql.sock

test:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: gregchapple_test
  pool: 5
  host: localhost
  username: root
  password: *****
  socket: /tmp/mysql.sock

production:
  adapter: mysql2
  encoding: utf8
  reconnect: false
  database: gregchapple_production
  pool: 5
  host: localhost
  username: root
  password: *****
  socket: /tmp/mysql.sock 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T12:46:30.830

I had similar problem like you. I changed these rows in database.yml add

> host: 127.0.0.1

remove

> socket: /tmp/mysql.sock

Then:

```
cap deploy:setup
cap deploy:check
cap deploy:cold
#some updates with custom code
cap deploy:update 
```

You must update everything in code with capistrano, DON'T CHANGE CODE ON VPN (you can create only tmp dir). You check your sql connection manualy with ssh on vpn. For example

> mysql -u gregchapple -p

Your virtual host is ok?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T22:39:30.693

您的应用正在寻找 mysql2 适配器，因此请确保您的 Gemfile 中有

```
gem 'mysql2' 
```

并且你`bundle install`和你的`database.yml`文件中你正在使用 mysql2 适配器。

```
production:
  adapter: mysql2
  ... 
```

并且不要忘记`touch tmp/restart.txt`从 Rails 应用程序的根目录重新启动Passenger。

恭喜！您快到了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:10:56.863

您的 Rails 应用程序的`database.yml`生产部分配置不正确。

1.  在您的服务器上配置 mysql 数据库。
2.  在 Rails 应用程序的 database.yml 中配置生产部分，并为生产服务器提供数据库用户名和密码。
3.  再次部署。
4.  测试。

# .net - 如何识别第 3 方应用程序使用的控件？

> ID：11835587
> 
> 赞同：2
> 
> 时间：2012-08-06T20:38:29.280
> 
> 标签：.net, windows, controls, powerbuilder, identification

我的任务是为显示在第 3 方软件中的客户端提取信息（这似乎只是一个 RTF 文档），以便可以将其导入我们的软件（客户端正在将软件供应商切换给我们，我们正在尝试转换他们的记录交给我们）。

主要问题是他们存储记录数据的文件是[某种格式错误的 zip 文件](https://superuser.com/questions/457271/identifiying-a-zip-file-that-is-not-really-a-zip-file)。但是，一旦我打开了 .enc 文件，我（也没有 TrID [）](http://mark0.net/soft-tridnet-e.html)识别的格式。我不知道解压缩是否有效并且这是一种未知格式，或者尝试修复文件导致它解压缩不正确，但它在执行后没有抛出任何错误。

尝试查看他们使用的控件是否来自我可以购买的公共库中的控件的过程是什么，这样我就可以提供相同的数据源，然后从控件中解析出我需要的信息？

![在此处输入图像描述](../Images/05b3f1982da41b185fbd1d554121fd7c.png)

我知道程序的主要部分是使用[PowerBuilder 12](http://www.sybase.com/products/modelingdevelopment/powerbuilder/)编写的。在 Sybase 的网站上，他们声称 PowerBuilder 是基于 .NET 的，但尝试使用 ILSpy 打开 exe 时表示在 exe 中没有可用的托管程序集。但是我从未使用过 PowerBuilder，并且 exe 是由 sybase 签名的，而不是第三方供应商，所以我可能需要尝试找到一个 sybase exe 正在加载和移交的库。

因此，既然简单的解决方案 (ILSpy) 已不在讨论范围内，下一步将如何确定他们使用什么来呈现该文档（或者至少我需要弄清楚如何找出使用 ILSpy 查找的位置）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T02:46:27.293

冒着成为明显队长的风险，.ENC 扩展名不是暗示该文件已被“加密”吗？（至少，这是我见过的潜在解释之一。）这可以解释缺乏可识别的文件格式。更确定的是，由于您可以通过应用程序看到纯文本，因此我将通过解压缩的数据搜索关键字；如果它不存在，因为它已经使用 ZIP 算法进行了压缩（尝试压缩两次没有意义……至少从压缩的角度来看没有意义），那么它也可能是加密的。

如果是这种情况，那么您必须：

*   确定使用的方法（数据可能已经使用一种或多种算法通过多次加密），
*   识别使用的密钥，
*   解密，
*   **然后**开始着手解释原始数据格式。

如果您只有加密数据并且已经正确完成，那么这项任务应该是不可能的（不需要几个世纪）。但是，不能保证它已正确完成，并且您可以观察可执行文件并使用它进行测试。有了正确的专家组合，就可以做到。（你*确实*说过“无限预算”，不是吗？*咧嘴笑*）

最后一点，我没有足够的资格来做这件事。如果这是加密，并且可以解释为数据的复制保护，那么根据您所在司法管辖区的法律，这项任务可能具有法律风险。确保**您**在这方面获得合格的法律顾问；不要相信你的 PHB 会为你做这件事。（一种*赢得*的愤世嫉俗。）

祝你好运，

特里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T20:42:45.057

我的第一步是通过 Sysinternals Process Monitor 捕获应用程序操作，并查看使用了哪些文件/位置/键。

[http://technet.microsoft.com/en-us/sysinternals/bb896645](http://technet.microsoft.com/en-us/sysinternals/bb896645)

# pdf - 如何在虾pdf中正确对齐标题 和列？

> ID：11835591
> 
> 赞同：0
> 
> 时间：2012-08-06T20:38:54.693
> 
> 标签：pdf, pdf-generation, prawn, prawnto

我们正在为 rails 3.1.4 中的虾生成发票 pdf。

```
 header =[[  "Date", "#", "sample name", "model","lease item", "hours", "$/hour", "Total"]]
  items = @invoice.invoice_items.map do |item|
    [
                item.lease_usage_record.lease_usage_items.map do |li|
                [
                  li.lease_date.strftime("%Y-%m-%d"),
                  item.lease_usage_record_id,
                  li.sample_name,
                  li.sample_model_num,
                  li.lease_item.short_name,          
                  li.total_hour,
                  li.charge_rate,
                  li.subtotal
                ]
                end
    ] 
  end
items = header + items
pdf.table items, :header => true, :width => 480 
t = pdf.make_table([ ["                                                       ", "Total:     ","    #{@invoice.total}"] ])
t.draw 
```

它适用于一个问题。问题是所有数据单元都被压缩到第一列，即“日期”。试图在标题中再添加一个 [] 并生成“数据是二维数组......”的错误。如何在其标题下正确对齐每一列？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T22:57:51.777

通过将数据（项目）的维度减少到二维来解决该问题。大虾只能取二维数据。以下行可以解决问题：

```
items = items.flatten(2) 
```

# asp.net - 在 asp.net 中验证字符串是否为 json

> ID：11835593
> 
> 赞同：7
> 
> 时间：2012-08-06T20:39:01.090
> 
> 标签：asp.net, json, servicestack

有什么方法可以验证字符串是否为 json？除了 try/catch 。

我正在使用 ServiceStack Json Serializer 并且找不到与 validation 相关的方法。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-07T01:39:32.553

可能最快和最脏的方法是检查字符串是否以**'{'**开头：

```
public static bool IsJson(string input){ 
    input = input.Trim(); 
    return input.StartsWith("{") && input.EndsWith("}")  
           || input.StartsWith("[") && input.EndsWith("]"); 
} 
```

另一种选择是您可以尝试使用 JavascriptSerializer 类：

```
JavaScriptSerializer ser = new JavaScriptSerializer(); 
SomeJSONClass = ser.Deserialize<SomeJSONClass >(json); 
```

或者你可以看看 JSON.NET：

*   [http://james.newtonking.com/projects/json-net.aspx](http://james.newtonking.com/projects/json-net.aspx)
*   [http://james.newtonking.com/projects/json/help/index.html?topic=html/SerializingJSON.htm](http://james.newtonking.com/projects/json/help/index.html?topic=html/SerializingJSON.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-19T07:28:11.697

*一个工作代码片段*

```
public bool isValidJSON(String json)
{
    try
    {
        JToken token = JObject.Parse(json);
        return true;
    }
    catch (Exception ex)
    {
        return false;
    }
} 
```

[资源](https://stackoverflow.com/a/30932433/730807)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T20:52:43.140

你可以在这里找到几个正则表达式来验证 JSON：[Regex to validate JSON](https://stackoverflow.com/questions/2583472/regex-to-validate-json)

它是用 PHP 编写的，但应该适用于 C#。

# javascript - 结合 $(this) 和 $("li:eq(ui.item.index())")

> ID：11835594
> 
> 赞同：1
> 
> 时间：2012-08-06T20:39:05.833
> 
> 标签：javascript, jquery, jquery-ui

使用 jQuery，我如何结合`$(this)`和`$("li:eq(ui.item.index())")`类似的东西`$(this).$("li:eq(ui.item.index())").id`？

我正在尝试在使用 jQuery UI 工具包创建的可排序列表中获取列表元素的 id 属性

```
$(".sections-list").sortable({ /* Update position of sortable elements */
    start: function(event, ui) {
        var start   = ui.item.index();
        var section = $("li:eq(start)").id;

        alert(section);
    }
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T20:40:20.033

假设您要做的是在`li`下面找到特定的索引项`this`，您可以这样做：

```
$(this).find("li").eq(ui.item.index()).attr("id") 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T20:43:10.543

您也可以`this`作为第二个参数传递给`$()`，指示搜索的上下文：

```
$('li:eq('+start+')',this).attr('id') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T20:41:26.443

如果您要查找的元素是`$(this)`对象的后代，那么您可以使用 jQuery 的`.find()`函数。

```
$(this).find("li:eq("+ui.item.index()+")").id 
```

如果您要查找的元素是其兄弟元素，`$(this)`那么您可以使用该`.siblings()`函数来查找它们 -

```
$(this).siblings("li:eq("+ui.item.index()+")").id 
```

参考 -

*   [`find()`](http://api.jquery.com/find/)
*   [`siblings()`](http://api.jquery.com/siblings/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T20:41:03.470

```
$(this).find(selector); 
```

查找选择器获取您的初始 jquery 并在其中再次搜索。

在这里阅读更多信息：http: [//api.jquery.com/find/](http://api.jquery.com/find/)

# java - 小程序异常：java.lang.ClassNotFoundException

> ID：11835599
> 
> 赞同：1
> 
> 时间：2012-08-06T20:39:20.047
> 
> 标签：java, html, applet

我有一个文件夹，里面有两个文件；java .class 文件和 .html 文件。在我的 html 文件中，我将 .class 文件称为小程序，但它在其发布的网站上显示一个错误，说它找不到 .class 文件。这让我感到困惑，因为它们在同一个目录中，我三重检查了拼写错误。

这是我的 .html 文件...

```
<html>

<head>
<title>Applet</title>
</head>

<body>
Program<br />
<applet code="testing.class" width="300" height="300"/>
</body>

</html> 
```

这是我的 .class 文件...

```
import java.awt.Color;
import java.awt.Graphics;

public class testing extends java.applet.Applet{

    public void init(){

    }

    public void paint(Graphics g){
        g.drawOval(0,0,250,100);
        g.setColor(Color.RED);
        g.drawString("My Applet",10,50);
    }

} 
```

我的 .class 文件是“testing.class”，我的 html 文件是“testingpage.html”

这是完整的整个错误

```
load: class testing.class not found.
java.lang.ClassNotFoundException: testing.class
    at sun.plugin2.applet.Applet2ClassLoader.findClass(Applet2ClassLoader.java:252)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Plugin2ClassLoader.java:249)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Plugin2ClassLoader.java:179)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Plugin2ClassLoader.java:160)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    at sun.plugin2.applet.Plugin2ClassLoader.loadCode(Plugin2ClassLoader.java:690)
    at sun.plugin2.applet.Plugin2Manager.createApplet(Plugin2Manager.java:3045)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Plugin2Manager.java:1497)
    at java.lang.Thread.run(Thread.java:680)
Exception: java.lang.ClassNotFoundException: testing.class
load: class testing.class not found.
java.lang.ClassNotFoundException: testing.class
    at sun.plugin2.applet.Applet2ClassLoader.findClass(Applet2ClassLoader.java:252)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Plugin2ClassLoader.java:249)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Plugin2ClassLoader.java:179)
    at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Plugin2ClassLoader.java:160)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    at sun.plugin2.applet.Plugin2ClassLoader.loadCode(Plugin2ClassLoader.java:690)
    at sun.plugin2.applet.Plugin2Manager.createApplet(Plugin2Manager.java:3045)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Plugin2Manager.java:1497)
    at java.lang.Thread.run(Thread.java:680)
Exception: java.lang.ClassNotFoundException: testing.class 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T20:41:45.430

`applet`标签应该是：

```
<applet code=testing.class width="300" height="300" /> 
```

注意`code`属性的变化。[与相关 Java 教程](http://docs.oracle.com/javase/7/docs/technotes/guides/plugin/developer_guide/using_tags.html#applet)中列出的示例代码进行比较：

```
<applet code=Applet1.class width="200" height="200">
Your browser does not support the <code>applet</code> tag.
</applet> 
```

以下对我有用。

[http://puu.sh/PebS](http://puu.sh/PebS)

# 测试Applet.java

```
import java.applet.Applet;

import java.awt.Color;
import java.awt.Graphics;

public final class TestingApplet extends Applet {

  public void paint(final Graphics g){
    g.drawOval(0, 0, 250, 100);
    g.setColor(Color.RED);
    g.drawString("My Applet", 10, 50);
  }
} 
```

# 测试-applet.html

```
<html>
  <head>
    <title>Applet</title>
  </head>
  <body>
    Program <br />
    <applet code=TestingApplet.class width="300" height="300" />
  </body>
</html> 
```

如果这不起作用，我有两个问题要问你......

*   您是否将 Java 保存为`.java`文件并对其进行编译以生成正确的`.class`文件？

*   您是否确认您的浏览器没有缓存旧的不正确版本的`.html`文件？

*   你`.class`和`.html`文件在同一个目录吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-23T16:13:42.213

我很确定您没有打开正确的 HTML 文件。**使用您的文件浏览器**（我猜是 Finder；））并在 Netbeans 项目目录中查找该文件。它应该在 /build/classes/.html

# java - 404错误Spring MVC

> ID：11835602
> 
> 赞同：0
> 
> 时间：2012-08-06T20:39:31.010
> 
> 标签：java, web-applications, servlets, spring-mvc

我编写了一个 Spring MVC 应用程序，它显示在 XML 视图中运行的测试用例和套件的报告。我编写了很好的模型类，并且我编写了以下文件，但我猜 Handler Mapping 存在一些问题

**我的 controller.java 类看起来像这样**

```
package com.DrAssist.Fitnesse.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;

import com.DrAssist.Fitnesse.model.Suite;

@Controller
@RequestMapping("/Suite/{name}")
public class XMLController {

    @RequestMapping(value="{name}", method = RequestMethod.GET, headers = "content-type=application/xml")
    public @ResponseBody Suite getSuiteInXML(@PathVariable String name) {

        Suite suite = new Suite("1",name,"3","Test1","4","5","7","9","550");

        return suite;

    }

} 
```

**我的 web.xml 文件看起来像这样**

```
<web-app id="WebApp_ID" version="2.4"
    xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee 
    http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">

    <display-name>Spring Web MVC Application</display-name>

    <servlet>
        <servlet-name>mvc-dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>/*</url-pattern>
    </servlet-mapping>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/mvc-dispatcher-servlet.xml</param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

</web-app> 
```

**dispatcher-servlet.xml 文件看起来像这样**

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans     
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd">

    <context:component-scan base-package="com.DrAssist.Fitnesse.controller" />

    <mvc:annotation-driven />

    <!--  
    <bean class="org.springframework.web.servlet.view.BeanNameViewResolver" />

    <bean id="xmlViewer" 
        class="org.springframework.web.servlet.view.xml.MarshallingView">
        <constructor-arg>
            <bean class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
                <property name="classesToBeBound">
                    <list>
                        <value>com.DrAssist.Fitnesse.model</value>
                    </list>
                </property>
            </bean>
        </constructor-arg>
    </bean>
    -->

</beans> 
```

我收到 404 错误，控制台显示错误为

**在名称为“mvc-dispatcher”的 DispatcherServlet 中找不到具有 URI [/SpringMVC/Suite/suite1] 的 HTTP 请求的映射**

请咨询 似乎 /SpringMVC/Suite/suite1] 本身的 SpringMVC 部分没有通过请求。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T08:47:27.417

您的代码将无法工作，因为日志语句已写入`DispatcherServlet`并且在那里进行了很好的硬编码。`DispatcherServlet`除了复制替换生成错误响应代码的代码并将其重定向到所需的输出之外，您几乎无能为力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-16T09:33:03.977

在 web.xml 中，您将调度程序声明为 mvc-dispatcher，并且您提供的 spring 配置文件名称是 dispatcher-servlet.xml，它应该是 mvc-dispatcher-servlet.xml。尝试这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:09:10.950

你把`{name}`路径变量放在两个`@RequestMapping`. 尝试将第一个保留为`@RequestMapping("Suite")`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-17T12:14:19.940

如果你已经写了

```
@RequestMapping(value="{name}" 
```

比你不需要写这个，这是错误的。请更改

```
@RequestMapping("/Suite/{name}") 
```

改写

```
 @RequestMapping("/Suite") 
```

# asp.net - BC30451：未声明“NewsBody”。由于其保护级别，它可能无法访问

> ID：11835604
> 
> 赞同：1
> 
> 时间：2012-08-06T20:39:48.423
> 
> 标签：asp.net

尝试我可能无法克服这个错误。我不是 ASP.Net 开发人员，但由于我无法控制的原因，我必须在 ASP 中开发 2-3 页。

我正在使用 Dreamweaver 并将 asp.net 设置为在首次加载时进行编译。

**.aspx 文件**

```
<%@ Page Language="vb" AutoEventWireup="false"  Src="Scripts/CurrentNews.aspx.vb" Inherits="NewsFunctionality" %>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>News</title>
<link rel="stylesheet" type="text/css" href="CSS/NewsLayoutOne.css"/>
</head>
<body>
    <div class="OuterDiv" runat="server">
        <img id="NewsImage" src="Images/DefaultNews1.png" >
        <div id="NewsBody" runat="server">Original Text</div>
    </div>
</body>
</html> 
```

**.aspv.vb 文件**

```
' VB Document
public partial Class NewsFunctionality
    Inherits System.Web.UI.Page
    'On load event for the page linked to this class file
   protected sub Page_Load(sender As Object, e As System.EventArgs) Handles Me.Load
       NewsBody.InnerHTML = "<p>Dynamic Text Generated.</p>"
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T01:28:35.803

Check that **'NewsBody'** have been declared within the **designer.vb** file.

It could look something like this since you are using a div:

```
 protected global::System.Web.UI.HtmlControls.HtmlGenericControl NewsBody; 
```

# objective-c - 一对多但 NSNull 对象的 KVO 传递到 observeValueForKeyPath

> ID：11835607
> 
> 赞同：3
> 
> 时间：2012-08-06T20:40:05.083
> 
> 标签：objective-c, ios, ios5, key-value-observing

我有一个与成员类具有一对多关系的托管对象。当我为成员添加观察者时，它起作用了。当一个新成员添加到关系中时，将使用新对象调用 observeValueForKeyPath 并且更改字典包含新成员对象。但是，observeValueForKeyPath 将在所有值为零的情况下第二次触发并更改字典 new="NULL"。第二个触发器是什么？我设置了一个断点，但不确定是谁触发的。

```
@interface FooObject : NSManagedObject {}
@property (nonatomic, strong) NSString *fooId;
@property (nonatomic, strong) NSSet* members;
@end

@implementation FooObject
@dynamic fooId;
@dynamic members;

- (NSMutableSet*)membersSet {
    [self willAccessValueForKey:@"members"];

    NSMutableSet *result = (NSMutableSet*)[self mutableSetValueForKey:@"members"];

    [self didAccessValueForKey:@"members"];
    return result;
}

- (void)registerObservers {
    [self addObserver:self
           forKeyPath:@"members"
              options:NSKeyValueObservingOptionNew
              context:nil];
}

- (void)unregisterObservers {
    @try{
        [self removeObserver:self forKeyPath:@"members"];
    }@catch(id anException){
        //do nothing, obviously it wasn't attached because an exception was thrown
    }
}

- (void)observeValueForKeyPath:(NSString *)keyPath
                      ofObject:(id)object 
                        change:(NSDictionary *)change 
                       context:(void *)context
    id valueNewSet = [change objectForKey:NSKeyValueChangeNewKey];
    if (![valueNewSet isKindOfClass:[NSSet class]]) {
            // not a NSSet, it contains <null> value
            NSLog(@"%@", change);
            NSLog(@"%@", object);
    }
    if ([[change objectForKey:NSKeyValueChangeKindKey] intValue] == NSKeyValueChangeInsertion) {
           // insert change is valid, process the changes
    }

}
@end 
```

日志输出：

```
{
    kind = 1;
    new = "<null>";
}

<FooObject: 0xfa9cc60> (entity: FooObject; id: 0xfa9be00 <x-coredata://39DB31FD-6795-4FDE-B700-819AB22E5170/SHInterest/p6> ; data: {
    fooId = nil;
    members = nil;
}) 
```

**编辑 1** 我在 NSLog(@"%@", change); 这是堆栈跟踪，但对于确定谁进行此调用并没有真正的帮助。

主 -> UIApplicationMain -> NSKeyValueNotifyObserver -> observeValueForKeyPath:ofObject:change:context

**编辑 2** 也许这仍然是一个错误？ [http://www.cocoabuilder.com/archive/cocoa/182567-kvo-observevalueforkeypath-not-reflecting-changes.html](http://www.cocoabuilder.com/archive/cocoa/182567-kvo-observevalueforkeypath-not-reflecting-changes.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-10T10:10:52.973

我遇到了同样的问题，“隐式”分配（以及 KVO 观察者的通知）显然仅作为解除分配 MOs 的一部分发生：我保存一个子 MOC，然后释放它，然后 iOS 释放它的 MOs。`NSNull`我假设它会在释放相关 MO 的过程中临时设置一对多关系（删除规则级联适用）。

所以接下来要更改插入和删除的类型，我的 KVO 观察者现在也接受`NSKeyValueChangeSetting`和断言`change[NSKeyValueChangeNewKey] == NSNull.null`。称之为务实的解决方案。

# django - 扩展 django UserProfile，新字段添加到 list_display 后显示为 (None)

> ID：11835613
> 
> 赞同：0
> 
> 时间：2012-08-06T20:40:36.337
> 
> 标签：django, django-admin

我正在扩展 UserProfile，但在获取新字段时遇到问题`current_article`- 我添加到该字段`list_display`以在用户概览页面中正确显示 - `Home › Auth › Users`

新字段有它自己的列，但`(None)`即使在用户详细信息页面中选择值后也始终具有值。

如何让字段的值显示在概览管理页面中？

我引用了这个stackoverflow问题： [Django Admin：如何在同一视图中显示来自两个不同模型的字段？](https://stackoverflow.com/questions/3409970/django-admin-how-to-display-fields-from-two-different-models-in-same-view)

这是代码：

```
#admin.py   
class UserProfileInline(admin.StackedInline):
        model = UserProfile

    class CustomUserAdmin(UserAdmin):
    inlines = [
               UserProfileInline,
               ]
    def current_article(self,instance):
        return instance.user.current_article

    list_display = ('id','username','email','current_article','first_name','last_name','is_active', 'date_joined', 'is_staff','last_login','password')

admin.site.unregister(User)
admin.site.register(User, CustomUserAdmin) 
```

在 Models.py 中

```
#models.py
from django.db import models
from django.contrib.auth.models import User
from django.db.models.signals import post_save

class UserProfile(models.Model):
    user = models.OneToOneField(User)
    current_article = models.ForeignKey(Article,blank=True,default=1)

    def __unicode__(self):  
        return "{}".format(self.user)

def create_user_profile(sender, instance, created, **kwargs):
    if created:
        UserProfile.objects.create(user=instance)

post_save.connect(create_user_profile, sender=User) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:49:21.803

您的方法实际上引发了一个`AttributeError`异常，但是 Django 在处理时隐藏了这个`list_display`（它捕获所有异常并`None`作为值返回）。

你需要有`return instance.get_profile().current_article`.

# objective-c - UITableView - 插入行并滚动到特定部分

> ID：11835614
> 
> 赞同：0
> 
> 时间：2012-08-06T20:40:45.243
> 
> 标签：objective-c, uitableview, animation, scroll, insertion

我有一个像..

![在此处输入图像描述](../Images/4107f40261d5f945182c0811c47fce61.png)

单元格 xxxx、yyyy 和 zzzz 是固定的，因此对它们没有点击动作。但是单元格“显示”是可点击的。单击“显示”单元格时，我想在“显示”单元格下显示一些六个单元格。

因此，单击“显示”单元格后，表格将如下所示。

![在此处输入图像描述](../Images/c2ca4881f82b70f979a8905121526163.png)

在这里，我所做的是，

*   将“显示”更改`cell.textLabel.text`为“隐藏”

*   `[tableView reloadData];`方法中使用`tableView:didSelectRowAtIndexPath:`。

我的代码是：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.title = @"My title";
    // This Mutable array contains the hided cell objects
    hidedCellsArray = [[NSMutableArray alloc] initWithObjects:@"Cell 1", @"Cell 2", @"Cell 3", @"Cell 4", @"Cell 5", @"Cell 6", nil];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{
...

else if(indexPath.section == 1)
    {
        if (isShowClicked) //isShowClicked is a boolean value that determines whether the show cell was clicked or not
        {
            if (indexPath.row == 0)
            {
                cell.textLabel.text = @"Hide";
                cell.selectionStyle = UITableViewCellSelectionStyleBlue;
                cell.textLabel.textAlignment=UITextAlignmentCenter;
            }

            else
            {
                cell.textLabel.text = [hidedCellsArray objectAtIndex:indexPath.row-1];
                cell.selectionStyle = UITableViewCellSelectionStyleBlue;
                cell.textLabel.textAlignment=UITextAlignmentCenter;
            }
        }

        else
        {
            cell.textLabel.text = @"Show";
            cell.selectionStyle = UITableViewCellSelectionStyleBlue;
            cell.textLabel.textAlignment=UITextAlignmentCenter;
        }
    }
...
return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
{
    if (indexPath.section == 1)
    {
        if (isShowClicked)
        {
            isShowClicked = NO;
        }

        else
        {
            isShowClicked = YES;
        }

        [tableView reloadData];
    }
} 
```

**我需要的：**

*   当我单击显示/隐藏按钮时，我想为单元格设置动画。我才知道，`insertRowsAtIndexPaths: withRowAnimation:` 要达到插入效果，应该是用的方法。但我真的没有看到任何简单的例子。我应该包括任何其他方法`setEditing:animated:`或`tableView: commitEditingStyle: forRowAtIndexPath:`方法来做到这一点吗？

*   第二件事是，在动画（单元格插入）发生之前，我想将 tableview 移动到第 2 节（即“显示”单元格）到顶部。然后应该发生插入单元格的动画。因此，单击显示单元格后表格的最终外观应该像..

![在此处输入图像描述](../Images/29f9406dd1ad5472b0521b1dde5f26c2.png)

需要帮助..我只是困惑！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:39:09.623

[对于第一部分，您可以查看Table View Programming Guide for iOS](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/tableview_iphone/ManageInsertDeleteRow/ManageInsertDeleteRow.html)下的“批量插入、删除和重新加载行和节”部分。最重要的是您需要确保您的数据源与更改相匹配。

对于第二个问题，您可以将`contentOffset`table view 设置为第二节标题的原点。就像是：

```
self.tableView.contentOffset = CGPointMake(0, [self.tableView rectForSection:1].origin.y); 
```

如果您想使用动画来获得更好的 UE，只需执行

```
[UIView animateWithDuration:duration animations:^{
    //Move table view to where you want
} completion:^(BOOL finished){
    //insert rows when table view movement animation finish
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:46:34.417

尝试 `UIView CommitAnimation`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:46:19.630

不要吹毛求疵，但为了语法正确，“hidedArray”应该真的是“hiddenArray”。无论如何，我认为您不需要为隐藏项目设置单独的数组。例如，假设您正在使用“dataArray”来填充表格视图。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
{
   ...

     if ((indexpath.section == 1) && (indexpath.row == 0)) {
          if (isShowClicked) {
            cell.textLabel.text = @"Hide";
            cell.selectionStyle = UITableViewCellSelectionStyleBlue;
            cell.textLabel.textAlignment=UITextAlignmentCenter;
           } else {
            cell.textLabel.text = @"Show";
            cell.selectionStyle = UITableViewCellSelectionStyleBlue;
            cell.textLabel.textAlignment=UITextAlignmentCenter;
           }
      }
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
{
  if ((indexpath.section == 1) && (indexpath.row == 0) && (isShowClicked == NO)) {
    isShowClicked = YES;
    [self.tableView beginUpdates];
    [dataArray addObjectsFromArray:[NSArray arrayWithObjects:@"cell1",@"cell2",@"cell3",@"cell4",@"cell5",@"cell6", nil]];
    NSArray *paths = [NSArray arrayWithObject:[NSIndexPath indexPathForRow:[dataArray count]-1 inSection:1]]; 
    //the first section is section 0, so this is actually the second one
    [[self tableView] insertRowsAtIndexPaths:paths withRowAnimation:UITableViewRowAnimationFade];
    [tableView endUpdates];
    showIsClicked = YES;
    self.tableview.contentOffset = xy; 
   //the value of the tableView's contentOffset when it is scrolled to the right position. You can get it by NSLog-ing the contentOffset property and scrolling to the desired position
   } else if ((indexpath.section == 1) && (indexpath.row == 0) && (isShowClicked == YES)) {
    isShowClicked = NO;
    [self.tableView beginUpdates];
        [array removeObjectsAtIndexes:[NSIndexSet indexSetWithIndexesInRange:NSMakeRange(indexpath.row + 1, 6)]];

    [tableView endUpdates];
    self.tableview.contentOffset = xy; 
   //the value of the tableView's contentOffset when it is scrolled to the right position. You can get it by NSLog-ing the contentOffset property and scrolling to the desired position
   }
} 
```

可能有一些错误，但我认为它大部分是正确的。

# c# - 了解运行对象表

> ID：11835617
> 
> 赞同：9
> 
> 时间：2012-08-06T20:40:57.630
> 
> 标签：c#, com, interop

我正在尝试使用正在运行的对象表来获取 DTE 一个特定的 Visual Studio 实例。我打算使用[MSDN](http://msdn.microsoft.com/en-us/library/ms228755%28v=vs.80%29.aspx)上描述的技术。我设法列出了其中一个实例，但没有列出其他实例。

```
public static void PrintRot()
{
    IRunningObjectTable rot;
    IEnumMoniker enumMoniker;
    int retVal = GetRunningObjectTable(0, out rot);

    if (retVal == 0)
    {
        rot.EnumRunning(out enumMoniker);

        IntPtr fetched = IntPtr.Zero;
        IMoniker[] moniker = new IMoniker[1];
        while (enumMoniker.Next(1, moniker, fetched) == 0)
        {
            IBindCtx bindCtx;
            CreateBindCtx(0, out bindCtx);
            string displayName;
            moniker[0].GetDisplayName(bindCtx, null, out displayName);
            Console.WriteLine("Display Name: {0}", displayName);
        }
    }
}

[DllImport("ole32.dll")]
private static extern void CreateBindCtx(int reserved, out IBindCtx ppbc);

[DllImport("ole32.dll")]
private static extern int GetRunningObjectTable(int reserved, out IRunningObjectTable prot); 
```

结果如下：

```
Display Name: !VisualStudio.DTE.11.0:7120
Display Name: clsid:331F1768-05A9-4DDD-B86E-DAE34DDC998A:
Display Name: !{7751A556-096C-44B5-B60D-4CC78885F0E5}
Display Name: c:\users\dave\documents\visual studio 2012\Projects\MyProj\MyProj.sln
Display Name: !{059618E6-4639-4D1A-A248-1384E368D5C3} 
```

我希望看到 VisualStudio.DTE 的多行我做错了什么？我应该期待看到什么？

**编辑：**

这似乎与应用程序是否运行提升的权限有关。如果我保持一致并使用正常模式，那么它可以工作。但是，我希望它能够正常工作，如何获得所有进程的 ROT？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-06T21:52:51.150

您是否正在运行另一个提升的实例？你在运行提升的exe吗？

当您是作为标准用户运行的进程时，您只能看到属于您的进程/等。所以你不会看到以管理员身份运行的进程。

以提升的权限运行时，您可以看到属于所有用户的所有进程。

理想情况下，一切都将始终作为“最低权限用户”运行，请参阅[http://en.wikipedia.org/wiki/Principle_of_least_privilege](http://en.wikipedia.org/wiki/Principle_of_least_privilege)

# vb.net - 空字段或空字段的 Linq 测试

> ID：11835619
> 
> 赞同：0
> 
> 时间：2012-08-06T20:41:00.800
> 
> 标签：vb.net, linq, linq-to-entities

这是我尝试过的

```
Dim B = (From r In _db.Personnel _
         Where !(r.BldgDist.Trim() = String.Empty) _
         Order By r.BldgDist _
         Select r.BldgDist).ToList().Distinct()
For Each ab In B
    list.Add(New ListItem(ab.BldgDist, ab.BldgDist))
Next 
```

但是在爆炸时它告诉我需要一个标识符。不确定我是否理解缺少的内容。我只是想在加载到列表之前消除空值和空字符串值。

任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:45:30.807

VB.Net 无法识别`!`，但您可以使用`<>`or`Not`运算符。

```
Dim B = (From r In _db.Personnel _
     Where (r.BldgDist.Trim() <> String.Empty) _
     ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T20:45:01.857

[`!`](http://msdn.microsoft.com/en-us/library/f2kd6eb2)是 C# 运算符，而不是 VB。改用[`Not`](http://msdn.microsoft.com/en-us/library/2cwcswt4.aspx)（或[`<>`](http://msdn.microsoft.com/en-us/library/cey92b0t)）。例如：

```
Where Not (r.BldgDist.Trim() = String.Empty) 
```

或者

```
Where r.BldgDist.Trim() <> String.Empty 
```

# google-maps - Google Maps API - 获取街道坐标

> ID：11835623
> 
> 赞同：11
> 
> 时间：2012-08-06T20:41:08.623
> 
> 标签：google-maps, google-maps-api-3

`Google Maps API`有什么方法可以获取某个位置的街道坐标吗？

很简单：我只想获得最近的街道坐标。例如，为了得到这个，我需要构成街道的所有坐标。

有这样的事情吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-07T09:04:27.623

您可以使用directionService。

将给定的地址（或位置）作为起点**和**终点传递`directionsService.route()`给 travelMode 并使用`DRIVING`。响应应包含最近的街道。

演示：http: [**//jsfiddle.net/doktormolle/W3VGN/**](http://jsfiddle.net/doktormolle/W3VGN/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-10-25T15:31:24.383

我发现了这个（v3 中的 ReverseGeocoding）：[https ://developers.google.com/maps/documentation/javascript/geocoding#ReverseGeocoding](https://developers.google.com/maps/documentation/javascript/geocoding#ReverseGeocoding)

由于这个线程很旧，我想这可能很有用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-12-27T02:11:47.537

这些答案都是旧的，自答案以来，谷歌已经对地图 API 进行了重大重新排列。在 2018 年，将位置（经纬度）转变为“道路上的点”的最佳方式是使用 snap-to-road 或最近道路服务： [https ://developers.google.com/maps/文件/道路/快照](https://developers.google.com/maps/documentation/roads/snap)

请注意，此 API 对每个 API 调用收取一分钱，并且每次调用最多可占用 100 个不同的点。如果延迟和复杂性不是问题，如果您需要在客户端上回答这个问题，您可以构建一个服务器来收集来自不同客户端的多达 100 个请求，向 Google 发出一个请求，然后将请求数据返回给合适的客户。（对于这种用途，请确保使用最近的道路，而不是快速到道路。）

此外，目前，Google Maps 每月提供 200 美元的报表信用额度，这可能会使该 API 的较小使用量实际上最终不会花费太多（或任何东西）。

# javascript - 在 Three.js 中恢复旋转

> ID：11835626
> 
> 赞同：2
> 
> 时间：2012-08-06T20:41:15.970
> 
> 标签：javascript, three.js

我正在使用 Three.js，我希望能够从场景中取出一个对象，然后用一个新对象替换它，但旋转与我删除的对象相同。

我记下要移除的对象的旋转，然后使用此函数设置新对象的旋转：

```
rotateToWorldAxis  = function(object, xradians, yradians, zradians)  {
  axisX = new THREE.Vector3(0, 1, 0);
  axisY = new THREE.Vector3(1, 0, 0);
  axisZ = new THREE.Vector3(0, 0, 1);

  rotationMatrix = new THREE.Matrix4();
  rotationMatrix.setRotationAxis(axisX.normalize(), xradians)
  object.matrix = rotationMatrix;
  object.rotation.setRotationFromMatrix(object.matrix);

  rotationMatrix = new THREE.Matrix4();
  rotationMatrix.setRotationAxis(axisY.normalize(), yradians);
  rotationMatrix.multiplySelf(object.matrix);
  object.matrix = rotationMatrix;
  object.rotation.setRotationFromMatrix(object.matrix);

  rotationMatrix = new THREE.Matrix4();
  rotationMatrix.setRotationAxis(axisZ.normalize(), zradians);
  rotationMatrix.multiplySelf(object.matrix);
  object.matrix = rotationMatrix;
  object.rotation.setRotationFromMatrix(object.matrix);
} 
```

x 和 y 旋转工作得很好，但 z 旋转并没有给出想要的结果。

如果有人能发现我做错了什么，或者我应该以另一种方式做，我将不胜感激？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T00:06:37.987

做这个：

```
object.rotation.set( xradians, yradians, zradians ); 
```

在哪里`xradians = oldObject.rotation.x`等...

`object.matrixAutoUpdate`此外，除非您更改了它，否则默认值为`true`，因此您无需`object.matrix`直接设置。-- 只需设置旋转。该`render()`调用将为您更新矩阵。

# c# - 电子邮件的唯一标识是什么？

> ID：11835629
> 
> 赞同：16
> 
> 时间：2012-08-06T20:41:35.227
> 
> 标签：c#, email, exchange-server, uniqueidentifier

我正在尝试找到保证的唯一标识符来区分电子邮件。目前，我正在编写一个连接到 Microsoft Exchange 的应用程序，但是我希望能够支持其他电子邮件服务。

我*认为*唯一标识符是[`EmailMessage.InternetMessageId`](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.internetmessageid(v=exchg.80).aspx)，并且该属性使用**PR_ENTRYID**，但我找不到任何文档来支持这一点。

是否所有电子邮件都有唯一标识符，并且（在 Exchange 中）是 InternetMessageId 吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-06T20:49:30.730

没有保证电子邮件的唯一 ID，Message-ID 与您来的时候差不多。您实际上可以期望的最好结果是服务器独有的……甚至这取决于邮件服务器的类型及其功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-06T20:53:39.997

我想这是永远不会 100% 保证的事情。我的意思是这个数字来自特定的 RFC 文档在一段时间内开发并正式描述的特殊电子邮件标头。有时它可能是由 Exchange 等特殊服务提供的特殊信息（您在问题中引用的内容）。即使我不能给你一个真正完整的答案，我可以肯定地告诉你，你应该意识到你不能保证唯一性。为了进一步阅读，我在 Internet 邮件消息的抽象域中找到了与上述标头相关的一个有趣的答案：[“邮件 ID”电子邮件标头对于每个收件人是否唯一？](https://stackoverflow.com/questions/831183/is-the-message-id-email-header-unique-for-each-recipient)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-14T10:50:25.570

如何使用`hash function`可以产生`unique` `hash`考虑电子邮件消息的某些元素的。IE`GetEmailHash(dateTimeReceived+sender+subject+body)`

# java - 用新的检查异常覆盖 Java 接口

> ID：11835633
> 
> 赞同：5
> 
> 时间：2012-08-06T20:41:46.350
> 
> 标签：java, exception, exception-handling, interface, overriding

假设在 Java 中，我使用的是一个相当通用的预先存在的接口

```
public interface Generator {
    public String generate();
} 
```

我有自己的课

```
public class FromFileGenerator implements Generator {
    ...
    public String generate() throws FileNotFoundException {
        String output = //read from some file
        return file;
    }
} 
```

Java 编译器对我大喊大叫，因为 generate() 的实现包含原始签名中未指定的异常 (FileNotFoundException)。但是，显然异常不属于接口，但在实现类中也不容忽视。如果不只是默默地失败，如何解决这个问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-06T20:43:48.147

您不能将已检查异常添加到隐藏、覆盖或实现另一个方法的方法的声明中。您将需要在方法中捕获异常并对其执行其他操作（例如 return`null`或抛出未经检查的异常，可能包装已检查的异常）。

来自[Java 语言规范，第 8.4.8.3 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.4.8.3)：

> 覆盖或隐藏另一个方法的方法，包括实现接口中定义的抽象方法的方法，可能不会被声明为抛出比被覆盖或隐藏的方法更多的检查异常。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-06T20:45:37.723

接口是一个**契约**。

![在此处输入图像描述](../Images/fc72e68a5502a78c2c4ca4ffda8b3c93.png)

所以你需要预先定义。

因此，您可以尝试一下，在方法体中捕获或修改合同。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-06T20:44:35.193

不幸的是，没有办法很好地解决它：异常规范是接口的一部分，所以如果为你的`Generator`接口编程的人不希望看到`FileNotFoundException`，那么当他们使用`FromFileGenerator`.

解决它的一种常见方法是引入一个常见的异常，并将其包装`FileNotFoundException`起来：

```
public class GeneratorException extends Exception {
    public GeneratorException(Exception inner) {
        super(inner);
    }
}
public interface Generator {
    public String generate() throws GeneratorException;
}
public class FromFileGenerator implements Generator {
...
    public String generate() throws GeneratorException {
        try {
            String output = //read from some file
            return file;
        } catch (FileNotFoundException fnf) {
            throw new GeneratorException(fnf);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-06T20:45:37.140

您可以将实现异常包装在未经检查的异常中并抛出：

```
public class FromFileGenerator implements Generator {
    ...
    public String generate() {
        try {
            String output = //read from some file
            return file;
        } catch (IOException ioe) {
            throw new RuntimeException(ioe);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-08-06T20:48:33.747

一个常见的解决方案是将异常包装在未经检查的异常中。所以你的班级可能看起来像：

```
public class FromFileGenerator implements Generator {
    ...
    public String generate() throws FileNotFoundException {
        try {
            String output = //read from some file
            return output
        } catch (FileNotFoundException e) {
            throw new IllegalStateException(e);
        }
    }
} 
```

更好的是更改接口以拥有自己的已检查异常。然后，您可以将 FileNotFoundException 转换为已检查的异常，方法与转换为上面未检查的 IllegalStateException 的方式相同。

# jquery - ASP.NET VB JQuery DIM 基于变量值的 div

> ID：11835635
> 
> 赞同：0
> 
> 时间：2012-08-06T20:42:00.267
> 
> 标签：jquery, asp.net, vb.net

我需要根据会话对象值“暗淡”一个 div。

将会话对象声明为模块`Global.asax.vb`

```
Module SelectedItem
    Public SelItemID As Integer
End Module 
```

现在我需要检查该变量是否具有值，如果它没有组成我的菜单的几个 div 应该变暗。现在`menuButton1`应该始终可用，如果提到的变量没有价值，其他人应该变暗。

```
<div class="menu">
    <div class="menuButton1">
    </div>
    <div class="menuButton2"> //should be dimmed if SelItemID = null
    </div>
    <div class="menuButton3"> //should be dimmed if SelItemId = null
    </div>
</div> 
```

如果它有价值，它们应该看起来很正常。我意识到使用 JQuery 应该很容易，但我不知道如何与 VB 结合使用。

更多信息。我`SelItemID`在页面上的标签中显示。也许我可以检查那个标签的价值或什么？

如果可能，请提供帮助。

谢谢。

编辑：

好的，所以我想到了一种更简单的方法，只需要一些帮助来完成它。

```
<%IIf(lbSelItem.Text = "No Item Selected.", "<a href='Default.aspx'>&nbsp;My Item&nbsp;</a>", "My Item")%> 
```

基本上我希望它在真时显示常规文本，如果为假则显示链接。注意：标签`lbSelItem`显示`"No Item Selected"`未选择任何项目的字符串值。此代码的问题是它不显示任何内容。链接和文字都没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T02:02:31.043

Feeling so silly now. For reference if someone perhaps gets a brain-glitch like me.

In these cases just use this.

```
<% If lbSelProj.Text = "No Items Selected." Then %>
    My Items                                             // this will show if not selected
<%Else%>
    <a href="Default.aspx" >&nbsp;My Item&nbsp;</a>      // this will show if selected
<% End If%> 
```

Pretty simple eh... Thank you, MrOBrian for making me realize my mistake.

# php - 严格标准：只能通过引用传递变量 - php错误

> ID：11835636
> 
> 赞同：5
> 
> 时间：2012-08-06T20:42:02.530
> 
> 标签：php, variables, standards, strict

```
 $file_name = $_FILES['profile_image']['name'];
    $file_ext = end(explode('.', $file_name)); //line 10
    $file_ext = strtolower($file_ext);
    $file_temp = $_FILES['profile_image']['tmp_name']; 
```

严格标准：第 10 行中仅应通过引用传递变量

我该如何摆脱这个错误？谢谢，麻烦您了 ：）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-06T20:43:36.117

`end()`期望其参数能够通过引用传递，并且只有变量可以通过引用传递：

```
$array = explode('.', $file_name);
$file_ext = end( $array); 
```

您可以通过先将数组保存到变量中来解决此问题，然后调用`end()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:44:44.587

如果您想要数组中的最后一项，请执行以下操作：

```
$arr = explode(".", $file_name);
$file_ext = $arr[count($arr) - 1]; 
```

如果您试图从文件中获取扩展名，请使用

```
$ext = pathinfo($file_name, PATHINFO_EXTENSION); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-09T02:01:23.140

实际上，如果你写 $ext = end(explode('.', $filename)); 为了获取文件扩展名，可以在 php.ini 中显示“只能通过引用传递变量”。出于这个原因，尝试分两步使用它，例如： $tmp = explode('.', $filename); $ext = 结束（$tmp）；

# android - 如何在移动设备上的 Django 中提供动态 pdf

> ID：11835638
> 
> 赞同：0
> 
> 时间：2012-08-06T20:42:10.140
> 
> 标签：android, django, pdftk

使用`pdftk`我生成一些动态的临时 pdf 文件，然后 Django 将其提供给用户。

在桌面上，它工作正常 - pdf文件打开，然后用户可以保存，但是在所有浏览器的我的android手机上（可能在iOS上相同，但没有iOS设备所以无法测试），pdf确实没有下载成功。它开始下载，但总是失败，我不知道为什么。

以下是生成 pdf 二进制数据的视图和函数的片段：

```
def get_pdf():
    fdf = {...}
    t1 = tempfile.NamedTemporaryFile(delete=False)
    t2 = tempfile.NamedTemporaryFile(delete=False)
    t1.file.write(fdf)

    # close temp files for pdftk to work properly
    t1.close()
    t2.close()

    p = Popen('pdftk %s fill_form %s output %s flatten' %
              ('original.pdf', t1.name, t2.name), shell=True)
    p.wait()

    with open(t2.name, 'rb') as fid:
        data = fid.read()

    # delete t1 and t2 since they are temp files

    # at this point the data is the binary of the pdf
    return data

def get_pdf(request):
    pdf = get_pdf()

    response = HttpResponse(pdf, mimetype='application/pdf')
    response['Content-Disposition'] = 'filename=foofile.pdf'
    return response 
```

关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T22:47:08.110

根据@Pascal 评论，我添加`Content-Length`了下载，现在可以在移动设备上使用。

但是，它没有以我在视图中分配的文件名下载。添加`attachment`修复此问题，但我不希望`attachment`桌面浏览器出现。因此，以下是我的最终解决方案。

```
# I am using the decorator from http://code.google.com/p/minidetector/
@detect_mobile
def event_pdf(request, event_id, variant_id):
    pdf = get_pdf()

    response = HttpResponse(pdf, mimetype='application/pdf')
    response['Content-Disposition'] = '%sfilename=foofile.pdf' %
        request.mobile and 'attachment; ' or ''
    response['Content-Length'] = len(pdf)
    return response 
```

# sql - 获取插入的行以更新另一个表

> ID：11835643
> 
> 赞同：0
> 
> 时间：2012-08-06T20:42:45.400
> 
> 标签：sql, sql-server

我有一个表，它存储需要插入另一个数据库的记录。插入这些值后，我需要将这些记录标记为已处理，以防止它们被重新处理。

```
DECLARE @InsertedValues TABLE (
    [ITEMNMBR] nchar(31),
    [ITEMDESC] nchar(101),
    [ITMSHNAM] nchar(15),
    [ITMGEDSC] nchar(11),
    [UOMSCHDL] nchar(11),
    [ALTITEM1] nchar(31),
    [ALTITEM2] nchar(31),
    [USCATVLS_1] nchar(11),
    [USCATVLS_2] nchar(11),
    [USCATVLS_3] nchar(11),
    [USCATVLS_6] nchar(11),
    [ABCCODE] int,
    [ROW_ID] int
)

-- INSERT NEW INVENTORY ITEMS INTO DB
INSERT INTO TABLE1..IV00101 (ITEMNMBR,ITEMDESC,ITMSHNAM,ITMGEDSC,UOMSCHDL,ALTITEM1,ALTITEM2,USCATVLS_1,USCATVLS_2,USCATVLS_3,USCATVLS_6,ABCCODE)
OUTPUT          
    INSERTED.[ITEMNMBR],
    INSERTED.[ITEMDESC],
    INSERTED.[ITMSHNAM],
    INSERTED.[ITMGEDSC],
    INSERTED.[UOMSCHDL],
    INSERTED.[ALTITEM1],
    INSERTED.[ALTITEM2],
    INSERTED.[USCATVLS_1],
    INSERTED.[USCATVLS_2],
    INSERTED.[USCATVLS_3],
    INSERTED.[USCATVLS_6],
    INSERTED.[ABCCODE],
    U.[ROW_ID] INTO @InsertedValues
SELECT U.[ITEMNMBR],U.[ITEMDESC],U.[ITMSHNAM],U.[ITMGEDSC],U.[UOMSCHDL],U.[ALTITEM1],U.[ALTITEM2],U.[USCATVLS_1],U.[USCATVLS_2],U.[USCATVLS_3],U.[USCATVLS_6],U.[ABCCODE]
FROM 
    DYNAMICS..TABLE2 AS U
WHERE 
    U.[ProcessedFlag] = 0 AND 
    U.[Action] = 'I' AND 
    U.[DestinationCompany] = 'COMPANY1' AND
    U.[DestinationTable] = 'IV00101' 
```

就目前而言，此查询不起作用，因为它抱怨 OUTPUT 语句中的 U.[ROW_ID] 列是有道理的。所以我的问题是，如何获取插入的行以便我可以运行以下查询？

```
UPDATE DYNAMICS..TABLE2
SET [ProcessedFlag] = 1, [ProcessedDateTime] = GETDATE()
FROM @InsertedValues AS U
    INNER JOIN DYNAMICS..TABLE2 AS R ON U.[ROW_ID] = R.[ROW_ID] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:56:01.217

使用标准 SQL 无法获得更新的行数，但可能任何数据库都允许这样做。如果您不知道您使用的是什么 RDBMS 以及您从哪里调用 SQL 指令，那么帮助您并不容易。我的意思是在什么 db 客户端应用程序或您正在使用 T-SQL、PL-SQL、pgplsql、java、PHP、c/c++、c#、VB 或您应该说的任何语言开发的应用程序上执行的脚本，可能使用 db -library 你也应该说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:02:47.820

```
UPDATE DYNAMICS..TABLE2
SET [ProcessedFlag] = 1, [ProcessedDateTime] = GETDATE()
WHERE
    DYNAMICS..TABLE2.[ProcessedFlag] = 0 AND 
    DYNAMICS..TABLE2.[Action] = 'I' AND 
    DYNAMICS..TABLE2.[DestinationCompany] = 'COMPANY1' AND
    DYNAMICS..TABLE2.[DestinationTable] = 'IV00101' 
```

只需更新您首先选择的同一组记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T22:07:22.740

我会考虑使用 eConnect，因为弄乱 GP 表不是一个好主意（尽管插入 IV00101 应该没问题，因为它是库存主...但仍然！）

你用的是什么版本的GP？GP10 和 GP2010 支持具有允许您插入库存项目的方法的 Web 服务，否则您可以使用 eConnect 并将 XML 文件提供给它将处理的 eConnect 入口点。它还提供验证和错误处理。如果需要，您也可以使用消息队列

您是否尝试从自己的持有表导入 GP 表或类似的东西？

我在工作的地方做了很多 GP 和整合工作:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T03:20:19.040

只是一个建议。当您有类似的场景时，您应该使用标识列。因为在那之后使用 `@@IDENTITY/SCOPE_IDENTITY()`变得非常容易。无论如何，如果该表没有同时进行多个插入，我建议您使用触发器，因为触发器有一些缺点。

# mysql - 在 MySQL 中的存储过程结束时删除临时表

> ID：11835645
> 
> 赞同：11
> 
> 时间：2012-08-06T20:42:46.897
> 
> 标签：mysql, temp-tables

`DROP TEMPORARY TABLE IF EXISTS data;`即使我在顶部有检查，我是否需要在存储过程的末尾添加？有性能影响吗？

```
CREATE DEFINER=`TEST`@`%` PROCEDURE `TEST`() BEGIN

    DROP TEMPORARY TABLE IF EXISTS data;

    CREATE TEMPORARY TABLE data AS 
...

END; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-06T20:48:57.590

在 MySQL 中，关闭数据库连接时会自动删除临时表。如果您打算在存储过程之后保持连接打开，那么您的临时表将存在于磁盘上，直到该连接关闭。性能影响取决于许多因素，例如您如何在服务器上配置临时表存储、表中有多少数据等。

完成临时表后立即删除它被认为是最佳做法。然后你就不用担心这些潜在的性能影响了

# c++ - 调度线程时的 void* 指针转换

> ID：11835646
> 
> 赞同：2
> 
> 时间：2012-08-06T20:42:47.753
> 
> 标签：c++, casting, pthreads, void-pointers

我有一个线程调用的函数。这个函数有一个唯一的参数，它是 queue::my_queue 。所以我需要在线程调用的方法中对 void 指针执行强制转换，如下所示：

```
void *AddPacket(void *Ptr) 
{     queue<int> my_queue = (queue*)Ptr ; 
       my_queue.push(byte) ; 
} 
```

总的来说，我这样做：

```
int main()
{   // do business
  pthread_create(&thread, NULL, &AddPacket, (void*)queue) ; 
} 
```

但两种转换都是错误的。

第一次转换导致错误：

请求'my_queue'中的成员'push'，它是非类类型'queue*'</p>

第二个：

从类型“队列”到类型“无效*”的无效转换</p>

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T20:48:01.797

您尝试将对象类型转换为指针类型。这个不允许。我猜你是 C++ 的新手，所以我在这里发布更正的代码来解开你的疑惑并让你继续前进，但请阅读一本关于 C++ 的书：

```
queue<int>* my_queue = (queue<int>*)Ptr ; 
my_queue->push(byte) ;

pthread_create(&thread, NULL, &AddPacket, &queue) ; 
```

记得阅读关于 C++ 的指针 :)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T20:46:43.307

尝试：

```
queue<int> *my_queue = (queue<int> *)Ptr ;
my_queue->push(byte) ;

pthread_create(&thread, NULL, &AddPacket, (void*)&queue) ; 
```

..无论如何，沿着这些思路

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T20:52:01.817

您需要同时更改线程函数和线程创建：

```
// thread entry point:
void *AddPacket(void *Ptr)
{
    reinterpret_cast<std::queue<int>*>(Ptr)->push(byte);
} 
```

```
// thread creation:

std::queue<int> q;
pthread_create(&thread, NULL, &AddPacket, &q);
//                                        ^^^^ **pointer** to "q";
//                                        conversion to void* is implied 
```

# html - 如何使用 svg 路径根据焦点坐标绘制椭圆？

> ID：11835647
> 
> 赞同：2
> 
> 时间：2012-08-06T20:42:51.017
> 
> 标签：html, svg, geometry

我有椭圆焦点的坐标。从一个焦点到椭圆边界到第二个焦点的距离等于轴之间总距离的 130%。 [http://www.w3schools.com/svg/svg_path.asp](http://www.w3schools.com/svg/svg_path.asp) 如何使用 svg 根据这些坐标绘制椭圆？或者任何非水平椭圆。不幸的是，在这种情况下我不能使用 svg Ellipse。

以下两个椭圆弧形成一个椭圆，但我不知道应该如何根据焦点操纵它们。

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
     <path d="M 125,75 a180,50 100 1,1 100,50" />
     <path d="M 125,75 a180,50 100 0,0 100,50" />
</svg> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:02:04.867

这两个焦点本身并没有定义一个椭圆，你需要一个更真实的参数。这可以从以下事实看出：人们可以通过在焦点周围缠绕一串*固定长度并用绘图笔保持嘲讽来绘制椭圆。*这是您缺少的字符串长度。所以你需要例如椭圆上的一个点，或类似的东西。

再给定一个参数和焦点之间的距离，您可以[计算](http://en.wikipedia.org/wiki/Ellipse#In_Euclidean_geometry)所有其他参数，例如长半轴和短半轴的长度，因为您需要它们用于路径规范。因此，例如，如果您有一个点应该位于椭圆上，那么您可以计算到两个焦点的距离，将这些长度相加，并知道总和等于 2 *a*，其中*a*是半长的长度轴。然后你得到半短轴的长度为*b* = sqrt( *a* ² - *f*  <sup>2)，其中 2 *f*是焦点之间的距离。

*既然你已经在你的问题中包含了 130% 的部分，我也可以给你一个计算。*
你有*一个*= 1.3 <i>f。从中你得到*b* = sqrt(1.3 ² - 1) *f* ≈ 0.83 <i>f。请注意，*f*仍然指的是焦点之间距离的*一半。*您还需要计算椭圆上的两个点。在主轴上选择这些是最容易的。所以如果*F*和*G*是你的焦点，那么你有*P* = ( *f* − *a* )/(2 *f* ) × *F* + ( *f* + *a* )/(2*f* ) × *G*作为椭圆上的一点，*Q* = ( *f* + *a* )/(2 *f* ) × *F* + ( *f* - *a* )/(2 *f* ) × *G*作为另一点。

一旦有了长半轴和短半轴的长度，就可以将它们用作svg 路径的[arc 命令](http://www.w3.org/TR/SVG11/paths.html#PathDataEllipticalArcCommands)`180,50`的半径参数，在您的示例中，它们是前两个参数。您可以使用或类似方法从连接焦点的线的斜率计算旋转`atan2`，并将其用作第三个参数而不是`100`. 任意设置大弧标志（例如 0），任意设置扫描标志，但椭圆的两半相等（例如 0）。所有这些术语均参考 SVG 1.1 规范中的[描述](http://www.w3.org/TR/SVG11/paths.html#PathDataEllipticalArcCommands)。移动到*P*，用我刚才描述的参数做一个圆弧指向*Q*，另一个圆弧回到*P*。

结果应该是与您的参数匹配的完整椭圆。 *两条弧线的组合是在后来的编辑中编写的。*

# .net - Magento WSDL URL 被重定向到管理页面

> ID：11835653
> 
> 赞同：1
> 
> 时间：2012-08-06T20:43:12.577
> 
> 标签：.net, api, magento, wsdl

我有一个 .NET 应用程序，我正在尝试通过指定 production.mydomain.com/api/v2_soap?wsdl 来添加对 Magento Web 服务的 Web 引用，并且在我的 app.config 文件中我可以看到该引用写为管理器。 mydomain.com/index.php/api/v2_soap/index/。

当我浏览 manager.mydomain.com/index.php/api/v2_soap/index/ 时，系统会提示我登录，因为它会将我带到 Magento 管理页面。

但是，当我通过指定 dev.mydomain.com/api/v2_soap?wsdl 添加对 Magento Web 服务的 Web 引用时，app.config 文件引用写为 dev.mydomain/index.php/api/v2_soap/index/。这是因为我的 .NET 应用程序可以看到 WSDL 定义的方法。

在第一种情况下，我收到一个错误，例如 - Redirection limit reached, aborting#0 [internal function]: SoapClient->_ *doRequest('* _call('login', Array).

对于开发环境，base_url 与我用来访问 web 服务器的 URL 相同，即 dev.mydomain.com/

对于生产环境，base_url 定义为 manager.mydomain.com/

有没有人遇到过这个？我需要改变什么？这是 Magento 配置问题还是 Apache 配置问题？

在我看来，Magento 正在将 production.mydomain.com 的 URL 重写为 manager.mydomain.com

# oembed - 如何测试 oEmbed 发现

> ID：11835655
> 
> 赞同：11
> 
> 时间：2012-08-06T20:43:33.200
> 
> 标签：oembed

我知道您可以使用[embed.ly](http://embed.ly)来测试您的 oEmbed 提供程序服务，但是您知道可以测试[oEmbed 发现](http://oembed.com/#section4)的任何其他服务吗？

我想确保启用 oEmbed 的消费者可以正确接入我的 oEmbed 提供程序，但我找不到这样做的方法。

任何帮助或建议表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T02:49:57.190

你可以试试[drupal oEmbed client/provider](https://github.com/voxpelli/drupal-oembed)。使用客户端对其进行测试。

编辑：如果上面的链接不起作用，请尝试[这个](https://github.com/voxpelli/drupal-oembed)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2022-02-03T20:56:24.013

iframely 为 oembed 发现机制提供了一个很棒的调试器：http: [//debug.iframely.com/](http://debug.iframely.com/)

# mysql - SQL 语法和 SQL Server 版本错误

> ID：11835663
> 
> 赞同：0
> 
> 时间：2012-08-06T20:44:08.677
> 
> 标签：mysql, syntax

我对这段代码有疑问：

```
$comments->query = "SELECT " . PREFIX . "_comments.id, post_id, " . PREFIX . "_comments.user_id, " . PREFIX . "_comments.date, " . PREFIX . "_comments.autor as gast_name, " . PREFIX . "_comments.email as gast_email, text, ip, is_register, name, " . USERPREFIX . "_users.email, news_num, " . USERPREFIX . "_users.comm_num, user_group, lastdate, reg_date, signature, foto, fullname, land, yahoo, " . USERPREFIX . "_users.xfields, " . PREFIX . "_post.title, " . PREFIX . "_post.date as newsdate, " . PREFIX . "_post.alt_name, " . PREFIX . "_post.category FROM " . PREFIX . "_comments LEFT JOIN " . PREFIX . "_post ON " . PREFIX . "_comments.post_id=" . PREFIX . "_post.id LEFT JOIN " . USERPREFIX . "_users ON " . PREFIX . "_comments.user_id=" . USERPREFIX . "_users.user_id " . $where . " ORDER BY id desc"; 
```

**错误：**

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'ON dle_comments.post_id=dle_post.id LEFT JOIN dle_users ON dle_comments.user_id=' at line 1 
```

编辑：

```
SELECT 
  dle_comments.id, post_id, 
  dle_comments.user_id, 
  dle_comments.date, 
  dle_comments.autor as gast_name, 
  dle_comments.email as gast_email, 
  text, ip, is_register, 
  group_concat(mid) as `awards`, 
  name, dle_users.email, news_num, 
  dle_users.comm_num, user_group, 
  lastdate, reg_date, signature, 
  foto, fullname, land, icq, 
  dle_users.xfields, dle_post.title, 
  dle_post.date as newsdate, dle_post.alt_name, dle_post.category 
FROM 
  dle_comments 
  LEFT JOIN dle_awards 
    ON uid = dle_post 
    ON dle_comments.post_id=dle_post.id 
  LEFT JOIN dle_users 
    ON dle_comments.user_id=dle_users.user_id 
ORDER BY id desc 
LIMIT 0,30 
```

**我的 SQL 版本：5.5.20**

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:05:04.487

您有一个紧跟在另一个 ON 子句之后的 ON 子句。根据第二个中指定的表/列，您似乎缺少一个 JOIN 到 dle_post 那里：

```
-- existing:
LEFT JOIN dle_awards ON uid = dle_post ON dle_comments.post_id=dle_post.id 
-- becomes:
LEFT JOIN dle_awards ON uid = dle_post LEFT JOIN dle_post ON dle_comments.post_id=dle_post.id 
```

当然，这可能需要调整，因为它看起来不像 dle_post （在第一个 ON 子句中）实际上是有效的。我需要查看架构才能知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:05:26.093

```
... ON uid = dle_post LEFT JOIN ON dle_comments.post_id=dle_post.id ... 
```

在两个“ON”子句之间添加上面的 LEFT JOIN

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T21:28:26.910

您的查询中的错误是预期的。您在错误指向的查询中有多余的 ON 。

看看错误在哪里：

选择 dle_comments.id, post_id, dle_comments.user_id, dle_comments.date, dle_comments.autor as gast_name, dle_comments.email as gast_email, text, ip, is_register, group_concat(mid) as `awards`, name, dle_users.email, news_num, dle_users.comm_num , user_group, lastdate, reg_date, signature, foto, fullname, land, icq, dle_users.xfields, dle_post.title, dle_post.date as newsdate, dle_post.alt_name, dle_post.category FROM
**dle_comments LEFT JOIN dle_awards**
***ON uid = dle_post ON dle_comments。 post_id=dle_post.id***
LEFT JOIN dle_users ON dle_comments.user_id=dle_users.user_id ORDER BY id desc LIMIT 0,30

=============
当做联结时，请参阅正确的语法... from TABLE1 LEFT JOIN TABLE2 ON TABLE1.columnName=TABLE2.columnName。因此，在斜体块的两个连续 ON 中删除一个，并从 dle_comments 中指定一列，从 dle_awards 中指定另一列以用于剩余的 ON 部分。

# java - 我看不到更改，即使可重新加载在 Eclipse 中也是如此

> ID：11835671
> 
> 赞同：0
> 
> 时间：2012-08-06T20:44:47.797
> 
> 标签：java, eclipse, tomcat, reloadable

嗨，我正在使用 eclipse，并且正在尝试使用 servlet 做一些事情。

为什么在 Eclipse 中当我在更改后运行文件时，即使我将 reloadable 设置为 true，我也看不到更改？我有一个扩展 HttpServlet 的类，在 doGet 方法中我只打印出“Hello World！” 当我进行一些更改时，我尝试重新运行它，一切都像第一次一样。我正在使用 Apache Tomcat 7。

有没有办法解决它？

```
<Context reloadable="true"> 
</Context> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:51:12.363

您需要从头开始构建。执行以下操作：
1\. 重新启动服务器（tomcat）
2\. 使用 eclipse 菜单转到 Project=>clean 这将清除以前的输出

# php - 像 Facebook 这样的网站如何处理对象关系？

> ID：11835672
> 
> 赞同：2
> 
> 时间：2012-08-06T20:44:52.623
> 
> 标签：php, web-applications

我正在尝试使用一些更高级的 Web 开发技术，并考虑了一些需要对象关系的项目。我正在使用 PHP 进行开发，并计划使网站完全面向对象。

像 Facebook 这样的网站在用户、朋友、群组、事件、喜欢、帖子、评论等之间存在关系。一个用户可以属于一个组或多个组，一个组可以有多个用户。对于事件、喜欢、帖子、评论等，这种关系也是如此。所以我的问题是如何处理和保存这些关系？

显然有一个非常复杂的数据库来保存实际内容，但是在定义诸如“哪个用户属于哪个组？”之类的关系时，这是如何处理的？是否所有组都具有唯一标识，例如哈希或 ID 号？然后用户有一个“mygroups”数组或这样的数组，它继续添加/删除组 ID，这些 ID 使用户成为组的一部分。

我可能偏离了轨道，但对我的问题有任何启发都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:55:58.980

更熟悉该主题的人可能会对此有所了解，但是是的，您是对的：每个组、用户等都有一个唯一的 ID。用户和组之间的关系以及朋友关系都存在于关系数据库的表中。

我会说数据库可能没有您想象的那么复杂。如果用户有用户 ID，那么友谊可以在友谊表中表示，例如：

```
Friendship table
----------------
  UserID | FriendID
  User_A | Friend_1
  User_A | Friend_2
  etc... 
```

团体会员：

```
 Groupmembership table
  GroupID | UserID
   GroupA | User1
   GroupA | User2
   etc... 
```

我并不是说您应该这样做，但这是一种可能的解决方案：使用常规关系数据库。

对于 Facebook，真正的复杂性可能在于优化其庞大数据库的性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T20:57:03.447

让我们举个例子。用户和组。

这是一个多对多的关系。这意味着一个用户可以在 0 个或多个组中，一个组可以有一个或多个用户

所以会有3张桌子

**用户表**

```
USER_ID (INT) Primary Key
USER_NAME V(VARCHAR) 
```

**组表**

```
GROUP_ID (INT) Primary Key
GROUP_NAME (INT) 
```

**USER_GROUP**

```
USER_GROUP_ID (INT) Primary Key
GROUP_ID (INT) Foriegn Key (to GROUP Table, GROUP_ID Column)
USER_ID (INT) Foriegn Key (to USERTable, USER_ID Column) 
```

一些样本数据会像

**用户**

```
 USER_ID              USER_NAME
 --------------------------------
 1                    Scott
 2                    Jon
 3                    Mike 
```

**团体**

```
 GROUP_ID              GROUP_NAME
 --------------------------------
 161                    Bloggers
 162                    Geeks 
```

**USER_GROUP**

```
 USER_GROUP_ID   USER_ID              GROUP_ID
 ----------------------------------------------
   1                1                    161
   2                2                    161
   3                2                    162
   4                3                    161 
```

这表示

1) Scott、Jon 和 Mike 出现在 Bloggers 组中。

2) Scott 出席了 Geeks 小组。

# php - 为什么我的服务器在使用 Ajax 长拉时会死机？

> ID：11835675
> 
> 赞同：-4
> 
> 时间：2012-08-06T20:45:01.170
> 
> 标签：php, jquery

当我在 jQuery 上使用 Ajax 进行查询时，尝试使用长拉的方法，但我的服务器已关闭或没有响应，我的网站变得像 stanby 一样太慢，或者冻结了我该怎么办？

我的PHP；

```
session_start();
$chat=new chat;
$class=new tools;

$idenvia=isset($_GET['idenvia'])? $_GET['idenvia']: '';
$idreceptor=isset($_GET['idreceptor'])? $_GET['idreceptor']: '';
$cantidad= isset($_GET['cantidad'])? $_GET['cantidad']: '';
$control=$_GET['control'];
//$ultima_modif=isset($_SESSION['fecha'])?$_SESSION['fecha']:0;
if($control==1){
echo json_encode($chat->leer_chat($idreceptor,$idenvia,$control,$cantidad,NULL));
}
if($control==2){
$dir='log/log_'.$_SESSION['id'].'.txt';
$ultima_modif=filemtime($dir);  
$modifica_actual=isset($_GET['tiempo'])? $_GET['tiempo']: 0;//0
set_time_limit(0);
while($ultima_modif<=$modifica_actual){
    clearstatcache();
    $ultima_modif=filemtime($dir);
    sleep(1);

    //echo '{"0":{"activo":2}}';    
    //flush();
}

           $res=$chat->leer_chat($_SESSION['id'],NULL,$control,$ultima_modif);  
        echo json_encode($res); 
        //unlink($dir);
        flush();    

    } 
```

这是我的 JQUERY 代码，在这里我使用 AJAX 获取我的 php 的响应

```
 function leer_chat_interval(){
    $.ajax({
        url:enlace,
        type:'GET',
        async:true,
        data:{'control': 2,'tiempo':tiempo},
        success:function(dato){
            eval('var json='+dato);
                if(json[0].activo==1){
                    //if(json.length!=0){   
                        leer_chat(json[0].idenvia,json[0].idrecibe,1,json[0].nombre,json[0].mifoto,1,1);
                        $('#msg_chat'+json[0].idrecibe).attr('name',"{'recibe':'"+json[0].idenvia+"','envia':'"+json[0].idrecibe+"','foto':'"+json[0].mifoto+"'}");
                        setTimeout(function(){
                            $('#header_chat'+json[0].idenvia).css('background-color','#09C')
                            setTimeout(function(){
                                $('#header_chat'+json[0].idenvia).css('background-color','#F90')
                            },1000)
                        },1000);
                        tiempo=json[0].tiempo;
                        noerror=true;

                    }else{noerror=false;}
                },
        datatype:"json",        
        complete:function(dato){
                if(!noerror){
                setTimeout(function(){
                    leer_chat_interval()
                    },5000)
                }else{
                    leer_chat_interval();
                    noerror=false;

                    }
            },

            timeout:30000

        }); 

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:53:53.987

你的问题是这样的：

```
while(1) 
```

你不应该有一个无限循环的脚本来处理你的ajax“长轮询”；相反，每个 ajax 调用都通过一个有限的请求运行，收集结果并重复。您的示例中发生的情况是，每次触发 ajax 请求时，都会启动一个新的无限运行脚本；在积累了其中的几个之后，服务器自然会崩溃。

# jquery - HTMLBOX set_text 添加内部文本区域，get_text 不起作用

> ID：11835676
> 
> 赞同：0
> 
> 时间：2012-08-06T20:45:04.820
> 
> 标签：jquery, jquery-ui

我在 StackOverflow 上看到过与此类似的其他问题，但答案不是很有帮助，所以我再次发布。

Htmlbox文本区域文档不是很有帮助，在任何地方都没有太多帮助，所以我在这里问。

1\. Set_text 我尝试在我的 htmlbox 文本区域上动态设置文本，它在富文本区域内为每个添加的新文本创建新的文本区域。

我尝试了不同的方法，例如：

```
$("#textArea").htmlbox().set_text("Hello");      
$("#textArea").htmlbox({}).set_text("Hello"); 
```

或者

```
var textArea =  $("#textArea").htmlbox();
textArea.set_text("Hello"); 
```

所有人都做同样的事情，但它们是堆栈溢出中建议的选项。

2\. Get_text 另外我如何`<font size="2">Hello</font>`从 Htmltext 框中检索 html 文本。我试过`$("#textBox").htmlbox().get_text()`了，但它正在弹出一个说

```
您的浏览器不支持此富文本组件。
类型错误：iframe.contentWindow 为空
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T20:12:09.050

我终于找到了我的问题的答案。我需要在 javascript 文件中全局声明 textArea 变量，因为它每次实例化时都会渲染文本区域。现在 set 和 get 都工作正常。

这也适用于 FF，但 IE 抛出错误提示 innerHTML : null 或 undefined。这是因为 IE 不能很好地处理全局变量。这个问题的解决方案是在我的 javascript 文件中声明一个命名空间，并在命名空间中添加我所有的函数和变量。从这里得到帮助

[我应该使用全局变量吗？如果不使用，应该使用什么？(Javascript)](https://stackoverflow.com/questions/4190792/should-i-use-a-global-variable-and-if-not-what-instead-javascript?rq=1)

# iphone - 查找从现在到目标日期每天会出现多少次

> ID：11835682
> 
> 赞同：0
> 
> 时间：2012-08-06T20:45:33.087
> 
> 标签：iphone, nscalendar, nsdatecomponents, weekend

我正在制作一个 iPhone 倒计时应用程序，并且需要知道在用户设置的日期之前一个周末（如周六和周日）会发生多少次。

举个例子，我怎么知道从现在（8 月 6 日星期一）到下周有多少个周末？***我***知道答案是 1 个周末，但我需要能够使用代码来解决这个问题。

我得到的最接近的是使用 NSDateComponents 和 NSCalender 并做一些接近以下的事情。

```
NSDateComponents *weekendsLeftComponents = [calendar components:NSWeekCalendarUnit
                                                    fromDate:targetDate
                                                      toDate:[NSDate date]
                                                     options:0]; 
```

但是从那里我已经碰到了可怕的编码员墙。

我的问题是不完全知道如何去做。听起来阵列可以工作，但我担心阵列可能会变得相当大，因为其中一些“东西”可能会持续几年。（我正在制作一个应用程序，它可以找出一个人毕业前还有多少天、周末等。）此外，我的受众主要是拥有 iPod 的孩子到青少年，还有年龄较大的。我不知道他们的内存（ram）在用完之前能达到多少。

非常感谢你，

亚历克斯·卡弗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:29:09.263

假设是在未来，它看起来像你的`fromDate`并且`toDate`是倒退的。`targetDate`

这是我解决这个问题的方法。

创建一个类别`NSCalendar`以计算特定工作日在两个日期之间出现的次数：

```
@interface NSCalendar (AlexCategory)

// The number of times weekday number `weekday` (1 = Sunday, 7 = Saturday)
// occurs between `fromDate` and `toDate`.  If `fromDate` falls on the desired
// weekday, it is counted.  If `toDate` falls on the desired weekday, it is NOT counted.
- (NSInteger)countOfWeekday:(NSInteger)weekday fromDate:(NSDate *)fromDate toDate:(NSDate *)toDate;

@end 
```

为了实现这个新方法，我们将首先获取 的年、月、日和工作日`fromDate`：

```
@implementation NSCalendar (AlexCategory)

- (NSInteger)countOfWeekday:(NSInteger)weekday fromDate:(NSDate *)fromDate toDate:(NSDate *)toDate {
    NSDateComponents *components = [self components:NSDayCalendarUnit | NSMonthCalendarUnit | NSYearCalendarUnit | NSWeekdayCalendarUnit fromDate:fromDate]; 
```

`fromDate`接下来，我们计算从下一个期望的工作日到多少天：

```
 NSInteger daysUntilDesiredWeekday = weekday - components.weekday;
    // If fromDate is a Wednesday and weekday is Monday (for example),
    // daysUntilDesiredWeekday is negative.  Fix that.
    NSRange weekdayRange = [self minimumRangeOfUnit:NSWeekdayCalendarUnit];
    if (daysUntilDesiredWeekday < weekdayRange.location) {
        daysUntilDesiredWeekday += weekdayRange.length;
    } 
```

请注意，如果落在所需的工作日，`daysUntilDesiredWeekday`它将为零。`fromDate`

现在我们可以`NSDateComponents`在 或之后创建一个表示第一个所需的工作日`fromDate`：

```
 NSDateComponents *firstDesiredWeekday = [[NSDateComponents alloc] init];
    firstDesiredWeekday.year = components.year;
    firstDesiredWeekday.month = components.month;
    firstDesiredWeekday.day = components.day + daysUntilDesiredWeekday; 
```

我们更新`fromDate`为第一个期望的工作日，如果它是 on 或之后返回 0 `toDate`：

```
 fromDate = [self dateFromComponents:firstDesiredWeekday];
    if ([fromDate compare:toDate] != NSOrderedAscending) {
        return 0;
    } 
```

`fromDate`接下来我们计算从更新到的所有天数（不仅仅是所需的工作日）`toDate`：

```
 NSInteger allDaysCount = [self components:NSDayCalendarUnit
        fromDate:fromDate toDate:toDate options:0].day; 
```

我们可以将其除以一周中的天数，以仅计算所需的工作日数。由于我们从所需的工作日开始计数，任何部分周余数也将包含所需的工作日，因此我们需要四舍五入：

```
 // Adding weekdayRange.length - 1 makes the integer division round up.
    return (allDaysCount + weekdayRange.length - 1) / weekdayRange.length;
}

@end 
```

我们可以这样测试方法：

```
NSCalendar *calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];

NSDateComponents *components = [[NSDateComponents alloc] init];
components.year = 2012;
components.month = 1;
components.day = 1;
NSDate *fromDate = [calendar dateFromComponents:components];

for (NSUInteger i = 1; i <= 365; ++i) {
    components.day = i;
    NSDate *toDate = [calendar dateFromComponents:components];
    NSLog(@"%@ to %@: %ld Mondays", fromDate, toDate, [calendar countOfWeekday:2 fromDate:fromDate toDate:toDate]);
} 
```

输出开始如下：

```
2012-08-06 16:27:05.751 tuesdays[81152:403] 0 Mondays from 2012-01-01 06:00:00 +0000 to 2012-01-01 06:00:00 +0000
2012-08-06 16:27:05.754 tuesdays[81152:403] 0 Mondays from 2012-01-01 06:00:00 +0000 to 2012-01-02 06:00:00 +0000
2012-08-06 16:27:05.756 tuesdays[81152:403] 1 Mondays from 2012-01-01 06:00:00 +0000 to 2012-01-03 06:00:00 +0000
2012-08-06 16:27:05.758 tuesdays[81152:403] 1 Mondays from 2012-01-01 06:00:00 +0000 to 2012-01-04 06:00:00 +0000
2012-08-06 16:27:05.759 tuesdays[81152:403] 1 Mondays from 2012-01-01 06:00:00 +0000 to 2012-01-05 06:00:00 +0000
2012-08-06 16:27:05.760 tuesdays[81152:403] 1 Mondays from 2012-01-01 06:00:00 +0000 to 2012-01-06 06:00:00 +0000
2012-08-06 16:27:05.762 tuesdays[81152:403] 1 Mondays from 2012-01-01 06:00:00 +0000 to 2012-01-07 06:00:00 +0000
2012-08-06 16:27:05.763 tuesdays[81152:403] 1 Mondays from 2012-01-01 06:00:00 +0000 to 2012-01-08 06:00:00 +0000
2012-08-06 16:27:05.763 tuesdays[81152:403] 1 Mondays from 2012-01-01 06:00:00 +0000 to 2012-01-09 06:00:00 +0000
2012-08-06 16:27:05.764 tuesdays[81152:403] 2 Mondays from 2012-01-01 06:00:00 +0000 to 2012-01-10 06:00:00 +0000
2012-08-06 16:27:05.765 tuesdays[81152:403] 2 Mondays from 2012-01-01 06:00:00 +0000 to 2012-01-11 06:00:00 +0000 
```

根据以下输出，这看起来是正确的`cal 1 2012`：

```
 January 2012
Su Mo Tu We Th Fr Sa
 1  2  3  4  5  6  7
 8  9 10 11 12 13 14
15 16 17 18 19 20 21
22 23 24 25 26 27 28
29 30 31 
```

（请记住，`toDate`没有计算在内，因此从 2012-1-1 到 2012-1-2 有 0 个星期一，即使 2012-1-2 是星期一。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:57:26.417

您需要说明您的问题。定义什么是周末？对我来说周末是周六和周日。所以每次出现星期天都是一个周末（请记住，星期天不是整个周末 - 我只是想简化要求）。

那么你怎么能在代码中做到这一点呢？有很多方法。一种快速的方法是创建一个包含每天的数组 [Monday,Tuesday,...,Sunday]

现在您想知道在 3 周内这个星期二和星期二之间出现了多少个周末。你将通过减去 得到数字三`targetDateComponent.week-currentDateComponent.week`。您只需遍历此数组，直到星期二出现 3 次并计算所有星期日。

真的很简单。我不确定这是否完全符合您的问题。但是有很多方法。

试着谨慎地思考

# objective-c - NSArray enmuerateUsingBlock，一内一，如何停止外枚举？

> ID：11835686
> 
> 赞同：2
> 
> 时间：2012-08-06T20:45:41.360
> 
> 标签：objective-c, nsmutablearray, nsarray, objective-c-blocks, enumeration

我使用一个 nsmutablearray 创建了一个二维数组，并且有一个方法：

```
- (void)enumerateObjectsUsingBlock:(void (^)(id obj, NSUInteger row, NSUInteger column, BOOL *stop))block
{
    [self.internalArray enumerateObjectsUsingBlock:^(id obj, NSUInteger rowIdx, BOOL *stopRow){
        NSMutableArray *rowArray = obj;
        [rowArray enumerateObjectsUsingBlock:^(id obj, NSUInteger columnIdx, BOOL *stopColumn){
            block(obj, rowIdx, columnIdx, stopColumn);
        }];
    }];
} 
```

我注意到如果'block'将stopColumn设置为YES，那么我需要一种方法来通知外部块stopRow也应该是YES，我不确定我是否可以：

1.  只使用一个 BOOL *stop 而不是 stopRow 和 stopColumn （因为我正在使用 ARC），或者
2.  在外部块内添加一个 BOOL isStop 并且内部块可以将其设置为 stopColumn 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:54:27.690

这应该有效：

```
- (void)enumerateObjectsUsingBlock:(void (^)(id obj, NSUInteger row, NSUInteger column, BOOL *stop))block
{
    [self.internalArray enumerateObjectsUsingBlock:^(id obj, NSUInteger rowIdx, BOOL *stopRow){
        NSMutableArray *rowArray = obj;
        [rowArray enumerateObjectsUsingBlock:^(id obj, NSUInteger columnIdx, BOOL *stopColumn) {
            block(obj, rowIdx, columnIdx, stopColumn);
            // Add this line:
            *stopRow = *stopColumn;
        }];
    }];
} 
```

块应捕获其主体使用的所有变量，包括`stopRow`指针。由于您没有修改指针本身，只修改了它指向的数据，因此您不需要做任何其他事情（如果您需要修改指针本身，您需要一个额外的临时变量声明为`__block`）。

# authorization - 可以使用 Apache Shiro 保护 EJB 吗？

> ID：11835687
> 
> 赞同：3
> 
> 时间：2012-08-06T20:45:52.793
> 
> 标签：authorization, ejb-3.0, shiro

我想知道我是否可以使用 Apache Shiro 来保护（容器管理的）Java EE 应用程序的业务层。我之所以问，是因为我没有找到任何示例，而只有诸如“它适用于 Web、EJB 和 IoC 环境”之类的陈述。

Apache Shiro，与默认的 Java 基于角色的访问控制相比，缝合了更广泛的方式来授权用户（例如权限字符串），我希望可以使用它作为替代来保护基于注释的会话 bean 的方法方式。

这可能吗，有人试过吗？有限制吗？一个例子或教程也会很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T12:21:03.323

好的，我从 2010 年开始监督 Les Hazlewood 的[回答。](http://shiro-user.582556.n2.nabble.com/Questions-after-first-steps-with-Shiro-td5525922.html)

本质是，如果主题可以绑定到当前线程，则提供对保护 EJB 的支持。如果请求是从 Web 环境发起的，这会通过 Shiro 过滤器自动发生。

他进一步指出：

> 一旦 Subject 与线程相关联，AOP 就是执行安全限制的最简单方法之一。然后您可以注释您的 EJB 方法 [...]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T06:02:03.397

您可以将 shiro API 用作 ejb 中的简单 java 代码。

您也可以使用[https://issues.apache.org/jira/browse/SHIRO-337](https://issues.apache.org/jira/browse/SHIRO-337)

# java - Java中的居中面板

> ID：11835689
> 
> 赞同：0
> 
> 时间：2012-08-06T20:46:02.327
> 
> 标签：java, swing, user-interface, jpanel, miglayout

出于某种原因，我在将位于另一个面板内的面板垂直居中时遇到问题。我完全按照我研究的例子做，但仍然没有运气。

下面是我的代码。尽管在我的容器面板上使用了 setAlignmentY(0.5f)，但当我调整窗口大小时它仍然不会居中。

尽管 setAligenmentX(0.5f)，容器面板内的组件也不会居中。

我想知道是否有解决方案，我几乎尝试了所有方法，但找不到解决方案。

```
JLabel idLabel;
    JLabel passLabel;
    JTextField id;
    JTextField pass;
    JButton enter;
    JPanel container;

    public JournalLogin()
    { 
        //setLayout(new FlowLayout());
        //setPreferredSize(new Dimension(500, 500));
        //setBorder(BorderFactory.createEmptyBorder(100, 100, 100, 100));

        container = new JPanel();
        container.setLayout(new MigLayout());
        container.setAlignmentX(0.5f);
        container.setAlignmentY(0.5f);
        container.setPreferredSize(new Dimension(300, 300));
        container.setBorder(BorderFactory.createTitledBorder("Login"));
        add(container);

        idLabel = new JLabel("ID:");
        idLabel.setAlignmentX(0.5f);
        container.add(idLabel);

        id = new JTextField();
        id.setText("id");
        id.setAlignmentX(0.5f);
        id.setPreferredSize(new Dimension(80, 20));
        container.add(id, "wrap"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:08:19.560

setAlignmentX 和 Y 不是这样做的方法。在容器中使组件居中的一种方法是让容器使用 GridBagLayout 并在不使用任何 GridBagConstraints 的情况下添加组件，即所谓的默认添加。还有其他方法。

例如改变 Nick Rippe 的例子（对他来说是 1+）：

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.GridBagLayout;

import javax.swing.*;

public class UpdatePane2 extends JPanel {
   private static final int PREF_W = 300;
   private static final int PREF_H = 200;

   public UpdatePane2() {
      JPanel innerPanel = new JPanel();
      innerPanel.setLayout(new BorderLayout());
      innerPanel.add(new JLabel("Hi Mom", SwingConstants.CENTER), 
            BorderLayout.NORTH);
      innerPanel.add(new JButton("Click Me"), BorderLayout.CENTER);

      setLayout(new GridBagLayout());
      add(innerPanel);
   }

   @Override
   public Dimension getPreferredSize() {
      return new Dimension(PREF_W, PREF_H);
   }

   private static void createAndShowGui() {
      JFrame frame = new JFrame("UpdatePane2");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(new UpdatePane2());
      frame.pack();
      frame.setLocationRelativeTo(null);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T21:08:08.230

Swing 中的对齐方式往往非常挑剔——它们确实 [通常] 可以工作......但如果你要寻找的只是一个居中的面板，我建议在`BoxLayout`（我个人最喜欢的`LayoutManager`）中使用 Boxes。这是一个帮助您入门的示例：

```
import java.awt.Dimension;
import javax.swing.*;

public class UpdatePane extends JPanel{

    public static void main(String... args) {
        SwingUtilities.invokeLater(new Runnable(){
            @Override
            public void run() {
                //Create Buffers
                Box verticalBuffer = Box.createVerticalBox();
                Box horizontalBuffer = Box.createHorizontalBox();

                verticalBuffer.add(Box.createVerticalGlue()); //Top vertical buffer
                verticalBuffer.add(horizontalBuffer);

                horizontalBuffer.add(Box.createHorizontalGlue()); //Left horizontal buffer

                //Add all your content here
                Box mainContent = Box.createVerticalBox();
                mainContent.add(new JLabel("Hi Mom!"));
                mainContent.add(new JButton("Click me"));
                horizontalBuffer.add(mainContent);

                horizontalBuffer.add(Box.createHorizontalGlue());  //Right horizontal buffer
                verticalBuffer.add(Box.createVerticalGlue()); //Bottom vertical buffer

                // Other stuff for making the GUI
                verticalBuffer.setPreferredSize(new Dimension(300,200));
                JFrame frame = new JFrame();
                frame.add(verticalBuffer);
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.pack();
                frame.setVisible(true);

            }
        });
        }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T20:55:56.173

您需要让 LayoutManager 为您将布局居中。目前看起来“ `MigLayout`”的实现不遵守对齐。尝试更改它或创建一个子类。

# iphone - iPhone - 从 Internet 下载文件并保存到文档目录

> ID：11835691
> 
> 赞同：-1
> 
> 时间：2012-08-06T20:46:04.760
> 
> 标签：iphone, xcode, uiwebview, nsurlconnection, nsdocumentdirectory

我正在尝试使用 NSUrlConnection 下载文件，将文件保存到文档目录，然后在 web 视图中打开它。

我正在使用代码：

```
- (IBAction)down:(id)sender {
// create the request
url = [[NSURL alloc]initWithString:urlbox.text];
NSLog(@"%@",url);

NSURLRequest *theRequest=[NSURLRequest requestWithURL:url
                                          cachePolicy:NSURLRequestUseProtocolCachePolicy
                                      timeoutInterval:60.0];
NSURLConnection *theConnection;
theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
if (theConnection) {

    NSMutableData *receivedData;
    receivedData=[NSMutableData data];

} 
```

下载文件。如果有人可以给我一些代码来保存文件并在 web 视图中打开它，那就太好了。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:46:09.350

获取 Vandad Nahavandipoor (O'Reilly) 所著的“iOS Programming Cookbook”一书，其中包含示例和代码，可以完全满足您的需求。Matt Neuburg（也是 O'Reilly）的“Programming iOS 5”也很有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T08:40:06.493

看看[MGPRemoteAssetController](https://github.com/magicalpanda/MGPRemoteAssetController)，这是我使用的基于`NSURLConnection`.

更重要的是，您可以跟踪 MGPRemoteAssetDownloader 的工作方式。这是一个很棒的示例代码。

# java - 如何在 Android 中使用图层

> ID：11835694
> 
> 赞同：0
> 
> 时间：2012-08-06T20:46:14.953
> 
> 标签：java, android, layer

所以我在我正在开发的android中有这个项目，现在我有一个身体图的图像。它包括心脏、胃、肠、食道、肾脏、肝脏和阑尾。

基本上，我只想能够只单击图像的那部分（即单击心脏）来更新我必须说“心脏”的文本视图。

我下载了 Paint.NET 并使用魔杖，我可以选择身体的某个部位，比如心脏或胃。我是否需要在 Paint.NET 中创建图层，或者这可以在 Android 中使用画布创建吗？

任何帮助深表感谢。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:53:39.307

您可以仅使用 Canvas 标记特定的绘图区域。您需要为每个解剖部分创建[路径，并从那里创建您的画布。](http://developer.android.com/reference/android/graphics/Path.html)

# jsf - a4j:ajax 不会渲染 h:panelgrid

> ID：11835698
> 
> 赞同：2
> 
> 时间：2012-08-06T20:46:34.147
> 
> 标签：jsf, richfaces

这是代码：

```
<h:panelGrid columns="3" style="margin-left: auto; margin-right:auto;">
    <f:facet name="header">
        <rich:column colspan="2">
            <h:outputText value="Ingrese datos del padre" />
        </rich:column>
    </f:facet>

    <label for="padreRut">RUT</label>
    <h:inputText id="padreRut" value="#{IngresoAlumno.padre.per_Rut}">
        <a4j:ajax event="keyup" render="formPadre" immediate="true" />
        <f:validateLongRange minimum="0" />
    </h:inputText>
    <rich:message for="padreRut" ajaxRendered="true" />
</h:panelGrid>

<h:panelGrid id="formPadre" columns="3" style="margin-left: auto; margin-right:auto;" rendered="#{IngresoAlumno.padre.per_Rut gt 0}">
//...From here on there are form elements 
```

问题是当我触发事件时，第二个 panelGrid 不会呈现。我在这里做错了吗？事先谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:01:42.910

ajax 魔法由运行在客户端并在 HTML DOM 树上运行的 JavaScript 代码执行。通过指定`render="someId"`，您基本上是在告诉 JavaScript 将具有给定 ID 的 JSF 组件的 HTML 表示替换为检索到的 ajax 响应中的新 HTML 表示。

但是，如果 JSF**没有**首先呈现具有给定 ID 的 JSF 组件的 HTML 表示，那么 JavaScript 就无法在 HTML DOM 树中找到要替换的任何内容。

这就是您的情况。相反，您应该指定**始终**呈现的 JSF 组件的 ID，以便 JavaScript 可以在必要时在 HTML DOM 树中找到并更新它。您可以`<h:panelGroup>`为此使用 a 。

```
<a4j:ajax ... render="formPadre" />
...
<h:panelGroup id="formPadre">
    <h:panelGrid ... rendered="#{IngresoAlumno.padre.per_Rut gt 0}">
        ... 
```

### 也可以看看：

*   [JSF 2.0 中的通信 - 内容的 Ajax 呈现，它本身是有条件呈现的](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#AjaxRenderingOfContentWhichIsByItselfConditionallyRendered)

# ios - 架构 i386 的未定义符号：“_OBJC_CLASS_$_Facebook”，引用自：AppDelegate.o 中的 objc-class-ref

> ID：11835699
> 
> 赞同：4
> 
> 时间：2012-08-06T20:46:37.427
> 
> 标签：ios, xcode, facebook, sdk

我不知道为什么会发生这个错误。我已经导入了 facebook ios sdk 静态库，我得到了那个错误。可能是什么原因造成的？

感谢您的帮助

架构 i386 的未定义符号：“_OBJC_CLASS_$_Facebook”，引用自：AppDelegate.o 中的 objc-class-ref ld：未找到架构 i386 的符号 clang：错误：链接器命令失败，退出代码为 1（使用 -v查看调用）

```
Undefined symbols for architecture i386:
  "_OBJC_CLASS_$_Facebook", referenced from:
      objc-class-ref in AppDelegate.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T20:58:20.060

链接器找不到与 Facebook 类相关的符号。

一个好的第一个地方是检查您的项目中是否包含 SDK 的模拟器 (x86) 版本。通常 XCode 会为您选择正确的架构，但您可能只有 ARMv7 版本。

愿意与我们分享链接器的命令行吗？（您可以通过在项目导航器中选择日志选项卡来获得此信息 - 它位于最右侧 - 然后向下钻取以获取每个构建操作的命令行。）

# javascript - ajax 成功响应和 firefox 弹出窗口拦截器

> ID：11835700
> 
> 赞同：0
> 
> 时间：2012-08-06T20:46:40.987
> 
> 标签：javascript, jquery, firefox, popup, window

所以我理解 Firefox 弹出窗口阻止程序的方式是它会阻止用户没有启动弹出窗口打开的弹出窗口（如果我错了，请纠正我）

例如，如果你有

```
window.open(url, name); 
```

它会阻止弹出窗口，但如果你有

```
$('checkbox').change(function(){
  window.open(url, name);
}); 
```

它不会阻止弹出窗口，因为它取决于用户执行操作（即更改复选框值）...

但是当我这样做的时候

```
$('checkbox').change(function(){
  $.ajax({
     url: someUrl,
     success : function(data){
       if(someCondition){
         window.open(someOtheUrl, name);
       }
     }
  });
}); 
```

然后 Firefox 会尝试阻止这个 window.open 调用，尽管它仍然取决于用户执行的操作......

在用户操作中使用 ajax 时，有没有办法告诉 firefox 这个弹出窗口是合法的并且没有 firefox 阻止它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T04:56:57.450

我同意这些先前的评论，您不需要使用弹出窗口。只需使用这样的 jquery-ui 模态......

```
 $('.delete').live('click', function(evt){
            var ref = $(this).attr('href');     
            $.get(ref, function(data){
            $('#modal_div').html(data);
            $(function() {
            $('#modal_div').dialog({
                autoOpen: true,
                show: "blind",
                hide: "fade",
                modal: true,
                width:301,
                buttons:
                {
                'Confirm Delete':function(){
                    // some action
                    },
                'Cancel':function(){
                    $(this).dialog('close');
                    }   
                }
            });
        });

    });
    evt.preventDefault();
}); 
```

});

所以这将完美地工作，当然它比该死的弹出窗口更能满足用户！

**注意**代码中的某些内容可能对您没有用...我只是选择了一些我编写的javascript代码！

# c# - “数据类型”参数不能为空

> ID：11835703
> 
> 赞同：0
> 
> 时间：2012-08-06T20:47:00.337
> 
> 标签：c#

尝试在列附近的 .Net 中执行应用程序时出现错误（迄今为止的高级版）（在下面的代码中突出显示），这是我的应用程序中新添加的列，添加后我无法运行应用 。

```
private DataView getPremiumsFromCoverages()
    {
        DataTable dtPremium = new DataTable("Premium");

        dtPremium.Columns.Add(COLUMN_PREMIUM_BREAKDOWN, System.Type.GetType("System.String"));
        dtPremium.Columns.Add(COLUMN_PREMIUM_PERCENT, System.Type.GetType("System.Decimal"));
        dtPremium.Columns.Add(COLUMN_PREMIUM, System.Type.GetType("System.String"));
        dtPremium.Columns.Add(COLUMN_PREMIUM_HAZARDLEVEL, System.Type.GetType("System.String"));
        **dtPremium.Columns.Add(COLUMN_PREMIUMTODATE, System.Type.GetType("system.Decimal"));**

        OptionEXC currOption = this._Account.CurrentRisk.Options.FindBy_OptionNum(this.OptionNum);
        CoverageEXC covEXC;
        HazardLevelCollection hazardLevelColl = new HazardLevelCollection(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T20:50:19.617

您将 System.Decimal 输入错误为 system.Decimal。

# node.js - 在 32 位系统上编译 node.js

> ID：11835704
> 
> 赞同：4
> 
> 时间：2012-08-06T20:47:18.337
> 
> 标签：node.js, 32bit-64bit, v8

我需要在 32 位系统上编译 node.js 以与我已有的代码兼容。

我从 nodejs.org 的源代码开始并编译它。然后我开始更改 common.gypi 文件中的第 164-166 行。它是：

```
164           [ 'target_arch=="x64"', {
165             'cflags': [ '-m64' ],
166             'ldflags': [ '-m64' ],
167           }], 
```

现在是：

```
164           [ 'target_arch=="x64"', {
165             'cflags': [ '-m32' ],
166             'ldflags': [ '-m32' ],
167           }], 
```

当我再次尝试制作时，出现以下错误：

../deps/v8/src/execution.h:259：错误：整数常量对于“长”类型来说太大 ../deps/v8/src/execution.h:260：错误：整数常量对于“长”类型来说太大了'long' 类型 ../deps/v8/src/execution.h:259：错误：函数调用不能出现在常量表达式中 ../deps/v8/src/execution.h:260：错误：函数call 不能出现在常量表达式中

这些错误指的是这些行：

```
#ifdef V8_TARGET_ARCH_X64
  static const uintptr_t kInterruptLimit = V8_UINT64_C(0xfffffffffffffffe);
  static const uintptr_t kIllegalLimit = V8_UINT64_C(0xfffffffffffffff8); 
```

我相信这段代码来自谷歌的 v8 源代码。

我将不胜感激有关如何修复这些特定编译错误和/或如何在 32 位系统上编译 64 位 node.js 的任何建议。我所做的大部分研究是如何为 64 位系统编译 32 位的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T08:27:38.447

如果你想构建一个 x86_32 版本的节点，你正在为错误的目标架构修改参数。相反，将`--dest-cpu`参数提供给配置脚本，如下所示：

```
git clone git://github.com/joyent/node.git
cd node
./configure --prefix /usr/local --dest-cpu ia32
make 
```

如果这些命令成功完成，应该有一个有效的 x86_32 二进制文件`./out/Release/node`：

```
~/node$ file -b ./out/Release/node
ELF 32-bit LSB executable, Intel 80386, version 1 (GNU/Linux), dynamically linked
(uses shared libs), for GNU/Linux 2.6.26, (...), not stripped
~/node$ ./out/Release/node
> 1 + 1
2 
```

您可以`--prefix`使用`sudo make install`.

请注意，这需要设置一个有效的 C 和 C++ 编译器。在 Debian/Ubuntu 上，`sudo apt-get install build-essential`（或者`build-essential:i386`如果您正在交叉编译）应该可以帮助您入门。在基于 rpm 的发行版上，尝试`sudo yum groupinstall "Development Tools" "Development Libraries"`.

# android - Facebook 发布空指针系统错误

> ID：11835707
> 
> 赞同：0
> 
> 时间：2012-08-06T20:47:34.180
> 
> 标签：android, facebook

我有一个使用 facebook 帖子的应用程序。我正在使用强制登录

```
 mFacebook.authorize(this, PERMS, Facebook.FORCE_DIALOG_AUTH,  new LoginDialogListener()); 
```

代替

```
 mFacebook.authorize(this, PERMS, new LoginDialogListener()); 
```

因为使用标准授权方法我无法发布到 Facebook。现在帖子有效，但我收到此错误：

```
08-06 20:35:52.814: W/System.err(682): java.lang.NullPointerException
08-06 20:35:52.824: W/System.err(682):  at com.b2creativedesigns.b2lovecalculator.FacebookActivity$IDRequestListener$1.run(FacebookActivity.java:147)
08-06 20:35:52.824: W/System.err(682):  at android.os.Handler.handleCallback(Handler.java:587)
08-06 20:35:52.824: W/System.err(682):  at android.os.Handler.dispatchMessage(Handler.java:92)
08-06 20:35:52.824: W/System.err(682):  at android.os.Looper.loop(Looper.java:123)
08-06 20:35:52.824: W/System.err(682):  at android.app.ActivityThread.main(ActivityThread.java:4363)
08-06 20:35:52.824: W/System.err(682):  at java.lang.reflect.Method.invokeNative(Native Method)
08-06 20:35:52.824: W/System.err(682):  at java.lang.reflect.Method.invoke(Method.java:521)
08-06 20:35:52.824: W/System.err(682):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
08-06 20:35:52.824: W/System.err(682):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
08-06 20:35:52.824: W/System.err(682):  at dalvik.system.NativeStart.main(Native Method) 
```

但是，尽管出现错误，我在应用程序中没有看到明显的错误（强制关闭）：

这是脸书活动：

```
public abstract class FacebookActivity extends Activity {
    public static final String TAG = "FACEBOOK";
    private Facebook mFacebook;
    public static final String APP_ID = "blablabla"; //the API Key for your Facebook APPs
    private AsyncFacebookRunner mAsyncRunner;
    private static final String[] PERMS = new String[] { "publish_stream" };
    private SharedPreferences sharedPrefs;
    private Context mContext;

    private TextView username;
    private ProgressBar pb;

    public void setConnection() {
            mContext = this;
            mFacebook = new Facebook(APP_ID);
            mAsyncRunner = new AsyncFacebookRunner(mFacebook);
    }

    public void getID(TextView txtUserName, ProgressBar progbar) {
            username = txtUserName;
            pb = progbar;
            if (isSession()) {
                    Log.d(TAG, "sessionValid");
                    mAsyncRunner.request("me", new IDRequestListener());
            } else {
                    // no logged in, so relogin
                    Log.d(TAG, "sessionNOTValid, relogin");
                    //mFacebook.authorize(this, PERMS, new LoginDialogListener());
                    mFacebook.authorize(this, PERMS, Facebook.FORCE_DIALOG_AUTH,  
                            new LoginDialogListener());
            }
   }

    public void logout() {
        mContext = this;

        try {

           mFacebook = new Facebook(APP_ID);
           mFacebook.logout(mContext);
           //mFacebook.authorize(this, PERMS, -1, new LoginDialogListener());

          Log.d(TAG, "ssucesfull logout");
    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}

    public boolean isSession() {
            sharedPrefs = PreferenceManager.getDefaultSharedPreferences(mContext);
            String access_token = sharedPrefs.getString("access_token", "x");
            Long expires = sharedPrefs.getLong("access_expires", -1);
            Log.d(TAG, access_token);

            if (access_token != null && expires != -1) {
                    mFacebook.setAccessToken(access_token);
                    mFacebook.setAccessExpires(expires);
            }
            return mFacebook.isSessionValid();
    }

    private class LoginDialogListener implements DialogListener {

            @Override
            public void onComplete(Bundle values) {
                    Log.d(TAG, "LoginONComplete");
                    String token = mFacebook.getAccessToken();
                    long token_expires = mFacebook.getAccessExpires();
                    Log.d(TAG, "AccessToken: " + token);
                    Log.d(TAG, "AccessExpires: " + token_expires);
                    sharedPrefs = PreferenceManager
                                    .getDefaultSharedPreferences(mContext);
                    sharedPrefs.edit().putLong("access_expires", token_expires)
                                    .commit();
                    sharedPrefs.edit().putString("access_token", token).commit();
                    mAsyncRunner.request("me", new IDRequestListener());
            }

            @Override
            public void onFacebookError(FacebookError e) {
                    Log.d(TAG, "FacebookError: " + e.getMessage());
            }

            @Override
            public void onError(DialogError e) {
                    Log.d(TAG, "Error: " + e.getMessage());
            }

            @Override
            public void onCancel() {
                    Log.d(TAG, "OnCancel");
            }
    }

    private class IDRequestListener implements RequestListener {

            @Override
            public void onComplete(String response, Object state) {
                    try {
                            Log.d(TAG, "IDRequestONComplete");
                            Log.d(TAG, "Response: " + response.toString());
                            JSONObject json = Util.parseJson(response);

                            final String id = json.getString("id");
                            final String name = json.getString("name");
                            FacebookActivity.this.runOnUiThread(new Runnable() {
                                    public void run() {
                                        try{ 
                                            username.setText("Welcome: " + name+"\n ID: "+id); //the error points to this line
                                            pb.setVisibility(ProgressBar.GONE);
                                        }catch(Exception e){
                                            e.printStackTrace();
                                        }
                                    }
                            });
                            postOnWall("The possibility of love between " + GlobalVars.getName1() + " and " + GlobalVars.getName2() + " is " + GlobalVars.getPercent() + "%!");
                    } catch (JSONException e) {
                            Log.d(TAG, "JSONException: " + e.getMessage());
                    } catch (FacebookError e) {
                            Log.d(TAG, "FacebookError: " + e.getMessage());
                    }
            }

            @Override
            public void onIOException(IOException e, Object state) {
                    Log.d(TAG, "IOException: " + e.getMessage());
            }

            @Override
            public void onFileNotFoundException(FileNotFoundException e,
                            Object state) {
                    Log.d(TAG, "FileNotFoundException: " + e.getMessage());
            }

            @Override
            public void onMalformedURLException(MalformedURLException e,
                            Object state) {
                    Log.d(TAG, "MalformedURLException: " + e.getMessage());
            }

            @Override
            public void onFacebookError(FacebookError e, Object state) {
                    Log.d(TAG, "FacebookError: " + e.getMessage());
            }

    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
          mFacebook.authorizeCallback(requestCode, resultCode, data);
    }

    public void postOnWall(String msg) {
        Log.d("Tests graph API %%%%%$$$$%%%", msg);
         try {
                String response = mFacebook.request("me");
                Bundle parameters = new Bundle();
                parameters.putString("message", msg);
                parameters.putString("picture", "https://lh3.ggpht.com/f79UCpnLisZxO2P2C43f55YLvFpNco_cTcC-t9Ck-Qmqe5jwKbfnUvCh5N6-Te-mOw=w124");
                parameters.putString("link", "https://play.google.com/store/apps/details?id=com.b2creativedesigns.b2lovecalculator");

                response = mFacebook.request("me/feed", parameters,"POST");
                Log.d("Tests", "got response: " + response);
                if (response == null || response.equals("") || 
                        response.equals("false")) {
                   Log.v("Error", "Blank response");
                }
         } catch(Exception e) {
             e.printStackTrace();
         }
         finally {
             FacebookActivity.this.runOnUiThread(new Runnable() {
                  public void run() {
                      Toast.makeText(FacebookActivity.this, "Posted to Facebook", Toast.LENGTH_SHORT).show();
                  }
                });

         }
    }

} 
```

错误指向该 `username.setText("Welcome: " + name+"\n ID: "+id);`行，但是在 stactrace 中，我看到了由该行打印的名称和 id： `Log.d(TAG, "Response: " + response.toString());`

为什么我会收到此错误？

**编辑：**

这就是我通过单击按钮调用 facebook 发布流程的方式：

```
btnFB = (Button)findViewById(R.id.btnFB);
btnFB.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {

             setConnection();
             getID(txtUserName, pbLogin);

        }
    }); 
```

变量是这样定义的，但没有赋值（来自教程）：

```
TextView txtUserName;
ProgressBar pbLogin; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:58:02.027

正如你上面所说，当`getID(txtUserName, pbLogin);`被调用时，两者`txtUserName`和`pbLogin`都是`null`。`NullPointerException`当您尝试访问它们时，这将导致您的。

无论教程说什么，您都需要分配这些字段。完成时您必须拥有`TextView`和`ProgressBar`对象`IDRequestListener`，否则您的程序将强制关闭。

因此，要解决此问题，您必须创建您的`TextView`和`ProgressBar`对象（通过 XML 或通过代码）。我怀疑您正在使用的教程确实说要这样做。我猜你应该`findViewById`在你分配的行上方定义它们`btnFB`。

# entity-framework - 如何在 EF 5 Code First 中拥有一个只有一个 Bar 的 Foo

> ID：11835709
> 
> 赞同：0
> 
> 时间：2012-08-06T20:47:37.503
> 
> 标签：entity-framework, ef-code-first, lazy-loading, entity-framework-ctp5

*我是一个胡言乱语的残骸，试图首先获取 EF 代码，让我在 SQL 中做一些我可以在 2 分钟内完成的事情。如果我还没有花 5 天时间试图让它工作，我只需在 DDL 中编写我的数据库并使用 ADO.NET。但我离题了...*

我想要 2 个表，其中 A 中的每条记录在 B 中都有对应的记录。它们都是同一个对象的一部分；由于我不会进入的原因，它们需要在单独的表格中（但它们确实如此，所以不要去那里）。如果我从数据库端设计它，我只需从 B 到 A 建立一个 FK 关系。工作完成。

在 EF Code First 中，我尝试使用[共享主键方法](http://weblogs.asp.net/manavi/archive/2011/04/14/associations-in-ef-4-1-code-first-part-3-shared-primary-key-associations.aspx)和[一对一外键关联](http://weblogs.asp.net/manavi/archive/2011/05/01/associations-in-ef-4-1-code-first-part-5-one-to-one-foreign-key-associations.aspx)方法，但都不适合我。我还尝试了我能想到的所有变体的 100 种左右的组合，而且我没有进一步前进。

正如我所说，我想要的是从 A 到 B 的*可导航*关系（返回会很好，但我已经读过这是不可能的），并且这种关系是延迟加载的，所以我可以说`a.b`并可以访问 b 的字段。

我不可能列举出我尝试过的所有东西，所以让我举一个*几乎*可行的例子：

```
class Foo
{
    public int Id { get; set; }
    public string FooProperty { get; set; }

    public virtual Bar Bar { get; set; }
}

class Bar
{
    public int Id { get; set; }
    public string BarProperty { get; set; }
} 
```

请注意，没有从 Bar 到 Foo 的反向引用，因为 (a) SQL Server 会抱怨多个级联删除路径，并且 (b) EF 会抱怨不知道哪一侧是关联的主体端。所以...很好 - 我可以没有它。

这让我进入数据库的是一个`Foos`带有和字段的表`Id`，以及一个带有和字段的表。这与我在 SQL 中建模的方式非常接近，尽管我可能会将 FK 字段放入而不是. 但由于它是 1:1，我猜这并不重要。`FooProperty``Bar_Id``Bars``Id``BarProperty``Bar``Foo`

我说这几乎可行的原因是，如果我添加 a`Bar`和关联`Foo`然后将它们重新加载，`Bar`则对象的属性`Foo`为空。

```
using (var dbContext = new MyDbContext())
{
    var foo = dbContext.Foos.Create();
    foo.FooProperty = "Hello";
    dbContext.Foos.Add(foo);

    var bar = dbContext.Bars.Create();
    bar.BarProperty = "world";

    foo.Bar = bar;

    dbContext.SaveChanges();
}

using (var dbContext = new MyDbContext())
{
    foreach (var foo in dbContext.Foos)
        Console.WriteLine(foo.Bar.Id); // BOOM! foo.Bar is null
} 
```

我通常希望评估`foo.Bar`触发对象的延迟加载`Bar`，但事实并非如此-该属性仍然存在`null`。

我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:04:19.180

这应该工作：

**语境**

```
public class FoobarCtx : DbContext
{
    public DbSet<Bar> Bars { get; set; }
    public DbSet<Foo> Foos { get; set; }

    public FoobarCtx()
    {

    }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Bar>()
            .HasRequired(f => f.Foo)
            .WithRequiredDependent(b => b.Bar)
            .Map(x => x.MapKey("FooId"))
            .WillCascadeOnDelete(true);
    }
} 
```

**实体**

```
public class Foo
{
    public int Id { get; set; }

    public string Foo1 { get; set; }
    public string Foo2 { get; set; }

    public virtual Bar Bar { get; set; }
}

public class Bar
{
    public int Id { get; set; }
    public string Bar1 { get; set; }
    public string Bar2 { get; set; }

    public virtual Foo Foo { get; set; }
} 
```

我在 EF 4.3 中对其进行了测试，但我认为它也应该在 EF5 中工作。关键是**OnModelCreating**方法。在那里，您可以将一个或另一个定义为主体/后代，并摆脱 Microsoft SQL 限制。

有关更多信息，请参阅此[博客文章](http://weblogs.asp.net/manavi/archive/2011/05/01/associations-in-ef-4-1-code-first-part-5-one-to-one-foreign-key-associations.aspx)。有关模型构建器（流式 API）的更多信息，请访问[此处](http://msdn.microsoft.com/en-us/library/hh295843%28v=vs.103%29.aspx)。

要启用延迟加载，请使用 DbContext.FooSet.Create() 方法。[这里](https://stackoverflow.com/questions/3492192/in-ef4-code-first-collection-are-not-lazy-loading)的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T22:33:02.530

提醒自己，如果没有别的...

LueTm 得出了一个解决方案，该解决方案产生了我最初想到的表结构（在 Bar 表中有一个 FooId 列），以及两个表上的独立 PK。如果不首先使用`dbContext.Foos.Include(f => f.Bar)`.

我还能够使用共享主键使事情很好地工作（两个表都有一个 PK，但 Foos 中只有一个是标识（自动增量）列，并且从 Bars 中的 Id 到 FK 关系Foos 中的 ID。

为此，我在 Foo 类中有一个 Bar 属性，在 Bar 类中有一个 Foo 属性（因此 2 向导航有效），并将以下内容放在我的 OnModelCreating 中。

```
modelBuilder.Entity<Bar>()
                .HasRequired(x => x.Foo)
                .WithRequiredDependent(x => x.Bar)
                .WillCascadeOnDelete(true);

modelBuilder.Entity<Foo>()
                .HasRequired(x => x.Bar)
                .WithRequiredPrincipal(x => x.Foo)
                .WillCascadeOnDelete(true); 
```

（我不确定这里的第二个调用实际上会做什么）。

但同样，您仍然需要`Include()`调用才能访问`foo.Bar`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T03:20:38.140

我自己刚刚经历了这个。我有一个 FoodEntry，有一个 Food，而 Food 有一个 FoodGroup。

```
public class FoodEntry
{
    public int      Id { get; set; }
    public string   User { get; set; }
    public Food     Food { get; set; }
    public decimal  PortionSize { get; set; }
    public Portion  Portion { get; set; }
    public int      Calories { get; set; }
    public Meal  Meal { get; set; }
    public DateTime? TimeAte { get; set; }
    public DateTime EntryDate { get; set; }
}

public class Food
{
    public int       Id { get; set; }
    public string    Name { get; set; }
    public FoodGroup FoodGroup { get; set; }
}

public class FoodGroup
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

我首先使用代码，我的 POCO 类的定义和你的一样。我没有标记为虚拟的属性。

无论如何，数据库会按照我的预期生成 - 使用您所描述的外键。

但是这个查询只导致在 Food、Portion 和 Meal 属性中获取带有空值的 FoodEntry 集合：

```
var foodEntries = db.FoodEntries
            .Where(e => e.User == User.Identity.Name).ToList(); 
```

我将查询更改为此，并为我的集合加载了整个图表：

```
var foodEntries = db.FoodEntries
            .Include( p => p.Food)
            .Include(p => p.Food.FoodGroup)
            .Include(p => p.Portion)
            .Include( p => p.Meal)
            .Where(e => e.User == User.Identity.Name).ToList()
            ; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-11T14:42:32.030

对于 1:1 关系*以及*1:many 关系（Foo 有多个 Bars 和 CurrentBar）：

```
 modelBuilder.Entity<Foo>()
            .HasOptional(f => f.CurrentBar)
            .WithMany()
            .HasForeignKey(f => f.CurrentBarId);

        modelBuilder.Entity<Bar>()
            .HasRequired(b => b.Foo)
            .WithMany(f => f.Bars)
            .HasForeignKey(b => b.FooId); 
```

# asp.net - 单击按钮时，我想更新查询字符串并单击按钮重新发布页面

> ID：11835717
> 
> 赞同：0
> 
> 时间：2012-08-06T20:48:41.797
> 
> 标签：asp.net, postback

更新查询字符串后，我需要在单击按钮时重新发布页面。在 button_click 事件中，我检查查询字符串是否具有某个参数，如果它不存在，那么我想将该参数附加到查询字符串并进行回发，以便它返回到按钮单击事件。可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T03:32:17.497

您可以将所有输入按钮放在使用 GET 作为其方法的表单标签中。

这样，每次您提交也就是单击您的输入按钮之一时，查询字符串都会被更新。

例子：

```
<form method="GET">
    <input type="text" name="MyFirstInput" />
    <input type="text" name="MySecondInput" />
    <input type="submit" value="Submit" />
</form> 
```

如果您用“abcdefg”填写“MyFirstInput”并按下提交按钮，则查询字符串将更新为 ...url...?MyFirstInput=abcdefg。然后，如果您返回并填写 MyFirstInput 和 MySecondInput，则查询字符串将同时更新。

请记住，如果您不希望用户一遍又一遍地不断填写相同的字段，则您必须维护回发的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T03:44:47.673

仅添加查询字符串参数就导致客户端刷新是非常昂贵（耗时）的操作。避免这样做。

无论逻辑要求您拥有查询字符串参数，都可以将其重构为基于您在页面上设置的变量。

回答你的问题；是的，这是可能的，但不要这样做。

```
if (String.IsNullOrEmpty(Request.QueryString["myParam"]))
{
    Response.Redirect(Request.ApplicationPath + "?myParam=" + myValue);  
} 
```

# forms - 如何在 ExtJs 下使用商店提交表单？

> ID：11835729
> 
> 赞同：6
> 
> 时间：2012-08-06T20:49:35.747
> 
> 标签：forms, extjs, extjs4, store

有没有办法让表单提交在 ExtJs 4 下的商店中创建对象？

网格完全围绕存储机制构建对我来说似乎很奇怪，我看不到将表单插入存储的明显方法。但我很可能只是错过了一些东西。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-06T21:04:16.193

您可以使用以下代码在表单提交时将模型实例添加到商店：

```
onSaveClick: function()
{
    var iForm         = this.getFormPanel().getForm(),
        iValues       = iForm.getValues(),
        iStore        = this.getTasksStore();

    iStore.add( iValues );
}, 
```

这是在 MVC 控制器内，控制器也是如此`this`。

对于模型编辑，您可以使用以下方法将表单“绑定”到模型实例`loadRecord`：

```
iFormPanel.loadRecord( this.selection ); 
```

然后，您可以使用以下方法更新模型实例`updateRecord()`：

```
iFormPanel.getForm().updateRecord(); 
```

只是为了好玩（并且可能对某些人有所帮助），它类似于以下代码：

```
onSaveClick: function()
{
    var iForm         = this.getFormPanel().getForm(),
        iRecord       = iForm.getRecord(),
        iValues       = iForm.getValues();

    iRecord.set ( iValues );        
}, 
```

如果您的商店有`autoSync: true`. 将通过配置的代理进行更新（或创建）调用。如果没有自动同步，您必须手动同步您的商店。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T21:45:28.190

您可以继承 Ext.form.action.Action 来为要在 Store 上执行的表单提供加载/保存操作。唯一的问题是在 Ext.form.Basic 中没有“官方”的方式来选择任何非标准的操作，所以我建议一个非官方的覆盖：

```
Ext.define('Ext.form.Advanced', {
    override: 'Ext.form.Basic',

    submit: function(options) {
        var me = this,
            action;

        options = options              || {};
        action  = options.submitAction || me.submitAction;

        if ( action ) {
            return me.doAction(action, options);
        }
        else {
            return me.callParent(arguments);
        }
    },

    load: function(options) {
        var me = this,
            action;

        options = options            || {};
        action  = options.loadAction || me.loadAction;

        if ( action ) {
            return me.doAction(action, options);
        }
        else {
            return me.callParent(arguments);
        }
    }
}); 
```

并且，在创建了您需要的操作之后，您可以在表单面板中使用它们：

```
Ext.define('My.form.Panel', {
    extend: 'Ext.form.Panel',

    requires: [ 'Ext.form.Advanced' ],

    loadAction: 'My.load.Action',
    submitAction: 'My.submit.Action',

    ...
}); 
```

不过还有其他方法和捷径。

# html - 如何垂直对齐这 2 个 div？

> ID：11835732
> 
> 赞同：1
> 
> 时间：2012-08-06T20:49:48.163
> 
> 标签：html, css, vertical-alignment

在[这个 jsFiddle](http://jsfiddle.net/xH2da/)中，如何垂直对齐图像和文本？

HTML：

```
<div class="step_div">
    <div class="step_div_inner">
        <div class="step_div_inner_image">
            <img src="http://i.imgur.com/TasZn.png">
        </div>
        <div class="step_div_inner_text">
            here is some text here is some text here is some text here is some text here is some text here is some text 
        </div>
    </div>
</div>​ 
```

CSS

```
.step_div_inner_text {
    font-size:18px;
    width:460px;
    line-height:24px;
    position:relative;
    left:5px;
    bottom:14px;
    display:inline-block;
}
.step_div_inner_image {
    display:inline-block;
}
.step_div {
    padding:20px 0;
}
.step_div_inner {
    width:574px;
    margin:0 auto;
}​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:01:30.563

你可以像这样使用浮点数：

[http://jsfiddle.net/xH2da/10/](http://jsfiddle.net/xH2da/10/)

如果需要，您只需要确保清除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:01:44.333

[http://jsfiddle.net/xH2da/11/](http://jsfiddle.net/xH2da/11/)

CSS：

```
.step_div_inner_text {
    font-size:18px;
    width:460px;
    position:relative;
    display:inline-block;
    vertical-align: top;
}
.step_div_inner_image {
    display:inline-block;
    vertical-align: middle;
    line-height: 2em;
}
.step_div {
    padding:20px 0;
}
.step_div_inner {
    width:574px;
    margin: auto;
} 
```

[http://www.w3.org/TR/CSS2/visudet.html#propdef-vertical-align](http://www.w3.org/TR/CSS2/visudet.html#propdef-vertical-align)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:09:05.640

这是我最好的镜头...

```
.step_div_inner_text {
    font-size:18px;
    width:460px;
    line-height:18px;
    left:5px;
    vertical-align:top;
    bottom:14px;
    display:inline-block;
}
.step_div_inner_image {
    display:inline-block;
}
.step_div {
}
.step_div_inner {
    width:574px;
    margin:0 auto;
} 
```

而且您仍然可以在图像上方几个像素处推动图片...取决于您使用的文本和字体。你的问题没有明确的答案。但是在您的特定情况下的问题是，行高大于字体大小。

如果你想坚持你的行高，那么你需要在你的 image-div 中添加一个顶部填充，直到它适合你的文本......试验和错误:)

# jquery - 使用 json 值作为 getElementById 标识符

> ID：11835734
> 
> 赞同：1
> 
> 时间：2012-08-06T20:49:50.653
> 
> 标签：jquery, json, innerhtml, getelementbyid

我的页面底部有几个隐藏的硬编码 div，它们在初始页面加载时注入了值

```
<div id="item_name1">123</div>
<div id="item_name2">456</div>
<div id="item_name3">789</div>
<div id="item_name4">123</div>
// etc etc 
```

分别和后来，我获取 JSON 数据并将更多的 html 注入页面

如何根据 JSON 数据值选择和使用隐藏的 div 值之一？

```
$.each(data,...........

var test = data[i].item_name2; 
var x = document.getElementById(test).innerHTML;
...
// then use `x` later 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:52:25.323

如果你想获得一个**jQuery**对象，那么你必须使用 jQuery 变量——`$`在大多数情况下。

```
$.each(data,function(i,elem){
  var test = data[i].item_name2; 
  var x = $("#"+test);
  ...
}); 
```

然后，您将拥有`x`执行 jQuery 函数的对象。

# android - AudioRecorder 阻止麦克风

> ID：11835735
> 
> 赞同：1
> 
> 时间：2012-08-06T20:49:55.863
> 
> 标签：android, audio-recording

我正在开发一个允许用户做语音笔记的应用程序。为此，我使用 AudioRecorder 不断从麦克风获取音频数据并将其处理成 Mp3。

这一切都很好，直到最近我发现如果我在我的应用程序在后台运行时接听/拨打电话，对方听不到我的声音。单击拨号器屏幕上的静音/取消静音按钮不会做任何事情 - 麦克风似乎被禁用，直到我停止我的应用程序。

现在的问题是我该如何处理这种情况？我唯一的选择是在语音通话开始后释放 AudioRecorder 吗？如果 AudioRecorder 在通话期间只是跳过麦克风中的音频数据，我完全没问题，但是用户可以因为应用程序进行通信的情况是不可接受的。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:57:50.100

在任何给定时间，只有 1 个应用可以使用麦克风。您可能想要使用 PhoneStateListener 以便在电话响铃或摘机时释放录音机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:03:18.090

您可以使用 PHONE_STATE 操作作为 BroadcastReceiver 的一部分来拦截来电。然后，在接收器的 onReceive 函数中，您将检查手机的状态：

```
public void onReceive(Context context, Intent intent) {

    String state = intent.getStringExtra(TelephonyManager.EXTRA_STATE);

    if(state.equals(TelephonyManager.EXTRA_STATE_RINGING)){
        //Phone is ringing

    }else if(state.equals(TelephonyManager.EXTRA_STATE_OFFHOOK){
        //Call received

    }else if (state.equals(TelephonyManager.EXTRA_STATE_IDLE)){
        //Call Dropped or rejected

    }

} 
```

不要忘记在清单中添加必要的权限。

同样，您也可以拦截拨出电话。[这](http://www.krvarma.com/2010/08/detecting-incoming-and-outgoing-calls-in-android/)是一个很好的教程，解释了如何做到这两点。

剩下的就是根据你拦截的内容来停止和恢复记录器。

# php - 使用 jquery 和 mysql/php 检查数据库中是否存在用户名

> ID：11835736
> 
> 赞同：1
> 
> 时间：2012-08-06T20:50:03.220
> 
> 标签：php, jquery

两天后，我尝试从用户名中检查新用户是否可以注册。我已经阅读了我发现的所有内容，但我找不到问题所在。

当用户检查是免费的名称时，我不会成为 php/msql 的答案。你能检查我的代码吗？

表代码：

```
<form id="form" method="get" action=""> 
```

```
 <legend>Formular mit Validierung</legend>
    <tr>
        <td><label id="geschlecht">Geschlecht:* </label></td>
        <td><select name="anrede" value=""/> 
        <option> Frau </option> 
        <option> Mann </option> 
        <option> Paar </option>
        </select>
      </td>
    </tr>
    <tr>
        <td><label for="vorname">Vorname* </label></td>
        <td><input type="text" id="vorname" name="vorname" />
     </td>
    </tr>
    <p>
        <label for="nachname">Nachname* (mindestens 2 Zeichen)</label>
        <input type="text" id="nachname" name="nachname" />
    </p>
    <p>
        <label for="email">E-Mail*</label>
        <input id="email" name="email" />
    </p>

    <p>
        <label for="geburtsDatum">Geburtsdatum:*</label>
        <input type="text" name="geburtsDatum"  id="geburtsDatum" value=""/>
    </p>
    <p>
        <label for="username">Benutzername:*</label>
        <input type="text" name="username"  id="benutzername" value=""/>
    </p>       
    <p>
        <label for="message">Mitteilung*</label>
        <textarea id="message" name="message"></textarea>
    </p
    ><p>
        <input class="submit" type="submit" value="Submit"/>
    </p>
</fieldset> 
```

js代码：

```
$(document).ready(function() {
// hier die Methode .validate()
$("#form").validate({
    submitHandler: function() {
    },
    rules: {
        vorname: {
        required: true,
        minlength: 3
    },
        nachname: {
        required: true,
        minlength: 3
    },
    email: {
        required: true,
        email: true 
    },
    geburtsDatum: {
        required: true,
        date: true  
    },

    username: {
            required: true,
            minlength: 3,
            remote: "check.php"
        },

    },
    messages: {
    username: {
            required: "Bitte Tragen Sie ihren Benutzername ein",
            minlength: "Der Benutzername ist zu kurz",
            remote: "Somenoe have already chosen nick like this."
        },
        dateformat: "Choose your preferred dateformat",
        terms: " "
    }
});

var newsletter = $("#newsletter");
var isChecked = newsletter.is(":checked");
var themen = $("#newsletter_themen");
themen[isChecked ? "show" : "hide"]();
//var themaInputs = themen.find("input")
// .attr("disabled", !isChecked);
newsletter.click(function() {
    themen[this.checked ? "fadeIn" : "fadeOut"](1000);
    //themaInputs.attr("disabled", !this.checked);
}); 
```

和php代码：

```
$username = trim(strtolower($_REQUEST['value']));
$sql =" SELECT  login FROM benutzername WHERE  login =  '".$username."' LIMIT 1";
$result = $connector->query($sql);
$num = mysql_num_rows($result);
if ($num == 1){
    echo "true"; 
```

我希望你能帮助我。

最好的问候托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:59:46.427

据我所知，有两种可能：

**A）** `$num = mysql_num_rows($result);`没有设置`$num`为您认为的那样。

**B）** `$num != 1`：而不是

```
if ($num == 1) { ... } 
```

以下内容同样有效，因为您正在测试记录是否存在，而不是*仅存在一条记录*

```
if ($num > 0) { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:01:08.723

这里的问题是，如果您的代码与您的开发中的代码完全相同，那就`$_REQUEST['value']`错了。

它总是未定义的，因为`remote sends the name of the validation element`不是一些任意的占位符。

此外，您需要`$_REQUEST['username']`稍后在代码中使用，重新声明此对象的验证。

还........

你这样做`echo "true".`是错误的，有两个原因。首先，我们需要为这个插件返回一个`json_encode`d 数组来接受响应。2，当我们需要时，使用“true”将返回“\true\” `true`。这是我们发送的 BOOLEAN，而不是字符串。

```
$username = trim(strtolower($_REQUEST['username']));
$sql = sprintf("SELECT login FROM benutzername WHERE login = '%s' LIMIT 1", $username);
$result = $connector->query($sql);
$num = mysql_num_rows($result);
if ($num == 1){
    $valid = true;
}else{
    $valid = false;
}
return json_encode($valid); 
```

这应该做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:02:01.357

```
$username = trim(strtolower($_REQUEST['value'])); SHOULD BE
$username = trim(strtolower($_REQUEST['username'])); 
```

你应该停止使用 mysql 函数并切换到使用 PDO 或 MySQLi。

# javascript - 存储 Cookie Windows Store 应用程序

> ID：11835740
> 
> 赞同：14
> 
> 时间：2012-08-06T20:50:56.013
> 
> 标签：javascript, html, cookies, windows-store-apps, winjs

正如我在[这里](https://stackoverflow.com/questions/11549432/get-http-only-cookie-from-windows-8-js-app)发现的那样，当我调用服务器以请求以 cookie 的形式进行身份验证时，响应中的 cookie 由底层 Metro 框架自动处理。

但是，这意味着我无权访问 cookie，因此，当应用程序暂停以供以后使用时，我无法存储它。我们应该如何在 Metro 框架中存储 cookie 信息？

非常感谢所有帮助，我总是接受答案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-06T02:22:04.670

我们在 Windows 8 应用程序中实现了 sessionStorage 和 localStorage 持久性，作为一个完整的 cookie 替代品，并且效果非常好。两种存储引擎都非常易于使用，您可以在此处阅读它们：[https ://developer.mozilla.org/en-US/docs/Web/Guide/DOM/Storage](https://developer.mozilla.org/en-US/docs/Web/Guide/DOM/Storage)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-09T13:40:21.940

你写了

> 当应用程序暂停以供以后使用时无法存储它

我在我的 Windows 应用商店应用程序中使用了 Google Analytics，我可以说 cookie 已成功存储。您可以通过检查以下文件系统位置来确保：

C:\Users\XXXX\AppData\Local\Packages\XXXXXX\AC\INetCookies

MSDN 上的文档（[链接](http://msdn.microsoft.com/en-us/library/windows/apps/jj553522.aspx)）也确认 Cookie 是支持存储用户数据的方法。

如果我正确理解您的问题：您无需采取任何其他操作即可在 Windows 应用商店应用程序中接受和存储网络 cookie。

# css - IE9 忽略媒体查询

> ID：11835742
> 
> 赞同：2
> 
> 时间：2012-08-06T20:51:23.003
> 
> 标签：css, internet-explorer-9, media-queries

这是我第一次尝试开发响应式网站。它在除 IE9 之外的所有浏览器中都可以正常工作。我知道 IE9 与媒体查询兼容。我检查了兼容性模式是否已关闭并且我没有看到可见的图标，所以我相信它是。我的媒体查询列在基本样式下方。我将在下面粘贴一些媒体查询，以免超出任何字符限制。如果您需要查看更多信息，请告诉我。注意：文档类型适用于 html5。

**媒体查询：**

```
@media only screen and (max-width: 479px) {
  /* 320 =================================================== */

  header .logo a {
    background:url(../images/logo-320.png) no-repeat;
    width:213px;
    height:69px;
    float:left;
    margin-top:35px;
    display:block;
}

}

@media only screen and (max-width: 480px) {
    header {min-width:100%;}

    .main-link-wrap {
    width:100%;
    margin:0 auto;
}

    .featured-prod {
        width:100%; 
    }

    footer {
        min-width:100%;
}

}

@media only screen and (min-width: 480px) {
  /* 480 =================================================== */

    header .logo a {
    background:url(../images/logo-480.png) no-repeat;
    width:310px;
    height:94px;
    float:left;
    margin-top:5px;
    display:block;
}

.featured-prod .product-box {
    width:185px;    
    margin-left:1.8%;
    margin-right:1.8%;
    text-align:left;
    color:#282828;
    font-size:12px;
    font-size:1.2rem;
    line-height:13px;
    float:left;
}

footer .address {
    font-size:22px;
    line-height:32px;   
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:14:56.470

用一个非常简单的 html5 页面进行了测试。

```
<!DOCTYPE html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="style.css" />
</head>
<body>
</body>
</html> 
```

引用了您的样式表。添加

> 身体{背景：#F00;}

到第一个查询和

> 身体{背景：#00F;}

到第二个查询。

在 IE9 中调整大小时，背景从红色变为蓝色，这表明媒体查询正在工作。我建议尝试将相同的内容添加到您的页面以证明媒体查询。

如果背景按预期更改，那么您的 CSS 有其他问题（例如，它是否针对正确的元素；是否是另一种样式覆盖等）

如果背景没有改变，那么您的页面中发生了一些不寻常的事情，或者与兼容性等有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T03:18:55.990

您使用`max-width: 479px`和`max-width: 480px`媒体查询有什么原因吗？我假设您没有在`max-width: 479px`块中看到任何样式？这是因为这些规则被您的`max-width:480px`规则覆盖。

这就是为什么，如果浏览器是 320px 宽 - 这意味着它小于 479px 的最大宽度，但它也小于 480px（两个条件都满足）。而且因为您在它覆盖了这些规则`max-width: 480px`之后就获得了障碍。`max-width:479px`我的建议是让您将规则包含在`max-width: 480px`您的`max-width: 479px`块中，反之亦然。

作为一个仅供参考，这个问题不是 IE9 特有的——在这个意义上安排你的 CSS 规则将在所有浏览器中表现相同。

# c# - 0xC0020001：字符串绑定无效。- 仅发生在 WPF 中

> ID：11835748
> 
> 赞同：22
> 
> 时间：2012-08-06T20:51:46.387
> 
> 标签：c#, c++, wpf

首先，我可能应该说我可能在 5 年级的水平上使用这些东西......我在 WPF 应用程序中使用 C++ 插件。每当我尝试退出程序时，都会收到此错误：

Raptor.exe 中 0x770d15de 处未处理的异常：0xC0020001：字符串绑定无效。

我一直在使用这个[博客条目](http://code.logos.com/blog/2008/04/exception_0xc0020001_in_ccli_assembly.html)来尝试解决问题，但我没有运气。不过我注意到的一件事是，当我在控制台应用程序中使用相同的 C++ 插件，调用 WPF 应用程序中使用的许多相同方法时，控制台会毫无问题地退出。

我也浏览了 C++ 代码，找不到任何地方声明的单个静态变量。虽然有静态方法。

任何帮助将非常感激！

编辑：我启用了一些调试功能来查看它在哪里中断。它破坏了以下最后一个括号中的 sp_counted_impl.hpp 文件（Boost）：

```
 virtual void dispose() // nothrow
    {
#if defined(BOOST_SP_ENABLE_DEBUG_HOOKS)
        boost::sp_scalar_destructor_hook( px_, sizeof(X), this );
#endif
        boost::checked_delete( px_ );
    } 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-07T20:51:50.677

这发生在某些不与本机库链接的 DLL 中，因此它们的 DllMain 不会初始化某些需要的本机子系统（如 CRT 或 ATL）。听起来您有某种混合模式的 DLL。一种推荐的解决方案是从托管 DLL 中删除入口点：删除托管 DLL 的入口点

1.  与 /NOENTRY 链接。在解决方案资源管理器中，右键单击项目节点，单击属性。在“属性页”对话框中，单击“链接器”，单击“命令行”，然后将此开关添加到“附加选项”字段。
2.  链接 msvcrt.lib。在“属性页”对话框中，单击“链接器”，单击“输入”，然后将 msvcrt.lib 添加到“附加依赖项”属性。
3.  删除 nochkclr.obj。在 Input 页面（与上一步相同的页面）上，从 Additional Dependencies 属性中删除 nochkclr.obj。
4.  在 CRT 中链接。在 Input 页面（与上一步相同的页面）上，将 __DllMainCRTStartup@12 添加到 Force Symbol References 属性。

更多细节可以在这里找到：https: [//support.microsoft.com/en-us/kb/814472](https://support.microsoft.com/en-us/kb/814472)

# javascript - 将 javascript 函数作为数组方法调用

> ID：11835749
> 
> 赞同：0
> 
> 时间：2012-08-06T20:51:47.257
> 
> 标签：javascript

**更新**：我知道有 forEach 方法的现有实现。这样做的目的是学习和提高我的 Javascript 技能。

我正在尝试为数组对象实现一个 forEach 方法。我正在做的是以下内容：

```
var list = ['one', 'two', 'three'];

function forEach(callback){
    for(var n = 0; n < this.length; n++){
        callback.call(this[n], n);
    }
};

list.forEach(function(index){
        console.log(index);
        console.log(this);
    }
); 
```

我对javascript不是很好，我正在努力变得更好，所以我读了一点，现在我知道如果我做这种事情，“forEach”函数的上下文将是对象调用它，在本例中为“列表”。

当此代码运行时，我收到错误消息：“未捕获的 TypeError：对象一、二、三没有方法 'forEach'”。

我不明白的是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T20:54:19.570

```
var list = ['one', 'two', 'three'];

list.forEach = function(callback){
    for(var n = 0; n < this.length; n++){
        callback.call(this[n], n);
    }
};

list.forEach(function(index){
        console.log(index);
        console.log(this);
    }
);​ 
```

看来您正试图在该列表对象上创建自己的对象。如果是这样，您需要使其成为该对象的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:57:41.807

您可以使用以下方法设置上下文对象（[`this`关键字](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this)）[`call`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)：

```
myForEach.call(list, function(index) { … }); 
```

另一种可能性是将函数[作为](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this#As_an_object_method)列表对象的属性调用：

```
list.myForEach = function(callback) { … };
list.myForEach(function(index) { … }); 
```

或者通过将其添加到所有[Array](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array)对象的原型中来启用它：

```
Array.prototype.myForEach = function(callback) { … };
['one', 'two', 'three'].myForEach(function(index) { … }); 
```

注意：数组上应该已经有一个[`forEach`方法](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach)。从那里为古老的浏览器使用兼容性垫片来提供完全相同的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T20:59:44.243

我相信您需要在实例化数组之前定义 forEach。

```
Array.prototype.forEach = function (callback) {
    var n;
    for(n = 0; n < this.length; n++){
        callback.call(this[n], n);
    }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T21:01:18.110

我认为您想要做的可能不是将 foreach 函数仅附加到您在这里拥有的一个数组上，而是使其适用于所有数组。为此，您必须编辑 Array 原型（有些人对此有非常强烈的看法，因为您无法防止未来潜在的命名空间冲突 - 但其他人发现它非常有用）。一旦`Array.prototype`对象添加了一个函数，您就可以在任何数组上调用该函数。像这样：

```
var list = ['one', 'two', 'three'];

Array.prototype.myForEach = function(callback){
    for(var n = 0; n < this.length; n++){
        callback.call(this[n], n);
    }
};

list.myForEach(function(index){
    console.log(index);
    console.log(this);
}); 
```

**注意*避免与现有的 forEach 函数发生冲突 (https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach) 我已经命名了`myForEach`我希望避免冲突的函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T21:02:34.963

您需要将 forEach 方法添加到 Arrays 的原型中：

```
/*
* pay attention to the fact that if you use forEach aas method name you'll override
* the built default forEach method, try to use some prefix to distinguish between
* the built in methods and your own ones 
*/
Array.prototype.my_forEach = function(callback){ /* your code here */ }; 
```

# php - CakePHP：如何在每个动作之前检查会话？

> ID：11835759
> 
> 赞同：3
> 
> 时间：2012-08-06T20:52:46.120
> 
> 标签：php, cakephp, authentication, cakephp-2.0

在 Cake 2.2 中我有两件事需要做。我需要检查每个页面上是否有人登录，然后我需要将他们的用户 ID 存储为一个名为 UID 的常量。

我想避免在每个控制器上并且必须检查用户。我希望它自动完成，所以我自然会去 AppController 并尝试 BeforeFilter。它似乎没有初始化会话，所以我从头开始并尝试 afterFilter，但那（和 BeforeRender）真的不是我想要做的；如果他们没有登录，我不希望任何我可以阻止发生的事情发生在页面请求上。据我所知，引导也不是答案。

那么如何检查用户是否已登录，同时为我的应用程序的其余部分定义一个常量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T04:19:42.033

`beforeFilter()`您可以通过在 AppController的方法中调用用户会话检查方法来执行相同操作。您的代码应如下所示：

```
<?php
App::uses('Sanitize', 'Utility');
App::uses('Controller', 'Controller');

class AppController extends Controller
{

public $components = array(
'Session',
    'RequestHandler'
);

public $helpers = array('Html', 'Form', 'Session', 'Js' => array('Jquery'), 'Text');
public $uses = array('User');

public function beforeFilter()
{
    if($this->Session->check('User.id'))
    {
        $this->set('logged_in', true);
        $this->set('username', trim($this->Session->read('User.first_name'). ' '. $this->Session->read('User.last_name')));            
    }
    else
    { 
        $this->set('logged_in', false);
    }
}    
/*.......... Rest of your code ..............*/
} 
```

请询问它是否不适合您。

# jquery - 图像的 Jquery 按钮集大小问题

> ID：11835761
> 
> 赞同：0
> 
> 时间：2012-08-06T20:53:14.003
> 
> 标签：jquery, css, jquery-ui, imagebutton

我有一个按钮集，它主要由每个按钮的单个字符组成。在其中一个按钮中有一个图像。不幸的是，包含图像的按钮无法与按钮集中的其他图像正确对齐，而且它的高度也不是正确的。如果需要截图，可以提供。

* * *

这是一个准确代表我遇到的问题[的 jsFiddle 。](http://jsfiddle.net/kLwmC/)最好我想要一个适用于任何尺寸图像的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T20:58:34.017

我不确定我能想象出你的问题是什么。我建议使用[Fiddle](http://jsfiddle.net/) 并将您的代码放入其中，以便我们查看可能是什么问题，或者如您所说，截图。如果它与 CSS 相关，我会在该特定情况下尝试使用 vertical-align 属性吗？不过，我可能还差得很远。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T15:38:44.453

所以我最终弄清楚了。该`vertical-align`属性被设置为基线，所以我将其更改为`top`. 此外，我使用这个 css 片段将按钮内的任何图像更改为其余按钮的大小。

```
span.ui-button-text > img{
  height: 1.1em; // This is jQuery UI default font-size for buttons.
} 
```

# c - 谁能证明以下程序的输出如何？

> ID：11835764
> 
> 赞同：0
> 
> 时间：2012-08-06T20:53:26.657
> 
> 标签：c

> **可能重复：**
> [如何确定将多字符 char 常量分配给 char 变量的结果？](https://stackoverflow.com/questions/11737320/how-to-determine-the-result-of-assigning-multi-character-char-constant-to-a-char)

我编译了下面给出的程序，输出为`'a'`. 我的问题是：

既然角色一次只能容纳一个角色，那么在第 3 行怎么可能呢？

它如何给出输出`a`？

```
int main()
{
    char ch='ab'; /* line 3 */
    printf("%c",ch);
    return 0;
} 
```

# css - 动画浮动 div

> ID：11835765
> 
> 赞同：0
> 
> 时间：2012-08-06T20:53:33.930
> 
> 标签：css, css-float, css-animations

我正在尝试使用专门用于动画和布局的 CSS 来实现水平手风琴的效果。所以我设置了 4 个列，与经典手风琴的主要区别在于，当我单击一个列时，它应该在两个方向上展开，而不是在一个方向上展开，然后左右推动其他列。

这是我现在代码的紧凑版本：http: [//jsfiddle.net/4ZGmj/183/](http://jsfiddle.net/4ZGmj/183/)

如果单击红色列，它会完全按预期工作：该列在两个方向上展开，所有其他列都被推到右侧。现在，如果您单击绿色列，您会注意到一些不同的情况：该列按预期在两个方向上扩展，但它只会将列推到右侧，同时将列重叠到左侧。我想要的是每列在展开时推动所有相邻的列。

我想这可能与我的列向左浮动有关。你们对导致这种行为的原因以及我能做些什么来解决它有任何见解吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:14:10.897

我认为你的问题可能在 .animate 类中，你给它一个**负**的50px 边距。负边距与“前一个”元素重叠（在所有方向上）。如果删除 -50px，图像只会“流动”到右侧，因为它们是通过 float:left 属性“粘合”的，无论如何这不会做你想要的:(

我认为解决这个问题的方法是使用相对尺寸。尝试设置一个固定宽度的 div 并使用相对尺寸（例如每个 25%）。您可能还必须在 :not clicked div 上设置行为。

就像，如果一个 div 是“.animated”，它有 33% 的宽度，而其他的将有大约 22% ......不过，您可能可以为它安排一个更好的数学！

编辑：错字

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T09:22:47.753

我能够通过从“动画”类中删除负边距值来修复它并获得预期的效果（这负责双向扩展，但也导致向左重叠）。相反，我添加了一个新类“pushleft”，它具有这个负边距值，并且我总是将其应用于第一列。您可以在这里看到效果并更好地理解这个想法：http: [//jsfiddle.net/4ZGmj/185/](http://jsfiddle.net/4ZGmj/185/)

感谢您的帮助，如果不是您的输入，我不会修复它。

# vba - 创建一个没有重复 VBA 的新列？

> ID：11835771
> 
> 赞同：2
> 
> 时间：2012-08-06T20:53:56.550
> 
> 标签：vba, excel

我有一列单元格的值是这样的：

```
a
a
b
b
c
c
c
c
d
e
f
f 
```

等等

我正在寻找不重复的值并将它们粘贴到一个新列中。我的伪代码如下：

```
ActiveSheet.Range("a1").End(xlDown).Select
aend = Selection.Row
for acol= 1 to aend
    ActiveSheet.Range("b1").End(xlDown).Select
    bend = Selection.Row
        'if Cells(1,acol).Value <> any of the values in the range Cells(2,1).Value
        'to Cells(2,bend).Value, then add the value of Cells(1,acol) to the end of 
        'column b. 
```

我在这方面的逻辑有意义吗？我不确定如何对注释部分进行编码。如果这不是最有效的方法，有人可以提出更好的方法吗？非常感谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-06T22:24:36.770

根据您使用的 Excel 版本，您可以使用一些内置的 Excel 功能来获得您想要的 - 整个解决方案取决于您对 VBA 的技能水平。

**Excel 2003**：

您可以使用范围的`Advancedfilter`方法（[文档](http://msdn.microsoft.com/en-us/library/office/ff841242.aspx)）来获取唯一值并将它们复制到您的目标区域。例子：

```
With ActiveSheet
    .Range("A1", .Range("A1").End(xlDown)).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=.Range("B1"), Unique:=True
End With 
```

`B1`您希望将唯一值复制到的列的第一个单元格在哪里。此方法的唯一问题是源列（“A1”）的第一行即使被复制也会被复制到目标范围。这是因为 AdvancedFilter 方法假定第一行是标题。

因此，添加一个额外的代码行：

```
With ActiveSheet    
    .Range("A1", .Range("A1").End(xlDown)).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=.Range("B1"), Unique:=True
    .Range("B1").Delete Shift:=xlShiftUp
End With 
```

**Excel 2007 / 2010**：

您可以使用与上述相同的方法，也可以使用`RemoveDuplicates`方法（[文档](http://msdn.microsoft.com/en-us/library/office/ff193823)）。这类似于 AdvancedFilter 方法，除了`RemoveDuplicates`就地工作，这意味着您需要复制源列，然后执行过滤，例如：

```
With ActiveSheet
    .Range("A1", .Range("A1").End(xlDown)).Copy Destination:=.Range("B1")
    .Range("B1", .Range("B1").End(xlDown)).RemoveDuplicates Columns:=1, Header:=xlNo
End With 
```

最后一个参数`Header`控制是否将源数据的第一个单元格复制到目标（如果设置为 true，则该方法类似于 AdvancedFilter 方法）。

如果您追求“更纯粹”的方法，那么您可以使用 VBA`Collection`或`dictionary`- 我相信其他人会为此提供解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T22:02:57.393

我使用一个不能有重复键的集合来从列表中获取唯一项。尝试将每个项目添加到集合中，并在存在重复键时忽略错误。然后您将拥有一个包含唯一值子集的集合

```
Sub MakeUnique()

    Dim vaData As Variant
    Dim colUnique As Collection
    Dim aOutput() As Variant
    Dim i As Long

    'Put the data in an array
    vaData = Sheet1.Range("A1:A12").Value

    'Create a new collection
    Set colUnique = New Collection

    'Loop through the data
    For i = LBound(vaData, 1) To UBound(vaData, 1)
        'Collections can't have duplicate keys, so try to
        'add each item to the collection ignoring errors.
        'Only unique items will be added
        On Error Resume Next
            colUnique.Add vaData(i, 1), CStr(vaData(i, 1))
        On Error GoTo 0
    Next i

    'size an array to write out to the sheet
    ReDim aOutput(1 To colUnique.Count, 1 To 1)

    'Loop through the collection and fill the output array
    For i = 1 To colUnique.Count
        aOutput(i, 1) = colUnique.Item(i)
    Next i

    'Write the unique values to column B
    Sheet1.Range("B1").Resize(UBound(aOutput, 1), UBound(aOutput, 2)).Value = aOutput

End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-06T18:13:13.523

为了完整起见，我发布了 Scripting.Dictionary 方法：它是使用 VBA.Collection 的最常见替代方法，它避免了在正常操作中依赖错误处理的需要。

### 使用 Scripting.Dictionary 对象从包含重复项的 Excel 范围返回唯一值的 VBA 函数：

```
Option Explicit

'           Author: Nigel Heffernan
'           May 2012  http://excellerando.blogspot.com

'           **** THIS CODE IS IN THE PUBLIC DOMAIN ****
'
'           You are advised to segregate this code from
'           any proprietary or commercially-confidential
'           source code, and to label it clearly. If you
'           fail do do so, there is a risk that you will
'           impair your right to assert ownership of any
'           intellectual property embedded in your work,
'           or impair your employers or clients' ability
'           to do so if the intellectual property rights
'           in your work have been assigned to them.
'

Public Function UniqueValues(SourceData As Excel.Range, _
                             Optional Compare As VbCompareMethod = vbBinaryCompare _
                             ) As Variant
Application.Volatile False

' Takes a range of values and returns a single-column array of unique items.

' The returned array is the expected data structure for Excel.Range.Value():
' a 1-based 2-Dimensional Array with dimensions 1 to RowCount, 1 to ColCount

' All values in the source are treated as text, and uniqueness is determined
' by case-sensitive comparison. To change this, set the Compare parameter to
' to 1, the value of the VbCompareMethod enumerated constant 'VbTextCompare'

' Error values in cells are returned as "#ERROR" with no further comparison.
' Empty or null cells are ignored: they do not appear in the returned array.

Dim i As Long, j As Long, k As Long
Dim oSubRange As Excel.Range
Dim arrSubRng As Variant
Dim arrOutput As Variant
Dim strKey    As String
Dim arrKeys   As Variant

Dim dicUnique As Object

' Note the late-binding as 'object' - best practice is to create a reference
' to the Windows Scripting Runtime: this allows you to declare dictUnique as
' Dim dictUnique As Scripting.Dictionary  and instantiate it using the 'NEW'
' keyword instead of CreateObject, giving slightly better speed & stability.

If SourceData Is Nothing Then
    Exit Function
End If

If IsEmpty(SourceData) Then
    Exit Function
End If

Set dicUnique = CreateObject("Scripting.Dictionary")
    dicUnique.CompareMode = Compare

For Each oSubRange In SourceData.Areas   ' handles noncontiguous ranges

    'Use Worksheetfunction.countA(oSubRange) > 0 to ignore empty ranges

    If oSubRange.Cells.Count = 1 Then
        ReDim arrSubRng(1 To 1, 1 To 1)
        arrSubRng(1, 1) = oSubRange.Cells(1, 1).Value
    Else
        arrSubRng = oSubRange.Value
    End If

    For i = LBound(arrSubRng, 1) To UBound(arrSubRng, 1)
        For j = LBound(arrSubRng, 2) To UBound(arrSubRng, 2)
            If IsError(arrSubRng(i, j)) Then
                dicUnique("#ERROR") = vbNullString
            ElseIf IsEmpty(arrSubRng(i, j)) Then
                ' no action: empty cells are ignored
            Else
            '   We use the error-tolerant behaviour of the Dictionary:
            '   If you query a key that doesn't exist, it adds the key
                dicUnique(CStr(arrSubRng(i, j))) = vbNullString
            End If
        Next j
    Next i

    Erase arrSubRng

Next oSubRange

If dicUnique.Count = 0 Then
    UniqueValues = Empty
Else
    arrKeys = dicUnique.keys
    dicUnique.RemoveAll

    ReDim arrOutput(1 To UBound(arrKeys) + 1, 1 To 1)
    For k = LBound(arrKeys) To UBound(arrKeys)
        arrOutput(k + 1, 1) = arrKeys(k)
    Next k
    Erase arrKeys

    UniqueValues = arrOutput

    Erase arrOutput
End If

Set dicUnique = Nothing

End Function 
```

几点注意事项：

1.  这是任何 Excel 范围的代码，而不仅仅是您要求的单列范围。
2.  此函数允许有错误的单元格，这些错误在 VBA 中很难处理。
3.  这不是 Reddit：您可以阅读评论，它们有助于理解并且通常有益于您的理智。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-06T18:33:33.870

我会使用一个简单的数组，遍历所有字母并检查您所在的字母是否在数组中：

```
Sub unique_column()

Dim data() As Variant 'array that will store all of the unique letters

c = 1

Range("A1").Select

Do While ActiveCell.Value <> ""

    ReDim Preserve data(1 To c) As Variant

    If IsInArray(ActiveCell.Value, data()) = False Then 'we are on a new unique letter and will add it to the array
        data(c) = ActiveCell.Value
        c = c + 1
    End If

    ActiveCell.Offset(1, 0).Select

Loop

'now we can spit out the letters in the array into a new column

Range("B1").Value = "Unique letters:"

Dim x As Variant

Range("B2").Select

For Each x In data()

    ActiveCell.Value = x

    ActiveCell.Offset(1, 0).Select

Next x

Range("A1").Select

c = c - 1

killer = MsgBox("Processing complete!" & vbNewLine & c & "unique letters applied.", vbOKOnly)

End Sub

Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean

    IsInArray = (UBound(Filter(arr, stringToBeFound)) > -1)

End Function 
```

# java - 当我按下搜索按钮将用户输入字段留空时，我得到 java.lang.NumberFormatException

> ID：11835772
> 
> 赞同：0
> 
> 时间：2012-08-06T20:53:56.310
> 
> 标签：java, exception, numberformatexception

当我按下搜索按钮将用户输入字段留空时，我收到以下错误页面：

```
java.lang.NumberFormatException: For input string: ""
    java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
    java.lang.Integer.parseInt(Integer.java:470)
    java.lang.Integer.parseInt(Integer.java:499) 
```

引发错误的代码是`int nstudentid = Integer.parseInt(studentid);`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T13:54:55.173

您试图从一个空字符串中解析一个数字，您应该添加一个检查：

```
//this means the number is not empty
if(studentid != null && !studentid.equals("")){
    int studentIdNum = Integer.parseInt(studentid);
}
else{
   //no number, deal with it
   throw new Exception("Invalid student Id!");
} 
```

# algorithm - 高效的模式匹配/字符串合并算法

> ID：11835780
> 
> 赞同：0
> 
> 时间：2012-08-06T20:54:36.747
> 
> 标签：algorithm, pattern-matching, similarity, knuth-morris-pratt

我正在寻找一种用于合并字符串的算法（最好使用 java 实现）。

我的问题如下：

假设我有一个字符串数组/列表*{"myString1" , "my String1" , "my-String-1" ... }*值表示“ **myString1** ”。

所以我想压缩我的清单。也许这可以用 KMP 来完成，或者也许有更合适的东西。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:00:11.247

我认为[编辑距离](http://en.wikipedia.org/wiki/Edit_distance)对于合并字符串是很好的启发式方法。

**编辑：**

您可以修改编辑距离算法：

您可以为字符 c 赋予不同的 d(-,c) 值。

所以在下面的例子中：“String1”，“String2”，你可以“惩罚”分数，但让 d(1,2) 很高，而“String 1”，“String1”则不会受到惩罚，因为分数将为 d(-,' ')。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:03:43.253

或者，[近似字符串匹配](http://en.wikipedia.org/wiki/Approximate_string_matching)可能会有一些用处。我不相信 KMP 适合这个目的，因为它是为精确的子字符串匹配而设计的

# bonjour - mDNS 究竟是如何解析地址的？

> ID：11835782
> 
> 赞同：20
> 
> 时间：2012-08-06T20:54:53.157
> 
> 标签：bonjour, jmdns, mdns, dns-sd

一旦通过 DNS-SD 发现服务，该主机的地址究竟如何得到解析，是否需要更多的时间/开销？

此外，如果我使用 JmDNS 或 Bonjour，则`serviceFound`和`serviceResolved`. 如果我只是对发布某项服务的设备的 IP 地址感兴趣，是否有比通过两者更快/更有效的方式获取`serviceFound`地址`serviceResolved`？

谢谢

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-09-03T17:04:21.560

DNS-SD 使用多播 DNS (MDNS)，其工作原理是通过 UDP 将 DNS 数据包发送到某个多播地址。网络中所有支持 mdns 的主机也会监听这个地址。它使用UDP，因此开销非常低。此外，客户端的设计方式是通过使用广泛的缓存将网络上的聊天量保持在最低限度。

服务发现是一个两步过程。第一步是查找提供某种服务（例如打印）的所有主机的名称。这还不会给你 IP 地址，而是给你 mdns 名称（以 结尾`.local`）。这是因为 ip 可能会改变，而名称不会。

服务发现的第二步是`.local`通过 mdns 解析主机名。您通过多播询问谁`foo.local`是谁，`foo.local`将看到该数据包，并通过广播响应其 IP 地址、端口号和其他信息。

# multithreading - “当前顶点声明不包括所需的所有元素”

> ID：11835785
> 
> 赞同：1
> 
> 时间：2012-08-06T20:55:11.737
> 
> 标签：multithreading, xna

“当前顶点声明不包括当前顶点着色器所需的所有元素。缺少 TextureCoordinate0。”

当我尝试使用 spriteFont 在屏幕上绘制我的 FPS 时出现此错误，在我调用 spriteBatch.End() 的行上

我的效果甚至不使用纹理坐标。但是我找到了问题的根源，只是没有找到解决方法。我有一个单独的线程来构建几何（一个 LOD 算法），不知何故这似乎就是我遇到问题的原因。如果我使它成为非线程化的并且只是每帧更新我的网格，我不会收到错误消息。而且，如果我保持多线程但不尝试在屏幕上绘制文本，它工作正常。我不能两者都做。

更奇怪的是，它实际上编译并运行了一段时间。但总是崩溃。我在构建网格的方法中放置了一个 Thread.Sleep 以减少它发生的频率，我发现我让这个线程休眠的次数越多，它被调用的次数越少，它在崩溃前平均运行的时间就越长。如果它休眠 1000 毫秒，它可能会运行一分钟。如果它休眠 10 毫秒，它甚至不会在崩溃前显示一帧。这让我相信它与您在屏幕上绘制文本的同时在网格构建线程上执行的特定代码行有关。

似乎我在绘制文本时必须锁定某些东西，但我不知道。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T05:39:38.093

我的信息来自GDC 2008的演示文稿“[了解 XNA 框架性能”。它说：](http://www.microsoft.com/en-us/download/details.aspx?id=16477)

> *   GraphicsDevice 在某种程度上是线程安全的
>     *   一次不能从多个线程渲染
>     *   可以创建资源，`SetData`而另一个线程呈现
> *   ContentManager 不是线程安全的
>     *   可以有多个实例，但每个线程只有一个

我的猜测是你在某处违反了这些规则之一。或者您正在修改一个缓冲区，该缓冲区用于在没有适当锁定的情况下进行渲染。

# jquery - 在 Windows XP 上使用 IE8 无法正确显示的背景图像 .png

> ID：11835786
> 
> 赞同：1
> 
> 时间：2012-08-06T20:55:12.517
> 
> 标签：jquery, css, internet-explorer-8, windows-xp, iepngfix

我使用带有“*冰云*”图像的背景，我确实会消失，然后使用 jQuery 并使用**.fadeTo()**函数重新出现。由于背景图像是**.png**，如果您在 SO **Windows xp上使用****IE8** ，我会看到背景图像好像带有黑色/灰色边框并且透明不完美，而如果您使用的是**其他浏览器**'冰云'**是正常**的。我会知道是否有一些插件 jQuery 或 css 过滤器可以解决 IE8 上的这种透明不兼容问题。

 ******html:

```
<div class="ice"></div> 
```

CSS：

```
#main #slogan #iphone .ice {
    position:absolute;
    top:20px;
    right:22px;
    display:block;
    width:450px;
    height:486px;
    background:transparent url(../images/system/main-animation-ice.png) no-repeat 0 0;
    z-index:1;
} 
```

javascript:

```
$(o).delay(i*'1200').fadeTo(2000,1.0).fadeTo(2000,0.2); 
```

左边是正常效果，右边是IE8的bug。

![在此处输入图像描述](../Images/204f38b673feb3b2298850e4c6f1843e.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T20:59:49.613

您可以使用 IE 的专有过滤系统在 CSS 中完成此操作。

```
 #main #slogan #iphone .ice {
     position:absolute;
     top:20px;
     right:22px;
     display:block;
     width:450px;
     height:486px;
     background:url(../images/blank.gif), transparent url(../images/system/main-animation-ice.png) no-repeat 0 0;
     filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true',sizingMethod='scale',src='../images/system/main-animation-ice.png');
     z-index:1;
 } 
```

您需要为背景声明中的“第一个”图像使用空白.gif。这只是为了混淆ie8，阻止它同时使用你设置的滤镜和背景，只使用滤镜。其他浏览器支持多个背景图像，并且会理解背景声明而不理解过滤器，因此仅使用背景。

您可能还需要使用`sizingMethod`过滤器中的 ，以使其以您想要的方式工作。

**更新**

我在 ie8 中查看了你的网站，你在这里遇到的问题比你在这篇文章中提到的要多。

首先，您没有包含覆盖，`background : none`因此 ie8 现在为您提供了过滤器版本和损坏的背景版本。

其次，您不仅将其用作背景图像，而且还用作精灵。您不能将精灵与 alpha 图像加载器一起使用；因为没有背景位置属性。因此，您需要将其分成 3 张图像并在过滤器中在它们之间切换，而不是使用背景位置进行切换。

第三部动画表现很糟糕。您要求 ie8 同时改变 6 个透明图像的不透明度。即使使用 alphaImageLoader，这也会使某人的浏览器崩溃。

我的建议。对于ie8`$('.ice').hide();`

**然而，这种在 ie8 中修复 png 的方法确实有效[http://jsfiddle.net/ZSYbU/2/](http://jsfiddle.net/ZSYbU/2/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T20:57:33.360

我不相信有办法在 IE 8 中避免这种不透明动画问题。我也遇到过，但从未找到解决方案。如果有的话，我很想学。******

# maven - 使用带有 maven surefire 插件的自定义记者

> ID：11835790
> 
> 赞同：3
> 
> 时间：2012-08-06T20:55:56.313
> 
> 标签：maven, testng, surefire

我正在尝试使用带有 maven surefire 插件的 TestNG 自定义报告器。我已经有一个自定义侦听器，并且似乎被采纳了。但是，看起来根本没有使用自定义报告器：

```
<plugin>
    <artifactId>maven-surefire-plugin</artifactId>
    <configuration>
        <testFailureIgnore>false</testFailureIgnore>
        <properties>
            <property>
                <name>listener</name>
                <value>com.mystuff.test.TestNGListener</value>
            </property>
            <property>
                <name>reporter</name>
                <value>com.mystuff.test.MyEmailableReporter</value>
            </property>
        </properties>
    </configuration>
</plugin> 
```

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T23:40:53.623

我想通了。看起来以下内容根本不起作用：

```
<property>
    <name>reporter</name>
    <value>com.mystuff.test.MyEmailableReporter</value>
</property> 
```

尽管有相反的文件。在`TestNG`该类中，似乎有一个名为 的方法`TestNG#addListener(IReporter listener)`，与它的名称相反，它接受一个实现的报告`IReporter`。Maven Surefire (v2.12.1) 调用此方法来添加监听器和报告。但是，它不会在具有 name 的属性下查找报告`reporter`。相反，您必须将自定义报告器添加到`listener`属性中：

```
<plugin>
    <artifactId>maven-surefire-plugin</artifactId>
    <configuration>
        <testFailureIgnore>false</testFailureIgnore>
        <properties>
            <property>
                <name>listener</name>
                <value>com.mystuff.test.TestNGListener,com.mystuff.test.MyEmailableReporter</value>
            </property>
        </properties>
    </configuration>
</plugin> 
```

不是很直观。

# python - 为什么python双引号在文件名中转换为连字符？

> ID：11835793
> 
> 赞同：5
> 
> 时间：2012-08-06T20:56:07.750
> 
> 标签：python, django, string, reportlab

我正在使用 Django 中的 ReportLab 生成一些 pdf。我遵循并尝试了[这个问题](https://serverfault.com/questions/358580/django-dynamic-file-name)的答案，并意识到其中的双引号没有意义：

```
response['Content-Disposition'] = 'inline; filename=constant_"%s_%s".pdf'\
% ('foo','bar') 
```

给出文件名`constant_-foo_bar-.pdf`

```
response['Content-Disposition'] = 'inline; filename=constant_%s_%s.pdf' \
% ('foo','bar') 
```

给出文件名`constant_foo_bar.pdf`

为什么是这样？它只是与文件系统的 slug-esque 消毒有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T19:32:05.000

从[这个问题](https://stackoverflow.com/questions/7967079/special-characters-in-content-disposition-filename?lq=1)的研究看来，实际上是浏览器在进行编码/转义。我曾经[`cURL`](http://curl.haxx.se/)确认 Django 本身不会转义这些标头。首先，我设置了一个最小的测试视图：

```
# views.py 
def index(request):
    response = render(request, 'template.html')
    response['Content-Disposition'] = 'inline; filename=constant"a_b".html'
    return response 
```

然后跑：

```
carl@chaffinch:~$ HEAD http://localhost:8003
200 OK
Date: Thu, 16 Aug 2012 19:28:54 GMT
Server: WSGIServer/0.1 Python/2.7.3
Vary: Cookie
Content-Type: text/html; charset=utf-8
Client-Date: Thu, 16 Aug 2012 19:28:54 GMT
Client-Peer: 127.0.0.1:8003
Client-Response-Num: 1
Content-Disposition: inline; filename=constant"a_b".html 
```

查看标题：`filename=constant"a_b".html`. 引号还在！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T19:07:42.727

Python 不会将双引号转换为文件名中的连字符：

```
>>> with open('constant_"%s_%s".pdf' % ('foo', 'bar'), 'w'): pass 
```

```
    $ ls
    ...
    常量_“foo_bar”.pdf
    ...

```

可能是 django 不允许您使用太奇怪的名称。

无论如何，我建议在文件名中*仅*使用以下字符，以避免可移植性问题：

*   字母 [az][AZ]
*   数字 [0-9]
*   连字符 (-)、下划线 (_)、加号 (+)

**注意：**我已经排除了列表中的空格，因为有很多脚本没有使用正确的引用，并且使用这样的文件名中断。

如果您将自己限制在这组字符中，您可能永远不会对路径名有任何问题。显然，其他人或其他程序可能仍然不遵循此“指南”，因此您不应假设此约定由您从用户或其他外部来源获得的路径共享。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-16T19:15:07.563

你的用法有点不正确。您可能需要整个文件名周围的引号以说明空格等。

改变：

```
response['Content-Disposition'] = 'inline; filename=constant_"%s_%s".pdf'\
% ('foo','bar') 
```

到：

```
response['Content-Disposition'] = 'inline; filename="constant_%s_%s.pdf"'\
% ('foo','bar') 
```

# oracle - Oracle dbms_utilities.get_hash_value 是否总是为不同的输入返回唯一值？

> ID：11835795
> 
> 赞同：1
> 
> 时间：2012-08-06T20:56:15.170
> 
> 标签：oracle, hash

根据我所做的实验，我认为答案是否定的。但是我不确定我是否正确地做事。

我的功能是：

```
select buyer_key, DBMS_UTILITY.get_hash_value(buyer_key||'|'||buyer_entity_id||'|'||buyer_io_id||'|'||buyer_line_item_id||'|'||is_billing_enabled||'|'||currency_id_b_trgt||'|'||currency_id_b_prfrd||'|'||ymdh_max,1,POWER(2,16)-1) as hashvalue from network_buyer_dim order by hashvalue asc; 
```

当我运行它时，它会返回许多带有重复哈希键值的行。但是当我去数据库查看那些行（顺便说一句，每个buyer_key 都是唯一的）时，我发现这些行不包含相同的值。

我是否正确调用该函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:13:48.093

显然不是！！

> [散列函数](http://en.wikipedia.org/wiki/Hash_function)是任何算法或子程序，可将可变长度的大型数据集（称为键）映射到固定长度的较小数据集。例如，具有可变长度的人名可以散列为单个整数。散列函数返回的值称为散列值、散列码、散列和、校验和或简称为散列。

这意味着如果输入域集大小大于输出域集大小，则应该存在重复项。

除此之外，最好的散列函数被认为是那些倾向于为所有可能的输入值提供相同数量的重复输出值的散列函数。

# ms-access - 使用 VBA 查询记录集对象

> ID：11835797
> 
> 赞同：1
> 
> 时间：2012-08-06T20:56:21.027
> 
> 标签：ms-access, ms-access-2003, recordset

我正在使用 Access 2003 并有一个允许用户从各种过滤器中进行选择的表单，并且我使用 VBA 来更新基于这些过滤器的子表单的记录集（我在 VBA 中生成一条 SQL 语句）。这个子表单可以有重复的客户端 ID，现在我正在尝试获取一个唯一的客户端 ID 列表。

如果我有子表单的源 SQL，是否有任何简单的方法可以使用 VBA 查询唯一的客户端 ID？我想到了这些选项：

*   将所有 id 写入临时表，然后查询该表（似乎需要更多的工作/资源）
*   以某种方式将查询应用于 VBA 中的记录集对象（这可能吗？）；我将记录集对象设置为等于 SQL 查询，然后尝试运行 a `SELECT DISTINCT client_id FROM <the recordset object>`，但我没有找到任何信息让我相信这是可能的
*   根据原始查询生成一个新的 SQL 查询（我希望`SELECT DISTINCT client_id FROM ('original select query text here')`可以工作，但它在 FROM 语句中给了我一个语法错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:18:21.803

瞄准第三种选择。如果您为子查询设置别名，这应该可以工作，并且`'original select query text here'`可以适合。

```
SELECT DISTINCT sub.client_id
FROM
    (
        'original select query text here'
    ) AS sub 
```

如果 Access 仍然阻塞，请向我们展示您的`'original select query text here'`.

你对替代＃1是对的......那是浪费。

备选方案 #2 是不可能的，因为 Access 不允许您使用记录集对象作为`FROM`源来运行查询。

# php - 无法将图像上传到 magento 产品

> ID：11835800
> 
> 赞同：-1
> 
> 时间：2012-08-06T20:56:39.320
> 
> 标签：php, javascript, image, magento, upload

我一直在排查为什么我的产品图片无法在 magento 的管理面板中上传/显示。我已经尝试了网络上的所有修复，但似乎无法解决问题。我可以浏览，找到文件，点击上传，我什至可以看到加载状态显示正在上传的文件的百分比。在它完成上传之后，图像应该在的位置旁边会出现一个删除按钮，但实际图像并没有显示出来。

我已经更新了prototype.php

我试过这个：[http ://blog.magentoconnect.us/image-upload-problemissue-magento-1-6/comment-page-1/#comment-98275](http://blog.magentoconnect.us/image-upload-problemissue-magento-1-6/comment-page-1/#comment-98275)

这： http: [//www.magentocommerce.com/boards/viewthread/219072/P15/](http://www.magentocommerce.com/boards/viewthread/219072/P15/)

我在没有 javascript 的情况下安装了扩展图像上传器，但无济于事。

我已经尝试了几乎所有我能想到的东西。不太确定为什么会发生这种情况，因为一周左右前一切正常。任何帮助或方向都会非常有帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T06:11:25.163

这可能是因为您安装了一些扩展。我有同样的问题，但在删除扩展后它工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T07:44:52.917

安装最新版本的 Flash Player 并检查一下。

# jquery - 圆顶背景图像的画布 drawImage

> ID：11835801
> 
> 赞同：0
> 
> 时间：2012-08-06T20:56:52.957
> 
> 标签：jquery, html, canvas

我正在尝试使用画布将 dom 元素背景图像的一部分绘制到画布标签。这是我现在所拥有的。

```
var draw = function( data ){
    var canvasStr = '<canvas id="highlight" width='300' height='200'></canvas>' 
    var canvasEl = $(canvasStr).appendTo( wrapper );
    var context = canvasEl.get(0).getContext('2d');
    var imgSource = wrapper.find('.invoice').get(0);
    context.drawImage(imgSource, 0, 0, 300, 200);
} 
```

看起来它无法直接从 jquery 读取 imageSource。我将如何做才能让它发挥作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:03:31.990

尝试

```
context.drawImage(imgSource[0], 0, 0, 300, 200); 
```

您将 jquery 对象传递给 drawImage 而不是图像对象。还要确保在将图像绘制到画布之前加载图像。

**编辑：**

抱歉，没有发现该图像是背景图像。在这种情况下，您将需要从背景图像的源创建一个新图像。像这样的东西......

```
var img = new Image();
img.src = $(wrapper.find('.invoice').get(0)).css('background-image').replace(/^url\(["']?/, '').replace(/["']?\)$/, '');
img.onload = function() {
    context.drawImage(img, 0, 0, 300, 200);
}; 
```

你明白我的意思是确保图像已加载吗？图像需要时间通过网络加载，因此一旦您设置源，它就不会可用。您必须设置一个 onload 处理程序以确保可以绘制该图像。

# php - 在 Magento 主页显示自定义块

> ID：11835804
> 
> 赞同：0
> 
> 时间：2012-08-06T20:57:06.373
> 
> 标签：php, magento

[我在 Magento 的主页上](https://stackoverflow.com/questions/4366177/static-block-on-home-page-in-magento)看到了这个答案静态块，但无法使其工作。

我只是想在我的主页中添加一个自定义块。这些是我做过的事情：

1-将此添加到我的布局文件中。

```
<cms_index_index>
    <reference name="content">
       <block type="aitshopassist/assistant" name="aitshopassist_assistant" template="aitshopassist/assistant.phtml">
           <action method="setBlockId"><block_id>shop_assistant_block</block_id>
           </action>
       </block>
     </reference>
</cms_index_index> 
```

2-将此添加到 2columns-right.phtml 文件中：

```
<?php echo $this->getChildHtml('shop_assistant_block') ?> 
```

此外，该块在 catalog_category_view 中正确显示。

我错过了什么？

```
<catalog_category_view>
    <reference name="content">
        <block type="aitshopassist/assistant" name="aitshopassist_assistant" template="aitshopassist/assistant.phtml" before="category.products" />
    </reference>
</catalog_category_view> 
```

我在 cms_index_index 中试过这个但没有用..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T10:03:10.747

```
 <block type="cms/block" name="aitshopassist_assistant" before="-">
        <action method="setBlockId"><block_id>shop_assistant_block</block_id></action>
  </block> 
```

在 xml 文件中设置它以调用块

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-23T08:51:51.450

只需在您的主 phtml 文件中回显以下代码：

```
$this->getLayout() ->getBlockSingleton('aitshopassist/assistant')->setTemplate('aitshopassist/assistant.phtml')->toHtml(); 
```

# asp.net - 多个 RegisterClientScriptBlock 的

> ID：11835809
> 
> 赞同：5
> 
> 时间：2012-08-06T20:57:14.193
> 
> 标签：asp.net

我想在我的 .cs 文件上调用 3 个 javascript 函数，我试过这个：

```
protected void Page_Load(object sender, EventArgs e)
        {
            if (IsPostBack)
            {
                ClientScriptManager script = Page.ClientScript;
                ClientScriptManager script2 = Page.ClientScript;
                ClientScriptManager script3 = Page.ClientScript;

                script.RegisterClientScriptBlock(this.GetType(), "key", "centerPopup1()", true);
                script2.RegisterClientScriptBlock(this.GetType(), "key", "loadPopup1()", true);
                script3.RegisterClientScriptBlock(this.GetType(), "key", "msg1()", true);

            }
        } 
```

没有成功，我的回传没有任何反应，但如果我尝试只调用其中一个函数，它就可以工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T21:06:21.413

我相信您只能注册一个 StartupScript Block 和多个 ClientScriptBlocks（不同的键）而不是创建多个；让它们彼此相邻。

启动：将在表单中加载 ClientScript：页面底部

```
script.RegisterClientScriptBlock(this.GetType(), "key", "centerPopup1(); 
loadPopUp1();  msg1();", true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:05:10.707

您始终为脚本块使用相同的标识符（*“key”*）。如果我没记错的话，在这种情况下，最后一个脚本块获胜。所以你应该提供不同的密钥。

[MSDN](http://msdn.microsoft.com/en-us/library/btf44dc9.aspx)：

> 客户端脚本由其密钥和类型唯一标识。具有相同键和类型的脚本被认为是重复的。页面中只能注册一个具有给定类型和密钥对的脚本。尝试注册已注册的脚本不会创建该脚本的副本。

编辑：我假设您还想仅在初始加载而**不是**回发时注册脚本。所以你应该检查一下`if(!IsPostBack)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:02:46.550

尝试使用 RegisterStartupScript 而不是 RegisterClientScriptBlock。使用 RegisterClientScriptBlock，您的脚本调用可能会在页面的其余部分加载之前执行。如果您尝试引用的组件尚未加载，则调用将失败。

此外，您必须将您的 JavaScript 代码包含在脚本标签中。

请参阅[ClientScriptManager.RegisterStartupScript 方法（类型、字符串、字符串、布尔值）](http://msdn.microsoft.com/en-us/library/z9h4dk8y)。

# android - Facebook XMPP、API 和会话密钥失败

> ID：11835817
> 
> 赞同：0
> 
> 时间：2012-08-06T20:57:50.927
> 
> 标签：android, facebook, xmpp

我正在尝试使用 asmack 库为我的 XMPP 应用程序创建所需的 Facebook 密钥。我发现了一个关于 SO 的问题，建议使用这样做[。](https://stackoverflow.com/questions/8532328/problems-with-connecting-to-facebook-xmmp-md5-digest)

此外，该帖子还指出您需要创建一个对该[url 的 HTTPget 请求：](https://api.facebook.com/method/auth.promoteSession?access_token=yourAccessToken)

我使用 Async 发出 HttpGet 请求（标准的东西，一切正常，所以没有必要向你展示）。但是，响应只是无休止的向右箭头移动。我是否需要包含用户用户名并通过，我没有提交任何内容，但 SO 答案明确指出它是 HttpGET 而不是 HttpPost，当我在浏览器中访问上述链接时，它只是一个带有错误代码 190，我认为这是 Facebook 内部错误，因为该数字没有 TCP/HTTP 错误。

如果你愿意，我可以包含代码，它真的很乱。

谢谢，这是参考的回应。

```
07-23 07:09:33.305: E/FBAPIRESULT(7404): <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
07-23 07:09:33.315: E/FBAPIRESULT(7404): <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
07-23 07:09:33.686: W/System.err(7404): java.security.KeyStoreException: java.security.NoSuchAlgorithmException: KeyStore jks implementation not found
07-23 07:09:33.686: W/System.err(7404):     at java.security.KeyStore.getInstance(KeyStore.java:119)
07-23 07:09:33.686: W/System.err(7404):     at org.jivesoftware.smack.ServerTrustManager.<init>(ServerTrustManager.java:70)
07-23 07:09:33.686: W/System.err(7404):     at org.jivesoftware.smack.XMPPConnection.proceedTLSReceived(XMPPConnection.java:824)
07-23 07:09:33.686: W/System.err(7404):     at org.jivesoftware.smack.PacketReader.parsePackets(PacketReader.java:267)
07-23 07:09:33.686: W/System.err(7404):     at org.jivesoftware.smack.PacketReader.access$000(PacketReader.java:43)
07-23 07:09:33.686: W/System.err(7404):     at org.jivesoftware.smack.PacketReader$1.run(PacketReader.java:70)
07-23 07:09:33.686: W/System.err(7404): Caused by: java.security.NoSuchAlgorithmException: KeyStore jks implementation not found
07-23 07:09:33.696: W/System.err(7404):     at org.apache.harmony.security.fortress.Engine.notFound(Engine.java:177)
07-23 07:09:33.696: W/System.err(7404):     at org.apache.harmony.security.fortress.Engine.getInstance(Engine.java:151)
07-23 07:09:33.696: W/System.err(7404):     at java.security.KeyStore.getInstance(KeyStore.java:116)
07-23 07:09:33.696: W/System.err(7404):     ... 5 more
07-23 07:09:34.616: W/System.err(7404): SASL authentication failed using mechanism X-FACEBOOK-PLATFORM: 
07-23 07:09:34.616: W/System.err(7404):     at org.jivesoftware.smack.SASLAuthentication.authenticate(SASLAuthentication.java:259)
07-23 07:09:34.626: W/System.err(7404):     at org.jivesoftware.smack.XMPPConnection.login(XMPPConnection.java:207)
07-23 07:09:34.626: W/System.err(7404):     at com.gta5news.qwuik.Main$1.run(Main.java:266)
07-23 07:09:34.626: W/System.err(7404):     at java.lang.Thread.run(Thread.java:856)
07-23 07:09:34.626: W/System.err(7404): SASL authentication failed using mechanism X-FACEBOOK-PLATFORM: 
07-23 07:09:34.626: W/System.err(7404):     at org.jivesoftware.smack.SASLAuthentication.authenticate(SASLAuthentication.java:259)
07-23 07:09:34.626: W/System.err(7404):     at org.jivesoftware.smack.XMPPConnection.login(XMPPConnection.java:207)
07-23 07:09:34.626: W/System.err(7404):     at com.gta5news.qwuik.Main$1.run(Main.java:266)
07-23 07:09:34.626: W/System.err(7404):     at java.lang.Thread.run(Thread.java:856) 
```

第 266 行是我登录的地方，所以它会抛出一些错误，因为值不准确。

# apache - htaccess 重写行为（文档根目录？）

> ID：11835820
> 
> 赞同：0
> 
> 时间：2012-08-06T20:57:59.763
> 
> 标签：apache, .htaccess

我有一个 htaccess/apache 重写问题，但它有点棘手：

我有一个像 www.example.org 这样的域，所有内容文件都在

```
/var/www/www.example.org/content 
```

每个文件都必须通过 index.php 访问，该 index.php 保存在

```
/var/www/www.example.org/start1 
```

所以有一个 .htaccess 将所有内容重写为 index.php （没问题）。

在 apache 上是一个主机定义：

```
ServerName  www.example.org
DocumentRoot /var/www/www.example.org/start1 
```

一切都很好，但现在我有第二个要求：

内容中有特殊文件，应通过另一个 index.php 访问（无法使用与以前相同的 index.php），

所以我把第二个 index.php 放进去

```
/var/www/www.example.org/start2 
```

并让 .htaccess 将所有内容重写为新的 index.php。

在apache中我定义了一个别名

```
Alias /special /var/www/www.example.org/start2 
```

当我现在访问 www.example.org/special/file 时，来自 /var/www/www.example.org/start2 的 .htaccess 是重写日志中的第一个。但是它将它重写为 start1 文件夹中的 index.php，而不是像我预期的那样，重写为 start2 文件夹中的 index.php。

我认为这是因为文档根目录，但我不知道我能做什么。VHost 是没有选择的，因为只有一个域

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:44:50.993

在 start2 文件夹中，您可能需要执行以下操作：

```
RewriteRule ^(.*) /special/index.php [L] 
```

因为您已别名`/special`为 `/var/www/www.example.org/start2`.

# python - 比较两个numpy数组并插入nans

> ID：11835822
> 
> 赞同：3
> 
> 时间：2012-08-06T20:58:09.953
> 
> 标签：python, numpy

我有两个尺寸为 (120, 360) 的 numpy 数组，其中一个数组由整数和零组成，第二个数组由浮点数组成。我想在第一个数组中有整数的地方用 nans 替换第二个数组的值。有没有一种简单有效的方法来做到这一点？

另外我想用 nans 替换第一个数组中的整数并将零更改为一。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T21:01:47.597

您可以通过对数组的逻辑索引轻松实现这一点，

```
arr2[ arr1 != 0 ] = numpy.NaN 
```

但是整数数组不支持 NaN，因此您必须将第一个数组转换为浮点数组，即

```
arr1 = arr1.astype(float)
arr1[arr1 != 0.0] = numpy.NaN
arr1[arr1 == 0.0] = 1.0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T21:05:39.190

设置数组：

```
>>> import numpy as np
>>> x = np.array([[1,0],[0,4]], dtype=int)
>>> y = np.array([[1.1, 2.2],[3.3, 4.4]], dtype=float) 
```

您可以轻松地将第二个数组设置为所需的 nan ，如下所示：

```
>>> y[x != 0] = np.nan
>>> y
array([[ nan,  2.2],
       [ 3.3,  nan]]) 
```

然后将第一个数组转换为浮点数（因为 NaN 不是整数）并设置所需的值：

```
>>> x = x.astype(float)
>>> x[x != 0] = np.nan
>>> x[x == 0] = 1
>>> x
array([[ nan,   1.],
       [  1.,  nan]]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T13:25:17.340

作为对先前答案的评论，我认为将浮点数与比较不是`==`一个好主意，而且我认为有些操作是浪费的。如何创建一个临时数组`mask = (X != 0)`并将其用作索引？

```
>>> X = X.astype(float)
>>> X[~mask] = np.nan
>>> X[mask] = 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T13:44:40.910

我不知道您用 NaN 替换值的目的，但您可能需要考虑使用 numpy 的掩码数组（类似于 Pierre 的回答，但 numpy 具有内置掩码支持！）：

```
import numpy.ma
# mask out values when there is a non-zero integer in arr1
arr2 = numpy.ma.masked_array(arr2, mask=arr1)
# mask out values in arr2 for non-zero integers, and set all remaining values (the zeros) to 1
arr1 = numpy.ma(arr1, mask=(arr1 != 0))
arr1[~arr1.mask] = 1 
```

不需要整数到浮点数的转换，这使您可以使用很多 numpy 的功能而不会遇到问题。例如，用 NaN 计算数组的平均值肯定是个坏主意，但使用掩码数组，这没问题。

# ios - 使用 AlertView 并立即在 Cell 中保存核心数据

> ID：11835823
> 
> 赞同：0
> 
> 时间：2012-08-06T20:58:19.210
> 
> 标签：ios, core-data

当我推送一个单元格时，会弹出一个带有提示的 AlertView。我的问题：我想将提示中输入的文本显示到选定的单元格中。（同时将文本保存到 Core Data）。谁能把我推向正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:02:00.003

如果您希望它在警报显示的同时发生，您需要在后台线程中进行保存。

最简单的方法是使用嵌套上下文，并且只是从主上下文中保存。

无论您在何处创建托管对象上下文，请将 alloc/init 部分替换为...

```
NSManagedObjectContext *parentMoc = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
parentMoc.persistentStoreCoordinator = persistentStoreCoordinator;
self.managedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType];
self.managedObjectContext.parentContext = parenetMoc; 
```

现在，您拥有与之前相同的 MOC，除了它是一个主队列 MOC，其父上下文在后台队列中运行。

不过，您将不得不使用一种方法来保存这两个上下文。父级上的第二次保存发生在后台线程中，因此您不必等待。

```
- (void)saveData {
    NSError *error = nil;
    NSManagedObjectContext *moc = self.managedObjectContext;
    if ([moc save:&error]) {
        moc = moc.parentContext;
        [moc performBlock:^{
            NSError *error = nil;
            if (![moc save:&error]) {
                // Handle the actual save error
            }
        }];
    } else {
        // Handle the error of saving up into the parent context...
    }
} 
```

现在，不再直接调用 [managedObjectContext save:&error]，而是将其替换为 saveData 的消息，该方法将几乎立即返回，并且实际的保存将在后台线程中进行。

您的应用程序中的任何其他代码（除了保存调用）都不需要更改。

在您的情况下，就在您抛出警报之前，调用保存，并且在显示警报时会发生保存。

# windows - 在 Weblogic 中使用本地版本的 ANT 和 JUNIT 运行 ant build

> ID：11835828
> 
> 赞同：2
> 
> 时间：2012-08-06T20:58:35.553
> 
> 标签：windows, unix, ant, junit, classpath

我有一个我正在尝试使用的 Ant build.xml 脚本。在其中，我添加了一个 taskdef 来运行一些 junit 测试。但是，我遇到了可怕的类路径问题。

因为这是一个weblogic应用程序，所以Weblogic将ANT_HOME设置为Weblogic ANT版本，即1.6.5 另外，我们正在尝试使用JUnit 4，但是Weblogic附带的JUnit是基于JUnit 3的（我相信）。

我认为告诉 Ant 使用我在项目中签入的 Ant 和 JUnit jar 而不是使用 Weblogic 版本运行是一件简单的事情，但是我无法完成这项工作。

这是我现在拥有的：

```
<path id="junit.classpath">
    <fileset dir="${applib.dir}">
        <include name="junit-4.10.jar"/>
    </fileset>
</path>

<taskdef name="myjunit"
  classname="org.apache.tools.ant.taskdefs.optional.junit.JUnitTask"
  classpathref="junit.classpath">

    <classpath>
        <!-- These are here so that the junit task runs with these jars, which works -->
        <pathelement location="${applib.dir}/junit-4.10.jar"/>
        <pathelement location="${applib.dir}/ant-1.8.2/ant-junit4.jar"/>
    </classpath>
</taskdef> 
```

但是，无论我做什么，Ant 的类路径都不包含 JUnit/framework/Test：

```
BUILD FAILED
    C:\build.xml:219: taskdef A class needed by class org.apache.tools.ant.taskdefs.optional.junit.JUnitTask cannot be found: j
unit/framework/Test 
```

我*认为*问题在于 ANT_HOME 是由 Weblogic 设置的，因此当 Ant 启动时 ant-junit.jar 被添加到类路径中。ant -diagnostics 证实了这一点。

我能够解决这个问题的唯一方法是将 junit-4.10.jar 直接放在类路径中，或者将它放在 BEA ANT_HOME 库目录中。但是，这在生产环境中不起作用。

那么 - 我如何将 junit-4.10.jar 添加到 Ant 类路径中，以便 taskdef 不会导致 Ant 崩溃？

*   该任务仅用于在代码构建期间运行 JUnit 测试，部署时不需要它。
*   在将使用此脚本的任何和所有机器上安装 ANT 和 JUNIT 并不是一个真正的选择。
*   多个平台（unix 和 windows）需要能够运行相同的构建脚本，Windows 用于构建代码，Linux 用于部署到 Weblogic。
*   我真的不想在生产包中提供 JUnit 和 ANT jar，只是为了在部署阶段关闭 Ant，因为它甚至不会运行相关任务。
*   我可以有一个单独的 build.xml 文件来编译/运行 junit 测试，但这会导致重复代码并且看起来像一个杂物。

有人对如何解决这个问题有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T03:53:06.050

一个包装脚本怎么样，例如 DOS 批处理文件来强制一个 PATH，比如：

```
set ANT_HOME=C:\ant\ant-1.8.2
set PATH=%PATH%;%ANT_HOME%\bin
ant -f C:\mybuild.xml... 
```

我知道您需要为 Unix 和 Windows 运行一个脚本。但是这个想法在这里有意义吗？

# ruby-on-rails - 将 json api 输出保存在数据库中

> ID：11835829
> 
> 赞同：0
> 
> 时间：2012-08-06T20:58:36.237
> 
> 标签：ruby-on-rails, ruby, json, api

我正在使用`Net::HTTP`从 JSON API 中获取数据，并希望将 API 给出的响应保存在我的数据库中。

一个示例响应是：

```
{
    "id": 1234,
    "applicationname": "test12347127834",
    "publish_key": "79123798d7981728397dddasetr7912",
    "streamname": "xxnamexx",
    "ingest": "rtmp://master.cdn.com/SSDEL1"
} 
```

我想保存`id`,`applicationname`和.`publishkey``streamname`

我完全不知道那是如何工作的。如果有人能给我提示、提示或示例，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:27:13.457

我看到有两种方法。一种是将 JSON 保存为文本。如果您不会对此属性进行大量后处理，那可能会完成这项工作。

第二种方法是在列上使用 :serialize ，Rails 3 将神奇地为您处理来回插值。你将能够做到

```
some_object.response.id 
```

要做到这一点很简单：

```
class YourClass
  serialize :response 
```

# ruby-on-rails - 错误：在任何存储库中都找不到有效的 gem 'rails' (>= 0)

> ID：11835830
> 
> 赞同：1
> 
> 时间：2012-08-06T20:58:40.910
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ubuntu

尝试安装 rails 3.2.7。仍然坚持 rvm 等问题。

```
gem install rails 
```

让我关注以下内容：-

> 错误：在任何存储库中都找不到有效的 gem 'rails' (>= 0)

如何启动 rails 3.2.7 并在我的系统中工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-06T23:28:24.043

`gem sources`至少应该包含`https://rubygems.org`. 如果不

```
gem sources -a https://rubygems.org 
```

应该有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T23:38:14.713

采用`rvm gem install rails`

我只是这样做了，它对我有用。

如果您没有 rvm，则：

1.  如果您没有红宝石：

安装 RVM 和 ruby​​：

$ curl -L [https://get.rvm.io](https://get.rvm.io) | bash -s 稳定 --ruby

或者

另外带有导轨： $ curl -L [https://get.rvm.io](https://get.rvm.io) | bash -s 稳定 --rails

# objective-c - 如何检查 CGWindowID 仍然有效

> ID：11835831
> 
> 赞同：1
> 
> 时间：2012-08-06T20:58:45.277
> 
> 标签：objective-c, macos, cocoa

如果我得到一个 CGWindowID (_windowID) 如下......

```
NSArray *windowList = (__bridge NSArray *)CGWindowListCopyWindowInfo(kCGWindowListOptionOnScreenOnly, kCGNullWindowID);
for (NSDictionary *info in windowList) { 
    if ([[info objectForKey:(NSString *)kCGWindowOwnerName] isEqualToString:@"window name"] && ![[info objectForKey:(NSString *)kCGWindowName] isEqualToString:@""]) {
        _windowID = [[info objectForKey:(NSString *)kCGWindowNumber] unsignedIntValue];
    }
} 
```

如何正确测试窗口 id 是否仍然有效且窗口尚未关闭？我是否只是运行类似的代码来检查窗口 ID 是否存在？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:04:53.947

`kCGWindowListOptionOnScreenOnly`常量的文档说：

> **列出当前在屏幕上的所有窗口**。窗户按从前到后的顺序返回。使用此选项检索列表时，relativeToWindow 参数应设置为 kCGNullWindowID。

`CGWindowListCopyWindowInfo`所以窗口肯定会出现在屏幕上，因为在调用和您对它的操作 之间似乎没有发生任何事情。

也许您想测试以确保它们没有被隐藏或最小化？

# python - 当 cp 没有时，为什么 shutil.copy() 会引发权限异常？

> ID：11835833
> 
> 赞同：33
> 
> 时间：2012-08-06T20:58:53.960
> 
> 标签：python, permissions, copy

shutil.copy() 引发权限错误：

```
Traceback (most recent call last):
  File "copy-test.py", line 3, in <module>
    shutil.copy('src/images/ajax-loader-000000-e3e3e3.gif', 'bin/styles/blacktie/images')
  File "/usr/lib/python2.7/shutil.py", line 118, in copy
    copymode(src, dst)
  File "/usr/lib/python2.7/shutil.py", line 91, in copymode
    os.chmod(dst, mode)
OSError: [Errno 1] Operation not permitted: 'bin/styles/blacktie/images/ajax-loader-000000-e3e3e3.gif' 
```

复制-test.py：

```
import shutil

shutil.copy('src/images/ajax-loader-000000-e3e3e3.gif', 'bin/styles/blacktie/images') 
```

我正在从命令行运行 copy-test.py：

```
python copy-test.py 
```

但是`cp`从同一文件的命令行运行到同一目标不会导致错误。为什么？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-08-06T21:08:01.043

失败的操作是`chmod`，而不是副本本身：

```
 File "/usr/lib/python2.7/shutil.py", line 91, in copymode
    os.chmod(dst, mode)
OSError: [Errno 1] Operation not permitted: 'bin/styles/blacktie/images/ajax-loader-000000-e3e3e3.gif' 
```

这表明该文件已经存在并且由另一个用户拥有。

[`shutil.copy`](http://docs.python.org/library/shutil.html#shutil.copy)被指定为复制权限位。如果您只想复制文件内容，请使用`shutil.copyfile(src, dst)`，或者`shutil.copyfile(src, os.path.join(dst, os.path.basename(src)))`如果`dst`是目录。

适用于`dst`文件或目录且不复制权限位的函数：

```
def copy(src, dst):
    if os.path.isdir(dst):
        dst = os.path.join(dst, os.path.basename(src))
    shutil.copyfile(src, dst) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-06-13T13:01:37.833

这种形式对我有用：

```
shutil.copy('/src_path/filename','/dest_path/filename') 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-06T21:04:17.583

这是一种猜测，但我首先想到的是：

```
'bin/styles/blacktie/images' 
```

您没有尾部斜杠。虽然我不确定 的实现`shutil.copy()`，但我可以告诉您，`cp`根据您运行它的操作系统，它的行为会有所不同。最有可能的是，在您的系统上，`cp`它很聪明并注意到这`images`是一个目录，并将文件复制到其中。

但是，如果没有尾部斜杠，`shutil.copy()`可能会将其解释为文件，*而不是*检查，并在无法创建名为`images`.

简而言之，试试这个：

```
'bin/styles/blacktie/images/' 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2018-02-09T08:10:00.560

参数必须是：

```
shutil.copy('src/images/ajax-loader-000000-e3e3e3.gif', 'bin/styles/blacktie/images.ajax-loader-000000-e3e3e3.gif') 
```

# javascript - 悬停时图像更改/放大而不影响页面间距

> ID：11835836
> 
> 赞同：0
> 
> 时间：2012-08-06T20:59:22.017
> 
> 标签：javascript, css, hover, onmouseover, onmouseout

我目前正在使用 onmouseover 和 onmouseout 在悬停时交换图像。这很好用，但现在我们想添加[这个滚动](http://www.jscraft.net/demo/plugins/scroller/demo2.html)条的效果- 基本上，添加如果图像 A 是 20x20 并且悬停时显示的图像是 80x80 的功能 - 我怎样才能让悬停图像在“顶部”打开”的其他人，所以图像大小的增加不会影响容器或表？

有几个要求： 该解决方案需要在**IE7**中运行，并且必须能够在悬停时显示不同的、更大的图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:12:42.133

您可以使用 CSS3 对其进行缩放。

这是一个变换的例子： scale - [jsFiddle](http://jsfiddle.net/Jmeks/2/)

这是我在示例中使用的代码：

```
<div class="box"></div>

.box {
    width: 50px;
    height: 50px;
    background-color: green;
    -webkit-transition: 0.1s ease-out;
    -moz-transition: 0.1s ease-out;
    -o-transition: 0.1s ease-out;
    -ms-transition: 0.1s ease-out;
}

.box:hover {
    -webkit-transform: scale(1.4);
    -moz-transform: scale(1.4);
    -o-transform: scale(1.4);
    -ms-transform: scale(1.4);
} 
```

# java - 如何使用作业参数替换从文件中加载 bean 值？

> ID：11835837
> 
> 赞同：0
> 
> 时间：2012-08-06T20:59:27.877
> 
> 标签：java, spring, spring-batch

在我的春季批处理项目中，我可以执行以下操作：

```
<bean id="exampleTasklet" class="my.custom.Tasklet">
    <property name="message" value="job parameter value: #{jobParameters['arg1']}"/>
</bean> 
```

并且 message 属性将具有从 spring 批处理作业参数中获取的值。但是，我实际要分配的值非常大，我不想将它放在 xml 文件中。我知道这种语法不起作用，但我想做类似的事情：

```
<bean id="exampleTasklet" class="my.custom.Tasklet">
    <property name="message" read-value-from-file="/path/to/file.txt"/>
</bean> 
```

并且该文件将包含行“作业参数值：#{jobParameters['arg1']}”，spring 将解析该行，就好像文件内容在 value="" 属性中一样。

有没有很好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:34:57.613

我认为您正在寻找的是[PropertyPlaceholderConfigurer](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/beans/factory/config/PropertyPlaceholderConfigurer.html)。

```
<bean  class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">  
    <property name="location" value="/path/to/file.properties" /> 
    <property name="placeholderPrefix" value="#{" /> 
    <property name="placeholderSuffix" value="}" /> 
</bean> 
```

这由 Spring 作为 bean 处理器运行，并将尝试解析占位符标记。有一个默认实例将使用此表示法解析系统属性：`${propertyname}`. 对于您的符号，您需要指定`placeholderPrefix`/ `Suffix`。当有多个 bean 处理器时，顺序由`order`属性决定。默认情况下，如果处理器无法解析占位符，则执行失败，但这可以通过设置来改变`ignoreUnresolvablePlaceholders`。由于该机制是属性驱动的，您可能需要考虑如下符号：

```
<property name="message" value="job parameter value: #{jobParameters.arg1}"/> 
```

或者，如果您要传达的`arg1`内容也是一个参数，您可以尝试：

```
<property name="message" value="job parameter value: #{jobParameters.${arg1}}"/> 
```

Spring 在 bean 处理器上循环，直到没有执行替换，或者引发异常。所以定义一个属性`${something.${orOther}}`是有效的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T09:23:12.657

*如果有人从属性文件来这里做这样[的事情：](http://static.springsource.org/spring-batch/reference/html/configureStep.html#late-binding)*

如果您希望 .properties 文件中的属性出现在 .properties 中`JobParameters`，您将找不到现成的解决方案。您可以执行以下操作：

1.  在属性文件周围包裹一个 bean。
2.  将此 bean 传递给另一个可以访问的 bean，`JobParameters`并且可以将文件中的属性泵入该类。
3.  然后您应该能够使用 Spring 的表达式语言访问您的属性并执行以下操作： `<bean id="myBean" class="my.custom.Bean"> <property name="prop" value="#{jobParameters['arg1']}"/> </bean>`

**或者，**我认为 Devon_C_Miller 提出的解决方案要容易得多。你`JobParameters`当时没有这些属性。但是，如果 XML 配置中的替换是您唯一想要的，您只需将占位符更改为：

> ${myPropFromFile}

*快乐批处理，每个人;-)*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T05:52:34.747

我建议您使用字符串作为文件名并在您的 bean 中打开该文件。
*我不确定我是否解决了您的问题。我只是建议像 Spring MessageBundle*

这样的东西：

```
<bean id="exampleTasklet" class="my.custom.Tasklet">
    <property name="messagePath" location="/path/to/file.txt"/>
</bean> 
```

在你`exampleTasklet`阅读文件并做你的事情时（我不确定它是什么）

# asp.net - 显示格式化的 XML

> ID：11835839
> 
> 赞同：0
> 
> 时间：2012-08-06T20:59:37.010
> 
> 标签：asp.net, xml, vb.net

我正在从 Web 服务（实际上是 UPS）中检索 XML 文档，我可以从 XML 中提取我需要的信息，但是我无法让 XML 以 XML 格式显示。我可以让它显示在标签和文字中，但它们都是一起运行的。节点不显示。节点显示在文本框控件中，但它仍然一起运行（没有 brks）

知道如何获取我从服务中获取的 XML 文档并像在 IE 中打开 XML 文档一样显示它吗？

谢谢

顺便说一句...我整天都在搜索这个，我唯一能找到的是如果我正在显示一个静态文件，而我不是。我也尝试过 stringbuilder/stringwriter，但没有运气。我对这些东西还是很陌生，所以我可能会遗漏一些东西。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T03:26:20.317

尝试将 XML 包含在

```
<pre>... your xml</pre> 
```

标签。

# ruby-on-rails - Rails 3 教程上的语法错误意外 tANDOP

> ID：11835848
> 
> 赞同：0
> 
> 时间：2012-08-06T20:59:54.077
> 
> 标签：ruby-on-rails, ruby-on-rails-3, syntax-error

我认为我忽略了一些愚蠢的事情，但我正在关注 Rails 3 教程，如果用户对未发表的文章发表评论，我将在其中添加错误......所以在 Rails 控制台中我尝试通过输入以下代码对“未发表”文章（草稿）创建评论

```
>> article = Article.draft.first
=> #<Article id: 7, title: "One-to-many associations",        ...> 
>> comment = article.comments.create :name => 'Dude', :email => 'dude@example.com', :body    => 'Great article!' 
```

此时它说我应该得到以下信息：

```
=> #<Comment id: nil, article_id: 7, name: "Dude", email: "dude@example.com", body: "Great article!", created_at: nil, updated_at: nil> >> comment.errors.full_messages => ["Article is not published yet"] 
```

但相反，我收到以下错误：

语法错误：/Users/bbarton250/Sites/rails_projects/theoldman/app/models/comment.rb:11：语法错误，意外 tANDOP，期待 kEND && !article.published？^ 来自 /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:469:in load_file `load' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:469:in`' 来自 /opt/local/lib/ruby/gems/1.8/ gems/activesupport-3.2.3/lib/active_support/dependencies.rb:639:in `new_constants_in' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:468:in`load_file' 来自 /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb :353:in `require_or_load' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:502:in`load_missing_constant' 来自 /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:192:in `const_missing' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:190:in`each' 来自 /opt/local/lib/ruby /gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:190:in`const_missing' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:514:in`load_missing_constant' 来自 /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:192:in `const_missing' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:190:in`each' 来自 /opt/local/lib/ruby/gems/1.8 /gems/activesupport-3.2.3/lib/active_support/dependencies.rb:190:in `const_missing' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/inflector/methods.rb:218:in`constantize' 来自 /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/inflector/ methods.rb:217:in `each' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/inflector/methods.rb:217:in`constantize' 来自 /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:554:in `get' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:588:in`constantize' 来自 /opt/local/ lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/inheritance.rb:111:in `compute_type' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/inheritance.rb:109:in`each' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3 /lib/active_record/inheritance.rb:109:in`compute_type' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/reflection.rb:172:in``klass' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/associations/collection_association.rb:148:in`从 /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/reflection.rb:172:in transaction' 从 /opt/local/lib/ruby/gems/1.8发送' /gems/activerecord-3.2.3/lib/active_record/associations/collection_association.rb:431:in `create_record' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/associations/collection_association.rb:119:in`create' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/关联/collection_proxy.rb:46:in `__send__' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/associations/collection_proxy.rb:46:in`create'

这是我的评论模型：

```
class Comment < ActiveRecord::Base
  attr_accessible :body, :email, :name, :article_id

  belongs_to :article

  validates :name, :email, :body, :presence => true
  validates :article_should_be_published

  def article_should_be_published
    errors.add(:article_id, "is not published yet") if article 
&& !article.published?
  end
end 
```

这是我的文章模型：

```
class Article < ActiveRecord::Base
  attr_accessible :body, :published_at, :title

  validates :title, :presence => true
  validates :body, :presence => true

  belongs_to :user
  has_and_belongs_to_many :categories
  has_many :comments

  scope :published, where("articles.published_at IS NOT NULL")
  scope :draft, where("articles.published_at IS NULL")
  # recent post from < a month ago - see pg 103 of tutorial
  # scope :recent, lambda { published.where("articles.published_at > ?", 1.month.ago.to_date)}
  scope :where_title, lambda { |term| where("articles.title LIKE ?", "%#{term}%") }

  def long_title
    "#{title} - #{published_at}"
  end

  def published?
    published_at.present?
  end
end 
```

如果我需要提供其他任何东西，请告诉我......我感谢任何和所有帮助......非常感谢

更新：

遵循 iltempos 提示后...我现在收到以下验证错误...

ArgumentError：您需要提供至少一个来自 /opt/local/lib/ruby/gems/1.8/gems/activemodel-3.2.3/lib/active_model/validations/validates.rb:86:in `validates' from /Users/bbarton250/Sites/rails_projects/theoldman/app/models/comment.rb:7 from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:469:in`load' 的验证来自 /opt /local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:469:in `load_file' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:639:in`new_constants_in' 来自 /opt/local/lib/ruby/gems/1.8/gems/activesupport- 3.2.3/lib/active_support/dependencies.rb:468:in `load_file' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:353:in`require_or_load' 来自 /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:502:in `load_missing_constant' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:192:in`const_missing' 来自 /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:190:in `each' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:190:in`const_missing' 来自 /opt/local/lib/ruby/gems/1.8 /gems/activesupport-3.2.3/lib/active_support/dependencies.rb:514:in`load_missing_constant' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:192:in`const_missing' 来自 /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:190:in `each' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:190:in`const_missing' 来自 /opt/local/lib/ruby/gems/1.8 /gems/activesupport-3.2.3/lib/active_support/inflector/methods.rb:218:in `constantize' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/inflector/methods.rb:217:in`each' 来自 /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/ inflector/methods.rb:217:in `constantize' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:554:in`get' from /opt/local/lib/ruby/gems/1.8/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:588:in `constantize' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/inheritance.rb:111:in`compute_type' 来自/opt/ local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/inheritance.rb:109:in `each' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/inheritance.rb:109:in`compute_type' 来自/opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2 .3/lib/active_record/reflection.rb:172:in`send' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/reflection.rb:172:in`klass' 来自 /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/associations/collection_association.rb:148:in `transaction' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/associations/collection_association.rb:431:in`create_record' 来自 /opt/local/lib/ruby/gems /1.8/gems/activerecord-3.2.3/lib/active_record/associations/collection_association.rb:119:in `create' from /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/active_record/associations/collection_proxy.rb:46:in`**send** '来自 /opt/local/lib/ruby/gems/1.8/gems/activerecord-3.2.3/lib/ active_record/associations/collection_proxy.rb:46:in `create'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:02:34.530

看起来应该有一个换行符：

```
 def article_should_be_published
    errors.add(:article_id, "is not published yet") if article && !article.published?
  end 
```

# php - PHP缓存脚本 - 保存缓存数据不减少网站页面负载

> ID：11835849
> 
> 赞同：0
> 
> 时间：2012-08-06T20:59:55.273
> 
> 标签：php, xml, caching

我正在开发一个基于 LAMP 的网站，该网站从 XML 提要中提取数据（汽车经销商库存）并将其显示在网站上。索引页面上有一个旋转器，显示 4 辆随机汽车，但是页面加载有很长的延迟 - 大约 7-10 秒。这是因为该站点在显示结果之前会循环浏览数据以查找具有图像并满足其他标准的汽车。我的开发人员将这个脚本放在一起，将结果缓存 5 分钟：

```
/* 
 * Cache requests for 5 minutes
 * Wraps original method (now _sendRequest)
 */
private function sendRequest($xml) {
    error_log($xml);
    $cache_filename = dirname(__FILE__) . '/cache/' . md5($xml);
    if (file_exists($cache_filename) && (time() - filemtime($cache_filename)) < 300 && filesize($cache_filename) > 100) {
        return file_get_contents($cache_filename);
    } elseif (file_exists($cache_filename)) {
        unlink($cache_filename);
    }
    $response = $this->_sendRequest($xml);
    if (!is_dir(dirname($cache_filename))) {
       @mkdir(dirname($cache_filename),0775,true);
    }
    @file_put_contents($cache_filename, $response);
    return $response;
}

private function _sendRequest($xml) {
    $options = array(
        CURLOPT_RETURNTRANSFER  => true,
        CURLOPT_CONNECTTIMEOUT  => 120,
        CURLOPT_TIMEOUT         => 120,
        CURLOPT_POST            => true,
        CURLOPT_USERAGENT       => Config::$appName,
        CURLOPT_USERPWD         => Config::$aweAPIKey,
        CURLOPT_URL             => Config::$aweAPIURL,
        CURLOPT_POSTFIELDS      => $xml
    );
    $ch = curl_init();
    curl_setopt_array($ch, $options);
    $content = curl_exec($ch);
    //echo "ERROR: " . curl_error($ch);
    curl_close($ch);

    return $content;
} 
```

该脚本的目录在 /lib/client.php 中，它在 /lib/cache 中保存了大量包含车辆数据的文本文件，但是站点页面负载并没有减少。我应该对脚本或它如何保存缓存数据进行一些更改吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:06:28.970

就性能而言，每次请求都击中硬盘是昂贵的，因此从逻辑上讲，您的缓存系统并没有真正的帮助。相反，请查看[APC](http://php.net/manual/en/book.apc.php)、[memcached](http://memcached.org/)或[Redis](http://redis.io/)，因为它们允许您将数据直接存储在内存中，这样读写速度要快得多。

# css - 隐藏部分视频，来自 youtube

> ID：11835853
> 
> 赞同：0
> 
> 时间：2012-08-06T21:00:44.773
> 
> 标签：css, safari, youtube

我有来自 youtube 的视频，我想从这个视频中隐藏一些地方，这是我的代码

```
 <div style="width: 200px; height: 315px; overflow: hidden">
        <iframe width="560" height="315"    src="http://www.youtube.com/embed/AMoLwrarElA" frameborder="0" allowfullscreen></iframe>
</div> 
```

这在所有浏览器中都很好，除了 safari，在 safari 中所有视频都是可见的，有人知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T13:14:40.103

![图像显示覆盖 iframe 的绝对定位 div](../Images/b9c2b56a788316caa4692941a398185e.png)

如图所示，执行此操作的方法是：

```
body
  div (position = absolute, top = iframe.top, right = iframe.right, width = 350px)
  iframe (position = absolute or relative, width = 750px) 
```

**这里绝对定位的 div 是红色条纹区域**

您可以使用 jquery 获取左上右下的 iframe：

```
<body>
 <div class="cover"></div>
 <iframe/>
 <script>
   $(function(){
     var top = iframe.top
     var right = iframe.right
     $("cover")[0].top = top;
     $("cover")[0].right = right;
     //..
   });
 </script>
</body> 
```

对不起，我时间少，无法解释更多，如果这不起作用我会再试一次

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:31:15.237

尝试在隐藏末尾添加分号：

```
overflow:hidden; 
```

也尝试添加：

```
clear:both; 
```

到你的 div 风格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T22:00:57.647

这段代码决定了这个问题

```
<div style="width: 200px; height: 315px; overflow: hidden;">
<object width="560" height="315" style="float:left; overflow: hidden;">
    <param name="movie"    value="http://www.youtube.com/v/AMoLwrarElA&hl=ru_RU&fs=1&rel=0&border=0"/>
    <param name="allowFullScreen" value="true"/>
    <param name="allowscriptaccess" value="always"/>
    <param name="wmode" value="opaque"/>
    <embed src="http://www.youtube.com/v/AMoLwrarElA&hl=ru_RU&fs=1&rel=0&border=0" wmode="opaque" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="560" height="315"/>
</object>
</div> 
```

# jar - 如何在要部署到 JBoss 的 JAR 文件中设置 Quartz 调度程序？

> ID：11835855
> 
> 赞同：1
> 
> 时间：2012-08-06T21:00:50.973
> 
> 标签：jar, jboss, quartz-scheduler

我正在使用 Quartz 2.1.1 并且有一个 JAR 应用程序（注意，不是网络，所以我没有 Spring）。我在 JBoss 4.2.2 上运行我的应用程序（无法更改）。我想安排我的作业每 5 分钟运行一次，但不希望通过静态块创建调度程序。无论如何，它似乎不起作用。在我的工作课上，我有...

```
static {
    LOG.info("Started static process orders job at " + (new java.util.Date()).toString());

    final JobDetail job = JobBuilder.newJob(ProcessOrdersJob.class).withIdentity("processOrdersJob", "group1").build();

    final Trigger trigger = TriggerBuilder
            .newTrigger()
            .withIdentity("processOrdesrTrigger", "group1")
            .withSchedule(
                    CronScheduleBuilder
                            .cronSchedule("0 5,10,15,20,25,30,35,40,45,50,55 * * * ?"))
            .build();

    Scheduler scheduler;
    try {
        scheduler = new StdSchedulerFactory().getScheduler();
        scheduler.start();
        scheduler.scheduleJob(job, trigger);
    } catch (SchedulerException e) {
        LOG.error(e.getMessage(), e);
        e.printStackTrace(System.err);
    }
} // static 
```

但它似乎没有运行（日志从不包含信息消息）。有谁知道在我的 JAR 中配置我的 Quartz 作业以部署到 JBoss 的更灵活的方法？

谢谢， -

**编辑**：我尝试了 Rosdi 的建议，将我的 Maven 构建使用的 Quartz 恢复为 1.5.2（与 JBoss 安装的版本相同），但是，唉，得到了例外

```
javax.ejb.EJBTransactionRolledbackException: java.lang.NoSuchMethodError: org.jboss.logging.Logger.getMessageLogger(Ljava/lang/Class;Ljava/lang/String;)Ljava/lang/Object;
    at org.jboss.ejb3.tx.Ejb3TxPolicy.handleInCallerTx(Ejb3TxPolicy.java:87)
    at org.jboss.aspects.tx.TxPolicy.invokeInCallerTx(TxPolicy.java:130)
    at org.jboss.aspects.tx.TxInterceptor$Required.invoke(TxInterceptor.java:195)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.ejb3.stateless.StatelessInstanceInterceptor.invoke(StatelessInstanceInterceptor.java:62)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.ejb3.mdb.MessagingContainer.localInvoke(MessagingContainer.java:249)
    at org.jboss.ejb3.mdb.inflow.MessageInflowLocalProxy.delivery(MessageInflowLocalProxy.java:268)
    at org.jboss.ejb3.mdb.inflow.MessageInflowLocalProxy.invoke(MessageInflowLocalProxy.java:138)
    at $Proxy113.execute(Unknown Source)
    at org.jboss.resource.adapter.quartz.inflow.QuartzJob.execute(QuartzJob.java:57)
    at org.quartz.core.JobRunShell.run(JobRunShell.java:203)
    at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:520)
Caused by: java.lang.RuntimeException: java.lang.NoSuchMethodError: org.jboss.logging.Logger.getMessageLogger(Ljava/lang/Class;Ljava/lang/String;)Ljava/lang/Object;
    at org.jboss.ejb3.interceptor.InvocationContextImpl.proceed(InvocationContextImpl.java:174)
    at org.jboss.ejb3.interceptor.EJB3InterceptorsInterceptor.invoke(EJB3InterceptorsInterceptor.java:63)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.ejb3.entity.TransactionScopedEntityManagerInterceptor.invoke(TransactionScopedEntityManagerInterceptor.java:54)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.ejb3.AllowedOperationsInterceptor.invoke(AllowedOperationsInterceptor.java:47)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:101)
    at org.jboss.aspects.tx.TxPolicy.invokeInCallerTx(TxPolicy.java:126)
    ... 11 more
Caused by: java.lang.NoSuchMethodError: org.jboss.logging.Logger.getMessageLogger(Ljava/lang/Class;Ljava/lang/String;)Ljava/lang/Object;
    at org.hibernate.cfg.beanvalidation.BeanValidationIntegrator.<clinit>(BeanValidationIntegrator.java:53)
    at org.hibernate.integrator.internal.IntegratorServiceImpl.<init>(IntegratorServiceImpl.java:46)
    at org.hibernate.service.internal.BootstrapServiceRegistryImpl.<init>(BootstrapServiceRegistryImpl.java:80)
    at org.hibernate.service.internal.BootstrapServiceRegistryImpl.<init>(BootstrapServiceRegistryImpl.java:57)
    at org.hibernate.service.ServiceRegistryBuilder.<init>(ServiceRegistryBuilder.java:76)
    at org.mainco.subco.dido.service.AbstractServiceProvider.getSessionFactory(AbstractServiceProvider.java:67)
    at org.mainco.subco.dido.service.AbstractServiceProvider.initServices(AbstractServiceProvider.java:118)
    at org.mainco.subco.dido.quartz.ProcessOrdersJob.execute(ProcessOrdersJob.java:92)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:112) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:30:24.433

这是我用于我的 JBoss 5 的，我不知道它是否可以在 JBoss 4 下工作。

```
package whatever;

import javax.ejb.ActivationConfigProperty;
import javax.ejb.MessageDriven;

import org.jboss.ejb3.annotation.Depends;
import org.jboss.ejb3.annotation.ResourceAdapter;
import org.quartz.JobExecutionContext;
import org.quartz.JobExecutionException;
import org.quartz.StatefulJob;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@MessageDriven(activationConfig = {@ActivationConfigProperty(propertyName = "cronTrigger", propertyValue = "0/30 * * * * ?")})
@ResourceAdapter("quartz-ra.rar")
@Depends({
"jboss.ejb:service=EJBTimerService""})
public class MyClass implements StatefulJob {

private static final Logger log = LoggerFactory.getLogger(MyClass.class);

public void execute(JobExecutionContext jobExecutionContext) throws JobExecutionException {
    log.debug("Job started at: " + new Date());
    this.process();
    log.debug("Job completed at: " + new Date());
}

private void process() {
    //do whatever you want to do
} 
```

}

# symfony - 如何将 symfony2 中的多个关系与教义联系起来？

> ID：11835857
> 
> 赞同：1
> 
> 时间：2012-08-06T21:00:59.133
> 
> 标签：symfony, doctrine

我正在尝试创建一个 symfony2 应用程序。该项目背后的主要思想是有一个活动，邀请了许多客人并对其进行了分类。我为所有实体创建了一个关系模型。

有4张桌子：

1.  客人 - 被邀请的人
2.  类别 - 他属于什么类别/类别？
3.  活动 - 他们被邀请参加的活动
4.  Guest_Event（出席）

我总结了以下模式：

```
xxxxBundle\Entity\Guest:
  type: entity
  table: guest
  id:
    id:
      type: integer
      generator: { strategy: AUTO }
  fields:
    name:
      type: string
      length: 100
      nullable: false
    surname:
      type: string
      length: 100
      nullable: false   
    email:
      type: string
      length: 255
      nullable: true
    address:
      type: string
      length: 255
      nullable: true
    phone:
      type: string
      length: 10
    description:
      type: text
    created_at:
      type: datetime
    updated_at:
      type: datetime
      nullable: true   
    token:
      type: string
      length: 255
      unique: true
    is_activated:
      type: boolean
      nullable: true
  manyToOne:
    category:
      targetEntity: Category
      inversedBy: guest
      joinColumn:
        name: category_id
        referencedColumnName: id
  lifecycleCallbacks:
    prePersist: [ setCreatedAtValue ]
    preUpdate: [ setUpdatedAtValue ] 
```

类别

```
xxxxBundle\Entity\Category:
  type: entity
  table: category
  id:
    id:
      type: integer
      generator: { strategy: AUTO }
  fields:
    name:
      type: string
      length: 255
      unique: true
  oneToMany:
    guests:
      targetEntity: Guest
      mappedBy: category
    attend:
      targetEntity: Attendance
      mappedBy: category 
```

事件

```
xxxxxBundle\Entity\Event:
  type: entity
  table: event
  id:
    id:
      type: integer
      generator: { strategy: AUTO }
  fields:
    name:
      type: string
      length: 100
      nullable: false
    location:
      type: string
      length: 255
      nullable: true
    scheduled_at:
      type: datetime
  manyToMany:
    category:
      targetEntity: guest
      inversedBy: event
      joinColumn:
        name: event_id
        referencedColumnName: id 
```

*   一位客人可能属于多个类别 (manyToOne)
*   一个类别会有很多客人（manyToOne）
*   一位客人可能会参加许多活动 (manyToOne)
*   一个活动可能有很多参加者（manyToMany？）
*   出勤表（guest_event）应该是一个连接表？

我对 ORM 和学说编码有点困惑。通过 SQL 代码或 phpmyadmin 创建表对我来说似乎要容易得多，但我想走艰难的路！该文档似乎令人困惑，因为每个教程都提出了不同的建议，并且 symfony2 书中的 ORM 学说部分没有完整的示例，而是一些代码。

如何更正我的表格以包含所有规格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:45:15.620

我强烈建议您按照 Symfony 2 官方文档的方式工作：http: [//symfony.com/doc/master/book/doctrine.html](http://symfony.com/doc/master/book/doctrine.html)

它带您逐步完成初始化数据库、制作实体、将其映射到数据库然后使用实体的过程。

您正在尝试通过阅读各种文档来理解多个概念。您的实体目录中似乎有 yaml 文件这一事实表明基本缺乏理解。

首先浏览本教程，然后添加您的真实实体。一旦你得到一些工作，这很简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:58:25.640

我的两分钱：

> 一位客人可能属于多个类别

这么多客人可以属于许多类别，所以它是多对多客人方。假设拥有方是`Guest`：

```
xxxxBundle\Entity\Guest:
  manyToMany:
    categories:
      targetEntity: Category
      inversedBy: guests
      joinTable:
         name: guests_categories 
```

> 一个类别会有很多客人（manyToOne）

如果类别会有很多客人，为什么是**多对一**？许多类别可以分配给许多客人：

```
xxxxBundle\Entity\Category:
  manyToMany:
    guests:
      targetEntity: Guest
      mappedBy: categories 
```

如果我理解正确，即使没有客人也可能存在类别，反之亦然，即使没有类别也可能存在客人。

对于客人/活动的关系，我会再去多对多/多对多。看看[这里](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/association-mapping.html)并问自己：我的实体的一个/多个类型可以有另一个实体的一个/多个类型？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T08:23:48.173

我改变了主意并使用了注释，因为 yaml 让我感到困惑。

至今 ：

对于**来宾**实体

```
<?php
// xxxxBundle/Entity/Guest.php

namespace xxxxBundle\Entity;

use Symfony\Component\Validator\Mapping\ClassMetadata;
use Symfony\Component\Validator\Constraints\NotBlank;
use Symfony\Component\Validator\Constraints\Email;
use Symfony\Component\Validator\Constraints\MinLength;
use Symfony\Component\Validator\Constraints\MaxLength;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity
 * @ORM\Table(name="guest")
 */
class Guest
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
    * @ManyToMany(targetEntity="Category", inversedBy="guests")
    * @JoinTable(name="guests_categories")
    */
    protected $categories;

    /**
    * @ManyToMany(targetEntity="Event", inversedBy="events")
    * @JoinTable(name="guests_events")
    */
    protected $events;

    /**
     * @ORM\Column(type="string", length=30)
     */
    protected $name;

    /**
     * @ORM\Column(type="string", length=30)
     */
    protected $surname;

    /**
     * @ORM\Column(type="string", length=30)
     */
    protected $email;

    /**
     * @ORM\Column(type="string", length=100)
     */
    protected $address;

    /**
     * @ORM\Column(type="string", length=10)
     */
    protected $phone;

    /**
     * @ORM\Column(type="string", length=10)
     */
    protected $mobile;

    /**
     * @ORM\Column(type="text")
     */
    protected $description;

    /**
     * @ORM\Column(type="datetime")
     */
    protected $created_at;

    /**
     * @ORM\Column(type="datetime")
     */
    protected $updated_at;

    /**
     * @ORM\Column(type="string")
     */
    protected $token;

    /**
     * @ORM\Column(type="boolean")
     */
    protected $is_activated;

    public function __construct() {
        $this->categories = new \Doctrine\Common\Collections\ArrayCollection();
    }

    public static function loadValidatorMetadata(ClassMetadata $metadata)
    {
        $metadata->addPropertyConstraint('name', new NotBlank());
        $metadata->addPropertyConstraint('surname', new NotBlank());
        $metadata->addPropertyConstraint('email', new Email(array(
            'message' => 'I do not like invalid emails. Give me a real one!')));

        $metadata->addPropertyConstraint('phone', new MaxLength(10));
        $metadata->addPropertyConstraint('mobile', new MaxLength(10));

    }    

} 
```

对于**类别**实体

```
<?php
// xxxxBundle/Entity/Category.php

namespace xxxxBundle\Entity;

use Symfony\Component\Validator\Mapping\ClassMetadata;
use Symfony\Component\Validator\Constraints\NotBlank;
use Symfony\Component\Validator\Constraints\Email;
use Symfony\Component\Validator\Constraints\MinLength;
use Symfony\Component\Validator\Constraints\MaxLength;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity
 * @ORM\Table(name="category")
 */
class Category
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
    * @ManyToMany(targetEntity="Guest", mappedBy="categories")
    */
    protected $guests;

    /**
     * @ORM\Column(type="string", length=30)
     */
    protected $name;

    /**
     * @ORM\Column(type="text")
     */
    protected $description;

    public function __construct() {
        $this->categories = new \Doctrine\Common\Collections\ArrayCollection();
    }

    public static function loadValidatorMetadata(ClassMetadata $metadata)
    {
        $metadata->addPropertyConstraint('name', new NotBlank());

    }    

} 
```

对于**事件**实体

```
<?php
// xxxxBundle/Entity/Event.php

namespace xxxxBundle\Entity;

use Symfony\Component\Validator\Mapping\ClassMetadata;
use Symfony\Component\Validator\Constraints\NotBlank;
use Symfony\Component\Validator\Constraints\Email;
use Symfony\Component\Validator\Constraints\MinLength;
use Symfony\Component\Validator\Constraints\MaxLength;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity
 * @ORM\Table(name="event")
 */
class Event
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
    * @ManyToMany(targetEntity="Guest", mappedBy="categories")
    */
    protected $guests;

    /**
     * @ORM\Column(type="string", length=30)
     */
    protected $name;

    /**
     * @ORM\Column(type="string", length=100)
     */
    protected $location;

    /**
     * @ORM\Column(type="text")
     */
    protected $description;

    /**
     * @ORM\Column(type="datetime")
     */
    protected $scheduled_at;

    public function __construct() {
        $this->categories = new \Doctrine\Common\Collections\ArrayCollection();
    }

    public static function loadValidatorMetadata(ClassMetadata $metadata)
    {
        $metadata->addPropertyConstraint('name', new NotBlank());
        $metadata->addPropertyConstraint('location', new NotBlank());
    }    

} 
```

我对**出勤**实体感到困惑。出勤实体将具有以下变量：

*   Guest_id
*   Event_id
*   Will_attend（是/否/也许）
*   评论
*   Replied_at
*   更新_at

我不知道哪个是主键（或主键？）。db 表不需要有单独的 Id（或没有？）。

```
<?php
// xxxxBundle/Entity/Attendance.php

namespace xxxxBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * @ORM\Entity
 * @ORM\Table(name="attendance")
 */
class Attendance
{
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;

    /**
    * @ManyToMany(targetEntity="Guest", mappedBy="categories")
    */
    protected $guests;

    /**
    * @ManyToMany(targetEntity="Event", mappedBy="events")
    */
    protected $events;

    /**
     * @ORM\Column(type="string", length=3)
     */
    protected $will_attend;

    /**
     * @ORM\Column(type="text")
     */
    protected $description;

    /**
     * @ORM\Column(type="datetime")
     */
    protected $replied_at;

    public function __construct() {
        $this->categories = new \Doctrine\Common\Collections\ArrayCollection();
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T11:37:22.043

出席实体要求一个人声明他/她将参加或不参加活动。这意味着它是 oneToOne 关系，因为每个事件都必须是一个事件 - 一个人 - 一个出席回复。

解决方法是在考勤实体中更改以下代码：

```
/**
* @ORM\OneToOne(targetEntity="Guest")
*/
protected $guests;

/**
* @ORM\OneToOne(targetEntity="Event")
*/
protected $events; 
```

然后运行`php app/console doctrine:generate:entities`​​和`php app/console doctrine:schema:update --force`crud 命令，如果您自动生成它们。现在一切正常。

# java - 我的方法有效吗？

> ID：11835860
> 
> 赞同：7
> 
> 时间：2012-08-06T21:01:17.090
> 
> 标签：java, shuffle, playing-cards

我正在为一副牌写一个代码，它会洗牌一副牌。我测试了代码，但我真的不知道它是否真的在做它应该正确做的事情？你怎么看？

这是 shuffle 方法的代码：

```
public void shuffle()
{
    for( int x = myDeck.size(); x > 0 ; x--) 
     {
        Random rn = new Random();
        int index1 = rn.nextInt(52);
        Card c = myDeck.remove(index1);
        myDeck.add(c);
     }
  } 
```

我的输出似乎在数字上打乱了，但不是像黑桃心等卡片的名字，

例如，这是我测试代码时的输出：

```
Deuce of spades
Seven of spades
Eight of spades
Ace of spades
Three of hearts
Five of hearts
Six of hearts
Seven of hearts
Nine of hearts
Ten of hearts
Queen of hearts
King of hearts
Ace of hearts
Seven of diamonds
Eight of diamonds
Jack of diamonds
King of diamonds
Three of clubs
Seven of clubs
Nine of clubs
Jack of clubs
Queen of clubs
King of clubs
Ace of clubs
Queen of spades
Deuce of clubs
Three of spades
Nine of diamonds
Four of spades
Four of clubs
Deuce of hearts
Jack of spades
Ten of clubs
Six of diamonds
Jack of hearts
Six of clubs
Four of diamonds
Five of diamonds
Ace of diamonds
Four of hearts
Nine of spades
Ten of spades
Five of spades
Three of diamonds
Six of spades
Five of clubs
Deuce of diamonds
Eight of hearts
King of spades
Ten of diamonds
Eight of clubs
Queen of diamonds 
```

就像总是有重复的名字一样。这是错误的，因为洗牌的目的是把它混合起来吗？

这是一个实际的问题：在打牌时，洗牌当然很重要，也就是说，要安排好东西，以便以随机顺序发牌。有几种方法可以实现这一点。一种策略是反复从牌组中随机挑选一张牌并将其移到最后。以下代码使用 Random 类（您在在线课程的“ArrayLists”部分的第 8 页遇到过）来执行这样的“选择并移动到末尾”操作：

```
Random rn = new Random();
int index1 = rn.nextInt( 52 );
Card c = myDeck.remove( index1 );
myDeck.add( c ); 
```

为了有效地洗牌，这个操作应该重复很​​多次（比如 500 次）。为使用单个 Random 对象和 for 循环对 myDeck 进行随机播放的 Deck 类创建一个新的实例方法 shuffle。在适当地修改 main 方法后，用它来测试你的新代码。

所以我的主要问题是：我做错了吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-06T21:05:14.587

只需更改`rn.nextInt(52);`为`rn.nextInt(x)`，您就有了适当的[Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)。无需进行超过 52 次迭代。

**为什么这样有效：**

*   在第一次迭代中（何时`x`为 52），您将从整副牌中随机选择一张牌并最后移动它。

*   在第二次迭代中（何时`x`为 51），您将从*剩余*的牌中随机选择一张牌并最后移动它。

    ...等等。

*   52 次迭代后，选择的第一张卡片将最终出现在第一个索引中。由于这张牌是从整副牌中随机选择的，因此每张牌的概率相同。

*   同样适用于第二个索引，第三个索引，...

*   由此可见，牌组的每一种可能排列都是同样可能的。

（在生产代码中，只[`Collections.shuffle`](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Collections.html#shuffle%28java.util.List%29)在这些情况下使用。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T21:06:20.680

最好的方法是使用内置的`Collections.shuffle()`方法，它会以随机的方式（或足够接近随机）为你打乱你的 ArrayList。

目前你的逻辑问题在于它从牌组中随机挑选一张牌，并将其放在最后 - 并且这样做了 52 次。现在你有一个很好的改变，你最终会多次对多张卡片执行此操作，有些根本没有 - 因此你遇到的问题是很多卡片似乎没有被随机化。

您似乎有逻辑需要对一副牌中的卡片数量进行此操作，这是有缺陷的；您需要多次执行它。

您有两个主要的逻辑解决方案，首先您可以多次执行此操作 - 比您目前执行的次数多 10 倍，或者您可以重新设计您的代码以使用内置（或更有效）的洗牌算法.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T21:05:05.250

这个问题给出了一个提示：

> 为了有效地洗牌，这个操作应该重复很​​多次（比如 500 次）。

而您的循环仅运行 52 次 ( `myDeck.size()`)。所以你取出一张卡并随机更换它只有 52 次。这似乎还不够。

`for(int i = 0; i < max; i++)`ps：比写更常用`for (int i = max; i >0 i--)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T21:27:13.623

将循环更改为：

```
 ArrayList<Integer> myDeck = new ArrayList<Integer>();
   for(int i=0; i< 52; i++){
       myDeck.add(i);
   }
   Random rn = new Random();    
   for( int x = 52; !myDeck.isEmpty() ; x--) {                
        int index1 = rn.nextInt(myDeck.size());
        //Card c = (Card)myDeck.remove(index1);  -> this comment here should be removed
        System.out.print(index1 + ", ");
     }
  } 
```

这样您就不会重复选择同一张卡片，而且您总是会选择一个数字（单元格）< myDeck.size()，当您移除卡片时该数字会不断变化，并且在卡片组中没有卡片时进行救助

# python - F() 表达式和从 F() 表达式创建的 timedelta 的总和

> ID：11835870
> 
> 赞同：4
> 
> 时间：2012-08-06T21:02:21.563
> 
> 标签：python, django, django-models

我的提案模型定义如下：

```
class Proposal(models.Model):
    scheduled_time = models.DateTimeField()
    duration = models.IntegerField() # stores minutes as an integer

    # (extra fields clipped for brevity's sake) 
```

我想注释每个提案对象，给它一个由 schedule_time + 持续时间的 timedelta 表示计算的“结束”日期时间，例如`timedelta(minutes=duration)`。但是， F() 表达式似乎不能作为`timedelta()`.

```
>>> from datetime import timedelta
>>> from django.db.models import F
>>> from schedule.models import Proposal
>>>
>>> proposals = Proposal.objects.all()
>>> annotated = proposals.annotate(
...     end=F('scheduled_time')+timedelta(minutes=F('duration')))
Traceback (most recent call last):
  File "<console>", line 1, in <module>
TypeError: unsupported type for timedelta minutes component: F
>>> 
```

`annotate()`使用and F() 表达式可以实现这种事情吗？

**编辑：**注释的目的是能够过滤/排除计算的结束时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:22:26.387

`F()`-expressions 仅适用于 django（因为它们返回特定对象的实例）。除了某些 django 查询集方法之外，您不能将它们传递给 timedelta 或其他任何东西。

所以你最好为你的模型添加新字段：

```
class Proposal(models.Model):
    scheduled_time = models.DateTimeField()
    duration = IntegerField()
    end = models.DateTimeField(default=self.scheduled_time + timedelta(minutes=self.duration)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T11:48:58.243

正如@Daniil 已经指出的那样， F() 不能那样使用。

一个可能的解决方案是添加一个新字段

```
end_time = models.DateTimeField() 
```

并覆盖保存方法

```
def save(self, *args, **kwargs):
    if not self.end_time:
        self.end_time = self.scheduled_time + datetime.timedelta(self.duration)
    super(Proposal, self).save(*args, **kwargs) 
```

# python - Python 脚本在 Linux 上运行良好，在 Windows 上，导致 WindowsError: [Error 5] Access is denied

> ID：11835873
> 
> 赞同：3
> 
> 时间：2012-08-06T21:02:37.807
> 
> 标签：python, windows, windows-xp

我有一个在 Linux 上运行良好的简单 python 脚本，我将它移到 Windows 机器上，当我尝试运行它时，我收到以下异常消息：

```
Traceback (most recent call last):
  File "C:\path\to\my\script.py", line 57, in <module>
    retcode = subprocess.call(command)
  File "C:\Python27\lib\subprocess.py", line 493, in call
    return Popen(*popenargs, **kwargs).wait()
  File "C:\Python27\lib\subprocess.py", line 679, in __init__
    errread, errwrite)
  File "C:\Python27\lib\subprocess.py", line 893, in _execute_child
    startupinfo)
WindowsError: [Error 5] Access is denied 
```

以下是引发异常的代码片段：

```
print 'command is:',command
retcode = subprocess.call(command) 
```

控制台输出如下：

> > 命令是：['c:\python27', 'C:\path\to\script.py', '--mode=2', '--check-temp=false', '--all-seasons=true ', '--added=1', '--max-temp=2000', '--source=2', '--loc=XYZ'] 调试时出现未处理的异常...

任何人都知道如何解决这个问题？

我在 Windows XP Professional 上运行 python v2.7.3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T21:38:27.090

根据[文档](http://docs.python.org/library/subprocess#subprocess.Popen)，参数序列中的第一项（在这种情况下，命令的第一个元素）被解释为要执行的程序。

查看命令的第一个元素，您似乎正在尝试执行一个目录。每当您尝试从目录中读取文件时，Windows（有点不直观）都会返回拒绝访问错误，如果您尝试执行文件，也会发生同样的事情。

而不是`c:\python27`你可能想要`c:\python27\bin\python.exe`或类似的东西。无论如何，您需要指向可执行文件，而不是目录。我不确定为什么这在 Linux 上对你有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:10:02.053

您的程序无权访问该文件...检查您尝试访问的文件的权限，然后从那里开始...（即，提升 Python 解释器的权限，或减少对所述资源所需的访问权限） - 无论哪种方式 - 小心行事。

# c# - 表单认证cookie漏洞

> ID：11835875
> 
> 赞同：0
> 
> 时间：2012-08-06T21:02:53.623
> 
> 标签：c#, asp.net, security, iis-7

我有一个关于`Form authentication`cookie 漏洞的问题。在 JavaScript 中，我们可以使用 document.cookie 来访问表单身份验证 cookie 值（假设它不是 httponly）。此值已加密。我在许多博客中读到，如果有人得到这个值，我们的安全就会被破坏。我的问题是他（攻击者）如何破坏它（cookie 中的凭据），因为表单身份验证加密方法使用机器密钥来加密该 cookie，所以要解密它，需要相同的机器密钥？不是这样吗？你能澄清一下这个cookie值是如何易受攻击的，因为攻击者应该只有我的机器密钥才能解密它吗？我在这里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:05:02.873

> 由于表单身份验证加密，他（攻击者）如何破坏它（cookie 中的凭据）

他不必解密加密的 cookie。他可以只使用 cookie 的加密值并成为你。

服务器进行加密，所以它不知道给它 cookie 的浏览器是 cookie 最初发给的人。

如果我能够获得它，使用像[Modify This Cookie](https://chrome.google.com/webstore/detail/fngmhnnpilhplaeedifhccceomclgfbg)之类的扩展（或任何其他实现该功能的东西）将允许我将我的 cookie 设置为您的加密值。

具有讽刺意味[的是，同样的问题](http://www.troyhunt.com/2012/08/is-stack-overflow-secure-kind-of.html)也被问到了 StackOverflow。查看 Troy 的帖子以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-06T21:15:33.180

我所做的，不知道它实际上有多大帮助，但我从未见过任何违规行为（尽管进行了大约 100 次尝试）是将 cookie 与 IP 地址配对，这意味着我查找如果呼叫来自与前一个呼叫相同的 IP 地址，如果不是，它会重置 cookie，您将不得不再次登录。这并非对所有站点都完全可行，但在我的情况下，添加一些安全措施而不是允许移动性更为重要。

这种方法可能很容易受到 MITM 攻击，但你永远无法保护自己免受所有可能性的影响，除非你有巨额预算并且对性能和可访问性没有限制。

# ruby-on-rails - 未初始化的常量 ApplicationController::Mailer

> ID：11835878
> 
> 赞同：0
> 
> 时间：2012-08-06T21:03:06.207
> 
> 标签：ruby-on-rails, ruby-on-rails-3, applicationcontroller

当我在开发模式下运行我的 rails 应用程序时，它运行良好。当我在生产模式下运行它时，它不会启动。相反，它给了我：`uninitialized constant ApplicationController::Mailer`。此应用程序已从 rails 2 应用程序升级，所以有什么我可能会丢失或任何其他想法为什么它不会工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:20:18.220

发现答案与一个不应该存在的文件有关，[请参阅 helpsheets.co 中的此问答](https://www.helpsheets.co/questions/31-rails-undefined-mailer)。

# ruby - Watir Webdriver如何关闭子窗口

> ID：11835881
> 
> 赞同：6
> 
> 时间：2012-08-06T21:03:19.743
> 
> 标签：ruby, automation, watir, watir-webdriver

我正在将一些遗留的 Watir 脚本迁移到 Watir-Webdriver。除了他们如何设计 Watir-Webdriver 来处理弹出窗口之外，迁移大部分进展顺利。他们没有使用久经考验的“附加”方法，而是用简化的“窗口”方法代替了它。语法很简单，但是我很难理解如何在不关闭父窗口的情况下关闭单独的子窗口。目前我的代码是这样的 -

```
 b.button(:xpath => PREVIEWBUTTON).click
  b.window(:title, POPUPWINDOW).use DO
    b.close
  end 
```

目前正在发生的是 b.close 方法正在关闭子窗口和父窗口。我不确定为什么会发生这种情况，因为 b.close 方法包含在 DO 块中。我需要验证“PREVIEWBUTTON”确实创建了一个子窗口，但我需要父窗口保持打开状态。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-06T21:33:02.013

试试这个：

```
b.window(:title, POPUPWINDOW).close 
```

# python - twitter Api使用python给出错误

> ID：11835882
> 
> 赞同：1
> 
> 时间：2012-08-06T21:03:24.563
> 
> 标签：python, twitter

> 嗨，我是 python 新手，我收到了这个错误，但我已经安装了 twitter，但它给出了这个错误

```
import twitter
api=twitter.Api()
Traceback (most recent call last):
File "<pyshell#1>", line 1, in <module>
api=twitter.Api()
AttributeError:'module' object has no attribute 'Api' 
```

我不知道这个错误，因为我几乎每个包都与 twitter 相关

```
Traceback (most recent call last):
  File "<pyshell#2>", line 1, in <module>
    api = twitter.Api()
AttributeError: 'module' object has no attribute 'Api' 
```

当我给出这个命令 python setup.py install_data 它给出像这样运行 install_data 的错误

```
Traceback (most recent call last) :
file "setup.py" ,line 47 , <module>
""" ,
File "C:\python26\lib\distutils\core.py" ,line 152 , in setup
dist.run_commands()
File "C:\python26\lib\distutils\dist.py" ,line 975 , in run_commands
self.run_command(cmd)
File "C:\python26\lib\distutils\dist.py" ,line 995 , in run_commands
command_obj.run
File "C:\python26\lib\distutils\command\install_data.py" , line 44 in run
For f in self.data_files 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:08:59.280

你可以重新安装使用，

```
sudo pip install twitter 
```

或者

```
sudo easy_install twitter 
```

旧版本不需要 OAuth，但新版本需要。最新版本的文档需要这些来启动API

```
>>> api = twitter.Api(consumer_key='consumer_key',

    consumer_secret='consumer_secret', access_token_key='access_token', access_token_secret='access_token_secret') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T19:54:29.743

您与库混合实际上的问题是您正在阅读 python_twitter 库并安装了 twitter。您需要选择正确的文档。这是文档错误，没有别的。您安装了正确的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:30:42.370

错误消息“'module' object has no attribute 'Api'”的意思是：Python 在导入的模块 'twitter' 中找不到任何名为 'Api' 的东西。

`dir(twitter)`在 import 语句之后尝试。`dir()`将显示 Python 在对象中找到的内容。如果`dir(twitter)`显示一个名为“twitter”的对象，您可能需要执行类似`from twitter import twitter`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T21:41:31.963

你从哪里安装了 python twitter 模块？我使用了[http://code.google.com/p/python-twitter/source/browse/twitter.py](http://code.google.com/p/python-twitter/source/browse/twitter.py)，它有一个 Api 类。

```
>>> import twitter
>>> api = twitter.Api() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T21:45:59.033

您安装了错误的 Twitter 库。我猜你已经完成了

```
pip install twitter 
```

你应该卸载那个库：

```
pip uninstall twitter 
```

并安装正确的（*）一个

```
pip install python_twitter 
```

(*) 正确的意思是您正在阅读文档的那个:-)

# algorithm - 给定包含每个节点之间旅行时间的矩阵时，如何计算两地之间的最短旅行时间

> ID：11835883
> 
> 赞同：-1
> 
> 时间：2012-08-06T21:03:24.247
> 
> 标签：algorithm, graph, path, matrix, shortest

对于`n`车站，给出了一个`n*n`矩阵，表示从车站到(i,j <= n)的直接行程时间。`A``A[i][j]``i``j`

在车站之间旅行的人总是寻求最少的时间。给定两个站号`a`，`b`如何计算它们之间的最短旅行时间？

这个问题可以在不使用图论的情况下解决，即仅通过矩阵 A 来解决吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-06T21:15:20.217

你确实需要图论来解决它——更具体地说，你需要[Dijkstra 的算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)。将图表示为矩阵既不是该算法的优点也不是缺点。

但请注意，Dijkstra 算法要求所有距离都是非负的。如果由于某种原因矩阵中有负“距离”，则必须改用较慢的[Bellman-Ford 算法](http://en.wikipedia.org/wiki/Bellman-ford)。

（如果您真的热衷于使用矩阵运算并且不介意它会非常慢，您可以使用基于非常简单的矩阵运算的[Floyd-Warshall 算法来计算](http://en.wikipedia.org/wiki/Floyd-Warshall)*所有*对之间的最短路径站（大量过度杀伤），然后选择您感兴趣的对...）

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-08-06T21:11:25.533

这看起来与 NP 难题的旅行商问题惊人地相似。

[到 TSP 的 Wiki 链接](http://en.wikipedia.org/wiki/Travelling_salesman_problem)

# jsf-2 - f:convertNumber remove comma as thousand separator

> ID：11835888
> 
> 赞同：2
> 
> 时间：2012-08-06T21:03:52.403
> 
> 标签：jsf-2, number-formatting

I want to round value with four decimal places to one decimal place. That is why I use `f:convertNumber`:

```
<h:outputText value="${current.dayAverage.pressureRelative}" >      
    <f:convertNumber maxFractionDigits="1"/>
</h:outputText> 
```

The rounding is done right, but the `f:convertNumber` adds thousand comma separator. I want to remove this separator but I don't know how. I am using Apache MyFaces 2.1 implementation. In the [API for f:convertNumber](http://myfaces.apache.org/core21/myfaces-impl/tagdoc/f_convertNumber.html) it does not have any attribute to specify thousand separator. I suppose that this could be defined in locale attribute?

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-12T09:03:48.920

You can remove the seperating commas by adding groupingUsed="false" to the f:convertNumber tag

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-06T21:41:18.067

You are right, its because of default locale. You have several options:

**1.Set default locale from faces-config:**

```
 <locale-config>
    <default-locale>de</default-locale>
    <supported-locale>en_US</supported-locale>
    <supported-locale>es</supported-locale>
    <supported-locale>de</supported-locale>
    <supported-locale>fr_FR</supported-locale>
    <supported-locale>it_IT</supported-locale>
    <supported-locale>pt_br</supported-locale>
  </locale-config> 
```

**2.Set locale from backed bean and read via converter:**

```
<f:convertNumber locale="#{bean.locale}" /> 
```

**3.Set local on converter:**

```
<f:convertNumber locale="en-US" /> 
```

Well thanks to [BalusC](https://stackoverflow.com/questions/7856152/set-decimal-separator-when-formatting-hintputtext) he answered all the questions:) there you can find also view example, so i felt little bit guilty and get output for available locals (1000000 formatted):

```
ja_JP   Japanese (Japan)        1,000,000
es_PE   Spanish (Peru)      1.000.000
en  English     1,000,000
ja_JP_JP    Japanese (Japan,JP)     1,000,000
es_PA   Spanish (Panama)        1,000,000
sr_BA   Serbian (Bosnia and Herzegovina)        1.000.000
mk  Macedonian      1.000.000
es_GT   Spanish (Guatemala)     1,000,000
ar_AE   Arabic (United Arab Emirates)       1,000,000
no_NO   Norwegian (Norway)      1 000 000
sq_AL   Albanian (Albania)      1.000.000
bg  Bulgarian       1 000 000
ar_IQ   Arabic (Iraq)       1,000,000
ar_YE   Arabic (Yemen)      1,000,000
hu  Hungarian       1 000 000
pt_PT   Portuguese (Portugal)       1.000.000
el_CY   Greek (Cyprus)      1.000.000
ar_QA   Arabic (Qatar)      1,000,000
mk_MK   Macedonian (Macedonia)      1.000.000
sv  Swedish     1 000 000
de_CH   German (Switzerland)        1'000'000
en_US   English (United States)     1,000,000
fi_FI   Finnish (Finland)       1 000 000
is  Icelandic       1.000.000
cs  Czech       1 000 000
en_MT   English (Malta)     1,000,000
sl_SI   Slovenian (Slovenia)        1.000.000
sk_SK   Slovak (Slovakia)       1 000 000
it  Italian     1.000.000
tr_TR   Turkish (Turkey)        1.000.000
zh  Chinese     1,000,000
th  Thai        1,000,000
ar_SA   Arabic (Saudi Arabia)       1,000,000
no  Norwegian       1 000 000
en_GB   English (United Kingdom)        1,000,000
sr_CS   Serbian (Serbia and Montenegro)     1.000.000
lt  Lithuanian      1 000 000
ro  Romanian        1.000.000
en_NZ   English (New Zealand)       1,000,000
no_NO_NY    Norwegian (Norway,Nynorsk)      1 000 000
lt_LT   Lithuanian (Lithuania)      1 000 000
es_NI   Spanish (Nicaragua)     1,000,000
nl  Dutch       1.000.000
ga_IE   Irish (Ireland)     1,000,000
fr_BE   French (Belgium)        1.000.000
es_ES   Spanish (Spain)     1.000.000
ar_LB   Arabic (Lebanon)        1,000,000
ko  Korean      1,000,000
fr_CA   French (Canada)     1 000 000
et_EE   Estonian (Estonia)      1 000 000
ar_KW   Arabic (Kuwait)     1,000,000
sr_RS   Serbian (Serbia)        1.000.000
es_US   Spanish (United States)     1,000,000
es_MX   Spanish (Mexico)        1,000,000
ar_SD   Arabic (Sudan)      1,000,000
in_ID   Indonesian (Indonesia)      1.000.000
ru  Russian     1 000 000
lv  Latvian     1 000 000
es_UY   Spanish (Uruguay)       1.000.000
lv_LV   Latvian (Latvia)        1 000 000
iw  Hebrew      1,000,000
pt_BR   Portuguese (Brazil)     1.000.000
ar_SY   Arabic (Syria)      1,000,000
hr  Croatian        1.000.000
et  Estonian        1 000 000
es_DO   Spanish (Dominican Republic)        1,000,000
fr_CH   French (Switzerland)        1'000'000
hi_IN   Hindi (India)       ?,???,???
es_VE   Spanish (Venezuela)     1.000.000
ar_BH   Arabic (Bahrain)        1,000,000
en_PH   English (Philippines)       1,000,000
ar_TN   Arabic (Tunisia)        1,000,000
fi  Finnish     1 000 000
de_AT   German (Austria)        1.000.000
es  Spanish     1.000.000
nl_NL   Dutch (Netherlands)     1.000.000
es_EC   Spanish (Ecuador)       1.000.000
zh_TW   Chinese (Taiwan)        1,000,000
ar_JO   Arabic (Jordan)     1,000,000
be  Belarusian      1 000 000
is_IS   Icelandic (Iceland)     1.000.000
es_CO   Spanish (Colombia)      1.000.000
es_CR   Spanish (Costa Rica)        1,000,000
es_CL   Spanish (Chile)     1.000.000
ar_EG   Arabic (Egypt)      1,000,000
en_ZA   English (South Africa)      1,000,000
th_TH   Thai (Thailand)     1,000,000
el_GR   Greek (Greece)      1.000.000
it_IT   Italian (Italy)     1.000.000
ca  Catalan     1.000.000
hu_HU   Hungarian (Hungary)     1 000 000
fr  French      1 000 000
en_IE   English (Ireland)       1,000,000
uk_UA   Ukrainian (Ukraine)     1 000 000
pl_PL   Polish (Poland)     1 000 000
fr_LU   French (Luxembourg)     1 000 000
nl_BE   Dutch (Belgium)     1.000.000
en_IN   English (India)     1,000,000
ca_ES   Catalan (Spain)     1.000.000
ar_MA   Arabic (Morocco)        1,000,000
es_BO   Spanish (Bolivia)       1.000.000
en_AU   English (Australia)     1,000,000
sr  Serbian     1.000.000
zh_SG   Chinese (Singapore)     1,000,000
pt  Portuguese      1.000.000
uk  Ukrainian       1 000 000
es_SV   Spanish (El Salvador)       1,000,000
ru_RU   Russian (Russia)        1 000 000
ko_KR   Korean (South Korea)        1,000,000
vi  Vietnamese      1.000.000
ar_DZ   Arabic (Algeria)        1,000,000
vi_VN   Vietnamese (Vietnam)        1.000.000
sr_ME   Serbian (Montenegro)        1.000.000
sq  Albanian        1.000.000
ar_LY   Arabic (Libya)      1,000,000
ar  Arabic      1,000,000
zh_CN   Chinese (China)     1,000,000
be_BY   Belarusian (Belarus)        1 000 000
zh_HK   Chinese (Hong Kong)     1,000,000
ja  Japanese        1,000,000
iw_IL   Hebrew (Israel)     1,000,000
bg_BG   Bulgarian (Bulgaria)        1 000 000
in  Indonesian      1.000.000
mt_MT   Maltese (Malta)     1,000,000
es_PY   Spanish (Paraguay)      1.000.000
sl  Slovenian       1.000.000
fr_FR   French (France)     1 000 000
cs_CZ   Czech (Czech Republic)      1 000 000
it_CH   Italian (Switzerland)       1'000'000
ro_RO   Romanian (Romania)      1.000.000
es_PR   Spanish (Puerto Rico)       1,000,000
en_CA   English (Canada)        1,000,000
de_DE   German (Germany)        1.000.000
ga  Irish       1,000,000
de_LU   German (Luxembourg)     1.000.000
de  German      1.000.000
es_AR   Spanish (Argentina)     1.000.000
sk  Slovak      1 000 000
ms_MY   Malay (Malaysia)        1,000,000
hr_HR   Croatian (Croatia)      1.000.000
en_SG   English (Singapore)     1,000,000
da  Danish      1.000.000
mt  Maltese     1,000,000
pl  Polish      1 000 000
ar_OM   Arabic (Oman)       1,000,000
tr  Turkish     1.000.000
th_TH_TH    Thai (Thailand,TH)      ?,???,???
el  Greek       1.000.000
ms  Malay       1,000,000
sv_SE   Swedish (Sweden)        1 000 000
da_DK   Danish (Denmark)        1.000.000
es_HN   Spanish (Honduras)      1,000,000 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-09-26T20:03:09.950

This is what you need:

```
<h:outputText value="${current.dayAverage.pressureRelative}">
    <f:convertNumber type="number" groupingUsed="false" />
</h:outputText> 
```

# notepad++ - Notepad++ 的整洁 CSS

> ID：11835894
> 
> 赞同：13
> 
> 时间：2012-08-06T21:04:26.077
> 
> 标签：notepad++, htmltidy, csstidy

Notepad++ 是否有某种可用的 CSS tidy。我已经尝试过 TEXTFX 中似乎每个菜单项，但似乎没有人这样做。我习惯使用 PSPAD，您只需选择 CSS 并单击“重新格式化为结构化 CSS”

**EDIT**在问了这个可能对其他人有帮助的问题后很久才发现......`tidy css`和之间有很大的区别`format css`。它实际上是我正在寻找的后者，并且有几个在线系统，例如[http://procssor.com/](http://procssor.com/)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2015-05-28T16:26:51.967

我自己也在寻找这个功能，所以我为 Notepad++ 编写了这对基于正则表达式搜索和替换的宏。*Format CSS*格式化 CSS 文档，而*Minify CSS*使其更小。

要安装它们，请找到您的*shortcuts.xml*文件，通常位于

> C:\Users\%username%\AppData\Roaming\Notepad++\shortcuts.xml

并将整个块粘贴到`<NotepadPlus><Macros>`块中。

*您需要使用 Notepad++ 以外的其他编辑器，或者在编辑此文件后通过终止进程来关闭 Notepad++。否则，**Notepad++ 将在关闭时覆盖文件。***

安装后，您可以从 Notepad++ 的 Macros 菜单运行这些宏，也可以使用*Edit shortcut/delete macro*重命名它们或分配热键。

如果有人发现此脚本不起作用的 css，请[粘贴](http://pastebin.com/)并将链接发布在评论中，以便我查看。

### 宏源 XML

```
<Macro name="Format CSS" Ctrl="no" Alt="no" Shift="no" Key="0">
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam="([^\r\n;])\}(?![\r\n])" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam="\1;\r\n}\r\n" />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam="([^\r\n])\}(?![\r\n])" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam="\1\r\n}\r\n" />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam="([^\r\n])\{(?![\r\n])" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam="\1\r\n{\r\n" />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam=";(?![\r\n])" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam=";\r\n" />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam="(^(?![ \t]).+;)" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam="    \1" />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam="\}(?!(\r?\n\r?\n))" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam="}\r\n" />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam=":(?![ ])(?=.+;)" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam=": " />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
</Macro>
<Macro name="Minify CSS" Ctrl="no" Alt="no" Shift="no" Key="0">
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam="[\r\n\t ]+" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam=" " />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam="[ ]*\}[ ]*" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam="}" />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam="[ ]*\{[ ]*" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam="{" />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam="[ ]*;[ ]*" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam=";" />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam=";\}" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam="}" />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
    <Action type="3" message="1700" wParam="0" lParam="0" sParam="" />
    <Action type="3" message="1601" wParam="0" lParam="0" sParam="[ ]*:[ ]*" />
    <Action type="3" message="1625" wParam="0" lParam="2" sParam="" />
    <Action type="3" message="1602" wParam="0" lParam="0" sParam=":" />
    <Action type="3" message="1702" wParam="0" lParam="768" sParam="" />
    <Action type="3" message="1701" wParam="0" lParam="1609" sParam="" />
</Macro> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-08-03T06:50:48.227

JSTool插件的JSFormat函数呢？我知道这是出乎意料的，这个名字指的是 Javascript。它也有适用于 css 的格式和缩小功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T14:38:31.100

我已经在网上搜索过，就我而言，这个问题的答案是否定的，或者至少如果有的话，我肯定找不到；但如果有人提出更好的答案，我会接受。对我来说，我将继续使用 PsPad 进行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T13:54:33.080

这里有一个 Notepad++ 插件列表：http: [//sourceforge.net/apps/mediawiki/notepad-plus/index.php ?title=Plugin_Central](http://sourceforge.net/apps/mediawiki/notepad-plus/index.php?title=Plugin_Central)

只需搜索 CSS 并尝试这些插件。我不使用这样的插件，所以这里不推荐。

也许是 CSS-eXplorer 或 jN？

# python - 为什么 pip install -e git-repo 在第二次调用时将 HEAD 更改为 master

> ID：11835895
> 
> 赞同：3
> 
> 时间：2012-08-06T21:04:25.483
> 
> 标签：python, git, github, pip

如果我这样做：

```
pip install -e git://github.com/nimbis/django.git#egg=Django-dev 
```

然后 pip 将从该存储库 ( `1.4.1-patched`) 中获取默认分支并安装它，正如您在安装它的 src 目录中看到的那样：

```
cd ~/.virtualenvs/nimbis/src/django
[(1.4.1-patched) ~/.virtualenvs/nimbis/src/django]
$ git log | head -n4
commit a5d7c7b3a2d6a729bf5ede2254b5c75be9da94d7
Author: Lorin Hochstein <...>
Date:   Mon Jul 30 21:44:20 2012 -0400 
```

如果我再次这样做，HEAD 将与远程 master 分支相同，尽管它仍然使用 1.4.1-patched （默认分支）作为分支名称。

```
$ pip install -e git://github.com/nimbis/django.git#egg=Django-dev
[(1.4.1-patched) lorin@nibbler ~/.virtualenvs/nimbis/src/django]
$ git log | head -n4
commit e567f439bdfc60e16c465220fdaa8ea8a0fae936
Merge: c0748a6 226a3e7
Author: Alex Gaynor <...>
Date:   Sun Jul 29 17:07:55 2012 -0700 
```

我可以通过明确指定我想要的分支来解决问题，但是为什么 pip 会这样做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-06T21:38:24.760

如果目标路径已存在，PIP 版本控制对象 (pip.vcs.VersionControl) 将检查 check_destination。如果是这样，它调用更新方法而不是获取。更新硬重置默认分支。

您可以在上面引用的 VersionControl 类和 pip.vcs.git 中看到确切的行为。

编辑：误读了代码。每次都会调用获取，但如果存储库已经存在于目标位置，则更新如果调用而不是克隆。由于 rev_options 默认为“origin/master”，更新重置到这个分支。

这很可能是一个错误！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-06T21:25:10.123

```
pip install git+git://github.com/nimbis/django.git@branchorreviwant#egg=Django-dev 
```

# permissions - bash: ./configure: NTFS 分区上的权限被拒绝

> ID：11835901
> 
> 赞同：1
> 
> 时间：2012-08-06T21:04:44.290
> 
> 标签：permissions, configure, ntfs

首先，我想为我糟糕的英语道歉。

有什么方法可以在 NTFS 分区上使用 bash 脚本，例如配置？

今天我重新安装了我的双引导系统（win7 和 mint 13），因为我的旧系统分区太大而且我浪费了很多空间，所以我今天决定格式化磁盘，两个小的系统分区和两个更大的数据分区。（Win 为 40G[NTFS]，Mint 为 40G（35G[Ext4] + 5G Swap），2* ~200G[NTFS]）。好的，我想这对于前言来说已经足够了。

所以我的问题来了：所以我加载了 wine-git 存储库并将其存储到我的一个数据分区中。所以这是我的第一个问题，无法运行 ./configure 因为该文件没有任何执行权限（我已经解决了设置文件权限的问题，用户映射使用 ntfs acl）。因此，在设置执行权限后，我仍然无法运行 ./configure，我只是收到错误消息：bash: ./configure: Permission denied（仅作记录，我尝试以 root 身份运行它）。

那么，有人知道我如何在 NFTS 分区上运行配置脚本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:28:37.957

NTFS 不像 EXT 和类似卷那样支持权限。您遇到的问题是，由于这些权限未存储在磁盘上，因此在安装时为整个卷加载默认值，之后会默默地忽略更改。

您应该能够使用以下执行权限安装它：

```
mount [devicename] [directory] -o default,remount 
```

您需要成为超级用户。您不要在文件名周围包含括号（尽管如果它们包含空格，则它们需要用引号引起来。）

您可以使用以下命令找出设备名称和目录：

```
mount -l 
```

这将列出所有已安装的设备及其安装点。您无需成为超级用户即可发出此命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T22:26:31.123

在 Fedora 17 上，我使用以下命令挂载 NTFS 卷，并正确设置了所有可执行权限：

```
sudo mkdir /run/media/ohmyname/shared
sudo ntfsmount /dev/sda8 /run/media/ohmyname/shared 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-01T14:33:17.983

在 Fedora 26 上，一切都尽可能简单。我使用以下命令安装了具有写入权限的 Win 10 分区：

```
sudo ntfsfix /dev/sda9 
```

# c# - 更改中继器呈现内容方式的正确方法

> ID：11835902
> 
> 赞同：1
> 
> 时间：2012-08-06T21:04:47.020
> 
> 标签：c#, repeater

我想呈现受演示更改影响的内容。

例如，如果当前用户对某个项目进行了投票，则应该突出显示向上箭头，可能是通过更改类或类似性质的东西。

看起来，Repeater 是为更均匀的渲染而设计的。过去，我的解决方案是使用对象来构建 HTML 字符串，然后将一个简单的字符串数组绑定到中继器。

是否有更好的路径可以将某种 if/then 逻辑应用于中继器？是否有更适合这种情况的中继器替代品？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:32:30.373

如果当前用户尚未更新，您可以指定一个空的类属性。就像是：

```
<a href="#" onclick="upvote();" 
    class="<%# ((bool)Eval("CurrentUserHasUpvoted")) ? "on" : "off" %>">Upvote</a> 
```

# entity-framework - 如何使用 AutoMapper 从 DTO 映射到实体框架代理类？

> ID：11835905
> 
> 赞同：3
> 
> 时间：2012-08-06T21:04:53.790
> 
> 标签：entity-framework, automapper, poco, dto

我有一个 REST 样式的 Web 应用程序，它首先使用 EF 代码。我正在使用 AutoMapper 将我的类映射到 DTO 类，以便通过网络传递，并（希望）返回。

当我从我的 POCO 类映射到 DTO 时，我实际上是从一个 EF 代理对象开始的，因为我正在处理的对象是对我的`DataContext`. 然而，这似乎工作正常。

当我返回一个 DTO 类作为 POST 请求的一部分时，我可以使用 AutoMapper 将它映射到我的 POCO 类上，*这*也可以正常工作。

**但是**，因为 AutoMapper 只是 new()-ing POCO 对象而不是使用 上的`Create`方法，所以`EntitySet`我现在有一个 POCO 类而不是相应的 EF 代理类。这使我更难将数据添加到我的数据库等。

如何说服 AutoMapper 使用`EntitySet.Create`？还是有其他方法可以达到相同的效果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T20:36:42.410

`Map.CreateMap`创建一个[`IMappingExpression`](https://github.com/AutoMapper/AutoMapper/blob/master/src/AutoMapper/IMappingExpression.cs)对象，该对象具有`ConstructUsing`接受可用作新对象的工厂方法的函数的方法。映射的属性用于设置值。（顺便说一下，这可以被 覆盖`ConvertUsing`）。

有关详细信息，请参阅[Automapper - 如何映射到构造函数参数而不是属性设置器](https://stackoverflow.com/questions/2239143/automapper-how-to-map-to-constructor-parameters-instead-of-property-setters)、[AutoMapper 使用错误的构造函数](https://stackoverflow.com/questions/11147347/automapper-using-the-wrong-constructor)或[如何使用 Automapper 在没有默认构造函数的情况下构造对象](https://stackoverflow.com/questions/7192275/automapper-convertusing)。

在您的情况下，这可能类似于：

```
Mapper.CreateMap<TDto, TPoco>()
    .ConstructUsing((Func<TDto, TPoco>) (c => context.CreateObject<TPoco>())) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T03:36:44.493

May be you can do like this,

First create the required object and then use that instance to map the DTO object,

```
var poco=EntitySet.Create()

Mapper.Map<DTOtype, POCOtype>(dto, poco); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T05:31:09.200

假设您在 post 方法中接受 POCO 对象，而不是像 DTO 这样

```
[HttpPost]
public ActionResult Save(Student std)
{
    //do the stuff
} 
```

假设 Student 是 EF 代理类，但是当它使用 Modelbinder 绑定到表单值时，它会创建新对象而不是与数据上下文关联的对象。所以第一件事是，如果您在帖子中接受 DTO，然后将它们转换为代理类，或者您首先接受代理类，这没有区别。[第二件事是，如果对象已经存在于数据库中并且您刚刚使用 automapper 创建了它，则可以使用attach 方法](http://blogs.msdn.com/b/adonet/archive/2011/01/29/using-dbcontext-in-ef-feature-ctp5-part-4-add-attach-and-entity-states.aspx)与 datacontext 关联。如果它是新对象，您将需要调用该`Add`方法将其保存在数据库中。

# github - 什么是 Github 中已加星标的存储库？

> ID：11835909
> 
> 赞同：8
> 
> 时间：2012-08-06T21:05:04.683
> 
> 标签：github, repository

什么是 Github 中已加星标的存储库？- （未观看回购）。

这是一个**新**的Github 功能，他们也没有解释它......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-06T21:08:16.223

注意到了，被观看的 repos 的通知是如何污染你的新闻提要的？它现在分为“已加星标”，即只是一面旗帜和“手表”。稍后一个会进入您的新闻提要，第一个不会。

[你可以在 Githubs 博客](https://github.com/blog/1204-notifications-stars)中找到非常详细的解释

# css - CSS3多列内容溢出的策略

> ID：11835911
> 
> 赞同：1
> 
> 时间：2012-08-06T21:05:06.057
> 
> 标签：css, overflow, css-multicolumn-layout

我正在尝试使用新的多列布局设置多列布局。但是无论如何允许创建列的灵活宽度？
我在网上看到的所有策略总是导致固定宽度的布局，即使内容溢出列也是如此。

```
ul {
    -webkit-column-width: 80px;
    height: 80px;
}
```

```
<ul>
    <li>element</li>
    <li>elementthat'stoolong</li>
    <li>element</li>
    <li>element</li>
    <li>element</li>
    <li>element</li>
    <li>element</li>
    <li>element</li>
</ul>
```

[JSFiddle 示例](http://jsfiddle.net/3UeaY/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T20:43:37.880

我不认为有办法做到这一点，所以我回到我之前的解决方案，将结果分页到`<div>`s 中，然后将每个页面的大小设置为必要的宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T19:45:20.393

为防止文本溢出，请尝试：

```
li {
word-wrap: break-word;
} 
```

列宽不仅可以设置为像素，还可以设置为 % 和 em，允许更灵活的布局。为了防止内容完全折叠，您当然会设置一个最小宽度。根据[W3.org](http://www.w3.org/TR/css3-multicol/)，正常流中延伸到列间隙中的内容（例如，长字或图像）被剪裁在列间隙的中间。

# javascript - 动态加载 js 模块并提供对内部功能的即时访问

> ID：11835914
> 
> 赞同：1
> 
> 时间：2012-08-06T21:05:25.537
> 
> 标签：javascript, jquery, module

我想使用 $.getScript 为 javascript 文件创建一个模块加载器，但是由于脚本的加载是异步的，因此当我将模块的函数调用放入文档中时，它们可能会在模块加载之前被调用。有什么方法可以避免这种情况，可能是通过暂停函数调用直到模块成功加载？

框架.core.js：

```
var Framework = $.extend(Framework, Framework.Core = { 
    modules: [ 
        'Module1', 
        'Module2'
    ], 
    init: function () { 
        $.each(modules, function (index, value) {  
            $.getScript('framework.' + value.toLowerCase() + '.js', function () { 
            }); 
        }); 
    }   

}); 
Framework.Core.init(); 
```

网站.html：

```
<html>
    <head>
        <script src="framework.core.js"></script>
        <script>Framework.Module1.functionCall();</script>  // Call a function independent of the completion of the framework.core.js loader
    </head>
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:42:41.607

您将需要打开依赖函数的成功回调以挂钩它。您将无法推迟执行以下函数以等待模块（除非您将通过 插入脚本`document.write`），因此回调是必要的。最好，只需将`Deferred`对象（由 ajax 函数返回）公开。此外，您根本不应该使用[`jQuery.getScript/`](http://api.jquery.com/jQuery.getScript/)该任务，因为它会阻止缓存。

```
var Framework = $.extend(Framework, Framework.Core = {
// The "Core" property seems pretty useless, by the way ^^
    modules: [ 
        'Module1', 
        'Module2'
    ],
    loads: {},
    init: function () { 
        $.each(this.modules, function(index, value) {  
            this.loads[value] = $.ajax({
                url: 'framework.' + value.toLowerCase() + '.js',
                cache:true,
                dataType:"script"
            }); 
        }); 
    }   

}); 
Framework.init(); 
```

```
<html>
    <head>
        <script src="framework.core.js"></script>
        <script>Framework.loads.Module1.then(function() {
            functionCall();
        }); // Call a function as soon as the module is loaded
        </script>
    </head>
... 
```

# scala - 使用 Scala 中的简单表达式链接日志记录

> ID：11835922
> 
> 赞同：3
> 
> 时间：2012-08-06T21:05:42.480
> 
> 标签：scala, logging, slf4j

我通常通过 LiftWeb 中的 Loggable 包装器将 Scala 与 SLF4J 一起使用。*除了仅由1 个表达式链*组成的非常常见的方法外，这非常有效。

因此，如果您想将日志记录添加到这样的方法中，那么简单漂亮，没有花括号

```
def method1():Z = a.doX(x).doY(y).doZ() 
```

必须变成：

```
def method1():Z = {
  val v = a.doX(x).doY(y).doZ()
  logger.info("the value is %s".format(v))
  v
} 
```

不太一样，是吗？我试着用这个来解决它：

```
class ChainableLoggable[T](val v:T){
  def logInfo(logger:Logger, msg:String, other:Any*):T = {
    logger.info(msg.format(v, other))
    v
  }
}
implicit def anyToChainableLogger[T](v:T):ChainableLoggable[T] = new ChainableLoggable(v) 
```

现在我可以使用更简单的形式

```
 def method1():Z = a.doX(x).doY(y).doZ() logInfo(logger, "the value is %s") 
```

然而 1 个额外的对象实例化和 Any 的隐式实例化开始看起来像代码臭。

有谁知道更好的解决方案？或者也许我什至不应该为此烦恼？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T08:11:39.770

Scala 2.10 为您提供了一个解决方案 - 这是一个新功能[Value Class](http://docs.scala-lang.org/sips/pending/value-classes.html)，它允许您获得与隐式包装器提供的相同的效果，但不会因这些包装器类的实例化而产生开销。要应用它，您必须像这样重写代码：

```
implicit class ChainableLoggable[T](val v : T) extends AnyVal {
  def logInfo(logger:Logger, msg:String, other:Any*) : T = {
    logger.info(msg.format(v, other))
    v
  }
} 
```

在引擎盖下，编译器将通过将您添加到它的参数列表并相应地更新其用法，将其转换`logInfo`为 Java 常见的“util”静态方法的类似物- 看，没有任何东西被实例化。`v : T`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T21:29:04.387

这看起来是正确的方法，特别是如果你没有隐含的水龙头（不在标准库中，但这样的东西被相当广泛地使用——并且`tap`在 Ruby 中是标准的）：

```
class TapAnything[A](a: A) {
  def tap(f: A => Any): A = { f(a); a }
}
implicit def anything_can_be_tapped[A](a: A) = new TapAnything(a) 
```

有了这个，隐藏信息本身就不太重要了，但是如果你使用它，它是一个改进

```
.tap(v => logger.info("the value is %s".format(v))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-06T21:41:49.360

如果你想避免使用隐式，你可以在你自己的日志特性中定义像这样的函数。虽然可能不如隐含的解决方案漂亮。

```
def info[A](a:A)(message:A=>String) = {
  logger.info(message(a))
  a
}

info(a.doX(x).doY(y).doZ())("the value is " + _) 
```

# javascript - 从css中的列表中更改活动选择

> ID：11835923
> 
> 赞同：0
> 
> 时间：2012-08-06T21:05:42.400
> 
> 标签：javascript, jquery, html, css

我有一个小问题，我在这个页面上包含了子菜单：http: [//www.shadowopsweaponry.com/default.aspx](http://www.shadowopsweaponry.com/default.aspx)。

在左侧有“枪械制造”类别，如果您单击该链接，则会在该链接下方弹出一个新的子菜单。

还有另外两个子菜单“枪支涂层”和“枪支训练”，它们的作用相同，即使您在此之后单击其他主链接，它们也会保持突出显示。当我单击某些子菜单链接时，我希望突出显示该选择，而不是我之前选择的那个，我该如何实现？

**编辑：**添加 CSS。

```
.arrowsidemenu {
    width: 180px; /*width of menu*/
    background: #212121;
}

.menucontents div.selected a { /*header that's currently selected*/
    color: #f93;
}

.arrowsidemenu .menuheaders a { }

.arrowsidemenu div a { /*header bar links*/
    font-size: 12px;
    display: block;
    padding-left: 10px;
    padding-top: 4px;
    text-decoration: none;
}

.arrowsidemenu div a:link, .arrowsidemenu div a:visited {
    color: #fff;
}

.arrowsidemenu div a:hover { }

.arrowsidemenu div.unselected a { /*header that's currently not selected*/
    color: #fff;
}

.arrowsidemenu div.selected a { /*header that's currently selected*/
    color: #f93;
}

.arrowsidemenu ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
    background-color: inherit;
}

.arrowsidemenu ul li {
    line-height: 8px;
    padding-left: 12px;
}

.arrowsidemenu ul li a { /*sub menu links*/
    display: block;
    font-size: 12px;
    text-decoration: none;
    color: #FFF;
    padding: 5px 0;
    padding-left: 10px;
}

.arrowsidemenu ul li a:hover { }

.active-sub-menu {
    color: #f93;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T22:09:02.583

您的名为“selected”的类被放置在 div > a href 上。你需要那个类来代替 ul > li> a href。这是您的 .aspx 中的问题，而不是真正的 css 中的问题。

如果您修复了 html，则需要更改此行：

```
.arrowsidemenu div.selected a {
  color: #FF9933;
 } 
```

那时，您可能可以只使用 .selected 来代替。

您可以通过使用 Firebug（Firefox 的插件）更轻松地查看这些内容。如果您得到它，您可以右键单击一个项目以查看应用了哪些样式。

# timezone - 服务器时间与服务器上的浏览器时间不匹配

> ID：11835926
> 
> 赞同：0
> 
> 时间：2012-08-06T21:06:04.487
> 
> 标签：timezone, windows-server-2008

我有一个第三方托管服务提供商的应用程序服务器（Windows 2008 R2 64 位）
他们说我的服务器位置是加利福尼亚

当我远程访问我的服务器时，我的服务器时区设置为中央时间。

如果我在我的服务器上打开谷歌并搜索“当前时间”，它会显示华盛顿特区并给出东部时间。

1.  我怎样才能准确地确定我的服务器的物理位置？
2.  这可能是服务器机器时间和服务器浏览器时间不同吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T13:16:11.867

您可以通过 IP 进行查找/地理定位来获得一个大致的概念。试试这个： http: [//www.maxmind.com/](http://www.maxmind.com/)。登录到您的服务器并获取它的 IP 地址。不是本地的，尝试通过访问 whatismyip.com 获取它的外向 IP，并使用 Maxmind 大致了解它的位置。

# facebook - 在不透露用户 ID 的情况下显示 Facebook 个人资料图片

> ID：11835927
> 
> 赞同：1
> 
> 时间：2012-08-06T21:06:11.897
> 
> 标签：facebook, facebook-graph-api

我正在构建一个 Facebook 应用程序，它可以让其他人提交故事，如果他们将这个故事发布给“所有人”，那么任何人，甚至不是他们朋友的人，都可以看到这个故事。我想将用户的个人资料图片添加到故事中。我知道您可以通过以下方式访问：

```
https://graph.facebook.com/<userId>/picture 
```

但是，我**不想**以这种方式公开用户的 userId。有人可能只是查看源代码，在 src URL 中查看他们的 userId，然后该人的隐私就被泄露了。

我想隐藏 userId，这样就不可能发生这种类型的隐私**泄露**。

有没有办法做到这一点，或者是我为用户保存非个人资料图像的唯一选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:42:41.267

假设他们有一套并且不只是使用标准轮廓，它们将始终是从他们的个人资料图片中识别用户的一种方式。UID 是构成我们的个人资料图片 CDN url 的字符串的一部分，因此没有什么是 100% 万无一失的。

您最好的做法可能是查询 Facebook API 并在渲染之前直接从那里存储 CDN URL - 例如，对我来说，查询

`https://graph.facebook.com/260300016?fields=picture`将返回我当前个人资料图片的 URL -`https://fbcdn-profile-a.akamaihd.net/hprofile-ak-snc4/203337_260300016_1473273891_q.jpg`

# azure - Windows Azure，MSDN 提供，750 个小型计算小时

> ID：11835928
> 
> 赞同：2
> 
> 时间：2012-08-06T21:06:16.263
> 
> 标签：azure

我是 msdn 订阅者，我正在将 Azure 视为新网站的可能平台，该新网站将测试新服务的水。该网站在发布时预计流量会很低到非常低。我听说这种流量级别对于 Azure 来说非常昂贵，但是因为他们有这个 msdn 报价，所以我想我终于可以看看 Azure。

在报价中，我希望获得“每月 750 个小型计算小时”。从我所做的阅读来看，这似乎是，如果我只购买给定的东西（尽管订阅本身当然是数千美元），那么整个月将被覆盖。因为`24 (hours) x 31 (max days in a month) = 744`我仍然低于我本月分配的 750。

我是否从这个简单的方程式中遗漏了其他东西？是否还有其他可能导致网站暂时“关闭”的方面需要考虑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:17:16.733

是的，您确实可以在整个月内运行一个小实例。或者您可以使用 2 个超小型实例（拥有 2 个实例意味着您在 SLA 范围内）。

您还需要考虑其他 2 件事：

*   根据您的订阅，您最多可以拥有 45GB 的存储空间（blob/table/queue）。如果您使用虚拟机，您需要知道系统磁盘（和其他数据磁盘）作为 blob 持久保存，因此请确保不要达到此处的限制。
*   还有[其他限制](http://www.windowsazure.com/en-us/pricing/member-offers/msdn-benefits/)活动，但除了存储之外最重要的是数据传输限制，它也非常有限（最大 35GB 输出）。

如果您期望流量非常低，您是否考虑过 Windows Azure 网站？您可以在 12 个月内免费获得其中的 10 个。免费的在共享实例上运行，但它们非常适合托管您的应用的第一个低流量版本。

# ruby - “和朋友一起”脸书贴子墙

> ID：11835933
> 
> 赞同：-1
> 
> 时间：2012-08-06T21:06:30.390
> 
> 标签：ruby, facebook, koala

我想知道是否可以在墙上发帖并添加一些朋友。
我有一张照片，我必须上传并标记用户的朋友。

这是我在 Ruby 中使用 Koala gem 上传照片的方法：

```
@graph.put_picture(@photo.image.path, 'image/png', { 
    :message => "Hello" 
}) 
```

这将上传照片并在墙上张贴给出的消息。
我必须展示一张图片并标记朋友，所以我可以在墙上发帖或上传图片。

PS：它不需要在 Ruby 中，也不需要使用 Koala gem。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:24:12.377

尝试这个：

```
tags = {{:to => user_id, :tag_text => "tag text test", :x => x_coordinate, :y => y_coordinate},{#another tag...}}

@graph.put_picture(@photo.image.path, 'image/png', { 
    :message => "Hello" 
    :tags => tags
}) 
```

`user_id`您要标记的用户的 ID 在哪里`x_coordinate`，标记应位于图片中的 x 轴坐标，并且`y_coordinate`与 y 轴相同。

# gtk - 从 pthread 更新 gtk_tree_view

> ID：11835935
> 
> 赞同：1
> 
> 时间：2012-08-06T21:06:45.217
> 
> 标签：gtk, gtktreeview

**在我从使用pthreads**创建的后台线程更新绑定的**GtkListStore**后，我一直试图找出一些方法来导致**GtkTreeView**重绘。

 ****通常，小部件不会更新，直到有东西遮住了现有行（甚至是鼠标光标）。

我对这个问题的大部分搜索都有“你的树模型没有/没有生成正确的信号”......

我正在运行带有 gtk+ 2.0.0 的旧 Red Hat 9，用于工业嵌入式应用程序。大多数数据来自 ipc/socket/pipes 并由 GTK 应用程序显示。不幸的是，CRITICAL 警报也是如此，它习惯于不显示何时应该显示。我们将（有一天）迁移到当前的内核，但我需要使用现有的软件。

我尝试发出*“行更改”*信号，尝试调用**gtk_widget_queue_draw**并尝试连接到*“expose-event”*，在那里我尝试了各种不起作用或段错误的事情。

## 服务器.c

```
bool Server::Start()
{
 // .... 
 // pthread_t _id;
 //
 pthread_create( & _id, NULL, &StaticServerThread, this );
 // ....
} 
```

## 查看器.c

```
bool Viewer::ReadFinished( SocketArgs * args )
{
 gdk_threads_enter();

 // Populate the buffer and message
 //
 // GtkListStore *_outputStore;
 // gchar        *buffer;
 // gchar        *message;

 GtkTreeIter iter;
 gtk_list_store_insert_with_values( _outputStore, &iter, 0, 
                    0, buffer, 1, message, -1 );

 // ....
 gdk_threads_leave();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:28:28.577

您可以在主线程中对列表存储执行更新。例如，您可以在工作线程中使用 g_idle_add()。****

# iframe - 嵌入 Google 群组 - 未登录 Google 时不显示任何内容

> ID：11835937
> 
> 赞同：1
> 
> 时间：2012-08-06T21:06:56.370
> 
> 标签：iframe, google-groups, google-groups-api

我正在尝试使用为组提供的嵌入代码将 Google Groups 论坛嵌入到页面中。当我登录谷歌时它工作正常，但如果我没有，嵌入代码（创建 iframe）会引发以下错误（在 Chrome 中）：

> 拒绝显示文档，因为 X-Frame-Options 禁止显示

结果是 iframe 不显示任何内容。有解决方法吗？我的猜测是问题出在谷歌的尽头。页面在这里（如果你能看到论坛，请确保你没有登录谷歌）：

[www.jqcoolgallery.com/support.html](http://www.jqcoolgallery.com/support.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T21:06:21.703

在 Chrome 隐身模式下为我工作（没有用户登录）。我看到空组。

抱歉，刚刚看到您也在使用 Chrome。您是否在新的隐身会话中尝试过？

# javascript - 这个 .join(this) 如何在 javascript 中工作？

> ID：11835941
> 
> 赞同：1
> 
> 时间：2012-08-06T21:07:15.327
> 
> 标签：javascript, arrays

在这种情况下说：

```
String.prototype.times = function(count) {
    return count < 1 ? '' : new Array(count + 1).join(this);
}

"hello!".times(3); //"hello!hello!hello!";
"please...".times(6); //"please...please...please...please...please...please..." 
```

它如何添加到新语句 3 次？我在理解 return 语句时也有些困惑。如果我理解正确，请告诉我：

```
(if count < 1){
    return ''
} else {
    return new Array(count + 1).join(this) //This I don't understand. 
```

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-06T21:09:18.387

它创建了一个给定长度的新数组，比如 7。然后将所有这些空项与一个字符串连接起来，最终重复该字符串 6 次。

一般：

```
[1,2,3].join("|") === "1|2|3" 
```

然后使用长度为 4 的数组：

```
new Array(4).join("|") === "|||" 
```

`this`在方法内部是`String.prototype`指作为方法调用该函数的字符串对象：

```
 "hello".bold(); //this would refer to a string object containing "hello" inside bold() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-06T21:10:50.200

`this`，在这种情况下，指的是受到影响的字符串。所以如果我打电话`"hello".times(5)`，那么`this`会参考`"hello"`。

该函数通过创建一个包含`count+1`元素的数组来工作，有效地`count`在它们之间制造“间隙”。然后将这些碎片与`this`绳子粘在一起，从而`this`重复`count`多次。

当然，如果它被告知重复少于一次，结果是空的。检查是为了避免无效数组大小的`count < 1`错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T21:12:27.097

`.join()`将连接数组的单元格，产生一个字符串。例如：

```
var arr = [ 'one', 'two', 'three' ];

var str = arr.join(', ');

// str is now "one, two, three" 
```

因此，在您的`times`功能中，您是在说`new Array(count + 1)`. 所以，如果`count`是 3，你实际上是在创建一个由 4 个单元格组成的*空*数组。然后，您将这些*空*单元格与`this`（即字符串）连接起来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-06T21:12:00.650

此方法创建一个给定长度加 1 的新数组。例如：

```
"hello".times(3); 
```

将创建以下数组：

```
[undefined × 4] 
```

然后将这些数组元素中的每一个与 连接在一起`.join("hello")`。这基本上转化为：

```
"" /* undefined array element */ + "hello" /* join string */ + "" + "hello" ... 
```

* * *

是的，您似乎正在理解三元运算符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-22T16:11:57.620

```
String.prototype.repeat = function(times) {
    return new Array(times+1).join(this);    
}

"go ".repeat(3) + "Giants!"; //"go go go Giants!" 
```

重点是 separator 参数，而基本数组仅包含未定义的成员值。上面的例子可以用手写体重写为：

```
[undefined,undefined,undefined,undefined].join("go ") + "Giants!"; 
```

使用 Join 运算符，每个数组成员在连接之前都会转换为字符串（在本例中为空字符串）。

来源：[https ://javascriptweblog.wordpress.com/2010/11/08/javascripts-dream-team-in-praise-of-split-and-join/](https://javascriptweblog.wordpress.com/2010/11/08/javascripts-dream-team-in-praise-of-split-and-join/)

# mongodb - 什么将 MongoDb 映射到内存中

> ID：11835942
> 
> 赞同：-1
> 
> 时间：2012-08-06T21:07:16.483
> 
> 标签：mongodb

MongoDb 是否`mmap`在启动时将所有内容（即所有数据文件 + 所有索引）都放入内存？

如果数据库有 100GB 而机器只有 4GB RAM，MongoDb 将整个数据库映射到内存中，对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:17:42.907

MongoDB 对所有数据使用内存映射文件。请参阅以下文档以了解其工作原理：

[http://docs.mongodb.org/manual/faq/storage/#what-are-memory-mapped-files](http://docs.mongodb.org/manual/faq/storage/#what-are-memory-mapped-files)

[http://www.mongodb.org/display/DOCS/Checking+Server+Memory+Usage](http://www.mongodb.org/display/DOCS/Checking+Server+Memory+Usage)

[http://www.mongodb.org/display/DOCS/Starting+and+Stopping+Mongo#StartingandStoppingMongo-MemoryUsage](http://www.mongodb.org/display/DOCS/Starting+and+Stopping+Mongo#StartingandStoppingMongo-MemoryUsage)

[http://www.mongodb.org/display/DOCS/Caching](http://www.mongodb.org/display/DOCS/Caching)

# javascript - Url.Action 正在生成非跨浏览器友好的 url

> ID：11835944
> 
> 赞同：0
> 
> 时间：2012-08-06T21:07:38.687
> 
> 标签：javascript, asp.net-mvc-3

URl.Action 正在以适用于 IE8 的方式生成查询字符串，但在传递日期时不适用于 Chrome。

这是我们的代码。

```
function RunReport( PdfOrExcel) 
{

 var ChartType = "Pdf";
 var argCounter = 0;
 linkUrl = '@Url.Action("ClassAssignmentLoadSummaryReport", "ReportsScheduling", new { PdfOrExcel="[1]", RptDate="[2]" } )';

 var objToSend = new Object();
 value = $('#RptDate').val()

 dataToSend.RptDate =value;

 linkUrl = linkUrl.replace("%5B1%5D", PdfOrExcel);
 linkUrl = linkUrl.replace("%5B2%5D", value );

 w = window.open(linkurl);
 w.focus();

} 
```

（这有点难看，因为我们展开了几个函数来获取上面的代码）

它会生成一个这样的 url：

```
/appName/ReportsScheduling/ClassAssignmentLoadSummaryReport?PdfOrExcel=Pdf&amp;RptDate=8/6/2012 
```

如果我们像这样更改它，它在 Chrome 中就可以正常工作。

```
/appName/ReportsScheduling/ClassAssignmentLoadSummaryReport?PdfOrExcel=Pdf&RptDate=8/6/2012 
```

我假设我们正在做一些愚蠢的事情，并且因此而以这种方式生成它，但我无法弄清楚我们做错了什么。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:20:09.567

看起来您的字符串正在被编码。尝试使用 @Html.Raw() 包装 Url.Action() 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:25:36.810

如果它真的变得那么混乱..

为什么不直接使用..

```
var href = "/ReportsScheduling/ClassAssignmentLoadSummaryReport?PdfOrExcel=blah&RptDate=blahDate" 
```

# web-scraping - 仅抓取文章/内容

> ID：11835947
> 
> 赞同：0
> 
> 时间：2012-08-06T21:07:57.427
> 
> 标签：web-scraping, web-crawler

我希望爬虫能够识别例如新闻网站上的哪些页面是实际内容（即文章），而不是关于、联系人、类别列表等。

到目前为止，我还没有找到优雅的方法，因为内容的标准似乎因站点而异（没有通用的标签/布局/协议等）。任何人都可以将我引导到可以在一定程度上确定网站是否是一段内容的库或方法吗？在我爬取候选页面之后进行这种区分是完全可以接受的。

除非已经存在任何东西，否则我也很欣赏该领域现有/正在进行的研究的任何起点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T09:40:02.893

您可以从检查[Boilerpipe 框架](http://code.google.com/p/boilerpipe/)开始。他们的项目页面上有在线提取演示。如果提取结果对您的情况不是很好，您需要扩展他们的算法。

# git - Git 樱桃挑选与变基

> ID：11835948
> 
> 赞同：148
> 
> 时间：2012-08-06T21:07:58.493
> 
> 标签：git, version-control

我最近开始使用 Git。

[在线浏览Git 书籍](http://git-scm.com/book)，我在“Git Rebase ”部分下找到了以下内容：

> 使用 rebase 命令，您可以获取在一个分支上提交的所有更改并在另一个分支上重放它们。

（引自： http: [//git-scm.com/book/en/Git-Branching-Rebasing](http://git-scm.com/book/en/Git-Branching-Rebasing)）

我认为这是 git *cherry-pick*的确切定义（在当前签出的分支上重新应用提交或一组提交对象）。

两者有什么区别 ？

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2012-08-07T00:08:03.540

自从`git cherry-pick`学会了能够应用多个提交以来，这种区别确实变得有些没有意义，但这就是所谓的趋同进化;-)

真正的区别在于创建这两种工具的初衷：

*   `git rebase`的任务是将开发人员在其私有存储库中针对某个上游分支的版本 X 创建的一系列更改转发到同一分支的版本 Y (Y > X)。这有效地*改变了*该系列提交的基础，因此“变基”。

    （它还允许开发人员将一系列提交移植到任意提交上，但这不太明显。）

*   `git cherry-pick`是为了将一个有趣的提交从一个开发线带到另一个开发线。一个典型的例子是将在不稳定的开发分支上进行的安全修复反向移植到稳定（维护）分支，这`merge`没有任何意义，因为它会带来大量不需要的更改。

    自从它第一次出现以来，`git cherry-pick`已经能够一次一个地选择多个提交。

因此，这两个命令之间最显着的区别可能是它们如何处理它们工作的分支：通常*从其他地方*`git cherry-pick`带来一个提交并将其应用到您当前分支的顶部，记录一个*新*提交，同时获取您当前的分支并*重写*一系列*自己的*提示以一种或另一种方式提交。是的，这是对可以做什么的严重简化的描述，但它是故意的，试图让总体思路深入人心。**`git rebase`**`git rebase`****

 *****更新**`git rebase`以进一步解释正在讨论的使用示例。

鉴于这种情况，
![rebase 之前的 repo 状态](../Images/648b9f5f053efd6bc9d5e75bc443630d.png)
[The Book](https://git-scm.com/book)指出：

> 但是，还有另一种方法：您可以获取 C3 中引入的更改补丁，并将其重新应用到 C4 之上。在 Git 中，这称为变基。使用 rebase 命令，您可以将在一个分支上提交的所有更改应用到另一个分支上。
> 
> 在此示例中，您将运行以下命令：
> 
> ```
> $ git checkout experiment
> $ git rebase master
> First, rewinding head to replay your work on top of it...
> Applying: added staged command 
> ```

这里的“问题”是，在这个例子中，“实验”分支（变基的主题）最初是从“主”分支分支出来的，因此它与它*共享*C0 到 C2 提交——实际上，“实验”是“ master" 直到并包括 C2 加上在它上面提交 C3。（这是最简单的情况；当然，“实验”可以在其原始基础之上包含几十个提交。）

现在`git rebase`被告知将“实验”重新定位到“大师”的*当前*`git rebase`提示，并如下所示：

1.  运行`git merge-base`以查看“实验”和“大师”共享的最后一次提交是什么（换句话说，转移的意义是什么）。这是C2。
2.  保存自转移点以来所做的所有提交；在我们的玩具示例中，它只是 C3。
3.  倒回 HEAD（在操作开始运行之前指向“experiment”的提示提交）以指向“master”的提示 - 我们正在重新定位它。
4.  尝试按顺序应用每个保存的提交（就像使用`git apply`）。在我们的玩具示例中，它只是一个提交，C3。假设它的应用程序将产生一个提交 C3'。
5.  如果一切顺利，“实验”引用将更新为指向应用上次保存的提交（在我们的例子中为 C3'）所产生的提交。

现在回到你的问题。如您所见，这里*从技术上* `git rebase`确实将一系列提交从“实验”移植到“大师”的尖端，因此您可以正确地判断出该过程中确实存在“另一个分支”。但要点是“实验”中的提示提交最终成为“实验”中的新提示提交，它只是改变了它的基础：
![合并后的状态](../Images/180bb720e7f9351f6d313dca58fa86bd.png)

同样，从技术上讲，您可以看出`git rebase`这里包含了来自“master”的某些提交，这是绝对正确的。

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2012-12-28T16:43:08.573

使用cherry-pick，原始提交/分支会保留并创建新提交。使用 rebase，整个分支将移动，分支指向重放的提交。

假设您从以下内容开始：

```
 A---B---C topic
     /
D---E---F---G master 
```

**变基：**

```
$ git rebase master topic 
```

你得到：

```
 A'--B'--C' topic
             /
D---E---F---G master 
```

**樱桃采摘：**

```
$ git checkout master -b topic_new
$ git cherry-pick A^..C 
```

你得到：

```
 A---B---C topic
     /
D---E---F---G master
             \
              A'--B'--C' topic_new 
```

有关 git 的更多信息，这本书有大部分内容[（http://git-scm.com/book）](http://git-scm.com/book)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-08-06T21:18:51.183

Cherry-picking 适用于*个人提交*。

当你做 rebase 时，它​​会将历史记录中的*所有提交*应用到那里缺少的分支的 HEAD。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-03-30T10:12:16.233

一个简短的回答：

*   git cherry-pick 更“低级”
*   因此，它可以模拟 git rebase

上面给出的答案很好，我只是想举一个例子来证明它们的相互关系。

*不建议用这一系列操作替换“git rebase”，它只是“概念证明”，我希望它有助于理解事情是如何工作的。*

给定以下玩具存储库：

```
$ git log --graph --decorate --all --oneline
* 558be99 (test_branch_1) Test commit #7
* 21883bb Test commit #6
| * 7254931 (HEAD -> master) Test commit #5
| * 79fd6cb Test commit #4
| * 48c9b78 Test commit #3
| * da8a50f Test commit #2
|/
* f2fa606 Test commit #1 
```

比如说，我们在 master 中有一些非常重要的更改（提交 #2 到 #5），我们希望将其包含到我们的 test_branch_1 中。通常我们只是切换到一个分支并执行“git rebase master”。但是因为我们假装我们只配备了“git cherry-pick”，所以我们这样做：

```
$ git checkout 7254931                # Switch to master (7254931 <-- master <-- HEAD)
$ git cherry-pick 21883bb^..558be99   # Apply a range of commits (first commit is included, hence "^") 
```

在所有这些操作之后，我们的提交图将如下所示：

```
* dd0d3b4 (HEAD) Test commit #7
* 8ccc132 Test commit #6
* 7254931 (master) Test commit #5
* 79fd6cb Test commit #4
* 48c9b78 Test commit #3
* da8a50f Test commit #2
| * 558be99 (test_branch_1) Test commit #7
| * 21883bb Test commit #6
|/
* f2fa606 Test commit #1 
```

正如我们所看到的，提交 #6 和 #7 应用于 7254931（master 的提示提交）。HEAD 被移动并指向一个提交，它本质上是一个重新定位的分支的尖端。现在我们需要做的就是删除一个旧的分支指针并创建一个新的：

```
$ git branch -D test_branch_1
$ git checkout -b test_branch_1 dd0d3b4 
```

**test_branch_1**现在植根于最新的主位置。完毕！

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-11-19T18:55:41.167

它们都是用于在另一个之上重写一个分支的提交的命令：区别在于哪个分支 - “你的”（当前签出的`HEAD`）或“他们的”（作为参数传递给命令的分支） - 是此重写的*基础*。

**`git rebase`**接受*开始提交*并将***您的*****提交重播为在*他们*****的提交之后（开始提交）。**

 ****`git cherry-pick`**接受一*组提交*并在***你***的（你的）之后**重播*他们的*提交***`HEAD`。*

 *换句话说，这两个命令的核心行为（忽略它们不同的性能特征、调用约定和增强选项）是*对称*的：check out branch `bar`and running`git rebase foo`将分支设置为与 check out branch and running设置`bar`相同的历史记录到（从 的变化，然后是从 的变化）。`foo``git cherry-pick ..bar``foo``foo``bar`

命名方面，可以记住这两个命令之间的区别，因为每个命令都描述了它对*当前*分支的作用：`rebase`使另一个头部成为您更改的*新基础*`cherry-pick`，而从另一个分支中挑选更改并将它们*放在顶部你的`HEAD`*（就像圣代上的樱桃）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-08-19T13:57:30.850

两者都做非常相似的事情。主要的概念区别是（简而言之）：

*   **rebase**将提交从*当前分支*移动到*另一个分支*。

*   **cherry-pick**将提交从*另一个分支*复制到*当前分支*。

使用类似于[@Kenny Ho 的答案的](https://stackoverflow.com/a/14072763/266309)图表：

给定这个初始状态：

```
A---B---C---D master
     \
      E---F---G topic 
```

...并假设您希望从当前`topic`分支上重放分支的提交`master`，您有两个选择：

1.  **使用变基：**您首先`topic`通过做去`git checkout topic`，然后通过运行移动分支`git rebase master`，产生：

    ```
    A---B---C---D master
                 \
                  E'---F'---G' topic 
    ```

    *结果：*您当前的分支`topic`被重新定位（移动）到`master`. 分支已更新，而
    分支仍然存在。`topic``master`

2.  **使用cherry-pick**：您首先`master`通过doing去`git checkout master`，然后通过运行`git cherry-pick topic~3..topic`（或等效地，`git cherry-pick B..G`）复制分支，产生：

    ```
    A---B---C---D---E'---F'---G' master
         \
          E---F---G topic 
    ```

    *结果：*来自的提交`topic`被*复制*到`master`. 分支已更新，而
    分支仍然存在。`master``topic`

* * *

当然，在这里你必须*明确告诉cherry-pick 选择一个提交序列*，使用[范围表示法](https://git-scm.com/docs/git-rev-parse#_specifying_ranges) `foo..bar`。如果您只是简单地传递了分支名称，如在 中`git cherry-pick topic`，它只会拾取分支顶端的提交，结果是：

```
A---B---C---D---G' master
     \
      E---F---G topic 
```******

# c++ - 具有比 CPU 慢的快速 GPU 的 C++ AMP

> ID：11835956
> 
> 赞同：9
> 
> 时间：2012-08-06T21:08:21.330
> 
> 标签：c++, visual-c++, c++-amp

我刚刚开始学习 C++ AMP，并且已经获得了一些使用 VS 2012 RC 构建的示例，但我发现 GPU 的性能比 CPU 慢。例如，Kate Gregory 的例子：http: [//ampbook.codeplex.com/releases/view/90595](http://ampbook.codeplex.com/releases/view/90595)（与她即将出版的书有关[http://www.gregcons.com/cppamp/](http://www.gregcons.com/cppamp/)）。她在我观看的一次讲座中演示了它们，她通过使用笔记本电脑的 GPU（我相信她说它是 6650）与 CPU（不确定她有什么 CPU）相比，在第 4 章示例中获得了约 5 倍的性能提升。我试过自己测试这个例子，并在几个系统配置上（如下）我总是发现 CPU 更快。我还测试了其他示例并发现相同。难道我做错了什么？性能低于预期是否有原因？有没有人有一个肯定会显示GPU更快的例子？

*   系统 1：带有板载显卡的 Intel i7 2600K（我希望这会更慢）
*   系统 2：Intel i7 2630QM 与 Intel HD 可与 AMD 6770 切换（我让它在性能模式下运行，所以它应该使用 6770）
*   系统 3：Intel i5 750 和 2xCrossfire AMD HD 5850

结果示例：第 4 章项目结果为 1.15 毫秒 CPU、2.57 毫秒 GPU、2.55 毫秒 GPU 平铺。

**编辑**：

Doh，我想我刚刚找到了原因——她在讲座中使用的矩阵大小的值不同。网站上的示例使用 M=N=W=64。如果我像她在讲座中那样使用 64、512 和 256，那么我的性能会相应提高约 5 倍。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T11:34:46.333

似乎您的首要问题是为什么将事物转移到 GPU 并不总能为您带来好处。答案是复制时间。想象一个计算时间与 n 平方成正比。复制所花费的时间与 n 成正比。您可能需要相当大的 n 才能花时间在 GPU 之间进行复制，而不是在那里进行计算所节省的时间。

本书在前几章中简要提到了这一点，第 7 章和第 8 章都是关于性能和优化的。第 7 章现在是关于粗剪的；第 8 章应该很快就会出现。（它的代码已经在 Codeplex - Reduction 案例研究中。）

我刚刚签入了第 4 章代码的更新，它使用了 Tech Ed 的起始编号，而不是之前的编号。较小的矩阵在向/从 GPU 复制时损失了太多时间；较大的需要太长时间才能成为一个好的演示。但是请随意玩弄这些尺寸。让它们更大，因为你不介意一两分钟的“死气”，看看会发生什么。

# google-analytics - 本地页面的 Google Analytics（分析）

> ID：11835962
> 
> 赞同：4
> 
> 时间：2012-08-06T21:08:44.220
> 
> 标签：google-analytics, tracking

我正在制作一个网页，供用户使用 Internet Explorer 直接从他们的本地驱动器打开。我想在这些页面上使用 Google Analytics。

我在页面中添加了 Google Analytics 跟踪代码，但它似乎不起作用。

是否可以将 Google Analytics 用于本地页面？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T14:12:23.643

我根据[这篇文章](http://blog.jessitron.com/2012/05/testing-google-analytics-locally.html)测试了一些设置，它似乎工作正常。

很快，您需要设置一些东西。

**DomainName**是否设置应该是**none**。

```
_gaq.push(['_setDomainName', 'none']); 
```

另外将 google js url 从 ga.js 更改为：**u/ga_debug.js**

```
 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/u/ga_debug.js'; 
```

乍一看，谷歌分析似乎在这个网站（我的本地网站）上不起作用，这可能很有趣。半小时或一个小时后，它开始记录动作。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T09:30:21.373

本地页面无法使用谷歌分析工具。因为，如果您在页面中插入跟踪代码，Google Analytics（分析）会尝试连接并检查您域上的跟踪代码，但这是行不通的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T05:34:26.737

有一种方法可以做到，只需将您的网页/站点配置为 iis，然后您可以跟踪该站点/页面以查找“localhost / 127.0.0.1”

简而言之，您也可以为 localhost 创建 GA。您应该在上面冲浪

# iphone - 如何获得排序的实体及其属性？

> ID：11835963
> 
> 赞同：1
> 
> 时间：2012-08-06T21:08:45.177
> 
> 标签：iphone, ios, ipad, core-data

我有以下型号 ![在此处输入图像描述](../Images/8d442de2ea28249fb1913bd0c0798424.png) ![在此处输入图像描述](../Images/6f1d1bed3b764e5a8ff96e772a8d0ad5.png)

我可以使用 对`Category`实体进行排序`NSDescriptor`，但`children`属性（NSSet）未排序。我怎样才能`childrens`排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T22:09:22.437

对于每个获取的类别，您必须自己对子项进行排序。

```
NSArray *sortedChildren = [category.children sortedArrayUsingDescriptors:
   [NSArray arrayWithObject:
      [NSSortDescriptor sortDescriptorWithKey:@"name" ascending:YES]]]; 
```

*BTW：“child”的复数形式是“children”。*

# actionscript-3 - AS3 UILoader swf 继续在后台播放

> ID：11835966
> 
> 赞同：1
> 
> 时间：2012-08-06T21:09:04.193
> 
> 标签：actionscript-3, video, flash, uiloader

我有一个加载外部 SWF 文件的简单可扩展广告。外部 SWF 文件包含嵌入的视频。

使用 UILoader 组件，我已加载 SWF，将其添加到舞台，视频显示和播放正常。

主要问题是我有一个关闭按钮，它应该卸载视频并停止它，基本上返回到广告的默认状态。

要卸载 SWF，我正在执行以下操作：

```
myUILoader.unload();
removeChild(myUILoader); 
```

当我这样做时，视频和 UILoader 从屏幕上消失了。但是，您仍然可以听到背景中的声音，如果我再次加载 SWF，它会在背景中创建多个轨道。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T00:02:52.333

有几件事可能导致这种情况。一是你的 UILoader 内的内容正在向其自身外部添加事件侦听器。你可以通过不允许它接触任何外部的东西来解决这个问题。我相信您可以通过将其放置在自己的 ApplicationDomain、SecurityDomain 或两者中来做到这一点。有关更多详细信息，请参阅帮助。

如果这不可行，您可以尝试 SoundMixer.stopAll()，它会停止明显的症状，但不会修复您在这种情况下可能遇到的内存泄漏。

正如 Ronnie 所暗示的，另一种可能性是您仍然在某处引用了加载程序的内容。如果你不清除它，它将留在内存中。

但是，还有另一个问题也可能导致此问题，即如果电影中的导航跳过包含音频设置为“流”的 MovieClip 的帧，则将创建 MC 但未完全实例化，并将留在内存中，无法控制或释放它。从您的描述中，我认为这不是正在发生的事情。如果是，解决方法是确保您在前往另一帧的途中访问包含声音的帧，无论多么短暂。实际上，即使没有声音，您也可能需要考虑这一点，因为它确实会在您跳过嵌套的 MovieClip 中的帧时发生（除非您分析 swf，否则您没有证据），并且随着时间的推移，这将导致内存泄漏。

# php - 阻止用户使用 PHP 从 url 访问文件？

> ID：11835970
> 
> 赞同：0
> 
> 时间：2012-08-06T21:09:51.617
> 
> 标签：php, .htaccess

有没有办法阻止用户输入 url 并访问特定目录中的文件，但仍然允许 PHP 脚本访问该文件以更改或下载它？

换句话说，我想阻止人们输入：[http](http://www.mysite.com/securefolder/file1.pdf) ://www.mysite.com/securefolder/file1.pdf 。也许将它们重定向到不同的页面或其他东西。

但我不想完全锁定文件，因为我仍然需要使用 PHP 脚本来下载和修改文件。

任何帮助表示赞赏，谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:12:13.287

如果您想要的只是某个文件的特定设置，那么您只需要一个非常简单的规则 -

```
RewriteEngine on
RewriteRule ^/securefolder/file1.pdf$ access_denied.php 
```

更好的主意是为整个安全文件夹制定规则 -

```
RewriteEngine on
RewriteRule ^/securefolder/.*$ access_denied.php 
```

最后一种（可能也是最好的）方法是`.htaccess`在受保护的文件夹中创建一个附加文件夹，然后简单地拒绝对它的所有访问。放置这一行 -

```
deny from all 
```

在所有解决方案中，我们只讨论外部请求。您的所有脚本和脚本、文件等的内部路径将保持不变，不受您在`.htaccess`文件中定义的规则的影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T21:17:40.880

禁用对网络服务器上文件的直接访问，并从 PHP 脚本提供文件（本手册页上的一些提示：[http](http://www.php.net/manual/en/function.readfile.php) ://www.php.net/manual/en/function.readfile.php ）。Web 服务器访问限制不会影响 PHP，因为它直接访问文件系统。这是一个类似的问题：[Secure files for download](https://stackoverflow.com/questions/10834196/secure-files-for-download)

如果性能很关键，大多数网络服务器都有插件，可以帮助您直接提供文件（绕过 PHP）：

*   Apache [mod_auth_token](http://code.google.com/p/mod-auth-token/)
*   Lighttpd [mod_sec 下载](http://redmine.lighttpd.net/projects/lighttpd/wiki/Docs:ModSecDownload)
*   Nginx[安全下载](http://wiki.nginx.org/NginxHttpSecureDownload)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T21:12:34.880

理想的方法将取决于 PHP 脚本是在磁盘上本地访问 PDF 文件，还是通过 http 远程访问。

如果 PHP 脚本在本地访问磁盘上的文件，只需将文件放在网站的根文件夹之外。

如果 PHP 脚本通过 http 远程访问文件，这里有一些选项：

1.  通过源 IP 限制访问

2.  密码保护资源并通过 https 提供服务

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-06T21:13:22.213

如果文件位于同一台服务器上，则无需下载它们即可提供服务。只需从文件系统中读取它们并直接输出它们。

但是，如果它们不是，并且您需要一个脚本才能下载文件，而其他脚本被拒绝，您可以使用密码保护目录。

然后使用例如[cURL](http://dk.php.net/cURL)下载文件，您可以指定以下选项：

```
curl_setopt($ch, CURLOPT_USERPWD, "$username:$password");
curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_BASIC); 
```

### 更多信息

*   [使用 htaccess 保护您的页面的密码](http://www.elated.com/articles/password-protecting-your-pages-with-htaccess/)
*   [使用 PHP cURL 发送用户名和密码](http://www.electrictoolbox.com/php-curl-sending-username-password/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-06T21:12:40.960

将您的数据文件放在公共网络空间之外。使用 PHP 读取文件并提供服务。

除非您希望公开提供文件，否则源文件没有理由位于 Web 主机的 DocumentRoot 中。

PHP 脚本以本地用户身份运行，因此即使在 Apache（或其他）Web 服务器范围之外也能够读取文件。

# php - 继承和方法参数 PHP

> ID：11835973
> 
> 赞同：3
> 
> 时间：2012-08-06T21:09:55.893
> 
> 标签：php, oop, overriding

假设我有一个 PHP 类：

```
class MyClass {
   public function doSomething() {
     // do somthing
   }
} 
```

然后我扩展该类并覆盖该`doSomething`方法

```
class MyOtherClass extends MyClass {
   public function doSomething() {
     // do somthing
   }
} 
```

**问：更改、添加和删除方法参数是不好的做法吗？例如：**

```
class MyOtherClass extends MyClass {
   public function doSomething($newParam) {
     // do somthing
     // do something extra with $newParam
   }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T21:14:55.643

一般来说，是的，这是一个糟糕的设计。它打破了设计对多态性 OOP 原则的坚持（或至少削弱了它）......这意味着父接口的消费者将无法像对待您的子类的实例一样对待您的子类的实例父母。

最好的办法是创建一个新的语义命名方法（在这种情况下，语义意味着它传达了与原始方法相似的含义，并暗示了参数的用途），它要么调用原始方法，要么在您的覆盖实现中在原始方法中，使用合理的默认值调用您的新方法。

```
class MyOtherClass extends MyClass {
   public function doSomething() {
     return $this->doSomethingWithOptions(self::$soSomethingDefaultOptions);
   }

   public function doSomethingWithOptions($optsParam) {
     parent::doSomething();
     // ...
   }
} 
```

# c# - 使用 IValidatableObject 进行验证时获取成员属性

> ID：11835974
> 
> 赞同：0
> 
> 时间：2012-08-06T21:09:55.890
> 
> 标签：c#, asp.net-mvc-3

在以下场景中，我使用 IValidatableObject 来验证复杂对象。

```
public class Foo {
    [Required]
    public Bar Foobar { get; set; }
}

public class Bar : IValidatableObject {
    public int Id { get; set; }
    public string Name { get; set; }
    public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)  {
        // check if the current property instance is decorated with the Required attribute
        if(TheAboveConditionIsTrue) {
            // make sure the Name property is not null or empty
        }
    }
} 
```

我不知道这是否是最好的方法，如果不是，我很乐意对解决验证的其他方法发表评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:29:41.077

`Foo`为该实现创建一个抽象基类`IValidatableObject`并将其`Validate()`方法设为虚拟：

```
public abstract class FooBase : IValidatableObject
{
    public string OtherProperty { get; set; }

    public Bar Foobar { get; set; }
    public virtual IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
    {
        var results = new List<ValidationResult>();

        //Validate other properties here or return null
        if (String.IsNullOrEmpty(OtherProperty))
            results.Add(new ValidationResult("OtherProperty is required", new[] { "OtherProperty" }));

        return results;
    }
} 
```

现在将您的基类实现为`FooRequired`or `FooNotRequired`：

```
public class FooRequired : FooBase
{
    public override IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
    {
        var result = base.Validate(validationContext).ToList();
        result.AddRange(Foobar.Validate(validationContext));
        return result;
    }
}

public class FooNotRequired : FooBase
{
    //No need to override the base validate method.
} 
```

您的`Bar`课程仍然看起来像这样：

```
public class Bar : IValidatableObject
{
    public int Id { get; set; }
    public string Name { get; set; }

    public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
    {
        var results = new List<ValidationResult>();

        if (String.IsNullOrEmpty(Name))
            results.Add(new ValidationResult("Name is required", new[] { "Name" }));

        return results;
    }
} 
```

用法：

```
FooBase foo1 = new FooRequired();
foo1.Validate(...);

FooBase foo2 = new FooNotRequired();
foo2.Validate(...); 
```

# javascript - Javascript用数字排序对象字符串

> ID：11835976
> 
> 赞同：0
> 
> 时间：2012-08-06T21:10:01.153
> 
> 标签：javascript

我在 javascript 中有以下 JSON 对象：

```
var stuff = [{
"id": "20",
"serial": "0/0/19:46,0/0/149:63"
}, {
"id": "8",
"serial": "0/0/151:215,0/0/151:233"
}, {
"id": "54",
"serial": "0/0/151:26,0/0/151:37"
}, {
"id": "22",
"serial": "0/0/155:29,0/0/155:36"
}, {
"id": "4",
"serial": "0/0/151:48,0/0/151:152"
}]; 
```

我想知道如何通过“序列”字段对对象进行排序，让它像这样（考虑到序列字符串中整数的值）：

```
var stuff = [{
"id": "20",
"serial": "0/0/19:46,0/0/149:63"
}, {
"id": "54",
"serial": "0/0/151:26,0/0/151:37"
}, {
"id": "4",
"serial": "0/0/151:48,0/0/151:152"
}, {
"id": "8",
"serial": "0/0/151:215,0/0/151:233"
}, {
"id": "22",
"serial": "0/0/155:29,0/0/155:36"
}]; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:13:31.523

你有一个对象数组，你想按它们的一个属性对其进行排序。你可以很容易地这样做：

```
stuff.sort(function(a,b) {return a.serial == b.serial ? 0 : a.serial < b.serial ? -1 : 1;}); 
```

或者，您可以使用更通用的功能：

```
function sort(input,prop) {
    input.sort(function(a,b) {return a[prop] == b[prop] ? 0 : a[prop] < b[prop] ? -1 : 1;});
}
// call with:
sort(stuff,'serial'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T01:08:32.147

这将为您完成：

```
var normalizer = /[:\/]/g;

function serialCompare(a, b) {
    var alist = a.serial.replace(normalizer, ',').split(','),
       blist = b.serial.replace(normalizer, ',').split(','),
       i = 0, l = alist.length;
    while (alist[i] === blist[i] && i < l) {
        i += 1;
    };
    return (parseInt(alist[i], 10) - parseInt(blist[i], 10));
}

sortedstuff = stuff.sort(serialCompare);
// returns array sorted as you asked 
```

[在小提琴中看到它](http://jsfiddle.net/f6K6v/)。

如果您要经常排序，或者列表很长，您应该考虑创建存储在对象中的序列值的“规范化”版本。它可以是在 serialCompare 函数中计算的数组，也可以是用前导零填充到相同长度的文本编号部分。

# jquery - 隐藏div中的html输入类型按钮在隐藏（）显示（）切换时缩小

> ID：11835979
> 
> 赞同：1
> 
> 时间：2012-08-06T21:10:13.567
> 
> 标签：jquery, html

我有一个隐藏的表单，`<div>`当单击按钮时会显示该表单。隐藏的输入字段`<div>`包括按钮

当我第一次单击“添加”时，div 会按原样显示。我通过按取消关闭 div，然后重新单击“添加”，div 显示尺寸缩小的按钮。

检查jsfiddle：http: [//jsfiddle.net/uc3Ef/](http://jsfiddle.net/uc3Ef/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T21:13:32.710

这是因为您将`value`所有`input`元素的属性设置为空，并且该`value`属性用作按钮的标签文本。

改变这个：

```
$('.hiddenDiv').find('input').each(function(){
    $(this).val("");
}); 
```

到：

```
$('.hiddenDiv').find('input[type="text"]').each(function(){
     $(this).val("");
}); 
```

这是一个演示：http: [//jsfiddle.net/uc3Ef/1/](http://jsfiddle.net/uc3Ef/1/)

另外，你不需要在`.each()`这里使用，你可以这样做：

```
$('.hiddenDiv').find('input[type="text"]').val(""); 
```

这是有效的，因为`.val(STRING)`将设置所有选定元素的值。这是文档`.val()`：[http ://api.jquery.com/val](http://api.jquery.com/val)

这是一个演示：http: [//jsfiddle.net/uc3Ef/3/](http://jsfiddle.net/uc3Ef/3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T21:13:05.753

单击时您正在清除值`cancel`

```
$(this).val(""); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-06T21:14:00.947

它们正在“缩小”，因为您正在清除值（这是按钮显示的文本）。

从取消按钮单击事件中删除此行，然后重试:)

```
$(this).val(""); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-06T21:15:22.037

您正在将输入的值设置为`""`并且您的输入选择器选择按钮，您可以使用`input[type="text"]`，也不需要使用`each`方法，您可以使用：

```
 $('.hiddenDiv').find('input[type="text"]').val(""); 
```

jQuery`show()`方法等于`css('display', 'block')`，`show()`用于显示元素就足够了：

```
 $('.hiddenDiv').show(); 
```

[演示](http://jsfiddle.net/uc3Ef/5/)

# java - Box2D/AndEngine - 多个对象类的 ContactListener

> ID：11835981
> 
> 赞同：0
> 
> 时间：2012-08-06T21:10:19.793
> 
> 标签：java, android, box2d, andengine

我正在用 Java 开发一个小 Android 游戏，将 AndEngine 用于图形，将 Box2D 用于物理——特别是碰撞处理。我在类中有一些不同类型的带有构造函数的对象，如下所示：

```
MainActivity.java
Enemy.java
Npc.java
Door.java 
```

我在主类中有一个静态的 PhysicsWorld，我正在从 Enemy 类中设置一个 ContactListener，以定义当一个敌人击中某物时会发生什么。然而，当我发现每个 PhysicsWorld 只有一个 ContactListener 时，我尝试为 Door 类设置另一个 ContactListener。

本质上，我的问题是：解决这个问题的最佳方法是什么？

我知道我可能已经解释得很糟糕，所以我很抱歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T22:30:35.197

你可以用你的单身`ContactListener`来管理整个世界；`Contact.getFixtureA/B()`将返回联系中涉及的灯具。您可以利用`Fixture.getBody()`获取`Body`与每个碰撞夹具的关联；例如，如果您的`Door`和`Enemy`对象`Body`作为用户数据与 s 相关联，那么您可以使用它`Body.getUserData()`来检索它。

# php - PHP密码保护表单需要输入两次密码才能工作

> ID：11835982
> 
> 赞同：0
> 
> 时间：2012-08-06T21:10:31.140
> 
> 标签：php, setcookie, crypt

我正在尝试制作一个受密码保护的网站。密码目前只是硬编码，以便我更容易测试。

我遇到的问题是，当我输入实际密码时，cookie 似乎没有设置。如果我第二次重新输入密码，那么 cookie 就会被设置。

我知道问题在于我调用代码的顺序，但我很难确定我应该更改什么以使其在第一个正确的密码输入时正确运行。任何帮助，将不胜感激。

```
 case 'Maintenance':

$salt = "test";
$adminpass = "adminpass";
$RealPassword = crypt($adminpass, $salt);

function LoginScreen($SaltCode){
?>

    <html>
<head>
  <title>Please enter password to access this page</title>
  <META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">
  <META HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE">
</head>
<body>
  <style>
    input { border: 1px solid black; }
  </style>
  <div style="width:500px; margin-left:auto; margin-right:auto; text-align:center">
  <form method="post">
    <h3>Please enter password to access this page</h3>
    <font color="red"><?php echo $error_msg; ?></font><br />
    <input type="password" name="access_password" /><p></p><input type="submit" name="Submit" value="Submit" />
  </form>
  <br />
  </div>
</body>
</html> 

<?php
global $PasswordEntered;
$PasswordEntered = crypt($_POST['access_password'],$SaltCode);

}

if (!isset($_COOKIE["Cookie"]))
{ 

LoginScreen($salt);

if ($PasswordEntered == $RealPassword)
    {
        setcookie("Cookie", $PasswordEntered, time()+600);
    } 

}

if (isset($_COOKIE["Cookie"]))
{

?>  

<B><fontsize=16>Are you sure you want to Format the data disk?</b></font><br><br>

<form method = "post">

<INPUT TYPE = 'Submit' name = 'FormatSubmit' value = 'Submit'>

<br><br><br>
Please check the box to verify you want to Format the data disk.

<Input type = "Checkbox" Name ="FormatCheck" value ="checked">

</form>

<?php
if (($_POST['FormatSubmit'] == "Submit") & ($_POST['FormatCheck'] == "checked"))
    {
    html_exec_cmd('echo -e "o\nn\np\n1\n\n\nw\n" | fdisk /dev/sda;sleep 1;mkfs.ext3 /dev/sda1;mount /dev/sda1 /data/');
     }

}

     break; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T21:14:44.907

cookie 仅作为请求的一部分发送：

```
setcookie("Cookie", $PasswordEntered, time()+600);

if (isset($_COOKIE["Cookie"])) {
} 
```

如果它在同一个请求中，这将失败。

但是，您可以执行以下操作：

```
setcookie("Cookie", $PasswordEntered, time()+600);
// might be consudered bad practice though to directly edit the superglobal, so be wary of WTF's
$_COOKIE["Cookie"] = $PasswordEntered;

if (isset($_COOKIE["Cookie"])) {
} 
```

顺便说一句，这是什么：`global $PasswordEntered;`??

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-06T21:28:24.073

也许与另一个变量，像这样：

```
<?php

global $PasswordEntered;
if (isset($_POST['access_password'])){
    $PasswordEntered = crypt($_POST['access_password'],$SaltCode);
} else {
    $PasswordEntered='';
}
}
$pass=false;
if (!isset($_COOKIE["Cookie"]))
{ 
    LoginScreen($salt);

if ($PasswordEntered == $RealPassword)
{
    setcookie("Cookie", $PasswordEntered, time()+600);
    $pass=true;
} 
}

if (isset($_COOKIE["Cookie"]) || $pass)
{
   .
   .
   . 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T14:22:59.407

我最终完全放弃了 setcookie 参数，因为我想不出解决它的方法。我决定使用 $_SESSION 参数来让它工作。一个额外的好处是会话是在服务器端控制的，因此安全性会更高。

```
case 'Login':

      $salt = "test";
      $adminpass = "adminpass";
      $RealPassword = crypt($adminpass, $salt);

      if (isset($_SESSION['loggedin'])){
        echo "You are already logged in.";
      }
      else if ($_POST['access_password']){
        $PasswordEntered = crypt($_POST['access_password'],$salt);
        if ($PasswordEntered == $RealPassword){
            $_SESSION['loggedin']=1;
            LogData('Logged in',$logdir);
            echo "You are now logged in!";
        }
        else{
            echo LoginScreen();
            LogData('Failed login attempt',$logdir);
        }
      }
      else{ 
        echo LoginScreen();
      }
    break; 
```

# ios - 如何在ios应用程序中动态填充文本字段

> ID：11835984
> 
> 赞同：0
> 
> 时间：2012-08-06T21:10:35.803
> 
> 标签：ios, dynamic, drop-down-menu, textfield

我有一个带有几个文本字段的单页应用程序。一个字段是下拉菜单，用户可以使用它选择要填写此文本字段 (text1) 的项目。填充此文本字段（text1）后，如何自动更新其他文本字段（text2、text3 等）。

例如：我有三个文本字段，text1、text2、text3。在后端，我在它们之间有一个匹配的数组列表，因此来自 text1 的值将能够找到 text2 和 text3 的正确值。但是，如何在用户更改 text1 的值后动态更新 text2 和 text3。

另一个更基本的问题：如何在 viewdidload 的文本字段中显示文本字符串？
例如：我从数据库中检索了值，如何在加载视图时在文本字段中显示该值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:32:04.523

好的，我将尝试一一解决问题：

首先在加载时显示文本字段。为标签创建一个出口来保存您的文本。示例 - 从 .h 文件开始

```
@property (weak, nonatomic) IBOutlet UILabel *textbox1; 
```

现在在 Interface Builder 中，拖出一个标签，然后将您刚刚拖出的标签与您设置的属性连接起来。

现在您有了一个存储价值的渠道。

现在放一些东西去.m文件中`-(void)viewDidLoad`添加如下内容：

```
self.textbox1.text = @"some text to display"; 
```

那应该在屏幕上显示一些东西。

现在，如果您想在用户输入期间或之后动态更新其他屏幕上的标签，您需要实现一个文本字段委托。尝试解释整个事情有点复杂，但基本上在您的 .h 文件中，您的实现行应该如下所示：

```
@interface YourViewControllerNameHere : UIViewController <UITextFieldDelegate> 
```

然后在您的 .m 文件中，您需要进行一些更改

首先在`viewDidLoad`添加这一行

```
self.textbox1.delegate = self;  //this tells the UILabel to send changes to your program 
```

然后在一些开放空间中，您可以实现这些回调方法：然后运行您的程序，日志会告诉您事情发生的时间和地点。

基本上，您可以根据要执行的操作从正确的方法调用您的代码。

```
- (void)textDidChange:(id<UITextInput>)textInput {
  NSLog(@"text did change");
}

- (void)textFieldDidBeginEditing:(UITextField *)textField {
  NSLog(@"text field did begin editing");
}

-(void)textFieldDidEndEditing:(UITextField *)textField {
  NSLog(@"text field did end editing");
}

-(void)textWillChange:(id<UITextInput>)textInput {
  NSLog(@"text will change");
}

-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
  NSLog(@"text field should change characters in range");
  //if this is disabled no character will appear
  //use to filter out bad characters
  return YES;
}

- (BOOL)textFieldShouldReturn:(UITextField *)textField {
  NSLog(@"text field should return");
  return YES;
} 
```

# jquery - 在进行 ajax 调用之前检查 url 是否包含有效的 tumblr 域名

> ID：11835987
> 
> 赞同：1
> 
> 时间：2012-08-06T21:10:59.277
> 
> 标签：jquery, ajax, tumblr

这是 Ajax 代码：

```
jQuery.ajax({url: "http://api.tumblr.com/v2/blog/" + nonTumblrURL + "/info?api_key=WIHfFzkpSXJ4FOfzt3qBAhlleM09iSAtc2AFNAdViAeRPzAsMq&jsonp=getUserName", dataType: "jsonp"}); 
```

这是功能：

```
function getUserName(data){
   console.log(data.response.blog.name);
   var username = data.response.blog.name;

if (username === "api" ){
    //alert("You didn't enter anything.");
    $('input.nonTumblrURL').val("You need to enter something here.");
    return;}
$('#convertedURL').html("<em>Use </em><b> " + username + "</b> <em> for that Tumblr</em>");
} 
```

此处的目的是在使用像“customdomain.com”这样的自定义域而不是标准的“someone.tumblr.com”时检索 Tumblr 的用户名。所以，我使用 Tumblr API 来获取用户名。

当在 Ajax 调用中发送一个空白值时，它会返回“api”，所以我将它捕获在函数中，并在其中放置了一条结果消息`#convertedURL`并且工作正常。

我需要的是能够捕获在 Tumblr API 中无法解析的非空白值。例如，“theagenda.nytimes.com”正确解析为“nyt-agenda”。

但是，我需要捕获诸如“junkkkkk”之类的内容（以及其他对于 Tumblr 或其他无效域的内容），并将其中的 HTML 替换为`#convertedURL`“这不是正在使用的自定义域”之类的消息。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:15:19.973

```
function isValidDomain(url){
  return /((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(url);
} 
```

[从这里](https://stackoverflow.com/questions/8667070/javascript-regular-expression-to-validate-url)公然抄袭。也看到[这个](https://stackoverflow.com/questions/161738/what-is-the-best-regular-expression-to-check-if-a-string-is-a-valid-url)。

其次，要知道它是否解析为有效的 url。（这里不说 tumblr 特定）

您可以简单地进行 ajax 调用并查看它是成功还是失败。

```
$.ajax({url : url,
   success : function() {...},
   error : function() {...}
}); 
```

# php - Wordpress 功能 in_category 未按预期工作

> ID：11835994
> 
> 赞同：1
> 
> 时间：2012-08-06T21:11:28.903
> 
> 标签：php, wordpress

这让我发疯，我尝试了各种不同的东西。本质上，想要的效果是使用内置`in_category`函数在 Wordpress 中定位两个不同的类别。

这是我目前的代码：

```
if(in_category( array("Snacks", "Other Nuts") )) :
 //do something
endif; 
```

这将适用于类别`Snacks`，但不适用于类别`Other Nuts`。当我`Other Nuts`用另一个类别名称替换时，例如`Confections`，它可以完美运行。

我假设这与类别名称中的空格有关`Other Nuts`。不过，我尝试使用它的类别 ID 和类别 slug 无济于事。

知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-06T21:39:43.170

弄清楚了。

假设您有两个类别，一个是另一个的父级，如下所示：

```
Other Nuts (Parent)
    Almonds (Child) 
```

如果您在 Wordpress 中发布帖子并将其分类`Almonds`并运行一个简单的循环，例如

```
if(have_posts()) :
  while(have_posts()) : the_post();

  // run your loop

  endwhile;
endif; 
```

您将获得`Almonds`属于归类的`Other Nuts`父类别的帖子的输出`Almonds`。现在，如果您要运行此循环：

```
if(have_posts()) :
  while(have_posts()) : the_post();

    if(in_category('Other Nuts')) :  

       // run your loop

    endif;

  endwhile;
endif; 
```

你将一无所获。原因是您只将帖子分类在 中，`Almonds`而不是在 中`Other Nuts`。在这种情况下，Wordpress 不会在父类别和子类别之间建立联系。被归类在子类中并不也将其归类在父类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T04:54:25.097

本质上，这应该根据您期望的所有 ID 检查帖子的所有当前类别 ID，然后根据您的期望检查所有父类别 ID。相反，您可以比较类别名称，对此代码略有不同。

第 1 步：将其放入您的 functions.php 文件中：

```
function check_category_family( $categories, $expected_ids ){
  foreach( $categories as $i ){
    if( in_array( intval( $i->category_parent ), $expected_ids ) ){
      return true;
    }
  }
} 
```

第 2 步：将此伪代码放入您正在构建的任何类别模板中：

```
$categories = get_the_category();
$expected_ids = array( /*PUT YOUR CATEGORY IDS AS INTEGERS IN HERE*/ );

if( in_category( $expected_ids ) || check_category_family( $categories, $expected_ids ) ){
  //run the loop
} else {
  //redirect?
} 
```

# excel - 如何删除 VBA/Excel 中 X 行下方的所有内容？

> ID：11835997
> 
> 赞同：22
> 
> 时间：2012-08-06T21:12:01.693
> 
> 标签：excel, vba

我有一个包含数字的长变量 X。说是415。

如何删除工作表上第 415 行及以下的所有内容？

我想确保我的电子表格在第 415 行以及它下面的任何其他内容都是干净的。

我该怎么做呢？谢谢。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-08-06T21:30:04.777

听起来像下面这样的东西会满足您的需求：

```
With Sheets("Sheet1")
    .Rows( X & ":" & .Rows.Count).Delete
End With 
```

其中 X 是一个变量，它 = 行号 ( 415 )

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-07T15:21:49.770

另一种选择是`Sheet1.Rows(x & ":" & Sheet1.Rows.Count).ClearContents`（或`.Clear`）。您可能想要使用此方法而不是`.Delete`因为任何在已删除范围内具有依赖关系的单元格（例如，引用这些单元格的公式，即使是空的）最终都会显示`#REF`. 此方法将保留对已清除单元格的公式引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-13T08:40:14.453

此函数将从指定的行和列开始清除工作表数据：

```
Sub ClearWKSData(wksCur As Worksheet, iFirstRow As Integer, iFirstCol As Integer)

Dim iUsedCols As Integer
Dim iUsedRows As Integer

iUsedRows = wksCur.UsedRange.Row + wksCur.UsedRange.Rows.Count - 1
iUsedCols = wksCur.UsedRange.Column + wksCur.UsedRange.Columns.Count - 1

If iUsedRows > iFirstRow And iUsedCols > iFirstCol Then
    wksCur.Range(wksCur.Cells(iFirstRow, iFirstCol), wksCur.Cells(iUsedRows, iUsedCols)).Clear
End If

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-13T19:52:12.000

对“行”的任何引用都应使用“长”而不是“整数”，否则如果电子表格有大量数据，它将溢出。

# css - 如何获得 css 伪元素：检查在 IE7 + IE8 中工作？

> ID：11835999
> 
> 赞同：4
> 
> 时间：2012-08-06T21:12:02.583
> 
> 标签：css, internet-explorer-8, internet-explorer-7, pseudo-element

我正在尝试设置与 IE 7+8 中未选择的单选按钮不同的样式。我试过选择器，它解决了这个问题，但也产生了其他问题，将 css 背景图像设置为隐藏。有谁知道另一个可以解决 IE 伪问题的 JS 库？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-07T09:29:33.460

你试过 IE9.js 吗？

*   [http://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)
*   [http://www.charlescooke.me.uk/web/lab_notes/ie7_script.html](http://www.charlescooke.me.uk/web/lab_notes/ie7_script.html)
*   [http://ie7-js.googlecode.com/svn/test/index.html](http://ie7-js.googlecode.com/svn/test/index.html)
*   [http://ie7-js.googlecode.com/svn/test/checked.html](http://ie7-js.googlecode.com/svn/test/checked.html)