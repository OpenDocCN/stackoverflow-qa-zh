# StackOverflow 问答 11000000-11000999

# routing - MVC routing: constrain a route to match recognized controller names

> ID：11000005
> 
> 赞同：3
> 
> 时间：2012-06-12T15:37:59.500
> 
> 标签：routing, asp.net-mvc-routing, asp.net-mvc

I want to define a route with a constraint so that it only matches known controller names. This is to allow me to define a fallback route for other URLs of the same form.

Specifically:

```
/User 
```

Should take me to the Index action of the **User** controller (which exists)

```
/History 
```

Should take me to the Index action of the **History** controller (which exists)

```
/es 
```

As no "es" controller exists, should use the fallback route and take me to the Index action of the Home controller with a language parameter value of "es".

I need this because I have a requirement to provide a special URL with a language code to launch the app in a given language. So there is now a need to distinguish between valid controller names and language names in the routing.

How can I implement `RegisterRoutes` to achieve this? Many thanks!

**Edit:** I realize that I can define a specific route for each of my controllers, which is OK (I don't have a zillion controllers). But I'm wondering if I can rely on a generic constraint to achieve this so that I don't have to define individual routes.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T09:24:33.437

When defining your routes, use the "constraints" parameter to handle this.

For instance:

```
RouteTable.Routes.Add(new Route
{
    Url = "{controller}/{action}",
    Constraints = new { controller = "User|History" },
    Defaults = new { action = "Index" }
};

RouteTable.Routes.Add(new Route
{
    Url = "{languageCode}",
    Defaults = new { controller = "Home", action = "Index" }
}; 
```

The first route added will be evaluated first. If the token for "controller" is not matched against the constraints, the next route added will be evaluated and resolve to the Home controller with the Index action and the language token in the parameter languageCode. You might want to add a constraint to the languageCode token as well, to make sure only valid languages are matched. Then you could possibly add a third route as a catch-all route.

You could also use a routehandler to deal with the languageCode as I have described in my blogpost [Localization and MVC](http://www.austrheim.org/post/2010/07/20/Localization-and-MVC.aspx).

# google-custom-search - Google CSE 上方的额外空白？

> ID：11000011
> 
> 赞同：2
> 
> 时间：2012-06-12T15:38:04.943
> 
> 标签：google-custom-search

我在这个网站上有一个谷歌网站搜索，它的渲染结果太低了大约 300 像素。我可以使用 CSSEDIT 之类的工具，覆盖和编辑 Google 样式表，调整以下样式：

```
.gsc-results {
  padding-bottom: 2px;
  width : 99%;
  margin-top: -300px;
} 
```

添加边线解决了我的问题。但是，样式表托管在 Google 上。我已经尝试在多个地方添加这种样式，以便最后捕捉这种样式设置并覆盖另一个。在任何地方都不适合我。

[http://www.bankoflabor.com/searchresults.php?q=banking](http://www.bankoflabor.com/searchresults.php?q=banking)

也许有人可以帮助我？谢谢！！

# c++ - 无法在 QGLWidget 中设置所需的 OpenGL 版本

> ID：11000014
> 
> 赞同：9
> 
> 时间：2012-06-12T15:38:08.963
> 
> 标签：c++, qt, opengl, opengl-3

我正在尝试在 Qt 4.8.2 中使用 QGLWidget。我注意到 QGLWidget 创建的默认上下文不显示 3.1 以上 OpenGL 的任何输出。[Qt wiki 有一个教程](http://qt-project.org/wiki/How_to_use_OpenGL_Core_Profile_with_Qt)，演示了使用 OpenGL 3.3 绘制一个简单的三角形。当我尝试运行教程时，我得到一个空白屏幕。如果我将 OpenGL 版本更改为 3.1，我会得到预期的输出（红色三角形）。

我的显卡支持 OpenGL 4.2，`QGLFormat::openGLVersionFlags()`在创建 QGLWidget 之前调用显示 Qt 检测到 OpenGL 4.2 和所有以前的桌面版本。

这是另一个最小的例子：

```
#include <QApplication>
#include <QGLWidget>
#include <QDebug>
#include <QtDeclarative/qdeclarativeview.h>

int main(int argc, char * argv[])
{
    QApplication app(argc, argv);

    qDebug() << "OpenGL Versions Supported: " << QGLFormat::openGLVersionFlags();

    QGLFormat qglFormat;
    qglFormat.setVersion(4,2);  // get expected output with (3,1) and below, else blank window
    qglFormat.setProfile(QGLFormat::CoreProfile);
    qglFormat.setSampleBuffers(true);

    QGLWidget* qglWidget = new QGLWidget(qglFormat);

    QString versionString(QLatin1String(reinterpret_cast<const char*>(glGetString(GL_VERSION))));
    qDebug() << "Driver Version String:" << versionString;
    qDebug() << "Current Context:" << qglWidget->format();

    QDeclarativeView mainView;
    mainView.setViewport(qglWidget);
    mainView.setSource(QString("helloworld.qml"));
    mainView.show();

    return app.exec();
} 
```

这是输出：

```
OpenGL Versions Supported:  QFlags(0x1|0x2|0x4|0x8|0x10|0x20|0x40|0x1000|0x2000|0x4000|0x8000|0x10000) 
Driver Version String: "4.2.0 NVIDIA 295.53" 
Current Context: QGLFormat(options QFlags(0x1|0x2|0x4|0x10|0x20|0x80|0x200|0x400) , plane  0 , depthBufferSize  24 , accumBufferSize  16 , stencilBufferSize  8 , redBufferSize  8 , greenBufferSize  8 , blueBufferSize  8 , alphaBufferSize  -1 , samples  4 , swapInterval  0 , majorVersion  4 , minorVersion  2 , profile  1 ) 
```

第一行的`QFlags()`枚举列表描述了支持的 OpenGL 版本。该列表显示我支持除 OpenGL/ES 版本之外的所有变体。第三行的 QFlags() 描述了格式选项（alpha 通道、模板缓冲区等）。

任何人都知道为什么 QGLWidget 不适用于 >= 3.1 的任何东西？我在 Linux 上，有一个 Nvidia GT440，glxinfo 显示它支持 OpenGL 4.2.0。驱动程序版本打印在上面的示例输出中。我不太确定还能尝试什么。

*编辑：在此编辑之前，我对问题的解释犯了一些非常糟糕的错误/假设。这个问题仍然相似，但希望现在更有意义。很抱歉有任何混淆。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T12:06:13.587

您应该在`mainView.show();`. 在`show()`OpenGL 上下文尚未初始化之前。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-19T21:46:33.303

**短版：**更新到 Qt5，它已修复。

PS 如果您可以使用 5.4，您可能应该使用 QtOpenGL... 类而不是 QGL... 类。

**长版：** 所以，万一有人遇到这样的问题。

我尝试在 ubuntu 14.04 和 Qt 4.8.6 上使用我的 Intel HD3000 创建 NOT OpenGL 3.0 上下文。我想出了答案末尾提供的这个测试代码。尝试创建 3.1、1.2、2.1.. 等上下文 Core Compatible.. 但总是`context->format().majorVersion()`显示请求的版本，并`glGetString(GL_VERSION)`显示 3.0。

大约 3 小时后，我注意到默认情况下 Qt Creator 使用 Qt4 而不是最近安装在我的系统上的 Qt 5。在我用 Qt 5.2.1 重新编译项目后，完全相同的代码开始按预期工作。

希望这可以帮助某人。

```
int main(int argc, char *argv[])
{
    QApplication a(argc, argv);

    MainWindow w;
    w.show();

    QGLFormat glFormat;
    glFormat.setVersion(3, 1);
    glFormat.setProfile(QGLFormat::NoProfile);
    glFormat.setSampleBuffers(true);
    glFormat.setDefaultFormat(glFormat);
    glFormat.setSwapInterval(1);
    QGLWidget widget(glFormat);
    widget.makeCurrent();

    const QGLContext *context = widget.context();

    glewExperimental = GL_TRUE;
    if (glewInit() != GLEW_OK) {
        qWarning("Failed to initialize GLEW\n");
    }
    qDebug() << "Context valid: " << context->isValid();
    qDebug() << "Really used OpenGl: " << context->format().majorVersion() << "." << context->format().minorVersion();
    qDebug() << "OpenGl information: VENDOR:       " << (const char*)glGetString(GL_VENDOR);
    qDebug() << "                    RENDERDER:    " << (const char*)glGetString(GL_RENDERER);
    qDebug() << "                    VERSION:      " << (const char*)glGetString(GL_VERSION);
    qDebug() << "                    GLSL VERSION: " << (const char*)glGetString(GL_SHADING_LANGUAGE_VERSION);
    qDebug() << "endstuff\n";

    return a.exec();
} 
```

# ruby - Ruby 中用于 em 同步的嵌套迭代器

> ID：11000029
> 
> 赞同：3
> 
> 时间：2012-06-12T15:39:16.700
> 
> 标签：ruby, parsing, eventmachine

我正在尝试使用 eventmachine 和 em-synchrony 编写解析器（解析邮政编码的街道和房屋）。问题是我要解析的网站具有嵌套结构——每个邮政编码都有许多街道页面，这些页面具有分页。所以算法很简单：

*   对于每个邮政编码
    *   访问邮政编码索引页面
        *   解析索引页面
        *   解析分页
        *   对于每个分页页面解析此页面

这是一个这样的解析器的例子（它有效）：

```
require "nokogiri"
require "em-synchrony"
require "em-synchrony/em-http"

def url page = nil
  url = "http://gistflow.com/all"
  url << "?page=#{page}" if page
  url
end

EM.synchrony do
  concurrency = 2

  # here [1] is array of index pages, for this template let it be just [1]
  results = EM::Synchrony::Iterator.new([1], concurrency).map do |index, iter|
    index_page = EM::HttpRequest.new(url).aget

    index_page.callback do
      # here we make some parsing and find out wheter index page 
      # has pagination. The worst case is that it has pagination
      pages = [2,3,4,5]

      unless pages.empty?
        # here we need to parse all pages
        # with urls like url(page)
        # how can I do it more efficiently?
      end

      iter.return "SUCC #{index}"
    end

    index_page.errback do 
      iter.return "ERR #{index}"
    end
  end

  p results
  EM.stop
end 
```

所以诀窍就在这个块里面：

```
unless pages.empty?
  # here we need to parse all pages
  # with urls like url(page)
  # how can I do it more efficiently?
end 
```

如何在同步迭代器循环中实现嵌套的 EM HTTP 调用？

我尝试了不同的方法，但每次我遇到诸如“无法从根光纤产生”或调用 errback 块之类的错误时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T16:25:28.173

一种解决方案是使用`FiberIterator`和同步`.get`而不是`.aget`：

```
require "em-synchrony"
require "em-synchrony/em-http"
require "em-synchrony/fiber_iterator"

def url page = nil
  url = "http://gistflow.com/all"
  url << "?page=#{page}" if page
  url
end

EM.synchrony do
  concurrency = 2

  master_pages = [1,2,3,4]

  EM::Synchrony::FiberIterator.new(master_pages, concurrency).each do |iter|
    result = EM::HttpRequest.new(url).get
    if result
      puts "SUCC #{iter}"
      detail_pages = [1,2,3,4]       
      EM::Synchrony::FiberIterator.new(detail_pages, concurrency).each do |iter2|
        result2 = EM::HttpRequest.new(url).get
        puts "SUCC/ERR #{iter} > #{iter2}"
      end
    else
      puts "ERR #{iter}"
    end
  end

  EM.stop

end 
```

# javascript - 无法使用 jquery 从 keyup 上的输入文本中获取值

> ID：11000031
> 
> 赞同：2
> 
> 时间：2012-06-12T15:39:19.543
> 
> 标签：javascript, jquery, forms, keyup

我正在尝试`<input type=text>`使用 jQuery 的 keyup 方法获取 an 的值，但是每当我记录它时，它都会记录未定义的。

这是我的代码：

```
$.each(editables,function(i){
    current  = $(editables[i]);
    var value;              
    current.on('keyup', function(){
        value = $(this).val();
        console.log( value );
    });
    current.html( value );
}); 
```

提前致谢

**编辑**

我有一个显示数据库所有信息的表格，我有一个编辑信息的按钮，我所做的就是将所有信息转换`<td class="editable">`为一个`<input type="text">`，然后在单击按钮后尝试从它们那里获取值再次，我将通过发送信息，`$.post()`但我无法从这些输入中获取值

**编辑 2** 这是处理程序的完整代码，希望它有所帮助，感谢所有贡献的人 $('.edit').on('click',function(e){

```
 $this = $(this);
    editables = $this.parents('tr').find('td.editable');

    if($this.text() == "Save"){
        row  = $this.parents('tr');
        table = row.data('table');
        id = row.data('id');
        field = row.data('field');
        /*
        $.each(editables,function(i){
            current  = $(editables[i]);
            var value;              
            current.on('keyup', function(){
                value = $(this).val();
                console.log( value );
            });
            console.log( current );
            current.html( value );
        });
        */
        editables.each(function(i){
            var current = $(this);
                value;
            current.on('keyup',function(){
                value = $(this).val();
                console.log(value);
            })
        });

        $this.val('Edit');  

    } else {            

        $.each(editables,function(i){
            current  = $(editables[i]);
            currentValue = current.text();

            current.html("<input type='text' value='"+currentValue+"'></input>");
        });     

        $this.val('Save');
    }

    e.preventDefault();
}); 
```

**更新**
除了我在这里共享的代码之外，我的代码中还有其他错误，这弄乱了功能。
感谢所有帮助过的人

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:45:22.153

`editables`仍然是`<td>`基于您更新的代码的标签，而不是现在里面的输入。改为使用`.find`来定位新的输入标签。

```
 editables.find('input').each(function(i){
        var current = $(this);
            value;
        current.on('keyup',function(){
            value = $(this).val();
            console.log(value);
        })
    }); 
```

（回答上面更新的问题）

* * *

（回答下面的原始问题）

首先，您需要将您的`.html()`语句移动到`.on('keyup'`. 否则它只会在`keyup`发生之前运行一次。基本上你正在做的是：1.初始化`value`。2\. 设置`current.html`为没有值的初始化变量（`undefined`）。3\. 听`keyup`。4.`keyup`改变变量的值，什么也不做。

当`.html()`在里面时，`.on`它只会`keyup`在每个之后运行`keyup`。哪些保证`value`将在使用之前进行初始化。

```
$.each(editables,function(i){
    current  = $(editables[i]);
    var value; 
    var currentTextField = $('#theInput'); //should be relational to the editable, not a straight selection query as shown here             
    currentTextField.on('keyup', function(){
        value = currentTextField.val();
        console.log( value );
        current.html( value );
    });

}); 
```

假设可编辑是您希望显示文本字段结果的区域。可`current`编辑不是文本字段本身，不会响应`keyup`或`.val()`

**或者**

如果可编辑项实际上是文本字段本身，那么它们没有内部，您不能`.html()`在它们上使用。你也不应该想要。因此，假设您将结果输出到页面上的某个地方。

```
$.each(editables,function(i){
    current  = $(editables[i]);
    var value; 
    var currentTextField = $('#outPutLocation'); //should be relational to the editable, not a straight selection query as shown here             
    current.on('keyup', function(){
        value = current.val();
        console.log( value );
        currentTextField.html( value );
    });     
}); 
```

# gis - 从 OpenLayers 的新增功能中获取 LonLat

> ID：11000036
> 
> 赞同：3
> 
> 时间：2012-06-12T15:39:42.337
> 
> 标签：gis, openlayers

好吧，当我测试这段代码时

```
var map;
            function mapInit(element){
              map = new OpenLayers.Map(element);
              var osm = new OpenLayers.Layer.OSM(); 
              var vectors = new OpenLayers.Layer.Vector("Vector Layer", {renderers: renderer});  
              var renderer = OpenLayers.Util.getParameters(window.location.href).renderer;
              renderer = (renderer) ? [renderer] : OpenLayers.Layer.Vector.prototype.renderers;         
              map.addLayers([osm, vectors]);
              map.zoomToMaxExtent();
              var add =  new OpenLayers.Control.DrawFeature(vectors,OpenLayers.Handler.Point, {
                  featureAdded: getInfoFeature,
                  multi: false
              });
              map.addControl(add);
              add.activate();
            } 
            function getInfoFeature(event){
                var coords = event.lonlat;
                console.log(coords);

            }

            mapInit('siteMap'); 
```

添加功能效果很好，但坐标为空。可能我错过了什么？是否也可以设置最大的可添加功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-13T10:54:21.983

lonlat 并不总是被定义。尝试：

```
 function getInfoFeature(event){
            var coords = event.geometry.getBounds().getCenterLonLat();
            console.log(coords);

        } 
```

# sql-server - SQL Server 中的更新/插入触发器

> ID：11000039
> 
> 赞同：2
> 
> 时间：2012-06-12T15:39:54.540
> 
> 标签：sql-server, sql-server-2008, tsql

我是 SQL Server 和触发器的新手。我想创建一个在插入新行或更新现有行时触发的触发器。触发器将更新一组计算列。

有人可以给我一个基本的触发器来检查是否`fldType = 'INVALID'`，如果是，它将另一列设置`errInvalid`为`1`.

请记住，每天将插入 5000 行（一次点击），因此性能是一个问题。我在别处看过，但只是感到困惑。

好的，我的问题已经演变。我已经沿着 Persisted Colums 路线行驶。我已经创建了一个成功的基本持久字段，但是在嵌套逻辑 pf 方面遇到了问题。

我可以（以及如何）执行以下操作：

如果 [MissCustName] 为真，则 [CustomerAccountName] 为 NULL，则 (1) else (0) end else (0) end

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:51:10.537

也许更好的选择是使用计算列代替..

```
create table myTab
(
    fieldType varchar(10),
    errInvalid As Case When fieldType = 'INVALID' then 1 else 0 end PERSISTED
)
Go
insert into mytab(fieldType) values ('aaa')
insert into mytab(fieldType) values ('INVALID')
Go
Select * from mytab 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:52:55.013

你真的想要一个计算的列。它会表现得更好。请参阅[此](https://stackoverflow.com/questions/9911882/instead-trigger-or-calculated-column-which-is-better)SO 帖子。

```
CREATE TABLE [dbo].[myTab]
(
  [fldType] [varchar](50) NULL ,
  [errInvalid] AS ( CASE [fldType]
                      WHEN 'Invalid' THEN ( 1 )
                      ELSE ( 0 )
                    END )
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T15:54:17.447

为什么不使用“真实”计算列？

例如：

```
CREATE TABLE foobar
(
    fldType varchar(10),
    errInvalid AS CASE WHEN fldType = 'INVALID' THEN 1 ELSE 0 END
) 
```

如果您进行大量读取（几乎达到“物理”列的级别），使用持久计算列可能会提高性能。只需`PERSISTED`在列定义之后添加：

```
CREATE TABLE foobar
(
    fldType varchar(10),
    errInvalid AS CASE WHEN fldType = 'INVALID' THEN 1 ELSE 0 END PERSISTED
) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T15:45:55.303

您可以使用以下内容：

```
CREATE TRIGGER dbo.trgInsertUpdate
ON dbo.YourTableNameHere
FOR INSERT, UPDATE 
AS BEGIN
   -- update the column
   UPDATE dbo.YourTableNameHere
   SET errInvalid = 1
   FROM Inserted i 
   WHERE 
      dbo.YourTableNameHere.ID = i.ID   -- establish link to "Inserted" pseudo-table
      AND fldType = 'INVALID'
END 
```

基本上，每个语句都会调用**一次**触发器，因此它可能一次应用于多行。这些行及其新值存储在`Inserted`伪表中，其中包含表中的所有列。

您需要在表中找到那些行`fldType = 'INVALID'`，它们也是`Inserted`伪表的一部分（那些被插入或更新）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-12T15:46:17.187

我认为这会做你想要的：

```
CREATE TRIGGER Trigger1
ON Table1
FOR INSERT, UPDATE
AS
    UPDATE t
    SET    errInvalid = 1
    FROM   Table1 t
           INNER JOIN Inserted i
             ON i.id = t.id
    WHERE  t.fldType = 'INVALID' 
```

# iphone - 通过应用程序拨打电话

> ID：11000042
> 
> 赞同：2
> 
> 时间：2012-06-12T15:40:01.057
> 
> 标签：iphone, ios, objective-c

我很确定这个问题的答案是否定的，但我想在告诉我的老板之前绝对确定。我想要的是通过应用程序拨打电话，以便在拨打电话时，用户被带到应用程序的另一个屏幕，这样我就可以拥有自己的自定义背景或呼叫屏幕的任何内容，然后当他们完成弹回原来的画面。

我做了一些搜索，我知道在 IOS 4 之前这是不可能的，但我只想检查 IOS 5 是否添加了这个功能？还是仍然无法创建这样的东西。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T16:58:23.543

**可以通过应用程序拨打电话**（您必须*设计自己的 UI*，因为它没有任何 iOS UI 元素）。我见过电话应用程序（只是一个快速的谷歌搜索出现了一些）。

您的问题不清楚它是否是自动呼叫，如果是这样：根据 iOS 人机界面指南，您的应用程序不应在未经用户直接同意的情况下拨打电话、发送消息或电子邮件。您可能还想查看 AppStore 指南，看看您的应用创意是否符合要求。如果您的应用发出自动呼叫或发送自动消息，它将被拒绝/从 AppStore 中删除。

**如果呼叫不是自动的**，您可以使用以下代码发起呼叫：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"tel:13214567890"]]; 
```

此代码打开电话应用程序。目前没有办法留在您的应用程序中拨打电话，然后在您自己的应用程序中终止它 - 这一切都由电话应用程序处理。还应注意，此代码在 iOS 模拟器中不起作用，因为模拟器没有手机应用程序。

[有关 Apple 的完整文档，请参阅此处](https://developer.apple.com/library/archive/featuredarticles/iPhoneURLScheme_Reference/PhoneLinks/PhoneLinks.html)。您可能还想查看这些其他 StackOverflow 帖子：

*   [在 iPhone 上拨打电话并将用户带回应用程序？（UIWebView 做到了）](https://stackoverflow.com/questions/12065498/make-phone-call-on-iphone-and-take-user-back-to-app-uiwebview-does-it)
*   [以编程方式拨打带有访问代码的电话号码](https://stackoverflow.com/questions/5456395/dial-a-phone-number-using-ios)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T15:46:16.553

不，尚不支持自定义电话屏幕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-07T22:23:32.790

试试这个！

```
let phoneNumber =  txtNum.text!;
        let called: NSURL = NSURL(string: "tel://\(phoneNumber)")!
        let options = [UIApplicationOpenURLOptionUniversalLinksOnly : false]

        UIApplication.shared.open(called as URL, options: options, completionHandler: { (success) in
            print("Open url : \(success)")
        }) 
```

# joomla - 创建 Joomla 扩展（附加）

> ID：11000044
> 
> 赞同：0
> 
> 时间：2012-06-12T15:40:04.403
> 
> 标签：joomla, joomla-extensions, joomla2.5

我有一个关于在 Joomla CMS 中创建扩展的问题。我不知道这是否可能，但我想做的是：要创建joomla管理门户的扩展，女巫会在添加界面的某个位置添加一个按钮或链接“添加关键字”一篇新文章，然后当一篇新文章的作者写完他的文章内容，然后点击保存按钮，然后，我希望他点击我的按钮“添加关键字”，这将弹出一个网页（php），此页面将包含一些处理..

我的 joomla 版本是 2.5

有没有人知道我能不能做到这一点？提前致谢

# c# - 从 c# 连接到 mysql 给了我空异常

> ID：11000047
> 
> 赞同：2
> 
> 时间：2012-06-12T15:40:06.900
> 
> 标签：c#, mysql, database-connection

我有这个代码：

```
 con.Open();
 cmd = new MySqlCommand(String.Format("SELECT concat(name,'|',lastname) FROM {0} WHERE ID= ?Parname;", ConfigSettings.ReadSetting("my_data")), con);
 cmd.Parameters.Add("?Parname", MySqlDbType.VarChar).Value = id_value;
 var tokens = ((String)cmd.ExecuteScalar()).Split('|');
 name = tokens[0];
 lastname = tokens[1]; 
```

当我输入 id 值并且用户实际上在数据库中时，这工作得很好。但是当数据库中没有这样的用户时，我得到了空异常。如果他不在数据库中，我需要这样做给我写一个未知用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:44:24.887

如果没有给定 id 的用户，则返回`ExecuteScalar`值为[`DBNull.Value`](http://msdn.microsoft.com/en-us/library/system.dbnull.value.aspx)：

```
var result = cmd.ExecuteScalar();
if (result != DBNull.Value)
{
    var tokens = ((String)result).Split('|');
    name = tokens[0];
    lastname = tokens[1];
}
else
{
    name = "unknown";
    lastname = "user";  // or whatever
} 
```

# javascript - Javascript脚本元素设置内部文本

> ID：11000052
> 
> 赞同：17
> 
> 时间：2012-06-12T15:40:12.867
> 
> 标签：javascript, html, iframe, code-injection

我们需要在 iframe 中添加一个 javascript 元素（它在同一个 Web/域中，因此没有附加安全问题）。我们让它工作了，但不知道如何在其标签之间填充脚本内容......你会怎么做？

```
var iframe = document.getElementById('iframeX');
var iframedocument = iframe.contentWindow.document;

var script = iframedocument.createElement('script');

script.setAttribute('type', 'text/javascript');
script.innerText = 'alert(\'hello\')'; //this doesnt work
script.value= 'alert(\'hello\')'; //this doesnt work either

var head = iframedocument.getElementsByTagName("head")[0];

head.appendChild(script); 
```

iframe 文档中的所需结果：

```
<head>
    <script type="text/javascript" >
        alert('hello');
    </script>
</head> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-12T15:43:26.260

你试过了吗：

```
script.setAttribute('type', 'text/javascript');
script.innerHTML = 'alert(\'hello\')'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-25T17:07:03.437

我遇到了 script.innerHTML 的问题，因为它在 IE8 中不起作用。

```
script.text = 'alert(\'hello\')'; 
```

script.text 对我来说效果更好。发现于：[在 IE8 中创建脚本标签](https://stackoverflow.com/questions/12201485/create-script-tag-in-ie8)

# jquery - 每 4 个数字间隔

> ID：11000060
> 
> 赞同：6
> 
> 时间：2012-06-12T15:40:37.007
> 
> 标签：jquery, jquery-ui, jquery-selectors

我有一个限制为 16 个数字的输入框。我想为美学做的是每 4 个数字放置一个间隙。

例如。当一个人进入

> 1234567891234567

它应该看起来像这样

> 1234 5678 9123 4567

这怎么可能在 JQuery 中的 Key Up 上实现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T15:51:42.753

这是另一个解决方案：

```
$(function() {

    $('#my-input')
    .blur(function() {
        var value = $(this).val();
        value = value.match(/.{1,4}/g).join(" ");
        $(this).val(value);
    })
    .focus(function() {
        var value = $(this).val();
        value = value.replace(/\s/g, '');
        $(this).val(value);
    });

}); 
```

你可以看看那个工作的[jsFiddle](http://jsfiddle.net/xCCWC/1/)。

我添加了一个`focus`事件以使其更加用户友好。总结一下：

*   关于模糊（即离开输入时）：每 4 个字符拆分一次；
*   on focus（即在编辑输入时）：删除先前添加的空格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T15:46:53.803

您可以使用[模数函数](http://www.java2s.com/Tutorial/JavaScript/0040__Operators/Modulus.htm)：

```
$("input").keyup(function(){
        var $this = $(this);
        if ((($this.val().length+1) % 5)==0){
            $this.val($this.val() + " ");
        }
    }); 
```

[**-- 看演示 --**](http://jsfiddle.net/5Y5FN/)

然而它有点错误，但对你来说可能是一个很好的起点。

正如其他用户所提到的，这对可用性不利，最好使用 4 个文本框（如果长度始终为 16）并使用如下内容：

```
$("input").keyup(function(){
        var $this = $(this);
        if ($this.val().length>=4){
         $this.next().focus();   
        }
    }); 
```

[**-- 看演示 --**](http://jsfiddle.net/5Y5FN/1/)

同样，可能有点错误，我只是指出不同的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T15:58:57.647

如果您考虑将其放在多个文本框中，请尝试以下解决方案。

```
$(function() {
    var charLimit = 4;
    $(".inputs").keydown(function(e) {

        var keys = [8, 9, /*16, 17, 18,*/ 19, 20, 27, 33, 34, 35, 36, 37, 38, 39, 40, 45, 46, 144, 145];

        if (e.which == 8 && this.value.length == 0) {
            $(this).prev('.inputs').focus();
        } else if ($.inArray(e.which, keys) >= 0) {
            return true;
        } else if (this.value.length >= charLimit) {
            $(this).next('.inputs').focus();
            return false;
        } else if (e.shiftKey || e.which <= 48 || e.which >= 58) {
            return false;
        }
    }).keyup (function () {
        if (this.value.length >= charLimit) {
            $(this).next('.inputs').focus();
            return false;
        }
    });
}); 
```

它具有以下特点，

> 1.  下一个输入的自动选项卡
> 2.  只有数字
> 3.  charLimit - 设置为不同的长度

**演示：http:** [//jsfiddle.net/skram/qygB2/20/](http://jsfiddle.net/skram/qygB2/20/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-08T09:28:51.733

我会在这里使用`keypress`处理程序：

```
$("#someinput").on('keypress',function(){
  var currval = this.value.replace(/\s+/g,'');
  return (this.value += currval.length && currval.length%4 < 1 ? ' ' : '', true);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T15:47:16.000

像这样的东西

```
$('input').keyup(function(){
    var val = $(this).val();
    if(val.length >= 4){
        $(this).next().focus();
    }
}); 
```

编辑：嗯，你的例子不如上面这个，所以我添加了这个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-12T15:52:27.433

## 用keyup完成

```
$('#textbox').on('keyup', function(e) {
    var val = this.value;
    if (e.which != 8 && e.which != 46) {  // handle delete and backspace
        if (val.replace(/\s/g, '').length % 4 == 0) {
            $(this).val(val + ' ');
        }
    } else {
        $(this).val(val);        
    }
}) 
```

**[演示](http://jsfiddle.net/DvQ5X/3/)**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-12T16:01:21.687

这是您可能要考虑的另一种解决方案

```
OnBlur = function()
{
    var value = $('#txtName').val().replace(/\s/g, "");
    var numberOfSpaces = Math.ceil(value.length / 4)-1;
    while(numberOfSpaces >0)
    {
        value = value.substr(0,numberOfSpaces*4) + ' ' + value.substr(numberOfSpaces*4);
        numberOfSpaces--;
    }
} 
```

# ruby-on-rails - 有没有办法组织我的模型文件，这样 ruby /rails 就不会混淆？

> ID：11000062
> 
> 赞同：0
> 
> 时间：2012-06-12T15:40:45.753
> 
> 标签：ruby-on-rails, ruby

所以，我在 app/models 中的模型列表有点长，我想整理一下。

但是，我知道 Ruby/Rails 对文件夹/子类的命名约定。

IE

```
Object::MyObject::SubObject 
```

看起来像这样：

```
object.rb
object/
-- my_object.rb
-- my_object/
-- -- sub_object.rb 
```

至少在我看来

但是，我想做的是对彼此相关或交互很多的类进行分组。

这是我想做的（例如，这些不是我的实际课程）：

```
app/models/
-- library_item.rb     # LibraryItem < ActiveRecord::Base
-- library_items/
-- -- book.rb          # Book < LibraryItem
-- -- book/
-- -- -- page.rb       # Page < ActiveRecord::Base
-- -- -- cover.rb      # Cover < ActiveRecord::Base
-- -- magazine.rb      # Magazine < LibraryItem
-- -- magazine/
-- -- -- shiny_page.rb # ShinyPage < ActiveRecord::Base 
```

这可能吗？我知道 Java 是这样，但是 Ruby 和 Rails 有一种非常具体的做事方式，而且我还没有读过很多关于大型项目组织的文章。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:46:04.167

为了让 Rails 自动找到这些模型，类名需要与文件路径匹配，例如：

```
class LibraryItem::Book::Page < ActiveRecord::Base 
```

就我个人而言，我更喜欢保持我的模型层次结构大部分是平坦的，这样我就可以只输入`Page`而不是`LibraryItem::Book::Page`. 您可以通过显式加载模型（可能在初始化程序中）来完成这两件事——文件层次结构和短模型名称。

# c - 为什么非常简单的 Hello World 程序没有输出？

> ID：11000065
> 
> 赞同：11
> 
> 时间：2012-06-12T15:40:56.660
> 
> 标签：c

我想知道为什么我的 C 程序不打印任何信息。我是 100% 的编程新手，在过去的几周里，我已经能够在 Ruby 和 Python 中学习一些东西，但是我对 C 的东西一无所知。这是每个人首先学习的总基线简单程序：

```
#include <stdio.h>

int main()

    {
        printf("Hello World\n");
        return 0;
    } 
```

所以我已经写好了，我保存为 hello.c。现在我 cd 到它所在的目录，然后我尝试

```
gcc hello.c 
```

什么也没有发生 - 没有错误，什么都没有。如果我改写

```
gcc hello.c -o hello 
```

一个新的可执行文件被写入我的目录，当我打开它时，它看起来像普通的命令行，并且写有“Hello World”，正如我第一次在终端中所期望的那样。

我也尝试让 hello.c 本身成为可执行文件，但是当我这样做时，我得到了

```
syntax error near unexpected token `('
`int main()' 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-12T15:49:28.220

当您键入

```
gcc hello.c 
```

什么也没有发生，这是意料之中的。或者更准确地说，GCC 将使用默认名称编译一个可执行文件，对我来说是`a.out`. 如果我当时`./a.out`在命令行上键入，我会看到输出。

我认为从你的 Ruby/Python 背景来看，这里可能存在一个稍微大一点的概念问题。Ruby 和 Python（通常）是解释型语言，这意味着当您创建脚本文件时，您可以将其标记为可执行文件，并且通过[某种魔法](http://en.wikipedia.org/wiki/Shebang_%28Unix%29)，操作系统将启动一个程序来读取文件并为您执行它们。但是，C 已编译。因此，当您运行 GCC 时，它会获取您的源文件并将其转换为具有默认名称或指定名称的可执行文件。此时，除非编译过程出现问题，否则不会期望看到任何输出。然后你可以运行`./hello`，这是一个可执行文件，并查看你的输出。

这也解释了为什么您不能标记`hello.c`为可执行文件并运行它。它需要先编译成可执行文件。看起来系统正在假装它是一个 shell 脚本，但实际上不是，并给你一个语法错误。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-12T15:44:42.787

`gcc hello.c`将生成一个名为的文件`a.out`
`gcc hello.c -o hello`将生成一个名为的文件`hello`

这些是可执行文件，您需要执行/运行这些文件才能获得输出。

运行这些作为

`./a.out`或者`./hello`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-12T15:44:51.820

gcc hello.c -o hello 指定您要创建一个名为 hello.exe 的可执行文件。

您必须编译所有 C 文件，然后运行可执行文件才能运行程序。您实际上无法运行 .c 文件。当您不指定 exe 时，它​​只会编译。您没有错误这一事实是一件好事，因为这意味着您的代码是正确的！:)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-12T15:43:36.010

第一次，您的可执行文件被命名为“a.out”（或 Windows 上的“a.exe”），这是 gcc 赋予可执行文件的历史默认名称。

您应该花一些时间来弄清楚源代码和可执行文件之间以及打开和执行之间的区别......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-12T15:50:22.200

欢迎编程和 Stack Overflow！

```
gcc hello.c 
```

编译该文件并生成一个可执行文件“a.out”，但不执行它。这就是为什么在您的命令行上没有发生任何事情的原因。
要开始执行，您必须输入：

```
./a.out 
```

如果我理解正确，就像你对“你好”所做的那样。
如果你想用 C 编程，你必须了解编译、链接和执行之间的区别，给自己找一本很好的初学者书籍或教程，这是值得的！
干杯!

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-12T16:01:24.763

你得到了

```
syntax error near unexpected token `('
`int main()' 
```

对 hello.c 源文件设置保护并尝试运行它时出错。

使用 gcc 将您的 .c 源文件转换为您可以运行的二进制程序。

```
gcc -o hello hello.c 
```

我使用的顺序并不重要。我只是习惯了这种编译方式。你这样编译

```
gcc hello.c -o hello 
```

这很好。

成功的编译和链接创建了一个名为 hello 的输出文件，您将运行该文件

```
./hello 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-02-09T17:19:00.670

您是否尝试过在显示终端窗口之前包含`#include<conio.h>`和包含。`getch()``return 0;`

# jquery - jquery modernizr 应用程序缓存

> ID：11000066
> 
> 赞同：0
> 
> 时间：2012-06-12T15:40:59.720
> 
> 标签：jquery

我注意到 IE 9 不支持应用程序缓存。如何在 Jquery 中使用modernizr 以使其受支持？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:45:55.413

Modernizer 列出了可用于填补浏览器空白的“polyfils”。

[Modernizer wiki 上的 HTML5 跨浏览器 Polyfills](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-browser-Polyfills)

如果您滚动到大约中间，则会列出一个应用程序缓存。

# c++ - 有没有办法通过逆向工程来恢复结构。指向该结构的指针由 DLL 中用于导出的唯一函数返回

> ID：11000067
> 
> 赞同：0
> 
> 时间：2012-06-12T15:41:05.053
> 
> 标签：c++, dll, structure, reverse-engineering

有点...我有一个 DLL，它从反汇编然后反编译的代码中导出唯一的单个函数 CreateInterface ：

```
int __cdecl CreateInterface(const char *a1, int a2)
{
//many crazy things
} 
```

这里它的返回类型为 int，但实际上它是指向某个结构的指针。从主 exe 加载这个库，然后以这种方式使用：

```
int (__stdcall *__cdecl Sys_GetFactory(int (__stdcall *hModule)()))()
{
  int (__stdcall *result)(); // eax@1

  result = hModule;
  if ( hModule )
    result = GetProcAddress(hModule, "CreateInterface");
  return result;
}

void some_funct()
{
    FARPROC net_interface =  Sys_GetFactory(pModule);
    int s_pClientNet = ((int (__cdecl *)(_DWORD, _DWORD))net_interface)("INetClient_003", 0);
} 
```

并在初始化后以这种方式使用：

```
 int result = (*(int (__stdcall **)(int, int, int, int))(*(_DWORD *)s_pClientNet + 60))(
                 login,
                 password,
                 mw_account_struct,
                 mw_account_struct_size); 
```

所以..回到结构。无论如何要恢复它，而不是通过如此疯狂的方式调用所需的函数？我的意思是 (s_pClientNet + 60)

PS 我肯定没有 dll 源、def 文件等，甚至不知道目标类/结构中可以包含哪些函数……我唯一知道的是一些调用像 s_pClientNet + 60 这样的功能

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T17:07:16.137

嗯，这看起来可能是一个 C++ 类。有一个额外的间接级别，我敢打赌它是一个 vtable。s_pClientNet 绝对是一个指针，但 +60 发生*在*取消引用它之后。vpointers 通常是类中的第一个元素，所以这是更多的证据。基本上不可能重新创建一个编译为相同布局的 C++ 类，除非你真的很幸运。但是您可以手动管理一些部分。

```
typedef int(*login_fcn_t)(int, int, int, int);

struct ClientInterfaceVtable
{
    _DWORD reserved[60];
    login_fcn_t login_fcn;
};

struct ClientInterface
{
    ClientInterfaceVtable *vpointer;
    /// other fields
}; 
```

现在，在将您`s_pClientNet`转换为 a之后`ClientInterface *`，您应该能够通过调用 login 方法`s_pClientNet->vpointer->login_fcn(login, etc.);`

在发现更多字段后，您总是可以尝试创建一个多态 C++ 类，看看是否可以推送定义直到找到匹配项，但这不会是可移植的。

编辑：

嗯，我刚刚意识到代码没有传递`this`指针。如果我对 vtable 没有完全错误，那么这表明这是一种静态方法，也许是某种工厂方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:09:17.020

这很难甚至不可能，AFAIK 无法保证结构的布局和对齐方式，因此每个编译器可能会以不同的方式布局结构。即使是同一个编译器也可能通过修饰符和/或编译器选项具有不同的数据布局。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T16:48:11.070

我不知道自动识别结构的任何方法，但是如果您使用 IDA，您可以在 IDA 内部定义结构，然后更改调用签名以显式使用它（将返回值更改为该结构类型和强制重新分析）。

这可能会帮助您更快地分析结构并了解程序行为，但最终将主要是手动分析。

可能有一些 IDA/OllyDbg 的脚本可以帮助解决这个问题，所以可能值得一看[http://www.openrce.org/downloads/](http://www.openrce.org/downloads/)

# mysql - 将一个奇怪的 Mysql 查询更改为使用 group_concat 的 Postgresql

> ID：11000068
> 
> 赞同：0
> 
> 时间：2012-06-12T15:41:05.550
> 
> 标签：mysql, postgresql, database-migration, group-concat

我正在将我们的后端数据库从 mysql 移动到 postgres，并且正在迁移我们所有的旧查询/函数。他们中的大多数都是微不足道的，但今天我遇到了一个让我摸不着头脑的东西。这里是：

```
UPDATE
  k_coderound AS cr, k_coderound AS cr_m
SET
  cr.is_correct = IF(
    (SELECT GROUP_CONCAT(option_id ORDER BY variable_id) AS `values` FROM k_value    
         WHERE code_round_id=cr.id GROUP BY code_round_id) = 
    (SELECT GROUP_CONCAT(option_id ORDER BY variable_id) AS `values` FROM k_value 
         WHERE code_round_id=cr_m.id GROUP BY code_round_id),
    1,
    0
  )
WHERE     
 cr.is_master=0 
 AND cr_m.is_master=1 
 AND cr_m.object_id=cr.object_id 
 AND cr_m.content_type_id =cr.content_type_id 
```

我知道 Postgres 没有 group_concat，应该使用 array_agg。我的问题是我无法弄清楚到底发生了什么——这个查询是很久以前由一个不再和我们在一起的人写的。Postgres 中缺少 IF 语句也使这一困难更加复杂。如果有人能够提供反馈或建议，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:46:09.857

很难说意图是什么。我的方法是首先找到一个返回“目标”数据的 SELECT 语句。

像这样的东西：

```
select cr.is_correct,
       array_agg(case when kv1.code_round_id = cr.id then kv1.option_id else null end, ',' order by kv1.variable_id) as kv_values1,
       array_agg(case when kv2.code_round_id = cr_m.id then kv2.option_id else null end, ',' order by kv2.variable_id) as kv_values2
from k_coderound cr
  join k_value kv1 on kv1.code_round_id = cr.id
  join k_coderound cr_m 
       on cr_m.object_id=cr.object_id 
      and cr_m.content_type_id =cr.content_type_id 
  join k_value kv2 on kv2.code_round_id = cr_m.id
where cr.is_master=0 
  and cr_m.is_master=1 
```

这很可能是不正确的，但我认为它显示了如何将非标准 MySQL 表达式转换为标准 SQL（从而转换为 PostgreSQL）

一旦这似乎做正确的事情，我会将其包装到 UPDATE 语句中：

```
update k_coderound cru
  set cr.is_correct = case 
                        when t.kv_values1 = t.kv_values2 then 1 
                        else 0 
                      end
from (select cr.ctid, 
             array_agg(case when kv1.code_round_id = cr.id then kv1.option_id else null end, ',' order by kv1.variable_id) as kv_values1,
             array_agg(case when kv2.code_round_id = cr_m.id then kv2.option_id else null end, ',' order by kv2.variable_id) as kv_values2
    from k_coderound cr
      join k_value kv1 on kv1.code_round_id = cr.id
      join k_coderound cr_m 
           on cr_m.object_id=cr.object_id 
          and cr_m.content_type_id =cr.content_type_id 
      join k_value kv2 on kv2.code_round_id = cr_m.id
    where cr.is_master=0 
      and cr_m.is_master=1 
) t
where t.ctid = cru.ctid 
```

我很确定我错过了一些语法内容，但希望这能让你开始。

# proxy - XMPP 文件传输的“仅支持 SOCKS5”OpenFire 错误

> ID：11000071
> 
> 赞同：1
> 
> 时间：2012-06-12T15:41:20.857
> 
> 标签：proxy, xmpp, openfire, socks, xmppframework

**我的问题：**我正在使用 XMPPFramework 和 OpenFire 在 iOS 上通过 XMPP 进行文件传输。我的代码基础来自以下[教程](http://mobile.tutsplus.com/tutorials/iphone/building-a-jabber-client-for-ios-server-setup)。目标似乎接受代理作为流主机，但是当请求者尝试这样做时，OpenFire 报告以下错误。为什么会失败，我该如何解决？

**OpenFire 错误 -**

```
2012.06.12 14:38:40 org.jivesoftware.openfire.filetransfer.proxy.ProxyConnectionManager - Error processing file transfer proxy connection 
java.io.IOException: Only SOCKS5 supported 
at org.jivesoftware.openfire.filetransfer.proxy.ProxyConnectionManager.processConnection(ProxyConnectionManager.java:158) 
at org.jivesoftware.openfire.filetransfer.proxy.ProxyConnectionManager.access$200(ProxyConnectionManager.java:57) 
at org.jivesoftware.openfire.filetransfer.proxy.ProxyConnectionManager$1$1.run(ProxyConnectionManager.java:127) 
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441) 
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303) 
at java.util.concurrent.FutureTask.run(FutureTask.java:138) 
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) 
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) 
at java.lang.Thread.run(Thread.java:662) 
```

**我的 OpenFire XMPP 设置——**（注意我在这里设置了代理的外部 ip）

```
xmpp.auth.anonymous - true
xmpp.client.compression.policy - disabled
xmpp.client.idle - -1
xmpp.client.idle.ping - false
xmpp.domain - beta.myCompany.co.uk
xmpp.enabled - true
xmpp.filetransfer.enabled - true
xmpp.offline.quota - 102400
xmpp.offline.type - bounce
xmpp.proxy.enabled - true
xmpp.proxy.externalip - 10.95.xxx.xxx (this is the ip of my server)
xmpp.proxy.port - 7777
xmpp.proxy.transfer.required - false
xmpp.server.compression.policy - disabled
xmpp.server.dialback.enabled - false
xmpp.server.socket.active - true
xmpp.session.conflict-limit - 0
xmpp.session.conflict.limit - 0
xmpp.socket.ssl.active - true 
```

**日志 -**

```
2012-06-12 16:26:20.848 JabberClient[2711:207] RECIEVED IN APP DELEGATE - <iq xmlns="jabber:client" type="result" to="myUsername@beta.myCompany.co.uk/3a62c56a" id="4FC4CE04-DA8E-4CC2-B412-40D1C346F682" from="friendsUsername@beta.myCompany.co.uk/ee69d0fa"><si xmlns="http://jabber.org/protocol/si"><feature xmlns="http://jabber.org/protocol/feature-neg"><x xmlns="jabber:x:data" type="submit"><field var="stream-method"><value>http://jabber.org/protocol/bytestreams</value></field></x></feature></si></iq>
2012-06-12 16:26:20.849 JabberClient[2711:207] Attempting XEP65 connection to friendsUsername@beta.myCompany.co.uk/ee69d0fa
2012-06-12 16:26:20.849 JabberClient[2711:207] TURNSocket DELEGATE STARTING
2012-06-12 16:26:20.851 JabberClient[2711:6103] SENT - <iq type="get" to="beta.myCompany.co.uk" id="C8A201C4-EC3B-49CC-8BF4-9604B872EB19"><query xmlns="http://jabber.org/protocol/disco#items"/></iq>
2012-06-12 16:26:20.856 JabberClient[2711:1e03] RECIEVED IN TURN SOCKET - <iq xmlns="jabber:client" type="result" id="C8A201C4-EC3B-49CC-8BF4-9604B872EB19" from="beta.myCompany.co.uk" to="myUsername@beta.myCompany.co.uk/3a62c56a"><query xmlns="http://jabber.org/protocol/disco#items"><item jid="pubsub.beta.myCompany.co.uk" name="Publish-Subscribe service"/><item jid="broadcast.beta.myCompany.co.uk" name="Broadcast service"/><item jid="search.beta.myCompany.co.uk" name="User Search"/><item jid="conference.beta.myCompany.co.uk" name="Public Chatrooms"/><item jid="proxy.beta.myCompany.co.uk" name="Socks 5 Bytestreams Proxy"/></query></iq>
2012-06-12 16:26:20.857 JabberClient[2711:1e03] SENT - <iq type="get" to="proxy.beta.myCompany.co.uk" id="92BF3339-987C-4A1E-8657-D8AE666DDC32"><query xmlns="http://jabber.org/protocol/disco#info"/></iq>
2012-06-12 16:26:20.857 JabberClient[2711:207] RECIEVED IN APP DELEGATE - <iq xmlns="jabber:client" type="result" id="C8A201C4-EC3B-49CC-8BF4-9604B872EB19" from="beta.myCompany.co.uk" to="myUsername@beta.myCompany.co.uk/3a62c56a"><query xmlns="http://jabber.org/protocol/disco#items"><item jid="pubsub.beta.myCompany.co.uk" name="Publish-Subscribe service"></item><item jid="broadcast.beta.myCompany.co.uk" name="Broadcast service"></item><item jid="search.beta.myCompany.co.uk" name="User Search"></item><item jid="conference.beta.myCompany.co.uk" name="Public Chatrooms"></item><item jid="proxy.beta.myCompany.co.uk" name="Socks 5 Bytestreams Proxy"></item></query></iq>
2012-06-12 16:26:20.862 JabberClient[2711:6103] RECIEVED IN TURN SOCKET - <iq xmlns="jabber:client" type="result" id="92BF3339-987C-4A1E-8657-D8AE666DDC32" from="proxy.beta.myCompany.co.uk" to="myUsername@beta.myCompany.co.uk/3a62c56a"><query xmlns="http://jabber.org/protocol/disco#info"><identity category="proxy" name="SOCKS5 Bytestreams Service" type="bytestreams"/><feature var="http://jabber.org/protocol/bytestreams"/><feature var="http://jabber.org/protocol/disco#info"/></query></iq>
2012-06-12 16:26:20.863 JabberClient[2711:6103] SENT - <iq type="get" to="proxy.beta.myCompany.co.uk" id="D13DE459-63EA-4CD6-97ED-8565559DF298"><query xmlns="http://jabber.org/protocol/bytestreams"/></iq>
2012-06-12 16:26:20.863 JabberClient[2711:207] RECIEVED IN APP DELEGATE - <iq xmlns="jabber:client" type="result" id="92BF3339-987C-4A1E-8657-D8AE666DDC32" from="proxy.beta.myCompany.co.uk" to="myUsername@beta.myCompany.co.uk/3a62c56a"><query xmlns="http://jabber.org/protocol/disco#info"><identity category="proxy" name="SOCKS5 Bytestreams Service" type="bytestreams"></identity><feature var="http://jabber.org/protocol/bytestreams"></feature><feature var="http://jabber.org/protocol/disco#info"></feature></query></iq>
2012-06-12 16:26:20.874 JabberClient[2711:6103] RECIEVED IN TURNSOCKET - <iq xmlns="jabber:client" type="result" id="D13DE459-63EA-4CD6-97ED-8565559DF298" from="proxy.beta.myCompany.co.uk" to="myUsername@beta.myCompany.co.uk/3a62c56a"><query xmlns="http://jabber.org/protocol/bytestreams"><streamhost jid="proxy.beta.myCompany.co.uk" host="10.95.xxx.xxx" port="7777"/></query></iq>
2012-06-12 16:26:20.875 JabberClient[2711:6103] SENT - <iq type="set" from="myUsername@beta.myCompany.co.uk/3a62c56a" to="friendsUsername@beta.myCompany.co.uk/ee69d0fa" id="4FC4CE04-DA8E-4CC2-B412-40D1C346F682"><query xmlns="http://jabber.org/protocol/bytestreams" sid="4FC4CE04-DA8E-4CC2-B412-40D1C346F682" mode="tcp"><streamhost xmlns="http://jabber.org/protocol/bytestreams" jid="proxy.beta.myCompany.co.uk" host="10.95.xxx.xxx" port="7777"/></query></iq>
2012-06-12 16:26:20.875 JabberClient[2711:207] RECIEVED IN APP DELEGATE - <iq xmlns="jabber:client" type="result" id="D13DE459-63EA-4CD6-97ED-8565559DF298" from="proxy.beta.myCompany.co.uk" to="myUsername@beta.myCompany.co.uk/3a62c56a"><query xmlns="http://jabber.org/protocol/bytestreams"></query></iq>
2012-06-12 16:26:20.916 JabberClient[2711:1e03] RECIEVED IN TURN SOCKET - <iq xmlns="jabber:client" type="result" to="myUsername@beta.myCompany.co.uk/3a62c56a" id="4FC4CE04-DA8E-4CC2-B412-40D1C346F682" from="friendsUsername@beta.myCompany.co.uk/ee69d0fa"><query xmlns="http://jabber.org/protocol/bytestreams" sid="4FC4CE04-DA8E-4CC2-B412-40D1C346F682"><streamhost-used jid="proxy.beta.myCompany.co.uk"/></query></iq>
2012-06-12 16:26:20.917 JabberClient[2711:1e03] TURNSocket: initiatorConnect: proxy.beta.myCompany.co.uk(10.95.xxx.xxx:7777) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T19:45:33.693

让我们看一下 Openfire 的源代码。这很容易，因为它是一个开源项目。:)

[ProxyConnectionManager.java:158](http://fisheye.igniterealtime.org/browse/openfire/trunk/src/java/org/jivesoftware/openfire/filetransfer/proxy/ProxyConnectionManager.java?hb=true#to158) tells us that Openfire expects an "5" as first byte send through the stream (i.e. the SOCKS5 connection), or otherwise the Exception you see will get thrown. Which seems to be correct according to [RFC1928 (SOCKS Protocol Version 5) Section 3](http://www.ietf.org/rfc/rfc1928.txt).

So without digging deeper and having any knowledge on XMPP on iOS, I would guess that there is something not correct implemented within xmppframework on iOS. I hope I could point you into the right direction.

# wordpress-theming - 可以在 Textarea 的帖子中包含 Javascript 吗？

> ID：11000072
> 
> 赞同：1
> 
> 时间：2012-06-12T15:41:21.153
> 
> 标签：wordpress-theming, wordpress

我正在为客户开发一个网站，我希望他们可以在编辑博客文章时直接在页脚中输入 javascript。每篇博客文章的 Javascript 都不同，因此无法预定义和 .

现在的工作方式，他们创建博客文章，输入内容，然后转到小部件区域并将小部件拖动到“Javascript”小部件区域，在那里他们可以粘贴被标签包围的 javascript。

而不是走这条路，有没有办法添加一个文本区域，他们可以粘贴在......所以它会直接出现在标签之前的页脚中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T18:29:39.110

这可能会有所帮助。[http://codex.wordpress.org/Function_Reference/add_meta_box](http://codex.wordpress.org/Function_Reference/add_meta_box)

还有一个更简单的方法是自定义字段[http://codex.wordpress.org/Custom_Fields](http://codex.wordpress.org/Custom_Fields)。您可以为帖子页面创建一个自定义字段，并将此字段插入到您需要它的页面中，可能在 single.php 中。

无论哪种方式，我都会在您将内容插入页面之前对其进行一些验证。用户可能会忘记添加正确的脚本标签或错误地格式化他们的内容，这可能会破坏您的页面。

# facebook - Facebook 画布应用上的居中对话框

> ID：11000073
> 
> 赞同：1
> 
> 时间：2012-06-12T15:41:23.180
> 
> 标签：facebook, facebook-graph-api, facebook-canvas

如何创建一个在用户滚动浏览我的 Facebook 画布应用程序时保持居中的对话框？

我已经阅读了有关该主题的[这篇](http://blog.sjhewitt.co.uk/2011/05/positioning-dialogs-in-facebook-canvas-applications/)文章，但是那里描述的方法（收听未记录的 facebook 事件）对我不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T17:35:10.560

看起来 Facebook 不再轮询服务器以更新 pageInfo 作为其库的一部分。但是，编写自己进行轮询的内容并适当地移动对话框是相当简单的：

```
var timeout;
var positionDialog = function(){
    FB.Canvas.getPageInfo(function(pageInfo){
         $("#dialog").animate({top: Math.max(parseInt(pageInfo.scrollTop) - parseInt(pageInfo.offsetTop) + 
            ((parseInt(pageInfo.clientHeight)-$("#dialog").outerHeight())/2), 0)}, 100);
         timeout = setTimeout(positionDialog, 250);
    });
};

var showDialog = function(){
    // show your dialog
    $("#dialog").show();
    positionDialog();
};

var hideDialog = function(){
    $("#dialog").hide();
    clearTimeout(timeout);
}; 
```

注意：我使用了 setTimeout 而不是 setInterval，因为您不知道 ajax 调用需要多长时间，并且不想处理乱序响应。

# javascript - Typeahead with HTML Form - 根据选择自动填充下一个单元格

> ID：11000076
> 
> 赞同：0
> 
> 时间：2012-06-12T15:41:37.113
> 
> 标签：javascript, jquery, html

我正在使用带有 HTML 表单的 Twitter bootstrap-typeahead 插件：

[http://twitter.github.com/bootstrap/javascript.html#typeahead](http://twitter.github.com/bootstrap/javascript.html#typeahead)

这运作良好。我希望根据用户在前一个单元格中的选择自动选择该行中的下一个单元格，这是一个选择菜单。这是一个例子：

[http://jsfiddle.net/WNpy5/](http://jsfiddle.net/WNpy5/)

如果用户为州输入“新南威尔士州”，我希望将国家/地区设置为“澳大利亚”，但可以使用选择菜单进行更改。同样，如果用户选择“加利福尼亚”，我希望将国家/地区设置为“美国”。

我可以轻松地扩展用于 typehead State 字段的值数组以包含相应的国家/地区值（虽然不确定格式），但不确定这是否可能以及如何将它们联系在一起？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T18:36:41.580

您需要一个 javascript 对象数组，用于具有各自状态的国家/地区：

```
var countries = [{ name: 'USA',
                   states: ['Alabama', 'Alaska']},
                 { name: 'Australia',
                   states: ['New South Wales', 'Queensland']}]; // You can add rest of the states here 
```

**演示：http:** [//jsfiddle.net/WNpy5/1/](http://jsfiddle.net/WNpy5/1/)

在演示中，当输入状态并且焦点从文本框移开时，它会自动选择国家。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T18:44:18.557

默认情况下，typeahead 插件只接受一个字符串列表。我创建了一个扩展，它接受一组 JSON 对象，我相信这是您正在寻找的功能。

来源在这里：[https ://github.com/tcrosen/twitter-bootstrap-typeahead](https://github.com/tcrosen/twitter-bootstrap-typeahead)

您的案例的一个示例是：

```
var states = [{ state: 'NY', country: 'USA'}, 
              { state: 'Ontario', country: 'Canada'}, 
              { state: 'Petoria', country: 'Petoria'}];

$('#myTextBox').typeahead({
    source: states,
    display: 'state',
    val: 'country',
    itemSelected: function(item, val, text) {
        // val = name of the country
        // text = name of the provice
        $('#Country').val(val);
    }
}); 
```

# jquery - 将 jquery 插件应用于加载的 ajax 内容

> ID：11000078
> 
> 赞同：3
> 
> 时间：2012-06-12T15:42:03.607
> 
> 标签：jquery, ajax, plugins

> **可能重复：**
> [将 jquery 函数应用于 ajax 内容](https://stackoverflow.com/questions/8771366/apply-jquery-function-to-ajax-content)

我通过**.on阅读了**[关于将 fancybox 绑定到 ajax 加载的内容的文章](https://stackoverflow.com/questions/9536269/apply-jquery-fancybox-to-elements-loaded-via-ajax)

 **问题是：我需要在每次重新加载内部 DIV 时激活插件。

这是我的 HTML：

```
<div id="page">
 <div id="ajax_container">
  content with selectboxes
 </div>
</div> 
```

这是我的 JS

```
jQuery("#page").on("focus", function(){
jQuery("select").selectbox({
        effect: "fade"
 }); // selectbox
}); // on 
```

内容现在需要移动鼠标来转换选择框。我还没有找到任何其他工作事件。此外，转换 SELECT 需要很长时间。

每一个加载的 AJAX 内容如何只显示应用的插件？

注意：AJAX 请求是由另一个 js-framework/ruby 发出的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:41:34.843

您可以像这样绑定`selectbox`ajax请求的成功回调内部

```
$.post('URL',{data:data},function(data){
                $(data).appendTo('#ajax_container').filter('select').selectbox({
                   effect: "fade"
                });
}); 
```

[工作小提琴](http://jsfiddle.net/joycse06/rTspR/1/)

由于您无法在该 ajax 成功回调中初始化插件，因此您可以注册一个全局成功回调，这可能会起作用。检查这个

```
$('body').ajaxSuccess(function(){
   $('select').selectbox({
                       effect: "fade"
                    });
}); 
```

更多关于[`.ajaxSuccess`](http://api.jquery.com/ajaxSuccess/)**

# c# - 按数字检索字典项

> ID：11000079
> 
> 赞同：0
> 
> 时间：2012-06-12T15:42:04.537
> 
> 标签：c#, string, dictionary, key

我有一个`Dictionary`键和值都是字符串的地方。可以通过使用来获取键的值`[]`。但是`[]`期望一个字符串。是否可以通过使用数字而不是字符串键来获取键的值？

```
Dictionary<String, String> m_GermanEnglish = new Dictionary<String, String>();
m_GermanEnglish.Add("der", "the"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:48:06.850

该`IDictionary`接口在枚举字典时不保证项目的顺序，字典本质上是无序的。因此，不存在“位置 1 的项目”之类的东西，因为集合是无序的。

每次枚举字典时，项目以不同的顺序出现是有效的。

如果您还需要按索引访问项目，那么您需要不同的数据结构，例如`IOrderedDictionary`实现。[这里](http://www.codeproject.com/Articles/18615/OrderedDictionary-T-A-generic-implementation-of-IO)有一个基本上与字典并排保存一个列表以提供按索引访问。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T15:48:21.293

您*可以*使用 LINQ

```
m_GermanEnglish.ElementAt(index); 
```

但是您依赖于您不知道或无法保证的实现。字典不保证元素按特定顺序排列。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-12T15:44:07.297

您不能按序数索引字典，因为项目在明显意义上没有序数，它仅将键公开为索引。字典也不保证顺序。添加密钥或删除密钥，就“内存位置”而言，该密钥将落在何处是***不确定的。***

如果您想通过序数索引获取内容，那么我猜您需要一个不同的集合而不是`Dictionary<>`.

也许一个`List<Tuple<string, string>>`？显然，这不会提供任何重复的支持，但它可以让您配对项目并为您提供索引。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-12T15:49:25.380

字典中项目的顺序是未定义的：http: [//msdn.microsoft.com/en-us/library/ekcfxy3x.aspx](http://msdn.microsoft.com/en-us/library/ekcfxy3x.aspx) 也就是值集合的顺序只保证与键的顺序相同，但 Dictionary 保留更改它们的权利。

其他选项：您可以查看旧的 NameObjectCollection - 它可以满足您的要求，但它早于泛型，因此它只是一个对象字典（如果您使用反射器查看 NameObjectCollection，您会看到它们做了同样的事情事情——他们真的实现了 2 个集合，一个 HashTable 和一个 List）。

您只能将它们存储在一个列表中，并使用 LINQ 进行搜索，但这是否是一个好的解决方案取决于您需要存储多少项目（字典查找是 O(1)，列表搜索将是 O(n)最好的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-12T15:46:17.613

使用 System.Linq 命名空间中的扩展函数，您可以执行以下操作：

```
var indexedDictionary = m_GermanEnglish.ToArray();
var pairAt0 = indexedDictionary[0]; 
```

您也可以使用`.ToList`扩展功能代替`.ToArray`. 它们都返回一个`KeyValuePair<TKey, TValue>`对象集合。

**注意：**字典中的条目可能不一定按照与它们输入的顺序相同的顺序进行排序。

如果您需要对字典中的键/值对保持一定的顺序，最好使用[SortedDictionary](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)或[SortedList](http://msdn.microsoft.com/en-us/library/ms132319)。在我的测试中，SortedList 在查找和按键索引方面往往快 2 倍，但 SortedDictionary 在删除条目时快 100 倍。

# qt - 无法在 QVBoxLayout 中调整小部件的大小

> ID：11000083
> 
> 赞同：2
> 
> 时间：2012-06-12T15:42:22.447
> 
> 标签：qt

我有一个带有 QVBoxLayout 的容器小部件。

我在 VBoxLayout 中添加了大约 100 个小部件。它们都具有相同的高度。在某些时候，需要调整其中一行的大小。我调整了小部件的大小（newWidth，newHeight）并在 QVBoxLayout 上调用 layout()，但没有任何变化。大小保持固定。

如何动态更改 QVBoxLayout 中小部件的高度？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T16:20:22.723

根据设计，插入布局中的小部件的大小调整是无操作的。布局大小的小部件，而不是你。

如果要在 QVBoxLayout 中使用固定高度的小部件，则必须设置小部件的最小和最大高度，并确保其 sizePolicy 在垂直方向上不被忽略。

如果您想要一个高度是所有其他小部件的两倍的小部件。将其拉伸设置为 2，并将其他小部件的拉伸设置为 1。调用`layout->setStretch(index, stretch)`. 小部件的宽度将与其伸展成比例。例如，所有拉伸为 1，一个拉伸为 2，拉伸为 2 的小部件将获得两倍的空间。

其他一切都相同（这是重要的一点！），拉伸与小部件的像素大小成正比。如果您愿意，假设所有小部件的高度为 20 像素，但有一个高度为 30 像素，只需像这样设置它们的拉伸。

如果布局具有精确的高度，以便所有小部件高度 + 间距 + 边距的总和加起来为布局高度，则布局中的小部件将得到 height=stretch。相反，如果您从布局高度开始，减去顶部和底部边距和 (widget count - 1)*spacing，您将获得小部件的高度。然后，您可以通过将拉伸设置为所需的高度来在小部件之间手动分配该高度。

`sizePolicy`如果默认情况下它们太大，您可能需要覆盖这些小部件。

# jquery - 如何在 Jquery 弹出窗口中显示标题？

> ID：11000084
> 
> 赞同：0
> 
> 时间：2012-06-12T15:42:24.023
> 
> 标签：jquery

我在这里有两个问题。

1.  如何显示弹出窗口的标题？
2.  如何在弹出窗口中向用户显示单选按钮。

目前我正在做如下所述。

```
$.prompt( "WARNING: Selected:'"+ $('[id$=Office]').val()+
           "' has both values, Please choose one.",
      {
    buttons: {                  
         'Small': 1,
         'Large': 2
     }, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:47:16.677

您最好将其切换为[jQuery Dialog](http://jqueryui.com/demos/dialog/)。你会得到你要求的所有功能。

# extjs - 如何在 ExtJs 中选择组合框值？

> ID：11000087
> 
> 赞同：5
> 
> 时间：2012-06-12T15:42:35.573
> 
> 标签：extjs, extjs3

我试图在加载到商店后简单地在下拉列表中选择一个项目。这不起作用：

```
Ext.getCmp('ddlModel').setValue(aircraftStore.getAt(0).data.ModelTypeCode); 
```

这会引发异常：

```
Ext.getCmp('ddlModel').selectByValue(aircraftStore.getAt(0).data.ModelTypeCode); 
```

这是一个例外：“this.view”为空或不是对象

任何人都知道如何在 ExtJs 中做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-13T19:50:44.820

我创建了一个函数来设置 ExtJs 中组合框的值：

```
function ComboSetter(comboBox, value) {
    var store = comboBox.store;
    var valueField = comboBox.valueField;
    var displayField = comboBox.displayField;

    var recordNumber = store.findExact(valueField, value, 0);

    if (recordNumber == -1)
        return -1;

    var displayValue = store.getAt(recordNumber).data[displayField];
    comboBox.setValue(value);
    comboBox.setRawValue(displayValue);
    comboBox.selectedIndex = recordNumber;
    return recordNumber;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T16:09:16.023

`Ext.getCmp('ddlModel').select(aircraftStore.getAt(0));`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-04T19:52:13.823

在许多情况下，您可能希望将组合框设置为某个索引。在 ExtJs 4.2 中，您可以这样做：

```
function setIndex(combobox, value)
{
    combobox.setValue(combobox.store.data.items[value].data.field1);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-18T22:14:16.067

就我而言，我需要获取组合框的 id，然后在 if 中进行比较，从而能够传递第二个窗口，使用此方法并且它有效。

```
var ValorSeleccionado = Ext.getCmp('cmb_tipoderol_usr').getValue(); // 'cmb_tipoderol_usr' is the id of the combobox. 
```

然后比较动作

```
if (ValorSeleccionado == 1 ) { Do Action } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-21T01:19:32.823

我认为正确的方法是使用此属性配置您的组合框：

```
autoSelect: true 
```

> true 选择数据存储收集的第一个结果（默认为 true）。除非 (typeAheadDelay) 的值为 true，否则 false 值将需要从下拉列表中手动选择以设置组件值

# asp.net-mvc-4 - MVC4 RC 脚本捆绑非常慢

> ID：11000093
> 
> 赞同：10
> 
> 时间：2012-06-12T15:43:14.650
> 
> 标签：asp.net-mvc-4

我今天将一个大型项目升级到 MVC4 RC 以尝试捆绑和缩小。

在我在部分视图中的脚本 src 标记中有 8 个静态 js 文件之前。示例页面始终在 0.1 秒内运行。

我添加了一个这样的包：

```
 bundles.Add(New ScriptBundle("~/bundles/mybundle").Include(
                "~/Resources/Core/Javascripts/jquery-1.7.1.min.js",
                "~/Resources/Core/Javascripts/jquery-ui-1.8.16.min.js",
                "~/Resources/Core/Javascripts/jquery.validate.min.js",
                "~/Resources/Core/Javascripts/jquery.validate.unobtrusive.min.js",
                "~/Resources/Core/Javascripts/jquery.unobtrusive-ajax.min.js",
                "~/Resources/Core/Javascripts/bootstrap.min.js",
                "~/Resources/Core/Javascripts/toolbar.js",
                "~/Resources/Core/Javascripts/jquery-ui-timepicker-addon.js")) 
```

在部分中，我添加了这个，页面加载时间增加到 0.5 秒，编译调试为真和假。@Scripts.Render("~/bundles/mybundle")

然后我用这样的 miniprofiler 包裹它：

```
 Dim profiler = MiniProfiler.Current
 Using profiler.Step("bundling")   
       @Scripts.Render("~/bundles/mybundle")
 End Using 
```

捆绑步骤始终需要 0.4 秒。

该计算机是在现代硬件上运行的 VS2010，具有高端 SSD 驱动器，并且没有运行非标准的后台任务。一旦我删除了@scripts.render，页面加载时间就会再次下降到 0.1 秒。

有没有办法让捆绑器缓存或者我错过了什么让它变得这么慢的东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-13T02:15:28.050

这是 ASP.NET MVC 4 RC 中捆绑的一个已知错误。捆绑未在服务器端缓存。

该错误在此处详细描述：http: [//todd-carter.com/post/2012/06/10/mini-me-fication-in-system-web-optimization-rc-is-evil/](http://todd-carter.com/post/2012/06/10/mini-me-fication-in-system-web-optimization-rc-is-evil/)

nuget MVC 4 RC 包应该在 2012 年 6 月 17 日结束的一周内的某个时间进行更新。（来源：[https](https://twitter.com/howard_dierking/status/212725872904507392) ://twitter.com/howard_dierking/status/212725872904507392 ）

# jstree - dnd，如何限制丢弃到某些节点类型？

> ID：11000095
> 
> 赞同：24
> 
> 时间：2012-06-12T15:43:19.830
> 
> 标签：jstree

我有 37 种不同的节点类型。我正在尝试实现拖放。这可行，但我需要准确限制可以拖动哪些类型以及可以删除它们的位置。不幸的是，我在文档中找不到任何有用的信息（http://www.jstree.com/documentation）。

到目前为止，我已经尝试了三种方法：

首先：根据节点类型在drag_check回调中定义true或false的返回值：

```
$("#demo1").jstree({
    "dnd" : {
        "drag_check" : function () { 
```

第二：绑定到 prepare_move.jstree 事件并根据节点类型返回 true 或 false 值：

```
.bind("prepare_move.jstree", function (e, data) {
   if (data.rslt.o.attr("typ") === "tpop") { 
```

第三：使用类型插件并在那里定义有效的孩子：

```
$("#tree").jstree( {
    "types": {
        "type_attr": "typ",
        "valid_children": ["ap_ordner_pop", "ap_ordner_apziel", "ap_ordner_erfkrit", "ap_ordner_apber", "ap_ordner_ber", "ap_ordner_beob", "iballg", "ap_ordner_ibb", "ap_ordner_ibartenassoz"],
        "types": {
        "ap_ordner_pop": {
            "valid_children": "pop"
        },
        "pop": {
            "valid_children": ["pop_ordner_tpop", "pop_ordner_popber", "pop_ordner_massnber"],
            "new_node": "neue Population"
        },
        "pop_ordner_tpop": {
            "valid_children": "tpop"
        } 
```

但我仍然可以在几乎任何地方删除大多数节点。这必须怎么做？或者你能给我举一个很好的例子吗？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2014-05-06T05:14:06.640

对于那些使用 jstree v3 寻找答案的人。crrm 插件已被删除，您将需要使用“ [check_callback](http://www.jstree.com/api/#/?q=check_callback&f=%24.jstree.defaults.core.check_callback) ”。

在我的情况下，我想做的就是阻止子项目被拖到*其他*子项目中。可能有更好的方法来做到这一点，但经过几个小时的进展，这对我有用。

我相信您还需要将“check_while_dragging”dnd 选项设置为 true，以便在拖动时触发“check_callback”。

这是我的 jsTree 初始化：

```
$("#jsTree").jstree({
            'core': {
                'data': window.treeData,
                'themes': {
                    'icons': false
                },
                'check_callback': function(operation, node, node_parent, node_position, more) {
                    // operation can be 'create_node', 'rename_node', 'delete_node', 'move_node' or 'copy_node'
                    // in case of 'rename_node' node_position is filled with the new node name

                    if (operation === "move_node") {
                        return node_parent.original.type === "Parent"; //only allow dropping inside nodes of type 'Parent'
                    }
                    return true;  //allow all other operations
                }
            },
            "state": { "key": "<%=Request.QueryString["type"]%>_infotree" },
            "dnd": {
                check_while_dragging: true
            },
            "plugins": ["state", "dnd", "types"]
        }) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-13T10:53:44.620

在目标上，您需要检查是否允许将对象放在那里。正如您所指出的，您似乎有某种机制可以闻到物体的味道：

```
 if (data.rslt.o.attr("typ") === "tpop") 
```

那挺好的。在执行多树操作时，使用该技术将一种对象类型与另一种对象类型区分开来。在下面的示例中，我使用来自源和目标的类名来进行我自己独特的“气味测试”。不要复制和粘贴，否则您会感到困惑。您需要使用自己的测试类型来接受/拒绝从一棵树拖放到另一棵树。我所有的测试都是在 crrm check_move 函数中完成的。

```
.jstree({
 "crrm" : {
    input_width_limit : 200,
    move : {
        always_copy     : "multitree", // false, true or "multitree"
        open_onmove     : false,
        default_position: "last",
        check_move      : function (m) { 
                            if(!m.np.hasClass("someClassInTarget")) return false;
                            if(!m.o.hasClass("someClassInSource")) return false;
                            return true;
                          }
    }
 },
 "dnd" : {
    copy_modifier   : $.noop,
    drop_target     : ".someWrapperClassInSource",
    drop_check      : function (data) { return true; },
    drop_finish     : function (data) {
                            $.jstree._reference(this.get_container()).remove($(data.o));
                      },
    drag_target     : ".someClassInSource",
    drag_finish     : function (data) {;},
    drag_check      : function (data) { return { after : false, before : false, inside : true }; }
 }, 
```

# windows-phone-7 - 市场测试套件错误地声明 ID_CAP_MICROPHONE

> ID：11000096
> 
> 赞同：3
> 
> 时间：2012-06-12T15:43:24.840
> 
> 标签：windows-phone-7, app-hub

我正在运行 Marketplace 测试套件以准备提交到 Marketplace，并且自动化测试声称我正在使用`ID_CAP_NETWORKING`和`ID_CAP_MICROPHONE`. 我没有在应用程序的任何地方使用麦克风或任何音频代码。

我已经仔细检查了 SDK 文件夹中 Rules.xml 中列出的项目的引用/代码，但找不到对其中任何一个的任何引用。

为什么 Marketplace 测试套件声称应用程序需要`ID_CAP_MICROPHONE`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T17:00:37.827

为了`ID_CAP_MICROPHONE`出现在您的应用程序上，您或第 3 方组件必须具有对[Microsoft.Xna.Framework.Audio.Microphone](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.audio.microphone.aspx)的引用。

因此，要么删除引用该类的代码，要么删除引用该类的第 3 方组件！

# resize - 当窗口调整大小时，如何避免 SplitPane 调整其中一个窗格的大小？

> ID：11000098
> 
> 赞同：26
> 
> 时间：2012-06-12T15:43:28.863
> 
> 标签：resize, javafx-2

我只想用鼠标手动拖动拆分器来调整窗格的大小。但是当窗口调整大小时，我希望该窗格保持我选择的确切大小。允许其他窗格自由更改大小。

你有什么办法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-06-13T13:57:49.810

您应该使用`SplitPane.setResizableWithParent`静态方法。

```
 SplitPane root = new SplitPane();

        final Pane paneFixed = new StackPane();
        paneFixed.getChildren().add(new Text("fixed"));

        SplitPane.setResizableWithParent(paneFixed, Boolean.FALSE);

        Pane paneFree = new StackPane();
        paneFree.getChildren().add(new Text("free"));

        root.getItems().addAll(paneFree, paneFixed);

        stage.setScene(new Scene(root, 300, 200));
        stage.show(); 
```

# php - 检测视频方向并在需要时自动旋转

> ID：11000107
> 
> 赞同：0
> 
> 时间：2012-06-12T15:43:55.523
> 
> 标签：php, video, ffmpeg, orientation, rotation

我正在寻找是否有可能获取视频的设备方向以检查它是否需要使用 ffmpeg 在 PHP 中旋转。

这甚至可能吗？我已经用图像很容易地做到了，但到目前为止我还没有找到任何帮助解决这个问题的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:50:57.700

设备方向是客户端属性，PHP 是严格的服务器端属性。快速谷歌搜索将我带到[这个页面](http://www.engageinteractive.co.uk/blog/2008/06/19/tutorial-building-a-website-for-the-iphone/)，其中有一个 iPhone 示例。作者提供了这个函数，在页面加载时调用：

```
function updateOrientation(){  
    var contentType = "show_";  
    switch(window.orientation){  
        case 0:  
            contentType += "normal";  
            break;  

        case -90:  
            contentType += "right";  
            break;  

        case 90:  
            contentType += "left";  
            break;  

        case 180:  
            contentType += "flipped";  
            break;  
    }  
    document.getElementById("page_wrapper").setAttribute("class", contentType);  
} 
```

CSS 被定义为处理`.show_normal`、`.show_right`和`.show_left`的样式`.show_flipped`

```
.show_normal,  
.show_flipped{  
   width:320px;  
}  
.show_left,  
.show_right{  
    width:480px;  
} 
```

如果您需要 PHP 中的方向值，您可以`window.orientation`通过 AJAX 将值发送到脚本。还有一个事件：`window.onorientationchange`只要方向改变就会触发。我相信窗口上的这两个属性都适用于 iPhone 和 Android 设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-07T17:16:32.383

```
exiftool -Rotation <filename> 
```

# python - 使用 Python 漂亮地打印无效的 JSON

> ID：11000114
> 
> 赞同：4
> 
> 时间：2012-06-12T15:44:10.933
> 
> 标签：python, json, pretty-print

有一种使用 Python 漂亮打印有效 JSON 的方法：[How can I pretty-print JSON in (unix) shell script?](https://stackoverflow.com/questions/352098/how-to-pretty-print-json-script)

然而 jsonlint.com 会漂亮地打印 JSON，即使有问题。

我想这样做，我正在使用 Python。有谁知道这样做的脚本？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T09:25:02.150

您可以在自己的脚本或它提供的工具中使用[demjson模块](https://github.com/dmeranda/demjson)`jsonlint.py`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-12T17:09:52.063

[@kelw](https://stackoverflow.com/users/1835/keiw)已经指出`demjson`，它适用于稍微无效的 JSON。对于我写的更不符合 JSON 的数据[`barely_json`](https://github.com/torfsen/barely_json)：

```
from barely_json import parse
from pprint import pprint

invalid_json = '[no, , {complete: yes}]'
data = parse(invalid_json)
pprint(data) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-11T09:57:30.677

尝试[使用 jsbeautifier](https://github.com/beautify-web/js-beautify)库来美化 JavaScript。它之所以有效，是因为 JSON“几乎”是 JavaScript 的子集。

```
import json
import jsbeautifier

invalid_json = '{"hello": "world",}'

json.loads(invalid_json)
# ValueError: Expecting property name: line 4 column 1 (char 25)

jsbeautifier.beautify(invalid_json)
# '{\n    "hello": "world",\n}' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T15:51:02.817

有一种使用 Python 的内置方法：

```
python -m json.tool myfile.json 
```

# c - 填埋场不工作 (c)

> ID：11000116
> 
> 赞同：0
> 
> 时间：2012-06-12T15:44:17.460
> 
> 标签：c, flood-fill

我的洪水填充功能无法正常工作时遇到了一些问题。此分配的目的是查看 P 和 C 在数组内是否连接。在洪水填充功能中，它似乎没有将“_”更改为“P”

样本输入

```
5 
1 2
PC
2 1
P
C
2 2
P#
#C
2 2
P_
C_
8 7
__P____
####_##
_____#_
_____#C
##_###_
_____#_
___#_#_
___#___
5 7
__P____
####_##
_____#_
_____#C
##_###_ 
```

代码

```
#include <stdio.h>
#define MAXC 10
#define MAXR 10

void floodfill(char map[][MAXC+1], int i, int j, int r, int c);
int checklocation(char map[][MAXC+1], int i, int j, int r, int c);

int main() {

    FILE* ifp = fopen("bunnies.in", "r");

    int numcases, loop;
    fscanf(ifp, "%d", &numcases);

    for (loop=0; loop<numcases; loop++) {

        int r, c, i=0, j=0;

        fscanf(ifp, "%d%d", &r, &c);
        //printf("\nRows = %d Cols = %d\n", r,c); //debug comment out
        char map[r][c];

        //Read in input
        for(i=0; i<r; i++) {

            map[i][j] = fgetc(ifp);

                for (j=0; j<c; j++) {
                    map[i][j] = fgetc(ifp);
                    //printf("%c", map[i][j]); //test input read comment out
                }
           // printf("\n"); //test input read comment out
        }

        int broken = 0; //to keep track if floodfill already occured

        for (i=0; i<r; i++) {

           // if (broken == 1)
            //    continue;

            for (j=0; j<c; j++) {

               // if (broken == 1)
                //    continue;

                //the whole loop only looks for P then floodfills
                if(map[i][j] == 'P') {
                    floodfill(map, i, j, r, c);
                 //   broken = 1;

                }

               // printf("%c", map[i][j]); //test floodfill, comment out later

            }

            //printf("\n"); //test floodfill, comment out later

        }

        int found = 0;

        //searches for C, calls checklocation when found
        for (i=0; i<r; i++) {
            for(j=0; j<c; j++) {
                if (map[i][j] == 'C')
                    found = checklocation(map, i,j, r, c);
            }
        }

        if (found == 1)
            printf("yes\n");
        else
            printf("no\n");

    }

fclose(ifp);
return 0;

}

//Pass map pointer, position in array i,j and row/column numbers
void floodfill(char map[][MAXC+1], int i, int j, int r, int c) {

//printf("looking at: [%d][%d]\n", i,j); //debug comment out later

//'base case' that deals with out of bounds
if (i<0 || j<0 || i>=r || j>=c)
    return;

if (map[i][j] != '_')
    return;

if (map[i][j] == '_')
    map[i][j] = 'P';

floodfill(map, r, c, i, j+1); //check right
floodfill(map, r, c, i, j-1); //check left
floodfill(map, r, c, i+1, j); //check below
floodfill(map, r, c, i-1, j); //check above

//printf("%c", map[i][j]);

}

//Same parameters as floodfill
int checklocation(char map[][MAXC+1], int i, int j, int r, int c) {

//these if statements check for p in each location around and
//makes sure the coordinate is in bounds
if (map[i-1][j] == 'P' && ((i>=0 && i < r) && (j>=0 && j < c)))
    return 1;

else if (map[i+1][j] == 'P' && ((i>=0 && i < r) && (j>=0 && j < c)))
    return 1;

else if (map[i][j+1] == 'P' && ((i>=0 && i < r) && (j>=0 && j < c)))
    return 1;

else if (map[i][j-1] == 'P' && ((i>=0 && i < r) && (j>=0 && j < c)))
    return 1;

else
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:56:21.767

你的`floodfill()`似乎坏了：

当您在 的位置调用它时`P`，以下检查

```
if (map[i][j] != '_')
    return; 
```

将立即返回而不做任何事情（就像`map[i][j]`那里一样`P`，不是`_`）

尝试：

```
if (map[i][j] == '_') {
  map[i][j] = 'P';

  floodfill(map, r, c, i, j+1); //check right
  floodfill(map, r, c, i, j-1); //check left
  floodfill(map, r, c, i+1, j); //check below
  floodfill(map, r, c, i-1, j); //check above
} 
```

这将改变当前位置，并且仅在需要时调用周围的洪水填充

请注意，这仍然会跳过初始 P，您可以通过在调用之前设置`map[i][j]`为`_`right`floodfill()`来修复它`main()`

此外，您似乎从输入中读取了太多信息：

```
map[i][j] = fgetc(ifp);
for (j=0; j<c; j++) {
  map[i][j] = fgetc(ifp);
  ... 
```

将为当前读取一个字符`i`并`j`再次读取一个字符。如果您在第一种情况下读取换行符，则不需要将其存储在 中`map[i,j]`，尤其是这样做会在第一次循环后更改地图`j`（现在具有值`c`）

此外，在 中`checklocation()`，您需要在检查元素之前检查边界情况`map`（正如 Gene 在评论中暗示的那样），否则您的边界检查毫无价值。

# php - 获取插入查询的最后一个 ID

> ID：11000119
> 
> 赞同：2
> 
> 时间：2012-06-12T15:44:40.237
> 
> 标签：php, mysql, insert, mysql-insert-id

我需要从最后一个插入中获取 story_id。我试过使用`mysql_insert_id()`，但它似乎不适用于我的陈述。这是代码：

```
$stmt = $this->db->prepare("INSERT INTO active_stories (story_id, current_chapter, creator, cover_title, cover_img_name, create_date, last_update_date, story_tags, locked) VALUES (NULL, ?, ?, ?, ?, ?, ?, ?, ?)");
        $stmt->bind_param("issssssi",$zero, $creatorName,$storyTitle, $fileName, $createDate, $createDate, $themeTags, $zero);
        $stmt->execute();
        printf("Last inserted record has id %d\n", mysql_insert_id());
        $stmt->close(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T15:46:30.930

如果您使用的是 PDO，以下[是如何获得它](http://php.net/manual/en/pdo.lastinsertid.php)：

```
PDO::lastInsertId() 
```

如果使用 mysqli，[试试这个](http://www.php.net/manual/en/mysqli.insert-id.php)：

```
mysqli::$insert_id 
```

# sql - 如何更新 DB2 中的前 100 行

> ID：11000120
> 
> 赞同：13
> 
> 时间：2012-06-12T15:44:40.667
> 
> 标签：sql, db2, ibm-midrange

我知道在标准 SQL 中你可以这样做：

```
update top (100) table1 set field1 = 1 
```

（参考：[如何更新 sql server 中的前 100 条记录](https://stackoverflow.com/questions/1198364/how-can-i-update-top-100-records-in-sql-server)）

但这在 DB2 中是不允许的。谁能告诉我如何在 DB2 中完成相同的结果？谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-12T16:08:34.040

这是可行的，虽然你可能不会得到你期望的结果......

首先，*永远记住*SQL 本质上是**UNORDERED**。这意味着*没有“顶”行之类的东西*，除非您明确定义您的意思。否则，您的结果是“随机的”（排序）。

无论如何，这*是*可行的，假设您在桌子上有某种唯一键：

```
UPDATE table1 SET field1 = 1
WHERE table1Key IN (SELECT table1Key
                    FROM table1
                    WHERE field1 <> 1
                    ORDER BY field1
                    FETCH FIRST 100 ROWS ONLY) 
```

*为什么*一次只想更新 100 行？你真正想解决什么样的问题？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T00:00:47.360

你可以使用`RRN`（如果你只是关心限制更新的数量）？

例如：

```
update mytable a set a.field = 'foo' where RRN(a) < 200 
```

# spring - Spring：类中的 Setter 方法是否会首先被 Spring 调用？

> ID：11000124
> 
> 赞同：0
> 
> 时间：2012-06-12T15:44:53.770
> 
> 标签：spring

我有一个关于 Spring 的问题，如果我的问题是一个愚蠢的问题，请原谅。请看这段代码

```
public class HomePageController extends AbstractController {

        private GeekNewsService service;

      protected ModelAndView handleRequestInternal(HttpServletRequest req, HttpServletResponse res) throws Exception {
      List<NewsArticle> articles = service.getArticleOverviews();
      return new ModelAndView( "home", "articles", articles );
     }

    public void setGeekNewsService( GeekNewsService service ) {
      this.service = service;
   }

} 
```

我的问题是，在 handleRequestInternal Method 内部，为什么在 service.getArticleOverviews() 这一行没有任何 NullPointerException ？（因为实际的对象创建将在 setMethod 的 SetterInjection 的帮助下发生）？？

Spring 中是否有任何规则，当一个类被调用时，必须首先调用 setXXX 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:48:11.030

是的，这是 Spring 给你的基本合同：在它返回任何 bean 之前，你保证这个 bean 是根据你的配置初始化的。换句话说，在完全初始化 bean（setter 注入、字段注入、构造后回调）之前，您将永远无法调用任何 bean 的任何业务方法。

# jquery - 像 mint.com 上的 jQuery 小部件

> ID：11000125
> 
> 赞同：1
> 
> 时间：2012-06-12T15:44:56.547
> 
> 标签：jquery, jquery-ui, user-interface

我在互联网上上下搜索了一个 jQuery 小部件，它的功能类似于 mint.com 上用于交易的功能。有没有这样的小部件可用？

对于那些不使用 mint.com 的人，它是一个下拉菜单，您可以单击并输入。当您输入时，它会搜索数据库中的内容，并根据您输入的内容为您提供一些选项中，如下所示：

![在此处输入图像描述](../Images/bd655d49bfbb91f3cab0801b26de97d1.png)

如果您真的不知道要输入什么，可以单击分类列表的下拉列表，如下所示：

![在此处输入图像描述](../Images/93c4465a87a819f384eecbfd413004a9.png)

有谁知道具有类似功能的 jQuery UX/UI 小部件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:47:15.297

[http://jqueryui.com/demos/autocomplete/](http://jqueryui.com/demos/autocomplete/)

你也可以让它使用 ajax 来获取数据库结果.. 它需要一点点调整才能让它完全按照我想要的方式工作，但它非常灵活，我并没有花那么长时间。绝对可以做到。

# mysql - 与 Not IN 上的语法错误有关的 Mysql 问题

> ID：11000126
> 
> 赞同：1
> 
> 时间：2012-06-12T15:45:00.197
> 
> 标签：mysql

```
select tf.Id,tf.Name,tf.LName,tf.Rank,tf.Category
where tf.Id not in (select fighter_id from tbl_player_fighter where league_id=91)
and  tf.Status ='1' 
```

这会引发语法错误。有关如何解决此问题的任何建议。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:46:36.613

您缺少 FROM 子句，因此它不知道要使用的主表。

# linux - 如何在 linux 中使用 sed 或 awk 编辑包含特定数字或字符串的行

> ID：11000128
> 
> 赞同：0
> 
> 时间：2012-06-12T15:45:02.977
> 
> 标签：linux, sed, awk, line, edit

我的Stress.k文件如下

```
180.4430
*INCLUDE
$# filename
*STRESS_INITIALIZATION 
*END 
```

我希望它像

```
180.4430
*INCLUDE
$# filename
*STRESS_INITIALIZATION 
*/home/hassan/534.k 
*END 
```

为此，我使用 sed 如下

```
a="$(cat flow.k)"
sed  -i -e '/*END/i \*/home/hassan/$a.k ' Stress.k 
```

where`flow.k`只有一个数字，例如 534.k 或 something 。这里 sed 将行放在前面，`END`但它不采用 a 的值，而是放置相同的字母并且它不理解`$a.k`。

还请告诉我如何删除倒数第二行或带有字符串 hassan 的行，以便我可以先删除它，下一步我用它来输入我需要的行。

如果可能，还请提出替代方案。

此致

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:51:42.217

bash 变量仅在双引号中被替换，例如

```
sed  -i -e "/*END/i \*/home/hassan/$a.k " Stress.k 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:39:41.383

使用双引号允许扩展变量。

```
sed  -i -e "/*END/i \*/home/hassan/$a.k " Stress.k 
```

要替换字符串，请按照您在文件中读取的内容进行操作：

```
a=$(sed 's/534/100/' flow.k) 
```

删除一行：

```
sed '/hassan/d' inputfile 
```

在当前行之后将文件读入流：

```
sed '/foo/r filename' inputfile 
```

# ios - 谁能用 MKMapView::mapRectThatFits 解释这些不准确之处

> ID：11000129
> 
> 赞同：0
> 
> 时间：2012-06-12T15:45:04.380
> 
> 标签：ios, ios5, mkmapview, mapkit

使用 MKMapView::mapRectThatFits 时出现奇怪的错误。如果我传入一个比它更高的 MKMapRect，我希望 mapRectThatFits 返回一个具有相同水平跨度的新 MapRect，但增加了垂直跨度以使其适合 mapView，但是我注意到 MKMapView 添加到水平跨度以及垂直。

![在此处输入图像描述](../Images/8e66a8508dc1f204133a16ce1d50da60.png)

这种不准确性似乎随着坐标区域尺寸的增加而增加。在几百米处，精度可以忽略不计，但在 1.5 公里处，差异为 0.0006，这是显着的。

我尝试使用 mapRectThatFits:edgePadding 并将边缘填充设置为零和 regionThatFits 但两者都导致相同的不准确性。

```
MKCoordinateRegion combinedRegion = self.models.locationModelsCoordinator.coordinateRegion;
NSLog(@"Before %f", combinedRegion.center.longitude - (combinedRegion.span.longitudeDelta * 0.5)); // Logs -0.103473

MKMapRect combinedRect = [ELMapKitUtils mapRectForCoordinateRegion:combinedRegion];
// If I convert combinedRect back to an MKCoordinateRegion here I can verify it is unaltered, so there is no issue with my conversion code.
MKMapRect focusRect = [self.mapView mapRectThatFits:combinedRect];

MKCoordinateRegion regionFittedToMapView = MKCoordinateRegionForMapRect(focusRect);
NSLog(@"After %f", regionFittedToMapView.center.longitude - (regionFittedToMapView.span.longitudeDelta * 0.5)); // Logs -0.104107 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T18:12:24.347

这是因为您有位图图块。今天的 MapKit 适应了位图块的全尺寸，因此在水平方向上显示更宽的区域。如果 MapKit 确实使用了基于矢量的图块，它可能会在未来的版本中使用，正如昨天在主题演讲中所展示的，它不会受到位图图块问题的限制。

MapKit 今天没有解决方法。我没有看 bing Maps 或 Routeme。你应该。

# php - 使用 drupal_write_record 做 insert_or_update

> ID：11000132
> 
> 赞同：1
> 
> 时间：2012-06-12T15:45:14.230
> 
> 标签：php, drupal, drupal-schema

好的，所以我读到了`drupal_write_record`，它显然是一个执行 insert_or_update 的函数。

但是，从我读到的内容来看，它本身并不知道是进行插入还是更新，但这取决于第三个参数的存在（或不存在）：`$primary_keys`默认为`array()`. 这是真的？我是否必须先选择记录，看看是否存在，然后将第三个参数传递给`drupal_write_record`？

我问这个，因为我通常如何执行插入或更新功能是根据主键进行选择，如果该行存在，那么我必须进行更新，如果不存在，则插入。这不是行之有效的方式`drupal_write_record`吗？

顺便说一下，使用 Drupal 7.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:56:15.243

根据文档：

> **$primary_keys：**表示这是要插入的新记录，省略此参数。如果这是更新，则此参数指定主键的字段名称。如果key中只有1个字段，可以传入一个字符串；如果键中有多个字段，则传入一个数组。

来源：[drupal_write_record API 文档](http://api.drupal.org/api/drupal/includes!common.inc/function/drupal_write_record/7)

如果第三个参数`$primary_keys`-- 是一个包含主键字段名称的数组，那么它将尝试更新现有记录。如果您省略 value `$primary_keys`，它将默认为一个空数组，这意味着它将插入一条具有自己唯一 ID 的新记录。

# javafx-2 - Java Fx 中场景区域的视口

> ID：11000133
> 
> 赞同：1
> 
> 时间：2012-06-12T15:45:17.700
> 
> 标签：javafx-2

我有一个带有 Region 元素作为 ist 父元素的 JavaFx 场景。假设我希望该区域具有 20.000x20.000 像素的定义大小，但只有一个大小为 1024x768 的窗口。

如何让我的场景显示 x 像素 5.000 和 y 像素 3.000 的区域区域，就像 ImageView 类的视口一样？这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T17:15:37.590

将您的区域放在[ScrollPane](http://docs.oracle.com/javafx/2/api/javafx/scene/control/ScrollPane.html)中。

# sql - 使用连接计算数据库项目

> ID：11000138
> 
> 赞同：0
> 
> 时间：2012-06-12T15:45:39.683
> 
> 标签：sql, ormlite

使用 ORMLite，我想计算符合特定条件的数据库项目的数量。我的数据库的简化版本如下：

```
Employee Table:
 employeeId
 departmentId

Department Table:
 departmentId

Salary Table:
 employeeId
 payGrade 
```

假设我想计算具有特定薪酬等级的部门子集的员工人数。当我尝试以下类似操作时，我得到一个异常报告，只允许一个选择列。

```
salaryQB.selectColumns(salaryQB.EMPLOYEE_ID);
salaryQB.where().eq(salaryQB.PAY_GRADE, 12);
employeeQB.where.in(Employee.DEPARTMENT_ID, departmentList)
      .and().in(employeeQB.EMPLOYEE_ID, salaryQB);

employeeQB.setCountOf(true);
count = dao.countOf(employeeQB.prepare()); 
```

但是这样的代码会返回以下错误：

> RuntimeException（java.sql.SQLException：内部查询必须只指定 1 个选择列而不是 2 个）

除了编写原始 SQL 查询之外，还有什么方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:13:47.500

人力资源管理系统。我看不出你的代码有任何问题@Jeff。我已经改进了[ORMLite](http://ormlite.com/)中的异常消息以显示未来的实际字段名称，但这对您现在没有帮助：

> 内部查询必须只指定 1 个选择列而不是 2 个：[id, foreign]

`selectColumns(...)`该消息 [显然] 试图告诉您您在`salaryQB`inner中指定了多个`QueryBuilder`。但是您似乎只在这里选择一列：

```
salaryQB.selectColumns(salaryQB.EMPLOYEE_ID); 
```

我没有看到在哪里`salaryQB`定义，但也许在其他地方还有一些代码也在使用`selectColumns`？我试图在[单元测试](http://goo.gl/rUHSO)`testInnerCountOf()`底部的方法中重现错误，但它似乎工作正常。[`QueryBuilderTest`](http://goo.gl/rUHSO)

如果您可以在单元测试中重现此内容，或者您​​可以看到我的单元测试与您的配置有何不同，请告诉我。

**编辑：**

从 4.22 版（从 9/2012 开始），[ORMLite](http://ormlite.com/)现在支持简单的 JOIN 语句。因此，您的查询可以简化为：

```
salaryQB.where().eq(salaryQB.PAY_GRADE, 12);
employeeQB.join(salaryQB);
employeeQB.where().in(Employee.DEPARTMENT_ID, departmentList);
employeeQB.setCountOf(true);
count = dao.countOf(employeeQB.prepare()); 
```

# java - 如何在 JDK 1.4 的默认浏览器中打开 html 文件

> ID：11000146
> 
> 赞同：0
> 
> 时间：2012-06-12T15:46:09.750
> 
> 标签：java, browser, jdk1.4

我看到很多关于如何在默认浏览器中打开 HTML 文件的 JDK 1.6 注释，但没有关于 JDK 1.4 的注释。

有没有人有这方面的经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:49:13.493

[browserlaunch2](http://browserlaunch2.sourceforge.net/)过去曾为我工作过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:00:54.820

您可以使用与 1.6 版相同的代码，只需添加对[JDesktop 集成](http://java.net/projects/jdic)jar 的引用。我认为（但我不是 100% 确定）这实际上与您使用 Java 1.6 获得的库相同，它是 Sun 在将它们包含在 Jdk 1.6 之前作为一个单独的项目开发的。

# c# - 没有使用委托多线程修复读取，也没有弹出表单

> ID：11000153
> 
> 赞同：0
> 
> 时间：2012-06-12T15:46:20.430
> 
> 标签：c#, .net, delegates, serial-port

我需要使用从串行端口接收到的字符串更新 Windows 窗体标签。我已经编写的代码有两个问题。

因为串口的读取需要另一个线程，所以我使用委托方法来更新标签文本。

第一个问题是当我启动程序时表单窗口不会打开（当我不调用时它会打开`initSerialPort()`）`Form1_Load()`。

`Debug.Write(message)`第二个问题是我打电话时`_self.SetText(message)`似乎没有到达`Read()`。当我注释掉`_self.SetText(message)`它时，它会记录消息，但也不会打开表单窗口，因为`initSerialPort()`它被调用了`Form1_Load()`

我是 C# 的菜鸟，你知道的；）

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO.Ports;
using System.Threading;
using System.Diagnostics;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        delegate void SetTextCallback(string text);

        private static SerialPort _serialPort;
        private static Boolean _continue;
        private static StringComparer stringComparer = StringComparer.OrdinalIgnoreCase;
        private static Thread readThread = new Thread(Read);
        private static Form1 _self;
        private static Label _lbl;

        public Form1()
        {
            InitializeComponent();
            _self = this;

            _lbl = label1;

        }

        private void Form1_Load(object sender, EventArgs e)
        {
            initSerialPort();
        }

        public void setMessage(string mes)
        {
            label1.Text = mes;
        }

        private static void initSerialPort()
        {
            // Create a new SerialPort object with default settings.
            _serialPort = new SerialPort("COM3", 9600, Parity.None, 8, StopBits.One);

            // Set the read/write timeouts
            _serialPort.ReadTimeout = 500;
            _serialPort.WriteTimeout = 500;

            _serialPort.Open();
            _continue = true;
            readThread.Start();

            readThread.Join();
            _serialPort.Close();
            _serialPort = null;
        }

        public static void Read()
        {
            Debug.Write("testread");
            while (_continue)
            {

                try
                {
                    String message = _serialPort.ReadLine();

                    _self.SetText(message);

                    Debug.Write(message);

                }
                catch (TimeoutException) { }

            }
        }

        private void SetText(string text)
        {
            // InvokeRequired required compares the thread ID of the
            // calling thread to the thread ID of the creating thread.
            // If these threads are different, it returns true.
            if (this.label1.InvokeRequired)
            {
                SetTextCallback d = new SetTextCallback(SetText);
                this.Invoke(d, new object[] { text });
            }
            else
            {
                this.label1.Text = text;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:48:54.453

不要`Join`对您创建的新线程。这将阻塞线程，直到您的`Read`方法完成，这意味着它永远不会完成。

# php - SQL - 根据从先前查询中选择的行将新记录插入表中

> ID：11000160
> 
> 赞同：0
> 
> 时间：2012-06-12T15:46:40.430
> 
> 标签：php, javascript, jquery, sql

如果我完全不正确地处理这个问题，我希望有人可以帮助我或指出正确的方向。

我的目的是根据特定标准从数据库中选择符合条件的用户。在页面上返回和显示的那些中，管理员用户应该能够从这些用户中进行选择并将它们添加到数据库中的另一个表中，这一次是附加费用的。

我处于正确显示用户的位置，并且已将费用附加到复选框的值，但我似乎无法弄清楚如何将用户重新输入新表。

我希望下面的代码示例足够清晰，以帮助阐明我的目标。

我意识到这可能不是最有效的方法。欢迎任何建议或意见。

谢谢！

PHP 选择符合条件的用户

```
$sql = $db->prepare("       
        SELECT *
        FROM users                                              
        WHERE user_registration = 1
        ");
$sql ->execute();
$users = $sql ->fetchAll(PDO::FETCH_OBJ); 
```

HTML & PHP 用复选框显示符合条件的用户

```
<table>
    <thead>
        <th class="checked">Select</th>                            
        <th>First Name</th>
        <th>Last Name</th>
        <th>Birth Date</th>
        <th>Fee</th>
    </thead>

    <tbody>

    <?php foreach($users as $entry): ?>

        <tr>
            <td class="checked">
                <input type="checkbox" name="checked" value="<?php echo $entry->fee; ?>"/> 
            </td>
            <td class="first-name"><?php echo $entry->first_name; ?></td>
            <td><?php echo $entry->last_name; ?></td>
            <td><?php echo $entry->birthdate; ?></td>
            <td><?php echo $entry->fee; ?></td>                                     
        </tr>
    <?php endforeach; ?>

    </tbody>
</table> 

<div id="total" name="total">$0
</div> 
```

JS计算每个用户的费用

```
$(document).ready(function() {

    $('.option').click(function(){

        var total = 0;

        $('.option:checked').each(function(){

            total += parseInt($(this).val());

        });

        $('#total').html('$' + total);

    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:51:47.730

代替

```
<input type="checkbox" name="checked" value="<?php echo $entry->fee; ?>"/> 
```

做

```
<input type="checkbox" name="checked" value="<?php echo $entry->id; ?>"/> 
```

然后，当检查一个复选框并提交表单时，您拥有该用户的ID，您可以做一个简单的

```
INSERT INTO table2
SELECT FROM table1 WHERE table1.id IN (/* Your comma separated IDs here*/) 
```

# c++ - 在 Linux 中使用 g++ 进行 OCCI 编译

> ID：11000163
> 
> 赞同：0
> 
> 时间：2012-06-12T15:46:50.843
> 
> 标签：c++, oracle, g++, occi

我正在尝试使用 OCCI 库编译一个基本程序。

编译任务OK。

```
g++ -I. -g -I/opt/oracle/product/10.2.0/db_1/precomp/public -I/opt/oracle/product/10.2.0/db_1/rdbms/public -I/opt/oracle/product/10.2.0/db_1/rdbms/demo -I/opt/oracle/product/10.2.0/db_1/plsql/public -I/opt/oracle/product/10.2.0/db_1/network/public -DMAX_SEND_SIZE=2000   -c -o test.o test.cpp 
```

输出OK，生成test.o。但是，当我想链接目标文件时，使用以下命令，

```
g++ -L/opt/oracle/product/10.2.0/db_1/lib/ -lclntsh -locci -o test test.o 
```

链接任务失败，输出为：

```
 test.o: In function `main':
/home/xxx/occi/test.cpp:128: undefined reference to `oracle::occi::Environment::createEnvironment(oracle::occi::Environment::Mode, void*, void* (*)(void*, unsigned int), void* (*)(void*, void*, unsigned int), void (*)(void*, void*))'
/home/xxx/occi/test.cpp:170: undefined reference to `oracle::occi::Environment::terminateEnvironment(oracle::occi::Environment*)'
/home/xxx/occi/test.cpp:158: undefined reference to `oracle::occi::SQLException::~SQLException()'
/home/xxx/occi/test.cpp:158: undefined reference to `oracle::occi::SQLException::SQLException(oracle::occi::SQLException const&)'
/home/xxx/occi/test.cpp:163: undefined reference to `oracle::occi::SQLException::what() const'
/home/xxx/occi/test.cpp:158: undefined reference to `oracle::occi::SQLException::~SQLException()'
test.o:(.gcc_except_table+0xe0): undefined reference to `typeinfo for oracle::occi::SQLException'
collect2: ld returned 1 exit status 
```

我的环境简历：

*   Ubuntu Linux 11.04
*   gcc 版本 4.6.1 (Ubuntu/Linaro 4.6.1-9ubuntu3)
*   ORACLE_HOME = /opt/oracle/product/10.2.0/db_1
*   LD_LIBRARY_PATH = /opt/oracle/product/10.2.0/db_1/lib
*   甲骨文版本：10.2.0

你能帮我吗？，我真的需要在 Linux 中使用 OCCI 创建到 Oracle 的连接，我不想使用 Pro*C。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T03:10:52.917

要使用 OCCI，您需要安装 Oracle 提供的 Instant Client（您安装了吗？）。我使用的是 Oracle 11.2，所以我的包含目录路径是 /usr/include/oracle/11.2/client64，我的共享库是 /usr/lib/oracle/11.2/client64/lib。

我看到这里

```
http://173.255.217.246:8000/mapnik_trac/wiki/OCCI 
```

10.2 路径是 /usr/lib/oracle/10.2.0.4/client/include 和 /usr/lib/oracle/10.2.0.4/client/lib

在 11.2 中，我还需要先将 nnz11 lib 链接为[http://xme.im/connect-oracle-database-eclipse-linux-using-occi](http://xme.im/connect-oracle-database-eclipse-linux-using-occi)

这是一篇关于 Instant Client 的有用博客描述[http://oradim.blogspot.com/2009/08/getting-started-with-occi-linux-version.html](http://oradim.blogspot.com/2009/08/getting-started-with-occi-linux-version.html)

# objective-c - 我应该在这里将 __block 变量设置为 nil 吗？为什么？

> ID：11000167
> 
> 赞同：0
> 
> 时间：2012-06-12T15:47:00.650
> 
> 标签：objective-c, automatic-ref-counting

这是[为什么我们必须将 __block 变量设置为 nil？](https://stackoverflow.com/questions/10998149/why-do-we-have-to-set-block-variable-to-nil)

基本上使用块会导致 ARC 中的保留周期，我仍然不太明白为什么

[http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011226-CH1-SW11](http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011226-CH1-SW11)

```
-(void)getReviewAndView{
    if(![[GrabClass grab] cekInet]){return;}
    CM(@"get review and view");
    self.viewlbl.text=@"0 view";
    self.reviewlbl.text=@"0 review";

    Business * businessReviewed = [BNUtilitiesQuick currentBusiness];

    NSString *alamat=[NSString stringWithFormat:@"http://...",businessReviewed.ID];

    CLog(@"alamat:%@", alamat);

    __block NSDictionary * dic = nil;

    [Tools doBackground:^{
        dic=(NSDictionary *)[GrabClass JsonParser:alamat]; //dic get set here
        [Tools doForeGround:^{
            NSString *countView= [[dic objectForKey:businessReviewed.ID] objectForKey:@"CountViews"];

            CLog(@"countView:%@", countView);
            NSString *countReview=[[dic objectForKey:businessReviewed.ID] objectForKey:@"Review"]; //dic get used here
            NSString * reviews=@"review";
            NSString * view=@"view";

            //blablabla

            self.viewlbl.text=[NSString stringWithFormat:@"%@ %@",countView,view ];
            self.reviewlbl.text=[NSString stringWithFormat:@"%@ %@",countReview,reviews];
            dic =nil; //should this be called? What happen if it doesn't?
        }];
    }];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:56:32.860

如果您不知道是否有保留周期，您应该在 Instruments 中的“泄漏”工具下运行您的代码，它会告诉您任何泄漏或保留周期。

另请注意，在最新版本的 Xcode 中，如果您创建这些父/块循环之一，编译器将为您生成警告。

在你的情况下，你*可能*不需要担心。`dic`不保留引用它的块，所以这里没有循环。但最好的检查方法是使用泄漏/分配工具。

# c# - 数组赋值给字符串

> ID：11000172
> 
> 赞同：-5
> 
> 时间：2012-06-12T15:47:20.920
> 
> 标签：c#, php, c#-4.0

我有 php 代码将一些值放入数组中，如下所示：

```
$hunter=addslashes($MessageArray[1]);
$time=addslashes($MessageArray[2]); 
```

我用 C# 编写了相同的代码，想知道它是否正确。

```
string Hunter = Messagearray[1].tostring();
string time = Messagearray[2].tostring(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:50:05.733

正如詹姆斯提到的，使用帕斯卡套管：

```
string hunter = messageArray[1].ToString();
string time = messageArray[2].ToString(); 
```

此外，C# 数组的索引从 0 开始。您可以在 PHP 中更改数组的起始索引，但在 C# 中不能。也许您*确实*希望参加第 2 项和第 3 项，但请记住这一点。你可能想要：

```
string hunter = messageArray[0].ToString();
string time = messageArray[1].ToString(); 
```

就目前`addslashes()`而言，这将取决于您对`hunter`and的使用`time`。如果您在 SQL 语句中使用它们，还有其他方法可以实现 PHP 的`addslashes()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:58:55.570

从[这里截取](http://www.digitalcoding.com/Code-Snippets/C-Sharp/C-Code-Snippet-AddSlashes-StripSlashes-Escape-String.html)

```
public static string AddSlashes(string input)
{
    return System.Text.RegularExpressions.Regex.Replace(input, @"(\\)([\000\010\011\012\015\032\042\047\134\140])", "$2");
} 
```

用法：

```
//
        var Messagearray = new object[] { "item 0", 1 };
        var hunter = AddSlashes(Messagearray[0].ToString());
        var time = AddSlashes(Messagearray[1].ToString()); 
```

# php - PHP cURL 错误 URL 格式不正确

> ID：11000174
> 
> 赞同：2
> 
> 时间：2012-06-12T15:47:35.780
> 
> 标签：php, curl

我正在尝试将简单的 cURL 文件从一台服务器上传到另一台服务器。问题是我从 cUrl 错误代码中得到错误 #3：URL 格式不正确。

我已将 url 复制到我的浏览器中并毫无问题地登录到 ftp 站点。我还验证了正确的格式，并在网上和这个网站上搜索了答案，但没有成功。

这是代码：

```
$ch = curl_init();

$localfile = '/home/httpd/vhosts/homeserver.com/httpdocs/admin.php';  
echo $localfile;  //This reads back to proper path to the file
$fp = fopen($localfile, 'r');
curl_setopt($ch, CURLOPT_URL, 'ftp://username:password@199.38.215.1xx/');
curl_setopt($ch, CURLOPT_UPLOAD, 1);
curl_setopt($ch, CURLOPT_INFILE, $fp);
curl_setopt($ch, CURLOPT_INFILESIZE, filesize($localfile));
curl_exec ($ch);
$error_no = curl_errno($ch);
curl_close ($ch);
if ($error_no == 0) {
  $error = 'File uploaded succesfully.';
} else {
  $error  = 'Upload error:'.$error_no ;//Error codes explained here http://curl.haxx.se/libcurl/c/libcurl-errors.html';
}
echo $error; 
```

我也试过这个：

```
curl_setopt($ch, CURLOPT_URL, 'ftp://199.38.215.1xx/');
curl_setopt($ch, CURLOPT_USERPWD, 'username:password'); 
```

我仍然收到错误＃3。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T18:13:15.150

您的远程 URL 需要包含目标文件的路径和名称，如本[示例所示](http://curl.haxx.se/libcurl/php/examples/ftpupload.html)

```
<?php
// FTP upload to a remote site Written by Daniel Stenberg
// original found at http://curl.haxx.se/libcurl/php/examples/ftpupload.html
//
// A simple PHP/CURL FTP upload to a remote site
//

$localfile = "me-and-my-dog.jpg";
$ftpserver = "ftp.mysite.com";
$ftppath   = "/path/to";
$ftpuser   = "myname";
$ftppass   = "mypass";

$remoteurl = "ftp://${ftpuser}:${ftppasswd}@${ftpserver}${ftppath}/${localfile}";

$ch = curl_init();

$fp = fopen($localfile, "rb");

// we upload a JPEG image
curl_setopt($ch, CURLOPT_URL, $remoteurl);
curl_setopt($ch, CURLOPT_UPLOAD, 1);
curl_setopt($ch, CURLOPT_INFILE, $fp);

// set size of the image, which isn't _mandatory_ but helps libcurl to do
// extra error checking on the upload.
curl_setopt($ch, CURLOPT_INFILESIZE, filesize($localfile));

$error = curl_exec($ch);

// check $error here to see if it did fine or not!

curl_close($ch); 
?> 
```

# html - 如何让 textarea 占据 div 中的剩余高度？

> ID：11000177
> 
> 赞同：3
> 
> 时间：2012-06-12T15:47:50.563
> 
> 标签：html, css, image, styles, textarea

我有一组如下代码。关键是要在 div 中放置一组图像，并且 div 的其余部分填充文本区域。如果我将高度设置为 100%，它将使其高度相同，这不是 (div.height - images.height) 并使文本区域更长。

它在 w3c 上说`inherit`目前不起作用，`auto`只会创建一个默认的 textarea，并且硬编码它永远不会完成它，因为 div 可能更大或更小。

你们都做了什么来做到这一点？

```
<div id = "parent">
  <div id = "images" style="background-color:#99ccff;">
    <img style = "padding:0px; border:0px;" src = "..." />
    <img style = "padding:0px; border:0px;" src = "..." />
    <img style = "padding:0px; border:0px;" src = "..." />
    <img style = "padding:0px; border:0px;" src = "..." />
    <img style = "padding:0px; border:0px;" src = "..." />
    <img style = "padding:0px; border:0px;" src = "..." />
    <img style = "padding:0px; border:0px;" src = "..." />
  </div>
  <textarea style="width:100%; height:100%; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" >
  </textarea>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:08:40.000

可能是你的浏览器有问题。我刚试过你的代码，似乎做了你想做的事：http: [//jsfiddle.net/Rorok_89/DMdyY/1/](http://jsfiddle.net/Rorok_89/DMdyY/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T18:19:23.550

我不太擅长使用它，但你不妨试试 display:box;。我在[这里有一个例子](http://jsfiddle.net/Kyomu/atTK7/2/embedded/result/)，它可以做（我认为）你想要的，但是“主要错误”是你不能再重新调整 textarea 的大小（但如果那不是问题，你可以改变 resize:none;）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T18:31:26.377

似乎不可能在 chrome 以外的其他浏览器中实现这种行为。

我尝试将图片和文本区域拆分为两个 CSS 表格行以提供`#images`高度，以便`#textarea-container`自动调整其高度。下一步是给 textarea 100% 的高度和 100% 的宽度。

*不支持在相对定位的表格单元格中对元素进行绝对定位*：
[HTML 表格内的 CSS 定位](https://stackoverflow.com/questions/1280115/css-positioning-inside-of-an-html-table)

所以`textarea { position: absolute; left:0;right:0;bottom:0;top:0 }`在相对定位的表格单元格中将不起作用。

**HTML**

```
<div id ="parent">
    <div id="images">
        <img src="http://www.dummyimage.com/100x20/cc5acc/fff.png" />
        <img src="http://www.dummyimage.com/80x20/cc5acc/fff.png" />
        <img src="http://www.dummyimage.com/20x20/cc5acc/fff.png" />
        <img src="http://www.dummyimage.com/80x20/cc5acc/fff.png" />
        <img src="http://www.dummyimage.com/100x20/cc5acc/fff.png" />
        <img src="http://www.dummyimage.com/120x20/cc5acc/fff.png" />
        <img src="http://www.dummyimage.com/50x20/cc5acc/fff.png" />
    </div>

    <div id="textarea-container">
        <textarea></textarea>    
    </div>    
</div>​ 
```

**CSS**

```
* { margin:0; padding: 0 }

#parent{
    width: 400px;
    height: 300px;
    display: table;
    background: blue;
}
#images {
    display: table-row;
    height: 0;
}

#textarea-container {
    display: table-row;
}

textarea {
    height: 100%;
    width: 100%;
} 
```

**！**此解决方案取决于`display: table`和`display: table-row`Google Chrome。

**现场演示（仅适用于谷歌浏览器）**：http: [//jsfiddle.net/atTK7/4/](http://jsfiddle.net/atTK7/4/)
**显示表支持**：[http ://www.quirksmode.org/css/display.html](http://www.quirksmode.org/css/display.html)

建议使用除 chrome 之外的浏览器的 Javascript 解决方法。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-12T16:04:45.713

即使我不清楚你想做什么，你也可以使用 jQuery 来帮助你获取实际元素的大小，并强制你的 textarea 扩大或缩小。这应该可以帮助您：

```
<script type="text/javascript">
var max_div_height = 1000; //The max height of your div in pixels
var total_div_height = 0 // The total height of your divs combined
jQuery(".container").each(function(){
    var context = $(this);
    var height = context.height();
    total_div_height+=height; //If it's width, set height otherwise
});
var textarea_size = max_div_height - total_div_height;
jQuery("#myTextarea").css("height", textarea_size+"px") // Give an ID to your textarea
</script> 
```

# google-maps-api-3 - google.maps.MarkerShape 未加载

> ID：11000178
> 
> 赞同：4
> 
> 时间：2012-06-12T15:47:52.523
> 
> 标签：google-maps-api-3

我正在尝试使用 google maps api（最新版本，3.9.2）创建一个 MarkerShape 对象。不幸的是，似乎没有加载 MarkerShape api：这是 firebug 的控制台向我显示的内容：

> >>> google.maps.version
> 
> “3.9.2”
> 
> >>> google.maps.MarkerShape
> 
> 不明确的

难道我做错了什么 ？MarkerShape 的 gmaps 文档的最新版本在这里：[https ://developers.google.com/maps/documentation/javascript/reference#MarkerShape](https://developers.google.com/maps/documentation/javascript/reference#MarkerShape)

谢谢

编辑：这里是 jsfiddle 的一个例子：http: [//jsfiddle.net/vszHk/6/](http://jsfiddle.net/vszHk/6/)或者只是去一个官方的例子，比如这里[https://google-developers.appspot.com/maps/documentation/javascript/examples/地图简单](https://google-developers.appspot.com/maps/documentation/javascript/examples/map-simple)和开放的萤火虫

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-31T07:46:31.727

我认为您的问题是您试图将 google.maps.MarkerShape 视为构造函数。它只是一个对象，而不是构造函数。

因此，执行以下**操作是错误**的，因为 google.maps 对象中没有 MarkerShape 方法：

```
var marker_shape = new google.maps.MarkerShape(); 
```

要创建 MarkerShape，您只需创建一个对象文字：

```
var marker_shape = {coords: [0,0,50,50], type: "rect"} 
```

然后，您可以将其添加到传递给 google.maps.Marker 构造函数的对象文字中。例如。

```
marker = new google.maps.Marker({
    position: lat_lng_object,
    map: map,
    shape: marker_shape
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:07:25.803

鉴于 3.9.2 是最新的 Nightly 版本，您是否尝试过参考更旧的更稳定版本，例如 3.9.1 或 3.8（最新发布版本）

[https://developers.google.com/maps/documentation/javascript/basics#Versioning](https://developers.google.com/maps/documentation/javascript/basics#Versioning)

例如[http://maps.googleapis.com/maps/api/js?v=3.8&sensor=false](http://maps.googleapis.com/maps/api/js?v=3.8&sensor=false)

# iphone - 在后台线程中进行 ftp 请求时发生内存泄漏

> ID：11000185
> 
> 赞同：0
> 
> 时间：2012-06-12T15:48:09.760
> 
> 标签：iphone, objective-c, memory-management, memory-leaks

我正在开发一个应用程序，它可以通过 ftp 请求从服务器下载图像然后显示它们。ftp 请求在后台运行。下载完成后，将向视图发送更新消息。

```
I encountered a memory leak when doing the ftp request which has the following features:
1\. The memory leak do not happen every time. May be 1 / 7.
2\. If I do the ftp request on the main thread, everything is OK.
3\. If I do the ftp request on simulator, everything is OK. 
```

我使用[SIMPLEFTP](http://developer.apple.com/library/ios/#samplecode/SimpleFTPSample/Listings/Read_Me_About_SimpleFTPSample_txt.html)来完成 ftp 工作，并且我做了一些修改来修复我的请求。

在 FtpListService.m 中，该文件用于请求一个文件列表信息（名称、大小、修改日期）。这里发生了内存泄漏（我用“####”突出显示了这一行）。

```
//This is the method to start a ftp request
- (void)_startReceive
// Starts a connection to download the current URL.
{
    BOOL                success;
    NSURL *             url;
    CFReadStreamRef     ftpStream;

    //don't tap receive twice in a row!
    assert(self.networkStream == nil);     

    // First get and check the URL.
    self.InputUrl = [self.InputUrl stringByAddingPercentEscapesUsingEncoding:NSASCIIStringEncoding];
    url = [FtpUtil smartURLForString:self.InputUrl];
    success = (url != nil);

    // If the URL is bogus, let the user know.  Otherwise kick off the connection.
    if (!success) {
        DLog(@"Bad ftp url.");
    } else {

    // Create the mutable data into which we will receive the listing.
    assert(self.listData != nil);

    // Open a CFFTPStream for the URL.
    ftpStream = CFReadStreamCreateWithFTPURL(NULL, (CFURLRef) url);

    assert(ftpStream != NULL);

    self.networkStream = (NSInputStream *) ftpStream;

    self.networkStream.delegate = self;
    [self.networkStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:RUNLOOPMODEL];

    //This timer will be called to terminate the request which is blocked for a  customed time.
    NSTimer* timer = [NSTimer scheduledTimerWithTimeInterval:TIMEOUTFTPLIST target:self
                                                    selector:@selector(listdealTimeOut:) userInfo:nil repeats:NO];

    [[NSRunLoop currentRunLoop] addTimer:timer forMode:RUNLOOPMODEL];

    [self.networkStream open];

    CFRelease(ftpStream);

    }
}

- (void)stream:(NSStream *)aStream handleEvent:(NSStreamEvent)eventCode
// An NSStream delegate callback that's called when events happen on our 
// network stream.
{
    connected = @"connected";

     switch (eventCode) {            //####################### EXC_BAD_ACCESS 
        case NSStreamEventOpenCompleted: {
            //NSLog(@"NSStreamEventOpenCompleted");
        } break;
        case NSStreamEventHasBytesAvailable: {
             NSInteger       bytesRead;
             uint8_t         buffer[LISTDOCBUFFER];

         // Pull some data off the network.

        bytesRead = [self.networkStream read:buffer maxLength:sizeof(buffer)];
        if (bytesRead == -1) {
            [self _stopReceiveWithStatus:@"Network read error"];
            } else if (bytesRead == 0) {
                [self _stopReceiveWithStatus:@"no more data"];
            } else {
                assert(self.listData != nil);

                // Append the data to our listing buffer.
                [self.listData appendBytes:buffer length:bytesRead];

                [self _parseListData];
            }
        } break;
        case NSStreamEventHasSpaceAvailable: {
            //NSLog(@"NSStreamEventHasSpaceAvailable");
             assert(NO);     // should never happen for the output stream
        } break;
        case NSStreamEventErrorOccurred: {
            DLog(@"NSStreamEventErrorOccurred");
            [self _stopReceiveWithStatus:@"Stream open error"];
        } break;
        case NSStreamEventEndEncountered: {
            DLog(@"NSStreamEventEndEncountered");
            // ignore
        } break;
        default: {
            DLog(@"default");
            assert(NO);
        } break;
    }

} 
```

在 FtpService.m 中。在这里我可以指定地址和尝试时间来做 ftp 请求：

```
- (NSArray *)requstServerListInfo:(NSString *)filename tryTime:(int)tryTime
{
    NSArray *result = nil;

   //Create the request ftp path
    NSString* tm = [NSString stringWithFormat:FTPURL];

    if(filename != nil)
        tm = [NSString stringWithFormat:@"%@%@/",FTPURL,filename];

    while (tryTime-- > 0) {

        FtpListService *listService = [[FtpListService alloc] initWithUrl:tm];

        [listService _startReceive];

        //isReceiving will be NO only when : connect error, time out, correctly done job
        //I do not really understand the loop, I just know this will cause the request job to begin
        while (listService.isReceiving) {
            [[NSRunLoop currentRunLoop] runMode:RUNLOOPMODEL beforeDate:[NSDate distantFuture]];
        }

        //if correctly request, dirArray != nil
        if(listService.dirArray == nil) {
            [listService release];
            continue;

        } else {

            result = listService.dirArray;
            [listService release];
            break;
        }
     }

    return result;
} 
```

ftp 作业从 PGNetConductor.m 开始，它是一个单例：

```
pm = [[PGDataManagement alloc] init];
dispatch_async(dispatch_get_global_queue(0, 0), ^{
    result = [pm startNetWork];
} 
```

PGD​​ataManagement 归 PGNetConductor 所有：@property (nonatomic, unsafe_unretained) PGDataManagement *pm;

我尝试了很多但未能解决问题。希望有人能给我一些建议。如果您需要代码或更多信息，请告诉我。谢谢！

# c# - 在 Azure VM 中使用 Booksleeve Redis 客户端时出现 Redis 连接错误

> ID：11000187
> 
> 赞同：6
> 
> 时间：2012-06-12T15:48:16.113
> 
> 标签：c#, azure, redis, booksleeve

我最近开始在新的 Azure VM 上托管我的一个副项目。该应用程序使用 Redis 作为内存缓存。在我的本地环境中一切正常，但现在我已将代码移至 Azure，我看到 Booksleeve 出现了一些奇怪的异常。

当应用程序首次启动时，一切正常。但是，在大约 5-10 分钟不活动后，对应用程序的下一个请求遇到网络异常（我现在在工作，没有确切的错误消息，所以我会在我回家时发布它们，如果人们认为他们与讨论密切相关）这会导致内部 MessageQueue 关闭，从而导致每个后续 Enqueue() 抛出异常（“队列已关闭”）。

因此，经过一番谷歌搜索后，我发现了这篇 SO 帖子：[使用 BookSleeve 维护一个开放的 Redis 连接，](https://stackoverflow.com/questions/8645953/maintaining-an-open-redis-connection-using-booksleeve)关于 DIY 连接管理器。如果这是最好的做法，我当然可以实现类似的东西。

所以，问题：

1.  RedisConnection 在一定时间后定期关闭是否正常？
2.  我已经看到了这种`conn.SetKeepAlive()`方法，但我尝试了许多不同的值，但似乎都没有什么不同。还有更多吗，还是我在吠叫错误的树？
3.  上面帖子中的连接管理器想法是处理这种情况的最佳方法吗？
4.  谁能进一步说明为什么在新的 Azure VM 中托管我的 Redis 实例会导致此问题？我还可以确认，如果我针对 Azure Redis VM 运行本地环境，我会遇到此问题。

就像我说的，如果 Redis 连接在不活动后断开是不寻常的，我会在我回家时从我的日志中发布堆栈跟踪和异常。

谢谢！

**更新** Didier 在评论中指出，这可能与 Azure 使用的负载均衡器有关：http: [//blogs.msdn.com/b/avkashchauhan/archive/2011/11/12/windows-azure-load-balancer-超时详细信息.aspx](http://blogs.msdn.com/b/avkashchauhan/archive/2011/11/12/windows-azure-load-balancer-timeout-details.aspx)

假设是这种情况，实现可以解决这个愚蠢问题的连接管理器的最佳方法是什么。我认为我不应该为每个工作单元创建一个连接，对吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-14T06:36:41.460

From other answers/comments, it sounds like this is caused by the azure infrastructure shutting down sockets that look idle. You *could* simply have a timer somewhere that performs some kind of operation periodically, but note that this is already built into Booksleeve: when it connects, it checks what the redis connection timeout is, and configures a heartbeat to prevent redis from closing the socket. You might be able to piggy-back this to prevent azure closing the socket too. For example, in a redis-cli session:

```
config set timeout 30 
```

should configure redis (on the fly, without having to restart) to have a 30 second connection timeout. Booksleeve should then automatically take steps to ensure that there is a heartbeat shortly before 30 seconds. Note that if this is successful, you should also edit your configuration file so that this setting applies after the next restart too.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T22:29:41.407

Windows Azure 中的负载均衡器将在 X 时间后关闭连接，具体取决于负载均衡器上的总连接负载，因此您的连接将随机超时。

As I am not well known to Redis connections I am unable to suggest how to implement it correctly however in general the suggested workaround is the have a heartbeat pulse to keep your session alive. Have you have chance to look for the workaround suggested in blog and try to implement in Redis, if that works out for you?

# objective-c - 复制自定义对象

> ID：11000192
> 
> 赞同：1
> 
> 时间：2012-06-12T15:48:25.470
> 
> 标签：objective-c, ios

我有一个名为 Layer 的对象，它有一些属性和一些方法。

我需要将图层传递给第二个视图控制器：

```
SecondVC *view = [self.storyboard instantiateViewControllerWithIdentifier:@"2VC"];
view.Layer = [[Layer alloc] initWithMapLayer:self.Layer];
view.delegate = self;

UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:view];
navController.modalTransitionStyle = UIModalTransitionStyleCoverVertical;

[self presentModalViewController:navController animated:YES]; 
```

在 SecondVC 中，我可能会更改属性。然后我通过委托返回 Layer 对象；

```
-(void)done
{
    [self.delegate returnLayer:self.layer];

    [self dismissModalViewControllerAnimated:YES];
} 
```

现在我的问题是我正在传递一个指向我的第一个视图控制器的图层对象的指针，当我在第二个视图控制器中更新图层时，我的第一个视图控制器的图层对象也正在更新。

因此，我无法判断它是否已更改（如果已更改，我需要运行一些代码）。

如何创建我的图层对象的副本并将其传递给我的第一个视图控制器的图层对象而不是指针？

编辑：

我确实尝试使用第二种初始化方法：

```
-(id)initWithLayer:(Layer *)Layer
{
    if (self = [super init])
    {
        self.call = [[FunctionCall alloc] init];        
        self.HUD = [[MBProgressHUD alloc] init];

        self.Layers = [[NSMutableDictionary dictionaryWithDictionary:Layer.Layers] copy];
        self.nameList = [[NSArray arrayWithArray:Layer.nameList] copy];
    }
    return self;
} 
```

没有成功。

编辑2：

试过了

```
Layer *copyLayer = [self.myLayer copy];

layerView.myLayer = copyLayer; 
```

并得到错误

```
-[layer copyWithZone:]: unrecognized selector sent to instance 0xfc72c40
2012-06-12 11:15:28.584 Landscout[8866:1fb07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[Layer copyWithZone:]: unrecognized selector sent to instance 0xfc72c40' 
```

解决了：

我在 initWithLayer 方法中添加了一个深拷贝：

```
for (id key in layer.layers)
{
    [newLayers setValue:[[layer.layers objectForKey:key] mutableCopy] forKey:[key mutableCopy]];
}

for (id name in layer.nameList)
{
    [newList addObject:[name mutableCopy]];
} 
```

这给了我一个图层对象的副本

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T16:00:34.703

您将需要为`copy`您的对象实现功能

在你的 Layer.m

```
- (id)copy
{
    Layer *layerCopy = [[Layer alloc] init];

    //YOu may need to copy these values too, this is a shallow copy
    //If YourValues and someOtherValue are only primitives then this would be ok
    //If they are objects you will need to implement copy to these objects too
    layerCopy.YourValues = self.YourValues;
    layerCopy.someOtherValue = self.someOtherValue;

    return layerCopy;
} 
```

现在在你的调用函数中

```
//instead of passing self.Layer pass [self.Layer copy]
view.Layer = [[Layer alloc] initWithMapLayer:[self.Layer copy]]; 
```

# php - 使用 php 错误“为 foreach() 提供的参数无效”解析 json

> ID：11000196
> 
> 赞同：2
> 
> 时间：2012-06-12T15:48:45.820
> 
> 标签：php, json

我在用 php 解析 json 提要时遇到问题，无法弄清楚我做错了什么。

**JSON 提要**

```
[{"id":10428167,"url":"some_url","amount":1197,"price":0.37,"seller":{"id":4682621,"name":"Rap17ka7a"}},
{"id":10428466,"url":"some_url","amount":1450,"price":0.37,"seller":{"id":5031734,"name":"Meanor"}},
{"id":10429969,"url":"some_url","amount":109,"price":0.37,"seller":{"id":5862543,"name":"djeisanborn"}}] 
```

**PHP 解析器**

```
$request_url ="json_feed_url_is_here";
$requests = file_get_contents($request_url);
$response = json_decode($requests);
foreach ($response as $item) {
$seller = $item->seller->name;

$seller = str_replace("'", "&#39;", $seller);
$seller = str_replace("’", "&rsquo;;", $seller);

$sql = ("INSERT INTO table_name ( ~~~cell names~~~) 
        VALUES (~~~cell values~~~, '$item->amount', '$item->price', '$item->url')") or  die('<b>Data Insert Error:</b> ' . mysql_error());
if (!mysql_query($sql,$con1))
  {
  die('Error: ' . mysql_error());
  }
} 
```

**我得到的是这个错误：**

```
PHP Warning:  Invalid argument supplied for foreach() in path_to_php_file 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:50:11.327

[`json_decode`](http://php.net/json_decode)设置to的第二个参数`true`将 JSON 转换为关联数组而不是对象。

```
$response = json_decode($requests, true); 
```

# silverlight - Silverlight 工具提示样式 ContentPresenter TextWrapping

> ID：11000197
> 
> 赞同：1
> 
> 时间：2012-06-12T15:48:45.880
> 
> 标签：silverlight, styles, tooltip, word-wrap, contentpresenter

我想创建 Silverlight 工具提示样式，但我不想使用文本块，因为工具提示内容可能是图像或其他内容。所以我正在使用 ContentPresenter。我的问题是如何设置 MaxWidth 并在内容为文本时强制 TextWrapping 。这是我到目前为止所拥有的：

```
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:System="clr-namespace:System;assembly=mscorlib"
    xmlns:vsm="clr-namespace:System.Windows;assembly=System.Windows"
    xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit">

    <Style TargetType="ToolTip">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ToolTip">
                    <Border BorderBrush="DimGray" BorderThickness="1" CornerRadius="5" Background="WhiteSmoke" Opacity="0.8"
                        HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,10,0,-5" Width="Auto">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="16" ShadowDepth="8" Direction="-45" Color="Black" Opacity="0.6"/>
                        </Border.Effect>
                        <Grid>
                            <ContentPresenter Content="{TemplateBinding Content}" Margin="3"/>
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T14:51:19.587

我找到了一种方法：创建 2 种工具提示样式 - 一种用于文本，另一种用于其他所有内容，如下所示：

```
<Style x:Key="TooltipStyleForText" TargetType="ToolTip">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ToolTip">
                <Border BorderBrush="DimGray" BorderThickness="1" CornerRadius="5" Background="WhiteSmoke" Opacity="0.8"
                    HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,10,0,-5" Width="Auto">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="16" ShadowDepth="8" Direction="-45" Color="Black" Opacity="0.6"/>
                    </Border.Effect>
                    <Grid>
                        <TextBlock Text="{TemplateBinding Content}" MaxWidth="400" TextWrapping="Wrap" Margin="3"/>
                    </Grid>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

<Style x:Key="TooltipStyleForOtherStuffThanText" TargetType="ToolTip">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ToolTip">
                <Border BorderBrush="DimGray" BorderThickness="1" CornerRadius="5" Background="WhiteSmoke" Opacity="0.8"
                    HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,10,0,-5" Width="Auto">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="16" ShadowDepth="8" Direction="-45" Color="Black" Opacity="0.6"/>
                    </Border.Effect>
                    <Grid>
                        <ContentPresenter Content="{TemplateBinding Content}" Margin="3"/>
                    </Grid>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

当我们使用 TextBlock 时，将其称为 ToolTip 样式，如下所示：

```
<TextBlock Text="something">
    <ToolTipService.ToolTip>
        <ToolTip Style="{StaticResource TooltipStyleForText}">
            <TextBlock Text="Some text"/>
        </ToolTip>
    </ToolTipService.ToolTip>
</TextBlock> 
```

这可能不是最好的解决方案，因为我们有两种样式，所以我们需要为一个简单的 TextBlock 指定写几行。我希望有人有更好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T23:41:06.597

在设置以下解决方案之前，我们需要做同样的事情并尝试了一些方法。问题是当 ToolTip.Content 是字符串时，您需要使用 TextBlock 显示工具提示。当 ToolTip.Content 不是字符串时，您需要使用 ContentPresenter。所以我们最终定义了一个同时具有这两者的 ControlTemplate，我们根据 ToolTip.Content 的类型显示/隐藏适当的模板。这种方法适用于应用程序中的所有 ToolTips：

以下转换器类有助于解决此问题：

```
public class TooltipContentVisibilityConverter : IValueConverter
{
    public Visibility VisibilityWhenToolTipContentIsAString { get; set; }
    public Visibility VisibilityWhenToolTipContentIsNotAString { get; set; }

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var toolTip = value as ToolTip;
        if (toolTip != null && toolTip.Content is string)
        {
            return VisibilityWhenToolTipContentIsAString;
        }

        return VisibilityWhenToolTipContentIsNotAString;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

然后在您的 App.xaml 中定义以下内容。

```
<Converter:TooltipContentVisibilityConverter VisibilityWhenToolTipContentIsAString="Visible" VisibilityWhenToolTipContentIsNotAString="Collapsed" x:Key="tooltipStringContentVisibilityConverter" />
<Converter:TooltipContentVisibilityConverter VisibilityWhenToolTipContentIsAString="Collapsed" VisibilityWhenToolTipContentIsNotAString="Visible" x:Key="tooltipNonStringContentVisibilityConverter" />
    <Style TargetType="ToolTip">
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="ToolTip">
        <Border CornerRadius="0" Background="{TemplateBinding Background}" BorderBrush="Black" BorderThickness="1" Padding="4">
          <StackPanel Orientation="Vertical">
            <TextBlock Text="{TemplateBinding Content}" TextWrapping="Wrap" MaxWidth="300" 
                       Visibility="{Binding RelativeSource={RelativeSource AncestorType=ToolTip},Converter={StaticResource tooltipStringContentVisibilityConverter}}"/>
            <ContentPresenter Content="{TemplateBinding Content}" 
                              Visibility="{Binding RelativeSource={RelativeSource AncestorType=ToolTip},Converter={StaticResource tooltipNonStringContentVisibilityConverter}}"/>
          </StackPanel>
        </Border>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
    </Style> 
```

解决这个问题似乎有点尴尬，但它确实有效，我们还没有找到更好的解决方案。

# asp.net - VaryByParam 似乎不起作用

> ID：11000199
> 
> 赞同：0
> 
> 时间：2012-06-12T15:48:50.653
> 
> 标签：asp.net, webforms

我在后面的代码中有一个 Web 表单，其中包含以下内容：

```
Response.Clear();
Response.ContentType = "application/json; charset=utf-8";

int _pGID = base.GetParamAsInt("PGID");

if (_pGID > 0)
{
  Response.Write(...);
}
else
{
  Response.Write(...);
}

Response.End(); 
```

以及以下标记：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="PG.aspx.cs" 
    Inherits="PG" %>

<%@ OutputCache Duration="60" VaryByParam="PGID" %> 
```

问题是每次请求页面时都会触发 page_load 事件，即使 QueryString 'PGID' 参数相同。

我缺少有关如何使用 VaryByParam 属性的信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T09:39:41.063

在中断代码并进行更多测试之后，似乎对 Response.End() 的调用导致了问题。从几篇文章 Response.Flush() 也会导致同样的问题。

# asp.net-mvc-3 - 如何在 CRUD 情况下为 MVC 项目中的模型正确验证 DateTime？

> ID：11000202
> 
> 赞同：1
> 
> 时间：2012-06-12T15:48:56.553
> 
> 标签：asp.net-mvc-3, validation, datetime, razor, jquery-validate

我让用户使用日历/时钟弹出窗口选择日期时间，允许他们进行选择。但是，如果他们要进入并编辑日期以读取类似的内容：`6/12/201 10:36:47 AM`而不是`6/12/2012 10:36:47 AM`我的 Action 超过了 ModelState.IsValid 检查，并且当控制器尝试将对象保存到数据库时我得到一个错误（正确）。

在这种情况下如何正确验证 DateTime？（如果日期时间格式不正确，我想阻止用户甚至能够“提交”表单）

注意：我目前有 jquery.validate 并且通常（字段不是`DateTime`）我使用-当它们的格式不正确时，`@Html.ValidationMessageFor(model => model.Field)`这似乎对我当前的字段没有任何作用。`DateTime`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:19:43.177

您可以使用像这样的片段简单地为您的 DateTime 字段添加日期客户端验证器：

```
 $(element).rules('add', {
        date: true,
    }); 
```

其中“元素”是您对 DateTime 字段的输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:25:08.820

您确定要导入所有必需的验证 js 文件吗？听起来您的服务器验证工作正常，但客户端什么也没做。我建议阅读 Brad Wilson 的以下帖子：[link](http://bradwilson.typepad.com/blog/2010/10/mvc3-unobtrusive-validation.html)

# jquery - 选择菜单需要 jQuery Logic

> ID：11000203
> 
> 赞同：0
> 
> 时间：2012-06-12T15:48:56.800
> 
> 标签：jquery, jquery-ui

我使用 jQuery UI 创建了一个可调整大小的框，然后将值传递给文本框。这些值可以是 CM 或英寸。

我遇到的问题是当您从 unit_type 框中选择厘米后拖动大小时，它会恢复为英寸。我想我只需要重新思考它的逻辑并重新映射它。

任何人都可以帮助这个..？

代码是...

```
$(function()
{
    $("#resizable").resizable({
        aspectRatio: 16 / 9,
        maxWidth:  $("#max_width").val(),
        maxHeight: $("#max_height").val(),
        resize: function() {

            var widthInch = $("#resizable").width() / 200;
            var heightInch = $("#resizable").height() / 200;

            $("#unit_type").change(function()
            {
                var widthCM = $("#resizable").width() / 200 * 2.54;
                var heightCM = $("#resizable").height() / 200 * 2.54;

                $(".width").val(widthCM + '' + ' CM');
                $(".height").val(heightCM + '' + ' CM');
            })

            var widthCM = $("#resziable").width() / 200 * 2.54;
            var heightCM = $("#resizable").height() / 200 * 2.54;

            $(".width").val(widthInch + '' + ' Inches');
            $(".height").val(heightInch + '' + ' Inches');
        }
    });
}) 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:57:32.287

问题在于您在哪里计算大小。最好的解决方案是将其拉出到一个新函数中，然后在调整框大小或更改单位时调用该函数。像这样的东西应该工作。（当我做了一些假设时，您可能会修改它以适合您的确切标记。）

```
$(function()
{
    $("#resizable").resizable({
        aspectRatio: 16 / 9,
        maxWidth:  $("#max_width").val(),
        maxHeight: $("#max_height").val(),
        resize: updateSize
    });
})

$("#unit_type").change(updateSize);

function updateSize() {
   unit = $("#unit_type").val();
   if(unit == "in") {
            var widthInch = $("#resizable").width() / 200;
            var heightInch = $("#resizable").height() / 200;

            $(".width").val(widthInch + '' + ' Inches');
            $(".height").val(heightInch + '' + ' Inches');
   } else if(unit == "cm") {
            var widthCM = $("#resizable").width() / 200 * 2.54;
            var heightCM = $("#resizable").height() / 200 * 2.54;

            $(".width").val(widthCM + '' + ' CM');
            $(".height").val(heightCM + '' + ' CM');
   }
} 
```

# asp.net-mvc - 向 MVC 模型公开公共属性

> ID：11000211
> 
> 赞同：0
> 
> 时间：2012-06-12T15:49:54.347
> 
> 标签：asp.net-mvc

在 MyMainView 我有多个 PartialViews。

每个 PartialView 都对 MyMainView 中公开的属性进行强类型化，并且每个局部视图还包含一些公共信息。

例如

```
public class MainModel
{
    public SubModel1 { get; set; }
    public SubModel2 { get; set; }
    public SubModel3 { get; set; }
    public CommonStuff { get; set; }
} 
```

是否有一种公认的做法来实现共享此共同财产？

我正在考虑在 SubModel 中有一个属性，该属性会返回给它的父级。这是推荐/不推荐吗？

例如。

```
public class SubModel1
{
    public int Number { get; set; }
    public MainModel ParentModel { get; set; }
} 
```

这里的主要目标是避免一遍又一遍地加载相同的数据。

对于我目前正在查看的模型，它是一系列在视图中共享的查找字典，并用于下拉列表等内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:51:55.843

您可以使用子操作。Phil Haack[在博客](http://haacked.com/archive/2009/11/18/aspnetmvc2-render-action.aspx)上介绍了他们。这样，您可以将整个通用功能封装到一个单独的模型/控制器/视图生命周期中，该生命周期与主要生命周期不同，并将其嵌入为小部件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T17:39:47.620

这篇[文章](http://www.arrangeactassert.com/when-to-use-html-renderpartial-and-html-renderaction-in-asp-net-mvc-razor-views/)将帮助您解决困惑。

在您的情况下，大多数情况下您可能必须在主要操作中查询完整模型并将其提供给主视图。从主视图将主模型传递到依赖于子模型以及公共属性的局部视图，`Html.RenderPartial`或者仅将子模型传递给仅需要的局部视图。

如果您在局部视图中显示子模型并且该**局部视图不依赖于主模型**，您应该使用子操作，只是*局部视图完全独立于主视图*。

假设您需要为特定部分应用缓存行为，您还可以执行子操作。

假设您想在同一视图的两个或多个局部视图中显示同一模型，您可以避免子操作，因为您必须一次又一次地查询数据。

因此，解决方案是您应该根据上述评论明智地选择子操作或 Html.RenderPartials。

# android - 安卓操作系统是否支持 Sencha Touch 2？

> ID：11000216
> 
> 赞同：0
> 
> 时间：2012-06-12T15:50:07.690
> 
> 标签：android, sencha-touch-2

Android 是否支持 Sencha Touch 2？另外，senchatouch2 是否向后兼容以前的 android 版本？如果不是，那么 Sencha Touch 2 支持哪些所有版本的 android？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-06T17:36:45.480

似乎没有支持哪些 Android 版本的官方文档！在这篇博文中，Sencha 提到不支持 Android 3.x！

[http://www.sencha.com/forum/showthread.php?186178-Phonegap-1.5-Sencha-Touch-2-has-problems-on-android-3.0](http://www.sencha.com/forum/showthread.php?186178-Phonegap-1.5-Sencha-Touch-2-has-problems-on-android-3.0)

所以，听起来好像只支持 2.x 和 4.x（2.3 和 4.1 对我有用，但我在使用 4.0.4 时遇到了一些问题）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T15:55:06.433

来自[煎茶论坛](http://www.sencha.com/forum/showthread.php?123118-Device-compatabilty-info)：

> 目前，Sencha Touch 支持 Webkit 浏览器，更具体地说，iOS 3+ 和 Android 2.0+（注意，Android 2.0 以下不支持，因此旧设备运行的 Android 1.6 不支持）。

# java - 使用 Java 7 在 JTextPane 中使用样式文本进行奇怪的文本换行

> ID：11000220
> 
> 赞同：16
> 
> 时间：2012-06-12T15:50:19.063
> 
> 标签：java, swing, word-wrap, java-7

我有两个使用 JTextPane 的不同编辑器，它们在 Java 7 中存在奇怪的错误，这些错误在以前的 JVM 版本中没有出现。它发生在包含样式文本或组件的长行中。

这是一个演示此错误的示例。在此示例中，每次插入字符时，所有文本都会应用默认样式。我使用 JDK 1.7.0_04 对其进行了测试。

```
import java.awt.BorderLayout;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.text.*;

public class BugWrapJava7 extends JFrame {

    JTextPane jtp;
    StyledDocument doc;

    public BugWrapJava7() {
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLayout(new BorderLayout());
        jtp = new JTextPane();
        add(jtp, BorderLayout.CENTER);
        jtp.setText("\ntype some text in the above empty line and check the wrapping behavior");
        doc = jtp.getStyledDocument();
        doc.addDocumentListener(new DocumentListener() {
            public void insertUpdate(DocumentEvent e) {
                insert();
            }
            public void removeUpdate(DocumentEvent e) {
            }
            public void changedUpdate(DocumentEvent e) {
            }
        });
        setSize(200, 200);
        setVisible(true);
    }
    public void insert() {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                Style defaultStyle = jtp.getStyle(StyleContext.DEFAULT_STYLE);
                doc.setCharacterAttributes(0, doc.getLength(), defaultStyle, false);
            }
        });
    }
    public static void main(String[] args) {
        new BugWrapJava7();
    }
} 
```

我的问题是：我的代码是否有问题，或者它确实是 Java 7 中引入的一个新错误？如果它是一个新的 JVM 错误，是否有解决方法？

它可能与[问题 8666727](https://stackoverflow.com/questions/8666727)有关，但这里的问题在于错误的包装而不是滚动条的出现。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-12T17:44:35.683

对于期货读者，[JDK 1.7.0_04 中仍然存在错误。](http://bugs.sun.com/view_bug.do?bug_id=6539700),

比较 Java7 和稳定的 Java6，

![在此处输入图像描述](../Images/6fe0500eff183130e171a31d634f2fe1.png)<----- Java7 与 Java6 --->![在此处输入图像描述](../Images/7e9a2b25193233883d41819f512f4991.png)

![在此处输入图像描述](../Images/9e5c2b1ff303dcc71837f13a4fb69d2b.png)<----- Java7 与 Java6 --->![在此处输入图像描述](../Images/0138baaa94e50b280ef7dcc94ac46912.png)

![在此处输入图像描述](../Images/665c511d23736f33b21548fb0d5e2480.png)<----- Java7 与 Java6 --->![在此处输入图像描述](../Images/c3a6cd149eedb17cfb55bb39590d8caa.png)

![在此处输入图像描述](../Images/a6bd14e761ed37b238f75f9f77cc9e14.png) <----- Java7 与 Java6 ---> ![在此处输入图像描述](../Images/56118da85ad8e1cf3e36f99c8f4eb56b.png)

从代码

```
import java.awt.Dimension;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.text.*;

public class BugWrapJava7 {

    private JFrame frame = new JFrame();
    private JTextPane jtp;
    private StyledDocument doc;

    public BugWrapJava7() {
        jtp = new JTextPane();
        jtp.setText("\ntype some text in the above empty line and check the wrapping behavior");
        doc = jtp.getStyledDocument();
        doc.addDocumentListener(new DocumentListener() {

            public void insertUpdate(DocumentEvent e) {
                insert();
            }

            public void removeUpdate(DocumentEvent e) {
                insert();
            }

            public void changedUpdate(DocumentEvent e) {
                insert();
            }

            public void insert() {
                SwingUtilities.invokeLater(new Runnable() {

                    public void run() {
                        Style defaultStyle = jtp.getStyle(StyleContext.DEFAULT_STYLE);
                        doc.setCharacterAttributes(0, doc.getLength(), defaultStyle, false);
                    }
                });
            }
        });
        JScrollPane scroll = new JScrollPane(jtp);
        scroll.setPreferredSize(new Dimension(200, 200));
        frame.add(scroll);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            public void run() {
                BugWrapJava7 bugWrapJava7 = new BugWrapJava7();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-09T08:02:44.393

对此进行了调查。原因是breakSpots 缓存。看起来像`LabelView`存储它们并且不重新计算 previos 文本编辑的偏移量。如果我手动重置它们，则不会发生错误。

一种解决方法（由于私有 breakSpots 字段而非常脏）如下

```
import java.awt.Dimension;
import java.lang.reflect.Field;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.text.*;

public class BugWrapJava7 {

    private JFrame frame = new JFrame();
    private JTextPane jtp;
    private StyledDocument doc;

    public BugWrapJava7() {
        jtp = new JTextPane();
        jtp.setEditorKit(new MyStyledEditorKit());
        jtp.setText("\ntype some text in the above empty line and check the wrapping behavior");
        doc = jtp.getStyledDocument();
        doc.addDocumentListener(new DocumentListener() {

            public void insertUpdate(DocumentEvent e) {
                insert();
            }

            public void removeUpdate(DocumentEvent e) {
                insert();
            }

            public void changedUpdate(DocumentEvent e) {
                insert();
            }

            public void insert() {
                SwingUtilities.invokeLater(new Runnable() {

                    public void run() {
                        Style defaultStyle = jtp.getStyle(StyleContext.DEFAULT_STYLE);
                        doc.setCharacterAttributes(0, doc.getLength(), defaultStyle, false);
                    }
                });
            }
        });
        JScrollPane scroll = new JScrollPane(jtp);
        scroll.setPreferredSize(new Dimension(200, 200));
        frame.add(scroll);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            public void run() {
                BugWrapJava7 bugWrapJava7 = new BugWrapJava7();
            }
        });
    }
}

class MyStyledEditorKit extends StyledEditorKit {
    private MyFactory factory;

    public ViewFactory getViewFactory() {
        if (factory == null) {
            factory = new MyFactory();
        }
        return factory;
    }
}

class MyFactory implements ViewFactory {
    public View create(Element elem) {
        String kind = elem.getName();
        if (kind != null) {
            if (kind.equals(AbstractDocument.ContentElementName)) {
                return new MyLabelView(elem);
            } else if (kind.equals(AbstractDocument.ParagraphElementName)) {
                return new ParagraphView(elem);
            } else if (kind.equals(AbstractDocument.SectionElementName)) {
                return new BoxView(elem, View.Y_AXIS);
            } else if (kind.equals(StyleConstants.ComponentElementName)) {
                return new ComponentView(elem);
            } else if (kind.equals(StyleConstants.IconElementName)) {
                return new IconView(elem);
            }
        }

        // default to text display
        return new LabelView(elem);
    }
}

class MyLabelView extends LabelView {
    public MyLabelView(Element elem) {
        super(elem);
    }
    public View breakView(int axis, int p0, float pos, float len) {
        if (axis == View.X_AXIS) {
            resetBreakSpots();
        }
        return super.breakView(axis, p0, pos, len);
    }

    private void resetBreakSpots() {
        try {
            // HACK the breakSpots private fields
            Field f=GlyphView.class.getDeclaredField("breakSpots");
            f.setAccessible(true);
            f.set(this, null);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

} 
```

没有反射的黑客少。基于模型更改时breakSpots的通常重置。

```
class MyLabelView extends LabelView {

    boolean isResetBreakSpots=false;

    public MyLabelView(Element elem) {
        super(elem);
    }
    public View breakView(int axis, int p0, float pos, float len) {
        if (axis == View.X_AXIS) {
            resetBreakSpots();
        }
        return super.breakView(axis, p0, pos, len);
    }

    private void resetBreakSpots() {
        isResetBreakSpots=true;
        removeUpdate(null, null, null);
        isResetBreakSpots=false;

//        try {
//            Field f=GlyphView.class.getDeclaredField("breakSpots");
//            f.setAccessible(true);
//            f.set(this, null);
//        } catch (Exception e) {
//            e.printStackTrace();
//        }
    }

    public void removeUpdate(DocumentEvent e, Shape a, ViewFactory f) {
        super.removeUpdate(e, a, f);
    }

    public void preferenceChanged(View child, boolean width, boolean height) {
        if (!isResetBreakSpots) {
            super.preferenceChanged(child, width, height);
        }
    }
} 
```

更新：这个也修复了 TextSamplerDemo。我重置了所有标签视图的所有点。

```
class MyStyledEditorKit extends StyledEditorKit {
    private MyFactory factory;

    public ViewFactory getViewFactory() {
        if (factory == null) {
            factory = new MyFactory();
        }
        return factory;
    }
}

class MyFactory implements ViewFactory {
    public View create(Element elem) {
        String kind = elem.getName();
        if (kind != null) {
            if (kind.equals(AbstractDocument.ContentElementName)) {
                return new MyLabelView(elem);
            } else if (kind.equals(AbstractDocument.ParagraphElementName)) {
                return new MyParagraphView(elem);
            } else if (kind.equals(AbstractDocument.SectionElementName)) {
                return new BoxView(elem, View.Y_AXIS);
            } else if (kind.equals(StyleConstants.ComponentElementName)) {
                return new ComponentView(elem);
            } else if (kind.equals(StyleConstants.IconElementName)) {
                return new IconView(elem);
            }
        }

        // default to text display
        return new LabelView(elem);
    }
}

class MyParagraphView extends ParagraphView {

    public MyParagraphView(Element elem) {
        super(elem);
    }
public void removeUpdate(DocumentEvent e, Shape a, ViewFactory f) {
    super.removeUpdate(e, a, f);
    resetBreakSpots();
}
public void insertUpdate(DocumentEvent e, Shape a, ViewFactory f) {
    super.insertUpdate(e, a, f);
    resetBreakSpots();
}

private void resetBreakSpots() {
    for (int i=0; i<layoutPool.getViewCount(); i++) {
        View v=layoutPool.getView(i);
        if (v instanceof MyLabelView) {
            ((MyLabelView)v).resetBreakSpots();
        }
    }
}

}

class MyLabelView extends LabelView {

    boolean isResetBreakSpots=false;

    public MyLabelView(Element elem) {
        super(elem);
    }
    public View breakView(int axis, int p0, float pos, float len) {
        if (axis == View.X_AXIS) {
            resetBreakSpots();
        }
        return super.breakView(axis, p0, pos, len);
    }

    public void resetBreakSpots() {
        isResetBreakSpots=true;
        removeUpdate(null, null, null);
        isResetBreakSpots=false;
   }

    public void removeUpdate(DocumentEvent e, Shape a, ViewFactory f) {
        super.removeUpdate(e, a, f);
    }

    public void preferenceChanged(View child, boolean width, boolean height) {
        if (!isResetBreakSpots) {
            super.preferenceChanged(child, width, height);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-03T18:26:08.610

我的 HTMLDocument 是按字母换行的。我安装了 StanislavL 的上述解决方案。不高兴，仍然在 <td> 元素中逐字母包装。所以我修复了 StanislavL 代码中的一个错误。喜悦; 到处都按字换行。然后我发现我的程序没有使用 StanislavL 代码！看来我的修补在我自己的代码中修复了相同的错误。

问题是有两种不同类型的元素（在 javax.swing.text 和 javax.swing.text.html.parser 中）并且都有一个带有字符串值“content”的标签类型名称。方法 Element.getName 通过返回字符串而不是对象来混淆这一点。

所以代码说“.equals（）”的地方

```
 String kind = elem.getName();
    if (kind != null) {
        if (kind.equals(AbstractDocument.ContentElementName)) {
    ... 
```

它应该说“==”

```
 Object absDocName = attrs.getAttribute(AbstractDocument.ElementNameAttribute)
    if (absDocName != null){
        if (kind == AbstractDocument.ContentElementName) {
    ... 
```

# javascript - 从 html 数据中删除脚本...使用 javascript

> ID：11000222
> 
> 赞同：4
> 
> 时间：2012-06-12T15:50:20.087
> 
> 标签：javascript, jquery

所以我有这个功能可以从页面中删除脚本，但是一些多行的脚本仍然出现。有没有办法从加载的页面中删除所有脚本。

```
 function filterData(data){

// filter all the nasties out
// no body tags
data = data.replace(/<?\/body[^>]*>/g,'');
// no linebreaks
data = data.replace(/[\r|\n]+/g,'');
// no comments
data = data.replace(/<--[\S\s]*?-->/g,'');
// no noscript blocks
data = data.replace(/<noscript[^>]*>[\S\s]*?<\/noscript>/g,'');
// no script blocks
data = data.replace(/<script[^>]*>[\S\s]*?<\/script>/g,'');
// no self closing scripts
data = data.replace(/<script.*\/>/,'');

// [... add as needed ...]
return data;
  } 
```

以下是 html 中的脚本示例

```
<script type="text/javascript">
var ccKeywords="keyword=";
if (typeof(ccauds) != 'undefined')
{
 for (var cci = 0; cci < ccauds.Profile.Audiences.Audience.length; cci++)
{
  if (cci > 0) ccKeywords += "&keyword="; ccKeywords +=     ccauds.Profile.Audiences.Audience[cci].abbr;
}
}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:15:57.203

如果我猜对了，您需要`<script>`从一段 HTML 字符串中删除所有带有内部代码的标签。在这种情况下，您可以尝试以下正则表达式：

```
data.replace(/<script.*?>[\s\S]*?<\/script>/ig, ""); 
```

它应该可以成功地与单行和多行一起使用，并且不会影响其他标签。

**演示：http:** [//jsfiddle.net/9jBSD/](http://jsfiddle.net/9jBSD/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:37:17.537

```
function filterData(data){
    var root = document.createElement("body");
    root.innerHTML = data;

    $(root).find("script,noscript").remove();

    function removeAttrs( node ) {
        $.each( node.attributes, function( index, attr ) {
            if( attr.name.toLowerCase().indexOf("on") === 0 ) {
                node.removeAttribute(attr.name);
            }
        });
    }

    function walk( root ) {
        removeAttrs(root);
        $( root.childNodes ).each( function() {
            if( this.nodeType === 3 ) {
                if( !$.trim( this.nodeValue ).length ) {
                    $(this).remove();
                }
            }
            else if( this.nodeType === 8 ) {
                $(this).remove();
            }
            else if( this.nodeType === 1 ) {
                walk(this);
            }
        });
    }

    walk(root);

    return root.innerHTML; 
}

filterData("<script>alert('hello');</script></noscript></script><div onclick='alert'>hello</div>\n\n<!-- comment -->");
//"<div>hello</div>" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T15:57:36.570

结帐 Sugar.js - [http://sugarjs.com/](http://sugarjs.com/)

它有一个 removeTags 方法，应该做你想做的事

[http://sugarjs.com/api/String/removeTags](http://sugarjs.com/api/String/removeTags)

# visual-c++ - 无边框 CRichEditCtrl

> ID：11000226
> 
> 赞同：0
> 
> 时间：2012-06-12T15:50:42.123
> 
> 标签：visual-c++, mfc, cricheditctrl

是否有可能有无边界 CRichEditCtrl 控件，基本上是我想要的，有类似搜索编辑框的东西，所以我可以将图像放在最右边，否则就计划实施无边界 CRichEditCtrl 并将图像极端绘制到正确的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T13:10:50.637

创建没有 WS_BORDER 和 WS_EX_CLIENTEDGE 和 WS_EX_WINDOWEDGE 的控件。

在 MFC 领域，您可以从 CRichEditCtrl 创建派生类并在 PreCreateWindow 中修改这些样式。

# html - 将文本添加到页面顶部，而不将页面的其余部分向下推

> ID：11000228
> 
> 赞同：4
> 
> 时间：2012-06-12T15:50:43.230
> 
> 标签：html, css, accessibility

这应该是一个简单的答案。我只是没有足够的 CSS 知识来知道要寻找什么来解决这个问题。

我的雇主希望我为我们网站上的所有页面添加“跳转到内容”链接，因为他有视觉障碍，这将大大提高可访问性。

我想实现这里描述的方法：[http ://webaim.org/techniques/skipnav/#focus](http://webaim.org/techniques/skipnav/#focus)

我的问题是，当链接获得焦点时，由于文本突然出现，页面布局的其余部分被向下推了几个像素。我希望文本显示在页面顶部，而不影响其下方的布局。我可以以某种方式修复布局的位置吗？

整个布局已经用一个 div 容器包装了，所以我猜这只是向该容器添加一个 CSS 属性来修复它的位置的问题。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T15:57:11.767

您应该能够通过绝对定位链接来做到这一点：

```
#skip a:active, #skip a:focus
{
position:absolute;
top: 0px; 
width:100%;
height:auto;
text-align: center;
} 
```

绝对定位的元素会从正常流程中移除。文档和其他元素的行为就像绝对定位的元素不存在一样，因此这将在页面顶部添加链接，但不应导致其余页面元素移动。

# blackberry-webworks - 错误：重启黑莓设备后在设备中打开黑莓网络应用程序代码文件时无法解析 JSON 字符串

> ID：11000230
> 
> 赞同：0
> 
> 时间：2012-06-12T15:50:49.967
> 
> 标签：blackberry-webworks

当我们在重启设备后尝试在黑莓设备 9780 中打开 webworks 应用程序时，我们收到错误无法解析 JSON 字符串。奇怪的是，当我们在设备中加载我们的应用程序时，它运行得非常好，但只有当我们重新启动设备之后，我们才能运行应用程序。

Breif 对我们正在使用的应用程序的解释：

我们正在使用 Blackberry Webworks Application，我们使用 Blackberry Webworks SDK 2.3.1.5 编译应用程序以制作 COD 文件。然后我们使用 Blackberry JDE 5.0.0 对该 COD 文件进行签名，然后使用 Javaloader 将 COD 文件加载到 Blackberry 设备 9780 上。

如果有人遇到过这种问题，请回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T15:09:21.073

这个问题似乎很奇怪。JSON 字符串存储在哪里？JSON字符串是否可能在设备重启时被损坏或删除？那么，您能否在设备重启后检查 JSON 字符串是否存在？

谢谢

纳文 M

# infinispan - Infinispan - 如何知道缓存是否在配置文件（XML）中定义？

> ID：11000233
> 
> 赞同：0
> 
> 时间：2012-06-12T15:51:00.047
> 
> 标签：infinispan

我在 Infinispan 中使用嵌入式缓存架构，它允许动态创建/删除缓存。

如果用户尝试获取不存在的缓存，则需要获取异常，但`EmbeddedCacheManager`API 对此没有帮助。此 API 提供两个选项

*   `get(String name, true)`- 获取并创建
*   `get(String name, false)`得到但不创造

我的做法？当用户简单地获得我们使用的缓存`get(String name, false)`时，当用户创建我们使用的缓存时`get(String name, true)`。到目前为止，一切都很好。

现在我有一个问题：一些缓存不是由应用程序创建的，而是在 XML 中定义的。因此，当用户使用它获得这些“内置”缓存之一`get(String name, false)`时，不会获得缓存。

如果我们能够识别在 XML 中定义的缓存，我们就可以解决这些问题。

注意：目前，我们在 XML 中定义的缓存名称前加上前缀，但这对于代码抽象来说是丑陋的，而且变得非常混乱。

# sql-server - 来自两个不同表的条件

> ID：11000234
> 
> 赞同：-1
> 
> 时间：2012-06-12T15:51:01.913
> 
> 标签：sql-server

我运行一个折旧数据库。我需要在必须满足两个条件但来自不同表的下个月进行折旧

```
insert into Asset.dbo.depreciation (Asset_Tag, depreciation_date, Depreciation_Amount)
   select 
       Asset_Tag, '2012-05-01', Depreciation_Amount 
   from Asset.dbo.depreciation
   where depreciation_date = '2012-04-01' 
   and asset_details.Fully_Depreciated = 'N' 
```

之后的条件`and`来自另一个表。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:03:17.070

您缺少与其他表的连接，例如：

`Asset.dbo.depreciation d INNER JOIN Asset.dbo.Asset_details d2 ON d1.keycolumn = d2.keycolum where d.depreciation_date = '2012-04-01' and d1.Fully_Depreciated = 'N'`

# javascript - 如何在 Javascript 中使用正则表达式？

> ID：11000235
> 
> 赞同：-4
> 
> 时间：2012-06-12T15:51:03.043
> 
> 标签：javascript, hta, jscript

我在 C# 中使用它

```
var validString = new Regex(@"^[a-z][a-z\d!@#$%\^&*()\-+]{0,7}$(?<=\d\D+)", RegexOptions.Compiled); 
```

我正在尝试执行以下密码创建规则

```
•没有大写字母。
•以字母开头。
• 至少有1 个数字不在开头和结尾。
•最多有 8 个字母数字
•没有像@#$ 字符这样的符号（像!@#$%^&*()-+ 这样的符号）。
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:53:37.433

可以使用相同的正则表达式（只要它有效）。至于如何使用它如下图所示：

```
var re = /^[a-z][a-z\d!@#$%\^&*()\-+]{0,7}$(?<=\d\D+)/;
var test = re.test(password);  // will store a bool value whether the password is valid or not. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T15:54:56.807

谷歌是你的朋友：[http ://www.diveintojavascript.com/articles/javascript-regular-expressions](http://www.diveintojavascript.com/articles/javascript-regular-expressions)

此外，您可以使用`match`：

```
str.match(pattern) 
```

享受。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T15:57:02.423

几乎相同，除了：

*   `new RegExp`代替`new Regex`
*   `@`字符串前没有
*   您不能将常量用于选项，只能使用带有选项字母的字符串
*   你不能使用lookbehinds。

或者使用正则表达式文字：

```
var validString = /^[a-z](?=[a-z]*[0-9])[a-z0-9]{0,6}[a-z]$/; 
```

注意我改变了你的正则表达式，因为你基本上说你不能在开头或结尾有数字。我使用了前瞻来确保那里有一个数字。

# php - 我可以从 mysql 中提取 html 段落而不是计算字符吗？

> ID：11000239
> 
> 赞同：0
> 
> 时间：2012-06-12T15:51:32.440
> 
> 标签：php, mysql, html, text-extraction

我正在使用此代码从数据库中提取文本，并且效果很好。我可以让它只提取第一段或第二段而不是计算到 640 个字符吗？

```
$this->data['getshorty'] = utf8_substr(html_entity_decode($product_info['description'], ENT_QUOTES, 'UTF-8'), 0, 640); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:30:33.700

如果您的段落在`<p></p>`标签中，这是一个简单的解决方案应该可以工作：

```
$fullDescription = html_entity_decode($product_info['description'], ENT_QUOTES, 'UTF-8');
preg_match('/<p\s*>(.)*<\/p\s*>/isU',$fullDescription,$matches);
$this->data['getshorty'] = $matches[0]; 
```

希望第二行的正则表达式对您有意义，如果不是，请询问！

尽管使用正则表达式解析 HTML 通常被认为是不好的做法，但我认为对于像这样的简单示例来说它很好。

# windows-ce - 如何在不克隆的情况下为公共代码模块创建命令行定义？

> ID：11000250
> 
> 赞同：2
> 
> 时间：2012-06-12T15:51:52.277
> 
> 标签：windows-ce, platform-builder

具体来说，我想`WBT_USEAUTOLOGON`定义`$(_PUBLICROOT)\RDP\OAK\UIT\TSCONWIZ`

这将获得我需要的功能，而无需克隆模块。

我希望我可以使用这样的技巧[来](http://geekswithblogs.net/BruceEitman/archive/2010/03/23/platform-builder-cloning--the-linker-is-your-friend.aspx)解决它，但我更喜欢更优雅的方式。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T09:47:09.200

事实证明，没有更好的方法来实现这一目标。我最终只克隆了使用定义的文件并将定义添加到源文件中的 CDEFINES`TSCONWIZ`和`TSCONMAN`.

如果您想做一个最小的克隆，请参阅我的问题链接到布鲁斯的博客以获取详细信息。

# javascript - 访问 phantomjs 中动态加载的元素

> ID：11000256
> 
> 赞同：0
> 
> 时间：2012-06-12T15:52:17.207
> 
> 标签：javascript, phantomjs

我正在发送一个页面事件：

`page.sendEvent('click', 650, 430);`

这会单击通过 ajax 动态加载元素的链接。通过 访问这个动态加载的元素是否为时已晚`page.evaluate`？我似乎无法在页面上动态创建的任何内容中返回任何内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-17T21:27:06.830

到目前为止，最简单的动态方法是捕获控制台消息，如此处所述[http://code.google.com/p/phantomjs/wiki/Interface#Callbacks](http://code.google.com/p/phantomjs/wiki/Interface#Callbacks)

```
page.onConsoleMessage = function(msg) {
    console.log(msg);
}; 
```

如果您想发送一些二进制数据，那么我建议您通过将自定义脚本注入网页来使用某种管道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T22:54:38.593

为什么不`window.setTimeout`使用 page.render 并拍摄快照？因此，您的代码将更改为：

```
window.setTimeout(function() {
   page.sendEvent('click', 650, 430);
}, 5000);
window.setTimeout(function() {
   page.render('foo.png');
}); 
```

超时将使 ajax 调用有机会完成。当 ajax 调用完成时，渲染将让您看到页面应该是什么样子。

# c++ - 使用线程池进行模拟：boost-thread 和 boost-asio

> ID：11000258
> 
> 赞同：4
> 
> 时间：2012-06-12T15:52:39.180
> 
> 标签：c++, multithreading, optimization, boost, boost-asio

我想用它`boost::asio`来设置一个线程池。我的问题是：如何将特定数据附加到创建的每个线程，以及如何管理单个输出？

更具体地说，我编写了一个类`Simulation`，它通过在输入中获取一些参数的方法来执行模拟。此类包含计算所需的所有数据。由于数据不是太大，我想复制它以便`Simulation`在池的每个线程中使用该类的不同实例。

我想做这样的事情：（这里解释了设置线程池：[SO](https://stackoverflow.com/questions/7957059/boostasio-io-service-thread-pool) and [Asio recipes](http://think-async.com/Asio/Recipes?skin=clean.nat,asio,pattern#A_thread_pool_for_executing_arbi)）

```
class ParallelSimulation
{
  public:
    static const std::size_t N = 10;

  protected:
    std::vector< boost::shared_ptr<Simulation> > simuInst; // N copy of a reference instance.

  public:

    ...

    // Simulation with a large (>>N) number of inputs
    void eval( std::vector< SimulationInput > inputs )
    {
      // Creation of the pool using N threads
      asio::io_service io_service;
      asio::io_service::work work(io_service);
      boost::thread_group threads;
      for (std::size_t i = 0; i < N; ++i)
        threads.create_thread(boost::bind(&asio::io_service::run, &io_service));

      // Here ? Attaching the duplicates instances of class Simulation ?

      // Adding tasks
      for( std::size_t i = 0, i_end = inputs.size(); i<i_end; ++i)
        io_service.post(...); // add simulation with inputs[i] to the queue

      // How to deal with outputs ?  

      // End of the tasks
      io_service.stop();
      threads.join_all();
    }
}; 
```

也许用于设置线程池的技术（使用`boost::asio`）不适合我的问题。你有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T18:25:01.763

这是我的研究结果！

分布式模拟基于`DistributedSimulation`使用两个实现类的主类：`impl::m_io_service`和`impl::dispatcher`.

`boost::asio`线程池基于附加`io_service::run()`方法到不同的线程。
这个想法是重新定义这个方法并包含一种机制来识别当前线程。`boost::thread_specific_ptr`下面的解决方案是基于`boost::uuid`. *在阅读了 Tres 的评论后，我认为识别线程使用`boost::thread::id`是一个更好的解决方案（但等效且差别不大）。*
最后，另一个类用于将输入数据分派给 Simulation 类的实例。此类创建同一类 Simulation 的多个实例，并使用它们来计算每个线程中的结果。

```
namespace impl {

  // Create a derived class of io_service including thread specific data (a unique identifier of the thread)
  struct m_io_service : public boost::asio::io_service
  {
    static boost::thread_specific_ptr<boost::uuids::uuid> ptrSpec_;

    std::size_t run()
    {
      if(ptrSpec_.get() == 0) 
        ptrSpec_.reset(new boost::uuids::uuid(boost::uuids::random_generator()())  );

      return boost::asio::io_service::run();
    }
  };

  // Create a class that dispatches the input data over the N instances of the class Simulation
  template <class Simulation>
  class dispatcher
  {  
    public:
      static const std::size_t N = 6;

      typedef Simulation::input_t input_t;
      typedef Simulation::output_t output_t;

      friend DistributedSimulation;

    protected:
      std::vector< boost::shared_ptr<Simulation> > simuInst;
      std::vector< boost::uuids::uuid >            map;

    public:

      // Constructor, creating the N instances of class Simulation
      dispatcher( const Simulation& simuRef) 
      {
        simuInst.resize(N);
        for(std::size_t i=0; i<N; ++i)
          simuInst[i].reset( simuRef.clone() );
      }

      // Record the unique identifiers and do the calculation using the right instance of class Simulation
      void dispatch( const Simulation::input_t& in  )
      {
        if( map.size() == 0 ) {
          map.push_back(*m_io_service::ptrSpec_);
          simuInst[0]->eval(in, *m_io_service::ptrSpec_);
        }    
        else {
          if( map.size() < N ) {
            map.push_back(*m_io_service::ptrSpec_);
            simuInst[map.size()-1]->eval(in, *m_io_service::ptrSpec_);
          }
          else {
            for(size_t i=0; i<N;++i) {
              if( map[i] == *m_io_service::ptrSpec_) {
                simuInst[i]->eval(in, *m_io_service::ptrSpec_);
                return;
              }
            }
          }
        }
      }
  };

  boost::thread_specific_ptr<boost::uuids::uuid> m_io_service::ptrSpec_;
}

  // Main class, create a distributed simulation based on a class Simulation
  template <class Simulation>
  class DistributedSimulation
  {
  public:
    static const std::size_t N = impl::dispatcher::N;

  protected: 
    impl::dispatcher _disp;

  public:
    DistributedSimulation() : _disp( Simulation() ) {}

    DistributedSimulation(Simulation& simuRef) 
    : _disp( simuRef ) {  }

    // Simulation with a large (>>N) number of inputs
    void eval( const std::vector< Simulation::input_t >& inputs, std::vector< Simulation::output_t >& outputs )
    {

      // Clear the results from a previous calculation (and stored in instances of class Simulation)
      ...

      // Creation of the pool using N threads
      impl::m_io_service io_service;
      boost::asio::io_service::work work(io_service);
      boost::thread_group threads;
      for (std::size_t i = 0; i < N; ++i)
        threads.create_thread(boost::bind(&impl::m_io_service::run, &io_service));

      // Adding tasks
      for( std::size_t i = 0, i_end = inputs.size(); i<i_end; ++i)
        io_service.post( boost::bind(&impl::dispatcher::dispatch, &_disp, inputs[i]) );

      // End of the tasks
      io_service.stop();
      threads.join_all();

      // Gather the results iterating through instances of class simulation
      ...
    }
  }; 
```

* * *

编辑

下面的代码是我之前解决方案的更新，考虑到了 Tres 的评论。正如我之前所说，它更易于阅读！

```
 template <class Simulation>
  class DistributedSimulation
  {
    public:
      typedef typename Simulation::input_t  input_t;
      typedef typename Simulation::output_t output_t;

      typedef boost::shared_ptr<Simulation> SimulationSPtr_t;
      typedef boost::thread::id             id_t;      
      typedef std::map< id_t, std::size_t >::iterator IDMapIterator_t;

    protected: 
      unsigned int                    _NThreads;   // Number of threads
      std::vector< SimulationSPtr_t > _simuInst;   // Instances of class Simulation
      std::map< id_t, std::size_t >   _IDMap;      // Map between thread id and instance index.

    private:
      boost::mutex _mutex;

    public:

      DistributedSimulation(  ) {}

      DistributedSimulation( const Simulation& simuRef, const unsigned int NThreads = boost::thread::hardware_concurrency() ) 
        { init(simuRef, NThreads); }

      DistributedSimulation(const DistributedSimulation& simuDistrib) 
        { init(simuRef, NThreads); }

      virtual ~DistributedSimulation() {}

      void init(const Simulation& simuRef, const unsigned int NThreads = boost::thread::hardware_concurrency())
      {
        _NThreads = (NThreads == 0) ? 1 : NThreads;
        _simuInst.resize(_NThreads);
        for(std::size_t i=0; i<_NThreads; ++i)
          _simuInst[i].reset( simuRef.clone() );
        _IDMap.clear();
      }

      void dispatch( const input_t& input )
      {
        // Get current thread id
        boost::thread::id id0 = boost::this_thread::get_id();

        // Get the right instance 
        Simulation* sim = NULL;        
        { 
          boost::mutex::scoped_lock scoped_lock(_mutex);
          IDMapIterator_t it = _IDMap.find(id0);
          if( it != _IDMap.end() )
            sim = _simuInst[it->second].get();
        } 

        // Simulation
        if( NULL != sim )
          sim->eval(input);
      }

      // Distributed evaluation.
      void eval( const std::vector< input_t >& inputs, std::vector< output_t >& outputs )
      {
        //--Initialisation
        const std::size_t NInputs = inputs.size();

        // Clear the ouptuts f(contained in instances of class Simulation) from a previous run
        ...

        // Create thread pool and save ids
        boost::asio::io_service io_service;
        boost::asio::io_service::work work(io_service);
        boost::thread_group threads;
        for (std::size_t i = 0; i < _NThreads; ++i)
        {
          boost::thread* thread_ptr = threads.create_thread(boost::bind(&boost::asio::io_service::run, &io_service));
          _IDMap[ thread_ptr->get_id() ] = i;
        }

        // Add tasks
        for( std::size_t i = 0; i < NInputs; ++i)
          io_service.post( boost::bind(&DistributedSimulation::dispatch, this, inputs[i]) );

        // Stop the service
        io_service.stop();
        threads.join_all();

        // Gather results (contained in each instances of class Simulation)
        ...
      }
  }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T19:24:50.043

这应该适用于您的应用程序。当您调用 时`io_service.post`，您将传入模拟函数`inputs[i]`作为参数。在该函数（可能是 的成员函数`Simulation`）中，只需将计算结果存储在`Simulation`对象中，然后在加入线程后迭代对象以收集输出。

`i`如果您需要识别完成工作的特定线程，您也可以作为参数传递。这假设在模拟完成后收集输出是可以的。

如果您需要在运行时访问输出，只需根据需要将该函数`post`作为输出任务即可`io_service`。确保使用互斥锁保护任何共享数据结构！

# c++ - 从外部应用程序附加子窗口时的消息循环（泵）

> ID：11000259
> 
> 赞同：1
> 
> 时间：2012-06-12T15:52:43.387
> 
> 标签：c++, windows, winapi, message-pump

我即将将[子窗口](https://stackoverflow.com/questions/838511/how-should-i-create-a-child-window-in-win32-while-programming-with-c?rq=1)附加到**外部**应用程序。子窗口将是一个无模式对话框。由于我不拥有外部应用程序（实际上是 Microsoft FSX）的源代码，因此我不知道如何挂钩到消息循环或`LRESULT CALLBACK WndProc(HWND, UINT, WPARAM, LPARAM)`父窗口本身的回调。

我的附加应用程序在它自己的进程中运行，所以我是否需要编写自己的消息循环，或者我的回调是否会被父消息泵调用？

前进的正确方法是什么？

-- 编辑至关于`SetWindowsHookEx`功能的答案 --

值得注意的是：

1.  [如何使用 SetWindowsHookEx 和 WH_KEYBOARD 挂钩外部进程](https://stackoverflow.com/questions/820804/how-to-hook-external-process-with-setwindowshookex-and-wh-keyboard)
2.  [C# 中的 SetWindowsHookEx](https://stackoverflow.com/questions/1811383/setwindowshookex-in-c-sharp)
3.  也许不工作，另一个[SetWindowsHookEx 示例](http://developer-resource.blogspot.de/2008/07/setwindowshookex-example.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:26:28.187

[SetWindowsHookEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644990%28v=vs.85%29.aspx)是允许外部进程捕获窗口消息（除其他外）的 API。

# shell - 如何从 shell 运行多个模拟器？

> ID：11000260
> 
> 赞同：0
> 
> 时间：2012-06-12T15:52:49.803
> 
> 标签：shell, android-emulator

为了运行一个模拟器，我使用命令

```
emulator -avd my_emulator_name & 
```

如果我想以这种方式通过 shell 自动运行 2 个（或更多）模拟器：

```
emulator -avd my_emulator_name1 &
emulator -avd my_emulator_name2 & 
```

没有模拟器将启动。一旦我启动下一个模拟器，以前的崩溃。

我在哪里犯错？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T09:07:13.900

那些在 linux 上的人可以制作这样的 shell 脚本并每次从桌面运行它。

1.  制作空文件`lauchTablets.sh`
2.  将代码复制到其中

    echo "Running 1"
    模拟器 -avd emu1 &
    sleep 5s;
    回声“完成！”

    echo "Running 2"
    模拟器 -avd emu2 &
    sleep 5s;
    回声“完成！”

    echo "Running 3"
    模拟器 -avd emu3 &
    sleep 5s;
    回声“完成！”

    echo "Running 4"
    模拟器 -avd emu4
    echo "done!"

3.  使文件可执行

我随机设置了 5 秒的睡眠时间。您可以尝试降低睡眠间隔。

# php - 如何轻松地在 PHP 中缩小 JS ......或其他

> ID：11000261
> 
> 赞同：18
> 
> 时间：2012-06-12T15:52:51.170
> 
> 标签：php, javascript, minify

我做了一些环顾四周，但我仍然有点困惑。

我尝试了 Crockford 的 JSMin，但 Win XP 出于某种原因无法解压缩可执行文件。

我真正想要的是一个简单易用的 JS 压缩器，它使用 PHP 来压缩 JS 代码并返回结果。

原因是：我有 2 个文件（例如）我正在处理：scripts.js 和 scripts_template.js

scripts_template 是我写出的普通代码——然后我必须缩小它并将缩小的脚本粘贴到 scripts.js——我在我的网站上实际使用的那个。

我想通过在我的页面上简单地做这样的事情来根除中间人：

```
<script type="text/javascript" src="scripts.php"></script> 
```

然后是scripts.php的内容：

```
<?php include("include.inc"); header("Content-type:text/javascript"); echo(minify_js(file_get_contents("scripts_template.js"))); 
```

这样，每当我更新我的 JS 时，我就不必经常去网站缩小它并将其重新粘贴到 scripts.js 中——一切都会自动更新。

是的，我也尝试过 Crockford 的 PHP Minifier 并查看了 PHP Speedy，但我还不了解 PHP 类……有没有猴子可以理解的东西，也许是 RegExp 的东西？

我们如何让这更简单？

我只想删除制表符空格——我仍然希望我的代码可读。

这并不像脚本使我的网站严重滞后，它只是有总比没有好。

标签删除，有人吗？如果可能的话，删除完全空白行怎么样？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-12T16:14:55.630

我使用[Douglas Crockford](http://www.crockford.com/javascript/jsmin.html)的 JSMin的[PHP 实现](http://code.google.com/p/minify/source/browse/min/lib/JSMin.php)已经有一段时间了。连接文件时可能会有一点风险，因为闭包末尾可能缺少分号。

缓存缩小的输出并回显缓存的内容是一个明智的主意，只要它比源文件更新即可。

```
require 'jsmin.php';

if(filemtime('scripts_template.js') < filemtime('scripts_template.min.js')) {
  read_file('scripts_template.min.js');
} else {
  $output = JSMin::minify(file_get_contents('scripts_template.js'));
  file_put_contents('scripts_template.min.js', $output);
  echo $output;
} 
```

您也可以尝试[JShrink](https://github.com/tedivm/JShrink)。我以前从未使用过它，因为我以前没有遇到过 JSMin 的困难，但是下面的这段代码应该可以解决问题。我没有意识到这一点，但 JShrink 需要 PHP 5.3 和命名空间。

```
require 'JShrink/Minifier.php';

if(filemtime('scripts_template.js') < filemtime('scripts_template.min.js')) {
  read_file('scripts_template.min.js');
} else {
  $output = \JShrink\Minifier::minify(file_get_contents('scripts_template.js'));
  file_put_contents('scripts_template.min.js', $output);
  echo $output;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T18:27:55.803

看看 Assetic，一个很棒的 PHP 资产管理库。它与 Symfony2 很好地集成并被广泛使用。

[https://github.com/kriswallsmith/assetic](https://github.com/kriswallsmith/assetic)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T20:49:23.067

根据您的服务器的限制（例如，未在[安全模式下](http://www.php.net/manual/en/features.safe-mode.php)运行），也许您还可以在 PHP 之外寻找一个缩小器并使用`shell_exec()`. 例如，如果您可以在服务器上运行 Java，则将[YUI Compressor](http://yuilibrary.com/download/yuicompressor/)的副本放在服务器上并直接使用它。

然后 scripts.php 将类似于：

```
<?php 

  $cmd = "java -cp [path-to-yui-dir] -jar [path-to-yuicompressor.jar] [path-to-scripts_template.js]";

  echo(shell_exec($cmd));

?> 
```

其他建议：在部署到服务器之前，将缩小步骤构建到您的开发工作流程中。例如，我将 Eclipse PHP 项目设置为将 JS 和 CSS 文件压缩到“build”文件夹中。奇迹般有效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-03T21:45:51.187

使用“ *PHPWee* ”：[https](https://github.com/searchturbine/phpwee-php-minifier) ://github.com/searchturbine/phpwee-php-minifier （也使用`JSmin`），我将@Robert K 解决方案推得更远一点。

此解决方案允许缩小 CSS 和 JS 文件。如果找不到非缩小文件，它将返回一个空字符串。如果缩小文件比非缩小文件旧，它将尝试创建它。如果压缩文件不存在，它将为压缩文件创建一个子文件夹。如果该方法可以成功地缩小文件，它会在`<script>`(javascript) 或`<link>`(CSS) 标记中返回它。否则，该方法将返回正确标记中的非缩小版本。

**注意**：使用 PHP 7.0.13 测试

```
/**
* Try to minify the JS/CSS file. If we are not able to minify,
*   returns the path of the full file (if it exists).
*
* @param $matches Array
*   0 = Full partial path
*   1 = Path without the file
*   2 = File name and extension
*
* @param $fileType Boolean
*   FALSE: css file.
*   TRUE: js file
*
* @return String
*/
private static function createMinifiedFile(array $matches, bool $fileType)
{
    if (strpos($matches[1], 'shared_code') !== false) {

        $path = realpath(dirname(__FILE__)) . str_replace(
            'shared_code',
            '..',
            $matches[1]
        );

    } else {

        $path = realpath(dirname(__FILE__)) .
            "/../../" . $matches[1];
    }

    if (is_file($path . $matches[2])) {

        $filePath = $link = $matches[0];

        $min = 'min/' . str_replace(
            '.',
            '.min.',
            $matches[2]
        );

        if (!is_file($path . $min) or 
            filemtime($path . $matches[2]) > 
            filemtime($path . $min)
        ) {

            if (!is_dir($path . 'min')) {

                mkdir($path . 'min');   
            }

            if ($fileType) { // JS

                $minified = preg_replace(
                        array(
                            '/(\))\R({)/',
                            '/(})\R/'
                        ),
                        array(
                            '$1$2',
                            '$1'
                        ),
                        Minify::js(
                        (string) file_get_contents(
                            $path . $matches[2]
                        )
                    )
                );

            } else { // CSS

                $minified = preg_replace(
                    '@/\*(?:[\r\s\S](?!\*/))+\R?\*/@', //deal with multiline comments
                    '',
                    Minify::css(
                        (string) file_get_contents(
                            $path . $matches[2]
                        )
                    )
                );
            }

            if (!empty($minified) and file_put_contents(
                    $path . $min, 
                    $minified 
                )
            ) {

                $filePath = $matches[1] . $min;
            }

        } else { // up-to-date

            $filePath = $matches[1] . $min;
        }

    } else { // full file doesn't exists

        $filePath = "";
    }

    return $filePath;
}

/**
* Return the minified version of a CSS file (must end with the .css extension).
*   If the minified version of the file is older than the full CSS file,
*   the CSS file will be shrunk.
*
*   Note: An empty string will be return if the CSS file doesn't exist.
*
*   Note 2: If the file exists, but the minified file cannot be created, 
*       we will return the path of the full file.
*
* @link https://github.com/searchturbine/phpwee-php-minifier Source
*
* @param $path String name or full path to reach the CSS file.
*   If only the file name is specified, we assume that you refer to the shared path.
*
* @return String
*/
public static function getCSSMin(String $path)
{
    $link = "";
    $matches = array();

    if (preg_match(
            '@^(/[\w-]+/view/css/)?([\w-]+\.css)$@',
            $path,
            $matches
        )
    ) {

        if (empty($matches[1])) { // use the default path

            $matches[1] = self::getCssPath();

            $matches[0] = $matches[1] . $matches[2];
        }

        $link = self::createMinifiedFile($matches, false);

    } else {

        $link = "";
    }

    return (empty($link) ?
        '' :
        '<link rel="stylesheet" href="' . $link . '">'
    );
}

/**
* Return the path to fetch CSS sheets.
* 
* @return String
*/
public static function getCssPath()
{
    return '/shared_code/css/' . self::getCurrentCSS() . "/";
}

/**
* Return the minified version of a JS file (must end with the .css extension).
*   If the minified version of the file is older than the full JS file,
*   the JS file will be shrunk.
*
*   Note: An empty string will be return if the JS file doesn't exist.
*
*   Note 2: If the file exists, but the minified file cannot be created, 
*       we will return the path of the full file.
*
* @link https://github.com/searchturbine/phpwee-php-minifier Source
*
* @param $path String name or full path to reach the js file.
*
* @return String
*/
public static function getJSMin(String $path)
{
    $matches = array();

    if (preg_match(
            '@^(/[\w-]+(?:/view)?/js/)([\w-]+\.js)$@',
            $path,
            $matches
        )
    ) {
        $script = self::createMinifiedFile($matches, true);

    } else {

        $script = "";
    }

    return (empty($script) ? 
        '' :
        '<script src="' . $script . '"></script>'
    );
} 
```

在 (Smarty) 模板中，您可能会使用如下方法：

```
{$PageController->getCSSMin("main_frame.css")}
//Output: <link rel="stylesheet" href="/shared_code/css/default/min/main_frame.min.css">

{$PageController->getCSSMin("/gem-mechanic/view/css/gem_mechanic.css")}
//Output: <link rel="stylesheet" href="/gem-mechanic/view/css/min/gem_mechanic.min.css">

{$PageController->getJSMin("/shared_code/js/control_utilities.js")}
//Output: <script src="/shared_code/js/min/control_utilities.min.js"></script>

{$PageController->getJSMin("/PC_administration_interface/view/js/error_log.js")}
//Output: <script src="/PC_administration_interface/view/js/min/error_log.min.js"></script> 
```

单元测试：

```
/**
* Test that we can minify CSS files successfully.
*/
public function testGetCSSMin()
{
    //invalid style
    $this->assertEmpty(
        PageController::getCSSMin('doh!!!')
    );

    //shared style
    $path = realpath(dirname(__FILE__)) . '/../css/default/min/main_frame.min.css';

    if (is_file($path)) {

        unlink ($path);
    }

    $link = PageController::getCSSMin("main_frame.css");

    $this->assertNotEmpty($link);

    $this->assertEquals(
        '<link rel="stylesheet" href="/shared_code/css/default/min/main_frame.min.css">',
        $link
    );

    $this->validateMinifiedFile($path);

    //project style
    $path = realpath(dirname(__FILE__)) . '/../../gem-mechanic/view/css/min/gem_mechanic.min.css';

    if (is_file($path)) {

        unlink ($path);
    }

    $link = PageController::getCSSMin("/gem-mechanic/view/css/gem_mechanic.css");

    $this->assertNotEmpty($link);

    $this->assertEquals(
        '<link rel="stylesheet" href="/gem-mechanic/view/css/min/gem_mechanic.min.css">',
        $link
    );

    $this->validateMinifiedFile($path);
}

/**
* Test that we can minify JS files successfully.
*/
public function testGetJSMin()
{
    //invalid script
    $this->assertEmpty(
        PageController::getJSMin('doh!!!')
    );

    //shared script
    $path = realpath(dirname(__FILE__)) . '/../js/min/control_utilities.min.js';

    if (is_file($path)) {

        unlink ($path);
    }

    $script = PageController::getJSMin("/shared_code/js/control_utilities.js");

    $this->assertNotEmpty($script);

    $this->assertEquals(
        '<script src="/shared_code/js/min/control_utilities.min.js"></script>',
        $script
    );

    $this->validateMinifiedFile($path);

    //project script
    $path = realpath(dirname(__FILE__)) . '/../../PC_administration_interface/view/js/min/error_log.min.js';

    if (is_file($path)) {

        unlink ($path);
    }

    $script = PageController::getJSMin("/PC_administration_interface/view/js/error_log.js");

    $this->assertNotEmpty($script);

    $this->assertEquals(
        '<script src="/PC_administration_interface/view/js/min/error_log.min.js"></script>',
        $script
    );

    $this->validateMinifiedFile($path);
}

/**
* Make sure that the minified file exists and that its content is valid.
*
* @param $path String the path to reach the file
*/
private function validateMinifiedFile(string $path)
{
    $this->assertFileExists($path);

    $content = (string) file_get_contents($path);

    $this->assertNotEmpty($content);

    $this->assertNotContains('/*', $content);

    $this->assertEquals(
        0,
        preg_match(
            '/\R/',
            $content
        )
    );
} 
```

**附加说明**：

1.  在`phpwee.php`我不得不替换`<?`为`<?php`.
2.  我的命名空间有问题（即使它们在同一个文件中，该函数`class_exists()`也无法找到这些类）。我通过删除每个文件中的命名空间解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-07T16:37:11.833

[JavaScriptPacker](https://github.com/meenie/javascript-packer/blob/master/class.JavaScriptPacker.php)从 2008 年开始工作，非常简单

# c# - 创建位图时可能出现内存泄漏

> ID：11000265
> 
> 赞同：0
> 
> 时间：2012-06-12T15:53:01.990
> 
> 标签：c#, winforms

计时器的每一个滴答声我都想检查接收到的数据：`"000000000"`如果这些位中的任何一个被设置为`1`然后更改图片框。这部分代码正在工作 - 但我认为我有内存泄漏问题（程序使用的内存急剧增加）。如何解决这个问题？

```
 private void RefreshingTimerTick(object sender, EventArgs e)
 {
    for (int i = 1; i < 9; i++)
    {
       if (ReceivedDataTextBox.Text[i - 1].ToString() == "1")
          ((PictureBox)this.tabPage1.Controls["pictureBox_DO" + i.ToString()]).Image = new Bitmap(@"Logos\\green.png");
       else ((PictureBox)this.tabPage1.Controls["pictureBox_DO" + i.ToString()]).Image = new Bitmap(@"Logos\\red.png");
    }
 } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-12T15:54:30.280

您需要先处理旧图像 ( `this.tabPage1.Controls["pictureBox_DO" + i.ToString()]).Image`)，然后再将其分配给新图像

```
private Bitmap _greenBitmap = new Bitmap(@"Logos\green.png"); 
private Bitmap _redBitmap = new Bitmap(@"Logos\red.png");

private void RefreshingTimerTick(object sender, EventArgs e)
{
   for (int i = 1; i < 9; i++)
   {
       PictureBox p = 
          (PictureBox)this.tabPage1.Controls["pictureBox_DO" + i.ToString()];
       if(p != null && p.Image != null)
       {  
          p.Image.Dispose();
       }

       bool is_one = (ReceivedDataTextBox.Text[i - 1].ToString() == "1");
       if(p != null)
       {
          p.Image = (is_one) ? _greenBitmap : _redBitmap;
       }
    }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:55:46.910

不要总是创造一个新的形象。尝试预先创建您的图像并将其设置为控件。

```
private Bitmap greenBitmap = new Bitmap(@"Logos\\green.png"); 
private Bitmap redBitmap = new Bitmap(@"Logos\\red.png")

private void RefreshingTimerTick(object sender, EventArgs e) 
        { 

            for (int i = 1; i < 9; i++) 
            { 
                if (ReceivedDataTextBox.Text[i - 1].ToString() == "1") 
                    ((PictureBox)this.tabPage1.Controls["pictureBox_DO" + i.ToString()]).Image = greenBitmap; 
                else ((PictureBox)this.tabPage1.Controls["pictureBox_DO" + i.ToString()]).Image = redBitmap; 
            } 
        } 
```

# core-data - RestKit - 根据传入属性删除对象

> ID：11000267
> 
> 赞同：1
> 
> 时间：2012-06-12T15:53:07.067
> 
> 标签：core-data, restkit

我正在使用通过 REST 调用接收到的带有 JSON 的基本 RestKit 映射。

```
 RKManagedObjectMapping* contactMapping = [RKManagedObjectMapping mappingForClass:[Contact class]];
[contactMapping mapAttributes:@"id", @"firstName", @"middleName", @"lastName", @"title", @"email", nil];
contactMapping.primaryKeyAttribute = @"id";

[contactMapping mapRelationship:@"addresses" withMapping:addressMapping];
[contactMapping mapRelationship:@"phoneNumbers" withMapping:phoneMapping];

// Register our mappings with the provider
[objectManager.mappingProvider setMapping:contactMapping forKeyPath:@"contacts"]; 
```

我有一个新字段，状态，我现在需要检查它是否是“删除”（或其他），如果是，则从数据库中删除该联系人（如果存在）。但是，我不知道该把它放在哪里。我是否需要创建自己的扩展对象映射类来处理这个问题？在这方面有任何例子吗？我的 Google Fu 在这方面很弱。

# user-interface - MS Access 后端控件 - 关闭、保存等

> ID：11000270
> 
> 赞同：0
> 
> 时间：2012-06-12T15:53:13.803
> 
> 标签：user-interface, ms-access, controls, split

这可能是一个简单的修复，也许我遗漏了一些明显的东西，但是当我拆分我的数据库时，它并没有完全完成，并且有一些修改要求我编辑我的后端。

为什么它不是相同的 GUI 布局（确切地说）？表格在 Access 的“窗口”中打开，最大化时无法关闭，等等。这很烦人，因为我无法关闭我的表格来处理它的关系。我只能通过在表格列表和右键单击->设计而不是在表格上方的栏上找到它来进入设计视图，等等。

当我拆分数据库时，是否有某个设置导致这些细微的 GUI 更改？我怎么把它放回去，因为它让我很烦恼；大大减慢了修改速度。

编辑：似乎出于某种原因删除了后端的“选项卡窗口”选项..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:17:13.743

MS Access 2012 中窗口的外观由选项设置控制：

`File->Options->Current Database under Document Windows Options`

# algorithm - 找到集合 S 使 S union A 中的点之间的最小距离最大化

> ID：11000271
> 
> 赞同：2
> 
> 时间：2012-06-12T15:53:16.887
> 
> 标签：algorithm, set, distance, minimize, maximize

我想找到一个给定基数**k的集合****S ，最大化每个点与给定集合****A**之间的最小距离。是否有一个简单的算法来找到这个最大最小问题的解决方案？

 ****`Given a universe X ⊆ R^d and A ⊆ X,
find the argmax_{S⊆X, |S|=k} min_{s⊆S, s'≠s ⊆ S∪A} distance(s,s')`

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T21:13:21.370

对于以 X 和 A 作为输入的给定 k，暴力破解显然在 P 中（因为 C(|X|,k) 是 |X| 中的多项式）。

如果 k 也是一个输入，那么它可能取决于 'distance' ：

如果“距离”是任意的，那么您的问题相当于在图中找到一个固定大小的集团（这是 NP 完全的）：

**NP-硬度**：

以集团问题为例，即图 (G,E) 和整数 k。向该图中添加一个连接到每个其他顶点的顶点“a”，让 (G',E') 成为您修改后的图。

(G',E') k+1 是您的第一个集团问题实例的等效实例。

创建一个从 G' 到 R^d 的映射 Phi（无论如何您都可以将 G' 映射到 N ...）并定义“距离”，使得距离（Phi(c),Phi(d')) = 1 if (c, d) ⊆ E'，否则为 0。

X = Phi(G'), A = Phi({a}), k+1 给你一个问题的实例。

可以注意到，通过构造 s ≠ Phi(a) <=> distance(s,Phi(A)) = 1 = max distance(.,.)，即 min_{s⊆S, s'≠s ⊆ S∪A } 距离(s,s') = min_{s⊆S, s'≠s ⊆ S} 距离(s,s') 如果 |S| = k >= 2

解决你的问题的这个实例 (X,A,k+1)：这给你一个基数 k+1 的集合 S 使得 min( distance(s,s') |s,s'⊆ S, s≠s' ) 是最大的。

检查是否存在 s,s'⊆ S, s≠s', distance(s,s') = 0 （这可以在 k^2 中完成为 |S| = k）：

*   如果是这种情况，则不存在基数 k+1 的集合，使得所有 s,s' distance(s,s') = 1 即不存在 G' 的子图，它是 k+1-clique
*   如果不是这种情况，则将 S 映射回 G'，根据“距离”的定义，Phi^-1 (S) 的任何顶点之间都有一条边：这是一个 k+1 集团

这通过多项式归约解决了与团问题（称为 NP-hard）等效的问题。

**NP-容易**：

让 X、A、k 成为您的问题的一个实例。

对于 X min_{s⊆S, s'≠s ⊆ S∪A} 的任何子集 S，distance(s,s') 只能取 {distance(x,y), x,y ⊆ X} 中的值 - 它有多项式基数-。

为了找到一个最大化这个距离的集合，我们将按降序测试正确集合的所有可能距离。

为了测试距离 d，我们首先将 X 简化为仅包含距离 >= d 的 A{点本身} 的点。

然后我们创建一个图 (X',E) ¤ 其中 (s,s') ⊆ E iff 距离(s,s') >= d。

测试这个图的k-clique（它是NP-easy），通过构造有一个如果它的顶点S是一组具有min_{s⊆S，s'≠s⊆S∪A}距离（s，s' ) >= d

* * *

如果“距离”是欧几里得或有任何有趣的属性，它可能在 P 中，我不知道，但如果我是你，我不会抱太大希望。

¤ 我假设 X（因此 X'）在这里是有限的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T17:36:58.763

搜索的前 2 个结果`sphere packing np complete`出现了对 1981 年论文的引用，该论文证明了 2d 中的最佳打包和覆盖是 np 完整的。我没有访问研究图书馆的权限，所以我无法阅读论文。但我希望你的问题可以改写为那个问题，在这种情况下，你有证据证明你有一个 NP 完全问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T16:02:06.863

这可能是 NP 难的。贪婪地选择离先前选择最远的点是 2 近似值。~~基于 Arora 和 Mitchell 的 Euclidean TSP 方案，可能有一个复杂的低 d 近似方案。~~对于 d = 10，忘记它。****

# c# - 我可以以更好的方式从 TcpClient 读取流吗？

> ID：11000272
> 
> 赞同：3
> 
> 时间：2012-06-12T15:53:20.583
> 
> 标签：c#, .net

我有一个系统，其中一端我有一个设备通过 RS-232 与模块通信。该模块通过 TCP 连接到 PC，并将 TCP 消息转换为 RS-232，反之亦然。

我就是这样做的：

1.  我读出了流中的每个字节
2.  建立一个字符串
3.  将字符串的后半部分与分隔符进行比较
4.  然后我停止读取流（并触发一个事件，虽然这里没有显示）。

我目前处理这个的代码是

```
 string delimiter = "\r\n";
        byte[] reply = new byte[1];
        string replyString = string.Empty;
        bool readOk = true;
        int dl = delimiter.Length;
        bool delimiterReached = false;

        do
        {
            try
            {
                stream.Read(reply, 0, 1);
            }
            catch (Exception e)
            {
                readOk = false;
                break;
            }

            replyString += Encoding.ASCII.GetString(reply, 0, reply.Length);

            int rl = replyString.Length;

            if (rl > dl)
            {
                string endString = replyString.Substring(rl-dl, dl);
                if (endString.Equals(delimiter))
                    delimiterReached = true;
            }

        } while (!delimiterReached); 
```

`stream`在哪里`TcpClient.GetStream()`

我不太关心不断的字符串构建，所以我想知道是否有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T17:17:22.123

建立 TCP 连接后，将`TcpClient`流包装在`StreamReader`：

```
var reader = new StreamReader( stream, Encoding.ASCII ); 
```

由于您的分隔符是`\r\n`,`StreamReader.ReadLine`将阅读完整的消息：

```
var reply = reader.ReadLine(); 
```

小心为`StreamReader`每个 TCP 连接创建一次；它可以从底层 TCP 流中读取和缓冲额外的数据以提高效率。

# ruby-on-rails - Rails 视图中的 DRY 视图组件

> ID：11000273
> 
> 赞同：1
> 
> 时间：2012-06-12T15:53:27.777
> 
> 标签：ruby-on-rails, views, render, block, dry

我想为我的视图创建抽象组件，这些组件不会透露它们的呈现方式。该示例是一个选项卡式导航框，类似于[引导程序中的选项卡](http://twitter.github.com/bootstrap/javascript.html#tabs)

在我看来，我想写s.th。喜欢：

```
 = tab_section(self) do
      - tab 'tab1' do
        %p tab1 content
        = link_to example_var, "#top"
      - tab 'tab2' do
        %p tab2 content
        = link_to 'http://example.com', "#top" 
```

然后应该将其呈现给s.th。像这样：

```
 <ul>
          <li>tab1</li>
          <li>tab2</li>
        </ul>
        <div class='content'>
          <div class='tab'>
            <p>tab1 content</p>
            <a href='#top'>this could also be an @var from the controller</a>
          </div>
          <div class='tab'>
            <p>tab2 content</p>
            <a href='#top'>http://example.com</a>
          </div>
        </div> 
```

我所有推迟呈现选项卡“内容”的尝试都失败了。我创建了一个[最小的 Rails 应用程序](https://github.com/axelerator/rails_components)来展示我采用的三种方法。

查看 application_helper.rb 和 welcome#show 视图。做这种事情的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T12:29:28.240

我得到了一些支持，并找到了以下解决方案：

必须将外部“组件”传递到块中才能调用内部函数：

```
 = tab_section2 do |section|
        - section.tab 'tab1' do
          %p tab1 content
          = link_to example_var, "#top"
        - section.tab 'tab2' do
          %p tab2 content
          = link_to 'http://example.com', "#top" 
```

由于我们不需要将块绑定到 tab_section 实例（之前使用 instance_exec 完成），我们可以直接生成块。

```
 def tab_section2(&blk)
        raise "Y U NO SUPPLY block?" unless block_given?
        ts = TabSection2.new(self, self)
        yield(ts)
        render :partial => '/tab2', locals: {section: ts}
      end 
```

部分渲染选项卡渲染函数的输出：

```
 %ul
      - section.tabs.each do |tab|
        %li= tab.name
    .content
      - section.tabs.each do |tab|
        .tab
          = tab.render.html_safe 
```

其实现如下：

```
 class Tab2

      attr_reader :name, :blk
      def initialize(name, context, &blk)
        @context = context
        @name = name
        @blk = blk 
      end 

      def render
        @context.capture_haml(&@blk)
      end 
    end 

    class TabSection2
      attr_reader :tabs

      def initialize(context)
        @context = context
        @tabs = []
      end 

      def tab(name, &blk)
        raise "Y U NO SUPPLY block?" unless block_given?
        @tabs << Tab2.new(name, @context, &blk)
      end 
    end 
```

# c# - 来自数组的内联字符串初始化

> ID：11000281
> 
> 赞同：2
> 
> 时间：2012-06-12T15:53:49.857
> 
> 标签：c#

所以我正在使用：

```
fileName.Split(' '); 
```

我想知道我是否可以内联初始化字符串，即：

```
string a, b, c, d = fileName.Split(' '); 
```

因此，如果文件名是“1 2 3 4”，我希望这样：

```
a=1; b=2; c=3; d=4; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T15:56:01.920

[`Split()`](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)返回`string[]`。这与内联声明无关。

简短的回答：**不**。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T15:59:54.197

在 Split() 实际计算字符串之前，您不可能知道它将返回多少个标记。

因此，即使支持此语法，它也极易受到空引用的影响（您提供了太多变量）。更糟糕的是，如果你没有提供足够的变量应该怎么办？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T15:55:54.093

不幸的是，C# 不支持该语法。您必须以“漫长”的方式进行。:(

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-12T15:58:05.417

将单独的字符串用作数组的元素有什么问题，

例如

```
string[] a = fileName.Split(' '); 
```

您将使用的变量是`a[0] = 1, a[1] = 2...`

# jsf-2 - JSF 请求范围的托管 bean http-session 导致实例化

> ID：11000283
> 
> 赞同：1
> 
> 时间：2012-06-12T15:53:51.723
> 
> 标签：jsf-2, servlet-filters, managed-bean, httpsession

我正在使用 SessionFilter servlet 来验证用户，然后向他们授予系统访问权限。我的受限文件位于名为“com.shadibandhan.Restricted”的文件夹中。会话过滤器工作正常。

这是sessionfilter servlet的相关代码

```
@Override
public void doFilter(ServletRequest req, ServletResponse res,
        FilterChain chain) throws IOException, ServletException {

    HttpServletRequest request = (HttpServletRequest) req;
    HttpServletResponse response = (HttpServletResponse) res;
    String servletPath = request.getServletPath();
    String contextPath = request.getContextPath();
    String remoteHost = request.getRemoteHost();
    String url = contextPath + servletPath;
    boolean allowedRequest = false;

    if (urlList.contains(servletPath)) {
        allowedRequest = true;
    }

    if (!allowedRequest) {
        HttpSession session = request.getSession(false);
        if (null == session) {

            System.out.println("Session is not present");
            response.sendRedirect(contextPath);
            return;

        } if (null != session) {
            //String loggedIn = (String) session.getAttribute("sb_logged_in");
            System.out.println("Session is present");
            System.out.println("\nSession no. is = " + session.getId());

            if (session.getAttribute("logged-in") == "true") {
                System.out.println("Session logged-in attribute is true, " + session.getAttribute("sessionUsername") + " is logged in.");

                //ServletContext context = request.getServletContext();
                RequestDispatcher dispatcher = request.getRequestDispatcher(servletPath);
                dispatcher.forward(request, response);
            } else {
                System.out.println("Session logged-in attribute is not true");
                response.sendRedirect(contextPath);
            }
        }
    }

    chain.doFilter(req, res);
} 
```

现在，当用户登录时，我将他的用户名和配置文件 ID 放在 httpsession 中，这是与登录页面绑定的 bean。

```
@ManagedBean
@SessionScoped
public class UserLoginManagedBean {

    private User user = null;
    private String username = null;
    private String password = null;
    private ServiceProvider server = null;
    HttpServletRequest request = null;
    HttpServletResponse response = null;
    HttpSession session = null;
    private Date date;
    private int profileActiveness=0;
    private int profileActivenessPercentage=0;

    public UserLoginManagedBean() {
        this.user = new User();
        this.server = ServiceProvider.getInstance();
    }

    public String validateLogin() {

        System.out.println("Inside validate login");
        boolean isUserValid = false;

        System.out.println(this.username + " " + this.password);

        isUserValid = this.authenticate(username, password);

        if (isUserValid) {
            //this.user = found;
            System.out.println("User is valid---Redirecting to messages.xhtml");
            return "com.shadibandhan.Restricted/profile.xhtml?faces-redirect=true";

        } else {
            //addGlobalErrorMessage("Unknown login, please try again");
            return null;
        }
    }

    public boolean authenticate(String username, String password) {
        boolean isUserValid = false;
        String status = null;

        //isUserValid = this.server.authenticateUser(this.username, this.password);

        this.user = (User) this.server.getRecordByTwoColumns(User.class, "username" , this.username, "password", this.password);

        if(null != this.user){
            isUserValid = true;
        }else{
            isUserValid = false;
        }

        if (isUserValid) {

            FacesContext context = FacesContext.getCurrentInstance();
            this.request = (HttpServletRequest) context.getExternalContext().getRequest();
            this.response = (HttpServletResponse) context.getExternalContext().getResponse();
            this.session = request.getSession(true);
//                 if there's no session, it'll creat a new one due to the true flag

            status = this.updateUserRecord();

            if (status.equals("success")) {
                if (null != this.session) {

                    session.setAttribute("sessionUsername", this.user.getUsername());
                    session.setAttribute("sessionProfileId", this.user.getProfile().getProfileId());
                    session.setAttribute("logged-in", "true");

                    System.out.println("Session username is --->" + session.getAttribute("sessionUsername"));
                }

            } else {
                isUserValid = false;
                FacesMessage msg = new FacesMessage("Something went wrong");
                FacesContext.getCurrentInstance().addMessage(null, msg);
            }
        }

        return isUserValid;
    }

    public String logOut() {
        FacesContext context = FacesContext.getCurrentInstance();
        System.out.println("inside logout method");
        this.request = (HttpServletRequest) context.getExternalContext().getRequest();

        if (null != this.request) {

            this.session = request.getSession(false);
            session.invalidate();
            System.out.println("Session is now invalidated");
            return "../index.xhtml?faces-redirect=true";
        } else {
            System.out.println("You're already signed out");
            return null;
        }
    }

    private String updateUserRecord() {
        String status = null;

       Date lastLoginDate=this.user.getLastLogin();
       Date currentDate= new Date();
       this.profileActiveness=this.user.getProfileActiveness();

                SimpleDateFormat format = new SimpleDateFormat("yy-MM-dd HH:mm:ss");

        try {
            lastLoginDate = format.parse(lastLoginDate.toString());
            currentDate = format.parse(currentDate.toString());
        } catch (ParseException e) {
            e.printStackTrace();
        }    

        // Get msec from each, and subtract.
        long diff = currentDate.getTime() - lastLoginDate.getTime();
        long diffSeconds = diff / 1000;         
        long diffMinutes = diff / (60 * 1000);         
        long diffHours = diff / (60 * 60 * 1000);                      
        System.out.println("Time: " + diff + " .");
        System.out.println("Time in seconds: " + diffSeconds + " seconds.");         
        System.out.println("Time in minutes: " + diffMinutes + " minutes.");         
        System.out.println("Time in hours: " + diffHours + " hours.");
        if(diffHours<12)
        {
            if(profileActiveness<8){
            profileActiveness++;
            profileActivenessPercentage=(int) (profileActiveness*12.5);
            this.user.setProfileActiveness(this.profileActiveness);
            }
            }
        if(diffHours>71)
        {
            if(profileActiveness>2){
            profileActiveness-=2;
            profileActivenessPercentage=(int) (profileActiveness*12.5);
            this.user.setProfileActiveness(this.profileActiveness);
            }
            else{
            profileActiveness=0;
            }
        }

        this.user.setLastLogin(this.getCurrentDate());
        this.user.setLoginStatus(true);

        status = this.server.updateObject(this.user);

        return status;
    }

    // ...
} 
```

而且，在另一个名为 MessagesManagedBean 的托管 bean（请求范围）中，当我在用户登录后尝试获取配置文件 id 时，它就像一个魅力。

现在，我有两个问题：

1.  每当我尝试从受限文件夹访问页面时，该页面绑定了一个 bean，其中包含一些与 http 会话相关的代码，在本例中为 MessagesManagedBean，它给了我一个无法实例化 bean 异常，因为我正在获取属性在构造函数中，为什么？
2.  甚至，当我没有登录时，每当我尝试访问与它绑定的页面时，它都会调用 bean 构造函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T15:58:02.110

您`chain.doFilter()`在致电后继续请求`response.sendRedirect()`。`sendRedirect()`仅使用浏览器将处理的新 URL 设置响应`Location`标头。但是如果你继续请求`chain.doFilter()`，那么整个JSF流程仍然会被执行。

您需要`return;`在调用后添加一条语句`sendRedirect()`以退出过滤器。

```
} else {
    System.out.println("Session logged-in attribute is not true");
    response.sendRedirect(contextPath);
    return;
} 
```

* * *

**与具体问题无关**，您在会话范围 bean 中存在重大设计错误。您永远不应该将 HTTP 请求、响应和会话分配为 bean 的实例变量。这使您的会话范围 bean 线程不安全。*删除*所有这些属性并仅在同一方法块内声明它们为线程本地的。

# image - 色调和温度

> ID：11000284
> 
> 赞同：2
> 
> 时间：2012-06-12T15:54:08.557
> 
> 标签：image, colors, rgb, temp, tint

虽然我找到了很多关于色彩和温度的话题，但直到现在我还没有看到任何明确的解决方案，这就是我创建这篇文章的原因......对此我深表歉意。

我有兴趣从 RGB 值调整图像的色温和色调，这有点类似于 iOS 中的 iPhoto 应用程序，可以使用从左到右的滑块进行调整。无论我发现什么，温度和色调都是正交属性，其中温度调整沿蓝色（左；冷色）--黄色（右；暖色）和沿绿色（左）-洋红色（右）轴的色调。如何使用来自 RGB 值的公式来调整它们，即色温和色调滑块的基本实现。我可以将它们转换为 HSV 空间，然后我可以将色调轮通道旋转到那些（蓝色、黄色、绿色、洋红色）角度，但是如何通过从低级别逐渐改变来以类似于滑块实现的系统方式来完成它们（滑块的中间）到高级（滑块的右/左端）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-03T21:07:47.710

您应该尝试使用 HSL 而不是 HSV。当涉及到数学计算时，HSL 饱和度将其与色调和亮度分开，具有非常明确的范围。

在 HSL 中，要添加色调，您需要将 L 因子在 50-100 之间移动，而要添加阴影，L 因子在 0-50 之间变化。与 HSV 不同，HSL 的饱和度也直接控制音调。

对于温度，您必须设计自己的策略来改变红色和蓝色之间的颜色，但我可以给您的一个金色提示是“每种纯 RGB 颜色都有 3 个颜色值之一为零，第二个固定为 255，第三个随255/60 的系数。

希望这可以帮助-

# oracle - 如何在 PL/SQL 中使用游标显示嵌套表的内容

> ID：11000290
> 
> 赞同：0
> 
> 时间：2012-06-12T15:54:25.413
> 
> 标签：oracle, plsql, cursor, nested-table

我想使用游标显示嵌套表的内容。我尝试了以下方法，但它不起作用。“put_line”中的参数不正确，但我不知道为什么。

```
create or replace type toys_t as table of varchar2(40);

create or replace type kid_t as object (name varchar2(10), toys toys_t);

create table kid of kid_t nested table toys store as table_toys;

insert into kid values('Bob', toys_t('truck','ball','doll'));

select t.* from kid k, table(k.toys) t where k.name = 'Bob';

declare

cursor cursor_table is
   select t.* from kid k, table(k.toys) t where k.name = 'Bob';

begin

   for i in cursor_table loop
      dbms_output.put_line(i);
   end loop;

end; 
```

这很简单。一个孩子有一个名字和一个玩具列表，我想展示玩具，但不是从“选择”而是光标。

感谢您的帮助。

鲍勃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T15:58:08.180

您需要在循环中引用列名

```
SQL> ed
Wrote file afiedt.buf

  1  declare
  2    cursor cursor_table is
  3     select t.* from kid k, table(k.toys) t where k.name = 'Bob';
  4  begin
  5     for i in cursor_table loop
  6        dbms_output.put_line(i.column_value);
  7     end loop;
  8* end;
SQL> /
truck
ball
doll

PL/SQL procedure successfully completed. 
```

# c# - MVC4 SignalR“信号器/集线器”501 未实现错误

> ID：11000293
> 
> 赞同：3
> 
> 时间：2012-06-12T15:54:32.073
> 
> 标签：c#, asp.net-mvc-4, signalr, visual-studio-2012

**更新：** 切换到 IIS Express 而不是 Visual Studio 开发服务器修复了 501 错误。

我试图让 SignalR 在我的 MVC4 应用程序中工作，但我遇到了一个奇怪的 501 错误。我遵循了几个不同的教程，但结果总是一样的。

任何帮助，将不胜感激。

我正在使用 Visual Studio 2012 Pro RC，并通过包管理器控制台安装了 SignalR 0.5.1。

我的代码：

布局

```
<script src="~/Scripts/jquery-1.7.2.min.js"></script>
<script src="~/Scripts/jquery.signalR-0.5.1.js" type="text/javascript"></script>
<script type="text/javascript" src="@Url.Content("~/signalr/hubs")"></script> 
```

看法

```
<script type="text/javascript">
$(function () {

    // capture the client IP
    var clientIp = $("#clientip").val();

    // create the SignalR proxy
    var userlink = $.connection.userlink;

    // create our callback for the proxy
    userlink.updateViewCount = function (message) {
        $('#view-updates').html('<p>' + message + '</p>');
    };

    // Start the connection
    $.connection.hub.start(function () {
        // send our 'record' message to the hub
        userlink.recordView(clientIp);
    });

});
</script>

<input type="hidden" id="client-ip" value="@ViewBag.ClientIpAddress" />
<div id="view-updates"></div> 
```

集线器类

```
public class UserLink : Hub
{
    public void RecordView(string IpAddress)
    {
        QContext db = new QContext();
        db.SiteVisits.Add(new SiteVisit { CreateDate = DateTime.Now, IpAddress = IpAddress });
        db.SaveChanges();

        int userCount = db.SiteVisits.Count();

        string result = string.Format("There have been {0} visits to this page.", userCount);

        Clients.updateViewCount(result);
    }
} 
```

我收到的错误

```
Failed to load resource: the server responded with a status of 501 (Not Implemented) http://localhost:58361/signalr/hubs
Uncaught TypeError: Cannot set property 'updateViewCount' of undefined 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T15:30:54.770

如果您还没有解决这个问题，我认为您可能需要这样做：

```
[HubName("userlink")]
public class UserLink : Hub
{
   // Implementation
} 
```

顺便说一句，如果您的站点中有 /Signalr 文件夹，这可能是导致 501 的原因。这会导致与`~/signalr/hubs`使用内置 Visual Studio Web 服务器的 javascript 引用发生冲突，但在 IISExpress 中可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T19:49:59.027

在 IIS 而不是 Visual Studio 开发服务器中进行调试可以解决这个问题，但我不知道为什么。现在我很好奇是否有人知道为什么它会在一个而不是另一个中起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-31T23:26:53.793

对原始问题没有必要有用，但其他到达这里的问题，如果使用**SignalR 0.5.x 版本**并安装了 Visual Studio MVC 工具，可能会发生冲突。

VS 工具和 SignalR 之间存在已知的冲突，该冲突将很快得到修复。

只需
`Microsoft ASP.NET MVC 3 & 4 - Visual Studio 2010 Tools`
从
`Control Panel\Programs\Programs and Features`

# magento - 如何覆盖 OnePage Checkout 上的评论选项卡

> ID：11000297
> 
> 赞同：1
> 
> 时间：2012-06-12T15:54:57.353
> 
> 标签：magento

我正在编写一个自定义模块来更改表在 checkout/onepage/onepage.phtml 上的显示我可以在 checkout.xml 中看到它是如何声明的

```
<block type="checkout/onepage_review" name="checkout.onepage.review" as="review" template="checkout/onepage/review.phtml">
     <block type="checkout/agreements" name="checkout.onepage.agreements" as="agreements" template="checkout/onepage/agreements.phtml"/>
</block> 
```

我想不通的是如何设置 /app/design/frontend/{location}/{theme}/layout/{module}.xml 文件以用新模板覆盖当前的 review.phtml 模板。我的想法是删除当前的并重新加载新的，但这似乎不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T16:25:05.883

我能看到的第一件事是您使用的目录不正确。

它应该是

```
app/design/frontend/{location}/{theme}/layout/{module}.xml 
```

代替

```
app/layout/frontend/{location}/{theme}/layout/{module}.xml 
```

另外，我不确定您要如何覆盖审阅布局表，但以下内容将用您自己的审阅模板替换：

```
<checkout_onepage_review>
    <reference name="root">
       <action method="setTemplate"><template>checkout/onepage/your_template.phtml</template></action>
    </reference>
</checkout_onepage_review> 
```

其次，如果您正在创建自定义模块并希望加载布局文件，则必须在模块 config.xml 中声明布局更新。你做过吗？

它看起来类似于：

```
<?xml version="1.0"?>

<config>
    <modules>
        <Your_Company_Your_Module>
            <version>1.0.0</version>
        </Your_Company_Your_Module>
    </modules>
    <frontend>
        <layout>
            <updates>
                <yourmodule>
                    <file>yourmodule.xml</file>
                </yourmodule>
            </updates>
        </layout>
    </frontend>
</config> 
```

最后，根据您要实现的目标，您可能不需要一个模块来覆盖结帐审查表。

如果模块的唯一目的是简单地覆盖结帐布局，那么使用以下方法之一覆盖布局可能就足够了：

1.  使用 local.xml

    在主题布局目录中创建一个 local.xml 文件：

    /app/design/frontend/{location}/{theme}/layout/{module}.xml

    并将其用于所有核心布局覆盖。这有很多好处。

2.  将基本 checkout.xml 布局文件复制到您的主题

    复制 app/design/frontend/base/default/layout/checkout.xml 到 app/design/frontend/{location}/{theme}/layout/checkout.xml

# cakephp - 虚拟主机无法使用 CakePHP 和 MAMP 正确重定向

> ID：11000304
> 
> 赞同：1
> 
> 时间：2012-06-12T15:55:25.537
> 
> 标签：cakephp, mamp, virtualhost

我正在使用 cakePHP 开发一个网络（使用 MAMP 作为 localhost），我刚刚将一个虚拟主机配置到我的项目的根目录。

我`/etc/hosts`的是

```
127.0.0.1 localhost
127.0.0.1 altair.loc 
```

和我的`httpd.conf`

```
NameVirtualHost *
<VirtualHost *>
    DocumentRoot "/Volumes/Macintosh HD/Users/robotThree/www/"
    ServerName localhost
</VirtualHost>
<VirtualHost *>
    DocumentRoot "/Volumes/Macintosh HD/Users/robotThree/www/ALTAIR/altair/"
    ServerName altair.loc
</VirtualHost> 
```

有了这个，我可以访问我的项目类型`http://altair.loc`，并且所有控制器和操作都可以完美运行（即`http://altair.loc/controller/action`）。

问题是所有静态访问的文件都失败了。例如`http://altair.loc/css/main.css`失败，但如果我输入`http://altair.loc/ALTAIR/altair/css/main.css`，它就可以工作，就好像没有配置虚拟主机一样。

你知道会发生什么吗？先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:15:43.330

解决了。有`httpd.conf`必要检查 Override 是否适用于所有人，这是一个`.htaccess`问题`mod_rewrite`：

```
<Directory />
    Options Indexes FollowSymLinks
    AllowOverride All
</Directory> 
```

# java - 行走树 - 标签值的长度

> ID：11000307
> 
> 赞同：2
> 
> 时间：2012-06-12T15:55:37.913
> 
> 标签：java, string, tree, sum

这是我要解决的问题。我有一个简单的 HTML 页面：

```
<html>
<head></head>
<body>
    <table>
        <tr>
            <td>Hello</td>
            <td>World</td>
        </tr>
        <tr>
            <td>Goodby</td>
            <td>World</td>
        </tr>
    </table>
</body> 
```

我想要做的是遍历整个树并存储每个文本节点的长度。它不仅应该包含当前节点的长度，而且实际上应该包含所有先前文本节点的长度。让我澄清一下这个例子的意思：

```
<html>
<head></head>
<body>
    <table>
        <tr>
            <td>Hello</td> // console output should be string of length: 5
            <td>World</td> // console output should be string of length: 10
        </tr>
        <tr>
            <td>Goodby</td> // console output should be string of length: 16
            <td>World</td> // console output should be string of length: 21
        </tr>
    </table>
</body> 
```

为此，我实现了以下代码：

```
private static void print(Node aNode, int aCounter, String aIndent) 
{
    if(aNode.getNodeValue() != null)
        System.out.println(aIndent+aNode.getNodeName() + ", "+aNode.getNodeValue() + ", length: " + aCounter);
    else
        System.out.println(aIndent+aNode.getNodeName());

    Node child = aNode.getFirstChild();

    while (child != null) 
    {
        if(child.getNodeValue() != null)
        {
            aCounter += child.getNodeValue().length();
            print(child, aCounter, aIndent+" ");
        }
        else
            print(child, aCounter, aIndent+" ");

        child = child.getNextSibling();
    }
} 
```

我将根节点传递给此方法。这段代码的问题是它只返回路径的长度。这意味着我得到这样的东西：

```
<html>
<head></head>
<body>
    <table>
        <tr>
            <td>Hello</td> // console output is string of length: 5
            <td>World</td> // console output is string of length: 10
        </tr>
        <tr>
            <td>Goodby</td> // console output should be string of length: 6 <-- does not consider overall length of previous <tr> content
            <td>World</td> // console output should be string of length: 11
        </tr>
    </table>
</body> 
```

所以基本上我想要从根节点到当前标签末尾的所有字符的长度。不幸的是，我不知道该怎么做。任何帮助将不胜感激。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:03:36.243

`aCounter`是按值传递的（不是按引用传递），因此从递归调用的方法向其添加值不会影响调用方法中的值。您可能希望将新值返回`aCounter`给调用方法，以便它可以更新自己的版本。

像这样的东西应该工作：

```
private static void print(Node aNode, int aCounter, String aIndent) 
{
    if(aNode.getNodeValue() != null)
        System.out.println(aIndent+aNode.getNodeName() + ", "+aNode.getNodeValue() + ", length: " + aCounter);
    else
        System.out.println(aIndent+aNode.getNodeName());

    Node child = aNode.getFirstChild();

    while (child != null) 
    {
        if(child.getNodeValue() != null)
        {
            aCounter += child.getNodeValue().length();
        }
        aCounter = print(child, aCounter, aIndent+" ");

        child = child.getNextSibling();
    }

    return aCounter;
} 
```

（尽管您可能需要重新考虑变量和方法的名称以使其更具可读性。）

# php - Facebook Graph API 和 FQL 在 PHP 中出现错误

> ID：11000308
> 
> 赞同：0
> 
> 时间：2012-06-12T15:55:46.630
> 
> 标签：php, facebook-graph-api, facebook-fql, facebook-php-sdk

我正在尝试使用图形 api 运行 FQL。

```
$graph_url = "https://graph.facebook.com/fql?q=".$fql."&access_token=". $access_token;

$output = json_decode(file_get_contents($graph_url));

var_dump($output); 
```

这给出了一个错误

> `[function.file-get-contents]: failed to open stream: HTTP request failed! HTTP/1.0 400 Bad Request`

如果我在浏览器中复制并粘贴内容`$graph_url`，我会得到预期的结果。所以，我确定我的 access_token 和 fql 查询是正确的。

另外，如果我尝试通过

```
 $graph_url = "https://graph.facebook.com/me/?access_token=". $access_token;

  $output = json_decode(file_get_contents($graph_url));

  var_dump($output); 
```

我没有收到任何错误，而是预期的结果。我不确定，我的 fql 查询中缺少什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:19:57.350

我能做的最好的选择是 urlencode 问题。

试试这个，

```
$graph_url = "https://graph.facebook.com/fql?q=".urlencode($fql)."&access_token=". $access_token; 
```

# objective-c - 将 1 个视图控制器链接到两个 .h 文件

> ID：11000315
> 
> 赞同：0
> 
> 时间：2012-06-12T15:56:04.483
> 
> 标签：objective-c, xcode

在我的应用程序中，我在故事板上有一个视图控制器，链接到 .h 文件。我想插入一个 UITableView，并将其链接到单独的视图控制器.h。但问题是在我的视图控制器的类中，我只能选择一个.h，而不是两个，所以我无法链接表格视图。如果我在第二个视图控制器上充电它可以工作，但这样就不行了。我能做些什么？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:16:53.037

如果我了解您想要做什么，您希望将 tableViewController 的表的访问权限授予另一个 viewController。

UITableViewController 具有`tableView`可以传递给 viewController 或任何其他需要此 tableView 的类的属性。您可以传递它，例如，在需要此 tableView 的类中使用属​​性。像这样：

```
@property (nonatomic, assign) UITableView* tableView 
```

在此之后，您将能够编写此代码

```
[classInstanceThatNeedTable setTableView:tableView]; 
```

# jquery - Jquery推文时间范围参数

> ID：11000317
> 
> 赞同：1
> 
> 时间：2012-06-12T15:56:07.570
> 
> 标签：jquery

以下是 JQuery Tweet 插件采用的参数列表。 [http://tweet.seaofclouds.com/jquery.tweet.js](http://tweet.seaofclouds.com/jquery.tweet.js) 我需要检索仅提及某个单词的推文列表可以追溯到 4-5 周，我如何增加插件提取推文的时间范围从

```
 $.fn.tweet = function(o){
    var s = $.extend({
      username: null,                           // [string or array] required unless using the 'query' option; one or more twitter screen names (use 'list' option for multiple names, where possible)
      list: null,                               // [string]   optional name of list belonging to username
      favorites: false,                         // [boolean]  display the user's favorites instead of his tweets
      query: null,                              // [string]   optional search query (see also: http://search.twitter.com/operators)
      avatar_size: null,                        // [integer]  height and width of avatar if displayed (48px max)
      count: 3,                                 // [integer]  how many tweets to display?
      fetch: null,                              // [integer]  how many tweets to fetch via the API (set this higher than 'count' if using the 'filter' option)
      page: 1,                                  // [integer]  which page of results to fetch (if count != fetch, you'll get unexpected results)
      retweets: true,                           // [boolean]  whether to fetch (official) retweets (not supported in all display modes)
      intro_text: null,                         // [string]   do you want text BEFORE your your tweets?
      outro_text: null,                         // [string]   do you want text AFTER your tweets?
      join_text:  null,                         // [string]   optional text in between date and tweet, try setting to "auto"
      auto_join_text_default: "I said,",        // [string]   auto text for non verb: "I said" bullocks
      auto_join_text_ed: "I",                   // [string]   auto text for past tense: "I" surfed
      auto_join_text_ing: "I am",               // [string]   auto tense for present tense: "I was" surfing
      auto_join_text_reply: "I replied to",     // [string]   auto tense for replies: "I replied to" @someone "with"
      auto_join_text_url: "I was looking at",   // [string]   auto tense for urls: "I was looking at" http:...
      loading_text: null,                       // [string]   optional loading text, displayed while tweets load
      refresh_interval: null,                   // [integer]  optional number of seconds after which to reload tweets
      twitter_url: "twitter.com",               // [string]   custom twitter url, if any (apigee, etc.)
      twitter_api_url: "api.twitter.com",       // [string]   custom twitter api url, if any (apigee, etc.)
      twitter_search_url: "search.twitter.com", // [string]   custom twitter search url, if any (apigee, etc.)
      template: "{avatar}{time}{join}{text}",   // [string or function] template used to construct each tweet <li> - see code for available vars
      comparator: function(tweet1, tweet2) {    // [function] comparator used to sort tweets (see Array.sort)
        return tweet2["tweet_time"] - tweet1["tweet_time"]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:53:56.797

我想也许算数：这个技巧是因为你获取的推文数量越多，时间越早，有什么想法吗？

# java - detachCopy 正在使用 ObjectDB 开发 JDO？

> ID：11000318
> 
> 赞同：1
> 
> 时间：2012-06-12T15:56:12.797
> 
> 标签：java, spring, persistence, jdo, objectdb

pm.detachCopy 有效吗？

我正在制作一个 Spring + ObjectDB(JDO) 程序。

尽管@PersistenceCapable:detachable 为真，但 PersistenceManager#detachCopy 返回一个瞬态对象。

这是一个示例代码。

我有一个简单的测试模型（POJO）

```
@PersistenceCapable(identityType = IdentityType.APPLICATION, detachable="true")
public class TestModel {
@Persistent(valueStrategy=IdGeneratorStrategy.IDENTITY)
@PrimaryKey
private Long id;
@Persistent
private String name;
// getter, setter
} 
```

可分离设置为“真”。

道是

```
public class TestModelDaoImpl {
    private PersistenceManagerFactory persistenceManagerFactory;
    public void setPersistenceManagerFactory(PersistenceManagerFactory pmf) {
        this.persistenceManagerFactory = pmf;
    }

    public TestModel makePersistent(TestModel obj){
        PersistenceManager pm = persistenceManagerFactory.getPersistenceManager();
        Transaction tx = pm.currentTransaction();
        tx.begin();
        pm.makePersistent(obj);
        System.out.println(" obj => " + JDOHelper.getObjectState(obj)); //  => (1) persistent-new
        TestModel detachedObj = pm.detachCopy(obj);
        System.out.println(" detachedObj => " + JDOHelper.getObjectState(detachedObj)); // => (2) transient .. 
        tx.commit();
        return detachedObj;
        // try catch is omitted
    }
} 
```

我想我在 (2) 处有一个超然的状态。但是是短暂的。

ObjectDB 的版本是 2.4.0_05

应用程序上下文.xml

```
    <bean id="pmf" class="org.springframework.orm.jdo.LocalPersistenceManagerFactoryBean">
        <property name="jdoProperties">
            <道具>
               <prop key="javax.jdo.PersistenceManagerFactoryClass">com.objectdb.jdo.PMF</prop>
               <prop key="javax.jdo.option.ConnectionURL">$objectdb/db/testdb.odb</prop>
               <prop key="javax.jdo.option.ConnectionUserName">管理员</prop>
               <prop key="javax.jdo.option.ConnectionPassword">管理员</prop>
            </道具>
        </属性>
    </豆>
    <bean id="jdoTransactionManager" class="org.springframework.orm.jdo.JdoTransactionManager">
        <property name="persistenceManagerFactory">
            <ref local="pmfProxy"/>
        </属性>
    </豆>
    <bean id="pmfProxy" class="org.springframework.orm.jdo.TransactionAwarePersistenceManagerFactoryProxy">
        <property name="targetPersistenceManagerFactory" ref="pmf"/>
        <property name="allowCreate" value="true"/>
    </豆>

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:34:49.047

JDO 需要增强所有可持久类。ObjectDB 支持使用没有增强的可持久类作为 JDO 的扩展，但在该模式下并非所有 JDO 特性都可以支持。

特别是，当使用非增强持久性类的实例时，瞬态对象和分离对象看起来相同（因为该类缺少在增强期间添加的额外字段以保留附加信息）。

使用增强的 TestModel 类运行测试可提供预期结果：

> obj => 持久新
> 
> detachedObj => 分离清洁

# javascript - 如何让社交媒体按钮在滚动时保持在屏幕上的固定位置？

> ID：11000321
> 
> 赞同：0
> 
> 时间：2012-06-12T15:56:21.800
> 
> 标签：javascript, asp.net, css, social-networking

在 asp.net 中，如何创建一种方法来包含社交媒体按钮并在滚动页面时将它们保持在同一个位置？简单地使用“位置：固定”是行不通的。

CSS页面：

```
.sharebox
{
    position: fixed; 
    top: 70px;
    width: 50px;
    height:110px;
    left: 30px; 
    background-color: #c0c0c0;
    padding: 0;
    color: #335500;
} 
```

然后我的社交媒体按钮在 div class="sharebox"

# asp.net-mvc-4 - 安装 mvc 4 时出错

> ID：11000322
> 
> 赞同：2
> 
> 时间：2012-06-12T15:56:28.443
> 
> 标签：asp.net-mvc-4

请原谅这篇文章的长度，我想包括我认为调试所需的所有信息。

经过多次尝试，我无法为 vs 2010 安装 mvc 4。我安装了 mvc 4 beta，因为我创建了一个 webapi 项目。我还安装了 mvc 2 & 3。我使用 Programs n Features 中的（捆绑）链接卸载了 mvc 4 ...现在尝试安装 mvc 4，但我收到了一个无法描述的错误日志，我无法做出正面或反面...任何帮助将不胜感激.

我的系统环境包含

windows 7 x64 企业版 vs 2010 sp1（请参阅日志文件下方的信息）Web 平台安装程序 4.0

```
[201C:04BC][2012-06-12T11:09:18]: Burn v3.6.2712.0, path: C:\Users\<userName>\AppData\Local\Microsoft\Web Platform Installer\installers\MVC4VS2010\8EDB940F9A4EEC0C0F0324B5D647F17738C665CA\AspNetMVC4Setup.exe, cmdline: '/q /log C:\Users\<userName>\AppData\Local\Temp\MVC4_install.htm -burn.unelevated BurnPipe.{B9B09A3A-ED62-4F21-931F-941AE3AD242A} {FC1D5F36-4FCF-44CC-A4A5-B430AEC97063} 7584'
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleLog' to value 'C:\Users\<userName>\AppData\Local\Temp\MVC4_install.htm'
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleOriginalSource' to value 'C:\Users\<userName>\AppData\Local\Microsoft\Web Platform Installer\installers\MVC4VS2010\8EDB940F9A4EEC0C0F0324B5D647F17738C665CA\AspNetMVC4Setup.exe'
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleName' to value 'Microsoft ASP.NET MVC 4'
[201C:04BC][2012-06-12T11:09:18]: Detect 9 packages
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'netfx4' to value '4.0.30319'
[201C:04BC][2012-06-12T11:09:18]: Setting version variable 'PowerShellExeVersion' to value '6.1.7600.16385'
[201C:04BC][2012-06-12T11:09:18]: Setting numeric variable 'procore2010_exists' to value 1
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'procore2010_sp1' to value '40219.342'
[201C:04BC][2012-06-12T11:09:18]: Registry key not found. Key = 'Software\Microsoft\DevDiv\VS\Servicing\10.0\vstdcore'
[201C:04BC][2012-06-12T11:09:18]: Setting numeric variable 'vstdcore2010_exists' to value 0
[201C:04BC][2012-06-12T11:09:18]: Registry key not found. Key = 'Software\Microsoft\DevDiv\VS\Servicing\10.0\vstdcore'
[201C:04BC][2012-06-12T11:09:18]: Registry key not found. Key = 'Software\Microsoft\DevDiv\VS\Servicing\10.0\vstscore'
[201C:04BC][2012-06-12T11:09:18]: Setting numeric variable 'vstscore2010_exists' to value 0
[201C:04BC][2012-06-12T11:09:18]: Registry key not found. Key = 'Software\Microsoft\DevDiv\VS\Servicing\10.0\vstscore'
[201C:04BC][2012-06-12T11:09:18]: Registry key not found. Key = 'Software\Microsoft\DevDiv\vns\Servicing\10.0\xcor'
[201C:04BC][2012-06-12T11:09:18]: Setting numeric variable 'xcor2010_exists' to value 0
[201C:04BC][2012-06-12T11:09:18]: Registry key not found. Key = 'Software\Microsoft\DevDiv\vns\Servicing\10.0\xcor'
[201C:04BC][2012-06-12T11:09:18]: Detected package: VS10SP1_KB2581019_x86.exe, state: Absent, cached: Complete
[201C:04BC][2012-06-12T11:09:18]: Detected package: VS10SP1_KB2591016_x86.exe, state: Absent, cached: Complete
[201C:04BC][2012-06-12T11:09:18]: Detected package: Nuget.msi, state: Absent, cached: Complete
[201C:04BC][2012-06-12T11:09:18]: Detected package: AspNetWebPages2.msi, state: Present, cached: Complete
[201C:04BC][2012-06-12T11:09:18]: Detected package: AspNetWebPages2VS2010Tools.msi, state: Absent, cached: Complete
[201C:04BC][2012-06-12T11:09:18]: Detected package: AspNetWebPages2VWD2010Tools.msi, state: Absent, cached: None
[201C:04BC][2012-06-12T11:09:18]: Detected package: AspNetMVC4.msi, state: Absent, cached: Complete
[201C:04BC][2012-06-12T11:09:18]: Detected package: AspNetMVC4VS2010Tools.msi, state: Absent, cached: Complete
[201C:04BC][2012-06-12T11:09:18]: Detected package: AspNetMVC4VWD2010Tools.msi, state: Absent, cached: None
[201C:04BC][2012-06-12T11:09:18]: Condition '((NOT vstscore2010_exists) OR ((vstscore2010_sp1 >= v40219.01) AND (vstscore2010_exists))) AND ((NOT vstdcore2010_exists) OR ((vstdcore2010_sp1 >= v40219.01) AND (vstdcore2010_exists))) AND ((NOT procore2010_exists) OR ((procore2010_sp1 >= v40219.01) AND (procore2010_exists)))' evaluates to true.
[201C:04BC][2012-06-12T11:09:18]: Condition '(NOT xcor2010_exists) OR ((xcor2010_sp1 >= v40219.01) AND (xcor2010_exists))' evaluates to true.
[201C:04BC][2012-06-12T11:09:18]: Condition 'netfx4 >= v4.0.30319' evaluates to true.
[201C:04BC][2012-06-12T11:09:18]: Condition 'NOT (netfx4 > v4.0.30319 AND netfx4 < v4.5.50131)' evaluates to true.
[201C:04BC][2012-06-12T11:09:18]: Condition 'PowerShellExeVersion >= v2.0' evaluates to true.
[201C:04BC][2012-06-12T11:09:18]: Detect complete, result: 0x0
[201C:04BC][2012-06-12T11:09:18]: Plan 9 packages, action: Install
[201C:04BC][2012-06-12T11:09:18]: Condition '((vstscore2010_sp1 >= v40219.01) AND (vstscore2010_exists)) OR ((vstdcore2010_sp1 >= v40219.01) AND (vstdcore2010_exists)) OR ((procore2010_sp1 >= v40219.01) AND (procore2010_exists)) OR ((xcor2010_sp1 >= v40219.01) AND (xcor2010_exists))' evaluates to true.
[201C:04BC][2012-06-12T11:09:18]: Skipping dependency registration on package with no dependency providers: VS10SP1_KB2581019_x86.exe
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleLog_VS10SP1_KB2581019_x86.exe' to value 'C:\Users\<userName>\AppData\Local\Temp\MVC4_install_0_VS10SP1_KB2581019_x86.exe.htm'
[201C:04BC][2012-06-12T11:09:18]: Condition '((vstscore2010_sp1 >= v40219.01) AND (vstscore2010_exists)) OR ((vstdcore2010_sp1 >= v40219.01) AND (vstdcore2010_exists)) OR ((procore2010_sp1 >= v40219.01) AND (procore2010_exists)) OR ((xcor2010_sp1 >= v40219.01) AND (xcor2010_exists))' evaluates to true.
[201C:04BC][2012-06-12T11:09:18]: Skipping dependency registration on package with no dependency providers: VS10SP1_KB2591016_x86.exe
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleLog_VS10SP1_KB2591016_x86.exe' to value 'C:\Users\<userName>\AppData\Local\Temp\MVC4_install_1_VS10SP1_KB2591016_x86.exe.htm'
[201C:04BC][2012-06-12T11:09:18]: Condition '((vstscore2010_sp1 >= v40219.01) AND (vstscore2010_exists)) OR ((vstdcore2010_sp1 >= v40219.01) AND (vstdcore2010_exists)) OR ((procore2010_sp1 >= v40219.01) AND (procore2010_exists)) OR ((xcor2010_sp1 >= v40219.01) AND (xcor2010_exists))' evaluates to true.
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleRollbackLog_Nuget.msi' to value 'C:\Users\<userName>\AppData\Local\Temp\MVC4_install_2_Nuget.msi_rollback.htm'
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleLog_Nuget.msi' to value 'C:\Users\<userName>\AppData\Local\Temp\MVC4_install_2_Nuget.msi.htm'
[201C:04BC][2012-06-12T11:09:18]: Condition '((vstscore2010_sp1 >= v40219.01) AND (vstscore2010_exists)) OR ((vstdcore2010_sp1 >= v40219.01) AND (vstdcore2010_exists)) OR ((procore2010_sp1 >= v40219.01) AND (procore2010_exists))' evaluates to true.
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleRollbackLog_AspNetWebPages2VS2010Tools.msi' to value 'C:\Users\<userName>\AppData\Local\Temp\MVC4_install_3_AspNetWebPages2VS2010Tools.msi_rollback.htm'
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleLog_AspNetWebPages2VS2010Tools.msi' to value 'C:\Users\<userName>\AppData\Local\Temp\MVC4_install_3_AspNetWebPages2VS2010Tools.msi.htm'
[201C:04BC][2012-06-12T11:09:18]: Condition '(xcor2010_sp1 >= v40219.01) AND (xcor2010_exists)' evaluates to false.
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleRollbackLog_AspNetMVC4.msi' to value 'C:\Users\<userName>\AppData\Local\Temp\MVC4_install_4_AspNetMVC4.msi_rollback.htm'
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleLog_AspNetMVC4.msi' to value 'C:\Users\<userName>\AppData\Local\Temp\MVC4_install_4_AspNetMVC4.msi.htm'
[201C:04BC][2012-06-12T11:09:18]: Condition '((vstscore2010_sp1 >= v40219.01) AND (vstscore2010_exists)) OR ((vstdcore2010_sp1 >= v40219.01) AND (vstdcore2010_exists)) OR ((procore2010_sp1 >= v40219.01) AND (procore2010_exists))' evaluates to true.
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleRollbackLog_AspNetMVC4VS2010Tools.msi' to value 'C:\Users\<userName>\AppData\Local\Temp\MVC4_install_5_AspNetMVC4VS2010Tools.msi_rollback.htm'
[201C:04BC][2012-06-12T11:09:18]: Setting string variable 'WixBundleLog_AspNetMVC4VS2010Tools.msi' to value 'C:\Users\<userName>\AppData\Local\Temp\MVC4_install_5_AspNetMVC4VS2010Tools.msi.htm'
[201C:04BC][2012-06-12T11:09:18]: Condition '(xcor2010_sp1 >= v40219.01) AND (xcor2010_exists)' evaluates to false.
[201C:04BC][2012-06-12T11:09:18]: Planned package: VS10SP1_KB2581019_x86.exe, state: Absent, default requested: Present, ba requested: Present, execute: Install, rollback: None, cache: No, uncache: No, dependency: None
[201C:04BC][2012-06-12T11:09:18]: Planned package: VS10SP1_KB2591016_x86.exe, state: Absent, default requested: Present, ba requested: Present, execute: Install, rollback: None, cache: No, uncache: No, dependency: None
[201C:04BC][2012-06-12T11:09:18]: Planned package: Nuget.msi, state: Absent, default requested: Present, ba requested: Present, execute: Install, rollback: Uninstall, cache: No, uncache: No, dependency: Register
[201C:04BC][2012-06-12T11:09:18]: Planned package: AspNetWebPages2.msi, state: Present, default requested: Present, ba requested: Present, execute: None, rollback: None, cache: No, uncache: No, dependency: Register
[201C:04BC][2012-06-12T11:09:18]: Planned package: AspNetWebPages2VS2010Tools.msi, state: Absent, default requested: Present, ba requested: Present, execute: Install, rollback: Uninstall, cache: No, uncache: No, dependency: Register
[201C:04BC][2012-06-12T11:09:18]: Planned package: AspNetWebPages2VWD2010Tools.msi, state: Absent, default requested: Absent, ba requested: Absent, execute: None, rollback: None, cache: No, uncache: No, dependency: None
[201C:04BC][2012-06-12T11:09:18]: Planned package: AspNetMVC4.msi, state: Absent, default requested: Present, ba requested: Present, execute: Install, rollback: Uninstall, cache: No, uncache: No, dependency: Register
[201C:04BC][2012-06-12T11:09:18]: Planned package: AspNetMVC4VS2010Tools.msi, state: Absent, default requested: Present, ba requested: Present, execute: Install, rollback: Uninstall, cache: No, uncache: No, dependency: Register
[201C:04BC][2012-06-12T11:09:18]: Planned package: AspNetMVC4VWD2010Tools.msi, state: Absent, default requested: Absent, ba requested: Absent, execute: None, rollback: None, cache: No, uncache: No, dependency: None
[201C:04BC][2012-06-12T11:09:18]: Plan complete, result: 0x0
[201C:04BC][2012-06-12T11:09:18]: Apply begin
[1DA0:2234][2012-06-12T11:09:18]: Automatic updates could not be paused due to error: 0x80240025\. Continuing...
[1DA0:2234][2012-06-12T11:09:18]: Creating a system restore point.
[1DA0:2234][2012-06-12T11:09:18]: Could not create system restore point, error: 0x80070422\. Continuing...
[1DA0:2234][2012-06-12T11:09:18]: Caching bundle from: 'C:\Users\<userName>\AppData\Local\Temp\{a2aa0550-73d2-4f8e-ade9-b901851851fc}\.be\AspNetMVC4Setup.exe' to: 'C:\ProgramData\Package Cache\{a2aa0550-73d2-4f8e-ade9-b901851851fc}\AspNetMVC4Setup.exe'
[1DA0:2234][2012-06-12T11:09:19]: Registering bundle dependency provider: {a2aa0550-73d2-4f8e-ade9-b901851851fc}, version: 4.0.20505.0
[1DA0:02BC][2012-06-12T11:09:19]: Verified existing payload: VS10SP1_KB2581019_x86.exe at path: C:\ProgramData\Package Cache\9ACF484DD18F53B5E56809ABA965A32DACE6A809\VS10SP1-KB2581019-x86.exe.
[1DA0:02BC][2012-06-12T11:09:19]: Verified existing payload: VS10SP1_KB2591016_x86.exe at path: C:\ProgramData\Package Cache\5BA5217D49F8BECD7CA452F2F366CD7C99FF1F16\VS10SP1-KB2591016-x86.exe.
[1DA0:02BC][2012-06-12T11:09:19]: Verified existing payload: Nuget.msi at path: C:\ProgramData\Package Cache\{8FEC8DF9-6B13-4CAD-8FF3-063F332D16EB}v1.8.20505.0\Nuget.msi.
[1DA0:02BC][2012-06-12T11:09:19]: Verified existing payload: AspNetWebPages2VS2010Tools.msi at path: C:\ProgramData\Package Cache\{01866492-9599-46F4-BE9A-F6A264C09108}v2.0.20505.0\AspNetWebPages2VS2010Tools.msi.
[1DA0:02BC][2012-06-12T11:09:19]: Verified existing payload: cab3ECB64089A75B346241FCE810109AA85 at path: C:\ProgramData\Package Cache\{01866492-9599-46F4-BE9A-F6A264C09108}v2.0.20505.0\WebPages2_VisualStudio2010.cab.
[1DA0:02BC][2012-06-12T11:09:19]: Verified existing payload: AspNetMVC4.msi at path: C:\ProgramData\Package Cache\{8719C066-3A8C-4528-B82F-5094DB869F43}v4.0.20505.0\AspNetMVC4.msi.
[1DA0:02BC][2012-06-12T11:09:19]: Verified existing payload: cab4B3E83F27633398CE0AAFFFED6B2BF23 at path: C:\ProgramData\Package Cache\{8719C066-3A8C-4528-B82F-5094DB869F43}v4.0.20505.0\MVC4_runtime.cab.
[1DA0:02BC][2012-06-12T11:09:19]: Verified existing payload: AspNetMVC4VS2010Tools.msi at path: C:\ProgramData\Package Cache\{EA14A6CE-A0E1-410D-872D-B04CC186BA99}v4.0.20505.0\AspNetMVC4VS2010Tools.msi.
[1DA0:02BC][2012-06-12T11:09:19]: Verified existing payload: cabB4603D3274E047299B381454BE3590A6 at path: C:\ProgramData\Package Cache\{EA14A6CE-A0E1-410D-872D-B04CC186BA99}v4.0.20505.0\MVC4_VisualStudio2010.cab.
[1DA0:2234][2012-06-12T11:09:19]: Applying execute package: VS10SP1_KB2581019_x86.exe, action: Install, path: C:\ProgramData\Package Cache\9ACF484DD18F53B5E56809ABA965A32DACE6A809\VS10SP1-KB2581019-x86.exe, arguments: '"C:\ProgramData\Package Cache\9ACF484DD18F53B5E56809ABA965A32DACE6A809\VS10SP1-KB2581019-x86.exe" /q /norestart'
[1DA0:2234][2012-06-12T11:09:21]: Error 0x8007066a: Process returned error: 0x66a
[1DA0:2234][2012-06-12T11:09:21]: Error 0x8007066a: Failed to execute EXE package.
[201C:04BC][2012-06-12T11:09:21]: Error 0x8007066a: Failed to configure per-machine EXE package.
[201C:04BC][2012-06-12T11:09:21]: Error 0x8007066a: Failed to execute EXE package.
[1DA0:2234][2012-06-12T11:09:21]: Removing bundle dependency provider: {a2aa0550-73d2-4f8e-ade9-b901851851fc}
[1DA0:2234][2012-06-12T11:09:21]: Removing cached bundle: {a2aa0550-73d2-4f8e-ade9-b901851851fc}, from path: C:\ProgramData\Package Cache\{a2aa0550-73d2-4f8e-ade9-b901851851fc}\
[201C:04BC][2012-06-12T11:09:21]: Apply complete, result: 0x8007066a restart: No
[201C:04BC][2012-06-12T11:09:21]: Shutting down, exit code: 0x8007066a
[201C:04BC][2012-06-12T11:09:21]: Variable: AdminToolsFolder = C:\Users\<userName>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Administrative Tools\
[201C:04BC][2012-06-12T11:09:21]: Variable: AppDataFolder = C:\Users\<userName>\AppData\Roaming\
[201C:04BC][2012-06-12T11:09:21]: Variable: CommonAppDataFolder = C:\ProgramData\
[201C:04BC][2012-06-12T11:09:21]: Variable: CommonFiles64Folder = C:\Program Files\Common Files
[201C:04BC][2012-06-12T11:09:21]: Variable: CommonFilesFolder = C:\Program Files (x86)\Common Files\
[201C:04BC][2012-06-12T11:09:21]: Variable: CompatibilityMode = 1
[201C:04BC][2012-06-12T11:09:21]: Variable: Date = 6/12/2012
[201C:04BC][2012-06-12T11:09:21]: Variable: DesktopFolder = C:\Users\<userName>\Desktop\
[201C:04BC][2012-06-12T11:09:21]: Variable: FavoritesFolder = C:\Users\<userName>\Favorites\
[201C:04BC][2012-06-12T11:09:21]: Variable: FontsFolder = C:\Windows\Fonts\
[201C:04BC][2012-06-12T11:09:21]: Variable: InstallerName = WiX Burn
[201C:04BC][2012-06-12T11:09:21]: Variable: InstallerVersion = 3.6.2712.0
[201C:04BC][2012-06-12T11:09:21]: Variable: LocalAppDataFolder = C:\Users\<userName>\AppData\Local\
[201C:04BC][2012-06-12T11:09:21]: Variable: LogonUser = <userName>
[201C:04BC][2012-06-12T11:09:21]: Variable: MyPicturesFolder = C:\Users\<userName>\Pictures\
[201C:04BC][2012-06-12T11:09:21]: Variable: netfx4 = 4.0.30319
[201C:04BC][2012-06-12T11:09:21]: Variable: NTProductType = 1
[201C:04BC][2012-06-12T11:09:21]: Variable: NTSuiteBackOffice = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: NTSuiteDataCenter = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: NTSuiteEnterprise = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: NTSuitePersonal = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: NTSuiteSmallBusiness = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: NTSuiteSmallBusinessRestricted = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: NTSuiteWebServer = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: PersonalFolder = C:\Users\<userName>\Documents\
[201C:04BC][2012-06-12T11:09:21]: Variable: PowerShellExeVersion = 6.1.7600.16385
[201C:04BC][2012-06-12T11:09:21]: Variable: Privileged = 1
[201C:04BC][2012-06-12T11:09:21]: Variable: procore2010_exists = 1
[201C:04BC][2012-06-12T11:09:21]: Variable: procore2010_sp1 = 40219.342
[201C:04BC][2012-06-12T11:09:21]: Variable: ProgramFiles64Folder = C:\Program Files
[201C:04BC][2012-06-12T11:09:21]: Variable: ProgramFilesFolder = C:\Program Files (x86)\
[201C:04BC][2012-06-12T11:09:21]: Variable: ProgramMenuFolder = C:\Users\<userName>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\
[201C:04BC][2012-06-12T11:09:21]: Variable: RebootPending = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: SendToFolder = C:\Users\<userName>\AppData\Roaming\Microsoft\Windows\SendTo\
[201C:04BC][2012-06-12T11:09:21]: Variable: ServicePackLevel = 1
[201C:04BC][2012-06-12T11:09:21]: Variable: StartMenuFolder = C:\Users\<userName>\AppData\Roaming\Microsoft\Windows\Start Menu\
[201C:04BC][2012-06-12T11:09:21]: Variable: StartupFolder = C:\Users\<userName>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\
[201C:04BC][2012-06-12T11:09:21]: Variable: System64Folder = C:\Windows\SysWOW64\
[201C:04BC][2012-06-12T11:09:21]: Variable: SystemFolder = C:\Windows\system32\
[201C:04BC][2012-06-12T11:09:21]: Variable: SystemLanguageID = 1033
[201C:04BC][2012-06-12T11:09:21]: Variable: TempFolder = C:\Users\<userName>\AppData\Local\Temp\
[201C:04BC][2012-06-12T11:09:21]: Variable: TemplateFolder = C:\Users\<userName>\AppData\Roaming\Microsoft\Windows\Templates\
[201C:04BC][2012-06-12T11:09:21]: Variable: TerminalServer = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: UserLanguageID = 1033
[201C:04BC][2012-06-12T11:09:21]: Variable: VersionMsi = 5.0.0.0
[201C:04BC][2012-06-12T11:09:21]: Variable: VersionNT = 6.1.0.0
[201C:04BC][2012-06-12T11:09:21]: Variable: VersionNT64 = 6.1.0.0
[201C:04BC][2012-06-12T11:09:21]: Variable: vstdcore2010_exists = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: vstdcore2010_sp1 = 
[201C:04BC][2012-06-12T11:09:21]: Variable: vstscore2010_exists = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: vstscore2010_sp1 = 
[201C:04BC][2012-06-12T11:09:21]: Variable: WindowsFolder = C:\Windows\
[201C:04BC][2012-06-12T11:09:21]: Variable: WindowsVolume = C:\
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleAction = 4
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleElevated = 1
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleInstalled = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleLastUsedSource = 
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleLog = C:\Users\<userName>\AppData\Local\Temp\MVC4_install.htm
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleLog_AspNetMVC4.msi = C:\Users\<userName>\AppData\Local\Temp\MVC4_install_4_AspNetMVC4.msi.htm
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleLog_AspNetMVC4VS2010Tools.msi = C:\Users\<userName>\AppData\Local\Temp\MVC4_install_5_AspNetMVC4VS2010Tools.msi.htm
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleLog_AspNetWebPages2VS2010Tools.msi = C:\Users\<userName>\AppData\Local\Temp\MVC4_install_3_AspNetWebPages2VS2010Tools.msi.htm
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleLog_Nuget.msi = C:\Users\<userName>\AppData\Local\Temp\MVC4_install_2_Nuget.msi.htm
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleLog_VS10SP1_KB2581019_x86.exe = C:\Users\<userName>\AppData\Local\Temp\MVC4_install_0_VS10SP1_KB2581019_x86.exe.htm
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleLog_VS10SP1_KB2591016_x86.exe = C:\Users\<userName>\AppData\Local\Temp\MVC4_install_1_VS10SP1_KB2591016_x86.exe.htm
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleName = Microsoft ASP.NET MVC 4
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleOriginalSource = C:\Users\<userName>\AppData\Local\Microsoft\Web Platform Installer\installers\MVC4VS2010\8EDB940F9A4EEC0C0F0324B5D647F17738C665CA\AspNetMVC4Setup.exe
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleProviderKey = {a2aa0550-73d2-4f8e-ade9-b901851851fc}
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleRollbackLog_AspNetMVC4.msi = C:\Users\<userName>\AppData\Local\Temp\MVC4_install_4_AspNetMVC4.msi_rollback.htm
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleRollbackLog_AspNetMVC4VS2010Tools.msi = C:\Users\<userName>\AppData\Local\Temp\MVC4_install_5_AspNetMVC4VS2010Tools.msi_rollback.htm
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleRollbackLog_AspNetWebPages2VS2010Tools.msi = C:\Users\<userName>\AppData\Local\Temp\MVC4_install_3_AspNetWebPages2VS2010Tools.msi_rollback.htm
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleRollbackLog_Nuget.msi = C:\Users\<userName>\AppData\Local\Temp\MVC4_install_2_Nuget.msi_rollback.htm
[201C:04BC][2012-06-12T11:09:21]: Variable: WixBundleTag = 
[201C:04BC][2012-06-12T11:09:21]: Variable: xcor2010_exists = 0
[201C:04BC][2012-06-12T11:09:21]: Variable: xcor2010_sp1 = 
[201C:04BC][2012-06-12T11:09:21]: Exit code: 0x8007066a

----------------------------log file from  wpi 4.0 installer---------------------------

DownloadManager Information: 0 : Loading product xml from: https://go.microsoft.com/?linkid=9808264
DownloadManager Information: 0 : https://go.microsoft.com/?linkid=9808264 responded with 302
DownloadManager Information: 0 : Response headers:
HTTP/1.1 302 Found
Cache-Control: private
Content-Length: 175
Content-Type: text/html; charset=utf-8
Expires: Tue, 12 Jun 2012 15:08:06 GMT
Location: https://www.microsoft.com/web/webpi/4.0/webproductlist.xml
Server: Microsoft-IIS/7.5
X-AspNet-Version: 2.0.50727
Set-Cookie: MC1=GUID=7bc9a4edd0644146a30aa6f87cb93196&HASH=eda4&LV=20126&V=3; domain=microsoft.com; expires=Sun, 03-Oct-2010 07:00:00 GMT; path=/
X-Powered-By: ASP.NET
Date: Tue, 12 Jun 2012 15:09:06 GMT

DownloadManager Information: 0 : https://www.microsoft.com/web/webpi/4.0/webproductlist.xml responded with 304
DownloadManager Information: 0 : Response headers:
HTTP/1.1 304 Not Modified
Cache-Control: max-age=900
Accept-Ranges: bytes
ETag: "cb25e8931048cd1:0"
Server: Microsoft-IIS/8.0
P3P: CP="ALL IND DSP COR ADM CONo CUR CUSo IVAo IVDo PSA PSD TAI TELo OUR SAMo CNT COM INT NAV ONL PHY PRE PUR UNI"
X-Powered-By: ASP.NET
Date: Tue, 12 Jun 2012 15:09:06 GMT

DownloadManager Information: 0 : Remote file has not changed, using local cached file: C:\Users\<userName>\AppData\Local\Microsoft\Web Platform Installer\-1897360160.xml.temp
DownloadManager Information: 0 : Filtering by majorOS: 6, minorOS: 1, majorSP: 1, minorSP: 0, productType: 4, architecture: x64
DownloadManager Information: 0 : Loading product xml from: https://www.microsoft.com/web/webpi/4.0/webapplicationlist.xml
DownloadManager Information: 0 : https://www.microsoft.com/web/webpi/4.0/webapplicationlist.xml responded with 304
DownloadManager Information: 0 : Response headers:
HTTP/1.1 304 Not Modified
Cache-Control: max-age=900
Accept-Ranges: bytes
ETag: "5743f5d2148cd1:0"
Server: Microsoft-IIS/8.0
P3P: CP="ALL IND DSP COR ADM CONo CUR CUSo IVAo IVDo PSA PSD TAI TELo OUR SAMo CNT COM INT NAV ONL PHY PRE PUR UNI"
X-Powered-By: ASP.NET
Date: Tue, 12 Jun 2012 15:09:06 GMT

DownloadManager Information: 0 : Remote file has not changed, using local cached file: C:\Users\<userName>\AppData\Local\Microsoft\Web Platform Installer\251486345.xml.temp
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Warning: 0 : Could not resolve keyword ID ApplicationSpotlight
DownloadManager Information: 0 : Filtering by majorOS: 6, minorOS: 1, majorSP: 1, minorSP: 0, productType: 4, architecture: x64
DownloadManager Information: 0 : Loading product xml from: https://www.microsoft.com/web/webpi/4.0/mediaproductlist.xml
DownloadManager Information: 0 : https://www.microsoft.com/web/webpi/4.0/mediaproductlist.xml responded with 304
DownloadManager Information: 0 : Response headers:
HTTP/1.1 304 Not Modified
Cache-Control: max-age=900
Accept-Ranges: bytes
ETag: "5d94f4ad344cd1:0"
Server: Microsoft-IIS/8.0
P3P: CP="ALL IND DSP COR ADM CONo CUR CUSo IVAo IVDo PSA PSD TAI TELo OUR SAMo CNT COM INT NAV ONL PHY PRE PUR UNI"
X-Powered-By: ASP.NET
Date: Tue, 12 Jun 2012 15:09:07 GMT

DownloadManager Information: 0 : Remote file has not changed, using local cached file: C:\Users\<userName>\AppData\Local\Microsoft\Web Platform Installer\598799360.xml.temp
DownloadManager Information: 0 : Filtering by majorOS: 6, minorOS: 1, majorSP: 1, minorSP: 0, productType: 4, architecture: x64
DownloadManager Information: 0 : Loading product xml from: https://www.microsoft.com/web/webpi/4.0/toolsproductlist.xml
DownloadManager Information: 0 : https://www.microsoft.com/web/webpi/4.0/toolsproductlist.xml responded with 304
DownloadManager Information: 0 : Response headers:
HTTP/1.1 304 Not Modified
Cache-Control: max-age=900
Accept-Ranges: bytes
ETag: "f752fed6ed47cd1:0"
Server: Microsoft-IIS/8.0
P3P: CP="ALL IND DSP COR ADM CONo CUR CUSo IVAo IVDo PSA PSD TAI TELo OUR SAMo CNT COM INT NAV ONL PHY PRE PUR UNI"
X-Powered-By: ASP.NET
Date: Tue, 12 Jun 2012 15:09:07 GMT         

DownloadManager Information: 0 : Remote file has not changed, using local cached file: C:\Users\<userName>\AppData\Local\Microsoft\Web Platform Installer\1505006577.xml.temp
DownloadManager Information: 0 : Filtering by majorOS: 6, minorOS: 1, majorSP: 1, minorSP: 0, productType: 4, architecture: x64
DownloadManager Information: 0 : Getting ratings file from http://go.microsoft.com/?linkid=9752395
DownloadManager Information: 0 : http://go.microsoft.com/?linkid=9752395 responded with 302
DownloadManager Information: 0 : Response headers:
HTTP/1.1 302 Found
Cache-Control: private
Content-Length: 203
Content-Type: text/html; charset=utf-8
Expires: Tue, 12 Jun 2012 15:08:08 GMT
Location: http://www.microsoft.com/web/handlers/WebPI.ashx?command=getatomfeedwithavgratingquery
Server: Microsoft-IIS/7.5
X-AspNet-Version: 2.0.50727
Set-Cookie: MC1=GUID=42969058f2d7c34ba4fcbc951f9b2694&HASH=5890&LV=20126&V=3; domain=microsoft.com; expires=Sun, 03-Oct-2010 07:00:00 GMT; path=/
X-Powered-By: ASP.NET
Date: Tue, 12 Jun 2012 15:09:07 GMT

DownloadManager Information: 0 : Contextual entry products: mvc4vs2010
DownloadManager Information: 0 : Adding product ASP.NET MVC 4 Installer (Visual Studio 2010) (MVC4VS2010) to cart
DownloadManager Information: 0 : Contextual navigation to product 'MVC4VS2010'
DownloadManager Information: 0 : Ratings file loaded successfully
DownloadManager Information: 0 : Adding product 'MVC4VS2010'
DownloadManager Information: 0 : Setting current install to 1
DownloadManager Information: 0 : Starting install sequence
DownloadManager Information: 0 : Downloading file 'http://download.microsoft.com/download/A/A/4/AA42BC20-1656-4B28-B3EB-F2728124C5AA/AspNetMVC4Setup.exe' to: C:\Users\<userName>\AppData\Local\Temp\tmp430A.tmp
DownloadManager Information: 0 : Content-disposition header: attachment
DownloadManager Information: 0 : File 'C:\Users\<userName>\AppData\Local\Microsoft\Web Platform Installer\installers\MVC4VS2010\8EDB940F9A4EEC0C0F0324B5D647F17738C665CA\AspNetMVC4Setup.exe' already exists, deleting old copy of the file
DownloadManager Information: 0 : Moving downloaded file 'C:\Users\<userName>\AppData\Local\Temp\tmp430A.tmp' to: C:\Users\<userName>\AppData\Local\Microsoft\Web Platform Instal 
```

# javascript - SlickGrid - 应用 getItemMetadata 使该行失去其 id

> ID：11000325
> 
> 赞同：0
> 
> 时间：2012-06-12T15:56:37.103
> 
> 标签：javascript, slickgrid

我有以下问题：

[***>>>>>>> 链接到 JsFiddle 演示 >>>>>>***](http://jsfiddle.net/neoswf/Tvpf5/)

我使用了[折叠示例](http://mleibman.github.com/SlickGrid/examples/example5-collapsing.html)，并添加了 getItemMetadata 方法。

```
dataView.getItemMetadata = function (row) {
        var thtId = data[row].id;
        if (data[thtId + 1] && data[thtId + 1].indent > data[thtId].indent) {
            return { 'cssClasses': 'parentClassName' }
        }
    }; 
```

这工作正常，直到我尝试折叠和扩展我的行。比我收到以下错误（仅在扩展时）：

> 未捕获的类型错误：无法读取未定义的属性“id”

根据我的经验，当 dataView 失去孩子的属性时，会产生此错误。我进行了更多调查，发现代码属于*appendRowHtml*函数（slick.grid.js#1217）。

有人对折叠功能和 getItemMetadata 有经验吗？

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T20:56:01.777

解决方案由 SlickGrid 的创建者 @Tin 持有

> 异常发生在“var thtId = data[row].id”中，其中“row”超出范围。您应该在访问“id”属性之前检查“data[row]”是否存在。网格要求为不存在的行提供元数据，这可能被解释为错误，但能够自定义最后一行（用于添加新条目的行）仍然很有用，所以它有点意义.

[https://groups.google.com/forum/#!topic/slickgrid/65vPmzXsLMQ](https://groups.google.com/forum/#!topic/slickgrid/65vPmzXsLMQ)

# php - PHP-GD Image re-size 失去了图像的质量

> ID：11000327
> 
> 赞同：0
> 
> 时间：2012-06-12T15:56:43.563
> 
> 标签：php, php-gd

我已经制作了这段代码，如果找不到请求的图像，它将即时重新调整图像大小，然后将其存储。

唯一的问题是输出的 jpg 图像质量低。

我想知道是否需要更改某些内容以提高图像质量。

```
if (isset($_GET['size'])) {
    $size = $_GET['size'];
}

if (isset($_GET['name'])) {
    $filename = $_GET['name'];
}

$filePath = "files/catalog/" . urldecode($filename);

// Content type

header('Content-Type: image/jpeg');

// Get new sizes
list($width, $height) = getimagesize($filePath);

if ($_GET["name"] && !$size) {
    $newwidth  = $width * $percent;
    $newheight = $height * $percent;

} else if ($_GET["name"] && $size) {
    switch ($size) {
        case "thumbs":
            $newwidth  = 192;
            $newheight = 248;
            break;
        case "large":
            $newwidth  = 425;
            $newheight = 550;
            break;
    }
}

$resizedFileName = $filename; 
$resizedFileName = str_replace(".jpg", "", $resizedFileName) . ".jpg";
$resizedFilePath = "files/catalog/" . urldecode($resizedFileName);

if (!file_exists($resizedFilePath)) {
    // Load
    $thumb  = imagecreatetruecolor($newwidth, $newheight);
    $source = imagecreatefromjpeg($filePath);

    // Resize
    imagecopyresized($thumb, $source, 0, 0, 0, 0, $newwidth, $newheight, $width, $height);

    // Output
    imagejpeg($thumb, $resizedFilePath);
    //file_put_contents($, $binarydata);

    $imageContent = file_get_contents($resizedFilePath);
    echo $imageContent;

} else {
    $imageContent = file_get_contents($resizedFilePath);
    echo $imageContent;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T15:59:28.990

而不是 imagecopyresized() 您必须使用[imagecopyresampled()](http://no2.php.net/manual/en/function.imagecopyresampled.php)并且[imagejpeg()](http://no2.php.net/imagejpeg)函数具有第三个可选参数，您可以指定质量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:00:15.060

可能是因为你用[`imagejpeg()`](http://php.net/manual/en/function.imagejpeg.php)错了，函数中的第二个变量代表质量百分比！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T16:00:16.333

你想要[`imagecopyresampled()`](http://php.net/imagecopyresampled)。通过丢弃不必要的像素来调整大小。resampled() 将平均结果并产生更平滑的结果。

# java - 使用 XPath 从 xml 文档中提取值的方法是什么？

> ID：11000328
> 
> 赞同：0
> 
> 时间：2012-06-12T15:56:47.800
> 
> 标签：java, xml, xpath

我目前正在从表单中提取数据。我能够提取 rpm 类型和属性，如 ccoid_key、c​​coid_version，但我无法提取“190”。我正在使用以下语法“//form/// *rpm* -type/。” 并在[http://www.xpathtester.com/test](http://www.xpathtester.com/test)上对其进行了测试，这似乎返回了我想要的...

```
<form xmlns:ev="http://www.w3.org/2001/xml-events"     xmlns:exforms="http://www.exforms.org/exf/1-0" xmlns:fr="http://orbeon.org/oxf/xml/form-    runner" xmlns:ns2="http://db.rpm" xmlns:ns3="http://wscommon.rpm"    xmlns:ns4="http://form.rpm" xmlns:ns5="http://form.rpm" xmlns:pipeline="java:org.orbeon.oxf.processor.pipeline.PipelineFunctionLibrary" xmlns:saxon="http://saxon.sf.net/" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:sql="http://orbeon.org/oxf/xml/sql" xmlns:xbl="http://www.w3.org/ns/xbl" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xxforms="http://orbeon.org/oxf/xml/xforms" xmlns:xxi="http://orbeon.org/oxf/xml/xinclude">
<section-data>
<date>2012-06-12Z</date>
<author-name>admin admin</author-name>
<note>note</note>
</section-data>
<section-2>
<control-4>
<rpm-type ccoid_key="K000001" ccoid_version="1" type="rpm-weight">
   <rpm-value ccoid_key="K000002" type="rpm-weight-kg">190</rpm-value>
</rpm-type> 
</control-4>
<control-5>
<rpm-type ccoid_key="K000001" ccoid_version="1" type="rpm-weight">
    <rpm-value ccoid_key="K000002" type="rpm-weight-lbs">222</rpm-value>
    <rpm-value ccoid_key="K000003" type="rpm-weight-oz">21</rpm-value>
</rpm-type>
</control-5>
</section-2>
</form> 
```

我正在使用 node.getNodeValue() 但我得到一个空值......从日志中，我可以看到我能够提取许多属性及其值，但是当试图获取 childNode 的值时，我得到了无效的 ：

2012-06-12 14:17:49,028 [http-thread-pool-1234(2)] 调试 [FormSrvcImpl:944] 路径：[//form/ */* /rpm-type/.] **2012-06-12 14： 17:49,039 [http-thread-pool-1234(2)] 调试 [FormSrvcImpl:1007] 找到节点值：null** 2012-06-12 14:17:49,040 [http-thread-pool-1234(2)] 调试 [FormSrvcImpl:1054] 要添加的临床单元：ClinicalUnit [idCcUnit=, idCc=0, ccoidUnitKey=K000002, ccoidUnitVersion=0] 2012-06-12 14:17:49,041 [http-thread-pool-1234(2)] 调试 [FormSrvcImpl:1055] 要添加的临床类型：ClinicalType [idCcClinicalType=, idCc=0, ccoidClinicalTypeKey=rpm-weight, ccoidClinicalTypeVersion= 1，valueType=null，units=null] 2012-06-12 14:17:49,041 [http-thread-pool-1234(2)] 调试 [FormSrvcImpl:1056] 要添加的临床值：ClinicalValue [id_clinical_value=0，clinicalType =ClinicalType [idCcClinicalType=，idCc=0，ccoidClinicalTypeKey=rpm-weight，ccoidClinicalTypeVersion=1，valueType=null，units=null]，clinicalValue=null，valueDate=null，status=ACTIVE，sourceType=ORBEON_FORM，idSource=18585，idPatient =219，临床单位=空]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T19:59:21.783

根据 Javadoc，[`getNodeValue()`](http://docs.oracle.com/javase/7/docs/api/org/w3c/dom/Node.html#getNodeValue%28%29)如果在某种节点上调用，则返回 null（请参阅上一个链接开头的表格）。您可能应该[`getTextContent()`](http://docs.oracle.com/javase/7/docs/api/org/w3c/dom/Node.html#getTextContent%28%29)改用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:12:54.973

在我看来，好像您正在尝试在 rpm 类型（没有值，只有一个子节点）上使用 getNodeValue() 而不是您正在寻找的具有 190 值的 rpm-value 节点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T23:41:32.447

出于某种原因，我在 node.getTextContent 中找到了值...

# javascript - jQuery 向左滑动动画

> ID：11000329
> 
> 赞同：0
> 
> 时间：2012-06-12T15:56:54.670
> 
> 标签：javascript, jquery

我有四个`div`'s 或`td`'s，我想要做的是，如果我点击任何一个，那么它们都向左滑动，剩下的三个应该消失，而我点击的那个应该保留。

我还想要一个整洁的动画效果。

我已经尝试过了，但它给出了一些样式错误：

```
//xControl is a link inside the td
$(xControl).parent().siblings().each(function fn() {
    setTimeout(function fn() {
        $(this).animate({ width: 'toggle' });
    }, 800);
}); 
```

我也试过：

```
$(this).hide("slide", { direction: "right" }, 500); 
```

这也不起作用。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T17:38:49.273

```
$(xControl).on("click", function(){
    var thisDiv = $(this);
    var sibs = thisDiv.siblings();
    sibs.animate({'left':'-=150'},{queue:false,complete:function(){
            $(this).animate({'opacity':0});
        }
    });
    thisDiv.animate({'left':'-=150'},{queue:false});
}); 
```

这或多或少是我的做法。除了幻灯片和淡入淡出之外，您还可以在其中执行任何您想要的动画。您可以使用 jquery-ui 内置函数，但我个人更喜欢 animate 以获得更多可定制的动画。

这是我的小提琴来展示它的样子[http://jsfiddle.net/AXkxQ/1/](http://jsfiddle.net/AXkxQ/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T17:00:00.133

试试这个，可能会让你开始：http: [//jsfiddle.net/M8scf/2/](http://jsfiddle.net/M8scf/2/)

```
.item
{ 
    width:50px; 
    height:50px;
    margin:0 5px 0 0;
    display:inline-block;
    position:relative;            
    background:lime;
    cursor:pointer;        
}

<div class="con">
    <div class="item">DIV 1</div>
    <div class="item">DIV 2</div>
    <div class="item">DIV 3</div>
    <div class="item">DIV 4</div>
</div>

$(".con .item").click(function() {
  $(this).siblings().hide("slow");    
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T16:50:57.140

您可以尝试：

```
$(xControl).parent().siblings().each(function fn() {
setTimeout(function fn() {
    $(this).animate({ left: '-=500px' });
}, 800); 
```

});

你必须确保你的css中的位置设置为相对`xControl{position: relative;}`

# javascript - Javascript中的正则表达式来检查@符号

> ID：11000330
> 
> 赞同：2
> 
> 时间：2012-06-12T15:57:01.300
> 
> 标签：javascript, regex

我正在尝试检测一段文本（来自文本区域）是否包含以@sign 为前缀的单词。

例如在以下文本中：嘿@John，我刚看到@Smith

它将分别检测没有@符号的 John 和 Smith。我认为这样的事情会起作用：

```
@\w\w+ 
```

我的问题是如何让 javascript 过滤文本，假设它存储在变量注释中？

它应该只输出文本中以@ 为前缀但不带@ 符号的名称。

问候。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T16:00:55.230

您使用`g`（全局）标志、捕获组和循环调用[`RegExp#exec`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/RegExp/exec)，如下所示：

```
var str = "Hi there @john, it's @mary, my email is mary@example.com.";
var re = /\B@(\w+)/g;
var m;

for (m = re.exec(str); m; m = re.exec(str)) {
    console.log("Found: " + m[1]);
} 
```

输出：

```
发现：约翰
发现：玛丽
```

[实例](http://jsbin.com/oqutac/2)| [资源](http://jsbin.com/oqutac/2/edit)

* * *

*感谢@Alex K 的边界推荐！*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T15:59:26.900

`comment.match(/@\w+/g)`会给你一个匹配数组（`["@John", "@Smith"]`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T16:27:40.707

我在正则表达式中添加了一个检查，以便它与电子邮件地址不匹配，以防您感兴趣。

```
var comment = "Hey @John, I just saw @Smith."
        + " (john@example.com)";

// Parse tags using ye olde regex.
var tags = comment.match(/\B@\w+/g);

// If no tags were found, turn "null" into
// an empty array.
if (!tags) {
    tags = [];
}

// Remove leading space and "@" manually.
// Can't incorporate this into regex as
// lookbehind not always supported.
for (var i = 0; i < tags.length; i++) {
    tags[i] = tags[i].substr(1);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T16:00:31.527

```
var re = /@(\w+)/g; //set the g flag to match globally
var match;
while (match = re.exec(text)) {
    //match is an array representing how the regex matched the text.
    //match.index the position where it matches.
    //it returns null if there are no matches, ending the loop.
    //match[0] is the text matched by the entire regex, 
    //match[1] is the text between the first capturing group.
    //each set of matching parenthesis is a capturing group. 
} 
```

# c++ - pthread_cond_broadcast 是如何工作的？

> ID：11000331
> 
> 赞同：1
> 
> 时间：2012-06-12T15:57:01.377
> 
> 标签：c++, c, linux, pthreads

假设广播线程在只有 3 个线程在等待时`pthread_cond_wait`进行广播，并且在广播线程完成广播后的第 4 个线程调用，第 4 个线程是否会退出等待状态。以及如何重置条件变量，以便广播线程有时可以稍后重新广播给等待线程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:03:36.800

> 第 4 个线程会脱离等待状态吗

不，直到有另一个广播或信号。

> 以及如何重置条件变量，以便广播线程有时可以稍后重新广播给等待线程。

最简单的想象是，条件变量所做的一切都是在与条件变量关联的互斥锁下同步的。所以在你广播的时候，所有等待的东西（不知何故）都进入了一个试图唤醒并获取互斥锁的状态。然后，广播线程释放互斥锁。因此，当您广播时，真正“重置”的不是条件变量，而是前三个线程从等待条件变量转移到等待互斥体。

为了等待 condvar，您的第 4 个线程必须首先获取互斥锁。这可能发生在前三个线程设法唤醒并获取互斥体之前或之后，但它显然发生*在*广播之后，因此您的第 4 个线程不是处于“尝试唤醒”状态，而是处于“等待信号”或广播”状态。

实际上它比这更复杂——您实际上*不必*为了广播条件变量而持有互斥锁。所以条件变量必须包括一些额外的内部同步（我不知道 linux 的具体细节），以确保所有在广播之前等待的线程都将它们的状态作为单个操作更改。

但是，通常您最好持有互斥锁进行广播，因为您刚刚更改了服务员希望看到的内容时进行广播，并且从许多线程中查看的任何内容都是使用互斥锁同步的。你可以通过始终这样做来避免一些尴尬的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:03:29.610

> 第 4 个线程会退出等待状态吗？

不，除非条件变量*在*线程 4 等待时发出信号。

手册页[解释](http://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_cond_broadcast.html)：

> 该调用会解除**对指定条件变量当前阻塞的**`pthread_cond_broadcast()`所有线程的阻塞**。****`cond`**
> 
> 如果当前没有阻塞在 上的线程，则`pthread_cond_signal()`and`pthread_cond_broadcast()`函数无效`cond`。

# android - 如何在 A 类中使用 AsyncTask 并使其在 B 类中弹出对话框

> ID：11000333
> 
> 赞同：1
> 
> 时间：2012-06-12T15:57:05.913
> 
> 标签：android, android-asynctask

在自己的类中编写了一个 AsyncTask。从 B 类调用它，我希望它在 A 类中显示当前正在运行的内容`Activity`。我应该使用`runOnUiThread()`吗？还是我以某种方式 `setOwnerActivity(Activity)`？我对出了什么问题一无所知..

这是任务：

```
public class popTask extends AsyncTask<Void, Void, String> {
    private Context con;

    @Override
    protected void onPostExecute(String result) {
        // TODO Auto-generated method stub
        super.onPostExecute(result);

        final Dialog dialog = new Dialog(con);
        dialog.setContentView(R.layout.custom);
        dialog.setTitle("New & Hot advertise");

        // set the custom dialog components - text, image and button
        TextView text = (TextView) dialog.findViewById(R.id.text);
        text.setText("Android custom dialog example!");
        ImageView image = (ImageView) dialog.findViewById(R.id.image);
        image.setImageResource(R.drawable.yoda);

        Button dialogButton = (Button) dialog.findViewById(R.id.dialogButtonOK);
        // if button is clicked, close the custom dialog
        dialogButton.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                dialog.dismiss();
            }
        });

        dialog.show();

    }

    @Override
    protected String doInBackground(Void... params) {
        // TODO Auto-generated method stub
        return null;
    }

    public popTask(Context con){
        this.con=con;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T19:25:21.470

您可以为这个引用了 Activity A 的 Async 任务创建一个构造函数。

例如：

```
public popTask(ClassA ref) {
    super();
    this.ref = ref;
    // do stuff
} 
```

然后，使用对您的 Activity 的引用，您可以调用 Activity 的方法。如果你想显示一些东西，这个调用总是必须在 onProgressUpdate 或 onPostExecute 中完成（**从不在 doInBackground 上**）。

希望能帮助到你！

# php - EXTJS JsonStore 不加载

> ID：11000334
> 
> 赞同：1
> 
> 时间：2012-06-12T15:57:08.650
> 
> 标签：php, json, extjs, extjs3

我知道这将是一个重复。但我已经尽力解决它，一切都是徒劳的。我什至无法填充一个简单的网格面板！！！显然我是 extjs 的新手。

我的js代码如下：

```
Ext.onReady(function(){
    var store = new Ext.data.JsonStore({        
        url: 'compare.php',             
                fields: ['name', 'area']
               });      

    store.load();
    var grid = new Ext.grid.GridPanel({
        store: store,
        columns: [
        {header: 'Name', width: 100, sortable: true, dataIndex: 'name'},
        {header: 'Position', width: 100, sortable: true, dataIndex: 'area'}          
        ],
        stripeRows: true,
        height:250,
        width:500,
        title:'DB Grid'
    });
    grid.render('db-grid');

}); 
```

我的php如下：

```
<html>
<head>
</head>
 <body bgcolor="white">
  <?php
  $link = pg_Connect('host=my_host port=5432 dbname=da_name user=postgres password=my_password');
  $sql = "SELECT name, area FROM \"TABLE\" LIMIT 10";
    if (!$link) {
        echo "error";
    } else {
    $result = pg_query($link, $sql);
    $rows = array();
    $totaldata = pg_num_rows($result);
    while($r = pg_fetch_assoc($result)) {
        $rows[] = $r;
    }
    //echo json_encode($rows);
    //echo json_encode(array('country' => $rows));
    echo '({"total":"'.$totaldata.'","country":'.json_encode($rows).'})';
    }
  ?>
  </body>
</html> 
```

我的json如下：

```
[
    {
        "total": "10",
        "country": [
            {
                "name": "CULTIV",
                "area": "1.10584619505971e-006"
            },
            {
                "name": "CULTIV",
                "area": "2.87818068045453e-006"
            },
            {
                "name": "CULTIV",
                "area": "6.96120082466223e-007"
            },
            {
                "name": "CULTIV",
                "area": "1.17171452984621e-007"
            },
            {
                "name": "CULTIV",
                "area": "1.25584028864978e-006"
            },
            {
                "name": "CULTIV",
                "area": "5.86309965910914e-007"
            },
            {
                "name": "CULTIV",
                "area": "4.12220742873615e-007"
            },
            {
                "name": "CULTIV",
                "area": "7.59690840368421e-006"
            },
            {
                "name": "CULTIV",
                "area": "2.47360731009394e-007"
            },
            {
                "name": "CULTIV",
                "area": "4.04940848284241e-005"
            }
        ] 
```

我需要为此设置任何代理吗？实际上，我的应用程序运行在与我的数据库不同的服务器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T19:53:53.260

我没有经验，`PostgreSQL`但我建议你使用`pg_fetch_object()`函数而不是`pg_fetch_assoc()`那种情况。

尝试这样的事情：

```
while($obj = $result->pg_fetch_object()) {
$rows = $obj;
}    
echo '({"total":"'.$totaldata.'","country":'.json_encode($rows).'})'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T00:27:36.323

您的 JSON 格式不正确。Ext.data.JsonReader（在您使用 JsonStore 时自动配置）需要一个带有`root`节点的 JSON 对象，[在您的阅读器配置中定义](http://docs.sencha.com/ext-js/3-4/#!/api/Ext.data.JsonReader-cfg-root)。`root`如果未定义，读者应该抛出异常。

所以为你的 JsonReader 定义一个根：

```
var store = new Ext.data.JsonStore({        
    url: 'compare.php',
    root: 'country', // required!
    fields: ['name', 'area']
}); 
```

你的 JSON 应该是这样的：

```
{
    "total": 10,
    "country": [{
        "name": "CULTIV",
        "area": "6.96120082466223e-007"
    },{
        ...
    }]
} 
```

# git - 在 GitHub for Windows 中克隆多个分支

> ID：11000336
> 
> 赞同：13
> 
> 时间：2012-06-12T15:57:12.470
> 
> 标签：git, github, github-for-windows

有时我需要在本地磁盘上同时拥有 GitHub 存储库的两个不同分支。（尤其是在处理 gh-pages 时）

我通常通过在不同的文件夹中对 repo 进行多个克隆来做到这一点，并使用不同的分支进行克隆。

是否可以在 GitHub for Windows UI 中执行此操作？（而不是将单个本地克隆从一个分支切换到另一个）
看起来在本地克隆之间切换的唯一方法是每次都将新克隆拖到 UI 中。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-14T03:47:51.770

我认为用当前版本（1.0.9.2）做你想做的事情是不可能的，但这是我在两个分支上所做的工作。

1.  从 Git Shell 克隆两个分支

    `git clone https://your-project/master/ master`

    `git clone https://your-project/gh-pages/ gh-pages`

2.  在 Windows 版 Git 中，拖放您要处理的文件夹。

3.  要切换分支，请拖放另一个分支的文件夹。

# c# - .net ldap opends 读取自定义属性 0x8000500c

> ID：11000339
> 
> 赞同：3
> 
> 时间：2012-06-12T15:57:35.023
> 
> 标签：c#, .net, ldap, opends

我正在尝试为我的 .Net 应用程序构建一个功能，以便能够与 LDAP 服务器对话以读取用户属性并验证用户身份。我已经使用 OpenDS 设置了一个测试目录服务器，添加了自定义属性和对象，并添加了具有新对象类型的用户。一切正常，直到我尝试读取自定义属性值，我得到：

```
{"Unknown error (0x8000500c)"}
at System.DirectoryServices.PropertyValueCollection.PopulateList()
at System.DirectoryServices.PropertyValueCollection..ctor(DirectoryEntry entry, String propertyName)
at System.DirectoryServices.PropertyCollection.get_Item(String propertyName) 
```

我已经尝试过[这篇文章](https://stackoverflow.com/questions/8549060/querying-custom-ldap-property-via-system-directoryservices-in-c)（使用格式正确的 oid）以及[这篇文章](https://stackoverflow.com/questions/9737599/activedirectory-error-0x8000500c-when-traversing-properties)（在您的 ldap 路径中使用完全限定的域名 - 我使用的是 LDAP://mymachine.company.local/... 之类的东西）中的建议。[其他人建议](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/60105033-8cc4-42e9-b98d-84c28a8e44ea/)，由于 COM 错误代码意味着 E_ADS_CANT_CONVERT_DATATYPE 我的属性或架构有问题，但属性设置为 DirectoryString，我可以读取其他相同类型的默认字段。

我知道使用 OpenDS 与 Active Directory 的工作方式不同，我有一个单独的 AD 模块可以正常工作，我只是想知道是否有人有与 OpenDS 或 Sun One LDAP 实现交谈的经验。

想法？我在谷歌上找不到太多同时处理 OpenDS 和 .NET 的内容，这让我觉得我应该做点别的事情。正如我所说的，AD 的东西工作得很好，但是我真的很想用 OpenDS 也能做到这一点。

谢谢！

生锈的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:45:44.063

使用已知的良好工具，例如`ldapsearch`验证 LDAP 客户端确实可以请求和接收所需的条目和属性。例如：

```
ldapsearch --hostname hostname \
           --port port \
           --bindDn your-auth-id \
           --bindPassword credentials-for-your-auth-id \
           --useSSL     \
           --trustAll \
           --baseDn your-base-object \
           --searchScope the-scope-you-use \
           '(&)' \
           your-custom-attribute-names 
```

使用与 LDAP 客户端代码中相同的参数。如果上述搜索成功，则服务器配置正确，条目存在，并且 auth ID 有权检索这些条目和自定义属性。否则，它们可能是 LDAP 客户端代码中的问题。

### 也可以看看

*   [LDAP：使用 ldapsearch](http://ff1959.wordpress.com/2011/07/27/mastering-ldapsearch/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T17:08:27.847

我在尝试从 linux OpenLdap 数据库中读取多值字符串时遇到此错误。

这似乎是一个错误，因为我发现错误发生在 XP 和 Server 2003 上，但 Windows 7 和 Server 2008 上的相同代码会返回这些值，而不管安装的 .NET 版本如何。

但是，我找到了使用更直接访问的 C# 解决方法。除了 Directory.Services，您还需要添加引用 COM，“Active DS 类型库”。

```
var dirEntry = new DirectoryEntry("ldapDn", "logonDn", "logonPass");
var nativeEntry = (ActiveDs.IADsPropertyList)dirEntry.NativeObject;
var propEntry = (ActiveDs.IADsPropertyEntry)nativeEntry.GetPropertyItem("attributeName", 3);
foreach (ActiveDs.IADsPropertyValue propValue in (object[])propEntry.Values)
{
    Debug.Print(propValue.CaseIgnoreString);
} 
```

这是为了我自己的简单需求而放在一起的，这里是[用作参考的完整辅助类](http://blogs.msdn.com/b/hmahrt/archive/2012/08/01/how-to-avoid-the-directory-data-type-cannot-be-converted-to-from-a-native-ds-data-type-0x8000500c-in-managed-code.aspx)以及[AdsType Enums](http://msdn.microsoft.com/en-us/library/windows/desktop/aa772240%28v=vs.85%29.aspx)。

# c++ - Visual Studio 2010 和 windows SDK 7.0a 编译错误

> ID：11000342
> 
> 赞同：3
> 
> 时间：2012-06-12T15:57:44.227
> 
> 标签：c++, visual-studio-2010, visual-studio, winapi, visual-c++

我是 Windows 开发世界的新手。我的机器上安装了 Visual Studio 2010 和 windows SDK 7.0a。任何 win32 应用程序（甚至是使用向导生成的骨架）都会给我这个编译错误重复数百次：

* * *

*2> 注意：包含文件：C:\Program Files\Microsoft Visual Studio 10.0\VC\include\stdio.h*
*2> 注意：包含文件：C:\Program Files\Microsoft Visual Studio 10.0\VC\include\crtdefs.h*
*2> 注意：包含文件：C:\Program Files\Microsoft Visual Studio 10.0\VC\include\swprintf.inl*
*2> 注意：包含文件：C:\Program Files\Microsoft SDKs\Windows\v7.0A\include\Windows .h*
*2> 注意：包含文件：C:\Program Files\Microsoft SDKs\Windows\v7.0A\include\sdkddkver.h*
*2> 注意：包含文件：C:\Program Files\Microsoft Visual Studio 10.0\VC\include \excpt.h*
*2> 注意：包含文件：C:\Program Files\Microsoft Visual Studio 10.0\VC\include\crtdefs.h*
*2> 注意：包含文件：C:\Program Files\Microsoft Visual Studio 10.0\VC\include \stdarg.h*
*2> 注意：包含文件：C:\Program Files\Microsoft SDKs\Windows\v7.0A\include\windef.h*
*2> 注意：包含文件：C:\Program Files\Microsoft SDKs\Windows\v7.0A\include \winnt.h*
*2> 注意：包含文件：C:\Program Files\Microsoft Visual Studio 10.0\VC\include\ctype.h*
*2> 注意：包含文件：C:\Program Files\Microsoft Visual Studio 10.0\VC\include \crtdefs.h*
*2> 注意：包含文件：C:\Program Files\Microsoft SDKs\Windows\v7.0A\include\specstrings.h*
*2> 注意：包含文件：c:\program files\microsoft sdks\windows\ v7.0a\include\sal_supp.h*
*2> 注意：包括文件：c:\program files\microsoft sdks\windows\v7.0a\include\specstrings_supp.h*
*2> 注意：包括文件：C:\Program Files\Microsoft SDKs\Windows\v7.0A\include\specstrings_strict.h*
*2> 注意：包括文件：C:\Program Files\Microsoft SDKs\Windows\v7。 0A\include\specstrings_undef.h*
*2> 注意：包含文件：C:\Program Files\Microsoft SDKs\Windows\v7.0A\include\driverspecs.h*
*2> 注意：包含文件：c:\program files\microsoft sdks\windows\v7.0a\include\sdv_driverspecs.h*
2>C:\Program Files\Microsoft SDKs\Windows\v7.0A\include\driverspecs.h(356):**错误 C3861: 'SAL_functionClass': 找不到标识符**
2>C:\Program Files\Microsoft SDKs\Windows\v7.0A\include\driverspecs.h(356):**错误 C2059: 语法错误: ')'**
2>C:\Program Files\Microsoft SDKs\Windows\v7\. 0A\包括\驱动程序规范。h(374):**错误 C2144：语法错误：'char' 应该以 ')'**
开头 2>C:\Program Files\Microsoft SDKs\Windows\v7.0A\include\driverspecs.h(374)：**错误 C3861：'SAL_acquire'：标识符未找到**

* * *

请指教。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T21:21:15.243

看看你的 VS 包含路径。如果您安装了更多的 SDK（即 Windows 7.1 或其他），那么订单可能会搞砸。或者，也许您修改了路径以添加一些您自己的路径。

转到项目-> 属性-> 配置属性-> VC++ 目录-> 包含目录。我的看起来像这样：

**包括目录 =**`$(VCInstallDir)include;$(VCInstallDir)atlmfc\include;$(WindowsSdkDir)include;$(FrameworkSDKDir)\include;`

我建议让它们看起来像默认值，看看你是否还有问题。如果在编译后没有链接，您可能需要修复您的库目录。我的看起来像这样：

**图书馆目录 =**`$(VCInstallDir)lib;$(VCInstallDir)atlmfc\lib;$(WindowsSdkDir)lib;$(FrameworkSDKDir)\lib`

# c++ - windows下的linux开发

> ID：11000343
> 
> 赞同：1
> 
> 时间：2012-06-12T15:57:47.243
> 
> 标签：c++, windows, linux, vi

我们主要在带有 VI 的无头 linux x64 服务器上开发 C++ 代码。我们提供了 Windows 桌面，我想知道类似情况的其他人如何工作？你只是使用windows远程进入linux盒子还是有办法在windows上开发。

我想到的两个解决方案是：

1.  在 Windows 桌面上运行 linux VM。
2.  赛格温。（不确定）。

还有其他人吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:00:03.453

Windows有一个[VIM](http://www.vim.org/download.php#pc)端口。作为日常用户，我可以说体验是无缝的，除了使用 Windows 路径分隔符。

还有其他选择需要考虑：

*   [MSYS](http://www.mingw.org/wiki/MSYS)为您提供了一组为 Windows 原生编译的 GNU 工具，包括一个 shell、ssh/scp
*   [MinGW](http://www.mingw.org/)为您提供 gcc 的 Windows 端口。
*   [UnxUtilx](http://unxutils.sourceforge.net/)是另一组 GNU 工具端口，但最近没有活动。

正如其他人所提到的，[putty](http://www.chiark.greenend.org.uk/~sgtatham/putty/)为您提供 ssh/scp，专为 Windows 构建。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:04:57.863

我目前开发的唯一 C++ 应用程序是基于 Qt 的跨平台应用程序，因此我倾向于使用 Visual Studio 在 Windows 中开发，然后在 linux 上进行测试。为了在 linux 上进行测试，我主要使用 putty、vi 和 make，但如果我需要使用调试器，我会使用 nemiver 和 xming 以及 putty 将 x 会话导出到 PC 以进行 xming 渲染。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T17:02:02.130

当我在这样的环境中工作时，我在我的 windows 盒子上安装了 Cygwin/X 和 putty。您使用 putty 连接到 Linux 机器，并打开 Connection --> SSH --> X11 --> "Enable X11 forwarding"。你

*   安装 Cygwin 包括 Cygwin/X [http://x.cygwin.com/](http://x.cygwin.com/) — 下载安装程序，确保在要安装的东西中选择了 xinit 包，然后点击 go！
*   安装 PuTTY [http://www.chiark.greenend.org.uk/~sgtatham/putty/](http://www.chiark.greenend.org.uk/~sgtatham/putty/)并在会话设置中启用 X 转发。PuTTY 将自动正确设置您的 DISPLAY 环境变量。
*   在 Windows 上启动您的 X 服务器（开始 -> 程序 -> Cygwin/X -> XWin Server ） - 您可能希望将其复制到您的启动组，以便在您登录时运行。
*   使用 PuTTY 连接到您的 *nix 盒子并启动 X Windows 程序——记得“放大它” [http://www.catb.org/jargon/html/A/amp-off.html](http://www.catb.org/jargon/html/A/amp-off.html)。

您可以在本地客户端桌面上无缝使用 Linux 机器上可用的任何 X 程序。您可以使用 Eclipse 或 gvim 或 kate 来完成。

我幸运的另一件事是在 Linux 机器上使用 Samba 来共享我的源代码树，然后将 Windows 中的驱动器映射到该共享，使用本地 Windows 工具对其进行编辑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T15:59:29.643

你只是使用windows远程进入linux盒子还是有办法在windows上开发。- 是的，我主要是这样做的。

winscp 是一个工具，可让您在您选择的编辑器中进行本地文本编辑，无论是 Windows 的 emacs 还是 gedit 或记事本，并远程保存。

# c# - 向 SPFile 对象添加一行

> ID：11000346
> 
> 赞同：0
> 
> 时间：2012-06-12T15:58:02.917
> 
> 标签：c#, file, sharepoint

我只是想在 SPFile 对象中添加一行，这是一个简单的 txt 文件。

有没有一种简单的方法可以做到这一点？我刚在想

谢谢

编辑：这就是我目前所拥有的：

```
 public static void addLine(SPFile file, string line)
    {
        using(System.IO.StreamWriter strWriter = new System.IO.StreamWriter(file.OpenBinaryStream())){
            strWriter.WriteLine(line);
        }

    } 
```

我在这里没有任何错误，但文件没有保存。我试图做类似的事情：

```
 file.SaveBinary( args ) 
```

但我不知道在 args 中放什么。

如果你能帮助我。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:53:18.313

您需要[SPFile.OpenBinaryStream](http://msdn.microsoft.com/en-us/library/ms470901)，[SPFile.SaveBinary](http://msdn.microsoft.com/en-us/library/ms465421)之一来读/写。[TextReader 的一些字符串操作在TextReader.ReadToEnd](http://msdn.microsoft.com/en-us/library/system.io.textreader.readtoend)等结果流上创建，并使用 TextWriter 将结果数据写入 MemoryStream。

警告：以下非编译代码：

```
using (var readStream = file.OpenBinaryStream())
{ 
  using(var reader = new StreamReader(readStream)
  {
    var allText = reader.ReadToEnd();
    var writeStream = new MemoryStream();
    using(var writer = new TextWriter(writeStream))
    {
      writer.Write(allText);
      writer.Write(extraText);
    }
    file.SaveBinary(writeStream.ToArray();
  }
} 
```

# visual-studio-2010 - Azure 入门：辅助角色

> ID：11000351
> 
> 赞同：1
> 
> 时间：2012-06-12T15:58:23.570
> 
> 标签：visual-studio-2010, azure

我是 Azure 的新手。我有一个脚本可以自动安装 Apache、Ruby，并将两者配置为运行基本的 Ruby on Rails 项目。此脚本当前在 Windows Server 上运行。

我现在正试图让它在 Azure 中工作。我已注册订阅，并在 Visual Studio 中打开了一个新的 Worker Role 项目。

我现在有点卡住了。

1）我应该把安装文件和项目文件（ruby、apache等）放在哪里？2) 放置脚本的最佳位置在哪里？

任何帮助，将不胜感激。感谢您的时间 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:40:47.010

在 Visual Studio 项目中，您可以在三个地方启动和运行：

*   启动脚本。这在您的 workerrole.cs 方法被调用之前运行。它非常适合安装需要提升权限的软件、调整注册表等。对于 apache，不需要提升权限 - 它只是 xcopy 加上环境变量。
*   workerrole.cs OnStart() - 在将角色实例添加到负载均衡器之前调用此处理程序。您可以从 blob 存储下载 apache zip，解压缩到本地文件夹，然后启动它。
*   workerrole.cs Run() - 与 OnStart() 相同，但您的角色实例现在位于负载均衡器中。我不建议在这里设置 Web 服务器。

从 Eclipse 设置 tomcat 时情况有些不同，因为没有 workerrole.cs。相反，您有一个启动脚本。Eclipse 的 Windows Azure 插件提供了几个示例脚本：一个用于 tomcat，一个用于 JBoss，等等。然后您可以查看这些示例脚本如何设置环境并启动 Web 服务器。

一点指导：虽然您*可以*将 tomcat、ruby 和其他运行时位打包到您的部署中，但这也会增加部署规模。我通常将第 3 方位放在 blob 存储中，然后在启动时将它们下载到我的角色实例中。这个下载速度*非常*快。这也使我能够在不需要重新部署的情况下更新这些位（例如：自几个月前我推动部署以来，tomcat 已经经历了六次增量更新；我只是上传了一个新的 tomcat zip 并回收了我的角色实例）。

# android - 查找 MotionEvent 的顶部

> ID：11000355
> 
> 赞同：0
> 
> 时间：2012-06-12T15:58:44.980
> 
> 标签：android

我需要做的是找到 a 的顶部像素`MotionEvent`。我试图`View`在触摸发生的位置上方出现一个，足够高，不会被你的手指挡住。我在 API 中可以找到的所有内容都是为了找到触摸的中心。

这个想法是在用户触摸的位置上方显示一个工具提示。基本布局是 a `FrameLayout`，所以在视图中添加不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:10:01.557

如果我理解正确，您想显示触摸点的视图。

因此，您只需获取motionEvent action_up 的x，y，然后将您的视图放在x - 布局高度和y - 布局宽度上。

您可以扩展您的问题，以便我可以删除一些代码行吗？

它是一个片段？它是您要添加到当前布局的视图？

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:03:24.353

我可能会误解，但你能不能只在 MotionEvent 的中心添加一个手指像素的预设边距？

# f# - 可以在 F# 中自定义支撑匹配颜色吗？

> ID：11000356
> 
> 赞同：4
> 
> 时间：2012-06-12T15:58:54.747
> 
> 标签：f#, visual-studio-2012

在具有深色主题的 Visual Studio 2012 RC 中，C# 编辑器支持颜色设置`Brace Matching (Highlight)`，`Brace Matching (Rectangle)`但 F# 编辑器不支持。因此，F# 编辑器中的匹配大括号突出显示为几乎不可见的稍浅的黑色阴影。

有谁知道使 F# 大括号匹配突出显示...可见的解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:05:56.227

我记得 Brian McNamara 为 VS2010 所做的工作……[这个插件](http://visualstudiogallery.msdn.microsoft.com/0713522e-27e6-463f-830a-cb8f08e467c4/)在 VS2012 中可以工作吗？

搜索 FSharp 时，这会出现在 Extension Manager -> Online Gallery 的第一页。

# php - Eclipse 中的 php FETCH_CLASS 和自动完成

> ID：11000358
> 
> 赞同：0
> 
> 时间：2012-06-12T15:58:56.380
> 
> 标签：php, autocomplete, pdo, eclipse-pdt, fetchall

我是 PHP 和 PDO 的新手。我正在使用 Eclipse PDT。

```
$stmt = $pdo->prepare("SELECT * from articolo");
$stmt->execute();
$result = $stmt->fetchAll(PDO::FETCH_CLASS, "Articolo"); 
```

之后，我希望能够输入：

```
$result[0]-> 
```

然后从那里按 ctrl+space Eclipse 应该会弹出带有该类 Articolo 的所有成员和功能的自动完成功能。

但是什么也没有发生，好像 IDE 不知道 $result 的类。难道我做错了什么？也许需要对 (Articolo) 进行 $result 的演员表？

正在做：

```
$var = new Articolo()
$var-> 
```

自动完成弹出窗口正确显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T22:06:47.813

我敢打赌你只需要给 Eclipse 一个类型提示。我不是 Eclipse 用户，但您通常使用 phpdoc 并执行以下操作：

```
...
$result = $stmt->fetchAll(PDO::FETCH_CLASS, "Articolo");
/** @var $record Articolo */
$record = $result[0]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T20:23:34.953

假设您的查询成功并返回超过 1 行，`$result`包含许多对象。每个对象的类型都是`Articolo`.

要访问对象的方法，您必须执行以下操作：

`$result = $stmt->fetchAll(PDO::FETCH_CLASS, "Articolo");`

 ````
foreach($result as $object)
{
    // call a method on each object
    $object->someFunction();
} 
````  `**上面代码的解释：**

1.  获取数据，因此`$result` 应该包含一个 Articolo 对象数组。
2.  循环遍历每个对象并调用 Articolo 类中存在的函数名称。

您的 IDE (Eclipse) 无法识别 Articolo 类中的函数的原因是您试图从`$result`变量中调用一个函数，该变量不是 Articolo 类的类型。

**一些堆栈溢出的使用技巧：**

1.  始终使用右上角的搜索。许多人遇到了可能对您有所帮助的问题。
2.  始终查看[如何提问常见问题解答](https://stackoverflow.com/questions/how-to-ask)
3.  反馈并在需要时随时提出更多问题！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T22:53:57.690

我找到了一个解决方案：

```
$articolo = new Articolo();
$stmt = $pdo->prepare("SELECT * from articolo");
$stmt->setFetchMode(PDO::FETCH_INTO, $articolo);
$stmt->execute();           

while ($stmt->fetch()) {
    $articoli[] = clone $articolo;
}           
return $articoli; 
````

# php - PHP 如何知道何时在单词和括号之间放置空格

> ID：11000373
> 
> 赞同：1
> 
> 时间：2012-06-12T15:59:50.627
> 
> 标签：php, naming-conventions

有人建议我在 foreach 和 ( 之间放置一个空格，等等。我的理解是它有助于区分函数和其他所有内容。

我只是在处理一个数组，并注意到你应该这样做`unset($value)`。我抬头一看`unset`，这是一个构造。 `foreach`也是一种构造。然后我看了一下，`array`也是一个构造。不过，似乎没有人用`unset`or放置空格`array`。

你怎么知道什么时候放一个空格，什么时候不放？我使用 Adob​​e Dreamweaver，所以我只是养成了在每个绿色的 php 单词之后放置一个空格（如`include_once`）的习惯。

JJ

编辑...

它可能与关键字[http://php.net/manual/en/reserved.keywords.php](http://php.net/manual/en/reserved.keywords.php)有关。我注意到这`foreach`是一个关键字，但`array()`也是一个关键字。

JJ

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:08:06.773

php 有许多不同的编码约定。Zend 标准似乎非常接近我看到的大多数代码：http: [//framework.zend.com/manual/en/coding-standard.html](http://framework.zend.com/manual/en/coding-standard.html)

[无论如何，可能是控制结构](http://php.net/manual/en/language.control-structures.php)关键字后的空格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:10:56.317

让你觉得更舒服，但是唯一的办法。然而[php编码标准](http://framework.zend.com/wiki/display/ZFDEV/PHP+Coding+Standard+%28draft%29#PHPCodingStandard%28draft%29-Scope)

# iframe - 有没有什么办法当点击 iframe 的任何地方时，它会将网站重定向到一个新网站？

> ID：11000378
> 
> 赞同：1
> 
> 时间：2012-06-12T15:59:55.433
> 
> 标签：iframe, onclick

我使用 iframe 标记来显示另一个网站。但我希望人们点击 iframe 中的任何位置，他们可以重定向到另一个网站，如 iframe 中所示。

我尝试使用 onclick 事件，但是，由于安全问题，我发现它不会被支持。有谁知道怎么做而不是使用onclick。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:19:59.950

我不知道这是不是一个好技巧，但你可以试试这个技巧

作为 iframe 源，在您的服务器中设置一个页面，并在该页面上创建一个“DIV”，并在“DIV”下创建一个带有另一个网站 url 的新 iframe。现在在基本上位于您的服务器页面上的“DIV”上设置一个 onClick 事件。通过该 div 上的 CSS 类设置“不透明度”。

```
<iframe src="file-in-your-server.html" ></iframe> 
```

文件在您的 server.html 中

```
<div style=""><iframe src="http://www.google.com"></iframe></div> 
```

希望它有效，我还没有尝试过。

# java - 使用 gpgpu 进行大量矢量计算的最佳方法？

> ID：11000380
> 
> 赞同：0
> 
> 时间：2012-06-12T15:59:58.693
> 
> 标签：java, opencl, gpgpu, jocl, jcuda

我有一个 100 万列 x 100 万行的矩阵。

**我的算法需要做：**

```
Matrix m  = Matrix(rows,cols)
for (colB: cols){
  vector currColA = m.getcolumn(colA)

  for (colB: cols){
    vector currColB = m.getcolumn(colB)
    result = currColA.dotProduct(colB)
    return result;
}} 
```

**或者你也可以说：**

```
Vectors [] v  = Vectors[]

for (i: v.length){
  vector v1 = v[i]

  for (i: v.length){
    vector v2 = v[i]
    result = v1.dotProduct(v2)
    return result;
}} 
```

我的问题：为这个问题分配内存和初始化内存的正确方法是什么：

- 我应该为完整矩阵分配内存，用完整矩阵初始化它，然后运行算法吗？
- 或者我应该为向量列表分配内存，然后遍历这个列表？
- 要不然？？

我担心的是我想尽量减少到 gpu 的传输时间。[我已经通过修改JCublas hello world 示例](http://www.jcuda.de/samples/samples.html)来尝试这种计算，以对 2 个向量进行 sgemm 操作，但是在我的大量向量上执行此操作时，最终导致传输时间删除了 gpu 加速的好处。

谢谢！PS：实现可以在任何Java库中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T13:53:42.133

听起来您正在执行一次 1 次限制。CPU->GPU 复制，等待，计算，GPU->CPU 复制，等待。大多数人没有意识到内存复制可能导致的隐式等待。

你能流水线化你的操作吗？换句话说，您的循环是否包含以下内容？

*   CPU->GPU 拷贝
*   GPU 计算
*   GPU->CPU 拷贝

要流水线化，您将使用（例如）4 个单独的（按顺序）命令队列，在每个队列上向 GPU 发出非阻塞传输，在每个队列上发出内核执行，并在每个队列上发出 GPU->CPU 副本排队，按这个顺序。您必须保证两个缓冲区在等待之前都保持有效（稍后描述）。这将允许 GPU 在进行后续内存传输时开始计算。

此外，永远不要使用阻塞内存传输，始终使用非阻塞。每隔这么多（8 个？）传输，为 GPU->CPU 副本获取一个事件对象，但如果这不是第一次迭代，则首先等待最后一个事件对象。这将限制您的队列并允许您重用缓冲区，但重叠操作会使传输和计算重叠。我们在 8 次迭代前等待传输，所以我们不会排空队列。管理队列深度很重要，过多的工作项会导致 GUI 滞后和工作项饥饿。

# list - 如何从 Sharepoint 列表中的数据创建 Word 文档形式的报告

> ID：11000384
> 
> 赞同：0
> 
> 时间：2012-06-12T16:00:15.343
> 
> 标签：list, sharepoint, ms-word, sharepoint-2007

我有一个用于记录每周活动的共享点列表，例如，四列分别为 weeknumber、projectname、customername、comment

我希望能够生成一份报告，其中包含以下格式的特定一周的所有数据

*   项目名称 1
    *   客户 1
        *   评论 1
    *   客户 2
        *   评论 1
*   项目名称 2
    *   客户 3
        *   评论 1
    *   客户 4
        *   评论 1

我可以通过将列表导出到 Excel 文件然后编写一些 VBA 来生成 Word 文档来做到这一点，但我想知道是否有任何方法可以删除 Excel 步骤。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T07:40:39.853

所以这有两个部分

a) 从 SharePoint 获取数据。

b) 将其转换为 Word 文档。

对于 a) 您可能最终会远程运行（即不在 sharePoint 服务器上），因为不建议在服务器上自动化办公应用程序 - 因此您应该查看[SharePoint Web 服务](http://geekswithblogs.net/mcassell/archive/2007/08/22/Accessing-Sharepoint-Data-through-Web-Services.aspx)以访问您的数据。

对于 b) 您可以使用 - 办公自动化（通过 VBA 或 C#、VB.NET 等） - 按照 Pete 的建议打开 XML（[在 SharePoint 中运行的示例](http://sharepointplace.blogspot.co.uk/2009/12/programmatically-creating-word.html)） - 商业组件，例如[Apose](http://www.aspose.com/) *最后两个将允许您在SharePoint 服务器*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:10:39.327

[打开 XML](http://www.microsoft.com/en-us/download/details.aspx?id=5124)吗？

我发现它的学习曲线相当陡峭，但非常强大。我建议这是一种比 vba 更优雅的方法（因为您正在处理强类型类），但不一定更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T17:03:27.360

[Github](https://github.com/ngs-doo/TemplaterExamples) (FoodOrder) 上有一个很好的例子，说明如何使用 Templater。

作为作者，我强烈推荐它；）

# ruby-on-rails - 如何在 Rails 中关闭开发模式下的资产日志记录？

> ID：11000388
> 
> 赞同：5
> 
> 时间：2012-06-12T16:00:20.500
> 
> 标签：ruby-on-rails, asset-pipeline

我试过：

```
config.assets.logger = nil 
```

和

```
config.assets.logger = false 
```

任何线索如何让那些讨厌的日志出来？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-12T16:03:03.900

把它放在 config/initializers/quiet_assets.rb

```
if Rails.env.development?
  Rails.application.assets.logger = Logger.new('/dev/null')
  Rails::Rack::Logger.class_eval do
    def call_with_quiet_assets(env)
      previous_level = Rails.logger.level
      Rails.logger.level = Logger::ERROR if env['PATH_INFO'] =~ %r{^/assets/}
      call_without_quiet_assets(env)
    ensure
      Rails.logger.level = previous_level
    end
    alias_method_chain :call, :quiet_assets
  end
end 
```

这是解决这个问题的一个相当普遍的解决方案

也可以只使用宝石

```
gem 'quiet_assets', :group => :development 
```

# android - 错误捕获屏幕 Android 由 ddms

> ID：11000395
> 
> 赞同：-4
> 
> 时间：2012-06-12T16:00:44.170
> 
> 标签：android, screen, capture, ddms

请帮我！我用 ddms other 在我的手机上截屏，但效果不好！

这是屏幕截图 [http://i.stack.imgur.com/KgMpk.png](http://i.stack.imgur.com/KgMpk.png)

我尝试用模拟器或其他安卓手机捕捉，没关系。我不知道为什么！

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:08:01.377

尝试为您的设备正确设置驱动程序：按照此处的说明进行操作。如果您需要帮助，我可以来聊天以帮助您...

[http://developer.android.com/sdk/oem-usb.html](http://developer.android.com/sdk/oem-usb.html)

# asp.net-mvc-3 - ASP.NET MVC - 验证一次且仅一次，直到会话结束

> ID：11000397
> 
> 赞同：0
> 
> 时间：2012-06-12T16:00:51.637
> 
> 标签：asp.net-mvc-3, authentication, request

**设置**

我正在使用自定义表单身份验证 - 所有标准的东西。

在我的帐户控制器上的登录操作中，

*   我根据数据库检查用户的详细信息
*   如果成功，我将创建表单身份验证票
*   将登录的成员数据库行 ID 存储在工单的 UserData 中
*   加密票证
*   将票存储在 cookie 中
*   将 cookie 添加到 Reponse.Cookies 集合
*   重定向到主控制器上的索引操作

我在全局 asax 中为 AuthenticateRequest 事件注册了一个处理程序。在我的处理程序中，

*   我从 HttpContext.Current.Request.Cookies[FormsAuthentication.FormsCookieName];
*   如果 cookie 存在，我将解密 cookie 中 Forms Authentication 票证的值
*   使用存储在身份验证票证 UserData 中的 Id 从数据库中检索用户的详细信息。
*   创建一个自定义主体并将用户（它具有自定义 LoggedInUser 属性）设置为我从数据库中检索到的用户。
*   将 HttpContext.Current.User 设置为自定义主体

**问题**

我在登录后调试主页请求，并注意到 global.asax 中的 AuthenticateRequest 处理程序在每个页面请求中被多次命中。我检查了 HttpContext.Current.Request.Path，这是因为我页面上的每个资源（实际上是每个 HTTP GET）都在触发身份验证请求，所以，GET jquery.js、GET logo.png 等......

**问题**

在第一个处理的 AuthenticateRequest 中，我转到数据库，然后将 HttpContext.Current.User 设置为我的自定义主体。什么是避免进入数据库以获取导致 AuthenticatRequest 触发的后续 HTTP GET 的好方法。实际上，只进行一次身份验证，直到用户关闭浏览器或身份验证票证到期。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:03:25.510

我建议您编写一个全局操作过滤器，而不是使用`AuthenticateRequest`Global.asax 中的方法。这样，操作过滤器将仅在执行某些操作并填充用户之前应用。事实上，自定义`[Authorize]`属性是实现这一目标的最佳方式：

```
public class MyAuthorizeAttribute : AuthorizeAttribute
{
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        var authorized = base.AuthorizeCore(httpContext);
        if (!authorized)
        {
            return false;
        }

        // TODO: go ahead and work with the UserData from the authentication cookie
        // basically all the steps you described for your AuthenticateRequest handler
        // except for checking the presence of the forms authentication cookie because
        // we know that at this stage it exists and the user was successfully authorized

        return true;
    }
} 
```

# java - win7 64bit 上 Abbyy 的 Java Com4j 接口

> ID：11000399
> 
> 赞同：1
> 
> 时间：2012-06-12T16:00:54.417
> 
> 标签：java, com4j, abbyy

我目前正在尝试将使用 ABBY OCR 的 Java 解决方案从 Windows XP 32 位升级到 Windows 7 64 位。两者之间存在使用 com4j 的桥梁。新相间的生成效果很好，但使用它或更旧的相间生成此堆栈跟踪：

```
com4j.ComException: 8000ffff Défaillance irrémédiable : Erreur programme interne:
.\src\RegExpPreprocessor.cpp, 53\. : .\invoke.cpp:517
at com4j.Wrapper.invoke(Wrapper.java:166)
at $Proxy97.recognizeNextDocument(Unknown Source)
at net.atos.FraudeDocumentaire.engine.EngineAbbyy.analyseDocument(EngineAbbyy.java:202)
at net.atos.FraudeDocumentaire.engine.ThreadIdentification.run(ThreadIdentification.java:40)
at java.lang.Thread.run(Thread.java:662)
Caused by: com4j.ComException: 8000ffff Défaillance irrémédiable : Erreur programme interne:
.\src\RegExpPreprocessor.cpp, 53\. : .\invoke.cpp:517
at com4j.Native.invoke(Native Method)
at com4j.StandardComMethod.invoke(StandardComMethod.java:35)
at com4j.Wrapper$InvocationThunk.call(Wrapper.java:340)
at com4j.Task.invoke(Task.java:51)
at com4j.ComThread.run0(ComThread.java:153)
at com4j.ComThread.run(ComThread.java:134) 
```

你知道问题出在哪里吗？您认为这是 ABBYY 内部故障还是 com4j？

谢谢阅读。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-29T13:44:56.250

错误`.\src\RegExpPreprocessor.cpp`53 看起来像 ABBYY FineReader Engine 内部错误。请通过 SDK_Support@abbyy.com 联系 ABBYY 技术支持。

顺便说一句，最新的 ABBYY FineReader Engine Distribution Kit 包含自己的 Java 包装器 - `com.abbyy.FREngine.jar`. 您可以尝试使用它来代替 com4j。您需要`CreateEngineOutprocLoader`在 64 位进程中加载​​引擎的方法。

我们还建议您阅读 ABBYY FineReader Engine 帮助中的文章“在 Java 中使用 ABBYY FineReader Engine”。

# java - 搜索屏幕的休眠自定义查询

> ID：11000402
> 
> 赞同：1
> 
> 时间：2012-06-12T16:01:03.410
> 
> 标签：java, hibernate

我有一个搜索屏幕，它有 10 个字段，涉及大约 5 到 6 个表来获得结果。我正在编写自定义 SQL 查询并仅在值存在时附加 where 条件。

有人可以建议这是正确的方法还是其他更好的方法。

我不能针对我的情况使用任何插件或其他 API。

```
StringBuffer sqlQuery = new StringBuffer();
sqlQuery.append (" select member.* from member, customer, case where customer.status='A');
if(firstName != null)
sqlQuery.append("customer.firstName= :firstName");

if(caseid != null)
sqlQuery.append("case.caseid =:caseid");

SQLQuery queryObj = createSQLquery(sqlQuery.toString());
queryObj.list(); 
```

其中**成员、客户、案例**是实际表格。

**更新**

当我将 where 条件添加到字符串缓冲区时

```
if(caseid != null)
sqlQuery.append(" and case.caseid =:caseid");

and when queryObj is formed I am doing it as
if(caseid != null)
queryObj.setString("caseid", caseid);

is there better way to add after queryObj (to combine both)? 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:14:52.633

不，这不一定是正确的方法。使用 Hibernate 时，SQL 不是首选的查询语言。如果可能，应首选 HQL。Hibernate 也有专门为构建动态查询而设计[的 Criteria API 。](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#querycriteria)

# sql - 您可以使用 SQL 从 JSON 数组中选择值吗？

> ID：11000404
> 
> 赞同：12
> 
> 时间：2012-06-12T16:01:06.697
> 
> 标签：sql, sql-server, arrays, json

我在 SQL Server 2008 中有一个数据库，一个特定的表将信息作为 JSON 编码的数组存储在字段中。我想知道有一种基于 SQL 的方法来选择该 JSON 字段中的特定值吗？

当然，我可以只选择字段并自己解析信息，但如果可能的话，我会尽量避免这种情况。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T16:05:10.220

本机没有任何内容，但以下问题的第一个答案引用了一篇关于在 tSQL 中解析 JSON 对象的文章

[在 TSQL 中解析 JSON](https://stackoverflow.com/questions/2867501/parse-json-in-tsql)

作为参考，感兴趣的文章在这里：

[http://www.simple-talk.com/sql/t-sql-programming/sumption-json-strings-in-sql-server/](http://www.simple-talk.com/sql/t-sql-programming/consuming-json-strings-in-sql-server/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T16:03:44.977

**不**（嗯，有子字符串匹配，但这会很慢且容易出错）。如果您要存储要使用 SQL 过滤的内容，请不要使用 JSON，而是使用单独的列/表。

# java - java.util.Date 是否将日期表示为系统日期？

> ID：11000409
> 
> 赞同：1
> 
> 时间：2012-06-12T16:01:27.297
> 
> 标签：java

我需要在 Java 中获取真实世界的日期和时间。我用：

```
Date date = new Date(); 
```

但我不确定这不仅仅是系统时间。我不需要依赖 PC 本地日期和时间。

如果是这样，那么有没有办法从中抽象出来？我的意思是我需要正确的时间和日期。如果今天是 2012 年 5 月 1 日，并且用户将其更改（可能存在系统错误）到 2000 年 12 月 1 日，则不应影响业务逻辑。那么有没有其他方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T16:05:38.550

`Date` *仅表示自 1970 年 1 月 1 日**UTC*的 Unix 纪元（模闰秒）以来的时间瞬间，以毫秒为单位。它的数据中没有时区的概念。但是，如果您使用该`toString`方法，它将始终使用系统时区将该 UTC 瞬间转换为本地日期/时间。这让很多用户感到困惑，让他们认为`Date`包含时区——这只是一种错觉。

同样`Date`没有任何日历系统（公历、儒略等）或“格式”的概念。基本上它只是一个`long`:)

# linux - 使用 bash 历史记录获取先前的命令，复制它然后“运行”它，但命令注释

> ID：11000410
> 
> 赞同：79
> 
> 时间：2012-06-12T16:01:34.773
> 
> 标签：linux, bash, command-line

只是一个提高我`bash`技能的问题。我总是这样做：

```
$ history | grep some_long_command

...
...
123 some_long_command1.........
124 some_long_command2.........
... 
```

然后我可以通过执行以下操作运行我找到的命令：

`!123`

但是，我经常想这样做：

```
some_long_command1foobar 
```

即在我运行它之前更改命令。你可以使用 bash 来运行这个命令吗：

`#some_long_command1`

所以它得到评论。

然后我不必使用鼠标突出显示命令，编辑它然后运行它（我可以只使用键盘 - 更快）。

我想我可以编写一个脚本来做到这一点，但可能已经在某处内置了功能......？

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2012-06-12T16:03:51.063

我建议您不要使用历史命令，而是使用`ctrl+r`并开始输入该命令。当您按箭头键好像要修改它时，它将退出自动完成识别，并让您在运行前进行编辑。

更新：另外，如果您想循环浏览包含您刚刚键入的字符串的不同命令，请继续按`ctrl+r`

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2012-06-20T17:12:12.857

实际上，您可以只附加`:p`到命令以打印它而不实际运行它。例如：

```
$ ls -la
$ !!:p 
```

将打印`ls -la`为上一个命令而不运行它，您只需按`↑</kbd> (up) to find it and edit it.`

你也可以做

```
!123:p 
```

将第 123 个命令打印为上一个命令。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-06-12T16:32:54.207

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-06-12T16:07:21.777

```
!123:gs/old/new/ 
```

将运行命令 123 将字符串 'old' 替换为字符串 'new'。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-02-11T22:44:19.130

您可以通过按 M-^（Mac 上的 option-shift-6）进入编辑模式。

输入这个：

> !123M-^

您将编辑命令#123。这有点像使用 ctrl-r，但以感叹号语法开头。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-02-20T15:17:36.567

不要使用`history`命令，而是将`history-search-backward`/绑定`history-search-forward`到可以轻松记住的快捷键（我更喜欢 PgUp/PgDown）。为此，请将其放入您的`.inputrc`文件中：

```
"<key code>":  history-search-backward
"<key code>":  history-search-forward 
```

要获取`<key code>`，请输入`Ctrl-V <key>`shell，然后将输出中的开头替换`^[`为`\e`。

设置完成后，您只需键入`some`并按 PgUp 即可获取`some_long_command`. 如果您需要`some_long_command with_some_arg`，但历史稍后有类似的命令，您可以通过键入然后反复按 PgUp`some_long_command with_some_other_arg`循环直到到达它，或者您可以键入，按 PgUp，将光标移动到两个命令开始不同的位置，输入几个字符并再次点击 PgUp。在我看来，这种快速翻页/区分相似命令的能力使其成为比.`some``some``Ctrl-R`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-12T16:15:52.947

你也可以把

```
shopt -s histverify 
```

在你的`.bash_profile`，这会导致任何历史扩展出现在你的命令行上而不运行它，允许你在这样做之前进行编辑。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-01-10T00:18:31.703

您可能想尝试类似“建议框”的历史记录[https://github.com/dvorka/hstr](https://github.com/dvorka/hstr) - 它读取 Bash 历史记录并允许快速导航。

![呵呵](../Images/4dfb15001b31422f2e6a6feee72f5f12.png)

要获取最后一个命令，只需键入 hh，导航到该命令并使用向右箭头在命令行上获取它（您可以在其中编辑它和/或添加注释）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-02-11T14:15:42.027

^p 获取 unix/solaris 中最后输入的命令

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-11-27T19:47:07.847

放

别名 r='fc -s'

在您的`.bashrc`（主目录）中，您只需输入

```
r <whatever> 
```

在命令提示符下，您将执行`<whatever>`历史记录中最后一个命令（相同参数）的副本。如果您觉得需要，只需点击向上箭头即可查看您已执行的操作。

# http - 我网页上的链接指向 127.0.0.1 域而不是服务器 ip 地址

> ID：11000411
> 
> 赞同：0
> 
> 时间：2012-06-12T16:01:41.857
> 
> 标签：http, localhost, elgg

我正在安装 ELGG，这是一个基于 xampp 的社交网络框架。在服务器上运行时一切正常，例如

```
 http://127.0.0.1/..... 
```

当我尝试通过输入从网络上的另一台计算机查看页面时

```
 http://(the servers ip address).... 
```

第一页加载，但所有链接都试图转到

```
 http://127.0.0.1/.... 
```

它似乎正试图从 127.0.0.1 中获取资产。

我在网上看了很多关于此的信息，但我无法将其缩小到实际导致问题的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:08:15.857

我猜问题是您的站点在 elgg_sites_entity 数据库表中的条目需要更新。（该表名假定您使用“elgg_”作为数据库表前缀 - 在安装时设置）

请参阅此页面：[http](http://docs.elgg.org/wiki/Duplicate_Installation) ://docs.elgg.org/wiki/Duplicate_Installation 具体这部分：[http ://docs.elgg.org/wiki/Duplicate_Installation#Change_the_installation_path](http://docs.elgg.org/wiki/Duplicate_Installation#Change_the_installation_path)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-21T04:48:36.043

您必须更改`site_entity`表的链接和表中的 2 个条目`datalists`。

```
UPDATE `elgg_datalists` SET `value` = "/var/www/elgg_test/" WHERE `name` = "path";
UPDATE `elgg_datalists` SET `value` = "/var/data/elgg_test/" WHERE `name` = "dataroot";
UPDATE `elgg_sites_entity` SET `url` = "http://test.myelgg.org/"; 
```

请看[这里](http://docs.elgg.org/wiki/Duplicate_Installation#Change_the_installation_path)

# ajax - PrimeFaces 数据表更新

> ID：11000415
> 
> 赞同：0
> 
> 时间：2012-06-12T16:01:49.143
> 
> 标签：ajax, jsf, primefaces

我的网页有此代码

```
 <h:form id="formTipoGeneracion"
            enctype="multipart/form-data">
        <p:growl id="mensajesCargaArchivos"
                 showDetail="true"/>
        <p:fileUpload mode="simple"
                      value="#{generador.archivoSeleccionado}"/>
        <br/>
        <p:commandButton value="Agregar"
                         ajax="false"
                         action="#{generador.doAgregarArchivo}"/>
        <p:dataTable id="dtArchivos"
                     var="archivo"
                     emptyMessage="No se ha cargado ningun archivo en el servidor."
                     value="#{generador.archivos}">
            <p:column>
                <f:facet name="header">
                    <h:outputText value="Nombre del archivo"/>
                </f:facet>
                <h:outputText value="#{archivo}"/>
            </p:column>
            <p:column>
                <f:facet name="header">
                    <h:outputText value="Quitar archivo?"/>
                </f:facet>
                <p:commandLink value="[  X  ]" update="@form"
                               action="#{generador.doEliminarArchivo(archivo)}"/>
            </p:column>
        </p:dataTable>
    </h:form> 
```

我有一个很大的疑问，当我让`<p:commandLink ... update="@form" .../>`表正确更新其数据但如果我有`<p:commandLink ... update="dtArchivos" .../>`（而不是渲染整个表单只是渲染 DataTable）表上的信息不会更新。

为什么会这样？工具：PrimeFaces 3.3、Mojarra 2.1.6、Tomcat 7.0.14 Bean的作用域：ViewScope

# mysql - SQL - 在许多情况下updated_date为null时如何按item_id和last_updated日期查询？

> ID：11000417
> 
> 赞同：1
> 
> 时间：2012-06-12T16:01:53.760
> 
> 标签：mysql, sql

我有一个简单的查询，它通过 item_id 查询，它显然有效，因为它非常简单。

我需要做的是将其更改为也考虑更新日期，并且类似于以下内容：

```
 select item_id , item_name from items order by item_id , update_date desc limit 200 
```

所以要求是：

*   按 update_date 排序，按 item_id 抢七。
*   如果 update_date 为空，只需按 item_id 对其进行排名。

我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:11:19.717

当你排序的时候，SQL会按照查询中字段的顺序依次排序，所以在下面的例子中

```
select item_id , item_name, update_date, from items order by update_date desc , item_id  desc; 
```

它将首先按 update_date 排序，然后按 item_id 对这些（排序的）结果进行排序，均降序排列。

# mysql - 创建链接表的最佳方法，其中包含其链接的实体之一的附加表（查看我的图像）

> ID：11000418
> 
> 赞同：0
> 
> 时间：2012-06-12T16:01:56.503
> 
> 标签：mysql, database-design

我正在创建两个具有 M:N 关系的表。一个表称为用户，另一个是编辑（编辑，因为它是图像或文本的编辑），用户可以对编辑进行投票，编辑可以有多个投票，因此链接表。当用户对编辑进行投票时，它是比较 2 个编辑的投票，所以我希望它存储正在比较的编辑。我想知道将它实现到数据库中的好方法是什么。

因此，用户对 2 个编辑进行了投票，其中一个优于另一个。我想存储被投票反对的值和与之比较的另一个编辑。

这是我的原始设计的样子： ![原表](../Images/717f09ecd3a56205f55d5fedd56a9b69.png)

这是我想出的解决方案，请告诉我这是否是实现我想要的好方法： ![解决方案](../Images/864a6641e52c4a1fb8482f8a4c801aba.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T19:46:13.643

*   上有一个唯一索引（备用键）（AK）`NewDocument` `(DocumentID, DocumentType)`；`Document`表中的外键`(DocumentID, DocumentType)`指向此处。这用于锁定给定的文档类型。`DocumentID`打开新文档后，将版本 1 放在`Document`表中。

*   `EditVotes`在for上放置一个检查约束`Version_B > Version_A`

![在此处输入图像描述](../Images/97b538545d1331ea60d3801ae504c1cb.png)

# mysql - 加密 mysql 服务器中的日期时间字段

> ID：11000422
> 
> 赞同：2
> 
> 时间：2012-06-12T16:02:07.757
> 
> 标签：mysql

我有 2 个存储过程`Encode`，`Decode`我想使用这个 sp 将我的`datetime`列值（比如`Dob`）转换为加密日期。***问题是加密格式不在 datetime(varbinary) 中，因此它不能插入到该字段中***。更改数据类型或添加新列对我不利，因为我的数据库是一个有很多表和 sps 的巨大数据库。我目前使用的步骤是：

```
declare @datetime
set @datetime='01/02/2008 12:45 PM'
declare @secretDate varchar(400)
declare @date varchar(200)
set @date=(select Convert(varchar(200),@datetime,120)
EXEC @secretDate=dbo.Encode @date
set @date=(select Convert(varchar(200),@secretdate,120))
select Convert(varchar(200),convert(varbinary(MAX),@date)) as EncryptedDate 
```

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T07:37:41.970

您必须在多个步骤中对列定义进行此更改。

1) 为编码值添加一个新的 encryptedDate 列集。

2) 从表中删除现有的日期列。

3) 将 encryptedDate 重命名为现有日期列名。

您也许可以在一个命令中执行步骤 2 + 3，但我不确定语法。

> 任何建议表示赞赏！

这整件事听起来是个坏主意。如果数据已加密，但“解码”函数是数据库中的存储过程，则数据实际上并未加密。这样做还会阻止所有数据比较工作，这是一件坏事。

如果您不想将数据呈现给用户，为什么不直接在从数据库中读取数据时对其进行编码？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T08:11:23.407

时间，尤其是日期具有非常不寻常的非线性结构。即使将日期存储在用于日期的结构中也很困难。如果您需要加密存储此数据，请不要尝试将其存储在日期/日期时间字段中。

# javascript - 添加/删除类和动画元素的不同方法

> ID：11000426
> 
> 赞同：1
> 
> 时间：2012-06-12T16:02:37.897
> 
> 标签：javascript, jquery, animation

我有 5 个列表项，当单击一个时，我知道的唯一方法是为所有元素设置动画，然后将所选元素重新设置为新宽度。谁能告诉我如何减少这个过程，以便只有当前活动项目被激活并删除类，然后新项目被激活并添加活动类？

JS

```
var test = $('#test'),
    test_li = test.children(),
    small = 60,
    large = 200;

test_li.on('click', function(e) {

    if( !$(this).hasClass('active') ){
        test_li.animate({ width: small }, 300).removeClass('active'); //animates every single li every time
        $(this).animate({ width: large }, 300).addClass('active');
    } 

});​ 
```

小提琴在这里：http: [//jsfiddle.net/TSNtu/1/](http://jsfiddle.net/TSNtu/1/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T16:04:21.873

```
var test = $('#test'),
    test_li = test.children(),
    small = 60,
    large = 200;

test_li.on('click', function(e) {

    // if clicked element is active itself then do nothing
    if ($(this).hasClass('active')) return;

    // remove active from others
    $('.active', test).animate({
        width: small
    }, 300).removeClass('active');
    // animate the clicked one
    $(this).animate({
        width: large
    }, 300).addClass('active');
}); 
```

**[演示](http://jsfiddle.net/TSNtu/10/)**

单链

```
var test = $('#test'),
    test_li = test.children(),
    small = 60,
    large = 200;

test_li.on('click', function(e) {

    // if clicked element is active itself then do nothing
    if ($(this).hasClass('active')) return;

    $(this) // clicked li
        .animate({
            width: large
        }, 300)
        .addClass('active')
        .siblings('.active') // other li
        .animate({
            width: small
        }, 300)
        .removeClass('active');
}); 
```

**[演示](http://jsfiddle.net/TSNtu/11/)**

# android - Android listview按像素滚动，没有延迟

> ID：11000427
> 
> 赞同：2
> 
> 时间：2012-06-12T16:02:39.890
> 
> 标签：android, listview, scroll

我有一个列表视图，我正在实现捏缩放。我调整了更改行高的列表视图的每个子视图的大小。调整这些行的大小时，列表视图的顶部项目保持静止，其下方的项目向上移动以恢复松弛空间。

我正在尝试分两部分实现捏缩放。首先，使缩放原点成为可见列表的中心（现在它是顶部，就像我说的那样）。其次，根据缩放手势的焦点调整原点。

我的问题是我无法顺利调整缩放的原点。我现在使用的方法*确实*滚动了列表，但它会在视图更新后几毫秒执行它（它实际上看起来很糟糕......它真的很不稳定）。

有没有更好的方法来做我在下面的代码中所做的事情？

mMsgs 是一个列表视图。

```
// Center align the scroll
int yviewspace = mMsgs.getHeight();
int newyviewspace = (int) (yviewspace * zoomratio);
//mMsgs.scrollBy(0, -(yviewspace - newyviewspace) / 2); //This is smooth, but, sadly, it doesn't work on listviews.
mMsgs.smoothScrollBy(-(yviewspace - newyviewspace) / 2, 0); 
```

# c# - C#.net Windows 应用程序 - 在插入数据库之前检查输入数据

> ID：11000429
> 
> 赞同：0
> 
> 时间：2012-06-12T16:02:46.897
> 
> 标签：c#, .net, validation, ms-access-2007

我正在做一个预订系统。

在插入数据库之前，我无法弄清楚一系列数据的验证算法。主键将是系统自动生成的预订 ID。

我需要验证 bdate、btime 和 sname。（bdate=预订时间，btime=预订时间，sname=员工姓名）

在 bdate、btime 和 sname 的情况下，与客户端输入的内容相同。由于员工已经在同一日期和时间进行了预订，因此系统将提醒其重复。

请在下面找到我的插入查询，并感谢您能指出我正确的方法。

```
 private void btn_save_Click(object sender, EventArgs e)
    {
        OleDbCommand cmd = new OleDbCommand();
        cmd.CommandType = CommandType.Text;

        //query for duplicate
        cmd.CommandText = "select count(*) from Booking where sname = @newName and bdate = @newDate and btime = @newTime";
       // cmd.Parameters.Add("@newName", OleDbType.VarChar).Value = txt_cname.Text;
        //cmd.Parameters.Add("@newDate", OleDbType.DBDate).Value = dtp_bdate.Value.Date;
       // cmd.Parameters.Add("@newTime", OleDbType.VarChar).Value = dtp_btime.Value.ToString("hh:mm tt");

        cmd.CommandText = "insert into Booking(cname, bdate, btime, ccontact, sname) Values('" + txt_cname.Text + "','" + dtp_bdate.Value.Date + "','" + dtp_btime.Value.ToString("hh:mm tt") + "','" + txt_ccontact.Text + "','" + txt_sname.Text + "')";
        cmd.Connection = myCon;
        myCon.Open();

        int recordCount = Convert.ToInt32(cmd.ExecuteScalar());

        myCon.Close();

        if (recordCount>0)

        {
            // handle duplicates
            MessageBox.Show("Duplicated", "My Application",
            MessageBoxButtons.OKCancel, MessageBoxIcon.Asterisk);
        }

       // cmd.Connection = myCon;
        //myCon.Open();
       //cmd.ExecuteNonQuery();
        //myCon.Close();
        //MessageBox.Show(dtp_bdate.Value.ToString());
        //MessageBox.Show("Booking completed", "My Application",
       // MessageBoxButtons.OKCancel, MessageBoxIcon.Asterisk);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T09:04:56.870

```
 private bool RecordExists(string name, DateTime date, string time)
    {
        OleDbCommand cmd = new OleDbCommand();
        cmd.CommandType = CommandType.Text;

        //query for duplicate
        cmd.CommandText = "select count(*) from Booking where sname = @newName and bdate = @newDate and btime = @newTime";
        cmd.Parameters.Add("@newName", OleDbType.VarChar).Value = txt_cname.Text;
        cmd.Parameters.Add("@newDate", OleDbType.DBDate).Value = dtp_bdate.Value.Date;
        cmd.Parameters.Add("@newTime", OleDbType.VarChar).Value = dtp_btime.Value.ToString("hh:mm tt");

        myCon.Open();

        int recordCount = Convert.ToInt32(cmd.ExecuteScalar());

        myCon.Close();

        return recordCount > 0;
    }

    private void btn_save_Click(object sender, EventArgs e)
    {
        if (RecordExists(txt_cname.Text, dtp_bdate.Value.Date, dtp_btime.Value.ToString("hh:mm tt"))
        {
            MessageBox.Show("Duplicated", "My Application", MessageBoxButtons.OKCancel, MessageBoxIcon.Asterisk);
            return;
        }

        OleDbCommand cmd = new OleDbCommand();
        cmd.CommandType = CommandType.Text;

        cmd.CommandText = "insert into Booking(cname, bdate, btime, ccontact, sname) Values(@newName, @newDate, @newTime, @newContact, @newSName)";
        cmd.Parameters.Add("@newName", OleDbType.VarChar).Value = txt_cname.Text;
        cmd.Parameters.Add("@newDate", OleDbType.DBDate).Value = dtp_bdate.Value.Date;
        cmd.Parameters.Add("@newTime", OleDbType.VarChar).Value = dtp_btime.Value.ToString("hh:mm tt");
        cmd.Parameters.Add("@newContact", OleDbType.VarChar).Value = txt_ccontact.Text;
        cmd.Parameters.Add("@newSName", OleDbType.VarChar).Value = txt_sname.Text;

        cmd.Connection = myCon;
        myCon.Open();
        cmd.ExecuteNonQuery();
        myCon.Close();

        MessageBox.Show(dtp_bdate.Value.ToString());
        MessageBox.Show("Booking completed", "My Application", MessageBoxButtons.OKCancel, MessageBoxIcon.Asterisk);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:16:54.397

您需要在执行插入之前检查预订是否存在，因此您需要添加一个额外的步骤：

```
OleDbCommand cmd = new OleDbCommand();
cmd.CommandType = CommandType.Text;

cmd.CommandText = "select count(*) from booking where cname = @newName and bdate = @newDate and ctime = @newTime";

cmd.Parameters.Add("@newName", OleDbType.VarChar).Value = txt_cname.Text;
cmd.Parameters.Add("@newDate", OleDbType.DBDate).Value = dtp_bdate.Value.Date;
cmd.Parameters.Add("@newTime", OleDbType.VarChar).Value = dtp_btime.Value.ToString("hh:mm tt");

cmd.Connection = myCon;
myCon.Open();

int recordCount = Convert.ToInt32(cmd.ExecuteScalar());

myCon.Close();

if (recordCount>0)
{
    // handle duplicates
} 
```

当您执行此操作时，它将返回匹配的行数，如果这是 1 或更多，那么您应该调用您的重复逻辑。

编辑以更正代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T16:19:36.330

要检查是否存在现有字段，您可以创建一个`Select`然后进行比较：

```
bool InfoRepeated()
    {
        OleDbCommand cmd = new OleDbCommand();
        cmd.CommandType = CommandType.Text;
        cmd.CommandText = string.Format("SELECT cname FROM yourTable;");
        cmd.Connection = myCon;
        myCon.Open();
        try
        {
            OleDbDataReader rdr = cmd.ExecuteReader();
            while (rdr.Read())
            {
                if (txt_cname.Text.Equals((rdr[0].ToString())))
                {
                    myCon.Close();
                    return true;
                }
            }
            myCon.Close();
            return false;
        }
        catch (Exception e)
        {
            MessageBox.Show(e.Message);
            myCon.Close();
            return false;
        }
    } 
```

让我知道它是否有效或您收到的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-08T09:36:09.983

工作有用的代码试试这个

```
BOMaster obj_data = new BOMaster();

obj_data.productid = tempid;
obj_data.categoryid =int.Parse(cmbcategory.SelectedValue.ToString());
obj_data.productcode = txtproductcode.Text;
obj_data.productname = txtproductname.Text;
obj_data.mqty = decimal.Parse(txtmqty.Text.ToString());

OleDbCommand mycmd = new OleDbCommand("select * from productmaster where productname=?", new OleDbConnection(Common.cnn));
BOMaster obj_datan = new BOMaster();

mycmd.Parameters.Add(new OleDbParameter("productname", txtproductname.Text));
mycmd.Connection.Open();

OleDbDataReader myreader = mycmd.ExecuteReader(CommandBehavior.CloseConnection);

if (myreader.HasRows == true)
{
    // savestutus = "false";
    MessageBox.Show("Product Name Already Exist", "Product", MessageBoxButtons.OK, MessageBoxIcon.Information);
    txtproductname.Focus();
    return;
}
mycmd.Connection.Close();

ProductDAL obj_dal = new ProductDAL();

if (obj_dal.Save(obj_data))
{
    Clear();
} 
```

# magento - Magento 重定向

> ID：11000430
> 
> 赞同：0
> 
> 时间：2012-06-12T16:02:48.660
> 
> 标签：magento, redirect, localization

我有一家商店，有 4 个适用于所有语言的域，因此 .nl 用于荷兰语/荷兰，.de 用于德语/德国等。

一段时间以来发生了一些奇怪的事情：如果我输入 .de 地址，我将被重定向到默认商店视图，在我的例子中是荷兰商店视图 (.nl)。当我使用商店选择器并选择德语时，我到达了德语商店。下次我使用商店并在地址栏中输入德国域时，我会直接重定向到正确的商店。在这种情况下，德国商店。我知道它必须是 cookie，但我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T21:43:51.090

尝试将 system > configuration > web > session cookie 中的 cookie 路径设置为“/”，并确保您在 Manage stores > Stores 中设置了默认存储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-06T15:51:40.093

尝试使用可以自动将您的特定客户重定向到特定商店的扩展程序。

来源：[http ://www.vjtemplates.com/magento-extensions/92-csci2store](http://www.vjtemplates.com/magento-extensions/92-csci2store)

# php - 如何强制父类保持其受保护属性的价值？

> ID：11000431
> 
> 赞同：0
> 
> 时间：2012-06-12T16:02:55.167
> 
> 标签：php, oop, inheritance

我有两个类，`Foo`扩展如下： `Bar``Bar``Foo`

```
class Foo {
    protected 
        $options = array(), 
        $defaults = array(1, 2);

    public function __construct($options){
        array_push($this->options, $this->defaults);
    }
}

class Bar extends Foo {
    protected $defaults = array(3, 4);

    public function print(){
        print_r($this->$options);
    }
}

$bar = new Bar();
$bar->print(); 
```

我认为结果应该是`array(1,2,3,4)`但是`array(3,4)`。
如何解决？

**编辑**
我不希望 Bar 类具有构造函数，因为我只是超类的实现者并且不知道子类中真正会发生什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:08:38.160

有几个解决方案，最简单的方法是使用第二个变量作为扩展默认值，然后合并数组。

```
class Foo {
    protected
        $options = array(),
        $original_defaults = array(1, 2),
        $extended_defaults = array();

    public function __construct($options){
        array_merge($this->extended_defaults, $this->original_defaults);
        array_push($this->options, $this->original_defaults);
    }
}

class Bar extends Foo {
    protected $extended_defaults = array(3, 4);

    public function print(){
        print_r($this->$options);
    }
}

$bar = new Bar();
$bar->print(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T16:09:32.467

为什么它会结合你的阵列？

您设置`$defaults`为`(1,2)`，然后设置为`(3,4)`- 您没有将它们连接起来。

您的构造函数添加`(1,2)`到`$options`. 这就是它所做的一切。

您的 print 方法输出`$defaults`此时将是`(3,4)`因为您将它们初始化为受保护的 var。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T16:04:07.397

如果您不希望这些值被覆盖，请使用`private`而不是`protected`. 这将防止子类覆盖这些值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T16:19:51.993

首先 - 你不能有一个名为 的方法`print`。 `print`是一种语言结构，不能被覆盖。

其次，您应该将类​​的默认值设为私有，并在子类中覆盖它们。然后，您可以在调用构造函数时将它们组合在父级中。不是 100% 清楚您要完成什么，但以下内容会将子类的默认选项与超类合并：

**更新以删除构造函数**

```
abstract class Foo {
    protected $options = array();

    private $defaults = array(1, 2);

   // Implementations of this class MUST define this method
   abstract function overrideDefaults(); 

    public function __construct($options = array()){
        // Merge any incoming options with the default options
        $this->options = array_merge($this->defaults, $options);

    }

    // Concrete children can use this method to modify the current options by 
    // passing in their own defaults.
    protected function modifyDefaults( $defaults ) {
        $this->options= array_merge( $this->defaults, $defaults );
    }

    public function printOps(){
        print_r($this->options);
    }
}

class Bar extends Foo {
    private $defaults = array(3, 4);

    public function overrideDefaults() {
        parent::modifyDefaults( $this->defaults );
    }
}

$bar = new Bar();
$bar->overrideDefaults();
$bar->printOps(); 
```

请注意，我还将 now`printOps`方法移到了超类中。输出：

```
Array ( [0] => 1 [1] => 2 [2] => 3 [3] => 4 ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T17:46:03.483

“我只希望每个子类都可以有它的默认值”。

您希望每个类都有特定的数据。

您可以使用“静态字段”，使类本身充当变量。我不是“静态成员”的粉丝，但我认为它适用于您的“用例”。

```
class Foo {
    private 
      // (1) "private" only accessed by the class itself,
      // neither external code, or subclasses,
      // (2) "static", specific to the class,
      static $defaults = array(1, 2);

    protected 
      // want to be accessed only by class & subclasses
      $options = array();

    // when using "static fields" in constructor,
    // you need to override constructor
    public function __construct($options){
        array_push($this->options, Foo::$defaults);
    }

    // ops, "print" is reserved identifier
    // public function print(){

    public function display_options() {
        print_r($this->$options);
    }

    public function display_defaultoptions() {
      // in order to acccess "static fields",
      // you use the class id, followed by double colon,
      // not "$this->*"
      print_r(Foo::$defaults);
    }
} // class Foo

class Bar extends Foo {
private 
    // (1) "private" only accessed by the class itself,
    // neither external code, or subclasses,
    // (2) "static", specific to the class,
    static $defaults = array(1, 2);

    // when using "static fields" in constructor,
    // you need to override constructor
    public function __construct($options){
        array_push($this->options, Bar::$defaults);
    }

    public function display_defaultoptions() {
      // in order to acccess "static fields",
      // you use the class id, followed by double colon
      // not "$this->*"
      print_r(Bar::$defaults);
    }
} // class Bar

$bar = new Bar();
$bar->print(); 
```

干杯

# facebook - 很多长期存在的 access_tokens 被 Facebook 无故失效

> ID：11000433
> 
> 赞同：0
> 
> 时间：2012-06-12T16:02:59.723
> 
> 标签：facebook, migration, access-token

由于不推荐使用 offline_access 并启用了迁移，因此我遇到了这个问题。

我正在获得用于在 Pages 上安排帖子的长期访问令牌。我正在使用服务器端授权流程。

所有页面令牌永不过期（使用调试器工具检查），但是对于某些应用程序用户，或者以随机方式对所有用户来说，好的令牌有时会因错误而失效：“会话与当前存储的会话不匹配。这可能是因为用户在创建会话后更改了密码，或者 Facebook 出于安全原因更改了会话。” 或“...用户已更改密码...”。

还有其他人有同样的问题[http://developers.facebook.com/bugs/243018099133564](http://developers.facebook.com/bugs/243018099133564)

我希望任何人都可以提供帮助。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T18:38:01.553

您的回答是这是一个已知的 Facebook 错误。见[http://developers.facebook.com/bugs/243018099133564](http://developers.facebook.com/bugs/243018099133564)

对不起，有时答案不是你想要的。

# expect - 生成 ssh 或 telnet 连接时如何处理超时？

> ID：11000436
> 
> 赞同：2
> 
> 时间：2012-06-12T16:03:06.377
> 
> 标签：expect, cisco-ios

我制作了一个期望/bash 脚本来检索 cisco 设备配置；这是简单的复制cisco运行配置并使用tftp保存。

```
#!/bin/bash
while read line;
    do

device=$line;
expect << EOF

spawn telnet $device
expect "Username:"
   send "username\n"
   expect "Password:"
  send "password\n"
send "copy running-config tftp://192.168.244.14\r"
expect "Address or name of remote host"
send "\r"
expect "Destination filename "
send "\r"
expect "secs"
send "exit\r"
close
EOF

done < /home/marco/Scrivania/Host.txt

exit 0 
```

我的问题是我有几个设备，一些配置为接受 telnet 连接，另一些只接受 ssh 连接。因此，在我的脚本中，我会添加以下内容：

如果 3 分钟后没有响应，请尝试使用 telnet 连接到设备，取消“spawn telnet...”命令并尝试使用 ssh 连接。

我可以用女巫的方式实现这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:39:08.680

这不是解决这个问题的正确方法，真的。最好有两个单独的列表：一个用于 telnet，一个用于 ssh。从长远来看，它只是让事情变得更简单。

但是，如果您真的打算让连接挂起并超时，那么您当然可以这样做。只需以秒为单位设置一个超时值，如果超过了超时时间，则采取的措施。

例如：

```
spawn telnet $device
expect -timeout 180 {
    "Username:" {send "username\r\n"; sleep 1; send "password\r\n"}
    timeout     { your_ssh_actions_or_proc } 
```

# android - 限制 Kindle Fire 模拟器使用 xlarge-mdpi 资源？

> ID：11000437
> 
> 赞同：1
> 
> 时间：2012-06-12T16:03:08.130
> 
> 标签：android, android-emulator, android-resources, kindle-fire

如果我有两个资源目录：

*   `res/drawable-large-mdpi`和
*   `res/drawable-xlarge-mdpi`

那么由亚马逊规范制作的 Kindle Fire 模拟器将始终使用后面目录中的资源。

原因是已知的：模拟器计算 Fire 的屏幕，`xlarge-mdpi`虽然实际上它是`large-mdpi`.

如何同时拥有资源目录并强制 Fire 使用来自 的资源`res/drawable-large-mdpi`，同时让其他 10 英寸平板电脑使用来自 的资源`res/drawable-xlarge-mdpi`？我试图解决这个问题好几天都没有成功。

PS。我没有真正的设备，但我通过亚马逊规范创建的模拟器对 Kindle Fire 进行了测试。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:57:28.687

> 如何同时拥有资源目录并强制 Fire 使用 res/drawable-large-mdpi 中的资源，同时让其他 10 英寸平板电脑使用 res/drawable-xlarge-mdpi 中的资源？

它已经这样做了，所以你的工作已经完成。

但是，您可能需要购买 Fire 来测试它。在这方面，您无法创建忠实再现 Fire 的 2.3.x 仿真器图像。

您应该能够创建一个应该可以工作的较新的模拟器（例如，3.2 或 4.0），尽管我还没有尝试过。他们修复了模拟器计算，以便在 2.3 之后的一段时间内更好地处理这种情况。

# android - android以编程方式删除特定联系人

> ID：11000438
> 
> 赞同：7
> 
> 时间：2012-06-12T16:03:14.917
> 
> 标签：android

现在，此代码正在运行 `ops.add(ContentProviderOperation .newDelete(ContactsContract.Data.CONTENT_URI) .withSelection(ContactsContract.Data.RAW_CONTACT_ID+"=?",new String[] {sid}).build());`

但是，它会创建未知记录，并且似乎是已删除的联系人。我需要一些东西让它正常工作吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-15T07:20:07.010

我让它这样工作：

```
public static boolean deleteContact(Context ctx, String phone, String name) {
    Uri contactUri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI, Uri.encode(phone));
    Cursor cur = ctx.getContentResolver().query(contactUri, null, null, null, null);
    try {
        if (cur.moveToFirst()) {
            do {
                if (cur.getString(cur.getColumnIndex(PhoneLookup.DISPLAY_NAME)).equalsIgnoreCase(name)) {
                    String lookupKey = cur.getString(cur.getColumnIndex(ContactsContract.Contacts.LOOKUP_KEY));
                    Uri uri = Uri.withAppendedPath(ContactsContract.Contacts.CONTENT_LOOKUP_URI, lookupKey);
                    ctx.getContentResolver().delete(uri, null, null);
                    return true;
                }

            } while (cur.moveToNext());
        }

    } catch (Exception e) {
        System.out.println(e.getStackTrace());
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-14T12:44:18.957

如中所述

[http://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html](http://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html)

RawContacts 中的 CONTACT_ID 字段是聚合联系人的链接。通过删除 RawContact`ContentProviderOperation.newDelete`将使该字段为空（正如我发现的那样）。何时实际删除 RawContact 取决于 Android 同步和聚合。我需要从特定帐户中删除特定联系人，因此通过 RawContacts 删除，而不是聚合联系人对我有用。为了检查 RawContact 是否已被删除，我使用了：

```
 ArrayList<ContentProviderOperation> ops = new ArrayList<ContentProviderOperation>();

    ContentResolver contentResolver = getContentResolver();

    Cursor curRawContacts = contentResolver.query(ContactsContract.RawContacts.CONTENT_URI, null,
            ContactsContract.RawContacts.ACCOUNT_TYPE + " = ? AND " + ContactsContract.RawContacts.ACCOUNT_NAME
                    + " = ?", new String[]{"MYTYPE", MyAccount}, null);

    int size = curRawContacts.getCount();

    for (int i = 0; i < size; i++) {

        curRawContacts.moveToPosition(i);

        //getColumnIndexOrThrow(String columnName)
        //Returns the zero-based index for the given column name, or throws IlleidRawContactgalArgumentException if the column doesn 't exist.
        String idRawContact = curRawContacts.getString(curRawContacts.getColumnIndexOrThrow(ContactsContract.RawContacts._ID));
        String idContact = curRawContacts.getString(curRawContacts.getColumnIndexOrThrow(ContactsContract.RawContacts.CONTACT_ID));

        // if link to aggregated contact is null, than raw contact had already been deleted
        if (idContact != null) { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-24T10:03:10.683

`newDelete`ContentProvider**的方法对我不起作用**。它会删除联系人中的所有信息，但会在您的电话簿中留下一个**空（null null）**联系人。

这就是为什么我必须将**ContentResolver**与`delete`方法一起使用。

我想删除使用我的应用创建的特定联系人`SOURCE_ID`。

我已经设置`CALLER_IS_SYNCADAPTER`为`true`.

所以这就是我管理它的方式：

```
Uri contactUri = RawContacts.CONTENT_URI.buildUpon().appendQueryParameter(ContactsContract.CALLER_IS_SYNCADAPTER, "true").build();
String whereClause = RawContacts.SOURCE_ID + " = ?";
String[] args = new String[]{contactId};

int deletedRawContacts = context.getContentResolver().delete(contactUri, whereClause, args);

if (deletedRawContacts > 0) {
    Log.d(TAG, "Delete OK");
} else {
    Log.d(TAG, "Nothing to delete");
} 
```

# c - 简单加密 - C 中的哈希总和

> ID：11000440
> 
> 赞同：1
> 
> 时间：2012-06-12T16:03:23.403
> 
> 标签：c, algorithm, math, linear-algebra, discrete-mathematics

我试图就用 C 编写的游戏中的一段代码中的漏洞演示一个简单的概念证明。

假设我们要验证角色登录。登录由用户从图形菜单中选择`n`项目（我们现在假设）来处理。`n=5`这些物品都是中世纪的主题：

例如：

```
 _______________________________
|           |           |       |
| Bow       | Sword     | Staff |
|-----------|-----------|-------|
| Shield    | Potion    | Gold  |
|___________|___________|_______| 
```

用户必须单击每个项目，然后为每个项目选择一个数字。

然后验证算法执行以下操作：

1.  确定选择了哪些项目
2.  将每个字符串删除为小写（即：`Bow`变为`bow`等）
3.  为每个字符串计算一个简单的字符串哈希（即：`bow => b=2, o=15, w=23, sum = (2+15+23=40)
4.  将哈希乘以用户为相应项目选择的值；这个新值称为`key`
5.  将`keys`每个选定项目的总和; 这是最终的验证哈希
6.  重要提示：验证器将接受此哈希以及它的非零倍数（即：如果最终哈希等于 1111，则 2222、3333、8888 等也是有效的）。

因此，例如，假设我选择：

```
Bow (1)
Sword (2)
Staff (10)
Shield (1)
Potion (6) 
```

该算法将这些字符串中的每一个都删除为小写，计算它们的字符串哈希，将该哈希乘以为每个字符串选择的数字，然后将这些键相加。

例如：

`Final_Validation_Hash = 1*HASH(Bow) + 2*HASH(Sword) + 10*HASH(Staff) + 1*HASH(Shield) + 6*HASH(Potion)`

通过应用欧拉方法，我计划证明这些哈希不是唯一的，并想设计一个简单的应用程序来证明它。

就我而言，对于 5 个项目，我基本上会尝试计算：

`(B)(y) = (A_1)(x_1) + (A_2)(x_2) + (A_3)(x_3) + (A_4)(x_4) + (A_5)(x_5)`

在哪里：

```
B is arbitrary
A_j are the selected coefficients/values for each string/category
x_j are the hash values for each string/category
y is the final validation hash (eg: 1111 above)
B,y,A_j,x_j are all discrete-valued, positive, and non-zero (ie: natural numbers) 
```

有人可以帮助我解决这个问题还是给我一个类似的例子（即：代码、计算出的方程式等）？我只需要解决最后一步（即：（B）（Y）= ...）。

* * *

最后，我编写了一个递归算法，该算法`n`深入层次，然后为所有剩余的可能组合处理递增、测试等。效率不是很高，但它确实有效。我可以根据要求提供（太大，无法在此处发布）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:21:18.500

它可能是唯一的，也可能不是唯一的，具体取决于菜单上的项目`x_j`、系数`A_j`、验证散列`y`以及所选项目的数量`n`。

例如，如果您的验证哈希是 会发生什么`1`？然后一切都会验证。

另一方面，如果您有`n`项目总数，那么只有一个可能的哈希值是唯一的。

当然，这些都是极端的例子，但它们说明了这一点。这取决于你的参数。除了蛮力之外，没有一种简单的通用方法可以检测哈希是否唯一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:22:05.537

这很简单，因为该算法接受非零倍数。如果将所有输入乘以 2，则会发生冲突：

```
Bow (1)
Sword (2)
Staff (10)
Shield (1)
Potion (6)

y = (A_1)(x_1) + (A_2)(x_2) + (A_3)(x_3) + (A_4)(x_4) + (A_5)(x_5) 
```

然后将它们乘以 2：

```
Bow (2)
Sword (4)
Staff (20)
Shield (2)
Potion (12)

2(A_1)(x_1) + 2(A_2)(x_2) + 2(A_3)(x_3) + 2(A_4)(x_4) + 2(A_5)(x_5)
= 2((A_1)(x_1) + (A_2)(x_2) + (A_3)(x_3) + (A_4)(x_4) + (A_5)(x_5))
= 2y 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T16:23:00.247

虽然这不是一个正式的证明，但我有一个想法。

让不同字符串的哈希为`h_1`, `h_2`, ...,`h_n`线性和为

`y = h_1 + h_2 + ... + h_n`

一旦我们有了`y`，我们总能找到`h_1'`, `h_2'`, ...,`h_n'`这样至少对于系列中的一对`i`and `j` `h_i != h_j'`。

所以我们可以有重复`h`的值来得到最终的总和。

再次，因为每个`h`值都是由一些整数（字符的代表值）的线性和产生的，因此`h`可以通过不同的线性和来获得一个特定的值，即不同的字符串。

乘数值可以调整。此外，即使乘数值是恒定的，即重复哈希生成器无法选择它，`h`也可以修改乘以乘数的值，以使相乘的键的总和保持不变。

因此，我们可以从许多字符串中生成一个哈希。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T16:18:36.187

在我看来，大多数用户会为每个项目选择相当小的数字（毕竟“2”比“438483”更容易记住）。

鉴于这种限制，蛮力可能实际上是合理的。

简单地为 5 个符号生成所有可能的输入值加上一个在 1..99 范围内的数字，计算结果哈希，并计算（例如使用字典）产生给定哈希的不同组合的数量应该给出经验了解最可能输入值的哈希分布。

从那里我将查看实际生成了多少不同的哈希值（如果哈希是 Int32，则在 2^32 个可能的哈希值中），并查找以特定频率生成的哈希值（具有高在字典中计数）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-12T16:37:53.220

将除最后一个系数之外的所有系数都设置为 1，因此您会得到形式为 An*xn = r (mod y) 的东西，然后使用扩展的欧几里得算法找到解决方案，请参阅[Wikipedia](http://en.wikipedia.org/wiki/Linear_congruence_theorem#Solving_a_linear_congruence)

# sql - 将 Visual FoxPro 存储过程转换为等效的 MS SQL Server 时出现问题

> ID：11000447
> 
> 赞同：0
> 
> 时间：2012-06-12T16:03:41.857
> 
> 标签：sql, visual-foxpro

我们在将 Visual FoxPro 迁移到 SQL Sever 时遇到了一些严重问题。

我对 FoxPro 了解不多。。任何完成此迁移的人都可以帮助我解决下面的问题

如何编写一个等效的 SQL 语句以`SET ENGINEBEHAVIOR 70 (SET ENGINEBEHAVIOR 80)`在 FoxPro 中找到.. 目的是什么`SET ENGINEBEHAVIOR`？我读到了一些地方，它列出了既不是聚合函数的一部分，也不是 group by 子句的所有字段。

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:21:48.093

我相信那是 FOXPro 中的兼容性声明......报告脚本是否包含该声明？如果您现在直接在 SQL 服务器上运行，则不需要它...我认为它主要用于 Foxpro 格式。

来自 MSDN 的完整信息在这里：http: [//msdn.microsoft.com/en-us/library/aa978316 (v=vs.71).asp](http://msdn.microsoft.com/en-us/library/aa978316(v=vs.71).asp)

编辑添加：实际上它似乎确实会影响分组行为。从链接：

您可以在 SELECT 列表中包含聚合函数，而无需在 GROUP BY 子句中包含它。例如，以下代码在字段 company 上使用 COUNT( ) 函数，但 GROUP BY 子句中没有字段 company。SELECT COUNT(company), country FROM Customer GROUP BY country

如果您要退出 FoxPro，我认为不再需要此声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T19:12:30.400

第十二是关于 SET ENGINE BEHAVIOR 如何运作的准确信息。请注意，并非所有 SQL 数据库都支持此功能，并要求您在执行 SQL 查询时输入所有非聚合列。

假设您在订单表中有 10 条客户记录，并且想要计算订单，但该表还有订单日期、总金额、送货地址等。该人将不同的订单交付到不同的位置。 .. 通过做

```
select customerID, count(*) as NumberOfOrders, DeliverAddress, TotalOrder
   from orders 
   group by CustomerID 
```

一些 SQL 引擎会唠叨您没有将“DeliverAddress”或“TotalOrder”作为 group by 的一部分。在 VFP 中，这些列将只返回为客户找到的第一条记录，而不管找到多少条记录。

我相信 MySQL 也支持这种不要求“非聚合”列的行为。

# ruby - Symbol#to_proc 使用 stabby lambda 语法的简写

> ID：11000450
> 
> 赞同：3
> 
> 时间：2012-06-12T16:03:47.707
> 
> 标签：ruby

非常简短的问题：是否可以使用 Symbol#to_proc 速记（例如`lambda(&:upcase)`在 Ruby 中使用 stabby lambda 语法？例如，我可以这样说：

```
p = lambda &:upcase 
```

进入`Proc`，`p`但我找不到使用`->`. 这：

```
p = -> &:upcase 
```

不工作，当然。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T16:17:03.547

显然，它不受支持。

我认为这与实际上[`proc`](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-proc)是[`lambda`](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-lambda)方法而不是关键字这一事实有关。它们支持我们通常关联的相同功能`each`以及模块中的其他方法[`Enumerable`](http://www.ruby-doc.org/core-1.9.3/Enumerable.html)。但是，[`->`](http://ruby.about.com/od/newinruby191/qt/LambdaOperator.htm)它是一种特殊的语言结构，它是单独解析的。

我想不出为什么这样的事情`-> &:method`是不可能的，但到目前为止，Ruby 语言的语法根本不允许这样做。

# vb.net - system.messaging 队列在 message.receive 时冻结

> ID：11000452
> 
> 赞同：0
> 
> 时间：2012-06-12T16:03:59.670
> 
> 标签：vb.net, message-queue, system.messaging

这是我第一次使用这个消息传递库并使用一些示例代码来实现它。我第一次运行它时它运行良好，但我突然停止了代码，因为我的解析方法似乎错误。因此，当我重新启动它时，代码冻结在以下行：

```
message = q.Receive() 
```

消息队列是否可能损坏或什么？我检查了服务器管理器，看起来队列仍然存在，消息数 =1 和以前一样。这是我的其余代码：

```
 If MessageQueue.Exists(".\private$\TwitterQueue") Then
        q = New MessageQueue(".\private$\TwitterQueue")
    Else
        'GS - If there is no queue then we're done here
        Console.WriteLine("Queue has not been created!")
       Return
 End If
 Try
    While True
            'GS - Try and pull back the next message
            Dim message As Message
            Try
                message = q.Receive()
                message.Formatter = New XmlMessageFormatter(New [String]() {"System.String"})
                 ProcessMessage(message)

             Catch

             end try
End While 
```

编辑：

如何创建队列：

```
 Dim q As MessageQueue = If((MessageQueue.Exists(".\private$\TwitterQueue")), New MessageQueue(".\private$\TwitterQueue"), MessageQueue.Create(".\private$\TwitterQueue")) 
```

以及如何使用：

```
Dim msg As New Message(responseData)
q.Send(msg) 
```

并检查它是否是事务性的；

```
If q.Transactional = True Then
                    Thread.Sleep(2000)
                End If 
```

事实并非如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-26T10:20:19.383

如果您尝试从代码后面创建队列，您可以尝试设置权限

```
If MessageQueue.Exists(".\private$\TwitterQueue") Then
        q = New MessageQueue(".\private$\TwitterQueue")
        q.SetPermissions("Everyone", MessageQueueAccessRights.FullControl, AccessControlEntryType.Allow)
    Else
        'GS - If there is no queue then we're done here
        Console.WriteLine("Queue has not been created!")
       Return
 End If 
```

如果仍然无法接收队列，我建议手动创建队列。

# testing - 通过使用 QuickCheck 生成输入来测试 Parsec 解析器

> ID：11000457
> 
> 赞同：9
> 
> 时间：2012-06-12T16:04:23.870
> 
> 标签：testing, haskell, parsec, quickcheck

我想为一套 Parsec 解析器编写测试。这是我想用 QuickCheck 测试的解析器的一个简单示例：

```
identifier = do
  c <- letter
  cs <- many (alphaNum <|> oneOf identSymbols)
  skipSpaces
  return $ Ident $ c:cs 
```

因此，理想情况下，我希望 QuickCheck 生成有效的标识符并确保我得到正确的结果，以及生成无效的标识符并确保它们返回`ParseError`. 是否有任何实用程序可以使这种事情变得更容易？有没有办法可以“反向运行我的解析器”来生成这样的输入？

一般而言，这个解析器的一套好的 QuickCheck 测试应该是什么样子的？在某种程度上，似乎我基本上必须在 QuickCheck 中复制解析器的逻辑才能实现彻底的测试。这真的是一个好主意，或者这可能是像 HUnit 这样更传统的工具比 QuickCheck 更适合的情况？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-12T16:12:13.170

通常，解析器的逆向是漂亮的打印机，而解析器的随机输入的逆向是 AST 的随机漂亮打印。

因此，请遵循[通常的方法](http://lstephen.wordpress.com/2007/07/29/parsec-parser-testing-with-quickcheck/)并为您的 AST 定义一个 Arbitrary 实例，该实例驱动随机的格式良好的语法片段。混入一些错误字符作为包装来测试错误处理。

也可以看看：

*   [使用 QuickCheck 自动测试 Java ABNF 语法分析器](https://gupea.ub.gu.se/bitstream/2077/4579/4/gupea_2077_4579_4.pdf)
*   [高阶函数的自动测试](https://web.archive.org/web/20061010040723/http://www.st.cs.ru.nl/papers/2006/koop2006-TestingOfHigherOrderFunctionsAPLAS.pdf)- Clean with QC 中的解析器测试。

# java - 何时使用多个 Spring Container 实例？

> ID：11000459
> 
> 赞同：3
> 
> 时间：2012-06-12T16:04:29.033
> 
> 标签：java, spring

我使用 ApplicationContext 作为 Spring 容器。

但是，由于我不想更改我的 API，我觉得需要使用容器的多个实例，如下所示 -

```
public static void main(String[] args)
 { 
    ApplicationContext context = new ClassPathXmlApplicationContext("spring.xml");

    ...
    objA = context.getBean(...);
    objB = context.getBean(...);
 }

// code for Class A

 public void execute() // <-- cannot change this signature 
 {
     ApplicationContext context = new ClassPathXmlApplicationContext("spring.xml");
     objC = context.getBean(...); // earlier, this was objC = new C();
     objC.method1("...");
 } 
```

所以我最终使用了两个不同的 ApplicationContext 实例。什么时候适合，什么时候不适合拥有多个 ApplicationContext 实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:21:57.667

对于大多数应用程序来说，应该不需要多个 ApplicationContexts。主要限制是您不能跨容器共享 bean 实例。从技术上讲，你没有理由不能将它们分成两个容器，但我相信你会想要共享一些常见的 bean，比如数据源和一个通用的业务层等。

查看您的示例，我建议您允许您的类 A 接受 SpringApplication 上下文作为构造函数（或者您可以使用 setter 方法）

```
public class A {

    private ApplicationContext ctx;

    public A(ApplicationContext applicationContext) {   
        ctx = applicationContext;
    }

    public void execute() {
        // do stuff with beans retrieved from "ctx"
    }
} 
```

您的 main() 将引导；上下文并将其传递给`A`

```
public class MyMain {

    public static void main(String[] args) {

        A a = new A(SpringContextFactory.getInstance());

        a.execute();        
    }
} 
```

作为一个额外的好设计，将您创建的上下文封装在工厂类中

```
public class SpringContextFactory {

    public static ApplicationContext getInstance() {

        String[] contextXml = new String[]{ "resources/spring-context.xml",
                                            "resources/spring-db.xml" };

        return new ClassPathXmlApplicationContext(contextXml);
    }
} 
```

我发现此设置适用于我的单元测试

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T18:13:33.527

对于我的测试，我创建了一个实用程序类并简单地使用了一个静态实例并创建了一个单例。

例如：

```
 public class Utilities {
private static ApplicationContext _applicationContext = null; 
private static void initApplicationContext() {
        if (_applicationContext == null) {
            _applicationContext = 
new ClassPathXmlApplicationContext("PersistenceHelper-context.xml");
        }
    }
} 
```

然后，只要您需要它，只需说：

```
Utilities.initApplicationContext(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T18:33:19.887

如果您可以控制类，请尝试实现 ApplicationContextAware： [http ://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/ApplicationContextAware.html](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/ApplicationContextAware.html)

这会将 applicationContext 注入到类中，让您可以自由地获取所需的任何类。

只要类`A`由spring初始化，这将起作用。从给出的代码来看，情况就是这样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T16:18:35.957

在您当前的代码中，您没有正确使用 Spring。这个想法是在 Spring 中连接您的依赖项，然后使用一个`ApplicationContext`来加载您的起始 bean（可能来自您的`main()`方法）。在多个地方多次加载相同的上下文以获取不同的 bean 并不理想。

据我所知，您的代码`ClassA`应该尝试将(或)`@Autowired`的实例添加到其成员。您想要这样做是因为它已经是 Spring 定义的 bean！根据为您的bean 提供给 Spring 的范围，您应该直接注入 bean（对于范围）：`ClassC``ObjectC``ClassA``ClassC``singleton`

```
@Autowired
private ClassC objC; 
```

或者您应该注入一个工厂来创建 bean 的实例（对于`prototype`范围）：

```
@Autowired
private ClassCFactory objCFactory; 
```

如果您进行此更改，则无需`ApplicationContext`多次加载。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-18T08:49:29.660

不需要有多个应用程序上下文。在许多情况下，我们需要一个共享的应用程序上下文。

为了避免在应用程序中创建多个应用程序上下文，请执行以下操作。

当 applicationcontextprovider bean 被创建时，spring 框架会将 ApplicationContext 注入到 setApplicationContext 中。

现在我们有了一个静态实用程序方法 getApplicationContext，它会在需要时返回应用程序上下文。

每当您需要应用程序上下文时，您只需说：ApplicationContextProvider.getApplicationContext(); ，这将返回共享的应用程序上下文。

/* 应用上下文提供者类 */

```
public class ApplicationContextProvider implements ApplicationContextAware {

    private static Logger logger = Logger.getLogger(ApplicationContextProvider.class);

    private static ApplicationContext ctx;

    @Override
    public void setApplicationContext(ApplicationContext arg0)
            throws BeansException {
        if (arg0 != null) {
            ctx=arg0;
        }
    }

    public synchronized static ApplicationContext getApplicationContext(){
        if (ctx==null) {
            logger.info("Getting the context again as it is null");
            ctx = new ClassPathXmlApplicationContext("Spring-All-Module.xml");
        }
        return ctx;
    }

} 
```

弹簧 XML：

```
<bean id="applicationContextProvider" class="dell.harmony.service.ApplicationContextProvider"></bean> 
```

从您的主程序类：

```
try {
            logger.info("Spring Application Context !!");
            ApplicationContext context = new ClassPathXmlApplicationContext(
                    "/Spring-All-Module.xml");
            logger.info("Spring Application Context - End !!");
        } catch (Exception e) {
                    logger.error("Exception in getting the Spring Application Context !!");
                     /* log the exception */
        } 
```

每当您需要上下文时，您只需说：//获取应用程序上下文

ApplicationContext 上下文 = ApplicationContextProvider.getApplicationContext();
dl = (SingleDataLoader) context.getBean("singledataloaderdao");

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-06-12T16:11:14.867

尝试使用`context`并`application context`在 main 方法中放入您的 PROGRAM CONTEXT，在其他方法中您必须获取，在您的情况下使用某个 Context 类中的静态方法，这不是一个好方法，但您不能更改 API

# javascript - Xpages 的文件选择器

> ID：11000469
> 
> 赞同：0
> 
> 时间：2012-06-12T16:05:28.300
> 
> 标签：javascript, xpages

对于我的 Xpages 应用程序，我需要一个文件选择器（只需选择一个文件名，无需上传或下载）。我已经环顾了几个小时，但没有找到解决方案。也许它太简单了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:48:57.340

为什么不使用`<input type="file" id="morituri" />`. 不能*设置*文件名，但可以读取。添加一个 presubmit 侦听器，该侦听器获取名称并从 DOM 中删除输入，因此不会被提交。

# reporting-services - 向报告 URL 添加参数：参数缺少值

> ID：11000476
> 
> 赞同：3
> 
> 时间：2012-06-12T16:06:11.263
> 
> 标签：reporting-services

我正在尝试在 SharePoint 的 Web 部件中插入 SSRS 报告。该报告是一个 TFS Sprint Burndown 图表。为此，我需要使用以下 URL 生成报告：

```
http://vhacpadev04/ReportServer/Pages/ReportViewer.aspx?/TfsReports/VAPARS+Team/Sprint+Burndown&rs:Command=Render&rs:Format=HTML4.0&rc:Parameters=true&rp:SprintParam=Release+2%5CSprint+1 
```

TFS 中的项目名称是*VAPARS Team*。我尝试运行此图表的 sprint 是*Release 2 Sprint 1*。

通常，ReportViewer 会提示我输入此参数。在这种情况下，SprintParam：

![在此处输入图像描述](../Images/d1687f0bbe8e66c36de64c213c595a96.png)

但是，当我隐藏它时（使用 &rc:Parameters=false），我得到以下错误：

![缺少参数值消息](../Images/808b6bfb81cb0c45d91964e8e22f6dc6.png)

以下是这份关于 SSRS 的报告的参数属性：

![参数列表](../Images/783f6e2f92f73d1b43130d4a6c6d5cfc.png)

我不确定如何格式化 URL 以传递正确的 sprint 参数。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T12:25:06.280

您需要为 SprintParam 提供一个默认值（即使您在 URL 中覆盖该默认值），或者如果该参数用于级联参数，则需要删除对参数的依赖。报告认为如果没有此信息，它就无法运行，即使您在 URL 中提供了它。StartDateParam 和 EndDateParam 是基于查询的，所以我猜它们依赖于 SprintParam。这就是导致显示错误并且您的 URL 参数被忽略的原因。

# java - IceFaces 将它的 CSS 和 JavaScript 资源放在每个页面上，无论它们是否使用 Ice 组件。有没有办法阻止这个？

> ID：11000480
> 
> 赞同：2
> 
> 时间：2012-06-12T16:06:44.743
> 
> 标签：java, jakarta-ee, jsf-2, facelets, icefaces

看起来仅仅在你的类路径上有 IceFaces 会严重影响你的 JSF 应用程序的页面加载时间。

即使没有冰，也会发生几件事：您的页面上使用了组件

*   王牌**-jquery.js 312kb**
*   王牌数据**表.js.xhtml 182kb**
*   **主题.css** 22kb
***   冰推**-js 84kb***   兼容.js **16kb***   icefaces-compat-js **289kb***   总计：0.88MB**

 **此外，每 15 秒向服务器轮询一次 IcePush 侦听器的请求。

除了从您的应用程序中删除罐子外，似乎没有办法在 IceFaces 中关闭这些。我们正在尝试迁移到 PrimeFaces，但该应用程序太大，我们每次只能迁移几个页面。

理想的答案是，如果有人知道关闭事物的方法。下一个最佳答案是一种以某种方式围绕资源处理程序实现包装器的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T15:15:35.780

由于没有人找到更好的答案，我将发布我知道的唯一答案，希望其他人可能会发现此信息有用。

最终起作用的是从类路径中删除以下 jar：

1.  icefaces 兼容
2.  冰推
3.  冰面王牌

我建议远离 IceFaces。相反，将 PrimeFaces 与 OmniFaces 资源组合器一起使用。您可以获得一些紧凑的页面和闪电般的快速页面加载时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T18:10:35.233

尝试`<icecore:config render="false"/>`或

`<context-param> <param-name>org.icefaces.render.auto</param-name> <param-value>false</param-value> </context-param>`

[http://wiki.icesoft.org/display/ICE/config](http://wiki.icesoft.org/display/ICE/config)

[http://wiki.icesoft.org/display/ICE/render.auto](http://wiki.icesoft.org/display/ICE/render.auto)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T07:58:24.047

尝试使用

> `<icecore:config mandatoryResource="none"/>`

就在您的**h:body**标签下方

并将其添加到您的命名空间组件声明中

**xmlns:icecore="http://www.icefaces.org/icefaces/core"**

访问：[wiki.icesoft.org/display/ICE/mandatoryResourceConfiguration](http://wiki.icesoft.org/display/ICE/mandatoryResourceConfiguration)**

# python - xterm python 子进程

> ID：11000484
> 
> 赞同：2
> 
> 时间：2012-06-12T16:06:52.933
> 
> 标签：python, python-2.6, xterm, subprocess

如果使用子进程在 linux 上执行一个 xterm，而后者又执行一些其他进程，那么 Python（2.6.5）似乎永远不会识别出该进程（xterm）已完成执行。

考虑以下代码：

```
import subprocess
import shlex
import time

proc = subprocess.Popen(shlex.split('xterm -iconic -title "FOO_BAR" -e sleep 5'))
while True:
    if proc.poll():
        print 'Process completed'
    time.sleep(0.1) 
```

这将无限循环，直到您终止 Python 解释器。我猜这可能是由 xterm 的一些奇怪引起的，而不是 Python 子进程模块的直接原因，但也许还有其他一些聪明的人可以对这种情况有所了解。

注意：调用`proc.communicate()`实际上会在 xterm 完成时返回，但由于某种原因 poll 方法不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:37:27.083

该程序不区分`proc.poll()`返回`None`（意味着进程仍在运行）和`proc.poll()`返回`0`（意味着进程以退出值零终止，通常表示成功完成）。更改此行：

```
if proc.poll(): 
```

对此：

```
if proc.poll() is not None: 
```

看看是否有帮助。

# android - android - 我应该使用 GLSurfaceView 而不是 Canvas 来避免 bitmapfactory oom 吗？

> ID：11000490
> 
> 赞同：0
> 
> 时间：2012-06-12T16:07:12.683
> 
> 标签：android, opengl-es, out-of-memory, bitmapfactory, glsurfaceview

我的应用需要加载建筑平面图，然后在平面图上绘制对象（家具）。平面图图像是 2500 x 1500 240Kb PNG，但由于需要 12+Mb 的堆来创建位图，因此需要 12+Mb 的堆来使大多数设备崩溃，给我一个 OutOfMemory 错误。让我在这里澄清一下：据我所知，这不是内存泄漏，而 bitmap.recycle() 什么也不做，因为它在第一次创建第一个图像时崩溃了。除非我使用使图像无法识别的样本大小，否则使用 inSampleSize 读取图像无济于事。这整个情况很疯狂。我在 Droid 3、HTC Inspire 和两个 2.3 模拟器上进行测试。HTC 将加载地图，模拟器（可笑）堆大小为 128Mb。这个应用程序的部署将在所有安卓用户中使用，所以我可以'

这是我当前的代码，它给了我一个无法使用的图像（来自另一个 SO 帖子，抱歉我丢失了链接）：

```
BitmapFactory.Options o=new BitmapFactory.Options();
        o.inJustDecodeBounds=true;
        BitmapFactory.decodeResource(getResources(), resourceId, o);

        //Find the correct scale value. It should be the power of 2.
        int scale=16;
        while((o.outWidth/scale)>=REQUIRED_SIZE || (o.outHeight/scale)>=REQUIRED_SIZE)
            scale*=2;

        BitmapFactory.Options options=new BitmapFactory.Options();
        options.inSampleSize = scale;

        Bitmap base_image;
        try {
            base_image = BitmapFactory.decodeResource(getResources(), resourceId);
        } catch (Error e1) {
            base_image = BitmapFactory.decodeResource(getResources(), resourceId, options);
        } 
```

GLSurfaceView 会在这里解决我的问题吗？我需要它来 1) 加载平面图图像，2) 允许我以编程方式绘制对象和文本标签，以及 3) 支持缩放并根据平面图坐标对触摸做出反应。如果这是答案，任何人都可以为这样的基本 2D 工作推荐一个好的教程吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:58:13.433

有很多方法可以减少位图的内存使用，如果您选择使用 openGL，您可以使用可以直接发送到视频内存的预压缩纹理。如果我没记错的话，Android 本身就支持 ETC1 纹理，ETC 会减小 25% 的大小。但是，由于您没有任何 openGL 经验，并且还需要执行稍微复杂一些的操作，例如绘制文本，这可能不是您的最佳操作（尽管通过此方法您可能会在旧设备上获得最佳性能） . 您可以考虑使用那里的任何引擎（AndEngine 或 Box2d 很流行）。

对您来说更快且可能更好的选择可能是创建平面图的矢量表示（例如`SVG`文件）（如果您有由背景颜色和墙壁线条组成的简单计划，这应该是可能的）。然后，如果您想要更高级的图像，请使用[`Path`](http://developer.android.com/reference/android/graphics/Path.html)类或外部库进行绘制。

# ipad - 如何在用户操作时将浏览器置于前台

> ID：11000491
> 
> 赞同：1
> 
> 时间：2012-06-12T16:07:14.837
> 
> 标签：ipad, html

我创建了一个 html5 应用程序，我在其中打开一个 pdf，打开 PDF 后我的应用程序进入后台。有没有办法让它回到前台？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:15:51.447

不幸的是，无法控制 javascript：

*   打开应用程序（你不能在后台强制它们）
*   浏览器本身（你不能在前台强制它）

你能做的最好的就是找到一个完整的 javascript pdf 阅读器并用它来打开你的 pdf，让你控制它。我什至不知道这样的事情是否存在，但如果你有时间，这绝对是一件可能的事情:-)

问候。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:16:56.017

您可以`[**pdf.js**](http://mozilla.github.com/pdf.js/)`在同一页面上使用和嵌入 pdf 文件。然后，您可以使用`z-index` **css 属性**将任何元素带到前面。具有较大堆栈顺序的元素始终位于具有较低堆栈顺序的元素之前。

在您的用户操作事件处理程序上，您可以执行以下操作：

```
myElement.style.zIndex = 1000; // DOM Scripting Example (Single Element)

// or

$('#myElement').css('z-index', 1000); // jQuery Example (All elements with the "myElement" id) 
```

`**myElement**`表示您希望带到顶部的元素。

# android - 谷歌地图：我无法使用 MapView

> ID：11000496
> 
> 赞同：1
> 
> 时间：2012-06-12T16:07:33.590
> 
> 标签：android, google-maps, android-mapview

这由于某种原因对 xml 是不可见的，并且应用程序崩溃了。我应该怎么做才能解决它？

**清单.xml**

```
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:id="@+id/map_holder"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent">

   <com.google.android.maps.MapView -----> do not recognize this
      xmlns:android="http://schemas.android.com/apk/res/android"
      android:id="@+id/map"
      android:layout_width="fill_parent"
      android:layout_height="fill_parent"
      android:apiKey="my_key"
   />
</LinearLayout> 
```

这是我得到的例外！

> 致命例外：主要

```
java.lang.IllegalAccessError: Class ref in pre-verified class resolved to unexpected implementation
at dalvik.system.DexFile.defineClass(Native Method)
at dalvik.system.DexFile.loadClassBinaryName(DexFile.java:207)
at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:200)
at java.lang.ClassLoader.loadClass(ClassLoader.java:551)
at java.lang.ClassLoader.loadClass(ClassLoader.java:511)
at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1565)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
at android.app.ActivityThread.access$1500(ActivityThread.java:117)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:130)
at android.app.ActivityThread.main(ActivityThread.java:3691)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:507)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:907)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:665)
at dalvik.system.NativeStart.main(Native Method) 
```

我如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:17:52.797

使用的正确类是：

```
com.google.android.maps.MapView 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T18:38:18.400

您是否已`<uses-library android:name="com.google.android.maps"/>`在`AndroidManifest`文件中添加并使用**Google API Android SDK**构建项目并`<uses-permission android:name="android.permission.INTERNET"/>`在您的 AndroidManifest 中添加互联网权限。

# java - 如何配置 Tomcat 以使用 Java 7

> ID：11000497
> 
> 赞同：20
> 
> 时间：2012-06-12T16:07:36.880
> 
> 标签：java, tomcat, java-7

我有一个**Java 6 字节代码**的 Web 应用程序，想在 Java 7 JVM 环境中测试它。为此，我想将 Tomcat（用于运行 Web 应用程序）配置为使用**Java 7**。现在我的问题是如何做到这一点？

我是否只是将我的**JAVA_HOME**环境变量设置为安装 Java 7 的路径，以便在正确的 JVM（版本 7）中运行 tomcat？还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-01T17:31:10.653

如果您使用的是 Windows，这会有所帮助。运行 Tomcat 助手应用程序 (tomcatw.exe) 并在 Java 选项卡下简单地配置 Java 虚拟机 DLL 路径。必须取消选中使用默认值。

![在此处输入图像描述](../Images/2734e0d297fae69cc2297605c32b4f80.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T16:11:20.513

你是在自问自答。！:) 您需要做的就是在您的`JAVA_HOME`.!中链接 java 7。

更多信息[在这里](https://stackoverflow.com/a/4072272/876142)

**编辑：（**基于[alfabravo](https://stackoverflow.com/users/236345/alfabravo)的评论：

您绝对可以`JAVA_HOME`在 catalina.bat/sh 中更改指针

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-06T00:08:09.970

在 Eclipse 中，很容易将 Tomcat 指向一个新的 JVM（在这个例子中是 JDK7）。我的问题是我找不到在哪里做。这是诀窍：

1.  在 ECLIPSE 顶部菜单**FILE**下拉选项卡上，选择**NEW** , --> **Other**
2.  ...在*新服务器上：选择向导*窗口，选择：**服务器**->**服务器**...单击**下一步**
3.  . 在*New Server：Define a New Server*窗口中，选择**Apache>Tomcat 7 Server**
4.  ..现在单击标题为“***配置运行时环境”并带有下划线的蓝色行***
5.  在*服务器运行时环境*窗口中，
6.  ..选择**Apache**，展开它（单击左侧的箭头），选择**TOMCAT v7.0**，然后单击**EDIT**。
7.  您将看到一个名为***EDIT SERVER RUNTIME ENVIRONMENT: TOMCAT SERVER的窗口***
8.  在这个屏幕上有一个标记为**JREs**的下拉菜单。
9.  您应该会发现您的 JRE 像**JDK1.7.0**一样列出。如果不使用**Installed JRE**按钮。
10.  选择所需的 JRE。单击**完成**按钮。
11.  优雅退出，在*Server: Server Runtime Environments*窗口中，点击**OK**
12.  在*New Server 中：Define a new Server*窗口，点击**NEXT**
13.  在*新服务器：添加和删除*窗口中，选择应用程序并将它们安装在服务器上。
14.  在*新服务器：添加和删除*窗口中，单击**完成**

就这样。有趣的是，似乎只有步骤 7-10 很重要，它们将更改您之前定义为使用 TOMCAT v7.0 的所有服务器上使用的 JRE。剩下的步骤只是因为除了定义一个新服务器之外，我找不到任何其他进入屏幕的方法。有没有人知道更简单的方法？

助教，贾尔金

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-10-06T11:29:34.713

我已经通过安装它

```
sudo apt-get install tomcat7 
```

设置 JAVA_HOME 或 PATH 对我没有帮助。我必须在文件中添加条目- /etc/default/tomcat7

```
# Run Tomcat as this user ID. Not setting this or leaving it blank will use the
# default of tomcat7.
TOMCAT7_USER=tomcat7

# Run Tomcat as this group ID. Not setting this or leaving it blank will use
# the default of tomcat7.
TOMCAT7_GROUP=tomcat7

# The home directory of the Java development kit (JDK). You need at least
# JDK version 1.5\. If JAVA_HOME is not set, some common directories for 
# OpenJDK, the Sun JDK, and various J2SE 1.5 versions are tried.
#JAVA_HOME=/usr/lib/jvm/openjdk-6-jdk
JAVA_HOME=/usr/lib/jvm/java-8-oracle
... 
```

这是 Java 8，但你明白了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-12T16:12:21.573

转到 tomcat/bin 并修改 catalina.sh（适用于 linux/unix）或 catalina.bat（适用于 windows）中的 JAVA_HOME 参数。这意味着只有 tomcat jvm 会改变，而不是其他一切。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-12T16:14:32.757

Tomcat的主页指出

> Tomcat 需要安装 JDK（1.6 或更高版本）。Sun JDK 可以在这里下载。
> 
> 重要提示：将环境变量 JAVA_HOME 设置为安装 JDK 版本的目录的路径名。

所以基本上你是对的。仍然可能存在一些兼容性问题。我建议您阅读[这篇文章](http://www.tomcatexpert.com/blog/2011/08/25/apache-tomcat-8-and-java-7-will-they-work-together)，详细讨论 Tomcat 和 Java 7。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-24T20:43:33.730

只需打开现有的 tomcat 服务器并打开运行时环境并检查 JDK 版本并更改它 java 7 [JDK Config Changes](https://i.stack.imgur.com/tz6HO.png)

# php - php的有限实例

> ID：11000498
> 
> 赞同：1
> 
> 时间：2012-06-12T16:07:43.023
> 
> 标签：php

有没有办法启动有限版本的php？

我想要的是创建一个极其有限的 php 实例。可以在不损害服务器的情况下公开用于评估代码的东西。它应该只支持语言的基础知识，比如变量、循环、打印等等。我知道有一个设置允许阻止某些功能，但我只想允许少数语言结构并阻止 99% 的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:11:11.200

查看 PHP INI 指令[disable_functions](http://www.php.net/manual/en/ini.core.php#ini.disable-functions)和[disable_classes](http://www.php.net/manual/en/ini.core.php#ini.disable-classes)。

这种组合是一个良好的开端，并且通常被共享主机使用。

我不是系统管理员，我建议您改写这部分问题并将其放在[ServerFault](https://serverfault.com/)上。尽管如此，您也可以确保 PHP 在*沙箱*上（本身，有限的外部）。此外，一个可以轻松重新生成的实例。我在想亚马逊 EC2 之类的东西。

# linux - 在 Linux 中逐字段比较两个文件

> ID：11000500
> 
> 赞同：0
> 
> 时间：2012-06-12T16:07:46.723
> 
> 标签：linux, awk

我正在尝试使用 3 个字段（来自 file1 的字段 1、2、5 和来自 file2 的 1、2、5）比较两个文件（用逗号和空格分隔），如果这两个文件匹配我希望 file2 的整个记录​​与使用 awk 的 file1 的最后归档。例如文件1：

```
1, 4, abebe, kebede, 25, 101, 42
1, 4, abebe, debebe, 42, 201, 47
1, 4, abebech, kebede, 17, 33, 57 
```

文件2：

```
1, 4, abebe, kebede, 25, 101, 42
1, 4, Tesse, debo, 25, 101, 42
1, 4, derartu, tulu, 25, 101, 42 
```

输出：

```
42, 1, 4, abebe, kebede, 25, 101, 42
47, 1, 4, Tesse, debo, 25, 101, 42
57, 1, 4, derartu, tulu, 25, 101, 42 
```

我是 linux 新手.... 任何帮助都会得到帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:25:39.577

由于文件 1 中记录 1 的字段 1、2 和 5 与文件 2 中的*所有*记录匹配，因此我以相反的顺序将文件列为参数，以便获得所需的输出。

```
awk 'BEGIN {OFS = ", "} NR == FNR {a[$1, $2, $5] = $NF; next} $1 SUBSEP $2 SUBSEP $5 in a {print a[$1, $2, $5], $0}' file2 file1 
```

该`NR == FNR`块形成一个循环，将首先出现在参数列表中的文件读入一个数组。当记录号 ( `NR`) 和文件记录号 ( `FNR`) 不再相等时，继续处理被命名为第二个参数的文件。

在那里，检查数组以查看两个文件中的字段是否匹配。如果是，则输出相应的已保存字段和当前记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:17:07.560

我对这个问题的第一次阅读适用于这个解决方案：

```
awk '{getline t < "file2"; split( t, a );
    if( a[1]a[2]a[5] == $1$2$5) print $NF",", t}' file1 
```

但似乎问题实际上是：'鉴于`file1`我们知道任何记录中的字段 1、2 和 4 相同，最终字段也相同，找到`file2`对应字段 1、2 和4 并输出带有`file1`前置的最后一个字段的那一行。在这种情况下，丹尼斯给出的解决方案有效。

# jsf-2 - 在复合组件的属性中使用 EL

> ID：11000501
> 
> 赞同：2
> 
> 时间：2012-06-12T16:07:46.960
> 
> 标签：jsf-2, facelets, el, composite-component

我的 JSF 自定义组件代码：

```
<composite:interface name="translation">
    <composite:attribute name="fieldName"/>
  <composite:attribute name="required" default="true" />
</composite:interface>

<composite:implementation>
    <h:inputText required="#{cc.attrs.required}" requiredMessage="Please enter #{cc.attrs.fieldName} in english"/>
</composite:implementation> 
```

如果我按如下方式指定所需的属性，这将正常工作：

```
<comp:translation fieldName="myTranslation" required="true" /> 
```

但是如果我在我的复合组件的 required 属性中给出 EL 则不起作用：

```
<comp:translation fieldName="myTranslation" required="#{param['someButtonId'] != null}" /> 
```

我们可以在复合组件的属性中给出 EL 吗？如果是，那么我错过了什么？

# google-apps-script - 使用 UrlFetch 使用 Google Apps 脚本进行摘要式身份验证

> ID：11000502
> 
> 赞同：0
> 
> 时间：2012-06-12T16:07:54.430
> 
> 标签：google-apps-script, digest-authentication

我正在尝试使用 Google Apps 脚本的 UrlFetch 访问受 Digest Authentication 保护的 URL。

我设法使用基本身份验证访问 URL：

```
 var options =
{
  "method" : "get",
  "headers" : {
    "Authorization" : "Basic <Base64 of user:password>"  
  },
};

var response = UrlFetchApp.fetch("http://www.example.com/service/using/basic", options); 
```

我设法根据文档中的[示例使用 OAuth 进行访问。](https://developers.google.com/apps-script/class_urlfetchapp)

现在的问题是我需要与正在实施 Digest 的站点具有相同的功能。我可以使用以下 curl 访问它：

```
curl -v --digest --user user:password http://www.example.com/service/using/digest 
```

**更新**

如果我尝试简单地打电话

```
var options =
{
  "method" : "get",
  "headers" : {
    "Authorization" : "Digest " + Utilities.base64Encode( Utilities.computeDigest(user:password) )
  },
}; 
```

由于 Digest Authentication 的 Challenge-Response 机制，它不起作用。

我可以使用任何实现此类功能的 JavaScript 库来使用 UrlFetch 吗？还是直接通过 UrlFetch 本身？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T02:57:40.310

HTTP Digest 授权比您目前所拥有的要复杂一些。查看[wiki 页面](http://en.wikipedia.org/wiki/Digest_access_authentication)或查看此[示例 Python 实现](http://code.activestate.com/recipes/302378-digest-authentication/)以获取更多信息。

使用 Henrique 提到的 Utilities 方法，应该可以使用 Apps 脚本实现摘要身份验证。至于处理算法的挑战/响应部分，您可以使用尚未记录的 UrlFetchApp 选项`muteHttpExceptions`，如此处[所示](http://code.google.com/p/google-apps-script-issues/issues/detail?id=1202#c2)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T17:55:17.393

有内置的[Utilities.computeDigest](https://developers.google.com/apps-script/class_utilities#computeDigest)和[base64Encode](https://developers.google.com/apps-script/class_utilities.html#base64Encode)。这可能是您正在寻找的。

# asp.net-mvc-3 - 无法加载文件或程序集'System.Web.WebPages.Razor，版本 = 2.0.0.0

> ID：11000506
> 
> 赞同：63
> 
> 时间：2012-06-12T16:08:09.613
> 
> 标签：asp.net-mvc-3, razor, dependencies, asp.net-4.0

我刚刚升级了 MVC 3 项目 (ASP.net 4) 中的包，现在在访问该项目中的页面时收到以下错误消息：

> ## “/MyApplication”应用程序中的服务器错误。
> 
> 无法加载文件或程序集“System.Web.WebPages.Razor，Version=2.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040） 说明：在执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.IO.FileLoadException：无法加载文件或程序集“System.Web.WebPages.Razor，Version=2.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 程序集加载跟踪：以下信息有助于确定为什么无法加载程序集“System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35”。
> 
> === 预绑定状态信息 === LOG: User = IIS APPPOOL\ASP.NET v4.0 LOG: DisplayName = System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 (完全指定）日志：Appbase = file:///C:/.../ 日志：初始 PrivatePath = C:...\bin 调用程序集：Microsoft.Web.Helpers，版本=2.0.0.0，文化=中性, PublicKeyToken=31bf3856ad364e35。=== LOG：此绑定在默认加载上下文中开始。LOG：使用应用程序配置文件：C:...\web.config LOG：使用主机配置文件：C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet.config LOG：使用来自 C 的机器配置文件： \Windows\Microsoft.NET\Framework64\v4.0.30319\config\machine.config。日志：政策后参考：System.Web.WebPages.Razor，版本=2.0.0.0，文化=中性，PublicKeyToken=31bf3856ad364e35 日志：正在尝试下载新的 URL 文件：///C:/Windows/Microsoft.NET/Framework64/v4.0.30319/Temporary ASP.NET Files/.../cb62a7b2/327a0353/System.Web.WebPages.Razor.DLL。日志：尝试下载新 URL 文件：///C:/Windows/Microsoft.NET/Framework64/v4.0.30319/Temporary ASP.NET Files/.../cb62a7b2/327a0353/System.Web.WebPages.Razor/System .Web.WebPages.Razor.DLL。日志：正在尝试下载新的 URL 文件：///C:/LeGroupeHtmSVN/.../UpDir.Web/bin/System.Web.WebPages.Razor.DLL。警告：比较程序集名称导致不匹配：主要版本错误：无法完成程序集设置（hr = 0x80131040）。探测终止。///C:/Windows/Microsoft.NET/Framework64/v4.0.30319/Temporary ASP.NET Files/.../cb62a7b2/327a0353/System.Web.WebPages.Razor/System.Web.WebPages.Razor.DLL。日志：正在尝试下载新的 URL 文件：///C:/LeGroupeHtmSVN/.../UpDir.Web/bin/System.Web.WebPages.Razor.DLL。警告：比较程序集名称导致不匹配：主要版本错误：无法完成程序集设置（hr = 0x80131040）。探测终止。///C:/Windows/Microsoft.NET/Framework64/v4.0.30319/Temporary ASP.NET Files/.../cb62a7b2/327a0353/System.Web.WebPages.Razor/System.Web.WebPages.Razor.DLL。日志：正在尝试下载新的 URL 文件：///C:/LeGroupeHtmSVN/.../UpDir.Web/bin/System.Web.WebPages.Razor.DLL。警告：比较程序集名称导致不匹配：主要版本错误：无法完成程序集设置（hr = 0x80131040）。探测终止。
> 
> 堆栈跟踪：
> 
> [FileLoadException：无法加载文件或程序集“System.Web.WebPages.Razor，版本=2.0.0.0，文化=中性，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（HRESULT 异常：0x80131040）]
> Microsoft.Web.Helpers.PreApplicationStartCode.Start() +0
> 
> [InvalidOperationException：Microsoft.Web.Helpers.PreApplicationStartCode 类型的预应用程序启动初始化方法 Start 引发异常，并显示以下错误消息：无法加载文件或程序集 'System.Web.WebPages.Razor，版本 = 2.0.0.0， Culture=neutral, PublicKeyToken=31bf3856ad364e35' 或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（HRESULT 异常：0x80131040）。]
> System.Web.Compilation.BuildManager.InvokePreStartInitMethods（ICollection`1 方法）+11711966
> System.Web.Compilation.BuildManager.CallPreStartInitMethods() +465
> System.Web.Hosting.HostingEnvironment.Initialize（ApplicationManager appManager，IApplicationHost appHost，IConfigMapPathFactory configMapPathFactory，HostingEnvironmentParameters hostingParameters，PolicyLevel policyLevel，异常 appDomainCreationException）+1167
> 
> [HttpException (0x80004005): 类型 Microsoft.Web.Helpers.PreApplicationStartCode 上的预应用程序启动初始化方法 Start 引发异常并显示以下错误消息：无法加载文件或程序集 'System.Web.WebPages.Razor，版本 = 2.0 .0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35' 或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（HRESULT 异常：0x80131040）。]
> System.Web.HttpRuntime.FirstRequestInit（HttpContext context）+11700896 System.Web.HttpRuntime.EnsureFirstRequestInit（HttpContext context）+141 System.Web.HttpRuntime.ProcessRequestNotificationPrivate（IIS7WorkerRequest wr，HttpContext context）+ 4869125
> 
> -------------------------------------------------- ------------------ 版本信息：Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.272

在我的 web.config 文件和我的应用程序中，我引用 System.Web.WebPages.Razor v1.0.0.0：

> ```
>  <dependentAssembly>
>     <assemblyIdentity name="System.Web.WebPages.Razor" publicKeyToken="31bf3856ad364e35" culture="neutral" />
>     <bindingRedirect oldVersion="0.0.0.0-1.0.0.0" newVersion="1.0.0.0" />
>   </dependentAssembly> 
> ```

我什至不知道我是否可以将 System.Web.WebPages.Razor v2.0.0.0 与 .Net 4 一起使用。

现在，我如何找出引用 System.Web.WebPages.Razor v2.0.0.0 的内容？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2015-06-10T11:06:04.233

很简单。在 Nuget 包管理器控制台中：

更新包 Microsoft.AspNet.Mvc -重新安装

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2012-12-18T01:20:56.373

当我执行“删除未使用的引用”时，这个问题就开始了。该网站仍然可以在我的本地计算机上运行，​​但发布后无法在服务器上运行。

![删除未使用的引用](../Images/8d6eb8d61e232627dba1092024c53219.png)

我通过执行以下操作解决了这个问题，

1.  在 Visual Studio 中打开“包管理器控制台”
2.  卸载包 Microsoft.AspNet.Mvc
3.  安装包 Microsoft.AspNet.Mvc

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2012-06-12T16:12:01.217

> 如何找出引用 System.Web.WebPages.Razor v2.0.0.0 的内容？

只需阅读您的异常堆栈跟踪：

```
Calling assembly : Microsoft.Web.Helpers, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35 
```

因此，您似乎正在使用`Microsoft.Web.Helpers`which 反过来取决于`System.Web.WebPages.Razor, Version=2.0.0.0`.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-10-15T21:09:07.383

在经历了很多痛苦、谷歌搜索和头发拉扯之后，我最终使用 nuget 卸载了 MVC 4，从 Web 配置中删除了对 MVC、剃刀和基础设施的所有引用，从 bin 文件夹中删除了 dll - 然后使用 nuget 重新安装所有内容。尝试找出 dll 不匹配的原因所需的时间更少。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-03-16T16:31:22.593

在 ASP.NET MVC 4 中，命名空间不是 System.Web.WebPages.Razor，而是 System.Web.Razor

这对我有用，更改您的 web.config。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-03-07T22:30:28.323

我使用 Windows 控制面板卸载了 ASP.NET MVC 4，然后通过运行重新安装它`AspNetMVC4Setup.exe`（我从[https://www.microsoft.com/en-us/download/details.aspx?id=30683](https://www.microsoft.com/en-us/download/details.aspx?id=30683)获得），然后为我解决了这个问题。

换句话说，我不需要使用 Nuget 或 Visual Studio。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-03-23T18:21:39.433

在添加了对`System.Web.Mvc`. 我删除了所有我能找到的参考资料，但似乎没有任何效果。我终于删除了项目的`bin`文件夹，重建后错误消失了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-05-26T15:52:40.483

我也收到了这个错误，并尝试了我可以在网上找到的所有东西，但它不会消失。最后，我只是将 MVC 从 5.2.3 降级到 4.0.40804。我不喜欢这个解决方案，因为最终我需要使用 MVC 5，但它现在可以工作。希望这对其他人有帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-08-11T14:35:26.237

简短：
如果您在纯 Web API 项目中遇到此问题（因此不需要剃刀），请尝试添加它，重建，然后删除它。

长话短说：
我在一个全新的纯 Web API 项目中遇到了这个问题，除了堆栈跟踪将“System.Web.Mvc”指向调用程序集（参见达林的回答）。虽然在我的项目中没有引用 MVC、Razor 或类似的东西......
我决定添加 MVC 包（AspNet.Mvc、AspNet.WebPages 和 AspNet.Razor）来检查是否有任何后续问题。
WebApi 应用程序随后完美启动。然后我删除了完全相同的包，一切都还可以。

希望它可以帮助某人。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-05-25T08:07:43.450

当我将 MVC4 升级到 MVC5 版本时，我遇到了同样的错误，首先我升级了依赖于的调用程序集

```
> System.Web.WebPages.Razor, Version=2.0.0.0 
```

之后更新了 Views 文件夹下的 web.config 文件，更新了以下包

```
<configSections>
    <sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
      <section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
    </sectionGroup>
</configSections> 
```

到

```
<configSections>
    <sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
      <section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
      <section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
    </sectionGroup>
 </configSections> 
```

并且也更新了

```
<host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
```

到

```
<host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=5.2.7.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" /> 
```

这些步骤对我有用

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-01-14T11:21:02.443

在我的电脑完全重新安装后，我收到了此处描述的错误。VS 2017 已重新安装，但未重新安装“ASP.NET Web Pages 2”。重新安装“ASP.NET Web Pages 2”后，问题解决了。

另请参阅：[无法加载文件或程序集 System.Web.WebPages.Razor, , Version=3.0.0.0 或其依赖项之一](https://stackoverflow.com/questions/21108375/could-not-load-file-or-assembly-system-web-webpages-razor-version-3-0-0-0-or)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-07-24T02:13:47.913

在某些情况下，只需安装网页 2 即可解决此问题（我的案例已解决 - 使用 web api 部署到本地网页）

[https://www.microsoft.com/en-us/download/details.aspx?id=34600](https://www.microsoft.com/en-us/download/details.aspx?id=34600)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-10-25T12:41:21.040

如果早期的工作项目突然因提到的错误而崩溃，您可以尝试以下解决方案。

*   删除相应 web/service 项目的 bin 文件夹。
*   建造

这对我有用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-03-16T08:28:23.737

对于类似的程序集绑定错误，以下步骤可能会有所帮助：

1.  右键单击您的解决方案，然后单击**管理解决方案的 Nuget 包...**
2.  转到合并选项卡（最后一个选项卡）并检查安装在解决方案内不同项目中的包之间是否有任何差异。特别注意您引用的项目，这些项目可能具有较低的版本，因为它们通常不太引起注意）
3.  **合并**与您的装配错误相关的特殊包，并注意许多包依赖于其他一些包，如 *.code & *.api & ...
4.  解决所有可疑的合并后，重建并重新运行应用程序并查看程序集绑定是否已解决。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-05-02T03:32:23.997

我首先尝试[了 Mohammed Emad 的回答](https://stackoverflow.com/a/30754488/1294318)——不高兴。然后我尝试了

```
git clean -x -d -f 
```

[这给我带来了一个新的“Roslyn”错误，我可以通过手动编辑我的 .csproj](https://stackoverflow.com/a/32780433/1294318)来修复它。

有趣的是，在我进一步阅读了关于 Roslyn 问题的页面后，我发现[了另一个](https://stackoverflow.com/a/34391473/1294318)投票数更高的建议（`Update-Package Microsoft.CodeDom.Providers.DotNetCompilerPlatform -r`）。考虑到我宁愿实现它而不是手动编辑 .csproj，我取消了我的 .csproj 更改，只是发现我的解决方案仍然有效。

所以毕竟，我想知道穆罕默德的回答（在这个页面上）是否会成功，如果我只是先完成了 git clean 。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-02-06T23:51:08.303

通过安装 AspNetMVC4Setup.exe（这里是链接：[https](https://www.microsoft.com/en-us/download/details.aspx?id=30683) ://www.microsoft.com/en-us/download/details.aspx?id=30683 ）解决了这个问题。

通过重新启动/重新安装 Microsoft.AspNet.Mvc 包对我没有帮助。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-08-30T08:39:15.757

我通过 NuGet 降级到 MVC 4，然后再次升级到 5.2.7，它解决了这个问题

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-02-10T09:53:15.490

**解决您的问题**

删除项目参考中的 WebMatrix.Data 和 WebMatrix.WebData

# c# - 序列化/反序列化 DataContracts 列表

> ID：11000507
> 
> 赞同：0
> 
> 时间：2012-06-12T16:08:11.873
> 
> 标签：c#, serialization, datacontractserializer, datacontract

无论如何要序列化数据合同列表吗？我为列表创建了一个数据合同，如下所示：

```
[DataContract]
class ItemList<T>
{
    public ItemList()
    {
       items=new List<T>();
    }

    [DataMember]
    public List<T> items;    
} 
```

我有 3 个类 Config、Config_V1、Config_V2，其属性为 [Name="Config"]，这让我可以在 Config 类的 3 个版本之间使用版本控制。所以我想在这个 Config 类的 ItemList 之间进行序列化和反序列化。我试过类似的东西：

```
ItemList<ConfigData_V1> l = new ItemList<ConfigData_V1>();
l.items.Add(config);
WriteObject<ItemList<ConfigData_V1>>("serialization.bin", l);
ItemList<ConfigData_V2> l2;
l2=ReadObject<ItemList<ConfigData_V2>>("serialization.bin"); 
```

但是在使用 ReadObj 反序列化时出现错误，表明它需要一个 ConfigData_V2 的列表，但它找到了一个 ConfigData_V1 的列表。难道它不只是使用 ConfigData 类的版本来解决这个冲突吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:22:42.003

当您反序列化一个对象 ( `List<Contract1>`) 时，它会添加元数据以指定 a-数据是 List 的一部分，而 b-包含对象是`Contract1`.

如果您查看实际编写的 XML，您将在节点中看到这一点。

结果，当您尝试读取时，`List<Contract2>`您会破坏模型的定义，因为您告诉它包含的数据是`Contract1`但您尝试读取`Contract2`.

如果您声明 Contract2 是一种已知类型，但它确实打破了合同的整个概念，那么有一个属性`[KnownType(Type)]`可能会对您有所帮助......`Contract1`

# actionscript-3 - AS3 FTP Socket 在 3G 网络上失败

> ID：11000509
> 
> 赞同：2
> 
> 时间：2012-06-12T16:08:19.453
> 
> 标签：actionscript-3, sockets, air, ftp, 3g

我有一个 AS3 脚本，它连接到 FTP 服务器并检索文件/文件夹列表。当设备通过 WIFI 或 LAN 连接到互联网时脚本运行良好，但通过手机 3G 连接时无法登录

这是我的代码：

```
import flash.events.ProgressEvent;
import flash.events.Event;
import flash.net.Socket;
import flash.events.IOErrorEvent;
import flash.errors.IOError;
//
var ftp_host:String="ftp.server.com";
var ftp_port:Number=21//or your ftp port;
var ftp_username:String="username";
var ftp_password:String="password";
var ftp_path:String="/";
var s,r;
var listOfFiles:Array;
//

readFromFTP()

function readFromFTP(e=null){
    s = new Socket(ftp_host,ftp_port);
    r = new Socket();
    listOfFiles=new Array();
    s.addEventListener(IOErrorEvent.IO_ERROR,onIOERR);
    s.addEventListener(ProgressEvent.SOCKET_DATA, onReturnData);
    s.addEventListener(SecurityErrorEvent.SECURITY_ERROR,onSecERR);
    r.addEventListener(ProgressEvent.SOCKET_DATA, onServData);
    r.addEventListener(Event.CONNECT, onPasvConn);
    r.addEventListener(IOErrorEvent.IO_ERROR,onIOERR);
    r.addEventListener(SecurityErrorEvent.SECURITY_ERROR,onSecERR);

    loaderInfo.uncaughtErrorEvents.addEventListener(UncaughtErrorEvent.UNCAUGHT_ERROR, handleGlobalErrors);
}

function onReturnData(evt:ProgressEvent)
{
    var d = s.readUTFBytes(s.bytesAvailable);
    trace(d);
    text_txt.appendText(d);
    if(d.indexOf("220 ")>-1){
       text_txt.appendText("Username sent\n");
       s.writeUTFBytes("USER "+ftp_username+"\n");
       s.flush()
    }
    if(d.indexOf("331 ")>-1){
        text_txt.appendText("Password sent\n");
       s.writeUTFBytes("PASS "+ftp_password+"\n");
       s.flush()
    }
    if (d.indexOf("230") > -1)
    {
        text_txt.appendText("PASV command sent\n");
        s.writeUTFBytes("PASV \n");
        s.flush();
    }
    var a = d.indexOf('227');
    if (a > -1)
    {
        var st = d.indexOf("(",a);
        var en = d.indexOf(")",a);
        var str;
        str = d.substring(st + 1,en);
        var a2 = str.split(",");
        var p1 = a2.pop();
        var p2 = a2.pop();
        var ip:String = a2.join(".");
        var port:int=(p2*256)+(p1*1);      
        r.connect(ip, port);
    }
    if(d.indexOf("226 ")>-1){
        text_txt.appendText("QUIT command sent\n");
        s.writeUTFBytes("QUIT \n");
        s.flush();
    }
    if(d.indexOf("221 ")>-1){
    }
}
function onPasvConn(evt:Event):void
{
    //trace("CONNECTED TO DATA PORT");
    text_txt.appendText("CONNECTED TO DATA PORT\n");
    s.writeUTFBytes("NLST "+ftp_path+"\n");
    s.flush();
}
function onServData(evt:ProgressEvent):void
{
    var d = r.readUTFBytes(r.bytesAvailable);
    trace(d);
    text_txt.appendText(d);
}
function onIOERR(evt:IOErrorEvent)
{
    trace(evt.errorID+":"+evt.text);
    text_txt.appendText(evt.errorID+":"+evt.text);
}

function onSecERR(evt){
    text_txt.appendText("Security error\n");
}

function handleGlobalErrors(evt){
    text_txt.appendText("Unhandeled Error\n");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-25T07:14:41.997

Finaly I fixed the bug.

For some reason the server didn't respond to command with (\n) linebreaks.

I changed it to (\r\n) and it's working fine now

I hope this helps someone

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T11:42:14.860

很多 3G 运营商会阻塞某些端口，这会导致它出现故障。

可以肯定的是，AS3 本身在 3G 上的行为并没有什么不同。

# ruby-on-rails - 提交 datetime_selects 数组

> ID：11000516
> 
> 赞同：1
> 
> 时间：2012-06-12T16:08:44.523
> 
> 标签：ruby-on-rails, ruby

在 Rails 3.2.5 中，我似乎无法弄清楚如何`datetime_select`在内部数组中收集许多结果`params`

例如，如果我有这个

```
<input type="text" name="poll[options][]">
<input type="text" name="poll[options][]"> 
```

然后 params 将包含所有字段`params[:poll][:options]`的数组。`options`

这是我的`datetime_select`：

```
datetime_select "scheduler", "options", {
  add_month_numbers: true, 
  start_year: Date.today.year, 
  default: DateTime.now + 1.day, 
  datetime_separator: "<span>at</span>", 
  time_separator: "<span>:</span>", 
  leading_zeros: true
} 
```

我想`datetime_select`在表格中重复很多次。

模型/字段参数似乎不允许进行任何类似`"scheduler[]"`或`"options[]"`收集结果数组的操作`datetime_select`。

我怎样才能做到这一点，以便许多日期时间对象出现在位于的数组中`params[:scheduler][:options]`？

## 更新

这是我目前如何破解它：

```
datetime_select_tags = datetime_select "scheduler_selects", "", add_month_numbers:true, start_year:Date.today.year, default:DateTime.now + 1.day, datetime_separator:"<span>at</span>", time_separator:"<span>:</span>", leading_zeros:true
datetime_select_tags.gsub! 'name="scheduler_selects', 'name="scheduler[options][]' 
```

这会产生像这样的标签

```
<select id="scheduler_selects__1i" name="scheduler[options][][(1i)]"> 
```

所以`params`正确地包含

```
"scheduler" => { 
  "options" => [
    {"(1i)"=>"2012", "(2i)"=>"6", "(3i)"=>"13", "(4i)"=>"15", "(5i)"=>"24"}, 
    {"(1i)"=>"2012", "(2i)"=>"6", "(3i)"=>"13", "(4i)"=>"15", "(5i)"=>"24"}
  ],
}, 
```

我可能会尝试将其包装在帮助程序中，以便生成唯一的 HTML id 属性。不过，真的希望这不是长期的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T18:05:40.150

通过反复试验，我发现这是可行的：

```
<%= form_tag :things do %>
<%= datetime_select("dates[a]", "b" ) %>
<%= datetime_select("dates[c]", "d" ) %>
<%= submit_tag 'save' %>
<% end %> 
```

这为您提供了类似`params[:dates]["a"]`和的哈希值`params[:dates]["b"]`。我无法让内部索引与符号一起使用，而且我不确定如何使那些 1i、2i、... 后缀消失。

# jquery - 如何在 jQuery UI 对话框中使用 .scrollTop()？

> ID：11000517
> 
> 赞同：1
> 
> 时间：2012-06-12T16:08:45.727
> 
> 标签：jquery, jquery-ui, dialog, scrolltop

**[问题](http://jsfiddle.net/TGsM5/17/)****链接**：

在 jQuery 对话框中使用`.scrollTop()`方法对我不起作用，HTML 标记是这样的：

```
<div id="toogleMAmaximized" style="background:#000000">
     <div id="missionsMinimized" style="display:none;margin-top:10px;margin-bottom: 10px;cursor:pointer"><img src="images/missionsMinimized.png" alt="missions"/></div>
     <div id="achivmentsMinimized" style="display:none;margin-top:5px;cursor:pointer">        <img src="images/achivmentsMinimized.png" /></div>
     <div id="missions" class="unselected MAmaximized"></div>
     <div id="achivments" class="unselected MAmaximized"></div>
     <div id="dataMA" style="position:absolute;top:10px;right:10px;display:none;width:850px;height:500px;background-image: url('images/background-home.png') ; overflow-y:scroll"></div>
</div> 
```

我使用 JavaScript 函数来填充`dataMA`div。

```
 function populateMissionsData(){    
             $('#missions').empty();
             $('#dataMA').append('<h1 style="color:white">Current Missions:</h1>');
             for (var $key in missionData['current']){
                 $('#dataMA').append(missionData['current'][$key]);
             }
             $('#dataMA').append('<h1 style="color:white">Not started missions:</h1>');
             for (var $key in missionData['other']){
                 $('#dataMA').append(missionData['other'][$key]);
             }
             $('#dataMA').append('<h1 style="color:white">Ccompleted Missions:</h1>');
             for (var $key in missionData['completed']){
                 $('#dataMA').append(missionData['completed'][$key]);
             }
        } 
```

这很好用，因为我可以毫无问题地填充我的 dataMA。现在我有一个按钮，可以扩展 dataMA 中使用`livequery`插件的 div 的内容，这是滚动问题：

```
 $(".plus").livequery('click',(function(){
              key = $(this).attr('key').toString();           
              $('#data'+ key).slideToggle('fast');

              //this is the problem, it does not scroll the dialog.
              $('#dataMA').scrollTop($('#data'+ key).offset().top);
              //Update - this does not work either
              $('#dataMA').scrollTop($('#dataMA')[0].scrollHeight);                        
              //Update 100 - This is not working either
              $('#dataMA').scrollTop($('#data'+ key).offset().top - $('#dataMA').offset().top + $('#dataMA').scrollTop());
              $(this).toggleClass('less')
              if($(this).hasClass('less')){
                   $(this).attr('src','images/less.png');
              }else{
                   $(this).attr('src','images/plus.png');
              }
          })); 
```

当我触发加号按钮时，它不会滚动，但是当我再次单击加号按钮时，它就像向下滚动和向上滚动一样。

我用 更改了`dataMA`选择器`toogleMAmaximized`，它滚动但没有按预期滚动（它向上移动了其中的内容）

**更新 1** 如果你有兴趣，我的环境： `jQuery`v1.7.1 `jQuery UI`1.8.16 `liveQuery`1.1.1

**更新 2** 我将环境更新到`jQuery`(1.7.2) 和`jQuery UI`(1.8.21) 的最新版本，仍然遇到同样的问题。

**更新 3** 好的，我有一个`fiddle`文件供你们查看问题。我在我的小屏幕上无法正确显示，希望你们能做得更好。首先是点击右边的图片，然后点击第一个方块。要查看滚动问题，请单击标题上的任何非加载图标（它们具有`plus`类）。dataMA 变量是我对数据库的查询的替换，它在结果中返回我放在那里的字符串。我在使用请求添加的标签`livequery`时遇到了很多问题。`.on()``.post()`

[jsfiddle](http://jsfiddle.net/TGsM5/17/)

**更新 4** 分辨率高于 1300x768 的任何人都可以告诉我他们是否正确获取了 jsfiddle 文件吗？我无法解决这个问题。

**更新 5**

我可以滚动几个元素，但是当它在包含的 div 之外的元素时，它不会滚动到，但是如上所述，当我再次按下按钮时，它会尝试向上滚动。

**更新 6**

我更新了jsfiddle以便更好地理解，过程是一样的：点击图片->弹出对话框->点击任务->向下滚动到最后一个（厚墙）->点击丢失的图片到对（我不知道为什么它不显示 alt 内容）这样做会显示一个隐藏的内容，再次单击它会隐藏它。然而，自动滚动没有完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T13:39:21.110

不是真正的答案，但看不到通过模糊代码找到评论链接。

无论如何...我也在[努力在 jQuery UI Dialog 中使用 .scrollTop()](https://stackoverflow.com/questions/11023219/scroll-to-last-row-having-class-in-jquery-dialog-on-open)。我也发布了一个[Fiddle](http://jsfiddle.net/wallabykid/e6rDT/)，希望证明我未能理解使其工作所需的代码。在那里，您将看到一个工作对话框，以及一小段代码清楚地展示了我的失败尝试。

我认为屏幕分辨率与您在 jsFiddle 上的麻烦没有任何关系。相反，我怀疑您的代码与其预期的上下文相去甚远，以至于通常是不完整的 - 没有完全破坏 - 但没有充分地从其预期的上下文中删除，以使有意愿的眼睛可以看到故障点。Waayyy 太多的代码无法排序通过做出合理的努力来帮助您解决问题。

我建议你尝试在你的开发平台上模拟它，除了相关位（例如一个对话框和一个原因以及调用 scrollTop() 的方法）。然后，当您仍然无法使其工作时，请在此处或在 jsFiddle 上发布精简后的代码，然后寻求帮助。（只是我的两分钱。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T14:24:40.380

我终于明白我的问题出在哪里了。我试图在`slideToggle()`效果完成之前进行滚动！我需要做的就是像这样调用滚动：

```
$('#data'+ key).slideToggle('fast',function(){
    $('#dataMA').scrollTop($('#data'+ key).offset().top - $('#dataMA').offset().top + $('#dataMA').scrollTop());
}); 
```

这是[解决方案](http://jsfiddle.net/TGsM5/19/)

# android - 使用适用于 Android 的 Google 可视化图表

> ID：11000518
> 
> 赞同：5
> 
> 时间：2012-06-12T16:08:55.957
> 
> 标签：android, charts, visualization, interactive

我对 Android 比较陌生，但我希望为我的应用程序使用交互式图表工具。我在一些论坛上阅读了有关使用 Google 图表在我的应用程序的 web 视图中显示的信息，但据我发现这只是显示静态图像。有谁知道是否有一种方法可以显示图表并使其在 Android 中也具有交互性？据我所知，我正在 4.0 中开发它确实支持 SVG。或多或少，在我开始尝试使其工作之前，我只是在寻找确认这是可能的。任何关于如何做到这一点的建议也很好。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:17:58.327

[google 动态图表](https://developers.google.com/chart/)在 android 中的 WebView 中显示时是交互式的。

然而，交互似乎更倾向于使用鼠标而不是触摸屏的 PC。因此，不幸的是，它的交互并不像在触摸设备上那样丰富。

# jquery - 我可以销毁这个函数或 mousemove 事件吗？

> ID：11000523
> 
> 赞同：1
> 
> 时间：2012-06-12T16:09:08.300
> 
> 标签：jquery, mousemove, destroy, mouseleave

我可以销毁这个函数或 mousemove 事件吗？

我在 jQuery 中有一些让我头疼的代码。我在网上找到了这段代码，我在传递元素时为鼠标移动效果服务，但想知道当我离开他时如何补充或删除事件。

我的一个例子如下：

```
$("#icons").mouseenter(function(e) {
    $(this).find('div').slidemouse();
});

$("#icons").mouseleave(function(e) {
    $(this).find('div').slidemouse('destroy');
}); 
```

代码插件：

```
(function($) {
    $.fn.slidemouse=function(options) {
        var defaults=
            {
            height:'240px',
            widthExpand:true,
            mirror:false,
            mirrorOpacity:.3
        };
        var opts=$.extend(defaults,options);
        var expands=1;
        var galleryWidth=0;
        var self=this;
        self.css('overflow','hidden');
        self.children().css('height',opts.height);
        self.children().children().each(function(index) {
            galleryWidth=galleryWidth+$(this).outerWidth(true)
        }
        );
        if(opts.widthExpand) {
            while(galleryWidth<self.width()) {
                self.children().children(":nth-child("+expands+")").clone().appendTo(self.children());
                galleryWidth=galleryWidth+self.children().children(":nth-child("+expands+")").outerWidth(true);
                expands++
            }
        }
        self.children().css("width",galleryWidth);
        if(opts.mirror) {
            self.clone().insertAfter(self).attr("id","");
            self.next().fadeTo(0,opts.mirrorOpacity)
        }
        if(opts.widthExpand||opts.mirror) {
            $(window).bind("resize",resizeWindow)
        }
        function resizeWindow() {
            if(opts.widthExpand) {
                galleryWidth=0;
                self.children().children().each(function(index) {
                    galleryWidth=galleryWidth+$(this).outerWidth(true)
                });
                while(galleryWidth<self.width()) {
                    self.children().children(":nth-child("+expands+")").clone().appendTo(self.children());
                    galleryWidth=galleryWidth+self.children().children(":nth-child("+expands+")").outerWidth(true);
                    expands++
                }
                self.children().css("width",galleryWidth);
                if(opts.mirror) {
                    self.next().remove();
                    self.clone().insertAfter(self).attr("id","");
                    self.next().fadeTo(0,opts.mirrorOpacity)
                }
            }
        }
        $(this).parent().mousemove(function(e) {
            var x=e.pageX-this.offsetLeft;
            var calc=(self.children().width()-self.width())/self.width();
            var left=x*calc;
            var right=(self.width()-x)*calc;
            self.stop().animate({scrollLeft: left}, 500);
            if(opts.mirror) {
                self.next().stop().animate({scrollLeft: right}, 500);
            }
        })
    }
}
)(jQuery); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T19:04:09.953

该插件没有针对您代码中需要的特定任务的方法。您可以绑定/取消绑定事件以防止插件的例程触发。适当时使用 $(this).unbind('event')。作为替代方案，您可以尝试通过向其添加销毁标志来修改插件的代码：

```
var defaults=
        {
        height:'240px',
        widthExpand:true,
        mirror:false,
        mirrorOpacity:.3,
        destroy: false
};

var opts=$.extend(defaults,options);
var self=this;

if(destroy) {

self.stop();
self.children().stop(); 
```

}

现在您可以将 mouseleave 上的新选项用作：

```
$(this).slidemouse({destroy: true}); 
```

# r - 具有多个叠加功能的绘图图例

> ID：11000526
> 
> 赞同：0
> 
> 时间：2012-06-12T16:09:17.313
> 
> 标签：r, ggplot2

> **可能重复：**
> [ggplot2 为几个 stat_functions 添加图例](https://stackoverflow.com/questions/10085493/ggplot2-add-a-legend-for-several-stat-functions)

我正在尝试将 3 个函数（使用`stat_function`）叠加在散点图（`geom_point`）上，并为叠加函数添加图例。我已经成功地制作了一个带有函数的图，但我不确定如何添加图例。

```
ggplot(questionnaire,aes(A,B)) + 
  geom_point() + 
  stat_function(...,colour="blue") + 
  stat_function(...,colour="red") + 
  stat_function(...colour="green") 
```

任何有关如何添加解释每条不同颜色线的图例的帮助将不胜感激。

# android - 使用内存地址从内存中获取对象

> ID：11000528
> 
> 赞同：0
> 
> 时间：2012-06-12T16:09:22.200
> 
> 标签：android, memory, mediarecorder

我想知道如何从内存中获取一个对象，在我的例子中是一个 MediaRecorder。这是我的课：

Mymic类：

```
public class MyMic  {

    MediaRecorder recorder2;
    File file;
    private Context c;

    public MyMic(Context context){
        this.c=context;
        recorder2=  new MediaRecorder();
    }

    private void stopRecord() throws IOException {
        recorder2.stop();
        recorder2.reset();
        recorder2.release();
    }

    private void startRecord() {

        recorder2.setAudioSource(MediaRecorder.AudioSource.MIC);
        recorder2.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
        recorder2.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
        recorder2.setOutputFile(file.getPath());
        try {
            recorder2.prepare();
            recorder2.start();
        } catch (IllegalStateException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

我的接收类：

```
public class MyReceiver extends BroadcastReceiver {

    private Context c;
    private MyMic myMic;
    @Override
    public void onReceive(Context context, Intent intent) {
        this.c=context;
        myMic = new MyMic(c);
        if(my condition = true){
        myMic.startRecord();
        }else

        myMic.stopRecord();
    }
} 
```

因此，当我调用`startRecord()`它创建一个新的`MediaRecorder`但当我第二次实例化我的类时，我无法检索我的对象。我可以`MediaRecorder`用他的地址找回我的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:14:23.413

您需要将 MediaRecorder 的构造函数放在您正在创建的类的构造函数中，而不是像这样的 startRecord() 方法中：

```
public class MyMic  {

MediaRecorder recorder2;
File file;
private Context c;

public MyMic(Context context){
    this.c=context;
    recorder2=  new MediaRecorder();

}

private void stopRecord() throws IOException {
    recorder2.stop();
    recorder2.reset();
    recorder2.release();

}

private void startRecord() {

    recorder2.setAudioSource(MediaRecorder.AudioSource.MIC);
    recorder2.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
    recorder2.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
    recorder2.setOutputFile(file.getPath());
    try {
        recorder2.prepare();
        recorder2.start();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

}

} 
```

另外，我无法确切地弄清楚您要对构造函数中的逻辑做什么，但是您可能不应该按照自己的方式进行操作。你不应该让你的课程，这样你每次想要开始/停止录制时都必须创建一个新的实例。最终目标应该是您实例化一次并保留引用的对象，以便您可以随时调用它的启动/停止。

您可以从内部发布您正在使用此类的 Activity（或其他 Android 结构）吗？如果是这样，我可以帮助您以更简洁的方式将两者联系在一起。

# c - Linux：用负 pid 杀死

> ID：11000538
> 
> 赞同：2
> 
> 时间：2012-06-12T16:10:19.250
> 
> 标签：c, linux, unix

从[SUSv4](http://pubs.opengroup.org/onlinepubs/9699919799/functions/kill.html)：

> 如果 pid 为负数，但不是 -1，则应向进程组 ID 等于 pid 绝对值且进程有权发送信号的所有进程（不包括未指定的系统进程集）发送 sig .

据我了解，任何时候都不能有 2 个或更多具有相同 PID 的进程。为什么规范对所有流程都有规定？

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-12T16:11:24.180

该规范**对给定组内的所有进程说。**每个组可以有多个进程。否定`id`标识该组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T16:34:08.117

**进程组 ID 与进程 ID 不同。**

假设 PID 已知，PGID 为

> 每个进程都是唯一*进程组*的成员，由其*进程组 ID 标识*。（当进程创建时，它成为其父进程组的成员。）按照惯例，进程组的进程组 ID 等于进程组的第一个成员的进程 ID，称为*进程组领导*。`getpgrp()`进程使用系统调用或等效地查找其进程组的 ID `getpgid(0)`。使用 找到过程 p `getpgid(p)`。

[来源](http://www.win.tue.nl/~aeb/linux/lk/lk-10.html#ss10.2)

# asp.net - 如何以编程方式知道我的应用程序是否在“ASP.NET 开发服务器”下运行？

> ID：11000539
> 
> 赞同：1
> 
> 时间：2012-06-12T16:10:34.340
> 
> 标签：asp.net, .net, asp.net-development-serv

我有一些默认值来测试我的代码，但出于安全原因，这些值必须在我的应用程序在 ASP.NET 开发服务器下运行而不是在生产环境下运行时设置。如何以编程方式确定我的应用程序在哪里运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:17:37.407

一种技术是向您的配置添加一个属性，该属性可以使用编码转换文件进行设置。在您的 web.config 中，“DEV”可能为真。在您的生产转换文件中，您的“DEV”可能是错误的。使用这种技术，您甚至可以确定您是否处于暂存、测试、预生产等阶段。这也是一种用于更改连接字符串的技术。

转换文件用于根据您的部署更改配置中的各种值。

阅读更多内容： [如何：在部署 Web 应用程序项目时转换 Web.config](http://msdn.microsoft.com/en-us/library/dd465318.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:15:14.117

这是确定您的应用程序是在本地运行还是在生产环境中运行的一种非常糟糕的方法。更好的方法是使用运行时 web.config 值（带有调试和发布模式的相应转换），甚至是编译时条件 ( `#if DEBUG ... #endif`)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T17:18:07.070

如果“ASP.NET 开发服务器”是指 Visual Studio 中包含的 Cassini 服务器，则没有支持的方法来执行此操作。

您可以按照其他人的建议将信息添加到 web.config，或者您可以使用一些不受支持的技术（不能保证在未来的版本中工作......）。例如检查

```
System.Environment.CommandLine 
```

在 Cassini 下运行时将包含“...WevDev.WebServer...”。

# css - 左侧的全长菜单，右侧的两个内容窗格：仅 DIV 和 CSS 方法？

> ID：11000557
> 
> 赞同：3
> 
> 时间：2012-06-12T16:11:49.560
> 
> 标签：css, layout, html

我正在尝试创建一个类似于以下内容的简单网页：

![在此处输入图像描述](../Images/285125b5e0c5545b8d4db95517014118.png)

我有三个DIV，如下：

```
<div class="leftNav">       
</div>
<div class="topPanel">          
</div>
<div class="bottomPanel">           
</div> 
```

这是CSS：

```
.leftNav
{
    width: 20%;
    height: 100%;
    float: left;    
}

.topPanel
{
    width: 80%;
    height: 50%;
    float: right;
}
.bottomPanel
{
    width: 80%;
    height: 50%;
    float: right;
} 
```

然而，最终结果看起来完全不正常。是否可以使用 DIV 和 CSS 创建这样的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T16:20:08.953

有几种方法可以做到这一点。

您只需添加以下内容即可修复原始方法：

```
html, body {
    height: 100%;
    overflow: hidden; /* to hide any scrollbars that might appear */
} 
```

**见：http:** [//jsfiddle.net/thirtydot/n4wr4/](http://jsfiddle.net/thirtydot/n4wr4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:17:17.547

也许您需要将这三个 div 放入容器 div 并设置该容器的大小。见这里：http: [//jsfiddle.net/Rorok_89/A6Uf7/](http://jsfiddle.net/Rorok_89/A6Uf7/)

# c++ - 线程没有从睡眠中醒来

> ID：11000559
> 
> 赞同：0
> 
> 时间：2012-06-12T16:12:00.967
> 
> 标签：c++, multithreading, pthreads, ace, thread-sleep

我有一个多线程应用程序，但有时一个线程应该在 10 秒后醒来并做一些工作，但不会从睡眠中醒来或饿死。

它只是偶尔发生。

```
//ACE task svc method
int svc (void)
    {
        while(true)
        {
            ACE_DEBUG((MY_INFO "sleep\n"));
            sleep(10);
            ACE_DEBUG((MY_INFO "awake for HB\n"));
            _csender.sendHeartBeat();
        }

        return 0;
    } 
```

日志最后一行是：2012-06-12 11:34:20.807272|INFO|sleep

线程要么没有唤醒 15 秒，要么在唤醒后直到第 15 秒才做任何工作，因此应用程序关闭。

应用程序中共有 6 个线程，所有线程都以相同的优先级启动。其中一个线程非常繁忙，它接收大量市场数据并对其进行处理，但不会在套接字上发送任何内容。上面的线程是唯一发送数据的线程，接收者和发送者线程共享同一个套接字对象。

这是在红帽 linux 5.3 上。

任何想法可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T17:18:24.830

'繁忙的线程每 2 微秒打印 2 个 ACE_DEBUG' - 因此可能会阻塞调试器的输出队列并阻止该线程进入排队其“睡眠\n”。

那个，和/或你已经优先考虑这个线程并且它无法获得核心，正如其他海报所指出的那样。

sleep(10) 几乎是无关紧要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T15:32:13.197

我认为它在 ACE_DEBUG 中。您是否在睡眠后立即尝试使用冲洗的 printf ？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T16:19:02.680

睡眠不能保证睡眠的最大时间，即您至少睡了那个时间，或者更长的时间。我不知道期待 5 秒的延迟是否合理，这听起来太长了。

# ios - 将对象添加到另一个 NSDictionary 中的 NSMutableDictionary 中的 NSMutableArray

> ID：11000561
> 
> 赞同：0
> 
> 时间：2012-06-12T16:12:02.040
> 
> 标签：ios, nsmutablearray, add, nsmutabledictionary

所以我在带有数组的字典中有一个字典。我正在尝试添加到第二个字典中的数组。

```
 [mealInfo setObject:[[NSMutableDictionary alloc]init] forKey:@"breakfast"];
 [[mealInfo objectForKey:@"breakfast"] setObject:[[NSMutableArray alloc] init] forKey:@"name"];
    [[mealInfo objectForKey:@"breakfast"] setObject:[[NSMutableArray alloc] init] forKey:@"detail"];
    [[mealInfo objectForKey:@"breakfast"] setObject:[[NSMutableArray alloc] init] forKey:@"ndb"];
    [[mealInfo objectForKey:@"breakfast"] setObject:[[NSMutableArray alloc] init] forKey:@"id"];
    [[mealInfo objectForKey:@"breakfast"] setObject:[[NSMutableArray alloc] init] forKey:@"alias"]; 
```

创建似乎只是向数组添加多个元素是我最终遇到 SIGABRT 错误的地方

我像这样添加

```
[[[initMealInfo->mealInfo objectForKey:@"breakfast"] objectForKey:@"name"] addObject:[food_prop objectForKey:@"description"]]; 
```

我知道我做错了什么，并想知道任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:23:21.507

首先，您使用的是 ARC 吗？否则你有很多麻烦。

* * *

您应该阅读最少知识原理和得[墨忒耳定律](http://en.wikipedia.org/wiki/Law_of_Demeter)

使这样的结构更直观：

```
 NSMutableDictionary *mealInfo = [[NSMutableDictionary alloc] init];

    NSMutableDictionary *breakfast = [[NSMutableDictionary alloc] init];
    [breakfast setObject:[[NSMutableArray alloc] init] forKey:@"name"];
    [breakfast setObject:[[NSMutableArray alloc] init] forKey:@"detail"];
    [breakfast setObject:[[NSMutableArray alloc] init] forKey:@"ndb"];
    [breakfast setObject:[[NSMutableArray alloc] init] forKey:@"id"];
    [breakfast setObject:[[NSMutableArray alloc] init] forKey:@"alias"];

    [mealInfo setObject:breakfast forKey:@"breakfast"]; 
```

然后在尝试输入信息并将其包装在函数中时尝试将其分解一下

```
-(void) addMealName:(NSString*) name forMeal:(NSString*) meal 
{
    NSMutableDictionary *meals = [mealInfo objectForKey:meal];
    NSMutableArray *mealNames = [breakfast objectForKey:@"name"];
    [mealNames addObject:name];
    [meals setObject:breakfastNames forKey:@"name"];
    [mealInfo breakfast forKey:meal];
} 
```

并打电话

```
NSString *newMealName = [food_prop objectForKey:@"description"];
[initMealInfo addMealName:newMealName forMeal:@"breakfast"]; 
```

# ruby-on-rails - Rails - 压倒一切的功能

> ID：11000564
> 
> 赞同：0
> 
> 时间：2012-06-12T16:12:14.197
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, architecture

我很惊讶地看到在 Rails 中自定义东西是多么简单。您首先安装一个提供您需要的一些功能的 gem，然后您只需自定义您需要的东西。

Spree 就是一个例子，它可以通过简单地使用自定义代码覆盖模板和 ruby​​ 文件来进行自定义。

我只是想知道谁允许我这样做：是 Ruby 吗？是这些宝石的架构吗？是 Rails 架构吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:18:24.533

Ruby 允许元编程，因为它是在运行时评估的。

在 Rails 应用程序中，您可以将 ruby​​ String 之类的类添加到初始化程序文件夹并添加新的声明性方法，然后将其添加到 String 类并可以与 Strings 一起使用。

阅读更多[http://www.vitarara.org/cms/ruby_metaprogamming_declaratively_adding_methods_to_a_class](http://www.vitarara.org/cms/ruby_metaprogamming_declaratively_adding_methods_to_a_class)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T20:57:49.810

它是部分铁轨和部分红宝石。多年来，Rails 已经被开发人员和插件编写（并且被重写为更多）可扩展。某些挂钩和覆盖功能的方法是通过 ruby​​ 启用的，而其他一些方法在许多动态性较低的语言中是相同的。

# java - 从文本文件中读取文本并将其存储在 Jtable 中

> ID：11000568
> 
> 赞同：-3
> 
> 时间：2012-06-12T16:12:39.157
> 
> 标签：java, swing, file-io, jtable

有没有办法从文本文件中读取并将内容存储在 Jtable 中？我有一个文本文件，其中包含有关某些进程的某些信息。它就像一个包含列和相应值的表。能不能把.txt文件的内容拿来以Jtable的形式显示出来？我正在使用 Eclipse 和 Window Builder。任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:42:56.687

我会查看 Oracle 的教程：

*   [读/写文本文件](http://docs.oracle.com/javase/tutorial/essential/io/file.html#textfiles)

*   [JTable 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#simple)

当您从文本文件中获取数据时，您需要将其放入一个二维数组并使用该二维数组（连同 columnNames 数组）来创建一个新的 JTable 对象。（更多细节可在 JTable 教程中找到）

# grails - “错误编译错误：编码字符串太长：”进行构建时

> ID：11000570
> 
> 赞同：5
> 
> 时间：2012-06-12T16:12:46.027
> 
> 标签：grails, groovy, war

我有一个在开发模式下正确运行的 Grails 项目，但是当我尝试创建一个 war 文件时，它会给我以下消息并停止构建

```
| Compiling 1 source files
| Compiling 1 source files.
| Compiling 1 source files..
| Compiling 1 source files...
| Compiling 1 source files....
| Compiling 1 source files.....
| Compiling 16 GSP files for package [ProjectName]
| Compiling 16 GSP files for package [ProjectName].
| Error Compilation error: encoded string too long: 108421 bytes 
```

Grails 没有就哪条 GSP 或线路有问题给我任何其他信息，有人看到这种情况吗？

这是 grails 的统计数据，我会说它是一个相当小的项目

```
+----------------------+-------+-------+
| Name                 | Files |  LOC  |
+----------------------+-------+-------+
| Controllers          |     6 |   624 | 
| Domain Classes       |     6 |   109 | 
| Java Helpers         |     1 |    96 | 
| Unit Tests           |    12 |   565 | 
| Scripts              |     1 |     4 | 
+----------------------+-------+-------+
| Totals               |    26 |  1398 | 
+----------------------+-------+-------+ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-19T20:37:16.813

这似乎是[2.3.7 之前](https://jira.grails.org/browse/GRAILS-11171)版本的 grails 错误， 但在 2.3.7 及更高版本中已修复。您有两种选择升级或按照以下步骤操作

1.  查找文件大小大于 64K 的所有 gsp 页面。
2.  添加 <% /* 注释以打破静态 gsp 块 */ %> 到静态页面的中间（将其添加到 html 标记的末尾，例如在`</P>`等之后）。

这将使 grails 认为它​​正在处理两个块并允许它被处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T18:46:45.803

我以前见过这个。正是@tim_yates 评论的！重构了一些 gsp [包括例如]，一切都很好。另外，对此进行了一些研究，我发现了一些关于 DataOutputStream.java 的有趣的东西。String 对象似乎有[64kb 的限制](http://www.drillio.com/en/software-development/java/encoded-string-too-long-64kb-limit/)。

也许[这](http://www.mail-archive.com/fop-users@xmlgraphics.apache.org/msg11317.html)也可以帮助你。

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T05:10:31.480

I never knew what the problem was, all I did is moved all the needed file to a brand new project and this error disappeared!

# javascript - 对 Flash 播放器使用 javascript 而不是嵌套对象

> ID：11000571
> 
> 赞同：0
> 
> 时间：2012-06-12T16:12:45.910
> 
> 标签：javascript, html, flash

跟进：虽然我已经将 swfobject 与静态发布一起使用，但动态发布解决了我的问题。谢谢您的帮助。

哎呀！我刚刚删除了原帖。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:20:25.833

你为什么不使用[SWFObject](http://code.google.com/p/swfobject/)？它比它更健壮`document.write`、更灵活。

只需选择“[动态发布](http://www.bobbyvandersluis.com/swfobject/generator/index.html)”，SWFObject 就会为您提供所需的一切。

此外，`document.write` [是邪恶的](https://stackoverflow.com/a/802943/852866)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:28:15.930

我同意 strah 的观点，即 SWFObject 是可行的方法，但如果您仍想在某个位置插入 HTML，您可以使用 div：

```
<div id="Flash"></div> 
```

然后使用以下javascript：

```
document.getElementById("Flash").innerHTML = "flashStuff"; 
```

另外，我想指出，对象的后半部分是相同的，因此您可以将 if 仅用于第一部分以节省空间。

# jquery - 验证失败时创建分层面板

> ID：11000572
> 
> 赞同：1
> 
> 时间：2012-06-12T16:12:45.910
> 
> 标签：jquery, jquery-ui, jquery-validate, styling

我想创建一个包含验证错误的图层，并将其显示为与我的表单并排的工具提示。类似于以下示例：

```
+-------------+
|             |
|             |    Normal Form
|             |
+-------------+

+-------------+-----+
|             |     |
|             |-----+    Form with visible 
|             |          validation errors
+-------------+ 
```

清楚吗？错误容器只有在存在验证错误时才可见，并且应该位于表单本身的右上角区域。

实际上我有以下示例标记：

```
<form id="information" method="post" action="#">
   <fieldset>
      <legend>Please enter your contact details</legend>
          <div id="id">
              <label for="name">Name: (*)</label>
              <input type="text" id="name" class="details" name="name" maxlength="50" title="Insert your Name" />
          </div>
          <div id="id">
              <label for="email">Email: (*)</label>
              <input type="text" id="email" class="details" name="email" maxlength="50" title="Insert your Email" />
          </div>
   </fieldset>
   <div id="submission">
       <input type="submit" id="submit" value="Send" name="send"/>
   </div>
</form> 
```

而这个jQuery代码：

```
$(document).ready(function () {
    var form = $('#information');
    var container = $('<div class="error"><p>Errors:</p><ol></ol></div>').appendTo(form).hide();
    var validator = form.validate({
        errorContainer: container,
        errorLabelContainer: $("ol", container),
        wrapper: 'li',
        meta: "validate"
    });
}); 
```

在表单下方附加错误列表非常有效。如何在表单顶部显示错误 div？

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T18:23:42.623

通过使用 ID 显式设置错误消息容器并设置标签容器，根据需要设置错误消息框的样式要容易得多。

```
<div id="formColumn">
    <form id="information" method="post" action="#">
   <fieldset>
      <legend>Please enter your details</legend>
          <div id="id">
              <label for="name">Name: (*)</label>
              <input type="text" id="name" class="details required" name="name" maxlength="50" title="Insert your Name" />
          </div>
          <div id="id">
              <label for="email">Email: (*)</label>
              <input type="text" id="email" class="details required" name="email" maxlength="50" title="Insert your Email" />
          </div>
   </fieldset>
   <div id="submission">
       <input type="submit" id="submit" value="Send" name="send"/>
   </div>
</form>
</div>
<div id="messageBox"><p>Errors:</p><ol></ol></div>​ 
```

jQuery：

```
$(function() {
    var form = $('#information');
    var validator = form.validate({
        errorContainer: "#messageBox",
        errorLabelContainer: "#messageBox ol",
        wrapper: 'li',
        meta: "validate"
    });
}); 
```

CSS：

```
#formColumn{
    display:inline;
    float:left
}
#messageBox{
    display:none;
    float:left
}​ 
```

此外，请谨慎使用“错误”类作为您包含的错误消息，因为验证器插件在其他地方使用此名称。

[http://jsfiddle.net/yvxRc/](http://jsfiddle.net/yvxRc/)

# c# - 如何从 Adob e Distiller 工具创建的 pdf 文件中读取文本？

> ID：11000574
> 
> 赞同：0
> 
> 时间：2012-06-12T16:12:47.250
> 
> 标签：c#, .net, pdf, extraction, abcpdf

如何从 Adob​​e Distiller 工具创建的 pdf 文件中读取文本？

我目前正在使用 ABCPdf 工具，并且我有一个代码示例来读取 pdf 内容，但它只能读取由 Adob​​e PDF 库创建的 pdf 中的文本：

```
 public string ExtractTextsFromAllPages(string pdfFileName)
        {
            var sb = new StringBuilder();

            using (var doc = new Doc())
            {
                doc.Read(pdfFileName);

                for (var currentPageNumber = 1; currentPageNumber <= doc.PageCount; currentPageNumber++)
                {
                    doc.PageNumber = currentPageNumber;
                    sb.Append(doc.GetText("Text"));
                }
            }

            return sb.ToString();
        } 
```

我有其他由 Adob​​e Distiller 创建的 pdf 文件，上面的代码不起作用；我的意思是它返回以下似乎已编码的奇怪数据：

```
\0\a\b\0\t\n\0\r\n\0\a\b\t\n\n\b\v\f\0\t\r\f\b\0\r\0\r\n\v\b\v\f\f\n\r\0\r\0\0\0\b\r\n\0\a\r\0\0\b\r\b\b\t\n\r\0\b\r\n\t\b\v\n\b\v\v\0\a\b\r\n\r\n\v\r\0\b\b\b\v\r\0\r\n\v\f\r\f\f\r\n !\"\"\v#\t $ %&$% $'\v\"% \0( )% ! !\"\"'*$'\r\n\t $ %&$% $'\v\"% \0( \r\n\f\f\f\f\b\f\f\f\f\a \b\b\f\f\f!\"\r\n\f\a#$\f\f\f\b\f\f\a%\a \b\b\f\a\a&\a\a' \b\a\b\r\n(\f)\f) 
```

如何从 Adob​​e Distiller 工具创建的 pdf 文件中读取文本？

可以说我可以像其他 pdf 一样使用浏览器轻松打开此类 pdf 文件。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:18:09.090

我在使用 PDF 时遇到了类似的问题。我没有使用过 ABCPdf，但您可能想查看 iTextSharp，我之前已经创建了一个从 PDF 文件中提取字符串的工具，但是如果嵌入了字体，您仍然会遇到问题。如果您能够切换到 iTextSharp，这里有一个关于 SO 的问题，该问题涉及该主题：

[在 VB.NET 或 C# 中使用 itextsharp dll 读取 PDF 内容](https://stackoverflow.com/questions/2550796/reading-pdf-content-with-itextsharp-dll-in-vb-net-or-c-sharp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T20:29:29.907

因此，您只是看不到一些可读文本的事实可能是由使用的奇怪编码引起的。我们通常假设使用 ASCII 字符集进行编码。想象句子“Hello world”（ASCII 到 HEX 将是：48 65 6C 6C 6F 20 77 6F 72 6C 64）以简单的方式，我们假设“H”的含义是 48，“e”的含义是 65等等。

但是想像一个工程师做他自己的字体子集：为了将“H”编码为第一个出现的字母，他使用 00，对于 e，然后是 01。然后句子将被编码为 00 01 02 02 03 04 05 03 06 02 07

这将导致几个不可读的字符。就像古代秘密脚本通过秘密编码表进行编码和解码一样。

您的问题的答案很简单：只有当您知道用于重新组装的正确编码向量时，您才能阅读从蒸馏器生成的文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T10:51:55.207

首先要尝试的是使用 Adob​​e Reader 或任何其他 PDF 查看器从 PDF 中复制和粘贴文本。

如果您**根本无法复制**和粘贴文本，则可能会通过文件中的权限禁用文本提取功能。通常权限会被 PDF 库忽略，不会影响文本提取。

如果您可以从文件中复制和粘贴文本，但它**看起来乱码/不正确**，则 PDF 不包含正确执行文本提取所需的某些信息。此类文件将正确*显示*。

如果将 Adob​​e Distiller 配置为生成尽可能小的文件，则它生成的文件没有正确提取文本所需的信息。

编辑：

如果您需要从有意义的文本中区分垃圾字符，那么您应该实现一种衡量文本可读性的算法。

一些链接：

*   [计算字符串的熵](https://codereview.stackexchange.com/q/868/14167)
*   [有没有办法检测像 putjbtghguhjjjanika 这样的字符串？](https://stackoverflow.com/q/6297991/249690)
*   这个关于文本评分系统的[答案](https://stackoverflow.com/a/7789010/249690)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-06-20T11:49:38.820

ABCpdf 可以从所有包含有效文本的 PDF 中提取文本。它推断空格、去连字符、剪辑到感兴趣的区域以及确保您获得的文本与您看到的文本相同所需的许多其他事情。

然而，所有这些都假设 PDF 是有效的——它符合 PDF 规范——它没有损坏。

文本提取问题的最常见原因是身份编码字体损坏。标识编码字体由字形而不是字符代码引用。字体包括一个 ToUnicode 映射，以允许将字形 ID 转换为字符。

但是，我们有时会看到已删除此条目的文档。这意味着识别字符的唯一方法是对文档进行 OCR。

如果您在 Acrobat 中打开文档并复制文本，您可以自己看到这一点。当您将复制的文本粘贴到记事本等应用程序中时，您将能够看到它是错误的。ABCpdf 与 Acrobat 相同。

这些文件被如此彻底和有效地破坏的事实可能是故意的。这当然是确保没有人可以复制您的文本的好方法。

我写了 ABCpdf .NET 文本提取，所以我应该知道。:-)

# php - Mysql，PDO - Like 语句无法使用 bindParam

> ID：11000576
> 
> 赞同：1
> 
> 时间：2012-06-12T16:13:04.693
> 
> 标签：php, mysql, search, pdo, bind

我正在尝试为网站编写搜索功能代码，但我陷入了 sql 语句中的类似比较。出于某种原因，当我使用 ? 和 pindparam 包含类似比较字符串的变量，它不断返回，但没有找到结果。如果我删除 ? 并且只需键入`post_title LIKE '%something%'`它的工作比较。

这是我的代码：

```
// Retrieve search results
    function retrieve_search_posts($searchfield){
        //test the connection
        try{
            //connect to the database
            $dbh = new PDO("mysql:host=localhost;dbname=mjbox","root", "usbw");
        //if there is an error catch it here
        } catch( PDOException $e ) {
            //display the error
            echo $e->getMessage();

        }
        $searcharray = array();
        $where = "";

        $searchfield = preg_split('/[\s]+/',$searchfield);
        $total_words = count($searchfield);

        foreach($searchfield AS $key=>$searchword){
            $where .= "post_title LIKE '%".$searchword."%'";
            if($key != ($total_words - 1)){
                $where .= " OR ";
                echo $searchword . '<br>';
            }
        }
        echo $where;
        $stmt = $dbh->prepare("SELECT  p.post_id, post_year, post_desc, post_title, post_date, img_file_name, p.cat_id
                                FROM    mjbox_posts p
                                JOIN    mjbox_images i
                                ON      i.post_id = p.post_id
                                        AND i.cat_id = p.cat_id
                                        AND i.img_is_thumb = 1
                                        AND post_active = 1
                                WHERE ?
                                ORDER BY post_date
                                DESC
                                LIMIT 9");
        $stmt->bindParam(1,$where);
        $stmt->execute();

        while($row = $stmt->fetch(PDO::FETCH_ASSOC)) {

                $searcharray[] = $row;
        }

        return $searcharray;
    }

// Check for errors in search field
    function search_errors($searchfield){
        $searcherrors = array();
        if(empty($searchfield)){
            $searcherrors[] = '<p>Please enter a search term.</p>';
        }else if(strlen($searchfield)<3){
            $searcherrors[] = '<p>Your search term must be three characters or more.</p>';
        }else if(retrieve_search_posts($searchfield) == false){
            $searcherrors[] = '<p>Your search for '.$searchfield.' returned no results.</p>';
        }
        return $searcherrors;
    } 
```

搜索.php

```
// Get the search terms posted 
    $searchfield = trim($_POST['searchfield']);

    // Check if there are any errors with the search terms
    $searcherrors = search_errors($searchfield);

    // If there are errors
    if(!empty($searcherrors)){
        // Display them here
        foreach($searcherrors AS $value){
            echo $value .'<br />';
        }
    }
    $searcharray = retrieve_search_posts($searchfield);

    echo '<div id="content-wrap">';
    foreach($searcharray AS $value){
        $filename = substr($value['img_file_name'],9);
        $cat_id = $value['cat_id'];
        echo '<article class="post">';
        echo '<div class="post_title">' . $value['post_title'] . '</div>';
        echo '<div class="post_info">' . 
        'Category: ' . $cat_name = get_cat_name($cat_id) .'<br />'. 
        'Year: ' . $value['post_year'] .'<br />'. 
        $value['post_desc'] .'<br />'. 
        '</div>';
        echo '<div class="link-to-post"><a href="#">Click to view</a></div>';
        echo '<a name="'.$value['post_id'].'"></a><a href="#'.$value['post_id'].'" class="linktopost"><img class="post-thumb" src="img/thumb_/'.$filename.'" alt="MJbox Michael Jackson memorabilia thumbnail" data-postid="'.$value['post_id'].'"/></a>';
        echo '<a name="'.$value['post_id'].'"></a><a href="#'.$value['post_id'].'" class="linktopost"><img class="cover-img" src="img/post-bg-1.png" alt="test" data-postid="'.$value['post_id'].'"/></a>';
        echo '</article>';

    }
    echo '</div>'; 
```

mysql 数据库中肯定有一个条目，其中包含我放入 where 字符串的单词。当我只输入 like 比较而不是使用`?`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:47:15.520

您需要单独绑定每个参数，您可以使用第二个循环来执行此操作。

```
function retrieve_search_posts(PDO $pdo, $search_field) {
    /*
     * Get the PDO object as an argument, this function shouldn't care
     * how the PDO object is created, that's the factory's job.
     */

    /*
     * Use $underscored_names or $camelCase for variable names, easier on the eye
     */

    ## Variable initializations ##
    $where = array();

    ##Function start
    $words = preg_split("/\s+/", $search_field);

    for ($i = 0; $i < count($words); $i++) {
        /*
         * We don't need to have the word in here,
         * so we aren't even using the foreach loop, just a normal for
         */
        $where[] .= "`post_title` LIKE ?";
    }
    /*
     * For cleaner code, use an array and implode the pieces with OR,
     * this way, you don't get an OR at the beginning, nor the end.
     */
    $where_string = implode(" OR ", $where);

    $query = <<<MySQL
SELECT  p.post_id, post_year, post_desc, post_title, post_date, img_file_name, p.cat_id
    FROM mjbox_posts p
    JOIN    mjbox_images i
    ON      i.post_id = p.post_id
        AND i.cat_id = p.cat_id
        AND i.img_is_thumb = 1
        AND post_active = 1
    WHERE ?
    ORDER BY post_date DESC
    LIMIT 9
MySQL;

    $sth = $pdo->prepare($query);

    /*
    * Iterate over the array again,
    * this time, we're binding the values based on the index
    */
    foreach ($words as $index => $word) {
        $sth->bindValue($index+1, $word, PDO::PARAM_STR);
    }

    $sth->execute();

    $result = $sth->fetchAll(PDO::FETCH_ASSOC); //Fetch all the results in associative array form

    return $result;

} 
```

请参阅代码注释以解释所做的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:22:46.247

您不能将字段和值绑定在一起，PDO 会将其包装在引号中，因为它假定它`?`是查询的值：

`'post_title LIKE \'%something%\''`

您可以保留列字段，然后绑定参数：

`post_title LIKE ?`

然后检查是否设置了搜索字段。`'%'.$where.'%'`使用or 如果没有输入任何内容，则绑定参数`'%'`

# powershell - powershell 强制 ssl 版本 3 获取请求

> ID：11000581
> 
> 赞同：5
> 
> 时间：2012-06-12T16:13:20.317
> 
> 标签：powershell

我想知道其中一个 powershell，C# 大师是否可以阐明如何使用 [System.Net.WebRequest] 在 Windows 上的 webrequest 期间强制 Sslv3

我想将以下 C# 代码转换为 Powershell 的等效代码：

```
 ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3; 
```

我尝试将以下代码添加到我的脚本中，但错误提示“Net.SecurityProtocolType.ssl3”一词未被识别为 cmdlet、脚本文件、函数的名称。以下是我在代码中使用的内容：

```
 [System.Net.ServicePointManager]::SecurityProtocol = Net.SecurityProtocolType.ssl3 
```

感谢所有的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-12T19:16:31.110

枚举需要扩展类型方括号语法：

```
 [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::ssl3 
```

你也可以让 PowerShell 为你投射它：

```
[Net.ServicePointManager]::SecurityProtocol = 'ssl3' 
```

# javascript - PhantomJS -- 抓取数据馈送 -- 一些 AJAX 内容没有加载，即使有大量的 setTimeout

> ID：11000586
> 
> 赞同：0
> 
> 时间：2012-06-12T16:13:42.853
> 
> 标签：javascript, phantomjs

我有一个用于抓取提要的通用 PhantomJS 设置（我们在所有者的许可下为客户执行此操作）——你给它一个 URL、用于翻页的 jQuery/javascript 代码和一个从提要中选择链接的选择器。

除了翻页的按钮 [参见图片] 之外，此提要似乎可以正常加载所有内容。

**由 PhantomJS 渲染：**

![PhantomJS 照片缺少“翻页”按钮](../Images/da6a7db7c1924b18cdb85af401f8cd9d.png)

**在我的电脑上由 Chrome 渲染：**

![在此处输入图像描述](../Images/574908c948cea5263927aa3fb9490b61.png)

我被难住了一天多。

非常感谢任何帮助。

**我的代码：**

```
var page = new WebPage({
                  settings: {
                    loadPlugins: true,
                    userAgent : "Mozilla/5.0 (X11; Linux i686) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.46 Safari/536.5",
                    XSSAuditingEnabled: false,
                    webSecurityEnabled: false
                  },
                  viewportSize: { width: 1366, height: 768 }
               }),
    output_phantom = {errors: [], results: null};

var turn_page_jquery    = "$('#yui-pg0-0-next-link').click_link()",
    url_selector_jquery = "$('h3 a').multiAttr('href')",
    url                 = "http://www.springcjd.com/new/search?dpt=2#QryString=%3FlogSearch%3Dfalse%26sortCol%3Dnull%26sortType%3Dnull%26VIN%3Dnull%26dealerStockID%3Dnull%26stockType%3D2%26year%3Dnull%26make%3Dnull%26model%3Dnull%26subModel%3Dnull%26body%3Dnull%26minMileage%3Dnull%26maxMileage%3Dnull%26numOfDoors%3Dnull%26certified%3Dnull%26minDFList%3Dnull%26maxDFList%3Dnull%26onLotAfter%3Dnull%26onLotBefore%3Dnull%26pageNum%3D1%26carsPerPage%3D30%26fullText%3Dnull%26%26mpghmn%3Dnull%26%26lotID%3Dnull%26daysOnLotMin%3Dnull%26%26output%3Djson%22";

// Start things going here
get_links_from_pages(url, url_selector_jquery, turn_page_jquery);

// Allows you to pass args to function in page
function evaluate(page, func) {
    var args = [].slice.call(arguments, 2);
    var fn   = "function() { return (" + func.toString() + ").apply(this, " + JSON.stringify(args) + ");}";
    return page.evaluate(fn);
}

page.onError = function (msg, trace) {
    console.log(msg);
    trace.forEach(function(item) {
        console.log('  ', item.file, ':', item.line);
    });
};

// Communicator between phantomJS and the page.
page.onConsoleMessage = function(msg) 
{
    var msg_json = JSON.parse(msg);

    if(msg_json && msg_json.type)
    {
        var type    = msg_json.type;
        var message = msg_json.message;

        switch(type)
        {
            case 'return_value':
                output_phantom.results = message;
                console.log(JSON.stringify(output_phantom)); 
                phantom.exit(); 
                break;
            case 'message':
                output_phantom.errors.push(message);
                break;
            case 'exit': 
                phantom.exit();
                break;
            case 'render': 
                var photo_name = 'phantom_test.png';
                if(message != '') 
                    photo_name = message;
                page.render(photo_name);
                break;
        }
    }
    else
       output_phantom.errors.push(msg);
};

function inject_scripts()
{
    // Inject jquery and our additional script if they don't exist
    // Would like to be able to overwrite an older version of jQuery
    if(page.evaluate(function () { return typeof jQuery;}) == 'undefined')
    {
        if(page.evaluate(function () { return typeof $;}) == 'function') {
            console.log("'$' symbol already used.");
        }
        else
        {
            if (!page.injectJs("/../../jquery.js")) {
                console.log("jQuery not loaded...");
                phantom.exit();                
            }
        }
    } 

    // Inject scripts that allow communication using fn onConsoleMessage
    if (!page.injectJs("/../lf_additional.js")) {
        console.log("Additional scripts not loaded...");
        phantom.exit();                
    }
}

function run_phantom(url, fn/* args here, just not seen */)
{
    var extra_args = [].slice.call(arguments, 2);

    page.open(url, function (status) {
        // if (status !== 'success') {
        //     console.log('Unable to load the url! (URL: '+url+')');
        //     phantom.exit();
        // }
        // else 
        // {
            inject_scripts();
            output_phantom = {errors: [], results: null}; 

            // run our js code inside the headless browser.
            extra_args.unshift(page, fn);
            evaluate.apply(this, extra_args);
        // }
    });
}

function get_links_from_pages(url, url_selector_jquery, turn_page_jquery)
{
    var fn = function(url_selector_jquery, turn_page_jquery) 
             {
                var results = [];
                var i = 0; 

                var interval = setInterval(function() 
                    {
                        // Photograph page right before selecting values
                        phantom_render('ph_scjd_'+i+'.png');

                        var selected_data = eval(url_selector_jquery);

                        //
                        results.push(selected_data);

                        // Try to turn the page
                        eval(turn_page_jquery);

                        // Get the first 4 pages
                        if(i >= 3) {
                            phantom_return(results);
                            clearInterval(interval);
                        }
                        i++;

                    }, 3000);
             };
    return run_phantom(url, fn, url_selector_jquery, turn_page_jquery);
}

//////////////////////////////////////////////////////////
// Other stuff

// Improved json parsing
(function() {

    var parse = JSON.parse;

    JSON = {

        stringify: JSON.stringify,

        validate: function(str) {

            try {
                parse(str);
                return true;
            } catch(err){
                return err;
            }
        },

        parse: function(str) {

            try {
                return parse(str);
            } catch(err){
                return undefined;
            }
        }
    }
})(); 
```

**注入的文件“additional.js”：**

```
/* 
 *  These are additional scripts intended to make selection of multiple elements
 *  much more concise.
 */

$.fn.click_link = function() {
     simulateMouseClick(this.selector);
};

$.fn.collect = function(fn) {
    var values = [];

    if (typeof fn == 'string') {
        var prop = fn;
        fn = function() { return this.attr(prop); };
    }

    $(this).each(function() {
        var val = fn.call($(this));
        values.push(val);
    });
    return values;
};

$.fn.multiAttr = function(attrName) {
    return this.collect(attrName);
};

// .text() should be pretty close, except concatenated?
$.fn.multiHtml = function() {
    var val_array = this.collect(function() { return this.html(); });
    return val_array;
};

$.fn.multiVal = function() {
    return this.multiAttr('value');
};

// The commented out code is much more concise, but probably less efficient
// $(arr1).not(arr2).length == 0 && $(arr2).not(arr1).length == 0
jQuery.extend({
    compareArray: function (arrayA, arrayB) {
        if (arrayA.length != arrayB.length) { return false; }
        // sort modifies original array
        // (which are passed by reference to our method!)
        // so clone the arrays before sorting
        var a = jQuery.extend(true, [], arrayA);
        var b = jQuery.extend(true, [], arrayB);
        a.sort(); 
        b.sort();
        for (var i = 0, l = a.length; i < l; i++) {
            if (a[i] !== b[i]) { 
                return false;
            }
        }
        return true;
    }
});

function simulateMouseClick(selector) { 
    var targets = document.querySelectorAll(selector), 
        evt = document.createEvent('MouseEvents'), 
        i, len; 
    evt.initMouseEvent("click", true, true, window, 0, 0, 0, 0, 0, false, false, false, false, 0, null); 

    for ( i = 0, len = targets.length; i < len; ++i ) { 
        targets[i].dispatchEvent(evt);     
    }
}

function send_console_command(type, message)
{
    var msg = {};

    if(!message) message = '';

    msg.message    = message;
    msg.type       = type;
    msg.validation = 'phantom_js_communicator';

    console.log(JSON.stringify(msg));
}

function phantom_exit() {
    send_console_command('exit');
}

function phantom_message(msg) {
    send_console_command('message', msg);
}

function phantom_return(return_val) {
    send_console_command('return_value', return_val);
}

function phantom_render(photo_name) {
    send_console_command('render', photo_name);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:54:47.450

[是不是](http://code.google.com/p/phantomjs/wiki/Interface#viewportSize_%28object%29)：

```
var page = require('webpage').create();
page.viewportSize = { width: 1366, height: 768 }; 
```

未经测试，只是阅读文档。

# iphone - 使用 componentsSeparatedByString 在 Objective-C 中解析字符串的错误结果

> ID：11000591
> 
> 赞同：1
> 
> 时间：2012-06-12T16:14:08.797
> 
> 标签：iphone, objective-c, xcode

我正在尝试解析字符串*fileString*：

```
"contact1;12312312;John\ncontact2;34243442;Bill\n"

NSArray* lines = [fileString componentsSeparatedByString:@"\n"]; 
```

在调试器数组*行*由**3 个对象**组成。为什么？

[行数] 必须是 2，但**为什么它等于 3**？

```
NSString* line1 = [lines objectAtIndex:0];
NSString* line2 = [lines objectAtIndex:1];
NSString* line3 = [lines objectAtIndex:2]; 
```

*第 1 行是“联系人 1； 12312312*；约翰”。

*第2*行是“contact2;34243442;Bill”。

*line3*具有类型 (_NSCFConstantString *) 并且在调试器中不显示值。

后来我使用这个数组作为tableView的数据源，所以我需要一个正确的数组计数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T16:18:18.323

输入字符串有两个分隔符，因此结果数组有三个条目

1.  在第一个 \n 之前
2.  \n之间
3.  在最后一个 \n 之后

在这种情况下，第三个是一个空字符串（长度为 0 的 NSString）

来自[NSString 文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)

> 同样，如果字符串以分隔符开头或结尾，则第一个或最后一个子字符串分别为空。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T16:57:30.213

如果您想在将数组用作数据源之前对其进行调整，有几种简单的方法可以清理数据，例如：

```
NSString *csvString = @"Joe\nJane\nPaul\n";

// Cleaning by removing last newline
csvString = [csvString stringByReplacingOccurrencesOfString:@"\\n$" withString:@"" options:NSRegularExpressionSearch range:NSMakeRange(0, csvString.length)];

NSArray *lines = [csvString componentsSeparatedByString:@"\n"];

// Cleaning by removing all empty lines
lines = [lines filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"length > 0"]]; 
```

当然，您只需要其中一种清理操作，它们都可以进行调整以适应您的特定输入数据。

# ios - 从 Iphone 中的谷歌地图列出可能的位置

> ID：11000593
> 
> 赞同：0
> 
> 时间：2012-06-12T16:14:30.200
> 
> 标签：ios, google-maps-api-3, geolocation

我正在尝试构建一个将显示用户当前位置的应用程序。我已经通过使用反向地理编码完成了这项工作，并且我得到了用户当前位置的正确地址。但现在我想获取与用户在搜索框中输入的位置匹配的所有可能位置。另外我只想在表格视图中显示位置名称，而不是在地图上。谢谢。

# asp.net - 在哪里加载动态用户控件？

> ID：11000595
> 
> 赞同：0
> 
> 时间：2012-06-12T16:14:34.583
> 
> 标签：asp.net, user-controls, webforms

我正在尝试从内容页面加载用户控件，但它加载了两次......我读过这是由于 AutoEvent 属性设置为 true。不幸的是，页面在此设置关闭的情况下无法正常工作，所以有没有一种不同的方法可以加载控件，不会被触发两次？

# php - php while循环中的重复项

> ID：11000603
> 
> 赞同：2
> 
> 时间：2012-06-12T16:15:20.717
> 
> 标签：php, mysql, while-loop

我从数据库中获取了一堆 id - 对于每个 id，我想做一个 mysql 查询来获取另一个表中的相关行。虽然我还需要为登录的用户获取类似的数据，但这工作正常。使用我正在使用的 mysql 查询 - 它根据最初提取的 id 复制登录的用户数据。这是有道理的，虽然不是我想要的。我不希望登录用户的重复数据，我需要来自一个查询的数据，这样我就可以使用时间戳订购东西。

```
<?php
    mysql_select_db($database_runner, $runner);
    $query_friends_status = "SELECT DISTINCT rel2 FROM friends WHERE rel1 = '" . $_SESSION    ['logged_in_user'] . "'";
    $friends_status = mysql_query($query_friends_status, $runner) or die(mysql_error());
    $totalRows_friends_status = mysql_num_rows($friends_status);

    while($row_friends_status = mysql_fetch_assoc($friends_status))
    {
        $friends_id = $row_friends_status['rel2'];
        mysql_select_db($database_runner, $runner);
        $query_activity = "SELECT * FROM activity WHERE user_id = '$friends_id' OR user_id = '" .  $_SESSION['logged_in_user'] . "' ORDER BY `timestamp` DESC LIMIT 15";
        $activity = mysql_query($query_activity, $runner) or die(mysql_error());
        $totalRows_activity = mysql_num_rows($activity);
        echo "stuff here";
    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:24:21.537

您可以尝试这个单一查询，看看它是否满足您的需求

```
$userID = $_SESSION['logged_in_user'];
"SELECT * FROM activity WHERE user_id IN (
    SELECT DISTINCT rel2 FROM friends 
    WHERE rel1 = '$userID')
OR user_id = '$userID' ORDER BY `timestamp` DESC LIMIT 15"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:24:34.203

你可能想要这样的东西：

```
 $user = $_SESSION['logged_in_user'];
  $query_friends_status = "SELECT * FROM friends, activity WHERE activity.user_id = friends.rel2 AND rel1 = '$user' ORDER BY `timestamp` DESC LIMIT 15"; 
```

您可以将 * 替换为您想要的字段，但请记住将表名放在字段名之前，例如：

table_name.field_name

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-18T11:53:40.183

```
 <?php
    require_once "connect.php";

    $connect = @new mysqli($host, $db_user, $db_password, $db_name); 
    $result = $connect->query("SELECT p.name, p.user, p.pass, p.pass_date_change,p.email, p.pass_date_email, d.domain_name, d.domain_price, d.domain_end, d.serwer, d.staff, d.positioning, d.media FROM domains d LEFT JOIN persons p 
    ON d.id_person = p.id AND d.next_staff_id_person != p.id");

    if($result->num_rows > 1)
    {   
    while($row = $result->fetch_assoc())
    {

echo '<td class="box_small_admin" data-column="Imię i nazwisko"><div class="box_admin">'.$row["name"].'</div></td>';
echo '<td class="box_small_admin" data-column="Domena"><div class="box_admin">'.$row["domain_name"].'</div></td>';          
}}
?> 
```

# perl - 使用 perl 上传文件

> ID：11000604
> 
> 赞同：2
> 
> 时间：2012-06-12T16:15:21.947
> 
> 标签：perl, upload, automation

您能否建议一些方法来完成将文件上传到网站的任务。单击上传按钮后，文件浏览窗口打开。在选择文件时，它被上传。**没有页面刷新**

这是上传按钮的 html 代码：

```
<div id="upload-import-link" class="qq-upload-button string-file-import" style="position: relative; overflow: hidden; direction: ltr;">
<input type="file" multiple="multiple" name="file" style="position: absolute; right: 0pt; top: 0pt; font-family: Arial; font-size: 118px; margin: 0pt; padding: 0pt; cursor: pointer; opacity: 0;">
</div> 
```

这是单击上传按钮时的 POST 请求/响应：

**响应标头**

```
Connection  keep-alive
Content-Encoding    gzip
Content-Length  97
Content-Type    text/html
Date    Tue, 12 Jun 2012 16:10:46 GMT
Server  Apache
Vary    Accept-Encoding 
```

**请求标头**

```
Accept  text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding gzip, deflate
Accept-Language en-us,en;q=0.5
Connection  keep-alive
Content-Length  51
Content-Type    application/octet-stream
Cookie  __utma=15051113.842126841.1338136284.1339431202.1339515554.17; __utmz=15051113.1338136284.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmv=15051113.customer|1=l=%2Fstring%2Fauth%2Fform%2F=1; mp_super_properties=%7B%22all%22%3A%20%7B%22%24initial_referrer%22%3A%20%22http%3A//mygengo.com/string/auth/form/%22%2C%22%24initial_referring_domain%22%3A%20%22mygengo.com%22%2C%22mp_name_tag%22%3A%20%22hitenny%20%3Chitenny@gmail.com%3E%22%2C%22translator%22%3A%20%220%22%7D%2C%22events%22%3A%20%7B%7D%2C%22funnels%22%3A%20%7B%7D%7D; MintUnique=1; _chartbeat2=z6ana05w3hf1zj7u.1338136288894.1339517190647.00000000000001; myG_last_visit=1338169443; myG_last_activity=1338826430; WRUID=0; ki_u=0e6659b9-ae82-145c-fe0f-662e130e2629; ki_t=1338169390734%3B1338821597245%3B1338826464592%3B3%3B22; MintUniqueMonth=1338476400; myG_myGSession=gSIDOJ%2Bt7MKGDkhsbGvQLBdo6N9w%2BUTX8R8Ab6FXZYFwyexnE2oc91UOPr5kmhL9rhfGfgHuUIDvO88XRnrAsgNom3BYapudUZgsG9LaeJznQUz%2Fl2O23wCQGnoKpQx%2BbFZ01UoGUdeoe2DlZeRUoQZybYLg3tElZhZpnAa%2Byc6ZUxkPoNbDWNjMN8dx9oEhZVbccOILVe71sow2UcFD%2FuCWoZ9PLqn3yy%2FxpTlM5CkcAgzPDhx4pYmP%2BMmBowB5uprGvHtnzedX0O1TJzEItXH7Fkn9Jqvef1O41xI0Sc7FmQk6%2FPvTaDjiV%2FYaj9Yl7pLM7PDBn624MEUhDrpS9fZdKn%2F8jCP0irqGueE88hLoS29WvmglpKR9pTKLikTdGjlj0gp9vraKWgtXYxAZPsHOW54TryjBkGguCQQ8xDe01zDi3AzR6XY30z5kh%2FNyT3aoLLu4l0D3zva9dDR%2F7mH67Q%2FaGBWGIOi10iWxrm2vf%2B2kP%2BTY8BKKxaDizyuS%2FqeaA%2BOSHF7JxuWUsy%2FFjMiH0OPiv706WoscyEg1Tpw%2F8MM2XOXe0aoaNJARxdkg8dqGc0hinijGGm4CrX58wBos08VuSIDZqEs0j6pH0Y%2BCTZK9Zqp4QR1tI%2FwkKH8I2QhT3edY8AwuWaL63Y8zCkPEjY0NIkg3ghcg3Y7fltDwr0Eb9G28cKU2TaFix1eOwToIUY9n%2FxtqEChz5qAniXYs71kDQCW8E9IghXKLx%2FhIpgESntp0UB9WGWnrXuSB; myG_myGEE2=onWxzY3JSmo%252B5IZJoRCWtaORPx1G%252F8FoZp2rGOMT9Qyw8gV6piPHcs%252BwZy50Z0I5c8M8646XcYI52a3Y2%252B%252B9Zm%252F8LKIJTzV31lELYqIrDmn4U%252F6McIe1DZ4MzhWeTIZMP976REP4OsSgl2MSurrRlqrr%252BGUum2GRIiym3a42M8OGfldcB9srNL6EKGGVKoPXJPII57mI2Hdnn%252FzQGR6%252FG4x11VCIO3cceVwM2tJqwkqj1xtPiw2q8YPdkJk%252BYMxfTLWABnow9BS3YtSG2rMZYMaiTEnGnzJ8vEBIUThH7WGOjNU%252FPSO8beKVYph3tJ9XqwLPTAG9LXrjuQXi1%252B4bthgvUjPxdUhROMeqkkmwLZSfW72JQUfV3Dh5lzmfRLr3yfXDb3WAPTJ265aGApx5fYTb%252B0wkoi6NGh52P0gBWtEU11%252FXEmsrQu8NXVNoU870X8Z%252FW1nXdRJmU8qUNDr8T9S2CVpNJ1VdrfLbhw7eX5BPw8J2AyZnPfGgdxbj7eWk1e%252BbO1PHAx%252FSycAB3ZSm9%252BBUYcGjKefoL0PsauuBtF%252BP42Gb3oJoxPfkWqESeLFlsZsJMy7bs9vN3fymfbOpdg%253D%253D; myG_TrackingID=223.235.210.6031066401324182719160536834612890008944fccde5b5e93f7.44148718; __utmb=15051113.40.10.1339515554; __utmc=15051113; _SUPERFLY_nosample=1
Host    mygengo.com
Referer http://mygengo.com/string/p/perl-test-1/admin/languages/import/en
User-Agent  Mozilla/5.0 (Windows NT 6.1; rv:12.0) Gecko/20100101 Firefox/12.0
X-File-Name 1.php
X-Requested-With    XMLHttpRequest 
```

我探索了一些方法，例如`WWW::Selenium`. 但它有一个限制，它只能在 Firefox 3 等中工作。请提出一些方法来实现这一点。

**编辑**

我试过这段代码：

```
my $file = 'D:\oDesk\MyGengo Integration\1.php';
my $url = 'http://mygengo.com/string/p/perl-test-1/admin/languages/import/en';
my $req = POST $url, Content_Type => 'form-data', 
                          Content => [
                                      submit => 1,
                                      upfile => [ $file ]
                                     ];
my $response = $ua->request($req); 
```

这给出了这个错误：

```
Can't locate object method "POST" via package "http://mygengo.com/string/p/perl-test-1/admin/languages/import/en" 
(perhaps you forgot to load "http://mygengo.com/string/p/perl-test-1/admin/languages/import/en"?) at D:\oDesk\MyGengo Integration\myGengoIntegration line 124.
(in cleanup) Error requesting http://localhost:5555/selenium-server/driver/:
500 Can't call method "FETCH" on an undefined value 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T14:20:59.080

您可以使用 perl CGI 脚本来执行此任务。

以下文章详细解释了所有步骤： [http ://www.sitepoint.com/uploading-files-cgi-perl/](http://www.sitepoint.com/uploading-files-cgi-perl/)

# c# - 如何在 Silverlight 中制作垂直自动收报机？

> ID：11000607
> 
> 赞同：3
> 
> 时间：2012-06-12T16:15:38.983
> 
> 标签：c#, .net, wpf, silverlight

我有一个项目列表，我想慢慢垂直滚动，直到鼠标悬停在项目列表上。然后，将出现一个滚动条。我坚持的部分是让列表不断循环的效果的最佳方式。因此，如果您有：

```
-----
A
B
C
D
E
----- 
```

它会滚动并看起来像这样：

```
----
D
E
A
B
C
---- 
```

有没有办法让我在没有两个集合的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:00:45.593

你可以这样做：

```
 ObservableCollection<string> myList;
    public MainPage()
    {
        InitializeComponent();
        myList = new ObservableCollection<string>();
        myList.Add("A");
        myList.Add("B");
        myList.Add("C");
        myList.Add("D");
        myList.Add("E");

        System.Threading.Timer t = new System.Threading.Timer(new System.Threading.TimerCallback(TimerFired));
        t.Change(500, 500);

        listBox2.ItemsSource = myList ;          
    }

    private void TimerFired(object sender)
    {
        Pop();
    }
    private delegate void PopDelegate();
    private void Pop()
    {
        if (this.Dispatcher.CheckAccess())
        {
            string item = myList[myList.Count - 1];
            myList.RemoveAt(myList.Count - 1);
            myList.Insert(0, item);

        }
        else
        {
            this.Dispatcher.BeginInvoke(new PopDelegate(Pop), null);
        }
    } 
```

# java - 从 Java 应用程序启动进程

> ID：11000609
> 
> 赞同：0
> 
> 时间：2012-06-12T16:15:43.117
> 
> 标签：java, playframework, wkhtmltopdf

我或多或少知道如何做到这一点，但我认为由于缺乏经验，我对这个命令的复杂性感到厌烦。

我正在尝试将一些原始 html 输入到`wkhtmltopdf`. 我可以像这样从命令行执行此操作：

```
echo "<p>Hello</p>" | wkhtmltopdf - ~/somePdf.pdf 
```

这很好，但我如何从 Java 应用程序中做到这一点？这是我尝试过的几件事：

```
String[] cmd = { "echo", html.body(), "|", "wkhtmltopdf", "-", "/home/sam/yourPdf.pdf" };
Runtime.getRuntime().exec(cmd); 
```

或者

```
Runtime.getRuntime().exec("echo " + html.body() + " | wkhtmltopdf - /home/sam/yourPdf.pdf"); 
```

这些都不会在我的主文件夹中生成文件。

我已经读过`wkhtmltopdf`它将输出到 STDERR，但我不确定如何从 Eclipse 中查看它。有人告诉我它应该在我的控制台视图中可用，但我在那里看不到任何东西。

任何帮助表示赞赏，谢谢！

**编辑**

接受的答案适用于`wkhtmltopdf`，但适用于使用 Play 的任何人！框架谁找到这个帖子，[有一个Play！](https://github.com/joergviola/play20-pdf)基于 Scala 模板生成 PDF 的[模块。](https://github.com/joergviola/play20-pdf)它工作得很好，但[不要忘记`media="print"`在你的样式表](https://stackoverflow.com/questions/10998602/no-styles-applied-using-play-2-0-pdf-module)中设置:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:23:57.357

您不能直接执行此操作，因为您正在运行两个命令并创建了一个管道。`Runtime.exec()`和方法都不`ProcessBuilder.command()`是为此而设计的。仍然从 Java 中实现类似于此的最简单方法是将所有这些东西放入一个 shell 脚本并使用`Runtime.exec()`.

编辑：您也可以跳过 shell 脚本并调用

```
Runtime.getRuntime().exec( new String[] { "bash", "-c", "\"echo \"<p>Hello</p>\ | wkhtmltopdf - ~/somePdf.pdf\""} ); 
```

这样可以节省您编写 shell 脚本的时间，但您可能需要稍微调整一下引号才能使其正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:32:58.650

您可以尝试这样的操作将错误流输出到控制台：

```
try{
    Runtime runTime= Runtime.getRuntime();
    Process process= runTime.exec("echo " + html.body() + " | wkhtmltopdf - /home/sam/yourPdf.pdf");

    BufferedReader reader   = new BufferedReader(new InputStreamReader(process.getErrorStream()));
    String line = null;
    while ( (line = reader.readLine()) != null){
        System.err.println(line);
    }
}catch(Exception exe){
    exe.printStackTrace();
} 
```

请注意，这是特定于获取打印到错误流的内容。我希望这有助于您入门

# sql - vb.net 中的 SQL JOIN 错误

> ID：11000614
> 
> 赞同：1
> 
> 时间：2012-06-12T16:15:57.423
> 
> 标签：sql, sql-server-2008, vb.net-2010

我有这个 sql 字符串：

```
Dim sqlQuery As String = "SELECT TOP 1 ID, FName, FoodGroup, Calories, Protein, Carbohydrates, Fat, category.ID" &
        " FROM food where Protein<='" & txtProt.Text.ToString() & "' and FoodGroup = 4 " & "and category.ID = 1 " & "JOIN foodCategory ON food.ID = foodCategory.Food_ID" & "JOIN category ON foodCategory.Category_ID = category.ID " & "ORDER BY NEWID() " 
```

我想做的是：我想从表“食物”中输入值“FName”到一个文本框，其中表“类别”的“ID”字段为 1。

我有 3 张桌子。第一个是餐桌食品，第二个是餐桌类别，第三个是 foodCategory。表 foodCategory 具有从前 2 个表到一对多关系的 ID。我收到以下错误：JOIN 附近的语法不正确。我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:19:40.243

您的查询不正确，必须在 FROM 子句中设置 JOIN，而不是在 WHERE 子句中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:20:45.390

尝试以下查询

```
dim sqlQuery As String 
sqlQuery = "SELECT TOP 1 ID, FName, FoodGroup, Calories, Protein, " & _
           "Carbohydrates, Fat, category.ID " &_
           "FROM food JOIN foodCategory ON " & _
           "food.ID = foodCategory.Food_ID JOIN category ON " & _
           "foodCategory.Category_ID = category.ID " & _
           "where Protein<='" & txtProt.Text.ToString() & "' and " & _
           "FoodGroup = 4 and category.ID = 1 " & _
           "ORDER BY NEWID() " 
```

此外，您应该查看**Parameter**因为您的代码很容易受到**SQL 注入**的影响！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T16:19:29.853

这可能是你的串联：

```
... foodCategory.Food_ID" & "JOIN category ... 
```

将评估为

```
foodCategory.Food_IDJOIN category 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T16:23:26.090

您的 JOIN 必须在 WHERE 子句之前：

```
 " FROM food" & " JOIN foodCategory ON food.ID = foodCategory.Food_ID" & "JOIN category ON       foodCategory.Category_ID = category.ID " & " WHERE Protein<='" & txtProt.Text.ToString() & "'  and FoodGroup = 4 " & "and category.ID = 1 " & " ORDER BY NEWID() "; 
```

# python - 将 2 值元组添加到 dict 作为 key:value

> ID：11000616
> 
> 赞同：8
> 
> 时间：2012-06-12T16:16:01.460
> 
> 标签：python

我有一个元组，`('key1', 'value1')`我想将它添加到字典中，所以它就像`{'key1': 'value1'}`但不做类似`dictionary[t[0]] = t[1]`.

上下文如下，我有一个重复规则，如下所示：

```
FREQ=WEEKLY;UNTIL=20120620T233000Z;INTERVAL=2;BYDAY=WE,TH 
```

我想要一个像这样的字典：

```
recurrence = {
    'freq' : 'weekly',
    'until' : '20120620T233000Z',
    'interval' : '2',
    'byday' : 'we,th'
} 
```

我正在做这样的事情：

```
for rule in recurrence.split(';'):
    r = rule.split('=')
    rules[r[0]] = r[1] 
```

而且我一点也不喜欢。有没有更蟒蛇的方式呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T16:21:59.337

使用理解：

```
rules.update(rule.split('=', 1) for rule in recurrence.split(';')) 
```

这是如果 dict`rules`已经存在；否则使用

```
rules = dict(rule.split('=', 1) for rule in recurrence.split(';')) 
```

这是有效的，因为`dict`构造函数和`dict.update`两者都接受产生键/值对的迭代器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:20:43.893

该`dict`函数会将您的元组元组转换为键：值字典。这个怎么样，

```
t=((1,2),(3,4))
dict(t)
{1:2,3:4} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T16:21:45.093

使用字典理解：

```
>>> strs="FREQ=WEEKLY;UNTIL=20120620T233000Z;INTERVAL=2;BYDAY=WE,TH"
>>> dic={key: value for key, value in (rule.split("=") for rule in strs.split(";"))}
>>> print(dic)

{'BYDAY': 'WE,TH', 'FREQ': 'WEEKLY', 'INTERVAL': '2', 'UNTIL': '20120620T233000Z'} 
```

# c++ - C++ 中的委托（或类似的东西）

> ID：11000620
> 
> 赞同：2
> 
> 时间：2012-06-12T16:16:12.477
> 
> 标签：c++, delegates

在 C++ 中，我有：

```
//Base1.h
#ifndef BASE1_H
#define BASE1_H
#include <iostream>
#include <string>
#include "Base2.h"

using namespace std;

class Base1{
    private:
        string name;
    public:
        Base1(string _name);
        void printSomething();
        string getName();
};
#endif 
```

在`Base1.cpp`我实现构造函数`Base1(string _name)`和`string getName()`正常情况下，并且`printSomething()`：

```
void Base1::printSomething(){
    Base2 b2;
    // how to pass a parameter in the following code?
    b2.printBase1();
}

// This is Base2.h
#ifndef BASE2_H
#define BASE2_H

#include <iostream>
#include <string>
#include "Base1.h"

using namespace std;

class Base2{
    public:
      Base2();
      void printBase1(Base1 b);
};
#endif 
```

我`Base2()`像往常一样实现构造函数，这是我的`printBase1(Base1 b)`：

```
void Base2::printBase1(Base1 b){
    cout << b.getName();
} 
```

所以，最后，我想`printSomething()`在`Base1`课堂上使用，但我不知道如何在我的代码中将参数传递给上面的 in `b2.printBase1()`。在 C++`printSomething()`中有什么类似的东西吗？`b2.printBase1(this)`如果没有，你能给我一个建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:18:16.127

由于`this`是 C++ 中的指针，因此您需要取消引用它：

```
b2.printBase1(*this); 
```

请注意，您有循环包含，您应该`#include "Base2.h"`从`Base1.h`. 还要查看通过 ( `const`) 引用传递参数，尤其是对于非 POD 类型，否则您可能无法获得预期的行为。

例如，您的签名是

```
void printBase1(Base1 b); 
```

当您调用它时，您会在函数中创建参数的副本，从而对副本进行操作。您应该将其更改为：

```
void printBase1(Base1& b); 
```

或者

```
void printBase1(const Base1& b); //if you don't change b 
```

仅当您确定**需要**副本时才传递值。

# android - 无法使用连接打印机 Zebra MZ 220 的方法

> ID：11000621
> 
> 赞同：1
> 
> 时间：2012-06-12T16:16:18.840
> 
> 标签：android, zebra-printers

我有以下代码可以使用我的 android 2.3.7 在我的 zebra mz 220 中打印：

```
public class Printing extends Activity {
ProgressDialog dialog;
ZebraPrinterConnection zebraPrinterConnection;
ZebraPrinter zebra;
String mac;

Handler handlerWorking = new Handler(){
    @Override
    public void handleMessage(Message msg){
        String returnedValue = (String)msg.obj;
        //textV.setText("Returned by thread Circle:" + returnedValue);
    }
};

Handler handlerDone = new Handler(){
    @Override
    public void handleMessage(Message msg){
        String returnedValue = (String)msg.obj;
        //textV.setText(returnedValue);
    }
};

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    Bundle bundle = this.getIntent().getExtras();
    String mac = bundle.getString("param1");
    this.mac = mac;

    System.out.println(mac);
    showDialog(0);
    //finish();
}

@Override 
public Dialog onCreateDialog(int id){
    final Runnable threadMethod = new Runnable() {
        public void run(){
            try{
                connect();
            }catch(Throwable e){

            }
            Message msg = handlerDone.obtainMessage(1, "DONE!!!");
            handlerDone.sendMessage(msg);
            dialog.dismiss();
        }
    };

    dialog = new ProgressDialog(this);
    dialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
    dialog.setMessage("Loading...");
    Thread thread = new Thread(null, threadMethod, "Thread1");
    thread.start();
    return dialog;
}

public void connect() {
    Looper.prepare();
    zebraPrinterConnection = null;
    zebraPrinterConnection = new BluetoothPrinterConnection(mac);

    try {
        zebraPrinterConnection.open();
    } catch (ZebraPrinterConnectionException e) {
        disconnect();
    }

    if (zebraPrinterConnection.isConnected()) {
        try {
            zebra = ZebraPrinterFactory.getInstance(zebraPrinterConnection);
            sendLabel();
        } catch (ZebraPrinterConnectionException e) {
            zebra = null;
            disconnect();
        } catch (ZebraPrinterLanguageUnknownException e) {
            zebra = null;
            disconnect();
        }
    }
    Looper.loop();
    Looper.myLooper().quit();
}

public void disconnect() {
    try {
        if (zebraPrinterConnection != null) {
            zebraPrinterConnection.close();
        }
    } catch (ZebraPrinterConnectionException e) {

    } 
}

private byte[] getLabel() {
    PrinterLanguage printerLanguage = zebra.getPrinterControlLanguage();
    byte[] configLabel = null;
    if (printerLanguage == PrinterLanguage.ZPL) {
        configLabel = "^XA^FO17,16^GB379,371,8^FS^FT65,255^A0N,135,134^FDTEST^FS^XZ".getBytes();
    } else if (printerLanguage == PrinterLanguage.CPCL) {
        String cpclConfigLabel = "! 0 200 200 50 1\r\n" + "ON-FEED IGNORE\r\n" + "T 5 0 0 0 Hola\r\n" + "PRINT\r\n";
        configLabel = cpclConfigLabel.getBytes();
    }
    return configLabel;
}

private void sendLabel() {
    try {
        byte[] configLabel = getLabel();
        zebraPrinterConnection.write(configLabel);
    } catch (ZebraPrinterConnectionException e) {

    } finally {
        disconnect();
    }
} 
```

问题是我的 logCat 上出现了下一个错误：

```
06-12 11:08:03.327: E/AndroidRuntime(14323): FATAL EXCEPTION: main
06-12 11:08:03.327: E/AndroidRuntime(14323): java.lang.VerifyError: com.api.printer.zebra.Printing
06-12 11:08:03.327: E/AndroidRuntime(14323):    at java.lang.Class.newInstanceImpl(Native Method)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at java.lang.Class.newInstance(Class.java:1409)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1672)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1784)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at android.app.ActivityThread.access$1500(ActivityThread.java:123)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:939)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at android.os.Handler.dispatchMessage(Handler.java:99)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at android.os.Looper.loop(Looper.java:130)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at android.app.ActivityThread.main(ActivityThread.java:3835)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at java.lang.reflect.Method.invokeNative(Native Method)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at java.lang.reflect.Method.invoke(Method.java:507)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
06-12 11:08:03.327: E/AndroidRuntime(14323):    at dalvik.system.NativeStart.main(Native Method) 
```

如果我注释掉 disconnect 方法、sendLabel 方法和 getLabel 方法，应用程序不会崩溃，但会出现下一个错误行：

```
06-12 11:13:35.207: E/dalvikvm(15869): Could not find class 'com.zebra.android.comm.BluetoothPrinterConnection', referenced from method com.api.printer.zebra.Printing.connect 
```

我的引用库中有斑马库（ZSDK_API.jar），发生了什么？谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:31:29.917

根据您使用的 ADT 版本（如果您确实在使用 Eclipse），如果您使用的是最新版本，则将 ZSDK_API.jar 放在您的 libs/ 目录中就足够了。这应该被 Android 构建过程所接受。然后，jar 应该会自动显示在您的 Android 项目的 Android Dependencies 库中。

检查此 URL 以获取更多信息：[http ://android.foxykeep.com/dev/how-to-fix-the-classdefnotfounderror-with-adt-17](http://android.foxykeep.com/dev/how-to-fix-the-classdefnotfounderror-with-adt-17)

# javascript - Facebook wordpress 插件 - 我如何加载 jssdk 并调用 FB.init 而不会与其他 facebook 小部件发生任何冲突

> ID：11000622
> 
> 赞同：0
> 
> 时间：2012-06-12T16:16:22.727
> 
> 标签：javascript, facebook, wordpress, facebook-javascript-sdk, xfbml

我正在开发一个 Wordpress 插件，其中用户在管理部分设置自己的 Facebook 应用程序 ID，并使用该应用程序 ID 在前端调用 Facebook API。这是我的步骤：我异步加载 jssdk，然后在 window.fbAsyncInit = function() { .. } 中调用 FB.init 和 FB.getLoginStatus。

我的问题是：我怎样才能以最好的方式做到这一点，这样我就不会与可能包含在同一页面中的其他一些小部件发生任何冲突？

在某些情况下，我收到此消息：“FB.init 已被调用 - 这可能表明存在问题”。我试图添加 FB._initialized = false; 在 FB.init 之前 - 消息消失了，但流程仍然不是正确的。

你能给我任何指示吗？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T19:14:54.707

根据您想要执行的用途，也许您可​​以在加载的 iframe 中执行操作。这将使您在那里所做的一切“独立”，并且仍然在当前页面上显示。

# python - Python重载多个getitems / index请求

> ID：11000623
> 
> 赞同：9
> 
> 时间：2012-06-12T16:16:27.343
> 
> 标签：python, operator-overloading

我有一个`Grid`类，我想使用`myGrid[1][2]`. 我知道我可以用该方法重载第一组方括号`__getitem__()`，但是第二组呢。

我认为我可以通过拥有一个也实现的辅助类来实现这一点`__getitem__`，然后：

```
class Grid:

    def __init__(self)
        self.list = A TWO DIMENSIONAL LIST       

    ...

    def __getitem__(self, index):
        return GridIndexHelper(self, index)

class GridIndexHelper:

    def __init__(self, grid, index1):
        self.grid = grid
        self.index1 = index1

    ....

    def __getitem__(self, index):
        return self.grid.list[self.index1][index] 
```

这似乎有点太自制了......实现这一目标的python方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-12T16:24:33.273

```
class Grid:

    def __init__(self):
        self.list = [[1,2], [3,4]]

    def __getitem__(self, index):
        return self.list[index]

g = Grid();

print g[0]
print g[1]
print g[0][1] 
```

印刷

```
[1, 2]
[3, 4]
2 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-10-01T02:59:08.600

据我所知，anajem 提到的方式是唯一的方法。

例子：

```
class Grid(object):

def __init__(self):
    self.list = [[1, 2], [3, 4]]

def __getitem__(self, index):
    return self.list[index[0]][index[1]]

if __name__ == '__main__':
    mygrid = Grid()
    mygrid[1, 1] #How a call would look 
```

打印：4

不完全按照您的意愿操作，但在我眼中可以做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T21:21:38.040

你可以把索引变成一个元组： def **getitem** (self,indexTuple): x, y = indexTuple ...

并访问对象覆盖：instance[[2,3]]
或 instance[(2,3)]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-17T16:06:35.267

这个问题很老了，但无论如何我都会为新手添加我的答案。
我自己也遇到了这种需求，这是一个对我有用的解决方案：

```
class Grid:

    def __init__(self):
        self.matrix = [[0,1,2],[3,4,5],[6,7,8]]
        self.second_access = False

    def __getitem__(self, key):
        if not self.second_access:
            self.first_key = key
            self.second_access = True
            return self
        else:
            self.second_access = False
            return self.matrix[self.first_key][key]

g = Grid()
print(g[1][2])  # 5
print(g[0][1])  # 1
print(g[2][0])  # 6 
```

**请注意，这不适用于单次访问！**
因此，例如，如果您想使用某种形式的东西`g[0]`来获取`[0,1,2]`它，它将不起作用，相反，您会得到无意义的结果（对象本身）。

# c# - c# 在单独的函数中将 DataRow 添加到表中

> ID：11000624
> 
> 赞同：0
> 
> 时间：2012-06-12T16:16:27.950
> 
> 标签：c#, asp.net

我需要在表格中添加一些“总行数”。我目前用于小计的代码是：

```
DataRow shRow = ds.Tables[0].NewRow();
shRow["a"] = "SubHead";
shRow["b"] = "Wheel Subs";
shRow["c"] = totalWheels; 
```

由于我需要总计、小计和小计，我必须为每个新的小计剪切并粘贴此代码（更改值）。

我想要一个函数来获取当前表和值并添加新行。就像是：

```
public DataRow SubRow(DataTable ResultsTable, string SubHead, string SubHeader, string SubHeadValue) 
```

然后将更新主函数中的表。

谢谢你的帮助。我只是无法在新函数之间“传递”表格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:23:54.240

> 我想要一个函数来获取当前表和值并添加新行

```
public DataTable CreateNewRow(DataTable ResultsTable, String ColumnA, 
      String ColumnB, String ColumnC, String ColumnAVal, String ColumnBVal, 
      String ColumnCVal)
{
    DataRow shRow = ResultsTable.NewRow();
    shRow[ColumnA] = ColumnAVal;
    shRow[ColumnB] = ColumnBVal;
    shRow[ColumnC] = ColumnCVal;
    ResultsTable.Rows.Add(shRow);
    return ResultsTable; 
}

using(DataTable ResultsTable = CreateNewRow
                               (
                                  ds.Tables[0], 
                                  "a",
                                  "b",
                                  "c",
                                  "SubHead", 
                                  "Wheel Subs", 
                                  totalWheels
                               ))
{
      //Your logic
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:19:11.507

那有什么问题？

```
public DataRow SubRow(DataTable resultsTable, string subHead, string subHeader, string subHeadValue)
{
    DataRow shRow = resultsTable.NewRow();
    shRow["a"] = subHead;
    shRow["b"] = subHeader;
    shRow["c"] = subHeadValue;
    return shRow;
} 
```

用法：

```
DataRow shRow = SubRow(ds.Tables[0], "SubHead", "Wheel Subs", totalWheels); 
```

顺便说一句，这不会将该行添加到表中，而只会创建一个可以适当地放入表中的行。如果您确实想将该行添加到表中，您可以执行以下操作：

```
DataRow row = ds.Tables[0].Rows.Add("SubHead", "Wheel Subs", totalWheels); 
```

这会将具有给定值的行添加到数据表的 Add 方法中，并返回已添加的行。

# c++ - 水平撕裂 DirectX9

> ID：11000627
> 
> 赞同：1
> 
> 时间：2012-06-12T16:16:48.327
> 
> 标签：c++, image, video, directx

我一直在尝试使用顶点着色器和像素着色器（非常基本的）在 Win7 下使用 DirectX9 开发视频捕获显示应用程序。但是，显示的图像显示出一些撕裂，总是在屏幕上的同一位置。规格如下

*   正在通过网络摄像头捕获视频
*   显示器未处于全屏模式
*   屏幕刷新率为60Hz
*   D3DPRESENT_INTERVAL_ONE 用于强制刷新率良好（在某些论坛上找到，但不起作用）

我尝试用所有可用的参数修改最后一个参数，以实现 D3DPRESENT_INTERVAL_ONE 给我一个一致的（总是在屏幕上的相同位置）撕裂。

我知道“启用”垂直同步可能会解决我的问题，但我似乎无法在网上找到任何有关此的信息（是的，我知道，DirectX9 已经过时了），所以任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T20:19:30.010

`D3DPRESENT_INTERVAL_DEFAULT`如果它不会让您流泪，请使用。

此标志还启用垂直同步。从文档：

> D3DPRESENT_INTERVAL_DEFAULT 使用默认系统计时器分辨率，而 D3DPRESENT_INTERVAL_ONE 调用 timeBeginPeriod 以增强系统计时器分辨率。这提高了垂直同步的质量，但会消耗更多的处理时间。两个参数都尝试垂直同步。

# security - Joomla 网站被黑，索引文件没有被替换

> ID：11000629
> 
> 赞同：0
> 
> 时间：2012-06-12T16:16:53.207
> 
> 标签：security, joomla

我们在这里有一个 Joomla 1.5 站点：http: [//printversal.com](http://printversal.com)

昨晚被黑了 所有代码都在那里。只是索引文件被替换了。替换旧的索引文件不显示任何内容。

任何人都可以指出任何看的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:19:01.497

不仅仅是 index.php 受到影响。我会考虑恢复备份中的*所有*文件，并可能回滚数据库备份（如果有的话）——Joomla 的大部分行为取决于可能受到攻击的数据库值。

关于升级到 2.5 的通常咆哮适用，但我个人知道这并不总是那么简单。

# asp.net-mvc - 移动 MVC - 原生移动应用程序视图

> ID：11000636
> 
> 赞同：2
> 
> 时间：2012-06-12T16:16:58.483
> 
> 标签：asp.net-mvc, mobile, cross-platform

计划使用 ASP.NET MVC 4 为我们的产品创建一个新网站。网站应支持桌面、平板电脑和少数移动平台（WP7、IOS、Android）。

我们是否需要为每个平台创建视图，如下所示？或者拥有多个平台和屏幕支持的最佳首选方法是什么

桌面 -> 视图/共享/Logon.cshtml

平板电脑 - > 视图/共享/LogonTablet.cshtml

移动 - > 视图/共享/LogonMobile.cshtml

谢谢， 维卢斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:18:56.593

签出 ASP.NET MVC 4[显示模式](http://www.asp.net/whitepapers/mvc4-release-notes#_Toc303253810)。它们允许您基于用户代理呈现特定视图。如果您需要使用 ASP.NET MVC 3 [，可以使用 NuGet](http://www.hanselman.com/blog/NuGetPackageOfTheWeek10NewMobileViewEnginesForASPNETMVC3SpeccompatibleWithASPNETMVC4.aspx)，它与即将发布的 ASP.NET MVC 4 规范兼容。

# c++ - gcc 库以使用更新的库

> ID：11000637
> 
> 赞同：0
> 
> 时间：2012-06-12T16:17:01.790
> 
> 标签：c++, proxy, shared-libraries

我有一个小问题，我猜这是不可能的，但永远不知道！

我正在为 Maya 开发插件，它仍然使用 gcc-4.1.2 编译。但我想用新的 C++0x 编码。是否可以编译和创建我的共享对象（让我们称之为 X.so），然后通过共享对象（调用 X_proxy.so）将我的函数映射到 X.so 中，但由具有较旧架构的程序使用.

结构将是：Maya -> X_proxy.so -> X.so！

X_proxy 只是将呼叫转发到 X.so。这样，使用新工具进行开发并使其与旧工具（或使用旧工具的最新工具）兼容会很容易。

编辑：我看到的另一个解决方案可能是使用最新版本的 g++ 编译 *.cpp.o 文件中的 *.cpp 文件，然后使用旧版本的 g++ 来链接它们。那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:28:09.420

只要名称映射OK，没有代理就可以了。您需要确保将要使用的 Maya 头文件与更现代的编译器一起使用，但希望这不会成为问题并尝试一下。共享对象不必与加载它们并调用函数的程序使用相同的编译器进行编译或使用相同的语言编写。

# weblogic - 哪个版本的 weblogic 服务器不会创建 _wls_cls_gen.jar？

> ID：11000638
> 
> 赞同：1
> 
> 时间：2012-06-12T16:17:05.423
> 
> 标签：weblogic, weblogic-10.x, weblogic11g

因为这个 _wls_cls_gen.jar 会为读取 WEB-INF/classes 文件夹中的属性或 xml 文件造成问题。我试过 10.3.4 但没有运气。谁能告诉他们哪个版本解决了这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:35:57.550

您可以尝试查看过滤类加载器。此外，10.3.4 包括可以帮助您配置它的 ClassLoader Analysis Tool：[https ://blogs.oracle.com/jeffwest/entry/weblogic_1034_classloader_analysis_tool](https://blogs.oracle.com/jeffwest/entry/weblogic_1034_classloader_analysis_tool)

# security - 使用 SHA1 和 + salt bcrypt 加密密码？

> ID：11000643
> 
> 赞同：1
> 
> 时间：2012-06-12T16:17:25.143
> 
> 标签：security, cryptography, passwords, sha1, bcrypt

如果我使用 SHA1 加密密码，然后向其中添加盐，然后使用 bcrypt 对其进行加密。是否比我在未加密的密码中添加盐盐然后用 bcrypt 加密更安全？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-14T14:29:43.997

在将密码传递给 bcrypt 之前计算密码的 SHA-1 哈希不会提供任何额外的安全性。

充其量，它会保留 bcrypt 的安全性。将 SHA-1 应用于初始密码既不会增加任何额外的熵，也不会以任何方式扩大结果的范围，因此结果的安全性充其量只能与 bcrypt 本身一样好。

但[Antoine Joux](http://math.boisestate.edu/~liljanab/MATH509Spring2012/JouxAttackSHA-1.pdf)的研究表明，情况可能比这更糟。对于多重冲突，您甚至可能会削弱安全性，从而使生成的方案比单独使用 bcrypt*更不安全。*

一般来说，最好按照规定使用密码原语。这至少为您提供了一点保证结果将是安全的 - 手动添加到方案中“以改进”事情几乎总是会以比原来更不安全的方式结束。

# xslt-1.0 - XSLT 1.0/XSL:FO - 如何在出现特定子节点时重置编号

> ID：11000655
> 
> 赞同：0
> 
> 时间：2012-06-12T16:18:04.037
> 
> 标签：xslt-1.0, xsl-fo

我有包含一系列步骤的 XML。我正在尝试在出现标题时重置步骤编号。

*   每个步骤将包含一个或多个“para”元素。

*   每个步骤可以可选地包含一个“标题”元素。

*   每个步骤都应该收到一个连续的编号，但是当出现标题时，步骤编号应该重新开始。

这需要使用 XSLT 1.0/XSL:FO 来完成。

**XML**：

```
<top>
    <Step>
        <title>Toilet Paper Holder</title>
        <para>It holds toilet paper.</para>
        <para>It holds 1 roll.</para>
    </Step>
    <Step>
        <para>It is red.</para>
    </Step>
    <Step>
        <para>It is metal.</para>
    </Step>
    <Step>
        <title>Toilet</title>
        <para>You sit on it.</para>
    </Step>
    <Step>
        <para>It is white.</para>
    </Step>
    <Step>
        <para>It is porcelain.</para>
    </Step>
</top> 
```

**XSL**：

```
<xsl:template match="Step">
    <xsl:apply-templates/>
</xsl:template>

<xsl:template match="title">
    <fo:block>
        <xsl:apply-templates/>
    </fo:block>
</xsl:template>

<xsl:template match="para">
    <fo:block>
        <xsl:if test="not(preceding-sibling::para)">
            <xsl:number count="Step[child::para]" from="top" format="1."/>
        </xsl:if>
        <xsl:text> </xsl:text>
        <xsl:apply-templates/>
    </fo:block>
</xsl:template> 
```

**电流输出**：

```
Toilet Paper Holder
1\. It holds toilet paper.
It holds 1 roll.
2\. It is red.
3\. It is metal.
Toilet
4\. You sit on it.
5\. It is white.
6\. It is porcelain. 
```

**期望的输出**：

```
Toilet Paper Holder
1\. It holds toilet paper.
It holds 1 roll.
2\. It is red.
3\. It is metal.
Toilet
1\. You sit on it.
2\. It is white.
3\. It is porcelain. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T19:43:17.140

这是产生所需输出的 ​​xslt。

**XSL：**

```
<xsl:template match="Step">
    <xsl:apply-templates/>
</xsl:template>

<xsl:template match="title">
    <fo:block>
        <xsl:apply-templates/>
    </fo:block>
</xsl:template>

<xsl:template match="para">
    <fo:block>
        <xsl:if test="not(preceding-sibling::para)">
            <xsl:call-template name="StepNumbering">
                <xsl:with-param name="format" select="'1.'"/>
            </xsl:call-template>
        </xsl:if>
        <xsl:text> </xsl:text>
        <xsl:apply-templates/>
    </fo:block>
</xsl:template>

<xsl:template name="StepNumbering">
    <xsl:param name="format" select="'1.'"/>
    <xsl:for-each select="parent::Step">
        <xsl:choose>
            <xsl:when test="title">
                <xsl:number value="1" format="{$format}"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:variable name="Step_id">
                    <xsl:for-each select="preceding-sibling::Step[title][1]">
                        <xsl:value-of select="generate-id(.)"/>
                    </xsl:for-each>
                </xsl:variable>
                <xsl:variable name="StepNumber" 
                select="count(preceding-sibling::Step
                [generate-id(preceding-sibling::Step[title][1]) = $Step_id] 
                | preceding-sibling::Step[title][1])+1"/>
                <xsl:number value="$StepNumber" format="{$format}"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:for-each>
</xsl:template> 
```

# ios - 如何从给定的捆绑包 ID 中获取 Apple App ID？

> ID：11000667
> 
> 赞同：5
> 
> 时间：2012-06-12T16:18:54.673
> 
> 标签：ios, app-store

我有一个 Apple 应用程序 bundleIds 列表（例如 com.facebook.Facebook）。我最终想要实现的是使用 iTunes 元数据丰富这些数据，这些元数据可通过 iTunes 搜索 API 获得：http: [//www.apple.com/itunes/affiliates/resources/documentation/itunes-store-web-service -search-api.html](http://www.apple.com/itunes/affiliates/resources/documentation/itunes-store-web-service-search-api.html)

如果我知道应用程序 ID（技术上是“trackId”），我可以获得特定应用程序的特定信息，如下所示：http: [//itunes.apple.com/lookup](http://itunes.apple.com/lookup?id=284882215) ?id=284882215（284882215 是脸书应用程序）

但是，我不能以相同的方式使用 bundleId。给定bundleId，如何系统地检索应用程序ID（又名trackId）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-10-18T00:47:28.033

这应该有效：

`curl https://itunes.apple.com/lookup\?bundleId\=com.facebook.Facebook`

在结果中，您应该看到如下内容：

> ```
>  "trackViewUrl": "https:\/\/itunes.apple.com\/us\/app\/facebook\/id284882215?mt=8&uo=4", 
> ```
> 
> "bundleId": "com.facebook.Facebook",
> 
> “trackId”：**284882215**，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-10T21:38:50.780

根据[大卫理查森的](https://stackoverflow.com/a/46801221/617864)回答，这是我稍微修改过的版本，它使用[jq](https://stedolan.github.io/jq/)解析 JSON 并仅提取 App ID：

```
$ myApp=WireGuard
$ bID=$(mdls -name kMDItemCFBundleIdentifier -r "/Applications/${myApp}.app")
$ curl -s "https://itunes.apple.com/lookup?bundleId=${bID}" | jq -r '.results[0].trackId'
1451685025 
```

# python - 如何在执行期间获取python脚本的用户名

> ID：11000673
> 
> 赞同：2
> 
> 时间：2012-06-12T16:19:12.833
> 
> 标签：python, linux

假设有一个脚本 sth.py

当我使用“root”帐户登录时。类型 ：

```
python sth.py 
```

我想得到结果：'root'

输入时`sudo -u work python sth.py`，我想得到结果：'work'

如何得到它？

谢谢~

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T16:22:52.837

```
import getpass
getpass.getuser() 
```

使用环境变量的解决方案通常是不可移植的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:20:18.153

在 linux 上，环境变量 LOGNAME 和 USER 应该被设置：

```
import os
print os.environ['LOGNAME'] 
```

# android - 在 ICS 上几分钟没有调用 Android AsyncTask

> ID：11000680
> 
> 赞同：4
> 
> 时间：2012-06-12T16:19:38.577
> 
> 标签：android, android-asynctask, threadpool, android-4.0-ice-cream-sandwich

我有一个使用大量 AsyncTasks 的应用程序，我遇到的问题是在我调用执行后的几分钟内没有启动一个特别重要的任务。

如果我将以下内容用于我的 ICS 设备，它可以工作；

```
if(Build.VERSION.SDK_INT >= 11)
{
  myTask.executeOnExecutor( AsyncTask.THREAD_POOL_EXECUTOR, stuff );
} 
```

与 pre-ICS 不同；

```
myTask.execute(stuff); 
```

我知道 ICS 已将线程执行更改为序列化，但我无法弄清楚是什么阻碍了线程队列。

在 Eclipse 中的调试中列出了大约 20 个线程，但我已经阅读过，这可能是不正确的，因为调试器倾向于继续显示那些实际上并不存在的线程。

我如何确定哪些线程正在阻止序列化队列，这样我就不必从 ICS 上的默认值切换，甚至可能提高由于线程池执行器而没有看到问题的前 ICS 设备的性能是默认行为。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T17:15:09.647

> 如何确定哪些线程正在占用序列化队列

添加语句以跟踪相关方法`Log`的进入和退出。`doInBackground()`

> 甚至可能提高由于线程池执行器是默认行为而没有看到问题的前 ICS 设备的性能。

你不需要使用`AsyncTask`. 只需 fork 自己的线程并使用类似的东西`runOnUiThread()`作为在主应用程序线程上执行逻辑的手段。`AsyncTask`是方便，不是要求。而且，对于异常的高优先级任务，让您远离任何线程池争用可能更有意义。

或者，克隆和分叉`AsyncTask`以使用 a `PriorityQueue`，这样您就可以明确指出您的高优先级任务。

# php - 使用 AJAX 数据创建评论页面选择

> ID：11000686
> 
> 赞同：0
> 
> 时间：2012-06-12T16:19:59.197
> 
> 标签：php, javascript, ajax, codeigniter

我决定走 AJAX 路线，主要是为了学习它，看看它是如何工作的。我想为超过 10 个帖子的评论添加页面选择。

我正在使用 Codeigniter，并将发布到目前为止的内容：

控制器：

```
 public function updatefilters()
    {
        $this->blurb_model->create_session_filter($_POST['filters']);
        $this->blurb_model->get_threads($_POST['pagenum']);
    } 
```

模型：

```
 public function get_threads($page = 0)
    {
            $NEEDPAGEHERE = $page
            [fetch threads]
            [return threads / count / etc]
    } 
```

所以我的目标是向用户显示页数。这部分完成了。我根据“get_threads”模型中返回的项目总数为每个页面显示了一个提交按钮（为了相关性而省略了代码）。

这是我的 AJAX/javascript

重点在于 updatefilter 函数。我使用返回的线程列表来构造 HTML 并将其发布到 div 中。这工作正常。

问题是当用户单击页面按钮时我想重用 updatefilters() 函数......但它不起作用。我想将提交按钮的值传递给 updatefilter(pagenum) 以便它然后转到控制器 - >方法，我可以做数学运算，但它不起作用。

Javascript：

```
 function updatefilters(pagenum){
        // get the selected filters
        var html;
        var i = 0;
        if (!pagenum)
            {
                pagenum = 0
            }
        var $selected = $('#selectable').children('.ui-selected');
        // create a string that has each filter separated by a pipe ("|")
        var filters = $selected.map(function(){return this.id;}).get().join("\|");
        $.ajax({
            type: "POST",
            async: false,
            url: 'welcome/updatefilters',
            dataType: 'json', 
            data: { filters: filters, pagenum: pagenum },
            success: function(data){
                var html = "";
                html += "<div id=board>"
                html += "<div class='board' id='table'>"
                html += "<div id='row'>header here</div>"

                var pages = Math.ceil(data['num_threads']/10);
                var htmlpage = "<div class='pages'>"
                for (i=1 ; i < pages+1 ; i++)
                    {
                        htmlpage += "<li><input type='submit' id='page"+i+"' value='"+i+"' onclick='updatefilters(this.value);' /></li>"
                    }
                htmlpage += "<div>"    
                htmlpage += "</ul>";
                htmlpage += "</br></br></br>";
                html += htmlpage;

                for (i=0 ; i < data['threads'].length ; i++)
                {
                    html += "<div id=row>";
                    html += "   <div id='author' style='background: url("+data['threads'][i].location + ") no-repeat; background-position: center;'><p>"+data['threads'][i].username + "</p></div>";
                    html += "   <div id='arrow'></div>";
                    html += "   <div id='subject' title='"+ data['threads'][i].body +"'>";
                    html += "       <a href=thread/" + data['threads'][i].slug + ">"+ data['threads'][i].subject +"</a><p>Created: "+data['threads'][i].posttime+"</p></div>";                    
                    html += "   <div id='info'>";
                    html += "       <div id='replies'>" + data['threads'][i].replies_num + "</div>";
                    html += "       <div id='lastpost'>"+ data['threads'][i].lastreply+"</div>";
                    html += "   </div>";
                    html += "</div>";
                }
                html += "</div></div>";
                $('#board').html(html);
            }
        });
    } 

$(function() {
    $( "#selectable" ).selectable({
        selected: updatefilters  
    });
    getactivesession();
    function getactivesession(ev, ui){
        var i = 0;
        var actfilter, strfilter;
        var strfilterarray = new Array();
        $.ajaxSetup({cache: false})
        $.ajax({
        type: "POST",  
        async: false,
        url: 'welcome/getactivesession', 
        dataType: 'json',
        success: function (data){
            strfilter = JSON.stringify(data)
            strfilterarray = strfilter.split(',')
            for (i=0 ; i < strfilterarray.length ; i++) {
                strfilter = strfilterarray[i]
                strfilter = strfilter.replace(/[\[\]'"]+/g,'');
                var strfilterdash = strfilter.replace(/\s+/g, '-')
                actfilter = '#'+ strfilterdash
                $(actfilter).addClass('ui-selected')
            }
            updatefilters();
        }
        });
    }
}); 
```

这对我自己来说将是一次难以置信的学习经历，如果有人能够发现问题并以易于理解的方式解释它，那么这将是一个巨大的帮助。我对 javascript 和一般编程非常陌生（这可能解释了代码的丑陋）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:52:35.643

修改您的`selected`事件回调。

```
$("#selectable").selectable({
  // Here is the event callback signature for reference
  selected: function(event, ui) {
    updatefilters();
  }
}); 
```

您将意外的第一个参数传递给`updatefilters`函数。

# regex - Haskell Alex - 正则表达式匹配错误的字符串？

> ID：11000700
> 
> 赞同：2
> 
> 时间：2012-06-12T16:20:54.440
> 
> 标签：regex, haskell, lexical-analysis, alex

我正在尝试为基于缩进的语法编写词法分析器，但在匹配缩进时遇到了麻烦。

这是我的代码：

```
{
module Lexer ( main ) where

import System.IO.Unsafe
}

%wrapper "monadUserState"

$whitespace = [\ \t\b]
$digit      = 0-9                                            -- digits
$alpha      = [A-Za-z]
$letter     = [a-zA-Z]                                       -- alphabetic characters
$ident      = [$letter $digit _]                             -- identifier character
$indent     = [\ \t]

@number     = [$digit]+
@identifier = $alpha($alpha|_|$digit)*

error:-

@identifier { mkL LVarId }

\n $whitespace* \n { skip }
\n $whitespace*    { setIndent }
$whitespace+       { skip }

{

data Lexeme = Lexeme AlexPosn LexemeClass (Maybe String)

instance Show Lexeme where
    show (Lexeme _ LEOF _)   = "  Lexeme EOF"
    show (Lexeme p cl  mbs) = " Lexeme class=" ++ show cl ++ showap p ++ showst mbs
      where
        showap pp = " posn=" ++ showPosn pp
        showst Nothing  = ""
        showst (Just s) = " string=" ++ show s

instance Eq Lexeme where
    (Lexeme _ cls1 _) == (Lexeme _ cls2 _) = cls1 == cls2

showPosn :: AlexPosn -> String
showPosn (AlexPn _ line col) = show line ++ ':': show col

tokPosn :: Lexeme -> AlexPosn
tokPosn (Lexeme p _ _) = p

data LexemeClass
    = LVarId
    | LTIndent Int
    | LTDedent Int
    | LIndent
    | LDedent
    | LEOF
    deriving (Show, Eq)

mkL :: LexemeClass -> AlexInput -> Int -> Alex Lexeme
mkL c (p, _, _, str) len = return (Lexeme p c (Just (take len str)))

data AlexUserState = AlexUserState { indent :: Int }

alexInitUserState :: AlexUserState
alexInitUserState = AlexUserState 0

type Action = AlexInput -> Int -> Alex Lexeme

getLexerIndentLevel :: Alex Int
getLexerIndentLevel = Alex $ \s@AlexState{alex_ust=ust} -> Right (s, indent ust)

setLexerIndentLevel :: Int -> Alex ()
setLexerIndentLevel i = Alex $ \s@AlexState{alex_ust=ust} -> Right (s{alex_ust=(AlexUserState i)}, ())

setIndent :: Action
setIndent input@(p, _, _, str) i = do
    --let !x = unsafePerformIO $ putStrLn $ "|matched string: " ++ str ++ "|"
    lastIndent <- getLexerIndentLevel
    currIndent <- countIndent (drop 1 str) 0 -- first char is always \n
    if (lastIndent < currIndent) then
        do setLexerIndentLevel currIndent
           mkL (LTIndent (currIndent - lastIndent)) input i
    else if (lastIndent > currIndent) then
        do setLexerIndentLevel currIndent
           mkL (LTDedent (lastIndent - currIndent)) input i
    else alexMonadScan
  where
    countIndent str total
        | take 1 str == "\t" = do skip input 1
                                  countIndent (drop 1 str) (total+1)
        | take 4 str == "    " = do skip input 4
                                    countIndent (drop 4 str) (total+1)
        | otherwise = return total

alexEOF :: Alex Lexeme
alexEOF = return (Lexeme undefined LEOF Nothing)

scanner :: String -> Either String [Lexeme]
scanner str =
    let loop = do
        tok@(Lexeme _ cl _) <- alexMonadScan
        if (cl == LEOF)
            then return [tok]
            else do toks <- loop
                    return (tok:toks)
    in runAlex str loop

addIndentations :: [Lexeme] -> [Lexeme]
addIndentations (lex@(Lexeme pos (LTIndent c) _):ls) =
    concat [iter lex c, addIndentations ls]
  where iter lex c = if c == 0 then []
                     else (Lexeme pos LIndent Nothing):(iter lex (c-1))
addIndentations (lex@(Lexeme pos (LTDedent c) _):ls) =
    concat [iter lex c, addIndentations ls]
  where iter lex c = if c == 0 then []
                     else (Lexeme pos LDedent Nothing):(iter lex (c-1))
addIndentations (l:ls) = l:(addIndentations ls)
addIndentations [] = []

main = do
    s <- getContents
    return ()
    print $ fmap addIndentations (scanner s)

} 
```

问题是在 line 中`\n $whitespace* { setIndent }`，正则表达式匹配错误的字符串并`setIndent`使用这个错误的字符串调用。出于调试目的，我添加`unsafePerformIO`了`setIndent`函数，这是程序的示例运行：

```
begin       
        first indent
|matched string: 
        first indent
                second indent
                second indent
dedent
dedent
|
|matched string: 
                second indent
dedent
|
|matched string: 
dedent
|
|matched string: 
|
Right [ Lexeme class=LVarId posn=1:1 string="begin", Lexeme class=LIndent posn=1:6, Lexeme class=LVarId posn=2:15 string="indent", Lexeme class=LIndent posn=2:21, Lexeme class=LDedent posn=3:30, Lexeme class=LDedent posn=3:30, Lexeme class=LVarId posn=4:1 string="dedent",  Lexeme EOF] 
```

所以`setIndent`被称为不仅仅是空格。并且在它返回用于缩进的词位之后，字符串的其他部分被省略。

这是亚历克斯的错误吗？或者我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T11:30:23.940

所以我没有详细分析你的代码，但我确实注意到了这一点：

```
setIndent :: Action
setIndent input@(p, _, _, str) i = do
    --let !x = unsafePerformIO $ putStrLn $ "|matched string: " ++ str ++ "|" 
```

请注意，这`str`是输入的其余部分，而不仅仅是当前标记。要获取当前令牌，您需要`take i str`. 也许这给您的印象是令牌匹配的输入比实际更多。

当然，我们在 GHC 自己的词法分析器中处理缩进，因此您可能想在[那里寻找想法](https://github.com/ghc/ghc/blob/master/compiler/parser/Lexer.x)（尽管您可能期望它相当大和复杂）。

# ruby-on-rails - 使用 ActiveAdmin 在仪表板中自动刷新

> ID：11000701
> 
> 赞同：5
> 
> 时间：2012-06-12T16:20:59.820
> 
> 标签：ruby-on-rails, activeadmin

我正在 Rails 中开发一个应用程序，它充当网络和应用程序监视器。我使用 Active Admin Dashboard 作为主页，显示我网络中每台服务器和一些应用程序的状态。我想将仪表板页面配置为每 x 分钟自动刷新一次，但我不知道在哪里配置此设置，因为我无法完全控制仪表板呈现的 html。有没有人设法做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T16:58:43.273

在**config/initializers/active_admin.rb**你可以注册 javascripts：

```
config.register_javascript "/javascripts/admin-auto-refresh.js" 
```

然后创建一个 admin-auto-refresh.js 来做这件事。

您还需要在 config/environments/production.rb 中注册 admin-auto-refresh.js

```
config.assets.precompile += "admin-auto-refresh.js" 
```

更新：

添加了一些代码以在 5 秒后刷新页面。将此添加到`/javascripts/admin-auto-refresh.js`

```
$(function() {
  setTimeout(location.reload(true), 5000);
}) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T14:58:55.870

这是最终代码，非常感谢@JesseWolgamott。

```
$(function() {
var sPath = window.location.pathname;
    var sPage = sPath.substring(sPath.lastIndexOf('/') + 1);
    if (sPage == 'admin'){
        setTimeout("location.reload(true);", 10000);
    }
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-07T16:31:51.200

下面是在页面不闪烁的情况下刷新的代码。它是通过在页面中至少有一个带有 needs_updating 类标记的元素来启用的。在加载的任何 javascript 中包含此代码片段，然后在页面上的任何位置添加标记。

唯一的缺点是这只会更新页面的 html 正文。

例如

```
show do |my_model| 
  ...
  if my_model.processing?
    row :status, class: 'needs_updating' do
      'we are working on it...'
    end
  else
    row :status do
      'ready'
    end
  end
  ....
end 
```

所以如果模型仍在处理，那么你会得到类标签“needs_updating”，这将导致下面的javascript每10秒被调用一次

```
 jQuery(document).ready(function($) {
    if ($('.needs_updating').length > 0) {
      console.log("we need some updating soon");
      var timer = setTimeout(function () {
        console.log("re-loading now");
        $.ajax({
          url: "",
          context: document.body,
          success: function(s,x) {
              $(this).html(s);
              if ($('.needs_updating').length == 0) {
                clearInterval(timer);
              }
          }
        });
      }, 10000)
    }
  }) 
```

# java - 将数据传递到 jquery 的 getJSON() 时出现问题 - 不接受地图

> ID：11000702
> 
> 赞同：1
> 
> 时间：2012-06-12T16:21:10.980
> 
> 标签：java, javascript, jquery, getjson, illegalargumentexception

我正在尝试序列化我的表单（JSP/Struts 1.1）并将其放入对象或映射或任何 jQuery 的 .getJSON() 方法需要的东西中。这是我的js代码：

```
// This function makes an AJAX call, passing the entire form to the Action class
function ajaxCallWithForm(inputURL, formName, onReturnFunction)
{
    var formAsMap = serializeForm(formName);     
    $.getJSON(inputURL, formAsMap, onReturnFunction);
}

function serializeForm(formName)
{
    var obj = {};
    var a = $('#'+formName).serializeArray();

    $.each(a, function() {
        if (obj[this.name] !== undefined) {
            if (!obj[this.name].push) {
                obj[this.name] = [obj[this.name]];
            }
            obj[this.name].push(this.value || '');
        } else {
            obj[this.name] = this.value || '';
        }
    });

    return obj;
} 
```

这会在`java.lang.IllegalArgumentException`后端产生一个（与 BeanUtils.populate servlet 方法有关）。

如果我将 .getJSON() 调用的 3 个参数中的第 2 个设置为这样的参数，它可以正常工作，并且数据会显示在我的 Java 后端的表单对象中：

```
// This function makes an AJAX call, passing the entire form to the Action class
function ajaxCallWithForm(inputURL, formName, onReturnFunction)
{
    $.getJSON(inputURL, {"vehicleKeyNum":12345,
                         "vehicleID":"12345",
                         "rand":Math.random()}, 
        onReturnFunction);
} 
```

我还尝试使用正确的语法创建一个字符串，该字符串包含来自表单的数据并导致相同的结果。我可能有我的语法错误。无论如何，我的主要问题是：

1) .getJSON() 方法接受“随请求发送到服务器的地图或字符串”。作为它的第二个参数（见[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)）

2）我正在传递我认为是“地图”的东西

3）我得到一个`java.lang.IllegalArgumentException`，不知道从这里去哪里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T18:13:32.440

如果你想向服务器提交表单，你可以简单地使用 jQuery 的[serialize()](http://api.jquery.com/serialize/)或[serializeArray()](http://api.jquery.com/serializeArray/)方法。

```
$.getJSON(inputURL, $(formName).serialize(), onReturnFunction); 
```

如果元素名称匹配正确，您应该在表单 bean 中填充 serialize/serializeArray 方法返回的数据。

[这是序列化方法的一个工作示例](http://jsfiddle.net/pd9Ea/)（从 jQuery 网站复制）

`java.lang.IllegalArgumentException`来自`BeanUtils.populate`servlet 方法的原因是提交的数据与表单bean 上的数据之间的数据类型不匹配。

# ruby-on-rails - 无法在 Registries#edit 中找出 ActiveRecord::SubclassNotFound？

> ID：11000703
> 
> 赞同：1
> 
> 时间：2012-06-12T16:21:13.130
> 
> 标签：ruby-on-rails, database-design, activerecord, subclass

在“编辑”或“显示”时出现：

ActiveRecord::SubclassNotFound in Registries#edit

“单表继承机制未能定位子类：‘Plane’。引发此错误是因为‘type’列保留用于存储类以防继承。如果您不打算重命名此列，请重命名它用于存储继承类或覆盖 Present.inheritance_column 以使用另一列存储该信息。”

```
25:   </div>
26:   
27:   <div class="field1">
28:   <%= f.fields_for :presents do |builder| %>
29:   <%= render 'present_fields', f: builder %>
30:   <% end %>
31:   </div> 
```

这是注册表：

```
<%= nested_form_for(@registry) do |f| %>
<% if @registry.errors.any? %>
<div id="error_explanation">
<h2><%= pluralize(@registry.errors.count, "error") %> prohibited this registry from    
being saved:</h2>

  <ul>
  <% @registry.errors.full_messages.each do |msg| %>
    <li><%= msg %></li>
  <% end %>
  </ul>
</div>
<% end %>

<%= f.label :due_date %><br />
<%= f.date_select :due_date, :rows => 5 %>

<%= f.label :theme %><br />
<%= f.text_field :theme, :class => 'field2' %>

<div class="field1">
<%= f.label :gender %><br />
<%= f.text_field :gender %>
</div>

<div class="field1">
<%= f.fields_for :presents do |builder| %>
<%= render 'present_fields', f: builder %>
<% end %>
</div>

<%= link_to_add_fields "Add Presents", f, :presents %>

<div class="actions">
<%= f.submit %>
</div>
<% end %> 
```

礼物字段：

```
<div class="field1">
<table>
<tr> 
<td> <%= f.label :type, "Present Type" %> </td>
<td> <%= f.text_field :type, :class => 'field2' %> </td>
<td> <%= f.label :Quantity, "Quantity" %> </td>
<td> <%= f.number_field :quantity, :class => 'field3' %> </td>
<td> <%= f.label :color, "Color" %> </td>
<td> <%= f.text_field :color, :class => 'field2' %> </td>
<td> <%= f.label :brand, "Brand" %> </td>
<td> <%= f.text_field :brand, :class => 'field2' %> </td>
<td> <%= f.link_to_remove "Remove this present" %></td>
</tr>
</table>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:30:59.267

重命名或覆盖，因为错误说通过类似的方式覆盖

```
set_inheritance_column "not_sti" 
```

来源： http: [//my.safaribooksonline.com/book/web-development/ruby/9780132480345/advanced-active-record/ch09lev1sec5](http://my.safaribooksonline.com/book/web-development/ruby/9780132480345/advanced-active-record/ch09lev1sec5)

# post - 如何让谷歌分析计数弹出帖子

> ID：11000706
> 
> 赞同：0
> 
> 时间：2012-06-12T16:21:37.310
> 
> 标签：post, popup, google-analytics

我有一个 wordpress 网站，您可以在其中以两种方式查看帖子。您可以在他们的单个页面上查看它们，或者您可以从主页单击拇指并在显示完整帖子的 ajax 弹出窗口中查看它们。我的问题显然是 Analytics 没有计算弹出视图。我使用模板弹出帖子，我正在寻找一种方法让分析将其识别为页面视图并告诉我它是什么帖子。我尝试将分析代码添加到模板页面的顶部，但没有做任何事情。有任何想法吗？我使用 SimpleModal jquery 插件来弹出帖子并像这样调用它们。

```
jQuery(document).ready(function() {
jQuery('a.postpopup').live('click', function(){
            var id = jQuery(this).attr('rel');
    jQuery('<div id="ajax-popup"></div>').hide().appendTo('body').load('http://mysite.com/ajax-handler/?id='+id).modal({
               opacity:90,
               position: ["0%"],
               containerCss:{width:"100%"},
               overlayClose:true,
               onOpen: function (dialog) {
             dialog.overlay.fadeIn('200', function () {
          dialog.data.hide();
           dialog.container.fadeIn('500', function () {
        dialog.data.fadeIn('slow');
           });
             });
               },
               onClose: function (dialog) {
             dialog.data.fadeOut('slow', function () {
          dialog.container.hide('500', function () {
        dialog.overlay.fadeOut('200', function () {
            $.modal.close();
        });
          });
            });
              }
            });
            return false;
 });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T15:35:30.333

谷歌分析有几个选项来跟踪非综合浏览量相关的用户活动，我认为你可以在这里使用：

1.  **虚拟综合浏览量**- 如 user273895 所述，您可以在弹出对话框时添加对代码的调用，以在您的报告中看到标题为“/popup/post-name”的“假”综合浏览量
2.  **事件**- 您可以使用事件检测上述调用，例如：_trackEvent("popup", "click", "post-name")。然后可以在事件报告中跟踪交互，并可用于指定其他细分和过滤器以进行更高级的分析。
3.  **自定义变量**- 您可以设置页面或会话级别的自定义变量来记录交互。

我建议前两个选项。就我个人而言，我倾向于将事件用于此类事情，但在您的情况下，使用虚拟网页浏览可能更有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T23:40:36.667

您可以使用[_trackPageView模拟页面视图](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1006243)

# hadoop - 获取 hadoop Reducer 中的总输入路径

> ID：11000711
> 
> 赞同：0
> 
> 时间：2012-06-12T16:21:48.090
> 
> 标签：hadoop, path

我仍然无法弄清楚如何在 hadoop 中获取输入路径的总数。我[在 Hadoop Mapper 中看到了 Get Total Input Path Count](https://stackoverflow.com/questions/10585560/get-total-input-path-count-in-hadoop-mapper)，但不明白。我只是想知道，输入路径中有多少个文件......有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:35:53.250

就像我在引用问题的答案末尾所说的那样，如果您使用的是 hadoop v0.20.203+，那么您可以查询配置属性`mapreduce.input.num.files`

```
long inputFiles = context.getConfiguration().getLong('mapreduce.input.num.files'); 
```

# flurry - Flurry AppCircle Clips：测试期间没有视频？

> ID：11000713
> 
> 赞同：1
> 
> 时间：2012-06-12T16:21:52.743
> 
> 标签：flurry

我最近在玩 Flurry AppCircle Clips SDK，但在我的测试期间，SDK 用完了可以播放的视频......根据他们的常见问题解答，视频频率的上限是由广告商根据他们的每日预算预先确定的。我只能在 24 小时滚动后查看新剪辑。

这很痛苦并且减慢了我的开发速度，有谁知道 Clips SDK 是否有沙盒模式可以播放无限测试视频？如果没有，那么我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T17:22:40.420

Clips 支持测试模式，就像常规的 AppCircle 广告一样。在测试模式下，您不会产生收入，但应该有更多可用的视频，但它不是无限的。目前您无法自行设置，需要联系您的账户经理或 support@flurry.com。

（免责声明：我在 Flurry 开发 Android SDK）

# android - 如何防止Android应用程序锁定？

> ID：11000714
> 
> 赞同：1
> 
> 时间：2012-06-12T16:21:57.970
> 
> 标签：android, locking, sleep, powermanager

我目前正在制作一个需要手机不锁定的Android应用程序，以避免活动失去焦点。

我做了一些研究，发现了很多方法来做到这一点，包括使用：

*   钥匙卫经理
*   电源管理器
*   `getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);`
*   `android:keepScreenOn="true"`

我尝试`android:keepScreenOn="true"`在我的 Android 清单中使用，但它似乎对应用程序没有影响。我对使用电源管理器犹豫不决，因为每篇关于它的帖子都充满了许多警告。

最后，防止Android手机锁定和失去应用程序焦点的最佳方法是什么？只要应用程序保持焦点且手机未锁定，屏幕本身可能会变暗或关闭。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:24:33.053

您可以通过使用带有 Screen Dim Wake Lock 的 PowerManager 轻松实现您想要的。

此外，IIRC，keepScreenOn 应该添加到 XML 文件中的小部件，而不是清单中，如果您最终决定使用它。

# wcf - 安装 AppFabric 后运行 WCF 工作流应用程序时出错

> ID：11000718
> 
> 赞同：3
> 
> 时间：2012-06-12T16:22:02.307
> 
> 标签：wcf, workflow-foundation-4, appfabric

我已经安装了 Windows Server AppFabric，现在我什至无法运行最基本的 WCF 工作流服务应用程序。我已经完成了持久性存储、监视器和缓存的配置和设置数据库，它们工作正常。

所以我把它剥离了，只是创建并运行了一个空的 WCF 工作流服务应用程序。当我单击 Service1.xaml 文件时，出现以下错误。

我已经检查了数据库，并且我拥有对所有数据库的 dbowner 访问权限（在此处替换了我的真实登录详细信息）。

我正在使用带有 .NET 4 更新 1 的 VS2010。

> “/”应用程序中的服务器错误。
> 
> 无法打开登录请求的数据库“AppFabricPersistenceDB”。登录失败。用户“mydomain\myusername”登录失败。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

细节

```
Exception Details: System.Data.SqlClient.SqlException: Cannot open database "AppFabricPersistenceDB" requested by the login. The login failed.
Login failed for user 'mydomain\myusername'.

Source Error: 

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace: 

[SqlException (0x80131904): Cannot open database "AppFabricPersistenceDB" requested by the login. The login failed.
Login failed for user 'mydomain\myusername'.]
   System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) +5064458
   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning() +234
   System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) +2275
   System.Data.SqlClient.SqlInternalConnectionTds.CompleteLogin(Boolean enlistOK) +35
   System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, SqlConnection owningObject) +183
   System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, TimeoutTimer timeout) +239
   System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, TimeoutTimer timeout, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance) +195
   System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance) +232
   System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection) +185
   System.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnection owningConnection, DbConnectionPool pool, DbConnectionOptions options) +33
   System.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject) +524
   System.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject) +66
   System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject) +479
   System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection) +108
   System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory) +126
   System.Data.SqlClient.SqlConnection.Open() +125
   System.Activities.DurableInstancing.SqlCommandAsyncResult.StartCommandInternal(Boolean synchronous) +557
   System.Activities.DurableInstancing.SqlWorkflowInstanceStoreAsyncResult.StartOperation() +377

[InstancePersistenceCommandException: The execution of the InstancePersistenceCommand named {urn:schemas-microsoft-com:System.Activities.Persistence/command}CreateWorkflowOwner was interrupted by an error.]
   System.Runtime.AsyncResult.End(IAsyncResult result) +688590
   System.Runtime.DurableInstancing.InstancePersistenceContext.OuterExecute(InstanceHandle initialInstanceHandle, InstancePersistenceCommand command, Transaction transaction, TimeSpan timeout) +78
   System.Runtime.DurableInstancing.InstanceStore.Execute(InstanceHandle handle, InstancePersistenceCommand command, TimeSpan timeout) +82
   System.ServiceModel.Activities.Dispatcher.DurableInstanceManager.Open(TimeSpan timeout) +294

[CommunicationException: The InstanceStore could not be initialized.]
   System.ServiceModel.Activities.Dispatcher.DurableInstanceManager.Open(TimeSpan timeout) +394
   System.ServiceModel.Activities.WorkflowServiceHost.OnOpen(TimeSpan timeout) +105
   System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout) +318
   System.ServiceModel.HostingManager.ActivateService(String normalizedVirtualPath) +206
   System.ServiceModel.HostingManager.EnsureServiceAvailable(String normalizedVirtualPath) +651

[ServiceActivationException: The service '/Service1.xamlx' cannot be activated due to an exception during compilation.  The exception message is: The InstanceStore could not be initialized..]
   System.Runtime.AsyncResult.End(IAsyncResult result) +688590
   System.ServiceModel.Activation.HostedHttpRequestAsyncResult.End(IAsyncResult result) +190
   System.ServiceModel.Activation.HostedHttpRequestAsyncResult.ExecuteSynchronous(HttpApplication context, String routeServiceVirtualPath, Boolean flowContext, Boolean ensureWFService) +234
   System.ServiceModel.Activation.HttpModule.ProcessRequest(Object sender, EventArgs e) +379
   System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +148
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.272 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T08:58:44.363

AppFabric 配置工具仅在此位置更新 web.config 文件

> C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Config\web.config

像我一样使用“任何 CPU”选项构建时，您必须手动编辑此文件

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\Config\web.config 
```

使用这些设置（来自 Framework64 版本）

```
<connectionStrings>
    <add connectionString="Data Source=(local);Initial Catalog=AppFabricMonitoringDB;Integrated Security=True" name="ApplicationServerMonitoringConnectionString" providerName="System.Data.SqlClient" />
    <add connectionString="Data Source=(local);Initial Catalog=AppFabricPersistenceDB;Integrated Security=True" name="ApplicationServerWorkflowInstanceStoreConnectionString" providerName="System.Data.SqlClient" />
</connectionStrings> 
```

它们以前被设置为默认值

```
<connectionStrings>
    <add connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=AppFabricMonitoringDB;Integrated Security=True" name="ApplicationServerMonitoringConnectionString" providerName="System.Data.SqlClient" />
    <add connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=AppFabricPersistenceDB;Integrated Security=True" name="ApplicationServerWorkflowInstanceStoreConnectionString" providerName="System.Data.SqlClient" />
</connectionStrings> 
```

# internet-explorer-8 - 如何使用 IE8 开发人员工具检查网络流量？

> ID：11000719
> 
> 赞同：28
> 
> 时间：2012-06-12T16:22:02.727
> 
> 标签：internet-explorer-8, ie-developer-tools, network-traffic

如何使用 IE8 开发人员工具检查网络流量？

# 规格：

我需要测试文件是否已加载或加载速度是否缓慢。在 Firefox/Firebug 中，我可以使用`NET`选项卡来做到这一点。

# 限制：

我无法安装其他软件，因此[在 IE8 中检查 http 响应标头中的](https://stackoverflow.com/questions/791642/examine-http-response-headers-in-ie8)答案对我没有用。:( 我在受限制的计算机系统上调试问题并且没有管理员权限。

# 谣言？

我读到根本没有办法使用 IE8 开发人员工具检查网络流量，这是真的吗？

谢谢。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-06-12T16:28:51.337

在[http://blogs.msdn.com/b/ie/archive/2010/04/22/ie9-developer-tools-network-tab.aspx](http://blogs.msdn.com/b/ie/archive/2010/04/22/ie9-developer-tools-network-tab.aspx)它说：

> 开发人员工具包括一些新功能和对 IE8 中工具的改进：
> 
> ```
> A new tab for inspecting network traffic. 
> ```

所以这在 IE8 中是不可能的（即不安装额外的软件）。

就是这样。

# ruby - 在 ruby 中，获取括号中的内容

> ID：11000724
> 
> 赞同：3
> 
> 时间：2012-06-12T16:22:14.297
> 
> 标签：ruby, regex

我有以下字符串：

> Eclipse Developments (Scotland) Ltd t/a Martin & Co (Glasgow South)

我需要得到最后一个（总是最后一个，但有时是唯一的）括号值，所以在这种情况下是“Glasgow South”。

我知道我应该使用`.sub`但无法计算出正确的正则表达式。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-12T16:24:14.860

通常`sub`用于*替换*。你需要的是`scan`：

```
test = "Eclipse Developments (Scotland) Ltd t/a Martin & Co (Glasgow South)"

test.scan(/\(([^\)]+)\)/).last.first
# => "Glasgow South" 
```

`.last.first`奇数调用的原因是`scan`默认返回一个数组数组。您想要最后一场比赛的第一个（也是唯一一个）元素。

翻译那个正则表达式，这对于初学者来说可能很棘手：

```
\(     # A literal bracket followed by...
(      # (Memorize this)
[^)]+  # One or more (+) characters not in the set of: closing-bracket [^)]
)      # (End of memorization point)
\)     # ...and a literal closing bracket. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T16:26:47.580

正则表达式是贪婪的；如果您要求，`.*`它将尽可能匹配。因此，以下将起作用：

```
test = "Eclipse Developments (Scotland) Ltd t/a Martin & Co (Glasgow South)"
test =~ /.*\((.*)\)/
answer = $1
# => "Glasgow South" 
```

# c - 条件变量的实现

> ID：11000725
> 
> 赞同：10
> 
> 时间：2012-06-12T16:22:21.817
> 
> 标签：c, linux, multithreading, gcc, pthreads

为了理解pthread条件变量的代码，我写了自己的版本。它看起来正确吗？我在一个程序中使用它，它的工作，但工作速度惊人的快。最初程序大约需要 2.5 秒，而使用我的条件变量版本只需要 0.8 秒，并且程序的输出也是正确的。但是，我不确定我的实现是否正确。

```
struct cond_node_t
{
    sem_t s;
    cond_node_t * next;
};

struct cond_t
{
    cond_node_t * q;                // Linked List
    pthread_mutex_t qm;                 // Lock for the Linked List
};

int my_pthread_cond_init( cond_t * cond )
{
    cond->q = NULL;
    pthread_mutex_init( &(cond->qm), NULL );
}

int my_pthread_cond_wait( cond_t* cond, pthread_mutex_t* mutex )
{
    cond_node_t * self;

    pthread_mutex_lock(&(cond->qm));
    self = (cond_node_t*)calloc( 1, sizeof(cond_node_t) );
    self->next = cond->q;
    cond->q = self;
    sem_init( &self->s, 0, 0 );
    pthread_mutex_unlock(&(cond->qm));

    pthread_mutex_unlock(mutex);
    sem_wait( &self->s );
    free( self ); // Free the node
    pthread_mutex_lock(mutex);
}

int my_pthread_cond_signal( cond_t * cond )
{
    pthread_mutex_lock(&(cond->qm));
    if (cond->q != NULL) 
    {
        sem_post(&(cond->q->s));
        cond->q = cond->q->next;
    }
    pthread_mutex_unlock(&(cond->qm));
}

int my_pthread_cond_broadcast( cond_t * cond )
{
    pthread_mutex_lock(&(cond->qm));
    while ( cond->q != NULL) 
    {
        sem_post( &(cond->q->s) );
        cond->q = cond->q->next;
    }
    pthread_mutex_unlock(&(cond->qm));
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T23:14:31.940

除了缺少返回值检查之外，还有一些应该修复的问题：

*   `sem_destroy`不叫。
*   信号/广播`cond_node_t`在唤醒目标线程后触摸，可能导致 use-after-free。

进一步评论：

*   省略的销毁操作可能需要更改其他操作，因此当 POSIX 说它应该是安全的时，销毁条件变量是安全的。不支持销毁或对何时调用它施加更严格的限制将简化事情。
*   生产实现将处理线程取消。
*   退出等待（例如线程取消和`pthread_cond_timedwait`超时所需的）可能会导致并发症。
*   您的实现在用户空间中对线程进行排队，出于性能原因，这是在某些生产实现中完成的；我不明白为什么。
*   您的实现始终按 LIFO 顺序对线程进行排队。这通常更快（例如由于缓存效应），但可能导致饥饿。生产实施有时可能会使用先进先出顺序来避免饥饿。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T16:50:17.093

基本上你的策略看起来不错，但是你有一个主要的危险，一些未定义的行为和一个挑剔的选择：

*   您没有检查 POSIX 函数的返回值。特别`sem_wait`是可中断的，因此在重负载或运气不好的情况下，您的线程将被虚假唤醒。你必须仔细捕捉所有这些
*   您的任何函数都没有返回值。如果某天函数的某些用户决定使用返回值，这是未定义的行为。仔细分析条件函数允许返回的错误代码并做到这一点。
*   不要放弃`malloc`或`calloc`

**编辑：**实际上，您根本不需要`malloc`/ `free`。局部变量也可以。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-12T17:55:20.083

您似乎不尊重此要求：

> 这些函数以原子方式释放互斥体并导致调用线程阻塞条件变量 cond；atomically 这里的意思是“原子地相对于另一个线程访问互斥锁，然后是条件变量”。也就是说，如果另一个线程能够在即将阻塞的线程释放后获得互斥锁，那么该线程中对 pthread_cond_broadcast() 或 pthread_cond_signal() 的后续调用将表现得就好像它是在 about-- to-block 线程已阻塞。

你解锁然后等待。另一个线程可以在这些操作之间做很多事情。

PS我不确定自己是否正确解释了这一段，请随时指出我的错误。

# security - 如何计算计算 SHA-256 哈希所需的时间？

> ID：11000736
> 
> 赞同：6
> 
> 时间：2012-06-12T16:23:11.913
> 
> 标签：security, hash, cryptography, sha

我需要在 CPU 速度为 200 MHz 的设备上找到 SHA-256 哈希函数延迟。我怎么能这样做，有没有人知道更快或更慢的设备的答案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-12T22:42:10.493

速度很大程度上取决于实现和 CPU 细节。对预期速度的一个非常粗略的估计是将[每个字节数的周期](http://etutorials.org/Programming/secure+programming/Chapter+4.+Symmetric+Cryptography+Fundamentals/4.14+Timing+Cryptographic+Primitives/)外推到您的特定设备。

[数字](http://www.ouah.org/ogay/sha2/)确实[有所不同](http://www.cryptopp.com/benchmarks.html)，但我们保守一点，假设您的 SHA-256 实现大约需要 25 个周期/字节。取倒数告诉您每个周期获得 1/25 个字节。一个 200 MHz 处理器每秒有 200 个 mio 周期，因此这为您提供了 8 mio 字节/秒的理论吞吐量，即 ~ 7.63 MB/秒。

但这只是一个非常粗略的猜测，如果您想要确切的数字，那么您能做的最好的事情就是自己对整个事物进行基准测试。

# asp.net - 为什么没有为我的自定义角色提供者设置应用程序名称？

> ID：11000737
> 
> 赞同：2
> 
> 时间：2012-06-12T16:23:16.860
> 
> 标签：asp.net, roleprovider

我已经为 ASP.NET 应用程序实现了一个自定义角色提供程序。我从 System.Web.Security.RoleProvider 派生了我的类并实现了所有抽象方法和属性。我在 web.config 中使用 applicationName 配置我的提供程序，à la：

```
 <roleManager enabled="true" defaultProvider="CustomRoleProvider">
  <providers>
    <clear/>
    <add name="CustomRoleProvider" type="MvcApplication1.CustomRoleProvider" applicationName="Foo"/>
  </providers>
</roleManager> 
```

但是，我的提供者的 ApplicationName 属性没有被相应地设置。为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T16:23:18.140

除了实现 System.Web.Security.RoleProvider 中的抽象方法外，您还需要重写该`Initialize()`方法。web.config 中 provider 元素中未被 System.Configuration.ProviderSettings 处理的属性（如 applicationName）通过`Initialize()`. 将以下内容添加到您的实现中，`Initialize()`会将自定义角色提供程序的 ApplicationName 属性设置为 web.config 中 applicationName 属性提供的值：

```
 if (config["applicationName"] != null)
       ApplicationName = config["applicationName"]; 
```

# moodle - 向新用户发送自定义消息？

> ID：11000740
> 
> 赞同：0
> 
> 时间：2012-06-12T16:23:26.220
> 
> 标签：moodle

我想为 Moodle 编写一个模块（插件）来向新用户发送一些消息。

但我不知道如何参与注册操作。

请帮助我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:39:44.840

答案是我不需要挂钩用户创建。只需向 user_created 事件添加一个侦听器以获取更多信息，请参阅： [Events API](http://docs.moodle.org/dev/Events_API#Users)

# python - 关于带有瓶鼻的亚马逊产品 API 的错误

> ID：11000742
> 
> 赞同：0
> 
> 时间：2012-06-12T16:23:27.967
> 
> 标签：python, amazon, bottlenose

我正在为亚马逊产品 API 使用瓶鼻。我只是创建了一些代码并遇到了以下错误：

我创建的代码：

```
ak = "my access key"   
sk = "My secret key"

import bottlenose
amazon = bottlenose.Amazon(ak, sk)
response=amazon.ItemLookup(ItemId="0596520999", ResponseGroup="Images", SearchIndex="Books", IdType="ISBN",Style="http://xml2json-xslt.googlecode.com/svn/trunk/xml2json.xslt") % reference from the README file of bottlenose 
```

这是我得到的错误：

```
Traceback (most recent call last):
  File "C:/Python27/amazontest", line 6, in <module>
    response=amazon.ItemLookup(ItemId="0596520999", ResponseGroup="Images", SearchIndex="Books", IdType="ISBN",Style="http://xml2json-xslt.googlecode.com/svn/trunk/xml2json.xslt")
  File "C:\Users\supercoco\AppData\Roaming\Python\Python27\site-packages\bottlenose\api.py", line 104, in __call__
    response = urllib2.urlopen(api_request)
  File "C:\Python27\lib\urllib2.py", line 126, in urlopen
    return _opener.open(url, data, timeout)
  File "C:\Python27\lib\urllib2.py", line 400, in open
    response = meth(req, response)
  File "C:\Python27\lib\urllib2.py", line 513, in http_response
    'http', request, response, code, msg, hdrs)
  File "C:\Python27\lib\urllib2.py", line 438, in error
    return self._call_chain(*args)
  File "C:\Python27\lib\urllib2.py", line 372, in _call_chain
    result = func(*args)
  File "C:\Python27\lib\urllib2.py", line 521, in http_error_default
    raise HTTPError(req.get_full_url(), code, msg, hdrs, fp)
HTTPError: HTTP Error 400: Bad Request 
```

有谁知道是什么问题？我很欣赏你的回答！

谢谢

-CC

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T13:57:37.640

在

```
amazon = bottlenose.Amazon(ak, sk) 
```

您需要添加第三个参数：服务标签。

```
amazon = bottlenose.Amazon(ak, sk, service_tag) 
```

# ruby-on-rails - 从 Rails 中的模型中获取所有验证方法

> ID：11000744
> 
> 赞同：2
> 
> 时间：2012-06-12T16:23:32.410
> 
> 标签：ruby-on-rails, ruby, validation, client-side-validation

我正在开发一个项目，该项目将对模型进行自定义验证并将它们转换为 javascript 以在客户端运行。我们目前正在传入模型和验证方法（作为 UnboundMethod ）。

```
JStranslator(model, Validator.instance_method(:validate)) 
```

我想要的是获取所有用于验证模型的 UnboundMethods，因为我们的翻译器利用了方法的 AST 表示（使用“live-ast”），因此 model_name.validators 将不起作用（它返回一个我认为的数组）。我需要获取在模型本身内部定义的所有自定义验证方法以及模型使用的所有验证器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T17:14:14.483

验证存储为回调，因此您可能想要使用这些：

```
Model._validate_callbacks # do something 
```

资源：

*   [https://github.com/rails/rails/blob/master/activemodel/lib/active_model/validations.rb](https://github.com/rails/rails/blob/master/activemodel/lib/active_model/validations.rb)
*   [https://github.com/rails/rails/blob/master/activemodel/lib/active_model/callbacks.rb](https://github.com/rails/rails/blob/master/activemodel/lib/active_model/callbacks.rb)
*   [http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html](http://api.rubyonrails.org/classes/ActiveRecord/Callbacks.html)

如果您遇到困难，很乐意提供更多帮助。

# html - 边框不围绕整个 div

> ID：11000746
> 
> 赞同：2
> 
> 时间：2012-06-12T16:23:42.913
> 
> 标签：html, css

所以我有一个名为的类`main`，其中包含整个网站的内容。由于我正处于构建网站的开始阶段，我想确保我的代码中没有错误，例如缺少结束标记或结束引号等。帮助我确保这一点的一件事是用五颜六色的元素包围我的元素边界。

我的主 div 应该被红色边框包围，但是，边框没有包围整个`div`容器，这告诉我我的标记有问题。我一直试图解码这个很长时间没有成功。我希望也许这里有人可以帮我解决这个问题？

[http://jsfiddle.net/yvSrB/](http://jsfiddle.net/yvSrB/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:31:46.300

您已将主 div 的高度设置为内联样式：

```
<div id="main" style="width:900px; margin-left:auto; height:1200px; margin-right:auto;"> 
```

如果您希望它扩展以适应内容，请删除高度，否则它将固定在 1200 像素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T16:30:59.387

您的主 div 的高度为 1200 像素，并且内容大于此宽度，因此边框不会显示在溢出的内容上，您可以通过增加显示的高度来检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T16:31:24.713

我想这并不能回答您的具体问题 - 但在调试标记和检查其质量方面，您可以使用`holmes.css`“CSS Markup Detective” [http://www.red-root.com/sandbox/holmes/](http://www.red-root.com/sandbox/holmes/) 它突出了潜力标记中的错误和错误。在您的开发版本中包含该`holmes.css`文件（或使用该链接上提供的书签工具）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T16:31:53.833

您的主 div 的高度为 1200 像素...删除它并让主 div 扩展到包含的高度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T16:35:56.663

如果您删除 jsfiddle 示例中的背景颜色，您会看到红色边框包裹在“carousel”div 下方。这是因为您已经为“主”div 指定了一个硬编码的高度。我不知道这是因为你希望它是最小高度——在这种情况下你应该使用`min-height`——还是因为你希望它是绝对高度。不管怎样，盒子的内容已经溢出了它的容器，这就是为什么你看不到红色边框的底部。

如果您希望“主”具有准确的高度并具有滚动条，请添加`overflow-y: auto;`到“主”div 的样式中。否则，正如我上面提到的，要么完全删除高度声明，要么使用`min-height: 1200px;`“主” div 增长来保存您的内容。

# macos - NSView 有背景颜色吗？如果有，我找不到

> ID：11000747
> 
> 赞同：3
> 
> 时间：2012-06-12T16:23:42.707
> 
> 标签：macos, cocoa, nsview, background-color

我在网上到处都能看到人们提到 NSView 的背景颜色。我需要为我的 NSView 设置自定义背景颜色，但我没有看到该属性。我在代码或 IB 中看不到它。我无法设置简单 NSView 的背景颜色。

我会错过什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T16:44:26.563

他们一定在想`UIView`，它确实有一个`backgroundColor`属性。 `NSView`没有财产。**_**`backgroundColor`

您将不得不以其他方式实现您的效果，例如，通过子类化`NSView`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-06T10:18:26.850

奇怪的是 NSView 不提供这个（叹气）。我在所有 macOS 项目中都使用我自己编写的一个一致的类。只需将 IB 的 Identity Inspector 选项卡中的 CustomView 类更改为 ColorView。然后，您将能够在 Attribute Inspector 中设置背景颜色，就像您设置 UIView 一样。这是代码，希望对您有帮助！

```
import Cocoa

class ColorView: NSView
{
    @IBInspectable var backgroundColor:NSColor?

    required init?(coder decoder: NSCoder)
    {
        super.init(coder: decoder)
        wantsLayer = true
    }

    override init(frame frameRect: NSRect)
    {
        super.init(frame: frameRect)
        wantsLayer = true
    }

    override func layout()
    {
        layer?.backgroundColor = backgroundColor?.cgColor
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-22T21:46:14.897

您可以通过视图层访问它，例如（在 Swift 中）：

```
 view.layer?.backgroundColor = NSColor.blue.cgColor 
```

奇怪的是它可以在xib中设置。在视图的身份检查器中，添加 User Defined Runtime Attribute`backgroundColor`和 Type 颜色。

# android - 安卓应用关键字

> ID：11000748
> 
> 赞同：6
> 
> 时间：2012-06-12T16:23:43.767
> 
> 标签：android

我已经将我的应用程序添加到 google play，我使用了 android 开发控制台，一切正常。

但是现在您只能使用名称访问我的应用程序，但我想添加一些关键字，并且我的应用程序很容易出现。

我怎样才能做到这一点？

先感谢您

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-12T16:34:27.563

谷歌会自动从你的标题和应用描述中挑选关键词。但是，`Keywords: keyword1, keyword2, keyword3`在您的描述中添加类似内容被 Google 视为关键字垃圾邮件，尤其是在您添加标题或竞争应用程序的开发者名称时。相反，请尝试以自然的方式将您的关键字包含在描述中。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2017-12-17T08:10:58.563

我建议您为您的应用程序选择正确的类别，例如，如果它是一个谜语应用程序，最好选择用户可以轻松访问您产品的琐事类别。我也同意 user1256477 的观点，即选择正确的关键字，例如脑筋急转弯之类的词会有所帮助。

这是一个可能有帮助的链接。

随意查看我的应用程序上的描述

[https://play.google.com/store/apps/details?id=com.dogmaz.mindtwist](https://play.google.com/store/apps/details?id=com.dogmaz.mindtwist)

# php - Mysql查询分页多变量结果

> ID：11000753
> 
> 赞同：0
> 
> 时间：2012-06-12T16:23:58.157
> 
> 标签：php

我想在分页结果中对我的多术语 sql 查询进行分页，第 1 页工作正常，但第 2 页 ..previous 或 next 不传递变量：

```
<?php

include "db.inc.php";

if (isset($_GET["page"])) { $page  = $_GET["page"]; } else { $page=1; }; 
$start_from = ($page-1) * 15;

$term1 = $_REQUEST['term1'];
$term2 = $_REQUEST['term2'];
$term3 = $_REQUEST['term3'];
$term4 = $_REQUEST['term4'];
$sql ="SELECT * FROM cdrequests WHERE pname  LIKE '%$term1%' AND date LIKE '%$term2%' AND date LIKE '%$term3%' AND dept LIKE '%$term4%' LIMIT $start_from, 15";

$rs_result = mysql_query ($sql);
$num_rows = mysql_num_rows($rs_result);
$query = mysql_query("SELECT * FROM cdrequests WHERE pname  LIKE '%$term1%' AND date LIKE '%$term2%' AND date LIKE '%$term3%' AND dept LIKE '%$term4%'"); 
$number=mysql_num_rows($query); 
print "<font size=\"5\" color=white><b>CD Requests</b></font> </P>";

print "<table class=\"table1\"    STYLE=\"word-wrap:break-word;\"   width=1100 border=\"1\"  bordercolor=\"#000000\" bgcolor=\"E6E6E6\" style=\"border-collapse: collapse\"   cellpadding=\"2\" cellspacing=\"1\"> .............
?>

<?php 

$term1 = $_REQUEST['term1'];
$term2 = $_REQUEST['term2'];
$term3 = $_REQUEST['term3'];
$term4 = $_REQUEST['term4'];

$sql = "SELECT COUNT(id) FROM cdrequests WHERE pname  LIKE '%$term1%' AND date LIKE '%$term2%' AND date LIKE '%$term3%' AND dept LIKE '%$term4%'";  
$rs_result = mysql_query($sql); 
$row = mysql_fetch_row($rs_result); 
$total_records = $row[0];
$total_pages = ceil($total_records / 15);

/******  build the pagination links ******/
// range of num links to show
$range = 3;

// if not on page 1, don't show back links
if ($page > 1) {
   // show << link to go back to page 1
   echo " <a href='search2.php?page=1'><b>First</b></a> ";
   // get previous page num
   $prev = $page - 1;
   // show < link to go back to 1 page
   echo " <a href='search2.php?page=$prev'><b>&laquo;</b></a> ";
} // end if 

// loop to show links to range of pages around current page
for ($x = ($page - $range); $x < (($page + $range) + 1); $x++) {
   // if it's a valid page number...
   if (($x > 0) && ($x <= $total_pages)) {
      // if we're on current page...
      if ($x == $page) {
         // 'highlight' it but don't make a link
         echo " <font  size='5' color=yellow><b> $x </b></font> ";
      // if not current page...
      } else {
         // make it a link
         echo " <a href='search2.php?page=$x'>$x</a> ";
      } // end else
   } // end if 
} // end for

// if not on last page, show forward and last page links        
if ($page != $total_pages) {
   // get next page
   $next = $page + 1;
    // echo forward link for next page 
   echo " <a href='search2.php?page=$next'><b>&raquo;</b></a> ";
   // echo forward link for lastpage
   echo " <a href='search2.php?page=$total_pages'><b>Last</b></a> ";
} // end if
/****** end build pagination links ******/
echo "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size='4' color=white>Total Records</font> <font size='5' color=yellow><b>$number</b></font>";

echo '</table>';

?> 
```

不知道我需要输入什么 `echo " <a href='search2.php?page=$next'><b>&raquo;</b></a> ";`才能调用条款

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:30:39.607

让自己更轻松。建表一次。

对它应用 jQuery 数据表

```
$('#table_id).datatables(); 
```

分页完成。真的就是这么简单！它只需要 jQuery 和[DataTables 插件](http://datatables.net/release-datatables/examples/basic_init/zero_config.html)，以及几行 CSS。作为奖励，它会过滤、排序、限制等，每个所需的功能只需额外的代码行。此外，它可以使用 Themeroller 进行样式设置，制作出比大多数开发人员都更好看的桌子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:43:45.767

这不起作用吗？

```
...
$start_from=$page*15

$query = mysql_query("SELECT * FROM cdrequests WHERE ...");  
$all_rows = mysql_num_rows($query); 
$totalPages = ceil($all_rows/15)-1; #How many pages?
$sql = $query . " LIMIT $start_from,15"; 
print "<font size=\"5\" color=white><b>CD Requests</b></font> </P>";

print "<table class=\"table1\..."
$terms= '&term1='.$term1 . '&term2='.$term2 . '&term3='.$term3 . '&term4='.$term4;
if($totalPages>1){ 
#Paging Starts Now
?>
<div align="center">
<? if ($page > 1) { ?>
<a href="search2.php?page=<? echo ($page-1); echo $terms; ?>">Previous</a>
<a href="search2.php?page=1<? echo $terms; ?>">First</a>
<? } ?>
Page <? echo $page; ?> of <? echo $totalPages+1; ?>

<? if ($page < $totalPages) { ?>
<a href="search2.php?page<? echo ($page+1); echo $terms; ?>">Next</a>
<a href="search2.php?page<? echo ($totalPages+1); echo $terms; ?>">Last</a>
</div>
<? } }?> 
```

# android - 拆分和合并/合并录制的音频

> ID：11000754
> 
> 赞同：4
> 
> 时间：2012-06-12T16:23:59.950
> 
> 标签：android, android-ndk, aac, mediarecorder, amr

我需要能够在 Android 中拆分和合并录制的音频。由于有[许多](http://developer.android.com/guide/appendix/media-formats.html)不同的格式，有谁知道哪种格式最容易处理？

只有“编码器”下带有点的格式可用于录制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T14:26:26.487

您可以使用[AudioRecord](http://developer.android.com/reference/android/media/AudioRecord.html)捕获原始音频数据来录制 .wav 文件。您不需要任何编码，只需在前面加上一个[44 字节](https://ccrma.stanford.edu/courses/422/projects/WaveFormat/)的小标题，您就有了 .wav 文件。拆分和合并原始音频数据是微不足道的，因为它们只是值的数组。

# c# - ASHX 包括代码隐藏类 -

> ID：11000755
> 
> 赞同：0
> 
> 时间：2012-06-12T16:24:04.490
> 
> 标签：c#, asp.net, iis, code-behind, ashx

我正在尝试使用外部代码文件来包含几个 .ashx 处理程序的一些帮助程序类。示例之一是使用 ListToJSON，它只是将嵌套列表（正在使用类似的东西`List<List<whatevers>>`）转换为 JSON（将被扔进 context.response）

ListToJSON 类在同一个文件中时可以正常工作。我试图将它放入一个 Helper.cs 文件中，该文件包含在 VS2010 的同一个项目中，因为这些类在几个不同的处理程序中使用。

我的印象是“使用Helper；” 是我需要做的，但我仍然收到错误“找不到类型或命名空间帮助程序（您是否缺少指令或程序集引用？”（并且智能感知也没有看到它）

我也尝试将两个代码文件放入同一个命名空间。同样的错误。

它不是DLL文件，它只是同一个项目中的ac#代码文件。我真的应该将它编译为 DLL 来执行此操作吗？如果是这样，我该怎么做？（一旦我这样做，我可以右键单击->添加参考，对吗？）

我想我应该使用 App_Code 文件夹，但我不确定如何在 VS 中设置它以便正确引用它。

我的处理程序文件（骨架）

```
<%@ WebHandler Language="C#" Class="generateReport" %>

using System;
using System.Web;
using System.Configuration;
using System.Data.SqlClient;
using System.Collections.Generic;
using System.Diagnostics;
using Helper;
public class generateReport : IHttpHandler {

    public void ProcessRequest (HttpContext context) {
        ListToJSON Converter = new ListToJSON();
        //context.Response stuff goes here.
    }
} 
```

我的帮助文件 Helper.cs - 它位于同一个项目目录中，并且包含在项目中：

```
using <stuff>;
namespace Helper
{
    public class ListToJSON
    {
        //class definition here
    }
} 
```

***更新：***所以，我将 Helper.cs 放入`/App_Code/`文件夹中，它似乎玩得很好。Intellisense 在我做之后在 Helper.cs 中拾取东西`using Helper;` 当我在 IIS 上尝试它时，我得到了以下熟悉的错误：

```
Compiler Error Message: CS0246: The type or namespace name 'Helper' could not be found (are you missing a using directive or an assembly reference?)
Line 19: using Helper;
Source File: <path>\info.ashx    Line: 19 
```

通过 Visual Studio 的 IIS 模拟器运行此程序时，我没有收到任何错误。当我通过 IIS (localhost) 运行它时，我得到描述的 IIS 内部服务器错误。App_Code文件夹是通过VS制作的，我右键选择`Add ASP.NET Folder > App Code`\

编辑：添加标签`iis`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:40:56.440

我假设您正在使用`WebSite`而不是`WebApplication`.

在中添加新`Class`文件时`Website`，它应该在`App_Code`文件夹中以避免出现`Accessibility`问题。

**编辑 - 1** => 请参阅下面的发布详细信息。

![在此处输入图像描述](../Images/2647e632af36b7b3d846751e6bacae2d.png)

**编辑 = 2** => 尝试`Assembly`在 bin 文件夹中添加个人，如下所述。这将确认该`App_Code`文件夹`Dll`已合并。

![在此处输入图像描述](../Images/720e69b2019bb0f529c40150de47208b.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T15:00:15.300

为了让 IIS 从 App_Code 文件夹中正确读取类，App_Code 文件夹（或 bin 文件夹，用于编译的程序集）需要位于 IIS 根目录中才能检测到其中的类。

就我而言，我发布到 IIS 根目录的子文件夹，因此 IIS 看不到其中的类。

# java - 如何让 jvm 在外部进行垃圾收集

> ID：11000757
> 
> 赞同：0
> 
> 时间：2012-06-12T16:24:08.887
> 
> 标签：java, linux, memory-leaks, garbage-collection, jvm

我有一个部署到生产环境的应用程序，有时`OutOfMemory`由于一些内存泄漏而引发异常。它在一个无头 ubuntu 盒子上运行，我不希望在该盒子上远程连接 visualvm、jconsole 等。有没有办法让`jvm`do gc （比如在 visualvm 中，你只需单击一个按钮即可）。

我想运行`jmap -histo:live <pid>`这个 gc 命令，以找出哪些对象在 gc 中幸存下来。哪些对象数量正在增长等。现在我可以看到一些意外的对象数量，但它发生在我的许多域对象中，所以我不确定它是延迟 gc 还是内存泄漏。

简而言之，我正在寻找针对`jvm`pid 运行的 linux 命令以使其执行 gc。不是 system.gc。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T18:23:30.330

当堆满时，GC 将积极尝试清理未引用的对象。所以它不是“延迟的 gc”。我认为你在正确的轨道上，使用 jmap 并获得堆转储。然后分析它以查看哪些应用程序对象不应该存在。您可能需要获取几个堆转储并将它们相互比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:28:25.690

在 Java 中很难得到真正的内存泄漏[。](https://stackoverflow.com/questions/6470651/creating-a-memory-leak-with-java)如果您遇到内存不足错误，则很可能意味着您实际上内存不足。所以要解决这个问题，您需要找到对未使用对象的引用并手动清理它们。因为否则，垃圾收集器无法释放浪费的内存。

当 JVM 无法分配更多内存时，垃圾收集器应该自动运行。

# c# - PDF 中的可移动图像

> ID：11000767
> 
> 赞同：1
> 
> 时间：2012-06-12T16:24:46.107
> 
> 标签：c#, pdf, pdfsharp

我正在编写一个将 PNG 图像插入 PDF 的 ASP.NET 程序。理想情况下，我希望用户可以选择稍后撤消此操作。

我目前正在使用[PDFSharp](http://pdfsharp.com/PDFsharp/)库添加图像，效果很好，但我无论如何都找不到删除它们。我已经稍微研究了注释功能，但据我所知，没有办法使用自定义图像。

有没有人对这个问题有任何经验或见解？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:26:11.573

PDF 格式是最终的演示格式，并不是真正为这种修改而设计的，可以使用其他库来执行此操作，但对于您的特殊情况，我建议您保留原始文件的副本而不是尝试还原这种修改。

# jquery - 如何为 a:contains(...) 转义

> ID：11000769
> 
> 赞同：2
> 
> 时间：2012-06-12T16:25:02.227
> 
> 标签：jquery

如何转义诸如撇号之类的字符的内容？

以下 a:contains 在字符串文字上令人窒息

```
$('a:contains('\This'is choking on the apostrophe\').... 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-12T16:26:13.190

你可以试试这个：

```
$('a:contains("This isn\'t choking on the apostrophe")') 
```

或这个：

```
$("a:contains('This isn\'t choking on the apostrophe')") 
```

# cakephp - CakePHP 1.3：禁用 lPlugin 模型缓存

> ID：11000771
> 
> 赞同：0
> 
> 时间：2012-06-12T16:25:04.453
> 
> 标签：cakephp, caching

是否可以在 CakePHP 中禁用特定插件模型类的缓存？

我`var $cacheQueries = FALSE;`在模型和`<cake:nocache></cake:nocache>`视图文件中尝试过，但没有成功。

对该模型的查询结果正在被缓存，并且 cake 在该`tmp/cache/models/`位置创建一个文件

谢谢，

# c - 警告的原因是什么：函数'swprintf_s'的隐式声明？

> ID：11000779
> 
> 赞同：1
> 
> 时间：2012-06-12T16:25:26.367
> 
> 标签：c, wchar-t

我想知道为什么我使用的`swprintf_s`是生成链接器警告`warning: implicit declaration of function 'swprintf_s'`

我有这个标题：

```
#include <stdio.h>
#include <stdlib.h>
#include <wchar.h>
#include <windows.h>
#include <tchar.h> 
```

和

```
LPCWSTR foo = L"É %s";
LPCWSTR arg = "bá";
LPCWSTR msg = malloc(wcslen((wchar_t*)foo) + wcslen((wchar_t*)arg) + 1);
swprintf_s(msg, (wchar_t*)foo, (wchar_t*)arg); 
```

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T18:22:00.237

所有`_s`函数 ( `swprintf_s`, `memcpy_s`) 都是 Microsoft 添加的。它们是 Microsoft 的 C 库的一部分。当您使用 GCC 时，您最终将使用不同的 C 库，它不包括 Microsoft 的添加（但可能包括它自己的添加）。Microsoft 将他们的 C 库称为“CRT”或“C 运行时”，GCC 用户将其称为“libc”甚至“glibc”（这是一个特定的实现）。

如果您查看 Microsoft 标准 C 库（[MSDN 文档](http://msdn.microsoft.com/en-US/library/634ca0c2%28v=vs.80%29)）中的函数列表，您会发现有相当多的非标准函数。其中大部分是 Microsoft 的“安全增强”（[MSDN 文档](http://msdn.microsoft.com/en-US/library/634ca0c2%28v=vs.80%29)）的一部分。一般来说，我建议避免安全增强，因为它们是不可移植的，而且它们对于编写安全代码不是必需的。

**修复：**您可以使用`swprintf`而不是`swprintf_s`. 该`swprintf`函数是 C 标准的一部分，因此它存在于许多实现中（尽管在非 Windows 平台上应该避免使用它，因为它使用`wchar_t`.

```
LPCWSTR foo = L"É %s";
LPCWSTR arg = L"bá";
size_t msgbuflen = wcslen(foo) + wcslen(arg) + 1;
LPCWSTR msg = malloc(len);
if (!msg) error...;
swprintf(msg, msgbuflen, foo, arg); 
```

请注意，这`LPCWSTR`只是一个花哨的 typedef `const wchar_t *`，因此您无需将其强制转换为`wchar_t *`.

# java - Java中的字符串（带空格）到DOM

> ID：11000784
> 
> 赞同：0
> 
> 时间：2012-06-12T16:25:52.137
> 
> 标签：java, xml, string, dom, xpath

我有一个将字符串转换为 DOM 的函数，然后在 DOM 对象上使用 javax.xml.xpath.XPathFactory 来提取数据。

XPathFactory 适用于以下字符串

`<root><test><name>A</name></test><test><name>B</name></test></root>`

但如果标签之间有空格，它会失败

`<root> <test> <name>A</name> </test> <test> <name>B</name> </test></root>`

我正在使用 XpathFactory 来准备来自 DOM 的值“A”和“B”。

当字符串在标签之间有空格时，谁能告诉我为什么 XpathFactory 会失败。

谢谢
--SD

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T01:57:49.767

XPath 是正确的并且工作正常，我认为问题在于

```
list.item(i).getChildNodes().item(0).getTextContent()); 
```

获取与 XPath 匹配的节点的第一个子节点，在带有空格的 XML 的情况下是紧随其后的空格`<employee>`，而在没有空格的 XML 的情况下是`<name>`元素。

换句话说，在有空格的情况下，第一个`employee`元素的子节点是（每行一个）：

```
[spaces]
<name> . . . </name>
[spaces]
<company-no> . . . </company-no>
[spaces]
<chunk-id> . . .</chunk-id> 
```

在没有空格的情况下，它们是：

```
<name> . . . </name>
<company-no> . . . </company-no>
<chunk-id> . . .</chunk-id> 
```

所以在第一种情况下，您需要的子节点是 1、3 和 5，在第二种情况下是 0、1 和 2。

我认为你应该修改这段代码：

```
 System.out.println("Name: " +list.item(i).getChildNodes().item(0).getTextContent());
 System.out.println("Company: "+list.item(i).getChildNodes().item(1).getTextContent());
 System.out.println("Chunk: "+list.item(i).getChildNodes().item(2).getTextContent()); 
```

要么使用其他 XPath 来获取名称、公司和块子节点，要么跳过包含空格的子节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T17:18:29.520

```
/root/test/name 
```

甚至只是

```
//name 
```

可选地，直接获取子文本节点

```
//name/text() 
```

# android - 如何在 Eclipse 中为 android 安装 sdks

> ID：11000786
> 
> 赞同：0
> 
> 时间：2012-06-12T16:25:58.810
> 
> 标签：android, eclipse

前几天在另一台机器上，我能够使用 eclipse 中的某些东西一次安装许多 android sdk 版本。我不记得我是怎么做到的，想知道是否有人知道如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:29:32.133

按照[http://developer.android.com/sdk/installing.html](http://developer.android.com/sdk/installing.html)中的说明进行操作，然后使用 SDK 管理器选择、下载和安装您需要的任何 SDK。

# ruby-on-rails - 未定义的方法“键？” 使用 MongoMapper 时为 nil:NilClass

> ID：11000788
> 
> 赞同：3
> 
> 时间：2012-06-12T16:26:11.893
> 
> 标签：ruby-on-rails, ruby, mongomapper

[我按照这些说明](http://www.mongodb.org/display/DOCS/Rails+3+-+Getting+Started)设置了一个新的 Rails 应用程序。我生成了一个新控制器并添加`resources :tickets`到路由文件中。

```
Hexapoda::Application.routes.draw do
  resources :tickets
end 
```

这是控制器（`/app/controllers/tickets_controller.rb'）。

```
class TicketsController < ApplicationController
  def index
    @tickets = Ticket.all
  end
end 
```

然后我`Ticket`在`/app/models/ticket.rb`.

```
class Ticket
  include MongoMapper::Document

  key :summary, String, :required => true
end 
```

这是视图（`/app/views/index.html.erb`）：

```
<h1>Tickets#index</h1>
<p>Find me in app/views/tickets/index.html.erb</p> 
```

现在，当我进入`/tickets`浏览器时，我收到一条错误消息。

> ### TicketsController#index 中的 NoMethodError
> 
> 未定义的方法“键？” 对于零：NilClass

我不知道是怎么回事。可能是什么问题呢？我正在使用 Rails 3.2.5 和 MongoMapper 0.11.1。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T16:54:35.303

您需要 Master 提供的最新 MonoMapper：

```
gem 'mongo_mapper', github: "jnunemaker/mongomapper" 
```

并运行`bundle`

说明：Rails 3.2.4 为 ActiveModel 添加了 access_attributes 方法，但 MongoMapper 已经有了这个；所以他们互相殴打。

MM 问题：[问题 419](https://github.com/jnunemaker/mongomapper/issues/419)
修复的 MM 提交：[4d35c67](https://github.com/jnunemaker/mongomapper/commit/4d35c6704a9b6b259a85b339f9ecaf9ca6966602)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T19:21:11.133

我上面的 Jesse Wolgamott 解决方案应该可以工作，如果没有，你可能还有其他非常简单的错误。

对我来说，这个错误：

未定义的方法“键？” 对于零：NilClass

发生是因为控制器正在调用并在视图中显示的模型文件中有一个简单的错字。确保在使用**attr_accessible**时不要忘记事物之间的任何逗号。我的问题来自使用这样的换行符：

attr_accessible :address_1, :address_2, :city **<= 需要逗号** :country, :latitude, :longitude, :state, :zip

一定要按照我上面的 Jesse Wolgamott 说的去做，如果这不起作用或者你已经在运行那个版本，请检查你的模型文件是否有错别字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-16T00:12:57.947

这让我有点头疼。我没有安装 mongo_mapper gem，但是重新启动 rails 服务器为我解决了这个问题。

# .htaccess - .htaccess 禁止 post.php?id=1 (MOD_REWRITE URL)

> ID：11000790
> 
> 赞同：0
> 
> 时间：2012-06-12T16:26:22.570
> 
> 标签：.htaccess, mod-rewrite

我刚刚在我的 CMS 中实现了友好的 URL，我想知道当用户访问 post.php?id=1 时阻止用户看到该帖子的最佳方法是什么？

EG 用户访问网站并转到[http://domain.com/post.php?id=1](http://domain.com/post.php?id=1)并看到 404，但是当他们转到[http://domain.com/post/this-is-a-post](http://domain.com/post/this-is-a-post)时，他们会看到邮政。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:36:27.863

你可以重写为

```
RewriteRule ^post/this-is-a-post/?$ post.php?id=1 
```

但是上面的代码并不是动态的 URL 覆盖。您必须在新 URL 中指定一个 ID 才能使其成为动态调用。喜欢

```
RewriteRule ^post/this-is-a-post/(.+)/?$ post.php?id=$1 
```

# c# - FileHelpers：如何跳过第一行和最后一行读取固定宽度的文本

> ID：11000797
> 
> 赞同：18
> 
> 时间：2012-06-12T16:27:07.953
> 
> 标签：c#, asp.net-mvc, filehelpers

下面的代码用于在 ASP .NET MVC2 中使用 FileHelpers 读取固定宽度上传的文件内容文本文件

第一行和最后一行的长度较小，因此 ReadStream 会导致异常。所有其他线条都有适当的固定宽度。如何无一例外地跳过第一行和最后一行或其他方式读取数据？

```
 [FixedLengthRecord()]
    class Bank
    {
        [FieldFixedLength(4)]
        public string AINETUNNUS;
        [FieldFixedLength(16)]
        public string TEKST1;
        [FieldFixedLength(3)]
        public string opliik;
        [FieldFixedLength(2)]
        public string hinnalis;
    };

    [AcceptVerbs(HttpVerbs.Post)]
    [Authorize]
    public ActionResult LoadStatement(HttpPostedFileBase uploadFile)
    {

        FileHelperEngine engine = new FileHelperEngine(typeof(Bank));
        var res = engine.ReadStream(new StreamReader(uploadFile.InputStream,
             Encoding.GetEncoding(1257))) as Bank[];
  } 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-06-12T20:24:13.110

您可以使用这些属性

**IgnoreFirst**：表示引擎读取文件或流时要忽略的行数。

```
[IgnoreFirst(1)] 
public class OrdersVerticalBar 
{ ... 
```

**IgnoreLast**：指示引擎读取文件或流时要忽略的行数。

```
[IgnoreLast(1)] 
public class OrdersVerticalBar 
{ ... 
```

您可以稍后访问这些值

```
engine.HeaderText
engine.FooterText 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T16:38:12.897

您可以使用[BeforeReadRecord](http://www.filehelpers.net/docs/html/E_FileHelpers_EventEngineBase_1_BeforeReadRecord.htm)事件来检查行的格式。`SkipThisRecord`如果它是第一条记录，请在事件数据中设置属性。确定它是否是最后一条记录是一个问题，但您可以只检查长度或格式。当然，这将防止您捕获由格式错误的记录引起的错误。

另一种可能性是使用`File.ReadAllLines`. 从结果数组中删除第一项和最后一项，将其转回字符串，然后调用[ReadString](http://www.filehelpers.net/docs/html/M_FileHelpers_FileHelperEngine_1_ReadString_1.htm)。或者您可以将字符串写入 a`MemoryStream`并调用`ReadStream`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-02T18:22:00.067

最好的方法是使用 [IgnoreFirst] 属性来装饰您的班级。

如果由于某种原因你不能添加属性，你可以做这样的事情

```
var engine = new FileHelperEngine<T>();
engine.BeforeReadRecord += (e, args) =>
{
    if (args.LineNumber == 1)
        args.SkipThisRecord = true;
}; 
```

# c++ - 函数调用时结构参数损坏

> ID：11000798
> 
> 赞同：0
> 
> 时间：2012-06-12T16:27:10.107
> 
> 标签：c++, visual-studio, assembly, x86, function-calls

在将结构作为参数传递时，我无法追踪奇怪行为的原因。

所讨论的结构 structFoo 具有以下声明：

```
typedef struct _structFoo {
    int id;
    BSTR szDescription;
    VARIANT vData;
    BOOL bTransient;
} structFoo; 
```

我有两个模块，A 和 B。模块 A 调用 B::foo(int id, uint filter, structFoo sF)。在 A 中，在调用之前，structFoo 结构已正确形成并填充了有效数据。但是，一旦对 B::foo() 进行了函数调用，structFoo 参数中就会包含垃圾数据。进一步检查，原来复制的struct的地址放入了id字段，szDescription指向最近使用的字符串。函数调用后其他参数正确。

我不确定这种错位的原因，或者发生了什么，但在我看来，在进行函数调用之前，一切都在适当的位置。这是导致函数调用的反汇编：

```
0000000006003211  lea         rdi,[rsp+230h] 
0000000006003219  lea         rsi,[sAttPairId] 
0000000006003221  mov         ecx,30h 
0000000006003226  rep movs    byte ptr [rdi],byte ptr [rsi] 
0000000006003228  mov         rax,qword ptr [piConstruct] 
0000000006003230  mov         rax,qword ptr [rax] 
0000000006003233  lea         r9,[rsp+230h] 
000000000600323B  mov         r8d,800h 
0000000006003241  mov         edx,dword ptr [iHighNodeId] 
0000000006003248  mov         rcx,qword ptr [piConstruct] 
0000000006003250  call        qword ptr [rax+60h] 
```

这是函数调用后的反汇编：

```
0000000004B72470  mov         qword ptr [rsp+20h],r9 
0000000004B72475  mov         dword ptr [rsp+18h],r8d 
0000000004B7247A  mov         dword ptr [rsp+10h],edx 
0000000004B7247E  mov         qword ptr [rsp+8],rcx 
0000000004B72483  push        rsi  
0000000004B72484  push        rdi  
0000000004B72485  sub         rsp,0A8h 
0000000004B7248C  mov         rdi,rsp 
0000000004B7248F  mov         rcx,2Ah 
0000000004B72499  mov         eax,0CCCCCCCCh 
0000000004B7249E  rep stos    dword ptr [rdi] 
0000000004B724A0  mov         rcx,qword ptr [rsp+0C0h] 
0000000004B724A8  mov         qword ptr [rsp+90h],0FFFFFFFFFFFFFFFEh 
```

`sub rsp, 0A8h`参数都设置好后数据，但是sF参数在其id字段中有正确的structFoo信息的地址，而不是用这个地址作为自己的指针。非常感谢任何有关解决此问题的指导。

作为旁注，不幸的是，更改 B::foo() 以获取结构的地址而不是结构本身不是一种选择。大量遗留代码依赖于我无权更改的此功能。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-03T05:07:32.743

我在寻找我遇到的类似问题的答案时偶然发现了这个页面。虽然在网上找不到答案，分享下调试的经验。

下面的结构通过引用从一个函数传递到另一个函数，接收者会发现接收到的数据是意外的：

```
typedef struct
{
    char time_st[30];
    char pipe_no;
    float loss;
    float power[4];
    int   mode;
    int   count;
}Parameters; 
```

另一个发现是，如果我在与调用函数相同的文件中定义接收函数，问题就会消失。

经过调试，发现根本原因是系统中遗留的.h文件中使用“#pragma pack”导致结构打包问题——由于在调用函数的.c文件中包含了几个遗留头文件，该结构被打包，但在接收函数的 .c 文件中（在项目活动期间编写的新文件）中，该结构被视为未打包。

解决方案：添加足够的填充以使结构字对齐

```
typedef struct
{
    char time_st[30];
    char pad;
    char pipe_no;
    float loss;
    float power[4];
    int   mode;
    int   count;
}Parameters; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T17:40:01.033

我猜，模块`A`和`B`是用不同的调用约定编译的。模块`A`通过引用/指针将结构传递给函数，而模块`B`期望通过值接收堆栈上的结构。

`B`的头文件中可能有一个修饰符，如下所示：

```
__weird_call void B::foo( int id, uint filter, structFoo sF ); 
```

也许模块的编译器`A`不理解它，或者其他一些头文件定义了它（`#define __weird_call /* nothing */`），或者类似的东西。

# powershell - 在 Powershell 中使用带有 BeginInvoke 的 PSDataCollection

> ID：11000801
> 
> 赞同：2
> 
> 时间：2012-06-12T16:27:19.170
> 
> 标签：powershell, powershell-2.0

我正在尝试在我的 PowerShell 脚本中处理来自管道的输出。现在我看到输出的唯一方法是当我`EndInvoke`为管道发出方法时，但由于我的一些调用可能会长时间运行并且可能有很多输出，我希望能够显示进程运行时输出。

看起来我可以通过将输入和输出参数传递给`BeginInvoke`方法来做到这一点，但我似乎无法获得正确的语法。有什么建议么？我正在尝试的一个例子如下：

```
$scriptBlock = {param([int]$pauseTime = 10); Write-Output "Test"; Start-Sleep -Seconds $pauseTime; Write-Output "Test 2"}

# Create objects and set stuff up
$initialSessionState = [System.Management.Automation.Runspaces.InitialSessionState]::CreateDefault()
$runspacepool = [Management.Automation.Runspaces.RunspaceFactory]::CreateRunspacePool(1, 4, $initialSessionState, $Host)
$runspacepool.Open()
$pipeline = [powershell]::Create().AddScript($scriptBlock).AddParameter("pauseTime", 30)
$pipeline.RunspacePool = $runspacepool

# These two lines are not correct
$inputStream = New-Object [System.Management.Automation]
$outputStream = New-Object [System.Management.Automation.PSDataCollection]

$async = $pipeline.BeginInvoke($inputStream, $outputStream)

# Do something with the $outputStream here???

$pipeline.EndInvoke($async)

# Clean-up code    
$pipeline.Dispose()
$async = $null
$pipeline = $null
if ($runspacepool -ne $null) {$runspacepool.Close()} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T12:10:01.190

我不知道您要完成什么（对于处理脚本输出的简单目的，它看起来过于复杂）但是通过对您的 PowerShell 脚本进行这个小修改，至少您会得到一个输出：

```
` $scriptBlock = {
    参数（[int]$pauseTime = 1）
    写输出“测试 1”
    开始-睡眠-秒 $pauseTime
    写输出“测试 2”
   }

    # 创建对象并设置东西
    $initialSessionState = [System.Management.Automation.Runspaces.InitialSessionState]::CreateDefault()
    $runspacepool = [System.Management.Automation.Runspaces.RunspaceFactory]::CreateRunspacePool(1, 4, $initialSessionState, $Host)
    $runspacepool.Open()
    $pipeline = [powershell]::Create().AddScript($scriptBlock).AddParameter("pauseTime", 5)
    $pipeline.RunspacePool = $runspacepool

    $outputStream = New-Object -Typename System.Management.Automation.PSDataCollection[PSObject]

    $async = $pipeline.BeginInvoke()
    1..10 | Foreach { "我在等待..."; 开始睡眠 - 毫秒 500 }

    $outputStream = $pipeline.EndInvoke($async)

    # 清理代码    
    $pipeline.Dispose()
    $异步 = $null
    $管道 = $null
    if ($runspacepool -ne $null) {$runspacepool.Close()}

    $输出流
`

```

# mysql - 在 MySQL 的存储过程中调用存储过程

> ID：11000802
> 
> 赞同：46
> 
> 时间：2012-06-12T16:27:20.233
> 
> 标签：mysql, stored-procedures

我在任何地方都找不到这个答案，但是你能从 MySQL 中的另一个存储过程中调用一个存储过程吗？我想取回标识值并在父存储过程中使用它。我们不能再使用函数了！

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-06-12T16:34:56.203

```
CREATE PROCEDURE innerproc(OUT param1 INT)
BEGIN
 insert into sometable;
 SELECT LAST_INSERT_ID() into param1 ;
END
-----------------------------------
CREATE PROCEDURE outerproc()
BEGIN
CALL innerproc(@a);
// @a gives you the result of innerproc
SELECT @a INTO variableinouterproc FROM dual;
END 
```

`OUT`参数应该可以帮助您将值返回给调用过程。基于此，解决方案必须是这样的。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-06-12T16:31:39.990

要调用另一个过程，请使用[CALL](http://dev.mysql.com/doc/refman/5.0/en/call.html)：例如：`Call SP1(parm1, parm2);`

要获得身份，您是否尝试检查[LAST_INSERT_ID()](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_last-insert-id)；你会`SELECT LAST_INSERT_ID()`在你的 SP 电话之后做一些事情。

这是一个完整的、经过测试的示例：

```
DELIMITER $$

CREATE TABLE animals (
     id MEDIUMINT NOT NULL AUTO_INCREMENT,
     name CHAR(30) NOT NULL,
     PRIMARY KEY (id)
) $$

CREATE PROCEDURE sp1()
BEGIN
  insert into animals (name) values ('bear');
END $$

CREATE PROCEDURE sp2()
BEGIN
  call sp1;
  select last_insert_id();
END $$

call sp2; 
```

# oop - 存储来自基于代理的 Matlab 模拟的数据快照

> ID：11000803
> 
> 赞同：1
> 
> 时间：2012-06-12T16:27:39.530
> 
> 标签：oop, matlab, logging, simulation, agent-based-modeling

我正在 MATLAB 中编写基于代理的模拟，其中代理轮流玩游戏，互相卖东西。几乎所有东西（代理、项目、位置、合同......）都使用 MATLAB 的 OOP 功能作为对象实现。

**每一轮我都想拍下我的模拟快照并将其存储在磁盘上**，以便以后分析模拟是如何发展的。现在我的问题是**最好的方法是什么？**

**我目前的想法**是主循环调用每个代理并要求它报告其状态（例如，您拥有多少财产，您的合同义务是什么，账户余额......而如果有必要，代理会调用对象他们拥有并询问他们的状态，并将该信息包含在他们的报告中）。我的想法是让**代理的报告成为一个字符串，可能是 XML 格式。然后将所有报告与时间戳一起添加，并将其添加到文本文件的末尾**。

但由于我从未做过这样的事情，我不确定这是否是一个好方法。除了让数据采用以后可以轻松分析的格式之外，**我主要关心**的是创建快照并将其写入磁盘的**速度。**由于我的模拟非常大，我希望每一轮都存储大量数据。

**替代的想法**是：

1.  将所有内容存储在**数据库**中。但我认为与文本文件相比，数据库访问速度相当慢。而且由于每个代理拥有的对象数量可能会发生变化，因此我也不太确定数据库结构。
2.  使用**.mat 文件**。但我不知道它们是否易于扩展以及它们将如何处理不断变化的结构（即每轮拥有不同物品的代理）

感谢您的任何意见和建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:49:23.003

**。垫**

由于您的目标是 Matlab，我将从 .mat 文件开始。如果您需要在某个时间将数据重新加载到 Matlab 中，那么与 XML 存储相比，这是一个更可取的解决方案。你应该只用单元阵列来表达你的快照。您不必担心结构的变化：例如，如果代理每轮拥有不同的项目，则每轮的项目可以存储为另一个（嵌套）单元阵列。

**数据库**

如果不再从 Matlab 中读取快照，请考虑使用 SQL 接口。这允许您扩展持久层的性能。您可以从使用[SQLite](http://www.sqlite.org/)开始，然后，如果您发现在某些指标下需要更好的性能，则转向更“严肃”的 DBMS。

关于您对数据库结构的疑问，您的快照肯定有一个结构：我认为快照中的任何可变内容都不会通过正确设计数据库应用程序来管理。

**风俗**

如果您确实处于 I/O 密集型场景并且您最终只添加数据，那么专用解决方案是一项合理的投资。你失去了一些灵活性，你可能会后悔，但是，嘿，你想要最好的！我建议不要跳上 XML 船：它不是最紧凑的解决方案，因此您可能会遇到非常大的数据集的问题。如果不设计自己的格式，我宁愿使用 JSON：它紧凑、通用，并且可能有一些库可以帮助您在 Matlab 中解析它。等等不，实际上[有](http://iso2mesh.sourceforge.net/cgi-bin/index.cgi?jsonlab)！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T22:02:19.817

我也尝试了这两种选择。

除非您只有很少的数据，否则我不鼓励保存单独的 mat 文件。想出唯一的名称然后收集它们是相当麻烦的。并行化计算时不要理会，同时访问文件时可能会遇到问题。

对于数据库，我喜欢 matlab 中 MySql 服务器和[mym](http://www.mathworks.com/matlabcentral/linkexchange/links/1313-mysql-connector-mym)命令的组合。服务器，因此您可以同时从多个进程访问（对于并行化至关重要）。Mym 因为它允许将 matlab 对象直接写入数据库中的 blob 字段 - 节省了一些重写。

正如上面提到的 SQLite - 我一直在修补它。但是比较生气。您必须自己序列化对象。让多个进程访问数据库也是有问题的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T20:53:28.690

> 在这个答案中，我总结了我最终实施的解决方案。它是专门为解决我的特定问题而设置的，因此我建议您还可以查看 Luca Geretti 和 bdecaf 的答案以获取替代选项。

## 我实施了什么

我选择**SQLite**作为数据库，因为它将数据存储在一个文件中，并且易于设置和处理。（使用 sqlite3 和 sqlite-jdbc-3.7.2 驱动程序不需要安装太多，数据库都在一个简单的文件中。）

事实证明， Matlab**数据库工具箱太慢了，**无法从我的模拟过程中创建的 Matlab 中导出大量数据。因此，我编写了一个“DataOutputManager”类，**将数据快照转储到 csv 文件**中。

模拟之后，DataOutputManager 创建两个**批处理文件**和两个带有 SQL 命令的 sql 文本文件并执行批处理文件。第一个批处理文件通过运行 sqlite3.exe ( [www.sqlite.org](http://www.sqlite.org) ) 并在第一个文本文件中为其提供 SQL 命令来**创建一个 SQLite 数据库。**

创建数据库后，sqlite3 被告知使用第二个批处理和文本文件**将数据从 csv 文件导入数据库。**这不是一个“漂亮”的解决方案，但将数据写入 csv 然后使用 sqlite3 将这些文件导入数据库**比使用 Database Toolbox 快得多**。（我听说有些人使用 xml 文件）

模拟数据上传到数据库后，**我使用 Database Toolbox 和 jdbc 驱动程序 ( [sqlite-jdbc-3.7.2](http://www.xerial.org/maven/repository/artifact/org/xerial/sqlite-jdbc/3.7.2/) ) 将 SQL 查询发送到数据库**。由于这些查询只返回很少的数据，因此 Database Toolbox 不是这里的瓶颈。

设置所有这些（在 Windows 7 中）需要分配搜索和测试。即使不完美，我希望如果有人想做类似的事情，下面的代码片段可能会有用。

## 创建 SQLite 数据库并将数据从 csv 导入数据库：

使用 sqlite3 创建数据库的第一个 .bat 文件的结构如下：

> sqlite3 数据库名称.db < 数据库名称结构.sql

第一个文本文件 (.sql) 称为 DatabaseNameStructure.sql，其结构如下：

> 开始; 创建表 Table1Name (Column1Name real, Column2Name real, Column2Name real); 创建表 Table2Name (Column1Name real, Column2Name real, Column2Name real); 犯罪;

让 sqlite3 将 csv 文件上传到数据库的第二个 .bat 文件的结构如下：

> sqlite3 数据库名称.db < uploadCsvToDatabaseName.sql

第二个文本文件 (.sql) 称为 uploadCsvToDatabaseName.sql，其结构如下：

。分隔器 ”，”

.import Table1Data.csv 表1名称

.import Table2Data.csv 表2名称

。出口

为此，您需要在系统路径中包含 sqlite3.exe，例如保存在 C:\Windows\System32 下。您根据数据/csv 设置在 Matlab 中创建字符串，然后使用 fprintf() 将它们写入上述格式的文件中。然后使用 winopen() 从 Matlab 执行 bat 文件。

## 使用 jdbc 驱动将 Matlab 连接到 SQLite 数据库：

Bryan Downing 的以下视频对我的开发很有帮助：[http ://www.youtube.com/watch?v=5QNyOe79l-s](http://www.youtube.com/watch?v=5QNyOe79l-s)

我创建了一个 Matlab 类（“DataAnalyser”），它连接到数据库并对模拟结果运行所有分析。这是用于设置与数据库通信的类构造函数和连接函数。（我删掉了一些不那么重要的实现部分）

* * *

```
 function Analyser=DataAnalyser()

        % add SQLite JDBC Driver to java path
        Analyser.JdbcDriverFileName='sqlite-jdbc-3.7.2.jar';

        % Ask User for Driver Path
        [Analyser.JdbcDriverFileName, Analyser.JdbcDriverFilePath] = uigetfile( {'*.jar','*.jar'},['Select the JDBC Driver file (',Analyser.JdbcDriverFileName,')']);
        Analyser.JdbcDriverFilePath=[Analyser.JdbcDriverFilePath,Analyser.JdbcDriverFileName];

        JavaDynamicPath=javaclasspath('-dynamic'); % read everything from the dynamic path
        if~any(strcmp(Analyser.JdbcDriverFilePath,JavaDynamicPath))           
            disp(['Adding Path of ',Analyser.JdbcDriverFileName,' to java dynamic class path'])
            javaaddpath(Analyser.JdbcDriverFilePath);
        else
            disp(['Path of ',Analyser.JdbcDriverFileName,' is already part of the java dynamic class and does not need to be added']);
        end

        Analyser.JdbcDriver='org.sqlite.JDBC';
        % Ask User for Database File
        [Analyser.DbFileName, Analyser.DbFilePath] = uigetfile( '*.db','Select the SQLite DataBase File ');
        Analyser.DbFilePath=[Analyser.DbFilePath,Analyser.DbFileName];

        Analyser.DbURL=sprintf('jdbc:sqlite:%s',Analyser.DbFilePath);
        % Set Timeout of trying to connect with Database to 5 seconds
        logintimeout(Analyser.JdbcDriver,5);               
    end 
```

* * *

```
 function [conn,isConnected]=connect(Analyser)
        % Creates connection to database.            
        Analyser.Connection=database(Analyser.DbFilePath,'','',Analyser.JdbcDriver,Analyser.DbURL);
        conn=Analyser.Connection;
        isConnected=isconnection(Analyser.Connection);                  
    end 
```

## 从连接的 SQLite 数据库中获取数据到 Matlab

我还为 DataAnalyser 编写了一个函数，该函数在给定 sql 查询时从数据库中获取数据。我在这里发布它的主要部分有两个原因。

1.  不是一次导入所有数据，而是像此函数那样分部分导入数据，这样可以更快地导入数据。

2.  [Mathworks 在其 Database Toolbox (cursor.fetch)文档](http://www.mathworks.de/de/help/database/ug/cursor.fetch.html)中提供了如何执行此操作的建议。但是，使用 jdbc 和 SQLite 会因为错误而导致错误。

引用来自 Mathworks 支持：

> 我们之前已经看到，如果您位于记录集的末尾，SQLite JDBC 驱动程序不允许查询有关记录集的某些元数据；根据 JDBC 规范，这应该是允许的。

这个函数可以解决这个问题：

* * *

```
function OutputData=getData(Analyser,SqlQuery,varargin)
        % getData(Analyser,SqlQuery)
        % getData(Analyser,SqlQuery, setdbprefsString)
        % getData(Analyser,SqlQuery,RowLimitPerImportCycle)
        % getData(Analyser,SqlQuery,RowLimitPerImportCycle,setdbprefsArg1String,setdbprefsArg2String)
        % getData(Analyser,SqlQuery,[],setdbprefsArg1String,setdbprefsArg2String)
        % 
        % RowLimitPerImportCycle sets the Limit on howmany Data rows 
        % are imported per cycle. 
        % Default is RowLimitPerImportCycle = 6000
        %
        % setdbprefsArg1String Default 'datareturnformat' 
        % setdbprefsArg2String Default 'numeric'
        % Hence setdbprefs('datareturnformat','numeric') is the Default
        %            
        % function is partially based on cursor.fetch Documentation for 
        % Matlab R2012b:
        % http://www.mathworks.de/de/help/database/ug/cursor.fetch.html
        % Example #6 as of 10.Oct.2012
        % The Mathworks' cursor.fetch Documentation mentioned above had
        % some errors. These errors were (among other changes)
        % corrected and a bug report was send to Mathworks on 10.Oct.2012

        if isempty(Analyser.Connection)                
            disp('No open connection to Database found.')
            disp(['Trying to connect to: ',Analyser.DbFileName])
            Analyser.connect
        end

        % Get Setting
        if nargin>2
            RowLimitPerImportCycle=varargin{1};
        else
            RowLimitPerImportCycle=[];
        end
        if ~isnumeric(RowLimitPerImportCycle) || isempty(RowLimitPerImportCycle)
            %Default
            RowLimitPerImportCycle=5000;
        end

        if nargin>4
            setdbprefsArg1String=varargin{2};
            setdbprefsArg2String=varargin{3};
        else
            setdbprefsArg1String='';
            setdbprefsArg2String='';
        end
        if ischar(setdbprefsArg1String) && ~isempty(setdbprefsArg1String) && ischar(setdbprefsArg2String) && ~isempty(setdbprefsArg2String)
            setdbprefs(setdbprefsArg1String,setdbprefsArg2String)
        else
            %Default
            setdbprefs('datareturnformat','numeric');
        end

        % get Curser
        curs=exec(Analyser.Connection,SqlQuery);
        if ~isempty(curs.Message)
            warning('Model:SQLMessageGetData',[curs.Message, '/n while executing SqlQuery: ',SqlQuery])
        end

        % import Data
        FirstRow = 1;
        LastRow = RowLimitPerImportCycle;
        firstLoop=true;

        while true

            curs = fetch(curs,RowLimitPerImportCycle);
            if rows(curs)==0
                if firstLoop == true
                    OutputData=[];
                end
                break
            end

            AuxData = curs.Data;
            numImportedRows = size(AuxData,1);
            if numImportedRows < RowLimitPerImportCycle
                OutputData(FirstRow:LastRow-(RowLimitPerImportCycle-numImportedRows), :) = AuxData;
            else
                OutputData(FirstRow:LastRow, :) = AuxData;
            end

            FirstRow = FirstRow + RowLimitPerImportCycle;
            LastRow = LastRow + RowLimitPerImportCycle;
            firstLoop=false;

            if rows(curs)<RowLimitPerImportCycle
                break
            end
        end

    end 
```

* * *

# android - 将 SurfaceView 与 xml 一起使用

> ID：11000805
> 
> 赞同：1
> 
> 时间：2012-06-12T16:27:46.877
> 
> 标签：android, surfaceview

我指的是[Using MySurfaceView with main.xml (android)](https://stackoverflow.com/q/8149225/1393006)，代码为“textView1.setText("set");" 在 onCreate 方法中会有一个错误（ tv1 = (TextView)findViewById(R.id.tv1); - declare 工作正常）。我该如何解决这个问题？提前感谢您的帮助。

```
public class For12junonly2Activity extends Activity {

TextView tv1;
EditText et1;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    try
    {
    tv1 = (TextView)findViewById(R.id.tv1);     
    tv1.setText("Hi");
    }catch(Exception e)
    {
        Log.d("prob",String.valueOf(e));
    }
    et1 = (EditText)findViewById(R.id.et1); 
    setContentView(R.layout.main);

    float sss = surf.getX();
    Log.d("float create",String.valueOf(sss));
}

}

 class surf extends SurfaceView implements SurfaceHolder.Callback
{
...... from https://stackoverflow.com/q/8149225/1393006

public boolean onTouchEvent(MotionEvent event)
{   
    canvas.drawBitmap(myBitmap, event.getX() - (myBitmap.getWidth() / 2), event.getY() - (myBitmap.getHeight() / 2), null);
    canvas.drawCircle(event.getX(), event.getY(), 10, paint);
    surfaceHolder.unlockCanvasAndPost(canvas);
    Log.d("onTouch","X: "+event.getX()+" , Y: "+event.getY());
    x = event.getX();
    return true;
}
} 
```

来自xml的代码

```
<TextView
    android:id="@+id/tv1" 
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="tv1" />

<te.de11.surf
    android:id="@+id/surfaceview" 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
   /> 
```

来自日志猫的错误消息

```
D/dalvikvm(443): Debugger has detached; object registry had 1 entries
I/AndroidRuntime(443): NOTE: attach of thread 'Binder Thread #3' failed
D/prob(363): java.lang.NullPointerException
D/float create(363): 0.0
I/ActivityManager(60): Displayed te.de11/.For12junonly2Activity: +1s29ms
D/dalvikvm(127): GC_EXPLICIT freed 66K, 52% free 2855K/5895K, external 4998K/6087K, paused 44ms 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:51:48.983

在将 XML 设置为活动视图之前，您试图在 XML 中获取对 TextView 的引用。由于您的 Activity 目前没有任何视图，因此任何 findViewById() 调用都会导致 NullPointerException。要修复它，只需`setContentView()`在引用 XML 中使用的任何小部件之前调用。它通常在调用后直接`super()`调用。

# c - C中的寄存器访问（读/写）

> ID：11000806
> 
> 赞同：2
> 
> 时间：2012-06-12T16:27:46.703
> 
> 标签：c, assembly, binary, cpu-registers

我对处理器寄存器的概念有一些误解。有一个地址寄存器，比方说，0x0345678。这个寄存器是 32 位宽/长（现在没关系，哪个字是正确的）。正如手册中所写，有某种表/数组：

```
职位价值
 0 111111...10b
 1 111111...11b
 2 7A
 .....................
 7 3F7C
```

我必须访问位置 2 的值。我所做的第一件事是：

```
#define REG 0x0345678

void somereadfunction()
{
   volatile unsigned int *pval = (volatile unsigned int *)REG;
   printf("%x", *(pval | 0x02));
} 
```

正如您已经猜到的那样，这是错误的假设。

另一项尝试是：

```
 for(unsigned int i = 0; i < 3; i++)
    {
        printf("i: %d, res: 0x%08X", i, *((volatile unsigned int *)REG));
    } 
```

它有效。所以，我的问题是，为什么以及如何？处理器是否只是使用其他开发人员编写的内部某种魔术算法来切换寄存器值？我对此有点困惑。我知道如何使用一些简单的逐位操作来访问寄存器的第三位，但我不明白，如何通过调用寄存器的 3 次来获得正确的值？

预先感谢您的回答。

添加：处理器是 ARM 7。使用了 i2c 设备。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:59:54.353

*为什么*？

因为构建您的硬件设备（连接到您的 ARM 处理器）的人可能只声明了一些“属于”设备的地址。然后，他们注意到硬件中的数据比寄存器多，并且更改手册为时已晚，因此他们决定让一些寄存器保存多个值。

*怎么样*？

硬件有一个内部计数器，用于计算来自处理器的读取命令。每次处理器想要从寄存器中读取时，硬件都会向它发送另一条数据，由不可见的内部计数器索引，并增加计数器。计数器是 3 位的，所以它计数 0, 1, ..., 7, 0, 1, ... 等等。

因此，如果要读取索引为 2 的数据，还必须读取所有其他数据元素（3、4、5、6 和 7）以重置不可见计数器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T16:42:55.993

内存映射 I/O 寄存器根据对它们的读取和写入更改其内容。他们描述它的方式有点奇怪，通常会向控制寄存器写入一个值，以告诉设备要访问哪个内部寄存器，然后从另一个位置读取该值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T16:50:50.963

`*(pval | 0x02)``*(pval + 0x2)`如果您试图索引到该数组中的第二个位置，应该是真的。

您还可以通过在强制转换`REG + 0x8`之前获取位置 2 处的第三个 32 位值来将 REG 设置为正确的地址。

如果此架构使用字节寻址，则这是正确的，这意味着每个地址都指向一个数据字节。因此，您可以从 0x345678、0x345678+1、0x345678+2 等处读取一个字节的数据。现在，如果您使用的是 32 位架构，则每次只需关注 4 个字节。所以 0x345678 是位置 0，0x345682 是位置 1，依此类推。

您还必须考虑内存对齐，因为您无法进行未对齐的访问。它通常在 32 位架构中的 4 字节边界对齐。

# c# - NRefactory 5 从一个简单的例子开始

> ID：11000807
> 
> 赞同：4
> 
> 时间：2012-06-12T16:27:50.837
> 
> 标签：c#, nrefactory

我想开始使用 NRefactory 5 来解析 CSharp 文件，进行重构。但是文档很少。所以我尝试并失败了：我从以下代码开始，看看是否可以`AstNode`从 cs 文件中获取树。

我希望解析为我生成一些节点，但没有。有人可以指导我吗？

```
TextReader reader = File.OpenText(fname);
CompilationUnit compilationUnit;

CSharpParser parser = new CSharpParser();
compilationUnit = parser.Parse(reader, fname);
AstNode node = compilationUnit.GetNextNode();
System.Collections.Generic.IEnumerable<AstNode> desc = 
    compilationUnit.Descendants;
foreach (AstNode jo in desc)
{
    System.Console.WriteLine("At least something here");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T20:36:33.600

看看`ICSharpCode.NRefactory.Demo`NRefactory 源代码中的项目 - 它可以解析一些代码并在 TreeView 中显示语法树。

您发布的代码确实应该产生一些节点 -`compilationUnit.Children`将包含直接子节点（通常是 usings 和命名空间声明）。

还有[CodeProject 文章](http://www.codeproject.com/Articles/408663/Using-NRefactory-for-analyzing-Csharp-code)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-23T07:07:24.767

编译单元现已过时。它被语法树取代。

尝试以下代码：

```
 TextReader reader = File.OpenText("myfile.cs");
        SyntaxTree syntaxTree;

        CSharpParser parser = new CSharpParser();
        syntaxTree = parser.Parse(reader, "myfile.cs");

        IEnumerable<AstNode> desc = syntaxTree.Descendants;

        foreach(AstNode astNode in desc)
        {
            System.Console.WriteLine(astNode.GetType());
        } 
```

# ios - 为 iPhoneOS 构建静态库 Graphviz。什么剧本？

> ID：11000808
> 
> 赞同：1
> 
> 时间：2012-06-12T16:27:51.400
> 
> 标签：ios, graphviz

我很绝望：（我尝试了各种脚本，但都没有。我的系统是 xCode4.3.2 on Lion (10.7.4) 和 iOS-SDK v5.1

使用脚本：

```
#!/bin/sh
# For iPhoneOS, see http://clang.llvm.org/ for options
export DEV_iOS=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer
# was /Developer/Platforms/iPhoneOS.platform/Developer
export SDK_iOS=${DEV_iOS}/SDKs/iPhoneOS5.1.sdk
export COMPILER_iOS=${DEV_iOS}/usr/bin
export CC=${COMPILER_iOS}/clang
export CXX=${COMPILER_iOS}/clang++
export LDFLAGS="-arch armv7 -pipe -Os -gdwarf-2 -mthumb -isysroot ${SDK_iOS}"
export CFLAGS="${LDFLAGS}"
export OBJCFLAGS="${LDFLAGS}"
export CXXFLAGS="${LDFLAGS} -fvisibility-inlines-hidden"
export LD=${COMPILER_iOS}/ld
export CPP=${COMPILER_iOS}/clang
export AR=${COMPILER_iOS}/ar
export AS=${COMPILER_iOS}/as
export NM=${COMPILER_iOS}/nm
export CXXCPP="${COMPILER_iOS}/clang++"
export OBJC=${COMPILER_iOS}/clang
export RANLIB=${COMPILER_iOS}/ranlib

./configure \
    --build=arm-apple-darwin11 \
    --host=arm-apple-darwin11 \
    --disable-dependency-tracking \
    --enable-shared=no \
    --enable-static=yes \
    --enable-ltdl=no \
    --enable-swig=no \
    --enable-tcl=no \
    --srcdir=${GVROOT} \
    --with-codegens=no \
    --with-cgraph=no \
    --with-graph=yes \
    --with-expat=no \
    --with-fontconfig=no \
    --with-freetype2=no \
    --with-ipsepcola=yes \
    --with-libgd=no \
    --with-quartz=yes \
    --with-visio=yes \
    --with-x=no 
```

我得到错误：

```
checking build system type... arm-apple-darwin11
checking host system type... arm-apple-darwin11
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... config/install-sh -c -d
checking for gawk... no
checking for mawk... no
checking for nawk... no
checking for awk... awk
checking whether make sets $(MAKE)... yes
checking for style of include used by make... GNU
checking for arm-apple-darwin11-gcc... /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/clang
checking whether the C compiler works... no
configure: error: in `/Users/xaviersantamaribech/Developer/graphviz-2.28.0':
configure: error: C compiler cannot create executables
See `config.log' for more details. 
```

谁能告诉我我可以在我的系统中使用什么脚本（XCode4.3.2 - iPhoneSDK5.1 - Lion 10.7.4）来获取IOS的静态库Graphviz。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T13:18:32.613

尚不支持在 iOS 中运行 Graphviz

# macos - 我可以在 OSX 10.8 (Mountain Lion) 上使用 ipfw

> ID：11000810
> 
> 赞同：0
> 
> 时间：2012-06-12T16:27:59.417
> 
> 标签：macos, osx-mountain-lion

我读到 ipfw 将被 pf 防火墙取代。我仍然可以在“标准 mac”上使用 ipfw 为我的应用程序进行一些过滤吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T15:08:37.183

是的，您可以，您的旧规则已转换，但没有用于管理它的 GUI，您必须使用命令行。

苹果说，它现在已经贬值了，你应该使用 PF（man pfctl）。

# jboss - 在 JBoss 6 中将 Resteasy 2.2.1.GA 升级到 2.3.2

> ID：11000811
> 
> 赞同：3
> 
> 时间：2012-06-12T16:27:59.650
> 
> 标签：jboss, resteasy

我们使用的是 JBoss AS 6.1.0.Final，它默认带有 Resteasy 2.2.1.GA。但是，我的任务是使用 Resteasy 2.3.2。在 JBoss 中升级 Resteasy 的正确方法是什么？我一直无法找到如何做到这一点的体面程序。

如果无法升级，如何确保我的应用程序使用 Resteasy 2.3.2 JAR？只需将它们放在我的应用程序的 lib 目录中？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:12:07.523

我刚刚通过执行以下操作将 JBoss AS 6.1.0.Final 更新为 RestEasy 2.3.3：

1.  我删除了“jboss-6.1.0.Final/server/default/deployers/resteasy.deployer”下的所有jar文件，除了“jboss-as-resteasy-6.1.0.Final.jar”

2.  [我从sourceforge.net](http://sourceforge.net/projects/resteasy/files/Resteasy%20JAX-RS/2.3.3.Final/)下载了 RestEasy并解压了 zip 文件

3.  我将所有 jar 文件从“resteasy-jaxrs-2.3.3.Final/lib”复制到“jboss-6.1.0.Final/server/default/deployers/resteasy.deployer”

请注意，RESTeasy 2.3.4（以及随后的 2.3.3）中的 Apache Commons 库比 JBoss 6.1.0GA 中打包的库更旧。值得考虑保持原样；IE。不降级他们。

# lucene - Lucene：如何获得两条记录，其中一条*必须*包含某个值

> ID：11000815
> 
> 赞同：0
> 
> 时间：2012-06-12T16:28:12.850
> 
> 标签：lucene

如果其中一条记录包含某个值，我正在尝试获取两条记录。我很难为此编写 Lucene 查询假设我们有以下文档： Document 1 id:1 role:superuser

文件 2 id:3

文档 3 id:5

我正在查询仅当其中一个是超级用户时才按 id 检索两个文档。

```
+(id:1 id:3) +((+id:1 +role:superuser)(+id:3 role:superuser)) 
```

只给我超级用户文档。

有任何想法吗？

干杯，马克

# json - 如何配置 ExtJS 4 Store（代理和阅读器）来读取元数据

> ID：11000819
> 
> 赞同：8
> 
> 时间：2012-06-12T16:28:44.473
> 
> 标签：json, extjs, model, proxy, extjs4

我的问题是如何获取除 totalRecords 之外的元数据，在我的情况下是版本、代码、搜索查询（请查看 json）。

```
{
"result": {
    "version":"1",
    "code":"200",
    "searchquery": "false",
    "totalRecords": "2",
    "account":[
            {
                "lastname": "Ivanoff", 
                "firstname": "Ivan", 
                "accountId":"1"
            },
            {
                "lastname": "Smirnoff", 
                "firstname": "Ivan", 
                "accountId":"2"
            }
        ]
} 
```

}

这是我的模型：

```
Ext.define("test.Account", {
    extend: "Ext.data.Model",
    fields: [
        {name: 'accountId', type: 'string'},
        {name: 'lastname', type: 'string'},
        {name: 'firstname', type: 'string'}    
    ]
}); 
```

并存储：

```
Ext.define("test.TestStore", {
    extend: "Ext.data.Store",
    model: "test.Account",
    proxy: {
        type: "ajax",
        url: "users.json",  
        reader: {
            type    : 'json',
            root    : 'result.account',
            totalProperty: "result.totalRecords"
        }
    },

    listeners: {
        load: function(store, records, success) {
            console.log("Load: success " + success);     
        }
    }
}); 
```

使用这家商店，我可以加载记录（帐户）并且找不到任何方法来访问其余字段。

先感谢您。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-13T16:09:16.127

这是我的问题的解决方案。我正在处理 Proxy 类中的 afterRequest 事件，我可以在其中获取响应数据、解析它并保存元数据。这是 TestStore 类的代理部分：

所以这是 TestStore 类的代理部分：

```
proxy: {
        type: "ajax",
        url: "/users.json",  
        reader: {
            type    : 'json',
            root    : 'gip.account',
            totalProperty: "gip.totalRecords",
            searchquery: "searchquery"
        },
        afterRequest: function(req, res) {
            console.log("Ahoy!", req.operation.response);    
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T14:05:27.810

可以使用商店的 'metachange' 事件。

所有非 extjs 特定信息都可以在 JSON 中分组到单独的对象中：

```
{
    "result": {
        "totalRecords": "2",
        "account":[
            {
                "lastname": "Ivanoff", 
                "firstname": "Ivan", 
                "accountId":"1"
            },
            {
                "lastname": "Smirnoff", 
                "firstname": "Ivan", 
                "accountId":"2"
            }
        ]
    },
    "myMetaData": {
        "version":"1",
        "code":"200",
        "searchquery": "false"
    }
} 
```

商店配置为

```
Ext.define("test.TestStore", {
    extend: "Ext.data.Store",
    model: "test.Account",
    proxy: {
        type: "ajax",
        url: "users.json",  
        reader: {
            type    : 'json',
            root    : 'result.account',
            totalProperty: "result.totalRecords",
            metaProperty: 'myMetaData'
        }
    },

    listeners: {
        metachange: function(store, meta) {
            console.log("Version " + meta.version + "Search query " + meta.searchQuery);     
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T17:05:40.650

看看`Ext.data.Proxy`类和更具体的`processResponse()`方法。如果您需要提取任何其他数据 - 您将必须扩展标准类并更改该方法。

# php - PHP - 如何从一行中的多个 p 标签中获取文本

> ID：11000822
> 
> 赞同：0
> 
> 时间：2012-06-12T16:28:55.893
> 
> 标签：php, regex, preg-replace

我有一个包含一些 html 的变量。在 html 中有几个 p 标签彼此相邻。我想从那些 p 标签中检索文本并将它们格式化为 1 段并将这个新段落设置为一个新变量。那有意义吗？

```
<h2></h2>
<p>date</p>
<ul></ul>
<iframe></iframe>
<p>apple</p>
<p>banana</p>
<p>grape</p>
<ul></ul> 
```

变成：

```
<p>apple banana grape</p> 
```

注意：html 中的元素可能会有所不同。例如，没有 iframe。某处的图像等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:43:48.307

你可以使用 Xpath 来做到这一点

```
$html = '<h2></h2>
<p>date</p>
<ul></ul>
<iframe></iframe>
<p>apple</p>
<p>banana</p>
<p>grape</p>
<ul></ul>';

$doc = new DOMDocument();
$doc->loadHTML($html);

$xpath = new DOMXpath($doc);

$elements = $xpath->query("//p");
foreach ($elements as $node){
echo $node->nodeValue. "<br/>";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:31:18.363

例子：

```
$html = '<h2></h2>
  <p>date</p>
  <ul></ul>
  <iframe></iframe>
  <p>apple</p>
  <p>banana</p>
  <p>grape</p>
  <ul></ul>';

if (preg_match_all('~<p>(?P<paragraphs>.*?)</p>~is', $html, $matches)) {
  print_r($matches['paragraphs']);
} 
```

结果：

```
Array
(
    [0] => date
    [1] => apple
    [2] => banana
    [3] => grape
) 
```

PS **“聪明”投反对票的人，你能评论一下你为什么投反对票吗？:)))))))))))))))**

投反对票的两个人的PPS **特别版：**

```
$document = new DOMDocument();
$document->loadHTML($html);
$paragraphs = $document->getElementsByTagName('p');
$result     = array();

foreach ($paragraphs as $paragraph) {
  $result[] = $paragraph->nodeValue;  
}

print_r($result); 
```

# web - 如何注册像campl.us这样的网站？

> ID：11000824
> 
> 赞同：0
> 
> 时间：2012-06-12T16:29:09.077
> 
> 标签：web, dns, registration

很难找到尚未被其他人抢占的域名。所以我们正在考虑注册像 camera+ has - campl.us 这样的东西，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T17:04:36.373

您要问的是关于顶级域名的参考。[您可以通过访问GoDaddy](http://www.godaddy.com)或[NameCheap](http://www.namecheap.com)等 3rd 方注册商找到顶级域的选择。但是，如果您想购买一个更晦涩难懂的域名（例如“.st”），最好的办法就是在 Google 上运行搜索，并附加“域名购买”字样。您将看到该国家/地区的个人 TLD 注册页面，或者您会发现您实际上无法购买。

资源：

*   顶级域列表：[http ://en.wikipedia.org/wiki/List_of_Internet_top-level_domains](http://en.wikipedia.org/wiki/List_of_Internet_top-level_domains)
*   个别国家注册页面示例（圣多美 - “.st”）：[http ://www.nic.st/](http://www.nic.st/)

# wpf - 从另一个程序集启动时，WPF 窗口为黑色

> ID：11000825
> 
> 赞同：2
> 
> 时间：2012-06-12T16:29:10.753
> 
> 标签：wpf, window

我遇到了一些麻烦...

我的应用程序是基于组件的。所以我有一个程序集，它是启动（WPF 应用程序项目）和一些其他程序集（库），用于 GUI 和渲染等。

现在我必须在启动程序集中打开主窗口。此窗口位于 GUI 库中。使用一些抽象类，我可以访问 GUI 程序集并获取窗口。现在，如果我使用“Show()”打开窗口，我只会得到一个黑色背景的窗口。没有控件可见。

我创建了一个新项目。那里的窗户工作得很好。

我刚刚发现了这个：[WPF：如何从不同程序集中的窗口开始](https://stackoverflow.com/questions/4268466/wpf-how-to-start-from-a-window-in-a-different-assembly)并且它可以工作。但我想在启动时手动执行此操作，因为我首先必须初始化我的核心系统。

对了，这样窗户也是黑的。

有什么问题，我该如何解决？

谢谢 ：）

# javascript - Ctrl+S 防止 Chrome 中的默认设置

> ID：11000826
> 
> 赞同：46
> 
> 时间：2012-06-12T16:29:14.317
> 
> 标签：javascript, jquery, google-chrome, preventdefault

我想在 Chrome 中捕获`Ctrl`+ `S`，并阻止默认浏览器行为来保存页面。如何？

（只是发布问题和答案，因为我在此之后很长时间并没有找到解决方案）

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-06-12T16:29:14.770

据我所知，秘诀是，`Ctrl`+`S`不会触发 keypress 事件，只会触发 keydown 事件。

使用[jQuery.hotkeys](https://github.com/jeresig/jquery.hotkeys)：

```
$(document).bind('keydown', 'ctrl+s', function(e) {
    e.preventDefault();
    alert('Ctrl+S');
    return false;
}); 
```

仅使用 jQuery：

```
$(document).bind('keydown', function(e) {
  if(e.ctrlKey && (e.which == 83)) {
    e.preventDefault();
    alert('Ctrl+S');
    return false;
  }
}); 
```

**编辑 2012.12.17** - jQuery.hotkeys 说

> 如果您在输入元素内部，则不会跟踪热键（除非您将热键直接绑定到输入）。这有助于避免与正常用户键入的冲突。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-06-12T16:42:39.307

[从浏览器中的覆盖控件+s（保存功能）中](https://stackoverflow.com/questions/4446987/overriding-controls-save-functionality-in-browser)“借用”

```
document.addEventListener("keydown", function(e) {
  if (e.key === 's' && (navigator.platform.match("Mac") ? e.metaKey : e.ctrlKey)) {
    e.preventDefault();
    alert('captured');
  }
}, false); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-03-31T07:26:13.477

```
document.onkeydown = function (e) {
    e = e || window.event;//Get event
    if (e.ctrlKey) {
        var c = e.which || e.keyCode;//Get key code
        switch (c) {
            case 83://Block Ctrl+S
                e.preventDefault();     
                e.stopPropagation();
            break;
        }
    }
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-12-12T13:23:03.913

多合一的解决方案，以防止数据

```
// disable right click
$(function() {
    $(this).bind("contextmenu", function(e) {
        e.preventDefault();
    });
}); 

// Prevent F12      
$(document).keydown(function (event) {
    if (event.keyCode == 123) { // Prevent F12
        return false;
    } else if (event.ctrlKey && event.shiftKey && event.keyCode == 73) { // Prevent Ctrl+Shift+I        
        return false;
    }
});

//stop copy of content
function killCopy(e){
    return false
}
function reEnable(){
    return true
}
document.onselectstart=new Function ("return false")
    if (window.sidebar){
    document.onmousedown=killCopy
    document.onclick=reEnable
}

// prevent ctrl + s
$(document).bind('keydown', function(e) {
  if(e.ctrlKey && (e.which == 83)) {
    e.preventDefault();
    return false;
  }
}); 
```

# wpf - 控制模板可见性触发器

> ID：11000830
> 
> 赞同：2
> 
> 时间：2012-06-12T16:29:20.450
> 
> 标签：wpf, xaml, data-binding, custom-controls

我想要对下面的按钮样式做的只是让按钮仅在 IsMouseOver 或 IsPressed 时可见。

它的编写方式甚至无法编译，找不到“字形”。当 IsMoueOver 时，我怎样才能清理这个按钮是可见的？

干杯，
贝里尔

```
<Style x:Key="EditCommandButtonStyle" TargetType="{x:Type Button}">
   <Setter Property="Content">
      <Setter.Value>
         <TextBlock x:Name="Glyph" Width="30" 
            FontFamily="Wingdings 3" FontSize="24" Text="a" Visibility="Hidden"/>
      </Setter.Value>
   </Setter>
   <Setter Property="Template">
      <Setter.Value>
         <ControlTemplate TargetType="{x:Type Button}">
            <Border x:Name="Border" Background="Transparent" CornerRadius="4">
               <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            <ControlTemplate.Triggers>
               <Trigger Property="IsMouseOver" Value="True">
                  <Setter TargetName="Border" Property="Background" Value="LightBlue"/>
                  <Setter TargetName="Glyph" Property="Visibility" Value="Visible"/>
               </Trigger>
               <Trigger Property="IsPressed" Value="True">
                  <Setter TargetName="Border" Property="Background" Value="Orange"/>
               </Trigger>
            </ControlTemplate.Triggers>
         </ControlTemplate>
      </Setter.Value>
   </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T20:36:31.750

使 ContentPresenter 成为命名目标，而不是 TextBlock。

```
<Style x:Key="EditCommandButtonStyle" TargetType="{x:Type Button}">
    <Setter Property="Content">
        <Setter.Value>
            <TextBlock FontFamily="Wingdings 3" FontSize="24" Text="a" />
        </Setter.Value>
    </Setter>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
                <Border x:Name="Border" Background="Transparent" CornerRadius="4">
                    <ContentPresenter x:Name="theContent" Visibility="Hidden"
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter TargetName="Border" Property="Background" 
                                Value="LightBlue"/>
                        <Setter TargetName="theContent" Property="Visibility" 
                                Value="Visible"/>
                    </Trigger>
                    <Trigger Property="IsPressed" Value="True">
                        <Setter TargetName="Border" Property="Background" 
                                Value="Orange"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# jquery - 是否可以在提交函数中调用json函数？

> ID：11000836
> 
> 赞同：1
> 
> 时间：2012-06-12T16:29:33.177
> 
> 标签：jquery, json

以下代码将成功捕获客户端 IP 地址

```
var clientIP;
$.getJSON("http://jsonip.appspot.com?callback=?",
function (data) {
    clientIP = data.ip;
});

$("form").submit(function () {
alert(clientIP);
}); 
```

但是，这会在表单加载时捕获 IP 地址。是否可以对其进行重构，以便仅在用户按下 sumbit 时调用 JSON 函数？例如。

```
$("form").submit(function () {
      var clientIP = <somehow call getJSON function to get client ip>;
alert(clientIP);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:32:26.783

您需要等待响应：

```
$("form").submit(function () {
    $.getJSON("http://jsonip.appspot.com?callback=?",
        function (data) {
            var clientIP = data.ip;
            alert(clientIP);
       });
       // prevent form submission
        return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:32:50.723

```
var clientIP;

function getIP(form) {
  $.getJSON("http://jsonip.appspot.com?callback=?",
  function (data) {
    clientIP = data.ip;
    alert(clientIP);
  });
}

$("form").submit(function (e) {
  e.preventDefault(); // prevent default submission
  getIP(this);
}); 
```

### 笔记

我将表单传递给`getIP()`，以便您可以在该函数中提交表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T16:33:41.197

```
 var clientIP; // declare it global otherwise you wont be able to use it from outside.
    $("form").submit(function () {
       $.getJSON("http://jsonip.appspot.com?callback=?",
        function (data) {
            clientIP = data.ip;
       });
    return false; // return false so the form doesnt actually submit
    }); 
```

# kohana - kohana db select 返回行数而不是结果

> ID：11000842
> 
> 赞同：0
> 
> 时间：2012-06-12T16:29:41.250
> 
> 标签：kohana

出于某种原因，我得到了数字或行，而不是我需要的结果。

```
$sql = "SELECT t1.*,
u.id,
u.username, 
p.profile_picture 
FROM messages t1
JOIN (SELECT from_id, MAX(date) date FROM messages GROUP BY from_id) t2
ON t1.from_id = t2.from_id AND t1.date = t2.date
LEFT JOIN
users u
ON
u.id = t1.from_id
LEFT JOIN
profiles p
ON
p.user_id = t1.from_id
"; 
```

$query = DB::query('Database::SELECT',$sql);

$messages = $query->execute();

echo Kohana::debug($messages); // 出于某种原因在这里获取行数

文件说

> 指定类型会更改返回的结果。使用 Database::SELECT 时，将返回 Database_Query_Result。Database::INSERT 查询将返回插入 ID 和行数。对于所有其他查询，将返回受影响的行数。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:33:56.347

你需要使用`$query = DB::query(Database::SELECT,$sql);`.

注意缺少引号。您需要使用常量值。

# c# - 序列化：更改底层类会成为问题吗？

> ID：11000843
> 
> 赞同：2
> 
> 时间：2012-06-12T16:29:48.837
> 
> 标签：c#, class, serialization

我正在努力解决序列化问题。但是，如果出于某种原因我需要添加或删除一些值或属性，会发生什么？这将如何影响内容？或者这不是问题吗？或者我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T18:09:30.410

正如人们已经指出的那样，这取决于您的序列化程序。`XmlSerializer`在这种情况下更容易处理：

1.  序列化程序针对公共接口工作，因此如果您更改实现，则不会出错。
2.  XML 是人类可读的，因此很容易手动或使用一些 XML 实用程序进行解析。因此，如果其他一切都出错了，您可以编写一个版本转换器。

考虑 Jon 的回答以获取更多提示，尤其是使用`NonSerialized`和`OptionalField`属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:37:12.663

这完全取决于您使用的序列化技术以及您是否计划反序列化遗留对象。

我相信如果您添加或删除属性并且仍然想要反序列化旧版本的对象，您*可能会*遇到一些问题，具体取决于您正在执行的序列化类型。

对于**BinaryFormatter**和**SoapFormatter**：

*   如果添加新属性，则需要使用[OptionalField 属性](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.optionalfieldattribute.aspx)来装饰它们，以便您仍然可以反序列化没有新字段的旧版本对象。
*   如果您要“删除”属性，则必须将它们保留在代码中，但使用[OptionalField 属性](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.optionalfieldattribute.aspx)装饰它们，以便您仍然可以反序列化仍然具有已删除字段的对象的旧版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T17:31:50.790

我可以为 XmlSerializer 说话，因为它在我自己的项目中被广泛使用。

添加属性不会导致 XmlSerializer 出现任何问题，序列化 xml 中缺少的属性只会保留其默认值。删除或重命名现有属性的效果只是数据丢失。除非您处理原始 xml AS xml 或文本文件，否则已删除或重命名的属性中的数据只会丢失。使用 XmlSerializer 时，不需要特殊属性来添加、删除或重命名属性。

# mysql - Mysql - 在价格表中选择低于，等于或高于的计数

> ID：11000846
> 
> 赞同：1
> 
> 时间：2012-06-12T16:30:19.577
> 
> 标签：mysql, sql

我有一个存储各种产品价格的表，并且想知道如果我的价格低于、高于或等于同一天的其他记录，如何进行查询以返回。所有包含 idmonitor 零的记录仅表示这是我的价格，我将在同一天与其他记录进行比较。

```
id | idmonitor | idproduct | price | date
1  | 0         | 5         | 42.00 | 2012-06-01
2  | 1         | 5         | 45.00 | 2012-06-01
3  | 2         | 5         | 50.00 | 2012-06-01
4  | 0         | 6         | 22.00 | 2012-06-01
5  | 1         | 6         | 24.00 | 2012-06-01
6  | 2         | 6         | 26.00 | 2012-06-01
7  | 0         | 5         | 40.00 | 2012-06-03
8  | 1         | 5         | 40.00 | 2012-06-03
9  | 2         | 5         | 40.00 | 2012-06-03
10 | 0         | 6         | 30.00 | 2012-06-03
11 | 1         | 6         | 20.00 | 2012-06-03
12 | 2         | 6         | 10.00 | 2012-06-03 
```

我想查询返回给我一些类似的信息：

```
date       | below | equal | above
2012-06-01 | 2     | 0     | 0
2012-06-02 | 2     | 0     | 0
2012-06-03 | 0     | 1     | 1 
```

我试图让这个查询已经是几天了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:40:25.997

像这样的东西，虽然在性能方面不是最好的查询，但可能会奏效：

```
select aux.date,
       SUM(aux.below) as 'below',
       SUM(aux.equal) as 'equal',
       SUM(aux.above) as 'above'
from
(
   select t1.date,
          t1.idproduct,
          (select count(1) from tablename t2 where t2.date = t1.date and t2.idproduct = t2.idproduct and t2.price > t1.price and t2.idmonitor <> 0) as 'below',
          (select count(1) from tablename t3 where t3.date = t1.date and t3.idproduct = t3.idproduct and t3.price = t1.price and t3.idmonitor <> 0) as 'equal',
          (select count(1) from tablename t4 where t4.date = t1.date and t4.idproduct = t4.idproduct and t4.price < t1.price and t4.idmonitor <> 0) as 'above',
   from tablename t1
   where t1.idmonitor = 0
) aux
group by aux.date 
```

请注意，它来自记忆，我可能会遗漏一些东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:49:17.177

我已经编辑了这个以获得基于 idmonitor=0 的基本价格。我有一个针对我的本地数据库的版本，但是您的字段名称不同，所以我可能有一两个错字。

```
select date, 
  sum(equal_price) as equals,
  sum(above_price) as above,
  sum(below_price) as below from (
select date,
  if (price = base_price, 1, 0) as equal_price,
  if (price > base_price, 1, 0) as above_price,
  if (price < base_price, 1, 0) as below_price
  from orders
  join (select 
    date as base_date, 
      price as base_price
     from orders where idmonitor = 0) as base_price on base_price.base_date = date) as counts
     group by date 
```

# c# - 使用异步操作的 TPL 数据流

> ID：11000847
> 
> 赞同：4
> 
> 时间：2012-06-12T16:30:23.680
> 
> 标签：c#, .net, task-parallel-library, dataflow, tpl-dataflow

我正在通过移植一些旧的套接字代码以使用 TPL 数据流和新的异步功能来试验 TPL 数据流。尽管 API 感觉坚如磐石，但我的代码最终还是感觉很乱。我想知道我是否在这里遗漏了什么。

我的要求如下： 一个套接字类公开：Open、Close、Send 和 Receive 方法。所有都返回一个任务，因此是异步的。Open 和 Close 是原子的。发送和接收可以彼此相邻工作，尽管它们一次只能处理 1 个命令。

从逻辑上讲，这让我想到了下一段内部控制代码：

```
// exposing an exclusive scheduler for connectivity related tasks and a parallel scheduler where send and receive can work with
private readonly ConcurrentExclusiveSchedulerPair exclusiveConnectionSchedulerPair;
private readonly ActionBlock<Action> connectionBlock;
private readonly ActionBlock<Action> sendBlock;
private readonly ActionBlock<Action> receiveBlock;

// within the constructor:
this.exclusiveConnectionSchedulerPair = new ConcurrentExclusiveSchedulerPair();
this.connectionBlock = new ActionBlock<Action>(action => action(), new ExecutionDataflowBlockOptions()  { TaskScheduler = exclusiveConnectionSchedulerPair.ExclusiveScheduler });
this.sendBlock = new ActionBlock<Action>(action => action(), new ExecutionDataflowBlockOptions()    { TaskScheduler = exclusiveConnectionSchedulerPair.ConcurrentScheduler });
this.receiveBlock = new ActionBlock<Action>(action => action(), new ExecutionDataflowBlockOptions() { TaskScheduler = exclusiveConnectionSchedulerPair.ConcurrentScheduler }); 
```

到目前为止一切都很好。我可以安全地将操作发送到发送和接收块，而同时不必担心正在运行的连接相关操作。ActionBlock 还确保多个发送调用是同步的（接收、关闭和打开同上）。

问题是没有简单的方法让动作将任务传达回海报。现在我正在使用 TaskCompletionSource 来传达结果。喜欢：

```
public Task Send(ArraySegment<byte> buffer, CancellationToken cancellationToken)
{
    TaskCompletionSource<object> resultCompletionSource = new TaskCompletionSource<object>();

    sendBlock.Post(async () =>
    {
        if (!tcpClient.Connected)
            throw new InvalidOperationException("Cant send when not open");
        else
        {
            await sendStream.WriteAsync(buffer.Array, buffer.Offset, buffer.Count, cancellationToken);
            resultCompletionSource.SetResult(null);
        }
    });

    return resultCompletionSource.Task;
} 
```

只是感觉丑陋和笨拙。我的问题是：**有没有办法使用 TPL 同步工作流，而不必使用 TaskCompletionSource 进行通信？**

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T16:58:38.003

首先，您根本不需要 TPL 数据流，因为您实际上没有任何数据流。

其次，`TaskScheduler`像这样使用 s 也不是正确的解决方案。`TaskScheduler`s schedule *code*，但是当你`await`有事的时候，没有代码在运行。因此，`WriteAsync()`在进行异步工作时，代码 for`Open()`可以运行。

你真正需要的是类似的东西[`ReaderWriterLock`](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlock.aspx)，但它适用于`async`. 框架中没有类似的东西，但您可以使用[Stephen Toub 的文章*Building Async Coordination Primitives, Part 7: AsyncReaderWriterLock*](http://blogs.msdn.com/b/pfxteam/archive/2012/02/12/10267069.aspx)中的代码，这正是您所需要的。该文章还更详细地解释了为什么使用 a`TaskScheduler`是错误的。

使用`AsyncReaderWriterLock`，您的代码可能如下所示：

```
public async Task Send(ArraySegment<byte> buffer, CancellationToken cancellationToken)
{
    using (await readerWriterLock.ReaderLockAsync())
    {
        if (!tcpClient.Connected)
            throw new InvalidOperationException("Can't send when not open");

        await sendStream.WriteAsync(buffer.Array, buffer.Offset, buffer.Count, cancellationToken);
    }
} 
```

# usb - 处理 UBS 输入只能工作一次，除非我拔下并重新插入硬件。

> ID：11000857
> 
> 赞同：1
> 
> 时间：2012-06-12T16:30:59.387
> 
> 标签：usb, libusb

我下面的代码从 USB 设备（例如鼠标）获取 4 位数据。一切正常，除了当我运行代码和结束时我的鼠标停止工作。如果我再次运行我的代码，那么它会给出错误或不希望的或意外的结果。我必须拔下设备并再次运行我的代码，然后才能得到预期的答案。

什么可能导致这种情况，我该如何解决？

```
 #include <stdlib.h>
 #include <stdio.h>
 #include <string.h>
 #include <libusb-1.0/libusb.h>

//=========================================================================
// This program detects usb and print out their details and reads data
//=========================================================================

int main (int argc, char *argv)
{
libusb_device                    **devList = NULL;
libusb_device                    *devPtr = NULL;
libusb_device_handle             *devHandle = NULL;
libusb_context                   *ctx = NULL;            //a libusb session
struct libusb_device_descriptor  devDesc;
struct libusb_config_descriptor *configDesc ;
unsigned char              strDesc[256];
ssize_t                    numUsbDevs = 0;      // pre-initialized scalars
ssize_t                    idx = 0;
int                        retVal = 0;

//========================================================================
// test out the libusb functions
//========================================================================

 printf ("*************************\n USB Detection    Program:\n*************************\n");
retVal = libusb_init (&ctx);

if(retVal < 0) {
    printf ("%d",retVal," Init Error "); //there was an error
        return 1;
          }

//========================================================================
// Get the list of USB devices visible to the system.
//========================================================================

numUsbDevs = libusb_get_device_list (ctx, &devList);  //Return no.of USB Devices

//========================================================================
// Loop through the list, looking for the device 
//========================================================================

while (idx < numUsbDevs)
{
  printf ("\n\n[%d]\n", idx+1);

  //=====================================================================
  // Get next device pointer out of the list, use it to open the device.
  //=====================================================================

  devPtr = devList[idx];

  retVal = libusb_open (devPtr, &devHandle);
  if (retVal != LIBUSB_SUCCESS)
     break;

  //=====================================================================
  // Get the device descriptor for this device.
  //=====================================================================

  retVal = libusb_get_device_descriptor (devPtr, &devDesc);
  if (retVal != LIBUSB_SUCCESS)
     break;

  //=====================================================================
  // Get the string associated with iManufacturer index.
  //=====================================================================

 printf ("iManufacturer = %d", devDesc.iManufacturer);
  if (devDesc.iManufacturer > 0)
  {
     retVal = libusb_get_string_descriptor_ascii
              (devHandle, devDesc.iManufacturer, strDesc, 256);
     if (retVal < 0)
        break;

     printf ("     string = %s",  strDesc);
  }

  //========================================================================
  // Get string associated with iProduct index.
  //========================================================================

  printf ("  \niProduct      = %d", devDesc.iProduct);
  if (devDesc.iProduct > 0)
  {
     retVal = libusb_get_string_descriptor_ascii
              (devHandle, devDesc.iProduct, strDesc, 256);
     if (retVal < 0)
        break;

     printf ("     string = %s", strDesc);
  }

  //==================================================================
  // Get string associated with iSerialNumber index.
  //==================================================================

  printf ("  \niSerialNumber = %d", devDesc.iSerialNumber);
  if (devDesc.iSerialNumber > 0)
  {
     retVal = libusb_get_string_descriptor_ascii
              (devHandle, devDesc.iSerialNumber, strDesc, 256);
     if (retVal < 0)
        break;

     printf ("     string = %s", strDesc);
  }

  //==================================================================
  // Print product id and Vendor id and 
  //==================================================================

    printf ("  \nProductid     = %d", devDesc.idProduct);
    printf ("  \nVendorid      = %d", devDesc.idVendor);

  //========================================================================
  // Close and try next one.
  //========================================================================

  libusb_close (devHandle);
  devHandle = NULL;
  idx++;

  //========================================================================
  // Selection of device by user
  //========================================================================

     if(idx==numUsbDevs) 
            { printf("\n\nselect the device :  ");
              scanf("%d",&idx);
         if(idx > numUsbDevs)
             {printf("Invalid input, Quitting.............");
              break; }    

       devPtr = devList[idx-1];

       retVal = libusb_open (devPtr, &devHandle);
           if (retVal != LIBUSB_SUCCESS)
           break;

      retVal = libusb_get_device_descriptor (devPtr, &devDesc);
           if (retVal != LIBUSB_SUCCESS)
           break;
               printf ("  \nProductid     = %d", devDesc.idProduct);
               printf ("  \nVendorid      = %d", devDesc.idVendor);

      retVal = libusb_get_config_descriptor(devPtr, 0, &configDesc);

      printf( "\nNumber of Interfaces:%d", (int)configDesc->bNumInterfaces);

      const struct libusb_interface *inter;
      const struct libusb_interface_descriptor *interdesc;
      const struct libusb_endpoint_descriptor *epdesc;

      int i,j,k ;
      for ( i = 0; i < (int)configDesc->bNumInterfaces; i++) {

      inter = &configDesc->interface[i];

      printf( "\nNumber of alt settings: %d " , inter->num_altsetting);

      for ( j = 0; j < inter->num_altsetting; j++) {

       interdesc = &inter->altsetting[j];

       printf( "\nInterface number: %d" ,(int)interdesc->bInterfaceNumber);

       printf( "\nNumber of endpoints: %d" , (int)interdesc->bNumEndpoints);

       for ( k = 0; k < (int)interdesc->bNumEndpoints; k++) {

       epdesc = &interdesc->endpoint[k];

       printf("\n\nDescriptor type:%d " ,(int)epdesc->bDescriptorType);

       printf("\nEP Address     : %d" ,(int)epdesc->bEndpointAddress);

      }  

     }

    }

   //========================================================================
   // Reading Data
   //========================================================================

     unsigned char data[4]; //data to read

        // data[0]='a';data[1]='b';data[2]='c';data[3]='d'; //some dummy values

    if(libusb_kernel_driver_active(devHandle, 0) == 1) { //find out if kernel driver is attached

         printf("\nKernel Driver Active\n");

    if(libusb_detach_kernel_driver(devHandle, 0) == 0) //detach it

        printf("Kernel Driver Detached!");
     }

         int r; //for return values 
          r = libusb_claim_interface(devHandle, 0); //claim interface of device

      if(r < 0) {

    printf("\nCannot Claim Interface %d",r);

    return 1;
                }

    printf("\nClaimed Interface\n");

   int actual_length; //used to find out how many bytes were written

   r = libusb_bulk_transfer(devHandle,129, data, sizeof(data), &actual_length, 0);
     printf("r is %d\n",r);

FILE *fp;
fp=fopen("test.txt","w");
      if (r == 0 && actual_length == sizeof(data)) {

            for(i=0; i<sizeof(data);i++)
        {
                    fprintf(fp,"%u\t",data[i]);
            printf("%u\t",data[i]);
        }
      // results of the transaction can now be found in the data buffer
             // parse them here and report button press
          } 
      else {
             error();
           } 

   r = libusb_release_interface(devHandle, 0); //release the claimed interface

   if(r!=0) {

            printf("\nCannot Release Interface");

            return 1;
           }

            printf("\nReleased Interface");

            idx=numUsbDevs +2; //to exit if statement
            }

   }  // end of while loop

  if (devHandle != NULL)
 {
  //========================================================================
  // Close device if left open due to break out of loop on error.
  //========================================================================

  libusb_close (devHandle);
 }   

 libusb_exit (ctx); //close the session

 printf ("\n*************************\n        Done\n*************************\n");
 return 0;
 }

//==========================================
// EOF
//========================================== 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T14:35:29.977

您分离设备的当前驱动程序；

```
libusb_detach_kernel_driver(devHandle, 0) 
```

但是当您完成后无法重新连接（`libusb_release_interface`不会为您执行此操作）。您需要`libusb_attach_kernel_driver()`在完成后致电以恢复内容。

# ios - 从同一个开发者帐户上传类似的应用程序到 App Store

> ID：11000858
> 
> 赞同：0
> 
> 时间：2012-06-12T16:31:04.070
> 
> 标签：ios, app-store

我们有几个应用程序允许用户搜索特定区域的所有可用房产，然后我们有几个应用程序适用于几家不同的公司，允许用户搜索只有该公司在营销的房产 - 即您可以拥有应用程序公司 1、公司 2 和公司 3 等除了品牌外看起来都一样，但每个都只返回他们正在营销的属性的结果。苹果会允许我们通过一个苹果开发者账号发布这些应用吗？如果它违反了苹果的条款和条件，请指导我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T12:32:21.123

您可以从单个帐户中释放它们，只要它们具有不同的名称并分配有唯一且不同的应用程序 ID。苹果不会以这些理由拒绝这些应用程序。我见过有人向客户出售此类解决方案/模板，并且他们正在从同一个开发者帐户中出售。

# php - 插入数据时避免 MySQL 中的重复条目？

> ID：11000865
> 
> 赞同：0
> 
> 时间：2012-06-12T16:31:34.993
> 
> 标签：php, mysql, duplicates, record, forms

我有一个严重的问题，我没有弄清楚。我有一个名为“结果”的表名。我想要实现的是，当我插入新记录时，它会正确插入数据库。

在那个级别，我的脚本运行良好。但是我想要第二次点击添加新的结果记录，如果之前输入了数据，那么它会显示我的数据，这样如果我想更新我的数据，我可以。如果之前没有输入数据，那么我会将数据插入数据库。我成功限制用户输入重复数据，但我没有成功在同一页面上显示该数据。

我有一个显示测试页面，当我单击此链接时，我会在其中放置链接管理结果，会打开一个新页面，其中所有学生都以特定的 class_id 列出，并且在他们的名字之后有生物学、化学等领域......我输入他们的分数。

我的表结构是这样的：

## 表的表结构`results`

```
CREATE TABLE IF NOT EXISTS `results` (
  `result_id` int(11) NOT NULL AUTO_INCREMENT,
  `class_id` int(10) NOT NULL,
  `student_id` int(10) NOT NULL,
  `test_id` int(10) NOT NULL,
  `biology` int(10) NOT NULL,
  `chemistry` int(10) NOT NULL,
  `math` int(10) NOT NULL,
  `english` int(10) NOT NULL,
  `urdu` int(10) NOT NULL,
  `marks_obtained` int(10) NOT NULL,
  `created` datetime NOT NULL,
  `updated` datetime NOT NULL,
  PRIMARY KEY (`result_id`),
  UNIQUE KEY `student_id` (`student_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=4 ; 
```

如果您有任何问题，请问我。抱歉解释太长了！

```
<?php 
include("includes/config.php"); 

$id=$_GET['class_id'];
$id2 = $_GET['test_id'];

if($_SERVER['REQUEST_METHOD']=='POST'){

foreach($post as $key=>$val){
    $$key   =   $val;
}

$z  =   0;
foreach($post['biology'] as $biology1){
    $biology    =   $biology1;
    $student_id =   $post['student_id'][$z];
    $test_id =   $post['test_id'][$z];

    $chemistry      =   $post['chemistry'][$z];
    $math       =   $post['math'][$z];
    $english        =   $post['english'][$z];
    $urdu       =   $post['urdu'][$z];
    $marks_obtained =   $post['marks_obtained'][$z];
    $marks_obtained .= $biology+$chemistry+$math+$english+$urdu;

        if(isset($get['class_id']) and $get['test_id']){        

        $link = mysql_query("SELECT * from results where student_id='$student_id'");
        $res = mysql_num_rows($link);

        if($res>0) {

            $link2 = mysql_query("SELECT * from results where class_id='$class_id' AND test_id='$test_id'");

        }else {

    mysql_query("INSERT into results values('','$class_id','$student_id','$test_id','$biology','$chemistry','$math','$english','$urdu','$marks_obtained',now(),'')")or die(mysql_error());
    $z++;

            }
        }
    }
}
?> 
```

**HTML**

```
<form method="post" action="" enctype="multipart/form-data">
    <table border="1" />

        <tr>
        <th>Student Name</th>

        <th>Biology</th>
        <th>Chemistry</th>
        <th>Math</th>
        <th>Engllish</th>
        <th>Urdu</th>

        </tr>
        <?php 

        $query = mysql_query("SELECT id,class_id,student_name from student where class_id='$id'") or die(mysql_error());
        while($rec =mysql_fetch_array($query)) {

        ?>

        <?php do { ?>

        <tr>
         <input name="class_id" type="hidden" value="<?php echo $rec['class_id'];?>" />
        <input name="student_id[]" type="hidden" value="<?php echo $rec['id'];?>" tabindex="1" />
        <input name="test_id[]" type="hidden"  value="<?php echo $id2;?>" tabindex="1" />

        <td><?php echo $rec['student_name'];?></td>

        <td><input name="biology[]" type="text" tabindex="2" value="<?php echo $rows['biology'];?>" /></td>
        <td><input name="chemistry[]" type="text" tabindex="5"  value="<?php echo $rows['chemistry'];?>" /></td>
        <td><input name="math[]" type="text" tabindex="7" value="<?php echo $rows['math'];?>" /></td>
        <td><input name="english[]" type="text" tabindex="4"  value="<?php echo $rows['english'];?>" /></td>
        <td><input name="urdu[]" type="text" tabindex="6" value="<?php echo $rows['urdu'];?>" /></td>
            <input name="marks_obtained[]" type="hidden" tabindex="9" />

      <?php } while($rows=mysql_fetch_array($link2))?>  <?php } ?>

        </tr> 

        <tr><td><button type="submit">Add Records</button></td></tr>
        </table>

    </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T17:00:21.240

我看到 student_id 上有一个唯一索引。这意味着您的表格在任何时候都只会为每个学生保存一组结果。因此，我猜当您说“如果之前输入了数据”时，您的意思是“如果为同一学生输入了第二组结果”。

你有两个选择：要么

*   在尝试输入重复的 student_id 时捕获外键约束引发的异常，然后获取该 student_id 的结果并填充您的表单
*   或者，可能更好的是，在插入之前检查 student_id 是否存在，如果存在，请不要插入，获取该 student_id 的结果并填充您的表单。所以你需要类似的东西：

    从结果中选择 COUNT(*)，其中 student_id=12345

（其中 12345 是您尝试插入的 student_id）

如果结果大于零（在这种情况下它只能是 1），请不要插入，取而代之并填充您的表单。那是：

```
SELECT * FROM results WHERE student_id=12345 
```

**编辑：**您也可以使用

```
INSERT... ON DUPLICATE KEY UPDATE 
```

...并避免检查、显示结果和更新它们。

看看[这个问题](https://stackoverflow.com/questions/2848904/php-check-if-record-exist)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:48:25.687

为此，您必须获取当前驻留在数据库中的数据，然后将其与您插入的数据进行比较。如果找到匹配，则显示错误消息，否则触发插入查询

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-19T02:08:32.903

您可以通过使用此字符 && 示例来避免重复数据

```
if($_post['usename'] && $_post['password'] && $_post['items']){
  echo "You fill all items";
} else {
  echo fill all items recommended!!
} 
```

# wpf - DrawingContext.DrawLine：笔没有完全不透明度？

> ID：11000866
> 
> 赞同：5
> 
> 时间：2012-06-12T16:31:37.920
> 
> 标签：wpf, transparency, opacity, z-order, drawingcontext

当我画这样的东西时（这里只是随机画）：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        DrawingVisual visual = new DrawingVisual();
        DrawingContext context = visual.RenderOpen();

        Pen pen = new Pen(Brushes.Black, 1);

        context.DrawEllipse(Brushes.YellowGreen, pen, new Point(0,0), 40, 40);

        for (int i = 0; i <= 100 - 1; i++)
          context.DrawLine(new Pen(Brushes.Black, 1), new Point(0, i), new Point(i, i));

        context.Close();

        RenderTargetBitmap bmp = new RenderTargetBitmap(100, 100, 96, 96, PixelFormats.Pbgra32);

        bmp.Render(visual);
        image1.Source = bmp;
    }
} 
```

**DrawLine 和 DrawEllipse 的颜色混合。**（我发现它只适用于使用笔的 DrawLine，而不是使用 Brush 的其他形式，如 Rectangle 和 Ellipse）。奇怪的是，即使使用来自底层网格背景 (argh) 的 LinearGradientBrush 的颜色。 **我希望它们每个都具有完全不透明度的 z 顺序。**

这里是 XAML 代码：

```
<Window x:Class="WpfApplication2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525">
    <Image Name="image1" Stretch="None" />
</Window> 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-07T13:05:28.917

RenderTargetBitmap 有两个抗锯齿或子像素化问题：

1.

禁用位图本身的子像素化（例如，当它在 UIElement 中呈现时）。这可以通过应用解决：

```
 RenderOptions.SetBitmapScalingMode(image1, BitmapScalingMode.NearestNeighbor); 
```

（其中 image1 是 WPF Image 对象）。

它仅支持 .NET 4 及更高版本。在您的特定情况下，这并不重要，因为线条是逐像素渲染的。

2.

渲染 INTO RenderTargetBitmap 时禁用子像素。可以通过RenderOptions.SetEdgeMode方法实现，参数值为EdgeMode.Aliased。

但是，此方法仅在以下情况下才有效：

*   为 DrawingGroup 对象调用该方法。

*   抗锯齿几何仅通过常规绘图复合嵌套（例如，如果 DrawingGroup 包含一个矩形，其中 VisualBrush 封装了一个 DrawingVisual，即使您使用该方法，该 DrawingVisual 的内容也将被抗锯齿）。

因此，您可以按如下方式重写代码：

```
 DrawingVisual visual = new DrawingVisual();
    DrawingGroup group = new DrawingGroup();

    Pen pen = new Pen(Brushes.Black, 1);

    group.Children.Add(new GeometryDrawing(Brushes.YellowGreen, pen, new EllipseGeometry(new Point(0,0), 40, 40)));

    for (int i = 0; i <= 100 - 1; i++)
      group.Children.Add(new GeometryDrawing(null, new Pen(Brushes.Black, 1), new LineGeometry(new Point(0, i), new Point(i, i))));

    RenderOptions.SetEdgeMode(group, EdgeMode.Aliased);

    DrawingContext context = visual.RenderOpen();
    context.DrawDrawing(group);
    context.Close();

    RenderTargetBitmap bmp = new RenderTargetBitmap(100, 100, 96, 96, PixelFormats.Pbgra32);

    bmp.Render(visual);
    image1.Source = bmp; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T17:17:09.190

您发布的代码是在彼此旁边绘制多条细线。它们中的每一个都经过抗锯齿处理，并且其侧面变得模糊。我想你描述的不透明度混合效果就是因为这个而发生的。

如果你画了一条粗线（即宽度为 10），效果就不会出现。

因此，解决方案取决于您要达到的目标：

*   您可以尝试禁用抗锯齿，如果这令人满意，有关此的更多信息，请查看此处：[禁用 WPF 图像上的抗锯齿](https://stackoverflow.com/questions/1738956/disabling-antialiasing-on-a-wpf-image)
*   用宽度更大的 Pen 画线，即`new Pen(Brushes.Black, 2)`
*   在这种画线彼此靠近的特殊情况下，您可以将计数器增加 0.5f 而不是 1，因此请替换`for (int i = 0; i <= 100 - 1; i++)`为`for (float i = 0.0f; i <= 100 - 1; i+=0.5f)`.
*   如果您不介意编写更多代码，则可以创建自己的自定义 Bitmap 类，该类不会使图像模糊。此处提供了一些解决方案[http://www.nbdtech.com/Blog/archive/2008/11/20/blurred-images-in-wpf.aspx](http://www.nbdtech.com/Blog/archive/2008/11/20/blurred-images-in-wpf.aspx)以及那里引用的站点

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-07T15:26:02.823

这里的另一种（更简单）方法：

[https://stackoverflow.com/a/10257614/2463642](https://stackoverflow.com/a/10257614/2463642)

对于您的示例，您只需要创建一个类，例如：

```
 public class AliasedDrawingVisual : DrawingVisual
    {
        public AliasedDrawingVisual()
        {
            this.VisualEdgeMode = EdgeMode.Aliased;
        }
    } 
```

并用 AliasedDrawingVisual 替换您的 DrawingVisual 实例：

```
 DrawingVisual visual = new AliasedDrawingVisual(); // Here is the only change
    DrawingContext context = visual.RenderOpen();

    Pen pen = new Pen(Brushes.Black, 1);

    context.DrawEllipse(Brushes.YellowGreen, pen, new Point(0,0), 40, 40);

    for (int i = 0; i <= 100 - 1; i++)
      context.DrawLine(new Pen(Brushes.Black, 1), new Point(0, i), new Point(i, i));

    context.Close();

    RenderTargetBitmap bmp = new RenderTargetBitmap(100, 100, 96, 96, PixelFormats.Pbgra32);

    bmp.Render(visual);
    image1.Source = bmp; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-05T12:31:02.547

我在以编程方式渲染到`DrawingContext`. 唯一可行的方法是使用`GuidelineSet`：[http ://wpftutorial.net/DrawOnPhysicalDevicePixels.html](http://wpftutorial.net/DrawOnPhysicalDevicePixels.html)

# windows - Windows 上的命令行 Git

> ID：11000869
> 
> 赞同：77
> 
> 时间：2012-06-12T16:31:50.523
> 
> 标签：windows, git, command-line

我已经在我的 Windows 7 机器上安装了 msysGit 1.7.10。我需要知道的是我是否仍然可以从命令行使用 Git？

`git`当我现在在命令行中尝试该命令时，我看到：

> 'git' 不是内部或外部命令、可运行程序或批处理文件。

有什么办法可以启用 Git 命令行？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2013-10-21T10:32:28.467

我遇到了同样的问题，并通过将`/bin`目录位置添加到 PATH 环境变量来解决它。

1.  搜索安装 Git 的文件位置，我的是`C:\Users\(My UserName)\AppData\Local\GitHub`. 它也可能是`C:\Program Files (x86)\Git`

2.  获得 Git 的位置后，您应该会看到一个`/bin`子文件夹。它可能在 PortableGit 文件夹中（我的是 `PortableGit_015aa71ef18c047ce8509ffb2f9e4bb0e3e73f13`）。复制此路径。

3.  转到控制面板 > 系统 > 系统保护 > 高级 > 环境变量

4.  选择 PATH，单击编辑并将 bin 路径粘贴到那里。如果您的 PATH 中已经有任何值，请将您的 Git 路径粘贴到末尾，并用分号分隔。

现在您可以从 CMD 访问 Git 命令。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-06-12T17:08:59.193

正如@birryree 所说，将 msysgit 的二进制文件添加到您的 PATH 中，或者使用 Git Bash（据我记得是与 msysgit 一起安装的），它比 Windows 的控制台更好，并且类似于 Unix 控制台。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-11-25T15:34:45.053

这些说明适用于安装了 msysgit/TortoiseGit 的 Windows 8，但应该适用于 Windows 上其他类型的 git 安装。

*   转到**控制面板\系统和安全\系统**
*   单击左侧的**高级系统设置，打开系统属性。**
*   单击**高级选项卡**
*   单击对话框底部的**环境变量按钮。**
*   编辑名为**PATH的****系统变量**。
***   将这两个路径附加到系统变量中已存在的现有路径列表中。棘手的部分是需要两条路径。这些路径可能因您的 PC 而异。`;C:\msysgit\bin\;C:\msysgit\mingw\bin\`*   如果 CMD 提示窗口已经打开，请关闭它。CMD 需要重新启动才能获取更新的 Path 变量。*   尝试在命令行中输入**git**，您应该会看到 git 命令列表向下滚动屏幕。**

 *** * *

## 回答 #4

> 赞同：14
> 
> 时间：2016-01-01T11:40:39.400

**在 windows 8.1**中，将 PATH 环境变量设置为 Git 的`bin`目录对我不起作用。相反，我不得不使用`cmd`目录`C:\Program Files (x86)\Git\cmd`。

[在这个问题](https://stackoverflow.com/questions/3426347/how-to-run-ruby-and-git-commands-in-one-place-on-windows)中感谢@VonC

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-10-03T14:00:57.900

对我来说，我使用的是 Windows 10，@andrew-marshall 的说明有效（谢谢！）除了它`git.exe`位于. 以为我会在这里发布这个，以防其他人遇到同样的问题。您可以告诉它在新的命令提示符窗口中工作一次，返回命令使用信息而不是错误。`cmd``PortableGit...``bin``\cmd``PATH``git`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-09-16T20:49:52.960

在最新版本中（我写的时候是v2.19 for Windows），如果你选择“在Windows命令提示符中使用git”选项（或者类似的东西，请在安装git时仔细阅读选项），你应该可以在 windows 命令提示符或 windows powershell 中使用 git 命令，无需任何额外设置。只需记住在安装 git 后重新启动命令行工具即可。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-01-09T01:50:39.780

您可以安装[Chocolatey](https://chocolatey.org/)。就像 Linux 中的 apt-get 一样，您可以使用命令行进行安装。以管理员身份运行命令提示符并键入`choco install git`，您将能够安装专用于命令行的 git。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-03T04:33:57.183

如果您在 Windows 10 中安装了 GitHubDesktop，请按 Ctrl + '。或在菜单中转到存储库>在命令提示符下打开。

如果你的机器上没有安装 git，你应该会得到一个安装 git 的提示。（我由此知道 GitHubDesktop 和 git 是不同的应用程序）。安装 git，关闭命令提示符并再次打开它。

您可以通过在命令提示符下输入 git 来测试您的安装。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-11-29T16:44:32.880

截至目前，使用 win 1909 并使用 Git-2.24.0.2-64 位安装程序，该过程对用户配置非常友好。似乎现在可以解决早期的问题。**

# c++ - 以下循环的时间复杂度是多少

> ID：11000877
> 
> 赞同：-1
> 
> 时间：2012-06-12T16:32:00.520
> 
> 标签：c++, big-o, time-complexity

```
for (int i=0; i<N; i++)
 for (int j=i; j<N; j++)
  fun1(i,j); 
```

上面是一个嵌套的 for 循环。第一个 for 循环从 0 到 N，第二个 for 循环从 i 到 N。上面代码的时间复杂度是多少？

编辑：fun1 是 o(1)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T16:36:19.363

O(n²*O(乐趣))。显然，答案取决于乐趣的复杂性。

编辑：由于 fun() = O(1)，复杂循环复杂度为 O(n²)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T16:46:06.607

循环数如下 1+2+3+...+N 即 N * (N + 1)/2 = N^2/2 + N/2。因此，时间复杂度为 O(N^2/2 + N/2) = O(N^2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T16:40:27.823

因为`fun1()`是常数时间，所以循环的复杂度是 `O(N^2)`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T16:54:01.790

外部 for 循环将运行内部 for 循环 N 次。

内部 for 循环将在外部循环的第一个循环中调用 fun1(i,j) N 次。然后在外部 for 循环的第二个循环中执行 (N-1) 次。然后 (N-2) 次，然后 (N-3) 次，依此类推，直到 fun1(i,j) 只运行一次时外部循环的第 N 个循环 (i = N-1)。因此，我们在内部循环的每次迭代中平均运行 fun1(i,j) 次 N/2 次。

因此假设 fun1(i,j) 的复杂度为 O(fun1(i,j))，我们得到的总复杂度为 **O(n * (n/2) * O(fun1(i,j))) = O( n^2/2 * O(fun1(i,j)))** 但是由于我们可以忽略 N 的大值的数值常数来衡量复杂性，因此代码的复杂性顺序将为**O(n^2 * O(fun1(我，j）））**

由于 fun1(i,j) 是常数时间**O(fun1(i,j)) = O(1)**并且您的代码的复杂性将为**O(n^2)**

他可以在这个[**选择排序算法**](http://www.cprogramming.com/tutorial/computersciencetheory/sorting2.html)中看到一个类似的例子。请参阅选择排序算法。在这里，而不是你的 fun1(i,j) 一个简单的赋值行 'index_of_min = y;' 已使用，但这就像您的示例一样，可能会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T16:36:42.433

内部循环的主体执行`N + (N - 1) + (N - 2) + ... + 3 + 2 + 1`次数

因此`N + (N - 1) + (N - 2) + ... + 3 + 2 + 1 <= N * N`循环体将运行次数增加`O(n^2)`

代码的总时间增长将取决于`fun1 ()`. 如果`fun1 ()`时间增长，`O(fun1)`则`fun1 ()`执行`O(N^2)`次数将是：`O(n^2 * O (fun1 ()))`

**编辑**

正如您所编辑`fun1 ()`的`O(1)`那样，总复杂性是`O(n^2 * O (fun1 ())) = O(n^2)`

# c# - C# 通用列表 foreach OutofMemoryException

> ID：11000880
> 
> 赞同：3
> 
> 时间：2012-06-12T16:32:22.237
> 
> 标签：c#, foreach, out-of-memory, generic-list, sharpkml

我有一个程序可以从数据库中读取大约 200 万行到列表中。每行是一个包含地理坐标等信息的位置。

将数据添加到列表后，我将使用 foreach 循环并获取坐标以创建 kml 文件。当行数很大时，循环会遇到 OutOfMemoryException 错误（但在其他情况下可以正常工作）。

关于如何处理这个问题的任何建议，以便程序可以处理非常大的数据集？kml 库是 SharpKML。

我还是 C# 的新手，所以请放轻松！

这是循环：

```
 using (SqlConnection conn = new SqlConnection(connstring))
        {
            conn.Open();
            SqlCommand cmd = new SqlCommand(select, conn);

            using (cmd)
            {
                SqlDataReader reader = cmd.ExecuteReader();
                while (reader.Read())
                {
                    double lat = reader.GetDouble(1);
                    double lon = reader.GetDouble(2);
                    string country = reader.GetString(3);
                    string county = reader.GetString(4);
                    double TIV = reader.GetDouble(5);
                    double cnpshare = reader.GetDouble(6);
                    double locshare = reader.GetDouble(7);

                    //Add results to list
                    results.Add(new data(lat, lon, country, county, TIV, cnpshare, locshare));
                }
                reader.Close();
            }
            conn.Close();
        }

            int count = results.Count();
            Console.WriteLine("number of rows in results = " + count.ToString());

            //This code segment generates the kml point plot

            Document doc = new Document();
            try
            {
                foreach (data l in results)
                {
                    Point point = new Point();
                    point.Coordinate = new Vector(l.lat, l.lon);

                    Placemark placemark = new Placemark();
                    placemark.Geometry = point;
                    placemark.Name = Convert.ToString(l.tiv);

                    doc.AddFeature(placemark);

                }
            }
            catch(OutOfMemoryException e)
            {
                throw e;
            } 
```

这是列表中使用的类

```
 public class data
    {
        public double lat { get; set; }
        public double lon { get; set; }
        public string country { get; set; }
        public string county { get; set; }
        public double tiv { get; set; }
        public double cnpshare { get; set; }
        public double locshare { get; set; }

        public data(double lat, double lon, string country, string county, double tiv, double cnpshare,
            double locshare)
        {
            this.lat = lat;
            this.lon = lon;
            this.country = country;
            this.county = county;
            this.tiv = tiv;
            this.cnpshare = cnpshare;
            this.locshare = locshare;
        }

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T16:36:21.913

为什么在写入之前需要存储所有数据？与其将每一行添加到列表中，不如在读取每一行时对其进行处理，然后忘记它。

例如，尝试像这样滚动您的代码：

```
Document doc = new Document();
while (reader.Read())
{
    // read from db
    double lat = reader.GetDouble(1);
    double lon = reader.GetDouble(2);
    string country = reader.GetString(3);
    string county = reader.GetString(4);
    double TIV = reader.GetDouble(5);
    double cnpshare = reader.GetDouble(6);
    double locshare = reader.GetDouble(7);

    var currentData = new data(lat, lon, country, county, TIV, cnpshare, locshare));

    // write to file
    Point point = new Point();
    point.Coordinate = new Vector(currentData.lat, currentData.lon);

    Placemark placemark = new Placemark();
    placemark.Geometry = point;
    placemark.Name = Convert.ToString(currentData.tiv);

    doc.AddFeature(placemark);
} 
```

这只有在`Document`合理实施的情况下才有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T16:59:48.997

奥利弗是对的（我投赞成票）。性能方面，你可以做一些其他的事情。首先不要查询您不会使用的字段。然后将所有变量声明（Oliver 的代码）移到 while 语句 (?) 之前。最后，不要等待您的 sql server 收集并发送回所有记录，而是逐步进行。例如，如果您的记录有一个 UID，并且获取它们的顺序是这个 UID，那么从本地 C# 变量“var lastID = 0”开始，将您的 select 语句更改为类似（预格式化）“select top 1000 ...其中 UID > lastID”并重复您的查询，直到您一无所获或任何内容少于 1000 条记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T16:46:40.773

如果用数据库中的数据填充列表没有大的延迟，并且您没有提到用数据填充列表的问题，为什么不立即创建您的 Point 和 Placemark 对象。代码如下。

```
 var doc = new Document();

    using (SqlConnection conn = new SqlConnection(connstring))
    {
        conn.Open();
        SqlCommand cmd = new SqlCommand(select, conn);

        using (cmd)
        {
            var reader = cmd.ExecuteReader();
            while (reader.Read())
            {
                double lat = reader.GetDouble(1);
                double lon = reader.GetDouble(2);
                string country = reader.GetString(3);
                string county = reader.GetString(4);
                double TIV = reader.GetDouble(5);
                double cnpshare = reader.GetDouble(6);
                double locshare = reader.GetDouble(7);

                var point = new Point();
                point.Coordinate = new Vector(lat , lon );

                var placemark = new Placemark();
                placemark.Geometry = point;
                placemark.Name = Convert.ToString(TIV);

                doc.AddFeature(placemark);

            reader.Close();
        }
        conn.Close();
    } 
```

如果没有充分的理由在内存中检索这么多数据，请尝试使用一些延迟加载方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T17:17:50.143

@drdigit，

我会避免循环执行查询。一个查询应始终返回该时刻所需的尽可能多的数据。在这种情况下，您将有 1000 个查询返回 1000 行。也许快速显示前 1000 行会更好，但我不确定如果你在循环中执行 1000 个更快的查询而不是只执行一个查询，它是否会更快。也许我错了......

如果在这种情况下需要延迟加载，我认为您的方法非常适合延迟加载。

# html - 在 CSS 背景图像中向上移动文本

> ID：11000881
> 
> 赞同：0
> 
> 时间：2012-06-12T16:32:24.590
> 
> 标签：html, css, background-image

通常我很擅长使用 CSS 并且能够弄清楚其中的大部分内容，但这让我很难过。

基本上在我们的小部件上，“单击此处”按钮中的文本需要向上移动，以便该文本上方和下方有相等的间隙（相对于红色框）。

**HTML：**

```
<button onclick="setLocation('amplifiers/pioneer-appradio-2-sph-da100.html/index.htm')" class="button btn-cart" title="Shop NOW" type="button">
<span><span>Click Here</span> 
```

**CSS：**

```
.banner button {
    float: right;
    margin-top: 25px;
    margin-right: 40px;
}
.banner button span {
    background: transparent url(../images/media/slider_button_bg.png) 0 0 no-repeat!important;
    height: 24px;
    padding-left: 12px;
}
.banner button span span {
    background-position: 100% 0!important;
    padding-left: 0;
    padding- right: 12px;
    font-weight: bold;
    color: #FFFFFF;
} 
```

如果你想看看我在问什么，有问题的网站是[http://foscam-uk.com/index.php 。](http://foscam-uk.com/index.php)

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:48:21.977

我不能完全让你的代码工作（我认为它可能会从你的 css 的其余部分中丢失一些东西）。但是您应该能够通过将其设置`line-height`为与容器高度相同（在本例中为 24px）来使其居中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:54:29.127

没有必要为此使用 span 。尝试仅通过 css 制作按钮背景，因为它会减少无用的 http 请求。

```
 <button onclick="setLocation('speakers/pioneer-ts-g172ci.html/index.htm')" 
    class="button btn-cart" id="thisPartButton" title="Shop NOW" type="button">
Click Here</button> 
```

并且可以为这个特定按钮制作 css

```
#thisPartButton{
color:white;
background:#CE0B08;  //replace it with your image
padding:7px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T17:04:50.783

除了您在此处粘贴的内容之外，您的页面中还使用了另一种样式，这导致按钮文本的垂直放置在它所在的位置。

`button.btn-cart span` （在你的styles.css的第203行）有`line-height:31px;`

减小行高（在我的本地测试中，25px 看起来很合理）以更正文本位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-12T16:48:09.810

你能不能告诉带文本的跨度是相对的并将其放置在适当的坐标上？

甚至是margin-top / margin-bottom？

[否则，对于垂直对齐，请在此处](http://www.vertical-align.com/)尝试。

# javascript - Javascript函数未获取Windows用户名

> ID：11000884
> 
> 赞同：1
> 
> 时间：2012-06-12T16:32:33.850
> 
> 标签：javascript, internet-explorer, activex

```
function getWindowsUserName()
{
    var WinNetwork = new ActiveXObject("WScript.Network");
    var urlToSite = "http://localhost/index.php?nph-psf=0&HOSTID=AD&ALIAS=" + WinNetwork.UserName;      
    window.frames["psyncLink"].src = "http://localhost/index.php?nph-psf=0&HOSTID=AD&ALIAS=" + WinNetwork.UserName;
    return;
} 
```

我正在尝试使框架加载 urlToSite

```
<body onload="getWindowsUserName()">
    <frameset cols="300px, *"> 
        <frame src="topo1.htm" name="topo" id="topo" application="yes" /> 
        <frame src="topo1.htm" name="psyncLink" id="psyncLink" application="yes" /> 
    </frameset> 
</body> 
```

其实现在我只是得到一个空白页。如果我在 IE 中访问同一个站点并手动输入用户名（不区分大小写），则页面会在 IE 中加载。因此我认为这是代码中的问题

* * *

```
<html>
    <head>
    <title>AIDS (Automated ID System)</title>
    <HTA:APPLICATION 
    id="frames" 
    border="thin" 
    caption="yes" 
    icon="http://www.google.com/favicon.ico" 
    showintaskbar="yes" 
    singleinstance="yes" 
    sysmenu="yes" 
    navigable="yes" 
    contextmenu="no" 
    innerborder="no" 
    scroll="auto" 
    scrollflat="yes" 
    selection="yes" 
    windowstate="normal" />

<script language="javascript" type="text/javascript">

    function getWindowsUserName()
    {
        var WinNetwork = new ActiveXObject("WScript.Network");
        var urlToSite = createCustomURL(WinNetwork.UserName);
        document.getElementById("psyncLink").src = urlToSite;
    }

    function createCustomURL(userName)
    {
        var customURL = "http://localhost/index.php?nph-psf=0&HOSTID=AD&ALIAS=" + userName;
        return customURL;
    }

</script>

    </head> 
    <body onload="getWindowsUserName()">
        <frameset cols="300px, *"> 
            <frame src="topo1.htm" name="topo" id="topo" application="yes" /> 
            <frame src="topo1.htm" name="psyncLink" id="psyncLink" application="yes" /> 
        </frameset> 
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:37:40.637

几个问题：

*   JavaScript`+`用于连接，而不是`&`
*   属性名称区分大小写。尝试`WinNetwork.UserName`
*   您正在尝试设置`src`不存在的框架窗口的属性。您需要设置框架 DOM 对象的 src。即`window.frames`返回一个 Window 对象并`document.getElementById('')`返回对 HTMLFrameElement 的引用
*   （来自 Teemu）您不能在同一页面上同时拥有框架集和正文标签。

代码

```
var urlToSite = "http://localhost/index.php?nph-psf=0&HOSTID=AD&ALIAS=" +
                 encodeURIComponent(WinNetwork.UserName);

document.getElementById("psyncLink").src = urlToSite; 
```

**参考** [http://www.pctools.com/guides/scripting/detail/108/?act=reference](http://www.pctools.com/guides/scripting/detail/108/?act=reference)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T17:29:08.150

尽管不允许嵌套`frameset`，但对于那些不支持框架的浏览器，在“旧时代”元素之后包含在内。这在 IE9 标准模式下仍然有效，但是你看不到帧。`body``body``frameset`

要`getWindowsUserName()`在页面加载后执行，您可以执行以下操作：

```
 window.onload=getWindowsUserName;
</script>
</head>
<frameset cols="300,*">
   <frame src="" name="topo" ...>
   <frame src="topo1.htm" name="psyncLink" ...>
</frameset> 
```

或者移动`getWindowsUserName()`到 topo1.htm。

[MSDN 中](http://msdn.microsoft.com/en-us/library/ie/ms535251%28v=vs.85%29.aspx)的更多信息[`frameset`](http://msdn.microsoft.com/en-us/library/ie/ms535251%28v=vs.85%29.aspx)

# wordpress - iframe 4shared 不可见的 chrome 和 ie9

> ID：11000885
> 
> 赞同：0
> 
> 时间：2012-06-12T16:32:47.263
> 
> 标签：wordpress, google-chrome, iframe, browser, internet-explorer-9

以下代码在浏览器 chrome 中不可见，并且 IE9 似乎无法打开或不可见此代码和 4shared 上的播放列表生成

```
<iframe marginWidth=0 marginHeight=0 frameborder=0 border=0 cellspacing=0 src=http://www.4shared.com/pl/Dd1KpM8G/Need_For_Speed_-_The_Run.htmlscrolling=no width=320 height=260></iframe> 
```

测试： http: [//gamermag.com.br/index.php/screenshots-e-wallpapers/](http://gamermag.com.br/index.php/screenshots-e-wallpapers/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T18:06:34.007

正如@dop-trois 所说，这些值应该用引号引起来。

```
<iframe marginWidth="0" marginHeight="0" frameborder="0" border="0" cellspacing="0" src="http://www.4shared.com/pl/Dd1KpM8G/Need_For_Speed_-_The_Run.html" scrolling="no" width="320" height="260"></iframe> 
```

请记住，有些网站会阻止使用类似于下面的 JS 在 iF​​rame 中加载他们的页面，因此如果您尝试加载这样的网站（例如 Twitter），它不会显示任何内容或将您的整个页面重定向到他们的网站。请注意这一点。

```
if(top.frames.length > 0)
    top.location.href=self.location; 
```

# image-processing - 本地特征研究主题最合适的名称是什么？

> ID：11000890
> 
> 赞同：1
> 
> 时间：2012-06-12T16:33:01.277
> 
> 标签：image-processing, computer-vision, feature-detection

在我目前的研究中，我一直在阅读关于计算机视觉主题的文章，似乎没有人同意如何称呼它：**“本地特征”** 在我看来，所有的名称都有一定的意义，它们是描述该主题的不同方式。

我已经看到以下所有似乎指的是同一件事的描述：

*   自然特征

*   局部不变特征（有时更具体：比例/旋转不变特征）

*   特征点

*   兴趣点

*   关键点

*   以及上面的其他变体。

哪一个更适合命名这个研究课题，或者它们之间是否存在显着差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T09:34:10.937

不变是一种特定的品质，这意味着给定不变属性（比例/旋转/等）的变化，描述保持不变。至于特征点/兴趣点/关键点之间的区别，我认为这是相当主观的，尽管我可能会认为特征或关键点可能是最常见的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T02:26:34.427

我在 SIFT 上工作了很多，最常出现的词肯定是关键点，所以在我看来它更合适，因为毕竟找到关键点只是更大图景的一部分。

# asp.net - asp.net 站点无法从默认页面运行

> ID：11000894
> 
> 赞同：2
> 
> 时间：2012-06-12T16:33:54.083
> 
> 标签：asp.net, .net, postback

只要您在页面上指定包括 .aspx 扩展名的完整文件名，我就有一个运行良好的 .net 站点。当您尝试在没有指定 default.aspx 的情况下运行默认页面时，不会触发回发。

例如

[http://www.site.com/](http://www.site.com/) （回发不起作用）

[http://www.site.com/default.aspx](http://www.site.com/default.aspx) （回发工作）

[http://www.site.com/directory](http://www.site.com/directory) （回发不起作用）

[http://www.site.com/directory/default.aspx](http://www.site.com/directory/default.aspx) （回发工作）

我以前从未在.net 网站上遇到过这个问题，所以很难理解问题所在。我已经检查了最基本的东西，即确保 default.aspx 是一个默认页面等。检查我的 web.config 文件与一个正常工作的网站等。

我仍然不明白为什么会发生这种行为。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:55:42.497

卢卡斯，感谢分享这个答案。

实际上，在 URL 中未明确提供 default.aspx 的情况下，表单操作标记为空。

将以下代码添加到 global.asax 已解决问题：

```
void Application_BeginRequest(object sender, EventArgs e)
{
    var app = (HttpApplication)sender;
    if (app.Context.Request.Url.LocalPath.EndsWith("/"))
    {
    app.Context.RewritePath(
             string.Concat(app.Context.Request.Url.LocalPath, "default.aspx"));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-25T15:24:04.313

我在一个站点上遇到了这个问题，并将应用程序池类型更改为经典。这解决了问题。

# iphone - 无法安装 Xcode 4.5 预览版

> ID：11000900
> 
> 赞同：6
> 
> 时间：2012-06-12T16:34:14.540
> 
> 标签：iphone, ios, xcode, ipad

我已经下载了 Xcode 4.5 预览版，但无法在 Lion 10.7.4 上安装它。单击“安装”后，安装在开始时冻结。我已经重新启动，它不起作用。有人有保存问题或知道如何完成安装吗？

冻结此页面：（ [来源：][[hostingpics.net](http://img4.hostingpics.net/pics/884738Capturede769cran20120612a768182521.png)][）][![图片](../Images/5e19e47e904f2eb2f4dbaab9d413ecd0.png)](https://i.stack.imgur.com/I9Kbc.png)

编辑：我知道 Xcode 的预览版在 NDA 下，但我们不是在谈论 Xcode 是如何工作的，而是在谈论如何在 Mac 上安装它。所以我终于自己完成了这个如此艰巨的任务......打开dmg文件后，只需将'Xcode45-DP1'文件复制并粘贴到Mac上的任何文件夹中并双击它......感谢您关闭我的答案......

# qt4 - 交叉编译 poppler-qt4

> ID：11000901
> 
> 赞同：1
> 
> 时间：2012-06-12T16:34:15.580
> 
> 标签：qt4, cross-compiling, poppler

我需要知道如何为 arm-linux 交叉编译 libpoppler-qt4。我已经下载了源代码表单[http://poppler.freedesktop.org/](http://poppler.freedesktop.org/)。如何告诉它使用 arm-linux-gcc？以及如何满足它的依赖关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T15:11:50.577

要设置交叉编译，您需要在运行 configure 时指定主机系统

例如，要交叉编译 arm-linux-gcc，您可以使用以下内容：

```
./configure --host=arm-linux-gcc 
```

您可能还想指定它的安装位置，因为您可能不希望在（我假设是）x86 机器上具有 arm 架构的库。为此，请使用 --prefix 指定目标路径，例如：

```
./configure --host=arm-linux-gcc --prefix=/<your destination path> 
```

请记住，一旦您指定了前缀，您将不得不将此位置指示给依赖于您刚刚构建的库的任何其他项目，因为否则它们可能会在默认位置中查找。（即/usr/local/lib）

就依赖关系而言，Poppler 有几个。首先，你有 Fontconfig，它本身依赖于 Freetype 和 Expat。为了在 ARM 架构中构建 Poppler，您必须首先使用上述配置命令交叉编译这些其他依赖项。之后，依赖项将取决于您希望为 Poppler 打开哪些选项，如果需要 jpeg 支持，则必须交叉编译 libjpeg，如果需要支持压缩 PDF，则需要交叉编译和链接 zlib 等。

希望有帮助！

# node.js - 节点，redis。检查密钥是否存在，如果不存在则创建新的

> ID：11000911
> 
> 赞同：5
> 
> 时间：2012-06-12T16:35:10.827
> 
> 标签：node.js, redis, key, exists

我是 nodejs 的新手，也许没有事件系统应该如何工作。找不到错误。请指教。我需要一个简单的任务 - 检查标签，如果它不存在，设置新的密钥和有关标签的信息。问题是 - 然后我第一次运行脚本，它总是返回“键不存在”。检查 redisdb 键 - 它创建了许多标签这是我的代码

```
for (x = 0; x < rows.length; x++) {
    if (rows[x].term_taxonomy_id != 1) {
        var taxonomy = findOne(rterms, rows[x].term_taxonomy_id);
        rc.exists('tag:' + taxonomy.name, function (err, rexists) {
            if (rexists == false) {
                rc.incr('tags:count', function (err, id) {
                    console.log(taxonomy.name+' not exists. result ' + rexists);
                    rc.set('tag:' + taxonomy.name,id);
                    rc.hmset('tag:' + id,
                        'id', id,
                        'title',taxonomy.name,
                        'url', taxonomy.slug
                    );
                });//incr
            }else{
                console.log(taxonomy.name+' exists!'+rexists);
            };
        });//exists
    };//ifrows
}); 
```

这是另一个例子

```
var tags = [
  "apple",
  "tiger",
  "mouse",
  "apple",
  "apple",
  "apple",
  "tiger",
  "mouse",
  "mouse",
];
var count =0;
Object.keys(tags).forEach (function (tag) {
  rc.get("tag:"+tags[tag],function(err,rr){
    console.log("get tag "+tags[tag]+" result code "+rr);
    if (rr == null) {
      rc.set("tag:"+tags[tag],"info",function(err,rr){
        count++;
        console.log('set tag '+tags[tag]+' '+rr+' objects count '+count);
      });
    };
  });
}) 
```

输出：

```
get tag apple result code null
get tag tiger result code null
get tag mouse result code null
get tag apple result code null
get tag apple result code null
get tag apple result code null
get tag tiger result code null
get tag mouse result code null
get tag mouse result code null
set tag apple OK objects count 1
set tag tiger OK objects count 2
set tag mouse OK objects count 3
set tag apple OK objects count 4
set tag apple OK objects count 5
set tag apple OK objects count 6
set tag tiger OK objects count 7
set tag mouse OK objects count 8
set tag mouse OK objects count 9 
```

看起来nodejs执行所有'get'命令并且仅在'set'命令之后。所以......我明白，这都是因为异步操作。但是如何让它发挥作用呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T17:27:42.227

这段代码至少有两个问题：

*   第一个链接到 Javascript 闭包管理。循环体不会创建范围。使用 Javascript，变量的范围是函数级别，而不是块级别。您需要在循环本身中引入一些函数来强制创建正确的闭包。更多信息[在这里](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)。

*   第二个是存在和设置命令之间的竞争条件。如果您有多个 Redis 连接运行并在相同的键上设置命令，您可能会遇到某种冲突。而不是使用存在和设置，您应该使用[setnx](http://redis.io/commands/setnx)在一个原子操作中执行检查和设置。

考虑您的第二个示例，已通过使用 forEach 解决了闭包问题，但由于语言的异步特性，您仍会在 set 操作之前生成所有 get 操作。

如果您真的想对所有 get 和 set 操作进行排序（顺便说一句，这会慢得多），那么您可以使用一些函数式编程来使用递归来实现循环。

**示例**：

这个程序：

```
var redis = require('redis')
var rc = redis.createClient(6379, 'localhost');

var tags = [
  "apple",
  "tiger",
  "mouse",
  "apple",
  "apple",
  "apple",
  "tiger",
  "mouse",
  "mouse",
];

var count = 0;

function loop(tags) {
  function rec_loop(tags,i) {
     if ( i >= tags.length )
        return
     rc.get("tag:"+tags[i],function(err,rr) {
        console.log("get tag "+tags[i]+" result code "+rr);
        if ( rr == null ) {
           rc.set("tag:"+tags[i],"info",function(err,rr) {
              count++;
              console.log('set tag '+tags[i]+' '+rr+' objects count '+count);
              rec_loop(tags,++i)
           })
        } else
          rec_loop(tags,++i)
     })
  }
  rec_loop(tags,0)
}

loop(tags) 
```

显示：

```
get tag apple result code null
set tag apple OK objects count 1
get tag tiger result code null
set tag tiger OK objects count 2
get tag mouse result code null
set tag mouse OK objects count 3
get tag apple result code info
get tag apple result code info
get tag apple result code info
get tag tiger result code info
get tag mouse result code info
get tag mouse result code info 
```

请注意，此示例中仍然存在竞争条件。您应该使用 setnx 来实现这种检查和设置操作。

# facebook - Facebook API 批处理请求不允许将名称参数用作标签

> ID：11000914
> 
> 赞同：0
> 
> 时间：2012-06-12T16:35:44.820
> 
> 标签：facebook, facebook-graph-api

我正在通过循环以下代码为 Facebook API 构建批处理请求：

```
//$fbid = a user's facebook id      
$query = array (
            'method' => "GET",
            //'name' => "{$fbid}",
            'relative_url' => '/'.$fbid.'/friends?fields=name,first_name,last_name,id,work,education&access_token='.$token
        ); 
```

这工作正常。但是，当我用参数取消注释第三行时`name =>`，我没有得到任何数据。我找到了很多可以做到这一点的例子，所以我不知道为什么它不起作用。

我需要添加此字段的原因是因为我需要将返回的朋友与正确的原始用户相关联。这似乎是一种简单的方法，但我对替代方案持开放态度。谢谢！

更新：根据[这篇文章](https://stackoverflow.com/questions/7428923/linking-responses-to-requests-with-facebook-batch-requests)，API 不支持 name 参数，除非您使用它来分配依赖项。所以这可以解释为什么我的方法不起作用......任何人都有一个有效的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T14:51:18.643

根据这篇文章，API 不支持 name 参数，除非您使用它来分配依赖项。所以这可以解释为什么我的方法不起作用......任何人都有一个有效的解决方案？

# call - 是否有 iOS 6“通话记录”API？

> ID：11000919
> 
> 赞同：0
> 
> 时间：2012-06-12T16:36:02.230
> 
> 标签：call, history, ios6

我今天收到了来自 Apple 的 iOS 6 测试版电子邮件。我一直在等待这个版本，看看是否存在任何类型的呼叫历史 API。iOS 6 发行说明页面目前已关闭，API 站点仅升级到 iOS 5.1，所以我仍然找不到任何关于它的信息，想知道是否有其他人知道？

基本上我想知道在 iOS 4 中工作的通话历史数据库访问，在 iOS 5 中被删除，是否偶然发现它可以在 iOS 6 中工作？

```
NSString *p=@"/private/var/wireless/Library/CallHistory/call_history.db";
sqlite3 *d;
if(sqlite3_open([p UTF8String], &d) == SQLITE_OK)
{
    NSLog(@"call_history present");
}
else
{
    NSLog(@"Failed to open database with message '%s'.", sqlite3_errmsg(d));
    sqlite3_close(d);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T05:57:10.550

由于缺少 call_history 数据库的读取权限，上述代码段在 iOS 6 beta 2 上不起作用。

# c - free() 如何“知道”传递的指针是有效的？

> ID：11000928
> 
> 赞同：3
> 
> 时间：2012-06-12T16:36:32.560
> 
> 标签：c, pointers, free

我知道无效的指针会导致未定义的行为，但是 free 如何知道指针是否有效？

空闲列表中每个块的开头是否有校验和？就像是：

```
if((*ptr) == 'CHECKSUM'))
  free
else
  do something undefined 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-12T16:38:00.303

> 我知道无效的指针会导致未定义的行为，但是 free 如何知道指针是否有效？

唯一的检查是指针是否为空。如果它是一个空指针，free（按规范）将什么也不做。

否则，`free`只是尝试“释放”内存，假设它是由`malloc`、`calloc`或分配的内存`realloc`，这可能导致任何事情发生（通常是坏事）——因此是“未定义的行为”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T16:41:03.257

可能有。但总的来说，它不会。对于许多实现，`free`只是假设它的输入是有效的，并且就好像那是真的一样向前耕作。它完全有权这样做。

这就是行为“未定义”的原因：如果指针无效，则无法预测会发生什么。在执行某些其他堆操作的操作期间`free`和/或稍后执行某些其他堆操作时，内存的随机区域可能会被丢弃；可能导致不相关代码中出现不可预测的行为。该程序可能会在 中立即崩溃`free`，或者稍后在某些明显不相关的位置崩溃。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-12T16:38:31.963

它不知道。它只是假设它是有效的并且行为适当。

如果这个假设是错误的，那么重要的结构可能已经被破坏了——然后会发生什么，我们不得而知。因此未定义的行为。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-12T16:45:43.020

由于指针无效，因此`free`尝试读取“簿记信息”，就好像指针被返回`malloc`并有效一样，这通常会导致释放该无效指针指向的一些随机地址，从而导致损坏/崩溃等。

# html - 如何制作带有圆角的选择菜单

> ID：11000929
> 
> 赞同：0
> 
> 时间：2012-06-12T16:36:33.773
> 
> 标签：html, css

我正在尝试对带有圆角的选择菜单进行css，但我的摆弄没有这样的运气，有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T16:38:42.110

这条规则是圆角，你应该添加你的代码，这样我就可以帮助你更多

```
 -webkit-border-radius: 10px;
    -moz-border-radius: 10px;
    border-radius: 10px; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T16:50:58.830

一般来说，如果你想在一个 select 元素上设置合适的样式，你需要制作你自己的 mock 元素（使用普通的旧 DIV、列表等）。为了保留表单功能，您可以创建一个真正隐藏的 SELECT 并使用脚本将其状态与用户实际交互的模拟元素同步。

如果您是 jQuery 的粉丝，您可以使用 jQuery UI 为您完成大部分工作（[示例](http://jquery-ui.googlecode.com/svn/branches/labs/selectmenu/index.html)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T16:41:54.190

我不是 CSS 专家，但我认为你必须做类似的事情

```
#myDivID
{
-moz-border-radius-bottomleft: 6px;
-moz-border-radius-bottomright: 6px;
-webkit-border-bottom-left-radius: 6px;
-webkit-border-bottom-right-radius: 6px;
border-bottom-left-radius: 6px;
border-bottom-right-radius: 6px;
} 
```

我希望这对你有帮助

# c# - 其他 Nancy.Testing.Browser GET/PUT/POST/DELETE

> ID：11000932
> 
> 赞同：1
> 
> 时间：2012-06-12T16:36:46.640
> 
> 标签：c#, nancy

使用 Nancy 框架... [http://nancyfx.org/](http://nancyfx.org/)

如果我想在客户端使用 Browser 对象来使用 Nancy 服务，就像我们在这个例子中看到的：[https ://github.com/NancyFx/Nancy/wiki/Testing-your-application](https://github.com/NancyFx/Nancy/wiki/Testing-your-application)

```
 ...
    var bootstrapper = new DefaultNancyBootstrapper();
    var browser = new Browser(bootstrapper);

    // When
    var result = browser.Get("/", with => {
        with.HttpRequest();
    });
    ... 
```

即使我的应用没有测试，我是否必须使用 Nancy.Testing ？？？换句话说，是否存在像这个对象一样执行 Get、Put、Post 和 Delete 操作的其他浏览器对象？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T17:26:33.900

你想要一些东西来实际使用服务吗？看看[EasyHttp](https://github.com/hhariri/EasyHttp "EasyHttp")或[RestSharp——](http://restsharp.org/ "RestSharp")它们都为使用 HTTP API 提供了很好的 API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T19:28:46.813

我发现 System.Net.WebClient 类也执行 GET/PUT/POST/DELETE 例如

```
//Creating client instance and set the credentials
var client = new WebClient();
client.Credentials = new NetworkCredential(...);

// using GET Request:
var data = client.DownloadData("http://myurl/.../" + docId);

// Using PUT
var data = Encoding.UTF8.GetBytes("My text goes here!");
client.UploadData("http://myurl/...", "PUT", data);

// Using POST
var data = new NameValueCollection();
data.Add("Field1", "value1");
data.Add("Field2", "value2");
client.UploadValues("http://myurl/...", "POST", data); 
```

但是，最后我决定将 WCF REST 客户端与`webHttpBinding`. 像这样的东西：

```
[ServiceContract]
public interface IMyService
{
     [OperationContract]
     [WebGet(UriTemplate = "{docId}")]
     void GetData(string docId);
 } 
```

具体类：

```
class MyClient: ClientBase<IMyService>, IMyService
{
    public void GetData(string docId)
    {
        Channel.GetData(docId);
    }
} 
```

# android - 使用 Android 的 AudioTrack 来组合声音样本的字节会产生噪音

> ID：11000933
> 
> 赞同：5
> 
> 时间：2012-06-12T16:36:52.667
> 
> 标签：android, audio, wav, audiotrack

我正在构建一个相当简单的 Android 应用程序（sdk 修订版 14：ICS），它允许用户一次选择两个音频剪辑（都是 RIFF/WAV 格式、小端序、签名 PCM-16 位编码）并将它们组合起来创造新声音的各种方法。我用于这种组合的最基本方法如下：

```
//...sound samples are read in to memory as raw byte arrays elsewhere
//...offset is currently set to 45 so as to skip the 44 byte header of basic
//RIFF/WAV files
...
//Actual combination method
public byte[] makeChimeraAll(int offset){
    for(int i=offset;i<bigData.length;i++){
        if(i < littleData.length){
            bigData[i] = (byte) (bigData[i] + littleData[i]);
        }
        else{
            //leave bigData alone
        }
    } 
    return bigData;
} 
```

然后可以通过 AudioTrack 类播放返回的字节数组：

```
....
hMain.setBigData(hMain.getAudioTransmutation().getBigData()); //set the shared bigData
// to the bigData in AudioTransmutation object
hMain.getAudioProc().playWavFromByteArray(hMain.getBigData(), 22050 + (22050*
(freqSeekSB.getProgress()/100)), 1024); //a SeekBar allows the user to adjust the freq
//ranging from 22050 hz to 44100 hz
....
public void playWavFromByteArray(byte[] audio,int sampleRate, int bufferSize){
    int minBufferSize = AudioTrack.getMinBufferSize(sampleRate, 
            AudioFormat.CHANNEL_CONFIGURATION_MONO, AudioFormat.ENCODING_PCM_16BIT);
        AudioTrack at = new AudioTrack(AudioManager.STREAM_MUSIC, sampleRate, 
            AudioFormat.CHANNEL_CONFIGURATION_MONO, AudioFormat.ENCODING_PCM_16BIT,
            minBufferSize, AudioTrack.MODE_STREAM);

        int i = 0;

        at.play();
        at.write(audio, 0, audio.length);     
        at.stop();
        at.release();

       for(i=0;i<audio.length;i++){
           Log.d("me","the byte value at audio index " + i + " is " + audio[i]);
       }

} 
```

使用上面的代码组合和播放的结果接近我想要的（在混合后的声音中仍然可以辨别两个样本），但也有很多裂纹、爆裂声和其他噪音。

那么，三个问题：首先，我是否正确使用了 AudioTrack？其次，AudioTrack 配置中的字节序在哪里考虑？声音本身播放良好，听起来几乎就像我在组合时所期望的那样，因此 RIFF/WAV 格式的小端特性似乎在某个地方传达，但我不确定在哪里。最后，对于有符号的 16 位 PCM 编码，我应该期望看到的字节值范围是多少？我希望从上面的 Log.d(...) 调用中看到 logcat 中的值范围从 -32768 到 32767，但结果往往在 -100 到 100 的范围内（除此之外还有一些异常值）。超过 16 位范围的组合字节值是否可以解释噪声？

谢谢，CCJ

更新：主要感谢 Bjorne Roche 和 William the Coderer！我现在将音频数据读入 short[] 结构，DataInputStream 的字节序是使用 William 的 EndianInputStream (http://stackoverflow.com/questions/8028094/java-datainputstream-replacement-for-endianness) 和组合方法已更改为：

```
//Audio Chimera methods!
public short[] makeChimeraAll(int offset){
    //bigData and littleData are each short arrays, populated elsewhere
    int intBucket = 0;
    for(int i=offset;i<bigData.length;i++){
        if(i < littleData.length){
            intBucket = bigData[i] + littleData[i];
            if(intBucket > SIGNED_SHORT_MAX){
                intBucket = SIGNED_SHORT_MAX;
            }
            else if (intBucket < SIGNED_SHORT_MIN){
                intBucket = SIGNED_SHORT_MIN;
            }
            bigData[i] = (short) intBucket;
        }
        else{
            //leave bigData alone
        }
    } 
    return bigData;
} 
```

具有这些改进的混合音频输出质量非常棒！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T15:32:26.870

我对android音频不熟悉，所以我不能回答你所有的问题，但我可以告诉你根本问题是什么：逐字节添加音频数据是行不通的。由于它有点工作，并且通过查看您的代码以及它最常见的事实，我将假设您有 16 位 PCM 数据。然而，在任何地方，您都在处理字节。字节不适合处理音频（除非音频恰好是 8 位）

字节约为 +/- 128。您说“我希望从上面的 Log.d(...) 调用中看到 logcat 中的值范围从 -32768 到 32767，但结果往往在 - 100 到 100（除此之外还有一些异常值）”好吧，当您从字节数组中打印值时，您怎么可能进入该范围？16 位有符号数据的正确数据类型是短的，而不是字节。如果您打印的是短值，您会看到您期望的范围。

您必须将字节转换为短裤并将短裤相加。这将处理您听到的大部分杂项噪音。但是，既然您正在阅读文件，为什么还要麻烦转换？为什么不使用类似 [http://docs.oracle.com/javase/1.4.2/docs/api/java/io/DataInputStream.html#readShort](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/DataInputStream.html#readShort) ()

下一个问题是您必须处理超出范围的值，而不是让它们“环绕”。最简单的解决方案是简单地将求和作为整数，“剪辑”到短范围，然后存储剪辑的输出。这将摆脱您的点击和弹出。

在伪代码中，整个过程将如下所示：

```
file1 = Open file 1
file2 = Open file 2
output = Open output for writing

numSampleFrames1 = file1.readHeader()
numSampleFrames2 = file2.readHeader()
numSampleFrames = min( numSampleFrames1, numSampleFrames2 )
output.createHeader( numSampleFrames )

for( int i=0; i<numSampleFrames * channels; ++i ) {
    //read data from file 1
    int a = file1.readShort();
    //read data from file 2, and add it to data we read from file 1
    a += file2.readShort();
    //clip into range
    if( a > Short.MAX_VALUE )
       a = Short.MAX_VALUE;
    if( a < Short.MIN_VALUE )
       a = Short.MIN_VALUE;
    //write it to the output
    output.writeShort( (Short) a );
} 
```

你会从“剪辑”步骤中得到一点失真，但没有简单的方法可以解决这个问题，而且剪辑比环绕要好得多。（也就是说，除非你的轨道非常“热”，并且在低频中很重，否则失真不应该太明显。如果这是一个问题，你可以做其他事情：例如将 a 乘以 0.5 并跳过削波，但你的输出会安静得多，这在手机上可能不是你想要的）。

# android - 由于模拟器上没有足够的内存，android -App 上的内存管理不会加载

> ID：11000934
> 
> 赞同：0
> 
> 时间：2012-06-12T16:37:04.780
> 
> 标签：android

我正在尝试将塔罗牌算命牌阅读游戏从 iPhone 移植到 android。我放置了所有占用大约 19 mb 的未缩放图像。我假设机器人通常有 512 mb 的内存？如果整个大小约为 20mb，为什么应用程序不会加载？我确实缩小了图像，所以内存下降到大约 8mb 并且加载正常。

有人知道内存管理是如何工作的或一个好的链接吗？我将有一些声音效果和更多的图形。担心apk加载不出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T16:42:13.827

在 Android 中，每个应用程序都被分配了有限的内存来运行。它通常从 16MB 到 24MB 不等，在旧设备上通常较低。为避免这种情况，游戏通常使用 OpenGL 纹理，因为它们不计入此内存限制 IIRC。此外，从 NDK 分配内存绕过了这个限制，但不是很方便。

您可以将 android:largeHeap="true" 添加到您的标签中以获得分配给您的更多内存，但它仅适用于 3.X 及更高版本，AFAIK。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:50:11.230

首先，仅仅因为图像在磁盘中占用了一点空间，并不意味着它在显示时会使用相同数量的内存。要计算图像将占用多少内存（大约），请执行`H x W x 4`. 然后是 android 施加的限制，这取决于屏幕大小（16 MB 或更高，但不多）。一般来说，您可以全屏显示的图像很少。此外，由于您的图像可能比手机屏幕大得多，因此您需要对它们进行下采样以减少内存占用。SO中有很多关于该主题的信息。

# git - 将标签名称添加到“git log --graph --format=format:'%h - %s'”输出

> ID：11000936
> 
> 赞同：1
> 
> 时间：2012-06-12T16:37:09.670
> 
> 标签：git

如何添加的输出

```
# Get tag distance $(TAGDIST) 
git describe --tags | \
awk '{split($0,TagNameWithTagDist,"-g");
     i=split(TagNameWithTagDist[1],TagDist,"-");
     print(TagDist[i]);}' 
```

到以下输出？

```
git log --graph --format=format:'%h - %s + $TAGDIST' 
```

[我在文档的“Pretty Formats”部分](http://www.kernel.org/pub/software/scm/git/docs/v1.7.3/git-log.html#_pretty_formats)中没有看到`git-log`与此值相对应的占位符。占位符`%d`在提交上显示标签名称，仅在其中创建它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T18:00:20.460

将下面的代码复制为`git-logtagdist`路径中某个目录中命名的文件。请注意，它运行缓慢，因为它`git-describe`为每次提交创建一个新进程。您可以通过批处理运行来加快速度`git-describe`。

```
#! /usr/bin/env perl

use strict;
use warnings;

use Git;

my $repo = Git->repository;

my @logcmd = (
  "log", "--color=always", "--graph",
  "--format=format:%h - %s - !!!DISTANCE!!!",
);

my($fh,$ctx) = $repo->command_output_pipe(@logcmd);

if (-t STDOUT) {
  my(@pager) = $ENV{GIT_PAGER} || $ENV{PAGER} || ("less", "-R");
  open STDOUT, "|-", @pager or die "$0: open: $!";
}

while (<$fh>) {
  # e.g., 797166c - Merge branch 'maint' - !!!DISTANCE!!!
  s<([0-9a-f]{7,})\b(.+ - )!!!DISTANCE!!!> {
    my($sha1,$msg) = ($1,$2);
    my $distance;

    # e.g., v1.7.9.2-334-g797166c
    chomp(my $describe = $repo->command("describe", "--tags", $sha1));
    if ($describe =~ /^(.+?)-([0-9]+)-g/) {
      $distance = "$2 past $1";
    }
    else {
      $distance = "tagged: $describe";
    }

    $sha1 . $msg . $distance;
  }e;

  print;
}

close STDOUT or warn "$0: close: $!"; 
```

样本输出：

```
$ git logtagdist
* 9bea2b5 - Git 1.7.11-rc3 - 标记：v1.7.11-rc3
* 3a2c135 - 合并 git://github.com/git-l10n/git-po - 17 过去 v1.7.11-rc2
|\
| * 3482b14 - 合并 git://github.com/ralfth/git-po-de - 5 过去 v1.7.11-rc2
| |\
| | * d7f22ed - l10n: de.po: 翻译 27 条新消息 - 3 过去 v1.7.11-rc2
| * | 6cb4571 - l10n：更新 po/vi.po 到 v1.7.11.rc2.2.gb694fbb - 3 过去 v1.7.11-rc2
| |/
| * b694fbb - l10n: zh_CN.po: 翻译 27 条新消息 - 2 条过去 v1.7.11-rc2
| * 7256fd7 - l10n：更新 git.pot（27 条新消息，1 条删除消息） - 1 过去 v1.7.11-rc2
* | 73a6e3c - 合并分支 'mm/api-credentials-doc' - 11 过去 v1.7.11-rc2
```

# c# - 在 C# WebBrowser 中使用只读字段

> ID：11000942
> 
> 赞同：2
> 
> 时间：2012-06-12T16:37:32.303
> 
> 标签：c#, webbrowser-control

我目前在 C# WinForms 应用程序中使用 WebBrowser 控件，并尝试控制此控件呈现的一些可变性。

基本上，我的用户登录到我的应用程序提供的单独 UI，然后显示 WebBrowser 控件，导航到预定的登录 URL，然后自动填充该页面上的用户名和密码字段。

但是，为了防止在这个 WebBrowser 控件中出现不可预知的行为，我想让这些用户名和密码文本框在自动填充后成为只读的。本质上，我希望用户看到已经为他们填写的浏览器页面，并且无法编辑。（这样任何身份验证错误都可以由我的应用程序而不是浏览器来处理。）

我目前用于填充文本字段并使它们只读的代码如下：

```
webBrowser1.Document.GetElementById("username").InnerText = username;
webBrowser1.Document.GetElementById("password").InnerText = password;
webBrowser1.Document.GetElementById("username").Enabled = false;
webBrowser1.Document.GetElementById("password").Enabled = false; 
```

不幸的是，当我尝试将字段设置为只读时，身份验证服务器的行为就像未填写密码字段一样，并在单击“提交”按钮后提示用户再次填写。这是预期的行为吗？如果是，我可以尝试哪些其他方法来阻止用户更改浏览器自动填充的凭据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:40:42.283

尝试制作它们`readonly`：

```
webBrowser1.Document.GetElementById("username").SetAttribute("readonly", "readonly");        
webBrowser1.Document.GetElementById("password").SetAttribute("readonly", "readonly"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T16:41:05.713

为什么不创建一个如[本文](http://www.fsmpi.uni-bayreuth.de/~dun3/archives/creating-a-transparent-panel-in-net/108.html)所示的透明面板，该面板将放置在 webbrowser-control 的顶部：

```
/// <summary>
    /// A transparent control.
    /// </summary>
    public class TransparentPanel : Panel
    {
        public TransparentPanel()
        {
        }

        protected override CreateParams CreateParams
        {
            get
            {
                CreateParams createParams = base.CreateParams;
                createParams.ExStyle |= 0x00000020; // WS_EX_TRANSPARENT
                return createParams;
            }
        }

        protected override void OnPaintBackground(PaintEventArgs e)
        {
            // Do not paint background.
        }
    } 
```

这将阻止用户修改这些值。

您可以根据需要显示/隐藏此面板，甚至可以根据需要扩展以捕获鼠标单击位置。

# silverlight - 简单的 MVVM 工具包在 Web 应用程序中有模型文件夹而不是 Silverlight？

> ID：11000952
> 
> 赞同：0
> 
> 时间：2012-06-12T16:38:00.460
> 
> 标签：silverlight, mvvm, mvvm-toolkit

我刚刚注意到 Simple MVVM 工具包的一些有趣之处

模型文件夹位于 Web 应用程序中

Web 应用程序是 .NET

我以为我会在服务器内的模型中定义我所有的复杂逻辑等

我在这里错过了什么吗？我认为 Web 项目只是托管 Silverlight 应用程序？

保罗

# python - Django：使用 AutoField 编辑 ModelForm

> ID：11000955
> 
> 赞同：1
> 
> 时间：2012-06-12T16:38:31.433
> 
> 标签：python, django-models, django-forms, autofield

我正在尝试创建一个视图，用户可以在其中通过模板中的表单编辑数据库记录。我搜索了很多网页（以及 Django 文档），他们在其中教授如何制作这些视图，但他们总是使用 Django 为每个模型生成的“id”。在这个特定的模型中，我必须使用 AutoField 来覆盖“id”。有没有办法使用这个 AutoField 作为 Django 记录的“id”？

这是我的完整模型：

```
class T031003 (models.Model): 
   C003IDCD = AutoField(primary_key=True)
   C003INST = models.IntegerField(unique=True) #usar AutoSlug
   C003TPCD = models.CharField(max_length=1)
   C003CHCD = models.CharField(max_length=14)
   C003MTR = models.CharField(max_length=30, blank=True, null=True)
   C003CTCD = models.CharField(max_length=3)
   C003RZSC = models.CharField(max_length=60, blank=True, null=True)
   C003EML = models.EmailField(max_length = 254, blank=True, null=True)
   C003LOGA = models.CharField(max_length=20)
   C003LOGB = models.DateTimeField()
   C003LOGD = models.CharField(max_length=15, blank=True, null=True)
   C003LOGF = models.CharField(max_length=20, blank=True, null=True)

   def __unicode__(self):
       return '%s' %  self.C003MTR

   class T031003Form(ModelForm):
       class Meta:
          model = T031003
          ordering = ["-C003MTR"]
          exclude = ('C003LOGA','C003LOGB','C003LOGD','C003LOGE','C003LOGF') 
```

这是我试图做的视图，但它给了我错误“没有 T031003 匹配给定的查询。” 没错，因为表中没有“id”：

```
def t031003form_edit(request, id=None):
pin = get_object_or_404(T031003, pk=id)
form = T031003Form(request.POST or None, instance=pin)
if request.method == 'POST':
    if form.is_valid():
        form = form.save(False)
        form.C003LOGA = request.user
        form.C003LOGB = datetime.date.today()
        form.C003LOGD = request.META['REMOTE_ADDR']
        form.C003LOGF = request.META['USERDOMAIN']
        form.save()
        form = T031003Form()
    else:
        return HttpResponseRedirect('/erro/')
return render_to_response('T031003Form_edit.html', {'form': form,}, context_instance=RequestContext(request)) 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T16:51:37.377

如果一个模型有一个 AutoField——一个自动递增的主键——那么这个自动递增的值将在你第一次调用 save() 时被计算并保存为你的对象的一个​​属性：

```
>>> b2 = Blog(name='Cheddar Talk', tagline='Thoughts on cheese.')
>>> b2.id     # Returns None, because b doesn't have an ID yet.
>>> b2.save()
>>> b2.id     # Returns the ID of your new object. 
```

在调用 save() 之前，无法判断 ID 的值是多少，因为该值是由您的数据库计算的，而不是由 Django 计算的。

参考：[https ://docs.djangoproject.com/en/dev/ref/models/instances/?from=olddocs](https://docs.djangoproject.com/en/dev/ref/models/instances/?from=olddocs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-17T07:37:29.650

好吧，多亏了一位密友的帮助，我可以使用表单集来解决问题。这是视图：

```
def t031002form_edit(request, id_auto):
j = get_object_or_404(T031002, pk=id_auto)

T031003FormSet = modelformset_factory(T031002, can_delete=True, max_num=1)

if request.method == 'POST':
    form = T031002FormSet(request.POST or None, request.FILES or None, queryset=T031002.objects.filter(pk=id_auto)) 
    if form.is_valid():
        instance = form.save(commit=False)
        form.C003LOGA = request.user
        form.C003LOGB = datetime.date.today()
        form.C003LOGD = request.META['REMOTE_ADDR']
        form.C003LOGF = request.META['USERDOMAIN']
        for reform in instance:
            reform.save()
    else:
       return HttpResponseRedirect('/erro/')
else:
    form = T031002FormSet(queryset=T031002.objects.filter(pk=id_auto))  
return render_to_response(('T031002Form_edit.html'), {'form': form,}, context_instance=RequestContext(request)) 
```

因此，使用表单集，您可以轻松无忧地工作。希望它可以帮助其他人解决同样的问题。

# matlab - 使用matlab在谷歌地球上绘制时间序列图

> ID：11000957
> 
> 赞同：0
> 
> 时间：2012-06-12T16:38:35.473
> 
> 标签：matlab, plot, google-earth

我有三组数据：

1.  时间
2.  经度
3.  纬度

我想使用 google earth toolbox for matlab 在 google earth 上绘制这个，我需要的是当我移动时间滑块时，应该在 google earth 上绘制一条线。

我试过这个

```
 x  = [longitude, latitude];
   y = time;
   kmlStr = ge_plot(x,y); 
```

但是发生了错误。另一方面 ge_gplot 对此没有意义。

有没有办法我可以使用谷歌地球工具箱做这个时间序列图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T02:02:34.430

创建两个向量：一个用于 x（经度），一个用于 y（纬度）。 `ge_plot(x,y)`将绘制一条连接`(x,y)`这些向量中每对点的线。

如果要在滑块前进时画线，则需要使用回调函数。在此函数中，执行`ge_plot(x(1:ind), y(1:ind) )`位置`ind`由滑块的“时间”值确定。

# facebook-graph-api - Facebook 图形 api 图像源与响应中给出的大小不匹配

> ID：11000958
> 
> 赞同：0
> 
> 时间：2012-06-12T16:38:35.503
> 
> 标签：facebook-graph-api

我需要获取 Facebook 保存的最大图片。根据文档，“源”字段中返回的图像现在应该最大为 960px 宽。我可以确认。但是，如果您查看“图像”字段，则会发现大量其他明显不同且尺寸更大的 url。但是，当我真正按照网址进行操作时，图像根本不是报告的大小！它们永远不会大于 960。请参阅此示例： [http](http://graph.facebook.com/10150369820292147?fields=images) ://graph.facebook.com/10150369820292147?fields=images 。我们不能访问大于 960 的权限吗？我认为他们现在正在保存更大的图像，因为他们在图库中有全屏选项。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-08T20:17:11.633

数组中第一个条目的宽度和高度字段`images`表示在 2048 x 2048 框内显示的图像应有多大，但实际图像文件仍限制为 960 x 960 像素。

# sql - 对表列名的约束（postgresql）

> ID：11000963
> 
> 赞同：0
> 
> 时间：2012-06-12T16:38:45.290
> 
> 标签：sql, database, postgresql, database-design, constraints

我正在使用产品属性的单表继承（可能是以后的类表继承）模型来实现产品数据库。这一切都很好，但我试图弄清楚如何最好地处理产品变体，同时保持参照完整性。

现在我的主要产品表的简化版本如下所示：

```
CREATE TABLE product (

    id     SERIAL         NOT NULL,
    name   VARCHAR(100)   NOT NULL,
    brand  VARCHAR(40)    NOT NULL,
    color  VARCHAR(40)[]  NOT NULL

) 
```

（颜色是一个数组，因此可以列出任何给定产品的所有标准颜色）

为了处理变体，我考虑在名为 product_variant_theme 的表中跟踪产品变化的属性：

```
CREATE TABLE product_variant_theme (

    id              SERIAL       NOT NULL,
    product_id      INT          NOT NULL,
    attribute_name  VARCHAR(40)  NOT NULL

) 
```

其中我插入带有相关product_id 的行，并将属性的列名添加到attribute_name 字段中，例如“颜色”。

现在请随时告诉我这是否是一种完全愚蠢的方法，但我担心attribute_name 和实际列名本身之间缺乏约束。显然，如果更改产品表并删除该列，我可能仍然会在第二个表中留下引用它的行。我正在寻找的功能等价物类似于attribute_name上的外键到描述表的information_schema视图，但我认为没有任何方法可以直接做到这一点，我想知道是否有任何合理的方式来获得这种功能。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T18:30:37.797

你在寻找这样的东西吗？

```
product
=======
id
name

attribute
=========
id
name

product_attribute_map
=====================
product_id
attribute_id
value 
```

# javascript - JS 的最佳实践 - href 或 onclick 中的 window.open()？

> ID：11000967
> 
> 赞同：4
> 
> 时间：2012-06-12T16:38:58.207
> 
> 标签：javascript, html, optimization, compatibility

只是一个关于优化的问题，介于：

```
<a href="#" onClick="javascript:window.open('myUrl.com');">link-1</a> 
```

和 ：

```
<a href="javascript:window.open('myUrlBis.com');">link-2</a> 
```

这个比那个好吗 ？还是更兼容？谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-12T16:40:25.280

最佳做法是[使用`target`属性](http://www.w3.org/TR/html5/links.html#attr-hyperlink-target)：

```
<a href="http://myUrl.com" target="_blank">link-1</a> 
```

如果这不适合，`click`我会选择一个处理程序（最好不是通过属性分配）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T16:42:45.987

没有一个

`href`使用和使其成为常规链接 `target`

```
<a id='my-link' target="_blank" href="http://myUrlBis.com">link-2</a> 
```

如果需要用JavaScript对点击做一些处理，可以使用如下

```
document.getElementById("my-link").onclick = function(e) {
  // Do some processing here, maybe 
  window.location = this.href
  // Return false to prevent the default action if you did redirect with script
  return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T16:47:20.973

没有 JavaScript

```
<a target="_blank" href="myUrlBis.com">link</a> 
```

使用 JavaScript

```
<a target="_blank" href="http://www.example.com" id="myLink">link</a>
<script>
    document.getElementById("myLink").onclick = function(){ //attach click event to link
        var winPop = window.open(this.href);  //`this` is reference to link, get href
        return false;  //prevent click event from clicking the link
    }
</script> 
```

[JSFiddle 示例](http://jsfiddle.net/a9K23/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-12-08T11:05:45.543

下面的代码应该没问题。

```
<a href="javascript:void(0);"  onclick="window.open(url)"> 
```

使用以下代码在 IE（版本：11）中发现问题

```
<a onclick="javascript:window.open(url)"> 
```

问题：当我们在 href 属性中有 javascript window.open 代码时，父窗口在 IE 中被刷新。

# c# - 在 Linux 中使用 Windows 窗体编译 C# 代码

> ID：11000971
> 
> 赞同：1
> 
> 时间：2012-06-12T16:39:17.180
> 
> 标签：c#, linux, mono, gmcs

我下载了一些包含使用 Windows 窗体的 C# 代码的源代码。是否可以在Linux环境（Ubuntu 12.04）下编译代码并运行？

*我已经尝试使用mcs*成功编译一些 C# 源代码并使用*mono*运行生成的*exe*文件。

 *源代码可以在[这里](http://www.apress.com/downloadable/download/sample/sample_id/1028/)下载。如果可能，请描述您将如何编译和运行*第 2 章/OpeningDocument*解决方案。

```
$ mcs Program.cs 
Program.cs(3,14): error CS0234: The type or namespace name `Windows' does not exist in the namespace `System'. Are you missing an assembly reference?
Compilation failed: 1 error(s), 0 warnings 
```

编辑

```
$ gmcs -pkg:dotnet Program.cs 
Program.cs(17,33): error CS0246: The type or namespace name `Form1' could not be found. Are you missing a using directive or an assembly reference?
Program.cs(17,25): error CS1502: The best overloaded method match for `System.Windows.Forms.Application.Run(System.Windows.Forms.Form)' has some invalid arguments
/usr/lib/mono/gac/System.Windows.Forms/2.0.0.0__b77a5c561934e089/System.Windows.Forms.dll (Location of the symbol related to previous error)
Program.cs(17,25): error CS1503: Argument `#1' cannot convert `object' expression to type `System.Windows.Forms.Form'
Compilation failed: 3 error(s), 0 warnings 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T16:47:11.550

如果您没有使用最新版本的 Mono，这应该可以：

```
gmcs -pkg:dotnet *.cs 
```

最新版本的 mono 使用`mcs`而不是`gmcs`. 在之前的版本中，`mcs`目标是 .NET 1.1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T16:51:26.643

您可能希望针对 mono 迁移分析器运行您的代码，以查看哪些失败或不受支持。您可以在此处找到该工具：[http](http://www.mono-project.com/MoMA) ://www.mono-project.com/MoMA 。**注意**要使该工具正常工作，您需要访问 Windows 计算机。

您还可以在[http://www.mono-project.com/Compatibility](http://www.mono-project.com/Compatibility)查看当前单声道与各种 .Net 功能的兼容性。

专门用于 windows 窗体请参阅：[http ://www.mono-project.com/WinForms](http://www.mono-project.com/WinForms)

希望这可以帮助。*

# linq - 使用 Linq 删除超过 10 天的文件

> ID：11000972
> 
> 赞同：1
> 
> 时间：2012-06-12T16:39:18.723
> 
> 标签：linq

我正在使用下面的代码删除超过 10 天的文件。有没有更简单/更智能的方法来做到这一点？

```
string source_path = ConfigurationManager.AppSettings["source_path"];
            string filename= ConfigurationManager.AppSettings["filename"];

            var fileQuery= from file in Directory.GetFiles(source_path,filename,SearchOption.TopDirectoryOnly)
                           where File.GetCreationTime(file)<System.DateTime.Now.AddDays(-10)
                           select file;

            foreach(var f in fileQuery)
            {
                File.Delete(f);
            } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T16:43:45.307

那么有两件事我会改变：

*   `DateTime` *一次*确定分界点，而不是`DateTime.Now`反复重新评估
*   当您只有一个`where`子句时，我不会使用查询表达式：

所以我将查询部分重写为：

```
var cutoff = DateTime.Now.AddDays(-10);
var query = Directory.GetFiles(sourcePath, filename, SearchOption.TopDirectoryOnly)
                     .Where(f => File.GetCreationTime(f) < cutoff); 
```

另一种选择是使用`DirectoryInfo`and `FileInfo`：

```
var cutoff = DateTime.Now.AddDays(-10);
var path = new DirectoryInfo(sourcePath);
var query = path.GetFiles(filename, SearchOption.TopDirectoryOnly)
                .Where(fi => fi.CreationTime < cutoff); 
```

（在 .NET 4 中，您可能还想`EnumerateFiles`改用它。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-12T16:47:34.570

可以使用 LINQ“单线”来执行此过程：

```
Directory.GetFiles(source_path,filename,SearchOption.TopDirectoryOnly)
.Where(f => File.GetCreationTime(file) < System.DateTime.Now.AddDays(-10))
.All(f => {File.Delete(f); return true;); 
```

不要忘记将代码包装在 try catch 中。

# ios - 从 JSON 填充 NSMutableArray

> ID：11000973
> 
> 赞同：0
> 
> 时间：2012-06-12T16:39:21.767
> 
> 标签：ios, nsmutablearray, plist

我是一名正在开发演示应用程序的初学者，该应用程序可让您从四个不同的类别中进行选择。每个类别都将您带到一个 UITableView，我手动填充了一个 NSMutableArray，如下所示：

```
slideshows = [[NSMutableArray alloc] init];

slideshow = [[Slideshow alloc] init];
slideshow.presoTitle=@"All About Ducks";
slideshow.presoInfo=@"Preso1";
[slideshows addObject:slideshow];

slideshow = [[Slideshow alloc] init];
slideshow.presoTitle=@"The Computer Age";
slideshow.presoInfo=@"Preso2";
[slideshows addObject:slideshow];

slideshow = [[Slideshow alloc] init];
slideshow.presoTitle=@"Shovels and You";
slideshow.presoInfo=@"Preso3";
[slideshows addObject:slideshow];

slideshow = [[Slideshow alloc] init];
slideshow.presoTitle=@"Test Em Out";
slideshow.presoInfo=@"Preso4";
[slideshows addObject:slideshow]; 
```

我使用属性 presoTitle 和 presoInfo 制作了一个名为 Slideshow 的自定义对象。slideshows 是数组的名称，slideshow（小写）代表 Slideshow 对象的每个实例（我应该多样化我的名称方案，我知道......）

问题是，我如何从外部文件填充幻灯片数组，而不是为每个类别手动写出来？提前感谢您的 StackOverflow！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T17:24:06.003

您可以将幻灯片信息存储在 plist 中。该[链接](http://mobiledevelopertips.com/data-file-management/reading-a-plist-into-an-nsarray.html)应该对此有所帮助。

# java - 静态变量是否在序列化过程中序列化

> ID：11000975
> 
> 赞同：40
> 
> 时间：2012-06-12T16:39:35.627
> 
> 标签：java

我偶然发现了理解 java 序列化。我在许多文档和书籍中读到静态和瞬态变量不能在 Java 中序列化。我们声明一个 serialVersionUid 如下。

```
private static final long serialVersionUID = 1L; 
```

如果静态变量没有被序列化，那么我们在反序列化过程中经常会遇到异常。

```
java.io.InvalidClassException 
```

其中从反序列化对象中提取serialVersionUID，并与加载类的serialVersionUID进行比较。

据我所知，我认为如果静态变量不能被序列化。这个例外没有任何意义。我可能错了，因为我还在学习。

“java中的静态和瞬态变量不能被序列化”是一个神话吗？请纠正我，我对这个概念一团糟。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-05-10T07:43:56.900

1.  **实例变量：**这些变量是序列化的，所以在反序列化过程中我们会取回序列化状态。

2.  **静态变量：**这些变量没有序列化，所以在反序列化过程中，静态变量值将从类中加载。（当前值将被加载。）

3.  **瞬态变量：** `transient`变量未序列化，因此在反序列化期间，这些变量将使用相应的默认值进行初始化（例如：对于对象`null`，`int` `0`）。

4.  **超类变量：**如果超类也实现了 Serializable 接口，那么这些变量将被序列化，否则不会序列化超类变量。并且在反序列化时，JVM 将在超类中运行默认构造函数并填充默认值。所有超类都会发生同样的事情。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2012-06-12T16:45:36.863

serialVersionUID 是序列化和反序列化过程使用的**特殊**静态变量，用于验证本地类是否与用于序列化对象的类兼容。它不仅仅是一个静态变量，它绝对不是序列化的。

当一个类的对象第一次被序列化时，一个包含类名和序列版本 UID 的类描述符被写入流中。当它被反序列化时，JVM 检查从流中读取的序列版本 UID 是否与本地类的 UID 相同。如果不是，它甚至不会尝试反序列化对象，因为它知道类不兼容。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-12T16:44:01.680

`serialVersionUID`是特殊的，不受这些规则的约束。序列化机制中有专门处理此字段以执行自动版本检查的代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-01T17:15:48.947

您可以自己测试一下 - 这里有一些示例代码可以回答您的问题：

```
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;

class TestJava implements Serializable{
  public static int k = 10;
  public int j = 5;

  public static void main(String[] args) {

    TestJava tj1= new TestJava();
    TestJava tj2;

        try{ //serialization
            FileOutputStream fos = new FileOutputStream("myclass.ser");
            ObjectOutputStream oos = new ObjectOutputStream(fos);
            oos.writeObject(tj1);
            oos.close();
            fos.close();
            System.out.println("object serielized 1..."+tj1.j);
            System.out.println("object serielized 2..."+tj1.k);
            System.out.println("object serielized 3..."+k);
            k=++k; // 'k' value incrementd after serialization
          } catch(FileNotFoundException fnfe){
             fnfe.printStackTrace();
          } catch(IOException ioex){
             ioex.printStackTrace();
          }

          try{ //deserialization
              FileInputStream fis = new FileInputStream("myclass.ser");
              ObjectInputStream ois = new ObjectInputStream(fis);
              tj2 = (TestJava) ois.readObject();
              ois.close();
              fis.close();
              System.out.println("object DEEEEserielized 1..."+tj2.j);
              System.out.println("object DEEEEserielized 2..."+tj2.k); 
              System.out.println("object DEEEEserielized 3..."+k); 
            // in deserialization 'k' value is shown as incremented. 
            // That means Static varialbe 'K' is not serialized.
            // if 'K' value is serialized then, it has to show old value before incrementd the 'K' value.
            } catch(FileNotFoundException fnfe){
              fnfe.printStackTrace();
            } catch(IOException ioex){
              ioex.printStackTrace();
            } catch(ClassNotFoundException CNFE){
              CNFE.printStackTrace();                   
           }
      }
} 
```

这将输出以下内容：

```
object serielized 1...5
object serielized 2...10
object serielized 3...10
object DEEEEserielized 1...5
object DEEEEserielized 2...11
object DEEEEserielized 3...11 
```

因此，我们创建了一个`TestJava`具有一个静态整数字段和一个非静态字段的类对象。我们序列化对象，然后 - 在序列化之后 - 增加静态整数。

当我们稍后反序列化该对象时，我们看到它具有递增的值，这意味着它没有被序列化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-26T12:55:27.050

在这种`serialVersionUID`情况下也是序列化的。

*在类初始化期间提供值的任何静态变量都会被序列化*。

但是，在正常情况下，您将在主类/运行时向静态变量提供值的位置不会被序列化。

您可以尝试`serialVersionUID`通过将其公开来访问它，并在反序列化后尝试访问它。

您可以参考“ [http://javabeginnerstutorial.com/core-java-tutorial/transient-vs-static-variable-java/](http://javabeginnerstutorial.com/core-java-tutorial/transient-vs-static-variable-java/) ”了解更多信息。

希望有帮助。干杯！！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-10T07:54:02.533

**下面的示例解释了静态、实例、瞬态和超类变量序列化及其输出。**

**序列化类：**

```
public class SerializeEx extends SuperSerializeEx implements Serializable {

    private static final long serialVersionUID = 1L;
    public static int staticNumber = 1234;
    public int instanceNumber = 1234;

    public SerializeEx() {
        staticNumber = 0;
        instanceNumber = 0;
        System.out.println("---sub class constructor---");
    }

    public SerializeEx(int staticNumber, int instanceNumber, int superNumber) {
        super(superNumber);
        this.staticNumber = staticNumber;
        this.instanceNumber = instanceNumber;
    }
} 
```

**超级班：**

```
public class SuperSerializeEx {

    public int superNumber;

    public SuperSerializeEx() {
        System.out.println("---super class constructor---");
        this.superNumber = 1000;
    }

    public SuperSerializeEx(int superNumber) {
        this.superNumber = superNumber;
    }
} 
```

**序列化和反序列化：**

```
public class MainSerialization {

    public static void main(String[] args) {
        String fileName = "testing.txt";
        serialize(fileName);
        deSerialize(fileName);
    }

    public static void serialize(String fileName) {
        System.err.println("Serialize.....");
        SerializeEx serializeMe = new SerializeEx(10, 10, 10);
        FileOutputStream fos = null;
        ObjectOutputStream out = null;
        try {
            fos = new FileOutputStream(fileName);
            out = new ObjectOutputStream(fos);
            out.writeObject(serializeMe);
            out.close();
        } catch (IOException ex) {
            ex.printStackTrace();
        }
    }

    public static void deSerialize(String fileName) {
        System.err.println("DeSerialize.....");
        SerializeEx time = null;
        FileInputStream fis = null;
        ObjectInputStream in = null;
        try {
            fis = new FileInputStream(fileName);
            in = new ObjectInputStream(fis);
            time = (SerializeEx) in.readObject();
            in.close();
        } catch (IOException ex) {
            ex.printStackTrace();
        } catch (ClassNotFoundException ex) {
            ex.printStackTrace();
        }
        System.err.println("Instance Numer = " + time.instanceNumber + " \tStatic Number= " + time.staticNumber + " \t Super Number= " + time.superNumber);
        SerializeEx serializeMe = new SerializeEx(1001, 1001, 1001); //Modifying the static and instnce variables
        System.err.println("Instance Numer = " + time.instanceNumber + " \tStatic Number= " + time.staticNumber + " \t Super Number= " + time.superNumber);
    }
} 
```

**输出：**

```
---super class constructor---
Serialize.....
DeSerialize.....
Instance Numer = 10     Static Number= 10      Super Number= 1000
Instance Numer = 10     Static Number= 1001    Super Number= 1000 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-07T11:47:59.037

不，如果一个类有静态变量，那么在序列化时该变量将被跳过。因为静态变量对所有对象都是唯一的，并且序列化仅用于保存对象属性（对象状态）。静态变量是类的属性

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-07-11T12:34:57.813

**是**的，如果在声明时初始化静态变量，它将被序列化。

例如，

**案例1：**声明时没有初始化

```
class Person implements Serializable{

  public String firstName;

  static  String lastName;  
}

public class Employee {

  public static void main(String[] args) {

      Person p = new Person();
      p.firstName="abc";
      p.lastName="xyz";
      //to do serialization

  }

} 
```

输出 ：

```
//after deserialization

 firstName= abc

 lastName= null 
```

**案例2：**声明时初始化

```
class Person implements Serializable{

  public String firstName=="abc";

  static  String lastName="pqr";  
}

public class Employee {

  public static void main(String[] args) {

      Person p = new Person();
      p.firstName="abc";
      p.lastName="xyz";
      //to do serialization

  }

 } 
```

输出 ：

//反序列化后

```
firstName= abc

lastName= pqr 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-06-23T17:15:39.320

在声明时已初始化的任何静态变量都将被序列化。

# ios - iOS - 从多个文件生成 pdf

> ID：11000976
> 
> 赞同：0
> 
> 时间：2012-06-12T16:39:36.323
> 
> 标签：ios, xcode, pdf

我正在尝试将一些文本文件转换为 pdf。现在世界上最简单的事情就是简单地将文件中的所有文本组合成一个字符串，然后使用[此处](http://developer.apple.com/library/ios/#documentation/2ddrawing/conceptual/drawingprintingios/GeneratingPDF/GeneratingPDF.html)的 iOS 文档将其呈现为单个 pdf。问题是，这些都是大文本文件；它们加在一起可以超过 90 页。因此，我需要添加一些超链接，这样我就可以在顶部创建一个目录，并且用户可以快速移动到每个文本文件的开头，而不必滚动 60 页才能到达他们想去的地方。

问题是，如果我将 txt 文件组合成一个字符串，我无法知道每个文件在分页时何时结束，因此我想在最终发布之前将文件分别添加到 pdf 中。问题是，充其量只会显示最后一个 txt 文件，这很可能是因为它覆盖了以前的文件。以下是我的代码，有什么想法吗？

```
- (void)savePDFFile:(NSString *)file_Name
{

//   NSArray *filePath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
 NSString *homeDir = NSHomeDirectory();
 NSString *saveDirectory = [NSString stringWithFormat: @"%@/%@", homeDir, @"Documents/"]; 

 NSArray *fileAr = [[NSFileManager defaultManager] contentsOfDirectoryAtPath:saveDirectory error:nil];
//    NSString *text = @"";
//    NSMutableArray *textArray = [[NSMutableArray alloc] init];
 NSInteger currentPage = 0;
NSString *completeString = @"";
for (NSString *string in fileAr) {
    if([string hasSuffix:@"txt"]){
        NSString *file = [NSString stringWithFormat: @"%@/%@", saveDirectory, string];
        NSString *text =[NSString stringWithContentsOfFile:file encoding:NSUTF8StringEncoding error:nil];
        completeString = [NSString stringWithFormat:@"%@%@", completeString, text];
    }
}
 for (NSString *string in fileAr) {
    if([string hasSuffix:@"txt"]){
        NSString *file = [NSString stringWithFormat: @"%@/%@", saveDirectory, string];
        NSString *text =[NSString stringWithContentsOfFile:file encoding:NSUTF8StringEncoding error:nil];

// Prepare the text using a Core Text Framesetter
 CFAttributedStringRef currentText = CFAttributedStringCreate(NULL, (CFStringRef)text, NULL);
 if (currentText) {

    CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((CFAttributedStringRef)currentText);
//        CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString(currentText);
    if (framesetter) {

        NSString* pdfFileName = file_Name;

        // Create the PDF context using the default page size of 612 x 792.
        UIGraphicsBeginPDFContextToFile(pdfFileName, CGRectZero, nil);

        CFRange currentRange = CFRangeMake(0, 0);
        BOOL done = NO;

        do {
            // Mark the beginning of a new page.
            UIGraphicsBeginPDFPageWithInfo(CGRectMake(0, 0, 612, 792), nil);

            // Draw a page number at the bottom of each page
            currentPage++;
            [self drawPageNumber:currentPage];

            // Render the current page and update the current range to
            // point to the beginning of the next page.
            currentRange = [self renderPage:currentPage withTextRange:currentRange andFramesetter:framesetter];
            // If we're at the end of the text, exit the loop.
            if (currentRange.location == CFAttributedStringGetLength((CFAttributedStringRef)currentText))
                done = YES;

        } while (!done);

        // Release the framewetter.
        CFRelease(framesetter);
                CFRelease(currentText);
    }
}   
        // Close the PDF context and write the contents out.
        UIGraphicsEndPDFContext();

    } else {
        NSLog(@"Could not create the framesetter needed to lay out the atrributed string.");
    }
    // Release the attributed string.

} 
}

// Use Core Text to draw the text in a frame on the page.
- (CFRange)renderPage:(NSInteger)pageNum withTextRange:(CFRange)currentRange
   andFramesetter:(CTFramesetterRef)framesetter
{
// Get the graphics context.
CGContextRef    currentContext = UIGraphicsGetCurrentContext();

// Put the text matrix into a known state. This ensures
// that no old scaling factors are left in place.
CGContextSetTextMatrix(currentContext, CGAffineTransformIdentity);

// Create a path object to enclose the text. Use 72 point
// margins all around the text.
CGRect    frameRect = CGRectMake(72, 72, 468, 648);
CGMutablePathRef framePath = CGPathCreateMutable();
CGPathAddRect(framePath, NULL, frameRect);

// Get the frame that will do the rendering.
// The currentRange variable specifies only the starting point. The framesetter
// lays out as much text as will fit into the frame.
CTFrameRef frameRef = CTFramesetterCreateFrame(framesetter, currentRange, framePath, NULL);
CGPathRelease(framePath);

// Core Text draws from the bottom-left corner up, so flip
// the current transform prior to drawing.
CGContextTranslateCTM(currentContext, 0, 792);
CGContextScaleCTM(currentContext, 1.0, -1.0);

// Draw the frame.
CTFrameDraw(frameRef, currentContext);

// Update the current range based on what was drawn.
currentRange = CTFrameGetVisibleStringRange(frameRef);
currentRange.location += currentRange.length;
currentRange.length = 0;
CFRelease(frameRef);

return currentRange;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T16:31:47.217

我取得了进展并遇到了另一个问题，所以我[在这里](https://stackoverflow.com/questions/11017100/ios-ctframesettercreatewithattributedstring-not-sizing-correctly/11019247#11019247)问了一个额外的问题。

最终，通过我自己的测试和一点点帮助，我解决了这个问题。

# vb.net - 从用户控件访问会话状态的问题

> ID：11000978
> 
> 赞同：1
> 
> 时间：2012-06-12T16:39:55.857
> 
> 标签：vb.net, session, .net-3.5

尝试从用户控件后面的代码中的会话状态中提取时出现以下错误。

**会话状态只能在 enableSessionState 设置为 true 时使用，无论是在配置文件中还是在 Page 指令中。还请确保 System.Web.SessionStateModule 或自定义会话状态模块包含在应用程序配置的 \\ 部分中。**

这是我在该部分中的配置

```
<sessionState mode="InProc" cookieless="false" timeout="20"/>
<globalization requestEncoding="utf-8" responseEncoding="utf-8"/>
<pages enableSessionState="true"></pages>
<httpModules>
  <remove name="Session" />
  <add name="Session" type="System.Web.SessionState.SessionStateModule"/>
</httpModules> 
```

这是我在用户控件本身上引用的方式。这是在 Page_Load 中完成的

```
If Not Session("ADName") Is Nothing AndAlso Session("ADName").length > 0 Then
'Do Stuff
End If 
```

还有我的控制声明

```
<%@ Control Language="vb" AutoEventWireup="false" CodeBehind="UCHeader.ascx.vb" Inherits="PO.Web.UCHeader"
    TargetSchema="http://schemas.microsoft.com/intellisense/ie5" %> 
```

什么会导致这个问题。我正在尝试在本地构建并遇到此问题，因此它根本与 IIS 无关。我正在将此应用程序从 2.0 迁移到 3.5，并且当时开始出现错误。如果您需要更多信息，请告诉我。谢谢。

# java - 如何在 JSP 表达式中转义运算符

> ID：11000980
> 
> 赞同：-1
> 
> 时间：2012-06-12T16:40:14.187
> 
> 标签：java, html, jsp, escaping

我在 HTML 页面上的一段 JSP 中嵌入 Java 代码：

```
<c:when test="<%=\"F\".equals(result[1])||\"P\".equals(result[1])%>"> 
```

上面的代码有效。现在我需要`"F".equals(result[1])`做`!("F".equals(result[1]))`。我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:49:45.490

您不应该在 JSTL 标记属性中使用 scriptlet 表达式。您应该改用 JSP EL：

```
<c:when test="${result[1] == 'F' or result[1] == 'P'}>...</c:when> 
```

阅读[https://stackoverflow.com/tags/jsp/info](https://stackoverflow.com/tags/jsp/info)以获取有关 JSTL 和 EL 的信息和链接。

# javascript - 如何使用backbonejs和requirejs动态加载视图和模板

> ID：11000999
> 
> 赞同：1
> 
> 时间：2012-06-12T16:41:45.630
> 
> 标签：javascript, backbone.js, requirejs

我正在使用backbonejs创建一个表单构建器应用程序，并且想知道如何动态加载视图我有一个下拉列表，我可以在其中选择应该添加什么类型的元素，例如我选择输入字段。我有一些默认值与它们在表单模板中的每个元素一起使用，并且根据选择的字段，我想加载不同的 html 模板。

```
define([
  'jquery',
  'underscore',
  'backbone',
  'modal',
// Pull in the Collection module from above
  'collections/builder',
  'text!templates/forms/builder.html',
  'text!templates/forms/formsTemplate.html',
  'text!templates/forms/textBox.html',
  'models/builder'

], function ($, _, Backbone, popupModal, attributesCollection, builderTemplate, formsTemplate, inputTemplate, attributesModel) {
    var attributesBuilderView = Backbone.View.extend({
        el: $("#page"),
        initialize: function () {

        },
        render: function () {
            this.loadTemplate();
        },
        loadTemplate: function () {
            var that = this;
            this.el.html(builderTemplate);
        },
        // Listen to events on the current el
        events: {
            "change #attributeType": "loadAttributeTemplate"
        },
        loadAttributeTemplate: function () {
            if ( ($("#attributeType").val()) != '0') {
                $("#attributesArea").append(_.template(formsTemplate, { elementType:              $("#attributeType :selected").text(), _: _ }));
                var template = $("#attributeType").val() + 'Template';
                $(".formElement").html(_.template(template));
            }
        }
    });
    return new attributesBuilderView;
}); 
```

在这里，当我运行此代码时，如果我输入 $(".formElement").html(_.template(inputTemplate)); 它工作正常。我只需要知道如何动态加载这些

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T16:57:46.523

如果您只想进行条件加载，则可以将 require 调用放在任何地方：

**已编辑**（将函数参数添加到 require 语句中）

```
loadAttributeTemplate: function () {
    if ( ($("#attributeType").val()) != '0') {
        require(['text!templates/forms/builder.html',
            'text!templates/forms/formsTemplate.html',
            'text!templates/forms/textBox.html'], 
            _.bind(function(builder, formsTemplate, textBox) {
                $("#attributesArea").append(_.template(formsTemplate, { elementType:               $("#attributeType :selected").text(), _: _ }));
                var template = $("#attributeType").val() + 'Template';
                $(".formElement").html(_.template(template));
            },this);
        );
    }
} 
```

注意，我还做了一个 _.bind(...,this) 来维护执行范围。我知道这里不一定需要，但它确实派上用场。

我在我的应用程序的几个地方这样做；尤其是当我只想在需要时才加载模块时。