# StackOverflow 问答 000852000-000852999

# ruby-on-rails - 我如何知道何时以及是否为一段代码设置单独的控制器？

> ID：852001
> 
> 赞同：2
> 
> 时间：2009-05-12T09:47:52.863
> 
> 标签：ruby-on-rails, model-view-controller, rest, design-decisions

所以我处于一种情况，我必须决定是否为一段特定的代码设置一个单独的控制器。我们有一个主页，它就像网站其余部分的中心一样。所有用户（登录和未登录）都可以访问该页面。我正在考虑将其`home`作为一个单独的控制器和一个名为`index`. 考虑到这种情况，我开始怀疑这方面是否有任何规则或指导方针。

我的看法是，如果代码围绕实体旋转，则需要分离。（类似于 REST 指南）如果实体是名词，它应该是控制器。如果实体是动词，它可能应该是一个动作，并且应该驻留在名称与动词所指名词相同的控制器中。一些同事建议，既然这是一个动作，它应该驻留在一些现有的控制器中，并且应该命名为`home`. 我强烈反对，但是，我找不到可以支持我的可靠来源。

想知道你的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T10:12:54.913

在这种情况下，我必须同意你的同事。

正如您所说，在处理资源时，REST 是一种不错的方法。这使您可以创建一致的界面，尤其是在创建 Web 服务方面。

但是 REST 实际上并不能很好地映射到 Web 浏览器设置。例如，您会注意到，即使对于资源，您的 /edit 和 /new 操作也只是返回指向相关 RESTful 操作的 HTML 表单的 GET 请求。'edit' 和 'new' 根本不是 RESTy。

同样，主页通常是各种数据的用户友好合并，不适合 RESTful 界面。因此，要么通过一个动作插入一个额外的控制器，要么使用现有控制器的“列表”动作作为主页

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T14:48:49.557

问题从这句话开始

> 如果实体是动词

如果您尝试生成 RESTful 架构，则实体不能是动词。如果您使用 HTTP，则唯一允许的动词是 GET、PUT、POST、DELETE、HEAD、OPTIONS。所有实体都应映射到某个名词，如果您尝试检索该实体，则应使用动词 GET。就个人而言，我会将其映射到控制器上的 Get() 方法，但我不知道 Rails 是否允许您这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-15T10:40:43.967

快速（且无益）的答案是任何一种方式都可以正常工作。

我认为每个人都会在某一时刻遇到这个决定，而您做出的决定取决于网站可能的未来......这意味着它很容易过早优化......但这总是问题，

正如您现在可能已经猜到的那样，“家”在某些方面既是动词又是名词，这就是为什么您难以弄清楚该做什么的原因。

答案取决于您对网站结构的解释以及您可以使用多少时间...

如果您没有多少时间来处理这个......那么将“家庭”动作填充到另一个控制器中通常被认为是权宜之计。它有效，它可以让你转移到其他（可能更有效率）的任务上。

然而，我同意有时候退后一步想想你在做什么以及它是否可以做得“更好”是件好事……在这种情况下，虽然很难定义“更好”——因为不太可能把新控制器中的 home 动作会明显更快......如果它是控制器中唯一的动作......从架构上讲，将其添加到现有控制器中是否更好是值得商榷的......

因此，我们从主要是哲学辩论开始……换句话说，没有一个答案会比另一个“更正确”——这更多的是品味和环境问题。在这种情况下，争论的焦点在于使结构更加 RESTful。

为了忠实于 RESTful 架构，您确实会将操作移动到它自己的控制器中……但您首先必须确定实体是什么。“主页”通常不容易识别为特定的数据库实体......它更常见的是门户页面。

有时您可以选择一个实体，例如在线商店通常会有一个实际上是“products#index”变体的主页，或者有时“主页”页面是 UserAccount#show 页面......但更多情况下，您的主页将并不简单，并且会结合来自多个实体的信息......因此很难决定“正确”的架构是什么。

如果您无法识别特定实体，那么关于是否将操作移至特定控制器存在有效辩论。

但是，您始终可以创建一个以站点架构为中心的新“实体”。如果您要为网站提供其他非实体特定页面（例如 T&C 或“关于我们公司”页面），这种情况尤其可能发生。

通常的后备是“PageController”（或类似名称），它不链接到 Active Record*模型*，而是链接到更模糊的实体，在这种情况下，是网站用户可识别的“页面”（例如“主页”和“T&C 页面”和“关于页面”）。每个操作都针对特定页面...

因此，这取决于您是否更适合您对系统架构的看法......以及是否值得努力......但这是我对辩论的看法。:)

# c++ - LLVM 它是什么以及我如何使用它来跨平台编译

> ID：852002
> 
> 赞同：6
> 
> 时间：2009-05-12T09:47:58.540
> 
> 标签：c++, cross-platform, llvm

我在这里和那里阅读有关 llvm 的信息，可用于缓解 c++ 中跨平台编译的痛苦，我试图阅读文档，但我不明白如何在现实生活中的开发问题中使用它，有人可以解释一下吗我用简单的话我该如何使用它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-20T21:46:52.473

LLVM 的关键概念是程序的低级“中间”表示 (IR)。此 IR 处于汇编代码级别，但它包含更多信息以促进优化。

LLVM 的强大之处在于它能够将此中间表示的编译推迟到特定的目标机器，直到代码需要运行之前。即时 (JIT) 编译方法可用于应用程序在需要它之前生成它需要的代码。

在许多情况下，您在程序运行时获得的信息比您在总部获得的更多信息，因此可以大大优化程序。

首先，您可以将 C++ 程序编译为单个中间表示，然后从该 IR 将其编译到多个平台。

您还可以尝试 Kaleidoscope 演示，它会引导您创建一种新语言，而无需实际编写编译器，只需编写 IR。

在性能关键型应用程序中，应用程序基本上可以在需要运行之前编写自己的代码来运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T17:02:00.360

你为什么不去[LLVM](http://llvm.org/)网站并查看那里的所有文档。他们非常详细地解释了 LLVM 是什么以及如何使用它。例如，他们有一个[入门](http://llvm.org/docs/GettingStarted.html)页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T09:59:53.843

顾名思义，LLVM 是具有代码生成器的低级虚拟机。如果你想编译它，你可以使用 gcc 前端或**clang**，这是 LLVM 的 c/c++ 编译器，它仍在进行中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-05T07:30:24.723

需要注意的是，关于目标的大量信息来自编译时使用的系统头文件。LLVM 不会推迟解决诸如“指针大小”或“字节布局”之类的问题，因此如果您使用 64 位头文件为 little-endian 平台进行编译，则不能使用该 LLVM 源代码来定位 32 位 big-endian 程序集输出佩特。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-15T11:18:04.017

书中有一章很好地解释了这里的一切：[www.aosabook.org/en/llvm.html](http://www.aosabook.org/en/llvm.html)

# sharepoint - Stsadm 导出在某个时间后挂起

> ID：852004
> 
> 赞同：0
> 
> 时间：2009-05-12T09:49:27.010
> 
> 标签：sharepoint, stsadm

我正在尝试使用 stsadm 导出 SharePoint 网站，但是每次我启动该过程时，它都会在导出过程中的特定点挂起，它总是在导出特定列表项时挂起。但是，如果我删除列表项，则导出会挂在前一项上。

我已经等待 mre tan 10 小时才能完成导出，但它没有完成。

如果我需要做任何事情来完成导出，请告诉我。

另一个附加信息是导出适用于服务器上的其他站点。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T13:46:46.030

也许导致问题的列表项是挂起*后的列表项？*

# sql - LEFT JOIN 子查询表参数是否被多次评估？

> ID：852007
> 
> 赞同：2
> 
> 时间：2009-05-12T09:52:33.900
> 
> 标签：sql, mysql

我有一个看起来像这样的查询：

```
SELECT  *
FROM    employees e
LEFT JOIN
        (
        SELECT  *
        FROM    timereports
        WHERE   date = '2009-05-04'
        ) t
ON      e.id = t.employee_id 
```

如您所见，我的`LEFT JOIN`第二个表参数是由 aa 子查询生成的。

db 是否只评估此子查询一次或多次？

谢谢。马蒂

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T09:56:20.570

这取决于`RDBMS`.

在大多数情况下，`HASH OUTER JOIN`将使用 a，在这种情况下，子查询将被评估一次。

`MySQL`，另一方面，不能生成`HASH JOIN`'，这就是为什么它很可能会将谓词推入子查询并发出以下查询：

```
SELECT  *
FROM    timereports t
WHERE   t.employee_id = e.id
        AND date = '2009-05-04' 
```

在嵌套循环中。如果你有一个索引`timereports (employee_id, date)`，这也将是有效的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T10:00:57.287

如果您使用的是 SQL Server，则可以查看查询的[执行计划](http://msdn.microsoft.com/en-us/library/ms181055.aspx)。SQL Server 查询优化器将优化查询，使其执行时间最短。最佳时间将取决于某些条件，即。索引之类的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T10:01:32.997

您必须要求数据库显示计划。执行此操作的算法是根据许多因素动态选择的（在查询时）。一些数据库使用密钥分布的统计数据来决定使用哪种算法。其他数据库有相对固定的规则。

此外，每个数据库都有一个不同算法的菜单。数据库可以使用排序合并算法或嵌套循环。在这种情况下，可能存在查询扁平化策略。

您需要使用数据库独特的“解释计划”功能来查看查询执行计划。

您还需要知道您的数据库是否使用提示（通常是嵌入在 SQL 中的注释）来选择算法。

您还需要知道您的数据库是否使用统计信息（有时称为“基于成本的查询优化器”）来选择算法。

如果您知道所有这些，您就会知道查询是如何执行的，以及内部查询是否被多次评估或平展到父查询中或评估一次以创建父查询使用的临时结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T10:02:11.420

你说的评价是什么意思？

数据库有几个不同的选项来执行连接，最常见的两个是

*   嵌套循环，在这种情况下，将循环遍历一个表中的每一行，并查找另一个表中的相应行，以及
*   散列连接，这意味着两个表都将被扫描一次，然后使用某种散列算法合并结果。

选择这两个选项中的哪一个取决于数据库、表的大小和可用的索引（可能还有其他因素）。

# sql-server - 在我的 ASP.NET Web 应用程序的开发版本中将 DataSources 添加到 DatdGrids 将如何影响部署？

> ID：852009
> 
> 赞同：0
> 
> 时间：2009-05-12T09:52:43.540
> 
> 标签：sql-server, visual-studio, database-connection

我最近继承了一个用 C# ASP.Net 编写的数据库驱动的电子商务网站，带有一个 MS SQL 数据库。到目前为止，我对这种确切类型的应用程序几乎没有经验，尽管我很擅长探索代码，并且熟悉 SQL 查询结构和 C#（以及 Web 标记语言）。到目前为止，我已经能够对应用程序进行所有我想要的调整，调试了一些东西，删除了一些编译器错误，添加了一些新的简单函数，并且相当享受自己。

我在 Visual Web Developer 2008 Express Edition 中显示数据库中的信息时遇到了一些问题。在遇到 web.config 文件的初始设置问题后，我对接下来要采取的步骤有点警惕！

我目前有一个 web.config 的本地副本，它在开发过程中连接到数据库的本地副本。当我编译和上传应用程序的任何新版本时，我会排除本地版本的 web.config，以便远程版本使用它自己的 web.config 文件连接到远程数据库。

为了在开发过程中查看网页上的任何数据库信息，我必须在浏览器中运行该网站。通过在数据库资源管理器中创建与数据库的连接，我是否应该能够在 VS 的设计视图中看到此信息？当应用程序在网络服务器上远程运行时，这会影响应用程序吗？（因为连接到本地数据库而不是远程数据库，因此连接字符串会有所不同）在 VS 设计视图中，所有 DataGrids 都是空白的。如果我在设计视图中使用智能标签为他们选择数据源，他们在远程运行时会使用正确的数据源吗？我应该完全删除数据库的本地副本吗？在开发过程中连接到远程数据库对我来说似乎相当危险！

我希望这很清楚，欢迎任何和所有帮助/链接/指针！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T10:01:57.660

[在开发和生产环境中使用不同的 Web.config](https://stackoverflow.com/questions/305447/using-different-web-config-in-development-and-production-environment)来学习如何使用不同的配置

还要检查 Scott 的提示，[http://weblogs.asp.net/scottgu/archive/2007/09/21/tip-trick-automating-dev-qa-staging-and-production-web-config-settings-with-vs -2005.aspx](http://weblogs.asp.net/scottgu/archive/2007/09/21/tip-trick-automating-dev-qa-staging-and-production-web-config-settings-with-vs-2005.aspx)（不确定它是否适用于 Visual Web Developer）

# c# - C# 中的 String* 是什么意思？

> ID：852015
> 
> 赞同：-1
> 
> 时间：2009-05-12T09:54:31.527
> 
> 标签：c#

`String*`在 C#中是什么意思？

我已经在代码示例中看到了这个，但我不能从上下文中派生出来，你也不能搜索这个，因为 * 在每个搜索引擎中都被接受为通配符。

* * *

编辑：看起来它不是 C#，这解释了它。我正在查看的特定代码示例非常短（5 个字），我认为从上下文来看它是 C# 的意思。

我确信我以前见过它，但我模糊的记忆可能也来自其他语言。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T09:56:09.543

`String*`? 你确定是C#？在 C#[中不能有指向引用类型的指针。](http://msdn.microsoft.com/en-us/library/aa664771(VS.71).aspx)除非在该特定代码中`String`已定义`struct`或其他内容...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T09:59:18.460

您确定您不是在查看托管 C++ 示例吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T09:59:25.497

您可以在不安全的代码块中使用 C# 中的指针，但我只将它们与值类型或值类型数组一起使用。

# symfony1 - 在 Symfony 中设置 mime_types 不适用于 zip 文件

> ID：852017
> 
> 赞同：0
> 
> 时间：2009-05-12T09:56:12.850
> 
> 标签：symfony1, mime-types

在我的 Symfony 应用程序中，我想在文件上传期间将 zip 文件设置为 mime 类型之一，执行此操作的代码如下：

```
 $this->validatorSchema ['Documents'] = new sfValidatorFile ( 
        array ('mime_types' => array(
        'application/zip', 
        'image/jpeg',
    'image/pjpeg',
    'image/png',
    'image/x-png',
   'image/gif',
        'application/x-zip',
        'application/octet-stream',
        'application/pdf') ), 
        array ('invalid' => 'Invalid file.',
         'required' => 'Select a file to upload.', 
         'mime_types' => 'The file must be of JPEG, PNG , GIF, pdf and zip format.' ) ); 
```

但是，当我进行上传时，我发现所有 , 等都`pdf`可以`png`上传`gif`。唯一不能上传的 mime 类型是以 . 结尾的文件`.zip`。

这里出了什么问题？

[我在这里](https://stackoverflow.com/questions/688926/set-mimetype-validation-in-symfony)问了一个相关但不同的问题。

**注意：我使用的是 Symfony 1.2.7**

**编辑：我用不同的浏览器做了一些进一步的测试。Firefox 3 工作是因为 'application/octet-stream''，而 IE 工作是因为 'application/x-zip-compressed'，谷歌浏览器根本不工作。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T08:56:53.780

经过[更多测试](https://stackoverflow.com/questions/856013/mime-type-for-zip-file-in-google-chrome/)，我认为[这是 Symfony 中的一个错误](http://trac.symfony-project.org/ticket/6461)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T12:56:09.700

执行 echo 或 error_log 以查看 $uploaded_file->getMime() [或任何正确的方法调用] 为您的 zip 文件返回的内容。

如果您获得的字符串是您传递给数组的字符串之一，则 sfValidatorFile 可能存在错误（我从未使用过它），您可能想尝试使用 yml 验证器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T12:11:48.797

有一个解决方案：

1.  在“/lib/Validator/”中创建“sfValidatorFileZip.class.php”。此类从commun“sfValidatorFile”扩展而来，它包含“configure”方法，如下所示：

    ```
    class sfValidatorFileZip extends sfValidatorFile{
      protected function configure($options = array(), $messages = array()){
        if (!ini_get('file_uploads'))
        {
          throw new LogicException(sprintf('Unable to use a file validator as "file_uploads" is disabled in your php.ini file (%s)', get_cfg_var('cfg_file_path')));
        }

        $this->addOption('max_size');
        $this->addOption('mime_types');
        $this->addOption('mime_type_guessers', array(
          array($this, 'guessFromFileinfo'),
          array($this, 'guessFromMimeContentType'),
          array($this, 'guessFromFileBinary'),
        ));
        $this->addOption('mime_categories', array(
          'web_images' => array(
            'image/jpeg',
            'image/pjpeg',
            'image/png',
            'image/x-png',
            'image/gif',
        ),
          'zip_file' => array(
                'application/zip'
        )
            ));
        $this->addOption('validated_file_class', 'sfValidatedFile');
        $this->addOption('path', null);

        $this->addMessage('max_size', 'File is too large (maximum is %max_size% bytes).');
        $this->addMessage('mime_types', 'Invalid mime type (%mime_type%).');
        $this->addMessage('partial', 'The uploaded file was only partially uploaded.');
        $this->addMessage('no_tmp_dir', 'Missing a temporary folder.');
        $this->addMessage('cant_write', 'Failed to write file to disk.');
        $this->addMessage('extension', 'File upload stopped by extension.');
      }
    } 
    ```

2.  在您的表单中，该小部件将是您自定义的“sfValidatorFileZip”中的一个实例，您必须准确说明`'mime_types' => 'zip_file'`. 例子：

    ```
    $this->setValidator('filename', new sfValidatorFileZip(array(
                'required' => false,
                'mime_types' => 'zip_file',
                'path' => sfConfig::get('sf_upload_dir') . '/files/',), 
                array('required' => 'filename is required.', 'mime_types' => 'only ZIP is accepted'))); 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T08:24:35.940

这是 mime 类型检测的问题。sfValidatorFile 可以使用用户提供的函数来确定 mime 类型。因此，如果验证器确定的 mime 类型不能正确完成工作，您可以编写自己的函数来检测上传文件中的 zip 文件。

[链接到文档](http://www.symfony-project.org/forms/1_2/en/02-Form-Validation#chapter_02_file_upload)，查看解释文件上传的页面末尾。

# sql - 存储过程和表值函数有什么区别？

> ID：852024
> 
> 赞同：3
> 
> 时间：2009-05-12T09:57:36.747
> 
> 标签：sql, sql-server

存储过程和表值函数有什么区别？它们似乎具有相同的功能

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T10:30:26.273

表值函数只能返回一个结果集；SP 可以返回多个结果集。

您随后可以查询表值函数的结果 - 但不能使用 SP。

因此，如果您不需要多个结果集，表值函数会更加灵活。

# database - 如何在服务器端生成 SWX 数据文件？

> ID：852025
> 
> 赞同：1
> 
> 时间：2009-05-12T09:57:53.160
> 
> 标签：database, flash, actionscript, swx

通过将数据存储在服务器上的[SWX 文件](http://en.wikipedia.org/wiki/SWX_Format)中，它可以像将一个 SWF 加载到另一个 SWF 中一样被自动解释。

现在我想通过服务器端代码修改这些数据，我该怎么做？是否有任何我可以使用的 PHP SWX 库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T13:20:03.853

如果您只想要商店图像或其他资产，我建议您使用[swfmill](http://swfmill.org/)。

项目[swx-format](http://code.google.com/p/swx-format/)似乎拥有您需要的所有东西。

也许对你来说也很有趣：[Haxe](http://haxe.org/)（编程语言，生成 PHP、swf、neko、js、AS3）有一个库[hxformat](http://code.google.com/p/hxformat/)可以在服务器端创建 swf 和 abc 代码。

# subsonic - 亚音速别名查询 - 如何？

> ID：852028
> 
> 赞同：1
> 
> 时间：2009-05-12T09:59:32.860
> 
> 标签：subsonic, alias

我正在尝试构建以下查询：

```
`new Select("GTekst = ArrGruppe.Tekst", "GLTekst = ArrGruppeLinie.Tekst")
.From(ArrGruppeLinie.Schema)
.InnerJoin(ArrGruppe.IdColumn, ArrGruppeLinie.ArrGruppeIDColumn)
.Where(ArrDeltager.Columns.Kategori).IsLessThan(20)
.And("Arrgruppe.Tekst").Like("mytext");` 
```

由于 .And() 它会生成一个有缺陷的查询，因为我在具有相同名称的两列上附加了别名 - And 运算符在这里：

```
... AND (ArrGruppe.Tekst LIKE @ArrGruppe.Tekst1
)',N'@Kategori0 tinyint,@ArrGruppe.Tekst1 varchar(10)',@Kategori0=20,@ArrGruppe.Tekst1='mytext' 
```

我在谷歌上找不到任何可以解决这个问题的东西。如何编写 Subsonic 查询来为 ArrGruppe.Tekst 生成有效的 SQL 参数？

编辑：从 2.1 Final 到 2.2 版的更新解决了问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T10:31:38.393

```
new Select("GTekst = ArrGruppe.Tekst", "GLTekst = ArrGruppeLinie.Tekst")
  .From(ArrGruppeLinie.Schema)
  .InnerJoin(ArrGruppe.Columns.Id, ArrGruppeLinie.Columns.ArrGruppeID)
  .Where(ArrDeltager.Columns.Kategori).IsLessThan(20)
  .And(Arrgruppe.Columns.Tekst).Like("mytext"); 
```

如果不尝试升级到最新版本的 SubSonic [http://code.google.com/p/subsonicproject/downloads/list](http://code.google.com/p/subsonicproject/downloads/list)，因为您可能会遇到以下问题（已在 2.2 中修复）

Google 问题 31 - 使用限定列名的表达式格式不正确

# drupal - Drupal：未生成 xmlsitemap 文件

> ID：852029
> 
> 赞同：2
> 
> 时间：2009-05-12T09:59:53.187
> 
> 标签：drupal, module, sitemap

我从 Drupal 站点上最流行的使用统计中选择了 XMLSiteMap 模块，所以我认为该模块并没有太多错误。但是地图文件不存在。

我已经在我的 Windows 机器上将此模块安装到 drupal/sites/default/modules 中。我已经在管理菜单中激活了 XMLSiteMap 的所有子模块。根据文档，我还手动运行 cron.php 以在 drupal/sites/default/files 中创建 sitemap.xml - 但即使在第二次重新安装时它也不存在。 **如何强制创建 sitemap.xml？**

（也尝试使用和不使用干净的 URL - 仍然没有帮助）。

**另外，这个模块是否有任何可靠的替代方案？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-15T15:13:32.213

我不确定这是否会对您有所帮助，但如果您正在寻找实际创建的 sitemap.xml 文件而不是在浏览器中导航到它，我不相信它是由模块创建的。我认为该模块创建了一个菜单回调来创建站点地图文件，因此对 sitemap.xml 的请求由 Drupal 的菜单系统处理，而不是创建一个实际的文件。然而，sites/default/files/xmlsitemap 中会有一个缓存版本。

如果这是对所提出问题的过度简化，我们深表歉意。

我自己对模块的可靠性没有任何问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T14:40:01.727

你确定你已经正确安装了吗？请检查状态报告（Drupal 5 中的 admin/logs/status，Drupal 6 中的 admin/reports/status）以确保一切正常。

例如，您可能尚未正确设置站点/默认/文件的权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T19:30:56.870

还要确保您安装了最新版本，它昨天刚刚发布：

[http://drupal.org/project/xmlsitemap](http://drupal.org/project/xmlsitemap)

另外，请参阅此问题，似乎与您的问题有关：

[http://drupal.org/node/458546](http://drupal.org/node/458546)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-19T14:02:48.097

运行 CRON 对我有用：

`/admin/reports/status/run-cron`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T15:25:59.263

我可能会建议尝试我一直在重写的 6.x-2.x 分支，以解决 6.x-1.x 分支的所有烦人的错误和架构问题。它目前不完整，但目前适用于节点和菜单项。很快就会添加分类术语和用户配置文件。

您可以在项目页面上找到它的链接。抱歉，我是新用户，无法链接。:)

# jquery - jquery 和正则表达式

> ID：852032
> 
> 赞同：0
> 
> 时间：2009-05-12T10:00:28.880
> 
> 标签：jquery, regex

我构建了一个函数，将 HTML 中的关键字替换为链接。问题是，当关键字在链接中时，它将替换它。

```
$(document).ready( function () {
    $("#content").highlight( "example", "<a href=\"http://www.example.com\">$1</a>" );});

jQuery.fn.highlight = function (text, o) {
return this.each( function(){
    var replace = o;
    $(this).html( $(this).html().replace( new RegExp('('+text+'(?![\\w\\s?&.\\/;#~%"=-]*>))', "ig"), replace) );
});} 
```

和我的 HTML

```
<div id="content">
    <h2>the word "example" replaced by the link</h2>
    <p>this is an example</p>

    <p>this is an example number 2</p>
    <p><a href="http://www.wrong.com">this is an example</a></p>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T10:48:07.117

在进行替换之前，我会检查循环中的每个元素以查看它是否是锚标记。

```
if( !$(this).is('a') ) {
  // Replace Code here
} 
```

# objective-c - 使用 NSNotification 委托 NSTextField 的方法

> ID：852038
> 
> 赞同：3
> 
> 时间：2009-05-12T10:02:11.450
> 
> 标签：objective-c, cocoa, macos, delegates

我在一个窗口中有一个 NSTokenField。我正在使用它来存储与核心数据对象相关的标签。现在我已经设置好了，我可以给对象添加标签，但我不能删除它们。我需要 NSTokenField 上的委托方法，它可以让我知道用户何时将焦点移出 NSTokenField。由于 NSTokenField 是 NSTextField 的子类，我想我可以使用它的委托方法。它有两个我认为可能有用的：

```
- (void)textDidChange:(NSNotification *)aNotification
- (void)textDidEndEditing:(NSNotification *)aNotification 
```

我将我的控制器类设置为我的 NSTokenField 的委托，并将这两个方法都放入我的控制器类中。我将一个基本的 NSLog 放入其中，当我与 NSTokenField 交互时，它们都不会被触发。我猜它与 NSNotification 有关。如何激活这些方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T10:54:35.873

`NSTokenField`调用和`controlTextDidChange:`通知`controlTextDidEndEditing:`；更改上面的两种方法，将它们实现为：

```
- (void)controlTextDidChange:(NSNotification*)aNotification
{
    //Code here..
}

- (void)controlTextDidEndEditing:(NSNotification *)aNotification
{
    //Code here..
} 
```

# .net - 在本机 C++ 中使用 .net 编译的 dll

> ID：852048
> 
> 赞同：1
> 
> 时间：2009-05-12T10:04:11.387
> 
> 标签：.net, c++, dll, interop

据我了解，任何 .NET 程序都会被编译为 MSIL，然后将其馈送到 CLR，CLR 将其编译为汇编代码，并在 JIT 的帮助下执行它。

我想知道，因为 .NET 是 win32 api 的包装器，而 CLR 最终将 MSIL 转换为汇编程序。我不可能在 C# 中编写一些功能，制作一个 dll，然后我使用一个工具，使它成为一个完整的.net 独立文件，供我在 C 或 C++ 中的非托管代码中使用。

我在谈论 Interops 和 COM 吗？这个想法和它不一样吗？我的目标是在没有 .NET 框架的机器上运行 .NET dll。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-09-22T21:31:57.070

[该项目](https://sites.google.com/site/robertgiesecke/Home/uploads/csharpprojecttemplateforunmanagedexports)将允许您将静态方法的非托管导出 .NET。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T10:23:14.443

[此知识库文章](http://support.microsoft.com/kb/953836)介绍了一种从本机代码调用托管方法的方法。但是，您仍然需要拥有 .NET 框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T10:11:07.083

您可以使用本[机映像生成器 (Ngen.exe)](http://msdn.microsoft.com/en-us/library/6t9t5wcf(VS.80).aspx)将 MSIL DLL 编译为本机代码 DLL，但这将不允许您在没有 .NET Framework 的系统上运行它。您仍然会引用该框架的其他 DLL，即使您包含这些 DLL，它也不会在没有 .NET 框架的系统上工作，因为该框架不仅仅是 DLL 的集合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T10:15:30.400

如果您在网上四处逛逛，我认为有许多工具可以“编译”.NET 程序集/代码来消除他们对框架的需求。不知道他们的工作情况如何......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T10:06:26.560

这不是一种受支持的方式，许多功能（如反射）依赖于比原始机器代码更高级别提供的元数据。有一些程序（称为 .NET 链接器）可能会有所帮助，但它们并非 100% 可靠。

# python - 除了 CPython 之外的生产就绪 Python 实现？

> ID：852049
> 
> 赞同：6
> 
> 时间：2009-05-12T10:04:34.443
> 
> 标签：python, ironpython, jython, cpython, pypy

除了 CPython，目前还有哪些 Python 实现可用于生产系统？

问题

*   [各种 Python 实现的优缺点是什么？](https://stackoverflow.com/questions/86134/what-are-the-pros-and-cons-of-the-various-python-implementations)
*   [我一直试图围绕 PyPy 项目。那么，快进 5 到 10 年之后，PyPy 将比 CPython、Jython 和 IronPython 提供什么？](https://stackoverflow.com/questions/619437/i-have-been-trying-to-wrap-my-head-around-the-pypy-project-so-fast-foward-5-10)和
*   [从 CPython 迁移到 Jython](https://stackoverflow.com/questions/420792/migrating-from-cpython-to-jython/847629#847629)

已经阐明了该主题的利弊。我现在想知道，那些更奇特的实现是否真的用于必须可靠运行的系统中。（可能的例子？开源？）

**编辑：**我要求的代码需要 Python 版本 >= 2.5

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T11:33:45.157

**CPython**

用于许多产品和生产系统

**杰通**

我知道基于 Jython 的生产系统和产品（事务集成引擎）。在后一种情况下，该产品自 2000 年代初就已投放市场。Jython 有点停滞（虽然它最近似乎有所回升）但它成熟且稳定。

**铁蟒**

尽管它在产品方面确实有一些记录，但这是新来的。它（特别是 1.x 版）可以被视为稳定且可用于生产，并且开发由微软官方资助，微软似乎对 CLR 之上的动态语言感兴趣。它是主要 python 实现中最环保的，但似乎相当稳定。

**无堆栈 Python**

[这在EVE Online](http://eve-online.com)中被广泛使用，他们似乎将其视为生产就绪。请记住，Stackless Python 已经存在了大约 10 年。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T10:25:28.417

至少有一种产品[Resolver One](http://www.resolversystems.com/)据说是生产级的，并且完全基于[IronPython](http://www.codeplex.com/IronPython/)。

> Resolver One 是一个程序，它将熟悉的类似电子表格的界面与强大的 Python 编程语言相结合，为您提供了一个工具来更好地分析和呈现您的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T22:31:04.243

您可以查看[http://www.portablepython.com/](http://www.portablepython.com/)这是 CPython 的可移植版本。它还捆绑了非常常见和有用的库，甚至还有一个 IDE，所有这些都是可移植的。

有 Pyrex，可以在[http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)找到。它不是 Python，但非常接近。Cython（不是 CPython）基于 Pyrex，可以在[http://www.cython.org/](http://www.cython.org/)找到。它们对于为 Python 创建 C 扩展都很有用。他们的语言是如此 Pythonic。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T10:59:25.633

我知道[Jython](http://www.jython.org/Project/)已经相当成熟并且已经存在了很长时间。

另外，我会看看[Stackless python](http://www.stackless.com/)

# sql-server - 将日期时间字符串更改为 Sql server DateTime 数据类型

> ID：852051
> 
> 赞同：0
> 
> 时间：2009-05-12T10:04:48.873
> 
> 标签：sql-server, datetime, time

如何将这些日期时间字符串更改为 sql server DateTime 类型：

```
"Thu May 07 19:19:27" 
"Thu May 07 19:19:33" 
"Thu May 07 19:19:34" 
"Thu May 07 19:19:34"
"Thu May 07 19:19:35" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T10:39:42.140

这是一个 TSQL 片段，您可以在存储过程或函数中使用它来将字符串转换为 SQL DateTime。

```
 DECLARE
     @Year char(4), /* the DateTime needs a year */
     @DateString varchar(20),
     @DateVariable DateTime;

  SET @Year = '2009';
  SET @DateString = 'Thu May 07 19:19:27';  /* any of the dates in your list */

  SET @DateVariable = CONVERT(DateTime, @Year 
                            + SUBSTRING(@DateString, 4, LEN(@DateString)));

  /*
      After the conversion, @DateVariable contains '2009-05-07 19:19:27.000'
  */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T10:20:45.557

您是否正在考虑使用 SQL 存储函数/过程或在某些外部程序中将这些日期字符串转换为 DateTime 值？

# php - 使用 jQuery.ajax 在 MySQL 中存储表单数据

> ID：852054
> 
> 赞同：3
> 
> 时间：2009-05-12T10:05:35.330
> 
> 标签：php, jquery, mysql, wordpress

**编辑：**我找到了获取正确 URL 的解决方案。[在这个线程中找到解决方案](https://stackoverflow.com/questions/860704/why-is-my-jquery-script-not-triggering-in-wordpress/862283#862283)。

嗨，我在处理表单时遇到问题，以便我可以将其数据保存在我的 MySQL 数据库中。我使用 Wordpress 作为 CMS。

我用过这个例子：[http ://www.ryancoughlin.com/2008/11/04/use-jquery-to-submit-form](http://www.ryancoughlin.com/2008/11/04/use-jquery-to-submit-form)

我很确定我的问题的根源是我在 javascript 中使用了错误的 url。错误消息仅返回“未定义”并且 Firebug 报告页面未找到 404 错误。

那么正确的网址是什么？任何帮助将不胜感激。

这是我的网站结构：

```
Mywebsite (folder)      
  sl_register.tpl.php   
  includes    (folder)    
  storelocator (folder)
    process_frm_store.php
    frm_store.php
  js (folder)
    myscripts.js 
```

这是我的网站建立的逻辑：

sl_register.tpl.php：

```
<?php
/*
  Template Name: SL - Register Store
*/  
  get_header();
  include_once 'includes/storeLocator/frm_store.php';
  get_footer();
?> 
```

frm_store.php：

```
<form id="store_data_form" class="appnitro"  method="post" action="">
  <input id="store_active" name="store_active" type="hidden" value="pending" />
  <input id="store_name" name="store_name" type="text" value=""/> 
  <input id="store_street1" name="store_street1" type="text" value="" />
  <input id="saveForm" class="submitButton" type="submit" name="save" value="Save" />
</form> 
```

process_frm_store.php：

```
<?php
  $myDB = new DAL(); 
  $myDB->connect();

  if (isset($_POST['save'])) 
  {
    $formData =  array(
      "name"=> mysql_real_escape_string($_POST['store_name']),
      "street1"=> mysql_real_escape_string($_POST['store_street1']),
      "zipcode"=> mysql_real_escape_string($_POST['store_zipcode']));

    $myDB->addNewStore($formData);
  }
?> 
```

myscripts.js：

```
jQuery.processForms = function()
{
  jQuery('form#store_data_form').submit(function() 
  {
    var store_name = 'Test store'; //jQuery("input#store_name").val();
    var store_street1 = 'Sesamy street';//Set constant for testing
    var store_zipcode = '0574'; //Set constant for testing
    var dataString = 'name='+ store_name + '&street1=' + store_street1 + '&zipcode=' + store_zipcode;    
    jQuery.ajax(
    {   
      type: "POST",   
      url: "process_frm_store.php",   
      data: dataString,
      error: function(XMLHttpRequest, textStatus, errorThrown) 
      { 
        alert(errorThrown); // Just for debugging
        jQuery('#suggestNewStore div.error').fadeIn(); 
      },
      success: function() 
      {
        alert('It works!');
        jQuery('#suggestNewStore div.success').fadeIn();   
      }   
    });   
    return false;      
  });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T16:55:40.543

**当sl_register.tpl.php**已经在标签内时，您的标签*`<?php`*周围有标签......除非您正在做一些我不明白的事情，这可能会破坏某些东西。*`include_once`****`<?php`***

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T10:25:17.653

使用绝对路径更简单，就像`http://www.yourwebsite.com/storelocator/process_frm_store.php`在安全方面一样。

否则 .ajax 方法的 url 参数应该是`storelocator/process_frm_store.php`因为您的 ..js 文件包含在您的基本路径中并在`js`or`storelocator`文件夹之外执行

# python - 构建具有 ReferenceProperty 条件的 GQL 查询（用于 Google App Engine）

> ID：852055
> 
> 赞同：5
> 
> 时间：2009-05-12T10:06:18.620
> 
> 标签：python, google-app-engine, gql

假设我有以下模型：

```
class Schedule(db.Model):
    tripCode = db.StringProperty(required=True)
    station = db.ReferenceProperty(Station, required=True)    
    arrivalTime = db.TimeProperty(required=True)
    departureTime = db.TimeProperty(required=True) 
```

假设我有一个 Station 对象存储在 var 中`foo`。

如何组装一个 GQL 查询，该查询返回所有 Schedule 对象以及对 Station 对象的引用`foo`？

这是我最好的（尽管**不正确**）尝试形成这样的查询：

```
myQuery = "SELECT * FROM Schedule where station = " + str(foo.key()) 
```

*再次`foo`是一个**Station**对象*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T21:17:11.380

您不应该使用字符串替换将用户数据插入 GQL 字符串。GQL 支持参数替换，因此您可以这样做：

```
db.GqlQuery("SELECT * FROM Schedule WHERE station = $1", foo.key()) 
```

或者，使用查询接口：

```
Schedule.all().filter("station =", foo.key()) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-11-24T05:35:40.400

更简单的做法是通过将“collection_name”字段添加到 ReferenceProperty 来更改模型定义：

> station = db.ReferenceProperty(Station, required=True, collection_name="schedules")

然后你可以这样做：

> foo.schedules

每当您想获得所有车站的时间表时。

# wolfram-mathematica - 在 Mathematica 中设置环境变量

> ID：852056
> 
> 赞同：6
> 
> 时间：2009-05-12T10:06:22.880
> 
> 标签：wolfram-mathematica

我需要从 Mathematica 笔记本设置环境变量。

```
Environment["VARIABLE"] 
```

给出变量的值。但是也可以设置变量吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T23:03:07.423

没有内置功能（据我所知），但您可以使用

```
Run["set VAR=VALUE"] 
```

或者

```
!set VAR=VALUE 
```

反而。

编辑：您将希望查看[Run](http://reference.wolfram.com/mathematica/ref/Run.html)和[RunThrough](http://reference.wolfram.com/mathematica/ref/RunThrough.html)命令的文档。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-05-14T17:14:58.420

[使用Run](http://reference.wolfram.com/mathematica/ref/Run.html)或[RunThrough](http://reference.wolfram.com/mathematica/ref/RunThrough.html)设置的环境变量不会影响*Mathematica*内核本身，但只会对在同一`Run`或`RunThrough`命令中启动的进程可见。

如果环境变量应该对*Mathematica*内核进程可见，则在接受的答案中描述的基于 gdb 的 hack[是否有办法更改另一个进程的环境变量？](https://stackoverflow.com/questions/205064/is-there-a-way-to-change-another-processs-environment-variables)可以在 Mac OS X 下使用：

```
SetEnvironment[var_String, value_String] := Module[{valueEscaped, cmd},
    valueEscaped = StringTake[ToString[CForm[value]], {2, -2}];
    cmd = "call (int) putenv (\"" <> var <> "=" <> valueEscaped <> "\")";
    Put[OutputForm[cmd], "!gdb -n \"" <> First[$CommandLine] <> "\" " <> ToString[$ProcessID ]]
] 
```

*Mathematica* [Put](http://reference.wolfram.com/mathematica/ref/Put.html)命令用于启动 gdb 并将其附加到Mathematica*内核*进程。然后将 gdb 命令发送到 stdin 上的 gdb 以使用[putenv](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/putenv.3.html)`call (int) putenv ("var=value")`设置环境变量。

警告：在 Mac OS X 下，gdb 仅在安装了[Xcode 开发者工具](http://developer.apple.com/xcode/)后才可用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T22:48:17.103

我假设您要在尝试运行外部命令之前执行此操作，对吗？为什么不直接运行“VARNAME=value; your_original_external_command”，它将临时设置 evn 变量。

# c# - 更快的深度克隆

> ID：852064
> 
> 赞同：24
> 
> 时间：2009-05-12T10:07:57.213
> 
> 标签：c#, .net

有没有人想要一个允许我通过值.Net 对象克隆的框架/类？我只对公共读/写属性（即DataContracts）感兴趣，我不在乎引用是否正确解析（即包含两次相同项目实例的集合）。

我尝试了通过（序列化到 XML 并返回）的序列化技巧`DataContractSerializer`，编写了基于反射的克隆类（有时更快/有时更慢），并且想知道是否有人编写了一个辅助类，它可以通过 Emit 而不是反射来做到这一点。至于现在发出 IL 对我的小脑袋来说有点过分了，但我想这将是最终的解决方案。除非有人知道比 DataContractSerializer 更快的替代方法。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-13T11:01:40.447

前段时间我为 .NET 编写了三个深度克隆方法：

*   一种使用众所周知的`BinaryFormatter`技术（尽管我对其进行了调整，以便对象不需要可序列化即可被克隆）。这是迄今为止最慢的。

*   第二个我使用纯反射。它至少比使用`BinaryFormatter`. 这个也可以用于 Silverlight 和 .NET Compact Framework。

*   第三个使用 Linq 表达式树（用于运行时 MSIL 生成）。它比该`BinaryFormatter`技术快 60 倍，但第一次遇到每个类时的设置时间约为 2 毫秒。

![说明克隆性能的对数刻度](https://i.stack.imgur.com/VhMyo.png)

水平轴显示克隆对象的数量（尽管每个克隆对象都包含多个嵌套对象）。

在`BinaryFormatter`图表中标记为“序列化”。数据系列“Reflection”是一个自定义系列，它通过`GetField()`/复制字段`SetField()`。

我在这里将所有三种克隆方法都发布为开源：

[http://blog.nuclex-games.com/mono-dotnet/fast-deep-cloning/](http://blog.nuclex-games.com/mono-dotnet/fast-deep-cloning/)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-12T10:48:40.813

如果您在谈论对象树/图：

编写特定的 IL 来序列化对象是很棘手的。IMO，您最好的选择是查看完整的序列化，例如如何`DataContractSerializer`工作 - 但不一定与该引擎一起使用。

例如，[protobuf-net](http://code.google.com/p/protobuf-net/)有一种`Serializer.DeepClone<T>`方法可能会有所帮助。`DataContractSerializer`至少应该比 快。目前，您需要为序列化程序添加一些线索（即使只是`[ProtoContract(ImplicitFields=ImplicitFields.AllPublic)]`） - 但是，当前（不完整的）正在进行的工作提供了没有属性的 POCO 支持。

* * *

如果您在谈论单个对象：

您可以`Expression`在 .NET 3.5 中做一些相当简单的事情；`Expression`基于反射构建动态，并调用`.Compile()`. [MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/)已经有了这个：

```
DestType clone = PropertyCopy<DestType>.CopyFrom(original); 
```

对于 .NET 2.0/3.0（不带`Expression`），您可能会出于类似目的考虑[使用 HyperDescriptor 。](http://www.codeproject.com/KB/cs/HyperPropertyDescriptor.aspx)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-11-09T12:56:39.807

有很多库可以执行此操作。您可以[在此处](https://github.com/force-net/DeepCloner#performance)查看基准测试结果：

简而言之，如果您需要性能，请手动执行，它确实更快。此外，一些库允许执行*浅*克隆（根据问题，这对您来说是一个很好的变体），这更快。`BinaryFormatter`如果您需要任何性能，请不要使用。

此外，@frakon 提到表达式树与 IL Emit 具有相同的速度，这有点不正确。表达式树稍慢，但可以在部分受信任的应用程序中使用。

手动 13ms

DeepCloner (IL Emit) 167ms

DeepCloner（表达式）267ms

CloneExtensions（表达式）560ms

NClone 901ms

克隆。行为！8551毫秒

乔治克隆尼 1996 毫秒

Nuclex.Cloning 不适用（已崩溃）

FastDeepCloner 1882ms

二进制格式化程序 15000ms

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-07-12T09:03:38.607

互联网上可能没有 IL Emit 制作的完整工作克隆代码。

但是 IL Emit 与 Expression Trees 的代码具有相同的速度，因为这两种方法最终都具有相似的编译 lambda 复制函数。Expression Trees**比 Reflection 快大约 4 倍**。最棒的是，**Expression Trees 通用克隆功能在 Internet 上提供**。

Cygon[已经提到](https://stackoverflow.com/a/11013490/2094687)了表达式树的一种实现。可以在 CodeProject 文章 **[Fast Deep Copy by Expression Trees (C#)](http://www.codeproject.com/Articles/1111658/Fast-Deep-Copy-by-Expression-Trees-C-Sharp)**中找到经过全面测试的新实现。

使用扩展方法

```
var copy = originalObject.DeepCopyByExpressionTree(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-12T10:12:28.283

尝试[AutoMapper](http://www.codeplex.com/AutoMapper)或[BLToolkit 映射](http://bltoolkit.net/Doc/Mapping/MapFieldAttribute.htm)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-12T10:16:13.283

我不知道这是否完全符合您的要求，但您也可以使用[`BinaryFormatter`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.binary.binaryformatter.aspx). 请参阅相关问题的[**答案**](https://stackoverflow.com/questions/519461/cloning-listt/519512#519512)[（由Binoj Antony 撰写](https://stackoverflow.com/users/33015/binoj-antony)）：

```
public static class GenericCopier<T>
{
    public static T DeepCopy(object objectToCopy)
    {
        using (MemoryStream memoryStream = new MemoryStream())
        {
            BinaryFormatter binaryFormatter = new BinaryFormatter();
            binaryFormatter.Serialize(memoryStream, objectToCopy);
            memoryStream.Seek(0, SeekOrigin.Begin);
            return (T) binaryFormatter.Deserialize(memoryStream);
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T10:13:13.507

基于动态方法的序列化将是最快的。（使用轻量级codegen生成动态方法并用于序列化）

您可以为每个属性/字段执行 1 种方法，也可以为整个对象执行一种方法。从我的基准测试来看，每个属性做 1 不会给你带来太多的性能影响。

请参阅以下代码，了解我如何在媒体浏览器中执行此操作：[http ://code.google.com/p/videobrowser/source/browse/trunk/MediaBrowser/Library/Persistance/Serializer.cs](http://code.google.com/p/videobrowser/source/browse/trunk/MediaBrowser/Library/Persistance/Serializer.cs)

那里也有一些单元测试。

指令限制上有快速反射示例，可以完全满足您的要求。

看：

[http://theinstructionlimit.com/?p=76](http://theinstructionlimit.com/?p=76)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-09T06:42:02.473

CGbR[代码生成器](https://github.com/Toxantron/CGbR#cloneable)可以为您生成一个实现[`ICloneable`](https://msdn.microsoft.com/library/system.icloneable(v=vs.110).aspx)。您所需要的只是[nuget 包](https://www.nuget.org/packages/CGbR/)和实现`ICloneable`. 生成器将为您完成剩下的工作：

```
public partial class Root : ICloneable
{
    public Root(int number)
    {
        _number = number;
    }
    private int _number;

    public Partial[] Partials { get; set; }

    public IList<ulong> Numbers { get; set; }

    public object Clone()
    {
        return Clone(true);
    }

    private Root()
    {
    }
} 

public partial class Root
{
    public Root Clone(bool deep)
    {
        var copy = new Root();
        // All value types can be simply copied
        copy._number = _number; 
        if (deep)
        {
            // In a deep clone the references are cloned 
            var tempPartials = new Partial[Partials.Length];
            for (var i = 0; i < Partials.Length; i++)
            {
                var value = Partials[i];
                value = value.Clone(true);
                tempPartials[i] = value;
            }
            copy.Partials = tempPartials;
            var tempNumbers = new List<ulong>(Numbers.Count);
            for (var i = 0; i < Numbers.Count; i++)
            {
                var value = Numbers[i];
                tempNumbers[i] = value;
            }
            copy.Numbers = tempNumbers;
        }
        else
        {
            // In a shallow clone only references are copied
            copy.Partials = Partials; 
            copy.Numbers = Numbers; 
        }
        return copy;
    }
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-09-20T18:59:10.977

好！您可以编写自己的克隆方法，您可以指定通过其属性忽略或包含属性。我在链接中的新库使用反射和 FieldInfo 递归地克隆对象。我已将它添加到 CodeProject，因此您很快就可以访问它的代码，您可以根据需要对其进行修改。

尝试一下它非常快速和干净，你会喜欢它。
[https://www.nuget.org/packages/FastDeepCloner/1.0.1](https://www.nuget.org/packages/FastDeepCloner/1.0.1)
或
PM> Install-Package FastDeepCloner

# vb.net - 更新访问错误

> ID：852065
> 
> 赞同：1
> 
> 时间：2009-05-12T10:08:03.687
> 
> 标签：vb.net, ms-access, updating

```
 Dim conn As OleDbConnection
    Dim cmd As OleDbCommand

    Public Sub openDB()
        conn = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Application.StartupPath & "\VFMS_DB.mdb;" & "Jet OLEDB:System Database=Security.mdw;User ID=Adster;Password=300624;")
        conn.Open()
    End Sub

    Public Function UpdateUser() As Integer
        Dim retCode As New Integer

        Try
            openDB()
            cmd = conn.CreateCommand() 
```

下面的更新命令一直给我这个错误：“从字符串“' WHERE [用户名] ='”到类型'Double'的转换无效。” 我不知道为什么。aUserName 字段是一个字符串字段，我检查以确保它已填充。

```
 cmd.CommandText = "UPDATE Users SET [First Name] = '" & aName & "', [Last Name] = '" & aSurname & "', [Contact Number] = '" & aContactNum & "', [Password] = '" & aPassword & "', [User Rights] = '" & aUserRights + "' WHERE [Username] = '" + aUserName + "' "

            cmd.ExecuteNonQuery()
            conn.Close()

            'rsAddRecs = rsConn.Execute("UPDATE Users ([First Name], [Last Name], [Contact Number], [User Name], [Password], [User Rights]) VALUES ('" & aName & "','" & aSurname & "','" & aContactNum & "','" & aUserName & "','" & aPassword & "','" & aUserRights & "')")

            retCode = 0
            'rsConn.Close()
            Return retCode

        Catch ex As Exception
            MessageBox.Show(ex.ToString, ex.Message, MessageBoxButtons.OK)
            retCode = 1
            Return retCode
        End Try
    End Function 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T10:13:56.953

你有一个错字。您在sql 字符串的末尾使用**+ concat 字符而不是****&**字符

**错误的**

```
cmd.CommandText = "UPDATE Users SET [First Name] = '" & aName & _ 
                  "', [Last Name] = '" & aSurname & _
                  "', [Contact Number] = '" & aContactNum & _
                  "', [Password] = '" & aPassword & "', [User Rights] = '" & _
                  aUserRights + "' WHERE [Username] = '" + aUserName + "' "
'                             ^                          ^           ^ 
```

**对**

```
cmd.CommandText = "UPDATE Users SET [First Name] = '" & aName & _
                  "', [Last Name] = '" & aSurname & _
                  "', [Contact Number] = '" & aContactNum & _
                  "', [Password] = '" & aPassword & "', [User Rights] = '" & _
                  aUserRights & "' WHERE [Username] = '" & aUserName & "' "
'                             ^                          ^           ^ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T11:04:47.450

您的 SQL 代码使用`[Username]`：

```
cmd.CommandText = "UPDATE Users SET ... [Username]... 
```

而您注释掉了使用的代码`[User Name]`：

```
'rsAddRecs = rsConn.Execute("UPDATE Users ... [User Name]... 
```

错误的列名可能是问题的根源吗？

另一个想法：您是否对参数值进行了清理，例如，该值是否包含会扰乱动态 SQL 的单引号。在任何情况下，我认为您应该考虑使用准备好的语句（甚至 PROCEDURES）并使用 Parameter 对象来调用 SQL，从而将参数值的清理推迟到 OLE DB 提供程序，这当然会比主题更了解你或我:)

# java - Java 泛型

> ID：852067
> 
> 赞同：1
> 
> 时间：2009-05-12T10:08:42.470
> 
> 标签：java, generics

是否有可能制作一个可以接受任何东西的方法，包括对象、整数等？我有一个方法检查值是否为空，我想也许可以用泛型而不是重载来完成。不幸的是，尝试

```
nullChecking(Class<? extends Object> value){
...
} 
```

不允许整数，因为它们扩展了 Number 而不是对象。有办法吗？

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T10:12:14.680

你不能做`nullChecking(Object value)`吗？如果你只是想测试它是否为空，它会起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T10:15:54.097

我不确定你要做什么......如果它只是检查一个对象是否是`null`那么你可以简单地这样做：

```
public static boolean nullChecking(Object obj) {
    return obj == null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T20:47:33.630

一个

```
public <T> boolean isNull(T obj) { return obj == null; } 
```

会工作......但是......有什么用？

你认为那

```
if (isNull(myObj)) { ... } 
```

比写更容易

```
if (myObj == null) { .... } 
```

?

考虑到您将在第一种情况下进行方法调用，并且对我而言，这会消耗 [几乎没有，但确实会] 系统资源而没有逻辑优势。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T20:35:20.327

实际上有一种方法可以做到这一点，但我不建议您使用它......

所以，这里是如何做到这一点（和警告，它绕过编译时类型检查，所以你打开自己运行时类转换异常......）

假设您有一个“getter”，可以返回多种类型 - 它可以声明为通用类型，如下所示：

```
public <X> X get(String propertyName) { ... } 
```

您可以为“二传手”做同样的事情：

```
public <X> void set(String property, X value) { ... } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-20T14:04:55.977

从 Java 1.7 开始，您可以使用以下方法[`java.util.Objects`](https://docs.oracle.com/javase/8/docs/api/)：

```
public static <T> T requireNonNull(T obj)
public static <T> T requireNonNull(T obj, String message)
public static <T> T requireNonNull(T obj, Supplier<String> messageSupplier) 
```

或者只是检查他们的代码。

# sharepoint - SharePoint 审批工作流

> ID：852068
> 
> 赞同：0
> 
> 时间：2009-05-12T10:08:55.560
> 
> 标签：sharepoint, sharepoint-2007, workflow

我在 SharePoint 中有一个自定义内容类型，它有一个与之关联的审批工作流。内容类型包含几个选择站点列。现在需要更改选择列的值并更新现有内容以反映新值。

例如，

```
Existing Choices:
Choice 1
Choice 2
Choice 3

New Choices
Choice 1a
Choice 2a
Choice 3 
```

因此，一些选项正在重命名。

据我所知，虽然更改选项列是直截了当的，但现有列表项不会自动获取新值，即选择了选项 1 的列表项仍将显示选项 1，直到列表项被物理编辑。但编辑项目需要重新批准工作流程。有几千个项目分布在几个列表中，这些项目将受到此更改的影响。

所以，我的问题：是否可以在进行更改时暂停或分离工作流，然后在进行更改后重新附加/重新激活，从而避免重新批准所有内容？还是我最好看看自动重新批准？

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T10:33:22.570

您可以使用对象模型更新值，[SPListItem.SystemUpdate](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistitem.systemupdate.aspx)方法可以选择允许您阻止创建新版本。

您可以使用[SPSiteDataQuery](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsitedataquery.aspx)使用您的内容类型查找所有项目，然后使用上述方法更新它们。

问候，丹尼尔·卡尔森

# c++ - 乘以定义的符号

> ID：852070
> 
> 赞同：3
> 
> 时间：2009-05-12T10:09:16.883
> 
> 标签：c++, compiler-construction

如果我在头文件中声明一个全局变量并将其包含在两个 .cpp 文件中，则链接器会给出一个错误，指出该符号是多重定义的。我的问题是，为什么这只发生在某些类型的对象（例如 int）而不是其他类型的对象（例如 enum）上？

我使用的测试代码如下：

测试.h

```
#ifndef TEST_HEADER
#define TEST_HEADER

namespace test
{           
        int i_Test1 = -1;
        int i_Test2 = -1;
};

#endif // TEST_HEADER 
```

类1.h

```
#ifndef CLASS_1_HEADER
#define CLASS_1_HEADER

class class1
{
public:
        void count();
};

#endif //CLASS_1_HEADER 
```

类1.cpp

```
#include <iostream>
#include "class1.h"
#include "test.h"

void class1::count()
{
        std::cout << test::i_Test1 << std::endl;
} 
```

类2.h

```
#ifndef CLASS_2_HEADER
#define CLASS_2_HEADER

class class2
{
public:
        void count();
};

#endif //CLASS_2_HEADER 
```

类2.cpp

```
#include "class2.h"
#include <iostream>
#include "test.h"

void class2::count()
{
        std::cout << test::i_Test2 << std::endl;
} 
```

主文件

```
#include "class1.h"
#include "class2.h"

int main(int argc, char** argv)
{
        class1 c1;
        class2 c2;
        c1.count();
        c2.count();
        return -1;
} 
```

使用以下代码构建此代码：

```
g++ main.cpp class1.cpp class2.cpp -o a 
```

产生以下输出：

> ld：致命：符号`test::i_Test1' is multiply-defined: (file /var/tmp//ccwWLyrM.o type=OBJT; file /var/tmp//ccOemftz.o type=OBJT); ld: fatal: symbol` test::i_Test2' 是多重定义的：（文件 /var/tmp//ccwWLyrM.o 类型=OBJT；文件/var/tmp//ccOemftz.o 类型=OBJT）；ld：致命：文件处理错误。没有输出写入 collect2：ld 返回 1 退出状态

如果我更改 test.h 文件，如下所示：

test.h（带枚举）

```
#ifndef TEST_HEADER
#define TEST_HEADER

namespace test
{
        enum val
        {
                i_Test1 = 5,
                i_Test2
        };
        //int i_Test1 = -1;
        //int i_Test2 = -1;
};

#endif // TEST_HEADER 
```

我没有收到“多重定义”错误，并且程序给出了所需的输出：

```
5
6 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-12T10:22:25.710

那是因为枚举不是对象——它们是类型。类类型（class、struct、union）和枚举可以在整个程序中定义多次，前提是所有定义都满足一些限制（由所谓的*单一定义规则*(ODR) 总结）。最重要的两个是

*   所有定义都具有相同的标记序列（文本相同）
*   在所有定义中使用的名称必须具有相同的含义（解析为相同的事物）。（这是对定义上下文的要求）

您的枚举定义满足 ODR 的所有条件。因此，这是有效的，链接器/编译器没有理由抱怨（实际上，对于违反 ODR，编译器也不需要发出消息 - 其中大部分都属于所谓的*不需要诊断*规则，有些违规也会导致未定义的行为）。

但是，对于每个非内联函数和对象，它们只能定义一次。乘以定义这些会导致虚假错误，就像您的情况一样。要解决这个问题，只需将*声明*放入头文件（使用“extern”而不使用初始化程序）并将*一个*定义放入其中一个 .cpp 文件（然后省略“extern”或放入初始化程序。如果它是 const对象，您仍然需要“extern”，因为默认的 const 变量具有内部链接，否则符号不会被导出）。

# c - 跟踪内存 malloc/free 的简单 C 实现？

> ID：852072
> 
> 赞同：11
> 
> 时间：2009-05-12T10:10:03.700
> 
> 标签：c, dynamic-memory-allocation

编程语言：C 平台：ARM 编译器：ADS 1.2

我需要跟踪`melloc/free`项目中的简单调用。我只需要非常基本地了解当程序分配了所有资源时需要多少堆内存。因此，我为`malloc/free`调用提供了一个包装器。在这些包装器中，我需要在调用时增加当前内存计数，`malloc`并在调用时减少它`free`。这个`malloc`案子很简单，因为我有从调用者那里分配的大小。我想知道如何处理这种`free`情况，因为我需要将指针/大小映射存储在某处。这是 C，我没有标准的地图来轻松实现这一点。

我试图避免在任何库中进行链接，因此更喜欢 *.c/h 实现。

所以我想知道是否已经有一个简单的实现可以引导我。如果没有，这是继续实施的动力。

编辑：纯粹用于调试，此代码不随产品一起提供。

编辑：基于 Makis 的回答的初始实施。我会很感激对此的反馈。

编辑：重新实施

```
#include <stdlib.h>
#include <stdio.h>
#include <assert.h>
#include <string.h>
#include <limits.h>

static size_t gnCurrentMemory = 0;
static size_t gnPeakMemory    = 0;

void *MemAlloc (size_t nSize)
{
  void *pMem = malloc(sizeof(size_t) + nSize);

  if (pMem)
  {
    size_t *pSize = (size_t *)pMem;

    memcpy(pSize, &nSize, sizeof(nSize));

    gnCurrentMemory += nSize;

    if (gnCurrentMemory > gnPeakMemory)
    {
      gnPeakMemory = gnCurrentMemory;
    }

    printf("PMemAlloc (%#X) - Size (%d), Current (%d), Peak (%d)\n",
           pSize + 1, nSize, gnCurrentMemory, gnPeakMemory);

    return(pSize + 1);
  }

  return NULL;
}

void  MemFree (void *pMem)
{
  if(pMem)
  {
    size_t *pSize = (size_t *)pMem;

    // Get the size
    --pSize;

    assert(gnCurrentMemory >= *pSize);

    printf("PMemFree (%#X) - Size (%d), Current (%d), Peak (%d)\n",
           pMem,  *pSize, gnCurrentMemory, gnPeakMemory);

    gnCurrentMemory -= *pSize;

    free(pSize);
  }
}

#define BUFFERSIZE (1024*1024)

typedef struct
{
  bool flag;
  int buffer[BUFFERSIZE];
  bool bools[BUFFERSIZE];
} sample_buffer;

typedef struct
{
  unsigned int whichbuffer;
  char ch;
} buffer_info;

int main(void)
{
  unsigned int i;
  buffer_info *bufferinfo;

  sample_buffer  *mybuffer;

  char *pCh;

  printf("Tesint MemAlloc - MemFree\n");

  mybuffer = (sample_buffer *) MemAlloc(sizeof(sample_buffer));

  if (mybuffer == NULL)
  {
    printf("ERROR ALLOCATING mybuffer\n");

    return EXIT_FAILURE;
  }

  bufferinfo = (buffer_info *) MemAlloc(sizeof(buffer_info));

  if (bufferinfo == NULL)
  {
    printf("ERROR ALLOCATING bufferinfo\n");

    MemFree(mybuffer);

    return EXIT_FAILURE;
  }

  pCh = (char *)MemAlloc(sizeof(char));

  printf("finished malloc\n");

  // fill allocated memory with integers and read back some values
  for(i = 0; i < BUFFERSIZE; ++i)
  {
    mybuffer->buffer[i] = i;
    mybuffer->bools[i] = true;
    bufferinfo->whichbuffer = (unsigned int)(i/100);
  }

  MemFree(bufferinfo);
  MemFree(mybuffer);

  if(pCh)
  {
    MemFree(pCh);
  }

  return EXIT_SUCCESS;
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-12T10:29:30.860

您可以在包装器中分配一些额外的字节，并在其中放置一个 id（如果您希望能够耦合 malloc() 和 free()）或只是其中的大小。只需 malloc() 更多的内存，将信息存储在内存块的开头，然后将返回的指针向前移动那么多字节。

顺便说一句，这也可以很容易地用于栅栏指针/指纹等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T10:23:07.110

要么您可以访问`malloc`/使用的内部表`free`（请参阅这个问题：[Where Do malloc() / free() Store Allocated Sizes and Addresses?](https://stackoverflow.com/questions/851958/where-do-malloc-free-store-allocated-sizes-and-addresses)以获得一些提示），或者您必须在包装器中管理自己的表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T12:17:50.133

你总是可以使用[valgrind](http://valgrind.org/)而不是滚动你自己的实现。如果您不关心分配的内存量，则可以使用更简单的实现：（我这样做的速度非常快，因此可能会出现错误，并且我意识到这不是最有效的实现。应该给 pAllocedStorage 一个初始大小并增加一些因素以调整大小等，但你明白了。）

**编辑：**我错过了这是针对 ARM 的，据我所知 valgrind 在 ARM 上不可用，因此这可能不是一个选项。

```
static size_t indexAllocedStorage = 0;
static size_t *pAllocedStorage = NULL;
static unsigned int free_calls = 0; 
static unsigned long long int total_mem_alloced = 0; 

void * 
my_malloc(size_t size){
    size_t *temp;
    void *p = malloc(size);
    if(p == NULL){
    fprintf(stderr,"my_malloc malloc failed, %s", strerror(errno));
    exit(EXIT_FAILURE);
    }

    total_mem_alloced += size;

    temp = (size_t *)realloc(pAllocedStorage, (indexAllocedStorage+1) * sizeof(size_t));
    if(temp == NULL){
        fprintf(stderr,"my_malloc realloc failed, %s", strerror(errno));
         exit(EXIT_FAILURE);
    }

    pAllocedStorage = temp; 
    pAllocedStorage[indexAllocedStorage++] = (size_t)p;

    return p;
}

void 
my_free(void *p){
    size_t i;
    int found = 0;

    for(i = 0; i < indexAllocedStorage; i++){
    if(pAllocedStorage[i] == (size_t)p){
        pAllocedStorage[i] = (size_t)NULL;
        found = 1;
        break;
        }
    }

    if(!found){
        printf("Free Called on unknown\n");
    }

    free_calls++;
    free(p);
}

void 
free_check(void) {
    size_t i;

    printf("checking freed memeory\n");
    for(i = 0; i < indexAllocedStorage; i++){   
        if(pAllocedStorage[i] != (size_t)NULL){
            printf( "Memory leak %X\n", (unsigned int)pAllocedStorage[i]);
            free((void *)pAllocedStorage[i]);
        }
    }

    free(pAllocedStorage);
    pAllocedStorage = NULL;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T12:34:07.030

我会使用[rmalloc](http://www.hexco.de/rmdebug/)。它是一个简单的库（实际上只有两个文件）来调试内存使用情况，但它也支持统计信息。由于您已经包装了函数，因此使用 rmalloc 应该很容易。请记住，您还需要替换 strdup 等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T13:12:28.287

您的程序可能还需要拦截 realloc()、calloc()、getcwd()（因为在某些实现中，当 buffer 为 NULL 时它可能会分配内存）以及 strdup() 或类似函数，如果您的编译器支持的话

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T03:38:17.893

如果你正在运行，`x86`你可以在**[valgrind](http://valgrind.org)****下运行你的二进制**`malloc`文件，它会使用和的标准实现为你收集所有这些信息`free`。简单的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-01T20:04:17.267

我一直在尝试这个页面上提到的一些相同的技术，并从谷歌搜索到这里。我知道这个问题很老，但想添加记录......

1) 您的操作系统是否没有提供任何工具来查看正在运行的进程中使用了多少堆内存？我看到你在谈论 ARM，所以很可能就是这种情况。在大多数功能齐全的操作系统中，这只是使用命令行工具查看堆大小的问题。

2) 如果在您的 libc 中可用，大多数平台上的 sbrk(0) 会告诉您数据段的结束地址。如果你有它，你需要做的就是在你的程序开始时存储那个地址（比如，startBrk=sbrk(0)），那么在任何时候你分配的大小都是 sbrk(0) - startBrk。

3）如果可以使用共享对象，您正在动态链接到您的 libc，并且您的操作系统的运行时加载程序具有类似 LD_PRELOAD 环境变量的东西，您可能会发现构建自己的定义实际 libc 函数的共享对象更有用相同的符号（malloc()，而不是 MemAlloc()），然后让加载程序首先加载您的 lib 并“插入”libc 函数。您可以使用 dlsym() 和 RTLD_NEXT 标志进一步获取实际 libc 函数的地址，这样您就可以执行上述操作，而无需重新编译所有代码以使用 malloc/free 包装器。然后，当您启动程序（或任何符合第一句话中描述的程序）时，它只是一个运行时决定，您在其中设置了一个环境变量，如 LD_PRELOAD=mymemdebug.so 然后运行它。

# winapi - 用于 Process.BeginOutputReadLine 的 win32 api

> ID：852079
> 
> 赞同：0
> 
> 时间：2009-05-12T10:12:42.603
> 
> 标签：winapi

我想知道 c# 的 Process.BeginOutputReadLine 的 c++ 等价物，我从另一个进程的标准输出中异步读取。它有任何API吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T10:47:37.850

[`STARTUPINFO`](http://msdn.microsoft.com/library/ms686331)要读取进程的标准输出，您需要为传递给的实例分配适当的句柄[`CreateProcess`](http://msdn.microsoft.com/library/ms682425)。请记住包含`STARTF_USESTDHANDLES`标志。

通常使用匿名管道，通过[`CreatePipe`](http://msdn.microsoft.com/en-us/library/aa365152.aspx).

有关示例，请参阅“[使用重定向的输入和输出创建子进程](http://msdn.microsoft.com/library/ms682499)”。

您可以使用正常的 Win32 方法（OVERLAPPED + 事件、IOCompleteion 端口...）来异步读取输出句柄。

# php - 在 PHP 中获取 Google 日历事件

> ID：852088
> 
> 赞同：12
> 
> 时间：2009-05-12T10:15:16.907
> 
> 标签：php, xml, google-calendar-api, icalendar, atom-feed

我正在为某人创建博客。他们想要提取大量数据并将其紧密集成到设计中，因此标准小部件是禁忌。到现在为止都很好。

他们有一个公共访问谷歌日历，上面有各种事件，我想抓取接下来的 5 个事件（从“现在”开始）并显示事件标题、事件实例开始时、它的位置和到 gcal 的链接物品。

据我所见，获取 gcal 提要有三个选项：XML、ical 或 HTML（包含一些非常糟糕的 JSON）。XML 似乎是合乎逻辑的选择，对吧？

好吧，XML 提要（在原子提要描述之后）实际上只是很多 faffy HTML。解析这是可能的，但在后面是一个巨大的痛苦，因为重复事件（日历上有几个）只显示该事件的第一个实例，并且（显然）没有关于下一个实例何时出现的信息。

所以我只是有点密集吗？有没有办法通过 XML API 显示我想要的内容？

或者我会通过 iCal 获得更好的运气吗？我从来没有用 PHP 做过任何 iCal，所以如果你有，请推荐你用来让事情变得更简单的任何库。

**编辑：**感谢答案，我下载了 Zend Gdata 包（幸运的是，它与 Zend 框架的其余部分*是分开的）。*做我需要的就这么简单：

```
require_once 'Zend/Loader.php';
Zend_Loader::loadClass('Zend_Gdata');
Zend_Loader::loadClass('Zend_Gdata_HttpClient');
Zend_Loader::loadClass('Zend_Gdata_Calendar');
$service = new Zend_Gdata_Calendar();
$query = $service->newEventQuery();

$query->setUser('your_user@googlemail.com');

$query->setVisibility('public');
$query->setProjection('full');
$query->setStartMin(date('Y-n-j'));
$query->setStartMax(date('Y-n-j', time() + (60*60 *24*8)));
$query->setOrderby('starttime');

try { $eventFeed = $service->getCalendarEventFeed($query); }
catch (Zend_Gdata_App_Exception $e) { return; }

foreach ($eventFeed as $event) 
    echo $event; // do something real here 
```

这应该可以为您带来一周的事件（是的 setStartMax 是专有的，因此需要将其设置为未来 8 天）。

希望这对将来的其他人有所帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T10:23:13.930

另一种选择是使用 Zend Google Calendar 库，它是 zend 框架的独立部分，因此您不需要整个 zend 框架

[http://framework.zend.com/manual/en/zend.gdata.calendar.html](http://framework.zend.com/manual/en/zend.gdata.calendar.html)

一旦您查看示例，这并不难。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-26T19:51:36.343

万一它对其他人有帮助，我想出了如何获取默认日历以外的日历。如果您进入您的谷歌日历并查找日历设置，在底部有一个日历 ID，其格式类似于一个非常长的电子邮件地址。（例如：adg5jcq8gk7lsp6rrbmrm8c@group.calendar.google.com）与 $query- 一起使用>setUser() 以使用该特定日历。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-20T09:04:47.863

作为对使用该代码的任何人的提醒，`echo $event;`没有为我显示任何内容，所以我认为查询失败了。

这是一个应该打印一些东西的片段：

```
foreach ($eventFeed as $event) {
  echo $event->title->text . '<br />';
} 
```

# java - 为什么我的 Jnlp 程序不能与 log4j 一起使用？

> ID：852089
> 
> 赞同：0
> 
> 时间：2009-05-12T10:15:26.063
> 
> 标签：java, log4j, jnlp

我有以下问题：我在 Tomcat 中部署了一个 JNLP 和一个可执行的 JAR 文件。JNLP 文件应该会自动下载 JAR 文件并执行它。JAR 文件经过签名和验证。这完成了（下载部分）。但是当执行JAR主类（在JNLP文件中指定）时，出现了一个问题：执行了部分主类代码。之后，当它尝试加载一个声明了 static final org.apache.log4j.Logger 实例的类时，它会说一个错误。

下面是 JNLP 文件的代表部分、代码和错误。

**JNLP**

```
<?xml version='1.0' encoding='UTF-8'?>
<jnlp spec="1.5+" codebase="http://localhost:8080/examples" href="DemoInstaller.jnlp" download="eager" main="true">
    <information>
        <title>Demo Installer</title>
        <vendor>Codemart [www.codemart.ro]</vendor>
        <homepage>https://sourceforge.net/projects/cminstall/</homepage>
        <description>This is a demo installer built using Codemart Installer framework with JavaFX</description>
        <description kind="tooltip">Codemart Demo Installer</description>
        <offline-allowed />
        <shortcut online="true">
            <desktop />
        </shortcut>
    </information>

<security>
    <all-permissions />
</security>

<update check="background" />

<resources>
    <j2se href="http://java.sun.com/products/autodl/j2se" version="1.6+" />
            <jar href="DemoInstaller.jar" main="true" download="eager" />
</resources>

<application-desc main-class="ro.codemart.installer.packer.ant.impl.nestedjar.Main" /> 
```

**主要类：**

```
public class Main {
 public static void main(String[] args) throws Exception {
     final Main main = new Main();
     //this is the problem class !
     Class clazz = Class.forName("WizardRunner");
     Method m = clazz.getMethod("main", new Class[]{args.getClass()});
     m.invoke(null, new Object[]{args});      
    ...
   }
} 
```

**问题类：**

```
public class WizardRunner{

    private final static Logger log = Logger.getLogger(WizardRunner.class);
...
} 
```

**和错误：**

log4j：错误找不到 [log4j.dtd]。在搜索中使用了 [sun.misc.Launcher$AppClassLoader@d9f9c3] 类加载器。log4j:ERROR 无法解析 url [jar: [http://localhost:8080/examples/DemoJar.jar!/log4j.xml]](http://localhost:8080/examples/DemoJar.jar!/log4j.xml]). java.io.FileNotFoundException：在 com.sun.jnlp.JNLPCachedJarURLConnection.getInputStream(Unknown Source) 的 com.sun.jnlp.JNLPCachedJarURLConnection.connect(Unknown Source) 中找不到 JAR 条目 log4j.dtd .xerces.internal.impl.XMLEntityManager.setupCurrentEntity(Unknown Source) at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.startEntity(Unknown Source) at com.sun.org.apache.xerces.internal.impl .XMLEntityManager.startDTDEntity(Unknown Source) at com.sun.org.apache.xerces.internal.impl.XMLDTDScannerImpl.setInputSource(Unknown Source) at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$DTDDriver.dispatch （未知来源）在 com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$DTDDriver.next（未知来源）在 com.sun.org.apache.xerces.internal.impl。DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at com.sun.javaws.Launcher.executeApplication(Unknown Source) at com.sun.javaws.Launcher.executeMainClass(Unknown Source) at com.sun.javaws.Launcher.doLaunchApp(Unknown Source) at com.sun.javaws.Launcher.run(Unknown Source) at java.lang.Thread.run(Unknown Source) log4j:WARN No appenders can be found for logger (巫师跑者）。log4j:WARN 请正确初始化 log4j 系统。lang.Thread.run(Unknown Source) log4j:WARN 找不到记录器（WizardRunner）的附加程序。log4j:WARN 请正确初始化 log4j 系统。lang.Thread.run(Unknown Source) log4j:WARN 找不到记录器（WizardRunner）的附加程序。log4j:WARN 请正确初始化 log4j 系统。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T19:27:04.993

我认为问题是缺少 log4j.jar - 它不是由 .jnlp 文件指定或加载的。您在上一个答案中提到它在您的类路径中，但是如果您是通过 WebStart 运行的呢？我相信您的类路径仅限于 .jnlp 文件中定义的内容。

尝试添加

```
<jar href="log4j.jar" main="true" download="eager" /> 
```

至

```
<resources> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T10:48:54.557

如果您查看堆栈跟踪，错误的原因是 log4j.dtd 的 FileNotFoundException。查看如何从 log4j.xml 中引用 DTD。DTD 是否包含在您的 jar 文件中？它需要位于 JVM 可以加载它的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T13:21:33.320

是的，**log4j.dtd**文件嵌入了**log4j-1.2.12.jar**。这个 log4j jar 也在类路径中。

# sql - SQL 创建用于返回年龄段的存储过程

> ID：852091
> 
> 赞同：4
> 
> 时间：2009-05-12T10:15:41.587
> 
> 标签：sql, stored-procedures

我有一个名为 Person 的表，其中包含一个名为 PersonAge 的字段。我需要按年龄段对年龄进行分组，即“12 岁及以下”、“13-17 岁”、“18-25 岁”、“25 岁及以上”，并使用存储过程返回此结果集。

理想情况下，我需要返回 2 个字段，'Age Band'，'Total' 像这样

```
年龄段 总计
12 岁及以下 5
13 - 17 8
18 - 25 7
25 岁及以上 10

```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-12T10:27:03.423

创建一个包含您的乐队的表格：

```
CREATE TABLE agebands
(
    id INT NOT NULL PRIMARY KEY,
    lower_bound INT NOT NULL,
    upper_bound INT NOT NULL
)
CREATE INDEX IDX_agebands_bounds ON (lower_bound, upper_bound) 
```

然后用您的数据填充它：

```
INSERT INTO agebands VALUES (1, 0, 12)
INSERT INTO agebands VALUES (2, 13, 17)
INSERT INTO agebands VALUES (3, 18, 24)
INSERT INTO agebands VALUES (4, 25, 199) 
```

然后加入它：

```
SELECT
    lower_bound, upper_bound,
    COUNT(*) AS number_of_people
FROM
    persons
    INNER JOIN agebands
        ON person_age BETWEEN lower_bound AND upper_bound
GROUP BY
    lower_bound, upper_bound
ORDER BY
    lower_bound 
```

这允许灵活地调整频带。当然，这里使用 UNION 的另一个答案也是可用的，如果您可以/不会将另一个表添加到数据库中，这更合适。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T10:23:49.060

一个简单的 UNION 就足够了。

```
SELECT [Ageband] = '12 and under', COUNT(*)
FROM dbo.Person
WHERE PersonAge <= 12
UNION ALL SELECT '13-17', COUNT(*)
FROM dbo.Person
WHERE PersonAge BETWEEN 13 AND 17
UNION ALL SELECT '18-25', COUNT(*)
FROM dbo.Person
WHERE PersonAge BETWEEN 18 AND 25
UNION ALL SELECT '26 and over', COUNT(*)
FROM dbo.Person
WHERE PersonAge >= 26 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T10:28:08.180

以下应该给出：

```
select count(*), person_age
from (
    select (case 
               when age between 0 and 12 then '12 and under'
               when age between 13 and 17 then '13-17'
               when age between 18 and 25 then '18-15'
               else 'Above 25'
            end) as 'person_age'
    from person)
group by person_age 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T10:03:04.763

在 SQL 中，您不能按列别名进行分组。您需要像这样重复 case 语句。

```
select count(*), 
case  
    when aged between 0 and 12 then '12 and under'
    when aged between 13 and 17 then '13-17'
    when aged between 18 and 25 then '18-15'
    else 'Above 25' end
from person
group by 
case  
    when aged between 0 and 12 then '12 and under'
    when aged between 13 and 17 then '13-17'
    when aged between 18 and 25 then '18-15'
    else 'Above 25'
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T10:37:31.910

```
declare @tempT table(age int)
declare @temp2 table(age2 varchar(15))

insert into @tempT(age) values(1)
insert into @tempT(age) values(2)
insert into @tempT(age) values(3)
insert into @tempT(age) values(4)
insert into @tempT(age) values(5)
insert into @tempT(age) values(6)
insert into @tempT(age) values(7)
insert into @tempT(age) values(8)
insert into @tempT(age) values(9)
insert into @tempT(age) values(10)
insert into @tempT(age) values(11)

insert into @Temp2
select  case  
when age < 3 then '<3'
when age >= 3 and age < 5 then '>= 3 and < 5'
when age >= 5 then '>=5'
end
from @tempT

select count(*), age2 from @Temp2 
GROUP BY age2 
```

# database - orkut 应用程序

> ID：852099
> 
> 赞同：3
> 
> 时间：2009-05-12T10:16:45.967
> 
> 标签：database

我是开发 orkut 应用程序的初学者。任何人都可以告诉我诸如数据库的设计方式之类的基础知识以及所有...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-05-29T00:33:24.250

我建议您先访问[orkut 开发人员论坛](http://groups.google.com/group/opensocial-orkut)，阅读固定主题，然后访问 MAX 建议的文档。:)

原因是文档中有很多过时的信息。在论坛中，信息更新得更多，您可以随时询问社区是否有问题。;)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T10:58:59.847

开发人员的 orkut 文档怎么样？ [http://code.google.com/intl/en-US/apis/orkut/](http://code.google.com/intl/en-US/apis/orkut/)

# scala - 什么是可堆叠修改？

> ID：852101
> 
> 赞同：9
> 
> 时间：2009-05-12T10:18:25.950
> 
> 标签：scala, dynamic, traits

我一直在阅读一本关于 Scala 的书，其中提到了使用*traits进行**可堆叠修改*。什么是*可堆叠的修改*，它们的用途是什么？

 *** * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-14T21:17:57.017

区分可堆叠修改的基本质量（无论如何在 scala 中使用该术语）是“超级”根据特征的混合方式受到动态影响，而通常超级是静态确定的目标。

如果你写

```
abstract class Bar { def bar(x: Int): Int }
class Foo extends Bar { def bar(x: Int) = x } 
```

那么对于 Foo “super” 将永远是 Bar。

如果你写

```
trait Foo1 extends Foo { abstract override def bar(x: Int) = x + super.bar(x) } 
```

然后对于该方法，在创建类之前， super 仍然是未知的。

```
trait Foo2 extends Foo { abstract override def bar(x: Int) = x * super.bar(x) }

scala> (new Foo with Foo2 with Foo1).bar(5)
res0: Int = 30

scala> (new Foo with Foo1 with Foo2).bar(5)
res1: Int = 50 
```

为什么这很有趣？一个说明性示例可能是您想要压缩、加密和数字签名的一些数据。您可能想要压缩然后加密然后签名，或者您可能想要加密然后签名然后压缩等等。如果您以这种方式设计您的组件，您可以实例化一个自定义对象，其中包含您想要以您想要的方式组织的位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T21:25:58.497

我查看了[Real-World Scala 演示文稿](http://www.slideshare.net/jboner/pragmatic-real-world-scala-45-min-presentation)，其中也使用了术语*可堆叠修改。*显然，在覆盖时调用 super 方法的是特性，本质上是添加功能而不是替换它。因此，您可以通过特征来积累功能，并且可以在 Java 中我们经常使用方面的地方使用它。Trait 扮演一个方面的角色，覆盖“有趣”的方法并添加特定的功能，例如日志记录等，然后调用 super 并将球“传球”到链中的下一个 trait。HTH。

# css - Internet Explorer 6 和 7：当浮动元素包含向右浮动的子元素时，它们会扩展为 100% 宽度。有解决方法吗？

> ID：852104
> 
> 赞同：28
> 
> 时间：2009-05-12T10:19:40.563
> 
> 标签：css, internet-explorer, css-float

我有一个父母`div`向左浮动，有两个孩子`div`我需要向右浮动。

父级`div`应该（如果我正确理解规范）尽可能宽以包含子`div`级，这就是它在 Firefox 等人中的行为方式。

在 IE 中，父`div`级扩展为 100% 宽度。这似乎是具有子项向右浮动的浮动元素的问题。测试页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<title>Float test</title>
</head>

<body>
<div style="border-top:solid 10px #0c0;float:left;">
    <div style="border-top:solid 10px #00c;float:right;">Tester 1</div>
    <div style="border-top:solid 10px #c0c;float:right;">Tester 2</div>
</div>
</body>

</html> 
```

不幸的是我不能固定子`div`s的宽度，所以我不能在父节点上设置一个固定的宽度。

是否有仅使用 CSS 的解决方法来使父级`div`与子级一样宽`div`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-05-04T06:21:44.630

这是一个`inline-block`在 IE6 上工作的解决方案，如[http://foohack.com/2007/11/cross-browser-support-for-inline-block-styling/](http://foohack.com/2007/11/cross-browser-support-for-inline-block-styling/)以使元素的行为更像 right-floated `<div>s`：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>

<title>Float with inline-block test</title>

<style type="text/css">
    .container {
        border-top: solid 10px green;
        float: left;
    }

    .tester1,
    .tester2 {
        float: right;
    }

    .tester1 {
        border-top: solid 10px blue;
    }

    .tester2 {
        border-top: solid 10px purple;
    }
</style>

<!--[if lte IE 7]>
<style type="text/css">
    .container {
        text-align: right;
    }

    .tester1,
    .tester2 {
        float: none;
        zoom: 1; display: inline;/* display: inline-block; for block-level elements in IE 7 and 6\. See http://foohack.com/2007/11/cross-browser-support-for-inline-block-styling/ */
    }
</style>
<![endif]-->

</head>

<body>
<div class="container">
    <div class="tester1">Tester 1</div>
    <div class="tester2">Tester 2</div>
</div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T13:46:47.983

我想出了一个使用`text-align: right`and的解决方案`display: inline`。

试试这个：

```
<div style="border-top:solid 10px #0c0; float: left;">
    <div style="margin-top: 10px; text-align: right;">
        <div style="border-top:solid 10px #c0c; display: inline;">Tester 2</div>
        <div style="border-top:solid 10px #00c; display: inline;">Tester 1</div>
    </div>
</div> 
```

请注意，我必须切换标记中“测试器”框的顺序，才能以与您的示例相同的方式显示。我认为在新容器上还有一个margin-top 的替代方案，但我现在没有时间研究。

如果您想为所有其他浏览器提供更简洁的样式，请尝试以下操作：

```
<div style="border-top:solid 10px #0c0; float: left;">
    <div style="float: right;">
        <div style="border-top:solid 10px #c0c; float: left;">Tester 2</div>
        <div style="border-top:solid 10px #00c; float: left;">Tester 1</div>
    </div>
</div> 
```

当您想在这些框周围布置东西时，可能会出现一些不同的问题。但是，我认为这些问题将比这个更容易解决。

希望这对您有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T10:49:02.233

我想不出符合您要求的纯 CSS 解决方案，但如果您想使用 JavaScript 解决方案，也许以下代码可以提供帮助？我没有改变 div 的样式，我只添加了 ID `main`、`sub1`和`sub2`到您的 div 中。

```
var myWidth = document.getElementById('sub1').offsetWidth + document.getElementById('sub2').offsetWidth;
document.getElementById('main').style.width = myWidth; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-02T13:20:53.523

我遇到了同样的问题，并通过使用 position:absolute 和 right:0 定位子元素（我想向右浮动）来解决。我为父元素提供了足够的右填充以为子元素腾出空间……值得一试，可能不适用于所有应用程序！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T11:01:13.493

使用单单元格表而不是外部 div 怎么样？可能需要更多工作才能正确对齐所有内容，但表格不会扩展。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T16:24:31.443

您可以从以下内容开始：

```
<DIV style="BORDER: #0c0 10px solid; FLOAT: left; MARGIN-LEFT: 100%;">
<DIV style="BORDER: #00c 10px solid;FLOAT: right;">
Tester 1
</DIV>
<DIV style="BORDER: #c0c 10px solid;FLOAT: right;">
Tester 2
</DIV>
</DIV> 
```

结果似乎至少在您正在寻找的范围内。显然，您希望根据需要对其进行调整，并且可能添加一些 css 逻辑以仅将其应用于浏览器 < IE 7。

如果这不是您想要的，请尝试使用一些负边距。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T23:19:56.197

首先，你为什么不使用内联样式？

我会用它来用一个单独的 css 文件来定位 IE：

```
<!--[if lt IE 7]>
<link rel="stylesheet" href="ie6.css" type="text/css" />
<![endif]--> 
```

我知道这不是一个直接的问题，但 IE 总是很难处理！我认识的大多数设计师/开发人员都会为 IE 制作一个全新的样式表。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-04T05:11:35.510

一个非常 hacky 但仅适用于 IE、chrome 和 FF 的 CSS 解决方案。

我采用了 kaba 的解决方案 - 但问题是，它在 IE 中运行良好，但所有其他浏览器在 2 个子 div 之间显示 4px 空间。即使两个 div 上的内容都展开，该空间仍保持为 4px。所以为了解决这个问题，我使用了 IE 条件语句。我看起来不像世界上最好的代码，但它完成了工作。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<title>Float test</title>
</head>

<body>
<div style="border-top:solid 10px #0c0; float: left;">

    <div style="border-top:solid 10px #00c; text-align: right;">
        <div style="border-top:solid 10px #c0c; display: inline;">Tester2</div>

        <div style="border-top:solid 10px #00c; display: inline;margin-left:-4px">

        <!--[if gte IE 5]>
        <div style="border-top:solid 10px #00c; display: inline;margin-left:4px">
        <![endif]-->

         Tester1

        <!--[if gte IE 5]>
        </div>
        <![endif]-->

        </div>

    </div>
</div>
</body>
</html> 
```

# c# - C# 2.0 设计问题 - 从更大的列表创建子列表

> ID：852108
> 
> 赞同：2
> 
> 时间：2009-05-12T10:22:25.567
> 
> 标签：c#, design-patterns, list, .net-2.0

我正在为以下内容寻找一个好的设计/算法/模式：

我有一大堆 TODO 任务。他们每个人都有一个估计的持续时间。我想将较大的列表分成较小的子列表，每个子列表最多包含 4 小时的工作。

我目前的算法是这样的：

```
while( index < list.Count )
{
    List<string> subList = CreateSublist( ref index );
    SaveSubList(subList);
} 
```

将索引作为 ref 传入感觉很尴尬，而不是 OOD。我真的像流一样消耗 TODO 列表，所以我想知道是否有类似的事情我可以做，但我有点 C# 新手。我目前也仅限于 C# 2.0。这里有关于一个好的设计的快速指示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T10:30:07.070

您可以用一种方法填充所有内容：

```
List<List<TodoTask>> GetTodoTasks(IEnumerable<TodoTask> tasks, int timeWindow)
{
    List<List<TodoTask>> allTasks = new List<List<TodoTask>>();

    List<TodoTask> tasks = new List<TodoTask>();
    int duration = 0;

    foreach(TodoTask task in tasks)
    {
        if(duration > timeWindow)
        {
            allTasks.Add(tasks);

            duration = 0;
            tasks = new List<TodoTask>();
        }

        tasks.Add(task);
        duration += task.Duration;
    }

    allTasks.Add(tasks);        
    return allTasks;
} 
```

或者，使用迭代器：

```
IEnumerable<List<TodoTask>> GetTodoTasks(IEnumerable<TodoTask> tasks, int timeWindow)
{        
    List<TodoTask> tasks = new List<TodoTask>();
    int duration = 0;

    foreach(TodoTask task in tasks)
    {
        if(duration > timeWindow)
        {
            yield return tasks;

            duration = 0;
            tasks = new List<TodoTask>();
        }

        tasks.Add(task);
        duration += task.Duration;
    }

    yield return tasks;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T11:10:30.997

这是我的解决方案：

```
 class Task
    {
        public string Name { get; set; }
        public int Duration { get; set; }
    }

    class TaskList : List<Task>
    {
        public int Duration { get; set; }

        public void Add(Task task, int duration)
        {
            this.Add(task);
            Duration += duration;
        }
    }

    private static IList<TaskList> SplitTaskList(IList<Task> tasks, int topDuration)
    {
        IList<TaskList> subLists = new List<TaskList>();
        foreach (var task in tasks)
        {
            subLists = DistributeTask(subLists, task, topDuration);
        }
        return subLists;
    }

    private static IList<TaskList> DistributeTask(IList<TaskList> subLists, Task task, int topDuration)
    {
        if (task.Duration > topDuration)
            throw new ArgumentOutOfRangeException("task too long");

        if (subLists.Count == 0)
            subLists.Add(new TaskList());

        foreach (var subList in subLists)
        {
            if (task.Duration + subList.Duration <= topDuration)
            {
                subList.Add(task, task.Duration);
                return subLists;
            }
        }

        TaskList newList = new TaskList();
        newList.Add(task, task.Duration);
        subLists.Add(newList);
        return subLists;
    } 
```

请注意，这不是*最佳*解决方案……这将达到一个全新的水平:)

此外，此解决方案将比[Noldorin](https://stackoverflow.com/questions/852108/c-2-0-design-question-creating-sublists-from-a-larger-list/852145#852145)和[Anton](https://stackoverflow.com/questions/852108/c-2-0-design-question-creating-sublists-from-a-larger-list/852133#852133)解决方案更好地分配项目。您最终可能会得到更少的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T10:43:50.587

我建议将其封装到一个类中。

```
SubListBuilder<WorkItem> slb = new SubListBuilder<WorkItem>(
    workItems, sublist => sublist.Sum(item => item.Duration) <= 4); 
```

这很好地允许提供一个谓词来控制子列表的构建方式。然后你就可以得到你的结果。

```
while (slb.HasMoreSubLists)
{
    SaveList(slb.GetNextSubList());
} 
```

或者也许这样。

```
foreach (var subList in slb.GetSubLists())
{
    SaveList(subList);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T10:35:46.763

这应该做的工作：

```
public static List<List<Task>> SplitTaskList(List<Task> tasks)
{
    List<List<Task>> subLists = new List<List<Task>>();
    List<Task> curList = new List<Task>();
    int curDuration; // Measured in hours.

    foreach (var item in tasks)
    {
        curDuration += item.Duration;
        if (curDuration > 4)
        {
            subLists.Add(curList);
            curList = new List<Task>();
            curDuration = 0;
        }

        curList.Add(item);
    }

    subLists.Add(curList);

    return subLists;
} 
```

LINQ 可能会简化一些事情，但由于您使用的是 C# 2.0（我想也可能是 .NET 2.0），这似乎是最直接的解决方案。

# sql-server - UNC 路径和 Windows 身份验证的批量插入错误

> ID：852117
> 
> 赞同：3
> 
> 时间：2009-05-12T10:24:08.047
> 
> 标签：sql-server, sql-server-2005, authentication

我有两台服务器，一台是具有 Web 服务的应用程序服务器，另一台是数据库服务器，它具有 SQL Server 2005 DB。Webservice 是一个 vb.net 应用程序，所有输入文件都将在应用程序服务器上。当我的应用程序调用（通过 web 服务）数据库服务器使用 Windows 身份验证（集成安全性）使用 UNC 路径（应用程序服务器）执行 BULK insert 语句时，它会失败并出现错误 -

System.Data.SqlClient.SqlException：无法批量加载，因为无法打开文件“\Servername\Foldername\file1.txt”。**操作系统错误代码 5（未找到错误）。** 在 System.Data.SqlClient.SqlConnection.OnError（SqlException 异常，Boolean breakConnection） 在 System.Data.SqlClient.SqlInternalConnection.OnError（SqlException 异常，Boolean breakConnection）

我在两个服务器上都是管理员，并且 web 服务正在我的用户凭据上运行，我也是 SQL DB 上的 SA。SQL 服务器正在本地系统帐户上运行。我将其更改为在我的用户帐户上运行，但没有运气！但是，当我在连接字符串中使用 SQL 身份验证时，相同的语句有效。

任何人都可以对这个问题有所了解。

提前致谢

赛

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T03:18:23.440

您的客户端通过 SQL Server 进行身份验证，然后 SQL Server 模拟客户端并尝试访问 UNC 路径。那是委托，并且是隐含禁止的。您必须采取明确的步骤来为 SQL Server 服务帐户启用约束委派。请参阅本文解释详细信息：http: [//msdn.microsoft.com/en-us/library/ms998355.aspx](http://msdn.microsoft.com/en-us/library/ms998355.aspx) 该文章显示了访问后端数据库的 ASP 服务的约束委派，但在您的情况下，它将是中间的 SQL Server 访问后端 UNC 共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T15:31:40.663

一些故障排除的想法，以随机顺序排列：

当您从 Sql Server Management Studio 运行批量插入时，它是否有效？

更改运行 MSSQLSERVER 服务的帐户应该会有所帮助，但是您是否在更改凭据后重新启动了 Sql Server？

创建一个在与 Sql Server 相同的用户下运行的命令 shell：

```
runas /noprofile /user:domain\username cmd 
```

然后查看是否允许您读取网络共享：

```
net use \\machine\share 
```

# ruby-on-rails - 使用 Capistrano 从 Git 部署而无需硬重置？

> ID：852118
> 
> 赞同：2
> 
> 时间：2009-05-12T10:24:12.647
> 
> 标签：ruby-on-rails, git, capistrano

目前，我们在允许用户上传文件的站点（browsercms）中运行 CMS 时遇到问题。但是，每次我进行部署 Capistrano 都会运行硬重置，从而破坏所有上传的文件。

有没有人对如何防止硬重置有任何建议，只需进行拉动，或者将上传的文件移动到其他地方，而无需更改应用程序代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T10:37:06.840

这不太符合您“无需更改应用程序代码”的标准。

但是，在遇到类似问题后，我将上传的图像从目录转移`/public/images`到`/public/system/images`了`/public/system`每个 capistrano 部署都没有“版本化”的目录，因此图像仍然存在。

可能是导致问题的capistrano“版本控制” *（而不是git reset）*？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-20T22:31:38.317

这可能不是正确的方法。

您应该在 .gitignore 中包含“图像”文件夹，并将 $current_release/images 文件夹符号链接到 $shared/images。

如果您放入 deploy.rb，这可能会在每次部署时自动完成：

```
task :link_imgs do     
  run "ln -s #{shared_path}/photos #{release_path}/photos" 
end    

after "deploy:update_code", :link_imgs 
```

我对我的 CMS 做了同样的事情，它就像一个魅力

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T10:46:01.630

*上限部署*调用*部署：更新*和*部署：重新启动*

*deploy:update*进行版本控制，复制内容

*deploy:restart*进行真正的重启，在您方便时重载它，通常在您的**config/deploy.rb**文件中

```
namespace :deploy do
    desc "Softly restart the server"
    task :restart, :roles => :app, :except => { :no_release => true } do
      my_own.restart_recipe
    end  
end 
```

# sharepoint - 从自定义 ASP.NET 应用程序迁移到 Sharepoint Services

> ID：852119
> 
> 赞同：3
> 
> 时间：2009-05-12T10:24:57.983
> 
> 标签：sharepoint, wss

我们公司有一个用于客户信息数据库的 ASP.NET 应用程序。该应用程序开始时很小，但在没有适当设计的情况下不断增长。现在应该开发一个新版本的应用程序，这基本上意味着从头开始设计和实现它。该公司有兴趣在未来使用 Microsoft Sharepoint Services，并建议在此客户数据库应用程序中进行试点。

所以我的问题是：

数据库驱动的应用程序是否适合 WSS？大多数情况下，该应用程序将对数据库执行 CRUD 操作并创建报告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T15:22:02.443

简短的回答：没有。

长答案：有合作吗？数据的支持文档？工作流程？如果不是，那么确实没有任何理由通过 SharePoint 托管它 - 您不会获得太多收益。

此外，请记住，SharePoint 列表可能*看起来*像表格，但它们不是 -列表**没有**关系方面 - 没有加入、没有级联更新/删除等。如果数据报告是您的应用程序的很大一部分。

您可以在外部存储数据并将其显示为 SharePoint 中的只读列表，但如果您不使用任何其他 SharePoint 功能，您仍然会遇到很多麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T15:26:17.833

我同意 Greg 的观点，因为我不一定建议将您的数据放在 SharePoint 列表中（这可能是 Greg 的假设）。但我的简短回答是“也许”。

这是长答案...

SharePoint 在 ASP.NET 上运行，因此它应该可以满足您的需求。您可能正在编写位于 SharePoint 中以访问您的数据库的 ASP.NET 网页，或者编写位于 SharePoint 中以访问您的数据库的 Web 部件。

您可以考虑使用 BDC 读取/检索数据，但这需要 MOSS Enterprise 并且不会提供 CRUD 的 CUD 部分。CorasWorks DIT 等其他工具可能会有所帮助，但我怀疑自定义 Web 部件或页面是适合您的方式。

您可以从 SharePoint 获得很多好处，例如授权，也许还可以将您的数据与 SharePoint 列表数据集成、配置、搜索等。这实际上取决于您的应用程序的性质，即 SharePoint 是否会提供很多益处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T15:35:33.700

柯克打我一拳，说得比我要好:)

要考虑的另一件事是您的流程中工作流程的可能性。例如，如果您需要在添加新联系人时启动流程（后续电话等），那么 SharePoint 提供了很多好处或好处。

也许混合解决方案是合适的。用于 CRUD 和 SharePoint 集成的自定义应用程序，用于有意义并提供价值的部分。

为了使用 SP 而构建 SP 可能不是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T15:48:20.763

我们有一个在 MOSS 2007 中运行的 ASP.NET 应用程序。虽然我们几乎不使用 SharePoint 的任何功能，但我们确实获得了 SharePoint 的安全模型、导航 Web 部件（我们使用 CorasWorks）、集成报告服务和工作流的优势。至少，SharePoint 功能总有一天会供我们使用。

我们所有的应用程序数据都在它自己的 SQL Server 数据库中。我们不在 SharePoint 内容数据库中存储任何内容。

# ruby - ruby 中有一个好的 DNS 服务器库吗？

> ID：852123
> 
> 赞同：2
> 
> 时间：2009-05-12T10:26:09.557
> 
> 标签：ruby, dns

我想在 ruby​​ 中创建一个测试 DNS 服务器，但找不到任何合适的东西。我找到了 pnet-dns（[http://rubyforge.org/projects/pnet-dns/](http://rubyforge.org/projects/pnet-dns/)）。这个项目是不完整的和错误的。有没有其他选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-04-12T00:45:58.687

[RubyDNS](http://www.oriontransfer.co.nz/software/ruby-dns/index "RubyDNS")是您正在寻找的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T14:02:14.907

与语言无关的替代方法是使用[PowerDNS](http://wiki.powerdns.com/trac) [管道后端](http://doc.powerdns.com/pipebackend-dynamic-resolution.html)。因为它通过一个简单的管道与名称服务器通信，所以它可以用任何语言编写，包括 Ruby。（[文档中的简单示例](http://doc.powerdns.com/backends-detail.html#PIPEBACKEND)使用 Perl，但应该很容易翻译。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-21T19:37:45.560

使用赛璐珞在 ruby​​ 中检查另一种 DNS 服务器方法：[https ://github.com/celluloid/celluloid-dns](https://github.com/celluloid/celluloid-dns)

原件`celluloid-dns`非常不完整（v0.0.1）。最近，RubyDNS 被复制到`celluloid-dns`（我正在这样做）。`celluloid-dns`由于所有核心功能将从 RubyDNS移至`celluloid-dns`.

如果您想要现在可以使用的东西，请使用 RubyDNS。但是，将来，如果您只想要低级 API，请使用`celluloid-dns`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T07:26:18.187

你看过[Dnsruby](https://rubygems.org/gems/dnsruby)吗？

它旨在完全符合 RFC，尽管它主要关注客户端。但是，可以编写自己的服务器 - 用于`Dnsruby::Message#decode`解码传入的数据包，以及保存测试记录的 RRSet 区域。然后，您可以对数据包进行编码以发送回客户端。

# c# - 具有动态加载程序集的灵活报告系统

> ID：852129
> 
> 赞同：0
> 
> 时间：2009-05-12T10:28:27.383
> 
> 标签：c#, dll, reporting, add-in

我想为我的应用程序构建一个灵活的报告系统。到目前为止，我脑子里只有一个概念，需要一些实施技巧。我正在使用 Crystal Reports 来呈现报表，并且我知道如何动态加载报表。

现在，想法是每个报告都将被打包为一个单独的程序集 (.dll)。报告框架将加载每个自定义报告并通过明确定义的接口与其通信，如下所示：

```
public interface IReport
{
    string GetTitle();
    string GetDescription();
    void SetParameter();
    void Print();
}
```

此外，还会有一些基础实现（作为抽象类）来处理报表上的一些常见操作（如绑定到数据源等）：

```
public abstract class Report
{
    ...
} 
```

在每个 dll 中都会有一个具体类的实现，代表这个或那个报告：

```
public class CustomersReport : Report
{
    ...
} 
```

现在，我必须弄清楚以下几点：

1）如何动态定位和加载dll？

2）如何创建具体类（CustomerReport）的实例并将其转换为 IReport 以便对其调用必要的方法？

你有没有实现过这样一个可扩展的系统？您能否分享您的专业知识/代码片段？

提前致谢。

编辑：

在调查这个问题时，我发现 Jon Skeet 的关于[Plug-ins and Cast Exceptions](http://www.yoda.arachsys.com/csharp/plugin.html)的文章可能会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T11:03:58.497

看看[Mono.Addins](http://www.mono-project.com/Introduction_to_Mono.Addins)（它是 MIT 许可证，因此可以使用封闭软件）。根据您的描述，它可以满足您的需求。基本上它使用基于接口的依赖树+插件。它有自己的加载 .dll-s 管理器，它的对象基于加载的接口，所以你不需要任何魔法转换来调用任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:05:53.480

看到这个： [将 dll 动态加载到我的程序中的问题](https://stackoverflow.com/questions/835551/problem-with-dynamic-loading-of-a-dll-into-my-program) 正在做你想要的，而没有围绕它的所有 YAGNI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T10:37:48.880

你可以考虑微软的[MEF](http://www.codeplex.com/MEF)。它是一个组合引擎，可以设置为监视本地文件夹并自动加载导出您感兴趣的部件的程序集（在您的情况下是 IReport 的实现）。我们确实有一个类似的系统，我们之前实施过。我们有一个带有报告的程序集，我们将其加载到单独的应用程序域中，并在文件版本发生更改时重新加载。然后我们使用 .NET 远程处理在应用程序域之间进行通信。我们曾考虑使用 Microsoft 的插件框架，但我们发现它非常复杂且令人印象深刻，并认为它在我们的案例中过于繁重和复杂。

# java - 构建仅支持 Java 的自定义 BSD 版本

> ID：852131
> 
> 赞同：0
> 
> 时间：2009-05-12T10:29:10.987
> 
> 标签：java, freebsd, kernel, bsd

我应该使用什么过程来实现构建能够运行 Java VM 但不具备任何其他功能的 FreeBSD 版本的目标，包括但不限于：

1.  运行除 Java VM 之外的任何进程
2.  禁用任何/所有外壳访问
3.  Java VM 退出时，操作系统关闭

我需要支持 JDK 1.6，因此 SANOS 等方法不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T10:38:02.580

1.  配置 init 脚本以在用户认证后运行 JVM。
2.  删除生成 shell 的 init 脚本之一中的行，通常在用户身份验证之后。
3.  应该有一个 Java 进程的监听器，如果它没有找到，则触发“init 0”或“shutdown”或“poweroff”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T10:59:14.790

Sanos 操作系统内核就是一个这样做的项目，只是它使用 Windows JVM 而不是 FreeBSD JVM。Sanos 只提供 JVM 所需的功能，没有别的。

[http://www.jbox.dk/sanos/](http://www.jbox.dk/sanos/)

# c# - 如何在 C# 中编写普通的波浪号（~）？

> ID：852135
> 
> 赞同：0
> 
> 时间：2009-05-12T10:30:49.563
> 
> 标签：c#, text

如果我在标签的文本属性中添加波浪号（“~”），标签不会显示它，而是显示一个上波浪号。

如何在括号（“〜”）中写一个正常的波浪号？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T10:35:29.853

不是字体问题吗？将字体设置为`Courier New`并测试...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T11:45:35.113

如果您不想要固定宽度的字体，请尝试使用 Unicode U223C ~ TILDE OPERATOR 而不是 U007E ~ TILDE

# java - 设计 XACML API

> ID：852140
> 
> 赞同：3
> 
> 时间：2009-05-12T10:33:54.287
> 
> 标签：java, identity, saml, cardspace, xacml

目前，XACML 规范为请求/响应定义了一个协议，但对于如何将其集成到企业应用程序中则留待解释。我相信除非创建一个新的开源项目，尝试围绕一组通用 API 进行开发/标准化，否则 XACML 的价值将无法实现。

对于那些熟悉 XACML 的人，我很想了解他们对创建这样一个项目的第一反应，他们是否愿意做出贡献以及他们认为 XACML API 会是什么样子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-02-06T18:15:44.517

也许我不明白这个问题，但 XACML 的 SAML 配置文件不符合您的要求吗？它为 authzDecisionQuery 和响应记录定义了 SOAP 格式，这应该是 WSDL 所需的全部内容。

我围绕 Sun 的 DOD/DISA 解释器（在 forge.mil 上）构建了其中一个，并围绕一个完全编译的实现构建了一个更快的版本（尚未发布），该实现直接将 XACML 转换为 Java 代码。主要目标是可读性，而不是速度，而是大约快十倍。

IMO XACML 有效，但作为一种供人们查看的语言绝对是糟糕的。我更感兴趣的是找到一种特定于问题的语言来表达 XACML 的语义，以便人们能够理解它们。Java 在这一点上击败了 XACML，但 Java 作为一种特定领域的语言相当笨拙。也许是 Groovy？

PS：作为我们的第一次尝试，我们尝试了 Attempto Controlled English (ACE)。当我们发现 ACE 无法表达深度嵌套的条件（没有括号或大括号）时，我们很快放弃了这个想法。尽管 NSA 对基于英语的政策语言非常感兴趣，但我不确定英语是否是正确的想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-23T20:12:22.327

Sun 的 XACML 实现不是为您提供了可靠的 API 吗？

[http://sunxacml.sourceforge.net/](http://sunxacml.sourceforge.net/)

（开发已重回正轨，网站应该很快更新。请查看 sunxacml-devl 邮件列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-25T17:39:18.810

XACML 和 WS-XACML 规范的 SAML 配置文件试图标准化 XACML PEP 和 PDP 之间的通信。WSO2 Identity Server 是一个开源项目，将在明年初添加此支持。

谢谢...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-06T13:11:16.167

sunxacml 没有得到积极维护。页面/实现的最后一次更新是从 2006 年开始的。

一个积极维护的开源 XACML 实现是 HERAS-AF XACML Core。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-04T16:21:31.437

不幸的是，WS-XACML 早就死了。XACML 的 SAML 配置文件是当今唯一的标准化方法，但这更多的是关于通信而不是 API 的易用性。

在 Axiomatics，我们确实开发了一个简单的 SDK，但它仍然是我们相当特定于供应商的。

我知道甲骨文和 Nextlabs 推动了一项名为 OpenAZ 的强大计划。他们的目标是为 PEP 定义更简单的 API。这可能是您想要查看的内容。

链接：

*   Axiomatics 简单 SDK 演示：[http ://www.youtube.com/watch?v=Z_2M775uFxo](http://www.youtube.com/watch?v=Z_2M775uFxo)
*   OpenAZ：[http ://openliberty.org/wiki/index.php/OpenAz_Main_Page](http://openliberty.org/wiki/index.php/OpenAz_Main_Page)

詹姆斯，我会认真研究 OpenAZ。每周四有一个电话会议，欢迎您参加。

# vb.net - 在 VB.NET 中将字符串解析为枚举值

> ID：852141
> 
> 赞同：78
> 
> 时间：2009-05-12T10:34:17.500
> 
> 标签：vb.net, enums

如何将 VB.NET 中的字符串解析为枚举值？

示例我有这个枚举：

```
Public Enum Gender
    NotDefined
    Male
    Female
End Enum 
```

如何将字符串“Male”转换为`Gender`枚举`Male`值？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2009-05-12T10:39:19.503

```
Dim val = DirectCast([Enum].Parse(GetType(Gender), "Male"), Gender) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-12T10:36:46.903

请参阅[Enum.TryParse](http://msdn.microsoft.com/en-us/library/system.enum.aspx)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-18T07:33:35.717

> 如何将字符串“Male”转换为 Gender 枚举的 Male 值？

接受的解决方案返回一个 Enum 对象。要返回您想要此解决方案的值：

```
dim MyGender as string = "Male"
dim Value as integer
Value = DirectCast([Enum].Parse(GetType(Gender), MyGender), Integer) 
```

也可以这样做：

```
value = cInt([enum].Parse(GetType(Gender), MyGender)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-20T19:16:22.850

如果您希望解析不区分大小写，可以使用以下命令：

```
[Enum].Parse(Gender, DirectCast(MyGender, String), True) 
```

这将处理`dim MyGender as string = "Male"`或`dim MyGender as string = "male"`

# wcf - 有没有办法扩展 WSHttpBinding 以允许 SwA？

> ID：852142
> 
> 赞同：0
> 
> 时间：2009-05-12T10:34:30.103
> 
> 标签：wcf, customization, wshttpbinding

使用 WCF，我可以创建自己的绑定（基于 WSHttpBinding）并使用它来处理 HTTP 请求，以便可以向其添加标准 MIME 附件（SwA）吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T00:58:49.243

不，据我所知没有。你为什么不使用[MTOM](http://en.wikipedia.org/wiki/MTOM)？

# asp.net - 如何使用 ASP.NET Membership 检索 QuestionAnswer

> ID：852155
> 
> 赞同：0
> 
> 时间：2009-05-12T10:38:06.383
> 
> 标签：asp.net, asp.net-membership

我想知道我是否可以像获取 UserName 和 PasswordQuestion 一样从 ASP.NET 成员资格中获取 QuestionAnswer 字段。

```
MembershipUser mu = Membership.GetUser(userId);
string username = mu.UserName;
string question = mu.PasswordQuestion; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T14:38:32.057

我很确定 QuestionAnswer 在数据库中的散列方式与密码相同。如果是这种情况，那么您将无法获得任何人类可读格式的 QuestionAnswer（尽管如果您需要这种格式的 QuestionAnswer，您始终可以对表运行常规 SQL 查询，而不是使用 Membership API）。

如果需要，您可以随时[更改密码问题和答案](http://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.changepasswordquestionandanswer.aspx)

希望这可以帮助。

# tcl - 在 TCL 中，如何让一个变量使用另一个变量的值

> ID：852157
> 
> 赞同：3
> 
> 时间：2009-05-12T10:39:30.767
> 
> 标签：tcl

我需要在另一个变量中使用一个变量的值。

这是我试过的..

```
set cmd_ts "foo bar"
set confCmds {
    command1
    command2
    $cmd_ts
}
puts "confCmds = $confCmds" 
```

但不是得到

```
confCmds = 
    command1
    command2
    foo bar 
```

我正进入（状态：

```
confCmds =
    command1
    command2
    $cmd_ts 
```

PS我尝试了以下无济于事

1.  $cmd_ts
2.  “$cmd_ts”
3.  {$cmd_ts}
4.  \$cmd_ts

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T10:49:06.493

（几乎）只要你使用花括号，什么都不会起作用。最好的建议是使用 list 命令：

```
set confCmds [list command1 command2 $cmd_ts] 
```

我说（几乎）是因为您可以使用 subst 在 confCmds 上进行变量替换，但这并不是您真正想要的，而且充满了危险。你想要的是一个单词列表，其中一个或多个可以由变量定义。这正是上述解决方案为您提供的。

如果需要，可以使用反斜杠将命令分布在多行上：

```
set confCmds [list \
    command1 \
    command2 \
    $cmd_ts \
] 
```

此解决方案假定您想要的是一个 tcl 列表。这可能是也可能不是您想要的，这完全取决于您如何在下游处理这些数据。

在评论中你写道你真正想要的是一串换行符分隔的项目，在这种情况下你可以只使用双引号，例如：

```
set confCmds "
    command1
    command2
    $cmd_ts
" 
```

这将为您提供一个字符串，其中包含由换行符分隔的多行。尝试将其视为命令列表时要小心（即：不要执行'foreach foo $confCmds'），因为它可能会失败，具体取决于$cmd_ts 中的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T15:43:51.893

布莱恩的回答很好，除了我无法用我的代表修复的错字。（第一个命令中的列表应以方括号结尾）。

如果您想对命令做任何有用的事情，您可能希望将它们作为一个列表，但如果您只想将它​​们用新行分隔，请在最后执行以下操作：

```
set confCmds [join $confCmds "\n"] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T17:13:04.947

如果您必须按照自己的方式定义列表，您还可以使用 subst 命令，该命令将执行大括号阻止的替换：

```
subst $confCmds 
```

# exception - Compact Framework 非文化特定异常消息

> ID：852161
> 
> 赞同：2
> 
> 时间：2009-05-12T10:43:10.963
> 
> 标签：exception, windows-mobile, compact-framework

我在 Compact Framework 2.0 中创建了一个应用程序

这个应用程序正在许多不同的国家和文化中使用。

我的问题是记录了所有异常，但它们出现在设备的文化中，在某些情况下，这意味着我无法阅读它们。

任何帮助或建议将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T11:06:04.857

有关详细信息，请参阅此[链接](http://blogs.msdn.com/netcfteam/archive/2004/08/06/210232.aspx)。

包含错误字符串的 System.SR.dll 程序集在 .NET CF 可再发行组件中不存在，因此您可能正在记录一条消息，指出找不到资源程序集（在许多不同的语言中）。您可以在用户手机中安装英文程序集，但不建议这样做。您需要找到不同的调试方法，而不是依赖用户手机中的异常消息。

# c++ - 静态内存中的动态结构？

> ID：852162
> 
> 赞同：2
> 
> 时间：2009-05-12T10:43:43.443
> 
> 标签：c++, c, memory-management

假设您已经分配了一块您想要使用的固定内存区域，哪些 C 或 C++ 库将允许您在该内存中存储动态结构（例如散列）？

即哈希库不能包含任何对 malloc 或 new 的调用，但必须接受一个参数，告诉它允许使用的内存的位置和大小。

（如果库在内部使用偏移量而不是指针，则奖励，以防共享内存在每个使用它的进程中映射到不同的地址空间）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T11:01:18.813

您可以为 STL 容器编写自己的自定义分配器。

[Dr.Dobb's：分配器有什么用？](http://www.ddj.com/cpp/184403759)

[SO：自定义 C++ STL 分配器的令人信服的例子？](https://stackoverflow.com/questions/826569/compelling-examples-of-custom-c-stl-allocators)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T11:40:17.920

调整一个简单的线性探测哈希表以使用一块内存是微不足道的 - 只需在创建它时将其表设置为指向分配的内存，并且不实施任何分配更多内存以让表增长的东西.

# java - appengine - java 持久化

> ID：852163
> 
> 赞同：1
> 
> 时间：2009-05-12T10:43:44.287
> 
> 标签：java, google-app-engine, persistent

我有 3 个有关系的班级：

*   成员 1-n 跟踪器
*   链接 1-n 跟踪器

拥有一对多的双向关系

```
@PersistenceCapable(identityType = IdentityType.APPLICATION)
public class Member {
        @PrimaryKey
        @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
        private Key key;

        @Persistent(mappedBy = "member")
        private List<Tracker> trackers;

}

@PersistenceCapable(identityType = IdentityType.APPLICATION)
public class Link {
        @PrimaryKey
        @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
        private Key key;

        @Persistent(mappedBy = "link")
        private List<Tracker> trackers;

}

@PersistenceCapable(identityType = IdentityType.APPLICATION)
public class Tracker {
        @PrimaryKey
        @Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
        private Key key;

        @Persistent
        private Member member;

        @Persistent
        private Link link;

} 
```

我创建了一个新的跟踪器：

```
member = new Member();
member.name = "blah";

link = new Link();
link.url = "http://blahblah.blah";

tracker = new Tracker();
tracker.setMember(member);
tracker.setLink(link);

pm.makePersistent(tracker);//error 
```

它抛出

```
The class "The class "zodpob.model.Tracker" is not persistable. This
means that it either hasnt been enhanced, or that the enhanced version
of the file is not in the CLASSPATH (or is hidden by an unenhanced
version), or the Meta-Data/annotations for the class are not found."
is not persistable. This means that it either hasnt been enhanced, or
that the enhanced version of the file is not in the CLASSPATH (or is
hidden by an unenhanced version), or the Meta-Data for the class is
not found. 
```

“增强”是什么意思？

如果我坚持一个没有关系的班级，那就很好了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-08T06:32:22.233

Make sure you're using the DataNucleus plugin....

Here is their site...

[link text](http://www.datanucleus.com/)

...here is how to install it on to the Eclipse IDE...

[link text](http://www.datanucleus.org/products/accessplatform/guides/eclipse/index.html)

...and here is a tut for using it with JDO....

[link text](http://www.datanucleus.org/products/accessplatform/guides/jdo/tutorial.html)

I hope that helps and good luck.

# c# - 使用 MAPI 从 Exchange 服务器检索邮件

> ID：852165
> 
> 赞同：2
> 
> 时间：2009-05-12T10:44:40.273
> 
> 标签：c#, mapi

我正在为 Exchange Server Mail Archiver 做后台工作。我打算用 C# 来做。谁能给一些想法如何开始。我能否获得一个示例应用程序来说明如何使用 MAPI 从 Exchange 服务器读取邮件。由于 MAPI 是一个 Cpp dll，我可以得到一个 C# 包装器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T15:02:05.567

如果您真的需要使用扩展 MAPI 路线（就像我们在以前的工作中必须做的那样），我会首先建议您使用纯 C++ 进行此操作，并根据您的需要做您自己的自定义包装器。您不想在托管代码中直接与 MAPI 交互

我还建议阅读[http://blogs.msdn.com/stephen_griffin/](http://blogs.msdn.com/stephen_griffin/) 他基本上是 MS 的 MAPI 大师。

如果你去那里祝你好运

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-24T23:12:19.317

我意识到你已经发布了几个月了，但是为了后代 - 试试这个： [救赎](http://www.dimastr.com/redemption/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T14:47:29.480

不支持从托管代码使用 MAPI，应避免使用。如果您从头开始，我会考虑 EWS（Exchange Web 服务）并设计您的产品以支持 Exchange 2007 和 Exchange 2010。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T14:56:43.610

您真的不想使用 MAPI C# 包装器。在测试中没问题，但由于 .NET 和 MAPI dll 偶尔会管理自己的内存（读取 300 个用户，每小时多次），它们会覆盖彼此的内存池。

最后，我们最终编写了一个 VB6 应用程序，该应用程序接受了我们想要发送的文件参数，然后用 c# 编写了一个文件并调用了 vb6 应用程序。这是有效的，因为它们是独立的进程，因此不会覆盖彼此的内存池。

我对你的建议是不要走 mapi 路线（除非你喜欢痛苦），如果可能的话使用 EWS（由于公司不想升级，我们不能这样做）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-30T12:15:54.460

使用 C# 包装器几乎是不可能的，这是正确的，但是在 C++.NET 中编写包装器是非常可行的。我们在 C++.NET 中编写了自己的 MAPI 包装器，并从 C# 中使用。它工作得很好

托马斯，ComArchive

# c# - C#：反序列化 XML 文件错误（认为这是一个命名空间问题 - 虽然我无法解决它）

> ID：852171
> 
> 赞同：11
> 
> 时间：2009-05-12T10:48:25.853
> 
> 标签：c#, xml, web-services, xml-serialization

我正在反序列化来自我们一个客户的 Web 服务的 XML 文件。

问题是，在使用 xsd.exe 创建类后，我反序列化文件并得到通常的“XML 文档 (2, 2) 中存在错误”。视觉工作室错误。我认为这是第 2 行，它指向命名空间声明：

**XML 文件的顶部：**

```
<?xml version="1.0" encoding="UTF-8"?>
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"     xmlns:xsd="http://www.w3.org/1999/XMLSchema" xmlns:xsi="http://www.w3.org/1999/XMLSchema-instance">
 <soapenv:Body><MXWorkorderOutResp language="EN" xmlns="http://www.mro.com/mx/integration" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Header event="0" operation="Response" rsCount="8" rsStart="0" rsTotal="8">
    <SenderID build="127" dbbuild="V600-467" majorversion="6" minorversion="1" type="MAXIMO">MX</SenderID>
    <CreationDateTime>2009-05-11T09:48:51+01:00</CreationDateTime>
    <RecipientID>SUPPLIER</RecipientID>
    <MessageID>12420317323327108</MessageID>
  </Header>
  <Content>
    <MXWORKORDER>
      <WORKORDER> 
```

**一流的：**

```
[System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.42")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(AnonymousType=true, Namespace="http://www.mro.com/mx/integration")]
[System.Xml.Serialization.XmlRootAttribute(Namespace="http://www.mro.com/mx/integration", IsNullable=false)]

public partial class MXWorkorderOutResp {

private MXWorkorderOutRespHeader[] headerField;

private MXWorkorderOutRespContentMXWORKORDERWORKORDER[][][] contentField;

private string languageField;

/// <remarks/>
[System.Xml.Serialization.XmlElementAttribute("Header")]
public MXWorkorderOutRespHeader[] Header {
    get {
        return this.headerField;
    }
    set {
        this.headerField = value;
    }
}

/// <remarks/>
[System.Xml.Serialization.XmlArrayItemAttribute("MXWORKORDER", typeof(MXWorkorderOutRespContentMXWORKORDERWORKORDER[]), IsNullable=false)]
[System.Xml.Serialization.XmlArrayItemAttribute("WORKORDER", typeof(MXWorkorderOutRespContentMXWORKORDERWORKORDER), IsNullable=false, NestingLevel=1)]
public MXWorkorderOutRespContentMXWORKORDERWORKORDER[][][] Content { 
```

我认为有一个错误：

```
[System.Xml.Serialization.XmlTypeAttribute(AnonymousType=true, Namespace="http://www.mro.com/mx/integration")]
[System.Xml.Serialization.XmlRootAttribute(Namespace="http://www.mro.com/mx/integration", IsNullable=false)] 
```

XML 的一部分，但我不知道将其更改为什么 - 或者 VS 想要什么。

任何帮助感谢大家，我对这一切还是很陌生，我的老板一直在让我喘不过气来让这个工作:(

**编辑：**有一个内部异常是的！对不起大家！

```
{"<Envelope xmlns='http://schemas.xmlsoap.org/soap/envelope/'> was not expected."} 
```

那么如何将这个命名空间声明添加到类中呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-12T10:59:51.373

肥皂信封不是序列化对象的一部分。它是 SOAP 传输协议的一部分。您需要从信封中移除您的对象，而不是让您的对象处理信封。

而不是获取整个 xml 文件（由于某种原因，包括肥皂信封），您需要获取 soap:body 中的第一个子文件并使用 THAT 反序列化到您的对象中。

看看这个SO帖子......

[使用 C# 和 XDocument/XElement 解析 Soap 响应](https://stackoverflow.com/questions/779976/using-c-and-xdocument-xelement-to-parse-a-soap-response)

...解决文件解析问题。

# windows-server-2008 - 关于运行我自己的专用服务器（使用 Windows 2008）我需要了解什么

> ID：852179
> 
> 赞同：1
> 
> 时间：2009-05-12T10:50:41.387
> 
> 标签：windows-server-2008

我正在考虑使用以下统计信息获得自己的专用服务器：

> 处理器：Celeron 440 2.0 GHz
> 内存：1 GB
> 主硬盘：160 GB SATA II

这将运行 Windows。我有一些使用本地 IIS 和使用服务器的经验，但我从未设置过（至少是 Windows 的），也从未处理过 DNS/备份/安全问题。

我的问题有两个部分：

1.  这台服务器能否毫无问题地运行 Windows 2008、SQL Server 和可能的 Exchange。我担心处理器和内存。

2.  是否有任何指南/教程讨论如何从头到尾管理 Windows 服务器。（我正在寻找类似于 slicehost 的基于 *nix 的服务器的常见问题解答）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T11:32:26.030

您将遇到 RAM 问题。请参阅 MS 文档和最低要求（SQL Server 和 Exchange）。另请注意，新版本的 Exchange 只能在 64 位系统上运行。

如果您打算使用您描述的配置，我个人建议安装 W2K8 的 CORE 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T11:50:54.143

您说“我从未处理过 DNS/备份/安全问题。”

我建议你，这些是最重要的问题。您需要保持安全，应用安全补丁，确保防火墙配置正确等。

在被黑客入侵的网站之后被调用，我可以告诉你它并不漂亮。在 Internet 上建立此服务器之前，尽你所能学习。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T10:54:58.587

这取决于用户负载。如果您每月有大约 1000 个独立用户，这意味着您每天可能会有 30 个用户 - 大约每小时 1 个。我认为您个人会在这台计算机上使用更多的 CPU。所以它真的取决于用户负载。
如果我是你，我会添加更多 RAM 以达到 4 GB 左右。RAM 是可用的最便宜的升级。

# scripting - Vista语音识别引擎是否有像自然说话这样的脚本？

> ID：852180
> 
> 赞同：2
> 
> 时间：2009-05-12T10:50:59.623
> 
> 标签：scripting, windows-vista, naturallyspeaking

我想在用户（使用 Vista 语音识别时）说“Wingbats 太疯狂了！”时执行一个动作。我该怎么做呢？是否有脚本或有 dll 可以绑定？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T10:53:31.523

您可能需要查看[Microsoft Speech API](http://msdn.microsoft.com/en-us/library/ms723627(VS.85).aspx) (SAPI)。我不久前在 Windows XP 中使用过它，它支持 XML 标记，用于声明您希望系统识别的命令。然后，您的应用程序确定在识别语音命令时需要发生什么。

对于语音识别，请查看[ISpRecoContext](http://msdn.microsoft.com/en-us/library/ms718476(VS.85).aspx)接口。

以前这是一个 COM 接口，但从 Vista 开始，您可以使用 .NET。或者如果这是您的偏好，显然您可以使用[Python ！](http://surguy.net/articles/speechrecognition.xml)

## 编辑

Microsoft Speech Server 2007[支持 VoiceXML](http://www.microsoft.com/presspass/press/2006/apr06/04-05MSS07BetaPR.mspx)，在对此问题的另一个回复中提到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-07T20:18:34.860

我会推荐[WSR 宏](http://www.microsoft.com/downloads/details.aspx?FamilyID=fad62198-220c-4717-b044-829ae4f7c125&displaylang=en)工具包。它使您可以轻松地将自定义脚本集成到 Windows 语音识别系统中。 [如果您需要更多控制， SAPI](http://msdn.microsoft.com/en-us/library/ms723627%28VS.85%29.aspx)和[System.Speech.Recognition](http://msdn.microsoft.com/en-us/library/system.speech.recognition.aspx)非常棒，但鉴于您的问题，我怀疑使用 WSR 宏学习曲线会容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T11:12:42.117

查看[语音 XML](http://en.wikipedia.org/wiki/VoiceXML)。可以在[w3.org](http://www.w3.org/Voice/2004/vxml-ir/#systems)上找到实现该标准的系统列表。

# c# - C#：打印对象的所有属性

> ID：852181
> 
> 赞同：217
> 
> 时间：2009-05-12T10:53:04.550
> 
> 标签：c#, object, serialization, console

.NET 中是否有一种方法可以将对象的所有属性等写入控制台？

当然可以使用反射，但我很好奇这是否已经存在......特别是因为你可以在即时窗口的 Visual Studio 中做到这一点。在那里你可以输入一个对象名称（在调试模式下），按回车键，它的所有内容都会被打印得相当漂亮。

这样的方法存在吗？

* * *

## 回答 #1

> 赞同：346
> 
> 时间：2009-05-12T11:33:01.380

您可以使用[`TypeDescriptor`](https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.typedescriptor)该类来执行此操作：

```
foreach(PropertyDescriptor descriptor in TypeDescriptor.GetProperties(obj))
{
    string name = descriptor.Name;
    object value = descriptor.GetValue(obj);
    Console.WriteLine("{0}={1}", name, value);
} 
```

`TypeDescriptor`位于`System.ComponentModel`命名空间中，是 Visual Studio 用来在其属性浏览器中显示对象的 API。它最终基于反射（就像任何解决方案一样），但它从反射 API 提供了相当好的抽象级别。

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2012-05-07T07:03:14.500

基于 LINQ 示例的 ObjectDumper，我创建了一个版本，将每个属性转储到自己的行中。

这个类样本

```
namespace MyNamespace
{
    public class User
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public Address Address { get; set; }
        public IList<Hobby> Hobbies { get; set; }
    }

    public class Hobby
    {
        public string Name { get; set; }
    }

    public class Address
    {
        public string Street { get; set; }
        public int ZipCode { get; set; }
        public string City { get; set; }    
    }
} 
```

有一个输出

```
{MyNamespace.User}
  FirstName: "Arnold"
  LastName: "Schwarzenegger"
  Address: { }
    {MyNamespace.Address}
      Street: "6834 Hollywood Blvd"
      ZipCode: 90028
      City: "Hollywood"
  Hobbies: ...
    {MyNamespace.Hobby}
      Name: "body building" 
```

这是代码。

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Reflection;
using System.Text;

public class ObjectDumper
{
    private int _level;
    private readonly int _indentSize;
    private readonly StringBuilder _stringBuilder;
    private readonly List<int> _hashListOfFoundElements;

    private ObjectDumper(int indentSize)
    {
        _indentSize = indentSize;
        _stringBuilder = new StringBuilder();
        _hashListOfFoundElements = new List<int>();
    }

    public static string Dump(object element)
    {
        return Dump(element, 2);
    }

    public static string Dump(object element, int indentSize)
    {
        var instance = new ObjectDumper(indentSize);
        return instance.DumpElement(element);
    }

    private string DumpElement(object element)
    {
        if (element == null || element is ValueType || element is string)
        {
            Write(FormatValue(element));
        }
        else
        {
            var objectType = element.GetType();
            if (!typeof(IEnumerable).IsAssignableFrom(objectType))
            {
                Write("{{{0}}}", objectType.FullName);
                _hashListOfFoundElements.Add(element.GetHashCode());
                _level++;
            }

            var enumerableElement = element as IEnumerable;
            if (enumerableElement != null)
            {
                foreach (object item in enumerableElement)
                {
                    if (item is IEnumerable && !(item is string))
                    {
                        _level++;
                        DumpElement(item);
                        _level--;
                    }
                    else
                    {
                        if (!AlreadyTouched(item))
                            DumpElement(item);
                        else
                            Write("{{{0}}} <-- bidirectional reference found", item.GetType().FullName);
                    }
                }
            }
            else
            {
                MemberInfo[] members = element.GetType().GetMembers(BindingFlags.Public | BindingFlags.Instance);
                foreach (var memberInfo in members)
                {
                    var fieldInfo = memberInfo as FieldInfo;
                    var propertyInfo = memberInfo as PropertyInfo;

                    if (fieldInfo == null && propertyInfo == null)
                        continue;

                    var type = fieldInfo != null ? fieldInfo.FieldType : propertyInfo.PropertyType;
                    object value = fieldInfo != null
                                       ? fieldInfo.GetValue(element)
                                       : propertyInfo.GetValue(element, null);

                    if (type.IsValueType || type == typeof(string))
                    {
                        Write("{0}: {1}", memberInfo.Name, FormatValue(value));
                    }
                    else
                    {
                        var isEnumerable = typeof(IEnumerable).IsAssignableFrom(type);
                        Write("{0}: {1}", memberInfo.Name, isEnumerable ? "..." : "{ }");

                        var alreadyTouched = !isEnumerable && AlreadyTouched(value);
                        _level++;
                        if (!alreadyTouched)
                            DumpElement(value);
                        else
                            Write("{{{0}}} <-- bidirectional reference found", value.GetType().FullName);
                        _level--;
                    }
                }
            }

            if (!typeof(IEnumerable).IsAssignableFrom(objectType))
            {
                _level--;
            }
        }

        return _stringBuilder.ToString();
    }

    private bool AlreadyTouched(object value)
    {
        if (value == null)
            return false;

        var hash = value.GetHashCode();
        for (var i = 0; i < _hashListOfFoundElements.Count; i++)
        {
            if (_hashListOfFoundElements[i] == hash)
                return true;
        }
        return false;
    }

    private void Write(string value, params object[] args)
    {
        var space = new string(' ', _level * _indentSize);

        if (args != null)
            value = string.Format(value, args);

        _stringBuilder.AppendLine(space + value);
    }

    private string FormatValue(object o)
    {
        if (o == null)
            return ("null");

        if (o is DateTime)
            return (((DateTime)o).ToShortDateString());

        if (o is string)
            return string.Format("\"{0}\"", o);

        if (o is char && (char)o == '\0') 
            return string.Empty; 

        if (o is ValueType)
            return (o.ToString());

        if (o is IEnumerable)
            return ("...");

        return ("{ }");
    }
} 
```

你可以这样使用它：

```
var dump = ObjectDumper.Dump(user); 
```

**编辑**

*   双向参考现已停止。因此，对象的 HashCode 存储在列表中。
*   已修复（见评论）
*   FormatValue 固定（见评论）

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2009-05-12T11:03:31.883

众所周知，`ObjectDumper`班级会这样做。我从未确认过，但我一直怀疑即时窗口使用它。

编辑：我刚刚意识到，代码`ObjectDumper`实际上是在你的机器上。去：

```
C:/Program Files/Microsoft Visual Studio 9.0/Samples/1033/CSharpSamples.zip 
```

这将解压缩到一个名为*LinqSamples*的文件夹。在那里，有一个名为*ObjectDumper*的项目。用那个。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-05-12T10:59:05.087

也许通过[JavaScriptSerializer.Serialize](http://msdn.microsoft.com/en-us/library/bb292287.aspx)？

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-05-12T11:12:33.553

以下代码段将执行所需的功能：

```
Type t = obj.GetType(); // Where obj is object whose properties you need.
PropertyInfo [] pi = t.GetProperties();
foreach (PropertyInfo p in pi)
{
    System.Console.WriteLine(p.Name + " : " + p.GetValue(obj));
} 
```

我认为如果你把它写成扩展方法，你可以在所有类型的对象上使用它。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-12T13:58:31.483

关于 Sean 的回复中的 TypeDescriptor（我无法发表评论，因为我的名声不好）......使用 TypeDescriptor 而不是 GetProperties() 的一个优点是 TypeDescriptor 具有在运行时将属性动态附加到对象的机制，正常反射会错过这些.

例如，当使用 PowerShell 的 PSObject（可以在运行时添加属性和方法）时，他们实现了一个自定义 TypeDescriptor，它将这些成员与标准成员集合并。通过使用 TypeDescriptor，您的代码无需了解这一事实。

组件、控件，我想也许 DataSets 也使用了这个 API。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T11:09:46.397

这正是反射的用途。我认为没有更简单的解决方案，但无论如何反射并不是代码密集型的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T10:58:22.950

不要这么想。我总是不得不编写它们或使用其他人的工作来获取这些信息。据我所知，必须是反思。

**编辑：**
看看[这个](http://www.codeproject.com/KB/debug/DebugIList.aspx?display=Print)。我正在调查长对象图的一些调试，并在我添加手表时注意到这一点，VS 在这个类中抛出：`Mscorlib_CollectionDebugView<>`. 它是一种内部类型，可以很好地显示集合，以便在监视窗口/代码调试模式下查看。现在因为它是内部的，您可以引用它，但您可以使用 Reflector 复制（来自 mscorlib）代码并拥有自己的代码（上面的链接有一个复制/粘贴示例）。看起来真的很有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-12T11:12:53.567

任何其他解决方案/库最终都会使用反射来内省类型......

# netbeans - 诺基亚 s60 linux 模拟器

> ID：852184
> 
> 赞同：4
> 
> 时间：2009-05-12T10:53:50.133
> 
> 标签：netbeans, java-me, emulation, nokia, s60

我在 Ubuntu 上使用 EclipseMe。我想要一个可以模拟屏幕上鼠标移动的模拟器。

有 linux 的 s60 模拟器吗？

编辑：net beans 是否有一个内置的模拟器，可以模拟设备屏幕上的鼠标移动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T11:45:21.587

Netbeans 使用 Sun Wireless Toolkit。

它包含的 JavaME 仿真器可以制作成触摸屏仿真器。阅读随附的文档，它应该像在说明模拟器之前在配置文件中设置一个变量一样简单。

[您可以在http://jcp.org/en/jsr/detail?id=118](http://jcp.org/en/jsr/detail?id=118)找到 MIDP（您可能针对的 JavaME 平台的顶层）的规范

查看 javax.microedition.lcdui.Canvas 类，你会发现有几个方法用来处理“指针”。虽然它们更常用于处理触摸屏事件，但它们也映射到模拟器上的鼠标/操纵杆点击。

在 Linux 上运行模拟器时，您绝对可以获得 MIDP 指针拖动事件。

这是基本的 MIDP，不需要花哨的 JSR-226 (e-swt) 支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-13T10:23:21.083

Windows only Symbian Emulator (EPOC) 正在被废弃，而基于 QEMU 的模拟器将在所有平台上运行。这可能会在 6 个月左右的时间内提供。

目前，我在 Mac 上的 VirtualBox 中运行 Windows XP 以进行 Symbian 开发。它工作正常，但当然不是理想的解决方案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-08-09T17:01:21.803

不幸的是，带有 Java 和 Symbian C 应用程序接口的完整 symbian OS 模拟器是基于 Windows 的。

我通常会得到一个 MS Windows Vista 安装磁盘并将其安装到像 VirtualBox 这样的 VM 中，然后在其上安装 symbian SDks。

最适合现在售价 687 美元的 4 核台式机 64 位计算机，因为您可以获得完整的 8 gig ram 和接近 1 TB 的硬盘驱动器。

# .net - 了解 .NET 框架中的 CAS

> ID：852187
> 
> 赞同：1
> 
> 时间：2009-05-12T10:54:46.857
> 
> 标签：.net, security, cas

如果我向 .net 框架提供我的程序集所属代码组的证据，我不能提供虚假证据表明我属于受信任区域代码组吗？

我知道什么是安全策略、权限集，但我不明白框架如何检查证据，然后根据该证据确定代码组。

任何解释将不胜感激。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T16:02:47.557

允许调用者提供证据的各种 BCL 方法本身受权限要求的保护。调用者通常至少需要 SecurityPermission\ControlEvidence，但通常需要无限制的权限授予（也称为“完全信任”）。（由于 SecurityPermission\ControlEvidence 仅在默认 CAS 策略下授予本地安装的代码，因此在大多数情况下几乎没有实际区别。）最终结果是，只有高度受信任的代码才能通过控制其证据来影响任何给定程序集的权限授予。

如果您认为您发现了此一般规则的例外情况，您能否提供详细信息？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T10:57:57.040

证据可以是汇编强名称、代码库和其他东西。它当然可以验证这些东西。您根据证据手动信任程序集。基本上，您告诉框架程序集是否具有以下属性，授予它该权限集。我看不出有什么办法可以提供虚假证据。你能举个例子吗？

PS。是的，例如，您可以窃取某人的密钥对并用它签署您的程序集。与任何其他安全系统一样，它依赖于*信任链*。如果你打破了链条的一部分，你就搞砸了。没有真正的方法可以在安全系统中规避这些东西。毕竟，您可能会因缓冲区溢出或其他原因破坏系统，并将您的程序集添加到完整信任列表中。

# c# - 一些建议如何在 WPF 中打印效果好

> ID：852189
> 
> 赞同：1
> 
> 时间：2009-05-12T10:55:39.023
> 
> 标签：c#, .net, wpf, printing

下个月我将开始开发一个项目，我正在研究这个（我是新手）。

在这个项目中，我将创建许多报告来存储数据库中的数据，因此我将专注于如何使用 WPF 打印报告。我需要使用许多功能如下：页眉、页脚、多页、页码等。

我问你是否可以给我任何有用的建议、链接、建议、工具等，以帮助我如何在 WPF 中打印并取得良好的效果，真的，我对此一无所知。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T15:45:18.350

您似乎关心两件事：打印和报告。

如果这是一个简单的打印问题，那么[还有其他问题](https://stackoverflow.com/search?q=print+WPF)可能会有所帮助。

如果您主要关心报告或管理和打印报告，那么您需要一个报告框架。

如果您已获得 SQL Server 2005 或更高版本的许可，您可能需要查看[SQL Reporting Services](http://technet.microsoft.com/en-us/library/ms159106(SQL.90).aspx)。无论数据是否存储在 SQL Server 中，您都可以使用 SSRS。

对您的问题的评论中的建议 - 查看[这个先前的 SO 问题](https://stackoverflow.com/questions/180746/whats-the-best-approach-to-printing-reporting-from-wpf)- 对我来说似乎仍然是一个很好的建议。这几乎是一个相同的问题。

# java - 超越 Java 中的 Integer.MAX_VALUE 约束

> ID：852190
> 
> 赞同：4
> 
> 时间：2009-05-12T10:56:20.957
> 
> 标签：java, collections, integer, stringbuilder, max

抛开堆的容量，有没有办法超越 Java 中的 Integer.MAX_VALUE 约束？

例子是：

1.  集合将自身限制为 Integer.MAX_VALUE。
2.  StringBuilder / StringBuffer 将自己限制为 Integer.MAX_VALUE。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T11:06:14.607

[如果您有一个庞大的收藏，那么在您拥有2 ^(31) - 1](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Integer.html#MAX_VALUE)个项目之前，您将达到各种实际限制。一个包含一百万个项目的集合将非常笨重，更不用说一个超过数千倍的集合了。

类似地，StringBuilder 可以构建一个大小为 2GB 的字符串，然后再达到`MAX_VALUE`对于任何实际用途都绰绰有余的限制。

如果您真的认为您可能会达到这些限制，您的应用程序应该以不同的方式存储您的数据，可能在数据库中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T10:58:22.733

用长？为我工作。

***编辑：****啊，澄清问题。凉爽的。我的新的和改进的答案：*

**带有分页算法。**

巧合的是，最近为了另一个问题**（[在 java 中的排序（内存映射？）文件中的二进制搜索](https://stackoverflow.com/questions/736556/binary-search-in-a-sorted-memory-mapped-file-in-java/736922#736922)）**，我启动了一个分页算法来绕过 java.nio.MappedByteBuffer API 中的*int*参数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T18:26:08.680

您可以根据这些集合的源代码创建自己的具有长 size() 的集合。例如，要拥有更大的对象数组，您可以拥有一个数组数组（并将它们拼接在一起）

这种方法将允许几乎 2^62 个元素。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T11:36:35.557

数组**索引**受 Integer.MAX_VALUE 限制，而不是数组的物理大小。

因此，数组的最大大小与数组类型的大小相关联。

```
byte = 1 byte => max  2 Gb data
char = 2 byte => max  4 Gb data
int  = 4 byte => max  8 Gb data
long = 8 byte => max 16 Gb data 
```

字典是另一回事，因为它们经常使用诸如存储桶之类的技术或将内部数据布局用作树。因此，这些“限制”通常不适用，否则您将需要更多数据才能达到限制。

简短： Integer.MAX_VALUE 并不是真正的限制，因为您需要大量内存才能真正达到限制。如果您达到此限制，您可能需要考虑改进您的算法和/或数据布局:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T10:58:55.960

是的，使用 BigInteger 类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T11:55:00.320

内存升级是必要的.. :)

# matlab - 在新的 matlab 版本上运行旧的 mex 文件

> ID：852192
> 
> 赞同：6
> 
> 时间：2009-05-12T10:57:23.250
> 
> 标签：matlab, mex

我正在尝试在新版本（R2009a）上运行最初在 Matlab 6.5 上测试的程序该程序使用了一些 mex 文件，尝试运行它时出现以下错误：

？？？无效的 MEX 文件“/normalizedCut/common_files/sparsifyc.mexglx”：normalizedCut/common_files/sparsifyc.mexglx：符号 mxGetIr，版本 libmx.INTERNAL 未在文件 libmx.so 中定义，带有链接时间参考。

（我试图调整的代码是由 Shi & Malic 规范化的，可以在这里找到： [http](http://www.cis.upenn.edu/~jshi/software/files/NcutClustering_7.zip) ://www.cis.upenn.edu/~jshi/software/files/NcutClustering_7.zip ）

如果我尝试在同一系统上运行代码，但 Matlab 2007a 运行正常。

2009a 的向后兼容性有问题吗？系统中是否有任何标志可以更改以帮助它工作？

当我用谷歌搜索它时，我看到了一些对 LD_LIBRARY_PATH 环境变量的引用，但是我找不到到底应该添加什么。

谢谢， 亚尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-13T22:43:23.397

这些 mex 函数的源代码似乎可在此页面上的“具有标准化剪切的图像分割”源中获得：[http](http://www.cis.upenn.edu/~jshi/software/) ://www.cis.upenn.edu/~jshi/software/ （在解压缩的 specific_NcutImage_files 子目录中。压缩）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T11:19:52.807

使用不同版本的 Matlab 运行 mex 函数时出现问题是很常见的。您遇到的错误看起来像是由于 Matlab 中的 API 更改造成的（尽管这让我有点吃惊）。由于 gcc 的变化引起的二进制不兼容，我遇到了最大的麻烦。我建议联系Jianbo 并询问他是否可以构建新版本或发布源代码。

最坏的情况，您可以尝试重新实现这些 mex 函数。标准化切割算法在 Matlab 中非常简单（参见[Shi 和 Malik 论文](http://www.cs.berkeley.edu/~malik/papers/SM-ncut.pdf)）。根据 mex 函数的名称，它们看起来主要是在复制现有的 matlab 功能（矩阵乘法、矩阵稀疏化）。如果您将它们重新实现为常规的 m 代码函数，那么由于已添加到 Matlab 的多核支持，它们无论如何都会更快。

# vb.net - VB.NET Parsing an Object type to a GUID type

> ID：852198
> 
> 赞同：5
> 
> 时间：2009-05-12T10:58:53.903
> 
> 标签：vb.net

how can I convert an object type to a GUID type in VB.NET?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T11:02:12.087

I'm not sure what exactly you want but this might help:

```
Dim g = CType(obj, System.Guid) 
```

If you want to convert a string to a `Guid`:

```
Dim g = New Guid(myString) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T16:14:22.100

If you are looking to create the object as a new guid, use the following call:

```
dim objvar as guid = System.GUID.NewGuid() 
```

*edit* Your question is a little unclear when you say "convert". If you already have the object created and assigned, use DirectCast to create an object that the Visual Studio environment will recognize.

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-05-12T20:26:49.607

Mehrdad's sample will work, however it is always best to declare the data type for all your variables:

```
Dim g As Guid = objectVariable 
```

In this case there is no need to use CType or DirectCast.

# sql - 如何从查询中多次评估数据？

> ID：852206
> 
> 赞同：0
> 
> 时间：2009-05-12T11:00:51.060
> 
> 标签：sql, sql-server, sql-server-2005

```
CREATE TABLE #Temp (VisitingCount int, [Time] int )
DECLARE @DateNow DATETIME,@i int,@Time int
set @DateNow='00:00'  
set @i=1;  
while(@i<48)  
    begin  
        set @DateNow = DATEADD(minute, 30, @DateNow)
        set @Time = (datepart(hour,@DateNow)*60+datepart(minute,@DateNow))/30 
        insert into #Temp(VisitingCount,[Time]) values(0,@Time )
        set @i=@i+1
    end

* * *

select Sum(VisitingCount)as VisitingCount, [Time]
  from #Temp group by [Time]
Union All
  select count(page) as VisitingCount, 
  (datepart(hour,Date)*60+datepart(minute,Date))/30 as [Time]
  from scr_SecuristLog
  where Date between '2009-05-04 10:30' and '2009-05-04 12:30'
  GROUP BY (datepart(hour,Date)*60+datepart(minute,Date))/30--scr
  order by 2 asc
```

这个查询为我创建了这个表，但如果你看下面的“22”重复两次。在这个情况下。我应该删除 0 值。我需要

VisitingCount ------------时间----------
重复-----重复--
重复------------------重复-----
重复--------重复-----
526 ------------------------21----------
0-------------- ------------22----------
0-------------------------22 ----------
0--------------23----------
825- ------------------------23------------
重复---------------- ---重复-----
重复-----重复-----

### 我需要这张桌子

VisitingCount ------------时间----------
重复-----重复--
重复------------------重复-----
重复--------重复-----
526 ------------------------21----------
0-------------- ------------22----------
825-------------23-- -----重复------------------
重复-----
重复---- --重复--

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T11:06:46.727

再创建一个嵌套级别：

```
select Sum(VisitingCount)as VisitingCount, [Time]
from (
  select Sum(VisitingCount)as VisitingCount, [Time]
    from #Temp group by [Time]
  Union All
    select count(page) as VisitingCount, 
    (datepart(hour,Date)*60+datepart(minute,Date))/30 as [Time]
    from scr_SecuristLog
    where Date between '2009-05-04 10:30' and '2009-05-04 12:30'
    GROUP BY (datepart(hour,Date)*60+datepart(minute,Date))/30--scr
  ) X
group by [Time]
order by 2 asc 
```

# java - 我可以执行 Java 类文件的多个实例吗？

> ID：852209
> 
> 赞同：2
> 
> 时间：2009-05-12T11:01:19.607
> 
> 标签：java, binary, jvm, multiple-instances

我正在考虑使用不同的配置文件（作为命令行参数）执行相同 java 二进制文件（套接字应用程序）的多个实例。JVM 是否正确处理了这种情况？换句话说，如果我没有任何公共资源（可以锁定的文件等），这种方法会产生任何问题吗？如果是这样，我需要注意哪些事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T11:07:03.967

如果您从命令行启动多个 java 实例，您将获得多个正在运行的 JVM（每个实例一个）。

如果没有共享资源，您应该完全没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T11:21:40.230

正如 Matthew 之前指出的，只要没有共享资源，我们就应该看不到任何问题。

再补充一点，JVM 就像一个容器，为 java 程序提供执行环境，并且每次我们从命令行调用 java 时都会创建一个 JVM。

[http://en.wikipedia.org/wiki/Java_Virtual_Machine](http://en.wikipedia.org/wiki/Java_Virtual_Machine)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T11:54:27.717

如果您有很多实例，那么您可能会遇到内存使用过多和启动时间缓慢的问题。大部分 JRE 是共享的，但不是所有内容，也不是一般应用程序代码和资源。一些 JRE 在一定程度上解决了这个问题，例如 IBM JRE 6 的最新版本共享已编译的应用程序代码。

如果您的所有代码都写得很好（例如，没有可变的静态变量（包括单例）），那么使用单个进程应该不是问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T11:09:45.570

没问题。实际上，我发现相反的情况有点烦人——没有（简单的）方法可以限制同一台计算机中可启动实例的数量。

# asp.net - 在 Silverlight 中管理资源的最佳想法是什么？

> ID：852214
> 
> 赞同：0
> 
> 时间：2009-05-12T11:03:19.043
> 
> 标签：asp.net, silverlight, resources

我需要创建我的 silverlight 框架，该框架具有以下所有有关资源的功能。

1.  **部分加载。**所以，我不能使用示例资源文件（*.resx）。
2.  **强类型资源文件。**因为它很容易调试。
3.  **使用示例文本编辑器易于编辑。**因为您不能在 Web 服务器中使用一些复杂的编辑器，例如 Visual Studio。
4.  **易于检测丢失的资源。**

*暗示*

我的框架是基于 Visual Studio 集成包项目构建的。因此，我可以修改大部分 Visual Studio 功能，如编辑器、工具箱、菜单。

**更新#1**

如果不可能，那么，我将在 Web 服务器上创建一些资源编辑来管理该资源。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T19:48:38.077

我不确定您要做什么，因为您的问题相当模糊，但我可以阐明如何在 Silverlight 平台上管理资源。

Silverlight 资源可以嵌入到任何 XAML 中，因为所有可视元素都有一个可通过 Resources 属性访问的 ResourceDictionary。

```
<Grid>
    <Grid.Resources>        

        <DataTemplate x:Key="MyTemplate">
        </DataTemplate>

    </Grid.Resources>
</Grid> 
```

但是，最佳做法是使用称为“资源字典”的特殊 XAML 文件。

```
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" >

    <DataTemplate x:Key="MyTemplate">
    </DataTemplate>

</ResourceDictionary> 
```

Silverlight 3 带来了将这些资源字典自动合并到应用程序的主资源字典中的能力。

```
<Application.Resources>
    <ResourceDictionary>

        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="Resources/A.xaml"/>
            <ResourceDictionary Source="Resources/B.xaml"/>
            <ResourceDictionary Source="Resources/C.xaml"/>
        <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary>
<Application.Resources> 
```

为了将资源字典与应用程序的资源合并，资源字典必须驻留在用于将 Silverlight 应用程序向下部署到客户端的压缩 XAP 包中。

但是，如果您愿意，您可以将 XAML 资源字典存储在 Web 服务器上，并通过使用 WebClient 下载文件，然后使用 XamlReader 从您检索的 XAML 字符串在内存中构造对象模型，将它们带入您的 Silverlight 应用程序。文件。

资源字典本质上是强类型的，但不是*类型安全的*。这样，如果 XAML 中的元素类型不正确，您将不会收到编译时错误。如果您的某个资源发生错误，您只会在初始化对它的引用并且渲染引擎尝试实例化您的资源时才发现。

简而言之：

1.  是的。
2.  是的。
3.  是的。
4.  不。

# xpath - 祖先或自我

> ID：852215
> 
> 赞同：3
> 
> 时间：2009-05-12T11:03:21.117
> 
> 标签：xpath

我有以下xml：

```
<?xml version="1.0" encoding="utf-8" ?>
<ROLES>
<ROLE type="A">
    <USER name="w" />
    <USER name="x" />
    <ROLE type="B">
         <USER name="x" />
         <USER name="y" />
     </ROLE>
     <ROLE type="C">
         <USER name="x" />
         <USER name="y" />
          <USER name="z" />
     </ROLE>
</ROLE>
<ROLE type ="D">
 <USER name="w" />
</ROLE>
</ROLES> 
```

我想找到所有 USER 节点，`name="x"`它们是 ROLE 节点的直接子节点，属性“type”等于“C”，它们的祖先`name="x"`（可能通过使用祖先或自我轴）。在这种情况下，节点集应该包含两个节点（不是三个，因为在 B 下出现的 x 不应该计算在内）。

正确的 XPath 表达式是什么？为什么以下表达式不起作用？

```
/ROLES//ROLE[@type='C']/USER[@name='x']/ancestor-or-self::USER[@name='x'] 
```

（这只返回一个节点，可能是自身轴，而不是祖先）

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T11:19:31.700

> 我想找到所有 name="x" 的 USER 节点...</p>

```
//用户[@name = 'x']
```

> ...它们是 ROLE 节点的直接子节点，属性“type”等于“C”...</p>

```
//USER[@name = 'x' and parent::ROLE[@type = 'C']]
```

> …以及他们的祖先名字=“x”。

```
?
```

我没有看到任何可能具有名称 =“x”的祖先。你什么意思？

* * *

编辑：啊，我想我明白了。你的意思是：

…以及他们祖先的孩子，`USER`名字为“x”

```
//USER[@name = 'x' and parent::ROLE[@type = 'C']]/ancestor::ROLE/USER[@name = 'x']
```

* * *

现在对于为什么您的 XPath 不起作用的问题：

```
/ROLES//ROLE[@type='C']/USER[@name='x']/ancestor-or-self::USER[@name='x']
```

选择

*   所有属于( )`ROLE`的后代的 s ...</li> `/ROLES``"/ROLES//ROLE"`
*   …具有`@type='C'`("/ROLES//ROLE[@type='C']")…</li>
*   …在他们的 USER 孩子中有`@name='x'`( `/USER[@name='x']`)
*   `ancestor-or-self::USER`…然后从那里开始`@name='x'`

最后一个定位步骤会破坏它。没有`USER`祖先，只有`ROLE`祖先。

# qt - 如何找出自定义小部件未显示在 Qt 设计器中的原因？

> ID：852224
> 
> 赞同：3
> 
> 时间：2009-05-12T11:07:11.253
> 
> 标签：qt, custom-controls, qt-designer

我按照 Qt Creator 帮助中提供的说明创建了一个自定义小部件。我完全按照他们那里所说的去做。我的小部件没有与其他小部件一起显示。我什至尝试了他们的 WorldTimeClock 示例。这也没有显示在 Qt 设计器中。

我该如何调试呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T11:52:20.003

如果你去工具 -> 表单编辑器 -> 关于 Qt Designer 插件，你会找到一个加载的 qt 插件列表，你会在那些加载失败的旁边看到一条错误消息。我认为这是你能得到的最好的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-22T20:27:51.340

我刚遇到这种情况。据我所知，Qt Creator 的分布式版本是用 msvc 编译的，而不是 mingw。尝试打开 Qt 设计器。你看到你的（和内置的）自定义小部件了吗？如果是这样，请按照[此处](http://www.qtforum.org/article/34938/compile-qtcreator-with-mingw.html#post111534)的说明使用 mingw 构建 Qt Creator。当我这样做时，我的自定义小部件出现在新版本中。

# sql - 将孩子归为父母的人

> ID：852225
> 
> 赞同：0
> 
> 时间：2009-05-12T11:08:32.997
> 
> 标签：sql, sqlite

我有一个带有简单人员表的 SQLite 数据库。

每行代表一个人，有四列：主键 (id)，一列用于姓名，一列用于年龄，一列用于父级（指向主键 id，如果此人没有父级，则为 NULL）。

现在，我只想列出所有按年龄排序的人，并将孩子与他们的父母分组。

例如：（姓名、年龄）

```
丹，18 岁
伊娃，21 岁
- 比尔，4
- 公牛，7

史蒂夫，38 岁
理查德，63 岁
- 安，19 岁
- 克拉拉，39 岁

维拉，70  

```

这听起来很简单，但我无法弄清楚 SQL 语句 :-(
提前致谢！

/约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T11:14:05.763

如果您只需要一层深度，您可以这样做：

```
SELECT  CONCAT(CASE WHEN parent IS NOT NULL THEN '- ' ELSE '' END, name), age
FROM    table
ORDER BY
        CASE WHEN parent IS NOT NULL THEN parent ELSE id END, parent IS NOT NULL 
```

如果你想建立整个层次结构，那就更难了。

**更新：**最初，问题标签说`MySQL`，所以答案与`MySQL`.

我会留下答案，但它不适用于`SQLite`.

`MySQL`对此没有本机支持，因此您需要创建一些特殊功能。

有关详细信息，请参阅我的博客中的这篇文章：

*   [**MySQL 中的分层查询**](http://explainextended.com/2009/03/17/hierarchical-queries-in-mysql/)

简而言之：

```
CREATE FUNCTION hierarchy_connect_by_parent_eq_prior_id(value INT) RETURNS INT
NOT DETERMINISTIC
READS SQL DATA
BEGIN
        DECLARE _id INT;
        DECLARE _parent INT;
        DECLARE _next INT;
        DECLARE CONTINUE HANDLER FOR NOT FOUND SET @id = NULL;

        SET _parent = @id;
        SET _id = -1;

        IF @id IS NULL THEN
                RETURN NULL;
        END IF;

        LOOP
                SELECT  MIN(id)
                INTO    @id
                FROM    t_hierarchy
                WHERE   parent = _parent
                        AND id > _id;
                IF @id IS NOT NULL OR _parent = @start_with THEN
                        SET @level = @level + 1;
                        RETURN @id;
                END IF;
                SET @level := @level - 1;
                SELECT  id, parent
                INTO    _id, _parent
                FROM    t_hierarchy
                WHERE   id = _parent;
        END LOOP;
END

SELECT  CONCAT(REPEAT('    ', level - 1), CAST(hi.id AS CHAR)) AS treeitem, parent, level
FROM    (
        SELECT  hierarchy_connect_by_parent_eq_prior_id(id) AS id, @level AS level
        FROM    (
                SELECT  @start_with := 0,
                        @id := @start_with,
                        @level := 0
                ) vars, t_hierarchy
        WHERE   @id IS NOT NULL
        ) ho
JOIN    t_hierarchy hi
ON      hi.id = ho.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T11:18:23.980

我建议您将其拆分为两个查询。

首先，获取父母名单：

```
SELECT *
FROM Persons
WHERE id IN (SELECT parent FROM Persons)
ORDER BY (age, id) 
```

然后得到一个正确排序的孩子列表：

```
SELECT Child.*
FROM Persons AS Child
     JOIN Persons AS Parent ON (Parent.id = Child.parent)
ORDER BY (Parent.age, Parent.id, Child.age, Child.id) 
```

这两个列表可以很容易地在`id`/上合并，`parent`因为它们都首先按父级排序`age`。

# c# - Groove Web 服务问题 GrooveMembers.Create

> ID：852227
> 
> 赞同：1
> 
> 时间：2009-05-12T11:09:04.073
> 
> 标签：c#, service, groove

我正在用 C# 开发一个概念验证网站站点，它将采用 URL 查询字符串，将其与特定的 Groove 工作区匹配，然后如果用户没有该空间，则邀请他们进入该空间。我有连接到 Groove 数据桥，找到工作区，阅读工作区成员部分工作得很好。

不过，我遇到了自动邀请的绊脚石。我将它作为一个独立的网站“桥”运行，所以我试图完全从 Web 服务器运行它。我有我想从数据库中邀请的人的 Groove 身份作为字符串：

CurrUserIdentity =grooveIdentity://nzkth68eqzgktrb9sbr....

但是，我不知道如何将字符串转换为真正的 GrooveMember.Member 对象，然后再被邀请。在这种情况下，最简单的邀请方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-14T16:55:38.157

Groove Web Services V12 Helpers Library 可以提供更易于管理的 API 来完成该任务 - [http://gwsv12helpers.codeplex.com/](http://gwsv12helpers.codeplex.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T06:47:43.613

终于找到了：

```
GrooveMembers.GrooveMembers AddMember = new GrooveMembers.GrooveMembers();
AddMember.GrooveRequestHeaderValue = new GrooveMembers.GrooveRequestHeader();
AddMember.GrooveRequestHeaderValue.GrooveRequestKey = someString; //Whatever used in your envronment
AddMember.GrooveRequestHeaderValue.GrooveIdentityURL = id.URI; //URI of the local Groove identity or the Groove Data Bridge
AddMember.Url = someOtherString /*Local web string or remote host*/ + space.Members;//A property of the space you are inviting the tuser into
GrooveMembers.Member[] Members = AddMember.Read();//actually connects to the service

GrooveMembers.Member newMember = new GrooveMembers.Member();
newMember.URI = userIdentity;//A string stripped from the database and TRIMmed
newMember.Name = userFullName;//A string also pulled from the database DisplayNeme\GrooveDomain
string userContact = "/GWS/Groove/2.0/Contacts/" + userIdentity.Replace("://", "/");
newMember.Contact = userContact;// A string formatted by replacing :// with / adding "/GWS/Groove/2.0/Contacts/" to the front of the Groove Identity
newMember.Role = "$Telespace.Member";

AddMember.Create(newMember);

GrooveMembers.GrooveMembers AddMember = new GrooveMembers.GrooveMembers();
AddMember.GrooveRequestHeaderValue = new GrooveMembers.GrooveRequestHeader();
AddMember.GrooveRequestHeaderValue.GrooveRequestKey = someString; //Whatever used in your envronment
AddMember.GrooveRequestHeaderValue.GrooveIdentityURL = id.URI; //URI of the local Groove identity or the Groove Data Bridge
AddMember.Url = someOtherString [Local web string or remote host] + space.Members [A property of the space you are inviting the tuser into];
GrooveMembers.Member[] Members = AddMember.Read();//actually connects to the service

GrooveMembers.Member newMember = new GrooveMembers.Member();
newMember.URI = userIdentity;//A string stripped from the database and TRIMmed
newMember.Name = userFullName;//A string also pulled from the database DisplayNeme\GrooveDomain
string userContact = "/GWS/Groove/2.0/Contacts/" + userIdentity.Replace("://", "/");
newMember.Contact = userContact;// A string formatted by replacing :// with / adding "/GWS/Groove/2.0/Contacts/" to the front of the Groove Identity
newMember.Role = "$Telespace.Member";

AddMember.Create(newMember); 
```

# c# - 使用反射获取通用 IDictionary 的值

> ID：852233
> 
> 赞同：11
> 
> 时间：2009-05-12T11:12:21.650
> 
> 标签：c#, reflection, generics, idictionary

我有一个实现的实例`IDictionary<T, K>`，我在编译时不知道 T 和 K，并且想从中获取所有元素。由于某种原因，我不想使用`IEnumerable`它，这将是由`IDictionary`.

我到目前为止的代码：

```
// getting types
Type iDictType = instance.GetType().GetInterface("IDictionary`2");
Type keyType = iDictType.GetGenericArguments()[0];
Type valueType = iDictType.GetGenericArguments()[1];

// getting the keys
IEnumerable keys = (IEnumerable)dictType.GetProperty("Keys")
  .GetValue(instance, null);

foreach (object key in keys)
{
  // ==> this does not work: calling the [] operator
  object value = dictType.GetProperty("Item")
    .GetValue(instance, new object[] {key } );

  // getting the value from another instance with TryGet
  MethodInfo tryGetValue = iDictType.GetMethod("TryGetValue");
  object[] arguments = new object[] { key, null };
  bool hasElement = (bool)tryGetValue.Invoke(otherInstance, arguments);
  object anotherValue = arguments[1];
} 
```

我也可以调用 TryGetValue，但我认为应该可以调用 [] 运算符。有谁能够帮我？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-12T11:14:52.957

最好*弄清楚*`TKey`/ `TValue`，并通过 - 切换到常规代码，如下`MakeGenericMethod`所示：

（**编辑**-`otherInstance`如果它们属于同一类型，您也可以将其作为参数传入）

```
static class Program
{
    static void Main()
    {
        object obj = new Dictionary<int, string> {
            { 123, "abc" }, { 456, "def" } };

        foreach (Type iType in obj.GetType().GetInterfaces())
        {
            if (iType.IsGenericType && iType.GetGenericTypeDefinition()
                == typeof(IDictionary<,>))
            {
                typeof(Program).GetMethod("ShowContents")
                    .MakeGenericMethod(iType.GetGenericArguments())
                    .Invoke(null, new object[] { obj });
                break;
            }
        }
    }
    public static void ShowContents<TKey, TValue>(
        IDictionary<TKey, TValue> data)
    {
        foreach (var pair in data)
        {
            Console.WriteLine(pair.Key + " = " + pair.Value);
        }
    }    
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T15:13:15.757

只是为了完成，即使 Marc Gravell 的解决方案更好，这也是我已经开始的工作方式：

```
object value = dictType.GetMethod("get_Item")
  .Invoke(instance, new object[] { key }); 
```

这调用了字典的 [] 运算符。

# asp.net - 使用 Find 方法在通用列表中查找对象

> ID：852239
> 
> 赞同：3
> 
> 时间：2009-05-12T11:13:37.700
> 
> 标签：asp.net, find, generics, predicate

```
class Cache
{
    int sizeOfCache;//no of RssFeedDocument 
    private List<RssFeedDocument> listOfRssFeedDocument = null;
} 
```

我想根据`RssFeedDocument`的属性在类中的这个通用列表中找到一个对象`FeedId`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T11:18:08.003

使用匿名委托：

```
Guid feedID = ...;
RssFeedDocument document = listOfRssFeedDocuments.Find(
    delegate(RssFeedDocument rfd)
    { return rfd.FeedId == feedID; }); 
```

相同，但使用 C# 3.0 lambda：

```
Guid feedID = ...;
RssFeedDocument document = 
    listOfRssFeedDocuments.Find(rfd => rfd.FeedId == feedID); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T11:17:30.313

假设您可以使用`IEnumerable<T>`扩展方法，我认为最简单的方法实际上是使用`Where`：

```
listOfRssFeedDocument.Where(doc => doc.FeedId == someId); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T11:18:43.573

```
List<RssFeedDocument> filteredList = listOfRssFeedDocument.Find(delegate(RssFeedDocument d) { return d.FeedId = x; }); 
```

参考：[List `<T>`.Find](http://msdn.microsoft.com/en-us/library/x0b5b5bc.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T11:19:52.417

如果您无法使用 LINQ，则可以使用以下内容：

```
RssFeedDocument fd = ListName.Find(delegate(RssFeedDocument doc) { return doc.FeedID == someVariable; }); 
```

# internet-explorer-8 - Internet Explorer 8 开发人员工具不显示

> ID：852245
> 
> 赞同：124
> 
> 时间：2009-05-12T11:18:01.063
> 
> 标签：internet-explorer-8

在最后一天，在 Internet Explorer 8 中，开发者工具窗口将不会出现。

当我按 F12 或使用菜单工具 -> 开发人员工具时，我会在任务栏中获得开发人员工具条目，但实际窗口不会显示。

它已经运行了一个月左右。我试过重启但没有运气。

* * *

## 回答 #1

> 赞同：222
> 
> 时间：2009-05-12T11:22:27.450

> [**当它移动很远时，如何在屏幕上重新显示一个窗口？**](http://blogs.msdn.com/oldnewthing/archive/2009/05/11/9601136.aspx)

**来自文章：**

> 切换到应用程序，比如单击其任务栏按钮或 Alt+Tab'ing 到它。然后按 Alt+Space 调出系统菜单：您应该会在屏幕边缘看到一个浮动窗口。键入 M 选择移动，然后按箭头键进入移动模式。

@WebSolProv 的补充说明：

> 似乎 IE 发生了一些事情，导致开发人员工具窗口缩小到标题栏的高度和大约 2 英寸的宽度。通过使用此解决方案，您可以像往常一样将窗口移动到视图中并放大。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2010-03-19T00:48:02.060

如果您使用的是 Windows 7，Windows 键 + 向上箭头键将最大化窗口。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-03-09T11:28:20.877

与窗口问题无关，但在某些公司中，这可能是由于政策。在这种情况下，至少对我来说，它在像这样修改注册表后起作用

`HKEY_LOCAL_MACHINE > SOFTWARE > POLICIES > MICROSOFT > INTERNET EXPLORER > IEDEVTOOLS`

然后将 DISABLED 值修改为 0，之前对我来说是 1。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-04-22T02:08:58.727

当我在设置双显示器后回到单显示器设置时，我在 Windows 7 上遇到了同样的问题。

使用 Windows 7 键盘快捷键在屏幕上移动窗口。您可能需要重复相同的组合两次。

Windows 键 + 左箭头

或者

Windows 键 + 右箭头

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-03-28T13:11:53.680

删除一些注册表项对我有用。尝试在提示符下运行它

reg delete "hkcu\software\microsoft\internet explorer\iedevtools" /v windowpos

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-10T09:31:30.790

通过开发工具窗口选择，`ALT+TAB`然后按`ALT+SPACE`显示窗口菜单并选择`Maximize`或键入`'X'`字符。Winow 将出现。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-01T18:48:49.667

如果窗口离开页面并且光标无法到达，您可以随时右键单击任务栏中的程序，单击`Move`然后您可以使用箭头键将窗口移回视图

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-12T19:09:03.770

对我来说，菜单项“工具 > 开发人员工具”和 F12 不会做任何事情，但是命令栏“工具”下拉菜单和命令栏图标一样有效。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-01-08T09:43:52.433

运行IE并按F12，任务栏中出现窗口。右键单击任务栏并选择最大化。沃拉！！它会出现

# c++ - 图形分析

> ID：852254
> 
> 赞同：6
> 
> 时间：2009-05-12T11:20:12.993
> 
> 标签：c++, graphics, profiling, direct3d

我有一个应用程序下降到 10fps 左右。我使用 xperf 对其进行了分析，结果显示我的应用程序只使用了 20% 的 CPU，而我的任何方法都没有使用超过预期的 20%。

这似乎表明 fps 的大幅下降是因为显卡无法跟上渲染帧的速度，导致我的程序在赶上时停止......

有什么方法可以分析显卡的功能并计算出我的程序告诉它做什么来减慢它的速度，以便我可以尝试提高帧速率？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T11:39:48.127

对于调试/分析图形，请尝试 Nvidia PerfHUD

> NVIDIA PerfHUD 是一款功能强大的 Direct3D 应用程序实时性能分析工具。

还有一个 ATI 解决方案，称为“GPU PerfStudio”

> GPU PerfStudio 是一种实时性能分析工具，旨在帮助调整 DirectX 9、DirectX 10 和 OpenGL 应用程序的图形性能。GPU PerfStudio 显示实时 API、驱动程序和硬件数据，这些数据可以使用极其灵活的绘图和条形图机制进行可视化。被分析的应用程序可以在本地或通过网络远程执行。GPU PerfStudio 允许开发人员实时覆盖关键渲染状态，以实现快速瓶颈检测。自动分析窗口可用于识别图形管道各个阶段的性能问题。使用 GPU PerfStudio 不需要特殊的驱动程序或代码修改。

您可以在此处找到更多信息和下载链接：

*   [http://developer.nvidia.com/object/nvperfhud_home.html](http://developer.nvidia.com/object/nvperfhud_home.html)
*   [http://developer.amd.com/tools-and-sdks/graphics-development/gpu-perfstudio/](http://developer.amd.com/tools-and-sdks/graphics-development/gpu-perfstudio/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T15:24:19.263

另外，请查看有关 FPS 的这篇文章：

[FPS 与帧时间](http://www.mvps.org/directx/articles/fps_versus_frame_time.htm)

基本上它谈到了这样一个事实，即从 200fps 下降到 190fps 可以忽略不计，而从 30fps 下降到 20fps 则要大得多。为了更好地测量性能，您应该计算帧时间而不是 FPS。

你从来没有告诉我们你的 fps 是什么或程序在做什么，所以你的“巨大下降”可能根本不是什么大问题。

对于 DirectX，有用于分析 CPU 和 GPU 操作的[PIX 。](http://msdn.microsoft.com/en-us/library/bb173085(VS.85).aspx)它可以提供非常详细的信息，可能值得研究。

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-27T16:27:38.260

您可以尝试使用 dxprof（在 google 中搜索）。它是一个轻量级的应用程序，可以实时绘制条形图，每个条形图对应一个 DirectX 事件（例如绘制调用或资源复制）。您可以冻结条形图并检查调用堆栈以找出绘图调用的来源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T11:29:30.637

你在为 Windows 开发吗？如果是这样，请避免使用 Video for Windows，因为这会限制您使用您描述的方式。请改用 DirectX。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T13:10:22.647

无需猜测。只需在 IDE 下[暂停几次](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)，它就会准确显示它在等待什么。

# php - MySQL 排序规则类型是否需要匹配 PHP 页面字符集类型？

> ID：852260
> 
> 赞同：3
> 
> 时间：2009-05-12T11:22:45.983
> 
> 标签：php, mysql, rss, character-encoding, collation

我已经开始调试我的 RSS 提要，因为它有一些奇怪的字符（即缺少字符的字形）。我从两个优秀的初学者资源开始：

*   每个软件开发人员绝对绝对必须了解 Unicode 和字符集：[http ://www.joelonsoftware.com/articles/Unicode.html](http://www.joelonsoftware.com/articles/Unicode.html)
*   字符集/字符编码问题：[http ://www.phpwact.org/php/i18n/charsets](http://www.phpwact.org/php/i18n/charsets)

我认为我们的 RSS 提要有问题的原因是用户将 MS Word 文档复制并粘贴到网站上的文本区域中，而我们的 PHP 页面使用的是与特殊的“Windows-1252”不兼容的“iso-8859-1”字符集MS Word 使用的项目符号和智能引号等内容的编码。

所以我希望解决这个问题，我需要做的就是在接受/提供用户输入的页面中开始使用“utf-8”？？即在 HEAD 部分设置以下内容：

```
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" /> 
```

不过，我提出这个问题的真正原因是因为存储用户输入的数据库字段位于“ `latin1_swedish_ci`”中，我想知道是否需要将它们转换为“ `utf8_general_ci`”？MySQL 并不真正关心字符集吗？它只看到一堆字节，如果我将 Unicode 放入一个整理为拉丁语的字段中，它仍然会以 Unicode 的形式出现，对吗？更改字段会很烦人，因为该字段是 FULLTEXT 索引的一部分，其中其他字段也需要更改其排序规则，这意味着删除索引并重建它（当涉及大量 TEXT 时，这不是一项小任务）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T12:42:23.463

> 不过，我提出这个问题的真正原因是因为存储用户输入的数据库字段位于“latin1_swedish_ci”中，我想知道是否需要将它们转换为“utf8_general_ci”？

不`latin1_swedish_ci`，并且`utf8_general_ci`是排序规则 - 不是字符集。排序规则不会影响字符存储或输入/输出的方式。它只控制排序函数如何对其结果进行排序。排序规则 - 按预期工作 - 应该与存储字符集匹配。因此，如果您的表存储在 utf8 中，则应使用 utf8 排序规则。

mysql 的存储字符集不直接绑定到 php 中的字符集。您可以使用 utf8 作为 Mysql 的存储字符集，而在 php.ini 中使用 iso-8859-1。`set names XXX`在这种情况下，您需要通过在连接 ( )上设置字符集来告诉 Mysql 。然后 Mysql 将根据需要进行转换。如果你不在 Mysql 和 php 上使用相同的字符集，你最终会得到作为最低 dommon 分母的字符集容量，所以即使字符串存储在 utf8 中，你也不会拥有完整的 unicode 字符范围可用的。因此，您应该在Mysql 和 php中*都*使用 utf8 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T20:57:25.813

为了节省一些时间来搜索如何使用 pdo/mysql 很好地更改 mysql 连接字符集，我是这样做的：

```
$dbc = new pdo('mysql:dbname=DBNAME;host=DBHOST', $user, $pw, array(PDO::MYSQL_ATTR_INIT_COMMAND => sprintf( "SET NAMES %s", $charset ) ) ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T11:36:12.797

不——绝对不是。由于 MySQL 具有动态将字符串从一个字符集转换为另一个字符集的能力，因此重要的是您的 MySQL 服务器知道您在客户端使用的字符集（客户端 = PHP 脚本，而**不是**访问您的客户端网页）。这可以通过发出查询来完成

```
SET NAMES 'utf8'; 
```

在您发送到服务器的任何其他查询之前。MySQL 然后会进行适当的转换，从您的客户端字符集到内部 MySQL 字符集到表和/或列字符集，然后一直返回。所以通常你只需要担心设置正确的客户端字符集。此字符集必须与您用于将数据输出到网络服务器的字符集匹配。

请查看 MySQL 手册：

*   [9.1.4。连接字符集和排序规则](http://dev.mysql.com/doc/refman/5.0/en/charset-connection.html)
*   或[9.1。一般字符集支持](http://dev.mysql.com/doc/refman/5.0/en/charset.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T11:46:11.303

在 HTTP 中，字符编码由HTTP 响应的[标头字段](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17)`charset`中的参数声明。[其他声明被 HTTP 标头中的声明覆盖](http://www.w3.org/TR/html401/charset.html#h-5.2.2)：[`Content-Type`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17)

> [...] 用户代理在确定文档的字符编码时必须遵守以下优先级（从最高优先级到最低优先级）：
> 
> 1.  " " 字段中的 HTTP " `charset`" 参数`Content-Type`。
> 2.  `META`带有“ ”的声明`http-equiv`设置为“ `Content-Type`”，并为“”设置了一个值`charset`。
> 3.  `charset`在指定外部资源的元素上设置的属性。

此外，您应该使用元素中的[`accept-charset`属性](http://www.w3.org/TR/html401/interact/forms.html#adef-accept-charset)显式声明接受的字符编码。`form`否则，用户代理可以（但不能）采用表单文档中使用的字符编码来对输入数据进行编码：

> 此属性的默认值是保留字符串“UNKNOWN”。用户代理可以将此值解释为用于传输包含此`FORM`元素的文档的字符编码。

这应该为您提供正确编码传入数据的最佳机会。但它没有保证。所以最好检查数据是否用 UTF-8 进行了精确编码（有函数/算法可以做到这一点）。

# oracle - 如何使用 Oracle PL/SQL Developer 创建转储？

> ID：852261
> 
> 赞同：11
> 
> 时间：2009-05-12T11:24:11.100
> 
> 标签：oracle, plsqldeveloper

我需要将用户（包括表、过程等）转储为`FILENAME.dmp`.

如果我创建一个新用户并导入它`FILENAME.dmp`，那么应该创建所有内容。

如何创建此转储文件？

不要告诉我使用`Run > EXP`or`Run > IMP`功能，因为由于某些问题，该功能对我不起作用。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-12T12:37:31.090

EXP（导出）和 IMP（导入）是您需要的两个工具。最好尝试在命令行和同一台机器上运行这些。

*它可以远程运行，您只需要`TNSNAMES.ORA`正确设置并安装与数据库相同版本的所有开发人员工具。在不知道您遇到的错误消息的情况下，我无法帮助您让 exp/imp 正常工作。*

导出单个用户的命令：

```
exp userid=dba/dbapassword OWNER=username DIRECT=Y FILE=filename.dmp 
```

这将创建导出转储文件。

要将转储文件导入不同的用户模式，首先在**SQLPLUS**中创建新用户：

```
SQL> create user newuser identified by 'password' quota unlimited users; 
```

然后导入数据：

```
imp userid=dba/dbapassword FILE=filename.dmp FROMUSER=username TOUSER=newusername 
```

*如果有大量数据，则调查增加`BUFFERS`或查看 expdp/impdp*

*exp 和 imp 最常见的错误是设置错误。检查您的`PATH`包含`$ORACLE_HOME/bin`，检查`$ORACLE_HOME`是否设置正确并且检查`$ORACLE_SID`是否设置*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-19T12:50:42.453

只是为了保持最新：

当前版本的 SQLDeveloper 有一个导出工具`Tools > Database Export`（

如果您习惯于在 GUI 环境中工作，那么它的设置和使用要容易得多`exp`，`imp`但如果您需要使用它来编写任何脚本，它就没有那么通用了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-25T21:22:18.767

就像更新一样，这也可以通过使用 Toad 9 来完成。转到数据库>导出>数据泵导出向导。在目标目录窗口中，如果您在下拉列表中找不到任何目录，那么您可能必须创建一个目录对象。

```
CREATE OR REPLACE DIRECTORY data_pmp_dir_test AS '/u01/app/oracle/oradata/pmp_dir_test'; 
```

请参阅此[示例](http://fundapass.blogspot.in/2012/09/exporting-dump-using-data-pump-utility.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-19T14:41:23.510

**制作表、用户和程序**的**转储文件**有一些简单的步骤：

 **> 转到 sqlplus 或任何 sql*plus `connect by your username or password`

1.  现在输入host，它看起来像SQL>host。
2.  现在键入“exp”表示导出。
3.  它要求您输入用户名和密码，并提供您要制作转储文件的用户的用户名和密码。
4.  现在按 Enter。
5.  现在导出文件的选项闪烁：EXPDAT.DMP>_（给您想要制作转储文件的位置的路径和文件名，例如 e:\FILENAME.dmp），然后按 Enter
6.  选择“整个数据库”或“表”或“用户”选项，然后按 Enter
7.  再次按 Enter 2 次表数据并压缩范围
8.  输入表的名称，就像我想让表学生的 dmp 文件存在一样，所以输入学生并按 Enter
9.  输入退出现在您给定路径的文件是转储文件现在导入该dmp文件以获取所有表数据。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-12T12:23:39.303

导出（或数据泵，如果你有 10g/11g）是这样做的方法。为什么不问如何解决你的问题，而不是试图找到另一种方法呢？

# c# - 判断您的代码是在客户端还是服务器上执行的最简单和最有效的方法是什么？

> ID：852266
> 
> 赞同：0
> 
> 时间：2009-05-12T11:25:53.093
> 
> 标签：c#, asp.net

我有一个在客户端和服务器上都使用的 ASP.NET (C#) 类。

根据代码是在客户端还是服务器上执行，它需要表现不同。

判断代码是在客户端还是服务器上执行的最简单和最有效的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T11:27:06.117

除非您正在运行 Silverlight 2 或 Silverlight 3 Asp.Net 无法在客户端（用户的浏览器）中运行 C# 代码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T11:27:19.673

它在服务器上执行。除非您使用 Silverlight，否则 C# 可能不会在客户端上运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T11:28:30.373

除非我们在这里讨论 Silverlight，否则没有太多选择：C# 代码始终在服务器上执行，JavaScript 在客户端上执行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T11:28:39.547

通过您的标签，我看到您谈论的是 Web 应用程序，而不是客户端-服务器 winforms 应用程序。

如果它是在 javascript、html 和 css 或 silverlight 中，它会在浏览器中发生。如果它发生在 C# 中，它就会发生在服务器上。

# sql-server - 使用 dbml 将数据库值映射到 TimeSpan

> ID：852267
> 
> 赞同：1
> 
> 时间：2009-05-12T11:25:57.460
> 
> 标签：sql-server, linq, linq-to-sql, timespan

我需要在数据库列中存储时间偏移量（例如，12:25 AM，只是时间，没有日期）。

我想使用 Visual Studio 2008 中出色的数据可视化建模功能来生成 dbml 和与之配套的代码。数据库是 Sql Server 2005。

由于 TimeSpan 本质上是一个包含刻度数的 Int64（又名 long），因此我尝试将其存储在数据库中。

但是，如果我指定该列应映射到 TimeSpan 类型的属性，Visual Studio 报告：

> 警告：自定义工具“MSLinqToSQLGenerator”失败。未指定的错误

为了解决这个问题，我将数据库值映射到一个内部属性，并添加了一个部分类，该类实现了将整数值从数据库转换为 TimeSpan 并返回的属性访问器。

有没有办法为此属性生成正确的代码？或者有没有更好的方法将时间跨度存储在 SqlServer 2005 数据库中，以便使用 dbml 更轻松地访问？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-03-19T10:40:38.000

前段时间也遇到过这个问题。

据我了解，没有直接的解决方案`SQL Server 2005`，所以我使用了一个技巧：

类型的数据库中有`Duration`列（实际上应该存储 .NET`TimeStamp`数据类型）`BigInt NOT NULL`。这是 dbml 定义：

```
<Column Name="Duration" 
    Member="DurationInternal" 
    AccessModifier="Protected" 
    Type="System.Int64" 
    DbType="BigInt NOT NULL" 
    CanBeNull="false" /> 
```

我将这个类属性设置为`protected`这意味着我不希望我的类的用户直接访问这个属性并`public`在部分类中为这个属性创建一个包装器：

```
 #region Properties
    /// <summary>
    /// Gets or sets the audio duration.
    /// </summary>
    /// <value>The duration.</value>
    public TimeSpan Duration
    {
        get
        {
            return TimeSpan.FromTicks(this.DurationInternal);
        }
        set
        {
            this.DurationInternal = value.Ticks;
        }
    }
    #endregion 
```

所以我班的用户有一个易于使用的属性，而不是大量的`long`转换`TimeSpan`。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T15:37:20.827

我以前尝试过这样做，但失败了。我发现即使我没有在数据库中使用 DateTime 的 Date 部分，我发现将整个 Date 和 Time 提交到数据库允许我提供所需的时间的所有功能。

您可以使用 ToShortTimeString() 仅显示应用程序中的时间。如果需要，将完整日期与时间结合起来可以让您进行真正的时间计算，例如确定开始时间和停止时间之间的时间跨度。因为与时间跨度有关的滴答包括日期，所以没有理由费心将时间存储在数据库中。

我知道这并不是您真正希望的，但可能是满足您需求的最简单的解决方案，这来自于我在尝试做同样的事情时的数小时撞击经验。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-22T09:18:50.317

您可以将 TimeSpan 数据类型映射到 Sql 'Time' 数据类型（从而避免任何讨厌的实现问题）。但是必须满足以下要求：

1.  您的代码库必须在 .Net 3.5 sp1 上运行
2.  Sql 数据库必须在 Sql 2008 上运行（TIME 数据类型仅在 2008 中可用）。

为了澄清，请阅读：http: [//msdn.microsoft.com/en-us/library/bb882662.aspx](http://msdn.microsoft.com/en-us/library/bb882662.aspx)

# python - 有人成功采用了 JaikuEngine 吗？

> ID：852268
> 
> 赞同：6
> 
> 时间：2009-05-12T11:26:33.933
> 
> 标签：python, google-app-engine

JaikuEngine 在 Google App Engine 上是否有现实世界的改编？（来自我老板的问题，想用它而不是编写我们自己的系统）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-27T05:42:16.693

这是在 AppEngine 上运行的 jaikuengine - [https://jaiku.appspot.com/](https://jaiku.appspot.com/) 如果您希望拥有自己的 jaiku 版本，它非常简单。看看这个 - [http://code.google.com/p/jaikuengine/](http://code.google.com/p/jaikuengine/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-24T09:32:47.213

虽然我喜欢 App-Engine。您的解决方案是否需要托管在 AppEngine 上？如果不是，我会查看基于开源[Laconi.ca的](http://identi.ca)[identi.ca](http://laconi.ca/trac/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T13:54:31.203

[http://www.jaiku.com/](http://www.jaiku.com/)算不算？

# c# - 如何将 IDN 转换为 ASCII？

> ID：852274
> 
> 赞同：12
> 
> 时间：2009-05-12T11:28:21.933
> 
> 标签：c#, .net, idn

[将国际化域名](http://en.wikipedia.org/wiki/Internationalized_domain_name)转换为其 ASCII 格式的最佳方法是什么？

我想通过使用某种（免费）.net 代码转换**`Bücher.ch`**成。**`xn--bcher-kva.ch`**

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2010-11-04T20:45:34.613

```
using System.Globalization;
...
IdnMapping idn = new IdnMapping();
MessageBox.Show(idn.GetAscii("www.kraków.pl")); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-10T09:25:59.530

从 xn--bcher-kva.ch 域到 Bücher.ch 的另一种方式

```
using System.Globalization;
...
IdnMapping idn = new IdnMapping();
MessageBox.Show(idn.GetUnicode("xn--bcher-kva.ch")); 
```

您将获得 www.kraków.pl 作为结果。因为我来这里是为了找这个:)希望它对其他人也有帮助:)

[MSDN](http://msdn.microsoft.com/en-us/library/bx1d9321%28v=vs.110%29.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T11:34:27.573

查看[GNU IDN 库 - Libidn](http://www.gnu.org/software/libidn/)。介绍说 C# 库是可用的。

# c# - 如何确定两个文件系统 URI 是否指向同一个资源？

> ID：852275
> 
> 赞同：3
> 
> 时间：2009-05-12T11:28:25.397
> 
> 标签：c#, .net, io

如果我有两个不同的文件路径，我如何确定它们是否指向同一个文件？

例如，如果用户连接了指向某个网络资源的网络驱动器，则可能是这种情况。例如驱动器 S: 映射到 \servercrm\SomeFolder。

然后这些路径实际上指向同一个文件：

```
S:\somefile.dat 
```

和

```
\\servercrm\SomeFolder\somefile.dat 
```

我怎样才能检测到这个？我需要对其进行编码，使其适用于路径可能以不同方式指向同一个文件的所有场景。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T11:48:55.973

我不知道是否有一种简单的方法可以直接在 C# 中执行此操作，但您可以对[GetFileInformationByHandle （](http://msdn.microsoft.com/en-us/library/aa364952(VS.85).aspx)[此处](http://www.pinvoke.net/default.aspx/kernel32/GetFileInformationByHandle.html)为pinvoke 页面）进行非托管调用，该调用将返回[BY_HANDLE_FILE_INFORMATION](http://msdn.microsoft.com/en-us/library/aa363788(VS.85).aspx)结构。这包含三个字段，可以组合起来唯一标识一个文件：

> dwVolumeSerialNumber：包含文件的卷的序列号。
> 
> ...
> 
> nFileIndexHigh：与文件关联的唯一标识符的高位部分。
> 
> nFileIndexLo：与文件关联的唯一标识符的低位部分。
> 
> 标识符（低位和高位）和卷序列号唯一标识单台计算机上的文件。要确定两个打开的句柄是否代表同一个文件，请将每个文件的标识符和卷序列号组合起来并进行比较。

请注意，这仅在两个引用都是从同一台机器声明的情况下才有效。

* * *

编辑添加：

根据[这个问题](https://stackoverflow.com/questions/410705/best-way-to-determine-if-two-path-reference-to-same-file-in-c)，这可能不适用于您的情况，因为 dwVolumeSerialNumber 可能不同，因为共享定义不同。不过我会先尝试一下，因为我一直认为卷序列号是特定于驱动器的，而不是特定于路径的。不过，我从来不需要真正证明这一点，所以我可能（而且可能是）错了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T11:36:17.537

至少您可以获取并比较组合文件内容、文件名和元数据（例如 CreationTime、LastAccessTime 和 LastWriteTime）的 MD5 哈希值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T12:31:20.593

如果您只担心本地文件，那么您可以使用 GetFileInformationByHandle 和`BY_HANDLE_FILE_INFORMATION`结构的组合。Lucian 在这里写了一篇关于这个主题的优秀博文。代码在 VB.Net 中，但应该很容易转换为 C#

*   [http://blogs.msdn.com/vbteam/archive/2008/09/22/to-compare-two-filenames-lucian-wischik.aspx](http://blogs.msdn.com/vbteam/archive/2008/09/22/to-compare-two-filenames-lucian-wischik.aspx)

# linq - LINQ to objects 改变显示列

> ID：852279
> 
> 赞同：0
> 
> 时间：2009-05-12T11:28:56.583
> 
> 标签：linq, object

希望一些可以帮助 -

我的 web 服务返回一个带有某些字段的对象，我使用 ling 来反对显示，然后将匿名类型绑定到网格。是否可以进行类似的选择以更改网格列的显示？

例如

```
 Dim wsr As wsTest.Service = New wsTest.Service

        Dim objs() As wsTest.Person

        objs = wsr.GetPersons

        Dim q = From a In objs _
                Select a.Manifest, a.Id

        Me.DataGridView1.DataSource = q.ToArray 
```

我想更改它，以便我得到“选择 a.manifest 作为'newID'，a.id 作为'标识符'

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T11:36:17.943

试试这个 ：

```
Dim q = From a In objs _
        Select newId = a.Manifest, identifier = a.Id 
```

# ruby-on-rails - Ubuntu：“在本地或存储库中找不到导轨”

> ID：852280
> 
> 赞同：3
> 
> 时间：2009-05-12T11:29:11.200
> 
> 标签：ruby-on-rails, ubuntu

我正在按照[这些说明](https://help.ubuntu.com/community/RubyOnRails)在我的 Ubuntu 机器上设置 Ruby on Rails。至少现在，我打算使用 Mongrel。

当我到达这一步时：

```
sudo gem install rails 
```

...我收到这条消息：

```
批量更新 Gem 源索引：http://gems.rubyforge.org/
错误：在本地或存储库中找不到导轨

```

接下来我该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T11:58:41.710

我会先尝试更新宝石。最新版本是 1.3.3。您可以通过以下任一方式在 Ubuntu 上执行此操作：

```
sudo gem install rubygems-update
sudo update_rubygems 
```

或者

```
sudo gem install rubygems-update
cd /var/lib/gems/1.8/gems/rubygems-update-*
sudo ruby setup.rb 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T21:30:49.947

基本上，再试一次！这可能是一个严重的错误，但在早期版本中（我大约在 1 年前左右遇到过这个问题）它发生在第一次尝试时，当再次尝试时最终会找到 gem。我认为这与服务器性能等有关。

使用最新版本的 ruby​​gems 可能是个好主意，如果它真的不起作用，您总是可以直接从 sourceforge 获取 .gem 文件并从中安装。

例如文件[rails-2.3.2.gem](http://rubyforge.org/frs/download.php/53271/rails-2.3.2.gem)：

```
gem install rails-2.3.2 –local 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T17:06:00.440

gem install rails --source [http://gems.rubyonrails.org](http://gems.rubyonrails.org)

# c# - 尽管有 WWWfilter，IIS7 部署的 MVC 不会重定向

> ID：852281
> 
> 赞同：0
> 
> 时间：2009-05-12T11:29:11.823
> 
> 标签：c#, asp.net-mvc, iis-7

我的所有操作都有一个 WWW 过滤器

```
public class WwwFilter : ActionFilterAttribute, IActionFilter {

    #region IActionFilter Members

    void IActionFilter.OnActionExecuted(ActionExecutedContext filterContext) {

    }

    void IActionFilter.OnActionExecuting(ActionExecutingContext filterContext) {

        var request = filterContext.HttpContext.Request;
        var response = filterContext.HttpContext.Response;

        if (request.Url.Host.StartsWith("www")) {
            string newPort = request.Url.IsDefaultPort ? "" : ":" +request.Url.Port.ToString();
            string newUrl = request.Url.Scheme + "://" +request.Url.Host.Replace("www.", "") + newPort + request.Url.AbsolutePath;
            filterContext.Result = new RedirectResult(newUrl);

        }
    }

    #endregion
} 
```

对于我的网站，[http://www.tweetMP.org.au](http://www.tweetMP.org.au)

没有为主页或其他一些页面过滤掉 www

如果您使用菜单访问站点，最终 www 将随着过滤器的启动而消失。

我不知道为什么会这样。有任何想法吗？

更新：这似乎与我正在执行的每个操作中的 OutputCache 有关。在中等信任环境中进行 WWW 过滤的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-21T19:18:52.657

我会考虑使用内置的[IIS7 URL Rewrite Module](http://learn.iis.net/page.aspx/460/using-url-rewrite-module/)对重定向的支持。此外，它也可能在客户端浏览器中缓存...如果您执行强制刷新（Shift+F5），重定向是否有效？

除此之外，如果您想在图像、脚本和 css 的子域中进行性能优化，您可能希望保留 www. 由于 cookie 设置为父域 (mydomain.ext)，因此也会发送到子域 (images.mydomain.ext)。

# flash - f4p flash 视频格式

> ID：852283
> 
> 赞同：0
> 
> 时间：2009-05-12T11:29:17.987
> 
> 标签：flash, actionscript-3, video

.f4v 和 .f4p flash 视频格式有什么区别。我在 Adob​​e 网站上找到的唯一信息是 f4p 是“Flash Player 的受保护媒体”。那么我的问题是：它是如何保护的？那是什么类型的保护？编码方式？真的什么都...

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T11:55:24.797

查看此处 ( [PDF](http://www.adobe.com/devnet/flashmediaserver/articles/protecting_video_fms.pdf) )，这是一份关于使用 Flash Media Server 的视频保护和 DRM 解决方案的白皮书。

Flash 播放器本身虽然可以播放 f4p，但我相信它只是提供提取和修改保护，但不提供 DRM 解决方案。

# asp.net - 服务器端/客户端或两者用户输入验证

> ID：852287
> 
> 赞同：2
> 
> 时间：2009-05-12T11:30:33.367
> 
> 标签：asp.net, validation

当我想给人们客户端“帮助”验证（例如密码不够长，电子邮件格式不正确，但也进行服务器端验证并返回错误（例如用户名已经存在并且有）时，在您的网站上使用验证的最佳方法是什么？客户端和服务器验证消息在视觉上以最少的重复向用户显示相同的信息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T11:32:37.233

可以轻松绕过客户端验证。无论客户端验证如何，您**都应该始终验证服务器上的敏感数据。**在客户端上验证它们也只是改善用户体验的问题。

顺便说一句，ASP.NET 验证控件两者兼而有之。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T11:41:28.590

最好的混合解决方案通常是集中您的验证服务器端并依赖客户端调用服务器端的东西。这有很多优点：

*   您只需在服务器上编写一次验证代码。
*   可以绕过客户端验证，但这没关系；无论如何，服务器正在检查所有内容。
*   您无需或只需很少的额外开发成本即可获得改进的用户体验。

The primary disadvantage is that you pay twice as much for validation processing, but that's not too harsh.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T11:39:11.793

您无法确定是否真的发生了诸如客户端验证之类的事情。如果 javascript 在客户端不可用（无脚本或禁用 JavaScript），它永远不会运行。在任何进一步处理之前回发时，您应该使用以下代码在页面上调用 validate 方法：

```
if(!IsValid)
{
    //inform your user about error(s)
    return;
}

//do further processing 
```

如果您有验证组，那么您可以使用组名调用 validate 方法：

```
if!(Validate("groupName"))
{
    //inform your user about error(s)
    return;
}

//do further processing 
```

* * *

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T11:44:02.793

The best way would be to use the ASP.NET validation controls to present the simple 'hints' as the client (as mentioned by Mehrdad these will provide client and server side validation) and then use CustomValidators for the elements that need server interactions such as verifying usernames, etc.

# asp.net - 关于加密的建议

> ID：852297
> 
> 赞同：0
> 
> 时间：2009-05-12T11:35:52.843
> 
> 标签：asp.net, vb.net, encryption

我有一个名为 tdes 的类，它看起来像这样：

```
Imports Microsoft.VisualBasic
Imports System
Imports System.Collections.Generic
Imports System.Text
Imports System.Security.Cryptography
Imports System.IO

Namespace security
    Public Class tdes
        Private des As New TripleDESCryptoServiceProvider()
        Private utf8 As New UTF8Encoding()

    Private keyValue As Byte()
    Private iVValue As Byte()

    Public Property Key() As Byte()
        Get
            Return keyValue
        End Get
        Set(ByVal value As Byte())
            keyValue = value
        End Set
    End Property

    Public Property iV() As Byte()
        Get
            Return iVValue
        End Get
        Set(ByVal value As Byte())
            iVValue = value
        End Set
    End Property

    Public Sub New(ByVal key As Byte(), ByVal iV As Byte())
        Me.keyValue = key
        Me.iVValue = iV
    End Sub

    Public Function ByteDecrypt(ByVal bytes As Byte()) As String
        Dim output As Byte()
        output = Transform(bytes, des.CreateDecryptor(Me.keyValue, Me.iVValue))
        'Return Convert.ToBase64String(output)
        Return utf8.GetString(output)
    End Function

    Public Function ByteEncrypt(ByVal bytes As Byte()) As Byte()
        Return Transform(bytes, des.CreateEncryptor(Me.keyValue, Me.iVValue))
    End Function

    Public Function StringDecrypt(ByVal text As String) As String
        Dim input As Byte() = Convert.FromBase64String(text)
        Dim output As Byte() = Transform(input, des.CreateDecryptor(Me.keyValue, Me.iVValue))
        Return utf8.GetString(output)
    End Function

    Public Function StringEncrypt(ByVal text As String) As String
        Dim input As Byte() = utf8.GetBytes(text)
        Dim output As Byte() = Transform(input, des.CreateEncryptor(Me.keyValue, Me.iVValue))
        Return Convert.ToBase64String(output)
    End Function

    Public Function StringEncryptByte(ByVal text As String) As Byte()
        Dim input As Byte() = utf8.GetBytes(text)
        Dim output As Byte() = Transform(input, des.CreateEncryptor(Me.keyValue, Me.iVValue))
        'Return Convert.ToBase64String(output)
        Return output
    End Function

    Private Function Transform(ByVal input As Byte(), ByVal cryptoTransform As ICryptoTransform) As Byte()
        ' Create the necessary streams
        Dim memory As New MemoryStream()
        Dim stream As New CryptoStream(memory, cryptoTransform, CryptoStreamMode.Write)

        ' Transform the bytes as requesed
        stream.Write(input, 0, input.Length)
        stream.FlushFinalBlock()

        ' Read the memory stream and convert it back into byte array
        memory.Position = 0
        Dim result As Byte() = New Byte(memory.Length - 1) {}
        memory.Read(result, 0, result.Length)

        ' Clean up
        memory.Close()
        stream.Close()

        ' Return result
        Return result
    End Function

    End Class
End Namespace 
```

它可以很好地加密和解密事物。我想加密数据库表中的一些现有密码，所以我在它们上运行了一个小脚本，像这样加密它们（为简洁起见，缺少很多）：

```
Dim key As Byte() = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24}
Dim iv As Byte() = {8, 7, 6, 5, 4, 3, 2, 1}
Dim enc As New security.tdes(key, iv)
Dim i As Integer = 0

Using oConn As New SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings("pitstopConnectionString").ConnectionString)
    Using cmd As New SqlCommand("doUpdatePasswords", oConn)
        cmd.CommandType = CommandType.StoredProcedure
        cmd.Parameters.AddWithValue("@userid", userid)
        cmd.Parameters.AddWithValue("@newpassword", enc.StringEncryptByte(currentPassword))
        oConn.Open()
        Try
            i = cmd.ExecuteNonQuery()
        Catch ex As Exception
            Exit Sub
        End Try
    End Using
End Using 
```

这已成功加密表中所有记录的所有密码。现在，当我允许某人登录时，我想比较这两个值（输入的内容，存储的密码是什么），我认为最好的方法是解密存储的内容并使用字符串进行比较？像这样：

```
If (enc.ByteDecrypt(pwdenc).ToString() = pitstop.doMakeSafeForSQL(txtPassword.Text.ToString.ToLower)) Then 
```

但是，我得到了各种奇怪的错误；无法将“System.String”类型的对象转换为“System.Byte[]”类型。是一个，Base-64 字符串中的无效字符。另一个基于我在前面的 SQLDataReader 中如何调用密码：

```
 Using oConn As New SqlConnection(System.Configuration.ConfigurationManager.ConnectionStrings("pitstopConnectionString").ConnectionString)
     Using cmd As New SqlCommand("doGetEncryptedForLogin", oConn)
         cmd.CommandType = CommandType.StoredProcedure
         cmd.Parameters.AddWithValue("@email", pitstop.doMakeSafeForSQL(txtEmail.Text.ToString.ToLower))
         oConn.Open()
         Using dr As SqlDataReader = cmd.ExecuteReader()
             If dr.HasRows() = True Then
                 While dr.Read()
                     pwdenc = dr("password_b")
                 End While
             Else
                 pitstop.doLogIt("Denied login for [" & txtEmail.Text & "]")
                 litError.Text = "The details you have provided are incorrect. Please try again."
                 pnlDenied.Visible = True
                 Exit Sub
             End If
             dr.Close()
         End Using
     End Using
 End Using 
```

欢迎帮助或建议，因为我在这里很难过......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T13:47:44.610

由于似乎没有其他人回答，我会给你我自己的两分钱。我记得三年多前我开始“玩”加密时也经历过类似的情况。在我的情况下，问题与 Base64 转换有关，但我现在不记得确切的细节了。我建议您通过一个平静而耐心的调试会话，跟踪加密和解密之前和之后的字符串、字节数组的所有值。我知道这不是一个很大的帮助，但我希望至少可以引导您朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T11:15:02.717

我通过用 Jeff Atwood (www.codinghorror.com) 出色的加密工具替换我的“加密”类来修复这个错误。

我确实想给密码加盐并存储盐，但是我没有时间来实现它，并且必须返回它。同时，我已将此代码用作我的加密和解密功能 - 我希望这对某人有所帮助：

```
 Dim key As String = System.Configuration.ConfigurationManager.AppSettings("key").ToString()
    Dim salty As String = pitstop.doMakeSafeForSQL(txtEmail.Text.ToString().ToLower())
    Dim p As Encryption.Symmetric.Provider = Encryption.Symmetric.Provider.TripleDES
    Dim sym As New Encryption.Symmetric(p)
    sym.Key.Text = key

    Dim encryptedData As Encryption.Data
    encryptedData = sym.Encrypt(New Encryption.Data(pitstop.doMakeSafeForSQL(txtPassword.Text.ToString().ToLower()))) 
```

解密：

```
 Dim decryptedData As Encryption.Data
    Dim pr As Encryption.Symmetric.Provider = Encryption.Symmetric.Provider.TripleDES
    Dim sym2 As New Encryption.Symmetric(pr)
    sym2.Key.Text = System.Configuration.ConfigurationManager.AppSettings("key").ToString()

    Try
        decryptedData = sym2.Decrypt(encryptedData)
    Catch ex As Exception
// removed for brevity //
        End Try 
```

如果有人对如何创建、存储和检索加盐密码有任何文章或建议，我很乐意看到。

克里斯

# visual-studio-2008 - Visual Studio (2008) 不生成文档 xml

> ID：852306
> 
> 赞同：4
> 
> 时间：2009-05-12T11:38:14.790
> 
> 标签：visual-studio-2008, documentation

我在 Visual Studio 2008 中有一个 C# dll 项目。在项目属性页的 Build 选项卡上，选中了复选框“XML Documentation File”。路径是 'bin\Debug\Fusion.BusinessObjects.XML' 但是，在构建解决方案时，不会创建任何 xml 文件。

我在许多其他项目中都引用了这个 dll，其中一个项目有一份 XML 文档文件的副本。然而，这仅包含：

```
<?xml version="1.0"?>
<doc>
    <assembly>
        <name>Fusion.BusinessObjects</name>
    </assembly>
    <members>
    </members>
</doc> 
```

为什么没有生成文档文件？不用说，代码记录在注释中，例如

```
/// <summary>
/// Helper class to construct a EntityCollection
/// </summary> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T11:49:03.633

前段时间发生在我身上，我纠正问题的方法是从头开始重新创建项目文件并从干净的文件夹结构开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T11:40:38.357

您确定为调试版本设置了该复选框吗？默认情况下，它仅在发布版本上生成。您可能想尝试发布版本并查看是否生成了版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T11:41:31.633

对于不同的构建配置（调试/发布），“XML 文档文件”设置可以有不同的值。您是否可能已将其设置为调试（例如）但正在进行发布构建（反之亦然）..？

# java - 方法解析和调用如何在 Python 内部工作？

> ID：852308
> 
> 赞同：6
> 
> 时间：2009-05-12T11:39:13.510
> 
> 标签：java, python

方法调用如何在 Python 中工作？我的意思是，python 虚拟机如何解释它。

确实，Python 中的 Python 方法解析可能比 Java 中的要慢。什么是后期绑定？

这两种语言的反射机制有什么区别？在哪里可以找到解释这些方面的好资源？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-15T20:10:24.007

Python 中的方法调用由两个不同的可分离步骤组成。首先完成属性查找，然后调用该查找的结果。这意味着以下两个片段具有相同的语义：

```
foo.bar()

method = foo.bar
method() 
```

Python 中的属性查找是一个相当复杂的过程。假设我们正在查找对象*obj上名为**attr*的属性，这意味着 Python 代码中的以下表达式：*obj.attr*

 **首先在*obj*的实例字典中搜索“attr”，然后按方法解析顺序在*obj*类的实例字典及其父类的字典中搜索“attr”。

通常，如果在实例上找到一个值，则返回该值。但是，如果对类的查找产生一个同时具有 __get__ 和 __set__ 方法的值（准确地说，如果对值类和父类的字典查找具有这两个键的值），那么类属性被视为某种东西称为“数据描述符”。这意味着调用该值的 __get__ 方法，传入发生查找的对象并返回该值的结果。如果未找到类属性或不是数据描述符，则返回实例字典中的值。

如果实例字典中没有值，则返回来自类查找的值。除非它碰巧是一个“非数据描述符”，即它有 __get__ 方法。然后调用 __get__ 方法并返回结果值。

还有一种特殊情况，如果*obj*恰好是一个类（类型*type*的实例），那么还会检查实例值是否是描述符并相应地调用它。

如果在实例及其类层次结构中没有找到值，并且*obj*的类有 __getattr__ 方法，则调用该方法。

下面显示了用 Python 编码的算法，有效地执行了 getattr() 函数将执行的操作。（不包括任何已经滑入的错误）

```
NotFound = object() # A singleton to signify not found values

def lookup_attribute(obj, attr):
    class_attr_value = lookup_attr_on_class(obj, attr)

    if is_data_descriptor(class_attr_value):
        return invoke_descriptor(class_attr_value, obj, obj.__class__)

    if attr in obj.__dict__:
        instance_attr_value = obj.__dict__[attr]
        if isinstance(obj, type) and is_descriptor(instance_attr_value):
            return invoke_descriptor(instance_attr_value, None, obj)
        return instance_attr_value

    if class_attr_value is NotFound:
        getattr_method = lookup_attr_on_class(obj, '__getattr__')
        if getattr_method is NotFound:
            raise AttributeError()
        return getattr_method(obj, attr)

    if is_descriptor(class_attr_value):
        return invoke_descriptor(class_attr_value, obj, obj.__class__)

    return class_attr_value

def lookup_attr_on_class(obj, attr):
    for parent_class in obj.__class__.__mro__:
        if attr in parent_class.__dict__:
            return parent_class.__dict__[attr]
    return NotFound

def is_descriptor(obj):
    if lookup_attr_on_class(obj, '__get__') is NotFound:
        return False
    return True

def is_data_descriptor(obj):
    if not is_descriptor(obj) or lookup_attr_on_class(obj, '__set__') is NotFound :
        return False
    return True

def invoke_descriptor(descriptor, obj, cls):
    descriptormethod = lookup_attr_on_class(descriptor, '__get__')
    return descriptormethod(descriptor, obj, cls) 
```

你问的方法调用与所有这些描述符废话有什么关系？问题是，函数也是对象，它们恰好实现了描述符协议。如果属性查找在类上找到一个函数对象，它的 __get__ 方法将被调用并返回一个“绑定方法”对象。绑定方法只是函数对象的一个​​小包装器，它存储查找该函数的对象，并在调用时将该对象添加到参数列表中（通常对于用于方法的函数，*self*参数是） .

这是一些说明性代码：

```
class Function(object):
    def __get__(self, obj, cls):
        return BoundMethod(obj, cls, self.func)
    # Init and call added so that it would work as a function
    # decorator if you'd like to experiment with it yourself
    def __init__(self, the_actual_implementation):
        self.func = the_actual_implementation
    def __call__(self, *args, **kwargs):
        return self.func(*args, **kwargs)

class BoundMethod(object):
    def __init__(self, obj, cls, func):
        self.obj, self.cls, self.func = obj, cls, func
    def __call__(self, *args, **kwargs):
        if self.obj is not None:
             return self.func(self.obj, *args, **kwargs)
        elif isinstance(args[0], self.cls):
             return self.func(*args, **kwargs)
        raise TypeError("Unbound method expects an instance of %s as first arg" % self.cls) 
```

对于方法解析顺序（在 Python 中实际上是指属性解析顺序），Python 使用 Dylan 的 C3 算法。这里解释太复杂了，有兴趣的可以看[这篇文章](http://www.python.org/download/releases/2.3/mro/)。除非你正在做一些非常时髦的继承层次结构（你不应该这样做），否则知道查找顺序是从左到右，深度优先，并且在搜索该类之前搜索类的所有子类就足够了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T11:48:17.130

名称（方法、函数、变量）都是通过查看命名空间来解析的。命名空间在 CPython 中实现为`dict`s（哈希映射）。

当在实例命名空间 ( ) 中找不到名称时`dict`，python 会按照方法解析顺序 (MRO) 查找类，然后查找基类。

所有解析都是在运行时进行的。

您可以使用该[`dis`](http://docs.python.org/library/dis.html)模块来查看在字节码中是如何发生的。

简单的例子：

```
import dis
a = 1

class X(object):
    def method1(self):
        return 15

def test_namespace(b=None):
    x = X()
    x.method1()
    print a
    print b

dis.dis(test_namespace) 
```

打印：

```
 9           0 LOAD_GLOBAL              0 (X)
              3 CALL_FUNCTION            0
              6 STORE_FAST               1 (x)

 10           9 LOAD_FAST                1 (x)
             12 LOAD_ATTR                1 (method1)
             15 CALL_FUNCTION            0
             18 POP_TOP             

 11          19 LOAD_GLOBAL              2 (a)
             22 PRINT_ITEM          
             23 PRINT_NEWLINE       

 12          24 LOAD_FAST                0 (b)
             27 PRINT_ITEM          
             28 PRINT_NEWLINE       
             29 LOAD_CONST               0 (None)
             32 RETURN_VALUE 
```

所有`LOAD`s 都是命名空间查找。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T11:50:34.313

> 确实，Python 中的 Python 方法解析可能比 Java 中的要慢。什么是后期绑定？

后期绑定描述了特定语言的解释器或编译器如何决定如何将标识符映射到一段代码的策略。例如，考虑`obj.Foo()`用 C# 编写。当您编译它时，编译器会尝试找到被引用的对象并插入对`Foo`将在运行时调用的方法的位置的引用。所有这些*方法解析*都发生在编译时；我们说名称是“早期”绑定的。

相比之下，Python 绑定名称是“迟到的”。方法解析发生在*运行时*：解释器只是尝试找到`Foo`具有正确签名的引用方法，如果不存在，则会发生运行时错误。

> 这两种语言的反射机制有什么区别？

动态语言往往比静态语言具有更好的反射功能，而 Python 在这方面非常强大。尽管如此，Java 还是有相当广泛的方法可以了解类和方法的内部结构。尽管如此，您还是无法避开 Java 的冗长；你将在 Java 中编写比在 Python 中更多的代码来做同样的事情。请参阅[**`java.lang.reflect`**](http://java.sun.com/javase/6/docs/api/java/lang/reflect/package-summary.html)API。

# dependency-injection - 为什么我的 Ninject DI 应用程序失败并出现 ActivationException？

> ID：852309
> 
> 赞同：2
> 
> 时间：2009-05-12T11:39:42.027
> 
> 标签：dependency-injection, inversion-of-control, ninject

我是 IoC/DI 框架的新手。我正在尝试的第一个是 Ninject 框架。这看起来很简单，但我无法让我的控制台应用程序运行。我不断收到一个 ActivationException 说明：

```
"Error activating MainWindow: the StandardProvider returned an instance of type FutureRealisticDateManager, which is not compatible with the requested service.
Using default binding from MainWindow to FutureRealisticDateManager (via StandardProvider)
     declared by DateBindingModule.Load()
Activation path:
  1) active request for MainWindow
     from Program.Main()
     using default binding from MainWindow to FutureRealisticDateManager (via StandardProvider)
     declared by DateBindingModule.Load()" 
```

我的代码非常简单。这是我的程序文件...

```
class Program
{
    static void Main(string[] args)
    {
        IKernel k = new StandardKernel(new DateBindingModule());

        MainWindow mw = k.Get<MainWindow>();
        mw.Show();
        Console.ReadLine();
    }
} 
```

这是我的ninject绑定模块...

```
public class DateBindingModule : StandardModule
{
    public override void Load()
    {
        Bind<MainWindow>().To<FutureRealisticDateManager>();
    }
} 
```

这是接收注入类的类...

```
class MainWindow
{
    private IRealisticDateManager _d;

    [Inject]
    public MainWindow(IRealisticDateManager dateManager)
    {
        _d = dateManager;
    }

    public void Show()
    {
        Console.WriteLine("*** MainWindow [" + _d.GetRealisticDate().ToString() + "] ");
    }

} 
```

这是注入的实际类...

```
public class FutureRealisticDateManager : TestNinject.IRealisticDateManager
{
    public DateTime GetRealisticDate()
    {
        return DateTime.Now.AddDays(15);
    }
} 
```

最后是注入类应该实现的简单接口......

```
public interface IRealisticDateManager
{
    DateTime GetRealisticDate();
} 
```

谁能看到我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T11:57:37.177

它失败了，因为您的绑定不正确：

```
Bind<MainWindow>().To<FutureRealisticDateManager>(); 
```

`FutureRealisticDataManager`不继承自`MainWindow`. 相反，你应该写：

```
Bind<IRealisticDateManager>().To<FutureRealisticDateManager>(); 
```

`FutureRealisicDateManager`这告诉 Ninject 在请求时返回`IRealisicDateManager`。

这样，当您调用`k.Get<MainWindow>()`内核时，将注入`FutureRealisticDateManager`到构造函数中。

# sql-server - 如何在xp sp2机器上安装sqlserver2005评估

> ID：852319
> 
> 赞同：1
> 
> 时间：2009-05-12T11:43:26.057
> 
> 标签：sql-server, sql-server-2005

**复制**

> [https://serverfault.com/questions/7541/how-to-install-sqlserver2005-evaluation-on-xp](https://serverfault.com/questions/7541/how-to-install-sqlserver2005-evaluation-on-xp)

* * *

你好

我无法在 winXp service pack2 机器上安装 SQLSERVER2005 评估版。我收到错误，例如错误 87：dotnet framework 2.0 安装和参数不正确。

在运行 sqlserver 2005 设置之前，我手动安装了 .NET FRAMEWORK2.0 而不是 sqlserver2005 套件。

我的机器上也安装了 vs2003。

在sqlserver2005之前安装vs2003有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T04:53:09.037

当您运行 SQLServer 2005 的安装程序时，它所做的第一件事是检查系统上是否存在安装先决条件。安装程序的该部分应为 SQL Server 2005 安装合适的 .NET Framework 2.0 版本。请尝试安装框架作为安装 SQL 的先决条件。

# java - 如何从另一个 java 应用程序中运行 iReport-nb 3.xx？

> ID：852320
> 
> 赞同：0
> 
> 时间：2009-05-12T11:43:42.467
> 
> 标签：java, netbeans, jasper-reports, ireport

我想开始使用 iReport（netbeans 版）并替换旧的经典 iReport 3.0.x。似乎经典的 iReport 将不再改进并在某个时候被放弃。

关键是我需要从另一个 java 应用程序启动 iReport。使用 iReport 3.0 非常简单直接：只需调用`it.businesslogic.ireport.gui.MainFrame.main(args);` iReport 即可启动并运行。

问题是我不知道如何在 iReport-nb 中做同样的事情。netbeans 平台对我来说是一个完全未知的平台，我找不到任何看起来像主要方法或应用程序起点的东西。它似乎首先加载了很多 net beans 平台的东西，并以某种方式隐藏了 iReport 的起点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T08:13:54.303

基于 NetBeans 平台的 iReport 可以作为独立应用程序（就像经典应用程序一样），即使它也可以作为 NetBeans 插件安装和使用。很快 iR 3.5.2 将发布，它将涵盖 iR classic 中存在的所有在以前版本中尚未涵盖的剩余功能，但另一方面它提供了许多新功能和对 JasperReports 3.5.2 的支持，包括条码组件的全新实现，列表（这是一种轻的子报表），新的图表类型，支持多波段的详细信息和组页眉/页脚，集成预览等。

在这里，您可以找到一些关于如何从另一个 java 应用程序启动基于 NetBeans 平台的应用程序的技巧。并非微不足道，因为您需要设置一点环境，但绝对可行： [http ://wiki.netbeans.org/DevFaqPlatformAppAuthStrategies](http://wiki.netbeans.org/DevFaqPlatformAppAuthStrategies)

朱利奥

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T12:36:15.820

为什么你认为它被遗弃了？顺便说一句，最新版本现在是 3.5.0。以及将其更改为 netbeans 版本的原因是什么？恕我直言，主要应用程序仍然是 iReport，而 NetBean 插件的功能与“plain old iReport”相同。

回到你的问题。iReport 是独立应用程序，而“NetBeans 版”只是插件，因此您必须启动 NetBeans IDE，然后将其布局切换到 iReport 插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-05T12:40:52.943

1）设计：设计报告的想法几乎相同。安装插件后 make new->report 并开始设计。完成后选择预览，iReport 将编译您的报告，生成一个 .jasper 文件。

2）执行：编写代码以传递数据并从您的java代码运行.jasper 类似的东西：

```
JasperPrint print=null;
ResultSet rs=null;
try {
    Statement stmt = (Statement) myConnection.createStatement (ResultSet.TYPE_SCROLL_SENSITIVE,//Default either way
            ResultSet.CONCUR_READ_ONLY);
    rs = stmt.executeQuery("select * from Table");
} catch (SQLException sQLException) {
}

    try {
        print = JasperFillManager.fillReport(filename, new HashMap(), new JRResultSetDataSource(rs));
    } catch (JRException ex) {                                                   
    }

try{
        JRExporter exporter=new net.sf.jasperreports.engine.export.JRPdfExporter();
        exporter.setParameter(JRExporterParameter.OUTPUT_FILE_NAME, pdfOutFileName);
        exporter.setParameter(JRExporterParameter.JASPER_PRINT, print);
        exporter.exportReport(); 
```

}.......

# javascript - 可见性：在 javascript 中折叠

> ID：852321
> 
> 赞同：1
> 
> 时间：2009-05-12T11:44:00.423
> 
> 标签：javascript, ultrawebgrid

我将 Ultrawebgrid 用于我的应用程序：

当用户单击该特定行时，我正在使用 textarea 在行模板中列出我的应用程序中的错误...

所以当有任何错误时我需要 texarea .....否则当没有错误时我什至不希望 row_template 弹出.....我使用的是 IE6。

我正在检查使用 javascript.so 是否有任何错误。所以我不得不使用 javascript 事件处理程序:: ***UltraWebGrid1_BeforeRowTemplateOpenHandler(gridName, rowId, templateId)***

我在哪里写下面给出的语句： **document.getElementById("TextArea2").style.visibility="collapse"** 在上面的事件函数中

1）它显示javascript错误为 *“无法获得可见性属性：无效参数”* *，但行模板没有弹出......* ..只有错误即将到来......

2）在没有错误的情况下，是否有任何代码可以阻止行模板。？？我的意思是没有弹出窗口没有错误

这个有什么解决办法？？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T11:51:23.453

***展示***

使用显示而不是可见性。这在您的文档中不占用任何空间。

```
document.getElementById("TextArea2").style.display = 'none';    // Turn off    
document.getElementById("TextArea2").style.display = 'inline';  // Turn on 
```

***能见度***

```
document.getElementById("TextArea2").style.visibility="hidden";    // Turn off
document.getElementById("TextArea2").style.visibility="visible";    // Turn on 
```

通过使用上面的代码 textarea 将不可见，但在您的文档中会有空白空间，具有 textarea 的高度和宽度。

***'collapse' 值也仅在 Internet Explorer 8 中受支持***

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T11:45:58.467

尝试使用：

```
document.getElementById("TextArea2").style.display = 'none'; 
```

和（再次打开它）

```
document.getElementById("TextArea2").style.display = 'block'; // or 'inline' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T11:46:02.177

你要：

```
document.getElementById("TextArea2").style.visibility = "hidden"; 
```

正如您的错误消息所示，“折叠”不是 IE6 中可见性属性的有效值。

或者，按照@tvanoffsen 的建议，您可以将显示属性设置为“无”。这有一个稍微不同的效果 - 如果设置为 ，它不会占用任何空间`"display: none"`，而设置`"visibility: hidden"`仍然占用空间。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-05-20T19:40:49.480

对 .style.visibility 属性使用可见和隐藏，而不是阻止和隐藏。有用。

# sql - 按客户信息汇总子查询和分组

> ID：852330
> 
> 赞同：1
> 
> 时间：2009-05-12T11:46:55.793
> 
> 标签：sql, sql-server

我有三个表，如下所示：

```
Customer (CustomerID, AddressState)
Account (AccountID, CustomerID, OpenedDate)
Payment (AccountID, Amount) 
```

付款表可以包含一个帐户的多个付款，一个客户可以有多个帐户。

我想做的是按州逐月检索所有付款的总金额。例如

```
Opened Date| State | Total
--------------------------
2009-01-01 |   CA  | 2,500
2009-01-01 |   GA  | 1,000
2009-01-01 |   NY  |   500
2009-02-01 |   CA  | 1,500
2009-02-01 |   NY  | 2,000 
```

换句话说，我试图找出每个月支付最多的国家。我只对 OpenedDate 的月份感兴趣，但我将其作为之后处理的日期。我试图在一个查询中检索我需要的所有数据。

我一直在尝试以下方式：

```
select
  dateadd (month, datediff(month, 0, a.OpenedDate), 0) as 'Date',
  c.AddressState as 'State',
  (
    select sum(x.Amount)
    from (
      select p.Amount
      from Payment p
      where p.AccountID = a.AccountID
    ) as x
  )
  from Account a
  inner join Customer c on c.CustomerID = a.CustomerID
  where ***
  group by
    dateadd(month, datediff(month, 0, a.OpenedDate), 0),
    c.AddressState 
```

where 子句包括 Account 表中的一些常规内容。该查询将不起作用，因为 a.AccountID 未包含在聚合函数中。

我以正确的方式接近这个吗？如何检索我需要的数据以计算哪些州的客户支付最多？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T11:56:02.157

如果要按月分组数据，则需要按月分组：

```
SELECT  AddressState, DATEPART(mm, OpenedDate), SUM(Amount)
FROM    Customer c
INNER JOIN Account a  ON a.CustomerID = c.CustomerID
INNER JOIN Payments p ON p.AccountID = a.AccountID
GROUP BY   AddressState, DATEPART(mm, OpenedDate) 
```

这将向您显示月份编号 (1-12) 和每个州的总金额。请注意，此示例不包括年份：无论年份如何，第 1 个月的所有金额都会相加。如果你愿意，可以添加一个 datepart(yy, OpenedDate)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T11:49:45.533

> 换句话说，我试图找出每个月支付最多的国家

这将选择每个月最有利可图的状态：

```
SELECT  *
FROM    (
        SELECT  yr, mon, AddressState, amt, ROW_NUMBER() OVER (PARTITION BY yr, mon, addressstate ORDER BY amt DESC) AS rn
        FROM    (
                SELECT  YEAR(OpenedDate) AS yr, MONTH(OpenedDate) AS mon, AddressState, SUM(Amount) AS amt
                FROM    Customer c
                JOIN    Account a
                ON      a.CustomerID = c.CustomerID
                JOIN    Payments p
                ON      p.AccountID = a.AccountID
                GROUP BY
                        YEAR(OpenedDate), MONTH(OpenedDate), AddressState
                )
        ) q
WHERE   rn = 1 
```

将最后一个条件替换`ORDER BY yr, mon, amt DESC`为获取结果集中所有状态的列表：

```
SELECT  *
FROM    (
        SELECT  yr, mon, AddressState, amt, ROW_NUMBER() OVER (PARTITION BY yr, mon, addressstate ORDER BY amt DESC) AS rn
        FROM    (
                SELECT  YEAR(OpenedDate) AS yr, MONTH(OpenedDate) AS mon, AddressState, SUM(Amount) AS amt
                FROM    Customer c
                JOIN    Account a
                ON      a.CustomerID = c.CustomerID
                JOIN    Payments p
                ON      p.AccountID = a.AccountID
                GROUP BY
                        YEAR(OpenedDate), MONTH(OpenedDate), AddressState
                )
        ) q
ORDER BY
        yr, mon, amt DESC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T13:37:34.363

```
select
    AddressState,
    year(OpenedDate) as Yr,
    month(OpenedDate) as Mnth,
    sum(Payment) as SumPayment
from Customer c
    inner join Account a
        on c.CustomerID=a.CustomerID
    inner join Payment p
        on a.AccountID=p.AccountID
group by AddressState, month(OpenedDate) 
```

# python - M2Crypto 使用 AES256 加密/解密

> ID：852332
> 
> 赞同：7
> 
> 时间：2009-05-12T11:47:20.317
> 
> 标签：python, aes, m2crypto

有人可以提供我使用 Python 使用 m2crypto aes256 CBC 加密/解密的代码吗

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-12T19:24:30.113

M2Crypto 的文档很糟糕。有时 OpenSSL 文档（m2crypto 包装 OpenSSL）可以提供帮助。你最好的办法是查看 M2Crypto 单元测试——https://gitlab.com/m2crypto/m2crypto/blob/master/tests/test_evp.py——[寻找](https://gitlab.com/m2crypto/m2crypto/blob/master/tests/test_evp.py)方法`test_AES()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T21:48:36.367

看看[m2secret](http://pypi.python.org/pypi/m2secret/)：

> 使用对称密钥算法加密和解密数据的小型实用程序和模块。默认情况下使用 CBC 的 256 位 AES (Rijndael)，但有些选项是可配置的。用于从密码派生密钥的 PBKDF2 算法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-06-21T12:58:51.133

我在 M2Crypto 周围使用以下包装器（从[cryptography.io](https://cryptography.io/en/latest/fernet/)借来）：

```
import os
import base64
import M2Crypto

class SymmetricEncryption(object):

    @staticmethod
    def generate_key():
        return base64.b64encode(os.urandom(48))

    def __init__(self, key):
        key = base64.b64decode(key)
        self.iv = key[:16]
        self.key = key[16:]

    def encrypt(self, plaintext):
        ENCRYPT = 1
        cipher = M2Crypto.EVP.Cipher(alg='aes_256_cbc', key=self.key, iv=self.iv, op=ENCRYPT)
        ciphertext = cipher.update(plaintext) + cipher.final()
        return base64.b64encode(ciphertext)

    def decrypt(self, cyphertext):
        DECRYPT = 0
        cipher = M2Crypto.EVP.Cipher(alg='aes_256_cbc', key=self.key, iv=self.iv, op=DECRYPT)
        plaintext = cipher.update(base64.b64decode(cyphertext)) + cipher.final()
        return plaintext 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-25T10:26:01.170

```
def encrypt_file(key, in_filename, out_filename,iv):
    cipher=M2Crypto.EVP.Cipher('aes_256_cfb',key,iv, op=1)
    with open(in_filename, 'rb') as infile:
        with open(out_filename, 'wb') as outfile:
          outfile.write(b)
          while True:
            buf = infile.read(1024)
            if not buf:
                break
            outfile.write(cipher.update(buf))

          outfile.write( cipher.final() )  
          outfile.close()
        infile.close()

def decrypt_file(key, in_filename, out_filename,iv):
    cipher = M2Crypto.EVP.Cipher("aes_256_cfb",key , iv, op = 0)
    with open(in_filename, 'rb') as infile: 
        with open(out_filename, 'wb') as outfile:
          while True:
            buf = infile.read(1024)
            if not buf:
                break
            try:
                outfile.write(cipher.update(buf))
            except:
                print "here"
          outfile.write( cipher.final() )  
          outfile.close()
        infile.close() 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-12T15:56:19.440

在安全性方面，没有什么比阅读文档更好的了。

[http://chandlerproject.org/bin/view/Projects/MeTooCrypto](http://chandlerproject.org/bin/view/Projects/MeTooCrypto)

即使我花时间理解并制作完美的代码供您复制和粘贴，您也不知道我是否做得好。我知道这不是很有帮助，但我祝你好运并保护数据。

# c++ - 如何在 C++ 中解释二进制数据？

> ID：852334
> 
> 赞同：5
> 
> 时间：2009-05-12T11:48:17.100
> 
> 标签：c++, embedded, byte

我正在以数据包（64 字节）的形式向设备发送和接收二进制数据。数据具有特定的格式，其中的一部分因不同的请求/响应而异。

现在我正在为接收到的数据设计一个解释器。简单地按位置读取数据是可以的，但是当我有十几种不同的响应格式时，它看起来就不那么酷了。我目前正在考虑为此目的创建一些结构，但我不知道它如何与填充一起使用。

也许有更好的方法？

* * *

有关的：

*   [从 C 访问网络数据包中未对齐数据的安全、高效方法](https://stackoverflow.com/questions/529327/safe-efficient-way-to-access-unaligned-data-in-a-network-packet-from-c)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T12:04:23.143

您需要使用结构和或联合。您需要确保您的数据在连接的两端都正确打包，如果连接的任一端有可能以不同的方式运行，您可能希望在每一端与网络字节顺序进行相互转换字节序。

举个例子：

```
#pragma pack(push)  /* push current alignment to stack */
#pragma pack(1)     /* set alignment to 1 byte boundary */
typedef struct {
    unsigned int    packetID;  // identifies packet in one direction
    unsigned int    data_length;
    char            receipt_flag;  // indicates to ack packet or keep sending packet till acked
    char            data[]; // this is typically ascii string data w/ \n terminated fields but could also be binary
} tPacketBuffer ;
#pragma pack(pop)   /* restore original alignment from stack */ 
```

然后在分配时：

```
packetBuffer.packetID = htonl(123456); 
```

然后在收到时：

```
packetBuffer.packetID = ntohl(packetBuffer.packetID); 
```

这里有一些关于[字节序](http://en.wikipedia.org/wiki/Endianness)和[对齐以及结构打包的讨论](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Structure_002dPacking-Pragmas.html)

如果你不打包结构，它最终会与字边界对齐，结构的内部布局和它的大小将不正确。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T12:03:44.470

如果不知道数据的确切格式，很难说最好的解决方案是什么。您是否考虑过使用工会？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T20:22:20.033

我以前做过无数次：这是一个非常常见的场景。有很多事情我几乎总是在做。

不要太担心让它成为最有效的东西。

如果我们最终花费大量时间打包和拆包数据包，那么我们总是可以改变它以提高效率。虽然我还没有遇到过我必须这样做的情况，但我还没有实施网络路由器！

虽然使用 structs/unions 是运行时最有效的方法，但它带来了许多复杂性：说服编译器打包 structs/unions 以匹配您需要的数据包的八位字节结构，努力避免对齐和字节序问题，并且缺乏安全性，因为没有或很少有机会对调试版本进行完整性检查。

我经常会得到一个包含以下类型的架构：

*   数据包基类。任何公共数据字段都可以访问（但不可修改）。如果数据不是以打包格式存储的，那么就会有一个虚函数来生成打包数据包。
*   从通用数据包类型派生的特定数据包类型的许多表示类。如果我们使用打包函数，那么每个表示类都必须实现它。
*   可以从表示类的特定类型（即来自公共数据字段的数据包类型 id）推断出的任何内容都作为初始化的一部分处理，否则不可修改。
*   每个表示类都可以从一个未打包的数据包构建，或者如果数据包数据对该类型无效，则将正常失败。然后为了方便起见，可以将其包装在工厂中。
*   如果我们没有可用的 RTTI，我们可以使用数据包 id 来获取“穷人的 RTTI”，以确定对象真正是哪个特定的表示类。

在所有这一切中，有可能（即使只是用于调试构建）验证每个可修改的字段都设置为一个合理的值。虽然看起来工作量很大，但很难获得格式无效的数据包，可以使用调试器轻松检查预打包数据包的内容（因为它都在正常的平台原生格式变量中）。

如果我们确实必须实现一个更高效的存储方案，那么也可以将其包装在这个抽象中，而几乎没有额外的性能成本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T23:30:52.987

我同意伍吉的观点。您也可以使用代码生成来执行此操作。使用一个简单的数据定义文件来定义所有数据包类型，然后在其上运行 python 脚本以生成原型结构和序列化/反序列化函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T12:30:59.757

这是一个“开箱即用”的解决方案，但我建议看一下 Python[构造](http://construct.wikispaces.com/)库。

> Construct 是一个用于解析和构建数据结构（二进制或文本）的 python 库。它基于以声明方式定义数据结构的概念，而不是过程代码：更复杂的结构由更简单的结构组成。它是第一个让解析变得有趣的库，而不是今天通常令人头疼的问题。

构造非常健壮和强大，只需阅读教程将帮助您更好地理解问题。作者还计划从定义中自动生成 C 代码，因此绝对值得一读。

# java - 在 iReport 中对列进行排序

> ID：852336
> 
> 赞同：1
> 
> 时间：2009-05-12T11:48:24.477
> 
> 标签：java, jasper-reports, report

我正在使用 java-jasper 报告和 iReport 来构建报告。我想让我的报告按列排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-09T06:14:12.533

有两种方法，一种是在 sql 查询本身中使用 ORDER BY，另一种选择是“HTML 模板导出器”。它支持列排序、隐藏/显示部分（折叠）和弹出窗口。它是[JasperShop 中可用的实用程序。](http://www.jaspersoft.com/jaspersoft-template-exporter-jasperreports)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-18T13:41:02.080

来自 iReport 书的权威指南：

通过单击标记为排序选项和筛选表达式的按钮，可以从报告查询对话框中设置排序和筛选选项。

# .net - 如果 Log4net 配置不正确，则会出现异常

> ID：852347
> 
> 赞同：0
> 
> 时间：2009-05-12T11:51:38.803
> 
> 标签：.net, log4net

按照设计，Log4net 仅在无法正确配置时向控制台输出消息（[http://log4net.sourceforge.net/release/1.2.0.30316/doc/manual/faq.html#reliable](http://log4net.sourceforge.net/release/1.2.0.30316/doc/manual/faq.html#reliable)）。

日志记录是我的应用程序的关键部分，所以想知道 Log4net 是否配置正确。我无法找到从 Log4net 获取信息的任何方法，所以我编写了这段代码。但我一点也不喜欢这种策略。有更好的建议吗？

```
 TextWriter errorConsole = new StringWriter();
        TextWriter defaultErrorConsole = Console.Error;
        Console.SetError(errorConsole);
        try
        {
            //configure Log4net

            string errorMessage = errorConsole.ToString();
            bool initializationError = errorMessage.IndexOf("log4net", StringComparison.OrdinalIgnoreCase) == -1;
            if (initializationError)
            {
                throw ...
            }
        }
        finally
        {
            Console.SetError(defaultErrorConsole);
        } 
```

同样在记录消息时，例如调用 ILog.Error。有没有办法查看它是否被记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T17:18:01.660

配置过程中发生的任何错误都会使用[log4net.Util.LogLog 类](https://logging.apache.org/log4net/release/sdk/html/T_log4net_Util_LogLog.htm)在内部记录在 log4net 中。不幸的是，在当前版本中，这个类并没有提供太多可以帮助你的东西。另一方面，在[当前源中，您现在可以订阅 LogReceived 事件，该事件在收到内部日志消息时触发。](http://svn.apache.org/viewvc/logging/log4net/trunk/src/Util/LogLog.cs?view=markup)

记录器存储库还使用 ILoggerRepository.ConfigurationMessages() 方法进行了扩展，该方法公开了最新的内部消息列表。

关于监控消息是否被记录：appender，至少那些建立在 AppenderSkeleton 类上的，使用与配置期间相同的内部错误消息。因此，对于最新的来源，您将通过 LogReceived 事件收到任何此类通知。

# c# - C#从任务管理器中删除进程

> ID：852350
> 
> 赞同：0
> 
> 时间：2009-05-12T11:52:36.803
> 
> 标签：c#, user-interface, process

> **可能重复：**
> [如何在 C# 的任务管理器中隐藏进程？](https://stackoverflow.com/questions/187983/how-do-i-hide-a-process-in-task-manager-in-c)

大家好，我只是想知道，我将如何从任务管理器的进程列表中删除一个程序。我已经在使用

```
this.ShowInTaskbar = false; 
```

但也希望它从任务管理器进程列表中隐藏。我不在乎它是否显示在进程资源管理器中，尽管我只是在制作一个笑话程序：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T11:56:30.253

我不相信这是可能的，但是您可以将其重命名为 svchost.exe。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:21:35.753

您可以编写设备驱动程序、挂钩系统服务调度表 (SSDT) 并在调用[NtQueryInformationProcess](http://msdn.microsoft.com/en-us/library/ms684280(VS.85).aspx)时过滤掉您的进程。

或者，有几种方法可以在用户空间中挂钩函数调用。[这](http://www.codeproject.com/KB/system/hooksys.aspx)是一篇优秀的文章，详细介绍了该过程。

如果只是为了开玩笑，我会使用[Jean Azzopardi](https://stackoverflow.com/users/53902/jean-azzopardi)的建议并将您的 exe 重命名为 svchost - 没有人会一眼注意到它。

* * *

我差点忘了，也可以从内核的进程列表中取消链接进程。进程的线程仍然由内核运行，但它不再了解进程对象，因此不会在任何进程列表中返回该进程。这称为直接内核对象操作 (DKOM)。[这](http://www.blackhat.com/presentations/bh-usa-04/bh-us-04-butler/bh-us-04-butler.pdf)是 DKOM 和其他方法的概述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T11:56:19.957

我知道有一种方法，因为我很久以前在代码项目文章中看到了它。不确定它是否适用于 c# 或更新的操作系统。找到这个链接希望它有帮助。 [链接文本](http://www.codeguru.com/forum/showthread.php?t=406555)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T12:04:35.123

嗯，它有点困难，但你可以做一个简单的事情尝试将你的 exe 重命名为 csrss.exe 或 winlogon.exe

windows任务管理器杀不死他们

我希望您不会将其用于恶意活动

# java - MemoryPoolMXBean.getUsage() 相对于 Runtime.freeMemory() 的优势

> ID：852352
> 
> 赞同：3
> 
> 时间：2009-05-12T11:53:35.910
> 
> 标签：java, jmx

我需要使用定期收集 JVM 的统计信息。稍后，我需要记录 JVM 可用内存/空闲内存、已用内存、总内存。

以下是我想到的两个选项。

1.  ManagementFactory.getMemoryPoolMXBeans() 并遍历每个 MemoryPoolMXBean，最后使用 MemoryPoolMXBean.getUsage() 收集统计信息。

2.  Runtime.freeMemory()、Runtime.maxMemory()、Runtime.totalMemory

这是收集统计数据的最佳方式。使用 MemoryPoolMXBean.getUsage() 或运行时类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T12:11:03.587

这是关于在整个应用程序生命周期中*监听*您的内存使用情况，而不是在应用程序的各个位置寻找信息。

正如[Java 中的内存通知中](http://recursor.blogspot.com/2006/10/memory-notifications-in-java.html)所述，您可以通过*交互*方式来监控内存，因为您可以将通知侦听器添加到您的`MemoryMXBean`.

所以对于准时的非常本地的检查，Runtime 可能就足够了，对于全局监控，`MemoryMXBeans`是要走的路。

# java - 你如何从会话中读取语言环境信息？

> ID：852353
> 
> 赞同：1
> 
> 时间：2009-05-12T11:53:49.560
> 
> 标签：java, jsp, internationalization, jstl, locale

以下代码在查询字符串上设置来自 lang 参数的区域设置。

```
<c:if test="${param['lang'] != null}">
    <fmt:setLocale value="${param['lang']}" scope="session"/>
</c:if> 
```

我现在如何读取该变量？

我知道它有点菜。

如果本地尚未使用 设置在会话范围内`fmt:setLocale`，我需要一些条件逻辑来显示一种语言链接，如果已将其设置为特定语言环境，则需要另一种语言链接。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T12:02:37.297

尝试这个：

```
<c:if test="${pageContext.request.locale.language == 'en'}"> 
    <a href="link1">Link 1</a> 
</c:if> 
<c:if test="${pageContext.request.locale.language != 'en'}"> 
    <a href="link2">Link 2</a> 
</c:if> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T13:15:59.013

```
<c:choose>
    <c:when test="${sessionScope['javax.servlet.jsp.jstl.fmt.locale.session'] eq 'en_CY'}">
        a href="?lang=en_GB">English</a>
    </c:when>
    <c:otherwise>
        <a href="?lang=en_CY">Cymraeg</a>
    </c:otherwise>
</c:choose> 
```

这行得通，但有更好的写作方法吗？

```
<c:when test="${sessionScope['javax.servlet.jsp.jstl.fmt.locale.session'] eq 'en_CY'}"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T12:52:17.183

```
<c:choose>
    <c:when test="${pageContext.response.locale eq 'en_CY'}">
        <a href="?lang=en_GB">English</a>
    </c:when>
    <c:otherwise>
        <a href="?lang=en_CY">Cymraeg</a>
    </c:otherwise>
</c:choose> 
```

这仅适用于页面 itslef。

但是因为它是从 pageContext 读取的，所以它不能通过从 sessionScope 读取它来在其他页面上工作（它是由 设置的`fmt:setLocale`）。

我将如何从 sessionScope 中读取它？

# hibernate - Hibernate：映射 3 个表

> ID：852371
> 
> 赞同：3
> 
> 时间：2009-05-12T11:57:57.830
> 
> 标签：hibernate, mapping

我正在尝试使用 Hibernate 映射一些现有的表。

这很简单：我们有具有多种语言名称的类别。

DDL 如下：

```
create table language (
   id                integer not null auto_increment,
   code              varchar(2) not null,

   unique (code),

   primary key(id)
);

create table category (
   id               integer not null auto_increment,
   parent_id        integer default null,
   ordr             integer not null default 99,

   primary key (id)
);

create table category_description (
   category_id      integer not null,
   language_id      integer not null,

   title            varchar(255) not null,

   constraint foreign key (category_id) references category(id),
   constraint foreign key (country_language_id) references country_language(id),

   primary key (category_id, country_language_id)
); 
```

现在我想要一张地图，其中语言为键，描述（表 category_description）为值，如下所示：

```
private Map<Language, CategoryDescription> descriptions = new HashMap<Language, CategoryDescription>(); 
```

任何人都可以为我提供一些指示吗？我已经尝试了“Java Persistence with Hibernate”中第 311/312 页给出的示例，这类似于我的问题，但我只是没有得到它:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T09:52:12.820

（您的 DDL 不一致，您创建了一个表“语言”但引用了一个表“国家语言”——我将假设后者）

这是您的示例的 Hibernate 映射的样子：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping default-lazy="false">

    <class name="Language" table="country_language">
        <id name="id" type="int">
            <column name="ID" />
            <generator class="native" />
        </id>
        <property name="code" type="string" length="2" unique="true" />
    </class>

    <class name="Category" table="category">
        <id name="id" type="int">
            <column name="ID" />
            <generator class="native" />
        </id>
        <map name="descriptions" table="category_description">
            <key column="category_id" />
            <map-key-many-to-many column="language_id" class="Language" />
            <composite-element class="CategoryDescription">
                <property name="title" type="string" length="255" />
            </composite-element>
        </map>
    </class>

</hibernate-mapping> 
```

但是，您根本不需要`CategoryDescription`该类（因为它只是包装 a `String`）：

```
private Map<Language, String> descriptions; 
```

和

```
<map name="descriptions" table="category_description">
    <key column="category_id" />
    <map-key-many-to-many column="language_id" class="Language" />
    <element type="string" length="255" column="title" />
</map> 
```

也可以。

请注意，在这两种情况下，您的`Language`类都需要重写`hashCode()`，`equals()`以便能够成功查询结果映射：

```
/* eclipse generated */
@Override
public int hashCode() {
    final int prime = 31;
    int result = 1;
    result = prime * result + ((id == null) ? 0 : id.hashCode());
    return result;
}

/* eclipse generated */
@Override
public boolean equals(Object obj) {
    if (this == obj)
        return true;
    if (obj == null)
        return false;
    if (getClass() != obj.getClass())
        return false;
    Language other = (Language) obj;
    if (id == null) {
        if (other.id != null)
            return false;
    } else if (!id.equals(other.id))
        return false;
    return true;
} 
```

# c# - 建模流程图

> ID：852376
> 
> 赞同：1
> 
> 时间：2009-05-12T11:59:58.493
> 
> 标签：c#

我有一个完全由布尔条件和一组要执行的逻辑作为响应的预定流程图。

流量不太可能发生太大变化，但发生变化的可能性很小。（可能会引入新的步骤，或者条件的顺序可能会改变）

编写此代码的最佳方法是什么？一大堆嵌套的 if else 语句？工作流基础？还要别的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T12:58:24.250

具有公认的改变可能性的流程图邀请状态机来实施。无论您是一直使用状态模式还是简单地实现状态机（在您描述的情况下，数据驱动似乎还没有理由）都是实现细节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T12:40:52.500

如果灵活性不是主要考虑因素，那么您可以直接对整个流程图逻辑进行硬编码。最简单的往往是最好的。根据原始流程图的概念来构建您的代码，这样就可以很容易地看到类比并在未来必要时进行更改。

如果您已经熟悉 Windows Workflow Foundation 或者您愿意接受学习曲线，那么它可能是一个很好的工具。

# c++ - 如何要求一个小的添加？（纯虚函数的语法）

> ID：852377
> 
> 赞同：7
> 
> 时间：2009-05-12T12:00:36.480
> 
> 标签：c++, standards, c++11

在[当前的 C++0x 草案中](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2857.pdf)，我注意到他们引入了一些新的显式关键字来突出预期的行为（很棒的举动！）。

示例：[默认/删除](http://en.wikipedia.org/wiki/C%2B%2B0x#Defaulting.2Fdeleting_of_standard_functions_on_C.2B.2B_objects)函数（*= default*和*= delete*），新的[nullptr](http://en.wikipedia.org/wiki/C%2B%2B0x#Null_pointer_constant)常量，也可用于转换运算符的[显式关键字，...](http://en.wikipedia.org/wiki/C%2B%2B0x#Explicit_conversion_operators)

所以我希望看到纯虚函数的*= pure*语法。

相反，丑陋的（当然，恕我直言）*= 0*的东西仍然存在。

好的，我可以使用*#define pure 0*（有时我会这样做），但我认为一致性/一致性绝对应该是标准的目标。此外，我知道这只是一种超迂腐的要求，但*= 0*确实是我最不喜欢的 C++ 部分之一（委婉说法）......

我的问题：

*   我知道，新标准功能齐全，但是否仍然可以要求这个小小的迂腐添加，即使只是作为“必需的宏”的东西？
*   如果答案是肯定的，怎么办？（周围有委员会成员吗？）
*   我只是有点过于迂腐（或错误）来要求这个补充吗？您如何看待纯虚函数的当前语法？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-12T12:12:24.753

这不是一个小小的迂腐变化。引入新关键字是您可以要求的**最大更改之一。**这是他们几乎不惜一切代价试图避免的事情。想想所有使用“纯”这个词的代码，这会破坏。

一般来说，他们的指导方针是只在语言中添加*以前无法完成*的内容。`pure`关键字不会启用任何新功能（例如，与 nullptr 关键字不同，它可以实现更好的类型检查），因此希望它具有非常低的优先级。请记住，他们所做的任何事情基本上都是维护工作。#1 目标是避免破坏语言（或使用它的现有代码）。只有在不破坏向后兼容性的情况下才能添加任何添加的功能。

然而，委员会或多或少是一个开放的论坛。浏览他们的[网站](http://www.open-std.org/jtc1/sc22/wg21/docs/contacts)，您应该能够找到一些电子邮件地址。或者使用`comp.std.c++`新闻组。

我相信他们的会议也是开放的，所以你可以直接闯入下一个会议。;)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T13:22:10.713

你*最*讨厌C++ 的地方是“ `= 0;`”？？？

你*用过*这种语言吗？还有很多其他的事情你可以更好地花费你的仇恨。

`<Flame retardant>`我已经使用 C++ 超过 10 年了。对我来说，每当我需要做一些繁重的计算时，它仍然是首选语言。`</Flame retardant>`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T12:07:41.837

首先，开始阅读`comp.std.c++`新闻组。这是公开讨论的地方。

其次，我想说只有勘误表将应用于当前的 C++0x 草案，委员会确实处于最后阶段。

如果您*非常*热衷，请在新闻组中提出您的建议，并提供非常好的理由。并期待它被击落。实质上更有用的提案（例如模块）尚未提出。

附录：如果您希望这样的事情取得进展，您将需要加入（ANSI 拥有）委员会，或者在委员会中找人来推动您的提案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-12T12:11:11.760

太晚了。请求的呼吁在几年前就结束了。

（有一个页面保存了提交，但我再也找不到那个列表了。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T20:37:09.190

除了[jalf](https://stackoverflow.com/questions/852377/c0x-how-to-ask-for-a-small-addition-syntax-of-pure-virtual-functions/852426#852426)关于添加关键字的缺点的评论（我 100% 同意），您还应该注意，在计算机科学中，*[纯函数](http://en.wikipedia.org/wiki/Pure_function)*一词已经有意义。这意味着给定相同的参数，函数总是返回相同的值并且没有副作用。因此，选择`= pure`指示必须重写的虚函数将是一个糟糕的语法选择。

# c# - 使用扩展方法实例化类的实例

> ID：852379
> 
> 赞同：4
> 
> 时间：2009-05-12T12:01:10.440
> 
> 标签：c#, extension-methods

这段代码背后的想法是，如果该类设置为 null，它会使用扩展方法来实例化该类的实例。代码很简单，但不起作用（它编译并运行，但最后对象引用仍然是`null`）。

谁能建议为什么？

以下代码使用`SomeClass`具有单个`string`属性的简单类。

```
class SomeClass
{
    public string SomeProperty { get; set; }
}

static class ExtensionMethods
{
    public static void InitialiseObjectIfNull<T>(this T obj)
        where T : class, new()
    {
        if (obj == null) obj = new T();
    }
}

class Program
{
    static void Main(string[] args)
    {
        SomeClass someClass = null;

        someClass.InitialiseObjectIfNull();

        // someClass is still null - but why??
    }
} 
```

（关于这是否是扩展方法的适当使用的讨论应该在问题的范围之外考虑！我有兴趣理解*为什么*这种方法不起作用）

## 编辑

仔细观察，这个问题不是关于扩展方法，而是更多关于当你传递带有或不带`ref`关键字的引用类型时发生了什么。

以下函数将导致`obj`为调用者初始化传递：

```
static void InitialiseObjectIfNull<T>(ref T obj) where T : class, new()
{
    if (obj == null) obj = new T();
}

InitialiseObjectIfNull<SomeClass>(ref someClass); // someClass will be initialised 
```

以下函数不会导致`obj`为调用者初始化传递：

```
static void InitialiseObjectIfNull<T>(T obj) where T : class, new()
{
    if (obj == null) obj = new T();
}

InitialiseObjectIfNull<SomeClass>(someClass); // someClass will not be initialised 
```

但是……我们在这里处理的是引用类型，那么如果不使用关键字，CLR 对`new`d做了什么？大概它只是收集垃圾......`obj``ref`

## 编辑2

好的，我们在这里回到基础。考虑下面的代码：

```
class Program
{
    static void SetProperty(SomeClass someClass)
    {
        someClass.SomeProperty = "Bar";
    }

    static void Main(string[] args)
    {
        SomeClass someClass = new SomeClass { SomeProperty = "Foo" };

        SetProperty(someClass);

        // someClass.SomeProperty now equals "Bar"
    }
} 
```

注意：`someClass`没有使用`ref`关键字传递，但其属性的值仍然为调用者更改。这是我希望看到的。

但是，将`SetProperty`函数更改如下：

```
static void SetProperty(SomeClass someClass)
{
    someClass = new SomeClass { SomeProperty = "Bar" };
} 
```

...并且调用者不会看到对`someClass`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T12:03:49.680

您需要返回值；扩展方法不在参数`ref`上`this`：

```
static class ExtensionMethods
{
    public static T InitialiseObjectIfNull<T>(this T obj)
        where T : class, new()
    {
        return obj ?? new T();            
    }
} 
```

那么你需要：

```
someClass = someClass.InitialiseObjectIfNull(); 
```

就个人而言，我希望直接执行此操作会更简单……使用以下任一方法：

```
if(someClass == null) someClass = new SomeClass(); 
```

或者

```
someClass = someClass ?? new SomeClass(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T12:04:49.413

`this T obj`将需要成为一个`ref`论点。由于这是不允许的（[MSDN](http://blogs.msdn.com/sreekarc/archive/2007/04/25/extension-methods.aspx)或 C# In Depth p258，Skeet），所以你不能。

不过，我建议你不要把这个想法推得太远。这似乎是扩展方法的一个令人困惑的应用，尤其是当替代方案仍然是短的一行时。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T12:05:29.113

扩展方法只是语法糖：

```
ExtensionMethods.InitialiseObjectIfNull(someClass); 
```

您是`someClass`按值传递的，因此在`InitialiseObjectIfNull`正文中分配给它不会有任何效果，除非您通过引用传递，在`someClass`扩展方法的情况下您不能这样做：您不能通过引用传递。`this``this T obj`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T12:07:28.560

这不起作用，因为 obj 参数未声明为通过引用传递。不幸的是，您不能将参数声明为“this ref T obj”，它不受支持...我知道，我昨天尝试过；）

你可以这样做：

```
static class ExtensionMethods
{
    public static T InitialiseObjectIfNull<T>(this T obj)
        where T : class, new()
    {
        return obj ?? new ();
    }
}

class SomeClass
{
    public string SomeProperty { get; set; }
}

class Program
{
    static void Main(string[] args)
    {
        SomeClass someClass = null;

        someClass = someClass.InitialiseObjectIfNull();
    }
} 
```

# c# - 网格视图中的下拉列表中的问题

> ID：852383
> 
> 赞同：0
> 
> 时间：2009-05-12T12:01:36.943
> 
> 标签：c#, gridview, drop-down-menu

如何将下拉列表添加到 gridview 以及如何将数据源添加到下拉列表？

例如：

我在这里有 5 个列 c1、c2、c3、c4、c5 的 gridview 我想只添加一个下拉列表 c1 和 c2 做这项工作的程序是什么？

注意：vs2008,asp.net 与 c#

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T02:54:08.560

您可以编辑 GridView 中的列并将这两个设置为 TemplateColumns，然后在 TemplateColumn 中放置一个名为 DropDownList1 的 DropDownList。然后正如 Hunter 所说，使用 DataBound 事件绑定到这样的数据集：

```
DropDownList list = e.Item.FindControl("DropDownList1");
list.DataSource = < your DataSet here>;
list.DataValueField = "code";
list.DataTextField = "description";
list.DataBind(); 
```

# c# - 数据访问层的反射性能

> ID：852387
> 
> 赞同：2
> 
> 时间：2009-05-12T12:03:02.787
> 
> 标签：c#, performance, reflection, .net-3.5

我过去为一个项目创建了一个框架，其中一个功能是将数据库信息加载到我的业务实体类中（只有属性没有方法），然后从业务实体类加载到数据库中加载存储过程的参数集合被执行。为此，我在该项目中使用 DB 归档信息和 SP 参数修饰了业务实体类，如下例所示，并让框架使用反射加载实体或参数集合，因此我不必为维护生成新代码。
但是现在我正在创建一个新的更大的项目，当然要维护更多的代码，但是性能至关重要，我想知道是否值得对所有负载使用反射并保持代码更简单或实际生成所有代码和保持所有的变化？
我进行了一些搜索，阅读了 MSDN 上的一些文档，但仍然发现了很多不同的意见，喜欢反射的人显示开销并没有那么糟糕，而其他人则说实际上最好远离反射

技术规范对于新应用程序：
语言：C#
.Net 版本：3.5
应用程序类型：经典 Web 窗体访问逻辑组件和数据访问层也在 C#
数据库：SQL Server 2008
数据库抽象层：对数据库的所有访问都是通过存储过程和用户​​定义函数进行的。

示例代码：

```
 // Decorated class
[System.Serializable()]
public class bMyBusinessEntity{
    private Int64 _MyEntityID;
    private string _MyEntityName;
    private string _MyEntityDescription;

    [aFieldDataSource(DataColumn = "MyEntityID")]
    [aRequiredField(ErrorMessage = "The field My Entity ID is mandatory!")]
    [aFieldSPParameter(ParameterName="MyEntityID")]
    public Int64 MyEntityID{
        get { return _MyEntityID; }
        set { _MyEntityID = value; }
    }

    [aFieldDataSource(DataColumn = "MyEntityName")]
    [aFieldSPParameter(ParameterName = "MyEntityName")]
    public  string MyEntityName{
        get { return _MyEntityName; }
        set { _MyEntityName = value; }
    }
    [aFieldDataSource(DataColumn = "MyEntityDescription")]
    [aFieldSPParameter(ParameterName = "MyEntityDescription")]
    public string MyEntityDescription{
        get { return _MyEntityDescription; }
        set { _MyEntityDescription = value; }
    }
}

   // To Load from DB to the Object:
   using (DataTable dtblMyEntities = objDataSource.ExecuteProcedure(strSPName, objParams)) {
       if (dtblMyEntities.Rows.Count > 0) {
           DataRow drw = dtblMyEntities.Rows[0];
           oFieldDataSource.LoadInfo(ref objMyEntity, drw);
           return objMyEntity;
       }
       else
           throw new Exception(“Row not found!”);
  }

  // To Load from the Object to the DB
  oDataSource objDataSource = new oDataSource();
  IDbDataParameter[] objParams = objDataSource.GetProcedureParameters(strSPName);
  oFieldSPParameter.LoadInfo(objParams, objMyEntity);
  objDataSource.ExecuteNonQuery(strSPName, objParams); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T12:18:10.287

与其滚动基本上是您自己的 ORM，我建议您切换到已建立的 ORM 之一，例如[NHibernate](https://www.hibernate.org/343.html)或[Entity Framework](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)。

要直接回答您的问题，反射性能还不错，但我个人从未想过使用我自己在一个大型项目中使用的 ORM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:43:42.430

就个人而言，如果数据访问要求需要大量事务（高度事务性系统），我不会使用反射 - 您获得的灵活性最终会在运行时花费您（更多[关于反射的评论here](https://stackoverflow.com/questions/25458/how-costly-is-reflection-really)）。

我会根据自定义解决方案选择[流行的 ORM 解决](https://stackoverflow.com/questions/146087/best-performing-orm-for-net)方案。主要是您将受益于使用相同方法的更大社区（更容易获得设计建议、调试以及利用已知的性能调整）。

这通常还意味着访问支持更新技术（例如 SQL Server 2008）的更新，因为它已发布 - 您无需承担这种负担或测试成本（除了直接实施）。

有[许多流行的解决方案，](https://stackoverflow.com/questions/82393/poll-aspnet-data-access-methodologies)包括实体框架和 LINQ to SQL（在 .Net 3.5 中并且都支持存储过程），但也大量支持使用 CodeSmith 模板/网络层的模板驱动方法，或更复杂的解决方案例如，使用 NHibernate 或 Deklarit。

The last big solution I was involved with used Stored Procedures and Functions in much the same way you have described, however we used the Enterprise Library and generated DAL access classes and data transfer objects using a handwritten tool. You could use much the same approach as used in MS Patterns and Practices '[Web Service Software Factory](http://www.codeplex.com/servicefactory)' potentially, or any template-driven approach.

# asp.net - IE WebControls TreeView - Web 应用程序 javascript 问题

> ID：852388
> 
> 赞同：0
> 
> 时间：2009-05-12T12:03:15.517
> 
> 标签：asp.net, javascript, treeview

我正在使用旧`Microsoft.Web.UI.WebControls` `TreeView`控件。在 Web 应用程序下运行时，该`treeview.GetChildren()`方法通过

> 对象或属性不支持错误

但是 ASP.NET 2.0 网站项目中的相同代码运行良好。

有没有人遇到过这个问题？Web 上几乎没有关于此控件的内容...

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T14:44:48.980

因为网络控制完全糟透了。使用 javascript！不是那种可怕的不符合标准的东西......

# .net - Visual Studio 中从代码后面切换到 Xaml 代码的捷径是什么？

> ID：852389
> 
> 赞同：31
> 
> 时间：2009-05-12T12:03:44.003
> 
> 标签：.net, wpf, visual-studio

我习惯按 shift+F7 在后面的代码和设计器之间切换（加载需要 1 到 5 秒）然后我总是必须单击 View Xaml 来修改我的 XAML 代码。

我在 Tools/Options/Keyboard 中找不到任何可以直接访问的快捷方式（从代码隐藏到 XAML 代码）。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-12T14:04:27.460

在 VS2008 中，在 XAML 页面 (.xaml.cs) 的代码隐藏中，按 SHIFT-F7 将带您进入 XAML 设计器或 XAML 代码页面，具体取决于哪一个具有最新关注点。再次按 SHIFT-F7 会将您从 XAML 代码页转到设计器，反之亦然。

在 XAML 设计器或 XAML 代码页中，按 F7 可转到相关代码隐藏页。

更新。适用于更高版本（例如 MS VS 2015 太）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-05-29T00:20:02.713

我终于找到了 VS 2010 的解决方案：

F7：在代码隐藏和 XAML 之间切换（设计或标记取决于上次使用）
Shift+F7：在 XAML（设计）和 XAML（标记）之间切换。

F7 快捷键映射应该类似于“View.ToggleDesigner (F7 (Global))”
Shift+F7 快捷键映射应该类似于“View.ViewDesigner (Shift+F7 (Global))”和“View.ViewMarkup (Shift+F7 (HTML Source)编辑器视图））”（一个快捷方式的两个映射）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-04-20T17:58:19.330

当我第一次安装 VS2010 时，我的键盘映射设置为（默认）。默认设置将 View.ViewDesigner 映射到“Shift-F7（HTML 编辑器源视图）”。为了让快捷方式在所有视图中工作，我不得不将映射更改为“Shift-F7（全局）”。将键盘映射更改为“Visual C# 2005”也可以。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T14:05:18.567

对于 VS 2008：

F7 从 XAML 转到代码隐藏，Shift-F7 从代码隐藏到 XAML

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-06-02T22:36:05.083

对于 VS 2012，F7 构建解决方案。

*   Shift-F7：从代码隐藏到 XAML Ctrl

*   Ctrl-Alt-0：从 XAML 转到代码隐藏

它在“查看”菜单中，但不是明显的击键。工具-自定义...键盘...进行自定义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T16:03:34.670

下载 Visual Studio 的 dpack（免费） - 然后 F7 将始终切换到“其他”视图。那里还有很多其他很棒的功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-16T15:21:57.333

--> 工具 --> 选项 --> 键盘搜索 "view.view..

View.ViewCode [F7]（全局）分配

View.ViewDesigner [Shif+F7]（全局）分配

# arrays - 在VB6中将数组作为参数传递

> ID：852397
> 
> 赞同：11
> 
> 时间：2009-05-12T12:04:58.583
> 
> 标签：arrays, vb6, parameters

下面的代码在办公室的两台机器上以“VB.exe 中未处理的异常错误”杀死 VB6 (sp6)，并在标记的行上显示。

```
''# Form1.frm
Option Explicit
Private ArrayHolder As Class2

Private Sub Command1_Click()
    Set ArrayHolder = New Class2

    Dim arr(3) As Long
    arr(0) = 1
    arr(1) = 2
    arr(2) = 3

    ArrayHolder.Add arr

End Sub

''# -----------------------------------------------------------    
''# Class1.cls
Option Explicit

Private m_myArray() As Long

Public Property Get myArray() As Long()
    myArray = m_myArray
End Property

Friend Property Let myArray(ByRef anArray() As Long)
    m_myArray = anArray
End Property

''# -----------------------------------------------------------    
''# Class2.cls
Option Explicit

Friend Function Add(newArray() As Long) As Class1
    Dim oClass As Class1
    Set oClass = New Class1

    oClass.myArray = newArray  <- This kills VB6 dead
    MsgBox "passed"

End Function 
```

从我在各种网站上可以看出，我正确地传递了一个数组，但我实际上做得正确吗，为什么它会导致 VB6 如此可怕地死掉？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T12:39:02.367

我没有答案，当然这是一个奇怪的问题，但为什么不添加一个方法并继续前进呢？

```
'Passed the test
Public Sub LetMyArray(anArray() As Long)
    m_myArray = anArray
End Sub

'oClass.MyArray = newArray ' <- This kills VB6 dead
oClass.LetMyArray newArray  ' <- This works 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-18T14:25:58.877

这是 IDE 中的一个错误（编译正常），MS 从未修复过。我正在使用这样的临时数组的解决方法：

```
Friend Function Add(newArray() As Long) As Class1
    Dim oClass As Class1
    Dim tempArray() As Long
    Set oClass = New Class1

    tempArray = newArray
    oClass.myArray = tempArray <- Should work now
    MsgBox "passed"

End Function 
```

仅供参考，当您不小心将鼠标悬停在参数或数组属性上时，字节数组（长数组是安全的）会变得更糟。最好让你的鼠标远离代码:-))

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T12:53:44.887

我不知道为什么会发生这种情况，但是如果您仍然想要一个数组的副本，请在 class2 中使用 Variant：

```
Private m_myArray As Variant

Public Property Get myArray() As Variant
    myArray = m_myArray
End Property

Friend Property Let myArray(anArray As Variant)
    m_myArray = anArray
End Property 
```

修复它，但我仍然很好奇原因。

# c# - 在泛型中使用什么类型进行装箱

> ID：852400
> 
> 赞同：4
> 
> 时间：2009-05-12T12:06:20.920
> 
> 标签：c#, generics, .net-2.0, struct

我在 C# (.NET 2.0) 中编写了一个简单的抽象泛型类，我希望将其限制为仅引用类型，因此我可以用 null 表示没有值。但是，我也想使用 long 和 decimal 等类型，为什么不允许 null （毕竟是结构）。我考虑过上课

```
public abstract Field<Nullable<T>>
{

} 
```

但这会阻止我使用字符串类型，它是一个类。我怎样才能把我的小数和长整数装箱，这样我就可以在这个泛型中使用它们了。

```
 abstract class Field<T>
 {
    private int _Length = 1;
    private bool _Required = false;
    protected T _Value; //= null;

    public int Length
    {
        get { return _Length; }
        private set
        {
            if (value < 1) throw new ArgumentException("Field length must be at least one.");
            _Length = value;
        }
    }

    public bool Required
    {
        get { return _Required; }
        private set { _Required = value; }
    }

    public abstract string GetFieldValue();
    public abstract void ParseFieldValue(string s);

    public virtual T Value
    {
        get { return _Value; }
        set
        {
            if (value == null && Required)
                throw new ArgumentException("Required values cannot be null.");
            _Value = value;
        }
    }

} 
```

请注意，我需要以不同的方式表示数字 0 和 null。由于这个原因 default(T) 将不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T12:08:15.203

泛型（除其他外）的全部意义在于避免装箱。看到[这个](http://msdn.microsoft.com/en-us/library/25tdedf5(VS.80).aspx)：

```
private bool _Required = false;
protected T _Value = default(T); 
```

如果你需要区分“0”和“未设置”，`object`是你唯一的出路：

```
protected object _Value; 
```

然后装箱-拆箱-装箱-拆箱。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T12:53:55.227

你需要两节课

```
abstract class FieldR<T> where T: class
{
  T Value { get {} set {} }
}

abstract class FieldV<T> where T: struct
{
  Nullable<T> Value { get {} set {} }
} 
```

第一堂课将使用

```
T 
```

而第二类将使用

```
Nullable<T> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T13:14:23.150

我不确定您是否可以在编译时适当地约束泛型参数，但您可以添加一些运行时检查以仅允许引用类型以及所需的可为空值类型的子集：

```
public virtual T Value
{
    get { return _Value; }
    set
    {
        Type t = typeof(T);
        if (t.IsValueType)
        {
            if (t.IsGenericType
                && (t.GetGenericTypeDefinition() == typeof(Nullable<>)))
            {
                Type u = Nullable.GetUnderlyingType(t);
                if ((u != typeof(long)) && (u != typeof(decimal)))
                {
                    throw new ArgumentException(
                        "Only long? and decimal? permitted!");
                }
            }
            else
            {
                throw new ArgumentException("Only nullable types permitted!");
            }
        }

        if ((value == null) && Required)
        {
            throw new ArgumentException("Required values cannot be null!");
        }

        _Value = value;
    }
} 
```

（实际上，您可能希望将类型检查放在构造函数而不是`Value`setter 中。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T12:08:03.177

试试这个：

```
public abstract Field<T>
    where T : class
{

} 
```

这会将泛型类型参数限制为引用类型。这是您能够`null`从此方法返回的唯一方法。是的，这将阻止您将值类型传递给方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T12:34:10.133

这是个好问题。我希望这是可能的：

```
class MyClass<T> where T : struct {
    T? value;
    ...
}
class MyClass<T> where T : class {
    T value;
    ...
} 
```

并且编译器将根据是否满足约束来选择正确的泛型类。

不幸的是，它不起作用，这可能会导致自动源代码生成出现问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-27T18:34:32.807

我建议您创建一个具有不受约束的类型参数 T 的类 Holder<T>，它公开了一个类型为 T 的字段；它将有一个默认构造函数和一个 T 类型的单参数构造函数。此外，您可能希望定义一个接口 IReadableHolder<T>，该接口将由 Holder<T> 实现，但也可以由任何您定义的类类型（类 Foo 的实例将通过使其 Value 属性返回自身来实现 IReadableHolder<Foo>，从而允许期望 IReadableHolder<Foo> 的例程接受 Holder<Foo> 或 foo 本身。太糟糕了无法定义“扩展接口”来将 IHolder<String> 的实现添加到 String 类。

# python - Python：从自身内部获取对函数的引用

> ID：852401
> 
> 赞同：23
> 
> 时间：2009-05-12T12:06:30.607
> 
> 标签：python, function, self-reference

如果我定义一个函数：

```
def f(x):
    return x+3 
```

我可以稍后将对象存储为函数的属性，如下所示：

```
f.thing="hello!" 
```

我想从函数本身的代码中执行此操作。问题是，我如何从内部获取对函数的引用？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-12T12:16:43.973

同样的方法，只是使用它的名字。

```
>>> def g(x):
...   g.r = 4
...
>>> g
<function g at 0x0100AD68>
>>> g(3)
>>> g.r
4 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T12:17:10.680

如果你正在尝试做记忆，你可以使用字典作为默认参数：

```
def f(x, memo={}):
  if x not in memo:
    memo[x] = x + 3
  return memo[x] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T14:07:34.757

或者使用闭包：

```
def gen_f():
    memo = dict()
    def f(x):
        try:
            return memo[x]
        except KeyError:
            memo[x] = x + 3
    return f
f = gen_f()
f(123) 
```

恕我直言，更好一些

# python - 如何在 Django 中动态组合 OR 查询过滤器？

> ID：852404
> 
> 赞同：2
> 
> 时间：2009-05-12T12:07:20.293
> 
> 标签：python, django

从示例中，您可以看到多个 OR 查询过滤器：

> > > Article.objects.filter(Q(pk=1) | Q(pk=2) | Q(pk=3))

例如，这会导致：

```
[<Article: Hello>, <Article: Goodbye>, <Article: Hello and goodbye>] 
```

但是，我想从列表中创建此查询过滤器。怎么做？

例如 [1, 2, 3] -> Article.objects.filter(Q(pk=1) | Q(pk=2) | Q(pk=3))

# sql - 使用单个查询对 SQL 实现进行排队

> ID：852405
> 
> 赞同：0
> 
> 时间：2009-05-12T12:07:25.393
> 
> 标签：sql, sql-server, optimization, queue

我有一个如下所示的 SQL 表：

> ```
> TABLE QUEUE
>     ID
>     DATA
>     POSITION 
> ```

字段 POSITION 保存记录相对于队列的位置。所以，它可以是：

*   `0`不在任何位置（未排队）。
*   `1`队列中的第一个（行中的下一个）。
*   `> 1`在队列中的位置。

我需要一个（MS）SQL 查询，它将**队列向上移动**一个位置。

查询前：

*   09, 记录数据 09, 0
*   10、记录数据 10、1
*   11、记录数据 11、2
*   12、记录数据 12、3

查询后：

*   09, 记录数据 09, **0**
*   10、记录数据**10、0**
*   11、记录数据**11、1**
*   12、记录数据**12、2**

我怎样才能在一个查询中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T12:14:01.190

```
UPDATE QUEUE
SET POSITION = POSITION - 1
WHERE POSITION <> 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:14:59.610

将您的队列创建为链表：

```
id  parent

09  00
10  09
11  10
12  11 
```

，并像这样查询：

```
WITH vq (id, position) AS (
     SELECT  id, 1
     FROM    queue
     WHERE   parent = 0
     UNION ALL
     SELECT  id, v.position + 1
     FROM    queue q, vq v
     WHERE   q.parent = v.id
     )
SELECT  *
FROM    vq 
```

要从队列中删除元素，只需将其父元素更新为`-1`.

这比更新表中所有记录的所有位置更有效。

# php - 使用 Zend Framework 创建灵活的基础应用程序

> ID：852410
> 
> 赞同：2
> 
> 时间：2009-05-12T12:08:10.133
> 
> 标签：php, zend-framework, web-applications, modularity

我们正在开发一个利用 Zend 框架的电子商务平台。我们使用相同的代码库启动并运行了多个应用程序实例。配置设置用于区分不同的商店。

我们面临的挑战是，我们希望保持通用平台的现状，并对其进行扩展，而不是使用上述配置方法。通用平台（或基础应用程序）应包含通用控制器、模型和视图。特定于特定实例的自定义功能（控制器、模型和视图）应包含在单独的扩展中，并以插入核心平台的方式。通过这种方式，共享代码库保持干净且不会过于臃肿。

有没有人有这种方法的经验？周围有什么最佳实践吗？

任何指针都非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T21:35:39.260

我最近在我的代理机构一直在研究同样的问题，我目前正在测试的解决方案涉及以下应用程序文件夹结构：

```
app/
    default/
            controllers/
            models, etc
    ecommerce/
              controllers/
              models, etc
lib/
    S24/
        ComponentCode.php
modules/
        ecommerce/
                  admin/
                        controllers/
                        models, etc
                  default/
                          controllers/
                          models, etc
data, public web, temp, other ZF folders 
```

想法是通用组件代码存储在 中`lib`，模块化应用程序存储在 中`modules`，单个客户端网站代码存储在 中`app`。

`lib/S24`和`modules/ecommerce`文件夹对于每个项目都是通用的和相同的（我们 SVN 外部这些文件夹）。

`app`是一个模块目录，因此`default`和`ecommerce`文件夹在 ZF 中创建模块。`app/default`用于默认（即无模块）控制器。`app/ecommerce`将包含一组控制器，它们只是在`modules/ecommerce/default/controllers`.

然后，您可以根据需要扩展功能`app/ecommerce/controllers`，或添加新功能。

由于我们希望保持模块管理系统相同并且还支持多个管理系统（在 www.domain.com/admin/ecommerce 和 www.domain.com/admin/user 等 URL 中），我们直接从`modules`文件夹。然后可以将任何自定义管理页面添加到`app/admin/controllers`.

```
// Add Controller folder
$front->addControllerDirectory('/path/to/modules/ecommerce/admin/controllers', 'ecommerceAdmin');

// Add route
$router->addRoute(
    'ecommerceAdmin',
    new Zend_Controller_Router_Route('admin/ecommerce/:controller/:action',
                                     array('module' => 'ecommerceAdmin', 
                                           'controller' => 'index',
                                           'action' => 'index'))
); 
```

正如我所说，我目前正在对此进行测试，但我希望它为您自己的系统提供一些想法。一旦我得到这个完全稳定，我希望写一篇关于这个主题的博客文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T19:42:21.800

编辑：我没有注意到各种评论。因此，定制的代码不在一个单独的包中，它增加了功能并且不会覆盖。

这里的问题是您提到代码没有覆盖任何内容，而是添加了功能。您可能正在查看某种形式的插件系统，您会在其中读取带有类名的配置文件。这些类将提供有关每个插件的信息（即，如果您的 UI 使用选项卡，它将具有选项卡名称的属性）。

这实际上取决于每个实现的不同功能。获得更多信息以提供高级解决方案可能会有所帮助。

我使用 PHP 自动加载的方式（请参阅：[OOP 如何管理“包含”存储在不同文件中的类](https://stackoverflow.com/questions/779123/how-does-oop-manage-to-include-classes-stored-in-different-files/787233#787233)）根据类名创建单独的文件夹。这可能有助于将代码与其他实现分开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T12:15:29.513

我们运行的软件即服务应用程序听起来与您的平台相似，在我们的案例中，所有实例数据都存储在实例自己的数据库中。

至于处理自定义功能（代码），如果它完全是定制的，那么我想将自定义代码模块化或打包到一个容器中是有意义的，该容器可以由客户的唯一标识符引用并按需加载代码。这对于模块来说很简单，但如果您想要单独的控制器甚至动作，显然会更复杂。

一些系统构建了自己的事件/回调系统，允许注入功能，尽管这对于公共 API 更为常见。

# python - 如何在 Django 中动态组合 OR 查询过滤器？

> ID：852414
> 
> 赞同：120
> 
> 时间：2009-05-12T12:08:51.317
> 
> 标签：python, django, django-q

从示例中，您可以看到多个 OR 查询过滤器：

```
Article.objects.filter(Q(pk=1) | Q(pk=2) | Q(pk=3)) 
```

例如，这会导致：

```
[<Article: Hello>, <Article: Goodbye>, <Article: Hello and goodbye>] 
```

但是，我想从列表中创建此查询过滤器。怎么做？

例如`[1, 2, 3] -> Article.objects.filter(Q(pk=1) | Q(pk=2) | Q(pk=3))`

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2009-05-12T12:21:28.030

您可以按如下方式链接您的查询：

```
values = [1,2,3]

# Turn list of values into list of Q objects
queries = [Q(pk=value) for value in values]

# Take one Q object from the list
query = queries.pop()

# Or the Q object with the ones remaining in the list
for item in queries:
    query |= item

# Query the model
Article.objects.filter(query) 
```

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2015-03-19T16:26:07.727

要构建更复杂的查询，还可以选择使用内置 Q() 对象的常量 Q.OR 和 Q.AND 以及 add() 方法，如下所示：

```
list = [1, 2, 3]
# it gets a bit more complicated if we want to dynamically build
# OR queries with dynamic/unknown db field keys, let's say with a list
# of db fields that can change like the following
# list_with_strings = ['dbfield1', 'dbfield2', 'dbfield3']

# init our q objects variable to use .add() on it
q_objects = Q(id__in=[])

# loop trough the list and create an OR condition for each item
for item in list:
    q_objects.add(Q(pk=item), Q.OR)
    # for our list_with_strings we can do the following
    # q_objects.add(Q(**{item: 1}), Q.OR)

queryset = Article.objects.filter(q_objects)

# sometimes the following is helpful for debugging (returns the SQL statement)
# print queryset.query 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2009-05-22T13:36:12.713

使用[python 的 reduce 函数](http://docs.python.org/library/functions.html#reduce)编写 Dave Webb 答案的一种更短的方法：

```
# For Python 3 only
from functools import reduce

values = [1,2,3]

# Turn list of values into one big Q objects  
query = reduce(lambda q,value: q|Q(pk=value), values, Q())  

# Query the model  
Article.objects.filter(query) 
```

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2009-05-22T14:34:19.337

```
from functools import reduce
from operator import or_
from django.db.models import Q

values = [1, 2, 3]
query = reduce(or_, (Q(pk=x) for x in values)) 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-05-12T12:12:40.350

也许最好使用 sql IN 语句。

```
Article.objects.filter(id__in=[1, 2, 3]) 
```

请参阅[查询集 API 参考](http://docs.djangoproject.com/en/1.0/ref/models/querysets/#in)。

如果你真的需要用动态逻辑进行查询，你可以做这样的事情（丑陋+未经测试）：

```
query = Q(field=1)
for cond in (2, 3):
    query = query | Q(field=cond)
Article.objects.filter(query) 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-05-12T12:11:18.750

请参阅[文档](http://docs.djangoproject.com/en/dev/ref/models/querysets/#in-bulk-id-list)：

```
>>> Blog.objects.in_bulk([1])
{1: <Blog: Beatles Blog>}
>>> Blog.objects.in_bulk([1, 2])
{1: <Blog: Beatles Blog>, 2: <Blog: Cheddar Talk>}
>>> Blog.objects.in_bulk([])
{} 
```

请注意，此方法仅适用于主键查找，但这似乎是您想要做的。

所以你想要的是：

```
Article.objects.in_bulk([1, 2, 3]) 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2017-12-04T12:20:36.520

使用`reduce`和`or_`运算符按乘法字段过滤的解决方案。

```
from functools import reduce
from operator import or_
from django.db.models import Q

filters = {'field1': [1, 2], 'field2': ['value', 'other_value']}

qs = Article.objects.filter(
   reduce(or_, (Q(**{f'{k}__in': v}) for k, v in filters.items()))
) 
```

ps`f`是一种新的格式字符串文字。它是在 python 3.6 中引入的

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-09-24T16:01:10.333

如果我们想以编程方式设置我们想要查询的数据库字段：

```
import operator
questions = [('question__contains', 'test'), ('question__gt', 23 )]
q_list = [Q(x) for x in questions]
Poll.objects.filter(reduce(operator.or_, q_list)) 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-12T12:12:30.603

您可以使用 |= 运算符以编程方式使用 Q 对象更新查询。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-08-02T10:30:20.723

这个是动态pk列表的：

```
pk_list = qs.values_list('pk', flat=True)  # i.e [] or [1, 2, 3]

if len(pk_list) == 0:
    Article.objects.none()

else:
    q = None
    for pk in pk_list:
        if q is None:
            q = Q(pk=pk)
        else:
            q = q | Q(pk=pk)

    Article.objects.filter(q) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-08-26T10:45:46.457

直到最近我才知道的另一个选项 -`QuerySet`也覆盖了`&`, `|`,`~`等运算符。OR Q 对象的其他答案是该问题的更好解决方案，但为了感兴趣/争论，您可以这样做：

```
id_list = [1, 2, 3]
q = Article.objects.filter(pk=id_list[0])
for i in id_list[1:]:
    q |= Article.objects.filter(pk=i) 
```

`str(q.query)`将返回一个包含`WHERE`子句中所有过滤器的查询。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-01-16T04:01:50.653

对于循环：

```
values = [1, 2, 3]
q = Q(pk__in=[]) # generic "always false" value
for val in values:
    q |= Q(pk=val)
Article.objects.filter(q) 
```

减少：

```
from functools import reduce
from operator import or_

values = [1, 2, 3]
q_objects = [Q(pk=val) for val in values]
q = reduce(or_, q_objects, Q(pk__in=[]))
Article.objects.filter(q) 
```

这两个都等价于`Article.objects.filter(pk__in=values)`

`values`当空的时候考虑你想要什么是很重要的。`Q()`许多以作为起始值的答案将返回*所有内容*。`Q(pk__in=[])`是一个更好的起始值。它是一个总是失败的 Q 对象，由优化器很好地处理（即使对于复杂的方程）。

```
Article.objects.filter(Q(pk__in=[]))  # doesn't hit DB
Article.objects.filter(Q(pk=None))    # hits DB and returns nothing
Article.objects.none()                # doesn't hit DB
Article.objects.filter(Q())           # returns everything 
```

如果您*想*在为空时返回所有内容`values`，您应该 AND with`~Q(pk__in=[])`以确保该行为：

```
values = []
q = Q()
for val in values:
    q |= Q(pk=val)
Article.objects.filter(q)                     # everything
Article.objects.filter(q | author="Tolkien")  # only Tolkien

q &= ~Q(pk__in=[])
Article.objects.filter(q)                     # everything
Article.objects.filter(q | author="Tolkien")  # everything 
```

重要的是要记住 that `Q()`is *nothing*，不是一个总是成功的 Q 对象。任何涉及它的操作都会完全放弃它。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-12-18T15:50:12.393

easy..
from django.db.models import Q import you model args = (Q(visibility=1)|(Q(visibility=0)&Q(user=self.user))) #Tuple parameters={} #dic order = 'create_at' 限制 = 10

```
Models.objects.filter(*args,**parameters).order_by(order)[:limit] 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-01-06T16:06:51.740

找到**动态字段名称的解决方案**：

```
def search_by_fields(value, queryset, search_in_fields):
    if value:
        value = value.strip()

    if value:
        query = Q()
        for one_field in search_in_fields:
            query |= Q(("{}__icontains".format(one_field), value))

        queryset = queryset.filter(query)

    return queryset 
```

# asp.net - SQL Server - 存储敏感数据

> ID：852418
> 
> 赞同：2
> 
> 时间：2009-05-12T12:10:32.293
> 
> 标签：asp.net, sql, web-services, security

什么是在数据库表中存储用户名和密码（不是 asp.net 成员详细信息）的安全方法，需要将其提取并解密以用于传递给 Web 服务。

我想到问题的每一种方式都发现了安全漏洞，因为用户名和密码在传递给 Web 服务之前需要采用纯文本格式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T12:15:41.293

一些建议：

用于存储数据

1.  插入时加密数据（最好使用 CryptoAPI 调用）
2.  确保在客户端和 SQL Server 之间启用了加密
3.  如果您使用的是 SQL 2008，则启用 MDF/LDF 文件的加密

传递给 Web 服务

1.  如果您使用的是 .NET，则可以使用 SecureString 将其安全地保存在您的应用程序的内存中。
2.  确保 Web 服务使用 SSL 来确保网络安全

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T14:36:22.297

恕我直言，您永远不会解密数据...

在第一次保存数据之前，使用单向加密对数据进行加密，在密码和用户名上使用它。

当用户登录时，您加密用户名和密码，然后检查数据库上的加密值是否匹配。即你不需要解密。

因为它的一种加密方式很难解密（有人说它只需要很长时间才能让它值得黑客攻击）这就是为什么一种方式......

MS encrypto 类提供 1 路加密。

希望这可以帮助

朱尔斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T12:17:36.997

正如 Fermin 所说，您是否可以访问/控制另一端的 Web 服务。

如果是这样，您应该发送加密的详细信息。但是，即使您发送的用户名和密码对是加密的。有人仍然可以嗅探它们并拥有一对有效的 UN 和 PW。

HTTPS 在这种情况下会有所帮助。

没有 100% 安全的方式通过网络发送敏感数据。这是一个尽力而为的案例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T12:27:10.450

T-SQL 支持许多可用于加密数据的[加密函数](http://msdn.microsoft.com/library/ms173744)（例如，如果客户端尚未使用存储过程，则通过触发器代替触发器）。

在数据库引擎中进行加密应该是最后的手段，它在链的早期完成要好得多。

几年前[MSDN 杂志](http://msdn.microsoft.com/magazine)上有一篇文章介绍了这些函数的用法。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-12T12:13:06.497

你不能使用 webservice 方法来解密它们并从数据库中传递加密的字符串吗？

# java - 重新学习语言的最佳方法是什么？

> ID：852419
> 
> 赞同：15
> 
> 时间：2009-05-12T12:10:42.543
> 
> 标签：java, programming-languages

我在大学时曾经是一个 Java 书呆子，但从那以后我就再也没有碰过它。在过去的 3-4 年里，我的工作主要是 Python 和 C++，我已经忘记了很多关于 Java 的进出。

那么，让语言重新回到最佳状态的最佳（也是最快）方法是什么？关于使您使用（并因此重新学习）您已经知道的旧语言的小型项目的任何建议？

一个相关的问题是，你们如何与已经学过但很长时间没有机会使用的技术保持联系？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-12T12:18:40.410

重新学习它的最好方法是学习它的最好方法：使用它。查看 Java 5 和 6 的“新增功能”部分，了解添加了哪些新功能，但*不需要*使用所有功能。

在我看来，最好的选择是使用你熟悉的东西来“重新上马”，然后逐渐学习新的东西。

具体项目：除非有实际需要，否则我不会使用我没有使用过的语言，在这种情况下，我将使用它的项目将已经指定（工作或个人）。常年出现的欧拉问题有时很有趣，但它们让您使用的语言功能受到限制。您可以尝试的一件事是将您开发的 Python/C++ 程序之一移植到 Java。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T13:23:43.190

如果您自己是程序员，那么学习或重新学习一门语言是一项非常相似的任务。您只需要动手并在最新文档的帮助下开始编写代码。

如果您在决定编写什么代码时遇到困难，并且如果您热衷于解决需要一些计划和知识的复杂问题，我建议您查看 ACM 编程竞赛问题。它们通常是一个挑战，所以不要让它带走你的动力。在一些网站上，您可以针对自动分析测试您的代码。[http://www.spoj.pl/](http://www.spoj.pl/)就是其中之一

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T12:25:18.817

对我来说，接触我有一段时间没有机会使用的技术的最快方法是参与一个使用相关技术的开源项目。例如，如果您打算重新熟悉 java，我建议您查看 Jython 项目。这样你会在 python 部分感到安全，而你仍然需要在 java 中工作。大多数开源项目也很擅长采用新技术，即使我不确定 jython 的人是否使用最新的 java，我也会毫不犹豫地在这个赌注上投入几块钱。像这样与其他人一起编码也让您有机会查看其他人编写的代码，这将使您很容易掌握语法更改（Java 6 引入了一些）、最佳实践等，我总是觉得这真的很有帮助。此外，在这些类型的项目中，支持通常很好，因为人们都渴望继续前进。

祝您在 Java 振兴任务中好运！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T21:13:46.363

我通常用该语言编写网络服务器或爬虫程序来学习一门语言。这些都是很好的例子，因为它们让您感觉：

*   通用字符串和正则表达式库。
*   一种语言中的多线程和其他并发特性。
*   网络和文件系统支持。
*   一种语言的跨平台能力。
*   这种方法还可以评估大量的语法和工具支持。

最重要的是，这些例子只需要一两天的时间来实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T18:35:12.143

除了提供的建议之外，我建议您使用 Eclipse 或 netbeans 之类的 IDE。它们是免费的，将帮助您编写、修复、编译、运行和调试您的程序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T12:42:20.000

阅读有关该主题的高级书籍。一些例子：

[有效的 Java（第 2 版）- Joshua Bloch](https://rads.stackoverflow.com/amzn/click/com/0321356683)

[深入了解 C#：掌握 C# 2 和 3 所需的知识 - Jon Skeet](https://rads.stackoverflow.com/amzn/click/com/1933988363)

这两个作为示例为您提供了在语言的最新版本中引入的更改，这些更改应该足以让您回到正轨，并结合 Pax 提到的某种宠物项目。

我尝试阅读一些我目前不积极使用的语言高级书籍，但这取决于我的动机。

最诚挚的问候

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T12:51:47.573

为了我..

为自己选择一个项目..并开始用该语言对其进行编码..使用互联网和示例..

# blackberry - 黑莓风暴触摸事件

> ID：852420
> 
> 赞同：3
> 
> 时间：2009-05-12T12:10:55.490
> 
> 标签：blackberry, touchscreen, rim-4.7

我已经将 Blackberry 4.6.0 应用程序移植到了 4.7.0 上的 Storm。除了我试图控制的触摸事件之外，一切都运行良好。我在下面的方法中捕获触摸事件，但问题是在我在 touchEvent 中的逻辑执行并返回菜单（通过菜单按钮激活）后始终显示。我试过返回 false、true 和 super.touchEvent(message) 但它仍然出现。

关于如何防止菜单在捕获触摸事件后出现的任何想法？

```
protected boolean touchEvent(TouchEvent message)
{
     if (message.getEvent() == TouchEvent.CLICK)
     {
        //My code here
     }
} 
```

非常感谢您的想法

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-07T19:17:53.743

只是为了澄清haagmm的答案：

在将 TouchEvent.CLICK 发送到您的应用程序后，还将发送一个 navigationClick 事件。这是出于兼容性原因，因此即使应用程序没有明确编写以响应 touchEvents，像 ButtonFields 之类的东西也可以在触摸屏设备上运行。

如果您的应用程序中的字段未使用 navigationClick 事件（返回 true），则将显示上下文菜单。

如果您在单击按钮字段时看到此行为，说明默认情况下，ButtonFields 不消耗单击事件。我发现始终使用以下样式位设置构造 ButtonFields 是一种好习惯：

```
ButtonField myButtonField = 
    new ButtonField( ButtonField.CONSUME_CLICK | ButtonField.NEVER_DIRTY ); 
```

haagmm 的代码是一种解决方案，但更好的办法是复制您的 TouchEvent.CLICK 处理代码并将其粘贴到 navigationClick 方法中。这样，像 BlackBerry Tour 这样的轨迹球设备仍然可以使用您的应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T20:47:08.310

如果您“单击”屏幕或在 sim 中单击鼠标左键，您将触发上下文菜单，类似于单击 4.6 设备上的轨迹球。

您将需要在重载 touchEvent 的字段上执行类似的操作：

```
 protected boolean navigationClick(int status, int time) { return true; } 
```

# sql - 这个执行计划是重新思考我的主键的动机吗

> ID：852425
> 
> 赞同：1
> 
> 时间：2009-05-12T12:11:40.450
> 
> 标签：sql, clustered-index

当我进入我当前（雇主的）公司时，设计了一个新的数据库模式，它将成为许多未来将要创建的工具的基础。凭借我有限的 SQL 知识，我认为该表设计得相当好。我唯一担心的是几乎每个表都有一个多部分主键。每个表至少有一个 CustomerId 和它自己的键。虽然这些确实是为某个记录定义的，但我觉得多个键（我们在这里说的是四倍）效率非常低。

今天，我在一个简单的重复查询中看到了一些难以想象的 CPU 使用率，该查询连接了两个表，从第一个表中选择一个字符串字段并将它们区分开来。

```
select distinct(f.FIELDNAME) as fieldName
from foo f
inner join bar b
   on f.id = b.fId
where b.cId = @id; 
```

检查执行计划（我不是 EP Hero）我注意到有三个主要的 CPU 点。不同的（如预期的那样）和两个寻求indeces。我个人认为索引搜索应该非常快，但它们每个都占用了 18% 的成本。这是正常的吗？是因为（四重）聚集索引吗？

**--UPDATE--**
该查询用于创建 Lucene 索引。这是一个一次性处理，大约每周发生一次（我知道这听起来很矛盾）。据我所知，我不能在这里重用任何结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T12:21:05.350

您能否运行以下查询并发布其输出：

```
SELECT  COUNT(*), COUNT(DISTINCT fieldname)
FROM    foo

SELECT  COUNT(*), COUNT(DISTINCT cId), COUNT(DISTINCT fId)
FROM    bar 
```

这将有助于估计哪些索引最适合您的需求。

同时确保您具有以下索引：

```
foo (FIELDNAME)
bar (cId, fId) 
```

并重写您的查询：

```
SELECT  DISTINCT(fieldname)
FROM    foo f
WHERE   EXISTS (
        SELECT  1
        FROM    bar b
        WHERE   b.fId = f.id
                AND b.cId = @id
        ) 
```

此查询应使用索引`f.FIELDNAME`来构建`DISTINCT`列表，并使用索引`bar`来过滤掉不存在的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:29:51.893

这种查询看起来很熟悉。我在这里猜想，但是，它可能会在受到重创的 web/winform ui 上填充一个组合框。

也许您应该在应用程序端缓存结果，这样您就不会经常执行它。更糟糕的情况是，您可以将其缓存在 sql 服务器端，但它是一个巨大的混乱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T13:43:31.573

在大多数数据库中，如果未列出索引中的第一列，则不使用索引。您说 customerId 是每个主键的一部分，但您没有将它用于查询中的联接。要正确回答您的问题，我们确实需要查看`create table`foo 和 bar 的输出，或者至少是`show index from`.

也就是说，如果您像这样更改它，您的查询可能会更快：

```
select distinct(f.FIELDNAME) as fieldName
from foo f
inner join bar b
   on f.id = b.fId
   and f.cId = b.cId #Using this part of the key will speed it up
where b.cId = @id; 
```

我的评论假定您的主键按“cId，fId”有效排序，这意味着您的查询不必检查每个 cId，只需检查属于索引的那些。

# nant - 通过nant的MailLoggers发送的邮件中标记CC

> ID：852431
> 
> 赞同：1
> 
> 时间：2009-05-12T12:13:22.407
> 
> 标签：nant

我们可以使用属性 MailLogger.success.to 或 MailLogger.failure.to 通过 mailLoggers 发送邮件。我们可以在通过 MailLogger 发送的邮件中进行复写吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T19:10:34.387

您不能使用核心`MailLogger`发送 cc 消息。NAnt 使用`System.Web.Mail.MailMessage`但[不设置 cc 值](http://nant.cvs.sourceforge.net/viewvc/nant/nant/src/NAnt.Core/Log.cs?revision=1.49&view=markup#l_897)。`MailLogger`如果您需要，扩展拥有 cc 的功能并不难。

# rest - 用于查询数据的 RESTful 服务操作

> ID：852432
> 
> 赞同：1
> 
> 时间：2009-05-12T12:13:39.943
> 
> 标签：rest, resources, service

在定义面向资源的 RESTful 服务时，您认为为查询数据定义显式操作（动词）是个好主意吗？

使用 HTTP 将面向资源的 RESTful 服务上的 CRUD 操作映射到诸如 PUT、GET、POST 和 DELETE 之类的操作似乎是显而易见且容易的，但是应该如何映射查询多个资源的操作 - 使用称为“QUERY”的新操作或仍然使用返回资源集合的“GET”。

我对人们的意见和经验感兴趣...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T12:30:02.407

REST 是关于资源的。您的查询将返回什么资源？一组数据？该集合是如何识别的？它是如何参数化的？这应该确定您将与 GET 操作一起使用的 URL：

```
GET /customers  would retrieve all customers
GET /customers?q=<query> would retrieve all customers matching the query 
```

* * *

**编辑：以下对我来说不太清楚**

考虑到查询是关于检索作为一组客户的资源（例如），我开始想知道所有客户集的明确定义的子集。考虑以下事项：

```
GET /customers/state/MA              Retrieve all customers in Massachusetts
GET /customers/country/UK            All in the UK
GET /customers/country/UK/postalcode/001-234    All in that postal code in the UK 
```

像这样的资源对我来说是明确识别的资源，而不是查询。我将继续使用查询字符串来检索任意一组客户，但如果客户存在自然分区，我可能会在 URL 空间中指出这一点。

回想一下，GET 操作用于幂等操作，并且旨在促进缓存。对这些查询的响应应该允许一些合理数量的缓存（也许有一天）。这将允许客户端机器或代理服务器将结果集缓存一段时间，从而节省服务器往返行程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T12:21:51.587

我仍然会使用 a`GET`并在 URL 中提供查询的参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T22:06:03.203

返回相关资源 URI 列表作为响应。

# c# - C# 中类字段的命名偏好？

> ID：852433
> 
> 赞同：1
> 
> 时间：2009-05-12T12:13:50.473
> 
> 标签：c#, naming-conventions

我已经看到 C# 中用于字段的几种命名约定。他们是：

**下划线**

```
public class Foo
{
    private string _name;
    public string Name
    {
        get { return _name; }
        set { _name = value; }
    }
} 
```

**这个**

```
public class Foo
{
    private string name;
    public string Name
    {
        get { return this.name; }
        set { this.name = value; }
    }
} 
```

**成员前缀**

```
public class Foo
{
    private string m_name;
    public string Name
    {
        get { return m_name; }
        set { m_name = value; }
    }
} 
```

你喜欢哪个？有没有你喜欢的不同方式？只是想知道其他人的感受是最佳实践。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T12:16:40.057

我通常使用：

```
public class Foo
{
    private string name;
    public string Name
    {
        get { return name; }
        set { name = value; }
    }
} 
```

刚刚删除了这个。因为它相当多余

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T12:17:16.110

最好的做法是选择一个，并保持一致。

我*个人更喜欢“”。在我看来， “m* ”总是让“memberness”看起来很特别，就好像它是为了让来自不存在“members”的背景的开发人员受益。与“this.”类似。我宁愿只是“名字”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T12:18:13.283

1）这是一个纯粹的风格/主观问题，因此其中一个通常与另一个一样好。（我有资格这样做，因为我上次回答这样的问题时，即使有几乎相同的资格，我也有各种各样的人投票反对我并告诉我我错了。）

2）我使用的`this`方法。这是 StyleCop 使用的默认技术，目前我没有任何其他可用的源分析工具。这是完全可以接受的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T12:20:30.983

我总是使用你所说的**这种**风格，虽然我不会虔诚地使用`this.`

# qt - 如何通过 Qt 项目文件将命令的输出作为编译器标志传递？

> ID：852437
> 
> 赞同：2
> 
> 时间：2009-05-12T12:14:35.040
> 
> 标签：qt, qmake, compiler-flags

我正在尝试将“git describe”的输出添加到我的应用程序的 about 窗口中，这样更容易找出人们使用的应用程序版本。

我可以通过添加以下编译器标志来做到这一点： -DAPP_VERSION="$(git describe HEAD)"

但是由于该项目是基于qmake的，所以我想找到一种方法将其放入Qt项目文件中。这可能吗？如果是这样，怎么办？

编辑：我尝试添加以下内容：

QMAKE_CXXFLAGS += -DAPP_VERSION="$(git describe HEAD)"

但它只是给了我“-DAPP_VERSION=”，所以我想我必须使用一些转义字符，但我不知道哪些以及在哪里。：/

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T12:51:59.990

通过此链接解决了问题：[http ://robertcarlsen.net/blog/2009/01/06/qmake-xcode-bug-258](http://robertcarlsen.net/blog/2009/01/06/qmake-xcode-bug-258)

这是我用来测试它的示例 qt 项目：qt.pro：

```
######################################################################
# Automatically generated by qmake (2.01a) Thu Apr 2 16:23:05 2009
######################################################################

TEMPLATE = app
TARGET =
DEPENDPATH += .
INCLUDEPATH += .

# Input
SOURCES += qt.cpp

QMAKE_CXXFLAGS += -DAPP_DATE=\\\"`date +'\"%a_%b_%d,_%Y\"'`\\\"
QMAKE_CXXFLAGS += -DAPP_VERSION=\\\"`git describe`\\\" 
```

qt.cpp：

```
#ifndef APP_DATE
#define APP_DATE "1/1/1970"
#endif

#ifndef APP_VERSION
#define APP_VERSION "local-dev"
#endif

#include <QApplication>
#include <QLabel>
int main(int argc, char *argv[])
{
    QApplication app(argc, argv);
    QString version = QString("version ") + APP_VERSION + ' ' + APP_DATE;
    QLabel *label = new QLabel(version);
    label->show();
    return app.exec();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-17T11:26:55.433

你也可以使用

```
QMAKE_CXXFLAGS += -DAPP_VERSION=\\\"$$system(git describe HEAD)\\\" 
```

这将在 qmake 运行期间只执行一次 git 命令，这可能会加快大型项目的编译速度。但是，您必须确保在从存储库`qmake`中`make clean`提取后运行。

# c# - 如何在C#中对数组列表的元素进行排序

> ID：852439
> 
> 赞同：11
> 
> 时间：2009-05-12T12:14:42.967
> 
> 标签：c#

我有一个 ArrayList 包含，

```
[0] = "1"
[1] = "10"
[2] = "2"
[3] = "15"
[4] = "17"
[5] = "5"
[6] = "6"
[7] = "27"
[8] = "8"
[9] = "9" 
```

现在我需要对数组列表进行排序，使其变为，

```
[0] = "1"
[1] = "2"
[2] = "5"
[3] = "6"
[4] = "8"
[5] = "9"
[6] = "10"
[7] = "15"
[8] = "17"
[9] = "27" 
```

最后，我将从 ArrayList 中获取值并将它们用作**“int”**值。我怎样才能做到这一点？或者我应该先将它们转换为 int 然后对它们进行排序。？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-12T12:23:23.033

如果您可以确定列表只包含可以转换为整数的字符串，那么使用**[`IEnumerable<T>.OrderBy`](http://msdn.microsoft.com/en-us/library/bb534966.aspx)**扩展方法，试试这个：

```
var sortedList = list.OrderBy(item => int.Parse(item)); 
```

如果您使用的`ArrayList`是 a 而不是`List<string>`（嘘！），您`Cast`首先需要：

```
var sortedList = list.Cast<string>().OrderBy(item => int.Parse(item)); 
```

正如 JaredPar 所说，您还可以定义自己的比较器，但是 IMO 对于已经实现的东西来说需要做很多工作。但是，它更有效。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-12T12:20:10.110

框架中有许多排序方法，包括 ArrayList.Sort。问题是它们都将按字母而不是数字排序。您需要编写一个理解数字排序的自定义排序器。

尝试以下方法（为简洁起见，省略了一些参数检查）

```
public class NumericComparer : IComparer {
  public int Compare(object x, object y) {
    string left = (string)x; 
    string right = (string)y;
    int max = Math.Min(left.Length, right.Length);
    for ( int i = 0; i < max; i++ ) {
      if ( left[i] != right[i] ) { 
        return left[i] - right[i];
      }
    }
    return left.Length - right.Length;
  }
}

list.Sort(new NumericComparer()); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-12T12:36:29.097

实现自定义比较器并将其传递给 ArrayList.Sort()

完整代码：

```
using System;
using System.Collections;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            ArrayList a = new ArrayList();
            a.Add("1");
            a.Add("13");
            a.Add("3");
            a.Add("25");
            a.Add("2");
            a.Add("12");
            a.Sort(new CustomComparer());

            foreach (String s in a)
                Console.WriteLine(s);

            Console.Read();
        }

    }

    public class CustomComparer : IComparer
    {
        Comparer _comparer = new Comparer(System.Globalization.CultureInfo.CurrentCulture);

        public int Compare(object x, object y)
        {
            // Convert string comparisons to int
            return _comparer.Compare(Convert.ToInt32(x), Convert.ToInt32(y));
        }
    }
} 
```

输出：

1 2 3 12 13 25

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-12T12:23:07.637

也许您可以将值存储在像 List 这样的强类型列表中，并在必要时将它们转换为字符串。像这样：

```
 List<int> intList = new List<int>(new int[] {3, 2, 1});

        intList.Sort();

        foreach (int theInt in intList)
        {
            System.Diagnostics.Debug.WriteLine(theInt.ToString());
        } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T12:23:18.790

你最好用`Int`值创建另一个数组，然后用`ArrayList.Sort()`. 您可以调用`ArrayList.Sort()`并传递一个委托，将这些字符串作为数字进行比较，但速度会慢一些。慢多少取决于数组的大小，我个人认为对于小于 100 的大小并不重要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T12:40:46.307

如果这些值都是整数，那么为什么不将它们存储为整数呢？这将使排序更容易和更快。

这些值还有哪些其他用途？如果它们仅用作字符串并且仅排序一次，那么将它们保持原样可能是明智的 - 作为字符串。

另一方面，如果它们用于数学运算，那么最好将它们存储为整数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T12:42:48.753

```
 List<int> liDllCnt = new List<int>();
 for (int temp = 0; temp < alFileName.Count; temp++)
     liDllCnt.Add(Int32.Parse(alFileName[temp].ToString()));
 liDllCnt.Sort(); 
```

alFileName 是我使用的数组列表的名称。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T12:42:49.703

**这是最安全的方法**

aryList 是您的 ArrayList 实例

```
 object[] list = aryList.ToArray();
                Array.Sort<object>
                    (
                        list,
                        delegate(object x, object y)
                        {
                            int a = 0, b = 0;
                            if (x == y) return 0;
                            if (x == null || y == null)
                                return x == null ? -1 : 1;
                            int.TryParse(x.ToString(), out a);
                            int.TryParse(y.ToString(), out b);
                            return a.CompareTo(b);
                        }
                    ); 
```

结果保存到“列表”对象数组中

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-12T18:05:00.447

如果您可以将 ArrayList 项放入强类型容器中，例如 List<String> 或 String[]，那么 Linq 可以轻松完成剩下的工作。以下实现仅解析字符串值一次，并使用原始字符串及其整数值为每个值创建一个匿名类型。

```
public void Test_SortArrayList()
{
    ArrayList items = new ArrayList(new []{"1", "10", "2", "15", "17", "5", "6", "27", "8", "9"});
    string[] strings = (string[])items.ToArray(typeof(string));
    List<string> result = strings
        .Select(x => new
            {
                Original = x,
                Value = Int32.Parse(x)
            })
        .OrderBy(x => x.Value)
        .Select(x => x.Original)
        .ToList();
    result.ForEach(Console.WriteLine);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-04-11T10:26:41.820

Arraylist Sort(CaseSensitive) 升序排列对某人有帮助

```
class ArrayCaseSensitive:IComparer
    {
        int IComparer.Compare(object x, object y)
        {
            return (new CaseInsensitiveComparer().Compare(x,y));
        }

    public static void Main(string[] args)
    {
            IComparer sc = new ArrayCaseSensitive();

        ArrayList arr = new ArrayList();
        arr.Add("AB");
        arr.Add("bc");
        arr.Add("1");
        arr.Sort(sc);
        foreach(var strs in arr)
        {
            Console.WriteLine(strs);
        }

    }

} 
```

# wpf - 胖模型、瘦视图模型和哑视图，最好的 MVVM 方法？

> ID：852441
> 
> 赞同：19
> 
> 时间：2009-05-12T12:15:07.597
> 
> 标签：wpf, mvvm, architecture

通过对[这个问题](https://stackoverflow.com/questions/851595)的慷慨帮助，我整理了以下 MVVM 结构，它在 XAML（当前日期/时间）中实时显示模型的变化，非常好。

> 此设置的一个很酷的优点是，当您在Visual Studio 或 Blend*的设计模式下查看视图时，**您会看到时间在滴答作响*，这意味着*在设计时您可以访问模型中的实时数据。*

在让它工作的过程中，我很惊讶地看到**大部分内容从我的 ViewModel 转移到了我的 Model**中，包括 INotifyPropertyChange 的实现。另一个变化是我**不再绑定到ViewModel 上的*属性，而是绑定到**方法***。

所以目前这是我最喜欢的 MVVM 风格：

1.  视图很愚蠢：

    *   为模型中需要的每个对象提供一个 ObjectDataProvider
    *   每个 ObjectDataProvider 映射到 ViewModel 上的一个方法（不是属性）
    *   XAML 元素中没有 x:Name 属性
2.  ViewModel 很瘦：

    *   ViewModel 中唯一的东西是视图绑定的*方法*
3.  模型很胖：

    *   该模型在其每个属性上实现 INotifyPropertyChanged。
    *   对于您的 ViewModel 上的每个方法（例如 GetCurrentCustomer），您的模型中都有一个相应的*单例方法*（例如 GetCurrentCustomer）。
    *   该模型负责任何实时线程功能，如本例所示

**问题：**

1.  那些在实际场景中实现过 MVVM 的人，这是否也是您确定的基本结构，如果不是，您的结构有何不同？
2.  您将如何扩展它以包括路由命令和路由事件？

*如果您只是将 XAML 和代码复制到新的 WPF 项目中，则以下代码将起作用。*

**XAML：**

```
<Window x:Class="TestBinding99382.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TestBinding99382"
    Title="Window1" Height="300" Width="300">

    <Window.Resources>
        <ObjectDataProvider 
             x:Key="DataSourceCustomer" 
             ObjectType="{x:Type local:ShowCustomerViewModel}" 
                        MethodName="GetCurrentCustomer"/>
    </Window.Resources>

    <DockPanel DataContext="{StaticResource DataSourceCustomer}">
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
            <TextBlock Text="{Binding Path=FirstName}"/>
            <TextBlock Text=" "/>
            <TextBlock Text="{Binding Path=LastName}"/>
        </StackPanel>
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
            <TextBlock Text="{Binding Path=TimeOfMostRecentActivity}"/>
        </StackPanel>

    </DockPanel>
</Window> 
```

**代码背后：**

```
using System.Windows;
using System.ComponentModel;
using System;
using System.Threading;

namespace TestBinding99382
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }
    }

    //view model
    public class ShowCustomerViewModel
    {
        public Customer GetCurrentCustomer() {
            return Customer.GetCurrentCustomer();
        }
    }

    //model
    public class Customer : INotifyPropertyChanged
    {
        private string _firstName;
        private string _lastName;
        private DateTime _timeOfMostRecentActivity;
        private static Customer _currentCustomer;
        private Timer _timer;

        public string FirstName
        {
            get
            {
                return _firstName;
            }
            set
            {
                _firstName = value;
                this.RaisePropertyChanged("FirstName");
            }
        }

        public string LastName
        {
            get
            {
                return _lastName;
            }
            set
            {
                _lastName = value;
                this.RaisePropertyChanged("LastName");
            }
        }

        public DateTime TimeOfMostRecentActivity
        {
            get
            {
                return _timeOfMostRecentActivity;
            }
            set
            {
                _timeOfMostRecentActivity = value;
                this.RaisePropertyChanged("TimeOfMostRecentActivity");
            }
        }

        public Customer()
        {
            _timer = new Timer(UpdateDateTime, null, 0, 1000);
        }

        private void UpdateDateTime(object state)
        {
            TimeOfMostRecentActivity = DateTime.Now;
        }

        public static Customer GetCurrentCustomer()
        {
            if (_currentCustomer == null)
            {
                _currentCustomer = new Customer 
                     {  FirstName = "Jim"
                        , LastName = "Smith"
                        , TimeOfMostRecentActivity = DateTime.Now 
                     };
            }
            return _currentCustomer;
        }

        //INotifyPropertyChanged implementation
        public event PropertyChangedEventHandler PropertyChanged;
        private void RaisePropertyChanged(string property)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(property));
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-12T20:54:08.657

这是我的意见，因为它的价值：

我不太同意您建议的方法（愚蠢的观点除外）。在现实生活中，您通常必须使用现有模型：它可能是您没有时间（或将）更改的遗留代码，甚至是您没有代码的库。在我看来，模型应该完全不知道它的显示方式，并且应该可以在非 WPF 应用程序中轻松使用。所以它不需要实现任何特定的接口，比如让它在 MVVM 中可用`INotifyPropertyChanged`。`INotifyCollectionChanged`我认为所有与 UI 相关的逻辑都应该驻留在 ViewModel 中。

关于`RoutedEvents`和`RoutedCommands`，它们并不真正适合与 MVVM 模式一起使用。我通常尽量少用，一点`RoutedEvents`也不用`RoutedCommands`。相反，我的 ViewModel 公开`RelayCommand`了我在 XAML 中绑定到 UI 的属性（有关详细信息，请参阅 Josh Smith 的[这篇文章](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)`RelayCommand`）。当我真的需要为某些控件处理事件时，我使用附加的行为将事件映射到 ViewModel 命令（看看[Marlon Grech 的实现](http://marlongrech.wordpress.com/2008/12/13/attachedcommandbehavior-v2-aka-acb/)）

所以，总而言之：

*   哑视图
*   大而智能的 ViewModel
*   您想要或必须使用的任何模型

当然这只是我的方法，它可能不是最好的，但我觉得很舒服；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-08T20:12:45.577

我同意托马斯的观点。我对 WPF 架构的任何人的建议是：

*   没有 INotifyPropertyChange、状态跟踪、BL 等的普通 POCO 实体。
*   即时通知视图的简单和小型 ViewModel
*   带有智能导航系统的简单可重用 UI，避免了复杂的数据层次结构和复杂的底层 ViewModel
*   MVVM 使用 View First 方法来保持简单的依赖关系
*   使用 Tasks 或 Rx 进行异步操作
*   一个简单的主题
*   没有复杂健壮的 UI，保持简单，只需利用 WPF 的 UI 组合和绑定功能
*   不要犹豫，使用代码隐藏来动态生成内容（表单、列表等），并在声明式眼睛配置上节省大量时间（适用于大多数情况）——对我来说，2015 年必须这样做。使用扩展方法创建 Fluent API为了那个原因。

# c# - C# 相当于 C 联合

> ID：852442
> 
> 赞同：5
> 
> 时间：2009-05-12T12:15:11.293
> 
> 标签：c#, c, unions

> [C#中C++联合的](https://stackoverflow.com/questions/126781/c-union-in-c)重复

是否有与 C union typedef 等效的 C#？C# 中以下内容的等价物是什么？

```
typedef union byte_array
{
    struct{byte byte1; byte byte2; byte byte3; byte byte4;};
    struct{int int1; int int2;};
};byte_array 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T12:18:01.940

C# 本身不支持联合的 C/C++ 概念。但是，您可以使用 StructLayout(LayoutKind.Explicit) 和 FieldOffset 属性来创建等效功能。请注意，这仅适用于 int 和 float 等原始类型。

```
using System;
using System.Runtime.InteropServices;

[StructLayout(LayoutKind.Explicit)]
struct byte_array
{
    [FieldOffset(0)]
    public byte byte1;

    [FieldOffset(1)]
    public byte byte2;

    [FieldOffset(2)]
    public byte byte3;

    [FieldOffset(3)]
    public byte byte4;

    [FieldOffset(0)]
    public short int1;

    [FieldOffset(2)]
    public short int2;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:21:06.253

使用该[`StructLayout`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute.aspx)属性，它看起来有点像这样：

```
 [StructLayout(LayoutKind.Explicit, Pack=1)]
    public struct ByteArrayUnion
    {
        #region Byte Fields union

        [FieldOffset(0)]
        public byte Byte1;

        [FieldOffset(1)]
        public byte Byte2;

        [FieldOffset(2)]
        public byte Byte3;

        [FieldOffset(3)]
        public byte Byte4;

        #endregion

        #region Int Field union

        [FieldOffset(0)]
        public int Int1;

        [FieldOffset(4)]
        public int Int2;

        #endregion
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T12:36:37.647

你的问题没有说明你的目的是什么。如果您希望将数据编组为 pinvoke，那么上述 2 个答案是正确的。

如果没有，您只需执行以下操作：

```
class Foo
{
  object bar;
  public int Bar {get {return (int)bar; } }
  ...
} 
```

# sql-server - SQLSERVER2005中的sqlserver分析服务有什么用

> ID：852443
> 
> 赞同：0
> 
> 时间：2009-05-12T12:15:13.573
> 
> 标签：sql-server, sql-server-2005

sqlserver2005中的sqlserver分析服务有什么用？

我们应该在哪里使用分析服务？如何配置这些分析服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T12:45:49.010

您可以在 MSDN 上找到您需要了解的有关 SQL Server 分析服务的所有信息

[http://msdn.microsoft.com/en-us/library/ms175609(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms175609(SQL.90).aspx)

消化材料后，请随时提出具体问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T13:27:28.283

SSAS 是帮助推动报告技术的数据仓库技术的集合。ssas 的主要功能之一是立方体。

# asp.net - Web 应用程序中的后退按钮

> ID：852446
> 
> 赞同：2
> 
> 时间：2009-05-12T12:15:38.470
> 
> 标签：asp.net

我的 Web 应用程序包含多个页面。我需要保证当我在浏览器中单击返回时，它会执行页面加载事件，因为在最后一页中，当我单击烘焙时，它会带来上一页，但它不会执行页面加载，这会导致问题。我很感激任何帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T12:27:13.943

使用后退按钮时，浏览器会显示页面的缓存版本。它不会向您的服务器发送新请求。这就是您的 Page_Load 没有触发的原因。

您可能想查看[HttpCachePolicy.SetCacheability](http://msdn.microsoft.com/en-us/library/c4yy9w70.aspx)，它允许您控制缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T12:27:45.097

我怀疑您需要确保该页面未缓存在浏览器中。

HTTP 标头，例如

```
Cache-Control: private, max-age=0 
```

应该做到这一点。

尽管不同的 Web 浏览器可能会以不同的方式实现这一点，并且用户的设置可能会覆盖 HTTP 标头指令。

（这是推测，我没有测试过）

以不依赖页面加载事件的方式编写应用程序会更好。

# jquery - 将 jQuery 点击事件添加到动态添加的内容

> ID：852450
> 
> 赞同：15
> 
> 时间：2009-05-12T12:16:11.773
> 
> 标签：jquery

我有一个由 php 和 mySQL 填充的包含多行和多列的表。对于一些 td，我在 document.ready 函数中添加 jQuery click-events 以让用户更改内容。

但我也可以选择向表中添加行并手动填充它们。但是由于我要添加的行在文档上没有准备好，它们不会附加单击事件处理程序，因此我无法单击它们来获取输入框。

```
<table>
  <tr>
    <td class="clickable">Some info</td>
    <td class="clickable">Some more info</td>
    <td>Unchangable info</td>
  </tr>
  ... more similar rows ...
</table> 
```

然后是 jQuery

```
$("tr.clickable").click(function() {
   //add input fields
}

$("span#addNewRow").click(function() {
   $("table").append('<tr><td class="clickable"></td> ... </tr>')
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-12T12:19:09.177

您想使用1.3 中引入的[实时事件。](http://docs.jquery.com/Events/live)

```
$("tr.clickable").live("click", function() {
   //add input fields
});

$("span#addNewRow").live("click", function() {
   $("table").append('<tr><td class="clickable"></td> ... </tr>')
}); 
```

更新：请注意，从 jQuery 1.7 开始，`live()`已弃用。改为使用`on()`。在某些情况下，`delegate()`可能是更好的选择。请参阅下面的评论。

如何使用示例[`.on()`](https://api.jquery.com/on/)：

```
$("table").on("click", "tr.clickable", function() {
   //add input fields
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-09-03T17:11:10.163

您可以使用 .delegate() 函数，它基于一组特定的根元素，将处理程序附加到一个或多个与选择器匹配的所有元素的事件，现在或将来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T12:19:34.480

使用[实时](http://docs.jquery.com/Events/live)事件处理程序。它不处理所有事件，但它确实处理单击事件。处理程序将绑定到与选择器匹配的所有当前和未来元素。

```
$('tr.clickable').live( 'click', function() {
   ...
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T12:20:40.203

插入元素后，您必须添加事件侦听器。

如果您使用的是 JQuery，您可以使用 jQuery 库[livequery](http://plugins.jquery.com/project/livequery)，它允许您将事件添加到尚未在 dom 中的元素，以便在向 dom 中插入新内容时不必重新绑定事件。

# iphone - iPhone OS 中的标准视图高度有什么好的概览图吗？

> ID：852451
> 
> 赞同：1
> 
> 时间：2009-05-12T12:16:18.450
> 
> 标签：iphone, cocoa-touch, uikit

我经常遇到问题，我不知道我必须放置多少空间来放置视图。

为状态栏保留了 20 个单位。标签栏，导航栏等怎么样？当然我可以查到，但是网上有没有什么好的图表可以显示所有这些高度？

让我们知道！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T06:19:03.043

我发现经过几个月的 iPhone 工作后，您将记住所有标准尺寸以及特定于您的应用程序的尺寸。

我发现自己经常使用内置的 mac 屏幕截图实用程序来测量模拟器上元素的像素尺寸。（Command-Shift-4）我将框画到我需要的大小。记下尺寸，然后记下他的 Escape，这样快照就不会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T14:40:16.070

还需要注意的是，在 IB 中，如果您选择视图，属性检查器的第一个面板具有“模拟指标”部分 - 您可以在其中模拟添加状态栏、顶部栏和底部栏。这会改变您的视图，以便您可以看到添加这些东西后的外观。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T05:52:37.493

另一个是 Erica Sadun 的 iphone Developer's Cookbook。我有它，它涵盖了纵向和横向模式的所有高度和框架。

我显然无法发布图片，但您可以自己购买这本书：http: [//www.amazon.com/iPhone-Developers-Cookbook-Building-Applications/dp/0321555457](https://rads.stackoverflow.com/amzn/click/com/0321555457)

不是最强的 iPhone 开发人员文本，但确实有一些有用的东西，尤其是在以编程方式布局视图时。（主要是在 IB 为 iPhone 工作之前写的）

# java - AccessController.doPrivileged

> ID：852453
> 
> 赞同：21
> 
> 时间：2009-05-12T12:16:39.993
> 
> 标签：java, security, api, jakarta-ee

我试图弄清楚一些遗留代码在做什么。这条线到底在做什么，为什么我需要这种方式？

```
String lineSeparator = (String) java.security.AccessController.doPrivileged(
       new sun.security.action.GetPropertyAction("line.separator")); 
```

我在 Weblogic 8 上运行的 web/ejb 应用程序的记录器实现中找到了它。据我所知，没有启用任何特殊的安全策略。（我不喜欢从 sun.* 包进口，所以我想摆脱这条线 ;-)

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-12T12:21:03.400

它只是获得系统属性。检索系统属性需要调用代码可能没有的权限。断言调用类的`doPrivileged`特权，而不管它是如何被调用的。显然，`doPrivileged`这是您需要小心的事情。

引用的代码相当于：

```
String lineSeparator = java.security.AccessController.doPrivileged(
    new java.security.PrivilegedAction<String>() {
        public String run() {
            return System.getProperty("line.separator");
        }
    }
 ); 
```

（您不只是喜欢 Java 语法的简洁性吗？）

在不声明特权的情况下，这可以重写为：

```
String lineSeparator = System.getProperty("line.separator"); 
```

# android - 为什么Android找不到android.graphics.OpenGLContext？

> ID：852462
> 
> 赞同：4
> 
> 时间：2009-05-12T12:17:54.767
> 
> 标签：android, opengl-es

我正在尝试在 SDK 1.5 中编译一些网络上可用的 OpenGL 示例。但是 android.graphics.OpenGLContext 的导入语句给了我一个错误，说找不到该类。

谁能告诉我在哪里可以找到这门课。如果 android SDK 不再支持它，那么我如何将示例移植到 1.5。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T09:20:25.020

据我所知，所有 OpenGL 的东西都在 0.9 版左右移动了。看起来它现在主要包含在[javax.microedition.khronos.egl](http://developer.android.com/reference/javax/microedition/khronos/egl/package-summary.html)和[javax.microedition.khronos.opengles](http://developer.android.com/reference/javax/microedition/khronos/opengles/package-summary.html)包中。也就是说，我认为您正在寻找的课程是[javax.microedition.khronos.egl.EGLContext](http://developer.android.com/reference/javax/microedition/khronos/egl/EGLContext.html)。

就我个人而言，我怀疑依赖任何较旧的代码/教程，因为 Android 在过去一年中经历了一些相当重大的变化。

# delphi - 如何检查 Delphi 类是否被声明为抽象类？

> ID：852468
> 
> 赞同：6
> 
> 时间：2009-05-12T12:19:20.393
> 
> 标签：delphi, rtti

在 Delphi 中是否可以使用 RTTI（或其他东西）来检查一个类是否被声明为抽象？就像是：

```
TMyAbstractClass = class abstract(TObject)
  // ...
end;

...

if IsAbstract(TMyAbstractClass.ClassInfo) then
  ShowMessage('Yeah')
else
  ShowMessage('Computer says no...'); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T14:25:50.477

我没有足够新的版本来直接回答您的问题，但请记住，*该类*是否是抽象的*并不*重要。所做的只是让编译器阻止你直接在类上调用构造函数。如果您将类引用放入类引用变量中，编译器将允许您调用该变量的构造函数，并且在运行时您将拥有一个本应不可实例化的类的实例。

 *```
var
  c: TClass;
  o: TObject;
begin
  c := TMyAbstractClass;
  o := c.Create;
  Assert(o is TMyAbstractClass);
end; 
```

真正重要的是**该类是否有任何抽象方法**。你可以很容易地检查。查看班级的 VMT。任何包含指向指针的虚方法槽`System._AbstractError`都是抽象方法。棘手的部分是知道要检查多少虚拟方法槽，因为没有记录。[Allen Bauer 在对另一个问题](https://stackoverflow.com/questions/760513/where-can-i-find-information-on-the-structure-of-the-delphi-vmt)的回答中[演示了如何做到这一点](https://stackoverflow.com/questions/760513/where-can-i-find-information-on-the-structure-of-the-delphi-vmt/761101#761101)，但在评论中 Mason Wheeler 指出它可能会返回比应有的更大的值。他提到了[JCL](http://jcl.sf.net/)中的函数，它应该更准确地计算用户定义的虚拟方法。使用该函数 和，同样来自 JCL，我们得到了这个函数：[`GetVirtualMethodCount`](http://jcl.svn.sourceforge.net/viewvc/jcl/trunk/jcl/source/common/JclSysUtils.pas?revision=2692&view=markup#l_277)[`GetVirtualMethod`](http://jcl.svn.sourceforge.net/viewvc/jcl/trunk/jcl/source/common/JclSysUtils.pas?revision=2692&view=markup#l_279)

```
function HasAbstractMethods(c: TClass): Boolean;
var
  i: Integer;
begin
  Result := True;
  for i := 0 to Pred(GetVirtualMethodCount(c)) do
    if GetVirtualMethod(c, i) = @_AbstractError then
      exit;
  Result := False;
end; 
```

如果一个抽象类没有抽象方法，那么它到底能有多抽象呢？它必须被标记为抽象以防止开发人员创建它的实例，但如果你真的想要，无论如何你都可以创建它的实例，所以标记一个抽象类实际上更像是一个警告，而不是对使用的任何实际限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T14:15:48.950

快速浏览 TypInfo 单元并没有发现任何帮助。我认为“抽象类”的概念纯粹是为了编译器的利益。它给了它一个强制执行的规则——没有这个类的实例化，只有它的后代——但在运行时并没有真正做任何事情，所以没有必要为它记录任何 RTTI。

只是出于好奇，你为什么要找出这个问题？

# visual-studio - Visual Studio 2008 帮助加载缓慢... 怎么回事？

> ID：852494
> 
> 赞同：5
> 
> 时间：2009-05-12T12:24:07.383
> 
> 标签：visual-studio, performance

最近，从 Visual Studio 引入帮助窗口需要很长时间。

即使更新帮助系统也需要很长时间。

我的安装有问题吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T12:28:45.670

不，Visual Studio 帮助中有问题。简直糟透了。

一旦你打开它，*保持*它打开，所以它不必重新加载。或者只是不使用它，并在网上查找所有内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-24T15:48:43.537

也许它试图做的比你需要做的更多？默认情况下，它会搜索在线帮助以及本地信息。

我进入工具，选项并禁用了每个在线选项，它立即出现。

在我的特殊情况下，99% 的时间我只是在寻找语法说明或查找班级成员。所以当地的帮助是我需要的。

如果我想搜索 MSN 或 Code Guru 或其他东西，我可以在帮助中临时重新启用它或谷歌它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T12:27:46.703

因为 Visual Studio 是一个怪物。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-08T15:38:51.193

我猜要么是由于在线依赖，要么是因为核心数据库非常庞大。尝试禁用在线内容并查看。

就我个人而言，我只是在谷歌上搜索“blah blah blah **msdn** ”，它做同样的事情，但是这比在我的硬盘上保存信息要快，这太疯狂了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T12:29:17.527

没有更多信息很难说。你最近有没有安装任何插件？当我安装 Resharper 一次时，我的 Visual Studio 变得非常缓慢。它可能是这样的。

或者，您有一个非常大的解决方案开放？（例如一个有很多很多项目）。这也会减慢 Visual Studio 的速度。

# windows - 为 COM 接口启用编组需要什么？

> ID：852497
> 
> 赞同：4
> 
> 时间：2009-05-12T12:25:37.333
> 
> 标签：windows, com, interop, marshalling, atl

我有一个没有类型库的 32 位 ATL COM 组件。它有一个用于实现多个接口的给定类的类工厂。

当我将它用作进程内服务器时，一切正常 - 客户端调用 CoCreateInstance()，实例化对象，QueryInterface() 检索指向请求接口的指针。但是当我将组件放入 COM+ 时，我不再可以实例化该类 - CoCreateInstance() 现在返回 E_NOINTERFACE。

我认为问题在于 COM+ 由于缺少类型库而无法执行封送处理——它不知道该怎么做。我需要生成并注册一个类型库来解决这个问题还是有其他方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T13:36:56.097

类型库是支持编组的一种方式，代理/存根 DLL（从 IDL 生成）是另一种方式。但是，在这两种情况下，您首先都需要 IDL。

如果 Microsoft 没有为此接口提供类型库/代理 DLL 或 IDL，那么可能是有原因的：可能接口使用不可编组的数据结构，需要函数指针作为方法参数传递或类似的东西？如果是这种情况，则无法使此接口适用于 DCOM。

也许您可以重建 IDL，但很可能，它只是不可行。然后你最后的后备可能是使用自定义或处理程序编组，但这可能不值得付出努力。也就是说，我建议考虑其他不涉及使用 DCOM 接口的路由，这些接口不是为 DCOM 设计的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-07-08T12:06:15.553

对于使用 Microsoft 的默认编组程序可编组的 COM 接口，该接口必须在其标头中定义 DUAL 或 OLEAUTOMATION 属性。

如果定义的方法的参数是接口指针，则相同的要求扩展到这些接口。

另外，接口名称必须出现在定义它的 IDL 的 LIBRARY 部分中。这也扩展到其他引用的接口。

如果不满足这些条件，则接口将无法编组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T13:36:03.523

乌尔克。我建议您在[microsoft.public.vc.atl](http://groups.google.com/group/microsoft.public.vc.atl/topics)上询问，因为我认为您会在那里找到更多专家。我认为（尽管我不是专家）这个问题与 COM+ 的关系比注册代理/存根的问题要少。（换句话说，即使您编写了自己的 COM 客户端以在进程外访问您的组件，您也可能会遇到同样的问题）如果您有标准的自动化兼容接口，那么 Windows 就知道如何编组您的对象美好的。但否则它是混乱的。

如果没有类型库，您要么需要注册代理/存根，要么需要自己实现 IMarshal 来处理自定义封送处理。（或者还有这个我不明白的“处理程序编组”的东西）

您对为什么没有类型库（实现了微软已经定义的接口，但没有类型库的接口）的评论引起了我的注意。你能提供更多细节吗？如果它在 .DLL 或 .EXE 中，但类型信息在库本身内部（而不是外部 .TLB 文件），则可能提取正确的信息以使一切正常，我只是不熟悉过程。

（作为记录，我已经放弃了 ATL/COM 编程，转而使用 Java，所以虽然我可以让你知道我过去记得的东西，但我现在不使用这些工具，我很难再回来了进入他们以提供更多帮助。但是 microsoft.public.vc.atl 上的人非常聪明。）

# asp.net - MVC 适合我吗？

> ID：852498
> 
> 赞同：4
> 
> 时间：2009-05-12T12:25:52.810
> 
> 标签：asp.net, asp.net-mvc

我目前正在学习“传统”的 ASP.NET，但是关于 ASP.NET MVC 的讨论很多。我应该现在进入 MVC，还是先对传统的 webforms 有一个很好的了解？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-12T12:30:35.667

进入MVC。现在。永远不要回头。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T12:30:33.140

如果您还没有学习过 ASP.NET Webforms，那么您必须问自己是否真的想学习 Web 开发。

ASP.NET MVC 向您展示 HTML、Javascript 和 CSS 的快乐/痛苦/美丽/丑陋。ASP.NET Webforms 试图尽可能地让你远离这一切。

就个人而言，我宁愿知道我的应用程序中发生的一切，即使这有时意味着更多的工作，这使我更喜欢 ASP.NET MVC。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-19T13:27:16.003

在开始使用 asp.net webforms 并转向 asp.net mvc 之后，我可以轻松地说我更喜欢 asp.net mvc。有些人会喜欢 webforms，而有些人会喜欢 mvc。Webforms 已经存在了很长时间，并且拥有非常丰富的社区，并且您可以下载和购买无数的用户控件。

Webforms 对于 Winforms 开发人员和任何有基于事件编程经验的人来说都非常熟悉。然而，在我看来，Webforms 是相当重量级的。它使您眼前一亮，为您提供编码 asp.net 页面的体验，感觉*有点*像创建 Windows 应用程序。将控件拖到页面上（或自己编写标记）并为 OnClick 等注册事件处理程序和数据绑定数据源等。

为了很好地掌握 Webforms，您需要对 asp.net 页面生命周期和发生的所有事件有很好的理解。这对于确保您在页面生命周期的正确阶段对控件进行数据绑定、正确恢复视图状态等至关重要。这是一个网络表单学习曲线。

正如其他人所说，MVC 需要更多的 html、javascript/JQuery、CSS 知识以及对模型、视图、控制器范式的一般理解。

虽然我相信asp.net webforms 4？已经在生产稍微干净的 html 方面取得了进展，但您仍然会遇到复杂页面的问题，例如臃肿的视图状态、难看的 html 等。

好的是使用像 ASP.NET MVC 这样的框架，然后利用一些 web 窗体控件，如图表、报表服务器。然而，与其像在 asp.net mvc 中的页面那样将它们直接放入您的视图中，不如从 MVC 中抽象出 webforms 组件并让它们返回图像或 FileContentResult 或类似的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T12:30:38.410

这是一篇很好的文章，可以帮助您做出决定：[http ://weblogs.asp.net/shijuvarghese/archive/2008/07/09/asp-net-mvc-vs-asp-net-web-form.aspx](http://weblogs.asp.net/shijuvarghese/archive/2008/07/09/asp-net-mvc-vs-asp-net-web-form.aspx)

真的，虽然这取决于你想做什么，尽管 MVC 看起来会是前进的方向。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T12:30:41.437

我会说一头扎进 ASP.NET MVC。您无需学习 WebForms 的详细信息即可理解它，并且您将避免养成很多可能的坏习惯。MVC 在鼓励更简洁的编码和突出应用程序中的痛点方面要好得多。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-12T12:30:59.317

如果您刚刚开始使用 WebForms 并且正在考虑使用 MVC，那么我会做出飞跃。在这一点上学习 WebForms 不会真正帮助您，并且可能会使您对 MVC 感到困惑。即使它使用相同的框架，它也是一种完全不同的开发模型。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-12T13:15:58.420

我去年开始学习 ASP.NET 网络表单。现在我沉浸在 MVC 开发工作中。我不得不说，我很欣赏对正在发生的事情有更多的控制和了解。我不知道花了多少时间试图弄清楚网络表单逻辑在幕后做了什么。使用 MVC，您可以通过尽早了解关注点分离来获得更好的编程概念。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-12T12:31:55.130

看看这篇之前[的帖子](https://stackoverflow.com/questions/793317/asp-net-mvc-features-benefits)，了解 Web 表单的一些特性和优势。

使用 Web 表单已经有一段时间了，我建议尝试 MVC，它是一个很好的框架，并且比最初看起来更易于使用！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-12T14:59:24.293

我建议从 MVC 开始。Webforms 可以说是一种 hack - 尝试使用与 winforms 相同的事件模型使 Web 可编程。您可能会花费大量时间来尝试破解该技巧。MVC 受益于关注点的清晰分离，更容易测试，并鼓励更好的架构。

您将失去的（至少现在）是“拖放”大量商业 asp.net 组件的能力，以及 Visual Studio 可能为您提供的设计器快捷方式。由于它是如此新，您可能还会限制您的工作前景（尽管您可能会对网络的工作方式有更好的核心理解）。

但是这样说吧，我已经在 MVC 上工作了大约一年，回到 webforms 的想法让我脊背发凉。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-06-18T08:58:43.097

毫无疑问，MVC 在某种意义上是一个令人敬畏的软件工程世界。

1.  当您在 MVC 中做事时，您会逐渐熟悉 MVC 模式和大多数 MVC 框架 Web 工具，如 asp.net mvc、Zend Framework 等，甚至可以构建或自定义您自己的..

2.  在 Mvc 中，减少代码复杂性很有趣，因为您只需要在视图上拥有一个模型，如 index.aspx ——您需要报表模型类或报表视图模型，它们甚至可以提高生产力、可读性和性能。

3.  asp.net 中的 MVC 有很酷的插件，比如 twitter bootstrap、DI 容器、UNIT TESTING——这个非常棒，还有很多高级工具可供使用。

4.  [你看过这个链接吗！](http://www.codeproject.com/Articles/528117/WebForms-vs-MVC)——请阅读

# sql - 转换nvarchar值时如何解决转换失败？

> ID：852499
> 
> 赞同：0
> 
> 时间：2009-05-12T12:25:57.707
> 
> 标签：sql, sql-server, sql-server-2005

```
CREATE TABLE #Temp (VisitingCount int, [Time] int, [Date] nvarchar(50) )
DECLARE @DateNow DATETIME,@i int,@Time int, @Date nvarchar(50)
set @DateNow='00:00'  
set @i=1;  
while(@i^60;48)  
    begin  
        set @DateNow = DATEADD(minute, 30, @DateNow)
        set @Time = (datepart(hour,@DateNow)*60+datepart(minute,@DateNow))/30 
        set @Date = CONVERT(VARCHAR(5),@DateNow, 108)
        insert into #Temp(VisitingCount,[Time],[Date]) values(0,@Time,@Date )
        set @i=@i+1
    end 
```

```
select Sum(VisitingCount)as VisitingCount, [Time],Date
from (
  select Sum(VisitingCount)as VisitingCount, [Time],Date
    from #Temp group by [Time],Date
  Union All
    select count(page) as VisitingCount,CONVERT(VARCHAR(5),Date, 108), 
    (datepart(hour,Date)*60+datepart(minute,Date))/30 as [Time]
    from scr_SecuristLog
    where Date between '2009-05-12' and '2009-05-13'
    GROUP BY (datepart(hour,Date)*60+datepart(minute,Date))/30,CONVERT(VARCHAR(5),Date, 108)
  ) X
group by [Time],Date
order by 2 asc 
```

### 错误

消息 245，级别 16，状态 1，行 1 将 nvarchar 值“00:30”转换为数据类型 int 时转换失败。

### 错误区域：选择 Sum(VisitingCount)as VisitingCount, [Time],Date.......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T12:32:52.960

在联合的第二部分中，使用的数据类型是（int、日期、时间），而在第一部分中，它们是（int、时间、日期）。尝试更改联合的第一部分或第二部分中列的顺序。

# macos - 视频流问题

> ID：852506
> 
> 赞同：2
> 
> 时间：2009-05-12T12:27:59.293
> 
> 标签：macos, streaming, quicktime, vlc, asx

我正在开发一个视频流应用程序，到目前为止，它的兼容性仅限于 Windows 和 IE（尽管它似乎在 Firefox 上也能很好地工作）

我的任务是让它在 Mac 上工作，在未来的 Unix 上也是如此，但我认为如果我让 Mac 工作，UNIX 将会紧随其后。

我们使用的是 Windows Media Streaming Server，带有一个包含流媒体的 .asx 播放列表文件。URL 也可能包含一个字幕文件，它有点像这样：

mms://192.168.xx.xxx/video/movie99.wmv?SAMI= [http://192.168.xx.yyy/subs/movie99.smi](http://192.168.xx.yyy/subs/movie99.smi)

现在，当谈到 Mac OSX 时，我很迷茫，但我设法让视频与 Flip4Mac 一起工作，这似乎是 Quicktime 的某种“Microsoft Kit”。我还让它与 Firefox 和 Safari 中的 VLC 插件一起使用。但是，我一辈子都无法让字幕正常工作。

我愿意听听您能想到的任何解决方案。Javascript魔法？在mac上安装一些东西？使用 java web start 启动一个运行命令行参数的应用程序，该参数以字幕文件开头 vlc？打我 ：）

我不想听到的唯一解决方案是“制作 youtube”之类的东西。感谢我们不必重写所有核心功能的简单解决方案:)

问候， 王牌

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T18:36:07.570

不幸的是，在 Windows Media Player 之外，串流字幕绝对不容易：

[http://wiki.videolan.org/Subtitles](http://wiki.videolan.org/Subtitles)甚至这么说。

如果您有可用的源视频，我认为您最好的选择是将替代媒体提供给 Windows/IE 以外的平台。

您可以为浏览器检测编写 Javascript，然后请求正确的 URL（即 Windows 的流媒体/字幕、流媒体或带有嵌入字幕的流媒体，如果需要字幕）。

我快速搜索了嵌入字幕并获得了这篇文章。它有一些用于在媒体中嵌入字幕的工具的链接：

[http://mwolk.com/blog/how-to-embed-subtitles-into-videos/](http://mwolk.com/blog/how-to-embed-subtitles-into-videos/)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T17:00:43.423

好吧，这可能不是您所期望的那种答案，但是由于在 2 天内您什么都没有得到，所以这是我的 0.02 美元。

忘记 IE，使用 Firefox + [theora](http://theora.org/)，一切都会自动运行。不过，您**可能**需要至少重写部分核心服务器端功能。有关详细信息，请参见[此处](http://www.bluishcoder.co.nz/2008/07/theora-video-backend-for-firefox-landed.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T18:20:41.477

您是在问哪些媒体播放器支持 SAMI？

如果你喜欢那种东西，你真的可以抓取文件的文本并用 javascript 解析它。顺便说一句，非常感谢您让隐藏式字幕与您正在做的任何媒体项目一起工作！

要求尝试 SMIL 会不会太过分了？

[http://en.wikipedia.org/wiki/SAMI#Media_Players_that_Support_SAMI](http://en.wikipedia.org/wiki/SAMI#Media_Players_that_Support_SAMI)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T20:19:04.047

这可能不是您想要走的路，但如果您想确保无论平台如何都显示字幕，您可以将它们直接合并到视频中并以与操作系统无关的形式（QuickTime 或 Flash）分发。通过将字幕嵌入视频流和平台中是无关紧要的。

# g++ - 使用 mingw32 g++ 链接错误

> ID：852512
> 
> 赞同：1
> 
> 时间：2009-05-12T12:30:17.337
> 
> 标签：g++, mingw

为什么我会得到：

```
undefined reference to `CryptAcquireContext(unsigned int**, char const*, char const*, unsigned long, unsigned long)@20' 
```

我正在使用 Mingw32 编译器套件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T13:52:35.783

这里肯定有一些代码。否则，我们唯一可以推测的是链接器无法找到合适的`CryptAcquireContext`函数定义（这可能是由于缺少对`Advapi32.lib`文件的引用）。

# javascript - 在 JQuery 中执行 JavaScript .replace

> ID：852529
> 
> 赞同：1
> 
> 时间：2009-05-12T12:33:35.267
> 
> 标签：javascript, jquery, string, replace

我将如何在 jQuery 中执行以下操作？

```
var elmOperator = document.getElementById(elm.id.replace('Include', 'Operator')); 
```

被操纵的`ID`看起来像`Criteria[0].Include`. 我正在尝试为相关的创建一个`ID`变量`Criteria[0].Operator`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T12:38:05.910

假设 elm 是一个 jQuery 对象，而不是 DOM 对象，你可以这样做：

```
var elmOperator = $("#" + elm.attr('id').replace('Include', 'Operator')); 
```

如果它是一个 DOM 对象，你可以这样做（这会快一点）：

```
var elmOperator = $("#" + elm.id.replace('Include', 'Operator')); 
```

更大的问题是你为什么要这样做。如果您不了解jQuery 选择器和[jQuery 选择器](http://docs.jquery.com/Selectors)等基本知识，那么`attr()`您的页面是否在任何地方都使用了 jQuery？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T12:39:43.613

您仍然可以在 jQuery 中使用旧的 javascript，因此对于您的示例，它将是这样的：

```
var operators = $('[id*=Include]').map(function() {
    return $('#' + $(this).get(0).id.replace('Include', 'Operator'));
});
operators.css('background', 'red'); 
```

在这个示例中，我们选择了所有 Include 元素，然后将元素 1:1 映射到新的运算符元素数组，最后我们将所有运算符背景设置为红色。

# wpf - 撤消日志：关注正在撤消的控制

> ID：852531
> 
> 赞同：4
> 
> 时间：2009-05-12T12:33:58.480
> 
> 标签：wpf, mvvm, focus, undo

我正在为我的 WPF 数据输入屏幕编写撤消日志，它将跟踪所有控件的更改。当用户选择撤消时，我不仅要恢复最新的更改，还要将焦点放回其值正在恢复的控件中。我正在努力寻找将注意力重新集中的最佳方式。

我的 ViewModel 将是处理撤销日志的部分：ViewModel 的属性设置器将在更新 DataModel 之前捕获一些“之前”状态。一种或另一种方式，“之前”状态需要包含足够的信息，以便我能够稍后将焦点放回原处。

举例来说，假设有两个数据输入字段：地址和城市。ViewModel 对每个都有一个属性，View 对每个绑定到相应 ViewModel 属性的 TextBox 都有一个。

让我们按照用户刚刚在地址字段中键入一个值，然后单击城市字段的示例进行操作。我正在使用默认的 UpdateSourceTrigger.LostFocus 行为，因此当地址文本框失去焦点时，地址更改会被保存。到目前为止，关于如何解决这个问题，我有三种不同的想法，但我对 WPF 的了解不够多，无法知道如何使它们中的任何一个起作用。

1.  我可以忘记 MVVM 样式的数据绑定，并挂钩编辑控件的 LostFocus 事件（或添加附加行为，或制作包装 TextBox 的自定义控件，或者......）。在 LostFocus 事件处理程序中，我可以创建一个撤消帧，其中包含对事件发送者的引用。后来，在撤消之后，我只关注我保存了其引用的控件。这可能是我在 WinForms 中所做的，但在 WPF 中我宁愿坚持使用 ViewModel 模式——我宁愿让日志逻辑存在于 ViewModel 中而不是 View 中，以确保可测试性。所以这个选项不是我的第一选择。

2.  在我的 ViewModel 的属性设置器中，我可以捕获正在设置的 ViewModel 属性的名称（本示例中的“地址”），并将该名称存储在撤消框架中。稍后，在撤消时，我可以遍历视图中的所有控件，寻找我能找到的第一个绑定到名为 Address 的属性的控件。一旦我找到一个这样的控制，我就会把重点放在它上面。这足以满足我的需要，因为我不希望将多个控件绑定到同一个 ViewModel 属性。问题是这需要深入研究绑定表达式，这是我不知道该怎么做的事情。（它还会引入更多基于名称的后期绑定，如果我重构，可能会中断。）

3.  当我的 ViewModel 将更改添加到撤消堆栈时，它可以要求 View 层（通过接口）创建一个知道哪个控件具有焦点的 Memento。在撤消时，日记会要求视图恢复该备忘录。这里的问题是，当我的 ViewModel 的属性被设置并添加撤消框架时，键盘焦点已经移动到 City TextBox，因此“创建纪念品”需要比“哪里”更棘手当前的键盘焦点”，我不知道如何完成这个技巧。

任何人对进行上述任何工作有任何建议，或者有可能更好的替代方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T15:21:52.733

我将从您的第二种方法开始。但是，我不会深入研究绑定列表，而是将控件的高亮属性硬编码为 VM 属性。

例如，这是我的虚拟机：

```
public class VM
{
    public double Price { get; set; }
    public bool PriceHighlighted { get; set; }
} 
```

然后，将 Price 属性绑定到 TextBox 并将 TextBox 的背景绑定到 PriceHighlighted（使用值转换器）。现在 VM 可以完全控制视图的反应方式。当用户执行“撤消”操作时，VM 可以将所有 xxxHightlighted 设置为 false，除了您要突出显示的那个。

# java - 使用 JSF、MyFaces 和 Facelets 迭代 HashMap 的麻烦

> ID：852534
> 
> 赞同：3
> 
> 时间：2009-05-12T12:34:11.333
> 
> 标签：java, jsf, facelets, myfaces

我在遍历 HashMap 以将其值打印到屏幕上时遇到了一些麻烦。有人可以仔细检查我的代码，看看我做错了什么。我似乎找不到任何问题，但一定有什么问题。

在 servlet 中，我将以下内容添加到请求中：

```
Map<String, String> facetValues = new HashMap<String, String>();
// Filling the map
req.setAttribute(facetField.getName(), facetValues); 
```

在一种情况下，“facetField.getName()”评估为“纪律”。所以在我的页面中，我有以下内容：

```
<ui:repeat value="${requestScope.discipline}" var="item">
  <li>Item: <c:out value="${item}"/>, Key: <c:out value="${item.key}"/>, Value: <c:out value="${item.item}"/></li>
</ui:repeat> 
```

循环运行一次，但所有输出都是空白的？！？如果它在循环中循环一次，我至少会预料到 item 中的某些东西。检查 Facelets 的调试弹出窗口，纪律在那里并且在循环中。将它打印到屏幕上会产生一些对我来说看起来像地图的东西（我已经缩短了输出）：

```
{300=0, 1600=0, 200=0, ... , 2200=0} 
```

我也尝试过 ac:forEach 但我得到了相同的结果。那么有人知道我哪里出错了吗？

感谢您的任何意见，李

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-07T14:40:59.567

使用 el 2.2 支持，您可以迭代如下地图。

```
<ui:repeat value="#{myBean.stats.keySet().toArray()}" var="x">
    <h:outputText value="#{myBean.stats.get(x)}" /><br />
</ui:repeat> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-08-18T18:22:21.720

`<ui:repeat>`只接受 List 或 DataModel，不接受 Sets 或 Maps。这是 JSF 2.1 的路线图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T13:50:58.550

我想到了三件事：

1.

[ui:repeat](https://facelets.dev.java.net/nonav/docs/dev/docbook.html#template)的文档没有说它（它只说*List*），但我看到 UIRepeat 使用[DataModel](http://java.sun.com/javaee/5/docs/api/javax/faces/model/package-summary.html)作为它的模型（以 h:dataTable 的方式）。*Map*不会自动包装为*DataModel*类型 - 该类型不受隐式支持。您需要将该值作为您自己的*DataModel*实现的实例，或者将它们作为隐式支持的类型提供（例如*java.util.List*）。

2.

我不确定您打算将这些值映射到什么：

```
${item}
${item.key}
${item.item} 
```

如果将“学科”更改为*List<Map.Entry<String,String>>*类型，则可以绑定到[键和值](http://java.sun.com/javase/6/docs/api/java/util/Map.Entry.html)属性：

```
${item.key}
${item.value} 
```

您可以像这样创建您的列表：

```
Map<String, String> facetValues = new HashMap<String, String>();
// Filling the map
List<Map.Entry<String, String>> discipline
        = new ArrayList<Map.Entry<String, String>>(facetValues.entrySet()); 
```

3.

[FAQ 建议](http://wiki.java.net/bin/view/Projects/FaceletsFAQ#Why_doesn_t_my_c_if_ui_repeat_ui)仅在组件树创建时评估 JSTL 标记。我不清楚使用 c:out 作为 ui:repeat 的子级是否可以正常工作。您可能需要改用 h:outputText 。（当然，我对此可能是错的 - 我没有尝试过。）

* * *

> 在 servlet 中，我将以下内容添加到请求中

这听起来像是一种在 JSF 中将某些东西放入请求范围的奇怪方式，但我相信您知道自己在做什么！

# c# - 计算给定长度的所有可能子序列（C#）

> ID：852536
> 
> 赞同：5
> 
> 时间：2009-05-12T12:35:35.310
> 
> 标签：c#, algorithm

如果我有如下序列（假设它是一个`IEnumerable<T>`）：

```
[A, B, C, D, E] 
```

那么计算给定长度的所有可能（连续和非连续）[子序列的最简洁方法是什么？](http://en.wikipedia.org/wiki/Subsequence)结果集中结果的顺序并不重要，但不应包含重复项。

例如，如果我想计算所有可能的长度为 3 的子序列，结果集将是：

```
[A, B, C]
[A, B, D]
[A, B, E]
[A, C, D]
[A, C, E]
[A, D, E]
[B, C, D]
[B, C, E]
[B, D, E]
[C, D, E] 
```

* * *

作为记录，下面接受的答案给了我一个很好的起点，这是我使用的代码，它已更新为使用一些新的 .NET 3.5 扩展方法：

```
public static IEnumerable<IEnumerable<T>> Subsequences<T>(
    this IEnumerable<T> source, 
    int count)
{
    if (count == 0)
    {
        yield return Enumerable.Empty<T>();
    }
    else
    {
        var skip = 1;
        foreach (var first in source)
        {
            foreach (var rest in source.Skip(skip).Subsequences(count - 1))
            {
                yield return Enumerable.Repeat(first, 1).Concat(rest);
            }

            skip++;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T12:37:09.343

我在 IanG 的[`PermuteUtils`](http://www.interact-sw.co.uk/iangblog/2004/09/16/permuterate)课程上取得了成功：

```
char[] items = new char[] { 'A', 'B', 'C', 'D', 'E' };

foreach (IEnumerable<char> permutation in PermuteUtils.Permute(items, 3)) {
    Console.Write("[");
    foreach (char c in permutation) {
        Console.Write(" " + c);
    }
    Console.WriteLine(" ]");
} 
```

结果是：

```
[ABC]
[ABD]
[安倍]
[ ACB ]
[ ACD ]
[王牌]
[亚行]
[ ADC ]
[阿德]
[自动包围曝光]
[ AEC ]
[ 自动除颤器 ]
[ BAC ]
[ 坏的 ]
[BAE]
[ BCA ]
[ BCD ]
[ 公元前 ]
[ BDA ]
[ BDC ]
...

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T13:22:59.573

就像是：

```
static void Main()
{
    string[] data = { "A", "B", "C", "D", "E" };
    WalkSubSequences(data, 3);
}

public static void WalkSubSequences<T>(IEnumerable<T> data, int sequenceLength)
{
    T[] selected = new T[sequenceLength];
    WalkSubSequences(data.ToArray(), selected, 0, sequenceLength);
}
private static void WalkSubSequences<T>(T[] data, T[] selected,
    int startIndex, int sequenceLength)
{
    for (int i = startIndex; i + sequenceLength <= data.Length; i++)
    {
        selected[selected.Length - sequenceLength] = data[i];
        if (sequenceLength == 1)
        {
            ShowResult(selected);
        }
        else
        {
            WalkSubSequences(data, selected, i + 1, sequenceLength - 1);
        }
    }
}

private static void ShowResult<T>(T[] selected)
{
    StringBuilder sb = new StringBuilder();
    sb.Append(selected[0]);
    for (int j = 1; j < selected.Length; j++)
    {
        sb.Append(';').Append(selected[j]);
    }
    Console.WriteLine(sb.ToString());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T13:32:45.683

我会为此建议一个递归算法。对不起，我已经有一段时间没有用 C# 做任何事情了，所以我在这里只给出伪代码。

```
function allPossible(iterator, length, currSubSeq, allResults) {
    // Add the current sub sequence to the results if it is the correct length.
    if (currSubSeq.length == length) {
        copy = currSubSeq.copy();
        allResults.add(copy);
    }
    // If it is too long, return early.
    else if (currSubSeq.length > length) {
        return allResults;
    }

    // Get the next item from the iterator and handle both cases:
    // I.E. when it is, and when it isn't in a sub sequence.
    item = iterator.getNext();
    allPossible(iterator, currSubSeq, allResults);
    currSubSeq.add(item);
    allPossible(iterator, currSubSeq, allResults);

    return allResults;
} 
```

`allPossible`然后，您通过调用an来找到所有可能的子序列，该序列`iterator`会产生原始序列中的所有元素、`length`您想要子序列的 、 的项目`currSubSeq`的空序列和 的项目序列的空序列`allResults`。我假设所有参数的传递引用语义。抱歉，我无法为您提供正确的 C# 实现，但我相信您知道的足够多，可以将我的算法草图转化为代码。

最后一件事。因为这个算法是递归的，如果你在一个非常长的序列上运行它并且参数很大，你可能会出现堆栈溢出，`length`因为堆栈使用量是 O(2^N) 其中 N = `length`。我不认为这是一个大问题，因为由于问题的性质，该算法具有 O(2^N) 运行时间，所以你不应该尝试以足够大的大小运行它`length`以溢出堆栈！

**警告**我还没有实际测试过这个伪代码，所以可能有一些我没有想到的微妙之处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T15:17:16.773

这是一个将状态存储在布尔数组中的解决方案。它通过在每次`Next()`调用时创建以下状态来工作（n = 5，k = 3）。

```
1 1 1 。. 将最后一个 1 向右移动一次。
1 1 . 1\. 将最后一个 1 向右移动一次。
1 1 . . 1 将最后一个 1 向右移动一次。
1\. 1 1 . 将倒数第二个 1 向右移动一次，然后将所有 1 从右后移。
1\. 1\. 1 将最后一个 1 向右移动一次。
1\. . 1 1 将倒数第二个 1 向右移动一次（以及从右后方开始的所有 1。）
. 1 1 1 。将倒数第三个 1 向右移动一次，然后将所有 1 从右后移。
. 1 1 . 1 将最后一个 1 向右移动一次。
. 1\. 1 1 将倒数第二个 1 向右移动一次（以及从右后方开始的所有 1。）
. . 1 1 1 将倒数第三个 1 向右移动一次（以及从右后方开始的所有 1。）

```

然后，此状态可用于从为每个状态提供的序列中选择相应的项目。

一开始是初始化。

```
public static Boolean[] Initialize(Int32 n, Int32 k)
{
    return Enumerable.Concat(Enumerable.Repeat(true, k),
                             Enumerable.Repeat(false, n - k)).ToArray();
} 
```

移动到下一个组合（子序列）的代码。

```
public static Boolean Next(this Boolean[] list)
{
    Int32 lastOneIndex = Array.LastIndexOf(list, true);

    if (lastOneIndex == -1)
    {
        return false; // All zeros. 0000000
    }
    else if (lastOneIndex < list.Length - 1)
    {
        // Move the last one right once. 1100X00 => 11000X0
        list.MoveBlock(lastOneIndex, lastOneIndex, lastOneIndex + 1);
    }
    else
    {
        Int32 lastZeroIndex = Array.LastIndexOf(list, false, lastOneIndex);

        if (lastZeroIndex == -1)
        {
            return false; // All ones. 1111111
        }
        else
        {
            Int32 blockEndIndex = Array.LastIndexOf(list, true, lastZeroIndex);

            if (blockEndIndex == -1)
            {
                // Move all ones back to the very left. 0000XXX => XXX0000
                list.MoveBlock(lastZeroIndex + 1, lastOneIndex, 0);

                return false; // Back at initial position.
            }
            else
            {
                // Move the block end right once. 11X0011 => 110X011
                list.MoveBlock(blockEndIndex, blockEndIndex, blockEndIndex + 1);
                // Move the block of ones from the very right back left. 11010XX => 1101XX0
                list.MoveBlock(lastZeroIndex + 1, lastOneIndex, blockEndIndex + 2);
            }
        }
    }

    return true;
} 
```

最后是一些辅助方法。

```
public static void MoveBlock(this Boolean[] list, Int32 oldStart, Int32 oldEnd, Int32 newStart)
{
    list.ClearBlock(oldStart, oldEnd);
    list.SetBlock(newStart, newStart + oldEnd - oldStart);
}

public static void SetBlock(this Boolean[] list, Int32 start, Int32 end)
{
    list.SetBlockToValue(start, end, true);
}

public static void ClearBlock(this Boolean[] list, Int32 start, Int32 end)
{
    list.SetBlockToValue(start, end, false);
}

public static void SetBlockToValue(this Boolean[] list, Int32 start, Int32 end, Boolean value)
{
    for (int i = start; i <= end; i++)
    {
        list[i] = value;
    }
} 
```

还有一个使用字符串而不是列表的用法示例。

```
var sequence = "ABCDE";

var state = Initialize(sequence.Count(), 5);

do
{
    Console.WriteLine(new String(sequence.Where((_, idx) => state[idx]).ToArray()));
}
while (state.Next()); 
```

# python - 支持反向代理的纯python网络服务器？

> ID：852541
> 
> 赞同：1
> 
> 时间：2009-05-12T12:37:00.373
> 
> 标签：python, proxy, webserver, reverse

我正在寻找一个纯 python 的 web 服务器也有反向代理的能力？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T12:56:03.880

很确定你可以用twisted来做到这一点，

[扭曲的网](http://twistedmatrix.com/trac/wiki/TwistedWeb)

但为什么不只使用 apache？

# asp.net - 从网格视图中提取未显示在网格视图上的数据库信息

> ID：852543
> 
> 赞同：0
> 
> 时间：2009-05-12T12:37:16.473
> 
> 标签：asp.net, sql-server, vb.net, gridview

我创建了一个 Gridview 控件，它从我的数据库中提取一些数据，但没有显示我希望它收集的所有信息。我选择不出于用户界面的目的显示主键，但需要该键用于网格上的基本操作。

我目前正在尝试在表格中添加“删除”选项，但不幸的是我运气不佳。这是我的 .aspx 文件。

```
 <asp:GridView ID="ManagerList_GV" runat="server"
                AutoGenerateColumns="False" AllowSorting="True"
                DataKeyNames = "ManagerID" OnRowEditing="editManager"
                OnRowDataBound="FormatManagers" CellPadding="3" >
                <Columns>
                    <asp:BoundField HeaderText="Manager" DataField="FullName" />
                    <asp:BoundField HeaderText="Status" DataField="Status" />
                    <asp:CommandField EditText="Edit" ShowEditButton="True" />
                    <asp:TemplateField>
                        <ItemTemplate>
                            <asp:LinkButton Text="Delete" runat="server" CommandName="deleteRow" />
                        </ItemTemplate>
                    </asp:TemplateField>            
                </Columns>
            </asp:GridView> 
```

不幸的是，我不确定我的后端该怎么做。我已经创建了我的存储过程和业务层子例程，但我不确定如何 a) 拉入刚刚单击的行，然后 b) 访问与该行相关的主键，因为我没有显示它（主键是ManagerID）。

在此先感谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T13:01:45.257

我会创建一个按钮字段，但我认为模板字段也应该可以工作：

```
<asp:ButtonField ButtonType="Link" Text="Delete" CommandName="Delete" /> 
```

然后你要处理 Gridview 的 RowDeleting 事件：

```
Private Sub GridView1_RowDeleting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewDeleteEventArgs) Handles Gridview1.RowDeleting
    Dim ManagerIdToDelete As Int32 = CType(CType(sender, GridView).DataKeys(e.RowIndex).Value, Int32)
    'Now call your delete command with the id
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T12:59:32.577

添加一个 BoundColumn，将主键显示为在设计视图中可见，但在数据绑定之后，将 PK 设置为可见 false 的列。

例如

```
<Columns>                    
        <asp:BoundField HeaderText="PrimaryKey" DataField="ManagerID" /> 
        <asp:BoundField HeaderText="Manager" DataField="FullName" />                                      
    ....                                       
</Columns> 
```

服务器端：

```
ManagerList_GV.DataSource = ??;
ManagerList_GV.DataBind();
ManagerList_GV.Columns[0].Visible = false; 
```

这是故意的，因此出于安全原因，PK 不会存储在 ViewState 中。然后，您可以添加一个 RowDeleting 事件并使用访问主键

```
ManagerList_GV.Rows[e.RowIndex].Cells[0].Text; 
```

# ant - 在同一个虚拟机上运行多个 ant 任务

> ID：852548
> 
> 赞同：0
> 
> 时间：2009-05-12T12:37:56.440
> 
> 标签：ant, junit

我正在使用 ant 运行单元测试

```
<target name="test" depends="tomcatDeploy" description="Build and run tests">
    <ant dir="${aDir}" target="test"/>
    <ant dir="${bDir}" target="test"/>
    <ant dir="${cDir}" target="test"/>
    <ant dir="${dDir}/ExtFramework"  target="test"/>
</target> 
```

我想在同一个虚拟机上运行它们 - 否则我在创建 jvm 和重新创建静态等方面会*产生很多开销。*

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T20:01:16.953

我认为[subant](http://ant.apache.org/manual/Tasks/subant.html)任务是您正在寻找的。假设您的所有子目录都有一个共同的父目录，您可以执行以下操作：

```
<target name="test" depends="tomcatDeploy" description="Build and run tests">
    <subant target="test">
        <fileset dir="${parent}" includes="**/build.xml"/>
    </subant>
</target> 
```

**编辑** 你是如何运行测试的？如果您正在使用该`junit`任务，您有`fork="yes"`吗？如果是这样，那将在新 VM 中运行测试。将其更改为`fork="no"`在同一 VM 中运行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T15:12:36.763

该任务本身不会创建新的 VM。您的测试是否创建了新的虚拟机？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T02:17:01.470

```
<parallel threadCount='4'>
  <ant target='TargetThatConsumesLotsOfCPUTimeAndMemory'>
    <param name='file' value='one.txt'/>
  </ant>
  <ant target='TargetThatConsumesLotsOfCPUTimeAndMemory'>
    <param name='file' value='two.txt'/>

  </ant>
  <ant target='TargetThatConsumesLotsOfCPUTimeAndMemory'>
    <param name='file' value='three.txt'/>
  </ant>
  <!-- repeated about 40 times -->
</parallel> 
```

[http://www.java-tips.org/other-api-tips/ant/how-to-use-parallel-task.html](http://www.java-tips.org/other-api-tips/ant/how-to-use-parallel-task.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T05:38:09.563

尽量减少问题：如果您通过 JUnit 手动启动它，您的测试是否会创建一个新的 VM？还是问题仅与蚂蚁一起出现？
可能是 JUnit 或您的测试创建了一个新的 VM 并泄漏了内存。

# .net - 必要时从 USB 驱动器安装 .NET 框架

> ID：852550
> 
> 赞同：0
> 
> 时间：2009-05-12T12:38:06.533
> 
> 标签：.net, stub, portable-executable

我们有一个将通过 USB 驱动器分发的 .NET 应用程序。最终用户将连接驱动器并双击 EXE（一个 .NET exe）运行它而不安装它。

现在的问题是，如果未安装 .NET，我们希望触发 .NET 安装程序，而不是显示 MS 放在那里的默认下载消息。安装程序将通过 USB 与应用程序一起分发。

一种方法可能是替换 .NET 可执行文件中的 PE 存根文件。但是我没有在 C# 编译器中看到和 /STUB 开关（尽管 C 编译器有它）。

还有什么人能想到的吗？

更新：感谢 Tim Robinson，我了解到 Windows 不处理 PE 存根文件。因此，ClickOnce 解决方案似乎是唯一可行的解​​决方案。我将检查 ClickOnce。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T12:40:08.667

为什么不使用 ClickOnce，它会为您完成所有这些。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T12:53:19.940

你可能想看看这集 Hanselminutes

[http://www.hanselman.com/blog/HanselminutesPodcast138PaintNETWithRickBrewster.aspx](http://www.hanselman.com/blog/HanselminutesPodcast138PaintNETWithRickBrewster.aspx)

他与 Paint.NET 的创建者交谈，后者最终用安装程序做了一些非常有创意的事情。

# git - 使用复制的 git repo 是否安全？

> ID：852561
> 
> 赞同：32
> 
> 时间：2009-05-12T12:42:14.183
> 
> 标签：git

如果我使用`rsync -a`or制作跟踪文件夹`cp -R`的副本，那么我可以像使用 git clone 一样使用该副本，还是会导致各种奇怪的问题？这一切都在我的计算机上运行，​​因此没有其他人访问存储库。

显然，git-cloned 目录知道它是从哪里复制的，所以我可以`git pull`不指定源，但假设我愿意没有它，我需要担心什么吗？

作为一个实验，我创建了一个小项目，`clone`对它进行了编辑和`rsync`编辑，并`diff`编辑了生成的文件夹。结果如下：

```
itsadok@quad ~
$ git clone project/.git project2
Initialized empty Git repository in /home/itsadok/project2/.git/

itsadok@quad ~
$ rsync -a project/ project3/

itsadok@quad ~
$ diff -r project2 project3
Only in project3/.git: COMMIT_EDITMSG
diff -r project2/.git/config project3/.git/config
7,12d6
< [remote "origin"]
<       url = /home/itsadok/project/.git
<       fetch = +refs/heads/*:refs/remotes/origin/*
< [branch "master"]
<       remote = origin
<       merge = refs/heads/master
Files project2/.git/index and project3/.git/index differ
diff -r project2/.git/logs/HEAD project3/.git/logs/HEAD
1c1
< 0000000000000000000000000000000000000000 bf6be23d68d0ede45aca7479795693bfba76e73a itsadok <itsadok@quad.(none)> 1242131284 +0300      clone: from /home/itsadok/project/.git
---
> 0000000000000000000000000000000000000000 bf6be23d68d0ede45aca7479795693bfba76e73a itsadok <itsadok@quad.(none)> 1242131066 +0300      commit (initial): first commit
diff -r project2/.git/logs/refs/heads/master project3/.git/logs/refs/heads/master
1c1
< 0000000000000000000000000000000000000000 bf6be23d68d0ede45aca7479795693bfba76e73a itsadok <itsadok@quad.(none)> 1242131284 +0300      clone: from /home/itsadok/project/.git
---
> 0000000000000000000000000000000000000000 bf6be23d68d0ede45aca7479795693bfba76e73a itsadok <itsadok@quad.(none)> 1242131066 +0300      commit (initial): first commit
Only in project2/.git/logs/refs: remotes
Only in project2/.git: packed-refs
Only in project2/.git/refs: remotes 
```

有很大的不同，但大部分似乎与对起源的引用有关。我对吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-12T14:03:41.253

这是安全的。

使用“git clone”的不同之处在于它会自动设置源仓库，这样您就可以轻松地使用“git pull”和“git push”来同步两个仓库。此外，“git clone”不会复制存储库本地的日志、索引和其他配置。它只复制存储库的版本历史记录（甚至可以以不同的方式存储在字节级别，因为 Git 在使用“git gc”时会不时压缩其数据库）。

您在示例中看到的那些差异是因为 rsnc 还复制了工作目录索引、日志，并且因为 rsync-copy 没有设置远程源。存储库本地有很多配置和日志文件。但是直接复制它们没有危险，例如在恢复备份或将存储库移动到另一个目录/硬盘驱动器/机器时。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T13:43:38.983

> 当您克隆其他人的存储库时，它基本上只是将此目录的内容复制到您的计算机。

[来自 Peepcode Press](http://peepcode.com/products/git-internals-pdf)的真正优秀的Git Internals (Scott Chacon) 。（第 44 页）因此，就我而言/我看到，只是缺少对原点的引用。

最诚挚的问候。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T10:30:07.060

完全一样，好吧，几乎，如果你想在“project3”中做同样的事情：

```
git remote add origin /home/itsadok/project
git branch -f master origin/master 
```

# ms-access - 访问 VBA 错误 2486 DoCmd.Save

> ID：852564
> 
> 赞同：2
> 
> 时间：2009-05-12T12:42:23.637
> 
> 标签：ms-access, vba

我们正在使用 VBA 中的以下行将一些代码模块导入 Access 2002 应用程序

`Application.VBE.ActiveVBProject.VBComponents.Import (strFileName)`

这部分工作正常，紧随其后的行是尝试将新类保存到项目中。我们可以看到的唯一方法是使用 DoCmd：

```
DoCmd.Save acModule, strModuleName 
```

有时，这会导致

> 错误 2486：您目前无法执行此操作。

较长版本的错误给出以下内容：

您目前无法执行此操作。您试图运行宏或使用 Visual Basic 中的 DoCmd 对象来执行操作。但是，Microsoft Access 正在执行另一个阻止此操作现在执行的活动。

这`Access is performing another activity`似乎是有道理的，因为我们有时只会得到错误。有没有办法知道忙着做什么并等待它完成？或者有没有更好的方法来实现模块的导入？

我想过写一些东西，直到 module.Saved 属性为真，但是如果没有这个代码，这段代码就够讨厌了......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T20:14:18.503

自 Access 2000 以来，VBA 项目作为单个 BLOB 字段存储在其中一个系统表的单个记录中。这意味着您正在执行来自您尝试保存的同一个项目的代码，我不确定这是可能的。这在概念上听起来很有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T16:00:05.533

尝试在保存之前调用 DoEvents。这可能有助于 Access 完成它正在做的任何事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T20:41:36.343

您可以尝试改用未记录的命令 Application.SaveAsText 和 Application.LoadFromText。

# c++ - 右键单击不可见 DLL 中的版本资源

> ID：852568
> 
> 赞同：14
> 
> 时间：2009-05-12T12:42:59.780
> 
> 标签：c++, visual-studio-2008, dll, resources, visual-c++-2008-express

我正在尝试做一些在常规 MSVC 中很容易做到的事情，但在 VC++ Express 中不容易支持。

VC++ Express 中没有资源编辑器。所以我在我的 DLL 项目中添加了一个名为 version.rc 的文件。该文件有以下内容，由资源编译器编译并添加到最终的DLL中。此资源可使用 reshacker 在 DLL 中查看，但在 Windows 资源管理器中右键单击 DLL 时无法查看。

我的 RC 文件中缺少什么以使其在右键单击时出现？

```
VS_VERSION_INFO VERSIONINFO
 FILEVERSION 1,0,0,1
 PRODUCTVERSION 1,0,0,1
 FILEFLAGSMASK 0x17L
#ifdef _DEBUG
 FILEFLAGS 0x1L
#else
 FILEFLAGS 0x0L
#endif
 FILEOS 0x4L
 FILETYPE 0x1L
 FILESUBTYPE 0x0L
BEGIN
    BLOCK "StringFileInfo"
    BEGIN
        BLOCK "040904b0"
        BEGIN
            VALUE "FileDescription", "something Application"
            VALUE "FileVersion", "1, 0, 0, 1"
            VALUE "InternalName", "something"
            VALUE "LegalCopyright", "Copyright (C) 2008 Somebody"
            VALUE "OriginalFilename", "something.exe"
            VALUE "ProductName", "something Application"
            VALUE "ProductVersion", "1, 0, 0, 1"
        END
    END
    BLOCK "VarFileInfo"
    BEGIN
        VALUE "Translation", 0x409, 1200
    END
END 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-17T08:30:06.250

我能够看到（使用 reshacker）我的资源和右键单击时出现的资源之间的一个区别，那就是资源的名称。所以我将 VS_VERSION_INFO 更改为 1；现在资源在右键单击时可见。

```
1 VERSIONINFO
 FILEVERSION 1,0,0,1
 PRODUCTVERSION 1,0,0,1
 FILEFLAGSMASK 0x17L
#ifdef _DEBUG
 FILEFLAGS 0x1L
#else
 FILEFLAGS 0x0L
#endif
 FILEOS 0x4L
 FILETYPE 0x1L
 FILESUBTYPE 0x0L
BEGIN
    BLOCK "StringFileInfo"
    BEGIN
        BLOCK "040904b0"
        BEGIN
            VALUE "FileDescription", "something Application"
            VALUE "FileVersion", "1, 0, 0, 1"
            VALUE "InternalName", "something"
            VALUE "LegalCopyright", "Copyright (C) 2008 Somebody"
            VALUE "OriginalFilename", "something.exe"
            VALUE "ProductName", "something Application"
            VALUE "ProductVersion", "1, 0, 0, 1"
        END
    END
    BLOCK "VarFileInfo"
    BEGIN
        VALUE "Translation", 0x409, 1200
    END
END 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-03-27T20:35:24.610

正确的解决方案是添加到 .rc 文件的顶部：

```
#include <windows.h> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T13:54:02.833

尝试将您的资源更改为：

```
 FILEFLAGSMASK 0x3fL 
```

和

```
 BLOCK "040004e4" 
```

和

```
VALUE "Translation", 0x400, 1252 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-15T04:44:39.247

我将扩展@Stefan 的答案，根据：[StringFileInfo BLOCK 语句](https://docs.microsoft.com/en-us/windows/win32/menurc/stringfileinfo-block)

> 定义一个字符串信息块。句法
> 
> 块“字符串文件信息”{块“语言字符集”{VALUE“字符串名称”，“值”。. . }}
> 
> **参数**
> 
> *语言字符集*
> 
> **语言和字符集标识符对。它是一个十六进制字符串，由“备注”部分中指定的语言和字符集标识符的串联组成。**

我的情况是我用错了`lang-charset`，这就是版本详细信息没有显示版本信息的原因，这是正确的：

```
BLOCK "040904E4"
....
BLOCK "VarFileInfo"
  BEGIN
    VALUE "Translation", 0x409, 1252
  END 
```

[这里](https://docs.microsoft.com/en-us/windows/win32/menurc/stringfileinfo-block#remarks)是语言代码和字符集的列表

# visual-studio-2008 - 将 Visual Studio 配置为以英文显示错误消息

> ID：852569
> 
> 赞同：77
> 
> 时间：2009-05-12T12:43:02.417
> 
> 标签：visual-studio-2008, localization

我目前在另一个国家工作，我的电脑安装了非英语版本的 Windows。我不关心这一点，但是当 Visual Studio 显示错误消息时我非常关心，因为它们也被本地化为与 Windows 相同的语言。

有时我会花很多时间试图找出它的含义，这很无聊......

有没有办法配置 Windows 或 Visual Studio 以显示英文消息？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-29T08:28:34.943

卸载 .NET Framework xxx 语言包。（xxx = 无聊的消息语言）

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-03-31T12:44:28.617

最好的方法是在您的应用程序入口方法中使用此代码

```
if (Debugger.IsAttached)
    CultureInfo.DefaultThreadCurrentUICulture = CultureInfo.GetCultureInfo("en-US"); 
```

它不仅会在应用程序中捕获和显示的异常中强制显示英文消息，而且还会在 IDE 中强制显示英文消息

因为在本地执行一些初始测试时，您不能强制您的用户使用英语版本的 Windows，您可能会发现[这](http://finderr.net/)很有用。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-12T12:50:02.880

在工具/选项/国际设置下。我可以选择将语言从“与 Microsoft Windows 相同”更改为“英语”（Visual Studio 2008，以防有任何不同）。如果您那里没有英语，那么我不确定您如何添加更多语言...

* * *

编辑添加：

由于您正在谈论应用程序异常，因此您需要更改正在调试的应用程序的文化，您可以按照[此](http://msdn.microsoft.com/en-us/library/b28bx3bh(VS.80).aspx)操作，或者如果不能选择更改整个应用程序的文化，[这个问题](https://stackoverflow.com/questions/209133/c-exception-messages-in-english)只有一些想法抛出异常时改变文化。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-07-17T14:08:38.700

正如我在另一个线程中发布的那样，就我而言，只需一行代码即可更改文化：

```
System.Globalization.CultureInfo.DefaultThreadCurrentUICulture=System.Globalization.CultureInfo.GetCultureInfo("en-US"); 
```

它也改变了主线程和新线程的默认文化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-09-05T08:45:22.060

在我的情况下，在 Windows 10 中，它就像转到 Windows 中的语言设置并更改 Windows 显示语言一样简单。

我本可以尝试按照上述代码中的描述更改 DefaultThreadCurrentUICulture，但我觉得这对于多语言应用程序是错误的，并且异常消息应该保留为英文，以便有人可以用谷歌搜索它们并获得帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-07T13:33:27.770

我没有安装任何 .NET Framework 语言包。我认为问题在于 IIS 不是英文的，因为整个系统不是英文的。

我安装了 Windows 英语语言包并将操作系统语言更改为英语。现在一切都很好。

如果您使用的是 Windows 7 专业版，[这可能会对您有所帮助](http://blog.y-m-e.net/2011/05/language-pack-installation-auf-windows-7-professional-mit-sp1/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-23T00:01:52.050

正如上面的 Martin Harris 所建议的那样，一开始 Options 窗口对我来说没有英语，所以我不得不通过 Visual Studio Installer [2](https://i.stack.imgur.com/M1Jsi.png)安装它。之后，您应该能够看到启用了英语选项的选项窗口[1](https://i.stack.imgur.com/iHZlm.png)，您终于可以选择它了。

此致。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-23T11:55:40.013

我在 Visual Studio / Windows 中没有安装除英语以外的任何语言包。我在 IIS Manager > .NET Globalization > (UI) Culture 中的应用程序仍然显示了除英语之外的另一种语言。在 cmd 窗口中运行`lpksetup`，我能够卸载语言包（在我的例子中是荷兰语）。

来源：[https ://blogs.msdn.microsoft.com/benjaminperkins/2013/03/01/creating-custom-language-specific-error-pages-in-iis/](https://blogs.msdn.microsoft.com/benjaminperkins/2013/03/01/creating-custom-language-specific-error-pages-in-iis/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-15T15:58:42.113

对于 Visual Studio 新一代：

1.  去`Visual Studio Installer`
2.  选择`Modify`
3.  语言包（可以是其他文本，但你会明白的）
4.  选择`English`或您要添加的首选语言
5.  安装语言。

`Open / Restart Visual Studio`

然后：

1.  去`Visual Studio Installer`
2.  前往`Tools`/`Options`
3.  `"International Settings"`用您的语言搜索：

[![在此处输入图像描述](https://i.stack.imgur.com/T0CRN.png)](https://i.stack.imgur.com/T0CRN.png)

`Select`你想要的语言和`Restart`Visual Studio。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2018-02-13T16:22:07.147

1\. 卸载 .net 框架 2\. 转到首选项语言 => 区域和语言 => 将语言更改为您想要的语言（Windows 10）

*   这种方法对我有用

# linux - 使用 parted 将带有 parted 的设备格式化为特定模式

> ID：852570
> 
> 赞同：0
> 
> 时间：2009-05-12T12:43:04.460
> 
> 标签：linux, partitioning, boot

这确实是一个分开的使用问题，但欢迎提出其他关于如何实现这一点的想法。

我需要创建一个引导设备，设置如下：

> （最多 4MB 擦除块大小 (EBS)）：
> 
> 通过使用 32 个扇区/磁道和 128 个磁头并使用奇数起始编号（从 1 开始计数）在 4MB 块上对齐分区
> 
> MBR：syslinux MBR 引导加载程序
> 
> 分区 1: FAT16 (0x06), 32MB, 标准布局, syslinux setup + kernel
> 
> 分区 4：分区 1 的副本（是的，在 part2 的前面！）
> 
> 分区 2：LVM，磁盘的剩余部分

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T20:30:10.100

我会使用 sfdisk。例如，对于多个操作系统：

```
#Warning: sfdisk starts at zero, fdisk at one
sfdisk --force -i -D -uC /dev/hda << EOF
0 383 07 -;
383 383 83 -;
766 1 0c -;
767 1665 E -;
768 2 a -;
771 120 6 -;
892 120 a5 -;
1013 120 83 -;
1134 120 eb -;
1256 120 82 -;
1377 240 0c -;
1618 796 83 -;
2415 17 82 -;
EOF

#    0    Windows 2000
#  383    Debian
#  766    Free (Fat32)
#  767    Extended
#  768    0a os2 boot
#  771    84 os2
#  892    a5 bsd
# 1013    83 hurd (ext2)
# 1134    eb BeOS
# 1256    82 solaris
# 1377    0c windows98
# 1618    83 HOME
# 2415    82 linux swap 
```

# javascript - 客户端本地化

> ID：852571
> 
> 赞同：0
> 
> 时间：2009-05-12T12:43:16.503
> 
> 标签：javascript, jquery, asp.net-mvc, localization

我有一个同事认为这个

```
alert('<asp:Localize ID="ErrorAddingComponent" runat="server" Text="There was an error adding component: "  meta:resourcekey="ErrorAddingComponent"/>' + errortext); 
```

如果我们从 AJAX 调用中得到错误是一个好主意，errortext 是从 jquery ajax 出错时调用的函数的参数，

对我来说，使用服务器端本地化控件的想法似乎很可怕，我们使用的是 asp.net MVC，所以对我来说，即使使用 GetLocalResourceObject 也比这个更可取，

谁能给我任何理由，我可以向他提出这个问题？（或者如果你相信他的解决方案没问题，为什么？）。

顺便说一句，警报也让我烦恼，我相信我们应该将错误解析为 div 以进行演示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T14:22:16.490

警报 = -1

一个 div 很好，而且不烦人，另外，您可以提供多个解决方案、链接、重试、忽略或重新开始。

如果您使用警报，它看起来很难看，并且您只向用户提供有限的选项。

# sql - 返回的列数会影响查询的速度吗？

> ID：852572
> 
> 赞同：8
> 
> 时间：2009-05-12T12:43:37.533
> 
> 标签：sql, performance

如果我有两个查询

```
SELECT Id, Forename, Surname
FROM Person
WHERE PersonName Like(‘%frank%’) 
```

和

```
SELECT *
FROM Person
WHERE PersonName Like(‘%frank%’) 
```

哪个查询会运行得更快？是where子句/表加入最大的因素，还是返回的列数？

我问是因为我正在构建一系列映射到数据库表的对象。通常每个对象都至少有以下三种方法：

`Select`- 选择一切

`List`- 选择足够多的可用于填充下拉列表

`Search`– 选择结果中可见的所有内容，通常大约 6 列左右。

如果每个查询都返回完全相同的列集，则代码的维护和测试应该更简单。数据库不太可能在任何给定表中超过 50,000 行，因此如果性能差异很小，那么我将节省开发时间。如果性能会下降，那么我将从不同的角度工作。

那么，为了便于开发，是`SELECT *`明智，还是幼稚？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-12T12:46:56.790

你最好避免`SELECT *`

*   更改表格布局时会导致混乱。
*   它选择不需要的列，并且您的数据包变得更大。
*   列可以得到重复的名称，这对某些应用程序也不利
*   如果你需要的所有列都被一个索引覆盖，`SELECT columns`将只使用这个索引，而`SELECT *`需要访问表记录来获取你不需要的值。对性能也不利。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-12T12:52:08.867

`SELECT *`通常从来都不是一个好主意。它可能不会大大降低您的 DBMS 获取速度，但它可能会导致通过网络传输的数据超出您的需要。

`LIKE '%frank%'`但是，由于使用基本上不可索引的子句，这可能会变得微不足道，并且会导致全表扫描。

您可能需要考虑在数据进入数据库时​​对其进行清理，因为这几乎肯定会使后续查询运行得更快。

如果您追求 frank，请确保将其存储为 frank 并使用：

```
select x,y,z from table where name = 'frank' 
```

如果您也想获得富兰克林，请使用：

```
select x,y,z from table where name like 'frank%' 
```

这两个都可以在 name 列上使用索引，但`"%frank%"`不会。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-12T13:07:20.390

我要在这里逆流而上，说你应该选择 *. 我认为过早的优化是很多问题的根源，当你真正使用它时，你很可能会发现它不会影响你的性能。当然，从书上看，它一定是慢了，但这并不意味着差异在实践中很重要。

不过需要注意的是，一些 SQL 引擎（肯定是 MS-SQL）会缓存 select *，所以如果您使用的是准备好的语句，或者拥有它的视图或存储过程，并更改表架构，除非重新编译视图或 sp，否则它不会接受更改，因此如果您没有动态运行这些查询，这是避免这样做的一个很好的理由。

当然，这因数据库引擎而异，因此需要进行一些负载测试以确保命中不会明显很大。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T12:58:09.257

无论性能问题如何，始终枚举查询中的所有字段都是一种很好的做法。

*   如果您决定将来添加用于特定查询的 TEXT 或 BLOB 列怎么办？无论您是否需要，您的 SELECT * 都会返回附加数据。
*   如果重命名列怎么办？您的 SELECT * 将始终有效，但依赖代码将被破坏。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T13:01:59.797

对于小型项目，您通常可以使用`select *`. 不过，不这样做是“正确的”。在非索引查询中，您不会注意到一个表的任何明显速度差异......您唯一明显做的就是为您不阅读的列使用更多带宽。

也就是说，您会注意到仅索引查询的差异，当您只需要访问索引时，您访问的是整个表。当您进行连接时，这尤其会出现。

`Select *`但是确实有用途，如果您正确使用它（例如，结合缓存，确保它是`select table.*`，并按列名寻址结果），您可以减少应用程序进行的查询。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T12:52:00.147

如果从大学时没记错的话（而且已经有一段时间了），选择 * 不是首选，但也不是那么糟糕——直到你开始加入。当你进入创建连接元组的关系代数时，每一列都会增加时间，所以如果可能的话，我肯定会避免它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T12:55:21.247

表中的列数不会影响查询的性能。查询中操作的列数将。

请注意 Oracle 概念手册中的以下示例：

> 行格式和大小 Oracle 将包含少于 256 列的数据的数据库表的每一行存储为一个或多个行片段。如果可以将整行插入到单个数据块中，则 Oracle 将该行存储为一行。但是，如果无法将行的所有数据插入到单个数据块中，或者如果对现有行的更新导致该行超出其数据块的大小，那么 Oracle 会使用多个行片段来存储该行。一个数据块通常每行只包含一个行块。当 Oracle 必须将一行存储在多个行块中时，它会被链接到多个块中。
> 
> 当一个表的列超过 255 列时，在第 255 列之后有数据的行可能会链接在同一个块中。这称为块内链接。链接行的片段使用片段的 rowid 链接在一起。通过块内链接，用户在同一个块中接收所有数据。如果行适合块，用户不会看到 I/O 性能的影响，因为不需要额外的 I/O 操作来检索行的其余部分。
> 
> 但是：如果有 400 列，我敢打赌，大多数行都不能放在一个块中，因此您会看到比通常需要的更多的“db 文件顺序读取”。同样，我记得史蒂夫亚当斯（或很久以前的某个人）提到访问“列表下方”的列需要额外费用 - 抱歉没有那个链接。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T12:48:27.193

如果人员只有 Id、Forename 和 Surname，则查询应该是等效的。但是，查询时间将与返回的列数（实际数据量）成比例增长。

此外，如果查询只需要这三列，您应该只要求这三列。如果您 SELECT * 并稍后更改架构，那么您基本上只是为所有查询添加额外的处理，而没有真正的额外好处。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-12T12:48:32.323

我会访问这个[问题](https://stackoverflow.com/questions/321299/what-is-the-reason-not-to-use-select)，了解为什么不首选使用“Select *”构造。

根据我的经验，在 3 列表中选择 3 列与选择 * 可能不会对性能产生明显影响，但随着表变得越来越宽，您会注意到性能差异。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-12T12:48:46.253

通常，在任何情况下，您都希望远离使用

```
SELECT * FROM TABLE 
```

在你的代码中。这样做会导致几个问题，其中只有一个是性能问题。我能想到的另外两个是资源利用率（如果您选择不需要的列，或者稍后有人添加列......您正在带回数据并浪费内存）和代码可读性（如果有人在您的代码中看到 SELECT * FROM ......他们不一定会知道您的应用程序中实际使用了哪些列）。

只需考虑几件事……但最佳做法是不要使用它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-12T12:49:49.887

是的，它确实。基本上：

*   必须从您的数据库服务器传输更多数据
*   数据库服务器必须获取更多数据

你不应该使用 select *

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-12T12:51:48.227

除了其他答案之外，请考虑 SELECT * 将返回查询中所有表的数据。开始通过 JOIN 添加其他表，你会开始看到你不想看到的东西。

我相信我也看到过 SELECT * 要求实际从连接表中获取数据的情况，而不是仅使用该表上的索引来帮助缩小整体结果集的范围。不过，我想不出这样的例子。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-12T12:53:40.080

这有多个维度。一旦 * 将使您的代码更加脆弱。在以后的版本中，您更改依赖于列顺序的表格布局代码可能会中断 - 或者如果数据类型仍然匹配，可能不会读取或修改错误的列，这可能是一个非常讨厌的问题！

此外，如果您总是请求所有列，您将需要在数据库客户端和数据库服务器上为不需要的列提供更多内存。如果表包含长字符字段、非常多的字段和/或 BLOB，这可能会非常昂贵。选择不必要的列也会破坏服务器的缓存，因为它充斥着客户端从未查看过的多余内容。

所以一般来说你不应该使用它。大多数对象关系映射工具无论如何都会生成包含所有列名的 SQL，因此在开发过程中这可能无论如何都不是问题。我个人只倾向于将 * 用于必须手动输入的快速临时查询。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-12T13:00:30.733

这是正确的方法，也是最优化的。原因是您只收集所需的数据，因此在获得结果之前它会占用正确的空间（您需要什么）来存储数据。

```
SELECT Id, Forename, Surname
FROM Person
WHERE PersonName Like(‘%frank%’) 
```

这是不正确的，因为它占用了未使用的字段，这会占用更多空间来运行查询，从而减慢结果。即使您很幸运并使用了查询中的所有字段，最好单独列出它们。这将阐明查询以及将哪些数据返回给将来可能需要修改查询的任何其他开发人员。

```
SELECT *
FROM Person
WHERE PersonName Like(‘%frank%’) 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-12T13:16:12.897

我唯一一次使用“ `select *`”并不是真正的事件“ `select *`”

具体来说：

`select count(*) from table`

不一样

`select count(ID) from table`

第一个返回表中的行数，
但第二个返回具有 NOT NULL ID 值的行数。

一个微妙的区别，但值得记住。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-12T13:29:11.667

SELECT * 会更慢，因为它必须传输更多数据。也因为已经提到的其他一些原因。由于您开始添加更多列，因此在连接表时确实会成为一个问题，而实际上您想要做的就是连接以便进行过滤。

如果您真的想使用 * ，请指定您想要所有列的表，例如 SELECT Person.* FROM Person...

这将缩小返回的数据量并使其更具可读性。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-12T23:41:36.730

让我扮演魔鬼的拥护者并提出一个选择 * 是更好选择的场景。假设您正在创建一个用户界面，您可以在其中获取数据集的结果并以某种形式的表格或网格显示它。您可以在 UI 中构建列以匹配数据集中的列并执行 SELECT * FROM MyView。

通过在数据库中使用视图，您可以完全控制查询返回的列，并且 UI 可以动态地显示所有列。对视图的更改将立即反映在 UI 中，而无需重新编译和重新编译显然我建议遵循之前的建议并指定视图定义中的所有列。

Just thought I would add that as sometimes people get dogmatic about following certain rules and forget that context matters.

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2009-05-12T12:47:57.270

当然。更好地命名您要检索的列。

# sql - 我如何评价这张桌子？

> ID：852577
> 
> 赞同：0
> 
> 时间：2009-05-12T12:44:45.220
> 
> 标签：sql, sql-server, sql-server-2005

我需要第二张桌子。

```
CREATE TABLE #Temp (VisitingCount int, [Time] int, [Date] nvarchar(50) )
DECLARE @DateNow DATETIME,@i int,@Time int, @Date nvarchar(50)
set @DateNow='00:00'  
set @i=1;  
while(@i<48)  
    begin  
        set @DateNow = DATEADD(minute, 30, @DateNow)
        set @Time = (datepart(hour,@DateNow)*60+datepart(minute,@DateNow))/30 
        set @Date = CONVERT(VARCHAR(5),@DateNow, 108)
        insert into #Temp(VisitingCount,[Time],[Date]) values(0,@Time,@Date )
        set @i=@i+1
    end

select * from #Temp
---------------------------------------------------------------------------

select Sum(VisitingCount) as VisitingCount, Date
from (
  select Sum(VisitingCount) as VisitingCount, [Time],Date
    from #Temp group by [Time],Date
  Union All
    select count(page) as VisitingCount, 
    (datepart(hour,Date)*60+datepart(minute,Date))/30 as [Time], CONVERT(VARCHAR(5),Date, 108) as Date
    from scr_SecuristLog
    where Date between '2009-05-12' and '2009-05-13'
    GROUP BY (datepart(hour,Date)*60+datepart(minute,Date))/30,CONVERT(VARCHAR(5),Date, 108)
  ) X
group by Date
order by 2 asc 
```

`VCount Date
0 10:00
0 10:30
0 11:00
0 11:30
1 11:36
1 11:53
0 12:00
1 12:04
1 12:07
1 12:11
1 12:16
0 12:30
0 13:00
0 13:30
0 14:00
1 14:13
1 14:17
2 14:23
2 14:24
1 14:25` 

* * *

我需要这张表请看下面：第二张表

* * *

`VCount Date
0 10:00
0 10:30
0 11:00
2 11:30
4 12:00
0 12:30
0 13:00
0 13:30
7 14:00` 

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T15:45:46.913

这是一些示例代码，解释了如何使用 CASE 语句，您应该能够弄清楚如何在代码中进行更改

```
--sample data
create table #temp (SomeDate datetime)
insert #temp values ( '2009-05-12 11:13:19.667')
insert #temp values ( '2009-05-12 11:12:19.667')
insert #temp values ( '2009-05-12 11:33:19.667')
insert #temp values ( '2009-05-12 11:43:19.667')
insert #temp values ( '2009-05-12 11:03:19.667')
insert #temp values ( '2009-05-12 11:53:19.667')
insert #temp values ( '2009-05-12 11:53:19.667')
insert #temp values ( '2009-05-12 11:23:19.667')

insert #temp values ( '2009-05-12 12:13:19.667')
insert #temp values ( '2009-05-12 12:12:19.667')
insert #temp values ( '2009-05-12 13:33:19.667')
insert #temp values ( '2009-05-12 13:43:19.667')
insert #temp values ( '2009-05-12 14:03:19.667')
insert #temp values ( '2009-05-12 14:53:19.667')
insert #temp values ( '2009-05-12 15:53:19.667')
insert #temp values ( '2009-05-12 15:23:19.667')

--this is the grouping/count query
select count(*),case when datepart(mi,Somedate) < 30 
then dateadd(hh, datediff(hh, 0, Somedate)+0, 0)
 else dateadd(mi,30,dateadd(hh, datediff(hh, 0, Somedate)+0, 0)) end
from #temp
group by case when datepart(mi,Somedate) < 30 
then dateadd(hh, datediff(hh, 0, Somedate)+0, 0)
 else dateadd(mi,30,dateadd(hh, datediff(hh, 0, Somedate)+0, 0)) end 
```

查看数据的实际样子

```
select Somedate,case when datepart(mi,Somedate) < 30 
then dateadd(hh, datediff(hh, 0, Somedate)+0, 0)
 else dateadd(mi,30,dateadd(hh, datediff(hh, 0, Somedate)+0, 0)) end
from #temp 
```

输出

```
vCount  time
4   2009-05-12 11:00:00.000
4   2009-05-12 11:30:00.000
2   2009-05-12 12:00:00.000
2   2009-05-12 13:30:00.000
1   2009-05-12 14:00:00.000
1   2009-05-12 14:30:00.000
1   2009-05-12 15:00:00.000
1   2009-05-12 15:30:00.000 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T13:22:24.177

创建第二个表并使用它插入其中

```
select left(Date,2)+':00' as Date, sum(VCount) as VCount
from Table1
group by left(Date,2) 
```

# xslt - XSLT 外部查找表正确用法 - key() 函数？

> ID：852578
> 
> 赞同：0
> 
> 时间：2009-05-12T12:44:58.870
> 
> 标签：xslt, xslkey

我四处搜索并找到了一些关于 xsl:key 和 key() 函数的教程，但不知何故我显然仍然缺少一些理解。

我需要做一个 XML-XML 转换，其中包括大约 10 个字段，我必须从源 XML 中获取字符串值，从适当的查找表（提供）中找到适当的数字代码，并将这些代码放入生成的 XML 中。

我有一个执行 xsl:for-each 查找表的工作版本，但我怀疑它不是最理想的，我想知道我是否应该使用 select="key('CR-Lookup',$CR)" 代替 somhow .

所以，我想做的是（树的深处）：

```
<Contributor>
<ContributorRole>producer</ContributorRole>
<ContributorName>Anglet, J.</ContributorName>
</Contributor> 
```

变成这样的东西：

```
<Contributor>
<ContributorRole id="7" code="818"/>
<Value id="Name">Anglet, J.</Value>
</Contributor> 
```

我制作的文件是这样的：

查找表文件**lookup_ContributorRole.xml**：

```
<lookup id="ContributorRole">
<row>
  <id>7</id>
  <parentid>NULL</parentid>
  <valueMember>1</valueMember>
  <displayMember>producer</displayMember>
  <code>818</code>
  <externalId>NULL</externalId>
  <description>NULL</description>
</row>
<!-- more <row>s...-->
</lookup> 
```

Amd **XSLT 文件**，我尝试在其中进行匹配：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"  
    xmlns:foxml="info:fedora/fedora-system:def/foxml#" 
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
    xmlns:rel="info:fedora/fedora-system:def/relations-external#"
    xmlns:oai_dc="http://www.openarchives.org/OAI/2.0/oai_dc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema" 
    xmlns:audit="info:fedora/fedora-system:def/audit#" 
    xmlns:fedoraxsi="http://www.w3.org/2001/XMLSchema-instance"

    exclude-result-prefixes="xsl foxml rdf rel oai_dc dc xsi audit fedoraxsi"
>
<xsl:output omit-xml-declaration="yes" indent="yes" method="xml" />

<xsl:key name="CR-lookup" match="row" use="displayMember"/>
<xsl:variable name="CRTable" select="document('lookup_ContributorRole.xml')/lookup/row"/>

<xsl:template match="Contributor">
    <Contributor>
    <xsl:variable name="CR"><xsl:value-of select="ContributorRole"/></xsl:variable>
    <ContributorRole>
    <xsl:for-each select="$CRTable">
        <xsl:if test="displayMember=$CR">
            <xsl:attribute name="id"><xsl:value-of select="id"/></xsl:attribute>
            <xsl:attribute name="code"><xsl:value-of select="code"/></xsl:attribute>
        </xsl:if>
    </xsl:for-each>
    </ContributorRole>
    <Value id="Name"><xsl:value-of select="ContributorName"/></Value>
    </Contributor>
</xsl:template>

    <xsl:template match="/">
    <DigitalObject>
        <Core>
            <xsl:for-each select="/foxml:digitalObject/foxml:datastream[@ID='DigitalObjectLL']/foxml:datastreamVersion">
             <xsl:sort select="@CREATED" order="descending"/>
             <xsl:if test="position() = 1">
                <xsl:for-each select="./foxml:xmlContent/lnbdo">
                    <xsl:apply-templates select="Contributor"/>
                </xsl:for-each>
             </xsl:if>
           </xsl:for-each>
        </Core>
    </DigitalObject>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T12:51:09.400

在使用密钥之前，您已经切换了上下文文档：

```
<xsl:variable name="CRTable" select="document('lookup_ContributorRole.xml')"/>

<xsl:template match="Contributor">
  <Contributor>
    <xsl:variable name="CR" select="ContributorRole"/>
    <ContributorRole>
      <xsl:for-each select="$CRTable"><!-- change context document -->
        <xsl:for-each select="key('CR-lookup', $CR)">
          <xsl:attribute name="id"><xsl:value-of select="id"/></xsl:attribute>
          <xsl:attribute name="code"><xsl:value-of select="code"/></xsl:attribute>
          ... 
```

使用 XSLT 2.0，您可以做到

```
<xsl:for-each select="key('CR-lookup', $CR, $CRTable)"> 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2011-12-22T03:39:54.563

我认为您需要知道使用[Xslt 键功能](http://www.expertscode.com/xslt/xslt-key-function/ "Xslt键功能")的最佳方式。

# java - 如何使用 PicoContainer 管理动态依赖项？

> ID：852579
> 
> 赞同：3
> 
> 时间：2009-05-12T12:45:05.937
> 
> 标签：java, inversion-of-control, ioc-container, picocontainer

假设我有两个班级 A 和 B，其中 B 取决于 A。

```
public class A {}

public class B {
    public B(A a) {}
} 
```

在单个 PicoContainer 中解析 B 很容易。

```
 final MutablePicoContainer root = new PicoBuilder().build();
    root.addComponent(new A());
    root.addComponent(B.class, B.class);
    System.out.println(root.getComponent(B.class)); 
```

但我想`B`为不同的会话提供不同的实例，并使用`A`. 我正在考虑这样的事情。

```
 // during startup
    final MutablePicoContainer root = new PicoBuilder().build();
    root.addComponent(B.class, B.class);

    // later, initialize sessions
    final MutablePicoContainer session = new PicoBuilder(root)
        .implementedBy(TransientPicoContainer.class)
        .build();
    session.addComponent(new A());

    // some request
    System.out.println(session.getComponent(B.class)); 
```

上面的代码不起作用，因为当请求`session`a时，`B`它会向父容器`root`请求它。 `B`在那里找到，但只在内部`root`和它的父母中解决，导致`UnsatisfiableDependenciesException.`

有什么好的方法可以使这项工作吗？或者这是一种反模式，我以错误的方式解决问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T12:50:22.107

解决不存在的性能问题不是一个好方法。您是否进行了任何分析来验证问题？

如果没有，请考虑先这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T11:15:01.167

您是否在容器上启用了缓存（或者您使用的是 Pico 1.x）？

尝试阅读[这个](http://www.picocontainer.org/caching.html)，也许禁用缓存足以解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T08:35:35.707

我也会在会话容器中注册 B 。您可以将 B 的任何其他依赖项保留在根容器中。假设 B 对 C 有另一个依赖项。因此您可以执行以下操作：

```
// during startup
final MutablePicoContainer root = new PicoBuilder().build();
root.addComponent(C.class, C.class);

// later, initialize sessions
final MutablePicoContainer session = new PicoBuilder(root)
    .implementedBy(TransientPicoContainer.class)
    .build();
session.addComponent(B.class, B.class);
session.addComponent(new A());

// some request
System.out.println(session.getComponent(B.class)); 
```

# asp.net-mvc - ASP.NET MVC - 为什么我的视图不能从 System.Web.Mvc.ViewPage(of T) 正确继承

> ID：852585
> 
> 赞同：3
> 
> 时间：2009-05-12T12:46:09.117
> 
> 标签：asp.net-mvc, generics, inheritance

应该可以在这里使用泛型并传递模型的类类型。然而，这不被 Visual Studio 2008 接受：

```
<%@ Page Inherits="System.Web.Mvc.ViewPage(of IEnumerable(of MyNamespace.MyClass))" %> 
```

我收到以下验证错误（在 VS 中加下划线）： `'Context' is not a member of 'ASP._views___home___index__asp'`

我收到以下运行时错误：`BC30456: 'InitializeCulture' is not a member of 'ASP._views___home___index__asp'.`

请注意，我使用的是 Visual Basic.NET - 但这不会影响问题。

这是视图和控制器的一些截图，我希望有人看到发生了什么（TestClass 是一个简单的类，具有 ID 和 Name 属性）：

*   [视图](http://img13.imageshack.us/img13/6315/viewq.jpg)（列表，模型 = IEnumerable）
*   [查看](http://img23.imageshack.us/img23/5479/viewindex.jpg)（索引，无模型）
*   [控制器](http://img13.imageshack.us/img13/9941/controllerl.jpg)
*   [运行时生成的页面](http://img27.imageshack.us/img27/4651/runtime.jpg)（列表：错误）
*   [运行时生成的页面](http://img26.imageshack.us/img26/2261/runtimeindex.jpg)（索引：作品）

根据下面的[Maik Koster](https://stackoverflow.com/users/108919/maik-koster) [回答](https://stackoverflow.com/a/897497/53236)，解决方案是：

1.  重新引用 System.Web.Mvc（在 GAC 中有它，回到本地副本）
2.  从 Controller 重新创建视图。右键单击控制器操作 -> 创建视图...并从那里修改

现在，在 ASP.NET MVC 项目中的视图页面指令有一个继承属性，如下所示：

```
<%@ Page Inherits="System.Web.Mvc.ViewPage" %> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T11:59:27.900

我遇到了同样的问题，它要么是由于缺少引用引起的，要么是由于使用存储库模式并实现了`IDisposable`.

对于后一种情况，我添加了命名空间：`System.Data.Objects`和`System.Data.Objects.DataClasses`. 接下来，我将其添加`System.Data.Entity`为参考，并将其添加到 web.config 中的程序集列表中

```
<add assembly="System.Data.Entity, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/> 
```

这样做之后，这个奇怪的错误就消失了。所以你可能想检查你的参考资料。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T12:55:37.597

像这样做：

```
<%@ Page Inherits="System.Web.Mvc.ViewPage<IEnumerable<MyNamespace.MyClass>>" %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T12:56:11.713

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<MyProject.Helpers.PaginatedList<MyProject.Models.Person>>" %> 
```

希望你得到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-06T23:39:41.260

This might be a [bug](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=104071&wa=wsignin1.0#details) in visual studio intellisense. I have the same that inherited members are underlined in designer but I didn't got a runtime exception.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-18T17:28:42.627

我在 MVC1 中遇到了同样的错误。我更改了模型的命名空间并忘记更新视图。我更新了视图，错误消失了。

# .net - Linq to SQL - 如何按不在选择中的列动态过滤

> ID：852587
> 
> 赞同：1
> 
> 时间：2009-05-12T12:46:52.953
> 
> 标签：.net, asp.net, linq, linq-to-sql

## 问题

使用 SQL 链接我想按我不想在 select 语句中返回的列进行过滤。只要查询是一次构建的，这就可以正常工作。在我尝试动态构建 where 子句的情况下，我收到编译时错误，因为该列未包含在选择中。

* * *

## 例子

*作品*

```
Dim resultA = From logItem In dc.Log 
Where logItem.Message.Contains(searchText) 
Select logItem.LogID, logItem.DateLogged 
```

*不工作*

```
Dim resultB = From logItem In dc.Log 
Select logItem.LogID, logItem.DateLogged

If (Not String.IsNullOrEmpty(searchText)) Then 
    resultB = q.Where(Function(logItem) 
    logItem.Message.Contains(searchText))
End If 
```

* * *

我不确定如何解决这个问题。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T12:51:05.250

以后不能选吗？我不知道 Vb，但类似：

```
Dim resultA = From logItem in dc.Log Select logItem

If (Not String.IsNullOrEmpty(searchText)) Then resultA = q.Where(Function(logItem) logItem.Message.Contains(searchText))

resultA = from logItem in resultA Select logItem.LogID, logItem.DateLogged 
```

我认为这仍然会生成有用的 SQL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T14:46:44.817

感谢您的输入史蒂文。你的建议让我思考，我的最终解决方案就是基于此。但是，我找到了一种重用同一对象的方法，方法是使用 Lambda 表达式在末尾指定一个选择（与 where 语句相同）：

q = q.Select(Function(logItem) 带有 {.LogID = logItem.LogID, .DateLogged = logItem.DateLogged} 的新日志

# debugging - 为所有网页启用所有萤火虫工具？

> ID：852600
> 
> 赞同：2
> 
> 时间：2009-05-12T12:49:02.213
> 
> 标签：debugging, firebug

我正在使用 Firebug 1.3.3 和 Firefox 3.0.10，我想知道是否可以一直启用控制台、脚本和网络控制台。

它曾经是这样的，它总是开着的。现在，如果它被禁用，我必须手动打开每个工具并再次发送请求以查看发生了什么。

有没有办法做到这一点？还有其他人推荐的萤火虫调整吗？

谢谢，

编辑：澄清一下，我的问题是如何让萤火虫始终使用所有网站的所有选项卡。我知道它很慢，我只想知道它是否可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T13:06:34.323

如果您确实想全局启用部分 Firebug，您可以这样做：

单击您要启用的选项卡，主 firebug 窗口将为您提供仅为该站点启用位的选项，并且选项卡旁边将出现一个“向下箭头”图标。

向下箭头将为您提供一个菜单来设置其启用/禁用状态。

默认情况下，它对控制台、网络等禁用。

此菜单为您提供的选项是仅为该站点启用/禁用选项卡，并为所有站点启用/禁用选项卡（已设置每个站点选项的站点除外）。

在此处选择启用，此选项卡将全局启用。您将来访问的所有站点都将启用此选项卡，而无需执行这些步骤。

如果您为每个选项卡执行此操作，它将一直为所有选项卡启用（同样，除了您选择为其设置每个站点设置的任何站点）

一直打开它的问题在于，一些网站会使用 javascript 通过 AJAX 不断地轮询服务器。对于这些请求中的每一个，Firebug 都会尽职尽责地将请求和响应存储在一个列表中。

如果您在这样的网站（例如 Gmail）上花费任何时间，该列表会增长到整个 Firefox 开始变得缓慢且无响应的程度。

我认为如果 Firebug 处于活动状态，Gmail 现在会发出特定警告，但其他网站可能不会。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-12T12:57:05.737

在这种情况下，祝 Web 开发好运。像这样运行 Firebug 肯定会破坏 HTTP 标头，并让您希望快速无痛死亡。:)

在 Firebug 给我带来如此多的痛苦之后，尤其是在使用 Net 监视器时，我不再使用它了。

否则，它是适合时间和地点的非常好的工具，但并非总是如此。

# struts2 - struts2中组合框的隐藏和显示问题

> ID：852602
> 
> 赞同：0
> 
> 时间：2009-05-12T12:49:19.840
> 
> 标签：struts2

我有一个jsp 页面，其中有两个组合框和一个struts 标记的单选按钮。现在取决于单选按钮的值，我必须隐藏一个组合框。我怎样才能在struts2中实现这一点。如果这个标签是简单的 HTML，我可以通过隐藏 div 标签轻松做到这一点。但是这个 jquery 并没有隐藏 struts 标签。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-13T06:33:53.807

你想用struts2隐藏它吗？还是通过jQuery？因为这将完全不同

如果您试图从 struts2 中隐藏 - 使用`<s:if>`标签 - 只需检查单选按钮的值，然后渲染或不渲染。

如果是 jquery，你所要做的就是找到 html 元素 id，比如`($idToHide).hide();`

# ajax - ajax 请求完成后浏览器继续“加载”

> ID：852605
> 
> 赞同：3
> 
> 时间：2009-05-12T12:49:48.390
> 
> 标签：ajax, browser, loading, spinning

你已经看到了——在一个 ajax 繁重的页面上，比如 meebo.com，浏览器永远不会停止“旋转”，它永远不会表明它已经完成加载。是什么原因造成的，有没有办法始终如一地告诉浏览器（无论它可能是什么浏览器）加载已经完成？

编辑：对不起，我应该指定我是这里的开发人员。我在其他网站上注意到了这一点，现在我的一个网站也在使用 ajax。我想确保当 ajax 调用返回时，页面停止“加载”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T13:18:46.463

如果您使用 javascript 使用 document.open() 将内容写入页面，则微调器将旋转，直到您实际调用 document.close()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-01T00:14:42.017

我在另一个问题中回答了这个问题：

[在加载彗星/服务器推送 iframe 时停止浏览器“厄运的颤抖”](https://stackoverflow.com/questions/1064782/stop-the-browser-throbber-of-doom-while-loading-comet-server-push-iframe/)

有一些特定于浏览器的技术可以使旋转停止，或者根本不开始旋转并且仍然使用服务器推送加载数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T22:01:33.340

AJAX 调用本身没有解决方案，但我确实找到了上传到 iframe 的解决方案，这是用于上传的伪 AJAX 技术。如果您从 DOM 中删除 iframe，然后将其放回原处，浏览器将停止上传。巧妙的小技巧。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-25T08:55:50.263

当将行为动态附加到页面或请求大量对象时，这也是 IE 上的一个众所周知的错误。

[Microsoft 知识库文章 - 行为](http://support.microsoft.com/default.aspx?scid=kb;en-us;Q320731)

[Microsoft 知识库文章 - 请求](http://support.microsoft.com/default.aspx?scid=kb;EN-US;Q818506)

# com - HOWTO：在 WindowsCE Compact Framework 上从非托管 C++ 调用托管 C# 接口

> ID：852607
> 
> 赞同：6
> 
> 时间：2009-05-12T12:49:50.980
> 
> 标签：com, compact-framework, windows-ce, unmanaged, managed

我有大量非托管 Windows CE 5 C++ 代码，通过将它与在 Windows CE 6 和 Compact Framework 上用托管 C# 编写的大量更新的业务和通信逻辑相结合，提供了一个我想在新产品中使用的 UI。

UI 可能知道业务逻辑，但我希望业务逻辑不了解 UI，以便我以后可以用托管版本或我选择作为前端的任何其他 UI 替换它。

我找到了一篇文章，描述了如何在 Windows 世界中使用 COM 作为桥梁，但在 WinCE 下的 .NET CF 中应用它时遇到了困难。过去我导入类型库，使用COM调用（CoInitialize()、CoCreateInstance()）来获取其他Windows平台上的接口指针，这就是我现在追求的策略：直接在非托管 C++ 库来访问我的托管库中的 C# 接口，假设 WinCE 中提供了相同的工具。

这是我的问题：类型库。它在我的托管 C# 库中不可用，因为我过去通过 '#import "SomeCPPLibrary.dll"' 语句使用它。我相信它隐藏在 .dll 程序集中，以与过去不同的方式存储，因此不能通过库本身的#import 直接使用。我认为我可以#import 一个 typelib，但是我找不到从我的托管 .dll 中提取 typelib 的方法，虽然我可以将一个接口定义文件 (.idl) 组合在一起并使用平台的 midl.exe要从中生成 .tlb，不能保证我的 .idl 以及由此产生的 .tlb 会真正匹配我的 C# .dll 中的内容。我什至不知道平台 midl.exe 是否以这种方式工作，但假设它确实如此。

1.  我在吠叫错误的树吗？是否可以通过相应的 COM 接口在非托管 C++ 中使用托管 C# 接口？

2.  在其 AssemblyInfo.cs 文件中设置 [assembly: ComVisible(true)] 属性是否可以通过 AssemblyInfo.cs 定义的 GUID 在非托管世界中通过 COM 使用托管程序集中的所有接口，还是我必须做更多的事情？

3.  如何从托管的 .dll 中获取类型库，以便我的非托管 C++ 库可以#import 它？

4.  我尝试将我的托管 C# 库项目作为参考添加到非托管 C++ 库项目中，但这似乎没有帮助。在这种情况下，这样的参考是否相关？

5.  有没有更好的方法来解决从非托管 C++ 世界调用托管 C# 代码的基本问题？我刚刚在这里读到的内容是一个混合模式库，它带有一个托管翻译层，以弥合非托管/托管差距。我不确定这是一个好的策略，因为呼叫响应速度是一个重要因素，但从长远来看可能会更好，因为我计划在某个时候将 UI 重写为托管 C#，从而将所有的努力都放在抛弃 UI 而不是使用更永久的业务/通信逻辑？不管这个问题的答案如何，我仍然想解决使用 COM 的问题，如果只是出于好奇。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T12:57:03.957

我试图在 WinCE 中从 C++ 调用 C#。我不相信 Compact Framework 提供任何 COM 支持，因此您不能使用 ComVisible(true)。

我也找不到在 C++ 中托管 .NET 的方法，因为该功能没有在 Compact Framework 中公开。

我的解决方案是创建一个存根 C# 应用程序并通过 Msg Queues 与 C++ 主机通信。这也解决了数据封送问题。我的使用性能很好。最大的成本是存根的启动时间，如果您的完整应用程序是 C#，您无论如何都必须支付。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T14:18:15.857

你找错树了。为了让本机代码调用托管代码，本机代码必须启动 CLR 的执行引擎。这称为[CLR Hosting](http://msdn.microsoft.com/en-us/magazine/cc163567.aspx)，并且在 CF 中不受支持。这意味着你根本做不到——即使是创造性的黑客也做不到（相信我，我一直在尝试每条小巷）。

# jquery - 根据 DOM 中的位置获取元素名称

> ID：852609
> 
> 赞同：0
> 
> 时间：2009-05-12T12:50:04.550
> 
> 标签：jquery, dom, position, elementname

我想找到我获得顶部和左侧位置的元素的名称或 ID。

我知道如何使用 jquery 来查找元素的位置（将鼠标悬停在 div 上将触发该位置文本将出现在屏幕上）：

```
 $(".item").hover(function () {
      var eleoffset = $(this).offset();
      $("#mouse").text("Mouse - Top: " + eleoffset.top + " - Left: " + eleoffset.left);
    });

<div class="item">This is a text block</div>
<div id="mouse">Waiting for position data...</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T12:58:49.133

我不确定你的意思。但是您可以使用以下方法获取名称或 ID：

```
 $(this).attr('id');
 $(this).attr('name'); 
```

在悬停处理程序中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:58:04.000

```
 $("#mouse").text("Mouse - Top: " + eleoffset.top + " - Left: " + eleoffset.left + " id " + $(this).id); 
```

我认为

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T16:03:44.293

this.id 和 this.name 也应该可以工作。不需要额外的 JQuery 调用。

# ruby-on-rails - 液体中的部分

> ID：852610
> 
> 赞同：5
> 
> 时间：2009-05-12T12:50:41.490
> 
> 标签：ruby-on-rails, liquid

我们正在尝试将当前视图从 ERb 重写为 Liquid，但遇到了以下问题：我们`render(:partial => '/path/to/partial')`的代码中有很多内容，但我们发现绝对没有说明如何在 Liquid 中渲染局部视图。我们找到的唯一一个解决方案是借助 ，`render_to_string`但它太丑了，不可能是真的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T14:33:13.737

Liquid 方式是使用`include`标签： http: [//liquid.rubyforge.org/classes/Liquid/Include.html](http://liquid.rubyforge.org/classes/Liquid/Include.html)

（我知道文档不是很有帮助。这是一个显示示例用法的帖子： [http](http://forums.shopify.com/categories/2/posts/1629) ://forums.shopify.com/categories/2/posts/1629 ）

# asp.net-mvc - 在 asp.net mvc 中创建服务层

> ID：852613
> 
> 赞同：0
> 
> 时间：2009-05-12T12:51:30.087
> 
> 标签：asp.net-mvc

要更新数据库（表）的实体，我们直接继承模型实体来查看页面，如

```
<%@ Page Title="Edit" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<MVCProject.Models.Preson>" %> 
```

然后从控制器调用 Edit 的 Post 方法，最后通过 LINQ 类或 EF 的 savechanges 方法更新实体。

但是用户应该只允许为选定的字段更新“Preson”实体，其余的字段应该自动设置。

用户应该只有选定的值，以便在他的视图中进行编辑。并且实体应该从我们的**服务层**继承， 例如 `<MVCProject.ServiceLayer.Preson>`。

这将是将应用程序拆分为轮胎的最佳方式。

现在，任何人都知道，如何在服务层创建类，并将它们映射到数据库上下文（如果是 LINQ 类）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-04-04T06:13:47.623

要更新选定的值，

1.  使用视图模型方法
2.  在控制器内只允许绑定某些值（包括或排除）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T14:15:39.107

检查[本教程](http://blog.wekeroad.com/mvc-storefront/)，它有大量关于为 MVC 应用程序抽象出服务层的信息。

# macos - 如何使用 AFP 将 Windows 客户端连接到 OSX 服务器

> ID：852614
> 
> 赞同：6
> 
> 时间：2009-05-12T12:51:39.197
> 
> 标签：macos, client, afp

我们正在使用带有 AFP（Apple 归档协议）的 OSX 服务器和客户端，并且希望将唯一的 Windows (Vista x64) 客户端连接到服务器共享，而无需启用 SMB。是否还有适用于 Windows 的 AFP 客户端？

我发现的只是 Windows AFP 服务器，但这不是我们需要的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T12:54:53.930

“法新社”。这让我回来了。

我会选择 SMB 的原因很简单，因为在我信任 Microsoft 或任何正确实施 AFP 的人之前，我会信任 Apple 或任何正确实施 SMB 的人。不是因为相对的能力，而是因为法新社很奇怪，做事出人意料。

我已经实现了一个 AFP 服务器，所以很难学到这一点。

# c# - Hibernate/NHibernate：如何将子类作为超类的实例持久化

> ID：852629
> 
> 赞同：1
> 
> 时间：2009-05-12T12:54:49.423
> 
> 标签：c#, nhibernate, hibernate, subclass

我有两个类我想通过 NHibernate 坚持： - Cat，它有一个名字和一个 Id， - Kitten，它是 Cat 的一个子类（没有额外的公共属性）。

出于愚蠢的原因，我想知道是否可以仅映射 Cat ？因此，当我坚持 Kitten 时，它被保存为 Cat，当我重新加载它时，它被加载为 Cat。

附加限制： - 尝试时，NHibernate 崩溃了，因为它不认识小猫。- 但是我不想添加鉴别器值，因为我不希望 Hibernate 实例化 Kitten 子类。

非常感谢你！

编辑：我忘了写使用显式 ISession.Save("Cat", kitten) 有效。我的问题发生在级联保存期间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-10-25T20:47:14.047

老问题，我想我将不得不使用接口。

# java - Java Swing - 如何在另一个面板上显示一个面板？

> ID：852631
> 
> 赞同：34
> 
> 时间：2009-05-12T12:55:08.580
> 
> 标签：java, swing, dialog, jpanel, z-index

我希望有一个内部（非窗口）对话框来询问成员输入。我希望将对话框集中放置在现有的 JPanel 上。

我查看了[分层窗格](http://java.sun.com/docs/books/tutorial/uiswing/components/layeredpane.html)，这些似乎无法使用，因为所有窗格中只有一个布局管理器（或没有布局管理器）。我想我可以尝试覆盖 JLayeredPane 并提供自定义布局，但这似乎很极端。

[玻璃板](http://java.sun.com/docs/books/tutorial/uiswing/components/rootpane.html)似乎也不合适。

如何才能做到这一点？Swing 中没有可用的 z-index 概念吗？

[![](https://i.stack.imgur.com/YgqbY.png)](https://i.stack.imgur.com/YgqbY.png)

**编辑**

分层窗格不合适的原因是由于每层缺少布局管理器。面板可调整大小，面板 A 应保持在 100% 的区域，面板 B 应保持集中。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-12T13:28:14.197

我认为 LayeredPane 是你最好的选择。您将需要第三个面板来包含 A 和 B。这第三个面板将是 layeredPane，然后面板 A 和 B 仍然可以有一个不错的 LayoutManagers。您所要做的就是使 B 居中于 A 之上，在 Swing 路径中​​有很多关于如何做到这一点的示例。[没有 LayoutManager 的定位教程](http://java.sun.com/docs/books/tutorial/uiswing/layout/none.html)。

```
public class Main {
    private JFrame frame = new JFrame();
    private JLayeredPane lpane = new JLayeredPane();
    private JPanel panelBlue = new JPanel();
    private JPanel panelGreen = new JPanel();
    public Main()
    {
        frame.setPreferredSize(new Dimension(600, 400));
        frame.setLayout(new BorderLayout());
        frame.add(lpane, BorderLayout.CENTER);
        lpane.setBounds(0, 0, 600, 400);
        panelBlue.setBackground(Color.BLUE);
        panelBlue.setBounds(0, 0, 600, 400);
        panelBlue.setOpaque(true);
        panelGreen.setBackground(Color.GREEN);
        panelGreen.setBounds(200, 100, 100, 100);
        panelGreen.setOpaque(true);
        lpane.add(panelBlue, new Integer(0), 0);
        lpane.add(panelGreen, new Integer(1), 0);
        frame.pack();
        frame.setVisible(true);
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        new Main();
    }

} 
```

您可以使用 setBounds 将面板定位在分层窗格内并设置它们的大小。

**编辑以反映对原始帖子的更改** 您将需要添加组件侦听器，以检测何时调整父容器的大小，然后动态更改面板 A 和 B 的边界。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T14:11:46.463

您可以像这样添加未修饰的 JDialog：

```
import java.awt.event.*;

import javax.swing.*;

public class TestSwing {
  public static void main(String[] args) throws Exception {
    JFrame frame = new JFrame("Parent");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(800, 600);
    frame.setVisible(true);

    final JDialog dialog = new JDialog(frame, "Child", true);    
    dialog.setSize(300, 200);
    dialog.setLocationRelativeTo(frame);
    JButton button = new JButton("Button");
    button.addActionListener(new ActionListener() {
      @Override
      public void actionPerformed(ActionEvent e) {
        dialog.dispose();
      }
    });
    dialog.add(button);
    dialog.setUndecorated(true);
    dialog.setVisible(true);
  }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T16:15:13.517

我只是想补充一点，Swing 中有*一个*Z 顺序的概念，请参阅 [java.awt.Component#setComponentZOrder][1]

这会影响组件在其父组件数组中的位置，从而确定绘制顺序。

请注意，您应该重写[javax.swing.JComponent#isOptimizedDrawingEnabled](http://java.sun.com/j2se/1.5.0/docs/api/javax/swing/JComponent.html#isOptimizedDrawingEnabled())以在父容器中返回 false 以使重叠的组件正确重绘，否则它们的重绘将相互破坏。（JComponents 假定没有重叠的子级，除非 isOptimizedDrawingEnabled 返回 false）

[1]： http: [//java.sun.com/j2se/1.5.0/docs/api/java/awt/Container.html#setComponentZOrder](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Container.html#setComponentZOrder(java.awt.Component) (java.awt.Component , int)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T13:04:18.837

在现有的 JPanel 上使用 1 x 1 GridLayout，然后将您的面板添加到该 JPanel。1 比 1 的 GridLayout 的唯一问题是您无法在 JPanel 上放置其他项目。在这种情况下，您必须找出合适的布局。您使用的每个面板都可以使用自己的布局，这样就不会有问题。

我是否正确理解了这个问题？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T13:16:31.680

JOptionPane.showInternalInputDialog 可能做你想要的。如果没有，了解它缺少什么会很​​有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-21T08:40:32.043

这里还有另一个可能感兴趣的布局管理器：[Overlay Layout](https://docs.oracle.com/javase/7/docs/api/javax/swing/OverlayLayout.html) 这是一个简单的教程：[OverlayLayout：用于对位于彼此之上的组件进行布局管理](http://www.java2s.com/Tutorial/Java/0240__Swing/OverlayLayoutforlayoutmanagementofcomponentsthatlieontopofoneanother.htm)。覆盖布局允许您将面板放置在彼此之上，并在每个面板内设置布局。您还可以分别设置每个面板的大小和位置。

（我从几年前开始回答这个问题的原因是因为我偶然发现了同样的问题，而且我很少看到 StackOverflow 上提到 Overlay Layout，虽然它似乎有很好的记录。希望这可以帮助某人其他人一直在寻找它。）

# linq-to-sql - LINQ 嵌套查询

> ID：852633
> 
> 赞同：0
> 
> 时间：2009-05-12T12:55:27.690
> 
> 标签：linq-to-sql

如何使用 LINQ 编写以下 SQL 查询

```
SELECT priority 
FROM Active_SLA 
WHERE APP_ID = (
        SELECT APP_ID 
        FROM FORM_PAGES 
        WHERE PAGE_ADDRESS = @address
    ) 
AND PERSON_ID = (
        SELECT PERSON_ID 
        FROM PERSON_DEVICES 
        WHERE DEVICE_NUMBER = @devicenum
     ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T13:02:18.220

试试这个（为了避免包装而格式化奇怪......）

```
var query = from sla in db.ActiveSLA
            where sla.AppId == (db.FormPages
                         .Where(page => page.PageAddress == address)
                         .Single().AppId)
               && sla.PersonId == (db.PersonDevices
                         .Where(pd => pd.DeviceNumber == deviceNumber)
                         .Single().PersonId)
            select sla.Priority; 
```

但是，我很想将其作为联接来执行：

```
var query = from sla in db.ActiveSLA
            join fp in db.FormPages on sla.AppId equals fp.AppId
            where fp.PageAddress == address
            join pd in db.PersonDevices on sla.PersonId equals pd.PersonId
            where pd.DeviceNumber == deviceNumber
            select sla.priority; 
```

# java - 将VB的Val转换为Java？

> ID：852639
> 
> 赞同：3
> 
> 时间：2009-05-12T12:56:41.540
> 
> 标签：java, vb6

如何使用 Java 编程语言实现 VB 的 Val() 函数，或者是否有任何 API 具有相同的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T13:04:29.663

您应该使用[`Integer.parseInt`](http://java.sun.com/javase/6/docs/api/java/lang/Integer.html),[`Float.parseFloat`](http://java.sun.com/javase/6/docs/api/java/lang/Float.html)等[`Double.parseDouble`](http://java.sun.com/javase/6/docs/api/java/lang/Double.html)- 或 a[`NumberFormat`](http://java.sun.com/javase/6/docs/api/java/text/NumberFormat.html)代替，这取决于您是否希望以文化敏感的方式处理输入。

编辑：请注意，这些期望字符串包含数字而不是其他任何内容。如果您希望能够解析可能以数字开头然后包含其他位的字符串，您需要先清理字符串，例如使用正则表达式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T13:05:21.473

如果我的 Google 技能对我有用，`Val()`将字符串转换为数字；那是对的吗？

如果是这样，[`Integer.parseInt(myString)`](http://java.sun.com/javase/6/docs/api/java/lang/Integer.html#parseInt(java.lang.String))或者[`Double.parseDouble(myString)`](http://java.sun.com/javase/6/docs/api/java/lang/Double.html#parseDouble(java.lang.String))是最接近的 Java 等价物。但是，任何无效字符都会导致他们将整个字符串视为无效；你不能用它们来解析地址中的街道号码。

**编辑：**这是一种更接近等效的方法：

```
public static double val(String str) {
    StringBuilder validStr = new StringBuilder();
    boolean seenDot = false;   // when this is true, dots are not allowed
    boolean seenDigit = false; // when this is true, signs are not allowed
    for (int i = 0; i < str.length(); i++) {
        char c = str.charAt(i);
        if (c == '.' && !seenDot) {
            seenDot = true;
            validStr.append(c);
        } else if ((c == '-' || c == '+') && !seenDigit) {
            validStr.append(c);
        } else if (Character.isDigit(c)) {
            seenDigit = true;
            validStr.append(c);
        } else if (Character.isWhitespace(c)) {
            // just skip over whitespace
            continue;
        } else {
            // invalid character
            break;
        }
    }
    return Double.parseDouble(validStr.toString());
} 
```

测试：

```
public static void main(String[] args) {
    System.out.println(val(" 1615 198th Street N.E."));
    System.out.println(val("2457"));
    System.out.println(val(" 2 45 7"));
    System.out.println(val("24 and 57"));
} 
```

输出：

```
1615198.0
2457.0
2457.0
24.0

```

我不能保证它的速度，但它可能`Double.parseDouble`是最昂贵的部分。我想在这个函数中进行双重解析也可能会快一点，但我肯定这首先是一个瓶颈。否则，这只是不值得麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T13:14:38.250

尝试这个：

```
Number Val(String value) {
    try {
        return NumberFormat.getNumberInstance().parse(value);
    } catch (ParseException e) {
        throw new IllegalArgumentException(value + " is not a number");
    }
}

Number a = Val("10");     // a instanceof Long 
Number b = Val("1.32");   // b instanceof Double
Number c = Val("0x100");  // c instanceof Long 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T13:41:05.183

```
ValResult = Val("1615 198th Street NE") ' ValResult 设置为 1615198
ValResult = Val("2457") ' ValResult 设置为 2457。
ValResult = Val(" 2 45 7") ' ValResult 设置为 2457。
ValResult = Val("24 and 57") ' ValResult 设置为 24。

```

任何 Java API 都可以做出相同的行为吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-12T20:27:50.063

```
var val = parseFloat("0" + /\d*\.?\d*/.exec(value)) 
```

[http://www.w3schools.com/jsref/jsref_obj_regexp.asp](http://www.w3schools.com/jsref/jsref_obj_regexp.asp)

[http://www.javascripter.net/faq/convert2.htm](http://www.javascripter.net/faq/convert2.htm)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-12T13:04:30.927

如果要将字符串转换为整数，请使用：

```
int x = Integer.parseInt(aString); 
```

# asp.net-mvc - ASP.NET MVC - 如何从引用的类库中的类创建强类型视图？

> ID：852645
> 
> 赞同：5
> 
> 时间：2009-05-12T12:58:13.673
> 
> 标签：asp.net-mvc, view, strong-typing

我正在尝试使用 Visual Studio 2008 创建强类型视图。我可以右键单击控制器操作并选择：添加视图... 在下一个对话框窗口中有一个选项“创建强类型视图”。如果我选中此选项，我可以选择当前项目中的类列表。

**但是，我无法选择我需要的类，该类位于我引用的类库中。**

*   类库是加载在 GAC 中的强类型程序集。
*   显然，该库在项目中被引用。
*   我在 web.config 中添加了一个 <add namespace="namespace" />
*   我已经重建了多次，并重新启动了 VS
*   类库没有任何问题...

有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-01-29T17:48:35.527

回答这个问题肯定为时已晚，但对于未来的读者：

我注意到很多时候我必须构建->清理解决方案，然后构建->重建解决方案，并且这些类神奇地出现（它们应该如此）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T13:02:50.543

只需使用任何模型类创建您的视图，然后手动编辑 ASPX 并将模型类替换为您想要的模型类。可能对话窗口不够智能。

但在我个人看来，使用“外部”类作为模型是非常错误的。

所有模型、视图和控制器都应该在这里，直接在您的项目中。然后，他们可以在内部使用任何他们需要的东西，无论它在哪里。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-08T17:34:56.557

这是很久以前发布的，但我的解决方案可能会对某人有所帮助....

我刚刚遇到了同样的问题，我发现如果我将“Controller”作为类名的一部分——我有一个“DoorController”——我无法通过强类型视图选择添加它。这也给我带来了asp mvc中的其他问题。

这可能适用于“模型”和“视图”吗？尝试更改模型的类名以解决此问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T13:11:07.963

我不确定我自己的类是否出现在列表中——我通常只是输入它们（从根命名空间开始）。例如，如果您尝试`MyRootNamespace.MyClassLibrary.MyNamespace.AnotherNamespace.TheClass`在文本框中输入内容并单击“确定”，会发生什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-21T12:49:57.020

> 我可以手动输入包含命名空间的类名，但是视图内容下拉菜单随后被禁用... – ropstah 5 月 12 日 13:31

我的自定义创建的数据类也有同样的问题。它们显示在“查看数据类”下拉菜单中，但“查看内容”下拉菜单被禁用。我猜我的类需要实现一些接口。我只是不确定是哪一个。

# html - 使用 Microsoft Expression 的 HTML 文件中的虚假字符

> ID：852655
> 
> 赞同：-1
> 
> 时间：2009-05-12T13:00:26.117
> 
> 标签：html, unicode, expression-web

我有 MS Expression Web (12.0.6211.1000)。

我通常使用 Homesite，但它和 Vista 无法正常运行，所以我想我会尝试使用 Expression 来编辑简单的 HTML 文件。

我发现 Espression Web 插入了字符

```
ï»¿ 
```

在我编辑的每个文件的顶部，就在`<!DOCTYPE...`标签之前。这些是什么，我怎样才能让它停止！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T13:05:43.267

那就是将 Unicode 字节顺序标记解释为不是 Unicode 字符编码的东西（例如 ISO-8859-1 AKA Latin-1）。

W3C 有一个[指南来指定您实际使用的字符编码](http://www.w3.org/International/O-charset)。

如果您不想使用 Unicode 编码（我建议您这样做，它们是当前标准，而不是传统的 ISO-8859 系列），那么[论坛](http://social.expression.microsoft.com/Forums/en-US/web/thread/87a9f332-65e7-4d83-8f6d-46c0d9749ea5/)建议您可以通过转到（奇怪的）文件 >属性... > 语言并查找“将文档另存为”列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T13:02:50.073

这是 Unicode 字节顺序标记；Expression Web 以 UTF-8 格式保存。

# php - 在 Zend Framework 中放置模型的最佳位置在哪里？

> ID：852664
> 
> 赞同：2
> 
> 时间：2009-05-12T13:03:02.680
> 
> 标签：php, model-view-controller, zend-framework

我想知道将模型类放在 Zend Framework 项目中的最佳位置在哪里。我听说图书馆里面是版本 < 1.8 的更好的地方。在 1.8 版本中，我们有 ResourceLoader，因此我们可以将其放入 modules 目录中。

你的方法是什么？最佳做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T13:08:09.280

查看此文档，了解几个典型的目录布局： [选择您的应用程序的目录布局](http://framework.zend.com/wiki/display/ZFDEV/Choosing+Your+Application%27s+Directory+Layout)

我的设置如下所示：

```
app/
    controllers/
    forms/
    lib/
    models/
    views/
    config.ini
lib/
sql/
var/
web/
    css/
    img/
    js/
    .htaccess
    index.php 
```

我使用 Zend Autoloader 自动包含模型类。`index.php`我的文件的最顶部是：

```
$paths = array(
    '/usr/share/php/ZendFramework/library',
    '../app/models',
    '../app/lib',
    '../app/forms',
    '../app/models',
    '../lib',
    get_include_path()
);
set_include_path(implode(PATH_SEPARATOR, $paths));

// bootstrap
require 'Zend/Loader.php';
Zend_Loader::registerAutoload(); 
```

适用于 Zend Framework 1.7 和 1.8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-01T16:01:32.330

目前使用 1.11.5，我将模型保存在`application/models`目录中。

我相信这`Zend/Loader.php`已被弃用。

# java - Java中的命令行进度条

> ID：852665
> 
> 赞同：151
> 
> 时间：2009-05-12T13:03:29.463
> 
> 标签：java, command-line, progress-bar

我有一个在命令行模式下运行的 Java 程序。我想显示一个进度条，显示已完成工作的百分比。在 unix 下使用 wget 会看到相同的进度条。这可能吗？

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2009-05-12T13:30:10.277

我以前实现过这种东西。它不是关于 java 的，而是发送到控制台的字符。

`\n`关键是和之间的区别`\r`。 `\n`转到新行的开头。但`\r`只是*回车*- 它回到同一行的开头。

所以要做的就是打印你的进度条，例如，通过打印字符串

```
"|========        |\r" 
```

在进度条的下一个刻度上，用更长的条覆盖同一行。（因为我们使用的是 \r，所以我们保持在同一行）例如：

```
"|=========       |\r" 
```

你必须记住要做的是，完成后，如果你只是打印

```
"done!\n" 
```

你可能仍然有一些来自进度条的垃圾就行了。因此，在完成进度条后，请务必打印足够的空白以将其从行中删除。如：

```
"done             |\n" 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2018-02-18T17:58:17.730

有[https://github.com/ctongfei/progressbar](https://github.com/ctongfei/progressbar)，许可证：MIT

简单的控制台进度条。进度条写入现在在另一个线程上运行。

![](https://i.gyazo.com/1c02d51927e769cf245a108f5a8dfaf5.gif)

推荐使用 Menlo、Fira Mono、Source Code Pro 或 SF Mono 以获得最佳视觉效果。

对于 Consolas 或 Andale Mono 字体，请使用`ProgressBarStyle.ASCII`（见下文），因为这些字体中的画框字形未正确对齐。

![](https://i.gyazo.com/e01943454443f90c9499c00a6c197a41.gif)

[马文](https://search.maven.org/artifact/me.tongfei/progressbar)：

```
<dependency>
  <groupId>me.tongfei</groupId>
  <artifactId>progressbar</artifactId>
  <version>0.5.5</version>
</dependency> 
```

用法：

```
ProgressBar pb = new ProgressBar("Test", 100); // name, initial max
 // Use ProgressBar("Test", 100, ProgressBarStyle.ASCII) if you want ASCII output style
pb.start(); // the progress bar starts timing
// Or you could combine these two lines like this:
//   ProgressBar pb = new ProgressBar("Test", 100).start();
some loop {
  ...
  pb.step(); // step by 1
  pb.stepBy(n); // step by n
  ...
  pb.stepTo(n); // step directly to n
  ...
  pb.maxHint(n);
  // reset the max of this progress bar as n. This may be useful when the program
  // gets new information about the current progress.
  // Can set n to be less than zero: this means that this progress bar would become
  // indefinite: the max would be unknown.
  ...
  pb.setExtraMessage("Reading..."); // Set extra message to display at the end of the bar
}
pb.stop() // stops the progress bar 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-11-23T21:32:53.430

我发现以下代码可以正常工作。它将字节写入输出缓冲区。也许使用类似方法的编写器的`System.out.println()`方法会替换出现的`\r`to`\n`以匹配目标的本机行尾（如果配置不正确）。

```
public class Main{
    public static void main(String[] arg) throws Exception {
        String anim= "|/-\\";
        for (int x =0 ; x < 100 ; x++) {
            String data = "\r" + anim.charAt(x % anim.length()) + " " + x;
            System.out.write(data.getBytes());
            Thread.sleep(100);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-04-12T23:25:36.053

我已经取得了一定的进度来检查剩余的下载文件。

我在我的文件下载中定期调用该方法来检查总文件大小和剩余文件，并将其呈现在`%`.

它也可以用于其他任务目的。

测试和输出示例

```
progressPercentage(0, 1000);
[----------] 0%

progressPercentage(10, 100);
[*---------] 10%

progressPercentage(500000, 1000000);
[*****-----] 50%

progressPercentage(90, 100);
[*********-] 90%

progressPercentage(1000, 1000);
[**********] 100% 
```

用 for 循环测试

```
for (int i = 0; i <= 200; i = i + 20) {
    progressPercentage(i, 200);
    try {
        Thread.sleep(500);
    } catch (Exception e) {
    }
} 
```

该方法可以很容易地修改：

```
public static void progressPercentage(int remain, int total) {
    if (remain > total) {
        throw new IllegalArgumentException();
    }
    int maxBareSize = 10; // 10unit for 100%
    int remainProcent = ((100 * remain) / total) / maxBareSize;
    char defaultChar = '-';
    String icon = "*";
    String bare = new String(new char[maxBareSize]).replace('\0', defaultChar) + "]";
    StringBuilder bareDone = new StringBuilder();
    bareDone.append("[");
    for (int i = 0; i < remainProcent; i++) {
        bareDone.append(icon);
    }
    String bareRemain = bare.substring(remainProcent, bare.length());
    System.out.print("\r" + bareDone + bareRemain + " " + remainProcent * 10 + "%");
    if (remain == total) {
        System.out.print("\n");
    }
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-12T13:17:57.540

C# 示例，但我假设这`System.out.print`在 Java 中是相同的。如果我错了，请随时纠正我。

基本上，您想在消息的开头写出`\r`转义字符，这将导致光标返回到行首（换行）而不移动到下一行。

```
 static string DisplayBar(int i)
    {
        StringBuilder sb = new StringBuilder();

        int x = i / 2;
        sb.Append("|");
        for (int k = 0; k < 50; k++)
            sb.AppendFormat("{0}", ((x <= k) ? " " : "="));
        sb.Append("|");

        return sb.ToString();
    }

    static void Main(string[] args)
    {
        for (int i = 0; i <= 100; i++)
        {
            System.Threading.Thread.Sleep(200);
            Console.Write("\r{0} {1}% Done", DisplayBar(i), i);
        }

        Console.ReadLine();

    } 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-03-23T13:35:07.160

稍微重构和更新了@maytham-ɯɐɥʇʎɐɯ 的方法。现在它支持任意大小的进度条：

```
 public static void progressPercentage(int done, int total) {
        int size = 5;
        String iconLeftBoundary = "[";
        String iconDone = "=";
        String iconRemain = ".";
        String iconRightBoundary = "]";

        if (done > total) {
            throw new IllegalArgumentException();
        }
        int donePercents = (100 * done) / total;
        int doneLength = size * donePercents / 100;

        StringBuilder bar = new StringBuilder(iconLeftBoundary);
        for (int i = 0; i < size; i++) {
            if (i < doneLength) {
                bar.append(iconDone);
            } else {
                bar.append(iconRemain);
            }
        }
        bar.append(iconRightBoundary);

        System.out.print("\r" + bar + " " + donePercents + "%");

        if (done == total) {
            System.out.print("\n");
        }
    } 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-04-23T06:33:31.907

这是上面的修改版本：

```
private static boolean loading = true;
private static synchronized void loading(String msg) throws IOException, InterruptedException {
    System.out.println(msg);
    Thread th = new Thread() {
        @Override
        public void run() {
            try {
                System.out.write("\r|".getBytes());
                while(loading) {
                    System.out.write("-".getBytes());
                    Thread.sleep(500);
                }
                System.out.write("| Done \r\n".getBytes());
            } catch (IOException e) {
                e.printStackTrace();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    };
    th.start();
} 
```

...主要是：

```
loading("Calculating ..."); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-06-10T23:10:30.543

我将 Eoin Campbell 的代码编辑为 java 并添加了百分比格式的进度。

```
public static String progressBar(int currentValue, int maxValue) {
    int progressBarLength = 33; //
    if (progressBarLength < 9 || progressBarLength % 2 == 0) {
        throw new ArithmeticException("formattedPercent.length() = 9! + even number of chars (one for each side)");
    }
    int currentProgressBarIndex = (int) Math.ceil(((double) progressBarLength / maxValue) * currentValue);
    String formattedPercent = String.format(" %5.1f %% ", (100 * currentProgressBarIndex) / (double) progressBarLength);
    int percentStartIndex = ((progressBarLength - formattedPercent.length()) / 2);

    StringBuilder sb = new StringBuilder();
    sb.append("[");
    for (int progressBarIndex = 0; progressBarIndex < progressBarLength; progressBarIndex++) {
        if (progressBarIndex <= percentStartIndex - 1
        ||  progressBarIndex >= percentStartIndex + formattedPercent.length()) {
            sb.append(currentProgressBarIndex <= progressBarIndex ? " " : "=");
        } else if (progressBarIndex == percentStartIndex) {
            sb.append(formattedPercent);
        }
    }
    sb.append("]");
    return sb.toString();
}

int max = 22;
System.out.println("Generating report...");
for (int i = 0; i <= max; i++) {
   Thread.sleep(100);
   System.out.print(String.format("\r%s", progressBar(i, max)));
}
System.out.println("\nSuccessfully saved 32128 bytes"); 
```

并输出：

```
Generating report...

[========      24.2 %             ]

[============  45.5 %             ]

[============  78.8 % =====       ]

[============  87.9 % ========    ]

[============ 100.0 % ============]

Successfully saved 32128 bytes 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-12T13:17:10.990

这可以通过 Java Curses 库实现。[这](http://sourceforge.net/projects/javacurses/)就是我发现的。我自己没用过，不知道是不是跨平台的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-05-23T18:15:31.423

当我需要延迟工具以防止出现竞争条件时，我会使用“弹跳”进度条。

```
private void delay(long milliseconds) {
    String bar = "[--------------------]";
    String icon = "%";

    long startTime = new Date().getTime();
    boolean bouncePositive = true;
    int barPosition = 0;

    while((new Date().getTime() - startTime) < milliseconds) {
        if(barPosition < bar.length() && barPosition > 0) {
            String b1 = bar.substring(0, barPosition);
            String b2 = bar.substring(barPosition);
            System.out.print("\r Delaying: " + b1 + icon + b2);
            if(bouncePositive) barPosition++;
            else barPosition--;
        } if(barPosition == bar.length()) {
            barPosition--;
            bouncePositive = false;
        } if(barPosition == 0) {
            barPosition++;
            bouncePositive = true;
        }

        try { Thread.sleep(100); }
        catch (Exception e) {}
    }
    System.out.print("\n");
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-02-13T15:30:36.903

我最近遇到了同样的问题，你可以查看我的代码：我已经将它设置为一个# on 5%，你可以稍后修改。

```
public static void main (String[] args) throws java.lang.Exception
{
    int i = 0;
    while(i < 21) {
        System.out.print("[");
        for (int j=0;j<i;j++) {
            System.out.print("#");
        }

        for (int j=0;j<20-i;j++) {
            System.out.print(" ");
        }

        System.out.print("] "+  i*5 + "%");
        if(i<20) {
            System.out.print("\r");
            Thread.sleep(300);
        }
        i++;
    }
    System.out.println();
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-07-04T10:28:52.600

```
public static void main(String[] argv) throws Exception{

    System.out.write("\r".getBytes());
    int percentage =10;
    while(percentage <= 100) {
        String temp =generateStars(percentage);
        System.out.write(temp.getBytes());
        System.out.print("\b\b\b");
        percentage = percentage+10;
        Thread.sleep(500);
    }
}

    public static String generateStars(int percentage)
    {
        int startsNum = percentage / 4;
        StringBuilder builder = new StringBuilder();
        while(startsNum >= 0)
        {
        builder.append("*");
        startsNum--;
        }
        builder.append(percentage+"%");
        return builder.toString();
    } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-04-06T21:14:17.933

```
static String progressBar(int progressBarSize, long currentPosition, long startPositoin, long finishPosition) {
    String bar = "";
    int nPositions = progressBarSize;
    char pb = '░';
    char stat = '█';
    for (int p = 0; p < nPositions; p++) {
        bar += pb;
    }
    int ststus = (int) (100 * (currentPosition - startPositoin) / (finishPosition - startPositoin));
    int move = (nPositions * ststus) / 100;
    return "[" + bar.substring(0, move).replace(pb, stat) + ststus + "%" + bar.substring(move, bar.length()) + "]";
} 
```

[![图片](https://i.stack.imgur.com/QS7Sa.png)](https://i.stack.imgur.com/QS7Sa.png)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-01-28T00:37:14.167

## 它不需要很复杂。

[![在此处输入图像描述](https://i.stack.imgur.com/wOgCi.png)](https://i.stack.imgur.com/wOgCi.png)

```
public class Demo {
  private static final StringBuilder sb = new StringBuilder();

  public static void main (String[] args) throws java.lang.Exception
  {
    for (int i = 0 ; i <= 100 ; i++) {
      sb.setLength(0);
      for (int j = 0 ; j < i; j++) {
        sb.append("#");
      }
      Thread.sleep(100);
      System.out.print("[" + String.format("%-100s", sb.toString()) + "] " +  i + "%");
      System.out.print("\r");
    }
  }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-03-14T16:36:53.470

```
public class ProgressBar
{
    private int max;

    public ProgressBar(int max0) {
        max = max0;
        update(0);
    }

    public void update(int perc) {
        String toPrint = "|";
        for(int i = 0; i < max; i++) {
            if(i <= (perc + 1))
                toPrint += "=";
            else
                toPrint += " ";
        }

        if(perc >= max)
            Console.print("\r");
        else
            Console.print(toPrint + "|\r");
    }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-12-20T13:46:25.370

```
public class Main {

    public static void main(String[] args) throws Exception {

        System.out.println("Loading : ");
            int count =1;
            for(int j=1;j<150;j++){

                System.out.print("\r");
                if(count==1){
                    System.out.print("/");
                    count++;
                }
                else if(count==2){
                    System.out.print("|");
                    count++;
                }
                else if(count==3){
                    System.out.print("-");
                    count++;
                }
                else if(count==4){
                    System.out.print("\\");
                    count++;
                }
                else if(count==5){
                    System.out.print("|");
                    count++;
                }
                else
                    count = 1;
            Thread.sleep(200);
        }

        }

    } 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-12-17T10:24:10.420

```
public class ConsoleApp {
    static String DisplayBar(int i)
    {
        StringBuilder sb = new StringBuilder();

        int x = i / 2;
        sb.append("|");
        for (int k = 0; k < 50; k++)
            sb.append(String.format("%s", ((x <= k) ? " " : "=")));
        sb.append("|");

        return sb.toString();
    }

    public static void main(String[] args) throws InterruptedException {
        for (int i = 0; i <= 100; i++)
        {
            Thread.sleep(200);
            System.out.printf("\r%s %s  Done", DisplayBar(i), i);
        }
    }
} 
```

# math - 计算操作的 ETA 的最佳方法？

> ID：852670
> 
> 赞同：14
> 
> 时间：2009-05-12T13:04:57.603
> 
> 标签：math, progress, time-estimation

我正在寻找使用线性进度信息计算操作的 ETA（即：文件下载）的最佳方法。

可以说我有以下被调用的方法：

```
void ReportProgress(double position, double total)
{
    ...
} 
```

我有几个想法：

*   计算设定时间内的进度（如最后 10 秒）并将该速度用作操作的平均速度
*   保留一组已报告的最后 x 个进度，计算每个增量的速度并使用平均值

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T13:18:36.540

我实际上鄙视这两个想法，因为它们都曾在我作为开发人员之前咬过我。

第一个没有考虑操作实际上变快的情况，它说还有10分钟，我在3后回来，它就完成了。

第二个没有考虑到操作变慢 - 我认为 Windows 资源管理器必须使用这种方法，因为它似乎总是需要 90% 的时间复制 90% 的文件，然后再花 90% 的时间复制最后 10 个文件% 的文件:-)。

我早就开始计算这两个数字并取平均值。客户不在乎（他们也并不真正关心其他两个选项，他们只是想看到*一些*进展）但这让我感觉更好，这就是我真正关心的一天结束时;- )

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-12T13:16:10.043

这样的事情应该可以解决问题：

```
void ReportProgress(double position, double total)
{
    static TimeType startTime;

    if (position == 0)
    {
        startTime = GetTime();
        return; // to avoid a divide-by-zero error
    }

    TimeType elapsedTime = GetTime() - startTime;
    TimeType estimatedRemaining = elapsedTime * total / position;
    TimeType estimatedEndTime = GetTime() + estimatedRemaining;

    // Print the results here
} 
```

随着进度接近 100%，估计值越来越接近事实

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-12T14:29:04.090

我认为这个问题几乎是无法解决的，但是可以通过对正在执行的过程的更多了解来创建一些准确的估计。在存在大量未知数的情况下，最好将这些未知数告知用户，以便他们将其考虑在内。

以下载一批文件为例，您有两个已知变量：

*   文件数
*   文件的大小

对于每个文件，都有固定的开销（建立连接所花费的时间，以及在文件系统上打开文件所花费的时间）。还有与文件大小相关的明显下载时间。创建一个可以根据当前下载速度将其表示为剩余时间的函数很容易并且准确，前提是下载速度不会波动太大。但问题就在这里。

使用您正在执行的操作的准确模型，如果没有外部影响，很容易预测需要多长时间。而这几乎是不可能的。

但是，您可以寻求尝试理解和解释这些外部影响的解决方案。当速度急剧变化时，用户可能会发现收到警报很有帮助，因为他们可以调整计划以适应新的 ETA。解释影响当前操作的因素也可能会有所帮助。例如

```
Your download will complete in 6 minutes, if the download speed stays at 50k/s 
```

如果用户知道速度可能会改变，这允许用户做出一些有根据的猜测。并最终导致更少的挫败感。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-03T08:15:46.617

布拉姆科恩谈到了这一点。他在 BitTorrent 中为 ETA 计算付出了很多努力（但在一次演讲中，他提到还没有人找到他说“嘿！在 bittorrent 中的 ETA 计算很棒！”）。这不是一个简单的问题。

一些相关链接：

*   [http://bramcohen.livejournal.com/24122.html](http://bramcohen.livejournal.com/24122.html)
*   [http://www.mccaughan.org.uk/g/remarks/time-left.html](http://www.mccaughan.org.uk/g/remarks/time-left.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T14:02:57.307

如果您想要 ETA 而不是“进度条”，那么您可以提供多个数字吗？

计算一段时间内的平均下载速度（取决于整体下载可能持续多长时间，如果您正在查看 10 分钟以上，那么每 5 秒左右就可以了）并记录平均值。

然后你可以提供两个数字，一个上限和一个下限。

如果您确信平均值可以很好地指示总下载时间，那么您可以显示第 40 个百分位数和第 60 个百分位数 - 如果平均下载时间差异很大，那么第 10 个和第 90 个百分位数可能会更好。

我宁愿看到一个“21-30 分钟”的球场，它是准确的，而不是被告知 29 分 35.2 秒，而且距离很远，并且从一个更新到下一个更新变化很大。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T13:15:06.893

这将取决于操作时间的一致性。如果它是一致的，那么使用先前操作的平均时间将是完全合理的。如果不是，您最好对当前操作进行计时并进行推断。

**编辑：**如果操作与以前的运行不一致，并且从开始到结束也不一致，那么你有一个无法解决的问题。预测不可预知的事情总是很有趣:)

如果您想低估或高估，您可能会提前决定，并在估算中添加一个捏造因素。例如，如果您想高估，而前 10% 需要 6 秒，您可以外推到 60 秒，然后乘以 1.5 得到 90 秒的总估计值。随着完成百分比的增加，减少软糖因子直到 100% 变为 1.0。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-30T00:23:14.503

在 Python 中：

```
>>> done=0.3; duration=10; "time left: %i" % (duration/done-duration)
'time left: 23' 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-12-05T14:55:52.883

我从事的项目需要 ETA 进行长时间、耗时的计算，而我最终做的是将过程分成相同大小的批次。然后，我计算每个批次需要多长时间，并将所花费的时间添加到过去计算时间的 FIFO 列表中。

然后对列表中的时间进行平均，并将结果时间乘以剩余的批次数量。

```
number of batches = N
size of batch = x
past computations length = l (t0,t1,...,tl)
avg time per batch = (t0 + t1 + ... + tl) / l = t
computed batches = n

ETA = t * (N - n) 
```

**请注意**，该列表具有固定长度，应该足够长以让估计过程*“记住”*并调整到计算中可能的峰值，但它也应该足够短以快速适应计算速度的变化（例如，更多的计算时间跟随竞争任务的结束/更多带宽）

# programming-languages - 使用哪种编程语言来构建 Workday HRMS 软件？

> ID：852674
> 
> 赞同：2
> 
> 时间：2009-05-12T13:05:35.060
> 
> 标签：programming-languages

哪些编程语言和技术用于构建[Workday](http://www.workday.com)软件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-07-28T12:52:00.477

Workday 使用了很多技术，但 Java 是使用的基本编程语言：

[http://www.workday.com/company/careers/jobs.php](http://www.workday.com/company/careers/jobs.php)

# c++ - “布尔短路”是由标准规定还是主要用作优化？

> ID：852676
> 
> 赞同：3
> 
> 时间：2009-05-12T13:05:54.293
> 
> 标签：c++, c, standards-compliance, boolean-logic, boolean-expression

考虑这个

```
Class* p = NULL;
if( p != NULL && p->Method() == OK ){

  // stuff
} 
```

在我使用过的所有编译器上，这是非常安全的。即布尔表达式的第一部分将评估为*false*，因此不会尝试对 Method() 的调用，因为评估第二部分是多余的。

这是因为大多数编译器会优化第二部分的评估，还是它是 C/C++ 标准的规定行为？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T13:07:25.413

表达式快捷方式由标准保证。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T13:09:10.230

这称为布尔短路，并被定义为许多语言。 [这](http://en.wikipedia.org/wiki/Short-circuit_evaluation)是一篇维基百科文章，描述了哪些语言具有此功能。

现在您知道该功能的正确名称，还有[其他关于它的 SO 文章](https://stackoverflow.com/search?q=short+circuit)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T13:10:20.993

С++ 标准 1998
第 5.14 节

> && 运算符从左到右分组。操作数都被隐式转换为 bool 类型（第 4 条）。如果两个操作数都为真，则结果为真，否则为假。与 & 不同，&& 保证从左到右的评估：如果第一个操作数为假，则不评估第二个操作数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-12T13:16:07.687

我还没有看到它提到过，所以：

C++ 保证短路，**除非调用的`&&`or`||`运算符被重载**。但是不要那样做，因为它太混乱了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T13:08:25.333

这是一种称为短路的功能。此行为由 C++ 标准保证。我不认为这是一种优化，但它更像是一种语言功能。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-12T13:19:17.210

不只是优化，有用的是让你更简洁。

正如您的示例所示，它允许您在一行中编写一个“安全”的取消引用语句。否则，您必须执行以下操作：

```
if (p != null) {
    if (p.getValue() == 3) {
        // do stuff
    }
} 
```

看起来微不足道，但尝试用没有它的语言（例如 VB6）进行编码，您就会开始非常想念它。

正如其他答案所提到的，它在语言标准中，但只是因为需要明确指定这样的内容。它可能编译成优化的代码是一个副作用。如今，一个像样的 C 或 C++ 编译器会等效地编译单行或两行语句

# c# - 向操作系统执行键盘命令

> ID：852678
> 
> 赞同：0
> 
> 时间：2009-05-12T13:06:39.817
> 
> 标签：c#

我想要做的是执行操作系统的媒体密钥。例如：如果用户按下一个按钮，它将改变 iTunes 或 wmp 等中的曲目。

我在 C# 中使用 .Net。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T13:16:55.610

你想让它看起来好像用户按下了键盘上的媒体键之一？

使用 Windows[`SendInput`](http://pinvoke.net/default.aspx/user32/SendInput.html)函数并向其传递一个`KEYBDINPUT`包含例如`VK_MEDIA_NEXT_TRACK`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T13:19:21.377

所有人都聚集在这里@stackoverflow：

[http://www.codeproject.com/KB/cs/CSLLKeyboardHook.aspx](http://www.codeproject.com/KB/cs/CSLLKeyboardHook.aspx)

[如何使用 WPF 和 .NET 3.5 注册全局热键以说出 CTRL+SHIFT+(LETTER)？](https://stackoverflow.com/questions/48935/c-using-wpf-and-net-35-how-can-i-register-a-global-hot-key-to-say-ctrlshiftlett)

[http://bloggablea.wordpress.com/2007/05/01/global-hotkeys-with-net/](http://bloggablea.wordpress.com/2007/05/01/global-hotkeys-with-net/)

好好享受 ：）

# .net - Linq to SQL - 不要获取特定列

> ID：852679
> 
> 赞同：17
> 
> 时间：2009-05-12T13:07:02.200
> 
> 标签：.net, linq, linq-to-sql, sqlmetal

有没有办法*不*使用 linqtosql 获取特定列，而不必使用匿名类型并单独指定每个返回的文件？

我们使用 SQLMetal 生成 dbml 文件，该文件包含所有类型的查询数据结果。但是，当在LINQ查询中包含选择列时，结果将变成匿名类型，而不是DBML文件中声明的类型。我想从特定表中选择*除一列之外的所有列，但仍然以相关的 dbml 类型返回结果。*

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-12T13:44:38.063

LINQ to SQL 支持[延迟加载](http://en.wikipedia.org/wiki/Lazy_loading)单个属性。在 DBML 设计器中，您可以`Delay Loaded`在`true`列的属性中设置。延迟加载的列将不包含在初始`SELECT`. 如果您尝试访问对象的属性但尚未加载，则将`SELECT`执行另一条语句以从数据库中获取该值。

如果您手动编辑 DBML 文件，请将`<Column IsDelayLoaded="true">`. 如果您要手动编写 LINQ to SQL 类，则只需将属性的支持字段声明为 a`Link<T>`而不是`T`. 例如：

```
[Table]
public class Person
{
    private Link<string> _name;

    [Column(Storage = "_name")]
    public string Name
    {
        get { return _name.Value; }
        set { _name.Value = value; }
    }
} 
```

另请参阅[Scott Guthrie 的这篇文章](http://weblogs.asp.net/scottgu/archive/2007/05/29/linq-to-sql-part-2-defining-our-data-model-classes.aspx)中的“延迟/延迟加载”部分。

* * *

更新：如果您希望该列在需要时仍然可用，则上述答案适用。它不会包含在`SELECT`s 中，除非您特别要求（请参阅`LoadOptions`）或尝试访问它。

如果您根本不想使用或访问该列，并且不希望它作为类属性使用，那么请使用[Serapth](https://stackoverflow.com/questions/852679/linq-to-sql-dont-fetch-a-particular-column/852934#852934)从 DBML 文件中删除该列的答案。确保您了解其中的含义，例如丢失对该列的并发检查。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T14:00:56.970

如果您非常懒惰，为什么不通过 DBML 设计器再次添加表，将其重命名为 MyTableWithOutColumnX，然后删除您不希望返回的记录？只需hilite列名并点击删除。

它很草率，但在某种程度上，有一个有时不应该出现记录的表格也是如此。更重要的是，这很容易，它全部在 DBML 中抽象，因此除了切换要访问的表之外，它不应该影响您的代码。名副其实，它甚至可能对在遥远的将来维护您的代码的人有意义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T14:54:05.007

感谢大家的意见。我决定的最终解决方案是简单地指定我想要带回的列，但是在我想要的类型的新对象中的 Linq 语句中执行此操作......一个示例应该会有所帮助！：

表日志有三列

*   日志ID
*   日期记录
*   序列化数据

但我只想要 DateLogged & Serialized 数据。但是，我希望*在*SQLMetal 生成的数据容器中使用这个

我通过以下语句实现了这一点：

* * *

Dim q = 从 dc.Log 中的 logItem 选择具有 {.LogID = logItem.LogID, .DateLogged = logItem.DateLogged} 的新日志

* * *

希望可以帮助其他人！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-06T09:25:38.013

查看[此链接](http://www.foliotek.com/devblog/automatic-update-of-datamodel-in-linq/)以获取有关如何使用 SQLMetal 启用延迟加载列的示例。

它基本上使用 XSLT 对生成的文件进行后处理，以将列类型从转换`X`为`Link<X>`（两种类型都来自`System.Data.Linq`命名空间）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T13:12:08.397

LINQ to SQL 知道要包含哪些列的方式是通过您在查询上投影的匿名类型。我认为没有其他方法可以让 LINQ to SQL 排除列，因为直接投影将返回所有内容。

# asp.net-mvc - 如何：在 ASP.Net MVC 中创建一个 Ajaxified HTMLHelper

> ID：852680
> 
> 赞同：2
> 
> 时间：2009-05-12T13:07:12.123
> 
> 标签：asp.net-mvc

我对 MVC 的研究越深入，我就越喜欢它，并想我是如何使用 Web 表单的 :)

但是如果我想封装一个控件，比如在 Web 表单中，有些东西真的很令人困惑，让我们说一个组合框，然后我会创建一个用户控件并将这个组合框添加到它并声明属性，然后我可以将它放在任何页面，如果我更改用户控件，则更改适用于站点中的所有实例，在 Web 表单中非常容易。

现在在 MVC 中，我了解到您可以通过扩展方法创建额外的帮助程序，这真的很酷，但我的目标是我希望它是 Ajaxified。

这就是我想要的：

*   我希望它模拟文本属性、选定值等 Web 表单...
*   我将使用 jquery 来实现很酷的效果，比如在鼠标悬停时突出显示一个项目，所以我想要一种方法来包含这个 HTML 助手的脚本，这样我就不必为我添加的每个组合框在视图或母版页上写它，在换句话说，例如 Telerik 控件或任何 Web 窗体服务器控件。

另一个问题是 HTML 助手是否在服务器上呈现？或者它们是纯 HTML 并且没有像服务器控件这样的服务器处理？

**注意**：我知道 MVC 已经有一个列表 HTML Helper，但我把它作为一个例子。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T03:36:57.770

HtmlHelper 扩展方法在服务器上的视图中执行。他们生成的结果 HTML 包含在发送到浏览器的页面中。

您无法按照您描述的方式使用 HtmlHelper 扩展方法创建传统的 ASP.NET WebForms 服务器控件，“模拟文本属性、选定值等 Web 表单......”如果您能够使用ASP.NET MVC，那么您可能首先应该将 ASP.NET WebForms 用于您的项目。

我真的建议拿起一份“ [Pro ASP.NET MVC 1.0](https://rads.stackoverflow.com/amzn/click/com/0470384611) ”。这本书由 Rob Conery、Scott Hanselman、Phil Haack 和 Scott Guthrie 撰写，对使用 ASP.NET MVC 构建应用程序/网站时“做什么以及为什么”进行了大量解释；以及对 ASP.NET WebForms 和 ASP.NET MVC 之间差异的直接比较。此外，本书的第一章是关于使用 ASP.NET MVC 构建功能齐全的应用程序的完整教程，而不是其他所有书籍都演示的传统“Hello World”示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T18:49:30.590

你看过 AjaxHelper 类和它的扩展吗？这似乎是您正在寻找的东西。您可以查看[AjaxExtensions.cs](http://aspnet.codeplex.com/SourceControl/changeset/view/23011#266442)文件的源代码，然后按照相同的模式创建您自己的 AjaxHelper 扩展。

是的，HtmlHelper（和 AjaxHelper）函数通过在服务器上执行的 C# 代码输出 Html 字符串。

# linq - 是否有与 DataContext 类等效的 LINQPad？

> ID：852687
> 
> 赞同：25
> 
> 时间：2009-05-12T13:08:38.907
> 
> 标签：linq, linq-to-sql, linqpad

我刚刚开始使用 LINQPad，到目前为止我很喜欢它，但是我遇到的大多数 LINQ TO SQL 教程都使用了由 Visual Studio 生成的 DataContext 类，用于持久更新等。我对 LINQ TO SQL 也很陌生所以我的问题是LINQPad中的以下内容是什么（如果有的话）......

```
MyDbDataContext db = new MyDbDataContext();

...

db.SubmitChanges(); 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-12T13:30:11.960

简短回答：您不需要自己创建 DataContext。[LINQPad](http://www.linqpad.net/)附带了很多示例，看看它们。

当您将 LINQPad 连接到数据库时，它会为您创建 DataContext。DataContext 的表 ( `Table<T>`)`SubmitChanges()`可作为本地成员使用。

例如，LINQPad 的默认“C# 表达式”模式你可以写：

```
from p in Person
where p.Name == "Joe"
select p.Address 
```

在 LINQPad 的“C# 语句”模式下：

```
var query = from p in Person
            where p.Name == "Joe"
            select p.Address;

query.Dump(); // Dump() shows results below

Person joe = query.First();
joe.Name = "Peter";
SubmitChanges();

joe.Dump(); // shows joe's values under the previous query results 
```

LINQPad 的`Dump()`扩展方法非常有用，可以在任何对象或集合上调用（在 LINQPad 的语句模式下）以显示下面的结果。

请注意，您甚至不需要连接到数据库即可使用 LINQPad。您可以使用内存中的集合：

```
int[] numbers = new[] { 1, 2, 3, 4, 5 };
numbers.Where(n => n > 3).Select(n => n * 2).Dump(); 
```

事实上，你甚至不需要使用 LINQ 就可以使用 LINQPad。它也可以作为片段编译器使用。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-05-04T10:35:13.280

如前所述，您不需要创建 DataContext，因为 LINQPad 默认会创建一个。
但以防万一，您需要第二个可以使用的**DataContext （用于同一数据库）**

```
var secondDataContext = new UserQuery(); 
```

这将创建第二个数据上下文，就像自动创建的一样。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-07-24T16:33:10.743

我知道这已经有了答案，我同意卢卡斯的观点，但想补充一些可能对这个问题的读者有所帮助的东西。

如果您愿意，可以从程序集中加载您自己的 DataContext。无论您是加载自己的 Context 还是让 LinqPad 为您构建一个，您都在 LinqPad 生成的“UserQuery”类的 Context 中运行。

以下 C# 语句显示了这一点：

```
 this.GetType().Name.Dump();  // Shows UserQuery 
```

此 UserQuery 类派生自 DataContext。在此示例中，我让 Linqpad 为 AdventureWorks 数据库构建数据上下文：

```
 this.GetType().BaseType.Dump();  // Shows TypedDataContext 
```

如果我加载我自己的名为 MyDataContext 的 DataContext：

```
 this.GetType().BaseType.Dump();  // Shows MyDataContext 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-03-05T13:53:28.207

根据 jaraics 的回复，我发现 UserQuery 构造函数需要一个连接字符串。至少它适用于 LINQPad 版本 4.37.11。因此，我从 LINQPad 创建的 UserQuery 实例中检索了连接字符串，并使用它来创建我自己的实例。

```
var connectionString = this.Connection.ConnectionString;
var secondDataContext = new UserQuery(connectionString); 
```

当我使用上面的代码时，它给了我第二个 DataContext。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-07-02T12:09:46.623

根据@Thymine 对@DRS9222 答案的评论，您可以简单地使用类似的东西：

```
void Main()
{
    TypedDataContext db = this;

    var qry = from i in db.Items
        select i;
    // etc. etc.
} 
```

然后，这在 LinqPad 和您的 IDE 之间变得非常可转移，而不必修复或删除上下文。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-03-02T08:40:25.393

每当我在主要部分之外添加静态方法时，我都可以使用以下示例进行访问：

```
using(var VT = new LINQPad.User.TypedDataContext())
  return (from g in VT.GM_MEMBERS  where g.Username == username select new { g.Password }).FirstOrDefault()?.Password; 
```

# python - 支持反向代理的纯python网络服务器？

> ID：852690
> 
> 赞同：3
> 
> 时间：2009-05-12T13:09:52.710
> 
> 标签：python, proxy, webserver, reverse

我正在寻找一个纯 python 的 web 服务器也有反向代理的能力？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T13:21:18.563

看看[Twisted](http://twistedmatrix.com/)，尤其是它的[ReverseProxyResource](http://twistedmatrix.com/documents/current/api/twisted.web.proxy.ReverseProxyResource.html)。

> Twisted Web 还提供了用于在反向代理后面设置的各种工具，这是将 Twisted 应用程序与现有站点集成的建议机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T13:39:41.130

[http://pypi.python.org/pypi/proxylet/](http://pypi.python.org/pypi/proxylet/)

来自[http://www.rfk.id.au/blog/entry/proxylet-lightweight-HTTP-reverse-proxy](http://www.rfk.id.au/blog/entry/proxylet-lightweight-HTTP-reverse-proxy)

> proxylet 是一个轻量级的 HTTP 反向代理，由 eventlet 提供非阻塞 IO。

看起来源也可用。我从未使用过它，因为我们使用[IHS](http://www-01.ibm.com/software/webservers/httpservers/)来满足我们所有的反向代理需求。

# java - 使用 Java 对 I5/As400 程序进行现代化改造

> ID：852691
> 
> 赞同：3
> 
> 时间：2009-05-12T13:09:59.417
> 
> 标签：java, ibm-midrange

我的任务是对我公司基于 I5 的销售点系统进行现代化改造。主要推动力是在不丢失业务逻辑的情况下创建更友好的界面/更好的数据视图。

是否有一种与交互式（非命令行）I5 程序交互的良好 Java 方式？PHP 为他们的 5250 Bridge 提供的东西是什么？我正在考虑使用他的 5250 网桥，但我更喜欢基于 Java 的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T12:57:13.943

假设应用程序的交互部分是可分离的……为什么不使用 Toolbox for Java 直接调用底层程序并创建远程 GUI？您可以从 Java 远程调用 API、PGM 和 CL 命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-08T14:54:11.330

[IBM Developer Kit for Java](http://publib.boulder.ibm.com/infocenter/iseries/v5r3/index.jsp?topic=/rzaha/calrpgex.htm)允许您在 iSeries 上运行 Java 代码。

您可以使用 JNI 接口直接从 RPG/COBOL 程序调用 Java 代码。 [这是一篇描述如何从 RPG 程序调用 Java 的文章。](http://www.itjungle.com/mpo/mpo013102-story02.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-10T11:11:37.627

您正在 IBM Java Toolbox 中寻找 ProgramCall 类。这将允许您调用任何给定的程序，但您需要一些麻烦来获得正确的参数等。让 I5 编译器创建 PCML 文件是一个好处，这些文件可用于自动创建 ProgramCall 参数。我们有 1 毫秒的时间来处理来自 PC 的此类呼叫。

注意：QTEMP 不可用，除非你做严肃的巫术。

# html - 什么是最好的跨浏览器 html 所见即所得编辑器？

> ID：852696
> 
> 赞同：0
> 
> 时间：2009-05-12T13:11:36.917
> 
> 标签：html, css, xhtml, wysiwyg

我正在寻找跨浏览所见即所得 css/html 网络编辑器（请免费软件），它是桌面，你能推荐我应该使用哪个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T13:22:13.973

[Kompozer](http://kompozer.net/)可能是免费的桌面 HTML 编辑器的“王者”。我不能承认自己曾尝试过，但我对 Nvu（它基于它）的努力并没有那么成功（当它用 <br> 元素替换我里面的每一行新行时，编辑起来很糟糕在源代码模式下，我已经厌烦到卸载它）。

我在[Amaya](http://www.w3.org/Amaya/)上取得了更大的成功，但它是一个测试平台，它显示了。

除了基本结构（即让它处理标题、表格、段落、链接等）之外，我不会使用所谓的 WYSIWYG 编辑器。我从来没有找到一个点击系统来尝试执行我远程满意的布局（包括 Dreamweaver（它不是免费的））。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T13:23:30.633

几年前，我发现[Nvu](http://www.net2.com/nvu/)是最好的。他们停止更新了一段时间，但看起来他们可能会回来。

# ruby - 使用 Ruby 中的属性对对象列表进行排序

> ID：852705
> 
> 赞同：5
> 
> 时间：2009-05-12T13:14:22.887
> 
> 标签：ruby, sorting, idioms

我有一个`Fruit`名为 的结构列表`basket`。每个`Fruit`结构都有一个`name`（字符串）和一个`calories`（整数）。我想这样排序`basket`：

1.  `Fruit`最高的s`calories`最先出现。例如，500 卡路里的水果出现在 400 卡路里的水果之前。

2.  如果两个`Fruit`s 相等`calories`，则按字母顺序先出现`Fruit`的`name`先出现，忽略大小写。例如，给定两种热量相同的水果，一种名为“香​​蕉”的水果将排在一种名为“柑橘”的水果之前。

的定义`Fruit`不是我可以控制的，所以我更喜欢不涉及将任何东西混入`Fruit`或更改它的解决方案。这可能吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-12T13:18:40.223

简单的解决方案是

```
basket.sort_by { |f| [-f.calories, f.name] } 
```

当然，如果这是水果*的*规范排序顺序，那么它*应该*使用`<=>`方法定义，并将`Comparable`模块混合到`Fruit`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T13:19:57.740

假设您的购物篮是一个数组或其子类。

## 快捷方式

[Enumerable.sort_by](http://www.ruby-doc.org/core/classes/Enumerable.html#M003151)

正如[Gareth](https://stackoverflow.com/users/31582/gareth)指出的，Enumerable（包含在 Array 中）有一个 sort_by 方法，该方法遍历每个列表项一次。一旦你掌握了它的窍门，这将更快地运行和更快地编写。

```
# -f.calories to sort descending
# name.downcase to do a case-insensitive sort
basket = basket.sort_by { |f| [-f.calories, f.name.downcase] } 
```

## Perl 方式

[数组排序](http://www.ruby-doc.org/core/classes/Array.html#M002208)

来自 Perl 背景，我的第一个冲动是抓住宇宙飞船运算符 <=>。调皮的小恶魔。数组有排序和排序！使其非常有用的方法。此解决方案速度较慢，并且因为它更长，所以更可能引入错误。使用它的唯一原因是，如果您正在与不熟悉 Ruby 并且不愿意在 StackOverflow 上找到**正确方法的人打交道。**

```
baseket.sort! { |a,b|
  if a.calories == b.calories
    a.name.downcase <=> b.name.downcase
  else
    # Reverse the result to sort highest first.
    -(a.calories <=> b.calories)
  end
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T13:18:12.907

请参阅`Array#sort`（[API 文档](http://www.ruby-doc.org/core/classes/Array.html#M002208)）。您可以传入一个返回 -1、0 或 1 给定两个`Fruit`对象的块，并且您的块可以使用您喜欢的任何属性来确定这些值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T19:57:24.910

如果您需要对 Fruits 进行大量分类，您可能应该在前面多做一些工作并使您的对象具有可比性。

为此，您需要实现 Spaceship-Operator ( `<=>`) 并包含 Comparable。

```
class Fruit
  attr_accessor :name, :color

  def <=>(other)
    # use Array#<=> to compare the attributes
    [self.name.downcase, self.color] <=> [other.name.downcase, other.color]
  end

  include Comparable
end 
```

那么你可以简单地做：

```
list_of_fruits.sort 
```

Comparable 还免费为您提供了许多其他方法（`==`, `<`, `>`），因此您可以执行以下操作 `if (apple < banana)`（有关更多信息，请参阅[Comparable 模块的文档）](http://www.ruby-doc.org/core/classes/Comparable.html)

<=>, 指定返回`-1`if`self`小于`other`, `+1`if`other`小于 并且`0`两个对象相等。

# asp.net - 登录控制问题

> ID：852712
> 
> 赞同：0
> 
> 时间：2009-05-12T13:15:06.767
> 
> 标签：asp.net

我在登录控制方面遇到问题。我有三个页面，分别称为登录、秘密和注册。我通过使用登录控制保护了我的秘密页面，如果我请求我的秘密页面，它会将我重定向到对我来说很好的登录页面。但问题是，如果我从这里点击注册链接，它不会直接到注册页面，直到我填写任何正确的 enrty。如果我填写正确的登录名/密码，它会将我引导到秘密页面。现在，如果我回到登录页面，现在单击注册链接，它会将我引导到注册页面。现在很好。

我使用了登录控件的 createtext 和 createtexturl 属性。请在这方面帮助我...

我在 web 配置文件中有以下代码。

```
<roleManager enabled="true"/>
  <authentication mode="Forms"/>
    <authorization>
      <deny users="?"/>
    </authorization> 
```

并在源文件中跟随......

```
<asp:Login ID="Login1" runat="server" 
  DestinationPageUrl="~/Secret.aspx" 
  CreateUserText="New User Register" 
  CreateUserUrl="~/register.aspx" 
  FailureText="You are not registered.....try agian.." /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T13:49:54.807

听起来您不仅“保护”了您的秘密页面，还“保护”了注册页面。

您在问题中输入的代码不可见（您应该选择代码并单击带有 0 和 1 的按钮），但请尝试将类似的内容添加到 web.config 的配置部分。

```
<location path="register.aspx">
    <system.web>
        <authorization>
            <allow users="*" />
        </authorization>
    </system.web>
</location> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:00:32.310

嗯，现在我们可以看到代码，我们有更好的机会帮助你；）

您没有说太多，但我假设您在同一个文件夹中拥有所有三个文件 - 登录、注册和保密？

如果是这样，你在说什么：

```
<authorization>
  <deny users="?"/>
</authorization> 
```

是“拒绝所有匿名用户访问这些页面” - 这是覆盖 Janzi 建议的位置“允许所有用户”选项。

尝试以下一些方法：

```
//Folder structure
web.config - Root Web.config
Login.aspx - login page
Register.aspx - registration page
/Secret - Folder called "Secret"
/web.config - web.config in "Secret"
/Secret.aspx - secret pages 
```

/Secret 文件夹中的 web.config 应该只包含：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <system.web>
        <authorization>
            <deny users="?" />
        </authorization>
    </system.web>
</configuration> 
```

虽然您的根 web.config 定义了您的成员资格提供程序，定义了表单身份验证的设置等。

或者，您可以删除 /Secret 中的 web.config 并在根 web.config 中使用 location 元素：

```
<location path="Secret">
  <system.web>
    <authorization>
      <deny users="?" />
    </authorization>
  </system.web>
</location> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T11:36:26.173

阿米特，

要检查问题是否与您的授权设置有关，您可能想暂时尝试以下操作：

```
<authorization>
<allow users="*" />
</authorization> 
```

如果在此检查正确后一切正常`<location path="register.aspx">`- 您是否将它放在子文件夹中？

# c# - 使用 Fluent NHibernate 执行 Sql 语句

> ID：852720
> 
> 赞同：20
> 
> 时间：2009-05-12T13:16:23.613
> 
> 标签：c#, .net, vb.net, nhibernate

基本上我希望能够做到这一点：

`session.ExecuteSql("...");`

我不需要它映射到任何实体或返回任何值。有什么建议么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-12T23:09:51.633

如前所述，这不是 Fluent NHibernate 问题，但这里有一个示例：

```
public int GetSqlCount<T>(Session session, string table)
{
    var sql = String.Format("SELECT Count(*) FROM {0}", table);
    var query = session.CreateSQLQuery(sql);
    var result = query.UniqueResult();
    // Could also use this if only updating values:
    //query.ExecuteUpdate();

    return Convert.ToInt32(result);
} 
```

您将需要研究 ISQLQuery 接口，具体取决于您的需要。

# pseudocode - 编写伪代码 - 最佳实践？

> ID：852724
> 
> 赞同：5
> 
> 时间：2009-05-12T13:17:01.367
> 
> 标签：pseudocode

我不想在这里引起关于伪代码是否有用的争论，..有很多与此相关的问题。我确实发现编写伪代码有时很有用，但一直出现的一件事是我如何最好地表达它？

有时我最终会采用编号方法，有时我会使用 C 风格的语法，但大多数时候它是我认为当时最好的方法的混合。没关系，但是在 6 个月后，当我再次查看它时，并不总是那么清楚其意图是什么！为了解决这个问题，我最近开始将页面分成两部分，在右半部分我会写 pidgin [在此处插入语言]，在左边我会用非常明显和冗长的英语写。

我认为编写伪代码没有任何“标准”，但我很想看看其他人是如何做到的，也许这会帮助我决定一个统一的方法。

提前致谢。

哦，我知道这个问题是主观的，如果这不是 SO 的预期目的，我很抱歉，但这仍然是一个有效的问题。事实上，计算中真的有那么多只有一个正确答案的问题吗？我会将最有帮助的答案标记为正确。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T13:58:51.310

我倾向于发现自己在记事本中使用缩进编写小用例……在大约六行之后，我突然意识到我正在以一种基本上是 Python 的风格编写，但语法少了一点！所以我得出的结论是，Python 实际上是伪代码，是一种用您*真正*尝试编写的任何语言对您的想法进行原型制作的绝妙方法。这项技术的最佳之处在于您已经有了可以比较的参考在出现讨厌的错误的情况下，您完成的结果。

有时候，[UML 序列图](http://www.google.co.uk/search?q=uml+sequence+diagram&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-GB:official&client=firefox-a)比作为一种心理练习来绘制出需要发生什么以及何时发生的写作要快，但这两种技术是我一次又一次地回归的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T13:25:37.850

我喜欢 Steve McConnell 在他的书 Code Complete 中关于编写伪代码的章节。我知道，如果您不拥有它，这个答案可能并不令人满意，但如果您不拥有，这本书本身就是必须拥有的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T14:04:37.430

I've never used pseudocode and never felt the need of doing it, I believe that your code can be clean enough if you dedicate some time refactoring it, no matter what language are you using.

I thought I was too lazy, or just against it for some reason but then I found [others think the same](http://www.codinghorror.com/blog/archives/001264.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T13:25:36.697

我从用英语写作或混合编程语言表达开始。然后我一步一步地用编程语言表达式替换英语，有时将英语单词作为注释，然后 - 瞧 - 我有一个测试功能 - 所以它就像伪代码 + TDD 合二为一。不过我不得不提一下，我并不总是使用这种方法，只是当我必须解决一项艰巨的任务或设计一个新的而不是微不足道的类时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T13:33:05.777

我通常会完全避免使用任何类型的代码语言，并就我希望在程序中的任何给定点发生的事情写评论。一旦评论全部完成，就是填空的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T13:41:35.213

我也发现伪代码很有用。你的两页方法听起来不错。你也可以看看[Literate](http://www.literateprogramming.com/) [Programming](http://en.wikipedia.org/wiki/Literate_programming)；我在编程时经常使用 LP 风格来表达我的想法，尽管我通常不使用 LP 工具。

# sql - 如何管理sql结构更新

> ID：852725
> 
> 赞同：1
> 
> 时间：2009-05-12T13:17:08.527
> 
> 标签：sql, mysql

人们如何推荐管理数据库结构更新？

例如，添加了需要更改现有表、添加新表等的新功能。

是否有一个好的软件或者它是一个编写`ALTER`类型语句的案例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T13:23:52.130

虽然有软件可以分析两种模式之间的差异（RedGate SQL 比较）并生成必要的更改脚本，但我更喜欢编写自己的数据库更改语句。这样，我就可以完全控制正在改变的内容——不多也不少。对于每个数据库版本，将更改滚动到 Install.sql 脚本或类似脚本中，这样您就可以运行该脚本并更新数据库。

这使得将更改从开发转移到测试再到生产变得容易。

请参阅：[将 SQL Server 数据库从测试部署到实时](https://stackoverflow.com/questions/580/deploying-sql-server-databases-from-test-to-live)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T13:28:05.973

如果您不想手写所有的更改语句，SQL Server Management Studio 有一个 GUI 来处理所有此类内容。如果您想要某种快速的混合方法，您可以使用 GUI，然后查看它生成的脚本并从那里开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T17:23:07.317

我要补充一件事。仅仅写一个 alter table 语句来改变一个表结构是不够的。如果您要更改表结构，最好在运行它之前确定您确切知道应用程序中的其他视图、函数、表、存储过程、触发器、SSIS(DTS) 包（用于 SQL Server）和动态代码会受到变化的影响。如果您不能完全确定哪些其他对象可能会受到影响，那么您还没有准备好更改该表。我见过太多的关键业务功能中断，因为有人随意更改了表结构，而没有考虑其他什么使用该结构。如果您正在考虑进行数据库结构更改，我建议您在这样做之前阅读数据库重构。

这是一本好书： [http ://www.amazon.com/Refactoring-Databases-Evolutionary-Addison-Wesley-Signature/dp/0321293533](https://rads.stackoverflow.com/amzn/click/com/0321293533)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T13:49:13.343

您没有提及您的应用程序的范围或开发人员的数量等，因此很难提出任何建议。但是，如果您的开发由多个并发项目和多个开发人员组成，并且您正在从开发复制到生产，我会推荐如下内容：

*   实施 3 个“领域”：开发、质量保证、生产。
*   在 dev 中开发所有更改，在脚本中创建所有更改，使用 cvs 之类的东西来跟踪所有对象的更改
*   当更改准备就绪并经过测试时，在 qa 中运行您的脚本，这将验证您的脚本并安装程序
*   准备好运行您的脚本并在生产环境中安装程序

注意： qa 几乎与生产相同，除了应用更改等待其最终生产安装。dev 包含任何正在进行的更改、额外的调试垃圾等。您可以定期将生产备份恢复到 qa 和 dev 以重新同步它们（只要确保所有开发人员都知道这一点并相应地计划），因为（取决于数量开发人员）他们（生产与质量保证与开发）将随着时间的推移开始产生更多差异。

# sharepoint - Sharepoint 博客：将 WebPart 转换为 XSLT 时，类别和帖子之间的连接丢失

> ID：852731
> 
> 赞同：1
> 
> 时间：2009-05-12T13:18:09.570
> 
> 标签：sharepoint, blogs, categories

我从制作**XSLT的****Sharepoint 博客模板**中修改了默认页面**category.aspx**的结构。当我保存页面并在浏览器中执行它时，**我失去了 category 和 posts 之间的连接**，并且总是显示该类别中没有消息。*您知道如何恢复或如何重建 XSLT 结构中的连接吗？*

 *******非常感谢！！！

泽维尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T15:15:05.543

我找到了解决方案！

**CAML 查询的 WHERE 子句**过滤类别，**它在 XSLT 的过滤器中转换为空值**。
您已经从 Querystring 创建了一个新参数：
- 在*DataView 常见任务*
中单击 - 选择第一个链接：*过滤器：类别等于 ''*（这里是空白！！！）
- 选择过滤器并在值列中创建一个新参数：为参数写一个名称并在查询字符串中选择查询字符串和参数名称。

泽维尔

# java - 此 Java 代码中的短路逻辑有什么问题？

> ID：852734
> 
> 赞同：8
> 
> 时间：2009-05-12T13:18:29.227
> 
> 标签：java, logical-operators

为什么 func3 在下面的程序中没有被执行？在func1之后，func2不需要被评估但是对于func3，不是吗？

```
if (func1() || func2() && func3()) {
        System.out.println("true");
    } else {
        System.out.println("false");
    }
}

public static boolean func1() {
    System.out.println("func1");
    return true;
}

public static boolean func2() {
    System.out.println("func2");
    return false;
}

public static boolean func3() {
    System.out.println("func3");
    return false;
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-12T13:21:06.053

您正在使用短路或。如果第一个参数为真，则整个表达式为真。

如果我添加编译器使用的隐式括号可能会有所帮助

**编辑**：正如 Chris Jester-Young 所指出的，这实际上是因为逻辑运算符必须具有从左到右的关联性：

```
if (func1() || (func2() && func3())) 
```

func1返回后变成这样：

```
if (true || (func2() && func3())) 
```

在评估短路或之后，它变为：

```
if (true) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-12T13:28:40.530

Java 函数根据[优先级规则进行评估](http://mindprod.com/jgloss/precedence.html)

因为“&&”的优先级高于“||”，所以首先评估它，因为您没有任何括号来设置显式优先级

所以你的表情

```
(A || B && C) 
```

这是

```
(T || F && F) 
```

括号内为

```
(T || (F && F)) 
```

因为优先规则。

由于编译器知道如果 'A == true' 它不需要计算表达式的其余部分，它会在计算 A 后停止。

如果你用括号括起来`((A || B) && C)`，那么它将评估为假。

**编辑**

另一种方法，正如其他海报所提到的，是使用“|” 和“&”而不是“||” 和“&&”，因为这会阻止表达式的快捷方式。但是，由于优先规则，最终结果仍然是相同的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T13:20:48.173

Java 使布尔表达式短路。这意味着，一旦`func1()`执行并返回`true`，布尔值的其余部分就无关紧要，因为您使用的是`or`运算符。无论`func2() && func3()`计算结果如何，整个表达式都将计算为`true`。因此，Java 甚至不费心评估`func2()`or `func3()`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T13:21:23.633

[http://en.wikipedia.org/wiki/Short-circuit_evaluation](http://en.wikipedia.org/wiki/Short-circuit_evaluation)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T13:23:30.117

Java 使用惰性求值。

由于 Func1 总是返回 true，整个表达式必须为 true，所以它会简化表达式的其余部分。

```
true || (???) 
```

和

```
false && (???) 
```

总会走捷径。

要关闭快捷方式评估，请使用 | 和 & 而不是 || 和 ＆＆

我们可以使用它来达到很好的效果：

```
String s;
if (s != null && !s.equals("")) ... 
```

这意味着如果 s 为 null，我们甚至不必尝试调用 s.equals，也不会最终抛出 NullPointerException

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-12T13:25:00.583

您正在使用快捷操作符 || 和 ＆＆。如果结果已经定义，这些运算符不会执行表达式的其余部分。对于 || 这意味着如果第一个表达式为真，对于 && 如果第一个表达式为假。

如果要执行表达式的所有部分，请使用 | 而 & 相反，这不是捷径。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T13:21:15.210

简短回答：[短路评估](http://en.wikipedia.org/wiki/Short-circuit_evaluation)

由于 func1() 为真，因此无需继续评估，因为它始终为真

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-12T13:22:34.910

如果函数 1 总是返回 true，那么 Java 不需要评估表达式的其余部分来确定整个表达式是否为 true。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-12T18:37:44.480

如果要执行所有功能，可以删除快捷方式

```
if (func1() | func2() & func3()) { 
```

# java - 任何带有 TaskExecutor 示例的好的 Spring 线程？

> ID：852743
> 
> 赞同：27
> 
> 时间：2009-05-12T13:20:05.587
> 
> 标签：java, multithreading, spring, executor

我试图了解如何在使用 Spring 进行事务管理的 Java 应用程序中实现线程。我在[Spring 文档](http://static.springframework.org/spring/docs/2.5.x/reference/scheduling.html#scheduling-task-executor)中找到了 TaskExecutor 部分，而 ThreadPoolTask​​Executor 看起来很适合我的需要；

> 线程池任务执行器
> 
> 此实现只能在 Java 5 环境中使用，但也是该环境中最常用的实现。它公开了用于配置 java.util.concurrent.ThreadPoolExecutor 的 bean 属性并将其包装在 TaskExecutor 中。如果您需要高级的东西，例如 ScheduledThreadPoolExecutor，建议您改用 ConcurrentTaskExecutor。

但是我不知道如何使用它。我一直在寻找很好的例子，但没有运气。如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-12T14:13:25.680

这很简单。这个想法是你有一个 executor 对象，它是一个 bean，它被传递给任何想要触发新任务的对象（在一个新线程中）。好处是您可以通过更改 Spring 配置来修改要使用的任务执行器类型。在下面的示例中，我使用了一些示例类（ClassWithMethodToFire）并将其包装在 Runnable 对象中以进行触发；您也可以在自己的类中实际实现 Runnable，然后在您只需调用的执行方法中实现`classWithMethodToFire.run()`.

这是一个非常简单的例子。

```
public class SomethingThatShouldHappenInAThread {
     private TaskExecutor taskExecutor;
     private ClassWithMethodToFire classWithMethodToFire;

     public SomethingThatShouldHappenInAThread(TaskExecutor taskExecutor,
                                               ClassWithMethodToFire classWithMethodToFire) {
          this.taskExecutor = taskExecutor;
          this.classWithMethodToFire = classWithMethodToFire;
     }

     public void fire(final SomeParameterClass parameter) {
          taskExecutor.execute( new Runnable() {
               public void run() {
                    classWithMethodToFire.doSomething( parameter );
               }
          });
     }
} 
```

这是 Spring bean：

```
<bean name="somethingThatShouldHappenInAThread" class="package.name.SomethingThatShouldHappenInAThread">
     <constructor-arg type="org.springframework.core.task.TaskExecutor" ref="taskExecutor" />
     <constructor-arg type="package.name.ClassWithMethodToFire" ref="classWithMethodToFireBean"/>
</bean>

<bean id="taskExecutor" class="org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor">
     <property name="corePoolSize" value="5" />
     <property name="maxPoolSize" value="10" />
     <property name="queueCapacity" value="25" />
</bean> 
```

# c# - C# 是否将值传递给 Lambda？

> ID：852747
> 
> 赞同：5
> 
> 时间：2009-05-12T13:21:07.533
> 
> 标签：c#, .net, delegates, lambda

我有一些代码，

```
int count = 0;

list.ForEach(i => i.SomeFunction(count++)); 
```

这似乎不会增加计数。这里的计数是按值传递的吗？如果我在 lambda 中使用 {} 有什么区别吗？

```
int count = 0;

list.ForEach(i => 
            {
                    i.SomeFunction(count++);
            }); 
```

**更新 1**

对不起，我的错误，它确实更新了原始计数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T13:23:24.597

`count`是一个 int，而 ints 是值类型，这意味着它们确实是按值传递的。您的第一个和第二个示例之间没有语义差异。

（也就是说，在我看来它应该是递增`count`的，因为它应该捕获原始引用直到闭包。澄清一下——尽管计数将按值传递给 SomeFunction，但事情并没有“通过” " 当您在表达式中使用它们时，将它们添加到您的 lambda 表达式中——它们与外部变量具有相同的引用。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-12T13:27:56.693

在这两种情况下，您都在创建所谓的闭包。本质上，count 被包装在一个类中，并且该类被 lambda 表达式使用。

Bill Wagner 有一本名为《[More Effective C#](https://rads.stackoverflow.com/amzn/click/com/0321485890) 》的好书，他有一篇博文更详细地描述了[闭包。](http://srtsolutions.com/blogs/billwagner/archive/2008/01/22/looking-inside-c-closures.aspx)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-12T13:33:44.620

*变量*count 在您的情况下由 lambda 表达式捕获。`count`调用者可以看到任何更改。因此，例如：

```
int count = 0;
list.ForEach(i => i.SomeFunction(count++));
Console.WriteLine(count); 
```

将显示列表的大小，因为每次迭代都会增加`count`.

但是，调用`SomeFunction`将 的评估值`count++`（这是`count`增量之前的值）*按值*传递给`SomeFunction`。换句话说，`SomeFunction`不能改变 的值`count`。

有关闭包和变量捕获的更多信息，请参阅我的[闭包文章](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-12T13:31:40.210

那应该增加，证明：

```
class Foo
{
    public void SomeFunction(int i) { }
}
static void Main()
{
    int count = 0;
    List<Foo> list = new List<Foo> {new Foo()};
    list.ForEach(i => i.SomeFunction(count++));
    Console.WriteLine(count); // 1
} 
```

lambda 行为（如前所述）“捕获”计数，基本上使代码如下：

```
class Foo
{
    public void SomeFunction(int i) { }
}
class CaptureScope
{
    public int count;
    public void AnonMethod(Foo foo)
    {
        foo.SomeFunction(count++);
    }
}
static void Main()
{
    CaptureScope scope = new CaptureScope();
    scope.count = 0;
    List<Foo> list = new List<Foo> {new Foo()};
    list.ForEach(scope.AnonMethod);
    Console.WriteLine(scope.count); // 1
} 
```

以上是编译器如何解释委托 lambda 的粗略近似。如您所见，`count`是类上的一个字段，并且*是*递增的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-12T13:45:31.540

我想在这里添加一个小的更正。变量 count 既不是通过值传递，也不是通过对 lambda 表达式的引用传递，因为它不是参数。相反，该值由闭包中的 lambda**捕获**。

您应该查看 Raymond 关于该主题的系列 - [http://blogs.msdn.com/oldnewthing/archive/2006/08/02/686456.aspx](http://blogs.msdn.com/oldnewthing/archive/2006/08/02/686456.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T13:23:48.120

这应该捕获（关闭）计数作为一个[闭包](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T13:23:14.563

不，没有区别。参数通常是按值的，除非您在用于 lambda 的委托定义中明确将其设为“ref”或“out”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T13:27:37.037

Lambda 是匿名函数，因此遵循与将参数传递给函数相同的规则。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-12T13:33:32.187

在这种情况下，`count`变量被**捕获**。即使它是一个`struct`被捕获的变量，它的行为就像它的一个*引用*。因此，您肯定会`count`在`foreach`.

# c++ - 如何知道 Qt 中何时连接了新的 USB 存储设备？

> ID：852752
> 
> 赞同：8
> 
> 时间：2009-05-12T13:21:43.337
> 
> 标签：c++, windows, qt, usb

我想知道 USB 设备何时连接到运行我的 Qt 应用程序的计算机（在 Windows 中）。在我的主要 QWidget 中，我重新实现`winEventFilter`了这样的：

```
bool winEventFilter ( MSG * msg, long * result ) {
    qDebug() << msg;
    return false;
} 
```

当我连接 USB 设备时，我希望 qDebug 至少发送一些东西，但我什么也没得到。

我猜我从根本上误解了这里的过程——这是我的第一个 Qt 应用程序！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T15:39:03.243

我相信您可能缺少的是注册设备通知的电话。这是我用来做同样事情的代码，尽管我重写了 QWidget 类的 winEvent() 方法而不是 winEventFilter。

```
// Register for device connect notification
DEV_BROADCAST_DEVICEINTERFACE devInt;
ZeroMemory( &devInt, sizeof(devInt) );
devInt.dbcc_size = sizeof(DEV_BROADCAST_DEVICEINTERFACE);
devInt.dbcc_devicetype = DBT_DEVTYP_DEVICEINTERFACE;
devInt.dbcc_classguid = GUID_DEVINTERFACE_VOLUME;

m_hDeviceNotify =
    RegisterDeviceNotification( winId(), &devInt, DEVICE_NOTIFY_WINDOW_HANDLE );   
if(m_hDeviceNotify == NULL)
{
    qDebug() << "Failed to register device notification";
} // end if 
```

注意：您很可能需要更改 的值`DEV_BROADCAST_DEVICEINTERFACE`以满足您的需要。

编辑：要使用此代码，您需要包含正确的头文件并执行正确的设置。 `DEV_BROADCAST_DEVICEINTERFACE`需要包含 Dbt.h 标头。此外，此代码的重点是 RegisterDeviceNotification 函数。信息可在[MSDN上找到](http://msdn.microsoft.com/en-us/library/aa363431.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T20:47:56.857

我正在按照相同的路线工作，但在 C# 中。

您需要向系统注册您的应用程序（查看 RegisterHidNotification() 函数）。我的看起来像这样：`

```
void RegisterHidNotification() //Register this application to recieve all USB device notices

        {
            BroadcastHeader dbi = new BroadcastHeader();
            int size = Marshal.SizeOf(dbi);
            dbi.Size = size;
            dbi.Type = DeviceType.DeviceInterface;
            **dbi.Classguid = GUID_DEVINTERFACE_USB_DEVICE**;
            dbi.Name = 0;
            IntPtr buffer = Marshal.AllocHGlobal(size);
            Marshal.StructureToPtr(dbi, buffer, true);
            IntPtr r = RegisterDeviceNotification(this.Handle, buffer, (int)DeviceEvents.regWindowHandle);
            if (r == IntPtr.Zero)
                statusLabel.Text = GetLastError().ToString();
        }` 
```

该功能最重要的部分是我以粗体突出显示的位（或至少尝试过）。定义为：`public Guid GUID_DEVINTERFACE_USB_DEVICE = new Guid("A5DCBF10-6530-11D2-901F-00C04FB951ED");` 希望你能适应你的应用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-17T08:55:12.943

您可以轻松地重新实现[`QWidget::nativeEvent(const QByteArray &eventType, void *message, long *result)`](https://doc.qt.io/qt-5/qwidget.html#nativeEvent)和检查设备连接：

```
 #ifdef Q_OS_WIN
    #include <Dbt.h>
    #endif

    bool MainWindow::nativeEvent(const QByteArray &eventType, void *message, long *result) {
#ifdef Q_OS_WIN
        MSG* msg = reinterpret_cast<MSG*>(message);
        if (msg->message == WM_DEVICECHANGE) {
            switch (msg->wParam) {
            case DBT_DEVICEARRIVAL:
                qDebug() << "connected";
                break;
            case DBT_DEVICEREMOVECOMPLETE:
                qDebug() << "disconnected";
                break;
            default:
                break;
            }
        }
#endif // Q_OS_WIN
        return false;
    } 
```

*   参考：[使用 Qt 开发多平台 USB 应用程序](https://wiki.kucia.net/doku.php?id=projects:qtusb)

# sql-server - SQL Server：“包含”与“字符索引”

> ID：852754
> 
> 赞同：4
> 
> 时间：2009-05-12T13:22:09.217
> 
> 标签：sql-server, full-text-search

我在 ms sql server 中的查询有问题。我在名为“col1”的列上有一个全文索引。此列中的数据可能会变得非常大（20、30 kb +）。我现在想在此列中搜索确切的短语。

有人告诉我“包含”功能是最快的功能，但我知道至少有两种其他方法可以做到这一点；使用“like”函数，并使用“charindex”。

问题是当我搜索包含 # 符号的短语时，“包含”不起作用。例如，"... WHERE contains(col1, '"query string#"') ..." 将始终返回 0 个结果。

我已经切换到使用 charindex，并且确实返回了结果，但是使用此函数查询数据库需要更长的时间。

有什么方法可以加快查询速度或让 contains 函数接受我的 # 符号？

谢谢你的时间...

**更新** 我决定在使用 charindex 和 contains 函数之间切换。所以如果查询数据中包含#号，我们切换到使用charindex；对于所有其他查询，我使用包含。似乎工作得最好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T13:31:02.787

我们有一个类似的问题，没有自己的 FTS 实现。这是因为微软从他们的索引例程中去掉了很多特殊字符和常用词。

在我们的情况下，我们可以控制输入，并通过一个翻译特殊字符（如哈希符号）的函数传递所有文本。所以输入到数据库中的哈希符号可能看起来像这样“zxzHASHyxy”。

然后，我们可以在执行搜索时将我们的翻译版本替换为“真实”版本。

然而，这个实现有一个很大的缺点。如果您需要保留未翻译文本的副本，则必须在单独的列中执行此操作，这将导致数据库大量膨胀。

谨慎使用此解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T13:35:00.297

像“#”这样的特殊字符是分词器，不会包含在索引中。对于全文索引，“查询字符串#xyz”看起来像“查询字符串 xyz”。

您可以尝试使用[FREETEXT](http://msdn.microsoft.com/en-us/library/ms176078.aspx)功能：

> 使用 FREETEXT 的全文查询不如使用 CONTAINS 的全文查询精确。SQL Server 全文搜索引擎识别重要的单词和短语。当在 CONTAINS 谓词的参数中指定时，通常对任何保留关键字或通配符都没有特殊含义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T13:47:47.293

您是否使用 LIKE 运算符/谓词而不是 CHARINDEX() 函数执行了任何测试？我期望 LIKE 会比 CHARINDEX() 更快，但我没有任何证据或文件来支持这一点。

此外：

*   # 符号本身在查询中真的很重要吗？
*   如果是，您是否可以使用两阶段事务，其中使用 SQL 的 CONTAINS() 检索包含查询字符串（带或不带 #）的所有记录的列表，然后进行应用程序端测试以删除条目没有#？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-12-29T09:21:39.203

```
ALTER FULLTEXT INDEX ON  [dbo].[Tablename]  SET STOPLIST = OFF 
```

这有助于在包含中使用特殊字符。

例子：

```
 select * from  [dbo].[Tablename] where contains(Column_Name,'C# or C++') 
```

# javascript - 用于在 javascript 中加载文本文件的 Internet Explorer 等效项

> ID：852763
> 
> 赞同：2
> 
> 时间：2009-05-12T13:23:18.620
> 
> 标签：javascript, internet-explorer, dynamic

我希望在 HTML 页面中从 javascript 加载一些额外的数据。下面的解决方案很小，完全符合我在非 Microsoft 浏览器中需要做的事情。

问题是，微软资源管理器的等价物是什么？请注意，我正在加载的数据不是 XML。我也不希望添加 javascript 库 - 我希望此页面即使在拨号时也能快速加载。

* * *

```
var client = new XMLHttpRequest();
client.open('GET', 'gamedata.txt');
client.onreadystatechange = function() {
    if (client.readyState == 4) {
        alert(client.responseText); // Make sure its loaded
    }
}

client.send(""); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T13:26:06.243

由于在各种版本的 IE 中对 XMLHttpRequest() 的混合支持，您必须跳过许多环节才能使请求工作。（特别是，IE5 和 IE6 对 XMLHttpRequest 使用 ActiveXObject。）

我一直使用[这个页面的 IE 浏览器修复](http://www.w3schools.com/Ajax/ajax_browsers.asp)：

```
function ajaxFunction() {
    var xmlhttp;
    if (window.XMLHttpRequest) {
        // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp = new XMLHttpRequest();
    }
    else if (window.ActiveXObject) {
        // code for IE6, IE5
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    else {
        alert("Your browser does not support XMLHTTP!");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T13:28:26.253

```
if (window.XMLHttpRequest) {
    var client = new XMLHttpRequest();
} else if(window.ActiveXObject) {
    var client = new ActiveXObject('Microsoft.XMLHTTP');
} else {
    alert('Your browser does not support XMLHttpRequest object');
}
if (typeof client.overrideMimeType != 'undefined') {
    client.overrideMimeType('text/xml');
} 
```

# c# - 两个线程的同步

> ID：852771
> 
> 赞同：2
> 
> 时间：2009-05-12T13:23:51.803
> 
> 标签：c#, multithreading, synchronization

我在c#中有两个线程。现在我需要等待一个特定的语句被执行，然后才能在另一个线程中继续执行，这显然是同步的情况。是否有任何代码可以像使用内置方法一样执行此操作？

这是代码示例：

```
 public void StartAccept()
    {
            try
            {
                newSock.BeginAccept(new AsyncCallback(Accepted), newSock);
            }
            catch (ArgumentException)
            {
                MessageBox.Show("Error in arguments while using begin-accept", "Error", MessageBoxButtons.OK);
            }
            catch (ObjectDisposedException)
            {
                MessageBox.Show("socket closed while using begin-accept", "Error", MessageBoxButtons.OK);
            }
            catch (SocketException)
            {
                MessageBox.Show("Error accessing socket while using begin-accept", "Error", MessageBoxButtons.OK);
            }
            catch (InvalidOperationException)
            {
                MessageBox.Show("Invalid operation while using begin-accept", "Error", MessageBoxButtons.OK);
            }
            catch (Exception)
            {
                MessageBox.Show("Exception occurred while using begin-accept", "Error", MessageBoxButtons.OK);
            }

    } 
```

这将从代码选择的所需主机接收数据：

```
 private void listBox1_Click(object sender, EventArgs e)
    {

        String data = (String)this.listBox1.SelectedItem;

        ip = Dns.GetHostAddresses(data);

        clientIP = new IPEndPoint(ip[0], 5555);

        newSock.Bind(clientIP);
        newSock.Listen(100);

    } 
```

因此，为了开始接收数据，我需要将套接字初始化为特定的远程主机，当我单击列表框中显示的主机之一时，该操作就完成了。为此，我需要同步。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-12T13:31:51.863

看看[AutoResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent.aspx)和[ManualResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx)。它们是使线程之间的同步成为可能的信号。

第一个需要等待某事完成的线程将执行 myEvent。[WaitOne](http://msdn.microsoft.com/en-us/library/58195swd.aspx) ()，它一直阻塞，直到另一个线程调用myEvent。[设置](http://msdn.microsoft.com/en-us/library/system.threading.eventwaithandle.set.aspx)（）。

假设我们有两个线程，其中一个线程需要在另一个线程继续之前进行某种初始化。然后在两者之间共享一个 AutoResetEvent，我们称之为 myEvent。

```
// Signal example

using System;
using System.Threading;

class MySync
{
    private readonly AutoResetEvent _myEvent;
    public MySync(AutoResetEvent myEvent)
    {
        _myEvent = myEvent;
    }

    public void ThreadMain(object state)
    {
        Console.WriteLine("Starting thread MySync");
        _myEvent.WaitOne();
        Console.WriteLine("Finishing thread MySync");
    }
}

class Program
{
    static void Main(string[] args)
    {
        AutoResetEvent myEvent = new AutoResetEvent(false);
        MySync mySync = new MySync(myEvent);
        ThreadPool.QueueUserWorkItem(mySync.ThreadMain);
        Console.WriteLine("Press enter to continue...");
        Console.ReadLine();
        myEvent.Set();
        Console.WriteLine("Press enter to continue...");
        Console.ReadLine();
        Console.WriteLine("Finishing");
    }
} 
```

不要将此与访问顺序无关紧要的共享资源混淆。例如，如果您有一个共享列表或共享字典，则需要将其包装在互斥体中以确保它们正确执行。

```
// Mutex example

object mySync = new object();
Dictionary<int, int> myDict = new Dictionary<int, int>();

void threadMainA()
{
    lock(mySync)
    {
        mySync[foo] = bar;
    }
}

void threadMainB()
{
    lock(mySync)
    {
        mySync[bar] = foo;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T13:38:10.307

您可以使用 AutoResetEvent。

在以下示例中，两个方法被不同的线程调用，并且 DoSomethingA() 将在 DoSomethingB() 开始之前执行并完成：

```
AutoResetEvent resetEvent = new AutoResetEvent(false);

void ThreadWorkerA()
{
    // perform some work
    DoSomethingA();

    // signal the other thread
    resetEvent.Set();
}

void ThreadWorkerB()
{
    // wait for the signal
    resetEvent.WaitOne();

    // perform the new work
    DoSomethingB();
} 
```

注意：记得处理 AutoResetEvent :)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-12T13:26:07.227

Java有一个叫做Join的东西。我怀疑 C# 中也会有一个预定义的方法。

# java - 为什么我们要增加Java Heap？

> ID：852781
> 
> 赞同：5
> 
> 时间：2009-05-12T13:26:12.530
> 
> 标签：java

我知道如何在 Tomcat 和 Eclipse 中设置 Java 堆大小。我的问题是为什么？首次引入 Java 时，是否对初始堆设置了任意限制，以便 VM 不会增长到一定大小？对于今天大多数具有大内存空间的机器来说，这似乎不是我们应该处理的事情。
谢谢，汤姆

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T13:30:29.323

即使是现在，堆也不会无限增长。

当最老一代已满时，你应该扩展它还是只 GC？还是应该只在 GC 没有释放任何内存时才扩展它？

.NET 采用您喜欢的方法：您不能告诉它只使用一定数量的堆。有时感觉这是一个更好的主意，但有时很高兴能够在同一台机器上拥有两个进程并且知道它们都无法占用整个内存......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T13:37:17.983

前几天我看了一眼，但我不确定这是否是你想要的：`-XX:+AggressiveHeap`。 [据孙说](http://java.sun.com/docs/hotspot/ism.html)：

> 该选项指示JVM将内存使用推到极限：总堆大于3850MB，每个线程的分配区域为256K，内存管理策略尽可能延迟收集，以及（从J2SE 1.3.1_02开始）一些 GC 活动是并行完成的。
> 
> 因为此选项设置堆大小，所以不要将 -Xms 或 -Xmx 选项与 -XX:+AggressiveHeap 结合使用。这样做会导致选项覆盖彼此的堆大小设置。

不过，我不确定这是否真的意味着我认为的意思——你可以让 JVM 吞噬堆空间，直到它满意为止。但是，这听起来并不是在大多数情况下使用的好选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T14:10:49.600

Java是一个跨平台的系统。一些系统（如 Unix 和衍生系统）有一个`ulimit`命令，允许您限制一个进程可以使用多少内存。其他人没有。此外，Java 有时会嵌入运行，例如在 Web 浏览器中。您不希望一个损坏的小程序破坏您的桌面（嗯，至少是这样的想法，但小程序从未真正流行起来，但那是另一回事了）。从本质上讲，此选项是[沙盒](http://en.wikipedia.org/wiki/Sandbox_(computer_security))的关键基石之一。

因此，VM 开发人员需要一个可移植的解决方案：他们为 VM 添加了一个选项，允许任何人（用户、管理员、Web 浏览器）控制 VM 可以分配多少 RAM。Java 的各种用途的需求太多样化了，无法一刀切。

今天，当您查看移动设备时，这一点变得更加重要。你的台式机有 2-8GB 的​​ RAM，但你的手机可能少得多。对于这些事情，您真的不希望一个糟糕的应用程序导致设备崩溃，因为甚至可能没有用户可以检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T13:35:55.617

我认为能够提供一个限制是很好的，这样如果您遇到内存问题，它就不会吞噬所有系统内存，让您只有重新启动选项。

# flex3 - flex 3 中的一个标签中的双色

> ID：852783
> 
> 赞同：0
> 
> 时间：2009-05-12T13:26:48.020
> 
> 标签：flex3, flexbuilder

我只是想知道您是否可以在标签中获得两种颜色，以便我可以将一些文本设置为白色和一些红色。我一直在网上寻找，并没有找到任何东西。但是，我虽然在这里会是一个更合适的地方问。如果不是，我将只使用两个标签。但任何意见表示赞赏。问候马克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T13:37:10.293

我严重怀疑这是可能的。

# c# - 使 CollectionViewSource 无效

> ID：852784
> 
> 赞同：2
> 
> 时间：2009-05-12T13:26:55.837
> 
> 标签：c#, .net, wpf, xaml

我定义了以下视图：

```
<CollectionViewSource x:Key="PatientsView" Source="{Binding Source={x:Static Application.Current}, Path=Patients}"/> 
```

其中 Patient 是以下属性：

```
public IEnumerable<Patient> Patients
{
    get
    {
        return from patient in Database.Patients
               orderby patient.Lastname
               select patient;
    }
} 
```

在我的代码中的某处，我更改了患者数据库，并且我希望自动通知显示此数据的控件（使用“PatientsView”）。这样做的正确方法是什么？CollectionViewSource 可以失效还是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T13:39:34.530

如何在后面的代码中使 CollectionViewSource 无效：

```
CollectionViewSource patientsView = FindResource("PatientsView") as CollectionViewSource;
patientsView.View.Refresh(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T14:06:13.027

我认为这比看起来要复杂一些。通知您的客户端应用程序有关数据库的更改是一项非常重要的任务。但是，如果仅从您的应用程序更改数据库，您的生活会更轻松——这使您能够在更改数据库时放置“刷新逻辑”。

您的“患者”属性似乎存在于一类中（可能不止一类？:)）。您可能会将一些 ListBox 绑定到 CollectionViewSource。因此，您可以让 WPF 重新调用 getter，而不是在 CollectionViewSource 上调用 Refresh。为此，具有 Patients 属性的类必须实现 INotifyPropertyChanged 接口。

代码如下所示：

```
public class TheClass : INotifyPropertyChanged
{
public IEnumerable<Patient> Patients
  {
    get
    {
            return from patient in Database.Patients
                   orderby patient.Lastname
                   select patient;
    }
  }

#region INotifyPropertyChanged members
// Generated code here
#endregion

public void PatientsUpdated()
{
  if (PropertyChanged != null)
    PropertyChanged(this, "Patients");
}
} 
```

现在，在 TheClass 的一个实例上调用 PatientUpdated() 来触发绑定的更新。

PS 说了这么多，它只是在某种程度上感觉像是一个糟糕的设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T13:33:03.983

`Table<T>`不支持`IListChanged`事件，您必须自己执行此操作（我今天早些时候也必须这样做）。

# excel - Excel 计算和 VBA

> ID：852791
> 
> 赞同：1
> 
> 时间：2009-05-12T13:28:11.560
> 
> 标签：excel, vba, excel-formula

在下面的 Excel 电子表格中，我需要进行以下计算：

```
输入颜色选择输出  
-------- -------------- --------
  40红色40x18
  40 蓝色 40x12
  40 绿色 40x16
  40黄40x13
  39红色39x18
  28蓝色28x12
  33 绿色 33x16
  25黄色25x13

```

我的问题是，如何为使用 Java 选择的颜色分配值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T13:35:59.967

听起来你想做这样的事情...... ["Countif cell color is red"](http://www.pcreview.co.uk/forums/thread-1775341.php)。也就是说，您的意思是根据单元格的格式应用不同的乘数。另请参阅[“Excel 中的颜色函数”](http://www.cpearson.com/excel/colors.aspx)。

但老实说，最好的办法是创建一个新列，其中包含您尝试使用格式表示的信息的语义，并将 THAT 用于您的条件表达式。创建一个包含“颜色”格式中包含的信息的列并使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T13:59:22.010

您可以有一个带有颜色和数字的单独表格：

```
 |    F    |   G   |
---|---------|-------|--
 1 | red     |   18  |
 2 | blue    |   12  |
 3 | green   |   16  |
 . | ...     |   ..  | 
```

然后在计算中使用该表：

```
 |   A   |     B     |                 C                 |
---|-------|-----------|-----------------------------------|--
 1 |   40  | red       |  =A1*VLOOKUP(B1,$F$1:$G$100,2,0)  |
 2 |   40  | blue      |  =A2*VLOOKUP(B2,$F$1:$G$100,2,0)  |
 . |   ..  | ...       |                ...                | 
```

# javascript - 如何为javascript中的隐藏变量分配空值？

> ID：852794
> 
> 赞同：4
> 
> 时间：2009-05-12T13:28:20.170
> 
> 标签：javascript, jquery

我有一个名为 str 的隐藏输入变量。

我正在为其分配“abc”值。

然后我尝试分配空值，或者说对它的空引用。但我做不到。

**编辑**

代码的一部分。

隐藏领域...

```
<input id="str" name="str" type="hidden" value="" /> 
```

我也使用 jQuery。

```
if ($(str).val() == "abc") {
     $("#str").val(null);
             } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-12T13:33:26.510

我不确定将值归零是否有意义 - 您应该将值置空或删除整个字段（而不仅仅是值）。

根据您提供的示例代码...

例如：

```
$("#str").val('') 
```

或者

```
$("#str").remove() 
```

另一种选择，如果您可能需要打开或关闭该字段（而不是删除和重新创建）将禁用该字段 - 禁用的字段不会与表单一起提交。

```
$("#str").attr('disabled','disabled')
and
$("#str").removeAttr('disabled') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T13:31:42.877

将空字符串分配给它。它将在服务器端以相同的方式处理。

```
 var inp = document.getElementById('str');
 inp.value = '';  // actually inp.value = null will work here 
```

或者使用 jQuery

```
 if ($(str).val() == "abc")
 {
     $("#str").val('');
 } 
```

# dependency-injection - 与温莎城堡的上下文绑定

> ID：852797
> 
> 赞同：3
> 
> 时间：2009-05-12T13:28:56.317
> 
> 标签：dependency-injection, inversion-of-control, castle-windsor, ioc-container

是否可以让 Windsor 基于单独的参数返回不同的服务实现？

例如，如果我有一个具有 Role 属性的 User 对象，我希望能够根据 Role 的值不同地水合这个对象。我想使用 IUserService 来执行此操作，但 IUserService 的具体实现由 IoC 容器确定。

我认为 Ninject 将此功能作为“上下文绑定”提供，但我不确定 Windsor 是否在不滚动我自己的解析逻辑的情况下提供它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T14:19:47.070

不，这是不可能的（还）。看看[这里](http://castle.uservoice.com/pages/16605-official-castle-project-feedback-forum/suggestions/173776-add-convention-over-configuration-features-to-ioc-containers)和[这里](http://kozmic.pl/archive/2009/04/09/convention-based-dependency-injection-with-castle-microkernelwindsor.aspx)。现在看看 HandlerProvider 是否有你需要的东西。如果没有，您可能需要使用 ISubDependencyResolver（实际上并不是很复杂）。

# jquery - 向 ASP.NET / jquery 网页添加历史记录支持

> ID：852800
> 
> 赞同：1
> 
> 时间：2009-05-12T13:29:45.223
> 
> 标签：jquery, ajax, navigation

我已经实现了一个网页，它通过[jQuery.form](http://malsup.com/jquery/form/)插件（用于表单 POST 请求）和标准 jQuery 加载方法（用于所有其他请求）从服务器动态加载内容。

现在我想添加历史支持，以正确支持后退/前进浏览器按钮。我已经设法为简单的链接做到这一点，但在尝试向 jquery.form POST 请求添加历史支持时，我总是遇到细节问题。到目前为止，我已经尝试了 jquery.history 和 jquery.ajaxify，但没有成功。

有谁知道教程或有一些示例代码如何向 jquery.form ajaxed 表单添加历史支持？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T22:11:50.043

没有内置支持直接使用 JQuery 修改历史记录。但是有一个 JQuery History 插件（或两个或三个）。

[http://www.mikage.to/jquery/jquery_history.html](http://www.mikage.to/jquery/jquery_history.html)

[http://plugins.jquery.com/project/history](http://plugins.jquery.com/project/history)

# asp.net - 在 EntityDataSource 中插入新记录

> ID：852801
> 
> 赞同：3
> 
> 时间：2009-05-12T13:29:53.350
> 
> 标签：asp.net, entity-framework

如何在 EntityDataSource 中插入新记录（来自 gridview）

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-06-28T13:52:08.473

如果您不想添加自己的插入功能，则使用 ListView 而不是 GridView 更容易。

[http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/a06bc929-08b6-44fd-87be-80075a9a7137](http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/a06bc929-08b6-44fd-87be-80075a9a7137)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T14:08:53.990

我现在遇到同样的问题，我发现了这个： [如何启动插入事件](http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/d8a3ecd8-55dd-45ad-8175-d7ce912f46c2/)

不是我所希望的，但它似乎正在工作。

# vb6 - Visual Studio 6 自定义工具栏

> ID：852811
> 
> 赞同：0
> 
> 时间：2009-05-12T13:31:53.313
> 
> 标签：vb6

我有一个仍然需要支持的旧版 VB6 应用程序。我还有一台新电脑，我想复制在旧电脑上创建的自定义工具栏。有人知道 Visual Studio 6 自定义工具栏的保存位置吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-12T14:58:39.557

我想你在谈论一个插件。用 VB6 为 VB6 编写的插件使用对**Microsoft Visual Basic 6.0 Extensibility**的引用。您将应用程序编译为 ActiveX EXE，因此它可以放置在硬盘驱动器的任何位置。您可以查看**vbaddin.ini**中的 *addin。***连接**设置，其中插件将是插件名称。不幸的是，这不是文件名或路径，但它应该足够接近以帮助您搜索应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T21:49:29.813

我不知道它存储在哪里，但是您可以尝试从 SysInternals 运行[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)，并在更改自定义工具栏时查看 VB6 写入文件和注册表的内容。不过说实话，手动设置工具栏可能会更快。

# bash - 如何删除 svn 中带有空格的丢失文件？

> ID：852814
> 
> 赞同：12
> 
> 时间：2009-05-12T13:32:13.393
> 
> 标签：bash, svn

我找到了这个片段。

```
svn status | grep '\!' | awk '{print $2;}' | xargs svn rm 
```

如果我或某人手动删除文件（通过编辑器或通过系统删除），它将删除所有丢失的文件

但是我的 bash 编码不是很好，它缺少的是它不适用于其中有空格的文件。

```
svn rm Super\ Test.file 
```

是删除带有空格的文件的正确方法，但我不知道如何修改上面的代码片段以便它工作。（或者如果你有另一个片段）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-12T13:46:03.583

```
svn status | grep '^\!' | cut -c8- | while read f; do svn rm "$f"; done 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T13:51:34.443

您可以 0 转义并将 -0 标志用于 xargs。

```
svn st | awk '/^!/ { sub("^! +", ""); printf "%s\0", $0 }' | xargs -0 svn rm 
```

这还有另一个优点，即带有引号或其他特殊字符的文件也不会搞砸 xargs 命令行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T14:13:11.297

使用 GNU awk，我可以：

```
svn stat | awk -v FIELDWIDTHS="1 6 1000 1" -v ORS=$'\0' '$1 == "!" { print $3 }' | xargs -0 svn rm 
```

# c# - 任何使用 C# 和 ZeroC ICE 的经验

> ID：852817
> 
> 赞同：8
> 
> 时间：2009-05-12T13:33:02.250
> 
> 标签：c#, ice

[http://www.zeroc.com/](http://www.zeroc.com/)

我听说它在跨平台互操作和性能方面要好得多。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-09-09T15:45:53.700

我们在混合语言项目中使用 ZeroC Ice。到目前为止，我们使用 C++、Python 和 C# 编写。Ice 非常易于使用、可扩展和可扩展。唯一的不便是您必须分别为某些语言编写插件和对象工厂。例如，C++ 的传输适配器插件不能在 C# 中重用（但适用于 Python）。我们的软件（它的 C++ 部分）对性能至关重要，Ice 给出了非常好的结果。非常有趣的功能是更新旧数据结构（例如，您可以修改存储在数据库中的旧类，并向它们添加新字段）和动态持久性（冻结服务）。强烈推荐。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T13:39:03.940

我不知道 zeroc，但另一个选项是“[协议缓冲区](http://code.google.com/p/protobuf/)”——这是 Google 的开源二进制序列化格式，专为可移植性（平台和实现之间）、性能（二进制，读/写便宜）和可扩展性而设计。

但是，没有由协议缓冲区定义的标准 RPC 堆栈。不过，少数 RPC 堆栈正在社区中涌现。

Java、C++ 和 php 在 Google 版本中，并且有[各种社区版本](http://code.google.com/p/protobuf/wiki/OtherLanguages)可用，包括 C#。

# svn - cvs2svn 之后的颠覆问题

> ID：852821
> 
> 赞同：0
> 
> 时间：2009-05-12T13:33:06.353
> 
> 标签：svn, cvs2svn

我正在使用 eclipse / subclipse 进行开发。我也有 TortoiseSVN 客户端。

我正在尝试移动 CVS 存储库。旧的 CVS 存储库只有一个项目。我们想重新组织，因为其中几个项目有自己的开发流，应该分开管理。

我使用 cvs2svn 运行了存储库的标准完整移动，没有任何问题。

我想重组 subversion 存储库中的项目，所以在 cvs2svn 之后，我尝试进行 svn move 并进行了重组。我能够成功地完成移动，再次没有问题。

我在 Eclipse 中签出该项目，然后在其中一个*移动*项目中选择一个文件。哪个项目似乎并不重要。如果我在 Eclipse 中执行更新版本，并在文件历史记录中选择要更新到的版本，则该文件将从我的文件系统中删除，但旧版本永远不会出现。文件根本就没了。

我在使用 TortoiseSVN 时遇到了同样的问题，所以我认为这不是 subclipse 问题。

有趣的是，如果我将`svn move`一个项目*返回*到它最初转换到的原始位置，并遵循相同的步骤，我没有任何问题，更新版本按预期工作。

所以，对于我的问题：

1.  在 cvs2svn 迁移过程中我是否做错了什么，导致我无法成功重组我的 subversion 存储库？
2.  有没有更好的方法来做我想做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T21:29:23.920

1.  不，你没有做错任何事
2.  是的。在通过 cvs2svn 导入**之前**，您应该重新组织 CVS 存储库

出现此症状的原因：

你总是需要检查一个文件夹。如果您更新到以前的版本，此文件夹可能不存在（该文件夹已被移动），然后 Subversion 将删除其内容。Subversion 中的重命名总是作为删除和添加来实现的。所以你在文件之间有一个薄弱的联系，但这只是为了这个文件的历史。如果您想查看新布局，您需要检出一个包含以下内容的文件夹：目标和源文件夹。您将能够“看到”此文件夹的移动，但是如果您的结帐中只有一个文件夹，则该文件夹将消失，您需要结帐不同的 URL（目标或源）。

因此，在 CVS 中重组项目然后进行迁移会更容易。缺点：您将没有任何重组历史，并且您无法构建/编译以前的版本（在 CVS 中创建）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T08:07:13.597

我同意 Peter Parker 的观点，*如果*您想要在单个项目中重新组织文件夹和文件，那么在转换为 Subversion 之前重新组织 CVS 中的项目是容易且可取的。

但是，如果您想重新组织项目本身的布局（即，一个项目相对于另一个项目的位置），您可以在 cvs2svn 转换过程中轻松完成此操作。当您进行[多项目转换](http://cvs2svn.tigris.org/faq.html#onetoone)时，您可以指定 cvs2svn 应该在哪里放置每个项目的主干、分支和标签目录。只需根据您所需的新项目组织放置它们，然后使用任何常用工具使用存储库都应该没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T12:10:52.590

在我工作的地方，我们决定在从 CVS 导入后将文件移动到 SVN 中。CVS 的移动历史功能有限，而 SVN 存储库可以“回滚”以随时查看它的样子。同样，通过这样做，决定保留所有更改和移动的历史更为重要。

我们所做的是将模块从 CVS 移到 SVN 中。然后，使用存储库浏览器，在签出之前根据需要移动所有文件。

现在，当您将单个文件更新为可能会消失的旧版本时，这并不能解决您的问题。我们决定接受这一点，因为我们正试图从以文件为中心的存储库 (CVS) 视图转移到基于快照的视图。因此，如果我们需要回到旧版本，我们会更新整个项目。如果您只是查看差异历史记录，那么当我们允许移动/重命名时，TortoiseSVN 效果很好。

# java - 即时 Java ArrayList 和 HashMap

> ID：852822
> 
> 赞同：59
> 
> 时间：2009-05-12T13:33:07.307
> 
> 标签：java, collections

有人可以提供一个即时创建 Java 的示例`ArrayList`吗？因此，实际上不是在类实例化时为数组/散列提供种子数据，`HashMap`而不是执行`add()`or ？`put()`

举个例子，类似于 PHP 的例子：

```
$array = array (3, 1, 2);
$assoc_array = array( 'key' => 'value' ); 
```

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-05-12T13:37:45.707

```
List<String> list = new ArrayList<String>() {
 {
    add("value1");
    add("value2");
 }
};

Map<String,String> map = new HashMap<String,String>() {
 {
    put("key1", "value1");
    put("key2", "value2");
 }
}; 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-05-12T13:36:04.663

一个很好的方法是使用`List.of()`and `Map.of()`（从 Java 8 开始）：

```
List<String> list = List.of("A", "B", "C");

Map<Integer, String> map = Map.of(1, "A",
                                  2, "B",
                                  3, "C"); 
```

Java 7 及更早版本可能会使用[Google Collections](http://code.google.com/p/google-collections/)：

```
List<String> list = ImmutableList.of("A", "B", "C");

Map<Integer, String> map = ImmutableMap.of(
  1, "A",
  2, "B",
  3, "C"); 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-05-12T13:36:44.617

数组可以转换为`List`s：

```
List<String> al = Arrays.asList("vote", "for", "me"); //pandering 
```

请注意，这不会*返回*一个`ArrayList`任意`List`实例（在这种情况下它是一个`Array.ArrayList`）！

布鲁诺的方法效果最好，可以在地图上即时考虑。我更喜欢列表的另一种方法（见上文）：

```
Map<String,String> map = new HashMap<String,String>() {
 {
    put("key1", "value1");
    put("key2", "value2");
 }
}; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-12T13:37:51.367

短名单：

```
 List<String> ab = Arrays.asList("a","b"); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-12T13:37:06.470

使用一个不错的匿名初始化器：

```
List<String> list = new ArrayList<String>() {{
    add("a");
    add("b");
}}; 
```

地图也是如此：

```
Map<String, String> map = new HashMap<String, String>() {{
    put("a", "a");
    put("b", "b");
}}; 
```

我发现这是最优雅和可读的。

其他方法需要先创建一个数组，然后将其转换为一个列表——在我看来太贵了，而且可读性也差。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-05-23T09:18:27.133

对于列表，您可以像这样使用[Arrays.asList](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#asList(T...))：

```
List<String> stringList = Arrays.asList("one", "two");
List<Integer> intList = Arrays.asList(1, 2); 
```

对于地图，您可以使用：

```
public static <K, V> Map<K, V> mapOf(Object... keyValues) {
    Map<K, V> map = new HashMap<>();

    K key = null;
    for (int index = 0; index < keyValues.length; index++) {
        if (index % 2 == 0) {
            key = (K)keyValues[index];
        }
        else {
            map.put(key, (V)keyValues[index]);
        }
    }

    return map;
}

Map<Integer, String> map1 = mapOf(1, "value1", 2, "value2");
Map<String, String> map2 = mapOf("key1", "value1", "key2", "value2"); 
```

注意：`Java 9`您可以使用[Map.of](http://download.java.net/java/jdk9/docs/api/java/util/Map.html#of-K-V-)
Note2: `Double Brace Initialization`for 创建 HashMaps 如其他答案中所建议的那样有它的[警告](https://stackoverflow.com/a/924326/1183010)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-12T13:35:43.620

你的意思是这样吗？

```
public List<String> buildList(String first, String second)
{
     List<String> ret = new ArrayList<String>();
     ret.add(first);
     ret.add(second);
     return ret;
}

...

List<String> names = buildList("Jon", "Marc"); 
```

或者您对`ArrayList`采用 a 的构造函数感兴趣`Collection<? extends E>`吗？例如：

```
String[] items = new String[] { "First", "Second", "Third" };
// Here's one way of creating a List...
Collection<String> itemCollection = Arrays.asList(items);
// And here's another
ArrayList<String> itemList = new ArrayList<String>(itemCollection); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-01T11:56:01.710

这个怎么样？

```
ArrayList<String> array = new ArrayList<String>(Arrays.asList("value1", "value2")); 
```

我知道许多答案都提供了类似的解决方案，但我认为这个更准确和更简洁。如果你有很多值，你可能想要这样做：

```
ArrayList<String> array = new ArrayList<String>(Arrays.asList(
    "value1",
    "value2",
    "value3",
    ...
)); 
```

# .net - 在 Oracle 中解析 CSV（逗号分隔值）

> ID：852828
> 
> 赞同：1
> 
> 时间：2009-05-12T13:34:45.900
> 
> 标签：.net, oracle, csv, odp.net

我想使用逗号分隔的字符串将一组记录标识符传递给 Oracle 过程。我想把它放到一个临时表中，然后在进一步处理中加入它。我该怎么办？

比 CSV 更好的方法也会很高兴听到。我正在使用 ODP.Net 进行数据访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T13:58:14.633

我对 ODP.net 一无所知，但为什么要将所有记录标识符连接到 CSV 字符串中呢？

更好的方法可能是在您的过程中创建一个数组参数并传递一个标识符数组。我想这取决于您从哪里获取标识符列表以及它们是以数组还是 CSV 字符串开始的？

这是一个使用数组类型并将其加入查询而不使用临时表的示例（您可以使用 IN 列表执行类似的操作，但更难绑定）：

```
create or replace type my_test_type as object (id integer);

create or replace type my_test_type_a as table of my_test_type;

create or replace procedure my_test_proc(i_ids in my_test_type_a)
is
begin

 for row in (
   select a.l from
   (
     select level l from dual connect by level <= 10
   ) a, table(i_ids) b
   where a.l = b.id 
 ) loop
   dbms_output.put_line(row.l);
 end loop;
end;
/ 
```

请注意，测试过程中的查询使用“表”函数将传入的数组转换为查询中的表，您实际上可以将其他真实表连接到其中。

也不是子查询“a”使用技巧来创建一个假测试表，其中包含 10 行，值从 1 到 10（这只是测试数据来证明它有效）。

使用以下块，我们可以测试代码是否有效：

```
declare
  v_id my_test_type;
  v_ids my_test_type_a;
begin
  v_id := my_test_type(1);
  v_ids := my_test_type_a();
  for i in 1.. 5 loop
    v_id := my_test_type(i);
    v_ids.extend;
    v_ids(i) := v_id; 
  end loop;
  my_test_proc(v_ids);
end;
/ 
```

只要 dbms_output 处于打开状态，这应该打印 1 - 5，因为测试数据表已与您的数组连接！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T14:01:20.183

用IN怎么样？如`select ... where id IN (...list-of-ids-here...)`?

除此之外，我建议在调用过程之前手动将值插入到临时表中，或者编写一个为您执行插入的特殊过程，这样您就可以在第二步中调用原始过程。这样，您比将所有内容都放入一个方法中要灵活得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T22:32:44.143

SQL LOADER 非常适合这项任务

[http://download-east.oracle.com/docs/cd/B10501_01/server.920/a96652/ch03.htm#1656](http://download-east.oracle.com/docs/cd/B10501_01/server.920/a96652/ch03.htm#1656)

您可以为日期指定多种格式，并且有许多有用的选项可用于将数据从 CSV 导入 Oracle。

# .net - 在不使用 SnapIn 的情况下在 Powershell SDK 中添加自定义格式

> ID：852831
> 
> 赞同：0
> 
> 时间：2009-05-12T13:35:04.260
> 
> 标签：.net, powershell, sdk, cmdlets

我正在开发一个使用 PowerShell SDK 执行脚本的 .NET/C# 2.0 应用程序。我没有使用管理单元。我通过 PS 的*RunspaceConfiguration*直接设置所有内容。

所以我的问题是我无法为应用程序中实现的类型*Plux.ExtensionTypeInfo*添加自定义格式。

（*Plux.ExtensionTypeInfo*有一个名为 Name 的属性）

这就是我尝试的：

```
...
RunspaceConfiguration config = RunspaceConfiguration.Create();

config.Formats.Prepend(
    new FormatConfigurationEntry("plux.format.ps1xml")
    );

config.Formats.Update();
... 
```

plux.format.ps1xml：

```
<Configuration>
  <ViewDefinitions>
  <View>
       <Name>Plux.ExtensionTypeInfo</Name>
            <ViewSelectedBy>
                <TypeName>Plux.ExtensionTypeInfo</TypeName>
            </ViewSelectedBy>
            <TableControl>
                <TableHeaders>
                    <TableColumnHeader>
                        <Width>30</Width>
                    </TableColumnHeader>
                </TableHeaders>
                <TableRowEntries>
                    <TableRowEntry>
                        <TableColumnItems>
                            <TableColumnItem>
                                <PropertyName>Name</PropertyName>
                            </TableColumnItem>
                        </TableColumnItems>
                    </TableRowEntry>
                </TableRowEntries>
            </TableControl>
        </View>
</ViewDefinitions>
</Configuration> 
```

执行返回几个 ExtensionTypeInfo 对象的 Cmdlet 后，输出将永远不会被格式化。

借助内置的 Cmdlet 和类型，格式可以在我的 PS Host 应用程序中完美运行。Cmdlet 注册也可以通过*配置*对象正常工作。使用 powershell.exe 或我的托管应用程序在*plux.format.ps1xml*上启动*update-formatdata时，不会引发任何错误。*

 *尽管如此，上面的代码对格式化没有影响。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T01:56:41.513

我还没有尝试托管 PowerShell 运行时环境。但我很确定您的问题是输出格式没有发生，因为您在应用程序中捕获管道，而不是在 PowerShell 主机中。

输出格式化发生在 PowerShell 主机的 Out-Default cmdlet 中，或者通过调用 Format-Table 或 Format-List 来指定格式。

**编辑：**

我的建议是在运行空间中运行它。

```
YourCommand | Format-Table Name | Out-String 
```

另外，我希望您不要尝试解析此输出。

# java - 为什么 PrintStream.close() 最终会被调用两次？

> ID：852838
> 
> 赞同：7
> 
> 时间：2009-05-12T13:36:13.837
> 
> 标签：java, inheritance, printstream

令我惊讶的是，以下代码两次打印出“关闭”。通过调试器运行，似乎`MyPrintStream.close()`调用`super.close()`，最终`MyPrintStream.close()`再次调用。

```
 import java.io.*;

public class PrintTest
{
    static class MyPrintStream extends PrintStream
    {
        MyPrintStream(OutputStream os)
        {
            super(os);
        }

        @Override
        public void close()
        {
            System.out.println("Close");
            super.close();
        }
    }

    public static void main(String[] args) throws IOException
    {
        PrintStream ps = new MyPrintStream(new FileOutputStream(File.createTempFile("temp", "file")));
        ps.println("Hello");
        ps.close();
    }
} 

```

为什么会这样？我不应该扩展 PrintStream 吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-12T13:47:41.287

如果您在调试器中查看代码并在`close()`方法中设置断点，它将显示*谁*在调用您的`close()`方法的堆栈跟踪：

1.  你的主要方法
2.  sun.nio.cs.StreamEncoder$CharsetSE.implClose() 第 431 行

后者的完整堆栈跟踪如下所示：

```
PrintTest$MyPrintStream.close() line: 20    
sun.nio.cs.StreamEncoder$CharsetSE.implClose() line: 431 [local variables unavailable]  
sun.nio.cs.StreamEncoder$CharsetSE(sun.nio.cs.StreamEncoder).close() line: 160 [local variables unavailable]    
java.io.OutputStreamWriter.close() line: 222 [local variables unavailable]  
java.io.BufferedWriter.close() line: 250 [local variables unavailable]  
PrintTest$MyPrintStream(java.io.PrintStream).close() line: 307  
PrintTest$MyPrintStream.close() line: 20    
PrintTest.main(java.lang.String[]) line: 27 
```

可悲的是，尽管我不知道*为什么*StreamEncoder 会回调到您的 PrintStream 中，因为我的 IDE 没有 sun.nio.cs.StreamEncoder 的源附件 :( 这是 JDK 6 顺便说一句，如果这很重要。

**顺便说一句**，如果您问这个问题是因为您注意到`close()`方法中的自定义代码运行了两次，那么您真的应该检查 if `this.closing`。`PrintStream.close()`将此设置为 true （以及类的评论状态`/* To avoid recursive closing */`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T22:41:19.700

看看 PrintStream 的源代码。

它有两个对底层 Writer`textOut`和的引用`charOut`，一个是基于字符的，一个是基于文本的（不管是什么意思）。此外，它继承了对基于字节的 OutputStream 的第三个引用，称为`out`.

```
/**
 * Track both the text- and character-output streams, so that their buffers
 * can be flushed without flushing the entire stream.
 */
private BufferedWriter textOut;
private OutputStreamWriter charOut; 
```

在`close()`方法中它关闭了所有这些（`textOut`与 基本相同`charOut`）。

```
 private boolean closing = false; /* To avoid recursive closing */

/**
 * Close the stream.  This is done by flushing the stream and then closing
 * the underlying output stream.
 *
 * @see        java.io.OutputStream#close()
 */
public void close() {
synchronized (this) {
    if (! closing) {
    closing = true;
    try {
        textOut.close();
        out.close();
    }
    catch (IOException x) {
        trouble = true;
    }
    textOut = null;
    charOut = null;
    out = null;
    }
}
} 
```

现在，有趣的部分是 charOut 包含一个（包装的）引用 PrintStream 本身（注意`init(new OutputStreamWriter(this))`构造函数中的）

```
private void init(OutputStreamWriter osw) {
   this.charOut = osw;
   this.textOut = new BufferedWriter(osw);
}

/**
 * Create a new print stream.
 *
 * @param  out        The output stream to which values and objects will be
 *                    printed
 * @param  autoFlush  A boolean; if true, the output buffer will be flushed
 *                    whenever a byte array is written, one of the
 *                    <code>println</code> methods is invoked, or a newline
 *                    character or byte (<code>'\n'</code>) is written
 *
 * @see java.io.PrintWriter#PrintWriter(java.io.OutputStream, boolean)
 */
public PrintStream(OutputStream out, boolean autoFlush) {
this(autoFlush, out);
init(new OutputStreamWriter(this));
} 
```

因此，调用`close()`将调用`charOut.close()`，而后者又再次调用原来的`close()`，这就是为什么我们有关闭标志来缩短无限递归。

# c++ - Win32，C++：创建弹出窗口而不窃取焦点

> ID：852856
> 
> 赞同：10
> 
> 时间：2009-05-12T13:39:37.900
> 
> 标签：c++, windows, winapi

我正在创建一个程序，该程序会在特定时间（就像某些聊天客户端一样）显示用户可以单击的弹出窗口。但是，我不想将焦点从当前应用程序中移开。

我现在这样做的方式是使用带有 WS_POPUPWINDOW 的 HWND 并最小化然后恢复窗口。但是，这会从当前应用程序中窃取焦点。设置前景或隐藏并显示窗口不会使其出现在前景中。我希望能够继续使用 HWND，这样我就可以在这个窗口中使用其他元素，但我不知道如何在不窃取焦点的情况下赋予它前景。

我使用win32和c++。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-12T13:50:57.643

在不激活的情况下显示：

```
ShowWindow(hwnd, SW_SHOWNOACTIVATE); 
```

在不激活的情况下加注：

```
SetWindowPos(hwnd, HWND_TOP, 0, 0, 0, 0, SWP_NOMOVE|SWP_NOSIZE|SWP_NOACTIVATE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-13T16:00:18.907

不幸的是，这对我不起作用。该窗口是使用**CreateWindowExA**创建的，并使用**ShowWindow(hwnd, SW_SHOWNOACTIVATE)**显示，但是键盘焦点仍然从创建时具有焦点的窗口中窃取。（使用**SetWindowLong()**和**SetLayeredWindowAttributes()**创建具有分层和透明属性的窗口）。

PS：具有焦点的窗口不是新创建的窗口的父窗口。

已解决：当我删除**SetForegroundWindow**调用时它起作用了。此函数会激活作为参数传递的窗口。

# .net - WCF：从 OperationContext 中检索 MethodInfo

> ID：852860
> 
> 赞同：19
> 
> 时间：2009-05-12T13:41:23.047
> 
> 标签：.net, wcf

是否有一种优雅的方法可以从 MessageInspector/AuthorizationPolicy/其他扩展点获取将在服务实例上执行的方法？我可以使用

> OperationContext.Current.IncomingMessageHeaders.Action

但我希望有一些方法可以做到这一点，而无需手动将 SOAP 操作与 OperationContracts 匹配。

我要做的是在执行之前检查方法的属性。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-10-01T17:22:36.753

我花了很长时间，但我确实找到了一种比寻找和苦苦完成整个合同更好的方法：

```
string action = operationContext.IncomingMessageHeaders.Action;
DispatchOperation operation = 
    operationContext.EndpointDispatcher.DispatchRuntime.Operations.FirstOrDefault(o =>
        o.Action == action);
// Insert your own error-handling here if (operation == null)
Type hostType = operationContext.Host.Description.ServiceType;
MethodInfo method = hostType.GetMethod(operation.Name); 
```

你就在那里。你可以得到属性或做任何你喜欢的事情。

注意：您可能很想尝试在 DispatchRuntime 中使用 OperationSelector。我发现的问题是，就我而言，在特定的处理阶段，OperationSelector 是一个空引用。如果您有权访问此属性，则使用它可能比上面“扫描” OperationCollection 更快、更可靠。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-04-11T18:44:51.697

如果`OperationContext.CurrentIncomingMessageHeaders.Action`为空，你可以这样做——它有点简洁：

```
string actionName = OperationContext.Current.IncomingMessageProperties["HttpOperationName"] as string;
Type hostType = operationContext.Host.Description.ServiceType;
MethodInfo method = hostType.GetMethod(actionName); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-05T08:40:47.633

基于@Aaronaught 和@TimDog 的回答，以及[这个SO question](https://stackoverflow.com/questions/3179863/wcf-destinguish-between-rest-and-soap-requests-using-the-operationcontext)，我想出了一个**适用于 REST 和 SOAP**的解决方案。

```
///<summary>Returns the Method info for the method (OperationContract) that is called in this WCF request.</summary>
System.Reflection.MethodInfo GetActionMethodInfo(System.ServiceModel.OperationContext operationContext ){
    string bindingName = operationContext.EndpointDispatcher.ChannelDispatcher.BindingName;
    string methodName;
    if(bindingName.Contains("WebHttpBinding")){
            //REST request
            methodName = (string) operationContext.IncomingMessageProperties["HttpOperationName"];
    }else{
            //SOAP request
            string action = operationContext.IncomingMessageHeaders.Action;
            methodName = operationContext.EndpointDispatcher.DispatchRuntime.Operations.FirstOrDefault(o =>o.Action == action).Name;
    }
    // Insert your own error-handling here if (operation == null)
    Type hostType = operationContext.Host.Description.ServiceType;
    return hostType.GetMethod(methodName);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T14:31:32.523

Castle WCF 集成工具使您能够通过使用 DynamicProxy 代理来做到这一点（在许多有用的事情中）。看看[这里](http://www.castleproject.org/container/facilities/trunk/wcf/index.html)。

关于它的文档不多，因此对于如何使用它的文档，最好看一下它的测试。

# ios - 如何将 UIImageView 旋转 20 度？

> ID：852863
> 
> 赞同：48
> 
> 时间：2009-05-12T13:43:26.257
> 
> 标签：ios, iphone, cocoa-touch, uiimageview, uikit

如果我需要旋转 a ，我该`UIImageView`怎么办？我有一个`UIImage`我想旋转 20 度的。

Apple 文档讨论了转换矩阵，但这听起来很困难。是否有任何有用的方法或功能来实现这一目标？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2012-03-15T10:46:26.517

如果要向右转，该值必须大于 0 如果要向左旋转表示该值带有符号“-”。例如-20。

```
CGFloat degrees = 20.0f; //the value in degrees
CGFloat radians = degrees * M_PI/180;
imageView.transform = CGAffineTransformMakeRotation(radians); 
```

斯威夫特 4：

```
let degrees: CGFloat = 20.0 //the value in degrees
let radians: CGFloat = degrees * (.pi / 180)
imageView.transform = CGAffineTransform(rotationAngle: radians) 
```

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2009-05-12T13:47:08.433

转换矩阵并不是非常困难。如果您使用提供的功能，这很简单：

```
imgView.transform = CGAffineTransformMakeRotation(.34906585); 
```

（.34906585 是 20 度的弧度）

* * *

斯威夫特 5：

```
imgView.transform = CGAffineTransform(rotationAngle: .34906585) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-11-28T09:22:16.607

**斯威夫特版本：**

```
let degrees:CGFloat = 20
myImageView.transform = CGAffineTransformMakeRotation(degrees * CGFloat(M_PI/180) ) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-10-31T09:09:05.353

**斯威夫特 4.0**

```
imageView.transform = CGAffineTransform(rotationAngle: CGFloat(20.0 * Double.pi / 180)) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-25T15:38:12.897

这是 Swift 3 的扩展。

```
extension UIImageView {

    func rotate(degrees:CGFloat){
        self.transform = CGAffineTransform(rotationAngle: degrees * CGFloat(M_PI/180))
      }  
    } 
```

用法：

```
myImageView.rotate(degrees: 20) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-04T09:55:33.117

```
_YourImageView.transform = CGAffineTransformMakeRotation(1.57);

```

其中 1.57 是 90 度的弧度值

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-01-20T16:19:29.333

这是一个更简单的格式化示例（20 度）：

```
CGAffineTransform(rotationAngle: ((20.0 * CGFloat(M_PI)) / 180.0)) 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-05-12T13:46:04.987

据我所知，在`UIAffineTransform`没有第三方框架帮助的情况下，使用矩阵是实现旋转的唯一方法。

# windows-vista - 禁用每个应用程序的 Vista UAC，或者在没有提示的情况下提升权限？

> ID：852867
> 
> 赞同：4
> 
> 时间：2009-05-12T13:45:07.220
> 
> 标签：windows-vista, uac

我有一个普通用户需要能够运行的应用程序，但需要管理员权限才能实际运行。

我试图让我的用户使用“以管理员身份运行”来运行它的快捷方式，但这只会在他们尝试运行应用程序时导致 UAC 提示。

有没有办法以编程方式提升权限，而我的用户无需通过 UAC 提示和/或知道管理员密码？从安全的角度来看，我知道大多数应用程序不应该被允许这样做，所以我希望如果我可以提供有效的用户名/密码对或其他东西，有一些方法可以做到这一点。

该应用程序是用 C# 编写的，因此最好使用完全托管的解决方案，但是**p/Invoke Black Magic**（甚至编写**我们不谈论的 MC++ 包装器**）比完全禁用 UAC*更*容易接受。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T13:51:18.610

通常，通过安装以 SYSTEM 或管理员帐户运行的 Windows 服务来解决此问题。然后您的应用程序可以从该服务请求特权操作。

显然，为了不构成安全威胁，请确保您的服务不能运行任意代码或可能使所有用户容易受到特权升级攻击的东西。

*Winpcap 和大多数其他嗅探应用程序使用类似的设计来为非特权用户提供嗅探访问权限。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-21T08:14:01.633

实际上，您为什么不创建一个以提升的权限运行应用程序的任务计划？只要您在提升下设置任务，它就不会在重新启动期间自动运行时提示您输入 UAC，或者无论您的触发器是什么。

只需确保您在清单文件中设置 level=requireElevation，任务调度程序就会以管理员权限运行您的应用程序，而不会提示您的用户提供管理员权限，因为在您使用管理员权限设置任务时已经建立了这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T03:36:05.543

这是不可能的。您不能决定禁止 UAC 提示。

你必须问自己：

> 在 Windows XP 上会发生什么？

用户是 Windows XP 上的标准用户，应用程序*“需要”*以管理员身份运行。你是：

*   会拒绝跑步吗？
*   启动时会崩溃？
*   将显示用户访问被拒绝的错误消息？

如果用户根本不允许在 Windows XP 上作为标准用户运行应用程序，那么 UAC 就是您的朋友：它**告诉**用户他们必须是管理员。

它甚至提供让他们（*暂时*）获得管理权限。

但你必须问自己：

> 在 Windows Vista 上会发生什么？

为了提升，用户需要 IT 部门的人从三座建筑物上走过，这样他们就可以“在肩膀上”输入他们的凭据。也许你可以让用户的生活更轻松。让 99.9% 的应用程序运行，并将这 0.01% 拆分为“管理”模块。

# wpf - ListView 列的 MinWidth

> ID：852872
> 
> 赞同：3
> 
> 时间：2009-05-12T13:46:28.980
> 
> 标签：wpf, xaml

如何`MinWidth`在 WPF 中指定 Listview 列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T12:43:36.517

此代码使用 Thumb 控件。它将阻止用户仅以指定的宽度拖动标题。

将此添加到您的 WPF 中

```
<ListView x:Name="MyListView"
          IsSynchronizedWithCurrentItem="True" 
          ItemsSource="{Binding Path=Items,  
                                Mode=Default, 
                                Source={StaticResource DataProvider}}"
          Thumb.DragDelta="Thumb_DragDelta"> 
```

在 C# 中做为

```
public Window1() 
{  
  InitializeComponent();  
  MyListView.AddHandler(Thumb.DragDeltaEvent,new DragDeltaEventHandler(Thumb_DragDelta),true);
}
void Thumb_DragDelta(object sender, DragDeltaEventArgs e)
{ 
  Thumb senderAsThumb = e.OriginalSource as Thumb;  
  GridViewColumnHeader header = senderAsThumb.TemplatedParent as GridViewColumnHeader; 
  if (header.Column.ActualWidth < MIN_WIDTH)     
    header.Column.Width = MIN_WIDTH;   
  if (header.Column.ActualWidth > MAX_WIDTH)
    header.Column.Width = MAX_WIDTH;
} 
```

# sql-server - 使用月份值设置日期的有效方法

> ID：852873
> 
> 赞同：0
> 
> 时间：2009-05-12T13:46:30.243
> 
> 标签：sql-server, sql-server-2005, datetime, date

我在 sql 中有一个月的一周，我需要从中生成一个日期时间变量。我拥有的字段是 dayofweek、weekofmonth 和月份值。有人知道在 mssql 2005 中快速有效的计算方法吗？谢谢

记住。如果月份的周数设置为 5，则表示该月的最后一周

例如我有 DayOfWeek、month、year、weekofmonth..

所以可以说我有 DayOfWeek = 2（星期一）月 = 5（可能）年 = 2009 weekofmonth = 5

我预计 2009 年 5 月 25 日星期一

DayOfWeek = 1，月 = 5，周 = 1，年 = 2009 = 2009 年 5 月 3 日，星期日

DayOfWeek = 5, Month = 4, Week = 3, Year = 2009 = 2009 年 4 月 16 日星期四

附加信息：

我正在使用 .net TimezoneInfo.TransitionTime 类库来帮助我在数据库中存储一些东西。他们说：

**Month 属性定义时间更改发生的月份。Day 属性定义发生转换的星期几。Week 属性确定时间更改发生在每月的哪一周。Week 属性的有效值范围为 1 到 5。值 5 表示该月的最后一周。**

到目前为止，我有这个：

```
declare @IsFixedDateRule    bit
declare @Day                tinyint
declare @DayOfweek          tinyint
declare @Week               tinyint
declare @Month              tinyint
declare @Year               int
declare @TimeofDay          int -- SECONDS

set @IsFixedDateRule = 0
set @Day = 1
set @DayOfweek = 1
set @Week = 5
set @Month = 4
set @year = 2008
set @TimeofDay = 7200

declare @date datetime

if (@IsFixedDateRule = 1)   
begin
    set @date = convert(char(4),@Year) + '/' + convert(char(2),@Month) + '/' + convert(char(2),@Day)  -- Set Year/Month
end
else
begin       
    set @date = convert(char(4),@Year)  + '/' + convert(char(2),@Month) + '/01' -- Set Year/Month

    declare @datepart tinyint
    set @datepart = datepart(weekday ,@date)    

    set @date = dateadd(week, @week - 1, dateadd(weekday, @Dayofweek - case when @datepart = 7 then 0 else @datepart end, @date))-- get the day

end

select dateadd(second, @TimeofDay,  @date) -- Add Time Of Day 
```

有什么更清洁的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T14:04:18.053

这相当简单，实际上只是在该月的第一天增加了几天和几周。它假设您使用的是当前年份，并且不会真正处理像二月的第 5 周这样的事情。（例如：第 5 周，2 月的第 3 天给出 03/11/2009）

```
DECLARE @CalculatedDate DATETIME;

-- Assuming DayOfWeek and WeekOfMonth are 1-based
SELECT @CalculatedDate = DATEADD(DAY, @DayOfWeek - 1, DATEADD(WEEK, @WeekOfMonth - 1, '2009-' + STR(@Month) + '-01'));

-- Assuming DayOfWeek and WeekOfMonth are 0-based
SELECT @CalculatedDate = DATEADD(DAY, @DayOfWeek, DATEADD(WEEK, @WeekOfMonth, '2009-' + STR(@Month) + '-01')) 
```

它还假设该月的第一天 DayOfWeek == 1，所以它几乎肯定是错误的。我们可以看到一些样本数据和预期输出吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T14:03:06.013

五月的第一周从星期五开始。那么 dayofweek=1、weekofmonth=1、month=5 是哪一天呢？是 4 月 27 日星期一吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T14:18:42.457

**编辑**- 修改以处理不同的值`@@datefirst`

我的猜测是基于目前可用的数据。

如果您的 SQL Server 安装`@@datefirst`设置为星期日 (7) 或星期一 (1)，这将起作用。

测试数据设置为返回 01-May-2009

```
declare @dayofweek int
declare @weekofmonth int
declare @month int
declare @datefirst_adjustment int

select @datefirst_adjustment = case @@datefirst when 1 then 0
                                                when 7 then 1
                               end

declare @firstofyear datetime

set @firstofyear = '20090101'

set @dayofweek = 5

set @month = 5

set @weekofmonth = 1

select dateadd(ww,@weekofmonth - 1,dateadd(mm,@month - 1,@firstofyear)) - datepart(dw,dateadd(mm,@month - 1,@firstofyear)) + @dayofweek + @datefirst_adjustment 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T14:37:53.713

```
/* 
 * Assuming @year is this year
 *          @day_of_week starts from Sunday = 1, Monday = 2 etc
 */
declare @week_of_month int,
        @day_of_week int,
        @month int,
        @year int,
        @derived_date datetime

set dateformat dmy
select @year = datepart(year, getdate()),
       @day_of_week = 2,
       @week_of_month = 2,
       @month = 5

select @derived_date = convert(varchar,@year) + '-01-' + convert(varchar,@month) 
select @derived_date
select @derived_date = dateadd(dd, @day_of_week - datepart(dw, @derived_date), dateadd(week, @week_of_month-1,  @derived_date))
select @year, @month, @day_of_week, @week_of_month, @derived_date

/* Test */
declare @date datetime

set @date = '04-MAY-2009'
select @date, cast(datename(week,@date) as int)- cast( datename(week,dateadd(dd,1-day(@date),@date)) as int)+1 week_of_month, datepart(dw, @date) day_of_weekhere 
```

# objective-c - 如何将 Cocoa 坐标从左上角 == 原点转换为左下角 == 原点

> ID：852875
> 
> 赞同：11
> 
> 时间：2009-05-12T13:46:57.013
> 
> 标签：objective-c, cocoa, nswindow

我使用 CGWindowListCopyWindowInfo 来获取所有窗口的列表。**它根据屏幕左上角**的原点为我提供每个窗口的坐标。

如果我使用 NSWindow 的 setFrame 方法，则坐标基于屏幕**左下角的原点。**

什么是从一种转换到另一种的干净、可靠的方法？

补充：干净和可靠，我的意思是，无论用户是否有多个屏幕或正在使用 Spaces，某些东西都可以正常工作。我认为必须有一个使用库 API 的已知习语。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-12T13:58:40.797

数学相当可靠:-)

```
yFromBottom = screenHeight - windowHeight - yFromTop 
```

主屏幕高度为

```
[[[NSScreen screens] objectAtIndex:0] frame].size.height 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T14:00:59.387

我建议使用 NSAffineTransform。如果您相对于默认原点进行绘制，然后对视图应用变换，您基本上可以一举翻转事物。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T13:59:44.287

尝试这样的事情（[从这里](http://groups.google.com/group/mozilla.dev.tech.plugins/browse_thread/thread/fe4d08d63555797b)）：

```
NSRect boundsInWindow = [myView convertRect:[myView bounds] toView:nil];
NSRect visibleRectInWindow = [myView convertRect:[myView visibleRect] toView:nil];

// Flip Y to convert NSWindow coordinates to top-left-based window coordinates.
float borderViewHeight = [[myView window] frame].size.height;
boundsInWindow.origin.y = borderViewHeight - NSMaxY(boundsInWindow);
visibleRectInWindow.origin.y = borderViewHeight - NSMaxY(visibleRectInWindow); 
```

# iphone - 灵活设计 iPhone App 布局重要吗？

> ID：852881
> 
> 赞同：4
> 
> 时间：2009-05-12T13:48:34.577
> 
> 标签：iphone, cocoa-touch, uikit

我想知道在用固定值在 neb 中设置视图的高度时是否会遇到麻烦。

示例：状态栏的高度是已知的。是20个单位。那么在制作一个界面不错的视图时，当用户在使用 App 时接听电话，并且状态栏的高度增加了会发生什么？或者如果苹果在未来的某一天改变状态栏或标签栏的高度会怎样？

您是否总是为包含所有界面元素的容器视图使用自动调整大小功能？你的模式是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T14:08:39.043

我会避开程序中状态栏、工具栏等高度的硬编码值。您提供了一些很好的例子来说明这些值是如何动态变化的，并且在未来会发生变化。您可能支持也可能不支持的另一种常见情况是用户将 iPhone 旋转到横向的能力。

我总是**尽量**保持容器子视图的布局灵活。使用自动调整大小功能是一个好方法。你的问题是一个很好的问题，我认为它会让我重新审视自己的布局策略！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T13:52:45.783

我总是使用自动调整大小的灵活布局，因为这让我可以专注于设计并让计算机计算出数学。

[编辑] 我的原因是有些事情会发生变化，在这种情况下我不想再做数学了。可以改变的事情：

*   用户可能会选择更大的字体
*   下一代设备获得更大的屏幕
*   当翻译人员必须将单词放入像素紧密的空间中时，他们讨厌它
*   加载项可能会占用屏幕上的几个像素
*   操作系统的变化可能会使屏幕大小改变几个像素
*   当我使用预定义的图标时，它们的大小可能会改变
*   最终，在一个灵活的应用程序中，用户可以选择她想看的内容。我不希望她必须布局 UI。

因此，如果您将布局设为静态，您最终将不得不再次这样做。然后再次。直到您了解到软件开发中唯一不变的就是变化。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T14:24:22.210

好吧，我在这里有点冒险，但我认为硬编码布局尺寸的想法（今天，在 iPhone 上，以像素为单位）理论上可能会给你带来麻烦（或者至少需要额外的工作）在将来。

我不太担心它们会改变状态栏、默认标签栏或导航栏的外观大小……我担心单位会发生变化。我不是注册的 OS X 开发人员，但长期以来一直有传言称，Snow Leopard 将支持一种独立于分辨率的方式来指定接口，而不是基于像素。

它不会在明天、3.0 甚至明年发生，但这种独立于分辨率的界面的想法将适用于 iPhone，尤其是在未来显示尺寸（更具体地说，显示分辨率）发生变化时.

我很啰嗦，但我关心的不是状态栏的大小，而是设备的大小，以及我们在 Cocoa Touch 中用于指定大小的单位。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T15:12:22.943

需要考虑的一件事：如果用户接到电话，然后在通话期间启动应用程序，状态栏的高度会发生变化。所以绝对有必要避免在系统 UI 元素的高度进行硬编码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T15:15:37.513

Theres a "constants.h" in the UICatalog sample, but it's local to that sample and is clearly just a way for the sample developer to make his/her life easier. It carries with it all the problems mentioned above ... if anything changes the "standard sizes" in the future, this sample stops working properly.

It sucks to have to query other objects to get your placement right, but it's how you ensure things work properly when the environment changes. The expanding "in-call" status bar is a perfect example. If you hard-code 20 "units" to avoid the status bar, your app breaks while in a call. And, that's something you're not likely to notice in the simulator (because, if you thought about it enough to try that option in the simulator, you probably would have thought about it while coding the app!)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T14:20:49.143

**Apple 提供的文件“Constants.h”中不存在大多数这些大小吗？（我刚刚注意到它是 UICatalog SDK 示例的一部分）。**

我认为苹果很可能会在某个时候推出另一款屏幕更大或更小的设备。所以它们应该与 [UIScreen frame/bounds] 一起使用；

```
// these are the various screen placement constants used across all the UIViewControllers

// padding for margins
#define kLeftMargin             20.0
#define kTopMargin              20.0
#define kRightMargin            20.0
#define kBottomMargin           20.0
#define kTweenMargin            10.0

// control dimensions
#define kStdButtonWidth        106.0
#define kStdButtonHeight        40.0
#define kSegmentedControlHeight 40.0
#define kPageControlHeight      20.0
#define kPageControlWidth      160.0
#define kSliderHeight            7.0
#define kSwitchButtonWidth      94.0
#define kSwitchButtonHeight     27.0
#define kTextFieldHeight        30.0
#define kSearchBarHeight        40.0
#define kLabelHeight            20.0
#define kProgressIndicatorSize  40.0
#define kToolbarHeight          40.0
#define kUIProgressBarWidth    160.0
#define kUIProgressBarHeight    24.0

// specific font metrics used in our text fields and text views
#define kFontName               @"Arial"
#define kTextFieldFontSize      18.0
#define kTextViewFontSize       18.0

// UITableView row heights
#define kUIRowHeight            50.0
#define kUIRowLabelHeight       22.0

// table view cell content offsets

#define kCellLeftOffset          8.0
#define kCellTopOffset          12.0 
```

托尼

# jquery - 如何在 Stackoverflow 中显示弹出消息

> ID：852882
> 
> 赞同：5
> 
> 时间：2009-05-12T13:48:35.060
> 
> 标签：jquery, popup

**完全重复：[如何在 stackoverflow 中显示弹出消息](https://stackoverflow.com/questions/659199/how-to-show-popup-message-like-in-stackoverflow)**

或者

**[我将如何实现 stackoverflow 的悬停对话框？](https://stackoverflow.com/questions/758906/how-would-i-implement-stackoverflows-hovering-dialogs)**

[替代框 http://img266.imageshack.us/img266/8226/boxt.jpg](http://img266.imageshack.us/img266/8226/boxt.jpg)

当用户在 jquery 的帮助下单击某个链接时，我正在尝试构建这种类型的信息框。请帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T13:56:44.263

jQuery UI 的[对话框](http://jqueryui.com/demos/dialog/)可能就是您所追求的。

# java - new Date("05-MAY-09 03.55.50") 这有什么问题吗？我得到了非法ArgumentException

> ID：852887
> 
> 赞同：0
> 
> 时间：2009-05-12T13:49:17.290
> 
> 标签：java

```
new Date("05-MAY-09 03.55.50") 
```

这有什么问题吗？我得到了非法ArgumentException

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-12T13:54:29.213

由于某种原因，不推荐使用该[Date 构造函数。](http://java.sun.com/javase/6/docs/api/java/util/Date.html#Date(java.lang.String))

您应该使用[DateFormat](http://java.sun.com/javase/6/docs/api/java/text/DateFormat.html) / [SimpleDateFormat](http://java.sun.com/javase/6/docs/api/java/text/SimpleDateFormat.html)而不是从 String 表示创建 Date 实例。

```
DateFormat df = new SimpleDateFormat("dd-MMM-yy hh.mm.ss");
Date myDate = df.parse("05-05-MAY-09 03.55.50"); 
```

这样，您可以解析几乎任何您可能想要的格式的日期。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T13:54:31.520

除了您使用的是不推荐使用的方法（您应该使用[SimpleDateFormat](http://java.sun.com/j2se/1.4.2/docs/api/java/text/SimpleDateFormat.html)代替）之外，这应该有效：

```
 new Date("05-MAY-09 03:55:50"); 
```

还可以查看[Joda Time](http://joda-time.sourceforge.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T13:53:42.897

使用冒号分隔小时、分钟和秒：“05-MAY-09 03:55:50”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T13:54:27.217

该构造函数已被弃用（自 jdk 1.1 起）。

它甚至在 java5 中都无效

[http://java.sun.com/j2se/1.5.0/docs/api/java/sql/Date.html](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/Date.html)

你应该

```
SimpleDateFormat sdf = new SimpleDateFormat(DATE_FORMAT);
Date date = sdf.parse("05-MAY-09 03:55:50"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T13:55:17.777

不要使用这种方法，因为它已被弃用多年（和多年）。使用 DateFormat.parse() ，您可以在其中轻松定义要解析的格式。

# asp.net-ajax - MS Ajax 工具包现在处于次要地位？

> ID：852888
> 
> 赞同：1
> 
> 时间：2009-05-12T13:49:49.097
> 
> 标签：asp.net-ajax, ajaxcontroltoolkit

标题的原因是工具包的最后一次更新发生在 2008 年 8 月。

[http://ajaxcontroltoolkit.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=16488](http://ajaxcontroltoolkit.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=16488)

Microsoft 是否不再有兴趣支持此产品？我刚刚发现了一个令人讨厌的错误，该错误导致 2 天的头发拉扯，这应该在几年前就标签进行修复。

有没有人了解他们未来的版本/错误修复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T14:02:09.213

如果您查看[Source Control](http://ajaxcontroltoolkit.codeplex.com/SourceControl/ListDownloadableCommits.aspx)选项卡，您会发现该项目非常活跃。您正在寻找的错误修复可能已经在 8 月到现在之间的某个时间进行了检查。

我建议通过签入或查看最新源的副本并尝试一下。

# jquery - 从 jQuery 文档加载 Google Analytics 准备好了吗？

> ID：852892
> 
> 赞同：6
> 
> 时间：2009-05-12T13:50:45.180
> 
> 标签：jquery, google-analytics

问题是 GA 有时需要一些时间来加载，而我的 jQuery ready() 函数在完成之前不会运行。我想将 GA 代码本身移到 ready() 函数的末尾。我不是在寻找额外的点击跟踪集成——我只是希望我的 ready() 脚本首先运行。

我的问题是：1）移动 GA 代码会以任何方式破坏他们的统计跟踪吗？而且，2）我是否需要模拟他们使用两个脚本标签（一个生成外部脚本标签，一个调用函数）？如果是这样，为什么，以及在 jQuery 函数中执行此操作的最佳方法是什么？

为了解释 #2，这是当前在结束 body 标记之前的 GA 代码：

```
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-8704511-1");
pageTracker._trackPageview();
} catch(err) {}</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T15:12:00.477

这里有一个类似的问题：

*   [如何动态加载谷歌分析（JavaScript）？](https://stackoverflow.com/questions/753514/how-to-dynamically-load-google-analytics-javascript)

这里接受的答案是：

*   [更好的 Google Analytics JavaScript，不会阻止页面下载](http://liveweb.archive.org/web/20121005211251/http://lyncd.com/2009/03/better-google-analytics-javascript/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-02-25T16:10:44.157

看起来 Google 也解决了这个问题 - 请参阅这个更新的[Stack Overflow 问题](https://stackoverflow.com/questions/399359/possibility-of-jquery-document-ready-function-taking-a-very-long-time-to-execut)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T14:15:17.127

之所以有两个脚本块，是因为第一个块中的脚本在两个块之间插入了对 Google Analytics javascript 文件的引用。如果它们都在同一个块中，则跟踪器将在加载之前尝试初始化。所以#2 绝对正确，您需要拥有或模拟两个脚本标签。

# java - Java 套接字编程 - 地址已在使用中 (errno=98)

> ID：852896
> 
> 赞同：2
> 
> 时间：2009-05-12T13:51:20.890
> 
> 标签：java, sockets

我正在尝试编写一个基本的服务器-客户端 java 应用程序。但是，无论我使用什么端口，我总是收到“10 端口 13244 的套接字绑定失败：地址已在使用 (errno=98)”错误消息。

我附上了我的应用程序的源代码，只是想知道我是否犯了非常愚蠢的错误。

非常感谢！

干杯，J

```
/**
 * Command process test.
 */

import java.net.*;
import java.io.*;

public class CommandProcessTest implements Runnable{
  private static final int PORT = 13244;
  private ServerSocket serverSocket;

  public static void main(String[] args) {
    CommandProcessTest test = new CommandProcessTest();

    System.out.println("starting server.");
    test.start();
    System.out.println("server start up.");

//     try {
//       test.wait(100);
//     } catch(InterruptedException e) {
//     }

//     Thread client = new Thread(test);

    System.out.println("Server start receiving.");
    test.start();
    System.out.println("Server exit.");
  }

  private void start() {
    try {
      serverSocket = new ServerSocket(PORT);
    } catch (IOException e) {
      System.out.println("Could not listen on port: 4444");
      System.exit(-1);
    }
  }

  private void server() {
    Socket clientSocket = null;

    try {
      clientSocket = serverSocket.accept();
      CommandProcess cp = new CommandProcess(clientSocket);

      int cmd = 10;
      String arg = "";
      cp.sendCommand(cmd);

      arg = "hello";
      cp.sendCommand(cmd, arg.split(" "));

      arg = "hello world";
      cp.sendCommand(cmd, arg.split(" "));

      arg = "world hello world";
      cp.sendCommand(cmd, arg.split(" "));

    } catch (IOException e) {
      System.out.println("Accept failed: 4444");
      System.exit(-1);
    }
  }

  private void client() {
    try {
      Socket socket = new Socket("localhost", PORT);
      CommandProcess cp = new CommandProcess(socket);

      while(true) {
        int cmd = cp.getCommand();
        String[] args = cp.getArguments();

        String s = "Command: " + Integer.toString(cmd);
        if(args != null) {
          for(int i = 0; i < args.length; i++) {
            if(args[i] == null) {
              break;
            }
            s += args[i];
          }
        }

        System.out.println(s);
      }

    } catch(IOException e) {
      System.out.println("Would not connect to local host: 444");
      System.exit(-1);
    }
  }

  public void run() {
    System.out.println("Starting client");
    client();
    System.out.println("Client startup.");
  }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-12T13:54:35.623

你做`start()`两次。您不能启动两个在同一端口上侦听的服务器。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-12T13:54:43.423

您调用 test.start() 两次，第二次将失败，因为第一次抓住了套接字。

# c# - Silverlight - TreeView 项目上方/下方的空间

> ID：852899
> 
> 赞同：0
> 
> 时间：2009-05-12T13:51:55.053
> 
> 标签：c#, silverlight, treeview

我正在尝试减少 TreeView 项目之间的空间量以更垂直地适应。我猜这是在 TreeView 中设置 ItemContainer Style 或 ItemContainer 模板的样式问题，但我似乎无法获得正确的属性。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T15:07:03.513

你是对的，你需要改变 TreeView 控件的 ItemContainerStyle 。

默认 TreeViewItem 样式的控件模板中的所有容器都设置为“自动”并拉伸以消耗项目内容所需的尽可能多的垂直空间。

您可以通过执行以下两项操作之一来强制执行此操作：

1.  通过改变 TreeView 的 ItemTemplate 来减小每一项内容的大小
2.  反转 TreeViewItem 的默认控件模板内的 Grid 上的 Margin。

下面是我为 TreeViewItem 创建的新控件模板的摘录。请注意我如何将 Margin 设置为“0,-4,0,-4”。这告诉内容在项目的顶部和底部减少 4 个像素，从而减少每个项目的垂直空间。

```
<ControlTemplate TargetType="controls:TreeViewItem">
    <Grid Background="{x:Null}" Margin="0,-4,0,-4">
        ... 
```

# asp.net-mvc-routing - 嵌套文件夹中的自定义 ASP.NET MVC 路由

> ID：852905
> 
> 赞同：6
> 
> 时间：2009-05-12T13:53:31.260
> 
> 标签：asp.net-mvc-routing

我想要我的 MVC 应用程序中的子文件夹，所以当前的路线不会削减它。

我有一个文件夹结构，例如

```
Views/Accounts/ClientBalances/MyReport.aspx 
```

我想要一个 URL，例如`http://myapp/Accounts/ClientBalances/MyReport`. 您如何通过映射路线实现这一目标？我有过狂欢，但我对他们不是很了解。我以为它会沿着

```
 routes.MapRoute( _
        "Accounts/ClientBalances", _
        "Accounts/ClientBalances/{controller}/{action}/{id}", _
        New With {.controller = "Home", .action = "Index", .id = ""} _
    ) 
```

我没有运气。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-11-30T15:50:38.413

看看 ASP.NET MVC 2 的**[领域](http://www.asp.net/learn/whitepapers/what-is-new-in-aspnet-mvc#_TOC3_2)**；它们看起来与您要实现的目标非常相似。[您可以在此处](http://www.asp.net/mvc/videos/aspnet-mvc-2-areas)观看介绍他们的 3 分钟快速视频。

如果您不能（或不想）使用它们，请查看有关嵌套视图文件夹的[答案。](http://forums.asp.net/p/1508860/3588122.aspx#3588122)总之：

> 您可以像这样返回适当的视图（来自操作方法）：
> 
> ```
> return View("~/Views/controllername/modulename/actionname.ascx", [optional model]); 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T19:59:50.280

视图的位置与路线无关。您的视图应该在 Views/[ControllerName]

# c# - 针对 C++ 和 C# 的代码生成工具

> ID：852909
> 
> 赞同：1
> 
> 时间：2009-05-12T13:54:23.847
> 
> 标签：c#, c++, code-generation

我有一组使用 C# 和 C++ 组合构建的应用程序。我们在两种语言之间有一组共享对象，与其在每种语言中分别定义每个对象，我更愿意使用代码生成工具。理想情况下，这样的工具应该是 FOSS，尽管这不是绝对要求。对象本身相对简单，尽管有从基类的继承、接口的实现、其他对象类型的包含以及其他对象类型的集合。

C++ 目标环境是 Visual C++ 2008。

有人对可以处理此类任务的工具有任何建议吗？

示例代码：

```
public class Tax 
{ 
private static Dictionary<string, double> _TaxRates; 
public Dictionary<string,double> TaxRates { get { return _TaxRates; } }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T14:04:30.253

对于任何代码生成问题，我都会仔细研究 T4（VS.NET 2008 中出现的文本模板功能）。

从 T4 开始的一个好地方是......

[http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)

您将需要 C++ 和 C# 的不同模板，并从其他一些元数据驱动您的代码生成。

另一种方法是使用 CodeDom API。这有两个可以针对每种语言的 CodeDomProvider（CppCodeProvider 和 CSharpCodeProvider）。

了解更多信息：

[http://msdn.microsoft.com/en-us/library/system.codedom.compiler.aspx](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.aspx)

SO上有一个相关链接：

[T4 vs CodeDom vs Oslo](https://stackoverflow.com/questions/491900/t4-vs-codedom-vs-oslo) [是否可以动态编译和执行 C# 代码片段？](https://stackoverflow.com/questions/826398/is-it-possible-to-dynamically-compile-and-execute-c-code-fragments)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T16:20:19.663

您还可以调查[CodeSmith](http://www.codesmithtools.com/)。您可以使用类似 asp.net 的语言编写模板来生成任何类型的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T14:51:50.860

[cog](http://nedbatchelder.com/code/cog/)是一个代码生成工具，可让您在 C++/C# 文件中嵌入代码生成 python 代码。它的优点是它真的很容易使用，特别是如果你已经了解 python。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T15:34:43.857

[Google Protobuf](http://code.google.com/p/protobuf/)可能是免费提供的最佳解决方案之一。

请参阅[语言页面](http://code.google.com/p/protobuf/wiki/OtherLanguages)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T15:11:42.310

我多次这样做的方式是定义我自己的 LL 语言并对其进行解析，并让它生成任何一种语言的类定义，或者用一种目标语言编写类定义，然后解析它们以生成另一种语言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-16T06:18:17.510

我强烈推荐使用 Ruby 作为代码生成器工具。

在 Ruby 中创建内部 DSL 并从中生成代码很容易。

我每天都使用 Ruby 来生成 C++ 和 C# 代码。它大大减少了我编写应用程序无聊/乏味部分所需的时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T14:09:13.160

用于发出源代码的 .Net 类，例如基类的`GenerateCodeFromCompileUnit`方法`CodeDomProvider`，可用于从单一定义发出各种语言的源代码：例如，有 a`CppCodeProvider`和`CSharpCodeProvider`. 它可能只是托管 C++，但您确实说过“相对简单”。

# c# - 如何使用 lambda 表达式创建扩展方法

> ID：852916
> 
> 赞同：7
> 
> 时间：2009-05-12T13:55:10.023
> 
> 标签：c#, lambda

目前我正在创建一个接受参数的扩展方法。使用下面的示例，如何使用 lambda 表达式进行转换？

```
public static decimal ChangePercentage(this IEnumerable<Trade> trades, DateTime startDate, DateTime endDate)
{
    var query = from trade in trades
                where trade.TradeTime >= startDate
                where trade.TradeTime <= endDate
                orderby trade.TradeTime descending
                select trade;
    return (query.First().Value - query.Last().Value) / query.First().Value * 100;
} 
```

使用 lambda 与普通方法参数的优缺点是什么？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T14:08:39.043

您可以更改示例以使用 lambda 表达式的一种方法是使用过滤器。

```
public static decimal ChangePercentage(this IEnumerable<Trade> trades, 
                                       Func<Trade,bool> pred)
        {
            var query = from trade in trades
                        where pred(trade);
                        orderby trade.TradeTime descending
                        select trade;
            return (query.First().Value - query.Last().Value) / query.First().Value * 100;
        }

    someTrades.ChangePercentage(x => x.TradeDate >= startDate && x.TradeTime <= endDate); 
```

这给你最大的好处是灵活性。而不是使用基于日期的过滤进行计算的方法。您有一种用于计算百分比的灵活过滤方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T14:05:45.087

您想用单个 lambda 表达式替换`startDate`and参数吗？`endDate`

```
public static decimal ChangePercentage(this IEnumerable<Trade> trades, DateTime startDate, DateTime endDate)
{
    return trades.ChangePercentage(trade => trade.TradeTime >= startDate 
        && trade.TradeTime <= endDate);
}

public static decimal ChangePercentage(this IEnumerable<Trade> trades, Func<Trade, bool> filter)
    {
        var query = from trade in trades
                    where filter(trade)
                    orderby trade.TradeTime descending
                    select trade;
        return (query.First().Value - query.Last().Value) / query.First().Value * 100;
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T14:01:23.193

您的方法已经隐式使用 lambda 表达式。

当你说

```
trade.TradeTime >= startDate 
```

你真正想说的是“给定一个`Trade`被调用的” “，通过评估以下内容`trade`返回一个： 。”`bool``trade.TradeTime >= startDate`

这就是这个 lambda 表达式的定义：

```
Func<Trade, bool> expr = (trade => trade.TradeTime >= startDate); 
```

事实上，减去 的声明`expr`，如果您使用 LINQ 的函数组合语法而不是查询语法，这就是您将如何表达它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T14:11:00.223

如果不需要参数，可以将过滤移到外面。

```
public static decimal ChangePercentage(this IEnumerable<Trade> trades)
{
  var query = trades.OrderByDescending(t => t.TradeTime);

  if (query.Any())
    return (query.First().Value - query.Last().Value) / query.First().Value * 100;
  else
    return 0;
} 
```

然后，它可以这样调用：

```
DateTime startDate, DateTime endDate

decimal answer = ChangePercentage
(
  from trade in trades
  where trade.TradeTime >= startDate
  where trade.TradeTime <= endDate
  select trade
); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T14:13:06.570

继续[Tim 的回答](https://stackoverflow.com/questions/852916/c-how-to-create-extension-methods-with-lambda-expressions/852961#852961)，您还可以提供一个 lambda 来执行计算：

```
 public static decimal ChangePercentage(
        this IEnumerable<Trade> trades, 
        Func<Trade, bool> filter, 
        Func<Trade, Trade, decimal> calc)
    {
        var query = from trade in trades
                    where filter(trade)
                    orderby trade.TradeTime descending
                    select trade;
        return calc(query.First(), query.Last());
    } 
```

用法：

```
 trades.ChangePercentage(
        trade => (trade.TradeTime >= startDate && trade.TradeTime <= endDate), 
        (t1, t2) => (t1.Value - t2.Value) / t1.Value * 100
    ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T14:19:01.333

理解 Lambda 表达式的用途与扩展方法不同，这一点很重要。Lambda 表达式主要用作定义委托实现或函数实现的紧凑语法。lambda 表达式的另一个好处是您可以在另一个函数的主体中定义事件处理程序和函数，如果您有一个仅在特定方法中使用的简单函数，这很有用。只需使用具有 lamda 语法的 Func<> 或 Action<> 类型定义函数。

我建议您阅读 Jon Skeet 的 C# In Depth。它详细介绍了这些主题。

这是作为 lambda 表达式的函数

```
private void Form1_Load(object sender, EventArgs e)
        {
            //signature of our function
            Func<IEnumerable<Trade>, DateTime, DateTime, decimal> changePercentage = null;

            //function implemented using lambda expression syntax
            changePercentage += (trades, startDate, endDate) => 
            {
                var query = from trade in trades
                            where trade.TradeTime >= startDate
                            where trade.TradeTime <= endDate
                            orderby trade.TradeTime
                            descending
                            select trade;
                return (query.First().Value - query.Last().Value) / query.First().Value * 100;
            };
        } 
```

# ms-word - Microsoft Word 中书签名称的限制是什么？

> ID：852922
> 
> 赞同：9
> 
> 时间：2009-05-12T13:58:02.670
> 
> 标签：ms-word, bookmarks

我需要根据段落名称为文档的某些部分添加书签，但段落名称并不总是书签名称的有效名称。我没有在 Google 或 MSDN 上找到关于书签名称限制的详尽列表。

禁止使用哪些特殊字符？

我唯一发现的是长度不能超过 40 个字符。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-12T14:05:53.450

如果您熟悉正则表达式，我会说它是

```
^(?!\d)\w{1,40}$ 
```

where`\w`指 Unicode 单词字符的范围，也包含下划线和 0-9 的数字。

简而言之：书签名称必须...

*   长度在 1 到 40 个字符之间
*   由 Unicode 字母、数字、下划线的任意组合组成
*   *不*以数字开头
*   *不*包含任何类型的空格或标点符号

如评论中所述，以下划线开头的书签名称被视为*hidden*。它们不会出现在常规用户界面中，但可以从 VBA 代码中使用。无法通过常规用户界面创建以下划线开头的书签，但您可以通过 VBA 代码使用`Bookmarks.Add()`.

# jquery - JQuery datepicker 初始化选择器/字段

> ID：852932
> 
> 赞同：2
> 
> 时间：2009-05-12T14:00:28.373
> 
> 标签：jquery, datepicker

是否可以使用与使用日期选择器选择相同格式的日期填充输入字段？例如，在我使用 datepicker 选择日期之前，我的输入字段中有一个值（例如 new Date()），并且我希望它具有与我选择它相同的格式。

谢谢

库库达斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T14:04:56.460

查看[演示站点](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/datePickerDefaultToday.html)，new Date().asString() 用于选择今天，它的格式与预期的一样。

```
$('.date-pick').datePicker().val(new Date().asString()).trigger('change'); 
```

编辑：

您必须确保正确设置 Date.format。这是德语日期格式的一个工作示例：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>jQuery datePicker simple datePicker demo</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/date.js"></script>
    <script type="text/javascript" src="http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/jquery.datePicker.js"></script>
    <link rel="stylesheet" type="text/css" media="screen" href="http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/styles/datePicker.css">

    <script type="text/javascript" charset="utf-8">

        Date.format = 'dd.mm.yyyy';

        $(function(){
            $('.date-pick').datePicker()
                .val(new Date().asString()).trigger('change');
        });
    </script>
</head>
<body>
    <label for="date1">Date 1:</label>
    <input name="date1" id="date1" class="date-pick" />
</body>
</html> 
```

请注意，脚本[http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/date.js](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/scripts/date.js)扩展了 Date.prototype 并将“Date.format”设置为“dd/mm/yyyy”。我用'dd.mm.yyyy'覆盖了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T14:09:56.000

我不确定我是否真的理解问题所在？

```
$(document).ready(function() {
    $('#date_field').datepicker({
        dateFormat: 'yy-mm-dd',
        constrainInput: false});
}); 
```

并且在您拥有的输入字段中只有一个标准值：

```
<input name="date_field" id="date_field" value="2008-04-16" /> 
```

或者你可以在 document.ready 中设置值

```
$('#date_field').val("2008-04-16"); 
```

添加日期选择器后。我不确定这是不是你的意思？

好的，在您发表评论后，我感觉您想要类似的东西：

```
var my_date = new Date(); //This is the Date object that you're getting from external source
$('#date_field').val(my_date.getFullYear()+"/"+my_date.getMonth()+"/"+my_date.getDate()); 
```

这应该将字段中的值设置为 2008/04/26 （或其他）

# c# - 当 Session.Abandon() 不起作用时，如何以编程方式结束 asp.net 中的会话？

> ID：852942
> 
> 赞同：15
> 
> 时间：2009-05-12T14:02:19.650
> 
> 标签：c#, asp.net, authentication, session, membership

Session.Abandon() 似乎没有做任何事情。您会期望 Session_end 事件在 Session.Abandon() 被调用时触发。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-12T14:07:04.490

这很可能是因为您*不是*`SessionMode`（唯一可以检测到会话何时结束的人）。 *`InProc`*

 *引用自[MSDN](http://msdn.microsoft.com/en-us/library/ms178581.aspx)：

> **会议活动**
> 
> ASP.NET 提供了两个事件来帮助您管理用户会话。Session_OnStart 事件在新会话开始时引发，Session_OnEnd 事件在会话被放弃或到期时引发。会话事件在 ASP.NET 应用程序的 Global.asax 文件中指定。
> 
> 如果会话模式属性设置为默认模式 InProc 以外的值，则不支持 Session_OnEnd 事件。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-12T14:05:41.500

Session.Abandon() 是结束会话的方式。您遇到的问题是什么？

如果它的后退按钮相关，那是一个完全不同的问题（页面不会在后退时回发，而是从客户端缓存运行一个，因此不会执行服务器端方法）。

此外，Session_End 是有问题的。它只会在使用 InProc 会话时在 Session.Abandon() 上触发，因此如果您使用不同的会话模式，则不能依赖它。否则， Session_End 将在达到 SessionTimeout 时触发（我相信默认为 20 分钟，在 Web.Config 中配置）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T14:08:17.937

您是否尝试过使用以下内容？

```
System.Web.Security.FormsAuthentication.SignOut(); 
```

这将清除用于表单身份验证的 cookie，尽管可能不是您想要的。

您可能需要在 Session.Abandon() 之外使用它

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T19:35:05.930

如果会话似乎持续存在，您可以尝试（在 web.config 中）：

```
<sessionState regenerateExpiredSessionId="true"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T14:22:03.480

这取决于，如果您的应用程序位于 2 个服务器上：1 个 WebApplication 有自己的会话，第二个 WS 或 WCF 应用程序也有自己的会话，它在我曾经工作过的应用程序中的情况如何。如果你有这种情况，会话必须在第二点结束，第一个结束时会出现超时。至少您必须使用令牌并保留令牌列表和活动会话。可能是你的情况。祝你好运。PS。要终止会话，请在第二台服务器中管理它。

# git - 如何更改使用 git describe 时给出的标签？

> ID：852943
> 
> 赞同：1
> 
> 时间：2009-05-12T14:02:32.800
> 
> 标签：git, tags

我想使用“git describe”来获取应用程序的“修订号”。不幸的是，git 存储库是使用 cvs-import 创建的，并且有一个丑陋的旧标签，所以我想更改它。

如何更改使用“git describe”时给出的标签？

注意：我今天在 IRC 上问了这个问题，最后自己找到了答案。认为它可能对其他人也有用。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T14:06:12.387

```
#create a new anotated tag because by default git describes only looks for those
git tag -a NEWTAG

#push the new tags to the remote repository
git push --tags 
```

参考：http : [//www.kernel.org/pub/software/scm/git/docs/git-describe.html](http://www.kernel.org/pub/software/scm/git/docs/git-describe.html)

您可能也对此感兴趣： [如何通过 Qt 项目文件将命令的输出作为编译器标志传递？](https://stackoverflow.com/questions/852437/how-can-i-pass-the-output-of-a-command-as-a-compiler-flag-through-a-qt-project-fi)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-15T14:40:37.160

git describe 现在支持一个 --match 选项，可以过滤将要选择的标签

# jar - 包括一个非 Mavenized 依赖项，因此它可以与 maven-shade-plugin 一起使用

> ID：852952
> 
> 赞同：6
> 
> 时间：2009-05-12T14:04:21.907
> 
> 标签：jar, dependencies, maven-2, maven-shade-plugin

我想将不使用 Maven的[GData Client作为依赖项包含到我的 Maven 项目中。](http://code.google.com/p/gdata-java-client/)它作为一堆 JAR 文件提供。

另外，我使用[Maven Shade Plugin](http://maven.apache.org/plugins/maven-shade-plugin/)构建了一个没有任何外部依赖项的可执行 JAR（使用默认配置，没有重命名/包含/排除/转换依赖项）。

我怎样才能做到这一点？

（仅将 JAR 作为资源添加是行不通的，因为 Shade 插件必须提取它们）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T14:43:46.023

您想查看有关[安装 3rd 方 jar的 maven 文档](http://maven.apache.org/guides/mini/guide-3rd-party-jars-local.html)

一旦安装到本地 maven 存储库中，shade 应该能够像使用任何其他依赖项一样使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T14:53:28.250

如果您出于某种原因不想在存储库中安装 JAR，请参阅此答案：[在 Maven 中添加依赖项](https://stackoverflow.com/questions/396245/add-a-dependency-in-maven/765032#765032)

# java - 基于 Spring 3 (m3) 构建的 REST 完全注释服务的最低配置是什么？

> ID：852969
> 
> 赞同：6
> 
> 时间：2009-05-12T14:07:27.970
> 
> 标签：java, spring, tomcat, rest, jax-rs

我正在尝试公开一个完整的 REST 服务（由 Tomcat 托管），但无法弄清楚 Spring 3 (M3) 所需的配置是什么。

这就是（示例）服务的样子：

```
@Controller
@Scope("prototype")
public class UsersController
{
    @RequestMapping(value="/users/hello", method=RequestMethod.GET)
    public String hello()
    {
        return "hello, user!";
    }
} 
```

我的 Spring 配置如下所示（为简单起见，我省略了完整的类名）：

```
<beans ...>
    <context:annotation-config />
    <bean class="...AutowiredAnnotationBeanPostProcessor"/>
    <bean class="...DefaultAnnotationHandlerMapping">
    <context:component-scan base-package="com.mycompany.myserver"/>
</beans> 
```

这就是我将 Spring 配置插入 web.xml 的方式：

```
 <listener>
            <listener-class>...RequestContextListener</listener-class>
    </listener>
    <!-- Servlets -->
    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>...DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>classpath:*:dispatcher-servlet.xml</param-value>  
        </init-param>
        <load-on-startup>2</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>/services/*</url-pattern>
    </servlet-mapping> 
```

请注意，我正在尝试创建一个最小配置（没有额外的 servlet-config.xml 文件）。这就是我将 Dispatcher 指向内置配置的原因。

这个对吗？

启动 Tomcat 并加载所有 bean 后，我将导航到以下 URL：

```
http://localhost:8080/myserver/services/users/hello 
```

而且，而不是“你好，用户！” 回复，令我沮丧的是，我在日志文件中看到以下错误：

```
09:54:45,140 DEBUG RequestContextListener:69 - Bound request context to thread: org.apache.catalina.connector.RequestFacade@19299f5
09:54:45,140 DEBUG DispatcherServlet:834 - DispatcherServlet with name 'dispatcher' determining Last-Modified value for [/myserver/services/users/hello]
09:54:45,156 DEBUG DefaultAnnotationHandlerMapping:178 - Mapping [/users/hello] to handler 'com.symantec.repserver.myserver.UsersController@21447f'
09:54:45,171 DEBUG DispatcherServlet:850 - Last-Modified value for [/myserver/services/users/hello] is: -1
09:54:45,171 DEBUG DispatcherServlet:683 - DispatcherServlet with name 'dispatcher' processing GET request for [/myserver/services/users/hello]
09:54:45,218 DEBUG HandlerMethodInvoker:148 - Invoking request handler method: public java.lang.String com.symantec.repserver.myserver.UsersController.hello()
09:54:45,218 DEBUG DefaultListableBeanFactory:1366 - Invoking afterPropertiesSet() on bean with name 'hello, user!'
09:54:45,218 DEBUG DispatcherServlet:1060 - Rendering view [org.springframework.web.servlet.view.InternalResourceView: name 'hello, user!'; URL [hello, user!]] in DispatcherServlet with name 'dispatcher'
09:54:45,234 DEBUG InternalResourceView:237 - Forwarding to resource [hello, user!] in InternalResourceView 'hello, user!'
09:54:45,250 DEBUG DispatcherServlet:834 - DispatcherServlet with name 'dispatcher' determining Last-Modified value for [/myserver/services/users/hello, user!]
09:54:45,250 DEBUG DispatcherServlet:842 - No handler found in getLastModified
09:54:45,250 DEBUG DispatcherServlet:683 - DispatcherServlet with name 'dispatcher' processing GET request for [/myserver/services/users/hello, user!]
09:54:45,250  WARN PageNotFound:959 - No mapping found for HTTP request with URI [/myserver/services/users/hello, user!] in DispatcherServlet with name 'dispatcher'
09:54:45,250 DEBUG DispatcherServlet:643 - Successfully completed request
09:54:45,250 DEBUG DispatcherServlet:643 - Successfully completed request
09:54:45,250 DEBUG RequestContextListener:89 - Cleared thread-bound request context: org.apache.catalina.connector.RequestFacade@19299f5 
```

如您所见，我当前的配置正在尝试将此请求重新路由为新请求：

```
/myserver/services/users/hello, user! 
```

知道有什么问题吗？我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T22:40:27.343

问题是您的 hello() 方法被注释为 Spring 的 handlerMethod 并且根据 @RequestMapping 文档，处理程序方法可能会返回任意数量的对象，但如果它返回 String 那么：

[@Request 文档](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/web/bind/annotation/RequestMapping.html)

> 一个字符串值，它被解释为视图名称，模型通过命令对象和 ModelAttribute 注释的引用数据访问器方法隐式确定。处理程序方法还可以通过声明 ModelMap 参数以编程方式丰富模型（见上文）

所以它基本上是在寻找你返回 'hello, user' 的那个字符串的映射——它不存在。您可能让您的方法返回 void 并在方法内部自己写出 HttpServletResponse。

进一步回答：

```
@RequestMapping(value="/users/hello", method=RequestMethod.GET) 
public void hello(Writer w) { 
   w.write("hello, user!"); 
   w.flush(); 
   return; 
} 
```

您可能想要获取整个 HttpServletResponse 而不仅仅是 Writer，这样您就可以设置适当的 Http Headers。

对不起，我下面的评论很混乱，我是这个网站的新手。

# wpf - 多个项目时 GroupStyle 总和未更新

> ID：852973
> 
> 赞同：0
> 
> 时间：2009-05-12T14:08:16.627
> 
> 标签：wpf, listview, binding, grouping, converter

我已经成功地应用了[这里](https://stackoverflow.com/questions/678690/how-can-i-create-a-group-footer-in-a-wpf-listview-gridview)解释的技巧。但我还有一个问题。

快速回顾：我在 ListView 中显示用户。用户按国家/地区重新分组，在 GroupStyle DataTemplate 中，我使用转换器显示所有与组相关的 Users.Total 的总和。但 UI 用户可以通过模式窗口更改用户的“总计”属性值。

当组中只有一项时，显示的用户总数和总和都会正确更新。但是当组中有多个项目时，仅更新用户总数（通过绑定），但甚至不调用应该进行总和的转换器（TotalSumConverter）！

你知道它可能来自哪里吗？我应该使用某种触发器来确保在项目中有修改时调用转换器吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-11T16:28:16.917

问题是计算组中所有项目总和的值转换器在项目更改时不会运行，因为没有通知更改项目。一种解决方案是绑定到其他东西，您可以控制它如何进行通知并在需要时通知组头。

下面是一个工作示例。您可以在文本框中更改用户的计数，然后重新计算总数。

XAML：

```
<Window x:Class="UserTotalTest.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:userTotalTest="clr-namespace:UserTotalTest"
    Title="Window1" Height="300" Width="300"
    Name="this">

    <Window.Resources>

        <userTotalTest:SumConverter x:Key="SumConverter" />

        <CollectionViewSource Source="{Binding Path=Users}" x:Key="cvs">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="Country"/>
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>

    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="10" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <ListView 
            Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
            ItemsSource="{Binding Source={StaticResource cvs}}">
            <ListView.View>
                <GridView>
                    <GridView.Columns>
                        <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Path=Name}" />
                        <GridViewColumn Header="Count" DisplayMemberBinding="{Binding Path=Count}" />
                    </GridView.Columns>
                </GridView>
            </ListView.View>
            <ListView.GroupStyle>
                <GroupStyle>
                    <GroupStyle.ContainerStyle>
                        <Style TargetType="{x:Type GroupItem}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type GroupItem}">
                                        <StackPanel Margin="10">
                                            <TextBlock Text="{Binding Path=Name}" FontWeight="Bold" />
                                            <ItemsPresenter />
                                            <TextBlock FontWeight="Bold">
                                                <TextBlock.Text>
                                                    <MultiBinding Converter="{StaticResource SumConverter}">
                                                        <MultiBinding.Bindings>
                                                            <Binding Path="DataContext.Users" ElementName="this" />
                                                            <Binding Path="Name" />
                                                        </MultiBinding.Bindings>
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                             </TextBlock>
                                        </StackPanel>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </GroupStyle.ContainerStyle>
                </GroupStyle>
            </ListView.GroupStyle>
        </ListView>
        <ComboBox Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" 
            ItemsSource="{Binding Path=Users}"
            DisplayMemberPath="Name" 
            SelectedItem="{Binding Path=SelectedUser}" />
        <TextBlock Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Text="{Binding Path=SelectedUser.Country}" />
        <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding Path=SelectedUser.Count}" />
    </Grid>
</Window> 
```

后面的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Globalization;
using System.Linq;
using System.Windows;
using System.Windows.Data;

namespace UserTotalTest
{
    public partial class Window1 : Window
    {
        public Window1() 
        {
            InitializeComponent();

            DataContext = new UsersVM();
        }
    }

    public class UsersVM : INotifyPropertyChanged
    {
        public UsersVM()
        {
            Users = new List<User>();
            Countries = new string[] { "Sweden", "Norway", "Denmark" };
            Random random = new Random();
            for (int i = 0; i < 25; i++)
            {
                Users.Add(new User(string.Format("User{0}", i), Countries[random.Next(3)], random.Next(1000)));
            }

            foreach (User user in Users)
            {
                user.PropertyChanged += OnUserPropertyChanged;
            }

            SelectedUser = Users.First();
        }

        private void OnUserPropertyChanged(object sender, PropertyChangedEventArgs e)
        {
            if (e.PropertyName == "Count")
            {
                PropertyChanged(this, new PropertyChangedEventArgs("Users"));
            }
        }

        public List<User> Users { get; private set; }

        private User _selectedUser;
        public User SelectedUser
        {
            get { return _selectedUser; }
            set 
            {
                _selectedUser = value; if (PropertyChanged != null)
                {
                    PropertyChanged(this, new PropertyChangedEventArgs("SelectedUser"));
                }
            }
        }

        public string[] Countries { get; private set; }

        #region INotifyPropertyChanged Members
        public event PropertyChangedEventHandler PropertyChanged;
        #endregion
    }

    public class User : INotifyPropertyChanged
    {
        public User(string name, string country, double total)
        {
            Name = name;
            Country = country;
            Count = total;
        }

        public string Name { get; private set; }
        private string _country;
        public string Country
        {
            get { return _country; }
            set
            {
                _country = value;
                if (PropertyChanged != null)
                {
                    PropertyChanged(this, new PropertyChangedEventArgs("Country"));
                }
            }
        }

        private double _count;
        public double Count
        {
            get { return _count; }
            set
            {
                _count = value; if (PropertyChanged != null)
                {
                    PropertyChanged(this, new PropertyChangedEventArgs("Count"));
                }
            }
        }

        #region INotifyPropertyChanged Members
        public event PropertyChangedEventHandler PropertyChanged;
        #endregion
    }

    public class SumConverter : IMultiValueConverter
    {
        public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
        {
            IEnumerable<User> users = values[0] as IEnumerable<User>;
            string country = values[1] as string;
            double sum = users.Cast<User>().Where(u =>u.Country == country).Sum(u => u.Count);
            return "Count: " + sum;
        }

        public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T17:10:01.423

您使用的技巧将组页脚数据绑定到 ListView.Items 不会自动更新您的视图，例如 DependencyObject 所做的那样。而是在每次更新 Total 后强制刷新，如下所示：

```
CollectionViewSource viewSource = FindResource("ViewSource") as CollectionViewSource;
viewSource.View.Refresh(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-17T11:07:01.363

刷新视图的问题在于它完全刷新了它，并且我的分组有扩展器，即使用户关闭它们，它们也会扩展回原来的状态。所以是的，这是一种可能的解决方法，但并不完全令人满意。

您的 DependencyObject 解释也很有趣，但是，为什么当我的组中只有一个项目时它会起作用？

# macos - 回发页面时，asp.net 2.0 中的 viewstate MAC 失败

> ID：852982
> 
> 赞同：0
> 
> 时间：2009-05-12T14:08:58.980
> 
> 标签：macos, validation, asp.net-2.0, viewstate

我在 asp.net 2.0 中有一个带有默认会员提供程序的网站。到昨天还好好的。现在，当我在我的网站中添加自定义谷歌搜索框时，我收到相同的错误 Validation of viewstate MAC failed。如果此应用程序由 Web Farm 或集群托管，请确保配置指定相同的 validationKey 和验证算法。AutoGenerate 不能在集群中使用。我在网络上找到了一些解决方案，如果我们使用 service pack1 安装 .net 3.5，那么我们会收到这样的错误，然后卸载 3.5 或使用 Asp.net 2.0 安装 service pack 2 来解决问题。ASp.net 3.5 安装在我的电脑上，所以我卸载了它。但没有成功。请告诉我一个解决方案，以避免在 asp.net 2.0 中出现此类问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T14:20:50.547

您的自定义 google 搜索框是页面上的一个表单。您现在有两种形式，并且您应该只拥有一种以维持您的视图状态。

# flash - 使用 Flash 获取计算机信息

> ID：852983
> 
> 赞同：3
> 
> 时间：2009-05-12T14:09:07.530
> 
> 标签：flash, actionscript-3, actionscript

是否可以使用 Adob​​e Flash 检索计算机信息（RAM、硬盘大小、cpu 速度等）？如果是这样，有人可以将我指向一个向我展示如何操作的网站吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T14:37:24.727

我认为你无法获得 RAM、硬盘大小或时钟速度——Flash 在虚拟机中运行，它可能被设置为只为你提供与它的小世界有关的信息。

您可以获得很多其他的客户端信息，例如使用了多少 RAM Flash、屏幕分辨率以及客户端是否支持音频。查看[`System`](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/system/System.html)和[`Capabilities`](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/system/Capabilities.html)类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T17:18:00.043

如果您想了解客户端运行它的一些想法，您还可以尝试开发自己的“基准算法”并运行一两秒钟。

我的想法是在循环中进行一些“隐藏渲染”，或者与计时器和“onFrame”计数器结合使用。这样我就可以粗略估计我的算法将运行多少个循环。

我知道这并不完美，但我相信这种方法会给出一个粗略的结果，这可以帮助您确定您的应用程序应该默认提供的详细级别，然后也许让用户也可以选择偏好/设置样式。

# .net - .NET 的一个非常好的 RichTextBox 替代品

> ID：852986
> 
> 赞同：2
> 
> 时间：2009-05-12T14:09:34.563
> 
> 标签：.net, richtextbox

我正在编写一个需要 WYSIWYG 文本编辑器控件的 Windows .NET 应用程序，它可以

*   显示与文本内联的图像
*   将文本格式输出为 HTML、XML 或类似的内容（RTF 除外）
*   最好是免费的，但商业很好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T14:13:12.357

mshtml 控件（Internet Explorer 引擎控件）将起作用。您可以内联显示图像，将文本输出为 HTML，并且是免费的。

您可以通过设置 designMode = true 来打开编辑模式。这是一篇[很好的文章](http://netcode.ru/dotnet/?lang=&katID=30&skatID=248&artID=6515)，详细介绍了如何做到这一点。

另一种选择是使用其中一个 WPF 控件。WPF RichTextBox 比 WinForms RichTextBox 强大得多。WPF RTB 可以输出为多种不同的格式，并且具有高度可扩展性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T14:12:48.957

你可以试试 txText - [http://www.textcontrol.com/](http://www.textcontrol.com/)

# wpf - 实现诸如 MVC 或 MVVM 之类的架构模式是否为时已晚？

> ID：852992
> 
> 赞同：1
> 
> 时间：2009-05-12T14:11:49.023
> 
> 标签：wpf, model-view-controller, mvvm

我已经在我公司一直在开发的应用程序的第 2 版上得到释放。这是我们第一次涉足 WPF，不用说，我们吸取了很多教训。该产品花了一年的时间开发，因此无论如何它都不是一个小应用程序。最近每个人都加入了 MVVM。

现在我们有一个庞大的代码库，其中包含大量 x:Name 和代码支持文件中的大量逻辑，现在切换到 MVVM 之类的东西是否为时已晚？请记住，返回并更改现有窗口以采用这种模式可能不在预算之内，因此总会有两者的混合，应该采用 MVVM 前进。

赞赏对此事的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T15:51:11.023

我也有类似的情况。我们在 WPF 仍处于测试阶段时就启动了 WPF 应用程序，不用说，我们在早期犯了很多错误。当我们了解 MVVM 时，很明显它比我们的“MV”方法要好得多。

我们已经有一个相当大的现有代码库，停止我们正在做的事情并转换为 MVVM 是不现实的。我们决定所有未来的开发都将使用 MVVM 模式，并且我们将逐步迁移现有的代码库。基本上，每当我们需要更改现有屏幕时，我们都会借此机会重构并转换为 MVVM。

这种方法效果很好，今天整个项目都在使用 MVVM。

# sql - 如何在 SQL Server 2005 中实现高性能树视图

> ID：852994
> 
> 赞同：5
> 
> 时间：2009-05-12T14:12:12.377
> 
> 标签：sql, sql-server, database, tree

构建代表树的表的最佳方法是什么？我想实现一个可以很好地处理大数据的选择、插入、更新和删除。例如，选择必须支持“扩展所有”——获取给定节点的所有子节点（以及那里的子节点）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T14:21:50.610

使用`CTE`'s。

给定树状表结构：

```
id parent name
1  0      Electronics
2  1      TV
3  1      Hi-Fi
4  2      LCD
5  2      Plasma
6  3      Amplifiers
7  3      Speakers 
```

，此查询将返回`id`和`parent`深度级别，按树排序：

```
WITH    v (id, parent, level) AS
        (
        SELECT  id, parent, 1
        FROM    table
        WHERE   parent = 0
        UNION ALL
        SELECT  id, parent, v.level + 1
        FROM    v
        JOIN    table t
        ON      t.parent = v.id
        )
SELECT  *
FROM    v

id parent name
1  0      Electronics
2  1        TV
4  2          LCD
5  2          Plasma
3  1        Hi-Fi
6  3          Amplifiers
7  3          Speakers 
```

替换`parent = 0`为`parent = @parent`仅获取树的一个分支。

如果在 上有一个索引`table (parent)`，则此查询将有效地处理一个非常大的表，因为它将递归地 `INDEX LOOKUP`用于查找每个父级的所有子级。

要更新某个分支，请发出：

```
WITH    v (id, parent, level) AS
        (
        SELECT  id, parent, 1
        FROM    table
        WHERE   parent = 0
        UNION ALL
        SELECT  id, parent, v.level + 1
        FROM    v
        JOIN    table t
        ON      t.parent = v.id
        )
UPDATE  table t
SET     column = newvalue
WHERE   t.id IN
        (
        SELECT  id
        FROM    v
        ) 
```

`@parent`分支的根在哪里。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T15:41:41.923

您必须首先问自己这些问题：1）修改与读取的比率是多少？（= 主要是静态树还是不断变化？） 2）您期望树长多深和多大？

嵌套集非常适合需要对整个分支进行操作的大多数静态树。它可以毫无问题地处理深树。

物化路径适用于具有受限/可预测深度的动态（变化）树。

递归 CTE 非常适合非常小的树，但是分支操作（“让所有子节点都进入这个分支......”）对于深 / 大树来说非常昂贵。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T15:00:37.473

查看[Joe Celko 关于树和层次结构的书，](https://rads.stackoverflow.com/amzn/click/com/1558609202)了解解决层次结构问题的多种方法。您选择的模型将取决于您如何权衡查找、更新和复杂性。您可以使用邻接列表模型使查找非常快（特别是对于获取节点中的所有子节点），但对树的更新速度较慢。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-30T15:01:34.133

如果你有很多更新和选择，最好的选择似乎是路径枚举模型，这里简要描述：

[http://www.sqlteam.com/article/more-trees-hierarchies-in-sql](http://www.sqlteam.com/article/more-trees-hierarchies-in-sql)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-16T09:07:49.873

我很惊讶没有人提到使用[Closure Table](https://coderwall.com/p/lixing)。读取效率很高，编写起来也很简单。

# nhibernate - NHibernate 多主键映射

> ID：852995
> 
> 赞同：5
> 
> 时间：2009-05-12T14:12:45.057
> 
> 标签：nhibernate

我有一张名为“Orderrow”的桌子。Orderrow 有一个复合主键 (CPK)，其中包含以下列：OrderId、ProductId、RowNumber

OrderId 和 ProductId 也是引用表 Order 和 Product 的外键。RowNumber 在应用程序中生成。

我想知道这是如何在 NHibernate 中映射的，因为我只能设置 1 个 id 元素和 1 个生成器子元素。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-10-10T23:21:59.627

下面是在 NHibernate 映射文件中使用复合 ID 属性的示例：

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="Domain" namespace="Domain.Model">

  <class name="Program" table="program">
    <composite-id>
      <key-property name="Id" column="id"></key-property>
      <key-property name="Prog" column="prog"></key-property>
      <key-property name="Site" column="site"></key-property>
    </composite-id>
    <property name="ActiveDate" column="active_date"/>
    <property name="Year" column="year"/>
  </class>

</hibernate-mapping> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-12T15:18:59.670

您可以在类映射中使用“composite-id”属性而不是“id”属性。但是，您应该知道 nHibernate 团队强烈反对使用它。听起来您正在处理一个遗留数据库，您无法控制其中的模式。因此，“复合 ID”专门针对您的情况。

查看 NH 文档了解更多信息： http: [//nhibernate.info/doc/nh/en/index.html](http://nhibernate.info/doc/nh/en/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T23:56:30.060

就我个人而言，我不喜欢在我的数据库表模式中使用复合主键，而且我尝试过的任何 ORM 映射器通常都很难处理它们。如果我必须为表中的一行提供唯一标识（特别是如果它表示业务对象），我更喜欢使用单值代理 Id - GUID 或整数 - 如果表中的任何字段不是'适合。在编写询问查询和连接时，使用复合 Id 总是很麻烦，所以我通常的策略是使用代理 Id（它对业务对象没有意义，但用于标识对象本身）并在字段上放置唯一约束以前的 CPK。

# c# - 如何将富文本呈现到图像？

> ID：852998
> 
> 赞同：4
> 
> 时间：2009-05-12T14:12:53.263
> 
> 标签：c#, .net, winforms, richtext

我正在尝试创建富文本 DataGridViewCell。我可以托管 RichTextBox 作为编辑控件，但是当单元格不处于编辑模式时，我需要自己绘制富文本。我不想解析文本 - 我只需要一个与富文本一起使用的 Graphics.DrawString 等价物。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T14:25:21.817

[这是一个示例](http://support.microsoft.com/kb/812425)，您可以在其中向 Richtextbox 添加打印功能。它基本上只是将富文本复制到用于打印的 Graphics 对象。我认为您可以修改它以改用您自己的图形对象，并且基本上“打印”到图像。

编辑：

[这是一篇](http://bytes.com/groups/net-c/523657-c-printing-content-richtextbox-image-wysiwyg-mode)似乎有人修改了用于创建图像的打印代码的帖子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T14:20:03.543

我不相信 WinForms 中有可以为您做到这一点的解决方案。这里最好的方法可能是同时使用`RichTextBox`普通渲染和编辑，并`Locked`在不处于编辑模式时将其锁定（设置为 true）。******************