# StackOverflow 问答 000637000-000637999

# linux - 如何检查 X 服务器是否正在运行？

> ID：637005
> 
> 赞同：82
> 
> 时间：2009-03-12T01:00:46.560
> 
> 标签：linux, x11, xserver

有什么方法可以查明当前会话用户是否正在运行 Xserver（在 Linux 下）？

我从以下方面开始：

```
ps -e | grep X 
```

但这并不总是有效

我尝试的另一件事是检查`$DISPLAY`变量

还有其他方法可以检查吗？

编辑：

有些人建议使用`$DISPLAY`变量，但如果用户摆弄这个变量怎么办？如果他尝试做某事并更改此变量，然后当我检查它时，它不再反映系统的准确状态怎么办。是否没有特定的方法可以始终返回正确的答案？

我发现它可以通过编程方式完成：

```
#include <X11/Xlib.h> 
int main()
    { exit(XOpenDisplay(NULL) ? 0 : 1);  } 

$ gcc -o xprobe xprobe.c -L/usr/X11R6/lib -lX11 
```

但我正在寻找一种脚本方式。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-08-15T07:52:41.157

我经常需要在运行许多 X 服务器的服务器上运行 X 命令，因此`ps`基于答案的答案不起作用。当然，`$DISPLAY`必须适当设置。要检查它是否有效，请`xset q`在一些片段中使用，例如：

```
if ! xset q &>/dev/null; then
    echo "No X server at \$DISPLAY [$DISPLAY]" >&2
    exit 1
fi 
```

## 编辑

有些人发现*xset*`$DISPLAY`在确定它不是指向有效的 X 服务器之前可能会暂停很长一段时间（通常当 tcp/ip 是传输时）。当然，解决方法是使用*超时*来保持暂停，例如 1 秒。

```
if ! timeout 1s xset q &>/dev/null; then
    ⋮ 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-12T01:38:21.400

$DISPLAY 是标准方式。这就是用户与程序沟通的方式，以了解使用哪个 X 服务器（如果有的话）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-12T01:23:55.540

我用

```
pidof X && echo "yup X server is running" 
```

pgrep 和 $DISPLAY 是其他选项。

其他注意事项：

su 然后 $DISPLAY 将不会被设置。改变程序运行环境的事情可能会使它不起作用。

我不推荐 ps -e | grep X 因为这会找到 procX，它不是 X 服务器。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-12T01:48:35.837

我用来判断 X 是否正在运行的一个技巧是：

远程登录 127.0.0.1 6000

如果它连接了，你有一个 X 服务器正在运行并且它接受入站 TCP 连接（现在通常不是默认的）......

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-06-14T15:23:37.650

您可以使用`xdpyinfo`（可以通过安装`apt-get install x11-utils`）。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-10-27T15:56:44.903

```
xprop -root &> /dev/null 
```

...是我尝试过的真实命令来测试“X-able”情况。而且，几乎可以保证它在任何运行 X 的系统上，当然，如果无论如何都找不到该命令，则该命令将失败，因此即使它不存在，您也几乎可以假设也没有 X。（这就是为什么我使用 &> 而不是 >）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-04-03T05:12:52.680

我为此目的编写了[xdpyprobe程序。](https://github.com/alezost/xdpyprobe)与 xset、xdpyinfo 和其他通用工具不同，它不执行任何额外操作（仅检查 X 服务器并退出）并且可能不产生任何输出（如果指定了“-q”选项）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-12T08:53:45.893

1)

```
# netstat -lp|grep -ix
tcp 0 0 *:x11 *:* 听 2937/X          
tcp6 0 0 [::]:x11 [::]:* LISTEN 2937/X          
活动 UNIX 域套接字（仅限服务器）
unix 2 [ ACC ] 流监听 8940 2937/X @/tmp/.X11-unix/X0
unix 2 [ ACC ] 流监听 8941 2937/X /tmp/.X11-unix/X0
#

```

2) 地图

```
# nmap 本地主机|grep -ix
6000/tcp 打开 X11
#

```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-01-04T22:09:15.880

bash脚本解决方案：

```
if ! xset q &>/dev/null; then
    echo "No X server at \$DISPLAY [$DISPLAY]" >&2
    exit 1
fi 
```

如果您从另一个控制台（Ctrl+Alt+F？）或 ssh 登录，则不起作用。对我来说，这个解决方案适用于我的 Archlinux：

```
#!/bin/sh
ps aux|grep -v grep|grep "/usr/lib/Xorg"
EXITSTATUS=$?
if [ $EXITSTATUS -eq 0 ]; then
  echo "X server running"
  exit 1
fi 
```

您可以仅将 /usr/lib/Xorg 更改为 Xorg 或系统上的正确命令。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-01-25T08:22:05.620

首先，您需要确保在您的服务器上正确安装了基础 X11 软件包：

```
rpm -qa | grep xorg-x11-xauth 
```

如果没有，请安装所有软件包：

```
sudo yum install xorg-x11-xauth xterm 
```

确保将 openssh 服务器配置为转发 x11 连接：

```
edit file : vim /etc/ssh/sshd_config

X11Forwarding yes 
```

注意：如果该行前面有注释 (#) 或设置为 no，请更新文件以匹配上述内容，然后重新启动您的 ssh 服务器守护程序（在此要小心 - 如果您犯了错误，您可能会将自己锁定在服务器）

```
sudo /etc/init.d/sshd restart 
```

现在，配置 SSH 应用程序以转发 X11 请求：

```
ssh -Y your_username@your_server.your_domain.com 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-10-16T20:03:06.100

```
if [[ $DISPLAY ]]; then 
  …
fi 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-10-17T10:21:05.347

这是用于检查的 PHP 脚本。

```
$xsession = `pidof X`;
if (!$xsession) {
    echo "There is no active X session, aborting..\n";
    exit;
} 
```

类似的命令也可以在 shell 脚本中使用。像 pidof 命令。

# sql-server - EJB3 区分大小写的注解

> ID：637008
> 
> 赞同：1
> 
> 时间：2009-03-12T01:01:15.233
> 
> 标签：sql-server, orm, jpa, annotations, case-sensitive

我们正在连接到 SQL Server 以持久化我们的 EJB3 对象。这些对象使用@Column 进行注释。

如果数据库中的列名以大写字母开头（例如 OrderName），如果元素定义如下，ejb 注释是否会出现区分大小写的问题：

```
@Column
String orderName 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T01:37:22.073

我认为您不会遇到区分大小写的问题。或者，如果您使用区分大小写的排序规则创建了数据库（在这种情况下，所有对象名称都将区分大小写）。但即使你这样做了，你也可以随时在 @Column 注释中设置列的名称：

```
@Column(name="ORDeRNAME") 
```

# syntax - Powershell 添加内容

> ID：637010
> 
> 赞同：3
> 
> 时间：2009-03-12T01:02:08.883
> 
> 标签：syntax, powershell

我无法让 add-content 同时添加字符串和 cmdlet 的输出，所以它看起来像这样；

```
Add-content -path $logfile -value "This is my text"+(Get-Date) 
```

我意识到我可以添加另一行来为 get-date 的结果设置一个变量，然后将变量传递给我的 add-content 命令，但我只是想知道我是否可以在一行中完成它，就像我说的那样肛门大声笑

干杯

安迪

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-12T01:07:22.647

尝试`"This is my text $(Get-Date)"`

在 PowerShell 中，双引号中的字符串可以包含变量和表达式。如果它不是一个简单的表达式（例如`"This is a $value"`），那么您需要将表达式包装在`$()`（例如`"This is a $($value + 1)"`）中。

请注意，单引号中的字符串是“逐字字符串”，不允许转义字符或表达式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-12T07:38:31.020

我更喜欢[MohitC](https://stackoverflow.com/a/637021/282110)方法，但您也可以将您的值括在括号中：

```
Add-content -path $logfile -value ('This is my text '+(Get-Date)) 
```

# sql-server - 如何在 SQL Server 中找到正在运行的跟踪？

> ID：637013
> 
> 赞同：33
> 
> 时间：2009-03-12T01:04:33.073
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, sql-server-2012, sql-server-2017

`sp_trace_create`是否有一种简单的方法可以确定在 SQL Server 2000 上设置了哪些跟踪？SQL Server 2005、2008、2012 或 2014 怎么样？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-12T01:08:20.210

**SQL Server 2005**（更高版本）：

```
 SELECT * FROM sys.traces 
```

**SQL Server 2000**：

```
 USE msdb
    SELECT * FROM fn_trace_getinfo(default); 
```

参考：[`fn_trace_getinfo`](http://msdn.microsoft.com/en-us/library/ms173875.aspx)

`sys.traces`可在此处找到 DMV的列说明：[`sys.traces`](https://docs.microsoft.com/en-us/sql/relational-databases/system-catalog-views/sys-traces-transact-sql)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-04T15:05:26.323

老问题，但精确。在 SQL 2000 服务器上，您必须使用 msdb 数据库。埃斯：

```
USE msdb
SELECT * FROM :: fn_trace_getinfo(default) 
```

# objective-c - NSString 对象是否需要分配和初始化？

> ID：637022
> 
> 赞同：8
> 
> 时间：2009-03-12T01:07:24.843
> 
> 标签：objective-c, string, nsstring

菜鸟问题：

我目前的印象是，当你想创建一个对象时，你需要`alloc`和`init`那个对象。

但是，我已经看到了几个`NSString`声明对象的示例代码，但是我没有看到以下消息`alloc`或`init`消息...

一个非常简单的例子：

> ```
> NSString *myString = @"Hello World";
> 
> NSLog(@"%@" , myString); 
> ```

有人可以解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-12T01:10:10.203

**声明**变量不需要释放任何内存。

**实例化**对象确实如此。如果你调用*alloc*或*copy ，你只会实例化一个新对象*

在您的示例中，您正在设置对编译器从硬编码字符串创建的现有对象的引用。而且您不必管理它的内存，因为您没有实例化它。

不知道我解释的够不够清楚。

**编辑：**

看起来已经有一个问题可以回答这个问题：

[文字 NSString 是自动释放还是需要释放？](https://stackoverflow.com/questions/329977/cocoa-memory-management-with-nsstring)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-12T01:54:52.407

当您在代码中嵌入`NSString`文字时，例如`@"hello, world'`，编译器会在您的可执行文件中为其分配空间，并在程序启动时将其加载到内存中并进行初始化。

由于它是您的可执行文件的一部分，因此它在您的应用程序的整个生命周期中都存在。没有必要保留或释放它。您为其创建的`NSString *myString`变量是指向编译器放置`NSString`文字的内存位置的指针。

# orm - 在 ORM 中缓存查询结果 - 满足任意子集查询

> ID：637026
> 
> 赞同：0
> 
> 时间：2009-03-12T01:08:19.087
> 
> 标签：orm, caching, logic

我知道 N/Hibernate 使用缓存来满足它以前见过的查询，这称为查询缓存。但是，它能否满足该查询的一个子集？我想不会，因为我猜想弄清楚这一点的一般问题是不确定的。

不过，有什么策略可以做到这一点吗？假设我要查询所有价格低于 20 美元的小部件。后来，我有一个查询是针对 10 美元以下的所有小部件。显然，第二个查询结果已经被缓存（假设没有驱逐等），所以我想根据缓存的查询谓词重新评估谓词，以确定它是否“包含”它。有没有一些实用的策略来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T01:32:10.980

在缓存的查询结果上使用内存过滤是否很常见，例如使用 LINQ。

# php - 用数据库数据替换文件中的“键”

> ID：637028
> 
> 赞同：0
> 
> 时间：2009-03-12T01:08:48.350
> 
> 标签：php

目前我有以下从我的数据库中检索数据的方法：

```
$school->get('studentCount'); 
```

我需要一个快捷方式来访问页面中的这些字段，因此提出了如下格式：

```
<p>Blah blah blah [[studentCount]]</p> 
```

我打开了输出缓冲，但只需要一种简单的方法将该键（'[[field-name]]'）替换为来自数据库的相应数据。

如果它只是一个字段，我可以像这样在输出上执行 str_replace：

```
str_replace($output, '[[studentCount]]', $school->get('studentCount')) 
```

不幸的是，这不合适。我理想的解决方案是抓取 '[[' 和 ']]' 之间的任何内容，然后运行 ​​'get' 方法并用返回的内容替换整个密钥（'[[...]]'）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T01:19:44.580

好吧，您可以创建两个数组，一个带有字段名称字符串`[[field-name]]`，一个带有响应`$school->get('field-name')`。然后把它们扔进去，`str_replace`因为它支持数组。

PHP手册中的示例：

```
$phrase  = "You should eat fruits, vegetables, and fiber every day.";
$healthy = array("fruits", "vegetables", "fiber");
$yummy   = array("pizza", "beer", "ice cream");
$newphrase = str_replace($healthy, $yummy, $phrase);
// Resulting String: "You should eat pizza, beer, and ice cream every day." 
```

如果您仍然想实现您的建议（查找所有 [[]] 并替换它们），我将尝试编写一个快速函数。

**编辑：**这是通过您的请求执行此操作的两种方法：

```
$html = "Hello, [[FirstName]]!  Welcome to [[SiteName]].";
$count = preg_match_all("/\[\[([\w]+)\]\]/", $html, $matches);
for ($x = 0; $x < $count; $x++)
  $html = str_replace($matches[0][$x], $school->get($matches[1][$x]), $html); 
```

或使用数组：

```
$html = "Hello, [[FirstName]]!  Welcome to [[SiteName]].";
$count = preg_match_all("/\[\[([\w]+)\]\]/", $html, $matches);
for ($x = 0; $x < $count; $x++)
  $matches[1][$x] = $school->get($matches[1][$x]);
$html = str_replace($matches[0], $matches[1], $html); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T02:08:56.460

我很确定这会奏效。:)

```
 <?php
// $output contains the string

preg_match_all('/\[{2}([^\[]+)\]{2}/', $output, $matches);
$replaces = $matches['1'];

foreach($replaces as $replace) $str = str_replace('[['.$replace.']]', $school->get($replace), $output);
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T01:15:30.193

您将需要使用正则表达式在两个 [[ 和 ]] 中查找内容，并将其插入到您的 ->get() 函数中。

函数是 preg_replace

[http://us2.php.net/preg-replace](http://us2.php.net/preg-replace)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T01:38:28.280

假设您可以缓存结果，正则表达式和文件缓存是一种很好的方法。首先转换文件：

```
function cache_it($filename, $tablvar) {
    $tmplt = file_get_contents($filename);
    $tmplt = preg_replace('/\[\[(.+)\]\]/', 
             '<?php echo $' . $tablevar . '->get(\1);?>',
             $tmplt);
    file_put_contents($filename . '.php', $tmplt);
} 
```

然后每当您需要访问该文件时。

```
function print_it($filename, $tablevar, $table) {
    $_GLOBAL[$tablevar] = $table;
    include $filename . '.php';
    unset($_GLOBAL[$tablevar]);
} 
```

您可能想要检查缓存文件的创建日期是否大于源文件的最后修改日期。在类中包装它和上面的两个函数有助于避免很多小陷阱。但总体思路是合理的。缓存文件是您需要解决的 .php 文件也存在一些安全问题。

我将这种样式模板缓存添加到我工作的 OSS CMS 中。通过缓存正则表达式结果，我们将原始代码的速度提高了 50% 以上。真正的好处是模板是 PHP 文件。因此，任何可以加速 PHP 文件（APC、eAccelerator 等）解释的东西也会加速您的模板。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T01:13:31.850

您需要编写一个解析器来查看 $output 以查找分隔符之间的内容，然后调用一个函数（如果已定义）。我假设您想以这种方式保存呼叫，直到需要它们为止。我编写了一个以这种方式有效工作的模板解析器。不幸的是，它不在 PHP 中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T01:27:00.117

感谢您到目前为止的回复。我确实考虑过将 str/preg _replace 与数组一起使用，但我希望键 ('[[...]]') 直接与 'get' 方法相关联，因此它是完全可扩展的。我不想每次将新字段添加到数据库时都必须添加到两个不同的数组。

例如，在 JavaScript 中，我会这样实现：（JavaScript 允许您将匿名函数作为 preg_replace 等效项中的 'replacement' 参数传递）：

```
('this is the output blah blah [[studentCount]]').replace(/\[{2}([^\[]+)\]{2}/g, function($0, $1) {
    get($1);
}) 
```

# sql-server - 小写约束 - Sql Server

> ID：637030
> 
> 赞同：3
> 
> 时间：2009-03-12T01:10:31.187
> 
> 标签：sql-server, constraints

我不确定这是否应该是一个约束，但我希望表的“用户名”列忽略执行插入或更新时设置的值，而是存储“显示用户名”列的值转换为小写。如果“DisplayUserName”被更改，“UserName”也应该被更新为“DisplayUserName”被降低。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T01:22:53.450

听起来您正在寻找计算列。就像是：

```
CREATE TABLE [dbo].[SampleTable](
    [ID] [int] IDENTITY(1, 1) NOT NULL,
    [DisplayUserName] [varchar](100) NOT NULL,
    [UserName]  AS (lower([DisplayUserName]))
) ON [PRIMARY] 
```

这样，您将永远不必设置 UserName，根据定义，它是 DisplayUserName 中的小写值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T01:15:04.607

执行此操作的常用方法是使用在插入和更新时触发的触发器。

[http://msdn.microsoft.com/en-us/magazine/cc164047.aspx](http://msdn.microsoft.com/en-us/magazine/cc164047.aspx)

触发器的代码应该是这样的：

```
CREATE TRIGGER updateDisplayName_trigger ON Users
FOR INSERT, UPDATE  
AS
IF UPDATE(UserName)
UPDATE Users SET DisplayUserName = Lower(UserName) 
```

只需将其调整为您的特定业务规则，因为我认为我没有做对 =)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T01:15:19.520

您将需要创建一个触发器来处理更新。

# svn - Subversion diff --summarize 只显示旧路径

> ID：637036
> 
> 赞同：1
> 
> 时间：2009-03-12T01:13:37.403
> 
> 标签：svn, diff

如果我这样做：

```
svn diff
   --summarize
   --old http.../svn/project/trunk
   --new http.../svn/project/branches/branch 
```

我得到一个这样的列表：

```
D      http.../svn/project/trunk/deletedFile
A      http.../svn/project/trunk/addedFile
M      http.../svn/project/trunk/modifiedFile 
```

它只显示旧路径。有没有办法获得新的路径？我正在解析这个输出，我想得到这些路径：

```
http.../svn/project/branches/branch/deletedFile
http.../svn/project/branches/branch/addedFile
http.../svn/project/branches/branch/modifiedFile 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T03:50:46.793

您正在比较主干和分支的 HEAD，本质上是在问“主干需要发生什么才能使其与分支相同？”，所以答案是对主干的更改。如果您交换新旧文件，您将获得相同的文件列表，就分支而言，但操作相反。

如果在分支而不是主干中添加了文件，并且您运行现有的差异（旧=主干，新=分支），您会看到：

```
A    http:.../project/trunk/file 
```

如果你交换新旧（new=branch，old=trunk），你会得到：

```
D    http:.../project/branches/branch/file 
```

# html - 如何避免ie8兼容按钮？

> ID：637039
> 
> 赞同：46
> 
> 时间：2009-03-12T01:15:21.597
> 
> 标签：html, internet-explorer-8

在 IE8 中，微软引入了一种称为兼容模式的新模式，它可以像 IE7 一样呈现页面。

您可以在 stackoverflow.com 的地址栏旁边看到此按钮。但是当您访问 google.com/live.com 时，您不会看到兼容模式按钮。我们如何确保页面不向用户显示此按钮？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-03-12T01:44:25.317

简短的回答：

把它放在你的 head 标签中，告诉浏览器你的页面在 IE 8 中工作：

```
<meta http-equiv="X-UA-Compatible" content="IE=8" /> 
```

同样根据 Jon Hadleys 的评论，为了确保使用最新的（不仅仅是 IE8）渲染引擎，您可以使用以下内容：

```
<meta http-equiv="X-UA-Compatible" content="IE=edge"> 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-03-12T01:21:02.533

从[这里](http://blogs.msdn.com/ie/archive/2009/02/16/just-the-facts-recap-of-compatibility-view.aspx)：

> 有时不显示兼容性视图按钮。
> 
> 该按钮位于“停止”和“刷新”按钮旁边的地址栏上。在某些情况下，用户没有采取任何操作，因此“兼容性视图”按钮不会显示：
> 
> 如果您正在查看内部到 Internet Explorer 页面（例如 about:InPrivate）
> 
> 如果您正在查看通过使用版本控制标记/HTTP 标头声明它已为 Internet Explorer 8“准备好”的页面（此标记是否触发 Quirks、IE7 标准或 IE8 标准无关紧要，按钮将不会不显示）
> 
> 如果您正在查看 Intranet 页面并且选中了“在兼容性视图中显示 Intranet 站点”复选框 如果您正在查看任何网页并且选中了“在兼容性视图中显示所有网站”复选框
> 
> 如果您正在查看 Microsoft 提供的兼容性视图更新列表中包含的网页，并且您选中了“包括 Microsoft 更新的网站列表”复选框
> 
> 如果您通过开发者工具栏切换了“文档模式”或“浏览器模式”设置

因此，您可能正在使用该博客文章和[此处](http://msdn.microsoft.com/en-us/library/cc817574.aspx)详细描述的版本控制标记/HTTP 标头。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-01-06T14:21:55.700

如果启用了“在兼容性视图中显示 Intranet 站点”或“在兼容性视图中显示所有网站”设置（位于工具 -> 兼容性视图设置下）（因为它们与正在查看的网站相关），那么无论您在文档的 HTML，页面将*始终*被放入某种形式的兼容性视图中。

这意味着，即使在文档中，您仍然会注意到该页面已进入兼容性视图，不幸的是，除了禁用这些设置之外，您无能为力。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-20T18:05:49.047

根据[这篇关于兼容性视图的综合 MSDN 文章](http://msdn.microsoft.com/en-us/library/dd567845%28VS.85%29.aspx)，以下列表描述了启用兼容性视图的不同方法：

*   查看网页时单击地址栏中的兼容性视图按钮。显示时，此按钮出现在“刷新”按钮的左侧，其中包含一张碎纸的图像。这将为正在查看的网站域中的所有文档启用兼容性视图。
*   兼容性视图设置中的“以兼容模式显示所有网站设置”已启用。
*   “使用兼容性视图自动从页面布局错误中恢复”设置已启用，网页停止响应或浏览器崩溃。发生这种情况时，Internet Explorer 在从问题中恢复后会在兼容性视图中打开该页面。
*   标识要在兼容性视图中打开的站点的组策略由您的计算机管理员启用。
*   您已使用 F12 开发人员工具更改浏览器模式以将 Internet Explorer 识别为浏览器的早期版本。
*   兼容性视图列表已启用，它定义了在兼容性视图中自动显示的网站列表。

要避免/禁用/覆盖兼容性视图，您必须执行与上面建议的操作相反的操作。

[兼容性视图列表是 Microsoft 维护的 XML 文件。](http://ie9cvlist.ie.microsoft.com/ie9CompatViewList.xml)

> 要从兼容性视图列表中删除您的站点（或对从列表中删除您的站点提出异议），请让整个站点所有者验证域站点是否出现在兼容性视图列表中。如果是，请向 iepo@microsoft.com 发送包含以下信息的电子邮件：
> 
> 所有者名称 公司名称 公司名称 街道地址 电子邮件地址 电话号码 网站地址
> 
> Microsoft 将在下一次计划更新时审查提供的信息并从兼容性视图列表中删除您的站点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-21T07:36:53.190

下面的链接在 IE 中运行良好，并且可以正确显示菜单栏 [http://line25.com/wp-content/uploads/2012/css-menu/demo/index.html](http://line25.com/wp-content/uploads/2012/css-menu/demo/index.html)

但是托管在 Intranet 上的相同内容，所有链接都显示在另一个下方，而不是菜单栏。地址栏中未显示兼容性视图按钮。

进行以下更改后，菜单栏正确显示，地址栏中显示兼容性视图按钮。

工具->兼容性视图设置->取消选中“在兼容性视图中显示 Intranet 站点”

非常感谢您提供宝贵的意见

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-10T19:01:28.843

我遇到了兼容性视图的问题，结果发现我的一些 PHP 文件以 UTF-8 字符编码保存，我猜这让 IE 感到困惑。大多数站点文件保存在代码页 1252 中。

现在，我将所有文件设置为另存为“西欧 (Windows) - 代码页 1252”，然后我的显示问题就消失了。

这里的教训是，不要混合你的字符编码。

# bytearray - 将 jpeglib 用于 JPEG 压缩字节流

> ID：637043
> 
> 赞同：2
> 
> 时间：2009-03-12T01:15:46.447
> 
> 标签：bytearray, rgb, libjpeg

我将 JPEG 压缩字节流存储在一个名为“Image”的变量中，我想将此字节流转换为 RGB。

例如：无符号字符*图像；

我的问题是：有没有办法将“图像”传递给 jpeg_stdio_src() 以获取 RGB 颜色值？

谁能告诉我如何使用 jpeglib 库从字节流“图像”中获取 RGB？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T01:37:12.807

尝试这样的事情。这使用对象 currImage 来存储结果（此处未声明）。

```
typedef struct {
  struct jpeg_source_mgr pub;   // public fields

  JOCTET * buffer;              // start of buffer
  boolean start_of_file;        // have we gotten any data yet?
} my_source_mgr;

typedef my_source_mgr * my_src_ptr;

static void jpg_memInitSource(j_decompress_ptr cinfo)
{
  my_src_ptr src = (my_src_ptr) cinfo->src;
  src->start_of_file = true;
}

static boolean jpg_memFillInputBuffer(j_decompress_ptr cinfo)
{
  my_src_ptr src = (my_src_ptr) cinfo->src;
  src->start_of_file = FALSE;
  return TRUE;
}

static void jpg_memSkipInputData(j_decompress_ptr cinfo, long num_bytes)
{
  my_src_ptr src = (my_src_ptr) cinfo->src;
  if (num_bytes > 0) {
    src->pub.next_input_byte += (size_t) num_bytes;
    src->pub.bytes_in_buffer -= (size_t) num_bytes;
  }
}

static void jpg_memTermSource(j_decompress_ptr cinfo)
{
  // no work necessary here
}

void decompressJpeg(uint8 const *compressed, size_t len)
{
  struct jpeg_decompress_struct cinfo;
  struct jpeg_error_mgr         jerr;
  my_src_ptr src;

  // ToDo: change error handling to work with our return codes
  cinfo.err = jpeg_std_error(&jerr);
  jpeg_create_decompress(&cinfo);

  cinfo.src = (struct jpeg_source_mgr *)
    (*cinfo.mem->alloc_small) ((j_common_ptr) &cinfo, JPOOL_PERMANENT,
    sizeof(my_source_mgr));
  src = (my_src_ptr) cinfo.src;
  src->buffer = (JOCTET *)compressed;

  src->pub.init_source = jpg_memInitSource;
  src->pub.fill_input_buffer = jpg_memFillInputBuffer;
  src->pub.skip_input_data = jpg_memSkipInputData;
  src->pub.resync_to_restart = jpeg_resync_to_restart;
  src->pub.term_source = jpg_memTermSource;
  src->pub.bytes_in_buffer = len;
  src->pub.next_input_byte = compressed;

  jpeg_read_header(&cinfo, true);
  jpeg_start_decompress(&cinfo);

  // check: cinfo.out_color_space == JCS_RGB

  currImage.setSize(
    (int)cinfo.output_width, (int)cinfo.output_height));

  size_t w = currImage.getWidth() * 3;
  uint8 *p = (uint8*)currImage.getPixels();
  while (cinfo.output_scanline < cinfo.output_height) {
    jpeg_read_scanlines(&cinfo, &p, 1);
    p += w;
  }

  jpeg_finish_decompress(&cinfo); // Do this even under error conditions
  jpeg_destroy_decompress(&cinfo); // Do this even under error conditions
} 
```

**编辑：**添加了一些缺少的支持代码。谢谢，埃杜菲利普！

# c# - C# 中的预处理器指令

> ID：637061
> 
> 赞同：1
> 
> 时间：2009-03-12T01:24:46.113
> 
> 标签：c#, debugging, c-preprocessor

我似乎在使用 C# 中的预处理器指令时遇到了问题。我创建了一个 Visual Studio 2008 C# win forms 应用程序。我添加这个：

```
#if (DEBUG)
            textBox1.Text = "in debug mode";
#else
            textBox1.Text = "in release mode";
#endif 
```

当我在调试中运行时，我看到了预期的“调试模式”。但是，当我切换到发布、编译和运行 .exe 时，我仍然看到“处于调试模式”文本。在我的项目属性中，我`DEBUG`检查了定义常量。我什至得到了上面代码的正确颜色编码语法。是什么赋予了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T01:28:22.110

您是否有机会为调试和发布配置定义了调试？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T01:57:23.523

你有“#define DEBUG”行吗？这总是将 DEBUG 设置为 true。

# jquery - 显示一个图像 - 从一组加载

> ID：637063
> 
> 赞同：0
> 
> 时间：2009-03-12T01:25:53.567
> 
> 标签：jquery

我正在尝试创建一个 jquery 函数，其中右侧有一个侧边栏，其中包含一堆图像：

标题
关于文本

在右侧它会显示所有内容，然后如果单击其中一个，它会在左侧显示更大的图像和文本。如果您单击另一个，它会过渡到另一个。

我可以设置一堆元素并获取子元素，这些子元素将是标题和关于文本存储在变量中，然后附加到元素以显示它。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T02:39:03.890

听起来你想要这样的东西：

[http://devkick.com/lab/galleria/demo_02.htm](http://devkick.com/lab/galleria/demo_02.htm)

代码位于：[http ://code.google.com/p/galleria/](http://code.google.com/p/galleria/)

# .net - 在 LINQ-to-XML 中查找或创建元素

> ID：637065
> 
> 赞同：1
> 
> 时间：2009-03-12T01:26:47.887
> 
> 标签：.net, xml, linq, linq-to-xml

我想设置一个可能已经存在也可能不存在的元素的值/子元素。如果该元素不存在，我想为我自动创建它。

这样，我的代码只需要担心元素的内容......而不是它是否已经存在。（当我完成它时，它保证存在）。

LINQ-to-XML 中是否已经存在此功能？我还没有找到它，正在考虑编写我自己的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T02:33:08.430

这是我到目前为止所拥有的：

```
public static IEnumerable<XElement> ElementsOrCreate(this XElement parent, XName name)
{
    IEnumerable<XElement> elements = parent.Elements(name);
    if (!elements.Any())
    {
      XElement element = new XElement(name);
      parent.Add(element);
      elements = new XElement[] { element };
    }
    return elements;
} 
```

请注意，第一个参数（用于扩展）是 XElement，而不是像 System.Xml.Linq.Extensions.Elements 这样的 XContainer。唯一的其他非 XElement XContainer 是 XDocument，这种方法对于 XDocument 不起作用（并且没有多大意义）。

# database-design - 来自 DomainModel 的数据库模式

> ID：637073
> 
> 赞同：1
> 
> 时间：2009-03-12T01:30:31.920
> 
> 标签：database-design, code-generation, domain-driven-design

有没有人有从 c# (.net 3.5) 域模型生成数据库模式的经验？哪个工具生成最干净的脚本？

Telerik OpenAccess ORM 本来可以，但如果属性字段使用 .net 3.5 隐式私有字段，它不会从 c# 类中生成干净的列名。

我只需要一个初始脚本生成，然后我将手动增强和维护它。

磷

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T14:00:02.573

我只是通过反射生成了一个。令人惊讶的是，一旦我开始考虑它，我所付出的努力比我想象的要少。

我是怎么做到的：（又名：算法）

1.  加载组件。

2.  对于程序集中的每个类（类型）=> 创建表

3.  生成主键为 ${className}ID

4.  对于类中的每个 get/set 属性 create => 添加字段（将属性类型映射到 db 类型）

5.  获取类上的外键自定义属性 => 如果不存在则添加键。将其设置为 fk_index （自定义属性签名类似于 [ForeignKey("TableA,TableB")]

6.  获取其他约束（例如：检查）自定义属性 => 酌情生成

7.  如果您无权访问源代码，请从 xml 中读取这些映射。*****编辑：如果 xml 始终是您的最后选择解决方案（就像我一样），您可以在返回 IEnumerable<Attribute> 的类上创建扩展方法。在这种情况下，您的 Attribute 表面必须包含 'string TargetProperty {get; set;}' 属性，用于存储它在检查和唯一约束的情况下引用的字段名称。*****

就是这样！！

尖端：

组装装载：哦！顺便说一句，一个常见的问题是确保在加载程序可以找到它们的地方提供所有程序集依赖项。请记住，Visual Studio 无法帮助您解决此动态负载方案中的依赖关系。想想你在命令行上运行 csc.exe。如果您遇到程序集加载问题，请检查以确保域模型程序集的每个内部依赖项在加载程序可以找到的地方都可用。

类型映射：可空类型设置为空，否则为非空类型。字符串类型设置为 nvarchar(max)。根据需要将钱映射为十进制或双精度，将布尔映射为位或等价物，将日期时间映射为日期时间，将字节[]映射为二进制，将长映射为数字（x，0）并将整数映射为整数。

应用程序架构：我很容易将控制台应用程序添加到我的解决方案以满足即时需求，但是，您可能需要提供输入参数以确保这可以轻松移植到其他项目。为了平滑这一点，您需要代码生成程序有一个 dll 部分，它将声明您的自定义属性，否则您可能还需要传入类型规范或为自定义属性设置配置部分前者似乎更容易使用和配置，代码生成程序再次确切地知道它得到了什么。

希望这可以帮助。

磷

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-17T22:23:58.423

磷，

我使用反射、内省 ( [FxCop SDK](http://www.binarycoder.net/fxcop/) ) 和 CodeModel ( [Visual Studio 自动化](http://msdn.microsoft.com/en-us/library/envdte.codemodel.aspx)) 来解决[类似的问题](http://www.olegsych.com/2008/07/t4-template-for-generating-sql-view-from-csharp-enumeration/)。我按此顺序从一个 API 转到下一个 API，并且最喜欢 CodeModel。反射的问题在于，只要加载了 AppDomain，它就会将程序集锁定在内存中。这是 T4 中的一个问题，尽管您的独立可执行文件可能没有它。使用 T4，您无法在从元数据生成代码后重新编译原始程序集。Introspection 运行良好，没有锁定程序集，但仍然没有记录，而且它要求您在使用它的元数据之前编译程序集。CodeModel 已记录在案，并允许您直接从 C# 源代码访问元数据。

希望这会有所帮助，奥列格

# cmake - CMake 编译错误..（未知的 CMake 命令“QT4_WRAP_UI”）

> ID：637079
> 
> 赞同：4
> 
> 时间：2009-03-12T01:35:13.810
> 
> 标签：cmake, qgis

我正在尝试为 qgis 构建草插件 ..

当我尝试使用 cmake .. 配置后出现以下错误..

```
CMake Error at CMakeLists.txt:78 (QT4_WRAP_UI):
   Unknown CMake command "QT4_WRAP_UI". 
```

我已经安装了 Qt4、PyQt 和 python2.6 ..

谁能帮我弄清楚这里出了什么问题？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T08:18:46.273

您需要从 CMake 导入 Qt4 宏。像这样的一行应该做到这一点：

```
find_package(Qt4) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-04T16:02:47.257

除了定位包之外，您还应该包含 ${QT_USE_FILE}，即：

```
find_package(Qt4)
include(${QT_USE_FILE}) 
```

# c++ - 如何在 Xcode 中链接动态库？

> ID：637081
> 
> 赞同：9
> 
> 时间：2009-03-12T01:37:14.523
> 
> 标签：c++, xcode, macos, dylib

我目前正在 Qt 中开发一个程序，它使用库 libqextserialport.1.dylib。

我构建它并在 x-code 中运行它会吐回来：

```
dyld: Library not loaded: libqextserialport.1.dylib
    Referenced from: /Users/samuelreh/Desktop/QtOpenCV/build/Debug/QtOpenCV.app/Contents/MacOS/QtOpenCV
    Reason: image not found 
```

该库位于 /Users/samuelreh/Desktop/QtOpenCV/qextserialport/build/。

我可以通过更改到可执行文件夹 /Users/samuelreh/Desktop/QtOpenCV/build/Debug/QtOpenCV.app/Contents/MacOS/ 并输入：

`install_name_tool -change libqextserialport.1.dylib /Users/samuelreh/Desktop/QtOpenCV/qextserialport/build/libqextserialport.1.dylib QtOpenCV`

我知道除此之外可能还有很多解决方案。有人知道 x-code 中最好的/最优雅的/最容易做到的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-15T11:04:36.253

我刚刚使用 Module Bundle 项目完成了这一点。这被包含在一个带有单独可执行文件的更大项目中。

我添加了一个“将 dylib 复制到框架”步骤，它将 dylib 复制到 /Foobar.bundle/Contents/Frameworks/Foobar/。然后我添加了一个运行脚本阶段作为最后一步运行，以修复可执行文件中 dylib 的安装名称：

```
install_name_tool -change libBobDylan.dylib @executable_path/../Plugins/Foobar.bundle/Contents/Frameworks/Foobar/libBobDylan.dylib path/to/build/product/Foobar.Bundle/Contents/MacOS/Foobar 
```

当然，libBobDylan.dylib 也链接到 libBillyIdol.dylib。所以我不得不在目标的最开始添加另一个运行脚本阶段来修复这里的安装名称：

```
install_name_tool -change libBillyIdol.dylib @executable_path/../Plugins/FooBar.bundle/Contents/Frameworks/Foobar/libBillyIdol.dylib local/path/to/libBobDylan.dylib 
```

我有十几个这样的链接；我不得不说服 dylib 的供应商填充他们的标题以适应我的许多 install_name 更改......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T02:51:52.910

如果我正确理解您的问题，那么您的应用程序构建良好，链接时没有错误，但是当您尝试启动它时，找不到该库。

这并不奇怪，因为 dylib 文件位于系统路径之外的某个任意目录中。您需要将其复制到`/usr/lib`（可能不是一个好主意）或将其包含在应用程序包中。后者可能是更好的方法。

我从未尝试过，但显然您需要使用[Copy Files Build Phase](http://developer.apple.com/DOCUMENTATION/DeveloperTools/Conceptual/XcodeBuildSystem/200-Build_Phases/bs_build_phases.html#//apple_ref/doc/uid/TP40002690-CJAHHAJI)将 dylib 放入您的包中，然后[配置 Xcode](http://www.codeshorts.ca/2007/nov/01/leopard-linking-making-relocatable-libraries-movin)，以便您的可执行文件知道在哪里找到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-15T03:40:38.557

您只需将库从目录拖到您的 Xcode 项目中，最好拖到资源中，但这并不重要（我相信）。我尝试了检查和不检查“将文件复制到包中”，它在这两种情况下都有效，不确定是否需要将它包含在包中进行部署。

我已经用 sqlite3 和 cocoa 应用程序（cocoa-touch）对此进行了测试。

# copy - 我可以从一个硬盘“dd”到另一个硬盘来克隆硬盘吗

> ID：637089
> 
> 赞同：1
> 
> 时间：2009-03-12T01:40:22.847
> 
> 标签：copy, storage

我想知道我是否可以只使用 Linux 命令“dd”来制作硬盘驱动器的副本。硬盘驱动器具有 Windows XP，目标是将数据从较小的 HDD 移动到较大的 HDD，而无需明确重新安装 Windows。我个人不知道这是否有可能搞砸文件系统。我也不知道这是否适用于不同型号的硬盘驱动器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T01:42:38.847

是的。dd 在文件系统下运行。您可以复制分区或整个驱动器，具体取决于您使用的设备节点。

您可能想要研究用于您的硬件的最佳“bs”（块大小），因为如果您弄错了，这可能需要很长时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T01:58:56.373

是的，您可以这样做，但需要注意几件事。

不同品牌的硬盘（甚至是同一品牌的不同型号）的大小可能不完全相同。您应该检查块设备的实际大小以验证目标驱动器的大小是否与源驱动器相同或更大。只要它是，你就可以走了。

如果目标驱动器恰好更大，则在克隆驱动器后，您可以使用 gparted 扩展分区以填充驱动器。

实际上，如果目标驱动器恰好更小，您可以使用 gparted 缩小源分区，然后将其复制到目标驱动器。

正如 dicoroce 提到的，您也可以只复制分区而不是整个驱动器。请注意，如果您只复制分区，则必须重新安装 MBR（尽管这很简单）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T02:04:52.180

如果我没记错的话，[GParted](http://gparted.sourceforge.net/)的一个非常好的功能是能够通过在某处更新一些幻数来正确调整安装了 Windows 的 NTFS 分区的大小。这对您来说意味着您将（可能）能够扩展分区以填充整个驱动器，而不必担心混淆 Windows。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T01:45:27.670

你应该没事。另外，如果由于某种原因您遇到问题，您仍然可以使用原始（较小的）驱动器作为后备。

# c# - 尝试连接到远程 IIS 服务器时出现“拒绝访问”-C#

> ID：637090
> 
> 赞同：3
> 
> 时间：2009-03-12T01:41:18.553
> 
> 标签：c#, asp.net, security, iis, directoryservices

当我尝试从在 IIS 5.1 下运行的 C# 应用程序连接到远程 IIS 6 服务器时，我收到“Access Deined”COMException。

有任何想法吗？我在原始问题中遇到了所有相同的问题。

**更新 - 2009 年 4 月 1 日**

我找到了这个解决方案（[http://www.codeproject.com/KB/cs/Start_Stop_IIS_Website.aspx](http://www.codeproject.com/KB/cs/Start_Stop_IIS_Website.aspx)），它包含一个连接到 IIS 服务器以启动和停止网站的窗口应用程序。我能够在我的工作站上运行它并连接到 IIS 服务器。

呃....为什么我可以运行这个独立的应用程序而不是我的 ASP.NET 应用程序？

**原来的**

当我尝试使用 DirectoryEntry.Exist 方法从远程计算机连接到 IIS 以检查 IIS 服务器是否有效时，我收到“拒绝访问”COMException。

```
string path = string.Format("IIS://{0}/W3SVC", server);

if(DirectoryEntry.Exist(path))
{
    //do something is valid....
} 
```

我是一个活动目录组的成员，该组已添加到我尝试连接的 IIS 服务器的管理员组中。

有没有人遇到过这个问题并知道如何解决它？

**更新：**

@Kev - 这是一个 ASP.NET 应用程序。此外，我可以通过 IIS6 管理器在没有用户名和密码的情况下连接到远程服务器。

@Chris - 我正在尝试连接到远程服务器以显示虚拟目录的数量并确定每个目录的 .NET 框架版本。请参阅[这个](https://stackoverflow.com/questions/636569/how-do-i-determine-the-asp-net-version-of-a-virtual-directory-or-website-using-c)SO 问题。

@dautzenb - 我的 ASP.NET 应用程序在 IIS 5.1 下运行，试图连接到 IIS 6 服务器。我可以在远程服务器上的本地 ASPNET 帐户的安全日志中看到故障审核。当我尝试调试应用程序时，我在我的域帐户下运行并且仍然获得访问被拒绝。

**更新 2：**

@Kev - 我能够使用以下重载创建 DirectoryEntry 对象：

```
public DirectoryEntry
(    
    string path,    
    string username,    
    string password
) 
```

但是，在我调试应用程序时，所有属性都包含“引发了类型为‘System.Runtime.InteropServices.COMException’的异常”。

此外，AuthenticationType 属性设置为 Secure。

**更新 3：**

每次我尝试建立连接时，远程 IIS 服务器的安全事件日志中都会出现以下两个失败审核条目：

第一个事件：

事件类别：帐户登录
事件 ID：680
记录尝试：MICROSOFT_AUTHENTICATION_PACKAGE_V1_0
登录帐户：ASPNET
源工作站：
错误代码：0xC0000234

第二个事件：

事件类别：登录/注销
事件 ID：529
登录失败：
原因：未知用户名或密码错误
用户名：ASPNET
域：（MyDomain）
登录类型：3
登录过程：NtLmSsp
身份验证包：NTLM
工作站名称：（MyWorkstationId）
调用者用户名称： -
呼叫者域： -
呼叫者登录 ID： -
呼叫者进程 ID： -
中转服务： -
源网络地址： 10.12.13.35
源端口： 1708

模拟设置为真，用户名和密码为空。它使用远程 IIS 服务器上的 ASPNET 帐户。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T00:18:14.083

如果是身份问题，您可以尝试将 IIS 5.1 应用程序设置为使用[Integrated Windows Authentication](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5f8fe119-4095-4094-bba5-7dec361c7afe.mspx?mfr=true)，然后将以下内容添加到您的 IIS5.1 网站上的 system.web 下的 web.config 以启用[模拟](http://msdn.microsoft.com/en-us/library/72wdk8cc(VS.71).aspx)。

```
<identity impersonate="true"/>
<authentication mode="Windows" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-03T20:12:48.023

这看起来可能是一个双跳问题。如果您使用 NTLM 模拟网站的当前用户，则该模拟仅在该服务器上有效（在这种情况下是您的 IIS 5.1 服务器）。如果您尝试使用该网站连接到另一台服务器，您实际上会遇到问题，因为它无法将令牌传递给在模拟期间使用的另一台服务器。如果您正在通过您的机器调试您的站点，并且转到另一个盒子，那么情况也是如此。您的本地计算机正在对您进行身份验证，但它无法将您模拟到另一台服务器。

我过去使用的所有解决方案都要求您对应用程序池进行硬编码以使用具有权限的帐户，设置 annony。帐户到在另一台机器上具有权限的域帐户，或使用在域帐户下运行在 IIS 5.1 机器上的 windows 服务连接到另一台服务器。

如果您使用的是 Kerberos，这将不适用，但 AD 默认使用 NTLM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T16:24:07.360

由于这是一个 ASP.NET 应用程序，它在 IIS 的应用程序池中运行。此应用程序池使用特定用户（“本地系统”、“网络服务”或其他用户）运行。

该用户是否有足够的权限连接到远程服务器？

[有关详细信息，请参阅 MSDN。](http://msdn.microsoft.com/en-us/library/ms998320.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-05T13:01:42.160

当我遇到这个问题时，我发现只需在 Windows 文件共享上验证我自己就可以解决问题。根据经验，我认为 WMI/ADSI/COM 对尚未经过身份验证的用户没有很好的支持。我相信当您没有与 Windows 域关联时会出现此问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T19:59:54.267

我现在有点难过为什么你不能让它工作。您可以尝试一个临时工作。实例化`DirectoryEntry`对象时，您可以使用以下构造函数重载之一：

```
public DirectoryEntry(
    string path,
    string username,
    string password
) 
```

记录在：[MSDN：DirectoryEntry 构造函数（字符串、字符串、字符串）](http://msdn.microsoft.com/en-us/library/bw8k1as4.aspx)

...或者...

```
public DirectoryEntry(
    string path,
    string username,
    string password,
    AuthenticationTypes authenticationType
) 
```

记录于：[MSDN：DirectoryEntry 构造函数（字符串、字符串、字符串、AuthenticationTypes）](http://msdn.microsoft.com/en-us/library/wh2h7eed.aspx)

碰巧我正在我的虚拟服务器上构建一个测试 AD 环境，以便一个新项目做类似的事情。当我启动并运行它时，我会试一试，看看我是否可以重现您遇到的问题。同时，让我们知道如果您尝试上面引用的这些构造函数重载会发生什么。

**更新（回应迈克尔斯的评论）：**

由于我刚才回避的原因，我们不能`DirectoryEntry.Exists()`在特定场景中使用，有一段代码在我们的一个应用程序中不时被调用：

```
public static bool MetabasePathExists(string metabasePath)
{
  try
  {
    using(DirectoryEntry site = new DirectoryEntry(metabasePath))
    {
      if(site.Name != String.Empty)
      {
        return true;
      }
      return false;
    }
  }
  catch(COMException ex)
  {
    if(ex.Message.StartsWith("The system cannot find the path specified"))
    {
      return false;
    }
    LogError(ex, String.Format("metabasePath={0}", metabasePath));
    throw;
  }
  catch(Exception ex)
  {
    LogError(ex, String.Format("metabasePath={0}", metabasePath));
    throw;
  }
} 
```

您可以将构造函数替换为上面的构造函数之一。诚然，这是在黑暗中刺伤:)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T01:58:07.577

您到底想在哪里阅读？它与您的应用程序在同一路径下吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-14T17:26:05.267

我相信 DirectoryEntry.Exists 会默默地忽略提供的任何凭据并使用经过身份验证的用户的凭据。这似乎与您描述的行为相匹配。对于广告工作，我们从不因为这个原因使用它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-11T01:23:43.857

如果确实是 NTLM 双跳问题，您可以使用 SETSPN 实用程序为目标 IIS 服务器创建服务主体命名实例。

然后您可以进入 Active Directory，然后允许计算机对象（基本上是 NETWORK SERVICE 或 LOCAL SERVICE 主体）将其凭据委托给正确注册的 SPN。

然后你就可以到处蹦蹦跳跳了！但是，请注意！当您启用双跳时，人们可能会在尖锐的东西上伤害自己！

值得阅读的好知识库文章：

[http://support.microsoft.com/kb/929650](http://support.microsoft.com/kb/929650)

# svn - 具有设置多个用户的能力的 SVN 或 CVS？

> ID：637099
> 
> 赞同：1
> 
> 时间：2009-03-12T01:49:13.077
> 
> 标签：svn, cvs

我正在尝试找到一个带有 SVN 或 CVS 源代码控制的私人网站托管服务，它使我能够设置多个用户，以便不同地方的所有团队成员都可以单独登录并处理同一个项目。

它将具有 PHP、Perl、SQL 数据库等开发功能。还有无限流量和红宝石。

有谁知道我怎么能得到这个？

太感谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T02:09:24.040

我多年来一直在使用[http://dreamhost.com/](http://dreamhost.com/)并且没有任何抱怨。

以下是它们的功能列表，它支持您需要的一切并且非常便宜：[http ://dreamhost.com/hosting.html](http://dreamhost.com/hosting.html)

基本套餐是每月 6 美元，如果您想注册，请随时使用我的推荐链接：[http](http://www.dreamhost.com/r.cgi?130790) ://www.dreamhost.com/r.cgi?130790 ，如果您不想使用它，请不要不用担心:)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T02:01:50.580

您可以考虑使用 VPS（虚拟专用服务器）......这就像拥有自己的服务器，基本上可以安装任何您想要的东西。Ruby、PHP、Perl、SVN、MySQL 或任何您喜欢的 SQL。缺点：它们不是免费的，尽管您可以每月 20 美元左右获得入门级 VPS（对于包括开发在内的许多事情来说已经足够）。此外，您不会获得无限带宽，但任何网络托管服务都是如此。在实践中，限制通常足够高，您不必担心会碰到它们。（当然，您团队中的某个人必须知道如何管理服务器）

如果你决定走这条路：我是 Slicehost 的客户，我对他们只有表扬。仅限 Linux。

# java - Java：将 pdf 文件从 URL 读取到小程序中的字节数组/字节缓冲区中

> ID：637100
> 
> 赞同：8
> 
> 时间：2009-03-12T01:49:59.377
> 
> 标签：java, pdf, applet

我试图弄清楚为什么这段特定的代码对我不起作用。我有一个小程序，它应该读取 .pdf 并使用 pdf-renderer 库显示它，但是由于某种原因，当我读取位于我的服务器上的 .pdf 文件时，它们最终会损坏。我已经通过再次写回文件来测试它。

我尝试在 IE 和 Firefox 中查看小程序，并且出现损坏的文件。有趣的是，当我尝试在 Safari（适用于 Windows）中查看小程序时，该文件实际上很好！我知道 JVM 可能会有所不同，但我仍然迷路了。我已经在 J​​ava 1.5 中编译。JVM 是 1.6。读取文件的片段如下。

```
public static ByteBuffer getAsByteArray(URL url) throws IOException {
        ByteArrayOutputStream tmpOut = new ByteArrayOutputStream();

        URLConnection connection = url.openConnection();
        int contentLength = connection.getContentLength();
        InputStream in = url.openStream();
        byte[] buf = new byte[512];
        int len;
        while (true) {
            len = in.read(buf);
            if (len == -1) {
                break;
            }
            tmpOut.write(buf, 0, len);
        }
        tmpOut.close();
        ByteBuffer bb = ByteBuffer.wrap(tmpOut.toByteArray(), 0,
                                        tmpOut.size());
        //Lines below used to test if file is corrupt
        //FileOutputStream fos = new FileOutputStream("C:\\abc.pdf");
        //fos.write(tmpOut.toByteArray());
        return bb;
} 
```

我一定是错过了什么，我一直在努力想弄清楚。任何帮助是极大的赞赏。谢谢。

* * *

**编辑：** 为了进一步澄清我的情况，我阅读之前的文件与片段和之后的区别在于，我在阅读后输出的文件比原来的要小得多。打开它们时，它们不会被识别为 .pdf 文件。没有抛出我忽略的异常，并且我尝试刷新无济于事。

此片段在 Safari 中有效，这意味着文件被完整读取，大小没有差异，并且可以使用任何 .pdf 阅读器打开。在 IE 和 Firefox 中，文件最终总是被损坏，并且大小始终相同。

我监视了 len 变量（在读取 59kb 文件时），希望查看在每个循环中读取了多少字节。在 IE 和 Firefox 中，在 18kb 处，in.read(buf) 返回 -1，就好像文件已经结束一样。Safari 不这样做。

我会坚持下去，我很感激到目前为止的所有建议。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-12T05:17:02.467

以防万一这些小的变化有所作为，试试这个：

```
public static ByteBuffer getAsByteArray(URL url) throws IOException {
    URLConnection connection = url.openConnection();
    // Since you get a URLConnection, use it to get the InputStream
    InputStream in = connection.getInputStream();
    // Now that the InputStream is open, get the content length
    int contentLength = connection.getContentLength();

    // To avoid having to resize the array over and over and over as
    // bytes are written to the array, provide an accurate estimate of
    // the ultimate size of the byte array
    ByteArrayOutputStream tmpOut;
    if (contentLength != -1) {
        tmpOut = new ByteArrayOutputStream(contentLength);
    } else {
        tmpOut = new ByteArrayOutputStream(16384); // Pick some appropriate size
    }

    byte[] buf = new byte[512];
    while (true) {
        int len = in.read(buf);
        if (len == -1) {
            break;
        }
        tmpOut.write(buf, 0, len);
    }
    in.close();
    tmpOut.close(); // No effect, but good to do anyway to keep the metaphor alive

    byte[] array = tmpOut.toByteArray();

    //Lines below used to test if file is corrupt
    //FileOutputStream fos = new FileOutputStream("C:\\abc.pdf");
    //fos.write(array);
    //fos.close();

    return ByteBuffer.wrap(array);
} 
```

如果您的应用程序仍在运行或突然终止，您忘记关闭`fos`可能会导致该文件更短。另外，我添加了创建`ByteArrayOutputStream`具有适当初始大小的 。（否则 Java 将不得不重复分配一个新数组并复制，分配一个新数组并复制，这很昂贵。）将值 16384 替换为更合适的值。16k 对于 PDF 来说可能很小，但我不知道如何，但“平均”大小是您希望下载的。

由于您使用`toByteArray()`了两次（即使一个在诊断代码中），我将其分配给了一个变量。最后，虽然它不应该有任何区别，但当您将**整个**数组包装在 ByteBuffer 中时，您只需要提供字节数组本身。提供偏移量`0`和长度是多余的。

请注意，如果您以这种方式下载**大型**PDF 文件，请确保您的 JVM 运行在足够大的堆上，以便您有足够的空间容纳您预期读取的最大文件大小的几倍。您使用的方法将整个文件保存在内存中，只要您负担得起该内存就可以。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T07:47:13.760

您是否`flush()`在关闭`tmpOut`流之前尝试过以确保写出所有字节？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-03T16:04:29.353

我以为我和你有同样的问题，但事实证明我的问题是我假设你总是得到完整的缓冲区，直到你什么也没得到。但你不认为。网上的例子（例如[java2s/tutorial](http://www.java2s.com/Tutorial/Java/0320__Network/SavebinaryfilefromURL.htm)）使用了 BufferedInputStream。但这对我来说没有任何区别。

你可以检查你是否真的在你的循环中得到了完整的文件。比问题出在 ByteArrayOutputStream 中。

# apache-flex - 将 Flex3 项目置于源代码控制下的最佳方法是什么（颠覆）

> ID：637105
> 
> 赞同：1
> 
> 时间：2009-03-12T01:51:46.393
> 
> 标签：apache-flex, flex3, flex-builder-3

为小组开发设置 Flex 项目可能有点棘手。有很多小的本地设置可能需要调整，以便有一个可以轻松签出的项目。

我使用内置的导入/导出 flex 项目实用程序取得了有限的成功。我似乎经常手工编辑，我想我可能会遗漏一些东西。

**更新** 我最初忽略了提到我的目标是使从颠覆中签出项目并尽可能少地启动和运行成为可能。我遇到的最大问题都围绕着管理“点”文件以及如何使它们足够灵活以处理不同的开发人员环境。

例如，即使只有我一个人，我也希望有这样的能力：在工作中，我使用 Vista 机器，在家里我使用 Mac。某些路径的描述方式肯定存在差异，但它们确实非常相似。在 Vista 上，flex 根目录是 c:/ColdFusion8/wwwroot，在 OS X 上是 /Applications/ColdFusion8。我已经能够为 CF_FLEX_SERVER 和 WEBSERVER 设置链接资源路径变量，然后我使用 ${WEBSERVER}/myProject 语法来引用它。

到目前为止，它似乎工作得很好，但我发现有几个地方仍然存在问题。具体来说，在 .project 文件中，您会发现类似以下内容：

```
<linkedResources>
    <link>
        <name>bin-debug</name>
        <type>2</type>
        <location>c:/inetpub/wwwroot/myProject-debug</location>
    </link>
</linkedResources> 
```

不幸的是，如果我尝试将位置实体更改为 ${WEBSERVER}/wwwroot/myProject-debug，flex 会引发编译器错误。这是一种耻辱，因为几乎所有其他的工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T01:58:16.127

由于 Flex Builder 是在 Eclipse 之上编写的，因此它可以与[Subclipse](http://subclipse.tigris.org/)集成。这使您可以很容易地将文件标记为“SVN 忽略”以避免特定于项目的设置。我已经使用它来将我的 Flex 项目添加到现有的 SVN 存储库，我已将其签出到多个站点。我注意到这里和那里的一些问题（一些签入会出错，但它们相对罕见），但它通常有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T08:34:24.210

我之前已经解决过这个问题，并且通常将我的项目设置为：

> Application/trunk/source/ <-- 工作区在这里（也可以在'trunk'中） Application/trunk/source/Application <-- 应用在这里

我确实将我的项目（.actionScriptProperties、.flexProperties、.project、.settings）保留在 SVN 中，但不是我的工作区（.metadata），因为它太大了。

我发现通过 Import -> Flex Project 导入项目会实施很多限制。例如，如果您的工作区位于上面的“主干”目录中，那么作为 Flex 项目导入将导致项目被复制到主干/应用程序中，或者只是抱怨该位置。

更好的方法是创建工作区，然后将 Import -> [General] Existing Projects into Workspace。唯一的区别是您必须手动添加 Flex Development 透视图。

**编辑：**我还建议您将编译器选项设置为“使用默认 SDK”，然后将相应的 SDK 设置为默认值。当每个开发人员以不同的方式命名他的 SDK 时，这将防止提交网球。

# javascript - 用于 html div 的 Mootools 灯箱？

> ID：637106
> 
> 赞同：2
> 
> 时间：2009-03-12T01:53:51.193
> 
> 标签：javascript, html, xhtml, mootools, lightbox

我想知道是否有人遇到过 mootools 的插件，该插件会在单击链接时将隐藏的 div（其中包含嵌入的视频）显示为灯箱。

我想要的有点像苹果预告片网站如何显示嵌入式快速播放器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T16:36:11.117

[试试 Shadowbox.js](http://www.shadowbox-js.com/) ……它支持多种框架（MooTools、jQuery 等）、多种播放器（img、iframe、html）和许多其他选项。

您还可以查看[此矩阵](http://planetozh.com/projects/lightbox-clones/)以查看流行的 Lightbox 克隆及其功能的概述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T02:05:42.990

[Clientcide](http://www.clientcide.com/wiki/cnet-libraries/07-ui/07-stickywin.modal)有一个可能会起作用。你也可以试试[Milkbox](http://reghellin.com/milkbox/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T14:36:42.037

您也可以尝试 moodalbox - 不确定它与我没有使用过的 milkbox 相比如何，但 moodalbox 应该能够做到：[http ://www.e-magine.ro/web-dev-and-design/ 36/模态框/](http://www.e-magine.ro/web-dev-and-design/36/moodalbox/)

# java - 将代码从使用计时器移植到调度的执行器服务

> ID：637110
> 
> 赞同：2
> 
> 时间：2009-03-12T01:55:51.920
> 
> 标签：java, timer, executorservice

我正在尝试将代码从使用 java[计时器](http://java.sun.com/j2se/1.3/docs/api/java/util/Timer.html)移植到使用[scheduleexecutorservice](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ScheduledExecutorService.html)

我有以下用例

```
class A {

    public boolean execute() {
         try {
              Timer t = new Timer();
              t.schedule (new ATimerTask(), period, delay);
         } catch (Exception e) {
              return false;
         }
    }

}

class B {

    public boolean execute() {
         try {
              Timer t = new Timer();
              t.schedule (new BTimerTask(), period, delay);
         } catch (Exception e) {
              return false;
         }
    }

} 
```

我是否应该将 A 类和 B 类中的 Timer 实例替换为 ScheduledExecutorService 并将 ATimerTask 和 BTimerTask 类设为 Runnable 类，例如

```
class B {

    public boolean execute() {
         try {
              final ScheduledExecutorService scheduler = 
   Executors.newScheduledThreadPool(1);

              scheduler.scheduleWithFixedDelay (new BRunnnableTask(), period, delay);
         } catch (Exception e) {
              return false;
         }
    }

} 
```

它是否正确。

编辑：移植的主要动机之一是因为 TimerTask 中引发的运行时异常会杀死一个线程并且无法进一步安排它。我想避免这种情况，这样即使我有运行时异常，线程也应该继续执行而不是停止。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T05:29:56.943

**注意：您这样做的方式会泄漏线程！**

如果您的课程`B`将被保留并且*每个实例*最终将被关闭或关闭或释放，我会这样做：

```
class B {
  final ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);

  public boolean execute() {
    try {
      scheduler.scheduleWithFixedDelay(new BRunnnableTask(), period, delay);
      return true;
    } catch (Exception e) {
      return false;
    }
  }

  public void close() {
    scheduler.shutdownNow();
  }
} 
```

如果您不对每个实例进行这种清理，那么我会这样做：

```
class B {
  static final ScheduledExecutorService SCHEDULER = Executors.newCachedThreadPool();

  public boolean execute() {
    try {
      SCHEDULER.scheduleWithFixedDelay(new BRunnnableTask(), period, delay);
      return true;
    } catch (Exception e) {
      return false;
    }
  }
} 
```

您在代码中分配的每个`ExecutorService`分配一个`Thread`. 如果你为你的类创建了许多实例，`B`那么每个实例都将被分配一个`Thread`. 如果这些不能快速收集垃圾，那么您最终可能会分配数千个线程（但未使用，只是分配）并且您可能会崩溃整个服务器，使机器上的每个进程都饿死，而不仅仅是您自己的 JVM。我已经看到它发生在 Windows 上，我希望它也可以发生在其他操作系统上。

当您不打算在单个对象实例上使用生命周期方法时，静态缓存线程池通常是一种安全的解决方案，因为您只会保留实际*运行*的线程数，而不是为您创建的每个实例保留一个线程尚未收集垃圾。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T02:12:04.643

看起来不错。根据您正在做的事情，您可能希望保留 executor service 作为成员，以便您可以再次使用它。此外，您可以从 scheduleXX() 方法中获取 ScheduledFuture。这很有用，因为您可以对其调用 get() 以将定时线程中发生的任何异常拉回控制线程进行处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-25T14:04:27.450

目前在 Executors 框架中没有很好的方法来处理重复的任务。

它的设计确实没有考虑到这个用例，也没有现实的方法来避免吞下异常。

如果您确实必须将其用于重复任务，则每个调度应如下所示：

```
scheduler.scheduleWithFixedDelay(new Runnable() {
  public void run() {
     try {
       .. your normal code here...
     } catch (Throwable t) {
       // handle exceptions there
     }
  }
}, period, delay); 
```

# javascript - 这些跨浏览器 Javascript 函数中哪一个性能更好？

> ID：637111
> 
> 赞同：3
> 
> 时间：2009-03-12T01:56:55.803
> 
> 标签：javascript, performance, cross-browser

根据经验，在这些编写跨浏览器 Javascript 函数的方法中，哪一种性能更好？

**方法一**

```
function MyFunction() 
{
    if (document.browserSpecificProperty)
       doSomethingWith(document.browserSpecificProperty);
    else
       doSomethingWith(document.someOtherProperty);
} 
```

**方法二**

```
var MyFunction;
if(document.browserSpecificProperty) {
    MyFunction = function() {
       doSomethingWith(document.browserSpecificProperty);
    };
} else {
    MyFunction = function() {
       doSomethingWith(document.someOtherProperty);
    };
} 
```

**编辑：**赞成到目前为止所有的好答案。我已将该函数修复为更正确的语法。

到目前为止，关于答案的几点说明 - 虽然在大多数情况下，这是一种相当无意义的性能增强，但仍有一些原因可能需要花一些时间分析代码：

*   必须在慢速计算机、移动设备、旧浏览器等上运行。
*   好奇心
*   使用相同的一般原则来提高其他场景的性能，其中 IF 语句的评估*确实* 需要一些时间。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-12T02:02:39.127

除非你这样做一万亿次，否则没关系。选择对您和/或您的组织更具可读性和可维护性的版本。编写干净、简单的代码所带来的生产力提升比将 JS 执行时间缩短十分之一微秒更重要。

您甚至应该开始*考虑*什么*时候且仅在*您编写代码并且速度慢得令人无法接受时才能更好地执行。然后你应该开始追踪瓶颈，这永远不会是这样的。在这里从一个切换到另一个，您永远不会获得可衡量的性能提升。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-12T03:22:12.213

不幸的是，上面的代码实际上并不是跨浏览器友好的，因为它依赖于其他浏览器中不存在的 mozilla 怪癖——即`function` *语句*被视为分支内的`function` *表达式。*在非 Mozilla 上构建的其他浏览器上，上述代码将始终使用第二个函数定义。[我在这里](http://nerget.com/jstests/functionDeclarations.html)做了一个简单的测试用例来证明这一点。

基本上，ECMAScript 规范说函数语句的处理方式与 var 声明类似，例如。它们都被提升到当前执行范围的顶部（例如 <script> 标记的开头、函数的开头或 eval 块的开头）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T03:41:02.213

To clarify olliej's answer, your second method is technically a syntax error. You could rewrite it this way:

```
var MyFunction;
if(document.browserSpecificProperty) {
    MyFunction = function() {
       doSomethingWith(document.browserSpecificProperty);
    };
} else {
    MyFunction = function() {
       doSomethingWith(document.someOtherProperty);
    };
} 
```

Which is at least correct syntax, but note that MyFunction would only be available in the scope in which that occurs. (Omit `var MyFunction;`, and preferably use `window.MyFunction = function() ...` for global.)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T02:43:07.423

从技术上讲，我会说第二个会执行得更好，因为 if 语句只执行一次，而不是每次运行函数时。

但是，差异可以忽略不计，以至于毫无意义。即使与简单地调用函数的性能损失相比，像这样的单个 if 语句的性能损失也微不足道。即使被调用一百万次，它也会产生很小的差异。

第一个更容易理解，因为它没有基于条件两次定义相同函数的尴尬，两个版本的行为不同。这似乎是后来混淆的秘诀。

我不会是第一个说除非你真的对这个优化很疯狂的人，否则你会从代码可读性中获得更多的胜利。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T11:30:40.853

我通常更喜欢第二个版本，因为条件只需要评估一次，而不是每次调用，但有时它并不真正可行，因为它会妨碍可读性。

顺便说一句，这是您可能想要使用`?:`运算符的情况，例如（取自生产代码）：

```
var addEvent =
    document.addEventListener ? function(type, listener) {
        document.addEventListener(type, listener, false);
    } :
    document.attachEvent ? function(type, listener) {
        document.attachEvent('on' + type, listener);
    } :
    throwError; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-14T03:32:14.377

对于您的简化示例，假设您的浏览器属性检查只需要执行一次，我将执行以下操作：

```
var MyFunction = (function() {

      var rightProperty = document.browserSpecificProperty || document.someOtherProperty;

      return function doSomethingWith() {
            // use the rightProperty variable in your function
      }
})(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-14T03:36:48.077

性能应该几乎相等！

关于使用 JQuery 之类的框架来摆脱浏览器兼容性问题的事情！

如果性能是您的主要目标，请查看[SlickSpeed](http://mootools.net/slickspeed/)！这是一个对不同 JavaScript 框架进行基准测试的页面！

# c# - 如何从 LINQ DataContext.SubmitChanges() 获取 TSQL 查询

> ID：637117
> 
> 赞同：16
> 
> 时间：2009-03-12T01:58:45.207
> 
> 标签：c#, linq, linq-to-sql, datacontext, submitchanges

我正在使用 Linq to SQL。我有一个 DataContext，我正在针对它 .SubmitChanges()'ing。插入标识字段时出错，我想查看它用于插入此标识字段的查询。

我在快速监视中看不到查询本身；我在哪里可以从调试器中找到它？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-12T02:11:48.763

很多人一直在编写自己的“DebugWriter”并像这样附加它：

```
// Add this class somewhere in your project...
class DebugTextWriter : System.IO.TextWriter {
   public override void Write(char[] buffer, int index, int count) {
       System.Diagnostics.Debug.Write(new String(buffer, index, count));
   }

   public override void Write(string value) {
       System.Diagnostics.Debug.Write(value);
   }

   public override Encoding Encoding {
       get { return System.Text.Encoding.Default; }
   }
}

// Then attach it to the Log property of your DataContext...
myDataContext.Log = new DebugTextWriter() 
```

这会将 Linq-to-Sql 正在执行的所有操作输出到 Visual Studio 的调试窗口中。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-12T03:00:15.447

除了[波特曼的回答](https://stackoverflow.com/questions/637117/how-to-get-the-tsql-query-from-linq-datacontext-submitchanges/637151#637151)，如果你是一个控制台应用程序，它就像这样简单：

```
myDataContext.Log = Console.Out; 
```

或者您可以使用 Linq2SQL Profiler 之类的工具，它是一个相当出色的工具，实际上是完成这项工作的正确工具：

> [Linq to SQL Profiler - Linq to SQL 的实时可视化调试器](https://web.archive.org/web/20091119070919/http://l2sprof.com/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-21T12:42:43.557

您的问题实际上有一个非常简单的答案

只需将其粘贴到您的监视窗口中

```
((System.Data.Objects.ObjectQuery)myLinqQueryVar).ToTraceString() 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T02:02:32.233

如果有，请运行 SQL Profiler。它将显示到您的数据库的所有流量，包括 SQL 命令文本。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-09-17T21:58:55.970

```
FooDataContext dc = new FooDataContext();

StringBuilder sb = new StringBuilder();
dc.Log = new StringWriter(sb);

var result=from r in dc.Tables select d;

.....
string query=sb.ToString(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-06T19:39:19.427

我同意 Linq to SQL Profiler 是完成这项工作的正确工具。但是如果你不想花钱或者只需要做一些简单的事情，我喜欢 DebugTextWriter 方法。

阅读完这个问题后，我开始寻找更强大的东西。事实证明，Damien Guard 还[写了一篇非常好的文章](http://damieng.com/blog/2008/07/30/linq-to-sql-log-to-debug-window-file-memory-or-multiple-writers)，关于构建不同的编写器来处理不同的事情，比如输出到内存、调试、文件、多个目标，甚至使用简单的委托。

我最终使用了他的一些想法并编写了一个可以处理多个委托的 ActionTextWriter，我想我会在这里分享它：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;

namespace Writers
{
    public class ActionTextWriter : TextWriter
    {
        protected readonly List<Action<string>> Actions = new List<Action<string>>();

        public ActionTextWriter(Action<string> action)
        {
            Actions.Add(action);
        }

        public ActionTextWriter(IEnumerable<Action<string>> actions)
        {
            Actions.AddRange(actions);
        }

        public ActionTextWriter(params Action<string>[] actions)
        {
            Actions.AddRange(actions);
        }

        public override Encoding Encoding
        {
            get { return Encoding.Default; }
        }

        public override void Write(char[] buffer, int index, int count)
        {
            Write(new string(buffer, index, count));
        }

        public override void Write(char value)
        {
            Write(value.ToString());
        }

        public override void Write(string value)
        {
            if (value == null)
            {
                return;
            }

            foreach (var action in Actions)
            {
                action.Invoke(value);
            }
        }
    }
} 
```

您可以添加任意数量的操作。此示例通过 Debug.Write 写入日志文件和 Visual Studio 中的控制台：

```
// Create data context
var fooDc = new FooDataContext();

// Create writer for log file.
var sw = new StreamWriter(@"C:\DataContext.log") {AutoFlush = true};

// Create write actions.
Action<string> writeToDebug = s => Debug.Write(s);
Action<string> writeToLog = s => sw.Write(s);

// Wire up log writers.
fooDc.Log = new ActionTextWriter(writeToDebug, writeToLog); 
```

当然，如果您想制作更简单的即用型，您可以随时*扩展*ActionTextWriter... 编写通用方法并重用，对吗？

```
using System.Diagnostics;
using System.IO;

namespace Writers
{
    public class TraceTextWriter : ActionTextWriter
    {
        public TraceTextWriter()
        {
            Actions.Add(s => Trace.Write(s));
        }
    }

    public class FileTextWriter : ActionTextWriter
    {
        public FileTextWriter(string path, bool append = false)
        {
            var sw = new StreamWriter(path, append) {AutoFlush = true};
            Actions.Add(sw.Write);
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-07-31T07:38:50.380

这是详细说明：[http ://debugmode.net/2011/06/26/logging-in-linq-to-sql/](http://debugmode.net/2011/06/26/logging-in-linq-to-sql/)

# c++ - std::stringstream 奇怪的行为

> ID：637118
> 
> 赞同：0
> 
> 时间：2009-03-12T01:58:55.907
> 
> 标签：c++, stl, string, libstdc++

一些背景信息，对于家庭作业，我必须使用二叉树编写波兰符号计算器，为此我必须解析命令行输入，以便正确构建二叉树，然后对其进行检查以给出有效答案到输入的数学表达式。

对于解析，我使用了 std::stringstream，以便能够轻松地将我收到的 std::string 转换为有效的浮点数（或整数、双精度）。我遇到的问题是以下代码，其中显示了错误以及我如何解决该问题。我希望有人能够告诉我我是否做错了什么并且 .clear() 不正确，或者这是标准库中处理此特定输入的方式的错误（仅发生在 +和 -）。

```
#include <iostream>
#include <sstream>
#include <string>

int main() {
    std::string mystring("+");
    int num;
    char op;

    std::stringstream iss(mystring);
    iss >> num;

    // Seems it is not a number 
    if (iss.fail()) {
            // This part does not work as you would expect it to

            // We clear the error state of the stringstream
            iss.clear();
            std::cout << "iss fail bit: " << iss.fail() << std::endl;
            iss.get(op);
            std::cout << "op is: " << op << " iss is: " << iss.str() << std::endl;
            std::cout << "iss fail bit: " << iss.fail() << std::endl;

            // This however works as you would expect it to
            std::stringstream oss(iss.str());
            std::cout << "oss fail bit: " << oss.fail() << std::endl;
            oss.get(op);
            std::cout << "op is: " << op << " oss is: " << oss.str() << std::endl;
            std::cout << "oss fail bit: " << oss.fail() << std::endl;

    } else {
            // We got a number
    }   
} 
```

程序的示例输出：

```
iss fail bit: 0
op is:  iss is: +
iss fail bit: 1
oss fail bit: 0
op is: + oss is: +
oss fail bit: 0 
```

也许你们会看到我错过的东西，或者如果这确实是我的程序之外的一个错误，在这种情况下，关于在哪里报告这个问题的指针将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T02:13:16.433

当你说：

```
 iss.clear();
  std::cout << "iss fail bit: " << iss.fail() << std::endl;
  iss.get(op); 
```

您正在尝试阅读已经阅读过的内容。您需要重置流读取指针：

```
 iss.clear();
  iss.seekg(0);    // start again
  std::cout << "iss fail bit: " << iss.fail() << std::endl;
  iss.get(op); 
```

# sql - SQL：过滤两个列值的组合

> ID：637120
> 
> 赞同：2
> 
> 时间：2009-03-12T02:01:09.833
> 
> 标签：sql, sybase

我有一个`balances`包含以下列的表格：

```
bank | account | date | amount 
```

我还有一个表`accounts`，它具有`bank`和`account`作为其复合主键。

我想做一个类似以下伪代码的查询：

```
select date, sum(amount) as amount from balances where 
bank and account in (list of bank and account pairs) group by date 
```

银行账户对列表由客户提供。我该怎么做呢？创建一个临时表并加入它？

我正在使用 Sybase

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T02:09:21.497

如果您的应用程序中已知银行账户对，您只需编写：

```
(bank = 1 AND account = 2) OR (bank = 3 AND account = 4) OR ... 
```

如果银行账户对列表是子查询，则编写如下内容：

```
SELECT * FROM balances b LEFT JOIN bank_account_pairs p ON ...
WHERE b.bank = p.bank AND b.account = p.account AND ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T02:06:02.083

了解更多信息可能会有所帮助。

如果您有驱动特定银行和账户实体列表的标准，那么您应该加入这些表格。

你确实有一个银行表和一个帐户表，不是吗？

假设您在帐户表中有信息可以缩小要引用的特定帐户的范围，例如假设您的帐户表有一个 IsActive char(1) NOT NULL 字段，并且您想要非活动帐户的余额，您可以编写类似这样的内容：

```
SELECT date, sum( amount ) AS amount
FROM Balances b 
     INNER JOIN Accounts a 
     ON b.Bank = a.Bank AND b.Account = a.Account
WHERE a.IsActive = 'N' 
```

从设计的角度来看，您可能应该创建一个人工键来删除跨表的非标识数据的复制。这会给你这样的东西：

```
CREATE TABLE Accounts ( 
    AccountId int identity(1,1) NOT NULL,
    Bank nvarchar(15) NOT NULL,
    Account nvarchar(15) NOT NULL
)

CREATE TABLE Balances ( 
    AccountId int,
    Date datetime, 
    Amount money
) 
```

这允许编辑银行或帐户字段中的错误，而无需将这些更改级联到余额表以及稍微简单的查询。

```
SELECT date, sum( amount ) AS amount
FROM Balances b 
     INNER JOIN Accounts a 
     ON b.AccountId = a.AccountId
WHERE a.IsActive = 'N' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T02:05:40.603

内部连接将强制执行银行+帐户组合，但您必须小心返回比预期更多的行，尤其是在求和时。

像下面这样的东西可能会起作用，尽管它取决于 Sybase 是否支持它

```
select b.date, sum(b.amount) as amount
from balances as b
where exists (select 1 from backaccounts as ba where ba.bank = b.bank and ba.account = b.account)
group by b.date 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T02:25:20.180

如果你不想做一个临时表，一个解决方案是这样的：

```
select bank, account, sum(amount)
from balances,
(select 'XXX' as bank, 13232 as account
  union all
 select 'YYY' as bank, 138232 as account
  union all
 select 'ZZZ' as bank, 183823 as account) banks
where balances.bank = banks.bank
  and balances.account = banks.account 
```

如果您的应用程序可以处理它，最好的选择可能是这样的：

```
select bank, account, sum(amount)
from balances
where (bank = 'XXX' and account = 123i832)
    or (bank = 'YYY' and account = 28323)
    or (bank = 'ZZZ' and account = 2839283) 
```

# c# - Linq to SQL：为什么会出现 IDENTITY_INSERT 错误？

> ID：637121
> 
> 赞同：6
> 
> 时间：2009-03-12T02:01:48.863
> 
> 标签：c#, linq, linq-to-sql, identity-insert

我正在使用 Linq to SQL。我有一个 DataContext，我正在针对它 .SubmitChanges()'ing。插入标识字段时出错：

```
当 IDENTITY_INSERT 设置为 OFF 时，无法在表“Rigs”中插入标识列的显式值。
```

唯一的身份字段是“ID”，其值为 0。它在 DBML 中定义为：

```
[Column(Storage="_ID", AutoSync=AutoSync.OnInsert, DbType="Int NOT NULL IDENTITY", IsPrimaryKey=true, IsDbGenerated=true)] 
```

有一些外键，我已经验证它们的值与外表的内容相匹配。

为什么我会收到此错误？

编辑：这是查询：

```
exec sp_executesql N'INSERT INTO [dbo].[Rigs]([id], [Name], [RAM], [Usage], [MoreInfo], [datetime], [UID])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6)
SELECT [t0].[id], [t0].[OSID], [t0].[Monitors]
FROM [dbo].[Rigs] AS [t0]
WHERE [t0].[id] = @p7',N'@p0 int,@p1 varchar(1),@p2 int,@p3 varchar(1),@p4 varchar(1),@p5 datetime,@p6 int,@p7 
int',@p0=0,@p1='1',@p2=NULL,@p3='4',@p4='5',@p5=''2009-03-11 20:09:15:700'',@p6=1,@p7=0 
```

显然它传递了一个零，尽管从未被分配过一个值。

编辑：添加代码：

```
Rig rig = new Rig();
int RigID;
try
{ // Confirmed these always contain a nonzero value or blank
    RigID = int.Parse(lbSystems.SelectedValue ?? hfRigID.Value);
    if (RigID > 0) rig = mo.utils.RigUtils.GetByID(RigID);
}
catch { }

rig.Name = Server.HtmlEncode(txtName.Text);
rig.OSID = int.Parse(ddlOS.SelectedValue);
rig.Monitors = int.Parse(txtMonitors.Text);
rig.Usage = Server.HtmlEncode(txtUsage.Text);
rig.MoreInfo = Server.HtmlEncode(txtMoreInfo.Text);
rig.RigsToVideoCards.Clear();
foreach (ListItem li in lbYourCards.Items)
{
    RigsToVideoCard r2vc = new RigsToVideoCard();
    r2vc.VCID = int.Parse(li.Value);
    rig.RigsToVideoCards.Add(r2vc);
}
rig.UID = c_UID > 0 ? c_UID : mo.utils.UserUtils.GetUserByToken(this.Master.LiveToken).ID;

if (!mo.utils.RigUtils.Save(rig))   
    throw new ApplicationException("There was an error saving your Rig. I have been notified.");
hfRigID.Value = rig.id.ToString();

public static User GetUserByToken(string token)
{
    DataClassesDataContext dc = new DataClassesDataContext(ConfigurationManager.ConnectionStrings["MultimonOnlineConnectionString"].ConnectionString);
return (from u in dc.Users
    where u.LiveToken == token
    select u).FirstOrDefault();
} 
```

另外，我注意到当我更新现有装备（insertonsubmit）时，它不会更新。Profiler 甚至不显示正在运行的任何查询。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-04-30T15:04:42.417

我对发生的事情的理论如下：

1.  您设计并创建了数据库
2.  您在 Visual Studio 中使用 LINQ TO SQL 创建了 DB 上下文
3.  您忘记将自动身份设置为您的表
4.  您通过转到数据库并设置自动标识来解决此问题
5.  **但是您忘记重新创建/更新您的 LINQ TO SQL DB 上下文！！！**

:D

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-12T02:08:27.350

您的代码是否将 ID 值明确设置为 0？（而不是让它保持不变）。

**更新 1：**正如您在更新版本上发布的那样，linq2sql 显然将值传递给 db。这是我没有遇到任何麻烦的一个：

```
[Column(Storage="_CustomerID", AutoSync=AutoSync.Always, DbType="Int NOT NULL IDENTITY", IsDbGenerated=true)]
public int CustomerID 
```

我刚刚看到另一个，它与您正在使用的定义完全相同。

```
[Column(Storage="_TestID", AutoSync=AutoSync.OnInsert, DbType="Int NOT NULL IDENTITY", IsPrimaryKey=true, IsDbGenerated=true)]
public int TestID 
```

**更新 2：**关于更新，您不应该为此执行 InsertOnSubmit。只需更新值并调用 .SubmitChanges （应该抛出异常）。在插入时真的很奇怪，因为您发布的属性似乎是正确的，所以 linq2sql 生成的 Insert 方法也应该是正确的。我会尝试，再次在设计器上重新添加表格并验证所有属性是否正确。

请注意，生成的插入方法应如下所示（使用 matchRig_Insert）：

```
private void InsertRig(Rig obj)
{
    System.Nullable<int> p1 = obj.Id; 
```

this.Rig_Insert(/* 一堆值 */, ref p1); obj.Id = p1.GetValueOrDefault(); }

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-17T20:28:06.833

确保该列的 dbml 中的属性 Auto Generated Value 设置为 true。如果不是，LINQ 将尝试根据类型默认值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T02:17:53.070

如果您提供 IDENTITY 列的值，则必须添加

```
SET IDENTITY_INSERT ON 
```

在您的 SQL 语句之前，以及

```
SET IDENTITY_INSERT OFF 
```

后将其关闭。这适用于任何原始 SQL。如果您使用 LINQ 创建一个对象，例如：

```
var customer = new LinqContext.Customer;
customer.FirstName = "Bob";
customer.LastName = "Smith";

LinqContent.Customer.Add(customer);
LinqContext.SubmitChanges(); 
```

我相信这会奏效，如果我有错误的课程，请原谅我。你得到了基本的想法。

编辑：哎呀..对不起，没有阅读整个问题，我把它收回了，因为工作累了...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T03:02:56.657

似乎您的 ID 被分配到某个地方（即使只是默认为 0） - 您是否愿意发布一些 LINQ 代码？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-12T10:09:42.687

我遇到了完全相同的问题。

我的解决方案是手动将标识 INT 列**设置为可为空的**INT？**DBML 设计器中的**列，当然不在数据库的实际表中。**还将 DbType 设置为 NULL**而不是 NOT NULL。像这样：

```
[Column(Storage="_TestID", AutoSync=AutoSync.OnInsert, DbType="Int NULL IDENTITY", IsPrimaryKey=true, IsDbGenerated=true)] 
public int? TestID 
```

这适用于所有数据库操作。插入时只需**将标识列设置为 NULL**而不是 0。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-05T03:32:35.843

我的情况是，在将 Id 列设置为标识后，我忘记更新我的 dbml 文件。

# c# - 如何确定已安装字体的 O/S 文件名？

> ID：637124
> 
> 赞同：2
> 
> 时间：2009-03-12T02:02:35.353
> 
> 标签：c#, windows, fonts

我们使用第三方 PDF 生成器库，当使用默认 PDF 标准的 14 种左右以外的字体时，该库要求您指定 TrueType 或 Type1 文件名。

所以如果我想使用`Bitstream Arrus Bold`我必须知道引用`arrusb.ttf`.

没有枚举字体文件夹中的所有文件并创建一次性 PrivateFontCollection 来提取关系，有没有办法从字体信息中获取底层字体名称，即给定 Courier New、Bold、Italic 派生`CourBI.ttf`？

我已经查看了 InstalledFontCollection 并且什么都没有。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T02:11:45.750

如果您不介意在注册表中四处寻找，请查看

```
HKLM\Software\Microsoft\Windows NT\CurrentVersion\Fonts 
```

它有对像

```
Name = "Arial (TrueType)"
Data = "arial.ttf" 
```

您可以像这样执行必要的查询：

```
static RegistryKey fontsKey =
    Registry.LocalMachine.OpenSubKey(
        @"Software\Microsoft\Windows NT\CurrentVersion\Fonts");

static public string GetFontFile(string fontName)
{
    return fontsKey.GetValue(fontName, string.Empty) as string;
} 
```

调用`GetFontFile("Arial (TrueType)")`返回`"arial.ttf"`

您当然可以修改代码以将`(TrueType)`部分附加到`fontName`，或者查看返回的所有内容`fontsKey.GetValueNames()`以找到最佳匹配。

# https - 永无止境的 https 循环

> ID：637126
> 
> 赞同：0
> 
> 时间：2009-03-12T02:02:57.317
> 
> 标签：https, security, add-on

我正在使用 Noscript 并发现它具有强制站点使用安全连接的功能，我尝试强制一些站点但是当我尝试访问其中任何一个时，我得到一个空白选项卡，并且我的状态栏就像它不断重新加载。在我找到 Noscript 选项之前，我有一个强制安全连接的 Greasemonkey 脚本，但 Greasemonkey 脚本并没有给我带来任何麻烦。知道发生了什么吗？我唯一能想到的是他们以不同的方式请求安全连接，而 Noscript 做错了，我认为这不太对。

更具体地说：Noscript 在通过安全连接显示某些与 Greasemonkey 脚本完全相同的站点时遇到问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T02:07:57.400

一些网站会将他们的 SSL 主页重定向到他们的非安全页面，以节省一些 CPU 周期，这样他们就没有 SSL 加密/解密的开销。如果您随后将其强制返回 SSL 版本，您将获得一个无限循环。

# umbraco - 在实施多语言 umbraco 3.0 时遇到问题

> ID：637137
> 
> 赞同：0
> 
> 时间：2009-03-12T02:08:05.930
> 
> 标签：umbraco, multilingual

如何实现多语种umbraco 3.0？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T08:11:14.203

对此有两种不同的方法。

Umbraco 网站上的文档描述了如何进行 1:1 多语言站点。这意味着对于每个翻译或内容，您在单个文档类型中拥有一个站点结构和不同的语言选项卡。然后通过使用网站上的页面选择器（标志图标等）来选择它。 [这是一个 1:1 网站的示例](http://www.arn-swords.com/frontpage.aspx)

如果您有很多共享内容，即内容和结构完全相同，语言只是不同，这是最有效的设置。

第二种方法是为每种语言使用单独的页面结构，例如：

国际主页

------> 英文主页

------------> 英文内容页面

------> 法语主页

------------> 法语内容页面

这种结构的优点是它很容易设置，但如果您共享大量内容，则管理起来可能很麻烦。它还有一个优点是您可以锁定国家/语言特定编辑器的编辑权限。

使用上述结构，您还可以将各个 URL 指向国家/地区页面。

如果不了解您的具体要求，就很难更全面地回答哪种方法是最佳方法。也可以创建混合解决方案。

以下是一些可能有帮助的链接：

[http://forum.umbraco.org/yaf_postst2209_Multilingual-structure-in-umbraco.aspx](http://forum.umbraco.org/yaf_postst2209_Multilingual-structure-in-umbraco.aspx)

[http://www.nibble.be/?p=32](http://www.nibble.be/?p=32)

# postgresql - 将访问转换为 PostgreSQL？

> ID：637147
> 
> 赞同：19
> 
> 时间：2009-03-12T02:11:35.207
> 
> 标签：postgresql

一个客户的 Access 数据库已经超出了他们的规模，现在我需要将其转换为 PostgreSQL。我没有很多 Access 经验，所以乍一看，最好的解决方案似乎是只使用文本文件或其他东西导出数据。

对于将 DDL 和数据从 Access 中取出并转化为真实内容的简单方法，是否有人有任何好的建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2019-08-09T20:25:02.513

基于[http://www.postgresonline.com/journal/archives/24-Using-MS-Access-with-PostgreSQL.html](http://www.postgresonline.com/journal/archives/24-Using-MS-Access-with-PostgreSQL.html)，但针对 Access 2019 更新了更多详细信息：

1.  安装 PostgreSQL ODBC 驱动程序。

    1.  您可能已经通过[安装 PostgreSQL 安装](https://www.enterprisedb.com/downloads/postgres-postgresql-downloads)了它。如果没有，您可以从[https://www.postgresql.org/ftp/odbc/versions/msi/](https://www.postgresql.org/ftp/odbc/versions/msi/)安装它们。
    2.  如果您的 Access 是 32 位，则应安装 32 位驱动程序；如果 Access 是 64 位，则应安装 64 位驱动程序。您可以通过文件 > 帐户 > 关于 Access 来查看 Access 是 32 位还是 64 位。
    3.  在安装新驱动程序之前卸载旧版本的 PostgreSQL 驱动程序。
    4.  有关更多提示，请参阅[在 Windows 上设置 PostgreSQL ODBC 。](https://stackoverflow.com/questions/6796252/setting-up-postgresql-odbc-on-windows)
2.  **外部数据 > 新数据源 > 从其他来源 > ODBC 数据库**。键盘快捷键是 Alt > X > N1 > T > C。

3.  选择**通过创建链接表链接到数据源**，然后按**OK**。

4.  在 DSN 名称旁边，单击**新建...**

5.  如果您的数据库是 UTF-8 或非拉丁编码，请选择**PostgreSQL Unicode 。**如果您的数据库编码是 SQL_ASCII、EUC_JP、BIG5、Shift-JIS 或 LATIN 字符集，请选择 PostgreSQL ANSI。由 Access 2000 或更高版本创建的数据库采用 UTF-8 格式。如果 Access 是 64 位，请选择 64 位版本。单击**下一步 >**。

[![创建新数据源对话框](https://i.stack.imgur.com/zmMUr.png)](https://i.stack.imgur.com/zmMUr.png)

7.  正如对话框所说，“输入您想要保存连接的文件数据源的名称。或者，通过单击浏览找到要保存到的位置。” 单击**下一步 >**。单击**完成**。

8.  填写数据库、服务器、端口、用户名和密码字段。

9.  单击**Connection**并取消选中**Bools as char**。

[![PostgreSQL 和高级选项对话框](https://i.stack.imgur.com/EQ34D.png)](https://i.stack.imgur.com/EQ34D.png)

9.  单击**Page 2**并选中**True is -1**，然后取消选中**Updatable Cursors**。单击**确定**。单击**确定**。

10.  如果您收到“无法使用输入的文件数据源参数建立连接”的错误消息，请从开始菜单（或 Windows 7 或更早版本的控制面板中的 ODBC 管理器）打开**ODBC 数据源（64 位**），单击**Add...**，选择**PostgreSQL Unicode(x64)**，单击**Finish**，输入数据库的详细信息，然后单击**Test**。

[![ODBC 数据源管理员](https://i.stack.imgur.com/NXNrL.png)](https://i.stack.imgur.com/NXNrL.png)

11.  选择新创建的 .dsn 文件，然后单击确定。

> 12.  现在选择您想要的表并单击**Save Password**。如果您缺少表上的主键，Access 将提示您输入要用作主键的字段或字段集。这不会对实际表进行任何结构更改，但在链接结构中，Access 会假装这是主键并相应地将其用于表更新等。这对于不存在主键概念并且您希望可更新视图可从 Access 更新的视图特别有用。如果您对问题单击“确定”或“取消”而不选择一组字段，则该表将被标记为只读，这是许多报告视图所需的行为。

要将数据从 Access 表导出到 PostgreSQL：

1.  选择表。

2.  将表重命名为您想要的名称。

> 3.  确保您在 Postgres 中使用的用户的默认架构是您要将数据导出到的架构。

4.  **外部数据 > 更多（在导出部分）> ODBC 数据库**并选择您创建的 DSN。

    > 1.  这里的一个问题是 PostgreSQL 将维护表中字段的大小写和表名，因此最好先将所有字段重命名为小写，这样您就不必每次使用它们时都引用它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-13T13:05:42.617

*   在 Windows 计算机上安装 Postgres ODBC 驱动程序。
*   使用“PostgreSQL Unicode”驱动程序为您的新数据库创建一个数据源
*   对于每张桌子：
    *   使用“文件 -> 导出”选择类型“ODBC 数据库”
    *   确认表名
    *   选择“计算机数据源”
    *   选择您的数据源

如果您没有太多桌子，效果很好。我需要自动执行此操作，因此我创建了一个 VBS 脚本，该脚本在适当的时间发出键盘敲击，如下所示：

```
set shell=CreateObject("Wscript.Shell")
shell.Run("db1.mdb")
WScript.Sleep(5000);

shell.sendkeys("tablename1");
WScript.Sleep(1000);
shell.sendkeys("%fx"); ' Menu File, Export
WScript.Sleep(1000);
shell.sendkeys("%todbc"); ' Type: ODBC Databases
shell.sendkeys("~"); ' Enter 
```

等等

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T04:37:15.760

您应该能够编写一些可以使用 ODBC 或其他东西看到它们的东西，但如果失败了，您可以[将其转储到文本文件](http://www.tc.umn.edu/~hause011/article/Export_MS_Access.html)或使用[商业工具](http://dbconvert.com/convert-access-to-postgresql-pro.php)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T04:51:11.203

这是我有一段时间没有更新的旧脚本，但我用于类似目的：[http ://code.activestate.com/recipes/52267/](http://code.activestate.com/recipes/52267/)

另一个商业选择：[http ://www.datanamic.com/dbzipper/index.html](http://www.datanamic.com/dbzipper/index.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-15T18:23:21.750

Access 是一个很棒的程序，但由于无法轻松导出或连接到外部 ODBC 源而受到阻碍。

使用 ODBC 驱动程序将是理想的，但设置看起来有点令人生畏。

所以我只是将表格一一导出到 CSV 文件，然后通过 DBeaver 将每个表导入 Postgres 数据库，这是一个非常好的免费数据库管理工具 - 在这里查看 - [https://dbeaver.io](https://dbeaver.io)。

# mysql - MySQL 如何使用带有索引的排序规则？

> ID：637148
> 
> 赞同：5
> 
> 时间：2009-03-12T02:11:40.150
> 
> 标签：mysql, indexing

我想知道 MySQL 在生成索引时是否考虑了排序规则，或者无论排序规则如何都生成相同的索引，只有在以后遍历该索引时才会考虑排序规则。

出于我的目的，我想在字段上使用排序规则 utf8_unicode_ci。我知道这个特定的排序规则有相对较高的性能损失，但使用它对我来说仍然很重要。

我在该字段上有一个索引，用于满足 ORDER BY 子句，快速按顺序检索行（避免文件排序）。但是，我不确定使用此排序规则是否会影响从索引中读回的行的速度，或者索引是否根据该排序规则将数据存储在已经标准化的状态，从而导致性能损失完全在生成索引而不是读回它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T02:54:07.943

MySQL 将使用列的排序规则作为索引。因此，如果您创建一个 utf8_unicode_ci 字段，那么索引也将有效地以 utf8_unicode_ci 顺序排列。

请记住，使用索引并不总是 100% 绕过性能影响，但对于大多数实际目的而言，它会。

许多数据库系统不受 CPU 限制，所以我怀疑您会注意到这种影响。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-12T03:03:17.470

我相信 btree 结构会有所不同，因为它必须以不同的方式比较列值。

看看这两个查询计划：

```
mysql> explain select * from sometable where keycol = '3';
+----+-------------+-------+------+---------------+---------+---------+-------+------+--------------------------+
| id | select_type | table | type | possible_keys | key     | key_len | ref   | rows | Extra                    |
+----+-------------+-------+------+---------------+---------+---------+-------+------+--------------------------+
|  1 | SIMPLE      | pro   | ref  | PRIMARY       | PRIMARY | 66      | const |   34 | Using where; Using index | 
+----+-------------+-------+------+---------------+---------+---------+-------+------+--------------------------+

mysql> explain select * from sometable where binary keycol = '3';
+----+-------------+-------+-------+---------------+---------+---------+------+-------+--------------------------+
| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows  | Extra                    |
+----+-------------+-------+-------+---------------+---------+---------+------+-------+--------------------------+
|  1 | SIMPLE      | pro   | index | NULL          | PRIMARY | 132     | NULL | 14417 | Using where; Using index | 
+----+-------------+-------+-------+---------------+---------+---------+------+-------+--------------------------+ 
```

如果我们更改比较的排序规则，突然间它甚至无法再寻找索引，不得不扫描每一行。例如，无论排序规则如何，存储在索引中的实际值都是相同的，因为无论它使用区分大小写还是不区分大小写排序规则，它仍将返回原始大小写中的值。

因此，针对不区分大小写的排序规则的查找效率应该会低一些。

但是，我怀疑您是否能够注意到其中的差异。请注意，默认情况下 MySQL 使所有内容不区分大小写，因此影响不会那么可怕。

更新：

您可以看到 order by 操作的类似效果：

```
mysql> explain select * from sometable order by keycol collate latin1_general_cs;
+----+-------------+-------+-------+---------------+---------+---------+------+-------+-----------------------------+
| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows  | Extra                       |
+----+-------------+-------+-------+---------------+---------+---------+------+-------+-----------------------------+
|  1 | SIMPLE      | pro   | index | NULL          | PRIMARY | 132     | NULL | 14417 | Using index; Using filesort | 
+----+-------------+-------+-------+---------------+---------+---------+------+-------+-----------------------------+

mysql> explain select * from sometable order by keycol ;
+----+-------------+-------+-------+---------------+---------+---------+------+-------+-------------+
| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows  | Extra       |
+----+-------------+-------+-------+---------------+---------+---------+------+-------+-------------+
|  1 | SIMPLE      | pro   | index | NULL          | PRIMARY | 132     | NULL | 14417 | Using index | 
+----+-------------+-------+-------+---------------+---------+---------+------+-------+-------------+ 
```

请注意执行查询所需的额外“文件排序”阶段。这意味着 mysql 将结果排队在一个临时缓冲区中，并在一个额外的阶段使用快速排序对其自身进行排序，丢弃任何索引顺序。使用原始排序规则这一步是不必要的，因为 mysql 最初知道索引中的顺序。

# python - Django：上传的文件被锁定。无法重命名

> ID：637160
> 
> 赞同：3
> 
> 时间：2009-03-12T02:14:52.123
> 
> 标签：python, django, file-io

在模型的保存方法中上传文件后，我正在尝试重命名文件。我将文件重命名为文件主键和文件标题的组合。

当第一次上传文件，上传新文件以及文件或文件标题没有更改时，我让它工作。

但是，当文件的标题发生更改，并且系统尝试将旧文件重命名为新路径时，我收到以下错误：

```
WindowsError at /admin/main/file/1/
(32, 'The process cannot access the file because it is being used by another process') 
```

我真的不知道如何解决这个问题。我尝试将文件复制到新路径。这可行，但我不知道我可以删除旧版本。

缩短型号：

```
class File(models.Model):
    nzb = models.FileField(upload_to='files/')
    name = models.CharField(max_length=256)
    name_slug = models.CharField(max_length=256, blank=True, null=True, editable=False)

    def save(self):
        # Create the name slug.
        self.name_slug = re.sub('[^a-zA-Z0-9]', '-', self.name).strip('-').lower()
        self.name_slug = re.sub('[-]+', '-', self.name_slug)

        # Need the primary key for naming the file.
        super(File, self).save()

        # Create the system paths we need.
        orignal_nzb = u'%(1)s%(2)s' % {'1': settings.MEDIA_ROOT, '2': self.nzb}
        renamed_nzb = u'%(1)sfiles/%(2)s_%(3)s.nzb' % {'1': settings.MEDIA_ROOT, '2': self.pk, '3': self.name_slug}

        # Rename the file.
        if orignal_nzb not in renamed_nzb:
            if os.path.isfile(renamed_nzb):
                os.remove(renamed_nzb)

            # Fails when name is updated.
            os.rename(orignal_nzb, renamed_nzb)

        self.nzb = 'files/%(1)s_%(2)s.nzb' % {'1': self.pk, '2': self.name_slug}

        super(File, self).save() 
```

我想问题是，有谁知道当上传的文件没有被重新上传时我如何重命名上传的文件？那是它似乎被锁定/使用的唯一一次。

* * *

**更新：**

Tyler 的方法是有效的，除非上传新文件时主键不可用并且他的以下技术会引发错误。

```
if not instance.pk:
    instance.save() 
```

错误：

```
maximum recursion depth exceeded while calling a Python object 
```

有什么方法可以获取主键吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T02:21:00.067

我认为您应该更仔细地查看 upload_to 字段。这可能比在保存期间重命名更简单。

[http://docs.djangoproject.com/en/dev/ref/models/fields/#filefield](http://docs.djangoproject.com/en/dev/ref/models/fields/#filefield)

> 这也可能是一个可调用的，例如一个函数，将被调用以获取上传路径，包括文件名。此可调用对象必须能够接受两个参数，并返回要传递给存储系统的 Unix 样式路径（带有正斜杠）。将传递的两个参数是：

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T17:32:37.170

我的其他答案已弃用，请改用：

```
class File(models.Model):
    nzb = models.FileField(upload_to=get_filename)
    ...
    def get_filename(instance, filename):
        if not instance.pk:
            instance.save()
        # Create the name slug.
        name_slug = re.sub('[^a-zA-Z0-9]', '-', instance.name).strip('-').lower()
        name_slug = re.sub('[-]+', '-', name_slug)

        filename = u'filess/%(2)s_%(3)s.nzb' % {'2': instance.pk, '3': name_slug}

        return filename 
```

从 1.0 开始，[`upload_to`可以是 callable](http://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.FileField.upload_to)，在这种情况下，它应该返回文件名，包括路径（相对于 MEDIA_ROOT）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T16:40:01.807

上传后，您所拥有的只是内存中的图像对象，对吗？

您可以自己将此对象保存在您选择的文件夹中，然后手动编辑数据库条目。

你会绕过整个 Django ORM，除非我找不到更多的 Django 方式，否则我不会这样做。

# c# - jQuery .each 函数

> ID：637171
> 
> 赞同：0
> 
> 时间：2009-03-12T02:22:39.173
> 
> 标签：c#, .net, asp.net, javascript, jquery

我的 ASP.NET 页面上有一堆图像，如下所示：

```
for (int i = 0; i < 3; i++)
{
    Image image = new Image();
    image.ID = "UpdateStatus";
    image.CssClass = "imageCss";
    image.ImageUrl = "Bump.GIF";
    this.Controls.Add(image);
} 
```

我想遍历每个图像。

为什么这不起作用？即输出“功能1”但不输出“功能2”

```
$(document.body).click(function () {
    console.log('Function 1');

    $('imageCss').each(function(){
        console.log('Function 2');
    });
}); 
```

为什么这不起作用？即“功能1”输出，“功能2”输出ONCE。为什么不是3次？

```
$(document.body).click(function () {
    console.log('Function 1');

    $(''#UpdateStatus'').each(function(){
        console.log('Function 2');
    });
}); 
```

这工作正常但我无法访问'this'，它是NULL。我需要能够引用当前图像。

```
$(document.body).click(function () {
    console.log('Function 1');

    $.each('#UpdateStatus', function() { //Or when I use 'imageCss'
        console.log('Function 2');        
        console.log(this);
    });
}); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-12T02:28:09.580

(1) 您的 jQuery 调用`$('imageCss')`不是有效的选择器。您需要在类名前加上“。” 表示您要选择具有“imageCss”类的元素：

`$('.imageCss')`

(2) ID 必须是唯一的。当您在 ASP.NET 中的服务器上设置 Control.ID = "foo" 时，即设置控件的*服务器端*ID。在 HTML 中生成的客户端 ID 将是一个唯一的、长而丑陋的字符串，例如`ctl00_ctl01_pnlMain_foo1`. 您最好的选择是使用类选择器。您可以通过使用空格分隔多个类来将它们应用于单个元素：

```
myImage.CssClass = "image otherclass"; 
```

两者都`$('.image')`将`$('.otherclass')`正确选择元素。

(3)`this`不存在，因为[**闭包**](http://www.jibbering.com/faq/faq_notes/closures.html)。函数在调用函数的对象的上下文中执行，该对象也是如此`this`。

或者，在您的情况下，您的函数看起来并不像在任何对象的上下文中执行，所以我不确定您期望`this`的是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T03:11:11.257

要引用当前图像，请执行以下操作：

```
$.each('#UpdateStatus', function(i, val) {
    console.log('Function 2');        
    console.log(val);
}); 
```

# c++ - _controlfp_s 中可能存在的错误可能无法正确恢复控制字

> ID：637175
> 
> 赞同：4
> 
> 时间：2009-03-12T02:25:37.200
> 
> 标签：c++, visual-studio, visual-studio-2008, visual-c++

我偶然发现了 _controlfp_s (Visual Studio 2008) 的问题，或者我对它的理解。我认为第一个输出参数在应用其他参数的更改之前返回了控制标志。似乎它在更改后返回标志。

所以，我认为正确的使用方法是这样的：

```
// Chop rounding
unsigned int old;
_controlfp_s(&old, _RC_CHOP, _MCW_RC);

// Do chopped math

// Restore
unsigned int unused;
_controlfp_s(&unused, old, _MCW_RC); 
```

不幸的是，我需要这样做：

```
// Save
unsigned int old1;
_controlfp_s(&old1, 0, 0);

// Chop rounding
unsigned int old2;
_controlfp_s(&old2, _RC_CHOP, _MCW_RC);

// Do chopped math

// Restore
unsigned int unused;
_controlfp_s(&unused, old1, _MCW_RC); 
```

我错过了什么吗？不得不这样做似乎很愚蠢。

顺便说一句：我已经向 MS 报告了这个问题，他们说他们无法理解，并建议我提供一个显示问题的视频。对对。

布拉德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T02:49:01.620

根据[MSDN](http://msdn.microsoft.com/en-us/library/c9676k6h.aspx)：

> **如果 mask 的值等于 0**，则 _controlfp_s 获取浮点控制字。如果 mask 不为零，则为控制字设置一个新值：对于 mask 中任何打开（等于 1）的位，new 中的相应位用于更新控制字。换句话说， fpcntrl = ((fpcntrl & ~mask) | (new & mask)) 其中 fpcntrl 是浮点控制字。

（强调我的）因此，可靠地存储当前控制字的方法是您编写的第二种方法（您已经发现有效的方法）。如果您正在修改控制字，那么您将不会为掩码传递 0，并且根据函数文档，它不会检索当前控制字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T21:43:01.587

所以看起来这可能是设计使然——这很愚蠢。

更改控制字后，您什么时候想知道它？然而，你几乎总是不想使用旧的控制词，所以你可以把它放回去。

这只会迫使您进行额外的调用，因为有人在设计该功能时没有考虑。

所以我现在改用这种方法：

```
_controlfp_s(&uiOldCW, _CW_DEFAULT, 0xfffff); 
```

# asp.net - 在 asp.net 手风琴中嵌入 Flash 表现不佳

> ID：637179
> 
> 赞同：2
> 
> 时间：2009-03-12T02:28:27.520
> 
> 标签：asp.net, asp.net-ajax, accordion

我正在使用 ajax 工具包手风琴扩展器，当我尝试在内容部分中嵌入一些 flash 时，我注意到它的表现有点“时髦”。

您可以在以下网址查看我现在的工作：http: [//kristinsconfections.com/gallery.aspx](http://kristinsconfections.com/gallery.aspx)。正如您所看到的，当您切换手风琴时，它有点波涛汹涌。我正在从 flickr 中提取 Flash 幻灯片，所以我根本无法控制它。该网站仅适用于试图成为面包师的朋友，因此它不是高优先级，只是非常令人沮丧！我可以使用 javascript、.net 甚至 jquery 做什么？

这是我在该页面上使用的确切代码：

```
<cc1:Accordion ID="MyAccordion" runat="server" SelectedIndex="0"
        HeaderCssClass="accordionHeader" ContentCssClass="accordionContent"
        FadeTransitions="true" FramesPerSecond="40" TransitionDuration="250" AutoSize="None">
        <Panes>
            <cc1:AccordionPane ID="pnlCakes" runat="server">
                <Header><div ><span style="float:left;">Cakes</span></div></Header>
                <Content>
                    <object width="572" height="429" type="application/x-shockwave-flash"
                     data="http://www.flickr.com/apps/slideshow/show.swf?v=67089"> 
                    <param name="flashvars" value="&offsite=true&amp;lang=en-us&page_show_url=%2Fphotos%2F28792515%40N08%2Fsets%2F72157612640424865%2Fshow%2F&page_show_back_url=%2Fphotos%2F28792515%40N08%2Fsets%2F72157612640424865%2F&set_id=72157612640424865&jump_to=" />
                    <param name="allowFullScreen" value="true" />
                    <param name="movie" value="http://www.flickr.com/apps/slideshow/show.swf?v=67089" />
                    </object>
                </Content>
            </cc1:AccordionPane>
             <cc1:AccordionPane ID="pnlCookies" runat="server">
                <Header><div ><span style="float:left;">Cookies</span></div></Header>
                <Content>
                 <object width="572" height="429"  type="application/x-shockwave-flash"
                 data="http://www.flickr.com/apps/slideshow/show.swf?v=67089"> 
                <param name="flashvars" value="&offsite=true&amp;lang=en-us&page_show_url=%2Fphotos%2F28792515%40N08%2Fsets%2F72157612640405779%2Fshow%2F&page_show_back_url=%2Fphotos%2F28792515%40N08%2Fsets%2F72157612640405779%2F&set_id=72157612640405779&jump_to=" />
                <param name="allowFullScreen" value="true" />
                <param name="movie" value="http://www.flickr.com/apps/slideshow/show.swf?v=67089" />
                </object>
                </Content>
            </cc1:AccordionPane>
            <cc1:AccordionPane ID="pnlCupcakes" runat="server">
                <Header><div ><span style="float:left;">Cupcakes</span></div></Header>
                <Content>
                <object width="572" height="429"  type="application/x-shockwave-flash"
                 data="http://www.flickr.com/apps/slideshow/show.swf?v=67089"> 
                <param name="flashvars" value="&offsite=true&amp;lang=en-us&page_show_url=%2Fphotos%2F28792515%40N08%2Fsets%2F72157612589253131%2Fshow%2F&page_show_back_url=%2Fphotos%2F28792515%40N08%2Fsets%2F72157612589253131%2F&set_id=72157612589253131&jump_to=" />
                <param name="allowFullScreen" value="true" />
                <param name="movie" value="http://www.flickr.com/apps/slideshow/show.swf?v=67089" />
                </object>
                </Content>
            </cc1:AccordionPane>
        </Panes>
</cc1:Accordion> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T19:05:24.963

我发现 Ajax 工具包的东西一般来说太笨重了。JQuery 非常易于使用，具有良好的跨浏览器支持和可扩展性，我们优先使用它，我建议您也这样做。JQuery UI 套件中有一个符合要求的[手风琴小部件](http://jqueryui.com/demos/accordion/)。

如果将所有 Flash 电影加载到隐藏的 div 中会导致性能不佳，那么您可以在更改可以加载到 Flash 中的位置时挂钩一个事件。这记录在手风琴页面上（并且可以使用 JQuery 轻松完成）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T22:10:32.810

它似乎是 Firefox 中长期存在的[错误](https://bugzilla.mozilla.org/show_bug.cgi?id=90268)，并不特定于任何特定的小部件。我最好的尝试：

```
<script type="text/javascript">
    function pageLoad() {
        var acc = $find('<%= MyAccordion.ClientID %>_AccordionExtender');
        acc.add_selectedIndexChanged(MyAccordion_SelectedIndexChanged);
    }
    function MyAccordion_SelectedIndexChanged(sender) {
        $("object").css("visibility", "hidden");
        setTimeout(
            function() { 
                $("object").eq(sender.get_SelectedIndex()).css("visibility", "visible"); 
            }, 1000);
    }
</script> 
```

1.  隐藏对象可见性以便手风琴动画播放
2.  等待 1 秒 - 希望足够长的时间让动画完成，但不要太长，以免出现明显的延迟
3.  显示隐藏的对象

这修复了闪烁，但动画播放时闪光灯对象会消失

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T15:07:08.190

我在 FireFox3、IE8 和 Chrome 下对其进行了测试，实际上它在 IE（版本 8）中似乎运行良好，而在 FF3 和 Chrome 中则不太好。

我确实找到了遇到同样问题的某个地方的[这篇文章，似乎将 FadeTransitions 属性设置为“False”可以修复它，尽管我敢打赌这不是您希望的解决方案。](http://dotnetslackers.com/Community/blogs/kaushalparik/archive/2009/01/31/test-blog.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T16:08:53.157

您是否尝试过暂时将预览图像放入手风琴中？那么当用户点击图片时使用javascript将其替换为flash呢？我认为这样看起来会好很多。

当有人在手风琴中选择不同的窗格时（不确定要监视的事件——查看 AccordionBehavior.js），那么您可以移除闪光灯，将其替换为图像并继续。

我认为您不必担心会导致您出现问题的闪存/浏览器交互。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T16:44:20.163

我也建议使用[jQuery 手风琴小部件](http://jqueryui.com/demos/accordion/)。我已经使用过它，它非常易于使用，重量轻，适用于所有浏览器，而且我没有发现任何错误。您可以选择很多皮肤，如果迫在眉睫，构建自己的皮肤并不是那么痛苦。

除此之外，看看您嵌入 SWF 的方式，尤其是`wmode`属性。[这里](http://www.kaourantin.net/2008/05/what-does-gpu-acceleration-mean.html)有一篇很好的解释性文章，你可以从它开始。您可以忽略`GPU`和`direct`模式，因为我认为您没有使用为 Flash Player 10 编译的 SWF。

当然，您应该卸载不可见的 Flash 电影。

# c# - 在外部命名空间中引用方法/变量是否比完全包含它更节省内存？

> ID：637189
> 
> 赞同：3
> 
> 时间：2009-03-12T02:34:06.320
> 
> 标签：c#

那么以下在内存使用方面是否等效？

```
System.Threading.Thread.Sleep(500); 
```

对比

```
using System.Threading;
...
Thread.Sleep(500); 
```

我原以为您在内存中“使用”的命名空间越少越好，但我听说前一个示例无论如何都必须将命名空间加载到内存中。我知道`Sleep`这不是内存消耗方法的最佳示例，但这只是一个示例。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-12T02:39:02.237

该`using`语句根本不会加载任何内容，它只会告诉编译器在哪里查找类。

这两个示例生成完全相同的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T02:48:55.787

如其他帖子中所述，两者在编译时产生完全相同的 IL。

不过还是有区别的。第一个选项明确地让编译器知道类/方法/结构/等的去向。第二个选项包括命名空间 (System.Threading) 到编译器要搜索的命名空间列表中。

如果 using 语句中有许多命名空间，则会导致编译器需要更长的时间来编译此文件。使用 C#，这可能不是您关心的事情，因为编译器非常快，但它确实减慢了速度。

对于一个非常大的项目和非常大的命名空间（由于其他原因这不是一个好主意），这可能很明显（尽管仍然很微妙）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T02:45:23.003

我不相信您可以在纯 C 中包含的意义上将“using”语句与“include”语句相混淆——编译 CLR 代码时，它将忽略程序集中未实际使用的指定命名空间。

该`using`声明适用于：

*   告诉编译器在哪里寻找类（如 Guffa 所述）
*   让开发人员更容易声明类——想象一下，每次声明都必须输入完全限定的类名

编译器将负责对其进行优化，您无需担心。

# c++ - 如何正确传递十进制值作为参数

> ID：637196
> 
> 赞同：1
> 
> 时间：2009-03-12T02:36:40.467
> 
> 标签：c++, decimal, argument-passing

我有这个：

```
double myDecimal = static_cast<double>(atoi(arg_vec[1]));
cout << myDecimal << endl; 
```

但是为什么当我通过这样的论点时：

```
./MyCode 0.003 
```

它打印`0`而不是`0.003`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T02:38:39.930

[`atoi()`](http://linux.die.net/man/3/atoi)转换为整数。你想要[`atof()`](http://linux.die.net/man/3/atof)。

或者你可以使用[strtod()。](http://www.cplusplus.com/reference/clibrary/cstdlib/strtod.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T02:38:32.300

atoi() 转换为整数，你想要 atof()，它转换为 double

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T03:10:06.873

由于您使用的是 C++，因此您还可以使用字符串流：

```
istringstream ss(arg_vec[1]);
double d;
ss >> d; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T08:57:23.280

```
double d = boost::lexical_cast<double>("0.003"); 
```

# c# - 如何防止被覆盖的 WinForm 控件中的“默认”值？

> ID：637222
> 
> 赞同：3
> 
> 时间：2009-03-12T02:55:59.607
> 
> 标签：c#, controls, default, subclass

我正在尝试学习和掌握 C# 做什么以及如何做事。从历史上看，我是一名 Visual Foxpro (VFP) 开发人员，通过创建自己的用户控件基线以在应用程序范围内使用，我对视觉继承的岁月有些宠爱。

在尝试学习 C# 中的相似之处时，我遇到了一些问题。假设我派生了我自己的标签控件（控件是标签的子类），用字体“Arial”定义，10 磅。然后，在我将其添加到的任何表单上，Designer 将自动预填一些属性值，这些值可以在 Form 类的“Designer.cs”部分中看到。

```
this.LabelHdr2.AutoSize = true;
this.LabelHdr2.Font = new System.Drawing.Font("Arial", 14F, System.Drawing.FontStyle.Bold);
this.LabelHdr2.ForeColor = System.Drawing.Color.Blue;
this.LabelHdr2.Location = new System.Drawing.Point(150, 65);
this.LabelHdr2.Name = "LabelHdr2";
this.LabelHdr2.Size = new System.Drawing.Size(158, 22);
this.LabelHdr2.TabIndex = 5;
this.LabelHdr2.Text = "LabelHdr2"; 
```

我想防止每次在表单上放置控件时生成字体、颜色、大小、自动大小等内容。如果我后来决定将字体从“Arial”10 更改为“Tahoma”11，我将不得不返回所有表单（以及任何其他自定义控件）并进行编辑以进行更改。

在 VFP 中，如果我更改基类的任何内容，所有表单都会自动识别更改。我不需要编辑任何东西（除了可能通过尺寸影响进行的对齐）......但是颜色、字体和其他所有东西在 VFP 中都没有问题......

在 C# 中，我必须返回并更改每个表单，以便它被类的新/更新值识别......

有没有合理的方法来避免这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T04:28:26.780

不要使用“ReadOnlyAttribute”，而是尝试使用“ [DefaultValueAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.defaultvalueattribute.aspx) ”。如果我没记错的话，如果当前值与“DefaultValueAttribute”中存储的值匹配，则设计者不应该创建代码来设置属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T03:42:33.850

这是[`ReadOnlyAttribute`](http://msdn.microsoft.com/en-us/library/system.componentmodel.readonlyattribute.aspx)在派生类中使用的简单解决方案。

```
class MyLabel : Label
{
    [ReadOnly(true)]
    public override Font Font
    {
        get { return new Font(FontFamily.GenericMonospace, 10); }
        set { /* do nothing */ }
    }
} 
```

这[`ReadOnlyAttribute`](http://msdn.microsoft.com/en-us/library/system.componentmodel.readonlyattribute.aspx)将禁用 VS.NET 设计器中的属性编辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T03:40:58.580

尝试将[ReadOnly 属性](http://msdn.microsoft.com/en-us/library/system.componentmodel.readonlyattribute.aspx)添加到派生类的属性中：

```
[ReadOnly(true)]
public override Font Font
{
    get{ // Your Implementation Here }
    set{ // Don't really care,do you? }
} 
```

ReadOnlyAttribute 应在设计时强制执行 ReadOnly 行为。

# c# - VB.NET 中的 foreach 是否比 c# 中的更快？

> ID：637224
> 
> 赞同：3
> 
> 时间：2009-03-12T02:57:08.497
> 
> 标签：c#, .net, vb.net, clr, language-design

我的同事说，在之前的一次采访中，他了解到 VB.Net 中的 foreach 比 c# 中的 foreach 更快。他被告知这是因为两者都有不同的 CLR 实现。

从 C++ 的角度来看，我很好奇为什么会这样，我被告知我需要先阅读 CLR。谷歌搜索 foreach 和 CLR 并不能帮助我理解。

有没有人很好地解释为什么 foreach 在 VB.Net 中比在 c# 中更快？还是我的同事被误导了？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-12T03:24:10.383

C# 和 VB.Net 之间的 IL 级别没有显着差异。在两个版本之间这里和那里都有一些额外的 Nop 指令，但实际上并没有改变正在发生的事情。

这是方法：（在 C# 中）

```
public void TestForEach()
    {
        List<string> items = new List<string> { "one", "two", "three" };

        foreach (string item in items)
        {
            Debug.WriteLine(item);
        }
    } 
```

在 VB.Net 中：

```
Public Sub TestForEach
    Dim items As List(Of String) = New List(Of String)()
    items.Add("one")
    items.Add("two")
    items.Add("three")
    For Each item As string In items
        Debug.WriteLine(item)
    Next
End Sub 
```

这是 C# 版本的 IL：

```
.method public hidebysig instance void TestForEach() cil managed
{
    .maxstack 2
    .locals init (
        [0] class [mscorlib]System.Collections.Generic.List`1<string> items,
        [1] string item,
        [2] class [mscorlib]System.Collections.Generic.List`1<string> <>g__initLocal3,
        [3] valuetype [mscorlib]System.Collections.Generic.List`1/Enumerator<string> CS$5$0000,
        [4] bool CS$4$0001)
    L_0000: nop 
    L_0001: newobj instance void [mscorlib]System.Collections.Generic.List`1<string>::.ctor()
    L_0006: stloc.2 
    L_0007: ldloc.2 
    L_0008: ldstr "one"
    L_000d: callvirt instance void [mscorlib]System.Collections.Generic.List`1<string>::Add(!0)
    L_0012: nop 
    L_0013: ldloc.2 
    L_0014: ldstr "two"
    L_0019: callvirt instance void [mscorlib]System.Collections.Generic.List`1<string>::Add(!0)
    L_001e: nop 
    L_001f: ldloc.2 
    L_0020: ldstr "three"
    L_0025: callvirt instance void [mscorlib]System.Collections.Generic.List`1<string>::Add(!0)
    L_002a: nop 
    L_002b: ldloc.2 
    L_002c: stloc.0 
    L_002d: nop 
    L_002e: ldloc.0 
    L_002f: callvirt instance valuetype [mscorlib]System.Collections.Generic.List`1/Enumerator<!0> [mscorlib]System.Collections.Generic.List`1<string>::GetEnumerator()
    L_0034: stloc.3 
    L_0035: br.s L_0048
    L_0037: ldloca.s CS$5$0000
    L_0039: call instance !0 [mscorlib]System.Collections.Generic.List`1/Enumerator<string>::get_Current()
    L_003e: stloc.1 
    L_003f: nop 
    L_0040: ldloc.1 
    L_0041: call void [System]System.Diagnostics.Debug::WriteLine(string)
    L_0046: nop 
    L_0047: nop 
    L_0048: ldloca.s CS$5$0000
    L_004a: call instance bool [mscorlib]System.Collections.Generic.List`1/Enumerator<string>::MoveNext()
    L_004f: stloc.s CS$4$0001
    L_0051: ldloc.s CS$4$0001
    L_0053: brtrue.s L_0037
    L_0055: leave.s L_0066
    L_0057: ldloca.s CS$5$0000
    L_0059: constrained [mscorlib]System.Collections.Generic.List`1/Enumerator<string>
    L_005f: callvirt instance void [mscorlib]System.IDisposable::Dispose()
    L_0064: nop 
    L_0065: endfinally 
    L_0066: nop 
    L_0067: ret 
    .try L_0035 to L_0057 finally handler L_0057 to L_0066
} 
```

这是 VB.Net 版本的 IL：

```
.method public instance void TestForEach() cil managed
{
    .maxstack 2
    .locals init (
        [0] class [mscorlib]System.Collections.Generic.List`1<string> items,
        [1] string item,
        [2] valuetype [mscorlib]System.Collections.Generic.List`1/Enumerator<string> VB$t_struct$L0,
        [3] bool VB$CG$t_bool$S0)
    L_0000: nop 
    L_0001: newobj instance void [mscorlib]System.Collections.Generic.List`1<string>::.ctor()
    L_0006: stloc.0 
    L_0007: ldloc.0 
    L_0008: ldstr "one"
    L_000d: callvirt instance void [mscorlib]System.Collections.Generic.List`1<string>::Add(!0)
    L_0012: nop 
    L_0013: ldloc.0 
    L_0014: ldstr "two"
    L_0019: callvirt instance void [mscorlib]System.Collections.Generic.List`1<string>::Add(!0)
    L_001e: nop 
    L_001f: ldloc.0 
    L_0020: ldstr "three"
    L_0025: callvirt instance void [mscorlib]System.Collections.Generic.List`1<string>::Add(!0)
    L_002a: nop 
    L_002b: nop 
    L_002c: ldloc.0 
    L_002d: callvirt instance valuetype [mscorlib]System.Collections.Generic.List`1/Enumerator<!0> [mscorlib]System.Collections.Generic.List`1<string>::GetEnumerator()
    L_0032: stloc.2 
    L_0033: br.s L_0045
    L_0035: ldloca.s VB$t_struct$L0
    L_0037: call instance !0 [mscorlib]System.Collections.Generic.List`1/Enumerator<string>::get_Current()
    L_003c: stloc.1 
    L_003d: ldloc.1 
    L_003e: call void [System]System.Diagnostics.Debug::WriteLine(string)
    L_0043: nop 
    L_0044: nop 
    L_0045: ldloca.s VB$t_struct$L0
    L_0047: call instance bool [mscorlib]System.Collections.Generic.List`1/Enumerator<string>::MoveNext()
    L_004c: stloc.3 
    L_004d: ldloc.3 
    L_004e: brtrue.s L_0035
    L_0050: nop 
    L_0051: leave.s L_0062
    L_0053: ldloca.s VB$t_struct$L0
    L_0055: constrained [mscorlib]System.Collections.Generic.List`1/Enumerator<string>
    L_005b: callvirt instance void [mscorlib]System.IDisposable::Dispose()
    L_0060: nop 
    L_0061: endfinally 
    L_0062: nop 
    L_0063: ret 
    .try L_002c to L_0053 finally handler L_0053 to L_0062
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-12T03:02:28.140

我对这种说法有点怀疑。foreach 构造对两种语言的工作方式相同，因为它从托管对象获取[IEnumerator](http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.aspx)并在其上调用 MoveNext()。原始代码是用 VB.NET 还是 c# 编写的都无关紧要，它们都编译成相同的东西。

在我的测试时间中，VB.NET 和 c# 中的相同 foreach 循环在很长的迭代中相隔从未超过 ~1%。

C＃：

```
L_0048: ldloca.s CS$5$0001
L_004a: call instance !0 [mscorlib]System.Collections.Generic.List`1/Enumerator<string>::get_Current()
L_004f: stloc.3 
L_0050: nop 
L_0051: ldloc.3 
L_0052: call void [mscorlib]System.Console::WriteLine(string)
L_0057: nop 
L_0058: nop 
L_0059: ldloca.s CS$5$0001
L_005b: call instance bool [mscorlib]System.Collections.Generic.List`1/Enumerator<string>::MoveNext()
L_0060: stloc.s CS$4$0000
L_0062: ldloc.s CS$4$0000
L_0064: brtrue.s L_0048 
```

VB.NET：

```
L_0043: ldloca.s VB$t_struct$L0
L_0045: call instance !0 [mscorlib]System.Collections.Generic.List`1/Enumerator<string>::get_Current()
L_004a: stloc.s item
L_004c: ldloc.s item
L_004e: call void [mscorlib]System.Console::WriteLine(string)
L_0053: nop 
L_0054: nop 
L_0055: ldloca.s VB$t_struct$L0
L_0057: call instance bool [mscorlib]System.Collections.Generic.List`1/Enumerator<string>::MoveNext()
L_005c: stloc.s VB$CG$t_bool$S0
L_005e: ldloc.s VB$CG$t_bool$S0
L_0060: brtrue.s L_0043 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T03:38:20.350

对于一个简单的 foreach 循环字符串数组，这是由 VB 生成的 IL 代码：

```
L_0007: ldloc.0 
L_0008: stloc.3 
L_0009: ldc.i4.0 
L_000a: stloc.2 
L_000b: br.s L_0019

L_000d: ldloc.3 
L_000e: ldloc.2 
L_000f: ldelem.ref 
L_0010: stloc.1 

...

L_0015: ldloc.2 
L_0016: ldc.i4.1 
L_0017: add.ovf 
L_0018: stloc.2 

L_0019: ldloc.2 
L_001a: ldloc.3 
L_001b: ldlen 
L_001c: conv.ovf.i4 
L_001d: blt.s L_000d 
```

这是由 C# 生成的 IL 代码：

```
L_0007: ldloc.0 
L_0008: stloc.2 
L_0009: ldc.i4.0 
L_000a: stloc.3 
L_000b: br.s L_0019

L_000d: ldloc.2 
L_000e: ldloc.3 
L_000f: ldelem.ref 
L_0010: stloc.1 

...

L_0015: ldloc.3 
L_0016: ldc.i4.1 
L_0017: add 
L_0018: stloc.3 

L_0019: ldloc.3 
L_001a: ldloc.2 
L_001b: ldlen 
L_001c: conv.i4 
L_001d: blt.s L_000d 
```

唯一的区别是 VB 使用`add.ovf`and`conv.ovf.i4`而不是`add`and `conv.i4`。这意味着 VB 代码会进行两次额外的溢出检查，并且可能会稍微慢一些。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T03:49:44.860

VB.NET 和 C# 都使用相同的 CLR。我刚刚使用以下代码快速完成了空气基准测试：

C#版本：

```
static void Main(string[] args)
{
    List<string> myList = new List<string>();

    for(int i = 0; i < 500000; i++)
    {
        myList.Add(i.ToString());
    }

    DateTime st = DateTime.Now;
    foreach(string s in myList)
    {
        Console.WriteLine(s);
    }
    DateTime et = DateTime.Now;

    Console.WriteLine(et - st);
    Console.ReadLine();
} 
```

VB.NET 版本：

```
Module Module1

    Sub Main()
        Dim myList As List(Of String) = New List(Of String)

        For i = 1 To 500000
            myList.Add(i)
        Next

        Dim st, et
        st = DateTime.Now
        For Each s As String In myList
            Console.WriteLine(s)
        Next
        et = DateTime.Now

        Console.WriteLine(et - st)
        Console.ReadLine()
    End Sub

End Module 
```

在执行 500000 次迭代的发布版本（最重要）上，C# 代码稍微快了一点，但只有一点点。

调试构建：

```
C# - 1m 40s 457ms
VB.NET - 1m 42s 022ms
```

发布版本：

```
C# - 0m 56s 179ms
VB.NET - 0m 56s 327ms
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T03:09:08.110

你应该做一个实验。抓住（很棒的）[.NET Reflector](http://www.red-gate.com/products/reflector/)，用每种语言构建一个简单的测试用例，看看生成的 MSIL 是否相同。

# linq - 您将如何为 LINQ to SQL 编写 Upsert？

> ID：637225
> 
> 赞同：19
> 
> 时间：2009-03-12T02:57:29.930
> 
> 标签：linq, linq-to-sql

所以我想为 LINQ to SQL 编写一个通用的 Upsert 函数，但我在概念化如何做到这一点时遇到了一些麻烦。我希望它像这样工作：

```
var db = new DataContext();
db.Customers.UpsertOnSubmit(customer); 
```

所以它必须以某种方式是通用的，我猜是 Table 上的扩展方法。在确定基础表的主键方面，我已经能够做到这一点：

```
var context = source.Context;
var table = context.Mapping.GetTable(source.GetType());
var primaryMember = table.RowType.DataMembers.SingleOrDefault(m => m.IsPrimaryKey); 
```

我假设有必要编写一个查询来判断该项目是否已经在数据库中，但我现在真的不知道如何处理它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-19T17:49:12.193

我做了类似的事情，但采用了不同的方法。每个实体都实现`IEntity`. 的属性之一`IEntity`是对象是新的还是现有的状态。然后我为每个实体实现它，例如：

```
public EntityState EntityState
{
    get
    {
        if (_Id > 0)
            return EntityState.Exisiting;
        else
            return EntityState.New;
    }
} 
```

然后，泛型`Upsert`可以是（在泛型存储库类型类上）：

```
public virtual void Upsert<Ta>(Ta entity)
    where Ta: class
{
    if (!(entity is IEntity))
        throw new Exception("T must be of type IEntity");

    if (((IEntity)entity).EntityState == EntityState.Exisiting)
        GetTable<Ta>().Attach(entity, true);
    else
        GetTable<Ta>().InsertOnSubmit(entity);
}

private System.Data.Linq.Table<Ta> GetTable<Ta>()
    where Ta: class
{
    return _dataContext.Context.GetTable<Ta>();
} 
```

如果您从另一个数据上下文附加，还要确保您的对象上有时间戳。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-11-22T23:54:59.573

**简短的回答：**

抓住这个：[EntityExtensionMethods.cs](https://gist.github.com/omidkrad/0d97ed153fb4d0cfe5d8a00cb5f29444)

**解释**

要在 LINQ-to-SQL 中执行 UPSERT 而不先查询记录，您可以执行以下操作。它仍然会访问数据库一次以检查记录是否存在，但不会提取记录：

```
var blob = new Blob { Id = "some id", Value = "some value" }; // Id is primary key (PK)

if (dbContext.Blobs.Contains(blob)) // if blob exists by PK then update
{
    // This will update all columns that are not set in 'original' object. For
    // this to work, Blob has to have UpdateCheck=Never for all properties except
    // for primary keys. This will update the record without querying it first.
    dbContext.Blobs.Attach(blob, original: new Blob { Id = blob.Id });
}
else // insert
{
    dbContext.Blobs.InsertOnSubmit(blob);
}
dbContext.Blobs.SubmitChanges(); 
```

**扩展方法**

我想出了以下扩展方法。

```
public static class EntityExtensionMethods
{
    public static void InsertOrUpdateOnSubmit<TEntity>(this Table<TEntity> table, TEntity entity, TEntity original = null)
        where TEntity : class, new()
    {
        if (table.Contains(entity)) // if entity exists by PK then update
        {
            if (original == null)
            {
                // Create original object with only primary keys set
                original = new TEntity();
                var entityType = typeof(TEntity);
                var dataMembers = table.Context.Mapping.GetMetaType(entityType).DataMembers;
                foreach (var member in dataMembers.Where(m => m.IsPrimaryKey))
                {
                    var propValue = entityType.GetProperty(member.Name).GetValue(entity, null);
                    entityType.InvokeMember(member.Name, BindingFlags.SetProperty, Type.DefaultBinder,
                        original, new[] {propValue});
                }
            }

            // This will update all columns that are not set in 'original' object. For
            // this to work, entity has to have UpdateCheck=Never for all properties except
            // for primary keys. This will update the record without querying it first.
            table.Attach(entity, original);
        }
        else // insert
        {
            table.InsertOnSubmit(entity);
        }
    }
} 
```

像下面这样使用它：

```
var blob = new Blob { Id = "some id", Value = "some value" }; // Id is primary key (PK)
dbContext.Blobs.InsertOrUpdateOnSubmit(blob);
dbContext.Blobs.SubmitChanges(); 
```

我在上面的扩展方法中添加了更多内容到这个要点：[EntityExtensionMethods.cs](https://gist.github.com/omidkrad/0d97ed153fb4d0cfe5d8a00cb5f29444)

# latex - 用于多文件 LaTeX 文档的 Makefile

> ID：637227
> 
> 赞同：8
> 
> 时间：2009-03-12T02:58:08.150
> 
> 标签：latex, makefile

我正在尝试简化/改进 Makefile 以编译我的论文。Makefile 可以很好地编译整个东西。我有这样的事情：

```
show: thesis.pdf
    open thesis.pdf

thesis.pdf: *.tex
    pdflatex --shell-escape thesis 
```

这使我可以键入`make`并检测到任何更改（如果有），并在显示之前重新编译。

现在我想将它扩展为有条件地只编译个别章节。例如，这使我可以`make xpmt`通过一种迂回的方式编写仅获得一章的内容：

```
xpmt: ch-xpmt.pdf
    open ch-xpmt.pdf

ch-xpmt.pdf: xpmt.tex
    pdflatex --shell-escape --jobname=ch-xpmt \
      "\includeonly{xpmt}\input{thesis}" 
```

但我不想为每个单独的章节写下相同的内容。如何以足够通用的方式编写上述规则以避免重复？

（更多的是学习如何编写 Makefiles 而不是解决任何实际问题的练习；显然在这种情况下，复制和粘贴上述代码足够多次实际上是微不足道的！）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-12T03:15:21.213

如果您有命名的章节`xpmt`（猜想那是“实验”？）并且，比如说`thry`，，，，`anls`或`conc`其他：

```
xmpt thry anls conc: %: ch-%.pdf
    open $<

ch-%.pdf: %.tex
    pdflatex --shell-escape --jobname=ch-$* "\includeonly{$*}\input{thesis}" 
```

或者用 make 变量以“正确”的方式来做，我认为它会是这样的：

```
chapters = xmpt thry anls conc
main = thesis
.PHONY: $(chapters) show

show: $(main).pdf
    open $<

$(main).pdf: $(main).tex $(addsuffix .tex,$(chapters))
    pdflatex --shell-escape $(main)

$(chapters): %: ch-%.pdf
    open $<

ch-%.pdf: %.tex
    pdflatex --shell-escape --jobname=ch-$* "\includeonly{$*}\input{$(main)}" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T09:52:00.597

您应该考虑使用橡胶之类的东西来为您处理 LaTeX 构建。虽然可以使用 make 完成大部分工作，但一个专门的工具可以处理 LaTeX 的复杂性，例如多次重新运行 bibtex 以对所有引用进行排序等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-07T18:28:32.070

请考虑使用`latexmk`

## [http://www.phys.psu.edu/~collins/software/latexmk-jcc/](http://www.phys.psu.edu/~collins/software/latexmk-jcc/)

它会确定是否需要运行 pdflatex/latex、bibtex、makeindex 等（以及运行多少次）才能完全编译您的源代码。

`latexmk`是一个包含在大多数乳胶发行版中的 perl 脚本。您只需要确保在您的系统上安装了 perl。

# .net - System.InvalidOperationException：事务与连接不匹配。linq到sql

> ID：637246
> 
> 赞同：0
> 
> 时间：2009-03-12T03:11:47.993
> 
> 标签：.net, sql, linq-to-sql, invalidoperationexception

有人见过这个吗？它来自一个托管在 IIS 中的 .net 远程处理端点，具有 16 个进程的网络花园。因此每个进程的每个线程池中都有许多并发事务。我们使用 linq to sql 和来自 DataContext 的 Transaction 对象，而不是 transactionScope 对象。它似乎发生在连接的处置或提交后事务的处置周围。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T17:47:53.133

我发现了问题。在域中的 linq 对象发生更改冲突后引发此异常。一旦从 datacontext.submitchanges 引发了更改冲突，如果您随后尝试回滚事务，则 transaction.Rollback 将引发上述异常。

# cruisecontrol.net - 如何在 CruiseControl.Net 中协调多个构建？

> ID：637255
> 
> 赞同：2
> 
> 时间：2009-03-12T03:22:59.387
> 
> 标签：cruisecontrol.net

我有一个场景，我需要定义多个 msbuild 任务。我添加了一个 projectTrigger 但问题是您需要将 triggerStatus 指定为成功或失败。无论前面的构建是成功还是失败，我都需要进行构建。什么是最好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T15:25:20.507

我可以想到两个选择。正如 Pedro 提到的，您可以设置[多个触发器](http://confluence.public.thoughtworks.org/display/CCNET/Multiple+Trigger)- 一个用于 ProjectA 的成功，一个用于失败。因此，在您的 ProjectB 下：

```
<multiTrigger operator="Or">
    <triggers>
        <projectTrigger project="ProjectA">
            <triggerStatus>Success</triggerStatus>
        </projectTrigger>
    </triggers>
    <triggers>
        <projectTrigger project="ProjectA">
            <triggerStatus>Failure</triggerStatus>
        </projectTrigger>
    </triggers>
</multiTrigger> 
```

另一种方法是从另一个方向：使用[Force Build Publisher](http://confluence.public.thoughtworks.org/display/CCNET/ForceBuildPublisher)。您可以让 ProjectA 强制构建，而不是在 ProjectB 中设置触发器：

```
<publishers>
    <!-- other publishers... -->
    <forcebuild>
        <project>ProjectB</project>
        <integrationStatus>Success</integrationStatus>
    </forcebuild>
    <forcebuild>
        <project>ProjectB</project>
        <integrationStatus>Failure</integrationStatus>
    </forcebuild>
</publishers> 
```

您必须定义两种情况（对于成功和失败）有点奇怪。没有研究有没有更好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T06:48:00.800

多个触发器是个好主意，但是当我使用上面的语法实现它时，它不起作用。这是对我有用的代码：

```
<triggers>
<multiTrigger operator="Or">
    <triggers>
        <projectTrigger project="ProjectA">
            <triggerStatus>Success</triggerStatus>
        </projectTrigger>

        <projectTrigger project="ProjectA">
            <triggerStatus>Failure</triggerStatus>
        </projectTrigger>
    </triggers>
</multiTrigger>
</triggers> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T11:54:21.810

如果它们都涉及相同的代码库（对您正在监视的文件夹有创意，即使它提取的代码比您真正需要的更多），那么当修改发生时它们都会启动，您将看到每个文件夹的成功/失败. 您可以按队列优先级设置顺序。

或者您说的是单个项目中的多个 MSBuild？如果是这样，我能想到的唯一方法是将您的第一个构建放入任务中，将其他构建放入发布者部分（是的，您可以这样做）这是确保执行以下任务的唯一方法无论主构建是否通过或失败。这样做的问题是，如果发布者部分中的那些失败了，它们不会使整个构建失败。

或者......您可以创建一个 Master MSBuild，按顺序调用所有构建......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-05T15:01:42.300

CC.Net 允许您在单个项目上定义多个触发器。也许您创建了两个项目触发器——一个用于成功，一个用于失败。

# authentication - “记住我”令牌应该多长时间？

> ID：637258
> 
> 赞同：7
> 
> 时间：2009-03-12T03:27:36.490
> 
> 标签：authentication

我正在尝试使用带有用户用户名和令牌的 cookie 向网站添加“记住我”功能，该 cookie 也加密存储在数据库中。我的问题是这个令牌应该多长时间？[我读过的一个网站](http://fishbowl.pastiche.org/2004/01/19/persistent_login_cookie_best_practice/)说 128 位，在我看来是 16 个字符。我不太担心重复，因为即使是 256 个字符的字符集中的 16 个字符也提供了大量的可能性，并且同时出现重复的机会很小。

令牌应该多长时间？（我不知道如何产生价值或独特性。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T03:38:29.163

只需使用[GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)。许多数据库支持它们作为原生类型；它们很容易在最流行的语言/框架中操作；从一个平台到另一个平台的完美翻译；而且[每一个都是独一无二的](http://www.codinghorror.com/blog/archives/000399.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T05:36:20.283

我认为这更多地取决于值是如何随机化的，而不是它的长度。如果 256 位散列只是一个很容易猜到或缩小范围的散列，例如基于时间的唯一 ID，那么 256 位散列根本不安全。

但是，正如您所说，您并没有特别询问如何使其足够随机。

为了破坏某些东西，估计需要 2^80（或更多）次操作通常是一个很好的衡量标准。这意味着 80 位散列是安全的。（如果你容易受到生日攻击，你需要双倍，即 160 位，但我认为这种情况不适用）。

就个人而言，为此我使用 256 位哈希。当 base64 编码时，它们压缩到只有 43 个字符的长度，所有可打印的字符。我认为即使它比我需要的要多，但让它们长这么久也不是什么大麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-25T16:47:33.760

你总是可以看看其他人做了什么，比如[Oauth2](https://www.rfc-editor.org/rfc/rfc6749#section-10.10)，它建议令牌在 128 到 160 位之间，然后做同样的事情。我喜欢[这篇文章](https://security.stackexchange.com/a/7945/12049)，它说 122 位应该足够“用于大多数用途，包括核导弹的发射代码”。如果您认为实际的启动代码[可能是 00000000 20 年，](http://arstechnica.com/tech-policy/2013/12/launch-code-for-us-nukes-was-00000000-for-20-years/)这很有趣。对于我们的 160 位令牌的安全性来说就是如此。

# c++ - 初始化..哪个更有效？

> ID：637259
> 
> 赞同：11
> 
> 时间：2009-03-12T03:29:15.720
> 
> 标签：c++, constructor, initialization

我有以下问题。应该遵循哪一个更好，为什么？

```
string strMyString = "SampleString"; 
```

或者

```
string strMyString("SampleString"); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-12T03:36:04.520

我[在这里回答了](https://stackoverflow.com/questions/587070/c-constructor-syntax/587116#587116)

我在这里回答的一件事：**既不使用任何赋值运算符**。

对字符串特定的东西的简短解释。`std::string`有一个构造函数接受一个参数`char const*`：

```
// simplified to a normal class declaration. std::string actually
// is a template instantiation. 
class string {
public:
    string(char const* str) {
        // copy over...
    }
}; 
```

现在你看到它有一个构造函数，它带有一个指向字符的指针。这样它就可以接受字符串文字。我认为以下情况很明显：

```
string s("hello"); 
```

它将直接调用构造函数并`s`由此进行初始化。这称为*直接初始化*。

初始化变量的另一种方法称为*复制初始化*。标准说对于复制初始化的情况，初始化器*没有*它正在初始化的对象的类型，初始化器被转换为正确的类型。

```
// uses copy initialization
string s = "hello"; 
```

首先，让我们说明类型

*   `s`具有 std::string 类型
*   `"hello"`是一个数组，在这种情况下再次像指针一样处理。因此，我们将其视为`char const*`。

编译器寻找两种方法来进行转换。

*   std::string 中是否有*转换构造函数？*
*   初始值设定项是否具有一个类型，该类型具有返回一个转换运算符函数`std::string`？

它将通过其中一种方式创建一个临时对象，然后使用的*复制构造函数*`std::string`来初始化对象。它看到*有*一个接受初始化程序的转换构造函数。所以它使用它。最后，它实际上与`s``std::string`*`std::string`*

 **```
std::string s(std::string("hello")); 
```

请注意，您的示例中使用的表单触发了所有这些

```
std::string s = "hello"; 
```

定义一个*隐式转换*。如果您想知道您的东西的初始化规则，您可以将构造函数标记为您的类型的`char const*`显*式*，并且不再允许将相应的构造函数用作*转换构造函数*：

```
class string {
public:
    explicit string(char const* str) {
        // copy over...
    }
}; 
```

有了这个，现在（以及在其他各种地方）实际上禁止使用 a`copy initialization`和 a来初始化它！`char const*`

现在，那是如果编译器不支持在各个地方省略临时变量。允许编译器假设一个复制构造函数*在*这个上下文中复制，并且可以消除临时字符串的额外副本，而是将临时 std::string 直接构造到初始化对象中。但是，复制构造函数必须是可访问的。所以，如果你这样做，复制初始化是无效的

```
class string {
public:
    explicit string(char const* str) {
        // copy over...
    }

private: // ugg can't call it. it's private!
    string(string const&);
}; 
```

现在实际上，只有直接初始化的情况是有效的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-12T04:14:15.083

编译两者，看看汇编程序。第一个是更少的指令......

```
; 9    :    std::string f("Hello");

    push    OFFSET ??_C@_05COLMCDPH@Hello?$AA@
    lea ecx, DWORD PTR _f$[esp+80]
    call    DWORD PTR __imp_??0?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAE@PBD@Z

; 10   :    std::string g = "Hello";

    push    OFFSET ??_C@_05COLMCDPH@Hello?$AA@
    lea ecx, DWORD PTR _g$[esp+80]
    mov DWORD PTR __$EHRec$[esp+88], 0
    call    DWORD PTR __imp_??0?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAE@PBD@Z 
```

...但这是一个工件，因为它是编译器看到的第一个工件。通过交换顺序更改代码：

```
; 9    :    std::string g1 = "Hello";

    push    OFFSET ??_C@_05COLMCDPH@Hello?$AA@
    lea ecx, DWORD PTR _g1$[esp+136]
    call    DWORD PTR __imp_??0?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAE@PBD@Z

; 10   :    std::string f1("Hello");

    push    OFFSET ??_C@_05COLMCDPH@Hello?$AA@
    lea ecx, DWORD PTR _f1$[esp+136]
    mov DWORD PTR __$EHRec$[esp+144], 0
    call    DWORD PTR __imp_??0?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@QAE@PBD@Z 
```

...你瞧，*第二*个指令少了一个。

我们还看到这个编译器（Microsoft VC++ 2005，发布设置）为两个版本生成了相同的汇编程序。所以它在这个编译器中没有任何区别，你可以证明它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T03:54:53.740

唯一真正的区别是第一个在技术上需要使用复制构造函数，但允许编译器省略它，以便在两种情况下效率相同。

然而，第一个要求复制构造函数是可访问的（即不是私有的），即使它实际上没有被使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T08:09:18.030

其他答案都是正确的，但请记住，**这可能无关紧要。** 这将是罕见的，非常罕见的，非常罕见的，字符串初始化效率会影响你的程序的速度，即使是几分之一秒。

这个问题本身是一个**有趣**的问题，因为它有助于展示 C++ 构造函数和赋值的操作，但实际上，如果你花时间尝试优化它（并且在 SO 上发帖就足以证明你是......）你真的很倾斜在风车。

最好避免分心并将精力花在其他地方。

# c# - ASP.Net 对来自另一个受信任林的用户进行身份验证

> ID：637265
> 
> 赞同：0
> 
> 时间：2009-03-12T03:33:42.857
> 
> 标签：c#, asp.net, active-directory, cross-domain

我想在我的 Asp.Net 应用程序中对来自另一个（受信任的）林的用户进行身份验证。到目前为止，我的 web.config 中有这个：

```
<?xml version="1.0"?>
<configuration>
  <appSettings/>
  <connectionStrings/>
  <system.web>
    <compilation debug="true" />
    <authentication mode="Windows" />
    <authorization>
      <deny users="?"/>
    </authorization>
  </system.web>
</configuration> 
```

我的应用程序在域 A 中的服务器上运行，在林 A 中。我想将对我的应用程序的访问限制为域 A 中的一个组。这个组将是一个“域本地组”。此组将包含林 B 中域 B 的用户。林 B 受林 A 信任。

说了这么多，如果有更好的方法，请告诉我。

提前致谢

-更新-

我刚刚对用户进行了测试，并且 User.Identity.Name 似乎确实是正确的。此外，当检查另一个林中的用户是否在我林的域本地组中时，User.IsInRole 似乎给了我预期的结果。仍然只需要一些运气才能让“允许”和“拒绝”的东西在 web.config 中工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-13T02:12:31.783

好的，只是为我工作，这样做：

```
<?xml version="1.0"?>
<configuration>
  <system.web>
    <authentication mode="Windows"/>
    <authorization>
      <allow roles="MYDOMAIN\MyDomainLocalGroup"/>

      <deny users="*"/>
      <deny users="?"/>
     </authorization>
  </system.web>
</configuration> 
```

有趣的是，这是进行 asp.net 身份验证的普通方法，将用户限制为仅限特定组中的用户。我不确定为什么它第一次不起作用。

# .net - 以域类的名称放置实体是一种好习惯吗？

> ID：637267
> 
> 赞同：0
> 
> 时间：2009-03-12T03:36:48.310
> 
> 标签：.net, oop, naming-conventions, class-design

目前我正在讨论将实体放在每个实体的末尾是否是一种好习惯，例如

```
public class CustomerEntity:BaseEntity{} 
```

代替

```
public class Customer:BaseEntity{} 
```

在我的职业生涯中，我两者都见过，但现在你是怎么做到的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T03:40:34.493

哪个更重要：它是客户还是实体？我说别说了。如果你像实体一样使用它，那么无论你如何命名它，它都是一个实体。但是通过省略“实体”，您可以专注于它是客户这一事实。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T03:45:50.160

在我看来，这里有两个相互矛盾的建议。一种是尽可能使用最简单的名称，另一种是使用命名约定以使您的对象在使用时的用途更加清晰。

就个人而言，如果不太可能对客户是什么感到困惑，我会省略实体部分。如果您发现自己可能有多个名为 Entity 的对象，那么我会留下最常被命名为 Customer 的对象，并为另一个对象创建一些复合名词（如 CustomerOrder、CustomerRequest 等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T03:43:57.777

我们商店中与业务相关的类都继承自一个名为（故意泛指）DomainObject 的类。没有一个继承的类包含“Object”作为其名称的一部分——这将是多余的——我们只是将它们命名为适合它们的功能。

> ID：637268
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# php - 在 PHP 中生成随机密钥的最佳方法是什么？

> ID：637278
> 
> 赞同：40
> 
> 时间：2009-03-12T03:41:28.517
> 
> 标签：php, random

我正在寻找一个可重用的函数，该函数将生成一个随机密钥，其中包含选定长度的可打印 ACSII 字符（从 2 到 1000+）。我认为可打印的 ASCII 字符是 33-126。它们的密钥不需要完全唯一，如果在完全相同的毫秒内生成则唯一（因此`uniqid()`不起作用）。

我正在考虑结合起来`chr()`可能`mt_rand()`会奏效。

这是要走的路，还是其他最好的方法？

**编辑：** `uniqid()`也不会工作，因为它没有长度参数，它只是 PHP 给你的。

**我的想法**：这就是我想出的：

```
function GenerateKey($length = 16) {
    $key = '';

    for($i = 0; $i < $length; $i ++) {
        $key .= chr(mt_rand(33, 126));
    }

    return $key;
} 
```

这有什么问题吗？

**另一个编辑：**大多数其他问题都涉及密码生成。我想要更多种类的角色，我不在乎`1`vs `l`。我希望尽可能多的键是可能的。

**注意：生成的密钥不一定必须是加密安全的。**

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-03-12T04:05:22.310

**更新（12/2015）：对于 PHP 7.0，您应该使用[`random_int()`](http://us2.php.net/manual/en/function.random-int.php)而不是`mt_rand`因为它提供“加密安全值”**

就个人而言，我喜欢使用`sha1(microtime(true).mt_rand(10000,90000))`，但您正在寻找更多可定制的方法，因此请尝试使用此功能（这是对您[对此答案](https://stackoverflow.com/questions/307486/short-unique-id-in-php/307773#307773)的要求的修改）：

```
function rand_char($length) {
  $random = '';
  for ($i = 0; $i < $length; $i++) {
    $random .= chr(mt_rand(33, 126));
  }
  return $random;
} 
```

不过，这可能会比 uniqid()、md5() 或 sha1() 慢得多。

**编辑：**看起来你首先得到它，对不起。:D

**编辑 2：**我决定在我的 Debian 机器上用 PHP 5 和 eAccelerator 做一个很好的小测试（请原谅长代码）：

```
function rand_char($length) {
  $random = '';
  for ($i = 0; $i < $length; $i++) {
    $random .= chr(mt_rand(33, 126));
  }
  return $random;
}

function rand_sha1($length) {
  $max = ceil($length / 40);
  $random = '';
  for ($i = 0; $i < $max; $i ++) {
    $random .= sha1(microtime(true).mt_rand(10000,90000));
  }
  return substr($random, 0, $length);
}

function rand_md5($length) {
  $max = ceil($length / 32);
  $random = '';
  for ($i = 0; $i < $max; $i ++) {
    $random .= md5(microtime(true).mt_rand(10000,90000));
  }
  return substr($random, 0, $length);
}

$a = microtime(true);
for ($x = 0; $x < 1000; $x++)
  $temp = rand_char(1000);

echo "Rand:\t".(microtime(true) - $a)."\n";

$a = microtime(true);
for ($x = 0; $x < 1000; $x++)
  $temp = rand_sha1(1000);

echo "SHA-1:\t".(microtime(true) - $a)."\n";

$a = microtime(true);
for ($x = 0; $x < 1000; $x++)
  $temp = rand_md5(1000);

echo "MD5:\t".(microtime(true) - $a)."\n"; 
```

结果：

```
Rand:   2.09621596336
SHA-1:  0.611464977264
MD5:    0.618473052979 
```

所以我的建议是，如果你想要速度（但不是完整的字符集），那就坚持使用 MD5、SHA-1 或 Uniqid（我还没有测试过）

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2011-05-11T00:04:57.207

如果您想要加密强度的随机性（是否有坚定的攻击者试图猜测您的随机密钥是什么？），这里的答案都不够。散列时间并不安全，攻击者可以通过猜测他们认为您的服务器生成密钥的时间来大大加快他们的搜索速度，并且很容易在给定年份的所有毫秒内搜索，即使在商用笔记本电脑上（它是 35位搜索空间）。此外，`uniqid()`通过散列函数运行结果或其他一些弱随机源以“扩展它”的建议是危险的 - 一旦他们发现你这样做了，这不会使攻击者的搜索更加困难。

如果您真的需要加密级别的安全性，您应该从 /dev/random 读取，以下代码应该适用于任何符合 POSIX 的系统（除了 Windows 之外的任何系统）：

```
#Generate a random key from /dev/random
function get_key($bit_length = 128){
    $fp = @fopen('/dev/random','rb');
    if ($fp !== FALSE) {
        $key = substr(base64_encode(@fread($fp,($bit_length + 7) / 8)), 0, (($bit_length + 5) / 6)  - 2);
        @fclose($fp);
        return $key;
    }
    return null;
} 
```

如果您需要更快的速度，您可以改为从“dev/urandom”中读取。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-12T04:11:52.670

您仍然可以使用 uniqid()，只需做一些额外的处理，将其值扩展为您需要的字符数。

例如，要将其扩展为 32 个字符，您可以这样做

```
$id = md5(uniqid()); 
```

要将其扩展为 64 个字符，只需附加 md5 的 md5，如下所示

```
$first = md5(uniqid());
$id = $first . md5($first); 
```

然后，如果您需要少于 32 的倍数，则根据需要进行 trucate。

您可能会遇到碰撞，但这不太可能。如果您对此感到偏执，只需使用相同的想法，但`uniqid()`通过像 AES 这样的对称密码而不是散列它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-12-02T12:12:05.427

为什么不使用 openssl_random_pseudo_bytes [http://www.php.net/manual/en/function.openssl-random-pseudo-bytes.php](http://www.php.net/manual/en/function.openssl-random-pseudo-bytes.php)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-03T23:13:59.567

*2021 年更新*

**从 PHP 7.0 开始，PHP 有一个专门的函数来生成任意长度的随机密钥：[random_bytes()](https://www.php.net/manual/en/function.random-bytes.php)。**

与以前的解决方案不同，即使包括[openssl_random_pseudo_bytes()](http://php.net/manual/en/function.openssl-random-pseudo-bytes.php)，random_bytes() 也只会返回适合加密使用的数据。它的随机源由操作系统提供，因此实现取决于操作系统。如果没有适合加密使用的随机数据源可用，PHP 将抛出异常。

该问题的先前答案尝试使用诸如 uniqid() 和哈希之类的源创建唯一标识符，但这不会生成*随机*密钥，只会生成一个很可能是唯一的。同样， rand() 或 mt_rand() 的输出对于加密目的来说不够随机。这个问题是在 random_bytes() 或其前身 openssl_random_pseudo_bytes() 在 PHP 中可用之前提出的。

请注意，random_bytes() 返回原始的 8 位二进制数据。如果您希望使这些数据可打印，则需要使用 base64_encode() 或 bin2hex() 之类的编码。

类似的函数 random_int() 也存在，它使用相同的随机源，但输出为整数。当然，这意味着可能输出的密钥数量仅限于整数大小，因此它本身不适合加密密钥之类的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T03:54:08.687

[这个问题](https://stackoverflow.com/questions/307486/short-unique-id-in-php/307773#307773)你会感兴趣吗？

我不确定为什么`uniqid()`对您不起作用，在什么情况下您需要在同一毫秒内唯一的数字，但不一定非要不然；您生成的速度如此之快以至于在同一毫秒内您可能会发生碰撞？我想知道`uniqid()`生成它的数字需要多少时间。如果需要，请使用`uniqid()`带有几个随机字母的函数的前缀参数，您应该是安全的。

如果是用于生成文件，您可能需要查看[`tmpfile()`](http://www.php.net/manual/en/function.tmpfile.php)or [`tempname()`](http://www.php.net/tempname)。

在任何情况下，根据您要实现的目标，您可以循环并验证是否已经使用了唯一 id（在数组中，使用 file_exists 等），如果是这样，只需生成另一个。

* * *

另外，由于我不确定我是否完全理解您的问题，所以我会指出其他听起来很相似的问题，而我却与您有所不同：

*   [生成（伪）随机字母数字字符串](https://stackoverflow.com/questions/48124/generating-pseudorandom-alpha-numeric-strings)
*   [在 MD5 产生碰撞之前有多少随机元素？](https://stackoverflow.com/questions/201705/how-many-random-elements-before-md5-produces-collisions)

如果您想要做一个人类可读的唯一 id，第一个会很有趣。如果您想使用随机数和 md5/sha1，第二个可能会很有用。虽然，我认为`uniqid()`可能已经是您正在寻找的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-10T18:02:02.093

$key = md5(microtime() . rand());

微时间本身并不安全，因为它只留下 1/1000 的机会被猜到。

Rand 本身也不是很安全，但是将它们连接在一起会产生相当可靠的随机化。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-04-20T20:54:48.147

您也可以生成一个随机密钥并检查数据库中的密钥如果密钥退出，您可以通过此方法生成另一个密钥

```
 function activation($lengt=20){
    $modalpage =new Modal;//you can call your modal page and check the key

    $characters = "1234567890abcdefghijklmnopqrstuvwxyz";
    for($i=0;$i<$lengt;$i++)

    {    

    $key .= $characters{rand(0,35)};
    $check= array(
     ":key" => $key,
    );

     $result = $modalpage->findkey($check);

     if($result==true){ //if the key is exits return the function and generate another key !

        return activation($lengt);   

     }else //if the key is not exits return the key
    return $key;
    }

            } 

$mykey=activation(15); 
```

# javascript - 如何将光标移动到 Javascript 中文本区域的最后一个位置？

> ID：637287
> 
> 赞同：31
> 
> 时间：2009-03-12T03:46:15.290
> 
> 标签：javascript, jquery, position, textarea, mouse-cursor

我在表单上有一个文本区域和一个按钮。textarea 中可能已经有一些文本。单击按钮时，我希望光标移动到文本区域中的最后一个位置。

这可能吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-01T10:06:06.687

xgMz 的回答对我来说是最好的。您无需担心浏览器：

```
var html = $("#MyTextArea").val();
$("#MyTextArea").focus().val("").val(html); 
```

这是我写的一个快速的 jQuery 扩展，下次我会这样做：

```
; (function($) {
    $.fn.focusToEnd = function() {
        return this.each(function() {
            var v = $(this).val();
            $(this).focus().val("").val(v);
        });
    };
})(jQuery); 
```

像这样使用：

```
$("#MyTextArea").focusToEnd(); 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-03-12T04:29:20.367

**“最后一个位置”是指文本的结尾吗？**

更改表单字段的“.value”会将光标移动到除 IE 之外的所有浏览器中的末尾。使用 IE，你必须弄脏你的手并故意操纵选择，使用非标准接口：

```
 if (browserIsIE) {
        var range= element.createTextRange();
        range.collapse(false);
        range.select();
    } else {
        element.focus();
        var v= element.value();
        element.value= '';
        element.value= v;
    } 
```

**或者你的意思是把光标放回原来的位置，最后一次聚焦文本区域？**

在除 IE 之外的所有浏览器中，只要调用 'element.focus()' 就已经发生了这种情况；浏览器会记住每个输入的最后一个光标/选择位置并将其重新置于焦点上。

在 IE 中重现这将是相当棘手的。您必须一直轮询以检查光标/选择的位置，并记住该位置（如果它在输入元素中），然后在按下按钮时获取给定元素的位置并恢复它。这涉及对“document.selection.createRange()”的一些非常繁琐的操作。

我不知道 jQuery 中有什么可以帮助你做到这一点，但也许某处可能有一个插件？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-08-21T04:17:56.960

你也可以这样做：

```
$(document).ready(function()
{
    var el = $("#myInput").get(0);

    var elemLen = el.value.length;

    el.selectionStart = elemLen;
    el.selectionEnd = elemLen;

    el.focus();
});​ 
```

此代码适用于`input`和`textarea`。使用最新浏览器测试：Firefox 23、IE 11 和 Chrome 28。

`jsFiddle`在这里可用：http: [//jsfiddle.net/cG9gN/1/](http://jsfiddle.net/cG9gN/1/)

来源：[https ://stackoverflow.com/a/12654402/114029](https://stackoverflow.com/a/12654402/114029)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-08-13T17:52:19.687

你可以使用这个[https://github.com/DrPheltRight/jquery-caret](https://github.com/DrPheltRight/jquery-caret)

```
$('input').caretToEnd(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-12T15:19:22.467

这是我在 onclick 或其他事件中用于 textareas 的内容，并且似乎适用于 FireFox 和 IE 7 & 8。它将光标定位在文本的末尾而不是前面。

```
this.value = "some text I want to pre-populate";
this.blur();
this.focus(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-06-27T09:51:35.077

设置鼠标焦点并将光标移动到输入的末尾。它适用于每个浏览器，这里只是简单的逻辑。

```
input.focus();
tmpStr = input.val();
input.val('');
input.val(tmpStr); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-12T23:57:52.773

我稍微修改了@mkaj 扩展以支持默认值

```
; (function($) {
    $.fn.focusToEnd = function(defaultValue) {
        return this.each(function() {
            var prevValue = $(this).val();
            if (typeof prevValue == undefined || prevValue == "") {
                prevValue = defaultValue;
            }
            $(this).focus().val("").val(prevValue);
        });
    };
})(jQuery);

// See it in action here
$(element).focusToEnd("Cursor will be at my tail..."); 
```

# command-line - 如何从命令行向 IIS 添加自定义 HTTP 标头

> ID：637289
> 
> 赞同：1
> 
> 时间：2009-03-12T03:46:42.717
> 
> 标签：command-line, iis-6, http-headers, nant

我们有一个 ASP.NET 应用程序，我需要为团队中的所有开发人员向 IIS 添加一个自定义 HTTP 标头，因此我想在 NANT 脚本中添加一个命令，该命令将在运行构建脚本时添加 HTTP 标头。甚至可以从命令行执行此操作。

我一直在查找有关文档，`cscript adsutil.vbs`但找不到与此问题相关的任何内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T05:06:56.470

找到好的解决方案。显然我还不够努力，这是设置自定义 HTTP 标头的命令行：

```
cscript adsutil.vbs set w3svc/HttpCustomHeaders "X-Powered-By: ASP.NET" "HeaderName2: value" "HeaderName3: value" 
```

这需要从 c:\Inetpub\AdminScripts 文件夹运行。

作为奖励，这是在构建脚本中执行此操作的 nant 命令：

```
<exec workingdir="c:\Inetpub\AdminScripts" program="cscript.exe" commandline="adsutil.vbs set W3SVC/1/ROOT/Insurance/HttpCustomHeaders &quot;X-Powered-By: ASP.NET&quot; &quot;HeaderName2: value&quot; &quot;HeaderName3: value&quot;" /> 
```

通过[IIS 故障排除、管理和概念](http://blogs.msdn.com/mike/archive/2008/10/15/configuring-iis-to-work-around-webpage-display-issues-in-internet-explorer-8-0.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T04:16:47.743

如果您可以使用 Powershell，则有大量关于使用 WMI 对象管理 IIS 的信息。您还可以编写使用 IIS WMI 对象并公开某些功能的 .NET 命令行帮助应用程序，例如添加自定义 HTTP 标头。

# c# - 学习 C# 或 Java 进行 Web 开发

> ID：637291
> 
> 赞同：11
> 
> 时间：2009-03-12T03:48:38.343
> 
> 标签：c#, java, .net

我不确定这是否是提出这个问题的最佳方式，但我正处于学习编程/开发的早期阶段，我想做很多事情，包括 Web 开发，并且在某些时候我有一定的熟练度，移动开发。

我开始认为我会学习 Java，因为它在开发世界中普遍存在，尤其是 J2ME 在移动开发中的饱和度。然而，考虑到整个系统/框架，.NET 框架，特别是 C# 似乎更适合 Web 开发。

看起来 C# 将是 Web 开发和应用程序开发语言的一个很好的折衷方案，并且鉴于 C# 和 Java 之间的相似性，希望转换到 Java/J2ME 不会很困难。

Java，在我非常有限的经验中，似乎不太方便进行 Web 开发。似乎托管服务提供商相对较少。

我的问题是，这是对 Java 的准确评估吗？它是否与带有主机和框架的 .NET 一样适合 Web 开发？我知道这是一门很棒的语言，但我只是不清楚使用它进行 Web 开发的典型路线图是什么。

为冗长的问题道歉。任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-12T05:07:57.637

除了已经发表的一些评论之外，还有其他一些需要专业考虑的事情：

1.  企业软件主要由 Java 主导，因为许多大型客户端更喜欢部署在 UNIX 环境中，而现有的 .NET CLR 与这些大型客户端的大多数 IT 商店并不完全一致。

2.  Java 通常被认为是企业软件领域中更具吸引力的收购目标。

3.  两者的地域需求似乎不同。在西海岸，北加州地区，爪哇占主导地位。您的专长可能决定您将在哪里找到工作。

如果您对构建消费者站点感兴趣，那么现在许多消费者站点既不是基于 Java 也不是基于 .NET/C# 构建的。除了旧的 PHP 备用 - 还有 Django/Python 和 Rails/Ruby 值得考虑。在所有这些领域都有非常成熟的部署解决方案。我从经验得到的这个结论。

IMO，Rails 堆栈比 Java 世界中提供的任何东西都早了好几年，在大多数情况下，Java 世界仍然需要您将不同的平台拼接在一起并希望它运行良好（这对于 C#/.NET 来说不是问题）。强类型语言本身也往往比 Python/Ruby 更冗长，您可以在其中利用函数式编程技术，例如 clojures 和 lambdas。

在语言之间移动很容易，但就像编程一样，它利用了已经构建的东西——这是棘手的部分。学习语言是真正掌握语言的 10%。了解您正在使用的框架、库的变幻莫测以及了解可用的内容是棘手的部分。仅 Java 基础类就包含数千个类文件！在跳过之前掌握至少一个平台很重要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T04:01:34.350

我已经将两者都用于Web开发。我目前使用 C#/.Net（现在已经有一段时间了），但这并不是说它是优越的平台（或者是吗？？）。在 Java 世界中，我使用 Struts/Hibernate 非常成功地创建了网站，并且真的没有任何抱怨（性能非常好，部署非常简单）。.Net 世界有类似物，例如 Monorail/ASP.Net MVC，当然还有 NHibernate，因此您可以在两个平台上以非常相似的方式创建 Web 应用程序。

我认为决定因素将不得不归结为您自己的喜好。.Net 框架有没有比 Java 更吸引人的地方？您真的喜欢在 Eclipse 中进行开发，并且不想为 Visual Studio 花钱吗？（不过，我应该指出 SharpDevelop 是一个相当不错的 IDE）

所有非常不具体的答案......一大堆“使用原力卢克”之类的东西，但实际上，当一切都说了又做了时，它是个人选择，所以选择任何让你开心的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T04:01:25.970

嗯，据我所见，Java 和 C# 在 Web 开发领域都有很好的份额。它们实际上几乎相同。您可以从任何一种方式开始，并且在尝试学习其中一种时没有任何问题。

我已经看到在 Web 和桌面应用程序中使用 Java 进行了很多开发，所以我真的不知道谁占了上风。

尽管它跑题了，但如果您刚刚开始学习编程，我建议您先尝试学习 C。尽早掌握该语言所需的洞察力将在未来真正有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T04:02:25.937

假设您使用 Visual Studio，C# 会做得更多（并且开箱即用更容易一些）。您无需担心安装外部框架或配置任何东西。您可以在几秒钟内创建一个示例应用程序。

如果你不懂任何编程语言，也许从 php 之类的东西开始是有意义的？尽管做出草率的代码选择（恕我直言）更容易，但您将比任何一个都更快地启动和运行。

如果您想在强大的 *nix 服务器上进行大型企业开发，请务必学习 Java。但是，如果您没有编程经验，那么您似乎不太可能掌握足够的 Java 来“欺骗”这些企业雇用您。不幸的是，php 或 C# 开发人员的入门要求通常较低。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T04:11:32.127

C#/.NET 更易于学习和开发，但 Java 具有开源和跨平台的优势。

如果我站在你的立场上，我会从 .NET/C#（包括 ASP.NET MVC）开始，然后再转向 Java。请注意，有很多相似之处，但也有一些主要差异。

（我是 .NET 开发人员，但我也在为移动项目学习 Java。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T05:31:20.187

如果您想开发多平台，请使用 Java（以及 JSP/Applet/Servlet）
如果您想继续使用 .Net（和 Mono），请使用 C# 或 VB.Net 以及 ASP.NET

如果我现有的知识是服务器端编程语言（ASP/PHP/Python），尤其是 PHP，因为它是面向对象和多平台的，我个人将学习 Ajax（必不可少）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T05:54:29.273

.Net 会更容易开始，但如果这是你的目标，你不妨从 PHP 开始（讨厌）。从长远来看，两者都可以平等地完成工作。如果您以 Microsoft 的方式开发网站，这将是一条非常直截了当的道路，Java 拥有如此多的开源框架库，仅选择一个可能会令人生畏。我猜 Java 开发人员赚更多的钱主要是因为它在企业 Web 开发领域占据主导地位。PHP 程序员肯定赚的少。

我主要使用 Java 开发网站，并会通过 .Net 推荐它，因为有很多免费工具、应用程序服务器和框架供它使用。您可以使用 Tomcat、Apache、MySQL 和 Linux 构建一个 Java 站点，而无需支付任何许可费用。

不要过火，并尝试一次做所有事情。

学习一些 Java 和 JDBC 使用 JSP（模型 1）构建您的站点，这将使您对该平台有所了解。然后尝试其中一种框架，如 Struts 或 JSF，到那时您将能够更加欣赏它们。

# python - 在 Python 中使用空格有什么陷阱吗？

> ID：637295
> 
> 赞同：3
> 
> 时间：2009-03-12T03:50:34.033
> 
> 标签：python, whitespace

目前我在 Python 中从来没有遇到过空格问题（尽管我只在两个项目中使用过它，而且我是唯一的程序员）。对于学习该语言的人来说，Python 中的空格和缩进有哪些潜在的陷阱？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-12T03:59:08.113

在某些编辑器中可能会造成混淆，其中一行用空格缩进，下一行用制表符缩进。这令人困惑，因为缩进看起来相同但会导致错误。

此外，当您复制代码时，如果您的编辑器没有缩进整个块的功能，那么修复所有缩进可能会很烦人。

但是有了一个好的编辑器和一些练习，这应该不是问题。我个人非常喜欢 Python 使用空格的方式。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-12T04:56:58.570

是的，有一些陷阱，但大多数时候，在实践中，它们变成了[吉诃德式的敌人风车](http://en.wikipedia.org/wiki/Tilting_at_windmills)，即虚构的，在现实中没有什么可担心的。

我估计*最有可能遇到*的陷阱是（包括确定的缓解步骤）：

1.  **与他人一起工作，也就是协作**

    一种。如果您有其他人出于某种原因拒绝遵守[PEP 8](http://www.python.org/dev/peps/pep-0008/)，那么维护代码可能会变得很痛苦。一旦我向他们指出 python 的几乎通用约定是**缩进级别 == 四个空格，我在实践中从未见过这种情况**

    湾。让与您一起工作的任何人/每个人都接受约定，并让他们弄清楚如何让他们的编辑器自动执行此操作（或者更好的是，如果您使用相同的编辑器，请向他们展示如何配置它），以便复制和粘贴东西*就可以了*。

2.  **如果您当前首选的编辑器不是 python 友好的，则必须投资一个“体面”的编辑器而不是您当前首选的编辑器**——这不是一个真正的陷阱，更多的是投资要求，以避免提到与复制和粘贴相关的其他陷阱，重构等停止使用记事本，你会在早上感谢自己。

    一种。在理解的编辑器下，您编辑代码的效率会高得多`python`

    湾。大多数*现代*代码编辑器都可以很好地处理 python。我自己更喜欢 GNU Emacs，最近的版本`python-mode`提供了开箱即用的出色支持。还有许多[其他编辑器可供探索](http://wiki.python.org/moin/PythonEditors)，包括许多免费的替代品和[IDE](http://wiki.python.org/moin/IntegratedDevelopmentEnvironments)。

    C。python 本身带有一个“智能”python 编辑器，开箱即用`idle`。如果您不熟悉，请查看它，因为它可能已经在您的 python 安装中可用，甚至可能`python`比您当前的编辑器支持得更好。 [PyCrust](http://wxpython.org/py.php)是在 python 中实现的 python 编辑器的另一个选项，它是 wxPython 的一部分。

3.  **一些包含 python 的代码生成或模板环境（想想 HTML 生成或 python CGI/WSGI 应用程序）可能有怪癖**

    一种。他们中的大多数人，如果他们接触了 python，已经采取措施将 python 的性质作为一个问题最小化，但它仍然偶尔会弹出。

    湾。如果您遇到这种情况，请熟悉框架作者已经采取的最小化影响的步骤，并阅读他们的建议（*是的，如果在他们的项目中遇到过，他们会有一些*建议），并且很容易在此避免与 python 相关的陷阱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T04:11:21.610

这实际上让我有一段时间远离 Python。来自强大的 C 背景，我感觉自己开车时没有系安全带。

当我试图在我的编辑器中使用样板文件、常用类填充代码段库时，情况变得更糟了。我通过例子学得最好，所以我尽可能多地抓住有趣的片段，目的是在学习的同时编写一个有用的程序。

在我养成了重新格式化我借来的所有东西的习惯之后，它并没有那么糟糕。但是还是觉得很别扭。我不得不习惯动态类型语言加上缩进来控制我的代码。

这对我来说是一个很大的飞跃:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T11:02:21.217

当我查看 C 和 Java 代码时，它总是很好地缩进。

总是。很好。缩进。

显然，C 和 Java 人员花费大量时间来正确处理他们的空白。

Python 程序员也是如此。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T04:18:40.593

空白块分隔符强制进行一定数量的代码格式化，这似乎激怒了一些程序员。我们店里的一些人似乎认为他们太忙了，或者懒得去关注格式标准，而一种强迫它的语言使他们生不如死。有时，当其他人不遵循将花括号放在新行上的相同模式时，同样的人会抱怨；）

我发现来自网络的 Python 代码通常更“可读”，因为这种次要格式要求已经到位。IMO，这个要求是一个非常有用的功能。

IIRC，Haskell、OCaml (#light) 和 F# 不也以同样的方式使用空格吗？出于某种原因，我没有看到任何关于这些语言的投诉。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-12T04:18:46.350

很久以前，在很远很远的环境中，有一些语言（如RPG）依赖于穿孔卡片的列结构。这是一个乏味且烦人的系统，并导致许多错误，而新的语言（如 BASIC、pascal 等）的设计没有这种依赖性。

一代程序员接受了这些语言的培训，并反复告诉他们可以自由地将任何东西放在任何地方是新语言的一个很棒的特性，他们应该感激不尽。多年来，这种自由被使用、滥用和校准（参见[IOCC ）。](http://www.ioccc.org/)

现在钟摆已经开始回摆，但很多人还记得强制布局在某种程度上是不好的模糊，并抵制它。

恕我直言，要做的事情是按照自己的方式使用语言，而不是沉迷于品味-伟大-不那么充实的战斗。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-12T04:20:47.767

有人说他们不喜欢 python 缩进，因为它会导致错误，如果制表符和空格混合在一起，将很难检测到。例如：

```
1 if needFrobnicating:
2    frobnicate()
3 update() 
```

根据选项卡的宽度，第 3 行可能与第 2 行位于同一块中，或者在封闭块中。这不会导致运行时或编译错误，但程序会做意想不到的事情。

虽然我在 python 中编程了 10 年，但从未见过由混合制表符和空格引起的错误

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-12T04:33:26.177

当 python 程序员不遵循[**PEP 8**](http://www.python.org/dev/peps/pep-0008/)中定义的“每个缩进级别使用 4 个空格”的通用约定时。（*如果您是 python 程序员并且还没有阅读它，请阅读*）

然后你遇到复制粘贴问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-12T04:37:09.537

选择一个好的编辑器。您需要以下功能：

1.  模拟最后缩进行的自动缩进
2.  您可以控制的自动缩进（制表符与空格）
3.  显示空白字符
4.  加载文件时检测和模仿空白约定

例如，Vim 让我使用以下设置突出显示选项卡：

```
set list
set listchars=tab:\|_
highlight SpecialKey ctermbg=Red guibg=Red
highlight SpecialKey ctermfg=White guifg=White 
```

可以随时使用以下方法关闭：

```
set nolist 
```

IMO，我不喜欢将制表符转换为空格或反之亦然的编辑器设置，因为您最终会混合使用制表符和空格，这可能很讨厌。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-12T04:48:18.497

我曾经认为空白问题只是习惯的问题。

有人指出了 Python 缩进的一些严重缺陷，我认为它们是非常有效的，对这些的一些潜意识理解是让经验丰富的程序对整个事情感到紧张的原因：-

*   剪切和粘贴不再起作用了！您不能从一个应用程序中剪切样板代码并将其放入另一个应用程序。
*   你的编辑变得无力帮助你。对于 C/Jave 等，“官方”大括号缩进和“非官方”空白缩进有两件事。大多数编辑器都能够重新格式化空白缩进以匹配大括号嵌套——如果缩进不是你所期望的，这会给你一个字符串视觉线索，表明出现了问题。使用 python 的“空间即语法”范式，您的编辑器无法为您提供帮助。
*   在已经很复杂的逻辑中引入另一个条件的痛苦。在现有条件中添加另一个 if then else 涉及在多行上手动插入大量容易出错的愚蠢空格。
*   重构是一场噩梦。在类周围移动代码块非常痛苦，忍受“错误”的类结构比将其重构为更好的结构更容易。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-12T13:05:08.987

如果你使用 Eclipse 作为你的 IDE，你应该看看 PyDev；它自动处理缩进和间距。您可以从混合间距来源复制粘贴，它会为您转换它们。自从我开始学习这门语言以来，我从来没有考虑过间距。

这真的不是问题。无论如何，理智的程序员都会缩进。使用 Python，您只需做您一直在做的事情，而不必键入和匹配大括号。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-12T17:33:41.857

陷阱

*   在忽略缩进的网站上发布代码片段可能会很烦人。

*   很难看出多行匿名函数（lambdas）如何适应语言的语法。

*   这使得将 Python 嵌入 HTML 文件以制作模板变得困难，就像 PHP 或 C# 可以嵌入 PHP 或 ASP.NET 页面一样。但这不一定是设计模板的最佳方式。

*   如果您的编辑器没有用于块缩进和缩进的合理命令，那么重新对齐代码将会很乏味。

好处

*   甚至迫使懒惰的程序员编写清晰的代码。我见过一些大括号语言代码的例子，我不得不花费数小时重新格式化才能阅读它......

*   Python 程序员不需要花费数小时来讨论大括号应该放在 K&R 风格的行尾还是 Microsoft 风格的自己的行上。

*   释放大括号字符以用于字典和集合表达式。

*   自动清晰易读

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-12T03:59:39.347

问题在于，在 Python 中，如果您在文件的一个区域中使用空格来缩进基本块，而在另一个区域中使用制表符来缩进，则会出现运行时错误。这与 C 中的分号完全不同。

不过，这并不是一个真正的编程问题，不是吗？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-12T04:27:56.627

我曾经遇到的唯一麻烦是在我决定是否喜欢制表符或空格，或者从网站上剪切和发布代码之前使用我编写的代码时出现轻微的烦恼。

我认为现在大多数体面的编辑器都有一个将制表符转换为空格并返回选项。Textmate当然可以。

除此之外，压痕从来没有给我带来任何麻烦。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-12T15:40:53.360

如果您使用 emacs，请将硬制表符长度设置为 8，将软制表符长度设置为 4。这样您将被更改为任何无关的制表符。您应该始终使用 4 个空格而不是制表符。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-12T15:51:21.573

作为 python 的初学者，我遇到的一个缺点是忘记在我的编辑器中设置 softtabs，这给我带来了很多麻烦。

但是在认真使用该语言一年之后，我无法再用任何其他语言编写缩进不佳的代码。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-12T17:55:43.130

不，我会说这是我找不到失败的一件事。是的，这无疑会让某些人感到恼火，但这只是因为他们对格式的风格有不同的习惯。早点学习，它会坚持下去。看看我们有多少关于 C、Cpp、Java 等语言的风格问题的讨论。您看不到关于 Python、F77 以及此处提到的其他一些具有“固定”格式样式的语言的那些（毫无疑问是无用的）讨论。

唯一可变的是空格与制表符（可以使用任何好的编辑器稍微麻烦地更改），以及选项卡占的空格量（可以使用任何好的编辑器轻松更改）。瞧！风格讨论完成。

现在我可以做一些有用的事情了：）

# windows-mobile - 在 Windows Mobile 6 设备上访问 SQL Server CE 数据库

> ID：637305
> 
> 赞同：0
> 
> 时间：2009-03-12T03:57:30.287
> 
> 标签：windows-mobile, sql-server-ce, rapi

我有一个移动应用程序，可以写入设备上的 SQL Server CE 数据库。我想编写一个桌面应用程序，可以读取这些数据并以 CSV 格式导出。我一直在研究[RAPI](http://msdn.microsoft.com/en-us/library/aa920150.aspx) (Remote Api)，但我更愿意完全使用托管代码来做到这一点。RAPI 有替代品吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-24T12:54:41.003

您是否使用 RAPI 将 SQLCE 数据库复制到 PC 并让 PC 应用程序使用它，完成后将数据库文件复制回 PDA？

我正在考虑做类似的事情。

如果您在途中遇到任何障碍/问题，请告诉我。

你用过 OpenNETCF 2.3 吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T12:56:47.230

您可以编写自定义套接字通信协议，这样您的移动应用程序将侦听套接字连接，而桌面将“调用”然后发送命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T01:04:43.783

我最初问这个问题的原因是我担心 RAPI 会过多地参与我的小应用程序（在查看 API 文档之后）。尽管如此，我还是开始用非托管代码编写一个包装库，结果发现我必须携带整个 C++ 运行时环境。所以我最终拼凑了一些用于 RAPI 文件处理和文件系统操作的方法，这些方法使用 P/Invoke 直接从 C# 调用 RAPI。我在不同的地方找到了其中的一些方法，添加了更多我自己的方法，并将它们全部放在 C# 类中。我为它们配备了一致的错误处理，经过几个小时的努力，结果证明它完全符合我的需要。

# c# - 为什么在字符串中添加 null 是合法的？

> ID：637308
> 
> 赞同：65
> 
> 时间：2009-03-12T03:58:46.290
> 
> 标签：c#, language-design

MSDN 关于[字符串基础](http://msdn.microsoft.com/en-us/library/ms228362.aspx)的文章显示了这一点：

```
string str = "hello";
string nullStr = null;
string emptyStr = "";

string tempStr = str + nullStr; // tempStr = "hello"
bool b = (emptyStr == nullStr);// b = false;
string newStr = emptyStr + nullStr; // creates a new empty string
int len = nullStr.Length; // throws NullReferenceException 
```

为什么不与 null 连接会引发空引用异常？是为了让程序员的生活更轻松，这样他们就不必在连接之前检查 null 了吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-03-12T04:04:49.147

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms228504.aspx)：

> 在字符串连接操作中，C# 编译器将空字符串视为空字符串，但它不会转换原始空字符串的值。

有关[+ 二元运算符](http://msdn.microsoft.com/en-us/library/aa691375(VS.71).aspx)的更多信息：

> 当一个或两个操作数都是字符串类型时，二元 + 运算符执行字符串连接。
> 
> 如果字符串连接的操作数为 null，则替换为空字符串。否则，通过调用从类型 object 继承的虚拟 ToString 方法，将任何非字符串参数转换为其字符串表示形式。
> 
> 如果 ToString 返回 null，则替换为空字符串。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-28T18:17:39.110

我同意从概念上讲字符串只是值。但是，请考虑以下代码：

```
int? i = null;
i += 1; // The result of this is that i == null 
```

如果其他值类型运算符使用 default() 字符串运算符将 null 转换为“”的方式，那么您的解释将是有意义的。

为了方便起见，最简单的说法是字符串运算符是一种快捷方式（特殊情况）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T04:31:42.047

从概念上讲，字符串通常被认为是值，而不是对具有标识的对象的引用。它们不`struct`具有值语义的主要原因之一是分配时复制带来的开销。如果字符串**是**值，则它们不能为空，因此`null`“+”运算符仅将 a 视为空字符串（即，`default(string) == ""`就像 一样`default(int) == 0`）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T04:08:47.653

我猜语言（或标准库）设计者认为这将是一个足够常见的案例，他们会帮程序员一个忙。

（整洁！我总是假设与 null 连接会通过异常！）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T04:08:13.007

它不抛出空引用异常的原因是因为您实际上并没有尝试访问空对象上的任何属性或方法。作为 CMS 引号，在连接字符串时，将空字符串替换为空字符串。

# ruby - 是否可以使用 Ruby LDAP 更改 AD 用户帐户？

> ID：637311
> 
> 赞同：2
> 
> 时间：2009-03-12T04:00:18.110
> 
> 标签：ruby, active-directory, ldap

使用在 Linux 上运行的 Ruby LDAP，我可以毫无问题地创建一个新的 Active Directory 用户帐户。现在我想重命名一个用户帐户用户名。

当我尝试更改时`sAMAccountName`，它不起作用。是否可以使用 Ruby LDAP 更改 AD 用户帐户？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T19:35:00.910

当您说“不起作用”时，返回的错误是什么？您应该完全有能力更改`sAMAccountName`使用任何 LDAP 客户端或库的值，前提是连接最初是作为管理用户进行身份验证的（即有权更改所述条目和条目属性的用户。）

* * *

**更新**

从错误消息中可以看出，尽管您声称只尝试修改 ，但也尝试`sAMAccountName`了更改`CN`，或者`CN`是特殊的（它是`DN`.）的一部分

为了改变`CN`你可能不得不使用[`modrdn`](http://ruby-ldap.sourceforge.net/rdoc/classes/LDAP/Conn.html#M000029)重命名的`CN`部分`DN`（标准化等效`MoveHere`）：

```
conn.modrdn('CN=old-name,OU=orgunit,DC=domain', 'CN=new-name', true)
conn.modify('CN=new-name,OU=orgunit,DC=domain', 'sAMAccountName' => new-acct) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-14T15:51:31.493

我看到这是一岁了，但无论如何我都会回答。

我在 Rails 应用程序中使用[ActiveLdap](http://ruby-activeldap.rubyforge.org/doc/) ......它使用了它背后的[Ruby/LDAP gem。](http://github.com/alexey-chebotar/ruby-ldap)我可以在我的代码中执行以下操作。

```
aduser = User.find("matt")
puts aduser.cn
# prints 'matt'
puts aduser.distinguishedname
# prints 'cn=matt,ou=here,dc=my,dc=domain'

# THIS RENAMES THE ACCOUNT AND AUTOMATICALLY HANDLES ALL THE ATTRIBUTES
# THAT NEED TO CHANGE... e.g. name, cn, distinguishedname, dn
aduser.cn = "newmatt"
aduser.save 
```

您应该能够查看 ActiveLdap 代码并弄清楚它们是如何通过 Ruby/Ldap 做到这一点的。

然而，目前在 ActiveLdap 中不起作用的是“newsuperior”，因此目前没有办法将对象从一个容器移动到另一个容器。我仍在研究如何实现这一目标。

马特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T20:00:16.607

您有机会发布一些代码吗？此外，您可能想尝试使用真正用于移动用户帐户的[MoveHere](http://msdn.microsoft.com/en-us/library/aa705991(VS.85).aspx#)方法，但也可用于重命名帐户。

# java - Java中的一次写入+读取多次映射？

> ID：637324
> 
> 赞同：5
> 
> 时间：2009-03-12T04:06:57.130
> 
> 标签：java, performance, data-structures

我有一个要求，一个 Map 将由最多 50~200 个条目构成（它可能更多，无论如何我们都称它为不太少）。写入只完成一次，读取（使用 Map.get("keyName")）每个请求可以超过 20 次（它是一个 web 应用程序）。

我目前正在使用 Hashmap，因为它（我想）给了我最优化的性能（注意：每个请求有很多读取）。不是数据结构专家，你们中的任何人都可以建议最适合我的要求的 Map 实现，比如来自 java.lang.*、Apache commons 等包吗？

yc

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T04:30:35.013

除非您实际上遇到了性能问题（并已将它们追溯到此代码），否则我不会担心。

在我尝试替换 Map 之前，我会看看为什么我需要进行 4000 次查找（200 个条目，每个条目 20 次读取）来生成一个网页。

但我敢打赌，与流程的其他部分相比，进行这 4000 次查找的时间将变得微不足道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T04:16:26.280

如果所有写入都在任何读取之前完成，那么您可以使用[Collectons.unmodifiableMap](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#unmodifiableMap(java.util.Map))方法。

如果不是这种情况，那么编写代码来做你想做的事情并不难（四处寻找包含基本代码的帖子......）

嗯......只是为了确保问题是我在想什么......只读方面是重要的部分还是试图快速访问数据是最重要的部分？

编辑：（基于评论）

如果代码很慢，您是否使用分析器检查过？如果没有，那么你不应该担心它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T15:18:42.650

如果这实际上是一个瓶颈，我会考虑调整地图的大小以避免碰撞。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T18:29:09.177

如果真的值得麻烦，您可以尝试[完美散列](http://en.wikipedia.org/wiki/Perfect_hash_function)。不过，我不熟悉任何 Java 实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T17:54:42.647

如果你严格写在开头，在读者开始之前，那么跨线程的同步和共享不是问题...... HashMap 是你的朋友。当您不确定时：ConcurrentHashMap。

这两种实现都是 JDK 的一部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T18:09:51.220

几年前（作为一个学校项目），我在 C 中实现了一次写入多次读取的映射（和其他集合），它采用现有集合，然后通过创建更多内存和缓存效率的表示来“密封”它（例如，一个图形被存储为一个优化的数组）。我们看到了惊人的性能差异。

由于 Java 支持接口，因此实现这样的东西会容易得多（实际上是鼓励的），但我不熟悉开箱即用的实现。

# iis - 如何获得在 IIS 7.0 下运行的经典 asp 应用程序的指南

> ID：637326
> 
> 赞同：29
> 
> 时间：2009-03-12T04:07:59.123
> 
> 标签：iis, iis-7, asp-classic

我正在寻找一个非常简单的逐步“操作方法”指南，以获取在 IIS 7.0 下运行的经典 asp 应用程序。

它在 64 位 windows server 2008 机器上，如果这有什么不同的话。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-03-12T15:57:42.977

我们一直在将一些经典 ASP 代码移至 64 位 Windows 2008。以下是我们在此过程中所做或发现的一些事情：

*   首先将应用程序托管在“经典”管道模式应用程序池中。一旦一切运行良好，您可以切换到“集成模式”，如果您以后需要利用它提供的功能。

*   如果您的 ASP 应用程序使用任何 32 位第三方或内部组件，您需要将应用程序池配置为在 32 位模式下运行。32 位 DLL 不会加载到 64 位进程中。您可以在应用程序池的高级设置中进行配置。设置`Enable 32-Bit Applications`为`True`。

*   要强制通过 Classic ASP 进行详细错误报告，请打开网站的 ASP“功能”页面，然后展开 `Debugging Properties`节点。设置`Send Errors To Browser`为`True`。

*   如果您的应用程序使用父路径，您需要在 ASP 设置的“功能”页面中进行配置（与上述相同）。该设置位于 `Behaviour`节点下并命名为 `Enable Parent Paths`. 默认设置 `False`与 IIS6 相同。

*   IIS7 中的默认匿名帐户称为`IUSR`. 您可以通过打开网站的身份验证设置“功能”页面并编辑设置来更改此`Anonymous Authentication` 设置。

*   更喜欢对应用程序池和站点匿名帐户使用应用程序池标识：[应用程序池标识](http://learn.iis.net/page.aspx/624/application-pool-identities/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-06T14:39:00.123

我知道这是一个已有 5 年历史的线程，但它仍然适用于我们这些延迟迁移/升级旧 ASP 应用程序的人。

这里有一些非常重要的事情，我花了大约 2 个小时来敲打我的脑袋。您到底是如何将 ASP 应用程序放入应用程序池中的，您不能使 ASP 页面成为应用程序，它们只是不兼容的技术。

好吧，在 DUHH 时刻，我发现有一个分配给整个站点的应用程序池。只需转到“站点”下的站点并选择基本设置并分配一个应用程序池。

其余的都是很好的信息，包括注册您的 DLL，我不知道它是否在这个线程中，而且还使用两个不同的 odbcad32.exe 应用程序使您的 ODBC 连接为 32 位和 64 位。

再次感谢，（晚了5年）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T23:03:34.673

另请注意，如果您需要注册 32 位 dll，而 IIS 在 32 位模式下运行，则应使用 \windows\syswow64\regsvr32.exe dllname.dll。

哦，请确保您没有打开服务器端调试太久。这将导致 IIS 以单线程模式运行（并使其非常慢）。

# mysql - MySQL视图是否总是进行全表扫描？

> ID：637328
> 
> 赞同：6
> 
> 时间：2009-03-12T04:08:39.947
> 
> 标签：mysql, database, materialized-views, indexed-view

我正在尝试优化使用 MySQL 5.1 中的视图的查询。似乎即使我从视图中选择 1 列，它也总是会进行全表扫描。这是预期的行为吗？

对于我在下面的第一个查询中指定的表，该视图只是一个 SELECT "All Columns From These Tables - NOT *"。

这是我从构成视图的查询中选择索引列 PromotionID 时的解释输出。如您所见，它与视图上的输出有很大不同。

```
EXPLAIN SELECT pb.PromotionID FROM PromotionBase pb INNER JOIN PromotionCart pct ON pb.PromotionID = pct.PromotionID INNER JOIN PromotionCode pc ON pb.PromotionID = pc.PromotionID WHERE pc.PromotionCode = '5TAFF312C0NT'\G;
*************************** 1\. row ***************************
           id: 1
  select_type: SIMPLE
        table: pc
         type: const
possible_keys: PRIMARY,fk_pc_pb
          key: PRIMARY
      key_len: 302
          ref: const
         rows: 1
        Extra:
*************************** 2\. row ***************************
           id: 1
  select_type: SIMPLE
        table: pb
         type: const
possible_keys: PRIMARY
          key: PRIMARY
      key_len: 4
          ref: const
         rows: 1
        Extra: Using index
*************************** 3\. row ***************************
           id: 1
  select_type: SIMPLE
        table: pct
         type: const
possible_keys: PRIMARY
          key: PRIMARY
      key_len: 4
          ref: const
         rows: 1
        Extra: Using index
3 rows in set (0.00 sec) 
```

当我从视图中选择相同的东西时的输出

```
EXPLAIN SELECT vpc.PromotionID FROM vw_PromotionCode vpc  WHERE vpc.PromotionCode = '5TAFF312C0NT'\G;
*************************** 1\. row ***************************
           id: 1
  select_type: PRIMARY
        table: <derived2>
         type: ALL
possible_keys: NULL
          key: NULL
      key_len: NULL
          ref: NULL
         rows: 5830
        Extra: Using where
*************************** 2\. row ***************************
           id: 2
  select_type: DERIVED
        table: pcart
         type: index
possible_keys: PRIMARY
          key: PRIMARY
      key_len: 4
          ref: NULL
         rows: 33
        Extra: Using index
*************************** 3\. row ***************************
           id: 2
  select_type: DERIVED
        table: pb
         type: eq_ref
possible_keys: PRIMARY
          key: PRIMARY
      key_len: 4
          ref: readyinteractive.pcart.PromotionID
         rows: 1
        Extra:
*************************** 4\. row ***************************
           id: 2
  select_type: DERIVED
        table: pc
         type: ref
possible_keys: fk_pc_pb
          key: fk_pc_pb
      key_len: 4
          ref: readyinteractive.pb.PromotionID
         rows: 249
        Extra: Using where
*************************** 5\. row ***************************
           id: 3
  select_type: UNION
        table: pp
         type: index
possible_keys: PRIMARY
          key: pp_p
      key_len: 4
          ref: NULL
         rows: 1
        Extra: Using index
*************************** 6\. row ***************************
           id: 3
  select_type: UNION
        table: pb
         type: eq_ref
possible_keys: PRIMARY
          key: PRIMARY
      key_len: 4
          ref: readyinteractive.pp.PromotionID
         rows: 1
        Extra:
*************************** 7\. row ***************************
           id: 3
  select_type: UNION
        table: pc
         type: ref
possible_keys: fk_pc_pb
          key: fk_pc_pb
      key_len: 4
          ref: readyinteractive.pb.PromotionID
         rows: 249
        Extra: Using where
*************************** 8\. row ***************************
           id: 4
  select_type: UNION
        table: pcp
         type: index
possible_keys: PRIMARY
          key: pcp_cp
      key_len: 4
          ref: NULL
         rows: 1
        Extra: Using index
*************************** 9\. row ***************************
           id: 4
  select_type: UNION
        table: pb
         type: eq_ref
possible_keys: PRIMARY
          key: PRIMARY
      key_len: 4
          ref: readyinteractive.pcp.PromotionID
         rows: 1
        Extra:
*************************** 10\. row ***************************
           id: 4
  select_type: UNION
        table: pc
         type: ref
possible_keys: fk_pc_pb
          key: fk_pc_pb
      key_len: 4
          ref: readyinteractive.pb.PromotionID
         rows: 249
        Extra: Using where
*************************** 11\. row ***************************
           id: 5
  select_type: UNION
        table: ppc
         type: index
possible_keys: PRIMARY
          key: ppc_pc
      key_len: 4
          ref: NULL
         rows: 1
        Extra: Using index
*************************** 12\. row ***************************
           id: 5
  select_type: UNION
        table: pb
         type: eq_ref
possible_keys: PRIMARY
          key: PRIMARY
      key_len: 4
          ref: readyinteractive.ppc.PromotionID
         rows: 1
        Extra:
*************************** 13\. row ***************************
           id: 5
  select_type: UNION
        table: pc
         type: ref
possible_keys: fk_pc_pb
          key: fk_pc_pb
      key_len: 4
          ref: readyinteractive.pb.PromotionID
         rows: 249
        Extra: Using where
*************************** 14\. row ***************************
           id: 6
  select_type: UNION
        table: ppt
         type: index
possible_keys: PRIMARY
          key: ppt_pt
      key_len: 4
          ref: NULL
         rows: 1
        Extra: Using index
*************************** 15\. row ***************************
           id: 6
  select_type: UNION
        table: pb
         type: eq_ref
possible_keys: PRIMARY
          key: PRIMARY
      key_len: 4
          ref: readyinteractive.ppt.PromotionID
         rows: 1
        Extra:
*************************** 16\. row ***************************
           id: 6
  select_type: UNION
        table: pc
         type: ref
possible_keys: fk_pc_pb
          key: fk_pc_pb
      key_len: 4
          ref: readyinteractive.pb.PromotionID
         rows: 249
        Extra: Using where
*************************** 17\. row ***************************
           id: NULL
  select_type: UNION RESULT
        table: <union2,3,4,5,6>
         type: ALL
possible_keys: NULL
          key: NULL
      key_len: NULL
          ref: NULL
         rows: NULL
        Extra:
17 rows in set (0.18 sec) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-12T04:27:19.077

MySQL 中的视图没有索引，因此从本质上讲，每次访问它们时都需要进行完整扫描。一般来说，这使得 Views 仅在您有一个相当复杂的静态查询返回一个小的结果集并且您计划每次都获取整个结果集的情况下才有用。

**编辑：**当然，视图将使用基础表上的索引，以便优化视图本身（否则它们根本没有任何意义）但是因为视图上没有索引，所以 WHERE 是不可能的查询要优化的视图。

无论如何，为视图构建索引会很昂贵，因为虽然我没有尝试分析任何视图，但我相当肯定临时表是在幕后构建的，然后返回结果集。构建临时表已经花费了大量时间，我不想要一个也试图猜测需要哪些索引的视图。这就引出了第二点，即 MySQL 目前没有提供一种方法来指定视图使用哪些索引，那么它如何知道需要索引哪些字段？它会根据您的查询猜测吗？

您可能会考虑使用[临时表](http://dev.mysql.com/doc/refman/5.1/en/create-table.html)，因为这样您就可以在临时表中的字段上指定索引。但是，根据经验，这往往非常非常缓慢。

如果这个视图包含的只是一个 SELECT ALL FROM table1, table2, table3; 那么我不得不问为什么这个查询需要在视图中？如果出于某种原因绝对有必要，您可能希望使用存储过程来封装查询，因为您将能够获得优化的性能，同时保持对结果集的数据库调用更简单的好处。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T06:08:41.360

我已经深入研究了它，我错过了一个关键信息点:(我的视图查询实际上与另一个表有一个联合。这导致视图使用 TEMPORARY TABLE 算法而不是 MERGE 算法。

TEMPORARY TABLE 算法不允许在基础表中使用索引。

这似乎是 MySQL 中的一个错误，早在 2006 年就有报道，但看起来它在 2009 年没有得到解决！[http://forums.mysql.com/read.php?100,56681,56681](http://forums.mysql.com/read.php?100,56681,56681)

看起来我只需要将查询重写为外部连接。

# asp-classic - 从经典 ASP 3.0 访问和操作 DBF

> ID：637334
> 
> 赞同：0
> 
> 时间：2009-03-12T04:12:04.370
> 
> 标签：asp-classic, vbscript, dbf

通常我使用 SQL Server 作为我的项目的数据库，但我的一个项目处理使用 .dbf 格式作为数据库的 ESRI shapefile（我认为它是 DBASE III 或 IV 格式）。

我想创建一些 Web 界面来修改 dbf 上已经存在的值，例如，如果街道名称不正确或多个地方的地址，客户可以编辑它。

过去我已经运行了 Classic ASP 3.0 应用程序，我想集成新功能。

我的问题：
1\. 什么是与 DBF 交互的连接字符串（DSN-less 更可取）？
2\. 谁能给我一些检索/更新记录的例子？

我已经读过这个：
[http](http://www.intermedia.net/support/kb/default.asp?id=761) ://www.intermedia.net/support/kb/default.asp?id=761和
[http://www.motobit.com/tips/detpg_asp-dbf-database/](http://www.motobit.com/tips/detpg_asp-dbf-database/)

没有工作，目前我的代码是这样的（不工作）：

```
 Set connDBF1 = Server.CreateObject("ADODB.Connection")
connDBF1.ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\digimap;Extended Properties=""DBASE IV;"";"
connDBF1.Open

Set connDBF2 = Server.CreateObject("ADODB.Connection")
connDBF2.ConnectionString = "DBQ=D:\digimap;DefaultDir=D:\digimap;Driver={Microsoft dBase Driver (*.dbf)};ImplicitCommitSync=Yes;MaxBufferSize=512;MaxScanRows=8;PageTimeout=5;Threads=3;UserCommitSync=Yes;"
connDBF2.Open

set rs = connDBF1.Execute("SELECT * FROM taspat_ka_jawa") 
set rs = connDBF2.Execute("SELECT * FROM taspat_ka_jawa") 
```

错误是

```
Microsoft JET Database Engine error '80040e37' 

The Microsoft Jet database engine could not find the object 'taspat_ka_jawa'. Make sure the object exists and that you spell its name and the path name correctly. 

test_dbf.asp, line 11
```

我很确定**“taspat_ka_jawa”**已经在**“D:\digimap”中**

* * *

**解决**
了我对 OleDB Provider 使用 Advantage ADO，它工作正常，我现在可以查看/编辑/删除记录
[http://www.sybase.com/products/databasemanagement/advantagedatabaseserver/ole-db-provider](http://www.sybase.com/products/databasemanagement/advantagedatabaseserver/ole-db-provider)

谢谢，德尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T10:10:16.693

这两者一起可能会有所帮助：

[http://www.tek-tips.com/viewthread.cfm?qid=987761&page=6](http://www.tek-tips.com/viewthread.cfm?qid=987761&page=6)

[http://www.carlprothman.net/Default.aspx?tabid=87](http://www.carlprothman.net/Default.aspx?tabid=87)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T10:14:55.013

您可以试试[Microsoft Visual Foxpro Ole Db Provider](http://www.microsoft.com/downloads/details.aspx?familyid=E1A87D8F-2D58-491F-A0FA-95A3289C5FD4&displaylang=en)。VFP（在一定程度上）与 dBase 文件兼容。

# c - ANTLR生成的语法文件如何使用？

> ID：637338
> 
> 赞同：5
> 
> 时间：2009-03-12T04:16:53.720
> 
> 标签：c, antlr

我认为这是一个愚蠢的问题，但我刚刚开始使用 ANTLR。我将他们教程中的“SimpleCalc”语法放在一起，并以 C 作为目标语言生成它。我得到了 SimpleCalcParser.c/.h 和 SimpleCalcLexer.c/.h 作为输出，我能够编译它们并成功构建。但是现在，我如何实际使用生成的代码？我无法在文档中找到任何有用的内容。

下面是我的 main() 函数。这也来自教程。

```
 #include "SimpleCalcLexer.h"

 int main(int argc, char * argv[])
 {

    pANTLR3_INPUT_STREAM           input;
    pSimpleCalcLexer               lex;
    pANTLR3_COMMON_TOKEN_STREAM    tokens;
    pSimpleCalcParser              parser;

    input  = antlr3AsciiFileStreamNew          ((pANTLR3_UINT8)argv[1]);
    lex    = SimpleCalcLexerNew                (input);
    tokens = antlr3CommonTokenStreamSourceNew  (ANTLR3_SIZE_HINT, TOKENSOURCE(lex));
    parser = SimpleCalcParserNew               (tokens);

    parser  ->expr(parser);

    // Must manually clean up
    //
    parser ->free(parser);
    tokens ->free(tokens);
    lex    ->free(lex);
    input  ->close(input);

    return 0;
 } 
```

编辑：根据第一个响应，我应该说我这样运行程序：“./testantlr test.txt”，其中 test.txt 包含“4+1”。没有输出。

例如，从这里，我将如何访问生成的语法树中的“4”，或者打印出整个语法树？基本上，我如何访问 ANTLR 生成的语法树中的内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-01T01:37:23.223

当我第一次尝试它时，我面临着同样的困惑。这是一个非常明显的问题/问题，这使得在教程中似乎没有明确和直接地解决它变得更加奇怪。

我发现的困惑的出路是'returns'关键字：

```
token returns [TreeNode value]
    :    WORD { $value = new TreeNode( "word", $WORD.Text ); }
    |    INT { $value = new TreeNode( "int", $INT.Text ); }
    ;

WORD:    ('a'..'z'|'A'..'Z')+;
INT :    ('0'..'9')+; 
```

TreeNode 是我创建的一个类。棘手的地方是如何使用一系列比如说多个令牌来做到这一点。我想出的解决方案是递归：

```
expr returns [Accumulator value]
    :   a=token  (WS+ b=expr)?
    {
        if( b != null )
        {
            $value = new Accumulator( "expr", a.value, b.value );
        } else
        {
            $value = new Accumulator( "expr", a.value );
        }
    }
    ; 
```

Accumulator 是我创建的一个类，它有两个不同的构造函数。一个构造函数封装单个令牌，另一个封装单个令牌和另一个 Accumulator 实例。请注意，规则本身是递归定义的，它`b.value`是一个 Accumulator 实例。为什么？因为 b 是一个 expr，而 expr 的定义有`returns [Accumulator value]`.

最终生成的树是单个 Accumulator 实例，它已将所有令牌分组。要实际使用该树，您需要进行一些设置，然后调用与您正在解析内容的规则同名的方法：

```
Antlr.Runtime.ANTLRStringStream stringstream =  new Antlr.Runtime.ANTLRStringStream( script );
TokenLexer lexer = new TokenLexer( stringstream );
Antlr.Runtime.CommonTokenStream tokenstream = new Antlr.Runtime.CommonTokenStream( lexer );
TokenParser parser = new TokenParser( tokenstream );

Accumulator grandtree = parser.expr().value; 
```

希望这对遇到这种困惑的人有所帮助。

* * *

## 更新

由于系统允许您在看似任意的模式位置散布目标语言代码，因此有一种更直接的方法可以将项目收集到列表中。成语是：

```
sequence returns [String k]
    :   (e=atom { $k = $e.k; })
        (e=atom { $k += ", " + $e.k; })*
        { $k = "sequence (" + $k + ")"; } ; 
```

一个字符串`k`被初始化为第一个原子的 k 值，随后的原子`+=`得到`k`. 该片段`$e.k`是指在`atom returns [String k]`别处定义的规则。如果没有这样的规则，您可以使用该`text`属性（即`$e.text`，哪些令牌具有。我不确定非令牌是否具有此属性。如果没有，您可以这样做：

```
nonToken returns [String whatever] : e=TOKEN { $whatever = $e.text; } ; 
```

然后您将在更高的规则中使用它，例如

```
e=nonToken { System.out.println($e.whatever); } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T04:24:36.337

所以当你运行这个程序时，你在这里给出的第一个命令行参数将是要解析的文件的名称。

第一步，尝试（运行它并给它一个文件）。

第二步，回来编辑你的问题，但稍微改变方向。与其问“我如何使用代码”，不如问“我该怎么做`__________`”，其中空白被您尝试完成的一些描述所取代。

所以`parser->expr(parser)`似乎正在解析来自您的文件的令牌流，这应该会产生一个 AST。通过很多细节猜测我的方式，我建议看看它返回什么，特别是。`value`成员（如果有的话）。网上似乎有很多教程看起来与您正在做的事情相似，没有两个相同。

如果一切都失败了，请继续学习本教程，或者 1）它会回答你的问题，或者 2）它不会，你可以尝试另一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-25T10:15:39.830

看看 Scott Stanchfield 的第 8 部分视频[http://vimeo.com/groups/29150/videos/8377479](http://vimeo.com/groups/29150/videos/8377479)。他是用 Java 做的，但同样的原理也可以用在 C(++) 中。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-12T04:32:44.930

我并不是要粗鲁，但您似乎并不真正知道 ANTLR 的目的是什么。我认为您需要先了解这一点，然后才能尝试使用它生成的文件。

非常简短的回答是 ANTLR 是一个解析器生成器，这意味着它会生成代码来解析文本。一种常见的用法是解析编程语言的文本。我还没有阅读你所指的教程，但我猜这个解析器解析的文本是一组计算器指令，比如

```
ADD 2 4
MULTIPLY 4 8 
```

为了使用上面显示的程序，您可以像执行任何其他 C 程序一样执行它。第一个参数 (argc) 应该是参数的数量，第二个 (argv) 应该是要解析的文本。

为了从头开始学习 ANTLR，我建议你阅读ANTLR 的作者 Terence Parr 出版[的书。](https://rads.stackoverflow.com/amzn/click/com/0978739256)

# email - 从 asp.net 页面发送电子邮件的最佳方式是什么？

> ID：637345
> 
> 赞同：2
> 
> 时间：2009-03-12T04:21:17.967
> 
> 标签：email, sendmail

从 asp.net 页面发送电子邮件的最佳方式是什么？

我不是指实际发送消息的代码，我的意思是，例如，在我的应用程序中，丢失的密码链接会在单击按钮时向用户发送一封电子邮件，但如果 smtp 服务器需要 10 秒来发送消息，用户将等待页面加载 10 秒。

你会建议什么来避免这种情况？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T04:36:57.400

asynch send 不会在 asp.net 工作线程上工作（尝试一下 - 它会引发异常），因此要么生成辅助线程，在弹出窗口中发送电子邮件，要么让用户等待。

真的需要10秒吗？我从来没有见过它需要超过1...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T04:27:34.270

我从来没有这样做过，但是在我的脑海中，我建议开发一个与您的网站分开的后台进程。此过程扫描数据库表以查找电子邮件地址；每当找到新地址时，它都会向该地址发送一封确认电子邮件，然后将其从列表中删除。

同时，每当用户提交您的 ASP.NET 表单时，他们的电子邮件都会添加到同一个数据库表中。

因此，您已取消同步电子邮件发送。

有关创建后台进程的一些一般信息：

[http://www.codeproject.com/KB/cs/tsnewlib.aspx](http://www.codeproject.com/KB/cs/tsnewlib.aspx)

[http://forums.asp.net/t/1134253.aspx](http://forums.asp.net/t/1134253.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T04:29:15.657

通过对 Web 服务的 Ajax 调用调用电子邮件发送。或者，您可以在 SmtpClient 类上使用[异步发送方法](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.sendasync.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T04:33:37.580

在单独的线程或进程中处理电子邮件和其他长时间运行的进程是很常见的。使用消息队列系统或常规后台批处理类型进程非常容易设置。

话虽如此，我认为您还应该考虑 ckramer 提到的异步方法。

另一种选择是拥有一个本地 SMTP 服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T04:48:09.010

为所有外发邮件创建一个数据库并在另一个线程中处理它。

# emacs - Emacs：如何在没有杀环的情况下删除文本？

> ID：637351
> 
> 赞同：86
> 
> 时间：2009-03-12T04:24:17.040
> 
> 标签：emacs

我只想删除一些文本，这样我就可以拉出一些其他文本**来代替**它。我怎样才能做到这一点？Cw 剪切选定的文本以杀死环，我最终没有想要拉出的文本。

此外，是否可以直接拉文本**而不是**某些文本，甚至无需按下按钮来杀死它？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-12T06:07:53.810

I type `M-x delete-region` quite often, but you can bind it it to a key.

With [Delete Selection Mode](https://www.gnu.org/software/emacs/manual/html_node/emacs/Using-Region.html) in newer versions of Emacs you don't have to type a command just start typing:

> By default, text insertion occurs normally even if the mark is active—for example, typing a inserts the character ‘a’, then deactivates the mark. Delete Selection mode, a minor mode, modifies this behavior: if you enable that mode, then inserting text while the mark is active causes the text in the region to be deleted first. Also, commands that normally delete just one character, such as `C-d` or `DEL`, will delete the entire region instead. To toggle Delete Selection mode on or off, type `M-x delete-selection-mode.`

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-03-12T04:27:53.770

您可以使用`M-y`after`C-y`从 kill ring 插入上一个项目，或使用[browse-kill-ring](http://www.emacswiki.org/emacs/BrowseKillRing)包。

至于第二个问题，请参见[DeleteSelectionMode](http://www.emacswiki.org/emacs/DeleteSelectionMode)。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-01-16T23:26:53.853

我有同样的问题。到目前为止，我所做的最接近的事情就是制作一个本质上是这样的小功能：

```
(defun ruthlessly-kill-line ()
  "Deletes a line, but does not put it in the kill-ring. (kinda)"
  (interactive)
  (move-beginning-of-line 1)
  (kill-line 1)
  (setq kill-ring (cdr kill-ring))) 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-02-14T13:43:48.463

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-11-08T01:10:19.353

Mx eval-expression (setq kill-ring (cdr kill-ring)) - 从 kill-ring 中删除最后一项

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-12T07:58:41.923

对于第二个问题，除了[DeleteSelectionMode](http://www.emacswiki.org/emacs/DeleteSelectionMode)，您还可以启用[CUA 模式](http://www.emacswiki.org/emacs/CuaMode)，它还为您提供了一个由 C-Return 启用的漂亮的矩形选择模式。CUA 模式是自 22.1 以来 emacs 的一部分。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-12-22T20:13:32.363

大多数 kill 函数用于`kill-region`执行删除文本的实际工作。我使用 lisp 宏从 kill 函数中创建删除函数。

```
(defmacro jpk/delete-instead-of-kill (&rest body)
  "Replaces `kill-region' with `delete-region' in BODY."
  `(cl-letf (((symbol-function 'kill-region)
              (lambda (beg end &optional yank-handler)
                (delete-region beg end))))
     ,@body))

(defun jpk/delete-word (arg)
  "Like `kill-word', but does not save to the `kill-ring'."
  (interactive "*p")
  (jpk/delete-instead-of-kill (kill-word arg))) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-06-11T12:22:06.967

找到了这个问题的答案。

先发[到这里](https://unix.stackexchange.com/questions/26360/emacs-deleting-a-line-without-sending-it-to-the-kill-ring/136581#136581)。

```
;; Ctrl-K with no kill
(defun delete-line-no-kill ()
  (interactive)
  (delete-region
   (point)
   (save-excursion (move-end-of-line 1) (point)))
 (delete-char 1)
)
(global-set-key (kbd "C-k") 'delete-line-no-kill) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-10-20T16:22:38.910

## 从技术上讲，第一部分的其他答案是错误的。

这是我的实施和动机：

```
(defun delete-word (arg)
  "Delete characters backward until encountering the beginning of a word.
With argument ARG, do this that many times."
  (interactive "p")
  (delete-region (point) (progn (backward-word arg) (point)))) 
```

`kill-word`我从“ ”中改编了这里的代码`simple.el`。`kill-region`我用`delete-region`和`forward-word`for切换`backward-word`。这样它真的不会影响`kill-ring`，不像其他情况，在 emacs 之外，我注意到受到了`kill-ring`影响。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-10-07T13:03:01.157

添加相当于 kill-region 和 kill-line 键 Cw 和 Ck 的删除，如下所示。绑定到键 Cv 和 Cz。

```
;; 与 delete-region 的键绑定提供了一个很好的“Windows CUT Ctrl-x 等效项”。
;; 使用什么键绑定很难选择。
;; 使用 Cv "Windows PASTE Ctrl-v" 是一个相当具有颠覆性的选择。
;; Cv = 在我没用的 emacs 中向上滚动。
(global-set-key (kbd "Cv") 'delete-region)

;; 要拥有 Ck（kill-line）的“Windows CUT”替代品，可以这样做：
(defun delete-line () "删除行，从kill ring中取出。将此函数绑定到Cz"
 （交互的）
 (setq last-command '删除行)
 （杀线）
 （setq 杀环（cdr 杀环））
 (setq kill-ring-yank-pointer kill-ring)
 (setq last-command '删除行)
)
(global-set-key (kbd "Cz") '删除行)
;; 没有设置最后一个命令 2+ C-zs mess up kill-ring

```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-07-10T03:05:09.973

我对第一个问题的回答：在 emacs 中标记文本（使用鼠标或设置 mark `C-SPC`），然后按键盘上的“<- Backspace”按钮而不是`C-w`. 这样，您仍然可以在系统剪贴板中粘贴文本，而不必担心剪贴板被被杀死的文本覆盖`C-w`

这个答案的背景：有时当我在 emacs 之外获得想要用来替换 emacs 中的区域的文本时，我经常犯错误，首先将该文本复制到系统剪贴板（即在 Windows 上`Ctrl + C`），然后`C-w`在 emacs 中执行“删除”我要替换的文本区域，希望以后`M-w`可以从 kill-ring 中恢复剪贴板中的文本。不幸的是，剪贴板将被 杀死的文本简单地覆盖，`C-w`剪贴板中的原始消息永远不会显示在 kill-ring 中。

对于第二个问题，是的，您始终可以先在 emacs 中标记文本，然后再直接标记`C-y`

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-12-27T16:24:28.313

```
(defun copy-to-register-z (p1 p2)
  "Copy text selection to register named “z”."
  (interactive "r")
  (copy-to-register ?z p1 p2))
(defun replace-register-content-z (p1 p2)
  "Replace register named “z”'s content."
  (interactive "r")
  (delete-region p1 p2)
  (insert-register ?z))
(global-set-key (kbd "C-c c") 'copy-to-register-z)
(global-set-key (kbd "C-c v") 'replace-register-content-z) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-12-02T00:09:15.380

作为所有答案的补充。如果你编写 elisp 代码来删除，你可以调用 kill 的函数，只要你使用一个本地的 kill-ring 对象，如下所示：

```
(defun delete-something()
  "Delete something without storing in kill ring."
  (let (kill-ring)
     (kill-something))) 
```

使用任何杀死某些东西的函数来代替 kill-something。然后该功能将被删除，并且在真正的杀戮环中不会记住任何内容。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-06-04T16:06:46.070

这是一个`kill-region`不强制值进入杀戮环的版本。

```
(defun kill-or-delete-region (beg end prefix)
  "Delete the region, storing it in the kill-ring.
If a prefix argument is given, don't change the kill-ring."
  (interactive "r\nP")
  (if prefix
      (delete-region beg end)
    (kill-region beg end)))

(global-set-key (kbd "C-w") 'kill-or-delete-region) 
```

这使您可以`C-w`像以前一样执行此操作，但`C-u C-w`现在删除文本而不更改 kill-ring。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-02-27T15:01:21.470

> 如何在没有杀环的情况下删除文本？

该`delete-region`功能将删除所选区域而不将其添加到杀伤环

> 此外，是否可以直接拉文本而不是某些文本，甚至无需按下按钮来杀死它？

我想你是在问如何用你已经放在杀戮环上的东西替换选定区域中的文本。

设置`(delete-selection-mode 1)`将允许您在选定区域上拉/粘贴。它还允许您只键入和替换选定的区域。

在 OS XI 上的版本 25.1.1 上，还必须添加`(setq select-enable-primary nil)`以防止其将选定区域复制到杀伤环

# c# - C# 中带有 TreeNode 的用户对象

> ID：637355
> 
> 赞同：3
> 
> 时间：2009-03-12T04:25:59.657
> 
> 标签：c#, treenode, user-object

我可以将用户对象绑定到 C# 中的 TreeNode 吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-12T04:29:34.530

是的。您可以使用 Tag 属性来存储特定树节点的任何用户对象。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.treenode.tag.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.treenode.tag.aspx)

```
TreeNode node = CreateATreeNode();
node.Tag = myStateObject; 
```

# javascript - DOM元素宽度可以是非整数吗？

> ID：637358
> 
> 赞同：9
> 
> 时间：2009-03-12T04:27:28.093
> 
> 标签：javascript, firefox, dom, width, offsetwidth

我有一个页面，其 div 元素由 JavaScript 对齐。JavaScript 只需检查一组 div 元素以找到最大***offsetWidth***，然后将所有 div 元素的***宽度***设置为最大***offsetWidth***。它在大多数浏览器和语言环境中都能完美运行，但在 Mac 上的 Firefox 中的法语 - 法国失败。在这种情况下， div 的内容会换行。

```
<div id="divFoo">
    Heure de d&#233;but :
</div> 
```

对于上面的 HTML，下面的代码报告“79”。

```
javascript:alert(document.getElementById('divFoo').offsetWidth); 
```

但在代码下方报告“79.1333px”。

```
javascript:alert(window.getComputedStyle(document.getElementById('divFoo'),null).width)) 
```

79.1333 和 79 之间的间隙使不正确的***宽度***设置为内联样式。

我曾经认为***offsetWidth***和***width***应该总是整数。有什么方法可以正确地使***offsetWidth 变***圆吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-12T06:43:40.980

`getComputedStyle()`CSS 样式规则（或 Renzo Kooi`getStyle()`会给你的）和由用户代理确定的以像素为单位的实际计算宽度之间存在差异。

这部分是因为部分像素值在 CSS 中是可能的，但是用户代理必须选择如何渲染部分像素（目前，我相信它们都是向上或向下舍入的，但非常不一致，特别是在将百分比转换为像素时[见[这里](http://ejohn.org/blog/sub-pixel-problems-in-css/)]）。

存在这些差异很重要，尤其是当用户代理实现全页缩放时。

例如，我用这个做了一个测试用例：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Fractional pixels</title>
    <style type="text/css" media="screen">
        #fractional {
            width: 17.5px;
            height: 16.1333px;
            background: red;
        }
    </style>
</head>
<body>
    <div id="fractional"></div>
</body>
</html> 
```

在 Safari 4 Beta 中放大一级，CSS 宽度报告为 17.5px，高度为 16.1333px。但它`offsetWidth`是 21 个设备像素，它`offsetHeight`是 19 个设备像素。

简而言之，这个故事的寓意是，如果你想匹配一个元素的实际尺寸，最好按原样使用它的 CSS 值，即使它们不是整数。

# imagemagick - 为模块 Image::Magick 加载 Magick.dll 时出现问题？

> ID：637369
> 
> 赞同：1
> 
> 时间：2009-03-12T04:31:57.053
> 
> 标签：imagemagick

海我在我的系统中安装了 perl 5.10 和之后的 ImageMagick。在运行 imageMagick 的演示文件夹中存在的 pl 文件时，它是这样说的

Can't load 'C:/Perl/site/lib/auto/Image/Magick/Magi... for module Image::Magick: load_file: 由于应用程序配置不正确，此应用程序无法启动。重新安装应用程序可能会在 C:/Perl/lib/DynaLoader.pm 第 202 行修复此问题。

perl/lib/DynaLoader.pm 中的文档指出：

> # 许多动态扩展加载问题似乎来自 # 这部分代码：XYZ 在 DynaLoader.pm 的第 123 行失败。# 通常这些错误实际上发生在扩展 XS 文件的初始化 # C 代码中。Perl 在此 perl 代码中将错误报告为 # 只是因为这是它执行的最后一个 perl 代码。

我该如何解决这个问题，谁能建议我加载 Magick.dll 文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-09T21:03:28.117

我有完全相同的问题......几乎把我的头发拉到它上面。

> 无法为模块 Image::Magick 加载“C:/Perl/site/lib/auto/Image/Magick/Magick.dll”

然后我想起了我们在 wiki 中的一个注释，果然——我在[ImageMagick 网站](https://www.imagemagick.org/script/download.php#windows)上找到了答案：

> 如果您有任何问题，请安装 Visual C++ 2008 Redistributable Package (x86) 或 Visual C++ 2008 Redistributable Package (x64)。64 位 Windows 需要这两个软件包（x86 和 x64）。

安装了 vcredist_x86.exe，一切都很好。:::呸！:::

# c++ - C/C++ 的选项解析器？

> ID：637371
> 
> 赞同：13
> 
> 时间：2009-03-12T04:32:14.213
> 
> 标签：c++, c, command-line-arguments

我做了一些查找，有很多用于命令行选项解析的库，但是很难区分它们。有没有人有任何经验？一个比其他任何一个更难/更好/更快/更容易/无论如何？还是我应该自己种？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-12T05:06:08.000

如果你想要完全跨平台的东西，我发现[Boost::Program_Options](http://www.boost.org/doc/libs/1_37_0/doc/html/program_options.html)库非常好。设置它有一些学习曲线，但一旦你掌握了它，它就会大大简化事情。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-12T04:49:16.217

出于许多目的，GNU`getopt()`和`getopt_long()`函数都是不错的选择。

GNU`getopt()`用于单字母选项参数，并且非常接近 POSIX 标准行为，并且可以通过设置环境变量 POSIXLY_CORRECT 来说服其行为更加正统。不同之处在于 GNU`getopt()`在第一个非选项参数之后识别选项参数，并对参数进行置换，以便在任何非选项参数之前处理所有选项参数。这有时很重要——尽管上下文往往有点深奥。还有一些其他额外的技巧可用。

GNU`getopt_long()`是处理长选项的最佳机制，例如`--help`. 它可以处理可选参数、匹配单字母选项和各种事情。

还有许多其他可用的包以各种方式处理选项。

（Perl 有大量的 Getopt 模块，这反映了这些年来付出了多少努力。）

[您可能会在什么是 Unix shell 命令的一般语法中](https://stackoverflow.com/questions/2160083/what-is-the-general-syntax-of-a-unix-shell-command)找到一些有用的额外信息。您还可以在[实用程序约定](http://www.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html)一章中阅读有关命令行约定的 POSIX 规范。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-12T05:10:05.103

[boost::program_options](http://www.boost.org/doc/libs/1_38_0/doc/html/program_options.html)非常好，并且有一个很好的 C++ 接口，可以检查选项参数是否具有某种类型（如“int”）并将它们直接存储到变量中。

它还支持从配置文件加载“选项”，因此您可以免费获得配置文件解析器。通过这种方式，您可以非常轻松地允许从命令行覆盖所有配置设置或将所有命令行选项添加到配置文件中，这使得它非常灵活。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T09:58:20.060

还有popt。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T04:36:43.033

如果您使用的是 linux/unix，那么**getopt**是适合您的选项解析器。适用于几乎所有类型的 unix，并且易于使用

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-12T05:07:35.017

对于大多数事情，我使用 getopt_long() 的系统实现，但是您可能需要更便携，这禁止使用这种 POSIX 生物舒适。

如果您处于 getopt() / getopt_long() 不可用并且需要自己滚动的位置，[这里是关于命令行选项的 POSIX 视图的标准。](http://www.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap12.html)您可能还想看看 POSIX 对帮助/选项摘要显示的看法（我找不到指向该标准部分的链接）。

就个人而言，我不喜欢使用不带 --long-options 的程序，因为记住短选项很痛苦，而且没有两个程序使用相同的选项。

# asp.net - ASP.NET 数据表组件

> ID：637374
> 
> 赞同：2
> 
> 时间：2009-03-12T04:32:53.883
> 
> 标签：asp.net, sharepoint

我需要像 Microsoft SharePoint 数据表视图中的数据编辑功能（用户可以添加/编辑类似 Excel 的记录，支持复制和粘贴操作）。我了解 SharePoint 使用 ActiveX 来执行此操作，但是：

*   我可以使用任何商业/免费组件吗？
*   有什么方法可以在我的项目中重复使用 SharePoint ActiveX？

# visual-studio - VS 代码执行不同于代码文件

> ID：637377
> 
> 赞同：2
> 
> 时间：2009-03-12T04:33:56.313
> 
> 标签：visual-studio, debugging, execution

有没有人在 Visual Studio 中调试过，它似乎执行的代码与正在逐步执行的代码不同？有时它甚至会进入正在被单步执行的文件中看似空白的地方，但 VS 无论如何都在执行某些东西？

我已经发生过几次这种情况，一旦有人让我清除用户目录下的应用程序数据目录中的某些内容。但是我不记得那是什么，想知道是否有人有一些想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T05:02:12.957

有四个最可能的原因。

原因1：您实际上启动的不是编译结果，而是其他一些文件。要启动的可执行文件的路径在项目属性的“调试”页面上设置。

原因2：你有优化。在这种情况下，编译器只保存代码行 - 为某些代码而不是其他代码编译代码信息。您会看到，在您按下“跳过”后，您实际上会向前跳转多个语句，或者您无法访问某些变量值。关闭优化或从交互式调试切换到日志记录。

原因 3：程序数据库（存储代码行与编译代码绑定的 .pdb 文件）与编译文件不同步。“重建”项目通常会有所帮助。

原因4：可执行文件所在文件夹中的程序数据库（见原因3）已过期，因为VS在每次编译时将程序数据库放在其他位置）。放置 .pdb 文件的路径在项目的链接器属性中设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T04:58:32.170

如果您的代码正在优化（项目属性、构建、“优化代码”），那么正在运行的代码不一定与 IDE 中的代码匹配。这通常是由于尝试调试发布版本引起的。但是，在某些情况下并非如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T06:34:12.843

您是否将调试器附加到正在运行的程序中？如果是这样，则可能是您对源文件进行了更改，但忘记了编译代码。我偶尔会这样做，尽管它很容易被发现。

# windows - windows shell环境变量的快速交换

> ID：637379
> 
> 赞同：1
> 
> 时间：2009-03-12T04:34:08.373
> 
> 标签：windows, batch-file, environment-variables

不是 Windows VBS 编写器（但 Windows shell 的用户）我使用多个不同版本的第三方代码，这需要我设置 Windows shell 环境变量，特别是这些与 Java 相关

看着下面的[问题](https://stackoverflow.com/questions/171588/is-there-a-command-to-refresh-environment-variables-from-the-command-prompt-in-wi)，我开始思考我需要做些什么来使用单个命令快速更改 shell 环境变量。例如：

在模式 A 我有

```
ANT_HOME=c:\foo\bar\ant-1.5.1
JAVA_HOME=c:\foo\java\1.4
PATH=c:\foo\java\1.4\bin;c:\foo\bar\ant-1.5.1\bin 
```

在模式 B 中开发其他东西，我希望快速切换到以下内容（同时在此过程中剔除上述内容的 PATH 设置）

```
ANT_HOME=c:\foo\bar\ant-1.6.1
JAVA_HOME=c:\foo\java\1.6
PATH=c:\foo\java\1.6\bin;c:\foo\bar\ant-1.6.1\bin 
```

为了在引用的问题中增加脚本，我猜想使用 Split 命令等进行一些路径处理是必要的。有没有人已经做过类似的事情，他们愿意分享？

我显然不能只杀死整个 PATH，因为 PATH 中还有许多其他我想保留的项目被使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T11:24:36.530

基于 thaggie 的回答，您可以将`ANT_HOME`和`JAVA_HOME`路径作为参数传递给您的脚本：

```
C:> MyScript c:\foo\java\1.4 c:\foo\bar\ant-1.5.1 
```

这样您就不需要`.bat`为每个“模式”管理脚本。

然后在您的脚本中使用路径中的参数：

```
:: Not needed, but makes it clearer which argument is the Ant path 
:: and which is the Java path.
set JAVA_HOME=%1
set ANT_HOME=%2

:: If you want to preserve the current path and just append the Ant and
:: Java paths:
set PATH=%path%;%JAVA_HOME%;%ANT_HOME%

:: If you want the path to just be the Ant and Java paths:
set PATH=%JAVA_HOME%;%ANT_HOME% 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T04:43:22.813

在路径中使用 ANT_HOME 和 JAVA_HOME 变量：

```
PATH=%JAVA_HOME%\bin;%ANT_HOME%\bin 
```

在路径中有一个批处理文件，用于在 2 个上下文之间进行交换

modea.bat：

```
set ANT_HOME=c:\foo\bar\ant-1.5.1
set JAVA_HOME=c:\foo\java\1.4 
```

模式.bat：

```
set ANT_HOME=c:\foo\bar\ant-1.6.1
set JAVA_HOME=c:\foo\java\1.6 
```

# c# - nHibernate (w/ Castle ActiveRecord) 与 C# 接口 (esp for DTO's)

> ID：637380
> 
> 赞同：3
> 
> 时间：2009-03-12T04:34:58.183
> 
> 标签：c#, asp.net, nhibernate, castle-activerecord, dto

是否将 nHibernate 与从通用接口实现的域对象和 DTO 对象一起使用？我试图将我所有的 nHibernate 属性分离到 Domain 对象中，让我的 DTO 和界面保持干净。

当 nHibernate 尝试将接口与具体类相关联时，会出现问题。

**NHibernate.MappingException：关联引用未映射的类：IContact**

我理解为什么它抱怨使用非休眠界面，但我正在努力寻找一种围绕它进行重组的方法。我的代码的骨架复制如下所示，关于如何更好地构建我的代码的任何想法？

```
public interface ICompany
{
    IList<IContact> Contacts { get; set; }
}

public class CompanyDTO : ICompany
{
    private IList<IContact> contacts;
    public IList<IContact> Contacts { get { return this.contacts; } set { this.contacts = value; } }

}

[ActiveRecord]
public class Company : ActiveRecordBase<Company>, ICompany
{
    private IList<IContact> contacts;
    [HasMany(Inverse=true, Table="Contact", ColumnKey="CompanyId")] 
    [ScriptIgnore]
    public IList<IContact> Contacts { get { return this.contacts; } set { this.contacts = value; } }
} 
```

编辑：

我想要一个通用接口，这样我就可以确保它们保持相同的字段（即依靠编译器来保持它们的一致性）。它还允许我在应用程序的视图部分中使用 DTO，但将它们转换为域对象以进行业务和数据访问。此外，alex 的解决方案不起作用，因为 ICompany 的联系人是 IList 类型，而不是 IList。我想将其保留为 IContact，因此我的 DTO 对象不知道 Contact Domain 对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T15:00:28.307

在您的具体情况下，您应该只添加`Type = typeof(Contact)`到映射属性，如下所示：

```
[HasMany(Inverse=true, Table="Contact", ColumnKey="CompanyId", Type=typeof(Contact))] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T05:33:00.587

那么在您的域中，您不能使用 IContract 来引用您的域实体，而是使用 Concrete 类。如果您想更正您的版本，只需使用以下命令：

```
[ActiveRecord]
public class Company : ActiveRecordBase<Company>
{
    private IList<Contact> contacts;
    [HasMany(Inverse=true, Table="Contact", ColumnKey="CompanyId")] 
    [ScriptIgnore]
    public IList<Contact> Contacts { get { return this.contacts; } set { this.contacts = value; } }
} 
```

我看不出连接您的域和 DTO 的意义。它们是耦合的，并且它们可以具有不同的信息。例如，您可以将一些信息很好地封装到您的域中，而只传达很少的其他信息。DTO 用于传输您想要与上层共享的数据。

您可以使用 Base 类来定义您的实体和您的 ValueObject。简而言之 Entity : DomainEntity 是 ID 能够意味着它们可以被持久化。ValueObject = DTO 不能被持久化（不能识别）

再看Sharp-Arch的核心设计：

*   /BaseObject.cs：提供基本的对象比较服务。
*   /Entity.cs：提供具有域签名和可键入 ID 属性的对象。这也有 NHibernate Validator 的验证支持。从 Entity 扩展的对象必须至少有一个 [DomainSignature] 属性；如果违反，它将抛出一个按合同设计的异常。接口 IEntityWithTypedID 允许您自己滚动。
*   /ValueObject.cs：这是一个值对象，其中与另一个值对象相比，它的所有属性都被使用。从 ValueObject 扩展的对象可能没有任何 [DomainSignature] 属性；如果违反，它将抛出一个按合同设计的异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-12T16:15:19.020

如果我有 [HasMany] 属性，我该怎么办？它实际上没有属性名称“类型”，但 [Property] 和 [BelongsTo] 有。

**更新**

答案是使用`CollectionType = typeof(YourType)`

**更新 2**

不，它不起作用，此属性是为集合类型设置的，即 List 等。尝试设置 [HasMany(typeof(meType), ...)] 但仍然不起作用。

# c# - 检查 .NET 中的垃圾收集？

> ID：637381
> 
> 赞同：8
> 
> 时间：2009-03-12T04:35:50.600
> 
> 标签：c#, .net, unit-testing, garbage-collection

有没有办法检查对象是否被 .NET 中的垃圾收集器收集？

我正在尝试编写一个 API 来挂钩传入的对象的某些事件，并且我需要确保我不使用对对象的强引用。我知道该怎么做，但我也想写一个单元测试来验证这一点，我不知道该怎么做。

# java - 如何将windows程序嵌入java applet？

> ID：637385
> 
> 赞同：1
> 
> 时间：2009-03-12T04:36:52.423
> 
> 标签：java, applet

我如何将正在运行的 Windows 程序嵌入到 Java 小程序中，如记事本、mspaint 等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T04:47:55.173

我不认为你可以。Java 的基本原则之一是安全性，如果您能够嵌入像记事本这样无害的 Windows 程序，那么如何阻止其他人在小程序中嵌入某种病毒？

更不用说，独立程序并不能真正嵌入任何东西。您需要有某种可嵌入的小部件 - 例如 Excel（这就是您可以在 MS Word 文档中获取电子表格框的方式），但并非适用于所有程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T04:59:36.270

您可能可以使用已签名的小程序执行某些操作……但您将无法让该应用程序显示在远程计算机上。

如果你只是想让它在本地使用，你可能会说服一个小程序启动记事本（我从来没有想过做这样的事情，但如果小程序已签名，它就在沙箱之外，所以我看不出你为什么不能)，但它将在本地计算机上的新窗口中启动。

您可以查看用于 Java-COM 集成的[JACOB ，如果它仅在本地计算机上，它](http://danadler.com/jacob/)*可能会*执行您想要的操作。您仍然需要一个签名的小程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T04:48:33.143

你不能，小程序是沙盒的，你不能像其他程序一样调用任何外部的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-20T20:04:11.473

也许可以这样做：

1.  真正的 Windows 程序，在带有 VNC 服务器的真正 Windows 机器上运行
2.  [TightVNC 客户端的小程序版本](http://www.tightvnc.com/ssh-java-vnc-viewer.php)

显然，这将最适合在公司 Intranet 上运行（OP 没有指定它将在哪里使用。）

# python - 标准错误的python的默认编码？

> ID：637396
> 
> 赞同：7
> 
> 时间：2009-03-12T04:45:51.963
> 
> 标签：python, bash, shell, unicode

我有一个嘈杂的 python 脚本，我想通过将其 stderr 输出定向到 /dev/null （使用 bash BTW）来使其静音。

像这样：

```
python -u parse.py  1> /tmp/output3.txt 2> /dev/null 
```

但它很快就会过早退出。唔。我看不到回溯，因为标准错误当然会消失。如果我不将 stderr 指向某个地方，它会嘈杂且正常地运行。

因此，让我们尝试将其重定向到某个文件而不是 /dev/null，然后看看它输出了什么：

```
python -u parse.py  1> /tmp/output3.txt 2> /tmp/foo || tail /tmp/foo

Traceback (most recent call last):
  File "parse.py", line 79, in <module>
    parseit('pages-articles.xml')
  File "parse.py", line 33, in parseit
    print >>sys.stderr, "bad page title", page_title
UnicodeEncodeError: 'ascii' codec can't encode characters in position 0-1: ordinal not in range(128) 
```

因此，正在生成的 stderr 包含 utf8，并且由于某种原因，python 在重定向时拒绝打印非 ascii，即使它被定向到 /dev/null（当然 python 不知道这一点）。

python - 即使python脚本包含utf8，如何使stderr静音？有什么方法可以做到这一点，而无需在此脚本中将每个打印内容都重新写入 stderr？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T14:22:25.213

您可以通过将 stderr 绑定到自定义编写器来使其静音：

```
#!/usr/bin/env python
import codecs, sys

class NullWriter:
    def write(self, *args, **kwargs):
        pass

if len(sys.argv) == 2:
   if sys.argv[1] == '1':
      sys.stderr = NullWriter()
   elif sys.argv[1] == '2':
      #NOTE: sys.stderr.encoding is *read-only* 
      #      therefore the whole stderr should be replaced
      # encode all output using 'utf8'
      sys.stderr = codecs.getwriter('utf8')(sys.stderr)

print >>sys.stderr, u"\u20AC" # euro sign
print "ok" 
```

例子：

```
$ python silence_stderr.py
Traceback (most recent call last):
  File "silence_stderr.py", line 11, in <module>
    print >>sys.stderr, u"\u20AC"
UnicodeEncodeError: 'ascii' codec can't encode character u'\u20ac' in position 0: ordinal not in range(128) 
```

沉默的标准错误：

```
$ python silence_stderr.py 1
ok 
```

编码标准错误：

```
$ python silence_stderr.py 2
€
ok 
```

**注意**：我在 emacs 中有上述输出，因此可以在终端中模拟它：

```
$ python ... 2>out.txt
$ cat out.txt 
```

**注意**：在 Windows 控制台内（在`chcp 65001`切换到 'utf-8' 并使用 truetype 字体（`Lucida Console`）之后）我得到了奇怪的结果：

```
C:\> python silence_stderr.py 2
Traceback (most recent call last):
  File "silence_stderr.py", line 14, in <module>
    print >>sys.stderr, u"\u20AC" # euro sign
  File "C:\pythonxy\python\lib\codecs.py", line 304, in write
    self.stream.write(data)
IOError: [Errno 13] Permission denied 
```

如果字体不是 truetype，则不会引发异常，但输出错误。

Perl 适用于 truetype 字体：

```
C:\> perl  -E"say qq(\x{20ac})"
Wide character in print at -e line 1.
€ 
```

重定向虽然有效：

```
C:\>python silence_stderr.py 2 2>tmp.log
ok
C:\>cat tmp.log
€
cat: write error: Permission denied 
```

### 重新评论

从[`codecs.getwriter`](http://docs.python.org/library/codecs.html#codecs.getwriter)文档：

> 查找给定编码的编解码器并返回其 StreamWriter 类或工厂函数。`LookupError`在找不到编码的情况下引发 a 。

过于简单的观点：

```
class UTF8StreamWriter:
    def __init__(self, writer):
        self.writer = writer
    def write(self, s):
        self.writer.write(s.encode('utf-8'))

sys.stderr = UTF8StreamWriter(sys.stderr) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T04:52:13.993

当 stderr 没有被重定向时，它会接受终端的编码。但是，当您重定向它时，这一切都会消失。您需要使用 sys.stderr.isatty() 来检测它是否被重定向并正确编码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T12:06:07.460

您也可以将字符串编码为 ASCII，替换不映射的 unicode 字符。那你就不用担心你有什么样的终端了。

```
asciiTitle = page_title.encode("ascii", "backslashreplace")
print >>sys.stderr, "bad page title", asciiTitle 
```

这将替换无法用反斜杠转义编码的字符，即`\xfc`. 还有一些其他替换选项，如下所述：

[http://docs.python.org/library/stdtypes.html#str.encode](http://docs.python.org/library/stdtypes.html#str.encode)

# c# - 不是对的 ?

> ID：637397
> 
> 赞同：1
> 
> 时间：2009-03-12T04:46:25.723
> 
> 标签：c#, silverlight, mvvm, wcf-data-services

我很困惑。我有一个 Silverlight 项目，目前正在运行并显示来自我的模拟模型的服务器列表（我遵循 MVVM 模式）。

接口编码如下：

```
public class GetServersCompletedEventArgs : EventArgs 
{
    public Exception Error {get; set;}
    public IEnumerable<LicenseServer> Results {get; private set;}

    public GetServersCompletedEventArgs(Exception error, IEnumerable<LicenseServer> results)
    {
        this.Error = error;
        this.Results = results;
    }
}

public delegate void GetServersCompletedEvent(GetServersCompletedEventArgs e);

public interface IDataService
{
    void GetServers();

    event GetServersCompletedEvent GetServersCompleted;
} 
```

如您所见， CompletedEventArgs 将结果作为 IEnumerable 返回。

我遇到的问题是以`<LicenseServer>`这样一种方式定义的，即我可以用假数据存根它或从真实数据（ala ado.net 数据服务）中填充结果。

我创建了一个本地类 LicenseServer，但该服务总是返回不同类型的 LicenseServer。

我收到一个错误：

> 转换无法将“DataServiceOrderedQuery[LicenseMon.LMonServiceReference.License_Server]”类型的对象转换为“System.Data.Services.Client.DataServiceQuery`1[LicenseMon.Model.LicenseServer]”类型

我从服务参考中读取为 LicenseServer 的内容无法转换为我在模型类中定义的 LicenseServer

为什么我有麻烦？我不应该能够独立开发我的课程并能够在实时数据库和我内部生成的数据之间切换吗？我是以错误的方式接近这个吗？

任何代码示例、解释、链接等都是最有帮助的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T05:11:37.677

通常，在使用 Web 资源（SOAP、WCF 或 ADO.NET 数据服务）时，会生成一个*单独*的客户端代理类。这将具有类似的布局，但不会自动转换为您的本地类型。一些系统支持类型重用（WCF 等），但不是全部。

您可以向部分类添加转换或接口；但总的来说，您应该将其视为单独的类型。

# python - 在接口启动时，可以扫描特定的 MAC 地址吗？

> ID：637399
> 
> 赞同：0
> 
> 时间：2009-03-12T04:47:34.863
> 
> 标签：python, linux, networking, sysadmin

我承认 linux 网络系统对我来说有些陌生，我对它足够了解，可以手动配置路由并在必要时分配静态 IP。

这么快的问题，在 ifconfig 配置文件中，是否可以在 python 脚本中添加一个连接后挂钩，然后使用 python 脚本在 /etc/hosts 中重新分配主机名，并在主机名之后生成一个新进程来执行其他操作已经更新。

这对我来说是一个“有趣”的项目，可以解决我日常生活中的烦恼。当我早上启动我的工作站时，DHCP 服务会随机为其分配一个 IP。所以我通常会停止我正在做的事情，查找我的新 IP，将该 IP 输入到我的笔记本电脑中，然后运行 ​​synergy，这样我就可以共享两台机器。我想我每周每天都会浪费 10 到 15 分钟，而且我从来没有真正弄乱过 linux 的网络系统，所以它最终会成功。

我已经认为我的 python 脚本必须以 root 身份运行，因此我将它存储在 /root 或其他安全的地方。我发现了一个关于堆栈溢出的类似问题，它指向[http://www.secdev.org/projects/scapy/index.html](http://www.secdev.org/projects/scapy/index.html)一个与 ARP 一起使用的原始数据包工具集的方向。编辑主机文件很容易......只是想知道尝试将此挂钩放入核心服务可能会导致什么副作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T04:54:23.223

只需确保 Avahi / Bonjour 正在运行，然后键入*主机名*.local（或尝试*主机名*.localdomain）——它使用 mDNS 解析，因此您不必关心您的 IP 是什么或操纵 /etc/hosts。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T10:15:28.693

抱歉，这看起来像是在尝试创建一个不存在问题的问题，然后使用有点疯狂的方法解决它。:)

您可以将 dhcp 服务器（路由器）配置为始终为您的工作站发布固定 IP。如果你没有 dhcp 服务器，那你为什么要使用 dhcp 来配置接口呢？更改配置（`/etc/network/interfaces`在 Ubuntu 和 Debian 中）为接口分配静态 IP 地址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T09:59:38.530

最干净的解决方案是让 DHCP 服务器与本地 DNS 服务器交换其分配。因此，无论您的工作站被分配到哪个 IP 地址，都可以在相同的主机名下访问它。

这个概念用于每个成熟的 Windows 网络以及任何其他配置良好的网络。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T09:58:39.060

你也可以使用**arp-scan**（一个 Debian 软件包的名称存在，不确定其他发行版）来扫描你的整个网络。有一个脚本解析它的输出，你就准备好了。

# c# - 构造函数中的业务逻辑 - C#/Linq to Sql

> ID：637401
> 
> 赞同：0
> 
> 时间：2009-03-12T04:47:56.220
> 
> 标签：c#, linq-to-sql, .net-3.5, class-design

我正在扩展（不确定此处是否正确）在 Linq to SQL 数据库模型中生成的部分 Cart 类。

业务逻辑是每个客户只能有一个购物车。如果客户没有购物车，则应该创建它；如果客户有购物车，则应退回。

这就是我正在做的事情：

```
public partial class Cart
{
    //the rest of the Cart class is in the .dbml file created by L2S
    public Cart(int userId)
    {
        Cart c = GetCurrentCart(userId);
        this.CartId = c.CartId ;
        this.UserId = c.UserId;
    }

    public Cart GetCurrentCart(int userId)
    {
        Cart currentCart = new Cart();

        // if cart exists - get it from DB
        //if not - create it, save in DB, and get if right out
        //all of this is done with Linq to SQL

        return currentCart;
    }
} 
```

从构造函数调用方法似乎并不正确。我是否以正确的方式执行业务逻辑？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-12T05:04:34.650

我会质疑为什么“购物车”类如此聪明。在领域驱动设计术语中，听起来用户“拥有”购物车。那么为什么不这样：

```
var user = // Load a user
var cart = user.Cart; 
```

在这种情况下，您的 Cart getter 可以延迟加载/初始化购物车。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T05:23:50.313

我同意 Paul Stovell 的观点，听起来用户应该拥有购物车。但无论如何，当你的构造函数被调用时，你已经有了一个新的 Cart 实例。C# 不允许您更改构造函数返回的引用，因此与其使用构造函数的 Cart 类的客户端，不如调用静态工厂方法（我没有使用 Linq to SQL 的经验，因此这可能行不通直接地）。

您的 GetCurrentCart 方法几乎是这样的；您只需将其标记为静态即可。此外，您应该让 Cart 构造函数只负责创建一个新的 Cart 并将其设为私有，以便客户端被迫使用 GetCurrentCart。一个实现可能看起来像这样：

```
public partial class Cart
{
        // Make a new cart
        private Cart(int userId, int cartId)
        {
            this.CartId = userId;
            this.UserId = cartId;
        }

        private static Dictionary<int, Cart> CurrentCarts = new Dictionary<int, Cart>();

        public static Cart GetCurrentCart(int userId)
        {
            // TODO: Use a proper caching mechanism that will at least
            //       remove old carts from the dictionary.
            Cart cart;
            if (CurrentCarts.TryGetValue(userId, out cart))
            {
                return cart;
            }

            cart = /* try get cart from DB */;
            if (cart == null)
            {
                // Make a new cart
                cart = new Cart(userId, GenerateCartId());
            }

            CurrentCarts[userId] = cart;

            return cart;
        }
} 
```

# .net - 调试点网应用程序时如何传递参数

> ID：637410
> 
> 赞同：31
> 
> 时间：2009-03-12T04:51:46.163
> 
> 标签：.net, console

我有一个使用参数的命令行，我对此没有任何问题，但是每次我想测试应用程序时，我都需要编译它，运行 CMD，使用 CMD 中的参数调用应用程序，因为我没有找不到任何解决方案，让我在 Visual Studio 中动态地将参数传递给控制台你知道吗？非常感谢！！

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-03-12T04:53:34.707

转到`Project->Properties`并单击`Debug`选项卡。

有一个命令行参数部分：

![在此处输入图像描述](https://i.stack.imgur.com/40c4M.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T04:54:47.247

在 VS 中右键单击您的项目 -> 属性 -> 调试选项卡

有一个区域可以指定命令行参数。当您调试项目时，VS 将使用这些参数启动它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T04:55:13.813

转到项目属性 - 调试部分，在开始选项标题下有一个命令行参数部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-26T18:01:58.333

现在称为“应用程序参数” [![在此处输入图像描述](https://i.stack.imgur.com/dI8oo.png)](https://i.stack.imgur.com/dI8oo.png)

# c# - 流畅的 nHibernate 和 JoinSubClasses

> ID：637417
> 
> 赞同：0
> 
> 时间：2009-03-12T04:54:03.210
> 
> 标签：c#, .net, nhibernate, fluent-nhibernate

我不确定这是否与我的 Fluent 配置或我的思维逻辑有关。

基本上我有一个 Person 类，我从中继承了两个类，Author 和 Borrower（它是一个库系统）。我的映射是。

```
public class PersonMap : ClassMap<Person>
{
    public PersonMap()
    {
        Id(x => x.Id, "id");
        Map(x => x.Name, "name");

        // Subclasses
        AddPart(new AuthorMap());
        AddPart(new BorrowerMap());
    }
}

public class AuthorMap : JoinedSubClassPart<Author>
{
    public AuthorMap() : base("person_id")
    {
        Map(x => x.Country, "country");
        HasMany(x => x.Books).Cascade.All().WithKeyColumn("book_id"); 
    }
}

public class BorrowerMap : JoinedSubClassPart<Borrower>
{
    public BorrowerMap() : base("person_id")
    {
        Map(x => x.UserName, "user_name");
        HasMany(x => x.Schedule).Cascade.SaveUpdate().WithKeyColumn("borrower_id");
    }
} 
```

现在，如果我运行 HQL “FROM Author a ORDER BY a.Name”，它将返回所有作者和借款人实体的列表，我显然只想要一个作者列表。请随时让我明白这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T21:25:46.043

有几件事要尝试：

*   在每个子类映射中，将表名设置为`WithTableName("Author")`
*   是`person_id`每个子类表上的键列吗？如果没有，请更改`base("person_id")`为`base("key column name")`

例如，我刚刚使用以下映射测试了一个非常相似的查询：

```
public class DigitalFreeSubscriptionMap : JoinedSubClassPart<DigitalFreeSubscription>
{
    public DigitalFreeSubscriptionMap()
        : base("DigitalFreeSubscriptions")
    {
        WithTableName("DigitalFreeSubscriptions");
        ... 
```

和

```
public class FreeSubscriptionMap : JoinedSubClassPart<FreeSubscription>
{
    public FreeSubscriptionMap()
        : base("FreeSubscriptions")
    {
        WithTableName("FreeSubscriptions");
        ... 
```

两者都是 的子类`Subscription`。在我测试的数据库中，有 1700 个 DigitalFreeSubscriptions，而有超过一百万个 FreeSubscripions（和其他类型的订阅）。HQL 查询“ `FROM DigitalFreeSubscripion`”返回 1700 个结果。

每个请求，SubscriptionMap 的顶部：

```
public class SubscriptionMap : AuditableClassMap<Subscription>
{
    public SubscriptionMap()
    {
        WithTable("Subscriptions");
        Id(x => x.Id, "Subscriptions");

        AddPart(new FreeSubscriptionMap());
        AddPart(new DigitalFreeSubscriptionMap());
        // More sublass mappings and then the field mappings 
```

# ruby - 'eval'应该是讨厌的吗？

> ID：637421
> 
> 赞同：25
> 
> 时间：2009-03-12T04:55:03.003
> 
> 标签：ruby, eval

我已经多次使用`eval`ruby​​ 的功能。但我听人说`eval`s 很讨厌。当被问及为什么以及如何使用时，我永远无法找到不使用它的令人信服的理由。他们真的很讨厌吗？如果是，以什么方式？评估可能有哪些“更安全”的选项？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-12T05:02:05.513

如果您正在`eval`输入由用户提交或可由用户修改的字符串，这无异于允许任意代码执行。想象一下，如果字符串包含操作系统调用`rm -rf /`或类似调用。也就是说，在您知道字符串受到适当约束的情况下，或者您的 Ruby 解释器被适当地沙盒化，或者理想情况下两者`eval`都具有非常强大的功能。

如果您熟悉的话，这个问题类似于[SQL 注入。](http://en.wikipedia.org/wiki/SQL_injection)这里的解决方案类似于注入问题的解决方案（参数化查询）。也就是说，如果你想要的语句`eval`是一个非常具体的形式，并且不是*所有*的语句都需要用户提交，只有几个变量、一个数学表达式或类似的，你可以接受这些来自用户的小片段，必要时对其进行清理，然后在适当的位置插入用户输入来评估安全模板语句。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-27T10:10:56.837

`eval`不仅不安全（正如在其他地方指出的那样），而且速度也很慢。每次执行时，`eval`ed 代码的 AST 都需要重新解析（例如 JRuby，转为字节码），这是一个字符串繁重的操作，也可能不利于缓存局部性（假设正在运行程序并不`eval`多，因此解释器的相应部分是缓存冷的，除了很大）。

你问，为什么`eval`在 Ruby 中存在？“因为我们可以”主要是 - 事实上，当`eval`被发明时（对于 LISP 编程语言），它[主要是为了展示](http://en.wikipedia.org/wiki/Eval#Lisp)！`eval`更重要的是，当您想要“将解释器添加到解释器中”时，使用是正确的事情，用于元编程任务，例如编写预处理器、调试器或模板引擎。此类应用程序的常见想法是修改一些 Ruby 代码并调用`eval`它，这肯定优于重新发明和实现特定领域的玩具语言，这是一个也称为[Greenspun 第十规则](http://en.wikipedia.org/wiki/Greenspun%27s_tenth_rule)的陷阱。需要注意的是：注意成本，例如对于模板引擎，`eval`在启动时而不是运行时完成所有工作；不要`eval`[不受信任的代码，除非您知道如何“驯服”它，即根据能力纪律](http://c2.com/cgi/wiki?ObjectCapabilityLanguage)理论选择和执行语言的安全子集。后者是*很多*非常困难的工作（例如，请参阅[Java 是如何完成的](https://code.google.com/p/joe-e/)；不幸的是，我不知道对 Ruby 有任何此类努力）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-12T17:07:17.833

在 Ruby 中，有几个噱头可能比`eval()`：

1.  有`#send`它允许您调用名称为字符串的方法并将参数传递给它。
2.  `yield`允许您将代码块传递给将在接收方法的上下文中执行的方法。
3.  通常，简单`Kernel.const_get("String")`的方法就足以让您将其名称作为字符串的类。

我想我无法详细解释它们，所以我只是给了你一些提示，如果你有兴趣，你会谷歌。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-12T05:07:11.803

它使调试变得困难。它使优化变得困难。但最重要的是，这通常表明有更好的方法来做你想做的任何事情。

如果您告诉我们您想要完成什么`eval`，您可能会得到一些与您的特定场景相关的更相关的答案。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-12T05:09:07.213

Eval 是一个非常强大的功能，应该小心使用。除了 Matt J 指出的安全问题外，您还会发现调试运行时评估的代码非常困难。运行时评估的代码块中的问题对于解释器来说将难以表达——因此寻找它会很困难。

话虽如此，如果您对这个问题感到满意，并且不担心安全问题，那么您不应该避免使用使 ruby​​ 如此吸引人的功能之一。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-12T05:15:19.990

在某些情况下，一个合适的位置`eval`很聪明，可以减少所需的代码量。除了 Matt J 提到的安全问题之外，您还需要问自己一个非常简单的问题：

当一切都说完了，其他人能读懂你的代码并理解你做了什么吗？

如果答案是否定的，那么您从 an 中获得的东西将`eval`因可维护性而被放弃。这个问题不仅适用于你在一个团队中工作，而且它也适用于你——你希望能够回顾你的代码几个月，如果不是几年之后，并且知道你做了什么。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-12-14T17:44:35.960

如果您将从“外部”获得的任何东西传递给`eval`，那么您做错了什么，这非常令人讨厌。很难将代码转义到足够安全的程度，所以我认为它非常不安全*。*但是，如果您使用 eval 来避免重复或其他类似的事情，例如以下代码示例，则可以使用它。

```
class Foo
  def self.define_getters(*symbols)
    symbols.each do |symbol|
      eval "def #{symbol}; @#{symbol}; end"
    end
  end

  define_getters :foo, :bar, :baz
end 
```

然而，至少在 Ruby 1.9.1 中，Ruby 具有非常强大的元编程方法，您可以改为执行以下操作：

```
class Foo
  def self.define_getters(*symbols)
    symbols.each do |symbol|
      define_method(symbol) { instance_variable_get(symbol) }
    end
  end

  define_getters :foo, :bar, :baz
end 
```

对于大多数目的，您希望使用这些方法，并且不需要转义。

另一个不好的事情`eval`是（至少在 Ruby 中）它非常慢，因为解释器需要解析字符串，然后在当前绑定中执行代码。其他方法直接调用 C 函数，因此您应该获得相当大的速度提升。

# iphone - 是否可以有没有键盘的 TextView？

> ID：637424
> 
> 赞同：1
> 
> 时间：2009-03-12T04:57:09.910
> 
> 标签：iphone, iphone-softkeyboard

对于我正在开发的特定应用程序，内置键盘对我来说毫无用处（我需要支持 0-9 和 X、del 等等）。我也喜欢带有大按钮的 UI，以便更轻松地按键。

想出一个带有按钮的 UI 很容易，但我不知道如何制作它，以便当用户选择 TextView 时键盘根本不会出现（我希望他们永远不会在全部）。

我确实希望能够选择光标所在位置的 TextView 功能，否则我会下注并使用标签。

这是错误的方式吗，我应该以其他方式来做吗？如果没有，有没有办法隐藏键盘？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T09:04:43.293

不，没有。没有键盘的文本视图称为“标签”。（这对插入点没有帮助，但它们是休息点。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T04:59:41.417

使 TextVeiw 不可编辑并且键盘不会出现

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-13T21:12:49.410

尝试这个：

```
UIView* emptyView = [ [ UIView alloc ] initWithFrame:CGRectZero ];
textView.inputView = emptyView; // this will show emptyView (=nothing) instead of keyboard
[ emptyView release ]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-06T13:33:00.693

是的，我们可以做到。通过禁用用户交互来完成。在您的 xib 用户交互中启用，例如 ![在此处输入图像描述](https://i.stack.imgur.com/Ctzee.png)

您必须禁用用户交互，例如 ![在此处输入图像描述](https://i.stack.imgur.com/XeK2i.png)

如果您以编程方式创建，则必须在 viewDidLoad 方法中编写以下代码，例如，

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    UITextView *txtvew = [[UITextView alloc] initWithFrame:CGRectMake(50, 150, 150, 300)];
    txtvew.userInteractionEnabled = NO;

} 
```

# php - 无法从 PHP Fedora 10 调用系统命令和 shell 脚本

> ID：637430
> 
> 赞同：0
> 
> 时间：2009-03-12T05:00:49.650
> 
> 标签：php, apache, shell, cgi, fedora10

我正在开发一个通过 PHP 和 Apache 在 Fedora 10 机器上本地运行的应用程序。这取决于在后台运行的进程。

高层希望能够通过浏览器启动/停止/重新启动该过程。我试图通过让 PHP 使用 exec() 和 shell_exec 调用系统来使其工作，但它似乎不起作用。

当我尝试使用“exec('processName')”启动进程时，什么也没有发生。

当我尝试使用“exec('killall processName')”时，SELinux 开始不断弹出该进程被允许的警告（因为我将其置于允许模式），但它实际上并没有杀死该进程！但这似乎在页面完全加载后仍然存在！？！？

我能够以类似的方式调用另一个脚本：“exec('/var/www/cgi-bin/ControlProgram START')”。所以我不太确定这两个调用/命令之间的主要区别是什么。

我还将脚本调用放入 /etc/rc.local 文件中，以使脚本在登录时运行。但是，我是否能够从 PHP 中删除该脚本，因为它是由...系统运行的？

在权限/SELinux 方面，我不是专家，所以不要吝啬血淋淋的细节！提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T06:54:26.273

如果您对该系统具有管理控制权，您将需要检查 PHP 配置（确保它是 Web 服务器的配置文件）。

Safe_Mode 将阻止 PHP 在特定文件夹之外执行任何操作。在共享主机环境中，这通常意味着您只能执行与您的 home/www 文件夹相关的事情——根据您的笔记似乎就是这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T03:35:12.053

我相信我找到了问题所在。我仍然不确定问题是什么，但看起来它与文件/目录权限有关。当我将脚本移动到我的 /var/www/html 目录时，脚本就会运行。我将它们移到 /var/www/cgi-bin 中，它们也在那里工作。所以可能是 apache 无法执行 /var/www 目录之外的脚本，或者至少它不能直接执行。不过感谢您的帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T06:13:20.267

这听起来像是老派的 unix 权限以及 apache 的运作方式。我确实记得（虽然已经有一段时间了）apache 对它的执行非常小心。仔细检查你的八进制。

要验证它不是 SELinux，您可以禁用它而不是将其置于允许状态。虽然这会导致文件系统重新标记（或应该）。那时，您在 SELinux 上下文中的扩展属性可能会变得异常，并在再次执行时导致 SELinux 问题。

# unit-testing - Sybase 数据库的单元测试工具

> ID：637433
> 
> 赞同：5
> 
> 时间：2009-03-12T05:03:17.570
> 
> 标签：unit-testing, sybase

我们有什么工具可以对 Sybase 数据库进行单元测试吗？

[我在http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks](http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks)中找不到

我正在寻找一种可以让我对存储过程进行单元测试的工具。就像我们对[utPLSQL](http://utplsql.sourceforge.net/)所做的那样。数据库人员将使用该工具进行单元测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T05:37:40.280

你到底想测试什么？Sybase 本身或您编写的在 Sybase 中运行的某些存储过程的正确性？如果是后者，那么您可以使用 JUnit 通过 JDBC 执行存储过程（我根据您的用户名假设 Java 是您熟悉的一种语言）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-08T20:47:23.573

我一直在寻找[SqlUnit](http://sqlunit.sourceforge.net/)来对存储过程等进行 xUnit 级别的测试。看起来很有希望。我现在正在安装和摆弄它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-21T07:55:44.217

请先尝试使用 AnyDbTest，(www.anydbtest.com)。我认为这是您正在寻找的工具。即使通过 AnyDbTest，此时也不支持 sybase。这些天来，我们正在努力支持 Sybase。

# c++ - 将元素添加到向量

> ID：637438
> 
> 赞同：0
> 
> 时间：2009-03-12T05:06:30.137
> 
> 标签：c++

我想知道为什么我会丢失信息。

到目前为止，我有三个功能。

一个选项处理函数和两个向量函数，一个用于读取文本文件，另一个用于将用户规范添加到同一向量。

发生的事情是我读取文件并将其内容保存到向量中，然后选择下一个选项来添加规范。为此，我使用 push_back。我输出（或调试）以查看我是否成功。是的。所以我选择再次读取文件的选项，然后我回到我开始的地方。用户规范丢失了。我认为这是因为我每次输入该选项时都会分配它。

我是初学者，所以我的代码不符合大多数编程标准。

这是我的第一个函数，它隔离由逗号分隔的字段，保存到结构成员变量中，然后作为文件中每一行的元素保存到向量中。

```
vector<sStruct> * loadFile(char *myTextFile)
{
    myStruct 
        sStruct; 
    vector<myStruct> 
        vectorAddress,
        *vectorData = new vector<myStruct>
    string 
        feild1, feild2, feild3, feild4;

    ifstream 
        *inFile = new ifstream;

    inFile->open( myTextFile, ios::in );

    if ( !inFile->good() )
    {
         cout << "? File Doesnt Exist! " << endl;
    }

    while ( !inFile->eof() )
    {

         getline( *inFile, feild1, ',' );
         sStruct.m_1 = field1;
         getline( *inFile, feild2, ',' );
         sStruct.m_2 = field2;
         getline( *inFile, field3, ',' );
         sStruct.m_3; = feild3
         getline( *inFile, feild4 );
         sStruct.m_4 = feield4;

    vectorData->push_back( sStruct );

    }

    inFile->clear();
    inFile->close();
    cout << vectorData->size();
    delete inFile;   // allocated obj delete to fast why bother?
    return vectorData;
} 
```

此函数成功地将另一个元素添加到向量中。

```
vector<sStruct> *  addElement(vector<sStruct> *vAddElement)
{    
    sStruct addElement;  // referring to the same struct.
    cout << "Enter a String: ";
    cin  >> addElement.feild1

    vAddElement->push_back( addElement );
    cout << vAddElement->size() << endl;
    return vAddElement;
} 
```

当我在第一个函数中时，我调试我的矢量对象，并保存文件中的数据。好的。所以我转到下一个函数并将一个字符串添加到具有第一个字段的结构成员中。希望不要覆盖任何东西。我调试以确保没有，一切都很好，push_back 工作得很好。但是，当我去我的第一个功能时。一切都回到了开始时的状态。

我知道这是因为我在那里读取文件，并在每次输入该函数时进行分配。有没有办法防止这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T05:24:58.813

您的函数 addElement() 获取参数 vAddElement，但您正在推入 vectorData...？！？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T05:45:49.810

这是因为每次输入 loadFile() 方法时都会创建一个新的向量实例。如果要保留向量的内容，请不要在 loadFile 中创建向量对象。在这个函数之外创建它（可能来自调用 loadFile() 的那个）并将它传递给这个函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T05:47:10.757

1.  对 loadFile() 函数进行更改以通过引用获取矢量对象并在 loadfile() 中更新相同的对象。

像这样的东西：

```
bool loadFile(char *myTextFile, vector<sStruct>& vectorData_out)
{
      //Read the file
      //push_back the element into vectorData_out
      //vectorData_out.push_back() ...code to push
} 
```

2.然后将addElement更改为通过引用接受vectorData_out：

```
bool addElement(vector<sStruct>& vAddElement_out)
{
      //initilization code for addElement 
     vAddElement_out.push_back( addElement );
     cout << vAddElement->size() << endl;
} 
```

现在您的调用代码如下所示：

```
std::vector<sStruct> aVectorData;
loadFile("filename.txt", aVectorData);
addElement(aVectorData); 
```

**编辑**：另外，除非绝对必要，否则尽量避免在堆上分配

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T06:36:31.450

Are the user specified fields in a single line or spread across multiple lines?

```
 getline( *inFile, feild1, ',' );
     sStruct.m_1 = field1;
     getline( *inFile, feild2, ',' );
     sStruct.m_2 = field2;
     getline( *inFile, field3, ',' );
     sStruct.m_3; = feild3
     getline( *inFile, feild4 );
     sStruct.m_4 = feield4; 
```

The code snippet above reads in four lines. Can you paste the first few lines of your user input file?

# java - 如何使用 Apache HWPF 从 DOC 文件中提取文本和图像

> ID：637440
> 
> 赞同：3
> 
> 时间：2009-03-12T05:06:36.813
> 
> 标签：java, apache-poi, hwpf

我下载了[Apache HWPF](http://poi.apache.org/hwpf/index.html)。我想用它来读取 doc 文件并将其文本写入纯文本文件。我不太了解HWPF。

我非常简单的程序在这里：

我现在有3个问题：

1.  一些包有错误（他们找不到 apache hdf）。我该如何修复它们？

2.  如何使用 HWDF 的方法来查找和提取图像？

3.  我的程序的某些部分不完整且不正确。所以请帮我完成它。

我必须在 2 天内完成这个程序。

我再次重复请帮助我完成这个。

非常感谢你们的帮助！！！

这是我的基本代码：

```
public class test {
  public void m1 (){
    String filesname = "Hello.doc";
    POIFSFileSystem fs = null;
    fs = new POIFSFileSystem(new FileInputStream(filesname ); 
    HWPFDocument doc = new HWPFDocument(fs);
    WordExtractor we = new WordExtractor(doc);
    String str = we.getText() ;
    String[] paragraphs = we.getParagraphText();
    Picture pic = new Picture(. . .) ;
    pic.writeImageContent( . . . ) ;
    PicturesTable picTable = new PicturesTable( . . . ) ;
    if ( picTable.hasPicture( . . . ) ){
      picTable.extractPicture(..., ...);
      picTable.getAllPictures() ;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-05-02T10:50:09.887

[Apache Tika](http://tika.apache.org/)将为您执行此操作。它处理与 POI 的对话以执行 HWPF 工作，并为您提供文件内容的 XHTML 或纯文本。如果您注册了一个递归解析器，那么您还将获得所有嵌入的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-07T01:56:55.470

```
 //you can use the org.apache.poi.hwpf.extractor.WordExtractor to get the text
    String fileName = "example.doc";
    HWPFDocument wordDoc = new HWPFDocument(new FileInputStream(fileName));
    WordExtractor extractor = new WordExtractor(wordDoc);
    String[] text = extractor.getParagraphText();
    int lineCounter = text.length;
    String articleStr = ""; // This string object use to store text from the word document.
    for(int index = 0;index < lineCounter;++ index){
        String paragraphStr = text[index].replaceAll("\r\n","").replaceAll("\n","").trim();
        int paragraphLength = paragraphStr.length();
        if(paragraphLength != 0){
            articleStr.concat(paragraphStr);
        }
    }
    //you can use the org.apache.poi.hwpf.usermodel.Picture to get the image
    List<Picture> picturesList = wordDoc.getPicturesTable().getAllPictures();
    for(int i = 0;i < picturesList.size();++i){
        BufferedImage image = null;
        Picture pic = picturesList.get(i);
        image = ImageIO.read(new ByteArrayInputStream(pic.getContent()));
        if(image != null){
            System.out.println("Image["+i+"]"+" ImageWidth:"+image.getWidth()+" ImageHeight:"+image.getHeight()+" Suggest Image Format:"+pic.suggestFileExtension());
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T05:08:32.427

如果您只想这样做，并且不关心编码，则可以使用[Antiword](http://www.winfield.demon.nl/)。

$ antiword file.doc > out.txt

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-01T05:47:17.900

事后很久我才知道这一点，但我在谷歌代码上找到了 TextMining，更准确且非常易于使用。然而，它几乎是被遗弃的代码。

# c++ - std::for_each，使用引用参数调用成员函数

> ID：637441
> 
> 赞同：8
> 
> 时间：2009-03-12T05:06:43.833
> 
> 标签：c++, stl, pass-by-reference

我有一个要迭代的指针容器，调用一个成员函数，该函数的参数是引用。我如何用 STL 做到这一点？

我目前的解决方案是使用 boost::bind 和 boost::ref 作为参数。

```
// Given:
// void Renderable::render(Graphics& g)
//
// There is a reference, g, in scope with the call to std::for_each
//
std::for_each(
  sprites.begin(),
  sprites.end(),
  boost::bind(&Renderable::render, boost::ref(g), _1)
); 
```

一个相关的问题（我从中得出了我当前的解决方案）是[boost::bind 与具有引用参数的函数](https://stackoverflow.com/questions/470040/boostbind-with-functions-that-have-parameters-that-are-references)。这特别询问如何使用 boost 来做到这一点。我问的是如何在*没有*提升的情况下完成。

**编辑**：有一种方法可以在不使用任何`boost`. 通过使用`std::bind`和朋友，可以在 C++11 兼容的编译器中编写和编译相同的代码，如下所示：

```
std::for_each(
  sprites.begin(),
  sprites.end(),
  std::bind(&Renderable::render, std::placeholders::_1, std::ref(g))
); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T06:09:43.807

这是设计的问题`<functional>`。您必须使用 boost::bind 或 tr1::bind。

# c# - WindowsForms 的不同布局模式

> ID：637447
> 
> 赞同：1
> 
> 时间：2009-03-12T05:08:24.767
> 
> 标签：c#, .net, winforms, .net-2.0, touchscreen

是否可以为 windows 窗体实现不同的布局模式而无需手动计算对齐位置？

例如：我有一个表单，它应该能够以正常和触摸屏两种模式显示。触摸屏模式是相同的形式，具有更大的按钮、更大的字体并且不应该*有*对齐问题。

.NET 框架 2.0 是否提供对这样的支持？如果不是，最好的方法是什么？我正在寻找一种可重用的策略，我可能想在很多屏幕上使用它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T05:39:59.043

我不知道在 Winforms 中制作控件的触摸屏“模式”需要什么，但我想它基本上包括缩放控件大小和文本。

如果这是真的，那么布局部分可以使用默认的 Winforms 布局策略和布局控件轻松完成，例如`System.Windows.Forsm.TableLayoutPanel`.

只需配置表格布局面板的行数和列数，设置对表单有意义的尺寸的宽度和高度最大和最小尺寸限制，为需要它的控件设置 Dock 和 Anchor 样式，并为您的控件的“触摸屏模式”。Winforms 布局基础结构将根据指定的限制很好地调整布局。

我强烈建议阅读**Windows 窗体布局常见问题解答**（它更像是一个教程/指南），以获取有关可以完成的更多信息：

（链接到 Microsoft Word 文档）

[http://www.windowsforms.com/Samples/Go%20To%20Market/Layout/layoutGTM.doc](http://www.windowsforms.com/Samples/Go%20To%20Market/Layout/layoutGTM.doc)

# javascript - 如何使用 JSON 和 jQuery 构建树形控件

> ID：637452
> 
> 赞同：1
> 
> 时间：2009-03-12T05:11:02.480
> 
> 标签：javascript, jquery, ajax, json

我有一个网页，我想在 jQuery 的帮助下动态显示基于 JSON 数组的树。我的树的每个节点都有一个与之关联的复选框。当我单击具有子节点的节点时，我希望检查所有节点。我已经处理好打印树和复选框，现在我正在尝试选择子节点，但我不能。

下面是我到目前为止的代码（简化）。有没有人知道如何在使用 jQuery 检查复选框时自动检查子复选框？

谢谢！

```
<html>
<head>

    <script type="text/javascript" src="jquery-1.3.2.min.js"></script>

    <script type="text/javascript">

        var myJSON = {
            "d": {
                "__type": "Branch", 
                "Name": "$", 
                "FullPath": "$\\$", 
                "SubBranch": [
                    {
                        "__type": "Branch", 
                        "Name": "System", 
                        "FullPath": "$\\System", 
                        "SubBranch": [
                            {
                                "__type": "Branch", 
                                "Name": "Library", 
                                "FullPath": "$\\System\\Library", 
                                "SubBranch": [
                                ]
                            }, 
                            {
                                "__type": "Branch", 
                                "Name": "Configuration", 
                                "FullPath": "$\\System\\Configuration", 
                                "SubBranch": [
                                    {
                                        "__type": "Branch", 
                                        "Name": "Reimage", 
                                        "FullPath": "$\\System\\Configuration\\Reimage", 
                                        "SubBranch": [
                                        ]
                                    }, 
                                    {
                                        "__type": "Branch", 
                                        "Name": "Installation", 
                                        "FullPath": "$\\System\\Configuration\\Installation", 
                                        "SubBranch": [
                                        ]
                                    }
                                ]
                            }, 
                        ]
                    }
                ]
            }
        }

        var output;
        var indentationLevel = 0;

        function GetSpacing(numberOfSpaces) {
            var tabs = '';
            for (i = 0; i < numberOfSpaces; i++) {
                tabs += '&nbsp;&nbsp;&nbsp;';
            }
            return tabs;
        }

        function GetHtmlForFeaturePath(featurePath) {
            return '<div>' + GetSpacing(indentationLevel) + '<input type="checkbox" id="' + featurePath.FullPath + '" class="featureTreeCheckbox" />' + featurePath.Name + "</div>";
        }

        function GetHtmlForFeaturePaths(node) {
            output += GetHtmlForFeaturePath(node);

            indentationLevel++;

            jQuery.each(node.SubBranch, function() {
                GetHtmlForFeaturePaths(this);
            });

            indentationLevel--;
        }

        String.prototype.startsWith = function(str) {
            return this.match("^" + str) == str;
        }

        window.onload = function() {
            GetHtmlForFeaturePaths(myJSON.d);
            document.writeln(output);

            /* How do I tell a node to check its children? */
            $('input').click(function(event) {
                var clickedControlId = this.id;
                alert(clickedControlId);  

                /* alert($.grep(myJSON.d, function (a) { return a.FullPath == clickedControlId })); */
            });
        }

    </script>

</head>
<body>
    <a href="http://jquery.com/">jQuery</a>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T08:05:22.127

用空格区分级别不是一个好习惯。相反，您应该使用类或 id。这有助于外观（您可以使用 css）和您的代码，因为它定义了逻辑级别。

编辑您的代码以生成这样的 DOM：

```
<div class="level1">
<input id="$\$" class="featureTreeCheckbox" type="checkbox">$
    <div class="level2">
    <input id="$\System" class="featureTreeCheckbox" type="checkbox">System
        <div class="level3">
            <input id="$\System\Library" class="featureTreeCheckbox" type="checkbox">Library
        </div>
        <div class="level3">
            <input id="$\System\Configuration" class="featureTreeCheckbox" type="checkbox">Configuration
                <div class="level4">
                    <input id="$\System\Configuration\Reimage" class="featureTreeCheckbox" type="checkbox">Reimage<br/>
                    <input id="$\System\Configuration\Installation" class="featureTreeCheckbox" type="checkbox">Installation
                </div>
        </div>
    </div>
</div> 
```

每个“levelx”类定义一个级别。您可以像这样轻松地设置它的样式：

```
<style>
.level1 { margin-left: 0px; }
.level2 { margin-left: 10px; }
.level3 { margin-left: 20px; }
.level4 { margin-left: 30px; }
</style> 
```

然后你可以使用这样的代码：

```
<script type="text/javascript">

$(function() {
$('div.level1 input').change(function(event) {
    if ($(this).is(":checked")) {
        $(this).parent().find("input").attr("checked", "checked");
    }
});
$('div.level2 input').change(function(event) {
    if ($(this).is(":checked")) {
        $(this).parent().find(".level3 input").attr("checked", "checked");
        $(this).parent().find(".level4 input").attr("checked", "checked");
    }
});

$('div.level3 input').change(function(event) {
    if ($(this).is(":checked")) {
        $(this).parent().find(".level4 input").attr("checked", "checked");
    }
});

});
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T04:49:51.733

我会简化 kgiannakakis 所做的事情：

```
$(function() {
  $('div input:first').change(function(event) {
    if ($(this).is(":checked")) {
        $(this).next("div").find("input").attr("checked", "checked");
    } else {
        $(this).next("div").find("input").removeAttr("checked");
    }
  });
}); 
```

这应该适用于任意数量的级别。

# sql - 设计问题 - 在列、行或其他位置放置数百个是/否开关？

> ID：637457
> 
> 赞同：3
> 
> 时间：2009-03-12T05:12:21.793
> 
> 标签：sql, sql-server, database-design

我们正在将使用分层数据库的旧应用程序移植到关系 Web 应用程序，并试图找出移植配置开关（Y/N 值）的最佳方法。

我们的旧系统有 256 个不同的开关（每个客户端），每个开关都作为一个位存储在 8 个 32 位数据字段之一中。每个客户端通常会设置约 100 个开关。要读取或设置开关，我们将使用#define 值使用按位算术。例如：

```
if (a_switchbank4 & E_SHOW_SALARY_ON_CHECKS) //If true, print salary on check 
```

我们正在讨论在我们的新关系 (MS-SQL) 数据库中存储开关的方法：

1.  将每个开关放在自己的字段中
    *   优点：快速轻松的读/写/访问 - 每个客户端 1 行
    *   缺点：看起来很笨拙，每次添加开关时都需要更改架构
2.  为每个客户端的每个交换机创建一行
    *   优点：无限制的开关，使用新开关无需更改架构
    *   缺点：提取数据稍微困难一些，失去智能感知而无需额外工作
3.  维护位域
    *   优点：可以利用相同的代码，机器之间的 XML 数据传输更小
    *   缺点：对我们的开发人员没有任何意义，难以调试，太容易使用错误的“切换银行”字段进行比较

我倾向于＃1 ...有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T05:18:36.300

这取决于几个因素，例如：

*   每个客户端设置多少个开关
*   实际使用了多少个开关
*   添加开关的频率

如果我不得不猜测（我会猜测）我会说你真正想要的是标签。一个表有客户端，每个都有唯一的 ID，另一个有标签（标签名称和唯一的 ID），第三个有客户端 ID/标签 ID 对，以指示哪些客户端有哪些标签。

这与您的解决方案 #2 不同，因为标签仅适用于该开关为真的客户端。换句话说，不是存储客户端 ID、交换机 ID 和布尔值，而是仅存储客户端 ID 和交换机 ID，但仅用于具有该交换机集的客户端。

与解决方案二相比，这占用了大约三分之一的空间，但真正的优势在于解决方案一和解决方案三：索引。如果您想找出像哪些客户端设置了开关 7、45 和 130 但没有设置 86 或 14 之类的事情，您可以使用标记表上的单个索引有效地完成它们，但是没有实用的方法来使用另一个解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T10:49:59.873

您可以考虑使用数据库视图为您提供最好的每个解决方案。例如，将数据存储为每个开关一行，但使用将开关（行）旋转到更方便的列的视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T14:10:47.753

我会选择选项＃2，每个标志一行。

但是，我也会考虑 #1 和 #2 的混合。我不知道您的应用程序，但如果某些开关是相关的，您可以将它们分组到具有多列开关的表中。您可以根据用途或类型对它们进行分组。对于不适合组的那些，您可以并且可能仍然会有一个每行一个开关的通用表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T13:33:40.133

还要记住，如果您更改方法，您可能需要更改大量依赖于现有数据存储方法的应用程序代码。你是否应该改变方法可能取决于它到底有多难，以及改变所有相关的东西需要多少小时。我同意 Markus 的解决方案，但您确实需要考虑重构的难度以及您的项目是否能够负担得起时间。我一直在阅读的重构书建议您使用触发器在设定的时间段内维护它们以使它们保持同步，然后您开始修复所有引用。然后在设定的日期从数据库中删除原始（和触发器）。这允许您使用新的方法，但提供了灵活性，在您修复之前不会破坏任何东西，因此，您可以在所有参考都修复之前推出更改。然而，它需要纪律，因为很容易不摆脱遗留代码和列，因为一切都在工作，你害怕不这样做。如果您正在进行全面重新设计，所有内容都将经过彻底测试，并且您有时间在项目中构建，那么请立即更改所有内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T05:24:34.557

我也倾向于选项 1，但在某些情况下也会考虑选项 4。

4-存储在名称值对的字典中。序列化到数据库。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-12T07:30:40.617

我会推荐选项 2。将标签/行列表转换为代码中的哈希相对简单，这使得检查变量变得相当容易。拥有超过 256 列的表格似乎是一场噩梦。

选项 #2 的一个问题是交叉表查询很痛苦：

```
Client   S1 S2 S3 S4 S5 ...
A            X     X
B         X  X  X 
```

但是通常有一些方法可以以特定于数据库的方式执行此操作。

# mysql - 修改我的网站以允许匿名评论

> ID：637460
> 
> 赞同：2
> 
> 时间：2009-03-12T05:13:04.160
> 
> 标签：mysql, database, database-design, identity, user-accounts

我为自己的网站编写代码作为教育/有趣的练习。现在网站的一部分是一个博客（就像所有其他网站一样：-/），它支持通常的基本博客功能，包括评论帖子。但我只为登录用户启用了评论；我想更改代码以允许匿名评论 - 也就是说，我想允许人们在不首先在我的网站上创建用户帐户的情况下发表评论，尽管仍然需要某种身份验证来防止垃圾邮件。

问题：我应该为匿名评论保存哪些信息？我在想至少显示名称和电子邮件地址（用于显示 Gravatar），可能还有网站 URL，因为我最终也想接受 OpenID，但还有其他意义吗？

其他问题：我应该如何修改数据库来存储这些信息？我对评论表的架构目前是

```
comment_id       smallint(5)       // The unique comment ID
post_id          smallint(5)       // The ID of the post the comment was made on
user_id          smallint(5)       // The ID of the user account who made the comment
comment_subject  varchar(128)
comment_date     timestamp
comment_text     text 
```

我应该在评论表中添加姓名、电子邮件地址等其他字段吗？（似乎是个坏主意）创建一个新的“匿名用户”表？（如果是这样，如何防止匿名用户 ID 与常规用户 ID 冲突）或者在我现有的用户表中为匿名用户创建假用户帐户？

造成这种棘手的部分原因是，如果有人试图使用已与我网站上的帐户关联的电子邮件地址（或 OpenID）发表匿名评论，我想抓住它并提示他们登录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T05:24:16.350

匿名评论的全部意义在于用户不必登录，对吗？

我个人的喜好是不强迫用户输入任何东西，甚至是他们的名字！唯一需要的字段是评论文本本身。如果他们不想透露姓名或电子邮件，那好吧，谁在乎呢？

如果他们提供了一个已经存在的电子邮件，那么他们很可能在很久以前就注册了，甚至不记得他们的密码。

同样，在这种情况下不要强迫用户登录。只需让他们选择登录或将电子邮件字段留空（或更改其内容）。或者，只显示一个警告框，告诉他们评论将在没有电子邮件地址的情况下发送，并带有“确定”和“取消”选项。

那么，匿名评论要存储什么？

我会说存储他们的姓名和电子邮件（当然，不要向公众显示他们的电子邮件），但将它们设为可选字段，而不是强制性的。

您也可以存储他们的网站，虽然我个人不知道这样做有什么意义，除了可能为匿名海报做自我广告！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T06:27:43.983

没问题，你在评论表上输入“用户名”。然后将用户表中的值复制到登录用户的该字段。这样，如果用户被删除，他们的评论仍然会附加一个名称。评论通常是分层的，因此很难只删除评论树中间的一个。

如果他们将其留空，您可以在表格中输入您的“anonymous_user”文本。

# seo - 这是黑帽SEO技术吗？

> ID：637462
> 
> 赞同：4
> 
> 时间：2009-03-12T05:13:29.027
> 
> 标签：seo, googlebot

我有一个完全用 Flash 开发的网站。现在网站所有者不想转向更多基于文本/html 的网站。因此，我计划创建一个替代的基于 html/text 的站点，googlebot 将被重定向到该站点。（通过检查用户代理）。我的问题是，这是谷歌官方允许的吗？

如果不是，那么与用户相比，为什么有许多基于订阅的网站向谷歌显示不同的数据集？这是允许的吗？

非常感谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-12T05:36:55.587

我已经为大型电子商务网站处理了这种确切的情况，而 Google 基本上忽略了该网站。谷歌认为它隐藏并直接[在这里](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=66355)解决它并说：

> 伪装是指向用户和搜索引擎呈现不同内容或 URL 的做法。根据用户代理提供不同的结果可能会导致您的网站被视为具有欺骗性并从 Google 索引中删除。

相反，创建一个符合 ADA 标准的网站版本，以便具有屏幕阅读器和视力辅助工具的用户可以使用您的网站。只要有从您的主页到符合 ADA 标准的页面的链接，Google 就会将它们编入索引。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T05:17:45.367

[官方建议](http://googlewebmastercentral.blogspot.com/2007/07/best-uses-of-flash.html)似乎是：提供指向该网站非 Flash 版本的可见链接。愚弄 googlebot 肯定会惹上麻烦。请记住，Google 结果将链接到匹配页面！不要做出无用的结果。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-12T06:24:02.167

谷歌[已经索引了 Flash 内容](http://googlewebmastercentral.blogspot.com/2008/06/improved-flash-indexing.html)，所以我的建议是检查你的网站是如何被索引的。也许你不需要做任何事情。

从 Google 的角度来看，我不认为显示该网站的替代版本是好的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T05:22:44.280

如果您使用完全相同的地址提供您的页面，那么您可能没问题。例如，如果您显示“ [http://www.somesite.com/](http://www.somesite.com/) ”但将 googlebot 引导至“ [http://www.somesite.com/alt.htm](http://www.somesite.com/alt.htm) ”，则 Google 可能会将搜索用户引导至 alt.htm。你不想这样，对吧？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T05:21:23.020

这称为伪装。我不确定它的影响是什么，但它肯定不是白帽。我很确定谷歌现在正在研究一种抓取 Flash 的方法，所以它甚至可能不是一个问题。

我假设您实际上并没有进行重定向，而是进行了 PHP 导入或类似的操作，因此它显示为同一页面。如果您实际上是在重定向，那么它只会像往常一样索引其他页面。

一些网站提供不同级别的内容——他们限制内容，他们不提供替代和额外的内容。这样做是为了不索引不相关的事物。

# .net - 在应用程序中设置reportviwer的参数

> ID：637464
> 
> 赞同：3
> 
> 时间：2009-03-12T05:15:15.903
> 
> 标签：.net, reportviewer

我们如何设置.Net的reportviewer的参数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T05:25:20.560

```
List<ReportParameter> paramList = new List<ReportParameter>();
paramList.Add(new ReportParameter("ClientName", clientName, false)); 
TheReportObject.LocalReport.SetParameters(paramList); 
```

而且您必须确保在报告定义中也定义了相同的命名参数。

# find - 在 find 中分组谓词

> ID：637467
> 
> 赞同：6
> 
> 时间：2009-03-12T05:16:48.613
> 
> 标签：find

这部分“ ( -name *txt -o -name *html ) ”在代码中让我感到困惑：

```
find $HOME \( -name \*txt -o -name \*html \) -print0 | xargs -0 grep -li vpn 
```

有人可以解释括号和“-o”吗？“-o”是命令还是参数？我知道括号是由 "\" 转义的，但是为什么要使用它们呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-12T05:44:32.057

默认情况下，查找参数列表中的条件是“和”在一起的。该`-o`选项的意思是“或”。

如果你写：

```
find $HOME -name \*txt -o -name \*html -print0 
```

那么没有与以“txt”结尾的文件名相关的输出操作，因此它们不会被打印。通过使用括号对名称选项进行分组，您可以获得“html”和“txt”文件。

* * *

考虑这个例子：

```
mkdir test-find
cd test-find
cp /dev/null file.txt
cp /dev/null file.html 
```

下面的评论对此有一个有趣的侧面。如果命令是：

```
find . -name '*.txt' -o -name '*.html' 
```

然后，由于没有为任一替代项指定显式操作，因此两个替代项都使用默认`-print`（不是`-print0`！）操作，并且列出了两个文件。在其中一个选项（但不是另一个）之后使用一个`-print`或其他显式操作，则只有具有该操作的选项才会生效。

```
find . -name '*.txt' -print -o -name '*.html' 
```

这也表明您可以针对不同的选择采取不同的行动。您还可以应用其他条件，例如修改时间：

```
find . \( -name '*.txt' -o -name '*.html' \) -mtime +5 -print0

find . \( -name '*.txt'  -mtime +5 -o -name '*.html' \) -print0 
```

第一个打印 5 天以前的 txt 或 html 文件（因此它不打印示例目录的任何内容 - 文件是几秒钟前的）；第二个打印超过 5 天的 txt 文件或任何年龄的 html 文件（所以只是 file.html）。等等...

感谢 DevSolar 的评论导致了这一添加。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T05:21:30.850

“-o”表示或。即，名称必须以“txt”或“html”结尾。括号只是将这两个条件组合在一起。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T05:22:27.290

( 和 ) 提供了一种对 find 命令的搜索参数进行分组的方法。-o 是“或”运算符。

此 find 命令将查找所有以“txt”或“html”结尾的文件，并将它们作为参数传递给 grep 命令。

# linq-to-sql - 执行这两个 foreach 循环的最有效方法是什么？

> ID：637473
> 
> 赞同：2
> 
> 时间：2009-03-12T05:20:35.813
> 
> 标签：linq-to-sql, .net-3.5, foreach

我不确定这是执行以下代码的最佳方法。我没有在另一个 foreach 中的 foreach 上出售。这可以用 Linq 做得更好吗？

*我知道更好的可能是
a) 性能更高
b) 更容易阅读/更优雅
c) 以上所有

注意：接受 .NET 3.5 解决方案 :) 注意 2：这两个 IList 是通过 Linq2Sql 的多记录集存储过程的结果。

这是使相信代码：

```
// These two lists are the results from a IMultipleResults Linq2Sql stored procedure.
IList<Car> carList = results.GetResult<Car>().ToList();
IList<Person> people = results.GetResult<Person>().ToList();

// Associate which people own which cars.
foreach(var person in people)
{
    var cars = (from c in cars
                where c.CarId == person.CarId
                select c).ToList();

    foreach (var car in cars)
    {
        car.Person = person;    
    }
} 
```

干杯:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T05:30:13.590

我认为性能不会有任何不同，但是如果您正在寻找简洁性：

```
var q = from person in people
        join car in cars on person.CarId equals car.CarId
        select new { car, person };
foreach(var o in q)
{
  o.car.Person = o.person; 
} 
```

编辑：在乔恩暗示这个版本更快之后，我很好奇并分析了这两个功能。这个版本似乎快了两倍，这太神奇了。我检查了拆卸。原始实现的开销似乎来自为外部和内部循环创建的新枚举器，导致 P 次 new/dispose 开销。

对于这段代码，只创建了一个枚举器，我认为这是“加入”功能的魔力。我没有检查它是如何工作的。

# asp.net - ASP.NET 控件不呈现

> ID：637474
> 
> 赞同：1
> 
> 时间：2009-03-12T05:21:05.140
> 
> 标签：asp.net, controls, render

我有一个非常简单的控件，我正在尝试渲染它，如下所示：

```
using System;
using System.Web;
using System.Web.UI;

namespace CORE.BusinessObjects.Web.Controls
{
    public class TestControl : Control
    {
        protected override void Render(HtmlTextWriter writer)
        {
            writer.Write("Hello from TestControl!");
        }
    }
} 
```

我以以下方式调用控件：

```
<%@ Register TagPrefix="Custom" 
             Namespace="CORE.BusinessObjects.Web.Controls" %>    
<Custom:TestControl ID="testControl" runat="server" Visible="true">
</Custom:TestControl> 
```

难道我做错了什么？我也未能运行我在网上找到的任何控制样本。什么都不执行。我只能执行控件的构造函数。我试图覆盖`Render()`或`CreateChildControls()`不执行的所有其他方法。

谢谢。

编辑：我忘了提到该控件包含在带有母版页的页面上。该控件实际上在母版页中运行良好，但不在它之外。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T06:42:44.260

您应该尝试以下方法：

一种。从`System.Web.UI.Control.WebControl`类继承。

湾。确保您创建了一个控件库，并且您的自定义控件库在相关的 Web 项目中被编译和引用。或者，将其添加到工具箱并从那里将其拖到表单上。这也应该在一步中添加参考。

C。确保您的控件声明具有`Assembly`指向所引用控件程序集名称的属性：

```
<%@ Register TagPrefix="Custom" Assembly="CORE.BusinessObjects" Namespace="CORE.BusinessObjects.Web.Controls" %>
<Custom:TestControl ID="testControl" runat="server" Visible="true" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T06:06:16.467

尝试从 CompositeControl 或 WebControl 继承

# c# - 如何在 C# 中获取当前用户的 Active Directory 详细信息

> ID：637486
> 
> 赞同：38
> 
> 时间：2009-03-12T05:26:37.623
> 
> 标签：c#, .net, active-directory, ldap, windows-authentication

我正在开发一个使用 Windows 身份验证的 C# 和 ASP.Net 应用程序。

即在 Web.config 中：

```
<system.web>
    <authentication mode="Windows" />
</system.web> 
```

我想从 Active Directory 中获取当前用户的详细信息（全名、电子邮件地址等）。

* * *

我可以通过使用获取他们的预 Windows 2000 用户登录名（例如`SOMEDOMAIN\someuser`：）

```
string username = HttpContext.Current.Request.ServerVariables["AUTH_USER"]; 
```

我已经为用户制定了 LDAP 查询，使用他们当前的登录名（不是他们之前的 Windows 2000 用户登录名）：

```
DirectorySearcher adSearch = new DirectorySearcher(
        "(userprincipalname=someuser@somedomain.com.au)");
SearchResult adSearchResult = adSearch.FindOne(); 
```

但是，我不知道如何使用他们的预 W2K 登录名搜索用户的 AD，或者以“someuser@somedomain.com.au”格式获取他们的登录名。

有任何想法吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-03-12T05:53:10.070

“pre Windows 2000”名称，即`DOMAIN\SomeBody`，该`Somebody`部分称为 sAMAccountName。

所以试试：

```
using(DirectoryEntry de = new DirectoryEntry("LDAP://MyDomainController"))
{
   using(DirectorySearcher adSearch = new DirectorySearcher(de))
   {
     adSearch.Filter = "(sAMAccountName=someuser)";
     SearchResult adSearchResult = adSearch.FindOne();
   }
} 
```

someuser@somedomain.com.au 是 UserPrincipalName，但它不是必填字段。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-03-12T06:06:06.560

Alan 已经给了您正确的答案 - 使用`sAMAccountName`过滤您的用户。

我会添加关于您使用的建议`DirectorySearcher`- 如果您只想要一两条信息，请将它们添加`"PropertiesToLoad"`到`DirectorySearcher`.

而不是检索整个大用户对象然后挑选一两个项目，这将只返回您需要的那些位。

样本：

```
adSearch.PropertiesToLoad.Add("sn");  // surname = last name
adSearch.PropertiesToLoad.Add("givenName");  // given (or first) name
adSearch.PropertiesToLoad.Add("mail");  // e-mail addresse
adSearch.PropertiesToLoad.Add("telephoneNumber");  // phone number 
```

这些只是您需要指定的常用 AD/LDAP 属性名称。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-16T18:45:16.703

添加对 COM“Active DS 类型库”的引用

* * *

```
 Int32 nameTypeNT4               = (int) ActiveDs.ADS_NAME_TYPE_ENUM.ADS_NAME_TYPE_NT4;
            Int32 nameTypeDN                = (int) ActiveDs.ADS_NAME_TYPE_ENUM.ADS_NAME_TYPE_1779;
            Int32 nameTypeUserPrincipalName = (int) ActiveDs.ADS_NAME_TYPE_ENUM.ADS_NAME_TYPE_USER_PRINCIPAL_NAME;

            ActiveDs.NameTranslate nameTranslate = new ActiveDs.NameTranslate();

            // Convert NT name DOMAIN\User into AD distinguished name 
            // "CN= User\\, Name,OU=IT,OU=All Users,DC=Company,DC=com"
            nameTranslate.Set(nameTypeNT4, ntUser);

            String distinguishedName = nameTranslate.Get(nameTypeDN);

            Console.WriteLine(distinguishedName);

            // Convert AD distinguished name "CN= User\\, Name,OU=IT,OU=All Users,DC=Company,DC=com" 
            // into NT name DOMAIN\User
            ntUser = String.Empty;
            nameTranslate.Set(nameTypeDN, distinguishedName);
            ntUser = nameTranslate.Get(nameTypeNT4);
            Console.WriteLine(ntUser);

            // Convert NT name DOMAIN\User into AD UserPrincipalName Name.User@Company.com
            nameTranslate.Set(nameTypeNT4, ntUser);
            String userPrincipalName = nameTranslate.Get(nameTypeUserPrincipalName);

            Console.WriteLine(userPrincipalName); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-04-15T04:52:20.730

如果您使用的是 .NET 3.5 SP1+，更好的方法是查看

```
System.DirectoryServices.AccountManagement namespace. 
```

它具有查找人员的方法，您几乎可以传递您想要的任何用户名格式，然后返回您需要的大部分基本信息。如果您在加载更复杂的对象和属性方面需要帮助，请查看[http://umanage.codeplex.com](http://umanage.codeplex.com)的源代码，它得到了一切。

布伦特

# c++ - 在 C++ 中保留配置设置的正确设计是什么？

> ID：637489
> 
> 赞同：3
> 
> 时间：2009-03-12T05:29:26.417
> 
> 标签：c++, configuration, singleton

假设我有 ini/json 来存储我的桌面应用程序的配置设置，是否可以在启动时/在需要时加载所有属性的静态对象，或者是否有其他更好的选择？

由于这是我第一次这样做，所以只是想知道静态对象是好的还是单例模式或其他东西会更好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T07:24:17.570

我通常使用[Boost.Program_options](http://www.boost.org/doc/libs/1_39_0/doc/html/program_options.html)，我通常使用单例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T05:34:41.613

无论哪种方式都很好。

如果是我，我会在构建配置对象时使用它。

```
cConfig Config("config.ini"); 
```

此 Config 类将加载在文件中找到的设置。任何代码都可以通过执行访问设置

```
Config.Get("NumberOfFoobars") 
```

出于可测试性目的，如果构造中没有文件，则将类的设置设置为默认值，或者创建一个日志文件，其中包含一条建议用户缺少设置的行。

然后对于需要配置的函数，我会将 Config 实例作为参数的一部分传递：

```
DoStuff(Config, [...]); 
```

并让 DoStuff 从 Config 类中获取变量。

这使得该类可测试（您可以模拟 Config 类）、可读（一目了然，您可以知道哪个函数需要配置）并且您不必依赖静态实例（如果您不知道如何使用单例，则很危险）使用它们）。

您可能有兴趣[了解有关此的更多信息](http://misko.hevery.com/2009/02/19/constructor-injection-vs-setter-injection/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T05:47:43.050

如果用户要修改配置设置以确定应用程序的运行方式，那么最好将其保存在某个 ini 文件中。一些用户喜欢直接编辑 ini 文件，而不是通过 GUI 进行。最好同时给出这两个选项。
此外，一些用户有多个 ini 文件，并在它们之间轮换以获取他们当时需要的设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T06:02:46.507

在启动时（或第一次需要设置）加载所有设置将在大多数情况下工作，但用户必须重新启动应用程序才能使对配置文件的任何编辑生效。对于大多数用户来说，这永远不会成为问题，但对于喜欢直接编辑配置文件的高级用户来说，这可能会令人沮丧。在基于 UNIX 的操作系统上，可以处理 SIGHUP 信号，该信号已成为重新读取配置文件的可接受触发器。我知道 Windows 没有类似的方法。另一种方法是跟踪配置文件的修改时间，以确定是否应重新读取设置。

# asp.net - ASP.NET 登录控件神秘地停止工作

> ID：637493
> 
> 赞同：0
> 
> 时间：2009-03-12T05:31:09.017
> 
> 标签：asp.net

我正在使用 ASP.NET 登录控件，并且已经在特定站点上成功使用了几年。出乎意料的是，在开发环境中，这个控件已经停止工作，现在让我回到登录页面。

使用源代码控制，我恢复了最近可能是原因但没有运气的更改。我已经单步执行了代码并检查了 e.Authenticated 属性是否正确设置为 true，并且 ReturnUrl 是否在参数上正确指定。

关于在哪里寻找并尝试解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-12T22:10:19.693

我会检查以下...

*   Cookies 仍然设置在浏览器中
*   SSL 设置结合 http 不转发到 https
*   证书问题（旧的、新的、过期的）
*   用户正在验证的域中的更改
*   本质上，检查除您的代码之外的所有内容，它就像您说的那样工作。;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T05:48:17.667

登录后，您是否被重定向到您没有授权的页面？

# java - 小程序在安全阶段挂在 IE 中

> ID：637496
> 
> 赞同：1
> 
> 时间：2009-03-12T05:33:57.810
> 
> 标签：java, security, internet-explorer, applet

小程序在一个签名的 JAR 中。控制台中的最后一行显示：

```
security: Checking if certificate is in Deployment permanent certificate store 
```

CPU和内存使用正常。其他页面元素仍然响应。只是小程序没有显示。

同一页面中有另一个小程序，但它可以工作。

有任何想法吗？

线程转储如下：

```
Dump thread list ...
Group main,ac=15,agc=3,pri=10
    main,5,alive
    AWT-Shutdown,5,alive
    AWT-Windows,6,alive,daemon
    traceMsgQueueThread,5,alive,daemon
    CacheCleanUpThread,5,alive,daemon
    AWT-EventQueue-0,6,alive
    Thread-9,5,alive
Group Plugin Thread Group,ac=3,agc=0,pri=10
    AWT-EventQueue-1,6,alive
    ConsoleWriterThread,6,alive,daemon
    TimerQueue,5,alive,daemon
Group file:/c:/project/lib/-threadGroup,ac=2,agc=0,pri=4
    thread applet-OsApplet,4,alive
    AWT-EventQueue-2,4,alive
Group file:/c:/project/html/-threadGroup,ac=3,agc=0,pri=4
    thread applet-javax.swing.JApplet.class,4,alive
    TimerQueue,4,alive,daemon
    AWT-EventQueue-3,4,alive
Done. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T06:45:23.643

打开小程序控制台（如果您使用的是 Windows，请右键单击任务栏上的 Java 小图标，或者如果您使用的是 Linux，则从浏览器的菜单中选择“查看控制台”）。按“t”进行线程转储。这将为您提供有关插件 JVM 正在做什么的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T09:03:27.617

到达某个地方。当我重新排列我的 HTML 时，Applet 加载正常。应该提到小程序是通过对 document.writeln 调用加载的。现在，执行此操作的脚本标记隐藏在几个 div 和 table 标记下。当我将脚本标签上移到正文标签之后，小程序出现了。

知道可能导致这种情况的任何 IE（或 IE 和 CSS）怪癖吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-17T03:25:57.667

修复。Applet 是相对大小的，但包含 DIV 的大小不明确。当设置 DIV 的 height CSS 属性时，IE 会呈现小程序。

# perl - 如何在 Perl 中修改二进制标量的特定部分？

> ID：637497
> 
> 赞同：2
> 
> 时间：2009-03-12T05:34:21.863
> 
> 标签：perl, string, binary

我采用 select()、sysread()、syswrite() 机制来处理套接字消息，其中消息在被 syswritten 之前被 sysread() 放入 $buffer（二进制）。

现在我想更改消息的两个字节，表示整个消息的长度。首先，我使用以下代码：

```
my $msglen=substr($buffer,0,2); # Get the first two bytes
my $declen=hex($msglen);
$declen += 3;
substr($buffer,0,2,$declen); # change the length 
```

但是，它不能以这种方式工作。如果 $declen 的最终值为 85，那么修改后的 $buffer 将为“0x35 0x35 0x00 0x02...”。我在 $buffer 中插入数字，但最后得到了 ASCII！

我也尝试过这种方式：

```
my $msglen=substr($buffer,0,2); # Get the first two bytes,binary
$msglen += 0b11; # Or $msglen += 3;
my $msgbody=substr($buffer,2); # Get the rest part of message, binary
$buffer=join("", $msglen, $msgbody); 
```

可悲的是，这种方法也失败了。结果如“0x33 0x 0x00 0x02...”我只是想知道为什么两个二进制标量不能合并成一个二进制标量？

你能帮助我吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T06:33:52.003

```
my $msglen=substr($buffer,0,2); # Get the first two bytes
my $number = unpack("S",$msglen);
$number += 3;
my $number_bin = pack("S",$number);
substr($buffer,0,2,$number_bin); # change the length 
```

未经测试，但我认为这就是您要尝试做的...将具有两个字节表示短 int 的字符串转换为实际的 int 对象，然后再返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T07:55:05.660

我找到了另一种可行的方法——使用 vec

```
vec($buffer, 0, 16) += 3; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T05:44:23.790

你不能直接在 Perl 中加入两个二进制缓冲区，你所要做的就是调用[pack](http://perldoc.perl.org/functions/pack.html)来获取一个 ASCII，然后加入它并调用[unpack](http://perldoc.perl.org/functions/unpack.html)来返回。

# algorithm - 确定给定日期/时间是否在两个日期/时间对之间的算法

> ID：637505
> 
> 赞同：1
> 
> 时间：2009-03-12T05:39:21.900
> 
> 标签：algorithm, datetime, math, date, mathematical-optimization

我有一个以不寻常方式存储的一周范围内的日期数组。

日期以这种数字格式存储：12150

从左到右：

第一个数字代表日期：1 = 星期日，2 = 星期一，3 = 星期二，....，7 = 星期六

接下来的两位数字代表 24 小时制中的小时：00 = 午夜，23 = 晚上 11 点

接下来的两位数字代表分钟：00-59

给定输入日期和开始日期和结束日期，我需要知道输入日期是否在开始日期和结束日期之间。

我现在有一个算法，我*认为*它100% 有效，但我不确定。

无论如何，我认为可能有更好更简单的方法来做到这一点，我想知道是否有人知道那个算法是什么。

如果不是这样，如果有人可以仔细检查我的工作并验证它确实适用于 100% 的有效案例，那就太酷了。

我现在拥有的是：

```
if (startDate < inputDate && 
    endDate > inputDate) {
        inRange = yes;    
}
else if (endDate < startDate) {
        if((inputDate + 72359) > startDate &&
          (inputDate + 72359) < endDate) {
          inRange = yes; 
        }
        else if((inputDate + 72359) > startDate &&
               (inputDate + 72359) < (endDate + 72359)) {
          inRange = yes;   
        }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T05:52:37.030

怎么样

```
const int MAX = 72460; // Or anything more than the highest legal value
inRange = (MAX + inputDate - startDate) % MAX < 
          (MAX + endDate - startDate) % MAX; 
```

这当然假设所有日期都格式正确（根据您的规格）。

这解决了开始在结束“之后”的情况。（例如，如果开始是星期三，结束是星期一，则星期五在范围内）

可能需要一秒钟才能看到（这可能不好，因为可读性通常是最重要的）但我认为它确实有效。

这是基本技巧：

```
传奇：

  0：最短时间
  M：最长时间

  S：开始时间
  1,2,3：输入时间测试点
  E：结束时间

SE => 不在范围内
  2 在范围内
  3 > E => 不在范围内

S > E 案例
                        0 米
  原版-1--E----2---S--3--
  加最大值 --------------------1--E----2---S--3--
  减去开始日期-----1--E----2---S--3--      
  % 最大 S--3--1--E----2----

  1 在范围内
  2 > E => 不在范围内
  3 在范围内

```

如果你真的想发疯（而且更难破译）

```
const int MAX = 0x20000; 
const int MASK = 0x1FFFF;
int maxMinusStart = MAX - startDate;
inRange = (maxMinusStart + inputDate) & MASK < 
          (maxMinusStart + endDate) & MASK; 
```

这应该稍微快一点（将模数换成按位和），我们可以这样做，因为 MAX 的值并不重要（只要它超过最大的格式良好的值），我们可以自由选择一个使我们的计算变得容易。

（当然，如果这是你真正需要的，你可以`<`用 a替换）`<=`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T05:56:50.703

该格式的日期存在一些逻辑错误。由于缺少月份和年份信息，您无法知道缺少哪个日历日。例如，50755 可能是 2009 年 3 月 12 日星期四，但也可能正好是一周前，或者提前 18 周。这对您来说永远无法 100% 确定该格式的*任何*日期是否介于*任何*其他 2 个日期之间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T05:58:18.983

在这里，内部的条件`if`永远不会为真，因为`endDate < startDate`：

```
if (endDate < startDate) {
  if((inputDate + 72359) > startDate &&
    (inputDate + 72359) < endDate) {
    // never reached
    inRange = yes; 
  } 
```

以下 if 也不是最优的，因为第一部分始终为真，而第二部分与 相同`inputDate < endDate`：

```
 if((inputDate + 72359) > startDate &&
     (inputDate + 72359) < (endDate + 72359)) 
```

我想你想要这样的东西：

```
if (startDate < endDate)
  inRange = (startDate < inputDate) && (inputDate < endDate);
else
  inRange = (startDate < inputDate) || (inputDate < endDate); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T06:04:51.870

如果你真的想要它在范围内，你应该使用 >= 和 <=

假设我选择这个日期 10000 或 72359，你将如何处理？它是否在范围内？

我也不知道 startDate 和 endDate 的值，因为您没有对其进行初始化，如果我错了，请纠正我，未初始化的变量将以 0 或 null 或 '' 开头

所以我假设 startDate = 10000 和 endDate 72359

顺便说一句，为什么您选择这种数组（作为 int 或字符串值？）为什么第一个值是 day？非日期示例： 010000
-> 日期 1 日 00:00
312359 -> 日期 31 日 23:59

但这取决于你：D

很抱歉，如果我错了，我只在大学上过算法课，那是 5 年前：D

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T06:49:40.013

更好的方法可能是标准化您的数据，将一周中的所有日期值转换为相对于开始日期。像这样的东西：

```
const int dayScale = 10000;  // scale factor for the day of the week

int NormalizeDate(int date, int startDay) 
{
    int day = (date / dayScale) - 1;  // this would be a lot easier if Sunday was 0 
    int sday = startDay - 1;  

    if (day < sday)  
        day = (day + 7 - sday) % 7;

    return ((day+1) * dayScale) + (date % dayScale);
}

int startDay = startDate / dayScale;  // isolate the day of the week

int normalizedStartDate = NormalizeDate(startDate, startDay);
int normalizedEndDate = NormalizeDate(endDate, startDay);
int normalizedInputDate = NormalizeDate(inputDate, startDay);

inRange = normalizedInputDate >= normalizedStartDate && 
          normalizedInputDate <= normalizedEndDate; 
```

我很确定这将按书面规定工作。无论如何，这个概念比多重比较更清晰。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-23T14:54:35.960

我找到的最简单的解决方案是：表示 x 你的通用时间和 S，E 分别是开始和结束时间（0 < S，E < T）：

```
f(x) = [(x-S) * (x-E) * (E-S) < 0] 
```

如果 x 在开始时间和结束时间之间，此函数返回 TRUE，否则返回 FALSE。它还将处理大于结束时间的开始时间（即您从 20:00 开始工作并在 04:00 结束，23:13 将返回 TRUE）

我必须说，考虑到乘法，它在速度方面不是最有效的，但它绝对是最紧凑的（恕我直言）

编辑：我找到了一个更优雅、更有效的解决方案：

```
f(x) = (x<S) XOR (x<E) XOR (E<S) 
```

您可以用“不同”运算符（ != ）替换 XOR

我解释一下：第一个公式来自考虑关系不等式研究：如果 S < E：

```
...............S.....E..........
(x-S)----------+++++++++++++++++
(x-E)----------------+++++++++++
(E-S)+++++++++++++++++++++++++++
total++++++++++------+++++++++++ 
```

因此，如果 x 在 S 和 E 之间，则总数为负

如果 S > E：

```
...............E.....S..........
(x-S)----------------+++++++++++
(x-E)----------+++++++++++++++++
(E-S)---------------------------
total----------++++++----------- 
```

因此，如果 x 大于 S 或小于 E，则总数为负

为了达到最终方程，您将第一个公式分解为 3 项：

```
(x-S)<0 => x<S
(x-E)<0 => x<E
(E-S)<0 => E<S 
```

这些项的乘积只有当它们都为负（真、真、真）或只有一个为负而另一个为正（真、假、假，但顺序无关紧要）时才为负，因此问题可以解决通过

```
f(x) = (x<S) != (x<E) != (E<S) 
```

这些解决方案可以应用于任何与周期系统类似的问题，例如检查角度 x 是否在两个角度 S 和 E 形成的弧内。只要确保所有变量都在 0 和系统的周期之间 ( 2PI 表示圆弧，24h 表示小时，24*60*60 表示一天中的秒数......等等）

# c# - C# 清除线程主体

> ID：637510
> 
> 赞同：10
> 
> 时间：2009-03-12T05:46:22.553
> 
> 标签：c#, wpf

如何清除c#中的线程主体。

我有一个后台线程

```
Membership.ValidateUser(username, password); 
```

然后将生成的 Principal 复制回主线程

```
AppDomain.CurrentDomain.SetThreadPrincipal(Thread.CurrentPrincipal); 
```

这很好用。但是，如果我注销我想清除主体，如果我将它设置为 null 它什么也不做 Thread.CurrentPrincipal = null; 如果我尝试通过重新设置它

```
AppDomain.CurrentDomain.SetThreadPrincipal(Thread.CurrentPrincipal); 
```

我得到错误

```
Default principal object cannot be set twice. 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T07:05:41.380

我认为您不能在不关闭 AppDomain 并重新创建它的情况下重置主体。调用 SetThreadPrincipal 只能获得一次机会。

假设您使用的是您在 ValidateUser 之后创建的自定义主体对象；您可能可以在您的主体上放置一个“注销”方法，将其内部状态重置为未经身份验证的用户。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-02-14T23:13:05.137

解决这个问题的技巧是创建一个外观主体并将其分配给线程。然后在它后面，您可以将当前用户切换为新用户。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T11:10:29.327

如果您只想为主线程设置主体，则将引用传递给后台线程，然后使用 CurrentPrincipal 属性设置主体。

例如 mainThead.CurrentPrincipal=Thread.CurrentPrincipal。

完成后将其设置为原始主体

# asp.net-mvc - 在 MVC 中传递参数

> ID：637519
> 
> 赞同：0
> 
> 时间：2009-03-12T05:50:34.447
> 
> 标签：asp.net-mvc, parameters

页面中有两种形式，第一种用于搜索，另一种用于删除....

```
<table><tr><td>
<% using(Html.BeginForm("ViewList","ControllerName",
[values],FormMethod.Post,new{id="viewListForm"}))
{ %>
    Name:    <%=Html.TextBox("Name", "[value]", new { maxlength = "250" })%>
    Location: <%=Html.TextBox("Location", "[Value]", new { maxlength = "250" })%>
    <input type="submit" id="Search" name="Search" value="Search" />

<% } %>
</td></tr>
<tr><td>
<% using(Html.BeginForm("DeleteList","ControllerName",
         new { name=?,location=? },[values],FormMethod.Post,
          new{id="deleteListForm"}))
{ %>
   [here the code for all items displayed in a table.]

  <input type="submit" id="Delete" name="Delete" value="Delete" />

When delete buttom pressed i need to pass two parameters ie name
and location. The values of name and location are in the above viewListForm.
How i take this value from the viewListForm at run time ?

<% } %>
</td></tr><table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T05:54:05.373

使用 javascript 填充隐藏的输入。

或者使用javascript动态改变搜索表单的动作。

或者例如在 jQuery 中动态创建一个表单并提交它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T06:05:45.860

您将需要一个以 FormCollection 作为参数的控制器操作

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult ActionName(FormCollection collection)
{
    // you can pull key value pair from the posted collection
    string formValue = collection["InputId"]
} 
```

# c++ - 连接 C++ 服务器时，flash 套接字发送错误数据

> ID：637527
> 
> 赞同：0
> 
> 时间：2009-03-12T05:55:06.277
> 
> 标签：c++, sockets, flashdevelop

我用 c++ 写了一个聊天服务器，用 flex3 写了一个 flash 客户端。
他们之间交换的消息就像 [message_len+messagebody]
在我的所有者 windows xp 系统上打开闪光灯，它工作正常，发送和接收的消息是正确的。
但是当我将flash放在red hat 5的apache服务器上时，尝试在网络浏览器中打开它，flash socket发送错误消息，消息无法识别。
起初，我想可能是字节序不一样，起初，我使用littlendian。所以，我尝试了 bigendian，但这次它甚至在本地 xp 系统上也不起作用。从c++服务器，我可以看到这次本地和远程flash，它有相同的数据，但与发送的flash不一样，我认为是因为bigendian。

所以情况是这样的：我使用littleendian，flash客户端在本地xp系统上运行良好，即7 explorer。但是如果我把它放在red hat 5的apache服务器上就不行了。我也尝试了 ror 的杂种服务器，它的工作方式相同....如果我从网络浏览器保存 flash，我发现文件大小与本地 flash 文件大小不相等；

如果我使用 bigendian，则 flash 客户端在本地或远程都无法正常工作……原因应该是 bigendian 不适用于 radhat5。

那么，有人可以帮助我吗？多谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T06:17:04.477

It all depends on how you read the message length from the socket. If it's not a little/big endian issue, maybe the server is a 64-bit system and you try to read 64-bit (=8 byte) from the socket as the message length, while your flash on your 32-bit system just sends 32 bit (=4 byte)? That would lead to confusion...

Does the server read a crazily large message length (>5.000.000.000)? This would hint to a 64-bit number. If the message length read by the server is smaller, but still much too large (like 1.000.000.000 or 1.000.000) it's probably an endian issue. If the message size is about correct, the problem is due to something else...

# .net - 远程事件处理：指定可用的侦听端口范围

> ID：637532
> 
> 赞同：3
> 
> 时间：2009-03-12T06:00:41.397
> 
> 标签：.net, remoting, port

我有一个使用 .NET 远程处理的客户端-服务器应用程序。

服务器通过 .NET 事件向客户端发送更新事件。（这对于开始工作来说是一件大事，但它已经部署了七个月而没有出现任何问题。）

为了能够监听事件，客户端必须创建一个监听通道。我的 app.config 文件指定端口“0”，意思是“任何可用端口”。

一切都很好，但现在客户的网络管理员正试图收紧防火墙。他们问我们是否可以使用固定端口。我回答说这是可能的，但是您将无法在同一台机器上运行多个客户端。您也不能让多个用户使用来自同一 Citrix 服务器的应用程序。（如果我错了请纠正我）

现在他们问我是否可以指定客户端应用程序可以选择的端口范围。

有谁知道这样做的直接方法：让客户端在一个范围内的第一个可用端口上创建一个监听通道？

# .net - 重复的 LINQ to SQL 实体/记录？

> ID：637535
> 
> 赞同：13
> 
> 时间：2009-03-12T06:04:01.497
> 
> 标签：.net, linq-to-sql

复制 [克隆] LINQ to SQL 实体以在数据库中生成新记录的最佳实践是什么？

上下文是我希望为管理员网格中的记录创建一个重复功能。网站，在尝试了一些事情和显而易见的之后，读取数据，更改 ID = 0，更改名称，`submitChanges()`然后遇到异常，哈哈。我想我可以停下来问问专家。

我希望首先阅读记录，通过以“Copy Of”为前缀来更改名称，然后另存为新记录。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-07-16T01:04:29.090

如果您从 DataContext 加载实体并将 ObjectTrackingEnabled 设置为 false，那么您可以将此实体作为新实体插入另一个 DataContext

```
DataContext db1 = new DataContext();
DataContext db2 = new DataContext();

db2.ObjectTrackingEnabled = false;

MyEntity entToClone = db2.Single(e => e.Id == id);

// ... change some data if it is needed

db1.MyEntities.InsertOnSubmit(entToClone);
db1.SubmitChanges(); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-12T06:20:10.833

创建一个新实例，然后使用 linq 映射类和反射来复制成员值。

例如

```
public static void CopyDataMembers(this DataContext dc,
                                   object sourceEntity,
                                   object targetEntity)
{
    //get entity members
    IEnumerable<MetaDataMember> dataMembers = 
         from mem in dc.Mapping.GetTable(sourceEntity.GetType())
                                 .RowType.DataMembers
         where mem.IsAssociation == false
         select mem;

    //go through the list of members and compare values
    foreach (MetaDataMember mem in dataMembers)
    {
       object originalValue = mem.StorageAccessor.GetBoxedValue(targetEntity);
       object newValue = mem.StorageAccessor.GetBoxedValue(sourceEntity);

        //check if the value has changed
        if (newValue == null && originalValue != null 
            || newValue != null && !newValue.Equals(originalValue))
        {
            //use reflection to update the target
            System.Reflection.PropertyInfo propInfo = 
                targetEntity.GetType().GetProperty(mem.Name);

            propInfo.SetValue(targetEntity, 
                              propInfo.GetValue(sourceEntity, null), 
                              null);

            // setboxedvalue bypasses change tracking - otherwise 
            // mem.StorageAccessor.SetBoxedValue(ref targetEntity, newValue);
            // could be used instead of reflection
        }
    }
} 
```

...或者您可以使用 DataContractSerializer 克隆它：

```
internal static T CloneEntity<T>(T originalEntity) where T : someentitybaseclass
{
    Type entityType = typeof(T);

    DataContractSerializer ser =
        new DataContractSerializer(entityType);

    using (MemoryStream ms = new MemoryStream())
    {
        ser.WriteObject(ms, originalEntity);
        ms.Position = 0;
        return (T)ser.ReadObject(ms);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-06-08T10:16:15.213

我遇到了同样的问题，Kristofer 的代码运行良好，非常感谢！

如果有人感兴趣，我稍微修改了他的代码，以便它不接受目标实体作为参数，而是创建一个新对象并返回它。此外，我已将`sourceEntity`参数设为通用：

```
 public static T CloneEntity<T>(this DataContext dc, T sourceEntity) where T:class, new()
 {
     var targetEntity = new T();
     //... original method code...
     return targetEntity;
 } 
```

然后我可以执行以下操作：

```
dataContext.MyEntities.Attach(dataContext.CloneEntity(theEntity)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-26T13:49:10.383

这是他与 Peter K. 相同的解决方案，用于 VB.Net 中的 Linq-to-Sql 整体克隆。

```
 Dim DC As New DataContext
    Dim DCI As New DataContext
    DC.ObjectTrackingEnabled = False

        Dim RGF As sf_RuleGroup = (From G In DC.sf_RuleGroups _
                                  Where G.RuleGroupID = CInt(e.CommandArgument) _
                                  Select G).First()
        DCI.sf_RuleGroups.InsertOnSubmit(RGF)
        DCI.SubmitChanges() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-07T15:04:46.153

在实体框架 6 中，您可以执行此操作

```
Dim WorkoutNew As New Workout 'create a record
ff7db.Workouts.Add(WorkoutNew) 'add it to the table (workout)
ff7db.Entry(WorkoutNew).CurrentValues.SetValues(WorkoutsPost) ' update its values with a class with the same properties 
```

# javascript - Javascript for image captcha in html

> ID：637543
> 
> 赞同：1
> 
> 时间：2009-03-12T06:07:28.070
> 
> 标签：javascript, html

I want javascript for Image captcha in html code.
Whcih generates images dynamically and match the given character with image characters. Before entering into the new page it should have to check whether both are same or not
I want to create it in my own, How i can achieve it?

Thanks in Advance,
Praveen J

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T15:44:22.213

> 我想要 html 代码中的图像验证码的 javascript。Whcih 动态生成图像并将给定字符与图像字符匹配。在进入新页面之前应该检查两者是否相同

虽然您可以想象将一些形状写入 <canvas>、SVG 或 VML 元素——甚至（在非 IE 浏览器上）使用从像素值创建的“数据：”URL 创建图像——但没有意义。

任何完全客户端的验证码方法都已经受到影响，因为它需要知道“正确”的答案才能进行检查。攻击者可以自己运行 JavaScript 来找出答案。或者只是关闭 JavaScript 以避免检查。

要进行验证码，您需要攻击者无权访问的服务器端脚本来完成工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T06:08:49.520

Use [recaptcha](http://recaptcha.net/). It's what stackoverflow uses!

# iphone - 当前图形是否仅在视图的 drawRect: 中可用？

> ID：637550
> 
> 赞同：2
> 
> 时间：2009-03-12T06:14:10.550
> 
> 标签：iphone, graphics, uiview

我尝试在 drawRect 以外的其他地方调用 UIGraphicsGetCurrentContext()。它给了我一个NULL。我只能在 UIView 的 drawRect: 中获取当前上下文是真的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T06:31:05.690

是的，在 drawRect 之外，默认上下文是 nil。在调用 drawRect 之前，视图会将其上下文压入堆栈，并在 drawRect 结束后将其弹出。

# javascript - javascript中的嵌套函数内存使用情况

> ID：637552
> 
> 赞同：3
> 
> 时间：2009-03-12T06:14:20.847
> 
> 标签：javascript, memory, closures

我有点理解 javascript 中的闭包，但我不确定它如何处理嵌套函数。例如：

```
var a = function(o) {
    o.someFunction(function(x) {
        // do stuff
    });
} 
```

我知道每次调用 function 时都会创建一个新的闭包`a`，但是该闭包是否还包括传递给的匿名函数的新实例`someFunction`？如果我改为 ff 会更好：

```
var b = function(x) { /* do stuff */ }
var a = function(o) {
    o.someFunction(b);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T06:21:21.703

在您的第一个示例中，每次调用 a 时，都会定义一个匿名函数并将其传递给`someFunction()`. 这比你在第二个例子中得到的更昂贵，这是更有效的方法，因为函数（现在称为 b）只被定义一次。

几个月前我问了一个类似的问题：它也可能对你有帮助。[使用匿名函数会影响性能吗？](https://stackoverflow.com/questions/80802/does-use-of-anonymous-functions-affect-performance)

# api - Export contact list from Gmail, Hotmail, Yahoo, LinkedIn, Facebook

> ID：637560
> 
> 赞同：0
> 
> 时间：2009-03-12T06:21:58.707
> 
> 标签：api, facebook, hotmail, linkedin

I'm looking for library/API to retrieve contact list (emails address to which user had sent mail to, regardless whether user had explicitly added it as contact). Does anybody know such library/API available there?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-12-24T12:52:05.843

请看一下socialauth。这个 Java 库将帮助您从大多数网络中获取联系人。

[http://code.google.com/p/socialauth](http://code.google.com/p/socialauth)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T16:55:11.437

看： http: [//openinviter.com/index.php](http://openinviter.com/index.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-10T05:25:24.523

如果您使用 php - 您可能希望尝试[http://openinviter.com](http://openinviter.com) - 它是免费的，并且支持几乎所有主要的社交网站和邮件站点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T06:41:36.413

I don't think that data would ever be held outside the email headers. What you want is some way to find all the unique addresses in the recipent field of all sent mail items.

For example in Google mail - you could use this project, the [Gmail Agent API](http://www.johnvey.com/features/gmailapi/), to retrieve all the sent item headers. You would then just need to extract the relevant data from them.

I'm sure this technique is possible is for some of the other providers you mention. The [Yahoo Api](http://developer.yahoo.com/mail/code/) for example looks to provide everything you need to do this.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T16:58:48.493

看看 Octazen：[http](http://octazen.com/) ://octazen.com/ 。他们的软件处理各种网络邮件系统和社交网络。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T14:50:38.570

为了从 Facebook 中获取（一些）详细信息，我刚刚从[http://brad.livejournal.com/2398409.html](http://brad.livejournal.com/2398409.html)找到（并使用了！）Greasemonkey-script/webservice以至少从中提取名称和一些详细信息Facebook 到 Google 联系人，可以通过其他方式获取，例如[Gmail 联系人 API](http://code.google.com/apis/contacts/)

# eclipse-plugin - Eclipse RCP: Is it possible to shift the fields up without redrawing?

> ID：637562
> 
> 赞同：0
> 
> 时间：2009-03-12T06:23:21.137
> 
> 标签：eclipse-plugin, eclipse-rcp

In my editor, I have a composite containing a label control right at the top which flashes informative message in red colour whenever the user enters erroneous inputs in any of the below lying fields. The text keeps changing dynamically depending on user's input. I am able to achieve the effect of displaying red coloured text on erroneous inputs and displaying nothing in the label for correct inputs.

But, I want that when there is no error to display in the label composite, the rest of the below fields shift up in display. And when there is error to display, the error should appear in it's place(at the top of all other fields) pushing the other fields down.

Is there a way to achieve this effect without redrawing all the controls again?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-03T19:45:36.363

是的，打电话`layout (true)`给家长。

例如，我有一个视图，顶部有一个搜索栏，可以切换其可见性。我有一种创建搜索组合的方法和一种删除它的方法：

```
private void createNameSearchBar () {
    mySearchControl = new CardSearchControl (myViewComposite, SWT.NONE);
    mySearchControl.setSearchListener (this);
}

private void disposeNameSearchBar () {
    mySearchControl.dispose ();
    mySearchControl = null;
}

private CardSearchControl mySearchControl = null;
private Composite myViewComposite;
private boolean mySearchBarState; 
```

要隐藏或显示搜索栏控件，我调用此方法（myViewComposite 是拥有搜索栏和所有其他控件的顶级控件）：

```
public void setSearchBarState (boolean show)  {
    mySearchBarState = show;

    if (myViewComposite == null  ||  myViewComposite.isDisposed ())
        return; // no work to do

    if (mySearchBarState  &&  mySearchControl == null)  {
        createNameSearchBar ();
        mySearchControl.moveAbove (null);
        myViewComposite.layout (true);
    }  else if (!mySearchBarState  &&  mySearchControl != null)  {
        disposeNameSearchBar ();
        myViewComposite.layout (true);
    }
} 
```

# c++ - Why do I get a segmentation fault (core dumped) when I try to allocate a 4D array?

> ID：637564
> 
> 赞同：0
> 
> 时间：2009-03-12T06:25:59.180
> 
> 标签：c++, dynamic, matrix, segmentation-fault

I'm trying to allocate a large 4D matrix but I want to do it dynamically. When I just create the static matrix everything works fine so I know I have enough memory for now. However when I try and implement the same thing dynamically it breaks whenever I enter the third dimension and I need to get to a fourth! Can anyone tell me why this code does not work?

```
#include <iostream>

using namespace std;

static const int time1 = 7;
static const int tlat = 15;
static const int tlon = 17;
static const int outlev = 3;  

int main(void)
{
    //allocate four dimensional dataIn
    int ****dataIn;
    dataIn = new int ***[time1];
    if (dataIn == NULL) { return 1; }

    for(int i = 0 ; i < time1 ; i++) { 
        dataIn[i] = new int **[tlat];
        if (dataIn[i] == NULL) { return 1; }

        for(int j = 0 ; j < tlat ; j++) {
            dataIn[i][j] = new int *[tlon];
            if (dataIn[i][j] == NULL) { return 1; }

            for(int k = 0 ; k < tlon ; k++) {
                dataIn[i][j][k] = new int[outlev];
                if (dataIn[i][j][k] == NULL) { return 1; }
            }
        }
    }
    //there is more code that happens here to add values to dataIn
    //and eventually output it but I know all of that works        
    return 0;
} 
```

I have tried many different variations on this code, and even used malloc instead of new, but I cannot get it working. Any help will be greatly appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T06:36:32.713

Have you run this in a debugger? To my eyes the code looks fine, but a debugger will tell you where it's crashing which alone may be enough to help you fix it

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T06:47:18.193

You're probably best off allocating all the memory in a flat array and then calculating the indices yourself. Wrapping the whole thing in an object for encapsulation.

```
class Matrix {
private:
        int* data;        
        int[] sizes;
        int nDimensions;

public:
        // allocates the data pointer and copies the other parameters
        Matrix(int[] sizes, int nDimensions); 

        // frees the data and sizes arrays
        ~Matrix();

        // calculates the cell position and returns it
        int getCell(int[] coordinates);

        // calcultes the cell position and sets its value
        void setCell(int[] coordinates, int value);

private:
        // used by getCell and setCell, calculates the cell's 
        // location in the data array
        size_t calculateCellPosition(int[] coordinates);
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T07:39:56.337

它在我的 Linux 机器上编译并运行良好。

顺便说一句，对于标准 C++，new 在无法分配内存时会抛出 std::bad_alloc 异常（而不是返回 NULL）。因此，捕获该异常而不是测试 NULL 指针可能是值得的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T08:12:46.960

正如 cmeerw 所指出的，在 std-c++ 中不需要针对 NULL 或 0 进行测试。

如果您可以在获得 segv 的确切位置添加评论，将会有所帮助。

另外：您使用的是哪个编译器以及在哪个操作系统上？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T08:18:17.710

查看[boost::multiarray](http://www.boost.org/doc/libs/1_38_0/libs/multi_array/doc/index.html)，它完全符合您的要求，除了通过仅执行单个堆分配更有效。

# python - 姜戈与乘客

> ID：637565
> 
> 赞同：8
> 
> 时间：2009-03-12T06:26:51.800
> 
> 标签：python, django, passenger, dreamhost

我正在尝试按照[此处的说明在 Dreamhost 上与Passenger 一起使用一个简单的Django 项目](http://www.soasi.com/2008/09/django-10-on-dreamhost-with-passenger-mod_rails/)

我已经完全按照该教程设置了目录，并确保 django 在我的 PYTHONPATH 上（我可以运行 python 并输入“import django”而不会出现任何错误）。但是，当我尝试在浏览器中访问该 URL 时，我收到以下消息：“导入您的乘客wsgi.py 时发生错误”。这是我的passenger_wsgi.py 文件的内容：

```
import sys, os
sys.path.append("/path/to/web/root/") # I used the actual path in my file
os.environ['DJANGO_SETTINGS_MODULE'] = ‘myproject.settings’
import django.core.handlers.wsgi
application = django.core.handlers.wsgi.WSGIHandler() 
```

但是，当我将以下简单的“Hello World”应用程序放入passenger_wsgi.py 时，它按预期工作，表明Passenger 设置正确：

```
def application(environ, start_response):
    write = start_response('200 OK', [('Content-type', 'text/plain')])
    return ["Hello, world!"] 
```

我错过了什么？似乎是一些配置问题。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-12T08:36:12.240

那些花哨的引号也在你的代码中吗？

```
os.environ['DJANGO_SETTINGS_MODULE'] = ‘myproject.settings’
                                       ^                  ^ 
```

如果是这样，请先修复它们，因为它们会导致语法错误。

# windows - 您不认为编写安装程序可以/应该更简单吗？

> ID：637571
> 
> 赞同：7
> 
> 时间：2009-03-12T06:28:06.960
> 
> 标签：windows, installation

我最近不得不与一个安装项目（它使用最流行的产品来创建安装：InstallShield）进行斗争，以使其适用于产品升级（从一个版本迁移到另一个版本）。最后结果证明我需要使用一个长包代码但正在使用其他一些。它浪费了我的 8 个小时（测试和调试安装程序很痛苦）。

现在，如果我想一想，一旦您完成了编码的所有困难部分，您所要做的就是将正确的应用程序、库复制到目标计算机，并且用户只需运行它。时期。这个看似简单的任务通常会变得很棘手，而“被关闭以完成日期”则变得更加困难。

1.  您不认为在本来应该更简单的 Windows 上部署产品变得非常困难吗？（或者安装程序真的值得这么多关注，我只是为此而疯狂？）

2.  你有没有使用过更简单的部署方案，例如“将文件夹复制到任何你喜欢的地方并运行exe。当你想删除它时，只需删除文件夹！”？它是否有效并使事情变得更简单？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-12T08:49:14.080

为了客户的利益，您需要与 Windows 安装程序搏斗，这很痛苦。否则你将需要做更多的工作

1.  处理由于某种原因在安装过程中发生错误的情况。下一步你要怎么做？
2.  处理安全等问题。如果安装用户没有特定文件夹/注册表项的权限怎么办？
3.  安装后正确清理
4.  补丁和补丁管理
5.  执行附加任务——注册 COM 对象、创建数据库、创建快捷方式、创建卸载快照等等
6.  安装先决条件
7.  让用户选择要安装的功能

您自己解决所有这些问题的自定义脚本最终会成为比安装本身更大的问题！

我建议您查看[Wix](http://wix.sourceforge.net/)。这不完全是儿戏，但它可以完成工作。如果您将 Votive 安装为 Visual Studio，则添加 intellisense 以帮助您正确构建标签。使用帮助文件，您可以创建功能非常灵活的安装

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-13T04:37:22.357

我认为您不会在这里看到太多分歧，尤其是在 MSI 方面。我认为要记住的一件事是观察现在许多程序使用 MSI 文件的方式。仅由于 Windows Installer 的设计方式，显示 UI 对话框和使用 MSI 进行复杂的配置选择非常弱，所以我注意到很多程序被分成一堆婴儿 MSI，这些 MSI 由一个使用最小 UI 安装的父设置程序。SQL Server 2008 安装向导会执行此操作。UPS WorldShip 就是这样做的。Paint.NET 也这样做——您看到的向导是一个 Windows 窗体应用程序，它会`msiexec`自行启动（您可以看到 Windows Installer 的最小 UI 弹出在白色向导窗口的顶部），并传递任何配置参数作为`msiexec`.

出现这种情况的一个常见场景是有人负责为具有服务器和客户端对应项的应用程序构建安装程序。如果用户选择服务器选项，那么他们可能希望也可能不希望安装新数据库，这意味着安装 SQL Server。但是您不能在自己安装的过程中只安装 SQL Server，因为 Windows Installer 不允许您这样做。因此，一种常见的解决方案是编写一个显示向导的应用程序，该向导允许用户配置所有设置选项，然后您的应用程序会根据 SQL Server、服务器应用程序和客户端应用程序的需要启动 MSI 文件。用户界面模式；基本上，完全避开 Windows Installer 的“功能”方面并将其提升到 MSI 级别。4.5' s 多包安装似乎是朝着这个方向迈进了一步。如果您还需要在安装过程中循环输入来自第三方的非 MSI 安装程序，例如为某些奇怪的销售点打印机安装打印机驱动程序，这种格式也特别有用。

我也同意 Windows Installer 缺乏对常见部署方案的内置支持。它适用于 setup 不是 XCOPY 的情况，但他们似乎忽略了 setup 通常不仅仅是“文件 + 快捷方式 + 注册表项”这一事实。没有用于设置 IIS 网站、注册证书、创建和更新数据库、将程序集添加到 GAC 等的内置操作。我猜他们认为其中一些应该在第一次运行时发生，而不是作为安装的事务部分。在十年的大部分时间里，免费提供的工具和文档一直很糟糕——完全糟糕。WiX 项目和 DTF（让您最终可以使用托管代码自定义操作）在很大程度上解决了这两个问题，这就是为什么我们

我也有过同样的经历。当您陷入“天哪，我想我也必须成为这方面的专家”的兔子洞时，安装会很快占用您的*时间*。我支持这样的想法，即最好在项目早期解决它，并将其作为构建过程的一部分进行维护。这样，您可以帮助避免开发实际上可卸载产品的情况。（Trac 曾经是这方面的一个例子，它需要追踪奇怪 Python 库的特定版本。）

（我可以继续讨论 Windows Installer 有时如何决定使用我的慢速外部 USB 硬盘驱动器作为解压缩文件的地方，它似乎如何在安装了大量 MSI 的计算机上连续几分钟无所事事他们，以及进度条如何在一次安装期间重置自己无数次是我见过的最愚蠢的事情，但我会把这些咆哮留到另一天。=）

我的两分钱；请注意，我对 Windows Installer 的了解确实足以造成损害，但这是我的评估来自一个试图使用它的小型企业开发人员。祝你好运！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T06:36:30.640

好吧，如果您首先构建安装程序，使其成为构建系统的一部分，并让它与您的项目一起成长，那么它会容易得多。

我同意，Windows 安装程序让我发疯。但是有很多情况是 xcopy 无法解决的。有时您想为多个用户安装，而不仅仅是当前用户。有时您必须注册 COM 对象。有时您必须对系统进行大量更改，例如注册服务以在启动时运行、连接到网络服务器等。有时您的用户无法使用命令提示符。当事情中途失败时，你总是希望能够将整个事情重新定位。

整个 MSI 数据库方法是最好的方法吗？我不知道。我宁愿钉钉子也不愿写另一行 WiX 代码？大概。但是您必须承认，它可以很好地完成您可能想要的一切。当它不存在时，总是有 CustomAction 选项。

真的，我想看到的是更好的文档（真的，什么是 50 型动作？给它起个名字怎么样？）和更多易于篡改的模板。

WiX 用户组别名在回答问题方面做得很好。

你应该阅读 RobMen 的[博客](http://robmensching.com/blog)。他很好地解释了为什么事情是这样的。他对设置问题做了很多思考（比任何人都应该思考的多）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T06:31:12.680

你看过 NSIS：[http](http://en.wikipedia.org/wiki/Nullsoft_Scriptable_Install_System) ://en.wikipedia.org/wiki/Nullsoft_Scriptable_Install_System吗？

1：是，2：不是

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-13T03:40:02.010

就个人而言，我大多同意@Conrad 和@John Saunders。我很久以前在我的[旧博客](http://blogs.msdn.com/robmen/archive/2004/05/16/132928.aspx)上写过这个话题。我认为@jeffamaphone 对 Windows Installer 的复杂性（以及我对设置的过度关注，一般来说）有一点看法，但我相信 Windows Installer 仍然是在 Windows 上安装的最佳全能选项。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-12T08:17:31.863

“一旦你完成了编码的所有困难部分”，如果你所有的辛勤工作都没有安装，你就没有做任何事情。几乎从第一天开始，几乎每晚的每晚构建都需要构建和测试安装程序。您需要测试安装程序是否可以构建和运行，并且您需要验证安装。

否则，谁会*在乎*你已经完成了多少艰苦的编码工作——如果没有安装，没有人会看到你的工作！

请注意，这也适用于 XCOPY。

另一件事：如果他们不测试您的安装程序安装的内容，您的 QA 测试是什么？您必须测试客户会得到什么！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T06:33:58.850

出于您所说的确切原因，我们已经完成了内部发布，由开发团队通过复制所需文件来处理，然后使用脚本和我们自己的实用程序完成其余的设置。

但是，对于最终用户，您必须拥有某种手持向导，我在 VS 中使用了 MS 安装程序，发现它令人困惑且笨拙。在那次经历之后，我通过让其他人完成安装步骤来避免痛苦。谁能推荐一个好的.Net安装程序？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T06:35:14.883

我使用 Installshield，如果您不想做任何太花哨的事情（我为什么要这样做），那么它非常简单 - 设置初始设置，选择文件，设置快捷方式并创建 setup.exe。

我在代码中处理的所有未来更新 - 对用户来说更方便

# ruby-on-rails - 覆盖插件内定义的模型的最佳方法是什么？

> ID：637573
> 
> 赞同：2
> 
> 时间：2009-03-12T06:29:27.503
> 
> 标签：ruby-on-rails

我想向插件内定义的模型添加验证、方法等。最好的方法是什么？将模型文件复制到 app/models 目录是否安全？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T07:26:58.927

您总是可以通过这种方式进行猴子修补，而不必触摸实际的插件。例如。

```
 class YourModel
         validate_uniqueness_of :some_field
      end 
```

这个补丁可以作为插件本身编写，也可以在使用前需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T18:21:39.380

如果插件在[github](http://github.com)上，您可能需要考虑分叉并添加更改。

# iphone - magnifying moving images

> ID：637574
> 
> 赞同：-1
> 
> 时间：2009-03-12T06:30:07.720
> 
> 标签：iphone, objective-c, cocoa-touch

im developing a 2d game on iphone in which i want to maginify the views on the screen to give the effect that the user is looking through the sniper whenever the user taps the screen.. i am required to show that the objects which the player wants to shoot should be moving...so im incremeting their position as well as increasing their size... so i want this magnified image to show the updated positions of the moved objects at runtime to give the effect that the user is looking through the snpier... scaling the images didnt help me cause it slowed my application a llot as the objects position is updated every 0.01 sec... please help

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T06:43:56.923

Is it a 2d game, or are you using OpenGL ES? If the latter, you can always render your scene to a texture and use the hardware to scale that for you. That shouldn't slow down the game too much... If 2d, it's always faster to scale one single image than a lot of individual objects, so here it also may be beneficial to render to an image first, and later scale and draw it on the screen.

# sql - how to access table across multiple data server

> ID：637575
> 
> 赞同：2
> 
> 时间：2009-03-12T06:30:25.240
> 
> 标签：sql, sybase

I have two Sysbase servers , server1 and server2 . I have a stored procedure declared and running on server1\. In that SP i want to access table from server2\. How can i do that? Also my both instances are running in a UNIX box

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-12T17:32:54.090

[您可以这样做，在Sybase 信息中心](http://infocenter.sybase.com)阅读有关“**代理表**”的更多信息（搜索：create proxy_table 语句）Afaik，还必须声明远程服务器。我认为它的记录很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-12T17:43:35.640

首先，在具有存储过程的数据库中创建一个“远程服务器”。
您需要告诉它“服务器类型”是什么以及如何连接（例如 ODBC），然后在连接信息中，您可以简单地输入 DSN 名称。

现在，您可以创建代理表来引用其他服务器中的表。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-12T06:49:15.570

Try using the four part name. See here: [http://www.dbforums.com/sybase/1001475-call-sql-server-stored-proc-sybase.html](http://www.dbforums.com/sybase/1001475-call-sql-server-stored-proc-sybase.html)

# sql - 如何连接一个表中的所有列

> ID：637580
> 
> 赞同：-3
> 
> 时间：2009-03-12T06:33:20.600
> 
> 标签：sql, sql-server, tsql

我试过这样做，但失败了。

```
SELECT table2.ID, table1.* FROM table2
LEFT JOIN table1 ON table1.ID = table2.table1ID 
```

如何从表中选择所有列？

编辑：上述查询中没有错误。我不知道是什么导致了错误，但代码现在可以工作了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T06:36:43.710

您有字段名称冲突，因为两个表都有 ID 字段。你必须

```
 SELECT table2.ID as t2_id, table1.* FROM table2
LEFT JOIN table1 ON table1.ID = table2.table1ID 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T18:31:39.380

你所拥有的在语法上是正确的，你所说的失败是什么意思？您收到错误消息还是没有得到您想要的结果？（顺便说一句，选择 * 是一种不好的做法，只返回您需要的列。在这种情况下，您不需要所有列，因为 table1 中的 id 字段将具有与其连接的文件 din table 2 完全相同的数据)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T06:44:39.947

```
 SELECT t2.ID, t1.* FROM table2 t2
LEFT JOIN table1 t1 ON t1.ID = t2.table1ID 
```

这适用于 sql 2000+

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-24T01:11:54.583

如果我在一个已定义 @Table 数据类型的存储过程中工作，则使用 select table.* 没有问题，特别是如果我将它用于最后的输出 SELECT。所以在这种情况下，关于生产服务器和网络流量的评论是没有意义的，因为整个存储过程都是在内存中执行的。在这种情况下， select.* 只是返回所有提前定义的列。

# asp.net - IIS 上的 REST

> ID：637590
> 
> 赞同：10
> 
> 时间：2009-03-12T06:40:23.047
> 
> 标签：asp.net, .net, rest, iis

我想知道有多少使用 Microsoft 开发堆栈（IIS 和/或 ASP.NET）的人实际上在使用 REST？如果是这样，正在使用什么形式的休息？

REST 可以以无数种方式进行分类，但出于本问题的目的，我将其分类如下：

1.  彻底 REST：使用所有 HTTP 方法 PUT/POST/GET/DELETE
2.  中等 REST：使用 GET/POST
3.  REST Hybrid：仅使用 GET 或 POST HTTP 方法，但遵循 RESTful 可寻址性和状态原则。

在我教的一堂课中，我们一直在尝试在 IIS 上实现“完全 RESTful”的服务，但我们在实现 PUT 方法时遇到了困难。关于在 IIS 上实现 PUT 似乎没有太多讨论，所以我想知道有多少人实际上在使用完整的 REST？你在使用 REST 吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-19T08:28:02.160

我参与了一个在 IIS 上使用 WCF REST 的项目，但我当然建议看看我构建的框架：OpenRasta 是一个 .net 开源堆栈，它使实现 REST 变得更加容易。

谷歌是你的朋友。主站点是[http://trac.caffeine-it.com/openrasta](http://trac.caffeine-it.com/openrasta)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-12T12:50:29.100

我认为 IIS 堆栈上的 REST 缺乏嗡嗡声的部分原因是微软最初采用 SOAP 作为 Web 服务的方式、真理和光明——尤其是在 Windows Communication Foundation 高度关注 SOAP 的情况下。

他们继续发布[WCF REST Starter Kit](http://msdn.microsoft.com/en-us/netframework/aa663324.aspx)，继 .NET 3.5 的发布之后，以及作为 .NET 3.5 SP1 一部分的 ADO.NET 数据服务。

正如[Magnus 所指出的](https://stackoverflow.com/a/6172728/33051)，微软已经发布了[ASP.NET Web API](http://www.asp.net/web-api)，它建立在 ASP.NET MVC 平台的特性之上，为 IIS 上的 RESTful 服务提供统一的方法。

> ASP.NET Web API 是一个框架，可让您轻松构建覆盖广泛客户端（包括浏览器和移动设备）的 HTTP 服务。ASP.NET Web API 是在 .NET Framework 上构建 RESTful 应用程序的理想平台。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-05-30T05:53:39.500

“Zhaph - Ben Duguid”的答案中提到的 WCF Rest Toolkit 现在已弃用。
它现在已被[WCF Web API 项目](http://wcf.codeplex.com/wikipage?title=WCF%20HTTP)所取代。

编辑：现在也已弃用并被 ASP.NET Web API 取代！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T09:15:00.663

这取决于你如何处理它。

默认情况下，IIS 会将 ASP.NET 页面的动词限制为 GET、HEAD、POST 和 DEBUG。当然，您可以自由地通过编辑处理程序映射来告诉它接受 PUT。假设你想要自己的扩展，你会做类似的事情

```
<httpHandlers>
    <add path="*.example" type="System.Web.UI.PageHandlerFactory" verb="GET, HEAD, POST, PUT, DELETE, DEBUG"/>
</httpHandlers> 
```

如果你想重新映射 .aspx，你当然可以用同样的方式，假设服务器配置为允许你/

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-12T08:54:06.797

我很确定 Microsoft ADO.NET 数据服务使用 RESTful 服务。它可能值得一试......除了让人放松之外，它还是一项非常酷的技术。

这是一份白皮书的摘录：

> Microsoft® ADO.NET 数据服务的目标是使应用程序能够将数据公开为数据服务，可供企业网络内和互联网上的 Web 客户端使用。可以通过常规 HTTP 请求访问数据服务，使用标准 HTTP 动词（例如 GET、POST、PUT 和 DELETE）对服务执行 CRUD 操作。服务使用的负载格式由应用程序控制，但所有选项都是简单、开放的格式，例如 JSON 和 Atom/APP。

这是一份[白皮书](http://msdn.microsoft.com/en-us/library/cc907912.aspx)，它是[主页](http://msdn.microsoft.com/en-us/data/bb931106.aspx)（至少我认为它是主页）

HTH，查尔斯

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-12T06:49:56.160

什么版本的 IIS？在 IIS6 中，您需要启用 WebDAV 以使 PUSH 请求能够通过（不，我认为这也没有多大意义 :-)）。不过，我认为 IIS7 中的情况并非如此。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-12T12:25:29.223

我正在使用 .Net 类 HttpListener，它是没有 IIS 管理工具的 IIS Web 服务器引擎 (http.sys)。我正在处理所有的 HTTP 动词。如果你愿意，你可以添加附加 ASP.Net 运行时，但你不需要。

事实上，在少数情况下，我们实现了一个版本的 PATCH 作为实验。一旦你深入了解基础，动词只是一个 HTTP 标头中的一个字符串。

您实际上无法以无数种方式对 REST 进行分类。使用 HTTP 构建分布式应用程序的方法有很多，但 REST 只有[一种](http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm)定义。

# itunes - 如何使用 Applescript 将歌曲添加到 iTunes 并为其投票？

> ID：637608
> 
> 赞同：2
> 
> 时间：2009-03-12T06:54:07.197
> 
> 标签：itunes

由于 iTunes 8.1 具有 iTunes DJ，我希望能够将歌曲从我的一台计算机上传到另一台运行 iTunes 8.1 的计算机，并将这些歌曲添加到 iTunes 上的资料库中。在那之后，我想让那首歌成为 iTunes 中的下一首歌曲，但前提是没有其他歌曲通过 Apple Remote 应用程序被“请求”更多次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T08:45:36.040

Doug 的 iTunes AppleScripts 有一个名为[Play Album Next In Party Shuffle](http://dougscripts.com/itunes/scripts/ss.php?sp=playalbumnextinps)的脚本。这似乎是一个很好的起点。就脚本而言，iTunes DJ 和 Party Shuffle 显然是一回事。

# sql - MSSQL Server - 在计算列中获取十进制值的整个部分

> ID：637610
> 
> 赞同：2
> 
> 时间：2009-03-12T06:55:36.210
> 
> 标签：sql, sql-server, calculated-columns

这是我的简化表（SQL Server 2005）：

```
table1: col1 int, col2 int, col3 cast(col1/col2 as int) [computed column] 
```

由于某种原因，上述方法不起作用。我只想保存 col1/col2 的整个部分，我该怎么做？

```
example: col1 = 5, col2 = 3 ... col3 should be 1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T07:05:39.867

一种选择是使用[floor 函数](http://msdn.microsoft.com/en-us/library/ms178531.aspx)：

地板（col1/col2）

或者

CONVERT(int, FLOOR(col1/col2)) -- 可能是矫枉过正

# mysql - Mysql::Error：子查询返回多于 1 行：

> ID：637613
> 
> 赞同：0
> 
> 时间：2009-03-12T06:57:03.803
> 
> 标签：mysql, sql, ruby-on-rails, mysql-error-1242

在我的 rails 应用程序中，我正在使用 find_by_sql() 运行 sql 查询，因为我需要子查询。如果我执行第一个或第二个查询，但是当我将它们与 AND 一起添加时，它会开始抱怨子查询中有超过 1 行。

我希望返回与条件匹配的所有行（记录）。这里需要修复/更改什么？什么告诉 mysql 我只想要 1 行？

这是在 rails 日志中查看的结果 SQL：

```
Mysql::Error: Subquery returns more than 1 row: select p.* from policies p 
 where exists (select 0 from status_changes sc join statuses s on sc.status_id = s.id
 where sc.policy_id = p.id
 and s.status_category_id = '1'
 and sc.created_at between '2009-03-10' and '2009-03-12')
 or exists
 (select 0 from status_changes sc join statuses s on sc.status_id = s.id
 where sc.created_at in
 (select max(sc2.created_at)
 from status_changes sc2
 where sc2.policy_id = p.id
 and sc2.created_at < '2009-03-10')
 and s.status_category_id = '1'
 and sc.policy_id = p.id) 
AND (select 0 from status_changes sc
 where sc.policy_id = p.id
 and sc.status_id = 7
 and sc.created_at between '2008-12-31' and '2009-03-12')
 or exists
 (select 0 from status_changes sc
 where sc.created_at in
 (select max(sc2.created_at)
 from status_changes sc2
 where sc2.policy_id = p.id
 and sc2.created_at < '2008-12-31')
 and sc.status_id = 7
 and sc.policy_id = p.id) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T07:04:39.433

这一行：

```
AND (select 0 from status_changes sc 
```

难道不应该

```
AND exists (select 0 from status_changes sc 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-03-12T07:05:22.333

据我所知，任何 SQL 服务器都不支持返回超过 1 行的子查询。

# c - 开源文本到语音库

> ID：637616
> 
> 赞同：32
> 
> 时间：2009-03-12T06:59:51.223
> 
> 标签：c, open-source, text-to-speech

有没有人知道一个好的文本到语音库。需要开源并提供C API？

PS：我已经搜索过了，但我希望得到实际使用过这些 API 的人的建议

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-19T11:23:25.377

[Festival](http://www.cstr.ed.ac.uk/projects/festival/)是一个开源的文字转语音系统。

[斯坦福大学将它用于他们的自然语言处理课程，并且他们在这个cs224s 作业页面](http://web.stanford.edu/class/cs224s/hw/)上有关于安装的最新说明。在 Mac OS X 上安装需要几个补丁，它们已打包到一个方便的[安装脚本](http://www.stanford.edu/class/cs224s/festival_mac/install_festival.py)中。

您可以使用其他声音，它们的声音*明显*优于普通声音。您可以在此论坛帖子中找到有关这些声音的信息： [如何在 Festival 中设置更逼真的声音](http://ubuntuforums.org/showthread.php?t=677277)。这些说明适用于 Ubuntu，但声音适用于任何 Festival 安装。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-12T07:24:01.243

你可以去参加[节日](http://www.cstr.ed.ac.uk/projects/festival)对我来说很好。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-12T13:34:35.190

我在嵌入式服务器中使用过[flite 。](http://www.speech.cs.cmu.edu/flite/)它占地面积小，声音单一

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-12T15:55:28.490

[eSpeak](http://espeak.sourceforge.net/)是另一个轻量级的 TTS。比节日更机器人。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-08-20T21:52:56.377

嘿，[玛丽](http://mary.dfki.de)呢？在我看来，对于开源企业计算机或机器人或其他什么，我们应该进一步推动哪一个？我们需要通过将所有开源资源转移到我们目前拥有的最好/最有前途的资源来加强努力。

有人体验过 MARY TTS 吗？还是它有缺陷（因为之前没有人提到过）？更多链接：

[http://www.babelfish.org/tts-free.htm](http://www.babelfish.org/tts-free.htm)。 [https://www.cereproc.com/en/support/live_demo](https://www.cereproc.com/en/support/live_demo) [http://www.digitalfuturesoft.com/dfttssdk.php](http://www.digitalfuturesoft.com/dfttssdk.php)（也提供ARM版，如MARY+Festival）

# c# - 什么可以让 .NET 应用程序冻结计算机？

> ID：637617
> 
> 赞同：3
> 
> 时间：2009-03-12T07:01:50.563
> 
> 标签：c#, .net, managed, ethernet

我知道这可能是典型的“这取决于......”问题，但我会很感激任何关于从哪里开始寻找的指示。

我有一个通过以太网交谈的客户端/服务器应用程序。在一台计算机上，我运行服务器和一个客户端，而在另一台计算机上只运行客户端。一个运行Vista，一个运行XP。大约 3 周的正常运行时间后，整个计算机死机，没有任何工作，鼠标、键盘、没有任何东西 - 只是关闭电源。服务器每隔 10 秒发送一条 ping 消息以查看客户端是否处于活动状态，除此之外，每天只有几条小消息来回发送。

我正在尝试找出是我造成的还是其他原因。我已经开始了一个会话，几天后我想我会检查内存使用的奇怪增加，但除此之外我几乎没有什么想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T07:50:45.187

您可以将内核调试器附加到操作系统。这样，即使操作系统完全没有响应，您也应该能够检查操作系统和进程的状态。（不幸的是，这比在 VS 中点击“break”要困难得多。我建议在尝试之前阅读 John Robbin 的“Debugging Applications for .NET and Windows”。）

您还可以尝试定期创建应用程序的内存转储。不过，您可能需要为此编写一些脚本。（通常，您会使用 userdump 或 adplus 之类的工具通过击键创建转储，但如果操作系统没有响应击键，那将无法正常工作。）这样，您就知道您的进程在此期间处于什么状态或在挂起前不久。此页面： http: [//blogs.msdn.com/debuggingtoolbox/default.aspx](http://blogs.msdn.com/debuggingtoolbox/default.aspx)是编写 WinDbg 脚本的良好起点。（如果你不知道如何处理内存转储，我再次推荐 John Robbin 的关于调试的优秀书籍！）

除此之外，我只能想到标准的调试技巧：问题是否出现在每台 PC 上？如果没有客户端请求，会发生这种情况吗？如果有更多的客户请求，它会更快发生吗？如果可用的物理内存较少，它会更快发生吗？尝试删除应用程序的某些部分（可能在单独的服务器上进行测试）并查看问题是否仍然存在，等等。尝试在 VM 中运行它，以便查看它在“挂起”期间是否使用 CPU、硬盘或网络。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T08:01:12.870

需要考虑的一些想法：

1.  您知道计算机没有响应，但这并不意味着它已挂起。它对 ping 有响应吗？
2.  也许磁盘活动指示灯一直亮着？
3.  你说“没有键盘” - 你的意思是没有大写锁定或数字锁定灯？
4.  虽然 .NET 应用程序可能是您当时正在运行的唯一应用程序，但这并不意味着它是问题的原因。一些后台工作可能正在做。

例如，我注意到 Retrospect 备份在创建快照时会将整个系统冻结 10-15 分钟。我的意思是，没有大写锁定，任务栏中的时钟不会更新，没有 CTRL-ALT-DEL，不能在 SO 中输入“答案”文本框，什么都没有。这与我当时在回答关于 SO 的问题无关。

回来后，SO问我是不是人。我的感情受到了伤害。;-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T07:08:26.427

这不会是*答案*，但我建议首先检查您的操作系统事件日志并运行 perfmon 以跟踪内存、cpu 使用情况等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T08:07:53.430

哪台计算机死机，服务器还是客户端？他们分别运行什么操作系统？

正如 Daniel L 所指出的，紧密的轮询循环确实会杀死 CPU。如果可以的话，更改您的代码以使用事件处理程序，这是一个更强大的解决方案。

最后，您确定冻结的计算机没有硬件问题吗？

# java - 如何使用 ScheduledExecutorService 重新安排任务？

> ID：637618
> 
> 赞同：12
> 
> 时间：2009-03-12T07:02:10.310
> 
> 标签：java

我在 java 文档中看到了这个：[ScheduledAtFixedRate](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ScheduledExecutorService.html#scheduleAtFixedRate(java.lang.Runnable,%20long,%20long,%20java.util.concurrent.TimeUnit))，它说

> 如果任务的任何执行遇到异常，后续执行将被抑制

我不希望这发生在我的应用程序中。即使我看到异常，我也总是希望后续执行发生并继续。我怎样才能从`ScheduledExecutorService`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-12T07:14:29.550

用 try/catch 包围 Callable.call 方法或 Runnable.run 方法...

例如：

```
public void run()
{
    try
    {
        // ... code
    }
    catch(final IOException ex)
    {
        // handle it
    }
    catch(final RuntimeException ex)
    {
        // handle it
    }
    catch(final Exception ex)
    {
        // handle it
    }
    catch(final Error ex)
    {
        // handle it
    }
    catch(final Throwable ex)
    {
        // handle it
    }
} 
```

请注意，捕获编译器告诉您的内容（我的示例中的 IOException）以外的任何内容都不是一个好主意，但有时，这听起来像是其中之一，如果您处理得当，它可以解决.

请记住，诸如错误之类的事情非常糟糕-VM 内存不足等...所以要小心处理它们（这就是为什么我将它们分开到自己的处理程序中，而不是仅仅执行 catch(final Throwable ex) 而什么都没有别的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T15:51:42.037

尝试[`VerboseRunnable`](http://www.jcabi.com/jcabi-log/apidocs/com/jcabi/log/VerboseRunnable.html)来自[jcabi-log](http://www.jcabi.com/jcabi-log)的类，它执行 TofuBeer 建议的包装：

```
import com.jcabi.log.VerboseRunnable;
Runnable runnable = new VerboseRunnable(
  Runnable() {
    public void run() { 
      // do business logic, may Exception occurs
    }
  },
  true // it means that all exceptions will be swallowed and logged
); 
```

现在，当有人调用时，`runnable.run()`不会抛出异常。相反，它们被吞下并记录（到 SLF4J）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-06T00:23:10.103

我有同样的问题。我还尝试了 run() 方法中的 try 块，但它不起作用。

所以我做了一些到目前为止的工作：

```
import java.util.concurrent.BlockingQueue;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.LinkedBlockingQueue;

public class Test2 {

    static final ExecutorService pool = Executors.newFixedThreadPool(3);

    static final R1 r1 = new R1();
    static final R2 r2 = new R2();

    static final BlockingQueue deadRunnablesQueue = new LinkedBlockingQueue<IdentifiableRunnable>();

    static final Runnable supervisor = new Supervisor(pool, deadRunnablesQueue);

    public static void main(String[] args) {
        pool.submit(r1);
        pool.submit(r2);
        new Thread(supervisor).start();
    }

    static void reSubmit(IdentifiableRunnable r) {
        System.out.println("given to an error, runnable [" + r.getId()
                + "] will be resubmited");
        deadRunnablesQueue.add(r);
    }

    static interface IdentifiableRunnable extends Runnable {
        String getId();
    }

    static class Supervisor implements Runnable {
        private final ExecutorService pool;
        private final BlockingQueue<IdentifiableRunnable> deadRunnablesQueue;

        Supervisor(final ExecutorService pool,
                final BlockingQueue<IdentifiableRunnable> deadRunnablesQueue) {
            this.pool = pool;
            this.deadRunnablesQueue = deadRunnablesQueue;
        }

        @Override
        public void run() {
            while (true) {
                IdentifiableRunnable r = null;
                System.out.println("");
                System.out
                        .println("Supervisor will wait for a new runnable in order to resubmit it...");
                try {
                    System.out.println();
                    r = deadRunnablesQueue.take();
                } catch (InterruptedException e) {
                }
                if (r != null) {
                    System.out.println("Supervisor got runnable [" + r.getId()
                            + "] to resubmit ");
                    pool.submit(r);
                }
            }
        }
    }

    static class R1 implements IdentifiableRunnable {
        private final String id = "R1";
        private long l;

        @Override
        public void run() {
            while (true) {
                System.out.println("R1 " + (l++));
                try {
                    Thread.currentThread().sleep(5000);
                } catch (InterruptedException e) {
                    System.err.println("R1 InterruptedException:");
                }
            }
        }

        public String getId() {
            return id;
        }
    }

    static class R2 implements IdentifiableRunnable {
        private final String id = "R2";
        private long l;

        @Override
        public void run() {
            try {
                while (true) {
                    System.out.println("R2 " + (l++));
                    try {
                        Thread.currentThread().sleep(5000);
                    } catch (InterruptedException e) {
                        System.err.println("R2 InterruptedException:");
                    }
                    if (l == 3) {
                        throw new RuntimeException(
                                "R2 error.. Should I continue to process ? ");
                    }
                }
            } catch (final Throwable t) {
                t.printStackTrace();
                Test2.reSubmit(this);
            }
        }

        public String getId() {
            return id;
        }
    }

} 
```

您可以尝试注释掉 Test2.reSubmit(this) 以查看没有它，R2 将停止工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-05T03:18:42.167

如果您只想*在发生异常后继续执行后续执行*，则此代码应该可以工作。

```
 ScheduledExecutorService executor = Executors.newSingleThreadScheduledExecutor();    

 Runnable task = new Runnable() {      
  @Override
  public void run() {
   try{
      System.out.println(new Date() + " printing");
      if(true)
        throw new RuntimeException();

   } catch (Exception exc) {
      System.out.println(" WARN...task will continiue"+ 
            "running even after an Exception has araised");
    }
  }      
};

executor.scheduleAtFixedRate(task, 0, 3, TimeUnit.SECONDS); 
```

如果发生了`Throwable`其他`Exception`情况，您可能不希望执行后续执行。

这是输出

> 2012 年 11 月 23 日星期五 12:09:38 JST 2012 打印
> _WARN...即使在引发异常之后任务仍将继续运行 11 月 23 日星期五
> 12:09:41 JST 2012 打印
> _WARN...即使在引发异常之后任务仍将继续运行
> 23 12:09:44 JST 2012 打印
> _WARN...即使在引发异常后任务仍将继续
> 运行 11 月 23 日星期五 12:09:47 JST 2012 打印
> _WARN...即使在引发异常后任务仍将继续运行

# .net - How can I manually create WCF OperationContract body type?

> ID：637619
> 
> 赞同：2
> 
> 时间：2009-03-12T07:02:54.023
> 
> 标签：.net, wcf, web-services, serialization, rest

I'm trying to code a web service client in Silverlight for a RESTful WCF service that I have developed. In Silverlight I am constructing the body of the WebRequest using a DataContractSerializer instance.

This approach works great if there is a single argument for the OperationContract. It doesn't work so well if there are multiple arguments defined in the OperationContract. I believe this is because a dynamic type is being created by WCF that is named after the OperationContract and the members of that type are named after the parameters defined for the operation. The purpose of the dynamic type is to ensure that a single XML element exists in the message body being submitted to the WCF service... makes sense. Question is how do I construct this dynamic type myself so that I can submit it to the DataContractSerializer myself.

First example is a working example that defines a single parameter. Second example is the scenario that I am trying to solve (multiple parameters).

* * *

Example 1:

```
[OperationContract,
WebInvoke(Method = HttpMethodType.Post,
    BodyStyle = WebMessageBodyStyle.Bare,
    UriTemplate = "UnregisterProvider"),
WebHelp(Comment = "Unregistered the provider type with the specified URI.")]
void UnregisterProvider(RdfUri providerUri); 
```

Code used to serialize message body:

```
StringBuilder msgBody = new StringBuilder(250);
using (XmlWriter xw = XmlWriter.Create(msgBody))
{
    var serializer = new DataContractSerializer(typeof(RdfUri));
    serializer.WriteObject(xw, providerUri);
} 
```

Resulting body:

```
<RdfUri xmlns="http://schemas.datacontract.org/2004/07/Intellidimension.Rdf">esp:semanticserver</RdfUri> 
```

* * *

Example 2:

```
[OperationContract,
WebInvoke(Method = HttpMethodType.Post,
    BodyStyle = WebMessageBodyStyle.WrappedRequest,  /* WrappedRequest must somehow signal WCF to create the anonymous type as it is required for multiple parameter OperationContracts */
    UriTemplate = "RegisterProvider"),
WebHelp(Comment = "Registered a provider type with the specified URI.")]
void RegisterProvider(PoolableEntityServiceProviderDescriptor descriptor, RdfUri providerUri); 
```

Code used to serialize message body:

```
//????? 
```

Resulting body:

```
<RegisterProvider xmlns="http://tempuri.org/">
  <descriptor i:type="a:SemanticServerProviderDescriptor" xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:a="http://schemas.datacontract.org/2004/07/Intellidimension.RdfEntity.Service.DataContracts">
    <a:ConnectionString>Data Source=.\sqlexpress;Initial Catalog=RdfTest1;Persist Security Info=True;User ID=sa;Password=password</a:ConnectionString>
    <a:ProviderGraphUri>http://entitystore/graph-provider</a:ProviderGraphUri>
  </descriptor>
  <providerUri>esp:semanticserver</providerUri>
</RegisterProvider> 
```

* * *

**Update 1**:

Here is a guy on the MSDN forums asking a similar question: [Can I use DataContractSerializerOperationFormatter to format a list of parameters from client to server?](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/4bb22146-9972-418a-b81f-5102ea289af2/)

DataContractSerializerOperationFormatter is an internal class. So looks like I may have to implemented it's behavior for my client.

**Update 2**:

Some are asking why I am not just using the normal Silverlight WCF client generated by a service reference. The reason is that the WCF service on the server is a RESTful service. From the [docs](http://msdn.microsoft.com/en-us/library/cc896571(VS.95).aspx):

> No analog to the WebHttpBinding provided in WCF is provided. To access pure HTTP, REST, RSS/Atom, or AJAX services from Silverlight 2, use the techniques described in Accessing HTTP-Based Services Directly, such as the WebClient class. To access ASP.NET AJAX services, see Accessing ASP.NET AJAX Services.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T11:52:27.710

我实际上没有尝试过，但[这篇文章](http://dotnetfriendly.blogspot.com/2010/08/bare-and-wrapped-message-in-wcf-rest.html)可能有你想要的。他通过这样做创建了一个包装的消息：

```
 private void ConsumeWcfRest()
    {
        string url = "http://something/MyWebsite/tagservice";

        Tag tag1 = new Tag() { ID = 1, TagName = "test1" };
        Tag tag2 = new Tag() { ID = 2, TagName = "test2" };

        HttpWebRequest req = HttpWebRequest.Create(url + "/tags/wrapped/1") as HttpWebRequest;
        req.Method = "POST";
        string content = "<DoSomethingWrapped xmlns='http://mytagservice'>";
        content = content + DoSerialize(tag1, "tag1");
        content = content + DoSerialize(tag2, "tag2");
        content = content + "</DoSomethingWrapped>";

        // .....
    }

    private string DoSerialize(object obj, string rootName)
    {
        System.Runtime.Serialization.DataContractSerializer se;
        if (string.IsNullOrEmpty(rootName))
            se = new System.Runtime.Serialization.DataContractSerializer(obj.GetType());
        else
            se = new System.Runtime.Serialization.DataContractSerializer(obj.GetType(), rootName, "");

        System.IO.MemoryStream ms = new System.IO.MemoryStream();
        se.WriteObject(ms, obj);
        ms.Position = 0;
        byte[] arr = new byte[ms.Length];
        ms.Read(arr, 0, Convert.ToInt32(ms.Length));
        return new System.Text.UTF8Encoding().GetString(arr);
    } 
```

所以基本上他是使用法线`DataContractSerializer`来序列化每个参数，然后手动在其周围放置 XML 标记。这似乎有点hacky，但它可能会工作......

您可能想开始反编译 WCF 库，看看是否可以首先了解 WCF 是如何做到的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T12:39:33.433

让我反问你一个问题。假设你可以让它工作。POST 请求正文的内容类型是什么？

您试图假装 POST 可以发送两件事，从而滥用 HTTP。如果你想做你正在做的事情，那么为什么不使用常规的 WCF 服务合同。用这些很容易发送多个参数。

System.ServiceModel.Web 的问题在于它只有 90% 将客户端与 WCF 分离。因此，要让事情真正正常工作，您需要在客户端使用 WCF。在这一点上，为什么不坚持常规的 WCF 服务合同。

如果您真的想按预期使用 HTTP，那么请使用有助于而不是阻碍的技术。

# asp.net - ASP.NET 文本框筛选器

> ID：637620
> 
> 赞同：0
> 
> 时间：2009-03-12T07:03:26.533
> 
> 标签：asp.net

有没有一种简单的方法来抑制文本框中的某些击键？例如，如果我只想允许数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T07:07:19.223

没有内置任何内容，您需要[编写一些 JavaScript](http://www.w3schools.com/jsref/jsref_onkeydown.asp)来捕获并忽略您想要禁止的键。

或者您可以使用来自[ASP .NET AJAX 控件工具包的](http://www.asp.net/AJAX/AjaxControlToolkit/)[FilteredTextBox](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/FilteredTextBox/FilteredTextBox.aspx)控件扩展器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T09:02:42.737

您也可以使用 <asp:CompareValidator>。例如

```
<asp:CompareValidator ID="valNumbersOnly" runat="server"
    ControlToValidate="controlYouWantToValidate"
    Operator="DataTypeCheck"
    Type="Integer"
    ErrorMessage="Please enter only numbers">*</asp:CompareValidator> 
```

或者你可以更进一步，使用正则表达式验证器。

这些解决方案可以使用和不使用javascript，因此它们将验证客户端和服务器端。不是每个人都打开了javascript！

HTH，查尔斯

# image - 适用于 Windows 的基于对象的图像编辑器

> ID：637633
> 
> 赞同：0
> 
> 时间：2009-03-12T07:19:31.673
> 
> 标签：image

我不是设计师，但有时我必须为我们的应用程序创建/编辑图像。

过去我使用过“Microsoft Image Composer”——我喜欢它的用户界面，因为它基于对象且易于使用。不幸的是，它已停产，而且我使用的旧版本在 png 文件方面存在一些问题。

我试图找到一个好的替代品，但似乎每个人都在使用图层而不是对象。

你知道任何基于对象的图像编辑器吗？

编辑：

仍然没有找到我正在寻找的东西......到目前为止，最好的替代品是 Paint.NET，即使它使用图层。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T07:28:36.193

你试过插画家吗？作为矢量图形应用程序，它可能不完全是“基于对象的”，但您使用独立的形状而不是像素层。

Inkscape [http://www.inkscape.org/](http://www.inkscape.org/)是一个免费的替代品。我还没有尝试过，但它似乎是一个赢家。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-13T19:02:21.900

坚持你机器上可能已经存在的东西，PowerPoint 和 Visio 都是面向对象（但粗糙）的图像编辑器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T18:10:16.427

我想不存在这样的软件。很遗憾，因为我发现 UI 比层模型好得多。

# wpf - 使用带有 WPF 标签的 System.Drawing.Font

> ID：637636
> 
> 赞同：6
> 
> 时间：2009-03-12T07:23:59.557
> 
> 标签：wpf, fonts, label, underline

我有一个 WPF 标签控件，我正在尝试更改使用某些遗留代码提供的 System.Drawing.Font 对象的外观。我已经能够设置大部分属性，但我在 Strikeout 和 Underline 中苦苦挣扎。

到目前为止，我有：

```
System.Drawing.Font font = FontFromLegacyCode();

System.Windows.Controls.Label label = new System.Windows.Controls.Label();
label.FontFamily = new System.Windows.Media.FontFamily( font.Name );
label.FontWeight = font.Bold ? System.Windows.FontWeights.Bold : System.Windows.FontWeights.Regular;
label.FontStyle = font.Italic ? System.Windows.FontStyles.Italic : System.Windows.FontStyles.Normal;
label.FontSize = font.Size; 
```

如何设置字体删除线或下划线属性？有没有更好的控件可以使用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-12T08:17:14.453

我会将其更改为 TextBlock 控件。TextBlock 控件具有您可以使用的 TextDecorations 属性。

```
<TextBlock Name="textBlock" TextDecorations="Underline, Strikethrough" /> 
```

或者，如果您真的喜欢，您可以将 TextBlock 粘贴在 Label 中（尽管我只使用 TextBlock 本身）。

```
<Label Name="label">
    <TextBlock Name="textBlock" TextDecorations="Underline, Strikethrough" />
</Label> 
```

看看[TextDecorations](http://msdn.microsoft.com/en-us/library/system.windows.textdecorations.aspx)类。

我发现在大多数情况下，TextBlocks 比 Labels 更合适。这是一篇关于差异的[博客文章。](http://joshsmithonwpf.wordpress.com/2007/07/04/differences-between-label-and-textblock/)主要区别在于 Label 是 Control 而 TextBlock 只是 FrameworkElement。Label 也支持访问键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-17T22:48:11.210

查看您已经拥有的代码，它可能存在问题。在[Windows 窗体和 WPF 属性映射](http://msdn.microsoft.com/en-us/library/ms751565.aspx)的 MSDN 上，他们发表评论：

> WPF 中的字体大小表示为一英寸的九十六分之一，在 Windows 窗体中表示为一英寸的七十秒。对应的转换为：
> 
> Windows 窗体字体大小 = WPF 字体大小 * 72.0 / 96.0。

# c# - Storing Settings for Multiple Projects Commonly in C#

> ID：637645
> 
> 赞同：0
> 
> 时间：2009-03-12T07:36:19.387
> 
> 标签：c#, .net

I want to keep the settings for two different projects for c# commonly.Is there any way to achieve this?.

Regards, Harsh Suman

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T08:29:24.017

我想有很多选项可供选择，具体取决于您的具体情况和偏好。

这里有一些 -

你可以使用一个数据库，如果你可以安全地假设有一个的话。

您可以使用机器配置中的条目，这两个应用程序都可以访问；您可以使用 AppSettings 或更好的自定义配置部分来执行此操作。

您可以在机器配置中声明您的配置，但在单独的文件中指定它以使其更容易（和更安全）维护 -

```
<configuration> .. <appSettings file="MyConfig.config" />...</configuration> 
```

其中 MyConfig.config 是包含 appSettings 部分的文件的名称（也可以是任何子文件夹的路径）。

如果您使用自定义配置（或任何内置配置部分，除了 appSettings），您可以使用 ConfigSource 属性来指定配置的位置，如此处[所述](http://dotnetslackers.com/Community/forums/the-configsource-attribute-must-be-a-relative-physical-path-so-the-character-is-not-allowed/t/1607.aspx)

您可以查看使用一些共享位置进行配置，例如 - 在 Windows Vista 中，您可以使用 %APPDATA% 位置来存储配置（在其下创建您自己的文件夹），查看此文件夹您会注意到这是许多其他程序的作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T21:13:09.240

如果项目设置是指配置信息，那么已经发布的关于为 appSettings 设置通用文件的解决方案很好（假设您正在使用 appSettings 部分进行配置）。您还可以创建从公共位置甚至数据库加载的自定义配置节处理程序。

如果您正在谈论项目信息，例如程序集类型的信息，那么您可以编辑项目文件并包含指向将编译到两个项目中的公共文件的链接。您可以通过包含类似这样的内容来添加链接...

```
<Compile Include="..\..\SolutionInfo.cs">
  <Link>Properties\SolutionInfo.cs</Link>
</Compile> 
```

我们将其用于跨项目的通用属性，这些属性要么在同一解决方案中（例如对齐版本号等），要么跨多个项目，以便在一个地方管理公司信息等通用信息。

# c# - 获取标题不完全已知的窗口句柄。（C＃）

> ID：637652
> 
> 赞同：5
> 
> 时间：2009-03-12T07:46:34.543
> 
> 标签：c#, api

标题部分是静态的，带有可变后缀。例如*"Window Title {- user_id}"*。

在不知道确切标题的情况下如何获得句柄？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-12T08:00:42.213

查看所有进程并检查[MainWindowTitle](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.mainwindowtitle.aspx)。（您可以使用正则表达式或`StartsWith`等）

```
foreach(Process proc in Process.GetProcesses())
{
   if(proc.MainWindowTitle.StartsWith("Some String"))
   {
      IntPtr handle = proc.MainWindowHandle;
      // ...
   }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T08:00:16.553

[这篇 CodeProject 文章](http://www.codeproject.com/KB/cs/runninginstanceie.aspx)描述了如何枚举顶级窗口（基于 Win32 API [EnumWindows](http://msdn.microsoft.com/en-us/library/ms633497.aspx)）。您可以轻松修改它以过滤部分窗口标题：修改 EnumWindowsCallBack。

HTH。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T08:18:47.787

通过类名和父窗口句柄获取。例如：使用 win32api 获取开始按钮句柄。首先，您使用 spyxx 工具知道父窗口类名称。

```
[DllImport("user32.dll")]
public static extern IntPtr FindWindowEx(IntPtr handleParent, IntPtr handleChild, string className, string WindowName);
[DllImport("user32.dll")]
public static extern IntPtr FindWindow(string className, string windowTitle); 
```

用法：

```
IntPtr handle = FindWindowEx(FindWindow("Shell_TrayWnd",null), new IntPtr(0), "Button", null); 
```

# apache-flex - 你如何在Flex中获得图像的右上角

> ID：637660
> 
> 赞同：0
> 
> 时间：2009-03-12T07:49:16.860
> 
> 标签：apache-flex, flex3

我想在 flex 中获得图像的右上角 .... 到目前为止，我只能获得默认情况下左上角的 x 和 y .... 对不起，我是菜鸟，如果这是一个愚蠢的问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T07:51:01.083

您是否尝试将图像宽度添加到 x？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T09:10:44.510

Flex 支持三个坐标系，您可以在[此处](http://livedocs.adobe.com/flex/3/html/help.html?content=containers_intro_5.html)找到：

> *   全球的
> *   当地的
> *   内容

根据图像的布局方式，您必须使用 image.x 和宽度值以及适当的转换函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T09:41:01.333

我对 Flex 的参与并不多，但对于 flash AS2，我会这样做：

```
var top:Number
var right:Number

top = myImageObj._y
right = myImageObj._x + myImageObj._width 
```

在 AS3 中可能会有些不同，我认为它们已将“._y”更改为“.Y”，但我不确定。

反正原理是一样的。使用左上角，然后只需添加宽度即可获得右边缘

# asp.net - ASP.NET 默认情况下是否利用多核处理器？

> ID：637665
> 
> 赞同：7
> 
> 时间：2009-03-12T07:54:01.420
> 
> 标签：asp.net, multicore

或者我必须为此专门配置 IIS？我是否必须使用网络花园才能利用多核？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-12T08:00:27.817

Web 服务器是多线程的（至少 IIS 是）。

默认情况下，Windows 调度程序将在所有可用内核上分发任何多线程程序（例如，可以在任务管理器中调整“处理器亲和性”）。无论您使用的是 ASP.NET 还是任何其他应用程序服务器/语言，在这里都没有区别。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T07:59:17.663

它实际上是相反的。IIS6 中关闭了处理器关联，这意味着负载将分布在所有可用的 CPU 上。如果你想限制它，你可以使用处理器亲和性来停止这个默认行为。

由于您希望它使用所有可用的 CPU，因此默认安装将按您的意愿工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T07:59:07.977

默认情况下，IIS 将利用多核 CPU。

[如果要设置[处理器亲和性](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/edf8b7c6-f71e-41b2-8459-e9305c2d2944.mspx?mfr=true)，需要显式配置。]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T09:04:43.230

ASP.Net 页面也可以[异步](http://msdn.microsoft.com/en-us/library/ba6dhx95.aspx)运行，并且可以是[多线程](http://www.beansoftware.com/ASP.NET-Tutorials/Multithreading-Thread-Pool.aspx)的。

# javascript - 提交 rails 表单可以避免离开当前视图吗？

> ID：637666
> 
> 赞同：2
> 
> 时间：2009-03-12T07:54:42.977
> 
> 标签：javascript, ruby-on-rails, render, edit

当用户与页面交互时，我有一点 javascript 魔术来动态创建和隐藏 div。每个 div 包含我的应用程序某些部分的视图，并且这些视图中的每个模型实例都有一个所有者。如果浏览页面的人不是所有者，他们只会看到数据。但是，如果用户是数据的所有者，他们将获得编辑视图。

可能会隐藏所有 div 的状态并重新呈现页面，就像用户提交更改时一样，但我宁愿有一些快速简便的方法来让事务继续进行行：用户点击提交按钮，服务器处理更改并发送回确认，屏幕上的微小更改闪烁交易完成的通知。

任何人都有一个工作示例的指针？实施的门槛将是做我在这里问的事情是否更容易，或者只是咬紧牙关并通过事务携带 div 状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T12:42:53.863

正如 On Freund 所说，remote_form_for 是要走的路。再加上一点 RJS，你就可以开始运行了：

```
# Form
- remote_form_for(@obj, :url => obj_path(@obj)) do |f|

  = f.text_field :some_attribute
  = f.submit "Submit"

# Controller action

def edit
  respond_to do |wants|
    wants.html { }
    wants.js {
      render :update do |page|
        page.replace_html :some_div, "Some content"
      end
    }
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T08:08:48.343

听起来您所需要的只是一些 Ajax 魔法。查看 remote_form_for 或任何其他[Prototype Helpers](http://api.rubyonrails.org/classes/ActionView/Helpers/PrototypeHelper.html)。

# c# - Linq 2 SQL - 通用 where 子句

> ID：637672
> 
> 赞同：5
> 
> 时间：2009-03-12T07:56:58.090
> 
> 标签：c#, linq-to-sql

有没有办法做到这一点

```
public T GetItemById(int id)
{
    Table<T> table = _db.GetTable<T>();
    table.Where(t => t.Id == id);
} 
```

请注意，上下文中不存在 i.Id，因为 linq 不知道它正在使用什么对象，并且 Id 是表的主键

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T08:11:14.077

（删除了绑定到属性的方法）

编辑：这是元模型方式（因此它适用于映射文件以及属性对象）：

```
static TEntity Get<TEntity>(this DataContext ctx, int key) where TEntity : class
{
    return Get<TEntity, int>(ctx, key);
}
static TEntity Get<TEntity, TKey>(this DataContext ctx, TKey key) where TEntity : class
{
    var table = ctx.GetTable<TEntity>();
    var pkProp = (from member in ctx.Mapping.GetMetaType(typeof(TEntity)).DataMembers
                  where member.IsPrimaryKey
                  select member.Member).Single();
    ParameterExpression param = Expression.Parameter(typeof(TEntity), "x");
    MemberExpression memberExp;
    switch (pkProp.MemberType)
    {
        case MemberTypes.Field: memberExp = Expression.Field(param, (FieldInfo)pkProp); break;
        case MemberTypes.Property: memberExp = Expression.Property(param, (PropertyInfo)pkProp); break;
        default: throw new NotSupportedException("Invalid primary key member: " + pkProp.Name);
    }
    Expression body = Expression.Equal(
        memberExp, Expression.Constant(key, typeof(TKey)));
    var predicate = Expression.Lambda<Func<TEntity, bool>>(body, param);
    return table.Single(predicate);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T08:11:50.673

您需要创建实体派生自的适当接口（除非您想使用像 Marc 的示例这样的表达式树）：

```
public interface IIdentifiedEntity
{
    int Id { get; } // Set as well? Depends on your situation.
} 
```

然后你可以写：

```
public T GetItemById<T>(int id) where T : class, IIdentifiedEntity
{
    Table<T> table = _db.GetTable<T>();
    return table.Where(t => t.Id == id)
                .Single();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T08:04:50.740

也许您可以在[http://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx)的 Generic Predicates 下找到一些东西。这是页面上的最后一部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T08:05:43.450

```
var X = _db.table.Select(i => i.Id == id); 
```

这将返回 IQueryable<T>

# user-interface - 何时在菜单项后使用省略号

> ID：637683
> 
> 赞同：58
> 
> 时间：2009-03-12T08:02:37.827
> 
> 标签：user-interface, menu, standards, conventions

在几乎所有具有菜单栏的应用程序中，有些项目后面有一个省略号 (...)，有些则没有。是否有一个众所周知的约定什么时候把省略号放在那里，什么时候不放？你什么时候做？你做吗？

我查看了各种 Windows 应用程序，这就是我的想法：

*   **省略**

    *   打开需要用户输入才能执行某项操作的表单的菜单项（替换、转到、字体）
*   **没有省略号**

    *   只是做某事的菜单项（剪切、粘贴、退出、保存）
    *   打开不需要用户输入的表单的菜单项（关于，检查更新）

但是似乎总是有不遵循此规则的菜单项。例如，Visual Studio 中的帮助项（我如何、搜索、索引）和查找和替换（快速查找、在文件中查找、查找符号）。

因此，在考虑了更多之后，我现在认为这可能是事情：

*   **省略**

    *   肯定会打开模式窗口的菜单项。
*   **没有省略号**

    *   打开非模式窗口的菜单项。
    *   不打开任何窗口的菜单项。
    *   很可能不会打开模式窗口的菜单项（如保存，如果您之前没有保存过或类似的东西，它会打开一个模式窗口，否则不要）

你们有什么感想？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-03-12T08:13:52.107

关键因素是菜单选项在执行操作之前是否需要**附加信息（输入或选择）。**所以 Help-About 不需要省略号，但 File-Open 需要。无论如何，这就是 Microsoft、Apple 和 KDE 指南所说的内容。

* * *

Microsoft Windows 应用程序*应该*遵循[Microsoft 的“用户体验指南”](https://docs.microsoft.com/en-us/windows/win32/uxguide/cmd-menus#using-ellipses)。这是他们对菜单项上的省略号的看法。

> 虽然菜单命令用于立即操作，但执行操作可能需要更多信息。通过在标签末尾添加省略号来指示需要附加信息（包括确认）的命令。
> 
> 这并不意味着您应该在操作显示另一个窗口时使用省略号——仅当需要额外信息来执行操作时。例如，关于、高级、帮助、选项、属性和设置命令在单击时必须显示另一个窗口，但不需要用户提供其他信息。因此它们不需要椭圆。

* * *

David 的回答引用了[KDE 3 用户界面指南](http://developer.kde.org/documentation/standards/kde/style/menus/index.html)，

> 请注意，菜单中首先打开需要附加信息的对话框的每个项目都必须用尾随省略号 (...) 进行标记（例如，另存为...、打开...）。菜单项和“...”之间没有空格。简单的确认对话框不被视为需要额外信息的对话框。

* * *

[Apple 人机界面指南](https://web.archive.org/web/20150318210053/https://developer.apple.com/library/mac/documentation/UserExperience/Conceptual/OSXHIGuidelines/TerminologyWording.html#//apple_ref/doc/uid/20000957-CH15-SW1)说：

> 当它出现在按钮或菜单项的名称中时，省略号字符 (...) 向用户指示在执行相关操作之前需要附加信息。具体来说，它使用户准备好在命令执行之前期望出现一个窗口或对话框，在该窗口或对话框中进行选择或输入信息。因为用户期望按钮和菜单项的即时操作（如“按钮”和“菜单行为”中所述），所以通过适当地显示省略号字符来为这种替代行为做好准备尤为重要。以下指南和示例将帮助您决定何时在菜单项和按钮名称中使用省略号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T08:08:53.600

据我了解， (...) a end 通常意味着用户将被要求输入一些内容。no (...) 表示不需要输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T08:09:04.253

你说得对，总结一下。如果您想了解更多信息，可以在此处找到用户样式指南列表：[http ://www.experiencedynamics.com/science-usability/ui-style-guides](http://www.experiencedynamics.com/science-usability/ui-style-guides)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T08:10:11.817

我同意，这符合我自己对何时包含省略号的看法。

我想省略号的重点是“警告”用户，以便她可以理解某个选择是安全的探索，它不会在不通过对话框询问更多信息的情况下立即做某事。

在某些程序中，例如（至少是旧版本的）[Autodesk 的 Maya](http://usa.autodesk.com/adsk/servlet/index?id=7635018&siteID=123112)（一个高端 3D 建模包），省略号实际上是一个小的对话框图标。您可以单击菜单中的图标以获取图标，或单击菜单项的其余部分（文本）以使用与上次相同的设置或类似的设置重复命令。似乎这个想法并没有流行起来并成为主流。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-23T09:10:05.980

这确实是一个非常棘手的问题。起初它可能看起来很明显，但有许多动作属于类别之间。有趣的是，微软自己违反了这种做法。

Vista 中的示例在计算机管理菜单文件 - 选项... 在计算机管理/用户和组/用户中有省略号。右键单击用户。New user... 操作有省略号，但 Rename 没有，尽管它需要额外的操作来实际重命名帐户。在 Micrsoft SQL Server Management Studio 菜单 File - Print 中具有带省略号的 Properties... 按钮。

这只是经过 5 分钟的调查。还有很多例子。

您可以为这两种操作都使用两种约定。您实际上无法更改任何属性或选项，除非在显示的假定应使用省略号的对话框中执行一些额外操作。但是，您可能只对查看定义的选项或属性感兴趣，并且假定没有使用省略号。微软也承认存在模棱两可的情况

“如果有歧义（例如，命令标签缺少动词），请根据最可能的用户操作来决定。如果只是查看窗口是常见操作，请不要使用省略号。” 然而，基于此，省略选项和属性会更有意义，因为您可能更有可能想要更改仅查看它的属性。

# ruby-on-rails - Routes.rb 在 Rails 中创建问题

> ID：637684
> 
> 赞同：0
> 
> 时间：2009-03-12T08:03:59.867
> 
> 标签：ruby-on-rails, routes

我使用的链接是

:communities,:action=>:usergroups} , :class => "adminbutton viewusergrp" %>

并且路由包含 map.resources :vccommunities,:member => {:usergroups => :get} 并且在 member 和 collection 中还指定了更多操作名称。我在 :member 中列出这些操作时注意字母顺序

但是当点击那个链接时......它正在采取 :action => show, :id => usergroups, :controller => :communities

所以它是错误的，因为它不会在控制器中进行正确的操作。

请帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T08:39:41.420

问题不在于您的路线问题在于您的链接。根据路线的定义，rails在内部搜索您的例如链接中的链接哈希中的id，如下所示

<%= link_to 'View User Group', {:controller=>:communities,:action=>:usergroups, **:id => 20** } , :class => "adminbutton viewusergrp" %>
应该可以工作，因为这将映射到

/communities/20/用户组

可以从此[页面获取进一步的参考](http://api.rubyonrails.org/classes/ActionController/Resources.html)

# c++ - 与以空结尾的字符串相比，std::string 的效率如何？

> ID：637695
> 
> 赞同：13
> 
> 时间：2009-03-12T08:09:11.150
> 
> 标签：c++, stl, performance

我发现`std::string`s 与老式的以空结尾的字符串相比非常慢，速度非常慢，以至于它们显着降低了我的整个程序的 2 倍。

我预计 STL 会更慢，我没有意识到它会慢这么多。

我正在使用 Visual Studio 2008，发布模式。它显示字符串的分配比`char*`分配慢 100-1000 倍（测试分配的运行时间非常困难`char*`）。我知道这不是一个公平的比较，指针赋值与字符串复制，但我的程序有很多字符串赋值，我不确定我是否可以在所有地方使用“ *const reference* ”技巧。使用引用计数实现我的程序会很好，但这些实现似乎不再存在。

我真正的问题是：为什么人们不再使用引用计数实现，这是否意味着我们都需要更加小心避免 std::string 的常见性能缺陷？

我的完整代码如下。

```
#include <string>
#include <iostream>
#include <time.h>

using std::cout;

void stop()
{
}

int main(int argc, char* argv[])
{
    #define LIMIT 100000000
    clock_t start;
    std::string foo1 = "Hello there buddy";
    std::string foo2 = "Hello there buddy, yeah you too";
    std::string f;
    start = clock();
    for (int i=0; i < LIMIT; i++) {
        stop();
        f = foo1;
        foo1 = foo2;
        foo2 = f;
    }
    double stl = double(clock() - start) / CLOCKS\_PER\_SEC;

    start = clock();
    for (int i=0; i < LIMIT; i++) {
        stop();
    }
    double emptyLoop = double(clock() - start) / CLOCKS_PER_SEC;

    char* goo1 = "Hello there buddy";
    char* goo2 = "Hello there buddy, yeah you too";
    char *g;
    start = clock();
    for (int i=0; i < LIMIT; i++) {
        stop();
        g = goo1;
        goo1 = goo2;
        goo2 = g;
    }
    double charLoop = double(clock() - start) / CLOCKS_PER_SEC;
    cout << "Empty loop = " << emptyLoop << "\n";
    cout << "char* loop = " << charLoop << "\n";
    cout << "std::string = " << stl << "\n";
    cout << "slowdown = " << (stl - emptyLoop) / (charLoop - emptyLoop) << "\n";
    std::string wait;
    std::cin >> wait;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-12T08:29:10.803

好吧，关于字符串和其他容器的性能肯定存在已知问题。其中大多数与临时和不必要的副本有关。

正确使用它并不难，但做错也很容易。例如，如果您看到您的代码在不需要可修改参数的情况下按值接受字符串，那么您做错了：

```
// you do it wrong
void setMember(string a) {
    this->a = a; // better: swap(this->a, a);
} 
```

您最好通过 const 引用来获取它或在内部进行交换操作，而不是另一个副本。在这种情况下，向量或列表的性能损失会增加。但是，您肯定是对的，存在已知问题。例如在这个：

```
// let's add a Foo into the vector
v.push_back(Foo(a, b)); 
```

我们正在创建一个临时的，只是为了在我们的向量`Foo`中添加一个新的。`Foo`在手动解决方案中，这可能会`Foo`直接在向量中创建。如果向量达到其容量限制，它必须为其元素重新分配更大的内存缓冲区。它有什么作用？它使用复制构造函数将每个元素分别复制到新位置。如果手动解决方案事先知道元素的类型，它可能会表现得更智能。

另一个常见的问题是引入了临时工。看看这个

```
string a = b + c + e; 
```

创建了大量临时变量，您可能会在实际优化性能的自定义解决方案中避免这些临时变量。那时，界面`std::string`被设计为写时复制友好。然而，随着线程变得越来越流行，写入字符串的透明复制在保持其状态一致方面存在问题。最近的实现倾向于避免在写入字符串时复制，而是在适当的情况下应用其他技巧。

然而，对于下一版本的标准，这些问题中的大部分都得到了解决。例如`push_back`，您可以使用`emplace_back`直接`Foo`在向量中创建 a 而不是

```
v.emplace_back(a, b); 
```

并且不会在上面的串联中创建副本，而是`std::string`会识别何时串联临时并针对这些情况进行优化。重新分配也将避免复制，但会将元素移动到适当的新位置。

要想读得好，请考虑Andrei Alexandrescu 的[Move Constructors](http://www.ddj.com/database/184403855)。

然而，有时比较也往往是不公平的。标准容器必须支持它们必须支持的特性。例如，如果您的容器在从地图中添加/删除元素时不保持地图元素引用有效，那么将您的“更快”地图与标准地图进行比较可能会变得不公平，因为标准地图必须确保元素保持有效。当然，这只是一个例子，当你说“我的容器比标准容器快！！！”时，你必须记住很多这样的情况。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-12T09:51:38.673

看起来您在粘贴的代码中滥用了 char* 。如果你有

```
std::string a = "this is a";
std::string b = "this is b"
a = b; 
```

您正在执行字符串复制操作。如果您对 char* 执行相同操作，则您正在执行指针复制操作。

std::string 赋值操作分配足够的内存来保存 a 中 b 的内容，然后一个一个地复制每个字符。在 char* 的情况下，它不会进行任何内存分配或逐个复制单个字符，它只是说“a 现在指向 b 指向的同一内存”。

我的猜测是这就是 std::string 较慢的原因，因为它实际上是在复制字符串，这似乎是您想要的。要对 char* 执行复制操作，您需要使用 strcpy() 函数复制到已经适当大小的缓冲区中。然后你会有一个准确的比较。但就您的程序而言，您几乎绝对应该使用 std::string 来代替。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-12T08:53:26.550

使用任何实用程序类（无论是 STL 还是您自己的）而不是例如编写 C++ 代码时。好旧的 C 空终止字符串，你需要记住一些事情。

*   如果您在没有编译器优化的情况下进行基准测试（尤其是函数内联），类将会丢失。它们不是内置的，即使是 stl。它们是根据方法调用来实现的。

*   不要创建不必要的对象。

*   尽可能不要复制对象。

*   如果可能，将对象作为引用而不是副本传递，

*   使用更专业的方法和函数以及更高级别的算法。例如。：

    ```
    std::string a = "String a"
    std::string b = "String b"

    // Use
    a.swap(b);

    // Instead of
    std::string tmp = a;
    a = b;
    b = tmp; 
    ```

最后一点。当您的类 C 的 C++ 代码开始变得更加复杂时，您需要实现更高级的数据结构，例如自动扩展数组、字典、高效的优先级队列。突然你意识到它的工作量很大，而且你的课程并没有真正比 stl 更快。只是更多的越野车。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-12T08:13:26.693

你肯定做错了什么，或者至少没有在 STL 和你自己的代码之间进行“公平”比较。当然，如果不看代码，很难更具体。

可能是您使用 STL 构建代码的方式导致更多构造函数运行，或者没有以与您自己实现操作时所做的方式相匹配的方式重用分配的对象，等等。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-02-29T16:52:02.363

这个测试是测试两个根本不同的东西：浅拷贝和深拷贝。了解差异以及如何避免 C++ 中的深拷贝至关重要，因为默认情况下，C++ 对象为其实例提供值语义（与普通旧数据类型的情况一样），这意味着通常将一个分配给另一个复印。

我“纠正”了你的测试并得到了这个：

```
char* loop = 19.921
string = 0.375
slowdown = 0.0188244 
```

显然我们应该停止使用 C 风格的字符串，因为它们太慢了！实际上，我故意让我的测试和你的测试一样有缺陷，方法是在字符串端测试浅拷贝与 strcpy 在：

```
#include <string>
#include <iostream>
#include <ctime>

using namespace std;

#define LIMIT 100000000

char* make_string(const char* src)
{
    return strcpy((char*)malloc(strlen(src)+1), src);
}

int main(int argc, char* argv[])
{
    clock_t start;
    string foo1 = "Hello there buddy";
    string foo2 = "Hello there buddy, yeah you too";
    start = clock();
    for (int i=0; i < LIMIT; i++)
        foo1.swap(foo2);
    double stl = double(clock() - start) / CLOCKS_PER_SEC;

    char* goo1 = make_string("Hello there buddy");
    char* goo2 = make_string("Hello there buddy, yeah you too");
    char *g;
    start = clock();
    for (int i=0; i < LIMIT; i++) {
        g = make_string(goo1);
        free(goo1);
        goo1 = make_string(goo2);
        free(goo2);
        goo2 = g;
    }
    double charLoop = double(clock() - start) / CLOCKS_PER_SEC;
    cout << "char* loop = " << charLoop << "\n";
    cout << "string = " << stl << "\n";
    cout << "slowdown = " << stl / charLoop << "\n";
    string wait;
    cin >> wait;
} 
```

重点是，这实际上触及了你最终问题的核心，你必须知道你在用代码做什么。如果您使用 C++ 对象，您必须知道将一个分配给另一个将复制该对象（除非分配被禁用，在这种情况下您会收到错误消息）。您还必须知道何时适合使用指向对象的引用、指针或智能指针，并且使用 C++11，您还应该了解移动和复制语义之间的区别。

> 我真正的问题是：为什么人们不再使用引用计数实现，这是否意味着我们都需要更加小心避免 std::string 的常见性能缺陷？

人们确实使用引用计数实现。这是一个例子：

```
shared_ptr<string> ref_counted = make_shared<string>("test");
shared_ptr<string> shallow_copy = ref_counted; // no deep copies, just 
                                               // increase ref count 
```

不同之处在于 string 不会在内部执行它，因为这对于那些不需要它的人来说效率低下。由于类似的原因（加上它通常会使线程安全成为问题），通常不再对字符串执行诸如写时复制之类的事情。然而，如果我们愿意的话，我们这里有所有的构建块来进行写时复制：我们能够在不进行任何深度复制的情况下交换字符串，我们能够为它们创建指针、引用或智能指针.

要有效地使用 C++，您必须习惯这种涉及值语义的思维方式。如果不这样做，您可能会享受额外的安全性和便利性，但这样做会降低代码的效率（不必要的副本肯定是导致编写不佳的 C++ 代码比 C 慢的重要部分）。毕竟，您的原始测试仍在处理指向字符串的指针，而不是`char[]`数组。如果您使用的是字符数组而不是指向它们的指针，那么您同样需要`strcpy`交换它们。使用字符串，你甚至有一个内置的交换方法来有效地完成你在测试中所做的事情，所以我的建议是花更多的时间学习 C++。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-12T08:22:17.890

如果您知道向量的最终大小，您可以通过在填充之前调用 reserve() 来防止过度调整大小。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-12T09:08:17.543

优化的主要规则：

*   规则1：不要这样做。
*   规则 2：（仅限专家）不要这样做。

您确定您已经**证明**确实是 STL 慢，而不是**您的算法**？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-12T09:09:22.020

使用 STL 获得良好的性能并不总是那么容易，但一般来说，它旨在为您提供强大的功能。我发现**[Scott Meyers 的“Effective STL”](https://rads.stackoverflow.com/amzn/click/com/0201749629)**让我大开眼界，让我了解如何有效地处理 STL。读！

正如其他人所说，您可能经常遇到字符串的深层副本，并将其与指针分配/引用计数实现进行比较。

通常，针对您的特定需求设计的任何类都将击败为一般情况设计的通用类。但是学会很好地使用通用类，学会遵守 80:20 的规则，你会比一个人自己滚动所有东西更有效率。

* * *

一个特定的缺点`std::string`是它不提供性能保证，这是有道理的。正如 Tim Cooper 所提到的，STL 并没有说明字符串赋值是否会创建深层副本。这对于泛型类来说是*件好事*，因为在高并发应用程序中引用计数可能会成为真正的杀手，即使它通常是单线程应用程序的最佳方式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-12T08:15:29.653

他们没有出错。STL 实现通常比你的要好。

我敢肯定，对于一个非常特殊的情况，你可以写出更好的东西，但是 2 的因子太多了......你真的做错了什么。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-12T08:19:30.673

如果使用正确，std::string 与 char* 一样有效，但具有额外的保护。

如果您在使用 STL 时遇到性能问题，很可能是您做错了什么。

此外，STL 实现不是跨编译器的标准。我知道 SGI 的 STL 和 STLPort 通常表现良好。

也就是说，我是认真的，你可能是一个 C++ 天才，并且设计了比 STL 复杂得多的代码。这不太可能，但谁知道呢，你可能是 C++ 的 LeBron James。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-12T08:28:53.597

我会说 STL 的实现比传统的实现要好。您是否也尝试过使用列表而不是向量，因为向量对某些目的有效，而列表对其他某些目的有效

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-13T01:46:21.220

```
                        string const string& char* Java 字符串
-------------------------------------------------- -------------------------------------------------
高效 否 ** 是 是 是
任务                          

线程安全 是 是 是 是

内存管理 是 否 否 是
为你做了

```

** std::string 有 2 种实现：引用计数或深拷贝。引用计数在多线程程序中引入了性能问题，即使只是读取字符串，深拷贝显然更慢，如上所示。请参阅： [为什么 VC++ 字符串不被引用计数？](https://stackoverflow.com/questions/707014/why-vc-strings-are-not-reference-counted)

As this table shows, 'string' is better than 'char*' in some ways and worse in others, and 'const string&' is similar in properties to 'char*'. Personally I'm going to continue using 'char*' in many places. The enormous amount of copying of std::string's that happens silently, with implicit copy constructors and temporaries makes me somewhat ambivalent about std::string.

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-07-09T18:30:04.490

`std::string`总是比 C 字符串慢*。*C 字符串只是一个线性内存数组。仅作为数据结构，您无法获得比这更有效的方法。您使用的算法（如`strcat()`or `strcpy()`）通常等同于 STL 对应物。相对而言，类实例化和方法调用将比 C 字符串操作慢得多（如果实现使用虚拟则更糟）。获得同等性能的唯一方法是编译器进行优化。

* * *

## 回答 #14

> 赞同：-5
> 
> 时间：2009-03-12T08:27:10.950

很大一部分原因可能是引用计数不再用于 STL 的现代实现。

故事是这样的（如果我错了，有人纠正我）：一开始，STL 实现使用引用计数，并且速度很快但不是线程安全的——实现者希望应用程序程序员在更高级别插入他们自己的锁定机制，以使它们是线程安全的，因为如果在 2 个级别上完成锁定，那么这会使事情变慢两倍。

但是，世界上的程序员太无知或太懒惰，无法在任何地方插入锁。例如，如果多线程程序中的工作线程需要读取 std::string 命令行参数，那么即使只是读取字符串也需要锁定，否则可能会发生崩溃。（2个线程在不同的CPU上同时增加引用计数（+1），但分别减少（-2），因此引用计数下降到零，并且内存被释放。）

因此实现者放弃了引用计数，而是让每个 std::string 始终拥有自己的字符串副本。更多的程序可以工作，但它们都比较慢。

所以现在，即使将一个 std::string 简单地分配给另一个，（或等效地，将 std::string 作为参数传递给函数）也需要大约 400 条机器代码指令，而不是分配 char 所需的 2 条*，减速200倍。

我在一个主要程序上测试了 std::string 效率低下的程度，与以空字符结尾的字符串相比，该程序的整体速度降低了约 100%。我还使用以下代码测试了原始 std::string 分配，这表明 std::string 分配慢了 100-900 倍。（我无法测量 char* 分配的速度）。我还调试了 std::string operator=() 函数——在点击“memcpy()”之前，我最终在堆栈中的膝盖深处，大约 7 层深。

我不确定有什么解决办法。也许如果您需要快速的程序，请使用普通的旧 C++，如果您更关心自己的生产力，您应该使用 Java。

```
#define LIMIT 800000000
clock_t start;
std::string foo1 = "Hello there buddy";
std::string foo2 = "Hello there buddy, yeah you too";
std::string f;

start = clock();
for (int i=0; i < LIMIT; i++) {
    stop();
    f    = foo1;
    foo1 = foo2;
    foo2 = f;
}
double stl = double(clock() - start) / CLOCKS_PER_SEC;

start = clock();
for (int i=0; i < LIMIT; i++) {
    stop();
}
double emptyLoop = double(clock() - start) / CLOCKS_PER_SEC;

char* goo1 = "Hello there buddy";
char* goo2 = "Hello there buddy, yeah you too";
char *g;

start = clock();
for (int i=0; i < LIMIT; i++) {
    stop();
    g = goo1;
    goo1 = goo2;
    goo2 = g;
}
double charLoop = double(clock() - start) / CLOCKS_PER_SEC;

TfcMessage("done", 'i', "Empty loop = %1.3f s\n"
                        "char* loop = %1.3f s\n"
                        "std::string loop = %1.3f s\n\n"
                        "slowdown = %f", 
                        emptyLoop, charLoop, stl, 
                        (stl - emptyLoop) / (charLoop - emptyLoop)); 
```

# c# - C#静态数据库类？

> ID：637719
> 
> 赞同：6
> 
> 时间：2009-03-12T08:19:12.950
> 
> 标签：c#, database, static, data-access-layer, data-access

我有一个包含以下方法的数据库类：

*   public bool ExecuteUDIQuery(string query) // UDI = 更新删除插入
*   public bool ExecuteSelectQuery（字符串查询）
*   public bool ExecuteSP(string sp, string[,] parms)
*   public int ExecuteSPReturnValue(string sp, string[,] parms)

方法的结果存储在私有数据集或数据表中。这些对象被定义为 getter。

大约有 10 个类使用 Database 类。每个类都创建类数据库的一个对象。现在我正在考虑使数据库类静态。这是一个好主意吗？如果是这样，为什么？不，为什么不呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T08:28:02.867

如果我理解，数据库类有一些存储查询结果的属性？如果是这样，您不能将它们设为静态，因为这不是线程安全的。如果查询的结果存储在这些属性中，如果第二个查询在第一个查询之后立即执行会发生什么？它将存储在同一个静态变量中。Web 应用程序也是如此：另一个用户浏览该站点的结果会改变第一个用户的结果。

编辑：总而言之，当您将查询结果存储在静态变量中时，不要将类设为静态，尤其是在网站中使用该类时，因为属性值将在您网站的所有访问者之间共享。如果有 20 个访问者同时进行查询，访问者 1 将看到访问者 20 的查询结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T08:28:24.427

在您的具体示例中，我建议不要将类设为静态：您将状态保持在 Database 类中，并且通过使类成为静态，该状态将在使用您的 Database 的所有类之间共享。在您当前的设置中，每个数据库实例都保持自己的状态，因此数据库调用相互干扰没有问题。

如果您在进行方法调用时重构 Database 类以返回数据集，那么将其设为静态就可以了：Database 类中不会留下任何有状态的信息。

但既然情况并非如此：不，不要使类成为静态的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T08:36:04.767

除了其他关于线程安全的评论之外，还有并行化问题。在您的情况下，您将无法同时打开与数据库的多个连接，并且您将无法执行多个并行查询，即使结果的线程安全不是问题。

所以我同意其他人的观点，不要用它制作静态类。

将类设为静态可能很方便，但创建它的新实例可能不会是一项昂贵的操作，因此在性能方面也可能没有太多收获。

编辑：
我在评论中看到您想在网站上使用您的课程。在那种情况下，你真的不应该这样做。使用静态数据库类，您在任何时候都只能安全地处理一个请求，而这不是您想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T08:29:07.357

这取决于您使用的是哪种数据库或 ORM。但根据我的经验，这似乎是一个好主意，但最终让我感到厌烦。以下是它在 LINQ-to-SQL 中对我的作用：

我有一个存储库类，它有一个数据上下文的静态变量。起初它是有效的，但是当我不得不制作更多的存储库类时，我最终发现了错误，因为我一直在破解。事实证明，LINQ-to-SQL 中的数据上下文缓存了所有结果，并且无法刷新它们。因此，如果您在一个上下文中的表中添加了一篇文章，则它不会显示在缓存该表的其他表中。解决方案是删除静态修饰符并让存储库在构造函数中创建上下文。由于存储库类是在使用时构建的，因此也将构建一个全新的数据上下文。

您可能会争辩说静态变量在内存中留下的足迹更少，但数据上下文的足迹一开始就非常小，最终将被垃圾收集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T20:34:51.487

与答案帖子相反。我已经构建了一个具有静态数据库访问权限的网络框架，它工作得很好并且性能很好。

[您可以在http://www.codeplex.com/Cubes](http://www.codeplex.com/Cubes)查看源代码

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T08:22:09.417

如果您只是对数据库执行查询，那么可以将其设为静态。如果这个对象需要保持某种状态，你只需要创建一个实例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T08:22:52.317

如果您有静态方法，则需要在打开和关闭数据库时跟踪实例。

所以你可能想要做的是有一个名为实例或当前实例的静态方法。并在您创建一个新的数据库类实例，以静态方法返回它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T08:50:41.393

您的方法适合静态使用。我认为，您现在可以轻松地将它们转换为静态方法。

但稍后也许您将需要管理事务。我认为将事务管理留给班级可以节省大量时间。这种情况最适合非静态类。

# security - 何时禁用登录表单上的“保存密码”功能？

> ID：637727
> 
> 赞同：3
> 
> 时间：2009-03-12T08:25:00.190
> 
> 标签：security, language-agnostic, cross-browser

我有一个面向公众的网站，用于为我的客户管理业务基础设施设备。本网站的安全漏洞可能会给客户带来代价高昂的问题。

许多不同的网站——主要是银行、医疗保健和政府——以安全问题为由禁止“保存密码”对话框出现在 Firefox、IE 和其他浏览器中。我说的是在您输入登录信息后出现的框/栏，因此浏览器可以在您下次访问该站点时自动填充用户名/密码字段。

我的问题不是*如何*禁用，因为在[禁用浏览器“保存密码”功能](https://stackoverflow.com/questions/32369/disable-browser-save-password-functionality)问题中回答了这个问题。

我想知道的是：

*   在哪些情况下禁用“保存密码”功能是绝对必要的？有这样的案例吗？
*   这种技术真的能提供任何额外的安全性吗？换句话说，尽管您尽了最大的努力，人们不会找到泄露密码的方法吗？
*   用户是否抱怨删除“保存密码”功能？
*   关于何时禁用“保存密码”功能的任何其他想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-12T08:46:50.433

我抱怨它;-) 我今天实际上只是在考虑这个问题，因为我的网上银行网站禁用了密码自动完成功能，这*真的很*烦人。

虽然不是大多数计算机用户，但有很多人知道如何安全地管理他们的密码，对他们来说，当网站禁用密码字段自动完成时真的很烦人，因为这意味着他们需要做一些事情，比如写密码下来，或者选择一个容易记住的简单密码——这两者都不会让他们高兴，因为正如我所说，这些人非常重视密码安全。使用浏览器的密码管理器几乎是我们所拥有的安全性和便利性之间的最佳折衷方案。烦人的部分是，如果一个网站试图禁用自动完成功能，就*没有简单的方法*可以告诉某些浏览器忽略它。（在 Firefox 中，它需要破解一些 Javascript 文件）

这也与 Joel 曾经写过的关于用户，呃，*人们*喜欢如何控制他们的环境的事情有关。他们不太可能使用（或至少喜欢）自行决定密码管理器不信任他们的程序或网站。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T08:38:18.363

问题是，当您不允许保存密码时，它在什么情况下会**有所帮助**

*   有人闯入您的家，访问您的 PC，访问该站点，现在可以访问 - 嗯，不知何故抽象的想法
*   您丢失了您的笔记本/上网本，有人找到了它，破解了您的密码（希望您的 Whatbook 中有一个），浏览到该站点并获得了访问权限

两者都是偶然的。想要访问帐户的人会使用键盘记录器等间谍软件。但是，当您的 PC 上有键盘记录器时，禁用保存密码功能将无济于事。

> 用户是否抱怨删除“保存密码”功能？

是的，一点没错。用户从不喜欢它被支配。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T08:53:09.093

1）*“在哪些情况下，禁用“保存密码”功能是绝对必要的？这种情况存在吗？”*

没有明确定义的一般规则。这完全取决于提供给用户的服务类型及其相对重要性。例如，网上银行网站禁用了此功能，而普通的基于 Web 的电子邮件站点或在线讨论论坛宁愿打开保存密码功能。这完全取决于您向用户提供什么以及它的相对重要性。

2）*“这种技术真的能提供任何额外的安全性吗？换句话说，尽管你尽了最大的努力，人们不会找到泄露密码的方法吗？”*

是的。这种技术至少阻止了一种可能的密码隐藏方式。但是，它不能保证在任何意义上都不会隐藏密码。从最简单的密码隐藏方式，到捕获击键的键盘记录器，甚至是暴力破解机制，甚至是类似于您的网站的网络钓鱼网站，密码隐藏的途径仍然保持开放。您只是阻止了其中一种方式。

3)*用户是否抱怨删除“保存密码”功能？*

真的取决于用户。一些意识到禁用保存密码功能的重要性的人无论如何都不会抱怨它。而那些只是懒得每次都重新输入凭据的人不必担心。毕竟，用户安全是隐私比用户沮丧更重要，因为我们在这里处理重要数据，我们禁用保存密码功能只是为了用户的利益。

4）*关于何时禁用“保存密码”功能的任何其他想法？*

这又类似于问题 1)。这完全取决于丢失密码的重要性和后果/成本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-12T09:56:06.557

你需要做一些基本的风险评估：

*   您的应用程序有多重要？

如果它是一个在线银行应用程序，可能会因为客户使用公共计算机或笔记本电脑有缺口而导致客户失去投资，那么这不是一个好主意，所以禁用它。

安全性与可用性并不是一场简单的战斗，您需要做出一些牺牲。但是，如果您有两因素身份验证，您可能不会禁用它，因为仅该密码不足以转移资金或做其他狡猾的事情。

*   使用频率如何？

如果这是一个网络邮件或像*twitter*这样的服务，只需启用它。不然你会惹到那么多人。

我不喜欢禁用它的网站，因为我知道要保存什么、不保存什么以及我要承担的风险。但是普通用户不会，因此您**应该为他们做出艰难的决定**。

**您还需要考虑其他不明显的风险：**

*   公用电脑
*   易趣上的旧硬盘
*   在利用之后，所有攻击者都会首先查看这些数据，因为他们知道这是一个很好的战利品。
*   已经发布了仅针对自动完成的密码和用户名的客户端攻击/弱点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T11:45:44.420

我永远不会禁用密码保存。您增加风险的可能性与降低风险的可能性一样大。例子：

1.  用户首次登录您的网站，并手动输入他们的密码
2.  用户访问恶意站点，该站点安装了键盘记录器
3.  用户再次访问您的站点，再次输入密码，键盘记录器将用户密码发送给小偷。

如果用户保存了他们的密码，他们就不必在步骤 3 中再次输入密码，因此键盘记录器不会被用来窃取密码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-18T20:44:05.767

我刚刚从另一端遇到了这个问题（必须禁用“保存密码”功能），对我们来说，这是一个审计问题。一些审计框架将此视为一个安全问题（A 人对应用程序 [基于 Web] 具有某些权限，他们将其凭据保存到浏览器中，B 人使用 A 人的帐户进入应用程序，因为 A 人离开了他们的计算机没有锁定它）。

这并不是说应该有其他控件（强制 Windows 锁定等），但有时某些网站不允许您保存密码的原因是“有效的”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-10T11:19:19.780

所有这些答案都是关于保护用户数据的。我目前正在一个敏感数据位于另一端的网站上工作 - 提供者收费提供对这些数据的访问权限，并希望确保除了那些付费的人之外没有人可以访问它。

显然，在这种情况下，如果数据是他们的，用户​​可能不会像他们那样小心。

所以我们尝试禁用保存密码功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T10:22:02.640

我知道，尤其是在美国，银行安全很松懈。银行网站甚至不应该使用密码保护，因为即使是简单的键盘记录器，它也完全无法保护。

# c++ - 使 C++ 库可用于 .Net

> ID：637729
> 
> 赞同：2
> 
> 时间：2009-03-12T08:26:55.910
> 
> 标签：c++, .net, mono, cross-platform, native

我需要制作一个可用于 .Net 语言（例如 C#）的大型 c++ 库。

该库包含大量可以分为两组的类。Refrence 计数类，它实现了 IRefCounted 抽象类并使用工厂方法来创建它们，并且只是使用 new/delete 的普通类。

此外，还有许多简单的功能。

最初，我只是打算为 c++/clr 中的所有内容编写包装类。但是，希望生成的包装库可以在 Mono 上运行。重新编译库和包装器以针对每个平台很好，但问题是 c++/clr 似乎只能针对 Windows，因为没有编译器可以针对其他平台，因此包装器代码无法在其他平台上工作。 ..

我在这里错过了什么（比如如何在 x 平台上运行 c++/clr 指南）还是有一种替代方法可以使所有 c++ 函数、结构和类对 C# 可用？

编辑： avaible 我的意思是可以在我的 c++ lib 中使用，例如我有

```
//namespace maths{
class Vector2
{
public:
    float x,y;
    Vector2();
    Vector2(const Vector&);
    Vector2(float x, float y);
    float Dot();
    //operators
    ...
}; 
```

然后在 C# id 中希望能够像普通类一样使用它，例如

```
maths::Vector2 a = new maths::Vector2(5, 5);
maths::Vector2 b = new maths::Vector2(1, 10);
b *= 3
maths::Vector2 c = a + b;
//c.x == 8, c.y == 35 
```

但是我也这样做了，我无法编辑 c++ 库，任何事情都必须作为现有类和函数的包装器来完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T15:17:03.590

如果您只针对 Windows，C++/CLI 包装器绝对是最佳选择。它们性能很好，很容易编写和维护等等。但是，正如你所说，这在 Mono 上不起作用。问题是创建的程序集不是 clr:pure 程序集，而是混合了本机代码和 IL 代码的程序集，因此它无法在 Windows 之外运行。此外，如果您要针对 64 位系统，您需要在 C++/CLI 中为 x86 和 x64 目标创建单独的程序集。

SWIG 绝对是一种选择。它可以处理包装 C++ 类的所有复杂性，但是当您遇到更复杂的问题时，通常需要进行一些调整。

我建议查看[SWIG 主站点](http://www.swig.org)，尤其是他们的[C# 部分。](http://www.swig.org/Doc1.3/CSharp.html)

有关使用 SWIG 包装非常复杂的库的好例子，请查看[OGRE Dot Net](http://www.ogre3d.org/wiki/index.php/OgreDotNet)（几乎死了，但仍然是一个很好的例子）或[GDAL](http://www.gdal.org)。据我记得，两者都对 C# 特定功能进行了特殊处理，并处理了引用计数类、枚举等。

SWIG 的另一个好处 - 如果您制作 SWIG 包装器，那么如果您需要，可以很容易地将其扩展到其他语言。一旦有了包装器，制作 Java、python、ruby 等包装器就很容易了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T13:27:09.683

我使用[SWIG](http://www.swig.org/)包装了一些 C++ 代码并从单声道调用它效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T09:41:47.777

如果通过使可用意味着可以进行编辑，则可以在 C++ 中实现模板/宏驱动的反射系统，并在此之上构建 C# 和 Mono 的包装器。有关如何实现它的想法，您可以查看

> DECLARE_DYNAMIC

和

> RUNTIME_CLASS

MFC 中的宏和

> ICustomTypeDescriptor

C#中的接口。

Game Programming Gems 系列中的一些书籍也涵盖了该主题。

另一方面，如果您的意思是使编程可用，那么您显然必须为程序员提供他应该使用的所有类型，即您必须包装它们。

据我了解，Mono 是一个能够执行由 CLR（和其他）生成的字节码的虚拟机，因此您只需要 C# 二进制文件。

# javascript - 在jquery中将ajax数据强制评估为XML

> ID：637734
> 
> 赞同：1
> 
> 时间：2009-03-12T08:28:48.513
> 
> 标签：javascript, jquery, ajax, xml

```
$.ajax({
    type: "GET",
    url: "something.html",
    dataType: "xml",
    success:function(data){} ,
  }); 
```

访问“something.html”时的内容是一个 XML，但上面的调用失败，如果我使用“something.xml”它工作正常。

是否可以让 jQuery 强制将数据评估为 XML，而不用担心文件扩展名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T08:44:33.530

根据文档， dataType 选项用于定义预期的数据类型。扩展无关紧要。未设置数据类型时将使用 MIME 标头。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T08:48:25.517

您的问题与文件扩展名无关，而是与服务器发送的 MIME 类型有关。jQuery 期望根据 dataType 设置，您的服务器将以**text/xml**形式发送响应，而您的服务器可能正在发送 MIME **text/html**，因此正如 kgiannakakis 指出的那样，它会抛出错误。

# c - 内存消耗？

> ID：637740
> 
> 赞同：2
> 
> 时间：2009-03-12T08:29:50.553
> 
> 标签：c, memory, consumption

我有一段代码在哪里

```
for ( ; ; )
{

  char *buf;

  /* Some code */
} 
```

这里的问题是代码在每次循环时分配内存。我的意思是在指针循环时至少会保留 4 个字节。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-12T08:31:49.660

指针的空间将在堆栈上分配，但它会在每次迭代结束时弹出，因此您无需担心。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T08:46:09.093

我认为任何合理的编译器都会优化分配。例如，看一下 GCC 生成的程序集：

```
_foo:
    pushl   %ebp
    movl    %esp, %ebp
    subl    $40, %esp
L2:
    movl    -12(%ebp), %eax
    movl    %eax, (%esp)
    call    L_puts$stub
    jmp     L2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T08:31:31.813

char* 将为每次迭代重新分配，是的，但它也会在下一次迭代之前被释放，所以至少这不会导致内存泄漏（除非你在该循环中使用 malloc 而没有释放）。

无论如何，出于性能原因，您应该将其置于 for 循环之外（尽管编译器可能会对此进行优化并且不会为指针重新分配内存，但我不会指望这一点）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T18:38:58.760

您可能需要担心的是 buf 指向的内存。您剪掉了实际使用 buf 的代码，但如果您使用 malloc() 或类似方法来创建缓冲区，除非您也 free() 它，否则它不会被释放。

# iphone - 如何在 cocos2d 中检测触摸？

> ID：637743
> 
> 赞同：11
> 
> 时间：2009-03-12T08:31:37.087
> 
> 标签：iphone, objective-c, cocos2d-iphone

我正在使用 cocos2d 为 iPhone 开发 2d 游戏。

我在游戏中使用了许多小精灵（图像）。我想触摸两种相似类型的 sprite(image)，然后两个 sprite(image) 都将被隐藏。

如何检测特定精灵（图像）中的触摸？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2011-02-16T13:27:28.350

一个更好的方法是实际使用精灵本身的边界框（它是一个 CGRect）。在这个示例代码中，我将所有精灵放在 NSMutableArray 中，然后简单地检查精灵触摸是否在边界框中。确保在 init 中打开触摸检测。如果您注意到我还通过返回 YES（如果我使用触摸）或 NO（如果我不使用）来接受/拒绝对图层的触摸

```
- (BOOL)ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event 
{
  CGPoint location = [self convertTouchToNodeSpace: touch];

  for (CCSprite *station in _objectList)
  {
    if (CGRectContainsPoint(station.boundingBox, location))
    {
      DLog(@"Found sprite");
      return YES;
    }
  }

  return NO;
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-04-15T00:55:00.223

按照乔纳斯的指示，并添加更多内容......

```
- (void)ccTouchesBegan:(NSSet*)touches withEvent:(UIEvent*)event
{
   UITouch* touch = [touches anyObject];
   CGPoint location = [[[Director sharedDirector] convertCoordinate: touch.location];
   CGRect particularSpriteRect = CGMakeRect(particularSprite.position.x, particularSprite.position.y, particularSprite.contentSize.width, particularSprite.contentSize.height);
   if(CGRectContainsPoint(particularSpriteRect, location)) {
     // particularSprite touched
     return kEventHandled;
   }
} 
```

您可能需要稍微调整 x/ya 以考虑 Cocos 中的“居中定位”

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-03-12T20:18:19.903

在包含精灵的图层中，您需要说：

```
self.isTouchEnabled = YES; 
```

那么您可以使用在 UIView 中使用的相同事件，但它们的命名略有不同：

```
- (void)ccTouchesBegan:(NSSet*)touches withEvent:(UIEvent*)event
{
   UITouch* touch = [touches anyObject];
  //in your touchesEnded event, you would want to see if you touched
  //down and then up inside the same place, and do your logic there.
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-07-02T18:41:43.430

@david，你的代码有一些 cocos 0.7.3 和 2.2.1 的拼写错误，特别是 CGRectMake 而不是 CGMakeRect 并且 [touch location] 现在是 [touch locationInView:touch.view]。

这就是我所做的：

```
- (BOOL)ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch * touch = [touches anyObject];

    CGPoint location = [[Director sharedDirector] convertCoordinate: [touch locationInView:touch.view]];
    CGRect myRect = CGRectMake(sprite.position.x, sprite.position.y, sprite.contentSize.width, sprite.contentSize.height);

    if(CGRectContainsPoint(myRect, location)) {
        // particularSprite touched
        return kEventHandled;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T15:55:29.803

@Genericrich：CGRectContainsPoint 在 CocosLand 中工作，因为上面调用了 2 行：

```
[[Director sharedDirector] convertCoordinate:] 
```

Cocos2D 对象将使用 OpenGL 坐标系，其中 0,0 是左下角，而 UIKit 坐标（如触摸发生的位置）的 0,0 是左上角。convertCoordinate：正在为您从 UIKit 转换为 OpenGL。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-21T11:02:15.837

这是它对我的工作方式...... spriteSize 显然是精灵的大小......：P

```
- (BOOL)ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch * touch = [touches anyObject];

    CGPoint location = [[Director sharedDirector] convertCoordinate: [touch locationInView:touch.view]];
    CGRect myRect = CGRectMake(sprite.position.x-spriteSize/2, sprite.position.y-spriteSize/2, spriteSize, spriteSize);

    if(CGRectContainsPoint(myRect, location)) {
        // particularSprite touched
        return kEventHandled;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-06T00:11:50.650

这是一个很好的教程，解释了基本的触摸系统 [http://ganbarugames.com/2010/12/detecting-touch-events-in-cocos2d-iphone/](http://ganbarugames.com/2010/12/detecting-touch-events-in-cocos2d-iphone/)

首先，写

```
self.isTouchEnabled = YES; 
```

然后，您需要实现函数 ccTouchesEnded、ccTouchesBegan 等

据我了解，您希望能够“匹配”两个可以在屏幕上不同坐标上的精灵。

这样做的方法.. :（我确定还有很多其他方法）

考虑有 2 个全局变量。

所以每次触摸一个精灵时，你都会使用多次提到的 CGRectContainsPoint 函数来查找哪个精灵被触摸了。然后，您可以将该精灵的“标签”保存在其中一个全局变量中。

您对第二次触摸执行相同操作，然后比较 2 个全局变量。

您应该能够弄清楚其余部分，但如果您有问题，请发表评论。

# active-directory - 用于搜索学生的 LDAP 过滤器

> ID：637754
> 
> 赞同：3
> 
> 时间：2009-03-12T08:44:16.183
> 
> 标签：active-directory, ldap

我对 LDAP 和 AD 还很陌生。我想创建一个 LDAP 过滤器来显示 AD 中的所有学生。但问题是学生在不同的BASE DN中：

```
OU=学生,OU=用户,OU=SOE,OU=FOAE,OU=大学,DC=sepang
OU=学生,OU=用户,OU=SOMLC,OU=FOAE,OU=大学,DC=sepang
OU=学生,OU=用户,OU=SOCS,OU=FOS,OU=大学,DC=sepang

```

即对于每个学生来说就像

```
CN =khx72b,OU=STUDENTS,OU=USERS,OU=SOCS,OU=FOS,OU=UNIVERSITY,DC=sepang

```

如您所见，来自不同学院的学生在不同的地方。给定用户名，我如何搜索并查找给定用户是否在目录中？

对`objectClass`所有学生来说是`'user'`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T09:07:15.533

看起来您正在搜索“用户”类型的对象，这些对象位于称为“学生”的 OU 中，但没有共同的父对象。

这不能一步完成（即使用单个 LDAP 查询）。

您必须检索所有名为“STUDENTS”的 OU，并将它们一一用作基本 DN，就像您已经指出的那样。

或者您找到所有学生共享的属性（例如，直接组成员身份，或某处的特殊值）并将其用作过滤器。这是一种更危险的方法，因为无法保证每个学生实际上都具有您所依赖的功能 - 有些可能没有正确输入 AD。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T15:26:15.993

Tomalak 是对的，Microsoft 确实提供了许多可用于此目的的属性，例如“employeeType”、“comment”、“department”、“company”、“department”、“divison”等，但这些属性存在问题是它们没有预先填充任何可以帮助您的信息。您可以开始将其中一种用于将来的目的，但是您必须保持这种做法以使其保持一致。我认为对您来说最简单的解决方案可能是将每个用户放入一个名称类似于 OU 名称的组中，如果他们当前位于同一个 OU 中，这应该是一项非常容易的任务。然后一旦完成，您可以轻松创建一个 LDAP 查询，然后查看该组的成员资格，如下所示：

```
((objectCategory=person)(objectClass=user)(memberOf=CN=STUDENTS GROUP,OU=USERS,OU=SOCS,OU=FOS,OU=UNIVERSITY,DC=sepang)) 
```

请注意，在 LDAP 过滤器中使用“memberOf”时，搜索值必须是组的完整字符串，因此您不能使用通配符，例如：memberOf=CN=STUDENTS GROUP*)。

您仍然需要维护您或某人或某物（例如自动调度脚本任务）的做法，该做法维护组成员身份，以确保您的 LDAP 查询准确无误。

我确实看到[了这篇文章，其中说您可以通过](http://confluence.atlassian.com/display/DEV/How+to+write+a+LDAP+search+filter)[“匹配可分辨名称的组件”](http://confluence.atlassian.com/display/DEV/How+to+write+a+LDAP+search+filter)来做任何额外的事情，但我以前从未见过它，我无法让它工作。另请查看有关 ADO 搜索的[本教程](http://www.rlmueller.net/ADOSearchTips.htm)，以了解有关这些工作的更多信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-28T06:14:16.983

通过将“searchRoot”设置为 OU 的 LDAP 路径来搜索 OU 中的对象。然后，所有搜索都将限制在该 OU 中。

# svn - tortoisesvn - 错误报告请求在 ../../../!svn/vcc/default 上失败

> ID：637756
> 
> 赞同：25
> 
> 时间：2009-03-12T08:44:39.847
> 
> 标签：svn, tortoisesvn, apache2

尝试在 Windows 2003 上使用 Apache 2.2 从特定 Subversion 1.4.x 存储库中签出文件的用户在使用 TortoiseSVN 1.4 签出时突然开始在其日志窗口中收到错误消息：

```
Error REPORT request failed on '/[path_to_repo]/!svn/vcc/default'
Error REPORT of '/[path_to_repo]/!svn/vcc/default': 200 OK (http://[server_name]) 
```

这是在服务器上的高清崩溃以及随后恢复大约 10 个颠覆存储库之后开始的。在尝试工作目录协调后，只有一个存储库出现此问题。repo 所有者通过修改/删除隐藏的 .svn 目录来协调他们的工作目录与存储库（尽管不建议这样做）。

我在互联网上找不到任何能代表我情况的东西。恢复的服务器与原始服务器完全相同，并且此服务器上的其他存储库都没有抛出错误。关于 1）这个错误是什么以及 2）如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-04-09T06:41:50.347

SVN 错误 {REPORT of '/svn/xxxx/!svn/vcc/default': 200 OK} 尝试在 SVN 中检出或更新时，最终通过重新启动 SVN 服务器在我们的站点上得到解决。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-12-08T09:26:19.343

迟到的答案，但我希望它会有用。

我遇到了这个问题，它与服务器无关，而是由客户端上的一个*奇怪*操作引起的（据我所知，重命名目录并且没有提交目标的创建）。

我首先尝试使用以下一行来找出错误目录：

```
for fic in $(find . -type d | grep -v -e './target' -e '/.svn'); do echo $fic; svn up -N $fic; done 
```

该`-N`开关防止 svn 递归到子目录中，这有助于在我的情况下确定错误目录`./src/main/resources/META-INF`。由于我在此目录中没有任何未提交的内容，因此我确实将其删除。

`svn status`指示我该目录丢失了，一个简单的`svn update`方法使它恢复生机并解决了我的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-13T13:37:15.240

您是否对（隐藏的）.svn 目录进行了任何更改？

您可以取回 .svn 目录的原始副本或将其删除。SVN 无法处理版本中的这种“差异”。他认为这是另一个版本，而不是具有不同 .svn 目录的相同版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-11T11:35:54.437

我也有这个问题。

我通过使用 TortoiseSVN 发现，当我更新存储库的某些部分时，它们中的大多数都可以正常工作，但是**一个文件夹抛出了错误。**我进入并更新了部分，并意识到**一个文件已损坏**或其他原因。这是一个csv文件。它的校验和是错误的，编码很奇怪。我删除了该文件并将其替换为该文件的工作版本。错误消失了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-20T15:05:10.213

在我的回购结帐期间，我收到以下错误：

```
svn: E175002: REPORT of '/!svn/vcc/default': 200 OK 
```

我通过 nginx 将 repo 用作 apache 代理。查看 nginx 错误日志，我看到以下内容：

```
[crit] 25839#0: *37 open() "/var/lib/nginx/tmp/proxy/1/00/0000000001" failed (13:     Permission denied) while reading upstream, client: xx.xx.xx.xxx, server: my.domain.com, request: "REPORT /!svn/vcc/default HTTP/1.1", upstream: "http://127.0.0.1:8080/!svn/vcc/default"... 
```

为了最终解决这个问题，我必须更改我的 /var/lib/nginx 文件夹和 /var/lib/nginx/tmp 文件夹上的所有者/组以匹配 /var/lib/nginx/tmp/proxy 正在使用的内容。就我而言，我有一个 apache 和 nginx 使用的特殊“www”用户。该组是“根”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-14T19:26:27.100

我在 Eclipse 和 TurtoiseSVN 上的 SubClipse & Subversive 上遇到了这个问题。我删除了没有解决问题的本地存储库目录。最后，我们增加了解决问题的 Apache 服务器上的 HTTP 超时。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-17T06:52:23.637

背景：我们使用不同用户安装SVN的服务器。

所以我尝试了在当前使用的用户中重新安装 SVN 的选项，它解决了问题。（Windows。同样在第一次安装时，您可以选择让所有用户都使用它）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-02T14:43:11.423

我们在项目中的特定文件夹上遇到了同样的问题。以下解决了问题：

1.  将文件夹备份到外部位置
2.  使用 repo-browser，从 svn 中删除该文件夹。
3.  从计算机中删除了物理文件夹。
4.  发布 SVN 更新。
5.  它可能会导致树冲突。- 将冲突标记为已解决。
6.  确保该文件夹在计算机上不存在。
7.  从备份中恢复文件夹，添加并提交它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-26T01:42:57.793

新的结帐为我解决了这个问题。在我的情况下，问题在于错误地提交到 repo 的目录结构（例如“existingfolder\C:\inputpub\etc...”），这在尝试删除目录并提交后导致了奇怪的问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-07-22T09:23:29.773

我只是再试了几次，最沮丧的是，最终它奏效了。假设是一些糟糕的网络问题导致了这种情况。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-12-05T03:50:50.683

我们尝试清除保存的身份验证后不再遇到错误，删除该文件夹的所有内容`AppData\Roaming\Subversion\auth\`，然后重新登录

# sql-server - SQL 查询 - 跨多个字段搜索

> ID：637757
> 
> 赞同：3
> 
> 时间：2009-03-12T08:45:01.623
> 
> 标签：sql-server, sql-server-2005

我正在尝试实现搜索，您可以在其中输入多个搜索词以形成 AND 条件。它还应该在数据库的不同字段中进行搜索。

例如：
当您输入*"Bill Seattle"*时，您应该得到一条记录，其中**NAME**与*Bill*匹配，**CITY**与*Seattle*匹配。你不应该得到任何只有**CITY**与*Seattle*匹配的行。

现在，这听起来并不复杂，但实际上似乎比我想象的要难。我想出了这样的事情：

```
SELECT * FROM ADDRESS WHERE
((NAME LIKE 'Bill%') OR (NAME LIKE 'Seattle%')) 
AND
((CITY LIKE 'Bill%') OR (CITY LIKE 'Seattle%')) 
```

这在我们之前的案例中运行良好，但假设我们添加另一个字段：

```
SELECT * FROM ADDRESS WHERE
((NAME LIKE 'Bill%') OR (NAME LIKE 'Seattle%')) 
AND
((CITY LIKE 'Bill%') OR (CITY LIKE 'Seattle%'))
AND
((COMPANY LIKE 'Bill%') OR (COMPANY LIKE 'Seattle%')) 
```

现在它不会返回所需的结果。我根本需要（我猜）是一种确定子条件是否像

```
 ((COMPANY LIKE 'Bill%') OR (COMPANY LIKE 'Seattle%')) 
```

返回一些东西，如果没有，我需要忽略那个条件。

顺便说一句，我正在使用 MSSQL '05。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-12T08:50:31.270

首先，我不知道它是如何在 MSSQL 上完成的，但您可能想查看全文搜索。

另一方面，这是否是您真正的意思：

```
SELECT * FROM ADDRESS WHERE
((NAME LIKE 'Bill%') OR (CITY LIKE 'Bill%') OR (COMPANY LIKE 'Bill%'))
AND
((NAME LIKE 'Seattle%') OR (CITY LIKE 'Seattle%') OR (COMPANY LIKE 'Seattle%')) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T08:47:46.393

全文索引允许您同时使用 Contains 和 Conatainstable，这对于您需要的情况非常强大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T09:14:09.213

如果你想把这件事做得很好，那将是非常困难的。在理想情况下，您的程序可以查看每个关键字并确定它的含义，从而确定它应该匹配哪一列。但这需要一些独创性——自然语言识别。

您搜索“Bill Seattle”的示例需要程序将“Bill”识别为人名的一部分，并将“Seattle”识别为城市名称。一个简单的做法是建立所有已知城市的列表并在那里查找关键字，如果找到，将它们标记为城市名称。您可以对公司执行相同的操作，然后将所有既不像城市也不像公司的关键字视为部分人名。使用此分类构建 SQL 查询应该很容易。

但我非常有信心，像我上面描述的简单过程将是脆弱的。因此，除非您使用一些更智能的解析解决方案（请查看OpenCalais 项目中[的示例解析器以获取想法），否则我建议使用简单的方法：](http://viewer.opencalais.com/)

如上所述，最简单的方法是对表的所有文本字段进行全文搜索，然后按排名对结果进行排序——这可能是一个很好的 80-20 解决方案。

# svn - 用于 Web 开发的 Git-SVN — 怎么做？

> ID：637761
> 
> 赞同：1
> 
> 时间：2009-03-12T08:46:28.690
> 
> 标签：svn, git

我们在工作中使用 SVN。我们是一家小型网页设计工作室，同时我们用 PHP 编写开发某种“框架”。

现在我们正在考虑一个更强大的解决方案，我们想试试 git-svn。我们将分支用作不同的项目——一个分支，一个项目。因此，我的计算机中的结构与 wwwroot 中的结构完全相同。一个分支 = 一个项目 = 一个虚拟主机。

当我玩 git-svn 时，我不知道如何用它来实现这一点。我需要分支物理存在于文件系统中，因为我在 Apache 等中有虚拟主机。

你能给我一些建议或指点我一些如何做的教程吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T08:53:33.930

你做错了™。

说真的，分支是为了分支。您应该为不同的项目使用不同的存储库。

如果我做对了，你就有了一个正在开发的框架，以及几个基于该框架的项目。无论您使用何种版本控制系统，都将转化为框架的一个存储库，以及每个项目的一个存储库。

这就是 git 在工作副本中一次只显示一个分支的原因。您通常一次在一个分支上工作。如果您需要所有分支的工作副本，则每个分支都需要一个工作副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-25T19:45:03.957

时间已经向我们展示了最好的解决方案。

我们使用框架的新主要版本完全切换到 git。所以基于旧版本的项目仍然通过 SVN 仓库维护，新的开发在 git 中运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T08:55:01.587

您可以对 Git 本身做类似的事情 - 请参阅[Git 子模块](http://git-scm.com/docs/git-submodule)。

通过这种方式，您可以为每个项目的整个“wwwroot”和子模块创建一个 Git 存储库。如果您只处理几个项目，您可以单独检查/克隆它们。

我从来没有发现 git-svn 是一个好的解决方案。我要么使用 SVN 要么使用 Git，而不是两者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-14T04:31:54.090

我自己刚刚从 svn 切换到 Git，我同意上面的两个答案。

我还建议不要使用 git-svn（除了可能将现有的 svn 存储库导入 Git，作为一次性的单向事件）。而且我还建议为每个项目使用单独的 Git 存储库。

使用 svn，有些人喜欢使用单个存储库，因为它更容易在项目之间共享代码等。使用 Git，您最好为所有共享内容使用单个附加存储库；如果某个项目从某个项目开始，而您稍后想要共享它，请将子树合并（顺便说一下，这是一个专门记录的 Git 术语）到您的共享存储库中。然后，您可以将代码拉回您的其他项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-14T05:40:14.177

正如其他人所说，使用单独的存储库，而不是分支。

使用 SVN，您可以拥有..

```
http://svn/site_a/trunk/
http://svn/site_b/trunk/
etc 
```

然后你可以将`svn co http://svn/site_a/trunk/`每个站点分开

使用 git，您只需创建多个存储库：

```
mkdir site_a
cd site_a
git init
cd ../
mkdir site_b
cd site_b
git init 
```

您可以有一个“主”存储库，每个站点都添加为子模块，但这不是`git-submodule`预期的目的，我发现它比它的价值更麻烦。

`git-svn`除了将 SVN 存储库迁移到 git 或从事您无法控制的项目之外，使用它不是一个好主意。

如果你想使用 gits 分支（还有其他好处），为什么不完全切换到 git 呢？[您可以使用gitosis](http://scie.nti.st/2007/11/14/hosting-git-repositories-the-easy-and-secure-way)之类的东西以某种类似于 SVN 的集中方式进行设置

基本上，如果您喜欢 git，请切换到它（而不是使用 git `git-svn`）。如果您只是为了分支而查看 git，请不要 - 将您的 SVN 存储库拆分为较小的项目（`site_a/trunk/`等等）

# windows - 返回进程id

> ID：637771
> 
> 赞同：1
> 
> 时间：2009-03-12T08:51:55.587
> 
> 标签：windows, process, pid

我有这个问题想要解决。让我们认为我们有这种情况。我们有一个notepad.exe 实例正在运行。我运行另一个notepad.exe。现在我想杀死后者。我该怎么做？

如果我能够知道最后一个 notepad.exe 的 pid，那么我可以杀死它。但是如何获取上次打开程序的 PID 呢？

另一种方法是给每个应用程序一个唯一的图像名称。据我所知，这似乎是不可能的，因为图像名称是硬编码到二进制文件中的。

那么有什么想法吗？

PS 正如您已经注意到的，这一切都在 Windows 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T08:56:39.630

如果这些是其他人的进程（即您没有自己启动它们），那么 Windows 会跟踪[该进程的启动](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.starttime.aspx)时间（或其“[创建时间](http://msdn.microsoft.com/en-us/library/aa394372(VS.85).aspx)”），所以我希望您可以使用该信息找到最后启动的进程.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T08:56:29.273

好吧，你是如何启动这个过程的？例如，如果您从 C# 启动它，则静态`Process.Start`方法会返回一个`Process`实例，该实例具有一个`Id`, 和一个`Kill()`方法。架构/语言之间的机制会有所不同......

如果你不是通过代码来做的，它可能是题外话；-p

# python - Python中带有RegEx的函数解析器

> ID：637773
> 
> 赞同：2
> 
> 时间：2009-03-12T08:52:44.507
> 
> 标签：python, regex

我在 Fortran 中有一个源代码（几乎无关紧要），我想解析函数名和参数。

例如使用

```
(\w+)\([^\(\)]+\) 
```

和

```
a(b(1 + 2 * 2), c(3,4)) 
```

我得到以下信息：（如预期的那样）

```
b, 1 + 2 * 2
c, 3,4 
```

我需要的地方

```
a, b(1 + 2 * 2), c(3,4)
b, 1 + 2 * 2
c, 3,4 
```

有什么建议么？

谢谢你的时间...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T08:55:01.087

我不认为这是正则表达式的工作......他们不能真正处理嵌套模式。

这是因为正则表达式被编译成 FSM（有限状态机）。为了解析任意嵌套的表达式，您不能使用 FSM，因为您需要无限多的状态来跟踪任意嵌套。另请参阅此[SO 线程](https://stackoverflow.com/questions/133601/can-regular-expressions-be-used-to-match-nested-patterns)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T09:07:20.353

这是一种非线性语法——您需要能够递归一组允许的规则。查看[pyparsing](http://pyparsing.wikispaces.com/)通过可读规范进行简单的 CFG（上下文无关语法）解析。

自从我写出 CFG 已经有一段时间了，我可能已经生疏了，所以我将向您介绍[Python EBNF](http://www.python.org/doc/2.4.3/ref/grammar.txt)，以了解如何为语言语法的子集构造一个。

**编辑：**如果示例总是很简单，您可以编写一个小的状态机类/函数来迭代标记化的输入字符串，正如[@Devin Jeanpierre](https://stackoverflow.com/questions/637773/function-parser-with-regex-in-python/637823#637823)建议的那样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T09:12:20.827

它可以用正则表达式来完成——使用它们来标记字符串，并使用标记。即见`re.Scanner`。或者，只需使用 pyparsing。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-13T08:42:19.053

你可以看一下[PLY (Python Lex-Yacc)](http://www.dabeaz.com/ply/)，它（在我看来）非常易于使用并且有据可查，并且它带有一个[计算器示例](http://www.dabeaz.com/ply/example.html)，这可能是一个很好的起点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T10:10:35.227

你不能只用正则表达式来做到这一点。这有点递归。您应该首先匹配最外部的函数及其参数，打印函数的名称，然后对其所有参数执行相同操作（匹配函数名称，然后是其参数）。仅正则表达式是不够的。

# visual-c++ - 使用 CComVariant 访问 SafeArray 的问题

> ID：637780
> 
> 赞同：2
> 
> 时间：2009-03-12T08:54:33.287
> 
> 标签：visual-c++, com, variant

我有以下代码块

```
 /////////////////////////////////////
 CComVariant newVal;

 //pass the CComVariant and get the strings array!!!
 GetStrList(newVal);
 USES_CONVERSION;

 if (((newVal.vt & VT_ARRAY) == VT_ARRAY) && ((newVal.vt & VT_BSTR) == VT_BSTR))
 {
SAFEARRAY* paArray = newVal.parray;
BSTR * str = NULL;
SafeArrayAccessData(paArray, (void**)&str);

SafeArrayUnaccessData(paArray);

long lLBound = 0;
long lUBound = 0;
long nCount = 0;

if (FAILED(SafeArrayGetLBound(paArray, 1, &lLBound)) ||
    FAILED(SafeArrayGetUBound(paArray, 1, &lUBound)))
{
    ASSERT(false);
    return FALSE;
}

nCount = ( lUBound - lLBound + 1 );
for (int i = 0 ; i < nCount ; i++)
{           
    m_cstrList.AddString(W2T(str[i]));                  
}   
//SafeArrayDestroy(paArray); ---> is it required here???

 }

 ///////////////////////////////////// 
```

返回安全数组的方法

```
 HRESULT GetStrList(VARIANT *pVal)
 {
USES_CONVERSION;

if (!pVal)
    return E_FAIL;

SAFEARRAYBOUND bound[1]; //single dimension array
bound[0].lLbound = 0;
bound[0].cElements = 10;

SAFEARRAY * A = SafeArrayCreate(VT_BSTR, 1, bound);

BSTR * str = NULL;
SafeArrayAccessData(A, (void**)&str);

//user wants the NT view OPC drivers list.
for (int i=0;i<10;i++)
{       
    str[i] = SysAllocString(T2W(mystrings[i]));     
}

VariantInit(pVal);
pVal->vt        = VT_ARRAY | VT_BSTR;
pVal->parray    = A;

SafeArrayUnaccessData(A);
A = NULL;

return S_OK;
 } 
```

我的疑问是，上面的第一个代码块有任何内存泄漏吗？它`CComVariant`本身是否处理有关清洁的所有事情？还是我也手动做`SafeArrayDestroy(paArray);`

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T09:04:54.167

CComVariant 析构函数调用 VariantClear() 来释放任何封装的变体，包括数组。

一个警告：在调用 VariantClear() 时不应锁定数组。这意味着如果在 SafeArrayAccessData() 之后但在 SafeArrayUnaccessData() 之前引发异常，则不会调用后者并且 VariantClear() 不会释放资源。

因此，您最好编写一个括号类来配对 SafeArrayAccessData() 和 SafeArrayUnaccessData() 调用。

# ruby-on-rails - Rails 非表格下拉列表

> ID：637787
> 
> 赞同：13
> 
> 时间：2009-03-12T08:56:50.300
> 
> 标签：ruby-on-rails, drop-down-menu

我需要有一个下拉列表，用户可以在其中选择他们每周想要进入的星期几。价值观永远不会改变。只是星期天，星期一，...，星期六，对吗？这似乎比制作表格和输入星期几所需的工作更多。我当然不需要创建、更新或删除它们的能力。有没有一种简单的方法来处理这样的事情？或者，可能不是一周中的几天，而是关闭、停车、倒车、空档、驾驶等状态。最重要的是价值观永远不会改变。只有几个。那么为什么要制作一张桌子呢？我在想有一种方法可以创建一个已经包含数据的模型，但我可能是错的。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-12T09:13:43.787

为什么要创建模型？只需使用选择。

```
DAYS = ['Monday', 'Tuesday', 'Wednesday', ...]
select(:event, :day, DAYS) 
```

将常量放在相关模型中并从那里使用它通常是更好的做法。

在您的模型中：

```
class Event < ActiveRecord::Base
  DAYS = ['Monday', 'Tuesday', 'Wednesday', ...]
end 
```

然后在你看来：

```
select(:event, :day, Event::DAYS) 
```

这是我经常使用的另一个技巧：

```
select(:event, :day, Event::DAYS.collect {|d| [d, Event::DAYS.index(d)]}) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-14T18:59:06.637

请注意，Ruby 的日期类中已经内置了星期几的英文名称。如果可以的话，你应该尝试利用它。这是[rdoc](http://www.ruby-doc.org/core/classes/Date.html)。

然后正如 Can 建议的那样，只需执行以下操作：

```
select(:event, :day, Date::DAYNAMES) 
```

请记住，此解决方案对 i18n 不是特别友好。如果 i18n 是个问题，我还会查看[本地化日期插件](http://www.railway.at/articles/2008/08/07/localized-dates-plugin)以及 Rails 2.2 中为支持 i18n 所做的更改。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-12T09:14:26.327

尝试这个：

```
<%= select_tag(:week_day, options_for_select([['Sunday', 'Sun'], ['Monday', 'Mon'], ...])) %> 
```

见[http://guides.rubyonrails.org/form_helpers.html#theselectandoptionstag](http://guides.rubyonrails.org/form_helpers.html#theselectandoptionstag)

# amazon-ec2 - 当我重新启动 EC2 实例时会发生什么？

> ID：637790
> 
> 赞同：100
> 
> 时间：2009-03-12T08:58:44.213
> 
> 标签：amazon-ec2, amazon-web-services

当我重启 EC2 实例时，我是否会再次获取初始映像，或者是否保留重启前的硬盘状态？

计费会发生什么，小时是重新开始，还是继续我重新启动时所在的小时的一小部分？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-03-12T09:26:57.373

重启实例就像重启 PC。硬盘不受影响。您不会恢复到图像的原始状态，但硬盘的内容是重新启动之前的内容。

重新启动与计费无关。计费在您实例化图像时开始，在您终止图像时停止。中间重新启动没有任何效果。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-12T09:29:21.423

重新启动可保持磁盘完好无损。

如果您关闭实例并启动新实例，磁盘将重置为其初始状态。

这不适用于 EBS 磁盘，即使在关闭时也会持续存在。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-04-09T13:33:16.100

**根据[AWS 文档](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-reboot.html)：**

> 实例重启相当于操作系统重启。在大多数情况下，重启您的实例只需几分钟。当您重新启动实例时，它仍保留在同一物理主机上，因此您的实例会保留其公有 DNS 名称 (IPv4)、私有 IPv4 地址、IPv6 地址（如果适用）以及其实例存储卷上的任何数据。
> 
> 与停止和重新启动实例不同，重启实例不会开始新的实例计费时间。

**此外，他们建议：**

> 我们建议您使用 Amazon EC2 重启您的实例，而不是从您的实例运行操作系统重启命令。如果您使用 Amazon EC2 重启您的实例，如果实例在四分钟内没有完全关闭，我们将执行硬重启。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-01T21:01:18.707

当您重新启动实例时，它将保持相同的管理程序并重新启动 VM，就像正常的 Linux 重新启动一样。

如果您创建了一个带有临时块存储的 VM，那么当您重新启动实例时，您不会丢失临时存储。

如上所述，重启不会影响计费

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-06T18:05:22.710

转到实例并重新启动。我刚刚做了，我所有的状态和数据都完好无损。在一切恢复正常之前等待几分钟。

# python - 使用 ReportLab 显示页数

> ID：637800
> 
> 赞同：13
> 
> 时间：2009-03-12T09:05:34.697
> 
> 标签：python, reportlab

我正在尝试在使用 ReportLab 制作的报告中添加一个简单的“y 页 x”。我发现[了这篇关于它的旧帖子](http://two.pairlist.net/pipermail/reportlab-users/2002-May/000020.html)，但也许六年后出现了更直接的东西？^^;
我也找到[了这个食谱](http://code.activestate.com/recipes/546511/)，但是当我使用它时，生成的 PDF 缺少图像..

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-12T18:54:30.960

我能够从 ActiveState 实现 NumberedCanvas 方法。这很容易做到，并没有改变我现有的代码。我所要做的就是添加 NumberedCanvas 类并在构建我的文档时添加 canvasmaker 属性。我还更改了“x of y”显示位置的测量值：

```
self.doc.build(pdf) 
```

变成了

```
self.doc.build(pdf, canvasmaker=NumberedCanvas) 
```

**doc**是 BaseDocTemplate ，**pdf**是我的可流动元素列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-13T18:32:55.823

使用 doc.multiBuild

并在页眉方法（由“onLaterPages =”定义）中：

```
global TOTALPAGES
if doc.page > TOTALPAGES:
    TOTALPAGES = doc.page
else:
    canvas.drawString(270 * mm, 5 * mm, "Seite %d/%d" % (doc.page,TOTALPAGES)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T11:29:03.463

只是为你挖掘一些代码，我们使用这个：

```
SimpleDocTemplate(...).build(self.story,
                             onFirstPage=self._on_page,
                             onLaterPages=self._on_page) 
```

现在`self._on_page`是一个为每个页面调用的方法，例如：

```
def _on_page(self, canvas, doc):
    # ... do any additional page formatting here for each page
    print doc.page 
```

# c# - C#为图像添加图层

> ID：637801
> 
> 赞同：6
> 
> 时间：2009-03-12T09:05:55.553
> 
> 标签：c#, image

我想为带有公司徽标的图像添加一个图层。

徽标应放置在图像的中心（不透明）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-12T09:10:07.993

这是我之前制作的一个，它为一些图像创建了一个新的徽章：

**编辑，我设计了提供 maxWidth 和 maxHeight 的函数，它调整大小而不会失真。**

要求：

```
using System.IO;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Drawing.Imaging; 
```

编码

```
 using (Image i = Image.FromFile(HttpContext.Current.Server.MapPath(fileName)))
    {
        float imageWidth = i.PhysicalDimension.Width;
        float imageHeight = i.PhysicalDimension.Height;
        float percentage = maxWidth / imageWidth;
        float newWidth = imageWidth * percentage;
        float newHeight = imageHeight * percentage;

        if (newHeight > maxHeight)
        {
            percentage = maxHeight / newHeight;

            newWidth = newWidth * percentage;
            newHeight = newHeight * percentage;
        }

        using (Bitmap b = new Bitmap((int)newWidth, (int)newHeight))
        {
            using (Graphics g = Graphics.FromImage(b))
            {
                g.InterpolationMode = InterpolationMode.HighQualityBicubic;
                g.SmoothingMode = SmoothingMode.AntiAlias;
                g.PixelOffsetMode = PixelOffsetMode.HighQuality;
                g.CompositingQuality = CompositingQuality.HighQuality;
                g.TextRenderingHint = System.Drawing.Text.TextRenderingHint.AntiAlias;

                g.DrawImage(i, new Rectangle(0, 0, b.Width, b.Height));

                if (effect == "new")
                {
                    using (Image j = Image.FromFile(HttpContext.Current.Server.MapPath("/ImageEffects/") + "new.png", true))
                    {
                        g.DrawImage(j, new Rectangle(0, 0, 60, 60));

                    }
                }

                Image newImage = Image.FromHbitmap(b.GetHbitmap());

                return newImage;
            }
        }

    }
} 
```

# xml - 如何在 Oracle DB 中禁用 XML DTD 验证？

> ID：637803
> 
> 赞同：2
> 
> 时间：2009-03-12T09:06:43.540
> 
> 标签：xml, database, oracle, validation, dtd

我在查询的选择部分使用以下语句：

```
extract(XMLTYPE(doc.payload),'/SHOW_SHIPMENT_005/DATAAREA/SHOW_SHIPMENT/SHIPMENT/SHIPITEM/DOCUMNTREF/DOCUMENTID') 
```

如果`doc.payload`包含`XML`没有`DTD`声明，它工作得很好，但是当声明存在时引发错误，`DTD`因为 Oracle 尝试验证文档但找不到`DTD`.

如何禁用`XML`此查询的验证？我不想在这件事上影响我的会话设置或全局系统设置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T14:31:40.713

您可以在创建 XMLTYPE 时关闭验证，构造函数签名如下所示：

```
XMLType(
   xmlData IN varchar2,
   schema IN varchar2 := NULL,
   validated IN number := 0,
   wellformed IN number := 0) 
```

所以你可以像这样禁用验证：

```
 extract(XMLTYPE(doc.payload, NULL, 1, 1),
'/SHOW_SHIPMENT_005/DATAAREA/SHOW_SHIPMENT/SHIPMENT/SHIPITEM/DOCUMNTREF/DOCUMENTID') 
```

但是，如果您有外部 DTD 引用，这对您没有帮助。它仍然会尝试加载它。不能将 DTD 文件上传到 XMLDB 存储库吗？那将是最简单的解决方案。如果不是，则没有“好的”解决方案，您必须在创建 XMLTYPE 之前摆脱 DTD 引用：

```
 extract(XMLTYPE(REGEXP_REPLACE(doc.payload, '<!DOCTYPE[^<]*>', '')),
'/SHOW_SHIPMENT_005/DATAAREA/SHOW_SHIPMENT/SHIPMENT/SHIPITEM/DOCUMNTREF/DOCUMENTID') 
```

# jquery - 我如何使用 jquery 用新样式替换样式

> ID：637811
> 
> 赞同：0
> 
> 时间：2009-03-12T09:09:08.773
> 
> 标签：jquery

我正在使用 jquery 将 css 下面插入到 head 标记中，但问题是每次我使用用户界面更改颜色时，它都会添加另一种样式，而不是 css，我如何删除已经添加并替换为新 css 请帮助。

```
<style charset="utf-8" type="text/css">div.contentMid2{background:#000;}div.module{background:#fff;}</style> 
```

想在运行时添加几个 css 但替换为已添加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T10:50:47.907

如果您需要动态更改 css 值 ( `background-color:VARIABLE`)，您可以执行以下操作之一：

*   使用 ajax，您请求具有新值的新样式表。之后，将其注入`head`标签。
*   每次需要更改时遍历所有 DOM。`$('.someDIv').css()`. 不过要小心，这种方式可能会消耗大量资源:)

如果您只需要添加一些静态 css，您可以从以下位置添加/删除类`body`：

```
$('body').addClass('new') 
```

或者

```
$('body').addClass('new2') 
```

并来自 CSS：

```
.someClass {background:red}
body.new .someClass {background:blue}
body.new2 .someClass {background:green} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T09:51:10.047

$('div.contentMid2').css({background:'#000'})

# c# - 查找窗口高度和宽度

> ID：637819
> 
> 赞同：4
> 
> 时间：2009-03-12T09:10:46.587
> 
> 标签：c#

如何找到焦点窗口的高度和宽度..

它可能是任何 Windows 窗口，如记事本、mspaint 等......我可以通过这段代码获得焦点窗口

```
[DllImport("user32")] 
public static extern IntPtr GetForegroundWindow(); 
```

嗨 f3lix 它正在工作，但它的返回值仅取决于位置.. 如果我更改位置，它会返回一些其他值

Kunal 它返回错误消息....就像未设置对象引用

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-12T09:29:54.480

我认为您必须通过 PInvoke 使用 user32.dll 函数。我不确定，但我会这样做：

```
[DllImport("user32.dll")]
static extern IntPtr GetForegroundWindow();

[DllImport("user32.dll", SetLastError = true)]
static extern bool GetWindowRect(IntPtr hWnd, out Rectangle lpRect); 

Rectangle rect = new Rectangle();
GetWindowRect(GetForegroundWindow(), out rect); 
```

*注意：*我没有尝试此代码，因为我目前不在 Windows 上工作...

**编辑**： [Rory](https://stackoverflow.com/users/8479/rory)向我指出（见评论）我们不能在这里使用标准的 Rectangle，我们需要定义我们自己的 RECT。

```
[StructLayout(LayoutKind.Sequential)]
public struct RECT {
    public int Left;
    public int Top;
    public int Right;
    public int Bottom;
} 
```

不要忘记在第一段代码中将*Rectangle*替换为*RECT 。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-24T11:12:06.013

```
[DllImport("user32.dll")]
public static extern bool GetWindowRect(IntPtr hWnd, out RECT lpRect);           

public static Size GetControlSize(IntPtr hWnd)
{
    RECT pRect;
    Size cSize = new Size();
    // get coordinates relative to window
    GetWindowRect(hWnd, out pRect);

    cSize.Width = pRect.Right - pRect.Left;
    cSize.Height = pRect.Bottom - pRect.Top;

    return cSize;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T09:16:48.053

如果您正在构建 MDI 应用程序，您可以使用：

```
parentForm.ActiveMDIChild.Size 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T09:20:11.133

你的问题到底是什么？

1.  如何获得焦点窗口？
2.  如何获取窗口的宽度和高度？

如果问题 2，使用`Window.ActualWidth`和`Window.ActualHeight`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T09:56:42.250

如果你的窗口在你的应用程序中，有一个 MDI 应用程序，你可以使用这个，有

```
public static extern IntPtr GetForegroundWindow(); 
```

和你一起试试这个

```
int wHeight = Control.FromHandle(GetForegroundWindow()).Height;
int wWidth = Control.FromHandle(GetForegroundWindow()).Width; 
```

# embedded - pthread_cancel 在 arm 和 ppc 上的行为不同？

> ID：637824
> 
> 赞同：5
> 
> 时间：2009-03-12T09:12:38.237
> 
> 标签：embedded, pthreads, arm

我目前正在开发一个多线程应用程序，该应用程序将部署在 arm 和 ppc 架构上。我对手臂上的 pthread_cancel 有一些问题。

arm 上的 pthread_cancel 与 ppc 的行为不同。线程被取消，但线程局部变量的析构函数没有在 arm 上调用。我还尝试明确定义通过 pthread_cleanup_push 安装的取消清理处理程序例程。但是当线程被取消时它不会被调用。

该代码适用于 ppc。当线程被取消时，将调用局部变量的析构函数。当我明确定义一个清理处理程序时，它在调用 pthread_cancel 时被调用并执行。

我错过了什么吗？也许一些编译器选项？

*   编程语言：C++
*   编译器：arm-linux-g++/powerpc-linux-g++
*   操作系统：Linux

编辑：

我在这个[libc bug](http://sourceware.org/ml/glibc-bugs/2007-03/msg00006.html)上发现了一种类似的问题。

使用 gcc 而不是 g++ 并添加 -fno-exception 编译器选项就可以了。但我真的很想了解这个问题背后的东西。此外，-fno-exception 意味着我将无法在我的应用程序中执行异常处理，并不是说我现在正在使用它，但我可能会在将来使用它。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T19:46:50.370

在没有应用程序帮助的情况下取消线程是个坏主意。只是[谷歌](http://www.google.com/search?hl=en&q=thread+cancellation+problem)。最好通过设置一个由线程定期检查的标志变量来告诉线程自行结束。

实际上取消是如此困难，以至于在最新的 C++0x 草案中已将其省略。您可以搜索[http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2497.html](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2497.html)并且根本找不到任何取消的提及。这是提议的线程类的定义（你不会在那里找到取消）：

```
class thread
{
public:
    // types:
    class id;
    typedef implementation-defined native_handle_type; // See [thread.native]

    // construct/copy/destroy:
    thread();
    template <class F> explicit thread(F f);
    template <class F, class ...Args> thread(F&& f, Args&&... args);
    ~thread();
    thread(const thread&) = delete;
    thread(thread&&);
    thread& operator=(const thread&) = delete;
    thread& operator=(thread&&);

    // members:
    void swap(thread&&);
    bool joinable() const;
    void join();
    void detach();
    id get_id() const;
    native_handle_type native_handle(); // See [thread.native]

    // static members:
    static unsigned hardware_concurrency();
}; 
```

# bash - 在 Bash 中重定向标准错误和标准输出

> ID：637827
> 
> 赞同：763
> 
> 时间：2009-03-12T09:14:05.580
> 
> 标签：bash, shell, stdout, io-redirection, stderr

我想将进程的[标准输出](https://en.wikipedia.org/wiki/Standard_streams#Standard_output_.28stdout.29)和[标准错误](https://en.wikipedia.org/wiki/Standard_streams#Standard_error_(stderr))都重定向到单个文件。我如何在 Bash 中做到这一点？

* * *

## 回答 #1

> 赞同：850
> 
> 时间：2009-03-12T09:17:25.790

看看[这里](http://tldp.org/LDP/abs/html/io-redirection.html)。它应该是：

```
yourcommand &> filename 
```

它将标准输出和标准错误都重定向到文件*filename*。

* * *

## 回答 #2

> 赞同：500
> 
> 时间：2009-03-12T09:16:20.490

```
do_something 2>&1 | tee -a some_file 
```

这会将标准错误重定向到标准输出和标准输出`some_file` **并将**其打印到标准输出。

* * *

## 回答 #3

> 赞同：285
> 
> 时间：2009-03-12T09:17:20.253

您可以将*stderr*重定向到*stdout*并将*stdout*重定向到文件中：

```
some_command >file.log 2>&1 
```

请参阅*[第 20 章。 I/O 重定向](http://tldp.org/LDP/abs/html/io-redirection.html)*

`&>`这种格式比仅适用于 Bash的最流行的格式更受欢迎。在 Bourne shell 中，它可以被解释为在后台运行命令。格式也更具可读性 - *2*（是标准错误）重定向到*1*（标准输出）。

* * *

## 回答 #4

> 赞同：232
> 
> 时间：2013-12-13T10:30:31.397

```
# Close standard output file descriptor
exec 1<&-
# Close standard error file descriptor
exec 2<&-

# Open standard output as $LOG_FILE file for read and write.
exec 1<>$LOG_FILE

# Redirect standard error to standard output
exec 2>&1

echo "This line will appear in $LOG_FILE, not 'on screen'" 
```

现在，一个简单的回显将写入 $LOG_FILE，它对于守护进程很有用。

致原帖作者，

这取决于你需要实现什么。如果您只需要重定向输入/输出从脚本调用的命令，那么答案已经给出。*我的是关于在*当前脚本中重定向，这会影响提到的代码片段之后的所有命令/内置插件（包括叉子）。

* * *

另一个很酷的解决方案是重定向到标准错误和标准输出*，并*立即记录到日志文件，这涉及将“一个流”分成两个。此功能由 'tee' 命令提供，该命令可以一次写入/附加到多个文件描述符（文件、套接字、管道等）：`tee FILE1 FILE2 ... >(cmd1) >(cmd2) ...`

```
exec 3>&1 4>&2 1> >(tee >(logger -i -t 'my_script_tag') >&3) 2> >(tee >(logger -i -t 'my_script_tag') >&4)
trap 'cleanup' INT QUIT TERM EXIT

get_pids_of_ppid() {
    local ppid="$1"

    RETVAL=''
    local pids=`ps x -o pid,ppid | awk "\\$2 == \\"$ppid\\" { print \\$1 }"`
    RETVAL="$pids"
}

# Needed to kill processes running in background
cleanup() {
    local current_pid element
    local pids=( "$$" )

    running_pids=("${pids[@]}")

    while :; do
        current_pid="${running_pids[0]}"
        [ -z "$current_pid" ] && break

        running_pids=("${running_pids[@]:1}")
        get_pids_of_ppid $current_pid
        local new_pids="$RETVAL"
        [ -z "$new_pids" ] && continue

        for element in $new_pids; do
            running_pids+=("$element")
            pids=("$element" "${pids[@]}")
        done
    done

    kill ${pids[@]} 2>/dev/null
} 
```

所以，从一开始。假设我们有一个终端连接到*/dev/stdout*（文件描述符 #1）和 /dev/stderr（文件描述符 #2）。在实践中，它可以是管道、套接字或其他任何东西。

*   创建[文件描述符](https://en.wikipedia.org/wiki/File_descriptor)(FD) #3 和 #4 并分别指向与 #1 和 #2 相同的“位置”。从现在开始，更改文件描述符 #1 不会影响文件描述符 #3。现在，文件描述符#3 和#4 分别指向标准输出和标准错误。这些将用作**真正的**终端标准输出和标准错误。
*   1> >(...) 将标准输出重定向到括号中的命令
*   括号（子shell）执行'tee'，从exec的标准输出（管道）读取并通过另一个管道重定向到'logger'命令到括号中的子shell。同时它将相同的输入复制到文件描述符#3（终端）
*   第二部分非常相似，是关于对标准错误和文件描述符#2 和#4 执行相同的技巧。

运行具有上述行和另外这一行的脚本的结果：

```
echo "Will end up in standard output (terminal) and /var/log/messages" 
```

...如下：

```
$ ./my_script
Will end up in standard output (terminal) and /var/log/messages

$ tail -n1 /var/log/messages
Sep 23 15:54:03 wks056 my_script_tag[11644]: Will end up in standard output (terminal) and /var/log/messages 
```

如果您想看到更清晰的图片，请将这两行添加到脚本中：

```
ls -l /proc/self/fd/
ps xf 
```

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2009-03-12T09:17:03.623

```
bash your_script.sh 1>file.log 2>&1 
```

`1>file.log`指示 shell 将标准输出发送到文件`file.log`，并`2>&1`告诉它将标准错误（文件描述符 2）重定向到标准输出（文件描述符 1）。

**注意：**订单很重要，正如 liw.fi 指出的那样，`2>&1 1>file.log`不起作用。

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2009-05-06T14:12:30.160

奇怪的是，这有效：

```
yourcommand &> filename 
```

但这会产生语法错误：

```
yourcommand &>> filename
syntax error near unexpected token `>' 
```

你必须使用：

```
yourcommand 1>> filename 2>&1 
```

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2017-11-19T01:55:27.873

简短回答：`Command >filename 2>&1`或`Command &>filename`

* * *

解释：

考虑以下代码，它将单词“stdout”打印到stdout，将单词“stderror”打印到stderror。

```
$ (echo "stdout"; echo "stderror" >&2)
stdout
stderror 
```

请注意，'&' 运算符告诉 bash 2 是文件描述符（指向 stderr）而不是文件名。如果我们省略了 '&'，此命令将打印`stdout`到标准输出，并创建一个名为“2”的文件并`stderror`在那里写入。

通过试验上面的代码，您可以自己了解重定向运算符的工作原理。例如，通过更改两个描述符中的哪个文件`1,2`被重定向到`/dev/null`以下两行代码，分别从 stdout 和 stderror 中删除所有内容（打印剩余的内容）。

```
$ (echo "stdout"; echo "stderror" >&2) 1>/dev/null
stderror
$ (echo "stdout"; echo "stderror" >&2) 2>/dev/null
stdout 
```

现在，我们可以解释为什么以下代码不产生输出的解决方案：

```
(echo "stdout"; echo "stderror" >&2) >/dev/null 2>&1 
```

要真正理解这一点，我强烈建议您阅读[有关文件描述符表的网页](http://www.catonmat.net/blog/bash-one-liners-explained-part-three/)。假设您已经完成了阅读，我们可以继续。请注意，Bash 从左到右处理；因此 Bash`>/dev/null`首先看到（与 相同`1>/dev/null`），并将文件描述符 1 设置为指向 /dev/null 而不是 stdout。完成此操作后，Bash 向右移动并看到`2>&1`。这会将文件描述符 2 设置**为指向与**文件描述符 1 相同的文件（而不是指向文件描述符 1 本身！！！！（请参阅[this resource on pointers）](http://cslibrary.stanford.edu/106/)了解更多信息））。由于文件描述符 1 指向 /dev/null，并且文件描述符 2 指向与文件描述符 1 相同的文件，因此文件描述符 2 现在也指向 /dev/null。因此，两个文件描述符都指向 /dev/null，这就是不呈现输出的原因。

* * *

为了测试你是否真的理解这个概念，试着猜测我们切换重定向顺序时的输出：

```
(echo "stdout"; echo "stderror" >&2)  2>&1 >/dev/null 
```

> 标准错误

这里的原因是，从左到右计算，Bash 看到 2>&1，因此将文件描述符 2 设置为指向与文件描述符 1 相同的位置，即 stdout。然后它将文件描述符 1（记住 >/dev/null = 1>/dev/null）设置为指向 >/dev/null，从而删除通常发送到标准输出的所有内容。因此，我们只剩下没有发送到子shell 中的stdout 的内容（括号中的代码）——即“stderror”。有趣的是，即使 1 只是一个指向 stdout 的指针，将指针 2 重定向到 1 via`2>&1`不会形成指针链 2 -> 1 -> stdout。如果是这样，由于将 1 重定向到 /dev/null，代码`2>&1 >/dev/null`将给出指针链 2 -> 1 -> /dev/null，因此代码不会生成任何内容，与我们在上面看到的相反。

* * *

最后，我注意到有一种更简单的方法可以做到这一点：

[从这里](https://www.gnu.org/software/bash/manual/html_node/Redirections.html)的第 3.6.4 节，我们看到我们可以使用操作符`&>`来重定向 stdout 和 stderr。因此，要将任何命令的 stderr 和 stdout 输出重定向到`\dev\null`（删除输出），我们只需键入 `$ command &> /dev/null` or 在我的示例中：

```
$ (echo "stdout"; echo "stderror" >&2) &>/dev/null 
```

* * *

关键要点：

*   文件描述符的行为类似于指针（尽管文件描述符与文件指针不同）
*   将文件描述符“a”重定向到指向文件“f”的文件描述符“b”会导致文件描述符“a”指向与文件描述符 b 相同的位置 - 文件“f”。它不会形成指针链 a -> b -> f
*   由于上述原因，顺序很重要，`2>&1 >/dev/null`是 != `>/dev/null 2>&1`。一个产生输出，另一个不产生！

* * *

最后看看这些很棒的资源：

[关于重定向的 Bash 文档](https://www.gnu.org/software/bash/manual/html_node/Redirections.html)，[文件描述符表的解释，](http://www.catonmat.net/blog/bash-one-liners-explained-part-three/)指针[简介](http://cslibrary.stanford.edu/106/)

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-04-23T13:14:35.040

```
LOG_FACILITY="local7.notice"
LOG_TOPIC="my-prog-name"
LOG_TOPIC_OUT="$LOG_TOPIC-out[$$]"
LOG_TOPIC_ERR="$LOG_TOPIC-err[$$]"

exec 3>&1 > >(tee -a /dev/fd/3 | logger -p "$LOG_FACILITY" -t "$LOG_TOPIC_OUT" )
exec 2> >(logger -p "$LOG_FACILITY" -t "$LOG_TOPIC_ERR" ) 
```

相关：将标准输出和标准错误写入[syslog](https://en.wikipedia.org/wiki/Syslog)。

它几乎可以工作，但不是来自[xinetd](https://en.wikipedia.org/wiki/Xinetd) ;(

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2018-10-24T17:45:01.760

对于需要“管道”的情况，您可以使用[`|&`](https://stackoverflow.com/questions/35384999/what-does-mean-in-bash).

例如：

```
echo -ne "15\n100\n" | sort -c |& tee >sort_result.txt 
```

或者

```
TIMEFORMAT=%R;for i in `seq 1 20` ; do time kubectl get pods | grep node >>js.log ; done |& sort -h 
```

这些基于 Bash 的解决方案可以分别管道标准输出和标准错误（从“sort -c”的标准错误，或从“sort -h”的标准错误）。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2017-01-19T19:21:18.827

我想要一个解决方案，将 stdout 和 stderr 的输出写入日志文件，而 stderr 仍在控制台上。所以我需要通过 tee 复制 stderr 输出。

这是我找到的解决方案：

```
command 3>&1 1>&2 2>&3 1>>logfile | tee -a logfile 
```

*   首先交换stderr和stdout
*   然后将标准输出附加到日志文件
*   管道 stderr 到 tee 并将其也附加到日志文件

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-09-14T16:35:13.983

除了[费尔南多·法布雷蒂所做](https://stackoverflow.com/questions/637827/redirect-stderr-and-stdout-in-bash/51542989#51542989)的之外，我稍微改变了功能并删除了`&-`关闭，它对我有用。

```
 function saveStandardOutputs {
      if [ "$OUTPUTS_REDIRECTED" == "false" ]; then
        exec 3>&1
        exec 4>&2
        trap restoreStandardOutputs EXIT
      else
          echo "[ERROR]: ${FUNCNAME[0]}: Cannot save standard outputs because they have been redirected before"
          exit 1;
      fi
  }

  # Parameters: $1 => logfile to write to
  function redirectOutputsToLogfile {
      if [ "$OUTPUTS_REDIRECTED" == "false" ]; then
        LOGFILE=$1
        if [ -z "$LOGFILE" ]; then
            echo "[ERROR]: ${FUNCNAME[0]}: logfile empty [$LOGFILE]"
        fi
        if [ ! -f $LOGFILE ]; then
            touch $LOGFILE
        fi
        if [ ! -f $LOGFILE ]; then
            echo "[ERROR]: ${FUNCNAME[0]}: creating logfile [$LOGFILE]"
            exit 1
        fi
        saveStandardOutputs
        exec 1>>${LOGFILE}
        exec 2>&1
        OUTPUTS_REDIRECTED="true"
      else
        echo "[ERROR]: ${FUNCNAME[0]}: Cannot redirect standard outputs because they have been redirected before"
          exit 1;
      fi
  }

  function restoreStandardOutputs {
      if [ "$OUTPUTS_REDIRECTED" == "true" ]; then
      exec 1>&3   #restore stdout
      exec 2>&4   #restore stderr
      OUTPUTS_REDIRECTED="false"
     fi
  }

  LOGFILE_NAME="tmp/one.log"
  OUTPUTS_REDIRECTED="false"

  echo "this goes to standard output"
  redirectOutputsToLogfile $LOGFILE_NAME
  echo "this goes to logfile"
  echo "${LOGFILE_NAME}"
  restoreStandardOutputs
  echo "After restore this goes to standard output" 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-04-22T19:16:16.773

在您考虑使用类似的东西的情况下`exec 2>&1`，我发现如果可能的话，使用这样的 Bash 函数重写代码更容易阅读：

```
function myfunc(){
  [...]
}

myfunc &>mylog.log 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-02-04T13:57:37.810

“最简单”的方式（仅限 Bash 4）：

```
ls * 2>&- 1>&- 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-07-26T15:53:15.073

以下函数可用于自动切换输出 beetwen stdout/stderr 和日志文件的过程。

```
#!/bin/bash

    #set -x

    # global vars
    OUTPUTS_REDIRECTED="false"
    LOGFILE=/dev/stdout

    # "private" function used by redirect_outputs_to_logfile()
    function save_standard_outputs {
        if [ "$OUTPUTS_REDIRECTED" == "true" ]; then
            echo "[ERROR]: ${FUNCNAME[0]}: Cannot save standard outputs because they have been redirected before"
            exit 1;
        fi
        exec 3>&1
        exec 4>&2

        trap restore_standard_outputs EXIT
    }

    # Params: $1 => logfile to write to
    function redirect_outputs_to_logfile {
        if [ "$OUTPUTS_REDIRECTED" == "true" ]; then
            echo "[ERROR]: ${FUNCNAME[0]}: Cannot redirect standard outputs because they have been redirected before"
            exit 1;
        fi
        LOGFILE=$1
        if [ -z "$LOGFILE" ]; then
            echo "[ERROR]: ${FUNCNAME[0]}: logfile empty [$LOGFILE]"

        fi
        if [ ! -f $LOGFILE ]; then
            touch $LOGFILE
        fi
        if [ ! -f $LOGFILE ]; then
            echo "[ERROR]: ${FUNCNAME[0]}: creating logfile [$LOGFILE]"
            exit 1
        fi

        save_standard_outputs

        exec 1>>${LOGFILE%.log}.log
        exec 2>&1
        OUTPUTS_REDIRECTED="true"
    }

    # "private" function used by save_standard_outputs() 
    function restore_standard_outputs {
        if [ "$OUTPUTS_REDIRECTED" == "false" ]; then
            echo "[ERROR]: ${FUNCNAME[0]}: Cannot restore standard outputs because they have NOT been redirected"
            exit 1;
        fi
        exec 1>&-   #closes FD 1 (logfile)
        exec 2>&-   #closes FD 2 (logfile)
        exec 2>&4   #restore stderr
        exec 1>&3   #restore stdout

        OUTPUTS_REDIRECTED="false"
    } 
```

脚本内部使用示例：

```
echo "this goes to stdout"
redirect_outputs_to_logfile /tmp/one.log
echo "this goes to logfile"
restore_standard_outputs 
echo "this goes to stdout" 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-04-23T05:07:32.917

对于[tcsh](https://en.wikipedia.org/wiki/Tcsh)，我必须使用以下命令：

```
command >& file 
```

如果使用`command &> file`，它将给出“无效的空命令”错误。

# uri - 地理位置uri方案

> ID：637840
> 
> 赞同：4
> 
> 时间：2009-03-12T09:17:44.917
> 
> 标签：uri

我想使用 URI 方案使我的一个应用程序的用户能够共享地理位置。

我不想发明自己的 URI 方案，“geo”似乎是最合适的，但是关于这个主题只有两个 Internet 草案（[draft-mayrhofer-geo-uri-01](https://datatracker.ietf.org/doc/html/draft-mayrhofer-geo-uri-01)、[draft-mayrhofer-geo-uri-02](https://datatracker.ietf.org/doc/html/draft-mayrhofer-geo-uri-02)） ，两者都已过期，并且在接近标准的方式上大相径庭。

是否有适合编码纬度和经度并使其成为 RFC 的 URI？我应该使用通用 URI，例如[标签 URI 方案](http://www.faqs.org/rfcs/rfc4151.html)吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-21T14:51:03.200

最后说明：该草案现在在 IETF 的 RFC 编辑队列中，因此它应该在未来 3 到 5 个月内成为 RFC。

[https://datatracker.ietf.org/doc/html/draft-ietf-geopriv-geo-uri-07](https://datatracker.ietf.org/doc/html/draft-ietf-geopriv-geo-uri-07)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T16:56:18.983

最新的[草稿](https://datatracker.ietf.org/doc/html/draft-mayrhofer-geopriv-geo-uri-01)是 2009 年 2 月 12 日。看起来要走的路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-19T16:45:36.317

地理 URI 方案定义现在是 RFC 5870（自 2010 年 6 月起）：

[http://www.rfc-editor.org/info/rfc5870](http://www.rfc-editor.org/info/rfc5870)

# apache-flex - Flex - 在收到标准事件时调度自定义事件

> ID：637841
> 
> 赞同：0
> 
> 时间：2009-03-12T09:18:52.370
> 
> 标签：apache-flex, actionscript-3, filereferencelist

我正在处理用户在以下代码中选择的多个文件的 FileReferenceList.fileList[]。

```
for (i=0;i < event.currentTarget.fileList.length; i ++){
 fileByteData = new ByteArray();
 fileByteData = (event.currentTarget.fileList[i].data as ByteArray);                
 loader = new Loader();
 loader.contentLoaderInfo.addEventListener(Event.COMPLETE, checkImageDimensions);
 loader.loadBytes(fileByteData);                    
} 
```

我需要将 i 传递给 checkImageDimensions 以跟踪哪个图像是哪个，我可以轻松地创建一个自定义事件，但我需要在正确的时间触发它。理想情况下我可以做这样的事情..

```
var myEvent:CustomEvent = new CustomEvent(i);
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, this.dispatchEvent(CustomEvent)) 
```

但老实说，我不确定如何进行......

谁能帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T13:19:03.713

您需要创建一个侦听器函数 - 函数调用是不够的。将类名传递给`dispatchEvent`也不起作用。这是如何做到的。

```
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, function(e:Event):void {
    dispatchEvent(new CustomEvent(i));
}); 
```

请注意，如果您在事件中只需要一个类型字符串，则不一定需要自定义事件类。在这种情况下，您可以简单地使用 Event 类：

```
public static const MY_CUSTOM_EVENT:String = "myCustomEvent";    
...
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, function(e:Event):void {
    dispatchEvent(new Event(MY_CUSTOM_EVENT));
}); 
```

**编辑**：如果您真的很懒，但仍想通过事件传递值，则可以使用`DinamicEvent`该类：

```
var evt:DynamicEvent = new DynamicEvent(MY_CUSTOM_EVENT);
evt.attr1 = val1;
evt.attr2 = val2;
dispatchEvent(evt); 
```

当然，声明自己的错误类更简洁，更不容易出错。

# networking - 莫名其妙的网络查询

> ID：637842
> 
> 赞同：0
> 
> 时间：2009-03-12T09:19:10.140
> 
> 标签：networking

一个随机的问题（我知道很多涉及的技术都没有描述）但是那里有任何网络专家可以回答一个让我困惑的可能是简单的 M$ 网络问题吗？

今天以与我日常相同的方式将我的笔记本电脑连接到公司网络。我按照正常情况分配了一个 IP 地址，但与正常情况不同的是，我没有连接到互联网。

重新启动和 ipconfig /release /renew 后情况是一样的。IP 地址，但没有连接。

所以我请来了技术人员，他们更换了我的机器和网络端口之间的以太网电缆，一切都恢复了活力——完全恢复了连接。

我的问题：它是如何使用那根损坏的电缆获得 IP 地址的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T09:58:42.807

最有可能的是，当您的笔记本电脑无法从 DHCP 服务器获取 IP 时，它为自己分配了 DHCP 提供的最后一个 IP。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T09:25:24.570

你拿的是哪个IP？当 Windows 计算机没有从 DHCP 服务器获得虚拟 IP 时，它们会获得分配的虚拟 IP，如果我没记错的话，从 169 开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T09:21:33.020

变量太多，无法保持良好的有根据的猜测。我能想到的最好的猜测是你给出的事实是这样的：

*最初插入时电缆没有损坏。*也许您能够在电缆损坏之前获得 IP 地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T06:46:29.940

如果电缆损坏，您会在系统托盘的图标中看到错误网络“未连接”。如果您的网络连接正常，则表示电缆正常。如果电缆的类型不正确，那么您可能已经建立了连接，但以太网协商为 10Mpbs/半双工，这可能会给不知情的用户带来很多痛苦，包括无连接、掉线等症状数据包，因此连接缓慢等。之后，如果您的 IP 地址以 169.184.XX 开头，则意味着 DHCP 出于某种原因失败，并且您的笔记本电脑为自己分配了一个默认配置的 IP 地址。如果您获得的 IP 地址是您通常在 LAN 环境中获得的 IP 地址（您通常用于连接到 Internet），那么可能存在一些防火墙问题，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T09:37:44.230

正如瓦尔迪兹先生已经说过的那样，确实有很多未知数可以做出很好的猜测。但要记住的一件事是，仅仅因为一个事件发生在另一个事件之后，并不一定是由该事件引起的。这也被称为“[相关并不意味着因果](http://en.wikipedia.org/wiki/Correlation_does_not_imply_causation)”。

很可能，更换电缆的时间足够长，以至于真正的问题（路由器、ISP 或路径上的其他东西）可以由其他人解决（不知道您的问题）或自行消失.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T16:56:53.537

这是不可能的，但这里有一些：

*   网卡驱动程序：我在惠普笔记本电脑和以太网卡上遇到了非常随机的事情。通常重启可以解决这个问题。绿色连接灯并不总是意味着“开始”，有时司机负责打开灯。
*   电缆中的连接丢失或计算中的网络插头丢失。
*   交换机与计算机的双工协商问题
*   也许在 4 线电缆上尝试千兆以太网？

如果是我，我会尝试以太网嗅探器（如 tcpdump 或 wireshark），如果再次发生这种情况，看看你是否得到任何东西。Ping 结果也会很好（对 IP 地址，而不是主机）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T17:01:54.710

电缆和/或连接器是片状的。DHCP 是使用非常小的 UDP 数据包完成的，如果发送了足够多的数据包，最终它们就会通过。DHCP 重试机制非常强大，因此如果您丢失了 95% 的数据包，我不会感到惊讶，而且仍然足以获得 IP。

但是，一旦您开始为 TCP/IP 事务发送更大的数据包，您会发现 95% 的丢失会丢弃足够多的数据包，即使使用持久的 TCP/IP，也很难获得任何有用的信息。

# wpf - 将项目添加到列表框时为 WPF 数据模板设置动画？

> ID：637844
> 
> 赞同：28
> 
> 时间：2009-03-12T09:20:43.693
> 
> 标签：wpf, data-binding, xaml, animation, datatemplate

在我的项目中，我有一个绑定到 ObservableCollection 的 WPF 列表框。每次我将新项目添加到集合时，相同的项目都会自动添加到列表框中。为了在列表框中显示项目，我使用了 XAML 数据模板。

我想要做的是在将项目添加到集合/列表框时为其设置一次动画。这可以做到吗？作为数据模板中的动画可能？我想我需要一个触发器来启动这个动画但是当一个新的项目/数据模板被添加时会触发什么触发器？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-12T14:40:24.920

我认为 FrameworkElement.Loaded 路由事件的事件触发器可以工作。例如：

```
<DataTemplate DataType="{x:Type l:Foo}">
    <Button x:Name="Button" Content="{Binding Path=Bar}">
        <Button.Background>
            <SolidColorBrush x:Name="ButtonBrush" Color="Tan" />
        </Button.Background>
    </Button>
    <DataTemplate.Triggers>
        <EventTrigger RoutedEvent="FrameworkElement.Loaded" SourceName="Button">
            <BeginStoryboard>
                <Storyboard>
                    <ColorAnimation Storyboard.TargetName="ButtonBrush" Storyboard.TargetProperty="Color" To="Red" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </DataTemplate.Triggers>
</DataTemplate> 
```

# javascript - SEO 问题：在 script 标签的 src 中使用 ASHX

> ID：637847
> 
> 赞同：0
> 
> 时间：2009-03-12T09:21:53.143
> 
> 标签：javascript, seo

如果我将 ashx 页面称为脚本标签的 src，它会输出所有值和内容的 document.write。这会被机器人看到还是因为它在脚本标签中而根本不会被拾取？

例如，

```
<script src="sitemenu.ashx" type="text/javascript"></script> 
```

SEO 是该项目的要求之一，所以我想问是否可以将我的站点菜单放在 .ashx 文件中。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T09:25:37.860

问题不在于 ASHX，而在于 document.write。

动态客户端构建的文档不会被主要搜索引擎索引。

# encoding - 如何最好地检测 XML 文件中的编码？

> ID：637855
> 
> 赞同：8
> 
> 时间：2009-03-12T09:26:16.753
> 
> 标签：encoding, linq-to-xml, xmlreader, xelement

要加载具有任意编码的 XML 文件，我有以下代码：

```
Encoding encoding;
using (var reader = new XmlTextReader(filepath))
{
    reader.MoveToContent();
    encoding = reader.Encoding;
}

var settings = new XmlReaderSettings { NameTable = new NameTable() };
var xmlns = new XmlNamespaceManager(settings.NameTable);
var context = new XmlParserContext(null, xmlns, "", XmlSpace.Default, 
    encoding);
using (var reader = XmlReader.Create(filepath, settings, context))
{
    return XElement.Load(reader);
} 
```

这可行，但是两次打开文件似乎效率低下。有没有更好的方法来检测编码，这样我就可以做到：

1.  打开文件
2.  检测编码
3.  将 XML 读入 XElement
4.  关闭文件

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-12T10:32:23.893

好吧，我应该早点想到这一点。XmlTextReader（它为我们提供编码）和 XmlReader.Create（它允许我们指定编码）都接受一个 Stream。那么如何首先打开一个 FileStream，然后将它与 XmlTextReader 和 XmlReader 一起使用，如下所示：

```
using (var txtreader = new FileStream(filepath, FileMode.Open))
{
    using (var xmlreader = new XmlTextReader(txtreader))
    {
        // Read in the encoding info
        xmlreader.MoveToContent();
        var encoding = xmlreader.Encoding;

        // Rewind to the beginning
        txtreader.Seek(0, SeekOrigin.Begin);

        var settings = new XmlReaderSettings { NameTable = new NameTable() };
        var xmlns = new XmlNamespaceManager(settings.NameTable);
        var context = new XmlParserContext(null, xmlns, "", XmlSpace.Default,
                 encoding);

        using (var reader = XmlReader.Create(txtreader, settings, context))
        {
            return XElement.Load(reader);
        }
    }
} 
```

这就像一个魅力。以独立于编码的方式读取 XML 文件应该更优雅，但至少我只打开了一个文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-16T01:17:50.833

另一个非常简单的选择是使用 Linq to XML。Load 方法会自动从 xml 文件中读取编码。然后，您可以使用[XDeclaration.Encoding](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdeclaration.encoding.aspx)属性获取编码器值。来自 MSDN 的示例：

```
// Create the document
XDocument encodedDoc16 = new XDocument(
new XDeclaration("1.0", "utf-16", "yes"),
new XElement("Root", "Content")
);
encodedDoc16.Save("EncodedUtf16.xml");
Console.WriteLine("Encoding is:{0}", encodedDoc16.Declaration.Encoding);
Console.WriteLine();

// Read the document
XDocument newDoc16 = XDocument.Load("EncodedUtf16.xml");
Console.WriteLine("Encoded document:");
Console.WriteLine(File.ReadAllText("EncodedUtf16.xml"));
Console.WriteLine();
Console.WriteLine("Encoding of loaded document is:{0}", newDoc16.Declaration.Encoding); 
```

虽然这可能不符合原始海报的要求，因为他必须重构大量代码，但对于必须为他们的项目编写新代码的人，或者如果他们认为重构是值得的，这很有用。

# vb6 - CDO.Message - 到许多连接

> ID：637858
> 
> 赞同：1
> 
> 时间：2009-03-12T09:27:45.267
> 
> 标签：vb6, cdo.message

我正在使用 CDO.Message 编写时事通讯应用程序。但是得到一个错误，我们有很多连接。似乎他们有 10 个同时连接的限制。

那么，有没有办法在一个连接上发送多条消息，或者更快地断开连接？有一个 cdo/configuration/smtpconnectiontimeout 参数，但我认为这更多的是关于发件人将尝试多长时间。

（如果我们发送失败，它会在几分钟后再次成功，可能意味着连接已断开）。

（我们使用 CDO 的部分原因是我们从网络服务器中提取 HTML 消息体）

**编辑**：

```
Public Sub ipSendMail(ByVal toEmail As String, ByVal fromEmail As String, ByVal subject As String, ByVal url As String)
    Dim iMsg As Object
    Set iMsg = CreateObject("CDO.Message")
    iMsg.From = fromEmail
    iMsg.To = toEmail
    iMsg.Subject = subject
    iMsg.CreateMHTMLBody(url)
    iMsg.Configuration.Fields.Item _
        ("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2
    iMsg.Configuration.Fields.Item _
        ("http://schemas.microsoft.com/cdo/configuration/smtpserver") = "relay.wwwwwwwwww.net"
    iMsg.Configuration.Fields.Item_
        ("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 25
    iMsg.Configuration.Fields.Item _ 
        ("http://schemas.microsoft.com/cdo/configuration/smtpconnectiontimeout") = 0
    iMsg.Configuration.Fields.Update()
    iMsg.Send()
    Set iMsg = Nothing
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T09:34:44.657

*   尝试使用 SMTP 而不是 CDO，System.Web.Mail.SmtpMail
*   您可以实现一个由后台线程处理的队列。后台线程一次只会发送一条消息。
*   您可以将电子邮件存储在由计划任务或存储过程处理的数据库表中。那些人可以一次再次发送一封邮件，并且如果出错了可以重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T09:32:11.793

通常，无论您发送多少条消息，您都只需要一个连接。

也许你没有发布你应该发布的东西。

**编辑**：只是一个想法，您要发送到的 SMTP 服务器，可能出于测试原因，它不会恰好是 XP 机器上的主机？

**编辑**：好的，所以你的 SMTP 服务器很好。

提供 URL 结果的服务器是什么平台？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T17:23:56.583

我知道 CDO 有时会很古怪，所以我可能会提出以下建议：

队列可能最适合您。之后，我会考虑设置一个没有入站连接限制的本地 SMTP 服务器，该服务器使用智能主机来排队您的出站消息。（这实际上可以很容易地写出来。“S”代表“简单”，实际上是。）

如果一切都失败了......您总是可以推出自己的邮件组件实现 RFC 2821 和 2822（或任何最新和最伟大的 RFC 用于 SMTP 和消息格式）

编辑：如果您发送的通讯对于所有收件人都是相同的，您可以将其发送给虚拟收件人（即 newsletter@yourdomain.com）并将其密送至收件人列表（或收件人列表的子集）。请注意不要被标记为未经请求的商业电子邮件。让您的提供者知道您在做什么。他们必须处理投诉，而您是支付账单的人。让他们知道投诉大多是没有根据的（而且很少而且相差甚远）将有助于缓解他们天生的风险厌恶情绪。

# sharepoint - 对列使用“允许多个值”时，SharePoint“分组依据”被破坏

> ID：637859
> 
> 赞同：4
> 
> 时间：2009-03-12T09:27:57.137
> 
> 标签：sharepoint

我想显示按类别分组的文档库中的文档。类别是我添加的允许多个值的查找列。不幸的是，这完全破坏了“分组依据”功能。这个问题有程序化的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T22:03:16.233

有一种方法......它既复杂又丑陋 - 但它应该工作:)

您可以为列表（HTML、JavaScript 和所有）编写自己的视图。C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\12\TEMPLATE\GLOBAL\XML 文件夹中的 VWSTYLES.xml 文件包含默认 SharePoint 视图样式的 HTML 和 JavaScript - 从中​​获得灵感，您可以创建自己的视图样式，在这里您可以做任何您想做的事情！

问题是，SharePoint 没有任何方法来部署您的自定义视图样式 - 这是丑陋的部分出现的地方 - 您有两个选项来部署您的视图样式。

1.  将您的代码直接添加到 VWSTYLE.xml/编辑它的副本并使用功能覆盖它

    优点：

    > 您仍然可以从 SharePoint 界面编辑视图

    缺点：

    > 您覆盖默认 SharePoint 文件 - 您的工作可以被 SharePoint 更新覆盖。
    > 
    > 您的视图样式将在 SharePoint 中的每个列表上可用。

2.  以编程方式在列表中创建视图

    优点：

    > 您不会覆盖任何默认的 SharePoint 文件。
    > 
    > 您可以控制哪个列表使用您的视图

    缺点：

    > 您将无法通过 SharePoint 界面编辑视图

我自己用过几次方法 2 - 它有效......但它并不漂亮！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T11:59:12.890

我认为您尝试做的事情是不可能的。对项目/文档进行分组时，您可以根据分组值将它们显示在不同的组中。我认为 SharePoint 不支持将单个项目添加到多个组。由于分组字段中有多个值，因此无法知道要将项目/文档添加到哪个组。我不确定这是错误还是设计使然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T14:07:06.843

也请查看此链接。Access 无需编写太多难看的代码即可支持此功能。 [http://office.microsoft.com/en-us/access/HA012337221033.aspx](http://office.microsoft.com/en-us/access/HA012337221033.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T18:07:56.800

Thomas 是正确的，这是设计使然，因为该项目必须在不同的组中多次出现。值得注意的是，这可以通过 Web 服务实现。

了解[为什么我从共享点列表 Web 服务中获取重复的行](http://www.novolocus.com/2008/06/10/why-i-was-getting-duplicate-rows-from-the-sharepoint-lists-web-service/)

不，我不知道为什么列表 web 服务会这样做，但 API 不会。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-24T18:50:57.443

所以这是一种对我有用的技巧，但不能保证。虽然您的列（在我的情况下为 Office）允许启用多个值，但请根据需要填写所有数据。完成后，转到列表设置，单击“办公室”列，然后关闭允许多个值。SharePoint 将弹出有关此数据可能如何丢失的警告（我从未发生过）。点击确定，然后修改要分组的视图，“Office”现在应该显示在要分组的列的下拉列表中。完成的结果将导致您的组（和或子组）显示得很好。

我唯一的疑虑是，它没有在 AB 组中显示一个项目，因为它在 X 列中同时检查了字段 A 和字段 B，它只是创建了一个新组，列 X：A；B. 所以就我而言，我在博福特和奥兰治堡办事处都有员工，而不是在两个组中都有这些员工（最好），而是创建了一个新组，如下所示：

[![团体](https://i.stack.imgur.com/iJ7Da.png)](https://i.stack.imgur.com/iJ7Da.png)

# tags - 中央标签存储库？

> ID：637861
> 
> 赞同：1
> 
> 时间：2009-03-12T09:28:46.013
> 
> 标签：tags, tagging

Thunderbird 标记我的电子邮件，Flicker 标记我的图像。

我使用相同的标签，并且必须为我使用的每个 web 应用程序重复它们，我懒得做这个。

有什么补救措施吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T09:31:04.370

我认为这组标签是上下文相关的。如果标签的一点是通过让您浏览更高级别的标签分类来使搜索更容易，那么被迫查看成百上千个全错的标签会使搜索变得更加困难。然后我们需要开始标记标签，所以将它们分开。不过我并不太多云，所以也许我错过了一些东西。

# c# - 在不安装 SMTP 服务器的情况下发送邮件

> ID：637866
> 
> 赞同：16
> 
> 时间：2009-03-12T09:31:01.607
> 
> 标签：c#, .net, email, smtp

我有一个 .Net 应用程序。我希望此应用程序向我发送电子邮件。如何在不安装 SMTP 服务器的情况下实现这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-12T09:33:40.900

使用 an[`SmtpClient`](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx)发送 a[`MailMessage`](http://msdn.microsoft.com/en-us/library/system.net.mail.mailmessage_members.aspx)不需要您在本地计算机上拥有服务器。

您的电子邮件服务提供商是与服务器（例如 smtp.gmail.com）以及您`SmtpClient`与之对话的那个。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-12T09:33:40.417

这篇 Peter Bromberg 在 eggheadcafe.com 上的文章

[没有 SMTP 服务或 CDO 的 C# SMTP 邮件](http://www.eggheadcafe.com/articles/20030316.asp)

解释如何在不依赖 SMTP 客户端的情况下发送电子邮件：

> 使用本地 SMTP RFC 命令“HELO”、“MAIL From”、RCPT TO“等通过 TCP 发送电子邮件没什么大不了的。这是我们使用 Telnet 学习的第一个技巧。查找或编写可以这样做的托管代码可靠是另一回事。下面的类中的代码不是我的原始代码——我从三个不同的示例源拼凑而成，修复了命名空间、错误处理和其他次要项目，将控制台代码更改为类库代码，以及提供完整的基于 Winforms 的测试工具前端，说明其正确用法。
> 
> 我还包含示例代码，以通过 OpenFileDialog 正确处理和添加邮件附件。此代码 MIME 根据规范对附件进行编码和传输。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-12T09:33:36.063

如果没有 SMTP 服务器的服务，您将无法发送电子邮件，您当然不需要安装，只需将您的代码指向您的 ISP SMTP 服务器或您公司的 Exchange 服务器（或他们使用的任何东西）。

# linux - 如何将信号从一个程序发送到另一个程序？

> ID：637870
> 
> 赞同：7
> 
> 时间：2009-03-12T09:32:13.947
> 
> 标签：linux, signals

我使用消息队列作为 2 个程序之间的 ipc。现在我想使用消息队列将数据从一个程序发送到另一个程序，然后通过信号 SIGINT 对其进行提示。

我不知道如何将信号从一个程序发送到另一个程序。如果他们有解决方案，任何人都可以提供示例代码。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-12T09:38:48.860

```
#include <sys/types.h>
#include <signal.h>
int kill(pid_t pid, int sig); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T09:37:42.090

linux 中的信号可以使用 kill system call 发送，只需查看此[链接](http://www.csl.mtu.edu/cs4411/www/NOTES/signal/kill.html)以获取 kill system call 和示例的文档。你也可以看到 man -2 kill。并且不建议使用 SIGINT 使用 SIGUSR1 或 SIGUSR2

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T06:59:34.417

请注意，通过使用 sigqueue() 系统调用，您可以将额外的数据与信号一起传递。这是来自“man 2 sigqueue”的简短引用：

> value 参数用于指定要与信号一起发送的伴随数据项（整数或指针值），并具有以下类型：

```
 union sigval {
         int   sival_int;
         void *sival_ptr;
     }; 
```

这是在两个进程之间传递少量信息的一种非常方便的方法。我同意上面的用户——使用 SIGUSR1 或 SIGUSR2 和一个好的 sigval，你可以传递任何你想要的。

您还可以通过 sival_ptr 传递指向共享内存中某个对象的指针，并以这种方式传递更大的对象。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-03-12T11:26:29.053

```
system("kill -2 `pidof <app_name_here>` "); 
```

# macos - 在 MacOS 中仅删除一个用户的 ACL 条目？异常困难

> ID：637871
> 
> 赞同：3
> 
> 时间：2009-03-12T09:32:16.363
> 
> 标签：macos, bash, operating-system, acl, bsd

我正在尝试以**递归**方式从我的一个驱动器上的所有文件夹中删除为 johndoe 设置的 ACL，**而无需冲洗任何其他条目**！任何人都知道如何在*不*影响其他组/用户已经存在的 ACL 的情况下执行此操作？

我正在寻找相当于“setfacl -du:johndoe”的 Mac

我知道您可以使用 chmod 从多个文件中删除规则，但我看到的唯一方法不起作用，因为它通过其索引删除规则（例如：每个文件夹的第 5 个条目）并且我的用户的条目赢了' 并不总是相同的索引。

你为什么想做这个？假设您继承了一个疯狂的文件系统，该文件系统具有一堆个人用户而不是组，并且您只想摆脱个人，因为他们已经拥有访问权限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T12:28:25.923

How about the chmod "-a" option?

```
find . -exec chmod -a "johndoe allow delete,readattr,writeattr,readextattr,writeextattr,readsecurity,writesecurity,chown,read,write,append,execute,list,search,add_file,add_subdirectory,delete_child" {} \; 
```

It will remove all ACL permissions for johndoe on all files recursively from the current directory. (It will print errors for all files without an ACL, but it will still work on the rest of 'em). As you mentioned, you'll have to run this with "inherited" and "deny" as well.

EDIT: Here are tools that use ACLs on Mac OS X:

```
# cat has_acl.sh 
otool -IV $1 2>&1 | grep _acl_ > /dev/null
# find /bin /sbin /usr/bin /usr/sbin -exec ./has_acl.sh {} \; -print
/bin/chmod
/bin/ls
/usr/bin/ex
/usr/bin/rview
/usr/bin/rvim
/usr/bin/vi
/usr/bin/view
/usr/bin/vim
/usr/bin/vimdiff
/usr/sbin/cupsd
/usr/sbin/kadmind
/usr/sbin/pkgutil 
```

vi only reads & preserves the ACLs, the others don't seem useful, either. But there could be 3rd party tool. Maybe in Fink/MacPorts?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T09:42:49.723

我将 grep 的输出`ls -le`作为用户名，然后使用您找到的索引号删除规则`awk`。只要你不叫你的用户读、写、拒绝、允许、删除等等；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T14:36:33.917

`find / -print0 -type fd | xargs -0 ls -le | more`

可能会帮助您开始探索文件系统。

您可以替换`more`为另一个命令，例如for ACL 输出，以及处理with`grep`结果的后续管道。`grep``fsaclctl`

# entity-framework - 如何处理实体框架中的“辅助”键

> ID：637877
> 
> 赞同：6
> 
> 时间：2009-03-12T09:34:34.313
> 
> 标签：entity-framework, mapping, foreign-keys

我正在针对现有模式使用 EF 进行评估 - 问题是我无法弄清楚如何在外键不是主表的主键的表之间建立关联。

例如， a`foo`可能有很多`bars`像这样定义的（请原谅伪代码）：

```
table foo {
  int foo\_id pk,
  char(10) foo\_code,
  ...
}

table foobar {
  int bar\_id pk,
  char(10) bar\_foo\_code fk(foo.foo\_code),
  ...
} 
```

我缺少什么能够创建`foo_foobar`关联，从而在实体上创建`Bars`导航属性？`Foo`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T13:32:04.353

Linq to entity 不支持不指向表主键的外键（请参阅日志消息 3）。Linq to entity 会将其视为表上的普通字段。您将无法导航到它链接到的实体。

如果您有现有的架构，我建议您使用[edm 生成器](http://blogs.msdn.com/adonet/archive/2008/06/20/edm-tools-options-part-1-of-4.aspx)，因为这将创建 EMDX 文件、隐藏代码甚至视图代码（可能非常大）。如果您现有的方案非常大，请查看这篇[文章](http://blogs.msdn.com/adonet/archive/2008/11/24/working-with-large-models-in-entity-framework-part-1.aspx)，其中解释了如何处理大型模式。

当您运行 EDM 生成器时，您会发现所有不支持的内容。

查看以前的 EDMGen2.exe 日志，我们得到以下类型的消息：

1.  不
    支持数据类型“sql_variant”，排除了表“TableName”中的“ColumnName”列。
2.  表/视图“tableName”没有定义主键。已推断出密钥，并将定义创建为只读表/视图
3.  关系“RelationshipName”的列不属于该关系的主要侧的表的键，不支持，该关系已被排除。

我们还发现 Linq 项目实际上使 Visual Studio 崩溃了很多，因为 EDM 生成的代码文件远远超过 80 mb。

# gwt - GWT 从日期字段中获取值

> ID：637886
> 
> 赞同：1
> 
> 时间：2009-03-12T09:38:46.427
> 
> 标签：gwt, gwt-ext

我正在使用 GWT ext 并尝试从页面获取值并将其设置在 pojo 类中。

除日期字段外，所有值均使用

(TimeField) ComponentMgr.getComponent(id[2])).getText())....

但是，在对日期字段使用相同的代码段时，它无法执行。

任何人都可以帮我解决这个问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T13:03:27.213

这对我来说很好：

dateField.getText();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T12:57:50.040

如果要将字符串转换为日期字段，则必须对其进行解析。请记住，GWT 1.6 中已经有开箱即用的日期选择器。如果您使用的版本没有日期选择器，有几个[类似](http://code.google.com/p/gwt-datepicker/) [的](http://code.google.com/p/google-web-toolkit-incubator/)项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-25T07:44:36.050

我也多次使用日期字段。日期字段字段 = 新日期字段（）；字段.getValue();

这将作为 Date 实例返回值。因此，如果您的 pojo 具有 date 属性，那么您需要对其进行解析。对于字符串值，您应该使用 getText() 方法。

# vb.net - 在 LINQ 中添加相关记录

> ID：637889
> 
> 赞同：0
> 
> 时间：2009-03-12T09:39:38.623
> 
> 标签：vb.net, linq, linq-to-sql

使用 LINQ 处理 XML 文件以通过数据上下文将记录添加到 SQL Server 数据库中的表中。当我们添加记录时，我们需要在其他各种表中分配父级。大多数时候我们可以找到现有的父级并使用它，但有时我们需要创建一个新的父级。

认为我们可以这样做：

```
暗淡 defaultPub 作为出版物
defaultPub = 带有 {.name = e..Value} 的新出版物
Dim pub = _Data.publications.Where(Function(s) s.name = e..Value).DefaultIfEmpty(defaultPub).SingleOrDefault
.publication = 酒馆

```

因此，我们试图从我们的 XML 中找到与 e..Value 匹配的发布，但如果找不到，则使用“defaultPub”。如果它确实存在，但我们不想再次添加它。因此，即使这种方法确实有效，也可能无论如何都有缺陷……

无论如何，它当前不起作用，我们收到此错误：查询运算符“DefaultIfEmpty”使用不支持的重载。

重载需要一个出版物并且正在获得一个（我已经在 quickwatch 中检查了 TypeNames），不知道这里发生了什么。

我们真正要寻找的是类似于 Ruby 的 activerecord 中的 find_or_create 之类的东西，LINQ 似乎是从中复制而来的。

提前致谢，

戴夫。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-03-12T09:50:15.073

好的，我可以这样做：

```
Dim pub = _Data.publications.Where(Function(s) s.name = e.<source>.Value).SingleOrDefault
Dim newPub As publication
If Not IsNothing(pub) AndAlso pub.name <> "" Then
   .publication = pub
Else
   newPub = New publication With {.name = e.<source>.Value}
   .publication = newPub
End If 
```

谢谢瓦尔！

# c++ - “字符串.h”VS

> ID：637892
> 
> 赞同：1
> 
> 时间：2009-03-12T09:40:55.890
> 
> 标签：c++

朋友们

在 HP-UX 框中，当我将字符串对象传递给函数时，我收到以下错误

**错误 422：“../header/Handler.h”，第 24 行 # 'string' 用作类型，但尚未定义为类型。也许你的意思是字符串类中的“字符串”**

```
["/opt/aCC/include/SC/String.h", line 66].

        int populateBindingHandle(rpc_if_handle_t p_if_spec, string p_cell_name); 
```

为什么不使用 String.h 会出错

如何声明 String newstr;

不同于

字符串新闻；??

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T09:43:54.603

看起来`String`编译器提到的标头中有一个类。编译器认为你打错了。

如果要使用 STL 字符串，请使用以下命令：

```
#include <string>

int populateBindingHandle(rpc_if_handle_t p_if_spec, std::string ...) 
```

或在`using`某处声明：

```
using std::string;

int populateBindingHandle(rpc_if_handle_t p_if_spec, std::string ...) 
```

请注意，旧式标头已被弃用，即您不应再使用`#include <string.h>`

# sql - 仅限制标记为默认的一条记录

> ID：637894
> 
> 赞同：47
> 
> 时间：2009-03-12T09:41:37.573
> 
> 标签：sql, sql-server

如何在表上设置约束，以便只有一条记录的`isDefault`位字段设置为 1？

约束不是表范围，而是每组行的一个默认值，由 FormID 指定。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-04-03T00:17:01.793

## 使用唯一的过滤索引

在 SQL Server 2008 或更高版本上，您可以简单地使用**唯一过滤索引**

```
CREATE UNIQUE INDEX IX_TableName_FormID_isDefault
    ON TableName(FormID)
    WHERE isDefault = 1 
```

桌子在哪里

```
CREATE TABLE TableName(
    FormID INT NOT NULL,
    isDefault BIT NOT NULL
) 
```

例如，如果您尝试插入许多相同的行并将其`FormID`设置`isDefault`为 1，您将遇到此错误：

> 无法在具有唯一索引“IX_TableName_FormID_isDefault”的对象“dbo.TableName”中插入重复的键行。重复键值为 (1)。

资料来源：[http ://technet.microsoft.com/en-us/library/cc280372.aspx](http://technet.microsoft.com/en-us/library/cc280372.aspx)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-12T22:18:57.617

这是 Damien_The_Unbeliever 解决方案的修改，它允许每个 FormID 有一个默认值。

```
CREATE VIEW form_defaults
AS
SELECT FormID
FROM whatever
WHERE isDefault = 1
GO
CREATE UNIQUE CLUSTERED INDEX ix_form_defaults on form_defaults (FormID)
GO 
```

但是严肃的关系人会告诉你，这些信息应该只是在另一个表中。

```
CREATE TABLE form
FormID int NOT NULL PRIMARY KEY
DefaultWhateverID int FOREIGN KEY REFERENCES Whatever(ID) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-12T09:53:36.297

从规范化的角度来看，这将是一种存储单个事实的低效方式。

我会选择通过将外键存储（在不同的表中）到被认为是默认行的标识符的外键来将这些信息保存在更高的级别。

```
CREATE TABLE [dbo].[Foo](
    [Id] [int] NOT NULL,
 CONSTRAINT [PK_Foo] PRIMARY KEY CLUSTERED 
(
    [Id] ASC
) ON [PRIMARY]
) ON [PRIMARY]

GO

CREATE TABLE [dbo].[DefaultSettings](
    [DefaultFoo] [int] NULL
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[DefaultSettings]  WITH CHECK ADD  CONSTRAINT [FK_DefaultSettings_Foo] FOREIGN KEY([DefaultFoo])
REFERENCES [dbo].[Foo] ([Id])
GO

ALTER TABLE [dbo].[DefaultSettings] CHECK CONSTRAINT [FK_DefaultSettings_Foo]
GO 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-12T09:54:31.037

您可以使用[插入/更新触发器](http://msdn.microsoft.com/en-us/library/ms189799.aspx)。

在插入或更新后的触发器内，如果 isDefault = 1 的行数大于 1，则回滚事务。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-12T11:34:05.977

我不知道 SQLServer。但是如果它支持像 Oracle 中的基于函数的索引，我希望可以翻译，如果没有，对不起。

您可以在假设默认值为 时执行这样的索引`1234`，列是`DEFAULT_COLUMN`并且`ID_COLUMN`是主键：

```
CREATE 
UNIQUE 
 INDEX only_one_default 
    ON my_table
     ( DECODE(DEFAULT_COLUMN, 1234, -1, ID_COLUMN) ) 
```

`-1`如果 is 的值`DEFAULT_COLUMN`和`1234`在`ID_COLUMN`任何其他情况下，此 DDL 将创建唯一索引索引。然后，如果两列都有`DEFAULT_COLUMN`值，则会引发异常。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-12T15:22:28.273

```
CREATE VIEW vOnlyOneDefault
AS
  SELECT 1 as Lock
  FROM <underlying table>
  WHERE Default = 1
GO
CREATE UNIQUE CLUSTERED INDEX IX_vOnlyOneDefault on vOnlyOneDefault (Lock)
GO 
```

您需要为此打开正确的 ANSI 设置。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-07-30T00:46:35.520

这个问题对我来说意味着您有一个包含一些子记录的主表，其中一个子记录将是默认记录。此处使用地址和单独的默认表是如何使用第三范式实现此目的的示例。当然，我不知道回答这么古老的东西是否有价值，但这让我很喜欢。

```
--drop table dev.defaultAddress;
--drop table dev.addresses;
--drop table dev.people;

CREATE TABLE [dev].[people](
    [Id] [int] identity primary key,
    name char(20)
)
GO

CREATE TABLE [dev].[Addresses](
    id int identity primary key,
    peopleId int foreign key references dev.people(id),
    address varchar(100)
) ON [PRIMARY]

GO
CREATE TABLE [dev].[defaultAddress](
    id int identity primary key,
    peopleId int foreign key references dev.people(id),
    addressesId int foreign key references dev.addresses(id))
go
create unique index defaultAddress on dev.defaultAddress (peopleId)
go
create unique index idx_addr_id_person on dev.addresses(peopleid,id);
go
ALTER TABLE dev.defaultAddress
   ADD CONSTRAINT FK_Def_People_Address
   FOREIGN KEY(peopleID, addressesID)
   REFERENCES dev.Addresses(peopleId, id)
go
insert into dev.people (name) 
    select 'Bill' union 
    select 'John' union 
    select 'Harry'
insert into dev.Addresses (peopleid, address) 
    select 1, '123 someplace' union 
    select 1,'work place' union
    select 2,'home address' union
    select 3,'some address'
insert into dev.defaultaddress (peopleId, addressesid)
    select 1,1 union
    select 2,3 
-- so two home addresses are default now
-- try adding another default address to Bill and you get an error
select * from dev.people 
    join dev.addresses on people.id = addresses.peopleid
    left join dev.defaultAddress on defaultAddress.peopleid = people.id and defaultaddress.addressesid = addresses.id 
insert into dev.defaultaddress (peopleId, addressesId)
    select 1,2 

GO 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T09:54:20.413

您可以通过而不是触发器来执行此操作，或者如果您希望将其作为约束创建一个约束，该约束引用一个检查默认设置为 1 的行的函数

**编辑哎呀，需要 <=**

```
Create table mytable(id1 int, defaultX bit not null default(0))
go

create Function dbo.fx_DefaultExists()
returns int as 
Begin
    Declare @Ret int
    Set @ret = 0
    Select @ret = count(1) from mytable 
    Where defaultX = 1

    Return @ret
End
GO
Alter table mytable add
CONSTRAINT  [CHK_DEFAULT_SET] CHECK 
 (([dbo].fx_DefaultExists()<=(1)))
GO
Insert into mytable (id1, defaultX) values (1,1)

Insert into mytable (id1, defaultX) values (2,1) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-12T14:44:12.353

这是一个相当复杂的过程，无法通过简单的约束来处理。

我们通过触发器来做到这一点。但是，在编写触发器之前，您需要能够回答几件事：

如果存在默认值，我们是否希望插入失败，将其更改为 0 而不是 1，或者将现有默认值更改为 0 并将其保留为 1？如果默认记录被删除而其他非默认记录仍然存在，我们该怎么办？我们是否将一个设为默认值，如果是，我们如何确定哪一个？

您还需要非常非常小心地使触发器处理多行处理。例如，客户端可能决定特定类型的所有记录都应该是默认记录。您不会一次更改一百万条记录，因此此触发器需要能够处理该问题。它还需要在不使用循环或使用游标的情况下处理该问题（您真的不希望上面讨论的事务类型花费数小时一直锁定表）。

在此触发器上线之前，您还需要一个非常广泛的测试场景。您需要测试：添加一条无默认记录，这是该客户的第一条记录 添加一条默认记录，这是该客户的第一条记录 添加一条无默认记录，它不是该客户的第一条记录该客户添加具有默认值的记录，并且它不是该客户的第一条记录更新记录以在没有其他记录时具有默认值（假设您没有）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-12T16:19:50.833

@Andy Jones 在上面给出了最接近我的答案，但考虑到[三法则](http://sourcemaking.com/refactoring/when-should-you-refactor)，我将逻辑直接放在更新此表的存储过程中。这是我的简单解决方案。如果我需要从其他地方更新表，我会将逻辑移动到触发器。一个默认规则适用于由 FormID 和 ConfigID 指定的每组记录：

```
ALTER proc [dbo].[cpForm_UpdateLinkedReport]
    @reportLinkId int,
    @defaultYN bit,
    @linkName nvarchar(150)
as
if @defaultYN = 1
begin
    declare @formId int, @configId int
    select @formId = FormID, @configId = ConfigID from csReportLink where ReportLinkID = @reportLinkId
    update csReportLink set DefaultYN = 0 where isnull(ConfigID,  @configId) = @configId and FormID = @formId
end
update
    csReportLink
 set
    DefaultYN = @defaultYN,
    LinkName = @linkName
where
    ReportLinkID = @reportLinkId 
```

# mfc - 如何有条件地编译VC6资源

> ID：637900
> 
> 赞同：1
> 
> 时间：2009-03-12T09:43:34.353
> 
> 标签：mfc, resources, visual-c++-6, conditional-compilation

根据以环境变量的形式设置的编译开关（值为`COMPILE_A`或`COMPILE_B`），我想用不同的设置编译我的应用程序，例如应用程序名称和启动画面。

我做到了这一点：

1.  在“项目/设置/C/C++/预处理器定义”中，我添加了`$(COMPILESWITCH)`（命令行选项中的结果`/D "$(COMPILESWITCH)"`）。

2.  在 stdafx.h 我可以使用以下代码，这意味着我通过命令行参数正确定义了预处理器定义：

```
 #if defined COMPILE_A
    #   define IDB_SPLASH IDB_SPLASH_A
    # elif defined COMPILE_B
    #   define IDB_SPLASH IDB_SPLASH_B
    # else
    #   error Unknown or undefined target compile switch; cannot compile!
    # endif 
```

但我注意到“ResourceView / [右键单击] / Properties”下的“Condition”属性......帮助文本说：

> 健康）状况
> 
> 确定资源的包含。例如，如果条件是 _DEBUG，则此资源将仅包含在调试版本中。

这看起来很优雅，对吧？

指定`_DEBUG`为条件有效。因此，`_DEBUG`通过`/D _DEBUG`我的指定`$(COMPILESWITCH)`也应该工作，对吧？
出于某种原因，它没有；为什么？

或者还有另一种更好的方法来实现我想要的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T10:00:38.200

我想我刚刚解决了我的问题......

资源编译器使用自己的预处理器。
因此，必须在“项目/设置/资源/预处理器定义”下添加相同的预处理器定义。

### 编辑：字符串资源

以上不适用于字符串资源，因为它们没有“条件”属性......

我选择使用`res\<projectname>.rc2`资源编辑器不会触及的自定义资源文件。内容看起来像这样

```
#如果定义（COMPILE_A）
    可丢弃的字符串
    开始
        IDR_MAINFRAME "应用标题 A"
    结尾
＃别的
# 如果定义（COMPILE_B）
    可丢弃的字符串
    开始
        IDR_MAINFRAME "应用标题 B"
    结尾
＃ 别的
# 错误编译开关未定义或未知；无法编译！
＃ 万一
＃万一

```

# java - 尝试在使用 Formatter 创建的 String 上使用 String.split() 正则表达式

> ID：637907
> 
> 赞同：2
> 
> 时间：2009-03-12T09:44:38.267
> 
> 标签：java, regex, string, split, space

大家好，我是这里的新人，

我正在使用来自开源库（Java 的 Matrix Toolkits）的以下代码，它输出以下矩阵

```
 1000       1000                   5
     3          5  1.000000000000e+00 
```

我正在尝试进行字符串拆分，这将返回 1000,1000,5

我尝试使用 `String[] parts = str.trim().split("\\s");`

但似乎使用 \s 作为字符串标记是错误的，知道我应该改用什么吗？

多谢！

```
public String toString() {
        // Output into coordinate format. Indices start from 1 instead of 0
        Formatter out = new Formatter();

        out.format("%10d %10d %19d\n", numRows, numColumns, Matrices
                .cardinality(this));

        for (MatrixEntry e : this)
            if (e.get() != 0)
                out.format("%10d %10d % .12e\n", e.row() + 1, e.column() + 1, e
                        .get());

        return out.toString();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T09:48:38.727

您应该拆分任意数量的空格，而不仅仅是单个空格。也就是说，将“+”添加到您的正则表达式中，如下所示：

```
String[] parts = str.trim().split("\\s+"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T09:53:12.990

[StringTokenizer](http://java.sun.com/j2se/1.5.0/docs/api/java/util/StringTokenizer.html)也应该能够做你想做的事。

```
String s = "  1000       1000                   5";
java.util.StringTokenizer st = new java.util.StringTokenizer(s);
while (st.hasMoreTokens()) {
    System.out.println(st.nextToken());
} 
```

# asp.net - FCKEditor 没有在回发时设置 Value 属性！

> ID：637908
> 
> 赞同：1
> 
> 时间：2009-03-12T09:44:46.223
> 
> 标签：asp.net, postback, fckeditor

我在我的 asp.net 网页上使用[FCKEditor 。](http://www.fckeditor.net)它看起来很漂亮，编辑器在前端看起来非常好。唯一的问题是，回发时没有设置 .Value 属性。无论用户对页面上控件的值进行什么更改，当我单击“提交”时，.Value 属性都保持空白。

我在 Google 上搜索过其他解决方案，其中大多数都是与 Ajax 存在冲突的各种解决方案，例如[this](http://www.daveparslow.com/2007/10/fckeditor-inside-updatepanel-broken.html)和[this](http://blogs.uct.ac.za/blog/lovemores-world/2008/10/27/post-fckeditor-form-with-ajax-solved)。这些解决方案没有解决我的问题；它比这更根本。我与 Ajax 没有任何关系。我只是一个简单的 asp.net 新手，有一个简单的 web 表单，并且 value 属性没有在回发时设置，不在 IE 中，也不在 FF 中。

似乎至少[有其他人](http://www.fckeditor.net/forums/viewtopic.php?f=5&t=12995&start=0)遇到了这个问题，但还没有解决方案。

有任何想法吗？谢谢！

* * *

新信息：我在“hello world”测试网站上进行了测试——测试网站 100% 运行。我的页面上显然存在问题，但我不知道从哪里开始跟踪这个问题。

这是我页面的标记，以防有人能看到我的新手眼睛看不到的明显内容：

```
<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="EmailTemplateEditForm.aspx.vb"
  Inherits="EEI_App.EmailTemplateEditForm" %>

<%@ Register Assembly="FredCK.FCKeditorV2" Namespace="FredCK.FCKeditorV2" TagPrefix="FCKeditorV2" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
  <title>EEI - Email Template</title>
  <link rel="stylesheet" href="EEI.css">

  <script language="javascript" id="jssembleWare" src="sembleWare.js"></script>

  <style type="text/css">
    .style1
    {
      height: 251px;
    }
    .style2
    {
      width: 2%;
      height: 251px;
    }
    .style3
    {
      height: 490px;
    }
  </style>
</head>
<body>
  <form id="form1" runat="server">
  <%@ register src="header.ascx" tagname="header" tagprefix="uc1" %>
  <%@ register src="footer.ascx" tagname="footer" tagprefix="uc1" %>
  <uc1:header ID="header1" runat="server" />
  <!-- main content area -->
  <div class="content">
    <!-- title of the page -->
    <div class="boxheader">
      Email Template
    </div>
    <div class="standardbox">
      <!-- Start Page Main Contents-->
      <!-- error messages -->
      <div class="errorbox">
        <asp:Label ID="lblError" CssClass="ErrorControlStyle" runat="server" EnableViewState="False"
          Width="100%"></asp:Label>
      </div>
      <table class="contenttable">
        <tr>
          <td align="left" valign="top" class="style3">
            <div class="actionbox">
              <div class="navheadertitle">
                Navigation</div>
              <ul>
                <li>
                  <asp:LinkButton ID="btnSubmit" CssClass="LinkButtonStyle" runat="server">Submit</asp:LinkButton>
                </li>
                <li>
                  <asp:LinkButton ID="btnCancel" CssClass="LinkButtonStyle" runat="server" CausesValidation="false">Cancel</asp:LinkButton>
                </li>
              </ul>
            </div>
          </td>
          <td align="left" valign="top" class="style3">
            <p>
            </p>
            <table>
              <tr class="MCRSFieldRow">
                <td class="MCRSFieldLabelCell">
                  <asp:Label ID="lblEmailTemplate_TemplateName" CssClass="LabelStyle" runat="server"
                    Width="175">Template Name</asp:Label>
                </td>
                <td class="MCRSFieldEditCell">
                  <asp:TextBox ID="txtEmailTemplate_TemplateName" CssClass="TextBoxStyle" runat="server"
                    Width="100%"></asp:TextBox>
                </td>
                <td class="MCRSFieldLabelCell">
                  <asp:Label ID="lblEmailTemplate_TemplateType" CssClass="LabelStyle" runat="server"
                    Width="175">Template Type</asp:Label>
                </td>
                <td class="MCRSFieldEditCell">
                  <asp:RadioButtonList ID="rblEmailTemplate_TemplateType" CssClass="RadioButtonListStyle"
                    runat="server" RepeatColumns="1" RepeatDirection="Horizontal" Width="135px">
                    <asp:ListItem Value="1">Cover Letter</asp:ListItem>
                    <asp:ListItem Value="2">Email</asp:ListItem>
                  </asp:RadioButtonList>
                </td>
                <td class="MCRSRowRightCell">
                  &nbsp;
                </td>
              </tr>
              <tr class="MCRSFieldRow">
                <td class="MCRSFieldLabelCell">
                  Composition Date
                </td>
                <td class="MCRSFieldEditCell">
                  <asp:Label ID="lblEmailTemplate_CompositionDate" CssClass="ElementLabelStyle" runat="server"
                    Width="175"></asp:Label>
                </td>
                <td class="MCRSFieldLabelCell">
                  Last Used Date
                </td>
                <td class="MCRSFieldEditCell">
                  <asp:Label ID="lblEmailTemplate_LastUsedDate" CssClass="ElementLabelStyle" runat="server"
                    Width="175"></asp:Label>
                </td>
                <td class="MCRSRowRightCell">
                  &nbsp;
                </td>
              </tr>
              <tr class="MCRSFieldRow">
                <td class="MCRSFieldLabelCell">
                  Composed By
                </td>
                <td class="MCRSFieldEditCell" colspan="3">
                  <asp:Label ID="lblPerson_FirstNames" CssClass="ElementLabelStyle" runat="server"></asp:Label>
                  <asp:Label ID="lblPerson_LastName" CssClass="ElementLabelStyle" runat="server"></asp:Label>
                </td>
                <td class="MCRSRowRightCell">
                  &nbsp;
                </td>
              </tr>
              <tr class="MCRSFieldRow">
                <td class="MCRSFieldLabelCell">
                  <asp:Label ID="lblEmailTemplate_Subject" CssClass="LabelStyle" runat="server" Width="175">Subject</asp:Label>
                </td>
                <td class="MCRSFieldEditCell" colspan="3">
                  <asp:TextBox ID="txtEmailTemplate_Subject" CssClass="TextBoxStyle" runat="server"
                    Width="100%"></asp:TextBox>
                </td>
                <td class="MCRSRowRightCell">
                  &nbsp;
                </td>
              </tr>
              <tr class="MCRSFieldRow">
                <td class="style1">
                  <asp:Label ID="lblEmailTemplate_Body" CssClass="LabelStyle" runat="server" Width="175">Body</asp:Label>
                </td>
                <td class="style1" colspan="3">
                  <FCKeditorV2:FCKeditor ID="FCKeditor1" runat="server" Height="500px">
                  </FCKeditorV2:FCKeditor>
                </td>
                <td class="style2">
                  &nbsp;
                </td>
              </tr>
            </table>
          </td>
        </tr>
      </table>
    </div>
    <p>
      <a class="InputButtonStyle" href="#_swTopOfPage">Top of Page</a>
    </p>
  </div>
  <uc1:footer ID="footer1" runat="server" />
  <p>
    <asp:TextBox ID="txtEmailTemplate_Body" CssClass="TextAreaStyle" Rows="4" runat="server"
      Width="100%" Height="16px" Visible="False"></asp:TextBox>
  </p>
  </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-12-22T22:01:16.850

在 ASP.Net 中从 FCKeditor (FCKeditor.Value) 获取值的问题 1\. 如果初始值 FCKeditor.Value 没有设置，则没有问题，所有放置到 FCKeditor 的值都可以通过 FCKeditor.Value 获取。2.问题：如果初始值FCKeditor.Value不为null，那么如果我想获取值，它只给我初始值。

我已经解决了！！！！我花了一整天......几乎没有找到答案。特地注册写回信！看！例子：

// 为 FCKeditor 设置初始值

```
void Page_Init(object sender, EventArgs e)
{
DataTable dT_01 = new DataTable();
      dT_01 = DataLayerMainContent.ArticlesSelect(2);
      FCKeditor_Edit.Value = dT_01.Rows[0]["ArticleText"].ToString();
} 
```

注意力！！！你不能在这里做这个！

```
protected void Page_Load(object sender, EventArgs e)
{
    // Not here!!!
} 
```

// 并从 FCKeditor 中获取值

```
protected void Btn_ContentEditedSave_Click(object sender, EventArgs e)
{
    //FCKeditor_Edit.Value
    // And add this value to DataBase
    DataLayerAdminPost.ContentMainEdit(1, FCKeditor_Edit.Value);
    Response.Redirect(Request.RawUrl);
} 
```

大意！在 Page_Init 处为 FCKeditor 设置初始值！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T10:09:29.410

你启用了 ViewState 吗？**ANS = 是**

**编辑：好的，然后在 Page_Init 事件中尝试添加以下内容：**

```
Page.RegisterRequiresPostBack(FCKeditor1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-16T19:22:39.470

上面的解决方案对我不起作用，但是我在[这里找到了解决方案](http://jlcoady.net/aspnet/fckeditor-work-inside-updatepanel)

这是我使用的代码

```
protected void Page_Load(object sender, EventArgs e)
{
    ScriptManager.RegisterOnSubmitStatement(
        this, 
        this.GetType(), 
        "AjaxHack", "for ( var i = 0; i < parent.frames.length; ++i ) if ( parent.frames[i].FCK ) parent.frames[i].FCK.UpdateLinkedField();");
} 
```

希望能拯救某人的一天。我一直在寻找解决方案 2 个月。

干杯

# vb6 - 获取privateprofilestring 错误

> ID：637910
> 
> 赞同：1
> 
> 时间：2009-03-12T09:44:57.470
> 
> 标签：vb6, ini

我加密了一些文本并将其放入 INI 文件中。然后我使用 getprivateprofilestring() 来检索该值，但缺少一些结束字符。我怀疑它可能是一个换行符导致它不完整。写入 INI 文件就可以了。打开 INI 文件并查看部分和键 - 一切都井井有条。它只是导致错误的检索部分。

请任何帮助将不胜感激。

谢谢埃迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T06:19:54.613

首先在加密字符串时，确保在将它们转储到 INI 文件之前将它们转换为 Base64。

最有可能的是，加密字符串创建了一个 ascii 字符，INI 相关 API 无法很好地处理该字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T08:54:52.977

`WritePrivateProfileStringW`默认情况下在活动的 ANSI 代码页中写入文件；`WritePrivateProfileStringA`总是写ANSI。

为达到最佳效果，请按照[此处](http://www.siao2.com/2006/09/15/754992.aspx)的说明并`GetPrivateProfileStringW`在回读数据时使用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T10:01:28.233

加密很可能会将 NULL 字符注入您正在编写的流中。GetPrivateProfileString 将读取一个字符串，直到找到一个 NULL 字符。

所以我同意 Angry Hacker，转换为 Base64 或其他一些友好的人类可读编码，你不会有任何问题。

# java-me - 使用 J2ME 应用程序从文本文件中搜索 *.* 的逻辑

> ID：637912
> 
> 赞同：1
> 
> 时间：2009-03-12T09:45:04.757
> 
> 标签：java-me, midp

我在 J2ME 中有一个文本字段。

我想使用该*textField 值*从文本文件中进行搜索，那么它的逻辑是什么？

假设我在 textField 中输入 abc

然后逻辑应该通过从文本文件字段中比较它来返回*abc*。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T12:37:09.273

J2ME 不包含标准的正则表达式 API。

所以，要么自己写，要么使用现有的库。

如果您实际上不需要通配符等特殊字符，java.lang.String.indexOf(String) 是您的朋友。

如果您的文件太大并且您需要一次读取一个缓冲区，请注意缓冲区的结尾不是搜索字符串的开头。String.startsWith() 会让你处理这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T12:42:29.463

也许您可以使用[Jakarta Regex](http://jakarta.apache.org/regexp/index.html)或其他[第三方](http://www.brics.dk/~amoeller/automaton/)之类的东西？

# java - 调度程序使用线程池和优先级队列？

> ID：637913
> 
> 赞同：4
> 
> 时间：2009-03-12T09:45:18.470
> 
> 标签：java, threadpool, priority-queue

我将使用 Java 中的线程池和优先级队列实现一个调度程序，我想问是否有人知道任何现有的实现，所以我没有花时间在它上面:-)...

基本上，java.util.concurrent 包中的 ScheduledThreadPoolExecutor 提供了我需要的几乎所有功能，除了“优先队列”。当我粗略检查了内置的 java 库时，我找不到任何支持在将元素放入队列后从外部修改和更新元素的“优先级”值的优先级队列。

我需要在喜欢下载者的项目中使用这种优先级队列。我想允许用户即时修改每个下载的优先级，并且它在队列中的位置会自动更新。PriorityQueue 不是以这种方式实现的，为了获得正确的优先级，每次我们更改其优先级值时，我们都必须将其删除并再次提交...

以前有人做过这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T10:17:32.400

您可以检查[PriorityQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/PriorityQueue.html)或[PriorityBlockingQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/PriorityBlockingQueue.html)。我认为它们中的任何一个都不允许您修改优先级。但是您始终可以删除一个元素并以修改后的优先级将其添加回来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T14:46:58.620

您可以使用[Quartz](http://www.opensymphony.com/quartz/)，它是一个功能齐全的调度程序并支持[优先级](http://www.opensymphony.com/quartz/wikidocs/TutorialLesson4.html)

# sharepoint - 将状态指示器添加到自定义 Web 部件

> ID：637915
> 
> 赞同：2
> 
> 时间：2009-03-12T09:48:07.027
> 
> 标签：sharepoint, sharepoint-2007, web-parts

我有一个自定义 Web 部件，它正在生成一些用户数据。我已经添加了适当的代码来输出标准状态图标和菜单，但是这很奇怪。

我的 web 部件的渲染 html 如下：

```
<span>  
   <a href="http://mysite/Person.aspx?accountname=USERID">USERNAME</a>&nbsp;   
   <img border="0" height="12" width="12" src="/_layouts/images/blank.gif" onload="IMNRC('USEREMAIL')" id="imnUSERID" ShowOfflinePawn="1" />  
</span> 
```

显然替换了 USERID、USERNAME、USEREMAIL 等。

问题是双重的。

1) 在 IE7 中，不会检索到存在信息。菜单显示正确，但图标未出现，当您将鼠标悬停在间隙上时，下拉菜单不提供 IM 设置。

2) 在 IE8 RC1 中，状态信息正确返回并显示图标，但下拉列表在图标上方几英寸处呈现。（[见这个截图](http://twitpic.com/1z4r9)）

任何有关这些问题的帮助或有关向自定义 Web 部件添加状态的其他提示都将受到欢迎。

### 进度更新

*- 将网页添加到 IE7 的“受信任的站点” - 什么也没做 - IE8 的兼容性视图没有任何区别。- 更改为 id="CSRP_id,type=sip" 根据建议将代码更改为以下内容：*

```
<span>     
<img class="PresenceImage" src="/_layouts/images/imnhdr.gif" onload="IMNRC('USEREMAIL')" name="imnmark" ShowOfflinePawn="1" id="contact_im,type=sip" />     
</span> 
```

*以上更新均未成功。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-12T23:40:48.027

首先，您将不得不消除您是否有样式问题或 javascript 问题。

如果您的所有存在气泡都正确显示，则获取[IE 开发人员工具栏](http://www.microsoft.com/en-us/download/details.aspx?id=18359)并尝试追溯 css。甚至改变网站的主题，看看你是否得到不同的结果。

这是我们的 html，效果很好

```
 <span>
 <img width="12" src="/_layouts/images/blank.gif" onload="IMNRC('[USERMAIL]')" id="IMID[GUID]" ShowOfflinePawn=1 alt="Presence bubble">[USERNAME]</span> 
```

笔记：

[USERMAIL] = 明显 [USERNAME] = 明显 [GUID] = 随机 guid

**还要注意没有结尾“/>”（只是“>”）**的格式错误的img标签。**我们使用它，因为这是 SharePoint 生成的 html（请不要让我开始使用*它*）。**

 **# c++ - MacOS 上的视频捕获

> ID：637917
> 
> 赞同：1
> 
> 时间：2009-03-12T09:48:48.460
> 
> 标签：c++, c, macos, opencv

我在 MacOs 10.4 下的 openCV 库有问题。当我尝试执行此行以保存从网络摄像头捕获的某些帧时

```
CvVideoWriter *writer = cvCreateVideoWriter(
                             "out.avi", 
                             CV_FOURCC('M','J','P','G'), 
                             fps, 
                             imgSize); 
```

我可以在 stdrr 上看到这个：

> OpenCV 错误：函数 icvCreateVideoWriter 中的内部错误（无法从文件名创建数据引用），cvcap_qt.cpp(1291) 正在终止应用程序...

任何想法？如果我尝试保存一些图像，它工作正常。

谢谢大家！安德烈亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T10:11:37.737

您的程序在您运行的目录中是否具有写入权限？

您是否尝试过将绝对地址放入您的主文件夹？

如果更改文件名或 FourCC 代码会发生什么？

# netbeans - Netbeans 中的 BPEL 开关案例

> ID：637920
> 
> 赞同：0
> 
> 时间：2009-03-12T09:50:24.137
> 
> 标签：netbeans, soa, bpel

我正在使用 netbeans 开发一些 BPEL，但不知道如何添加 switch-case 块，它不在任何地方的调色板中。我正在使用netbeans 6.5。有任何想法吗？

Switch 绝对是一个有效的元素：[http](http://charltonb.typepad.com/weblog/2003/08/bpel4ws_switch_.html) ://charltonb.typepad.com/weblog/2003/08/bpel4ws_switch_.html 我正在运行的课程材料中也提到了它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T12:41:29.273

您是否尝试过将开关插入 xml 源本身？不确定 Netbeans 是否会支持它，但它是在 BPEL 标记标准中定义的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-12T10:39:38.293

我不确定是否存在开关元素。

您可能别无选择，只能使用[几个`else-if`.](http://www.netbeans.org/kb/55/bpel_gsg_palette.html#usingifelement)

# css - 背景颜色的不透明度，但不是文本

> ID：637921
> 
> 赞同：391
> 
> 时间：2009-03-12T09:51:09.377
> 
> 标签：css, opacity

如何使跨浏览器（包括Internet Explorer 6）的背景透明一段`div`时间，文本仍然不透明？

我需要在不使用任何库（如 jQuery 等）的情况下做到这一点（但如果你知道一个库可以做到这一点，我很想知道，所以我可以查看他们的代码）。

* * *

## 回答 #1

> 赞同：604
> 
> 时间：2011-01-17T20:34:05.530

使用 rgba！

```
.alpha60 {
    /* Fallback for web browsers that don't support RGBa */
    background-color: rgb(0, 0, 0);
    /* RGBa with 0.6 opacity */
    background-color: rgba(0, 0, 0, 0.6);
    /* For IE 5.5 - 7*/
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);
    /* For IE 8*/
    -ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";
} 
```

> 除此之外，您必须`background: transparent`为 IE 网络浏览器声明，最好通过条件注释或类似方式提供服务！

通过[http://robertnyman.com/2010/01/11/css-background-transparency-without-affecting-child-elements-through-rgba-and-filters/](http://robertnyman.com/2010/01/11/css-background-transparency-without-affecting-child-elements-through-rgba-and-filters/)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-12T09:53:05.550

我为此使用了一个透明的 PNG：

```
div.semi-transparent {
  background: url('semi-transparent.png');
} 
```

不过，对于 IE6，您需要使用 PNG 修复程序（[1](http://unitinteractive.com/labs/unitpngfix.php)、[2](http://www.twinhelix.com/css/iepngfix/)）。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-03-12T10:42:11.763

我在我的博客[Landman Code](http://landman-code.blogspot.com/)上创建了这种效果。

我所做的是

```
#Header {
  position: relative;
}
#Header H1 {
  font-size: 3em;
  color: #00FF00;
  margin:0;
  padding:0;
}
#Header H2 {
  font-size: 1.5em;
  color: #FFFF00;
  margin:0;
  padding:0;
}
#Header .Background {
  background: #557700;
  filter: alpha(opacity=30);
  filter: progid: DXImageTransform.Microsoft.Alpha(opacity=30);
  -moz-opacity: 0.30;
  opacity: 0.3;
  zoom: 1;
}
#Header .Background * {
  visibility: hidden; // hide the faded text
}
#Header .Foreground {
  position: absolute; // position on top of the background div
  left: 0;
  top: 0;
}
```

```
<div id="Header">
  <div class="Background">
    <h1>Title</h1>
    <h2>Subtitle</h2>
  </div>
  <div class="Foreground">
    <h1>Title</h1>
    <h2>Subtitle</h2>
  </div>
</div>
```

重要的是，每个填充/边距和内容在 .Background 和 .Foreground 中都必须相同。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-08-21T13:12:01.160

放宽在 IE6 和旧版浏览器上工作的要求，您可以使用 ::before 和 display: inline-block

```
div
{
  display: inline-block;
  position: relative;    
}
div::before
{
  content: "";
  display: block;
  position: absolute;
  z-index: -1;
  width: 100%;
  height: 100%;
  background:red;
  opacity: .2;
} 
```

演示在[http://jsfiddle.net/KVyFH/172/](http://jsfiddle.net/KVyFH/172/) ​</p>

它适用于任何现代浏览器

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-04T20:47:42.510

感谢 @davy-landmann 提供[https://stackoverflow.com/a/638064/417153](https://stackoverflow.com/a/638064/417153)。这就是我要找的！与 LESS 代码相同的效果：

```
 @searchResultMinHeight = 200px;
  .searchResult {
    min-height: @searchResultMinHeight;

    position: relative;
    .innerTrans {
      background: white;
      .opacity(0.5);
      min-height: @searchResultMinHeight;
    }
    .innerBody {
      padding: 0.5em;
      position: absolute;
      top: 0;
    }
  } 
```

# command-line - TFS 命令行帮助

> ID：637929
> 
> 赞同：1
> 
> 时间：2009-03-12T09:54:20.210
> 
> 标签：command-line, tfs, tf-cli

我正在尝试从 TFS 中获取一些信息。具体来说，对于给定的用户，我想获得所有变更集的列表及其日期和所有更改的项目（内联差异的奖励积分）。此列表将用于对所有修改的文件运行差异。

类似于以下内容：

```
tf history /user:USERNAME
// pump changeset number into
tf changeset 'changeset number'
// now get the items, and pump into
tf diff 'item' /version:C122~C123 
```

我相信我可以为此使用 TFS 报告，但我没有报告服务器的访问权限:(

我可以使用一些正则表达式在 C# 中运行它，但我宁愿避免这种情况。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T11:45:26.497

for /f "tokens=1" %f in ('tf history /user:username ./recursive /noprompt') for /f "tokens=2" %g in ('tf changeset %f') do tf diff /无提示/版本：C%f %g

您可能希望将其分解以从 tf 历史记录和 & tf changeset 中删除垃圾

如：| findstr /R [0-9]。仅从 tf 历史记录中获取变更集编号

# c# - 如何将 TimeSpan 序列化为 XML

> ID：637933
> 
> 赞同：212
> 
> 时间：2009-03-12T09:55:13.423
> 
> 标签：c#, serialization, timespan

我正在尝试将 .NET`TimeSpan`对象序列化为 XML，但它不起作用。一个快速的谷歌建议虽然`TimeSpan`是可序列化的，`XmlCustomFormatter`但不提供将`TimeSpan`对象转换为 XML 和从 XML 转换的方法。

一种建议的方法是忽略`TimeSpan`for 序列化，而是序列化`TimeSpan.Ticks`（并`new TimeSpan(ticks)`用于反序列化）的结果。这方面的一个例子如下：

```
[Serializable]
public class MyClass
{
    // Local Variable
    private TimeSpan m_TimeSinceLastEvent;

    // Public Property - XmlIgnore as it doesn't serialize anyway
    [XmlIgnore]
    public TimeSpan TimeSinceLastEvent
    {
        get { return m_TimeSinceLastEvent; }
        set { m_TimeSinceLastEvent = value; }
    }

    // Pretend property for serialization
    [XmlElement("TimeSinceLastEvent")]
    public long TimeSinceLastEventTicks
    {
        get { return m_TimeSinceLastEvent.Ticks; }
        set { m_TimeSinceLastEvent = new TimeSpan(value); }
    }
} 
```

虽然这在我的简短测试中似乎有效 - 这是实现这一目标的最佳方法吗？

有没有更好的方法将 TimeSpan 序列化到 XML 和从 XML 序列化？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2011-07-18T14:34:46.323

这只是对问题中建议的方法的轻微修改，但[此 Microsoft Connect 问题](http://connect.microsoft.com/VisualStudio/feedback/details/386602/system-timespan-xml-serialization "微软连接")建议使用这样的序列化属性：

```
[XmlIgnore]
public TimeSpan TimeSinceLastEvent
{
    get { return m_TimeSinceLastEvent; }
    set { m_TimeSinceLastEvent = value; }
}

// XmlSerializer does not support TimeSpan, so use this property for 
// serialization instead.
[Browsable(false)]
[XmlElement(DataType="duration", ElementName="TimeSinceLastEvent")]
public string TimeSinceLastEventString
{
    get 
    { 
        return XmlConvert.ToString(TimeSinceLastEvent); 
    }
    set 
    { 
        TimeSinceLastEvent = string.IsNullOrEmpty(value) ?
            TimeSpan.Zero : XmlConvert.ToTimeSpan(value); 
    }
} 
```

这会将 0:02:45 的 TimeSpan 序列化为：

```
<TimeSinceLastEvent>PT2M45S</TimeSinceLastEvent> 
```

或者，`DataContractSerializer`支持 TimeSpan。

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2009-03-12T10:08:54.357

您已经发布的方式可能是最干净的。如果你不喜欢额外的属性，你可以实现`IXmlSerializable`，但是你必须做**所有事情**，这在很大程度上违背了这一点。我很乐意使用您发布的方法；它是（例如）高效的（没有复杂的解析等），独立于文化的，明确的，并且时间戳类型的数字易于理解。

顺便说一句，我经常补充：

```
[Browsable(false), EditorBrowsable(EditorBrowsableState.Never)] 
```

这只是将它隐藏在 UI 和引用 dll 中，以避免混淆。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2011-09-06T19:01:17.383

在某些情况下可行的方法是为您的公共属性提供一个支持字段，即 TimeSpan，但公共属性作为字符串公开。

例如：

```
protected TimeSpan myTimeout;
public string MyTimeout 
{ 
    get { return myTimeout.ToString(); } 
    set { myTimeout = TimeSpan.Parse(value); }
} 
```

如果属性值主要在包含类或继承类中使用并且从 xml 配置中加载，则这是可以的。

如果您希望公共属性成为其他类的可用 TimeSpan 值，则其他建议的解决方案会更好。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2012-12-03T06:38:25.580

结合[颜色序列化](https://stackoverflow.com/a/8638106/376066)的答案和[这个原始解决方案](https://stackoverflow.com/questions/7483233/net-how-to-serialize-a-timespan-to-xml-not-the-same-question)（这本身就很棒）我得到了这个解决方案：

```
[XmlElement(Type = typeof(XmlTimeSpan))]
public TimeSpan TimeSinceLastEvent { get; set; } 
```

`XmlTimeSpan`类是这样的：

```
public class XmlTimeSpan
{
    private const long TICKS_PER_MS = TimeSpan.TicksPerMillisecond;

    private TimeSpan m_value = TimeSpan.Zero;

    public XmlTimeSpan() { }
    public XmlTimeSpan(TimeSpan source) { m_value = source; }

    public static implicit operator TimeSpan?(XmlTimeSpan o)
    {
        return o == null ? default(TimeSpan?) : o.m_value;
    }

    public static implicit operator XmlTimeSpan(TimeSpan? o)
    {
        return o == null ? null : new XmlTimeSpan(o.Value);
    }

    public static implicit operator TimeSpan(XmlTimeSpan o)
    {
        return o == null ? default(TimeSpan) : o.m_value;
    }

    public static implicit operator XmlTimeSpan(TimeSpan o)
    {
        return o == default(TimeSpan) ? null : new XmlTimeSpan(o);
    }

    [XmlText]
    public long Default
    {
        get { return m_value.Ticks / TICKS_PER_MS; }
        set { m_value = new TimeSpan(value * TICKS_PER_MS); }
    }
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2010-12-08T21:05:38.037

您可以围绕 TimeSpan 结构创建一个轻量级包装器：

```
namespace My.XmlSerialization
{
    public struct TimeSpan : IXmlSerializable
    {
        private System.TimeSpan _value;

        public static implicit operator TimeSpan(System.TimeSpan value)
        {
            return new TimeSpan { _value = value };
        }

        public static implicit operator System.TimeSpan(TimeSpan value)
        {
            return value._value;
        }

        public XmlSchema GetSchema()
        {
            return null;
        }

        public void ReadXml(XmlReader reader)
        {
            _value = System.TimeSpan.Parse(reader.ReadContentAsString());
        }

        public void WriteXml(XmlWriter writer)
        {
            writer.WriteValue(_value.ToString());
        }
    }
} 
```

示例序列化结果：

```
<Entry>
  <StartTime>2010-12-06T08:45:12.5</StartTime>
  <Duration>2.08:29:35.2500000</Duration>
</Entry> 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-12T10:07:34.657

一个更具可读性的选项是将序列化为字符串并使用该`TimeSpan.Parse`方法对其进行反序列化。您可以执行与示例相同的操作，但`TimeSpan.ToString()`在 getter 和`TimeSpan.Parse(value)`setter 中使用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-10T19:53:44.350

另一种选择是使用`SoapFormatter`类而不是`XmlSerializer`类来序列化它。

生成的 XML 文件看起来有点不同......一些“SOAP”前缀标签等......但它可以做到。

以下是`SoapFormatter`将 20 小时 28 分钟的时间跨度序列化为：

```
<myTimeSpan>P0Y0M0DT20H28M0S</myTimeSpan> 
```

要使用 SOAPFormatter 类，需要添加引用`System.Runtime.Serialization.Formatters.Soap`并使用同名的命名空间。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-02-14T10:18:13.543

我的解决方案版本:)

```
[DataMember, XmlIgnore]
public TimeSpan MyTimeoutValue { get; set; }
[DataMember]
public string MyTimeout
{
    get { return MyTimeoutValue.ToString(); }
    set { MyTimeoutValue = TimeSpan.Parse(value); }
} 
```

编辑：假设它可以为空......

```
[DataMember, XmlIgnore]
public TimeSpan? MyTimeoutValue { get; set; }
[DataMember]
public string MyTimeout
{
    get 
    {
        if (MyTimeoutValue != null)
            return MyTimeoutValue.ToString();
        return null;
    }
    set 
    {
        TimeSpan outValue;
        if (TimeSpan.TryParse(value, out outValue))
            MyTimeoutValue = outValue;
        else
            MyTimeoutValue = null;
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-05-25T06:27:28.200

时间跨度以秒数存储在 xml 中，但我希望它很容易采用。Timespan 手动序列化（实现 IXmlSerializable）：

```
public class Settings : IXmlSerializable
{
    [XmlElement("IntervalInSeconds")]
    public TimeSpan Interval;

    public XmlSchema GetSchema()
    {
        return null;
    }

    public void WriteXml(XmlWriter writer)
    {
        writer.WriteElementString("IntervalInSeconds", ((int)Interval.TotalSeconds).ToString());
    }

    public void ReadXml(XmlReader reader)
    {
        string element = null;
        while (reader.Read())
        {
            if (reader.NodeType == XmlNodeType.Element)
                element = reader.Name;
            else if (reader.NodeType == XmlNodeType.Text)
            {
                if (element == "IntervalInSeconds")
                    Interval = TimeSpan.FromSeconds(double.Parse(reader.Value.Replace(',', '.'), CultureInfo.InvariantCulture));
            }
       }
    }
} 
```

还有更全面的例子： [https ://bitbucket.org/njkazakov/timespan-serialization](https://bitbucket.org/njkazakov/timespan-serialization)

查看 Settings.cs。并且有一些使用 XmlElementAttribute 的棘手代码。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-09-21T18:01:09.580

如果您不想要任何解决方法，请使用 System.Runtime.Serialization.dll 中的 DataContractSerializer 类。

```
 using (var fs = new FileStream("file.xml", FileMode.Create))
        {
            var serializer = new DataContractSerializer(typeof(List<SomeType>));
            serializer.WriteObject(fs, _items);
        } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-03T01:10:43.890

对于数据合同序列化，我使用以下内容。

*   保持序列化的属性私有可以保持公共接口的干净。
*   使用公共属性名称进行序列化可以保持 XML 干净。

```
Public Property Duration As TimeSpan

<DataMember(Name:="Duration")>
Private Property DurationString As String
    Get
        Return Duration.ToString
    End Get
    Set(value As String)
        Duration = TimeSpan.Parse(value)
    End Set
End Property 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2012-03-09T04:17:45.183

试试这个 ：

```
//Don't Serialize Time Span object.
        [XmlIgnore]
        public TimeSpan m_timeSpan;
//Instead serialize (long)Ticks and instantiate Timespan at time of deserialization.
        public long m_TimeSpanTicks
        {
            get { return m_timeSpan.Ticks; }
            set { m_timeSpan = new TimeSpan(value); }
        } 
```

# database - mysql/sqlite/postgresql 是否有任何 SQL 设计器（用于 linux 或基于 web 的）？

> ID：637935
> 
> 赞同：1
> 
> 时间：2009-03-12T09:56:12.407
> 
> 标签：database, user-interface, database-design

我不知道*SQL 设计*器一词是否正确，我正在寻找一种图形工具，您可以在其中执行以下操作：

[BOH http://img14.imageshack.us/img14/732/designerqsw.jpg](http://img14.imageshack.us/img14/732/designerqsw.jpg)

然后它可以生成用于创建表的 SQL 代码。有什么提示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T09:59:45.720

[DBDesigner 4](http://fabforce.net/dbdesigner4/index.php)怎么样。它在 Linux 和 Windows 下运行，并在 GPL 下获得许可。

[![替代文字](https://i.stack.imgur.com/RjZUn.jpg)](http://fabforce.net/dbdesigner4/screenshot_image.php?screenshot=dbd4_ss_simplemodel.png)
[（来源：[fabforce.net](http://fabforce.net/dbdesigner4/images/screenshots.jpg)）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T16:28:36.123

我认为 DBDesigner 不会像糟糕的“SQL Designer”那样在相关行之间精确地绘制链接！

我也在找这种工具，但是没有蹲SQL Designer的bug。

# sharepoint - SharePoint 2007 - 获取中央管理员 URL ID (guid)

> ID：637944
> 
> 赞同：2
> 
> 时间：2009-03-12T10:00:09.573
> 
> 标签：sharepoint, sharepoint-2007

我希望在 SharePoint 中获取中央管理页面的 GUID，但不确定如何获取它，任何帮助将不胜感激。

我需要能够使用 API / 对象模型动态地获取它

谢谢

菲尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-12T11:52:19.227

尝试

```
Microsoft.SharePoint.Administration.SPAdministrationWebApplication

SPAdministrationWebApplication adminWebApp = (SPAdministrationWebApplication)SPWebApplication.Lookup(myUri);

SPAdministrationWebApplication.Local 
```

[http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.administration.spadministrationwebapplication.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.administration.spadministrationwebapplication.aspx)

# firefox - 如何在 Firefox 扩展中获取基本身份验证信息？

> ID：637945
> 
> 赞同：2
> 
> 时间：2009-03-12T10:00:31.273
> 
> 标签：firefox, firefox-addon, basic-authentication

我正在编写 Firefox 扩展程序，并希望获取网站（或当前文档）的基本身份验证信息。

如何在 Firefox 扩展中获取基本身份验证信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-03-29T08:03:12.243

下面是一些使用[nsIHttpAuthManager](http://www.oxymoronical.com/experiments/apidocs/interface/nsIHttpAuthManager)的示例代码：

实例化组件：

```
var proxyAuthenticationComponent = Components.classes["@mozilla.org/network/http-auth-manager;1"].getService(Components.interfaces.nsIHttpAuthManager); 
```

设置信息：

```
proxyAuthenticationComponent.setAuthIdentity('http','192.168.0.1',80,"basic","Some Realm","","","username","password"); 
```

获取信息：

```
var domain = {}; //Will contain {value: ""}
var username = {}; //Will contain {value: "username"}
var password = {}; //Will contain {value: "password"}
proxyAuthenticationComponent.getAuthIdentity('http','192.168.0.1',80,"basic","Some Realm","",domain,username,password); 
```

我在 Thunderbird 扩展中使用了它。希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-13T15:12:42.437

我找不到确切的答案，现在也没有时间进行试验，但似乎唯一的方法是使用[NsIHttpChannel](https://developer.mozilla.org/en/NsIHttpChannel)手动检查标头。

编辑：好的，我找到[了 nsIHttpAuthManager](http://www.xulplanet.com/references/xpcomref/ifaces/nsIHttpAuthManager.html)：

> 此服务提供对在当前浏览器会话期间访问的站点的缓存 HTTP 身份验证用户凭据（域、用户名、密码）的访问。

看起来正是您需要的。

# c# - 如何使用单声道将 .NET Windows 服务应用程序迁移到 Linux？

> ID：637948
> 
> 赞同：30
> 
> 时间：2009-03-12T10:01:04.967
> 
> 标签：c#, .net, linux, .net-2.0, mono

使用 mono 将 .NET Windows 服务迁移到 Linux 的最佳方法是什么？我一直在尝试避免将应用程序作为预定命令执行。

是否可以获得类似行为的服务/系统守护程序（在 linux 中）？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-12T10:23:05.273

在 Linux 下，[守护](http://en.wikipedia.org/wiki/Daemon_(computer_software))进程是简单的后台进程。没有像在 Windows 中那样使用特殊的控制方法（例如`start()`, ）。`stop()`将您的服务构建为一个简单的（控制台）应用程序，并在后台运行它。使用类似[`daemonize`](http://www.clapper.org/software/daemonize/daemonize.1.html)将程序作为 Unix 守护进程运行的工具，并记住指定`mono`为要激活的程序。

正如其他人所指出的，[mono-service](http://linux.die.net/man/1/mono-service)是运行使用`ServiceProcess`程序集构建的服务的主机。为 Windows 构建的服务可以使用这种方法在 Linux 下不加修改地运行。您可以通过向进程发送信号来控制服务（参见手册页）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T10:13:44.877

你可以使用单服务来包装它吗？

看到[这个问题](https://stackoverflow.com/questions/351971/using-mono-service-to-wrap-a-windows-service-on-linux)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T10:21:58.460

我过去的做法是将 .Net 应用程序编译为控制台应用程序，然后在 Linux 服务器上的 initscripts 目录中创建启动脚本。

Linux 显然没有 Windows 服务，并且在启动时从 rc.d 目录启动的守护进程是它的等价物。大多数 rc.d 脚本所做的只是在后台线程上启动不同的应用程序，因此没有什么真正复杂的。唯一的额外工作是您需要编写一个 Linux shell 脚本来启动和停止服务。

# tree - 树抽象数据类型

> ID：637951
> 
> 赞同：0
> 
> 时间：2009-03-12T10:02:59.660
> 
> 标签：tree, binary-tree, abstract-data-type

我正在做一个名为数据结构和算法的单元。我们刚刚开始，我的教授刚刚教给我们什么是代数语义以及什么是公理等基础知识。到目前为止，我只是以数组的形式使用树。不使用预排序树的签名作为树（值，树，树），其中值是节点中的值，左节点是第一棵树，右节点是第二棵树。

现在我将我的树定义为树（值，树，树）或 Nil，我不知道如何去定义 addNode（值，树）的代数。

每个级别都变得越来越复杂，另外，我无论如何都想不到一次扫描一个级别，现在已经尝试了一个小时。当我们沿着树向下走时，代数只是分支成越来越多的 if-else。我做对了吗？你能为我指出正确的方向吗？或者树不能实现为树（值，树，树）？

这是我教程的一部分（在附加问题中不值得任何标记），但我不是在寻找即时答案，我喜欢这个主题，并想了解更多。

编辑1：我查看了维基百科，我不想使用教科书来获得明确的答案，我只是在寻找正确方向的提示，无论我的方法是正确的还是完全不可能将树定义为树（值，树，树）。我知道您可以以列表的形式表示树 ADT。但我真的想好好想想。希望这是有道理的。非常感谢你们！

编辑2：嗯，很难通过互联网解释。假设我正在定义一个名为“树”的新数据结构。我可以以任何我想要的方式定义它，它必须表现得像一个平衡的二叉树（虽然，父母和孩子的值无关紧要）所以我将它定义为树：树（值，树，树）或无它不是编程代码，这就是我的定义。Tree 是一个值 + 2 棵其他树，或者 Tree 是 nil。现在 addNode(value, tree) 向树添加一个节点，同时仍然保持平衡。它不是编程代码，它只是代数语义。不知道能不能解释清楚。但是我找到了一个可以使用队列或堆栈实现的解决方案，但这是我必须定义的另一个 ADT，它是无效的。

编辑3：似乎我已经假设了许多使问题变得比实际应该更难的事情。首先，从我给出的一点解释来看，Gamecat 的回答是完美的。但我同意这些评论，包括其他 ADT 是完全有效的。事实上，当我们构建任何使用 Int 的东西时，我们正在为该结构使用 ADT。我认为每个 ADT 都必须是独一无二的。无论如何，非常感谢您的回答！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T12:13:40.593

如果要将节点添加到树中，可以使用递归函数。

我假设这棵树是有序的。所以你应该得到这样的东西：

```
AddNode(value, tree)

if tree is empty, create a new tree with value as node and no subtrees.
if value lesser than the treenode, call AddNode on the left branch.
else call AddNode on the right branch. (if duplicates are allowed). 
```

如果子树发生更改，请务必更新它们！

您可以通过以下方式将其转换为非递归函数：

```
if tree is empty, return a new tree with value as node and no subtrees.
if value is lesser than treenode, and there is no left subtree, create a new left subtree with value as node and no subtrees.
if value is lesser that treenode, and there is a left subtree, try again with the left subtree.
if value is greater or equal than treenode, and there is no right subtree, create a new right subtree with value as node and no subtrees.
if value is greater or equal than treenode, and there is a right subtree, try again with the right subtree. 
```

如果树需要平衡。您需要存储一个平衡重量（可以是-1、0 或1）。如果您需要在“重”站点上添加节点，则需要重新洗牌。例如，如果左侧比右侧多一个节点，您需要在左侧多添加一个节点。您需要从左子树中获取具有最高值的节点并将其提升到当前顶部。前一个顶部被添加到右子树。一定要保持子树的平衡。

示例：添加节点 0,1,2,3,4

```
Add(0)           0

Add(1)           0
                  \
                   1

Add(2)           0 (2)  =>      1 (2) =>  1
                  \            /         / \
                   1          0         0   2

Add(3)           1
                / \
               0   2
                    \ 
                     3

Add(4)           1 (4)     => 2 (4)  =>      2
                / \          / \            / \
               0   2        1   3          1   3
                    \      /              /     \
                     3    0              0       4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T10:05:59.747

这是一个很难的问题，因为它太模糊了。我假设你有一本教科书或类似的东西作为你的课程材料的一部分。即便如此，感觉好像您遇到的许多问题都可以通过基本资源来解释，例如二叉树上[的维基百科条目。](http://en.wikipedia.org/wiki/Binary_Tree)

本页描述了如何进行各种树遍历，以及如何表示树。

# c++ - g++ 在 Windows 命令提示符下不起作用。安装 Cygwin

> ID：637953
> 
> 赞同：6
> 
> 时间：2009-03-12T10:03:09.707
> 
> 标签：c++, command-line, cygwin, g++, eclipse-cdt

我已经安装了 Eclipse 和 CDT（需要在 Eclipse CDT 中使用 C/C++），以及安装 Cygwin 以便我可以编译我的文件。

在环境变量中，我将路径设置为包括以下内容：“C:\cygwin\bin;”

g++、make 和 GDC 都是通过 Cygwin 安装的。我通过在 bin 文件夹中搜索它们来确保这一点——它们都在那里。

如果我在 Windows 命令提示符中输入“make”，则会出现：

```
make: *** No targets specified and no makefile found.  Stop. 
```

如果我在 Windows 命令提示符中输入“g++”或“gdc”，则会出现（或类似）：

```
'g++' is not recognized as an internal or external command,
operable program or batch file. 
```

所以，换句话说，make 正在工作，但其余的都没有……但它们在同一个 bin 文件夹中！让我完全糊涂了。

如果我尝试打开 Cygwin Bash Shell、g++、make 和 GDC 都可以在那里工作。

但是，我需要它在命令提示符下工作，以便 Eclipse 能够编译我在 IDE 中编写的程序。

如果您知道为什么会这样，请告诉我。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-12T10:06:24.300

我没有太多使用 cygwin，但我的理解是你*必须*从 cygwin bash shell 中使用它。

如果您需要 g++、make 等，请使用[mingw](http://www.mingw.org/)，g++ 在普通的 Windows 命令行中工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-12-15T17:09:46.550

这是发生在我身上的事情以及我是如何解决的。我的 C:\cygwin\bin\g++.exe 是指向 C:\etc\alternatives\g++.exe 的快捷方式，它又指向 C:\cygwin\bin\g++-3.exe。用 g++-3 替换 g++ 对我有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-29T08:07:27.700

在 C:\cygwin\bin 中查看 g++.exe 是否存在。如果没有，则安装未正确完成，您可能需要重新安装。这就是我的问题，它已经解决了:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-20T09:25:09.697

将 cygwin 路径添加到 Path 变量对我有用（Windows 8.1 64 位）：

转到系统属性并选择高级系统属性

转到环境变量并选择系统变量中的路径，单击编辑

添加 Cygwin 路径...对于 32 位：

```
C:\Cygwin\bin;C:\Cygwin\usr\bin 
```

对于 64 位：

```
C:\Cygwin64\bin;C:\Cygwin64\usr\bin 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-12T10:11:06.240

在**CMD**窗口中，尝试键入**bash**以在该窗口中启动 bash shell。如果这不起作用，则 cygwin bin 目录不在您的路径上。

如果确实有效，请输入**g++**并**输入 make**以查看用于这些命令的路径。我很确定您的问题出在您的 PATH 变量上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-12T10:08:04.593

您可以安装一个[Windows 版本，](http://gnuwin32.sourceforge.net/packages/which.htm)以获得一些帮助来确定正在运行的可执行文件。

也许它正在从完全不同的地方获取“make”，并且您对 %PATH% 的添加不起作用。

还可以通过在与您看到问题相同的命令提示符窗口中键入来验证它`echo %path%`，以确保。

# java - 无法突出显示 JTree 中的文件

> ID：637954
> 
> 赞同：1
> 
> 时间：2009-03-12T10:03:11.920
> 
> 标签：java, jtree

我创建了一个 JTree，我想在其中突出显示一个文件，如果包含该文件的目录不可见，我需要展开它。

例如：我创建了一个根节点为 D:/Company/abb/src 的 JTree。我要强调的文件是 - D:/Company/abb/src/bin/help.txt

请给我一些逻辑来突出显示文件 help.txt。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T03:57:50.363

我有一个代表文件系统的 JTree。这是我的代码，用于选择特定目录（如果需要，树会展开并滚动视图）。

```
JTree fsTree;

void setSelectedPath(String pth) {
    TreePath                        jtp=buildTreePath(new File(pth));

    fsTree.setSelectionPath(jtp);
    if(fsTree.getSelectionPath()==null) { fsTree.setSelectionRow(0);       }
    else                                { fsTree.scrollPathToVisible(jtp); }
    }

public TreePath buildTreePath(File dir) {
    ArrayList                           elms=new ArrayList();

    do { elms.add(0,dir); } while((dir=dir.getParentFile())!=null);
    elms.add(0,root);
    return new TreePath(elms.toArray(new File[elms.size()]));
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T10:11:39.967

[杰树](http://java.sun.com/j2se/1.5.0/docs/api/javax/swing/JTree.html)。[makeVisible()](http://java.sun.com/j2se/1.5.0/docs/api/javax/swing/JTree.html#makeVisible(javax.swing.tree.TreePath))应该是你需要的。

# c# - 使用 AJAX 滚动时未定义 ValidatorEnable

> ID：637955
> 
> 赞同：1
> 
> 时间：2009-03-12T10:04:02.560
> 
> 标签：c#, validation, ajax.net

我有一些 web 表单，它们可以与各种静态和动态生成的验证器一起正常工作。

由于某种原因，现在我已经在表单上实现了 UpdatePanels，当我在其中一个上手动调用 ValidatorEnable() 方法时（当我单击复选框时），我收到“ValidatorEnable is not defined”错误消息。

在实现 AJAX.net 控件之前，我将相同的 clientID 等传递给我正在使用的方法

.net 似乎没有将 /WebResource.axd?d=aUu4P3dfjWWyw3KQ9t2ZdqxnzYhrtq9uWWiRZduXE-g1 脚本渲染到页面，手动添加它我得到其他丢失的 JS 对象。那么如何强制它注册相关的脚本呢？

注意有问题的验证器正在转发器中呈现

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T10:27:49.710

我发现如果我在转发器之外的页面上放置一个禁用的验证器，它会正确添加相关的脚本。

这很hacky，但确实有效

注意这只是摆脱了 Javascript 错误，验证器似乎没有在页面上注册，所以无论如何 IsValid 始终为真。

# gnu - 为什么我不能创建一个新的子类并在同一个句子中使用它？

> ID：637956
> 
> 赞同：1
> 
> 时间：2009-03-12T10:04:58.593
> 
> 标签：gnu, smalltalk

我想知道为什么以下内容在 GNU Smalltalk 中不起作用：

```
Object subclass: Foo [ ] new printNl 
```

我期待打印输出类似“a Foo”的东西，但 gst 打印的是“nil”。这看起来是不是有点奇怪？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T16:27:22.703

这被解释为两个陈述。第一个是

对象子类：Foo [ ]

第二个是

新印刷品Nl

其中新变量未定义，因此为 nil。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T19:07:25.687

`Object subclass: Foo []`不是“通常”的 Smalltalk 语法，它是最近添加的，旨在使其在文件中编码变得实用。在此之前，没有专门的语法来声明类，因为它们将由图像中的命令创建。由于以下几个原因，按照您的预期解释此代码是错误的：

*   首先，如果`subclass:`是发送到的真实消息`Object`，则`Foo`应该解析为某事，这是不可能的，因为它刚刚被声明。然而，在幕后，编译器做了类似的事情`Object subclass: #Foo`where `#Foo`is a symbol 为要创建的新类的名称。可以像这样编写所有代码，除非您不能直接使用类名（因为在读取代码时它们还不存在）。你必须`(Smalltalk at: #Foo) new printNl`到处做。所以整个形式`Object subclass: Foo [ ]`是纯语法，只是声明应该创建这个类，并不意味着此时应该向 发送消息`Object`，等等

*   其次，您不想在算法中间创建类并立即向它们发送消息，这作为一种开发实践会非常难看。请注意，必须在系统中注册类，以便浏览器可以显示它们，编译器可以自动重新编译依赖项，版本控制可以记录它们等等。另外，如果您的代码不小心运行了两次怎么办？您是否应该获得第二堂课而忘记上一堂课？因此，通常只有编译器、浏览器和其他元编程工具才能创建新类，并且只能在程序员的请求下进行。

# vb.net - 如何使用 VB.NET 重新启动服务？

> ID：637957
> 
> 赞同：2
> 
> 时间：2009-03-12T10:05:41.213
> 
> 标签：vb.net

好的，所以我是 VB.NET 的新手，并尝试编写一个程序来提示用户输入服务器名称，然后在该机器上重新启动 IIS。

问题 1) 命名空间`System.ServiceProcess`未被识别。
问题 2）需要代码帮助，将 servername 传递给 sub。

```
Imports System
Imports System.ServiceProcess
Imports System.IO
Imports System.Threading

Class RestartIIS
    Shared Sub Main()
        Run()
    End Sub

    Public Sub Run()
        Console.WriteLine("Please enter the Server Name: ")
        Dim ServerName As String = Console.ReadLine()

        Dim sc As ServiceController = New ServiceController("W3SVC")

        sc.Stop()
        Thread.Sleep(2000)
        sc.Start()

        Console.Write("Press Enter to Exit")
        Console.ReadLine()
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T10:29:23.917

您应该`System.ServiceProcess`通过右键单击项目并单击添加引用来添加对程序集的引用...并获取传递给`Main`方法的命令行参数，如下所示：

```
Imports System
Imports System.ServiceProcess
Imports System.IO
Imports System.Threading

Class RestartIIS
    Shared Sub Main(ByVal commandLineArgs() as String)
        Run(commandLineArgs(0))
    End Sub

    Public Sub Run(ByVal machineName as String)
        Console.WriteLine("Please enter the Server Name: ")
        Dim ServerName As String = Console.ReadLine()

        Dim sc As ServiceController = New ServiceController("W3SVC", machineName)

        sc.Stop()
        Thread.Sleep(2000)
        sc.Start()

        Console.Write("Press Enter to Exit")
        Console.ReadLine()
    End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-07T16:57:50.430

```
ServiceControl.Stop()
Do
    ServiceControl.Refresh()
    If ServiceControl.Status = ServiceControllerStatus.Stopped Then
        ServiceControl.Start()
        Exit Do
    End If
Loop 
```

# java - 在单台机器上使用 .NET 和 Java 项目持续构建

> ID：637960
> 
> 赞同：0
> 
> 时间：2009-03-12T10:06:15.033
> 
> 标签：java, .net, continuous-integration, cruisecontrol

是否可以在具有单一应用程序集的单一构建服务器上设置用 .NET 和 Java 编写的项目的连续构建？

我已经看到 CruiseControl 支持这两个世界，但据我所知，这是两个独立的应用程序。我是否应该使用单独的机器来构建 Java 项目（已经设置了用于 .NET 项目的机器）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T10:18:41.103

[Hudson](http://hudson-ci.org/)支持 Ant（开箱即用的 IIRC）和[NAnt](http://wiki.hudson-ci.org/display/HUDSON/NAnt+Plugin)（通过插件），因此这是您的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T19:38:03.073

CruiseControl 支持多种不同的[构建选项](http://cruisecontrol.sourceforge.net/main/configxml.html#schedule)，包括[Ant](http://cruisecontrol.sourceforge.net/main/configxml.html#ant)、[Maven](http://cruisecontrol.sourceforge.net/main/configxml.html#maven2)、[NAnt](http://cruisecontrol.sourceforge.net/main/configxml.html#nant)、[Phing](http://cruisecontrol.sourceforge.net/main/configxml.html#phing) (php)、[Rake](http://cruisecontrol.sourceforge.net/main/configxml.html#rake)、[XCode](http://cruisecontrol.sourceforge.net/main/configxml.html#xcode)，然后是通用的“ [exec](http://cruisecontrol.sourceforge.net/main/configxml.html#exec) ”，您可以使用它来调用您想要的任何命令行脚本/工具。在同一台服务器上混合 Java 和 .NET 不是问题。

当然，这不是 CruiseControl 独有的。[正如您在此功能矩阵中](http://confluence.public.thoughtworks.org/display/CC/CI+Feature+Matrix)所见，有许多支持多种构建技术的 CI 工具。

免责声明：我在 CruiseControl 上工作。OTOH，因为我不赚钱，所以我不太在乎人们选择哪种工具。我更关心提升 CI 实践的状态，这就是我组织持续集成和测试会议 ( [CITCON](http://citconf.com/) ) 的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T10:08:22.937

`Ant`并且`NAnt`可以相当容易地执行任意进程，包括彼此，所以实际的*构建*部分不应该太难。

我希望棘手的一点是将报告（包括单元测试结果）转换为适当的格式。你的 XSLT 怎么样？;)

编辑：现在我想起来了，我的第一个敏捷项目有一个连续构建服务器（我相信只是 CruiseControl），它*一定*是在做一些这样的事情......我怀疑当时我们直接调用 Visual Studio 来构建代码和 NUnit 来测试它。如果我在同一家公司，我会检查，但那是两份工作之前 :(

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-12T12:17:23.893

您可以查看[Atlassian Bamboo](http://www.atlassian.com/software/bamboo/)。不幸的是，它不是免费的，除非您申请开源/社区许可证以与开源软件一起使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-13T21:09:41.830

您可以在同一台机器上使用两种不同的产品。或者，您可以在多台机器上运行单个构建系统。这实际上取决于您对 CI 施加的负载。

# c - 如何使用 CMake 自动生成 C 头文件？

> ID：637963
> 
> 赞同：4
> 
> 时间：2009-03-12T10:06:41.570
> 
> 标签：c, header, cmake

我正在寻找一种自动生成头文件的方法。这个文件是一个库的公共接口，我想在编译之前“填充”一些结构和东西。

例如，在私有标头中，我有一个包含有用字段的结构：

```
typedef struct mystuff_attr_t {
  int                      _detachstate;
  mystuff_scope_t          _scope;
  cpu_set_t                _cpuset;
  size_t                   _stacksize;
  void*                    _stackaddr;
} mystuff_attr_t; 
```

我想在公共标头中有这个结构，没有字段，但大小相同（目前手动完成）：

```
typedef struct mystuff_attr_t {
  char _opaque[ 20 ]; 
} mystuff_attr_t; 
```

我希望在创建构建系统时由 CMake 自动生成它，以避免在我更改私有标头中的结构时在公共接口中出现错误大小的结构。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-07T08:45:02.480

事实上，CMake 允许您生成文件（使用`configure_file (file.h.in file.h)`）并检查类型大小（使用`check_type_size ("type" header.h)`），因此很容易将这两者结合起来以获得适当的公共标头。这是我在 CMakeList.txt 中使用的一段代码：

```
# Where to search for types :
set (CMAKE_EXTRA_INCLUDE_FILES ${CMAKE_CURRENT_SOURCE_DIR}/private_type.h)

# Type1 :
check_type_size ("type1_t" MY_SIZEOF_TYPE1_T)

# Generate public header :
configure_file (${CMAKE_CURRENT_SOURCE_DIR}/pub_type.h.in ${CMAKE_CURRENT_BINARY_DIR}/pub_type.h)

# Need to set this back to nothing :
set (CMAKE_EXTRA_INCLUDE_FILES) 
```

在公共标头 pub_type.h.in 中：

```
#define MY_SIZEOF_TYPE1_T ${MY_SIZEOF_TYPE1_T} 
```

这工作得很好:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-24T10:36:42.283

Makeheaders[工具](http://www.hwaci.com/sw/mkhdr/)（[手册](http://www.hwaci.com/sw/mkhdr/makeheaders.html)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-12T11:03:17.253

我会编写一个创建标题的exe。

例如：

```
#include <stdio.h>

#define PUBLIC(TYPE) \
printf( "typedef struct %s { char _opaque[ %d ]; } %s;\n", #TYPE, sizeof(TYPE), #TYPE )

int main()
  {
  // start header stuff

  PUBLIC(mystuff_attr_t);

  // end header stuff
  } 
```

# c - 如何缓冲非阻塞 IO？

> ID：637964
> 
> 赞同：4
> 
> 时间：2009-03-12T10:07:04.250
> 
> 标签：c, io, nonblocking, buffered

当我在阻塞文件描述符上需要缓冲 IO 时，我使用 stdio。但是如果我根据手动stdio缓冲将文件描述符变为非阻塞模式是不可用的。经过一些研究，我发现 BIO 可用于缓冲非阻塞 IO。

但可能还有其他选择吗？

我需要这个来避免在多连接环境中使用线程。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-30T19:26:47.523

我认为您在谈论的是[Reactor Pattern](http://en.wikipedia.org/wiki/Reactor_pattern)。这是一种非常标准的处理大量网络连接而无需线程的方法，并且在多人游戏服务器引擎中非常常见。另一种实现（在 python 中）是[扭曲矩阵](http://www.twistedmatrix.com)。

基本算法是：

*   每个套接字都有一个缓冲区
*   检查哪些套接字已准备好读取（select()、poll() 或只是迭代）
*   对于每个插座：
    *   调用 recv() 并将内容累积到套接字的缓冲区中，直到 recv 返回 0 或 EWOULDBLOCK 错误
    *   使用缓冲区的内容调用套接字的应用程序级数据处理程序
    *   清除套接字的缓冲区

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T11:09:45.610

我看到这个问题现在已经被编辑过了，至少比以前更容易理解了。

无论如何，这不是矛盾吗？

*   您使 I/O 成为非阻塞的，因为您希望能够快速读取少量数据，通常会牺牲吞吐量来换取延迟。
*   您将其设置为缓冲是因为您不太关心延迟，而是希望通过用延迟换取吞吐量来有效利用 I/O 子系统。

同时做这两件事似乎是矛盾的，很难想象。

你追求的语义是什么？如果你这样做：

```
int     fd;
char    buf[1024];
ssize_t got;

fd = setup_non_blocking_io(...);
got = read(fd, buf, sizeof buf); 
```

如果有 3 个字节可用，您期望什么行为？阻塞/缓冲 I/O 可能会阻塞，直到能够读取更多满足您的请求，非阻塞 I/O 将立即返回 3 个可用字节。

当然，如果你在上面有一些协议，它定义了某种消息结构，这样你就可以知道“这个 I/O 不完整，直到我有更多数据才能解析它”，你可以自己缓冲它在该级别，并且在收到完整消息之前不要向上传递数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T11:47:58.980

根据协议，您当然可能需要为非阻塞网络节点（客户端或服务器）缓冲读取。

通常，这些缓冲区提供多个索引（偏移量），它们都记录处理的最后一个字节的位置和读取的最后一个字节的位置（与处理的偏移量相同或更大）。它们还（应该）提供更丰富的压缩缓冲区语义、透明缓冲区大小管理等。

在 Java 中（至少），非阻塞网络 io (NIO) 包还提供了一组数据结构（ByteBuffer 等），旨在提供通用数据结构。

C 语言要么存在这样的数据结构，要么你必须自己动手。一旦你有了它，然后简单地读取尽可能多的数据并让缓冲区管理诸如溢出之类的问题（例如跨消息帧边界读取字节）并使用标记偏移量来标记你已经处理的字节。

正如 Android 指出的那样，您（很可能）需要为每个打开的连接创建匹配的缓冲区。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T07:14:39.230

您可以为每个打开的文件描述符创建一个带有缓冲区的结构，然后累积这些缓冲区，直到 recv() 返回 0 或者您的缓冲区中有足够的数据来处理。

如果我正确理解您的问题，则您无法缓冲，因为通过非阻塞您正在写入具有多个连接（如果是全局）或只是写入小块数据（如果是本地）的同一个缓冲区。

在任何情况下，您的程序都必须能够识别数据的来源（可能通过文件描述符）并相应地对其进行缓冲。

线程也是一种选择，它并不像许多人听起来那样可怕。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-06T16:26:56.510

[Ryan Dahl 的 evcom 库](http://github.com/ry/evcom)，完全符合您的要求。

我在工作中使用它，效果很好。但请注意，它（还没有，但即将推出）没有异步 DNS 解析。Ryan 建议[为此使用 Michael Tokarev](http://www.corpit.ru/mjt/udns.html)的 udns。我现在正在尝试采用 udns 而不是阻止 getaddrinfo() 。

# configuration - Tomcat 6.x 管理

> ID：637972
> 
> 赞同：9
> 
> 时间：2009-03-12T10:10:11.577
> 
> 标签：configuration, tomcat, tomcat6, administration

由于管理工具没有从 Tomcat 5.x 移植到 Tomcat 6.x，人们如何管理 Tomcat 配置？

是否有其他 3rd 方管理应用程序可用？还是通过编辑xml文件完成所有配置。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T20:31:50.930

我更喜欢编辑 xml 文件，但您可以使用：

1.  [Lambda Probe](http://www.lambdaprobe.org)获取一些信息，
2.  一个 JMX 客户端（例如 JConsole），用于处理 Tomcat 拥有的各种 MBean。

作为记录，来自一位 tomcat 开发人员的消息很好地描述了 admin webapp 的问题：

[http://www.nabble.com/Tomcat-Administrator-tf3415576.html#a9519933](http://www.nabble.com/Tomcat-Administrator-tf3415576.html#a9519933)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-09T07:43:39.487

请查看 MuleSoft Tcat Server 以进行跨多个 Tomcat 服务器的[配置管理。](http://www.mulesoft.com/tomcat-configuration-management)

披露：我在 MuleSoft 工作，很乐意回答有关 Tcat Server 的任何问题。

# programming-languages - if/else 和 if/elseif

> ID：637980
> 
> 赞同：6
> 
> 时间：2009-03-12T10:12:05.177
> 
> 标签：programming-languages, syntax, if-statement

如果我有这样的语句块：

```
if (/*condition here*/){ }
else{ } 
```

或像这样：

```
if (/*condition here*/)
else if (/*condition here*/) {}
else if (/*condition here*/) {} 
```

有什么不同？

似乎对于 if/else，if 部分用于 true 状态，else 部分用于所有其他可能的选项（false）。else-if 对许多条件很有用。这是我的理解，还有什么需要注意的吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-12T10:17:36.317

如果没有“elseif”语法，您将不得不编写链式 if 语句来以这种方式处理几种可能的结果之一：

```
if( str == "string1" ) {
   //handle first case
} else {
    if( str == "string2" ) {
       //handle second case
    } else {
       if( str == "string3" ) {
           //handle third case
       } else {
          //default case
       }
    }
 } 
```

相反，你可以写

```
if( str == "string1" ) {
   //handle first case
} else if( str == "string2" ) {
   //handle second case
} else if( str == "string3" ) {
   //handle third case
} else {
   //default case
} 
```

这与前一个完全一样，但看起来更好，更容易阅读。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-12T10:16:11.157

情况一：

```
if( condition )
{
}
else
{
} 
```

当上述语句中的条件为 false 时，else 块中的语句将始终被执行。

情况乙：

```
if( condition )
{
}
else if( condition2 )
{
}
else
{
} 
```

当 'condition' 为 false 时，else if 块中的语句将仅在 condition2 为 true 时执行。当条件 2 为假时，将执行 else 块中的语句。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T12:09:55.720

许多语言都有这样的语法（这里：[*ECMAScript Language Specification*](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)，所以 JavaScript）：

> *IfStatement* :*表达式**语句**语句**表达式**语句*
>     **`if (`** ***`)`** ***`else`** ***`if (`** ***`)`******
> 
>  ****语句*：
>     *Block*
>     *VariableStatement*
>     *EmptyStatement*
>     *ExpressionStatement*
>     *IfStatement*
>     *IterationStatement*
>     *ContinueStatement*
>     *BreakStatement*
>     *ReturnStatement*
>     *WithStatement*
>     *LabelledStatement*
>     *SwitchStatement*
>     *ThrowStatement*
>     *TryStatement*
> 
> *块*：*StatementList*[选项]
>     **`{`** *[**`}`**]*
> 
>  **StatementList* :
>     *声明*
>     *StatementList* *声明*****

 **因此*ifStatement*的分支可能包含一个语句块（*Block*）或其他语句之一（除了*Block*）。这意味着这是有效的：

```
if (expr)
    someStatement;
else
    otherStatement; 
```

由于*StatementList*可能只包含一条语句，因此这些示例等效于前面的示例：

```
if (expr) {
    someStatement;
} else {
    otherStatement;
}

if (expr)
    someStatement;
else {
    otherStatement;
}

if (expr) {
    someStatement;
} else
    otherStatement; 
```

当我们用`otherStatement`一个额外的*IfStatement*替换时，我们得到这个：

```
if (expr) {
    someStatement;
} else
    if (expr) {
        someOtherStatement;
    } 
```

剩下的只是代码格式化：

```
if (expr) {
    someStatement;
} else if (expr) {
    someOtherStatement;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-13T14:20:07.617

强调秋葵所说的。

此外，如果一种语言有一个真正的 elif / elsif / elseif （比如，一个“真正的” else-if 指令，而不是一种通过格式化隐藏起来的嵌套链接），那么编译器可以轻松地在 Abstract语法树（或类似的，请参阅[http://en.wikipedia.org/wiki/Abstract_syntax_tree](http://en.wikipedia.org/wiki/Abstract_syntax_tree)）而不是嵌套它们。

举个例子：

用 C/C++ 说你有：

```
if (a) {
    X
} else if (b) {
    Y
} else if (c) {
    Z
} else {
    0
} 
```

然后编译器将像这样构建一个 AST 节点：

```
 a
  / \
 X   b
    / \
   Y   c
      / \
     Z   0 
```

但是如果选择的语言有一个真正的 if-else：

```
if (a) {
    X
} elif (b) {
    Y
} elif (c) {
    Z
} else {
    0
} 
```

然后 AST 可以更容易地看起来像这样：

```
 (a--b--c)
   /  /  /  \
  X  Y  Z    0 
```

在这种语言中，“if else”只有在大括号不是强制性的情况下才有可能：

```
if (a) {
    X
} elif (b) {
    Y
} else if (c) {  // syntax error "missing braces" if braces mandatory
    Z
} else {
    0
} 
```

对应的 AST（*如果大括号不是强制性的*）：

```
 (a--b)
   /  /  \
  X  Y    c
         / \
        Z   0 
```

这可以使 CFG 分析（[http://en.wikipedia.org/wiki/Control_flow_graph](http://en.wikipedia.org/wiki/Control_flow_graph)）更容易*实现*（尽管可能没有实际的优化好处；所以恕我直言，它只会让懒惰的程序员受益：D）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-12T10:15:08.990

`else if`基本上意味着of的`else`部分`if`是另一个`if`语句。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-04-05T06:52:53.453

```
**if/else**
if(condition)
  statement;
else
   statement; 
```

**如果/否则如果/否则**

```
if(condition)
 {
   if(condition)
      statement;
   else 
     statement;
  }   
else if(condition)
{
    if(condition)
     statement;
    else
     statement;
}
else
    statement; 
```

if/else 和 if/else if 也这样使用

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-12T10:15:27.680

给定一个变量，您将使用简单的`if-else`结构。当有多个变量并且您有不同的路径来执行不同的可能性时，您将使用`if-else if-...-else`. 请注意，后者也以`else`语句结尾。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-12T10:31:01.213

你自己已经给出了答案。if/else 用于真/假结果，例如 int=2 或任何其他可能的 int 值，if/elseif 用于超过 2 个结果，例如 int=2 和 int=3 等等。

它还对变量的上下文进行分组。你可以检查每一个结果，比如

```
if (a == 2) { do one thing };
if (a == 3) { do another thing };
...
if (a != 2 && a != 3 ...) { do something else }; 
```

使用 if/else/elseif 可读性更好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-02-22T04:28:21.060

如果您想检查更多条件，我们可以使用 if..elseif。单一条件，那么我们可以使用 if 或 if...else。

在这里，我无法通过示例上传完整的说明，因此请通过以下链接。

**if..else 语句详情**
[http://allinworld99.blogspot.in/2016/02/ifelse-flow-chart-with-easy-example.html](http://allinworld99.blogspot.com/2016/02/ifelse-flow-chart-with-easy-example.html)
**if...elseif 详情**
[http://allinworld99.blogspot.in/2016 /02/flow-chart-with-example-for-if-then.html](http://allinworld99.blogspot.com/2016/02/flow-chart-with-example-for-if-then.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-01T17:23:20.983

```
import java.util.*;

public class JavaApplication21 {
    public static void main(String[] args) {

        Scanner obj = new Scanner(System.in);
        System.out.println("You are watching an example of if & else if statements");

        int choice, a, b, c, d;
        System.out.println(" Enter 1-Addition & 2-Substraction");

        int option = obj.nextInt();
        switch (option) {
            case (1):
                System.out.println("how many numbers you want to add.... it can add up to 3 numbers only");
                choice = obj.nextInt();
                if (choice == 2) {
                    System.out.println("Enter 1st number");
                    a = obj.nextInt();

                    System.out.println("Enter 2nd number");
                    b = obj.nextInt();

                    c = a + b;

                    System.out.println("Answer of adding " + a + " & " + b + " is= " + c);
                } else if (choice == 3) {
                    System.out.println("Enter 1st number");
                    a = obj.nextInt();

                    System.out.println("Enter 2nd number");
                    b = obj.nextInt();

                    System.out.println("Enter 3rd number");
                    c = obj.nextInt();

                    d = a + b + c;

                    System.out.println("Answer of adding " + a + " , " + b + " & " + c + "  is= " + d);
                }
            case (2):
                System.out.println("how many numbers you want to substract.... it can substract up to 3 numbers only");
                choice = obj.nextInt();
                if (choice == 2) {
                    System.out.println("Enter 1st number");
                    a = obj.nextInt();

                    System.out.println("Enter 2nd number");
                    b = obj.nextInt();

                    c = a - b;
                    System.out.println("Answer of substracting " + a + " & " + b + " is= " + c);
                } else if (choice == 3) {
                    System.out.println("Enter 1st number");
                    a = obj.nextInt();

                    System.out.println("Enter 2nd number");
                    b = obj.nextInt();

                    System.out.println("Enter 3rd number");
                    c = obj.nextInt();

                    d = a - b - c;
                    System.out.println("Answer of substracting " + a + " , " + b + " & " + c + "  is= " + d);
                }
            default:
                System.out.println("no option you have chosen" + option);
        }
    }
} 
```

# ruby-on-rails - 使用 has_many 时如何访问 rails join 模型属性：通过

> ID：637981
> 
> 赞同：5
> 
> 时间：2009-03-12T10:13:13.207
> 
> 标签：ruby-on-rails, ruby, activerecord

我有一个类似这样的数据模型：

```
# columns include collection_item_id, collection_id, item_id, position, etc
class CollectionItem < ActiveRecord::Base
  self.primary_key = 'collection_item_id'
  belongs_to :collection
  belongs_to :item
end

class Item < ActiveRecord::Base
  has_many :collection_items
  has_many :collections, :through => :collection_items, :source => :collection
end

class Collection < ActiveRecord::Base
  has_many :collection_items, :order => :position
  has_many :items, :through => :collection_items, :source => :item, :order => :position
end 
```

一个项目可以出现在多个集合中，也可以在同一个集合的不同位置多次出现。

我正在尝试创建一个辅助方法，该方法创建一个包含每个集合中每个项目的菜单。我想使用 collection_item_id 在请求之间跟踪当前选定的项目，但我无法通过 Item 类访问连接模型的任何属性。

```
def helper_method( collection_id )
  colls = Collection.find :all
  colls.each do |coll|
    coll.items.each do |item|
# !!! FAILS HERE ( undefined method `collection_item_id' )
      do_something_with( item.collection_item_id )
    end
  end
end 
```

我也试过这个，但它也失败了（未定义的方法`collection_item'）

```
do_something_with( item.collection_item.collection_item_id ) 
```

编辑：感谢 serioys sam 指出上述内容显然是错误的

我还尝试访问连接模型中的其他属性，如下所示：

```
do_something_with( item.position ) 
```

和：

```
do_something_with( item.collection_item.position ) 
```

编辑：感谢 serioys sam 指出上述内容显然是错误的

但他们也失败了。

谁能告诉我如何进行此操作？

编辑：-------->

我从在线文档中发现，使用 has_and_belongs_to_many 会将连接表属性附加到检索到的项目，但显然它已被弃用。我还没试过。

目前我正在修改我的 Collection 模型，如下所示：

```
class Collection < ActiveRecord::Base
  has_many :collection_items, :order => :position, :include => :item
  ...
end 
```

并将助手更改为使用 coll.collection_items 而不是 coll.items

编辑：-------->

我已将我的助手更改为按上述方式工作，并且效果很好-（谢谢山姆）

它把我的代码弄得一团糟——因为这里没有详细说明其他因素——但是一两个小时的重构不会解决任何问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T10:39:18.480

在您的示例中，您已在 Item 模型关系中为 collection_items 和 collections 定义为 has_many，生成的关联方法是 collection_items 和 collections，它们分别返回一个数组，因此您在此处尝试访问的方式是错误的。这主要是 mant to many 关系的情况。只需查看此[Asscosociation 文档](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)以供进一步参考。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-12T11:46:06.417

```
do_something_with( item.collection_item_id ) 
```

这失败了，因为 item 没有 collection_item_id 成员。

```
do_something_with( item.collection_item.collection_item_id ) 
```

这失败了，因为 item 没有 collection_item 成员。

请记住，item 和 collection_items 之间的关系是 has_many。所以项目有collection_items，而不仅仅是一个项目。此外，每个集合都有一个集合项目列表。你想要做的可能是这样的：

```
colls = Collection.find :all
colls.each do |coll|
  coll.collection_items.each do |collection_item|
    do_something_with( collection_item.id )
  end
end 
```

其他几条建议：

*   您是否阅读过Rails 指南中的[has_many :through 文档？](http://guides.rubyonrails.org/association_basics.html#thehas-manythroughassociation)这是相当不错的。
*   你不应该在 has_many 声明中需要 :source 参数，因为你已经以合理的方式命名了你的模型和关联。

> 我从在线文档中发现，使用 has_and_belongs_to_many 会将连接表属性附加到检索到的项目，但显然它已被弃用。我还没试过。

我建议您坚持使用 has_many :through，因为 has_and_belongs_to_many 更令人困惑，并且没有提供任何真正的好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-26T22:09:35.037

我能够让我的一个模型工作：

```
class Group < ActiveRecord::Base
  has_many :users, :through => :memberships, :source => :user do
    def with_join
      proxy_target.map do |user|
        proxy_owner = proxy_owner()
        user.metaclass.send(:define_method, :membership) do
          memberships.detect {|_| _.group == proxy_owner}
        end
        user
      end
    end
  end
end 
```

在您的情况下，这样的事情应该可以工作（尚未测试）：

```
class Collection < ActiveRecord::Base
  has_many :collection_items, :order => :position
  has_many :items, :through => :collection_items, :source => :item, :order => :position do
    def with_join
      proxy_target.map do |items|
        proxy_owner = proxy_owner()
        item.metaclass.send(:define_method, :join) do
          collection_items.detect {|_| _.collection == proxy_owner}
        end
        item
      end
    end
  end
end 
```

现在，只要您像这样 ( `items.with_join`) 访问您的项目，您就应该能够从项目访问 CollectionItem：

```
def helper_method( collection_id )
  colls = Collection.find :all
  colls.each do |coll|
    coll.items.with_join.each do |item|
      do_something_with( item.join.collection_item_id )
    end
  end
end 
```

这是一个更通用的解决方案，您可以使用它将此行为添加到任何`has_many :through`关联：http: [//github.com/TylerRick/has_many_through_with_join_model](http://github.com/TylerRick/has_many_through_with_join_model)

```
class Collection < ActiveRecord::Base
  has_many :collection_items, :order => :position
  has_many :items, :through => :collection_items, :source => :item, :order => :position, :extend => WithJoinModel
end 
```

# c# - 填充从 XSD.exe 生成的类属性

> ID：637985
> 
> 赞同：4
> 
> 时间：2009-03-12T10:14:11.800
> 
> 标签：c#, xml, xsd

好的，我从我巨大的 XSD 文件生成了 C# 类。现在我有一组 C# 类、XSD 模式和实际的 XML 数据。有没有一种自动或半自动的方式来用我拥有的 XML 数据填充这些类实例？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T10:23:36.053

如果您习惯于`xsd.exe`生成类，那么`XmlSerializer`应该完成这项工作......

```
XmlSerializer ser = new XmlSerializer(typeof(RootType));
RootType type = (RootType) ser.Deserialize(source) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T10:23:22.107

您使用 xml 序列化/反序列化将数据导出/导入到 xml。看一下[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)类。msdn 页面上有一个示例。

# c++ - 好主意/坏主意 我应该重新实现大部分 C++ 吗？

> ID：637986
> 
> 赞同：10
> 
> 时间：2009-03-12T10:14:33.500
> 
> 标签：c++, code-reuse, standard-library

[最近，在阅读了这篇](http://www.codinghorror.com/blog/archives/001145.html "不要重新发明轮子，除非你打算更多地了解轮子")博文后，我的脑海中出现了一个危险的想法。这个想法可以这样表达：

我不需要 C++ 标准库提供的大部分内容。那么，为什么我不实现一个不太通用但更易于使用的版本呢？

例如，使用 STL 会吐出大量难以理解的编译器错误。但是，我不关心分配器、迭代器等。那么，为什么我不花几个小时来实现一个易于使用的链表类呢？

我想从 StackOverflow 社区知道的是：对于 C++ 中的大多数现有功能，“自行开发”有哪些危险、可能的缺点和可能的优点？

**编辑：**我觉得人们误解了我的这个想法。我的想法是了解我是否可以实现一个**非常**小的 STL 功能集，并大大简化了 - 更多的是作为一个项目来教我数据结构等。我不建议从头开始重新发明整个轮子，只是我需要和想要了解的部分。**我想我想弄清楚的是，使用 STL 的复杂性是否需要创建更小、更简单的版本。**

**重复使用 boost 或类似的。**

我编写的大部分代码都是为大学编写的，我们不允许使用外部库。所以它要么是 C++ 标准库，要么是我自己的类。

**这个问题的客观性。**

这个问题**不是**主观的。它也不应该是社区 Wiki，因为它不是民意调查。**我想要具体的论点来突出我的方法可能**出现的一个优点或一个缺点。与流行的看法相反，这不是意见，而是基于经验或良好的逻辑论证。

**格式。**

请每个答案只发布一个缺点**或一个优点。**这将允许人们一次评估单个想法而不是您的所有想法。

**请...**

没有宗教战争。我不是任何语言的粉丝。我使用任何适用的。对于图形和数据压缩（我目前正在做的工作），这似乎是 C++。请限制您对该问题的回答，否则他们将被否决。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-03-12T11:40:12.017

> 那么，为什么我不实现一个不太通用但更易于使用的版本呢？

因为你做不到。因为不管你对 C++ 说什么，它都不是一门简单的语言，如果你还不是很擅长它，那么你的链表实现就会出错。

老实说，您的选择很简单：

学习 C++，或者不要使用它。是的，C++ 通常用于图形，但 Java 也有 OpenGL 库。C#、Python 和几乎所有其他语言也是如此。或 C。您不必使用 C++。

但是，如果您确实使用它，请学习并正确使用它。

如果您想要不可变的字符串，请将您的字符串创建为 const。

无论其底层实现如何，STL 都非常易于使用。

*可以*读取C++ 编译器错误，但需要一些练习。但更重要的是，它们并不是 STL 代码独有的。无论您做什么，无论您使用哪些库，您都会遇到它们。所以习惯他们。如果你已经习惯了它们，你也可以使用 STL。

除此之外，还有一些其他的缺点：

*   没有其他人会理解您的代码。如果您在 SO 上询问有关 std::vector 或双向迭代器的问题，那么熟悉 c++ 的每个人都可以回答。如果您询问 My::CustomLinkedList，没有人可以帮助您。这是不幸的，因为滚动你自己也意味着会有更多的错误需要寻求帮助。
*   你试图治愈症状，而不是原因。问题是你不懂C++。STL 只是其中的一个症状。避免 STL 不会神奇地使您的 C++ 代码更好地工作。
*   编译器错误。是的，它们读起来很讨厌，但它们就在那里。STL 中的大量工作已用于确保在大多数情况下错误使用会触发编译器错误。在 C++ 中，很容易编写可以编译但不起作用的代码。或者似乎有效。或者在我的电脑上工作，但在其他地方神秘地失败了。您自己的链表几乎肯定会将更多错误转移到运行时，它们会在一段时间内未被发现，并且更难追踪。
*   再一次，这将是错误的。相信我。我见过该死的优秀 C++ 程序员在 C++ 中编写一个链表，只是为了在隐蔽的边界情况下发现一个又一个的错误。而 C++ 都是边界情况。您的链表会正确处理异常安全吗？如果创建新节点（并因此调用对象类型的构造函数）引发异常，它会保证一切都处于一致状态吗？它不会泄漏内存，会调用所有适当的析构函数吗？它会是类型安全的吗？它会像以前一样高效吗？在用 C++ 编写容器类时，有很多令人头疼的问题需要处理。
*   您错过了使用*任何*语言的现有最强大和最灵活的库之一。即使使用 Java 庞大的类库，STL 也可以做很多令人痛苦的事情。C++ 已经够难了，没有必要放弃它提供的一些优势。

> 我不关心分配器、迭代器等

可以安全地忽略分配器。你几乎不需要知道它们的存在。迭代器虽然很棒，但弄清楚它们会为您省去很多麻烦。要有效地使用 STL，您只需要了解三个概念：

*   容器：你已经知道这些了。向量、链表、映射、集合、队列等。
*   迭代器：允许您导航容器（或容器的子集，或任何其他值序列，在内存中，以流的形式在磁盘上，或在运行中计算）的抽象。
*   算法：适用于*任何*一对迭代器的常用算法。您有 sort、for_each、find、copy 和许多其他功能。

是的，与 Java 的库相比，STL 很小，但是当您结合上述 3 个概念时，它的强大功能令人惊讶。有一点学习曲线，因为它是一个不寻常的库。但是，如果您要花一两天以上的时间使用 C++，那么值得好好学习。

不，我没有遵循你的答案格式，因为我认为实际上给你一个详细的答案会更有帮助。;)

*编辑：*

很有可能会说滚动自己的优势是您可以学习更多的语言，甚至可能为什么 STL 是它的可取之处之一。但我并不真正相信这是真的。它可能有效，但也可能适得其反。

正如我上面所说，编写*似乎*可以工作的 C++ 代码很容易。当它停止工作时，很容易重新安排一些事情，比如变量的声明顺序，或者在类中插入一些填充，使其*看起来*再次工作。你会从中学到什么？那会教你如何编写更好的 C++ 吗？也许。但最有可能的是，它只会告诉你“C++ 很烂”。它会教你如何使用 STL 吗？当然不。一种更有用的方法可能是利用 StackOverflow 的强大功能以正确的方式学习 STL。:)

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-03-12T10:21:15.387

**缺点：**没有人，但你会使用它。

**优点：**在实现它的过程中，您将了解为什么标准库是一件好事。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-03-12T10:19:54.407

优点：吃自己的狗粮。你得到你所做的。

缺点：吃自己的狗粮。许多人，比我们 99% 的人都聪明，已经花费了数年时间来创建 STL。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-12T10:22:58.380

我建议你了解原因：

> 使用 STL 会吐出大量难以理解的编译器错误

第一的

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-12T10:17:50.997

缺点：你可能会花更多的时间来调试你的类库，而不是解决你面前的任何大学任务。

优势：你可能会学到很多东西！

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-12T10:58:15.393

对于神秘的编译器 STL 错误消息，您可以做一些事情。STLFilt 将有助于简化它们。来自[STLFilt 网站](http://www.bdsoft.com/tools/stlfilt.html)：

> STLFilt 简化和/或重新格式化冗长的 C++ 错误和警告消息，重点关注与 STL 相关的诊断（对于 MSVC 6，它完全消除了 C4786 警告及其碎片）。结果使许多甚至是最神秘的诊断都可以理解。

看看[这里](http://www.bdsoft.com/tools/stlfilt.html)，如果你使用 VisualC，也可以看看[这里](http://www.ddj.com/cpp/184401416?pgno=7)。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-03-12T15:32:52.537

我认为你应该这样做。

我敢肯定我会为此大吃一惊，但你知道，这里的每个 C++ 程序员都喝了太多的 STLcoolaid。

STL 是一个很棒的库，但我从第一手经验中知道，如果你自己动手，你可以：

1) 对于您的特定用例，使其比 STL 更快。2）您将编写一个仅包含所需接口的库。3）您将能够扩展所有标准的东西。（我无法告诉你我多么希望 std::string 有一个 split() 方法）......

当他们说这将是很多工作时，每个人都是对的。确实如此。

但是，你会学到很多东西。即使你写完之后再回到 STL 并且不再使用它，你仍然会学到很多东西。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-23T20:49:42.320

我的一点经验：不久前，我实现了自己的类矢量类，因为我需要对其进行良好的控制。

由于我需要通用性，我制作了一个模板化数组。

我还想不使用 operator[] 而是像使用 C 一样递增指针，所以我不计算 T[i] 在每次迭代时的地址......我添加了两个方法一个返回指针到分配的内存和另一个返回指向末尾的指针。要遍历整数数组，我必须编写如下内容：

```
for(int * p = array.pData(); p != array.pEnd(); ++p){
  cout<<*p<<endl; 
} 
```

然后，当我开始使用向量的向量时，我发现当有可能时，a 可以分配一大块内存，而不是多次调用 new。这时候我在模板类中添加了一个分配器。

直到那时我才注意到我写了一个完全没用的 std::vector<> 克隆。

至少现在我知道我为什么使用 STL ...

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-12T10:21:12.627

缺点：恕我直言，重新实现经过测试和验证的库是一个漏洞，几乎可以保证它比它的价值更麻烦。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-12T10:49:01.653

另一个**缺点**：

如果你想在大学毕业后找到一份 C++ 工作，大多数想要招聘你的人都会希望你熟悉标准 C++ 库。不一定对实现级别非常熟悉，但肯定熟悉它的用法和习语。如果您以自己的库的形式重新实现轮子，您将错过这个机会。尽管如此，如果你自己动手，你希望能学到很多关于图书馆设计的知识，这可能会根据你面试的地点为你赢得一些额外的布朗尼积分。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-03-12T15:21:23.407

坏处：

您正在引入对您自己的新库的依赖。即使这已经足够了，并且您的实现工作正常，您仍然有依赖关系。这可能会在代码维护方面给您带来很大的麻烦。其他人（包括您自己，在一年甚至一个月内）都不会熟悉您独特的字符串行为、特殊迭代器等。在您开始重构/扩展任何东西之前，需要付出很多努力才能适应新环境。如果您使用 STL 之类的东西，那么每个人都会知道它，它很容易理解并记录在案，没有人需要重新学习您的自定义一次性环境。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-03-23T20:24:53.097

您可能对[EASTL](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2271.html)感兴趣，这是对 STL Electronic Arts 的重写，不久前记录在案。他们的设计决策主要是由多平台视频游戏编程中的特定愿望/需求驱动的。链接文章中的摘要很好地总结了它。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-12T10:24:35.800

缺点：你的大学课程可能是这样布置的。事实上，你已经被它激怒了（讽刺不是故意的），这可能表明你没有得到范式，当你有范式转变时会受益很多。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-12T10:29:46.630

**优势**

如果您研究 MFC，您会发现您的建议已经在生产代码中使用 - 并且已经使用了很长时间。MFC 的集合类都没有使用 STL。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-12T10:38:41.447

为什么不看看现有的 C++ 库。在 C++ 还没有那么成熟的时候，人们经常编写自己的库。看看 Symbian（虽然很可怕），Qt 和 WxWidgets（如果我没记错的话）有基本的集合和东西，可能还有很多其他的。

我的观点是，STL 的复杂性源于 C++ 语言的复杂性，您几乎无法改进 STL（除了使用更合理的命名约定）。如果可以的话，我建议简单地切换到其他语言，或者只是处理它。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-03-12T11:30:00.667

**缺点**：重新实现*所有**这些*（即以高质量水平）肯定需要许多优秀的开发人员几年的时间。

 ** * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-03-25T21:19:27.817

> 例如，使用 STL 会吐出大量难以理解的编译器错误

其原因本质上是 C++ 模板。如果您使用模板（如 STL 那样），您将收到*大量难以理解的*错误消息。因此，如果您实现自己的基于模板的集合类，您将不会处于更好的位置。

您可以制作非基于模板的容器并将所有内容存储为 void 指针或某些基类，例如但是您将失去编译时类型检查，并且 C++ 作为一种动态语言很糟糕。这样做不像在 Objective-C、Python 或 Java 中那样安全。原因之一是 C++ 没有针对所有类的根类来对所有对象进行所有自省以及在运行时进行一些基本错误处理。相反，如果您对类型有误，您的应用程序可能会崩溃并烧毁，并且您不会得到任何错误的线索。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-12T10:18:59.777

> 对于 C++ 中的大多数现有功能，“自行开发”有哪些危险、可能的缺点和可能的优点？

你能负担得起并可能证明重新发明轮子所花费的精力/时间/金钱吗？

> 重复使用 boost 或类似的。

很奇怪，您不能使用 Boost。IIRC，大部分贡献来自与大学相关/在大学工作的人（想想 Jakko Jarvi）。使用 Boost 的好处太多了，这里就不一一列举了。

> 关于不“重新发明轮子”

**缺点：**虽然你学到了很多东西，但当你想到你真正的项目目标是什么时，你也会让自己倒退。

**优点：**对于要继承它的人来说，维护更容易。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-12T15:12:41.270

STL 非常复杂，因为它需要用于通用库。

STL 是这样的原因：

*   基于交互器，因此标准算法只需要针对不同类型的容器的单一实现。
*   设计为在面对异常时行为正确。
*   设计为在多线程应用程序中是“线程”安全的。

但是，在许多应用程序中，您确实拥有以下内容：

*   字符串类
*   O(1) 查找的哈希表
*   带有排序/和二进制搜索的向量/数组排序集合

如果你知道：

*   您的课程不会在构造或作业上抛出异常。
*   您的代码是单线程的。
*   您不会使用更复杂的 STL 算法。

然后您可能可以编写自己的更快的代码，使用更少的内存并产生更简单的编译/运行时错误。

没有 STL 的更快/更容易的一些示例：

*   Copy-on-Write 字符串，带有引用计数的字符串缓冲区。（不要在多线程环境中执行此操作，因为您需要锁定引用计数访问。）
*   使用良好的哈希表而不是 std::set 和 std::map。
*   可以作为单个对象传递的“Java”样式迭代器
*   不需要知道容器类型的迭代器类型（为了更好的编译时代码解耦）
*   具有更多实用功能的字符串类
*   矢量容器中的可配置边界检查。（所以不是 [] 或 .at 而是具有编译或运行时标志的相同方法，用于从“安全”模式转到“快速”模式）
*   容器设计为使用指向将删除其内容的对象的指针。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-03-23T20:15:24.617

看起来您更新了问题，所以现在确实有两个问题：

1.  如果我认为 std:: 库对我的需要来说太复杂了，我该怎么办？

设计您自己的类，在内部使用相关的 std:: 库功能为您完成“繁重的工作”。这样你就不会出错，而且你仍然可以发明自己的编码接口。

2.  如果我想学习数据结构是如何工作的，我应该怎么做？

从头开始设计您自己的一组数据结构类。然后试着弄清楚为什么标准的更好。

# c# - 如何确定对象的类型是否是 IEnumerable 的子类 对于任何值类型 T？

> ID：637987
> 
> 赞同：9
> 
> 时间：2009-03-12T10:14:52.580
> 
> 标签：c#, .net, generics, reflection

我需要验证一个对象以查看它是 null、值类型还是值类型`IEnumerable<T>`在哪里`T`。到目前为止，我有：

```
if ((obj == null) ||
    (obj .GetType().IsValueType))
{
    valid = true;
}
else if (obj.GetType().IsSubclassOf(typeof(IEnumerable<>)))
{
     // TODO: check whether the generic parameter is a value type.
} 
```

所以我发现这个对象是空的，一个值类型，或者`IEnumerable<T>`对于一些`T`；如何检查这是否`T`是值类型？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-12T10:17:33.417

（编辑 - 增值类型位）

您需要检查它实现的所有接口（注意它理论上可以实现`IEnumerable<T>`多个`T`）：

```
foreach (Type interfaceType in obj.GetType().GetInterfaces())
{
    if (interfaceType.IsGenericType
        && interfaceType.GetGenericTypeDefinition() == typeof(IEnumerable<>))
    {
        Type itemType = interfaceType.GetGenericArguments()[0];
        if(!itemType.IsValueType) continue;
        Console.WriteLine("IEnumerable-of-" + itemType.FullName);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T10:23:11.810

你能做点什么`GetGenericArguments`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-22T15:19:50.877

我的通用贡献是检查给定类型（或其基类）是否实现了类型 T 的接口：

```
public static bool ImplementsInterface(this Type type, Type interfaceType)
{
    while (type != null && type != typeof(object))
    {
        if (type.GetInterfaces().Any(@interface => 
            @interface.IsGenericType
            && @interface.GetGenericTypeDefinition() == interfaceType))
        {
            return true;
        }

        type = type.BaseType;
    }

    return false;
} 
```

# reflection - 向上转换通过反射创建的 F# 记录

> ID：637989
> 
> 赞同：3
> 
> 时间：2009-03-12T10:14:59.880
> 
> 标签：reflection, f#, record

我一直在搞乱 F# 和它的反射，试图从 F# 中动态创建一个记录类型对象，我得到了大部分工作（如下所示）但有一件事 - 我通过反射创建的记录具有类型“ obj” 而不是它应该的那个（“Person”），我似乎无法以任何方式向上转换它。

```
#light

type Person = {
    Name:string;
    Age:int;
}

let example = {Name = "Fredrik"; Age = 23;}
// example has type Person = {Name = "Fredrik"; Age = 23;}

let creator = Reflection.FSharpValue.PrecomputeRecordConstructor(example.GetType(), 
               System.Reflection.BindingFlags.Public)

let reflected = creator [| ("thr" :> obj); (23 :> obj) |]
// here reflected will have the type obj = {Name = "thr"; Age = 23;}

// Function that changes the name of a Person record
let changeName (x:Person) (name:string) = 
    { x with Name = name }

// Works with "example" which is has type "Person"
changeName example "Johan"

// But not with "reflected" since it has type "obj"
changeName reflected "Jack" // Error "This expression has type obj but is here used with type Person. "

// But casting reflected to Person doesn't work either
(reflected :> Person) // Type constraint mismatch. The type   obj is not compatible with 
                      // type  Person. The type 'obj' is not compatible with the type 'Person'. 
                      // C:\Users\thr\Documents\Visual Studio 2008\Projects\
                      // Reflection\Reflection\Script.fsx   34  2   Reflection 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T11:11:07.017

尝试使用 other cast 运算符（因为这次您正在以另一种方式进行投射）

所以 changeName (reflected **:?>** Person) "Jack"*******