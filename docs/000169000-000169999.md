# StackOverflow 问答 000169000-000169999

# regex - 用于解析目录和文件名的正则表达式

> ID：169008
> 
> 赞同：38
> 
> 时间：2008-10-03T21:41:07.547
> 
> 标签：regex, parsing

我正在尝试编写一个正则表达式，它将使用匹配组解析出完全限定路径的**目录和文件名。**

所以...

```
/var/log/xyz/10032008.log 
```

会承认`group 1 to be "/var/log/xyz"`和`group 2 to be "10032008.log"`

看起来很简单，但我无法让匹配组为我的生活工作。

注意：正如一些受访者所指出的，这可能不是正则表达式的好用处。一般来说，我更喜欢使用我正在使用的语言的文件 API。我实际上想要做的事情比这更复杂一点，但解释起来会困难得多，所以我选择了一个每个人都熟悉的域，以便最简洁地描述根本问题。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-10-03T21:44:56.760

试试这个：

```
^(.+)\/([^\/]+)$ 
```

编辑：转义正斜杠以防止在复制/粘贴正则表达式时出现问题

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2015-10-08T17:04:32.550

[在支持具有非捕获组的](http://www.regular-expressions.info/brackets.html)正则表达式的语言中：

```
((?:[^/]*/)*)(.*) 
```

我将通过爆炸来解释粗糙的正则表达式......

```
(
  (?:
    [^/]*
    /
  )
  *
)
(.*) 
```

各部分的含义：

```
(  -- capture group 1 starts
  (?:  -- non-capturing group starts
    [^/]*  -- greedily match as many non-directory separators as possible
    /  -- match a single directory-separator character
  )  -- non-capturing group ends
  *  -- repeat the non-capturing group zero-or-more times
)  -- capture group 1 ends
(.*)  -- capture all remaining characters in group 2 
```

## 例子

为了测试正则表达式，我使用了以下 Perl 脚本...

```
#!/usr/bin/perl -w

use strict;
use warnings;

sub test {
  my $str = shift;
  my $testname = shift;

  $str =~ m#((?:[^/]*/)*)(.*)#;

  print "$str -- $testname\n";
  print "  1: $1\n";
  print "  2: $2\n\n";
}

test('/var/log/xyz/10032008.log', 'absolute path');
test('var/log/xyz/10032008.log', 'relative path');
test('10032008.log', 'filename-only');
test('/10032008.log', 'file directly under root'); 
```

脚本的输出...

```
/var/log/xyz/10032008.log -- absolute path
  1: /var/log/xyz/
  2: 10032008.log

var/log/xyz/10032008.log -- relative path
  1: var/log/xyz/
  2: 10032008.log

10032008.log -- filename-only
  1:
  2: 10032008.log

/10032008.log -- file directly under root
  1: /
  2: 10032008.log 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-03T21:57:44.737

大多数语言都有路径解析功能，它们已经为您提供了这个功能。如果您有能力，我建议您免费使用开箱即用的东西。

假设 / 是路径分隔符...

```
^(.*/)([^/]*)$ 
```

第一组将是目录/路径信息，第二组将是文件名。例如：

*   **/foo/bar/baz.log**：“/foo/bar/”是路径，“baz.log”是文件
*   **foo/bar.log** : "foo/" 是路径，"bar.log" 是文件
*   **/foo/bar** : "/foo/" 是路径，"bar" 是文件
*   **/foo/bar/** : "/foo/bar/" 是路径，没有文件。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-03T21:43:26.137

什么语言？为什么要使用正则表达式来完成这个简单的任务？

如果你*必须*：

```
^(.*)/([^/]*)$ 
```

给你你想要的两个部分。您可能需要引用括号：

```
^\(.*\)/\([^/]*\)$ 
```

取决于您喜欢的语言语法。

但我建议您只使用您的语言的字符串搜索功能来查找最后一个“/”字符，然后在该索引上拆分字符串。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-04-09T19:42:07.920

# 推理：

我通过试错法做了一些研究。发现键盘中可用的所有值都可以作为文件或目录，除了 *nux 机器中的“/”。

我使用 touch 命令为以下字符创建文件，它创建了一个文件。

> *（下面的逗号分隔值）*
> '!'、'@'、'#'、'$'、"'"、'%'、'^'、'&'、'*'、'('、')'、 ' ', '"', '\', '-', ',', '[', ']', '{', '}', '`', '~', '>', '<' , '=', '+', ';', ':', '|'

仅当我尝试创建“/”（因为它是根目录）和文件名容器时它才失败，`/`因为它是文件分隔符。

`.`当我这样做时，它改变了当前目录的修改时间`touch .`。但是，file.log 是可能的。

当然，`a-z`, `A-Z`, `0-9`, `-`(hypen), `_`(underscore) 应该可以工作。

# 结果

因此，通过上述推理，我们知道文件名或目录名可以包含除`/`正斜杠之外的任何内容。因此，我们的正则表达式将由文件名/目录名中不存在的内容派生。

```
/(?:(?P<dir>(?:[/]?)(?:[^\/]+/)+)(?P<filename>[^/]+))/ 
```

# 一步一步的正则表达式创建过程

## 模式说明

### 步骤 1：从匹配`root`目录开始

`/`目录可以以绝对路径开头，目录名可以以相对路径开头。因此，寻找`/`零次或一次出现。

```
/(?P<filepath>(?P<root>[/]?)(?P<rest_of_the_path>.+))/ 
```

[![在此处输入图像描述](https://i.stack.imgur.com/1fhbA.png)](https://i.stack.imgur.com/1fhbA.png)

### 步骤2：尝试找到第一个目录。

接下来，一个目录和它的子目录总是用 . 分隔`/`。目录名称可以是除`/`. 让我们先匹配/var/。

```
/(?P<filepath>(?P<first_directory>(?P<root>[/]?)[^\/]+/)(?P<rest_of_the_path>.+))/ 
```

[![在此处输入图像描述](https://i.stack.imgur.com/5OzQh.png)](https://i.stack.imgur.com/5OzQh.png)

### 步骤 3：获取文件的完整目录路径

接下来，让我们匹配所有目录

```
/(?P<filepath>(?P<dir>(?P<root>[/]?)(?P<single_dir>[^\/]+/)+)(?P<rest_of_the_path>.+))/ 
```

[![在此处输入图像描述](https://i.stack.imgur.com/IlxjF.png)](https://i.stack.imgur.com/IlxjF.png)

在这里， single_dir 是`yz/`因为，首先它匹配`var/`，然后它找到下一次出现的相同模式，即`log/`，然后它找到下一次出现的相同模式`yz/`。因此，它显示了模式的最后一次出现。

### 第 4 步：匹配文件名并清理

现在，我们知道我们永远不会使用像 single_dir、filepath、root 这样的组。因此，让我们清理一下。

让我们将它们保留为组，但不要捕获这些组。

而 rest_of_the_path 只是文件名！所以，重命名。而且文件的名称中不会有`/`，所以最好保留`[^/]`

```
/(?:(?P<dir>(?:[/]?)(?:[^\/]+/)+)(?P<filename>[^/]+))/ 
```

这给我们带来了最终的结果。当然，还有其他几种方法可以做到。我只是在这里提到一种方式。

[![在此处输入图像描述](https://i.stack.imgur.com/Yx3BI.png)](https://i.stack.imgur.com/Yx3BI.png)

# 上面使用的正则表达式规则在此处列出

`^`表示以组名开头的字符串
`(?P<dir>pattern)`表示捕获组。我们有两个带有组名的组`dir`，`file`
`(?:pattern)`意味着不考虑这个组或非捕获组。
`?`表示匹配零或一。 `+`表示匹配一个或多个 `[^\/]`表示匹配除正斜杠 ( `/`)之外的任何字符

`[/]?`意味着如果它是绝对路径，那么它可以以 / 开头，否则它不会。因此，匹配零个或一个`/`.

`[^\/]+/`表示一个或多个不是正斜杠 ( `/`) 后跟正斜杠 ( ) 的字符`/`。这将匹配`var/`或`xyz/`。一次一个目录。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-03T18:08:44.140

那这个呢？

```
[/]{0,1}([^/]+[/])*([^/]*) 
```

确定性：

```
((/)|())([^/]+/)*([^/]*) 
```

严格的 ：

```
^[/]{0,1}([^/]+[/])*([^/]*)$
^((/)|())([^/]+/)*([^/]*)$ 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-10-29T16:21:45.987

一个很晚的答案，但希望这会有所帮助

```
^(.+?)/([\w]+\.log)$ 
```

这使用惰性检查`/`，我刚刚修改了接受的答案

[http://regex101.com/r/gV2xB7/1](http://regex101.com/r/gV2xB7/1)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-03T21:48:47.687

试试这个：

```
/^(\/([^/]+\/)*)(.*)$/ 
```

不过，它会在路径上留下斜杠。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-05T10:44:13.727

给定一个示例上传文件夹 URL：

```
https://drive.google.com/drive/folders/14Q6d-KiwgTKE-qm5EOZvHeX86-Wf9Q5f?usp=sharing 
```

正则表达式模式是：

```
[-\w]{25,} 
```

此模式也适用于 Google 表格以及 Excel 中的自定义函数：

```
=REGEXEXTRACT(N2,"[-\w]{25,}") 
```

结果是：`14Q6d-KiwgTKE-qm5EOZvHeX86-Wf9Q5f`

[![在此处输入图像描述](https://i.stack.imgur.com/ru4hx.png)](https://i.stack.imgur.com/ru4hx.png)

[![在此处输入图像描述](https://i.stack.imgur.com/WAsXk.png)](https://i.stack.imgur.com/WAsXk.png)

[![在此处输入图像描述](https://i.stack.imgur.com/WAsXk.png)](https://i.stack.imgur.com/WAsXk.png)

# tdd - 伪代码编程过程与测试驱动开发

> ID：169020
> 
> 赞同：16
> 
> 时间：2008-10-03T21:44:38.117
> 
> 标签：tdd, pseudocode, ppp

对于没有读过 Code Complete 2 的人来说，Pseudocode Programming Process 基本上是一种设计例程的方法，先用通俗的英语描述，然后逐步修改为更详细的伪代码，最后是代码。这样做的主要好处是通过自上而下而不是自下而上构建系统来帮助您保持在正确的抽象级别，从而在不同的层中发展出干净的 API。我发现 TDD 在这方面不太有效，因为它过于关注做最少的事情以使测试通过，并且鼓励很少的前期设计。我还发现必须为不稳定的代码（不断被重构的代码）维护一套单元测试是相当困难的，因为通常情况下，你需要为一个只需要一次或两次的例程进行十几个单元测试。当你进行重构时——例如更改方法签名——你所做的大部分工作是更新测试而不是更新产品代码。我更喜欢在组件的代码稍微稳定后添加单元测试。

我的问题是——在尝试过这两种方法的人中，你更喜欢哪一种？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-04-02T10:04:11.667

我的团队混合了这两种方法，这是一种很棒的开发方式（至少对我们而言）。我们需要单元测试，因为我们有一个庞大而复杂的软件系统。但是伪代码编程过程无疑是我遇到的最好的软件设计方法。为了让它们一起工作：

*   我们首先编写我们的类，并用完全注释的方法存根填充输入和输出。
*   我们使用结对编码和同行评审作为对话来改进和验证设计，仍然只使用方法存根。
*   在这一点上，我们现在既设计了我们的系统，也有了一些可测试的代码。所以我们继续编写我们的单元测试。
*   我们返回并开始在方法中填写需要编写的逻辑注释。
*   我们写代码；测试通过。

它的美妙之处在于，当我们真正编写代码时，大部分实现工作已经完成，因为我们认为实现的大部分内容实际上是代码设计。此外，早期过程取代了对 UML 的需求——类和方法存根具有描述性，而且它实际上会被使用。而且我们总是停留在适当的抽象级别。

显然，这个过程从来没有像我所描述的那样真正线性 - 一些实现的怪癖可能意味着我们需要重新审视高级设计。但总的来说，当我们编写单元测试时，设计真的很稳定（在方法级别），所以不需要大量的测试重写。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-03T21:51:15.873

使用测试驱动开发，您仍然应该在开始时进行一些规划。首先应该是对您正在尝试做的事情进行高层次的了解。不要想出所有的细节，而是用简单的英语了解如何解决问题。

然后开始测试问题。一旦你完成了测试，就开始让它通过。如果这不容易做到，您可能需要修改您的初始计划。有问题就修改。测试不是为了定义解决方案，它允许您进行更改，以便您可以在确保稳定性的同时获得更好的解决方案。

我想说最好的选择是使用 TDD。关键是要认识到 TDD 并不意味着“跳过计划”。TDD 意味着做一些计划以顺利开始，并根据需要进行调整。你甚至可能不需要调整。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T21:55:17.860

一般来说，我发现伪代码只有在解决问题所需的代码比测试解决方案所需的代码复杂得多时才真正相关。如果不是这种情况，我不会遇到您所描述的困难，因为最简单的事情可能有效，通常是一个可接受的解决方案，值得花在问题上的时间量。

另一方面，如果问题*很*复杂，我需要考虑如何解决它，然后才能编写一个初始的幼稚解决方案——我仍然需要在编写代码之前进行计划；因此，我使用了两种方法的组合：我将最初编写的内容的英文描述，然后是测试工具，然后是简单的解决方案代码，然后是细化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T22:22:40.550

我已经将这两种方法与 Big Upfront Development 一起使用，这三种方法都有各自的位置，具体取决于语言、团队动态和程序大小/复杂性等问题。

在动态语言（尤其是 ruby​​）中，我强烈推荐 TDD，它可以帮助您捕获其他语言在编译时会捕获的错误。

在一个大型、复杂的系统中，您预先做的设计越多，您的情况就会越好。似乎当我为一个大型项目进行设计时，我挥手并说“这应该是相当直截了当”的每个区域都是项目后期的一个绊脚石。

如果您正在使用静态类型语言单独处理一些小问题，那么列表方法是合理的，并且会为您节省大量的 TDD 时间（测试维护不是免费的，尽管首先编写测试并不是太不好）--当您正在处理的系统中没有任何测试时，添加测试并不总是令人钦佩，您甚至可能会引起一些不必要的注意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T23:18:45.773

仅仅因为测试通过，并不意味着你已经完成了。

TDD 的最佳特点是[Red-Green-Refactor](http://redgreenrefactor.com/)。

有一个测试提供一个（两个）目标线。这只是第一个，最小的一组要求。真正的目标与“伪代码编程过程”或任何设计学科的目标相同。

此外，TDD 是由测试*驱动*的，但这并不意味着*盲目地*由测试驱动。您可以像迭代代码一样迭代测试。这里没有教条坚持愚蠢计划的地方。这是一种敏捷技术——这意味着将其适应您的团队和您的环境。

设计足够的代码以具有可测试的接口。设计足够多的测试以确保接口能够正常工作。设计更多的测试和更多的实现，直到你看到重构的需要。

真正的目标是好的软件。TDD 不能排除“善良”。

技术不是限制性要求。应该将技术视为帮助您生产出良好代码的拐杖。如果我更聪明、更富有、更漂亮，我就不需要 TDD。但由于我和我一样笨，我需要一个拐杖来帮助我重构。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-05T09:22:08.293

对我来说，TDD 有一个无法与之竞争的王牌伪代码——它们都可以帮助您抽象和规划开发，但是一旦您在 TDD 领域完成了开发，*您仍然拥有单元测试*。

作为 CC2 描述的伪编码的有用方法，它无法与之匹敌。TDD 只是设计的一半，它还提供了一个严格的脚手架，您可以从中发展项目。但是我看不出为什么你不能用伪代码来解决 TDD 设置的问题。

> 我不能有机地发展。
> 伪代码是心灵杀手。
> 导致项目记忆遗忘的是小死亡。
> 我将面对我 90 后的方法论。
> 我会允许它越过我并穿过我。
> 当它过去时，我会转动内在的眼睛，看看它的路径。
> 伪代码去了哪里，哪里就有 TDD。
> 只保留单元测试。

*（请不要为此而责骂我，我只是半认真的：P）*

# objective-c - [NSKeyedUnarchiver decodeObjectForKey] 导致内存泄漏

> ID：169034
> 
> 赞同：3
> 
> 时间：2008-10-03T21:49:07.343
> 
> 标签：objective-c, cocoa

每次我调用此方法时，我的 NSMutableData 都会泄漏，我无法弄清楚如何插入它。在分配和初始化解码器后，theData 的保留计数增加了 1，我不知道为什么。我在方法结束时被保留计数为 2 并试图释放它会导致应用程序崩溃。

```
- (void)readVenueArchiveFile:(NSString *)inFile key:(NSString *)inKey
{
    NSMutableData *theData;
    NSKeyedUnarchiver *decoder;

    theData = [NSData dataWithContentsOfFile:inFile];

    decoder = [[NSKeyedUnarchiver alloc] initForReadingWithData:theData];

    venueIOList = [[decoder decodeObjectForKey:inKey] mutableCopy];

    [decoder finishDecoding];

    [decoder release];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-06T15:43:36.580

## 减少峰值内存占用

一般来说，最好的做法是避免生成自动释放的对象。

[本段大部分内容从[这个问题](https://stackoverflow.com/questions/106627/memory-management-in-objective-c#146720)修改。]由于您通常（1）无法直接控制它们的生命周期，因此自动释放的对象可能会持续相对较长的时间，并且不必要地增加应用程序的内存占用。虽然在桌面上这*可能*没什么影响，但在更受限制的平台上，这可能是一个重大问题。因此，在所有平台上，尤其是在更受限制的平台上，强烈建议您不要使用会导致自动释放对象的方法，而是鼓励您使用 alloc/init 模式。

我建议更换这个：

```
theData = [NSData dataWithContentsOfFile:inFile]; 
```

和：

```
theData = [[NSData alloc] initWithContentsOfFile:inFile]; 
```

然后在方法的最后添加：

```
[theData release]; 
```

这意味着`theData`将在方法退出之前释放。你最终应该得到：

```
- (void)readVenueArchiveFile:(NSString *)inFile key:(NSString *)inKey
{
    NSMutableData *theData;
    NSKeyedUnarchiver *decoder;

    theData = [[NSData alloc] initWithContentsOfFile:inFile];
    decoder = [[NSKeyedUnarchiver alloc] initForReadingWithData:theData];
    ListClassName *decodedList = [decoder decodeObjectForKey:inKey];
    self.venueIOList = decodedList;
    [decoder finishDecoding];
    [decoder release];
    [theData release]; 
```

}

这使得内存管理语义清晰，并尽快回收内存。

(1) 您可以使用自己的本地自动释放池进行控制。有关这方面的更多信息，请参阅[Apple 的内存管理编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/Concepts/AutoreleasePools.html#//apple_ref/doc/uid/20000047)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T03:58:55.287

我建议替换这一行：

```
venueIOList = [[decoder decodeObjectForKey:inKey] mutableCopy]; 
```

和：

```
ListClassName *decodedList = [decoder decodeObjectForKey:inKey];
self.venueIOList = decodedList; 
```

这使得内存管理`decodedList`一目了然。使用访问器方法（初始化方法除外）分配实例变量被认为是最佳实践。在您当前的实现中，如果您`readVenueArchiveFile:`在同一个对象上再次调用，您**将**泄漏（如果`decodedList`已经有一个值，您将会泄漏）。此外，您可以将复制逻辑放在访问器方法中并忘记它，而不是每次分配新值时都必须记住 mutableCopy（假设无论如何都有充分的理由制作可变副本？）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T23:08:05.763

不要担心保留计数，担心方法内的平衡。`venueIOList`假设是一个实例变量，你在这个方法中所做的看起来是正确的。

稍微扩展我的答案：取消归档程序可能会在取消归档操作期间保留您的数据，然后在`-autorelease`完成时发送数据而不是`-release`. 因为那不是*你*做的事情，所以*你*不必关心。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-04T03:15:49.993

引用计数相关的内存管理启示的最终来源仍然是，IMO，来自 Stepwise 的[“Hold Me, Use Me, Free Me”](http://www.stepwise.com/Articles/Technical/HoldMe.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-04T04:34:01.923

您的代码是正确的；没有内存泄漏。

```
theData = [NSData dataWithContentsOfFile:inFile];
```

相当于

```
theData = [[[NSData alloc] initWithContentsOfFile:inFile] autorelease];
```

此时 theData 的引用计数为 1（如果更少，它将被释放）。引用计数将在未来某个时候由自动释放池自动递减。

```
decoder = [[NSKeyedUnarchiver alloc] initForReadingWithData:theData];
```

解码器对象保留对 theData 的引用，这会将其引用计数增加到 2。

方法返回后，自动释放池将这个值递减为1。如果你在这个方法结束时释放数据，引用计数将变为0，对象将被释放，当你尝试使用它时你的应用程序会崩溃。

# compilation - JDK1.6运行ant时如何编译类到JDK1.5

> ID：169044
> 
> 赞同：3
> 
> 时间：2008-10-03T21:53:39.893
> 
> 标签：compilation, backwards-compatibility, jdk1.6, jdk1.5

我的开发环境是在JDK1.6中运行的，我需要编译一些类来兼容运行JDK1.5的客户端。我将如何使用 'javac' ant 目标执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T21:56:43.740

命令行：javac -target 1.5 源文件

蚂蚁：`< javac srcdir="${src} destdir="${build}" target="1.5" />`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T22:01:01.920

```
<javac source="1.5"... /> 
```

# c++ - 运行单元测试时的内存泄漏检测

> ID：169058
> 
> 赞同：4
> 
> 时间：2008-10-03T21:58:28.370
> 
> 标签：c++, winapi, memory-leaks

我有一个带有一套单元测试的 Win32 C++ 应用程序。单元测试完成运行后，我希望自动生成关于任何未释放内存的可读报告。理想情况下，报告将有一个堆栈，其中包含每个未释放分配的文件和行号信息。最好让它们以一致的顺序生成，以便轻松区分它从一次运行到下一次运行。（基本上，我想要 valgrind --leak-check=full 的结果，但在 Windows 上）。

我已经成功使用 UMDH 从正在运行的进程中获取此类信息，但该工具似乎只有在附加到现有进程时才有效。我希望每次运行单元测试时自动发生这种情况。

有没有可以做到这一点的工具？如果是这样，我该如何使用它？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T22:19:49.870

为了获得这类信息，我们重写了 new/delete 和 malloc/free，提供了我们自己的堆实现来存储分配时的堆栈跟踪，并在堆被销毁时生成报告（以及添加标记来检测缓冲区溢出）。

这是你第一次做的相当多的工作。[这个人](http://www.codeproject.com/KB/applications/visualleakdetector.aspx)写了一个免费软件工具来处理所有的难点——我自己还没有尝试过，但他对他如何编写它的解释在你自己动手时很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T22:12:03.427

如果你使用 MSVC，微软的 Debug heap 函数可以用来生成你想要的报告，但它可能不像你想要的那样自动（你可能需要编写一些自定义代码）：

```
_CrtSetReportMode
_CrtSetReportFile
_CrtMemState    
_CrtMemCheckpoint
_CrtMemDumpStatistics
_CrtSetReportFile
_CrtSetDbgFlag 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T22:45:05.967

您可以定义 DEBUG_NEW 并打开一些泄漏检测，您需要在包含任何系统包含文件之前定义它。它只使用 new 运算符检查泄漏，当然你必须重新编译你的代码，这样你就不能像 valgrind 那样附加它。

在此处查看更多信息：

[http://msdn.microsoft.com/en-us/library/tz7sxz99(VS.80).aspx](http://msdn.microsoft.com/en-us/library/tz7sxz99(VS.80).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T19:25:36.120

我这样做过一次，但它并不那么自动。我现在无法访问该代码，但这是我的想法：

我使用了Mike B 提到的[调试功能（顺便说一句，它们只在调试中工作）。](http://msdn.microsoft.com/en-us/library/wc28wkas(VS.80).aspx)

测试运行器运行所有测试两次，因为在第一次运行期间，内存是为全局分配的。第二次，在每次测试之前和之后检查分配块的总数（我认为您可以在 setUp() 和 tearDown() 中进行）。如果数字不同，则意味着内存泄漏，并且测试失败并显示适当的消息。当然，如果测试本身失败，你应该保留它的错误信息。现在要找到泄漏，我必须使用 pBlockHeader 读取上次分配的块分配编号，然后使用 _CrtSetBreakAlloc 在其上设置断点[并](http://msdn.microsoft.com/en-us/library/4wth1ha5(VS.80).aspx)再次运行。

更多信息在这里： http: [//levsblog.wordpress.com/2008/10/31/unit-testing-memory-leaks/](http://levsblog.wordpress.com/2008/10/31/unit-testing-memory-leaks/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-04T22:45:32.797

我玩弄了 Mike B 指出的 CRT 调试堆函数，但最终我并不满足于仅仅获得泄漏内存的地址。获得像 UMDH 提供的堆栈可以使调试更快。因此，现在在我的 main() 函数中，我在运行测试以获取堆快照之前和之后使用 CreateProcess 启动 UMDH。我还编写了一个简单的批处理文件来运行我的测试工具，然后对堆快照进行比较。因此，我启动批处理文件并一次性获取我的测试结果和一个包含所有未释放分配的完整堆栈的文本文件。

UMDH 发现了很多误报，所以也许一些 CrtDebug 东西的混合体和我现在正在做的事情会是一个更好的解决方案。但就目前而言，我对我所拥有的感到满意。

现在，如果我有办法检测我是否没有关闭任何句柄......

# python - 如何编写恢复 cwd 的装饰器？

> ID：169070
> 
> 赞同：33
> 
> 时间：2008-10-03T22:04:01.430
> 
> 标签：python, decorator, cwd

如何编写一个装饰器，将当前工作目录恢复到调用装饰函数之前的状态？换句话说，如果我在执行 an 的函数上使用装饰器，`os.chdir()`则调用函数后 cwd 将不会更改。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-03T22:19:30.590

已经给出了装饰者的答案；它按要求在函数定义阶段工作。

使用 Python 2.5+，您还可以选择在函数*调用*阶段使用上下文管理器执行此操作：

```
from __future__ import with_statement # needed for 2.5 ≤ Python < 2.6
import contextlib, os

@contextlib.contextmanager
def remember_cwd():
    curdir= os.getcwd()
    try: yield
    finally: os.chdir(curdir) 
```

如果需要，可以在函数调用时使用：

```
print "getcwd before:", os.getcwd()
with remember_cwd():
    walk_around_the_filesystem()
print "getcwd after:", os.getcwd() 
```

这是一个不错的选择。

编辑：我按照codeape的建议添加了错误处理。由于我的答案已被投票通过，因此提供一个完整的答案是公平的，除了所有其他问题。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-12-24T09:38:59.057

path.py模块（如果在 python 脚本中处理路径，你真的应该使用它）有一个上下文管理器[：](https://github.com/jaraco/path.py)

```
subdir = d / 'subdir' #subdir is a path object, in the path.py module
with subdir:
  # here current dir is subdir

#not anymore 
```

（学分来自 Roberto Alsina的[这篇博文）](http://ralsina.me/weblog/posts/BB963.html)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-10-04T11:29:33.803

给定的答案没有考虑到包装函数可能引发异常。在这种情况下，该目录将永远不会被恢复。下面的代码在前面的答案中添加了异常处理。

作为装饰者：

```
def preserve_cwd(function):
    @functools.wraps(function)
    def decorator(*args, **kwargs):
        cwd = os.getcwd()
        try:
            return function(*args, **kwargs)
        finally:
            os.chdir(cwd)
    return decorator 
```

并作为上下文管理器：

```
@contextlib.contextmanager
def remember_cwd():
    curdir = os.getcwd()
    try:
        yield
    finally:
        os.chdir(curdir) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-03T22:06:46.590

```
def preserve_cwd(function):
   def decorator(*args, **kwargs):
      cwd = os.getcwd()
      result = function(*args, **kwargs)
      os.chdir(cwd)
      return result
   return decorator 
```

以下是它的使用方法：

```
@preserve_cwd
def test():
  print 'was:',os.getcwd()
  os.chdir('/')
  print 'now:',os.getcwd()

>>> print os.getcwd()
/Users/dspitzer
>>> test()
was: /Users/dspitzer
now: /
>>> print os.getcwd()
/Users/dspitzer 
```

# user-interface - 设计图形用户界面

> ID：169071
> 
> 赞同：12
> 
> 时间：2008-10-03T22:04:10.603
> 
> 标签：user-interface, desktop

作为一个很少（或没有）艺术倾向的开发人员，您将如何为应用程序设计 GUI？特别是，我正在考虑桌面应用程序，但也欢迎与 Web 应用程序相关的任何内容。我发现很难设计出让我和潜在用户都满意的东西。我可以在网上查找配色方案，但我怎么知道在哪里放置按钮/文本框/等？

更新：为了澄清，我并不是说要使用什么控件等。相反，当我应该使用按钮、组合、文本框等时，是否有任何指南/提示？它们应该有多长，我会将它们放在表格的什么位置？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-03T22:15:01.283

您需要做的第一件事是摆脱开发人员的观点。我们倾向于从表单、控件、按钮、列表、网格等方面进行思考。这往往会将我们推向对用户而言并不总是最佳的解决方案。

用户不想使用我们的软件。（除非你正在编程游戏）他们只是想把事情做好。因此，在设计 UI 和用户交互时，从那里开始是有意义的。写下用户想用你的软件做什么。想想用户将如何做这些事情，以及您的应用程序可以做些什么来使事情变得更容易。

尝试使用与编程不同的工具。这些让你再次思考 UI 小部件。从一支铅笔和一张纸开始画草图，并尝试考虑行为以及布局等。如果您对要构建的内容有清晰的了解，则可以开始考虑自己的状态要去建造它。这就是小部件、按钮和页面出现的时候。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-03T23:54:21.270

我开发的应用程序每小时会被点击数千次，所以一切都归结为效率。我喜欢将其视为一种货币，您可以使用它生成许多有用的公理：

如果它节省了一次点击，+1。

如果它需要点击，-1。

如果用户浪费时间弄清楚它是如何工作的，-1。（大多数自定义 UI 元素）

如果它从根本上直观，+1。（Cover Flow功能）

如果它为初次使用的用户节省了一次点击，+1。（奇才）

如果长期用户需要点击一次，则为-1。（奇才）

（这就是为什么你必须确保你的键盘快捷键和标签顺序是有意义的。）

等等。

等等。

一切都会被主观加权和统计，你不得不妥协。最终，这可能是一种幼稚的哲学，但它对我很有帮助。外推你认为合适的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T22:06:40.210

你读过[http://msdn.microsoft.com/en-us/library/aa511258.aspx](http://msdn.microsoft.com/en-us/library/aa511258.aspx)吗？

或阅读维基百科文章：[http](http://en.wikipedia.org/wiki/Human_interface_guidelines) ://en.wikipedia.org/wiki/Human_interface_guidelines它包含一些 HIG 的链接

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T22:17:08.130

这可能会有所帮助：[best-practices-principles-for-gui-design](https://stackoverflow.com/questions/90813/best-practices-principles-for-gui-design)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T22:45:34.950

除了本页中提到的所有其他内容之外，我还要补充一点**，您越少注意到 GUI，它就越好**。

我的意思是，当用户没有感知到用户界面时，这是因为用户正在完成他/她的工作。当（a）它很漂亮（想想 Apple）或（b）它很糟糕（想想你使用过的任何 GUI 让你感到沮丧）时，用户会注意到 GUI。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T22:07:23.873

如果您正在为桌面设计，您可以找到操作系统界面指南，这会有所帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T22:12:05.860

Joel Spolsky 有一个非常好的高级设计技巧：

[http://www.joelonsoftware.com/uibook/chapters/fog0000000057.html](http://www.joelonsoftware.com/uibook/chapters/fog0000000057.html)

除此之外，最大的事情就是尝试一些东西，制作模型。也许最初是纸上谈兵，但在某些时候只是尝试组合一个 GUI，而不连接后面的代码。看看你的想法，尝试一些改变，询问其他人的意见，然后进行实验。最好的设计技术是从人们那里获得反馈，如果可能的话，最好是从目标受众那里获得反馈。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-03T22:14:49.710

不清楚您是在谈论如何创建良好的对话窗口，还是如何为大型应用程序创建连贯的外观和感觉。

关于如何设计一个有效和清晰的 UI 的一个很好的参考是[程序员的用户界面设计](https://rads.stackoverflow.com/amzn/click/com/1893115941)......等待它...... Joel Spolsky。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-03T22:18:21.997

只需从您的应用程序的角度考虑您的用户是谁。有没有一种？更多的？然后对于每一种用户，想想他们想要完成的重要的总体事情。向他们展示这些一般选择，然后从那里进入每个任务的更合适的界面。

最后，如果您有大量步骤，那么向导非常有用，因为它可以让您一次验证每个步骤。这在本机应用程序上很明显，但在网络上非常方便。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-03T23:29:11.760

我从未将 GUI 设计视为一项根本上的艺术活动。虽然设计良好的用户界面确实可以通过艺术元素得到增强，但设计底层用户界面确实是一项工程工作。当然，在较大的项目中，GUI 专家是一种自然的专业化，就像拥有构建专家等一样。但我认为很少有软件工程师无法创建有效的 GUI——当他们有时间和资源这样做时。

我们中的大多数人通过认识到现有系统中的优点，然后卷起袖子和创新，并坚持它直到它起作用，从而学到了我们所知道的关于构建系统的大部分知识。GUI 也不例外。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-11T08:05:58.377

[UI 模式网站](http://ui-patterns.com/)上提供了一些 UI 模式，您可能会发现它们很有用

一般来说，如果您正在为 Windows 设计表单，请遵循各种微软[指南](http://msdn.microsoft.com/en-us/library/aa511279.aspx)。

我牢记的一个原则是使用现有的行为模式（双击以执行/激活项目等），因为人们已经知道这些。

# visual-studio - 有没有办法通过宏更改工具->选项中的某些内容？

> ID：169080
> 
> 赞同：3
> 
> 时间：2008-10-03T22:06:57.790
> 
> 标签：visual-studio, visual-studio-2008

我希望能够在 Visual Studio 2008 中的“最大并行项目构建数”的两个值之间轻松切换（在工具-> 选项-> 项目和解决方案-> 构建和运行中）。（当我计划进行并发工作时，我想将其从 4 个减少到 3 个。）我不太精通为 IDE 编写宏。当我尝试录制宏并执行所有操作（打开对话框，更改设置，单击确定）时，唯一记录的是：

```
DTE.ExecuteCommand ("Tools.Options") 
```

我的目标是不是遥不可及？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T22:13:27.513

*[根据 MSDN 页面的Determining Names of Property Items in Tools Options Pages](http://msdn.microsoft.com/en-us/library/ms165642.aspx)*这似乎是不可能的

如果可能的话，应该*是*这样的：

```
Dim p = DTE.Properties("ProjectsAndSolutions","BuildAndRun")
p.Item("MaxNumParallelBuilds") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-22T16:48:10.160

这似乎现在在 VS2010 中是可能的。我不是 VB 程序员，但这是我要做的工作：

```
Sub EditConcurrentBuilds()
    Dim p As EnvDTE.Properties = DTE.Properties("Environment", "ProjectsAndSolution")
    Dim item As EnvDTE.Property = p.Item("ConcurrentBuilds")
    Dim text As String = InputBox("Enter number of concurrent builds", "Concurrent Build Option")
    Dim v As Integer = Val(text)

    If (v > 0 And v < 5) Then
        item.Value = text
    End If
End Sub 
```

在这种情况下，4 是我机器上最多的处理器。

# mysql - 从 MS Sql 2005 和 MySql 复制数据的建议

> ID：169086
> 
> 赞同：2
> 
> 时间：2008-10-03T22:10:55.927
> 
> 标签：mysql, sql-server, replication, broadband

我的公司目前有一个在 Sql Server 2005 上运行的事务数据库。我们将添加一个 MySql（在 linux 上运行）报告数据库。我们需要让复制从 MS-Sql 数据库运行到 MySql 数据库。它不必是实时的，但应该在几分钟内。

我有很好的 MSSql 开发技能和一般的 dba 技能，但没有 MySql 背景。我们团队的 MySql 人没有 MSSql 经验。

我想知道是否有人设置了类似的东西并且可能有一些建议。我已经看到了在两者之间迁移数据的一些事情，但对于正在进行的复制来说并不多。现在我最好的猜测是在 SSIS 中设置一些东西并在 Sql Agent 下运行它。我现在要研究 SSIS 的想法，但欢迎任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T21:41:19.617

我的朋友在几乎相同的情况下（他从 MSSQL 的几个表中复制了一些数据到 MySQL）构建了类似的东西：

*   将触发器添加到将被复制的每个表。触发保存主键、操作类型 (i)nsert/(u)pdate/(d)elete 和特殊表中的源表名（更少或更多）。
*   小型 .NET 应用程序每隔几分钟扫描此特殊表以查找新键，并从源 MSSQL 表中读取数据并将它们保存在 MySQL 中的目标表中（更少或更多）。

这很好用，因为：

*   表变化不大。
*   他只复制了几列。

优点：

*   快速且易于实施和更改。

缺点：

*   内部制造的工具并不完美:)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-09T22:04:07.480

我认为这取决于您将在 MySQL 数据库之上使用什么报告软件。如果您使用的是 Pentaho - 他们有软件可以处理这种情况。如果报告只是临时性的并且结构将保持完全相同，我会认真考虑设置另一个 MSSQL 实例并使用它。如果您已经拥有 MSSQL，请不要试图让两者相互友好。您应该能够将第二个 MSSQL 实例绑定到仅有限的资源，这样即使它们在同一台机器上，事务数据库也不会受到影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T00:40:53.657

第三方应用程序声称能够执行此操作：Daffodil Replicator。我认为它可以作为开源和企业使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-27T16:41:56.507

SSIS ETL 似乎是最简单的方法。您实际上可以导出到暂存区（CSV 文件），而不是导入到 MySQL。这将处理不同的格式问题。如果您有创意，MySQL 支持 CSV 存储引擎（[请参阅此处](http://dev.mysql.com/doc/refman/5.0/en/csv-storage-engine.html)），因此这可以节省 SSIS 中的加载步骤。

# architecture - XP/SCRUM 有多大？

> ID：169094
> 
> 赞同：9
> 
> 时间：2008-10-03T22:13:47.090
> 
> 标签：architecture, process, agile, scrum

在规划新系统开发的最初阶段，遵循哪种开发模式似乎至关重要。我一直坚信经典瀑布（或混合瀑布/迭代原型）是大中型项目的最佳方法。似乎一旦项目达到一定规模，敏捷/XP/Scrum 范式就无法解决复杂的需求、大型团队、多个子系统之间的复杂性、文档需求、人员变动等，等等

这种敏捷方法在系统规模、团队规模、LOC 等方面的限制是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-03T22:23:39.363

Scrum 可以使用“Scrum of Scrums”进行扩展。

Scrum 联盟对进行 Scrum of Scrums 会议提出了以下[建议：](http://www.scrumalliance.org/articles/46-advice-on-conducting-the-scrum-of-scrums-meeting)

> Scrum of Scrums 会议是将 Scrum 扩展到大型项目团队的一项重要技术。这些会议允许团队集群讨论他们的工作，特别关注重叠和整合的领域。

《敏捷与迭代开发》一书也[讨论](http://books.google.com/books?id=e4FrAFn0ytIC&pg=PA133&dq=%22scrum+of+scrums%22&ei=L5vmSPX5DYGgsgOp6-nLBg&sig=ACfU3U1uppfnDpTqUws0g7Qlv8u4aAkX2g)了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T22:18:40.513

我认为没有界限，毕竟 Scrum 的所有想法都来自汽车制造，而且就人而言，这是相当大的。大型项目的问题是，您需要从一个小团队开始，并随着时间的推移而发展壮大。保持独立的团队通过 Scrum of Scrums 进行交互，它会扩展，如果人们愿意合作，它就会起作用。就像我们的业务一样：分而治之。将大难题分解成更小的可管理的块。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-05T23:37:00.680

看看伯尼汤普森的[这篇博文。](http://leansoftwareengineering.com/2007/11/12/10-pitfalls-of-agility-on-large-projects/)

它概述了他在微软扩展 Scrum / XP 时遇到的许多问题和权衡，并提供了一些非常周到和有趣的解决方案。

同一个博客上的其他帖子也处理了您关心的这些规模问题 - IMO 它是“成人敏捷”思想的金矿。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T22:21:58.930

在一个团队中，沟通渠道与 (N * N-1) / 2 作为上限成正比，因此可以粗略地视为 O(N^2)。敏捷团队的去中心化性质意味着没有中心参考点，与有这样一个参考点的情况相比，沟通将变得更接近上限。

如果您有书面规范和更正式的结构（有关规范文档的讨论，请参阅[无痛功能](http://www.joelonsoftware.com/articles/fog0000000036.html)规范），通信更接近于中心辐射模型，它具有更接近 O(N) 通道（对于 N 员工该项目）。我看到的大多数经验法则评论都将敏捷团队的最佳位置设置为 6 或更少，上限在 10 左右，尽管您的里程可能会有所不同。

在 PFS 文章中，Joel（是的，*那个*Joel）讨论了[项目经理](http://www.joelonsoftware.com/articles/fog0000000034.html)的角色，他的角色是开发和拥有规范。Painless 功能规范系列对此进行了相当详细的介绍，并且对于非技术管理人员来说也很容易理解——我已经向很多人推荐了这篇文章。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-08T13:00:55.457

扩展 Scrum 或任何敏捷方法取决于您的环境。

如果您有多个团队的多个项目，那么扩展只是在团队之间共享最佳实践。一旦你开始需要系统/项目之间的集成，就要小心了。在这一点上，团队之间更紧密的集成是可取的。

如果您有一个大型项目（我曾经有一个 45 人的团队），则有不同的扩展方法。我们选择让一个团队拥有多个站立会议——开发人员站立会议与 BA/QA 站立会议分开。迭代经理参加了双方，双方至少有一名参加了另一方。我们有一面卡片墙，但它包括迭代前的东西（分析过程中的故事，要追逐的生产错误）和迭代后的东西（发布/部署工作）。

我还参与了一个非常大的项目，该项目有许多 scrum 团队（约 20 个团队 - 有些是分布式的 - 每个团队有 10-20 名成员）。每个人都有单独的站立会议，并且有一个 scrum-of-scrum 甚至一个 scrum-of-scrum-of-scrum。我认为我们按照职能领域而不是工作流程来划分团队是一个错误。我们的细分造成了代码所有权孤岛，团队之间存在繁重的集成管理问题。

总而言之，这不仅仅是关于缩放的大小......它还与项目的内容有关。随意分享有关您的环境的更多细节，以了解解决环境中规模问题的更具体方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T22:23:08.757

将 Scrum/XP 想象成一系列迷你瀑布。最初，您想要做一个前期工作以获得良好的、明确定义的积压工作。不一定是整个系统，我认为一旦你得到一两个冲刺的产品积压项目，就该开始冲刺了。在冲刺的同时，您应该创建额外的 PBI（并适当地重新确定它们的优先级）。

这个想法是，您可以在系统完全定义之前获得业务价值。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-05T22:42:09.980

敏捷规模很好。这不是一门火箭科学。事实上，这都是关于**模块化**的。软件开发是一个 CAS（复杂自适应系统），并且与几乎任何 CAS 一样，它**具有更好地管理复杂性的模块**。Scrum of Scrums 是开发过程扩展的一种可能的模块化方法。功能部门（开发人员、QA 等）是另一种模块化方法。最坏的情况是在大型项目中根本没有模块。

根据项目性质，团队可以决定哪些模块适用于项目。一般的模式是组成几个团队，在一些**低内聚模块**上工作。每个团队都应该是相当自主的，但与其他团队的互动应该很好。

CAS 的类比是人体。我们有心脏和肝脏等器官。它们是独立的模块（细胞团队：），通过神经系统/血液/等相互作用。

# sql-server - 是否有替代 RedGate 的“穷人”替代方案来编写整个数据库模式的脚本？

> ID：169107
> 
> 赞同：19
> 
> 时间：2008-10-03T22:18:19.127
> 
> 标签：sql-server, sql-server-2000, sqltools

我处于一种情况，我想为一个数据库生成一个脚本，我可以在另一台服务器上运行并获得一个与原始数据库相同的数据库，但没有任何数据。本质上，我想最终得到一个捕获数据库模式的大型创建脚本。

我在安装了 SQL Server 2000 的环境中工作，并且无法安装 2005 客户端工具（如果它们有帮助的话）。我买不起 RedGate，但我真的很想在另一台服务器上拥有一个具有相同架构的数据库。

有什么建议么？任何简单的 .exe（无需安装）工具、提示或 T-SQL 技巧将不胜感激。

**更新：**我正在使用的数据库有 200 多个表和几个外键关系和约束，因此手动编写每个表的脚本并将脚本粘贴在一起不是一个可行的选择。我正在寻找比这个手动解决方案更好的东西

**附加更新**除非我完全遗漏了什么，否则这不是使用 SQL 2000 工具的可行解决方案。当我选择在数据库上生成创建脚本的选项时。我最终得到一个包含 CREATE DATABASE 命令的脚本，并且没有创建任何对象 - 表、约束等。SQL 2005 的管理工作室也可以处理这些对象，但是数据库处于没有我将安装的 Management Studio 连接到它的方式。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-03T22:24:56.147

运行 SQL Server Management Studio，右键单击数据库并选择`Script Database as > Create to > file`

这适用于 SQL Server 2005。SQL Server 2000 企业管理器具有类似的命令。只需右键单击数据库`> All Tasks > Generate Scripts`。

编辑：在 SQL Server 2005 中，您可以在对象资源管理器窗格中选择“数据库”，并在详细信息窗格中选择多个数据库。然后，右键单击您的选择和“脚本数据库为 > 创建到 > 文件”。这将导致它将它们全部放入一个脚本中，它将包括所有表、键、存储过程和约束。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-07T19:33:45.180

因此，我假设您无法安装 SQL Server Management Studio。甚至没有免费版本。如果这是一次性的事情，我会安装红门工具。试用版可使用 14 天。做你的工作，然后卸载。您还可以查看[http://www.xsqlsoftware.com/](http://www.xsqlsoftware.com/)，它们具有与 Red Gate 类似的功能。如果您的数据库很小，那么他们可以为您提供免费选项。我也喜欢[http://www.apexsql.com/](http://www.apexsql.com/)。试用其中一种，然后再次尝试说服您的老板购买。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-09T15:33:34.633

除了上述答案之外，我想建议（至少对于未来的项目）您没有掌握数据库本身的数据库设计。

实现此目的的一种方法是从第一天开始将您的数据库表、过程等简单地维护为“CREATE”脚本，并设计一个主脚本，将所有单独的脚本拉到一起以部署到您选择的数据库。

一个更复杂的解决方案是使用 Visual Studio Database Edition 之类的东西（可能太贵了，如果您的评论是可以接受的），它允许您将每个数据库对象视为项目中的一个节点，同时仍然允许整个事情是只需单击几下即可部署。

这两个选项的解释过于简单，因为还有很多其他问题——版本控制、数据迁移等——但主要原则是相同的。

一旦你提取了你的脚本——使用其他答案之一——你可能想要考虑使用这个脚本作为你的“主人”的基础。

只需将“设计”保留在数据库之外 - 这纯粹是为了“实现”。

试着把这个过程想象成开发代码的过程——源代码和二进制文件是分开的，后者是从前者生成的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-07T20:33:41.830

我之前已经成功使用[过 CodeProject 中的这个程序](http://www.codeproject.com/KB/database/ScriptDatabase.aspx)很多次。它不仅可以编写模式脚本，还可以（可选地）编写所有重新创建数据库所需的 INSERT 语句。

我过去曾将它用于 SQL Server 2000。显然，如果您的表中有一百万行，那么编写内容脚本可能不是一个好主意，但它实际上是一个非常巧妙的工具，可以制作一系列 SQL 脚本来复制数据库。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-09T20:48:39.507

如果它是一次性操作并且您不想自己订购对象脚本，只需[下载 RedGate SQL Compare 的免费试用版](https://www.red-gate.com/dynamic/downloads/downloadform.aspx?download=sqldatacompare)。

这是 14 天的完整工作版本，因此它将为您完成整个工作 - 这是完全合法的解决方案。您将拥有所有脚本以供将来与手动脚本一起使用。无论如何，我很确定，如果您发现该工具有多方便，您将在以后的某个阶段购买它，而这可能是他们通过提供完全可用的试用版所希望的。在我的情况下，它以某种方式起作用。

请注意，一旦试用期结束，它会影响所有工具，因此请确保充分利用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-06T18:27:55.873

Michael Lang，当您右键单击数据库并选择创建脚本时，您需要单击几个选项框才能生成所有内容。2005在这方面要容易得多，但是2000可以做到这一点，你只需要选择合适的选项。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T18:35:52.613

如果您正在寻找命令行版本，[Sql Server Hosting Toolkit](http://www.codeplex.com/sqlhost/Wiki/View.aspx?title=DPW%20Command%20Line%20Interface)过去曾为我工作过。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-07T20:40:44.313

Microsoft 数据库发布向导（在 Visual Studio 2008 中）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-09T17:40:03.910

**正如您在SQL Server 2000**中提到的，要使用的命令是：

在**企业管理器**中选择要从中编写对象脚本的数据库，然后右键单击并选择**所有任务 -> 生成 SQL 脚本...**

在**选项**窗格中，可以方便地选择选项**为每个对象创建一个文件**，这样您就可以将每个对象分别存储在源代码管理中。

因此，每当您对 tableA 进行一些更新时，您都可以在源代码管理中将其签出，以让其他人知道您正在处理它，并且在完成后您可以编写该单个对象的脚本并保存签入。

要编写单个对象的脚本，您可以使用相同的选项 **All Tasks -> Generate SQL Scripts...**，然后只选择那个对象。

这种方法的唯一问题是，当您想要恢复完整的数据库时，您需要处理依赖对象，因为顶级对象必须在依赖于它们的对象之前恢复。

具有讽刺意味的是，当您将整个数据库编写到一个文件中时，对象不是根据依赖关系排序的，而是根据创建日期排序的。当您尝试使用它来恢复完整的数据库时，这会导致错误。

我们最终创建了批处理文件，该文件将分别创建每个对象，调用“osql”

那时一切都很好

现在我们使用[SQLCompare Pro](http://www.red-gate.com/products/SQL_Compare/index.htm)，它可以让我们免于麻烦，但如果你不经常发布，你可以不用它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-03T22:39:01.393

其他的都是正确的，但是为了从头开始创建一个完整的数据库，您需要在运行创建表和过程脚本之前在 SQL 中创建一个“设备”...

使用 ADODB，因为几乎每个（如果不是每个）Windows 框都安装了它来执行脚本。

见鬼，你甚至可以编写一个执行来构建整个数据库的 vbScript。您拥有的任何域表，您需要记住在将项目添加到数据库之前打开身份插入。

如果您需要，我愿意共享源代码。几年前我不得不写同样的东西，最后写了 3 个脚本，一个创建设备，然后是表格，然后是过程/触发器和域数据。我编写了代码来解析默认脚本并允许用户命名他自己的数据库和登录名等。您可能不必走那么远。

希望这有帮助。

# c# - 如何根据值的类型和名称创建枚举对象？

> ID：169116
> 
> 赞同：4
> 
> 时间：2008-10-03T22:20:04.223
> 
> 标签：c#, enums

我有一个枚举类型（System.Type）和一个包含要设置的枚举值的字符串。

例如给定：

```
enum MyEnum { A, B, C }; 
```

我有 typeof(MyEnum) 和“B”。

如何创建设置为 MyEnum.B 的 MyEnum 对象？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-03T22:21:17.043

```
MyEnum enumValue = (MyEnum)Enum.Parse(typeof(MyEnum), "B"); 
```

您还有一个不区分大小写的重载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T22:42:11.887

我假设您无权访问 MyEnum，只能访问 typeof(MyEnum)：

```
void foo(Type t)
{
   Object o = Enum.Parse(t, "B");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T22:16:11.430

您可以使用泛型来做到这一点。我创建了一个实用程序类来包装它：

```
public static class Utils {
    public static T ParseEnum<T>(string value) {
        return (T)Enum.Parse(typeof(T), value, true);
    } 
```

然后像这样调用：

```
string s = "B";
MyEnum enumValue = Utils.ParseEnum<MyEnum>(s); 
```

# c - 在 ansi c 中将套接字绑定到端口 80

> ID：169121
> 
> 赞同：8
> 
> 时间：2008-10-03T22:21:29.947
> 
> 标签：c, networking, sockets, webserver

当我尝试将端口 80 绑定到 c 中的套接字时，我总是收到错误消息，即我无权使用此端口。有没有简单的方法来获得这个许可？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-03T22:25:43.883

通常只有超级用户 (root) 可以绑定到“特权”端口（即低于 1024 的端口号）。

这意味着您要么必须以 root 身份运行程序，要么将可执行文件设为“suid root”。

这两者都有安全后果，因此您可能需要考虑使用 suid 方法并在进行绑定调用后放弃超级用户权限。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-03T22:28:36.327

您会发现[本教程](http://beej.us/guide/bgnet/)对使用 C/C++ 进行网络编程非常有帮助。

顺便说一句，*ANSI C*无法访问网络。提供此功能的是操作系统提供的库（BSD 套接字 API，也移植到 Windows `winsock`）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T22:38:01.003

端口 1024 及以下称为*特权端口*，绑定到这些端口需要提升权限。

1024 以上的端口称为*临时端口*。绑定到这些不需要特殊权限。

访问特权端口的最简单方法是成为 root 用户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T22:27:21.883

如果您在共享系统（如大学计算机）上而不是 root，那么设计上就没有“简单”的方法来获得该权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T22:30:03.720

就像@Charles Bailey 所说的那样......我想补充一点，这就是为什么人们过去常常通过 URL 中的端口规范查看 8080 上的 http 服务器地址为[http://some.url](http://some.url) **:8080** /

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T22:34:38.233

传统上只有 root 可以将套接字绑定到 1024 以下的端口。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-04T20:38:45.067

S.Lott 的回复可能引发了非常负面的反应，但他的想法远非愚蠢：如果最初的问题是针对一个真实的程序（不是学校作业），那么将其开发为 HTTP 服务器后面的应用程序通常是一个合理的选择。这样，您可以将许多低级细节留给一个良好且调试良好的程序 Apache。

应用程序不必是 CGI，它可以是 Apache 模块。从版本 2 开始，Apache 不再只是一个 HTTP 服务器。它现在是一个开发网络程序的平台。编写 Apache 模块可能是原始问题的正确答案（请参阅[Apache 文档](http://httpd.apache.org/docs/2.2/developer/)）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T12:11:03.670

普通程序无法绑定“特权”端口 - 低于 1024 的端口。这是类 UNIX 操作系统的大部分已过时的安全功能。

以超级用户身份运行，虽然这里有许多其他人建议，但对这个问题来说是一个糟糕的解决方案。如果您在 Debian 或 Ubuntu 系统上运行，我建议安装[authbind](http://packages.debian.org/stable/authbind)软件包，它允许您授予您的程序打开特权端口的权限，而无需实际授予您的程序任何其他特殊权限。

如果您在任何其他系统上运行，我建议安装 debian 或 ubuntu ;-)。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2008-10-03T23:22:28.123

是的，您可以轻松绑定到端口 80。使用 Apache。编写一个网络应用程序。Apache 绑定到端口 80 并运行您的 Web 应用程序。

您是否正在尝试编写下一个 Apache？如果是这样，您需要了解操作系统中 的[setuid API 调用。](http://www.manpagez.com/man/2/setuid/)

如果您不编写新版本的 Apache，大多数人使用非特权端口。8000很受欢迎，8080也很受欢迎。

# wsdl - 考虑 Web 服务？

> ID：169127
> 
> 赞同：1
> 
> 时间：2008-10-03T22:22:40.240
> 
> 标签：wsdl

Web 服务分解的一些指导方针是什么？在一个极端情况下，每个操作都有不同的过程，并通过 WSDL 公开所有类型。这似乎导致 WS 接口的变化与业务逻辑一样频繁。另一方面，在 WS 接口的下一层执行类型和验证的通用接口。第二个选项似乎提供了更多的接口稳定性，以及其他可能性，例如服务链。我在多个项目中在两者之间来回切换，并希望得到一些关于其他人如何处理这个问题的反馈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T22:28:51.163

我认为这里没有明确的答案。你的业务流程是怎样的？什么会以最好的方式表达您的域的语义？

此外，您需要考虑健谈与厚实界面的问题。你在局域网上运行吗？通过互联网？

# language-agnostic - 显示表情符号的正确方法是什么？

> ID：169130
> 
> 赞同：4
> 
> 时间：2008-10-03T22:23:17.447
> 
> 标签：language-agnostic, fonts, emoticons

在您自己的应用程序中。

[编辑]

**好吧，所以我完全同意 - 比你知道的更多 - 毫不含糊地认为图形表情符号是可憎的。但！当项目所有者告诉我我们必须支持图形表情符号时，这对我没有帮助。**

[/编辑]

这个问题比最初看起来更复杂，尤其是当您考虑到编辑、自动换行、可变宽度字体和颜色表情符号时。

**所以我的问题真的是针对那些做过这件事的人，你有没有想出一种令人满意的方式来渲染表情符号，而不仅仅是一个大规模的黑客攻击？**

开始讨论：

在两个实现中，我尝试了以下方法。

在 3D 应用程序中，文本行呈现为“纹理”；我用图像替换了表情符号字符串，匹配文本呈现的类型，因此表情符号成为文本的另一个元素。

本质上，文本渲染引擎必须在最深层次上进行修改。这会产生很好的结果，但是非常耗时，而且很难做到正确（或者至少对我来说；P）

在第二种方法中（使用不同的语言和平台），我决定尝试更高级别的“假”，用单个字符替换表情符号字符串并在替换的字符上绘制情感。这当然有很多限制，但具有实施起来相当快的好处，并且可以在不付出过多努力的情况下达到相当稳定的状态。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-03T23:09:33.687

1.  创建一个新字体。 *这留给读者作为练习*
2.  将您的字符串转码为新字体的字符集。
3.  画：

*   重复调用运行环境函数来计算文本度量 - 以定位您的表情符号的位置。*   在文本之前绘制表情符号（如果您使用字体来增强任何背景图像 - 比如说一张脸，字体字形在脸上绘制黑色）或文本之后（在这种情况下，每个表情符号的字形是没有实际意义，只有字形的大小很重要）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T22:25:30.703

建议您考虑不转换表情符号是否可以接受？文本表情符号的全部意义在于它们是可识别的……以文本形式。

*[编辑]*请不要让这种意见/建议阻止任何人帮助回答这个问题。有时您无法与客户抗争，尽管可能值得多尝试几次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T22:57:25.177

这里有一个想法：不要以任何方式转换它们，而是旋转 90 度。

例如，您可以渲染表情符号的图像，然后将该图像顺时针旋转 90 度并显示它。

# php - 意外的 T_CONCAT_EQUAL

> ID：169146
> 
> 赞同：3
> 
> 时间：2008-10-03T22:28:31.587
> 
> 标签：php, string, concatenation

我在以下形式的一行中收到意外的 T_CONCAT_EQUAL 错误：

```
$arg1 .= "arg2".$arg3."arg4"; 
```

我正在使用 PHP5。我可以简单地执行以下操作：

```
$arg1 = $arg1."arg2".$arg3."arg4"; 
```

但我想首先知道出了什么问题。有任何想法吗？

谢谢，斯威尼

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-03T22:34:19.810

当 $arg1 未定义时会发生这种情况（没有值，从未设置。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T22:44:54.000

所以最准确的原因是上面发布的代码行：

```
$arg1 .= "arg2".$arg3."arg4"; 
```

在我的来源中实际上如下：

```
arg1 .= "arg2".$arg3."arg4"; 
```

arg1 中缺少 $。我不知道为什么口译员没有先抓住它，但无论如何。感谢 Jeremy 和 Bailey 的输入 - 它让我找到了问题所在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T22:34:56.893

听起来你在上面的那一行忘记了一个分号。

# garbage-collection - 设置服务器或工作站 GC

> ID：169150
> 
> 赞同：4
> 
> 时间：2008-10-03T22:30:25.997
> 
> 标签：garbage-collection, clr

如何配置应用程序，甚至整台机器，以使用 CLR 垃圾收集的服务器或工作站风格？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T22:32:16.757

看看[这里](http://blogs.msdn.com/maoni/archive/2004/09/25/234273.aspx)。

我建议好好阅读整个系列的博客文章——内容丰富。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T21:59:26.737

我应该提到，我发现有两种方法可以处理这个问题，或者使用 .config 文件（应用程序或机器）对整个应用程序使用 gcConcurrent 和 gcServer 元素，或者可以在代码块级别使用`GCSettings.LatencyMode`.

# windows - SetCursor 在鼠标移动后恢复

> ID：169155
> 
> 赞同：8
> 
> 时间：2008-10-03T22:32:55.757
> 
> 标签：windows, user-interface

我正在使用 SetCursor 将系统光标设置为我自己的图像。代码看起来像这样：

```
// member on some class
HCURSOR _cursor;

// at init time
_cursor = LoadCursorFromFile("somefilename.cur");

// in some function
SetCursor(_cursor); 
```

当我这样做时，光标确实发生了变化，但在第一条鼠标移动消息上，它变回了默认的系统箭头光标。这是项目中唯一设置光标的代码。我需要做什么才能使光标保持我设置的方式？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-03T23:18:06.853

看来我有两个选择。第一个是Mark Ransom这里建议的，就是响应windows`WM_SETCURSOR`消息，根据鼠标所在的位置在那个时候调用SetCursor。通常，只有当光标在您的窗口上时，windows 才会发送给您`WM_SETCURSOR`，因此您只需将光标设置在您的窗口中。

另一个选项是在我调用的同时为窗口句柄设置默认光标`SetCursor`。这会将默认处理程序设置的光标更改为`WM_SETCURSOR`. 该代码看起来像这样：

```
// defined somewhere
HWND windowHandle;
HCURSOR cursor;

SetCursor(cursor);
SetClassLong(windowHandle, GCL_HCURSOR, (DWORD)cursor); 
```

如果您使用第二种方法，则必须同时调用两者`SetCursor`，`SetClassLong`否则您的光标将在下一次鼠标移动之前不会更新。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T22:42:33.367

您需要响应 Windows 消息[WM_SETCURSOR](http://msdn.microsoft.com/en-us/library/ms648382(VS.85).aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T22:44:23.627

您需要使您的 HCURSOR 句柄不超出范围。当鼠标移动时，windows 消息开始到处乱飞，它会消灭你的手柄（在上面的例子中）。

将 HCURSOR 设为类的私有成员，并在调用 LoadCursor...() 和 SetCursor() 时使用该句柄。完成后，不要忘记释放它并清理它，否则最终会导致资源泄漏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-20T05:03:27.537

这种行为就是这样设计的。我认为最简单的解决方案是：在创建窗口类（`RegisterClass || RegisterClassEx`）时，将`WNDCLASS.hCursor || WNDCLASSEX.hCursor`成员设置为`NULL`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-17T22:11:24.197

正如@Heinz Traub 所说，问题出在`RegisterClass`or`RegisterClassEx`调用上定义的光标。您可能有如下代码：

```
BOOL CMyWnd::RegisterWindowClass()
{
    WNDCLASS wndcls;
    // HINSTANCE hInst = AfxGetInstanceHandle();
    HINSTANCE hInst = AfxGetResourceHandle();

    if (!(::GetClassInfo(hInst, _T("MyCtrl"), &wndcls)))
    {
        // otherwise we need to register a new class
        wndcls.style            = CS_DBLCLKS | CS_HREDRAW | CS_VREDRAW;
        wndcls.lpfnWndProc      = ::DefWindowProc;
        wndcls.cbClsExtra       = wndcls.cbWndExtra = 0;
        wndcls.hInstance        = hInst;
        wndcls.hIcon            = NULL;
        wndcls.hCursor          = AfxGetApp()->LoadStandardCursor(IDC_ARROW);
        wndcls.hbrBackground    = (HBRUSH) (COLOR_3DFACE + 1);
        wndcls.lpszMenuName     = NULL;
        wndcls.lpszClassName    = _T("MyCtrl");

        if (!AfxRegisterClass(&wndcls))
        {
            AfxThrowResourceException();
            return FALSE;
        }
    }

    return TRUE;
} 
```

其中表示抛出消息`wndcls.hCursor`时将使用什么光标；`WM_SETCURSOR`每次发生鼠标移动时都会发生这种情况，而不仅仅是。

我以这种方式解决了类似的问题：

在类的消息映射中为`WM_SETCURSOR`消息添加一个条目：

```
BEGIN_MESSAGE_MAP(CMyWnd, CWnd)
    //... other messages
    ON_WM_SETCURSOR()
END_MESSAGE_MAP() 
```

添加方法`OnSetCursor`，它将覆盖父类的实现：

```
BOOL CMyWnd::OnSetCursor(CWnd* pWnd, UINT nHitTest, UINT message)
{
    if (SomeCondition())
        return FALSE;

    return __super::OnSetCursor(pWnd, nHitTest, message);
} 
```

说明：当`SomeCondition()`为真时，您将不会调用父级的实现。可能您希望始终拥有不被父类行为取代的游标，因此您只需要一个更短的方法：

```
BOOL CMyWnd::OnSetCursor(CWnd* pWnd, UINT nHitTest, UINT message)
{
    return FALSE;
} 
```

并且头文件中方法的声明是：

```
afx_msg BOOL OnSetCursor(CWnd* pWnd, UINT nHitTest, UINT message); 
```

# visual-studio - 如何在 Visual Studio emacs 模式下禁用绑定到 Tab 键的“智能插入”功能？

> ID：169157
> 
> 赞同：3
> 
> 时间：2008-10-03T22:33:08.127
> 
> 标签：visual-studio, emacs

在 Visual Studio emacs 模式和默认模式下，tab 键都绑定到 Edit.InsertTab。但是，在 emacs 模式下，选项卡按钮会跳转到它期望下一行开始的位置，而不是插入选项卡。

有没有办法在保留 emacs 键绑定的同时禁用此“智能插入”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T08:36:10.777

伙计，我为你找到了它:))) 在自定义键盘快捷键时，它是 Edit.IncreaseLineIndent。

设置自己的钥匙并快乐。（顺便说一句，我无法明确设置 Tab 键。即使更改 CurrentSettings.vssettings 也无济于事。但这是不同的故事......）

# javascript - 我应该从 MooTools 转换为 jQuery 吗？

> ID：169164
> 
> 赞同：18
> 
> 时间：2008-10-03T22:35:39.653
> 
> 标签：javascript, jquery, mootools

我有一个相当大的代码库，它依赖于 MooTools v1.11，并且即将转换为 1.2 版。由于这是一个相当大的改革，我玩弄了转换为 jQuery 的想法。

任何人都对是否更新到 jQuery 或只是坚持使用 MooTools 有建议？

我主要将 MooTools 用于 Ajax、拖放和一些小效果。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-03T22:39:42.373

如果没坏。不要修复它。

jQuery 可能有 X 或 Y，但如果一切都依赖于 MooTools，那么从 MooTools 转换你可能需要做很多工作。

如果您在整个网站中广泛使用 MooTools，请保留它。但是，如果您只有 2 到 3 页的影响较小的页面……更改可能是值得的。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-04T03:49:33.997

如果您*无论如何*都在升级，那么它可能值得研究。

jQuery 似乎正在成为 One True J​​avascript 库（鉴于 MS 和其他人已经决定接受它），所以如果这是您打算使用一段时间的代码，那么切换可能是个好主意在某些时候（如果只是因为会有更多的地方获得帮助和插件代码，因为它很可能会继续流行一段时间，这将有助于确保代码的长期灵活性和可维护性）。因此，鉴于您无论如何都必须转换它，现在可能是最好的时机。

我认为 jQuery 成为使用*的*框架是一件好事。这不是我的选择（我也喜欢 MooTools），但它肯定是一段优秀的代码，并且至少与它的竞争对手的竞争力完全吻合。我很高兴看到任何形式的一致性，我将在某个时候将我的代码移至 jQuery。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-04T15:13:50.883

为什么要做开关？我已经将代码库从 1.11 转换为 1.2，而且它非常快速和简单（而且我将它用于多个效果）。

jQuery 可能会被 MS 采用，根据一个站点的说法，它在 IE 中表现更好——但这与它在 IE 中的表现无关，而是关于它在您的站点上的运行情况（IE 是您站点上的主要参与者吗？）。

你知道 jQuery 吗？如果你不这样做，那么你必须从头开始重写代码，你将完全重写你的代码。

或者你只是想找到理由告诉你的经理“我们应该在 jQuery 中做这件事”，因为你想学习它？

至于“唯一真正的框架”——这是一个荒谬的说法，只有用户才能做出，而不是开发人员。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-17T11:06:37.900

从 MooTools 1.1.1 切换到 1.2.1 并不是什么大问题。[http://github.com/mootools/mootools-core/wikis/conversion-from-1-11-to-1-2](http://github.com/mootools/mootools-core/wikis/conversion-from-1-11-to-1-2)

甚至还有一个兼容层使 MooTools 1.1.1 代码在 1.2.x 中起作用。您可能需要在这里和那里手动修复一些事情，但这相对较小。

切换到 jQuery、YUI 或 DOJO 或其他任何东西都需要完全抛弃所有代码并重新声明。我的任何客户都不会允许这种浪费。

此外，如果您习惯于使用适当的 MooTools 类进行编码，那么 jQuery 可能会给您的系统带来巨大的冲击。并不是说 jQuery 强迫你编写不可读和不可维护的代码，当然可以用任何语言编写非常可读和可维护的代码。但是 jQuery 没有内置的 Class 系统来帮助你。

特别是对于大型代码库，保持代码井井有条非常重要。

我当然很偏颇。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-19T00:49:30.490

有一个关于它的网站描述了哲学[jqueryvsmootools.com的差异](http://jqueryvsmootools.com/)

我认为这就是它归根结底的原因。以功能性 DOM 为中心的方法或面向对象的 JavaScript 方法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-08-26T02:28:13.073

正如其他人所指出的，jQuery 是一个库（主要用于玩弄 DOM），Mootools (1.2) 是一个成熟的 javascript 框架，它允许您以面向对象的方式组织代码，从而使其易于维护。

我建议您阅读本文以真正了解每一个的真正含义（jqueryvsmootools.com）

还有这个其他链接，所以你知道如何从两个世界中获得最好的;）：

[http://ryanflorence.com/object-oriented-jquery-with-mootools-pigs-take-flight/](http://ryanflorence.com/object-oriented-jquery-with-mootools-pigs-take-flight/)

最后归结为*你*需要什么。我的一般建议：如果你需要一些快速的片段并幻想你的 web 应用程序，单独使用 jQuery 是好的；如果您打算以 javascript 为中心进行开发，那么您真的应该尝试 mootools：代码*会*扩展，您最好做好准备。

要从 Mootools 1.1 升级您的代码，您可以使用升级助手，它将帮助您通过 javascript 控制台识别冲突代码 (mootools.net/blog/2009/12/31/mootools-1-1-upgrade-layer-贝塔/)

[抱歉只发布了一个活动链接，这是我的第一个答案]

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-03T22:48:54.773

这取决于您对 jQuery 的了解程度以及您的截止日期。如果你很了解它，它确实需要更少的代码行，这意味着你的客户的带宽更少。

此外，如果您查看[此站点](http://blog.creonfx.com/javascript/dojo-vs-jquery-vs-mootools-vs-prototype-performance-comparison)，您会发现在领先的浏览器 IE 中，jQuery 比 Mootools 具有更好的性能。

话虽如此，如果在 Mootools v1.11 中一切正常，你为什么要更新脚本呢？就像之前的海报说的那样，如果它没有被打破......

如果它在 Mootools v1.11 中不能正常工作，你怎么知道它会在 Mootools v1.2 甚至 jQuery 中工作？投入大量的开发时间并且要么有一些相同的错误，要么因为您使用的框架而引入新的错误，这将是一种耻辱。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-30T07:22:13.873

在这一点上，Slickspeed 变得完全不重要了，无论如何选择器都太快了。另外，您也知道，Mootools 开发团队的成员 Herald Kirschner 的 Sly 刚刚发布了 Sly，这是一个击败 Sizzle 的选择器引擎。关于动画的东西是不选择由其中一张海报留下的 mootools 的决定性因素基本上是倒退，Mootools 多年来一直是动画之王。无论您选择什么，它都会起作用。Mootools 有一种更经典的感觉，我认为这让我有条不紊，jQuery 更多地基于函数，并没有那么冒险进入类。一个增加本机类型，另一个不增加，这是一种不同的策略，仅此而已。

*   丹尼尔

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-07-22T11:02:22.403

我对 Mootools 很满意。我曾多次尝试尝试 jQuery，因为这些天越来越多的人在使用它，但不知何故，我仍然没有像 Mootools 那样获得好的 OO 功能。我不太喜欢 jQuery 的另一件事是通过添加 hashkey(#) 来使用美元函数获取 id。如果您想使用框架创建 html id，这可能会出现问题。如果我是你，只需升级到最新版本的 Mootools。Mootools 根本不是一个糟糕的库。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-02-27T17:07:42.007

在您的问题中，您提到您将 MooTools 用于“Ajax、拖放和一些次要效果”。虽然 Mootools 可以很好地做到这一点，但（我可能会因为这样说而受到抨击）在我看来，你并没有真正出于正确的原因使用 Mootools。我们在应用程序中使用 Mootools，实际上我们不能考虑用 JQuery 来代替它。如果目标是编写您组织中的其他应用程序可以利用的面向对象的、长期可维护的代码，那么 Mootools 就胜出。

仅选择器速度是一个错误的判断标准（尽管我相信 Mootools 现在就在那里）。我们代码中的大多数地方已经引用了我们想要更改的元素。一旦你拥有了元素，大部分时间都花在实际操作 DOM 上，并且在我们的内部测试（将尝试发布它们）中，在我们执行的通常类型的操作中，Mootools 比 JQuery 快得多。我们的应用程序是我们依赖先前构建的 Mootools 控件（由我们或其他人构建）来使用来自 Web 服务的数据创建应用程序屏幕的那种。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-04T03:24:34.700

评估您是否有程序员的时间来进行大修。
这样做意味着您将从头开始重写代码。这再次意味着您将不得不经历功能、审查和测试、修复错误等循环。也就是说，对 JavaScript 不太熟练的程序员所造成的最重要问题之一是大多数代码访问 DOM 元素往往会造成内存泄漏（这是大多数 Web 开发人员经常遇到的情况）。jQuery 本质上为减轻这种情况做了很多工作。或者更确切地说，jQuery 从 JavaScript 中移除了 JavaScript。
第二。迁移到 jquery 的更令人信服的原因之一是您的 JavaScript 代码量将显着减少。这对于客户端代码密集型页面是有意义的。jquery 的简洁性也可以让您轻松地查看代码。
我工作的公司 (support.com) 拥有大量的 Mootools 代码。在 2008 年初（经过几个小时的激烈辩论——我反对迁移到 jQuery），我们开始分阶段迁移到 jQuery。直到今天我都没有后悔过。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-10-15T22:24:04.900

这个论点很无聊，Mootools 是 OO，所以形成适当的 OO 背景的人比 PHP4 或 HTML 背景的人更欣赏它的智能。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-03T22:43:03.490

我可以为这种迁移给出的唯一令人信服的理由是，如果进行切换会减少您必须维护的代码量，和/或使事情变得更简单。这种转换通常涉及大量工作，因此您希望能够在所有工作完成后返回并说“是的，这是值得的”。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-17T01:05:09.300

您应该根据应用程序的目的做出此选择。

jQuery 对于动画来说非常酷，但是我觉得 Mootools 更复杂，所以如果重要的是应用程序而不是动画坚持 Mootools

速度也是这方面的一个主题。到今天为止，Mootools 的性能稍微慢一些，但我宁愿在 Mootools 1.3 发布之前不关注它。

[在http://slicktest.perrohunter.com](http://slicktest.perrohunter.com)查看最新框架的性能

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-04T15:19:13.743

JQuery 是一个较小的代码库，具有更广泛的支持。如果它满足您的需求，它可能是一个很好的开关。我想说的是，您需要权衡的是迁移工作和学习曲线是否值得付出努力，而不是更广泛的功能集、更小的代码大小和流行度以及对 JQuery 的支持。

如果 MooTools 版本之间的变化真的那么大，那么迁移可能是合理的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-09-09T15:02:58.323

jqueryvsmootools网站上提到的文章说得很好：

> 如果 jQuery 让 DOM 成为你的游乐场，那么 MooTools 旨在让 JavaScript 成为你的游乐场

所以，再加上这里的答案“如果它没有坏，就不要修复它”，我想说的是解决你的需求而不是公众舆论。

鉴于您的网站已经在 Mootools 中，您需要评估 jQuery 是否提供了 MooTools 不提供的任何您需要的东西；以及转换的麻烦是否小于编写扩展的麻烦。

看起来 jQuery 有能力让你快速使用 DOM，但所有额外的花哨的东西和其他工作领域（如日期）都需要一个插件。

这也帮助我回答了我自己的问题！

There are some areas where they don't overlap, which is a pity. GUIs are easy to put together in jQuery, with lovely widgets and animations. MooTools, I find, either have sets with too few features, or are too heavy for general web use.

# .net - 在.NET中保持活动套接字检查的最佳方法是什么？

> ID：169170
> 
> 赞同：12
> 
> 时间：2008-10-03T22:37:26.403
> 
> 标签：.net, sockets

我正在寻找一种在.NET 中进行保持活动检查的方法。该方案适用于 UDP 和 TCP。

目前在 TCP 中，我所做的是一侧连接，当没有数据要发送时，它每 X 秒发送一次保持活动状态。

我希望对方检查数据，如果在 X 秒内未收到，则引发事件左右。

我尝试做的一种方法是进行阻塞接收并将套接字的 RecieveTimeout 设置为 X 秒。但问题是每当超时发生时，套接字的 Receive 会抛出一个 SocketException 并且这一侧的套接字会关闭，这是正确的行为吗？为什么套接字在超时后关闭/死亡而不是继续？

检查是否有数据和睡眠是不可接受的（因为我可能在睡眠时接收数据滞后）。

那么解决这个问题的最佳方法是什么，为什么我在另一边描述的方法失败了？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-05T01:52:12.827

如果您的字面意思是“KeepAlive”，请尝试以下操作。

```
 public static void SetTcpKeepAlive(Socket socket, uint keepaliveTime, uint keepaliveInterval)
    {
        /* the native structure
        struct tcp_keepalive {
        ULONG onoff;
        ULONG keepalivetime;
        ULONG keepaliveinterval;
        };
        */

        // marshal the equivalent of the native structure into a byte array
        uint dummy = 0;
        byte[] inOptionValues = new byte[Marshal.SizeOf(dummy) * 3];
        BitConverter.GetBytes((uint)(keepaliveTime)).CopyTo(inOptionValues, 0);
        BitConverter.GetBytes((uint)keepaliveTime).CopyTo(inOptionValues, Marshal.SizeOf(dummy));
        BitConverter.GetBytes((uint)keepaliveInterval).CopyTo(inOptionValues, Marshal.SizeOf(dummy) * 2);

        // write SIO_VALS to Socket IOControl
        socket.IOControl(IOControlCode.KeepAliveValues, inOptionValues, null);
    } 
```

注意时间单位是毫秒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T12:59:14.807

According to MSDN, a SocketException thrown when ReceiveTimeout is exceeded in Receive call **will not** close the socket. There is something else going on in your code.

Check the caught SocketException details - maybe it's not a timeout after all. Maybe the other side of the connection shuts down the socket.

Consider enabling network tracing to diagnose the exact source of your problems: look for "Network Tracing" on MSDN (can't provide you with a link, since right now MSDN is down).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-10-08T13:54:21.873

如果您有一个 tcp 服务器，它只是以不规则的时间间隔写入数据，并且您希望在后台保持活动状态：

```
tcpClient.Client.SetSocketOption(SocketOptionLevel.Tcp, SocketOptionName.TcpKeepAliveInterval, 1);
tcpClient.Client.SetSocketOption(SocketOptionLevel.Tcp, SocketOptionName.TcpKeepAliveTime, 2);
tcpClient.Client.SetSocketOption(SocketOptionLevel.Tcp, SocketOptionName.TcpKeepAliveRetryCount, 2);
tcpClient.Client.SetSocketOption(SocketOptionLevel.Socket, SocketOptionName.KeepAlive, true); 
```

如果服务器不（通常自动）回复 tcp keep alives，将导致异步读取引发超时异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T22:56:05.243

由于您不能使用阻塞（同步）接收，您将不得不接受异步处理。幸运的是，使用 .NET 很容易做到这一点。查找 BeginReceive() 和 EndReceive() 的描述。或者查看这篇[文章](http://www.codeguru.com/csharp/csharp/cs_network/sockets/article.php/c7695)或[这篇](http://msdn.microsoft.com/en-us/library/fx6588te.aspx)文章。

至于超时行为，我没有找到对此的结论性描述。由于没有记录，否则您必须假设它是预期的行为。

# asp.net - Asp.Net 2 自定义服务器控件属性

> ID：169186
> 
> 赞同：1
> 
> 时间：2008-10-03T22:44:43.143
> 
> 标签：asp.net, custom-server-controls, composite

我很难找到一个标准模式/最佳实践来处理基于属性值在复合材料中呈现子控件。

这是一个基本场景。我有一个复合控件，它有两个子控件、一个文本框和一个下拉列表。假设有一个属性可以切换要渲染的孩子。

所以：

```
myComposite.ShowDropdown = true; 
```

如果为真，则显示下拉菜单，否则显示文本框。

属性值应跨回发保存，并应根据回发值显示正确的控件。

有什么好的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T23:49:22.513

您使用 ViewState 来存储属性值，以便它在回发之间持续存在，但您必须[正确](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/truly-understanding-viewstate.aspx "真正理解 ViewState")执行。

```
public virtual bool ShowDropdown
{
   get
   {
      object o = ViewState["ShowDropdown"];
      if (o != null)
         return (bool)o;
      return false; // Default value
   }
   set
   {
      bool oldValue = ShowDropdown;
      if (value != oldValue)
      {
         ViewState["ShowDropdown"] = value;
      }
   }
} 
```

可能在您的 Render 方法的某个地方，您根据属性值显示或隐藏 DropDown 控件：

```
dropDown.Visible = ShowDropDown;
textBox.Visible = !ShowDropDown; 
```

另请参见[复合 Web 控件示例](http://msdn.microsoft.com/en-us/library/3257x3ea(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T22:51:18.123

我会认为是这样的：

```
public bool ShowDropDown
{
    get{ return (bool)ViewState["ShowDropDown"]; }
    set{ ViewState["ShowDropDown"]; }
}

private  void Page_Load(object sender, EventArgs e)
{
    DropDaownControl.Visible = ShowDropDown;
    TextBoxControl.Visible = !ShowDropDown;
} 
/* some more code */ 
```

# c# - texbox 的滚动始终在底部

> ID：169193
> 
> 赞同：4
> 
> 时间：2008-10-03T22:47:33.747
> 
> 标签：c#, winforms

有一种方法可以使多行文本框的滚动保持在底部？

类似vb6的东西

```
txtfoo.selstart=len(txtfoo.text) 
```

我正在尝试 txtfoo.selectionstart=txtfoo.text.length 没有成功。

问候。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-03T22:56:55.367

好的，我发现解决方案是使用

```
txtfoo.AppendText 
```

代替

```
 txtfoo.text+="something" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-03T22:59:47.683

另一种解决方案是使用：

```
txtfoo.Text += "something";
txtfoo.SelectionStart = txtfoo.Text.Length;
txtfoo.ScrollToCaret(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T23:13:16.970

有趣的问题。我猜您正在尝试通过表单加载选择文本？我无法让它在表单加载时工作，但我可以在表单点击时工作。奇怪。:)

```
Public Class Form1

    Private Sub Form1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Click
        ScrollTextbox()
    End Sub

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        ScrollTextbox()
    End Sub

    Private Sub ScrollTextbox()
        TextBox1.SelectionStart = TextBox1.TextLength
        TextBox1.ScrollToCaret()
    End Sub

End Class 
```

如果完全有必要，您可以使用计时器。

# c++ - 如何在 Linux 上通过 C++ 中的串行接口与 Arduino 通信？

> ID：169194
> 
> 赞同：7
> 
> 时间：2008-10-03T22:47:43.480
> 
> 标签：c++, linux, serial-port, arduino, rfid

我有一个连接到 Arduino 板的 RFID 阅读器。我想通过它的串行接口连接到它，并且每当 RFID 阅读器忽略一个信号时（当它读取一个 (RF)ID 时），我想在我的 C++ 程序中检索它。

我已经有了从 Arduino 简单地将 RFID 打印到串行的代码。

我不知道，*如何*在 Linux 中从 C++ 读取它？

我看过**libserial**，它看起来很简单。但是，我怎样才能*让 C++ 程序对信号做出反应，然后读取 RFID*，而不是连续收听？这是必要的吗？

编辑：在我读过的大多数示例中，（c++）程序发送输入，并接收输出。我只想听并接收来自 Arduino 的输出。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-03T23:11:55.163

在 unix 上，您使用 select() 调用来等待输入。select() 调用就像睡眠一样——在内核接收到硬件中断并触发 select() 之前不使用 CPU。

[http://tldp.org/HOWTO/Serial-Programming-HOWTO/index.html](http://tldp.org/HOWTO/Serial-Programming-HOWTO/index.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T20:45:12.230

我找到了 Boost::Asio 库，它从串行接口异步读取。[Boost::Asio 文档](http://www.boost.org/doc/libs/1_36_0/doc/html/boost_asio.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T23:10:51.733

Arduino Playground 中接口部分的[通信部分有几个接口示例，包括一个将 Arduino 作为 Linux TTY 的示例。](http://www.arduino.cc/playground/Main/InterfacingWithHardware#Communication)

试试Arduino 网站上的[语法和程序](http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl?board=programming)论坛和[软件开发论坛。](http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl?board=dev)过去曾讨论过与许多不同语言和计算机的接口。

最后查看[处理](http://www.processing.org/)和[接线](http://wiring.org.co/)站点。Arduino IDE基于Processing语言，布线环境和开发板与Arduino相关。这两个站点都有更多示例和指向更多资源的链接。

**编辑：**我刚刚意识到我没有回答你的实际问题。这些都是一般的通信资源，但有些可能会提示如何提醒计算机有新的 RFID 输入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-15T10:34:25.397

嗨，我为此创建了一个简单的库：**cArduino** [https://github.com/ranma1988/cArduino](https://github.com/ranma1988/cArduino) C++ 可以找到自动查找连接 Arduino 端口、读取、写入

# project-management - 单独的 Scrum 是否 = 敏捷？

> ID：169195
> 
> 赞同：10
> 
> 时间：2008-10-03T22:47:53.653
> 
> 标签：project-management, agile, scrum

我听说很多公司表现得好像他们很敏捷，但他们所做的唯一敏捷的事情就是 Scrum 流程。这足以被认为是敏捷的吗？单独使用 Scrum 似乎是一个糟糕的经理更频繁地召开更多会议的完美借口。我应该厌倦这样的公司吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-03T23:31:42.347

敏捷是一个大而模糊的概念。很多东西都是敏捷的。

Scrum 是一组用于冲刺和发布的特定技术。它是敏捷的，因为它符合敏捷宣言。

还有许多其他特定的敏捷技术（例如，所有 xDD。）

如有疑问，请将公司的实际实践与[敏捷宣言](http://agilemanifesto.org/)进行比较。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-05T15:43:13.977

> “我听说很多公司表现得好像他们很敏捷，但他们所做的唯一敏捷的事情是 Scrum 流程。这足以被认为是敏捷吗？”

简短的回答 - 是的。无论如何，在我看来:-)

当然——他们必须真正*在做*Scrum——而不是把名字贴在墙上。Scrum 不仅仅是每天的站立会议……如果这就是他们所做的一切，那么他们就做得不对。

正确完成 Scrum 迫使公司识别组织运行方式的瓶颈。通过设置定期的时间盒冲刺，获得体面的反馈循环，并在产品所有者和团队之间适当地分配责任，您实际上可以获得有关如何改进流程的有用基线信息。

组织必须听取反馈并采取行动。

这当然不是实现敏捷的唯一方法。它甚至可能不是将敏捷引入组织的最佳方式。我自己更喜欢 XP ——并且发现额外的实践为启动这些流程改进提供了一个有用的框架。

也就是说 - 对于许多组织来说 - 最大的问题是职责分工不当以及完全缺乏理智和快速的反馈循环。Scrum 解决了这个问题。

会议只是其中很小的一部分:-)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-03T23:17:34.480

Scrum 所提倡的透明性会让糟糕的管理者脱颖而出。真正拥抱 Scrum 的公司绝对值得一看。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-03T22:54:21.953

单独使用 SCRUM 不一定是召开更多会议的借口。能够跟踪每天完成的工作并决定如何修改（通过削减或重新平衡工作）冲刺的其余部分本身就非常有用，而且对我来说听起来很敏捷。:-)

当然，如果你没有敏捷过程的其他组成部分，你将很难衡量你的工作是否成功，所以你可能认为你在冲刺的轨道上，但实际上还差得很远您应该按时交付优质产品。

**更新**：你不应该仅仅在这个前提下解雇这样的公司。但是，在面试期间，您应该利用这个机会了解他们为什么只使用 SCRUM。如果没有人来支持 TDD 或 CI 之类的事情，那么如果您愿意成为技术负责人，那么它可能很适合您。如果是因为他们将这些流程视为“开销”、“愚蠢”或“不必要”，那么你应该对公司保持警惕。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T23:14:25.580

我注意到，仅使用 Scrum 会议是一个非常明显的迹象，表明该公司没有正确实施敏捷概念。

想想 Scrum 会议有多简单，只需启动 Outlook 并让每个人每天开 15 分钟的会议。但是，将所有内容分割成快速迭代并确保最终用户快速测试新功能需要更多的工作。

我猜，大多数经理在 Scrum 部分之后就停止阅读，他们就失去了兴趣。但是，他们的日常会议请求永远存在。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-05T19:44:01.493

Scrum 是一种项目管理方法，首先也是最重要的。是的，如果你在做 Scrum，你可能会开始更多地考虑敏捷，并为你的客户提供价值。但这并不一定会让你变得敏捷。对于初学者来说，Scrum 不会谈论你如何进行软件开发。这就是诸如 XP 之类的东西的用武之地——其他方法和想法迫使您审查和改变您的工作实践，以便变得更有效率和效力。

因此，与其问“你做 Scrum / XP / 什么”，不如问这些公司他们的整体流程并采取整体观点。公司是否专注于提供最大的商业价值并以持续改进的精神为动力？如果是这样，那么他们可能比那些说它做 Scrum 的人敏捷得多。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-12-09T10:54:22.217

敏捷！= scrum。

敏捷是为改变做好准备。

敏捷多次被呈现为一个保护伞，一组不同的技术、方法，用于在支持变革的环境中工作。Scrum 用于项目管理，开发技术有 xp，为了更好的需求流程，您可以使用 BDD，用于测试 TDD。

从 scrum 开始是敏捷之路的第一步。也考虑其他技术。这需要时间，但有真正的好处。没有什么比共识和良好的团队精神更好的了。作为第一个实现它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-11-07T00:31:40.247

**不能仅仅因为有人说他们在做 Scrum 就判断一个团队是否敏捷。**

Scrum 实现有好有坏，但敏捷的关键在于：

*   项目和团队灵活思考的能力
*   团队的自组织程度如何（他们是否有控制狂“架构师”或经理？或者是否有相当多的共识决策？）

在没有真正敏捷的情况下，很容易满足团队在进行 Scrum 时需要做的最低要求。这些最低要求只是为了带来某种态度和工作方式。

**项目中的决策可能非常不灵活且自上而下受控，但仍符合 Scrum 的最低要求。**可悲的是，当我寻找合同约定时，我发现仅名义上的 scrum 实现的数量远远超过了真实的实现。

就个人而言，我会选择在 scrum 中实现极限编程。（事实上​​，Jeff Sutherland 说他从来没有见过没有进行 XP 实践的顶级生产力 Scrum 团队。）但是，我非常有信心人们也可以非常糟糕地实施 XP... ;-) 它真的失败了对球队的态度。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-05-16T14:04:26.217

敏捷宣言实际上是一种与更好的工作方式有关的哲学。Scrum 是一种敏捷方法，所以是的，使用 Scrum 的公司通常被认为是敏捷的。

然而，在尝试实施 Scrum 时完全有可能忘记敏捷哲学。很容易陷入对完美 Scrum 流程的追求而忽视个人及其互动。

你应该厌倦那些忽视个人和互动的公司，而盲目地偏爱严格的流程和工具。但是，无论他们声明的方法如何，这都是正确的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-06-15T11:02:42.743

单单 Scrum 就等于敏捷，这完全是一种误解。敏捷是一种保护伞，其中有几种方法，如 scrum master、看板、精益、XP。现在你说伞的一部分如何才能实现伞的整体概念。因此，Scrum 是敏捷的一部分。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-02-09T22:52:24.287

只实践 Scrum 的组织很可能会在软件管理和项目可见性方面看到收益。然而，他们很可能不会通过不结合 XP 原则（如单元测试、持续集成、结对编程等）来实现更高的工程质量和吞吐量潜力，从而使他们的 Sprint 产品的末端不是“潜在可交付”的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-23T17:35:33.573

Scrum 为您提供了一个框架来修复/改进您的开发过程。[它应该被视为“结成团队](http://www.hans-eric.com/2007/08/13/is-your-team-jelled/)”和更有生产力的团队的起点。您很可能很快就会超越标准的 Scrum 实践，但作为起点，它具有一些吸引人的特性：

1.  这很容易理解
2.  它几乎可以应用于任何项目和团队
3.  有很多人赚钱并帮助公司采用 Scrum

此外[，知道 Scrum = 敏捷是否真的不是那么重要](http://www.targetprocess.com/blog/2008/10/agile-development-future-will-lean.html)。最好专注于提高生产力，不要为这些问题烦恼。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-23T17:52:26.160

是的，我同意这里的一些观点。敏捷是遵循宣言并确保您正确排列优先事项。SCRUM 只是另一种写下特定部分的变体。如果有的话，它是一种管理“工具”。

话虽如此，请记住，工具是次要的，你的人是你的首要任务。不要过度关注管理风格，而不是关注人和产品。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-06-18T10:45:47.143

人们成为他们主观观点的牺牲品。我认为敏捷和 Scrum 是什么，另一个人的想法可能会有所不同。[幸运的是，我们在敏捷宣言](http://www.agilemanifesto.org/)、[原则](http://www.agilemanifesto.org/principles.html)和[Scrum 价值观](https://www.scrumalliance.org/why-scrum/core-scrum-values-roles)中有一套指导方针，但通常公司最终会变得专注于遵循流程，而不是理解它及其目标。

**敏捷宣言**

> 我们正在通过开发软件并帮助他人开发软件来发现更好的方法。通过这项工作，我们开始重视：
> 
> *   **个人和交互**超过流程和工具
> *   **工作软件**优于综合文档
> *   **合同谈判中的**客户协作****
> ***   **响应变化**而不是遵循计划**
> 
>  **也就是说，虽然右边的项目有价值，但我们更重视左边的项目。**

 ****Scrum 价值观**

通过询问他们的价值观以及他们如何遵守这些价值观，您可以了解很多关于使用 Scrum 的公司的信息。这可以让您了解 Scrum 的过程是否只是在没有真正考虑与之相关的价值的情况下执行。

> 在 Scrum 中执行的所有工作都需要一组价值观作为团队流程和交互的基础。通过接受这五个价值观，团队使它们对其健康和成功更加重要。- 查看更多信息： [https ://www.scrumalliance.org/why-scrum/core-scrum-values-roles#sthash.qsmCTxdU.dpuf](https://www.scrumalliance.org/why-scrum/core-scrum-values-roles#sthash.qsmCTxdU.dpuf)

*   重点
*   勇气
*   开放性
*   承诺
*   尊重

**目标**

目标是**在每次迭代结束时发布高质量的软件**。

通过适当的影响，公司内部的价值观可以改变。不幸的是，人们是不可预测的，因此当引入其他变化时，公司可能会重新陷入不良习惯。这就是使软件更具挑战性和令人兴奋的原因。它正在寻找在技术和产品之间建立平衡的方法。

**红旗**

*   如果一家公司更关注过程而不是目标。
*   如果您必须跳过各种圈套和程序来签署最小的更改。
*   公司不必让流程 100% 正确，但如果他们没有不断调整和改进以实现目标，*而不是仅仅遵循流程*，那么他们可能最终会以[“半途而废”的方式](http://www.halfarsedagilemanifesto.org/)实施敏捷：

> 我们通过付费顾问和阅读 Gartner 报告听说了开发软件的新方法。通过这一点，我们被告知要重视：
> 
> *   个人和互动优于流程和工具，我们有强制性流程和工具来控制这些个人（我们更喜欢“资源”一词）如何互动
> *   只要该软件有全面的文档，就可以使用软件而不是全面的文档
> *   当然，在严格的合同范围内进行合同谈判的客户协作，并受到严格的变更控制
> *   响应变化而不是遵循计划，前提是制定了详细的计划来应对变化，并且得到准确的遵循
> 
> 也就是说，虽然左边的项目在理论上听起来不错，但我们是一家企业公司，我们不可能放弃右边的项目。

**遵守**

一些公司可能有严格的合规程序，阻碍了敏捷。这可能包括无法逃避的治理和其他法规。这可能会影响敏捷方法，使其感觉更加笨重和沉重，但这并不意味着这些流程不能被简化以更适应。

# actionscript - ActionScript 3.0 + 计算两个日期之间的时间跨度？

> ID：169201
> 
> 赞同：17
> 
> 时间：2008-10-03T22:49:19.233
> 
> 标签：actionscript, timespan

在 ActionScript 3.0 中，是否有一种自动方法来计算两个指定日期之间的天数、小时数、分钟数和秒数？

基本上，我需要的是 .NET Timespan 类的 ActionScript 等效项。

任何想法？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-19T10:46:52.153

我创建了一个 ActionScript TimeSpan 类，它具有与 System.TimeSpan 类似的 API 来填补这一空白，但由于缺少运算符重载而存在差异。你可以像这样使用它：

```
TimeSpan.fromDates(later, earlier).totalDays; 
```

下面是该类的代码（抱歉，这篇大文章 - 我不会包含单元测试；）

```
/**
 * Represents an interval of time 
 */ 
public class TimeSpan
{
    private var _totalMilliseconds : Number;

    public function TimeSpan(milliseconds : Number)
    {
        _totalMilliseconds = Math.floor(milliseconds);
    }

    /**
     * Gets the number of whole days
     * 
     * @example In a TimeSpan created from TimeSpan.fromHours(25), 
     *          totalHours will be 1.04, but hours will be 1 
     * @return A number representing the number of whole days in the TimeSpan
     */
    public function get days() : int
    {
         return int(_totalMilliseconds / MILLISECONDS_IN_DAY);
    }

    /**
     * Gets the number of whole hours (excluding entire days)
     * 
     * @example In a TimeSpan created from TimeSpan.fromMinutes(1500), 
     *          totalHours will be 25, but hours will be 1 
     * @return A number representing the number of whole hours in the TimeSpan
     */
    public function get hours() : int
    {
         return int(_totalMilliseconds / MILLISECONDS_IN_HOUR) % 24;
    }

    /**
     * Gets the number of whole minutes (excluding entire hours)
     * 
     * @example In a TimeSpan created from TimeSpan.fromMilliseconds(65500), 
     *          totalSeconds will be 65.5, but seconds will be 5 
     * @return A number representing the number of whole minutes in the TimeSpan
     */
    public function get minutes() : int
    {
        return int(_totalMilliseconds / MILLISECONDS_IN_MINUTE) % 60; 
    }

    /**
     * Gets the number of whole seconds (excluding entire minutes)
     * 
     * @example In a TimeSpan created from TimeSpan.fromMilliseconds(65500), 
     *          totalSeconds will be 65.5, but seconds will be 5 
     * @return A number representing the number of whole seconds in the TimeSpan
     */
    public function get seconds() : int
    {
        return int(_totalMilliseconds / MILLISECONDS_IN_SECOND) % 60;
    }

    /**
     * Gets the number of whole milliseconds (excluding entire seconds)
     * 
     * @example In a TimeSpan created from TimeSpan.fromMilliseconds(2123), 
     *          totalMilliseconds will be 2001, but milliseconds will be 123 
     * @return A number representing the number of whole milliseconds in the TimeSpan
     */
    public function get milliseconds() : int
    {
        return int(_totalMilliseconds) % 1000;
    }

    /**
     * Gets the total number of days.
     * 
     * @example In a TimeSpan created from TimeSpan.fromHours(25), 
     *          totalHours will be 1.04, but hours will be 1 
     * @return A number representing the total number of days in the TimeSpan
     */
    public function get totalDays() : Number
    {
        return _totalMilliseconds / MILLISECONDS_IN_DAY;
    }

    /**
     * Gets the total number of hours.
     * 
     * @example In a TimeSpan created from TimeSpan.fromMinutes(1500), 
     *          totalHours will be 25, but hours will be 1 
     * @return A number representing the total number of hours in the TimeSpan
     */
    public function get totalHours() : Number
    {
        return _totalMilliseconds / MILLISECONDS_IN_HOUR;
    }

    /**
     * Gets the total number of minutes.
     * 
     * @example In a TimeSpan created from TimeSpan.fromMilliseconds(65500), 
     *          totalSeconds will be 65.5, but seconds will be 5 
     * @return A number representing the total number of minutes in the TimeSpan
     */
    public function get totalMinutes() : Number
    {
        return _totalMilliseconds / MILLISECONDS_IN_MINUTE;
    }

    /**
     * Gets the total number of seconds.
     * 
     * @example In a TimeSpan created from TimeSpan.fromMilliseconds(65500), 
     *          totalSeconds will be 65.5, but seconds will be 5 
     * @return A number representing the total number of seconds in the TimeSpan
     */
    public function get totalSeconds() : Number
    {
        return _totalMilliseconds / MILLISECONDS_IN_SECOND;
    }

    /**
     * Gets the total number of milliseconds.
     * 
     * @example In a TimeSpan created from TimeSpan.fromMilliseconds(2123), 
     *          totalMilliseconds will be 2001, but milliseconds will be 123 
     * @return A number representing the total number of milliseconds in the TimeSpan
     */
    public function get totalMilliseconds() : Number
    {
        return _totalMilliseconds;
    }

    /**
     * Adds the timespan represented by this instance to the date provided and returns a new date object.
     * @param date The date to add the timespan to
     * @return A new Date with the offseted time
     */     
    public function add(date : Date) : Date
    {
        var ret : Date = new Date(date.time);
        ret.milliseconds += totalMilliseconds;

        return ret;
    }

    /**
     * Creates a TimeSpan from the different between two dates
     * 
     * Note that start can be after end, but it will result in negative values. 
     *  
     * @param start The start date of the timespan
     * @param end The end date of the timespan
     * @return A TimeSpan that represents the difference between the dates
     * 
     */     
    public static function fromDates(start : Date, end : Date) : TimeSpan
    {
        return new TimeSpan(end.time - start.time);
    }

    /**
     * Creates a TimeSpan from the specified number of milliseconds
     * @param milliseconds The number of milliseconds in the timespan
     * @return A TimeSpan that represents the specified value
     */     
    public static function fromMilliseconds(milliseconds : Number) : TimeSpan
    {
        return new TimeSpan(milliseconds);
    }

    /**
     * Creates a TimeSpan from the specified number of seconds
     * @param seconds The number of seconds in the timespan
     * @return A TimeSpan that represents the specified value
     */ 
    public static function fromSeconds(seconds : Number) : TimeSpan
    {
        return new TimeSpan(seconds * MILLISECONDS_IN_SECOND);
    }

    /**
     * Creates a TimeSpan from the specified number of minutes
     * @param minutes The number of minutes in the timespan
     * @return A TimeSpan that represents the specified value
     */ 
    public static function fromMinutes(minutes : Number) : TimeSpan
    {
        return new TimeSpan(minutes * MILLISECONDS_IN_MINUTE);
    }

    /**
     * Creates a TimeSpan from the specified number of hours
     * @param hours The number of hours in the timespan
     * @return A TimeSpan that represents the specified value
     */ 
    public static function fromHours(hours : Number) : TimeSpan
    {
        return new TimeSpan(hours * MILLISECONDS_IN_HOUR);
    }

    /**
     * Creates a TimeSpan from the specified number of days
     * @param days The number of days in the timespan
     * @return A TimeSpan that represents the specified value
     */ 
    public static function fromDays(days : Number) : TimeSpan
    {
        return new TimeSpan(days * MILLISECONDS_IN_DAY);
    }

    /**
     * The number of milliseconds in one day
     */ 
    public static const MILLISECONDS_IN_DAY : Number = 86400000;

    /**
     * The number of milliseconds in one hour
     */ 
    public static const MILLISECONDS_IN_HOUR : Number = 3600000;

    /**
     * The number of milliseconds in one minute
     */ 
    public static const MILLISECONDS_IN_MINUTE : Number = 60000;

    /**
     * The number of milliseconds in one second
     */ 
    public static const MILLISECONDS_IN_SECOND : Number = 1000;
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-03T22:59:43.317

您可以将两个日期时间转换为自纪元以来的毫秒数，执行数学运算，然后使用生成的毫秒数来计算这些更高的时间跨度数。

```
var someDate:Date = new Date(...);
var anotherDate:Date = new Date(...);
var millisecondDifference:int = anotherDate.valueOf() - someDate.valueOf();
var seconds:int = millisecondDifference / 1000;
.... 
```

[LiveDocs](http://livedocs.adobe.com/flex/201/langref/Date.html)对于这类事情也很有用。抱歉，ActionScript 有点不对劲，但已经有一段时间了。

如果您要进行大量此类数学运算，我还建议您创建一组可以执行这些操作的静态类方法。遗憾的是，标准 API 中并不存在这种基本功能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-08-09T01:32:25.880

对于像这样的一些单一功能，我更喜欢...... [从 Richard Szalay 的代码中浓缩]

```
public function timeDifference(startTime:Date, endTime:Date) : String
{
if (startTime == null) { return "startTime empty."; }
if (endTime   == null) { return "endTime empty."; }
var aTms = Math.floor(endTime.valueOf() - startTime.valueOf());
return "Time taken:  "  
    + String( int(aTms/(24*60*+60*1000))     ) + " days, "
    + String( int(aTms/(    60*60*1000)) %24 ) + " hours, "
    + String( int(aTms/(       60*1000)) %60 ) + " minutes, "
    + String( int(aTms/(        1*1000)) %60 ) + " seconds.";
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-18T09:01:07.770

为了准确起见，Russell 的上述帖子是正确的，直到您达到 25 天的差异，然后这个数字对于 int 变量来说变得太大了。因此声明millisecondDifference:Number;

记录的 getTime() 和 valueOf() 之间可能存在一些差异，但实际上我看不到

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T23:03:37.083

没有自动的方法可以做到这一点。使用提供的类可以实现的最佳效果是获取 date1.time 和 date2.time，以给出自 1970 年 1 月 1 日以来两个数字的毫秒数。然后，您可以计算出它们之间的毫秒数。通过一些基本的数学，您可以推导出秒、小时、天等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-08T23:55:10.763

```
var timeDiff:Number = endDate - startDate;
var days:Number     = timeDiff / (24*60*60*1000);
var rem:Number      = int(timeDiff % (24*60*60*1000));
var hours:Number    = int(rem / (60*60*1000));
rem                 = int(rem % (60*60*1000));
var minutes:Number  = int(rem / (60*1000));
rem                 = int(rem % (60*1000));
var seconds:Number  = int(rem / 1000);

trace(days + " << >> " +hours+ " << >> " +minutes+ " << >> " +seconds); 
```

或者

```
var time:Number = targetDate - currentDate;
var secs:Number = time/1000;
var mins:Number = secs/60;  
var hrs:Number  = mins/60;
var days:Number = int(hrs/24);

secs = int(secs % 60);
mins = int(mins % 60);
hrs  = int(hrs % 24);

trace(secs + "  << >> " + mins + " << >> " + hrs + " << >> " + days); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-10T19:17:04.623

ArgumentValidation is another class of Mr Szalays that does some checks to make sure each method has the right values to perform it's tasks without throwing unrecognisable errors. They are non-essential to get the TimeSpan class working so you could just comment them out and the class will work correctly.

Rich may post the Argument validation class on here as well as it's very handy but i'll leave that down to him ;P

# winforms - Crystal 2008 中的服务器端报表？

> ID：169212
> 
> 赞同：0
> 
> 时间：2008-10-03T22:58:04.100
> 
> 标签：winforms, crystal-reports

我希望将 Crystal Reports 2008 集成到 Windows 窗体应用程序中。我想避免从我的客户端应用程序直接连接到数据库，同时为用户提供“完整”的报告体验。Crystal Reports 2008 是否可以将服务器上的报表执行到客户端 Windows 窗体客户端控件中，类似于 Microsoft Reporting Services？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T06:13:53.357

我不知道这是否正是您所追求的，但我可以想到两种方法可以捏造它：

1.  您可以设置您的报告，使“数据库”是一个 XSD 文件，而无需了解真正的后端。然后在运行时将数据推送到报告中。

// 在运行时创建一个适合您的环境的实例 - 仅示例：

ReportClass rc = new ReportClass();

rc.Load(水晶报告文件名);

rc.SetDataSource(myIEnumerableData);

CrystalReportViewer crv = new CrystalReportViewer();

crv.ReportSource = rc;

// 显示水晶查看器。

2 - 您可以在服务器上执行与 1 相同的操作（无论数据库方法如何），然后保存报告并将其推送到客户端。

// 一些服务器端服务/方法等

公共字节[] GetMyReport() {

ReportClass rc = new ReportClass();

rc.Load(水晶报告文件名);

rc.SetDataSource(myIEnumerableData);

rc.SaveAs(serverSideFile, True); // True 对于使用报告保存数据至关重要

return .... // 将创建的文件转换为我想的字节数组

}

// 客户端

字节 [] 代表 = 服务器。获取我的报告（）

ReportClass rc = ..... // 将 rep 转换回水晶报表

CrystalReportViewer crv = new CrystalReportViewer();

crv.ReportSource = rc;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T23:26:49.563

这并不是您真正要问的，但 Crystal Reports Server 会执行服务器端报告。

不利的一面是，它非常昂贵。

[http://www.businessobjects.com/product/catalog/crystalreports_server/](http://www.businessobjects.com/product/catalog/crystalreports_server/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T14:42:58.700

我无法在上面添加评论，因为我没有任何观点，但希望这会有所帮助。

Crystal Reports Server 针对数据源运行报表，其想法是没有 Crystal Reports 或数据访问权限的客户端可以通过 Web 运行报表，或者服务器运行计划报表并将结果发送出去。我不知道你是否可以整合它。

# setter - 如果你使用 getter 和 setter，你应该如何命名私有成员变量？

> ID：169216
> 
> 赞同：4
> 
> 时间：2008-10-03T22:59:07.670
> 
> 标签：setter, getter, prefixes

[作为对这个关于前缀](https://stackoverflow.com/questions/111605/what-kind-of-prefix-do-you-use-for-member-variables)的问题的跟进，我同意线程上大多数人的观点，即前缀是不好的。但是如果你使用 getter 和 setter 呢？然后，您需要将可公开访问的 getter 名称与私有存储的变量区分开来。我通常只使用下划线，但有更好的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-03T23:07:52.567

这是一个完全主观的问题。没有“更好”的方法。

一种方法是：

```
private int _x;
public get x():int { return _x; }
public set x(int val):void { _x = val; } 
```

另一个是：

```
private int x;
public get X():int { return x; }
public set X(int val):void { x = val; } 
```

两者都不是正确答案。每个都有风格的优点和缺点。选择您最喜欢的一个并始终如一地应用它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-03T23:18:26.930

正如其他人所提到的，我喜欢在字段前加上下划线。

```
private int _x; 
```

我认为这超出了直接的个人喜好（正如大卫阿诺在这个帖子中所说）。我认为这样做有一些真正的客观原因：

1.  这意味着您不必为赋值编写“this.x = x”（尤其是在 setter 和构造函数中）。
2.  它将您的字段与本地变量/参数区分开来。这样做很重要：字段比本地人更难处理，因为它们的范围更广/生命周期更长。添加额外的字符对于编码人员来说是一个心理警告信号。
3.  在某些 IDE 中，下划线将导致自动完成将字段排序到建议列表的顶部。这样可以更轻松地在一个块中查看该类的所有字段。这反过来会有所帮助；在大类上，您可能无法在与您正在处理的代码相同的屏幕上看到字段（通常定义在类的顶部）。将它们排序到顶部提供了一个方便的参考。

（这些约定适用于 Java，但其他语言也有类似的约定）

这些东西看起来很小，但它们的流行肯定让我在编码时的生活更轻松。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T23:07:48.900

在 java 中有 this.foo 在 python 中有 self.foo 和其他语言有类似的东西，所以当我已经可以使用语言结构时，我认为不需要以特殊方式命名某些东西。在相同的上下文中，优秀的 IDE 和编辑器理解成员变量并给它们一个特殊的亮点，所以你可以真正看到它而无需使用特殊的名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T23:06:49.043

在区分大小写的语言中，我只使用：

```
private int myValue;

public int MyValue
{
    get { return myValue; }
} 
```

否则我会使用下划线

```
Private _myValue As Integer

Public ReadOnly Property MyValue As Integer
    Get
        Return _myValue
    End Get
End Property 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T23:07:26.780

执行此操作的方式几乎与程序员执行此操作的方式一样多，但一些更流行的方式包括（对于属性`Foo`）：

*   mFoo
*   m_foo
*   _foo
*   富

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-04T01:08:05.460

我*喜欢*写“this.x = x”。我很清楚。另外，在使用 Eclipse 时，您可以通过这种方式让它自动生成您的 getter/setter。

# c# - C# 等效于 SQL Server 中的 IsNull() 函数

> ID：169217
> 
> 赞同：120
> 
> 时间：2008-10-03T22:59:18.153
> 
> 标签：c#, .net, sql-server, isnull

在 SQL Server 中，您可以使用该`IsNull()`函数来检查一个值是否为空，如果是，则返回另一个值。现在我想知道 C# 中是否有类似的东西。

例如，我想做类似的事情：

```
myNewValue = IsNull(myValue, new MyValue()); 
```

代替：

```
if (myValue == null)
  myValue = new MyValue();
myNewValue = myValue; 
```

谢谢。

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2008-10-03T23:01:24.233

它被称为空合并 ( `??`) 运算符：

```
myNewValue = myValue ?? new MyValue(); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-04T00:20:57.350

可悲的是，没有等效于与 DBNull 一起使用的空合并运算符。为此，您需要使用三元运算符：

```
newValue = (oldValue is DBNull) ? null : oldValue; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-07-02T15:34:09.047

```
public static T isNull<T>(this T v1, T defaultValue)
{
    return v1 == null ? defaultValue : v1;
}

myValue.isNull(new MyValue()) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-11-14T07:49:45.160

使用等于方法：

```
object value2 = null;
Console.WriteLine(object.Equals(value2,null)); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-04T04:50:19.507

为了使用 DB Nulls，我为我的 VB 应用程序创建了一堆。我称它们为 Cxxx2，因为它们类似于 VB 的内置 Cxxx 函数。

你可以在我的 CLR Extensions 项目中看到它们

[http://www.codeplex.com/ClrExtensions/SourceControl/FileView.aspx?itemId=363867&changeSetId=17967](http://www.codeplex.com/ClrExtensions/SourceControl/FileView.aspx?itemId=363867&changeSetId=17967)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-25T19:20:57.307

你写了两个函数

```
 //When Expression is Number
    public static double? isNull(double? Expression, double? Value)
    {
        if (Expression ==null)
        {
            return Value;
        }
        else
        {
            return Expression;
        }
    }

    //When Expression is string (Can not send Null value in string Expression
    public static string isEmpty(string Expression, string Value)
    {
        if (Expression == "")
        {
            return Value;
        }
        else
        {
            return Expression;
        }
    } 
```

他们工作得很好

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-20T19:11:07.643

我一直在我的 DataRow 类型上使用以下扩展方法：

```
 public static string ColumnIsNull(this System.Data.DataRow row, string colName, string defaultValue = "")
    {
        string val = defaultValue;
        if (row.Table.Columns.Contains(colName))
        {
            if (row[colName] != DBNull.Value)
            {
                val = row[colName]?.ToString();
            }
        }
        return val;
    } 
```

用法：

```
MyControl.Text = MyDataTable.Rows[0].ColumnIsNull("MyColumn");
MyOtherControl.Text = MyDataTable.Rows[0].ColumnIsNull("AnotherCol", "Doh! I'm null"); 
```

我首先检查该列是否存在，因为如果没有任何查询结果具有该列的非空值，则 DataTable 对象甚至不会提供该列。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-14T11:29:18.740

使用以下方法。

```
 /// <summary>
    /// Returns replacement value if expression is null
    /// </summary>
    /// <param name="expression"></param>
    /// <param name="replacement"></param>
    /// <returns></returns>
    public static long? IsNull(long? expression, long? replacement)
    {
        if (expression.HasValue)
            return expression;
        else
            return replacement;
    }

    /// <summary>
    /// Returns replacement value if expression is null
    /// </summary>
    /// <param name="expression"></param>
    /// <param name="replacement"></param>
    /// <returns></returns>
    public static string IsNull(string expression, string replacement)
    {
        if (string.IsNullOrWhiteSpace(expression))
            return replacement;
        else
            return expression;
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-11-04T12:25:33.513

```
 public static T IsNull<T>(this T DefaultValue, T InsteadValue)
    {

        object obj="kk";

        if((object) DefaultValue == DBNull.Value)
        {
            obj = null;
        }

        if (obj==null || DefaultValue==null || DefaultValue.ToString()=="")
        {
            return InsteadValue;
        }
        else
        {
            return DefaultValue;
        }

    }

//This method can work with DBNull and null value. This method is question's answer 
```

* * *

## 回答 #10

> 赞同：-10
> 
> 时间：2008-10-04T05:14:53.917

这是半开玩笑的意思，因为这个问题有点傻。

```
public static bool IsNull (this System.Object o)
{
   return (o == null);
} 
```

这是一个扩展方法，但是它扩展了 System.Object，因此您现在使用的每个对象都有一个 IsNull() 方法。

然后，您可以通过以下方式节省大量代码：

```
if (foo.IsNull()) 
```

而不是超级跛脚：

```
if (foo == null) 
```

# c# - 初始化 C# 自动属性

> ID：169220
> 
> 赞同：212
> 
> 时间：2008-10-03T22:59:53.393
> 
> 标签：c#, initialization, automatic-properties

我习惯于编写这样的类：

```
public class foo {
  private string mBar = "bar";
  public string Bar {
    get { return mBar; }
    set { mBar = value; }
  }
  //... other methods, no constructor ...
} 
```

将 Bar 转换为自动属性似乎既方便又简洁，但是如何在不添加构造函数并将初始化放入其中的情况下保留初始化呢？

```
public class foo2theRevengeOfFoo {
  //private string mBar = "bar";
  public string Bar { get; set; }
  //... other methods, no constructor ...
  //behavior has changed.
} 
```

您可以看到添加构造函数与我应该从自动属性中获得的工作量节省不一致。

这样的事情对我来说更有意义：

```
public string Bar { get; set; } = "bar"; 
```

* * *

## 回答 #1

> 赞同：249
> 
> 时间：2008-10-04T06:38:02.283

更新 - 下面的答案是在 C# 6 出现之前编写的。在 C# 6 中，您可以编写：

```
public class Foo
{
    public string Bar { get; set; } = "bar";
} 
```

您还*可以*编写只读的自动实现的属性，这些属性只能在构造函数中写入（但也可以赋予默认初始值）：

```
public class Foo
{
    public string Bar { get; }

    public Foo(string bar)
    {
        Bar = bar;
    }
} 
```

* * *

不幸的是，现在没有办法做到这一点。您必须在构造函数中设置值。（使用构造函数链接有助于避免重复。）

自动实现的属性现在很方便，但肯定会更好。我发现自己并不希望像只读自动实现的属性那样频繁地进行这种初始化，该属性只能在构造函数中设置并且由只读字段支持。

这在 C# 5 之前（包括 C# 5）并没有发生，但正计划在 C# 6 中进行 - 无论是允许在声明点进行初始化，*还是*允许在构造函数主体中初始化只读自动实现的属性。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-10-03T23:06:09.327

你可以通过你的类的构造函数来做到这一点：

```
public class foo {
  public foo(){
    Bar = "bar";
  }
  public string Bar {get;set;}
} 
```

如果你有另一个构造函数（即一个带参数的构造函数）或一堆构造函数，你总是可以拥有这个（称为构造函数链接）：

```
public class foo {
  private foo(){
    Bar = "bar";
    Baz = "baz";
  }
  public foo(int something) : this(){
    //do specialized initialization here
    Baz = string.Format("{0}Baz", something);
  }
  public string Bar {get; set;}
  public string Baz {get; set;}
} 
```

如果您始终将调用链接到默认构造函数，则可以在此处设置所有默认属性初始化。链接时，链接的构造函数将在调用构造函数之前调用，以便您更专业的构造函数能够设置不同的默认值。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2014-08-29T20:55:32.753

这在 C# 6.0 中是可能的：

```
public int Y { get; } = 2; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-03T23:04:44.570

在默认构造函数中（当然还有任何非默认构造函数）：

```
public foo() {
    Bar = "bar";
} 
```

我相信这与您的原始代码一样具有性能，因为无论如何这都是幕后发生的事情。

# c# - 如何获得 System.Web.HttpWebRequest 对象以使用 SSL 2.0？

> ID：169222
> 
> 赞同：8
> 
> 时间：2008-10-03T23:00:30.880
> 
> 标签：c#, .net, ssl, httpwebrequest

我不知道我是否掌握了很好地表达这个问题所需的所有信息，所以请耐心等待。

我有一个受自签名 SSL 证书保护的本地网页（本地含义 192.168.*）。我正在尝试使用 System.Net.HttpWebRequest 对象访问此页面，但遇到了一个奇怪的问题。

如果在关闭“使用 SSL 2.0”选项的 Internet Explorer 中访问此页面，浏览器会返回错误，就好像它无法建立连接一样。（换句话说，浏览器连接错误，而不是服务器发送的错误。）如果打开“使用 SSL 2.0”选项，则页面可以正常工作，并且您会收到标准警告，即这是自签名证书, 你想继续吗, 等等 (奇怪的是, Firefox, 据说没有打开 SSL 2.0, 工作得很好。)

现在我的问题是我正在尝试使用 HttpWebRequest 对象访问此页面，它返回的错误是连接已意外关闭，就像关闭“使用 SSL 2.0”时 IE 抛出的错误一样。（我已经有了代码来忽略它是一个自签名证书的事实，但它甚至没有走那么远。）

如何让 System.Net.HttpWebRequest 在发出请求时“使用 SSL 2.0”？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-04T00:10:32.533

在处理 Ssl3 时，我自己也遇到过这个问题，但我不确定同样的建议是否适用于 SSL2？

为了解决这个问题，我在安全协议上设置了 Ssl3 标志，如下所示：

> ServicePointManager.SecurityProtocol = SecurityProtocolType.Ssl3;

查看这些链接了解更多详情：

[MSDN 上的 system.net.servicepointmanager.securityprotocol](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.securityprotocol.aspx)

[MSDN 上的安全协议枚举](http://msdn.microsoft.com/en-us/library/system.net.securityprotocoltype.aspx)

如果你幸运的话，他们可能会为你指明正确的方向:)

# mysql - MySQL：有条件地选择下一行和上一行

> ID：169233
> 
> 赞同：5
> 
> 时间：2008-10-03T23:04:46.957
> 
> 标签：mysql

[http://thedailywtf.com/Articles/The-Hot-Room.aspx](http://thedailywtf.com/Articles/The-Hot-Room.aspx)

您是否看到底部有指向下一篇和上一篇文章的链接（“Unprepared For Divide_By_Zero”和“A Completely Different Game”）？我该怎么做，但要选择下一篇和上一篇非私人文章？这适用于选择下一篇文章：

```
SELECT * FROM articles WHERE id > ? AND private IS NULL 
```

但是我找不到选择上一篇文章的方法。

这样做的正确/有效方法是什么，最好是在一个查询中？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-03T23:23:45.077

或扩展杰里米的答案......
在一个查询中

```
(SELECT * FROM articles WHERE id > ? 
 AND private IS NULL 
 ORDER BY id ASC LIMIT 1) 
UNION 
(SELECT * FROM articles WHERE id < ? 
 AND private IS NULL 
 ORDER BY id DESC LIMIT 1) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T23:15:12.177

这是我的做法：

```
-- next
SELECT * FROM articles WHERE id > ? AND private IS NULL ORDER BY id ASC LIMIT 1

-- previous
SELECT * FROM articles WHERE id < ? AND private IS NULL ORDER BY id DESC LIMIT 1 
```

我不确定如何在一个查询中做到这一点。我唯一能想到的可能是在一个查询中同时获取您正在显示的文章和下一篇文章，但这可能太令人困惑了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T23:25:27.150

嵌套选择怎么样？

```
SELECT * FROM articles WHERE id IN (
    SELECT id FROM articles WHERE id > ? AND private IS NULL ORDER BY id ASC LIMIT 1)
)
OR id IN (
    SELECT id FROM articles WHERE id < ? AND private IS NULL ORDER BY id DESC LIMIT 1
); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-28T17:08:46.910

在您的特定情况下，您可以使用子选择等，但如果您需要更复杂的东西（例如：给定初始余额以及付款和退款列表，计算每个时间点的帐户余额），您可能想要写使用 SQL REPEAT/WHILE/LOOP 子句并允许使用变量等的存储过程。

# ruby-on-rails - 合并 Rails 数据库

> ID：169240
> 
> 赞同：5
> 
> 时间：2008-10-03T23:06:55.050
> 
> 标签：ruby-on-rails, database-design, merge

我有两个结构相同的数据库。这些表有一个整数作为 Rails 中使用的主键。

如果我有一个患者表，我将让一名患者在一个数据库中使用主键 123，而另一名患者在另一个数据库中使用相同的主键。

对于合并来自两个数据库的数据，您有什么建议？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-04T02:40:09.877

使用 config/database.yml 中的条目设置两个数据库，然后生成新的迁移。

使用 ActiveRecord::Base.establish_connection 在迁移中的两个数据库之间切换，如下所示：

```
def self.up
  ActiveRecord::Base.establish_connection :development
  patients = Patient.find(:all)
  ActiveRecord::Base.establish_connection :production
  patients.each { |patient| Patient.create patient.attributes.except("id") }
end 
```

YMMV 取决于记录的数量和模型之间的关联。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-04T06:26:35.770

如果您的数据库完全相同（数据不需要自定义处理）并且记录不多，您可以这样做（允许外键）：

**未经测试...**但你明白了

```
#All models and their foreign keys
tales = {Patients => [:doctor_id, :hospital_id],
         Doctors => [:hospital_id],
         Hospitals}

ActiveRecord::Base.establish_connection :development

max_id = tables.map do |model|  
  model.maximum(:id)
end.max + 1000

tables.each do |model, fks|  
  ActiveRecord::Base.establish_connection :development
  records = model.find(:all)

  ActiveRecord::Base.establish_connection :production
  records.each do |record|
    #update the foreign keys
    fks.each do |attr|
      record[attr] += max_id if not record[attr].nil?
    end
    record.id += max_id

    model.create record.attributes
  end
end 
```

如果您有很多记录，则可能必须以某种方式将其分配出去……以 10k 为一组进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T05:27:39.727

顺便说一句，将其作为 rake 或 capistrano 任务而不是迁移可能更有意义。

# javascript - Safari 中是否可以使用 Http Streaming Comet？

> ID：169258
> 
> 赞同：10
> 
> 时间：2008-10-03T23:12:15.757
> 
> 标签：javascript, safari, comet

通过 HTTP Streaming Comet，我的意思是“永久 iframe”/“永久 xhr”变体，在从服务器推送数据后不会关闭连接，而不是标准轮询和长轮询，后者关闭并重新发送新请求每个服务器推送事件。

我查看了 dojo.io.cometd 包，似乎它们只有轮询实现。我也找到[了这个例子](http://www.zeitoun.net/articles/comet_and_php/start)，但即使经过相当多的修改，它似乎也不能在 webkit 中工作（我让它在其他任何地方工作）。[来自 safari 博客的这个公告](http://simonwillison.net/2007/Nov/16/)似乎表明 xhr 是可能的，但我找不到任何代码或文档，也无法让它工作。

有谁知道在 Webkit 浏览器（Safari 和 Chrome）中实现 HTTP 流彗星的技术、脚本、库或演示？

**更新**

经过一番修改后，我发现需要做两件事才能让 http 流通过 XHR 在 Safari 中工作：

*   响应需要有一个 Content-Type: multipart/x-mixed-replace
*   在浏览器开始一致地显示更新之前，响应需要发送一些“噪音”字符。我假设这与填充一些内部缓冲区有关。

**更新 2**

我终于使用 iframe 技术让它在所有浏览器中工作。该解决方案需要注意的是，只有基于 WebKit 的浏览器才能接收 multipart/x-mixed-replace 标头。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-09T23:00:56.120

根据 Wikipedia 的说法，HTTP Streaming comet 应该可以在每个浏览器中使用。“带有非框架的页面布局”，Ajax：权威指南。O'Reilly Media, pp. 320\. ISBN 0596528388 是引用此信息的参考资料，因此本书可能对如何执行此操作有建议。

[http://meteorserver.org/](http://meteorserver.org/)也有一个演示，我刚刚确认它在 Chrome 中工作，客户端库 + 一个将数据推送到客户端的服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T07:16:24.963

这绝对是可能的：GMail 做到了。如果您观看最新 Webkit 中开发人员工具的参考资料部分，您可以观看它的实际操作。他们有一个称为“绑定”的请求，该请求或多或少无限期地保持打开状态。我的理解是，当新邮件到达时，它会遇到这种联系。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-14T15:49:45.633

是的。

您需要在响应的前面[包含大量](http://cometdaily.com/2007/12/11/the-future-of-comet-part-1-comet-today/)（至少 256 字节）垃圾，以使 Safari 正常运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-10T15:23:01.063

虽然这是一篇旧帖子，但我确实做了一些搜索，发现以下文章非常有帮助 [http://www.shanison.com/2010/05/10/stop-the-browser-%E2%80%9Cthrobber-of- doom%E2%80%9D-while-loading-comet-forever-iframe/](http://www.shanison.com/2010/05/10/stop-the-browser-%E2%80%9Cthrobber-of-doom%E2%80%9D-while-loading-comet-forever-iframe/)

# matrix - 哪些编码项目用于创造艺术和美感？

> ID：169272
> 
> 赞同：5
> 
> 时间：2008-10-03T23:15:46.810
> 
> 标签：matrix

今天，作为多伦多[nuit blanche艺术活动的一部分，blinkenlights](http://www.scotiabanknuitblanche.ca/)[立体镜](http://blinkenlights.net/stereoscope)项目开始了。多伦多市政厅被转换成一个巨大的矩阵显示器。有一些[工具](http://blinkenlights.net/stereoscope/create)可以创建自定义动画和一个[iphone 应用程序](http://phobos.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=291807780&mt=8)来查看实时流。

![闪烁灯](https://static.flickr.com/3232/2909334414_331d1aff43.jpg)

我认为这是将技术用于艺术和美感的一个很好的例子。为了艺术和美感，还有哪些其他编码/编程项目？

更新：blinkenlights 的 Youtube 视频：[http ://www.youtube.com/watch?v=jTZosieGhIQ](http://www.youtube.com/watch?v=jTZosieGhIQ)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T23:18:07.147

在[processing.org上有大量涉及技术/代码的艺术项目](http://processing.org/exhibition/index.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T23:55:05.827

在过去的几年里，我在这里和那里修改了[http://processing.org 。](http://processing.org)类似的还有 Context Free 项目，位于[http://www.contextfreeart.org](http://www.contextfreeart.org)

Context Free 背后的想法非常酷。不是直接放置图形元素，而是使用命令式语义，而是定义一个以声明方式定义图形元素关系的语法。运行时系统通过遍历语法并实例化符合其规则的元素来生成图像。

好玩的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-04T00:47:18.170

我发现[code_swarm](http://web.archive.org/web/20180610233621/http://vis.cs.ucdavis.edu:80/~ogawa/codeswarm/)非常漂亮，令人敬畏和催眠，这算吗？

[![替代文字](https://i.stack.imgur.com/q0atj.png "eclipse 项目的 code_swarm")](https://i.stack.imgur.com/q0atj.png "eclipse 项目的 code_swarm")
[（来源：[ucdavis.edu](http://web.archive.org/web/20180610233621/http://vis.cs.ucdavis.edu:80/~ogawa/codeswarm/eclipse-640px.png)）]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-04T00:24:11.663

就个人而言，我认为这是使用代码制作艺术的一个很好的例子，不仅如此，艺术还表达了所有极客类型都能理解和尊重的东西[http://www.opte.org/maps/](http://www.opte.org/maps/) [（来源：][[bitgravity.com](http://bitcast-a.v1.sjc1.bitgravity.com/blyon/opte/maps/static/1105841711.LGL.2D.400x400.png)][）][![替代文字](https://i.stack.imgur.com/e6SOk.png)](https://i.stack.imgur.com/e6SOk.png)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-04T01:46:43.870

任何可以找到当代艺术的地方，比如博物馆和艺术节。交互式安装通常使用诸如 max/msp 或 puredata 之类的数据流编程语言来处理输入并用它做一些有趣的事情。

还有一些节日更关注如何使用代码来创造艺术。一个例子是挪威卑尔根的[http://piksel.no 。](http://piksel.no)Piksel.no 有研讨会和工作坊、现场活动等。其他国家也有类似的节日。

你可以稍微扩展一下艺术的定义，包括演示场景。我确实认为一些演示场景作品是艺术，但它们是苦力中的稀有宝石。不过，请查看[http://scene.org/awards.php](http://scene.org/awards.php)以了解社区提出的内容类型。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-04T00:47:46.407

你从事的每一个代码项目都应该是一种艺术形式，而且看起来很棒。

我在这里只是部分开玩笑。人们喜欢计算机编程的部分原因是整个事物的雕塑/艺术性质。代码结构和外观的美感，你通常也有更好的代码......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-04T00:58:49.020

Harold Cohen的计算机程序[AARON](http://www.kurzweilcyberart.com/)从事艺术创作已有 30 多年。

[![](https://i.stack.imgur.com/voI3p.gif)](https://i.stack.imgur.com/voI3p.gif)
[（来源：[ucsd.edu](http://web.archive.org/web/20130704144023/http://crca.ucsd.edu/~hcohen/images/hc.gif)）]

# c# - 这是在 C# 中制作简单“调度程序”的可接受方式吗？

> ID：169274
> 
> 赞同：1
> 
> 时间：2008-10-03T23:16:21.443
> 
> 标签：c#, sql-server, scheduling

我正在.Net 中使用 C# 制作一个简单的调度程序。它所做的只是每分钟对 SQL Server 数据库中的表执行一次简单的选择语句（这不需要扩展或任何东西......数据库没有高负载）。这是我建议的实现：

```
static void Main(string[] args)
{
    while (true)
    {
        System.Threading.Thread.Sleep(timeout); // timeout is, say, 60000
        CheckTable();
    }
} 
```

这个可以吗？有什么更好的方法？

ps有人建议使用Windows Forms Timer类......但这似乎有点过分了。

干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T23:26:49.860

虽然它在技术上是合法的，但您可能最好使用计时器。它们不需要设置更多代码，您可以让运行时负责生成新线程。如果您需要在另一个程序中再次使用它，它也会造成计时器不会的性能瓶颈。

计时器将添加更多代码，因为您需要使用计时器触发事件​​。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T04:46:35.707

关闭。

1.  这将每（1分钟+调用proc的时间）运行一次。也许没关系，也许不是。如果不行，您需要减去运行时间。
2.  你应该在它周围有一个 try-catch 块。您不希望它仅仅因为临时数据库或网络问题而完全死掉。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-21T19:33:05.533

[Quartz.net](http://quartznet.sourceforge.net/)是满足时序需求的一个很好的解决方案。它很容易设置（网站上有很好的教程），并且比定时器更灵活。CronTrigger 非常强大，并且易于配置。

# visual-studio - ReSharper——对其他人来说不稳定？

> ID：169275
> 
> 赞同：4
> 
> 时间：2008-10-03T23:16:50.753
> 
> 标签：visual-studio, resharper

我在许多“必备”工具列表中看到了 Jetbrain 的 ReSharper 工具。在过去的几年里，我已经安装了几次，它让我的 Visual Studio 变得迟缓和不稳定。我通常在一两个星期后卸载它，因为它使 VS 变得不稳定，我想喜欢它，但我无法克服不稳定。

那么有什么关系呢？我运气不好？该工具是否有问题，但有用性超过了问题？那里还有其他人有麻烦吗？是否有一些麻烦的选项可以关闭？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T23:52:14.817

这些先前提出的问题应该有助于回答您的**重复**问题：

*   [你有什么技巧可以提高 resharper 和/或 Visual Studio 的性能吗？](https://stackoverflow.com/questions/23737/do-you-have-any-tips-to-improve-resharper-andor-visual-studio-performance)
*   [ReSharper 迟缓](https://stackoverflow.com/questions/84009/resharper-sluggishness)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T23:28:01.823

我所看到的在 R# 开启时使 VS 变慢的一件事是缺少 RAM 和慢速 CPU。

话虽这么说，我唯一看到缓慢的情况是在 VB 中工作时。C# 一直在飞速发展。我目前的计算机不如上一台，但它确实有 2GB 的 RAM 和双核 P4 (3.20GHz)。

可以减慢 R# 的事情是：

*   解决方案错误设置
*   有很多很多很多错误的代码
*   有很多分析错误的代码
*   也安装了 Code Rush

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T21:21:38.580

我一直有同样的问题。性能确实不错，但我的机器有 6GB 内存和四核处理器。这是不断的系统挂起、单元测试运行挂起、打开解决方案时 Visual Studio 崩溃等，这意味着我卸载了它。我确实有 Vista Business 64，但其他所有插件和程序我都可以正常工作。如果我卸载 resharper 4.1，一切都会重新开始工作。

同样，它在我的双核笔记本电脑上的表现也一样。

相比之下，Visual Assist X 似乎坚如磐石，但它没有那么多功能（虽然价格只有一半）。斯特

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T23:23:57.010

这些年来，我也经历了很多你所说的事情，但我不得不说，最近迁移到了 ReSharper 4.0 版本，很多开销已经大大减少，而且看起来相当启动功能更强大。

再试一遍。可能发生的最坏情况是什么？你会再次卸载它吗？没有大的损失。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T23:41:29.627

我发现远程缓慢的唯一一件事就是右键单击任何内容。

上下文菜单条需要很长时间才能加载，但是与它节省我重构的时间相比，我失去右键单击任何内容的时间要少得多。

# .net - #region 指令在 .NET 中真的有用吗？

> ID：169276
> 
> 赞同：18
> 
> 时间：2008-10-03T23:16:52.487
> 
> 标签：.net, coding-style

在维护了大量散布着#region 的代码（在 C# 和 VB.NET 中）之后，在我看来，这个结构只是程序员的一堆“工作”。将这些乱七八糟的东西放入代码中是可行的，然后它们会使搜索和阅读代码变得非常烦人。

有什么好处？为什么编码人员会费尽心思将其放入他们的代码中。

让我成为一个信徒！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-03T23:22:41.867

已经提出了[类似的问题。](https://stackoverflow.com/questions/5916/how-do-you-feel-about-code-folding)

但...

我会说**不再**。它最初的目的是在 .NET 的早期版本中隐藏从 WinForms*生成的代码。*对于部分课程，这种需求似乎消失了。恕我直言，它现在作为一种组织结构被过度使用，并且没有任何编译器价值。这一切都是为了 IDE。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-03T23:19:56.113

很多时候，partials 和#regions 都被用作糟糕设计的拐杖（例如类太大或试图做太多事情）。

到目前为止，我对#regions的*最佳使用是在许多不同类中看到的功能分组。*例如，具有 getter、setter、构造函数和支持字段的值对象。我很可能将这些想法分组到区域中。然而，这是否使代码更清晰或更难阅读，这是一个见仁见智的问题。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-03T23:22:53.457

[http://www.rauchy.net/regionerate/](http://www.rauchy.net/regionerate/) - 自动区域化你的代码；）

我喜欢将大类的部分分组的区域，比如所有属性、所有常量等。我是一个不断折叠代码的人，我当时不需要看到，所以我喜欢区域。

此外，我发现区域在实现接口时非常有用，尤其是多个接口。我可以对每个接口的方法、属性、事件等进行分组，以便一目了然地查看哪个方法属于哪个接口。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-04T01:07:23.387

我一直在使用它们。同样，就像其他任何东西一样，它们既可以用于邪恶，也可以用于善良，当然可以成为糟糕设计的标志，但它们可以用来帮助很好地组织代码。

```
#region Properties

#region Update Section

#region Accessors 
```

当然你应该避免杰夫的例子

```
#Sweep under carpet 
```

正如 Jeff 指出的那样，我觉得它们的奇怪之处在于它们是用于 ui 目的的编译器预处理器命令。我敢肯定 VS 团队可以用另一种方式做同样有用的事情。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-17T19:05:13.987

我们的业务对象都有区域——我们喜欢它们。

我们有;

*   业务属性和方法
*   共享方法
*   构造函数
*   授权
*   数据访问
*   活动

根据我们正在处理的业务对象的类型（订阅者等），我们还有一些其他的

对于许多类来说，区域只是妨碍 - 但对于我们的标准业务对象，它们为我们节省了大量时间。这些业务对象是代码生成的，因此它们非常一致。如果它们不是，可以比杂乱的东西更快地到达我想要的地方，并且一致性使得找到彼此的东西变得容易。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-07-30T21:48:04.073

我通常不使用代码区域，除非在一种特定情况下 - 依赖属性。尽管在大多数方面使用依赖属性都是一种乐趣，但它们的声明令人眼花缭乱，并且很快就会使您的代码变得混乱。（好像管理 GUI 代码还不够挑战……）

我喜欢为该区域指定与 CLR 属性声明相同的名称（将其复制/粘贴到其中）。这样，您可以在折叠时看到范围、类型和名称——这实际上是您 95% 的时间所关心的。

```
 #region public int ObjectDepthThreshold

    public int ObjectDepthThreshold
    {
        get { return (int)GetValue(ObjectDepthThresholdProperty); }
        set { SetValue(ObjectDepthThresholdProperty, value); }
    }

    public static readonly DependencyProperty ObjectDepthThresholdProperty = DependencyProperty.Register(
        &quot;ObjectDepthThreshold&quot;,
        typeof(int),
        typeof(GotoXControls),
        new FrameworkPropertyMetadata((int)GotoXServiceState.OBJECT_DEPTH_THRESHOLD_DEFAULT,
            FrameworkPropertyMetadataOptions.AffectsRender,
            new PropertyChangedCallback(OnControlValueChanged)
        )
    );

    #endregion 
```

当它倒塌时，你只会看到

```
public int ObjectDepthThreshold 
```

如果我有多个依赖属性，我喜欢在下一行开始下一个#region。这样一来，您最终将所有这些都分组到您的班级中，并且代码紧凑且可读。

顺便说一句，如果您只想查看声明，请将鼠标悬停在它上面。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-03T23:27:46.647

继续 Russell Myers 之前所说的，如果你学会了如何正确地重构你的代码（熟练的开发人员必须学习的技能），那么对区域的需求真的不是太大。

几周前，我认为区域很棒，因为它们允许我隐藏我的胖代码，但是在锻炼了我的代码技能之后，我能够让它变得更苗条，现在我适合 7 号班（有人应该做一个测量用于未来的重构！:P)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-04T00:41:13.877

我发现除了最简单的用途之外，它们都混淆了代码。我们在项目中提倡的唯一用途是 IDE 使用的用途（接口实现和设计器代码）。

正确的工具应该用于正确的目的。应该编写代码以显示意图和功能，而不是任意分组事物。将事物组织成访问修饰符分组或其他分组似乎是不合逻辑的。我发现代码应该以对特定类有意义的方式组织；毕竟，还有其他工具可以通过访问修饰符查看类成员。几乎所有其他使用区域的情况也是如此；有一个更好的办法。

例如，将属性、事件、常量或其他方式分组在一起并没有真正意义，因为如果将事物按功能分组在一起，代码通常更易于维护（例如，使用常量的属性应该接近该常量，而不是靠近其他不相关的属性，只是因为它是属性）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-13T16:16:01.523

有时您的方法必须很长，尤其是在 Web 开发方面。在这些情况下（例如，当我有一个绑定了大型复杂对象的 gridview 时）我发现使用区域很有用：

```
#region Declaring variables for fields and object properties

#region Getting the fields in scope

#region Getting the properties of the object

#region Setting Fields 
```

这些是可以分解的方法的离散部分，但这会很困难（我必须使用范围比我喜欢的更大的变量，或者将很多变量作为“输出”传递），而且它是基本的管道。

在这种情况下，区域是完全可以接受的。在其他情况下，它们是不必要的。

我还将使用区域将方法分组为逻辑组。为此我拒绝部分类，因为我在调试时倾向于打开很多页面，并且对象（或页面或对话框）中的部分类越少，我可以拥有的就越多我的标签列表（我限制为一行，以便我可以看到更多代码）。

区域仅在用作拐杖或覆盖不良代码时才会出现问题（例如，如果您在同一范围内将区域相互嵌套，这是一个不好的迹象）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-13T16:39:08.840

我经常使用它们*而不是注释*来对类主体中的功能组进行排序，例如“配置公共接口”、“状态公共接口”、“内部处理”和“内部工作线程管理”。

使用键盘快捷键“折叠到定义”和“展开当前块”，我可以轻松导航更大的类。

不幸的是，C++ 的区域被破坏了，MS 认为不需要修复它。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-17T19:14:29.570

我讨厌过度使用这些。我发现它们有用的唯一想法是隐藏你可能再也不想看到的东西。再说一次，这些东西可能应该在某个图书馆里。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-03T23:34:07.460

它们可能被过度使用，但我喜欢它们用于分隔私有方法、公共方法、属性和实例变量。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-04T01:01:09.967

与任何语言功能一样，区域有可能被误用和滥用，但它们也有其好处。

它们非常适合创建“折叠”组：

*   方法，特别是如果你有很多重载方法
*   接口实现
*   运算符重载

您还可以使用它对属性、公共/私有方法、事件、类范围的变量等进行分组。

我在我的代码中使用区域来帮助在我的代码中创建一致的结构，所以我总是一目了然地知道事情在哪里。是的，在重构或添加新功能时（尤其是在由 Visual Studio 自动生成时），这会使事情变得更加困难，但我觉得为了保持一致和结构​​化而付出的代价很小。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-13T16:37:35.100

不错的答案，我同意他们的观点，他们说它有时反映了糟糕的编码和设计，但如果您使用 SandCastle 创建文档（MSDN 风格），#region 实际上很有用。假设您有一个公共 API，并且您想提供一些基类的用法示例。然后，您将正确记录您的公共方法并添加一个示例区域，您可以在其中复制和粘贴一些代码。问题在于，当/如果您的基类发生更改时，您最终应该更改示例。更好的解决方案是在您的解决方案中包含一个示例代码项目并一起构建它，因此每次构建解决方案时，如果示例代码不是最新的，它将无法编译。那么，这与您现在要问自己的地区有什么关系。看看这个样本：

```
/// <example>
    /// The following code sample is an implementation of LoadPublishedVersion() for XmlPageProvider.
    /// <code source="../CodeSamples/EPiServerNET/PageProvider/XmlPageProvider.cs" region="LoadPublishedVersion" lang="cs"/>
    /// </example> 
```

请注意，有一个指向您希望在文档中作为示例公开的方法的源代码示例文件和区域的链接。[看这里的结果](http://sdk.episerver.com/library/cms5/html/M_EPiServer_Core_PageProviderBase_LoadPublishedVersion_1.htm)。该方法需要位于适当的区域，并将自动包含在您的文档中。这就是为什么我还不会扔掉#region。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-23T16:00:53.450

我喜欢地区，因为它可以帮助我专注于我正在做的事情。即使该类只有一个方法，我也会使用它们。

我使用已经预先填充区域的代码片段，这样可以减少输入。我觉得这门课更有条理，并且做了 Code Complete 所说的让其他人更好地阅读。编译器只是忽略它们，它们现在是为了使代码更具可读性。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-03T23:23:19.243

真的没什么好处。它们是一种代码气味。使用了一段时间后，我厌倦了它们。如果您需要按功能分解事物，请使用分部类。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-03-24T09:15:43.073

我的工作日从在编辑器中打开文件并单击“全部展开”以隐藏所有区域开始。之后我就可以开始工作了。

# generics - 我可以在没有 UncheckedException 的情况下使用 Collections.EMPTY_LIST 吗？

> ID：169277
> 
> 赞同：15
> 
> 时间：2008-10-03T23:16:54.047
> 
> 标签：generics, java

在我的 Java 程序中是否有使用 Collection.EMPTY_LIST 的泛型友好方式。

我知道我可以自己声明一个，但我只是想知道 JDK 中是否有办法做到这一点。

就像是`users = Collections<User>.EMPTY_LIST;`

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-03T23:18:55.023

通过执行以下操作：

```
List<User> users = Collections.emptyList(); 
```

由于赋值的左侧，返回列表的类型`Collections.emptyList();`将被*推断*为 a 。`String`但是，如果您不想进行此推断，则可以通过执行以下操作显式定义它：

```
List<User> users = Collections.<User>emptyList(); 
```

在这个特定的例子中，这对大多数人来说可能看起来是多余的（事实上，我在野外看到的代码很少使用显式类型参数），但是对于具有签名的方法：`void doStuff(List<String> users)`它会非常干净使用显式类型参数调用`doStuff()`如下：

```
doStuff(Collections.<String>emptyList()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T23:20:24.383

```
List<User> users = Collections.emptyList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T23:02:14.587

创建空列表后，我建议将其存储为常量，而不是每次都创建一个新列表。

`Collections.emptyList()`此外，使用vs也有性能优势`new ArrayList(0)`，尽管差异可能很小。emptyList() 返回的列表被优化为不可变的空列表。例如，size() 方法只返回 0，而不是字段查找或 ArrayList 所做的任何事情。

# mod-rewrite - 如何让 modrewrite 不将规则应用于特定文件夹？

> ID：169278
> 
> 赞同：1
> 
> 时间：2008-10-03T23:17:30.440
> 
> 标签：mod-rewrite

如何让 modrewrite 完全忽略 /vip/ 目录，以便所有请求直接传递到该文件夹​​？

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^vip/.$ - [PT]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

另请参阅[如何忽略 mod_rewrite 中的目录？](https://stackoverflow.com/questions/163302/how-do-i-ignore-a-directory-in-modrewrite) - 重新发布是因为我第一次对这个问题不够清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T23:46:11.927

代替：

```
RewriteRule ^vip/.$ - [PT] 
```

和：

```
RewriteRule ^vip/.*$ - [PT,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-11T22:34:33.417

我在需要时执行此操作的简单方法是将新的 .htaccess 文件添加到该文件夹​​并放入

```
RewriteEngine Off 
```

编辑以修复错字

# .net - 了解 dll 以及它们在 Visual Studio 中的工作方式

> ID：169287
> 
> 赞同：6
> 
> 时间：2008-10-03T23:19:40.593
> 
> 标签：.net, visual-studio, dll

有没有人有关于 dll 的良好资源以及它们是如何在 Visual Studio 中使用/生成的？我比较模糊的几个问题具体是：

*   刷新文件的工作原理
*   dll版本号是如何生成的
*   按项目添加引用与浏览特定dll之间的区别

也欢迎任何其他提示。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-04T03:16:36.090

*.NET DLL*

.NET DLL 的通用术语是程序集。它们是单个部署的原子单元，由一个或多个 CLR“模块”组成（对于大多数开发人员来说，通常只有一个，除非他们正在组合来自两种或多种语言的编译器输出）。程序集包含 CIL 代码和 CLR 元数据，例如程序集清单。

**.refresh 文件**

.refresh 文件是简单的文本文件，它告诉 VS 在哪里检查引用的 dll 的新版本。它们用于基于文件的 Web 项目，其中没有项目文件来存储此信息。

**版本号**

.NET 程序集版本号由程序集范围属性 AssemblyVersion 生成，该属性通常位于名为“AssemblyInfo.cs”的源文件中（从 VS2005 开始，位于名为“Properties”的项目文件夹下）。版本号由 major.minor.build.revision 组成，例如 -

[组装：组装版本（“1.0.0.0”）]

AssemblyVersion 用作程序集标识的一部分（即以其强名称），并在绑定过程和版本策略决策期间发挥重要作用。

例如，如果我在 GAC 中有两个同名的程序集，则 AssemblyVersion 属性将区分它们以加载特定版本的程序集。

AssemblyVersion 编号可以手动固定和递增，或者您可以通过指定允许编译器为您生成构建和修订编号：

[assembly: AssemblyVersion("1.0\. `*`")] - 生成版本号和修订号
[assembly: AssemblyVersion("1.0.0\. `*`")] - 生成修订号

如果 AssemblyVersion 属性不存在，则版本号默认为“0.0.0.0”。

AssemblyVersion 属性的值成为程序集清单的一部分，而 AssemblyFileVersion 属性值不会。

AssemblyFileVersion 属性用于将 Win32 文件版本嵌入到 DLL 中。如果不存在，则使用 AssemblyVersion。它与 .NET 程序集加载器/解析器如何选择要加载的程序集版本无关。

**项目参考与 DLL 浏览**

如果您要添加项目引用，则意味着引用的项目将成为您的解决方案的一部分。通过能够直接进入您引用的项目代码，这使得调试变得更简单。如果您只添加一个 dll 引用，那么您将无法享受项目作为解决方案的一部分以及能够进入解决方案中的代码的好处。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T23:30:20.947

有关一些背景信息，请参阅有关[DLL 信息的问题。](https://stackoverflow.com/questions/124549/dll-information)

非托管 DLL 的版本号存储在 DLL 的 rc 文件中，与 exe 相同。对于托管 DLL，我相信它使用 AssemblyFileInfo 属性，通常在 AssemblyInfo.cs 中用于 Visual Studio 生成的项目：

```
[assembly: AssemblyFileVersion("1.0.0.0")] 
```

如果您按项目添加引用，那么 VS 将能够将引用程序集的正确风格（调试/发布）复制到您的输出目录。它还可以使用此信息在项目之间隐式添加依赖关系，以便以正确的顺序构建。

# java - 有哪些好的 java make 实用程序？

> ID：169293
> 
> 赞同：11
> 
> 时间：2008-10-03T23:21:51.540
> 
> 标签：java, ant, makefile

我正在寻找用于构建大型 java 程序的 make 实用程序。我已经知道 ANT，但想看看还有什么可用的。

理想情况下，它应该能够处理破坏 GNU Make 的 .java->.class 包目录怪异。

Win32，但跨平台是加分项。

**编辑：** 我看到使用 ANT 的一些缺点，这就是为什么我想查看其他选项的原因，尽管我可能最终还是会使用它，只是因为它有效。

*   需要非平凡的 XML makefile，“HelloWorld”已经 25 行，任何更合理的程序都会很快变大。
    *   ant 教程显示了 ant build.xml 文件的比较，这些文件与只运行所有 java 命令的大型 .bat 文件大致相同，只是时间更长。[http://ant.apache.org/manual/tutorial-HelloWorldWithAnt.html](http://ant.apache.org/manual/tutorial-HelloWorldWithAnt.html)，我已经有了其中之一。
    *   Xml 意味着每一个依赖、变量、目标、规则和项目都有多余的东西，它只会让行变得难以阅读。[尖括号税](http://www.codinghorror.com/blog/archives/001114.html)
*   为我解决了所有错误的问题。
    *   ant 使编写 jar 和 javac 命令行更容易，更容易生成清单，更容易指定 .java 源文件，更容易指定 jvm/java 属性，更容易编写自定义构建工具。
    *   ant 并没有使 java 类依赖更容易，而且似乎没有更强大的变量系统，这两件事通常都可以通过 make 实用程序来解决。

我会使用 gnu make，但它无法确定带有包声明的 .java 文件的 .class 文件将在哪里结束。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-04T00:16:45.407

Ant 和 Maven 绝对是两个标准。如果您已经熟悉 Ant 并希望使用 Maven 附带的依赖管理，您可以看看[Ivy](http://ant.apache.org/ivy)。

Ant 和 Maven 都缺乏的一件事是构建脚本中的真正控制结构。您可以为 Ant 下载一些插件来提供一些这种控制，但是（同样，如果您已经熟悉 Ant）您可以看看[Gant](http://gant.codehaus.org/)，它是 Ant 的 Groovy 包装器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-03T23:27:36.910

如果您正在开始一个新项目，您可能需要研究[maven](http://maven.apache.org/)。起初有点难，但它为你处理了一堆东西，包括依赖关系。

如果您已经有一个项目要为其创建构建文件*，*那么除了上述 ant 之外，我没有任何建议。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-03T23:48:01.440

**忘记蚂蚁！！**

[如果你问我， Apache Maven](http://maven.apache.org/)就是你要走的路。

我最喜欢的功能是它内置在依赖管理中。这意味着您不必将第 3 方 JAR 签入您的源代码控制项目。

您在 maven POM（项目对象模型 - 它基本上是项目的 XML 描述）中指定您的依赖项，然后 maven 会自动下载、编译它们并将它们与您的应用程序打包在一起。

其他非常好的功能是： 发布管理和分发发布 - 使用 maven 控制台命令执行发布。此功能将在源代码管理中标记您的代码库。签出一个干净的副本，构建它并打包它以进行部署。第二个命令会将其上传到您的存储库以分发给其他最终用户。

已经使用 maven 的大型且不断增长的库存储库 - 每个 Apache 项目都使用 maven。装载更多也在船上。[自己看，这是主要的回购](http://repo1.maven.org/maven2/)

能够托管自己的回购。- 您可以在其中发布自己的构建并上传其他公共存储库中不存在的 JAR（如大多数 SUN jar）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T23:27:49.920

这与其说是一个问题，不如说是一个答案。ANT 是构建 Java 的标准方式。它适用于 Java、无数的 Java 工具以及 Cruise Control。那么你为什么要尝试其他的东西呢？

除非您有 ANT 无法涵盖的边缘案例，否则我建议您坚持使用 ANT。

当然，我很乐意让知识渊博的人指出为什么我的态度很愚蠢以及为什么有一个很好的理由来寻找替代方案；）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T23:28:46.470

如果你想要一些非常轻量级的东西，另一种选择是[scons 。](http://scons.org/)我用了一点，发现它很容易理解，特别是如果你已经知道 python 语法的话。另一种选择是[maven](http://maven.apache.org/)，但无论如何它*都不*简单。但是，它确实提供了许多附加功能，例如帮助管理文档。但是，我不会将其称为替代品；）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-08-11T10:22:56.253

**蚂蚁**多年来一直是领导者。但是它的 build.xml 是基于 xml 的，它*非常*冗长。依赖管理可以通过与**ivy**耦合来实现。

**maven**努力提供开箱即用的 ant+ivy 串联提供的东西，它在工作时很好。如果它停止这样做，并且您必须找出它与依赖管理相混淆的地方，那么它很可能是您能想象到的最糟糕的地狱。它也是 pom.xml... 是用 xml 编写的。

**sbt**是皇家 scala 构建工具，使用 ivy 进行依赖管理，并且构建文件是在 scala DSL 中编写的。相当成熟，但scala方言可能不是你喜欢的。

**buildr**构建文件在 ruby​​ 中指定。与 maven 存储库兼容，并带来它自己的依赖管理。蚂蚁集成也在那里。

**gradle**使用 groovy 作为其构建文件。除了 maven 或 ivy 支持之外，在过去使用 ivy 并且不满意之后，它现在拥有自己的依赖管理器。无缝蚂蚁集成。有迄今为止最简单的语法。

ant、ivy、maven、buildr 都是 apache 项目。

* * *

*TL;博士*

检查[**gradle**](http://www.gradle.org/)或[**buildr**](https://buildr.apache.org/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-04T09:41:04.503

除非 Maven 最近真的有所改进，否则我会避开它。除非你有某种怪物“多项目”，当然有无数的依赖。

在尝试做最简单的事情（比如将文件 FTP 到服务器）时，厌倦了查看完全无用和无用的错误后`war`，Maven 被扔掉了，Ant 尘埃落定。从那以后我再也没有回头。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-04T00:47:37.250

[马克](http://jmk.sourceforge.net/edu/neu/ccs/jmk/index.html)_ 它很原始，但非常小，您可以将其嵌入到源 .tar.gz 文件中而几乎不改变其大小。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-24T05:56:31.027

我一直在使用 ANT。这是因为我使用 Google Web Toolkit (GWT) 开发 Web 应用程序，它具有将客户端 java 编译成 java 脚本的额外步骤。有了 ant，我只需要知道 GWT 是如何工作的，然后我自己编排构建。使用 maven，我必须等到有人写插件。或者我自己写一个。有可能会出现其他不遵循通常约定的框架和工具。我不必一直寻找 maven 插件。有了 ant，我可以以透明的方式做任何我想做的事情。我也喜欢编写 xml 文件。（我必须这样做，因为我必须编写几个 - web.xml、application.xml、persistence.xml、SqlMap.xml、dataset.xml 等我的观点 _ XML 是你必须学会​​喜欢的一件事）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-03T23:33:35.120

嗯，很明显，有经典的 make（make、gmake、nmake）实用程序，还有（我认为）一些用 Ruby 或 Python 编写的构建系统。它们不是特定于 Java 的，而只是可编写脚本的构建系统。

但是 ANT 已经成为推动 8-9 年的领导者，就基础而言，它很容易上手。

过去，make from 对于编译 java 来说特别糟糕，因为它通常为每个文件单独调用 javac 编译器。ANT 不会因此而受苦，也许可以修改 make 以不这样做。但正是 ANT 的元素之一让它如此受欢迎。这简直太快了。

我很欣赏 ANT 可能不是完美的解决方案，但它确实很实用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-04T00:11:56.400

我从[Ant](http://ant.apache.org)转换为[Maven 2](http://maven.apache.org)，从那以后就没有回头。Ant 和 Maven 2 种不同的构建方式。使用 Ant，您将提供有关如何构建事物的说明。而使用 Maven 2，您可以告诉它您想要构建什么。如果您有一个现有的 Ant 构建，xml，您可以通过将其包装在 Maven 2 pom.xml 中来重构您构建的第一步。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-04T02:19:48.013

1) ant + ivy 如果你有对 ant 的现有投资，那是相当不错的。您不必仅仅为了依赖项而从 ant 迁移到 maven。

2) gant 和 ant：他们如何比较： http: [//java.dzone.com/articles/ant-or-gant-part-1](http://java.dzone.com/articles/ant-or-gant-part-1)

3) [http://www.gradle.org/](http://www.gradle.org/) -- 使用 groovy！

BR，
~A

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-13T21:02:16.470

我喜欢将 ant 与 ant4eclipse 一起使用。这允许我在 eclipse 中设置依赖关系，在 eclipse 中进行开发构建和测试，并使用 ant 进行持续构建。

# ruby - 如何在安全的沙箱中运行不受信任的 Ruby 代码？

> ID：169303
> 
> 赞同：17
> 
> 时间：2008-10-03T23:26:42.433
> 
> 标签：ruby

我希望能够运行不受信任的 ruby​​ 代码。我希望能够将变量传递给它可能使用的所述不受信任的代码。我还希望所述代码向我返回结果。这是我在想的一个概念性示例

```
input = "sweet"
output = nil
Thread.start {
   $SAFE = 4
   #... untrusted code goes here, it uses the input variable(s)
   #to calculate some result that it places in the output variable
}
#parse the output variable as a string. 
```

澄清一下，我基本上是在使用不受信任的代码作为函数。我想提供它的一些输入，然后允许它写入输出。这就是我真正想要的，我不在乎它是如何完成的，我只希望能够使用不受信任的 Ruby 代码作为一种功能。解决方案不必看起来像我上面写的代码，我只是用它来说明我想要什么。

现在，我目前可以想到 3 种方法来做到这一点：

1.  使用上面的 $SAFE 级别构造。
2.  为什么theluckystiff 有一个用于 ruby​​ 的 Sandbox 插件
3.  我可以在自己的虚拟机中运行每个功能，使用某种操作系统虚拟化软件，如 vmware 或 Xen 之类的。

我想知道是否有人对以功能方式运行不受信任的 ruby​​ 代码有任何建议？你会推荐什么选择？你会怎么做？谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-04T06:49:43.837

$SAFE 还不够；你至少需要达到Why's怪异沙盒的水平。但是，我不知道该沙盒代码是否得到积极维护，或者他/他们是否解决了诸如无限循环等漏洞。

不安全通常意味着敌对。如果您可以从敌意放松到“天真”，并且根据您的应用程序的要求，您可能会在 Ruby 中使用沙盒。这并不是语言设计中的一流场景。

尽管如此，您可能不需要进入机器级别的分离。在单独生成的进程中使用沙箱我会感到非常安全，您的应用程序充当进程管理器来杀死任何设法挂起/燃烧的东西。现在，这比上面的简单块要多几个数量级。

但请记住并不断重复，“SAFE 无法应对敌对行为”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-20T21:20:45.337

我强烈建议只使用 JRuby。

JVM 从一开始就内置了一个非常强大的安全模型，而 JRuby 也利用了它。您可以限制对文件的访问、限制代码的加载等等。它比原生 Ruby 实现中存在的任何东西都要*好得多*，并且有许多站点在 JRuby 上运行沙盒、用户可访问的站点正是为此目的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-27T18:11:42.787

`$SAFE`不能保护您免受恶意黑客可以做的一切。

沿着这条路走下去（请参阅[Ruby：创建沙盒评估？](https://stackoverflow.com/questions/6074915/ruby-creating-a-sandboxed-eval)），我遵循评论者的明智建议并嵌入了一个特定于应用程序的解释器，它让我可以完全控制可以做什么和不可以做什么（请参阅[Ruby：寻找 ruby - 嵌入式解释器或脚本语言](https://stackoverflow.com/questions/6100616/ruby-looking-for-ruby-embeddable-interpreter-or-scripting-language)）。

事实证明，使用 Stickup 非常容易（比如从下载 gem 到定制解释器不到一个小时）——参见[https://github.com/jcoglan/stickup](https://github.com/jcoglan/stickup)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-31T23:21:45.700

我创建了一个名为“trusted-sandbox”的 gem，它在完全受控的 Docker 容器中运行 Ruby 代码。您可以禁用网络、设置磁盘配额、限制执行时间、平衡 CPU 与其他正在运行的容器、设置内存限制等。而且开销非常低。

你可以在这里阅读更多关于它的信息： [https ://github.com/vaharoni/trusted-sandbox](https://github.com/vaharoni/trusted-sandbox)

让我知道你的想法！

# java - 使用插件扩展 Java Web 应用程序

> ID：169329
> 
> 赞同：7
> 
> 时间：2008-10-03T23:37:34.113
> 
> 标签：java, tomcat, servlets, modularity

我有这个 Web 应用程序已经发展到无法管理的混乱状态。

我想把它分成一个通用的“框架”部分（仍然包括网页和图像等网页内容）和几个添加额外功能和屏幕的模块。我希望这种重构也可以用作第三方扩展的插件系统。

所有模块都需要是单独的部署单元，最好是 war 或 jar 文件。

我试图只制作几个常规的战争文件，但 Tomcat 将（根据 servlet 规范）这些战争文件彼此完全分开，例如，它们不能共享它们的类。

我需要插件才能看到“主”类路径。

我需要主应用程序对插件进行一些控制，例如能够列出它们并设置它们的配置。

我想保持插件本身（除非它们指定依赖项）和任何其他可能在同一个 Tomcat 上运行的不相关 Web 应用程序之间的完全分离。

我希望它们植根于“主”应用程序 URL 前缀下，但这不是必需的。

我想使用 Tomcat（大型架构更改需要与太多人协调），但也想了解 EJB 或 OSGi 世界中的干净解决方案（如果有）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T23:44:23.710

我一直在修改使用 OSGi 来解决您所描述的相同问题的想法。特别是我正在考虑使用[Spring Dynamic Modules](http://www.springframework.org/osgi)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T09:40:01.463

看一下 Java Portlets - [http://developers.sun.com/portalserver/reference/techart/jsr168/](http://developers.sun.com/portalserver/reference/techart/jsr168/) - 简而言之，这是一个允许在其他自包含的 j2ee Web 应用程序之间实现互操作性的规范

**编辑** 我忘了提到 Portlet 几乎与框架无关——因此您可以将 Spring 用于父应用程序，并且各个开发人员可以在他们的 Portlet 上使用他们想要的任何东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T23:47:16.747

您是否考虑过使用 maven 来分离您的项目，然后让它解决 WAR 和 JAR 之间的依赖关系？您最终会在 WAR 之间重复库，但仅限于必要的地方（除非您进入一些时髦的类加载器乐趣，否则这不应该成为问题）。

如果您需要以相对透明的方式从一个 WAR 到另一个 WAR，Tomcat 还允许您配置跨上下文应用程序...

如果您想将事物保留在同一个 Web 应用程序（例如 ROOT）下，您可以创建一个代理 Web 应用程序，该代理 Web 应用程序在幕后转发到相关的其他 Web 应用程序，以便用户使其相对透明？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T23:49:10.347

您的主要问题将集中在系统的物理、静态资产上——其余的都是简单有效的罐子。

在 Tomcat 中，WAR 与单独的类加载器分开，但它们也在会话级别分开（每个 WAR 都是一个单独的 Web 应用程序，并且有自己的会话状态）。

在 Glassfish 中，如果 WAR 捆绑在 EAR 中，它们将共享类加载器（GF 在 EAR 中使用平面类加载器空间），但仍具有单独的会话状态。

另外，我不确定您是否可以“转发”到服务器中的另一个 WAR。问题在于转发使用 Web App 根目录的相对 URL，并且每个 WebApp 都有自己的根目录，因此您根本“无法从这里到达那里”。您可以重定向，但这与转发不同。

因此，Web 应用程序的这些功能会阻止您尝试在容器中同质部署它们。

相反，我认为热门提示是创建一个“汇编器”实用程序，它将您的各个模块“合并”到单个 Web 应用程序中。它可以合并它们的 web.xml、它们的内容、规范化 jar 和类等。

WAR 是 Java 世界中的一个特性和一个错误。我喜欢它们，因为它们确实在安装它们时确实使部署编译的应用程序“拖放”，并且该功能的使用远比您遇到的要多。但我感觉到你的痛苦。我们有一个跨应用程序共享的通用“核心”框架，我们基本上必须不断地合并它来维护它。我们已经编写了脚本，但它仍然有点痛苦。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-04T02:24:46.990

“另外，我不确定你是否可以“转发”到服务器中的另一个 WAR。问题是转发使用 Web App 根目录的相对 URL，每个 WebApp 都有自己的根目录，所以你只是“无法从这里到达那里”。你可以重定向，但这与前锋不同。

只要该 WAR 允许某人这样做，您就可以转发到另一个 WAR。

glassfish 和 EAR 的多个 WAR：这是有道理的。

如果将 MAIN 类放在 tomcat 的共享 CLASSPATH 中，则可以将各个 PLUGIN 放在单独的 WAR 文件中。

主应用程序也可以是您在 server.xml 中定义的 TOMCAT servlet 的一部分。这可以是 MASTER SERVLET，所有其他 WAR 都可以由这个主 servlet 控制。

那有意义吗 ？

BR，
~A

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-04T09:27:48.680

根据插件功能的复杂性，我还将考虑使用 Web 服务，例如使用 Axis 实现。

然后使用提供服务的 Web 应用程序（插件）的 URL 配置您的主应用程序。

在我看来，优势是双重的：

*   在两次战争之间，您会得到一个漂亮、干净、可调试的 API，即 Soap/XML 消息
*   您可以升级单个插件，而无需对整个应用程序进行回归测试

缺点是您必须设置一些 Axis 项目，并且您必须进行某种插件配置。此外，您可能需要限制对服务 Web 应用程序的访问，因此可能需要进行一些配置。

如果插件在同一个数据库上工作，请确保限制缓存时间或配置跨战争缓存层。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-22T12:58:22.153

我也一直在尝试开发一个通用或抽象的框架，在其中我可以在运行时添加插件（或模块）并增强现有的正在运行的 webapp。

现在，正如您所说，首选 ed 使用 WAR 或 JAR 文件的方法。WAR 文件的问题是，您不能作为插件部署到现有应用程序。Tomcat 会将其部署为单独的 Web 上下文。不可取。

另一种选择是 JAR 文件并编写一些自定义代码以将该 JAR 文件复制到 WEB-INF/lib 文件夹并将类加载到现有的类加载器中。问题是，如何部署 JSP 或配置文件等非 java 文件。为此，有两个解决方案，a。使用速度模板而不是 JSP (b.) 编写一些自定义代码来从类路径而不是上下文路径中读取 JSP。

OSGI 或 Spring Dynamic 模块很不错，但目前对我来说它们看起来过于复杂。如果我感觉到它，我会再次研究它。

我正在寻找简单的 API，它可以处理插件的生命周期，并且仍然能够在我打包的 JAR 文件中使用 JSP。

可能是，您可以在部署时使用 un jar 插件并将文件复制到正确的目录。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-15T20:59:29.663

如果您正在考虑将应用程序拆分为单独的模块，那么实际上没有什么比 OSGI 更好的了。看一下 Greenpages 示例。您可以创建一个父模块（核心），其中包含应用程序需要的 jar。

如果您对组件编程有所了解，您很快就会发现 OSGI 模块的行为类似于接口，您必须在其中公开您将在其他模块中使用的内容。一旦你明白了，这很简单。无论如何，当您学习如何使用 OSGI 时也会非常痛苦。我们在使用 JSON 时遇到了问题，作为我们作为 jar 添加到模块中的 Jackson 版本，被 Spring 核心模块中包含的其他 jar 覆盖。您总是必须仔细检查您需要加载的 jar 版本。

不幸的是，即使是 OSGI 方法也不能解决我们正在寻找的问题。如何在运行时扩展持久模型和现有表单。

# c# - 以编程方式获取所有存储过程的简单方法

> ID：169330
> 
> 赞同：12
> 
> 时间：2008-10-03T23:37:55.593
> 
> 标签：c#, sql-server, sql-server-2005, stored-procedures

有没有办法使用 C# 从 SQL Server 2005 Express 数据库中获取存储过程？我想以与您可以使用 SQL Server Management Studio 编写脚本相同的方式导出所有这些数据，而无需安装 GUI。

我已经看到了一些通过 PowerShell 进行操作的参考，但最终我真正想要的是 C# 控制台应用程序。

***澄清....***

我想编写存储过程的脚本。通过 的列表`Select * from sys.procedures`很有帮助，但最后我需要编写每个脚本。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-04T00:56:38.820

您可以为此使用 SMO。首先，将这些程序集的引用添加到您的项目中：

*   Microsoft.SqlServer.ConnectionInfo
*   微软.SqlServer.Smo
*   Microsoft.SqlServer.SmoEnum

它们位于 GAC 中（浏览到 C:\WINDOWS\assembly 文件夹）。

使用以下代码作为脚本存储过程的示例：

```
using System;
using System.Collections.Generic;
using System.Data;
using Microsoft.SqlServer.Management.Smo;

class Program
{
   static void Main(string[] args)
   {
      Server server = new Server(@".\SQLEXPRESS");
      Database db = server.Databases["Northwind"];
      List<SqlSmoObject> list = new List<SqlSmoObject>();
      DataTable dataTable = db.EnumObjects(DatabaseObjectTypes.StoredProcedure);
      foreach (DataRow row in dataTable.Rows)
      {
         string sSchema = (string)row["Schema"];
         if (sSchema == "sys" || sSchema == "INFORMATION_SCHEMA")
            continue;
         StoredProcedure sp = (StoredProcedure)server.GetSmoObject(
            new Urn((string)row["Urn"]));
         if (!sp.IsSystemObject)
            list.Add(sp);
      }
      Scripter scripter = new Scripter();
      scripter.Server = server;
      scripter.Options.IncludeHeaders = true;
      scripter.Options.SchemaQualify = true;
      scripter.Options.ToFileOnly = true;
      scripter.Options.FileName = @"C:\StoredProcedures.sql";
      scripter.Script(list.ToArray());
   }
} 
```

另请参阅：[SQL Server：SMO 脚本基础](http://blogs.msdn.com/mwories/archive/2005/05/07/basic-scripting.aspx)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-03T23:46:59.930

只需从 SYS.PROCEDURES 读取 SELECT NAME 的输出，然后为每个存储过程调用 EXEC sp_HelpText SPNAME，您将获得每行一行文本的记录集。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-06T15:01:50.440

```
;WITH ROUTINES AS (
    -- CANNOT use INFORMATION_SCHEMA.ROUTINES because of 4000 character limit
    SELECT o.type_desc AS ROUTINE_TYPE
            ,o.[name] AS ROUTINE_NAME
            ,m.definition AS ROUTINE_DEFINITION
    FROM sys.sql_modules AS m
    INNER JOIN sys.objects AS o
        ON m.object_id = o.object_id
)
SELECT *
FROM ROUTINES 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T23:42:32.357

[此博客文章](http://blog.sqlauthority.com/2007/11/27/sql-server-2005-list-all-stored-procedure-in-database/)建议对您的数据库运行此操作：

```
select * from sys.procedures 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-08T15:31:15.637

您可以使用：

```
DataTable  dtProcs = sqlConn.GetSchema("Procedures", new string[] { databaseName });
DataTable  dtProcParams = sqlConn.GetSchema("ProcedureParameters", new string[] { databaseName }); 
```

如果需要，您还可以获得各种其他模式信息，如表、索引等。

您可以在此处获取有关 GetSchema()的信息，并在[此处](http://msdn.microsoft.com/en-us/library/kcax58fh.aspx)获取有关 SQL Server 架构集合的[信息](http://msdn.microsoft.com/en-us/library/ms254969.aspx)

编辑：对不起，这对实际编写信息没有帮助，但我想这是有用的信息。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-26T16:11:25.497

```
public static void GenerateTableScript()
    {
        Server databaseServer = default(Server);//DataBase Server Name
        databaseServer = new Server("yourDatabase Server Name");
        string strFileName = @"C:\Images\Your FileName_" + DateTime.Today.ToString("yyyyMMdd") + ".sql"; //20120720`enter code here
        if (System.IO.File.Exists(strFileName))
            System.IO.File.Delete(strFileName);
        List<SqlSmoObject> list = new List<SqlSmoObject>();
        Scripter scripter = new Scripter(databaseServer);
        Database dbUltimateSurvey = databaseServer.Databases["YourDataBaseName"];//DataBase Name
        //Table scripting Writing
        DataTable dataTable1 = dbUltimateSurvey.EnumObjects(DatabaseObjectTypes.Table);
        foreach (DataRow drTable in dataTable1.Rows)
        {
            //string strTableSchema = (string)drTable["Schema"];
            //if (strTableSchema == "dbo")
            //    continue;
            Table dbTable = (Table)databaseServer.GetSmoObject(new Urn((string)drTable["Urn"]));
            if (!dbTable.IsSystemObject)
                if (dbTable.Name.Contains("SASTool_"))
                    list.Add(dbTable);
        }
        scripter.Server = databaseServer;
        scripter.Options.IncludeHeaders = true;
        scripter.Options.SchemaQualify = true;
        scripter.Options.ToFileOnly = true;
        scripter.Options.FileName = strFileName;
        scripter.Options.DriAll = true;
        scripter.Options.AppendToFile = true;
        scripter.Script(list.ToArray());//Table Script completed
        //Store Procedures scripting Writing
        list = new List<SqlSmoObject>();
        DataTable dataTable = dbUltimateSurvey.EnumObjects(DatabaseObjectTypes.StoredProcedure);
        foreach (DataRow row in dataTable.Rows)
        {
            string sSchema = (string)row["Schema"];
            if (sSchema == "sys" || sSchema == "INFORMATION_SCHEMA")
                continue;
            StoredProcedure sp = (StoredProcedure)databaseServer.GetSmoObject(
               new Urn((string)row["Urn"]));
            if (!sp.IsSystemObject)
                if (sp.Name.Contains("custom_"))
                    list.Add(sp);
        }
        scripter.Server = databaseServer;
        scripter.Options.IncludeHeaders = true;
        scripter.Options.SchemaQualify = true;
        scripter.Options.ToFileOnly = true;
        scripter.Options.FileName = strFileName;
        scripter.Options.DriAll = true;
        scripter.Options.AppendToFile = true;
        scripter.Script(list.ToArray());   // Stored procedure Script completed
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T23:43:49.890

您可以编写 C# 代码在数据库上运行以下查询。

```
Select * from sys.procedures 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-04T00:18:14.983

我认为这是您真正想要的：

```
select SPECIFIC_NAME,ROUTINE_DEFINITION from information_schema.routines 
```

那里还有很多其他有用的列......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-18T10:25:40.767

```
begin
--select column_name from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME='Products' 
--Declare the Table variable 
DECLARE @GeneratedStoredProcedures TABLE
(
        Number INT IDENTITY(1,1), --Auto incrementing Identity column
        name VARCHAR(300) --The string value
)

--Decalre a variable to remember the position of the current delimiter
DECLARE @CurrentDelimiterPositionVar INT 
declare @sqlCode varchar(max)
--Decalre a variable to remember the number of rows in the table
DECLARE @Count INT

--Populate the TABLE variable using some logic
INSERT INTO @GeneratedStoredProcedures SELECT name FROM sys.procedures where name like 'procGen_%'

--Initialize the looper variable
SET @CurrentDelimiterPositionVar = 1

--Determine the number of rows in the Table
SELECT @Count=max(Number) from @GeneratedStoredProcedures

--A variable to hold the currently selected value from the table
DECLARE @CurrentValue varchar(300);

--Loop through until all row processing is done
WHILE @CurrentDelimiterPositionVar <= @Count
BEGIN
    --Load current value from the Table
    SELECT @CurrentValue = name FROM @GeneratedStoredProcedures WHERE Number = @CurrentDelimiterPositionVar 
    --Process the current value
    --print @CurrentValue
    set @sqlCode = 'drop procedure ' + @CurrentValue
    print @sqlCode
    --exec (@sqlCode)

    --Increment loop counter
    SET @CurrentDelimiterPositionVar = @CurrentDelimiterPositionVar + 1;
END

end 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-05T16:52:39.747

如果您在 sqlmetal.exe（从数据库生成代码的 LINQ-to-SQL 的独立部分）上打开一罐反射器，您可以看到它用于获取所有存储过程和函数列表的 SQL 语句. [SQL 与此答案中](https://stackoverflow.com/questions/169330/simple-way-to-programmatically-get-all-stored-procedures/174652#174652)的 SQL 相似，但并不完全相同。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-12-14T16:52:58.430

这是我刚刚在MSSQL中测试和使用过的SQL

```
SELECT NAME from SYS.PROCEDURES 
order by name 
```

如果您需要查找特定名称或子字符串/文本

```
SELECT NAME from SYS.PROCEDURES 
where name like '%<TEXT_TO_LOOK_FOR>%'
order by name 
```

替换为例如：

```
SELECT NAME from SYS.PROCEDURES 
where name like '%CUSTOMER%'
order by name 
```

并打电话

```
EXEC sp_HelpText SPNAME 
```

对于每个存储过程，您将获得每行一行文本的记录集

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-03-02T12:48:39.033

假设您有`SqlConnection`名为**sqlCon**的对象，最简单的方法是调用 sqlCon.GetSchema("Procedures")

# c# - C# 中是否有不在 Windows.Forms 命名空间中的计时器类？

> ID：169332
> 
> 赞同：18
> 
> 时间：2008-10-03T23:38:19.917
> 
> 标签：c#, .net, scheduling, timer

我想在我用 C# 编写的简单[.NET应用程序中使用计时器。](http://en.wikipedia.org/wiki/.NET_Framework)我能找到的唯一一个是 Windows.Forms.Timer 类。我不想仅为我的控制台应用程序引用这个命名空间。

是否有用于控制台应用程序的 C# 计时器（或类似计时器）类？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-03T23:39:02.223

System.Timers.Timer

正如 MagicKat 所说：

System.Threading.Timer

您可以在这里看到差异：http: [//intellitet.com/system-windows-forms-timer-vs-system-threading-timer-vs-system-timers-timer/](http://intellitect.com/system-windows-forms-timer-vs-system-threading-timer-vs-system-timers-timer/)

您可以在此处查看 MSDN 示例：

[http://msdn.microsoft.com/en-us/library/system.timers.timer(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.timers.timer(VS.80).aspx)

和这里：

[http://msdn.microsoft.com/en-us/library/system.threading.timer(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.threading.timer(VS.80).aspx)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-03T23:41:53.153

我会推荐命名空间[`Timer`](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)中的类[`System.Timers`](http://msdn.microsoft.com/en-us/library/system.timers.aspx)。同样有趣的是，命名空间[`Timer`](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)中的类[`System.Threading`](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)。

```
using System;
using System.Timers;

public class Timer1
{
    private static Timer aTimer = new System.Timers.Timer(10000);

    public static void Main()
    {
        aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);
        aTimer.Enabled = true;

        Console.WriteLine("Press the Enter key to exit the program.");
        Console.ReadLine();
    }

    // Specify what you want to happen when the Elapsed event is 
    // raised.
    private static void OnTimedEvent(object source, ElapsedEventArgs e)
    {
        Console.WriteLine("The Elapsed event was raised at {0}", e.SignalTime);
    }
} 
```

来自 MSDN 文档的示例。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-08-01T10:10:28.397

我知道至少有[System.Timers.Timer](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)和[System.Threading.Timer类。](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)

不过要注意的一件事（如果您以前没有这样做过），比如说您的 using 子句中已经有 System.Threading 命名空间，但您实际上想在 System.Timers 中使用计时器，您需要这样做：

```
using System.Threading;
using Timer = System.Timers.Timer; 
```

Jon Skeet 在他的多线程指南中有一篇关于定时器的文章，非常值得一读： [http ://www.yoda.arachsys.com/csharp/threads/timers.shtml](http://www.yoda.arachsys.com/csharp/threads/timers.shtml)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-03-30T16:46:10.450

这个问题很老，现有的答案很好地涵盖了当时的问题。与此同时，新的事情发生了。

## 定时器，当然，为了什么？

使用计时器是一种以一定延迟和/或定期间隔运行某些处理的方法。有两种情况：

(1) 只是定期运行一些短代码，没有任何线程问题，没有麻烦，没有混乱。如果普通的 Windows 窗体计时器不适合，那么`System.Timers.Timer`它的`SynchronizingObject`属性使它比`System.Threading.Timer`.

(2) 您正在编码的是异步并发处理领域。传统上，无论使用什么普通计时器，这都容易出错，难以调试，难以正确处理。

在情况 2 中，您可能会摆脱传统方法，但请注意，复杂性潜伏着并随时会吞噬您，而不仅仅是一次，而是任何时候您没有做出最佳选择，并具有累积效应。

## 现在我们有了更好的东西

如果您的情况涉及某种“事件”处理（无论其编码方式如何：按键、鼠标按钮、来自串行端口的字节、来自网络连接、来自测量等），您应该考虑响应式编程。

近年来，响应式编程以某种方式揭示了如何针对这些情况进行编码，同时又不陷入复杂性陷阱。

因此，从技术上讲，以下链接是对这个问题的回答：它是一个位于`System.Reactive.Linq`命名空间中的计时器：[Observable.Timer Method (System.Reactive.Linq)](https://msdn.microsoft.com/en-us/library/system.reactive.linq.observable.timer(v=vs.103).aspx)

公平地说，它是一个计时器，它与反应式编程的思维方式和许多改变游戏规则的东西配合得很好。然而，它可能是也可能不是最好的工具，具体取决于上下文。

由于这个问题是以 .NET 为中心的，您可能对[.NET Reactive Framework 的良好介绍感兴趣](https://stackoverflow.com/questions/1596158/good-introduction-to-the-net-reactive-framework)

或者对于一个清晰的、图解的、更通用的（不是以 Microsoft 为中心的）文档，这看起来不错[The Introduction to Reactive Programming you've been missing](https://gist.github.com/staltz/868e7e9bc2a7b8c1f754)。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-10-03T23:53:05.377

[System.Diagnostics.Stopwatch](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)如果您的目标是计算某项运行所需的时间

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2010-08-01T10:00:37.937

建议不要使用`System.Timer`Timer 类。

# c - 填充 - 加密算法

> ID：169334
> 
> 赞同：3
> 
> 时间：2008-10-03T23:39:43.017
> 
> 标签：c, cryptography, stream, padding

我正在编写适用于“流”的 XXTEA 加密算法的实现，即可以像这样使用：crypt mykey < myfile > 输出。

必要条件之一是它根本无法访问文件（它只读取固定大小的块，直到找到 EOF）。该算法需要数据字节是 4 的倍数，因此需要添加一个填充。

对于纯文本，一个好的解决方案是填充 NULL，在解密时忽略 NULL，但相同的策略不能用于二进制流（可以包含嵌入的 NULL）。

我已经阅读了常见的解决方案，比如用丢失的字符数填充（如果它错过了 3 个字符，然后在末尾附加一个 3、3、3）等等，但我想知道：有更优雅的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T23:44:51.900

阅读：http: [//msdn.microsoft.com/en-us/library/system.security.cryptography.paddingmode.aspx](http://msdn.microsoft.com/en-us/library/system.security.cryptography.paddingmode.aspx)

它有一个常用填充方法的列表，例如：

PKCS7 - PKCS #7 填充字符串由一个字节序列组成，每个字节等于添加的填充字节的总数。

ANSIX923 填充字符串由长度前用零填充的字节序列组成。

ISO10126 填充字符串由长度之前的随机数据组成。

例子：

原始数据：01 01 01 01 01

PKCS #7：01 01 01 01 01 03 03 03

ANSIX923 01 01 01 01 01 00 00 03

ISO10126：01 01 01 01 01 CD A9 03

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T23:52:43.723

阅读[密文窃取](http://en.wikipedia.org/wiki/Ciphertext_stealing)。可以说它比纯文本填充要优雅得多。另外，我建议使用大于 4 字节的块大小——64 位可能是最低限度。

严格来说，自己动手的密码学是一个危险的想法。很难击败整个加密社区尝试过但未能破解的算法。玩得开心，考虑阅读[这篇](http://www.schneier.com/paper-self-study.html)文章，或者至少从 Schneier 的“相关阅读”部分阅读。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T15:54:51.987

阅读这个问题，这似乎是安全方面的问题。简单地说，你有一个 api，它需要 4 个字节的倍数作为输入，而你并不总是这样。

如果您不能保证二进制流不关心，那么将最多 3 个字节附加到任何二进制流上都是危险的。将 0 附加到 exe 文件的末尾并不重要，因为 exe 文件具有指定所有剩余位的相关大小的标头。将 0 附加到 pcx 文件的末尾会破坏它，因为 pcx 文件的标头从文件末尾开始特定数量的字节。

所以你真的别无选择 - 你没有选择可以使用的魔法填充字节，这些字节保证永远不会在二进制流的末尾自然发生：你*必须*始终附加至少一个额外的双字信息来描述所使用的填充字节。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-04T00:08:26.343

实际上，我希望一个好的流密码根本不需要填充。例如，RC4 不需要填充，是一种非常强大的流密码。但是，如果攻击者可以将不同选择的数据提供给加密例程，该例程始终使用相同的密钥，并且还可以访问加密数据，则它可能会受到攻击。选择正确的输入数据并分析输出数据可用于恢复加密密钥，无需暴力攻击；但除此之外，RC4 非常安全。

如果需要填充，恕我直言，它不是流密码。好像你填充为 4 字节的倍数或 16 字节的倍数，有什么巨大的区别？如果它被填充为 16 字节的倍数，您几乎可以使用任何分组密码。实际上你的密码是一个分组密码，它只适用于 4 字节块。它是系统上的流密码，其中每个“符号”都是 4 字节（例如，当加密 UTF-32 文本时，在这种情况下，数据肯定总是 4 的倍数，因此永远不会有任何填充）。

# .net - 为什么找不到我的自定义 WCF 行为扩展元素类型？

> ID：169342
> 
> 赞同：49
> 
> 时间：2008-10-03T23:44:35.113
> 
> 标签：.net, wcf, exception-handling, wcf-extensions

我有一个包含两个项目的解决方案。一个项目是 ASP.NET Web 应用程序项目，一个是类库。Web 应用程序具有对类库的项目引用。这些都不是强命名的。

在我将称之为“框架”的类库中，我有一个端点行为（一个 IEndpointBehavior 实现）和一个配置元素（一个从 BehaviorExtensionsElement 派生的类）。配置元素使我可以通过配置将端点行为附加到服务。

在 Web 应用程序中，我有一个启用 AJAX 的 WCF 服务。在 web.config 中，我将 AJAX 服务配置为使用我的自定义行为。配置的 system.serviceModel 部分非常标准，如下所示：

```
<system.serviceModel>
 <behaviors>
  <endpointBehaviors>
   <behavior name="MyEndpointBehavior">
    <enableWebScript />
    <customEndpointBehavior />
   </behavior>
  </endpointBehaviors>
 </behaviors>
 <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
 <services>
 <service name="WebSite.AjaxService">
  <endpoint
           address=""
           behaviorConfiguration="MyEndpointBehavior"
           binding="webHttpBinding"
           contract="WebSite.AjaxService" />
  </service>
 </services>
 <extensions>
  <behaviorExtensions>
   <add
       name="customEndpointBehavior"
       type="Framework.MyBehaviorExtensionsElement, Framework, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"/>
  </behaviorExtensions>
 </extensions>
</system.serviceModel> 
```

在运行时，这可以完美运行。启用 AJAX 的 WCF 服务正确使用我自定义配置的端点行为。

问题是当我尝试添加新的 AJAX WCF 服务时。如果我添加 -> 新项目...并选择“启用 AJAX 的 WCF 服务”，我可以看到它添加 .svc 文件和代码隐藏，但是当它更新 web.config 文件时，我收到此错误：

> 配置文件不是 WCF 服务库的有效配置文件。
> 
> 无法加载为扩展“customEndpointBehavior”注册的类型“Framework.MyBehaviorExtensionsElement、Framework、Version=1.0.0.0、Culture=neutral、PublicKeyToken=null”。

显然配置是完全有效的，因为它在运行时完美运行。如果我暂时从我的行为配置中删除该元素，然后添加启用 AJAX 的 WCF 服务，一切都会顺利进行。

不幸的是，在一个更大的项目中，我们将拥有多个具有不同配置的服务，暂时删除所有自定义行为将很容易出错。虽然我意识到我可以不使用向导并手动完成所有操作，但不是每个人都可以，而且能够按照它的用途使用该产品会很好 - 向导和所有。

**为什么找不到我的自定义 WCF 行为扩展元素类型？**

更新/说明：

*   它确实在运行时工作，而不是在设计时工作。
*   当我尝试添加服务时，框架程序集位于 Web 项目的 bin 文件夹中。
*   虽然我可以手动添加服务（“无需配置”），但我需要开箱即用的项目模板才能工作——这就是问题的全部目标。
*   在 Visual Studio 2008 中可以看到此问题。**在 VS 2010 中，此问题似乎已得到解决。**

[我在 Microsoft Connect 上提交了这个问题，](https://connect.microsoft.com/wcf/feedback/ViewFeedback.aspx?FeedbackID=386511)结果你要么必须将自定义配置元素放在 GAC 中，要么将其放在 IDE 文件夹中。他们不会修复它，至少现在是这样。我已经发布了他们提供的解决方法作为这个问题的“答案”。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-14T15:54:44.057

根据Microsoft 在我为此提交[的 Connect 问题上发布](http://connect.microsoft.com/wcf/feedback/ViewFeedback.aspx?FeedbackID=386511)[的解决方法](http://connect.microsoft.com/wcf/feedback/Workaround.aspx?FeedbackID=386511)，这是一个已知问题，至少在当前版本中不会有任何解决方案：

> 添加新服务项失败的原因：添加新项和更新配置文件时，系统会尝试加载配置文件，因此会尝试在该配置文件中搜索并加载cusom扩展的程序集。只有在程序集被GACed或与vs exe位于同一路径（Program Files\Microsoft Visual Studio 9.0\Common7\IDE）的情况下，系统才能找到它。否则，将弹出错误对话框，“添加新项目”将失败。
> 
> 我理解你的痛点。不幸的是，我们无法在当前版本中进行此更改。我们将在以后的版本中对其进行调查并尝试提供更好的解决方案，例如提供浏览对话框以使客户能够指定路径，或者提供更好的错误消息以指示一些解决方案等...
> 
> 您可以在当前阶段尝试解决方法：GAC 您的自定义扩展程序集或将其复制到“Program Files\Microsoft Visual Studio 9.0\Common7\IDE”吗？
> 
> 我们将提供自述文件以帮助可能遇到相同问题的其他客户。

不幸的是，看来我在这方面不走运。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-07-26T04:08:28.733

作为对这些天偶然发现此问题的任何人的仅供参考，一个可能的解决方案是在您的 app.config/web.config 中完全限定您的程序集。EG 如果你有

```
<system.serviceModel>
    <extensions>
        <behaviorExtensions>
            <add name="clientCredential" type="Client.ClientCredentialElement, Client" />
        </behaviorExtensions>
    </extensions> 
```

尝试 - 将值替换为必要的

```
<system.serviceModel>
    <extensions>
        <behaviorExtensions>
            <add name="clientCredential" type="Client.ClientCredentialElement, Client, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
        </behaviorExtensions>
    </extensions> 
```

这个特殊的解决方案对我有用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-24T13:38:51.563

我刚用

```
[assembly: AssemblyVersion("1.0.*")]
//[assembly: AssemblyVersion("1.0.0.0")]
//[assembly: AssemblyFileVersion("1.0.0.0")] 
```

所以我每次都有新的装配版本号。

但是我们有

```
 <add name="clientCredential" type="Client.ClientCredentialElement, Client, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" /> 
```

其中**版本 = 1.0.0.0**这是错误的！！！

所以你有2个选择

1.  回到

    ```
    //[assembly: AssemblyVersion("1.0.*")] 
    [assembly: AssemblyVersion("1.0.0.0")]  Keep it manually.
    [assembly: AssemblyFileVersion("1.0.0.0")] 
    ```

2.  每个构建都手动将**Version=1.0.0.0**替换为正确的数字。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-20T18:11:28.087

我用一个新项目尝试了这个，只是为了确保它不是你的特定项目/配置并且有完全相同的问题。

使用融合日志，系统似乎只在 IDE 目录 (C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE) 中查找行为扩展。在构建后步骤中将程序集复制到此目录是可行的，但很难看。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-04T20:56:49.133

您的 Web 项目的 bin 目录中是否有带有自定义行为的 Framework.dll 副本？如果不是，那可能就是问题所在。Visual Studio 正在寻找行为的实现。由于它已在您的配置中列出，因此不会考虑查看其他项目；它希望在 bin 中找到程序集。

根据您的项目的设置方式，它可能能够在不将该程序集放入 bin 的情况下在调试中运行，尽管 VS 通常会构建它并将其放在那里。但同样，这取决于事情是如何设置的。

无论如何，可能只想在设计时仔细检查程序集是否可用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-29T08:34:35.523

这是对我有用的步骤列表：

*   将dll安装到GAC，即gacutil /i Bla.dll
*   获取dll的FQN，即gacutil /l Bla
*   将生成的 FQN 复制到 Web.config
*   在 VS 中添加新服务
*   从GAC卸载dll，即gacutil /u Bla

都在一起**而已**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-07T20:27:28.723

将程序集放入 GAC 可能会有所帮助，但我很感激这不是您正在寻找的答案。不知道除了 GAC 和包含 devenv.exe 的目录之外，VS 还会在哪里寻找程序集。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-09T21:29:51.697

我通过注释掉 web.config 中的相关部分来解决这个问题，包括使用自定义扩展的元素、元素和元素。

之后，我能够向项目添加 WCF 服务，将这些行添加回 web.config 并发布项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-14T20:17:01.083

如果您使用的是框架 3.5，那么**Culture=neutral** in small not Culture=Neutral in CAPITAL

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-09-25T13:46:16.467

我的扩展类与我的服务类在同一个项目 (dll) 中，但无法让它工作。一旦我将它移到另一个项目并从它工作的服务项目中引用它。以防万一其他人遇到这个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-06T08:04:07.020

我在实现我的接口的类中定义了扩展类，这导致了“无法加载”错误，WCF 无法加载我的扩展类。

将扩展类定义移出接口实现（但仍在同一个项目/dll中）解决了我的问题。

# c++ - VC++ 2008，OpenProcess 总是返回错误 5（拒绝访问）

> ID：169355
> 
> 赞同：3
> 
> 时间：2008-10-03T23:49:32.343
> 
> 标签：c++, visual-studio-2008, visual-c++, openprocess

当我尝试使用 PROCESS_ALL_ACCESS 作为我想要的访问权限调用 OpenProcess 时，有谁知道为什么 MSVC++ 2008 总是在 GetLastError() 上返回错误 5？PROCESS_VM_READ 工作得很好。我是这台计算机的管理员，它在 Dev C++ 中运行良好。

我需要在某处设置一个选项吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-04T00:05:27.693

如果它不是在您的凭据下或在您的登录会话中运行的进程，则打开具有完全访问权限的进程可能是一项高度特权的操作 - 您需要遵循 MSDN 中的以下文档：

> 要打开另一个进程的句柄并获得完全访问权限，您必须启用 SeDebugPrivilege 权限。有关更多信息，请参阅更改令牌中的权限。

请记住，即使您拥有特权，在大多数情况下，该特权也未启用 - 它必须在尝试使用该特权的代码中专门启用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-04T00:10:25.030

可能导致这种情况的另一件事对 Vista 来说是新的：

> Windows Vista 引入了受保护的进程以增强对数字版权管理的支持。系统限制对受保护进程和受保护进程线程的访问。
> 
> 不允许从进程到受保护进程的以下标准访问权限：
> 
> `DELETE` `READ_CONTROL` `WRITE_DAC` `WRITE_OWNER`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T00:00:53.380

它是哪个过程？在另一个用户会话中打开服务或进程可能会返回拒绝访问 (5)。另一个会话中的进程将打开以供读取，但您将无法调试它。这是 Windbg 具有非侵入式附加功能的原因之一。它适用于用户会话。你实际上并没有调试。它暂停所有线程并正在读取内存。

# python - 如何在 Python 中压缩文件夹并通过电子邮件发送压缩文件？

> ID：169362
> 
> 赞同：7
> 
> 时间：2008-10-03T23:53:35.343
> 
> 标签：python

我想压缩一个文件夹及其所有子文件夹/文件，并将 zip 文件作为附件通过电子邮件发送。用 Python 实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-04T00:17:28.480

您可以使用[zipfile](http://docs.python.org/dev/library/zipfile.html)模块使用 zip 标准压缩文件，使用[email](http://docs.python.org/dev/library/email.html)模块创建带有附件的电子邮件，使用[smtplib](http://docs.python.org/dev/library/smtplib.html)模块发送它——所有这些都只使用标准库。

# Python - 包括电池

如果您不想编程，而是想在 stackoverflow.org 上提问，或者（如评论中所建议的）离开`homework`标签，那么，这里是：

```
import smtplib
import zipfile
import tempfile
from email import encoders
from email.message import Message
from email.mime.base import MIMEBase
from email.mime.multipart import MIMEMultipart    

def send_file_zipped(the_file, recipients, sender='you@you.com'):
    zf = tempfile.TemporaryFile(prefix='mail', suffix='.zip')
    zip = zipfile.ZipFile(zf, 'w')
    zip.write(the_file)
    zip.close()
    zf.seek(0)

    # Create the message
    themsg = MIMEMultipart()
    themsg['Subject'] = 'File %s' % the_file
    themsg['To'] = ', '.join(recipients)
    themsg['From'] = sender
    themsg.preamble = 'I am not using a MIME-aware mail reader.\n'
    msg = MIMEBase('application', 'zip')
    msg.set_payload(zf.read())
    encoders.encode_base64(msg)
    msg.add_header('Content-Disposition', 'attachment', 
                   filename=the_file + '.zip')
    themsg.attach(msg)
    themsg = themsg.as_string()

    # send the message
    smtp = smtplib.SMTP()
    smtp.connect()
    smtp.sendmail(sender, recipients, themsg)
    smtp.close()

    """
    # alternative to the above 4 lines if you're using gmail
    server = smtplib.SMTP_SSL('smtp.gmail.com', 465)
    server.login("username", "password")
    server.sendmail(sender,recipients,themsg)
    server.quit()
    """ 
```

使用此功能，您只需执行以下操作：

```
send_file_zipped('result.txt', ['me@me.org']) 
```

别客气。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T00:10:26.200

查看用于压缩文件夹及其子文件夹的[zipfile 。](http://www.python.org/doc/2.5.2/lib/module-zipfile.html)

查看[smtplib](http://www.python.org/doc/2.5.2/lib/module-smtplib.html)的电子邮件客户端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T00:14:54.147

您可以使用python 附带的[zipfile](http://www.python.org/doc/2.5.2/lib/module-zipfile.html)，[在这里](http://snippets.dzone.com/posts/show/2038)您可以找到使用标准 smtplib 发送带有附件的电子邮件的示例

# vb.net - 使用 VB.NET 发送 UDP 数据，包括十六进制

> ID：169377
> 
> 赞同：3
> 
> 时间：2008-10-04T00:01:45.687
> 
> 标签：vb.net, udp, hex, packet-capture

作为一种爱好，我对编程连接以太网的 LED 标志以在屏幕上滚动消息很感兴趣。但我无法在[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)中创建 UDP 发送器（我目前使用的是 2008）。

现在这个标志已经足够好了，有[一个关于它的编程规格表](http://support.favotech.com/protocol.specs.2.4.jetfile.pdf)。

但是发送给它的一行示例（第 3 页）：

```
<0x01>Z30<0x02>AA<0x06><0x1B>0b<0x1C>1<0x1A>1This message will show up on the screen<0x04> 
```

用 <0x01> 等代码表示十六进制字符。

现在，要将其发送到我需要使用[UDP](http://en.wikipedia.org/wiki/User_Datagram_Protocol)的标志。但是，我在发送之前都将消息编码为[ASCII](http://en.wikipedia.org/wiki/ASCII)的示例，例如这个（来自*[UDP：客户端将数据包发送到服务器并从服务器接收数据包](http://www.java2s.com/Code/VB/Network-Remote/UDPClientsendspacketstoandreceivespacketsfromaserver.htm)*）：

```
Imports System.Threading
Imports System.Net.Sockets
Imports System.IO
Imports System.Net

Public Class MainClass
   Shared Dim client As UdpClient
   Shared Dim receivePoint As IPEndPoint

   Public Shared Sub Main()
      receivePoint = New IPEndPoint(New IPAddress(0), 0)
      client = New UdpClient(8888)
      Dim thread As Thread = New Thread(New ThreadStart(AddressOf WaitForPackets))
      thread.Start()

         Dim packet As String = "client"
         Console.WriteLine("Sending packet containing: ")

         '
         ' Note the following line below, would appear to be my problem.
         '

         Dim data As Byte() = System.Text.Encoding.ASCII.GetBytes(packet)
         client.Send(data, data.Length, "localhost", 5000)
         Console.WriteLine("Packet sent")

   End Sub

   Shared Public Sub WaitForPackets()
      While True
         Dim data As Byte() = client.Receive(receivePoint)
         Console.WriteLine("Packet received:" & _
            vbCrLf & "Length: " & data.Length & vbCrLf & _
            System.Text.Encoding.ASCII.GetString(data))

      End While

   End Sub ' WaitForPackets

End Class 
```

要在 VB.NET 中输出十六进制代码，我认为语法可能是 &H1A - 发送规范定义为 <0x1A> 的内容。

我可以修改该代码，以正确地将格式正确的数据包发送到此标志吗？

Grant（在发送包含十六进制的数据包之后）、Hamish Smith（使用函数获取十六进制值）和 Hafthor（硬编码 chr() 消息到示例中）的答案在尝试时都不起作用。所以我会研究看看还有什么可能出错的。理论上，如果这个字符串发送成功，我应该会返回一个包含“OK”的消息，这将有助于知道它何时工作。

我已经尝试过，现在能够监控通过的数据包。一个工作数据包示例是这样的（原始十六进制）：[http](http://www.brettjamesonline.com/misc/forums/other/working.raw) ://www.brettjamesonline.com/misc/forums/other/working.raw与我的版本：[http ://www.brettjamesonline.com/misc/forums/other /失败的.raw](http://www.brettjamesonline.com/misc/forums/other/failed.raw)。不同之处在于我的十六进制代码仍未正确编码，在此并排图像中可以看到：[http](http://www.brettjamesonline.com/misc/forums/other/snapshotcoding.png) ://www.brettjamesonline.com/misc/forums/other/snapshotcoding.png 。

我已使用此代码生成数据包并发送它：

```
container = &H1 & "Z" & &H30 & &H2 & "temp.nrg" & &H1C & "1Something" & &H4
    '    This did not appear to work neither
    'container = Chr(&H1) & "Z" & Chr(&H30) & Chr(&H2) & Chr(&H1C) & "1Something" & Chr(&H4)
    '<0x01>Z00<0x02>FILENAME<0x1C>1Test to display<0x04>   <- the "official" spec to send
Dim sendBytes As [Byte]() = Encoding.ASCII.GetBytes(container) 
```

（完整片段： http: [//pastebin.com/f44417743](http://pastebin.com/f44417743)。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T00:36:05.213

你可以像这样组装一个快速解码器：

```
Function HexCodeToHexChar(ByVal m as System.Text.RegularExpressions.Match) As String
    Return Chr(Integer.Parse(m.Value.Substring("<0x".Length, 2), _
         Globalization.NumberStyles.HexNumber))
End Function 
```

然后用它来转换：

```
Dim r As New System.Text.RegularExpressions.Regex("<0x[0-9a-fA-F]{2}>")
Dim s As String = r.Replace("abc<0x44>efg", AddressOf HexCodeToHexChar)
' s should now be "abcDefg" 
```

您还可以创建一个编码器功能来撤消此解码（虽然有点复杂）

```
Function HexCharToHexCode(ByVal m As Match) As String
    If m.Value.StartsWith("<0x") And m.Value.EndsWith(">") And m.Value.Length = "<0x??>".Length Then
        Return "<0<0x78>" + m.Value.Substring("<0x".Length)
    ElseIf Asc(m.Value) >= 0 And Asc(m.Value) <= &HFF Then
        Return "<0x" + Right("0" + Hex(Asc(m.Value)), 2) + ">"
    Else
        Throw New ArgumentException("Non-SBCS ANSI characters not supported")
    End If
End Function 
```

并使用它来转换：

```
Dim r As New Regex("[^ -~]|<0x[0-9a-fA-F]{2}>")
Dim s As String = r.Replace("abc"+chr(4)+"efg", AddressOf HexCharToHexCode)
' s should now be "abc<0x04>efg" 
```

或者您可以只构建带有特殊字符的字符串，以这样开头：

```
Dim packet As String = Chr(&H01) + "Z30" + Chr(&H02) + "AA" + Chr(&H06) + _
    Chr(&H1B) + "0b" + Chr(&H1C) + "1" + Chr(&H1A) + _
    "1This message will show up on the screen" + Chr(&H04) 
```

对于发送 UDP 数据包，以下内容就足够了：

```
Dim i As New IPEndPoint(IPAddress.Parse("192.168.0.5"), 3001) ''//Target IP:port
Dim u As New UdpClient()
Dim b As Byte() = Encoding.UTF8.GetBytes(s) ''//Where s is the decoded string
u.Send(b, b.Length, i) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T08:28:55.637

他们发布了包括 Visual Basic 在内的多种语言的库（在单独的文件中）。我用他们的一个标志测试了演示，他们工作了！

[http://support.favotech.com](http://support.favotech.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T00:28:40.580

这可能会有所帮助。在我的公司，我们必须使用 ascii 和 hex 的组合与我们的硬件进行通信。

我使用此功能在将 IP 地址发送到硬件之前对其进行 hexify

```
Public Function HexFromIP(ByVal sIP As String)
    Dim aIP As String()
    Dim sHexCode As String = ""
    aIP = sIP.Split(".")

    For Each IPOct As String In aIP
        sHexCode += Hex(Val(IPOct)).PadLeft(2, "0")
    Next

    Return sHexCode
End Function 
```

偶尔我也会使用`hexSomething = Hex(Val(number)).PadLeft(2,"0")`。

我也可以为您提供整个程序的源代码，尽管它旨在与不同的硬件通信。

编辑：

您是尝试以十六进制发送数据包，还是以十六进制获取数据包？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T00:47:47.000

UDP 客户端发送一个字节数组。
您可以使用内存流并将字节写入数组。

```
Public Class MainClass
   Shared client As UdpClient
   Shared receivePoint As IPEndPoint

   Public Shared Sub Main()
      receivePoint = New IPEndPoint(New IPAddress(0), 0)
      client = New UdpClient(8888)
      Dim thread As Thread = New Thread(New ThreadStart(AddressOf WaitForPackets))
      thread.Start()

      Dim packet As Packet = New Packet("client")
      Console.WriteLine("Sending packet containing: ")
      Dim data As Byte() = packet.Data

      client.Send(data, data.Length, "localhost", 5000)
      Console.WriteLine("Packet sent")

   End Sub

   Public Shared Sub WaitForPackets()
      While True
         Dim data As Byte() = client.Receive(receivePoint)
         Console.WriteLine("Packet received:" & _
            vbCrLf & "Length: " & data.Length & vbCrLf & _
            System.Text.Encoding.ASCII.GetString(data))

      End While

   End Sub ' WaitForPackets  

End Class  

Public Class Packet  
   Private _message As String  

   Public Sub New(ByVal message As String)
      _message = message
   End Sub

   Public Function Data() As Byte()

      Dim ret(13 + _message.Length) As Byte

      Dim ms As New MemoryStream(ret, True)

      ms.WriteByte(&H1)

      '<0x01>Z30<0x02>AA<0x06><0x1B>0b<0x1C>1<0x1A>1This message will show up on the screen<0x04>  
      ms.Write(System.Text.Encoding.ASCII.GetBytes("Z30"), 0, 3)

      ms.WriteByte(&H2)

      ms.Write(System.Text.Encoding.ASCII.GetBytes("AA"), 0, 2)

      ms.WriteByte(&H6)

      ms.Write(System.Text.Encoding.ASCII.GetBytes("0b"), 0, 2)

      ms.WriteByte(&H1C)

      ms.Write(System.Text.Encoding.ASCII.GetBytes("1"), 0, 1)

      ms.WriteByte(&H1A)

      ms.Write(System.Text.Encoding.ASCII.GetBytes(_message), 0, _message.Length)

      ms.WriteByte(&H4)

      ms.Close()

      Data = ret
   End Function
End Class 
```

# c# - 方法可以设为静态，但应该这样吗？

> ID：169378
> 
> 赞同：402
> 
> 时间：2008-10-04T00:01:49.183
> 
> 标签：c#, .net, refactoring, resharper, static-methods

ReSharper 喜欢指出每个 ASP.NET 页面的多个功能，这些功能可以设为静态。如果我将它们设为静态，它对我有帮助吗？我应该将它们设为静态并将它们移动到实用程序类吗？

* * *

## 回答 #1

> 赞同：278
> 
> 时间：2008-10-04T06:34:03.180

在我看来，性能、命名空间污染等都是次要的。问问自己什么是合乎逻辑的。该方法是在逻辑上对类型的实例进行操作，还是与类型本身相关？如果是后者，请将其设为静态方法。仅当它与不受您控制的类型相关时才将其移动到实用程序类中。

*有时有些方法在逻辑上作用于实例，但还没有*碰巧使用实例的任何状态。例如，如果你正在构建一个文件系统并且你已经有了目录的概念，但你还没有实现它，你可以编写一个返回文件系统对象类型的属性，它总是只是“文件” - 但它在逻辑上与实例相关，因此应该是实例方法。如果您想使方法成为虚拟方法，这也很重要——您的特定实现可能不需要状态，但派生类可能需要。（例如，询问一个集合是否是只读的——你可能还没有实现该集合的只读形式，但它显然是集合本身的属性，而不是类型。）

* * *

## 回答 #2

> 赞同：267
> 
> 时间：2008-10-04T00:12:50.767

**静态方法与实例方法C# 语言规范的**
[静态和实例成员](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/language-specification/classes#static-and-instance-members)解释了差异。通常，静态方法可以比实例方法提供非常小的性能增强，但仅在有些极端的情况下（有关更多详细信息，请参见此[答案）。](https://stackoverflow.com/a/12279898/23234)

FxCop 或代码分析中的规则 CA1822 指出：

> *“在 [将成员标记为静态] 之后，编译器将向这些成员发出非虚拟调用站点，这将阻止在运行时检查每个调用以确保当前对象指针非空。这可以带来可衡量的性能提升对于性能敏感的代码。在某些情况下，无法访问当前对象实例表示正确性问题。*

**实用程序类**
您不应该将它们移动到实用程序类，除非它在您的设计中有意义。如果静态方法与特定类型相关，例如`ToRadians(double degrees)`方法与表示角度的类相关，则该方法作为该类型的静态成员存在是有意义的（注意，这是一个用于演示目的的复杂示例）。

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2008-10-04T01:04:09.587

将方法标记为`static`类中的方法很明显它不使用任何实例成员，这有助于在浏览代码时了解。

您不必将它移动到另一个类，除非它打算由另一个密切相关的类共享，概念方面。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-10-04T00:29:01.047

我确定这不会发生在您的情况下，但是我在一些代码中看到了一种“难闻的气味”，我不得不通过维护使用大量的静态方法而遭受痛苦。

不幸的是，它们是假定特定应用程序状态的静态方法。（当然，每个应用程序只有一个用户！为什么不让 User 类在静态变量中跟踪它？）它们是访问全局变量的美化方式。他们还有静态构造函数（！），这几乎总是一个坏主意。（我知道有几个合理的例外）。

但是，当静态方法分解出实际上并不依赖于对象实例状态的域逻辑时，它们非常有用。它们可以使您的代码更具可读性。

只要确保你把它们放在正确的地方。静态方法是否侵入性地操纵其他对象的内部状态？可以证明他们的行为属于其中一个类吗？如果你没有正确地分离关注点，你以后可能会头疼。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2012-06-19T11:33:47.500

这很有趣：
[http ://thecuttingledge.com/?p=57](http://thecuttingledge.com/?p=57)

ReSharper 实际上并不建议您将方法设为静态。您应该问自己为什么该方法在该类中，而不是在其签名中显示的类之一...

但这是 ReSharper 文档所说的： [http ://confluence.jetbrains.net/display/ReSharper/Member+can+be+made+static](http://confluence.jetbrains.net/display/ReSharper/Member+can+be+made+static)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-09-03T05:52:35.903

只是添加到@Jason True 的[答案](https://stackoverflow.com/questions/169378/c-method-can-be-made-static-but-should-it/169423#169423)中，重要的是要意识到仅将“静态”放在方法上并不能保证该方法将是“纯”的。对于声明它的类而言，它将是无状态的，但它可以很好地访问具有状态（应用程序配置等）的其他“静态”对象，这可能并不总是一件坏事，但原因之一是我个人倾向于在可能的情况下更喜欢静态方法，因为如果它们是纯的，您可以单独测试和推理它们，而不必担心周围的状态。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-10-15T20:44:25.910

对于类中的复杂逻辑，我发现私有静态方法可用于创建隔离逻辑，其中实例输入在方法签名中明确定义，不会发生实例副作用。所有输出必须通过返回值或 out/ref 参数。将复杂的逻辑分解成**无副作用的代码块**可以提高代码的可读性和开发团队对它的信心。

另一方面，它可能导致一个类被实用方法的扩散所污染。像往常一样，逻辑命名、文档和团队编码约定的一致应用可以缓解这种情况。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-10-04T00:05:49.063

您应该在给定的场景中做最易读和最直观的事情。

性能参数不是一个好的参数，除非在最极端的情况下，因为唯一实际发生的事情是一个额外的参数 ( `this`) 被压入堆栈以用于实例方法。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-02-06T09:27:59.207

ReSharper 不检查逻辑。它只检查该方法是否使用实例成员。如果该方法是私有的并且仅由（可能只有一个）实例方法调用，则这是让它成为实例方法的标志。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-04T00:07:50.870

如果这些功能在许多页面之间共享，您也可以将它们放在一个基页面类中，然后让所有使用该功能的 asp.net 页面都继承自它（并且这些功能也可以是静态的）。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-10-04T01:08:36.083

将方法设为静态意味着您可以从类外部调用该方法，而无需先创建该类的实例。这在使用第三方供应商对象或附加组件时很有帮助。想象一下，如果您必须在调用 con.Writeline() 之前首先创建一个控制台对象“con”；

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-04T00:04:08.180

它有助于控制命名空间污染。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2020-05-20T03:28:59.127

我希望您已经了解静态方法和实例方法之间的区别。此外，可以有一个很长的答案和一个简短的答案。其他人已经提供了长答案。

我的简短回答：**是的，**您可以按照 ReSharper 的建议将它们转换为静态方法。这样做没有坏处。相反，通过使方法静态，您实际上是在保护该方法，以便您不会不必要地将任何实例成员滑入该方法。这样，您可以实现 OOP 原则“**最小化类和成员的可访问性**”。

当 ReSharper 建议可以将实例方法转换为静态方法时，它实际上是在告诉您，“为什么 .. 这个方法位于此类中，但实际上并没有使用它的任何状态？” 所以，它让你深思。然后，您可以意识到是否需要将该方法移动到静态实用程序类。根据 SOLID 原则，一个类应该只有一个核心职责。因此，您可以通过这种方式更好地清理您的类。有时，即使在您的实例类中，您也确实需要一些辅助方法。如果是这种情况，您可以将它们保存在#region 助手中。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-11-14T16:09:41.413

Just my tuppence：将所有共享静态方法添加到实用程序类允许您添加

```
using static className; 
```

到您的 using 语句，这使代码更快地键入和更易于阅读。例如，在我继承的一些代码中，我有大量被称为“全局变量”的东西。我没有在作为实例类的类中创建全局变量，而是将它们全部设置为全局类的静态属性。它完成了这项工作，如果杂乱无章，我可以按名称引用属性，因为我已经引用了静态命名空间。

我不知道这是否是好的做法。我有很多关于 C# 4/5 的知识要学习，还有很多遗留代码要重构，我只是想让 Roselyn 技巧指导我。

乔伊

# windows-services - 安装不需要手动运行 installutil 的 C# Windows 服务的最佳方法是什么？

> ID：169381
> 
> 赞同：3
> 
> 时间：2008-10-04T00:03:52.190
> 
> 标签：windows-services, setup-project, installutil

我想打包一个 C# windows 服务项目，以便任何人都可以轻松安装它，而无需使用 installutil 命令提示实用程序？是否有一种简单的方法来配置 Visual Studio 安装项目以执行类似于安装 winforms 应用程序的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T00:20:02.437

我喜欢创建一个安装项目来获得一个漂亮干净的 MSI 安装程序，这应该可以帮助您：

[http://support.microsoft.com/kb/816169](http://support.microsoft.com/kb/816169)

codeproject 也有一个很好的例子： http: [//www.codeproject.com/KB/dotnet/simplewindowsservice.aspx](http://www.codeproject.com/KB/dotnet/simplewindowsservice.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-28T15:56:09.027

[这个问题](https://stackoverflow.com/questions/255056/install-a-net-windows-service-without-installutil-exe)有很多额外的答案。

如果该应用程序适用于基本用户，那么 MSI 是最好的选择。

如果它针对的是技术人员，那么我个人更喜欢可以自行安装和卸载的应用程序，并且可以作为服务运行或像普通应用程序一样运行。链接的问题有描述这一点的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-04T00:27:42.360

为了完整起见，我将在这里总结[http://support.microsoft.com/kb/816169](http://support.microsoft.com/kb/816169)。

您需要将 Service Installer 类添加到您的服务组件。然后可以通过设置例程调用它来添加您的服务。您需要在安装项目中创建一个自定义操作来调用它。详细信息在标识的 KB 中。

# c# - C# 中的开源 cad 绘图 (dwg) 库

> ID：169390
> 
> 赞同：25
> 
> 时间：2008-10-04T00:08:20.883
> 
> 标签：c#, open-source, autocad, cad, dwg

任何人都知道 C# 中的开源 DWG（autocad 绘图）库吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-15T20:57:33.263

DWG 格式的主要障碍是二进制格式每 3 年更改一次 - 它将在 2009 年 3 月再次更改。它是加密的，并且其规范不公开。这是一个非常复杂的图书馆，有许多甚至 AutoDesk 都不知道的黑暗小巷（他们在几年前收购了它）。

不是开源，而是[开放设计联盟](http://www.opendesign.com/ "开放设计联盟")......（来自他们的网站）......

> 是一个由软件公司、开发人员和用户组成的非营利性会员联盟，致力于促进现在和未来 CAD 数据的开放交换。除了为 CAD 数据格式制定标准外，ODA 还专注于开发质量卓越的软件库的实际问题，使 ODA 成员能够开发能够读取和写入流行的 DWG 和 DGN CAD 文件格式的应用程序。

成本取决于您使用这些库的目的，但开发人员的基本成本是每年 100 美元，加入费为 250 美元。与[AutoDesk 的 RealDWG 相比](http://usa.autodesk.com/adsk/servlet/index?siteID=123112&id=770257 "该死的好贵")，每年 2500 美元和第一年 5000 美元，这很划算。顺便说一下，R​​ealDWG 许可证是针对每个产品的。ODA 许可证更合理一些，还允许您在同一个许可证上制作超过 1 个产品。你可以为源代码付费，但它要花很多钱——虽然比自己开发要少

如果您只有 1 个产品，那么 RealDWG 可能适合您，但它仅适用于 Windows - 奖励，它有一个~~ODA 仍在开发~~的 .NET API……ODA 的 .NET API（有 2 个）已经很成熟了。ODA 产品针对多种操作系统进行编译，包括 Windows（32 位）、SGI、Solaris、Windows（64 位）、Macintosh、HP、Windows CE、Linux、IBM AIX。

无论如何，这是一个需要重新发明的巨大轮子，因此绝对值得为已经转动的轮子付费。

一些 3rd-party 库存在有限的特定 API 功能，如果您的需求非常具体，可以尝试搜索这些库。

还值得注意的是，AutoDesk 多年来一直在或多或少地与 ODA 进行诉讼。如果您决定与他们竞争，那么这是您必须期待的另一个复杂性。

### 更新：

那些日子已经结束了。

我还在开发一种与 DWG 文件对话的产品。我走的是商业路线，因为所涉及的时间、费用和麻烦对我来说完全不经济。

### 更新：

我做到了。tvCAD.tv 建立在 RealDwg 之上

### 2018 年 7 月更新

虽然我在 tvCAD 中使用了 RealDwg，但如果我今天开始该项目，我可能会使用 ODA 库。[构建 RealDwg 安装程序是一场噩梦](https://forums.autodesk.com/t5/net/realdwg-installer-why-so-cryptic/td-p/6341741)。此外，RealDwg 安装大小约为 ODA 安装大小的 10 倍。是的，认真的。

Autodesk 在 AutoCAD 市场的主导地位正在减弱，它不再是“IBM”的选择。我可能会在未来的某个时候将 tvCAD 转换为 ODA 库——将我推入其中并不需要更多的痛苦。许可成本是可比的。

历史上，我发现 ODA 的支持比 Autodesk 环境中的支持要好，除了[AutoCAD 标签 wiki](https://stackoverflow.com/tags/autocad/info)中提到的论坛上的积极和出色的同行支持，它对所有平台都非常普遍。来自 RealDwg 的 .NET 代码几乎可以与 ODA 库一起使用。同样适用于 AutoCAD / BricsCAD 等的 .NET 插件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-08-04T10:55:04.790

如果您沿着 dxf 路线走，我建议[您使用 netDXF](http://netdxf.codeplex.com/)。它是开源的，可以很好地满足我的有限要求，尽管它缺少多行文本支持，而且作者说还有一些其他的东西他不会支持，因为它们是 Autodesk 专有的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-04-01T13:00:51.117

没有开源解决方案，有一些商业解决方案，其中一个名为 CadLib 的 .NET 组件由 Wout Ware 提供：[http](http://www.woutware.com/cadlib.html) ://www.woutware.com/cadlib.html 。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-16T11:06:50.230

有人尝试过 cadsofttools CAD Import 吗？

[http://www.cadsofttools.com](http://www.cadsofttools.com) [http://www.cadsofttools.com/en/products/cad_import_.net.html](http://www.cadsofttools.com/en/products/cad_import_.net.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-04T21:14:25.543

最简单的方法是将 dwg 转换为 dxf ascii，查询 ascii dxf 相当简单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-04T01:36:35.747

曾经有人努力将 Art Haas 的 .dwg 解析器（来自 pythoncad 项目）移植到 c#。我似乎找不到链接 ATM，但那是几年前的事了。创建一个开源跨平台 .dwg 库是我的[VectorSection](http://vectorsection.org)列表的顶部，所以让我知道你发现了什么！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-16T05:27:57.340

我知道的唯一开源的是 LibreDwg，我认为它还没有完成。它从来没有真正走得很远。

我知道一个实际上是免费的，它叫做 Ivan CAD Library 2012，它位于 www.ivancad.com。

它可能很好地满足您的需求。

# sql-server-2005 - 更改 SQL Server 2005 服务器排序规则

> ID：169398
> 
> 赞同：1
> 
> 时间：2008-10-04T00:12:10.283
> 
> 标签：sql-server-2005, collation

我需要使用 SQL_Latin1_General_CP850_Bin 作为服务器排序规则设置 SQL Server 2005 实例（供应商没有考虑查看数据库排序规则的一堆东西，因此存储过程和临时表默认为服务器级别，默认排序规则将不行）。在安装 SQL Server 期间，它没有将其作为选项提供，因此我将其保留为默认值并完成安装。

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms179254.aspx)和[Technet](http://technet.microsoft.com/en-us/library/ms179254.aspx)，我应该只需要运行以下命令：

```
setup.exe /q /ACTION=RebuildDatabase /INSTANCENAME=MSSQLSERVER /SAPWD="sa-pwd" /SQLSYSADMINACCOUNTS="BUILTIN\ADMINISTRATORS" /SqlCollation=SQL_Latin1_General_CP1_CI_AI 
```

但是，每当我使用我的参数运行上述命令时，我都会弹出 SQL Server 安装向导，接受协议，然后它会给出说明如何使用命令的输出。

知道我能做什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T00:19:49.100

我认为您正在查看 SQL Server 2008 的说明。

有关 2005 年的说明，请参阅[此处](http://msdn.microsoft.com/en-us/library/ms179254(SQL.90).aspx)的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T01:53:42.700

如果可能的话，我会卸载并重新安装而不是尝试更改它。在不重新安装的情况下更改它不是一个简单的过程。要在安装过程中更改默认设置，只需取消选中“注册信息”屏幕上的“隐藏高级配置选项”复选框即可；这样做会在安装后为您提供大约 4 个屏幕的排序规则设置选项。

# c++ - 原始数据类型和复杂数据类型的 C++ 模板析构函数

> ID：169404
> 
> 赞同：2
> 
> 时间：2008-10-04T00:15:37.797
> 
> 标签：c++, templates

在一个[相关问题](https://stackoverflow.com/questions/168408/c-alternatives-to-void-pointers-that-isnt-templates)中，我询问了有关创建通用容器的问题。使用多态模板似乎是正确的方法。

但是，我一生都无法弄清楚应该如何编写析构函数。我希望分配的内存的所有者是容器，即使示例构造函数接受一个数组`T`（连同它的维度），在其他点分配。

我希望能够做类似的事情

```
MyContainer<float> blah();
...
delete blah; 
```

和

```
MyContainer<ComplexObjectType*> complexBlah();
...
delete complexBlah;` 
```

我可以做这样的事情吗？我可以在没有智能指针的情况下做到这一点吗？

再次感谢您的意见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-04T00:40:43.567

如果您想存储指向复杂类型的指针，我建议您将容器用作: `MyContainer<shared_ptr<SomeComplexType> >`，而对于原始类型，只需使用`MyContainer<float>`.

`shared_ptr`应该注意在复杂类型被破坏时适当地删除它。当原始类型被破坏时，不会发生任何花哨的事情。

* * *

如果您以这种方式使用容器，则不需要太多的析构函数。您如何将物品存放在容器中？您使用 STL 容器还是堆上的数组？STL 容器会自行删除。如果你删除数组，这将导致每个元素的析构函数被执行，如果每个元素都是 a `shared_ptr`，`shared_ptr`析构函数将删除它自己持有的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T08:30:42.447

您很可能*确实*想在这里使用智能指针，它确实简化了问题。但是，就像练习一样，很容易确定给定类型是否为指针。粗略的实现（可能更优雅，但我不想介绍int2type）：

```
typedef char YesType;
typedef char NoType[2];

template<typename T>
struct IsPointer
{
typedef NoType  Result;
};
template<typename T>
struct IsPointer<T*>
{
typedef YesType Result;
};

template<typename T>
struct MyContainer
{
~MyContainer()
{
    IsPointer<T>::Result r;
    Clear(&r);
    delete[] data;
}
void Clear(YesType*)
{
    for (int i = 0; i < numElements; ++i)
        delete data[i];
}
void Clear(NoType*) {}

T*  data;
int numElements; 
```

};

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T00:32:15.470

可以做到，但这是非常高级的东西。您需要使用类似 boost MPL 库 ( [http://www.boost.org/doc/libs/1_36_0/libs/mpl/doc/index.html](http://www.boost.org/doc/libs/1_36_0/libs/mpl/doc/index.html) ) 的东西，以便让 MyContainer 的析构函数选择正确的需要对容器上的单个项目进行某种破坏。您可以使用 boost TypeTraits 库来决定需要哪种删除（[http://www.boost.org/doc/libs/1_36_0/libs/type_traits/doc/html/index.html](http://www.boost.org/doc/libs/1_36_0/libs/type_traits/doc/html/index.html)）。我确信它会有一个特性，可以让你决定你包含的类型是否是指针，从而决定它需要如何被破坏。您可能需要自己为要在 MyContainer 中使用的具有任何其他特定删除要求的任何其他类型实现特征。祝你好运！如果你解决了它，请告诉我们你是如何做到的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T03:37:04.067

如果您不想使用智能指针，您可以尝试部分模板专业化，它让您编写一个仅在使用指针类型实例化容器时使用的模板。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T17:21:27.040

delete 用于释放先前分配的内存`new`。您不需要在这里使用 delete，当 blah 和 complexBlah 超出范围时，它们将自动被销毁。

虽然[yrp 的回答](https://stackoverflow.com/questions/169404/c-template-destructors-for-both-primitive-and-complex-data-types#169986)向您展示了一种使用模板专业化来删除包含的对象的方法，如果它们是指针，而不是如果它们不是，这似乎是一个脆弱的解决方案。如果你想要这样的行为，你最好使用[Boost Pointer Container](http://www.boost.org/doc/libs/release/libs/ptr_container/)库，它提供了这种确切的行为。标准库不这样做的原因是因为容器本身不知道它们是否控制包含的指针-您需要将指针包装在确实知道的类型中-即智能指针。

# visual-studio-2008 - 更改 VS2008 (Express) 中的新项目警告级别

> ID：169419
> 
> 赞同：2
> 
> 时间：2008-10-04T00:24:35.237
> 
> 标签：visual-studio-2008

我喜欢将警告级别设置为 W4，但所有新项目都从 W3 开始。是否有某种方法可以更改新项目的警告级别的默认值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T00:34:04.280

我不知道如何在 IDE 中执行此操作，但您始终可以在以下位置编辑新项目模板：

```
%PROGRAM_FILES%\Microsoft Visual Studio 9.0\Common7\IDE\ProjectTemplates\ 
```

如果您使用的是 express 版本，则路径可能会有细微的变化：

```
%PROGRAM_FILES%\Microsoft Visual Studio 9.0\Common7\IDE\{Version}\ProjectTemplates\ 
```

其中 {Version} 是您正在使用的 express 风格，VCSExpress、VBExpress 等。

模板是 zip 文件，只需编辑项目更改：

```
<WarningLevel>3</WarningLevel> 
```

至

```
<WarningLevel>4</WarningLevel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-04T01:19:29.120

我在我的机器上找不到任何项目模板或任何东西，所以我只是在所有文件中搜索了警告级别。我发现 common.js 在

```
%\Microsoft Visual Studio 9.0\VC\VCWizards\1033 
```

在文件中搜索显示WarningLevel出现在三个地方，第672、699和3354行。我只是将这三行改为阅读

```
CLTool.WarningLevel = WarningLevel_3; 
```

至

```
CLTool.WarningLevel = WarningLevel_4; 
```

当我创建一个新项目时，它被设置为 /w4。所以这对我有用，不能保证它不会用软管冲洗你的机器。

# java - 用于管理双向关联和反向更新的通用 Java 框架

> ID：169420
> 
> 赞同：1
> 
> 时间：2008-10-04T00:26:29.630
> 
> 标签：java, associations, bidirectional, inverse

我一直在寻找一种处理双向关联的通用方法以及一种在手动编写的 Java 代码中处理反向更新的方法。

对于那些不知道我在说什么的人，这里有一个例子。下面是我目前（不满意）解决方案的结果。

```
public class A {
    public B getB();
    public void setB(B b);
}

public class B {
    public List<A> getAs();
} 
```

现在，当更新关联的任何一端时，为了保持一致性，另一端也必须更新。要么每次手动

```
a.setB(b);
b.getA().add(a); 
```

或者通过将匹配代码放入 setter / getter 并使用自定义 List 实现。

我发现了一个过时的、未维护的项目，其依赖项不再可用（[https://e-nspire-gemini.dev.java.net/](https://e-nspire-gemini.dev.java.net/)）。它通过使用用于自动注入必要代码的注释来处理该问题。

有谁知道另一个以通用、不显眼的方式处理这个问题的框架吗？

ciao，埃尔玛

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-04T00:47:44.253

google collections (from google's internal code) -- [http://code.google.com/p/google-collections/](http://code.google.com/p/google-collections/)兼容 Java 泛型（不仅兼容，很好地使用泛型）

BiMap 类——http: //google-collections.googlecode.com/svn/trunk/javadoc/index.html?http: [//google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/ collect/package-summary.html](http://google-collections.googlecode.com/svn/trunk/javadoc/index.html?http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/package-summary.html) 允许双向关联。

其中一些类有望进入 JDK 7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-04T04:50:20.160

除非您抽象出设置器，否则您将不得不提供某种事件通知机制。如果您的对象是 JavaBean，那么您正在考虑使用 PropertyChangeSupport 并触发属性更改事件。

如果你这样做（或有一些其他机制来检测更改），那么 Glazed Lists 提供了一个[ObservableElementList](http://publicobject.com/glazedlists/glazedlists-1.5.0/api/ca/odell/glazedlists/ObservableElementList.html)，它可以很容易地用于从列表端处理关联同步（即，将 A 添加到 List< A> 会自动调用 a.setB( b))。使用属性更改监视（或等效）可以轻松处理另一个方向。

我意识到这不是一个通用的解决方案，但它似乎是一个简单的基础。

请注意，这样的事情*需要*在 B 类中实现特殊的列表 - 在一般情况下（即使用 ArrayList 或类似的东西），您可以处理它的 AOP 类型解决方案绝非易事。

我还应该指出，您要实现的目标是数据绑定的圣杯。在字段级别有一些不错的绑定实现（例如 getter 和 setter）（参见 JGoodies 绑定和 JSR 295 示例）。列表类型绑定还有一个非常好的实现（Glazed Lists，上面提到过）。我们在几乎所有的应用程序中都同时使用这两种技术，但从未尝试过像您所询问的那样抽象。

如果我正在设计这个，我会看这样的东西：

```
AssociationBuilder.createAssociation(A a, Connector< A> ca, B b,  Connector< B> cb, Synchronizer< A,B> sync) 
```

连接器是一个接口，它允许单个接口用于各种更改通知类型。Synchronizer 是一个接口，它被调用以确保两个对象在其中一个对象发生更改时保持同步。

```
sync(ChangeInfo info, A a, B b) // make sure that b reflects current state of a and vice-versa. 
```

ChangeInfo 提供有关哪些成员发生了变化以及实际发生了什么变化的数据。我们是。如果你想真正保持这个通用性，那么你几乎必须把它的实现交给框架用户。

有了上述内容，就有可能拥有许多满足不同绑定标准的预定义连接器和同步器。

有趣的是，上述方法签名与 JSR 295 createAutoBinding() 方法调用非常相似。属性对象等价于连接器。JSR 295 没有同步器（相反，它们具有指定为 ENUM 的绑定策略 - 加上 JSR 295 仅适用于 property->property 绑定，试图将一个对象的字段值绑定到该对象在另一个对象中的列表成员资格甚至不在他们的桌子上）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T13:56:31.913

有意义的是，这些课程将是对等的。我建议使用包私有机制（在没有朋友的情况下）以保持一致性。

```
public final class A {
    private B b;
    public B getB() {
        return b;
    }
    public void setB(final B b) {
        if (b == this.b) {
            // Important!!
            return;
        }
        // Be a member of both Bs (hence check in getAs).
        if (b != null) {
            b.addA(this);
        }
        // Atomic commit to change.
        this.b = b;
        // Remove from old B.
        if (this.b != null) {
            this.b.removeA(this);
        }
    }
}

public final class B {
    private final List<A> as;
    /* pp */ void addA(A a) {
        if (a == null) {
            throw new NullPointerException();
        }
        // LinkedHashSet may be better under more demanding usage patterns.
        if (!as.contains(a)) {
            as.add(a);
        }
    }
    /* pp */ void removeA(A a) {
        if (a == null) {
            throw new NullPointerException();
        }
        as.removeA(a);
    }
    public List<A> getAs() {
        // Copy only those that really are associated with us.
        List<A> copy = new ArrayList<A>(as.size());
        for (A a : as) {
            if (a.getB() == this) {
                copy.add(a);
            }
        }
        return Collection.unmodifiableList(copy);
    }
} 
```

（免责声明：未经测试甚至编译。）

大部分是异常安全的（在异常情况下可能会泄漏）。线程安全、多对多、性能、库化等，留给感兴趣的读者作为练习。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-05T20:50:55.993

感谢所有建议。但是没有一个接近我正在寻找的东西，我可能以错误的方式提出了这个问题。

我一直在寻找双子座的替代品，因此寻找一种以不显眼的方式处理此问题的方法，而不会通过无休止的检查和特殊的 List 实现来污染代码。正如 Kevin 所建议的，这当然需要基于 AOP 的方法。

当我环顾四周时，我在 cnet 上发现了一个包含所有源和与源的依赖关系的 gemini 包。依赖项的缺失来源是阻止我使用它的唯一问题。由于现在所有资源都可用，因此可以修复错误。如果有人寻找这个： http: [//www.download.com/Gemini/3000-2413_4-10440077.html](http://www.download.com/Gemini/3000-2413_4-10440077.html)

# php - PHP DateTime 微秒总是返回 0

> ID：169428
> 
> 赞同：73
> 
> 时间：2008-10-04T00:32:07.840
> 
> 标签：php, datetime

此代码在 PHP 5.2.5 中始终返回 0 微秒：

```
<?php
$dt = new DateTime();
echo $dt->format("Y-m-d\TH:i:s.u") . "\n";
?> 
```

输出：

```
[root@www1 ~]$ php date_test.php
2008-10-03T20:31:26.000000
[root@www1 ~]$ php date_test.php
2008-10-03T20:31:27.000000
[root@www1 ~]$ php date_test.php
2008-10-03T20:31:27.000000
[root@www1 ~]$ php date_test.php
2008-10-03T20:31:28.000000 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-04T00:57:22.487

这似乎可行，尽管[http://us.php.net/date](http://us.php.net/date)记录微秒说明符但并不真正支持它似乎不合逻辑：

```
function getTimestamp()
{
        return date("Y-m-d\TH:i:s") . substr((string)microtime(), 1, 8);
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-07-07T01:19:09.703

`DateTime`您可以在构造对象时指定输入包含微秒，并`microtime(true)`直接用作输入。

不幸的是，如果您精确到一秒，这将失败，因为`.`微时间输出中将没有；所以在这种情况下使用`sprintf`强制它包含 a `.0`：

```
date_create_from_format(
    'U.u', sprintf('%.f', microtime(true))
)->format('Y-m-d\TH:i:s.uO'); 
```

或等效（更多 OO 风格）

```
DateTime::createFromFormat(
    'U.u', sprintf('%.f', microtime(true))
)->format('Y-m-d\TH:i:s.uO'); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-04T01:31:09.000

该函数取自[http://us3.php.net/date](http://us3.php.net/date)

```
function udate($format, $utimestamp = null)
{
    if (is_null($utimestamp))
        $utimestamp = microtime(true);

    $timestamp = floor($utimestamp);
    $milliseconds = round(($utimestamp - $timestamp) * 1000000);

    return date(preg_replace('`(?<!\\\\)u`', $milliseconds, $format), $timestamp);
}

echo udate('H:i:s.u'); // 19:40:56.78128 
```

非常麻烦，您必须实现此功能才能使“u”工作...：\

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-12-10T22:59:16.273

试试这个，它显示微秒：

```
$t = microtime(true);
$micro = sprintf("%06d",($t - floor($t)) * 1000000);
$d = new DateTime( date('Y-m-d H:i:s.'.$micro,$t) );

print $d->format("Y-m-d H:i:s.u"); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-03-09T07:59:53.150

```
\DateTime::createFromFormat('U.u', microtime(true)); 
```

会给你（至少在大多数系统上）：

```
object(DateTime)(
  'date' => '2015-03-09 17:27:39.456200',
  'timezone_type' => 3,
  'timezone' => 'Australia/Darwin'
) 
```

但是由于 PHP 浮点舍入会导致精度损失。这不是真正的微秒。

**更新**

这可能是`createFromFormat()`选项的最佳折衷方案，并提供了完整的精度。

```
\DateTime::createFromFormat('0.u00 U', microtime()); 
```

**gettimeofday()**

更明确，也许更健壮。解决了 Xavi 发现的错误。

```
$time = gettimeofday(); 
\DateTime::createFromFormat('U.u', sprintf('%d.%06d', $time['sec'], $time['usec'])); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-07-12T16:19:13.567

对，我想一劳永逸地解决这个问题。

说明如何在 PHP 中以**毫秒**和**微秒显示**[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)格式的日期和时间...

 *******毫秒**或“毫秒”在小数点后有 4 位数字，例如 0.1234。**微秒**或“微秒”在小数点后有 7 位数字。秒分数/名称解释[在这里](http://www.sengpielaudio.com/calculator-millisecond.htm)*

PHP 的`date()`函数在毫秒或微秒内的表现并不完全符合预期，因为它只会除整数之外，如格式字符“u”下的[php 日期文档中所述。](http://php.net/manual/en/function.date.php)

基于 Lucky 的评论想法（[此处](https://stackoverflow.com/questions/169428/php-datetime-microseconds-always-returns-0#comment1068246_169458)），但使用更正的 PHP 语法并正确处理秒格式*（Lucky 的代码在秒后添加了不正确的额外 '0'）*

这些也消除了竞争条件并正确格式化秒。

## PHP日期**毫秒**

工作当量`date('Y-m-d H:i:s').".$milliseconds";`

```
list($sec, $usec) = explode('.', microtime(true));
echo date('Y-m-d H:i:s.', $sec) . $usec; 
```

输出 =`2016-07-12 16:27:08.5675`

## **带有微秒**的 PHP日期

等效于`date('Y-m-d H:i:s').".$microseconds";`或如果日期函数在微秒//'u'`date('Y-m-d H:i:s.u')`中表现如预期`microtime()`

```
list($usec, $sec) = explode(' ', microtime());
echo date('Y-m-d H:i:s', $sec) . substr($usec, 1); 
```

输出 =`2016-07-12 16:27:08.56752900`

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-06-04T16:22:05.757

这对我有用，是一个简单的三线：

```
function udate($format='Y-m-d H:i:s.', $microtime=NULL) {
    if(NULL === $microtime) $microtime = microtime();
    list($microseconds,$unix_time) = explode(' ', $microtime);
    return date($format,$unix_time) . array_pop(explode('.',$microseconds));
} 
```

默认情况下（不提供参数），这将在当前调用它的微秒内以这种格式返回一个字符串：

> YYYY-MM-DD HH:MM:SS.UUUUUUUU

一个更简单/更快的（尽管只有一半的精度）如下：

```
function udate($format='Y-m-d H:i:s.', $microtime=NULL) {
    if(NULL === $microtime) $microtime = microtime(true);
    list($unix_time,$microseconds) = explode('.', $microtime);
    return date($format,$unix_time) . $microseconds;
} 
```

这将按以下格式打印出来：

> YYYY-MM-DD HH:MM:SS.UUUU

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-04T05:28:32.347

[日期创建](http://www.php.net/manual/en/function.date-create.php)

> time：strtotime() 接受的格式的字符串，默认为“now”。

[时间](http://www.php.net/manual/en/function.strtotime.php)

> time：要解析的字符串，根据 GNU » Date Input Formats 语法。在 PHP 5.0.0 之前，微秒是不允许的，因为 PHP 5.0.0 允许但忽略它们。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-12-01T22:29:52.663

根据[Lucky](https://stackoverflow.com/users/145709/lucky)的[评论和](https://stackoverflow.com/questions/169428/php-datetime-microseconds-always-returns-0/169458#169458)[PHP 错误数据库中的](http://bugs.php.net/bug.php?id=49779)此功能请求，我使用如下内容：

```
class ExtendedDateTime extends DateTime {
    /**
     * Returns new DateTime object.  Adds microtime for "now" dates
     * @param string $sTime
     * @param DateTimeZone $oTimeZone 
     */
    public function __construct($sTime = 'now', DateTimeZone $oTimeZone = NULL) {
        // check that constructor is called as current date/time
        if (strtotime($sTime) == time()) {
            $aMicrotime = explode(' ', microtime());
            $sTime = date('Y-m-d H:i:s.' . $aMicrotime[0] * 1000000, $aMicrotime[1]);
        }

        // DateTime throws an Exception with a null TimeZone
        if ($oTimeZone instanceof DateTimeZone) {
            parent::__construct($sTime, $oTimeZone);
        } else {
            parent::__construct($sTime);
        }
    }
}

$oDate = new ExtendedDateTime();
echo $oDate->format('Y-m-d G:i:s.u'); 
```

输出：

```
2010-12-01 18:12:10.146625 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-07-17T08:39:51.450

这个怎么样？

```
$micro_date = microtime();
$date_array = explode(" ",$micro_date);
$date = date("Y-m-d H:i:s",$date_array[1]);
echo "Date: $date:" . $date_array[0]."<br>"; 
```

**样本输出**

> > 2013-07-17 08:23:37:0.88862400

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-02-14T13:12:55.040

这应该是最灵活和最精确的：

```
function udate($format, $timestamp=null) {
    if (!isset($timestamp)) $timestamp = microtime();
    // microtime(true)
    if (count($t = explode(" ", $timestamp)) == 1) {
        list($timestamp, $usec) = explode(".", $timestamp);
        $usec = "." . $usec;
    }
    // microtime (much more precise)
    else {
        $usec = $t[0];
        $timestamp = $t[1];
    }
    // 7 decimal places for "u" is maximum
    $date = new DateTime(date('Y-m-d H:i:s' . substr(sprintf('%.7f', $usec), 1), $timestamp));
    return $date->format($format);
}
echo udate("Y-m-d\TH:i:s.u") . "\n";
echo udate("Y-m-d\TH:i:s.u", microtime(true)) . "\n";
echo udate("Y-m-d\TH:i:s.u", microtime()) . "\n";
/* returns:
2015-02-14T14:10:30.472647
2015-02-14T14:10:30.472700
2015-02-14T14:10:30.472749
*/ 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-14T20:34:06.483

strtotime() 接受的格式的字符串它工作！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-05-09T18:45:55.627

在我正在编写的应用程序内部，我需要在 DateTime 对象上设置/显示微时间。似乎让 DateTime 对象识别微秒的唯一方法是使用“YYYY-MM-DD HH:MM:SS.uuuuuu”格式的时间对其进行初始化。日期和时间部分之间的空格也可以是“T”，这在 ISO8601 格式中很常见。

以下函数返回一个初始化为本地时区的 DateTime 对象（当然可以根据需要修改代码以满足个人需求）：

```
// Return DateTime object including microtime for "now"
function dto_now()
{
    list($usec, $sec) = explode(' ', microtime());
    $usec = substr($usec, 2, 6);
    $datetime_now = date('Y-m-d H:i:s\.', $sec).$usec;
    return new DateTime($datetime_now, new DateTimeZone(date_default_timezone_get()));
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-08-29T04:59:50.947

PHP 文档清楚地说“*请注意 date() 将始终生成 000000，因为它需要一个整数参数......* ”。如果您想快速替换`date()`功能，请使用以下功能：

```
function date_with_micro($format, $timestamp = null) {
    if (is_null($timestamp) || $timestamp === false) {
        $timestamp = microtime(true);
    }
    $timestamp_int = (int) floor($timestamp);
    $microseconds = (int) round(($timestamp - floor($timestamp)) * 1000000.0, 0);
    $format_with_micro = str_replace("u", $microseconds, $format);
    return date($format_with_micro, $timestamp_int);
} 
```

（可在此处作为要点：[date_with_micro.php](https://gist.github.com/m-manu/6248802)）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-05-07T19:07:26.940

基于 Lucky 的评论，我编写了一种在服务器上存储消息的简单方法。过去，我使用散列和增量来获取唯一的文件名，但是微秒的日期非常适合这个应用程序。

```
// Create a unique message ID using the time and microseconds
    list($usec, $sec) = explode(" ", microtime());
    $messageID = date("Y-m-d H:i:s ", $sec) . substr($usec, 2, 8);
    $fname = "./Messages/$messageID";

    $fp = fopen($fname, 'w'); 
```

这是输出文件的名称：

```
2015-05-07 12:03:17 65468400 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-09-13T18:20:08.417

一些答案使用了几个时间戳，这在概念上是错误的，并且可能会出现重叠问题：从给定中`21:15:05.999`组合的秒数到微秒。`21:15:06.000``21:15:05.000`

显然最简单的是使用[`DateTime::createFromFormat()`](http://php.net/manual/en/datetime.createfromformat.php)with `U.u`，但[正如评论中所述](https://stackoverflow.com/questions/169428/php-datetime-microseconds-always-returns-0#comment-12220584)，如果没有微秒，它会失败。

所以，我建议这段代码：

```
function udate($format, $time = null) {

    if (!$time) {
        $time = microtime(true);
    }

    // Avoid missing dot on full seconds: (string)42 and (string)42.000000 give '42'
    $time = number_format($time, 6, '.', '');

    return DateTime::createFromFormat('U.u', $time)->format($format);
} 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2012-06-04T11:39:35.493

这种方法比公认的答案更安全：

```
date('Y-m-d H:i:s.') . str_pad(substr((float)microtime(), 2), 6, '0', STR_PAD_LEFT) 
```

输出：

```
2012-06-01 12:00:13.036613 
```

**更新：不推荐**（见评论）

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2010-11-17T09:29:43.117

date('u') 仅从 PHP 5.2 开始受支持。您的 PHP 可能较旧！

# eclipse - Eclipse 的 WTP 翻译输出

> ID：169435
> 
> 赞同：3
> 
> 时间：2008-10-04T00:34:21.097
> 
> 标签：eclipse, jsp, eclipse-wtp, stripes, jspx

如何查看 WTP 对 JSP 和 JSPX 页面所做的中间转换？在一个有大量 .jspx 页面的项目中，我的 Eclipse 问题选项卡中出现了奇怪的语法错误。它们不会影响正在运行的应用程序（Tomcat 6.0）中的任何内容，并且它们仅在更新后的最后 2 周内出现。

我想查看输出的原因是我在[http://stripesframework.org](http://stripesframework.org)使用 Stripes 框架，并且在删除 <stripes:errors /> 行后，特定 .jspx 文件的错误消失了那个文件。同时，语法错误仅在我最近在工作中全新安装 Eclipse 后出现，但随后不久在家中更新了 Eclipse。我想查看输出以确定这应该是谁的问题（WTP、Stripes，或者可能只是我:)。

请记住，这个问题在某种程度上是装饰性的，因为它不会影响任何功能。它只是在 Eclipse 中向我的“问题”选项卡发送垃圾邮件，并在项目资源管理器中显示红色的小 X 图标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T15:58:07.377

现在您必须添加单独的自动化测试下载来执行此操作，并且仅在 3.1 分支中，但它通过 Ctrl+Shift+9 启用“显示翻译”命令。请注意，生成的翻译并非 100% 与服务器在运行时创建的相同——它不打算被执行。此外，最新的 3.0.3 版本包含对翻译器的修复，应该可以清除这些类型的问题（嵌套变量 + 自闭合标签）。3.0.3 将于 11 月发布，应该会干净地更新到 Ganymede SR1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T20:15:11.867

我已经看到 eclipse JSP 编辑器对几乎什么都没有感到非常困惑。您说如果您删除标签，问题就会消失。如果你把标签放回去，它会回来吗？我知道 Eclipse 3.3 有时在打开 JSP 文件时会出现一些问题，并且强制保存会清除文件中的错误消息（我还没有尝试 3.4）。也许这就是发生在你身上的事情。除此之外，您是否在文件中定义了所有正确的 include / xml 命名空间？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T10:02:47.047

我`<stripes:errors/>`在 Ganymede 中的 JSP 和标签有完全相同的问题。对于欧罗巴，没有错误。现在它在问题窗格中显示了几个奇怪的语法错误。但正如 Silvaran 所说，这只是装饰性的，因为该项目可以正确构建并且可以正常工作。尽管如此，它仍然很烦人。

# ruby - linux 服务器上 ruby 项目的持续集成设置

> ID：169442
> 
> 赞同：2
> 
> 时间：2008-10-04T00:41:54.623
> 
> 标签：ruby, linux, integration, continuous

如果可能的话，我想使用开源工具。

这是我找到但没有尝试过的 2 个链接 -

*   [http://pivots.pivotallabs.com/users/chad/blog/articles/471-continuous-integration-in-a-box-exploring-tsttcpw](http://pivots.pivotallabs.com/users/chad/blog/articles/471-continuous-integration-in-a-box-exploring-tsttcpw)
*   [http://laurentbois.com/category/continuous-integration/](http://laurentbois.com/category/continuous-integration/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-04T01:03:18.823

试试这个 CruiseControl.rb

[http://cruisecontrolrb.thoughtworks.com/](http://cruisecontrolrb.thoughtworks.com/)

CruiseControl.rb 是用 Ruby 编写的，专为 ruby​​ 设计。

另一个是 Hudson，它是用 Java 构建的，但它有一个 ruby​​ 插件

[https://hudson.dev.java.net/](https://hudson.dev.java.net/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-04T22:49:24.383

试试 Cinabox（我是作者）。它旨在使这尽可能简单，并使用 Cruisecontrol.rb。有一个截屏视频和自述文件。如果您有问题，请使用自述文件中的 LightHouse 链接开票。

祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-05T10:16:46.303

有一个用 Sinatra 编写的轻量级 CI 服务器，称为 Integrity，您可能想看看它。我主要使用它是因为它支持 git。

[Git 参考](http://github.com/atmos/integrity/tree/master)

# oop - Information Expert & Tell Don't Ask 不与单一职责原则相悖吗？

> ID：169450
> 
> 赞同：25
> 
> 时间：2008-10-04T00:48:40.973
> 
> 标签：oop, solid-principles, single-responsibility-principle, tell-dont-ask

*Information-Expert*、*Tell-Don't-Ask*和*SRP*通常作为最佳实践一起被提及。但我认为他们是矛盾的。这就是我要说的。

支持 SRP 但违反 Tell-Don't-Ask & Info-Expert 的代码：

```
Customer bob = ...;
// TransferObjectFactory has to use Customer's accessors to do its work, 
// violates Tell Don't Ask
CustomerDTO dto = TransferObjectFactory.createFrom(bob); 
```

支持 Tell-Don't-Ask 和 Info-Expert 但违反 SRP 的代码：

```
Customer bob = ...;
// Now Customer is doing more than just representing the domain concept of Customer,
// violates SRP
CustomerDTO dto = bob.toDTO(); 
```

请告诉我这些做法如何和平共存。

术语的定义，

*   信息专家：具有操作所需数据的对象应承载操作。

*   Tell Don't Ask：不要为了工作而向对象索取数据；告诉对象做这项工作。

*   单一职责原则：每个对象都应该有一个狭义的职责。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-04T01:21:50.457

我不认为他们有太大的矛盾，因为他们强调会导致你痛苦的不同事情。一个是关于结构化代码以明确特定职责的位置并减少耦合，另一个是关于减少修改类的原因。

我们每天都必须就如何构建代码以及我们愿意在设计中引入哪些依赖项做出决定。

我们已经建立了许多有用的指导方针、准则和模式，可以帮助我们做出决定。

这些中的每一个都有助于检测我们设计中可能存在的不同类型的问题。对于您可能正在查看的任何特定问题，在某处都会有一个最佳位置。

不同的指导方针确实相互矛盾。仅仅应用您听到或阅读的每一条指导不会使您的设计更好。

对于您今天正在查看的具体问题，您需要确定可能导致您疼痛的最重要因素是什么。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-06-02T06:25:36.393

当您询问对象的状态以告诉对象做某事时，您可以谈论“Tell Don't Ask”。

在您的第一个示例中，TransferObjectFactory.createFrom 只是一个转换器。它不会告诉客户对象在检查它的状态后做某事。

我认为第一个例子是正确的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-04T09:12:23.143

这些课程没有矛盾。DTO 只是充当存储数据的管道，旨在用作哑容器。它当然不违反 SRP。

另一方面，.toDTO 方法是有问题的——为什么客户要承担这个责任？为了“纯粹”的缘故，我会有另一个班级，他的工作是从像客户这样的业务对象创建 DTO。

不要忘记这些原则就是原则，当您可以放弃更简单的解决方案直到不断变化的需求迫使问题出现时，然后这样做。不必要的复杂性绝对是要避免的。

我强烈推荐，顺便说一句，Robert C. Martin 的敏捷模式、实践和原则，以更深入地处理这个主题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-16T17:36:55.757

具有姐妹类的 DTO（就像您一样）违反了您所说的所有三个原则和封装，这就是您在这里遇到问题的原因。

您将此 CustomerDTO 用于什么目的，为什么不能简单地使用 Customer，并在客户内部拥有 DTO 数据？如果您不小心，CustomerDTO 将需要 Customer，而 Customer 将需要 CustomerDTO。

TellDontAsk 表示，如果您基于一个对象（例如客户）的状态做出决定，那么该决定应该在客户类本身内部执行。

一个例子是，如果您想提醒客户支付任何未结账单，那么您致电

```
 List<Bill> bills = Customer.GetOutstandingBills();
  PaymentReminder.RemindCustomer(customer, bills); 
```

这是违规行为。相反，你想做

```
Customer.RemindAboutOutstandingBills() 
```

（当然，您需要传入 PaymentReminder 作为对客户构造的依赖项）。

信息专家说的差不多。

单一职责原则很容易被误解——它说客户类应该有一个职责，但也应该将与“客户”概念一致的数据、方法和其他类分组的职责只封装在一个类中。什么是单一职责很难准确定义，我建议您多阅读有关此事的内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-28T21:28:28.303

Craig Larman 在 Applying UML and Patterns to Object-Oriented Analysis and Design and Iterative Development (2004) 中介绍 GRASP 时讨论了这一点：

> 在某些情况下，Expert 建议的解决方案是不可取的，通常是因为耦合和内聚方面的问题（这些原则将在本章后面讨论）。
> 
> 例如，谁应该负责在数据库中保存销售？当然，要保存的大部分信息都在 Sale 对象中，因此专家可以争辩说责任在于 Sale 类。而且，通过这个决定的逻辑扩展，每个类都有自己的服务来将自己保存在数据库中。但是，按照这种推理行事会导致内聚、耦合和重复方面的问题。例如，Sale 类现在必须包含与数据库处理相关的逻辑，例如与 SQL 和 JDBC（Java 数据库连接）相关的逻辑。该课程不再只关注“成为销售”的纯应用逻辑。现在其他种类的责任降低了它的凝聚力。该类必须耦合到另一个子系统的技术数据库服务，例如 JDBC 服务，而不是仅仅耦合到软件对象领域层中的其他对象，所以它的耦合增加了。并且很可能在许多持久类中会重复类似的数据库逻辑。
> 
> 所有这些问题都表明违反了一个基本的架构原则：设计主要系统关注点的分离。将应用程序逻辑保存在一个地方（例如域软件对象），将数据库逻辑保存在另一个地方（例如单独的持久性服务子系统），等等，而不是将不同的系统关注点混合在同一个组件中。 [11]
> 
> 支持主要关注点的分离提高了设计中的耦合和内聚。因此，即使 Expert 我们可以找到一些理由将数据库服务的责任放在 Sale 类中，但由于其他原因（通常是内聚和耦合），我们最终会得到一个糟糕的设计。

因此，SRP 通常胜过 Information Expert。

但是，依赖倒置原则可以与 Expert 很好地结合。这里的论点是 Customer 不应该具有 CustomerDTO 的依赖关系（从一般到详细），而是相反。这意味着 CustomerDTO 是专家，并且应该知道如何在给定客户的情况下构建自己：

```
CustomerDTO dto = new CustomerDTO(bob); 
```

如果你对新的过敏，你可以去静态：

```
CustomerDTO dto = CustomerDTO.buildFor(bob); 
```

或者，如果你讨厌两者，我们回到 AbstractFactory：

```
public abstract class DTOFactory<D, E> {
    public abstract D createDTO(E entity);
}

public class CustomerDTOFactory extends DTOFactory<CustomerDTO, Customer> {
    @Override
    public CustomerDTO createDTO(Customer entity) {
        return new CustomerDTO(entity);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-23T19:59:27.023

我不是 100% 同意你的两个例子具有代表性，但从一般的角度来看，你似乎是从两个对象和只有两个对象的假设中推理的。

如果您进一步分离问题并创建一个（或多个）专用对象来承担您拥有的个人职责，然后让控制对象将它正在使用的其他对象的实例传递给您已分割的专用对象，您应该能够观察到 SRP（每个职责都由一个专门的对象处理）和 Tell Don't Ask（控制对象告诉它正在组合在一起的专门对象做他们所做的任何事情）之间的愉快折衷，彼此）。

这是一种组合解决方案，它依赖于某种控制器在其他对象之间进行协调和委托，而不会陷入它们的内部细节。

# java - Apache mod_proxy 和 Tomcat 出现 Bad Gateway 502 错误

> ID：169453
> 
> 赞同：55
> 
> 时间：2008-10-04T00:51:54.433
> 
> 标签：java, apache, tomcat, mod-proxy

我们在 Tomcat 6 和 Apache mod_proxy 2.2.3 上运行一个 Web 应用程序。看到很多这样的 502 错误：

> 错误的网关！代理服务器收到来自上游服务器的无效响应。
> 
> 代理服务器无法处理请求 GET /the/page.do。
> 
> 原因：从远程服务器读取错误
> 
> 如果您认为这是服务器错误，请联系网站管理员。
> 
> 错误 502

Tomcat 有很多线程，所以它不受线程限制。我们正在通过 JMeter 向 2400 名用户推送该应用程序。所有的盒子都位于我们的防火墙内，在一个快速卸载的网络上，所以不应该有任何网络问题。

有人对要查看或尝试的事情有任何建议吗？接下来我们将前往 tcpdump。

2008 年 10 月 21 日更新：仍然没有弄清楚这一点。仅看到其中极少数处于负载状态。下面的答案还没有提供任何神奇的答案……还没有。:)

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2010-03-05T16:59:00.510

只是为了添加一些特定设置，我有一个类似的设置（使用 Apache 2.0.63 反向代理到 Tomcat 5.0.27）。

对于某些 URL，Tomcat 服务器可能需要 20 分钟才能返回一个页面。

我最终修改了 Apache 配置文件中的以下设置，以防止其代理操作超时（如果 Tomcat 需要更长的时间来返回页面，则会有很大的溢出因素）：

```
Timeout 5400
ProxyTimeout 5400 
```

* * *

## 一些背景

[仅ProxyTimeout](http://httpd.apache.org/docs/2.0/mod/mod_proxy.html#proxytimeout)是不够的。查看[Timeout](http://httpd.apache.org/docs/2.0/mod/core.html#timeout)的文档，我*猜*（我不确定）这是因为当 Apache 等待来自 Tomcat 的响应时，Apache 和浏览器（或任何 http 客户端）之间没有流量 - 所以Apache 关闭与浏览器的连接。

我发现如果我将 Timeout 设置保留为默认设置（300 秒），那么如果对 Tomcat 的代理请求需要超过 300 秒才能获得响应，浏览器将显示“502 代理错误”页面。我相信这条消息是由 Apache 生成的，知道它充当反向代理，然后关闭与浏览器的连接（这是我目前的理解 - 它可能有缺陷）。

代理错误页面说：

> 代理错误
> 
> 代理服务器收到来自上游服务器的无效响应。代理服务器无法处理请求 GET。
> 
> 原因：从远程服务器读取错误

...这表明 ProxyTimeout 设置太短，而调查表明 Apache 的 Timeout 设置（Apache 和客户端之间的超时）也会影响这一点。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-01T15:30:52.560

所以，在这里回答我自己的问题。我们最终确定，由于 Tomcat 线程超时，我们在负载均衡器中看到了 502 和 503 错误。在短期内，我们增加了超时。从长远来看，我们首先修复了导致超时的应用程序问题。为什么 Tomcat 超时在负载均衡器上被视为 502 和 503 错误仍然是一个谜。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-08-17T12:23:42.097

您可以使用 proxy-initial-not-pooled

请参阅[http://httpd.apache.org/docs/2.2/mod/mod_proxy_http.html](http://httpd.apache.org/docs/2.2/mod/mod_proxy_http.html)：

> 如果设置了此变量，则如果客户端连接是初始连接，则不会重用池连接。这避免了在代理检查连接后，代理发送的数据到达后端之前后端服务器关闭池连接的竞争条件导致的“代理：从远程服务器读取状态行错误”错误消息。必须记住，设置此变量会降低性能，尤其是对于 HTTP/1.0 客户端。

我们也遇到了这个问题。我们通过添加来修复它

```
SetEnv proxy-nokeepalive 1
SetEnv proxy-initial-not-pooled 1 
```

并关闭`keepAlive`所有服务器。

mod_proxy_http 在大多数情况下都很好，但是我们在负载很重的情况下运行它，我们仍然遇到一些我们不理解的超时问题。

但是看看上面的指令是否符合你的需要。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-12-03T05:58:01.630

来自 apache conf 的示例：

```
#Default value is 2 minutes
**Timeout 600**
ProxyRequests off
ProxyPass /app balancer://MyApp stickysession=JSESSIONID lbmethod=bytraffic nofailover=On
ProxyPassReverse /app balancer://MyApp
ProxyTimeout 600
<Proxy balancer://MyApp>
    BalancerMember http://node1:8080/ route=node1 retry=1 max=25 timeout=600
    .........
</Proxy> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-04T03:17:01.673

我猜你正在使用 mod_proxy_http （或代理平衡器）。

查看您的 tomcat 日志（localhost.log 或 catalina.log）我怀疑您在 web 堆栈中看到异常冒泡并关闭 tomcat 工作程序连接到的套接字。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-11-04T14:53:33.657

您可以通过在 ProxyPass 指令中指定代理超时来避免全局超时或必须虚拟主机，如下所示：

```
ProxyPass /svc http://example.com/svc timeout=600
ProxyPassReverse /svc http://example.com/svc timeout=600 
```

注意`timeout=600`秒。

但是，当您有负载均衡器时，这并不总是有效。在这种情况下，您必须在这两个地方添加超时（在 Apache 2.2.31 中测试）

负载均衡器示例：

```
<Proxy "balancer://mycluster">
     BalancerMember "http://member1:8080/svc" timeout=600
     BalancerMember "http://member2:8080/svc" timeout=600
</Proxy> 

ProxyPass /svc "balancer://mycluster" timeout=600
ProxyPassReverse /svc "balancer://mycluster" timeout=600 
```

附注：当 Chrome 是客户端时不需要`timeout=600`on `ProxyPass`（我不知道为什么），但`ProxyPass`Internet Explorer (11) 上没有此超时会中止说服务器重置连接。

我的理论是：

`ProxyPass`客户端（浏览器）和 Apache 之间使用超时。

`BalancerMember`timeout 在 Apache 和后端之间使用。

对于那些使用 Tomcat 或其他支持的人，您可能还需要注意 HTTP 连接器超时。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-02-06T15:17:24.023

您应该能够通过将 timeout 和 proxyTimeout 参数设置为 600 秒来解决此问题。经过一段时间的战斗后，它对我有用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-05-06T07:22:40.117

我知道这不能回答这个问题，但我来到这里是因为我在 nodeJS 服务器上遇到了同样的错误。在找到解决方案之前，我被困了很长时间。我的解决方案只是添加斜杠或`/`在 proxyreserve apache 的末尾。

我的旧代码是：

```
ProxyPass / http://192.168.1.1:3001
ProxyPassReverse / http://192.168.1.1:3001 
```

正确的代码是：

```
ProxyPass / http://192.168.1.1:3001/
ProxyPassReverse / http://192.168.1.1:3001/ 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-12-02T11:16:55.893

您很可能应该在 apache conf 中增加 Timeout 参数（默认值 120 秒）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-12T13:40:34.567

如果你想用 apache 负载均衡器来处理你的 webapp 的超时，你首先必须了解`timeout`. 我试图浓缩我在这里找到的讨论：http: [//apache-http-server.18135.x6.nabble.com/mod-proxy-When-does-a-backend-be-considered-as-failed-td5031316。 html](http://apache-http-server.18135.x6.nabble.com/mod-proxy-When-does-a-backend-be-considered-as-failed-td5031316.html)：

> 似乎只有在与后端的**传输层连接**`mod_proxy`失败时才 认为后端失败。除非被使用。...**`failonstatus/failontimeout`**

 **因此，`failontimeout`apache 需要设置将 webapp 的超时（例如由 tomcat 服务）视为*失败*（并连续切换到热备用服务器）。对于正确的配置，请注意以下错误配置：

> ProxyPass/balancer://localbalance/failontimeout=on timeout=10 failonstatus=50

这是一个错误配置，因为：

> 您在`balancer`此处定义 a ，因此`timeout`参数与`balancer`（与其他两个一样）相关。但是对于 a `balancer`，`timeout`参数不是*连接* 超时（如与 一起使用的`BalancerMember`），而是**等待空闲工作人员/成员的最长时间**（例如，当所有工作人员都忙 *或*处于错误状态时，默认为不等待）。

所以，正确的配置是这样完成的

1.  设置`timeout`在`BalanceMember`级别：

```
 <Proxy balancer://mycluster>
     BalancerMember http://member1:8080/svc timeout=6 
 ... more BalanceMembers here
</Proxy> 
```

2.  设置`failontimeout`在`balancer`

```
ProxyPass /svc balancer://mycluster failontimeout=on 
```

重启阿帕奇。

# mysql - 我应该锁定 ISAM 表以将值插入唯一键字段吗？

> ID：169459
> 
> 赞同：1
> 
> 时间：2008-10-04T00:58:06.977
> 
> 标签：mysql, unique, isam

我在 mySql 中有一个 ISAm 表，它的创建类似于：

```
create table mytable (
 id int not null auto_increment primary key,
 name varchar(64) not null );

create unique index nameIndex on mytable (name); 
```

我有多个进程在此表中插入行。如果两个进程尝试插入相同的“名称”，我想确保其中一个出现错误或找到具有匹配“名称”的行。

我应该锁定表并确保名称不存在，还是应该依靠服务器向尝试插入唯一索引字段中已经存在的值的进程之一提供错误？

我对使用锁有点犹豫，因为我不想陷入僵局。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-04T01:00:09.143

不要打扰锁定，您的索引将防止重复。您应该处理应用程序中的错误代码。

当违反唯一键约束时，MySQL 应返回错误代码 1062（或 SQLSTATE 23000）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-04T01:11:59.867

顺便说一句，您描述了对遇到死锁的恐惧，可能无法清楚地理解因果关系（除非您的查询比问题中描述的要多）。

[别人写](http://www.codinghorror.com/blog/archives/001166.html)的一个很好的总结：

> 1.  查询 1 从锁定资源 A 开始
> 2.  查询 2 从锁定资源 B 开始
> 3.  为了继续，查询 1 需要锁定资源 B，但查询 2 正在锁定该资源，因此查询 1 开始等待它释放
> 4.  同时，查询 2 尝试完成，但它需要锁定资源 A 才能完成，但它无法获得，因为查询 1 已锁定。

# iphone - 如果函数执行时间过长，iPhone 会超时吗？

> ID：169470
> 
> 赞同：3
> 
> 时间：2008-10-04T01:06:55.370
> 
> 标签：iphone, cocoa

我有一个函数，我使用可可的 Url 对象从网络获取外部资源。它在模拟器上运行良好，但偶尔会在设备本身上失败（这是一个谷歌查询，所以资源显然确实存在）。这让我相信硬件上有一些内部超时障碍，但还没有读到这样的障碍是否存在。

还有其他人遇到过类似的问题吗？或者知道超时是否已记录或可以更改？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-04T03:27:34.367

如果您的应用程序似乎变得无响应，iPhone OS 将终止它 - 基本上是如果您的主线程阻塞了几秒钟。这在退出时也很重要 - 如果您在退出时保存，您将有一个非常小的窗口来完成保存，这与操作系统可能正在执行其他操作的事实相得益彰。如果您退出操作系统的时间过长，则会杀死您的应用程序，这对用户来说就像您的应用程序无法保存一样。

我强烈建议您测试与硬件而不是模拟器相关的任何时间。该模拟器非常适合快速周转调试，但不能代表实际硬件的性能。

如果您有任何繁重的工作要做，请在单独的线程上执行，以便 UI 保持对用户和操作系统的响应。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-06T13:31:36.223

iPhone 对应用程序启动施加了超时。因此，如果您在 applicationDidFinishLaunching 中执行广泛的处理：例如，应用程序将被终止并生成崩溃日志。不幸的是，我在官方文档中没有提到它。

启动过程完成后，我不知道有任何限制函数执行时间的超时。我已经在设备上尝试过，在主线程中休眠 30 秒，效果很好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-01T18:19:50.087

我在 applicationDidFinishLaunching 中读取一个大文件时注意到了这个超时。我的应用程序将在启动期间终止。在控制台中，我看到了日志消息：

```
Sun Mar  1 10:41:03 unknown SpringBoard[22] <Warning>: <myappid>.* failed to launch in time 
```

我的解决方案是使用`performSelector: withObject: afterDelay: 0.0`从 appliationDidFinishLaunching 快速返回并在 runloop 上排队加载文件。这避免了设置新线程和处理多线程的复杂性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-04T02:56:36.333

我知道如果应用程序使用太多内存，iPhone OS 会杀死它，所以如果应用程序对事件没有响应时间过长，如果它使用相同的策略，我不会感到惊讶。

如果您正在编写桌面应用程序，问题将表现为旋转的彩虹沙滩球光标，并且您的应用程序不会响应鼠标点击。Mac OS X 不会终止您的应用程序，但如果您在 Dock 中按住 ctrl 单击其图标，它会提供强制退出它。

这里的主要问题是您正在占用事件处理线程。你有两个选择：

1.  使用非阻塞 I/O，因此您无需在一次调用中执行 Web 请求，而是使用 API 在后台获取数据，然后在完成时调用您指定的方法。
2.  在单独的线程上使用阻塞 I/O。就像你现在做的那样做网络请求，但是在一个单独的线程中，然后在你完成后向主线程发出信号。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-06T05:38:50.920

如果您使用的是 NSUrlRequest，请确保未达到超时间隔。您的手机的互联网连接速度可能比您的模拟器慢。

从文档：

```
+ (id)requestWithURL:(NSURL *)theURL cachePolicy:(NSURLRequestCachePolicy)cachePolicy timeoutInterval:(NSTimeInterval)timeoutInterval

Parameters
theURL
The URL for the new request.

cachePolicy
The cache policy for the new request.

timeoutInterval
The timeout interval for the new request, in seconds.

Return Value
The newly created URL request. 
```

# c# - 在路径中使用“~”解析为 C:\

> ID：169477
> 
> 赞同：3
> 
> 时间：2008-10-04T01:10:19.573
> 
> 标签：c#, asp.net

我正在尝试实现一个服务器控件，该控件会在 ASP.NET 站点的 web 目录中设置几个文件。我使用 VS Web Dev Express 2008 作为我的 IDE。当我调用`HttpContext.Current.Request.ApplicationPath`以获取 Web 根目录的路径以便我可以找到这些文件时，它返回 C:。有没有搞错？

绝对路径工作得很好，但我希望能够为服务器控件提供一个相对目录并让它做它的事情。我做错了什么？

```
public String Target
{
    get { return _target; }
    set
    {
        if (value.StartsWith("~"))
        {
            // WTF? Gives me C:\? Why?
            _target = HttpContext.Current.Request.ApplicationPath +
                value.Substring(1);
        }
        else
        {
            _target = value;
        }
    }
}

private String _target;

protected override void Render(HtmlTextWriter writer)
{
    HtmlControl wrapper = new HtmlGenericControl("div");
    int fileCount = 0;

    try
    {
        DirectoryInfo dir = new DirectoryInfo(_target);
        foreach (FileInfo f in dir.GetFiles())
        {
            fileCount++;
            a = new HtmlAnchor();
            a.Attributes.Add("href", f.FullName);
            a.InnerHtml = f.Name;
            wrapper.Controls.Add(a);
        }
    }
    catch (IOException e)
    {
        throw e;
    }

    Controls.Add(wrapper);
    base.Render(writer);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-04T01:19:51.397

这可能是因为它使用了开发 Web 服务器，它可以提供硬盘驱动器上任何目录中的文件。它没有任何特定的根。你能在 IIS 下运行你的项目（假设你的 windows 版本支持它），看看你是否得到相同的结果？

要完全摆脱这个问题，您可以在 web.config 中硬编码您想要查看的路径，并解决 Request.ApplicationPath 返回的任何问题。

[编辑]

刚发现可以用

```
HTTPContext.Current.Request.ServerVariables("APPL_PHYSICAL_PATH") 
```

在硬盘上返回应用程序的路径。我很确定这就是你要找的。如果这不正确，请查看所有其他[ServerVariables](http://neural.cs.nthu.edu.tw/jang/sandbox/asp/examples/request5.asp)以查看您是否可以获得所需的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-04T01:37:49.800

这个怎么样：

```
Server.MapPath(ResolveUrl("~/filename")) 
```

TLAnews.com 页面上也有信息，标题为“[*了解 ASP.NET 中的路径”*](http://www.tla.ch/TLA/NEWS/2006vb/07-06-01-VB-url-path.htm)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-04T02:17:09.360

如果您想在设计时获取目录，则可能需要[ADME 开发人员工具包。](http://peterblum.com/ADME/Home.aspx)

# c# - C# & Win32 在单独的窗口关闭/关闭时通知

> ID：169483
> 
> 赞同：1
> 
> 时间：2008-10-04T01:13:17.087
> 
> 标签：c#, .net, winapi, events

有没有办法将事件附加到来自 .NET 进程的外部/单独窗口，当外部窗口关闭或即将关闭我的应用程序时可以通知？

我发现这个[http://msdn.microsoft.com/en-us/library/ms229658.aspx](http://msdn.microsoft.com/en-us/library/ms229658.aspx)

但这似乎只适用于 .NET 紧凑型框架。我正在寻找使用 .NET 2.0 框架的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-04T01:32:29.670

[CodeProject](http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx)上有一篇文章介绍了使用全局挂钩从其他应用程序接收 Windows 消息。

你能[等待进程退出](http://support.microsoft.com/kb/305369)吗？

或者您是否需要轮询并检查您是否仍然可以[找到](http://msdn.microsoft.com/en-us/library/ms633499(VS.85).aspx)窗口？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-04T01:31:19.640

使用 WH_CBT 参数查看 SetWindowsHookEx。将有一个 HCBT_DESTROYWND 条目。

# hardware - 用于开发的最佳双高清设置

> ID：169497
> 
> 赞同：0
> 
> 时间：2008-10-04T01:30:04.760
> 
> 标签：hardware, hard-drive

我有一台用于开发的机器，里面有两个 7200 RPM 160 GB SATA HD。

到目前为止，我在网上找到的信息似乎有点矛盾，关于我应该在哪些驱动器上安装哪些东西（操作系统、交换文件、程序、解决方案/源代码/其他数据）来获得最受益于这种情况。

有些人建议为操作系统和/或交换设置一个单独的分区，有些人不介意。有人说程序应该与操作系统在同一个物理驱动器上，数据在另一个上，有些相反。与交换和操作系统相同。

我将安装 Vista 64 位作为我的操作系统，并定期使用 Visual Studio 2008、VMWare Workstation、SQL Server 管理工作室等（相当标准的开发工具）。

所以我问你——你会怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T01:40:38.437

如果它们都通过同一个磁盘控制器，那么无论您采用哪种方式，性能方面都不会有太大差异；如果你要做很多虚拟机，我会为操作系统和交换/程序和数据拆分一个驱动器，然后将所有虚拟机保留在另一个驱动器上。

如果主机出现故障或升级，将所有虚拟机都放在一个独立的驱动器上，您可以将该驱动器无缝地移动到另一台机器上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-04T01:41:51.587

如果驱动器在您的 BIOS 中支持 RAID 配置，您应该执行以下操作之一：

RAID 1（镜像） - 由于这是一台开发机器，这将让您拥有容错能力，让您放心，您的代码是安全的（以及环境，因为它们很难放在一起）。您可以获得更好的读取性能，因为它可以从两个/任何一个驱动器读取。但是，您不会在写入方面获得任何性能提升。

RAID 0 - 这里没有容错，但这是最快的配置，因为您可以读取和注销两个驱动器。如果您只想要尽可能快的性能并且您知道您的代码在其他地方（源代码控制）是安全的，那就太好了。

不要担心多个分区或操作系统/数据配置，因为在开发机器上你无论如何都需要它，而且你不应该运行繁重的多用户数据库或任何东西（如服务器）。

但是，如果您的 BIOS 不支持 RAID 配置，那么您可能会考虑在两个驱动器上进行操作系统/数据拆分，以平衡它们的使用（但正如您所提到的，将程序保留在系统驱动器上，因为它有助于缓存）。由您决定将交换文件放在哪里（操作系统会给您转储文件，但数据驱动器的利用率可能较低）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-04T01:55:15.037

我建议如果 160gb 的总容量可以满足您的需求（为操作系统、应用程序和源代码提供足够的空间，这取决于您打算在上面放什么），那么您应该将驱动器镜像到 RAID 1 中，除非您有将数据备份到的服务器、外部硬盘驱动器、在线备份解决方案或将数据副本保存在多个物理驱动器上的其他方式。

如果您需要使用所有驱动器容量，我建议将第一个驱动器用于操作系统和应用程序，将第二个驱动器用于数据。纯粹是因为，如果您在某个时候更换计算机，第一个驱动器上的操作系统对您没有多大好处，并且大多数应用程序都必须重新安装，但您可以随身携带整个数据驱动器。

至于划分操作系统，一个很大的缺点是没有给分区足够的空间，最终您可能需要使用分区软件从驱动器上的另一个分区窃取一些空间。为 OS 分区分配一定数量的空间似乎永远不会失败，在安装后你有几个 gigs 可用空间，所以你认为你很好，但随着时间的推移，事情在那个分区上堆积，你用完了的空间。

考虑到这一点，我仍然通常使用操作系统分区，因为它在重新加载系统时很有用，您可以格式化该分区以清除操作系统但保留其余数据。防止空间累积过快的方法是更改​​我的文档文件夹的位置，更改 temp 和 tmp 等项目的环境变量。但是，有些东西只是拒绝将他们的数据放在系统分区以外的任何地方。我以前用10gb，现在我用20gb。

当你的交换文件根据需要增长和缩小时，划分你的交换空间对于减少驱动器碎片很有用。这又是一个猜测你需要多少交换的问题。这在很大程度上取决于您拥有的内存量以及一次将运行多少东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-04T02:38:45.853

将一个驱动器标记为您的仓库，将您所有的源代码、数据、资产等放在那里并定期备份。您会希望它稳定且易于恢复。如果需要，您甚至可以将“我的文档”切换到此处。

另一个驱动器应包含操作系统、驱动程序和所有应用程序。这使得每 18-24 个月擦除驱动器和重新安装操作系统变得容易且安全，就像您在使用 Windows 时所做的那样。

如果你想提高性能，有人说把交换放在仓库驱动器上。这将提高操作系统性能，但会缩短驱动器的使用寿命。

实际上，这一切都取决于您的目标。如果您需要更高的性能，那么您可以平衡活动水平。如果您需要更高的安全性，那么您可以使用 RAID 并对其进行镜像。我的组合提供了易于维护的合理级别的数据安全性和最小的位腐烂问题。

您最活跃的文件将是注册表、页面文件和正在运行的应用程序。如果您正在处理大量数据，那么这些文件也将非常活跃。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-04T02:43:02.053

对于建议 RAID 的海报 - 160GB 可能还可以，但我会犹豫是否更大。驱动器中的软错误会降低 RAID 的整体可靠性。有关详细信息，请参阅这些文章：

[http://alumnit.ca/~apenwarr/log/?m=200809#08](http://alumnit.ca/~apenwarr/log/?m=200809#08) [http://permabit.wordpress.com/2008/08/20/are-fiber-channel-and-scsi-drives-more-reliable /](http://permabit.wordpress.com/2008/08/20/are-fibre-channel-and-scsi-drives-more-reliable/)

您无法相信您在互联网上阅读的所有内容，但推理对我来说是有道理的。

抱歉，我实际上无法回答您的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-04T02:52:39.213

我通常运行一个带有两个驱动器的盒子。一种用于操作系统、交换、典型程序和应用程序，另一种用于虚拟机、“大型”应用程序（例如，Adobe CS 套件，基本上在启动时会大量撞击磁盘的任何东西）。

但我也运行一个便宜的文件服务器（只是一台旧机器，在 RAID1 中有 coupla 数百 gig 的磁盘空间），我用它来存储与我的各种项目相关的任何内容。我发现这是一个比将所有内容都存储在我的主开发盒上更好的解决方案，而且成本不高，让我可以在某个地方运行网络服务器、我的个人版本控制等。

虽然我承认，它确实没有做太多我不能在我的机器上做的事情。我发现这是一个很好的解决方案，因为它通过强制我将所有工作保存在一个可以轻松备份、复制到其他地方等的地方来帮助防止我在工作站的文件系统中随意传播东西。我可以把它留在所有地方晚上没有巨额电费（它在负载下使用 <50W）所以它可以用一个小脚本将自己备份到一个远程站点，我可以通过 SSH 从外部连接到它（所以我可以随时 SCP 任何我需要的东西）。

但真正最重要的好处是我在我的工作站上没有存储任何价值（至少没有任何不在服务器上的东西）。这意味着如果它坏了，或者如果我想使用我的笔记本电脑等，一切都可以随时访问。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-04T01:56:09.810

我会将操作系统和所有应用程序放在第一个磁盘（1 个分区）上。然后，将来自 SQL 服务器的数据（以及任何其他溢出数据）放在第二个磁盘（1 个分区）上。这就是我设置机器的方式，而没有关于您正在构建的任何其他细节。还要确保你有备份，这样你就不会丢失工作。镜像两个驱动器（如果您具有 RAID 功能）甚至可能是值得的，因此如果/当其中一个驱动器发生故障时，您不会失去任何进展。此外，每天备份到外部磁盘。当你不小心删除了错误的东西时，RAID 不会拯救你。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-04T02:05:39.633

一般来说，我会尝试拆分将要进行大量 I/O 的事情（例如，如果您在 VS 上的自动保存相当频繁地关闭）将其视为一种 I/O 多线程

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-04T02:34:43.773

通过将我的虚拟机放在单独的磁盘上，我观察到了显着的加速。每当 Windows 在 VM 中做一些愚蠢的事情时（例如，*再次*索引），它并不会严重地破坏我的 Mac 磁盘。

另一个问题是，当许多工具（想到 Visual Studio）在非主磁盘上时，它们会以令人沮丧的方式中断。

将第二张磁盘用于大的随机事物。

# c# - 如何使用 VS 2005（特别是 C#）设计高性能网格

> ID：169501
> 
> 赞同：2
> 
> 时间：2008-10-04T01:31:18.033
> 
> 标签：c#

我需要使用 Visual Studio 2005 构建一个高性能的 winforms 数据网格，我不知道从哪里开始。我已经构建了大量的数据网格应用程序，但是当数据不断刷新时，这些应用程序都不是很好。

网格将大约为 100 行 x 40 列，并且网格中的每个单元格将每秒更新 1 到 2 次（某些单元格可能更多）。对我来说，这是开箱即用数据网格的最大缺点，重绘效率不高。

夫妻注意事项

1) 没有第三方供应商。这个网格是我们所有应用程序的支柱，因此，当 XCeed 或 Syncfusion 或任何可以让我们更快地启动和运行的东西时，我们会猛烈抨击它的局限性并被淹没。我宁愿预先进行额外的工作，并拥有一个完全符合我们需要的网格。

2) 我可以访问 Visual Studio 2008，所以如果在 2008 年启动它会更好，那么我可以这样做。如果它是一个折腾，我想坚持2005年。

那么这里最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-04T01:58:35.217

如果您有许多以不同速率更新的单元格，我会推荐以下方法。与其在每次值更改时尝试使每个单元格无效，不如通过限制刷新率来获得更好的效果。

有一个以预定义速率触发的计时器，例如每秒 4 次，然后每次触发时重新绘制自上次以来已更改的单元格。然后，您可以调整更新速率，以便通过一些简单的测试找到性能和可用性之间的最佳折衷。

这样做的好处是不会尝试太频繁地更新，从而降低您的 CPU 性能。它在每个刷新周期之间批量更改，因此当只有最新值实际上值得绘制时，两次快速更改相隔几分之一秒的值不会导致两次刷新。

请注意，这种延迟绘制仅适用于值的快速更新，不适用于一般绘制，例如当用户移动滚动条时。在这种情况下，您应该尽可能快地绘制滚动事件，以提供良好的流畅体验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-04T01:47:12.743

我们使用 Syncfusion 网格控件，据我所知，如果您花时间修改它，它会非常灵活。我自己不使用控件，我的一位同事负责所有的网格工作，但我们已经很好地将其扩展到我们的需求，包括自定义绘画。

我知道这并不能完全回答您的问题，但是无论您的预期如何，从头开始编写这样的控件总是比您预期的要复杂得多。由于它会不断更新，我认为它将是数据绑定的，这本身就是一件苦差事，尤其是要使其具有高性能。然后就是调试了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T04:36:57.690

试试 DevExpress 或 ComponentOne 的网格。我从经验中知道，除了最琐碎的应用程序之外，内置网格永远不会足够快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-24T20:17:12.247

我打算建立一个网格控件来做与打发时间相同的事情，但仍然没有时间。大多数商业网格控件的内存占用很大，更新通常是一个问题。

我的提示是（如果您使用自定义控件） 1\. 扩展控件（不是 UserControl 或类似的东西）。它会给你速度，而不会损失太多。2\. 就我而言，我的目标是网格以包含更多数据。假设有一百万行有大约 20-100 列。在这种情况下，自己绘制通常更有意义。不要试图用一些控件来表示每个单元格（比如标签、文本框等）。它们消耗了大量资源（窗口句柄、内存等）。3\. 使用 MVC。

这个想法很简单：在任何给定时间，由于屏幕尺寸限制、人眼限制等原因，您可以显示有限数量的数据所以即使您有无数行和列以及您拥有的更新数量，您的视口也非常小即使网格 id 后面的数据每秒被更新无数次，每秒执行的操作也不超过 5 次。还要记住，即使每个单元格要显示的文本/图像很大，用户仍然受到单元格大小的限制。

缓存样式（表示文本大小、字体、颜色等的通用词）在这种情况下也有帮助，具体取决于您将在网格中使用它们的数量。

完成一些基本绘图（高光、网格、边界、边框等）以获得各种效果需要做更多的工作。

我记不太清了，但是 sourceforge 上有 ac# .net 网格，它可以让你很好地了解如何开始。该网格提供了 2 个选项，VirtualGrid，其中模型数据不由网格保存，使其非常轻量级，以及一个 Real 网格（传统），其中数据存储由网格本身拥有（主要创建副本，但取决于应用程序)

对于超级敏捷（就更新而言），拥有“VirtualGrid”可能会更好

只是我的想法

# javascript - 使用jQuery获取表单输入字段？

> ID：169506
> 
> 赞同：441
> 
> 时间：2008-10-04T01:34:56.420
> 
> 标签：javascript, jquery

我有一个包含许多输入字段的表单。

当我使用 jQuery 捕获提交表单事件时，是否可以在关联数组中获取该表单的所有输入字段？

* * *

## 回答 #1

> 赞同：562
> 
> 时间：2008-10-04T02:01:49.500

```
$('#myForm').submit(function() {
    // get all the inputs into an array.
    var $inputs = $('#myForm :input');

    // not sure if you wanted this, but I thought I'd add it.
    // get an associative array of just the values.
    var values = {};
    $inputs.each(function() {
        values[this.name] = $(this).val();
    });

}); 
```

* * *

感谢 Simon_Weaver 的提示，这是您可以使用的另一种方法[`serializeArray`](http://api.jquery.com/serializeArray/)：

```
var values = {};
$.each($('#myForm').serializeArray(), function(i, field) {
    values[field.name] = field.value;
}); 
```

请注意，此代码段将在`<select multiple>`元素上失败。

[新的 HTML 5 表单输入](http://diveintohtml5.ep.io/forms.html)似乎不适`serializeArray`用于 jQuery 1.3 版。这适用于版本 1.4+

* * *

## 回答 #2

> 赞同：266
> 
> 时间：2009-09-18T07:20:37.453

在这个问题上迟到了，但这更容易：

```
$('#myForm').submit(function() {
    // Get all the forms elements and their values in one step
    var values = $(this).serialize();

}); 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2010-02-23T02:31:40.520

jquery.form插件可能有助于[解决](http://docs.jquery.com/Plugins:Forms)其他人在这个问题上所寻找的东西。我不确定它是否直接做你想要的。

还有[serializeArray](http://api.jquery.com/serializeArray/)函数。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-04-22T02:20:30.503

有时我发现一次获得一个更有用。为此，有这样的：

```
var input_name = "firstname";
var input = $("#form_id :input[name='"+input_name+"']"); 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-11-27T17:27:13.137

这是另一种解决方案，通过这种方式，您可以获取有关表单的所有数据并将其用于服务器端调用或其他内容。

```
$('.form').on('submit', function( e )){ 
   var form = $( this ), // this will resolve to the form submitted
       action = form.attr( 'action' ),
         type = form.attr( 'method' ),
         data = {};

     // Make sure you use the 'name' field on the inputs you want to grab. 
   form.find( '[name]' ).each( function( i , v ){
      var input = $( this ), // resolves to current input element.
          name = input.attr( 'name' ),
          value = input.val();
      data[name] = value;
   });

  // Code which makes use of 'data'.

 e.preventDefault();
} 
```

然后，您可以将其与 ajax 调用一起使用：

```
function sendRequest(action, type, data) {
       $.ajax({
            url: action,
           type: type,
           data: data
       })
       .done(function( returnedHtml ) {
           $( "#responseDiv" ).append( returnedHtml );
       })
       .fail(function() {
           $( "#responseDiv" ).append( "This failed" );
       });
} 
```

希望这对你们任何人都有用:)

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-10-04T08:11:38.663

```
$('#myForm').bind('submit', function () {
  var elements = this.elements;
});
```

elements 变量将包含表单中的所有输入、选择、文本区域和字段集。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-06-12T07:43:55.453

**这段代码将** 代替名称起作用，电子邮件输入您的表单字段名称

```
$(document).ready(function(){
  $("#form_id").submit(function(event){
    event.preventDefault();
    var name = $("input[name='name']",this).val();
    var email = $("input[name='email']",this).val();
  });
}); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-12-08T15:53:28.577

有一个类似的问题，有轻微的扭曲，我想我会把它扔掉。我有一个获取表单的回调函数，所以我已经有一个表单对象并且无法在`$('form:input')`. 相反，我想出了：

```
 var dataValues = {};
    form.find('input').each(
        function(unusedIndex, child) {
            dataValues[child.name] = child.value;
        }); 
```

它的情况相似但不完全相同，但我发现这个线程非常有用，并认为我会把它放在最后，希望其他人觉得它有用。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-11-10T11:45:02.927

[http://api.jquery.com/serializearray/](http://api.jquery.com/serializearray/)

```
$('#form').on('submit', function() {
    var data = $(this).serializeArray();
}); 
```

这也可以在没有 jQuery 的情况下使用 XMLHttpRequest Level 2 FormData 对象来完成

[http://www.w3.org/TR/2010/WD-XMLHttpRequest2-20100907/#the-formdata-interface](http://www.w3.org/TR/2010/WD-XMLHttpRequest2-20100907/#the-formdata-interface)

```
var data = new FormData([form]) 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-04T02:01:04.010

联想？并非没有一些工作，但您可以使用通用选择器：

```
var items = new Array();

$('#form_id:input').each(function (el) {
    items[el.name] = el;
}); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-02-03T21:40:54.257

不要忘记复选框和单选按钮 -

```
var inputs = $("#myForm :input");
var obj = $.map(inputs, function(n, i) {
  var o = {};
  if (n.type == "radio" || n.type == "checkbox")
    o[n.id] = $(n).attr("checked");
  else
    o[n.id] = $(n).val();
  return o;
});
return obj 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2012-03-27T14:03:36.467

jQuery`serializeArray`不包含禁用字段，因此如果您也需要这些字段，请尝试：

```
var data = {};
$('form.my-form').find('input, textarea, select').each(function(i, field) {
    data[field.name] = field.value;
}); 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-05-09T13:41:20.710

似乎很奇怪，没有人赞成或提出一个简洁的解决方案来获取列表数据。几乎没有任何形式会成为一维对象。

当然，此解决方案的缺点是您的单例对象必须在 [0] 索引处访问。但是 IMO 这比使用十几种地图解决方案中的一种要好得多。

```
var formData = $('#formId').serializeArray().reduce(function (obj, item) {
    if (obj[item.name] == null) {
        obj[item.name] = [];
    } 
    obj[item.name].push(item.value);
    return obj;
}, {}); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-09-05T08:59:10.657

我遇到了同样的问题并以不同的方式解决了它。

```
var arr = new Array();
$(':input').each(function() {
 arr.push($(this).val());
});
arr; 
```

它返回所有输入字段的值。您可以将 更改`$(':input')`为更具体。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2011-10-04T15:11:07.870

**与nickf**给出的解决方案相同，但考虑了数组输入名称，例如

`<input type="text" name="array[]" />`

```
values = {};
$("#something :input").each(function() {
  if (this.name.search(/\[\]/) > 0) //search for [] in name
  {
    if (typeof values[this.name] != "undefined") {
      values[this.name] = values[this.name].concat([$(this).val()])
    } else {
      values[this.name] = [$(this).val()];
    }
  } else {
    values[this.name] = $(this).val();
  }
}); 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2019-07-25T12:57:25.860

我希望这是有帮助的，也是最简单的。

```
 $("#form").submit(function (e) { 
    e.preventDefault();
    input_values =  $(this).serializeArray();
  }); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-06-19T09:40:15.243

如果您需要从输入中获取多个值并且您使用 [] 来定义具有多个值的输入，则可以使用以下命令：

```
$('#contentform').find('input, textarea, select').each(function(x, field) {
    if (field.name) {
        if (field.name.indexOf('[]')>0) {
            if (!$.isArray(data[field.name])) {
               data[field.name]=new Array();
            }
            data[field.name].push(field.value);
        } else {
            data[field.name]=field.value;
        }
    }                   
}); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-12-14T11:11:36.413

我在没有每个循环的情况下使用此代码：

```
$('.subscribe-form').submit(function(e){
    var arr=$(this).serializeArray();
    var values={};
    for(i in arr){values[arr[i]['name']]=arr[i]['value']}
    console.log(values);
    return false;
}); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2017-08-22T17:51:25.907

受到[Lance Rushing](https://stackoverflow.com/a/1443005/3574916)和[Simon_Weaver](https://stackoverflow.com/a/2315772/3574916)答案的启发，这是我最喜欢的解决方案。

```
$('#myForm').submit( function( event ) {
    var values = $(this).serializeArray();
    // In my case, I need to fetch these data before custom actions
    event.preventDefault();
}); 
```

输出是一个对象数组，例如

```
[{name: "start-time", value: "11:01"}, {name: "end-time", value: "11:11"}] 
```

使用下面的代码，

```
var inputs = {};
$.each(values, function(k, v){
    inputs[v.name]= v.value;
}); 
```

它的最终输出将是

```
{"start-time":"11:01", "end-time":"11:01"} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-10-05T13:14:10.573

当我需要对所有表单字段进行 ajax 调用时，我遇到了**:input**选择器返回所有复选框的问题，无论它们是否被选中。我添加了一个新的选择器来获取可提交的表单元素：

```
$.extend($.expr[':'],{
    submitable: function(a){
        if($(a).is(':checkbox:not(:checked)'))
        {
            return false;
        }
        else if($(a).is(':input'))
        {
            return true;
        }
        else
        {
            return false;
        }
    }
}); 
```

用法：

```
$('#form_id :submitable'); 
```

我还没有用多个选择框测试它，但它可以像标准提交那样获取所有表单字段。

我在自定义 OpenCart 网站上的产品选项以包括复选框和文本字段以及标准选择框类型时使用了它。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2012-04-15T17:56:03.623

serialize() 是最好的方法。@Christopher Parker 说 Nickf 的 anwser 做得更多，但是它没有考虑到表单可能包含 textarea 和选择菜单。使用 serialize() 然后根据需要对其进行操作要好得多。来自serialize() 的数据可以在Ajax post 或get 中使用，所以没有问题。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-12-08T07:03:30.610

希望这可以帮助某人。:)

```
// This html:
// <form id="someCoolForm">
// <input type="text" class="form-control" name="username" value="...." />
// 
// <input type="text" class="form-control" name="profile.first_name" value="...." />
// <input type="text" class="form-control" name="profile.last_name" value="...." />
// 
// <input type="text" class="form-control" name="emails[]" value="..." />
// <input type="text" class="form-control" name="emails[]" value=".." />
// <input type="text" class="form-control" name="emails[]" value="." />
// </form>
// 
// With this js:
// 
// var form1 = parseForm($('#someCoolForm'));
// console.log(form1);
// 
// Will output something like:
// {
// username: "test2"
// emails:
//   0: ".@....com"
//   1: "...@........com"
// profile: Object
//   first_name: "..."
//   last_name: "..."
// }
// 
// So, function below:

var parseForm = function (form) {

    var formdata = form.serializeArray();

    var data = {};

    _.each(formdata, function (element) {

        var value = _.values(element);

        // Parsing field arrays.
        if (value[0].indexOf('[]') > 0) {
            var key = value[0].replace('[]', '');

            if (!data[key])
                data[key] = [];

            data[value[0].replace('[]', '')].push(value[1]);
        } else

        // Parsing nested objects.
        if (value[0].indexOf('.') > 0) {

            var parent = value[0].substring(0, value[0].indexOf("."));
            var child = value[0].substring(value[0].lastIndexOf(".") + 1);

            if (!data[parent])
                data[parent] = {};

            data[parent][child] = value[1];
        } else {
            data[value[0]] = value[1];
        }
    });

    return data;
}; 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-04-16T19:17:35.953

所有答案都很好，但是如果您想在该函数中忽略某个字段？简单，给字段一个属性，例如ignore_this：

```
<input type="text" name="some_name" ignore_this> 
```

在您的序列化函数中：

```
if(!$(name).prop('ignorar')){
   do_your_thing;
} 
```

这就是您忽略某些字段的方式。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-02-17T09:59:26.663

试试下面的代码：

```
jQuery("#form").serializeArray().filter(obje => 
obje.value!='').map(aobj=>aobj.name+"="+aobj.value).join("&") 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-02-21T16:27:14.637

对于多个选择元素 ( `<select multiple="multiple">`)，我修改了 @Jason Norwood-Young 的解决方案以使其正常工作。

答案（如已发布）仅从选择的第一个元素中获取值，而不是**全部**。它也没有初始化或返回`data`，前者抛出一个 JavaScript 错误。

这是新版本：

```
function _get_values(form) {
  let data = {};
  $(form).find('input, textarea, select').each(function(x, field) {
    if (field.name) {
      if (field.name.indexOf('[]') > 0) {
        if (!$.isArray(data[field.name])) {
          data[field.name] = new Array();
        }
        for (let i = 0; i < field.selectedOptions.length; i++) {
          data[field.name].push(field.selectedOptions[i].value);
        }

      } else {
        data[field.name] = field.value;
      }
    }

  });
  return data
} 
```

用法：

```
_get_values($('#form')) 
```

注意：您只需要确保`name`您的选择已`[]`附加到它的末尾，例如：

```
<select name="favorite_colors[]" multiple="multiple">
  <option value="red">Red</option>
  <option value="green">Green</option>
  <option value="blue">Blue</option>
</select> 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2020-05-18T18:32:12.083

```
$("#form-id").submit(function (e) { 
  e.preventDefault();
  inputs={};
  input_serialized =  $(this).serializeArray();
  input_serialized.forEach(field => {
    inputs[field.name] = field.value;
  })
  console.log(inputs)
}); 
```

# bash - 如何迭代 Bash 中变量定义的一系列数字？

> ID：169511
> 
> 赞同：1941
> 
> 时间：2008-10-04T01:38:43.777
> 
> 标签：bash, shell, for-loop, syntax

当范围由变量给出时，如何迭代 Bash 中的数字范围？

[我知道我可以做到这一点（在 Bash文档](http://www.gnu.org/software/bash/manual/bashref.html#Brace-Expansion)中称为“序列表达式” ）：

```
 for i in {1..5}; do echo $i; done 
```

这使：

> 1
> 2
> 3
> 4
> 5

但是，如何用变量替换任一范围端点？这不起作用：

```
END=5
for i in {1..$END}; do echo $i; done 
```

哪个打印：

> {1..5}

* * *

## 回答 #1

> 赞同：2201
> 
> 时间：2008-10-04T01:41:55.673

```
for i in $(seq 1 $END); do echo $i; done
```

编辑：我更喜欢`seq`其他方法，因为我实际上可以记住它；）

* * *

## 回答 #2

> 赞同：628
> 
> 时间：2008-10-04T21:43:47.913

该`seq`方法是最简单的，但 Bash 具有内置的算术评估。

```
END=5
for ((i=1;i<=END;i++)); do
    echo $i
done
# ==> outputs 1 2 3 4 5 on separate lines 
```

该`for ((expr1;expr2;expr3));`构造就像`for (expr1;expr2;expr3)`在 C 和类似语言中一样工作，并且与其他`((expr))`情况一样，Bash 将它们视为算术。

* * *

## 回答 #3

> 赞同：210
> 
> 时间：2008-10-04T02:38:48.710

### 讨论

正如贾罗建议的那样，使用`seq`很好。Pax Diablo 建议使用 Bash 循环来避免调用子进程，如果 $END 太大，它还有一个额外的优点是对内存更友好。Zathrus 在循环实现中发现了一个典型的错误，并且还暗示由于`i`是一个文本变量，因此连续的来回转换数字会伴随着相关的减速。

### 整数算术

这是 Bash 循环的改进版本：

```
typeset -i i END
let END=5 i=1
while ((i<=END)); do
    echo $i
    …
    let i++
done 
```

如果我们唯一想要的是`echo`，那么我们可以编写`echo $((i++))`。

[ehemient](https://stackoverflow.com/questions/169511/how-do-i-iterate-over-a-range-of-numbers-in-bash#171041)教会了我一些东西：Bash 允许`for ((expr;expr;expr))`构造。因为我从来没有读过 Bash 的完整手册页（就像我读过 Korn shell ( `ksh`) 手册页一样，那是很久以前的事了），所以我错过了。

所以，

```
typeset -i i END # Let's be explicit
for ((i=1;i<=END;++i)); do echo $i; done 
```

似乎是最节省内存的方式（没有必要分配内存来消耗`seq`的输出，如果 END 非常大，这可能是一个问题），尽管可能不是“最快的”。

### 最初的问题

eschercycle 指出 { *a* .. *b* } Bash 符号仅适用于文字；是的，根据 Bash 手册。一个人可以通过一个（内部）`fork()`没有一个`exec()`（就像调用的情况一样`seq`，它是另一个图像需要一个 fork+exec）来克服这个障碍：

```
for i in $(eval echo "{1..$END}"); do 
```

`eval`和都是`echo`Bash 内置函数，但`fork()`命令替换（`$(…)`构造）需要 a。

* * *

## 回答 #4

> 赞同：113
> 
> 时间：2011-04-19T22:32:44.227

这就是为什么原始表达式不起作用的原因。

从*man bash*：

> 大括号扩展在任何其他扩展之前执行，并且任何其他扩展的特殊字符都保留在结果中。它是严格的文本。Bash 不对扩展的上下文或大括号之间的文本应用任何句法解释。

因此，*大括号扩展*是在*参数扩展之前作为纯文本宏操作尽早完成的。*

Shell 是宏处理器和更正式的编程语言之间高度优化的混合体。为了优化典型用例，语言变得相当复杂，并且接受了一些限制。

> 推荐

我建议坚持使用 Posix ¹功能。这意味着使用`for i in <list>; do`，如果列表已知，否则使用`while`or `seq`，如：

```
#!/bin/sh

limit=4

i=1; while [ $i -le $limit ]; do
  echo $i
  i=$(($i + 1))
done
# Or -----------------------
for i in $(seq 1 $limit); do
  echo $i
done 
```

* * *

^(1\. Bash 是一个很棒的 shell，我以交互方式使用它，但我没有将 bash-isms 放入我的脚本中。脚本可能需要更快的 shell、更安全的 shell、更嵌入式的 shell。他们可能需要在安装为 /bin/sh 的任何东西上运行，然后有所有常见的支持标准的参数。还记得*shellshock，*又名*bashdoor 吗？*)

* * *

## 回答 #5

> 赞同：92
> 
> 时间：2015-07-12T07:54:44.353

**POSIX 方式**

如果您关心可移植性，请使用[POSIX 标准中的示例](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_04_01)：

```
i=2
end=5
while [ $i -le $end ]; do
    echo $i
    i=$(($i+1))
done 
```

输出：

```
2
3
4
5 
```

*不是*POSIX的东西：

*   `(( ))`没有美元，尽管它是[POSIX 本身提到](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_09_04)的常见扩展。
*   `[[`. `[`这里就够了。另请参阅：[Bash 中的单方括号和双方括号有什么区别？](https://stackoverflow.com/questions/13542832/bash-if-difference-between-square-brackets-and-double-square-brackets)
*   `for ((;;))`
*   `seq`(GNU Coreutils)
*   `{start..end}`，并且不能与[Bash 手册中提到的](https://stackoverflow.com/a/5723526/895245)变量一起使用。
*   `let i=i+1`: [POSIX 7 2\. Shell 命令语言](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_04)不包含单词`let`, 并且在`bash --posix`4.3.42上失败
*   可能需要美元`i=$i+1`，但我不确定。[POSIX 7 2.6.4 算术扩展](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_04)说：

    > 如果 shell 变量 x 包含一个形成有效整数常量的值，可选地包括前导加号或减号，那么算术扩展 "$((x))" 和 "$(($x))" 将返回相同的值价值。

    但从字面上阅读它并不意味着`$((x+1))`扩展，因为`x+1`它不是一个变量。

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2011-03-14T19:51:36.677

另一层间接：

```
for i in $(eval echo {1..$END}); do
    ∶ 
```

* * *

## 回答 #7

> 赞同：35
> 
> 时间：2008-10-04T01:41:23.753

您可以使用

```
for i in $(seq $END); do echo $i; done 
```

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2017-06-03T20:14:38.257

如果你需要它的前缀，那么你可能会喜欢这个

```
 for ((i=7;i<=12;i++)); do echo `printf "%2.0d\n" $i |sed "s/ /0/"`;done 
```

这将产生

```
07
08
09
10
11
12 
```

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2019-02-19T16:25:17.593

我在这里结合了一些想法并测量了性能。

# TL;DR 要点：

1.  `seq`而且`{..}`真的很快
2.  `for`并且`while`循环很慢
3.  `$( )`是缓慢的
4.  `for (( ; ; ))`循环较慢
5.  `$(( ))`甚至更慢
6.  担心内存中的*N*个数字（seq 或 {..}）是愚蠢的（至少高达 100 万个。）

*这些不是**结论**。您必须查看每个背后的 C 代码才能得出结论。这更多地是关于我们如何倾向于使用这些机制中的每一个来循环代码。大多数单一操作都足够接近与在大多数情况下无关紧要的相同速度。但是像`for (( i=1; i<=1000000; i++ ))`你可以直观地看到的许多操作一样的机制。**每个循环**的操作也比从`for i in $(seq 1 1000000)`. 这对你来说可能并不明显，这就是为什么做这样的测试很有价值。*

# 演示

```
# show that seq is fast
$ time (seq 1 1000000 | wc)
 1000000 1000000 6888894

real    0m0.227s
user    0m0.239s
sys     0m0.008s

# show that {..} is fast
$ time (echo {1..1000000} | wc)
       1 1000000 6888896

real    0m1.778s
user    0m1.735s
sys     0m0.072s

# Show that for loops (even with a : noop) are slow
$ time (for i in {1..1000000} ; do :; done | wc)
       0       0       0

real    0m3.642s
user    0m3.582s
sys 0m0.057s

# show that echo is slow
$ time (for i in {1..1000000} ; do echo $i; done | wc)
 1000000 1000000 6888896

real    0m7.480s
user    0m6.803s
sys     0m2.580s

$ time (for i in $(seq 1 1000000) ; do echo $i; done | wc)
 1000000 1000000 6888894

real    0m7.029s
user    0m6.335s
sys     0m2.666s

# show that C-style for loops are slower
$ time (for (( i=1; i<=1000000; i++ )) ; do echo $i; done | wc)
 1000000 1000000 6888896

real    0m12.391s
user    0m11.069s
sys     0m3.437s

# show that arithmetic expansion is even slower
$ time (i=1; e=1000000; while [ $i -le $e ]; do echo $i; i=$(($i+1)); done | wc)
 1000000 1000000 6888896

real    0m19.696s
user    0m18.017s
sys     0m3.806s

$ time (i=1; e=1000000; while [ $i -le $e ]; do echo $i; ((i=i+1)); done | wc)
 1000000 1000000 6888896

real    0m18.629s
user    0m16.843s
sys     0m3.936s

$ time (i=1; e=1000000; while [ $i -le $e ]; do echo $((i++)); done | wc)
 1000000 1000000 6888896

real    0m17.012s
user    0m15.319s
sys     0m3.906s

# even a noop is slow
$ time (i=1; e=1000000; while [ $((i++)) -le $e ]; do :; done | wc)
       0       0       0

real    0m12.679s
user    0m11.658s
sys 0m1.004s 
```

* * *

## 回答 #10

> 赞同：21
> 
> 时间：2011-03-15T23:29:16.203

如果你在 BSD / OS X 上，你可以使用 jot 而不是 seq：

```
for i in $(jot $END); do echo $i; done 
```

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2008-10-04T01:42:39.883

这适用于`bash`：

```
END=5
i=1 ; while [[ $i -le $END ]] ; do
    echo $i
    ((i = i + 1))
done 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2013-09-19T12:33:02.677

我知道这个问题是关于 的`bash`，但是 - 只是为了记录 -`ksh93`更聪明并按预期实施：

```
$ ksh -c 'i=5; for x in {1..$i}; do echo "$x"; done'
1
2
3
4
5
$ ksh -c 'echo $KSH_VERSION'
Version JM 93u+ 2012-02-29

$ bash -c 'i=5; for x in {1..$i}; do echo "$x"; done'
{1..5} 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2015-07-12T12:36:51.050

这是另一种方式：

```
end=5
for i in $(bash -c "echo {1..${end}}"); do echo $i; done 
```

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2017-07-27T13:30:48.167

如果您想尽可能接近大括号表达式语法，请尝试[`range`bash-tricks' 中的函数`range.bash`](https://github.com/zbentley/bash-tricks/tree/master/range)。

例如，以下所有内容都将与以下内容完全相同`echo {1..10}`：

```
source range.bash
one=1
ten=10

range {$one..$ten}
range $one $ten
range {1..$ten}
range {1..10} 
```

它试图用尽可能少的“陷阱”来支持本机 bash 语法：不仅支持变量，而且`for i in {1..a}; do echo $i; done`还防止了作为字符串（例如）提供的无效范围的常见不良行为。

其他答案在大多数情况下都有效，但它们都至少具有以下缺点之一：

*   他们中的许多人使用[subshel​​ls](http://tldp.org/LDP/abs/html/subshells.html)，这可能会[损害性能](http://rus.har.mn/blog/2010-07-05/subshells/)，并且在某些系统上[可能是不可能的。](https://superuser.com/questions/559709/how-to-change-the-maximum-number-of-fork-process-by-user-in-linux)
*   他们中的许多人依赖外部程序。Even`seq`是一个必须安装才能使用的二进制文件，必须由 bash 加载，并且必须包含您期望的程序，才能在这种情况下工作。不管是否无处不在，这不仅仅依赖于 Bash 语言本身。
*   仅使用本机 Bash 功能的解决方案，例如 @ephemient 的，将不适用于字母范围，例如`{a..z}`; 大括号展开会。不过，问题是关于*数字*范围的，所以这是一个小问题。
*   它们中的大多数在视觉上与`{1..10}`大括号扩展范围语法并不相似，因此使用两者的程序可能会有点难以阅读。
*   @bobbogo 的答案使用了一些熟悉的语法，但如果`$END`变量不是范围另一侧的有效范围“书挡”，则会出现意想不到的情况。例如，如果`END=a`不会发生错误，则会`{1..a}`回显逐字记录值。这也是 Bash 的默认行为——只是经常出乎意料。

免责声明：我是链接代码的作者。

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2019-05-27T16:41:10.087

有很多方法可以做到这一点，但我更喜欢的方法如下

# 使用`seq`

> 概要来自`man seq`

```
$ seq [-w] [-f format] [-s string] [-t string] [first [incr]] last 
```

> 句法

完整的命令
`seq first incr last`

*   first 是序列中的起始编号[可选，默认：1]
*   incr 是增量 [是可选的，默认情况下：1]
*   last 是序列中的最后一个数字

例子：

```
$ seq 1 2 10
1 3 5 7 9 
```

只有第一个和最后一个：

```
$ seq 1 5
1 2 3 4 5 
```

只有最后一个：

```
$ seq 5
1 2 3 4 5 
```

# 使用`{first..last..incr}`

这里 first 和 last 是强制性的，incr 是可选的

只使用第一个和最后一个

```
$ echo {1..5}
1 2 3 4 5 
```

使用增量

```
$ echo {1..10..2}
1 3 5 7 9 
```

您甚至可以将其用于以下字符

```
$ echo {a..z}
a b c d e f g h i j k l m n o p q r s t u v w x y z 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2011-08-16T21:18:30.490

这些都很好，但 seq 据说已被弃用，并且大多数仅适用于数字范围。

如果你用双引号将你的 for 循环括起来，当你回显字符串时，开始和结束变量将被取消引用，你可以将字符串直接发送回 BASH 执行。`$i`需要用 \'s 转义，因此在发送到子shell之前不会对其进行评估。

```
RANGE_START=a
RANGE_END=z
echo -e "for i in {$RANGE_START..$RANGE_END}; do echo \\${i}; done" | bash 
```

此输出也可以分配给变量：

```
VAR=`echo -e "for i in {$RANGE_START..$RANGE_END}; do echo \\${i}; done" | bash` 
```

这应该生成的唯一“开销”应该是 bash 的第二个实例，因此它应该适合密集型操作。

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2014-03-12T00:10:10.067

替换`{}`为`(( ))`：

```
tmpstart=0;
tmpend=4;

for (( i=$tmpstart; i<=$tmpend; i++ )) ; do 
echo $i ;
done 
```

产量：

```
0
1
2
3
4 
```

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2017-03-27T19:32:05.023

如果您正在执行 shell 命令，并且您（像我一样）喜欢流水线，那么这个很好：

`seq 1 $END | xargs -I {} echo {}`

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2019-06-18T16:54:45.750

如果您不想使用 ' `seq`' 或 ' `eval`'`jot`或算术扩展格式，例如。`for ((i=1;i<=END;i++))`，或其他循环，例如。`while`，而您不想 ' `printf`' 并且只乐于 ' `echo`'，那么这个简单的解决方法可能适合您的预算：

`a=1; b=5; d='for i in {'$a'..'$b'}; do echo -n "$i"; done;' echo "$d" | bash`

`seq`PS：我的 bash无论如何都没有 ' ' 命令。

*在 Mac OSX 10.6.8、Bash 3.2.48 上测试*

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-04-11T02:37:36.523

这在 Bash 和 Korn 中有效，也可以从较高到较低的数字。可能不是最快或最漂亮的，但效果很好。也处理底片。

```
function num_range {
   # Return a range of whole numbers from beginning value to ending value.
   # >>> num_range start end
   # start: Whole number to start with.
   # end: Whole number to end with.
   typeset s e v
   s=${1}
   e=${2}
   if (( ${e} >= ${s} )); then
      v=${s}
      while (( ${v} <= ${e} )); do
         echo ${v}
         ((v=v+1))
      done
   elif (( ${e} < ${s} )); then
      v=${s}
      while (( ${v} >= ${e} )); do
         echo ${v}
         ((v=v-1))
      done
   fi
}

function test_num_range {
   num_range 1 3 | egrep "1|2|3" | assert_lc 3
   num_range 1 3 | head -1 | assert_eq 1
   num_range -1 1 | head -1 | assert_eq "-1"
   num_range 3 1 | egrep "1|2|3" | assert_lc 3
   num_range 3 1 | head -1 | assert_eq 3
   num_range 1 -1 | tail -1 | assert_eq "-1"
} 
```

# reporting - 为 xulrunner 应用程序设置 BIRT 报告查看器的最简单方法是什么？

> ID：169512
> 
> 赞同：7
> 
> 时间：2008-10-04T01:40:30.107
> 
> 标签：reporting, xul, birt, xulrunner

我最近开始使用[BIRT](http://www.eclipse.org/birt/phoenix/deploy/)，并开发了一个报告来与我的[xulrunner](http://developer.mozilla.org/en/XULRunner)应用程序一起使用。我还没有弄清楚我应该如何部署查看器。BIRT 似乎主要针对 Java 应用程序，因此有关于在 J2EE、JBoss 和其他技术上进行部署的说明——我不熟悉这些技术（但我反正不是用 Java 开发的）。

回顾[这篇](http://www.onjava.com/pub/a/onjava/2006/07/26/deploying-birt.html)关于部署 BIRT 的文章和回顾 BIRT 网站上的[部署细节](http://www.eclipse.org/birt/phoenix/deploy/)，我不知道该去哪里。我没想到必须为 xulrunner 应用程序添加一些大型 Java 依赖项——我无法在我的 xulrunner 应用程序中放入一个可执行文件，从我的应用程序调用它，并将它传递给一个报告文档吗？（或者其他比学习和使用 J2EE、JBoss、tomcat 更简单的东西？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-04T03:17:59.223

运行时似乎有一个 genReport.bat 文件可以从命令行生成报告。这似乎是我所需要的，[本文对此](http://digiassn.blogspot.com/2006/07/birt-birt-report-scheduling-without.html)进行了描述。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-12-02T19:19:34.783

（11/2014）我要补充：

*   下载 Birt 运行时：[http ://www.eclipse.org/downloads/download.php?file=/birt/downloads/drops/R-R1-4_3_0-201306131152/birt-runtime-4_3_0.zip](http://www.eclipse.org/downloads/download.php?file=/birt/downloads/drops/R-R1-4_3_0-201306131152/birt-runtime-4_3_0.zip)

*   提取某处并设置一个新的环境变量 BIRT_HOME=path_to_where_you_extracted

*   记得将您的数据库库添加到 \ReportEngine\lib 中，（例如：jtds.jar）

*   在 ReportEngine 目录中打开一个控制台并运行： `genReport.bat -f PDF -o PATH/GENERATED_REPORTS/REPORT.pdf -F "PATH/TO/REPORT.rptdesign"`

这就是我需要做的

# php - 在 PHP 中使用 mysql_fetch_assoc 时出现警告

> ID：169520
> 
> 赞同：1
> 
> 时间：2008-10-04T01:43:43.313
> 
> 标签：php, mysql

> **可能重复：**
> [警告：mysql_fetch_array()：提供的参数不是有效的 MySQL 结果](https://stackoverflow.com/questions/795746/warning-mysql-fetch-array-supplied-argument-is-not-a-valid-mysql-result)

当我运行我的 php 页面时，我收到此错误并且不知道出了什么问题，有人可以帮忙吗？如果有人需要更多信息，我会发布整个代码。

```
警告：mysql_fetch_assoc()：提供的参数不是有效的 MySQL 结果资源
H:\Program Files\EasyPHP 2.0b1\www\test\info.php 第 16 行
```

```
<?PHP

    $user_name = "root";
    $password = "";
    $database = "addressbook";
    $server = "127.0.0.1";

$db_handle = mysql_connect($server, $user_name, $password);
$db_found = mysql_select_db($database, $db_handle);

if ($db_found) {

    $SQL = "SELECT * FROM tb_address_book";
    $result = mysql_query($SQL);

    while ($db_field = mysql_fetch_assoc($result)) {
        print $db_field['ID'] . "<BR>";
        print $db_field['First_Name'] . "<BR>";
        print $db_field['Surname'] . "<BR>";
        print $db_field['Address'] . "<BR>";
    }    

    mysql_close($db_handle);

}
else {
    print "Database NOT Found ";
    mysql_close($db_handle);
}

?> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-04T01:47:35.863

这通常意味着您的 SQL 中有错误。

```
$sql = "SELECT * FROM myTable"; // table name only do not add tb
$result = mysql_query($sql);
var_dump($result);    // bool(false) 
```

显然，`false`它不是 MySQL 资源，因此您会收到该错误。

**编辑现在粘贴的代码**：

在`while`循环之前的行中，添加以下内容：

```
if (!$result) {
    echo "Error. " . mysql_error();
} else {
    while ( ... ) {
       ...
    }
} 
```

确保该`tb_address_book`表确实存在并且您已正确连接到数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-04T01:47:13.277

```
<?PHP

    $user_name = "root";
    $password = "";
    $database = "addressbook";
    $server = "127.0.0.1";

$db_handle = mysql_connect($server, $user_name, $password);
$db_found = mysql_select_db($database, $db_handle);

if ($db_found) {

    $SQL = "SELECT * FROM tb_address_book";
    $result = mysql_query($SQL);

    while ($db_field = mysql_fetch_assoc($result)) {
        print $db_field['ID'] . "<BR>";
        print $db_field['First_Name'] . "<BR>";
        print $db_field['Surname'] . "<BR>";
        print $db_field['Address'] . "<BR>";
    }    

    mysql_close($db_handle);

}
else {
    print "Database NOT Found ";
    mysql_close($db_handle);
}

?> 
```

# c# - 如何有效过滤大型 LIstViewItemCollection？

> ID：169529
> 
> 赞同：1
> 
> 时间：2008-10-04T01:50:58.277
> 
> 标签：c#, .net, winforms, performance, listview

所以我有一个 ListView，其上限约为 1000 个项目。我需要能够使用文本框的 TextChanged 事件过滤这些项目。我有一些代码适用于较少数量的项目（~400），但是当我需要重新显示所有 1000 个项目的完整列表时，大约需要 4 秒。

我不是每次都创建新的 ListViewItems。相反，我保留完整项目集合的列表，然后从中添加。无论如何， .Add 方法似乎都需要很长时间。这是一个小示例：

```
this.BeginUpdate();
foreach (ListViewItem item in m_cachedItems)
{
    MyListView.Add(item);
}
this.EndUpdate; 
```

我尝试只添加丢失的项目（即当前显示的项目与项目总列表之间的差异），但这也不起作用。可能会出现当前只显示一项的情况，用户清除了文本框，而我需要显示整个列表。

我在用这样的大样本从 .NET 控件中寻求性能方面不是很有经验，所以我真的不知道更好的方法。有没有办法使用 .Add() 方法，或者如果没有，只是更好的通用解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-04T01:55:00.653

还有一个更好的方法，可以使用列表视图的[VirtualMode](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.virtualmode.aspx)。

该文档应该可以帮助您入门。这个想法是仅在需要时向 ListView 提供信息。使用事件检索此类信息。您所要做的就是实现这些事件并告诉列表视图它包含多少项目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T02:46:13.610

AddRange 比 add 快得多

```
MyListView.AddRange(items) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-04T01:54:10.017

有两件事可以解决这个问题：

1.  操作列表内容时关闭排序。
2.  隐藏列表，使其不会尝试绘制。

第一点是这两者中列表操作的最大性能提升。为此，只需在修改期间将 ListViewItemSorter 设置为 null 并在最后将其设置回来。

对于第二个选项，我经常将列表绘制为位图，然后在 PictureBox 中显示该位图，这样用户就不会看到列表消失，然后在我完成后重新显示列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T02:02:26.770

另请注意，您可以隐藏项目，以便在不删除它们的情况下使它们不可见。因此，第一次添加所有项目，然后您只需隐藏不再需要的项目并显示那些不再需要的项目。

# c# - 类属性作为集合

> ID：169555
> 
> 赞同：3
> 
> 时间：2008-10-04T02:02:07.910
> 
> 标签：c#, oop, collections

问候，

我需要在我的类中包含一个属性，它是 System.IO.FileInfo 对象的集合。我不确定如何执行此操作以及如何从类的实例中添加和删除对象（我会假设像任何其他集合一样）。

如果我需要添加更多信息，请告诉我。

谢谢

更新：我是以错误的方式接近这个吗？我已阅读评论，将添加到作为属性的集合是不好的做法。如果这是真的，什么是好的做法？我有一堆需要存储在集合中的对象。在对其采取最终操作之前，将添加和删除该集合。这是一种正确的方法还是我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-04T02:08:33.543

`File`是一个静态类。所以让我们假设你的意思是`FileInfo`.

有很多方法，你可以：

*   公开一个私有字段
*   使用迭代器
*   通过 ReadOnlyCollection<> 公开私有字段

例如，

```
class Foo {
    public IEnumerable<FileInfo> LotsOfFile {
        get {
            for (int i=0; i < 100; i++) {
                yield return new FileInfo("C:\\" + i + ".txt");
            }
        }
    }
    private List<FileInfo> files = new List<FileInfo>();
    public List<FileInfo> MoreFiles {
        get {
            return files;
        }
    }
    public ReadOnlyCollection<FileInfo> MoreFilesReadOnly {
        get {
            return files.AsReadOnly();
        }
    }

} 
```

使用此代码，您可以轻松添加到属性`MoreFiles`：

```
Foo f = new Foo();
f.MoreFiles.Add(new FileInfo("foo.txt"));
f.MoreFiles.Add(new FileInfo("BAR.txt"));
f.MoreFiles.Add(new FileInfo("baz.txt"));
Console.WriteLine(f.MoreFiles.Count); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T02:42:44.630

```
using System.Collections.ObjectModel;

public class Foo
 { private Collection<FileInfo> files = new Collection<FileInfo>();
   public Collection<FileInfo> Files { get { return files;} }
 }

//...
Foo f = new Foo();
f.Files.Add(file); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T02:12:08.247

一种简单的方法是创建一个这样的属性（对不起 VB.Net）

```
Public ReadOnly Property Files As Generic.List(Of IO.File)
    GET
        Return _Files
    END GET
END Property 
```

其中 _Files 是 Generic.List(Of IO.File) 类型的私有类变量，它保存文件列表。这将允许通过调用 List 数据类型的函数来添加和删除文件。有些人可能会说这是不好的做法，你不应该公开集合本身，而是将所有必要的函数重新编码为单独的参数，这基本上只是从你的私有集合中调用适当的函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T02:49:56.910

我只是把它做成一个列表或字典。我会展示两者。

```
class Example
{
    public List<FileInfo> FileList { get; set; }
    public Dictionary<string, FileInfo> Files { get; set; }

    public Example()
    {
        FileList = new List<FileInfo>();
        Files = new Dictionary<string, FileInfo>();
    }

} 
```

您现在将使用该属性，就好像它是实际的 List 或 Dictionary 对象一样。

```
var obj = new Example();
obj.FileList.Add(new FileInfo("file.txt")); // List<>
obj.Files.Add("file.txt", new FileInfo("file.txt")); // Dictionary<>
// also
obj.Files["file2.txt"] = new FileInfo("file2.txt"); // Dictionary<>

// fetch 
var myListedFile = obj.FileList[0]; // List<>
var myFile = obj.Files["file.txt"]; // Dictionary<> 
```

我更喜欢字典方法。

请注意，由于该属性是公共设置的，因此您也可以替换整个列表或字典。

```
obj.Files = new Dictionary<string, FileInfo>();
// or
var otherFiles = new Dictionary<string, FileInfo>();
otherFiles["otherfile.txt"] = new FileInfo("otherfile.txt");
obj.Files = otherFiles; 
```

如果您将属性设为私有集，那么您仍然可以调用 Add()，但不能重新分配列表或字典本身。

# c# - 在 C# 中正确的可空类型检查？

> ID：169562
> 
> 赞同：4
> 
> 时间：2008-10-04T02:05:02.083
> 
> 标签：c#, casting, nullable

好的，我的实际问题是：我正在实施一个`IList<T>`. 当我到达时`CopyTo(Array array, int index)`，这是我的解决方案：

```
void ICollection.CopyTo(Array array, int index)
{
    // Bounds checking, etc here.
    if (!(array.GetValue(0) is T))
        throw new ArgumentException("Cannot cast to this type of Array.");
    // Handle copying here.
} 
```

这在我的原始代码中有效，并且仍然有效。但它有一个小缺陷，直到我开始为它构建测试时才暴露出来，特别是这个：

```
public void CopyToObjectArray()
{
    ICollection coll = (ICollection)_list;
    string[] testArray = new string[6];

    coll.CopyTo(testArray, 2);
} 
```

现在，这个测试应该通过了。它抛出`ArgumentException`关于无法投射的问题。为什么？`array[0] == null`. 检查设置为 的变量时，`is`关键字始终返回 false `null`。现在，出于各种原因，这很方便，包括避免 null 取消引用等。我最终想出的类型检查是这样的：

```
try
{
    T test = (T)array.GetValue(0);
}
catch (InvalidCastException ex)
{
    throw new ArgumentException("Cannot cast to this type of Array.", ex);
} 
```

这并不完全优雅，但它有效......有没有更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-04T02:18:23.697

Type 上有一个专门为此而设计的方法，试试：

```
if(!typeof(T).IsAssignableFrom(array.GetElementType())) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T02:47:33.183

唯一可以确定的方法是使用反射，但 90% 的时间你可以通过使用`array is T[]`. 大多数人会传入一个正确类型的数组，这样就可以了。但是，您也应该始终提供代码来进行反射检查，以防万一。这是我的一般样板的样子（注意：我在这里写了这个，从内存中，所以这可能无法编译，但它应该给出基本的想法）：

```
class MyCollection : ICollection<T> {
   void ICollection<T>.CopyTo(T[] array, int index) {
       // Bounds checking, etc here.
       CopyToImpl(array, index);
   }
   void ICollection.CopyTo(Array array, int index) {
       // Bounds checking, etc here.
       if (array is T[]) { // quick, avoids reflection, but only works if array is typed as exactly T[]
           CopyToImpl((T[])localArray, index);
       } else {
           Type elementType = array.GetType().GetElementType();
           if (!elementType.IsAssignableFrom(typeof(T)) && !typeof(T).IsAssignableFrom(elementType)) {
               throw new Exception();
           }
           CopyToImpl((object[])array, index);
       }
   }
   private void CopyToImpl(object[] array, int index) {
       // array will always have a valid type by this point, and the bounds will be checked
       // Handle the copying here
   }
} 
```

**编辑**：好的，忘了指出一些事情。几个答案天真地使用了在此代码中读取的内容`element.IsAssignableFrom(typeof(T))`。您还*应该*像 BCL 那样允许`typeof(T).IsAssignableFrom(elementType)`，以防开发人员知道此特定`ICollection`中的所有值实际上都是`S`派生自的类型`T`，并传递一个类型的数组`S[]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-04T02:31:18.647

`List<T>`使用这个：

```
try
{
    Array.Copy(this._items, 0, array, index, this.Count);
}
catch (ArrayTypeMismatchException)
{
  //throw exception...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-13T14:49:29.550

这是 try / catch 与反射的一个小测试：

```
object[] obj = new object[] { };
DateTime start = DateTime.Now;

for (int x = 0; x < 1000; x++)
{
    try
    {
        throw new Exception();
    }
    catch (Exception ex) { }
}
DateTime end = DateTime.Now;
Console.WriteLine("Try/Catch: " + (end - start).TotalSeconds.ToString());

start = DateTime.Now;

for (int x = 0; x < 1000; x++)
{
    bool assignable = typeof(int).IsAssignableFrom(obj.GetType().GetElementType());
}
end = DateTime.Now;
Console.WriteLine("IsAssignableFrom: " + (end - start).TotalSeconds.ToString()); 
```

发布模式下的结果输出是：

```
Try/Catch: 1.7501001
IsAssignableFrom: 0 
```

在调试模式下：

```
Try/Catch: 1.8171039
IsAssignableFrom: 0.0010001 
```

结论，只需进行反射检查。这很值得。

# java - 用于在服务器端生成网页缩略图的开源 Java 库

> ID：169573
> 
> 赞同：14
> 
> 时间：2008-10-04T02:13:05.983
> 
> 标签：java, open-source, thumbnails

我正在寻找一个开源 Java 库来为给定的 URL 生成缩略图。我需要捆绑此功能，而不是调用外部服务，例如[Amazon](http://aws.amazon.com/ast/)或[websnapr](http://www.websnapr.com/)。

这篇文章中提到了[http://www.webrenderer.com/ ：](http://www.webrenderer.com/)[服务器生成的网页截图](https://stackoverflow.com/questions/119116/server-generated-web-screenshots#119264)，但它是一个商业解决方案。

我希望有一个基于 Java 的解决方案，但可能需要考虑执行诸如[khtml2png 之](http://khtml2png.sourceforge.net/index.php?page=faq)类的外部进程，或集成诸如[html2ps](http://user.it.uu.se/~jan/html2ps.html)之类的东西。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-04T14:12:08.810

首先想到的是使用 AWT 来捕获屏幕抓取（参见下面的代码）。您可以查看捕获[JEditorPane](http://java.sun.com/javase/6/docs/api/javax/swing/JEditorPane.html)、[JDIC](https://jdic.dev.java.net/) [WebBrowser](https://jdic.dev.java.net/nonav/documentation/javadoc/jdic/org/jdesktop/jdic/browser/package-summary.html)控件或[SWT](http://www.eclipse.org/swt/) [浏览器](http://help.eclipse.org/stable/nftopic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/browser/package-summary.html)（通过[AWT 嵌入支持](http://help.eclipse.org/stable/nftopic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/awt/package-summary.html)）。后两者嵌入原生浏览器（IE、Firefox），所以引入依赖；JEdi​​torPane HTML 支持在 HTML 3.2 停止。可能这些都不适用于无头系统。

```
import java.awt.Component;
import java.awt.Graphics2D;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;
import javax.swing.JLabel;

public class Capture {

    private static final int WIDTH = 128;
    private static final int HEIGHT = 128;

    private BufferedImage image = new BufferedImage(WIDTH, HEIGHT,
            BufferedImage.TYPE_INT_RGB);

    public void capture(Component component) {
        component.setSize(image.getWidth(), image.getHeight());

        Graphics2D g = image.createGraphics();
        try {
            component.paint(g);
        } finally {
            g.dispose();
        }
    }

    private BufferedImage getScaledImage(int width, int height) {
        BufferedImage buffer = new BufferedImage(width, height,
                BufferedImage.TYPE_INT_RGB);
        Graphics2D g = buffer.createGraphics();
        try {
            g.drawImage(image, 0, 0, width, height, null);
        } finally {
            g.dispose();
        }
        return buffer;
    }

    public void save(File png, int width, int height) throws IOException {
        ImageIO.write(getScaledImage(width, height), "png", png);
    }

    public static void main(String[] args) throws IOException {
        JLabel label = new JLabel();
        label.setText("Hello, World!");
        label.setOpaque(true);

        Capture cap = new Capture();
        cap.capture(label);
        cap.save(new File("foo.png"), 64, 64);
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T02:18:08.690

您实际上是在要求 Java 可访问的完整渲染引擎。就个人而言，我会省去麻烦并调用一个子进程。

否则，我会遇到这个纯 Java 浏览器：[Lobo](http://lobobrowser.org/java-browser.jsp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T02:40:07.083

是不是有一个 QA/测试网站/服务可以让你指定一个你想在某个浏览器（IE、FIREFOX、SAFARI 版本 x、y、z）中呈现的网页，他们会将快照邮寄回你。'

我不记得该服务了——也许其他经常使用 ajaxian 的开发人员可能还记得它？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-06T07:41:04.730

尝试调用[ImageMagick](http://www.imagemagick.org/script/index.php)。我知道这不是 Java 解决方案，但您可以从 Java 调用它，甚至还有[Java 前端](http://sourceforge.net/projects/jmagick/)，尽管我在这方面的成功较少。

# unix - 保持点文件跨机器同步？

> ID：169574
> 
> 赞同：23
> 
> 时间：2008-10-04T02:15:41.797
> 
> 标签：unix, configuration-files

像大多数 *nix 人一样，我倾向于使用我的工具并按照我喜欢的方式配置它们。这一切都很好，直到最近。随着我做越来越多的工作，我倾向于登录越来越多的机器，并且有越来越多的东西在我的家用机器上配置得很好，但不一定在我的工作机器、我的网络服务器或我的任何工作上服务器...

你如何保持这些配置文件的更新？你只是手动复制它们吗？您是否将它们存储在公共场所？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-04T03:37:49.107

我很幸运地将我的文件保存在修订控制系统之下。它并不适合所有人，但大多数程序员应该能够体会到其中的好处。读

> [让你的生活保持颠覆](http://www.onlamp.com/pub/a/onlamp/2005/01/06/svn_homedir.html)

以获得出色的描述，包括如何在多台机器上处理非点文件配置（如通过[svnfix 脚本](http://git.kitenet.net/?p=joey/home.git;a=blob_plain;f=bin/fixups;hb=HEAD)的 cron 作业）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-13T00:58:34.953

我还使用颠覆来管理我的点文件。当我登录到一个盒子时，我的 confs 会自动为我更新。我还使用 github 公开存储[我的 confs](http://github.com/claytron/dotfiles/tree/master)。我使用 git-svn 使两者保持同步。

在新服务器上启动和运行只是运行几个命令的问题。create_links 脚本只是将 .dotfiles 文件夹项目中的符号链接创建到 my`$HOME`中，并且还涉及一些不需要签入的文件。

```
$ cd

# checkout the files
$ svn co https://path/to/my/dotfiles/trunk .dotfiles

# remove any files that might be in the way
$ .dotfiles/create_links.sh unlink

# create the symlinks and other random tasks needed for setup
$ .dotfiles/create_links.sh 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-04T03:04:14.993

这些天，我似乎到处都发现了一件新事物，让我说“嘿，使用[DropBox](http://www.getdropbox.com/)会是件好事”

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-04T02:26:46.033

Rsync 是您最好的解决方案。可以在这里找到示例：

[http://troy.jdmz.net/rsync/index.html](http://troy.jdmz.net/rsync/index.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-04T03:39:48.383

我为此使用 git。

有一个专门针对该主题的 wiki/邮件列表。

[vcs 主页](http://vcs-home.madduck.net/)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-10-13T14:03:17.447

我肯定会推荐[想家](https://github.com/technicalpickles/homesick)。它使用 git 并自动对您的文件进行符号链接。`homesick track`跟踪新的点文件，同时`homesick symlink`将存储库中的新点文件符号链接到您的主文件夹。这样，您甚至可以拥有多个存储库。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-04T02:19:36.017

你可以使用 rsync。它通过 ssh 工作，我发现这很有用，因为我只设置了具有 ssh 访问权限的新服务器。

或者，创建一个 tar 文件，您可以到处移动并解压缩。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-04T02:35:54.877

我将它们存储在我的版本控制系统中。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-04T03:14:48.370

我使用 svn ...拥有一个公共和一个私有存储库...所以一旦我进入服务器，我就

```
svn co http://my.rep/home/public 
```

并拥有我所有的点文件...

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-04T03:35:31.230

我将我的存储在`git`存储库中，这使我可以轻松地合并系统相关更改之外的更改，同时共享我想要的更改。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-04T02:19:37.530

我将文件的主版本保留在我的主机上的 CM 控制下，并在我需要的地方安排复制更新。幸运的是，我们的大多数机器上的主目录都有 NFS 挂载，因此我实际上不必经常复制所有内容。另一方面，我的配置文件相当复杂 - 并且在不同的机器上提供了不同的 PATH 设置等。粗略地说，我有管理控制权的机器比我偶尔使用的没有管理控制权的机器安装了更多的开源软件。

所以，我随机混合了手动和半自动过程。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-04T02:58:24.363

在[netskel](http://macnugget.org/projects/netskel/)中，您可以将常用文件放在 Web 服务器上，然后客户端程序会在任意数量的客户端计算机上维护点文件。它被设计为在任何级别的客户端机器上运行，因此 shell 脚本是正确的`sh`脚本并且具有最少的依赖关系。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-04T04:38:01.900

svn 也在这里。Rsync 或 unison 将是一个好主意，除了有时东西停止工作，我想知道上周我的 .bashrc 文件中有什么。在这种情况下，Svn 是救生员。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-04T04:42:32.610

现在我使用[Live Mesh](http://www.mesh.com)，它可以让我的所有文件在多台机器上保持同步。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-08-09T20:53:48.103

我将所有点文件放入 Dropbox 上的一个文件夹中，然后将它们符号链接到每台机器。在一台机器上所做的更改几乎可以立即提供给所有其他机器。它只是工作。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-04T12:16:56.700

根据您的环境，您还可以使用（完全备份的）NFS 共享...

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-27T18:25:06.583

说到在公共场合存储点文件，有

[http://www.dotfiles.com/](http://www.dotfiles.com/)

和

[http://dotfiles.org/](http://dotfiles.org/)

但是手动更新文件真的很痛苦，因为（AFAIK）这些服务都没有提供任何 API。

后者非常简约（没有联系表格，没有关于谁制造/拥有它的信息等）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-04-30T17:20:32.947

> **[公文包](https://github.com/jim/briefcase)**是一种便于将点文件保存在 git 中的工具，包括那些带有私人信息的文件（例如 .gitconfig）。
> 
> 通过将配置文件保存在 git public git 存储库中，您可以与他人共享您的设置。任何秘密信息都保存在存储库之外的单个文件中（由您来备份和传输此文件）。
> 
> -- [http://jim.github.com/briefcase](http://jim.github.com/briefcase)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-12-23T01:18:46.183

## 大修

[https://github.com/lra/mackup](https://github.com/lra/mackup)

Ira/mackup 是一个适用于 Linux 和 Mac 系统的实用程序，它将使用几乎所有流行的共享存储提供商（dropbox、icloud、google drive）同步应用程序首选项。它通过用符号链接替换点文件来工作。

它还有一个包含数百个支持的应用程序的大型库[https://github.com/lra/mackup/tree/master/mackup/applications](https://github.com/lra/mackup/tree/master/mackup/applications)

# c# - 如何检测 PictureBox 上的按住鼠标按钮？

> ID：169590
> 
> 赞同：10
> 
> 时间：2008-10-04T02:27:55.207
> 
> 标签：c#, winforms, mouse, picturebox

当鼠标位于 PictureBox 上方且鼠标按钮已被单击并按住时，我需要触发一个事件。

问题：

MouseDown 和 MouseEnter 事件处理程序不能很好地协同工作。

例如，一旦单击并按住鼠标按钮，C# 将触发 MouseDown 事件处理程序，但是当光标移到 PictureBox 上时，MouseEnter 事件不会触发，直到鼠标按钮被释放。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-04T02:39:47.507

**鼠标事件**

使用 MouseDown 事件仅检测鼠标按钮的按下并将 this.Capture 设置为 true 以便您随后获得其他鼠标事件，即使鼠标离开控件（即您不会获得 MouseLeave 事件，因为您捕获鼠标）。当 MouseUp 发生时，通过将 this.Capture 设置为 false 来释放捕获。

**只检查鼠标的状态**

这可能不相关，但您可以检查`System.Windows.Control.MousePosition`它是否在 中`PictureBox.ClientRectangle`，然后随时检查`Control.MouseButtons`哪些按钮可能处于关闭状态的静态属性。

如：

```
if  (pictureBox.ClientRectangle.Contains(pictureBox.PointToClient(Control.MousePosition)))
{
   if ((Control.MouseButtons & MouseButtons.Left) != 0)
   {
     // Left button is down.
   }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-04T03:15:54.673

当鼠标被按下时，大多数控件将*Control.Capture*鼠标输入。这意味着所有*MouseMove*事件都被发送到捕获的原始控件，而不是鼠标恰好位于的控件。这种情况一直持续到鼠标失去捕获，这通常发生在鼠标抬起时。

如果你真的需要知道鼠标何时在你的控件上，即使另一个控件已经捕获了鼠标输入，那么你只有一种方法。您需要窥探发往应用程序内其他控件的 Windows 消息。为此，您需要添加一个消息过滤器...

```
Application.AddMessageFilter(myFilterClassInstance); 
```

然后你需要在一个合适的类上实现 IMessageFilter ...

```
public class MyFilterClass : IMessageFilter
{
    public bool PreFilterMessage(ref Message m)
    {
        if (m.Msg == WM_MOUSEMOVE)
            // Check if mouse is over my picture box!

        return false;
    }
} 
```

然后你观察鼠标移动事件并检查它们是否在你的图片框上并做你想做的任何事情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-11-29T16:43:56.003

在 PictureBox 控件中设置 MouseMove 事件：

```
this.myPictureBox.MouseMove += new System.Windows.Forms.MouseEventHandler(this.myPictureBox_MouseMove); 
```

然后，在 MouseMove 事件处理程序中，检查鼠标左键（或其他）是否被按下：

```
private void myPictureBox_MouseMove(object sender, MouseEventArgs e)
{  
     if (e.Button == MouseButtons.Left)
         // Do what you want to do
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-04T05:02:03.163

如果您尝试实现某种拖放操作，那么您想要使用接收图片框上**的 Drag... 事件（DragEnter、DragDrop 等）。**基本上，您使用源控件的 DoDragDrop 方法开始拖动操作，然后您拖动的任何控件都会引发其 Drag... 事件。

在 MSDN 上搜索“DoDragDrop”以了解如何实现这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-11-29T06:35:15.993

您可以使用预览事件

例如，假设我想检测按钮上的 mousedown 事件。MouseDown 事件不起作用，因为作为这里的答案之一，鼠标捕获被发送到主控件，但是您可以做的是使用鼠标预览事件。

这是一个代码示例

我想检查何时在我的 Button 上按下鼠标左键，因此我使用 PreviewMouseLeftButtonDown

```
 private void MyButton_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
    {
        // code here
    } 
```

WPF 有很多其他事件的预览事件，你可以在这里阅读它们

[预览事件](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/advanced/preview-events?view=netframeworkdesktop-4.8)- 它特别讨论了按钮以及鼠标事件如何与之交互，因此我强烈建议您阅读它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-05-19T15:05:05.920

基于鼠标位置和控件相对位置移动表单的最佳方法类似于 Ian Campbell 发布的内容。

```
 private void imgMoveWindow_MouseMove(object sender, MouseEventArgs e)
    {
        if (e.Button == MouseButtons.Left)
        {
            Form1.ActiveForm.Left = Control.MousePosition.X - imgMoveWindow.Left - (imgMoveWindow.Size.Width/2);
            Form1.ActiveForm.Top = Control.MousePosition.Y - imgMoveWindow.Top - (imgMoveWindow.Size.Height/2); 
        }

    } 
```

其中 imgMoveWindow 是 PictureBox 控件。

布鲁诺·拉特尼克斯

嗅探器网络

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-15T15:47:02.617

您应该尝试使用图片框的 MouseMove 而不是 MouseEnter，无论鼠标按钮状态如何，MouseMove 通常都会触发。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-04T02:30:11.020

在鼠标按下时设置标志或状态。松开鼠标。当鼠标悬停在图片框上时，请检查您的状态。现在您可以检测到一个人何时在拖动某物。

# sql-server-2005 - 在 SQL Server 2005 中对非常大的结果集进行分页的有效方法是什么？

> ID：169596
> 
> 赞同：7
> 
> 时间：2008-10-04T02:33:46.800
> 
> 标签：sql-server-2005, performance, pagination

**编辑：** *我仍在等待更多答案。谢谢！*

在 SQL 2000 的日子里，我曾经使用临时表方法，您创建一个带有新标识列和主键的临时表，然后选择 A 和 B 之间的标识列。

当**SQL 2005**出现时，我发现`Row_Number()`并且从那时起我就一直在使用它......

但是现在，我发现`Row_Number()`. 当您使用不太庞大的结果集并对标识列进行排序时，它的性能非常好。但是，当您处理**大型结果集**（如超过 10,000 条记录）并**在 non-identity column 上对其进行排序时，****它的性能非常差**。如果结果集超过 250,000 条记录，即使您按标识列进行排序，性能也会很差。对我来说，它到了抛出错误的地步，“**命令超时！** ”****`Row_Number()`****

 ********您使用什么来对 SQL 2005 上的大型结果集进行分页？** 在这种情况下临时表方法是否更好？我不确定这种[使用带有 SET ROWCOUNT 的临时表的](http://www.4guysfromrolla.com/webtech/042606-1.shtml)方法是否会表现得更好......但有人说如果你有多列主键，就会出现给出错误行号的问题。

就我而言，我需要能够按日期类型列对结果集进行排序......对于我的生产网络应用程序。

让我知道您**在 SQL 2005 中使用什么进行高性能分页**。而且我还想知道一种创建索引的聪明方法。**我怀疑选择正确的主键和/或索引（集群/非集群）将在这里发挥重要作用。**

提前致谢。

PS**有谁知道stackoverflow使用什么？**

**编辑：**我的看起来像......

```
SELECT postID, postTitle, postDate
FROM
   (SELECT postID, postTitle, postDate, 
         ROW_NUMBER() OVER(ORDER BY postDate DESC, postID DESC) as RowNum
    FROM MyTable
   ) as DerivedMyTable
WHERE RowNum BETWEEN @startRowIndex AND (@startRowIndex + @maximumRows) - 1 
```

postID: Int, Identity (auto-increment), Primary key

发布日期：日期时间

**编辑：**每个人都在使用 Row_Number() 吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-04T03:09:31.347

row_number() 技术应该很快。我已经看到了 100,000 行的良好结果。

您是否使用类似于以下内容的 row_number() ：

```
SELECT column_list
FROM
   (SELECT column_list
         ROW_NUMBER() OVER(ORDER BY OrderByColumnName) as RowNum
    FROM MyTable m
   ) as DerivedTableName
WHERE RowNum BETWEEN @startRowIndex AND (@startRowIndex + @maximumRows) - 1 
```

...您是否有 column_list 的覆盖索引和/或“OrderByColumnName”列上的索引？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T20:42:56.177

好吧，对于您的示例查询 ROW_COUNT 应该非常快，有数千行，前提是您的 PostDate 字段上有一个索引。如果您不这样做，服务器需要对您的 PK 执行完整的聚集索引扫描，实际上加载每个页面，获取您的 PostDate 字段，按它排序，确定要为结果集提取的行并再次获取这些行。这有点像一遍又一遍地创建临时索引（您可能会在平原上看到一个表/索引假脱机）。

难怪你会超时。

我的建议：在 PostDate DESC 上设置一个索引，这就是 ROW_NUMBER 将要检查的内容 - (ORDER BY PostDate DESC, ...)

至于您所指的文章 - 我过去在没有 ROW_COUNT 的情况下使用 SQL Server 2000 完成了很多分页和工作，文章中使用的方法是最有效的方法。它并非在所有情况下都有效（您需要唯一或几乎唯一的值）。[此处](http://www.codeproject.com/KB/aspnet/PagingLarge.aspx)概述了其他一些方法。

.

# c - strcat() 换行，重复字符串

> ID：169610
> 
> 赞同：1
> 
> 时间：2008-10-04T02:44:04.673
> 
> 标签：c, string

我正在编写一个函数，它获取系统的路径环境变量，拆分每个路径，然后将其他一些额外字符连接到每个路径的末尾。

在我使用该功能之前一切正常`strcat()`（参见下面的代码）。

```
char* prependPath( char* exeName )
{
    char* path = getenv("PATH");  
    char* pathDeepCopy = (char *)malloc(strlen(path) + 1);
    char* token[80];
    int j, i=0; // used to iterate through array

    strcpy(pathDeepCopy, path);

    //parse and split

    token[0] = strtok(pathDeepCopy, ":"); //get pointer to first token found and store in 0
    //place in array
    while(token[i]!= NULL) { //ensure a pointer was found
        i++;
        token[i] = strtok(NULL, ":"); //continue to tokenize the string
    }

    for(j = 0; j <= i-1; j++) {
        strcat(token[j], "/");
        //strcat(token[j], exeName);

        printf("%s\n", token[j]); //print out all of the tokens
    }
} 
```

我的 shell 输出是这样的（我将“/which”连接到所有内容上）：

```
...
/usr/local/applic/Maple/bin/which
which/which
/usr/local/applic/opnet/8.1.A.wdmguru/sys/unix/bin/which
which/which
Bus error (core dumped) 
```

我想知道为什么`strcat`显示一个新行然后重复`which/which`. 我也想知道`Bus error (core dumped)`最后。

有人在使用的时候见过这个`strcat()`吗？如果是这样，有人知道如何解决吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-04T02:55:17.927

strtok() 不会给你一个新的字符串。
它通过在拆分字符所在的位置插入 char '\0' 来破坏输入字符串。

因此，您使用 strcat(token[j],"/") 会将 '/' 字符放在 '\0' 所在的位置。
此外，最后一个标记将开始将分配内存末尾的“哪个”附加到未知内存中。

您可以使用 strtok() 将字符串拆分为块。但是，如果您想将任何内容附加到令牌上，则需要制作令牌的副本，否则您的附加内容将溢出到下一个令牌上。

此外，您需要更加小心您的内存分配，因为您到处都在泄漏内存:-)

PS。如果您必须使用 C 字符串。使用 strdup() 复制字符串。

```
char* prependPath( char* exeName )
{
    char* path         = getenv("PATH");
    char* pathDeepCopy = strdup(path);
    char* token[80];
    int j, i; // used to iterate through array

    token[0] = strtok(pathDeepCopy, ":");
    for(i = 0;(token[i] != NULL) && (i < 80);++i)
    {
        token[i] = strtok(NULL, ":");
    }

    for(j = 0; j <= i; ++j)
    {
        char*  tmp = (char*)malloc(strlen(token[j]) + 1 + strlen(exeName) + 1);
        strcpy(tmp,token[j]);
        strcat(tmp,"/");
        strcat(tmp,exeName);
        printf("%s\n",tmp); //print out all of the tokens
        free(tmp);
    }
    free(pathDeepCopy);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-04T02:48:49.860

strtok() 标记到位。当您开始将字符附加到标记时，您将覆盖下一个标记的数据。

此外，一般来说，简单地连接到现有字符串是不安全的，除非您知道字符串所在的缓冲区大小足以容纳结果字符串。这是 C 程序中出现错误的主要原因（包括可怕的缓冲区溢出安全错误）。

因此，即使 strtok() 返回与您的原始字符串无关的全新字符串（它没有），当您连接到它们时，您仍然会超出字符串缓冲区。

您可能想要研究的 strcpy()/strcat() 的一些更安全的替代方案（您可能需要跟踪其中一些的实现——它们并不都是标准的）：

*   strncpy() - 包括目标缓冲区大小以避免溢出。有不总是终止结果字符串的缺点
*   strncat()

*   strlcpy() - 类似于 strncpy()，但更易于使用和更健壮（[http://en.wikipedia.org/wiki/Strlcat](http://en.wikipedia.org/wiki/Strlcat)）

*   strlcat()

*   strcpy_s() - 这些函数的 Microsoft 变体

*   strncat_s()

如果您可以使用 C++，您应该努力使用的 API： **std::string 类**。如果您使用 C++ std::string 类，您几乎不必担心包含字符串的缓冲区 - 该类会为您管理所有这些。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-04T02:49:08.313

`strtok`不复制令牌，而只是在字符串中指向它。因此，当您将 '/' 放在标记的末尾时，您将*在下一个*标记的开头或缓冲区的末尾写入 '\0'。

另请注意，即使 strtok*确实*返回了令牌的副本而不是原件（它没有），它也不会为您分配额外的空间来附加字符，因此它仍然是一个缓冲区溢出错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-04T03:01:44.233

如果您使用 C++，请考虑[此处](https://stackoverflow.com/questions/53849/how-do-i-tokenize-a-string-in-c#53863)讨论的[boost::tokenizer](http://www.boost.org/doc/libs/1_36_0/libs/tokenizer/tokenizer.htm)。

如果您卡在 C 语言中，请考虑使用 strtok_r，因为它是可重入且线程安全的。并不是说您在这种特定情况下需要它，但这是一个养成的好习惯。

哦，使用 strdup 一步创建您的重复字符串。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-04T03:04:11.013

好的，首先，要小心。你正在失去记忆。Strtok() 返回一个指向下一个标记的指针，您将它存储在一个字符数组中。而不是 char token[80] 它应该是 char *token。使用 strtok 时也要小心。strtok 实际上破坏了名为 pathDeepCopy 的字符数组，因为它会将每次出现的“：”替换为 '\0'。正如 Mike F 上面告诉你的那样。请务必使用 calloc 的 memset 初始化 pathDeppCopy。因此，当您编码 token[i] 时，无法知道所指向的内容。并且由于令牌中没有有效数据，因此很可能会抛出核心转储，因为您正在尝试连接。一个字符串到另一个没有验证数据（令牌）的字符串。您正在寻找的可能是指向 char 的指针数组，其中存储指向 strtok 返回的令牌的所有指针，在这种情况下，

希望这个对你有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-04T02:59:57.903

将其替换为

strcpy(pathDeepCopy, 路径);

```
 //parse and split
    token[0] = strtok(pathDeepCopy, ":");//get pointer to first token found and store in 0
    //place in array
    while(token[i]!= NULL) { //ensure a pointer was found
    i++;
    token[i] = strtok(NULL, ":"); //continue to tokenize the string
    }

// use new array for storing the new tokens 
// pardon my C lang skills. IT's been a "while" since I wrote device drivers in C.
const int I = i;
const int MAX_SIZE = MAX_PATH;
char ** newTokens = new char [MAX_PATH][I];
for (int k = 0; k < i; ++k) {
   sprintf(newTokens[k], "%s%c", token[j], '/');
   printf("%s\n", newtoken[j]); //print out all of the tokens
} 
```

这将取代覆盖内容并防止核心转储。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-05T19:31:40.177

并且不要忘记检查 malloc 是否返回 NULL！

# jakarta-ee - Java EE——它只是绒毛还是真正的东西？

> ID：169620
> 
> 赞同：12
> 
> 时间：2008-10-04T02:50:34.833
> 
> 标签：jakarta-ee, frameworks, lamp, java-ee-5

我熟悉 LAMP 堆栈，多年来已成功部署了一些基于它的 Web 站点。我使用过从 Apache + modPerl 到 PHP，再到 Ruby 和 Rails 的所有东西。通过充分利用缓存，我的 Rails 站点可以维持相当不错的负载，但我说的不是大量。

我从来没有真正喜欢 Java 作为一门语言，或者 XML，并且一直非常忽略 Java EE 的整个方面。对于那些在这两个世界中都有过真实和直接经验的人：Java EE 是否有一些我想念的超酷的东西，或者只是一堆热空气？是什么证明了专有应用服务器的高价？

我不是在这里拖钓：我正在寻找*现代*LAMP 框架中缺少的 Java EE 真正指出的具体示例（如果存在此类差异）。（现代 = Rails、Django 等）。或者使用 LAMP 确实做得更好的那些东西（更少的 XML 仰卧起坐）。

+++++ 2008 年 10 月 16 日更新

我很遗憾地报告，这里的大多数回复都没有帮助，只是属于以下两类之一：“它可以扩展，因为这里是大型网站的三个示例”和“它可以扩展，因为它实际上比LAMP 堆栈”。

我读了很多书，得出的结论是 Java EE 只有一个非常好的技巧：事务（感谢 Will），至于其余的你可以根据自己的优点成功或失败，环境中本质上没有任何东西为了让您创建一个可扩展且可靠的网站，Java EE 确实有很多陷阱，使其很容易失败（例如，很容易开始使用会话 bean 而没有意识到您现在为相当多的 JMS 付出了代价通过不同的设计可能可以避免的流量。）

有用的讨论

*   [http://www.subbu.org/blog/2007/10/large-scale-web-site-development](http://www.subbu.org/blog/2007/10/large-scale-web-site-development)
*   [http://highscalability.com/](http://highscalability.com/)
*   [http://www.oreillynet.com/onlamp/blog/2004/07/php_scales.html](http://www.oreillynet.com/onlamp/blog/2004/07/php_scales.html)
*   [http://www.schlossnagle.org/~george/blog/index.php?/archives/29-Why-PHP-Scales-A-Cranky,-Snarky-Answer.html](http://www.schlossnagle.org/~george/blog/index.php?/archives/29-Why-PHP-Scales-A-Cranky,-Snarky-Answer.html)
*   [http://blogs.law.harvard.edu/philg/2003/09/20/](http://blogs.law.harvard.edu/philg/2003/09/20/)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-04T03:35:37.270

Java EE 在 LAMP 堆栈上提供的关键区别可以归结为一个词。交易。

大多数较小的系统仅依赖于数据库提供的事务系统，并且对于许多应用程序来说（显然）相当令人满意。

但是每个 Java EE 服务器都包含一个分布式事务管理器。这使您可以安全可靠地跨不同系统执行更复杂的事情。

最简单的示例是从数据库中获取记录，将其放入消息队列 (JMS)，然后从数据库中删除该行的简单场景。这个简单的案例涉及两个独立的系统，并且不能可靠地在事务之外完成。例如，您可以将行放到消息队列中，但（由于系统故障）不能从数据库中删除该行。您可以看到与 JMS 提供者的事务和与数据库的单独事务并不能真正解决问题，因为这些事务没有链接在一起。

显然，这个简单的场景可以解决、处理等等。不过，Java EE 的好处是您不必处理这些问题——容器可以处理它们。

而且，不是每个问题都需要这种级别的事务处理。但对于那些这样做的人来说，这是无价的。一旦您习惯了使用它们，您就会发现 Java EE 服务器的事务管理是一项巨大的资产。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-04T03:13:49.153

大型 Java EE Web 服务器（Jboss、WebSphere、WebLogic 等）和 Windows Server/IIS/ASP.NET 在可扩展性和性能方面确实与典型的灯堆栈不同。

我的团队负责美国最大的电信商务网站之一，每天处理数百万次点击（我们的一个数据库的大小超过 1000TB，为您提供一些视角）。

我们在网站的不同部分使用 ASP.NET 和 WebSphere 以及 SAP ISA（这也是一个 Java EE 解决方案）的组合，如果不扩展至大量，LAMP 堆栈绝对无法处理这种负载硬件.......NET 堆栈部分处理大部分负载并且仅在 32 台服务器上运行。

我们也没有做任何花哨的事情，例如使用 memcached 类型的解决方案或静态 HTTP 缓存……我们在各个应用服务器上缓存 SOAP 调用和数据库调用，但不使用内存数据库等……到目前为止，我们的平台可以处理它。

所以，是的，将这种东西与 LAMP 进行比较是苹果与橙子的对比。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-04T03:05:36.643

Amazon.com、ebay、google——它们都使用 Java EE 的一个子集，并且非常成功。它们都使用 servlet 和 JSP

如果您尝试使用 EJB 1.1 或 EJB 2.0，则会影响可伸缩性。由于使单元测试更难，开发人员的工作效率也会降低。

借助 EJB 3.0，开发人员的生产力和应用程序的可扩展性得到了提高。

因此，根据您的应用程序需要，仅使用对您有意义的那些 Java EE。仅使用您打算使用的那些部分进行示例 POC（概念证明）。此 POC 将显示应用程序的运行情况。

新的 Java EE 应用服务器并不总是需要大量的 XML。他们会让你使用注解来进行依赖注入和数据库映射。

超过 50% 的企业开发发生在 Java EE 上（当我这么说时，它主要使用 Java EE 堆栈的子集。有人可能使用无状态会话 bean EJB，有人可能只是 JNDI，有人可能使用 MESSAGE DRIVEN BEAN EJB） .

希望能帮助到你。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-04T03:08:56.963

您可以使用 Java EE 构建真正庞大且可扩展的应用程序，它广泛用于企业计算。

但：

我对 Java EE 的体验非常糟糕，因为我的团队所做的工作似乎 90% 都是样板和管道。我们当时的生产力远远低于我们使用不同技术堆栈时的生产力。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-04T03:48:55.463

几乎所有的答案都提到了构建 Java EE *Web*应用程序需要什么。让我提及另一个重要的考虑因素。大多数企业都有重要的后台要求，企业应用程序必须与其他应用程序集成。这可以从连接到一些笨拙的旧 COBOL 大型机程序，到 LAMP 堆栈，再到某个会计师在晚上启动的小型 Access 应用程序等。通常这意味着您需要某种消息传递解决方案才能获得 2 或更多应用程序连接在一起。根据我的经验，我发现 Java EE 世界在处理这些集成问题方面比典型的 LAMP 堆栈更进一步。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-04T03:20:18.860

Java EE 的核心只是一堆接口，它们具有由容器提供的实现。大多数应用程序并不使用所有的 Java EE 规范。

人们在讨论 Java EE 时会想到两个主要方面：EJB 和 Servlet。

我对 EJB 没有任何经验。我使用[Spring Framework](http://www.springframework.org/)，因此它提供了 Ben Collins 的回答中引用的所有“管道和样板”代码。它提供了我们需要 EJB 做的所有事情，然后是一些（具有数据库访问权限的事务是我们使用它的特殊功能的地方，尽管我们也将它的 IOC 容器用于 Servlet 部分）。

然而，Servlet 非常棒。它们是一种非常好的和经过验证的技术。

Servlet 的核心是一个请求和响应循环：用户请求某事，服务器截取该请求并基于该请求提供响应。可以通过单个用户的会话来跟踪请求和响应链。

至于专有应用服务器的高昂价格，我不知道为什么价格如此之高，但 Apache Tomcat 是一个非常好的 Servlet 容器，而且是免费的。我们使用 Tomcat 进行测试，使用 WebSphere 进行部署（Websphere 由我们的客户端提供给应用程序使用）。不幸的是，它只是 Websphere 6（更新 11，正如我们失望地发现的那样，它没有修复更新 13，它使 JSTL 函数在包含在 JSP 标记中时能够正常运行），所以我们被迫使用 Java 1.4 倍，而不是 Java 1.5+。

还有几个框架（参见前面引用的 Spring 框架作为示例）可以轻松进行 Servlet 开发。如果您只是将它用于 HTTP/HTML，那么有大量框架可以轻松帮助您进行此开发。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-04T03:56:37.350

必须像对待任何其他工具一样对待 Java EE 和其他程序语言。是的，它已在企业环境中使用，并且需要良好的工艺才能让这些工具“完美”地工作并知道何时使用它。我目前正在研究大型机环境，并且在某种程度上使用了 Java EE。如果涉及到高速事务，Java EE 将是我最后的选择。如果需要多平台互操作性，那么 Java EE、XML 和 Web 服务会更合适。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-16T22:56:38.253

在可伸缩性方面，Java EE 为您提供了 LAMP 堆栈或 RUBY 所没有的大量选择。所有的选择都围绕着 N 层应用程序，而大多数 LAMP 和 ruby​​ 应用程序都是 2 层的。

我正在开发一个应用程序，并计划允许人们通过网络访问 API。Java EE 将允许我轻松扩展中间层，而不会影响 UI 层。当我向我的应用程序添加接口时，我可以非常轻松地扩展中间层。内置的 LAMP 堆栈没有这个概念。

所以我必须使用接口、Web UI 和 SOAP API。现在我想要一个休息 API。好的......构建该接口以达到中间层......并将更多计算机添加到集群......或者去多集群并不重要。这个中间层全是 EJB，在许多方面比 SOAP 更快的协议。

现在假设我想为我的用户添加短信功能。我还需要根据他们设置的内容来执行此操作，并且来自数据库。可扩展性方面，我想将文本的实际发送与应用程序想要发送的实现断开连接。这让 JMS 尖叫。我可以使用 Timer Bean 每隔 X 时间关闭一次，找出需要发送的消息，并将每条消息放入 JMS。现在我可以管理队列以及有多少处理器正在处理它等等。我可以看到有多少文本正在输出。我什至可以将接收器放在另一个盒子上，这对我的其他服务器性能几乎没有影响。

明智地扩展，我可以看到我的哪些 EJB 受到的影响最大，并为这些 EJB 添加更多资源，同时从其他 EJB 中删除资源。我可以使用 JMS 队列以及 Java EE 技术堆栈的所有其他部分来做到这一点。我不仅获得了可扩展性，还获得了对服务器资源的管理。

由于 LAMP 和 Ruby 还没有类似 JMS 的异步处理队列，或者能够轻松地将业务逻辑放在单独的层中，因此它们可能更难以使用多个接口进行扩展。您需要做什么来删除逻辑，并使其可用于不同的界面？假设您现在不仅为您的网站提供了 Web UI，还提供了桌面 UI、IVR 接口和 SOAP 接口？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-06T06:57:21.980

撇开可伸缩性和其他问题不谈，这里有一个没有提到的简单的事情，这可能是一个优势：它是 Java。

*   There's a staggering amount of 3rd party libraries available for Java, both proprietary and open-source. Now, I'm sure there are huge free libraries for Perl, Ruby, PHP, etc. - but when it comes to commercial libraries for more niche application areas, they don't come close to Java (and .NET, and probably C++). Whether you *need* any special 3rd party libraries of course depends solely on what kind of application you are building.
*   I think there are more Java developers in the world than developers for any other platform. (Maybe I'm wrong but this is what I've heard sometimes.)

When choosing a platform in a commercial setting, either *might* turn out important.

# sql-server - 是否可以按 SQL Server 中给定存储过程参数的任何列排序？

> ID：169624
> 
> 赞同：4
> 
> 时间：2008-10-04T02:52:55.157
> 
> 标签：sql-server, database, sql-server-2005

我正在研究通过给定一些输入指定的列对表进行排序，从我发现的情况来看，没有简单的方法可以做到这一点。我发现最好的是一个 switch 语句：

```
SELECT Column1, Column2, Column3, Column4
FROM Table
ORDER BY CASE WHEN @OrderBY = 'Column1' THEN Column1
              WHEN @OrderBY = 'Column2' THEN Column2
              WHEN @OrderBY = 'Column3' THEN Column3
              WHEN @OrderBY = 'Column4' THEN Column4 
```

`CASE`没有这样的声明是否可以做到这一点？如果表变得更大并且需要对更多列进行排序，这可能会变得混乱。

我能够做到这一点的唯一方法就是连接一个大的 SQL 字符串，这在某种程度上破坏了存储过程的优势，并使 SQL 难以编写和维护。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-04T02:57:34.507

你有两个选择：

1.  正如您在上面实施的

2.  或者生成动态sql并使用`sp_executesql`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T02:56:26.583

我通常将存储过程转换为返回表的函数（因此您可以选择 FROM it ...并在应用程序代码中按列添加动态顺序：

```
Select
    *
From
   myTableFUnction()
Order by
   1, 2, 3, 6  <-- defined by application code in the SQL for the query 
```

罗恩

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-04T07:24:51.253

SQL Server 和 Oracle 的 RANK 特性可以提高性能并使代码更简洁：

SQL：

```
DECLARE @column varchar(10)

SET @column = 'D'

SELECT *
FROM Collection.Account AS A
ORDER BY 
      CASE 
            WHEN @column = 'A' THEN (RANK() OVER(ORDER BY A.Code ASC))
            WHEN @column = 'D' THEN (RANK() OVER(ORDER BY A.Code DESC))
      END 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-25T07:40:02.380

您已经编写了正确的语法：

```
SELECT Column1, Column2, Column3 
FROM SOME_TABLE
ORDER BY 1,2,3 
```

尝试一下

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-10-04T18:19:39.183

在这种情况下，除非您有一个非常大的数据集并且您需要利用数据库服务器的功能（瘦客户端、弱客户端机器等），否则最好在客户端内进行排序。

# regex - 正则表达式检查是否以 .jpg、.png 或 .gif 结尾的有效 URL

> ID：169625
> 
> 赞同：40
> 
> 时间：2008-10-04T02:53:56.603
> 
> 标签：regex, image, url

我希望用户提交一个有效但也是图像的 URL，以 .jpg、.png 或 .gif 结尾。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-10-04T02:56:26.333

```
(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*\.(?:jpg|gif|png) )(?:\?([^#]*))?(?:#(.*))?
```

[这是来自RFC 2396](http://www.ietf.org/rfc/rfc2396.txt)的官方 URI 解析正则表达式的（稍作修改）版本。它允许`#fragments`并`?querystrings`出现在文件名之后，这可能是也可能不是您想要的。它还匹配任何有效域，包括`localhost`，这可能不是您想要的，但可以修改。

一个更传统的正则表达式可能如下所示。

```
^https?://(?:[a-z0-9\-]+\.)+[az]{2,6}(?:/[^/#?]+)+\.(?:jpg |gif|png)$
          |-------- 域 -----------|--- 路径 ---|-- 扩展名 ---|
```

**编辑**见我的[另一条评论](https://stackoverflow.com/questions/169625/regex-to-check-if-valid-url-that-ends-in-jpg-png-or-gif#169656)，虽然它没有像这个一样完整地回答这个问题，但我觉得在这种情况下它可能更有用。但是，我把它留在这里~~业力嫖娼~~完整性原因。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2008-10-04T03:10:55.760

实际上。

你为什么要检查网址？这不能保证你会得到一个图像，也不能保证你拒绝的东西*不是*图像。尝试对其执行 HEAD 请求，并查看它*实际上*是什么内容类型。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-04T02:57:34.133

通常，您最好使用内置库或框架函数验证 URL，而不是滚动您自己的正则表达式来执行此操作 - 有关详细信息，请参阅[检查字符串是否为有效 URL 的最佳正则表达式是什么](https://stackoverflow.com/questions/161738/what-is-the-best-regular-expression-to-check-if-a-string-is-a-valid-url#161749)。

但是，如果您热衷于这样做，请查看以下问题：

[获取 URL 的一部分（正则表达式）](https://stackoverflow.com/questions/27745/getting-parts-of-a-url-regex)

然后，一旦您对 URL 感到满意（通过您用来验证它的任何方式），您可以使用简单的“endswith”类型字符串运算符来检查扩展名，或者使用简单的正则表达式，如

```
(?i)\.(jpg|png|gif)$ 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-09-18T08:46:10.667

```
(http(s?):)|([/|.|\w|\s])*\.(?:jpg|gif|png) 
```

这将处理来自该字符串的所有图像：

```
background: rgb(255, 0, 0) url(../res/img/temp/634043/original/cc3d8715eed0c.jpg) repeat fixed left top; cursor: auto;
<div id="divbg" style="background-color:#ff0000"><img id="bg" src="../res/img/temp/634043/original/cc3d8715eed0c.jpg" width="100%" height="100%" /></div>
background-image: url(../res/img/temp/634043/original/cc3d8715eed0c.png);
background: rgb(255, 0, 0) url(http://google.com/res/../img/temp/634043/original/cc3    _d8715eed0c.jpg) repeat fixed left top; cursor: auto;
background: rgb(255, 0, 0) url(https://google.com/res/../img/temp/634043/original/cc3_d8715eed0c.jpg) repeat fixed left top; cursor: auto; 
```

在此处测试您的正则表达式：[https ://regex101.com/r/l2Zt7S/1](https://regex101.com/r/l2Zt7S/1)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-05-27T11:39:35.883

`(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|gif|png)`对我来说真的很好。

这将匹配以下形式的 URL：

```
https://farm4.staticflickr.com/3894/15008518202_c265dfa55f_h.jpg
http://farm4.staticflickr.com/3894/15008518202_c265dfa55f_h.jpg
https://farm4.staticflickr.com/3894/15008518202-c265dfa55f-h.jpg
https://farm4.staticflickr.com/3894/15008518202.c265dfa55f.h.jpg
https://farm4.staticflickr.com/3894/15008518202_c265dfa55f_h.gif
http://farm4.staticflickr.com/3894/15008518202_c265dfa55f_h.gif
https://farm4.staticflickr.com/3894/15008518202-c265dfa55f-h.gif
https://farm4.staticflickr.com/3894/15008518202.c265dfa55f.h.gif
https://farm4.staticflickr.com/3894/15008518202_c265dfa55f_h.png
http://farm4.staticflickr.com/3894/15008518202_c265dfa55f_h.png
https://farm4.staticflickr.com/3894/15008518202-c265dfa55f-h.png
https://farm4.staticflickr.com/3894/15008518202.c265dfa55f.h.png 
```

在此处针对 URL 检查此正则表达式：[http ://regexr.com/3g1v7](http://regexr.com/3g1v7)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-04T08:52:32.760

如果您*真的*想确定，获取给定 URL 的前一两个千字节应该足以确定您需要了解的有关图像的所有信息。

这是[一个如何](http://effbot.org/zone/pil-image-size.htm)使用 Python获取该信息[的示例，这是一个将其用作 Django 表单字段的示例，它](http://www.djangosnippets.org/snippets/402/)允许您根据其 URL 轻松验证图像的存在、文件大小、尺寸和格式。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-04T06:52:39.447

这是 Perl 的基本思想。盐调味。

```
#!/usr/bin/perl

使用 LWP::UserAgent；

我的 $ua = LWP::UserAgent->new;

@ARGV = qw(http://www.example.com/logo.png);

我的 $response = $ua->head($ARGV[0]);

我的($class, $type) = 拆分 m|/|, lc $response->content_type;

print "这是一张图片！\n" if $class eq 'image';

```

如果您需要检查 URL，请为其使用可靠的库，而不是尝试自己处理所有奇怪的情况：

```
使用 URI；

我的 $uri = URI->new($ARGV[0]);

我的 $last = ( $uri->path_segments )[-1];

我的( $extension ) = $last =~ m/\.([^.]+)$/g;

print "我的扩展名是 $extension\n";

```

祝你好运， ：）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-31T09:34:36.373

使用[FastImage](https://github.com/sdsykes/fastimage) - 它会从 URL 中获取所需的最少数据，以确定它是否是图像、图像的类型和大小。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-04T02:56:52.527

```
^((http(s?)\:\/\/|~/|/)?([\w]+:\w+@)?([a-zA-Z]{1}([\w\-]+\.)+([\w]{2,5}))(:[\d]{1,5})?((/?\w+/)+|/?)(\w+\.(jpg|png|gif)) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-07-01T07:33:59.047

除了[丹的](https://stackoverflow.com/questions/169625/regex-to-check-if-valid-url-that-ends-in-jpg-png-or-gif#169631)答案。

### 如果有IP地址而不是域。

稍微改变一下正则表达式。（有效 IPv4 和 IPv6 的临时解决方案）

```
^https?://(?:[a-z0-9\-]+\.)+[a-z0-9]{2,6}(?:/[^/#?]+)+\.(?:jpg|gif|png)$ 
```

但是，这可以改进，以便 IPv4 和 IPv6 验证子网范围。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-07-24T07:48:43.420

此表达式将匹配所有图像 url -

```
^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+(?:png|jpg|jpeg|gif|svg)+$ 
```

**例子 -**

***有效的 -***

```
https://itelligencegroup.com/wp-content/usermedia/de_home_teaser-box_puzzle_in_the_sun.png
http://sweetytextmessages.com/wp-content/uploads/2016/11/9-Happy-Monday-images.jpg
example.com/de_home_teaser-box_puzzle_in_the_sun.png
www.example.com/de_home_teaser-box_puzzle_in_the_sun.png
https://www.greetingseveryday.com/wp-content/uploads/2016/08/Happy-Independence-Day-Greetings-Cards-Pictures-in-Urdu-Marathi-1.jpg
http://thuglifememe.com/wp-content/uploads/2017/12/Top-Happy-tuesday-quotes-1.jpg
https://1.bp.blogspot.com/-ejYG9pr06O4/Wlhn48nx9cI/AAAAAAAAC7s/gAVN3tEV3NYiNPuE-Qpr05TpqLiG79tEQCLcBGAs/s1600/Republic-Day-2017-Wallpapers.jpg 
```

***无效的 -***

```
https://www.example.com
http://www.example.com
www.example.com
example.com
http://blog.example.com
http://www.example.com/product
http://www.example.com/products?id=1&page=2
http://www.example.com#up
http://255.255.255.255
255.255.255.255
http://invalid.com/perl.cgi?key= | http://web-site.com/cgi-bin/perl.cgi?key1=value1&key2
http://www.siteabcd.com:8008 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-09-22T16:51:13.807

只是提供更好的解决方案。您可以验证 uri 并检查格式然后：

```
public class IsImageUriValid
{
    private readonly string[] _supportedImageFormats =
    {
        ".jpg",
        ".gif",
        ".png"
    };

    public bool IsValid(string uri)
    {
        var isUriWellFormed = Uri.IsWellFormedUriString(uri, UriKind.Absolute);

        return isUriWellFormed && IsSupportedFormat(uri);
    }

    private bool IsSupportedFormat(string uri) => _supportedImageFormats.Any(supportedImageExtension => uri.EndsWith(supportedImageExtension));
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-09-22T17:03:50.537

```
 const url = "https://www.laoz.com/image.png";
    const acceptedImage = [".png", ".jpg", ".gif"];
    const extension = url.substring(url.lastIndexOf("."));
    const isValidImage = acceptedImage.find((m) => m === extension) != null;
    console.log("isValidImage", isValidImage);
    console.log("extension", extension); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-03-15T09:17:06.010

Reference: See DecodeConfig section on the official go lang image lib docs [here](https://golang.org/pkg/image/)

I believe you could also use DecodeConfig to get the format of an image which you could then validate against const types like jpeg, png, jpg and gif ie

```
import (
  "encoding/base64"
  "fmt"
  "image"
  "log"
  "strings"
  "net/http"

  // Package image/jpeg is not used explicitly in the code below,
  // but is imported for its initialization side-effect, which allows
  // image.Decode to understand JPEG formatted images. Uncomment these
  // two lines to also understand GIF and PNG images:
  // _ "image/gif"
  // _ "image/png"
  _ "image/jpeg"
   )

func main() {
  resp, err := http.Get("http://i.imgur.com/Peq1U1u.jpg")
  if err != nil {
      log.Fatal(err)
  }
  defer resp.Body.Close()
  data, _, err := image.Decode(resp.Body)
  if err != nil {
      log.Fatal(err)
  }
  reader := base64.NewDecoder(base64.StdEncoding, strings.NewReader(data))
  config, format, err := image.DecodeConfig(reader)
  if err != nil {
      log.Fatal(err)
  }
  fmt.Println("Width:", config.Width, "Height:", config.Height, "Format:", format)
} 
```

format here is a string that states the file format eg jpg, png etc

# .net - 日期时间，日期时间？和 LINQ

> ID：169637
> 
> 赞同：11
> 
> 时间：2008-10-04T02:58:23.257
> 
> 标签：.net, linq, datetime

当我使用具有 DateTime 字段的 LINQ 检索记录时，只有 ToString() 可用。

所有其他 DateTime 方法在哪里？

我必须将 DateTime 转换为 Convert.ToDateTime 吗？字段返回？

(DateTime) 和 (DateTime) 有什么区别？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-04T03:08:20.350

如果*`DateTime?`*你的意思是 a `Nullable<DateTime>`，那么你可以通过属性获取`DateTime`值。`DateTime?.`**`Value`**

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-04T03:27:17.910

在 SQL 中，DateTimes 允许为空。在 C# 中，日期时间不能为空。您可以阅读一些关于[可空值类型](http://aspalliance.com/1682_What_to_Know_About_Value_Types_and_Reference_Types_in_C.5)的信息。由于值类型变量不能为空，因此创建了一个泛型类来处理这种情况。它被称为 Nullable<>，通常在类型后面加上问号。

为了使用这些值，您需要检查 .HasValue 属性。它是一个布尔值，它知道对象中是否有值或者它是否为空。一旦您检查了 .HasValue 属性是否为真，您就可以安全地使用 .Value 属性。.Value 属性的类型为 DateTime。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-04T03:45:42.117

在 SQL 中，您将 DateTime 字段设置为 Allow Null。然后在 LINQ 中，当您要访问该字段时，.NET 不知道该字段是否真的是一个日期，这就是为什么您必须在任何日期方法可供您使用之前使用 Convert.ToDateTime() 的原因。

如果该字段将始终包含日期，请将数据库列设置为 NOT NULL，您应该没问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T03:03:14.027

除了命名空间冲突，我知道 SQL 的日期时间与 C# 日期时间有不同的纪元（因此有效日期范围也不同）。

尝试将 a 发送`new DateTime()`到存储过程，看看我的意思。

# java - 有没有办法在 Java 中实现代数类型？

> ID：169662
> 
> 赞同：7
> 
> 时间：2008-10-04T03:14:27.700
> 
> 标签：java, class, abstract-class, final, adts

在 Java 中，是否有可能强制一个类具有一组特定的子类而没有其他子类？例如：

```
public abstract class A {}
public final class B extends A {}
public final class C extends A {}
public final class D extends A {} 
```

我可以以某种方式强制不能创建 A 的其他子类吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-04T03:17:50.457

给类**`A`**一个具有包级可访问性的构造函数（并且没有其他构造函数）。

^(谢谢，Dave L.，关于没有其他构造函数的一点。)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T03:21:19.373

您可能需要一个枚举（Java >= 1.5）。枚举类型可以有一组固定值。它具有类的所有优点：它们可以具有字段和属性，并且可以使它们实现接口。无法扩展枚举。

例子：

```
enum A {

  B,
  C,
  D;

  public int someField;

  public void someMethod() {
  }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T03:18:09.753

您可以将 A、B、C、D 类放在单独的包中，并使 A 类不公开。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-24T13:47:29.160

教堂编码救援：

```
public abstract class A {
  public abstract <R> R fold(R b, R c, R d);
} 
```

只有三种可能的实现：

```
public final class B extends A {
  public <R> R fold(R b, R c, R d) {
    return b;
  }
}

public final class C extends A {
  public <R> R fold(R b, R c, R d) {
    return c;
  }
}

public final class D extends A {
  public <R> R fold(R b, R c, R d) {
    return d;
  }
} 
```

# .net - 保留打印机设置

> ID：169695
> 
> 赞同：4
> 
> 时间：2008-10-04T03:44:21.777
> 
> 标签：.net, serialization, printing, settings

在.Net中保留/保存打印机设置的最佳方法是什么？.Net 1.1 在`PrinterSetting`对象的序列化中曾经存在一个错误，并且有一些[解决方法](http://www.codeproject.com/KB/cs/printersettings.aspx)，但我想知道在框架的更新版本中是否没有更好或更简单的方法来执行此操作。

主要用例是允许用户使用标准打印机设置用户界面定义给定打印机的所有打印详细信息（包括特定于打印机的选项）并保存这些信息，以便下次用户打印到该打印机时恢复它们打印机。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-13T04:57:25.557

[当他们想再次使用它](http://nicholas.piasecki.name/blog/2008/11/programmatically-selecting-complex-printer-options-in-c-shar/)以将一些专有的打印机设置发送到工作中的复印机时，我做了一个非常漂亮的方法来转储当前的 DEVMODE 并覆盖它。我找不到更好的方法来获取一些根本没有通过打印 API 公开的属性（例如旧 Fiery 控制器上的专有装订和折叠选项......我认为新的 XPS 打印机型号支持对于这些，但上帝只知道我们什么时候会开始看到行业对此的支持）。

主要的警告是它不能跨机器或跨同一打印机驱动程序的不同版本移植。对我来说，这没什么大不了的，因为它是一个受控的办公环境。对您而言，我想这将取决于您的用户如何使用该程序的上下文。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T09:17:32.663

你应该使用类`PrinterSettings`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T10:57:20.917

不是程序化的答案是：使用 2003 r2 服务器管理包中的打印管理控制台导出打印机配置。也许该功能有一个 API，可以从 .net 调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-18T16:02:53.017

PrinterSetting 对象的序列化问题与 PrintFileName 属性有关。

当您尝试反序列化对象时，此属性必须具有一个值以避免异常。

如果要保存报表查看器的 PrinterSettings

```
Me.ReportViewer.PrinterSettings.PrintFileName = "abc"
My.Settings.PrinterSettings = Me.ReportViewer.PrinterSettings
My.Settings.Save() 
```

让他们回来

```
If My.Settings.PrinterSettings IsNot Nothing Then Me.ReportViewer.PrinterSettings = My.Settings.PrinterSettings 
```

无论如何，保存 PrinterSetting 只会保留“标准”值。如果您想保留每个驱动程序拥有的奇异东西，则必须使用 DEVMODE。

# manual - 您需要哪些软件开发操作手册？

> ID：169697
> 
> 赞同：1
> 
> 时间：2008-10-04T03:48:48.490
> 
> 标签：manual

在阅读了 E-myth Revisited 之后，我意识到我可以做得更好，让我的公司减少对我的依赖......任务完成）。

我需要写一套操作手册来说明在某些情况下该怎么做……

例如：

*   如何进行构建
*   如何编写测试用例
*   如何报告状态
*   如何修复错误
*   如何处理支持问题 A、B、C 等...
*   当你停滞不前时该怎么办
*   停电怎么办（真的，我需要这样做）
*   ETC...

对于软件开发公司，您能想到哪些有用的通用操作手册？如果您知道一些好的、简短的在线版本，请发布它们。我宁愿使用入门手册并根据需要对其进行修改，而不是从头开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T04:08:02.913

维基呢？至少其他人可以开始贡献。
否则他们只会依赖你的手册

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T14:03:31.010

我不同意维基。作为公司的所有者——编写手册或以非常可控的方式委派它是您的责任。人们*应该*依靠你的手册。

说真的，回到问题。适用于您的平台和编程语言的明显标准、编码、SQL 等。您可以在互联网上的任何地方找到这些示例。至于客户支持，您可能应该自己写，您知道您希望如何对待您的客户。至于测试用例，您希望您的开发人员或测试人员对需要​​做什么有专业的了解，但是您可能会指出可接受的最低限度。

当你停滞不前时该怎么办。这就是经理的目的:-)

我认为归结为编写您的业务独有的手册，并试图窃取或借用通用流程的手册。

# debugging - 您发现并修复的最棘手的错误是什么？

> ID：169713
> 
> 赞同：63
> 
> 时间：2008-10-04T04:03:34.670
> 
> 标签：debugging

是什么让我们很难找到？你是怎么追踪到的？

距离不够近，无法关闭，但另请参阅
[https://stackoverflow.com/questions/175854/what-is-the-funniest-bug-youve-ever-experienced](https://stackoverflow.com/questions/175854/what-is-the-funniest-bug-youve-ever-experienced)

* * *

## 回答 #1

> 赞同：200
> 
> 时间：2008-10-11T12:04:53.760

一个 jpeg 解析器，在监控摄像头上运行，每次公司 CEO 进入房间时都会崩溃。

100% 可重现的错误。

我不骗你！

这就是为什么：

对于不太了解 JPEG 压缩的您 - 图像被分解为小块矩阵，然后使用魔法等进行编码。

当 CEO 走进房间时，解析器噎住了，因为他总是有一件带有方形图案的衬衫，这引发了一些特殊情况的对比和块边界算法。

真是经典。

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2008-10-04T05:03:58.463

这件事没有发生在我身上，但一位朋友告诉我这件事。

他必须调试一个很少会崩溃的应用程序。它只会在 9 月 9 日之后的星期三失败。是的，一年中 362 天都很好，一年中的三天它会立即崩溃。

它将日期格式化为“2008 年 9 月 22 日，星期三”，但是缓冲区的一个字符太短了——因此，当您在当月名称最长的一天有一个 2 位数的 DOM 时，它只会导致问题最长的名字。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2008-10-04T04:54:57.903

这需要了解一点 Z-8000 汇编程序，我将在进行时对其进行解释。

我正在研究一个嵌入式系统（在 Z-8000 汇编器中）。公司的另一个部门正在同一个平台上构建不同的系统，并编写了一个函数库，我也在我的项目中使用它。错误是每次我调用一个函数时，程序都会崩溃。我检查了所有输入；他们很好。它必须是图书馆中的一个错误——除了图书馆已经在全国数千个 POS 站点中使用（并且运行良好）。

现在，Z-8000 CPU 有 16 个 16 位寄存器，R0、R1、R2 ...R15，也可以作为 8 个 32 位寄存器寻址，命名为 RR0、RR2、RR4..RR14 等。从头开始，重构了一堆旧库。它非常干净并遵循严格的编程标准。在每个函数开始时，将在函数中使用的每个寄存器都被压入堆栈以保留其值。一切都很整洁——它们很完美。

尽管如此，我研究了该库的汇编程序列表，我注意到该函数有些奇怪——在函数的开头，它有 PUSH RR0 / PUSH RR2，最后有 POP RR2 / POP R0。现在，如果您不遵循这一点，它会在开始时将 4 个值压入堆栈，但最后只删除了其中的 3 个。这是灾难的秘诀。堆栈顶部有一个未知值，需要返回地址。该功能不可能工作。

除了，我可以提醒你，它是有效的。它每天在数千台机器上被调用数千次。它不可能不工作。

经过一段时间的调试（使用 1980 年代中期的工具在嵌入式系统上进行汇编并不容易），它总是会在返回时崩溃，因为错误的值将其发送到随机地址。显然，我必须调试正在运行的应用程序，以找出它没有失败的原因。

好吧，请记住，该库非常擅长保存寄存器中的值，因此，一旦您将值放入寄存器，它就会保留在那里。R1 里面有 0000。调用该函数时，它将始终包含 0000。因此，该错误在堆栈上留下了 0000。因此，当函数返回时，它会跳转到地址 0000，恰好是一个 RET，它将从堆栈中弹出下一个值（正确的返回地址），然后跳转到该地址。数据完美地掩盖了这个错误。

当然，在我的应用程序中，我在 R1 中有不同的值，所以它就崩溃了....

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2008-10-05T06:49:31.900

这是在 Linux 上，但几乎可以在任何操作系统上发生。现在你们中的大多数人可能都熟悉 BSD 套接字 API。我们愉快地年复一年地使用它，它确实有效。

我们正在开发一个可以打开许多套接字的大规模并行应用程序。为了测试它的操作，我们有一个测试团队会打开数百甚至上千个连接进行数据传输。有了最高的通道数，我们的应用程序将开始表现出奇怪的行为。有时它只是崩溃了。另一次我们得到了根本不可能是真的错误（例如，accept() 在随后的调用中返回相同的文件描述符，这当然会导致混乱。）

我们可以在日志文件中看到出现了问题，但很难准确定位。使用 Rational Purify 进行的测试表明没有任何问题。但是出了点问题。我们为此工作了好几天，越来越沮丧。这是一个显示障碍，因为已经协商的测试会在应用程序中造成严重破坏。

由于该错误仅在高负载情况下发生，因此我仔细检查了我们对套接字所做的一切。我们从未在 Purify 中测试过高负载情况，因为在这种内存密集型情况下它是不可行的。

最后（幸运的是）我记得大量的套接字可能是 select() 的问题，它等待套接字上的状态更改（可能读取/可能写入/错误）。果然，我们的应用程序在它到达带有描述符 1025 的套接字的那一刻就开始造成严重破坏。问题是 select() 与位字段参数一起工作。位字段由宏 FD_SET() 和不检查其参数是否有效的朋友填充。

所以每次我们得到超过 1024 个描述符（每个操作系统都有自己的限制，Linux vanilla 内核有 1024 个，实际值定义为 FD_SETSIZE）时，FD_SET 宏会愉快地覆盖其位字段并将垃圾写入内存中的下一个结构。

我用 poll() 替换了所有的 select() 调用，这是一种精心设计的替代神秘 select() 调用的方法，并且高负载情况从此不再是问题。我们很幸运，因为所有套接字处理都在一个框架类中，15 分钟的工作就可以解决问题。如果 select() 调用遍布整个代码，情况会更糟。

得到教训：

*   即使一个 API 函数已有 25 年的历史并且每个人都在使用它，它也可能有你还不知道的黑暗角落

*   API 宏中未经检查的内存写入是 EVIL

*   像 Purify 这样的调试工具无法在所有情况下都提供帮助，尤其是在使用大量内存时

*   如果可能，请始终为您的应用程序提供一个框架。使用它不仅增加了可移植性，而且有助于解决 API 错误

*   许多应用程序使用 select() 而不考虑套接字限制。所以我很确定你可以通过简单地使用许多套接字来导致许多流行软件中的错误。值得庆幸的是，大多数应用程序的套接字永远不会超过 1024 个。

*   操作系统开发人员喜欢将责任推给开发人员，而不是拥有安全的 API。Linux select() 手册页说

> “如果描述符值小于零或大于或等于 FD_SETSIZE（通常至少等于系统支持的最大描述符数），则这些宏的行为是未定义的。”

这是误导。Linux 可以打开超过 1024 个套接字。并且行为是绝对明确的：使用意外的值会破坏应用程序的运行。开发人员并没有使宏对非法值具有弹性，而是简单地覆盖其他结构。FD_SET 在 linux 头文件中作为内联汇编（！）实现，并将评估为单个汇编程序写入指令。任何地方都没有发生最轻微的边界检查。

要测试您自己的应用程序，您可以通过在 main() 之后直接以编程方式打开 FD_SETSIZE 文件或套接字然后运行您的应用程序来人为地增加所使用的描述符数量。

托尔斯滕79

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2008-12-30T00:17:38.547

我的是硬件问题...

以前，我用的是 DEC VaxStation 和 21" CRT 大显示器。我们搬到了新大楼的实验室，在房间的对角安装了两个 VaxStation。通电后，我的显示器像迪斯科一样闪烁（是的，那是 80 年代），但另一台显示器没有。

好吧，换个显示器。另一台显示器（现在连接到我的 VaxStation）闪烁，而我以前的显示器（在房间内移动）没有。

我记得基于 CRT 的显示器容易受到磁场的影响。事实上，它们非常容易受到 60 Hz 交变磁场的影响。我立即怀疑我工作区域中的某些东西正在产生一个 60 赫兹的交变磁场。

起初，我怀疑我的工作区域有什么东西。不幸的是，即使所有其他设备都关闭并拔下电源，显示器仍然闪烁。那时，我开始怀疑大楼里有什么东西。

为了验证这一理论，我们将 VaxStation 及其 85 磅的显示器转换为便携式系统。我们将整个系统放在一个滚动推车上，并将其连接到一根 100 英尺长的橙色结构延长线。计划是将此装置用作便携式场强计，以定位有问题的设备。

滚动显示器完全让我们感到困惑。监视器在房间的一半处闪烁，但在另一侧没有。房间呈正方形，对角有门，监视器在连接门的诊断线的一侧闪烁，而另一侧则没有。房间的四面都被走廊包围着。我们把显示器推到走廊里，闪烁停止了。事实上，我们发现闪烁只发生在房间的一个三角形的一半，其他地方都没有。

经过一段时间的完全混乱后，我记得房间有一个双向天花板照明系统，每扇门都有电灯开关。那一刻，我意识到出了什么问题。

我将显示器移到有问题的房间的一半，然后关掉了天花板灯。闪烁停止了。当我打开灯时，闪烁又恢复了。通过任一电灯开关打开或关闭灯，在房间的一半内打开或关闭闪烁。

问题是有人在给天花板灯接线时偷工减料造成的。在照明电路上连接双向开关时，您在 SPDT 开关触点之间运行一对电线，以及从一个开关上的公共端通过灯连接到另一个开关上的公共端的单根电线。

通常，这些电线捆绑在一起。他们成群结队地离开一个开关盒，跑到头顶的天花板固定装置，然后跑到另一个开关盒。关键思想是将所有载流电线捆绑在一起。

当建筑物布线时，开关和灯之间的单根电线穿过天花板，但在开关之间穿行的电线穿过墙壁。

如果所有的电线都靠近并相互平行，那么一根电线中的电流产生的磁场会被附近电线中相等且相反的电流产生的磁场抵消。不幸的是，灯的实际接线方式意味着房间的一半基本上在一个大的单匝变压器初级内。灯亮时，电流循环流动，可怜的显示器基本上坐在一个大电磁铁里面。

故事的寓意：交流电源线中的火线和中性线彼此相邻是有充分理由的。

现在，我所要做的就是向管理层解释为什么他们必须重新布线新大楼的一部分……

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2008-10-04T04:30:38.907

一个你遇到一些代码的错误，在研究它之后你得出结论，“这不可能工作！” 突然它停止工作了，尽管它以前一直在工作。

* * *

## 回答 #7

> 赞同：28
> 
> 时间：2008-10-04T07:30:16.703

我在工作中帮助构建的产品之一在客户站点上运行了几个月，收集并愉快地将收到的每个事件记录到 SQL Server 数据库中。它运行了大约 6 个月，收集了大约 3500 万条记录。

然后有一天，我们的客户问我们为什么数据库已经将近两周没有更新了。经过进一步调查，我们发现执行插入的数据库连接未能从 ODBC 调用返回。值得庆幸的是，进行录制的线程与其他线程分开，允许除录制线程之外的所有内容继续正常运行近两周！

我们连续数周尝试在除此之外的任何机器上重现该问题。我们永远无法重现该问题。不幸的是，我们的其他几个产品随后以大致相同的方式开始失败，其中没有一个将其数据库线程与其其余功能分开，导致整个应用程序挂起，然后每次它们都必须手动重新启动坠毁。

几周的调查变成了几个月，但我们仍然遇到相同的症状：在我们使用数据库的任何应用程序中都出现了完整的 ODBC 死锁。到了这个时候，我们的产品已经充斥着调试信息和确定哪里出了问题的方法，甚至有些产品会检测到死锁，收集信息，将结果通过电子邮件发送给我们，然后自行重启。

有一天在服务器上工作时，仍在收集应用程序崩溃时的调试信息，试图弄清楚发生了什么，服务器 BSoD 在我身上。当服务器重新上线时，我在 WinDbg 中打开了 minidump 以找出有问题的驱动程序是什么。我得到了文件名并将其追溯到实际文件。在检查了文件中的版本信息后，我发现它是安装在计算机上的 McAfee 防病毒套件的一部分。

我们禁用了防病毒软件，从那以后再也没有出现过问题！！

* * *

## 回答 #8

> 赞同：26
> 
> 时间：2008-10-04T11:11:13.060

我只想指出在这个 google-area time 中可能发生的一个非常常见且令人讨厌的错误：
**代码粘贴和臭名昭著的减号**

那是当您**复制粘贴一些带有[减号](http://en.wikipedia.org/wiki/Plus_and_minus_signs#Character_codes)的代码时，而不是常规的 ASCII 字符 hyphen-minus ('-')**。

![替代文字](https://upload.wikimedia.org/wikipedia/commons/thumb/c/cc/Plus_Minus_Hyphen-minus.svg/180px-Plus_Minus_Hyphen-minus.svg.png)
加号、减号(U+2212)、连字符-减号(U+002D)

现在，即使减号被认为比连字符减号更长，但在某些编辑器（或 DOS shell 窗口）上，根据使用的字符集，它实际上被呈现为常规的“-”连字符减号。

而且...您可以花费数小时试图弄清楚为什么此代码无法编译，逐行删除每一行，直到找到实际原因！

可能不是那里最棘手的错误，但足够令人沮丧；）

（感谢[ShreevatsaR](https://stackoverflow.com/users/4958/shreevatsar)在我原来的帖子中发现了反转 - 见评论）

* * *

## 回答 #9

> 赞同：19
> 
> 时间：2008-10-04T05:22:28.737

首先是我们发布的产品出现了一个bug，但是当我尝试调试这个问题时，它并没有出现。起初我认为这是“发布与调试”的事情——但即使我在发布模式下编译代码，我也无法重现问题。我去看看是否有其他开发人员可以重现该问题。没有。在对程序输出进行大量调查（生成混合的汇编代码/C 代码列表）并逐步检查已发布产品的汇编代码（糟糕！）后，我发现了违规行。但是这条线对我来说看起来很好！然后我不得不查找汇编指令做了什么——果然错误的汇编指令在发布的可执行文件中。然后我检查了我的构建环境生成的可执行文件——它有正确的汇编指令。事实证明，构建机器不知何故损坏了，并且只为这个应用程序的一条指令生成了错误的汇编代码。其他所有东西（包括我们产品的早期版本）都产生了与其他开发人员机器相同的代码。在我向软件经理展示我的研究成果后，我们迅速重新构建了我们的构建机器。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2008-10-06T23:27:30.810

网络应用程序的深处有一行（简化）：

```
if (socket = accept() == 0)
    return false;

//code using the socket() 
```

调用成功时发生了什么？`socket`被设置为 1。`send()`当给定 1 时会做什么？（例如在：

```
send(socket, "mystring", 7); 
```

它打印到`stdout`...这是我在想知道为什么我的所有`printf()`s 都取出后 4 小时后发现的，我的应用程序正在打印到终端窗口，而不是通过网络发送数据。

* * *

## 回答 #11

> 赞同：15
> 
> 时间：2008-10-05T12:40:40.537

在 80 年代的 Data General 小型计算机上使用 FORTRAN，我们遇到了编译器导致常量 1（一）被视为 0（零）的情况。发生这种情况是因为一些旧代码将值 1 的常量传递给将变量声明为 FORTRAN 参数的函数，这意味着它（假设是）不可变的。由于代码中的缺陷，我们对参数变量进行了赋值，编译器兴高采烈地将其用于常量 1 的内存位置中的数据更改为 0。

许多不相关的函数后来我们有代码与文字值 1 进行比较，测试将失败。我记得在调试器中盯着该代码的时间最长。我会打印出变量的值，它会是 1 但测试“if (foo .EQ. 1)”会失败。我花了很长时间才想到让调试器打印出它认为 1 的值是什么。然后花了很多时间来回溯代码以找到常量 1 何时变为 0。

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2008-10-24T19:49:30.793

在测试我最近添加到交易应用程序的一些新功能时，我碰巧注意到显示某种交易类型结果的代码永远无法正常工作。在查看源代码控制系统后，很明显这个 bug 已经存在了至少一年，令我惊讶的是，没有一个交易者发现它。

在困惑了一段时间并与同事核实后，我修复了这个错误并继续测试我的新功能。大约3分钟后，我的电话响了。线路的另一端是一位愤怒的交易员，他抱怨他的一笔交易显示不正确。

经过进一步调查，我意识到交易者遇到了与我在 3 分钟前在代码中注意到的完全相同的错误。这个错误已经存在了一年，只是在等待开发人员出现并发现它，以便它可以真正发生。

这是一种称为[Schroedinbug](http://en.wikipedia.org/wiki/Unusual_software_bug#Schroedinbug)的错误的一个很好的例子。虽然我们大多数人都听说过这些奇特的实体，但当你真正在野外遇到一个实体时，却是一种诡异的感觉。

* * *

## 回答 #13

> 赞同：12
> 
> 时间：2008-10-24T21:14:12.650

This is back when I thought that C++ and digital watches were pretty neat...

I got a reputation for being able to solve difficult memory leaks. Another team had a leak they couldn't track down. They asked me to investigate.

In this case, they were COM objects. In the core of the system was a component that gave out many twisty little COM objects that all looked more or less the same. Each one was handed out to many different clients, each of which was responsible for doing `AddRef()` and `Release()` the same number of times.

There wasn't a way to automatically calculate who had called each `AddRef`, and whether they had `Release`d.

I spent a few days in the debugger, writing down hex addresses on little pieces of paper. My office was covered with them. Finally I found the culprit. The team that asked me for help was very grateful.

The next day I switched to a GC'd language.*

(*Not actually true, but would be a good ending to the story.)

* * *

## 回答 #14

> 赞同：12
> 
> 时间：2008-10-24T22:08:21.840

Sun Microsystems 的 Bryan Cantrill 就他使用他帮助开发的名为 dtrace 的工具追踪到的一个 bug 进行了精彩的 Google 技术讲座。

The [Tech Talk](http://video.google.com/videoplay?docid=-8002801113289007228&ei=T0UCSeL4KJKYrQL2waz7Dw&q=dtrace)很有趣、令人讨厌、内容丰富且令人印象深刻（而且**很长**，大约 78 分钟）。

我不会在这里对这个错误进行任何剧透，但他在 53:00 左右开始揭露罪魁祸首。

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2008-10-07T18:48:45.270

不是很硬，但是当它被发现时我笑了很多。

当我为一家网上商店维护一个 24/7 的订单处理系统时，一位客户抱怨他的订单被“截断”了。他声称，虽然他下的订单实际上包含 N 个仓位，但系统在没有任何警告的情况下接受的仓位要少得多。

在我们通过系统跟踪订单流后，揭示了以下事实。有一个存储过程负责将订单项目存储在数据库中。它接受一个订单项目列表作为字符串，它编码的`(product-id, quantity, price)`三元组列表如下：

> "<12345, 3, 19.99><56452, 1, 8.99><26586, 2, 12.99>"

现在，存储过程的作者太聪明了，无法求助于普通的解析和循环之类的东西。于是他直接将字符串转化为 SQL 多插入语句，用`"<"`with`"insert into ... values ("`和`">"`with替换`");"`。如果他没有将结果字符串存储在 varchar(8000) 变量中，那就太好了！

发生的事情是 his`"insert ...; insert ...;"`在第 8000 个字符处被截断，并且对于那个特定的顺序，剪切“幸运”足以发生在`insert`s 之间，因此*截断的 SQL 在语法上保持正确*。

后来我发现sp的作者是我的老板。

* * *

## 回答 #16

> 赞同：12
> 
> 时间：2008-10-04T04:22:48.390

我在一个主机游戏中遇到了一个错误，只有在你打了一场漫长的 Boss 战后才会出现，然后在 5 次中只有大约 1 次。当它触发时，它会使硬件 100% 卡住，无法与外界交谈一点也不。

这是我遇到过的最害羞的错误；修改、自动化、检测或调试 boss-battle 会隐藏错误（当然我必须运行 10-20 次才能确定错误已隐藏）。

最后，我通过反复阅读代码 2-3 天找到了问题（缓存/DMA/中断竞赛）。

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2008-10-04T15:49:50.813

当客户的宠物兔子兔子咬过以太网电缆时。是的。这不怎么样。

* * *

## 回答 #18

> 赞同：9
> 
> 时间：2008-10-04T13:54:59.173

想到的两个最棘手的错误都在同一类型的软件中，只有一个在基于 Web 的版本中，一个在 Windows 版本中。

本产品是平面图查看器/编辑器。基于 Web 的版本有一个 Flash 前端，可以将数据加载为 SVG。现在，这工作正常，只是有时浏览器会挂起。仅在少数图纸上，并且仅当您将鼠标在图纸上移动一会儿时。我将问题缩小到一个包含 1.5 MB SVG 数据的绘图层。如果我只取数据的一小部分，任何小部分，都不会发生挂起。最终我意识到问题可能是文件中有几个不同的部分共同导致了这个错误。果然，在随机删除图层的部分并测试错误后，我发现了令人讨厌的绘图语句组合。我在 SVG 生成器中编写了一个解决方法，并且在不更改一行操作脚本的情况下修复了该错误。

在 Windows 端的同一产品中，用 Delphi 编写，我们遇到了类似的问题。在这里，产品获取 AutoCAD DXF 文件，将它们导入到内部绘图格式，然后在自定义绘图引擎中渲染它们。这个导入例程不是特别有效（它使用了大量的子字符串复制），但它完成了工作。只有在这种情况下它不是。一个 5 MB 的文件通常在 20 秒内导入，但在一个文件上则需要 20 分钟，因为内存占用膨胀到 1 GB 或更多。起初它看起来像是典型的内存泄漏，但内存泄漏工具报告它干净，手动代码检查也没有发现。这个问题原来是 Delphi 5 的内存分配器中的一个错误。在某些情况下，这个特定文件正在适当地重新创建，它很容易出现严重的内存碎片。系统将继续尝试分配大字符串，并且除了在分配的最高内存块之上之外找不到放置它们的地方。集成新的内存分配库修复了该错误，而无需更改一行导入代码。

回想起来，最棘手的错误似乎是那些修复涉及更改系统的不同部分而不是发生问题的部分的错误。

* * *

## 回答 #19

> 赞同：8
> 
> 时间：2009-05-05T07:03:12.480

这发生在我在电脑商店工作的时候。

有一天，一位顾客来到店里，告诉我们他的全新电脑在晚上和晚上都能正常工作，但在中午或凌晨时根本就不能工作。问题是当时鼠标指针不动。

我们做的第一件事就是给他的鼠标换了一个新的，但问题并没有解决。当然，两只鼠标都可以在商店中正常工作。

经过几次尝试，我们发现问题出在那个特定品牌和型号的鼠标上。客户工作站靠近一个很大的窗户，中午时鼠标处于阳光直射下。它的塑料太薄了，在这种情况下，它变得半透明，阳光阻碍了光机轮的工作：|

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2008-10-04T05:07:58.347

在设备调试器上非常糟糕的平台上有一个错误。如果我们在代码中**添加 printf** ，我们会在设备上**崩溃。**然后它会在与 printf 位置不同的位置崩溃。如果我们移动了 printf，**崩溃会移动或消失**。事实上，如果我们通过重新排序一些简单的语句来更改该代码，那么崩溃将发生在与我们更改的代码无关的地方。

 ****事实证明**，我们平台的重定位器中有一个错误。**重定位器不是零初始化 ZI 部分，而是使用重定位表来初始化值。因此，只要二进制文件中的重定位表发生更改，错误就会移动。所以简单地添加一个 printf 会改变重定位表并在那里解决错误。

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2008-12-12T15:18:09.293

Adam Liss 在上面谈到我们共同参与的项目时的信息，让我想起了我必须处理的一个有趣的错误。实际上，这不是一个错误，但我们会在一分钟内解决这个问题。

如果您还没有看到 Adam 消息，应用程序的执行摘要：销售人员自动化软件......在笔记本电脑上......一天结束时，他们拨号......与 Mother 数据库同步。

一位用户抱怨说，每次他尝试拨号时，应用程序都会崩溃。客户支持人员经历了所有通常通过电话进行的诊断技巧，但他们一无所获。因此，他们不得不让步：让用户 FedEx 将笔记本电脑送到我们的办公室。（这是一个非常大的问题，因为每台笔记本电脑的本地数据库都是为用户定制的，所以必须准备一台新的笔记本电脑，运送给用户让他在我们处理他原来的笔记本电脑时使用，然后我们不得不换回来和让他最终在第一台原装笔记本电脑上同步数据）。

因此，当笔记本电脑到货时，它被交给我来解决问题。现在，同步涉及将电话线连接到内部调制解调器，进入我们应用程序的“通信”页面，并从下拉列表中选择一个电话号码（预先选择最后使用的号码）。DDL中的数字是自定义的一部分，基本上是办公室号码，办公室号码前缀为“+1”，办公室号码前缀为“9，，”，以防万一从酒店等打电话

所以，我点击“COMM”图标，然后按回车键。它拨入，连接到调制解调器——然后立即崩溃。我又累了几次。100% 可重复性。

因此，a 在笔记本电脑和电话线之间连接了一个数据范围，并查看了线路上的数据。它看起来很奇怪......最奇怪的是我可以阅读它！

用户显然想使用他的笔记本电脑拨入本地 BBS 系统，因此，更改应用程序的配置以使用 BBS 的电话号码而不是公司的电话号码。我们的应用程序期待我们专有的二进制协议——而不是长的 ASCII 文本流。缓冲区溢出——KaBoom！

更换电话号码后立即出现拨号问题，这可能会给普通用户一个线索，认为这是问题的*原因*，但这个家伙从来没有提到过。

我修复了电话号码，并将其发送回支持团队，并附上一张便条，将这个人选为“本周 Bonehead 用户”。(*)

* * *

(*) OkOkOk... 很有可能实际发生的事情是那个家伙的孩子，每天晚上看到他父亲拨入，认为这也是你拨入 BBS 的方式，并在他一个人在家的某个时候更改了电话号码与笔记本电脑。当它崩溃时，他不想承认自己碰过笔记本电脑，更别说摔坏了；所以他只是把它收起来，没有告诉任何人。

* * *

## 回答 #22

> 赞同：7
> 
> 时间：2008-10-04T05:05:42.687

我的团队继承了一个基于 CGI 的多线程 C++ Web 应用程序。主要平台是Windows；一个遥远的次要平台是带有 Posix 线程的 Solaris。出于某种原因，Solaris 的稳定性是一场灾难。我们有各种各样的人在一年多的时间里断断续续地研究这个问题（大部分时间都是断断续续的），而我们的销售人员则成功地推出了 Windows 版本。

症状是可悲的稳定性：大范围的系统崩溃，几乎没有押韵或原因。该应用程序同时使用了 Corba 和本土协议。一位开发人员甚至将整个 Corba 子系统作为绝望的措施移除：运气不好。

最后，一位资深的原创开发人员大声地想知道一个想法。我们对其进行了研究，最终发现了问题：在 Solaris 上，有一个编译时（或运行时？）参数来调整可执行文件的堆栈大小。它设置不正确：太小了。因此，该应用程序的堆栈已用完，并且打印的堆栈跟踪完全是红鲱鱼。

这是一场真正的噩梦。

得到教训：

*   头脑风暴，头脑风暴，头脑风暴
*   如果某些东西在不同的、被忽视的平台上变得疯狂，它可能是环境平台的一个属性
*   谨防离开团队的开发人员转移的问题。如果可能，请以个人名义联系以前的人以获取信息和背景。乞求，恳求，做交易。必须不惜一切代价尽量减少经验损失。

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2009-06-06T20:44:12.780

那是在我的毕业论文期间。我正在编写一个程序来模拟高强度激光对使用 FORTRAN 的氦原子的影响。

一次测试运行是这样的：

*   使用程序 1 计算初始量子态，大约需要 2 小时。
*   对第一步的数据运行主要模拟，对于最简单的情况，大约需要 20 到 50 小时。
*   然后使用第三个程序分析输出以获得有意义的值，如能量、托克、动量

这些总体上应该是恒定的，但事实并非如此。他们做了各种奇怪的事情。

经过两周的调试后，我开始疯狂地记录日志，并记录了模拟的每一步中的每个变量，包括常量。

这样我发现我写了一个数组的末尾，它**改变了一个常量**！

一位朋友说他曾经把字面的 2 改成这样的错误。

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2008-10-04T13:28:26.247

我的第一个多线程程序出现死锁！

很难找到它，因为它发生在线程池中。有时池中的一个线程会死锁，但其他线程仍然可以工作。由于池的大小远远大于所需，因此需要一两个星期才能注意到第一个症状：应用程序完全挂起。

* * *

## 回答 #25

> 赞同：5
> 
> 时间：2008-10-28T00:51:00.953

我的第一份“真正”工作是在一家编写客户端-服务器销售自动化软件的公司工作。我们的客户在他们（15 磅）的笔记本电脑上运行客户端应用程序，并在一天结束时拨入我们的 unix 服务器以与 Mother 数据库同步。经过一系列投诉后，我们发现在身份验证过程中，一开始就出现了天文数字的呼叫量下降。

经过数周的调试，我们发现，如果传入呼叫由服务器上的 getty 进程应答，该进程 ID 包含偶数，后跟 9。原来，身份验证是一个自制方案，它依赖*于*PID的8个字符的字符串表示；一个错误导致有问题的 PID 使 getty 崩溃，并以新的 PID 重生。第二次或第三次呼叫通常会找到可接受的 PID，并且自动重拨使客户无需干预，因此直到月底电话账单到达时才被认为是一个重大问题。

“修复”（咳咳）是将 PID 转换为以*八进制*而不是十进制表示其值的字符串，这样就不可能包含 9 并且没有必要解决潜在的问题。

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2008-12-12T15:58:01.100

基本上，任何涉及线程的东西。

我曾经在一家公司担任过一个职位，在这家公司中，我有一个可疑的区别，即我是唯一一个对线程调试非常满意的人之一，可以调试令人讨厌的问题。惊恐的事件。在被允许编写线程代码之前，您应该获得某种认证。

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2008-10-05T08:53:23.960

我花了几个小时到几天的时间来调试一些事情，这些事情最终只需要几个字符就可以解决。

一些不同的例子：

1.  当流中的裁剪值实际上完全有效时，ffmpeg 有一个讨厌的习惯，即产生关于“brainfart 裁剪”的警告（指的是流内裁剪值> = 16 的情况）。我通过添加三个字符来修复它：“h->”。

2.  x264 有一个错误，在极其罕见的情况下（百万分之一），如果使用某些选项，它会产生一个完全错误颜色的随机块。我通过在代码中的两个位置添加字母“O”来修复该错误。原来我在之前的提交中拼错了#define 的名称。

* * *

## 回答 #28

> 赞同：5
> 
> 时间：2009-05-13T20:24:53.377

我在高中时听说过一个经典的错误；只有坐在它前面的椅子上才能登录的终端。（如果你站着，它会拒绝你的密码。）

对于大多数人来说，它的复制非常可靠。你可以坐在椅子上，登录，退出……但如果你站起来，你每次都被拒绝。

最终结果发现，有些混蛋在键盘上交换了几个相邻的键，E/R 和 C/V IIRC，当你坐下时，你触摸输入并进入，但当你站起来时，你必须打猎' n peck，所以您查看了不正确的标签并失败了。

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2008-10-04T04:08:33.397

虽然我不记得具体的实例，但最棘手的类别是那些仅在系统运行数小时或数天后才会出现的错误，并且当它出现故障时，几乎没有或根本没有留下导致崩溃的原因的痕迹。让他们特别糟糕的是，无论您认为自己已经推理出原因并应用适当的修复来补救它，您都必须再等几个小时或几天才能完全相信您'已经真正钉了它。

* * *

## 回答 #30

> 赞同：4
> 
> 时间：2008-10-04T04:52:54.133

我们的网络接口，一个支持 DMA 的 ATM 卡，偶尔会在接收到的数据包中传递损坏的数据。当数据包从线路进入时，AAL5 CRC 已检查为正确，但 DMAd 到内存的数据将不正确。TCP 校验和通常会捕捉到它，但在 ATM 的鼎盛时期，人们热衷于直接在 AAL5 上运行本机应用程序，完全放弃 TCP/IP。我们最终注意到，损坏只发生在供应商工作站的某些型号上（将保持匿名），而不是其他型号。

通过计算驱动程序软件中的 CRC，我们能够检测到损坏的数据包，但代价是巨大的性能损失。在尝试调试时，我们注意到如果我们只是将数据包存储一段时间然后再返回查看，数据损坏会神奇地自行修复。数据包内容会很好，如果驱动程序第二次计算 CRC，它将检查正常。

我们在出货 CPU 的数据缓存中发现了一个错误。此处理器中的缓存与 DMA 不一致，需要软件在适当的时间显式刷新它。错误是有时缓存在被告知这样做时实际上并没有刷新其内容。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2009-05-13T21:44:01.220

我在一所大型社区大学工作，去年我们从 Blackboard 转到 Moodle。Moodle 使用“课程”和“小组”的命名法。例如，一门课程可能是微观经济学 ECO-150，而小组就是我们所说的部分（例如 OL1、OL2、01、14、W09）。

反正我们是原始人。我们甚至没有 LDAP。一切都是文本文件、excel 电子表格和*GD* microsoft Access 数据库。我的工作是创建一个 Web 应用程序，将上述所有内容作为输入，并生成比上传到 Moodle 中更多的文本文件，以创建课程、课程和用户中的组，并将用户放入课程和组中。整个设置完全是拜占庭式的，大约有 17 个单独的步骤必须按顺序完成。但是这个东西有效并取代了以前在学期最繁忙时间花费数天的过程。

但是有一个问题。有时我们会得到我所谓的“Crazy Groups”。因此，与其创建一个包含 4 组每组 20 名学生的课程，不如创建一个包含 80 组每组 1 名学生的课程。最糟糕的是，一旦创建组，就无法以编程方式进入 cpanel（我无权访问）以删除组。这是一个手动过程，大约需要单击 5 次按钮。因此，每次创建带有 Crazy Groups 的课程时，我要么必须删除该课程，如果老师已经开始将内容放入课程中，这是可取的但不是一个选项，或者我必须花一个小时重复地遵循相同的模式：选择组、显示组、编辑组、删除组，确定要删除组吗？是的，看在上帝的份上！

除非您手动打开每门课程并查看（有数百门课程）或直到您收到投诉，否则无法知道是否发生了疯狂的团体。Crazy Groups*似乎*是随机发生的，Google 和 Moodle 论坛都没有帮助，似乎其他人都使用这种称为 LDAP 或 REAL 数据库的东西，所以他们从未遇到过这个问题。

最后，在我不知道有多少调查和删除疯狂组的时间比我想承认的要多之后，我想通了。这是 Moodle 中的一个错误，而不是我的代码！这给了我不小的快感。您会看到创建组的方法只是尝试将某人注册到组中，如果该组尚不存在，则 Moodle 会创建它。这对于名为 OL1 或 W12 甚至是 SugarCandyMountain 的组来说工作得很好，但是如果你试图创建一个以数字作为名称的组，比如 01 或 14，那么就会出现疯狂的组。Moodle 不能正确地将数字作为字符串进行比较。无论课程中有多少个名为 01 的组，它总是会认为该组还不存在，因此会创建它。这就是你最终得到 80 个组，每个组 1 人的方式。

我为我的发现感到自豪，我去了 Moodle 论坛，并发布了我的发现，并附上了随意重现问题的步骤。那是大约一年前，据我所知，Moodle 内部仍然存在问题，似乎没有人有动力去解决它，因为除了我们原语之外，没有人使用文本文件注册。我的解决方案只是确保我们所有的组名至少包含 1 个非数字字符。至少对我们来说，疯狂的团体已经永远消失了，但我觉得那个在外蒙古社区大学工作的人，他刚刚上传了一个学期的课程，即将觉醒。至少这一次谷歌可能会帮助他，因为我已经在网络空间的浪潮中给他写了这条信息。

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2009-05-13T22:20:59.723

在普渡大学的 CS435 中，我们必须为最终项目编写光线追踪器。我制作的所有东西都带有强烈的橙色色调，但我可以看到场景中的每一个物体。我最终放弃并按原样提交，并让教授查看我的代码以找到错误，当他找不到时，我花了整个夏天的大部分时间来挖掘到底出了什么问题。

深埋在代码中，作为颜色计算函数的一部分，我终于意识到我正在划分一个 int 并将它传递给一个期望浮点值的 OpenGL 函数。其中一个颜色分量在整个场景的大部分时间里都足够低，以至于它会向下舍入为 0，从而导致橙色调。仅在一个地方（在除法之前）将其转换为浮点数修复了该错误。

始终检查您的输入和预期类型。

* * *

## 回答 #33

> 赞同：3
> 
> 时间：2008-10-11T11:56:53.980

曾经设计了一个实时多线程（颤抖）系统，该系统从多个网络监控摄像头轮询图像并对图像进行各种魔术。

该错误只是使系统崩溃，当然某些关键部分受到了虐待。我不知道如何直接触发故障，但不得不等待它发生，这大约是三四天一次（几率：在 30 fps 上大约 15000000 分之一）。

我必须准备好我能做的一切，调试污染代码的输出消息、跟踪工具、相机上的远程调试工具等等。然后我只需要等待两三天，并希望获得所有信息以定位失败的互斥锁或其他任何东西。在我追查到它之前花了四次这样的运行，四个星期！再跑一次，我就会打破客户的最后期限..

* * *

## 回答 #34

> 赞同：3
> 
> 时间：2008-12-29T23:09:14.630

由于灵感的闪现，这并没有花费太长时间来追踪，但仍然有点奇怪。小型应用程序，仅供 IT 部门的其他人使用。它依次连接到域中的所有台式 PC。许多被关闭并且连接需要AGES超时，所以它在线程池上运行。它只是扫描 AD 并将数千个工作项排队到线程池中。一切正常。几年后，我与另一位实际使用此应用程序的员工交谈，他提到它使 PC 无法使用。当它运行时，尝试打开网页或浏览网络驱动器需要几分钟，或者根本不会发生。
问题原来是 XP 的半开 tcp 限制。最初的 PC 是双处理器，因此 .NET 为池分配了 50 个（或 100 个，不确定）线程，没问题。现在我们有了双处理器双核，线程池中的线程比半开连接的线程多，因此在应用程序运行时其他网络活动变得不可能。

它现在已修复，它会在尝试连接机器之前 ping 机器，因此超时时间要短得多，并使用少量固定数量的线程来完成实际工作。

* * *

## 回答 #35

> 赞同：3
> 
> 时间：2008-10-05T12:05:59.920

那是一次访问冲突崩溃。
从故障转储中，我只能找出调用堆栈上的一个参数已损坏。
原因[是这段代码](http://www.google.com/codesearch?as_q=%22n+%3D+strlen%28p-%3Es%29+-+1%3B%22&btnG=Search+Code&hl=en&as_lang=&as_license_restrict=i&as_license=&as_package=&as_filename=&as_case=)：

```
n = strlen(p->s) - 1;
if (p->s[n] == '\n')
   p->s[n] = '\0'; 
```

如果字符串长度为 0，并且上面堆栈上的参数恰好位于地址 0x0Axxxxxxx
==>**堆栈损坏**
幸运的是，这段代码离实际崩溃位置足够近，所以浏览（丑陋的）源代码是找到的方法罪魁祸首

* * *

## 回答 #36

> 赞同：3
> 
> 时间：2008-10-04T04:32:34.893

我必须修复的最棘手的错误是我自己提出的——我作为一家大型电信公司的测试员签约，测试另一家公司的产品。几年后，我与另一家公司签订了合同，他们给我的第一件事就是我自己提出的错误。

这是用 6809 汇编器和 BCPL 编写的嵌入式操作系统中的内核竞争条件。调试环境由一个特殊的 printf 组成，它写入串行设备；在这个设置中没有花哨的 IDE 东西。

花了相当长的时间来修复，但当我终于把它弄明白时，这是一个巨大的满足感。

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2008-10-04T04:11:54.263

在调试中运行的多线程应用程序很好，但是一旦在发布中运行它就会出错，因为时间略有不同。即使将 Console.WriteLine 调用添加到产品基本调试输出，也会导致时间发生足够的变化以使其正常工作并且不会显示问题。一周工具来查找和修复几行需要更改的代码。

* * *

## 回答 #38

> 赞同：2
> 
> 时间：2008-10-08T19:05:45.610

就在互联网流行之前，我们正在开发基于调制解调器的家庭银行应用程序（北美第一款）。

发布前三天，我们（几乎）按计划进行，并计划利用剩余时间对系统进行详尽的测试。我们有一个测试计划，接下来是调制解调器通信。

就在那时，我们的客户急于想要在最后一刻升级功能。当然，我完全反对这一点，但我被否决了。我们加了愚蠢的东西，熬夜了三天，并在发布日期前让它工作。我们赶上了最后期限，向客户交付了 2000 多张软盘。

发布后的第二天，我回到了我的测试计划，继续测试调制解调器通信模块。令我惊讶的是，我发现调制解调器会随机连接失败。就在那时，我们的电话开始响起，愤怒的客户无法使用他们的应用程序。

经过一番咬牙切齿的拉扯，我将问题追溯到串口初始化。一位初级程序员注释掉了对其中一个控制寄存器的写入。寄存器保持未初始化状态，它包含无效值的可能性约为 10%——这取决于用户的配置，以及他事先运行的应用程序。

当被问及此事时，程序员声称它可以在他的机器上运行。

所以我们不得不重新烧掉那 2000 多张软盘，并追踪每一位客户以召回它们。这不是一件有趣的事情，尤其是对于一个已经筋疲力尽的团队。

我们在那个方面受到了很大的打击。我们的客户声称，因为这是我们的错误，我们应该承担召回的成本。我们下一个版本的时间表被推迟了一个月。我们与客户的关系也受到损害。

如今，我在最后一刻添加功能的灵活性要低得多，我试图与我的团队更好地沟通。

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2009-05-05T08:35:54.003

在我正在开发的游戏中，某个特定的精灵在发布模式下将不再显示，但在调试模式下工作正常，并且仅在一个特定版本中。另一个程序员花了 2 天时间试图找到这个 bug，然后就去度假了。在发布前约 5 小时试图找到错误最终落在了我的肩上。

由于调试版本有效，我不得不使用发布版本进行调试。Visual Studio 支持发布版本中的一些调试，但您不能依赖调试器告诉您正确的所有内容（尤其是我们使用的积极优化设置）。因此，我不得不逐步完成一半代码列表和一半汇编程序列表，有时直接在十六进制转储中查看对象，而不是在格式良好的调试器视图中查看对象。

在确保所有正确的绘制调用都进行了一段时间后，我发现精灵的材质颜色不正确——它应该是完全不透明的橙色，但被设置为黑色并且完全透明。颜色是从位于我们的 EditionManager 类的 const 数组中的调色板中获取的。它最初被设置为正确的橙色，但是当从精灵绘图代码中检索到实际颜色时，它又是透明的黑色。我设置了一个内存断点，它是在 EditionManager 构造函数中触发的。对不同数组的写入导致调色板数组中的值发生更改。

事实证明，另一位程序员更改了系统的一个基本枚举：

```
enum {
    EDITION_A = 0,
    EDITION_B,
    //EDITION_DEMO,
    EDITION_MAX,

    EDITION_DEMO,
}; 
```

他紧跟`EDITION_DEMO`在 之后`EDITION_MAX`，并且正在写入的数组被索引，`EDITION_DEMO`因此它溢出到调色板并在那里设置了错误的值。但是，我无法将枚举改回来，因为版本号无法再更改（它们被用于二进制传输）。因此，我最终`EDITION_REAL_MAX`在枚举中创建了一个条目并将其用作数组大小。

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2008-10-04T15:31:19.087

不是我的一个，而是以前工作的一位同事花了 3 天时间调试他的 JavaScript 弹出编辑器控件（这是很久以前的事了，在框架的乐趣之前），却发现它在中途缺少一个分号其巨大的核心文件之一。

我们称它为“世界上最昂贵的分号”，但我敢肯定，历史上的情况要糟糕得多！

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2009-05-13T21:50:52.597

如果安装应用程序的目录路径不包含至少一个空格，并且 XPO 检查的数据字典不是 100% 正确大小写在数据库。

[此处](https://stackoverflow.com/questions/239622/application-crashing-when-talking-to-oracle-unless-executable-path-contains-space)描述的问题。

我可以告诉你：当我们想出如何规避这个问题时，我是这样 >< 几乎要哭了。我仍然不知道问题的真正原因是什么，但我们的产品在未来的版本中不会支持 Oracle，所以我实际上不再提供......

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2009-05-13T22:05:25.147

I had a bug with a custom synchronization program once. It used the date/time stamp of files/folders to compare what was modified to synchronize data from a flash key to a network share in windows, with some extra integrity and business logic built in it.

One day, an operator reported that his sync was taking forever...after reviewing the logs, for some reason, the software thought every file on the stick (or the server) was 3 hours older than it should be, refreshing all 8 gigs of data! I was using UTC, how the heck could this be?

It turns out, this particular operator did indeed set his time zone to Pacific time instead of Eastern, causing the problem, but it shouldn't have, because all the code was using UTC - good god what could it be?! It worked when testing it on my local system...what gives?

At this point, we requested all operators ensure that their laptops were set to eastern time before they synced, and the bug stayed in the queue until we had more time to investigate.

Then, October came around and BOOM! Daylight savings time! What the heck!? Now everyone was complaining syncing was taking forever! Had to be fixed, and fast!

I tracked it down by modifying the test case to run off a stick instead of off my local hard drive, and sure enough, it failed...phew, must a a memory stick thing - wait a sec, is it formatted FAT32... AH HA! FAT32 uses localtime when recording the timestamp of a file!

[http://msdn.microsoft.com/en-us/library/ms724290(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms724290(VS.85).aspx)

So, the software was rewritten so that when writing to FAT32 media, we programatically set it to UTC...

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2008-10-28T20:24:21.257

有一个代码通过将当前年份加 1 并保持日期和月份相同，将某些到期日期设置为当前日期加上一年。这在 2008 年 2 月 29 日失败了，因为数据库拒绝接受 2009 年 2 月 29 日！

不知道这是否符合“强硬”的条件，但这是一个奇怪的代码，当然会立即重写！

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2009-06-24T20:43:06.873

当程序员输出到日志“一般错误！”时，最棘手的错误必须是。看了一遍代码，到处都是“General Error！”的文字。试着把那个钉下来。

至少编写一个宏来输出 __LINE__ 或 __FUNCTION__ 对于添加到调试输出会更有帮助。

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2009-06-24T20:53:49.783

Oracle 的 OracleDecimal 类的 ToString 方法（它 P/Invokes 相同功能的本机版本）和由缺少 GC.KeepAlive 调用引起的垃圾收集器之间的竞争，这可能导致 OracleDecimal.ToString() 如果其堆空间返回基本上是任意垃圾恰好在通话结束之前被覆盖。

我写了一份详细的错误报告，但从未收到回音，据我所知，这仍然存在。我什至有一个测试工具，它只创建数字 1 的新 OracleDecimal 表示，在它们上调用 ToString，并将结果与​​“1”进行比较。它每隔 1000 万次左右就会因疯狂的胡言乱语（巨大的数字、负数，甚至是字母数字的垃圾字符串）而失败。

小心你的 P/Invoke 调用！.NET 垃圾收集器收集您的实例是合法的，而对该实例的实例方法的调用仍处于挂起状态，只要该实例方法已完成使用`this`引用。

[反射器](http://www.red-gate.com/products/reflector/)是这类东西的绝对救星。

* * *

## 回答 #46

> 赞同：1
> 
> 时间：2008-10-28T20:44:10.920

当我刚开始在我工作的公司时，我做了很多心肺复苏术来学习产品。

这种用 HC11 汇编编写的嵌入式产品具有每八小时发生一次的功能。结果是在检查计数器的代码期间触发了递减值的中断。在代码周围打了一些 CLI/STI，这很好。我通过让事件每秒发生两次而不是每八小时发生一次来追踪它。

我从中学到的教训是，当调试不经常失败的代码时，我应该首先检查中断使用的变量。

* * *

## 回答 #47

> 赞同：1
> 
> 时间：2008-10-04T04:20:04.183

不确定这是最难的，但几年前我有一个 Java 程序`XMLEncoder`用来保存/加载特定的类。由于某种原因，该课程无法正常工作。我对错误进行了简单的二进制搜索，发现错误发生在一个函数调用之后但在另一个调用之前，这应该是不可能的。2 小时后，我还没有弄清楚，尽管在我休息（并离开）的那一刻，我意识到了问题所在。事实证明，这`XMLEncoder`是创建类的默认构造实例，而不是让类和对类的引用都引用同一个对象。因此，虽然我认为这两个函数调用都在特定类的同一实例的成员上，但其中一个实际上是在默认构造的副本上。

很难找到，因为我*知道*它们都是对同一类的引用。

* * *

## 回答 #48

> 赞同：1
> 
> 时间：2008-10-04T04:41:51.597

很久以前，我使用 C 和（基于字符的）表单库编写了一种面向对象的语言；每个表单都是一个对象，表单可以包含子表单，等等。使用它编写的复杂发票应用程序可以正常运行大约 20 分钟，然后屏幕上不时出现随机乱码。使用该应用程序几分钟后，机器会重新启动、挂起或发生剧烈变化。

事实证明，这是由于消息处理引擎中的错误委托而导致的错误释放；当我们用完超类时，错误路由的消息被委派到包含树上，有时父对象会有同名的方法，因此它看起来大部分时间都可以工作。其余时间它会在错误的上下文中释放一个小缓冲区（大约 8 个字节）。被错误释放的指针实际上是中间计数器用于另一个操作的死内存，因此它的值在一段时间后趋于收敛于零。

是的，坏指针会在到达零页的途中穿过屏幕的内存映射区域，最终覆盖了一个中断向量并杀死了 PC

这是在现代调试工具之前的方式，所以弄清楚发生了什么需要几个星期......

* * *

## 回答 #49

> 赞同：1
> 
> 时间：2008-10-08T19:09:25.540

这有点离题（这就是我将其设为社区的原因）。

但是Ellen Ullman[的 The Bug](https://rads.stackoverflow.com/amzn/click/com/1400032350)是一本关于这个主题的精彩的虚构书籍。

* * *

## 回答 #50

> 赞同：1
> 
> 时间：2009-07-04T23:53:57.497

我修复过的最棘手的错误实际上是在我职业生涯的早期出现的。我正在为一个发电站开发一个实时系统，该系统使用一对具有共享内存的 GEC 2050 计算机。

2050 RTOS 有一个主调度表，其中每个进程包含一个插槽，其内容是用于非活动进程的 add 1,X 指令或用于可执行进程的跳转。在 X 设置为零的情况下执行此表意味着第一个可运行的进程会自动进入，其中 X 寄存器是进程号。设计这个的人明显觉得自己很聪明！

2050 架构还具有一个安全功能，即无法识别的操作码总是会导致停止。由于 2050 具有完整的前面板，因此您可以使用它来尝试找出崩溃的原因。由于 X 寄存器始终保存当前进程 ID，因此这通常相当简单。

没有内存分段或保护，因此进程完全有可能破坏当前内存中的任何其他进程或系统区域中的任何内容。

到目前为止，对于那个时代（70 年代后期）如此一致。

由于这个特定系统在两个 CPU 之间共享内存，因此系统配置将系统表放在共享内存中，以允许一个 CPU 启动和停止另一个 CPU 中的进程，而无需通过任何 namby pamby 安全接口。

不幸的是，这也允许一个 CPU 的狂野进程破坏另一个 CPU 的表，因此一个 CPU 可以愉快地使另一个 CPU 崩溃。如果发生这种情况，那么在崩溃的 CPU 中运行的内容与实际故障完全没有关系。与此同时，另一个 CPU 很高兴地继续运行，所以无法判断它是否导致了问题。

不用说，这提供了一些难以解决的问题！

经过一番折腾后，我最终为 O/S 编写了一个相当大的补丁，该补丁在另一个 CPU 的调度程序表中查找损坏并使其运行的 CPU 崩溃。这与常规中断挂钩，因此虽然没有完全同步，但至少它有很好的机会捕捉到有问题的进程。

这帮助我解决了相当多的相互 CPU 问题......

* * *

## 回答 #51

> 赞同：1
> 
> 时间：2009-05-14T11:31:47.910

Java 服务器应用程序中的死锁。但不是两个线程的简单死锁。我找到了一个涉及八个线程的死锁。线程 1 等待线程 2 等待线程 3 等，最后线程 8 等待线程 1。

我花了大约一整天的时间来理解发生了什么，然后只用了 15 分钟来修复它。我使用 eclipse 监控大约 40 个线程，直到我发现死锁。

* * *

## 回答 #52

> 赞同：1
> 
> 时间：2009-06-24T21:07:28.337

在 Python 中，我有一个线程在做这样的事情：

```
while True:
    with some_mutex:
        ...
        clock.tick(60) 
```

`clock.tick(60)`暂停线程，使其每秒运行不超过 60 次。问题是大多数时候程序只是显示黑屏。如果我让它运行一段时间，它终于显示了游戏画面。

这是因为线程*在维护 mutex 时*正在暂停。因此它很少让其他线程获取互斥锁。这里可能看起来很明显，但我花了两天时间才弄清楚。解决方案是简单地删除缩进级别：

```
while True:
    with some_mutex:
        ...

    clock.tick(60) 
```

* * *

## 回答 #53

> 赞同：1
> 
> 时间：2009-06-24T22:01:33.907

可能看起来很有趣，但是当我学习时，我花了整个下午试图弄清楚为什么我使用 = 而不是 == 的 if 语句总是评估为真：我在另一台计算机上将所有内容重写了两次 :)

* * *

## 回答 #54

> 赞同：1
> 
> 时间：2009-06-24T23:24:20.463

当一个特定用户访问某个库存功能时，基于旧数据库的应用程序（只有部分源可用）崩溃。它适用于所有其他用户。用户资料对吗？没有。当以不同用户身份（甚至以管理员身份）登录时，同一用户遇到了同样的问题。

电脑问题？没有。相同的用户，不同的 PC（在她的登录名或任何其他登录名下）仍然崩溃。

问题：登录程序时显示版权闪屏，可以通过单击“X”关闭窗口或按任意键关闭。登录时，此用户始终单击其他用户始终按下键的“X”。这导致了内存泄漏，但仅在访问库存查找时才引起。

修复：不要点击 X。

* * *

## 回答 #55

> 赞同：1
> 
> 时间：2010-01-02T08:27:56.833

我目前正在上大学，我遇到的最困难的错误来自那里的编程课。在前两个学期，我们只是简单地编写了所有自己的代码。但是到了第三学期，教授和助教写了一半的代码，我们写了另一半。这是为了帮助我们学习阅读代码。

我们那个学期的第一个任务是编写一个模拟 DNA 基因分裂的程序。基本上，我们只需要在较大的字符串中找到一个子字符串并处理结果。显然，教授和助教在那一周都很忙，他们给了我们他们一半的代码，还没有完成他们自己的完整实现。他们没有时间写另一半来作为解决方案。他们的一半可以编译，但是如果没有完整的解决方案编码，他们就没有办法对其进行测试。 **我们被告知不要更改教授代码**。班上的每个人都有完全相同的错误，但我们仍然认为我们都犯了同样的错误。

该程序正在吞噬千兆字节的内存，然后用完并崩溃。我们（学生）都假设我们的一半代码中一定有一些模糊的内存泄漏。班上的每个人都花了两个星期的时间搜索代码，并一遍又一遍地通过调试器运行它。我们的输入文件是一个 5.7 MB 的字符串，我们在其中找到了数百个子字符串并将它们存储起来。教授/助教的代码使用了这个。

```
myString = myString.substr(0,pos); 
```

看到问题了吗？当您将字符串变量分配给它自己的子字符串时，不会重新分配内存。这是没有人（甚至教授或助教）不知道的信息。因此 myString 分配了 5.7 MB 的内存，仅用于保存几个字节的实际数据。这重复了数百次；因此大量的内存使用。我花了两个星期来解决这个问题。我花了第一周检查自己的代码是否存在内存泄漏。在我的挫折中，我终于得出结论，教授/助教的那一半肯定有泄漏，所以我花了第二周检查他们的代码。但即便如此，我还是花了很长时间才找到，因为这在技术上并不是泄漏。当我们的输入数据只有十几个千字节时，所有分配最终都被释放并且程序运行良好。我发现它的唯一原因是因为我发疯了，并决定分析每一个最后的变量；即使是临时丢弃的东西。我还花了很多时间检查字符串实际有多少个字符，而不是分配了多少。我认为字符串类正在处理这个问题。这是解决方案，一个解决了数周挫败感的单行更改并为我在查找/修复教师代码的作业中赢得了 A。

```
myString.substr(0,pos).swap(myString); 
```

swap 方法确实会强制重新分配。

* * *

## 回答 #56

> 赞同：1
> 
> 时间：2009-06-24T23:09:03.210

一个盒子在一个大客户的站点上崩溃了，我们不得不通过 WebX 会话连接到一个 IT 人员的计算机，该计算机连接到我们的盒子。我闲逛了大约一个小时，抓取堆栈跟踪、寄存器转储、统计信息、计数器和似乎相关的内存转储部分。

然后，他们的 IT 人员通过电子邮件将我的会议记录通过电子邮件发送给我，我开始工作。

几个小时后，我将其追溯到包含数据包元数据和数据包数据的结构数组。数据包的元数据之一已损坏，看起来它已被几个字节的数据包数据覆盖。Bugzilla 没有任何类似的记录。

深入研究代码，我检查了所有明显的东西。将数据包数据复制到缓冲区的代码对不超出其界限非常谨慎：缓冲区是接口的 MTU 大小，并且复制例程检查数据没有超过 MTU 大小。我的内存转储允许我验证，是的，当崩溃发生时 foo->bar 确实是 4。什么都没加。没有什么是错误的，应该是导致问题的方式。下一个标头中有看起来像 16 字节的数据包数据。

几天后，我开始检查所有我能想到的东西。

我注意到数据缓冲区的长度实际上是正确的。也就是说，从数据开始到数据结束的字节数是一个 MTU，即使下一个报头从 MTU-16 开始。

当这些结构被 malloc'd 时，指向每个元素的指针被放置在一个数组中，并且我已经转储了该数组。我开始测量这些指针之间的距离。6888... 6888... 6888... 6872... 6904... 6880... 6880...

等等，什么？

我开始查看两种结构中的内部指针和偏移量。一切都加起来了。它看起来就像我的一个糟糕的结构 - 一个被部分破坏的结构 - 在内存中太快了 16 个字节。

分配例程 malloc 将这些家伙作为一个块，然后将它们分割成一个循环：

```
 for (i = 0; i < NUM_ELEMS; i++) {
      array[i] = &head[i*sizeof(foo)];
   } 
```

（有对齐的余量等）。

当数组被填充时，我的损坏指针的值必须被读取为 0x8a112 **8** ac 而不是 0x8a112 **9** ac。

我得出的结论是，我在分配过程中成为 1 位内存错误的受害者（我知道，我知道！我也不相信，但我们之前在这个硬件上见过它们——NULL 值读为 0x00800000）。无论如何，我设法让我的老板和同事相信没有其他合理的解释，而且我的解释准确地解释了我们所看到的。

所以，盒子 RMA'd。

* * *

## 回答 #57

> 赞同：1
> 
> 时间：2010-06-14T05:01:18.130

我曾经在 .NET 应用程序中有一个错误，它会导致 CLR 崩溃——是的，CLR 只会以非零结果退出，并且没有调试信息。

我在代码中添加了控制台跟踪消息，试图找出问题出在哪里（错误会在启动时发生），最终找到了导致问题的几行。我尝试隔离问题，但每次我做隔离案例都会起作用！

最后我改变了代码：

```
int value = obj.CalculateSomething(); 
```

至

```
int value;
value = obj.CalculateSomething(); 
```

不要问我为什么，但这有效。

* * *

## 回答 #58

> 赞同：0
> 
> 时间：2008-10-04T16:07:13.883

我使用的文本编辑控件中的堆内存冲突。经过数月（...）寻找它，我发现解决方案与另一个程序员一起工作，对问题进行同行调试。这个例子让我确信了在团队中工作和敏捷的价值。[在我的博客上](http://blogs.sevensteps.com/2008/03/two-weeks-ago-i-visited-marco-cantu-in.html)阅读更多关于它的信息

* * *

## 回答 #59

> 赞同：0
> 
> 时间：2009-05-05T07:42:01.013

我曾经卸载过PHP。手动。一大堆bug，一招搞定……

* * *

## 回答 #60

> 赞同：0
> 
> 时间：2008-10-24T21:34:10.800

简而言之：**内存泄漏**。

* * *

## 回答 #61

> 赞同：0
> 
> 时间：2008-10-08T18:21:47.197

*在设备调试器上非常糟糕的平台上有一个错误。如果我们在代码中添加 printf，我们会在设备上崩溃。然后它会在与 printf 位置不同的位置崩溃。如果我们移动 printf，崩溃会移动或消失。事实上，如果我们通过重新排序一些简单的语句来更改该代码，那么崩溃将发生在与我们更改的代码无关的地方。*

这看起来像一个经典的[Heisenbug](http://en.wikipedia.org/wiki/Heisenbug#Heisenbugs)。一旦你认出它，你就会立即去寻找未初始化的变量或堆栈边界垃圾。

* * *

## 回答 #62

> 赞同：0
> 
> 时间：2009-05-05T09:35:36.233

这是 Rhino（Java 中的 Javascript 解释器）中的一个小错误，导致一个脚本失败。这很难，因为我对解释器的工作原理知之甚少，但为了另一个项目，我不得不尽快解决这个错误。

首先我追踪了 Javascript 中的哪个调用失败了，所以我可以重现这个问题。我在调试模式下单步调试了正在运行的解释器，起初很迷茫，但慢慢地了解了它的工作原理。（阅读文档有点帮助。）我在我认为可能相关的地方添加了 printlns/logging。

我将工作运行的（清理后的）日志文件与中断运行进行了比较，看看它们是从什么时候开始分歧的。通过重新运行并添加大量断点，我找到了通往导致失败的事件链的方法。某处有一行代码，如果写得稍有不同，就能解决问题！（这是非常简单的事情，比如 nextNode() 应该返回 null 而不是 IndexOutOfBounds。）

两周后，我意识到我的修复程序在某些其他情况下破坏了脚本，我改变了线路以适用于所有情况。

我身处一个陌生的环境。所以我只是尝试了很多不同的东西，直到其中一个起作用，或者至少有助于取得一些进展/理解。*确实*花了一段时间，但我很高兴最终到达那里！

如果我现在再做一次，我会寻找项目的 IRC 频道（不仅仅是它的邮件列表），问一些礼貌的问题并寻求指点。

* * *

## 回答 #63

> 赞同：0
> 
> 时间：2008-10-05T12:45:54.927

我记得有几个，其中大部分是我造成的:)。几乎其中的每一个都需要大量的挠头。

1.  我是一个 java 项目（富客户端）的一部分，java 代码过去在 vanilla 构建或新机器上运行良好，没有问题，但是当安装在演示笔记本电脑上时，它突然停止工作并开始抛出 stackdump。进一步调查表明，该代码依赖于与 cygwin 冲突的自定义 dll。故事还没有结束，我们应该将它安装在其他 5 台机器上，然后猜猜是什么，在其中一台机器上它再次崩溃了！这次罪魁祸首是 jvm，我们提供的代码是使用 Sun microsystems jdk 构建的，并且机器有 ibm 的 jvm。

2.  我记得的另一个例子与自定义事件处理程序代码有关，该代码经过单元测试和验证，最后当我删除 print() 语句时，BOOM !!。当我们调试时，代码运行完美，增加了我们的欠款。我不得不求助于禅修（在桌子上打个盹），结果可能会出现时间异常！我们委托的事件甚至在条件设置之前就触发了函数，打印语句和调试模式为设置条件提供了足够的时间，因此可以正常工作。松了一口气，一些重构解决了这个问题。

3.  一天美好的一天，我决定实现 Clonable 接口所需的一些域对象，一切都很好。几周后，我们观察到应用程序开始出现异常行为。你猜怎么着？我们将这些浅拷贝添加到集合类中，而 remove() 方法实际上并没有正确清除内容（由于指向同一对象的重复引用）。这引起了一些严肃的模型审查和一些凸起的眉毛。

* * *

## 回答 #64

> 赞同：0
> 
> 时间：2009-05-05T11:16:48.017

我无法想象他们是如何编码的：您不能将 IP 地址 127.0.0.1 分配给环回适配器，因为它是环回设备的保留地址 --Microsoft(r) WindowsXP PROFESSIONAL

* * *

## 回答 #65

> 赞同：0
> 
> 时间：2008-10-04T04:35:02.640

用 Turbo Pascal 编写的 GUI 应用程序发生严重崩溃。三天前我发现，通过单步调试器，在机器代码级别，在简单且明显正确的代码上，我将一个 16 位整数放在调用堆栈上，用于期望 32 位（或一些这种不匹配）

现在我对此很明智，尽管现代编译器不再允许这种麻烦。

* * *

## 回答 #66

> 赞同：0
> 
> 时间：2009-05-05T11:24:40.790

我有一段 delphi 代码，它运行一个很长的处理例程来更新进度条。代码在 16 位 Delphi 1 中运行良好，但是当我们升级到 delphi 2 时，原本需要 2 分钟的进程突然花了大约一个小时。

在将例程分开数周后，事实证明是更新导致问题的进度条的行，对于每次迭代，我们都使用 table1.recordcount 检查记录计数，在 delphi 1 中这工作正常，但在以后的版本中似乎delphi 在 dbase 表上调用 table.recordcount 获取表的副本，计算记录并返回数量，在我们进度的每次迭代中调用它会导致表在每次迭代时从网络下载并计数。解决方案是在处理开始之前计算记录并将数量存储在变量中。

花了很长时间才找到，但结果很简单。

* * *

## 回答 #67

> 赞同：0
> 
> 时间：2009-06-24T21:09:34.213

从服务加载的 DLL 中发生的崩溃。通过关闭系统触发。

这个错误很容易修复，但花了大约一周的时间 - 并且非常沮丧 - 找到了。

* * *

## 回答 #68

> 赞同：0
> 
> 时间：2009-06-24T21:41:57.957

几年前，我花了几天时间试图追踪并修复 dbx（AIX 上基于文本的调试器）中的一个小错误。我不记得确切的错误。让我感到困难的是我正在使用已安装的 dbx 来调试我正在使用的 dbx 的开发版本。跟踪我的位置非常困难。不止一次，我准备离开一天并退出 dbx 两次（开发版和安装版），却发现我*仍在*dbx 内部运行，有时“深度”两个或更多级别。

--
bmb

* * *

## 回答 #69

> 赞同：0
> 
> 时间：2009-06-24T21:54:50.723

一个 Heisenbug，主要的困难是没有意识到它根本不是我的 bug。

问题是 API 接口。调用任何实际函数（与设置内容相反）很有可能因违反保护而崩溃。单步执行该函数（在可能的范围内，它会遇到一个中断，并且您无法跟踪该点——当您使用中断与系统对话时又会返回）产生正确的输出，没有崩溃。

在长时间搜索我做错了什么之后，我终于挖掘了 RTL 例程，试图了解我做错了什么。我做错了什么是相信例程有效——所有被轰炸的例程都在操作具有保护模式指针类型的实模式指针。除非实模式段值碰巧在保护模式下有效，否则这会变得繁荣。

但是，调试器对程序的操作导致单步运行时正确操作，我从来没有费心去弄清楚原因。

* * *

## 回答 #70

> 赞同：0
> 
> 时间：2010-01-02T08:36:55.677

我用下面的代码修复了某人的错误：

```
private void foo(Bar bar) {
    bar = new Bar();
    bar.setXXX(yyy);
} 
```

他原以为`bar`会在外面变`foo`！

* * *

## 回答 #71

> 赞同：0
> 
> 时间：2009-06-25T02:56:34.717

我们有一个在 DOS 提示符下运行的 RMI 服务器有人“选择”了窗口 - 这暂停了进程

修复很简单……按回车键。

这真是令人痛苦的一天……

* * *

## 回答 #72

> 赞同：0
> 
> 时间：2009-07-19T20:58:08.260

[无法解释的 SQL Server 超时和间歇性阻塞](http://blog.digitaltools.com/post/2009/02/24/Unexplained-SQL-Server-Timeouts-and-Intermittent-Blocking.aspx)

我们遇到了一个问题，我们的用户显然会无缘无故地超时。我监视了一段时间的 SQL Server，发现每隔一段时间就会有很多阻塞发生。所以我需要找到这个的原因并解决它。

如果发生阻塞，那么存储过程调用链中的某处必定存在排他锁……。正确的？

我浏览了被调用的存储过程的完整列表，以及所有后续的存储过程、函数和视图。有时这种层次结构很深，甚至是递归的。

我正在寻找任何 UPDATE 或 INSERT 语句……。没有（除了只有存储过程范围的临时表，所以它们不计算在内。）

在进一步的研究中，我发现锁定是由以下原因引起的：

A. 如果您使用 SELECT INTO 创建临时表，那么 SQL Sever 会锁定系统对象。以下是在我们的 getUserPrivileges 过程中：

```
 --get all permissions for the specified user
            select   permissionLocationId,
                permissionId,
                siteNodeHierarchyPermissionId,
                contactDescr as contactName,
                l.locationId, description, siteNodeId, roleId
            into #tmpPLoc
            from vw_PermissionLocationUsers vplu
                inner join vw_ContactAllTypes vcat on vplu.contactId = vcat.contactId
                inner join Location l on vplu.locationId = l.locationId
            where  isSelected = 1 and
                contactStatusId = 1 and
                vplu.contactId = @contactId 
```

每个页面请求都会调用 getUserPrivileges 过程（它位于基本页面中）。它没有像您预期的那样被缓存。看起来不像，但上面的 SQL 在 FROM 或 JOIN 子句中引用了 23 个表。这些表都没有“with(nolock)”提示，所以它花费的时间比它应该的要长。如果我删除 WHERE 子句以了解所涉及的行数，它将返回 159,710 行并需要 3 到 5 秒才能运行（数小时后，服务器上没有其他人。）

因此，如果此存储过程由于锁定而只能一次运行一个，并且每页调用一次，并且在 select 和 temp 表创建期间保持系统表上的锁定，您可以看到它可能如何影响整个应用程序的性能。

对此的解决方法是： 1\. 使用会话级缓存，因此每个会话仅调用一次。2\. 将 SELECT INTO 替换为使用标准 Transact-SQL DDL 语句创建表的代码，然后使用 INSERT INTO 填充表。3\. 将“with(nolock)”放在与此调用相关的所有内容上。

B. 如果存储的过程 getUserPrivileges 对您来说没有足够的问题，那么让我补充一下：它可能会在每次调用时重新编译。因此 SQL Server 在每次调用时都会获得一个编译锁。

它被重新编译的原因是因为创建了临时表，然后从中删除了很多行（如果传入了@locationId 或@permissionLocationId）。这将导致存储过程在随后的 SELECT 上重新编译（是的，在运行存储过程的中间）。在其他过程中，我注意到一个 DECLARE CURSOR 语句，其 SELECT 语句引用了一个临时表——这将强制一个也重新编译。

有关重新编译的更多信息，请参阅：http: [//support.microsoft.com/kb/243586/en-us](http://support.microsoft.com/kb/243586/en-us)

对此的解决方法是： 1\. 再次，通过使用缓存来减少此存储过程的次数。2\. 在创建表时，在 WHERE 子句中应用 @locationId 或 @permissionLocationId 过滤。3\. 用表变量替换临时表——它们会减少重新编译。

如果事情没有像您期望的那样工作，那么您可能会花很多时间盯着某件事，却没有弄清楚哪里出了问题。

* * *

## 回答 #73

> 赞同：0
> 
> 时间：2010-11-17T20:51:50.773

我遇到的最严重的错误不是由我造成的，尽管它导致我的代码崩溃！这是 DOS 上的 TurboPascal。TurboPascal 编译器编译器进行了小幅升级，突然我的二进制文件开始崩溃。原来，在新版本中，内存仅从段边界开始分配。当然，我的程序从来没有检查过这样的事情，因为为什么？程序员怎么会知道这些事情？旧的 compuserve 特别兴趣小组中的某个人发布了此线索和解决方法：

由于段有 4 个字长，因此修复方法是始终执行 mod(4) 来计算要分配的内存大小。

# apache-flex - 在哪里可以找到 Flex 源代码？

> ID：169721
> 
> 赞同：11
> 
> 时间：2008-10-04T04:15:03.930
> 
> 标签：apache-flex, open-source

我一直听说 Flex 是开源的，我认为了解内部工作原理的一个好方法是查看它。我可以轻松找到 Flex SDK（[http://opensource.adobe.com/wiki/display/flexsdk/Get+Source+Code](http://opensource.adobe.com/wiki/display/flexsdk/Get+Source+Code)），但我想查看 MXML 核心库的类定义（如 NumericStepper ）。我是否误解了，或者这种东西在某处可用？

请注意，我正在寻找一些核心 MXML 组件的源代码，以便我可以看到它们在内部是如何工作的，而不是编译器的源代码。我上面链接的内容是否有我正在寻找的东西，而我只是在导演结构中找不到它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-05T15:19:07.300

如果您已经安装了 sdk 或 Flex builder，我相信所有源文件都安装在您的计算机上本地。

我有 flex builder 3 安装源位于此处（取决于您安装的位置）：

*flex 3 sdk 的源代码*

C:\Program Files\Adobe\Flex Builder 3\sdks\3.0.0\frameworks\projects\framework\src\mx

*flex 2 sdk 的源代码*

C:\Program Files\Adobe\Flex Builder 3\sdks\2.0.1\frameworks\source\mx

希望这有助于并减轻在线查看源代码的需要...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T06:12:35.453

源代码可在此处的 SVN 存储库中找到：http: [//opensource.adobe.com/wiki/display/flexsdk/Get+Source+Code](http://opensource.adobe.com/wiki/display/flexsdk/Get+Source+Code)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-04T07:12:39.577

这是 NumericStepper 代码的直接链接：http: [//opensource.adobe.com/svn/opensource/flex/sdk/trunk/frameworks/projects/framework/src/mx/controls/NumericStepper.as](http://opensource.adobe.com/svn/opensource/flex/sdk/trunk/frameworks/projects/framework/src/mx/controls/NumericStepper.as)

这是框架的完整代码：http: [//opensource.adobe.com/svn/opensource/flex/sdk/trunk/frameworks/projects/framework/src/mx/](http://opensource.adobe.com/svn/opensource/flex/sdk/trunk/frameworks/projects/framework/src/mx/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-04T04:18:49.227

开源的东西似乎在：

```
http://opensource.adobe.com/wiki/display/flexsdk/Downloads 
```

我不知道那里是否一切都可用，第三方的东西可能存在问题。

# .net - .NET 最好的文字处理组件是什么

> ID：169728
> 
> 赞同：10
> 
> 时间：2008-10-04T04:22:05.350
> 
> 标签：.net, components, word-processor

我正在寻找 .NET 的文字处理组件，它在我的 WinForm/WPF .NET 应用程序中就像嵌入式 MS Word。主要目标是让用户能够创建格式丰富的文本。我真的不想编写高度自定义的 RichTextBox 组件。有什么建议么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-04T07:08:30.210

我们正在为 .Net 使用 TXTextControl 版本 14，我们对此感到非常高兴。它具有您可以提出的所有积极要求：便宜、支持良好、与最新的 Word 版本保持同步、速度快且不占用内存或资源。包含的文字处理器示例是非常好的代码，我们在大约 1 天的工作中将其转换为适当的“文字控件”，并在另一天将其包含在我们的解决方案中，因此使用它也非常简单，即使它有很多的特征。
从[http://www.textcontrol.com/下载](http://www.textcontrol.com/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-04T08:22:03.523

我们使用了另一个 Aspose 单词控件在 asp.net 应用程序中生成 word 文档，它完美地呈现了它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-04T05:37:35.447

我只使用了[TX Text Control](http://www.textcontrol.com/products/client_side/dotnet/features/)的 ActiveX 版本，但它非常好，我相信他们的 .NET 版本也是如此。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-29T08:49:20.373

我是 TX Text Control 的产品经理。我们听取了这样的要求。我们为 .NET 提供了强大的富文本控件，但您是对的：有时，它们可能过于昂贵——即使您没有使用所有功能。

因此，我们发布了 TX Text Control 的免费版本——就像啤酒一样免费。

[http://www.textcontrol.com/en_US/sites/tx-text-control-express/](http://www.textcontrol.com/en_US/sites/tx-text-control-express/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-04T04:57:36.293

显然，我不知道您的特定项目要求是什么，但[ScintillaNET](http://www.codeplex.com/ScintillaNET)是一个极好的控件，并且足够灵活，可以做的不仅仅是语法高亮。我可以预见到肯定不合适的情况，但至少值得调查。经过大量搜索后，它完美地填补了我的应用程序中的空白，我需要对散文进行广泛的上下文突出显示。

**编辑**

我要撤消此评论，因为我已经考虑了一分钟，而 Scintilla 提供的有限数量的样式将使其不适合富文本编辑。但是，对于任何可以通过编程方式确定如何应用样式的情况，它仍然是一个很好的解决方案。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-16T00:01:10.333

我在我的应用程序中使用来自子系统的 TE 编辑控件。[http://www.subsystems.com/tewf.htm](http://www.subsystems.com/tewf.htm)。

按预期工作。在我评估的时候，我确实看过 TXTextControl。我想可能是成本让我失望了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-16T00:14:35.940

我已经使用 TinyMCE 大约一年了，作为开发人员，我喜欢它，最终用户也喜欢它。它实现起来很简单，并且很容易配置用户看到的控件，例如插入表格按钮或粘贴为纯文本按钮。

它也是 LGPL 许可证，因此至少对于我们的使用而言，我们无需担心成本。

[https://www.tiny.cloud/](https://www.tiny.cloud/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T10:09:58.277

如果您使用 WPF，您可以查看[http://www.wpftexteditor.com](http://www.wpftexteditor.com)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-12T19:34:53.440

自 1.0 版以来，我们一直在使用 Apose Words and Cells。两个组件都很坚固，但支持有点痛苦。就个人而言，我不喜欢与不同时区的人一起工作，尤其是当与他们取得联系的唯一方式是留言板时。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-20T19:59:54.003

我不确定这个话题是否仍然活跃，但我现在遇到了同样的问题。我正在.net winforms 中创建一个报价系统，最后我必须生成报价，其中包含产品项目和.doc 中的一些文本。我扫描了整个网络，包括组件源，我发现了这个： - txControl.. 知道我需要的一切，但 900 美元（它也有更便宜的版本，但不导出到 doc - aspose.. 它更适合 asp

我还发现了来自 Microsoft 的 DSOFramer，它是 Word 女士的 activeX 主机。嗯，免费并提供一切......当然，因为它是某种单词自动化。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-21T23:38:36.287

我是 Aspose.Words 的项目负责人。

我个人的看法是，如果你正在构建任何严肃的软件，尤其是用于商业或商业目的，你应该有一些工具预算，900 美元对于它的功能来说并不算多。毕竟开发是要花钱的。

但是我们接受每个人的情况不同，所以不要犹豫，在 Aspose.Purchase 论坛中发布价格问题，也许你能得到你想要的。

# javascript - 如何动态引用对象？

> ID：169731
> 
> 赞同：9
> 
> 时间：2008-10-04T04:23:55.457
> 
> 标签：javascript, json

在 Javascript 中，我有一个对象：

```
obj = { one: "foo", two: "bar" }; 
```

现在，我想做这个

```
var a = 'two';
if(confirm('Do you want One'))
{
  a = 'one';
}

alert(obj.a); 
```

但它当然行不通。动态引用此对象的正确方法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-04T04:31:26.627

简短的回答：`obj[a]`

长答案：`obj.field`只是`obj["field"]`, 对于键是没有空格、点或其他讨厌的东西的常量字符串的特殊情况。在您的问题中，密钥不是常量，因此只需使用完整的语法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-04T04:28:49.923

像这样：

```
obj[a] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-04T15:32:57.103

作为旁注，全局变量附加到“窗口”对象，所以你可以做

```
var myGlobal = 'hello';
var a = 'myGlobal';
alert(window[a] + ', ' + window.myGlobal + ', ' + myGlobal); 
```

这将提醒“你好，你好，你好”

# .net - 用于极低带宽通信的最佳 .NET 通信组件或协议？

> ID：169759
> 
> 赞同：1
> 
> 时间：2008-10-04T04:50:54.370
> 
> 标签：.net, communication, tcp

对于非常低的带宽和间歇性连接的通信（即：< 10 kbps），最好的 .NET 通信组件或协议是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-04T10:47:50.780

您可能需要一个用于连接的 Socket 和 TCP/IP 一个非常低的开销和友好的序列化格式是协议缓冲区，一个好的 .NET 实现是[protobuf-net](http://code.google.com/p/protobuf-net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T04:54:53.693

大概`System.Net.Sockets.`**`Socket`**。在该命名空间中还有一个`TcpClient`and `UdpClient`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T05:44:22.923

是的！，套接字就是你要找的东西

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T08:26:48.243

[RUDP](http://www.codeplex.com/RUDP)看起来很有前途。

# language-agnostic - 如何让非技术人员理解非 UI 问题？

> ID：169765
> 
> 赞同：17
> 
> 时间：2008-10-04T04:55:39.900
> 
> 标签：language-agnostic, communication, requirements

假设您正在处理一个企业项目，您必须在该项目中获得管理层批准才能开发新功能集。通常，您的管理层签署一些明亮闪亮的新 UI 功能是没有问题的。不幸的是，他们很难理解一些对应用程序的健康至关重要的幕后问题，例如事务、数据完整性、工作流路由、可配置性、安全性等。因为它们不是技术性的，而且这些问题是不是立即可见的，对他们来说这并不明显，这是至关重要的。

您如何说服他们必须处理这些基础设施问题并且这对他们的业务流程很重要？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-04T07:18:31.517

每一种工艺都有其不性感的一面。必须做的事情，但没有人直接注意到它们。在杂货店里，有人必须组织如何以及何时填满杂货货架，以使它们看起来总是新鲜的。在洗衣店，您需要有人思考如何优化流程，以便客户及时拿到衣服。

棘手的部分是：客户不会注意到这些微妙的事情何时正确完成，直到他注意到它们丢失了！就像洗衣服没有按时准备好但晚了两天，或者超市里的蔬菜有褐色斑点，看起来很糟糕。

IT 也是如此。直到您的主要客户敲门并告诉您一个重要且昂贵的项目失败了，因为您的产品的数据库条目神秘地混淆了，您才会注意到良好的交易。在客户信用卡信息出现在[Elbonia](http://en.wikipedia.org/wiki/Elbonia)之前，您不会注意到良好的安全性（并且很快就会在全国性报纸上警告贵公司的客户）。

您真正需要一次又一次地敲定的是软件不是静态的。即使在其初始开发阶段结束后，也必须对其进行保养。它不仅仅是您购买一次就忘记的产品。每个汽车制造商都知道，服务对他们制造的产品至关重要，仅仅是因为会发生必须修复和改进的事情。软件也是一样。

因此，进行演示、可视化、语言化、将您的技术信息转化为收益。业务人员并不关心您在重构项目中对代码美学的期望，但他们会理解您的更改将有助于产品变得更可靠、获得更好的声誉并减少未来的服务请求数量。通过向他们展示好处让他们理解！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-04T04:59:39.283

几千年来人们一直在做同样的事情：画画。绘制问题图，使用观众熟悉的视觉隐喻，将问题拖入他们的领域。

假设他们不是故意钝...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-04T05:27:36.247

类比和隐喻的大+1。如果可能的话，找一个能与你的听众的个人兴趣产生共鸣的人（如果是 1-2 人）。对于一般的比喻，出于某种原因，我经常发现自己使用通勤交通或地铁。

例如，我们目前正在将应用程序从 OODB 迁移到 Postgres/Hibernate：大部分工作是在 Release '4' 中完成的。许多领域专家一直在问为什么 R4 中面向用户的功能如此之少。我经常告诉他们，我们一直在“拆毁这座城市以安装地铁”。这是非常昂贵且不可否认的风险，但一旦完成，R5+ 的好处将是惊人的，真的。真正的对话更复杂，但我可以一次又一次地回到这个主题，在 R4 之后。几个月后，我希望说“你要求 X，现在很容易——正是因为你让我们把那个地铁放回 R4”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-04T05:41:36.080

让高层管理人员接受开发工作的最可靠方法是以可量化的方式呈现它。理想情况下，这种可量化的度量单位是 $$。您需要向他们解释在数据完整性、安全性、交易等方面吝啬的后果，以及这将如何影响客户\用户社区并最终影响利润。在这些情况下您应该小心，因为有时管理层希望这些非功能性需求“正常工作”。如果是这种情况，您应该估计高并在可见的 UI 工作旁边处理这些项目（无知是幸福），或者您需要在与管理层沟通时记录这些需求领域，以便如果事情确实如您预期的那样糟糕，危在旦夕的不是你的工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-04T06:34:43.477

不幸的是，在这些东西得到应有的关注之前，通常需要一两次灾难。

这真的取决于你的管理是怎样的，但我很幸运能摆脱老实人的恐惧。*如果你*经历了几个灾难场景，并指出如果他们发生就会受到责备，这足以让他们的搜捕本能开始并最终引起注意:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-04T06:41:58.967

我正在与基本上相同的情况作斗争。无论是管理层签字还是用户/赞助商接受，问题仍然是不同的词汇、优先事项和观点之一。[我在这里问了一个类似的问题](https://stackoverflow.com/questions/100767/communication-gap-user-vs-analyst-designer)。

我也得到了各种各样的答案，非常接近有用，但还不够明确。使用相关关键字浏览和搜索 SO 使我在分布在许多不相关问题的各种答案中找到有用的见解。[为了找到并提取这些宝石，我在 site-mining 上](https://stackoverflow.com/questions/165840/site-mining-tools)提出了这个问题。

能够标记各种答案并将它们全部显示在一个列表中会很有用，但可惜的是，该功能在 SO 中尚不可用。我[在 uservoice 上建议了它](http://stackoverflow.uservoice.com/pages/general/suggestions/33359)。

希望您从我提供的参考资料中找到可以使用的东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-04T06:53:49.273

汽车类比。

每个人都知道这个“系统”，它足够复杂来描述可怕的情况。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-04T07:53:19.697

正确的反驳问题是秘诀。

*   每 5 个网页崩溃一次可以吗？
*   我们必须保护信用卡号码吗？
*   是否可以支付承包商每个周末部署补丁的费用？
*   您现在想要它还是想要它工作？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-04T05:00:21.823

稳健性。归根结底，您需要谈论他们的语言，这就是它如何影响他们的底线。如果是安全性或正确性问题，您需要告诉他们客户不会想要行为不正确的产品，无论它们看起来多么漂亮。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-04T17:15:05.897

描述性图片确实可以帮助非技术人员理解您在说什么。例如，下面是 Sun 的一个示例，描述了如何在其有些复杂的应用程序中处理信息。

[![来自 docs.sun.com 的图表](https://i.stack.imgur.com/EOcco.gif)](https://i.stack.imgur.com/EOcco.gif)
[（来源：[sun.com](http://docs.sun.com/source/816-7152-10/images/wsgoverview3.gif)）]

试图用语言解释这个应用程序对于非技术人员来说是不可能的。指着图说看，这部分是我们的弱点，需要改进。这对他们来说是有意义的。如果他们觉得他们对您的工作有所了解，他们将更愿意支持您的请求。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-09T06:41:21.353

我喜欢[技术债务](http://en.wikipedia.org/wiki/Technical_debt)的想法，因为它可以将技术问题（尽管是松散的）转化为金钱问题——而金钱是大多数管理者都理解的东西。

尽管技术债务的概念最初适用于架构问题，但它可以更广泛地用于任何有压力走捷径的情况——即陷入​​技术债务——而不是一开始就做对时间。（正确地做就相当于存钱买东西——这需要时间——而不是赊购并负债。）

正如债务可以是好的（例如房屋贷款）和坏的（例如信用卡）一样，技术债务也可以是好的和坏的。我不会尝试完全描述差异，但可以准确跟踪良好的技术债务，以便您知道自己的债务有多少。

所以，试着从技术债务的角度来解释你重要的、非 UI 问题，以及在支付债务利息方面不解决它的成本。

# sql - 在 SQL 中没有得到正确的计数

> ID：169784
> 
> 赞同：4
> 
> 时间：2008-10-04T05:17:36.907
> 
> 标签：sql, sql-server-2005, tsql

我对`SQL`. 我有一个与此类似的简单选择查询：

```
SELECT COUNT(col1) FROM table1 
```

表中有大约 120 条记录，并显示在`GUI`. 出于某种原因，此查询总是返回一个小于实际计数的数字。

有人能帮帮我吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-04T05:18:43.613

尝试

```
select count(*) from table1 
```

**编辑：**为了进一步解释，`count(*)`为您提供表的行数，包括重复项和空值。`count(isnull(col1,0))`将做同样的事情，但速度*稍慢*，因为`isnull`必须对每一行进行评估。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-04T05:18:44.753

您可能在 col1 列中有一些空值。聚合函数忽略空值。试试这个

```
SELECT COUNT(ISNULL(col1,0)) FROM   table1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T20:23:29.247

有点切线，但也有有用的

```
SELECT count(distinct cola) from table1 
```

这为您提供了表中不同列的数量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-10T11:21:59.820

你得到正确的计数

根据[https://docs.microsoft.com](https://docs.microsoft.com)

COUNT(*) 返回组中的项目数。这包括 NULL 值和重复项。

COUNT(ALL expression) 计算组中每一行的表达式并返回非空值的数量。

COUNT(DISTINCT expression) 计算组中每一行的表达式并返回**唯一的非空**值的数量。

在您的情况下，您已经在 COUNT 中传递了列名，这就是为什么您将获得**非空记录计数**的原因，现在您在表数据中，您可能在给定列（col1）中有空值

希望这可以帮助！

# java - 如何在 Java 运行时将面板动态添加到其他面板？

> ID：169799
> 
> 赞同：11
> 
> 时间：2008-10-04T05:32:05.927
> 
> 标签：java, swing

我正在尝试再次进入Java（已经有几年了）。我从来没有真正在java中做过任何GUI编码。我一直在使用 Netbeans 开始使用它。

在工作中使用 C# 中的 winforms 时，我使用用户控件来构建我的 UI 的一部分并将它们动态添加到表单中。

我一直在尝试`JPanels`在 C# 中使用类似用户控件。我创建了一个`JPanel`名为`BlurbEditor`. 这有一些简单的控件。我试图在按钮事件的运行时将它添加到另一个面板。

这是我认为可行的代码：

```
mainPanel.add(new BlurbEditor());
mainPanel.revalidate();
//I've also tried all possible combinations of these too
//mainPanel.repaint();
//mainPanel.validate(); 
```

不幸的是，这不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-04T06:13:53.517

我想到了。此处接受的答案下的评论对此进行了解释： [动态添加的 JTable 未显示](https://stackoverflow.com/questions/121715/dynamically-added-jtable-not-displaying)

基本上我只是在 mainPanel.add() 之前添加了以下内容

```
mainPanel.setLayout(new java.awt.BorderLayout()); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-04T11:02:31.203

`Swing/AWT`组件通常必须在向它们添加内容之前具有布局 - 否则`UI`将不知道将子组件放置在哪里。

BFreeman 提出`BorderLayout`了最容易使用的方法之一，它允许您将东西“粘合”到父对象的顶部、底部、左侧、右侧或中心。

还有其他的，例如`FlowLayout`which 就像 a `textarea`- 它在父级的顶部从左到右添加组件，并在到达末尾时换行到新行。

这`GridBagLayout`一直以无法弄清楚而臭名昭著，但确实为您提供了几乎所有所需的控制权。有点像`HTML`我们过去看到的那些表格，它们具有行跨度、跨度、宽度和高度属性的奇怪组合——看起来从来没有像你想要的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T09:16:37.907

与所有 Swing 代码一样，不要忘记在事件调度线程中调用任何 gui 更新。看到[这个](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/dispatch.html)为什么你必须做这样的更新

```
// Do long running calculations and other stuff outside the event dispatch thread
while (! finished )
  calculate();
SwingUtilities.invokeLater(new Runnable(){
  public void run() {
    // update gui here
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-22T05:22:05.537

mainPanel.add(new BlurbEditor());

mainPanel.validate();

mainPanel.repaint();

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-26T08:03:48.390

我正在处理类似的问题，我想在运行时更改面板中包含的面板
经过一些测试、重新测试和很多失败，我的伪算法是这样的：

parentPanel : 包含我们要移除的面板
childPanel : 我们要切换的面板
parentPanelLayout : parentPanel 的布局
editParentLayout() : 每次使用不同的 childPanel 和 NEW parentPanelLayout 构建 parentPanel

```
parentPanel.remove(childPanel); 
editParentLayout();
parentPanel.revalidate();
parentPanel.repaint(); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-04T05:35:13.563

尝试`mainPanel.invalidate()`，然后如果需要，`mainPanel.validate()`. 还可能值得检查您是否在事件调度线程中执行所有这些操作，否则您的结果将参差不齐且（通常）不确定。

# python - Python 中的 2D 动画

> ID：169810
> 
> 赞同：12
> 
> 时间：2008-10-04T05:36:23.267
> 
> 标签：python, animation, 2d

我正在用 Python 编写一个模拟器，并对有关基本 2D 动画的选项和意见感到好奇。通过动画，我指的是动态渲染，而不是显示预渲染的图像。

我目前正在使用 matplotlib（Wxagg 后端），我有可能继续使用它，但我怀疑它在性能或功能方面无法充分扩展。

要求是：

*   跨平台（Linux、MacOS X、Windows）
*   低复杂性开销
*   与 wxpython 配合得很好（至少不会过分踩对方的脚趾）
*   交互性。检测对象何时被点击、鼠标悬停等。

请注意，高性能不在列表中，但在屏幕上处理约 100 个位图对象的能力会很好。

你的意见？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-04T05:50:03.410

我是[pyglet](http://pyglet.org)的粉丝，它是一个完全独立的库，用于在 win32、linux 和 OS X 下进行图形工作。

它的开销非常低，您可以从网站上的教程中亲自看到这一点。它*应该*与 wxpython 配合得很好，或者至少我似乎记得邮件列表中关于 wxpython 和 pyglet 一起使用的帖子。

但是，它不提供通过鼠标单击来选择对象-您必须自己处理。一般来说，对于 2D 应用程序来说，这并不太难做到。

[macctorii](https://github.com/freespace/mactorii)是我用纯 python+pyglet 编写的一个 OS X 应用程序，并且有一些基本的动画（滚动）和点击检测。它不使用 wxpython，但也许它会让您了解所涉及的内容。但是请注意，mactorii 使用的是旧的 pyglet api，所以我在那里的运行循环已经过时了。总有一天我会去更新它... :P

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-14T20:16:46.803

你可以试试pygame，它很容易处理，类似于c++下的SDL

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-02-25T06:58:37.633

[Arcade](https://arcade.academy/)可在任何具有 OpenGL 3.3+ 的平台上运行（即不是 Raspberry Pi，而是大多数其他平台）。尽管它是为简单的游戏而设计的，但 Arcade 提供了出色的位图和精灵处理，以及简单的图形基元，例如矩形、弧形和圆形。

# functional-programming - 是否会有一种函数式语言为 Java 社区做 F# 为 .NET 社区做的事情？

> ID：169812
> 
> 赞同：22
> 
> 时间：2008-10-04T05:39:20.263
> 
> 标签：functional-programming, jvm

是否会有一种函数式语言为 Java 社区做 F# 为 .NET 社区做的事情？

JVM 有哪些函数式编程语言可用或正在开发中？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-10-04T05:40:03.023

[Scala](http://www.scala-lang.org/)将是语言。

虽然不是严格意义上的函数式（它是函数式和面向对象的混合体），也不是严格意义上的 Java（有[Scala 的 .NET 版本](http://www.scala-lang.org/node/168)），但这将是 JVM 中最接近 F# 的模拟。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-04T06:35:04.503

我首先想到的是**Scala**，但实际上**[Ocaml-Java](http://ocamljava.x9c.fr/)**更接近于 F# 是 Ocaml 的变体。请参阅[这篇将 Ocaml-Java 与 Scala 进行比较的帖子](http://groups.google.com/group/jvm-languages/msg/b7edd5f9e6ed0361?pli=1)：

> 对于广泛的实际任务，OCaml 程序员的生产力通常是 Java 或 C++ 程序员的 10 倍以上。尽管基于基本的 OOP 平台，F# 在获取 OCaml（以及整个 ML 系列）的生产力提升优势方面还有很长的路要走。相比之下，Scala 未能捕捉到许多好处，包括一些非常基本的好处，因此，在 Scala 中编写正确的代码比在任何真正的 ML 中都要困难得多。
> 
> 此外，ML 系列语言被设计为简洁，但 Scala 对“Hello world！”中的所有内容都不必要地冗长。向上。ML 系列语言提供了广泛的类型推断（OCaml 比大多数语言都多），但相比之下，Scala 仅提供基本的推断。OCaml 有一个异常丰富的类型系统，但 Scala 对 OOP 几乎没有什么实际意义。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-05T02:42:08.047

也许是[Clojure](http://clojure.org/)。它不是静态类型的，但它比 F# 更强调不变性和并发性。但是，与 F# 一样（与 Common Lisp 不同），它旨在成为一种主要的函数式语言，擅长从底层平台使用 OO 库。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-04T12:49:06.153

现在我会说Scala。但对于未来，我会看看 Fortress。该规范的第一个实现于 2008 年 4 月 1 日发布。不，这不是玩笑。主要特点是：

*   静态类型，但有很多类型推断以避免混乱
*   数学函数的 Unicode 和 2d 渲染
*   专为并行执行而设计（对于每个默认值）
*   对自定义库的强大支持（Guy Steele 的影响）
*   运算符重载，包括并列运算符

更多信息请访问[Project Fortress 社区网站](http://projectfortress.sun.com/Projects/Community/ "Project Fortess 社区网站")和[Wikipedia Fortress 页面](http://en.wikipedia.org/wiki/Fortress_(programming_language) "维基百科要塞页面")。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-19T20:14:06.937

可以说没有，因为 JVM 缺少尾调用，并且要求它们使几乎所有功能代码在堆栈消耗方面都健壮。

最接近 JVM 上的函数式语言实现的是[Clojure](http://clojure.org/)、[Scala](http://www.scala-lang.org/)和[OCaml-Java](http://ocamljava.x9c.fr/)项目。尽管没有尾调用（例如蹦床）有一些变通方法，但这些语言实现都没有这样做，因为变通方法引入了更严重的问题，例如削弱性能和完全混淆调试。

Sun 多年来一直在谈论尾部呼叫，最近，他们表示他们打算立即实施它们。一旦完成，我相信我们会在 JVM 上看到更多的语言多样性，特别是一些生产质量的函数式语言实现。在那之前，我将所有这些语言都视为玩具。

干杯，乔恩·哈罗普。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-17T00:32:31.593

有一个很好的 JVM 编程语言列表，包括函数式编程范式和其他范式语言：

*   en.wikipedia.org/wiki/List_of_JVM_languages

我的第一个选择是 Scala（多范式；OO & FP），我在 2009 年花了 5 个多月的时间研究 Scala，并创建了一个快速参考表：bchiprog.blogspot.com/2009/05/scala-cheat-sheet.html

我注意到还有其他有趣的编程范式，其他侧重于并行处理，例如 X10、Fortress 和 Chapel。X10 在 Scala 之上实现 - [http://www.scala-lang.org/sites/default/files/odersky/scalaliftoff2009.pdf](http://www.scala-lang.org/sites/default/files/odersky/scalaliftoff2009.pdf)

它实际上基于您需要解决的问题，然后选择最能解决它的语言。我认为开发人员希望有一种语言可以轻松解决任何类型的问题并简单地做到这一点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-05T12:43:14.667

@Marc Gravell - 函数式语言越来越多地用于企业级金融系统的内部。我们在我工作的银行使用许多功能性（纯或“半纯”）......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-12-24T23:35:40.060

同时，还有[Frege](http://code.google.com/p/frege)，一种纯函数式、非严格的 Haskell 精神语言，可编译为 Java，然后根据环境（命令行或 eclipse）使用 javac 或 eclipse 编译器进一步编译。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-04T08:19:01.737

实际上，我可能错了，但我不认为 F# 会像其他 .NET 语言那样成为主流。在一些圈子（学术、编译器、一些其他场景）中很有用 - 但是，不要忘记**C#**提供了 FP 用法 - 并且每次都变得更好：C# 1.2 有委托；C# 2.0 有匿名方法和捕获/闭包；C# 3.0 为简单起见具有 lambda，而为抽象提供了 Expression。匿名类型（C# 3.0）与元组*有一些*相似之处（就方便而言），但显然是非常不同的野兽，所以绝对不是同类比较。

也许不如 F# 优化，但对于大多数日常 FP 用例来说，绰绰有余。

很明显，更好地支持不变性（尤其是线程）是 C# 语言团队未来考虑的重点。

我的钱用于 C# 在 FP 方面变得更好，并成为大多数日常用途的 .NET FP 产品。当然，会有一些 F# 的使用——但是（纯粹是主观的）我根本不认为会有巨大的迁移。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-01-16T09:10:40.100

我会将[https://eta-lang.org](https://eta-lang.org)添加到建议中——它基本上是 JVM 的 Haskell。我认为这个问题符合 F# 是一种 ML 语言，而 Clojure 是 LISP 的方言这一事实​​。

# java - 如何找到两个相距最远的节点之间的距离

> ID：169814
> 
> 赞同：3
> 
> 时间：2008-10-04T05:40:33.537
> 
> 标签：java, algorithm, graph-theory

我正在解决前几年的 ACM 编程竞赛问题，试图更好地解决图形问题。

我现在正在处理的一个是给定任意数量的无向图节点、它们的邻居以及连接节点的边的距离。我需要的是两个最远节点之间的距离（权重距离，而不是节点数）。

现在，我确实有以下形式的 Dijkstra 算法：

```
// Dijkstra's Single-Source Algorithm
private int cheapest(double[] distances, boolean[] visited)
{
        int best = -1;
        for (int i = 0; i < size(); i++)
        {
                if (!visited[i] && ((best < 0) || (distances[i] < distances[best])))
                {
                        best = i;
                }
        }
        return best;
}

// Dijkstra's Continued
public double[] distancesFrom(int source)
{
        double[] result = new double[size()];
        java.util.Arrays.fill(result, Double.POSITIVE_INFINITY);
        result[source] = 0; // zero distance from itself
        boolean[] visited = new boolean[size()];
        for (int i = 0; i < size(); i++)
        {
                int node = cheapest(result, visited);
                visited[node] = true;
                for (int j = 0; j < size(); j++)
                {
                        result[j] = Math.min(result[j], result[node] + getCost(node, j));
                }

        }
        return result;
} 
```

通过这个实现，我可以给它一个特定的节点，它会给我一个到该节点的所有距离的列表。因此，我可以在该距离列表中获取最大距离，但我不能确定任何特定节点是两端最远的两个节点之一。

所以我能想到的唯一解决方案是在每个节点上运行这个 Dijkstra 算法，遍历每个返回的距离列表并寻找最大距离。在用尽每个节点返回它的距离列表后，我应该有任何两个节点之间最大距离的值（两个最广泛分离的村庄之间的“道路”距离）。必须有一种更简单的方法来做到这一点，因为这看起来在计算上确实很昂贵。问题是可能有多达 500 个节点的样本输入，所以我不希望它花费太长时间。这是我应该怎么做的吗？

这是该问题的示例输入：

节点总数：5

边：
节点 2 - 连接 - 节点 4\. 距离/权重 25
节点 2 - 连接 - 节点 5\. 距离/权重 26
节点 3 - 连接 - 节点 4\. 距离/权重 16
节点 1 - 连接 - 节点 4\. 距离/权重 14

此示例输入的答案是“67 英里”。这是两个相距最远的村庄之间的道路长度。

那么我应该按照我描述的方式去做，还是有一种更简单、计算成本更低的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-04T06:05:53.813

看起来您可以使用以下任何一种：

*   [Floyd Warshall 算法](http://en.wikipedia.org/wiki/Floyd_Warshall)
*   [约翰逊算法](http://en.wikipedia.org/wiki/Johnson's_algorithm)。

不过，我不能给你太多关于它们的指导——我不是专家。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-04T06:10:03.197

因此，有一个运行 O(VlogV + E) 的 Dijkstra 实现，使您的方法具有大约 V^2logV + VE 的复杂性。见[爸爸](http://www.nist.gov/dads/HTML/dijkstraalgo.html)。但也许更直观的是运行所有[对最短路径](http://www.nist.gov/dads/HTML/allPairsShortestPath.html)算法之一，如 Floyd-Warshall 或 Johnsons。不幸的是，对于密集图，它们都大致为 O(V^3)（接近 E = V^2 的完整图）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-04T08:33:00.133

这是[北方道路的](http://icpcres.ecs.baylor.edu/onlinejudge/external/103/10308.html)问题吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T06:03:32.947

您可以按如下方式使用 Dijkstra 的实现：

1.  选择一个随机节点 (a)，从节点 a 运行 Dijkstra，并找到离它最远的节点。将该节点标记为节点 b。
2.  从节点 b 开始再次运行 Dijkstra，并找到离它最远的节点。将该节点标记为节点 c。

我没有证据证明这一点，但我认为 b 和 c 将是最远的节点。您可能需要再运行一次迭代（我仍在考虑）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-04T06:14:15.733

将边权重乘以 -1 并找到新图上的最短路径。那将是原始图上最长的路径

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-04T08:30:34.990

如果你想要最长的最短路径

sup i,j {inf i,j {n : n=i 和 j 之间的路径长度}}

您当然应该考虑其他人提到的像 Flyod-Warshall 这样的全节点最短路径算法。这将是 O(V^3) 的顺序。

如果你想要最长的可能路径

sup i,j {n : n=i 和 j 之间的路径长度}

您可以尝试使用 Midhat 的想法。（这确实与评论中指出的原始问题一样复杂）我建议使用 1/w 反转权重，以保留正权重，因为原始权重是严格的正数。

处理负权重时您可能要查找的另一种算法是 Bellman 和 Ford 的算法

# java - Java - 常见问题

> ID：169815
> 
> 赞同：50
> 
> 时间：2008-10-04T05:41:08.827
> 
> 标签：java

本着其他平台的相同精神，跟进这个问题似乎是合乎逻辑的：Java 中有哪些常见的非显而易见的错误？看起来他们应该工作的事情，但没有。

我不会就如何构建答案或什么“太容易”而不被视为陷阱提供指导，因为这就是投票的目的。

也可以看看：

*   [Perl - 常见问题](https://stackoverflow.com/questions/166653/perl-common-gotchas)
*   [.NET - 常见问题](https://stackoverflow.com/questions/66117/aspnet-common-gotchas)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-09-09T14:39:51.457

```
"a,b,c,d,,,".split(",").length 
```

返回 4，**而不是**您可能（而且我确实*做到了*）期望的 7。`split`忽略返回的所有尾随空字符串。这意味着：

```
",,,a,b,c,d".split(",").length 
```

返回 7！要获得我认为的“最不令人惊讶”的行为，您需要做一些非常令人惊讶的事情：

```
"a,b,c,d,,,".split(",",-1).length 
```

得到 7。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-10-04T06:09:46.710

`==`使用而不是比较对象的相等性`.equals()`- 对于原语来说，它的行为完全不同。

这个问题可确保新手在`"foo" == "foo"`but时感到困惑`new String("foo") != new String("foo")`。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2008-10-04T09:30:36.367

我认为一个非常偷偷摸摸的`String.substring`方法。这将重新使用与`char[]`原始字符串相同的底层数组，并使用不同的`offset`and `length`。

这可能会导致非常难以察觉的内存问题。例如，您可能正在解析非常大的文件（`XML`也许）一小部分。如果您已将整个文件转换为 a `String`（而不是使用 a `Reader`“遍历”文件）并使用来获取所需的位，那么您仍然在幕后`substring`携带完整的文件大小的数组。`char[]`我已经看到这种情况发生了很多次，而且很难发现。

事实上，这是一个完美的例子，说明为什么*接口*永远不能与*实现*完全分离。几年前，这是一个完美的介绍（对我来说），为什么你应该怀疑 3rd 方代码的质量。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2008-10-04T08:37:33.790

覆盖 equals() 但不覆盖 hashCode()

使用地图、集合或列表时，它可能会产生非常意想不到的结果。

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2008-10-04T11:25:26.977

SimpleDateFormat 不是线程安全的。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2008-10-04T05:57:24.050

尝试阅读充满可怕内容的[Java Puzzlers](http://www.javapuzzlers.com/)，即使其中大部分内容不是您每天都会遇到的内容。但它会破坏你对语言的信心。

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2008-10-04T13:37:29.207

```
List<Integer> list = new java.util.ArrayList<Integer>();
list.add(1);
list.remove(1); // throws... 
```

旧的 API 在设计时并没有考虑到装箱，因此原语和对象重载。

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2008-10-04T22:16:18.473

有两个让我很恼火。

## 日期/日历

首先，Java Date 和 Calendar 类严重混乱。我知道有修复它们的建议，我只希望他们成功。

Calendar.get(Calendar.DAY_OF_MONTH) 从 1 开始
Calendar.get(Calendar.MONTH) 从**0 开始**

## 自动装箱防止思考

另一个是 Integer vs int（这适用于对象的任何原始版本）。这特别是由于不认为 Integer 与 int 不同而引起的烦恼（因为由于自动装箱，您可以在很多时候将它们视为相同）。

```
int x = 5;
int y = 5;
Integer z = new Integer(5);
Integer t = new Integer(5);

System.out.println(5 == x);     // Prints true
System.out.println(x == y);     // Prints true
System.out.println(x == z);     // Prints true (auto-boxing can be so nice)
System.out.println(5 == z);     // Prints true
System.out.println(z == t);     // Prints SOMETHING 
```

由于 z 和 t 是对象，即使它们具有相同的值，它们（很可能）是不同的对象。你真正的意思是：

```
System.out.println(z.equals(t));   // Prints true 
```

追踪这个可能会很痛苦。你去调试一些东西，一切看起来都很好，你最终发现你的问题是 5 != 5 当两者都是对象时。

能够说

```
List<Integer> stuff = new ArrayList<Integer>();

stuff.add(5); 
```

*太好*了。它使 Java 更加有用，不必将所有那些“new Integer(5)”和“((Integer) list.get(3)).intValue()”行放在所有地方。但是这些好处伴随着这个问题。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2008-10-18T18:08:16.923

我刚刚遇到的这个：

```
double[] aList = new double[400];

List l = Arrays.asList(aList);
//do intense stuff with l 
```

有人看到问题了吗？

* * *

发生的情况是，`Arrays.asList()`需要一个对象类型数组（例如，Double[]）。如果它只是为上一个 ocde 抛出错误，那就太好了。但是，`asList()`也可以采用如下参数：

```
Arrays.asList(1, 9, 4, 4, 20); 
```

所以代码所做的是`List`用一个元素创建 a - a `double[]`。

我应该想到什么时候需要 0 毫秒来对 750000 个元素的数组进行排序......

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2008-10-05T05:16:55.050

这个已经打败了我几次，我听说很多有经验的 Java 开发人员浪费了很多时间。

ClassNotFoundException --- 你知道类在类路径中，但你不确定为什么类没有被加载。

实际上，这个类有一个静态块。静态块中有一个异常，有人吃了这个异常。他们不应该。他们应该抛出 ExceptionInInitializerError。所以，总是寻找静态块来绊倒你。它还有助于将静态块中的任何代码移动到静态方法中，以便使用调试器更容易地调试方法。

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2008-10-05T12:26:51.610

花车

我不知道我见过多少次

```
floata == floatb 
```

“正确”测试应该在哪里

```
Math.abs(floata - floatb) < 0.001 
```

我真的希望带有文字语法的 BigDecimal 是默认的十进制类型......

* * *

## 回答 #12

> 赞同：13
> 
> 时间：2009-09-09T14:54:57.230

并非真正特定于 Java，因为许多（但不是所有）语言都以这种方式实现它，但该`%`运算符不是真正的模运算符，因为它适用于负数。这使它成为一个*余数*运算符，如果你不知道它可能会导致一些意外。

以下代码似乎打印“偶数”或“奇数”，但事实并非如此。

```
public static void main(String[] args)
{
    String a = null;
    int n = "number".hashCode();

    switch( n % 2 ) {
        case 0:
            a = "even";
            break;
        case 1:
            a = "odd";
            break;
    }

    System.out.println( a );
} 
```

问题是“数字”的哈希码是负数，所以`n % 2`开关中的操作也是负数。由于在 switch 中没有处理否定结果的情况，因此变量`a`永远不会被设置。程序打印出来`null`。

确保您知道`%`运算符如何处理负数，无论您使用哪种语言。

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2008-10-04T10:22:46.277

从事件分派线程外部操作 Swing 组件可能会导致极难发现的错误。即使我们（作为具有 3 和 6 年 Java 经验的经验丰富的程序员）也经常忘记这一点！有时这些错误会在正确编写代码并随后粗心重构之后潜入......

请参阅本[教程](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/dispatch.html)，为什么**必须**这样做。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2008-10-05T13:11:17.403

不可变字符串，这意味着某些方法不会更改原始对象，而是返回修改后的对象副本。在开始使用 Java 时，我常常忘记这一点，并想知道为什么 replace 方法似乎不适用于我的字符串对象。

```
String text = "foobar";
text.replace("foo", "super");
System.out.print(text); // still prints "foobar" instead of "superbar" 
```

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2009-09-09T14:47:39.873

我认为当我还是一名年轻的程序员时，我总是会遇到一个大问题，即从您正在迭代的数组中删除时的**并发修改异常：**

```
 List list = new ArrayList();
    Iterator it = list.iterator();
    while(it.hasNext()){
      //some code that does some stuff
      list.remove(0); //BOOM!
  } 
```

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2008-10-05T12:23:11.900

整数除法

```
1/2 == 0 not 0.5 
```

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2008-10-04T05:56:30.933

如果您有一个与构造函数同名但具有返回类型的方法。虽然这个方法看起来像一个构造函数（对于一个菜鸟），但它不是。

将参数传递给 main 方法——新手需要一些时间来适应。

路过。作为类路径的参数，用于在当前目录中执行程序。

意识到字符串数组的名称并不明显

hashCode 和 equals ：许多具有 5 年以上经验的 Java 开发人员并不太明白。

设置与列表

直到 JDK 6，Java 还没有 NavigableSets 可以让您轻松地遍历 Set 和 Map。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2011-05-02T10:28:53.097

使用`?`泛型通配符。

人们看到它并认为他们必须这样做，例如，`List<?>`当他们想要 a 时使用 a，`List`他们可以添加任何东西，而不会停下来认为 a`List<Object>`已经这样做了。然后他们想知道为什么编译器不让他们使用`add()`，因为 a`List<?>`真的意味着“我不知道的某种特定类型的列表”，所以你唯一能做的`List`就是从中获取`Object`实例。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2008-10-04T11:01:18.087

默认哈希是不确定的，因此如果用于 HashMap 中的对象，则该映射中条目的顺序可能会随着运行而改变。

作为一个简单的演示，以下程序可以根据运行方式给出不同的结果：

```
public static void main(String[] args) {
    System.out.println(new Object().hashCode());
} 
```

为堆分配多少内存，或者您是否在调试器中运行它，都可以改变结果。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2010-03-27T18:06:45.823

当您创建 a`[duplicate](http://java.sun.com/javase/8/docs/api/java/nio/ByteBuffer.html#duplicate())`或`[slice](http://java.sun.com/javase/8/docs/api/java/nio/ByteBuffer.html#slice())`a`[ByteBuffer](http://java.sun.com/javase/8/docs/api/java/nio/ByteBuffer.html)`时，它[不会从父缓冲区继承`order`属性](http://www.javamex.com/tutorials/io/nio_byte_order.shtml)的值，因此这样的代码不会达到您的预期：

```
ByteBuffer buffer1 = ByteBuffer.allocate(8);
buffer1.order(ByteOrder.LITTLE_ENDIAN);
buffer1.putInt(2, 1234);

ByteBuffer buffer2 = buffer1.duplicate();
System.out.println(buffer2.getInt(2));
// Output is "-771489792", not "1234" as expected 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2008-10-04T11:28:06.143

(un)Boxing 和 Long/long 混乱。与 Java 5 之前的经验相反，您可以在下面的第 2 行获得 NullPointerException。

```
Long msec = getSleepMsec();
Thread.sleep(msec); 
```

如果 getSleepTime() 返回 null，则取消装箱。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2008-10-04T21:59:10.817

在常见的陷阱中，众所周知但仍然偶尔会咬程序员，有`if (a = b)`在所有类 C 语言中都可以找到的经典陷阱。

当然，在 Java 中，它只有在 a 和 b 是布尔值时才能工作。但是我经常看到新手测试`if (a == true)`（虽然`if (a)`更短，更易读，更安全......）并且偶尔会写错`if (a = true)`，想知道为什么测试不起作用。
对于那些没有得到它的人：最后一条语句首先分配`true`给`a`，然后进行测试，总是成功！

-

一个吸引了很多新手，甚至是一些分心的更有经验的程序员（在我们的代码中找到它）`if (str == "foo")`，. 请注意，我一直想知道为什么 Sun 覆盖了字符串的 + 符号而不是 == 符号，至少对于简单的情况（区分大小写）。

对于新手：`==`比较引用，而不是字符串的内容。你可以有两个相同内容的字符串，存储在不同的对象（不同的引用）中，所以`==`会是假的。

简单的例子：

```
final String F = "Foo";
String a = F;
String b = F;
assert a == b; // Works! They refer to the same object
String c = "F" + F.substring(1); // Still "Foo"
assert c.equals(a); // Works
assert c == a; // Fails 
```

-

我也看到了`if (a == b & c == d)`或类似的东西。它可以（奇怪地）工作，但我们丢失了逻辑运算符快捷方式（不要尝试写：`if (r != null & r.isSomething())`！）。

对于新手：在评估时`a && b`，如果 a 为假，Java 不会评估 b。在`a & b`中，Java 评估这两个部分然后执行操作；但第二部分可能会失败。

[编辑] J Coombs 的好建议，我更新了我的答案。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2008-10-05T13:38:06.320

非统一类型系统与面向对象的思想相矛盾。即使所有东西都不必是堆分配的对象，程序员仍然应该被允许通过调用它们的方法来处理原始类型。

带有类型擦除的泛型类型系统实现是可怕的，当他们第一次学习 Java 中的泛型时，大多数学生都会放弃：如果已经提供了类型参数，为什么我们仍然需要进行类型转换？是的，它们确保了向后兼容，但代价相当低。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-10-04T09:35:21.817

我想指出的另一个原因是（过于普遍）使 API 通用化的驱动力。使用设计良好的通用代码很好。自己设计很复杂。**非常复杂！**

只需看看新 Swing 中的排序/过滤功能`JTable`。这是一场彻头彻尾的噩梦。很明显，您可能希望在现实生活中链接过滤器，但我发现如果不使用提供的类的原始类型版本，就不可能这样做。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-10-04T05:49:43.503

先说，今天抓到的。它与`Long`/`long`混乱有关。

```
public void foo(Object obj) {
    if (grass.isGreen()) {
        Long id = grass.getId();
        foo(id);
    }
}
private void foo(long id) {
    Lawn lawn = bar.getLawn(id);
    if (lawn == null) {
        throw new IllegalStateException("grass should be associated with a lawn");
    }   
} 
```

显然，为了保护无辜者，名称已被更改:)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2011-01-18T12:37:30.273

```
 System.out.println(Calendar.getInstance(TimeZone.getTimeZone("Asia/Hong_Kong")).getTime());
    System.out.println(Calendar.getInstance(TimeZone.getTimeZone("America/Jamaica")).getTime()); 
```

输出是一样的。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2011-09-26T16:57:46.733

我曾经调试过 TreeSet 有一些乐趣，因为我不知道来自 API 的这些信息：

> 请注意，如果要正确实现 Set 接口，集合维护的顺序（无论是否提供显式比较器）必须与 equals 一致。（参见 Comparable 或 Comparator 以获得与 equals 一致的精确定义。）这是因为 Set 接口是根据 equals 操作定义的，但是 TreeSet 实例使用其 compareTo（或 compare）方法执行所有键比较，所以两个从集合的角度来看，此方法认为相等的键是相等的。一个集合的行为是明确定义的，即使它的顺序与equals不一致；它只是不遵守 Set 接口的一般约定。 [http://download.oracle.com/javase/1.4.2/docs/api/java/util/TreeSet.html](http://download.oracle.com/javase/1.4.2/docs/api/java/util/TreeSet.html)

由于 compareTo 实现与 equals 不一致，因此添加了具有正确 equals/hashcode 实现的对象，并且再也没有看到过。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-10-05T13:04:59.100

恕我直言 1\. 使用 vector.add(Collection) 而不是 vector.addall(Collection)。第一个将集合对象添加到向量，第二个添加集合的内容。2\. 虽然与编程不完全相关，但使用来自多个来源（如 xerces、jdom）的 xml 解析器。依赖不同的解析器并将它们的 jar 放在类路径中是一场噩梦。

# mysql - 是否可以在单个查询中查询 MySQL 中的树结构表到任何深度？

> ID：169817
> 
> 赞同：58
> 
> 时间：2008-10-04T05:42:04.097
> 
> 标签：mysql, sql, database-design, data-structures, hierarchical-data

我认为答案是否定的，但我希望有人对如何在 SQL（MySQL）中将树结构爬行到任何深度有任何见解，但只需一个查询

更具体地说，给定一个树结构表（id、data、data、parent_id）和表中的一行，是否有可能获取*所有*后代（子/孙/等），或者就此而言所有祖先（父母/祖父母/etc) 不知道它会下降或上升多远，使用单个查询？

或者正在使用某种递归要求，我一直在深入查询直到没有新结果？

具体来说，我使用的是 Ruby 和 Rails，但我猜这不是很相关。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-04T06:55:15.197

是的，这是可能的，它被称为修改的预序树遍历，正如这里最好的描述

[Joe Celko 为 Smarties 编写的 SQL 中的树和层次结构](https://rads.stackoverflow.com/amzn/click/com/1558609202)

此处提供了一个工作示例（在 PHP 中）

[http://www.sitepoint.com/article/hierarchical-data-database/2/](http://www.sitepoint.com/article/hierarchical-data-database/2/)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-04T05:55:05.803

这里有几个资源：

*   [http://forums.mysql.com/read.php?10,32818,32818#msg-32818](http://forums.mysql.com/read.php?10,32818,32818#msg-32818)
*   [在 MySQL 中管理分层数据](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)
*   [http://lists.mysql.com/mysql/201896](http://lists.mysql.com/mysql/201896)

基本上，您需要在存储过程或查询中执行某种游标或构建邻接表。我会避免在数据库之外递归：取决于你的树有多深，这可能会变得非常慢/粗略。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-03-05T15:07:14.083

当您要问的主要问题是“我的孩子都是什么”和“我的父母都是什么”时，丹尼尔比尔兹利的回答根本不是一个糟糕的解决方案。

作为对 Alex Weinstein 的回应，与 Celko 技术相比，这种方法实际上导致对父移动节点的更新更少。在 Celko 的技术中，如果最左边的 2 级节点移动到最右边的 1 级节点之下，那么树中的几乎每个节点都需要更新，而不仅仅是节点的子节点。

然而，我要说的是，丹尼尔可能以错误的方式将路径存储回根目录。

我会存储它们，以便查询

```
SELECT FROM table WHERE ancestors LIKE "1,2,6%" 
```

这意味着 mysql 可以使用 'ancestors' 列上的索引，而它无法使用前导 % 来实现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-04T06:45:59.117

我之前遇到过这个问题并且有一个古怪的想法。您可以在每条记录中存储一个**字段，该字段是其直接祖先的 id 的串联字符串，**一直到根。

想象一下你有这样的记录（缩进意味着层次结构，数字是 id，祖先。

*   1、“1”
    *   2、“2,1”
        *   5、“5,2,1”
        *   6、“6,2,1”
            *   7, "7,6,2,1"
            *   11, "11,6,2,1"
    *   3、“3,1”
        *   8、“8,3,1”
        *   9、“9,3,1”
        *   10, "10,3,1"

然后**选择 id:6 的后代**，只需执行此操作

```
SELECT FROM table WHERE ancestors LIKE "%6,2,1" 
```

保持祖先列是最新的可能比它的价值更麻烦，但它在任何数据库中都是可行的解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-08T19:43:21.063

Celko 的技术（嵌套集）非常好。我还使用了一个包含“祖先”、“后代”和“距离”字段的邻接表（例如，直系子女/父母的距离为 1，孙子女/祖父母的距离为 2，等等）。

这需要维护，但对于插入来说相当容易：您使用事务，然后将直接链接（父，子，距离 = 1）放入表中，然后通过添加距离插入忽略现有父和子的选择（如果有机会，我可以调出 SQL），它希望在 3 个字段中的每一个上都有一个索引以提高性能。这种方法变得丑陋的地方是删除......你基本上必须标记所有受到影响的项目，然后重建它们。但是这样做的一个优点是它可以处理任意的无环图，而嵌套集模型只能做直接的层次结构（例如，除了根之外的每个项目都有一个且只有一个父级）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-04T06:07:57.337

SQL 不是图灵完备的语言，这意味着您将无法执行这种循环。您可以使用 SQL 和树结构做一些非常聪明的事情，但我想不出一种方法来描述在“其层次结构中”具有特定 id 的行，用于任意深度的层次结构。

你最好的选择是按照@Dan 的建议，即用其他更强大的语言在树中工作。您实际上可以使用循环以通用语言生成查询字符串，其中查询只是一些复杂的连接（或子查询）系列，它反映了您正在寻找的层次结构的深度。这将比循环和多个查询更有效。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-09T21:09:47.027

这绝对可以做到，对于 SQL 来说并不复杂。我已经回答了这个问题，并在此处提供了一个使用 mysql 程序代码的工作示例：

[MySQL：如何在特定节点中查找叶子](https://stackoverflow.com/questions/12796113/mysql-how-to-find-leaves-in-specific-node/12797585#12797585)

*Booth：如果您满意，您应该将其中一个答案标记为已接受。*

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-01-12T21:15:50.800

[我使用了https://stackoverflow.com/questions/27013093/recursive-query-emulation-in-mysql](https://stackoverflow.com/questions/27013093/recursive-query-emulation-in-mysql)中描述的“With Emulator”例程（由[https://stackoverflow.com/users/1726419/yossico](https://stackoverflow.com/users/1726419/yossico)提供）。到目前为止，我已经获得了非常好的结果（性能方面），但我没有大量数据或大量后代可供搜索/搜索。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-04T05:54:58.983

您几乎肯定会为此使用一些递归。如果你正在这样做，那么将整个树而不是它的一部分获得固定深度将是微不足道的（实际上更容易）。

在非常粗糙的伪代码中，您将需要以下内容：

```
getChildren(parent){
    children = query(SELECT * FROM table WHERE parent_id = parent.id)
    return children
}

printTree(root){
    print root
    children = getChildren(root)
    for child in children {
        printTree(child)
    }
} 
```

虽然在实践中你很少想做这样的事情。这将是相当低效的，因为它对表中的每一行都发出一个请求，所以它只适用于小表或嵌套不太深的树。老实说，无论哪种情况，您都可能想限制深度。

然而，鉴于这些数据结构的流行，很可能有一些 MySQL 的东西可以帮助你解决这个问题，特别是减少你需要进行的查询数量。

编辑：考虑到这一点，进行所有这些查询几乎没有意义。如果您无论如何都在阅读整个表格，那么您可以将整个表格放入 RAM - 假设它足够小！

# php - 对象关系映射：实现 getter 的最佳方式是什么？

> ID：169818
> 
> 赞同：4
> 
> 时间：2008-10-04T05:42:14.067
> 
> 标签：php, orm, oop, mapping

## 当我打电话时应该发生什么`$user->get_email_address()`？

### 选项 1：按需从数据库中提取电子邮件地址

```
public function get_email_address() {
    if (!$this->email_address) {
        $this->read_from_database('email_address');
    }
    return $this->email_address;
} 
```

### 选项 2：在创建对象时从数据库中提取电子邮件地址（和其他用户属性）

```
public function __construct(..., $id = 0) {
    if ($id) {
        $this->load_all_data_from_db($id);
    }
}

public function get_email_address() {
    return $this->email_address;
} 
```

我的基本问题是是否最好尽量减少数据库查询的数量，或者是否最好尽量减少从数据库传输的数据量。

另一种可能性是，最好在创建对象时加载您最需要的属性/包含最少的数据，并按需加载其他所有内容。

一个后续问题：像 Activerecord 这样的 ORM 抽象框架是做什么的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-04T07:33:28.223

这个真的没有正确答案。取决于您一次加载的用户数量、用户表中有多少文本/blob 字段、用户表是否加载任何关联的子对象。正如 aaronjensen 所说，这种模式称为**延迟加载**- 而相反的行为（预先加载*所有内容*以备不时之需）称为**急切加载**。

也就是说，您可能需要考虑第三种选择，即在访问 User 对象的任何属性时延迟加载整个 User 对象：

```
public function get_email_address() {
    if (!$this->email_address) {
        $this->load_all_data_from_db($this->id)
    }
    return $this->email_address;
} 
```

这种方法的优点是您可以仅根据他们的 ID 创建一个用户集合（例如，密码为空的所有用户的列表，也许？），而无需完全加载每个用户的内存命中，但您只需要每个用户的单个数据库调用以填充其余用户字段。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-04T05:44:42.233

尽量减少查询次数。最佳查询数为 0，但如果您因为未缓存而必须查询，则为 1。查询每个属性对于一个永远不会扩展、存在大量争用问题的系统来说无疑是一种可靠的方式，并且会导致比这是值得的。

*我应该提一下，如果*您不太可能需要延迟加载数据，那么延迟加载（这就是您在步骤 1 中所说的）是有价值的。但是，如果可以，最好是明确的，并准确或几乎准确地获取您需要的内容。花在查询上的时间越少，连接打开的时间就越少，系统的可扩展性就越高。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T06:02:56.567

我同意 aaronjensen 的观点，除非您提取的数据量太大以至于您将开始使用过多的内存。我在想一行有 3 个非常大的文本字段，而你想要的只是 ID 字段。

# sql-server - Visual Studio Team System 数据库版 (GDR) 的真正优势是什么？

> ID：169828
> 
> 赞同：19
> 
> 时间：2008-10-04T05:53:28.053
> 
> 标签：sql-server, database-tools

有兴趣是否有人广泛使用过 VSTS 数据库版，如果是，您发现哪些功能比标准 Visual Studio 数据库项目最有用？

与替代模式管理选项或 RedGate 的 SqlCompare 等工具相比，最引人注目的功能是什么？

**编辑**：微软刚刚发布了**RTM 版本的数据库版 (GDR)**，它增加了对 SQL Server 2008 的支持——链接在[这里](http://www.microsoft.com/downloads/details.aspx?FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed&displaylang=en)。我以前在这里写过（简短地）关于它的博客[。](http://internationalized.spaces.live.com/blog/cns!43F3A7682D1564E4!1177.entry)

有没有人有机会在东德做任何真正的工作？看起来有一些真正的增强，包括重构支持。我真的很想知道人们是否将它与 SQL Server 2008 一起使用...

下载自：[ [http://www.microsoft.com/downloads/details.aspx?FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed&displaylang=en]](http://www.microsoft.com/downloads/details.aspx?FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed&displaylang=en])

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-04T07:20:13.930

如果您将它与专门为 SQL Server 定制的 RedGates 等工具进行比较，其好处是，如果您拥有适当的 MSDN 订阅，则不必为其他工具花费更多的钱（但请记住，RedGate 工具要多得多成熟），它涵盖了其他工具没有涵盖的一些点（如回归测试和数据库级别的单元测试），并且它与VSTS的其他测试工具集成在一起，以便您可以在Team System中记录结果。
与 Embarcadero ErStudio（我选择的解决方案）之类的工具相比，它缺少跨数据库功能，这是一个大问题，至少对我来说是这样。
如果您是拥有正确 MSDN 订阅的“全微软”商店，那么花时间在上面可能是值得的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-04T10:06:37.823

我们在 Stack Overflow 上使用 Team Suite 的数据库版本功能。正如 Vaibhav 所说，**它主要是有用的，因为它为您提供了一种单击方式将数据库反向工程为源代码控制**，并使其保持最新状态。

请注意，它也有不错的数据和模式比较工具。您可以将项目与物理数据库进行比较，反之亦然。这使得使您的数据库保持最新状态变得非常容易，无论您在哪里进行更改——在文件系统数据库项目中，或在物理数据库本身中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-04T15:28:42.537

我们目前正在使用 GDR 2008 项目来管理我们在新建系统上的整个数据库开发和部署。我们使用 TFS 构建脚本来调用 MSBuild 任务以部署数据库，同时执行数据生成计划以使用数据预先填充测试环境。

数据生成计划的关键是找到要使用的构建任务：

```
TaskName="DataGeneratorTask"
AssemblyName="Microsoft.Data.Schema.Tasks, Version=9.1.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" 
```

所有这些 gdr 项目工作都非常有帮助，我认为了解这些项目类型非常值得学习曲线。它们提供的价值在生产力和可见性方面是天文数字。

它允许我们所有人在单个 Visual Studio 解决方案中查看整个系统，同时允许我们通过单击部署命令或自定义构建配置在任何时间点从一个干净的系统开始。

[如果您有兴趣，此博客](http://blog.benday.com/archive/2009/04/14/23221.aspx "使用 TFSBUild 创建 GDR 部署") 将帮助您运行 TFSBuild 脚本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-05T01:58:16.387

VSDB 测试集成配置起来非常痛苦，以至于我们放弃了它，而这是 Red-Gate 唯一没有的。

Red-Gate 的工具更有用。它在文件夹中提供实时数据库和脚本，但也有“快照”。Red-Gate SQL Compare 的优势在于它的快照功能以及您的许可证允许您部署他们的程序集并使用它们在客户运行时执行数据库维护的事实。

它使我开发的 COTS 应用程序的升级变得轻而易举。快照是二进制模式表示。您可以将它们打包为程序集中的资源，然后在客户运行时模式中使用快照比较以将现有数据库升级到当前版本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-23T07:28:04.373

可能最大的优势在于能够对单个数据库模式对象进行版本控制（您可以使用旧的“数据库项目”），但有能力“构建”/部署项目并将这些单独的脚本转换为完整的数据库.

如果您继承了数据库模式，那么导入脚本并让向导将单个模式项转换为单独的文件的能力非常方便。

鉴于最近许可模式发生了变化，它变得更加诱人，因为它包含在开发人员版 SKU 中。它还提供了对可能有用的“数据库单元测试”的支持。

从 2008 GDR，我了解到他们现在支持 SQL Server 2008。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-04T06:55:23.857

您可以为其中一个进行数据库版本控制。这很有用。

另一件真正有用的事情是能够定义用于测试的种子数据类型。通过这个 Visual Studio 将使用随机数据填充数据库，这非常适合测试目的。

当然还有其他好处。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-16T06:09:14.397

将所有内容置于同一个源代码控制之下总是很有用的，因此您的数据老兄可以搁置、签入、与历史记录进行比较，甚至可以使用其他团队成员使用的相同工具解决工作项和错误。

还能够在整个应用程序中使用一种版本控制机制，换句话说，说我的源代码控制具有我的项目的所有版本而您的数据库不适合这些旧版本中的任何一个是没有意义的，除非您在每次构建时都对数据库进行备份或快照。

# .net - INotifyPropertyChanging 和验证：我什么时候提出 PropertyChanging？

> ID：169829
> 
> 赞同：11
> 
> 时间：2008-10-04T05:53:57.537
> 
> 标签：.net, data-binding, events, change-tracking

INotifyPropertyChanged 是相当不言自明的，我想我很清楚何时提高那个（即当我完成更新值时）。
如果我实现 INotifyPropertyChanging，我倾向于在进入更改对象状态的设置器或其他方法后立即引发事件，然后继续进行可能发生的任何防护和验证。

因此，我将此事件视为属性可能更改但尚未更改的通知，并且可能实际上并未成功完成更改。

如果对象的使用者正在使用此属性（例如，假设 LINQ to SQL 使用事件进行更改跟踪），我是否应该推迟并仅在我确认我得到的值是好的并且只引发事件时对象的状态是否对更改有效？

此事件的合同是什么，订阅者会有什么副作用？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-04T06:07:37.570

如果您的对象被赋予对该属性无效的值并且您抛出异常，那么您不应该引发该`PropertyChanging`事件。仅当您决定该值*将*更改时，才应引发该事件。典型的使用场景是改变一个简单的字段：

```
public T Foo
 { get
    { return m_Foo;
    }
   set
    { if (m_Foo == value) return; //no need for change (or notification)
      OnPropertyChanging("Foo");
      m_Foo = value;
      OnPropertyChanged("Foo");
    }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T08:56:08.900

顺便说一句- [PostSharp](http://www.postsharp.org/)具有自动实现 INotifyPropertyChanged 的​​有趣能力 -[就像这样](http://code.google.com/p/postsharp-user-samples/wiki/DataBindingSupport)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T13:02:10.250

如果您想完全避免实现 INotifyPropertyChanged，请考虑改用[Update Controls .NET](http://codeplex.com/updatecontrols)。这消除了几乎所有的簿记代码。

# javascript - 如何使用 Javascript 将内容写入另一个浏览器窗口？

> ID：169833
> 
> 赞同：11
> 
> 时间：2008-10-04T05:54:36.147
> 
> 标签：javascript, dom

我用 window.open() 打开了一个新窗口，我想使用 window.open() 调用中的引用，然后将内容写入新窗口。我尝试使用 myWindow.document.body.innerHTML = oldWindowDiv.innerHTML; 将 HTML 从旧窗口复制到新窗口。但那是行不通的。有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-04T06:04:29.637

返回的引用`window.open()`是对子窗口`window`对象的引用。所以你可以做任何你通常会做的事情，这里有一个例子：

```
var myWindow = window.open('...')
myWindow.document.getElementById('foo').style.backgroundColor = 'red' 
```

请记住，这仅在父窗口和子窗口**具有相同域的**情况下才有效。否则跨站点脚本安全限制将阻止您。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-04T06:02:51.463

我认为这会成功。

```
 function popUp(){

    var newWindow = window.open("","Test","width=300,height=300,scrollbars=1,resizable=1")

    //read text from textbox placed in parent window
    var text = document.form.input.value

    var html = "<html><head></head><body>Hello, <b>"+ text +"</b>."
    html += "How are you today?</body></html>"

    newWindow .document.open()
    newWindow .document.write(html)
    newWindow .document.close()

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T07:43:25.817

Vijesh 提到的表单解决方案是在窗口之间传递数据的基本思想。如果你正在寻找一些库代码，有一个很棒的 jQuery 插件可以解决这个问题：WindowMsg（由于奇怪的 Stack Overflow 自动链接错误，请参阅底部的链接）。

正如我在此处的回答中所描述的：[如何在 GMail 中实现聊天窗口的弹出功能？](https://stackoverflow.com/questions/169862)WindowMsg 在每个窗口中使用一个表单，然后使用 window.document.form['foo'] 哈希进行通信。正如 Dan 上面提到的，这仅在窗口共享域时才有效。

同样如另一个线程中所述，您可以使用 JSON.org 中的 JSON 2 库来序列化 javascript 对象，以便以这种方式在窗口之间发送，而不必仅使用字符串进行通信。

窗口消息：

[http://www.sfpeter.com/2008/03/13/communication-between-browser-windows-with-jquery-my-new-plugin/](http://www.sfpeter.com/2008/03/13/communication-between-browser-windows-with-jquery-my-new-plugin/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-04T05:58:16.683

```
myWindow.document.writeln(documentString) 
```

# javascript - 如何在 GMail 中实现聊天窗口的弹出功能？

> ID：169862
> 
> 赞同：8
> 
> 时间：2008-10-04T06:21:20.133
> 
> 标签：javascript

我不是在寻找一个完整的实现，我对他们是如何做到的更感兴趣。我知道他们使用 GWT，但我想要一个更底层的答案。天真地，我会首先考虑当您单击弹出链接时，他们只是打开一个新窗口并将内容复制到其中。有很多原因导致效果不佳，所以我想知道是否有人知道或有关于他们如何做到这一点或如何做到这一点的想法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-04T07:27:09.470

我最近需要在应用程序中解决这个问题。我最终使用了这个很棒的小 jQuery 插件来解决这个问题：WindowMsg（请参阅底部的链接）虽然我确信还有其他方法可以完成相同的任务，但该插件确实可以正常工作：

*   首先，您使用 window.open 从原始窗口创建一个新的子窗口
*   您保存对 window.open 返回的窗口对象的引用
*   您在子窗口中调用库方法，该方法为库添加隐藏表单以将数据存储在
*   您在父窗口中调用一个库方法，该方法使用 window.document.forms 来填充子窗口上的表单字段（该库抽象了所有这些内容，因此除非您查看源代码，否则您甚至不会知道涉及表单) window.document.forms 在所有主流浏览器上的工作方式都是一样的，所以这个抽象在 x-browser 兼容
*   最后，子窗口使用 window.opener 引用其父窗口，并且可以通过父窗口上的并行隐藏表单进行通信
*   该库实现了一个方便的助手，该助手在每一端运行一个回调函数，以使回调链易于处理

根据我使用该库的经验，如果他们包含来自 JSON.org 的 JSON 2 库，那也将非常好。开箱即用，WindowMsg 只允许您在窗口之间发送字符串消息，但是通过对 JSON 2 库的一些非常简单的使用，我能够破解它以允许在窗口之间发送完整的 JSON 对象。我敢打赌，更成熟的库（例如谷歌使用的任何库）都包含这种序列化和反序列化。

我把这个链接放在这里是因为出于某种原因，Stack Overflow 格式化程序将它变成了一个没有结束标签的锚链接，我不希望我的整个帖子成为一个巨大的超链接！

[窗口消息： http](http://www.sfpeter.com/2008/03/13/communication-between-browser-windows-with-jquery-my-new-plugin/) ://www.sfpeter.com/2008/03/13/communication-between-browser-windows-with-jquery-my-new-plugin/

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T08:31:10.340

我想说最简单的方法是将数据存储在服务器上（您可能已经这样做了），然后让新窗口检索该数据。

当然，这不会保留用户输入的文本框内容之类的内容，因此根据窗口的用途，这可能是不切实际的..但最好开始尝试最简单的选项！

# c# - 将 Microsoft Word 中的图片导出为 TIFF

> ID：169866
> 
> 赞同：1
> 
> 时间：2008-10-04T06:30:21.770
> 
> 标签：c#, vsto

如何使用 Visual Studio Tools for Office 将 Microsoft Word 中的图片导出为 TIFF 文件？我可以获得对图片的引用作为 InlineShape 对象集合，现在困难的部分是如何将它们保存为 TIFF 图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T07:04:36.380

好的，伙计们，我的问题解决了。这是代码片段：

```
 private void SaveToImage(Word.InlineShape picShape, string filePath)
    {
        picShape.Select();
        theApp.Selection.CopyAsPicture();
        IDataObject data = Clipboard.GetDataObject();
        if (data.GetDataPresent(typeof(Bitmap)))
        {
            Bitmap image = (Bitmap)data.GetData(typeof(Bitmap));
            image.Save(filePath);
        }
    } 
```

希望能帮助到你 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-04T06:53:32.500

好。不确定这是否有帮助，但如果你对 jpegs 没问题，那么从 Word 2007 文件中提取图像的一种非常酷的技术如下：

1.  将 .docx 文件重命名为 .zip。
2.  在（现在）zip 文件下，转到以下路径：word/media。
3.  文档中的所有图像都可以在这里找到为 jpeg 文件。

干杯。

# language-agnostic - 测试用例，“何时”、“什么”和“为什么”？

> ID：169877
> 
> 赞同：6
> 
> 时间：2008-10-04T06:49:09.640
> 
> 标签：language-agnostic, tdd

作为基于测试的开发的新手，这个问题一直困扰着我。多少是太多了？应该测试什么，应该如何测试，为什么要测试？给出的示例是在 C# 中使用 NUnit，但我认为问题本身与语言无关。

这是我自己的两个当前示例，对通用列表对象的测试（使用字符串进行测试，初始化函数添加了三个项目`{"Foo", "Bar", "Baz"}`）：

```
[Test]
public void CountChanging()
{
    Assert.That(_list.Count, Is.EqualTo(3));
    _list.Add("Qux");
    Assert.That(_list.Count, Is.EqualTo(4));
    _list[7] = "Quuuux";
    Assert.That(_list.Count, Is.EqualTo(8));
    _list.Remove("Quuuux");
    Assert.That(_list.Count, Is.EqualTo(7));
}

[Test]
public void ContainsItem()
{
    Assert.That(_list.Contains("Qux"), Is.EqualTo(false));
    _list.Add("Qux");
    Assert.That(_list.Contains("Qux"), Is.EqualTo(true));
    _list.Remove("Qux");
    Assert.That(_list.Contains("Qux"), Is.EqualTo(false));
} 
```

该代码是相当自我注释的，所以我不会详细说明正在发生的事情，但是这种事情是否太过分了？`Add()`并且`Remove()`当然是单独测试的，那么我应该通过这些测试达到什么水平？我什至应该进行这些测试吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-04T07:37:29.840

我会说你实际测试的是等价类。在我看来，添加到包含 3 个项目或 7 个项目的列表没有区别。但是，0 项、1 项和 >1 项之间存在差异。对于这些情况，我最初可能会对 Add/Remove 方法进行 3 次测试。

一旦质量检查/用户开始出现错误，我会将每个这样的错误报告添加为测试用例；通过获得红色条查看错误重现；通过获得绿色条来修复错误。每一个这样的“错误检测”测试都会保留下来——这是我的安全网（阅读：回归测试），即使我再次犯这个错误，我也会得到即时反馈。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-04T06:57:16.643

将您的测试视为规范。如果您的系统可以在测试失败的情况下发生故障（或存在重大错误），那么您的测试覆盖率就不够了。如果一个单点故障导致许多测试中断，那么您可能有太多（或过于紧密耦合）。

这真的很难以客观的方式定义。我想我会在测试太多方面说错误。然后，当测试开始让您烦恼时，这些就是要重构/重新调整用途的特定测试（因为它们太脆弱，或者测试错误的东西，并且它们的失败没有用）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-04T07:05:14.897

一些提示：

1.  每个测试用例应该只测试一件事。这意味着测试用例的结构应该是“setup”、“execute”、“assert”。在您的示例中，您混合了这些阶段。尝试拆分您的测试方法。这样可以更轻松地准确查看您正在测试的内容。

2.  试着给你的测试方法起一个描述它正在测试什么的名字。即包含在您的 ContainsItem() 中的三个测试用例变为： containsReportsFalseIfTheItemHasNotBeenAdded()、 containsReportsTrueIfTheItemHasBeenAdded()、 containsReportsFalseIfTheItemHasBeenAddedThenRemoved()。我发现强迫自己想出一个这样的描述性名称有助于我在编写实际测试代码之前概念化我必须测试的内容。

3.  如果您使用 TDD，您应该首先编写测试，并且只有在测试失败时才将代码添加到您的实现中。即使您实际上没有这样做，它也会让您了解多少测试就足够了。或者使用覆盖工具。对于像容器这样的简单类，您应该以 100% 的覆盖率为目标。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-04T06:56:33.323

是`_list`您编写的类的实例吗？如果是这样，我会说测试它是合理的。尽管在那种情况下，您为什么要构建自定义 List 类？

如果它不是您编写的代码，请不要测试它，除非您怀疑它在某种程度上存在错误。

* * *

我尝试测试独立和模块化的代码。如果我必须维护代码中的某种上帝功能，我会尽可能多地将其剥离成子功能并独立测试它们。那么 God 函数可以写成“明显正确”——没有分支，没有逻辑，只是将结果从一个经过良好测试的子函数传递到另一个。

# ruby-on-rails - Rspec - 从插件切换到宝石的问题

> ID：169888
> 
> 赞同：2
> 
> 时间：2008-10-04T06:58:40.557
> 
> 标签：ruby-on-rails, ruby, rubygems, rspec, gem

当放弃使用 rspec 和 rspec-rails 插件并改用 gem 版本时，我是否需要在 spec_helper.rb 中进行任何额外的更改，或者让我的应用程序中的规范看到更改？

删除插件并安装 gem (1.1.8) 后，我无法再让我的规范成功运行。

更具体地说，这就是我所做的：

1.  从供应商目录中删除以前安装的 rspec 和 rspec-rails 插件
2.  sudo 安装了 rspec 和 rspec-rails gems（1.1.8 是撰写本文时的最新版本）

运行脚本/autospec 时，我收到以下消息：

> /Library/Ruby/Site/1.8/rubygems.rb:578:in `report_activate_error': RubyGem version error: hoe(1.5.0 not >= 1.7.0) (Gem::LoadError) from /Library/Ruby/Site/1.8/rubygems.rb:134:in`activate' from /Library/Ruby/Site/1.8/rubygems.rb:158:in `activate' from /Library/Ruby/Site/1.8/rubygems.rb:157:in`each' from /Library/Ruby/Site/1.8/rubygems.rb :157:in `activate' from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in`require' 来自 /Library/Ruby/Gems/1.8/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:509:in `require' from /Library/Ruby/Gems/1.8/gems/activesupport-2.1.0/lib/active_support/dependencies.rb:354:in`new_constants_in' 来自 /Library/Ruby/Gems/1.8/gems/activesupport -2.1.0/lib/active_support/dependencies.rb:509:in`require' from /Volumes/tangoflash/code/tangoflash/spec/spec_helper.rb:5 from spec/helpers/sessions_helper_spec.rb:1:in`来自 spec/helpers/sessions_helper_spec.rb:1

尝试通过 textmate 运行单个 rspec 示例时，我得到：

> /Library/Ruby/Site/1.8/rubygems.rb:578:in `report_activate_error': RubyGem version error: hoe(1.5.0 not >= 1.7.0) (Gem::LoadError) from /Library/Ruby/Site/1.8/rubygems.rb:134:in`activate' from /Library/Ruby/Site/1.8/rubygems.rb:158:in `activate' from /Library/Ruby/Site/1.8/rubygems.rb:157:in`each' from /Library/Ruby/Site/1.8/rubygems.rb :157:in`activate' from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in`来自 /Users/allanlibunao/Library/Application Support/TextMate/Bundles/RSpec.tmbundle/Support/lib/spec/mate.rb:14 来自 /tmp/temp_textmate.KQTYKh:3:in `require'来自 /tmp/temp_textmate.KQTYKh:3

任何帮助都是极好的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-04T10:58:19.293

从您的错误消息看来，您没有安装最新版本的`hoe`gem。尝试做一个`gem install hoe --version '> 1.7.0`，看看它是否有帮助。可能是当您安装`rspec`和`rspec-rails`gems 时，您也没有获得依赖项，并且可能缺少其他依赖项 gem。

# php - 自动部署 PHP 应用程序的最佳流程/应用程序是什么？

> ID：169889
> 
> 赞同：5
> 
> 时间：2008-10-04T07:00:38.620
> 
> 标签：php, deployment

还有另一篇关于 .NET 的关于 SO 的帖子——不是我们。纯PHP。试图找到部署 PHP 应用程序稳定版本的最佳方式/流程。我看过一篇关于[Capistrano](http://www.simplisticcomplexity.com/2006/8/16/automated-php-deployment-with-capistrano/)的文章，但我很好奇那里还有什么。除了显而易见的原因之外，我还希望添加一些脚本，以便在其中[添加 SVN rev 编号](https://stackoverflow.com/questions/111436/how-can-i-get-the-svn-revision-number-in-php)。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T07:48:10.583

我使用国产脚本已经有一段时间了。它将（基于应用程序配置文件）：

1.  `svn export`基于标签在存储库上运行。
2.  将导出打包成 tar 或 zip 文件，其中包含名称中的标记。
3.  用于`scp`将包复制到适当的服务器（QA 或发布）。
4.  连接到服务器`ssh`以安装软件包并运行安装后脚本。

应用程序配置文件是项目的一部分。它可以告诉脚本（在第 2 步）去除路径并以其他方式处理指定的文件。它还指定服务器名称以及如何处理外部。

我最近迁移了脚本以支持 Git 和 Subversion。我也可能会将它迁移到 PHP，因为我们现在在混合（Linux 和 Windows）设置中运行，Linux 现在占少数。

我计划用 post-commit 钩子自动调用脚本，但还没有实现它的需要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-04T15:45:40.900

巧合的是，我刚刚阅读了一个名为[Phing](http://phing.info)的 Apache Ant/gnu make 之类的构建工具。我喜欢它的是能够在 PHP中编写[自定义扩展！](http://phing.info/docs/guide/current/chapters/ExtendingPhing.html#WritingTasks)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-04T07:51:46.080

我不知道它是否适用于实时部署应用程序，但[phpUnderControl](http://www.phpundercontrol.org/)是一个持续集成套件（我刚刚开始研究）。如果它本身不支持进行部署，则可以扩展它来进行部署。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-04T10:21:09.570

[Chris Hartjes](http://www.littlehart.net/atthekeyboard/)对此有很好的看法：[Deployment is not a 4 letter word](http://www.littlehart.net/atthekeyboard/2008/04/17/deployment-is-not-a-4-letter-word-the-screencast/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-04T22:51:29.613

我们使用[Webistrano](https://github.com/peritor/webistrano)来部署几十个项目，它是 Capistrano 的 Web 前端。它构建为 Ruby on Rails 应用程序，并为 Capistrano 部署提供了一个漂亮、集中且一致的用户界面。

Webistrano 不是在每个项目中都有上限配方并运行命令行工具，而是将配方存储在其数据库中，并允许您将配方附加到多个项目和阶段。这减少了脚本的重复。

还不错的是所有部署日志都被存储，所以有一个审计线索。谁将哪个修订版部署到实时服务器，诸如此类。

根据您的要求，修订号也存储在部署的项目中。

总而言之，我们对此非常满意。

# javascript - 在 Flot 中，是否可以在不消除相应标签的情况下消除或隐藏网格刻度？

> ID：169894
> 
> 赞同：17
> 
> 时间：2008-10-04T07:05:12.167
> 
> 标签：javascript, jquery, graph, flot

Flot [API 文档](http://flot.googlecode.com/svn/trunk/API.txt)描述了该库用于自定义图形轴的大量钩子。您可以为每个轴分别设置刻度数、颜色等。但是，我不知道如何防止 Flot 在不删除 x 轴标签的情况下绘制垂直网格线。我尝试更改 tickColor、ticks 和 tickSize 选项，但没有成功。

我想创建漂亮的、与 Tufte 兼容的图表，例如：

[http://www.robgoodlatte.com/wp-content/uploads/2007/05/tufte_mint.gif](http://www.robgoodlatte.com/wp-content/uploads/2007/05/tufte_mint.gif) [http://www.argmax.com/mt_blog/archive/RealGDP_graph.jpg](http://www.argmax.com/mt_blog/archive/RealGDP_graph.jpg)

我发现我的图表上的垂直刻度是图表垃圾。我正在处理一个显示为垂直条的时间序列，因此垂直刻度通常以一种视觉上嘈杂的方式穿过这些条。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2011-01-14T20:11:10.370

As Laurimann noted, Flot continues to evolve. The ability to control this has been added to the API (as noted in the flot issue Nelson linked to).

If you download the latest version (which is still labeled 0.6), you can disable lines on an axis with "tickLength", like so:

```
xaxis: {
  tickLength: 0
} 
```

Rather annoyingly, this addition hasn't been updated in the API documentation.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-12-31T11:08:46.820

This post comes over two years later than OP and Flot (now version 0.6) might have evolved a lot during that time or maybe there's better options than it around but in either case here's my contribution.

I accidentally bumped into a workaround for this problem: set grid's tick color's alpha channel to fully transparent. For example:

```
var options =   {
      grid:   {show: true,
               color: "rgb(48, 48, 48)",
               tickColor: "rgba(255, 255, 255, 0)",
               backgroundColor: "rgb(255, 255, 255)"}
    }; 
```

Works for me.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-06T11:57:35.507

经过一番挖掘，我很确定通过 Flot API 是不可能的。不过，如果你真的很脏，你可以这样做——我已经发布了[一个例子的修改版本](http://gyoshev.net/temp/stackoverflow/flot.html)。*查看源代码*显示了整个丑陋。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-02-19T06:14:18.797

To Avoid ticks in the options just give ticks:[] in the corresponding axis

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-18T18:47:26.420

从 2009 年 6 月开始，[flot 问题 167](http://code.google.com/p/flot/issues/detail?id=167)是对这个确切功能的请求。包括两个实现和一些来自 flot 作者的一致意见，认为这是一个好主意。

# python - 如何用py2exe打包Twisted程序？

> ID：169897
> 
> 赞同：11
> 
> 时间：2008-10-04T07:08:05.390
> 
> 标签：python, twisted, py2exe

我试图用 py2exe 打包一个 Twisted 程序，但是一旦我运行我构建的 exe 文件，我得到一个“没有名为资源的模块”错误。

我发现 py2exe 说：

> 以下模块似乎缺少 ['FCNTL', 'OpenSSL', 'email.Generator', 'email.Iterators', 'email.Utils', 'pkg_resources', 'pywintypes', 'resource', 'win32api', 'win32con'、'win32event'、'win32file'、'win32pipe'、'win32process'、'win32security']

那么我该如何解决这个问题呢？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-04T07:21:29.810

我以前见过这个... py2exe，出于某种原因，没有检测到 ZIP 存档中需要这些模块，而是将它们排除在外。

您可以明确指定要包含在 py2exe 命令行中的模块：

```
python setup.py py2exe -p win32com -i twisted.web.resource 
```

类似的东西。阅读选项和实验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-23T22:10:36.217

电子邮件模块有同样的问题。我通过在 setup.py 中明确包含模块来使其工作：

旧的 setup.py：

```
setup(console = ['main.py']) 
```

新的 setup.py：

```
setup(console = ['main.py'], 
      options={"py2exe":{"includes":["email.mime.multipart","email.mime.text"]}}) 
```

# graphics - 投影变换

> ID：169902
> 
> 赞同：12
> 
> 时间：2008-10-04T07:14:14.893
> 
> 标签：graphics, image-processing

给定两个图像缓冲区（假设它是一个大小为宽度 * 高度的整数数组，每个元素都有一个颜色值），我如何将一个由四边形定义的区域从一个图像缓冲区映射到另一个（始终为正方形）图像缓冲区？我被引导理解这被称为“投影变换”。

我也在寻找一种通用的（不是特定于语言或库的）方法，以便它可以合理地应用于任何语言，而不依赖于“为我完成所有工作的魔法函数 X”。

一个例子：我使用处理库 (processing.org) 用 Ja​​va 编写了一个简短的程序，该程序从相机捕获视频。在初始“校准”步骤中，捕获的视频直接输出到窗口中。然后用户点击四个点来定义将要转换的视频区域，然后在程序的后续操作期间映射到方形窗口。如果用户在摄像机输出中单击定义以某个角度可见的门角的四个点，则此转换将导致后续视频将转换后的门的图像映射到窗口的整个区域，尽管有点扭曲。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-03-31T09:29:36.447

使用线性代数比所有几何都容易得多！另外，您不需要使用正弦、余弦等，因此您可以将每个数字存储为有理分数，并在需要时获得准确的数值结果。

您想要的是从旧 (x,y) 坐标到新 (x',y') 坐标的映射。你可以用矩阵来做。您需要找到 2×4 投影矩阵 P 使得 P 乘以旧坐标等于新坐标。我们假设您将线映射到线（例如，不是直线到抛物线）。因为您有投影（平行线不保持平行）和平移（滑动），所以您也需要 (xy) 和 (1) 的因子。绘制为矩阵：

```
 [x  ]
[a b c d]*[y  ] = [x']
[e f g h] [x*y]   [y']
          [1  ] 
```

你需要知道 a 到 h 所以求解这些方程：

```
a*x_0 + b*y_0 + c*x_0*y_0 + d = i_0
a*x_1 + b*y_1 + c*x_1*y_1 + d = i_1
a*x_2 + b*y_2 + c*x_2*y_2 + d = i_2
a*x_3 + b*y_3 + c*x_3*y_3 + d = i_3

e*x_0 + f*y_0 + g*x_0*y_0 + h = j_0
e*x_1 + f*y_1 + g*x_1*y_1 + h = j_1
e*x_2 + f*y_2 + g*x_2*y_2 + h = j_2
e*x_3 + f*y_3 + g*x_3*y_3 + h = j_3 
```

同样，您可以使用线性代数：

```
[x_0 y_0 x_0*y_0 1]   [a e]   [i_0 j_0]
[x_1 y_1 x_1*y_1 1] * [b f] = [i_1 j_1]
[x_2 y_2 x_2*y_2 1]   [c g]   [i_2 j_2]
[x_3 y_3 x_3*y_3 1]   [d h]   [i_3 j_3] 
```

为 x_n、y_n、i_n、j_n 插入你的角。（角落的效果最好，因为如果你从用户点击中挑选点，它们相距很远可以减少错误。）取 4x4 矩阵的倒数并将其乘以等式的右侧。该矩阵的转置是 P。您应该能够找到计算矩阵逆和在线乘法的函数。

您可能会遇到错误的地方：

*   计算时，记得检查除以零。这表明您的矩阵不可逆。如果您尝试将一个 (x,y) 坐标映射到两个不同的点，则可能会发生这种情况。
*   如果您编写自己的矩阵数学，请记住矩阵通常指定为行、列（垂直、水平），屏幕图形为 x,y（水平、垂直）。你第一次肯定会出错。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-04T10:59:46.327

**编辑**

下面关于角度比不变性的假设是不正确的。相反，投影变换保留了交叉比率和发生率。那么解决方案是：

1.  在由段 AD 和 CP 定义的线的交点处找到点 C'。
2.  在由线段 AD 和 BP 定义的线的交点处找到点 B'。
3.  确定B'DAC'的交叉比，即r = (BA' * DC') / (DA * B'C')。
4.  构造投影线 F'HEG'。这些点的交叉比等于r，即r = (F'E * HG') / (HE * F'G')。
5.  F'F 和 G'G 将在投影点 Q 处相交，因此使交叉比率相等并知道正方形边的长度，您可以通过一些算术体操来确定 Q 的位置。

* * *

嗯....我会试一试这个。该解决方案依赖于在转换中保留角度比率的假设。请参阅图像以获取指导（抱歉图像质量差……真的太晚了）。该算法仅提供四边形中的点到正方形中的点的映射。您仍然需要实现处理映射到同一个正方形点的多个四边形点。

设 ABCD 为四边形，其中 A 为左上顶点，B 为右上顶点，C 为右下顶点，D 为左下顶点。对 (xA, yA) 表示顶点 A 的 x 和 y 坐标。我们将这个四边形中的点映射到边长等于 m 的正方形 EFGH。

![替代文字](https://i.stack.imgur.com/tPION.gif)

计算长度 AD、CD、AC、BD 和 BC：

```
AD = sqrt((xA-xD)^2 + (yA-yD)^2)
CD = sqrt((xC-xD)^2 + (yC-yD)^2)
AC = sqrt((xA-xC)^2 + (yA-yC)^2)
BD = sqrt((xB-xD)^2 + (yB-yD)^2)
BC = sqrt((xB-xC)^2 + (yB-yC)^2) 
```

令 thetaD 为顶点 D 处的角度，thetaC 为顶点 C 处的角度。使用余弦定律计算这些角度：

```
thetaD = arccos((AD^2 + CD^2 - AC^2) / (2*AD*CD))
thetaC = arccos((BC^2 + CD^2 - BD^2) / (2*BC*CD)) 
```

我们将四边形中的每个点 P 映射到正方形中的点 Q。对于四边形中的每个点 P，请执行以下操作：

*   求距离 DP：

    ```
    DP = sqrt((xP-xD)^2 + (yP-yD)^2) 
    ```

*   求距离 CP：

    ```
    CP = sqrt((xP-xC)^2 + (yP-yC)^2) 
    ```

*   求 CD 和 DP 之间的角度 thetaP1：

    ```
    thetaP1 = arccos((DP^2 + CD^2 - CP^2) / (2*DP*CD)) 
    ```

*   求 CD 和 CP 之间的角度 thetaP2：

    ```
    thetaP2 = arccos((CP^2 + CD^2 - DP^2) / (2*CP*CD)) 
    ```

*   thetaP1 与 thetaD 的比值应该是 thetaQ1 与 90 的比值。因此，计算 thetaQ1：

    ```
    thetaQ1 = thetaP1 * 90 / thetaD 
    ```

*   同样，计算 thetaQ2：

    ```
    thetaQ2 = thetaP2 * 90 / thetaC 
    ```

*   求距离总部：

    ```
    HQ = m * sin(thetaQ2) / sin(180-thetaQ1-thetaQ2) 
    ```

*   最后，Q 相对于 EFGH 左下角的 x 和 y 位置为：

    ```
    x = HQ * cos(thetaQ1)
    y = HQ * sin(thetaQ1) 
    ```

您必须跟踪有多少颜色值映射到正方形中的每个点，以便您可以计算每个点的平均颜色。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-04T10:02:45.210

我认为你所追求的是平面单应性，看看这些讲义：

[http://www.cs.utoronto.ca/~strider/vis-notes/tutHomography04.pdf](http://www.cs.utoronto.ca/~strider/vis-notes/tutHomography04.pdf)

如果你向下滚动到最后，你会看到一个你所描述的例子。我希望英特尔 OpenCV 库中有一个函数可以做到这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-04T16:28:46.333

如果此转换必须看起来不错（与在 Paint 中调整位图大小相反），您不能只创建一个将目标像素映射到源像素的公式。目标缓冲区中的值必须基于附近源像素的复杂平均，否则结果将高度像素化。

因此，除非您想进行一些复杂的编码，否则请**使用其他人的魔法函数**，正如 smacl 和 Ian 所建议的那样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-04T08:35:54.433

CodeProject 上有一个[C++ 项目](http://www.codeproject.com/KB/graphics/CBitmapEx.aspx)，其中包括位图投影变换的源代码。数学在 Wikipedia上[。](http://en.wikipedia.org/wiki/Projective_transformation)请注意，据我所知，投影变换不会将任意四边形映射到另一个四边形，但会为三角形映射，您可能还想查找倾斜变换。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-04T10:45:07.417

原则上是这样的：

*   通过平移向量将 A 的原点映射到 B 的原点`t`。
*   取 A (1,0) 和 (0,1) 的单位向量并计算它们如何映射到 B 的单位向量上。
*   这给了你一个变换矩阵**M**以便`a`A 中的每个向量都映射到**M** `a` +`t`
*   反转矩阵并否定平移向量，因此对于`b`B 中的每个向量，您都有逆映射`b`-> **M ^(-1)** ( `b`- `t`)
*   一旦你有了这个转换，对于B中目标区域的每个点，在A中找到对应的并复制。

这种映射的优点是你只计算你需要的点，即你在*目标*点上循环，而不是*源*点。这是几年前“演示编码”场景中广泛使用的技术。

# .net - 我可以在不需要管理员权限的情况下侦听 Vista 上的端口（使用 HttpListener 或其他 .NET 代码）吗？

> ID：169904
> 
> 赞同：41
> 
> 时间：2008-10-04T07:14:50.773
> 
> 标签：.net, windows-vista, permissions

我正在使用 HttpListener 允许用户在用户定义的端口上设置代理。当我启动 HttpListener 时，如果应用程序没有在 Vista 中以管理员权限运行，则会出现异常。

根据我的阅读，[这是预期的行为](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=93940)- 需要管理员权限才能开始侦听端口。但我确信有办法解决这个问题，因为我运行了大量程序（如 Skype），它们在端口上侦听而不需要提升到管理员权限。

有没有办法用 HttpListener 做到这一点？如果没有，我可以在 .NET 代码中调用其他 API 来设置端口吗？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2008-10-12T09:03:02.210

虽然您可以使用普通的 TCP/IP（它相对简单）编写自己的 HTTP 服务器，但使用 HttpListener 更容易，它利用了 Windows XP SP2 中添加的 HTTP.SYS 功能。

但是，HTTP.SYS 添加了 URL ACL 的概念。这部分是因为 HTTP.SYS 允许您绑定到端口 80 上的子命名空间。直接使用 TCP/IP 可以避免此要求，但意味着您不能绑定到已经在使用的端口。

在 Windows XP 上，您可以使用 HttpCfg.exe 程序设置 URL ACL，授予您的用户帐户绑定到特定 URL 的权限。它在 Platform SDK 示例中。

在 Windows Vista 上，仍然支持 HTTPCFG，但该功能已被 NETSH 吸收：

```
netsh http show urlacl 
```

...将显示现有 URL ACL 的列表。ACL 以 SDDL 表示。

```
netsh http add urlacl url=http://+:80/MyUri user=DOMAIN\User listen=yes 
```

...将配置 MyURI 命名空间，以便 DOMAIN\User 可以监听请求。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-03-23T16:24:26.140

如果您只需要处理来自您自己计算机的请求（通常用于测试目的），您可以在前缀中写入**localhost而不是 *。**

例如，您可以写成“http://localhost:9669/”，而不是“http://*:9669/”。这适用于 HttpListener 并且不需要管理权限（至少在 Windows 7 上）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-04T07:58:52.120

我从未使用过 HttpListener，但从您的描述来看，这听起来更像是您想在常规 TCP 端口上侦听，而不是将您的应用程序嵌入到服务器 URL 命名空间中（这是 HttpListener 似乎要做的）。您应该能够使用常规套接字函数 (System.Net.Sockets.TcpListener) 打开和侦听 TCP 端口，而无需管理员权限。我几乎可以肯定 Skype 不使用 HttpListener。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-07-12T12:00:16.030

好吧，我不得不处理类似的事情。我的电脑在受限域中，所以我没有管理员权限。经过一些研究和阅读后，我发现了这个线程，并且 netsh 提示让我使用临时 acl 绑定来开发测试。在我的电脑上，这些规则存在。

有这个条目：

运行“netsh http show urlacl”（如上图）

```
 [...]
        Reservierte URL            : http://+:80/Temporary_Listen_Addresses/
            Benutzer: \Jeder
                Abhören: Yes
                Delegieren: No
                SDDL: D:(A;;GX;;;WD)
    [...] 
```

所以我可以将 HttpListener 用作非管理员（Jeder）：

```
 [...]
    HttpListener l = new HttpListener();
    string prefix = "http://+:80/Temporary_Listen_Addresses/";
    l.Prefixes.Add(prefix);
    l.Start(); // does not throw any "Permission Denied/Access Denied/Zugriff verweigert"
    [...] 
```

愿这有助于任何人找到这个线程。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-04T08:45:24.350

在 XP 中，您必须先使用命令行 (httpcfg) 打开端口，否则非管理员无法使用。

请参阅[此处](http://www.oreillynet.com/windows/blog/2005/09/httplistener_and_nonadmin.html)- 该页面解释了该问题，底部有一个[拉链](http://www.leastprivilege.com/content/binary/HttpCfgAcl.zip)以使其可用。

# windows - Windows XP 上保存的“运行”对话框的历史记录在哪里？

> ID：169905
> 
> 赞同：1
> 
> 时间：2008-10-04T07:17:00.473
> 
> 标签：windows, windows-xp

我想编写一个脚本，它会在每次注销时自动清理“运行”对话框。历史存储在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-04T07:20:45.177

从：

[如何从运行命令历史记录中删除单个条目](http://www.pchell.com/support/editrunmrulistentries.shtml)

> 运行 MRU（最近使用）列表在哪里？
> 
> RUNMRU 列表存储在 Windows 注册表中的以下位置：
> 
> HKEY_CURRENT_USER\ Software\ Microsoft\ Windows\ CurrentVersion\ Explorer\ RunMRU\
> 
> 是否有从 RUNMRU 列表中删除单个条目的程序？
> 
> 我的许多客户宁愿不编辑 Windows 注册表来删除这些单独的条目，所以我设置了一个 VBScript，您可以下载并运行它以从该列表中删除单独的命令。按照这些说明下载并使用此程序从运行命令历史记录中清除不需要的条目。
> 
> 1) 单击以下链接并将 EditRunMRUList.vbs 脚本下载到您的桌面
> 
> 下载[EditRunMRUList.vbs](http://www.pchell.com/downloads/editrunmrulist.vbs)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T07:20:44.583

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T11:53:09.900

永远不要使用注册表，只需使用 Win32 SH api 来清理它。

# vba - 如何使用 Excel VBA 有效地对字符串进行 base64 编码？

> ID：169907
> 
> 赞同：33
> 
> 时间：2008-10-04T07:19:42.667
> 
> 标签：vba, excel, encoding, base64

我需要在 VBA 中将 100KB+ 的字符串编码为 base64。是否有任何可用的内置函数或 COM 对象可以做到这一点，因为纯 VBA 方法要么很复杂，要么在这些卷上不能很好地扩展（参见[dbb](http://www.vbforums.com/showthread.php?t=379072)和[marxidad](http://www.motobit.com/tips/detpg_Base64Encode/)的链接）？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-10-04T07:55:23.127

您可以使用[www.nonhostile.com/howto-encode-decode-base64-vb6.asp](http://web.archive.org/web/20060527094535/http://www.nonhostile.com/howto-encode-decode-base64-vb6.asp)中所述的 MSXML Base64 编码功能：

```
Function EncodeBase64(text As String) As String
  Dim arrData() As Byte
  arrData = StrConv(text, vbFromUnicode)      

  Dim objXML As MSXML2.DOMDocument
  Dim objNode As MSXML2.IXMLDOMElement

  Set objXML = New MSXML2.DOMDocument 
  Set objNode = objXML.createElement("b64")

  objNode.dataType = "bin.base64"
  objNode.nodeTypedValue = arrData
  EncodeBase64 = objNode.Text 

  Set objNode = Nothing
  Set objXML = Nothing
End Function 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-10-04T09:08:06.020

这段代码工作得非常快。它来自[这里](http://www.vbforums.com/showthread.php?t=379072)

```
Option Explicit

Private Const clOneMask = 16515072          '000000 111111 111111 111111
Private Const clTwoMask = 258048            '111111 000000 111111 111111
Private Const clThreeMask = 4032            '111111 111111 000000 111111
Private Const clFourMask = 63               '111111 111111 111111 000000

Private Const clHighMask = 16711680         '11111111 00000000 00000000
Private Const clMidMask = 65280             '00000000 11111111 00000000
Private Const clLowMask = 255               '00000000 00000000 11111111

Private Const cl2Exp18 = 262144             '2 to the 18th power
Private Const cl2Exp12 = 4096               '2 to the 12th
Private Const cl2Exp6 = 64                  '2 to the 6th
Private Const cl2Exp8 = 256                 '2 to the 8th
Private Const cl2Exp16 = 65536              '2 to the 16th

Public Function Encode64(sString As String) As String

    Dim bTrans(63) As Byte, lPowers8(255) As Long, lPowers16(255) As Long, bOut() As Byte, bIn() As Byte
    Dim lChar As Long, lTrip As Long, iPad As Integer, lLen As Long, lTemp As Long, lPos As Long, lOutSize As Long

    For lTemp = 0 To 63                                 'Fill the translation table.
        Select Case lTemp
            Case 0 To 25
                bTrans(lTemp) = 65 + lTemp              'A - Z
            Case 26 To 51
                bTrans(lTemp) = 71 + lTemp              'a - z
            Case 52 To 61
                bTrans(lTemp) = lTemp - 4               '1 - 0
            Case 62
                bTrans(lTemp) = 43                      'Chr(43) = "+"
            Case 63
                bTrans(lTemp) = 47                      'Chr(47) = "/"
        End Select
    Next lTemp

    For lTemp = 0 To 255                                'Fill the 2^8 and 2^16 lookup tables.
        lPowers8(lTemp) = lTemp * cl2Exp8
        lPowers16(lTemp) = lTemp * cl2Exp16
    Next lTemp

    iPad = Len(sString) Mod 3                           'See if the length is divisible by 3
    If iPad Then                                        'If not, figure out the end pad and resize the input.
        iPad = 3 - iPad
        sString = sString & String(iPad, Chr(0))
    End If

    bIn = StrConv(sString, vbFromUnicode)               'Load the input string.
    lLen = ((UBound(bIn) + 1) \ 3) * 4                  'Length of resulting string.
    lTemp = lLen \ 72                                   'Added space for vbCrLfs.
    lOutSize = ((lTemp * 2) + lLen) - 1                 'Calculate the size of the output buffer.
    ReDim bOut(lOutSize)                                'Make the output buffer.

    lLen = 0                                            'Reusing this one, so reset it.

    For lChar = LBound(bIn) To UBound(bIn) Step 3
        lTrip = lPowers16(bIn(lChar)) + lPowers8(bIn(lChar + 1)) + bIn(lChar + 2)    'Combine the 3 bytes
        lTemp = lTrip And clOneMask                     'Mask for the first 6 bits
        bOut(lPos) = bTrans(lTemp \ cl2Exp18)           'Shift it down to the low 6 bits and get the value
        lTemp = lTrip And clTwoMask                     'Mask for the second set.
        bOut(lPos + 1) = bTrans(lTemp \ cl2Exp12)       'Shift it down and translate.
        lTemp = lTrip And clThreeMask                   'Mask for the third set.
        bOut(lPos + 2) = bTrans(lTemp \ cl2Exp6)        'Shift it down and translate.
        bOut(lPos + 3) = bTrans(lTrip And clFourMask)   'Mask for the low set.
        If lLen = 68 Then                               'Ready for a newline
            bOut(lPos + 4) = 13                         'Chr(13) = vbCr
            bOut(lPos + 5) = 10                         'Chr(10) = vbLf
            lLen = 0                                    'Reset the counter
            lPos = lPos + 6
        Else
            lLen = lLen + 4
            lPos = lPos + 4
        End If
    Next lChar

    If bOut(lOutSize) = 10 Then lOutSize = lOutSize - 2 'Shift the padding chars down if it ends with CrLf.

    If iPad = 1 Then                                    'Add the padding chars if any.
        bOut(lOutSize) = 61                             'Chr(61) = "="
    ElseIf iPad = 2 Then
        bOut(lOutSize) = 61
        bOut(lOutSize - 1) = 61
    End If

    Encode64 = StrConv(bOut, vbUnicode)                 'Convert back to a string and return it.

End Function

Public Function Decode64(sString As String) As String

    Dim bOut() As Byte, bIn() As Byte, bTrans(255) As Byte, lPowers6(63) As Long, lPowers12(63) As Long
    Dim lPowers18(63) As Long, lQuad As Long, iPad As Integer, lChar As Long, lPos As Long, sOut As String
    Dim lTemp As Long

    sString = Replace(sString, vbCr, vbNullString)      'Get rid of the vbCrLfs.  These could be in...
    sString = Replace(sString, vbLf, vbNullString)      'either order.

    lTemp = Len(sString) Mod 4                          'Test for valid input.
    If lTemp Then
        Call Err.Raise(vbObjectError, "MyDecode", "Input string is not valid Base64.")
    End If

    If InStrRev(sString, "==") Then                     'InStrRev is faster when you know it's at the end.
        iPad = 2                                        'Note:  These translate to 0, so you can leave them...
    ElseIf InStrRev(sString, "=") Then                  'in the string and just resize the output.
        iPad = 1
    End If

    For lTemp = 0 To 255                                'Fill the translation table.
        Select Case lTemp
            Case 65 To 90
                bTrans(lTemp) = lTemp - 65              'A - Z
            Case 97 To 122
                bTrans(lTemp) = lTemp - 71              'a - z
            Case 48 To 57
                bTrans(lTemp) = lTemp + 4               '1 - 0
            Case 43
                bTrans(lTemp) = 62                      'Chr(43) = "+"
            Case 47
                bTrans(lTemp) = 63                      'Chr(47) = "/"
        End Select
    Next lTemp

    For lTemp = 0 To 63                                 'Fill the 2^6, 2^12, and 2^18 lookup tables.
        lPowers6(lTemp) = lTemp * cl2Exp6
        lPowers12(lTemp) = lTemp * cl2Exp12
        lPowers18(lTemp) = lTemp * cl2Exp18
    Next lTemp

    bIn = StrConv(sString, vbFromUnicode)               'Load the input byte array.
    ReDim bOut((((UBound(bIn) + 1) \ 4) * 3) - 1)       'Prepare the output buffer.

    For lChar = 0 To UBound(bIn) Step 4
        lQuad = lPowers18(bTrans(bIn(lChar))) + lPowers12(bTrans(bIn(lChar + 1))) + _
                lPowers6(bTrans(bIn(lChar + 2))) + bTrans(bIn(lChar + 3))           'Rebuild the bits.
        lTemp = lQuad And clHighMask                    'Mask for the first byte
        bOut(lPos) = lTemp \ cl2Exp16                   'Shift it down
        lTemp = lQuad And clMidMask                     'Mask for the second byte
        bOut(lPos + 1) = lTemp \ cl2Exp8                'Shift it down
        bOut(lPos + 2) = lQuad And clLowMask            'Mask for the third byte
        lPos = lPos + 3
    Next lChar

    sOut = StrConv(bOut, vbUnicode)                     'Convert back to a string.
    If iPad Then sOut = Left$(sOut, Len(sOut) - iPad)   'Chop off any extra bytes.
    Decode64 = sOut

End Function 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2021-02-04T23:38:36.163

正如 Mark C 所指出的，您可以使用[此处](http://www.nonhostile.com/howto-encode-decode-base64-vb6.asp)所述的 MSXML Base64 编码功能。

我更喜欢后期绑定，因为它更容易部署，所以这里有相同的函数，无需任何 VBA 引用即可工作：

```
Function EncodeBase64(text As String) As String
  Dim arrData() As Byte
  arrData = StrConv(text, vbFromUnicode)

  Dim objXML As Variant
  Dim objNode As Variant

  Set objXML = CreateObject("MSXML2.DOMDocument")
  Set objNode = objXML.createElement("b64")

  objNode.dataType = "bin.base64"
  objNode.nodeTypedValue = arrData
  EncodeBase64 = objNode.text

  Set objNode = Nothing
  Set objXML = Nothing
End Function 
```

# c# - 在 .net ReportViewer 控件中查看 MS Access 报告

> ID：169908
> 
> 赞同：2
> 
> 时间：2008-10-04T07:19:45.180
> 
> 标签：c#, .net, vb.net, ms-access, reportviewer

是否可以在 .Net ReportViewer 控件中查看 MS Access 报告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-04T08:10:16.280

我不这么认为...您首先需要将报告迁移到 SSRS。[http://www.microsoft.com/technet/prodtechnol/sql/2000/deploy/migratereports.mspx](http://www.microsoft.com/technet/prodtechnol/sql/2000/deploy/migratereports.mspx)

# objective-c - 如何将字符串转换为双精度，反之亦然？

> ID：169925
> 
> 赞同：147
> 
> 时间：2008-10-04T07:36:01.107
> 
> 标签：objective-c

我想将一个字符串转换为一个双精度，并在对其进行一些数学运算后，将其转换回一个字符串。

我如何在 Objective-C 中做到这一点？

有没有办法将双精度数舍入到最接近的整数？

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2008-10-04T07:45:08.980

您可以将 NSString 转换为双精度

```
double myDouble = [myString doubleValue]; 
```

然后可以将舍入到最接近的 int 为

```
int myInt = (int)(myDouble + (myDouble>0 ? 0.5 : -0.5)) 
```

老实说，我不确定是否有比转换回字符串更简化的方法

```
NSString* myNewString = [NSString stringWithFormat:@"%d", myInt]; 
```

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2008-10-04T19:10:32.250

要真正正确地将字符串转换为数字，您需要使用[`NSNumberFormatter`](https://developer.apple.com/documentation/foundation/nsnumberformatter)为您正在读取字符串的语言环境配置的实例。

不同的语言环境会以不同的方式格式化数字。例如，在世界的某些地方，`COMMA`它被用作小数分隔符，而在其他地方则被用作`PERIOD`- 并且千位分隔符（使用时）被颠倒了。除非它是一个空间。或者根本不存在。

这实际上取决于输入的来源。最安全的做法是`NSNumberFormatter`为输入的格式配置一个并用于`-[NSFormatter numberFromString:]`从中获取一个`NSNumber`。如果要处理转换错误，可以`-[NSFormatter getObjectValue:forString:range:error:]`改用。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-10-04T17:37:55.743

添加到 olliej 的答案，您可以从 int 转换回带有`NSNumber`'s的字符串`stringValue`：

```
[[NSNumber numberWithInt:myInt] stringValue] 
```

`stringValue`在`NSNumber`调用上`descriptionWithLocale:nil`，为您提供值的本地化字符串表示。我不确定是否`[NSString stringWithFormat:@"%d",myInt]`会给您正确本地化的`myInt`.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-10-25T21:03:02.133

这是 NSNumberFormatter 读取本地化数字字符串（xCode 3.2.4，osX 10.6）的工作示例，以节省其他人我刚刚花费的时间。注意：虽然它可以处理诸如“8,765.4”之类的尾随空格，但它不能处理前导空格，也不能处理杂散文本字符。（错误的输入字符串：“8”、“8q”和“8 q”。）

```
NSString *tempStr = @"8,765.4";  
     // localization allows other thousands separators, also.
NSNumberFormatter * myNumFormatter = [[NSNumberFormatter alloc] init];
[myNumFormatter setLocale:[NSLocale currentLocale]]; // happen by default?
[myNumFormatter setFormatterBehavior:NSNumberFormatterBehavior10_4];
     // next line is very important!
[myNumFormatter setNumberStyle:NSNumberFormatterDecimalStyle]; // crucial

NSNumber *tempNum = [myNumFormatter numberFromString:tempStr];
NSLog(@"string '%@' gives NSNumber '%@' with intValue '%i'", 
    tempStr, tempNum, [tempNum intValue]);
[myNumFormatter release];  // good citizen 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-04T07:57:15.383

olliej 的[舍入](http://en.wikipedia.org/wiki/Rounding)方法对于负数是错误的

*   2.4 舍入为 2（olliej 的方法正确）
*   -2.4 舍入为 -2（olliej 的方法返回 -1）

这是一个替代方案

```
 int myInt = (int)(myDouble + (myDouble>0 ? 0.5 : -0.5)) 
```

您当然可以使用 math.h 中的舍入函数

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-01T10:37:27.830

```
// Converting String in to Double

double doubleValue = [yourString doubleValue];

// Converting Double in to String
NSString *yourString = [NSString stringWithFormat:@"%.20f", doubleValue];
// .20f takes the value up to 20 position after decimal

// Converting double to int

int intValue = (int) doubleValue;
or
int intValue = [yourString intValue]; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-12-04T13:07:41.877

对于从数字到字符串的转换，使用新的文字语法（XCode >= 4.4）怎么样，它更紧凑一点。

```
int myInt = (int)round( [@"1.6" floatValue] );

NSString* myString = [@(myInt) description]; 
```

（将其装箱为[NSNumber并使用](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNumber_Class/Reference/Reference.html)[NSObjects 的描述方法](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html#//apple_ref/occ/intfm/NSObject/description)转换为字符串）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-06T21:30:02.280

对于舍入，您可能应该使用 math.h 中定义的 C 函数。

```
int roundedX = round(x); 
```

按住 Option 并在 Xcode 中双击`round`，它会显示手册页，其中包含用于舍入不同类型的各种函数。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-06T19:38:01.803

这是我所知道的最简单的方法：

```
float myFloat = 5.3;
NSInteger myInt = (NSInteger)myFloat; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-12-14T19:14:21.077

从这里的示例中，您可以看到两种方式的转换：

```
NSString *str=@"5678901234567890";

long long verylong;
NSRange range;
range.length = 15;
range.location = 0;

[[NSScanner scannerWithString:[str substringWithRange:range]] scanLongLong:&verylong];

NSLog(@"long long value %lld",verylong); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-01-23T15:16:14.397

我最终使用了这个方便的宏：

```
#define STRING(value)               [@(value) stringValue] 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-02-24T12:42:56.770

将文本字段中输入的文本转换为整数

```
double mydouble=[_myTextfield.text doubleValue]; 
```

四舍五入到最接近的双精度

```
mydouble=(round(mydouble)); 
```

四舍五入到最接近的 int（仅考虑正值）

```
int myint=(int)(mydouble); 
```

从双精度转换为字符串

```
myLabel.text=[NSString stringWithFormat:@"%f",mydouble]; 
```

或者

```
NSString *mystring=[NSString stringWithFormat:@"%f",mydouble]; 
```

从 int 转换为字符串

```
myLabel.text=[NSString stringWithFormat:@"%d",myint]; 
```

或者

```
NSString *mystring=[NSString stringWithFormat:@"%f",mydouble]; 
```

# javascript - 我在哪里可以找到有关新 canvas HTML 元素如何工作的一些有用信息？

> ID：169928
> 
> 赞同：3
> 
> 时间：2008-10-04T07:39:10.570
> 
> 标签：javascript, html, canvas

我一直在阅读关于这个用于 HTML5 的新 Canvas 元素有多棒的文章，并且我看到了仅使用 javascript 而不使用 flash 完成的令人惊叹的演示。我在哪里可以找到一些关于如何自己做这些事情的好信息？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-04T07:44:40.743

[该规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#the-canvas-element)定义了 API 和行为。

[本教程](http://developer.mozilla.org/en/Canvas_tutorial)应该可以帮助您入门。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-04T07:54:05.750

有原始的[Apple教程](http://developer.apple.com/documentation/AppleApplications/Conceptual/SafariJSProgTopics/Tasks/Canvas.html)

还有[html5规范草案](http://www.w3.org/html/wg/html5/#the-canvas-element)

当然，您可以（就像人们一样）在 SO 上询问有关特定功能等的问题：D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-17T17:40:48.453

我一直在使用这个 HTML5 Canvas 备忘单，它详尽且易于阅读。

[http://blog.nihilogic.dk/2009/02/html5-canvas-cheat-sheet.html](http://blog.nihilogic.dk/2009/02/html5-canvas-cheat-sheet.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-14T23:02:48.073

[这个页面](http://www.brighthub.com/hubfolio/matthew-casperson/blog/archive/2009/06/29/game-development-with-javascript-and-the-canvas-element.aspx)是一个 14 部分的系列，向您展示如何使用 canvas 元素创建一个简单的平台游戏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-14T23:07:36.937

[Ajaxian](http://ajaxian.com/by/topic/canvas)收集了大量关于 Canvas 创新和发展的文章/帖子。这可以向您展示其他人已经在做什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-31T13:52:09.900

这不是很深，但很容易阅读并给出了很好的例子：

[https://developer.mozilla.org/en/canvas_tutorial](https://developer.mozilla.org/en/canvas_tutorial)

这是我开始的地方（我现在有几个使用 js + canvas 的 iOS 应用程序）

# eclipse - JUnit Eclipse 插件源代码？

> ID：169929
> 
> 赞同：8
> 
> 时间：2008-10-04T07:39:37.340
> 
> 标签：eclipse, open-source, junit, eclipse-plugin, flexunit

我正在考虑为 FlexUnit 编写一个 Eclipse 插件，并且想知道在哪里可以获得 JUnit Eclipse 插件的源代码。我在 sourceforge 检查了 JUnit 源代码，但找不到任何看起来像插件代码的代码。

知道此代码在哪里可用吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-04T07:50:25.867

您可以在 Eclipse 的存储库中找到它：

[http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.pde.junit/](http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.pde.junit/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-11-09T12:30:25.090

现在有 CVS 存储库的 git 镜像：

1.  org.eclipse.jdt.junit：git://dev.eclipse.org/org.eclipse.jdt/org.eclipse.jdt.junit.git
2.  org.eclipse.jdt.junit.core：git://dev.eclipse.org/org.eclipse.jdt/org.eclipse.jdt.junit.core.git
3.  org.eclipse.jdt.junit.runtime：git://dev.eclipse.org/org.eclipse.jdt/org.eclipse.jdt.junit.runtime.git
4.  org.eclipse.jdt.junit4.runtime：git://dev.eclipse.org/org.eclipse.jdt/org.eclipse.jdt.junit4.runtime.git

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-09-11T08:53:49.520

由于您很可能使用 Eclipse，因此有一种更简单的方法可以将其直接导入您的工作区。源代码与您的 Eclipse 发行版捆绑在一起。

只需执行
文件 -> 导入 -> 插件和片段

保留默认值（“活动目标平台”、“从所有插件中选择”和“带有源文件夹的项目”

点击下一步，选择 JUnit 插件包并点击完成，它们将作为 Eclipse 项目导入您的工作区。

# iphone - iPhone App 的合理尺寸是多少？

> ID：169936
> 
> 赞同：9
> 
> 时间：2008-10-04T07:49:20.453
> 
> 标签：iphone

我想知道 iPhone 应用程序的合理尺寸是多少。现在我正在开发一款 iPhone 游戏，当然它可以快速加载到我的设备中，因为我是通过 USB 电缆直接连接到它的，但我不知道从应用程序下载实际需要多长时间店铺。

就我而言，它的大小约为 2mb，这对于台式机甚至 Flash 游戏来说是合理的，但我不知道这对于 iPhone 来说是否合理。

我的另一个问题是 App Store 的非 wifi 下载限制是多少？有时，除非您有 wifi 连接，否则某些应用程序将无法下载。而且我个人从来没有下载过这样的应用程序，因为它给我留下了不好的印象。所以我肯定希望保持在这个限制之下。

此外，由于我已经在询问应用程序大小，因此为其他类型的应用程序收集合适的大小可能也会很有用。

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-04T20:26:00.223

查看我手机上的一些游戏，它们的重量约为 7 或 8 mb。我认为你的 2mb 会很好。

我可以肯定地告诉您的一件事是，如果您想通过蜂窝网络进行分发，您的应用程序必须小于 50 mb。如果超过此值，则必须在计算机上使用 wifi 或 iTunes 下载。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-04T07:55:51.207

3g网络速度很快。我不会基于此限制您的开发 - 完全按照您需要做的事情来使您的游戏尽可能好，即使需要更长时间，人们也会下载它。我已经从商店下载了超过 3g 的 10MB+ 应用程序，它也可能是一个缓慢的 wi-fi 连接，它就是这么快。

另请记住，许多人在他们的计算机上购买（因此连接速度很快）然后只是同步到 iPhone，尤其是那些在蜂窝网络较慢的地区的人。

底线，大小不会影响下载，收视率会。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-12T12:18:39.963

除了合理的数字略低于限制：最大应用程序大小为 2GB 大于 20MB 的应用程序将无法通过蜂窝连接下载

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T10:09:29.563

我会尽量保持它尽可能小。应用商店可能支持，比如说，一个 100MB 的应用程序，但安装起来对用户来说不是很好。

问题是通过手机安装 - 你得到的只是一个简单的进度条，大多数人会在 1 分钟后自动锁定手机。所以，理想情况下，应用程序会在平均连接下在一分钟内下载。

# c# - 您如何像在代理中一样使用 webrequest/response 处理 cookie？

> ID：169943
> 
> 赞同：2
> 
> 时间：2008-10-04T07:54:09.447
> 
> 标签：c#, cookies, .net-3.5

您如何处理 cookie 以及在代理中使用 webrequest/response？我不知道该怎么做......或者我什至可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-04T09:50:26.233

你能澄清你的意思吗？这里的设置是什么？如果要执行多个相关操作，那么[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.80).aspx)可能更合适；这可能（我没有检查过 - 从来不需要它）在同一个 WebClient 实例上的调用之间保留 cookie（并且也更容易使用）。

# .net - 使用 .NET Framework 安全系统

> ID：169951
> 
> 赞同：3
> 
> 时间：2008-10-04T08:01:35.390
> 
> 标签：.net, security, code-access-security

我想知道 - 你们中的任何人实际上使用 System.Security.Permissions 命名空间中的各种类吗？我主要开发桌面/服务器端组件（即，没有 Web），一般假设是 FullTrust 始终可用，并且在不是这种情况的环境上不进行测试。除了 MS 源代码（EnterpriseLibrary 等）之外，我还没有看到使用上述结构的实际使用中的源代码。

这是普遍现象，还是我们是例外？我当然知道，不做这种测试对我们来说是个问题……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-04T08:51:39.597

我大量使用 PrincipalPermissionAttribute 来要求用户从 Thread 的 Principal 获得必要的访问权限（使用角色）——在我的业务代码中节省了大量手动检查（显然 UI 也应该检查并禁用按钮等——这只是在后端仔细检查）。

我发现基于 Principal 的安全性非常通用，尤其是使用自定义 Principal 时。但我不使用CAS的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T08:32:20.790

当用户通过 Internet 直接在服务器上运行代码时，.NET 代码访问安全性更加相关，在这种情况下，他们不一定相信它会自动执行诸如访问文件系统之类的事情。不过，我不知道有谁让他们的代码像这样可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-04T08:11:33.280

如果您使用 ClickOnce 部署桌面应用程序，那么安全沙箱就可以发挥作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-04T08:19:19.817

我从未见过有人使用许可、断言功能。

我怀疑许多开发人员实际上并没有意识到该功能。

我认为限制对危险函数的调用可能很有用。

这将取决于你在做什么，但谁想让部署比现在更复杂？

# bash - 如何防止脚本同时运行？

> ID：169964
> 
> 赞同：71
> 
> 时间：2008-10-04T08:14:48.423
> 
> 标签：bash, semaphore

我想防止我的脚本一次运行不止一次。

我目前的做法是

*   创建一个包含正在运行进程的 pid 的信号量文件
*   读取文件，如果我的进程 ID 不在其中退出（你永远不知道......）
*   在处理结束时，删除文件

为了防止进程挂起，我设置了一个 cron 作业来定期检查文件是否旧于允许的最大运行时间，如果它仍在运行，则终止该进程。

我是否有杀死错误进程的风险？

有没有更好的方法来整体执行此操作？

# c# - 什么时候应该使用 List 和 LinkedList

> ID：169973
> 
> 赞同：438
> 
> 时间：2008-10-04T08:23:24.973
> 
> 标签：c#, .net, vb.net, data-structures, linked-list

什么时候使用[List](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.list-1)和[LinkedList](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.linkedlist-1)更好？

* * *

## 回答 #1

> 赞同：302
> 
> 时间：2008-10-04T08:28:41.717

在大多数情况下，`List<T>`更有用。`LinkedList<T>`在列表中间添加/删除项目时成本会更低，而`List<T>`只能在列表*末尾*廉价添加/删除。

`LinkedList<T>`只有在您访问顺序数据（向前或向后）时才最有效 - 随机访问相对昂贵，因为它每次都必须遍历链（因此它没有索引器）。但是，因为 a`List<T>`本质上只是一个数组（带有包装器），所以随机访问是可以的。

`List<T>`还提供了很多支持方法—— `Find`、、`ToArray`等；但是，这些也可用于`LinkedList<T>`.NET 3.5/C# 3.0 通过扩展方法 - 所以这不是一个因素。

* * *

## 回答 #2

> 赞同：239
> 
> 时间：2011-10-15T11:58:03.047

将链接列表视为列表可能有点误导。它更像是一条链子。事实上，在 .NET 中，`LinkedList<T>`甚至没有实现`IList<T>`. 链表中没有真正的索引概念，即使看起来有。当然，类上提供的方法都不接受索引。

链表可以是单链的，也可以是双链的。这是指链中的每个元素是否仅与下一个元素（单链接）或前一个/下一个元素（双重链接）有链接。 `LinkedList<T>`是双重联系的。

在内部，`List<T>`由数组支持。这在内存中提供了非常紧凑的表示。相反，`LinkedList<T>`涉及额外的内存来存储连续元素之间的双向链接。因此 a 的内存占用`LinkedList<T>`通常会大于 for `List<T>`（需要注意的是，`List<T>`可以使用未使用的内部数组元素来提高附加操作期间的性能。）

它们也具有不同的性能特征：

### 附加

*   `LinkedList<T>.AddLast(item)` ***恒定时间***
*   `List<T>.Add(item)` *摊销常数时间，线性最坏情况*

### 前置

*   `LinkedList<T>.AddFirst(item)` ***恒定时间***
*   `List<T>.Insert(0, item)` *线性时间*

### 插入

*   `LinkedList<T>.AddBefore(node, item)` ***恒定时间***
*   `LinkedList<T>.AddAfter(node, item)` ***恒定时间***
*   `List<T>.Insert(index, item)` *线性时间*

### 移动

*   `LinkedList<T>.Remove(item)` *线性时间*
*   `LinkedList<T>.Remove(node)` ***恒定时间***
*   `List<T>.Remove(item)` *线性时间*
*   `List<T>.RemoveAt(index)` *线性时间*

### 数数

*   `LinkedList<T>.Count` *恒定时间*
*   `List<T>.Count` *恒定时间*

### 包含

*   `LinkedList<T>.Contains(item)` *线性时间*
*   `List<T>.Contains(item)` *线性时间*

### 清除

*   `LinkedList<T>.Clear()` *线性时间*
*   `List<T>.Clear()` *线性时间*

如您所见，它们大多是等价的。在实践中，API`LinkedList<T>`使用起来更加麻烦，并且其内部需求的细节会溢出到您的代码中。

但是，如果您需要从列表中进行多次插入/删除，它会提供恒定的时间。 `List<T>`提供线性时间，因为列表中的额外项目必须在插入/删除后随机播放。

* * *

## 回答 #3

> 赞同：118
> 
> 时间：2008-10-04T08:34:23.983

链表提供非常快速的列表成员插入或删除。链表中的每个成员都包含指向链表中下一个成员的指针，以便在位置 i 插入成员：

*   更新成员 i-1 中的指针以指向新成员
*   将新成员中的指针设置为指向成员 i

链表的缺点是无法进行随机访问。访问成员需要遍历列表，直到找到所需的成员。

* * *

## 回答 #4

> 赞同：111
> 
> 时间：2012-09-17T20:47:37.900

## 编辑

> 请阅读对此答案的评论。人们声称我没有进行适当的测试。我同意这不应该是一个公认的答案。在我学习的过程中，我做了一些测试，并想分享它们。

## 原答案...

我发现了有趣的结果：

```
// Temporary class to show the example
class Temp
{
    public decimal A, B, C, D;

    public Temp(decimal a, decimal b, decimal c, decimal d)
    {
        A = a;            B = b;            C = c;            D = d;
    }
} 
```

## 链表（3.9 秒）

```
 LinkedList<Temp> list = new LinkedList<Temp>();

        for (var i = 0; i < 12345678; i++)
        {
            var a = new Temp(i, i, i, i);
            list.AddLast(a);
        }

        decimal sum = 0;
        foreach (var item in list)
            sum += item.A; 
```

## 列表（2.4 秒）

```
 List<Temp> list = new List<Temp>(); // 2.4 seconds

        for (var i = 0; i < 12345678; i++)
        {
            var a = new Temp(i, i, i, i);
            list.Add(a);
        }

        decimal sum = 0;
        foreach (var item in list)
            sum += item.A; 
```

**即使您基本上只访问数据，它也会慢得多！！**我说永远不要使用linkedList。

* * *

* * *

* * *

**这是另一个执行大量插入的比较（我们计划在列表中间插入一个项目）**

## 链表（51 秒）

```
 LinkedList<Temp> list = new LinkedList<Temp>();

        for (var i = 0; i < 123456; i++)
        {
            var a = new Temp(i, i, i, i);

            list.AddLast(a);
            var curNode = list.First;

            for (var k = 0; k < i/2; k++) // In order to insert a node at the middle of the list we need to find it
                curNode = curNode.Next;

            list.AddAfter(curNode, a); // Insert it after
        }

        decimal sum = 0;
        foreach (var item in list)
            sum += item.A; 
```

## 列表（7.26 秒）

```
 List<Temp> list = new List<Temp>();

        for (var i = 0; i < 123456; i++)
        {
            var a = new Temp(i, i, i, i);

            list.Insert(i / 2, a);
        }

        decimal sum = 0;
        foreach (var item in list)
            sum += item.A; 
```

## 链接列表具有插入位置的参考（0.04 秒）

```
 list.AddLast(new Temp(1,1,1,1));
        var referenceNode = list.First;

        for (var i = 0; i < 123456; i++)
        {
            var a = new Temp(i, i, i, i);

            list.AddLast(a);
            list.AddBefore(referenceNode, a);
        }

        decimal sum = 0;
        foreach (var item in list)
            sum += item.A; 
```

因此，只有当您计划插入多个项目并且您在某个地方**也**有您计划插入项目的参考时，然后才使用链表。仅仅因为您必须插入很多项目并不能使其更快，因为搜索您要插入的位置需要时间。

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2015-03-25T18:41:44.980

我之前的回答不够准确。确实这太可怕了：D但现在我可以发布更多有用和正确的答案。

* * *

我做了一些额外的测试。您可以通过以下链接找到它的源代码并自行在您的环境中重新检查它：[https ://github.com/ukushu/DataStructuresTestsAndOther.git](https://github.com/ukushu/DataStructuresTestsAndOther.git)

**简短的结果：**

*   数组需要使用：

    *   尽可能经常。它速度很快，并且对于相同数量的信息占用最小的 RAM 范围。
    *   如果您知道所需细胞的确切数量
    *   如果保存在数组中的数据 < 85000 b（整数数据为 85000/32 = 2656 个元素）
    *   如果需要高随机存取速度
*   清单需要使用：

    *   如果需要将单元格添加到列表末尾（经常）
    *   如果需要在列表的开头/中间添加单元格（不经常）
    *   如果保存在数组中的数据 < 85000 b（整数数据为 85000/32 = 2656 个元素）
    *   如果需要高随机存取速度
*   LinkedList 需要使用：

    *   如果需要在列表的开头/中间/结尾添加单元格（经常）
    *   如果需要仅顺序访问（向前/向后）
    *   如果您需要保存 LARGE 项目，但项目数量很少。
    *   最好不要用于大量项目，因为它会为链接使用额外的内存。

**更多细节：**

[![введите сюда описание изображения](https://i.stack.imgur.com/iBz6V.png)](https://i.stack.imgur.com/iBz6V.png) **有趣的是：**

1.  `LinkedList<T>`在内部不是 .NET 中的列表。它甚至没有实现`IList<T>`。这就是为什么没有索引和与索引相关的方法的原因。

2.  `LinkedList<T>`是基于节点指针的集合。在 .NET 中，它是双向链接的实现。这意味着先前/下一个元素具有指向当前元素的链接。并且数据是碎片化的——不同的列表对象可以位于 RAM 的不同位置。也将有`LinkedList<T>`比 for`List<T>`或 Array 更多的内存使用。

3.  `List<T>`在 .Net 中是 Java 的`ArrayList<T>`. 这意味着这是数组包装器。所以它作为一个连续的数据块在内存中分配。如果分配的数据大小超过 85000 字节，它将被移动到大对象堆。根据大小，这可能会导致堆碎片（一种温和的内存泄漏形式）。但同时如果 size < 85000 字节——这在内存中提供了一个非常紧凑和快速访问的表示。

4.  单个连续块对于随机访问性能和内存消耗是首选，但对于需要定期更改大小的集合，通常需要将诸如 Array 之类的结构复制到新位置，而链表只需要管理新插入的内存/删除的节点。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2008-10-04T08:35:55.523

List 和 LinkedList 的区别在于它们的底层实现。List 是基于数组的集合（ArrayList）。LinkedList 是基于节点指针的集合 (LinkedListNode)。在 API 级别的使用上，它们几乎相同，因为它们都实现了相同的接口集，例如 ICollection、IEnumerable 等。

当性能很重要时，关键的区别就出现了。例如，如果您正在实现具有大量“INSERT”操作的列表，则 LinkedList 优于 List。由于 LinkedList 可以在 O(1) 时间内完成，但 List 可能需要扩展底层数组的大小。有关更多信息/详细信息，您可能需要阅读 LinkedList 和数组数据结构之间的算法差异。[http://en.wikipedia.org/wiki/Linked_list](http://en.wikipedia.org/wiki/Linked_list)和[数组](http://en.wikipedia.org/wiki/Array)

希望这有帮助，

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2012-11-25T08:52:14.643

与数组相比，链表的主要优点是链接为我们提供了有效地重新排列项目的能力。塞奇威克，p。91

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-08-19T12:47:02.687

使用 LinkedList 的常见情况是这样的：

假设你想从一个很大的字符串列表中删除许多特定的字符串，比如 100,000。要删除的字符串可以在 HashSet dic 中查找，并且字符串列表被认为包含 30,000 到 60,000 个要删除的此类字符串。

那么存储 100,000 个字符串的最佳 List 类型是什么？答案是链表。如果它们存储在 ArrayList 中，则对其进行迭代并删除匹配的字符串可能需要数十亿次操作，而使用迭代器和 remove() 方法只需要大约 100,000 次操作。

```
LinkedList<String> strings = readStrings();
HashSet<String> dic = readDic();
Iterator<String> iterator = strings.iterator();
while (iterator.hasNext()){
    String string = iterator.next();
    if (dic.contains(string))
    iterator.remove();
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-04T08:27:29.660

当您需要内置索引访问、排序（以及在此二进制搜索之后）和“ToArray()”方法时，您应该使用 List。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-12-08T04:15:11.053

本质上，`List<>`.NET 中的 a 是*数组*的包装器。A`LinkedList<>` *是一个链表*。所以问题归结为，数组和链表有什么区别，什么时候应该使用数组而不是链表。您决定使用哪个最重要的因素可能归结为：

*   链表具有更好的插入/删除性能，只要插入/删除不在集合中的最后一个元素上。这是因为数组必须移动插入/删除点之后的所有剩余元素。但是，如果插入/删除位于列表的末尾，则不需要这种移位（尽管如果超出了数组的容量，可能需要调整数组的大小）。
*   数组具有更好的访问能力。数组可以直接索引（在恒定时间内）。必须遍历链表（线性时间）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-07-03T00:29:50.477

这是改编自[Tono Nam](https://stackoverflow.com/a/12466884/661933)接受的答案，纠正了其中的一些错误测量。

考试：

```
static void Main()
{
    LinkedListPerformance.AddFirst_List(); // 12028 ms
    LinkedListPerformance.AddFirst_LinkedList(); // 33 ms

    LinkedListPerformance.AddLast_List(); // 33 ms
    LinkedListPerformance.AddLast_LinkedList(); // 32 ms

    LinkedListPerformance.Enumerate_List(); // 1.08 ms
    LinkedListPerformance.Enumerate_LinkedList(); // 3.4 ms

    //I tried below as fun exercise - not very meaningful, see code
    //sort of equivalent to insertion when having the reference to middle node

    LinkedListPerformance.AddMiddle_List(); // 5724 ms
    LinkedListPerformance.AddMiddle_LinkedList1(); // 36 ms
    LinkedListPerformance.AddMiddle_LinkedList2(); // 32 ms
    LinkedListPerformance.AddMiddle_LinkedList3(); // 454 ms

    Environment.Exit(-1);
} 
```

和代码：

```
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;

namespace stackoverflow
{
    static class LinkedListPerformance
    {
        class Temp
        {
            public decimal A, B, C, D;

            public Temp(decimal a, decimal b, decimal c, decimal d)
            {
                A = a; B = b; C = c; D = d;
            }
        }

        static readonly int start = 0;
        static readonly int end = 123456;
        static readonly IEnumerable<Temp> query = Enumerable.Range(start, end - start).Select(temp);

        static Temp temp(int i)
        {
            return new Temp(i, i, i, i);
        }

        static void StopAndPrint(this Stopwatch watch)
        {
            watch.Stop();
            Console.WriteLine(watch.Elapsed.TotalMilliseconds);
        }

        public static void AddFirst_List()
        {
            var list = new List<Temp>();
            var watch = Stopwatch.StartNew();

            for (var i = start; i < end; i++)
                list.Insert(0, temp(i));

            watch.StopAndPrint();
        }

        public static void AddFirst_LinkedList()
        {
            var list = new LinkedList<Temp>();
            var watch = Stopwatch.StartNew();

            for (int i = start; i < end; i++)
                list.AddFirst(temp(i));

            watch.StopAndPrint();
        }

        public static void AddLast_List()
        {
            var list = new List<Temp>();
            var watch = Stopwatch.StartNew();

            for (var i = start; i < end; i++)
                list.Add(temp(i));

            watch.StopAndPrint();
        }

        public static void AddLast_LinkedList()
        {
            var list = new LinkedList<Temp>();
            var watch = Stopwatch.StartNew();

            for (int i = start; i < end; i++)
                list.AddLast(temp(i));

            watch.StopAndPrint();
        }

        public static void Enumerate_List()
        {
            var list = new List<Temp>(query);
            var watch = Stopwatch.StartNew();

            foreach (var item in list)
            {

            }

            watch.StopAndPrint();
        }

        public static void Enumerate_LinkedList()
        {
            var list = new LinkedList<Temp>(query);
            var watch = Stopwatch.StartNew();

            foreach (var item in list)
            {

            }

            watch.StopAndPrint();
        }

        //for the fun of it, I tried to time inserting to the middle of 
        //linked list - this is by no means a realistic scenario! or may be 
        //these make sense if you assume you have the reference to middle node

        //insertion to the middle of list
        public static void AddMiddle_List()
        {
            var list = new List<Temp>();
            var watch = Stopwatch.StartNew();

            for (var i = start; i < end; i++)
                list.Insert(list.Count / 2, temp(i));

            watch.StopAndPrint();
        }

        //insertion in linked list in such a fashion that 
        //it has the same effect as inserting into the middle of list
        public static void AddMiddle_LinkedList1()
        {
            var list = new LinkedList<Temp>();
            var watch = Stopwatch.StartNew();

            LinkedListNode<Temp> evenNode = null, oddNode = null;
            for (int i = start; i < end; i++)
            {
                if (list.Count == 0)
                    oddNode = evenNode = list.AddLast(temp(i));
                else
                    if (list.Count % 2 == 1)
                        oddNode = list.AddBefore(evenNode, temp(i));
                    else
                        evenNode = list.AddAfter(oddNode, temp(i));
            }

            watch.StopAndPrint();
        }

        //another hacky way
        public static void AddMiddle_LinkedList2()
        {
            var list = new LinkedList<Temp>();
            var watch = Stopwatch.StartNew();

            for (var i = start + 1; i < end; i += 2)
                list.AddLast(temp(i));
            for (int i = end - 2; i >= 0; i -= 2)
                list.AddLast(temp(i));

            watch.StopAndPrint();
        }

        //OP's original more sensible approach, but I tried to filter out
        //the intermediate iteration cost in finding the middle node.
        public static void AddMiddle_LinkedList3()
        {
            var list = new LinkedList<Temp>();
            var watch = Stopwatch.StartNew();

            for (var i = start; i < end; i++)
            {
                if (list.Count == 0)
                    list.AddLast(temp(i));
                else
                {
                    watch.Stop();
                    var curNode = list.First;
                    for (var j = 0; j < list.Count / 2; j++)
                        curNode = curNode.Next;
                    watch.Start();

                    list.AddBefore(curNode, temp(i));
                }
            }

            watch.StopAndPrint();
        }
    }
} 
```

* * *

您可以看到结果与其他人在此处记录的理论性能一致。非常清楚 -`LinkedList<T>`在插入的情况下获得大量时间。我还没有测试从列表中间删除，但结果应该是一样的。当然`List<T>`还有其他领域表现得更好，比如 O(1) 随机访问。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-11-23T16:24:44.510

`LinkedList<>`何时使用

1.  你不知道有多少物体正在通过防洪闸门。例如，`Token Stream`。
2.  当您只想在末尾删除\插入时。

对于其他一切，最好使用`List<>`.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-04-18T14:51:02.660

我同意上面提出的大部分观点。而且我也同意 List 在大多数情况下看起来是一个更明显的选择。

但是，我只想补充一点，在很多情况下，LinkedList 比 List 更好，效率更高。

1.  假设您正在遍历元素并且想要执行大量插入/删除；LinkedList 在线性 O(n) 时间内完成，而 List 在二次 O(n^2) 时间内完成。
2.  假设你想一次又一次地访问更大的对象，LinkedList 变得非常有用。
3.  使用 LinkedList 更好地实现 Deque() 和 queue()。
4.  一旦您处理许多更大的对象，增加 LinkedList 的大小会更容易和更好。

希望有人会发现这些评论有用。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2021-07-01T13:55:45.903

在 .NET 中，列表表示为数组。因此，与 LinkedList 相比，使用普通 List 会更快。这就是上面的人看到他们看到的结果的原因。

为什么要使用列表？我会说这取决于。如果您没有指定任何元素，List 会创建 4 个元素。当你超过这个限制时，它会将内容复制到一个新数组中，将旧数组留在垃圾收集器的手中。然后它的大小加倍。在这种情况下，它会创建一个包含 8 个元素的新数组。想象一下有一个包含 100 万个元素的列表，然后再添加 1 个。它本质上将创建一个全新的数组，其大小是您需要的两倍。新阵列将具有 2Mil 容量，但是您只需要 1Mil 和 1。基本上将 GEN2 中的东西留给垃圾收集器等等。所以它实际上最终可能成为一个巨大的瓶颈。你应该对此小心。

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2017-08-12T16:02:23.907

我问了一个[与 LinkedList 集合性能相关的类似问题](https://stackoverflow.com/questions/45643556/how-to-make-improve-performance-on-my-implement-of-this-linkedlist)，发现[Steven Cleary 的 Deque 的 C# 实现](https://github.com/StephenClearyArchive/Deque/blob/master/Source/PortableClassLibrary/Deque.cs)是一个解决方案。与 Queue 集合不同，Deque 允许前后移动项目。它类似于链表，但性能有所提高。

# php - 模拟测试和 PHP 的神奇 __get 方法

> ID：169981
> 
> 赞同：4
> 
> 时间：2008-10-04T08:28:23.043
> 
> 标签：php, testing

`__get`尝试使用and`__set`方法（使用[simpletest](http://simpletest.org/) ）模拟对象时遇到问题。

为 for 编写模拟响应`__get`并不正确 - 测试似乎与实现紧密相关。有什么测试建议，还是我应该完全避免使用魔法方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T02:37:30.393

我遇到了同样的问题，并在 SimpleTest 测试用例中找到了解决方案：

从 mock_objects_test.php：

```
class ClassWithSpecialMethods {
    function __get($name) { }
    function __set($name, $value) { }
    function __isset($name) { }
    function __unset($name) { }
    function __call($method, $arguments) { }
    function __toString() { }
}
Mock::generate('ClassWithSpecialMethods'); 
```

...剪断...

```
function testReturnFromSpecialAccessor() {
    $mock = new MockClassWithSpecialMethods();
    $mock->setReturnValue('__get', '1st Return', array('first'));
    $mock->setReturnValue('__get', '2nd Return', array('second'));
    $this->assertEqual($mock->first, '1st Return');
    $this->assertEqual($mock->second, '2nd Return');
}

function testcanExpectTheSettingOfValue() {
    $mock = new MockClassWithSpecialMethods();
    $mock->expectOnce('__set', array('a', 'A'));
    $mock->a = 'A';
} 
```

有点笨拙，但它有效。另一方面，我认为你最好避免使用它们……我正在处理的大型企业系统大量使用它们，理解/可视化/调试/做任何事情都是一场噩梦！

# database - 您对审计功能 (Oracle) 有何经验？

> ID：169989
> 
> 赞同：3
> 
> 时间：2008-10-04T08:32:26.873
> 
> 标签：database, oracle

您是否曾经在生产数据库上使用过 Oracle 审计功能？

这对性能有何影响？您注意到不同版本的 Oracle 之间是否存在差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-04T09:11:17.917

性能方面，您需要审核大量信息才能使 Oracle 10.2 FGA 成为一个重大问题。我没有使用过早期版本或 11g。

即使只是出于可管理性的原因，您也只需要查看审核相关信息......从我的脑海中，我不明白为什么 CPU/IO 利用率会比大多数企业应用程序的正常利用率高出几个百分点.

# flash - 您可以在另一个目录中加载 FLVPlayback 皮肤 SWF 吗？

> ID：169996
> 
> 赞同：0
> 
> 时间：2008-10-04T08:36:46.490
> 
> 标签：flash, flvplayback

根据这个[Adob​​e KB 技术说明](http://kb.adobe.com/selfservice/viewContent.do?externalId=608abffd)，是否有任何方法可以将 FLVPlayback 皮肤 SWF 与加载容器 SWF 的 HTML 文件放在同一目录中？不得不将 SWF 放在我网站的根目录中，这让我很痛苦。

我认为在 iframe 中加载 Flash 视频可以解决这个问题，但这是一个好习惯吗？由于浏览器之间的填充、边距和大小问题，我通常会回避使用 iframe。也许这不再是 CSS 的问题了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T12:16:18.417

好吧，您可以将皮肤放在另一个目录中，只要您在组件检查器中为您的 FLV 播放组件的“皮肤”参数中指定路径（相对于加载的 HTML）。如果您使用 Firebug 中的 Net 面板或类似工具，故障排除非常容易。

只要您注意 iframe 内没有边距或填充，使用 iframe 就可以工作并且不会导致渲染问题。但是，您将需要另一个 HTML 文件，这会使维护您的网站更加麻烦。

[如果您要发布大量视频文件，您可能会发现使用JW Media Player](http://www.jeroenwijering.com/?item=JW_FLV_Player)等独立播放器会更方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T21:17:26.147

您可以通过两种方式为 FLVPlayback 组件设置不同的 URL：

1) 在“属性”窗口的“组件参数”部分，皮肤列表底部的方式是“自定义 URL”选项。在那里设置它的路径。

2) 您可以通过 Actionscript 使用您的 FLVPlayback 实例的 'skin' 参数来设置它，例如：myFlv.skin="path/to/myRadSkin.swf"。如果需要，这是您可以动态设置皮肤的唯一方法。

要使用 #2，您的实例必须已使用 new 语句在代码中创建。您不能动态更改拖动到舞台的现有实例的外观。******************