# StackOverflow 问答 000635000-000635999

# php - 框架 - 什么是 PHP 框架？

> ID：635007
> 
> 赞同：6
> 
> 时间：2009-03-11T15:18:16.087
> 
> 标签：php, frameworks

与直接编写 PHP 代码相比，使用 PHP 框架有哪些优点/缺点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-11T15:27:07.783

框架为您提供典型问题的标准解决方案，例如，在线商店可以涵盖客户登录（包括会话处理）、购物车、下订单等功能......

使用框架的最大优势在于

1.  您无需重新发明轮子，代码已经存在
2.  代码（通常）有效，它已经过测试
3.  特别是对于用户身份验证，您很可能会遇到更少的安全漏洞，就像您自己从头开始发明一样

最大的缺点是

1.  如果你想扩展功能，你必须了解 OPC（*别人的代码*）
2.  如果框架包含安全漏洞并且存在可用漏洞，您的站点将立即易受攻击，但您可能不具备自行修复它的知识。因此，您需要时刻关注安全公告、更新、修复等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T15:27:14.147

框架是一个库。您需要花费时间来学习如何使用库，但是一旦您知道它是如何工作的，您就应该多次收回您的投资。

当您使用 PHP 创建（通常是数据库驱动的）网站时，PHP Web 框架将此原则应用于您所做的所有常见事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T15:22:04.707

1.[使用 MVC 框架比 Drupal 构建大型网站有什么优势？](https://stackoverflow.com/questions/520225/what-are-the-advantages-of-using-an-mvc-framework-over-e-g-drupal-to-build-a-lar)

2.[什么是php框架，什么是好的框架？](https://stackoverflow.com/questions/301240/whats-a-php-framework-and-whats-a-good-one)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T15:20:09.063

[什么是 PHP 框架，什么是好的框架？](https://stackoverflow.com/questions/301240/whats-a-php-framework-and-whats-a-good-one)欺骗..

[http://www.google.com/search?hl=de&safe=off&rlz=1C1GGLS_enDE309DE309&q=whats+a+php+framework&btnG=Suche&lr=](http://www.google.com/search?hl=de&safe=off&rlz=1C1GGLS_enDE309DE309&q=whats+a+php+framework&btnG=Suche&lr=)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T15:26:33.650

正如 Tomas 和 Ngu 所指出的，您的问题是重复的。

我建议您首先阅读什么是 Web 框架。 [http://en.wikipedia.org/wiki/Web_application_framework](http://en.wikipedia.org/wiki/Web_application_framework)

# functional-programming - 在 OCaml 中操作列表

> ID：635008
> 
> 赞同：2
> 
> 时间：2009-03-11T15:18:25.917
> 
> 标签：functional-programming, list, ocaml, variable-assignment

在以下上下文中，我在处理 OCaml 中深度嵌套的列表时遇到问题。

```
class foo (pIn:int)=
object (self)
    val p = pIn
    val even = if (pIn mod 2) = 0 then true else (false)
    method doIt = "doIt"
    method isEven = even
    method getP = p
end;;

let rec createListOfElements howMany =  (
    Random.self_init ();
    if howMany > 1 then ((new foo (Random.int 10))::(createListOfElements (howMany - 1)))
    else ([(new foo (Random.int 10))])  );;

let myList = createListOfElements 5;;

let rec process1 param =
     if param <= 10 then
          let f = new foo param in          (
                if f#isEven then (myList <- List.append myList (createListOfElements f#getP));
                Printf.printf "%s\n" f#doIt;
                process1 (param+1)                                  )
in process1 0;; 
```

我得到的错误是“未绑定的实例变量 myList”。在这种情况下，如何将“List.append myList (createListOfElements f#getP) 的结果分配给 myList？

谢谢！

* * *

编辑功能：

```
let myList = ref (createListOfElements 5);;

let rec process1 param =
     if param <= 10 then
          let f = new foo param in          (
                if f#isEven then (myList <- !myList @ (createListOfElements f#getP));
                Printf.printf "%s\n" f#doIt;
                process1 (param+1)                                  )
in process1 0;; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T15:29:16.390

您必须使用引用来破坏持久性——因为函数式编程使用持久性数据。`ref`在 myList 的声明中使用关键字：

```
let myList = ref (createListOfElements 5) 
```

要取消引用列表使用`!`，所以有问题的行变成

```
if f#isEven then
  myList := !myList @ f#getP; 
```

我建议您使用累加器，因为它本着函数式编程风格的精神，如下所示：

```
let rec process1 lst = function
  | x when x <= 10 ->
      let f = new foo x in
      if f#isEven then
          process1 (lst @ (createListOfElements f#getP)) (param+1)
      else
          process1 lst (param+1)
  | _ -> lst 
```

**编辑：**

我没有编译我的代码，也没有注意到您使用了错误的符号来更改引用的值。正确的符号是，`:=`。请参阅上面的更改。不过，我强烈建议您避免引用，并走累积路线。

# c# - C# 编译器是否设置版本或平台常量？

> ID：635011
> 
> 赞同：4
> 
> 时间：2009-03-11T15:19:07.567
> 
> 标签：c#, .net, compiler-version

C# 编译器中是否有任何预定义的常量来检测目标平台的版本？

我可以在项目选项中设置平台，但如何为 .NET 2 和 .NET 3.5 编写单一源代码？

编辑：我真的很想编写一些代码，并且能够使用#if CLR_VERSION35 之类的东西来切换行为，然后运行不同的配置。

反过来的问题：如果我进行 CLR35 和 CLR20 配置，是否可以基于此选择目标平台？该选项在 VS2008 中不可用，我对 MSBUILD 还不太了解。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T15:29:41.503

.NET Framework 3.5 是 2.0 的超集，因此所有 2.0 应用程序都应该在 3.5 上运行而无需修改。因为它是一个超集，所以如果您的应用程序发现自己在 2.0 上，那么没有办法不使用 3.5 功能，这无论如何都没有意义。

如果您需要以 2.0 为目标，并且可以在 2.0 中编写您需要的内容，那么这就是要走的路，3.5 仍然可以正常运行您的应用程序。实际上，您必须编写最小公分母或在安装程序中包含 3.5 运行时可再发行组件，以确保您的客户为您的应用程序提供正确的环境。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T15:23:47.027

在 VS2008 中，您可以在项目属性中设置目标框架（解决方案资源管理器，右键单击项目）。您还可以在创建新项目时选择，在新项目窗口的右上角有一个下拉菜单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T15:40:56.377

据我所知，除了 DEBUG 和 RELEASE 之外，还没有。我会保存搜索并在项目属性“构建”选项卡“条件编译符号”中定义我自己的。

如果有任何用处，请在[此博客](http://www.dijksterhuis.org/csharp-preprocessor-directives-explained/)上提供更多信息

# java - 在 Java 中使用任意对象作为 Map 键有什么缺点吗？

> ID：635014
> 
> 赞同：6
> 
> 时间：2009-03-11T15:21:03.007
> 
> 标签：java, collections, maps

我的应用程序中有两种对象，其中一种对象恰好有一个对应的另一种对象。

跟踪这种关系的明显选择是`Map<type1, type2>`，例如 HashMap。但不知何故，我很怀疑。我可以在 Map 中使用一个对象作为键，传递它，让它也放在另一个集合中，并随时从 Map 中检索它的伙伴吗？

创建对象后，我传递的只是一个标识符，对吗？所以那里可能没有问题。如果我序列化和反序列化密钥怎么办？

还有其他注意事项吗？我是否应该使用其他东西来关联对象对，例如我自己生成的数字？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-11T15:25:43.260

1.  关键需要落实`.equals()`和`.hashCode()`正确
2.  密钥在用作密钥时*不得*以任何改变其值的方式进行更改`.hashCode()`
3.  理想情况下，任何用作 a 中的键的对象`HashMap`都应该是不可变的。这将自动确保 2\. 始终为真。
4.  否则可能会被 GC 处理的对象在用作键和/或值时可能会被保留。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-11T15:26:32.090

> 我的应用程序中有两种对象，其中一种对象恰好有一个对应的另一种对象。

这听起来确实像一个有关系，因此可以使用一个简单的属性来实现。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T15:30:37.743

这取决于您选择的地图的实现：

*   **HashMap**使用**equals()**和**hashCode()**。默认情况下（在对象中），这些基于对象标识，除非您序列化/反序列化，否则它将正常工作。根据对象的内容正确实现 equals() 和 hashCode() 不会有任何问题，只要在它是哈希映射中的键时不对其进行修改。

*   **TreeMap**使用**compareTo()**。没有默认实现，因此您需要提供一个。与上面实现 hashCode() 和 equals() 的限制相同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T15:28:11.757

您可以使用标准 Map，但这样做会在 Map 中保留对对象的强引用。如果您的对象在另一个结构中被引用，并且您需要 Map 只是将它们链接在一起，请考虑使用 Wea​​kHashMap。

顺便说一句，除非您必须将对象的多个实例视为相等，否则您不必覆盖 equals 和 hashCode...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T15:30:08.087

> 我可以在 Map 中使用一个对象作为键，传递它，让它也放在另一个集合中，并随时从 Map 中检索它的伙伴吗？

是的，这里完全没有问题。

> 创建对象后，我传递的只是一个标识符，对吗？所以那里可能没有问题。如果我序列化和反序列化密钥怎么办？

没错，您只是在传递一个引用——它们都将指向同一个实际对象。如果您序列化或反序列化对象，则会创建一个新对象。但是，如果您的对象正确实现了 equals 和 hashCode，您应该仍然能够使用新的反序列化对象从地图中检索项目。

> 还有其他注意事项吗？我是否应该使用其他东西来关联对象对，例如我自己生成的数字？

至于注意事项，是的，当对象在 Map 中时，您不能更改任何会导致对象的 hashCode 更改的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T15:25:45.383

任何对象都可以是映射键。这里重要的是确保为将用作映射键的任何对象覆盖 .equals() 和 .hashCode()。

这样做的原因是，如果不这样做，equals 将被理解为对象相等，并且您能够找到“相等”映射键的唯一方法是拥有原始对象本身的句柄。

您覆盖哈希码是因为它需要与 equals 一致。这是为了使您定义为 equals 的对象具有相同的哈希值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T15:25:56.630

故障点是 hashcode 和 equals 函数。如果它们不能产生一致且正确的返回值，则 Map 的行为会很奇怪。[Effective Java](https://rads.stackoverflow.com/amzn/click/com/0321356683)有一个完整的章节，强烈推荐。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-11T15:35:50.257

您可能会考虑 Google Collection 的[BiMap](http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/BiMap.html)。

# c# - 我什么时候在 asp.net 中使用委托？

> ID：635015
> 
> 赞同：9
> 
> 时间：2009-03-11T15:21:52.053
> 
> 标签：c#, asp.net, delegates

我一直在寻找一种方法来使用我能使用的所有工具，并让自己超越我所处的位置。但是，尽管我读过很多关于委托的文章，但我永远找不到使用它们的地方（比如接口、泛型和很多东西，但我离题了。）我希望有人能告诉我他们何时以及如何使用委托在asp.net c#（2.0 及更高版本）的*网络编程中。*

谢谢，如果 Stack Overflow 有问题，请告诉我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T15:33:29.110

bdukes 对事件的看法是正确的。但您不仅限于将委托与事件一起使用。

研究经典的观察者模式以获取更多关于使用委托的示例。模式上的一些文本指向事件模型，但从原始学习的角度来看，您不必使用事件。

要记住的一件事：委托只是另一种可以使用和传递的类型，类似于您的原始类型，例如“int”。就像“int”一样，委托具有自己的特殊特征，当您使用委托类型时，您可以在编码中对其进行操作。

要真正了解该主题以及其中一些更高级和详细的方面，请阅读 Joe Duffy 的书[.NET Framework 2.0](http://www.bookpool.com/sm/0764571354)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-11T15:24:47.053

好吧，每当您处理事件时，您都在使用委托。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T15:27:11.493

首先回答你的第二个问题，我认为这对 StackOverflow 来说是一个很好的问题！

第一个例子是排序。List 上的 Sort() 方法需要一个委托来进行排序，Find() 方法也是如此。我不太喜欢在数据库中进行排序，所以我喜欢在我的结果集上使用 Sort()。毕竟，列表的顺序（通常）更多是 UI 问题，而不是业务规则问题。

编辑：我已将我在数据库之外排序的原因添加到[此处](https://stackoverflow.com/questions/326634/sorting-on-the-server-or-on-the-client/635179#635179)的适当问题中。

编辑：排序例程中使用的比较函数是委托。因此，如果您使用 .Sort(Comparison(T)) 方法对 List 进行排序，则传递给 sort 函数的 Comparison(T) 方法是一个委托。请参阅 .Sort(Comparison(T))[文档](http://msdn.microsoft.com/en-us/library/w56d4y5z.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T16:46:05.423

我想到的另一个快速示例是使用 Rhino Mocks 进行单元测试。你可以用 Rhino Mocks 做的很多事情都利用了委托和 lambda 表达式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T19:10:39.010

每当您知道要执行某些操作时，都可以使用委托，但该操作的详细信息将取决于具体情况。

除其他外，我们将委托用于：

*   排序和过滤，特别是如果用户可以在不同的排序/过滤标准之间进行选择
*   简化代码。例如，一个较长的过程，开始和结束总是相同的，但中间有一点点不同。我没有在中间有一个难以阅读的 if 块，而是为整个过程提供了一种方法，并为中间位传递了一个委托（Action）。
*   我的表示层中有一个非常有用的 ToString 方法，它将任何东西的集合转换为逗号分隔的列表。方法参数是一个 IEnumerable 和一个 Func 委托，用于将集合中的每个 T 转换为字符串。它同样适用于按名字将用户串在一起或按 ID 列出项目。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T15:26:52.493

与委托相关的 asp.net 没有什么特别之处（除了使用异步东西时的考虑，这是一个完全不同的问题），所以我将向您指出其他问题：

[委托用法：业务应用程序](https://stackoverflow.com/questions/628803/delegate-usage-business-applications)

[我在哪里使用代表？](https://stackoverflow.com/questions/31497/where-do-i-use-delegates)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-11T15:39:13.620

另一个例子是发布用户控件的事件。

例如。

```
// In your user control
public delegate void evtSomething(SomeData oYourData);
public event evtSomething OnSomething;

// In the page using your user control
ucYourUserControl.OnSomething += ucYourUserControl_OnSomething;

// Then implement the function
protected void ucYourUserControl_OnSelect(SomeData oYourData)
{
   ...
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-11T19:10:22.800

最近我使用代表来“委托”检查权限。

公共功能检查权限；

这样，CheckPermission 函数可以被各种控件或类共享，比如在静态类或实用程序类中，仍然可以集中管理，避免接口爆炸；只是一个想法

# .net - 在 VS2008 中查看当前的程序集版本号

> ID：635018
> 
> 赞同：2
> 
> 时间：2009-03-11T15:22:20.243
> 
> 标签：.net, visual-studio-2008, assemblies, versioning

我想知道是否有办法在 Visual Studio 2008 IDE 中查看上次完成构建的程序集版本号。我不想看到 Assembly Information 对话框或 AssemblyInfo 文件中的 1.0.*，而是看到完整版本（* 替换为实数）。我也不想显示项目的可执行文件或程序集的属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T15:58:59.563

好的，我想我现在更好地解决了您的问题，您想查看内部版本号是多少，而无需实际构建...如，Visual Studio 如何知道其设置为 * 时的下一个数字是什么？

如果您使用自动构建编号，假设您有 1.0.* 并且 VS 构建一个值，例如 1.0.3245.1234

3245 是自 2000 年 1 月 1 日以来的天数

1234 是自午夜以来的秒数，除以二。

回答您的编辑：

我唯一能想到的在不执行程序集内的某些代码或检查文件属性的情况下获取内部版本号的是进行某种构建后事件，该事件检查程序集的属性并弹出一个消息框显示它，或者更好的是，用内部版本号在 AssemblyInfo.cs 文件的顶部写一条评论

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T15:23:56.400

```
Assembly.GetExecutingAssembly().FullName. 
```

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.fullname.aspx)：

```
using System;
using System.Reflection;

class Example
{
    static void Main()
    {
        Console.WriteLine("The FullName property (also called the display name) of...");
        Console.WriteLine("...the currently executing assembly:");
        Console.WriteLine(Assembly.GetExecutingAssembly().FullName);

        Console.WriteLine("...the assembly that contains the Int32 type:");
        Console.WriteLine(typeof(int).Assembly.FullName);
    }
}

/* This example produces output similar to the following:

The FullName property (also called the display name) of...
...the currently executing assembly:
SilverlightApplication, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
...the assembly that contains the Int32 type:
mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
 */ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T15:27:27.827

一种简化的方法，

```
Application.ProductName;
Application.ProductVersion; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T15:32:47.923

属性中的 Assembly Info 框指向项目中的一个文件，通常称为 AssemblyInfo.cs（在 Properties 文件夹中）。那是设置版本的实际代码所在的位置，查看该文件可能比浏览设置更容易。

**编辑**：
现在我明白了这个问题。这是一个生成的数字，不会以我知道的任何方式通过 Visual Studio 公开。

**编辑 2**：
如果您愿意依赖[PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)，您可以创建一个构建后事件或一个[外部工具菜单项](http://msdn.microsoft.com/en-us/library/9814d200.aspx)来调用该程序集上的 .NET 方法以获取其版本...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-19T13:40:38.330

我建议对您的构建过程进行一些小改动，以便每次编译时都会在输出区域中显示版本号。其实很简单：

右键单击您的项目并选择“卸载项目”。你所有的代码都“消失”了，但没有必要惊慌。

再次右键单击它，然后选择“编辑...”。这会以 xml 格式打开 proj 文件，您现在可以在标签中添加这段代码`<ProjectExtensions>`。

```
<Target Name="AfterBuild">
  <GetAssemblyIdentity AssemblyFiles="$(TargetPath)">
    <Output TaskParameter="Assemblies" ItemName="MyAssemblyIdentities"/>
  </GetAssemblyIdentity>
  <Message Text="AssemblyVersion: %(MyAssemblyIdentities.Version)" 
    Importance="high" />
</Target> 
```

保存并关闭文件。右键单击并选择“重新加载项目”。这将像以前一样恢复项目。

编译，你会在输出窗口中看到一个新的文本行：

装配版本 = 1.0.3518.36887

就是这样。

正是这一集 DnrTV，[MS Build 上的 Sayed](http://www.dnrtv.com/default.aspx?showNum=145) Hashimi，让我对 MSBuild 和所有你能做的很酷的事情大开眼界。强烈推荐。:)

# c# - 我的 32 位头痛现在是 64 位偏头痛？！？（或 64 位 .NET CLR 运行时问题）

> ID：635019
> 
> 赞同：9
> 
> 时间：2009-03-11T15:22:32.240
> 
> 标签：c#, .net, vb.net, clr, jit

从在 64 位 JIT 和 32 位 JIT 下运行 .NET 应用程序切换时，在性能、内存等方面发生了哪些不寻常的、意想不到的后果？我对好的方面感兴趣，但对人们遇到的令人惊讶的坏问题更感兴趣。

我正在编写一个新的 .NET 应用程序，它将同时部署在 32 位和 64 位上。与移植应用程序有关的问题有很多问题 -[从编程/移植的角度来看，我并不关心“陷阱”](http://msdn.microsoft.com/en-us/library/ms241064.aspx)。（即：正确处理本机/COM 互操作、嵌入在结构中的引用类型改变结构的大小等）

然而，[这个问题及其答案](https://stackoverflow.com/questions/632831/why-are-public-fields-faster-than-properties)让我思考——我忽略了哪些其他问题？

有很多问题和博客文章绕开了这个问题，或者触及了它的一个方面，但我还没有看到任何东西可以汇编出一份体面的问题清单。

特别是 - 我的应用程序非常受 CPU 限制，并且具有巨大的内存使用模式（因此首先需要 64 位），并且本质上是图形化的。我担心在 64 位 Windows（使用 .NET 3.5sp1）上运行的 CLR 或 JIT 中可能存在哪些其他隐藏问题。

以下是我目前知道的几个问题：

*   （[现在我知道了](https://stackoverflow.com/questions/632831/why-are-public-fields-faster-than-properties)）属性，即使是自动属性，也不会在 x64 中内联。
*   应用程序的内存配置文件发生变化，既是因为[引用的大小](https://stackoverflow.com/questions/426396/how-much-memory-does-a-c-net-object-use)，也因为内存分配器具有不同的性能特征
*   [x64 上的启动时间可能会受到影响](https://stackoverflow.com/questions/270614/-net-3-5-windows-forms-application-x86-vs-x64-load-times-on-64-bit-vista)

我想知道人们在 64 位 Windows 上的 JIT 中发现了哪些其他具体问题，以及是否有任何性能变通方法。

谢谢你们！

- - 编辑 - - -

只是为了澄清 -

我知道尝试及早优化通常是不好的。我知道第二次猜测系统通常是不好的。我也知道 64 位的可移植性有其自身的问题——我们每天在 64 位系统上运行和测试以帮助解决这个问题。等等

但是，我的应用程序不是您的典型业务应用程序。这是一个科学的软件应用程序。我们有许多进程在所有内核（它是高度线程化的）上一次使用 100% 的 CPU 数小时。

我花了很多时间来分析应用程序，这会产生很大的不同。但是，大多数分析器禁用了 JIT 的许多功能，因此当您在分析器下运行时，可能很难确定内存分配、JIT 内联等小细节。因此我需要这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-25T14:34:57.267

.NET 中一个特别麻烦的性能问题与糟糕的 JIT 相关：

[https://connect.microsoft.com/VisualStudio/feedback/details/93858/struct-methods-should-be-inlined?wa=wsignin1.0](https://connect.microsoft.com/VisualStudio/feedback/details/93858/struct-methods-should-be-inlined?wa=wsignin1.0)

基本上，内联和结构在 x64 上不能很好地协同工作（尽管该页面*表明*内联现在可以工作，但随后的冗余副本并没有消除，考虑到微小的性能差异，这听起来很可疑）。

无论如何，在与 .NET 搏斗足够长的时间之后，我的解决方案是使用 C++ 来处理任何数字密集型的事情。即使在 .NET 的“好”情况下，您不处理结构并使用优化边界检查的数组，C++ 也胜过[.NET](http://eamon.nerbonne.org/2009/02/net-numeric-performance-disappointing.html)。

如果您正在做比点积更复杂的事情，那么情况会很快变得更糟；.NET 代码更长 + 可读性更低（因为您需要手动内联内容和/或不能使用泛型），而且速度要慢得多。

我已经转而在 C++ 中使用[Eigen](http://eigen.tuxfamily.org/index.php?title=Main_Page)：它绝对很棒，代码可读性强，性能高；然后，一个精简的 C++/CLI 包装器提供了计算引擎和 .NET 世界之间的粘合剂。

Eigen 通过模板元编程工作；in 将向量表达式编译为 SSE 内在指令，并为您执行许多最讨厌的与缓存相关的循环展开和重新排列；虽然专注于线性代数，但它也适用于整数和非矩阵数组表达式。

因此，例如，如果`P`是一个矩阵，这种东西就可以工作：

```
1.0 /  (P.transpose() * P).diagonal().sum(); 
```

...它不分配 P 的临时转置变体，也不计算整个矩阵乘积，而只计算它需要的字段。

因此，如果您可以在完全信任下运行 - 只需通过 C++/CLI 使用 C++，它就会工作得更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T15:49:08.603

我记得我经常从一个 IRC 频道听到一个问题。在这种情况下，它优化了临时副本：

```
EventHandler temp = SomeEvent;
if(temp != null)
{
    temp(this, EventArgs.Empty);
} 
```

放回竞争条件并导致潜在的空引用异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T15:32:49.080

大多数情况下，Visual Studio 和编译器在向您隐藏问题方面做得很好。但是，我知道如果您将应用程序设置为自动检测平台（x86 与 x64）*并且*对 32 位第 3 方 dll 有任何依赖关系，可能会出现一个主要问题。在这种情况下，在 64 位平台上，它将尝试使用 64 位约定和结构调用 dll，但它不起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T15:38:34.900

您提到了移植问题，这些是需要关注的问题。我（显然）不知道你的应用程序，但试图猜测 JIT 通常完全是浪费时间。编写 JIT 的人对 x86/x64 芯片架构有着深入的了解，并且很可能比地球上任何其他人都知道哪些性能更​​好，哪些性能更​​差。

是的，您可能有一个不同且独特的极端案例，但如果您“正在编写*新*应用程序”，那么我不会担心 JIT 编译器。很可能有一个愚蠢的循环可以在某个地方避免，这将使您从尝试对 JIT 进行二次猜测中获得 100 倍的性能改进。让我想起了我们在编写 ORM 时遇到的问题，我们会查看代码并认为我们可以从中提取一些机器指令......当然，代码然后通过网络连接到数据库服务器，所以我们在其他地方以毫秒为界的过程中修剪了微秒。

性能调整的通用规则...如果您没有测量您的性能，您不*知道*您的瓶颈在哪里，您只是*认为*您知道...您可能错了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-11T21:48:47.703

关于 Quibblesome 的回答：

我尝试在没有调试器的情况下在我的 Windows 7 x64 中以发布模式运行以下代码，并且**从未抛出**NullReferenceException 。

```
using System;
using System.Threading;

namespace EventsMultithreadingTest
{
    public class Program
    {
        private static Action<object> _delegate = new Action<object>(Program_Event);
        public static event Action<object> Event;

        public static void Main(string[] args)
        {
            Thread thread = new Thread(delegate()
                {
                    while (true)
                    {
                        Action<object> ev = Event;

                        if (ev != null)
                        {
                            ev.Invoke(null);
                        }
                    }
                });
            thread.Start();

            while (true)
            {
                Event += _delegate;
                Event -= _delegate;
            }
        }

        static void Program_Event(object obj)
        {
            object.Equals(null, null);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-06T07:57:48.833

我相信 64 JIT 尚未完全开发/移植以利用此类 64 位架构 CPU，因此它存在问题，您可能会获得程序集的“模拟”行为，这可能会导致问题和意外行为。我会研究可以避免这种情况的情况和/或看看是否有好的快速 64 c++ 编译器来编写时间关键的计算和算法。但是，即使您很难找到信息或没有时间阅读反汇编代码，我很确定在托管代码之外进行大量计算会减少您可能遇到的任何问题并提高性能[有点确定您已经在这样做但只是提一下:)]

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-06T08:34:22.757

探查器不应显着影响您的计时结果。如果探查器开销*确实*“显着”，那么您可能无法从代码中挤出更多的速度，并且应该考虑查看您的硬件瓶颈（磁盘、RAM 还是 CPU？）并进行升级。（听起来你受 CPU 限制，所以这就是开始的地方）

一般来说，.net 和 JIT 可以让您摆脱 64 位的大部分移植问题。如您所知，存在与寄存器大小相关的影响（内存使用变化、编组为本机代码、需要程序的所有部分都是本机 64 位构建）和一些性能差异（更大的内存映射、更多寄存器、更宽的总线等等），所以我不能告诉你任何比你在这方面已经知道的更多的事情。我看到的其他问题是操作系统而不是 C# 问题——例如，现在有不同的注册表配置单元用于 64 位和 WOW64 应用程序，因此必须仔细编写一些注册表访问。

担心 JIT 将如何处理您的代码并尝试对其进行调整以使其更好地工作通常是一个坏主意，因为 JIT 可能会随着 .net 4、5 或 6 的变化而发生变化，并且您的“优化”可能会变得效率低下，或更糟糕的是，错误。还要记住，JIT 专门为运行它的 CPU 编译代码，因此对您的开发 PC 的改进可能不会是对不同 PC 的改进。在今天的 CPU 上使用今天的 JIT 所得到的结果可能会在几年后升级某些东西时给您带来麻烦。

具体来说，您引用“x64 上未内联属性”。当您运行整个代码库将所有属性转换为字段时，很可能会有一个新的 64 位 JIT 执行内联属性。实际上，它可能比您的“解决方法”代码表现得更好。让 Microsoft 为您优化。

你正确地指出你的记忆档案可以改变。因此，您可能需要更多 RAM、更快的虚拟内存磁盘和更大的 CPU 缓存。所有硬件问题。您可以通过使用（例如） Int32 而不是 int 来减少影响，但这可能不会产生太大影响并且可能会损害性能（因为您的 CPU 可能比半尺寸 32 位值更有效地处理本机 64 位值）。

您说“启动时间可以更长”，但这在您说以 100% CPU运行*数小时*的应用程序中似乎无关紧要。

那么你真正担心的是什么？也许你的代码在 32 位 PC 上计时，然后在 64 位 PC 上执行相同的任务。跑 4 小时有半小时的差异吗？还是相差只有3秒？还是 64 位 PC 实际上更快？也许您正在寻找不存在的问题的解决方案。

所以回到通常的、更通用的建议。识别瓶颈的概况和时间。查看您正在应用的算法和数学过程，并尝试用更有效的算法和数学过程来改进/替换它们。检查您的多线程方法是否有助于而不是损害您的性能（即避免等待和锁定）。尝试减少内存分配/释放 - 例如重用对象而不是用新对象替换它们。尽量减少频繁的函数调用和虚函数的使用。切换到 C++ 并摆脱 .net 强加的垃圾收集、边界检查等固有开销。嗯。这些都与 64 位无关，不是吗？

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-11T15:26:44.803

我对 64 位问题不太熟悉，但我确实有一条评论：

> 我们应该忘记小的效率，比如大约 97% 的时间：过早优化是万恶之源。——唐纳德·克努斯

# javascript - 在javascript中计算对比色

> ID：635022
> 
> 赞同：15
> 
> 时间：2009-03-11T15:23:18.087
> 
> 标签：javascript, color-scheme

在我们目前正在处理的页面之一上，用户可以更改显示文本的背景。

我们希望自动更改前景色以保持文本的*合理*对比度。

我们还希望颜色范围可以随意选择。例如，如果背景以 255 个增量从白色变为黑色，我们不希望看到 255 种前景色。在这种情况下，也许是 2 到 4，只是为了保持*合理*的对比度。

那里有任何 UI/设计/色彩专家/画家来制定公式吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2011-06-28T18:50:30.893

根据亮度做出黑白决定对我来说效果很好。亮度是 R、G 和 B 值的加权和，根据人类对相对亮度的感知进行调整，这在视频应用中显然很常见。亮度的官方定义随着时间的推移发生了变化，具有不同的权重；见这里：[http://en.wikipedia.org/wiki/Luma_(video)](http://en.wikipedia.org/wiki/Luma_%28video%29)。我使用 Rec 获得了最好的结果。709 版本，如下面的代码所示。黑白阈值可能为 165 似乎不错。

```
function contrastingColor(color)
{
    return (luma(color) >= 165) ? '000' : 'fff';
}
function luma(color) // color can be a hx string or an array of RGB values 0-255
{
    var rgb = (typeof color === 'string') ? hexToRGBArray(color) : color;
    return (0.2126 * rgb[0]) + (0.7152 * rgb[1]) + (0.0722 * rgb[2]); // SMPTE C, Rec. 709 weightings
}
function hexToRGBArray(color)
{
    if (color.length === 3)
        color = color.charAt(0) + color.charAt(0) + color.charAt(1) + color.charAt(1) + color.charAt(2) + color.charAt(2);
    else if (color.length !== 6)
        throw('Invalid hex color: ' + color);
    var rgb = [];
    for (var i = 0; i <= 2; i++)
        rgb[i] = parseInt(color.substr(i * 2, 2), 16);
    return rgb;
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-11T15:31:29.347

就纯粹的可读性而言，您希望在任何背景上使用黑白文本。因此将 RGB 转换为 HSV，只需检查 V 是否 < 0.5。如果是，则为白色，如果不是，则为黑色。

首先尝试一下，看看你是否觉得它有吸引力。

如果你不这样做，那么当你的背景太亮或太暗时，你可能希望白色和黑色不要太鲜明。要淡化它，请保持相同的色调和饱和度，并使用这些值作为亮度：

```
background V  foreground V
0.0-0.25      0.75
0.25-0.5      1.0
0.5-0.75      0.0
0.75-1.0      0.25 
```

在中等颜色上，您仍然会看到易于阅读的黑色或白色文本。在深色或浅色上，您会看到相同的颜色文本，但亮度至少相差 3/4，因此仍然可读。我希望它看起来不错:)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-11T16:54:26.777

试试[这个例子](http://www.things.org.uk/examples/colourcontrast.html)，它只是根据 r、g 和 b 值的平均值将其设置为黑色或白色。也适合测试！如果您发现效果不佳的情况，请在其中替换更好的算法。

```
<html> 
<head> 
<script> 
function rgbstringToTriplet(rgbstring)
{
    var commadelim = rgbstring.substring(4,rgbstring.length-1);
var strings = commadelim.split(",");
var numeric = [];
for(var i=0; i<3; i++) { numeric[i] = parseInt(strings[i]); }
return numeric;
}

function adjustColour(someelement)
{
   var rgbstring = someelement.style.backgroundColor;
   var triplet = rgbstringToTriplet(rgbstring);
   var newtriplet = [];
   // black or white:
   var total = 0; for (var i=0; i<triplet.length; i++) { total += triplet[i]; } 
   if(total > (3*256/2)) {
     newtriplet = [0,0,0];
   } else {
 newtriplet = [255,255,255];
   }
   var newstring = "rgb("+newtriplet.join(",")+")";
   someelement.style.color = newstring;
   return true;
}

function randomiseBackground(someelement)
{
 var vals = [];
 for(var i=0; i<3; i++) { vals[i]=Math.floor(Math.random()*256+1); }
 someelement.style.backgroundColor="rgb("+vals.join(",")+")";
 return true;
}
</script> 
</head> 
<body onload="adjustColour(document.getElementById('mypara'));"> 
<p id="mypara" style="background-color:#2287ea">Some text</p> 
<form> 
    <input type=button onclick="var elem=document.getElementById('mypara'); randomiseBackground(elem); adjustColour(elem);" value="randomise background" /> 
</form> 
</body> 
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T15:25:37.067

您可能想要改变色调，而不是饱和度或值。

因此，将您的 RGB 值转换为 HSV，将 180 度添加到 H（当然是模 360 度），然后转换回 RGB。

[转换论坛在这里](http://en.wikipedia.org/wiki/HSL_color_space)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T15:44:01.003

由于 javascript 处理十进制值的方式，它的实现有点复杂。为此，我发现让背景更改任何颜色但文本只是在黑白之间切换会更好。如果你使用对比色，很多组合将很难忍受。另请注意，有些人是色盲，因此从可访问性的角度来看，这不是一个好主意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-15T08:51:27.703

如果你使用[d3.js](https://github.com/d3/d3#installing)，你可以做一些判断

> `d3.hsl(d3.color("black")).l > 0.5 ? "#000" : "fff"`（简单但未必完美）

或者

> `getLuma(r, g, b, fmt) > 165 ? "#000" : "#fff"`见例 2

## 示例 1

```
<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
  const bgColorList = ["black", "purple", "#cc1515", "green", "blue", "red", "yellow", "white"]
  window.onload = () => {
    d3.select("body").append("section")
      .selectAll("div")
      .data(bgColorList)
      .enter().append("div")
      .text((bgColor, idx, arr) => {
        const div = arr[idx]
        const {h, l} = d3.hsl(d3.color(bgColor))
        const foreColor = l > 0.5 ? "#000" : "#fff"
        div.outerHTML = `<div style="width:100px;height:50px;
background-color: ${bgColor};
color:${foreColor}
">Hello world</div>`
      })
  }
</script>
```

但是当`l`等于0.5时（例如：黄色、蓝色），就会有争议。

## 示例 2

```
<script src="https://d3js.org/d3.v7.min.js"></script>

<table>
  <tr>
    <th>601</th>
    <th>709</th>
    <th>240</th>
  </tr>
  <tr id="output"></tr>
</table>

<script>
  /**
   * https://en.wikipedia.org/wiki/Luma_%28video%29
   * @param {"601"|"709"|"240"|"145"} format
   */
  function getLuma(r, g, b, format) {
    switch (format) {
      case "601":
        return 0.2999 * r + 0.587 * g + 0.114 * b
      case "709":
        return 0.2126 * r + 0.7152 * g + 0.0722 * b
      case "145":
      case "240":
        return 0.212 * r + 0.701 * g + 0.087 * b
    }
  }

  const bgColorList = [...Array(100).keys()].map(t => d3.scaleSequential(d3.interpolateTurbo)(t / 100))
    .concat(["black", "purple", "#cc1515", "green", "blue", "red", "white", "yellow"])
  window.onload = () => {
    const tdArr = []
    d3.select("#output")
      .selectAll("td")
      .data(["601", "709", "240"])
      .enter().append("td")
      .text((fmt, _idx, _arr) => {
        const td = _arr[_idx]
        tdArr.push([td, fmt])
      })

    tdArr.forEach(([td, fmt]) => {
      d3.select(td).append("section")
        .selectAll("div")
        .data(bgColorList)
        .enter().append("div")
        .text((bgColor, idx, arr) => {
          const div = arr[idx]
          const {r, g, b} = d3.color(bgColor)
          const foreColor = getLuma(r, g, b, fmt) > 165 ? "#000" : "#fff"
          // const coefficient = [0.2126, 0.7152, 0.0722]
          // const foreColor = [r, g, b].reduce((sum, color, i) => sum + color * coefficient[i], 0) > 165 ? "#000" : "#fff"
          div.outerHTML = `<div style="width:100px;height:26px;
background-color: ${bgColor};
color:${foreColor}
">Hello</div>`
        })
    })
  }
</script>
```

*这与[enigment的答案相同](https://stackoverflow.com/a/6511606/9935654)*

# c# - SortedDictionary 会自动排序吗？

> ID：635046
> 
> 赞同：3
> 
> 时间：2009-03-11T15:28:02.133
> 
> 标签：c#

我从来没有使用过 SortedDictionary，只是好奇当你向它添加值时，例如，在 for 循环中，当你添加它们时是否会自动对值进行排序，或者你是否必须在添加它们之后对它们进行排序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T15:28:52.973

它是自动完成的。字典的结构必须对其进行排序才能正确操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T15:43:52.110

是的。[Microsoft 在此处](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)讨论 SortedDictionary 。

该页面中的一些引用表明排序是自动进行的：

> “SortedDictionary<(Of <(TKey, TValue>)>) 泛型类是具有 O(log n) 检索的二叉搜索树，其中 n 是字典中的元素数。”

O(log n) 查找表明（通常）我们在某棵树中通过二分搜索寻找匹配项。

和

> “SortedDictionary<(Of <(TKey, TValue>)>) 对未排序的数据具有更快的插入和删除操作：O(log n) 相对于 SortedList<(Of <(TKey, TValue>)>) 的 O(n) 。”

同样，O(log n) 用于插入，因为它必须遍历结构以找到插入点。

好开心。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T15:29:20.757

按排序顺序是 的不变量`SortedDictionary`，因此您永远不需要显式排序。

# oracle - 事务超时不适用于 Oracle 的休眠

> ID：635047
> 
> 赞同：2
> 
> 时间：2009-03-11T15:28:07.967
> 
> 标签：oracle, hibernate, jdbc, transactions, timeout

我在为 oracle 上的休眠设置事务超时时遇到问题。它不起作用。有人可以帮忙吗？“SaveOrUpdate”不会在规定的 10 秒内返回。它会挂很长时间。我正在使用 Oracle 10r2。

**休眠配置文件**

```
<hibernate-configuration>
<session-factory>
    <property name="connection.driver_class">oracle.jdbc.driver.OracleDriver</property>
    <property name="connection.url">jdbc:oracle:thin:@9.9.9.9:1521:orcl</property>
    <property name="connection.username">foouser</property>
    <property name="connection.password">foopass</property>
    <property name="hibernate.c3p0.min_size">5</property>
    <property name="hibernate.c3p0.max_size">20</property>
    <property name="dialect">org.hibernate.dialect.Oracle9Dialect</property>
    <property name="current_session_context_class">thread</property>
    <!-- Disable the second-level cache  -->
    <property name="cache.provider_class">org.hibernate.cache.NoCacheProvider</property>
    <!-- Echo all executed SQL to stdout -->
    <property name="show_sql">false</property>
    <!-- Mapping files -->
    <mapping resource="foo.hbm.xml"/>
</session-factory>
</hibernate-configuration> 
```

**休眠类**

```
public class foo implements Serializable
{
...
    public void save() throws Exception
    {
        Session     dbSession = null;
        Transaction tran      = null;
        try
        {
            dbSession = PersistenceMgr.getPersistenceMgr().getDbSession();
            tran      = dbSession.beginTransaction();
            tran.setTimeout(10); // 10 seconds
            dbSession.saveOrUpdate(this);
            tran.commit();
        }
        catch (HibernateException e)
        {
            if(tran!=null)
            {
                try{tran.rollback();}
                catch(HibernateException he){}
            }
            ...
        }
        finally
        {
            if( dbSession != null )
            {
                try{dbSession.close();}
                catch(HibernateException e){}
            }
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-19T22:19:41.607

需要在事务开始之前设置超时。

代替

```
tran = dbSession.beginTransaction();
tran.setTimeout(10);// 10 seconds 
```

尝试

```
tran = dbSession.getTransaction();
tran.setTimeout(10);
tran.begin(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T13:53:08.317

这是使用JTA吗？如果不是，则 JDBC 本身没有用于设置事务超时的 API，因此 Hibernate 尝试通过跟踪在事务中执行 JDBC 语句并设置 Statement.setQueryTimeout 时剩余多少指定超时时间来管理它。可能是该逻辑中存在错误，或者 Oracle JDBC 驱动程序在设置语句超时方面存在错误。

如果你发现它是一个 Hibernate 错误，[https://hibernate.onjira.com](https://hibernate.onjira.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-06T15:59:01.497

您可以在以下网址看到：http: [//community.jboss.org/wiki/TransactionTimeout](http://community.jboss.org/wiki/TransactionTimeout)。

# python - Django 管理员

> ID：635048
> 
> 赞同：0
> 
> 时间：2009-03-11T15:28:10.540
> 
> 标签：python, django, django-admin

我正在使用 Django admin 来管理我的数据。我有一个用户、组和域表用户表与组和域表有多对多的关系。Domains 表与 Groups 表具有一对多的关系。当我通过管理员保存用户数据时，我还需要在 users_group 和 users_domains 表中进行一些额外的数据库更新。我该怎么做呢？我把代码放在哪里。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T15:33:25.600

我认为您正在寻找[InlineModels](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#inlinemodeladmin-objects)。它们允许您在与父模型相同的页面中编辑相关模型。如果您正在寻找比这更好的控制，您可以覆盖 ModelAdmin[保存方法](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#modeladmin-methods)。

此外，当您需要某些东西时，请务必查看[手册。](http://docs.djangoproject.com/en/dev/)它真的很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T14:45:48.433

更新其他数据库表的最佳方法是执行必要的获取和保存操作。但是，如果您有一个多对多关系，默认情况下，关系的双方都可以从 _set 参数访问。也就是说， user.group_set.all() 将为您提供与用户关联的所有 Group 对象，而 group.user_set.all() 将为您提供与组关联的所有 User 对象。因此，如果您覆盖 save 方法（或注册一个信号侦听器——无论哪个选项听起来风格上更令人愉悦），请尝试：

```
for group in user.group_set.all():
    #play with group object
    ....
    group.save() 
```

# safari - Safari强制滚动

> ID：635050
> 
> 赞同：0
> 
> 时间：2009-03-11T15:28:19.307
> 
> 标签：safari, css

```
html {overflow-y:
scroll;height:101%;overflow-y:hidden;} 
```

为了强制滚动，当我在手机上查看我的网站时，底部会被截断，但在 FirefoxF/IE 中看起来不错。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T15:32:53.883

应该足够说：

```
html { overflow-y: scroll; } 
```

但我也会尝试

```
body { overflow-y: scroll; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-08T04:43:15.263

将`overflow-y:hidden;`剪切超出元素大小的内容。默认值应该是自动的以允许滚动，但将其设置为`overflow-y:scroll;`or `overflow:scroll;`（这将允许垂直和水平滚动）应该使其工作。

# reporting-services - 子报告尝试并保持在一起，留下空白点/页面

> ID：635051
> 
> 赞同：8
> 
> 时间：2009-03-11T15:28:20.540
> 
> 标签：reporting-services, reportingservices-2005, subreport

**报告服务 2005**

我的布局是这样的：

*   我有一个包含表格的主报告
*   该表由 3 个组运行，GrpLevel1、GrpLevel2、GrpLevel3
*   子报告被添加到 3 个组之一，并通过将该组键传递给子报告来执行

因此，特定的子报表将在 GrpLevel1 运行，并且对于它包含的每个 level2，GrpLevel2 下的子报表都将运行。

我遇到的问题是子报告想要跳到下一页，在报告中留下空白的空白洞。

如果一个子报表包含一个包含一堆数据的表格并且它不能放在页面的 3/4 上（报表的第一页在顶部 1/4 有报表标题），它会将整个内容跳转到下一页只留下一个标题，而不是在第一页上打印它可以打印的内容。

在桌子上，我关闭了“保持在一起”。

我不知所措，准备将我的立方体点燃。对此的洞察力将不胜感激。

**更新******************这已在 SSRS 2008 R2 中修复******************************
它有已通过 (SQL Server) Reporting Services 2008 R2 修复。您现在可以在子报告上切换 KeepTogether。分页看起来好多了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T06:39:30.953

看起来这个问题没有解决方案。该错误已被微软承认，但在 SSRS2008 中仍未修复。

来自知识库文章 ( [http://support.microsoft.com/kb/938943](http://support.microsoft.com/kb/938943) )

> 出现此问题的原因是 Subreport 控件具有隐式 KeepTogether 属性。按照设计，KeepTogether 属性尝试将子报表的内容保留在一页上。由于这种行为，如果子报表与主报表不在同一页面上，报表引擎会在主报表上创建空白区域。然后，报表引擎在新页面上创建子报表。

他们列出的解决方法本质上是“不要使用子报告”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T15:22:11.920

我不确定 SSRS 的早期版本，但我在 SSRS 2008 中遇到了同样的问题。

解决方案是更改代码中的 Subreport 属性。

1.  转到解决方案资源管理器，右键单击您的报告，然后单击“查看代码”。

2.  搜索您的子报表。

3.  在子报表标签内你会发现“ `<KeepTogether>`”，它会被设置为“true”，将其更改为“false”

此属性不可从设计器中获得，必须从实际的报告 xml 代码中更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-26T20:24:57.327

右键单击子报表并选择格式子报表，然后取消选中保持对象在一起

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-04T19:45:05.413

我解决这个问题的另一种方法是将子报表放在报表标题中。当然，这非常依赖于报告内容并消除了后续部分的任何用处，但它确实解决了我在第一页上有大量空白的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-26T01:39:21.037

我花了一个星期才解决这个问题！但我确实找到了解决方案，并很高兴与您分享。

I had the exact same problem. In my main report, there is a Table that has 3 groups and 2 different subreports in each group. And these subreports had matrices. I believe regardless of matrices, subreports being placed inside group/detail bands within a table caused alot of unnecessary blank pages to be printed before, in between and after the sections. It was a pain the neck and I was thinking of removing the subreports but then it defeats the whole purpose of the report.

所以最后，修复它的不是将子报表放在表中组的详细信息带中，而是将它们放在组的页脚中。现在我知道这可能会改变/影响报告的格式，并且可能不符合您的报告目的。但这为我解决了这个问题。解决空白页问题的另一种方法是将子报表留在任何位置（详细信息或分组带区），并将其他详细信息带区移动到一个页脚带区。本质上需要牢记的是减少表内的细节/组带的数量。如果可以管理，请限制分组并在表中拥有最少数量的子报表。

希望这可以帮助那里的人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-01T05:03:26.650

**For SSRS 2008** If your subreports are in any group, you should go to group properties and switch the keep together property for that group(s) to false. This worked for me.

# javascript - 在一个框架中显示动态内容，该框架由另一个框架中的 XML 创建的树控制

> ID：635052
> 
> 赞同：0
> 
> 时间：2009-03-11T15:28:27.920
> 
> 标签：javascript, html, xml, xslt

我有一个 XML 文件：

```
<root>
  <foo>
    <!--Content Here-->
  </foo>
</root> 
```

现在我想从中生成一个 HTML 文件。HTML 有两个垂直框架。左侧显示 XML 文件的树视图。我希望右边显示树视图的内容：当我点击“foo”节点时，内容将显示在右边。

现在我编写了一个 XSL 文件来获取树视图

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"         xmlns:fo="http://www.w3.org/1999/XSL/Format">

<xsl:output method="html"/>

<xsl:template match="/">
<html>
<head>
  <!-- Some JS code to deal with the "expand", "collapse"... sth like these-->
</head>
<body>
  <table border="0" cellpadding="0" cellspacing="0">
    <tr>
      <td>
        <a onclick="toggle(this)"><img src="plus.gif"/><img src="folder.gif"/>root</a>
        <div style="display:none;">
          <table border="0" cellpadding="0" cellspacing="0">
            <tr>
          <td width="15"></td>
              <td>
                <a><img src="page.gif"/>Foo</a>
              </td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
</body>
<html>
</xsl:template>
</xsl:stylesheet> 
```

和一个 HTML 文件：

```
<html>
<head>
<script language="javascript">
function populateFrames(){
    var x = new ActiveXObject("Microsoft.XMLDOM");
    var s = new ActiveXObject("Microsoft.XMLDOM");
    x.async = false
    s.async = false
    x.load("source.xml");
    s.load("tree.xsl");
    var html = x.transformNode(s);
    var destination = document.frames("header").document.open("text/html","replace");
    destination.write(html);
}
</script>
</head>

<frameset onload="populateFrames()" cols="25%,*">
  <frame name="header" scrolling="auto" target="main">
  <frame name="main">
</frameset>
</html> 
```

如您所见，树将显示在`header`框架中，我想要`main`框架中的内容。

谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T15:34:02.990

在“tree.xsl”中，我会将内容 HTML 渲染为每个树节点的隐藏元素。然后，当单击树节点时，使用您的最后 2 行 javascript 打开第二个内容框架并写出相应的内容 HTML。

# apache-flex - Tomcat/BlazeDS/ActiveMQ 断开连接问题

> ID：635054
> 
> 赞同：2
> 
> 时间：2009-03-11T15:28:43.970
> 
> 标签：apache-flex, tomcat, jms, activemq, blazeds

我们的 Tomcat/BlazeDS/ActiveMQ 堆栈出现断开连接。尽管我们的 BlazeDS StreamingAMFChannel 配置了默认的空闲超时分钟数 0，但它似乎在大约 30 分钟的空闲时间后超时（见日志）。在此期间客户端不做任何请求，我们也不会从 ActiveMQ 主题推送消息。

我们在 activeMQ 和 BlazeDS 上启用了调试日志记录，并看到 BlazeDS 正在删除消费者。不幸的是，在断开连接消息之前没有日志消息，因此我们无法真正跟踪何时在 BlazeDS 中调用它。

有没有其他人经历过这个或任何人都可以提供解决方案？

*** ActiveMQ 日志 ***

```
11 Mar 2009 16:25:47,405 [ActiveMQ Transport: tcp:///127.0.0.1:49971] DEBUG activemq.broker.region.AbstractRegion  - Removing consumer: ID:TMSNEC02.traficon.int-52586-1236783284912-2:3:1:1
11 Mar 2009 16:25:47,406 [ActiveMQ Transport: tcp:///127.0.0.1:49971] DEBUG activemq.broker.region.AbstractRegion  - Removing consumer: ID:TMSNEC02.traficon.int-52586-1236783284912-2:3:-1:1
11 Mar 2009 16:25:47,407 [ContainerBackgroundProcessor[StandardEngine[Catalina]]] DEBUG activemq.transport.tcp.TcpTransport  - Stopping transport tcp://localhost/127.0.0.1:61616
11 Mar 2009 16:25:47,408 [ActiveMQ Transport Stopper: /127.0.0.1:49971] DEBUG apache.activemq.broker.TransportConnection  - Stopping connection: /127.0.0.1:49971
11 Mar 2009 16:25:47,409 [ActiveMQ Transport Stopper: /127.0.0.1:49971] DEBUG activemq.transport.tcp.TcpTransport  - Stopping transport tcp:///127.0.0.1:49971
11 Mar 2009 16:25:47,413 [ActiveMQ Transport Stopper: /127.0.0.1:49971] DEBUG apache.activemq.broker.TransportConnection  - Stopped connection: /127.0.0.1:49971
11 Mar 2009 16:25:47,417 [ActiveMQ Transport Stopper: /127.0.0.1:49971] DEBUG apache.activemq.broker.TransportConnection  - Connection Stopped: /127.0.0.1:49971
11 Mar 2009 16:25:47,427 [ActiveMQ Transport: tcp:///127.0.0.1:50680] DEBUG activemq.broker.region.AbstractRegion  - Removing consumer: ID:TMSNEC02.traficon.int-52586-1236783284912-2:4:1:1
11 Mar 2009 16:25:47,430 [ActiveMQ Transport: tcp:///127.0.0.1:50680] DEBUG activemq.broker.region.AbstractRegion  - Removing consumer: ID:TMSNEC02.traficon.int-52586-1236783284912-2:4:-1:1
11 Mar 2009 16:25:47,431 [ContainerBackgroundProcessor[StandardEngine[Catalina]]] DEBUG activemq.transport.tcp.TcpTransport  - Stopping transport tcp://localhost/127.0.0.1:61616
11 Mar 2009 16:25:47,431 [ActiveMQ Transport Stopper: /127.0.0.1:50680] DEBUG apache.activemq.broker.TransportConnection  - Stopping connection: /127.0.0.1:50680
11 Mar 2009 16:25:47,431 [ActiveMQ Transport Stopper: /127.0.0.1:50680] DEBUG activemq.transport.tcp.TcpTransport  - Stopping transport tcp:///127.0.0.1:50680
11 Mar 2009 16:25:47,435 [ActiveMQ Transport Stopper: /127.0.0.1:50680] DEBUG apache.activemq.broker.TransportConnection  - Stopped connection: /127.0.0.1:50680
11 Mar 2009 16:25:47,438 [ActiveMQ Transport Stopper: /127.0.0.1:50680] DEBUG apache.activemq.broker.TransportConnection  - Connection Stopped: /127.0.0.1:50680
11 Mar 2009 16:25:47,439 [ActiveMQ Transport: tcp:///127.0.0.1:50681] DEBUG activemq.broker.region.AbstractRegion  - Removing consumer: ID:TMSNEC02.traficon.int-52586-1236783284912-2:5:1:1
11 Mar 2009 16:25:47,439 [ActiveMQ Transport: tcp:///127.0.0.1:50681] DEBUG activemq.broker.region.AbstractRegion  - Removing consumer: ID:TMSNEC02.traficon.int-52586-1236783284912-2:5:-1:1
11 Mar 2009 16:25:47,440 [ContainerBackgroundProcessor[StandardEngine[Catalina]]] DEBUG activemq.transport.tcp.TcpTransport  - Stopping transport tcp://localhost/127.0.0.1:61616
11 Mar 2009 16:25:47,440 [ActiveMQ Transport Stopper: /127.0.0.1:50681] DEBUG apache.activemq.broker.TransportConnection  - Stopping connection: /127.0.0.1:50681
11 Mar 2009 16:25:47,441 [ActiveMQ Transport Stopper: /127.0.0.1:50681] DEBUG activemq.transport.tcp.TcpTransport  - Stopping transport tcp:///127.0.0.1:50681
11 Mar 2009 16:25:47,441 [ActiveMQ Transport Stopper: /127.0.0.1:50681] DEBUG apache.activemq.broker.TransportConnection  - Stopped connection: /127.0.0.1:50681
11 Mar 2009 16:25:47,441 [ActiveMQ Transport Stopper: /127.0.0.1:50681] DEBUG apache.activemq.broker.TransportConnection  - Connection Stopped: /127.0.0.1:50681 
```

*** BlazeDS 日志 ***

```
[BlazeDS]03/11/2009 15:55:39.776 [DEBUG] [Endpoint.AMF] Serializing AMF/HTTP response
Version: 3
  (Message #0 targetURI=/4/onResult, responseURI=)
    (Externalizable Object #0 'DSK')
      (Externalizable Object #1 'flex.messaging.io.ArrayCollection')
        (Array #2)
1.236783339776E12
(Byte Array #3, Length 16)
(Byte Array #4, Length 16)
(Byte Array #5, Length 16)

[BlazeDS]03/11/2009 16:25:47.391 [INFO] [Service.Message.JMS] JMS consumer for JMS destination 'java:comp/env/eventMessagesFlexTopic' is being removed from the JMS adapter
[BlazeDS]03/11/2009 16:25:47.392 [INFO] [Service.Message.JMS] JMS consumer for JMS destination 'java:comp/env/eventMessagesFlexTopic' is stopping.
[BlazeDS]03/11/2009 16:25:47.417 [DEBUG] [Client.MessageClient] MessageClient with clientId '7A98D7BC-F0B3-922C-A968-BE0BFB7D9080' for destination 'eventMessageFeed' has been invalidated.
[BlazeDS]03/11/2009 16:25:47.419 [INFO] [Service.Message.JMS] JMS consumer for JMS destination 'java:comp/env/detectorsFlexTopic' is being removed from the JMS adapter
[BlazeDS]03/11/2009 16:25:47.423 [INFO] [Service.Message.JMS] JMS consumer for JMS destination 'java:comp/env/detectorsFlexTopic' is stopping.
[BlazeDS]03/11/2009 16:25:47.435 [DEBUG] [Client.MessageClient] MessageClient with clientId '7A9BC826-2199-C772-0A1B-FE6FAE9F7402' for destination 'detectorsFeed' has been invalidated.
[BlazeDS]03/11/2009 16:25:47.438 [INFO] [Service.Message.JMS] JMS consumer for JMS destination 'java:comp/env/scenariosFlexTopic' is being removed from the JMS adapter
[BlazeDS]03/11/2009 16:25:47.438 [INFO] [Service.Message.JMS] JMS consumer for JMS destination 'java:comp/env/scenariosFlexTopic' is stopping.
[BlazeDS]03/11/2009 16:25:47.440 [DEBUG] [Client.MessageClient] MessageClient with clientId '7A9BCE40-A0DA-18D6-9FA1-6D6AA2088256' for destination 'scenarioMessageFeed' has been invalidated.
[BlazeDS]03/11/2009 16:25:47.441 [DEBUG] [Client.FlexClient] FlexClient with id '7A95FDE9-0091-B1CD-3660-D8E9CD6CD3E6' has been invalidated.
[BlazeDS]03/11/2009 16:25:47.441 [DEBUG] [Endpoint.StreamingAMF] Endpoint with id 'my-streaming-amf' is streaming message: Flex Message (flex.messaging.messages.CommandMessage)
operation = disconnect
clientId = null
correlationId = null
destination = null
messageId = 7ED1C45A-10A7-BFBB-E24E-94B9C03047EE
timestamp = 1236785147441
timeToLive = 0
body = null
[BlazeDS]03/11/2009 16:25:47.441 [DEBUG] [Endpoint.FlexSession] FlexSession with id '71A76CA22AC435285736F6DB0E38AC11' for an Http-based client connection has been invalidated.
[BlazeDS]03/11/2009 16:25:47.444 [DEBUG] [Client.FlexClient] FlexClient with id '7A941468-80E5-8343-A2AE-A3AFFA135734' has been invalidated.
[BlazeDS]03/11/2009 16:25:47.444 [DEBUG] [Endpoint.FlexSession] FlexSession with id '1238AA40EF8B016F3942C6D6BDBA29B9' for an Http-based client connection has been invalidated.
[BlazeDS]03/11/2009 16:25:47.444 [DEBUG] [Endpoint.StreamingAMF] Streaming thread 'http-8080-1' for endpoint with id 'my-streaming-amf' is releasing connection and returning to the request handler pool.
[BlazeDS]03/11/2009 16:25:47.444 [INFO] [Endpoint.FlexSession] Number of streaming clients for FlexSession with id '71A76CA22AC435285736F6DB0E38AC11' is 0.
[BlazeDS]03/11/2009 16:25:47.444 [DEBUG] [Endpoint.StreamingAMF] Number of streaming clients for endpoint with id 'my-streaming-amf' is 0.
[BlazeDS]03/11/2009 16:25:47.489 [DEBUG] [Endpoint.FlexSession] FlexSession created with id 'E5BCC7617F3937139CCAD377EEB85D45' for an Http-based client connection.
[BlazeDS]03/11/2009 16:25:47.489 [INFO] [Endpoint.General] Channel endpoint my-streaming-amf received request. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-11T14:44:34.133

我们通过每 30 秒从客户端向服务器发送一条保持活动消息来解决这个问题。显然是 FlexSession 超时了，因为它遵循 Tomcat 的默认会话超时。由于keep-alive消息以较低的间隔发送，我们还将服务器上的会话超时设置为较低的值，从而提高服务器的内存消耗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T16:21:32.707

如果需要，您可以响应断开连接事件并重新连接。

# windows - 无头 Linux -> 将 IP 广播到 Windows 工作站？

> ID：635058
> 
> 赞同：2
> 
> 时间：2009-03-11T15:29:16.857
> 
> 标签：windows, linux, networking, ip-address, dhcp

我想向 SOHO 用户出售无头 Linux 服务器。通常，他们将有一个支持 DHCP 的 ADSL 调制解调器兼交换机，他们将连接他们的工作站和服务器。

为了只显示服务器，我需要找到一种方法将服务器插入交换机以从调制解调器获取 IP 地址，然后让服务器广播其地址，以便我可以使用 Putty 连接到它从工作站。

我考虑过使用 Samba 使用 Messenger Service 广播消息，但除非我弄错了，否则这仅在两个热点配置为使用相同的工作组/域时才有效。

您知道从工作站获取服务器 IP 地址的方法吗？

谢谢你的任何提示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T15:51:42.450

看看像 Apple 的[Bonjour这样的](http://en.wikipedia.org/wiki/Bonjour_(software))[UPnP](http://en.wikipedia.org/wiki/Universal_Plug_and_Play)和 zeroconf 服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T15:32:35.100

我可能会建议对交换机和调制解调器使用常规方法，因为您将设备视为设备，即设置默认 IP 192.168.0.1，然后连接到该 IP，然后将设备配置到本地基础架构中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T22:30:17.627

在任意选择的 UDP 端口上定期广播数据包，并构建一些客户端软件来监听这些数据包。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T16:07:18.700

I don't know of any good solutions.

Some DHCP servers will register the name you send in the request - then give that name in your setup instructions. But I suspect home user DSL routers aren't in that category.

Maybe you could ship a tool on CD that does arp requests to get the IP address? (Given the MAC address printed on the box)

# objective-c - 如何使用转义键关闭工作表？

> ID：635069
> 
> 赞同：0
> 
> 时间：2009-03-11T15:30:51.407
> 
> 标签：objective-c, cocoa, macos

我的应用程序显示`NSWindow`为工作表。`NSWindow`具有用于设置对象（NSTextfield、a`NSDatepicker`等）和两个`NSButton`“添加”和“取消”属性的各种控件，用于确认或取消操作。

我已将“添加”按钮`enter`的等效键设置为，将等效键设置`Cancel`为`escape`。这没有预期的效果。我认为这是由于其他控件处理按键事件。

如何配置我的工作表以使按钮按描述的方式运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T15:45:13.260

解决方案不仅是检查您的工作，而且还要仔细检查！

问题中描述的设置完美运行。（我有两张类似的床单，但我用错了一张。）

# .net - 如何使用 snk 文件在 PHP 中对数据进行签名？

> ID：635088
> 
> 赞同：0
> 
> 时间：2009-03-11T15:33:27.253
> 
> 标签：.net, php, snk

如何将用于签署 .NET 程序集的 .snk RSA 密钥对文件转换为可与 PHP 或其他软件一起使用的基于 XML 的文件？

XML 文件示例：

```
<BitStrength>1024</BitStrength><RSAKeyValue><Modulus>tk=</Modulus><Exponent>QB</Exponent></RSAKeyValue> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T15:49:02.660

这听起来更像是您应该使用`makecert`或类似（或证书经销商），并将其导出为公钥/私钥文件？强名称键（snk）有点不同......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T10:05:18.700

您必须将 snk 文件转换为 PEM 格式并使用 openssl 函数进行加密。

# flash - Flash，无法访问影片剪辑

> ID：635103
> 
> 赞同：0
> 
> 时间：2009-03-11T15:38:45.493
> 
> 标签：flash, actionscript-2, movieclip, nested

我正在编写 Flash 分步指南。我有一个问题。

有3层，1是脚本2是隐形按钮3是封面屏幕（mc）

, 内盖屏幕。在它自己的时间线上，它有一个动画。

，我想做的是；当我滚动隐形按钮时，我希望封面屏幕时间线播放并在某个帧处停止，当展开时，我希望它再次播放并开始。

我在我的隐形按钮上使用了这个。

on (rollOver){ cover.gotoAndPlay("fadein"); } on (rollOut) { cover.gotoAndPlay("fadeout"); fadein 和 fadeout 是 cover_mc 中​​的帧名称

但 id 不起作用：S

任何想法是为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T15:55:08.883

First of all, try to use trace :)

```
on (rollOver){
    trace(cover);
    cover.gotoAndPlay("fadein");
} 
```

if nothing traces than there's probably something wrong with your rollOver action. It must trace [Object MovieClip] (or something like that, i'm not quite sure.. its ages since i did some AS2 development)

if it traces coorect, then you probably have a problem with your frame label. it also could be that the cover instance is not know from your rollOver function, try _root.cover.gotoAndPlay("fadein");

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T08:40:10.660

如果我理解正确，代码在按钮上，您希望父时间线对滚动动作做出反应。

所以尝试以下方法：

```
on (rollOver) {
   _parent.gotoAndPlay('fadein');
} 
```

关键是**_parent**，它显然会处理按钮的父级。

# linq - LINQ 的问题

> ID：635104
> 
> 赞同：0
> 
> 时间：2009-03-11T15:39:02.497
> 
> 标签：linq

我最近在使用 LINQ2SQL 时遇到了一些问题，首先是因为我无法使用 CRUD 方法我不知道 LINQ ORM 有什么问题，我无法更新或删除一些已经映射到 .dbml 中的实体，所以我总是使用 drop 来解决这个问题并更新.dbml ，但现在仍然无法正常工作。

问题：实体尚未关联

> System.InvalidOperationException 被捕获 Message="No se puede quitar una entidad que no se ha asociado。"
> Source="System.Data.Linq"
> StackTrace: en System.Data.Linq.Table`1.DeleteOnSubmit(TEntity entity) en Resocentro.Informes.PlantillasMedicas.FormPlantilla.elimina(Int32 nro) en D:\cs_PlantillasMedicas\Resocentro.Informes .PlantillasMedicas\Resocentro.Informes.PlantillasMedicas\FormPlantilla.xaml.cs:línea 54 InnerException:

PD：LINQ XML PrimaryKey 属性

检索实体的片段：

```
IsPrimaryKey="true"

    private PLANTILLA getTemplateEntityFromModel(int codigoPlantilla)
    {
        using (DB db = new DB())
        {
            PLANTILLA var = db.PLANTILLAs.FirstOrDefault(x => x.codigoplantilla == codigoPlantilla);
            return var;
        }
    } 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T15:42:23.347

请检查您是否为表定义了主键。如果您不这样做，请将它们添加到表中，或者如果您不能直接添加到设计器中。如果没有主键，Linq2sql 就不能很好地工作，特别是在可以忽略的更新上。

此外，您是否正在检索要删除的实体，例如：

var myEntity = myContext.SomeEntities.Single(e=>e.MyId == 1); myContext.SomeEntities.DeleteOnSubmit(myEntity);

# visual-studio - 在 Visual Studio 中禁用默认 XML 架构？

> ID：635105
> 
> 赞同：2
> 
> 时间：2009-03-11T15:39:03.027
> 
> 标签：visual-studio, sharepoint, xsd, caml

我最近开始使用[CAML.NET IntelliSense for SharePoint](http://code.msdn.microsoft.com/camlintellisense/Release/ProjectReleases.aspx?ReleaseId=2212)和 Visual Studio 2008；效果很好；但是，每当我使用 STSDev 2008（并因此生成 feature.xml 和 WebParts.xml）创建一个新项目时，默认架构包括 CAML.NET IntelliSense 和内置（相对不完整）架构：

*   caml.xsd
*   wss.xsd
*   核心定义.xsd
*   camlview.xsd

都可以在 Web 服务器扩展\12\TEMPLATE\XML 中找到。文件的这两种模式的存在会导致大量警告，通知我已在上述文件之一中声明了特定的模式条目。为每个文件单独禁用它们效果很好，但是在包含 40 或 50 个 XML 文件的 SharePoint 解决方案中，这很快就会变得很费力。

是否可以禁用这些内置模式，选择“不使用选定的模式”对未来的 XML 文件仅适用于当前的 XML 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-27T07:56:10.150

好吧，如果您真的不想要它们 - 您可以从 xsd 路径 ( `%VsInstallDir%\xml\Schemas`) 中删除模式 - 并且可能禁用下载 (Options->TextEditor->Xml->Miscellaneous)。我的机器处于不适合尝试的状态，但理论上它应该可以工作......

# python - Python urllib2、基本 HTTP 身份验证和 tr.im

> ID：635113
> 
> 赞同：86
> 
> 时间：2009-03-11T15:43:10.473
> 
> 标签：python, http, authentication

我在玩，试图编写一些代码来使用[tr.im](http://www.programmableweb.com/api/tr.im) API 来缩短 URL。

阅读[http://docs.python.org/library/urllib2.html](http://docs.python.org/library/urllib2.html)后，我尝试了：

```
 TRIM_API_URL = 'http://api.tr.im/api'
   auth_handler = urllib2.HTTPBasicAuthHandler()
   auth_handler.add_password(realm='tr.im',
                             uri=TRIM_API_URL,
                             user=USERNAME,
                             passwd=PASSWORD)
   opener = urllib2.build_opener(auth_handler)
   urllib2.install_opener(opener)
   response = urllib2.urlopen('%s/trim_simple?url=%s'
                              % (TRIM_API_URL, url_to_trim))
   url = response.read().strip() 
```

response.code 是 200（我认为应该是 202）。url 是有效的，但基本的 HTTP 身份验证似乎不起作用，因为缩短的 URL 不在我的 URL 列表中（在[http://tr.im/?page=1](http://ttp://tr.im/?page=1)）。

阅读[http://www.voidspace.org.uk/python/articles/authentication.shtml#doing-it-properly](http://www.voidspace.org.uk/python/articles/authentication.shtml#doing-it-properly)后 ，我也尝试过：

```
 TRIM_API_URL = 'api.tr.im/api'
   password_mgr = urllib2.HTTPPasswordMgrWithDefaultRealm()
   password_mgr.add_password(None, TRIM_API_URL, USERNAME, PASSWORD)
   auth_handler = urllib2.HTTPBasicAuthHandler(password_mgr)
   opener = urllib2.build_opener(auth_handler)
   urllib2.install_opener(opener)
   response = urllib2.urlopen('http://%s/trim_simple?url=%s'
                              % (TRIM_API_URL, url_to_trim))
   url = response.read().strip() 
```

但我得到相同的结果。（response.code 为 200 且 url 有效，但未记录在我的帐户中[http://tr.im/](http://tr.im/)。）

如果我使用查询字符串参数而不是基本的 HTTP 身份验证，如下所示：

```
 TRIM_API_URL = 'http://api.tr.im/api'
   response = urllib2.urlopen('%s/trim_simple?url=%s&username=%s&password=%s'
                              % (TRIM_API_URL,
                                 url_to_trim,
                                 USERNAME,
                                 PASSWORD))
   url = response.read().strip() 
```

...那么不仅 url 有效，而且它记录在我的 tr.im 帐户中。（虽然 response.code 仍然是 200。）

我的代码一定有问题（而不是 tr.im 的 API），因为

```
$ curl -u yacitus:xxxx http://api.tr.im/api/trim_url.json?url=http://www.google.co.uk 
```

...返回：

```
{"trimpath":"hfhb","reference":"nH45bftZDWOX0QpVojeDbOvPDnaRaJ","trimmed":"11\/03\/2009","destination":"http:\/\/www.google.co.uk\/","trim_path":"hfhb","domain":"google.co.uk","url":"http:\/\/tr.im\/hfhb","visits":0,"status":{"result":"OK","code":"200","message":"tr.im URL Added."},"date_time":"2009-03-11T10:15:35-04:00"} 
```

...并且该 URL 确实出现在我的[http://tr.im/?page=1](http://ttp://tr.im/?page=1)上的 URL 列表中。

如果我运行：

```
$ curl -u yacitus:xxxx http://api.tr.im/api/trim_url.json?url=http://www.google.co.uk 
```

...再次，我得到：

```
{"trimpath":"hfhb","reference":"nH45bftZDWOX0QpVojeDbOvPDnaRaJ","trimmed":"11\/03\/2009","destination":"http:\/\/www.google.co.uk\/","trim_path":"hfhb","domain":"google.co.uk","url":"http:\/\/tr.im\/hfhb","visits":0,"status":{"result":"OK","code":"201","message":"tr.im URL Already Created [yacitus]."},"date_time":"2009-03-11T10:15:35-04:00"} 
```

注意代码是 201，消息是“tr.im URL 已经创建 [yacitus]”。

我一定不能正确地进行基本的 HTTP 身份验证（在任何一种尝试中）。你能发现我的问题吗？也许我应该看看通过网络发送了什么？我以前从来没有这样做过。是否有我可以使用的 Python API（可能在 pdb 中）？或者我可以使用其他工具（最好是 Mac OS X）吗？

* * *

## 回答 #1

> 赞同：247
> 
> 时间：2010-11-15T20:52:54.347

这似乎工作得很好（取自另一个线程）

```
import urllib2, base64

request = urllib2.Request("http://api.foursquare.com/v1/user")
base64string = base64.encodestring('%s:%s' % (username, password)).replace('\n', '')
request.add_header("Authorization", "Basic %s" % base64string)   
result = urllib2.urlopen(request) 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-11T15:50:08.490

真正便宜的解决方案：

```
urllib.urlopen('http://user:xxxx@api.tr.im/api') 
```

（由于多种原因，您可能会认为它不适合，例如 url 的安全性）

[Github API 示例](https://developer.github.com/v3/auth/#via-oauth-tokens)：

```
>>> import urllib, json
>>> result = urllib.urlopen('https://personal-access-token:x-oauth-basic@api.github.com/repos/:owner/:repo')
>>> r = json.load(result.fp)
>>> result.close() 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-03-14T08:35:25.180

看看[这个 SO post answer](https://stackoverflow.com/a/7755057/1020470)，并看看[urllib2 missing manual](http://www.voidspace.org.uk/python/articles/urllib2.shtml)中的这个[基本身份验证教程](http://www.voidspace.org.uk/python/articles/authentication.shtml)。

为了使 urllib2 基本身份验证正常工作，http 响应必须包含 HTTP 代码 401 Unauthorized***和***`"WWW-Authenticate"`带有该值的密钥，`"Basic"`否则 Python 不会发送您的登录信息，您将需要使用[Requests](http://docs.python-requests.org/en/v0.10.7/index.html)或`urllib.urlopen(url)`在url，或者在[@Flowpoke 的](https://stackoverflow.com/users/352452/flowpoke) [答案](https://stackoverflow.com/a/4188709/1020470)中添加一个标题。

`urlopen`您可以通过将您的放在 try 块中来查看您的错误：

```
try:
    urllib2.urlopen(urllib2.Request(url))
except urllib2.HTTPError, e:
    print e.headers
    print e.headers.has_key('WWW-Authenticate') 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-11-03T21:39:08.690

[推荐的方法](https://docs.python.org/3/library/urllib.request.html#module-urllib.request)是使用[`requests`模块](http://docs.python-requests.org/en/latest/)：

```
#!/usr/bin/env python
import requests # $ python -m pip install requests
####from pip._vendor import requests # bundled with python

url = 'https://httpbin.org/hidden-basic-auth/user/passwd'
user, password = 'user', 'passwd'

r = requests.get(url, auth=(user, password)) # send auth unconditionally
r.raise_for_status() # raise an exception if the authentication fails 
```

这是一个基于 Python 2/3 兼容的单一来源`urllib2`变体：

```
#!/usr/bin/env python
import base64
try:
    from urllib.request import Request, urlopen
except ImportError: # Python 2
    from urllib2 import Request, urlopen

credentials = '{user}:{password}'.format(**vars()).encode()
urlopen(Request(url, headers={'Authorization': # send auth unconditionally
    b'Basic ' + base64.b64encode(credentials)})).close() 
```

[Python 3.5+ 引入`HTTPPasswordMgrWithPriorAuth()`](https://docs.python.org/3.5/whatsnew/3.5.html#urllib)了允许：

> ..消除不必要的 401 响应处理，或在第一个请求上无条件发送凭据，以便与返回 404 响应而不是 401 的服务器通信（如果未发送授权标头）..

```
#!/usr/bin/env python3
import urllib.request as urllib2

password_manager = urllib2.HTTPPasswordMgrWithPriorAuth()
password_manager.add_password(None, url, user, password,
                              is_authenticated=True) # to handle 404 variant
auth_manager = urllib2.HTTPBasicAuthHandler(password_manager)
opener = urllib2.build_opener(auth_manager)

opener.open(url).close() 
```

`HTTPBasicAuthHandler()`在这种情况下，`ProxyBasicAuthHandler()`如果需要，很容易更换。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-09-10T21:38:56.353

我建议当前的解决方案是使用我的包[urllib2_prior_auth](https://pypi.python.org/pypi/urllib2_prior_auth/)很好地解决了这个问题（我致力于将其[包含](http://bugs.python.org/issue19494)在标准库中。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-06-04T23:02:31.087

[适用与Python urllib2 基本身份验证问题](https://stackoverflow.com/questions/2407126/python-urllib2-basic-auth-problem)相同的解决方案。

见[https://stackoverflow.com/a/24048852/1733117](https://stackoverflow.com/a/24048852/1733117)；您可以子类`urllib2.HTTPBasicAuthHandler`化以将`Authorization`标头添加到与已知 url 匹配的每个请求。

```
class PreemptiveBasicAuthHandler(urllib2.HTTPBasicAuthHandler):
    '''Preemptive basic auth.

    Instead of waiting for a 403 to then retry with the credentials,
    send the credentials if the url is handled by the password manager.
    Note: please use realm=None when calling add_password.'''
    def http_request(self, req):
        url = req.get_full_url()
        realm = None
        # this is very similar to the code from retry_http_basic_auth()
        # but returns a request object.
        user, pw = self.passwd.find_user_password(realm, url)
        if pw:
            raw = "%s:%s" % (user, pw)
            auth = 'Basic %s' % base64.b64encode(raw).strip()
            req.add_unredirected_header(self.auth_header, auth)
        return req

    https_request = http_request 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-11T02:44:58.713

尝试[python-request](http://docs.python-requests.org/en/latest/)或[python-grab](https://bitbucket.org/lorien/grab)

# asp.net - 什么是用于性能测试网页/网站的好工具或网站？

> ID：635123
> 
> 赞同：6
> 
> 时间：2009-03-11T15:46:17.300
> 
> 标签：asp.net, performance, http

什么是用于性能测试网页/网站的好工具或网站？我正在尝试找到一个好的基准来检测我的页面在一个托管服务提供商和另一个托管服务提供商上的加载速度。我最初使用[http://www.freespeedtest.com/](http://www.freespeedtest.com/)但喜欢为他人获取意见和链接。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T15:49:46.293

我使用安装了[FireBug](https://addons.mozilla.org/en-US/firefox/addon/1843)和[YSlow](http://developer.yahoo.com/yslow/)插件的 Firefox。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T15:48:40.040

我用它来测量页面的大小和所需的 HTTP 请求数： [http ://www.websiteoptimization.com/services/analyze/](http://www.websiteoptimization.com/services/analyze/)

我使用[Pingdom](http://www.pingdom.com)来衡量我网站的平均响应时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-17T12:14:36.243

对于简单的基本测试，请使用 ab (ApacheBench) 或 httperf。

Pingdom 对于特定页面的初始分析和站点响应的测量非常有用。但是，这不是负载测试工具。

为此，您必须使用商业工具。以下是一些选项：

1.  基调
2.  戈麦斯**强文**
3.  负载运行器

我最近还检查了 Load Impact，它似乎是一个很好的基本工具。

最后，这是一个相当全面的选项列表。 [http://www.softwareqtest.com/qatweb1.html#LOAD](http://www.softwareqatest.com/qatweb1.html#LOAD)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T15:51:52.653

以下是我使用的一些：

[http://www.linkvendor.com/seo-tools/speedtester.html](http://www.linkvendor.com/seo-tools/speedtester.html)（这个很详细）

[http://www.vertain.com/?sst](http://www.vertain.com/?sst)（非常快速简单的速度测试）

[http://www.iwebtool.com/speed_test](http://www.iwebtool.com/speed_test)（另一个简单的速度测试）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T15:52:49.670

Firefox 的 YSlow 插件非常适合帮助您调整性能，就像 firebug 的 NET 选项卡一样。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-18T22:31:17.253

Firebug 和 YSlow 是一个很常见的组合。Google 也有[PageTest](http://code.google.com/speed/page-speed/)，这是另一个与 Firebug 一起工作的插件。它有一些不同的规则等，但仍然与 YSlow 非常相似。我喜欢使用这两种工具进行初始测试，因为它们可以提供非常简单和快速的结果。

一旦您开始进行优化并想了解性能如何变化，我建议您使用[Pagetest](http://www.webpagetest.org/test)。它为 YSlow 提供了一个 Web 界面，例如性能结果/分析以及非常漂亮的瀑布图，以查看时间花费在哪里。Pagetest 最有用的两点可能是 1) 它允许您轻松地执行多次试验，以及 2) 它为冷缓存和热缓存案例提供了清晰的结果。我发现多次试验是获得真实性能结果的唯一真正方法，单次试验的差异太大。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-08-12T22:11:00.410

我尝试了所有这些工具，最后遇到了 Firebug 的“Net Export”插件。现在我使用 Firebug 的“NET”选项卡来跟踪我的站点性能，我可以将其导出为[.har 格式](http://www.softwareishard.com/har/viewer/)，以便以后作为存档查看。我可以使用 .har 档案作为基线，然后获取更多的萤火虫“持久”痕迹，然后再在视觉上比较它们。

# sql - WHERE 子句中的 SQL 合并

> ID：635124
> 
> 赞同：9
> 
> 时间：2009-03-11T15:46:27.597
> 
> 标签：sql, sql-server

我正在尝试在我拥有的存储过程中实现可选参数，但我遇到了问题。这是一个简化的查询来说明问题：

```
SET ANSI_NULLS OFF

DECLARE @MiddleName VARCHAR(20);
SET @MiddleName = NULL;

SELECT * FROM [Customer]
WHERE [LastName] = 'Torres'
AND [MiddleName] = COALESCE(@MiddleName, [MiddleName]) 
```

当我运行这个查询时，我需要取回一行，因为一个 Torres 在 [MiddleName] 列中有 NULL。但查询返回零行。使用 IFNULL() 会产生相同的结果。通过研究 COALESCE，我的印象是如果所有表达式都是 NULL，则会返回 NULL。因为我不是 SQL 专家，所以我认为我遗漏了一些东西，但它是什么.....

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-11T15:55:57.010

问题是在 sql 中，“WHERE Null = Null”将永远不会返回任何行，因为 Null 不等于自身。

你所要做的

```
SELECT * FROM [Customer]
WHERE [LastName] = 'Torres'
AND ( @MiddleName IS NULL OR [MiddleName] = @MiddleName ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T15:56:55.683

您声明您正在寻找查询以返回字段 MiddleName 为 NULL 的行。不幸的是 (NULL = NULL) 不返回 true，它返回 NULL。

你需要类似...

```
SELECT * FROM [Customer]
WHERE [LastName] = 'Torres'
AND ([MiddleName] = @MiddleName OR @MiddleName IS NULL) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T15:51:29.847

你想这样做吗？

```
SELECT * FROM [Customer]
WHERE [LastName] = 'Torres'
AND ([MiddleName] = @MiddleName OR @MiddleName IS NULL) 
```

据我了解，它看起来像。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T15:56:13.670

当参数和列都为时您`COALESCE`返回，但测试将评估为 false，因为[a](http://msdn.microsoft.com/en-us/library/ms188048.aspx)[不等于任何其他](http://msdn.microsoft.com/en-us/library/ms188048.aspx)。`NULL``@MiddleName``MiddleName``NULL`[`NULL``NULL`](http://msdn.microsoft.com/en-us/library/ms188048.aspx)

要解决此问题，您应该显式测试`@MiddleName`参数是否为空：

```
SELECT *
FROM [Customer]
WHERE [LastName] = 'Torres'
    AND (@MiddleName IS NULL OR [MiddleName] = @MiddleName) 
```

# iphone - AppStore：应用发布后更改图标？

> ID：635125
> 
> 赞同：7
> 
> 时间：2009-03-11T15:46:32.773
> 
> 标签：iphone, app-store

我的应用已经在应用商店上架，但在得到一些反馈后，我对这个图标有了新的想法。

我知道图标的大版本应该看起来像设备版本。但是，如果我在不更改二进制图标的情况下上传一个不同的应用程序，现在应用程序已经发布了怎么办？那可以删除我的应用程序吗？

如果我决定也更改二进制图标并重新上传带有该更改的二进制文件，这是否会被视为更新并通过审核过程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T06:21:46.383

他们不应该关心您是否更新商店图像/文本，只要它看起来仍然合理。如果您发布更新，它将通过“审查”，但如果更新更改说明说您只更新了图标，他们可能会很快通过它。

您可以随时向 App Store 帮助电子邮件发送电子邮件（它列在一堆 iTunes Connect 页面上），然后看看他们说了什么。每次我问他们问题时，他们都会相对较快地回复我。

实际上，我认为您的图标看起来并没有那么糟糕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-21T10:16:08.577

这是不可能的，当您的应用程序上传并成功发布后，我们无法更改应用程序图标......所以您必须使用不同的图标再次上传。谢谢

# jsp - 在 .JSP 中快速输出会话 ID？

> ID：635126
> 
> 赞同：7
> 
> 时间：2009-03-11T15:46:33.303
> 
> 标签：jsp, jakarta-ee

我想在 .jsp 页面上快速输出当前会话 ID 以进行调试。

这可能吗？有没有人有一个 JSP 片段可以做到这一点？

非常感谢！

编辑：我找到了我要找的东西：

```
<c:out value="${pageContext.session.id}"/> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-11T22:43:02.650

如果您在容器中启用了 EL，则无需 JSTL 标记即可执行此操作 - 即只需 ${pageContext.session.id}

没有 EL 的容器的替代方案：<%= session.getId() %>

# ruby-on-rails - 用 AASM 停止过渡的最佳方法是什么

> ID：635129
> 
> 赞同：2
> 
> 时间：2009-03-11T15:46:43.663
> 
> 标签：ruby-on-rails, ruby, aasm

当在成功调用方法或进入状态转换阶段抛出错误时，捕获此错误并确保状态恢复到先前状态的最佳方法是什么。

我正在使用 AASM gem。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T16:19:27.907

如何使用 :guard 选项来确保可以执行转换？如果guard 方法返回false，则根本不执行转换。所以，我会首先检查保护方法是否满足转换的每个条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T16:23:49.830

我没有使用过这个插件，但是阅读了代码，除非我弄错了，似乎没有任何机制可以传达这些回调中的任何一个都失败了。

对于回调，这对我来说完全有意义`success`，因为只有在转换实际发生时才调用它，到那时恢复为时已晚。如果您希望在`success`回调中引发异常以防止转换，也许代码应该进入转换本身而不是`success`回调......？或者也许你需要一个额外的状态......？

关于`enter`回调，`guard`回调不是更合适吗……？如果过渡不应该继续，您可以返回 false。

# pdf - 创建带有长行的pdf，适合页面宽度而无需自动换行

> ID：635133
> 
> 赞同：1
> 
> 时间：2009-03-11T15:48:26.670
> 
> 标签：pdf, text, latex, vector

我想创建一个带有长行的大型pdf（不是典型的页面大小），最大~1000个字符/行，其中页面大小和字体不需要换行。

其目的不是为了在任何尺寸合理的显示器上查看整页时都可以阅读本文档中的文本——而是读者可以放大到文档中感兴趣的各个部分。

我用乳胶中的小字体尝试了这个，但没有成功。

任何帮助是极大的赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T16:59:48.463

这适用于pdflatex：

```
\documentclass{article}
\pdfpagewidth 200cm
\pdfpageheight 200cm
\textwidth 190cm
\def\lorem{Lorem ipsum dolor sit amet, consectetur adipisicing elit,
sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris
nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in
reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
culpa qui officia deserunt mollit anim id est laborum.} 
\begin{document}
\lorem \lorem \lorem \lorem
\end{document} 
```

# ruby-on-rails - 我的导轨安装在哪里？轨道插件在哪里？

> ID：635136
> 
> 赞同：0
> 
> 时间：2009-03-11T15:48:54.110
> 
> 标签：ruby-on-rails, location, paperclip, uninstallation

我正在尝试删除为 rails 安装的插件（回形针）。但我实际上不知道在哪里可以找到我的本地 rails 安装目录。

那么在我的本地文件系统中哪里可以找到 rails 和 rails 插件呢？我有 OS X。

或者如何从命令行卸载回形针？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T15:53:31.090

回形针是一个轨道插件，这意味着它在

```
[your rails app directory]/vendor/plugins/paperclip 
```

所以如果你删除那个文件夹，回形针就不见了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T15:55:59.273

在 rails 命令创建的目录的 vendor/plugins 目录下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-02T00:44:50.167

如果您的环境是 cygwin：/usr/lib/ruby/gems/1.9.1/gems/actionpack-3.1.3/lib

# c++ - 在VS2008编译的MFC App中关闭XP Theme

> ID：635137
> 
> 赞同：0
> 
> 时间：2009-03-11T15:48:57.947
> 
> 标签：c++, windows, mfc

我们最近刚刚将 C++ MFC 应用程序从 VS2005 切换到 VS2008。不幸的是，这样做我们的 UI 出现了外观问题，例如组框显示为蓝色而不是黑色，属性对话框具有白色背景等。我认为在 VS2008 中，MFC 已更改为尊重 OS 主题（在我的情况下为 XP 默认主题）。不幸的是，更改我们所有的控件和自定义工具栏以使应用程序再次看起来不错将需要大量工作。

那么，有谁知道代码中是否有办法将应用程序恢复到 VS2005 模式？我找到了以下代码

```
typedef void (WINAPI *tSetThemeAppProperties)(  DWORD );

tSetThemeAppProperties pSetThemeAppProperties=0;
HINSTANCE  handle  = ::LoadLibrary("UxTheme.dll");

if (handle) 
    pSetThemeAppProperties = (tSetThemeAppProperties) ::GetProcAddress(handle,"SetThemeAppProperties"); 

if ( pSetThemeAppProperties)
{
    // call function
    pSetThemeAppProperties(0/*dwFlags*/);
}
::FreeLibrary(handle); 
```

这确实会阻止 XP 主题被拾取，但会关闭所有主题并使应用程序看起来比在 VS2005 中更过时。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T15:55:31.707

It may be that VS2008 is including a [Manifest](http://msdn.microsoft.com/en-us/library/ms997646.aspx) file in the project that loads the version 6.0 comctl32.dll rather than the 5.82 comctl32.dll... both ship with Windows XP and newer.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T18:22:51.197

在“属性->配置属性->链接器->清单文件”下，将“生成清单”选项设置为“否”。

然后根据需要添加自己的清单文件，并在“属性->配置属性->清单工具->输入和输出”、“输入资源清单”下进行设置。

只要确保如果您添加自己的清单文件，它不包含对 commctl32 v6 的引用。

# jboss - 当部署在隔离的 .EAR 文件中时，jboss 4.2.2 中的 Web 模块隔离

> ID：635147
> 
> 赞同：2
> 
> 时间：2009-03-11T15:50:08.617
> 
> 标签：jboss, deployment, classloader, isolation

当部署在一个隔离的.EAR 文件中时，如何在 jboss 4.2.2 中实现 Web 模块隔离（即每个包含的 Web 应用程序在同一个 .EAR 中与其他 Web 应用程序隔离）？

Jboss 4.2.2 不断警告在部署 EAR 文件时忽略 web 模块 (jboss-web) 级别的部署描述符类加载配置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T14:38:09.183

在 4.0.x 中，它以这种方式执行：

*   部署/ear-deployer.xml

将属性“隔离”从“假”更改为“真”例如：真

```
 Change attribute 'CallByValue' from    'false' to 'true' Ex: <attribute    name="CallByValue">true</attribute> 
```

*   conf/jboss-service.xml

将属性“CallByValue”从“false”更改为“true”例如：true

*   部署/jbossweb-tomcat55.sar/META-INF/jboss-service.xml

将属性“Java2ClassLoadingCompliance”从“假”更改为“真”例如：真

将属性 'UseJBossWebLoader' 从 'false' 更改为 'true' 例如：true

谢谢，莫希特

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-19T07:56:53.810

谢谢 Mohit，但这个解决方案不可行，因为在同一个 jboss 服务器实例中，其他 3rd 方应用程序可能正在运行，我不想影响它们。

# iphone - 不兼容的指针类型：如何在 NSObject 派生集合对象中使用 CFType 派生对象？

> ID：635150
> 
> 赞同：0
> 
> 时间：2009-03-11T15:51:29.393
> 
> 标签：iphone, objective-c

我正在尝试在 NSMutableArray 中使用 ABRecordRef，但它似乎不起作用。我知道 ABRecord 是一个 C 类，但我认为 ABRecordRef 是围绕 Objective-C 类的工作，它允许我将它与 NSObjects 一起使用。我需要做什么才能完成这项工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T23:13:26.740

“不工作”是什么意思？如，你得到编译或运行时错误？

正如我在对另一张海报的回复中指出的那样，您不能在 iPhone 上使用 Objective-C API（也没有真正的 ABrecord 类可以桥接）。

一般来说，使用 iPhone 上的地址簿内容复制您感兴趣的元素，并将复制的值保存在字典之类的东西中，这是一个非常好的主意。如果您需要保存所有元素，则必须有读取 AddressBook.h 头文件中定义的每个值的代码，没有 API 方法可以通用地遍历记录。

另请记住，如果用户退出您的应用程序并返回，他们可能随时更改地址簿 - 因此，如果您要存储值，请注意他们重新启动应用程序后所做的更改！

# .net - 如何正确取消并重新启动 BackgroundWorker 进程？

> ID：635152
> 
> 赞同：9
> 
> 时间：2009-03-11T15:51:35.617
> 
> 标签：.net, multithreading, backgroundworker

我的应用程序的用户将 HTML 类型输入到 TextBox 控件中。

我希望我的应用程序在后台验证他们的输入。

因为我不想锤击验证服务，所以我尝试在每次验证之前建立一秒钟的延迟。

但是，我似乎无法正确中断已经运行的 BackgroundWorker 进程。

我的 Visual Basic 代码：

```
子 W3CValidate(ByVal WholeDocumentText 作为字符串)

    '停止任何已经运行的验证
    If ValidationWorker.IsBusy Then
        ValidationWorker.CancelAsync()
        '等待它准备好
        While ValidationWorker.IsBusy
            '暂停百分之一秒
            System.Threading.Thread.Sleep（新时间跨度（0、0、0、0、10））
        结束时
    万一

    '开始验证
    Dim ValidationArgument As W3CValidator = New W3CValidator(WholeDocumentText)
    ValidationWorker.RunWorkerAsync(ValidationArgument)

结束子

```

似乎在调用了我的 BackgroundWorker 的 CancelAsync() 之后，它的 IsBusy 永远不会变为 False。它陷入了无限循环。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T13:10:01.673

尝试这样的事情：

```
bool restartWorker = false;

    void backgroundWorker1_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
                    // add other code here
        if (e.Cancelled && restartWorker)
        {
            restartWorker = false;
            backgroundWorker1.RunWorkerAsync();
        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        if (backgroundWorker1.IsBusy)
        {
            restartWorker = true;
            backgroundWorker1.CancelAsync();
        }
        else
            backgroundWorker1.RunWorkerAsync();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T15:58:36.270

In your background worker process loop you need to check for
`backgroundWorkerPageProcess.CancellationPending`
and exit accordingly. Then once it exists your while loop isBusy should be flagged accordingly.

Update: After you set Cancel = true are you returning out of the method? *spitballing here* Update 2: You have the WorkerSupportsCancellation flag set to true on the backgroundworker? Also in worker completed method return out if e.Cancelled.... more spitballs

Update 3: after some checking and compilation of my own it appears the damn thing never gets out of isbusy within the same method. -One option is to disable the button while busy and have another to cancel, only for the user to reclick the validation. -Or on your worker completed method if(e.Cancelled) call your validation method with appropriate text....

either way is kind of bust though. Sorry to not be of much help here.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T15:55:01.460

I found the answer in this article:

[BackgroundWorker Closure and Overridable Task](http://codebetter.com/blogs/patricksmacchia/archive/2008/06/10/backgroundworker-closure-and-overridable-task.aspx) by Patrick Smacchia

I've adapted his code:

```
Private _ValidationArgument As W3CValidator

Sub W3CValidate(ByVal WholeDocumentText As String)
    If _ValidationArgument IsNot Nothing Then
        _ValidationArgument = New W3CValidator(WholeDocumentText)
        Exit Sub
    End If
    If Not ValidationWorker.IsBusy Then
        ValidationWorker.RunWorkerAsync(New W3CValidator(WholeDocumentText))
        Exit Sub
    End If
    _ValidationArgument = New W3CValidator(WholeDocumentText)
    ValidationWorker.CancelAsync()
    Dim TimerRetryUntilWorkerNotBusy As New Windows.Threading.DispatcherTimer
    AddHandler TimerRetryUntilWorkerNotBusy.Tick, AddressOf WorkTicker
    TimerRetryUntilWorkerNotBusy.Interval = New TimeSpan(1) '100 nanoseconds
    TimerRetryUntilWorkerNotBusy.Start()
End Sub

Sub WorkTicker(ByVal sender As Object, ByVal e As System.EventArgs)
    If ValidationWorker.IsBusy Then
        Exit Sub
    End If
    DirectCast(sender, Windows.Threading.DispatcherTimer).Stop()
    ValidationWorker.RunWorkerAsync(_ValidationArgument)
    _ValidationArgument = Nothing
End Sub

```

# java - Maven中的多个部署

> ID：635154
> 
> 赞同：11
> 
> 时间：2009-03-11T15:51:46.350
> 
> 标签：java, maven-2, hudson, artifactory

我们有一个内部工件存储库。目前所有快照都将部署在那里。我们还希望有一个具有 Web 界面的不同服务器，并希望将创建的工件复制到它。

对于我们的构建，我们使用 Hudson，但构建后操作“将工件部署到 Maven 存储库”与 scp 一起不起作用。所以有一个问题是用其他优雅的方式来做这件事。为什么 Maven 不能拥有多个分发存储库？有任何想法吗？

最好的事情是，如果 artifactory 在每次新部署后支持（自动！）增量导出到标准 maven 存储库。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-13T13:25:06.703

我不认为 maven 支持为单个配置文件部署到多个存储库，但也许配置文件可以更改存储库的 id 和 url。

```
 <distributionManagement>
    <repository>
      <id>${repo-id}</id>
      <name>${repo-name}</name>
      <url>${repo-url}</url>
    </repository>
  </distributionManagement> 
```

[Maven 部署](http://maven.apache.org/plugins/maven-deploy-plugin/usage.html)

然后使用配置文件选择要部署到的存储库：

```
<profiles>
  <profile>
    <id>repo1</id>
    <activation>
      <activeByDefault>true</activeByDefault>
    </activation>
    <properties>
      <repo-id>repo1</repo-id>
      <repo-name>Repo1 Name </repo-name>
      <repo-url>http://url.com/maven2</repo-url>
    </properties>
  </profile>
  <profile>
    <id>repo2</id>
    <properties>
      <repo-id>repo2</repo-id>
      <repo-name>Repo2 Name </repo-name>
      <repo-url>http://url2.com/maven2</repo-url>
    </properties>
  </profile>
</profiles> 
```

[Maven 配置文件](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-11T11:31:21.110

如果您愿意使用自定义插件，您可以将 Maven 配置为与标准部署同时部署到“镜像”位置列表。我建议在配置文件中定义它，这样您就可以控制镜像哪些部署（在每个构建中都这样做可能不合适）。

要定义一个新插件，您需要创建一个新的 Maven 项目并指定 POM 具有包装*maven-plugin*：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>name.seller.rich</groupId>
  <artifactId>maven-mirror-plugin</artifactId>
  <packaging>maven-plugin</packaging>
  <version>0.0.1</version>
  <dependencies>
    <dependency>
      <groupId>org.apache.maven</groupId>
      <artifactId>maven-plugin-api</artifactId>
      <version>2.2.0</version>
    </dependency>
    <dependency>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-deploy-plugin</artifactId>
      <version>2.4</version>
    </dependency>
  </dependencies>
</project> 
```

在 src/main/java 中定义一个 Mojo。下面的代码声明了一个“镜像”目标，它需要一个 mirrorRepository 项目列表（包含一个 repositoryId 和 url）来镜像工件部署。该插件使用与 maven-deploy-plugin 相同的部署方法，并采用大多数相同的参数。

请注意，您仍然需要在 settings.xml 中为每个具有适当权限的存储库定义一个服务器来进行部署，否则构建将失败！

```
package name.seller.rich;

import java.io.File;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

import org.apache.maven.artifact.Artifact;
import org.apache.maven.artifact.deployer.ArtifactDeployer;
import org.apache.maven.artifact.deployer.ArtifactDeploymentException;
import org.apache.maven.artifact.metadata.ArtifactMetadata;
import org.apache.maven.artifact.repository.ArtifactRepository;
import org.apache.maven.artifact.repository.ArtifactRepositoryFactory;
import org.apache.maven.artifact.repository.layout.ArtifactRepositoryLayout;
import org.apache.maven.plugin.AbstractMojo;
import org.apache.maven.plugin.MojoExecutionException;
import org.apache.maven.plugin.MojoFailureException;
import org.apache.maven.project.MavenProject;
import org.apache.maven.project.artifact.ProjectArtifactMetadata;

/**
 * @goal mirror
 * @phase deploy
 */
public class MirrorMojo extends AbstractMojo {
    /**
     * @parameter expression=
     *            "${component.org.apache.maven.artifact.deployer.ArtifactDeployer}"
     * @required
     * @readonly
     */
    private ArtifactDeployer deployer;

    /**
     * Map that contains the layouts
     * 
     * @component role=
     *            "org.apache.maven.artifact.repository.layout.ArtifactRepositoryLayout"
     */
    private Map repositoryLayouts;

    /**
     * Component used to create a repository
     * 
     * @component
     */
    private ArtifactRepositoryFactory repositoryFactory;

    /**
     * The type of remote repository layout to deploy to. Try <i>legacy</i> for
     * a Maven 1.x-style repository layout.
     * 
     * @parameter expression="${repositoryLayout}" default-value="default"
     * @required
     */
    private String repositoryLayout;

    /**
     * Parameter used to update the metadata to make the artifact as release.
     * 
     * @parameter expression="${updateReleaseInfo}" default-value="false"
     */
    private boolean updateReleaseInfo;

    /**
     * Whether to deploy snapshots with a unique version or not.
     * 
     * @parameter expression="${uniqueVersion}" default-value="true"
     */
    private boolean uniqueVersion;

    /**
     * @parameter expression="${mirrorRepositories}"
     * @required
     */
    private MirrorRepository[] mirrorRepositories;

    /**
     * @parameter expression="${localRepository}"
     * @required
     * @readonly
     */
    private ArtifactRepository localRepository;

    /**
     * @parameter expression="${project}"
     * @required
     * @readonly
     */
    private MavenProject project;

    /**
     * Deploy all artifacts for the project to each mirror repository.
     */
    public void execute() throws MojoExecutionException, MojoFailureException {
        ArtifactRepositoryLayout layout;

        layout = (ArtifactRepositoryLayout) repositoryLayouts
                .get(repositoryLayout);

        for (int i = 0; i < mirrorRepositories.length; i++) {
            MirrorRepository mirrorRepository = mirrorRepositories[i];

            ArtifactRepository deploymentRepository = repositoryFactory
                    .createDeploymentArtifactRepository(mirrorRepository
                            .getRepositoryId(), mirrorRepository.getUrl(),
                            layout, uniqueVersion);

            String protocol = deploymentRepository.getProtocol();

            if ("".equals(protocol) || protocol == null) {
                throw new MojoExecutionException("No transfer protocol found.");
            }

            deployToRepository(deploymentRepository);
        }

    }

    /**
     * Deploy all artifacts to the passed repository.
     */
    private void deployToRepository(ArtifactRepository repo)
            throws MojoExecutionException {
        String protocol = repo.getProtocol();

        if (protocol.equalsIgnoreCase("scp")) {
            File sshFile = new File(System.getProperty("user.home"), ".ssh");

            if (!sshFile.exists()) {
                sshFile.mkdirs();
            }
        }

        File pomFile = project.getFile();
        Artifact artifact = project.getArtifact();
        // Deploy the POM
        boolean isPomArtifact = "pom".equals(project.getPackaging());
        if (!isPomArtifact) {
            ArtifactMetadata metadata = new ProjectArtifactMetadata(artifact,
                    pomFile);
            artifact.addMetadata(metadata);
        }

        if (updateReleaseInfo) {
            artifact.setRelease(true);
        }

        try {
            List attachedArtifacts = project.getAttachedArtifacts();

            if (isPomArtifact) {
                deployer.deploy(pomFile, artifact, repo, localRepository);
            } else {
                File file = artifact.getFile();

                if (file != null && !file.isDirectory()) {
                    deployer.deploy(file, artifact, repo, localRepository);
                } else if (!attachedArtifacts.isEmpty()) {
                    getLog()
                            .info(
                                    "No primary artifact to deploy, deploy attached artifacts instead.");
                } else {
                    String message = "The packaging for this project did not assign a file to the build artifact";
                    throw new MojoExecutionException(message);
                }
            }

            for (Iterator i = attachedArtifacts.iterator(); i.hasNext();) {
                Artifact attached = (Artifact) i.next();

                deployer.deploy(attached.getFile(), attached, repo,
                        localRepository);
            }
        } catch (ArtifactDeploymentException e) {
            throw new MojoExecutionException(e.getMessage(), e);
        }
    }
} 
```

mojo 引用了一个 MirrorRepository 类型来封装 repositoryId 和 url，它是一个简单的 bean：

```
package name.seller.rich;

public class MirrorRepository {
    private String repositoryId;
    private String url;

    public String getRepositoryId() {
        return repositoryId;
    }

    public void setRepositoryId(String repositoryId) {
        this.repositoryId = repositoryId;
    }

    public String getUrl() {
        return url;
    }

    public void setUrl(String url) {
        this.url = url;
    }
} 
```

这是使用插件的示例配置。请注意，所有部署格式都受支持（http、scp、ftp）：

```
<plugin>
  <groupId>name.seller.rich</groupId>
  <artifactId>maven-mirror-plugin</artifactId>
  <executions>
    <execution>
      <id>mirror</id>
      <phase>deploy</phase>
      <goals>
        <goal>mirror</goal>
      </goals>
    </execution>
  </executions>
  <configuration>
    <mirrorRepositories>
      <mirrorRepository>
        <repositoryId>mirror</repositoryId>
        <url>http://path/to/mirror</url>
      </mirrorRepository>
    </mirrorRepositories>
    <!--any other deploy configuration needed-->
  </configuration>
</plugin> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T05:24:27.387

我认为在 Artifactory 中，默认情况下，它维护不同的逻辑存储库，用于上传快照和非快照。使用权限，您可以使快照存储库仅对某些人可见。

如果这还不够，另一个适用于 Artifactory 2.0 的解决方案是让 Artifactory 使用一个 MySQL 数据库，该数据库对另一个 MySQL 数据库进行异步复制，而另一个 MySQL 数据库又由 Artifactory 的单独安装读取。如果这太实时了，您可以简单地拥有两个不同的安装，根据业务规则进行更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T09:15:25.923

Artifactory*确实*具有自动导出功能。从[文档中](http://wiki.jfrog.org/confluence/display/RTF/Managing+Backups)：

> 您可以自动定期备份整个 Artifactory 系统。备份过程在目标备份目录中创建一个带时间戳的目录（或 zip 文件），基本上与使用元数据运行完整系统导出相同。[...] 每个备份都可以有自己的时间表并排除某些存储库 [...]
> 
> 备份的内容（提取时）采用标准 Maven 格式，可以加载到任何外部 Maven 存储库 [...]
> 
> Artifactory 支持增量备份到目标备份目录中的同一目标目录（名为“当前”）。这种备份只是将增量写入输出目录，导致备份速度极快。

这不正是你需要的吗？要传输文件，您可以将共享目录挂载到远程服务器并在那里进行备份，或者在本地进行备份然后 rsync 它。

# java - Web 框架性能比较

> ID：635159
> 
> 赞同：1
> 
> 时间：2009-03-11T15:52:26.037
> 
> 标签：java, php, python, performance

我正在寻找比较基于动态语言（Python、Ruby、Groovy 和 Lua）的 Web 框架的现实生活基准。如果将它们与基于 PHP、Java、ASP.NET 甚至 Perl 的经典解决方案进行比较，那就更好了。我特别感兴趣：

*   姜戈
*   Ruby on Rails
*   圣杯
*   Zend 框架
*   Struts2

编辑：至于肖恩的回答：

1.  这是一个更假设的问题，在现实生活中，我必须根据更多的约束进行选择，而不是原始速度。
2.  速度不是唯一需要考虑的参数，甚至不是最重要的参数。这些框架如何**扩展**实际上更有趣。
3.  使用标准的、众所周知的框架具有优势，在大多数情况下*（除非您正在做类似 EVE 在线的事情）超过*原始速度改进。

让我引用 D. Brown、CM Davis 和 S. Stanlick 的书[“Struts2 in Action”](http://www.manning.com/dbrown/)：

*内部框架不太可能出现跟上行业步伐的优雅修订。事实上，随着岁月的流逝，内部框架似乎受到架构侵蚀的怀疑，并且太多的扩展没有人们希望的那么优雅。”*

我完全同意。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-11T21:19:36.750

如果您的项目对速度有严重的、可识别的、需要考虑的程度，那么开始使用通用框架是一个坏主意。由于是高级的、通用的和可扩展的，它们都会太慢。

如果您的项目对超高效框架没有硬性要求，那么您在输入问题上浪费的时间可能比使用“最快”框架实际节省的时间要多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-14T13:09:00.077

**Techempower 基准测试：**

[http://www.techempower.com/benchmarks](http://www.techempower.com/benchmarks)

他们正在比较很多框架并接受新的框架进行比较。界面非常直观。在我看来，它是现在最好的基准。

**全球等待 - 1 小时演讲**

[http://www.parleys.com/#id=2942&st=5](http://www.parleys.com/#id=2942&st=5)

Django 不在这里，它只是 JVM 框架的基准。但是，它仍然很科学，值得。

# tfs - 我可以将 TFS 与 Jira 和 Zephyr 集成吗？

> ID：635162
> 
> 赞同：0
> 
> 时间：2009-03-11T15:53:03.477
> 
> 标签：tfs, jira

我的公司将 Jira 和 Zephyr 强加给我们以进行缺陷跟踪和测试管理。目前，我们很高兴将 TFS 2008 用于这两项工作，但管理层从未让某些东西没有损坏这一事实阻止他们尝试修复它。

是否有任何工具/插件可以让我们在远程托管的存储库和我们内部的 TFS 服务器之间进行同步？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T16:01:51.677

可能为时已晚，但该公司可能希望了解 2010 版本中出现的错误跟踪和手动测试的新功能。尽管 Jira 很好，但我怀疑它能否与历史调试器以及包含测试视频以及测试环境信息的能力很好地集成，并将其全部纳入工作项。

# .net - 为什么 VB.NET 中的可选类属性有一种奇怪的语法？

> ID：635167
> 
> 赞同：3
> 
> 时间：2009-03-11T15:53:56.330
> 
> 标签：.net, vb.net, attributes, language-design

我只是好奇为什么 VB.NET 中的类/属性属性有一个奇怪的可选语法，例如：

```
<TestAttr("a", "abc", Optional1:="foo", Optional2:=3)> 
```

VB.NET 允许您设置这样的可选参数以避免订单限制（这很可爱），但在这种情况下，它迫使您这样做。

例如这是不可能的：

```
<TestAttr("a", "abc", "foo", 3)> 
```

即使参数与原始定义的顺序相同。

这有什么好的理由吗？还是只是 .NET 设计者在这个问题上懒惰？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T15:57:54.290

看起来您在这里将可选参数与命名属性参数混淆了。对于属性，在构造函数中设置没有相应参数的属性的公共字段/属性是合法的。VB.Net 选择使用与按名称调用语法相同的语法。

如果你在反射器中打开 TestAttr，我想你会发现这个类有一个构造函数，它接受 2 个参数并有 2 个名为 Optional1 和 Optional2 的公共字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T15:59:04.803

必需的参数是构造函数参数。可选的作为公共可写属性存在。有必要创建提供所有参数的构造函数。这并不总是值得的。

# java - SWT DropTargetListener has empty event data under Mac OS X

> ID：635170
> 
> 赞同：2
> 
> 时间：2009-03-11T15:54:37.077
> 
> 标签：java, eclipse, macos, swt, drag-and-drop

I'm currently experiencing a weird platform inconsistency between Mac OS X and Windows/Linux.

I've implemented an SWT `DropTargetListener` and tried to analyze the data dropped in the `dragEnter` method. Unfortunately, the `data` attribute of the `TransferData` contained in the `DropTargetEvent` parameter is always `null` on OS X (but becomes valid in `DropTargetListener.drop` method where it's too late to give user feedback).

It works fine under Windows and Linux.

Can anybody help me out? Or is this a *known* limitation of SWT DND under OS X?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T15:29:41.127

由于[以下 bugzilla 请求](https://bugs.eclipse.org/bugs/buglist.cgi?query_format=advanced&short_desc_type=allwordssubstr&short_desc=&classification=Eclipse&product=Platform&component=SWT&long_desc_type=allwordssubstr&long_desc=TransferData&bug_file_loc_type=allwordssubstr&bug_file_loc=&status_whiteboard_type=allwordssubstr&status_whiteboard=&keywords_type=allwords&keywords=&op_sys=Mac+OS+X&op_sys=Mac+OS+X+-+Cocoa&emailtype1=substring&email1=&emailtype2=substring&email2=&bugidtype=include&bug_id=&votes=&chfieldfrom=&chfieldto=Now&chfieldvalue=&cmdtype=doit&order=Reuse+same+sort+as+last+time&field0-0-0=noop&type0-0-0=noop&value0-0-0=)仅返回一个旧错误，因此我不确定它是否是“TransferData”的活动错误。

然而[，在 Mac 上为 DnD 声明了更多的错误，](https://bugs.eclipse.org/bugs/buglist.cgi?query_format=advanced&short_desc_type=allwordssubstr&short_desc=&classification=Eclipse&product=Platform&component=SWT&long_desc_type=allwordssubstr&long_desc=Drag&bug_file_loc_type=allwordssubstr&bug_file_loc=&status_whiteboard_type=allwordssubstr&status_whiteboard=&keywords_type=allwords&keywords=&op_sys=Mac+OS+X&op_sys=Mac+OS+X+-+Cocoa&emailtype1=substring&email1=&emailtype2=substring&email2=&bugidtype=include&bug_id=&votes=&chfieldfrom=&chfieldto=Now&chfieldvalue=&cmdtype=doit&order=Reuse+same+sort+as+last+time&field0-0-0=noop&type0-0-0=noop&value0-0-0=)就像[这个](https://bugs.eclipse.org/bugs/show_bug.cgi?id=267381)接近你所描述的那样。

您能否添加您正在使用的 eclipse 及其 SWT 插件的确切版本？

# php - PHP 内网可以共享 Windows 登录吗？

> ID：635171
> 
> 赞同：7
> 
> 时间：2009-03-11T15:54:37.543
> 
> 标签：php, windows, sharepoint, login

我创建了一些需要用户登录的基于 PHP 的 Intranet 资源。用户创建自己的登录名，我验证他们是否使用 cookie 登录。

有人问我是否可以将该登录名绑定到他们的 Windows 登录名。我最初的反应是“网页无法访问您的 Windows 登录名——这将是一个安全风险。” 但是我们的一个部门使用 Sharepoint，它实际上将自己与 Windows 登录绑定在一起。

这是怎么做的？我可以用 PHP 做吗？如果是这样，为什么它不是一个可怕的安全漏洞？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T16:07:03.443

您正在寻找的是针对 PHP 网站的 NTLM 身份验证，这是完全可行的，但似乎 PHP 中没有单一的方法可以做到这一点。

看看[http://siphon9.net/loune/2007/10/simple-lightweight-ntlm-in-php/](http://siphon9.net/loune/2007/10/simple-lightweight-ntlm-in-php/)

您还需要将站点添加到 IE 中的受信任站点（或您使用的任何浏览器中的等效站点），并在受信任站点的设置中，打开“发送当前用户名和密码”。

这不是一个可怕的安全漏洞，因为凭据不是通过网络直接发送的，并且最终用户已明确告诉浏览器将凭据发送到相关网站。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T16:02:20.427

PHP 支持 LDAP，因此您可以访问 Windows 的 Active Directory

SourceForge 上有这个项目： [adLDAP](http://adldap.sourceforge.net/) - “LDAP Authentication with PHP for Active Directory”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T16:12:34.910

通常这是使用 LDAP 和 NTLM 的组合来完成的。像 IE 和 Firefox 这样的浏览器可以进行 NTLM 身份验证，我相信这就是 Sharepoint 的工作原理。我运行一个基于 Java 的门户应用程序，该应用程序使用 LDAP 同步用户并使用 NTLM 进行身份验证。

您绝对不想做的是让用户在浏览器中输入他们的域用户名和密码。在过去的几年里，我见过几个项目使用这种方法和 LDAP 来验证 Windows 用户。你是对的，这是一个安全问题。用户只应输入一次密码：登录工作站时。您最不想要的是缓存/临时文件中的密码。

很抱歉，我无法提供“这是您如何使用 PHP 应用程序”的答案。据我所知，这个问题没有一个答案。

（我过去做过的一件事是使用 IIS 中的 PHP，但我从未真正检查过它是有效还是不良形式。如果您使用的是 IIS，那么 PHP 将使用 Windows 填充服务器变量 REMOTE_USER用户的用户名（域\用户）。它适用于我当时正在做的事情。）

# regex - VBS-字符串将多行上的多个拆分为数组

> ID：635172
> 
> 赞同：0
> 
> 时间：2009-03-11T15:54:38.667
> 
> 标签：regex, vbscript

我正在尝试创建一个函数，该函数将采用可能超过多行的字符串，例如：

```
"declare notThese
declare orThis

hello = $notThis@butthis$
butNot= $ButNotThis$

andDefNot = getDate()" 
```

`{string1}`并搜索它，从所有部分中拉出

```
${whatever}@{string1}$ 
```

然后将它们推入一个数组。

我将如何存档？是通过正则表达式还是比这更简单？

如果字符串像上面那样呈现在多行上也会有什么不同吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T16:24:52.307

你可以通过正则表达式来做到这一点。多线与否在这种情况下不起作用。

```
Function ExtractStrings(input)
  Dim re, matches, match, i, output

  Set re = new RegExp
  re.Pattern = "\$[^@]+@([^$]+)\$"
  re.Global = True

  Set matches = re.Execute(input)

  ReDim output(matches.Count - 1)

  i = 0
  For Each match in matches  
    output(i) = match.SubMatches(0)
    i = i + 1
  Next

  ExtractStrings = output
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-24T05:53:44.700

您可以通过拆分功能做到这一点：

```
 Dim sLinesOfText As String
  sLinesOfText = "Insert multiple lines of text here"
  Dim aLines() As String
  Dim iLine As Integer
  iLine = 0

  aLines = Split(sLinesOfText, vbCrLf, , vbTextCompare)
  Do While iLine < UBound(aLines)
    Debug.Print aLines(iLine)
    iLine = iLine + 1
  Loop 
```

# spring-security - Spring Security: Custom Authentication Provider for 'one time password' and 'securit questions'

> ID：635173
> 
> 赞同：2
> 
> 时间：2009-03-11T15:54:52.723
> 
> 标签：spring-security

I am using Spring Security and would like to use authentication providers for 'one time password' and 'security questions'. The number of allowed failures for one time password and security questions is limited.

So far the authentication providers works fine but for the enduser it would be nice to know if he has typed in the wrong 'one time password' or the limit of allowed failures is exceeded. But I have only the possiblity to throw an AuthenticationException within my authentication provider.

Any ideas?

Thanks, Ralph

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T16:07:10.520

您可以继承 AuthenticationException，然后编写自定义 [extend] ExceptionTranslationFilter 来处理您的新异常。

# math - 只需要前 k 位时的快速求幂？

> ID：635183
> 
> 赞同：8
> 
> 时间：2009-03-11T15:56:01.067
> 
> 标签：math, exponentiation

这实际上是针对编程比赛的，但我已经非常努力地尝试了，甚至没有最微弱的线索如何做到这一点。

^(找到 n m)的第一个和最后 k 个数字，其中 n 和 m 可以非常大 ~ 10^9。

对于最后 k 位，我实现了模幂运算。

对于第一个 k，我想使用二项式定理达到一定的幂，但这涉及到大量的阶乘计算，我不知道如何找到一个最佳点，在该点处 n^m 可以扩展为 (x+y)^米。

那么有没有任何已知的方法可以在不执行整个计算的情况下找到前 k 位数字？

**更新**1 <= k <= 9 并且 k 将始终是 <= n ^(m中的数字)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T15:59:45.380

不确定，但我想到了恒等式 n ^m = exp10(m log10(n)) = exp(q (m log(n)/q)) 其中 q = log(10) 以及第一个 K exp10(x) 的位数 = exp10(frac(x)) 的前 K 位，其中 frac(x) = x = x - floor(x) 的小数部分。

更明确地说：n ^m的前 K 位是其[尾数](http://en.wikipedia.org/wiki/Significand)的前 K 位= exp(frac(m log(n)/q) * q)，其中 q = log(10)。

或者你甚至可以在这个会计练习中走得更远，并使用 exp((frac(m log(n)/q)-0.5) * q) * sqrt(10)，它也有相同的尾数（+ 因此相同的第一个 K数字）以便 exp() 函数的参数以 0 为中心（在 +/- 0.5 log 10 = 1.151 之间）以实现快速收敛。

（一些例子：假设你想要 2 ^(100)的前 5 位数字。这等于 exp((frac(100 log(2)/q)-0.5)*q)*sqrt(10) = 1.267650600228226 的前 5 位数字。根据 MA​​TLAB，2 ^(100)的实际值是 1.267650600228229e+030，我手边没有 bignum 库。对于 2 ^(1,000,000,000)的尾数，我得到 4.612976044195602 但我真的没有办法检查....有一个[梅森素数](http://www.isthe.com/chongo/tech/math/prime/mersenne.html)页面上有人已经完成了艰苦的工作；2 ^(20996011) -1 = 125,976,895,450... 我的公式给出了在 MATLAB 中计算的 1.259768950493908，它在第 9 位之后失败。）

我可能会使用[泰勒级数](http://en.wikipedia.org/wiki/Taylor_series)（用于 exp~~和 log~~，而不是用于 nm ^）及其误差范围，并继续添加项，直到误差范围降至前 K 位以下。（通常我不使用泰勒级数进行函数逼近——它们的误差被优化为在单个点附近最准确，而不是在所需的区间上——但它们确实具有数学上简单的优势，而且你只需添加附加项即可将准确度提高到任意精度）

对于对数，我会使用您最喜欢的近似值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-06T15:12:48.820

好。我们想计算![替代文字](https://i.stack.imgur.com/PpSJ4.png)并只得到*n 个*前位数。

![替代文字](https://i.stack.imgur.com/PpSJ4.png)通过以下迭代计算：

![替代文字](https://i.stack.imgur.com/ECQhX.png)

你有![替代文字](https://i.stack.imgur.com/1sYAc.png). ![替代文字](https://i.stack.imgur.com/ucfJ0.png)不准确地计算每个。问题是 的相对误差![替代文字](https://i.stack.imgur.com/PpSJ4.png)小于a 的相对误差*的**n*倍。

 *您希望最终的相对误差小于![替代文字](https://i.stack.imgur.com/5WOAR.png). 因此，每一步的相对误差可能是![替代文字](https://i.stack.imgur.com/jpQDF.png)。删除每一步的最后一位数字。

例如，a=2、b=16、n=1。最终相对误差为 10^{-n} = 0,1。每一步的相对误差为 0,1/16 > 0,001。因此，3 位数字在每一步都很重要。如果 n = 2，则必须保存 4 位。

2 (1), 4 (2), 8 (3), 16 (4), 32 (5), 64 (6), 128 (7), 256 (8), 512 (9), 1024 (10) - -> 102、204 (11)、408 (12)、816 (13)、1632 (14) -> 163、326 (15)、652 (16)。

答案：6。

该算法的复杂度为*O(b)*。但是很容易将其更改为 *O(log b)*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T16:19:13.897

假设你在每一步都截断？不确定这有多准确，但是，例如，取 n=11 m=某个大数字，并且您想要前 2 位数字。

递归：

1.  11 x 11 -> 121, truncate -> 12 (1 truncation or rounding) 然后取截断值并再次提升
2.  12 x 11 -> 132 截断 -> 13 重复，

3.  (132 截断) x 11 -> 143\. ...

最后加上 #0 相当于你已经完成的截断次数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T17:22:53.807

你看过[平方乘幂](http://en.wikipedia.org/wiki/Exponentiation_by_squaring)吗？您也许可以修改其中一种方法，以便只计算必要的。

在我上一堂算法课中，我们必须实现与您正在做的类似的事情，我隐约记得那个页面很有用。

# python - Visual Studio 2005 Build of Python with Debug .lib

> ID：635200
> 
> 赞同：0
> 
> 时间：2009-03-11T16:00:22.617
> 
> 标签：python, visual-studio-2005

I am looking for the Visual Studio 2005 build of Python 2.4, 2.5 or 2.6, I also need the python2x_d.lib (the debug version of the .lib) since I embed the interpreter into my app and the python libs implicitly link to the python2x_d.lib with pragmas (grrr).

Any hints where I can find those builds ?

Regards,

Paul

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T16:10:09.660

I would recommend that you [download the Python source](http://python.org/download/) (tgz and tar.bz2 zipped versions available) and compile it yourself. It comes with a VS2005 solution so it isn't difficult. I had to do this for a SWIG project I was working on.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T16:13:56.407

If you have trouble finding the debug builds, you can try and build your own. Browse the [build directory](http://svn.python.org/view/python/trunk/PCbuild/), for project files like `python.vcproj` - to locate versions that will work with Visual Studio 2005.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T16:18:53.507

我记得，前段时间，在 VS2005 中给 IronPython 一个“旋转”。我遇到了各种“深奥”的错误，直到我发现要编译和运行我还必须添加 VS2005 的 C++ 库和工具（添加/删除）。也许这是类似的东西？

# sql-server - Connect Access 2007 to SQL Server 2008 Database

> ID：635203
> 
> 赞同：5
> 
> 时间：2009-03-11T16:01:22.333
> 
> 标签：sql-server, ms-access, ms-access-2007, access-data-project

I've seen numerous answers to similar questions like this one. I haven't seen on the web many people have asked the seemingly simple question "How do I connect Access 2007 to an SQL server 2008 database" - but all of the answers describe how you can migrate from access 2007 to an sql server 2008 database, or they describe how to connect access 2007 to an sql server 2005 database. I can't find any simple solution to my problem (and probably this is a problem for many others). Here is the question (sorry for the over emphasis):

How do I connect to an sql server 2008 database (and I mean 2008, not 2005 :) ) from access 2007? Apologies again for the over emphasis, but this very simple question, and what I thought should be a very simple task seems, yes, ... impossible! I tried running sql server browser, enabling pipes, TCP etc, but it seems that with 2008 SQLEXPRESS just isn't recognised! Please can someone help with this. Peter

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-06T12:41:16.730

伙计们 - 你真的应该在随机回答之前检查这是否有效。运行一个 Access 项目大约需要一分钟，然后发现它实际上并不容易连接到 SQL 2008。

使用项目而不是 ODBC 的原因有很多，但这里有一些：

*   无法保证部署机器上存在 DSN
*   网络流量 - 默认情况下不进行直通查询
*   对存储过程的支持不佳

假设已启用适当的协议，解决方案是转到数据链接对话框的高级选项卡并删除网络库设置中的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T02:59:30.503

将 Access 2007 连接到 SQL Server 2008 数据库应该没有问题。

您需要确保：

1.  您的 SQL Server 2008 数据库是可访问的，即它没有被锁定，并且您将拥有 Access 2007 应用程序的机器可以访问它。
    需要检查的几件事：

    *   在 SQL Server 2008 中，转到属性 > 连接 > 选中“允许远程连接到此服务器”。
    *   在配置管理器中启用 TCP/IP。
    *   确保防火墙允许 TCP 端口 1433 上的传入连接。
    *   您还可以启动 SQL Server Browser 服务，以便找到您的 SQL Server 实例。
2.  您已使用 Windows ODBC 管理工具创建了 ODBC DSN（系统 DSN）。如果您在 64 位系统上运行，请确保您[使用 32 位版本的 ODBC](http://www.barik.net/archive/2006/06/08/053820/)来创建您的 DSN，否则它永远不会被 32 位应用程序 Access 看到。

3.  在安装 Access 的计算机上创建 ODBC 链接（并对其进行测试）后，您可以链接表：在 Access 2007 中，在“外部数据”功能区选项卡 > 导入 > 更多 > ODBC 数据库中。
    然后选择为 SQL Server 2008 数据库创建的 DSN，并选择要链接的表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-27T17:29:54.730

通过 Access 中的链接或导入向导时，选择 Sql Native Client 10.0。当询问您要连接到哪个服务器时，该服务器不会显示在组合框中。如果您输入正确的服务器名称并点击下一步，您将进入身份验证屏幕。如果这是您选择并点击下一步，请使用 Windows 身份验证。在下一个屏幕上，选中更改默认数据库框，您的服务器数据库应该会出现；然后你知道你有一个很好的连接。请记住，您必须输入正确的服务器名称，它应该是 MACHINE NAME\SERVER INSTANCE NAME。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-10T21:20:35.723

雷，您看不到数据库的原因是权限。您需要授予您正在使用的用户名访问您的数据库。在 MS SQL Server Management Studio 中展开您创建的数据库并转到安全选项卡以配置您正在使用的用户名。添加它或创建一个新用户

希望这会有所帮助....

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-16T02:39:47.140

`SQL Express 2008 + Access 2007`都在工作站上。从连接到`Adventureworks SQL`数据库`Access 2007`。开始了...

*   开放存取 2007
*   单击窗口或左上角图标/新建/单击空白数据库/输入文件名/
*   单击浏览图标/另存为类型/Microsoft Office Access Projects (*.adp)/单击确定/
*   在您要连接到现有 SQL Server 数据库的问题上单击“创建/”吗？
*   单击是/您可以使用下拉框选择您的计算机，但像这样输入...（例如，如果您的计算机名称是“笔记本电脑”）输入...笔记本电脑/SQLEXPRESS
*   点击用户窗口 NT 集成安全/点击步骤 3 中的向下箭头。选择服务器上的数据库：它应该显示 Adventureworks 数据库。如果您愿意，请单击测试或只是确定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T16:32:11.480

一种解决方案（尽管这可能不适用于 SQL Express）是使用 Access Data Project，尽管在 2007 年，如何做到这一点并不是那么直观。

创建一个新的（空白）数据库，但不接受默认的 .accdb 扩展名，而是将其更改为 .adp。如果您使用浏览对话框设置文件位置，您还可以选择 Access Data Project (.adp) 格式。

创建后，系统会询问您是否要链接到 SQL DB……其余部分非常直观，但如果需要，请询问更多详细信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-26T00:36:22.860

刚刚遇到了同样的问题，但发现一个链接建议在“数据链接属性”对话框中将服务器称为 .\SQLEXPRESS - 实例名称之前的 [.] 似乎产生了很大的不同。

这对我有用——我连接了，但随后访问抱怨版本组合——Access 2007 和 SQL 2008 不支持从 Access 管理数据库对象。

消息如下：

> 此版本的 Microsoft Access 不支持您的 Access 项目所连接的 Microsoft SQL Server 版本的设计更改。有关最新信息和下载，请参阅 Microsoft Office 更新网站。您的设计更改将不会被保存。

# c# - 在此 C# 代码中是否有类型检查的替代方法？

> ID：635207
> 
> 赞同：1
> 
> 时间：2009-03-11T16:02:53.470
> 
> 标签：c#

我目前正在研究节点的树结构，其中每个节点应该能够判断它是否等同于另一个节点。每个节点类都是 QueryNode 的子类。为了检查等效性，节点比较它们是否属于同一个子类并且具有相同的成员值（当然涉及更多的事情，但这是让我烦恼的部分）：

```
class VersionNode : QueryNode
{
    VersionModifier m_versionModifier;

    internal VersionModifier VersionModifier
    { get { return this.m_versionModifier; } }

    // ...

    protected override bool AreMembersEquivalent(QueryNode other)
    {
        VersionNode otherNodeAsVersionNode = other as VersionNode;

        if (otherNodeAsVersionNode == null)
            return false;
        else
            return (this.m_versionModifier == otherNodeAsVersionNode.VersionModifier);
    }
} 
```

我觉得这可能不是一个最佳解决方案，因为它涉及铸造。有没有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T16:05:05.303

最简洁的答案是不。铸造（甚至在一定程度上拆箱）并不昂贵。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T16:06:41.370

你可以这样做：

```
protected override bool AreMembersEquivalent(QueryNode other)
    {
        if (!(other is VersionNode))
           return false;
        ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T16:05:45.957

我很确定奇怪的演员不会对你造成太大伤害。你在做什么，物理建模？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T19:33:03.183

它不是更优雅，但可能更明确：

```
protected override bool AreMembersEquivalent(QueryNode other)
{
   if (GetType() == other.GetType())
   {
       return (VersionModifier == other.VersionModifier);
   }
   return false;
} 
```

# .net - 如何从 FitNesse 调用 WCF 服务

> ID：635210
> 
> 赞同：2
> 
> 时间：2009-03-11T16:03:15.310
> 
> 标签：.net, wcf, fitnesse

从控制台应用程序、asp.net 应用程序、wpf/winform 应用程序调用 WCF 服务时，您必须具有用于 WCF 服务端点信息的 app.config 或 web.config 文件。但是从FitNesse，我调用了一个.dll（类库）的夹具，这个夹具正在调用我的WCF服务。它不能调用服务，因为我不能包含它需要的端点信息——因为 DLL 不能有 app.config 文件。关于如何从 FitNesse 调用 WCF 服务的任何想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T16:09:33.453

您可以通过 WCF 中的配置执行的任何操作也可以通过编程方式完成。你能在代码中创建端点然后编译它吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T22:08:42.230

我不得不将我的 app.config 文件放在 FitNesse 的 dotnet 目录中。我还必须在我的 FitNesse 页面中添加该配置文件的路径，就像这样。

!path C:\fitnesse20090214\fitnesse\dotnet\app.config

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-14T16:19:22.373

我正在使用的一种类似方法是为测试运行者制作 app.config 的副本。
因此，我将 app.config 的副本作为 FitServer.exe.config（和 TestRunner.exe.config）作为我的夹具项目中的后期构建步骤。
如上一篇文章所述，配置文件需要与运行器位于同一目录中。

这适用于 Fitnesse .Net 跑步者的 1.6 版本以及最新的 20090214 版本。

# perl - 如何重新定义 Perl 类方法？

> ID：635212
> 
> 赞同：13
> 
> 时间：2009-03-11T16:03:59.567
> 
> 标签：perl

问题[“如何在 Perl 中对实例方法进行猴子修补？”](https://stackoverflow.com/questions/449690/how-can-i-monkey-patch-an-instance-method-in-perl) 让我思考。我可以动态地重新定义 Perl 方法吗？假设我有一堂这样的课：

```
package MyClass;
sub new {
  my $class = shift;
  my $val = shift;
  my $self = { val=> $val};

  bless($self, $class);
  return $self;
};

sub get_val {
  my $self = shift;
  return $self->{val}+10;
}
1; 
```

假设将两个数字相加真的很昂贵。

我想修改该类，以便 $val+10 仅在我第一次调用该对象的方法时计算。对该方法的后续调用将返回一个缓存值。

我可以轻松地修改该方法以包含缓存，但是：

*   我有一堆这样的方法。
*   我宁愿不弄脏这种方法。

我真正想做的是指定一个方法列表，我知道这些方法总是为给定实例返回相同的值。然后我想获取这个列表并将它传递给一个函数来为这些方法添加缓存支持

有没有一种有效的方法来做到这一点？

跟进。下面的代码有效，但是因为 use strict 不允许按字符串引用，所以我不是 100% 想要的。

```
sub myfn {
  printf("computing\n");
  return 10;
}
sub cache_fn {
  my $fnref = shift;

  my $orig = $fnref;
  my $cacheval;

  return sub {
    if (defined($cacheval)) { return $cacheval; }
    $cacheval = &$orig();
    return $cacheval;
  }
}

*{myfn} = cache_fn(\&myfn); 
```

我该如何修改才能做到这一点？：

```
cache_fn(&myfn); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-11T16:14:23.970

您可以从另一个包中覆盖 get_val 之类的方法，如下所示：

```
*{MyClass::get_val} = sub { return $some_cached_value }; 
```

如果您有方法名称列表，则可以执行以下操作：

```
my @methods = qw/ foo bar get_val /;
foreach my $meth ( @methods ) {
    my $method_name = 'MyClass::' . $meth;
    no strict 'refs';
    *{$method_name} = sub { return $some_cached_value };
} 
```

那是你想象的吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-12T09:54:50.723

[我在Mastering Perl](http://oreilly.com/catalog/9780596527242/)的“Dynamic Subroutines”一章中写了一些你可能想做的不同的事情。根据您正在做的事情，您可能想要包装子例程，或重新定义它，或子类，或各种其他东西。

Perl 是一种动态语言，因此您可以使用很多黑魔法。明智地使用它是诀窍。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T16:17:38.690

我从未尝试过使用方法，但[Memoize](http://search.cpan.org/perldoc?Memoize)可能是您正在寻找的。但请务必阅读[注意事项](http://search.cpan.org/perldoc?Memoize#CAVEATS)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T19:34:57.513

在您的情况下没有用，但是如果您的类是用[Moose编写的，那么您可以使用其](http://moose.perl.org)[Class::MOP](http://search.cpan.org/dist/Class-MOP/)基础动态覆盖方法....

```
{
    package MyClass;
    use Moose;

    has 'val' => ( is => 'rw' );

    sub get_val {
        my $self = shift;
        return $self->val + 10;
    }

}

my $A = MyClass->new( val => 100 );
say 'A: before: ', $A->get_val;

$A->meta->remove_method( 'get_val' );
$A->meta->add_method( 'get_val', sub { $_[0]->val } );

say 'A: after: ', $A->get_val;

my $B = MyClass->new( val => 100 );
say 'B: after: ', $B->get_val;

# gives u...
# => A: before: 110
# => A: after: 100
# => B: after: 100 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-12T09:43:59.783

> > 我该如何修改才能做到这一点？：
> > 
> > 缓存_fn(\&myfn);

那么根据你当前的例子，你可以做这样的事情......

```
sub cache_fn2 {
    my $fn_name = shift;
    no strict 'refs';
    no warnings 'redefine';

    my $cache_value = &{ $fn_name };
    *{ $fn_name } = sub { $cache_value };
}

cache_fn2( 'myfn' ); 
```

但是看着这个例子，我不禁想到你可以使用 Memoize 代替？

# c# - WPF：具有重复对象引用的 SelectedItems

> ID：635217
> 
> 赞同：2
> 
> 时间：2009-03-11T16:04:35.977
> 
> 标签：c#, wpf, listview

所以可以说我有这些课程：

```
public class Person
{
     public string Name { get; set; }
}
public class PersonCollection : ObservableCollection<Person> { } 
```

假设我有一个 ListView，其 ItemsSource 绑定到 PersonCollection。现在假设我有这个代码：

```
public void AddPeople()
{
     Person p = new Person() { Name = "Someone" };
     MyPersonCollection.Add(p);
     MyPersonCollection.Add(p);
     MyPersonCollection.Add(p);
} 
```

所以现在我有一个包含三个项目的 ListView，其中所有三个项目都是对 SAME 对象的引用。所以现在我选择让我们说 ListView 中索引为 0 和 2 的项目。

ListView.SelectedItems 属性会说我选择了一个项目，因为两个视觉选择的项目都是相同的对象。

那么如何获得视觉选择的项目，以便我可以删除索引 0 和 2 处的项目，而不删除索引 1 处的项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T18:42:29.263

在 WinForms 中有一个在`ListBox.SelectedIndices`这里有用的属性，但不幸的是，我们在 WPF 中没有这个属性......

您可以使用 s 遍历`ListViewItem`s [`ItemContainerGenerator.ContainerFromIndex`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemcontainergenerator.containerfromindex.aspx)，检查[`ListViewItem.IsSelected`](http://msdn.microsoft.com/en-us/library/system.windows.controls.listboxitem.isselected.aspx)然后按索引删除它们。但是，这与虚拟化效果不佳，因为`ContainerFromIndex`如果您滚动离开该项目并且它被虚拟化，则可能会返回 null。

代码看起来像这样：

```
for(int ixPerson = myListView.Items.Count - 1; ixPerson >= 0; ixPerson--)
{
   ListViewItem personItem = myListView.ItemContainerGenerator.ContainerFromIndex(ixPerson);
   if (personItem.IsSelected)
   {
      mySourcePersonCollection.RemoveAt(ixPerson);
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T17:41:20.470

在某些情况下，这是有道理的，例如，将人员添加到需要多次出现的队列中。对于这种情况，WPF 的设计似乎很糟糕。是否可以在集合中的所有项目之间手动迭代并检查它们的选择状态？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-11T17:18:54.160

我觉得你的模型有问题！无论您要实现什么目标，我都会尝试找到一种更强大的方法来实现它。

# ruby-on-rails - 删除/销毁方法不再起作用？（导轨）

> ID：635219
> 
> 赞同：1
> 
> 时间：2009-03-11T16:04:51.437
> 
> 标签：ruby-on-rails

我遇到了一个非常奇怪的问题：我在 rails 中的删除操作不再起作用。

即使我通过脚手架命令创建了所有内容，每次单击删除都会将我发送到应该删除的对象的显示视图。

```
script/generate scaffold myitem description:text 
```

这不仅在一个项目中，而且扩展到我创建的新项目。任何想法，这是从哪里来的？或者更好：知道如何解决这个问题吗？

（我唯一能想到的是，某个插件破坏了我的安装，我安装了回形针，但不知道如何卸载它：[我的插件在哪里？](https://stackoverflow.com/questions/635136/where-is-my-rails-installation-located-where-are-the-rails-plugins)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-01-25T08:32:18.530

删除指向 jquery 的链接帮助了我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T16:30:04.730

您应该能够查看日志文件以查看正在为删除生成什么 SQL，以及正在生成什么错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T16:45:34.863

实际上问题可能是Firefox。当我在 Stackoverflow 上点击*回答你自己的问题*时，我遇到了同样的问题：我的请求没有得到正确处理。我被送回正常的问题视图，但无法提交自己的答案。

因此，重新启动 Firefox 后一切正常。

（我还同时重新安装了 Ruby 和 Rails，所以我不能确定它是否是 Firefox）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-04T18:36:26.307

我以前见过这个（因为我有同样的问题）。也许这可以帮助你：

[Rails 3 :method=> :delete 在 Internet Explorer 中不起作用](https://stackoverflow.com/questions/3772450/rails-3-method-delete-doesnt-work-in-internet-explorer)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-29T11:35:54.437

我按照[这个博客](http://www.iamseree.com/application-development/rails-3-destroy-did-not-work-the-solution)一步一步解决！

# .net - 安装 ASP.NET 2.0 SDK 后，Windows Server 2008 上的 NAnt 构建失败

> ID：635224
> 
> 赞同：2
> 
> 时间：2009-03-11T16:05:30.793
> 
> 标签：.net, nant, teamcity

我正在使用 TeamCity 来管理我的一个项目，但它似乎无法在 Windows Server 2008 上与 Nant 一起正常工作。我可以做些什么来解决这个问题？

在安装 ASP.NET 2.0 框架 SDK 之前：

```
[10:21:07]: BUILD FAILED
[10:21:07]: Failed to initialize the 'Microsoft .NET Framework 2.0' (net-2.0) target framework.
[10:21:07]:     Property evaluation failed.
[10:21:07]: Expression: ${path::combine(sdkInstallRoot, 'bin')}
[10:21:07]:                             ^^^^^^^^^^^^^^
[10:21:07]:         Property 'sdkInstallRoot' has not been set. 
```

后：

```
[11:48:16]: Target framework: Microsoft .NET Framework 2.0
[11:48:16]: Target(s) specified: test 
[11:48:16]:  [property] Target framework changed to "Microsoft .NET Framework 3.5".
[11:48:16]: BUILD FAILED
[11:48:16]: INTERNAL ERROR
[11:48:16]: System.NullReferenceException: Object reference not set to an instance of an object.
[11:48:16]:    at NAnt.Core.FrameworkInfo.get_Version()
[11:48:16]:    at NAnt.Core.Project.UpdateTargetFrameworkProperties()
[11:48:16]:    at NAnt.Core.Tasks.PropertyTask.ExecuteTask()
[11:48:16]:    at NAnt.Core.Task.Execute()
[11:48:16]:    at NAnt.Core.Project.InitializeProjectDocument(XmlDocument doc)
[11:48:16]:    at NAnt.Core.Project.Execute()
[11:48:16]:    at NAnt.Core.Project.Run()
[11:48:16]: Please send bug report to nant-developers@lists.sourceforge.net.
[11:48:16]: Total time: 0.1 seconds.
[11:48:16]: Process exited with code 1
[11:48:16]: Build finished 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T07:19:00.217

1.  它需要“框架”部分中的 .net 3.5 条目。

2.  确保该部分中3.5版本的Sdkinstallroot如下，这是导致此问题的根本原因-
    `<readregistry property="sdkInstallRoot" key="SOFTWARE\Microsoft\Microsoft SDKs\Windows\v7.0A\WinSDK-NetFx40Tools\InstallationFolder" hive="LocalMachine" failonerror="false" />`

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T11:30:43.847

有几件事可能会导致这种情况。

1.  您没有安装完整的 .Net 2.0 SDK。
2.  您缺少一些注册表项。如果您查看 Windows xp / vista 机器的注册表并搜索 sdkInstallRoot，您可能会找到它。然后只需将代码复制到您的服务器。

但是，要验证您是否安装了 .net 框架 sdks @ 至少只需转到 C:\windows\Microsoft.net 文件夹并转到您需要的版本并在其中搜索以尝试找到 csc.exe 或 vbc.exe程式。如果找不到它们，则说明您没有安装 SDK，但很可能安装了运行时。

试一试，看看是否有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-30T14:29:42.933

在将 Nant 与 Windows Server 2003 64 位服务器一起使用时，我不得不下载每晚构建的版本，因为 Nant 0.86 beta 1 存在 64 位问题。我确实让它工作了，但我不确定它是否可以与 Windows Server 2008 一起工作。Nant 一直处于测试阶段。如果您坚持使用 Nant，请尝试夜间构建，否则我建议为 .Net 2+ 和 64 位机器使用 MSBuild。

有关更多信息，请查看这篇文章[MsBuild vs. Nant](http://blog.runxc.com/post/2009/04/20/MsBuild-vs-Nant.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-10T17:21:52.777

我遇到了与 NAnt 类似的问题。我知道这不是*最好*的解决方案，但如果您需要让您的项目动起来，它是一种有效的解决方案。

我发现在服务器上安装开发环境（C# Express 对我不起作用，但 VS 2008 对我有用）可以解决这个问题。（是的，我意识到这违背了正常的最佳实践，但它可以工作并让我的脚本运行，这样我就可以重新开始编码。）

只是想我会分享其他人处于类似情况的情况..（这对我来说对 CruiseControl.Net 和 Hudson 都有效）。

# c++ - 如何使用指向常量对象的指针调用成员函数指针？

> ID：635225
> 
> 赞同：3
> 
> 时间：2009-03-11T16:05:34.960
> 
> 标签：c++

这是我想要完成的内容以及如何完成的示例：

```
class MyClass
{
     public: 
         void Dummy() const{}

};
typedef void (MyClass::*MemFunc)();

void  (const MyClass * instance)
{
     MemFunc func=&MyClass::Dummy;
     // (instance->*func)(); //gives an error
         (const_cast<MyClass *>instance->*func)(); // works
} 
```

为什么编译器（gcc 3 & 4）坚持实例应该是非常量的？那 const_cast 会引起问题吗？

仅供参考：instance` 不一定是 const，我只是不想让被调用者弄乱它。

这里发生了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T16:09:36.463

错误在前面的行中。将 typedef 更改为

```
typedef void (MyClass::*MemFunc)() const; 
```

使其成为指向 const 成员函数类型的指针。

考虑此代码及其工作方式时，差异可能会更加明显：

```
typedef void FunctionType() const;
typedef FunctionType MyClass::*MemFunc; 
```

特别是成员函数指针实际上只是一般成员指针的特例。对于 const 成员函数，成员函数的函数类型不同于非常量成员函数。这就是类型必须匹配的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T16:13:03.180

> > typedef void (MyClass::*MemFunc)();

在这里，您定义了一个指向*可能*修改其对象的函数的指针。

> > MemFunc func=&MyClass::Dummy;

在这里，您正在分配一个*不会*将其对象更改为此类指针的函数。这是合法的，因为*不改变*是*可能改变*的一个子集。

> > (实例->*func)();

在这里，您尝试使用无法更改的对象调用*可能*更改其对象的函数。

您将需要更改 MemFunc 的定义

# asp.net - Javascript 检查页面是否有效

> ID：635231
> 
> 赞同：8
> 
> 时间：2009-03-11T16:07:05.470
> 
> 标签：asp.net, javascript, validation

在我的提交按钮上，我想做的是 OnClick 显示“请稍候”面板并隐藏按钮，除非验证器说某些内容无效 - 然后我需要按钮仍然明显显示。否则我有一个显示错误的验证摘要，无法再次提交。

我发现的大多数关于这样做的文章都想使用 Page_ClientValidate() 函数来告诉页面验证自己，但这对我来说是未定义的，Page_IsValid 变量也是如此。这是我正在尝试使用的功能 - 我错过了什么？：

```
function PleaseWaitShow() {
    try {
        alert("PleaseWaitShow()");

        var isPageValid = true;

        // Do nothing if client validation is not active
        if (typeof(Page_Validators) == "undefined") {
            if (typeof(Page_ClientValidate) == 'function') {
                isPageValid = Page_ClientValidate();
                alert("Page_ClientValidate returned: " + isPageValid);
                alert("Page_IsValid=" + Page_IsValid);
            } else {
                alert("Page_ClientValidate function undefined");
            }
        } else {
            alert("Page_Validators undefined");
        }

        if(isPageValid) {
            // Hide submit buttons
           document.getElementById('pnlSubmitButton').style.visibility = 'hidden';
           document.getElementById('pnlSubmitButton').style.display = 'none';

           // Show please wait panel
           document.getElementById('pnlPleaseWait').style.visibility = 'visible';
           document.getElementById('pnlPleaseWait').style.display = 'block';
       } else {
           alert("page not valid - don't show please wait");
       }
   } catch(er) {
       alert("ERROR in PleaseWaitShow(): " + er);
   }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-24T01:02:55.183

将这一行“if (typeof(Page_Validators) == "undefined") 更改为 if (typeof(Page_Validators) != "undefined")

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T16:50:03.590

根据“[深入 ASP.NET 验证](http://msdn.microsoft.com/en-us/library/aa479045.aspx#aspplusvalid_clientside)”页面上的“客户端 API”部分：

> **Page_IsValid** | 布尔变量 | 指示页面当前是否有效。验证脚本始终保持最新状态。

事实上，在启用了 ASP.NET 客户端验证的表单上查看 FireBug 中的这个变量时，当我填写表单的详细信息（错误或正确）时，它确实会更新。

显然，如果您在验证器或验证摘要上禁用了客户端脚本，那么您将无法使用此变量。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-31T09:10:25.140

只需检查

```
if(Page_IsValid)
{
    //Yourcode
} 
```

如果页面中有验证器（不包括验证摘要），则此方法有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T16:14:39.027

Page_ClientValidate() 不是我知道的任何标准 javascript 函数

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T20:55:34.983

我相信我已经找到了“某种”的答案。

我仍然无法确定为什么我的页面无法识别“Page_ClientValidate()”或“Page_IsValid”——这部分仍然没有答案。

但是，我在页面上使用了许多 PeterBlum 验证器，它们确实提供了一个返回 true/false 的“VAM_ValOnSubmit()”。所以这可能是解决方案。我可能只需要确保所有验证者都是 PeterBlum 才能全部捕获。

不是最好的解决方案，但比我迄今为止得到的要好。我仍然对“Page_IsValid”部分的答案持开放态度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-29T14:19:02.417

关于这个主题有一个 ASP.Net 论坛主题：[防止多次点击的按钮](http://forums.asp.net/t/1008333.aspx)

这是解决方案（在后面的代码中）：

```
private void BuildClickOnceButton(WebControl ctl)
{
    System.Text.StringBuilder sbValid = new System.Text.StringBuilder();
    sbValid.Append("if (typeof(Page_ClientValidate) == 'function') { ");
    sbValid.Append("if (Page_ClientValidate() == false) { return false; }} ");
    sbValid.Append(ctl.ClientID + ".value = 'Please wait...';");
    sbValid.Append(ctl.ClientID + ".disabled = true;");
    //GetPostBackEventReference obtains a reference to a client-side script function that causes the server to post back to the page.
    sbValid.Append(ClientScript.GetPostBackEventReference(ctl, ""));
    sbValid.Append(";");
    ctl.Attributes.Add("onclick", sbValid.ToString());
} 
```

# sql - SQL 日期查询 - 此条件成立多长时间

> ID：635233
> 
> 赞同：1
> 
> 时间：2009-03-11T16:07:44.457
> 
> 标签：sql, database, datetime, sybase

问题是这些客户在任何给定日期都是混蛋多久。

我正在对抗 Sybase

对于这个表history_data的简化表结构

```
表：history_of_jerkiness
处理日期名称 is_jerk
--------------- ----- --------
20090101 亚光真
20090101 鲍勃假        
20090101 亚历克斯真        
20090101 卡罗尔真        
20090102 亚光真        
20090102 鲍勃真        
20090102 亚历克斯假        
20090102 卡罗尔真        
20090103 亚光真        
20090103 鲍勃真        
20090103 亚历克斯真        
20090103 卡罗尔假        

```

第 3 次的报告应该显示，马特一直是个混蛋，亚历克斯刚刚成为一个混蛋，鲍勃已经混蛋了 2 天。

```
名字天生涩
----- ----------
马特 3
鲍勃 2
亚历克斯 1

```

我想动态地找到这些时间跨度，所以如果我第二次运行报告，我应该得到不同的结果：

```
名称 days_jerky
----- ----------
马特 2
鲍勃 1
颂歌 2

```

这里的关键是试图只找到比某个日期更早的连续跨度。我找到了一些线索，但这似乎是一个有非常聪明的棘手解决方案的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T16:56:56.100

我的 SQL Server 解决方案 - 与 Dems 相同，但我自己设置了一个最小基线。它假设没有间隙——也就是说，每个人每天都有一个条目。如果那不是真的，那么我将不得不循环。

```
DECLARE @run_date datetime
DECLARE @min_date datetime

SET @run_date = {d '2009-01-03'}

-- get day before any entries in the table to use as a false baseline date
SELECT @min_date = DATEADD(day, -1, MIN(processing_date)) FROM history_of_jerkiness

-- get last not a jerk date for each name that is before or on the run date
-- the difference in days between the run date and the last not a jerk date is the number of days as a jerk
SELECT [name], DATEDIFF(day, MAX(processing_date), @run_date)
FROM (
     SELECT processing_date, [name], is_jerk
     FROM history_of_jerkiness
     UNION ALL
     SELECT DISTINCT @min_date, [name], 0
     FROM history_of_jerkiness ) as data
WHERE is_jerk = 0
  AND processing_date <= @run_date
GROUP BY [name]
HAVING DATEDIFF(day, MAX(processing_date), @run_date) > 0 
```

我使用以下内容创建了测试表：

```
CREATE TABLE history_of_jerkiness (processing_date datetime, [name] varchar(20), is_jerk bit)

INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-01'}, 'Matt', 1)
INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-01'}, 'Bob', 0)
INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-01'}, 'Alex', 1)
INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-01'}, 'Carol', 1)
INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-02'}, 'Matt', 1)
INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-02'}, 'Bob', 1)
INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-02'}, 'Alex', 0)
INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-02'}, 'Carol', 1)
INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-03'}, 'Matt', 1)
INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-03'}, 'Bob', 1)
INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-03'}, 'Alex', 1)
INSERT INTO history_of_jerkiness (processing_date, [name], is_jerk) VALUES ({d '2009-01-03'}, 'Carol', 0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T16:32:45.720

如果您构建数据以满足以下标准，这可以变得简单......

> 所有的人都必须有一个他们不是混蛋的初始记录

你可以做类似...

```
SELECT
   name,
   MAX(date)   last_day_jerk_free
FROM
   jerkiness AS [data]
WHERE
   jerk = 'false'
   AND date <= 'a date'
GROUP BY
   name 
```

您已经知道基准日期是什么（“日期”），现在您知道他们不是混蛋的最后一天。我不知道 sybase，但我确信您可以使用一些命令来获取“a data”和“last_day_jerk_free”之间的天数

编辑：

有多种方法可以人为地创建初始化的“非生涩”记录。Will Rickards 建议使用包含联合的子查询。但是，这样做有两个缺点……
1\. 子查询屏蔽了任何可能已使用的索引
2\. 它假设所有人都有从同一点开始的数据

或者，采用 Will Rickard 的建议并将聚合从外部查询移动到内部查询（从而最大限度地利用索引），并与通用的第二个子查询联合以创建起始 jerky = false 记录......

```
SELECT name, DATEDIFF(day, MAX(processing_date), @run_date) AS days_jerky
FROM (

    SELECT name, MAX(processing_date) as processing_date
    FROM history_of_jerkiness
    WHERE is_jerk = 0 AND processing_date <= @run_date
    GROUP BY name

    UNION

    SELECT name, DATEADD(DAY, -1, MIN(processing_date))
    FROM history_of_jerkiness
    WHERE processing_date <= @run_date
    GROUP BY name

    ) as data
GROUP BY
   name 
```

外部查询仍然必须在没有索引的情况下执行最大值，但记录数量会减少（每个名称 2 个，而不是每个名称 n 个）。由于不要求每个名称对每个使用日期都有一个值，因此也减少了记录的数量。还有很多其他方法可以做到这一点，其中一些可以在我的编辑历史中看到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T16:50:51.577

“如果您构建数据以满足以下标准，这可以变得简单......

所有人都必须有一个他们不是混蛋的初始记录”

数据应该和不应该满足的标准取决于用户，而不是开发人员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T17:48:53.293

这个怎么样：

```
select a.name,count(*) from history_of_jerkiness a
left join history_of_jerkiness b
on a.name = b.name 
and a.processing_date >= b.processing_date
and a.is_jerk = 'true'
where not exists
( select * from history_of_jerkiness c
  where a.name = c.name
  and c.processing_date between a.processing_date and b.processing_date
  and c.is_jerk = 'false'
)
and a.processing_date <= :a_certain_date; 
```

# ruby-on-rails - Facebook Connect + restful_authentication

> ID：635234
> 
> 赞同：3
> 
> 时间：2009-03-11T16:09:04.157
> 
> 标签：ruby-on-rails, ruby, facebook

I've been following Stuart's tutorial at [http://www.madebymany.co.uk/tutorial-for-restful_authentication-on-rails-with-facebook-connect-in-15-minutes-00523](http://www.madebymany.co.uk/tutorial-for-restful_authentication-on-rails-with-facebook-connect-in-15-minutes-00523)

and have been having a problem:

*   I get a NoMethodError in UsersController#link_user_accounts; Rails doesn’t seem to recognize “facebook_session”. I have facebooker installed and have successfully authenticated using the normal Facebook API methods.

Has anyone tried this before? Anyone know what might be wrong? It seems that somehow the Facebooker library isn't getting fully loaded...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-30T20:33:43.407

如果您尝试将 Facebook Connect 身份验证集成到您的应用程序中，我强烈建议您从 restful_authentication 切换到[Authlogic](http://github.com/binarylogic/authlogic/tree/master)。它有一个[插件](http://github.com/kalasjocke/authlogic_facebook_connect/tree/master)，可让您轻松访问 Facebook Connect。

[您可以在此处](http://github.com/binarylogic/authlogic_example/tree/master)下载使用 Authlogic 的示例应用程序进行查看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:21:59.837

为了使 facebook-session 正常工作，所有文件都应该位于正确的域中。你有同一个域上的所有文件/库吗？

# ios - 选项卡栏问题：-[UILayoutContainerView hash]：消息发送到释放的实例

> ID：635237
> 
> 赞同：0
> 
> 时间：2009-03-11T16:09:36.947
> 
> 标签：ios, objective-c, iphone, cocoa-touch, debugging

我似乎正在释放标签栏本身、导航控制器或???之类的东西，当我转到特定视图控制器然后将标签栏点击到特定标签时会发生这种情况（例如，如果我点击中间选项卡，共 3 个选项卡，没问题，但如果我点击最右边的选项卡，我会崩溃）。我的程序基本上完成了，此时我有一个相当大的代码库。任何人都对此有任何调试建议——我一直在等到现在才处理这个问题。我的感觉是查看 dealloc 例程和相邻代码中的任何版本。您可以建议任何不那么“手动”的东西吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T21:45:23.363

在不知道更多的情况下，这就是我将如何去做。

1.  在日志查看器中，在 gdb 发生异常后键入 backtrace。希望这将为您提供确切的行，显示哪个对象被释放了太多次。

2.  寻找对这个对象的引用，通过检查是否能找到不必要的释放、自动释放等。你不能释放/自动释放你的执行路径不拥有的任何东西（通过 alloc）。

您可能有一些运气打印出此对象的保留计数（通过将 retainCount 消息发送到有问题的对象）。尽管开发人员的文档强烈建议这是毫无意义且没有成果的，但我发现它有时有助于在我意外释放某些东西时帮助我缩小范围。

# jquery - 选择Jquery中的所有空文本字段

> ID：635240
> 
> 赞同：7
> 
> 时间：2009-03-11T16:10:48.287
> 
> 标签：jquery, jquery-1.3

如何找到所有具有空值的文本字段？

```
$(":text[value='']") 
```

给出一个 JavaScript 错误

我知道我可以做`$(":text")`，遍历并返回所有字段`$(this).val()==''`

我正在寻找一种更简洁的方法并使用 JQuery 1.3.1 如果元素在页面加载时最初有一个值，然后用户清除它，它必须工作。（`$("#elem").attr('value')`给出那个地方的原始值，虽然 .val() 工作正常）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-11T17:05:04.880

## 最新答案：升级到 1.3.2

[这是我在http://docs.jquery.com/Downloading_jQuery](http://docs.jquery.com/Downloading_jQuery)上通过 FireBug 运行的各种测试

在页面加载时使用特殊的greasemonkey 脚本切换不同的jQuery 版本。

```
>>> jQuery.prototype.jquery
"1.3.2"
>>> jQuery(":text[value='']")
[input#jq-primarySearch]
Unknown pseudo-class or pseudo-element 'text'.
>>> jQuery(":text[value=]").get()
[input#jq-primarySearch]

>>> jQuery.prototype.jquery
"1.3.1"
>>> jQuery(":text[value='']")
Syntax error, unrecognized expression: value='']
>>> jQuery(":text[value=]").get()
[input#jq-primarySearch]

>>> jQuery.prototype.jquery
"1.3"
>>> jQuery(":text[value='']");
Object length=1 prevObject=Object context=document
Unknown pseudo-class or pseudo-element 'text'.
[Break on this error] undefined
>>> jQuery(":text[value=]").get()
[input#jq-primarySearch] 
```

请注意，1.3 和 1.3.2 可以正确处理它（尽管 Firefox 发送错误），但它们仍然可以正确处理节点。

**或者**：您可以使用`:text[value=]`符号，它似乎在我尝试过的任何地方都有效。它只是有点怀疑就是这样。

（忽略我以前的咆哮，他们都是胡说八道，没有美好的一天-_-）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T22:49:15.830

我刚刚尝试过，对我来说效果很好：

```
$(":text[value=]") 
```

我刚刚删除了选择器中的单引号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T16:15:57.570

你很亲密。jQuery 选择器中没有赋值，所以你只需要一个'='：

```
$(":text[value='']") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T16:47:27.370

这似乎对我有用

```
$(":text:not([value])") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-26T16:23:10.393

以下代码执行此操作：

1.  在表单中搜索输入字段和文本区域
2.  检查文本值是否为空
3.  给 textfield/textarea 一个黑色的背景色来证明这行得通

    ```
    $('form').find("input[type=text], input[type=password], textarea").each(function(ev)
    {

    if(!$(this).val())
    {
       $(this).css("background-color","black");
    }

    }); 
    ```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-11T16:34:37.650

因为我没有测试过，所以在黑暗中拍摄，但这样做是否有效：

```
$(":text:empty") 
```

# web-services - What is best practice for 'private' public URLs?

> ID：635244
> 
> 赞同：0
> 
> 时间：2009-03-11T16:13:34.143
> 
> 标签：web-services, url, private, access-control

What is considered best practice to generate a URL that is publicly accessible, but shared via a side channel, so that it is in practice private to the group sharing it?

Something like:

[http://example.com/club/XX-XX-XX-XX](http://example.com/club/XX-XX-XX-XX)
[http://example.com/club/YY-YY-YY-YY](http://example.com/club/YY-YY-YY-YY)

Where XX-XX-XX-XX shared among one group, and YY-YY-YY-YY is shared by another group. If you have one valid code, it should not be easy to guess other valid codes.

No other security is required for the URL.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T16:15:24.903

[GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)s are always a good choice for unique IDs and are very easy to generate (but look ugly)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T16:15:53.453

考虑使用 Amazon S3，它们有时间限制的公开 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T16:16:19.113

我建议生成一个 UUID。如果您的后端是 Java，您可以使用 Java 的 java.util.UUID 和 URLEncode/Decode 其文本表示。如果您使用的是 ASP.NET，我敢肯定 .NET 中有一个等价物。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T16:16:47.680

要生成 URL 的路径部分，请使用某种形式的哈希（SHA1 可以）。当然是随机的。chmod 文件所在目录到 711 ( `rwx--x--x`)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T16:17:52.170

一个随机的字母数字字符序列就可以完成这项工作。从 26 个小写字母、26 个大写字母和 10 个重复十几次的数字中选择的字符应该足以满足您的需要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T16:20:33.473

您在复杂性和可读性（甚至是可记忆性）之间进行权衡。GUID 提供了一个“独特”的代码，如前所述，它很容易生成，但可读性和记忆性很低。任意拆分的随机字符串也可能提供解决方案。最后，随机选择的英文单词更容易记忆和交流，并且可能仍会提供相同级别的隔离和保护。

毕竟，除非您的用户特别勤奋并且禁用地址历史记录和浏览器历史记录，否则 URL 将在那里供所有人查看谁随后访问了该计算机。

# php - regex for url and image within a text or html

> ID：635247
> 
> 赞同：1
> 
> 时间：2009-03-11T16:14:33.440
> 
> 标签：php, regex, image, url

i'm running out of ideas on the best regex implementation for this problem.

Sample user input:

```
bla bla bla http://foo.com bla bla bla http://tinypic.com/boo.png bla bla bla
```

Looking for solution that will detect non-image url and turn it into a link and also turn image url into an image embed (IMG tag).

so the output will be:

```
bla bla bla <a href="http://foo.com">http://foo.com</a> bla bla bla <img src="http://tinypic.com/boo.png" /> bla bla bla
```

### Related

*   [Regex to check if valid URL that ends in .jpg, .png, or .gif](https://stackoverflow.com/questions/169625/regex-to-check-if-valid-url-that-ends-in-jpg-png-or-gif)
*   [What is the best regular expression to check if a string is a valid URL](https://stackoverflow.com/questions/161738/what-is-the-best-regular-expression-to-check-if-a-string-is-a-valid-url)
*   [Getting parts of a URL (Regex)](https://stackoverflow.com/questions/27745/getting-parts-of-a-url-regex)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T16:25:39.623

将其分解为多个步骤。

首先，找到类似以下内容的链接：

```
/http:[^ ,]+/i 
```

然后根据类型将匹配的字符串替换为新内容，您可以通过将要替换的字符串与以下内容进行匹配来检测：

```
/\.(jpg|png|gif|bmp)$/i 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T16:46:34.377

> 寻找将检测非图像 url 的解决方案

没有图像或非图像 URL 这样的东西。'.gif'/'.jpeg'/'.jpg'/'.png' 文件扩展名的存在（或不存在）与 URL 是否指向图像无关。

例如。“<a href="http://www.example.com/getimage/3" rel="nofollow noreferrer">http://www.example.com/getimage/3” 可以返回一个非常好的 JPEG。如果不获取 URL（使用 GET 或更好的 HEAD）并检查返回的“Content-Type”是否为“image/something”，就无法知道 URL 指向的媒体类型。

# c# - 清理从 MS Word 粘贴的内容

> ID：635255
> 
> 赞同：2
> 
> 时间：2009-03-11T16:16:06.480
> 
> 标签：c#, asp.net, ms-word

我正在寻找一种服务器端 (C#) 方法来清理从 MS Word 粘贴的内容。我知道很多像 FCKEdit 这样的富文本编辑器都内置了这种功能，但我想在后端处理它，以使其对用户尽可能无缝。

杰夫发布了一种方法来做到这一点

> [http://www.codinghorror.com/blog/archives/000485.html](http://www.codinghorror.com/blog/archives/000485.html)

但那已经是三年多了。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T16:26:37.047

过去不得不处理[类似](https://stackoverflow.com/questions/391291/how-do-i-remove-word-markup-crap-when-inserting-to-a-form/391329)的事情（并且通常坚持使用编辑器的内置选项），我会说 Jeff 的正则表达式集合看起来不错 - 我没有测试过它，但它似乎涵盖了大部分奇怪的东西该词添加的标记（例如所有 <o:p> 类型的标签）。

# winforms - 在复杂的 Winform 上同步数据绑定控件

> ID：635256
> 
> 赞同：1
> 
> 时间：2009-03-11T16:16:09.193
> 
> 标签：winforms, data-binding

我有一个非常复杂的窗口表单，其中包含使用强类型数据集和绑定源组件的 grandParent>Parent>Child 数据集的选项卡式表示。

使用 bindngsource 降低雇佣关系是一种享受；我的问题是我有一些数据的多个“并行”视图（例如，第一个选项卡是开放作业的摘要视图，其他选项卡显示此数据的父视图和子视图）以及“查找”下拉列表。所有这些我都试图保持同步，以便更改孙记录将更新父绑定源，以及同步查找下拉列表。

我正在努力让它正常工作；我有表单级别的属性来保存当前的工作和同步表单的例程，例如：

在 bindingsource.positionchanged 上：

```
 SetCurrentDetailJob(Me.PKSitesJobsBindingSource) 
```

这是：

```
 Private Sub SetCurrentJob(ByVal JobBindingSource As BindingSource)

    If JobBindingSource.Position > -1 Then
        _CurrentJob = CType(CType(JobBindingSource.Current, DataRowView).Row, ARCallDataSet.JobsRow)
        _CurrentSite = _CurrentJob.GetParentRow("PK_Sites_Jobs")
        _CurrentCompany = _CurrentSite.GetParentRow("PK_Company_Sites")
    End If 
```

然后是执行此类操作的同步表单例程：

```
CompanyBindingSource.Position = CompanyBindingSource.Find("companyid", drsite.CompanyID) 
```

我似乎永远无法完全避免某种连锁反应，即绑定源位置更改事件触发多次，导致绑定源不正确同步不一致。我不确定处理此同步逻辑的最佳方法。

其他人如何处理这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-07T13:47:58.507

I'd consider creating your own events and having every where the data can be changed raise an "changed" event, and everywhere you are doing databinding add a handler for the event to ensure it catches the event and updates its current view.

# c# - 如何使用封装和转义拆分分隔字符串

> ID：635264
> 
> 赞同：1
> 
> 时间：2009-03-11T16:18:16.567
> 
> 标签：c#

我想分割一个由诸如'&'之类的字符分隔的字符串，但在某些值包含分隔符的情况下，我想用双引号转义。什么是一种优雅的拆分方法，同时忽略已转义的分隔字符，同时考虑转义字符转义？

例如正确拆分此字符串

```
var1=asdfasdf&var2=contain””quote&var3=”contain&delim”&amp;var4=”contain””both&” 
```

进入：

```
var1=asdfasdf
var2=contain"quote
var3=contain&delim
var4=contain"both& 
```

顺便说一句，我在想正则表达式......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T20:09:37.027

我的解决方案，通过测试：

```
 void TestCharlesParse()
    {
        string s = @"var1=asdfasdf&var2=contain""""quote&var3=""contain&delim""&var4=""contain""""both&""";
        string[] os = CharlesParse(s);

        for (int i = 0; i < os.Length; i++)
            System.Windows.Forms.MessageBox.Show(os[i]);
    }

    string[] CharlesParse(string inputString)
    {
        string[] escapedQuotes = { "\"\"" };

        string[] sep1 = inputString.Split(escapedQuotes, StringSplitOptions.None);

        bool quoted = false;
        ArrayList sep2 = new ArrayList();
        for (int i = 0; i < sep1.Length; i++)
        {
            string[] sep3 = ((string)sep1[i]).Split('"');
            for (int j = 0; j < sep3.Length; j++)
            {
                if (!quoted)
                {
                    string[] sep4 = sep3[j].Split('&');
                    for (int k = 0; k < sep4.Length; k++)
                    {
                        if (k == 0)
                        {
                            if (sep2.Count == 0)
                            {
                                sep2.Add(sep4[k]);
                            }
                            else
                            {
                                sep2[sep2.Count - 1] = ((string)sep2[sep2.Count - 1]) + sep4[k];
                            }
                        }
                        else
                        {
                            sep2.Add(sep4[k]);
                        }
                    }
                }
                else
                {
                    sep2[sep2.Count - 1] = ((string)sep2[sep2.Count - 1]) + sep3[j];
                }
                if (j < (sep3.Length-1))
                    quoted = !quoted;
            }
            if (i < (sep1.Length - 1))
                sep2[sep2.Count - 1] = ((string)sep2[sep2.Count - 1]) + "\"";
        }

        string[] ret = new string[sep2.Count];
        for (int l = 0; l < sep2.Count; l++)
            ret[l] = (string)sep2[l];

        return ret;
    } 
```

# asp.net - Sharepoint WebPart 中 Silverlight 控件的客户端 ID

> ID：635272
> 
> 赞同：2
> 
> 时间：2009-03-11T16:20:50.210
> 
> 标签：asp.net, javascript, silverlight, sharepoint, web-parts

背景：我在共享点 Web 部件中有一个 Silverlight 控件，它公开了一些可编写脚本的方法。我使用这些方法来调用 Web 服务并获取一系列菜单选项。然后将这些菜单选项注入到单击列表中的项目时出现的 Sharepoint ECB 菜单中。

我遇到的问题是能够在 Javascript 中获取 silverlight 控件的 clientID，因此我可以使用它来调用可编写脚本的方法。这将出现的页面可能具有相同silverlight控件的多个实例，并且控件层次结构可能不同......

这是我目前拥有的客户端JS代码，其中clientID是硬编码的......

```
function TestQueryMenu() {
        var plugin = document.getElementById('ctl02_IntuitionModelBrowserControl');
        var contextUri = document.getElementById('TestUri').value;
        var key = contextUri;
        plugin.Content.ModelBrowser.GetContextMenuOptionsCompleted = MenuItemsReceived;
        plugin.Content.ModelBrowser.GetContextMenuOptionsAsync(key, contextUri);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T23:52:29.220

我最终使用以下函数将代码隐藏中的插件 ID 作为隐藏字段注入页面...

Page.ClientScript.RegisterHiddenField()。

然后我使用 javascript 来读取隐藏字段的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T09:35:03.407

我认为 Jesse "Silverlight" Liberty 先生的博客文章“将[参数传递到 Silverlight 应用程序](http://jesseliberty.com/2008/12/26/passing-parameters-into-silverlight-applications/)”可以帮助您解决问题。

# iphone - 实用程序应用程序信息按钮保持在顶部

> ID：635274
> 
> 赞同：0
> 
> 时间：2009-03-11T16:20:58.167
> 
> 标签：iphone, objective-c, cocoa-touch

我使用实用程序应用程序模板来创建我的应用程序，但我使用 UIImagePicker 来挑选一些照片。显示选择器时会显示小信息按钮，即带有圆圈的 i。如果 infoButton 不在另一个类中，那么我可以调用 infoButton.hidden = YES; 它会隐藏它。任何想法如何解决这个问题？谢谢，-帕特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-31T17:09:02.053

我看了一下实用程序应用程序模板，灰色背景和信息按钮的视图控制器是 MainViewController，实例也是应用程序委托的“mainViewController”属性。

您似乎已经为 infoButton 创建了一个 IBOutlet，因此，您可以通过调用 [UIApplication sharedApplication].delegate.mainViewController.infoButton 来访问该按钮。

# c++ - 简单的线程同步

> ID：635276
> 
> 赞同：8
> 
> 时间：2009-03-11T16:21:18.120
> 
> 标签：c++, winapi, mfc

我需要一个简单的“一次一个”锁定一段代码。考虑`func`可以从多个线程运行的函数：

```
void func()
{
     // locking/mutex statement goes here
     operation1();
     operation2();
     // corresponding unlock goes here
     operation3();
} 
```

我需要确保`operation1`并`operation2`始终“一起”运行。使用 C#，我会`lock`在这两个调用周围使用一个简单的块。什么是 C++/Win32/MFC 等价物？

大概是某种`Mutex`？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-11T17:56:06.440

修复上面的[迈克尔解决方案](https://stackoverflow.com/questions/635276/simple-thread-synchronization/635295#635295)。

Michael 解决方案非常适合 C 应用程序。但是当在 C++ 中使用时，由于异常的可能性，不鼓励这种风格。如果在 operation1 或 operation2 中发生异常，则临界区将不会正确离开，所有其他线程将阻塞等待。

```
// Perfect solutiuon for C applications
void func()
{
    // cs previously initialized via InitializeCriticalSection
    EnterCriticalSection(&cs);
    operation1();
    operation2();
    LeaveCriticalSection(&cs);
    operation3();}
}

// A better solution for C++
class Locker
{
    public:
    Locker(CSType& cs): m_cs(cs)
    {
        EnterCriticalSection(&m_cs);
    }
    ~Locker()
    {
        LeaveCriticalSection(&m_cs);
    }
    private:
        CSType&  m_cs;
}
void func()
{
    // cs previously initialized via InitializeCriticalSection
    {
        Locker  lock(cs);
        operation1();
        operation2();
    }
    operation3();
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-11T16:26:08.920

关键部分将起作用（它们比互斥锁更轻。） InitializeCriticalSection、EnterCriticalSection、LeaveCriticalSection 和 DeleteCriticalSection 是要在[MSDN](https://msdn.microsoft.com/en-us/library/windows/desktop/ms686908(v=vs.85).aspx "MSDN")上查找的函数。

```
void func()
{
    // cs previously initialized via InitializeCriticalSection
    EnterCriticalSection(&cs);
    operation1();
    operation2();
    LeaveCriticalSection(&cs);
    operation3();}
} 
```

编辑：关键部分比互斥锁快，因为关键部分主要是用户模式原语 - 在非竞争获取的情况下（通常是常见情况），内核没有系统调用，并且获取需要几十个周期。内核切换更昂贵（大约数百个周期）。调用内核的唯一时间关键部分是为了阻塞，这涉及等待内核原语（互斥锁或事件）。获取互斥锁总是需要调用内核，因此速度要慢几个数量级。但是，临界区只能用于同步一个进程中的资源。为了跨多个进程同步，需要一个互斥锁。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-11T16:31:15.240

最好的方法是使用临界区，使用 EnterCriticalSection 和 LeaveCriticalSection。唯一棘手的部分是您需要首先使用 InitializeCriticalSection 初始化临界区。如果此代码在一个类中，则将初始化放在构造函数中，并将 CRITICAL_SECTION 数据结构作为类的成员。如果代码不是类的一部分，您可能需要使用全局或类似的东西来确保它被初始化一次。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-11T17:17:46.097

1.  使用 MFC：

    1.  定义一个同步对象。（多文本或关键部分）

        1.1 如果属于不同进程的多个线程进入func()，则使用CMutex。

        1.2\. 如果同一进程的多个线程进入 func() 则使用 CCriticalSection。

    2.  CSingleLock 可用于简化同步对象的使用。

假设我们已经定义了临界区

```
 CCriticalSection m_CriticalSection;
    void func()
    {
         // locking/mutex statement goes here
         CSingleLock aLock(&m_CriticalSection, **TRUE**); 
       // TRUE indicates that Lock aquired during aLock creation.
       // if FALSE used then use aLock.Lock() for locking.

         operation1();
         operation2();
          // corresponding unlock goes here
          aLock.Unlock();
         operation3();
    } 
```

> 编辑：参考 MSDN 中的 VC++ 文章：[Multithreading with C++ and MFC Classes](http://msdn.microsoft.com/en-us/library/975t8ks0(VS.80).aspx) and [Multithreading: How to Use the Synchronization Classes](http://msdn.microsoft.com/en-us/library/thdxkfx9(VS.80).aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T16:31:15.087

你可以试试这个：

```
void func()
{
    // See answer by Sasha on how to create the mutex
    WaitForSingleObject (mutex, INFINITE);
    operation1();
    operation2();
    ReleaseMutex(mutex);
    operation3();
} 
```

# sql-server-2000 - MS SQL 2000 慢，很多超时。我怎样才能提高性能？

> ID：635277
> 
> 赞同：2
> 
> 时间：2009-03-11T16:22:50.440
> 
> 标签：sql-server-2000

我在 SQL Authority 上找到了这个脚本：

使用 MyDatabase
GO
EXEC sp_MSforeachtable @command1=“print '?' DBCC DBREINDEX ('?', ' ', 80)”
GO
EXEC sp_updatestats
GO

它已将我的插入失败率从 100% 降低到 50%。它比重新索引维护计划更有效。

我还应该重新索引 master 和 tempdb 吗？多常？（我每天 24 小时写信给这个数据库）我应该注意什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T05:12:23.180

NAS 上的 RAID 5？那是你的杀手。

记录一个 INSERT：它写入 .LDF（日志）文件。该文件是 100% 写入的（嗯，足够接近）。

这种巨大的读写比在 RAID 5 中为每个磁盘生成大量额外的写入。

我有一篇工作中的文章（稍后添加）：在 100% 写入情况下，RAID 5 每个磁盘的写入量是 RAID 10 的 4 倍。

**解决方案**

您至少需要拆分数据库的数据和日志文件。

编辑：澄清这一行：日志文件需要转到 RAID 1 或 RAID 10 驱动器。对于数据 (.MDF) 文件来说，它并不那么重要。日志文件是 100% 写入的，因此受益于 RAID 1 或 RAID 10。

还有其他潜在问题，例如碎片文件系统或许多 Vlog 段（取决于您的数据库的增长方式），但我想说您的主要问题是 RAID 5。

对于 3TB 的数据库，我还会在（如果 Windows Advanced/Enterprise 为 32GB）中填充尽可能多的 RAM，并设置 PAE/AWE 等。这将缓解一些磁盘问题，但仅适用于数据缓存。

填充因子 85 或 90 是通常的经验法则。如果您的插入很宽并且不是严格单调的（例如 int IDENTITY 列），那么您将有很多更高的页面拆分。

我不是唯一不喜欢 RAID 5 的人：[BAARF](http://www.baarf.com/)

再次编辑：

在此 SQL Server 2000 文章中查找“[预写日志 (WAL) 协议”。](http://technet.microsoft.com/en-gb/library/cc966500.aspx)它仍然是相关的：它解释了为什么日志文件很重要。

我找不到关于在 100% 写入负载下 RAID 5 与 RAID 10 相比如何受到影响的文章。

最后，SQL Server 以 64k 块进行 I/O：因此使用 64k 集群格式化 NTFS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T23:53:04.913

感谢所有的帮助。我还没有，但正在好转。

我对硬件限制无能为力。允许所有可用 RAM 将 SQL 填充因子设置为 95 使用分析器，一小时的跟踪提供了索引调整，建议提高 27% 的效率。

结果，我成功插入的数量增加了一倍。现在只有四分之一的人失败了。现在跟踪，之后会调整，看看它是否会变得更好。

还不明白锁。

**对于那些将 SQL Server 保持为职业的人，我是否走在正确的轨道上？**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T17:52:29.260

还请查看您的查询计划。某些索引可能没有被使用，或者 SQL 可能完全低效。

你有什么表维护？

表中的所有数据都与今天的处理有关吗？

你能储存一些数据吗？

你的锁是什么样的？你锁定整张桌子了吗？

编辑：SQL 探查器显示与 SQL Server 的所有交互。它应该是 DBA 的命脉。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T16:34:11.413

这可能是任何事情。系统 CPU 是否受限？IO绑定？磁盘是否过于碎片化？系统分页是否过多？网络是否过载？

你调整过索引吗？我不记得 2000 年是否有索引调整向导，但至少，您可以运行分析器来创建 SQL Server 2005 索引调整向导可以使用的工作负载。

# c# - IIS7 或 ASP.NET 返回一个奇怪的客户端 IP 地址

> ID：635281
> 
> 赞同：2
> 
> 时间：2009-03-11T16:23:17.897
> 
> 标签：c#, asp.net, iis, iis-7

在我的 ASP.NET 应用程序中，我这样说是为了获取客户端 IP 地址：

```
string ipAddress = HttpContext.Current.Request.UserHostAddress; 
```

这是我一直使用的正常、直接的方法，而且它似乎总是有效的。大家都知道，上面的语句只是 REMOTE_ADDR 服务器变量的包装。

很简单，对吧？好吧，在过去的几天里，我注意到在我的本地开发机器上，它返回这个值：

```
"fe80::dde4:def3:7f1b:a582%10" 
```

我不知道为什么。我正在运行 Vista x64 并使用 IIS7 运行我的应用程序。我确实启用了 IPv4 和 IPv6，但通常会返回如下内容：

```
"1::" 
```

我不知道为什么会这样。重启解决不了任何问题。

**编辑：**

发生这种情况时，我正在使用 Chrome。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T16:27:26.403

看起来它正在返回[IPv6](http://en.wikipedia.org/wiki/IP_v6)。

`::1`是 IPv6 的环回地址，它只是`1::`.

我还应该注意`fe80::/10`IPv6 中的地址是自动配置 IP 地址（在 IPv4 中，这些是`169.254.0.0/16`）。例如，如果您在专用 LAN 上并且无法访问 DHCP 服务器，Windows 将自动为您的以太网适配器分配一个自动配置 IP 地址。

仅供参考，您通常应该为无法访问 DHCP 服务器的适配器分配一个私有 IP 地址。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T16:28:50.740

当您看到此问题时，您是否正在使用 FireFox？默认情况下，如果可用，它将使用 IPv6。我建议关闭它：

*   导航到“关于：配置”
*   找到“network.dns.disableIPv6”条目
*   设置为真

这也将加速本地开发和调试，因为启用 IPv6 时 FF 有时会无缘无故挂起。

我推荐的另一个选项是禁用 IPv6。除非您运行的是端到端的 IPv6，否则它现在没有用处，而最终用户 ISP 没有。只需打开连接上的连接属性并取消选中“Internet 协议版本 6 (TCP/IPv6)”框。

# wpf - WPF DataGrid 按钮列禁用

> ID：635290
> 
> 赞同：3
> 
> 时间：2009-03-11T16:25:10.047
> 
> 标签：wpf, datagrid

是否可以禁用 DataGridTemplateColumn 中的按钮？我有一个 DataGridTemplate 如下：

```
<toolkit:DataGridTemplateColumn Header="Timer" Width="50">
                    <toolkit:DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="Start" Click="Button_Click" CommandParameter="{Binding}" />
                        </DataTemplate>
                    </toolkit:DataGridTemplateColumn.CellTemplate>
                </toolkit:DataGridTemplateColumn> 
```

Button 的目的是启动一个记录到与该行关联的对象的计时器。我的计时器代码工作正常，但我还想禁用每隔一行的按钮，以便您只能运行一个计时器。

我用了

`WorkItemGrid.Columns[WorkItemGrid.Columns.Count - 1].GetCellContent(item).IsEnabled = false`

禁用它并且所有按钮正确显示为禁用，但是如果您单击该按钮两次，它将重新启用并允许您第三次单击它并触发 Click 事件。是否可以实际禁用该按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T00:16:49.750

我会让 Datagrid 绑定的对象公开一个“IsEnabled”布尔属性，我可以将按钮绑定到。每当调用处理程序时，只需从原始集合中获取另一个对象并将它们的属性更改为 false。这将自动禁用其他按钮。

如果您无法控制“计时器”类，则可以在将网格数据绑定到对象集合之前将其包装在您自己的类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T23:42:51.967

如果可以接受除了其他按钮之外禁用单击的按钮，那么我将绑定`Button.IsEnabled`到设置为一旦计时器启动的属性，然后在操作完成后将`false`其更改回。`true`

如果这是不可接受的，那么我不确定是否有办法做到这一点，因为根据定义，模板用于在每一行中创建控件。好吧，您*可以*搜索所有其他按钮的可视化树，但这似乎不是一件好事（更不用说对于大量数据它可能会很慢）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-08T16:23:44.503

```
its not working in my case. 

                                      <DataGridTemplateColumn Width="70" Header="Refund" >
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button x:Name="btnRefundGame" IsEnabled="{Binding RESUND_STATUS}" CommandParameter="{Binding Path=IDEN_LOGID}" Content="Refund" Click="btnRefundGame_Click"   ></Button>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn> 
```

# c# - 过时属性混淆

> ID：635291
> 
> 赞同：3
> 
> 时间：2009-03-11T16:25:26.660
> 
> 标签：c#, properties, attributes, obsolete

> **可能重复：**
> [为什么在 C# 集合属性上调用属性时没有将其标记为过时？](https://stackoverflow.com/questions/577132/why-are-c-sharp-collection-properties-not-flagged-as-obsolete-when-calling-prope)

我想将 ObsoleteAttribute 应用于属性，但似乎编译器仅针对属性的直接使用生成警告/错误，任何间接使用都会被默默忽略。

我认为下面的例子很好地说明了这个问题：

```
using System;
class Program
{
    static void Main(string[] args)
    {
        var o = new Old();
        Console.WriteLine(o.Geezer); // compilation fails: 'ObsoleteAttributeTest.Program.Old.Geezer' is obsolete: 'Some error' 
        Console.WriteLine(o.Geezer.Attributes); // compiles OK
    }

    class Old
    {
        [ObsoleteAttribute("Some error", true)]
        public System.Xml.XmlElement Geezer { get { return null; } }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T16:28:03.220

我相信这是最新的 C# 编译器 (C# 3.0) 中的一个已知错误。[StackOverflow 上](https://stackoverflow.com/questions/577132/why-are-c-collection-properties-not-flagged-as-obsolete-when-calling-properties)还有一个与此问题相关的问题。

# performance - Web 服务器的理论性能限制是多少？

> ID：635293
> 
> 赞同：5
> 
> 时间：2009-03-11T16:25:41.353
> 
> 标签：performance, c10k

在当前部署的 Web 服务器中，其性能的典型限制是什么？

我相信一个有意义的答案是每秒 100、1,000、10,000、100,000 或 1,000,000 个请求中的一个，但今天这是真的吗？5年前哪个是真的？5年后我们可以期待什么？（即带宽、磁盘性能、CPU 性能等趋势如何影响答案）

如果它很重要，则应考虑 HTTP over TCP 是访问协议这一事实。操作系统、服务器语言和文件系统效果应该被认为是最好的。

假设磁盘包含许多静态服务的小型唯一文件。我打算消除内存缓存的影响，而 CPU 时间主要用于组装网络/协议信息。这些假设旨在将答案偏向“最坏情况”估计，其中请求需要一些带宽、一些 cpu 时间和磁盘访问。

我只是在寻找精确到一个数量级左右的东西。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-11T16:29:28.460

阅读[http://www.kegel.com/c10k.html](http://www.kegel.com/c10k.html)。您还可以阅读[标记为 'c10k' 的 StackOverflow 问题](https://stackoverflow.com/questions/tagged/c10k)。C10K 代表 10'000 个并发客户端。

长话短说——主要是，限制既不是带宽，也不是 CPU。是并发。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T06:38:46.493

六年前，我看到一个 8 进程的 Windows Server 2003 机器每秒处理 100,000*个*静态内容请求。那个盒子有 8 个千兆以太网卡，每个都在一个单独的子网上。限制因素是网络带宽。即使使用真正巨大的管道，您也无法通过 Internet 提供如此多的内容。

实际上，对于纯静态内容，即使是一个普通的盒子也会使网络连接饱和。

对于动态内容，没有简单的答案。可能是 CPU 利用率、磁盘 I/O、后端数据库延迟、工作线程不足、上下文切换过多……

您必须测量您的应用程序以找出瓶颈所在。它可能在框架中，也可能在您的应用程序逻辑中。它可能会随着您的工作量的变化而变化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T16:30:18.940

我认为这真的取决于你所服务的。

如果您正在为动态呈现 html 的 Web 应用程序提供服务，那么 CPU 是消耗最多的。

如果您多次提供相对较少的静态项目，您可能会遇到带宽问题（因为静态文件本身可能会发现自己在内存中）

如果您提供大量静态项目，您可能会首先遇到磁盘限制（查找和读取文件）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T21:43:25.787

如果您无法将文件缓存在内存中，那么磁盘寻道时间可能会成为限制因素，并将您的性能限制在 1000 个请求/秒以下。使用固态磁盘时，这可能会有所改善。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-04T19:35:59.050

> 每秒 100、1,000、10,000、100,000 或 1,000,000 次请求，但今天哪个是正确的？

该测试是在一台普通的 i3 笔记本电脑上完成的，但它审查了 Varnish、ATS（Apache Traffic Server）、Nginx、Lighttpd 等。

[http://nbonvin.wordpress.com/2011/03/24/serving-small-static-files-which-server-to-use/](http://nbonvin.wordpress.com/2011/03/24/serving-small-static-files-which-server-to-use/)

有趣的一点是，使用高端 8 核服务器对大多数服务器（Apache、Cherokee、Litespeed、Lighttpd、Nginx、G-WAN）的提升很小：

[http://www.rootusers.com/web-server-performance-benchmark/](http://www.rootusers.com/web-server-performance-benchmark/)

由于测试是在 localhost 上完成的，以避免将网络作为瓶颈，因此问题出在无法扩展的内核中 - 除非您[调整其选项](http://gwan.com/source/ab.c)。

因此，要回答您的问题，进度余量在于服务器处理 IO 的方式。他们将不得不使用更好的数据结构（无需等待）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T16:29:11.767

我认为这里有太多变量来回答你的问题。

什么处理器，什么速度，什么缓存，什么芯片组，什么磁盘接口，什么主轴速度，什么网卡，如何配置，列表是巨大的。我认为您需要从另一面解决问题...

“这就是我想做和实现的，我需要做什么？”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T16:29:46.367

这将取决于您的 CPU 内核是什么 您的磁盘速度是多少 什么是“胖”“中等”大小的托管公司管道。什么是网络服务器？

问题太笼统

[使用http://jmeter.apache.org/](http://jmeter.apache.org/)之类的工具部署您的服务器对其进行测试，然后看看您是如何进行的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-11T16:30:03.247

操作系统、服务器语言和文件系统效果是这里的变量。如果你把它们取出来，那么你就会得到一个无开销的 TCP 套接字。

在这一点上，这实际上不是服务器性能的问题，而是网络的问题。使用无开销 TCP 套接字，您将遇到的限制很可能是在防火墙或网络交换机上，可以同时处理多少个连接。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-11T17:22:10.937

在任何使用数据库的 Web 应用程序中，您还开辟了一系列全新的优化需求。

索引、查询优化等

对于静态文件，您的应用程序是否将它们缓存在内存中？

等等等等等等

# php - 从 JSP 页面调用 PHP 代码

> ID：635297
> 
> 赞同：0
> 
> 时间：2009-03-11T16:26:45.860
> 
> 标签：php, jsp

> **可能重复：**
> [是否可以同时使用 JSP 和 PHP？](https://stackoverflow.com/questions/2025912/is-it-possible-to-use-jsp-and-php-at-the-same-time)

我试图从我的 JSP 页面调用一段 PHP 代码。我怎么做？我通常使用 servlet，但我需要这个 PHP 代码来创建特定的报告，因为它动态地对表字段进行排序，而我的 servlet 无法做到这一点。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T16:28:44.327

您可以通过 JSP 中的命令执行（exec()？）调用 PHP，让 JSP 处理 PHP 的输出...

# java - 如何处理 Java HTMLDocument 中的自定义标签？

> ID：635301
> 
> 赞同：0
> 
> 时间：2009-03-11T16:27:46.030
> 
> 标签：java, html, jeditorpane

`JEditorPane`我有一个摆动客户端，它通过使用和 `HTMLDocument`类来呈现 HTML 。

我遇到的问题是我希望能够将文档的一个区域定义为一些文本的容器，这些文本将在以后检索，然后用 `document.setInnerHTML(element, data);`“真实”内容替换占位符内容.

所以，我决定定义一个类似这样的标签：

```
<html>
<body>
some text <mytag id="1>placeholder</mytag> some more text
</body>
</html> 
```

当我使用时出现问题`document.getElement(String id)`- 它发现 mytag 作为一个元素，但它认为它是一个没有内容的叶子元素，所以我不能在它上面调用 .setInner() 。查看它的父元素列表，它认为有 3 个 - 我的标签刚刚被解释为单个组件：

mytag（开始）
内容
mytag（结束）

所以，我猜我需要告诉文档（或者它的解析器）我的标签，但这就是我失败的地方，因为我对这个领域还很陌生。

那么，有没有人有过这方面的经验？我可以作弊并使用跨度标签，但这感觉不对，因为（为简洁起见）我还需要针对标签存储一个附加属性。

在此先感谢您的时间...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T16:42:25.120

看起来您需要覆盖 HTMLDocument 以返回识别自定义标签的阅读器。有关详细信息，请参阅[HTMLDocument#getReader](http://java.sun.com/javase/6/docs/api/javax/swing/text/html/HTMLDocument.html#getReader(int))。您需要返回一个[HTMLReader](http://java.sun.com/javase/6/docs/api/javax/swing/text/html/HTMLDocument.HTMLReader.html)的子类，它理解自定义标签（通过 registerTag 方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T16:45:16.923

也许将您的详细信息设置为标签的属性？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-25T11:17:10.880

[http://java-sl.com/custom_tag_html_kit.html](http://java-sl.com/custom_tag_html_kit.html) 这显示了如何添加自定义标签。您可以使用它来编写自己的标签支持。

# vim - 如何在 Vim 中缩进一段 C 代码？

> ID：635312
> 
> 赞同：15
> 
> 时间：2009-03-11T16:29:32.030
> 
> 标签：vim, vi

### 复制：

> [如何在 Windows 的 vim 编辑器中缩进代码？](https://stackoverflow.com/questions/413208/how-to-indent-code-in-vim-editor-in-windows)
> 
> [在 VIM 中选择部分](https://stackoverflow.com/questions/442302/tabbing-selected-section-in-vim)

有时我想在 Vim 中缩进一段 C 代码。我通常会逐行标记它。

什么是更好/更快的方法？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-11T16:51:53.630

我很惊讶还没有人想出`=%`。
确保你有`:set cindent`，
把自己放在`{}`你的块之一上，然后点击：

```
=% 
```

此块中的所有代码都将正确缩进。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-11T16:32:22.697

使用 '>' 标记一个块

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-11T16:31:39.297

进入视觉模式，选择到下一个匹配的括号，缩进：

```
V
%
> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-11T16:36:09.020

插入时：Cd、Ct
可视时：>、<
正常时：>>、<<

在任何这种模式下使用“。” 进一步缩进。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T16:32:33.617

尝试

:set cindent

这将打开 vim 中的 C 缩进魔法。因此，只要您打开一个支架，它就会自动选择标签，直到您关闭支架。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T16:37:02.373

如果您有看起来像这样的未缩进代码......

```
if (foo)
{
/* line 1 */
/* line 2 */
/* line 3 */
} 
```

...在命令模式下将光标放在“第 1 行”并键入`3==`，其中 3 是要缩进的行数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T16:55:06.417

我认为这将在没有设置任何缩进开关的情况下完成。

```
:startRange,stopRange s/^/^\t/g 
```

应该在您提供的行号范围之间的行首添加一个制表符空间

取消缩进：

```
:startRange,stopRange s/^\t/^/g 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-11T17:05:37.157

除了skinp所说的，如果你有：

```
 int foo()
   {
   /* line 1 */
       /* line 2 */
       /* line 3 */
       /* line 4 */
   } 
```

并且无论出于何种原因希望它看起来像这样（即，您希望所有内容从它们以前的位置缩进 4 个空格*，而不是根据 cindent 规则“正确”缩进）：

```
 int foo()
   {
       /* line 1 */
           /* line 2 */
           /* line 3 */
           /* line 4 */
   } 
```

块内的任何位置，执行 viB> (visualselection innerBlock indent)**

`*`或任何你的 shiftwidth 设置在

`**`vi} 与 viB 相同，并且可能更容易记住，因为 vi} 在 {} 内选择，vi) 在 () 内选择，vi] 在 [] 内选择，vi> 在 <> 内选择。

此外，va}、va) 等除了块中包含的内容外，还选择 {}、() 等。

# internet-explorer - 禁用 IE 中的调整大小控件

> ID：635319
> 
> 赞同：2
> 
> 时间：2009-03-11T16:30:38.037
> 
> 标签：internet-explorer, mode

我有一个 Web 应用程序，基于 TinyMCE (javascript) 的 HTML 所见即所得编辑器。在 Internet Explorer 中使用 designMode="on" 启用内容编辑。

如果我在编辑的内容中放置一个 iframe：

这是我作为 HTML 源代码编辑的内容。

```
<iframe src="..."></iframe>
<b>I just added an iframe to my content</b> 
```

iframe 将变得可见，但 Internet Explorer 将为它创建调整大小控件。这意味着我作为用户可以使用鼠标调整 iframe 的大小。

我想禁用它。有人知道这是否可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T18:25:29.413

有点尴尬，之前没想到。

解决方案是 - 当然（在 javascript 中）：

```
var comp = doc.getElementById('my_iframe_comp');
comp.oncontrolselect = function() { return false; }; 
```

通过在 controlselect 事件上返回 false，传播停止并且调整大小控件不显示。

# git - 无法在 Git 中恢复文件

> ID：635325
> 
> 赞同：8
> 
> 时间：2009-03-11T16:32:05.363
> 
> 标签：git, rm

> **可能重复：**
> [在 Git 存储库中恢复已删除的文件](https://stackoverflow.com/questions/953481/restore-a-deleted-file-in-a-git-repo)

我的 Git 中有两个分支，*master 和 newFeature*。在分支*newFeature*，我首先在终端物理上删除了 fileA ，然后在 Git 中删除了

```
git rm fileA 
```

随后，我跑

```
git add .
git commit 
```

现在，我再次需要**fileA**。*我有一个想法，我可以通过简单地切换到分支master*来取回它。我显然错了，因为我找不到**fileA**。

**如何使用 Git 取回 fileA？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-11T19:21:12.633

First, you need to find where you have last version of `fileA`. You can use "git log -p" or "git whatchanged" to check when it was deleted, or you can use "git ls-files <*revision*> -- fileA" to check if file is present in given commit, where '<*revision*>' can be *master* or *newFeature^* (*newFeature^* means parent of *newFeature*).

Then you need to check it out, either using

```
$ git checkout <revision> -- fileA 
```

or redirect "git show" output

```
$ git show <revision>:fileA > fileA 
```

Don't forget to add file to git (if needed)!

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T17:26:41.490

在删除 fileA 之前在提交处创建标签或分支，将其签出，将 fileA 复制到其他地方，然后`newFeature`再次签出分支。其余的应该很简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T16:38:05.600

```
@titan:~$ cd /tmp/
@titan:/tmp$ mkdir x
@titan:/tmp$ git init
Initialized empty Git repository in /tmp/.git/
@titan:/tmp$ echo a > a
@titan:/tmp$ git add a
@titan:/tmp$ git ci -m a
Created initial commit c835beb: a
 1 files changed, 1 insertions(+), 0 deletions(-)
 create mode 100644 a
@titan:/tmp$ git rm a
rm 'a'
@titan:/tmp$ git ci -m b
Created commit de97fae: b
 1 files changed, 0 insertions(+), 1 deletions(-)
 delete mode 100644 a
@titan:/tmp$ git whatchanged 
commit de97fae7a72375ffa192643836ec8273ff6f762b
Date:   Wed Mar 11 17:35:57 2009 +0100

    b

:100644 000000 7898192... 0000000... D  a

commit c835beb7c0401ec27d00621dcdafd366d2cfdcbe
Date:   Wed Mar 11 17:35:51 2009 +0100

    a

:000000 100644 0000000... 7898192... A  a
@titan:/tmp$ git show 7898192
a
@titan:/tmp$ git show 7898192 > a
@titan:/tmp$ 
```

# c# - 用同一个 CookieContainer 冲浪

> ID：635330
> 
> 赞同：2
> 
> 时间：2009-03-11T16:32:33.053
> 
> 标签：c#, cookiecontainer

您如何在为每个 Web 请求分配相同 CookieContainer 的网站上冲浪？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T16:38:52.243

这是我几年前写的一门课。它还不是很完整，在我完全理解一切是如何工作之前就完成了（例如，它不能正确编码复杂的 POST 数据），但它确实可以很好地解决所有缺陷，它将展示如何保留 cookiecontainer . 它也在 VB.Net 中，但如果需要，您可以将其构建到单独的程序集中或通过翻译器运行它：

```
Imports System.Net
Imports System.Collections.Generic

Public Class WebScraper
    Public Sub New()
        SetUserAgent(UserAgent.IE6SP1) 'default agent
    End Sub

#Region "Cookies"
    Private Cookies As New CookieContainer()

    Public Sub AddCookie(ByVal Name As String, ByVal data As String, Optional ByVal path As String = "", Optional ByVal domain As String = "")
        Dim ck As New Cookie(Name, data, path, domain)
        AddCookie(ck)
    End Sub
    Public Sub AddCookie(ByRef cookie As Cookie)
        Cookies.Add(cookie)
    End Sub

    Public Sub ResetSession()
        Cookies = New CookieContainer()
        'TODO: Add other session reset code here
    End Sub

    Public Function GetCookies(ByVal uri As System.Uri) As System.Net.CookieCollection
        Return Cookies.GetCookies(uri)
    End Function
    Public Function GetCookies(ByVal url As String) As Net.CookieCollection
        Dim url2 As Uri = Nothing
        If Uri.TryCreate(url, UriKind.Absolute, url2) Then
            Return Cookies.GetCookies(url2)
        Else
            Return Nothing
        End If
    End Function
#End Region

    Public Property TimeOut() As UInteger
        Get
            Return _TimeOut
        End Get
        Set(ByVal value As UInteger)
            _TimeOut = value
        End Set
    End Property
    Private _TimeOut As UInteger = 100000 ''//100000 matches default used by httprequest if none is specified

    Public Property PageEncoding() As System.Text.Encoding
        Get
            Return _PageEncoding
        End Get
        Set(ByVal value As System.Text.Encoding)
            _PageEncoding = value
        End Set
    End Property
    Private _PageEncoding As System.Text.Encoding = System.Text.Encoding.UTF8

#Region "UserAgents"
    ' TODO: Update this for FF3, add GoogleBot
    ' TODO: Move to separate class with distinct sub-types (eg: UserAgents.IE.6XP or UserAgents.FF.2XP, classes that overload .ToString())
    Public Enum UserAgent
        IE6SP1
        IE7_XP
        IE7_Vista
        FF2_XP
        FF2_Vista
        FF2_Mac
        FF2_Linux
        Safari
    End Enum

    Public Sub SetUserAgent(ByVal UserAgent As UserAgent)
        Select Case UserAgent
            Case WebScraper.UserAgent.FF2_Linux
                Agent = "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.8.1.4) Gecko/20070713 Firefox/2.0.0.5"
            Case WebScraper.UserAgent.FF2_Mac
                Agent = "Mozilla/5.0 (Macintosh; U; Intel Mac OS X; en-US; rv:1.8.1) Gecko/20070713 Firefox/2.0.0.5"
            Case WebScraper.UserAgent.FF2_Vista
                Agent = "Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.8.1.3) Gecko/20070713 Firefox/2.0.0.5"
            Case WebScraper.UserAgent.FF2_XP
                Agent = "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.3) Gecko/20070713 Firefox/2.0.0.5"
            Case WebScraper.UserAgent.IE6SP1
                Agent = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)"
            Case WebScraper.UserAgent.IE7_Vista
                Agent = "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; .NET CLR 1.1.4322; .NET CLR 2.0.50727)"
            Case WebScraper.UserAgent.IE7_XP
                Agent = "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)"
            Case WebScraper.UserAgent.Safari
                Agent = "Mozilla/5.0 (Macintosh; U; Intel Mac OS X; en) AppleWebKit/522.12.1 (KHTML, like Gecko) Safari/522.12.1"
        End Select
    End Sub

    Public Sub SetUserAgent(ByVal UserAgent As String)
        Agent = UserAgent
    End Sub

    'defaults to IE6 SP1
    ' TODO: Choose a better default
    Private Agent As String
#End Region

#Region "Get Page"
    Public Function GetPage(ByVal URL As Uri, Optional ByVal PostData As String = "") As String
        Dim reader As IO.StreamReader = Nothing
        Try
            reader = New System.IO.StreamReader(SendRequest(URL, PostData).GetResponseStream, PageEncoding)
            GetPage = reader.ReadToEnd()
        Catch
            GetPage = ""
        Finally
            Try
                reader.Close()
            Catch
            End Try
        End Try
    End Function
    Public Function GetPage(ByVal URL As String, Optional ByVal PostData As String = "") As String
        Dim URL2 As Uri = Nothing
        If Uri.TryCreate(URL, UriKind.Absolute, URL2) Then
            Return GetPage(URL2, PostData)
        Else
            Return ""
        End If
    End Function
    Public Function GetPage(ByVal URL As String, ByRef PostData As IEnumerable(Of KeyValuePair(Of String, String))) As String
        Return GetPage(URL, PrepPostData(PostData))
    End Function
    Public Function GetPage(ByVal URL As Uri, ByRef PostData As IEnumerable(Of KeyValuePair(Of String, String))) As String
        Return GetPage(URL, PrepPostData(PostData))
    End Function
#End Region

#Region "Get Response"
    Public Function GetResponse(ByVal URL As Uri, Optional ByVal Postdata As String = "") As Object
        Dim x As HttpWebResponse = SendRequest(URL, Postdata)
        If x.ContentType.Contains("text") Then
            Dim result As String
            Dim reader As IO.StreamReader = Nothing
            Try
                reader = New System.IO.StreamReader(x.GetResponseStream, System.Text.Encoding.UTF8) ' TODO: figure out how to detect actual encoding
                result = reader.ReadToEnd()
            Catch
                result = ""
            Finally
                Try
                    reader.Close()
                Catch
                End Try
            End Try
            Return result
        ElseIf x.ContentType.Contains("image") Then
            Dim result As Drawing.Image
            Try
                result = System.Drawing.Image.FromStream(x.GetResponseStream)
            Catch
                result = Nothing
            End Try
            Return result
        Else
            Return x.GetResponseStream
        End If
    End Function
    Public Function GetResponse(ByVal URL As Uri, ByRef PostData As IEnumerable(Of KeyValuePair(Of String, String))) As Object
        Return GetResponse(URL, PrepPostData(PostData))
    End Function
    Public Function GetResponse(ByVal URL As String, ByRef PostData As IEnumerable(Of KeyValuePair(Of String, String))) As Object
        Return GetResponse(URL, PrepPostData(PostData))
    End Function
    Public Function GetResponse(ByVal URL As String, Optional ByVal PostData As String = "") As Object
        Dim URL2 As Uri = Nothing
        If Uri.TryCreate(URL, UriKind.Absolute, URL2) Then
            Return GetResponse(URL2, PostData)
        Else
            Return Nothing
        End If
    End Function
#End Region

#Region "SaveResponseToFile"
    Function SaveResponseToFile(ByVal FullFileName As String, ByVal URL As Uri, Optional ByVal PostData As String = "") As Boolean
        Try
            Dim x As New IO.BinaryReader(SendRequest(URL, PostData).GetResponseStream)
            Dim y As New IO.FileStream(FullFileName, IO.FileMode.Create)
            Dim z As New IO.BinaryWriter(y)

            Try ' TODO: I can do better here
                While True
                    z.Write(x.ReadByte)
                End While
            Catch ' continue
            End Try

            z.Flush()
            z.Close()
        Catch
            Return False
        End Try
        Return True
    End Function
    Function SaveResponseToFile(ByVal FullFileName As String, ByVal URL As String, Optional ByVal PostData As String = "") As Boolean
        Dim URL2 As Uri = Nothing
        If Uri.TryCreate(URL, UriKind.Absolute, URL2) Then
            Return SaveResponseToFile(FullFileName, URL2, PostData)
        Else : Return False
        End If
    End Function
    Function SaveResponseToFile(ByVal FullFileName As String, ByVal URL As String, ByRef PostData As IEnumerable(Of KeyValuePair(Of String, String))) As Boolean
        Return SaveResponseToFile(FullFileName, URL, PrepPostData(PostData))
    End Function
    Function SaveResponseToFile(ByVal FullFileName As String, ByVal URL As Uri, ByRef PostData As IEnumerable(Of KeyValuePair(Of String, String))) As Boolean
        Return SaveResponseToFile(FullFileName, URL, PrepPostData(PostData))
    End Function
#End Region

#Region "Get Image"
    Public Function GetImage(ByVal URL As String) As System.Drawing.Image
        Try
            GetImage = System.Drawing.Image.FromStream(SendRequest(URL).GetResponseStream)
        Catch
            GetImage = Nothing
        End Try
    End Function
    Public Function GetImage(ByVal URL As Uri) As System.Drawing.Image
        Try
            GetImage = System.Drawing.Image.FromStream(SendRequest(URL).GetResponseStream)
        Catch
            GetImage = Nothing
        End Try
    End Function
#End Region

#Region "PostToURL"
    Public Sub PostToURL(ByVal URL As String, Optional ByVal PostData As String = "")
        SendRequest(URL, PostData)
    End Sub
    Public Sub PostToURL(ByVal URL As Uri, Optional ByVal PostData As String = "")
        SendRequest(URL, PostData)
    End Sub
    Public Sub PostToURL(ByVal URL As String, ByRef PostData As Dictionary(Of String, String))
        PostToURL(URL, PrepPostData(PostData))
    End Sub
    Public Sub PostToURL(ByVal URL As Uri, ByRef PostData As Dictionary(Of String, String))
        PostToURL(URL, PrepPostData(PostData))
    End Sub
#End Region

#Region "Private Methods"
    Private Function PrepPostData(ByRef PostData As IEnumerable(Of KeyValuePair(Of String, String))) As String
        PrepPostData = ""  ' TODO: properly encode post data
        For Each pair As KeyValuePair(Of String, String) In PostData
            PrepPostData += pair.Key & "=" & pair.Value & "&"
        Next pair
        PrepPostData = PrepPostData.Remove(PrepPostData.Length - 1)
    End Function

    Private Function SendRequest(ByVal URL As String, Optional ByVal PostData As String = "") As HttpWebResponse
        Dim URL2 As Uri = Nothing
        If Uri.TryCreate(URL, UriKind.Absolute, URL2) Then
            Return SendRequest(URL2, PostData)
        Else
            Return Nothing
        End If
    End Function
    Private Function SendRequest(ByVal URL As Uri, Optional ByVal PostData As String = "") As HttpWebResponse
        Dim Request As HttpWebRequest = HttpWebRequest.Create(URL)

        Request.CookieContainer = Cookies
        Request.Timeout = TimeOut
        Request.UserAgent = Agent

        If PostData.Length > 0 Then
            Request.Method = "POST" ' TODO: allow explicitly setting METHOD and Content-type for request via properties
            Request.ContentType = "application/x-www-form-urlencoded"
            Dim sw As New IO.StreamWriter(Request.GetRequestStream())
            sw.Write(PostData)
            sw.Close()
        End If

        Return Request.GetResponse()
    End Function
#End Region
End Class 
```

轻微更新的 C# 版本[现已在 GitHub 上](https://github.com/jcoehoorn/WebScraper)，包括更新的用户代理。它也不太可能只是吞下异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-08T13:40:20.767

CookieContainer 的设计类似于浏览器 cookie 存储。因此它可以在任何站点中包含 cookie，因为它将处理域路径和到期。我可以说在同一个容器中可以有任何域，所以任何 Web 请求也应该有相同的容器。

您应该注意到 CookieContainer 在 .Add(Cookie) 和 .GetCookies(uri) 方法上有一个错误。

查看详细信息并在此处修复：

[http://dot-net-expertise.blogspot.com/2009/10/cookiecontainer-domain-handling-bug-fix.html](http://dot-net-expertise.blogspot.com/2009/10/cookiecontainer-domain-handling-bug-fix.html)

# mysql - 有人知道格式化 MySQL 查询的命令行工具吗？

> ID：635335
> 
> 赞同：1
> 
> 时间：2009-03-11T16:33:45.360
> 
> 标签：mysql

我经常需要从日志文件中调试大型 MySQL 查询，并且正在寻找一种工具来格式化和缩进它们 - 最好是 windows 命令行，但会考虑任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T16:55:22.953

[SQLinForm](http://www.sqlinform.com/)是我遇到的一个工具，可以满足您的需求。有一个免费的在线版本或 30 欧元的桌面版本。

这是他们网站上的摘要简介：

> SQLinForm 是所有主要数据库（ORACLE、SQL Server、DB2 / UDB、Sybase、Informix、PostgreSQL、Teradata、MySQL 等）的自动 SQL 代码格式化程序，具有许多格式化选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T16:41:27.870

您可以使用 vi/vim 来缩进 SQL 查询。这就是我一直在格式化它们的方式。然而，缺点是查询需要分成多行才能使缩进有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T13:52:16.533

您可以使用[SQLyog](http://www.webyog.com/en/downloads.php)格式化查询。它具有广泛而动态的查询格式化程序，您可以在其中更改背景、前景色、字体和其他设置。[SQLyog](http://www.webyog.com/en/downloads.php)还加载了非常强大的自动完成功能。

![查询格式化程序屏幕截图](https://i.stack.imgur.com/LcDrB.png)

# .net - 如何在 LINQ to SQL 中删除然后添加子项

> ID：635336
> 
> 赞同：7
> 
> 时间：2009-03-11T16:33:57.433
> 
> 标签：.net, linq-to-sql

我有一系列表的子项目，我不想删除然后添加新的。
我不关心性能，因为它是非频繁操作。

我该怎么做？我试过了`Order.items.clear()`，`Order.Items.Remove(x)`但都给了我例外

简化代码：

```
 Dim db As New MainDataDataContext
    dim o as Order = (From Order In db.Orders Where Order.OrderID = OrderID).FirstOrDefault
    ''//this will return "An attempt was made to remove a 
    ''//relationship between a Order and a OrderItem. 
    ''//However, one of the relationship's foreign keys 
    ''//(Order.OrderID) cannot be set to null." exception
    o.Items.Clear()
    ''//and this will return "EntitySet was modified during enumeration." exception
    For Each oItem As OrderItem In o.Items
        o.items.Remove(oItem)
    Next

    For Each item As ListViewItem In listViewOrderItems.Items
        If item.ItemType = ListViewItemType.DataItem Then
            Dim oItem As New OrderItem
            oItem.OrderID = OrderID
            oItem.Product = CType(item.FindControl("txtProduct"), TextBox).Text
            oItem.Quantity = CType(item.FindControl("txtQuantity"), TextBox).Text
            Order.items.Add(oItem)
        End If
    Next

    db.SubmitChanges() 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-11T16:59:50.353

只要您要删除所有可以使用的项目

```
db.OrderItems.DeleteAllOnSubmit(o.Items); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T16:51:07.737

没关系，我找到了解决方案（但不知道它是否是最好的）

```
For Each oItem As OrderItem In o.Items
    db.OrderItems.DeleteOnSubmit(oItem)
Next 
```

# linux - 如何确定 Linux 中的文件类型？

> ID：635339
> 
> 赞同：4
> 
> 时间：2009-03-11T16:34:29.540
> 
> 标签：linux, perl, unix, file-type

如果有人向我发送了没有扩展名的文档（.pdf、.doc、.xls、ppt、.ogg、mp3、png 等），我如何确定文件类型？/usr/bin/file 命令并不总是猜对，或者它只是说我有一个 Microsoft Office 文档。我想确切地知道，所以我可以将扩展名添加到文件名中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T16:40:03.987

您可以通过将它们添加到 /etc/magic 来制定自己的规则

man 文件以获取更多详细信息。总是让这些正确是很棘手的，但是，我已经取得了合理的成功。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T16:37:32.263

试试 mimetype(1)。

对于 Perl，请查看[File::MimeInfo](http://metacpan.org/pod/File::MimeInfo)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T16:37:58.440

您可以使用 Perl 模块：[File::Type](http://metacpan.org/pod/File::Type)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T16:49:33.560

到目前为止，其他一些海报似乎忽略了一些事情。

[File::MimeInfo](http://p3rl.org/File::MimeInfo)使用与“file”相同的 MimeInfo 数据库来识别文件。所以这不太可能做任何不同的事情。

[File::Type](http://p3rl.org/File::Type)可能很有趣，因为它只依赖于它自己，但这会导致一个充满“if”语句的**滑稽长脚本。**但是，就其本质而言，这不太可能涵盖“文件”已经没有涵盖的内容。

对于未知文件类型，你能做的最好的事情是尝试用十六进制编辑器打开它们，或者通过“字符串”运行它们，看看你是否识别出任何东西。如果您管理如何识别文件，您可能希望选择[File::Type](http://p3rl.org/File::Type) 作为您的解决方案，因为据我所知，它至少易于扩展。

# .net - VB.NET 内联关闭选项严格

> ID：635342
> 
> 赞同：19
> 
> 时间：2009-03-11T16:35:01.613
> 
> 标签：.net, vb.net, option-strict

有没有办法只为一行代码关闭选项严格？

我正在做一些维护工作，我只需要在一个地方“作弊”，我不想降低整个文件的标准。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-11T16:43:59.283

可悲的是，文件中不可能有一行代码。请参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/zcd4xwzs(VS.71).aspx#)。

另一方面，您可以将单行代码设为单独的函数，将其放入具有部分类属性的新文件中，并将 Option Strict Off 放在该文件上。IL 编译器可能无论如何都会内联你的函数，所以它在速度上是等效的，但从实际的角度来看会很难看。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T16:41:35.653

由于它必须出现在模块的声明部分，因此`option strict`不能在代码中间使用。但它可以在每个模块的基础上完成，这可能会有所帮助。

并且在“Visual Basic 2005 in a nutshell”一书中没有提到暗示有另一种打开或关闭它的方法。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-03-11T16:51:04.960

其他几个想法：

*   您可以在大部分情况下关闭它并不时打开它以确保其余代码符合要求
*   您可以对其进行配置，以便 Option Strict 对于发布版本为 ON，但对于调试版本为 OFF。

# visual-studio-2008 - Visual Studio 中的 Prebuild 事件将 $(SolutionDir) 替换为 *Undefined*

> ID：635346
> 
> 赞同：49
> 
> 时间：2009-03-11T16:35:38.383
> 
> 标签：visual-studio-2008, prebuild

我相信问题记录~~[在这里](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=419262)~~ [移到这里](https://developercommunity.visualstudio.com/content/problem/65435/solutiondir-macro-at-build-event-gives-undefined-w.html)，看起来它可能是视觉工作室中的一个错误，但我想知道是否有人知道解决方法。

基本上，在预构建事件中，我有以下两行（除其他外）一个接一个。

```
"C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe" /p:configuration=Release;platform=x86 /t:rebuild "$(SolutionDir)Folder1\Project1.csproj"

"C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe" /p:configuration=Release;platform=x86 /t:rebuild "$(SolutionDir)Folder2\Folder3\Project2.csproj" 
```

第一个成功了，另一个失败了`The command ""C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe" /p:configuration=Release;platform=x86 /t:rebuild "*Undefined*Folder2\Folder3\Project2.csproj"" exited with code 1.`。

**编辑：**
发现问题是与预构建具有相同行的其他项目之一失败，因为 MSBuild 本身不知道宏。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2013-12-17T15:29:42.217

我通过将所有替换`$(SolutionDir)`为`$(ProjectDir)..\`.

这是由于 MSBuild 独立运行每个项目，因此不是解决方案。它在 VS2010 中运行良好，但在构建服务器上却不行。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2020-03-07T14:02:13.800

浪费了很多时间来为这个问题找到完美的解决方案。使用[Directory.Build.props](https://docs.microsoft.com/en-us/visualstudio/msbuild/customize-your-build?view=vs-2019)。

在您的`sln`位置文件夹中创建一个具有名称的文件`Directory.Build.props`并将此代码放入其中：

```
<Project>
 <PropertyGroup>
    <SolutionDir>$(MSBuildThisFileDirectory)</SolutionDir>
 </PropertyGroup>
</Project> 
```

该文件将被您的所有文件自动拾取`csproj`并定义`(SolutionDir)`属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-16T16:55:39.693

Allan 的回答正好在正确的路径上，但是如果您想移动到 的父目录`ProjectDir`，或者`$(ProjectDir)..\`输出将是 a `string`，则需要**在 msbuild 中执行“转到父目录”操作**。
以下是如何实现这一目标：

```
<PropertyGroup>
  <TrimmedDir>$([System.IO.Path]::GetDirectoryName($(ProjectDir)))</TrimmedDir>
</PropertyGroup> 
```

此代码将设置`ProjectDir`to`TrimmedDir`变量的父目录路径。`[System.IO.Path]::GetDirectoryName()`执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-09-09T01:09:38.023

Allan 的回答有正确的想法，但在 VS 2019 16.7.2 中替换所有`$(SolutionDir)`对`$(ProjectDir)..\`我不起作用。

`$(ProjectDir)..\`评估为实际`ProjectDir`附加“..\”，而不是向上一个目录。

相反，我将所有内容替换`$(SolutionDir)`为`$(ProjectDir)\..`并且正确地上升了一个目录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T17:20:40.007

您没有具体说明这种情况是否发生在许多项目或仅一两个项目中。

如果仅在一个或两个项目中，临时解决方法可能是将 $(SolutionDir) 替换为 Folder2 所在的显式路径。例如，类似：

```
"C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe" /p:configuration=Release;platform=x86 /t:rebuild "C:\AllSolutions\ExampleSolutions\Folder2\Folder3\Project2.csproj" 
```

但为您的项目提供正确的路径。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-04T14:19:58.730

如果您仅使用 MSBuild 和 SolutionDir 对某些项目有效，而对其他项目无效，则可能是 SolutionDir 已在工作项目的 .csproj 文件中的某个位置定义。

# unix - ksh：如何探测标准输入？

> ID：635361
> 
> 赞同：4
> 
> 时间：2009-03-11T16:38:14.927
> 
> 标签：unix, shell, stdin, ksh, tty

我希望我的 ksh 脚本具有不同的行为，具体取决于是否有通过 stdin 传入的内容：

```
 (1) cat file.txt | ./script.ksh  (then do "cat <&0 >./tmp.dat" and process tmp.dat)
vs. (2) ./script.ksh (then process $1 which must be a readable regular file) 
```

检查 stdin 以查看它是否是终端 [ -t 0 ] 没有帮助，因为我的脚本是从其他脚本调用的。

如果 stdin 为“空”（第二种情况），则执行“cat <&0 >./tmp.dat”检查 tmp.dat 的大小会挂起等待来自 stdin 的 EOF。

如何检查标准输入是否为“空”？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T19:09:13.067

**编辑：您在 HP-UX 上运行**

在 HP-UX 上测试`[ -t 0 ]`，它似乎对我有用。我使用了以下设置：

`/tmp/x.ksh:`

```
#!/bin/ksh
/tmp/y.ksh 
```

`/tmp/y.ksh:`

```
#!/bin/ksh
test -t 0 && echo "terminal!" 
```

运行`/tmp/x.ksh`打印：`terminal!`

您能否在您的平台上确认上述内容，和/或提供更接近您的情况的替代测试设置？您的脚本最终是由 生成的`cron`吗？

* * *

**编辑 2**

如果绝望，并且如果 Perl 可用，请定义：

```
stdin_ready() {
  TIMEOUT=$1; shift
  perl -e '
    my $rin = "";
    vec($rin,fileno(STDIN),1) = 1;
    select($rout=$rin, undef, undef, '$TIMEOUT') < 1 && exit 1;
  '
}

stdin_ready 1 || 'stdin not ready in 1 second, assuming terminal' 
```

* * *

**编辑 3**

`sort`请注意，如果您的输入来自等，则超时可能需要很大`ssh`（所有这些程序都可以在生成任何数据之前几秒或几分钟使用您的脚本生成并建立管道。）此外，使用大量超时可能会显着当输入中没有任何内容（例如终端）时，惩罚您的脚本。

如果潜在的大超时是一个问题，并且如果您可以影响调用脚本的方式，那么您可能希望强制调用者明确指示您的程序是否应该使用标准输入，通过自定义选项或在标准`GNU`或`tar`方式（例如 script [options [--]] FILE ...，其中 FILE 可以是文件名、`-`表示标准输入的 a 或它们的组合，如果`-`作为范围。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T15:42:35.707

此策略适用于 bash，并且可能适用于 ksh。投票'tty'：

```
#!/bin/bash
set -a

if [ "$( tty )" == 'not a tty' ]
then
    STDIN_DATA_PRESENT=1
else
    STDIN_DATA_PRESENT=0
fi

if [ ${STDIN_DATA_PRESENT} -eq 1 ]
then
    echo "Input was found."
else
    echo "Input was not found."
fi 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T19:27:10.873

为什么不以更传统的方式解决这个问题，并使用命令行参数来指示数据将来自标准输入？

例如，考虑以下之间的区别：

> `echo foo | cat -`

和

> `echo foo > /tmp/test.txt`
> 
> `cat /tmp/test.txt`

# apache - Apache 可写目录权限的最佳实践是什么？

> ID：635363
> 
> 赞同：6
> 
> 时间：2009-03-11T16:38:28.313
> 
> 标签：apache, unix, permissions

有时我想让用户通过 Apache 上传文件。我可以通过两种不同的方式设置权限，以便 Apache 可以将上传的文件写入目录。

1.  我可以让用户 Apache 作为目录的所有者运行，这样它看起来像这样：

    `drwxr-xr-x 2 www admin 68 Sep 24 2007 uploadedfiles`

2.  我可以向“其他人”授予写权限，其中 Apache 是其中之一：

    `drwxr-xrwx 35 egbert admin 1190 Mar 9 13:17 uploadedfiles`

其中一个比另一个更安全吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-13T06:26:43.263

**最严格的访问**`www/admin`，在这种情况下，通过许可独占访问`0750`，**始终是最安全的**。请注意，在上面的权限掩码中，既不是`www`也不是其成员的`admin`用户根本不允许访问目录的内容；这是为了**减少未经授权的一方登录系统访问**用户上传的潜在机密信息的可能性。

不要忘记，在大多数 *nix 平台上，您还有**第三个非常灵活的选项**，即使用[`setfacl`](http://linux.die.net/man/1/setfacl). ACL 是使用常规权限位和所有权方法可以实现的超集。当面临复杂的安全设置（包括每个用户的权限、默认所有权等 - 但您可能需要先添加`acl`到`/etc/fstab`托管目录的卷的挂载选项中，请参阅）时，ACL 是首选选项`man mount`。）您可以选择如果两个或多个用户需要访问相关目录而不是组成员，则使用 ACL `admin`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T16:45:58.420

这里有 2 个问题要问 - 首先，还有谁（如果有人）需要访问这些文件？如果有其他进程作用于这些文件，它们以谁的身份运行，它们将如何与所选解决方案交互？如果没有其他进程或用户访问文件，我会让 apache 用户成为所有者，因为这就是所需要的，并且它遵循最古老的安全原则之一 - 只让*需要*访问的人东西有它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-13T05:59:01.583

安全的一般规则是最小特权。您希望使用尽可能少的权限。在这种情况下，第一个选项（可由 apache 写入）意味着只有当您的系统被 apache 用户入侵时，才能写入该目录，而使用选项二（每个人都可以写入），任何帐户都可以被入侵并写入该目录目录。在这种情况下，我会选择选项一：

drwxr-xr-x 2 www 管理员 68 Sep 24 2007 上传文件

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T12:20:42.690

授予他人读取权限也是一种安全风险。例如，Wordpress 有一个包含数据库用户名和密码的文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T16:51:56.830

如果系统被用于其他目的，您可能应该避免通过“其他人”授予权限。在这里允许权限基本上意味着在该计算机上运行的任何其他内容，或者可以访问该计算机的任何其他内容都将拥有这些文件的权限。

此外，您可以创建一个额外的组，并使 apache 成为组成员，以及管理员中的任何人，并将组所有权更改为该组，并授予该组权限。如果您使用组，您可能还需要在目录上设置“setgid”位。当设置 setgid 位时，创建的任何文件都将获得父目录的相同组成员身份。

# sql - “一对多”建模问题

> ID：635366
> 
> 赞同：4
> 
> 时间：2009-03-11T16:39:51.350
> 
> 标签：sql, database-design, orm, data-modeling

建模以下内容的最佳方法是什么...

假设我有两个对象：`Agency`和`Publisher`，并且两者都与`Employee`. 这是一个真正的 1 对 n 关系，因为每个`Employee`只能为一个`Agency`或一个工作`Publisher`。让我们进一步假设我不能引入具有`Employer`1 对 n 关系的超类型（例如 ）。

我首选的解决方案是有一个外键，`Employee`它可以链接到`Agency`或的主键`Publisher`（我的所有主键都是 64 位 ID，在数据库中是唯一的）。但是，现在我将无法映射双向关联，而无需指明`Employee`这是否是一种`Agency`或`Publisher`关系。

我的另一个选择是使用两个表`AgencyEmployee`和`PublisherEmployee`，然后可以将它们链接为传统的 1 对 n 双向关联。

在这种情况下，您认为最佳做法是什么？

更新：感谢您在如此短的时间内做出如此出色的回应！您如何看待以下解决方案： and 的外键，`Employee`例如and ？ `Agency``Publisher``agency_id``publisher_id`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T16:52:19.857

最佳实践可能是引入一个 Employer 类。

另一方面，将 Employee 分为 AgencyEmployee 和 PublisherEmployee 将是一件坏事™。

如果介绍雇主是不可能的，我会在 Employee 中指明雇主类型（Agency 或 Publisher）。

**回复更新的问题：**

这是一种选择，但雇主类型更好，因为：

1.  您将来可能希望添加其他雇主类型
2.  在Employees 表的每一行中都会有一个空字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T16:43:39.033

听起来这可以建模为[三元关系](http://msdn.microsoft.com/en-us/library/bb399189.aspx)。看看您是否喜欢这篇 MSDN 文章中采用的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T16:53:47.323

我个人的偏好是有一个你明确认为不能使用的表（代理和出版商的超级类型；雇主）

一个简单的替代方法是不强制执行外键约束。这不一定有问题，只要对数据结构的所有修改都是通过您控制的存储过程完成的。

我的最终偏好与您的建议类似，即为 AgencyEmployees 设置一个表，为 PublisherEmployees 设置一个表。但我会把它分开一步......

```
Table1: Agency              (id, name, etc)
Table2: Publisher           (id, name, etc)
Table3: Employee            (id, name, etc)
Table4: AgencyEmployees     (agency_id, employee_id)
Table5: PublisherEmployees  (publisher_id, employee_id) 
```

我这样做的一个原因是让这个时间依赖变得微不足道。员工开始、离开和在公司之间移动。以下对上述内容的轻微修改将允许您跟踪...

```
Table1: Agency              (id, name, etc)
Table2: Publisher           (id, name, etc)
Table3: Employee            (id, name, etc)
Table4: AgencyEmployees     (agency_id,    employee_id, start_date, leave_date)
Table5: PublisherEmployees  (publisher_id, employee_id, start_date, leave_date) 
```

这不会在任何时候对每位员工强制执行 1 个雇主，但可以通过您的存储过程、GUI 等强制执行...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T16:53:49.290

我使用了这种方法：

Employee.EmployerType（'AGENCY' 或 'PUBLISHER'）

Employee.EmployerID（AgencyID 或 PublisherID）

它工作正常，但是您需要在很多 SQL 中使用 case 语句。如果您使用的是 ORM，那么您也会失去 FK 关系。

我正在将我的大部分代码移动到 n:m 关系，以便我可以利用我们的 ORMs FK 支持。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T17:04:17.300

显然，雇主实体将是首选，但除此之外......

拥有 AgencyEmployee 和 PublisherEmployee 表意味着很难确定员工是否属于一个类别。

因此，我会将 EmployerType 列添加到Employees 表中；它为您的后续 SQL 查询增加了一点额外的复杂性，但它在您给定的约束范围内工作。

出于兴趣，您为什么可以添加 AgencyEmployee 和 PublisherEmployee 表，但不能添加 Employer 表？只是好奇...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T17:17:37.783

Can Berk Güder 获得 +1。

从技术上讲，引入 Employer 超类型意味着您引入具有 Agency 和 Publisher 共有的所有属性的 Employer 关系，具有 Employer 键和所有 Agency 特定属性的 AgencySpecific（不知道如何调用它）关系以及作为外来的 Employer 键键，然后是 Agency 作为查询或视图，它只将 AgencySpecific 与 Employer 连接起来，对于 Publisher 也是如此。

将 Agency 和 Publisher 数据分布在您每次都必须加入的两个表中可能有点麻烦，但另一种方法是编写与员工相关的大部分查询两次，一次使用 Agency，一次使用 Publisher，然后手工编写他们的工会将结果结合起来。（我还没有看到一个查询构建器可以帮助处理像这样的基本内容。）我不得不为一个使用“无超类型”方法的项目做这件事，我不想再做一次。

如果你问我，顺便说一句，三元关系甚至 n 对 n 关系都不是好的设计实践。仅使用函数（即 1 对 n 和 1 对 1）例如约束变得更容易制定。

# c# - How to set checked value for a radio input tag using ASP.Net?

> ID：635375
> 
> 赞同：5
> 
> 时间：2009-03-11T16:42:52.983
> 
> 标签：c#, asp.net, javascript, html

I have this radio tag:

```
<input name="phoneRadio" class="phoneRadio" id="rbDefaultPhone" 
    type="radio" checked="<%# GetIsChecked(Eval("IsDefault")) %>"/> 
```

in a repeater and GetIsChecked is a c# function which return bool value, my problem that its not affecting the checked value of the radio button the right way, Any one know how to fix that?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-11T16:47:23.893

Just having the `checked` attribute on the `input` is enough to make it checked. In HTML, you just need to have `checked` in there, in XHTML, it should be `checked="checked"`, but either way, you'll want to exclude the whole attribute if it isn't checked.

That is, `GetIsChecked` should (be renamed and) return either `"checked='checked'"` or `String.Empty`. You will then call it just in the input tag itself, not as the value for the `checked` attribute (which you should remove). It'll look something like this:

```
<input name="phoneRadio" class="phoneRadio" id="rbDefaultPhone" type="radio" <%# GetChecked(Eval("IsDefault"))%> /> 
```

```
protected string GetChecked(object isDefault)
{
    return (bool)isDefault ? "checked='checked'" : string.Empty;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-23T09:05:59.400

**Bdukes**'s answer is correct. Before coming to this post, I spent lot of time in trying to figure out how to return `checked=checked` but

```
checked
checked=""
checked="checked" 
```

are equivalent.

Considering 'IsDefault' returns bool,works well in all modern browsers.

```
<input name="phoneRadio" class="phoneRadio" id="rbDefaultPhone"  type="radio" 
 checked='<%#Eval("IsDefault")%>' 
```

Check [this](https://stackoverflow.com/a/7852002/443244) for more explanation.

# linux - 无法删除文件夹中除 FileA 之外的所有其他内容

> ID：635378
> 
> 赞同：0
> 
> 时间：2009-03-11T16:43:40.157
> 
> 标签：linux

如何删除文件夹中除 FileA 之外的所有其他内容，甚至隐藏文件？我使用 Ubuntu。

我尝试了以下失败

```
rm [^fileA] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T16:54:15.670

```
find . -not -name fileA -exec rm {} \; 
```

请注意，这只会删除文件，而不是文件夹。相信我，你不想删除这样的文件夹。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T17:23:04.930

使用`extglob`. 假设这`FileA`是一个常规文件（即不以 a 开头`.`），那么您可以执行以下操作：

```
shopt -s extglob  # Enable extglob
rm !(FileA) .*  # Remove all regular files not named FileA and all hidden files 
```

如果取而代之`FileA`的是一个隐藏文件，这将不起作用，因为`!(`*pattern*`)`构造只会创建一个所有不匹配*pattern*的常规文件的列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T16:58:18.577

你也可以交互式地做，

```
rm -i * .* 
```

* 用于所有文件（隐藏文件除外）。.* 适用于所有隐藏文件

```
gene@vmware:/tmp/test$ ls -al
total 8
drwxr-xr-x  2 gene    gene    4096 2009-03-11 12:51 .
drwxrwxrwt 12 root    root    4096 2009-03-11 12:51 ..
-rw-r--r--  1 gene    gene       0 2009-03-11 12:51 fileA
-rw-r--r--  1 gene    gene       0 2009-03-11 12:51 .fileB
gene@vmware:/tmp/test$ rm -i * .*
rm: remove regular empty file `fileA'? n
rm: cannot remove directory `.'
rm: cannot remove directory `..'
rm: remove regular empty file `.fileB'? y
gene@vmware:/tmp/test$ ls -al
total 8
drwxr-xr-x  2 gene    gene    4096 2009-03-11 12:51 .
drwxrwxrwt 12 root    root    4096 2009-03-11 12:51 ..
-rw-r--r--  1 gene    gene       0 2009-03-11 12:51 fileA 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T17:16:38.627

对于多个文件，以下将删除除名称中包含 FileA 或 FileB 的文件之外的所有文件。

```
for file in *
do
  if [ x`echo $file | grep -ve "\(FileA\|FileB\)"` == x ]; then
    rm $file
  fi
done 
```

它在长长的文件列表中更有用。如果只是一个简短的列表，我会选择 CoverosGene 的回应。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T17:20:59.333

大多数基于解析目录列表的方法都可能容易出错。

如果您对父目录具有写入权限，并且您需要的文件位于子目录中`foo`，那么如何：

```
% mkdir bar
% mv foo/fileA bar
% rm -rf foo
% mv bar foo 
```

即先把你的基本文件拿开！

# asp.net - 在 Gridviews 之间移动选定的行

> ID：635380
> 
> 赞同：0
> 
> 时间：2009-03-11T16:44:18.580
> 
> 标签：asp.net, gridview, move, selected

我目前有 Gridview1，它从数据库中获取数据并显示人员列表。我还有一个 Gridview2，它最初是空白的。我想添加从 gridview1 向 gridview2 添加/删除行的功能。我在 gridview1 中添加了一个复选框列，以允许用户选择他们想要移动的记录。我还添加了两个按钮 >> 和 <<。有没有人有我如何从 Gridview1 添加/删除选定记录到 Gridview2 的示例？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T16:49:51.827

```
 Gridview2.rows.add(Gridview1.rows[INDEXTOMOVE]); 
```

# regex - 正则表达式来砍掉可选的尾巴

> ID：635383
> 
> 赞同：0
> 
> 时间：2009-03-11T16:45:11.387
> 
> 标签：regex

什么正则表达式可以将以下任何行作为输入

```
rtsp://server/blabla/bla RTSP/1.0
rtsp://server/blabla/bla/
rtsp://server/blabla/bla
rtsp://server/blabla/bla/streamid=65335 RTSP/1.0 
```

并且总是返回：

```
rtsp://server/blabla/bla 
```

一般来说，我有一个任意的 URL，它总是`"rtsp://"`以`EOL`、或.`"/"``" RTSP/1.0"``"/streamid=65335 RTSP/1.0"`

我只需要获取 URL，即没有可选的尾随部分。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T16:51:18.767

这应该捕获服务器名称。

```
/rtsp:\/\/([^\/]+)/ 
```

从新要求（这删除尾随）：

```
linux ~ $ echo "rtsp://server/blabla/bla RTSP/1.0
rtsp://server/blabla/bla/
rtsp://server/blabla/bla
rtsp://server/blabla/bla/streamid=65335 RTSP/1.0
" | perl -pe 's/( RTSP\/1.0|\/|\/streamid=65335 RTSP\/1\.0)$//g'
rtsp://server/blabla/bla
rtsp://server/blabla/bla
rtsp://server/blabla/bla
rtsp://server/blabla/bla 
```

这个捕获网址：

```
echo "rtsp://server/blabla/bla RTSP/1.0
rtsp://server/blabla/bla/
rtsp://server/blabla/bla
rtsp://server/blabla/bla/streamid=65335 RTSP/1.0
" | perl -pe 's/(.+?)(?: RTSP\/1.0|\/|\/streamid=65335 RTSP\/1\.0)$/\1/'
rtsp://server/blabla/bla
rtsp://server/blabla/bla
rtsp://server/blabla/bla
rtsp://server/blabla/bla 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T16:51:12.353

好吧，这将完全满足您的要求：

```
$pattern = '/rtsp:\/\/server\/.*/'
$replace = 'server/9C8CE56C490F2C87';

preg_replace($pattern, $replace, 'rtsp://server/blabla/bla RTSP/1.0'); 
```

如果你想在空间之前得到所有东西，这将起作用：

```
$pattern = '/([^ ]+).*/'

preg_replace($pattern, '$1', 'rtsp://server/blabla/bla RTSP/1.0'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T17:15:40.580

你可以匹配：

```
(.*?)(\/streamid\=65335)?(\/)?( RTSP\/1.0)?(\n)?$ 
```

并且只阅读第一组。

根据您使用的语言，使用字符串处理可能更清楚。例如在 Python 中：

```
for suffix in ('\n', ' RTSP/1.0', '/streamid=65335', '/'):
    if url.endswith(suffix):
        url= url[:-len(suffix)] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T17:16:38.610

根据您的新标准，我认为您不需要正则表达式。

编辑：删除 Perl 解决方案，因为您使用的是 C。使用 C，请执行以下操作：

```
str[20] = 0; // string is now NUL-terminated to 20 characters
if(!strcmp(str, "rtsp://server/blabla/bla"))
  {
    // do stuff if it matches
  }
else
  {
    // do stuff if it doesn't match
  } 
```

或者，如果您想保留原始字符串：

```
if(!strncmp(str, "rtsp://server/blabla/bla", 20)) // only compare 20 chars
  {
    // do stuff if it matches
  }
else
  {
    // do stuff if it doesn't match
  } 
```

你可能想做`strncmp()`解决方案。这样，您可以在查询到查询的基础上改变长度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T16:51:14.880

您是否正在寻找这样的东西：

```
^rtsp://([^/]+) 
```

然后将其替换为“<code>$1/9C8CE56C490F2C87”？

# c - 给 C、CUDA 和 ANN 新手的建议？

> ID：635409
> 
> 赞同：4
> 
> 时间：2009-03-11T16:51:36.270
> 
> 标签：c, cuda, neural-network, gpgpu

我是商科专业的，我的学位课程已经完成了三分之二，有一点 PHP 经验，上过一门 C++ 入门课程，现在后悔选择了商科而不是编程/计算机科学。

我有兴趣学习更高级的编程；特别是 C，并最终使用 CUDA 架构进行人工神经网络数据分析（不是用于人工智能、视觉或语音处理，而是用于查找大型数据集中数据点之间的相关性和一般数据/统计分析）。

关于我应该如何开始学习 C 的任何建议？以及用于分析数据的 ANN/贝叶斯技术？书太多了，不知道选什么。

由于 CUDA 相当新，因此似乎没有太多对学习者友好（即简化）的材料。除了 NVIDIA 文档之外，是否还有针对 CUDA 的学习资源？

此外，您会向我推荐哪些有关 GPGPU 计算和大规模并行编程的资源来帮助我？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T17:30:17.970

我不建议先尝试学习 CUDA，因为它是一项新技术，而且您没有太多编程背景。

由于您在 C（或 C++）方面没有太多经验，CUDA 学习起来会很痛苦，因为它缺乏成熟度、库、漂亮的错误消息等。

CUDA 适用于熟悉 C 的人（C++ 经验也有帮助）并且有需要通过重新编码或重新思考众所周知的问题的解决方案来提高性能的问题。

如果您正在尝试解决“ANN/贝叶斯”问题，我建议您使用 C++ 或 C 创建您的解决方案，您可以选择。不要为创建线程或多线程而烦恼。然后，在评估串行解决方案的响应时间后，尝试使用 OpenMP、Boost 线程、w/e 使其并行。在此之后，如果您仍然需要更高的性能，那么我建议您学习 CUDA。

我认为这些都是有效的，因为 CUDA 有一些非常神秘的错误，难以调试，完全不同的架构等。

如果您仍然感兴趣，这些是学习 CUDA 的一些链接：

在线课程：

*   [GPGP](http://gamma.cs.unc.edu/GPGP/schedule.html)
*   [独联体 665](http://www.seas.upenn.edu/~cis665/)
*   [Richard Edgar 的 GPU 计算页面](http://www.pas.rochester.edu/~rge21/computing/gpucomputing/)

论坛（最佳信息来源）：

*   [英伟达 CUDA 论坛](http://forums.nvidia.com/index.php?showforum=62)

工具：

*   [CUDPP](http://www.gpgpu.org/developer/cudpp/)

CUDA 中解决的问题：

*   [显卡](http://www.caam.rice.edu/~timwar/RMMC/gpuDG.html)
*   [直方图计算](http://users.rsise.anu.edu.au/~ramtin/cuda.htm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T22:50:35.353

您已经表达了 3 个不同的目标：

*   学习用 C 编程
*   学习为 CUDA 平台编写代码
*   学习使用贝叶斯网络和/或神经网络进行数据分析

首先：对于已经在该领域拥有多个学位的人来说，这些事情并不容易。如果你只做一个，一定要了解贝叶斯推理。它是迄今为止最强大的数据推理框架，您需要了解它。查看 MacKay 的书（在底部提到）。你当然给自己设定了一项具有挑战性的任务——祝你一切顺利！

你的目标都是完全不同的鱼壶。学习用 C 编程并不难。如果可能的话，我会在你的大学学习“算法和数据结构简介”（通常是 CS 专业的第一门课程）（它可能是用 Java 教授的）。这对您将非常有用，C 中的基本编码将只是学习语法的问题。

学习为 CUDA 平台编写代码更具挑战性。如上所述，请先检查 OpenMPI。一般来说，阅读有关计算机体系结构的东西（Patterson & Hennessy 很好）以及一本关于并行算法的书，你会得到很好的服务。如果您从未见过并发（即，如果您还没有听说过信号量），那么查找它会很有用（操作系统课程的讲义可能会涵盖它 - 请参阅 MIT Open Courseware）。最后，如前所述，GPU 编程很少有好的参考资料，因为它是一个新领域。所以你最好的选择是阅读示例源代码来了解它是如何完成的。

最后，贝叶斯网络和神经网络。首先，请注意这些是完全不同的。贝叶斯网络是一种图形（节点和边）方式，表示在（通常很大）数量的变量上的联合概率分布。“神经网络”这个术语有些模糊，但一般是指使用简单的处理元素来学习用于对数据点进行分类的非线性函数。David JC MacKay 的《信息论、推理和学习算法》是一本很好地介绍了贝叶斯网络和神经网络的书。该书可在[http://www.inference.phy.cam.ac.uk/mackay/itila/](http://www.inference.phy.cam.ac.uk/mackay/itila/)在线免费获得。这本书是迄今为止我最喜欢的主题。阐述非常清楚，练习很有启发性（大多数都有解决方案）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T17:12:47.013

如果您正在寻找对并行编程的友好介绍，请考虑使用 CPU 集群上的[Open MPI](http://www.open-mpi.org/)或 Posix Threading。您只需一个多核处理器即可开始使用。

普遍的共识是，在这些新架构（gpu、cell 等）上的多编程在其编程模型和 api 的成熟度方面还有一段路要走。相反，Open MPI 和 PThreads 已经存在了很长一段时间，并且有很多资源可供学习它们。一旦您对这些感到满意，然后考虑尝试更新的技术。

虽然肯定有许多其他语言的编程接口，但 C 可能是高性能计算中使用的最常见的现代语言（Fortran 和 Pascal 仍在这一领域活跃）。C++ 也相当流行，一些生物信息学包使用它。无论如何，C 肯定是一个很好的起点，如果你想要更多的语言特性或库，你可以升级到 C++（尽管可能会以性能为代价）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T18:09:12.573

如果您对数据挖掘感兴趣，您可能还想查看名为 Orange 的开源系统。它是用 C++ 实现的，但它也支持 Python 或可视链接和节点语言的最终用户编程。

我不知道它是否支持神经网络，但我知道人们用它来学习数据挖掘技术。它支持诸如集群和关联规则之类的东西。

（另外，如果你不知道，你可能想在你的商学院找到一个做运营管理的人。如果你对计算机科学和数据挖掘感兴趣，你可能会在那里找到志同道合的人。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T18:12:08.400

链接：[gpgpu.org](http://gpgpu.org/)有一些有趣的讨论

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-29T06:43:28.310

最新的 CUDA 版本（3.1、3.2）具有一套完整的功能，称为 CuBLAS，可以在单卡设置上为您处理多核矩阵运算。并行反向传播将是一个更大的挑战，但我正在努力。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-23T03:00:13.513

我能够在 iTunesU 上找到一些来自斯坦福的免费视频课程

编程方法论 (CS106A) 编程抽象 (CS106B) 编程范式 (CS107) 机器学习 (CS229) 使用 CUDA 编程大规模并行处理器

这些课程中的每一门都有大约 20 节左右的讲座，因此观看它们是一项投资，但非常值得。

# python - python的代码文档

> ID：635419
> 
> 赞同：21
> 
> 时间：2009-03-11T16:54:41.067
> 
> 标签：python, documentation, documentation-generation

用于记录 python 源代码的约定和工具有什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-11T16:56:58.783

约定：[PEP 257](http://www.python.org/dev/peps/pep-0257/)和[PEP 8](http://www.python.org/dev/peps/pep-0008/)。请注意，文档字符串可以用[reStructuredText编写](http://docutils.sourceforge.net/rst.html)

生成文档的工具：例如[Sphinx](http://sphinx.pocoo.org/)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-11T17:08:39.193

首先，使用 RestructuredText 格式在您的文档字符串中添加注释。

其次，得到[狮身人面像](http://sphinx.pocoo.org/)。

第三，创建一个使用[autodoc 扩展](http://sphinx.pocoo.org/ext/autodoc.html)的索引。

然后，运行 Sphinx 以获得非常好的文档。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-11T17:06:07.780

[Epydoc](http://epydoc.sourceforge.net/)也是记录源代码的好工具，可以将类、模块、变量等交叉引用到 HTML、PDF、LaTeX 中。也画了一些漂亮的类继承图。它被许多开源项目所使用，因此它得到了相当积极的开发。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-11T17:00:23.360

将代码文档放在代码本身中非常好。看：

*   [PEP 257 -- 文档字符串约定](http://www.python.org/dev/peps/pep-0257/)
*   [PEP 8——Python 代码风格指南](http://www.python.org/dev/peps/pep-0008/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-07T10:20:16.920

使用带有 doxygen 的 doxypy 过滤器也是一件好事

# iphone - 在 iPhone 上切换接近传感器会丢失一个事件

> ID：635421
> 
> 赞同：4
> 
> 时间：2009-03-11T16:54:43.813
> 
> 标签：iphone, api, sensors, proximity

我正在使用 setProximitySensingEnabled 并在我的 UIApplication 子类中实现了proximityStateChanged。看起来如果感应被切换，则第一个“关闭”事件正在丢失。

我的 UIApplication 类非常基本......

```
 -(void)proximityStateChanged:(BOOL)state { NSLog(state ? @"ON" : @"OFF"); } 
```

在我的应用程序委托中，我有一个 UISwitch 可以启用/禁用接近传感器。

```
-(IBAction)toggleProxy:(id)sender { [UIApplication sharedApplication].proximitySensingEnabled = prox.on; } 
```

“代理”是我的 UISwitch。测试在第一次开始时运行良好。我点击开关将其打开，然后将手放在传感器上一秒钟，然后将其移开并得到：

```
2009-03-11 12:43:00.465 Proximity[324:20b] ON
2009-03-11 12:43:02.514 Proximity[324:20b] OFF
2009-03-11 12:43:04.046 Proximity[324:20b] ON
2009-03-11 12:43:05.621 Proximity[324:20b] OFF 
```

然后我点击开关将其关闭，然后再次点击将其打开。现在我得到：

```
2009-03-11 12:43:12.005 Proximity[324:20b] ON
2009-03-11 12:43:14.789 Proximity[324:20b] ON
2009-03-11 12:43:16.467 Proximity[324:20b] OFF
2009-03-11 12:43:17.516 Proximity[324:20b] ON
2009-03-11 12:43:19.077 Proximity[324:20b] OFF 
```

请注意，我在 OFF 之前有两个 ON。OFF 在某处丢失。我无法使用谷歌的移动应用程序复制这种行为，所以我想知道他们是否在接近启用之间重置了一些东西。他们没有一直打开接近传感器，因为如果你盖住传感器，屏幕就不会变黑。您必须将手机向上倾斜并向后倾斜（以模拟它在您耳边的位置），然后覆盖传感器工作。

还有人在玩传感器吗？

在我的特定应用程序中，我正在录制语音消息，当您将手机从耳边移开时，我想暂停录制（当我关闭时）。第一次将手机从耳边移开时，录音没有暂停。但是，如果我把它放在耳边并再次将它移开，它*就会*暂停。

# asp.net - 从数据库中获取 NULL 值并分配给 Date 变量

> ID：635422
> 
> 赞同：3
> 
> 时间：2009-03-11T16:55:04.013
> 
> 标签：asp.net, vb.net, date

存储过程返回有关用户记录的数据，包括他们上次登录日期的可为空的日期时间列。在尝试分配 .Net 日期变量时，在处理 NULL 值的可能性时，哪一个是更好的选择？

```
 Try
        _LastLogin = CDate(DT.Rows(0)("LastLogin"))
    Catch ex As InvalidCastException
        _LastLogin = Nothing
    End Try 
```

或者

```
 If DT.Rows(0)("LastLogin") Is DBNull.Value Then
        _LastLogin = Nothing
    Else
        _LastLogin = CDate(DT.Rows(0)("LastLogin"))
    End If 
```

**编辑**：我也忘记了使用 TryParse 的可能性

```
 If Not Date.TryParse(DT.Rows(0)("LastLogin").ToString, _LastLogin) Then
        _LastLogin = Nothing
    End If 
```

哪种是处理`NULL`数据库中可能值的首选方法？有没有比上面列出的三个更好的方法？

**编辑#2**：我注意到该`TryParse`方法在尝试分配`Nullable`类型时效果不佳。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T16:58:20.900

第二个代码片段更好。例外是针对例外情况，而不是您期望发生的情况。另外，意图要好得多。很明显，您期望 DBNull 是一个可能的值，并且您希望相应地处理它。

此外，如果值不为 null 但不可解析（尽管这很可能永远不会发生），您可能会产生意想不到的后果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T16:59:55.687

第二种方法更可取，因为引发异常会涉及成本（特别是如果您希望 LastLogin 字段定期为 NULL）。

这是一篇很好的[博客文章](http://blogs.msdn.com/kcwalina/archive/2005/03/16/396787.aspx)，其中包含有关异常的更多详细信息（请参阅有关异常和性能的部分）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T18:36:20.853

我使用 FixDBNull 类：

```
Public Class FixDBNull(Of ItemType)    
    Public Shared Function Convert(ByVal data As Object) As ItemType
        If data IsNot System.DBNull.Value Then
            Dim obj As ItemType = Nothing

            Try
               obj = CType(data, ItemType)    
            Catch ex As Exception
                'do something with the conversion error
            End Try

            Return obj
        Else
            Return Nothing
        End If

End Function
End Class 
```

那么我可以这样称呼它：

```
_LastLogin = FixDBNull(Of date).Convert( DT.Rows(0)("LastLogin")) 
```

这将返回任何内容或日期。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T17:08:13.310

在 VB.net 中，它必须是 Nullable(of Date)

这是一种方法：

```
dim theDate as nullable(of Date)

    If theDate.HasValue Then
      'you can proceed
    Else
      'you must assign with DBNull.value
    End If 
```

数据库也可能会影响您可以做什么。无论如何，MS Access 都会对日期发牢骚。我最终得到了上述工作，但我通常更喜欢将日期保存为 Access 中的字符串。它只是减少了路上的麻烦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T17:10:31.963

我会使用[`TryCast`](http://msdn.microsoft.com/en-us/library/zyy863x8.aspx)，它看起来像这样：

```
_LastLogin = TryCast(DT.Rows(0)("LastLogin"), Date?) 
```

# content-type - 为什么我的内容类型显示为 image/2 应该是 image/jpeg

> ID：635429
> 
> 赞同：1
> 
> 时间：2009-03-11T16:57:23.947
> 
> 标签：content-type

[http://www.thomasnet.com/articles/hardware/fastener-threads](http://www.thomasnet.com/articles/hardware/fastener-threads)

在网络面板中查看带有 firebug 的请求时，此图像显示 image/2 任何想法为什么会在服务器端以这种方式设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T17:16:53.510

这是从“articles/image/”文件夹中读取的唯一图像（其余图像来自 /images/images/' 文件夹）

它也是页面上唯一具有内容类型的图像。

它也是唯一没有缓存的图像。

我的猜测是您的 Web 服务器设置为根据目录发送某些标头值。

# java - 在 Java 中使用 .NET Web 服务的最佳方式

> ID：635434
> 
> 赞同：4
> 
> 时间：2009-03-11T16:58:41.557
> 
> 标签：java, .net, web-services, jax-ws, interop

我正在尝试使用 JAX-WS 使用一些 .NET Web 服务。我已经使用 wsimport 工具生成了 Java 类。但是，当我尝试在 Java 中使用这些（专有的，非公共的）Web 服务时，我注意到供应商在其 C# 示例中提供的大多数方法和属性在生成的类中不可用（尽管没有遇到任何错误从 WSDL 文件生成 Java 类时）。连接到 Web 服务也基本上可以工作。

当我尝试使用 .NET SDK 中的 wsdl.exe 生成 C# 类时，所有方法都已正确生成。

使用 .NET Web 服务以便在 Java 中提供全部功能的最佳方式是什么？为什么 wsimport 只生成 WSDL 文件中描述的所有方法和属性的一小部分？

示例：在 WSDL 文件 UserManagement.wsdl 中有一个片段

```
 <s:schema elementFormDefault="qualified" targetNamespace="[http://www.initechsystems.com/initech7/initechws/](http://www.initechsystems.com/initech7/initechws/)">
  <s:element name="UserSecurityContext" type="s2:UserSecurityContext"/>
  <s:complexType name="UserSecurityContext">
    <s:sequence>
      <s:element minOccurs="0" maxOccurs="1" name="Token" type="s2:UserToken"/>
    </s:sequence>
  </s:complexType>
  <s:complexType name="UserToken">
    <s:sequence>
      <s:element minOccurs="0" maxOccurs="1" name="Value" type="s:string"/>
    </s:sequence>
  </s:complexType>
</s:schema> 
```

在 C# 中，我可以访问 UserSecurityContext 如下：

```
 UserManagement userMgmt = new UserManagement();
userMgmt.UserSecurityContextValue = new SampleWS.UserRef.UserSecurityContext(); 
```

但是，在 Java 中，我可以创建 UserManagement 对象

```
 UserManagement userMgmt = new UserManagement(); 
```

但是生成的 UserManagement 对象没有任何可访问的对象 SecurityContext，也没有此类私有对象的 getter 或 setter。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T23:42:13.287

这些链接可能对您有用：

*   [http://java.sun.com/webservices/docs/2.0/tutorial/doc/JAXWS4.html](http://java.sun.com/webservices/docs/2.0/tutorial/doc/JAXWS4.html)
*   [http://java.sun.com/webservices/docs/2.0/tutorial/doc/JAXBWorks4.html#wp82947](http://java.sun.com/webservices/docs/2.0/tutorial/doc/JAXBWorks4.html#wp82947)
*   [http://www.google.com/search?hl=en&q=data+type+supported+in+jax-ws&aq=f&oq=](http://www.google.com/search?hl=en&q=data+type+supported+in+jax-ws&aq=f&oq=)

还。[另一个问题](https://stackoverflow.com/questions/590514/netbeans-and-net-web-services)的答案可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T17:04:31.433

我想看看您正在谈论的示例，因为听起来该示例通过网络发送具有行为的对象，而不仅仅是模型（或消息，如果您更喜欢更好的 SOA 术语）。

当您发送格式化为数据模型或消息的对象时，它不会包含要使用的方法。而且，对于互操作，设置行为（方法）以跨越网络并没有多大意义。

至于你能做什么，因为你正在序列化，你可以创建行为方法，如果它们对你有意义的话。就个人而言，我会在其他对象中创建行为，并将模型/消息作为状态容器。但是，您的里程可能会有所不同。;-)

# svn - SVN：有没有办法将文件标记为“不提交”？

> ID：635446
> 
> 赞同：159
> 
> 时间：2009-03-11T17:00:28.323
> 
> 标签：svn, command-line

使用 TortoiseSVN，我可以将文件移动到提交时忽略更改列表中，这样当我提交整个树时，对该文件的更改不会被提交。

有没有办法使用 svn 命令行工具来做类似的事情？

编辑：感谢使用的建议`svn:ignore`，但这并不完全符合我的要求。

`svn:ignore``svn add`影响&之类的东西`svn import`。它为它提供了一个要忽略的文件名模式列表。

我有一个已经在源代码管理下的文件，但是我想对该文件进行临时更改，我不想在以后提交整个源代码树时提交这些更改。我正在做很多其他的更改，我可以在我的显示器上贴一个注释，告诉我在提交树之前恢复该文件，但如果 svn 可以自动跳过该文件，那就太好了。

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-03-11T18:31:51.050

## Subversion 没有内置的“不提交”/“提交时忽略”功能，截至 2016 年 2 月/版本 1.9。这个答案是一个不理想的命令行解决方法

正如 OP 所述，TortoiseSVN 有一个内置的更改列表“ignore-on-commit”，它会自动从提交中排除。**命令行客户端没有此功能，因此您需要使用多个更改列表来完成相同的行为（带有警告）**：

*   一份你想投入的工作[工作]
*   一个用于您想要忽略的事情 [ignore-on-commit]

由于 TortoiseSVN 有先例，因此我在示例中对我不想提交的文件使用“ignore-on-commit”。我将对我所做的文件使用“工作”，但您可以选择任何您想要的名称。

首先，将所有文件添加到名为“work”的更改列表中。这必须从工作副本的根目录运行：

```
svn cl work . -R 
```

这将递归地将工作副本中的所有文件添加到名为“work”的更改列表中。这样做有一个缺点 - 当新文件添加到工作副本中时，您需要专门添加新文件，否则它们将不会被包含在内。其次，如果您必须再次运行此程序，则需要再次重新添加所有“ignore-on-commit”文件。不理想 - 您可以像其他人一样开始在文件中维护自己的“忽略”列表。

然后，对于要排除的文件：

```
svn cl ignore-on-commit path\to\file-to-ignore 
```

因为文件只能在一个更改列表中，所以在您之前的“工作”添加之后运行此添加将从“工作”更改列表中删除您想要忽略的文件并将其放入“忽略提交”更改列表中。

当您准备好提交您确实希望提交的修改文件时，您只需将“--cl work”添加到您的提交中：

```
svn commit --cl work -m "message" 
```

这是我机器上的一个简单示例：

```
D:\workspace\trunk>svn cl work . -R
Skipped '.'
Skipped 'src'
Skipped 'src\conf'
A [work] src\conf\db.properties
Skipped 'src\java'
Skipped 'src\java\com'
Skipped 'src\java\com\corp'
Skipped 'src\java\com\corp\sample'
A [work] src\java\com\corp\sample\Main.java
Skipped 'src\java\com\corp\sample\controller'
A [work] src\java\com\corp\sample\controller\Controller.java
Skipped 'src\java\com\corp\sample\model'
A [work] src\java\com\corp\sample\model\Model.java
Skipped 'src\java\com\corp\sample\view'
A [work] src\java\com\corp\sample\view\View.java
Skipped 'src\resource'
A [work] src\resource\icon.ico
Skipped 'src\test'

D:\workspace\trunk>svn cl ignore-on-commit src\conf\db.properties
D [work] src\conf\db.properties
A [ignore-on-commit] src\conf\db.properties

D:\workspace\trunk>svn status

--- Changelist 'work':
        src\java\com\corp\sample\Main.java
        src\java\com\corp\sample\controller\Controller.java
        src\java\com\corp\sample\model\Model.java
M       src\java\com\corp\sample\view\View.java
        src\resource\icon.ico

--- Changelist 'ignore-on-commit':
M       src\conf\db.properties

D:\workspace\trunk>svn commit --cl work -m "fixed refresh issue"
Sending        src\java\com\corp\sample\view\View.java
Transmitting file data .done
Committing transaction...
Committed revision 9. 
```

另一种方法是简单地将您希望提交的每个文件添加到“工作”更改列表中，甚至不维护忽略列表，但这也是很多工作。真的，唯一简单、理想的解决方案是如果/何时在 SVN 本身中实现。Subversion 问题跟踪器[SVN-2858](https://issues.apache.org/jira/browse/SVN-2858)中存在一个长期存在的问题，以防将来发生变化。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-09-17T00:44:39.417

我也一直发现自己处于这种情况：并且更改列表对我不起作用-我想列出我不想提交的文件的简短列表**，而不是维护我****确实**想要的大量文件列表承诺！

我在linux命令行上工作：所以我的解决方案是创建一个脚本/usr/bin/svnn（是的，有两个'n's！），如下所示：

```
#! /bin/bash
DIR=/home/mike/dev/trunk

IGNORE_FILES="\
        foo/pom.xml \
        foo/src/gwt/App.gwt.xml \
        foo/src/main/java/gwt/Common.gwt.xml \
        foo/src/main/resources/context/datasource/local.xml \
        foo/src/main/resources/context/environment/local.xml"

for i in $IGNORE_FILES; do mv $DIR/$i $DIR/"$i"_; done;

svn "$@"

for i in $IGNORE_FILES; do mv $DIR/"$i"_ $DIR/$i; done; 
```

显然，这是根据我的情况量身定制的 - 但只需更改 DIR 和 IGNORE_FILES 以适合您的开发设置。请记住将脚本更改为可执行文件：

```
sudo chmod +x /usr/bin/svnn 
```

..那么您只需使用“svnn”而不是“svn”来运行颠覆，而不必担心检查 IGNORE_FILES 列表中文件的本地更改。我希望这有帮助！

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-11T17:45:24.080

我不相信有一种方法可以忽略存储库中的文件。我们经常在使用 web.config 和其他配置文件时遇到这种情况。

虽然并不完美，但我最常看到和使用的解决方案是使用 .default 文件和一个 nant 任务来创建本地副本。

例如，在 repo 中有一个名为的文件`web.config.default`，它具有默认值。然后创建一个 nant 任务，将所有`web.config.default`文件重命名为`web.config`然后可以自定义为本地值。当检索到新的工作副本或运行构建时，应调用此任务。

您还需要忽略`web.config`创建的文件，以便它不会提交到存储库。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-11T18:08:13.137

查看[changelists](http://svnbook.red-bean.com/en/1.5/svn.advanced.changelists.html)，它可以为您提供一个选项来过滤掉您已更改但不想提交的文件。SVN 不会自动跳过一个文件，除非你告诉它——你告诉它这个文件与其他文件有某种不同的方式是将它放在一个更改列表中。

它确实需要您做更多的工作，并且您只能将更改列表应用到您的工作副本（显然，想象一下如果您可以将“从不更新”属性应用到修订版可能会出现混乱！）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-11-23T15:10:42.560

我来到这个线程寻找一种方法来对一些文件进行“原子”提交，而不是在提交时忽略一些文件，我采取了另一种方式，只提交了我想要的文件：

```
svn ci filename1 filename2 
```

也许，它会帮助某人。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-08-12T02:38:09.873

伙计们，我刚刚找到了解决方案。鉴于 TortoiseSVN 按我们想要的方式工作，我尝试在 Linux 下安装它——也就是说，在 Wine 上运行。令人惊讶的是它的工作原理！你所要做的就是：

1.  通过运行添加要跳过提交的文件：“svn changelist 'ignore-on-commit'”。
2.  使用 TortoiseSVN 提交：“~/.wine/drive_c/Program\ Files/TortoiseSVN/bin/TortoiseProc.exe /command:commit /path:'
3.  默认情况下，排除的文件将不**检查**提交，而其他修改的文件将被检查。这与在 Windows 下完全相同。享受！

（需要通过 CLI 排除文件的原因是因为找不到执行此操作的菜单条目，不知道为什么。无论如何，这很好用！）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-23T17:21:23.360

不允许提交冲突的文件。您可以利用这一点将您的私有更改保留在存储库之外。这最适用于少量文件。

要获得冲突`a-file`，您的工作副本 (WC) 没有`a-file`来自存储库的最新版本，并且`a-file`您的 WC 中的更改与存储库中的更改位于同一位置（您未更新的更改）还）。如果您不想等待上述条件，您可以`a-file`像这样创建冲突：
在工作副本 1 (WC1) 中，在 的顶部添加一行文本`a-file`，例如*“在此处制造冲突”*。使用必要的语法，以免破坏存储库。`a-file`从 WC1提交。在 WC2 中，在 的顶部添加不同的文本行`a-file`，例如*“我想要冲突”*。从 WC2 更新，现在 a-file 应该有冲突。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-11T21:43:15.720

相反，我会编写一个辅助 bash 脚本，该脚本`svn commit`在您需要的所有文件上运行，而不是在您不需要的文件上运行。这样你就有了更多的控制权。

例如，通过一行，您可以提交所有带有扩展名的文件`.h`并且`.cpp`您对其进行了更改（并且不会导致冲突）：

```
svn commit -m "" `svn status | grep "^M.*[h|cpp]$" | awk '{print $2}' | tr "\\n" " "` 
```

更改/添加`[h|cpp]`零件的扩展名。`-m ""`如果需要，在引号之间添加一条日志消息。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-05-20T09:12:09.590

一些提议的想法可以这样实现：

在 PowerShell 中的 Windows 上

*全部添加到默认 list.ps1*

```
dir -Recurse | ? { -not $_.PSIsContainer } | % { svn cl default $_.FullName } 
```

*添加到忽略 list.ps1*

```
 dir file1 ... filN  % { $_.FullName } > ignore-on-commit
 cat .\ignore-on-commit | % { svn cl ignore-on-commit $_ }
 svn add ignore-on-commit 
```

现在，您可以使用别名`svn ci --changelist default`，这样您就不必每次都指定它。另一个好处是您可以将提交时忽略列表（如果需要）存储在存储库中。

我对一些不断重新生成但实际上很少手动更改的文件执行此操作。例如，我将修订号添加到特定占位符的配置文件中，以便在每次提交时更改文件，但手动更改很少见。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-11-09T11:43:37.493

我厌倦了等待它内置到 SVN 中。我正在使用带有忽略提交的 tortoiseSVN，但是会弹出一个用户对话框，您无法从命令行抑制，当我运行我的构建脚本并去泡杯茶时，我讨厌它我回来发现它正在等待用户输入的 10%。

所以这是一个 Windows Powershell 脚本，它只提交不在更改列表中的文件：

```
# get list of changed files into targets
[XML]$svnStatus = svn st -q --xml C:\SourceCode\Monad
# select the nodes that aren't in a changelist
$fileList = $svnStatus.SelectNodes('/status/target/entry[wc-status/@item != "unversioned"]') | Foreach-Object {$_.path};
# create a temp file of targets
$fileListPath =  [IO.Path]::GetTempFileName();
$fileList | out-file $fileListPath -Encoding ASCII
# do the commit
svn commit --targets $fileListPath -m "Publish $version" --keep-changelists 
# remove the temp file
Remove-Item $filelistPath 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-01-13T21:16:21.463

更新 user88044 的脚本。

这个想法是将文件推送到不提交更改列表中并运行邪恶的脚本。

该脚本从命令中提取 do-not-commit 文件： svn status --changelist 'do-not-commit'

> #！/bin/bash DIR="$(pwd)"
> 
> IGNORE_FILES="$(svn status --changelist 'do-not-commit' | tail -n +3 | grep -oE '[^ ]+$')"
> 
> 对于我在 $IGNORE_FILES; 做 mv $DIR/$i $DIR/"$i"_; 完毕;
> 
> svn "$@";
> 
> 对于我在 $IGNORE_FILES; 做 mv $DIR/"$i"_ $DIR/$i; 完毕;

脚本放在/usr/bin/svnn (sudo chmod +x /usr/bin/svnn)

svnn 状态、svnn 提交等...

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-04-18T12:45:59.640

您可以直接使用 TortoiseSVN 配置“ignore-on-commit”更改列表。无需配置任何其他更改列表，包括所有其他文件

1) 单击“SVN Commit...”（我们不会提交，只是一种查找更改列表的图形菜单的方法） 2) 在列表上右键单击要排除的文件。3) 菜单：移动到更改列表 > 提交时忽略

下次您执行 SVN 提交时... 这些文件将在列表末尾的“忽略提交”类别下显示为未选中。

测试：TortoiseSVN 1.8.7，Build 25475 - 64 Bit，2014/05/05 20:52:12，Subversion 1.8.9，-release

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-09-28T18:10:17.207

这对游戏来说已经很晚了，但我找到了解决这个问题的最棒的命令行命令。使用 bash 完成。享受。

```
svn status | grep -v excluding | sed 's/^A */"/g; s/$/"/g' | tr '\n' ' ' | xargs svn commit -m "My Message" 
```

好的，这里是命令的解释。有些事情需要根据您的用例进行更改。

```
svn status 
```

我得到所有文件的列表。它们都以这些状态字符（?、!、A 等）开头。每个都有自己的路线

```
grep -v excluding 
```

我使用 grep 过滤列表。它既可以正常使用（包括），也可以与 -v 标志一起使用（排除）。在这种情况下，它被用于排除，短语“排除”将被排除。

```
sed 's/^. */"/g; s/$/"/g' 
```

现在我删除每行开头的状态字符和空格，然后使用 sed 引用每一行。我的一些文件名中有空格，因此引用。

```
tr '\n' ' ' 
```

使用 tr，我用空格替换所有换行符。现在我要提交的整个文件列表都在一行上。

```
xargs svn commit -m "My Message" 
```

最后，我使用 xargs 来执行带有消息的提交命令。它执行提交，并将我引用的文件列表作为最后一个参数删除。

结果是一切最终都按照我想要的方式进行。我仍然有点讨厌 svn 强迫我跳过这些该死的箍，但我可以忍受这个。我猜。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-07-26T13:09:22.230

当我面临完全相同的问题时，我的谷歌搜索一直没有给我任何信息，我想我找到了解决方法。这就是我所做的，它似乎对我有用，但是由于我坚持使用旧版本的 SVN（< 1.5，因为它没有 --keep-local 选项）而且我不是它的专家，我不能确定这是一个通用的解决方案。如果它也适合你，请告诉我！

我正在处理从 SVN 获得的 Prestashop 安装，因为其他人已经开始使用它。由于数据库设置是为另一台服务器完成的，因此我在 /config 文件夹中的某个文件中更改了它们。由于这个文件夹已经版本化，在 svn:ignore 中设置它不会阻止我对它的本地修改被提交。这是我所做的：

```
cp config ../cfg_bkp              # copy the files out of the repo
svn rm config                     # delete files both from svn and "physically"
svn propset svn:ignore "config" . # as the files no longer exists, I can add my ignore rule and then...
mv ../cfg_bkp config              # ...bring'em back
svn revert --recursive config     # make svn forget any existing status for the files (they won't be up for deletion anymore) 
```

现在我可以运行 svn add --force 。在 repo 根目录而不添加我的配置，即使它与 repo 的版本不匹配（我想如果我再修改一次，我将不得不再次经历这一切，没有测试）。我也可以 svn 更新，而不会覆盖我的文件或出现任何错误。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-04-24T15:41:35.987

**不忽略目录属性更改的解决方案**

我尝试使用基于 的解决方案`changelist`，但我遇到了一些问题。首先，我的存储库有数千个文件，因此要提交的更改列表很大，我的`svn status`输出变得太长，需要解析才能有用。最重要的是我想提交来自合并的更改，这意味着它们包括属性更改。提交更改列表时，附加到目录的 svn 属性未提交，所以我不得不做一个额外的提交：

```
svn ci --cl work -m "this commits files from the work changelist only"
svn up
svn ci --depth empty DIR . -m "record merge properties" 
```

您可能必须对多个目录执行此操作（这里我记录了`DIR`当前 dir 和的属性`.`），基本上是那些`M`在发出`svn status`命令时在第二列中带有 a 的目录。

**解决方案**

我使用了补丁和`svn patch`. 在伪代码中：

```
svn diff $IGNORE_FILES > MYPATCH   # get the mods to ignore
svn patch --reverse-diff MYPATCH   # remove the mods
svn ci -m "message"                # check-in files and directory properties
svn patch MYPATCH                  # re-apply the mods 
```

像其他海报一样，我最终使用脚本来维护要忽略的文件列表：

```
#! /usr/bin/env bash

finish() {
    svn patch MYPATCH               # re-apply the mods
}
trap finish EXIT

IGNORE_FILES="\
sources/platform/ecmwf-cca-intel-mpi.xml \
runtime/classic/platform/ecmwf-cca.job.tmpl \
runtime/classic/platform/ecmwf-cca-intel.xml"

svn diff $IGNORE_FILES > MYPATCH # get the mods to ignore
svn patch --reverse-diff MYPATCH # remove the mods

svn "$@" 
```

我通常将它与`ci`and一起使用`revert -R .`。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-08-26T06:28:16.027

如果你在linux上，下面的答案会很有用

**第 1 步**`.svnignore`在工作副本的根级别创建文件，并在每个新行中添加文件夹/文件（例如，下面）

```
\.
folder1
folder2
folder3/file2.html
folder4/file1.js 
```

**注意：您还需要添加`\.`指向根目录**

*提示：要获得确切的文件夹/文件路径，请运行`svn st -u`然后将相同的路径复制并粘贴到`.svnignore`文件中*

**第 2 步**运行以下命令以提交文件中除文件夹/文件之外的所有`.svnignore`内容

```
svn ci -m "YOUR-COMMENT-HERE" $(svn st | grep -v -w -f .svnignore | awk '{print $NF}') 
```

**命令说明**

```
╔════════════════════╦════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║ svn ci             ║ Shorthand for svn commit                                                                               ║
╠════════════════════╬════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ svn st             ║ Shorthand for svn status                                                                               ║
╠════════════════════╬════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ |                  ║ Pipe(|) is used to pass output of previous command to next command's input                             ║
╠════════════════════╬════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ grep               ║ grep is a linux command to filter                                                                      ║
╠════════════════════╬════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ grep -v            ║ Give result other than matched (Inverse)                                                               ║
╠════════════════════╬════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ grep -w            ║ Exact match(used to match literal Dot(.))                                                              ║
╠════════════════════╬════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ grep -f filename   ║ Read pattern from file                                                                                 ║
╠════════════════════╬════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ awk '{print $NF}') ║ print last column data (columns are divided with space delimiter), used to get exact folder/file names ║
╚════════════════════╩════════════════════════════════════════════════════════════════════════════════════════════════════════╝ 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-03-11T17:01:35.997

[`svn:ignore`是你的答案。](http://svnbook.red-bean.com/en/1.1/ch07s02.html)

例子：

```
$ svn propset svn:ignore -F .cvsignore .
property 'svn:ignore' set on '.' 
```

* * *

## 回答 #18

> 赞同：-9
> 
> 时间：2009-03-11T17:06:11.507

```
svn propset "svn:ignore" "*.xml" . 
```

这`*.xml`是要忽略的文件模式；您也可以在此处使用目录名称。

# c# - 将 xml 文档附加到 C# 中的 xml 节点？

> ID：635450
> 
> 赞同：9
> 
> 时间：2009-03-11T17:00:50.863
> 
> 标签：c#, xml

如何在 c# 中将 XML 文档附加到 xml 节点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-11T17:10:58.127

An`XmlDocument` *基本上*是 an `XmlNode`，因此您可以像添加任何其他 一样附加它`XmlNode`。但是，不同之处在于*它* `XmlNode`不属于目标文档，因此您需要使用 ImportNode 方法*然后*执行附加。

```
// xImportDoc is the XmlDocument to be imported.
// xTargetNode is the XmlNode into which the import is to be done.

XmlNode xChildNode = xSrcNode.ImportNode(xImportDoc, true);
xTargetNode.AppendChild(xChildNode); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-11T17:06:37.700

是的：

```
XmlNode imported = targetNode.OwnerDocument.ImportNode(otherDocument.DocumentElement, true);
targetNode.AppendChild(imported); 
```

我认为这会创建您文档的克隆。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T17:04:55.380

或许是这样的：

```
XmlNode node = ......  // belongs to targetDoc (XmlDocument)

node.AppendChild(targetDoc.ImportNode(xmlDoc.DocumentElement)); 
```

马克

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-10T14:06:04.560

假设您有以下结构：

以下结构存储在名为 xmlElement 的 XmlElement 中：

```
</root> 
```

并且以下结构存储在名为 FooNode 的 XmlNode 对象中；

```
<foo>
    <bar>This is a test</bar>
    <baz>And this is another test</baz>
</foo> 
```

然后执行以下操作：

```
XmlNode node = doc.ImportNode(FooNode.SelectSingleNode("foo"), true);
xmlElement.AppendChild(node); 
```

希望它可以帮助某人

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T17:06:48.917

获得相关 XML 文档的根节点后，您可以将其附加为相关节点的子节点。那有意义吗？

# php - PHP 无法识别 http_get_request_headers()？

> ID：635462
> 
> 赞同：6
> 
> 时间：2009-03-11T17:04:29.873
> 
> 标签：php, http

我在运行 PHP 5 的服务器上的 PHP 文件中调用 http_get_request_headers()。但是，我收到致命错误：调用未定义函数 http_get_request_headers()。有谁知道问题可能是什么？这个函数不是普通 PHP 自带的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T17:11:51.477

不，不是的。您需要一个[PECL 模块](http://pecl.php.net/package/pecl_http)才能使该功能正常工作。但是您可以使用 $_SERVER 变量的内容，如php 站点上的[此评论中所述。](http://us.php.net/reserved.variables.server#87195)或者，如果这是您的 Web 服务器，您可以使用[apache 功能。](http://de.php.net/manual/en/function.apache-request-headers.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-05T02:49:43.583

如果您使用 >= 2 的版本，`pecl_http`则需要使用命名空间语法来调用函数。在此处查看[版本 2 文档](http://devel-m6w6.rhcloud.com/mdref/http/Env/getRequestHeader)和此处[示例](http://techblog.willshouse.com/?p=5340)

基本上`\http\Env::getRequestHeader()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T17:12:09.090

该函数是 PECL 扩展的一部分。

按照此页面上的说明进行安装：[http ://ar.php.net/manual/en/http.install.php](http://ar.php.net/manual/en/http.install.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T17:13:04.627

您是否阅读过[HTTP 类/函数的安装和配置指南](http://docs.php.net/manual/en/http.setup.php)？

# wpf - WPF后台工作人员无法识别工作人员对象

> ID：635472
> 
> 赞同：0
> 
> 时间：2009-03-11T17:06:06.717
> 
> 标签：wpf, vb.net, backgroundworker

我有以下代码将后台工作人员添加到 VB.net WPF 项目中：

```
Imports System
Imports System.ComponentModel
Imports System.ComponentModel.BackgroundWorker
Imports System.IO
Imports System.Threading
Imports System.Net
Imports System.Windows
Imports System.Windows.Controls
Imports System.Windows.Data
Imports System.Windows.Media
Imports System.Windows.Media.Animation
Imports System.Windows.Navigation
Imports System.ServiceProcess
Partial Public Class Window1
Public Sub New()
    MyBase.New()
    Me.InitializeComponent()
    End Sub
End Class
Public Class Window1
Dim worker As New BackgroundWorker
Private Sub worker_DoWork(ByVal sender As Object, ByVal e As System.ComponentModel.BackgroundWorker) Handles worker.DoWork

   End Sub
End Class 
```

对于 DoWork 工作人员事件，我收到以下错误：

> Handles 子句需要在包含类型或其基类型之一中定义的 WithEvents 变量。

似乎它在事件声明中丢失了一些东西，但找不到它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T17:23:48.063

在声明新的后台工作人员时尝试添加“WithEvents”。下面是来自 Windows 窗体设计器生成代码的我的一个后台工作者对象的代码片段：

```
Friend WithEvents bWorker As System.ComponentModel.BackgroundWorker 
```

让我知道这是否有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T17:31:17.703

DoWork 事件的签名看起来很时髦 - 不应该是（对象，DoWorkEventArgs）。

你有（对象，BackgroundWorker）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T17:25:28.480

尝试更换

```
Dim worker As New BackgroundWorker 
```

和

```
Private WithEvents worker As New BackgroundWorker 
```

# arrays - Visual Studio 2005 中索引错误的 char[] 数组

> ID：635477
> 
> 赞同：2
> 
> 时间：2009-03-11T17:07:04.813
> 
> 标签：arrays, visual-c++, visual-studio-2005, pointers

我无法解释在`char[]`我继承的 C++ 类的数组中似乎出现了错误寻址。我正在使用 Visual Studio 2005，并将问题缩小到：

**MyClass.h：**

```
class MyClass {
public:
  MyClass();
  virtual ~MyClass();
  void Reset();
  // More member functions. . .

  char m_szString[128];
  // More member variables. . .
} 
```

**我的类.cpp：**

```
MyClass::MyClass() { Reset(); }
MyClass::Reset()   { m_szString[0] = 'X'; }
// . . . 
```

当我单步执行程序时，我发现该`Reset()`函数实际上设置为-与我预期的不同。根据监视窗口，之前类中的唯一元素是指向 vftable 的指针，恰好是 4 个字节。`m_szString[`**`4`**`]``'X'``m_szString[`**`0`**`]``m_szString[]``__vfptr`

如果我向 中添加更多成员变量`MyClass`，则后续字符串会被各种不断增加的 4 个字节的倍数错误寻址。不仅与4 字节边界*对齐，而且实际上**偏移*了 4 的倍数。就好像编译器为每个 vftable 跳过了两倍的必要空间……但这纯粹是猜测。

已经报告了一些类似的问题（谷歌，MSDN），但我还没有找到任何答案。

* * *

**附加信息/部分解决方案：** 该类是成为 DLL 的包装类的唯一成员变量。父级最初被声明为

```
class ATL_NO_VTABLE CWrapperClass 
```

删除`ATL_NO_VTABLE`修复了对齐问题。

我仍然看到缓冲区溢出，但这些应该很容易追踪。

您能否用可以`ATL_NO_VTABLE`理解的术语向嵌入式 C 开发人员解释，他们在 BSTR 之外的 COM 经验非常有限，或者更好的是，提供一个指向良好参考的指针（抱歉）？

* * *

*还有更多：* [这个问题](https://stackoverflow.com/questions/7525/)提供了一些有用的调试信息。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T17:25:40.430

这里有两个问题：

*   有什么问题？我的意思不是在调试器中看起来很可疑，而是在顶层实际上出了什么问题？您在调试器中看到的可能是优化的结果，而不是实际错误。
*   您是否有一些重现错误的最小代码？以上并没有告诉我太多。如果我以前遇到*完全相同*的问题，它可能会有用，但我没有。那么如果我想重现这个问题，我应该怎么做呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T20:31:12.183

我的第一个猜测是编译时开启了非预期的优化。

我的第二个猜测是 unicode 支持会发生一些奇怪的事情（例如 char vs wchar_t）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T21:15:52.373

## 答案

事实上，编译器正在为某些类成员计算错误的地址。罪魁祸首原来是**`#pragma pack 1`**隐藏`#included`在一些源文件中的一个不起眼的头文件中的指令。

## 我是怎么找到的

50% 的坚持、50% 的运气和 10% 的数学技能。:-)

我遇到了一个非常简单的类，它的方法和成员很少，其中大部分是在头文件中定义的，包括：

```
typedef int BOOL;  // Legacy, makes my skin crawl; don't ask.
BOOL isConnected() { return m_bConnected; };
BOOL m_bConnected; 
```

...`false`当我*知道*  `m_bConnected`时返回的函数是`true`：

*   监视窗口显示正确的值。程序化更改`m_bConnected`反映在窗口中。
*   监视`&m_bConnected`显示它开始进入类的 8 个字节。
*   原始内存窗口显示正确的值。计划的变化`m_bConnected`也反映在那里。
*   之前的 4 个字节`m_bConnected`是 all `0`，我将其解释为填充。
*   通过代码单步调试调试器清楚地显示了返回值`false`！

所以我检查了反汇编窗口，发现了这个（评论是我的）：

```
mov    eax,dword ptr [this]        ; address of the class instance
mov    eax,dword ptr [eax+4]       ; offset to m_bConnected 
```

换句话说，编译器将偏移量计算为 4，而它本应为 8。

## 啊哈！

有趣的是，当我`isConnected()`从标题中删除定义并将其放入源文件时，*地址计算正确*！这使我确信这确实是一个打包问题，并且搜索代码库以`#pragma pack`快速识别罪魁祸首，一个古老的头文件（合法地）需要在 1 字节边界上对齐，但从未将打包重置为默认值。

## 修复

解决方案就像封闭有问题的标题一样简单，如下所示：

```
#pragma pack(push)
// original code here
#pragma pack(pop) 
```

感谢您的关注。还有萨拉，如果你在看书，我就要[在我的桌子上跳舞了](https://stackoverflow.com/questions/183469/how-do-you-reward-yourself-when-youve-overcome-a-monster-task)！

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-12T10:48:02.983

在开始使用之前将字符串终止为空总是更好。通过这样做，即使在调试时，您也会对阵列有一个更清晰的视图。更何况你已经在 public 中声明了 m_szString 。最好在私有区域中声明数组并使用成员函数返回它

# c# - 使用 Rhino Mocks 如何为 Mocked 方法设置参数的属性

> ID：635479
> 
> 赞同：3
> 
> 时间：2009-03-11T17:08:04.327
> 
> 标签：c#, unit-testing, syntax, mocking, rhino-mocks

使用新的 Rhino Mocks 3.5 Arrange/Act/Assert (AAA) 测试风格，我在编写测试时遇到问题。

我有一个调用存储库类上的方法的方法。ActivateFoo，我的 Foo 对象有一个 IsActive 属性。ActivateFoo 对象的结果应该改变属性。

这是示例代码：

```
[TestMethod]
public void Should_update_foo_to_active_inside_of_repository()
{
  // arrange
  var repo = MockRepository.GenerateMock<IRepository>();
  var foo = new Foo() { ID = 1, IsActive = false };
  var target = new Presenter(repo);
  repo.Expect(x => x.ActivateFoo(foo)).Return(true);

  // act
  target.Activate(foo);

  // assert
  Assert.IsTrue(foo.IsActive);
  repo.VerifyAllExpectations();  
} 
```

我猜关键代码段将在“ActivateFoo(foo))”之间。和“返回（真）；”。

有一点要澄清方法链接的东西在幕后是如何工作的，如果在我期望的行上写了代码，它是在 Return() 之后还是之前有关系吗？（当然，除非解决方案是使用 Expect 的 MethodOptions 重载，或者其他）。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T18:52:49.987

感谢 AB Kolan，这是我使用和工作的结果代码。

```
[TestMethod]
public void Should_update_foo_to_active_inside_of_repository()
{
    // arrange
    var repo = MockRepository.GenerateMock<IRepository>();
    var foo = new Foo() { ID = 1, IsActive = false };
    var target = new Presenter(repo);
    repo.Expect(x => x.ActivateFoo(foo)).
        Do(new Func<Foo, bool>(
            delegate(Foo f) { f.IsActive = true; return true; }
        ));

    // act
    target.Activate(foo);

    // assert
    Assert.IsTrue(foo.IsActive);
    repo.VerifyAllExpectations();
} 
```

我倾向于不喜欢有额外的函数方法来单独使用测试，如果可能的话，更喜欢内联委托。

为了解决这个问题，我应该做或不做设计。由于名称在那里，这不是 target.Activate() 方法的确切代码和内部。Activate() 中的代码进行一些检查，如果需要，将执行存储库 ActivateFoo()，然后检查该操作的结果并执行其他操作。

因此，可能稍后我将不得不重构它并分离步骤，但现在，我已经让它工作了。

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T17:40:11.673

我还没有真正使用这个版本的 RhinoMocks，但在旧版本中，您必须使用 .Do(适当的委托) 来设置标志并返回值 (而不是 .Return)。

请让我知道它是否有效，否则我可以玩它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T17:56:46.783

从外观上看，ActivateFoo 应该是一个 void 方法。而且由于您正在模拟它，因此您不应该验证它是否会更改对象上的任何内容。

您将在测试存储库方法 ActivateFoo 时验证 IsActive 属性是否已更改，而不是在测试演示者上的 Activate 方法时更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T18:01:12.687

您可能想使用 Do 处理程序尝试这样的事情。老实说，我觉得 ActivateFoo 应该是 void 返回类型。但这里是具有 bool 返回类型的 ActivateFoo 的代码。

```
 [TestMethod]
    public void Should_update_foo_to_active_inside_of_repository()
    {
        // arrange
        var repo = MockRepository.GenerateMock<IRepository>();
        var foo = new Foo() { ID = 1, IsActive = false };
        var target = new Presenter(repo);
        repo.Expect(x => x.ActivateFoo(foo)).
            Do(new ActivateFooDelegate(ActivateFooDelegateInstance));
        // act
        target.Activate(foo);

        // assert
        Assert.IsTrue(foo.IsActive);
        repo.VerifyAllExpectations();
    }

    private delegate bool ActivateFooDelegate(Foo f);

    public bool ActivateFooDelegateInstance(Foo f)
    {
        f.IsActive = true;
        return f.IsActive;
    } 
```

# ant - 使用 ant 运行“纯”JUnit 4 测试

> ID：635481
> 
> 赞同：24
> 
> 时间：2009-03-11T17:08:23.187
> 
> 标签：ant, junit, junit4

我们已经迁移到 JUnit 4 和 ant 1.7

测试在 Eclipse 中运行良好，但在使用 ant 运行测试时会忽略注释。

根据 Ant junit 任务[文档](http://ant.apache.org/manual/Tasks/junit.html)：

> 它也适用于 JUnit 4.0，包括仅使用注释而不使用 JUnit4TestAdapter 的“纯”JUnit 4 测试。

但是文档没有详细说明它应该如何配置。

junit任务是否需要任何特殊设置？我错过了什么吗？我们有扩展 TestCase（即 3.8 风格）的测试和“纯”Junit 4 测试，这可能是问题吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-11T17:13:20.553

我在 Ant 中使用纯 JUnit4 测试。

这是我的构建文件中有趣的部分：

```
<junit printsummary="yes" haltonfailure="yes">
    <formatter type="xml"/>
    <classpath refid="path.test"/>
    <batchtest fork="yes" todir="${dir.report.unittests.xml}">
        <fileset dir="src">
            <include name="**/*Test*.java"/>
        </fileset>
    </batchtest>
</junit> 
```

确保您在 Ant 的 lib 目录中拥有最新版本的 junit.jar 文件。据我所知，所需版本随 ant 1.7 或更高版本一起提供...

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-03-22T15:48:53.263

Ant 默认附带一个 JUnit 3 版本。JUnit 3 不支持测试注释。

要使用 junit 任务中的 JUnit 4 注释，请确保在 junit 任务的嵌套类路径元素中提供 JUnit 4 jar 的位置（请参阅[ant FAQ 中的此条目](http://ant.apache.org/faq.html#delegating-classloader)）。

```
<junit showoutput="yes" fork="true">
    <classpath>
        <!-- The location of the JUnit version that you want to use -->
        <pathelement location="lib/junit-4.9b1.jar"/>
    </classpath>

    <formatter type="plain" usefile="false" />

    <batchtest>
        <fileset dir="${tests.dir}"/>
    </batchtest>
</junit> 
```

这是覆盖 ANT_HOME/lib 中的 ant-junit.jar 的更好解决方案，因为这意味着您可以将 JUnit jar 与代码一起保存在源代码控制中，从而直接升级到更高版本。

请注意，虽然我没有在上面的文件集中指定任何包含模式，但这确实意味着 junit 任务将尝试针对该目录结构中的所有类运行 JUnit，这可能会导致包含许多不包含的类任何测试取决于您如何构建源文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-05T21:44:32.390

您最终只能使用 ant 1.9.3+ 中添加的**skipNonTests**参数来查找和执行测试！

这是上面接受的答案的代码片段（除了新的**skipNonTests**参数和去掉文件名要求中的“测试”）：

```
<junit printsummary="yes" haltonfailure="yes">
    <formatter type="xml"/>
    <classpath refid="path.test"/>
    <batchtest skipNonTests="true" fork="yes" todir="${dir.report.unittests.xml}">
        <fileset dir="src">
            <include name="**/*.java"/>
        </fileset>
    </batchtest>
</junit> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-21T12:08:41.480

这发生在我身上，这是因为我既使用注释又扩展了 TestCase。

```
public class TestXXX extends TestCase {

    @Test
    public void testSimpleValidCase() {
        // this was running
    }

    @Test
    public void simpleValidCase() {
        // this wasn't running
    }
} 
```

当您扩展 TestCase 时，您将采用 JUnit3 样式，因此忽略 JUnit4 注释。

解决方案是停止扩展 TestCase。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-27T22:31:53.187

验证您的类路径定义...这解决了我的问题。

```
<path id="classpath" description="Classpath do Projeto">
    <fileset dir="${LIB}">
        <include name="**/*.jar" />
        <exclude name="**/.SVN/*.*"/>
    </fileset>
</path> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T17:15:25.417

这是我的通用 ant 脚本的相关部分...不确定这是否对您有帮助..

```
 <junit fork="true"
        forkmode="once"
        haltonfailure="false"
        haltonerror="false"
        failureproperty="tests.failures"
        errorproperty="tests.errors"
        includeantruntime="true"
        showoutput="true"
        printsummary="true">
     <classpath>
         <path refid="path-id.test.classpath.run"/>
     </classpath>

     <formatter type="xml"/>

     <batchtest fork="yes"
                todir="${dir.build.testresults}">
         <fileset dir="${dir.src.tests}">
             <include name="**/*Test.java"/>
         </fileset>
     </batchtest>
 </junit> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-13T09:45:47.467

将此注释应用于其他类 org.junit.Ignore

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-28T22:57:13.913

我还尝试在没有 JUnit4TestAdapter 的情况下使用 JUnit 4.0 进行测试，即没有方法
public static junit.framework.Test suite() { return new JUnit4TestAdapter(SomeTestClass.class); }

我使用蚂蚁 1.9.4。运行 ant test verbose (ant -v) 显示

> [junit] 在同一个 VM 中运行多个测试
> [junit] 隐式添加 /usr/share/java/junit.jar:/usr/sharejava/ant-launcher.jar:/usr/share/java/ant.jar:/usr /share/java/ant/ant-junit.jar 到 CLASSPATH

啊哈，但仍然有一些 ant-junit-task。下载此文件还显示了未隐式添加的 /usr/share/java/ant/ant-junit4.jar。我只是明确地添加了它：

```
<junit printsummary="yes" 
    fork="yes" 
    forkmode="once"
    maxmemory="1023m" 
    showoutput="no">
    ...
   <classpath>
     <pathelement path="...:${junitJar}:${hamcrestJar}:/usr/share/java/ant/ant-junit4.jar" />
   </classpath>
...
</junit> 
```

它奏效了。没有：没有。我知道这个解决方案一点也不漂亮......

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-09-01T22:58:14.907

我最终做的是在任务使用的我的定义之一中添加一个 Ant>。等等。

# python - 实现嵌套字典的最佳方法是什么？

> ID：635483
> 
> 赞同：217
> 
> 时间：2009-03-11T17:09:21.560
> 
> 标签：python, data-structures, dictionary, mapping, autovivification

我有一个基本上相当于嵌套字典的数据结构。假设它看起来像这样：

```
{'new jersey': {'mercer county': {'plumbers': 3,
                                  'programmers': 81},
                'middlesex county': {'programmers': 81,
                                     'salesmen': 62}},
 'new york': {'queens county': {'plumbers': 9,
                                'salesmen': 36}}} 
```

现在，维护和创建它非常痛苦；每次我有一个新的州/县/专业时，我都必须通过令人讨厌的 try/catch 块创建下层词典。此外，如果我想遍历所有值，我必须创建烦人的嵌套迭代器。

我也可以使用元组作为键，如下所示：

```
{('new jersey', 'mercer county', 'plumbers'): 3,
 ('new jersey', 'mercer county', 'programmers'): 81,
 ('new jersey', 'middlesex county', 'programmers'): 81,
 ('new jersey', 'middlesex county', 'salesmen'): 62,
 ('new york', 'queens county', 'plumbers'): 9,
 ('new york', 'queens county', 'salesmen'): 36} 
```

这使得对值的迭代变得非常简单和自然，但是在语法上做聚合和查看字典的子集（例如，如果我只想逐个状态）会更加痛苦。

基本上，有时我想将嵌套字典视为平面字典，有时我想将其视为复杂的层次结构。我可以将这一切都包装在一个类中，但似乎有人可能已经这样做了。或者，似乎有一些非常优雅的句法结构可以做到这一点。

我怎样才能做得更好？

附录：我知道，`setdefault()`但它并没有真正实现干净的语法。此外，您创建的每个子词典仍然需要`setdefault()`手动设置。

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2013-11-07T06:53:24.557

> ## 在 Python 中实现嵌套字典的最佳方法是什么？

这是一个坏主意，不要这样做。相反，请使用常规字典并使用`dict.setdefault`where apropos，因此当在正常使用下缺少键时，您会得到预期的`KeyError`. 如果您坚持要采取这种行为，请按以下步骤射击自己：

`__missing__`在子类上实现`dict`以设置并返回一个新实例。

这种方法自 Python 2.5 起就可用[（并记录在案） ，并且（对我特别有价值）](http://docs.python.org/2/library/stdtypes.html#dict)**它像普通的 dict 一样漂亮地打印出来**，而不是自动生成 defaultdict 的丑陋打印：

```
class Vividict(dict):
    def __missing__(self, key):
        value = self[key] = type(self)() # retain local pointer to value
        return value                     # faster to return than dict lookup 
```

（注意`self[key]`在赋值的左边，所以这里没有递归。）

并说你有一些数据：

```
data = {('new jersey', 'mercer county', 'plumbers'): 3,
        ('new jersey', 'mercer county', 'programmers'): 81,
        ('new jersey', 'middlesex county', 'programmers'): 81,
        ('new jersey', 'middlesex county', 'salesmen'): 62,
        ('new york', 'queens county', 'plumbers'): 9,
        ('new york', 'queens county', 'salesmen'): 36} 
```

这是我们的使用代码：

```
vividict = Vividict()
for (state, county, occupation), number in data.items():
    vividict[state][county][occupation] = number 
```

现在：

```
>>> import pprint
>>> pprint.pprint(vividict, width=40)
{'new jersey': {'mercer county': {'plumbers': 3,
                                  'programmers': 81},
                'middlesex county': {'programmers': 81,
                                     'salesmen': 62}},
 'new york': {'queens county': {'plumbers': 9,
                                'salesmen': 36}}} 
```

## 批评

对这种容器的批评是，如果用户拼错了一个键，我们的代码可能会默默地失败：

```
>>> vividict['new york']['queens counyt']
{} 
```

此外，现在我们的数据中有一个拼写错误的县：

```
>>> pprint.pprint(vividict, width=40)
{'new jersey': {'mercer county': {'plumbers': 3,
                                  'programmers': 81},
                'middlesex county': {'programmers': 81,
                                     'salesmen': 62}},
 'new york': {'queens county': {'plumbers': 9,
                                'salesmen': 36},
              'queens counyt': {}}} 
```

# 解释：

`Vividict`每当一个键被访问但丢失时，我们只是提供我们类的另一个嵌套实例。（返回赋值是有用的，因为它避免了我们额外调用 dict 上的 getter，不幸的是，我们不能在设置时返回它。）

请注意，这些语义与最受好评的答案相同，但只有一半的代码行 - nosklo 的实现：

> ```
> class AutoVivification(dict):
>     """Implementation of perl's autovivification feature."""
>     def __getitem__(self, item):
>         try:
>             return dict.__getitem__(self, item)
>         except KeyError:
>             value = self[item] = type(self)()
>             return value 
> ```

## 使用示范

下面只是一个示例，说明如何轻松使用此 dict 动态创建嵌套的 dict 结构。这可以快速创建一个层次结构的树结构，就像你想去的一样深。

```
import pprint

class Vividict(dict):
    def __missing__(self, key):
        value = self[key] = type(self)()
        return value

d = Vividict()

d['foo']['bar']
d['foo']['baz']
d['fizz']['buzz']
d['primary']['secondary']['tertiary']['quaternary']
pprint.pprint(d) 
```

哪个输出：

```
{'fizz': {'buzz': {}},
 'foo': {'bar': {}, 'baz': {}},
 'primary': {'secondary': {'tertiary': {'quaternary': {}}}}} 
```

正如最后一行所示，它打印得很漂亮，可以进行人工检查。但是，如果您想直观地检查您的数据，实施`__missing__`将其类的新实例设置为键并返回它是一个更好的解决方案。

# 其他替代方案，用于对比：

## `dict.setdefault`

虽然提问者认为这不干净，但我觉得它比`Vividict`我自己更可取。

```
d = {} # or dict()
for (state, county, occupation), number in data.items():
    d.setdefault(state, {}).setdefault(county, {})[occupation] = number 
```

现在：

```
>>> pprint.pprint(d, width=40)
{'new jersey': {'mercer county': {'plumbers': 3,
                                  'programmers': 81},
                'middlesex county': {'programmers': 81,
                                     'salesmen': 62}},
 'new york': {'queens county': {'plumbers': 9,
                                'salesmen': 36}}} 
```

拼写错误会大声失败，并且不会使我们的数据因错误信息而混乱：

```
>>> d['new york']['queens counyt']
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 'queens counyt' 
```

此外，我认为 setdefault 在循环中使用时效果很好，并且您不知道您将获得什么键，但是重复使用变得非常繁琐，我认为没有人会想要跟上以下内容：

```
d = dict()

d.setdefault('foo', {}).setdefault('bar', {})
d.setdefault('foo', {}).setdefault('baz', {})
d.setdefault('fizz', {}).setdefault('buzz', {})
d.setdefault('primary', {}).setdefault('secondary', {}).setdefault('tertiary', {}).setdefault('quaternary', {}) 
```

另一个批评是 setdefault 无论是否使用都需要一个新实例。然而，Python（或至少 CPython）在处理未使用和未引用的新实例方面相当聪明，例如，它重用内存中的位置：

```
>>> id({}), id({}), id({})
(523575344, 523575344, 523575344) 
```

## 一个自动激活的默认字典

这是一个看起来很整洁的实现，并且在您没有检查数据的脚本中使用将与实现一样有用`__missing__`：

```
from collections import defaultdict

def vivdict():
    return defaultdict(vivdict) 
```

但是，如果您需要检查您的数据，以相同方式填充数据的自动激活 defaultdict 的结果如下所示：

```
>>> d = vivdict(); d['foo']['bar']; d['foo']['baz']; d['fizz']['buzz']; d['primary']['secondary']['tertiary']['quaternary']; import pprint; 
>>> pprint.pprint(d)
defaultdict(<function vivdict at 0x17B01870>, {'foo': defaultdict(<function vivdict 
at 0x17B01870>, {'baz': defaultdict(<function vivdict at 0x17B01870>, {}), 'bar': 
defaultdict(<function vivdict at 0x17B01870>, {})}), 'primary': defaultdict(<function 
vivdict at 0x17B01870>, {'secondary': defaultdict(<function vivdict at 0x17B01870>, 
{'tertiary': defaultdict(<function vivdict at 0x17B01870>, {'quaternary': defaultdict(
<function vivdict at 0x17B01870>, {})})})}), 'fizz': defaultdict(<function vivdict at 
0x17B01870>, {'buzz': defaultdict(<function vivdict at 0x17B01870>, {})})}) 
```

这个输出很不雅，结果很不可读。通常给出的解决方案是递归地转换回字典以进行手动检查。这个重要的解决方案留给读者作为练习。

# 表现

最后，让我们看看性能。我正在减去实例化的成本。

```
>>> import timeit
>>> min(timeit.repeat(lambda: {}.setdefault('foo', {}))) - min(timeit.repeat(lambda: {}))
0.13612580299377441
>>> min(timeit.repeat(lambda: vivdict()['foo'])) - min(timeit.repeat(lambda: vivdict()))
0.2936999797821045
>>> min(timeit.repeat(lambda: Vividict()['foo'])) - min(timeit.repeat(lambda: Vividict()))
0.5354437828063965
>>> min(timeit.repeat(lambda: AutoVivification()['foo'])) - min(timeit.repeat(lambda: AutoVivification()))
2.138362169265747 
```

基于性能，`dict.setdefault`效果最好。如果您关心执行速度，我强烈推荐它用于生产代码。

如果您需要将其用于交互式使用（也许在 IPython 笔记本中），那么性能并不重要 - 在这种情况下，我会使用 Vividict 来提高输出的可读性。与 AutoVivification 对象（使用`__getitem__`而不是`__missing__`为此目的而制作的 ）相比，它要优越得多。

# 结论

`__missing__`在子类上实现`dict`以设置和返回新实例比替代方案稍微困难一些，但具有以下好处

*   简单的实例化
*   简单的数据填充
*   轻松查看数据

并且由于它比修改更简单且性能更高`__getitem__`，因此应该首选该方法。

尽管如此，它也有缺点：

*   错误的查找会默默地失败。
*   错误的查找将保留在字典中。

因此，我个人更喜欢`setdefault`其他解决方案，并且在我需要这种行为的每一种情况下都有。

* * *

## 回答 #2

> 赞同：189
> 
> 时间：2009-03-16T21:53:36.700

```
class AutoVivification(dict):
    """Implementation of perl's autovivification feature."""
    def __getitem__(self, item):
        try:
            return dict.__getitem__(self, item)
        except KeyError:
            value = self[item] = type(self)()
            return value 
```

测试：

```
a = AutoVivification()

a[1][2][3] = 4
a[1][3][3] = 5
a[1][2]['test'] = 6

print a 
```

输出：

```
{1: {2: {'test': 6, 3: 4}, 3: {3: 5}}} 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2011-09-19T19:51:07.967

只是因为我还没有见过这么小的一个，这里有一个你喜欢嵌套的字典，没有汗水：

```
# yo dawg, i heard you liked dicts                                                                      
def yodict():
    return defaultdict(yodict) 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-03-11T20:08:17.090

您可以创建一个 YAML 文件并使用[PyYaml](http://pyyaml.org/)读取它。

第 1 步：创建 YAML 文件“employment.yml”：

```
new jersey:
  mercer county:
    pumbers: 3
    programmers: 81
  middlesex county:
    salesmen: 62
    programmers: 81
new york:
  queens county:
    plumbers: 9
    salesmen: 36 
```

第 2 步：用 Python 阅读

```
import yaml
file_handle = open("employment.yml")
my_shnazzy_dictionary = yaml.safe_load(file_handle)
file_handle.close() 
```

现在`my_shnazzy_dictionary`拥有你所有的价值观。如果您需要即时执行此操作，您可以将 YAML 创建为字符串并将其输入`yaml.safe_load(...)`.

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2009-03-11T17:29:12.700

由于您有星型模式设计，因此您可能希望将其构建得更像关系表而不是字典。

```
import collections

class Jobs( object ):
    def __init__( self, state, county, title, count ):
        self.state= state
        self.count= county
        self.title= title
        self.count= count

facts = [
    Jobs( 'new jersey', 'mercer county', 'plumbers', 3 ),
    ...

def groupBy( facts, name ):
    total= collections.defaultdict( int )
    for f in facts:
        key= getattr( f, name )
        total[key] += f.count 
```

这种事情可以大大有助于创建类似数据仓库的设计，而无需 SQL 开销。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2009-03-11T20:02:11.053

如果嵌套级别的数量很少，我会使用`collections.defaultdict`：

```
from collections import defaultdict

def nested_dict_factory(): 
  return defaultdict(int)
def nested_dict_factory2(): 
  return defaultdict(nested_dict_factory)
db = defaultdict(nested_dict_factory2)

db['new jersey']['mercer county']['plumbers'] = 3
db['new jersey']['mercer county']['programmers'] = 81 
```

像这样使用`defaultdict`避免了很多混乱`setdefault()`的 ,`get()`等。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2014-03-29T22:53:36.880

这是一个返回任意深度的嵌套字典的函数：

```
from collections import defaultdict
def make_dict():
    return defaultdict(make_dict) 
```

像这样使用它：

```
d=defaultdict(make_dict)
d["food"]["meat"]="beef"
d["food"]["veggie"]="corn"
d["food"]["sweets"]="ice cream"
d["animal"]["pet"]["dog"]="collie"
d["animal"]["pet"]["cat"]="tabby"
d["animal"]["farm animal"]="chicken" 
```

用这样的东西遍历所有东西：

```
def iter_all(d,depth=1):
    for k,v in d.iteritems():
        print "-"*depth,k
        if type(v) is defaultdict:
            iter_all(v,depth+1)
        else:
            print "-"*(depth+1),v

iter_all(d) 
```

这打印出来：

```
- food
-- sweets
--- ice cream
-- meat
--- beef
-- veggie
--- corn
- animal
-- pet
--- dog
---- labrador
--- cat
---- tabby
-- farm animal
--- chicken 
```

您最终可能希望这样做，以便无法将新项目添加到字典中。`defaultdict`递归地将所有这些s 转换为普通s很容易`dict`。

```
def dictify(d):
    for k,v in d.iteritems():
        if isinstance(v,defaultdict):
            d[k] = dictify(v)
    return dict(d) 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-03-11T17:14:19.960

我觉得`setdefault`很有用；它检查是否存在密钥，如果不存在则添加它：

```
d = {}
d.setdefault('new jersey', {}).setdefault('mercer county', {})['plumbers'] = 3 
```

`setdefault`总是返回相关的键，所以你实际上是在更新 ' `d`' 的值。

当谈到迭代时，如果 Python 中不存在生成器，我相信你可以很容易地编写一个生成器：

```
def iterateStates(d):
    # Let's count up the total number of "plumbers" / "dentists" / etc.
    # across all counties and states
    job_totals = {}

    # I guess this is the annoying nested stuff you were talking about?
    for (state, counties) in d.iteritems():
        for (county, jobs) in counties.iteritems():
            for (job, num) in jobs.iteritems():
                # If job isn't already in job_totals, default it to zero
                job_totals[job] = job_totals.get(job, 0) + num

    # Now return an iterator of (job, number) tuples
    return job_totals.iteritems()

# Display all jobs
for (job, num) in iterateStates(d):
    print "There are %d %s in total" % (job, num) 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-03-13T20:24:47.303

正如其他人所建议的那样，关系数据库可能对您更有用。您可以使用内存中的 sqlite3 数据库作为数据结构来创建表，然后查询它们。

```
import sqlite3

c = sqlite3.Connection(':memory:')
c.execute('CREATE TABLE jobs (state, county, title, count)')

c.executemany('insert into jobs values (?, ?, ?, ?)', [
    ('New Jersey', 'Mercer County',    'Programmers', 81),
    ('New Jersey', 'Mercer County',    'Plumbers',     3),
    ('New Jersey', 'Middlesex County', 'Programmers', 81),
    ('New Jersey', 'Middlesex County', 'Salesmen',    62),
    ('New York',   'Queens County',    'Salesmen',    36),
    ('New York',   'Queens County',    'Plumbers',     9),
])

# some example queries
print list(c.execute('SELECT * FROM jobs WHERE county = "Queens County"'))
print list(c.execute('SELECT SUM(count) FROM jobs WHERE title = "Programmers"')) 
```

这只是一个简单的例子。您可以为州、县和职位定义单独的表格。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-03-12T06:27:52.437

`collections.defaultdict`可以进行子分类以制作嵌套字典。然后将任何有用的迭代方法添加到该类。

```
>>> from collections import defaultdict
>>> class nesteddict(defaultdict):
    def __init__(self):
        defaultdict.__init__(self, nesteddict)
    def walk(self):
        for key, value in self.iteritems():
            if isinstance(value, nesteddict):
                for tup in value.walk():
                    yield (key,) + tup
            else:
                yield key, value

>>> nd = nesteddict()
>>> nd['new jersey']['mercer county']['plumbers'] = 3
>>> nd['new jersey']['mercer county']['programmers'] = 81
>>> nd['new jersey']['middlesex county']['programmers'] = 81
>>> nd['new jersey']['middlesex county']['salesmen'] = 62
>>> nd['new york']['queens county']['plumbers'] = 9
>>> nd['new york']['queens county']['salesmen'] = 36
>>> for tup in nd.walk():
    print tup

('new jersey', 'mercer county', 'programmers', 81)
('new jersey', 'mercer county', 'plumbers', 3)
('new jersey', 'middlesex county', 'programmers', 81)
('new jersey', 'middlesex county', 'salesmen', 62)
('new york', 'queens county', 'salesmen', 36)
('new york', 'queens county', 'plumbers', 9) 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-03-11T17:17:40.263

至于“令人讨厌的 try/catch 块”：

```
d = {}
d.setdefault('key',{}).setdefault('inner key',{})['inner inner key'] = 'value'
print d 
```

产量

```
{'key': {'inner key': {'inner inner key': 'value'}}} 
```

您可以使用它从平面字典格式转换为结构化格式：

```
fd = {('new jersey', 'mercer county', 'plumbers'): 3,
 ('new jersey', 'mercer county', 'programmers'): 81,
 ('new jersey', 'middlesex county', 'programmers'): 81,
 ('new jersey', 'middlesex county', 'salesmen'): 62,
 ('new york', 'queens county', 'plumbers'): 9,
 ('new york', 'queens county', 'salesmen'): 36}

for (k1,k2,k3), v in fd.iteritems():
    d.setdefault(k1, {}).setdefault(k2, {})[k3] = v 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2011-03-07T16:48:34.257

`defaultdict()`是你的朋友！

对于二维字典，您可以执行以下操作：

```
d = defaultdict(defaultdict)
d[1][2] = 3 
```

对于更多维度，您可以：

```
d = defaultdict(lambda :defaultdict(defaultdict))
d[1][2][3] = 4 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2016-01-21T18:50:09.343

您可以使用 Addict：[https ://github.com/mewwts/addict](https://github.com/mewwts/addict)

```
>>> from addict import Dict
>>> my_new_shiny_dict = Dict()
>>> my_new_shiny_dict.a.b.c.d.e = 2
>>> my_new_shiny_dict
{'a': {'b': {'c': {'d': {'e': 2}}}}} 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-03-11T20:05:32.137

为了轻松迭代嵌套字典，为什么不写一个简单的生成器呢？

```
def each_job(my_dict):
    for state, a in my_dict.items():
        for county, b in a.items():
            for job, value in b.items():
                yield {
                    'state'  : state,
                    'county' : county,
                    'job'    : job,
                    'value'  : value
                } 
```

那么，如果你有你的复杂嵌套字典，迭代它就变得很简单：

```
for r in each_job(my_dict):
    print "There are %d %s in %s, %s" % (r['value'], r['job'], r['county'], r['state']) 
```

显然，您的生成器可以生成对您有用的任何格式的数据。

为什么要使用 try catch 块来读取树？在尝试检索密钥之前查询字典中是否存在密钥很容易（并且可能更安全）。使用保护子句的函数可能如下所示：

```
if not my_dict.has_key('new jersey'):
    return False

nj_dict = my_dict['new jersey']
... 
```

或者，一种可能有点冗长的方法是使用 get 方法：

```
value = my_dict.get('new jersey', {}).get('middlesex county', {}).get('salesmen', 0) 
```

但是对于一种更简洁的方式，您可能希望使用[collections.defaultdict](http://docs.python.org/library/collections.html#collections.defaultdict)，它是自 python 2.5 以来标准库的一部分。

```
import collections

def state_struct(): return collections.defaultdict(county_struct)
def county_struct(): return collections.defaultdict(job_struct)
def job_struct(): return 0

my_dict = collections.defaultdict(state_struct)

print my_dict['new jersey']['middlesex county']['salesmen'] 
```

我在这里对您的数据结构的含义做出假设，但是应该很容易根据您实际想要做的事情进行调整。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-03-11T17:19:27.467

我喜欢将其包装在一个类中并实现的想法，`__getitem__`这样`__setitem__`他们就实现了一种简单的查询语言：

```
>>> d['new jersey/mercer county/plumbers'] = 3
>>> d['new jersey/mercer county/programmers'] = 81
>>> d['new jersey/mercer county/programmers']
81
>>> d['new jersey/mercer country']
<view which implicitly adds 'new jersey/mercer county' to queries/mutations> 
```

如果你想变得花哨，你也可以实现类似的东西：

```
>>> d['*/*/programmers']
<view which would contain 'programmers' entries> 
```

但大多数情况下，我认为实现这样的事情会非常有趣：D

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-03-11T18:52:03.843

```
class JobDb(object):
    def __init__(self):
        self.data = []
        self.all = set()
        self.free = []
        self.index1 = {}
        self.index2 = {}
        self.index3 = {}

    def _indices(self,(key1,key2,key3)):
        indices = self.all.copy()
        wild = False
        for index,key in ((self.index1,key1),(self.index2,key2),
                                             (self.index3,key3)):
            if key is not None:
                indices &= index.setdefault(key,set())
            else:
                wild = True
        return indices, wild

    def __getitem__(self,key):
        indices, wild = self._indices(key)
        if wild:
            return dict(self.data[i] for i in indices)
        else:
            values = [self.data[i][-1] for i in indices]
            if values:
                return values[0]

    def __setitem__(self,key,value):
        indices, wild = self._indices(key)
        if indices:
            for i in indices:
                self.data[i] = key,value
        elif wild:
            raise KeyError(k)
        else:
            if self.free:
                index = self.free.pop(0)
                self.data[index] = key,value
            else:
                index = len(self.data)
                self.data.append((key,value))
                self.all.add(index)
            self.index1.setdefault(key[0],set()).add(index)
            self.index2.setdefault(key[1],set()).add(index)
            self.index3.setdefault(key[2],set()).add(index)

    def __delitem__(self,key):
        indices,wild = self._indices(key)
        if not indices:
            raise KeyError
        self.index1[key[0]] -= indices
        self.index2[key[1]] -= indices
        self.index3[key[2]] -= indices
        self.all -= indices
        for i in indices:
            self.data[i] = None
        self.free.extend(indices)

    def __len__(self):
        return len(self.all)

    def __iter__(self):
        for key,value in self.data:
            yield key 
```

例子：

```
>>> db = JobDb()
>>> db['new jersey', 'mercer county', 'plumbers'] = 3
>>> db['new jersey', 'mercer county', 'programmers'] = 81
>>> db['new jersey', 'middlesex county', 'programmers'] = 81
>>> db['new jersey', 'middlesex county', 'salesmen'] = 62
>>> db['new york', 'queens county', 'plumbers'] = 9
>>> db['new york', 'queens county', 'salesmen'] = 36

>>> db['new york', None, None]
{('new york', 'queens county', 'plumbers'): 9,
 ('new york', 'queens county', 'salesmen'): 36}

>>> db[None, None, 'plumbers']
{('new jersey', 'mercer county', 'plumbers'): 3,
 ('new york', 'queens county', 'plumbers'): 9}

>>> db['new jersey', 'mercer county', None]
{('new jersey', 'mercer county', 'plumbers'): 3,
 ('new jersey', 'mercer county', 'programmers'): 81}

>>> db['new jersey', 'middlesex county', 'programmers']
81

>>> 
```

**编辑：**现在使用通配符 ( `None`) 查询时返回字典，否则返回单个值。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-03-11T20:30:20.800

除非您的数据集将保持很小，否则您可能需要考虑使用关系数据库。它将完全满足您的需求：轻松添加计数、选择计数子集，甚至按州、县、职业或这些的任意组合汇总计数。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-10-19T18:47:35.937

我也有类似的事情。我有很多我这样做的案例：

```
thedict = {}
for item in ('foo', 'bar', 'baz'):
  mydict = thedict.get(item, {})
  mydict = get_value_for(item)
  thedict[item] = mydict 
```

但是要深入很多层次。“.get(item, {})” 是关键，因为如果还没有字典，它将创建另一个字典。与此同时，我一直在想办法更好地处理这个问题。现在有很多

```
value = mydict.get('foo', {}).get('bar', {}).get('baz', 0) 
```

所以相反，我做了：

```
def dictgetter(thedict, default, *args):
  totalargs = len(args)
  for i,arg in enumerate(args):
    if i+1 == totalargs:
      thedict = thedict.get(arg, default)
    else:
      thedict = thedict.get(arg, {})
  return thedict 
```

如果你这样做，效果是一样的：

```
value = dictgetter(mydict, 0, 'foo', 'bar', 'baz') 
```

更好的？我认同。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-04-09T04:25:21.250

您可以在 lambdas 和 defaultdict 中使用递归，无需定义名称：

```
a = defaultdict((lambda f: f(f))(lambda g: lambda:defaultdict(g(g)))) 
```

这是一个例子：

```
>>> a['new jersey']['mercer county']['plumbers']=3
>>> a['new jersey']['middlesex county']['programmers']=81
>>> a['new jersey']['mercer county']['programmers']=81
>>> a['new jersey']['middlesex county']['salesmen']=62
>>> a
defaultdict(<function __main__.<lambda>>,
        {'new jersey': defaultdict(<function __main__.<lambda>>,
                     {'mercer county': defaultdict(<function __main__.<lambda>>,
                                  {'plumbers': 3, 'programmers': 81}),
                      'middlesex county': defaultdict(<function __main__.<lambda>>,
                                  {'programmers': 81, 'salesmen': 62})})}) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-10-23T14:27:01.710

我曾经使用过这个功能。它安全、快速、易于维护。

```
def deep_get(dictionary, keys, default=None):
    return reduce(lambda d, key: d.get(key, default) if isinstance(d, dict) else default, keys.split("."), dictionary) 
```

例子 ：

```
>>> from functools import reduce
>>> def deep_get(dictionary, keys, default=None):
...     return reduce(lambda d, key: d.get(key, default) if isinstance(d, dict) else default, keys.split("."), dictionary)
...
>>> person = {'person':{'name':{'first':'John'}}}
>>> print (deep_get(person, "person.name.first"))
John
>>> print (deep_get(person, "person.name.lastname"))
None
>>> print (deep_get(person, "person.name.lastname", default="No lastname"))
No lastname
>>> 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-09-16T00:06:39.067

对于以下（从上面复制）有一种方法可以实现附加功能。我正在尝试使用嵌套字典将值存储为数组。

```
class Vividict(dict):
    def __missing__(self, key):
        value = self[key] = type(self)() # retain local pointer to value
    return value 
```

我目前的实现如下：

```
totalGeneHash=Vividict()

for keys in GenHash:
    for second in GenHash[keys]:
        if keys in sampleHash:
            total_val = GenHash[keys][second]
                totalGeneHash[gene][keys].append(total_val)
This is the error I get: AttributeError: 'Vividict' object has no attribute 'append' 
```

# django - Django re-group 没有按预期工作

> ID：635484
> 
> 赞同：9
> 
> 时间：2009-03-11T17:10:11.263
> 
> 标签：django

我最近开始学习 django。

我正在用 citylist 渲染我的模板，例如，

```
{'citylist': Cities.objects.all()} 
```

并希望在下面的模板中对国家/地区进行 reqroup（与 django-docs 相同）：

```
{% regroup citylist by country as coutrylist %}

<ul>
{% for country in countrylist %}
    <li>{{ country.grouper }}
    <ul>
        {% for c in country.list %}
        <li>{{ c.name }}</li>
        {% endfor %}
    </ul>
    </li>
{% endfor %}
</ul> 
```

但我得到了一些意想不到的结果，

```
France
  Strasbourg

Australia
  Penrith
  Sydney

US
  Larsen Bay

France
  Reims

US
  Avenal 
```

我不认为我在模板中做错了什么。还是它的一个错误？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-11T17:12:31.197

问题不在于代码，而在于您要注入的数据。

将您的上下文更改为

```
{'citylist': Cities.objects.all().order_by('country')} 
```

[django-docs](https://docs.djangoproject.com/en/1.5/ref/templates/builtins/)提到

> 解决这个问题的最简单的方法是确保在您的视图代码中数据是根据您想要的显示方式进行排序的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T00:10:52.650

我还想指出另一种解决方案的文档。 [http://docs.djangoproject.com/en/dev/ref/templates/builtins/#regroup](http://docs.djangoproject.com/en/dev/ref/templates/builtins/#regroup)

您可以在模板中对字典进行排序。

{% regroup citylist**|dictsort:"country"** by country as countrylist %}

# php - 列出用户最近在 PHP/MySQL 中的活动的最佳方法是什么？

> ID：635494
> 
> 赞同：0
> 
> 时间：2009-03-11T17:12:43.300
> 
> 标签：php, mysql

我想在不进行太多查询的情况下列出用户在我的网站上的最近活动。我有一张表格，其中列出了用户对日期所做的所有事情。

```
page_id - reference_id - reference_table - created_at - updated_at 
```

这`reference_id`是我需要在 reference_table 中搜索的 ID（例如：comments）。如果我要`SELECT`在我的活动表上做一个，我将不得不查询：

```
SELECT * FROM reference_table where id = reference_id LIMIT 1 
```

活动可以是评论、页面更新或订阅。根据它是哪一个，我需要从数据库中的其他表中获取不同的数据

例如，如果是评论，我需要获取作者姓名，评论，如果是回复，我需要获取原始评论用户名等。

我查看了 UNION 关键字来合并我的所有表，但我收到了错误

> 1222 - 使用的 SELECT 语句有不同的列数

并且使它工作似乎相当复杂，因为列的数量必须匹配，而且我的表中没有一个表具有相同数量的表，而且我不喜欢为了好玩而创建列。

我还研究了 CASE 语句，如果我没记错的话，它还需要匹配的列数（虽然我可能错了）。

有谁知道我如何在不进行太多查询的情况下列出用户最近的活动？

我正在使用 PHP 和 MySQL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T17:26:51.333

You probably want to split out the different activities into different tables. This will give you more flexiblity on how you query the data.

If you choose to use UNION, make sure that the you use the same number of columns in each select query that the UNION is comprised of.

**EDIT:** I was down-voted for my response, so perhaps I can give a better explanation.

**Split Table into Separate Tables and UNION**

I recommended this technique, because it will allow you to be more explicit about the resources for which you are querying. Having a single table for inserting is convenient, but you will always have to do separate queries to join with other tables to get meaningful information. Also, you database schema will be obfuscated by a single column being a foreign key for different tables depending on the data stored in that row.

You could have tables for comment, update and subscription. These would have their own data which could be queried on individually. If, say, you wanted to look at ALL user activity, you could somewhat easily use a UNION as follows:

```
(SELECT 'comment', title, comment_id AS id, created FROM comment)
UNION
(SELECT 'update', title, update_id as id, created FROM update)
UNION
(SELECT 'subscription', title, subscription_id as id, created 
  FROM subscription)
ORDER BY created desc 
```

This will provide you with a listing view. You could then link to the details of each type or load it on an ajax call.

You could accomplish this with the method that you are currently using, but this will actually eliminate the need for the 'reference_table' and will accomplish the same thing in a cleaner way (IMO).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T17:24:18.233

问题是 UNION 应该只用于将**相似**的记录集放在一起。如果您尝试统一两个不同的查询（例如，获取不同的列），这是一个错误。

If the nature of the queries is different (having different column count, or data types) you'll need to make several different queries and treat them all separately.

Another approach (less elegant, I guess) would be LEFT JOINing your activities table with all the others, so you'll end up with a recordset with a lot of columns, and you'll need to check for each row which columns should be used depending on the activity nature.

Again, I'd rather stick with the first one, since the second procudes a rather sparse recorset.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T17:57:18.887

With UNION you don't have to get all of the columns from each table, just as long as all of the columns have the same datatypes.

So you could do something like this:

```
SELECT name, comment as description
FROM Comments

UNION

SELECT name, reply as description
FROM Replies 
```

And it wouldn't matter if `Comments` and `Replies` have the same number of columns.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T18:41:24.617

This really depends on the amount of traffic on your site. The union approach is a straightforward and possibly the correct one, logically, but you'll suffer on the performance if your site is heavily loaded since the indexing of a UNIONed query is hard.

Joining might be good, but again, in terms of performance and code clarity, it's not the best of ways.

Another totally different approach is to create an 'activities' table, which will be updated with activity (in addition to the real activity, just for this purpose). In old terms of DB correctness, you should avoid this approach since it will create duplicate data on your system, I, however, found it very useful in terms of performance.

[Another side note about the UNION approach if you decide to take it: if you have difference in parameters length, you can SELECT bogus parameters on some of the unions, for example.. (SELECT UserId,UserName FROM users) UNION (SELECT 0,UserName from notes)

# .net - NHibernate - 12 个月/1 年和数据绑定

> ID：635509
> 
> 赞同：0
> 
> 时间：2009-03-11T17:17:08.547
> 
> 标签：.net, nhibernate, data-binding, datagrid, nhibernate-mapping

处理这个问题的最佳方法是什么我有一个应用程序，我经常必须将 12 个月的记录“透视”到一年的记录/对象中，以便能够在 DataGrid 中每行显示一年。到目前为止，我一直在使用一些丑陋的 T-SQL 在 DataSets 中进行这项工作，以实现枢轴。

我现在正在将此应用程序升级到 NHibernate，这是我遇到的一个问题。

例如，假设我有一个测试，我每月给一组学生做一次测试。我的 DDL 可能如下所示：

```
CREATE TABLE [Score](
    [ScoreId] [int] IDENTITY(1,1) NOT NULL,
    [StudentId] [int] NOT NULL,
    [Year] [int] NOT NULL, -- 4 digit year as an int
    [Month] [int] NOT NULL, -- 1 through 12 month value as int
    [TestScore] [int] NOT NULL
) 
```

我想在 DataGrid 中显示（每个学生/年一条记录）这些字段：
学生姓名、年份、1 月、2 月、3 月、4 月、5 月、6 月、7 月、8 月、9 月、10 月、11 月、12 月

使用 NHibernate 处理此类任务的正常方法是什么？你会怎么处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-13T22:17:09.437

在我看来，最好将 NHibernate 用作纯 ORM 并将转轴留给您的代码。这意味着使用 NHibernate 将表中的行原样读取到与表列具有一对一关系的类中，然后使用类上的方法（或 getter 中具有某些逻辑的属性）来做旋转。

在纯 DDD 中，您应该使用服务来执行此操作（而不是将此逻辑放入域对象中）。

在此之后，您可以将结果绑定到网格以进行演示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T23:07:49.657

我想我会把这个添加到对话中。

该[线程](http://bytes.com/groups/net-c/564731-datagridview-datapropertyname-displaying-nested-object-information)讨论了覆盖类的 ToString() 。我想我可以为我的 MonthValue 对象执行此操作...只需让它们通过 ToString() 返回分数；

但是，这并不能解决映射问题。根据对此问题的其他评论，点语法在 DataPropertyName 中对我不起作用。

# c# - 业务验证逻辑代码异味

> ID：635519
> 
> 赞同：10
> 
> 时间：2009-03-11T17:18:48.730
> 
> 标签：c#, .net, entity-framework, business-logic

考虑以下代码：

```
partial class OurBusinessObject {
    partial void OnOurPropertyChanged() {
        if(ValidateOurProperty(this.OurProperty) == false) {
            this.OurProperty = OurBusinessObject.Default.OurProperty;
        }
    }
} 
```

即当in的值`OurProperty`发生`OurBusinessObject`变化时，如果该值无效，则设置为默认值。这种模式让我觉得代码有异味，但这里的其他人（在我的雇主那里）不同意。你怎么认为？

**编辑添加**：我被要求添加解释为什么这被认为是好的。这个想法是，业务对象可以验证自己的属性，并在验证失败的情况下设置干净的默认值，而不是让业务对象的生产者验证数据。此外，人们认为，如果验证规则发生变化，业务对象生产者将不必更改其逻辑，因为业务对象将负责验证和清理数据。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-11T17:22:54.493

这绝对是可怕的。祝你在生产环境中调试问题好运。它唯一能导致的就是掩盖错误，这些错误只会出现在其他地方，在那里它们来自哪里根本不明显。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T17:22:29.563

我想我必须同意你的看法。这肯定会导致逻辑意外返回默认值的问题，这可能很难调试。

至少，应该记录这种行为，但这似乎更像是引发异常的情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-11T17:28:46.273

对我来说，这看起来像是症状，而不是实际问题。真正发生的是，setter for`OurProperty`未能保留在`OnOurPropertyChanged`事件中使用的原始值。如果你这样做了，突然之间就可以更容易地选择如何进行。

就此而言，您真正想要的是在分配实际发生*之前*`OnOurPropertyChanging`从 setter 引发的事件。这样，您可以首先允许或拒绝分配。否则有一小段时间你的对象是无效的，这意味着类型不是线程安全的，如果你认为并发是一个问题，你就不能指望一致性。

 ** * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T17:38:40.180

绝对是一个有问题的做法。

如何将无效值分配给此属性？这是否表明调用代码中的某处存在错误，在这种情况下您可能想立即知道？或者用户输入错误，在这种情况下应该立即通知*他们？*

一般来说，“快速失败”可以更容易地跟踪错误。在幕后默默地分配默认值类似于“魔术”，只会给必须维护代码库的人造成混乱。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T17:23:19.780

除了厌恶“代码气味”这个词，你可能是对的——取决于它的来源，默默地改变值可能不是一件好事。最好确保您的值有效，而不是仅仅恢复为默认值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T18:01:08.503

我强烈建议在设置属性之前对其进行重构以进行验证。

你总是可以有一个更像的方法：

```
T GetValidValueForProperty<T>(T suggestedValue, T currentValue); 
```

甚至：

```
T GetValidValueForProperty<T>(string propertyName, T suggestedValue, T currentValue); 
```

如果这样做，在设置属性之前，您可以将其传递给业务逻辑进行验证，业务逻辑可以返回默认属性值（您当前的行为）或（在大多数情况下更合理），返回 currentValue，所以设置没有效果。

这将更像是：

```
`T OurProperty
{
    get
    {
        return this.propertyBackingField;
    }
    set
    {
        this.propertyBackingField = this.GetValidValueForProperty(value, this.propertyBackingField);
    }
}` 
```

`您做什么并不重要，但重要的是在更改当前值之前进行验证。如果您在确定新值是否合适之前更改了值，那么从长远来看，您是在自找麻烦。`

 `* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T17:27:18.647

它可能会或可能不会“闻起来”，但我更倾向于“是的，它闻起来”。

将 OurProperty 设置为默认值是否有这样做的合乎逻辑的原因，或者在代码中这样做是否方便？有可能（但在实践中不太可能）设计出一种预期行为的场景，但我猜在大多数情况下，您应该抛出异常并在某处干净地处理它。

将值设置为默认值是否会让您更接近或远离应用程序应该如何工作的*功能规范描述？*

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-11T17:38:22.257

您正在验证完成后的更改吗？验证应该在busyness 属性改变之前完成。

回答您的问题：该代码段中提供的解决方案可能会在生产中产生大问题，您不知道默认值是由于输入无效还是因为其他东西将值设置为默认值而出现在那里

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-11T18:05:43.003

不了解上下文或业务规则就很难说。不过一般来说，您应该只在输入时进行验证，并且可能在持久性之前再验证一次，但是您这样做的方式实际上并不允许您进行验证，因为您不允许属性包含无效值。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-11T18:08:26.270

如果被要求使用无效值，我认为您的验证逻辑应该引发异常。如果您的消费者想要使用默认值，它应该通过特殊的、记录在案的值或通过其他方法明确要求它。

我认为唯一可以原谅的例外是，例如，规范化大小写，例如在电子邮件字段中检测重复项。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-11T18:12:31.613

此外，这世界上为什么是局部的？除了生成的代码框架之外，对任何东西使用部分类本身就是一种代码味道，因为您可能会使用它们来隐藏复杂性，无论如何都应该将其拆分！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-11T18:25:42.970

我同意 Grzenio 并补充说，在域层（也称为业务对象）中处理验证错误的最佳方法是生成异常。该异常可能会一直传播到 UI 层，在那里它可以被处理并与用户交互纠正。但是，根据所涉及的功能和技术，这可能并不总是可行的，在这种情况下，您可能应该在 UI 层（可能除了领域层之外）进行验证。它不太理想，但可能是您唯一可行的选择。在任何情况下，将其设置为默认值都是一件可怕的事情，并且会导致几乎无法诊断的细微错误。如果在广泛的范围内完成，您将很快拥有一个无法维护的系统（尤其是如果您没有单元测试支持您）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-11T18:40:21.750

我反对这一点的一个论点如下。假设业务对象的用户/生产者意外输入了无效值。然后这个模式会掩盖这个事实并默认清理数据。但是处理这个问题的正确方法是抛出一个错误并让用户/生产者验证/清理他们的输入数据。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-17T12:43:51.163

我会说，实现 PropertyChanging 并允许业务逻辑批准/拒绝一个值，然后为无效值抛出异常。

这样，您永远不会有无效的值。那，你不应该改变用户的信息。如果用户向数据库添加一个条目，并为自己的记录跟踪它会怎样？您的代码会将值重新分配给默认值，而他现在正在跟踪错误的信息。最好尽快通知用户。

# reporting-services - Reporting Services 2005 订阅

> ID：635521
> 
> 赞同：0
> 
> 时间：2009-03-11T17:18:59.323
> 
> 标签：reporting-services, ftp, subscriptions

我正在尝试将 Reporting Services 2005 的报告发送到 FTP 位置，但这似乎不是订阅设置中的选项。这有可能做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T17:28:27.523

有这样的第三方工具：http: [//www.christiansteven.com/products/sql-rd/](http://www.christiansteven.com/products/sql-rd/)

如果买东西不是一种选择，您可以在删除报告后创建一个 FTP 流程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-12T17:19:20.233

You can code your own custom extension to SSRS to "send" reports directly to file or even to a printer from a subscription. The are samples provided by MS that show you how to do both if you don't mind getting into some code (I think they have examples for VB and C#) and XML config files.

I've implemented the printing extension before, very handy.

Sorry it's taken so long for my suggestion, been in other kinds of development lately.

HTH

# python - Django：在内存中打开上传的文件；在 Form Clean 方法中？

> ID：635524
> 
> 赞同：19
> 
> 时间：2009-03-11T17:20:30.833
> 
> 标签：python, django

我需要在我的 Form clean 方法中验证上传的 XML 文件的内容，但我无法打开该文件进行验证。它接缝，在 clean 方法中，文件尚未从内存（或临时目录）移动到目标目录。

例如，以下代码不起作用，因为文件尚未移动到该目标。它仍在内存中（或临时目录）：

```
xml_file = cleaned_data.get('xml_file')
xml_file_absolute = '%(1)s%(2)s' % {'1': settings.MEDIA_ROOT, '2': xml_file}
xml_size = str(os.path.getsize(xml_file_absolute)) 
```

当我查看“cleaned_data”变量时，它显示：

```
{'xml_file': <InMemoryUploadedFile: texting.nzb (application/octet-stream)>} 
```

`cleaned_data.get('xml_file')`仅将“texting.nzb”作为字符串返回。

是否有另一种方法可以访问内存（或临时目录）中的文件？

* * *

同样，这是在我的表单`clean`方法中，它与默认管理视图相关联。我一次又一次地被告知，所有验证都应该在表单中处理，而不是视图。正确的？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-11T17:29:45.990

我假设您已使用以下方式将表单绑定到文件：

```
my_form = MyFormClass(request.POST, request.FILES) 
```

如果你有，一旦表单被验证，你可以使用 request.FILES 字典访问文件内容本身：

```
if my_form.is_valid():
    data = request.FILES['myfile'].read() 
```

request.FILES['myfile'] 对象是一个 UploadedFile 对象，因此它支持类似文件的读/写操作。

如果您需要从表单的`clean`方法（或清洁机器的任何方法）中访问文件内容，那么您做对了。`cleaned_data.get('xml_file')`返回一个[UploadedFile](http://docs.djangoproject.com/en/dev/topics/http/file-uploads/#uploadedfile-objects)对象。该`__str__`对象的方法只是打印出字符串，这就是为什么您只看到文件名的原因。但是，您可以访问全部内容：

```
xml_file = myform.cleaned_data.get('xml_file')
print xml_file.read() 
```

文档的这一部分有一些很好的例子：[http ://docs.djangoproject.com/en/dev/topics/http/file-uploads/](http://docs.djangoproject.com/en/dev/topics/http/file-uploads/)

# java - 您知道的所有 Maven Archetype 目录的 URL 是什么？

> ID：635543
> 
> 赞同：45
> 
> 时间：2009-03-11T17:24:31.773
> 
> 标签：java, maven-2, maven-plugin, maven-archetype

[Maven 原型](http://maven.apache.org/plugins/maven-archetype-plugin/)是“模板”，您可以通过它快速生成给定框架或项目类型的运行示例。我正在尝试编译当前在网络上活动的所有 Maven 原型目录的列表。

[从有关目录文件的 Maven 文档中](http://maven.apache.org/plugins/maven-archetype-plugin/specification/archetype-catalog.html)：

> 关于原型的知识存储在目录中。
> 
> 目录是 xml 文件。
> 
> Archetype 插件与内部目录捆绑在一起。默认使用这个。
> 
> Archetype 插件可以使用来自本地文件系统和 HTTP 连接的目录。

到目前为止，我已经收集了发布目录的存储库列表，但很想看看是否有人知道更多：

```
mvn archetype:generate
-DarchetypeCatalog=local
-DarchetypeCatalog=remote
-DarchetypeCatalog=http://repo.fusesource.com/maven2
-DarchetypeCatalog=http://cocoon.apache.org
-DarchetypeCatalog=http://download.java.net/maven/2
-DarchetypeCatalog=http://myfaces.apache.org
-DarchetypeCatalog=http://tapestry.formos.com/maven-repository
-DarchetypeCatalog=http://scala-tools.org
-DarchetypeCatalog=http://www.terracotta.org/download/reflector/maven2/ 
```

相同的链接：1）[FuseSource](http://repo.fusesource.com/maven2/archetype-catalog.xml) 2） [Cocoon](http://cocoon.apache.org/archetype-catalog.xml) 3）[Java.net](http://download.java.net/maven/2/archetype-catalog.xml) 4）[MyFaces](http://myfaces.apache.org/archetype-catalog.xml) 5）[Tapestry](http://tapestry.formos.com/maven-repository/archetype-catalog.xml) 6）[Scala 目录](http://scala-tools.org/archetype-catalog.xml) 7）[Terracotta 目录](http://www.terracotta.org/download/reflector/maven2/archetype-catalog.xml)

您会注意到，如果存储库实际上发布了一个原型目录（以上所有内容都这样做），您将获得一个 UI 提示，其中包含在该目录中找到的所有选项`archetype-catalog.xml`。例如：

```
mvn archetype:generate -DarchetypeCatalog=http://scala-tools.org

[INFO] No archetype defined. Using maven-archetype-quickstart (org.apache.maven.archetypes:maven-archetype-quickstart:1.0)
Choose archetype:
1: http://scala-tools.org -> scala-archetype-simple (A simple scala project)
2: http://scala-tools.org -> lift-archetype-blank (A blank/empty liftweb project)
3: http://scala-tools.org -> lift-archetype-basic (A basic liftweb project (with DB, css, ...))
Choose a number:  (1/2/3): 
```

例如，如果您想直接查看 Scala 目录文件，可以[浏览到 http://scala-tools.org/archetype-catalog.xml](http://scala-tools.org/archetype-catalog.xml)

但是，如果存储库不提供 archetype-catalog.xml，那么正如 PascalT 所说，您需要提前知道名称（不太方便）并将其传递到命令行参数中。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-13T05:24:23.210

~~老实说，我真的不明白建立所有目录的列表的意义。对我来说，首先选择一个项目然后在需要时添加目录看起来更“自然”。这就是为什么 IMO 在原型列表中具有更多价值的原因。无论如何，您都需要他们的名字，即使您的列表中有所有目录。~~

无论如何，这里有一些候选人；

~~*   Grails 在[http://snapshots.repository.codehaus.org/](http://snapshots.repository.codehaus.org/)中有原型。~~
*   ~~Atlassian 在[https://maven.atlassian.com/repository/public/中有原型](https://maven.atlassian.com/repository/public/)~~

编辑：在马修澄清原型目录之后。

我误解了一些概念，我的答案并不明确和正确。

目录的意义在于**不必提前知道原型的名称**。它们用于发布原型并允许`mvn archetype:generate`列出原型。因此，在使用`mvn archetype:generate`.

对于没有目录的原型，用户必须键入一个必须记录在某处的可怕命令（因为它需要了解工件）。

关于我的提议：

*   Atlassian 的原型在内部目录中。**不是一个好的提议。**

*   Grails 原型不在内部目录或已发布的`archetype-catalog.xml`. **不是一个好的提议。**

*   [ServiceMix在](http://servicemix.apache.org/)[http://servicemix.apache.org/tooling/](http://servicemix.apache.org/tooling/)有目录（基于`http://servicemix.apache.org/tooling/<version>/archetype-catalog.xml`模式）。**有效的提议。**

* * *

我在挖掘这个时学到了一件有趣的事情。maven 家伙提供了一个很好的工具，可以帮助开发原型的人们创建目录 XML：`archetype:crawl`目标基本上是爬取本地 Maven 存储库以搜索原型并默认生成/更新`archetype-catalog.xml`文件`~/.m2/repository`。项目，人们只需要定期运行，例如：

```
mvn archetype:crawl -Dcatalog=/var/www/html/archetype-catalog.xml
```

Grails 不提供目录。要创建一个项目，[我们必须运行](http://www.grails.org/Maven+Integration)：

```
mvn org.apache.maven.plugins:maven-archetype-plugin:2.0-alpha-4:generate -DarchetypeGroupId=org.grails \
-DarchetypeArtifactId=grails-maven-archetype \
-DarchetypeVersion=1.0 \
-DarchetypeRepository=http://snapshots.repository.codehaus.org \
-DgroupId=example -DartifactId=my-app 
```

但是一旦我们这样做了，我们的本地存储库中就有了原型。所以如果我们输入：

```
mvn archetype:crawl -Dcatalog=/home/<me>/.m2/archetype-catalog.xml 
```

原型被列出，`~/.m2/archetype-catalog.xml`我们现在也可以使用`mvn archetype:generate`for Grails（参见选项 5）：

```
mvn archetype:generate
...
[INFO] No archetype defined. Using maven-archetype-quickstart (org.apache.maven.archetypes:maven-archetype-quickstart:1.0)
Choose archetype:
1: local -> maven-archetype-archetype (archetype)
2: local -> maven-archetype-j2ee-simple (j2ee)
3: local -> maven-archetype-quickstart (quickstart)
4: local -> maven-archetype-webapp (webapp)
5: local -> grails-maven-archetype (maven-project)
6: internal -> appfuse-basic-jsf (AppFuse archetype for creating a web application with Hibernate, Spring and JSF)
... 
```

这当然是一个（非常好的）解决方法，它可能会产生副作用（你不会看到新版本的原型）。实际上，我不认为 archetype:crawl 目标是为此用途而设计的。我希望所有项目都发布他们的原型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T04:34:58.383

兵马俑有一个，但我不知道 URL 副手...会发回。此外，我过去曾使用过[AppFuse](http://appfuse.org/) ( [http://static.appfuse.org/releases/](http://static.appfuse.org/releases/) ) 和[Webtide](http://www.webtide.com/)的原型，尽管我不知道在哪里可以找到它们的原型目录。

Terracotta 存储库和目录在这里： [http ://www.terracotta.org/download/reflector/maven2/](http://www.terracotta.org/download/reflector/maven2/)

也许这很有用： http: [//docs.codehaus.org/display/MAVENUSER/Archetypes+List](http://docs.codehaus.org/display/MAVENUSER/Archetypes+List)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-16T12:30:48.630

Nexus 生成并由 M2eclipse 使用的 nexus 索引了解所有原型，并允许您在从 ide 创建新的 maven 项目时选择它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-01T06:19:13.950

对于 Maven 原型列表，请参阅此链接[http://www.myjeeva.com/2012/06/exclusive-maven-archetype-list/](http://www.myjeeva.com/2012/06/exclusive-maven-archetype-list/)（您会发现大约 607 个原型）。

在使用`mvn archetype:generate`命令时`Choose a number or apply filter (format: [groupId:]artifactId, case sensitive contains): 197:`

从上面的链接提供**原型编号。**

*注意：默认值为 197*

*   *197 -> org.apache.maven.archetypes:maven-archetype-quickstart （包含示例 Maven 项目的原型。）*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-05T22:47:53.010

Codehaus 还有另一种资源，可以在“网络”上找到非常强大的原型列表。 [http://docs.codehaus.org/display/MAVENUSER/Archetypes+List](http://docs.codehaus.org/display/MAVENUSER/Archetypes+List)

# asp.net - 使用 JQuery 访问 ASP.net Web 服务时出错 - JSONP

> ID：635547
> 
> 赞同：2
> 
> 时间：2009-03-11T17:25:46.123
> 
> 标签：asp.net, javascript, web-services, jquery, jsonp

请查看下面的代码并帮助我找出我在 Web 服务代码中做错了什么。我想设置一个可以使用 JSONP 使用的 asp.net Web 服务。我在客户端使用 Jquery 来访问该站点。即使设置了正确的属性，我的 Web 服务仍然会发出 xml，因此 aynch 调用失败。

网络服务

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
 [System.Web.Script.Services.ScriptService]
public class WebService : System.Web.Services.WebService {

    public WebService () {

        //Uncomment the following line if using designed components 
        //InitializeComponent(); 
    }

    [WebMethod]
    [ScriptMethod(ResponseFormat= ResponseFormat.Json, XmlSerializeString=false, UseHttpGet=true)]
    public string HelloWorld(int id, string __callback) {
        return  __callback + "({message: 'Hello World'})";
    }

} 
```

网络服务响应：

```
<?xml version="1.0" encoding="utf-8"?>
<string xmlns="http://tempuri.org/">test({message: 'Hello World'})</string> 
```

网络配置：

```
<webServices>
    <protocols>
        <add name="HttpGet"/>
        <add name="HttpPost"/>
    </protocols>
</webServices>
<httpHandlers>
    <remove verb="*" path="*.asmx"/>
    <add verb="*" path="*.asmx" validate="false" 
        type="System.Web.Script.Services.ScriptHandlerFactory, 
            System.Web.Extensions, Version=3.5.0.0, 
            Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add verb="*" path="*_AppService.axd" validate="false" 
        type="System.Web.Script.Services.ScriptHandlerFactory, 
            System.Web.Extensions, Version=3.5.0.0, 
            Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add verb="GET,HEAD" path="ScriptResource.axd" 
        type="System.Web.Handlers.ScriptResourceHandler, 
            System.Web.Extensions, Version=3.5.0.0, 
            Culture=neutral, PublicKeyToken=31BF3856AD364E35" 
        validate="false"/>
</httpHandlers>
<httpModules>
    <add name="ScriptModule" 
        type="System.Web.Handlers.ScriptModule, System.Web.Extensions, 
            Version=3.5.0.0, Culture=neutral, 
            PublicKeyToken=31BF3856AD364E35"/>
</httpModules> 
```

Javascript

```
$.ajax({
    type: "GET",
    contentType: "application/json; charset=utf-8",
    url: "http://localhost:54404/jsonp/webservice.asmx/HelloWorld?id=2&__callback=?", //?jsonp=MatchSvcCallback
    dataType: "jsonp",
    data: {},
    //jsonp : "MatchSvcCallback",
    success: function(msg) {
    alert("Inside success callback function"); // not being called

    },
    error: function(xhr, msg){
        var response = JSON.parse(xhr.responseText);

    }

}); 
```

js 代码与处理程序一起使用，但由于 xml 响应而导致 web 服务失败。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T19:19:16.507

我认为这里的问题是因为 jQuery`Content-Type`在使用`$.ajax()`. 仅当请求类型为“POST”时才会发送。这似乎适用于`dataType: "jsonp"`和`dataType: "json"`。

[我尝试了您的示例并观看了Fiddler](http://www.fiddler2.com/fiddler2/)中的请求/响应交换，果然我没有看到`Content-Type: application/xml; charset=UTF-8`在 HTTP GET 请求的标头中发送。如果使用 HTTP POST，则确实会发送标头。我猜这个标头的存在是 ASP.NET Web 服务管道决定是返回 JSON 还是 XML 格式的响应的一个线索。

看来您不是唯一遇到此问题的人，请参阅优雅代码网站上的以下文章：

[从 JQuery 调用远程 ASP.NET Web 服务](http://elegantcode.com/2008/12/02/calling-remote-aspnet-web-services-from-jquery/)

解决方案似乎是以下之一：

*   如上文所述，使用 a`HttpModule`将标头注入请求流中。`Content-Type: application/xml; charset=UTF-8`

*   `HttpHandler`正如您在使用 ASP.NET Web 服务之前所解释的那样，将a用于端点。

*   在以下文章中尝试 Rick Strahl 的基于页面的方法（`HttpHandler`无论如何都有效）：[JSONP for cross-site Callbacks](http://www.west-wind.com/Weblog/posts/107136.aspx)。

# php - 与 iSeries 的 ODBC 连接产生奇数的结果

> ID：635550
> 
> 赞同：1
> 
> 时间：2009-03-11T17:26:45.873
> 
> 标签：php, mysql, odbc, ibm-midrange, unixodbc

我在 Ubuntu 8.04 LTS 上使用 UnixODBC 和 PHP 5.2.4，并尝试从 IBM i 上的表中提取所有结果并将它们复制到本地 MySQL 表中。

就代码而言，它没有任何错误，但我最终得到的行数比 IBM i 上包含的行数更多。

我应该得到 25,613 行，但 PHP 报告说有 25,630 行被插入到 MySQL 数据库中：

```
$counter = 0;
while($row = odbc_fetch_array($result)) {
    //Insert into MySQL using Zend Framework
    $counter++;
}
echo $counter; 
```

当我查看 MySQL 数据库时，有些行实际上是重复的。[我在odbc_fetch_array()](http://us.php.net/manual/en/function.odbc-fetch-array.php#76627)文档上看到了有关访问 IBM i 时出现异常行为的注释，但尝试该解决方案会导致脚本运行和运行，但似乎从未完成。

关于检查什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T17:35:46.007

每次都重复相同的行吗？如果是这样，这些记录是否有任何独特之处可以暗示它们为什么被复制？

也许使用另一个绑定来获得结果——比如`odbc_fetch_row()`. 说什么`odbc_num_rows()`？

这些技术和其他技术可能会帮助您定位错误。

# vba - 使用 vba 在 Outlook 中访问另一个邮箱

> ID：635558
> 
> 赞同：3
> 
> 时间：2009-03-11T17:29:39.530
> 
> 标签：vba, outlook

我的 Outlook 中有两个邮箱。

一个是我的，当我登录到我的电脑时它会自动让我登录，另一个是用于邮件退回。

我真的需要访问邮件帐户的收件箱，但我似乎做不到。

而且我没有办法让邮件帐户的邮箱成为我的默认邮箱

这是我到目前为止的代码：

```
Public Sub GetMails()

    Dim ns As NameSpace
    Dim myRecipient As Outlook.Recipient
    Dim aFolder As Outlook.Folders

    Set ns = GetNamespace("MAPI")

    Set myRecipient = ns.CreateRecipient("mail@mail.pt")
    myRecipient.Resolve
    If myRecipient.Resolved Then
        MsgBox ("Resolved")
        Set aFolder = ns.GetSharedDefaultFolder(myRecipient, olFolderInbox)
    Else
        MsgBox ("Failed")
    End If

End Sub 
```

我遇到的问题是

`Set aFolder = ns.GetSharedDefaultFolder(myRecipient, olFolderInbox)`

我得到了 Resolved msgbox，所以我知道它正在工作，但之后我收到一个错误：

> 运行时错误

这并没有说明错误本身。

有人可以帮我吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T11:13:49.457

如果您要访问的文件夹不是 Exchange 文件夹，则需要找到它，如果是 Exchange 文件夹，请尝试登录命名空间。

**登录命名空间**

```
 Set oNS = oApp.GetNamespace("MAPI")
  oNS.Logon 
```

**查找文件夹** 据我所知，这段代码来自 Sue Mosher。

```
Public Function GetFolder(strFolderPath As String) As Object 'MAPIFolder
' strFolderPath needs to be something like
'   "Public Folders\All Public Folders\Company\Sales" or
'   "Personal Folders\Inbox\My Folder" ''

Dim apOL As Object 'Outlook.Application '
Dim objNS As Object 'Outlook.NameSpace '
Dim colFolders As Object 'Outlook.Folders '
Dim objFolder As Object 'Outlook.MAPIFolder '
Dim arrFolders() As String
Dim I As Long

On Error GoTo TrapError

    strFolderPath = Replace(strFolderPath, "/", "\") 
    arrFolders() = Split(strFolderPath, "\")

    Set apOL = CreateObject("Outlook.Application")
    Set objNS = apOL.GetNamespace("MAPI")

    On Error Resume Next

    Set objFolder = objNS.Folders.Item(arrFolders(0))

    If Not objFolder Is Nothing Then
        For I = 1 To UBound(arrFolders)
            Set colFolders = objFolder.Folders
            Set objFolder = Nothing
            Set objFolder = colFolders.Item(arrFolders(I))

            If objFolder Is Nothing Then
                Exit For
            End If
        Next
    End If

    Set GetFolder = objFolder
    Set colFolders = Nothing
    Set objNS = Nothing
    Set apOL = Nothing

End Function 
```

# winapi - ListBox.FindString 最坏情况下的运行时是什么？O（n），O（n log n），O（1）？

> ID：635561
> 
> 赞同：2
> 
> 时间：2009-03-11T17:29:58.300
> 
> 标签：winapi, runtime

出于好奇，ListBox.FindString(string) 的最坏情况运行时是什么？MSDN 在其 API 文档中没有说明这一点。

我强烈怀疑它是 O(n)，我有一个排序列表，并且 O(log n) 或 O(1) 会很好，有没有办法改变 FindString 在运行时使用的排序算法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T17:58:06.157

不管在列表框中有大量项目到重要的程度是否是一个好主意（这对用户来说可能很麻烦，具体取决于您的实现。），我猜测 O(n)因为我相信它会进行不区分大小写的部分匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T18:07:24.120

实际上，您*可以*看到该方法的作用，因为 Microsoft 通过“Microsoft 参考源代码”（[clicky](http://referencesource.microsoft.com/)）提供了他们的 .net 基类源代码 - 您可以在 VS 中单步执行 BCL 代码（也可以通过Rotor，.net 的开源实现，但是 WinForms 代码不可用 IIRC）。

检查代码（我不想在这里粘贴，以防它违反 MS 的许可证），很明显该方法是**O(n)**最坏情况。

基本上，该方法循环遍历列表中的每个项目，如果到达底部，则返回列表顶部（通过巧妙地使用永远可爱的 mod (%) 运算符和计数器）。显然，在最坏的情况下（即搜索的项目不在列表中）是 O(n)，它必须遍历列表的每个成员。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T17:33:02.427

如果您在 ListBox 中有足够的字符串，那么 FindString() 的工作方式的大 O 很重要，您需要查看另一种存储字符串的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T17:56:28.093

> "查找 ListBox 中以指定字符串开头的第一项。"

这听起来像是从列表开始的线性搜索，但没有办法确定。

您无法更改 ListBox 使用的算法，但您可以扩展 ListBox 并让您的扩展类做任何您想做的事情。:D

# oracle - 通过ALUI Portal网关获取客户端IP地址

> ID：635562
> 
> 赞同：1
> 
> 时间：2009-03-11T17:30:04.960
> 
> 标签：oracle, ip-address, portal, oracleportal, plumtree

目前使用 Oracle/BEA/Plumtree ALUI Portal 6.1，并试图显示客户端的 IP 地址。问题是由于此内容正在被网关，所以当我调用时，门户服务器的地址正在出现

```
<%= request.getRemoteAddr() %> (<%= request.getRemoteHost() %>) 
```

我几乎在做[这个链接](http://www.scribd.com/doc/30729/Chapter-2-Understanding-ALUI-Portal-with-helloworld-Aqualogic-Developers-Notebook)的 java 等价物，但它不能正常工作。不确定 IDK 中是否存在某些内容，或者是否存在需要更改的配置设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:05:45.720

事实证明，使用 PEI（Plumtree 事件接口）可以做到这一点。这是一个两部分的过程：

*   首先创建一个 PEI，将客户端 IP 地址存储在 Portal Session 中。为此，这里有一个参考：[http ://edocs.beasys.com/alui/devdoc/docs5x/Customizing_the_Portal_UI/Using_PEIs/PlumtreeDevDoc_Customizing_PEI_Step2Implement.htm](http://edocs.beasys.com/alui/devdoc/docs5x/Customizing_the_Portal_UI/Using_PEIs/PlumtreeDevDoc_Customizing_PEI_Step2Implement.htm)
*   请参阅门户会话以获取客户端 IP 地址。

# jquery - “走” JSON 响应并填充表单字段——更有效的方法？

> ID：635565
> 
> 赞同：7
> 
> 时间：2009-03-11T17:31:22.803
> 
> 标签：jquery, json

我知道有一种更优雅/更有效的方法（在 php 中我会使用 foreach），但是使用 jQuery，我如何遍历 JSON 响应的 var/val 对并使用与字段名称相同的 id 填充表单字段在 JSON 响应中？

这是我的 JSON 响应：

```
[{"field":"svendor_name","value":"Vendor Name Inc."},{"field":"svendor_addr1","value":"1234 Vendor Lane."},{"field":"svendor_addr2","value":"Suite 100"},{"field":"svendor_city"
,"value":"Vendorville"},{"field":"svendor_state","value":"CA"},{"field":"svendor_zip","value":"90210"},{"field"
:"svendor_phone","value":"800-555-1234"}] 
```

这是我用于填充表单的 jQuery 代码：

```
$(document).ready(function()
{
    $('#svendor_name').bind("change", function()
    {
        var svendor = $("#svendor_name").val();
        svendor = svendor.replace(/&/g, '*');
        $.getJSON("get_vendors.php?sname=" + svendor,
        function(data)
        {
            $.each(data,
                function(i, item)
                {
                    if(item.field == "svendor_name")
                    {
                        $("#svendor_name").val(item.value);
                    }
                    else if(item.field == "svendor_addr1")
                    {
                        $("#svendor_addr1").val(item.value);
                    }
                    else if(item.field == "svendor_addr2")
                    {
                        $("#svendor_addr2").val(item.value);
                    }
                    else if(item.field == "svendor_city")
                    {
                        $("#svendor_city").val(item.value);
                    }
                    else if(item.field == "svendor_state")
                    {
                        $("#svendor_state").val(item.value);
                    }
                    else if(item.field == "svendor_zip")
                    {
                        $("#svendor_zip").val(item.value);
                    }
                    else if(item.field == "svendor_phone")
                    {
                        $("#svendor_phone").val(item.value);
                    }
                    else if(item.field == "svendor_id")
                    {
                        $("#svendor_id").val(item.value);
                    }
            });
        });
    });
}); 
```

这一切都很好，但我真的想避免所有 if/else 语句，只使用从 getJSON 方法返回的数据来确定哪些字段填充了哪些值。什么是更清洁/更有效的方法？

——尼古拉斯

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-11T17:34:53.043

您可以通过将 $.each 替换为以下内容来摆脱所有“if”语句：

```
$.each(data, function(i, item){
  $("#"+item.field).val(item.value);
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-11T17:35:30.657

这有什么问题？

```
$.each(data,
    function(i, item) {
        $("#" + item.field).val(item.value);
    }
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-10-28T16:48:28.547

如果您的结果如下所示：

```
[{"field1":"value1","field2":"value2"}] 
```

然后 Seb 和 Chetan 提供的代码工作

```
$.each(data, function(i, item){
  $("#"+item.field).val(item.value);
}); 
```

如果您的结果如下所示：

```
{"field1":"value1","field2":"value2"} 
```

然后使用此代码

```
$.each(data, function(field, value){
  $("#"+field).val(value);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T17:38:04.753

我注意到元素 ID 与 JSON 中的字段相同，那么：

```
$(document).ready(function() {
    $('#svendor_name').bind("change", function()
    {
        var svendor = $("#svendor_name").val();
        svendor = svendor.replace(/&/g, '*');
        $.getJSON("get_vendors.php?sname=" + svendor,
        function(data) {
                $.each(data, function(i, item) {
                    $('#' + item.field).val(item.value);
                });
        });
    });
}); 
```

# c# - 以编程方式打印文档

> ID：635573
> 
> 赞同：2
> 
> 时间：2009-03-11T17:34:28.240
> 
> 标签：c#, .net, windows

虽然我无法让运行 Win7 64 的桌面连接到我们的网络打印机，但我希望能够使用[Input Director](http://www.inputdirector.com/)将文件粘贴到我笔记本电脑上的共享中。我想要一个 FileSystemWatcher 来提取它们并打印，然后删除它们。我该怎么做？我认为我需要以某种方式连接到外壳，这意味着我的应用程序不能成为服务，但我在这里真的一无所知。

我已经安装了 Input Director，所以我可以将光标从桌面桌面屏幕移到笔记本电脑桌面上，然后右键单击要打印的文件。但是，我仍然对学习打印的方法感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T17:50:46.673

我想这取决于您要打印的内容，因为该应用程序负责将文档呈现给打印设备，而不是外壳本身。

这难道不是为您的打印机找到正确驱动程序的漫长道路吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T17:49:49.983

[System.Drawing.Printing](http://msdn.microsoft.com/en-us/library/system.drawing.printing.aspx)将帮助您做您想做的事。无需挂接到 shell，因此您可以将其作为服务来执行。每当您检测到新文件时，只需将其发送到打印机即可。

对于更多涉及的类型（Word 文档等），您可以使用 Interop 库来使用 Word 本身来打印文档。例如，[这里](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.documentclass.printout(VS.80).aspx)是 Interop.Word PrintOut 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T17:50:00.293

鉴于您的要求（非生产、非服务器解决方案），为什么不直接在您的笔记本电脑上启动一个命令行应用程序并让 FileSystemWatcher 挂钩并打印它们？或者，您可以编写一个“活”在图标托盘中的应用程序。

至于如何打印它们，那是逐个应用程序特定的，但对于许多应用程序，您可以让 shell 弄清楚并使用带有打印操作的[ShellExecute API。](http://msdn.microsoft.com/en-us/library/bb762153(VS.85).aspx)

# php - 从一个域管理多个网站

> ID：635574
> 
> 赞同：5
> 
> 时间：2009-03-11T17:34:51.423
> 
> 标签：php, .htaccess

我一直在寻找一段时间来找到完成以下系统的解决方案。

我想在域A 上构建一个PHP 系统。在此域 A 上，我将允许管理员“创建”一个新网站。本网站仅包含文本片段，这些文本均存储在数据库中。这个，我知道怎么做。

但是，现在我想让浏览到 domainB 的访问者有可能被无形地重定向到例如 domainA.com/gateway.php?refdomain=domainB&page=xxx 或类似的东西。我有一个模糊的想法，这应该由 .htaccess 完成，但我真的不知道如何以最简单的方式做到这一点。例如，如果 domainB 上有一些 POST 或 GET 请求，这应该会继续工作。链接到[http://www.domainB.com/test.gif](http://www.domainB.com/test.gif)的图像也应该从 www.domainA.com 不可见地加载。

我也知道有一些CMS系统（例如drupal）允许这个功能，所以有可能，我只是不知道怎么做。

感谢您提供任何可能为我指明正确方向的建议，亲切的问候，数字

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T17:46:04.080

您是否在同一台机器上托管这两个？如果是这样，Apache 中的[VirtualHosts可以为您解决这个问题。](http://httpd.apache.org/docs/2.2/vhosts/)

[mod_alias](http://httpd.apache.org/docs/2.2/mod/mod_alias.html)和[mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)也可能对您有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T17:42:39.283

如果您使用 Drupal 之类的 CMS，您应该能够使用 Portal Alias 分配这些内容。通过使用别名，您将能够分配不同的域以指向所创建的不同“站点”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T17:47:25.743

基本上，您需要将所有域指向同一个目录（可能在[vhosts](http://httpd.apache.org/docs/2.0/vhosts/)中使用通配符），然后设置[urlrewrite](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)；以[这个问题](https://stackoverflow.com/questions/522452/how-do-i-do-url-rewriting-in-php)为例，它可以在 .htaccess 文件或 Apache 配置中。

所有进来的请求都将转到同一个 gateway.php，您可以使用`$_SERVER['REDIRECT_QUERY_STRING']`,`$_SERVER['REQUEST_URI']`和 $`_SERVER['SERVER_NAME']`例如提取当前域和请求。见[`$_SERVER`](http://www.php.net/manual/en/reserved.variables.server.php)。然后，您将能够在 gateway.php 中发送正确的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T17:47:59.427

好的，这是一个非常简单的例子：

```
RewriteCond %{HTTP_HOST} .
RewriteCond %{HTTP_HOST} !^www\.domainA\.com
RewriteRule (.*) http://www.domainA.com/gateway.php?realpath=$1 [L,QSA] 
```

然后，您可以使用 parse_url 在网关脚本中解析“realpath”并采取适当的措施。

如果你想的话，你可以用你的重写规则变得更复杂，为图像等设置单独的规则

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-11T17:38:05.457

您可以使用重定向标头..

# asp.net - 将 ASP.NET 应用程序从 1.1 Framework 转换为 2.0 有任何问题吗？

> ID：635581
> 
> 赞同：0
> 
> 时间：2009-03-11T17:35:53.510
> 
> 标签：asp.net

我们正在将许多 ASP.NET 1.1 Web 应用程序迁移到新服务器。我们希望在此过程中将它们*全部*转换为 2.0。理想情况下，最终甚至不会在新服务器上安装 1.1 框架。我们从未遇到过将应用程序从 1.1 转换为 2.0 的重大问题。我们最大的问题一直是将 ConfigurationSettings.AppSettings 更改为 ConfigurationManager.AppSettings。

有没有其他人遇到过重大问题？

有什么重要的事情需要提前注意或考虑吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T17:42:55.070

这是关于如何使用 Visual Studio 2005 将 asp.net 应用程序从 1.1 转换为 2.0 的一个很好的资源。

[将 ASP.NET 网站从 1.1 版转换为 2.0 版](http://www.pointercorp.com/Convert_ASPDOTNET_11_20.htm)

编辑：这是用于转换应用程序的 MSDN 分步指南：

[http://msdn.microsoft.com/en-us/library/aa479567.aspx](http://msdn.microsoft.com/en-us/library/aa479567.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T18:01:02.263

转换到 2.0 时，我遇到的唯一主要问题是编译的正则表达式的性能比我们使用它的方式要差得多。将其切换为使用静态 Regex.Replace() 方法解决了很多问题。

我找不到我当时找到的文章，但如果我找到了，我会把它添加到这篇文章中。

最重要的是确保您不仅要测试它的功能等效性，还要测试它的性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T18:09:10.607

我见过的最大问题是新的默认设置是使用网站“项目”。如果您运行的是 Visual Studio 2005 SP1，这应该不是问题，他们已在其中纠正了此问题。

我还遇到了一些奇怪的问题，我认为可能涉及 vwd.webinfo 文件。我们的 Web 服务应用程序在我的计算机上运行良好，但在构建服务器上，它试图成为一个网站“项目”，所以它没有编译。没有编译 == 没有符号。

# python - 将标题插入 Django 表单

> ID：635583
> 
> 赞同：3
> 
> 时间：2009-03-11T17:37:13.600
> 
> 标签：python, django, forms

我希望我的表单输出如下内容：

```
Name: ___________
Company: ___________

Interested in
-------------
Foo: [ ]
Bar: [ ]
Baz: [ ] 
```

也就是说，我想在我的表单输出中间插入“有兴趣”的标题。

一种方法是写出每个字段的模板代码，并根据需要插入标题。但是，我不想这样做。我怀疑这与可以做我想做的事情的表单集有关。

*有*没有办法做我想做的事，还是我只需要接受它并接受我需要为此写出我的模板？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T20:22:21.957

Django 表单集不是要走的路：如果您需要同时编辑多个对象，则使用它们。HTML 字段集更像是正确的方法。我想您可以将名称和公司字段分组到一个字段集中，然后将兴趣字段分组到另一个字段集中。

在 DjangoSnippets 上，您可以找到[有助于分组的模板标签](http://www.djangosnippets.org/snippets/663/)。

使用此代码段，您可以将视图中的分组定义为

```
fieldsets = (
    ('', {'fields': ('name','company')}),
    ('Interested in', {'fields': ('foo','bar','baz')})
) 
```

将其与表单一起传递给模板，并使用

```
{% draw_form form fieldsets %} 
```

我不希望在视图中定义分组，因为它主要是表示问题，应该属于视图，但到底是什么，这似乎可以完成工作！

*muhuk*的解决方案虽然看起来比这更优雅......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T20:13:24.537

与[`FieldsetMixin`](http://github.com/muhuk/django-formfieldset/tree/master)您一起获得类似管理员的字段集。您可以像这样创建表单：

```
from django.forms import Form
from formfieldset.forms import FieldsetMixin

class MyForm(Form, FieldsetMixin):
    fieldsets = (
        (u'', {'fields': ['name', 'company']}),
        (u'Interested in', {'fields': ['foo', 'bar', 'baz']}),
    )

    # rest of the form 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-13T15:43:05.070

这有点像 hack，但您可以定义一个`HeaderWidget`只呈现其值的：

```
from django.forms.util import flatatt
from django.utils.html import format_html

class HeaderWidget(forms.widgets.Widget):
    def render(self, name, value, attrs=None):
        attrs.update(self.attrs)
        return format_html('<div{0}>{1}</div>', flatatt(attrs), value) 
```

然后使用该小部件在所需位置添加一个字段：

```
header = forms.CharField(
    widget=HeaderWidget(attrs={'class': 'my-css-class'}),
    initial='Interested in',
    required=False,
    label='') 
```

一个小缺点是您将获得随表单发布的标题“值”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T20:14:44.970

表单字段保留您定义表单类或模型的顺序，如果它是模型的表单。在模板中，您可以遍历所有指定它们如何呈现的字段，您可以使用 ifequal 标签检查您要查找的字段并指定不同的呈现方式。

看：

[http://docs.djangoproject.com/en/dev/topics/forms/?from=olddocs#looping-over-the-form-s-fields](http://docs.djangoproject.com/en/dev/topics/forms/?from=olddocs#looping-over-the-form-s-fields)

# exception - 实时 Grails webapp 中的邮件异常日志

> ID：635590
> 
> 赞同：4
> 
> 时间：2009-03-11T17:39:58.197
> 
> 标签：exception, grails, gsp

我希望我的 Grails Web 应用程序为到达最终用户的每个异常发送一封电子邮件。

基本上我正在寻找一种优雅的方式来实现相当于：

```
 try {
      // ... all logic/db-access/etc required to render the page is executed here ...
  }
  catch (Exception e) {
      sendmail("exception@example.com", "An exception was thrown while processing a http-request", e.toString);
  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T20:02:40.520

事实证明，这个确切的问题几天前[在 Grails 邮件列表中得到了回答。](http://www.nabble.com/How-to-send-email-on-unhandled-exception-td22247616.html)

解决方案是将以下内容添加到 Config.groovy 的 log4j 部分：

```
log4j {
    ...
    appender.mail='org.apache.log4j.net.SMTPAppender'
    appender.'mail.To'='email@example.com'
    appender.'mail.From'='email@example.com'
    appender.'mail.SMTPHost'='localhost'
    appender.'mail.BufferSize'=4096
    appender.'mail.Subject'='App Error'
    appender.'mail.layout'='org.apache.log4j.PatternLayout'
    appender.'mail.layout.ConversionPattern'='[%r] %c{2} %m%n'
    rootLogger="error,stdout,mail"
    ...
    // rootLogger="error,stdout" (old rootLogger)
} 
```

加上将 sun-javamail.jar 和 activation.jar 添加到 lib/-文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T17:47:37.023

假设您可以从 groovy 执行此操作，您将需要为此使用诸如[log4j](http://logging.apache.org/log4j/1.2/index.html)之类的日志框架，它具有可以将日志数据附加到数据库、[发送电子邮件](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/net/SMTPAppender.html)等的记录器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T01:13:05.253

你也可以看看Grails 提供的*exceptionHandler机制；*我觉得很简单；但足够强大，可以满足我所有自定义和干净的异常处理需求。到目前为止，还没有用 1.1 测试过这种方法；但适用于 1.0.3。

```
class BootStrap {

   def exceptionHandler

   def init = { servletContext ->
      exceptionHandler.exceptionMappings =
        [ 'NoSuchFlowExecutionException' :'/myControler/myAction',
        'java.lang.Exception' : '/myController/generalAction']
   }

  def destroy = { }
} 
```

详细博客在这里：

[http://blog.bruary.net/2008/03/grails-custom-exception-handling.html](http://blog.bruary.net/2008/03/grails-custom-exception-handling.html)

# .net - 从给定存储过程名称的 SQLDataSource 中获取参数列表

> ID：635593
> 
> 赞同：5
> 
> 时间：2009-03-11T17:40:40.363
> 
> 标签：.net, sql-server

给定分配给其 SelectCommand 属性的存储过程的名称，是否有一种理智的方法可以从 SqlDataSource 获取预期参数的列表？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-11T20:39:40.260

您可以使用 SqlCommandBuilder.DeriveParameters 方法返回有关与存储过程关联的参数的信息。遍历集合将允许您确定参数名称、数据类型、方向等。

```
SqlCommand cmd = new SqlCommand();
SqlConnection conn = new SqlConnection("myConnectionString");
cmd.CommandType = CommandType.StoredProcedure;
cmd.CommandText = "myStoredProcName";
cmd.Connection = conn;

conn.Open();
SqlCommandBuilder.DeriveParameters(cmd);
conn.Close();

SqlParameterCollection collection = cmd.Parameters; 
```

查看[SqlParameterCollection](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparametercollection.aspx)和[SqlParameter](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparametercollection.aspx)类定义以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T17:55:14.807

我不确定您是否可以以某种方式直接在 ADO.NET 环境中执行此操作 - 但您始终可以查询“sys”系统视图以获取该信息：

```
select * from sys.parameters
where object_id in 
      (select object_id from sys.procedures where name = 'YourSProc') 
```

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T17:49:18.673

我没有 VS.NET 来试用它，但是 .Prepare() 可能会为你做这个:)

或者你可以只添加参数。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-01T15:50:04.607

还有：

```
EXEC sp_sproc_columns 'YourSProc' 
```

# java - 从 xsd 架构生成 ActionScript 值对象

> ID：635594
> 
> 赞同：2
> 
> 时间：2009-03-11T17:40:44.653
> 
> 标签：java, apache-flex, actionscript, xsd, value-objects

是否有任何工具可用于将 xsd 架构中定义的类型（可能包括也可能不包括其他 xsd 文件）转换为 ActionScript 值对象？我已经在谷歌上搜索了一段时间，但似乎找不到任何工具，我正在考虑编写这样的工具是否会比手动编写我们的值对象节省更多时间。

我一直在考虑的另一种可能性是使用 XMLBeans 之类的工具将模式定义的类型转换为 Java 类，然后在 ActionScript 中转换这些类。但是，我开始意识到那里有大量的 java -> as3 转换器，一般的共识似乎是它们可以工作，即，我不知道哪种工具适合。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T09:34:02.493

对于 Java -> AS 生成，请查看 Granite Data Services 项目中的 GAS3：

[http://www.graniteds.org/confluence/display/DOC/2.+Gas3+Code+Generator](http://www.graniteds.org/confluence/display/DOC/2.+Gas3+Code+Generator)

这也是您可以自己编写的东西，特别是如果您利用 Ant 之类的工具并编写自定义任务来处理它。事实上，我去年就做了这个并且开源了它：

[https://github.com/cliffmeyers/Java2As](https://github.com/cliffmeyers/Java2As)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T18:13:08.867

我也没有任何类型的翻译。我所做的是有一个由 ActionScript 对象包装的 XML 对象。然后，对于转换 xml->whatever 和whatever->XML 的每个值，您都有一个 getter/setter。不过，您仍然必须编写 getter/setter，但您可以拥有一个适合您的宏/代码片段句柄。

所以对于像这样的XML：

```
<person>
    <name>Bob</name>
    ...
</person> 
```

然后我们有一个 XML Object Wrapper 类并对其进行扩展。一般

```
class XMLObjectWrapper
{
    var _XMLObject:XML;

    function set XMLObject(xml:XML):void
    {
        _XMLObject = xml;
    }

    function get XMLObject():XML
    {
        return _XMLObject;
    }
}

class person extends XMLObjectWrapper
{
    function set name(value:String):void
    {
        _XMLObject.name = value;
    }

    function get name():String
    {
        return _XMLObject.name;
    }

} 
```

# asp.net - 下拉列表和 jQuery

> ID：635608
> 
> 赞同：1
> 
> 时间：2009-03-11T17:46:38.663
> 
> 标签：asp.net, jquery

ASP.NET`DropDownList`具有属性`Enabled="false"`，但是否可以`jQuery`将属性设置为`Enabled="true"`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T17:57:27.170

您的意思是 ASP.NET 控件 DropDownList 和服务器属性“已启用”吗？

`enable="false"`ASP.NET 以这种方式呈现 DropdownList 服务器控件：

```
<select id="myDropDownListId" name="myDropDownListId" disabled="disabled"> 
```

因此，您可以使用这个 jQuery 片段来删除该属性：

```
$('#myDropDownListId').removeAttr('disabled'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T17:47:57.240

```
$("input").attr("disabled", "false"); 
```

在这种情况下，我会为输入分配一个 CssClass（我假设您使用的是 .Net webforms），然后使用该 CssClass 作为选择器。由于一旦页面被渲染就不能设置**server**属性，你必须使用 DOM 的“disabled”参数；因此，您必须设置 disabled=false，而不是 enabled=true。

# crystal-reports - 如何在水晶报表查看器中设置默认导出名称

> ID：635611
> 
> 赞同：1
> 
> 时间：2009-03-11T17:47:20.393
> 
> 标签：crystal-reports

在 ASP.NET 页面上，当用户从 Crystal Report Viewer(CRV) 查看报表时，他们可以导出报表（例如导出为 PDF）。导出的默认文件名是 CRV 的 ID。

我想将默认名称设置为基于报告参数的名称。（例如“2008 年销售额”）。

我知道我可以添加一个指向该页面的链接，然后我可以编写一个解决方案，在该解决方案中我在代码中生成 PDF 并将其流式传输到浏览器，但我希望可能有一种方法可以在 Crystal 中实现这一点报告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-04T16:46:05.640

```
// You could pass the parameters to the web page 
// where you have theCrystalReportViewer control
protected void Page_Load(object sender, EventArgs e)
{
  string reportId = Request["rid"];
  string reportTitle = Request["rtitle"];

  ReportDocument reportDocument = HttpContext.Current.Session[reportId] as ReportDocument;
  this.CommonCrystalReportViewer.ReportSource = reportDocument;
  this.CommonCrystalReportViewer.DataBind();

  // Set the default export file name for the report.
  this.CommonCrystalReportViewer.ID = reportTitle;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-24T10:49:56.657

本机有一个 ReportExporter 类来代替 ReportViewer 类，但它不再受支持。有一些类似的第三部分。

我使用此代码示例：

从报告中获取参数值（如果您还没有从 Session、QueryString 或其他地方获取）

```
string myParamName="XXX";
object myParamValue;
foreach (ParameterField field in reportDocument.ParameterFields)
            {
               if (string.Compare(field.Name.TrimStart('@'), myParamName, true) == 0)
                    myParamValue= field.CurrentValues;
            } 
```

使用需要的报告名称导出

```
string myReportName = "sales for " + myParamValue.ToString() + ".pdf";
try
    {
     reportDocument.ExportToHttpResponse( 
                 ExportFormatType.PortableDocFormat
                 ,Response, true, myReportName);
    }
catch (System.Threading.ThreadAbortException)
    {
        //System.Threading.ThreadAbortException is thrown  
        //because, Response.End is called internally in ExportToHttpResponse method:
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T17:56:55.630

如果您使用 Visual Studio 2008 创建报表，您可以编辑创建的 ReportClass 以添加您的 DefaultName 属性。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-02-18T08:49:17.873

```
protected void Page_Init(object sender, EventArgs e) {
    ...
    // Set the default export file name for the report.
    this.mainReportViewer.ID = reportTitle;
    ...
} 
```

必须`reportViewer` `id`在`Page_Init`功能上进行更改，否则将不起作用。

# javascript - 书签：将隐藏的 iframe 附加到页面并加载 url

> ID：635622
> 
> 赞同：9
> 
> 时间：2009-03-11T17:50:02.697
> 
> 标签：javascript, html, iframe, bookmarklet, router

我有一个用于重置路由器的书签。我只需要访问并让页面完成加载，然后我的路由器开始重置。

```
javascript:(function(){w=window.open("http://192.168.0.1/goform/formReboot","","width=1,height=1");self.focus();window.onload=w.close();})(); 
```

但它会在弹出窗口中打开。

我的新想法是使用 javascript bookmaklet 将隐藏的 iframe 动态附加到我正在使用的页面，然后在隐藏的 iframe 中打开 url。这甚至可能吗？

我愿意就如何做到这一点提出更好的建议。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-11T18:21:54.087

更简单的方法是创建一个新的 IMG 元素：

```
(function(){
    (new Image()).src = "http://192.168.0.1/goform/formReboot";
})(); 
```

作为书签：

```
javascript:void((function(){(new Image()).src = "http://192.168.0.1/goform/formReboot";})()); 
```

* * *

或者，如果这不起作用，这是您要求的“iframe”创建者：

```
(function(){
    var i = document.createElement('iframe');
    i.style.display = 'none';
    i.onload = function() { i.parentNode.removeChild(i); };
    i.src = 'http://192.168.0.1/goform/formReboot';
    document.body.appendChild(i);
})(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T18:33:26.290

可以做到吗？当然！

1.  使用所需的任何参数创建一个 iframe 元素
2.  将其作为最后一个子元素添加到 body 元素
3.  完毕！

这是一个示例（所有内容都将在一行中进行）：

```
javascript:var%20ifra=document.createElement('iframe');
ifra.src="http://www.chron.com";
ifra.setAttribute("height","230");
ifra.setAttribute("width","360");
void(document.body.appendChild(ifra)); 
```

# .net - Crystal Reports - TestConnectivity 在开发机器上返回 true，但在测试机器上返回 false

> ID：635623
> 
> 赞同：1
> 
> 时间：2009-03-11T17:50:06.690
> 
> 标签：.net, winforms, crystal-reports, report

我在客户端服务器上有一个 SQLServer 2005 数据库。我与他们的服务器建立了 VPN 连接。我正在使用此处的连接代码

当我从本地开发机器上运行 winforms 应用程序时，它运行良好，报告显示效果很好。当我从测试机运行应用程序时，它失败了。我已经跟踪并发现它在 TestConnectivity 方法上失败了。尽管我没有更改代码中的任何内容，但还是会发生这种情况。

我正在使用相同的 VPN 信息，并且我知道我可以从那台机器访问数据库。客户端也有问题，他们在同一个网络上。

我在两台 PC 上都使用 Windows XP SP3

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T21:49:27.367

我没有在测试机器上安装 SQLServer 本机客户端，但它安装在我的开发机器上（由于安装了 SQLServer）。

# c# - 有没有一种简单的方法可以打印出我的点网 Windows 表单？

> ID：635627
> 
> 赞同：3
> 
> 时间：2009-03-11T17:51:46.030
> 
> 标签：c#, winforms, printing

我刚刚创建了一个用于请求零件的数据库应用程序。

它有几种形式，一种用于请求者，一种用于主管批准，一种用于采购批准，另一种供文员使用以了解订购什么。

现在我是无纸化的忠实粉丝，但我的雇主真的很喜欢他们的纸。有没有一种简单的方法可以将我的 Windows 表单复制到纸上？

我还应该补充一点，我仅限于使用 2.0 .Net 框架

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T18:05:16.560

这是一个快速的方法。您可以清理代码以使其适合您的需求：

```
 public static class FormExtensions
    {
        public static void PrintForm(this Form f)
        {
            PrintDocument doc = new PrintDocument();
            doc.PrintPage += (o, e) =>
            {
                Bitmap image = new Bitmap(f.ClientRectangle.Width, f.ClientRectangle.Height);
                f.DrawToBitmap(image, f.ClientRectangle);

                e.Graphics.DrawImage(image, e.PageBounds);
            };

            doc.Print();
        }
    } 
```

这会将表单拉伸到页面大小。如果需要，您可以调整 DrawImage 方法调用的第二个参数以将其绘制到其他位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T17:54:29.300

这是[来自 MSDN 的代码示例，可以满足](http://msdn.microsoft.com/en-us/library/aa287529(VS.71).aspx)您的要求：

```
[System.Runtime.InteropServices.DllImport("gdi32.dll")]
public static extern long BitBlt (IntPtr hdcDest, int nXDest, int nYDest, int nWidth, int nHeight, IntPtr hdcSrc, int nXSrc, int nYSrc, int dwRop);
private Bitmap memoryImage;
private void CaptureScreen()
{
   Graphics mygraphics = this.CreateGraphics();
   Size s = this.Size;
   memoryImage = new Bitmap(s.Width, s.Height, mygraphics);
   Graphics memoryGraphics = Graphics.FromImage(memoryImage);
   IntPtr dc1 = mygraphics.GetHdc();
   IntPtr dc2 = memoryGraphics.GetHdc();
   BitBlt(dc2, 0, 0, this.ClientRectangle.Width, this.ClientRectangle.Height, dc1, 0, 0, 13369376);
   mygraphics.ReleaseHdc(dc1);
   memoryGraphics.ReleaseHdc(dc2);
}
private void printDocument1_PrintPage(System.Object sender, System.Drawing.Printing.PrintPageEventArgs e)
{
   e.Graphics.DrawImage(memoryImage, 0, 0);
}
private void printButton_Click(System.Object sender, System.EventArgs e)
{
   CaptureScreen();
   printDocument1.Print();
} 
```

有一些注意事项 - 这里没有异常检查，而且您需要完全信任运行才能使用非托管 BitBlt API - 但这可能是打印 Windows 窗体表单的最简单方法，只要它是显示在屏幕上。

# java - Java 泛型

> ID：635629
> 
> 赞同：6
> 
> 时间：2009-03-11T17:52:35.687
> 
> 标签：java, generics, casting

我想实现一个采用`Object`as 参数的方法，将其转换为任意类型，如果失败则返回`null`。这是我到目前为止所拥有的：

```
public static void main(String[] args) {
    MyClass a, b;
    a = Main.<MyClass>staticCast(new String("B"));
}

public static class MyClass {
}

public static <T> T staticCast(Object arg) {
    try {
        if (arg == null) return null;
        T result = (T) arg;
        return result;
    } catch (Throwable e) {
        return null;
    }
} 
```

不幸的是，类转换异常永远不会在`staticCast()`函数体中抛出/捕获。尽管我明确说模板类型应该`String staticCast(Object arg)`是. 有什么帮助吗？谢谢。`String result = (String) arg;``MyClass`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-11T18:09:40.137

因为泛型类型信息在运行时被擦除，所以转换为泛型类型的标准方法是使用`Class`对象：

```
public static <T> T staticCast(Object arg, Class<T> clazz) {
    if (arg == null) return null;
    if (!clazz.isInstance(arg))
        return null;
    T result = clazz.cast(arg);
    return result;
} 
```

然后像这样调用它：

```
a = Main.staticCast("B", MyClass.class); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-11T17:54:11.563

你不能做你想做的事……至少不能这样。编译器删除了所有信息，因此您最终将 (T) 变成了演员表中的 Object - 这很有效。

问题是稍后你正在做 MyClass = (String)object; 这是不允许的。

您绕过了编译器检查并使其在运行时失败。

那么你到底想要做什么呢？如果您告诉我们为什么要这样做，我们可能会告诉您 Java 的做法。

鉴于您的评论，您可能会尝试以下操作：

```
public class Main
{
    public static void main(String[] args)
    {
        String a;
        MyClass b;
        a = staticCast(new String("B"), String.class);
        b = staticCast(new String("B"), MyClass.class);
        System.out.println(a);
    }

    public static class MyClass
    {
    }

    public static <T> T staticCast(Object arg, final Class clazz)
    {
        // edit - oops forgot to deal with null...
        if(arg == null)
        {
            return (null);
        }

        // the call to Class.cast, as mmeyer did, might be better... probably is better... 
        if(arg.getClass() != clazz)
        {
            // Given your answer to Ben S...
            return (null);

            // throw new ClassCastException("cannot cast a " + arg.getClass() + " to a " + clazz);
        }

        return ((T)arg);
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T18:01:23.153

你的意思是像[`Class<T>.cast(Object obj)`](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#cast(java.lang.Object))？

就像是：

```
Class.forName("YourClass").cast(obj); 
```

应该做你想做的。

请注意，这很臭，可能是设计不佳的标志。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T17:57:49.900

不要将 Java 泛型误认为是 C++ 模板。只有一个使用不同类型擦除调用的 staticCast 方法，而不是每个 T 一个。

根本不使用泛型，我会这样写：

```
public static void main(String[] args) {
    MyClass a, b;
    a = (MyClass)Main.staticCast(new String("B"), MyClass.class);
}

public static class MyClass {
}

public static staticCast(Object arg, Class class) {
        if (arg != null && class.isAssignableFrom(arg))
          return arg;
        return null;
} 
```

或者使用泛型从另一个答案中窃取：

```
public static <T> T staticCast(Object arg, Class<T> class) {
        if (arg != null && class.isAssignableFrom(arg))
        {
           T result = class.cast(arg);
           return result;
        }
        return null;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T18:14:16.587

我同意 Ben 的观点，但是，我更喜欢以下表示法：

```
MyClass.class.cast(obj); 
```

# java - 如何获得两个一对多关联的加入？

> ID：635630
> 
> 赞同：1
> 
> 时间：2009-03-11T17:52:39.150
> 
> 标签：java, sql, hibernate, activerecord, join

我有两个休眠实体用户和博客。用户可以对多个标签感兴趣。博客可以属于多个标签。对于用户，我如何找到属于用户感兴趣的标签的博客？

我需要类似的东西

```
Select * from Blog where Blog.Tags IN User.Tags 
```

除了 SQL 或 HQL 不允许在 IN 子句中进行此类比较

我目前使用的解决方案是：

1.  生成一个 VIEW USER_BLOGS，它是连接表 USER_TAGS 和 BLOG_TAGS 的笛卡尔积。
2.  为视图定义一个实体 UserBlog 并使用它来过滤 HQL 查询中的博客：

    ```
    Select * 
    from Blog 
    where Blog.id 
    IN (Select blog_id from UserBlog where user_id = "CurrentUser") 
    ```

我确信这是一个常见的场景。是否有一个纯 Hibernate 或 HQL 解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T18:16:19.390

你在寻找这样的东西吗？

```
select b.* 
  from blog b 
  join blog_tags bt on bt.blog_id = b.id
  join user_tags ut on ut.tag = bt.tag
  where ut.user_id = (this_user) 
```

与评论相反，我相信 HQL 确实允许显式连接（我可能错了，但请参阅[http://www.hibernate.org/hib_docs/reference/en/html/queryhql-joins.html](http://www.hibernate.org/hib_docs/reference/en/html/queryhql-joins.html)）。在任何情况下，它都可以在没有显式连接的情况下完成：

```
select b.* 
  from blog b, blog_tags bt, user_tags ut 
  where ut.user_id = (this_user) 
    and bt.blog_id = b.id 
    and ut.tag     = bt.tag 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-14T11:56:14.063

对于 MarkusQ 的解决方案，我必须为 UserTag 和 BlogTag 等连接表声明实体以在 HQL 查询中使用。

我之前创建 USER_BLOGS 视图的解决方案太慢了。

这是在没有任何其他实体的情况下工作的 HQL 查询：

```
select b.* from Blog blog, User user, Tag tag
where tag in elements (user.tags)
and tag in elements (blog.tags)
and user.id = (current_user) 
```

如果您在此或更好的解决方案中发现任何问题，请发布您的答案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T18:33:50.813

公平的 HQL 有 IN 例如。元素中的 somecat (cat.kittens)

[http://www.hibernate.org/hib_docs/reference/en/html/queryhql.html](http://www.hibernate.org/hib_docs/reference/en/html/queryhql.html)

本章纯粹是关于查询的，其中很大一部分是关于处理集合和连接的。格力高频

# svn - 我可以使用项目的 SVN 修订号设置环境变量吗？

> ID：635632
> 
> 赞同：4
> 
> 时间：2009-03-11T17:53:54.730
> 
> 标签：svn, batch-file, environment-variables

我正在尝试获取项目的修订号并将其保存到变量中。我知道我可以通过 svnversion 命令获取修订号，但我不确定如何存储它。我正在使用常规的 Windows 命令提示符。基本上我正在尝试做类似的事情： set svnVersion= %svnversion% 但我不知道怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T18:07:03.780

要在批处理文件中将变量的输出设置为 svnversion 的输出，您必须这样做：

```
for /f "delims=" %%a in ('svnversion') do @set myvar=%%a

echo %myvar% 
```

* * *

不同的方法：如果你有 TortoiseSVN，你也可以使用**SubWCRev.exe**。请参阅 [将项目修订号添加到我的项目中？](http://tortoisesvn.net/node/18)或[ASP.Net MVC 中的自动 SVN 修订编号](http://www.fatlemon.co.uk/2008/12/automatic-svn-revision-numbering-in-aspnet-mvc/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-08T10:28:53.300

如果您需要来自远程存储库（如本地未签出），您可以执行此操作

```
for /f "delims=: tokens=1,2" %%a in ('svn info %SVN_REPO_URL%') do (
  if "%%a"=="Revision" (
    set /a RELEASE_REVISION=%%b
  )
) 
```

我在发布过程中使用它来从标签中获取修订号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T18:09:35.177

在 bash 中（通过 Cygwin）：

```
svn info | grep -i "Revision" | cut -d ' ' -f 2 
```

然后，您可以在 bash shell 脚本中使用它来将值存储在变量中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T17:57:06.843

“svn info”子命令将告诉您工作副本中的修订号。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T18:09:48.000

就像是：

```
svn version > ver.txt
set /p ver= < ver.txt
del ver.txt
echo %ver% 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T18:02:35.367

看看这是否有帮助：[更改修订号](https://stackoverflow.com/questions/562087/change-revision-number-in-subversion-even-if-the-file-not-change-in-the-commit)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-19T12:08:29.257

这是使用管道 findstr 获取单行的替代方法：

```
FOR /F "tokens=2" %%G IN ('svn info ^| findstr /B Revision:') DO SET SVN_REVISION=%%G
echo SVN_REVISION: %SVN_REVISION%

FOR /F "tokens=2" %%G IN ('svn info ^| findstr /B URL:') DO SET SVN_URL=%%G
echo SVN_URL: %SVN_URL% 
```

# c# - GC.KeepAlive 与使用

> ID：635640
> 
> 赞同：15
> 
> 时间：2009-03-11T17:55:17.380
> 
> 标签：c#, garbage-collection, keep-alive

在他[关于防止应用程序的多个实例](http://www.ai.uga.edu/~mc/SingleInstance.html)的文章中，Michael Covington 介绍了以下代码：

```
static void Main()                  // args are OK here, of course
{
    bool ok;
    m = new System.Threading.Mutex(true, "YourNameHere", out ok);

    if (! ok)
    {
        MessageBox.Show("Another instance is already running.");
        return;
    }

    Application.Run(new Form1());   // or whatever was there

    GC.KeepAlive(m);                // important!
} 
```

他解释说需要 GC.KeepAlive(m) 来防止垃圾收集器提前收集互斥锁，因为没有额外的引用。

我的问题：将互斥体包装在 using 中会做同样的事情吗？也就是说，以下内容还会阻止 GC 从我身下拉出地毯吗？

```
static void Main()                  // args are OK here, of course
{
    bool ok;
    using (var m = new System.Threading.Mutex(true, "YourNameHere", out ok))
    {
        if (! ok)
        {
            MessageBox.Show("Another instance is already running.");
            return;
        }

        Application.Run(new Form1());   // or whatever was there
    }
} 
```

我的直觉反应是 using 会起作用，因为 using （应该）相当于：

```
Mutex m = new System.Threading.Mutex(true, "YourNameHere", out ok);
try
{
    // do stuff here
}
finally
{
    m.Close();
} 
```

而且我认为 m.Close() 足以向 JIT 编译器发出另一个引用的信号，从而防止过早的垃圾收集。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-11T18:00:32.750

将互斥锁包装在`using`语句中确实可以防止它被垃圾收集，但也会*在*最后处理它（它调用`Dispose`， not `Close`）（而`GC.KeepAlive`显然不会）。

如果方法的结束真的会成为过程的结束，我认为它不会对您使用的任何实际差异产生任何影响 - 我更喜欢`using`关于处置任何实施的一般原则的陈述`IDisposable`。

如果在进程退出时没有释放互斥锁，我怀疑它的终结器会处理它 - 只要其他终结器不会占用终结线程超过其超时时间。

如果终结器不处理它，我不知道 Windows 本身是否会注意到该进程可能不再拥有互斥锁，因为它（进程）不再存在。我怀疑它会，但你必须检查详细的 Win32 文档才能确定。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T18:17:35.390

在这种情况下，使用`using`似乎比使用更适合`GC.KeepAlive`。您不仅希望`Mutex`在应用程序运行时保持活动状态，还希望它在退出主循环后立即消失。

如果您只是将其`Mutex`挂起而不进行处理，则可能需要一段时间才能完成，具体取决于应用程序关闭时需要执行的清理工作量。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-24T19:21:22.593

我认为 KeepAlive 与命名的 Mutex 一起使用的原因是确保它不会及早被垃圾收集。C# using / Dispose 模式不适用于防止这种情况。当对象引用不再在范围内使用时，运行时可能会在范围结束之前收集它。这是一个优化。

# python - 判断一个字符是否是一个组合变音符号

> ID：635643
> 
> 赞同：4
> 
> 时间：2009-03-11T17:55:57.317
> 
> 标签：python, unicode, diacritics

如果你在 python (2.x) 中循环字符一个 unicode 字符串，说：

> ak.sɛp.tɑ̃

您如何判断当前字符是否是组合变音符号？

例如，上面字符串中的最后一个字符实际上是一个组合标记：

> ak.sɛp.tɑ̃ --> ̃

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-11T18:15:22.027

使用 unicodedata 模块：

```
import unicodedata
if unicodedata.combining(u'a'):
    print "is combining character"
else:
    print "is not combining" 
```

这些帖子也很相关

[如何使用 Python 反转 Unicode 分解？](https://stackoverflow.com/questions/446222/how-do-i-reverse-unicode-decomposition-using-python)

[删除 Python unicode 字符串中的重音符号的最佳方法是什么？](https://stackoverflow.com/questions/517923/what-is-the-best-way-to-remove-accents-in-a-python-unicode-string)

# asp.net - .NET 中是否有用于解析/显示 ICS 提要的良好库？

> ID：635657
> 
> 赞同：0
> 
> 时间：2009-03-11T17:58:42.830
> 
> 标签：asp.net, dotnetnuke, icalendar

我想在我的网站中嵌入一个谷歌日历，但我讨厌他们内置的东西给我的颜色等选项。

有没有人整理了一个很好的图书馆来做这些事情。我专门在 DotNetNuke 站点上运行，但任何可嵌入的 js 代码或用于执行此操作的 .NET 库都是一个很好的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T18:11:56.793

我用过[DDay.iCal](http://www.ddaysoftware.com/Pages/Projects/DDay.iCal/)。这是相当不错。它曾经在反复发生的事件中存在一些不稳定的问题，但我认为这些问题已经解决了。

# c++ - 声明全局变量的最佳方法是什么？

> ID：635658
> 
> 赞同：5
> 
> 时间：2009-03-11T17:58:54.797
> 
> 标签：c++, design-patterns

在 C++ 中，假设您要声明一个供许多人使用的全局变量。你怎么做呢？

我通常在cpp文件中使用declare和define，然后在其他cpp文件（而不是头文件）中使用extern。

我不喜欢这种方法，我正在考虑以下几点：

在头文件中：

some_file.h

```
Class MYGlobalClass
{

};

MyGlobalClass& MyGlobalClassInstance()
{
   static MYGlobalClass instance; 
   return  instance;

} 
```

**编辑**

***在以下情况下考虑：***

*   可用于多线程应用程序
*   命名空间污染
*   可能不一定是单例，因为可能会创建许多这样的实例

你有什么想法、建议、新想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-11T18:13:12.407

最好的建议可能是“尽量避免全局变量”。人们并不像他们想象的那样经常需要全局变量。通常事实证明，“将所有内容作为参数传递给构造函数”并不像人们在听到这个建议时想象的那么工作。它还倾向于导致代码更简洁，依赖更少、更明确。

我不知道在 C++ 中声明全局变量的任何“正确”方式。你现在的做法很好，但初始化的顺序是未指定的，所以如果你的全局变量之间有任何依赖关系，你就有麻烦了。

返回静态实例的函数或多或少解决了该问题，但不是线程安全的。

单身人士只是一个糟糕的主意。它不能解决您的问题，但会为您的代码添加额外的约束，这实际上并不是必需的，并且很可能会在以后回来咬您。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T18:04:37.420

在“many”包含的一个头文件中声明为extern，并在一个*.cpp文件中定义

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T18:07:28.910

您对访问器函数内部的静态概念的想法与全局变量有很大不同。不同之处在于它是何时构造的，并且很可能是多线程的主要问题。如果两个线程`MyGlobalClassInstance`同时调用怎么办？取决于环境，但我怀疑这是大多数 C++ 编译器的典型情况，您可能会`MyGlobalClass`同时调用两个运行构造函数，寻址相同的内存区域。

如果您是单线程的，则不太可能出现问题。

如果您在源文件中将实例声明为普通静态成员或普通全局变量，您可能会更轻松，因为构造函数将在`main`执行之前调用，在您有机会启动其他线程之前。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T18:34:37.333

在一个头文件中声明它（使用`extern`），并在*一个* `.cpp`（或任何其他扩展名）文件中定义它。您可以使用函数并返回对静态变量的引用，就像您展示的那样，以规避与其他`.cpp`文件中其他此类命名空间范围变量相关的构造顺序问题。但是请记住，这并不能保护您免受破坏顺序问题的影响——这与构造的顺序完全相反（这些事情被称为“静态初始化顺序失败”。如果您使用像您这样的函数并将其放入标题中，请使其内联使函数的重新定义在被包含到多个时有效`.cpp`文件（从逻辑上讲，该函数仍然只出现一次，因为其中的静态将只存在一次，而不是针对它包含的每个文件单独存在）。或者，只需在标题中声明它，但在*一个* `.cpp`文件中定义它（然后，从中删除内联！）。

```
inline A& getA() { static A a; return a; } 
```

销毁顺序的潜在问题可以通过使用来规避`new`：

```
inline A& getA() { static A *a = new A; return *a; } 
```

然而，它的析构函数永远不会被调用。如果您需要线程安全，您应该添加一个互斥锁来防止多次访问。`boost.thread`可能有一些东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T18:05:29.367

> 在 cpp 文件中声明和定义

`extern`将-ed 声明保留在标题中。在实现文件中只定义*一次。*

你很亲密。使用命名空间代替全局变量。

```
namespace myns {
   int foo = 0;
} 
```

现在，如果它是一个类对象，您正在查看 Singletion 模式。事实上，您的示例代码反映了单例设计。但是，如果您要在标头中定义函数，请将其设置为内联 - 否则会违反 ODR。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T18:09:55.223

它是一个真正的全局变量，理论上任何模块都可以从外部访问，你应该将 extern 声明放在头文件中：

```
// MyClass.h
class MyClass { ... };
extern MyClass myGlobalInstance;

// MyClass.cpp
MyClass myGlobalInstance; 
```

如果它只是一个真正只能由单个模块访问的全局对象，则通过将其设为私有（或受保护）静态类变量、静态函数变量（如果它仅由一个函数需要）或在匿名命名空间：

选项1：

```
// MyClass.h
class MyClass
{
private:  // or protected, if you want it accessible by subclasses
    static MyClass myGlobalInstance;
}; 
```

选项 2：

```
// MyClass.cpp
void someFunction()
{
    // it's global, but only accessible inside this function
    static MyClass myGlobalInstance;
    ...
} 
```

选项 3：

```
// MyClass.cpp
namespace
{
    MyClass myGlobalInstance;
}

// it's now only accessible in this file 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T18:00:29.427

extern MyGlobalClass MyGlobalClassInstance；

编辑：不是静态的>.<

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-11T18:05:44.843

为什么不使用好的旧单例模式？

# forms - 编辑页面和查看页面是否需要具有相同的基本布局？

> ID：635659
> 
> 赞同：1
> 
> 时间：2009-03-11T17:59:06.387
> 
> 标签：forms, user-interface

从设计和可用性的角度来看，编辑页面是否最好模仿视图页面的布局？

我们的视图页面非常密集。数据紧密地打包在一起，但是在编辑时，每个输入字段旁边都会有额外的控件。如果我们保持布局不变，它将过于拥挤。如果重新排列字段，这会导致可用性问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T18:06:23.000

通常，您希望编辑页面与视图页面尽可能相似。一般来说。在某些情况下，这没有任何意义，特别是如果您必须输入大量未显示在视图中的额外数据，这听起来像是您的情况。

我会尝试做的是确保您继续以与查看时相同的方式对字段进行分组和排序，因此虽然它们可能位于稍微不同的位置，但至少它们在逻辑上会被分组相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T18:20:16.460

它肯定会损害可用性。重新排列字段的两个危险是：

*   让用户对他们正在编辑的字段感到困惑
*   使用户难以找到他们想要编辑的字段。

这些问题在高密度页面上更加严重。

有时这是可以的。我能想到的最好的例子是编辑器和查看器是不同的用户。另一种（更模糊的）情况是编辑屏幕需要高度优化以实现快速吞吐量的情况。

如果可能，您可能会考虑将屏幕拆分，或制作可折叠区域以给用户（和屏幕）一点喘息的空间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T18:06:18.460

这取决于您的工作流程。

如果用户必须在编辑和查看之间来回切换，这会让用户感到非常困惑，因为字段可能会跳来跳去，他们可能会丢失他们所在的字段等等。

如果您的视图页面非常密集，您可以尝试将其分成几个部分，每个部分都有自己的编辑功能。您可以让它拍摄到自己的编辑页面，或者全部使用“web 2.0”并在视图页面上抛出一个带有部分编辑表单的灯箱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T18:08:42.230

通常，事物越相似，用户就越容易使用。我不知道你的特定布局是什么样的，但从一般的角度来看，拥挤的视图通常很难看，并且用额外的控件把它弄乱会使情况变得更糟。

尽管我不是电子表格专家，但在 Excel 或类似产品中进行编辑很容易，因为它不会用大量控件阻塞视图。编辑面板是视图面板。对于我自己的产品，当事情一致时，用户通常不会感到困惑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-11T03:27:12.567

我有一个类似的问题。我所做的是有一个查看页面，可以让您查看所有内容，但您需要深入了解逻辑部分的各个编辑页面。在逻辑部分中，字段始终与视图页面上的顺序相同（并具有相同的标签）。正是这样的事情让您的应用程序感觉更好一些。

不要仅仅因为它们都与您的数据库模型中的同一事物相关，就将所有内容都扔到一个庞大的编辑页面上。将它们分成有意义的集合，每个集合有 3-7 个字段。

如果他们真的需要编辑所有内容（例如在创建新事物时），那么我会采用一种向导方法，逐步完成，呈现仅供查看的摘要，然后让他们保存。

# c++ - 如何在汇编代码中找到方法

> ID：635660
> 
> 赞同：5
> 
> 时间：2009-03-11T17:59:16.060
> 
> 标签：c++, assembly

从内存泄漏日志中，我有以下信息：

测试应用程序.exe！+ 2238 通道

让我们说这意味着偏移“2238c”（十六进制值）处的方法正在泄漏。

如何在我的源代码中找到相应的方法？我有链接器映射（testapp.map），但不知道如何使用它。

这是一个用 VS2008 编译的 C++ 应用程序。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-11T18:18:40.757

您的地图文件将有一堆这样的条目：

```
0001:00000070 ??0logic_error@std@@QAE@ABV01@@Z 00401070 fi scratch.obj
 0001:000000e0 _main 004010e0 f 从头开始​​.obj
 0001:00000310 ??1?$list@V?$variant@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@ U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@@boost@@V?$allocator@V?$variant@V?$basic_string @DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045 @U3045@U3045@U3045@U3045@U3045@U3045@@boost@@@std@@@std@@QAE@XZ 00401310 fi scratch.obj
 0001:00000330 ??1?$variant@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045@U3045@U3045 @U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@@boost@@QAE@XZ 00401330 fi scratch.obj
 0001：00000360?_Buynode@?$list@V?$variant@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045@U3045 @U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@@boost@@V?$allocator@V?$variant@V?$basic_string@DU? $char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@ U3045@U3045@U3045@U3045@U3045@@boost@@@std@@@std@@IAEPAU_Node@?$_List_nod@V?$variant@V?$basic_string@DU?$char_traits@D@std@@V? $allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@ @boost@@V?$allocator@V?$variant@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045 @U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@@boost@@@std@@@2@XZ 00401360 fi scratch.obj
 0001:00000380 ?clear@?$list@V?$variant@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@ U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@@boost@@V?$allocator@V?$variant@V?$basic_string @DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045 @U3045@U3045@U3045@U3045@U3045@U3045@@boost@@@std@@@std@@QAEXXZ 00401380 fi scratch.obj
 0001：000003f0?_Buynode@?$list@V?$variant@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045@U3045 @U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@@boost@@V?$allocator@V?$variant@V?$basic_string@DU? $char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@ U3045@U3045@U3045@U3045@U3045@@boost@@@std@@@std@@IAEPAU_Node@?$_List_nod@V?$variant@V?$basic_string@DU?$char_traits@D@std@@V? $allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@ @boost@@V?$allocator@V?$variant@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045 @U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@@boost@@@std@@@2@PAU342@0ABV?$variant@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@ fi@@H_NUvoid_@0detail@boost@@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@@boost@0@@Z 004013f从头开始.obj
 0001:00000480 ?_Incsize@?$list@V?$variant@V?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@ U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@@boost@@V?$allocator@V?$variant@V?$basic_string @DU?$char_traits@D@std@@V?$allocator@D@2@@std@@H_NUvoid_@0detail@boost@@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045@U3045 @U3045@U3045@U3045@U3045@U3045@U3045@@boost@@@std@@@std@@IAEXI@Z 00401480 fi scratch.obj

```

这会准确地向您展示您的代码在内存中的布局方式。例如 main() 从 E0 开始，到段 1 中的 30F 结束。

您只需要浏览地址列表即可查看您获得的地址所在的位置。需要注意的一件事是通常有多个段，但您通常可以推断出哪个段具有您感兴趣的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T18:09:38.250

使用[`objdump`](http://en.wikipedia.org/wiki/Objdump)-- 这应该告诉你函数地址映射。

来自 Ferruccio：Windows 版本是 dumpbin，它带有 Visual Studio

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T18:13:52.513

您还可以在构建时生成程序集 - 查看编译器设置，选项是 IIRC /FAs。

# xslt - 在 XSLT 2.0 中使用结果文档进行内联输出文档选择

> ID：635670
> 
> 赞同：3
> 
> 时间：2009-03-11T18:03:11.980
> 
> 标签：xslt, xslt-2.0

问候，

我正在寻找一种在 XSLT 中进行内联结果（输出）文档选择的方法。我知道创建一个`xsl:result-document`节点以将一个转换应用于多个文档的方法。通常这种方法使用几个pass，例如：

```
<xsl:template match="/">
    <xsl:apply-templates select="*"/>
    <xsl:result-document href="test.xml">
        <xsl:apply-templates select="*"/>
    </xsl:result-document>
</xsl:template> 
```

我正在寻找一种内联方法，这样我就可以一次构建两个输出文档。原因是我有一个临时树，它是在运行转换时构建的，我想输出到文件中。

```
<xsl:variable name="treeBase">
    <Base/>
</xsl:variable>

<xsl:template match="/">
    <xsl:apply-templates select="*"/>
</xsl:template>

<xsl:template match="these_elements">
    <xsl:param name="temp" select="$treeBase"/>

</xsl:template>

<xsl:template match="not_these_elements">
    <xsl:param name="temp" select="$treeBase"/>

    <xsl:apply-templates select="@*|node()">
       <xsl:with-param name="temp">
           <Base>
              <xsl:copy-of select="$temp/Base/*"/>
              <Item>
                  <xsl:value-of select="ThisItem"/>
              </Item>
           </Base>
        </xsl:with-param>
</xsl:template> 
```

**你为什么想做这个？** 在我的 XSLT 中，我通过递归参数调用构建了一个临时树。我想输出临时树，因为它正在构建到单独的文档中，但仍然使用为控制流而构建的临时树。使用当前方法，我必须进行两次复杂的转换。

有没有办法在 XSLT 中做到这一点，还是单程单文档？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-12T19:19:26.830

**这是一个如何执行此操作的工作示例**：

**这种转变**：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
  <!--                                               -->    
    <xsl:template match="/*">
      <xsl:variable name="vTop" select="."/>
  <!--                                               -->    
        <xsl:for-each-group select="num" group-by="xs:integer(.) mod 2">
          <xsl:result-document href="file:///C:/Temp/file{position()}.xml">
            <xsl:element name="{name($vTop)}">
              <xsl:copy-of select="current-group()"/>
            </xsl:element>
          </xsl:result-document>
        </xsl:for-each-group>
    </xsl:template>
</xsl:stylesheet> 
```

**应用于此 XML 文档时**

```
<nums>
  <num>01</num>
  <num>02</num>
  <num>03</num>
  <num>04</num>
  <num>05</num>
  <num>06</num>
  <num>07</num>
  <num>08</num>
  <num>09</num>
  <num>010</num>
</nums> 
```

**生成所需的两个文件**：***file1.xml 和 file2.xml***，它们相应地包含具有奇数和偶数值的“num”元素。

**请注意**，根据需要，没有“multiplr pass”并且代码是“inline”。

# iphone - 您如何处理 iPhone 应用程序中的域对象？

> ID：635678
> 
> 赞同：2
> 
> 时间：2009-03-11T18:06:20.037
> 
> 标签：iphone, cocoa, cocoa-touch

我现在有一些应用程序，但我对此还是比较陌生。我正在寻找最佳实践建议，甚至是我不知道的 Cocoa Touch 框架的一个功能，如果有人知道的话。

在第一个应用程序中，我在我的应用程序委托中创建了域对象，然后根据需要将它们传递给我的 ViewControllers。例如，在 App Delegate 中，我会尝试从内存中加载用户的帐户，如果存在，我会使用 initWithCoder 创建一个 Account 对象。然后，每当我实例化一个需要 Account 对象的 ViewController 时，我都会将它传递给具有自己的 account 属性的 ViewController。

但是我觉得我的应用程序中有太多代码，所以我决定让我的 ApplicationDelegate 管理我的域对象。每当 ViewController 需要一个时，它都会像这样查询 ApplicationDelegate：

```
MyAppDelegate* myAppDelegate = [UIApplication sharedApplication].delegate;
ADomainObject* anObject = myAppDelegate.anObject; 
```

这是疯了吗？这是个好主意吗？我完全是自己编造的，所以我想知道是否有更好的东西。由于我是 iPhone 开发新手，我正在努力学习做事的最佳方式......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T18:38:04.483

不，这不是一个糟糕的设计。您可能想考虑使用单例模式作为替代方案，或者更有可能是对 App Delegate 理念的补充。你将能够写出类似的东西

```
[ADomainObject sharedDomainObject] 
```

得到你的对象。类方法也是在单文档应用程序中获取域对象的好方法——因为所有 iPhone 应用程序都是单文档。例如，如果你有一个对象层次结构`Folder`，你可能有一个类方法，比如`+ (NSArray *)rootFolders`或`+ (NSArray *)allEmptyFolders`获取特定的对象组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-12T13:57:43.900

你所描述的有效；在桌面上处理 Core Data 时，我使用了相同的策略，我的应用程序有一个由应用程序控制器拥有的托管对象上下文。除了 Alex 提到的单例之外，另一种常见的策略是实现一个“数据控制器”来处理加载和管理域对象的逻辑。在这种情况下，您的应用程序控制器仍将负责初始化和管理数据控制器和视图控制器之间的关系，但它不会被模型对象特定的代码弄乱。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-12T15:38:41.040

在我做过的非 Cocoa 应用程序开发中，我发现使用[DI很有帮助](http://en.wikipedia.org/wiki/Dependency_injection)方法，其中对象将其依赖对象（在本例中为您的域对象）从外部传递给它们，而不是伸手去明确地要求它们。“明确要求他们”将意味着您当前正在做的事情 - 通过您的应用程序委托上的属性访问它们。以某种方式在 ViewControllers 和域对象之间创建关联是否可能/容易/愚蠢，以便 ViewControllers 不必明确要求它们？例如，有没有办法在笔尖中建立这些关系？我是在问，而不是建议，因为我不是 Cocoa 方面的专家。（很抱歉在这个线程上搭载我的问题，但它与原始问题非常相关。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T21:31:16.067

我根本不会涉及应用程序委托。如果只有一个控制器使用该对象，视图控制器将实例化并拥有该模型对象。否则，我使用类级方法来检索模型的静态实例，并使用 +[DatabaseModel sharedDatabaseModel] 方法。

# .net - 使用线程监听 UDP 广播

> ID：635687
> 
> 赞同：4
> 
> 时间：2009-03-11T18:08:36.317
> 
> 标签：.net, vb.net, udp, listener

我正在向 广播一条简单的消息*。*.*.255 （更改为 255 我的 ip 的最后一部分），我正在尝试听它。代码没有返回错误，但我没有收到任何东西。在wireshark中，我可以看到广播被正确发送，但每次使用不同的端口（我不知道这是否很重要）。这是我的代码的一些部分。

```
Private Sub connect()
    setip()
    btnsend.Enabled = True
    btndisconnect.Enabled = True
    btnconnect.Enabled = False
    receive()
    txtmsg.Enabled = True
End Sub

Sub receive()
    Try
        SocketNO = port
        rClient = New System.Net.Sockets.UdpClient(SocketNO)
        rClient.EnableBroadcast = True
        ThreadReceive = _
           New System.Threading.Thread(AddressOf receivemessages)
        If ThreadReceive.IsAlive = False Then
            ThreadReceive.Start()
        Else
            ThreadReceive.Resume()
        End If
    Catch ex As Exception
        MsgBox("Error")
    End Try
End Sub

Sub receivemessages()
    Dim receiveBytes As Byte() = rClient.Receive(rip)
    Dim BitDet As BitArray
    BitDet = New BitArray(receiveBytes)
    Dim strReturnData As String = _
                System.Text.Encoding.Unicode.GetString(receiveBytes)
    MsgBox(strReturnData.ToString)
End Sub

 Private Sub setip()
    hostname = System.Net.Dns.GetHostName
    myip = IPAddress.Parse(System.Net.Dns.GetHostEntry(hostname).AddressList(1).ToString)
    ipsplit = myip.ToString.Split(".".ToCharArray())
    ipsplit(3) = 255
    broadcastip = IPAddress.Parse(ipsplit(0) & "." & ipsplit(1) & "." + ipsplit(2) + "." + ipsplit(3))
    iep = New IPEndPoint(broadcastip, port)

End Sub

Sub sendmsg()
    Dim msg As Byte()
    MsgBox(myip.ToString)
    sclient = New UdpClient
    sclient.EnableBroadcast = True
    msg = Encoding.ASCII.GetBytes(txtmsg.Text)
    sclient.Send(msg, msg.Length, iep)
    sclient.Close()
    txtmsg.Clear()
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T18:15:38.080

[这篇文章](http://msdn.microsoft.com/en-us/library/tst0kwb1.aspx)似乎几乎完全按照您正在尝试做的事情进行，并通过代码中的大量注释很好地解释了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T18:41:33.353

要侦听 UDP 端口，您必须绑定该端口。这是我使用的一些 c# 代码。它使用一个接收线程来轮询套接字的消息。

```
Socket soUdp_msg = new Socket(AddressFamily.InterNetwork, SocketType.Dgram,ProtocolType.Udp);
IPEndPoint localIpEndPoint_msg = new IPEndPoint(IPAddress.Any, UdpPort_msg);
soUdp_msg.Bind(localIpEndPoint_msg); 
```

然后在我的接收线程中

```
 byte[] received_s = new byte[2048];
 IPEndPoint tmpIpEndPoint = new IPEndPoint(IPAddress.Any, UdpPort_msg);
 EndPoint remoteEP = (tmpIpEndPoint);

 while (soUdp_msg.Poll(0, SelectMode.SelectRead))
 {

    int sz = soUdp_msg.ReceiveFrom(received_s, ref remoteEP);
    tep = (IPEndPoint)remoteEP;

    // do some work
 }

 Thread.Sleep(50); // sleep so receive thread does not dominate computer 
```

# knuth - 计算机编程艺术，第 4 卷，分册 2 错字？

> ID：635700
> 
> 赞同：1
> 
> 时间：2009-03-11T18:11:29.150
> 
> 标签：knuth, taocp

在第 5 页的底部是短语“将*k*更改为*k* ⊕ (1 ^(*j* +1) ) [2] ”。即使在二进制中，1 的任何幂都不是 1 吗？我想这一定是笔误。我向 Knuth 博士发送了一封电子邮件报告此事，但我预计几个月后不会收到回复。与此同时，我试图弄清楚这应该是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-03T16:49:47.277

这可以通过使用 (...) [2]表示按位表示的约定来解决。(1 ^(j+1) ) [2]则仅由 j+1 个组成，而不是指代幂。您可以在第 8 页的 TAOCP 第 4 卷分册 1 中看到更明确的解释，例如：

> 如果 x 几乎是任何非零 2 进整数，我们可以将其位写成以下形式
> 
> x = (g01 ^a 10 ^b ) [2]
> 
> 换句话说，x 由一些任意（但无限）的二进制字符串 g 组成，后跟一个 0，然后是 a+1 个 1，然后是 b 个零，对于某些 a >= 0 和 b >= 0。

[我已将符号 alpha 替换为 g 以节省编码问题]

回到原来的查询；k ⊕(1 ^(j+1) ) [2]与 k ⊕ (2 ^(j+1) - 1) 等价，这意味着 (1 ^(j+1) ) [2] = (2 ^(j+1) - 1)：因为左边是有效位为 j+1（连续）的整数；右边是指数。例如，当 j =3：

(1 ⁴ ) [2] = (1111) [2] = (2 ⁴ - 1)

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T18:55:18.140

可以在勘误页面上找到已知拼写错误的列表：

[http://www-cs-faculty.stanford.edu/~knuth/taocp.html](http://www-cs-faculty.stanford.edu/~knuth/taocp.html)

您报告的错字不存在。如果确实是错字，您可能有资格从 Knuth 本人那里获得现金奖励。

# php - 从 zend 框架的视图中获取基本路径

> ID：635703
> 
> 赞同：11
> 
> 时间：2009-03-11T18:12:06.030
> 
> 标签：php, zend-framework, zend-view, zend-layout

案例：您正在使用 Zend Framework 开发一个站点，并且需要到部署 webapp 的文件夹的相关链接。即`mysite.com/folder`在线和`localhost:8080`正在开发中。

无论部署位置如何，以下在控制器中都可以正常工作：

```
$this->_helper->redirector->gotoSimple($action, $controller, $module, $params); 
```

下面是一个视图脚本，即。索引.phtml：

```
<a href="<?php echo $this->url(array('controller'=>'index', 'action' => 'index'), null, true); ?>"> 
```

但是在链接到图像或样式表时如何获得正确的基本路径？（例如在 layout.phtml 文件中）：

```
<img src='<?php echo WHAT_TO_TYPE_HERE; ?>images/logo.png' /> 
```

和

```
$this->headLink()->appendStylesheet( WHAT_TO_TYPE_HERE . 'css/default.css'); 
```

`WHAT_TO_TYPE_HERE`应该用给出的东西代替

```
<img src="/folder/images/logo.png />` on mysite.com and `<img src="/images/logo.png /> 
```

在本地主机上

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-11T18:26:17.290

您可以从 Front Controller 获取基本 url `Zend_Controller_Front::getInstance()->getBaseUrl();`。我将其包装在视图助手中

```
class My_View_Helper_BaseUrl 
{   
    /**
     *  Get base url
     * 
     * @return string
     */
    public function baseUrl()
    {
        return rtrim(Zend_Controller_Front::getInstance()->getBaseUrl(),'/');
    }

} 
```

因此，在 html 标记中，您会`<img src="<?php echo $this->baseUrl();?>/images/logo.png"/>`在帮助程序中去除尾斜杠，这样当应用程序不在子文件夹中运行时（baseUrl 在这种情况下为空白），路径仍然有效。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-09-29T19:31:36.427

如果有人想知道最好的方法并且不想浪费 2 小时搜索 Zend/Google。有一个视图助手可以做到这一点。

```
$this->view->serverUrl(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-02-17T08:43:51.043

如果您想在`layout`文件中托管名称，请打印并获取您的`HOST`姓名：

```
echo $this->serverUrl().$this->baseUrl() 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-04T12:40:31.653

这是我的**baseUrl**助手：

```
class Zend_View_Helper_BaseUrl extends Zend_View_Helper_Abstract {
    public function baseUrl() {
        $protocol = isset($_SERVER['HTTPS']) ? 'https' : 'http';
        $server = $_SERVER['HTTP_HOST'];
        $port = $_SERVER['SERVER_PORT'] != 80 ? ":{$_SERVER['SERVER_PORT']}" : '';
        $path = rtrim(dirname($_SERVER['SCRIPT_NAME']), '/\\') . '/';
        return "$protocol://$server$port$path";
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-19T18:50:13.027

```
<?php
/**
 *
 * @package   TaMeR Library
 * @copyright (C) 2010 Dennis T Kaplan
 * @license   GPL {@link http://www.gnu.org/licenses/gpl.html}
 *
 * @author       Dennis T Kaplan
 */

/** @see Zend_View_Helper_Abstract */
require_once 'Zend/View/Helper/Abstract.php';

class TaMeR_View_Helper_BaseUrl extends Zend_View_Helper_Abstract {
    /**
     * Returns site's base url, or file with base url prepended
     *
     * $file is appended to the base url for simplicity
     *
     * @param  string|null $file
     * @return string
     */

    public function baseUrl($file = NULL) {

        $baseUrl = $domain = $subdomain = $protocol = $host = $port = NULL;

        $host = array_reverse(explode('.', $_SERVER['HTTP_HOST']));
        $domain = $host[1].'.'.$host[0];
        $subdomain = (isset($host[2]) ? $host[2] : 'www');
        if(getenv("HTTPS") == 'on') {
            $protocol = 'https';
            $port     = $_SERVER['SERVER_PORT'] != 443 ? ':'.$_SERVER['SERVER_PORT'] : '';
        }else{
            $protocol = 'http';
            $port     = $_SERVER['SERVER_PORT'] != 80 ? ':'.$_SERVER['SERVER_PORT'] : '';
        }

        // Remove trailing slashes
        if(NULL !== $file) {
            $file = '/' . ltrim($file, '/\\');
        }else{
            $file = rtrim(dirname($_SERVER['SCRIPT_NAME']), '/') . '/';
        }
        $baseUrl = $protocol.'://'.$subdomain.'.'.$domain.$port.$file;
        return $baseUrl;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-05T03:18:38.840

这对我有用：

回声 $this->serverUrl() 。$this->url()

# c++ - 为什么我的 Boost.Regex 搜索只报告一次匹配迭代？

> ID：635705
> 
> 赞同：4
> 
> 时间：2009-03-11T18:12:17.837
> 
> 标签：c++, regex, iterator, greedy, boost-regex

我试图找出一个字符串中有多少个正则表达式匹配。我正在使用迭代器来迭代匹配，并使用整数来记录有多少。

```
long int before = GetTickCount();
string text;

boost::regex re("^(\\d{5})\\s(\\d{8})\\s(.*)\\s(.*)\\s(.*)\\s(\\d{8})\\s(.{1})$");
char * buffer;
long length;
long count;
ifstream f;

f.open("c:\\temp\\test.txt", ios::in | ios::ate);
length = f.tellg();
f.seekg(0, ios::beg);

buffer = new char[length];

f.read(buffer, length);
f.close();

text = buffer;
boost::sregex_token_iterator itr(text.begin(), text.end(), re, 0);
boost::sregex_token_iterator end;

count = 0;
for(; itr != end; ++itr)
{
    count++;
}

long int after = GetTickCount();
cout << "Found " << count << " matches in " << (after-before) << " ms." << endl; 
```

在我的示例中，count 始终返回 1，即使我将代码放在 for 循环中以显示匹配项（并且有很多）。这是为什么？我究竟做错了什么？

## 编辑

测试输入：

```
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N 
```

输出（不匹配）：

> 在 16 毫秒内找到 1 个匹配项。

如果我将 for 循环更改为：

```
count = 0;
for(; itr != end; ++itr)
{
    string match(itr->first, itr->second);
    cout << match << endl;
    count++;
} 
```

我得到这个作为输出：

```
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
12345 12345678 SOME NAME SOMETHING 88888888 N
Found 1 matches in 47 ms. 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-11T18:25:45.903

呵呵。你的问题是你的正则表达式。将您的 s 更改`(.\*)`为`(.\*?)`s （假设支持）。你认为你看到每一行都被匹配，但实际上你看到*整​​个文本*被匹配，因为你的模式是贪婪的。

要查看说明的问题，请将循环中的调试输出更改为：

```
cout << "[" << match << "]" << endl; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T18:21:49.920

你能粘贴输入和输出。

如果 count 返回 1，则意味着您的 string 中只有*一个*匹配项`text`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T18:30:06.407

对 boost 了解不多，但是 (end - itr) 有效吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T18:34:14.680

既然您说即使输出结果，计数仍然是一个，您可能会查看几件事来帮助诊断它：

*   尝试在每个循环迭代中输出计数，看看会发生什么。如果这只输出一次，那么循环只运行一次，而你认为​​的多个匹配实际上是一个很大的长匹配。
*   如果可行，请尝试完全使用另一个变量名：您可能会在声明多个`count`变量的地方获得一些范围阴影。

如果该循环多次执行，那么问题不在于您如何使用 boost。无论您在做什么，boost 都无法修改您未传递给它的变量。（当然，如果您要通过`count`某个地方进行提升，那么这是另一种可能性。）

很可能，您首先`(.*)`要匹配所有内容，直到输入几乎结束（包括换行符）。尝试将它们替换为`([^ ]*)`( 除了空格之外的任何内容，这样匹配就会在找到空格时停止。

# javascript - 如何滚动到div内的元素？

> ID：635706
> 
> 赞同：244
> 
> 时间：2009-03-11T18:12:20.787
> 
> 标签：javascript, html, scroll

我有一个滚动`div`，当我点击它时我想要一个事件，它会强制它`div`滚动以查看里面的元素。我这样写它的JavasSript：

```
document.getElementById(chr).scrollIntoView(true); 
```

但这会在滚动`div`自身的同时滚动所有页面。如何解决？

我想这样说： `MyContainerDiv.getElementById(chr).scrollIntoView(true);`

* * *

## 回答 #1

> 赞同：429
> 
> 时间：2009-10-20T05:19:09.783

您需要获取要滚动到视图中的元素相对于其父级（滚动 div 容器）的顶部偏移量：

```
var myElement = document.getElementById('element_within_div');
var topPos = myElement.offsetTop; 
```

变量 topPos 现在设置为滚动 div 顶部和您希望可见的元素之间的距离（以像素为单位）。

现在我们使用以下命令告诉 div 滚动到该位置`scrollTop`：

```
document.getElementById('scrolling_div').scrollTop = topPos; 
```

如果你使用原型 JS 框架，你会做同样的事情：

```
var posArray = $('element_within_div').positionedOffset();
$('scrolling_div').scrollTop = posArray[1]; 
```

同样，这将滚动 div 以使您希望看到的元素正好位于顶部（或者如果这不可能，则尽可能向下滚动以使其可见）。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2009-03-11T18:18:52.940

您必须在要滚动到的 DIV 中找到元素的位置，然后设置 scrollTop 属性。

```
divElem.scrollTop = 0; 
```

***更新***：

上移或下移的示例代码

```
 function move_up() {
    document.getElementById('divElem').scrollTop += 10;
  }

  function move_down() {
    document.getElementById('divElem').scrollTop -= 10;
  } 
```

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2018-06-23T22:48:26.050

# 方法 1 - 平滑滚动到元素内的元素

```
var box = document.querySelector('.box'),
    targetElm = document.querySelector('.boxChild'); // <-- Scroll to here within ".box"

document.querySelector('button').addEventListener('click', function(){
   scrollToElm( box, targetElm , 600 );   
});

/////////////

function scrollToElm(container, elm, duration){
  var pos = getRelativePos(elm);
  scrollTo( container, pos.top , 2);  // duration in seconds
}

function getRelativePos(elm){
  var pPos = elm.parentNode.getBoundingClientRect(), // parent pos
      cPos = elm.getBoundingClientRect(), // target pos
      pos = {};

  pos.top    = cPos.top    - pPos.top + elm.parentNode.scrollTop,
  pos.right  = cPos.right  - pPos.right,
  pos.bottom = cPos.bottom - pPos.bottom,
  pos.left   = cPos.left   - pPos.left;

  return pos;
}

function scrollTo(element, to, duration, onDone) {
    var start = element.scrollTop,
        change = to - start,
        startTime = performance.now(),
        val, now, elapsed, t;

    function animateScroll(){
        now = performance.now();
        elapsed = (now - startTime)/1000;
        t = (elapsed/duration);

        element.scrollTop = start + change * easeInOutQuad(t);

        if( t < 1 )
            window.requestAnimationFrame(animateScroll);
        else
            onDone && onDone();
    };

    animateScroll();
}

function easeInOutQuad(t){ return t<.5 ? 2*t*t : -1+(4-2*t)*t };
```

```
.box{ width:80%; border:2px dashed; height:180px; overflow:auto; }
.boxChild{ 
  margin:600px 0 300px; 
  width: 40px;
  height:40px;
  background:green;
}
```

```
<button>Scroll to element</button>
<div class='box'>
  <div class='boxChild'></div>
</div>
```

# 方法 2 - 使用[Element.scrollIntoView](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView)：

> 请注意，[浏览器支持](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView#Browser_compatibility)不是很好

```
var targetElm = document.querySelector('.boxChild'),  // reference to scroll target
    button = document.querySelector('button');        // button that triggers the scroll

// bind "click" event to a button 
button.addEventListener('click', function(){
   targetElm.scrollIntoView()
})
```

```
.box {
  width: 80%;
  border: 2px dashed;
  height: 180px;
  overflow: auto;
  scroll-behavior: smooth; /* <-- for smooth scroll */
}

.boxChild {
  margin: 600px 0 300px;
  width: 40px;
  height: 40px;
  background: green;
}
```

```
<button>Scroll to element</button>
<div class='box'>
  <div class='boxChild'></div>
</div>
```

# 方法 3 - 使用 CSS[滚动行为](https://developer.mozilla.org/en-US/docs/Web/CSS/scroll-behavior)：

```
.box {
  width: 80%;
  border: 2px dashed;
  height: 180px;
  overflow-y: scroll;
  scroll-behavior: smooth; /* <--- */
}

#boxChild {
  margin: 600px 0 300px;
  width: 40px;
  height: 40px;
  background: green;
}
```

```
<a href='#boxChild'>Scroll to element</a>
<div class='box'>
  <div id='boxChild'></div>
</div>
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2019-12-10T10:49:50.707

## 原生 JS，跨浏览器，平滑滚动（2020 更新）

设置`ScrollTop`确实给出了预期的结果，但滚动非常突然。使用`jquery`平滑滚动不是一种选择。因此，这是一种支持所有主要浏览器的完成工作的本机方式。参考 - [caniuse](https://caniuse.com/#feat=element-scroll-methods)

```
// get the "Div" inside which you wish to scroll (i.e. the container element)
const El = document.getElementById('xyz');

// Lets say you wish to scroll by 100px, 
El.scrollTo({top: 100, behavior: 'smooth'});

// If you wish to scroll until the end of the container
El.scrollTo({top: El.scrollHeight, behavior: 'smooth'}); 
```

就是这样！

* * *

这是一个给怀疑者的工作片段 -

```
document.getElementById('btn').addEventListener('click', e => {
  e.preventDefault();
  // smooth scroll
  document.getElementById('container').scrollTo({top: 175, behavior: 'smooth'});
});
```

```
/* just some styling for you to ignore */
.scrollContainer {
  overflow-y: auto;
  max-height: 100px;
  position: relative;
  border: 1px solid red;
  width: 120px;
}

body {
  padding: 10px;
}

.box {
  margin: 5px;
  background-color: yellow;
  height: 25px;
  display: flex;
  align-items: center;
  justify-content: center;
}

#goose {
  background-color: lime;
}
```

```
<!-- Dummy html to be ignored -->
<div id="container" class="scrollContainer">
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div id="goose" class="box">goose</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
</div>

<button id="btn">goose</button>
```

**更新：**正如您在评论中看到的那样，IE11 似乎`Element.scrollTo()`不支持。因此，如果您不关心 IE11（您真的不应该），请随意在您的所有项目中使用它。请注意，存在对 Edge 的支持！所以你并没有真正把你的 Edge/Windows 用户抛在后面；）

**[参考](https://digitalfortress.tech/js/smooth-scroll-in-native-javascript-css/)**

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2017-08-24T01:16:47.207

要将元素滚动到 div 的视图中，仅在需要时，您可以使用此`scrollIfNeeded`功能：

```
function scrollIfNeeded(element, container) {
  if (element.offsetTop < container.scrollTop) {
    container.scrollTop = element.offsetTop;
  } else {
    const offsetBottom = element.offsetTop + element.offsetHeight;
    const scrollBottom = container.scrollTop + container.offsetHeight;
    if (offsetBottom > scrollBottom) {
      container.scrollTop = offsetBottom - container.offsetHeight;
    }
  }
}

document.getElementById('btn').addEventListener('click', ev => {
  ev.preventDefault();
  scrollIfNeeded(document.getElementById('goose'), document.getElementById('container'));
});
```

```
.scrollContainer {
  overflow-y: auto;
  max-height: 100px;
  position: relative;
  border: 1px solid red;
  width: 120px;
}

body {
  padding: 10px;
}

.box {
  margin: 5px;
  background-color: yellow;
  height: 25px;
  display: flex;
  align-items: center;
  justify-content: center;
}

#goose {
  background-color: lime;
}
```

```
<div id="container" class="scrollContainer">
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div id="goose" class="box">goose</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
  <div class="box">duck</div>
</div>

<button id="btn">scroll to goose</button>
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2015-10-19T21:33:34.797

代码应该是：

```
var divElem = document.getElementById('scrolling_div');
var chElem = document.getElementById('element_within_div');
var topPos = divElem.offsetTop;
divElem.scrollTop = topPos - chElem.offsetTop; 
```

您想要滚动子顶部位置和 div 顶部位置之间的差异。

使用以下方式访问子元素：

```
var divElem = document.getElementById('scrolling_div'); 
var numChildren = divElem.childNodes.length; 
```

等等....

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2017-06-20T18:17:14.260

如果您使用的是 jQuery，则可以使用以下内容滚动动画：

```
$(MyContainerDiv).animate({scrollTop: $(MyContainerDiv).scrollTop() + ($('element_within_div').offset().top - $(MyContainerDiv).offset().top)}); 
```

动画是可选的：您也可以将上面计算的 scrollTop 值直接放入容器的[scrollTop](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollTop)属性中。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2020-08-24T14:31:02.597

我们可以在不使用 JQuery 和其他库的情况下解决这个问题。

为此，我编写了以下代码：

你有类似的结构->

```
<div class="parent">
  <div class="child-one">

  </div>
  <div class="child-two">

  </div>
</div> 
```

JS：

```
scrollToElement() {
  var parentElement = document.querySelector('.parent');
  var childElement = document.querySelector('.child-two');

  parentElement.scrollTop = childElement.offsetTop - parentElement.offsetTop;
} 
```

我们可以很容易地重写这个方法来传递父母和孩子作为参数

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-05-22T23:49:57.577

另一个使用 jQuery 和 animate 的例子。

```
var container = $('#container');
var element = $('#element');

container.animate({
    scrollTop: container.scrollTop = container.scrollTop() + element.offset().top - container.offset().top
}, {
    duration: 1000,
    specialEasing: {
        width: 'linear',
        height: 'easeOutBounce'
    },
    complete: function (e) {
        console.log("animation completed");
    }
}); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-03-05T12:25:16.837

有两个事实：

1) safari 不支持组件 scrollIntoView。

2）JS框架jQuery可以做这样的工作：

```
parent = 'some parent div has css position==="fixed"' || 'html, body';

$(parent).animate({scrollTop: $(child).offset().top}, duration) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-01-24T18:29:35.797

这是一个简单的纯 JavaScript 解决方案，适用于目标 Number（的值`scrollTop`）、目标 DOM 元素或一些特殊的 String 情况：

```
/**
 * target - target to scroll to (DOM element, scrollTop Number, 'top', or 'bottom'
 * containerEl - DOM element for the container with scrollbars
 */
var scrollToTarget = function(target, containerEl) {
    // Moved up here for readability:
    var isElement = target && target.nodeType === 1,
        isNumber = Object.prototype.toString.call(target) === '[object Number]';

    if (isElement) {
        containerEl.scrollTop = target.offsetTop;
    } else if (isNumber) {
        containerEl.scrollTop = target;
    } else if (target === 'bottom') {
        containerEl.scrollTop = containerEl.scrollHeight - containerEl.offsetHeight;
    } else if (target === 'top') {
        containerEl.scrollTop = 0;
    }
}; 
```

以下是一些使用示例：

```
// Scroll to the top
var scrollableDiv = document.getElementById('scrollable_div');
scrollToTarget('top', scrollableDiv); 
```

或者

```
// Scroll to 200px from the top
var scrollableDiv = document.getElementById('scrollable_div');
scrollToTarget(200, scrollableDiv); 
```

或者

```
// Scroll to targetElement
var scrollableDiv = document.getElementById('scrollable_div');
var targetElement= document.getElementById('target_element');
scrollToTarget(targetElement, scrollableDiv); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-05-20T11:06:11.150

假设你有一个需要在里面滚动的 div 元素，试试这段代码

`document.querySelector('div').scroll(x,y)`

这适用于我在带有滚动的 div 中，如果您将鼠标指向此元素然后尝试向下或向上滚动，这应该适用于您。如果它手动工作，它也应该工作

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-04-06T15:53:33.307

*用户动画滚动*

*这是一个如何在没有***JQuery**`<div>`的情况下以编程方式水平滚动的示例。要垂直滚动，您可以将 JavaScript 的写入替换为, 。 ***`scrollLeft``scrollTop`***

 *****JSFiddle**

[https://jsfiddle.net/fNPvf/38536/](https://jsfiddle.net/fNPvf/38536/)

**HTML**

```
<!-- Left Button. -->
<div style="float:left;">
    <!-- (1) Whilst it's pressed, increment the scroll. When we release, clear the timer to stop recursive scroll calls. -->
    <input type="button" value="«" style="height: 100px;" onmousedown="scroll('scroller',3, 10);" onmouseup="clearTimeout(TIMER_SCROLL);"/>
</div>
<!-- Contents to scroll. -->
<div id="scroller" style="float: left; width: 100px; height: 100px; overflow: hidden;">
    <!-- <3 -->
    <img src="https://cdn.sstatic.net/Sites/stackoverflow/company/img/logos/so/so-logo.png?v=9c558ec15d8a" alt="image large" style="height: 100px" />
</div>
<!-- Right Button. -->
<div style="float:left;">
    <!-- As (1). (Use a negative value of 'd' to decrease the scroll.) -->
    <input type="button" value="»" style="height: 100px;" onmousedown="scroll('scroller',-3, 10);" onmouseup="clearTimeout(TIMER_SCROLL);"/>
</div> 
```

**JavaScript**

```
// Declare the Shared Timer.
var TIMER_SCROLL;
/** 
Scroll function. 
@param id  Unique id of element to scroll.
@param d   Amount of pixels to scroll per sleep.
@param del Size of the sleep (ms).*/
function scroll(id, d, del){
    // Scroll the element.
    document.getElementById(id).scrollLeft += d;
    // Perform a delay before recursing this function again.
    TIMER_SCROLL = setTimeout("scroll('"+id+"',"+d+", "+del+");", del);
 } 
```

归功于[Dux](http://www.solucior.com/34-Horizontal_scroll_div_with_javascript.html)。

* * *

*自动动画滚动*

此外，这里还有`<div>`完全左右滚动 a 的功能。我们在这里唯一改变的是，在再次递归调用滚动之前，我们检查滚动的完整扩展是否已被利用。

**JSFiddle**

[https://jsfiddle.net/0nLc2fhh/1/](https://jsfiddle.net/0nLc2fhh/1/)

**HTML**

```
<!-- Left Button. -->
<div style="float:left;">
    <!-- (1) Whilst it's pressed, increment the scroll. When we release, clear the timer to stop recursive scroll calls. -->
    <input type="button" value="«" style="height: 100px;" onclick="scrollFullyLeft('scroller',3, 10);"/>
</div>
<!-- Contents to scroll. -->
<div id="scroller" style="float: left; width: 100px; height: 100px; overflow: hidden;">
  <!-- <3 -->
  <img src="https://cdn.sstatic.net/Sites/stackoverflow/company/img/logos/so/so-logo.png?v=9c558ec15d8a" alt="image large" style="height: 100px" />
</div>
<!-- Right Button. -->
<div style="float:left;">
    <!-- As (1). (Use a negative value of 'd' to decrease the scroll.) -->
    <input type="button" value="»" style="height: 100px;" onclick="scrollFullyRight('scroller',3, 10);"/>
</div> 
```

**JavaScript**

```
// Declare the Shared Timer.
var TIMER_SCROLL;
/** 
Scroll fully left function; completely scrolls  a <div> to the left, as far as it will go.
@param id  Unique id of element to scroll.
@param d   Amount of pixels to scroll per sleep.
@param del Size of the sleep (ms).*/
function scrollFullyLeft(id, d, del){
    // Fetch the element.
    var el = document.getElementById(id);
    // Scroll the element.
    el.scrollLeft += d;
    // Have we not finished scrolling yet?
    if(el.scrollLeft < (el.scrollWidth - el.clientWidth)) {
        TIMER_SCROLL = setTimeout("scrollFullyLeft('"+id+"',"+d+", "+del+");", del);
    }
}

/** 
Scroll fully right function; completely scrolls  a <div> to the right, as far as it will go.
@param id  Unique id of element to scroll.
@param d   Amount of pixels to scroll per sleep.
@param del Size of the sleep (ms).*/
function scrollFullyRight(id, d, del){
    // Fetch the element.
    var el = document.getElementById(id);
    // Scroll the element.
    el.scrollLeft -= d;
    // Have we not finished scrolling yet?
    if(el.scrollLeft > 0) {
        TIMER_SCROLL = setTimeout("scrollFullyRight('"+id+"',"+d+", "+del+");", del);
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-02-27T15:08:14.583

这就是最终为我服务的东西

```
/** Set parent scroll to show element
 * @param element {object} The HTML object to show
 * @param parent {object} The HTML object where the element is shown  */
var scrollToView = function(element, parent) {
    //Algorithm: Accumulate the height of the previous elements and add half the height of the parent
    var offsetAccumulator = 0;
    parent = $(parent);
    parent.children().each(function() {
        if(this == element) {
            return false; //brake each loop
        }
        offsetAccumulator += $(this).innerHeight();
    });
    parent.scrollTop(offsetAccumulator - parent.innerHeight()/2);
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-02-14T21:18:05.697

其他答案都没有解决我的问题。

我玩弄了[scrollIntoView](https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView)参数并设法找到了解决方案。设置`inline`to`start`和`block`to`nearest`防止父元素（或整个页面）滚动：

```
document.getElementById(chr).scrollIntoView({
   behavior: 'smooth',
   block: 'nearest',
   inline: 'start'
}); 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2019-03-21T01:46:32.753

浏览器会自动滚动到一个获得焦点的元素，所以你也可以用它来包装你需要滚动到的元素，`<a>...</a>`然后当你需要滚动时，只需将焦点设置在那个`a`

# opengl - 如何恢复glScalef（）？

> ID：635708
> 
> 赞同：5
> 
> 时间：2009-03-11T18:12:39.867
> 
> 标签：opengl, zooming, scaling

我使用 glScalef() 来放大我的程序，现在当我使用代码将其恢复为原始大小时：

```
glScalef(1.0f/ZOOM, 1.0f/ZOOM, 1); 
```

它在高变焦时效果不佳......（可能是因为丢失了小数点？）

我如何在没有像上面这样的任何计算的情况下将它完美地恢复到原始大小？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-11T18:16:16.020

你可以这样做：

```
ZOOMSQRT = sqrt(ZOOM);
glScalef(1.0f/ZOOMSQRT, 1.0f/ZOOMSQRT, 1);
glScalef(1.0f/ZOOMSQRT, 1.0f/ZOOMSQRT, 1); 
```

或者使用 glPushMatrix/glPopMatrix 在缩放前恢复原始矩阵：

```
glPushMatrix();
glScalef(ZOOM, ZOOM, 1);
[do whatever you like here...]
glPopMatrix(); // now it's at normal scale again
[do other things here...] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T18:17:28.560

您可以简单地保存您的投影矩阵。glPushMatrix(), glScalef(), ..., glPopMatrix()

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T18:18:41.253

在你的第一个 glScalef() 之前使用 glPushMatrix() 将当前模型矩阵推入堆栈，然后当你想取回原始比例时使用 glPopMatrix() ，这样不会有任何舍入错误，因为没有计算正在做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T18:16:48.793

将以前的大小存储在某个地方，比如说在堆栈中，然后使用它。

（动画转换回之前的缩放、平移和旋转设置比缩放更有趣）

# cocoa - 将 unicode 转义为 Cocoa 中的 unicode 字符

> ID：635709
> 
> 赞同：0
> 
> 时间：2009-03-11T18:12:41.567
> 
> 标签：cocoa, unicode, escaping, unicode-string

我从一个我转换`NSURLConnection`的对象中得到`NSData`

```
[[NSMutableString alloc] initWithData:[self urlData] encoding:NSUTF8StringEncoding] 
```

到一个`NSMutableString`。经过一些“修订”后，我将其显示在`NSTextField`.
但是当响应包含超过 utf8 的字符串时，会显示：

[问题 http://b5.s3.p.quickshareit.com/files/screenshot_466c60a6beaa2b390.png](http://b5.s3.p.quickshareit.com/files/screenshot_466c60a6beaa2b390.png)

这个 "➡" 应该是`one`unicode 字符。之后的字符`.ws/`似乎是我想解决的另一个问题。:)

如果有办法没有碳，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T18:39:13.937

"a1" 是一个 HTML/XML[字符引用](http://www.w3.org/TR/html4/charset.html#h-5.3.1)，我认为它不是由您在显示的代码中执行的任何编码/解码引起的。也就是说，这几乎可以肯定地在源代码中出现。

看起来[这个页面](http://discussions.apple.com/message.jspa?messageID=8064367#8064367)（通过[这个页面](http://forums.macrumors.com/archive/index.php/t-606180.html)）在底部有一些示例代码，可能有助于将它们转换为正确的字符：一个使用 NSXMLParser 的版本，一个使用 CFXMLCreateStringByUnescapingEntities 的版本。

# language-agnostic - 通过信息隐藏进行有效封装的绝妙例子？

> ID：635715
> 
> 赞同：11
> 
> 时间：2009-03-11T18:15:06.163
> 
> 标签：language-agnostic, oop, encapsulation, abstraction, information-hiding

*”**抽象**和**封装**是互补的概念：抽象关注对象的可观察行为……封装关注引起这种行为的实现……封装通常通过**信息隐藏**来实现，即隐藏所有信息的过程对象的秘密对其本质特征没有贡献。”* - **Grady Booch**面向对象分析和设计

你能告诉我一些通过信息隐藏封装的好处的令人信服的例子吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-11T18:23:07.563

我的第一个 OO 课程中给出的示例：

想象一个媒体播放器。它**抽象**了播放、暂停、快进等概念。作为用户，您可以使用它来操作设备。

您的 VCR 实现了此接口并**隐藏**或**封装**了机械驱动器和磁带的详细信息。

当媒体播放器的新**实现出现时（例如 DVD 播放器，它使用光盘而不是磁带），它可以替换****封装**在媒体播放器中的实现，并且用户可以像使用 VCR 一样继续使用它（相同的操作，例如如播放、暂停等...）。

这就是通过**抽象****隐藏信息**的概念。它允许在用户无需知道的情况下更改实现细节，并促进代码的低[耦合](http://en.wikipedia.org/wiki/Coupling_(computer_science))。

 *** * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-11T18:21:23.683

*nix 将字符流（磁盘文件、管道、套接字、tty 等）抽象为单个实体（“一切都是文件”）模型，允许将各种工具应用于各种数据源/ 以一种没有封装根本不可能的方式下沉。

同样，各种语言中流的概念，对列表、数组、文件等进行抽象。

此外，诸如数字之类的概念（对整数、六种浮点数、有理数等进行抽象）可以想象，如果更高级别的代码被赋予尾数格式等等并让其自生自灭，这将是一场多么可怕的噩梦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-18T22:48:17.293

我知道已经有一个公认的答案，但我想再抛出一个：OpenGL/DirectX

这些 API 都不是完整的实现（尽管 DirectX 在这方面肯定是头重脚轻），而是将渲染命令传送到图形卡的通用方法。

卡供应商是为特定卡提供实现（驱动程序）的供应商，在许多情况下，它是非常特定于硬件的，但作为用户，您永远不需要关心一个用户正在运行 GeForce ABC 而另一个用户正在运行 Radeon XYZ，因为确切的实现隐藏在高级 API 后面。如果不是这样，您将需要在您的游戏中为您想要支持的市场上的每张卡都有一个代码路径，这从第一天起就完全无法管理。这种方法的另一个重要优点是 Nvidia/ATI 可以发布一个更新，更高效的驱动程序版本，您无需付出任何努力即可自动受益。

同样的原理也适用于声音、网络、鼠标、键盘……基本上是计算机的任何组件。无论封装发生在硬件级别还是软件驱动程序中，在某些时候，所有设备细节都被隐藏起来，以便您可以将任何键盘视为键盘，而不是 Microsoft Ergonomic Media Explorer Deluxe Revision 2 .

当您以这种方式看待它时，很快就会发现，如果没有我们今天所知道的某种形式的封装/抽象计算机根本无法工作。这对你来说足够精彩吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T18:19:07.650

什么？你还不相信？

显示相反的情况更容易。我们过去常常编写无法控制谁可以访问其实现细节的代码。这使得有时几乎不可能确定哪些代码修改了变量。

此外，如果世界上的每一段代码都可能依赖于特定具体类的实现，那么你就不能真正抽象出一些东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T18:21:35.803

世界上几乎每个 Java、C# 和 C++ 代码库都具有信息隐藏功能：就像类的 private: 部分一样简单。

外部世界看不到私有成员，因此开发人员可以更改它们而无需担心其余代码无法编译。

# .net - 如何通过代码阅读所有共享的谷歌阅读器提要？

> ID：635719
> 
> 赞同：3
> 
> 时间：2009-03-11T18:16:03.587
> 
> 标签：.net, asp.net, feed, google-reader

我在我的谷歌阅读器上分享了很多提要，我想要一些使用 asp.net 的代码来阅读所有这些提要并放入一个页面，可能是分页，因为提要太多了。有人知道该怎么做吗？或者是否有工具

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T12:13:48.877

您可以在此处为您的提要找到 Atom 提要： [http ://www.google.com/reader/atom/](http://www.google.com/reader/atom/)

如果您登录 Google 阅读器并单击浏览器顶部的 RSS 按钮，您可以找到更具体的网址。

然后你只需要一些东西来阅读你的提要。这是为此目的的第三方库。 [http://atomnet.sourceforge.net/](http://atomnet.sourceforge.net/)

使用非常简单

```
//Reads everything in the Atom document.
AtomFeed feed = AtomFeed.Load(new Uri("http://www.yourfeed.com/atom.xml"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-13T19:18:57.743

您可以使用[RSSToolkit](http://blogs.msdn.com/shahpiyush/archive/2007/06/16/3331941.aspx)来阅读共享提要

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T18:37:19.383

我认为谷歌阅读器目前还没有官方 API。但是为你找到了[这个](http://www.niallkennedy.com/blog/2005/12/google-reader-api.html)。这也有共享项目。查看。

更新：谷歌阅读器有一个[API](http://www.niallkennedy.com/blog/2005/12/google-reader-api.html#comment8093)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T13:27:37.313

我也找到了这个，它接缝很好： http: [//www.codeproject.com/KB/cs/rssframework.aspx](http://www.codeproject.com/KB/cs/rssframework.aspx)

# windows - mxmlc 在 linux 和 windows 下的编译方式不同？

> ID：635720
> 
> 赞同：2
> 
> 时间：2009-03-11T18:16:15.597
> 
> 标签：windows, linux, apache-flex

我有一个项目，其中包含由单个预加载器 swf 加载的多个组件。

预加载器 swf 严格遵循 AS3（无 flex），并使用 Loaders 加载两个不同的 swf，它们都使用 flex 库（静态编译，而不是 rsl）。

当我在 linux 下编译所有三个并运行生成的预加载器时，其中一个 swf 无法正确加载，并引发下面的异常（在这篇文章的底部）。

如果我在 Windows 中使用相同的 ant 任务编译相同的组件，则该组件加载得很好，没有错误。Windows 文件也小了 683 字节。

在 linux 和 windows 下使用 flex SDK 3.2.0 和 3.3.0 也是如此。

你见过这种行为吗？您能否就为什么会发生这种情况或如何确定问题所在提供任何建议？

```
TypeError: Error #1009: Cannot access a property or method of a null object reference.
at mx.managers::FocusManager/activate()
at mx.managers::SystemManager/activateForm()
at mx.managers::SystemManager/activate()
at mx.core::Application/initManagers()
at mx.core::Application/initialize()
at OC_Footer/initialize()
at mx.managers::SystemManager/http://www.adobe.com/2006/flex/mx/internal::childAdded()
at mx.managers::SystemManager/initializeTopLevelWindow()
at mx.managers::SystemManager/http://www.adobe.com/2006/flex/mx/internal::docFrameHandler()
at mx.managers::SystemManager/docFrameListener() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T18:32:40.520

等等，您是否在每个平台上使用不同版本的 SDK？这肯定会导致一些差异（至少在 swf 的大小上......）

IIUC 在浏览器中加载页面时会出现此错误，对吗？仅从堆栈跟踪很难判断出了什么问题，但我可以告诉你，我曾经在 Windows 上遇到过类似的错误，它与键盘事件有关（例如，当弹出窗口可见时，使用 tab 键在元素之间移动，和类似的东西）。抱歉，我无法提供更准确的诊断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T17:44:55.517

我不确定我是否解决了真正的问题（为什么不同操作系统下的编译不同），但我发现较新版本的 flex SDK 不会*出现*相同的问题。

我在这里为这个问题创建了一个错误：

[https://bugs.adobe.com/jira/browse/SDK-20147](https://bugs.adobe.com/jira/browse/SDK-20147)

简而言之，构建 3958（在我创建错误时使用 flexbuilder 的一个默认值——这可能仍然是正确的）似乎有许多小错误。升级 flex SDK 构建 4852 可以缓解症状，我可以在多个环境中成功构建项目。

# javascript - 更改父窗口时如何阻止 IE 在 IFrame 中显示 URL

> ID：635723
> 
> 赞同：2
> 
> 时间：2009-03-11T18:16:37.953
> 
> 标签：javascript, internet-explorer, iframe

在 IFrame 中使用 javascript:parent.location.href 更改父窗口时，IE 会短暂更改 IFrame 内容以列出父窗口正在更改的 url。Firefox、chrome 和opera 只是改变了父窗口。

有没有办法让 IE 跳过在 IFrame 中显示 url 而只是更改父级？

**[编辑]**

这是复制它的示例代码。

框架页面：

```
<iframe id="finder" name="finder" src="content.html" scrolling="no" height="620" width="620" style="border:1px #c0c0c0 solid;"></iframe> 
```

内容页：

```
<a href='javascript:parent.location.href="http://www.google.com"'>test link</a> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T19:51:38.147

发生这种情况是因为您正在评估表达式，而不是调用方法。

```
parent.location.href = "http://www.google.com"; 
```

如果我们将其移至显式函数，我们将不再看到以下行为：

```
<a href="javascript:void(parent.location.href = 'http://www.google.com')">test link</a> 
```

但是，当然，没有理由在这种特定情况下使用 JS：

```
<a href="http://www.google.com/" target="_parent">test link</a> 
```

如果有，我们仍然应该优雅地降级：

```
<a href="http://www.google.com/" target="_parent">test link</a>

<script type="text/javascript">
    var links = document.getElementsByTagName('a');
    for(var i=0;i<links.length;i++) {
        if(links[i].target == '_parent') {
            links[i].onclick = handleParentClick;
        }
    }

    function handleParentClick(e) {
        var sender = e ? (e.target || e) : window.event.srcElement;
        parent.location.href = sender.href;
        return false;
    }
</script> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-11T20:08:28.760

如果您将其更改为以下内容，则可以保留 javascript 内联：

```
<a href='javascript:void(parent.location.href="http://www.google.com")'>test link</a> 
```

通常，“set”表达式也返回表达式的右侧。IE 获取表达式的返回值并显示它。通过将“void()”放在它周围，您可以删除返回值，这样 IE 就不会显示它。

# data-structures - 与布隆过滤器相反？

> ID：635728
> 
> 赞同：64
> 
> 时间：2009-03-11T18:18:01.367
> 
> 标签：data-structures, bloom-filter

我正在尝试优化一个基本上运行数百万次测试的软件。这些测试的生成方式可以有一些重复。当然，如果我能有效地避免它，我不想花时间运行我已经运行过的测试。

所以，我正在考虑使用布隆过滤器来存储已经运行的测试。然而，布隆过滤器对我来说是不安全的。它给出了误报。也就是说，它可能会报告我已经运行了一个我没有运行的测试。虽然这在我正在处理的场景中是可以接受的，但我想知道是否存在与 Bloom 过滤器等效的方法，但在相反的方面犯了错误，即只给出假阴性。

我浏览了文献，没有任何运气。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-06-15T05:55:45.450

是的，有损哈希表或 LRUCache 是一种具有快速 O(1) 查找的数据结构，只会给出假阴性——如果你问“我是否运行了测试 X”，它会告诉你“是的，你肯定有”或“我不记得了”。

原谅极其粗糙的伪代码：

```
setup_test_table():
    create test_table( some large number of entries )
    clear each entry( test_table, NEVER )
    return test_table

has_test_been_run_before( new_test_details, test_table ):
    index = hash( test_details , test_table.length )
    old_details = test_table[index].detail
    // unconditionally overwrite old details with new details, LRU fashion.
    // perhaps some other collision resolution technique might be better.
    test_table[index].details = new_test_details
    if ( old_details === test_details ) return YES
    else if ( old_details === NEVER ) return NEVER
    else return PERHAPS    

main()
    test_table = setup_test_table();
    loop
        test_details = generate_random_test()
        status = has_test_been_run_before( test_details, test_table )
        case status of
           YES: do nothing;
           NEVER: run test (test_details);
           PERHAPS: if( rand()&1 ) run test (test_details);
    next loop
end. 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-06-13T17:42:15.580

完成此任务的确切数据结构是[直接映射缓存](http://en.wikipedia.org/wiki/CPU_cache#Direct-mapped_cache)，通常用于 CPU。

```
function set_member(set, item)
    set[hash(item) % set.length] = item

function is_member(set, item)
    return set[hash(item) % set.length] == item 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-09T21:18:45.263

是否可以存储您**未**运行的测试？这应该与过滤器的行为相反。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T06:46:56.577

LRUCache 怎么样？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-17T15:02:02.957

1.  如上所述，使用位设置。如果你知道没有。在您要预先运行的测试中，您将始终从数据结构中获得正确的结果（存在，不存在）。
2.  你知道你将要散列什么键吗？如果是这样，您应该运行一个实验来查看 BloomFilter 中键的分布，以便您可以对其进行微调以重现误报，或者您有什么。
3.  您可能还想查看 HyperLogLog。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T07:17:46.447

对不起，我帮不上什么忙——我认为这不可能。如果无法订购测试执行，则可以使用打包格式（每字节 8 个测试！）或用于将结果存储在内存中的良好稀疏数组库。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-11T18:41:33.743

不，如果您考虑一下，它不会很有用。在您的情况下，您无法确定您的测试运行是否会停止，因为如果总是存在“假阴性”，那么总会有需要运行的测试......

我会说你只需要使用哈希。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-24T17:42:08.303

您期望的数据结构不存在。因为这样的数据结构必须是多对一的映射，或者说，一个有限的状态集。必须至少有两个不同的输入映射到相同的内部状态。因此，您无法判断它们是否都（或更多）都在集合中，只知道至少存在一个这样的输入。

编辑此语句仅在您正在寻找内存高效的数据结构时才成立。如果内存是无限的，您总是可以通过存储每个成员项目来获得一个给出 100% 准确结果的数据结构。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-05-08T16:38:34.507

我认为您遗漏了部分解决方案；为了完全避免误报，您仍然必须跟踪哪些已经运行，并且基本上使用布隆过滤器作为确定测试肯定没有运行的快捷方式。

也就是说，由于您事先知道测试的数量，因此您可以使用一些众所周知的公式来调整过滤器的大小，以提供可接受的错误率；对于返回误报的概率为 1%，您需要 ~9.5 位/条目，因此对于一百万个条目，1.2 兆字节就足够了。如果您将可接受的错误率降低到 0.1%，这只会增加到 1.8 MB。

Wikipedia 文章[Bloom Filters](http://en.wikipedia.org/wiki/Bloom_filter)给出了很好的分析，并对所涉及的数学进行了有趣的概述。

# c# - 异步 Web 服务调用是否总是调用 AsyncCallback？

> ID：635730
> 
> 赞同：1
> 
> 时间：2009-03-11T18:18:10.977
> 
> 标签：c#, .net, web-services

我正在从 C# 应用程序进行异步 Web 服务调用：

```
{
  //Put UI in 'loading' state
  ...

  //Now call web service
  webServiceProxy.BeginMyMethod(param, new AsyncCallback(MyCallback), null);
}

private void MyCallback(IAsyncResult res)
{
   ...
   //process result

   // Put UI back in normal state (yes I'm marshalling back to the UI thread)
} 
```

主线程将应用程序置于“等待”模式，然后回调函数结束重新启用控件。我看到一个错误，偶尔，UI 会永远卡在加载模式中。

现在回调代码中可能只有一个错误（那里有很多），但我在这里向社区提出的问题是：

是否保证调用“MyCallback”？假设“BeginMyMethod”没有抛出异常，我可以确定 MyCallback 会被执行吗？我在 BeginXXX 函数返回的 IAsyncResult 上看到“CompletedSynchronously”和“IsCompleted”，但我不确定这是否重要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T19:16:35.437

是的，保证会调用回调。`Begin*`回调允许使用/模式的异步代码 `End*`以连续传递样式编写。

但是，您必须在回调中调用相应的`End*`方法（通常是回调中的第一件事）。这是异步方法如何发出调用期间可能发生的异常的信号，一方面，以及获取结果的方式（如果有的话）。

在使用 C# 2.0 时使用匿名委托编码异步模式有时更优雅，并且允许在调用开始时编写调用后延续，并且允许通过捕获的变量更轻松地共享数据，提供适当的同步措施被使用。

参考：[http://msdn.microsoft.com/en-us/library/ms228972.aspx](http://msdn.microsoft.com/en-us/library/ms228972.aspx)：

> 可以在等待异步操作结果时执行其他工作的应用程序不应阻塞等待，直到操作完成。使用以下选项之一在等待异步操作完成时继续执行指令：
> 
> *   使用 AsyncCallback 委托在单独的线程中处理异步操作的结果。本主题演示了这种方法。
> 
> [...]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T19:17:37.667

无论操作是同步完成还是异步完成，都会调用 AsyncCallback。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T18:20:43.963

我相信如果 CompletedSynchronously 属性为真，则不能保证调用回调。

# asp.net - ASP DropDownList UpdatePanel IE JS 错误

> ID：635739
> 
> 赞同：0
> 
> 时间：2009-03-11T18:19:19.380
> 
> 标签：asp.net, ajax, updatepanel

我在 IE 中遇到了一个特殊的 javascript 错误。我有一个更新面板，里面有一个下拉列表。当我更改下拉列表的值时，它给了我错误“第 5 行'__EVENTTARGET' 为空或不是对象'。我看了一下，第 5 行和 __EVENTTARGET 在 ASP.NET 生成的 javascript 代码中。

我想要一个下拉列表，在选择新选项时触发方法，没有页面闪烁。

这是我的一些代码：

```
<asp:ScriptManager ID="uxScriptMan" runat="server" />
<asp:UpdatePanel ID="uxtestupdatepanel" runat="server">
<ContentTemplate>
<asp:DropDownList ID="DropDownList1" runat="server" 
    AutoPostBack="true" OnSelectedIndexChanged="TESTMETHOD">
 <asp:ListItem Text="TEST" Selected="true" />
 <asp:ListItem Text="Yes" Value="1" />
 <asp:ListItem Text="No" Value="0" />
</asp:DropDownList>
</ContentTemplate>
</asp:UpdatePanel> 
```

和

```
protected void TESTMETHOD(object sender, EventArgs e) { /*do nothing*/ } 
```

在 Firefox 中，它可以工作，没有错误。事实上，在开发机器上，带有 .aspx 和 .aspx.cs 文件的未编译解决方案在 IE 中没有错误。在生产机器上编译，我得到 IE js 错误。

什么问题，我该如何解决，或者至少，我可以从哪里开始寻找？没有太多运气完成了大量的谷歌搜索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T18:28:00.343

在黑暗中开枪，您的服务器是否具有与您的开发环境相同的服务包？

如果您使用的是 .NET 3.5 SP1，则服务包会产生很大的不同，并且可能会导致奇怪的差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T18:39:59.597

两者都有相同的 web.config 吗？您的产品可能缺少 ScriptResource.axd 的资源处理程序

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T20:00:39.573

修复！这是 Duck 和 ck 评论的结合。

多谢你们。

这是一个 web.config 问题。这个特定应用程序的 web.config 与我们在服务器上使用的其他一些应用程序不同。这是针对遇到此问题的其他任何人的修复程序。

**不正确的 web.config：**

```
<compilation debug="false">
        <assemblies>
            <add assembly="System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
            <add assembly="System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
        </assemblies>
    </compilation>

 <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <dependentAssembly>
            <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
            <bindingRedirect oldVersion="1.0.61025.0" newVersion="3.5.0.0"/>
        </dependentAssembly>
    </assemblyBinding>
</runtime> 
```

**正确的 web.config：**

```
<compilation debug="false">
  <assemblies>
    <add assembly="System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
    <add assembly="System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Web.Extensions.Design, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
  </assemblies> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T18:38:11.910

尝试设置 ScriptManager EnablePartialRendering 属性

```
EnablePartialRendering="false" 
```

看看你是否仍然得到错误

还尝试关闭该页面上的事件验证

```
<%@ Page EnableEventValidation="false" %> 
```

看看你是否仍然得到错误

# php - 添加 URL 参数以使用 Zend 框架切换视图的最佳方法是什么？

> ID：635746
> 
> 赞同：2
> 
> 时间：2009-03-11T18:21:08.737
> 
> 标签：php, model-view-controller, zend-framework, mobile, wml

我正在使用 Zend 框架开发一个移动站点，该站点有两种可能的输出格式（WML 和 XHTML）。我使用相同的模型和控制器，然后只设置在控制器中渲染哪个视图。目前，这是由 HTTP Accept 标头决定的。这也需要在 URL 中定义。我想这样做的方式是使用如下 URL： [http :](http://example.com/xhtml/controller/action) [//example.com/wml/controller/action http://example.com/xhtml/controller/action](http://example.com/wml/controller/action)

使用 Zend 框架实现这一目标的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T19:30:03.737

您需要查看Action Helpers 部分下的[上下文切换。](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html)您可以通过 URL 传递格式参数，它将更改来自操作的输出类型。您应该能够轻松地为 WML 创建一个 Context 类。

因此，您的 URL 看起来像这样：

[http://www.example.com/controller/action/format/wml](http://www.example.com/controller/action/format/wml)

# c# - 摆脱 C# 数组中的空/空字符串值

> ID：635751
> 
> 赞同：36
> 
> 时间：2009-03-11T18:22:08.547
> 
> 标签：c#, arrays, null, string

我有一个程序，其中数组使用 string.Split(char[] delimiter) 获取其数据。（使用 ';' 作为分隔符。）

但是，有些值是空的。即字符串有部分没有数据，所以它做这样的事情：

> 1 ;2 ; ; 3；

这导致我的数组具有空值。

我该如何摆脱它们？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-03-11T18:24:04.627

试试这个：

```
yourString.Split(new string[] {";"}, StringSplitOptions.RemoveEmptyEntries); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T18:27:30.237

您可以使用 Where linq 扩展方法仅返回非空值或空值。

```
string someString = "1;2;;3;";

IEnumerable<string> myResults = someString.Split(';').Where<string>(s => !string.IsNullOrEmpty(s)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-01T07:32:49.790

```
public static string[] nullLessArray(string[] src)
{
    Array.Sort(src);
    Array.Reverse(src);
    int index = Array.IndexOf(src, null);

    string[] outputArray = new string[index];

    for (int counter = 0; counter < index; counter++)
    {
       outputArray[counter] = src[counter];
    }

    return outputArray;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-22T07:26:20.977

在拆分数据之前，您应该用一个分号替换多个相邻的分号。

这将用一个分号替换两个分号：

```
datastr = datastr.replace(";;",";"); 
```

但是，如果你有两个以上的分号，那么正则表达式会更好。

```
datastr = Regex.Replace(datastr, "([;][;]+)", ";"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-08T09:27:40.570

```
 words = poly[a].Split(charseparators, StringSplitOptions.RemoveEmptyEntries);

                foreach (string word in words)
                    {   
                        richTextBox1.Text += (d + 1)+ "  " + word.Trim(',')+ "\r\n";
                        d++;
                    } 
```

字符分隔符是一个空格

# regex - 使用 GNU libc regexec() 计算子字符串

> ID：635756
> 
> 赞同：1
> 
> 时间：2009-03-11T18:23:33.660
> 
> 标签：regex, glibc

是否可以使用与 GNU libc regexec() 匹配的正则表达式来计算子字符串在字符串中出现的次数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T21:12:42.943

不， regexec() 每次调用只能找到一个匹配项。如果你想找到下一个匹配，你必须沿着字符串再次调用它。

如果您只想搜索普通子字符串，最好使用标准 C string.h 函数[strstr()](http://www.opengroup.org/onlinepubs/9699919799/functions/strstr.html)；那么您不必担心转义特殊的正则表达式字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T16:21:39.973

regexec 在其第四个参数“pmatch”中返回一个包含所有匹配项的结构。“pmatch”是一个固定大小的结构，如果有更多匹配，您将再次调用该函数。

我发现这段代码有两个嵌套循环，我已经修改了它。[您可以在http://www.lemoda.net/c/unix-regex/index.html](http://www.lemoda.net/c/unix-regex/index.html)中找到原始鳕鱼：

```
static int match_regex (regex_t * r, const char * to_match)
{
    /* "P" is a pointer into the string which points to the end of the
       previous match. */
    const char * p = to_match;
    /* "N_matches" is the maximum number of matches allowed. */
    const int n_matches = 10;
    /* "M" contains the matches found. */
    regmatch_t m[n_matches];
    int number_of_matches = 0;
    while (1) {
        int i = 0;
        int nomatch = regexec (r, p, n_matches, m, 0);
        if (nomatch) {
            printf ("No more matches.\n");
            return nomatch;
        }
        for (i = 0; i < n_matches; i++) {
            if (m[i].rm_so == -1) {
                break;

            }
            number_of_matches ++;
        }
        p += m[0].rm_eo;
    }
    return number_of_matches ;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-27T02:26:59.920

很抱歉创建另一个答案，因为我没有 50 声望。我无法评论@Oscar Raig Colon 的回答。

pmatch 不能匹配所有的子字符串，pmatch 是用来保存子表达式的偏移量，关键是要明白什么是子表达式，子表达式在 BRE 中是“\(\)”，在 ERE 中是“()”。如果整个正则表达式中没有子表达式，regexec() 只返回第一个匹配字符串的偏移量并将其放入pmatch[0]。

[您可以在 [ http://pubs.opengroup.org/onlinepubs/007908799/xsh/regcomp.html][1]](http://pubs.opengroup.org/onlinepubs/007908799/xsh/regcomp.html%5d%5b1%5d)找到一个示例

下面演示了 REG_NOTBOL 标志如何与 regexec() 一起使用来查找行中与用户提供的模式匹配的所有子字符串。（为简单起见，很少进行错误检查。）

```
(void) regcomp (&re, pattern, 0);
/* this call to regexec() finds the first match on the line */
error = regexec (&re, &buffer[0], 1, &pm, 0);
while (error == 0) {    /* while matches found */
    /* substring found between pm.rm_so and pm.rm_eo */
    /* This call to regexec() finds the next match */
    error = regexec (&re, buffer + pm.rm_eo, 1, &pm, REG_NOTBOL);
} 
```

# asp.net - 如何处理电子商店购物车中的零碎数量？

> ID：635760
> 
> 赞同：1
> 
> 时间：2009-03-11T18:24:56.577
> 
> 标签：asp.net, user-interface, shopping-cart

我正在建立一个电子商店，我需要能够将小批量添加到购物车中。

管理员会为每个产品设置一个分母（例如 8 表示最小购买量是一箱的 1/8）

我目前使用[jQuery 滑块](http://jqueryui.com/demos/slider/)并在其中显示数量，`asp:Label`这在产品页面上工作得很好，但是在购物车中有多个滑块时它会失控（我需要允许客户调整购物车中的数量）。

我真的很想远离丑陋的下拉列表。

有任何想法吗？

### 编辑：

固定分母是不可能的... 4/8 必须显示为 1/2 ...

### 编辑2：

可用性也很重要，当客户想要从 1/16 箱增加到 3 箱时，每次点击 + 1/分母增量不会很好

### 编辑3：

@RichB：为一小部分案例添加 SKU 可以追溯到固定分母问题。如果我为 1/16 的箱子添加 SKU，而用户想要 1/2 的箱子，他们将不得不订购 8x1/16 的 [不酷]。如果您想为每个可能的部分添加一个 SKU（本例中为 15 个 SKU - 这将使我的产品页面和 CART 方式变得混乱。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T18:27:26.180

一种方法是让您的数量文本框后跟一个“/ [分母]”字符串，这将允许他们说出类似 [4] / 8 的内容来指定半个案例 8。

你唯一的问题是你将有一个简单的方法来跟踪这些分母是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T18:41:32.980

另一种可能的解决方案（因为您反对使用固定分母），是使用一系列向上/向下箭头/按钮/任何东西，您可以使用向上和向下来增加或减少产品的数量（并且在每个增量/减量正确更新标签中的小数值）。

**编辑**：这可以通过添加一个单独的增量/减量按钮来进一步细化，以按整个案例而不是单个小数修改数量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T19:00:16.553

我将有一个字段，可以将其编辑为`3 6/4`. 但是，当字段失去焦点时，这将转换为最简单的混合分数（`4 1/2`例如）。

这允许输入的灵活性以及良好的数字格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T20:21:59.400

> **更新**：OP 说“这正是我现在正在使用的，但是当我进入 CART [并且在购物车中有 10 件商品] 时，管理多个滑块变得有问题。这就是我正在寻找替代解决方案的原因”

会像以下工作吗？

看到它在[这里](http://jsbin.com/ureje)工作。（[在这里](http://jsbin.com/ureje/edit)编辑）

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script> 
<link rel="stylesheet" href="http://jquery-ui.googlecode.com/svn/tags/1.7/themes/base/ui.all.css" type="text/css" /> 
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7/jquery-ui.min.js"></script> 

<div class="demo"> 
    <p> 
        <label for="amount">amount :</label> 
        <input type="text" id="amount" /> 
    </p>     
 <div id="slider"></div> 
</div>

var maxDenominator = 16;
var maxWholeCases = 50;

function toFraction(sliderValue){
  var amount = sliderValue / maxDenominator;

  var whole = Math.floor(amount);
  var fractional = "";

  if (amount - whole)
     fractional =  fractApprox(amount - whole, maxDenominator);

  return whole + " " + fractional + " cases";
}

$(function() {
    $("#slider").slider({
        value:10 * maxDenominator,
        min: 0,
        max: maxWholeCases * maxDenominator,
        slide: function(event, ui) {
            $("#amount").val(toFraction(ui.value));
        }
    });
    $("#amount").val(toFraction($("#slider").slider("value")));
});

// from http://www.geneffects.com/briarskin/programming/newJSMathFuncs.html#fractApprox
function fractApprox(x,maxDenominator) {
    // Created 1997 by Brian Risk.  http://brianrisk.com
    maxDenominator = parseInt(maxDenominator);
    var approx = 0;
    var error = 0;
    var best = 0;
    var besterror = 0;
    for (var i=1; i <= maxDenominator; i++) {
        approx = Math.round(x/(1/i));
        error = (x - (approx/i))
        if (i==1) {best = i; besterror = error;}
        if (Math.abs(error) < Math.abs(besterror)) 
            {best = i; besterror = error;}
    }
    return (Math.round(x/(1/best)) + "/" + best);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-21T04:50:54.077

我最终将产品页面链接到购物车中的数量，因此用户可以使用产品页面上的滑块更新分数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-07T13:01:04.050

我会远离使用分数单位。而是尝试这样的事情。

[ _ _ _ ] 个案例 [ _ _ _ ] 个单独的单位

使用 2 个 SKU，1 个用于一个案例，1 个用于单个单元。

或者使用 product.quantity_per_case 将拆分定义为案例的一部分。

当我经营餐馆时，我总是这样点菜。它几乎不需要思考，因为您处理的不是分数，而是整数个案例和整数个单位。

大多数人将需要案例或拆分，但不是两者都需要。

# apache-flex - Flex：数据绑定手表

> ID：635762
> 
> 赞同：0
> 
> 时间：2009-03-11T18:25:37.837
> 
> 标签：apache-flex, flash, actionscript-3, data-binding, actionscript

鉴于此 MXML 组件：

`<mx:TextBox id="test" text="{test2.text.length &gt; 5}" />`

每当 test2.text.length > 5 的值发生变化时，如何调度事件？我已经尝试过 ChangeWatcher、BindUtils 和 PropertyChangeEvent，但没有运气:(

谢谢;

[编辑]

从更远的地方复制我的评论：

嗯...我实际上在我自己的TextField 组件中使用了一个新的可绑定字段，称为validationResult。我正在尝试进行原子验证而不是全部验证。反正。test2.text.length > 5 条件是每个实例定义的，所以我不能这样硬编码。

示例 MXML：

`<nui:NewTextInput id="mensualDeclarado2" validationResult="{mensualDeclarado3.text.length >= 5 && mensualDeclarado3.text.length <= 10)}" />`

`<nui:NewTextInput id="mensualDeclarado3" text="1234567890" />`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T19:04:56.493

为什么不通过 test2 的 change 事件中的新事件？

所以你有了

```
 private var _lengthCheck:Boolean = false;
 function test2_ChangeHandler(event:Event):void
 {
     if (_lengthCheck != (test2.text.length > 5))
     {
         _lengthCheck = (test2.text.length > 5);

         if (test2.text.length > 5)
             dispatch(new Event("LENGTH_GREATER_THAN_5"));
         else
             dispatch(new Event("LENGTH_LESS_THAN_5"));
     }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T20:02:30.050

```
<mx:Script>
<![CDATA[
   private var _test2 : String = "test2.text.length &gt; 5";

   public function set test2( _test2 : String ) : void{
      dispatchEvent(new Event("test2CHANGED"));
      this._test2 = _test2;
   }
]]>
</mx:Script>
<mx:TextBox id="test" text="{_test2}" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T04:32:35.550

您不能将“validationResult”定义为带有私有变量以保存数据的获取/设置对，并且每次使用与变量不同的值调用设置器时，设置值，然后调度您自己的自定义事件？这就是在 Flex 框架中完成了多少事件分派。

# perl - 如何在 Perl 中生成数组的所有排列？

> ID：635768
> 
> 赞同：20
> 
> 时间：2009-03-11T18:27:15.587
> 
> 标签：perl, algorithm, arrays, permutation

`n!`在 perl 中生成数组的所有排列的最佳（优雅、简单、高效）方法是什么？

例如，如果我有一个数组`@arr = (0, 1, 2)`，我想输出所有排列：

```
0 1 2
0 2 1
1 0 2
1 2 0
2 0 1
2 1 0 
```

它可能应该是一个返回迭代器的函数（延迟/延迟评估，因为`n!`可能变得如此之大），因此可以这样调用它：

```
my @arr = (0, 1, 2);
my $iter = getPermIter(@arr);
while (my @perm = $iter->next() ){
    print "@perm\n";
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-11T18:56:52.647

我建议你使用[List::Permutor](https://metacpan.org/pod/List::Permutor)：

```
use List::Permutor;

my $permutor = List::Permutor->new( 0, 1, 2);
while ( my @permutation = $permutor->next() ) {
    print "@permutation\n";
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-12T09:47:26.607

来自[perlfaq4](http://faq.perl.org/perlfaq4.html)：[“如何置换列表的 N 个元素？”](http://learn.perl.org/faq/perlfaq4.html#How-do-I-permute-N-elements-of-a-list) ：

* * *

在 CPAN 上使用 List::Permutor 模块。如果列表实际上是一个数组，请尝试 Algorithm::Permute 模块（也在 CPAN 上）。它是用 XS 代码编写的，非常高效：

```
use Algorithm::Permute;

my @array = 'a'..'d';
my $p_iterator = Algorithm::Permute->new ( \@array );

while (my @perm = $p_iterator->next) {
   print "next permutation: (@perm)\n";
} 
```

为了更快的执行，你可以这样做：

```
use Algorithm::Permute;

my @array = 'a'..'d';

Algorithm::Permute::permute {
    print "next permutation: (@array)\n";
} @array; 
```

这是一个小程序，它生成每行输入中所有单词的所有排列。permute() 函数中包含的算法在 Knuth 的计算机编程艺术的第 4 卷（仍未出版）中进行了讨论，并且适用于任何列表：

```
#!/usr/bin/perl -n
# Fischer-Krause ordered permutation generator

sub permute (&@) {
    my $code = shift;
    my @idx = 0..$#_;
    while ( $code->(@_[@idx]) ) {
        my $p = $#idx;
        --$p while $idx[$p-1] > $idx[$p];
        my $q = $p or return;
        push @idx, reverse splice @idx, $p;
        ++$q while $idx[$p-1] > $idx[$q];
        @idx[$p-1,$q]=@idx[$q,$p-1];
    }
}

permute { print "@_\n" } split; 
```

Algorithm::Loops 模块还提供了 NextPermute 和 NextPermuteNum 函数，它们可以有效地找到数组的所有唯一排列，即使它包含重复值，也可以就地修改它：如果它的元素是反向排序的，那么数组是反向的，使其排序，并返回false；否则返回下一个排列。

NextPermute 使用字符串顺序和 NextPermuteNum 数字顺序，因此您可以像这样枚举 0..9 的所有排列：

```
use Algorithm::Loops qw(NextPermuteNum);

my @list= 0..9;
do { print "@list\n" } while NextPermuteNum @list; 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-11T18:34:00.687

您可以使用[Algorithm::Permute](https://metacpan.org/pod/Algorithm::Permute)并且也许Iterate [Over Permutations](http://www.foo.be/docs/tpj/issues/vol3_3/tpj0303-0010.html)（Perl 杂志，1998 年秋季）对您来说是一本有趣的读物。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-09-22T03:38:02.860

试试这个，

```
use strict;
use warnings;

print "Enter the length of the string - ";
my $n = <> + 0;

my %hash = map { $_ => 1 } glob "{0,1,2}" x $n;

foreach my $key ( keys %hash ) {
    print "$key\n";
} 
```

输出：这将给出所有可能的数字组合。您可以添加逻辑以过滤掉不需要的组合。

```
$ perl permute_perl.pl 
Enter the length of the string - 3
101
221
211
100
001
202
022
021
122
201
002
212
011
121
010
102
210
012
020
111
120
222
112
220
000
200
110 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T20:13:18.267

看看[Iterator::Array::Jagged](https://metacpan.org/pod/Iterator::Array::Jagged)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-11T21:34:44.247

我建议查看一种[按字典顺序生成排列的算法](http://en.wikipedia.org/wiki/Permutation#Lexicographical_order_generation)，这就是我最近解决[问题 24](http://projecteuler.net/index.php?section=problems&id=24)的方法。当数组中的项目数变大时，稍后存储和排序排列变得昂贵。

它看起来像`List::Permutor`Manni 建议的，生成了数字排序的排列。这就是我使用 Perl 的目的。让我们知道结果如何。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-20T18:04:40.607

一个纯 Perl 的答案，如果想要比 CPAN 模块允许的更高级：

```
use strict;
use warnings;

print "(@$_)\n" for permutate('a'..'c');

sub permutate {
  return [@_] if @_ <= 1;
  map {
    my ($f, @r) = list_with_x_first($_, @_);
    map [$f, @$_], permutate(@r);
  } 0..$#_;
}

sub list_with_x_first {
  return if @_ == 1;
  my $i = shift;
  ($_[$i], @_[0..$i-1], @_[$i+1..$#_]);
} 
```

印刷：

```
(a b c)
(a c b)
(b a c)
(b c a)
(c a b)
(c b a) 
```

# function - 跳转到函数定义

> ID：635770
> 
> 赞同：281
> 
> 时间：2009-03-11T18:27:27.880
> 
> 标签：function, vim

如何使用 Vim 跳转到函数定义？例如，使用 Visual Assist，我可以在函数下键入`Alt`+ `g`，它会打开一个上下文菜单，其中列出了带有定义的文件。

我怎样才能在 vim 中做这样的事情？

* * *

## 回答 #1

> 赞同：244
> 
> 时间：2009-03-11T18:29:34.100

使用 ctags。生成一个标签文件，并使用 :tags 命令告诉 vim 它在哪里。然后你可以使用`Ctrl`-跳转到函数定义`]`

[这个问题](https://stackoverflow.com/questions/563616/vimctags-tips-and-tricks)中有更多的标签技巧和技巧。

* * *

## 回答 #2

> 赞同：167
> 
> 时间：2009-03-11T18:47:52.543

如果所有内容都包含在一个文件中，则有命令**`gd`**（如在“goto 定义”中），它将带您到文件中第一次出现光标下的单词，这通常是定义。

* * *

## 回答 #3

> 赞同：116
> 
> 时间：2011-10-12T21:58:25.500

`g*`在没有设置 ctags 的情况下做得不错。

也就是说，键入`g`, `*`（或只是`*`- 见下文）以搜索光标下的单词（在本例中为函数名称）。然后按`n`转到下一个（或`Shift`-`n`表示上一个）事件。

它不会直接跳转到定义，因为这个命令只是搜索光标下的单词，但是如果你现在不想处理设置ctags，你至少可以让自己不必重新- 键入函数名称以搜索其定义。

--Edit-- 虽然我用g* 已经很久了，但是我最近发现了两个这些快捷键的快捷键！

(a)`*`将跳转到光标下单词的下一个出现。（无需`g`在 vi 中键入 'goto' 命令）。

(b)`#`以类似的方式转到上一个事件。

N 和 n 仍然有效，但 '#' 通常在开始反向搜索时非常有用，例如，在查找光标下的变量声明时。

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2013-11-19T02:41:35.297

将光标放在程序中的任何变量上时使用`gd`或。`gD`

1.  `gd` 会带你去当地的申报。
2.  `gD` 将带您进入全球宣言。

更多导航选项可以在[这里](http://vim.wikia.com/wiki/Go_to_definition_using_g)找到。

使用[cscope](http://cscope.sourceforge.net/cscope_vim_tutorial.html)交叉引用大型项目​​，例如 linux 内核。

* * *

## 回答 #5

> 赞同：47
> 
> 时间：2018-07-05T15:45:32.660

**TL;博士：**

您*可以*使用内部 VIM 功能做到这一点，但一种现代（且更简单）的方法是使用[COC](https://github.com/neoclide/coc.nvim)进行类似智能感知的完成，使用一个或多个[语言服务器](https://microsoft.github.io/language-server-protocol/)(LS) 进行跳转到定义（以及更多方式）。要获得更多功能（但跳转到定义不需要），您可以安装一个或多个[调试器](https://microsoft.github.io/debug-adapter-protocol/)并获得完整的 IDE 体验。

最好的第二个是使用本机 VIM 的功能，`define-search`但它是为 C 预处理器的`#define`指令发明的，对于大多数其他语言来说，需要额外的配置，因为有些根本不可能（你也错过了其他 IDE 功能）。最后，一个备用方案是`ctags`.

**快速开始：**

1.  安装[vim-plug](https://github.com/junegunn/vim-plug)来管理你的 VIM 插件
2.  在顶部添加[COC](https://github.com/neoclide/coc.nvim)和（可选）[Vimspector](https://github.com/puremourning/vimspector)`~/.vimrc`：

    ```
    call plug#begin()
    Plug 'neoclide/coc.nvim', {'branch': 'release'}
    Plug 'puremourning/vimspector'
    call plug#end()

    " key mappings example
    nmap <silent> gd <Plug>(coc-definition)
    nmap <silent> gD <Plug>(coc-implementation)
    nmap <silent> gr <Plug>(coc-references)
    " there's way more, see `:help coc-key-mappings@en' 
    ```

3.  调用`:source $MYVIMRC | PlugInstall`以重新加载 VIM 配置并下载插件
4.  重新启动`vim`并调用`:CocInstall coc-marketplace`以轻松访问 COC 扩展
5.  调用`:CocList marketplace`并搜索语言服务器，例如：

*   键入`python`查找`coc-jedi`，
*   键入`php`查找`coc-phpls`等。

6.  （可选）查看`:h VimspectorInstall`安装额外的调试器，例如：

*   `:VimspectorInstall debugpy`,
*   `:VimspectorInstall vscode-php-debug`， ETC。

**全文：**

[语言服务器](https://microsoft.github.io/language-server-protocol/)(LS) 是一个单独的独立应用程序（每种编程语言一个），它在后台运行并实时分析您的整个项目，向您的编辑器（任何编辑器，不仅如此`vim`）公开额外的功能。你会得到类似的东西：

*   命名空间感知标记完成
*   跳转到定义
*   跳转到下一个/上一个错误
*   查找对象的所有引用
*   查找所有接口实现
*   在整个项目中重命名
*   悬停文档
*   片段、代码操作、格式化、linting 等等……

与语言服务器的通信通过[语言服务器协议](https://microsoft.github.io/language-server-protocol/)(LSP) 进行。两者[`nvim`](https://neovim.io/)和`vim8`（或更高版本）都通过插件支持 LSP，最流行的是[完成征服](https://github.com/neoclide/coc.nvim)(COC)。

[Lang Server](https://langserver.org/)网站上提供了积极开发的语言服务器及其功能的列表。并非所有这些都是由 COC 扩展提供的。如果您想使用其中之一，您可以自己编写 COC 扩展或手动安装 LS 并使用以下 VIM 插件的组合作为 COC 的替代方案：

*   [LanguageClient](https://github.com/autozimu/LanguageClient-neovim) - 处理 LSP
*   [deoplete](https://github.com/Shougo/deoplete.nvim) - 在您键入时触发完成

与调试器的通信通过[调试适配器协议](https://microsoft.github.io/debug-adapter-protocol/)(DAP) 进行。VIM 最流行的 DAP 插件是[Vimspector](https://github.com/puremourning/vimspector)。

[语言服务器协议](https://microsoft.github.io/language-server-protocol/)(LSP) 由**Microsoft**为 Visual Studio Code 创建，并作为具有许可 MIT 许可证（通过与 Red Hat 和 Codenvy 合作标准化）的**开源项目发布。**后来微软也发布了[调试适配器协议](https://microsoft.github.io/debug-adapter-protocol/)（DAP）。VIM 支持 VSCode 支持的任何语言。

我个人推荐使用 COC + 由 COC 扩展提供的语言服务器 + [ALE](https://github.com/dense-analysis/ale)进行额外的 linting（但禁用 LSP 支持以避免与 COC 冲突）+ [Vimspector](https://github.com/puremourning/vimspector) + Vimspector 提供的调试器（称为“gadgets”）+ 以下 VIM 插件：

```
call plug#begin()
Plug 'neoclide/coc.nvim'
Plug 'dense-analysis/ale'
Plug 'puremourning/vimspector'
Plug 'scrooloose/nerdtree'
Plug 'scrooloose/nerdcommenter'
Plug 'sheerun/vim-polyglot'
Plug 'yggdroot/indentline'
Plug 'tpope/vim-surround'
Plug 'kana/vim-textobj-user'
  \| Plug 'glts/vim-textobj-comment'
Plug 'janko/vim-test'
Plug 'vim-scripts/vcscommand.vim'
Plug 'mhinz/vim-signify'
call plug#end() 
```

你可以谷歌每个人，看看他们做了什么。

**原生 VIM 跳转定义：**

如果您真的不想使用 Language Server 并且仍然希望使用本机 VIM 稍微体面地跳转到定义，您应该熟悉它代表`:ij`and 。这些 VIM 命令可让您跳转到项目包含的任何文件或跳转到任何包含文件中的任何已定义符号。然而，要使其工作，VIM 必须知道包含文件或定义符号的行在任何给定语言中的外观。您可以按照中所述的with和模式为每种语言设置它`:dj``include-jump``definition-jump``~/.vim/ftplugin/$file_type.vim``set include=$regex``set define=$regex``:h include-search`，虽然，想出这些模式是一门艺术，有时根本不可能，例如对于符号定义或文件导入可以跨越多行的语言（例如 Golang）。如果这是您的情况，则通常的后备措施`ctags`如其他答案中所述。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-03-11T18:42:02.417

正如 Paul Tomblin 提到的，您必须使用**ctags**。您还可以考虑使用**插件**来选择合适的插件或预览光标下函数的定义。如果没有插件，您将在尝试选择数百个重载的“doAction”方法之一时感到头疼，因为内置的 ctags 支持不考虑上下文 - 只是一个名称。

您也可以使用**cscope**及其“查找全局符号”功能。但是您的 vim 必须使用 +cscope 支持进行编译，这不是构建的默认选项之一。

如果您知道该函数是在当前文件中定义的，您可以在正常模式下使用“gD”键来跳转到光标下符号的定义。

这是下载最多的导航插件
[http://www.vim.org/scripts/script.php?script_id=273](http://www.vim.org/scripts/script.php?script_id=273)

这是我在跳转到标签
[http://www.vim.org/scripts/script.php?script_id=2507时为选择上下文而编写的](http://www.vim.org/scripts/script.php?script_id=2507)

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2009-03-11T19:46:47.237

另一种常见的技术是将函数名称放在第一列。这允许通过简单的搜索找到定义。

```
int
main(int argc, char *argv[])
{
    ...
} 
```

然后可以`/^main`在文件内部或`:grep -r '^main' *.c`目录中找到上述函数。只要代码正确缩进，标识符将出现在行首的唯一时间就是函数定义。

当然，如果你从现在开始不使用**ctags**，你应该为自己感到羞耻！但是，我发现这个编码标准也是一个有用的补充。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2013-11-12T10:24:06.563

1-安装旺盛的ctags。如果你使用的是 osx，这篇文章展示了一个小技巧： [http ://www.runtime-era.com/2012/05/exuberant-ctags-in-osx-107.html](http://www.runtime-era.com/2012/05/exuberant-ctags-in-osx-107.html)

2-如果您只想在您的目录中包含文件的 ctags，请在您的目录中运行此命令：

```
ctags -R 
```

这将为您创建一个“标签”文件。

3- 如果您使用 Ruby 并希望为您的 gem 包含 ctags（这对我使用 RubyMotion 和我开发的本地 gem 非常有帮助），请执行以下操作：

```
ctags --exclude=.git --exclude='*.log' -R * `bundle show --paths` 
```

信用：[https](https://coderwall.com/p/lv1qww) ://coderwall.com/p/lv1qww （请注意，我省略了为 emacs 而不是 vim 生成标签的 -e 选项）

4-将以下行添加到您的 ~/.vimrc

```
set autochdir 
set tags+=./tags; 
```

（为什么是分号：http: [//vim.wikia.com/wiki/Single_tags_file_for_a_source_tree](http://vim.wikia.com/wiki/Single_tags_file_for_a_source_tree)）

5-转到您想关注的单词并点击`ctrl + ]`；如果您想返回，请使用`ctrl+o`（来源：[https](https://stackoverflow.com/a/53929/226255) ://stackoverflow.com/a/53929/226255 ）

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-03-11T18:47:11.747

第二个 Paul 的回答：是的，ctags（尤其是 exuberant-ctags ( [http://ctags.sourceforge.net/](http://ctags.sourceforge.net/) )）很棒。我还把它添加到我的 vimrc 中，所以我可以为整个项目使用一个标签文件：

```
set tags=tags;/ 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-09-17T15:18:58.223

安装`cscope`. 它的工作原理非常相似，`ctags`但功能更强大。去定义，而不是`Ctrl`+ `]`，做`Ctrl`+ `\`+ `g`。当然，您可以同时使用两者。但是对于一个大项目（比如 Linux 内核），cscope 遥遥领先。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-07-15T11:35:57.870

生成ctags后，还可以在vim中使用如下：

```
:tag <f_name> 
```

以上将带您进行函数定义。

# entity-framework - 实体框架：如何使用 rowversion 字段启用每个类继承一个表？

> ID：635777
> 
> 赞同：1
> 
> 时间：2009-03-11T18:28:37.847
> 
> 标签：entity-framework, inheritance, single-table-inheritance

为什么我不能在子类中定义同名的成员？每个类继承一个表`rowversion timestamp`，每个表中都有一个字段。似乎实体设计者应该允许这样做并使用`new`属性上的关键字来实现它。解决方法是什么？如果我不能使用，如何在具有不同值的继承链中指定相同的字段`new`？对于具有 rowguid、modifiedbys、modifieddates 等的其他数据库，这可能是正确的。

**编辑：**我想这样做的合乎逻辑的方法是重命名对该字段的引用，即`PersonRowversion`在`Student`从`Person`.

我是否错过了一块可以自动跟踪这些字段的 EF？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T18:37:51.473

因为一个类不能有两个同名的成员。“新”不会做你想做的事。"new" 隐藏继承的成员；它不会给你两个同名的不同成员。因此，如果生成的代码使用“新”，那么您将永远无法从 C# 代码访问“父表”中的值。两个数据库表有两个同名的列是可以的，但是当两个表组成一个类时，您需要在概念模型中重命名重复的列名。

**在“修改日期”等方面，您通常只需要一个。**如果您有 Animal 的超类型和 Dog 的子类型，那么实体框架会将对该类型的“动物部分”或“狗部分”的更新视为对整个实例的更新，就像 C# 一样。

请记住，概念模型和存储模型是不同的东西，并且遵循不同的规则。在您的实体模型中工作时，请谨慎考虑严格的 OO 或严格的关系术语。在实体模型内部，您正在桥接两个世界。[正如我在别处所写](http://blogs.teamb.com/craigstuntz/2008/07/17/37825/ "ADO.NET 实体框架与 NHibernate 和其他 ORM")：

在设计一个好的对象关系映射时，你必须克服的心理障碍之一是倾向于主要以面向对象的术语或关系术语来思考，这取决于你的个性。然而，一个好的对象关系映射同时包含一个好的对象模型和一个好的关系模型。例如，假设您有一个数据库，其中包含一个人员表，以及员工和客户的相关表。一个人可能在所有三个表中都有记录。现在，从严格关系的角度来看，您可以为员工构建一个数据库 VIEW，为客户构建另一个数据库，这两个数据库都包含来自 People 表的信息。使用一个视图或另一个视图时，您可以暂时将个人视为“只是”一个员工或“只是”一个客户，即使你知道他们都是。因此，来自这种世界观的人可能会尝试进行 OO 映射，其中 Employee 和 Customer 都是 Person 的（直接）子类。但这不适用于我们拥有的数据；由于一个人同时拥有员工和客户记录（并且由于没有任何 Person 实例可以同时属于具体子类型 Employee 和 Customer），Person 和 Employee 之间的 OO 关系需要是组合而不是继承，对于 Person 和 Customer 也是如此。

# c - 为什么 glibc “timezone” global 与 DST 上的系统时间不一致？

> ID：635780
> 
> 赞同：6
> 
> 时间：2009-03-11T18:29:20.543
> 
> 标签：c, timezone, glibc

我遇到了一个奇怪的问题，我的系统时钟知道这是夏令时，但 glibc 似乎没有。这是一个最新的 Ubuntu 安装，我检查了 /etc/localtime 并且它具有正确的转换时间，用于上周切换到 DST。

对我来说，当前正确的时区是太平洋夏令时 (UTC-7)。当我问我的系统我在哪个时区时，它正确地告诉我：

```
$ date +%z
-0700 
```

但是当我运行以下程序时：

```
#include <time.h>
#include <stdio.h>

int main() {
  tzset();
  printf("%lu\n", timezone);
  return 0;
} 
```

输出错误地是：

```
28800 
```

对应于 UTC-8 或太平洋标准时间。（不，我的环境中没有设置 TZ）

我认为 glibc 和 date 程序会从同一来源获取他们的时区信息，但显然要么他们没有，要么我误解了 glibc 时区全局的工作原理。

那么基本问题是：

1.  *为什么这两个输出不同*
2.  *如何可靠地检测 C 程序中的系统 UTC 偏移量？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T18:47:13.277

我不认为“时区”会随着日光时间而变化。尝试“日光”变量。在我的系统上：

```
      外部变量 timezone 包含差异，以秒为单位，
      在 UTC 和当地标准时间之间（例如，在美国东部
      时区（EST），时区为 5*60*60）。外部变量日光
      仅当在
      TZ 环境变量。

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-07T23:52:30.203

执行此操作后查看 tm.tm_isdst 字段：

```
 time_t current_time;
  struct tm tm;

  current_time = time(NULL);
  localtime_r(&current_time, &tm); 
```

根据 localtime_r(3) 联机帮助页，这确实表明 DST 在指定时间是否有效。我认为您需要假设 DST 为您已经使用的 timezone(3) 变量增加了一小时，或者对 GMT 执行差异技巧。

在澳大利亚 AEST 为我工作，希望它对你有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-29T05:44:56.633

这是我的代码，如果定义了**linux**，则使用 tm_gmtoff，否则使用 gettimofday 中的 timezone.tz_minuteswest（这里的 'ltm' 是本地时间的输出）：

```
{
    int tz_offset;

#if defined(__linux__)
    tz_offset= ltm.tm_gmtoff;
#else
    tz_offset= -tz.tz_minuteswest*60 + ltm.tm_isdst*3600;
#endif

     printf ("LT = UTC +d sec\n", tz_offset);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-18T06:09:49.510

您可以使用`tm_gmtoff`与 ::timezone 相同的 struct tm 成员，但它考虑 DST 并且符号相反。

[http://www.gnu.org/s/libc/manual/html_node/Time-Zone-Functions.html#Time-Zone-Functions](http://www.gnu.org/s/libc/manual/html_node/Time-Zone-Functions.html#Time-Zone-Functions)

# bash - 无法制作一系列虚拟文件

> ID：635782
> 
> 赞同：2
> 
> 时间：2009-03-11T18:29:51.273
> 
> 标签：bash, terminal

我需要将文件从 File1、File2、... 调用到 File99。

我尝试了以下失败

```
cat test > {File1 .. File99} 
```

没有 File 字样的命令不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-11T18:41:00.077

```
$ for i in {1..100}; do touch "File$i"; done 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T22:48:47.813

只有一个命令：

```
touch File{1..99} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T18:40:07.320

这取决于您使用的外壳。我假设您正在使用 Bash。

根据[http://www.gnu.org/software/bash/manual/bashref.html#Brace-Expansion](http://www.gnu.org/software/bash/manual/bashref.html#Brace-Expansion)，Bash 将扩展数字和单个字符。所以你的大括号表达式应该是：

```
File{1..99} 
```

但我不认为重定向运算符“>”可以输出到多个文件。您可能需要使用循环：

```
for output in File{1..99}
do
    cat test > $output
done 
```

或作为单行：

```
for output in File{1..99}; do cat test > $output; done 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-11T19:10:28.917

如果您更喜欢非循环版本，那么您可以使用 tee

```
cat test | tee File{1..99} > /dev/null 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-11T20:24:19.440

使用*zsh*（及其*mult_ios*），您可以:)

```
% zsh -c 'print test > file{1..3}' 
% head file*                      
==> file1 <==
test

==> file2 <==
test

==> file3 <==
test 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-20T21:54:31.010

If you want the files to sort properly (file01, file02 ... file10, etc.), do this:

```
for i in {0..10}; do i="0"$i; touch file${i: -2}; done 
```

Which is the same as:

```
for i in {0..10}
do
    i="0"$i
    touch file${i: -2} # or cat file > file${i: -2}
done 
```

There must be be a space between the colon and the dash in the substring expansion clause. You can start the ranges above with 1 if you want to start with "file01".

Or, a much more succinct way to have leading zeros:

```
touch file{0..9}{0..9} 
```

and to use phyrex1an's technique with this one:

```
cat test | tee File{0..9}{0..9} > /dev/null 
```

This does make one extra file "file00". You can also do "{2..3}{0..9}" for "file20" through "file39", but changing the ones digit (the second range) would cause parts of the sequence to be skipped.

# asp.net - Windows 身份验证。用户收到提示 - ASP.NET

> ID：635788
> 
> 赞同：3
> 
> 时间：2009-03-11T18:31:51.473
> 
> 标签：asp.net

我有以下设置：

网页配置

身份验证模式 = "Windows"

虚拟目录 -> 启用匿名访问 - 未选中 -> 集成 Windows 身份验证 - 已选中

当用户进入 Intranet 的默认页面时，即使他已经通过身份验证，也会被提示输入用户名和密码

**更新：澄清我在做什么 - 我们有一个设置为 windows 身份验证 = 表单的应用程序 - 有一个请求，对于 Intranet 中的某些服务器，我们希望绕过 login.aspx 页面 - 所有这些login.aspx 页面所做的是，获取 windows 用户名，检查数据库，获取表单用户名和密码并让用户登录 - 我正在使用 User.Identity.Name 获取 windows 用户名进行映射

**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T18:35:43.477

你打开模拟了吗？

```
<identity impersonate="true" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T18:33:52.247

检查文件系统权限。即使他们已通过身份验证，如果他们无权访问文件，也会收到提示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T19:00:46.007

还要确保当您在 Internet Explorer 中查看站点时，状态栏中的区域显示为“Intranet 区域”。否则默认情况下不会让您登录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T18:37:49.663

另一个考虑因素是 Kerberos 身份验证只能通过 2 个跃点。在这种情况下，如果您的 AD 设置为正确处理身份验证，您可以使用 Kerberos/NTLM 身份验证，您应该能够将令牌传递得更远。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T19:21:00.450

如果我错了，请纠正我，但是 aspx 页面不会获取 IIS 用户吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T21:36:19.657

如果您想完全避免任何登录，则必须使用 Internet Explorer 作为客户端。
此外，正如 David 所提到的，该站点必须位于“Intranet”区域中，IE 才能自动发送您的 Windows 凭据。如果站点使用单字服务器名称，则站点将位于“Intranet”区域。否则，您必须将其添加到站点列表中。请参阅 Windows 中的 Internet 设置。

Firefox 会提示您输入凭据（但它们可以自动完成）。

# excel - 如何从开始编号和结束编号创建列表

> ID：635800
> 
> 赞同：1
> 
> 时间：2009-03-11T18:36:49.760
> 
> 标签：excel, vba, list

我有一组数字：

```
 |  A     B
--------------
1| 100   102
2| 103   103
3| 104   105
4| 106   110 
```

A 列是起始编号，B 列是结束编号。我们需要根据第 1 行（A1 和 B1）的第一组数据（A1 和 B1）使用列 A 和 BEg 使用开始编号和结束编号创建一个数字列表（在单独的单元格上），第一组数字将是：100,101,102 ，然后它会转到第 2 行，将 103 放在 102 之后并移动到第 3 行，展开列表并显示 104 和 105，然后到应该列出 105,106,107,108,109,110 的最后一行。

我们应该能够标记列表编号的开头，以便我们知道每个列表的开头。即所有列在A 栏中的数字都应该被标记。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-12T11:31:39.400

不确定我完全理解你的问题，但我认为你想把这个：

```
100 102
103 103
104 105
106 110

```

进入这个？

```
100 102 100, 101, 102
103 103 103
104 105 104, 105
106 110 106、107、108、109、110

```

如果是这样，下面的代码将实现这一点：

```
私有子 getListsOfNumbers()
    将 inputRange 调暗为字符串
    暗淡 x 长
    Dim y As Long

    '获取输入数据范围
    inputRange = InputBox("输入输入范围", "开始", "A1:A4")

    '清除输出范围（两列偏移）
    Range(inputRange).Offset(0, 2).ClearContents

    带范围（输入范围）

        '循环输入范围
        对于 x = 1 到 .Cells.Count

            '遍历第二列和第一列之间的差异
            对于 y = 0 到 (.Cells(x, 2) - .Cells(x, 1))

                '为输出列添加值
                .Cells(x, 3) = .Cells(x, 3) & (.Cells(x, 1) + y) & ", "
            下一个

            '通过删除尾随逗号来整理输出
            .Cells(x, 3) = CStr(Left(.Cells(x, 3), Len(.Cells(x, 3)) - 2))
        下一个 x
    结束于
结束子

```

如果我误读了您的请求，请告诉我。

编辑：刚刚尝试过这个，并且使用更大的数据集，它会像人们预测的那样慢。如果您的数据有 100s/1000s 行，和/或 A 和 B 列中的数字之间的差异明显大于示例，那么您可能希望通过关闭计算和 screenUpdating 来最小化延迟程序的开始并在完成后恢复。

如果您需要实现此功能，Excel 帮助中的语法和示例可为您提供帮助。

# c# - 字符串文字和字符文字可以连接吗？

> ID：635807
> 
> 赞同：4
> 
> 时间：2009-03-11T18:38:05.733
> 
> 标签：c#, java, c++, string, char

为什么`name`在以下 C++ 代码中行为不端？

```
string name =  "ab"+'c'; 
```

等效代码在 Java/C# 中的行为如何？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-11T18:40:57.940

尝试

```
std::string name = "ab" "c"; 
```

或者

```
std::string name = std::string("ab") + c; 
```

在 C++ 中，“ab”不是一个`std::string`，而是一个指向字符串的指针。当您将整数值添加到指针时，您会得到一个指向字符串下方更远的新指针：

```
char *foo = "012345678910121416182022242628303234";
std::string name = foo + ' '; 
```

`name`设置为“3234”，因为 ' ' 的整数值为 32 并且 foo 开头之后的 32 个字符是字符串结尾之前的四个字符。如果字符串较短，您将尝试访问未定义内存区域中的某些内容。

解决方案是从字符数组中创建一个 std:string 。std:strings 允许您按预期将字符附加到它们：

```
std::string foo = "012345678910121416182022242628303234";
std::string name = foo + ' '; 
```

`name`设置为“012345678910121416182022242628303234”

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-11T18:49:29.870

问题是“ab”不是 C++ `std::string`，而是`const char[3]`. 所以它正在寻找的 + 运算符是`operator+ (const char[3], char)`. 那不存在，因此编译器尝试让数组衰减为指针，因此它会查找`operator+ (const char*, char)`. 那是存在的，所以编译器会选择它，但它做错了。将整数值（char）添加到指针（const char*）是很常见的操作，显然，这就是 operator+ 所做的。理解这一点的关键是要认识到第一个参数是 1) 一个数组，以及 2) 一个指针，只要数组没有意义。它也被用作 C 中的字符串，是的，但它不是字符串。它是一个指针（或者偶尔是一个数组）。

有一个`operator+ (const std::string&, char)`which 连接，但编译器甚至不会查找它，因为第一个参数不是 std::string。

所以一个解决方案是手动创建字符串：

```
string name = std::string("ab")+'c'; 
```

现在编译器可以找出正确的 operator+ 来调用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-11T18:44:39.337

在 C++ 中，编译器正在寻找具有此原型的函数：

```
T operator+ (const char*, char); 
```

由于没有，它无法弄清楚 T 是什么并且无法解析`operator<<`调用，所以它回退到唯一剩下的解决方案：指针加法。像 Josh 的回答那样连接到字符串没有问题，因为它存在一个函数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T19:36:19.383

给定 C++ 代码：

```
std::string name =  "ab"+'c'; 
```

Java中的等价物是：

```
String name = "ab".substring('c'); 
```

两者都将 char 提升为 int。当然，在 Java 中，它会进行范围检查，因此会引发异常。在 C++ 中，您只会得到未定义的行为（或类似行为）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T18:43:01.103

爪哇：

```
public class Main
{
    public static void main(String[] args)
    {
        System.out.println("AB" + 'c');
    }
} 
```

输出是：

> ABC

编辑：

实际上编译器硬编码字符串 ABc ......

如果你做 "AB" + argv[0].charAt(0); 让它使用一个变量然后编译器这样做（基本上）：

```
StringBuilder b = new StringBuilder;
b.append("AB");
b.append(argv[0].charAt(0));
System.out.println(b.toString()); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T18:39:46.603

您可以在 C# 中连接字符串和字符 - 我猜它不像 C++ 那样严格。

这在 C# 中工作得很好：

```
string test = "foo" + 'b'; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-11T19:19:32.623

C++ 编译器不会自动将字符串文字与字符文字连接起来。但它会将字符串文字彼此连接起来。语法是这样的：

```
const char * cs = "ab" "c"; // append string-literals 
```

正如其他人所提到的，`string`它不是*内置的*C++ 语言类型。但是 C++ 标准库中有一个`string`类型。以下是一些使用示例：

```
#include <string>
const char * cs = "ab" "c";
std::string s1( cs );
std::string s2( "ab" "c" );
std::string s3 = "ab" "c"; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-11T22:41:48.517

好吧，我通常会在 C++ 中做的是

字符串名称 = string("ab") +'c';

请记住，文字“ab”*不是*字符串类型。您所做的是希望在 char 数组和字符之间没有“+”，然后希望编译器能够以某种方式注意到您确实希望结果是 std::string，然后解析您的表达式右侧是一些隐式转换的组合，可以与运算符组合以产生该类型的结果。对我来说似乎是一个相当高的要求。

不管怎样，没关系。你看，在 C 中，数组和指针之间的唯一区别是它们的内存是如何分配的。一旦你有了一个，你基本上就有了一个“数组/指针的东西”。因此，“+”是在所有数组和指针上定义的运算符，它接受任何整数类型的另一个参数并进行指针数学运算，返回指向该点之后那么多元素的指针。此外，在 C 中，“char”实际上只是另一种整数类型。这些 C 设计决策都是有用的*hack*，但正如 hack 经常发生的那样，它们结合了直观意想不到的结果。因此，所有 "ab" + 'c' 为您所做的就是返回一个地址 99 个字节，只要 "ab" 文字恰好存储在内存中。

有时您可以依赖隐式转换，但您确实必须准备好在其他时候帮助您的编译器。

# c++ - 如何在当前页面的末尾将 QTextEdit 中的几个不可分割的文本块放在一起（全部放在下一页上）？

> ID：635812
> 
> 赞同：1
> 
> 时间：2009-03-11T18:39:38.177
> 
> 标签：c++, qt

我有一个 QTextEdit 文档，每次打印的大小都不同。在文档的中间，我有几块在用户眼中不可分割的文本块，我必须保护我的块不被分成两页，以防文档大小相等。你有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T22:28:37.487

我是 Qt 的忠实粉丝，但我还没有机会使用 QTextEdit。不过我想提供帮助，所以我查看了文档。

如果您使用的是足够新的 Qt 版本，您应该会发现 QTextEdit 具有关联的 QTextDocument 并且您寻求的功能似乎在那里。QTextDocument 是框架和块的层次结构。一个块相当于你上面提到的一个段落。

该文档似乎表明您可以指定将块包装在框架中。然后，您应该能够使用 QTextFrame::setFrameFormat 为框架设置格式。这种格式将允许您使用一些标志指定分页策略。指定的标志是 PageBreak_Auto、PageBreak_AlwaysBefore 和 PageBreak_AlwaysAfter。

在我看来，如果你为框架设置了 PageBreak_AlwaysBefore 和 PageBreak_AlwaysAfter 标志，那么你的块应该保持在一起。

我意识到这是一个相当复杂的系列。我希望它有所帮助，并且真的很想听听它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T19:58:08.130

与此功能最接近的是 Unicode 段落分隔符 (U+2029)。如果您用段落分隔符包围正文，则渲染器不应将段落的第一行或最后一行单独留在页面中。在 MS-Word 中可以很容易地观察到这种行为。但是，如果该块的文本是四行或更多，那么您没有被授予者所有四行都将在同一页中。他们可以在页面之间拆分 2-2。

您正在谈论的概念在单词和行之间的较小范围内被广泛使用。如果你在单词之间放置一个 NBSP（No-Break Space，U+00A0）而不是一个普通的空格，那么渲染器就知道该行不应该在这个空格中被打破。
您实际上正在寻找的是“无分页换行”。不幸的是，Unicode 没有这样的字符。

您可以尝试使用 NBSP 而不是空格来编写整个文本块。最终，您唯一的 NBSP 文本将变得比一行大，并且必须在某处中断。这是 Unicode 的某种最终情况，我不确定它是否真的被定义。也许将生成的换行符有可能不会在页面之间中断。这甚至是最终案例的进一步最终案例。知道在这种情况下会发生什么的唯一方法是尝试。

# objective-c - 访问 touchesBegan/Moved/Ended 到 UITableViewCell

> ID：635826
> 
> 赞同：1
> 
> 时间：2009-03-11T18:41:47.097
> 
> 标签：objective-c, iphone, uitableview, cocoa, cocoa-touch

我很想知道究竟需要进行什么样的黑客攻击才能使用 touches* API 处理 UITableViewCell 上的其他手势。我想通过提供基于从左到右滑动来调用选择器的能力，为我的 UITableView 添加额外的功能。从右到左滑动可能是一个不同的选择器。直接使用 touches API，但是如何继续使用 UITableViewCell 做类似的事情呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-11T19:38:30.843

您可以在 UIView 中使用 hitTest 方法来获取触摸的详细信息并以您想要的任何方式将它们解释为手势。- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event

UITableViewCell 还使用从左到右的滑动来编辑操作，因此如果它们满足您的需要，您可以使用那些已经存在的事件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-11T18:51:53.360

我会尝试在我的视图控制器中实现 touchesBegan、touchesEnded 委托方法并记录被调用的日志。

我认为他们确实被调用但没有测试它。

# sql-server - 将 Spring + Hibernate + Sql server 与 unicode 支持集成

> ID：635827
> 
> 赞同：5
> 
> 时间：2009-03-11T18:41:50.560
> 
> 标签：sql-server, hibernate, spring, unicode

我如何使用 sql server 2005 将 Spring 与 Hibernate 集成并支持 Unicode。我尝试了许多不同的方法，但我就是无法让它发挥作用。

表中的列是 nvarchar，Spring 中的字符集是 UTF-8。我可以很好地阅读 Unicode 文本（我自己使用 sql server 管理工具添加的），但写作不起作用，它在数据库中被乱码。

jdbc 网址是

```
jdbc:sqlserver://localhost:1433;useUnicode=true;characterEncoding=UTF-8;databaseName=test; 
```

在休眠配置文件中使用这些属性

```
<property name="hibernate.connection.useUnicode">true</property>
<property name="hibernate.connection.charSet">UTF8</property> 
```

我还有一个过滤器可以更改所有页面的编码

```
response.setContentType("text/html; charset=UTF-8");
request.setCharacterEncoding("UTF8");

chain.doFilter(request, response);

//do it again, since JSPs will set it to the default
response.setContentType("text/html; charset=UTF-8");
request.setCharacterEncoding("UTF8"); 
```

有没有成功的灵魂，可以提供帮助？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T18:26:31.420

看来您需要将过滤器中的**响应和请求**编码更改为 UTF-8，一切都很好！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-24T19:25:40.193

试试这里的建议：http: [//blog.tremend.ro/2007/05/23/hibernate-utf-8-and-sql-server-2005/](http://blog.tremend.ro/2007/05/23/hibernate-utf-8-and-sql-server-2005/)

```
/**
 * Unicode support in SQL Server
 */
public class UnicodeSQLServerDialect extends SQLServerDialect {

    public UnicodeSQLServerDialect() {
        super();

        // Use Unicode Characters
        registerColumnType(Types.VARCHAR, 255, "nvarchar($l)");
        registerColumnType(Types.CHAR, "nchar(1)");
        registerColumnType(Types.CLOB, "nvarchar(max)");

        // Microsoft SQL Server 2000 supports bigint and bit
        registerColumnType(Types.BIGINT, "bigint");
        registerColumnType(Types.BIT, "bit");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T13:46:46.963

```
公共类 SQLServerUnicodeDialect 扩展 org.hibernate.dialect.SQLServerDialect {
    公共 SQLServerUnicodeDialect() {
        极好的（）;
        registerColumnType(Types.CHAR, "nchar(1)");
        registerColumnType(Types.LONGVARCHAR, "nvarchar(max)" );
        registerColumnType(Types.VARCHAR, 4000, "nvarchar($l)");
        registerColumnType(Types.VARCHAR, "nvarchar(max)");
        registerColumnType(Types.CLOB, "nvarchar(max)" );

        registerColumnType(Types.NCHAR, "nchar(1)");
        registerColumnType(Types.LONGNVARCHAR, "nvarchar(max)");
        registerColumnType(Types.NVARCHAR, 4000, "nvarchar($l)");
        registerColumnType(Types.NVARCHAR, "nvarchar(max)");
        registerColumnType(Types.NCLOB, "nvarchar(max)");

        registerHibernateType(Types.NCHAR, StandardBasicTypes.CHARACTER.getName());
        registerHibernateType(Types.LONGNVARCHAR, StandardBasicTypes.TEXT.getName());
        registerHibernateType(Types.NVARCHAR, StandardBasicTypes.STRING.getName());
        registerHibernateType(Types.NCLOB, StandardBasicTypes.CLOB.getName());
    }
}

```

# sql - 如何在一个查询中同时获得子集的计数和总集的计数？

> ID：635836
> 
> 赞同：4
> 
> 时间：2009-03-11T18:45:07.667
> 
> 标签：sql, mysql

在简单的情况下，假设我有一个如下所示的表：

```
mysql> describe widget; 
+---------+--------------+------+-----+---------+-------+
| Field   | Type         | Null | Key | Default | Extra |
+---------+--------------+------+-----+---------+-------+
| name    | varchar(255) | YES  |     | NULL    |       | 
| enabled | smallint(1)  | YES  |     | NULL    |       | 
+---------+--------------+------+-----+---------+-------+ 
```

是否可以在同一查询中获取所有启用的小部件的计数（启用 = 1）作为所有小部件的计数？

例如，如果我总共有 3 个小部件并且启用了一个，我希望得到我的查询结果，如下所示：

```
mysql> SELECT ... as enabled_count, ... as total_count ...
+---------------+-------------+
| enabled_count | total_count |
+---------------+-------------+
|             1 |           3 |
+---------------+-------------+ 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-11T18:53:03.963

如果 enabled 始终为 1 或 0，您可以执行以下操作：

```
SELECT 
   COUNT(*) as total_count,
   SUM(enabled) as enabled_count
 FROM widget 
```

如果它是另一个值，也许：

```
SELECT
   COUNT(*) as total_count,
   SUM( CASE WHEN enabled in ('enabled value 1', 'enabled value 2') 
        THEN 1
        ELSE 0
        END
      ) as enabled_count
FROM widget 
```

# c# - WCF：有没有办法删除 ExtensionData 字段？

> ID：635838
> 
> 赞同：16
> 
> 时间：2009-03-11T18:45:48.553
> 
> 标签：c#, wcf, serialization

我刚开始使用 WCF，我已经遇到了一个改变项目的问题。我创建了一个服务并在 web 服务中引用，但是 web 服务 xml 文件中的每个字段都带有一个 ExtensionData 字段。

例子：

*删除了无效的 ImageShack 链接*

我不想要这个。我只需要它：

*删除了无效的 ImageShack 链接*

有没有办法删除这个字段？一些不同类型的序列化？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-11T20:46:04.770

The ExtensionData is actually a feature that must be built into the type to enable [round-tripping](http://msdn.microsoft.com/en-us/library/ms731083.aspx). It is always emitted by the DataContractSerializer. One possible way of *suppressing* this field is using the older XmlSerializer by decorating your service contract interface with the [XmlSerializerFormatAttribute](http://msdn.microsoft.com/en-us/library/system.servicemodel.xmlserializerformatattribute.aspx).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T21:07:56.393

设置属性以`null`防止它出现在生成的 xml 中：

```
foreach(var elem in arrayOfElements)
{
    elem.ExtensionData = null;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T11:40:01.673

最有可能的是，您的 DataContract 类将实现该`IExtensibleDataObject`接口，对吗？这负责该`ExtensionData`字段 - 只需删除该接口，您也应该能够`ExtensionData`从 DataContracts 中删除这些字段。

马克

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T20:44:17.380

ExtensionData is used to maintain compatibility across services that may share contracts of different versions. It can be safely ignored when passing messages.

You may be able to get rid of it by using something other than the DataContract serializer (im thinking old school [Serializable]), but i could be wrong.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-11T20:54:20.960

没有回答这个问题，但也许这有帮助......

来自 MSDN[http://msdn.microsoft.com/en-us/library/ms731083.aspx](http://msdn.microsoft.com/en-us/library/ms731083.aspx)：

可以通过在 DataContractSerializer 构造函数中将 ignoreExtensionDataObject 设置为 true 或通过在 ServiceBehaviorAttribute 上将 IgnoreExtensionDataObject 属性设置为 true 来关闭往返功能。当此功能关闭时，反序列化程序将不会填充 ExtensionData 属性，并且序列化程序不会发出该属性的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-29T00:57:57.343

如果您的问题在于 [TestMethod] 的断言，您可以使用[http://www.fluentassertions.com](http://www.fluentassertions.com)从您的断言中排除每个 ExtensionData 属性。

例如。

```
objToCheck.ShouldBeEquivalentTo(expectedObj, options => options.Excluding(o => o.ExtensionData)); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-03T07:59:35.737

> 您的类不应继承 IExtensibleDataObject。

请参考下面的往返说明：

当数据从新版本传输到旧版本并传输到数据合约的新版本时，就会发生往返。旁路确保没有数据丢失。关闭绕过使提前类型与合约版本模型支持的任何未来更改兼容。

要为特定类型启用跳闸，该类型应执行

> IExtensibleDataObject

界面。

用户界面包含一个 ExtensionData (ExtensionDataObject) 属性。该属性存储来自当前版本未知的数据合约未来版本的任何信息。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-11-06T13:25:30.407

用 [ServiceBehavior(IgnoreExtensionDataObject=true)] 装饰你的 ServiceImplementation

```
[ServiceBehavior(IgnoreExtensionDataObject=true)]
public class Service : IService {} 
```

# c# - 从 C# 访问 COM 对象的最佳方法

> ID：635839
> 
> 赞同：38
> 
> 时间：2009-03-11T18:46:10.877
> 
> 标签：c#, .net, com, pinvoke

我打算使用作为 COM 对象公开的各种对象。为了使它们更易于使用，我想将它们包装为 C# 对象。最好的方法是什么？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-11T18:55:27.483

如果库已经注册，您可以执行以下步骤让 Visual Studio 为您生成互操作程序集：

*   打开您的 Visual Studio 项目。
*   右键单击“参考”（在解决方案资源管理器中的项目下方），然后选择“添加参考”。
*   选择 COM 选项卡。（如果你没有看到这个，你有一个不支持 COM 的项目类型。）
*   选择您希望与之互操作的组件。
*   选择“确定”。

这将是一个类或一组 C# 类，它们使用普通 C# 类包装所有 COM 接口内容。然后，您只需像使用任何其他 C# 库一样使用它。如果引用的导入运行良好，您可以像任何其他引用一样探索它，并且方法/结构/类/常量应该显示在该命名空间和智能感知中。

至少，这会让你开始。如果它部署在企业环境中或您可以控制的环境中，这可能就是您所需要的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-11T18:48:09.547

您可以（最初）只导入参考。如果您需要更多控制（或从 VS 的导入中获取错误），您可以在 windows sdk 中使用 tlbimp。这将创建互操作程序集。您可以从元数据中获取类定义。

编辑：如果您想使用 64 位，这实际上要复杂得多

# .net-3.5 - 我的扩展方法都没有显示在后面的代码中

> ID：635841
> 
> 赞同：3
> 
> 时间：2009-03-11T18:46:55.010
> 
> 标签：.net-3.5

我在当前项目中定义了许多扩展方法。这是一个 VB.NET 项目。我在 App_Code 目录中的文件中使用这些方法没有问题，这是我定义方法的同一个地方。但是，在我页面后面的 page.aspx.vb 代码中，这些方法没有出现。我尝试包含正确的名称空间，但没有运气。

有谁知道为什么我不能在代码隐藏文件中调用扩展方法？

在 App_Code 文件夹中定义

```
<Extension()> _
Public Function GetSelected(ByVal apps As List(Of Appointment)) As Appointment
    Dim selected = From a In apps _
                   Where a.Selected = True

    Return selected.Single
End Function 
```

在另一个类中的 App_Code 文件夹中定义（这个工作得很好）

```
Public ReadOnly Property Selected() As Appointment
    Get
        Return _appointments.GetSelected()
    End Get
End Property 
```

在 App Root 文件夹中的代码隐藏文件中定义（不工作）

```
Public ReadOnly Property Selected() As Appointment
    Get
        Return _appointments.GetSelected()
    End Get
End Property 
```

它们都在同一个应用程序中，没有外部引用。并且当我构建项目时没有错误，直到我尝试在后面的代码中使用扩展方法。此时错误是“GetSelected”不是“System.Collections.Generic.List(Of Appointment)”的成员

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-12T17:59:00.703

确保您的模块标记为公开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T19:10:09.837

尝试“正常”调用这些方法 - 即，就好像它们是标准共享方法一样。如果您可以在不使用名称空间完全限定类型的情况下这样做，那么就会发生一些非常奇怪的事情。您可以使用任何其他 VB9 功能吗？

如果您只能通过完全限定类型来调用它，那么这是一个 Imports 问题。

如果你根本不能调用它，这是一个参考问题 - 但我担心我自己之前在 ASP.NET 中遇到过 App_Code 问题，并且基本上没有足够的 ASP.NET mojo 来提供进一步的帮助. 希望回答这些问题应该可以帮助有*能力*为您提供更多帮助的人:)

编辑：好的，所以您不能使用任何 VB9 功能（请尝试使用 LINQ 以外的其他功能），并且您不能从`App_Code`目录访问共享方法。你有 Visual Studio 的同事吗？你能在他们的机器上试试吗？听起来您的安装有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T18:53:33.887

您是否尝试引用它们所在的程序集？此外，构建您的项目并尝试从错误消息中猜测出什么问题。你也可以把其中一些放在这里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T19:22:33.223

您是否尝试过关闭和重新打开 VS？

# php - PHP：如何从一大块文本中获取 URL？

> ID：635844
> 
> 赞同：4
> 
> 时间：2009-03-11T18:47:19.890
> 
> 标签：php, regex, url, bit.ly

假设我有一个充满 Twitter 帖子的大型 RSS 提要，它们都是纯文本。很多帖子都包含 URL，我希望将这些 URL 转换为链接。

所以我有一个变量等于：

> 按行业、数量和日期可视化裁员。期待看到类似的招聘趋势。http://bit.ly/XBW4z

我希望它变成：

> 按行业、数量和日期可视化裁员。期待看到类似的招聘趋势。[http://bit.ly/XBW4z](http://www-958.ibm.com/software/data/cognos/manyeyes/visualizations/layoffs-in-the-united-states-and-mor-2)

我怎么能那样做？对于正则表达式及其同类，我毫无用处，因此非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T18:53:48.800

取决于你想匹配什么

一个不错的简单正则表达式是

```
http\://[a-zA-Z0-9./?&_\-]*
```

它将匹配任何以- A 到 Z、0 到 9、、、、、开头`http://`并仅包含字符的url 。`[]``-``.``/``?``&`

如果要匹配其他协议（`https`,`ftp`等），可以使用

```
(http|ftp|你想要的任何其他协议)\://[a-zA-Z0-9./?&_\-]*
```

如果您想支持更多字符，只需将它们添加到`[]`.

更新：忘记大写支持！德欧

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-11T18:56:00.930

即使我想要一个...检查[搜索结果](http://www.google.co.in/search?hl=en&client=firefox-a&rls=org.mozilla:en-US:official&hs=6pT&ei=cwi4SeG_K5z-7AOir_CdCQ&sa=X&oi=spell&resnum=1&ct=result&cd=1&q=regex+for+finding+url&spell=1)中的第一个链接。它很旧！

顺便说一句，看看 RHS .. 我们有类似的问题。 [在纯文本](https://stackoverflow.com/questions/341942/recognize-url-in-plain-text) [正则表达式中识别文本或 html 中的 url 和图像的 URL](https://stackoverflow.com/questions/635247/regex-for-url-and-image-within-a-text-or-html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-02T14:11:05.413

只是为了添加一些信息......在 phpclass.org 上检查这个类，将解决你的问题......这个类将找到链接并转换它们......

[http://www.phpclasses.org/browse/package/6114.html](http://www.phpclasses.org/browse/package/6114.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-11T19:07:30.827

好的，这里的这个问题（[文本或 html 中的 url 和图像的正则表达式](https://stackoverflow.com/questions/635247/regex-for-url-and-image-within-a-text-or-html)）有一个令人费解的标题，但在底部有一个有用的答案。至少，它适用于我和我的情况！

```
$text = preg_replace('@(http://([\w-.]+)+(:\d+)?(/([\w/_.]*(\?\S+)?)?)?)@', 
                 '<a href="$1">$1</a>', $text); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T19:08:02.337

查看 preg_replace 函数。所以是这样的：

```
$regex_url = "((https?|ftp|gopher|telnet|file|notes|ms-help):((//)|(\\\\))+[\w\d:#@%/;$()~_?\+-=\\\.&]*)";

preg_replace($regex_url, '<a href="$1">$1</a>', $your_input_string); 
```

URL 的正则表达式取自：[http ://www.geekzilla.co.uk/view2D3B0109-C1B2-4B4E-BFFD-E8088CBC85FD.htm](http://www.geekzilla.co.uk/view2D3B0109-C1B2-4B4E-BFFD-E8088CBC85FD.htm)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T19:00:34.867

有匹配有效 URL 的正则表达式。例如[URLs 的完整正则表达式](http://internet.ls-la.net/folklore/url-regexpr.html)，它源自 URLs 的语法定义。

但最好明确声明它们而不是试图找到它们。因为在某些情况下无法区分，如果某些字符是 URL 的一部分或只是文本。

# c - WNDCLASSEX的概念，良好的编程习惯和系统类的WndProc

> ID：635847
> 
> 赞同：2
> 
> 时间：2009-03-11T18:48:15.817
> 
> 标签：c, winapi, wndproc

我了解 Windows API 使用“类”，依赖于[WNDCLASS](http://msdn.microsoft.com/en-us/library/ms633576%28VS.85%29.aspx) / [WNDCLASSEX](http://msdn.microsoft.com/en-us/library/ms633577%28VS.85%29.aspx)结构。

我已经成功通过了windows API Hello World应用程序，了解到这个类被我们自己的windows使用，也被Windows核心控件使用，例如“EDIT”，“BUTTON”等。我*也*明白它与WndProc（它允许我为它定义一个函数）

虽然我可以找到关于这个类的文档，但我找不到任何解释这个**概念**的东西。

到目前为止，我发现的唯一一件事是：

> Window 类与 C++ 类没有任何关系。

这*真的*没有帮助（它告诉我它*不是*什么但不告诉我它*是*什么）。事实上，这只会让我更加困惑，因为我很想将 WNDCLASSEX 与 C++ 类相关联，并认为“WNDCLASSEX”代表一种控制*类型* 。所以，我的第一个问题是它是**什么？**

其次，我知道可以在类中定义 WndProc。但是，窗口也可以从子控件（或窗口，或在 Windows API 中调用的任何内容）获取消息。**怎么会这样？**

最后，**什么时候定义一个新类是一个好的编程习惯**？每个应用程序（对于主框架）、每个框架、每个我定义的控件（例如，如果我创建自己的进度条类）？

我知道 Java/Swing、C#/Windows.Form、C/GTK+ 和 C++/wxWidgets，所以我可能会理解与这些工具包的比较。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T19:01:05.023

窗口类描述了将用于该类的所有实例的属性。除了颜色、图标等，这些属性之一是窗口过程。这是一个回调函数，负责处理来自系统的所有消息并在必要时对其进行处理。

虽然不相关，但该概念类似于 C++ 类——一段代码定义了一个类的数据和功能，并且该类可能有许多实例。

作为一个非常粗略的示例，“按钮”类 WndProc 将`WM_LBUTTONDOWN/WM_LBUTTONUP`序列转换为“点击”。在此序列期间，WndProc 还将按钮绘制为“按下”状态作为对`WM_PAINT`消息的响应。

当一个窗口需要向父级传达一个动作（例如点击）时，它会以“通知”或“命令”的形式发送消息。这些消息由子控件手动创建并包含标识符和任何相关数据。

所有这一切的好处只是通过创建按钮类的窗口（使用 CreateWindow），我自动获得了所有这些行为。

除了 windows 提供的那些，我还可以创建自己的窗口，这些窗口可以在我的应用程序中重新使用。您必须为您的主窗口注册至少一个类（否则它将没有任何功能，因此不会很有趣），但除此之外，这取决于您。

应用程序很可能只包含常规控件（按钮、列表视图、进度条），但有时您可能想要创建自定义类。这可能是为了封装特定的行为，或者因为您希望通过您的程序使用该控件的许多实例。

例如，如果我的应用程序的 UI 需要在鼠标悬停时旋转的长颈鹿图像，我可以编写代码在 WindowProcedure 中执行此操作并将其注册为新类（“SPINNYGIRAFFE”）。我的应用程序的其余部分只是创建“SPINNYGIRAFFE”类的窗口，一切正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T19:09:14.817

**怎么会这样？**

子控件（这些也是窗口）向其父窗口发送消息，Windows（注意大写字母，这是操作系统）知道该窗口的当前 WndProc 并调用它。

**什么时候定义一个新类是一个好的编程习惯？**

Every window must have a class, thus unless an existing class exists for your window, you must define a new class. You likely will need to define classes for all your own top level windows, but not for any controls (built in classes for these) or for dialogs since the dialog box APIs in Windows use another buildin class.

# c# - Oracle 存储过程、SYS_REFCURSOR 和 NHibernate

> ID：635848
> 
> 赞同：7
> 
> 时间：2009-03-11T18:48:20.683
> 
> 标签：c#, oracle, nhibernate, stored-procedures

我有一个要连接的旧版 Oracle (10.2g) 数据库，我想使用 NHibernate (2.0.1) 从存储过程中返回对象。有问题的存储过程使用 SYS_REFCURSOR 来返回结果。根据[文档](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/querysql.html#querysql-limits-storedprocedures)，这应该是可行的，但我在互联网上发现了[一些](http://groups.google.com/group/nhusers/browse_thread/thread/1e5c71502dd547f0/a7908ea36bed6a5e)[建议](http://forum.hibernate.org/viewtopic.php?p=2398761) ，否则。

这是我的解释代码：

映射文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" 
assembly="OracleStoredProcedures" namespace="OracleStoredProcedures">
    <class name="Person" mutable="false">
        <id name="PersonCode" type="AnsiString" column="PERSONCODE">
            <generator class="assigned" />
        </id>
        <property name="Name" type="String" column="PERSON_NAME" />
        <property name="Surname" type="String" column="PERSON_SURNAME" />
    </class>

    <sql-query name="getpeople">
        <return class="Person" />

        EXEC RS_DB.GETPERSONTEST 

    </sql-query>
</hibernate-mapping> 
```

存储过程：

```
CREATE OR REPLACE PROCEDURE RS_DB.GETPERSONTEST (
   io_cursor   IN OUT   sys_refcursor
)
IS
BEGIN
   OPEN io_cursor FOR
      SELECT PERSONCODE, PERSON_NAME, PERSON_SURNAME
      FROM PEOPLE

END GETPERSONTEST; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-21T09:10:49.273

这是多么大的痛苦啊。这终于奏效了。我把存储过程变成了一个函数。函数返回 sys_refcursor。使用与 OP 和名称查询类似的映射，如下所示。

```
<sql-query name="getpeople">
 <return class="Person" />

 { ? = call RS_DB.GETPERSONTEST }
</sql-query> 
```

[关联](http://nhibernate.svn.sourceforge.net/viewvc/nhibernate/trunk/nhibernate/src/NHibernate.Test/SqlTest/Custom/Oracle/StoredProcedures.hbm.xml?view=markup)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T20:19:48.003

根据[此页面](http://forum.hibernate.org/viewtopic.php?t=968248)，您应该使用 CALL 而不是 EXEC。这个我没试过，所以YMMV。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-20T16:40:47.167

在您的休眠状态中，您声明了一个返回类型，但 Oracle 过程不返回任何内容。也许如果您将其更改为返回 ref 光标的函数，它将正常工作。另外，我相信 CALL 是正确的语法。EXEC 是一个 SQL*Plus 命令，而不是真正的 SQL 语句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-19T16:07:50.200

据我所知，这是我几年前在使用 oracle 时发现的一个错误，我已经在 NH 跟踪器中追踪了这个问题，并且在 2.1.1GA 版本上已修复；你能确认这和你有同样的问题吗？ [https://nhibernate.jira.com/browse/NH-847](https://nhibernate.jira.com/browse/NH-847)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-24T17:42:58.943

我今天遇到了同样的问题。对我们来说，解决方法是使用“CALL”而不是“EXEC”，将圆括号“()”添加到过程调用中，并将调用包装在花括号“{}”中：

```
<sql-query name="getpeople">
    <return class="Person" />

    { CALL RS_DB.GETPERSONTEST() }

</sql-query> 
```

# internet-explorer - 支持 IE 中的“border-radius”

> ID：635851
> 
> 赞同：161
> 
> 时间：2009-03-11T18:50:42.847
> 
> 标签：internet-explorer, css

有谁知道 Internet Explorer 是否/何时支持“border-radius”CSS 属性？

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2010-09-23T22:22:43.260

是的！2011 年 1 月 IE9 发布时。

假设您希望在所有四个边上都达到 15px：

```
.myclass {
 border-style: solid;
 border-width: 2px;
 -moz-border-radius: 15px;
 -webkit-border-radius: 15px;
 border-radius: 15px;
} 
```

IE9 将使用默认值`border-radius`，因此只需确保在所有调用边框半径的样式中都包含它。然后您的网站将准备好支持 IE9。

`-moz-border-radius`适用于 Firefox，`-webkit-border-radius`适用于 Safari 和 Chrome。

此外：不要忘记声明您的 IE 编码是 ie9：

```
<meta http-equiv="X-UA-Compatible" content="IE=9" /> 
```

一些懒惰的开发者有`<meta http-equiv="X-UA-Compatible" content="IE=7" />`. 如果该标签存在，border-radius 将永远不会在 IE 中工作。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2010-03-25T23:08:36.260

自从一年前提出这个问题以来，这个问题的答案已经发生了变化。（这个问题目前是谷歌搜索“border-radius ie”的最佳结果之一。）

**IE9 将支持`border-radius`.**

有一个平台预览[可用](http://ie.microsoft.com/testdrive/Default.html)，它[支持](http://ie.microsoft.com/testdrive/HTML5/01BorderRadius/Default.html) `border-radius`. 您将需要 Windows Vista 或 Windows 7 来运行预览版（以及发布时的 IE9）。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-03-11T18:58:51.657

当你在等待时..[弯角（边界半径）跨浏览器](http://www.htmlremix.com/css/curved-corner-border-radius-cross-browser)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2010-10-11T19:04:02.567

一种解决方法和一个方便的工具：

[CSS3Pie](http://css3pie.com/)使用 .htc 文件和 behavior 属性将 CSS3 实现到 IE 6 - 8。

[Modernizr](http://www.modernizr.com/)是一种 javascript，它将类放在您的 html 元素上，允许您根据不同浏览器的功能为不同的浏览器提供不同的样式定义。

显然，这些都增加了更多开销，但由于 IE9 仅在 Vista/7 上运行，我们可能会被卡住很长一段时间。截至 2010 年 8 月，Windows XP 仍占 Web 客户端操作系统的 48%。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-03-11T18:56:00.260

IE8 没有计划。请参阅[CSS 兼容性页面](http://msdn.microsoft.com/en-us/library/cc351024(VS.85).aspx)。

除此之外，还没有公布任何计划。有传言说[IE8 将是](http://tech.slashdot.org/article.pl?sid=09/03/10/1942232)Windows XP 的最后一个版本

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-11-03T10:00:10.690

`<!DOCTYPE html>`没有这个标签边框半径在 IE9 中不起作用，不需要元标签。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-11-20T14:22:47.347

快速更新这个问题，IE9 将支持border-radius 根据：http: [//blogs.msdn.com/ie/archive/2009/11/18/an-early-look-at-ie9-for-developers.aspx](http://blogs.msdn.com/ie/archive/2009/11/18/an-early-look-at-ie9-for-developers.aspx)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-09-25T02:13:39.950

使用`-ms-border-radius: 15px`，任何使用 css -ms- 的元素都与 IE 兼容。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-05-07T13:20:37.120

IE的圆角半径问题将解决。

[http://kbala.com/ie-9-supports-corner-radius/](http://kbala.com/ie-9-supports-corner-radius/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-12-10T15:01:44.303

对边框半径和背景渐变的支持怎么样。是的 IE9 是分别支持它们，但如果你将两者混合，渐变会从圆角溢出。下面是一个糟糕示例的链接，但我在自己的测试中也看到了它。应该截屏:(

也许真正的问题是 IE 什么时候会在没有 MS-FILTER 专有黑客的情况下支持 CSS 标准。

[http://frugalcoder.us/post/2010/09/15/ie9-corner-plus-gradient-fail.aspx](http://frugalcoder.us/post/2010/09/15/ie9-corner-plus-gradient-fail.aspx)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-08-07T17:09:58.957

## 已解决 - 在 IE 10 和 11 中未正确呈现边框半径

对于那些没有获得 -ms-border-radius: 或border-radius: 在 IE 10,11 中工作的人它呈现所有正方形然后按照以下步骤操作：

1.  点击IE浏览器右上角的齿轮
2.  单击兼容性视图设置
3.  现在取消选中默认选中的 2 个框。

![确保复选框未选中，如图所示](https://i.stack.imgur.com/5MzIt.png)

# c# - 如何确定正在执行的程序是否编译为 64 位？

> ID：635853
> 
> 赞同：7
> 
> 时间：2009-03-11T18:51:30.553
> 
> 标签：c#, 64-bit

我需要让我的程序确定它是为 32 位 Windows 还是 64 位/任何 CPU 编译的。我需要根据编译选项选择不同的 COM 服务器标志。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T19:08:07.283

**如果您正在运行 64 位应用程序，请在运行时检查：**

要查看您的进程是 64 位还是 32 位，您可以简单地检查**IntPtr.Size**或任何其他指针类型。如果你得到 4，那么你在 32 位上运行。如果你得到 8，那么你是在 64 位上运行的。

**您的进程运行的是什么类型的计算机：**

您可以检查 PROCESSOR_ARCHITECTURE 环境变量以查看您是否在 x64、ia64 或 x86 机器上运行。

**您的进程是否在仿真下运行：**

Win32 API IsWow64Process 将告诉您是否在 x64 下运行 32 位应用程序。Wow64 表示 windows64 上的 windows32。

与其他人发布的相反：IsWow64Process 不会告诉您您是在运行 32 位还是 64 位应用程序。在 32 位机器上，它会在运行 32 位应用程序时告诉您 FALSE，而在 64 位机器上，它会告诉您 TRUE 对于 32 位应用程序。它只会告诉您您的应用程序是否在仿真下运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-02T07:00:06.073

你知道[`Environment.Is64BitProcess`](http://msdn.microsoft.com/en-us/library/system.environment.is64bitprocess.aspx "Environment.Is64BitProcess")吗？判断当前运行的进程是否为64位进程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T18:59:22.843

您需要 Microsoft 的 CORFLAGS 命令行应用程序。[http://msdn.microsoft.com/en-us/library/ms164699(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms164699(VS.80).aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T19:01:13.883

您可以使用[IsWow64Process](http://msdn.microsoft.com/en-us/library/ms684139(VS.85).aspx)函数在运行时确定您的 COM 服务器是 x64 还是 win32 进程。

如果您只想在编译时知道这一点：编译器设置 _WIN64 宏。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-08-31T09:36:47.647

使用 GetBinaryType api 函数，您将拥有文件的类型

这是 msdn [http://msdn.microsoft.com/en-us/library/aa364819(VS.85).aspx上 api 的链接](http://msdn.microsoft.com/en-us/library/aa364819(VS.85).aspx)

结果是：

SCS_32BIT_BINARY = 32 位 exe

SCS_64BIT_BINARY = 64 位 exe

SCS_DOS_BINARY = DOS

SCS_OS216_BINARY = OS/2

SCS_WOW_BINARY = 16 位

SCS_POSIX_BINARY = 基于 POSIX

SCS_PIF_BINARY = 在 DOS 上执行的 PIF 文件

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T18:59:57.787

您可以通过设置编译时间常量来执行此操作，并根据这些常量执行#ifs 以设置一个值，您可以检查该应用程序是为哪个平台编译的。请参阅[编译时的目标平台/处理器](https://stackoverflow.com/questions/524196/-net-target-platform-processor-at-compile-time)。

最简单的其他方法是检查 IntPtr.Size 属性以查看它是 4（32 位）还是 8（64 位）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-11T19:00:10.937

看看[条件方法](http://msdn.microsoft.com/en-us/library/aa288458(VS.71).aspx)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-11T19:26:05.773

虽然这似乎是一条奇怪的路线，但您可以通过检查 IntPtr.Size 来判断您是在 32 位（或 WOW64 中的 64 位）还是 64 位 .NET 代码中运行。

在 32 位/WOW64 上，IntPtr.Size 为 4。

在 64 位上，IntPtr.Size 为 8。

资料来源： MSDN 上将[32 位托管代码迁移到 64 位托管代码](http://msdn.microsoft.com/en-us/library/ms973190.aspx)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-12-09T09:15:11.873

您可以使用预定义宏来检查编译类型

```
 #if (_WIN64) 
        const bool IS_64 = true;
    #else
       const bool IS_64 = false;
    #endif 
```

# opengl - 从先前绑定的纹理中检索像素 - OpenGL

> ID：635858
> 
> 赞同：3
> 
> 时间：2009-03-11T18:52:22.047
> 
> 标签：opengl, textures

在 OpenGL 中，是否可以从仅给定纹理 ID 的先前创建的纹理中检索像素数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T19:22:41.117

是的。
再次绑定它并调用`glGetTexImage()`
如果您不想弄乱当前绑定的纹理，您可以将其绑定到不同的纹理单元。纹理单元是保存绑定纹理的容器。您可以将一个纹理绑定到每个纹理单元。OpenGL 2.1 要求实现至少有 2 个纹理单元。您经常使用的默认纹理单元是单元 0。切换当前纹理单元调用`glActiveTexture()`：

```
glActiveTexture(GL_TEXTURE1);
glBindTexture(texid);
glGetTexImage(...);
glActiveTexture(GL_TEXTURE0); // don't forget to switch it back 
```

# java - 替代 JAXMServlet？

> ID：635860
> 
> 赞同：1
> 
> 时间：2009-03-11T18:52:25.993
> 
> 标签：java, web-services, jaxm

我正在维护一个应用程序，该应用程序具有扩展*javax.xml.messaging.JAXMServlet*的类（编写于 2005 年） 。在升级到实现最新 J2EE 标准的新应用服务器时，我发现JWSDP 2.0（Java Web 服务开发包）中删除了*JAXMServlet*，根据[这个问题](http://www.javaforums.info/java-programming-archive/jaxm-demise-jwsdp-and-t3283.html)（显然 JWSDP 本身也已被[弃用](http://java.sun.com/webservices/downloads/previous/index.jsp)）。它所依赖的代码自编写以来没有发生显着变化，并且是现有的大型生产系统的一部分，该代码已经经过测试和调试，因此由于回归测试的影响，我不愿意从头开始重写这些类.

这门课有“简单”的替代品吗？尽管 Google 有很多使用此代码的示例（从 2003 年到 2004 年左右），但对于替换它却出奇地沉默。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T19:08:15.083

为什么要更换它？为什么不找到相关的库并使用它们呢？

[http://java.sun.com/webservices/downloads/previous/webservicespack.jsp](http://java.sun.com/webservices/downloads/previous/webservicespack.jsp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-30T21:16:00.900

要回答我自己的问题，请在[http://www.java.happycodings.com/Java%5fUtil%5fPackage/code23.html](http://www.java.happycodings.com/Java_Util_Package/code23.html)找到一些替换代码：

```
import java.io.ByteArrayInputStream;
import java.net.MalformedURLException;
import java.net.URL;
import java.util.Enumeration;
import java.util.Iterator;
import java.util.StringTokenizer;
import javax.activation.DataHandler;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.xml.soap.AttachmentPart;
import javax.xml.soap.MimeHeader;
import javax.xml.soap.MimeHeaders;
import javax.xml.soap.SOAPException;
import javax.xml.soap.SOAPMessage;

public class SaajUtils {
    /**
    * extract the MIME header information from within the HTTP Request
    * @param req the http request
    * @return MimeHeaders as defined within the SAAJ API
    */
    public static MimeHeaders getHeaders( HttpServletRequest req ) {
      Enumeration<String> en = req.getHeaderNames();
      MimeHeaders headers = new MimeHeaders();

      while( en.hasMoreElements() ) {
        String headerName = (String) en.nextElement();
        String headerValue = req.getHeader( headerName );

        StringTokenizer values = new StringTokenizer( headerValue, "," );
        while( values.hasMoreTokens() ) {
          headers.addHeader( headerName, values.nextToken().trim() );
        }
      }
      return headers;
    }

    /**
     * stuff the MIME headers into the HTTP response
     * @param headers the SAAJ MIME headers
     * @param res the Http servlet response
     */
    public static void putHeaders( MimeHeaders headers, HttpServletResponse res ) {
        for( Iterator<MimeHeader> it = headers.getAllHeaders(); it.hasNext(); ) {
          MimeHeader header = it.next();
          String[] values = headers.getHeader( header.getName() );
          if( values.length == 1 ) {
            res.setHeader( header.getName(), header.getValue() );
          }
          else {
            StringBuffer concat = new StringBuffer();
            for( int i = 0; i < values.length; i++ ) {
              if( i != 0 ) {
                concat.append( ',' );
              }
              concat.append( values[i] );
          }
          res.setHeader( header.getName(), concat.toString() );
        }
      }
    }

    public static void attachBytes( SOAPMessage soapMessage, byte[] theBytes, String contentType )
    throws SOAPException {
      AttachmentPart attachment = soapMessage.createAttachmentPart();
      attachment.setContent( new ByteArrayInputStream( theBytes ), contentType );
      soapMessage.addAttachmentPart( attachment );
    }

    public static void attachUrlContents( SOAPMessage soapMessage, String urlLocation, String contentType )
    throws SOAPException, MalformedURLException {
      URL url = new URL( urlLocation );
      AttachmentPart attachment = soapMessage.createAttachmentPart( new DataHandler( url ) );
      attachment.setContentType( contentType );
      soapMessage.addAttachmentPart( attachment );
    }

    public static String getAttachmentReport( SOAPMessage soapMessage ) throws SOAPException {
      int numOfAttachments = soapMessage.countAttachments();
      Iterator<AttachmentPart> attachments = soapMessage.getAttachments();

      StringBuffer buf = new StringBuffer( "Number of attachments: " );
      buf.append( numOfAttachments );

      while( attachments.hasNext() ) {
        buf.append( "\n--------------------------------------------\n" );
        AttachmentPart attachment = attachments.next();
        buf.append( "\nContent Location: " + attachment.getContentLocation() );
        buf.append( "\nContent Id: " + attachment.getContentId() );
        buf.append( "\nContent Size: " + attachment.getSize() );
        buf.append( "\nContent Type: " + attachment.getContentType() );
      }

      return buf.toString();
    }
} 
```

# .net - 数据网格控件已禁用

> ID：635866
> 
> 赞同：2
> 
> 时间：2009-03-11T18:54:04.010
> 
> 标签：.net, asp.net, datagrid, .net-2.0, hyperlink

我在 ASP.NET 2.0 中有一个 DataGrid，其中包含以下列：

```
<ASP:TEMPLATECOLUMN>
    <ItemStyle HorizontalAlign="Right"></ItemStyle>         
    <ItemTemplate>
        <asp:HyperLink id="HyperLink1" runat="server" 
            CssClass="DataGridCommand" Target="_blank"
            NavigateUrl='<%# GetPreviewURL(DataBinder.Eval(Container, "DataItem.NodeID")) %>'>
        Preview Graphic
        </asp:HyperLink>
    </ItemTemplate>
</ASP:TEMPLATECOLUMN> 
```

所以基本的想法是在 DataGrid 的每一行中都有一个链接，它会返回一个弹出图像预览（指的是 NodeID 的数据绑定列）。这工作得很好。

我正在尝试禁用没有关联图像的行的链接。为此，我将其放在后面的代码中，在 Page_Load 下：

```
foreach (DataGridItem dgi in this.dgNode.Items)
{
    HyperLink myLink1 = (HyperLink)dgi.Cells[0].FindControl("HyperLink1");

    //myLink1.Visible = false;
    //if (condition for hiding links goes here...)
    myLink1.Enabled = false;
    this.dgNode.DataBind();
} 
```

如您所见，我尝试将 visible 属性设置为 false，但这不起作用。我尝试将启用设置为false，它也不起作用。然后我再次尝试对 DataGrid 进行数据绑定——不起作用。链接继续正常运行。

有谁知道为什么这不起作用，可以做些什么来使它起作用，如果它从根本上存在缺陷，另一种解决方案？我希望将某些行的链接变灰，或者将其隐藏以使其无法单击。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T19:02:16.767

[您可以在OnRowDataBound](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)事件上处理此问题，如下所示：

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    HyperLink hl = (HyperLink)e.Row.FindControl("HyperLink1");
    hl.Visible = false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T19:00:23.697

您应该添加一个事件处理程序来处理 OnItemDataBound 事件，而不是在页面加载时循环遍历项目。然后，您可以在绑定每个项目时在那里找到并禁用超链接。

我相信当前的解决方案不起作用，因为它在将链接设置为不可见或禁用后调用 DataBind() 方法。这将导致 DataGrid 重新构建自身并擦除您刚刚所做的工作。更不用说您为每个项目重新绑定 DataGrid，这会影响性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T19:01:55.487

我敢打赌，由于您禁用超链接，然后在事后绑定数据网格，重新绑定本质上是通过其数据绑定代码再次“重新激活”链接。

作为替代方案，您是否考虑过使用 DataGrid 的 ItemDatabound 事件并在那时启用/禁用超链接？所有数据都触手可及，代码看起来与现在几乎相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T19:00:08.253

我不确定，但我认为 asp.net 很匆忙，因为您确实有多个对象 Hyperlink1 的实例。不是 ID 属性用作唯一标识符，如果有多个实例，它可能拒绝操作它。

# ruby-on-rails - 如何放一组 在一个里面

> ID：635868
> 
> 赞同：2
> 
> 时间：2009-03-11T18:54:19.033
> 
> 标签：ruby-on-rails, ruby, dom, rubygems, nokogiri

我想通过使用以下 Ruby 代码和[Nokogiri](http://github.com/tenderlove/nokogiri/tree/master)找出一种获取 HTML 结果的方法（下面将进一步提到） ：

```
require 'rubygems'
require 'nokogiri'

value = Nokogiri::HTML.parse(<<-HTML_END)
  "<html>
    <body>
      <p id='1'>A</p>
      <p id='2'>B</p>
      <h1>Bla</h1>
      <p id='3'>C</p>
      <p id='4'>D</p>
      <p id='5'>E</p>
    </body>
  </html>"
HTML_END

# The selected-array is given by the application.
# It consists of a sorted array with all ids of 
# <p> that need to be enclosed by the <div>
selected = ["2","3","4"]
first_p = selected.first
last_p = selected.last

#
# WHAT RUBY CODE DO I NEED TO INSERT HERE TO GET
# THE RESULTING HTML AS SEEN BELOW?
# 
```

生成的 HTML 应如下所示（请注意插入的`<div id='XYZ'>`）：

```
<html>
  <body>
    <p id='1'>A</p>
    <div id='XYZ'>
      <p id='2'>B</p>
      <h1>Bla</h1>
      <p id='3'>C</p>
      <p id='4'>D</p>
    </div>
    <p id='5'>E</p>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-11T18:57:31.973

在这些情况下，您通常希望使用底层库为您提供的任何[SAX 接口，以有状态地和串行地遍历和重写输入 XML（或 XHTML）：](http://en.wikipedia.org/wiki/Simple_API_for_XML)

```
require 'nokogiri'
require 'CGI'

Nokogiri::XML::SAX::Parser.new(
  Class.new(Nokogiri::XML::SAX::Document) {
    def initialize first_p, last_p
      @first_p, @last_p = first_p, last_p
    end

    def start_document
      puts '<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">'
    end

    def start_element name, attrs = []
      attrs = Hash[*attrs]
      @depth += 1 unless @depth.nil?
      print '<div>' if name=='p' && attrs['id'] == @first_p
      @depth = 1    if name=='p' && attrs['id'] == @last_p && @depth.nil?
      print "<#{ [ name, attrs.collect { |k,v| "#{k}=\"#{CGI::escapeHTML(v)}\"" } ].flatten.join(' ') }>"
    end

    def end_element name
      @depth -= 1 unless @depth.nil?
      print "</#{name}>"
      if @depth == 0
        print '</div>'
        @depth = nil
      end
    end

    def cdata_block string
      print "<![CDATA[#{CGI::escapeHTML(string)}]]>"
    end

    def characters string
      print CGI::escapeHTML(string)
    end

    def comment string
      print "<!--#{string}-->"
    end
  }.new('2', '4')
).parse(<<-HTML_END)
  <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
  <html>
    <body>
      <!-- comment -->
      <![CDATA[
        cdata goes here
      ]]>
      &quot;special&quot; entities 
      <p id="1">A</p>
      <p id="2">B</p>
      <p id="3">C</p>
      <p id="4">D</p>
      <p id="5">E</p>
      <emptytag/>
    </body>
  </html>
HTML_END 
```

或者，您也可以使用[DOM 模型接口](http://en.wikipedia.org/wiki/DOM)（而不是 SAX 接口）将整个文档加载到内存中（与您在原始问题中开始执行的方式相同），然后执行节点操作（插入和删除）为如下：

```
require 'rubygems'
require 'nokogiri'

doc = Nokogiri::HTML.parse(<<-HTML_END)
  <html>
    <body>
      <p id='1'>A</p>
      <p id='2'>B</p>
      <p id='3'>C</p>
      <p id='4'>D</p>
      <p id='5'>E</p>
    </body>
  </html>
HTML_END

first_p = "2"
last_p = "4"

doc.css("p[id=\"#{first_p}\"] ~ p[id=\"#{last_p}\"]").each { |node|
  div_node = nil
  node.parent.children.each { |sibling_node|
    if sibling_node.name == 'p' && sibling_node['id'] == first_p
      div_node = Nokogiri::XML::Node.new('div', doc)
      sibling_node.add_previous_sibling(div_node)
    end
    unless div_node.nil?
      sibling_node.remove
      div_node << sibling_node
    end
    if sibling_node.name == 'p' && sibling_node['id'] == last_p
      div_node = nil
    end
  }
}

puts doc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T08:20:11.103

这是我在项目中实施的有效解决方案（Vlad@SO & Whitelist@irc#rubyonrails：感谢您的帮助和启发。）：

```
require 'rubygems'
require 'nokogiri'

value = Nokogiri::HTML.parse(<<-HTML_END)
  "<html>
    <body>
      <p id='1'>A</p>
      <p id='2'>B</p>
      <h1>Bla</h1>
      <p id='3'>C</p>
      <p id='4'>D</p>
      <p id='5'>E</p>
    </body>
  </html>"
HTML_END

# The selected-array is given by the application.
# It consists of a sorted array with all ids of 
# <p> that need to be enclosed by the <div>
selected = ["2","3","4"]

# We want an elements, not nodesets!
# .first returns Nokogiri::XML::Element instead of Nokogiri::XML::nodeset
first_p = value.css("p##{selected.first}").first
last_p = value.css("p##{selected.last}").first
parent = value.css('body').first

# build and set new div_node
div_node = Nokogiri::XML::Node.new('div', value)
div_node['class'] = 'XYZ'

# add div_node before first_p
first_p.add_previous_sibling(div_node)

selected_node = false

parent.children.each do |tag|
  # if it's the first_p
  selected_node = true if selected.include? tag['id']
  # if it's anything between the first_p and the last_p
  div_node.add_child(tag) if selected_node
  # if it's the last_p
  selected_node = false if selected.last == tag['id']
end

puts value.to_html 
```

# linux - yum 可以告诉我哪些存储库提供了特定的包吗？

> ID：635869
> 
> 赞同：42
> 
> 时间：2009-03-11T18:54:28.783
> 
> 标签：linux, yum, package-managers

希望是问题的简短版本：如果我在安装了特定软件包的机器上，是否有一个 yum 命令可以告诉我提供该软件包的哪些配置存储库？（或者，什么存储库将提供尚未安装的软件包。）

需要一些上下文的背景：我们有一个迷宫般的 yum 存储库，我们从中提取。我有一台安装了特定 rpm 软件包的机器，以及另一台配置了明显不足的存储库迷宫的机器，因此我无法将我想要的软件包安装到那台机器上。我需要将最少的必要存储库添加到新机器。我不能只是将存储库从一台机器枪杀到另一台机器。只是出去并抓住 rpm 不是一种选择，因为我需要它是可重现的。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-11T19:03:49.023

```
yum list packagename 
```

这将在输出的第三列中显示包来自哪个存储库。

对于已安装的软件包，这将不起作用，因为第三列仅显示“已安装”。在这种情况下，您可以执行例如“rpm -qi packagename”，通常 Vendor、Packer 和 Build Host 标签将指示包属于哪个存储库。此外，将一些 repo 符号附加到包版本号也是很常见的。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-01-06T15:40:27.520

```
repoquery -i {packagename} 
```

这将为您提供实际的 repo 名称与 yum 返回的无用的“已安装”名称。repoquery 由 yum-utils 提供。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-08-29T16:18:15.623

您可以使用`yum -v search`它向您显示软件包以及它所在的 repo。如果您还添加`--showduplicates`，您将看到该软件包的所有版本。

归功于：[http ://www.spinics.net/linux/fedora/yum/msg11975.html](http://www.spinics.net/linux/fedora/yum/msg11975.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-11T04:16:08.870

对于单个包，您可以使用

```
PACKAGE=ruby-enterprise
repoquery --qf "%{repoid}" $PACKAGE 
```

将*$PACKAGE*替换为您关心的包的名称。

您可以找到来自特定存储库的所有包

```
REPO=ruby-enterprise-opt
repoquery --repoid=$REPO -a --qf "%{name}" | sort > repo_packages
rpm -qa --qf "%{name}\n" | sort > installed_packages
comm -1 -2 repo_packages installed_packages 
```

将*$REPO*替换为您关心的存储库的 id；您可以使用 . 查看所有已启用存储库的 ID `yum repolist`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-10T16:43:54.767

以下是发现给定已安装包的存储库的一些方法：

```
rpm -qi {packagename} 
```

或者

```
repoquery -i {packagename} 
```

参考：

*   [http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/add-repositories.html](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/add-repositories.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-24T06:48:15.233

```
yum reinstall [package_name] 
```

然后当要求确认时，您可以选择 N 不更改您的系统：

centos 上的示例输出：

```
Resolving Dependencies
--> Running transaction check
---> Package mc.x86_64 1:4.6.1a-35.el5 set to be updated
--> Finished Dependency Resolution

Dependencies Resolved

==============================================================================================================================================
 Package                      Arch                             Version                                   Repository                      Size
==============================================================================================================================================
Reinstalling:
 mc                           x86_64                           1:4.6.1a-35.el5                           base                           2.1 M

Transaction Summary
==============================================================================================================================================
Remove        0 Package(s)
Reinstall     1 Package(s)
Downgrade     0 Package(s)

Total download size: 2.1 M
Is this ok [y/N]: 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-01-26T10:38:04.303

# EL7

这应该等效于`yum list installed`，但具有机器可读的输出：

```
repoquery --installed '*' --queryformat='%{name} %{evr} %{ui_from_repo}' | column -t 
```

显然，制作一个列出可能字段的手册页太麻烦了；但是您可以查看[https://github.com/rpm-software-management/yum/blob/master/yum/packages.py](https://github.com/rpm-software-management/yum/blob/master/yum/packages.py)并使用您要列出的对象类的任何属性。

例如，如果您要列出已安装的包，则可以使用 的字段`YumInstalledPackage`，因此可以使用其基类`YumHeaderPackage`、`YumAvailablePackage`和`PackageObject`的字段`RpmBase`。

这是一个例子：

```
$ repoquery --installed '*' --qf='%{name} %{evr} %{ui_from_repo}' | head -n 10 | column -t
GeoIP                         1.5.0-14.el7    @rhos-13.0-rhel-7-signed
MySQL-python                  1.2.5-1.el7     @rhos-13.0-rhel-7-signed
NetworkManager                1:1.18.0-5.el7  @anaconda/7.7
NetworkManager-config-server  1:1.18.0-5.el7  @anaconda/7.7
NetworkManager-libnm          1:1.18.0-5.el7  @anaconda/7.7
NetworkManager-team           1:1.18.0-5.el7  @anaconda/7.7
NetworkManager-tui            1:1.18.0-5.el7  @anaconda/7.7
OpenIPMI                      2.0.27-1.el7    @rhos-13.0-rhel-7-signed
OpenIPMI-libs                 2.0.27-1.el7    @rhos-13.0-rhel-7-signed
OpenIPMI-modalias             2.0.27-1.el7    @rhos-13.0-rhel-7-signed 
```

值得阅读记录[属性](https://github.com/rpm-software-management/yum/blob/f8616a2d6e22705371fe6ba47597238d3d1dc2f1/yum/packages.py#L814)[的注释，`ui_from_repo`](https://github.com/rpm-software-management/yum/blob/f8616a2d6e22705371fe6ba47597238d3d1dc2f1/yum/packages.py#L814)以了解该字段的可能格式。

# EL8

我发现添加`--installed`导致 的值`ui_from_repo`变为`@System`. 但是有一个`from_repo`领域似乎有效。

（事实证明可以使用 输出有效字段`dnf repoquery --querytags`）。

```
$ dnf repoquery --installed '*' --qf='%{name} %{evr} %{from_repo}' | head -n 10 | column -t
389-ds-base              1.4.3.16-19.module+el8.4.0+11894+f5bb5c43  rhel-8-for-x86_64-appstream-rpms                                 
389-ds-base-libs         1.4.3.16-19.module+el8.4.0+11894+f5bb5c43  rhel-8-for-x86_64-appstream-rpms                                 
NetworkManager           1:1.30.0-10.el8_4                          rhel-8-for-x86_64-baseos-rpms                                    
NetworkManager-libnm     1:1.30.0-10.el8_4                          rhel-8-for-x86_64-baseos-rpms                                    
NetworkManager-team      1:1.30.0-10.el8_4                          rhel-8-for-x86_64-baseos-rpms                                    
NetworkManager-tui       1:1.30.0-10.el8_4                          rhel-8-for-x86_64-baseos-rpms                                    
PackageKit               1.1.12-6.el8                               rhel-8-for-x86_64-appstream-rpms                                 
PackageKit-glib          1.1.12-6.el8                               rhel-8-for-x86_64-appstream-rpms                                 
abattis-cantarell-fonts  0.0.25-6.el8                               rhel-8-for-x86_64-appstream-rpms 
```

# java - Java 中的矢量图形性能与 Flash 相比如何？

> ID：635878
> 
> 赞同：0
> 
> 时间：2009-03-11T18:57:21.083
> 
> 标签：java, flash, vector-graphics

答案应该比较在两个平台上绘制/动画矢量图形的最佳方法/库（特别是 java，flash 中是否有不止一种方法？）。

那些方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T20:25:52.150

在 Java 中，我认为您最好的方法是 JavaFX，但您会在下面的链接中找到其他方法。因为它太新了，所以没有像 Flash 那样多的动画库等可用。

查看：

[http://www.bubblemark.com/](http://www.bubblemark.com/)

[http://www.craftymind.com/2008/04/11/why-bubblemark-is-a-poor-ui-benchmark/](http://www.craftymind.com/2008/04/11/why-bubblemark-is-a-poor-ui-benchmark/)

[http://www.craftymind.com/guimark/](http://www.craftymind.com/guimark/)

用于性能基准。

在这两种工具中，您都可以在 SVG 或 Illustrator 中创建资源并导入，或在运行时绘制曲线/形状。

在 Flex 中，现在也有 Degrafa [http://www.degrafa.org/](http://www.degrafa.org/) - 但渲染引擎是相同的。

# code-analysis - 是否有任何工具可以确定针对 Big-O 复杂性执行代码分析？

> ID：635893
> 
> 赞同：13
> 
> 时间：2009-03-11T19:01:09.657
> 
> 标签：code-analysis, big-o, time-complexity

我还没有看到任何东西，我怀疑定义“n”有困难，因为通常用于分析复杂函数的定义不止一个或两个变量。

有用于圈复杂度的分析工具，但是否有用于时间（和/或空间）复杂度的分析工具？如果是，是哪些，如果不是，为什么不呢？不可行吗？不可能的？只是有人没有解决它吗？

理想情况下，应用程序的整体复杂性（定义不同的可能“n”）以及应用程序中的每个方法

[编辑：因此，由于停机问题](http://en.wikipedia.org/wiki/Halting_problem)，似乎不可能有一个精确的解决方案，但是，某种启发式近似是否可能？我意识到，出于实际目的，一个好的分析器会提供更多有用的信息，但这似乎是一个有趣的问题。

另外，一个计算某个程序子集的程序怎么样？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-11T19:06:47.380

不幸的是，有一个叫做[停机问题的问题](http://en.wikipedia.org/wiki/Halting_problem)......

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-11T19:09:55.343

不，由于停机问题，这是不可能的。

如果您想这样做以改进您的应用程序，则可以考虑进行分析。它可以让您确定实际花费最多的时间。这样您就不会花时间优化仅在小型数据集上运行的 O(n^3) 算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T19:46:54.523

一些想法：

真正的计算机是近似确定性的有限状态机，因此停机问题实际上并不是一个实际限制。一个实际的限制是算法的运行时间比你想等待的时间长，排除了任何蛮力分析方法。

要大致了解算法的复杂性，您始终可以在一组随机输入上运行它并测量所花费的时间。然后通过数据绘制一条曲线。

分析算法的时间复杂度可能相当复杂，需要一些创造性的步骤。（参见快速排序的示例分析）。该问题与逻辑定理证明和程序验证密切相关。构建一个能够实现复杂性的半自动解决方案的有用工具可能是可行的，即一种可以系统地搜索给出人类提示的解决方案的工具，但这当然并不容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T19:22:37.747

从未见过这样做的工具，但我们利用分析工具来更好地了解瓶颈在哪里。这并不总是很明显，我曾有几次对我认为需要很长时间的事情实际上花费很少，反之亦然感到惊讶。在 .NET 世界中，我使用过[ANTS](http://www.red-gate.com/Products/ants_profiler/index.htm)和[JetBrains](http://www.jetbrains.com/profiler/)工具。

# ruby-on-rails - Rails Active Record 表关联

> ID：635897
> 
> 赞同：1
> 
> 时间：2009-03-11T19:02:08.810
> 
> 标签：ruby-on-rails, activerecord

我的问题涉及一些不同的活动记录

```
class Respondent < ActiveRecord::Base
has_many :phone_numbers, :dependent => :destroy
has_many :email_addresses, :dependent => :destroy
belongs_to :phone_number, :foreign_key=> "primary_phone_id"
belongs_to :email_address, :foreign_key=> "primary_email_id"
end

class User < Respondent
end

class EmailAddress < ActiveRecord::Base
belongs_to :respondent
has_one :respondent
end 
```

这些表的架构是

```
create_table "email_addresses", :force => true do |t|
  t.string   "email"
  t.integer  "respondent_id"
end

create_table "respondents", :force => true do |t|
  t.string   "first_name"
  t.string   "last_name"
  t.integer  "primary_email_id"
  t.integer  "primary_phone_id"
  t.string   "type"
end 
```

我想要完成的是让受访者以及用户能够拥有多个电子邮件地址，但只有一个主要地址。出于这个原因，电子邮件记录和受访者记录相互链接。所有的电子邮件地址都存储在 email_address 记录中并引用响应者，并且响应者记录只有一封电子邮件的 id。

在 UserController 中，以下代码失败

```
def create
    @user = User.new(params[:user])
    @primary_email = EmailAddress.new(params[:primary_email])
    User.transaction do
      @user.primary_email = @primary_email  <=Undefined Method primary_email=
      @user.save!
      @primary_email.save!
      redirect_to :action => :show, :id => @user
    end
end 
```

首先，这甚至可能是我在做什么？如何修改代码以使此控制器代码工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T19:08:59.200

是的，您只需要 Respondent 具有关联的主要电子邮件：

```
has_one :primary_email, :class_name => "EmailAddress" 
```

# java - 休眠和 CMT

> ID：635906
> 
> 赞同：0
> 
> 时间：2009-03-11T19:05:17.273
> 
> 标签：java, hibernate, ejb-3.0, ejb

最近我决定在我的项目中实现 CMT 事务（jBoss5、Hibernate、jta postgres 数据源）。除了我的实体中的 Hibernate.initialize() 之外，一切都运行良好。它在 EJB bean 中工作，但是当尝试在实体 getter 中调用初始化时，我得到“无法与会话关联”异常。在实施交易之前它工作得很好。有人遇到同样的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T17:59:35.057

在以下[参考页面](http://www.hibernate.org/42.html)中，您可能需要确保为 CMT 正确配置了当前属性

*   设置`hibernate.transaction.manager_lookup_class`为您的 Java EE 容器的查找策略（有关 JTA 事务管理器的列表，请参见[此处）](http://www.hibernate.org/hib_docs/reference/en/html/configuration-j2ee.html)
*   设置`hibernate.transaction.factory_class`为`org.hibernate.transaction.CMTTransactionFactory`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T12:32:09.733

好的，经过几天浏览互联网后，我发现了问题所在。当您将方法标记为支持事务时。它不会启动它们。如果您从事务中检索对象，则它们不在会话中，因此您无法初始化它们的属性...

# c# - 在 C# 中何时使用 ref 以及何时不需要

> ID：635915
> 
> 赞同：112
> 
> 时间：2009-03-11T19:08:01.307
> 
> 标签：c#, ref

我有一个对象，它是程序的内存状态，还有一些其他工作函数，我将对象传递给它以修改状态。我一直通过 ref 将它传递给工作函数。但是我遇到了以下功能。

```
byte[] received_s = new byte[2048];
IPEndPoint tmpIpEndPoint = new IPEndPoint(IPAddress.Any, UdpPort_msg);
EndPoint remoteEP = (tmpIpEndPoint);

int sz = soUdp_msg.ReceiveFrom(received_s, ref remoteEP); 
```

它让我感到困惑，因为两者`received_s`都`remoteEP`从函数返回内容。为什么`remoteEP`需要 a`ref`而不需要`received_s`？

我也是一名交流程序员，所以我无法从脑海中获取指针。

编辑：看起来 C# 中的对象是指向引擎盖下对象的指针。因此，当您将对象传递给函数时，您可以通过指针修改对象内容，并且传递给函数的唯一内容是指向对象的指针，因此不会复制对象本身。如果您希望能够在函数中切换或创建一个新对象，就像双指针一样，您可以使用 ref 或 out 。

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2009-03-11T19:11:07.743

简短的回答：阅读我[关于参数传递的文章](http://pobox.com/~skeet/csharp/parameters.html)。

长答案：当引用类型参数按值传递时，只传递引用，*而不*传递对象的副本。这就像在 C 或 C++ 中传递一个指针（按值）。调用者不会看到参数值本身的变化，但*会*看到引用指向的对象的变化。

当一个参数（任何类型的）通过*引用*传递时，这意味着调用者可以看到对参数的任何更改 - 对参数*的*更改就是对变量的更改。

当然，这篇文章更详细地解释了所有这些:)

有用的答案：**您几乎不需要使用 ref/out**。它基本上是一种获取另一个返回值的方法，通常应该避免，因为这意味着该方法可能试图做太多事情。情况并非总是如此（`TryParse`等是合理使用的典型示例`out`），但使用 ref/out 应该是相对罕见的。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-11T19:20:32.400

将非 ref 参数视为指针，将 ref 参数视为双指针。这对我帮助最大。

您几乎不应该通过 ref 传递值。我怀疑如果不是出于互操作问题，.Net 团队永远不会将它包含在原始规范中。处理 ref 参数解决的大多数问题的 OO 方法是：

**对于多个返回值**

*   创建表示多个返回值的结构

**对于由于方法调用而在方法中发生变化的基元**（方法对基元参数有副作用）

*   将对象中的方法实现为实例方法，并将对象的状态（而不是参数）作为方法调用的一部分进行操作
*   使用多返回值解决方案并将返回值合并到您的状态
*   创建一个包含可由方法操作的状态的对象，并将该对象作为参数传递，而不是原语本身。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-11T20:06:07.860

您可能会编写一个完整的 C# 应用程序，并且永远不会通过 ref 传递任何对象/结构。

我有一位教授告诉我：

> 您唯一使用 refs 的地方是：
> 
> 1.  想要传递一个大对象（即对象/结构内部有对象/结构到多个级别）并且复制它会很昂贵并且
> 2.  您正在调用需要它的框架、Windows API 或其他 API。
> 
> 不要仅仅因为你可以就这样做。如果您开始更改参数中的值并且不注意，您可能会被一些讨厌的错误所困扰。

我同意他的建议，在我上学五年多的时间里，除了调用框架或 Windows API 之外，我从来没有需要它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T19:10:53.110

由于 received_s 是一个数组，因此您正在传递一个指向该数组的指针。该函数在适当位置操作现有数据，而不更改底层位置或指针。ref 关键字表示您将实际指针传递给该位置并在外部函数中更新该指针，因此外部函数中的值将会改变。

例如，字节数组是指向同一内存之前和之后的指针，内存刚刚更新。

Endpoint 引用实际上是将外部函数中指向 Endpoint 的指针更新为函数内部生成的新实例。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-11T19:11:13.967

将 ref 视为您通过引用传递指针的意思。不使用 ref 意味着您正在按值传递指针。

更好的是，忽略我刚才所说的（这可能具有误导性，尤其是值类型）并阅读[This MSDN page](http://msdn.microsoft.com/en-us/library/0f66670z(VS.71).aspx)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-25T20:04:41.357

虽然我总体上同意 Jon Skeet 的回答和其他一些答案，但使用 有一个用例`ref`，那就是加强性能优化。在性能分析过程中观察到，设置方法的返回值对性能有轻微影响，而`ref`将返回值用作参数会导致该轻微瓶颈被消除。

这只有在优化工作达到极端水平、牺牲可读性以及可能的可测试性和可维护性以节省毫秒或分毫秒的情况下才真正有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-23T09:30:54.757

我的理解是，从 Object 类派生的所有对象都作为指针传递，而普通类型（int、struct）不作为指针传递并且需要引用。我不确定字符串（它最终是从 Object 类派生的吗？）

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-04-14T16:18:23.200

零基础规则首先，在涉及的类型的上下文中，基元通过值（堆栈）传递，非基元通过引用（堆）传递。

涉及的参数默认通过Value传递。很好的帖子，详细解释了事情。 **[http://yoda.arachsys.com/csharp/parameters.html](http://yoda.arachsys.com/csharp/parameters.html)**

```
Student myStudent = new Student {Name="A",RollNo=1};

ChangeName(myStudent);

static void ChangeName(Student s1)
{
  s1.Name = "Z"; // myStudent.Name will also change from A to Z
                // {AS s1 and myStudent both refers to same Heap(Memory)
                //Student being the non-Primitive type
}

ChangeNameVersion2(ref myStudent);
static void ChangeNameVersion2(ref Student s1)
{
  s1.Name = "Z"; // Not any difference {same as **ChangeName**}
}

static void ChangeNameVersion3(ref Student s1)
{
    s1 = new Student{Name="Champ"};

    // reference(myStudent) will also point toward this new Object having new memory
    // previous mystudent memory will be released as it is not pointed by any object
} 
```

我们可以说（带有警告）非原始类型只不过是**指针** 当我们通过 ref 传递它们时，我们可以说我们正在传递**双指针**

# jquery - 一个好的 jQuery 1.3 自动完成插件？

> ID：635921
> 
> 赞同：11
> 
> 时间：2009-03-11T19:08:32.883
> 
> 标签：jquery, autocomplete

我对此束手无策，因为似乎没有任何可行的方法。

我尝试过使用来自 SVN 的 jQuery UI 的自动完成功能，可以在这里找到：http: [//jquery-ui.googlecode.com/svn/branches/dev/autocomplete/](http://jquery-ui.googlecode.com/svn/branches/dev/autocomplete/)

但是完全缺乏（更新的）文档让我在我的结果列表中显示了一堆 [Object]，不知道如何格式化它。

我只想要一个简单的自动完成插件：

*   允许我返回插件本身将解析的 JSON 对象

*   允许我从 displayField 中指定一个单独的 inputField，以便用户看到“Stackoverflow Industries”，但输入字段实际上是“5”，即公司 ID。

*   显然，自动完成插件会做的基础

提前致谢..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-11T19:37:32.377

我用这个插件写了一个小例子来回答[这个问题](https://stackoverflow.com/questions/612045/jquery-autocomplete-for-input-form-using-textpattern-category-list-as-a-source/612208#612208)。在这个例子中，它不是一个“JSON对象”，而是一个由插件处理的“选项”对象（是的......别问......）并且选项的值存储在隐藏字段中，而文本显示在文本框中。最好的办法是查看[演示页面](http://jquery.bassistance.de/autocomplete/demo/)并检查代码以了解您可以使用的选项。为什么不扩展插件以使其具有您想要的确切行为呢？这并不[难](https://stackoverflow.com/questions/610847/how-to-you-attach-a-custom-callback-function-to-the-jquery-autocomplete-extension/611218#611218)。

无论如何，只需举一个您需要的实例，我们会尽力帮助您:)

# asp.net - 如何创建详细的错误页面？

> ID：635922
> 
> 赞同：4
> 
> 时间：2009-03-11T19:08:51.370
> 
> 标签：asp.net, exception

我想创建一个自定义错误页面来处理所有未处理的异常。

我想从`Application_Error(object sender, EventArgs e)`位于 Global.asax.cs 中的方法重定向到它。如何在其中显示引发应用程序错误的异常的一些详细信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T19:46:36.253

我已经做了你所说的同样的事情。我创建了一个向用户显示信息的 ErrorPage。我还创建了一个将错误信息写入事件日志的函数......

对于页面，这就是我正在做的事情。把标签贴在某个地方...

```
protected void Page_Load(object sender, EventArgs e)
{
    Exception ex = Server.GetLastError().GetBaseException();
    this.lblMessage.Text = ex.Message;
    this.lblSource.Text = ex.Source;
    this.lblStackTrace.Text = ex.StackTrace;
    if (AppProperties.AppEnv != AppEnvironment.PROD)
    {
        this.ErrorDetails.Visible = true;
    }
    else
    {
        this.ErrorDetails.Visible = false;
    }
    Utility.LogError();
    Server.ClearError();
} 
```

这就是 LogError 函数的样子......

```
public static void LogError()
{
    LogError(HttpContext.Current.Server.GetLastError().GetBaseException());
}

public static void LogError(Exception ex)
{
    EventLog log = new EventLog();
    if (ex != null)
    {
        log.Source = ConfigurationManager.AppSettings["EventLog"].ToString();
        StringBuilder sErrorMessage = new StringBuilder();
        if (HttpContext.Current.Request != null && HttpContext.Current.Request.Url != null)
        {
            sErrorMessage.Append(HttpContext.Current.Request.Url.ToString() + System.Environment.NewLine);
        }
        sErrorMessage.Append(ex.ToString());
        log.WriteEntry(sErrorMessage.ToString(), EventLogEntryType.Error);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T19:51:00.627

您可以从 Server.GetLastError() 获取最后一个异常。一旦你处理了错误，你可以通过调用 Server.ClearError() 来清除它。

顺便说一句，向最终用户展示太多被认为是不好的做法可能会被证明是一个安全漏洞。另外，请注意，如果您重定向而不是返回 500 HTTP 错误代码，各种机器人将不会意识到它们正在导致崩溃并继续在您的站点上运行相同的中断请求。所以一定要使用 Server.Transfer() 而不是 Response.Redirect() 并设置 Response.StatusCode = 500。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T19:13:19.097

您可以使用 Server.GetLastError() 来获取应用程序引发的异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T19:14:34.163

在您的页面中，执行以下操作：

```
ErrorLabel.Text = Server.GetLastError(); 
```

这假设 C#。然后，您可以从 global.asax 文件 ApplicationError 事件重定向。还有其他处理方法，我不建议使用异常消息向用户显示。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-11T20:22:00.147

向最终用户显示详细的错误信息几乎总是一个坏主意。您最终可能会暴露各种不合适的信息：文件名、数据库凭据、实现细节等。将异常记录到安全的地方（日志文件、数据库等），但不要向用户显示。

# sql - 选择与 session_id 匹配的最新记录

> ID：635932
> 
> 赞同：1
> 
> 时间：2009-03-11T19:10:50.943
> 
> 标签：sql, mysql

我应该在关系数据库课上多加注意，所以我需要一些帮助。

我有一个这样的表格（还有更多，但我只发布相关信息）：

```
+------------------+-------------+------+-----+-------------------+-------+
| Field            | Type        | Null | Key | Default           | Extra |
+------------------+-------------+------+-----+-------------------+-------+
| session_id       | char(32)    | NO   |     | NULL              |       |
| file             | varchar(30) | NO   |     | NULL              |       |
| access_time      | timestamp   | NO   |     | CURRENT_TIMESTAMP |       |
+------------------+-------------+------+-----+-------------------+-------+` 
```

我想为每个选择`file`最大的记录字段。几乎是每个会话中访问的最后一页。`access_time``session_id`

我已经尝试过无数种 DISTINCT 和 GROUP BY 子句的组合，但由于某种原因，我似乎无法理解它。我正在使用 MySQL。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T19:17:06.293

```
select * from my_table t1
    where t1.access_time = (
       select max(t2.access_time) 
         from my_table t2 
         where t2.session_id = t1.session_id
       ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T19:13:33.680

我知道这将在 SQL Server 中工作，它应该移植到 MySQL。

```
select session_id, timestamp, file 
from table t1
join (select session_id, max(timestamp) as timestamp) 
        from table group by session_id) as t2
   on t1.session_id = t2.session_id
     and t1.timestamp = t2.timestamp 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T19:17:43.670

```
SELECT
     T1.session_id,
     T1.file,
     T1.access_time
FROM
     My_Table T1
LEFT OUTER JOIN My_Table T2 ON
     T2.session_id = T1.session_id AND
     T2.access_time > T1.access_time
WHERE
     T2.session_id IS NULL 
```

如果同一 session_id 有重复的 access_time 值，那么您可能会获得该 session_id 的多行。如果需要，您可以根据针对该情况的业务规则进行调整以避免这种情况。

# java - 如何在 Java 中计算时间跨度并格式化输出？

> ID：635935
> 
> 赞同：45
> 
> 时间：2009-03-11T19:11:09.523
> 
> 标签：java, date, time, formatting

我想花两次（自纪元以来的秒数）并以如下格式显示两者之间的差异：

*   2分钟
*   1小时15分钟
*   3小时9分钟
*   1 分钟前
*   1 小时 2 分钟 前

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2010-05-08T23:33:33.790

^(*既然大家都喊“YOODAA！！！” 但是没有人发布一个具体的例子，这是我的贡献。*)

您也可以使用[Joda-Time](http://www.joda.org/joda-time/)执行此操作。用于[`Period`](http://www.joda.org/joda-time/apidocs/org/joda/time/Period.html)表示句点。要将句点格式化为所需的人类表示形式，请使用[`PeriodFormatter`](http://www.joda.org/joda-time/apidocs/org/joda/time/format/PeriodFormatter.html)您可以构建的[`PeriodFormatterBuilder`](http://www.joda.org/joda-time/apidocs/org/joda/time/format/PeriodFormatterBuilder.html).

这是一个启动示例：

```
DateTime myBirthDate = new DateTime(1978, 3, 26, 12, 35, 0, 0);
DateTime now = new DateTime();
Period period = new Period(myBirthDate, now);

PeriodFormatter formatter = new PeriodFormatterBuilder()
    .appendYears().appendSuffix(" year, ", " years, ")
    .appendMonths().appendSuffix(" month, ", " months, ")
    .appendWeeks().appendSuffix(" week, ", " weeks, ")
    .appendDays().appendSuffix(" day, ", " days, ")
    .appendHours().appendSuffix(" hour, ", " hours, ")
    .appendMinutes().appendSuffix(" minute, ", " minutes, ")
    .appendSeconds().appendSuffix(" second", " seconds")
    .printZeroNever()
    .toFormatter();

String elapsed = formatter.print(period);
System.out.println(elapsed + " ago"); 
```

更加清晰和简洁，不是吗？

这现在打印

```
32 年 1 个月 1 周 5 天 6 小时 56 分 24 秒前

```

^([（咳，老，咳）])

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-03-11T20:39:14.350

```
 Date start = new Date(1167627600000L); // JANUARY_1_2007
    Date end = new Date(1175400000000L); // APRIL_1_2007

    long diffInSeconds = (end.getTime() - start.getTime()) / 1000;

    long diff[] = new long[] { 0, 0, 0, 0 };
    /* sec */diff[3] = (diffInSeconds >= 60 ? diffInSeconds % 60 : diffInSeconds);
    /* min */diff[2] = (diffInSeconds = (diffInSeconds / 60)) >= 60 ? diffInSeconds % 60 : diffInSeconds;
    /* hours */diff[1] = (diffInSeconds = (diffInSeconds / 60)) >= 24 ? diffInSeconds % 24 : diffInSeconds;
    /* days */diff[0] = (diffInSeconds = (diffInSeconds / 24));

    System.out.println(String.format(
        "%d day%s, %d hour%s, %d minute%s, %d second%s ago",
        diff[0],
        diff[0] > 1 ? "s" : "",
        diff[1],
        diff[1] > 1 ? "s" : "",
        diff[2],
        diff[2] > 1 ? "s" : "",
        diff[3],
        diff[3] > 1 ? "s" : "")); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-05-08T23:09:07.247

是的，唤醒了我的死者，但这是我基于@mtim 发布的代码改进的实现，因为这个线程几乎在搜索的顶部，所以我在搞乱昏昏欲睡的空洞，

```
 public static String getFriendlyTime(Date dateTime) {
    StringBuffer sb = new StringBuffer();
    Date current = Calendar.getInstance().getTime();
    long diffInSeconds = (current.getTime() - dateTime.getTime()) / 1000;

    /*long diff[] = new long[]{0, 0, 0, 0};
    /* sec *  diff[3] = (diffInSeconds >= 60 ? diffInSeconds % 60 : diffInSeconds);
    /* min *  diff[2] = (diffInSeconds = (diffInSeconds / 60)) >= 60 ? diffInSeconds % 60 : diffInSeconds;
    /* hours *  diff[1] = (diffInSeconds = (diffInSeconds / 60)) >= 24 ? diffInSeconds % 24 : diffInSeconds;
    /* days * diff[0] = (diffInSeconds = (diffInSeconds / 24));
     */
    long sec = (diffInSeconds >= 60 ? diffInSeconds % 60 : diffInSeconds);
    long min = (diffInSeconds = (diffInSeconds / 60)) >= 60 ? diffInSeconds % 60 : diffInSeconds;
    long hrs = (diffInSeconds = (diffInSeconds / 60)) >= 24 ? diffInSeconds % 24 : diffInSeconds;
    long days = (diffInSeconds = (diffInSeconds / 24)) >= 30 ? diffInSeconds % 30 : diffInSeconds;
    long months = (diffInSeconds = (diffInSeconds / 30)) >= 12 ? diffInSeconds % 12 : diffInSeconds;
    long years = (diffInSeconds = (diffInSeconds / 12));

    if (years > 0) {
        if (years == 1) {
            sb.append("a year");
        } else {
            sb.append(years + " years");
        }
        if (years <= 6 && months > 0) {
            if (months == 1) {
                sb.append(" and a month");
            } else {
                sb.append(" and " + months + " months");
            }
        }
    } else if (months > 0) {
        if (months == 1) {
            sb.append("a month");
        } else {
            sb.append(months + " months");
        }
        if (months <= 6 && days > 0) {
            if (days == 1) {
                sb.append(" and a day");
            } else {
                sb.append(" and " + days + " days");
            }
        }
    } else if (days > 0) {
        if (days == 1) {
            sb.append("a day");
        } else {
            sb.append(days + " days");
        }
        if (days <= 3 && hrs > 0) {
            if (hrs == 1) {
                sb.append(" and an hour");
            } else {
                sb.append(" and " + hrs + " hours");
            }
        }
    } else if (hrs > 0) {
        if (hrs == 1) {
            sb.append("an hour");
        } else {
            sb.append(hrs + " hours");
        }
        if (min > 1) {
            sb.append(" and " + min + " minutes");
        }
    } else if (min > 0) {
        if (min == 1) {
            sb.append("a minute");
        } else {
            sb.append(min + " minutes");
        }
        if (sec > 1) {
            sb.append(" and " + sec + " seconds");
        }
    } else {
        if (sec <= 1) {
            sb.append("about a second");
        } else {
            sb.append("about " + sec + " seconds");
        }
    }

    sb.append(" ago");

    /*String result = new String(String.format(
    "%d day%s, %d hour%s, %d minute%s, %d second%s ago",
    diff[0],
    diff[0] > 1 ? "s" : "",
    diff[1],
    diff[1] > 1 ? "s" : "",
    diff[2],
    diff[2] > 1 ? "s" : "",
    diff[3],
    diff[3] > 1 ? "s" : ""));*/
    return sb.toString();
} 
```

显然是可以改进的。基本上它试图让时间跨度更友好，但有一些限制，即如果时间过去（参数）是在未来，它会表现得很奇怪，并且它仅限于天，小时和秒（几个月和几年不是处理，以便其他人可以;-)。

示例输出是：

*   大约一秒钟前
*   8 分 34 秒前
*   1 小时 4 分钟 前
*   一天前
*   29 天前
*   一年零三个月前

，欢呼：D

编辑：现在支持几个月和几年：P

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-11T19:30:51.970

我建议你看看[HumanTime](http://johannburkard.de/blog/programming/java/date-formatting-parsing-humans-humantime.html)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-02-25T22:24:31.493

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-11T19:15:04.303

我不是 Java 专家，但你可以做 t1-t2=t3(in seconds) 然后除以 60，给你分钟，再除以 60 给你秒。然后，只需弄清楚您需要多少个部门即可。

希望能帮助到你。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-11T23:17:50.037

如果您的时间跨度跨越夏令时（夏令时）边界，您要报告天数吗？

例如，第二天 23:00 到 23:00 始终是一天，但可能是 23、24 或 25 小时，具体取决于您是否跨越夏令时转换。

如果您关心这一点，请确保将其纳入您的选择。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-04-19T09:30:12.620

一些使用日期格式的代码......和时间之前。

```
SimpleDateFormat curFormater = new SimpleDateFormat("EEE, dd MMM yyyy kk:mm:ss"); 
    try {
        Date dateObj = curFormater.parse(pubDate);

        SimpleDateFormat postFormater = new SimpleDateFormat("MMMM dd, yyyy ss:mm:hh");              
        String newDateStr = postFormater.format(dateObj); 
        Log.v("THE NEW DATE IS",newDateStr);            
        long pubdateinmilis = dateObj.getTime();            
        pubDate = (String) DateUtils.getRelativeTimeSpanString(pubdateinmilis, System.currentTimeMillis(),DateUtils.HOUR_IN_MILLIS,DateUtils.FORMAT_ABBREV_RELATIVE);

    } catch (ParseException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-04-30T20:41:04.900

您可以使用[`java.time.Duration`](https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html)它以[ISO-8601 标准](https://en.wikipedia.org/wiki/ISO_8601)为模型，并作为[JSR-310 实现](https://jcp.org/aboutJava/communityprocess/pfd/jsr310/JSR-310-guide.html)的一部分与*Java-8*一起引入。*Java-9*引入了一些更方便的方法。

 ***演示：**

```
import java.time.Duration;
import java.time.Instant;

class Main {
    public static void main(String[] args) {
        // Test
        System.out.println(getFormattedDuration(1619575035, 1619810961));
    }

    public static String getFormattedDuration(long start, long end) {
        Instant startInstant = Instant.ofEpochSecond(start);
        Instant endInstant = Instant.ofEpochSecond(end);

        Duration duration = Duration.between(startInstant, endInstant);

        // Custom format
        // ####################################Java-8####################################
        return String.format("%d days, %d hours, %d minutes, %d seconds", duration.toDays(), duration.toHours() % 24,
                duration.toMinutes() % 60, duration.toSeconds() % 60);
        // ##############################################################################

        // ####################################Java-9####################################
        // return String.format("%d days, %d hours, %d minutes, %d seconds",
        // duration.toDaysPart(), duration.toHoursPart(),
        // duration.toMinutesPart(), duration.toSecondsPart());
        // ##############################################################################
    }
} 
```

**输出：**

```
2 days, 17 hours, 32 minutes, 6 seconds 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-11T19:18:32.547

我总是从[Joda Time](http://joda-time.sourceforge.net/index.html "乔达时间主页")开始。在 Java 中处理日期和时间总是“有趣”的，但 Joda Time 可以减轻压力。

他们有 Interval 和 Duration 类，可以完成您正在寻找的一半。不确定它们是否具有以可读格式输出的功能。我会继续寻找。

高温高压

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-11T19:18:49.940

[Calendar](http://java.sun.com/javase/6/docs/api/java/util/Calendar.html)类可以处理大多数与日期相关的数学。不过，您必须自己获取[compareTo](http://java.sun.com/javase/6/docs/api/java/util/Calendar.html#compareTo(java.util.Calendar))的结果并输出格式。没有一个标准库可以完全满足您的需求，尽管可能有一个 3rd 方库可以做到。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-11T19:31:29.957

好的，在简要阅读 API 之后，您似乎可以执行以下操作：-

1.  创建一些表示开始时间和结束时间的 ReadableInstants。
2.  使用 Hours.hoursBetween 获取小时数
3.  使用 Minutes.minutesBetween 获取分钟数
4.  在分钟上使用 mod 60 以获得剩余的分钟数
5.  瞧！

高温高压

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-09-03T03:51:02.537

“Abduliam Rehmanius”的解决方案看起来很不错，或者你可以使用上面的一些库或者你可以创建新的简单的东西，参考这里的 JS 解决方案：[http](http://www.datejs.com/) ://www.datejs.com/ 。转换成 Java lang 并不难 :-)

希望我的链接对你有用！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-02-05T19:39:11.377

Java 中的格式化时间跨度在 ETL 或 DB 拉取中经常为我弹出。以下代码片段是我如何获得操作的脉搏。

```
 SimpleDateFormat ymdhms=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
    DecimalFormat formatter = new DecimalFormat("#,###"); /* ("#,###.00"); gives you the decimal fractions */
    int counter=0;
    Date beginTime0=new Date();
    while (<some end condition>) {

        <some time consuming operation>

        /*// uncomment this section durring initial exploration of the time consumer
        if(counter>100000){
            System.out.println("debug exiting due to counter="+counter);
            System.exit(0);
        }
        */

        if(0==counter%1000){
            Date now = new Date();
            long diffInSeconds = (now.getTime() - beginTime0.getTime()) / 1000;
            long diff[] = new long[] { 0, 0, 0, 0 };
            diff[3] = (diffInSeconds >= 60 ? diffInSeconds % 60 : diffInSeconds);                        /* sec   */ 
            diff[2] = (diffInSeconds = (diffInSeconds / 60)) >= 60 ? diffInSeconds % 60 : diffInSeconds; /* min   */ 
            diff[1] = (diffInSeconds = (diffInSeconds / 60)) >= 24 ? diffInSeconds % 24 : diffInSeconds; /* hours */ 
            diff[0] = (diffInSeconds = (diffInSeconds / 24));                                            /* days  */ 
            String delta = String.format(
                "%s%s%s%s"
                ,(diff[0]>0?String.format("%d day%s "    ,diff[0],(diff[0]!=1?"s":"")):"")
                ,(diff[1]>0?String.format("%2d hour%s "  ,diff[1],(diff[1]!=1?"s":" ")):"")
                ,(diff[2]>0?String.format("%2d minute%s ",diff[2],(diff[2]!=1?"s":" ")):"")
                ,           String.format("%2d second%s ",diff[3],(diff[3]!=1?"s":" "))
            );
            System.out.println(String.format(
                "%12s %s delta= %s"
                ,formatter.format(counter)
                ,ymdhms.format(new Date())
                ,delta
                )
            );
        }
        counter++;
    } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-08-26T10:16:26.137

我认为您正在寻找**PrettyTime**
PrettyTime 是一个开源时间格式库之类的东西。完全可定制，它创建*人类可读*的*相对时间戳*，就像在 Digg、Twitter 和 Facebook 上看到的那样。它提供 30 多种语言！
链接： [https ://github.com/ocpsoft/prettytime](https://github.com/ocpsoft/prettytime)

安卓也可以用

例如

```
System.out.println(p.format(new Date(System.currentTimeMillis() + 1000*60*10)));
        //prints: "10 minutes from now" 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-02-25T07:37:47.447

最近我有同样的要求，我需要一个基本的方法来打印持续时间。我没有选择使用任何第三方库。所以我只是进一步完善了@mtim 的想法。

```
public static void main(String[] args) throws IOException, ParseException {
        String since = "2017-02-24T04:44:05.601Z";
        DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'");
        TimeZone utc = TimeZone.getTimeZone("UTC");
        dateFormat.setTimeZone(utc);

        Date sinceDate = dateFormat.parse(since);
        Date now = new Date();
        long durationInSeconds  = TimeUnit.MILLISECONDS.toSeconds(now.getTime() - sinceDate.getTime());

        long SECONDS_IN_A_MINUTE = 60;
        long MINUTES_IN_AN_HOUR = 60;
        long HOURS_IN_A_DAY = 24;
        long DAYS_IN_A_MONTH = 30;
        long MONTHS_IN_A_YEAR = 12;

        long sec = (durationInSeconds >= SECONDS_IN_A_MINUTE) ? durationInSeconds % SECONDS_IN_A_MINUTE : durationInSeconds;
        long min = (durationInSeconds /= SECONDS_IN_A_MINUTE) >= MINUTES_IN_AN_HOUR ? durationInSeconds%MINUTES_IN_AN_HOUR : durationInSeconds;
        long hrs = (durationInSeconds /= MINUTES_IN_AN_HOUR) >= HOURS_IN_A_DAY ? durationInSeconds % HOURS_IN_A_DAY : durationInSeconds;
        long days = (durationInSeconds /= HOURS_IN_A_DAY) >= DAYS_IN_A_MONTH ? durationInSeconds % DAYS_IN_A_MONTH : durationInSeconds;
        long months = (durationInSeconds /=DAYS_IN_A_MONTH) >= MONTHS_IN_A_YEAR ? durationInSeconds % MONTHS_IN_A_YEAR : durationInSeconds;
        long years = (durationInSeconds /= MONTHS_IN_A_YEAR);

        String duration = getDuration(sec,min,hrs,days,months,years);
        System.out.println(duration);
    }
    private static String getDuration(long secs, long mins, long hrs, long days, long months, long years) {
        StringBuffer sb = new StringBuffer();
        String EMPTY_STRING = "";
        sb.append(years > 0 ? years + (years > 1 ? " years " : " year "): EMPTY_STRING);
        sb.append(months > 0 ? months + (months > 1 ? " months " : " month "): EMPTY_STRING);
        sb.append(days > 0 ? days + (days > 1 ? " days " : " day "): EMPTY_STRING);
        sb.append(hrs > 0 ? hrs + (hrs > 1 ? " hours " : " hour "): EMPTY_STRING);
        sb.append(mins > 0 ? mins + (mins > 1 ? " mins " : " min "): EMPTY_STRING);
        sb.append(secs > 0 ? secs + (secs > 1 ? " secs " : " secs "): EMPTY_STRING);
        sb.append("ago");
        return sb.toString();
    } 
```

输出将以文字形式打印的时间间隔（持续时间），例如 `1 day 2 hours 51 mins 41 secs ago`

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-10-29T08:38:03.077

这个问题很老，已经有了答案，但我有更好的解决方案。使用 date utils 中的 relativeSpan

```
 dateHere.setText(DateUtils.getRelativeTimeSpanString(timeInMillis,
                        System.currentTimeMillis(), DateUtils.SECOND_IN_MILLIS)); 
```

它需要参数：long/int 时间、当前时间以及您想要的时间、_month、minute、second 等

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2009-03-11T19:22:23.690

```
long time1, time2;
time1 = System.currentMillis();

.. drink coffee

time2 = System.currentMillis();

long difference = time2 - time1 // millies between time1 and time2

java.util.Date differneceDate = new Date(difference); 
```

要创建像“2 Minutes”这样的字符串，您应该使用 DateFormatter/DateFormat。您可以在 Java API 规范 (java.sun.com) 中找到更多详细信息。

# mysql - 如何为 MySQL 中的多个列指定唯一约束？

> ID：635937
> 
> 赞同：980
> 
> 时间：2009-03-11T19:12:31.843
> 
> 标签：mysql, unique-constraint, composite-key, database-table

我有一张桌子：

```
table votes (
    id,
    user,
    email,
    address,
    primary key(id),
); 
```

现在我想让列**用户、电子邮件、地址**（一起）唯一。

我如何在 MySql 中执行此操作？

当然，这个例子只是……一个例子。所以请不要担心语义。

* * *

## 回答 #1

> 赞同：1611
> 
> 时间：2009-03-11T19:14:20.480

要添加唯一约束，您需要使用两个组件：

`ALTER TABLE`- 更改表架构，并且，

`ADD UNIQUE`- 添加唯一约束。

然后，您可以使用格式定义新的唯一键`'name'('column1', 'column2'...)`

因此，对于您的特定问题，您可以使用以下命令：

```
ALTER TABLE `votes` ADD UNIQUE `unique_index`(`user`, `email`, `address`); 
```

* * *

## 回答 #2

> 赞同：281
> 
> 时间：2010-08-09T14:56:16.230

我有一个 MySQL 表：

```
CREATE TABLE `content_html` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `id_box_elements` int(11) DEFAULT NULL,
  `id_router` int(11) DEFAULT NULL,
  `content` mediumtext COLLATE utf8_czech_ci NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `my_uniq_id` (`id_box_elements`,`id_router`)
); 
```

并且 UNIQUE KEY 按预期工作，它允许 id_box_elements 和 id_router 的多个 NULL 行。

我正在运行 MySQL 5.1.42，所以上面讨论的问题可能有一些更新。幸运的是它有效，希望它会保持这种状态。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2010-05-07T21:21:31.563

如果行中有 NULL 值，则多列唯一索引在 MySQL 中不起作用，因为 MySQL 将 NULL 视为唯一值，并且至少目前没有逻辑可以在多列索引中解决它。是的，这种行为很疯狂，因为它限制了多列索引的许多合法应用程序，但它就是这样......到目前为止，这是一个在 MySQL 上被标记为“将无法修复”的错误错误跟踪...

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-03-11T19:14:24.537

你试过这个吗？

```
UNIQUE KEY `thekey` (`user`,`email`,`address`) 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2014-01-02T19:00:38.617

这适用于 mysql 版本 5.5.32

```
ALTER TABLE  `tablename` ADD UNIQUE (`column1` ,`column2`); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-08-03T12:56:47.940

MySql 5 或更高版本的行为如下（我刚刚测试过）：

*   您可以定义涉及可空列的唯一约束。假设您定义了一个唯一的约束 (A, B)，其中 A 不可为空，但 B 为
*   在评估这样的约束时，您可以拥有 (A, null) 任意多次（相同的 A 值！）
*   你只能有一对 (A, not null B)

示例：PRODUCT_NAME, PRODUCT_VERSION 'glass', null 'glass', null 'wine', 1

现在，如果您再次尝试插入 ('wine' 1)，它将报告违反约束希望这会有所帮助

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-03-20T00:40:34.417

**您可以通过phpMyAdmin**添加多列唯一索引。（我在 4.0.4 版本中测试过）

导航到目标表的**结构**页面。向其中一列添加唯一索引。展开结构页面底部的*索引*列表以查看您刚刚添加的唯一索引。单击编辑图标，然后在以下对话框中，您可以向该唯一索引添加其他列。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-06-27T21:20:18.240

我这样做：

```
CREATE UNIQUE INDEX index_name ON TableName (Column1, Column2, Column3); 
```

我对独特的约定`index_name`是`TableName_Column1_Column2_Column3_uindex`.

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-07-10T08:22:41.810

要添加唯一索引，需要以下内容：

1) table_name
2) index_name
3) 要添加索引的列

```
ALTER TABLE  `tablename` 
ADD UNIQUE index-name
(`column1` ,`column2`,`column3`,...,`columnN`); 
```

在您的情况下，我们可以按如下方式创建唯一索引：

```
ALTER TABLE `votes`ADD 
UNIQUE <votesuniqueindex>;(`user` ,`email`,`address`); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-10-09T05:50:17.410

如果您在 mysql 中创建表，请使用以下内容：

```
create table package_template_mapping (
mapping_id  int(10) not null auto_increment  ,
template_id int(10) NOT NULL ,
package_id  int(10) NOT NULL ,
remark      varchar(100),
primary key (mapping_id) ,
UNIQUE KEY template_fun_id (template_id , package_id)
); 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-08-31T02:57:44.110

本教程对我有用

```
ALTER TABLE table_name
ADD CONSTRAINT constraint_name UNIQUE (column1, column2, ... column_n); 
```

[https://www.mysqltutorial.org/mysql-unique-constraint/](https://www.mysqltutorial.org/mysql-unique-constraint/)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-03-09T13:04:54.030

如果您想在将来避免重复。创建另一个列，例如 id2。

```
UPDATE tablename SET id2 = id; 
```

现在在两列上添加唯一性：

```
alter table tablename add unique index(columnname, id2); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-01-13T18:32:10.950

首先摆脱现有的重复

```
delete a from votes as a, votes as b where a.id < b.id 
and a.user <=> b.user and a.email <=> b.email 
and a.address <=> b.address; 
```

然后添加唯一约束

```
ALTER TABLE votes ADD UNIQUE unique_index(user, email, address); 
```

验证约束

```
SHOW CREATE TABLE votes; 
```

*请注意，如果其中任何一个具有空值，则用户、电子邮件、地址将被视为唯一。*

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-05-06T11:01:07.243

对于 PostgreSQL... 索引对我不起作用；它给了我一个错误，所以我这样做了：

```
alter table table_name
add unique(column_name_1,column_name_2); 
```

PostgreSQL 给唯一索引起了自己的名字。我想您可以在表的选项中更改索引的名称，如果需要更改...

# asp.net-mvc - MVC，从视图内部获取 MasterPage 路径

> ID：635941
> 
> 赞同：0
> 
> 时间：2009-03-11T19:13:54.740
> 
> 标签：asp.net-mvc, master-pages

我如何从视图中获取 MasterPage 的路径，我认为

```
((WebFormView)Html.ViewContext.View).MasterPath 
```

会做的伎俩，但不幸的是，它总是空的。

那我怎么得到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T19:33:54.537

我不确定您到底需要什么，但视图应该有一个 MasterPageFile 属性，其中包含 MasterPage 的相对路径。如果需要物理位置，可以使用 MapPath。

```
<%= this.MasterPageFile %>

<%= MapPath( this.MasterPageFile ) %> 
```

# python - python：使用call.subprocess在写入文件后使用文件的问题

> ID：635946
> 
> 赞同：0
> 
> 时间：2009-03-11T19:14:37.797
> 
> 标签：python, subprocess

在 python 中，我试图编写一个脚本来编辑文本文件，然后运行使用这些文本文件的可执行文件。它基本上需要 1）打开和读取/写入文本文件，以及 2）使用我刚刚在 bash 命令中编写的文件。这是一个简单的例子：

```
import subprocess

# write file
a = ['1\n','2\n','3\n','4\n','5th and final line']
f = open('junk01.txt', 'wb')
f.writelines(a)
f.close

# show file
subprocess.call('cat junk01.txt', shell=True) 
```

由于某种原因，该`subprocess.call`命令没有显示 junk01.txt 文件的内容。但是，在我运行此代码并输入`cat junk01.txt`bash 后，文件已正确写入。同样，我发现在我打开、写入和关闭文本文件然后尝试在可执行文件中使用它之后，该文件还没有被写入。关于为什么会这样以及我能做些什么来解决它的任何解释？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-11T19:18:45.790

通过实际调用 close() 方法来关闭文件。这将隐式地将缓冲区刷新到磁盘。

```
f.close() 
```

而不是

```
f.close     #this probably doesn't do anything, but if there was no close method it would raise an error. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-12T13:08:19.267

尽管第一个答案绝对是正确和正确的，但您也可以将 f 设置为 None 而不是按如下方式完成：

```
import subprocess

# write file
a = ['1\n','2\n','3\n','4\n','5th and final line\n']
f = open('junk01.txt', 'wb')
f.writelines(a)
f = None
# show file
subprocess.call('cat junk01.txt', shell=True) 
```

~

将 f 设置为 None 会使变量停止服务并导致文件被隐式关闭而不是被显式关闭（如在第一个首选示例中）我不提倡这种编写代码的风格，因为它有点草率，我只是提到它作为替代解决方案。

```
[centos@localhost ~/test/stack]$  python 1.py
1
2
3
4
5th and final line
[centos@localhost ~/test/stack]$ 
```

# c# - C# WebBrowser 控件——在 AJAX 之后获取文档元素？

> ID：635948
> 
> 赞同：20
> 
> 时间：2009-03-11T19:14:55.487
> 
> 标签：c#, javascript, ajax, browser

我正在编写一个应用程序，它使用 WebBrowser 控件来查看可以通过 AJAX 添加新内容/元素的 Web 内容。我似乎无法以任何我尝试过的方式了解新元素。BrowserCtl.DocumentText 没有最新的页面，当然它也不在“查看源代码”中。

有没有办法使用这个控件来获取这些新数据？:(请帮忙。谢谢！

IE：

```
Browser.Navigate("www.somewebpagewithAJAX.com");
//Code that waits for browser to finish...
...
//WebBrowser control has loaded content and AJAX has loaded new content
// (is visible at runtime on form) but can't see them in Browser.Document.All
// or Browser.DocumentText :( 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-19T08:57:32.150

我为我解决了这个问题。

`onPropertyChanged`关键是，为通过 ajax 调用填充的 div 元素的事件附加一个处理程序。

```
HtmlElement target = webBrowser.Document.GetElementById("div_populated_by_ajax");

if (target != null)
{
      target.AttachEventHandler("onpropertychange", handler);
} 
```

最后，

```
private void handler(Object sender, EventArgs e)
{
      HtmlElement div = webBrowser.Document.GetElementById("div_populated_by_ajax");
      if (div == null) return;
      String contentLoaded = div.InnerHtml; // get the content loaded via ajax
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-03-29T19:04:07.020

```
using System;
using System.Windows.Forms;

namespace WebBrowserDemo
{
    class Program
    {
        public const string TestUrl = "http://www.w3schools.com/Ajax/tryit_view.asp?filename=tryajax_first";

        [STAThread]
        static void Main(string[] args)
        {
            WebBrowser wb = new WebBrowser();
            wb.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(wb_DocumentCompleted);
            wb.Navigate(TestUrl);

            while (wb.ReadyState != WebBrowserReadyState.Complete)
            {
                Application.DoEvents();
            }

            Console.WriteLine("\nPress any key to continue...");
            Console.ReadKey(true);
        }

        static void wb_DocumentCompleted(object sender, WebBrowserDocumentCompletedEventArgs e)
        {
            WebBrowser wb = (WebBrowser)sender;

            HtmlElement document = wb.Document.GetElementsByTagName("html")[0];
            HtmlElement button = wb.Document.GetElementsByTagName("button")[0];

            Console.WriteLine(document.OuterHtml + "\n");

            button.InvokeMember("Click");

            Console.WriteLine(document.OuterHtml);           
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-27T21:25:37.087

您将需要为此使用 DOM。将 WebBrowser.Document.DomDocument 转换为 IHTMLDocument?。您将不得不导入一些 COM 接口或 Microsoft.mshtml 程序集。

查看[http://msdn.microsoft.com/en-us/library/aa752641(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa752641(VS.85).aspx)了解更多详情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-29T23:21:47.070

我假设由于您正在读取从 Ajax 请求生成的内容，因此您需要用户将应用程序推进到加载相关数据的点，此时您运行代码来读取数据。

如果不是这种情况，您将需要自动化此过程，生成构建您有兴趣阅读的 DOM 节点的点击事件。我通常使用 WebBrowser 控件执行此操作，并且倾向于在 Javascript 中编写该层功能并使用 .InvokeScript() 调用它。另一种方法是找到从 C# 触发 Ajax 功能的节点并手动触发它们的点击事件：

```
HtmlElement content = webMain.Document.GetElementById("content");
content.RaiseEvent("onclick"); 
```

在上面的脚本中要注意的一个重要方面是，如果您接受并解决 HtmlElement 对象类型的限制，您可以在 C# 中天真地与 DOM 节点交互。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-17T21:55:56.547

Is the information not in the WebBrowser.DocumentText? [http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.documenttext.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.documenttext.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-26T00:50:46.663

运行 javascript 来为元素添加标题并在新窗口中显示它怎么样？

我还没有测试过，但它可能会起作用。

```
(WebBrowser)w.Navigate("javascript:GetElementById('div').innerHtml;", true); 
```

在新窗口中打开返回的 true 属性。（或者一个框架，或者你可以找到更好的方法）

要捕获 NewWindow 事件，您需要引用 Windows/System32 文件夹中的 SHDocVw.dll。然后你可以像这样投射你的 WebBrowser 控件：

```
SHDocVw.WebBrowser_V1 browser = (SHDocVw.WebBrowser_V1)(WebBrowser)w.ActiveXInstance; 
```

您可以在存储响应后立即关闭它。祝你好运，让我知道情况如何。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-13T19:37:44.640

你控制网页吗？

如果是这样，这里有一篇博客文章解释了如何： http: [//www.palladiumconsulting.com/blog/sebastian/2007/04/ultimate-intranet-toy.html](http://www.palladiumconsulting.com/blog/sebastian/2007/04/ultimate-intranet-toy.html)

如果没有，可能有一个解决方案，但我不能帮助你，对不起。

# winforms - 如何在 WinForms 中制作无尽的进度条？

> ID：635958
> 
> 赞同：11
> 
> 时间：2009-03-11T19:18:27.413
> 
> 标签：winforms, .net-3.5

我不知道一个动作需要多长时间，我想在对话框中向用户显示一个进度条。我试过使用 System.Windows.Forms.ProgressBar 但它似乎不支持它。

我想要的一个示例是 Windows 在 Internet 上寻找新驱动程序时向您显示的进度条。进度条上只有三个或四个“条”来回选取框样式。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-11T19:21:29.217

System.Windows.Forms.ProgressBar 有一个名为`Style`. 设置`Style`为`Marquee`将达到您想要的效果。

**编辑：** [Divo](https://stackoverflow.com/users/40347/divo)指出 Marquee [Style](http://msdn.microsoft.com/en-us/library/system.windows.forms.progressbar.style.aspx)仅适用于

> Windows XP 家庭版、Windows XP 专业 x64 版、Windows Server 2003

注释提供了更多信息，表明只要您使用 .NET 2.0 或更高版本，这似乎在任何地方都可以使用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-11T19:22:25.127

您是否尝试过设置to的`[Style](http://msdn.microsoft.com/en-us/library/system.windows.forms.progressbar.style.aspx)`属性？`System.Windows.Forms.ProgressBar``Marquee`

但是，令人惊讶的是，此属性仅在以下平台上可用（根据[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.progressbar.style.aspx)）：

> Windows XP 家庭版、Windows XP 专业 x64 版、Windows Server 2003

可能是文档尚未更新到 Vista。有人知道Vista的限制吗？

编辑：正如在另一条评论中发布的那样，关于支持的平台，文档似乎是错误的。应该在 Vista 和 Windows 7 上工作。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-11T19:21:08.810

只需使用动画 gif :)

您可以在这里制作自己的： [http ://www.ajaxload.info/](http://www.ajaxload.info/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-30T19:52:56.140

这对我有用。我为您创建了一个不确定的进度条。将自定义控件添加到您的项目/表单并插入以下代码：

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;

namespace AnimatedCustomControls
{
  sealed class IndeterminateProgressbar : Control
  {
    private readonly List<int> positions = new List<int>();
    private readonly Timer tmrAnimation = new Timer {Interval = 5, Enabled = false};
    private readonly Timer tmrAddPosition = new Timer {Interval = 500, Enabled = true};

    public Color ProgressColor { get; set; }
    public Color InactiveColor { get; set; }

    public IndeterminateProgressbar()
    {
        DoubleBuffered = true;
        SetStyle(ControlStyles.OptimizedDoubleBuffer | ControlStyles.AllPaintingInWmPaint, true);
        ProgressColor = Color.FromArgb(40, 190, 245);
        InactiveColor = Color.FromArgb(40, 40, 40);
        tmrAnimation.Tick += tmrAnimation_Tick;
        tmrAddPosition.Tick += tmrAddPosition_Tick;
        if (!DesignMode) tmrAnimation.Start();
    }

    void tmrAddPosition_Tick(object sender, EventArgs e)
    {
        positions.Add(1);
    }

    void tmrAnimation_Tick(object sender, EventArgs e)
    {
        if (DesignMode) tmrAnimation.Stop();
        for (int i = 0; i < positions.Count; i++)
        {
            positions[i] += 2 + Math.Abs(positions[i]) / 50;
            if (positions[i] > Width) positions.RemoveAt(i);
        }
        Invalidate();
    }

    protected override void OnEnabledChanged(EventArgs e)
    {
        base.OnEnabledChanged(e);
        if (Enabled)
        {
            positions.Clear();
            positions.AddRange(new[] { Width / 10, Width / 3, Width / 2, (int)(Width * 0.7) });
        }
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        if (Enabled)
        {
            e.Graphics.Clear(BackColor);
            foreach (int i in positions)
            {
                e.Graphics.DrawLine(new Pen(Brushes.Black, 4f), i, 0, i, Height);
            }
        }
        else e.Graphics.Clear(InactiveColor);

        base.OnPaint(e);
    }
} 
```

}

然后，您应该构建您的解决方案，当您返回设计器时，新控件应该在您的工具箱中。将其拖入您的表单中，设置最大值和最小值，仅此而已。

我创建了一个示例程序，让您知道它是如何使用的：

```
 private void Form1_Load(object sender, EventArgs e)
    {
        indeterminateProgressbar1.BackColor = Color.FromArgb(40, 190, 245); //it's an nice color ;)
        indeterminateProgressbar1.Size = new Size(400, 4); //make it small in the height looks better
        indeterminateProgressbar1.Visible = true;
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-17T05:36:08.300

我发现 Chris Lawl 的解决方案是最好的、非常好的和干净的解决方案，它只包含一个 gif [http://www.ajaxload.info/](http://www.ajaxload.info/)并且没有创建永无止境的进度条的混乱。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T19:22:47.247

可能有更好的方法，但一种方法是在结束时将 Value 设置回 0（假设您的任务未完成）

# sharepoint - 使用个性化 Web 部件视图 WSS 3.0？

> ID：635966
> 
> 赞同：0
> 
> 时间：2009-03-11T19:19:50.750
> 
> 标签：sharepoint, wss

我只想为自己使用“资源管理器视图”。我可以为 Web 部件创建默认视图，但是当我从 WSS 3.0 中选择“个性化此页面”功能时，我似乎看不到视图选择器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T18:18:12.637

对于 List View Webparts 视图选择器，WebPartStorage 设置为 Shared 而不是 User。因此，该属性在个性化模式下不可用。

# asp.net - 尽管有值，但回发时输入为空

> ID：635980
> 
> 赞同：1
> 
> 时间：2009-03-11T19:22:56.233
> 
> 标签：asp.net, telerik

我正在使用带有 UserControl 编辑表单的 Telerik RadGrid。当 InsertCommand 事件触发时，我得到了用户控件，并在上面找到了编辑控件，但是那里的 Text 属性都是 string.Empty。我怀疑这与 ViewState 有关，但我不知道从哪里开始寻找。

```
protected void jobGrid_InsertCommand(object source, GridCommandEventArgs e)
{
    var editControl = e.Item.FindControl(GridEditFormItem.EditFormUserControlID) as JobEditControl;
    SqlJobProvider.InsertJob(GetFieldValues(editControl));
}

private Dictionary<string, object> GetFieldValues(UserControl editControl)
{
    string tb = (editControl.FindControl("aspText") as TextBox).Text; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-11T20:08:32.847

我相信您的控件是空的，因为您在插入事件之前重新绑定了网格。为避免此类行为，我建议您使用 NeedDataSource 事件填充 RadGrid。每当网格需要重新绑定时就会触发它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T19:28:09.480

首先检查您的 Page_Load 并确保您没有在每次点击页面时重置那里的所有内容。如果您没有!IsPostBack，您可能是。这是您发布时未获得价值的最常见原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-14T07:59:26.437

使用： Private Sub RadGrid1_InsertCommand(ByVal source As Object, ByVal e As Telerik.Web.UI.GridCommandEventArgs) Handles RadGrid1.InsertCommand Dim insertedItem As GridEditableItem = e.Item.OwnerTableView.GetInsertItem()

```
 Dim _userControl As UserControl = CType(insertedItem.FindControl(GridEditFormItem.EditFormUserControlID), UserControl) 
```

... [http://www.telerik.com/help/aspnet/grid/grdinsertingvaluesusercontrolformtemplate.html](http://www.telerik.com/help/aspnet/grid/grdinsertingvaluesusercontrolformtemplate.html)

# delphi - 在 Delphi 中超出范围的对象会发生什么？

> ID：635982
> 
> 赞同：5
> 
> 时间：2009-03-11T19:23:21.613
> 
> 标签：delphi, scope

当在函数中创建的对象并且函数完成时，如果对象没有被显式销毁，会发生什么？

所有变量在超出范围时都需要销毁，还是在超出范围时得到处理？

例如，调用 custom_function 后 locallist 会发生什么？

```
function TForm1.custom_function(string: test_string): boolean;
var locallist: TStringList;
begin
  locallist := TStringList.Create;
  // do a bunch of stuff here, but don't destroy locallist
  return true;
end; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-11T20:07:05.957

你会得到一个内存泄漏。

正确的模式是

```
myObject := TObject.Create;
try
  //do stuff
finally
  myObject.Free;
end; 
```

此外，如果您需要稍后测试对象是否已被释放，请使用 FreeAndNil(myObject)。它也会将变量设置为 nil，因此您可以稍后对其进行测试。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-11T21:06:53.050

正如其他海报所指出的，这些对象需要明确释放。这通常是通过使用 try..finally 块手动完成的，正如 Ray 所演示的。但是，您应该注意一些例外情况。

组件（TComponent 后代）将 Owner 参数传递给它们的构造函数。如果所有者不是**nil**，那么所有者组件将获得新组件的所有权并在它被释放时释放它。这就是为什么您不必清理自己的表单的原因；它们连接到 Application 对象，该对象知道如何在程序完成时释放*自己。*但是，如果您在运行时创建组件，则需要为其分配所有者或将**nil**传递给构造函数，然后自己释放它。 **不要通过释放具有所有者的组件来混合两者。** 在某些情况下，这可能会导致双重自由状态。

如果您将实现引用计数的接口对象（主要是 TInterfacedObject 后代）专门称为接口（而不是对象），则引用计数机制将释放它们。当对它们的最后一个接口引用被删除时，它们会自动释放。如果您已将 TInterfacedObject 分配给接口引用，请不要手动释放它。这将引发异常。此外，请注意并非所有具有接口的对象都实现引用计数。大多数只是从 TInterfacedObject 继承的那些。

创建一个对象，使用 try..finally 块，然后释放它并不总是可行的。有时这对您正在做的事情不起作用，特别是如果您将对象分配给某种列表（并制作大量列表）。在这种情况下，使用 TObjectList 是个好主意（或者更好的是，如果您有 D2009，一个 TObjectList)，并且 OwnsObjects 属性设置为**true**。这会导致列表成为其中对象的所有者，并在释放时释放它们，就像组件一样。同样，如果对象由对象列表拥有，则不要手动释放对象。

动态数组（包括字符串）由具有引用计数系统的编译器管理，大多数其他类型的变量在堆栈上分配。你永远不必担心手动释放对象以外的任何东西，除非你在玩指针。

这可能听起来很复杂，但你很快就会习惯的。请记住，每个对象都属于以下三件事之一：另一个对象、接口引用计数系统或您的代码，并且所有者应该在不再需要时释放其所有对象。任何东西都不应该试图释放属于其他东西的东西。（你不能偷窃。）记住这些指导方针，你最终会得到良好的内存管理。您还可以在 DPR 的主例程中设置“ReportMemoryLeaksOnShutdown := true”以获得更多帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-11T19:27:56.830

它成为泄漏的内存。

您通常应该围绕这样的分配：

```
locallist := TStringList.Create;
try
     // work with locallist here
  finally
     locallist.Free;
  end; 
```

Delphi 中唯一一种当它们退出范围时自杀的引用是接口引用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T19:28:08.873

内存没有回收，抱歉。您需要使用 locallist.Free 显式释放该对象；

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-11T19:28:27.170

这将导致[内存泄漏](http://en.wikipedia.org/wiki/Memory_leak)，只会在应用程序结束时销毁。要检测这些，您可以使用像[FastMM](http://sourceforge.net/projects/fastmm/)这样的内存管理器。

请注意，您可以使用 Destroy 或 Free 方法销毁对象。如果对象为零，第一个将给出错误，后者不会 - 它等于

```
if Assigned(Object) then Object.Destroy; 
```

# perl - 确定日期范围内的日期的好方法是什么？

> ID：635993
> 
> 赞同：4
> 
> 时间：2009-03-11T19:28:22.163
> 
> 标签：perl, data-structures, datetime

什么是返回开始日期和结束日期之间所有有效日历日期的好的 Perl 模块（或好的方法）？

例如，如果我将 1/29/2009 作为开始日期，将 2/3/2009 作为结束日期，那么我希望它返回一个包含 1/30/2009、1/31/2009、2/1 的数组/2009 年和 2009 年 2 月 2 日。一定有一个好的 Perl 模块已经做到了这一点，并考虑了闰年、几个月，但我找不到它。

感谢您的建议！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-11T19:31:18.943

[DateTime](http://search.cpan.org/dist/DateTime/)，我已经用过很多次了，它几乎可以做任何你能想到的关于日期的事情。它处理闰年、闰秒、无效日期/时间，它可以输出任何格式的日期，它可以比较、加、减等...

唯一的问题是它可能是矫枉过正。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-11T21:10:07.303

[这是使用DateTime](http://search.cpan.org/dist/DateTime)的示例：

```
use strict;
use warnings;

use DateTime;

my $d1 = DateTime->new( month => 1, day => 29, year => 2009);
my $d2 = DateTime->new( month => 2, day => 3,  year => 2009);

while ($d1 <= $d2) {
  print $d1->strftime("%m/%d/%Y"),"\n";
  $d1->add(days => 1);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T20:31:49.343

这是一个刺。它需要[`Date::Simple`](http://search.cpan.org/~izut/Date-Simple-3.03/lib/Date/Simple.pm)和[`Date::Range`](http://search.cpan.org/~tmtm/Date-Range-1.40/lib/Date/Range.pm)：

```
#!/usr/bin/env perl
use strict;
use warnings;
use Date::Simple;
use Date::Range;

my $d1 = Date::Simple->new('2009-03-02');
my $d2 = Date::Simple->new('2009-03-07');

my $range = Date::Range->new( $d1, $d2 );

for my $date ($range->dates) {
  print $date->format("%m/%d/%Y"), "\n" # Fixed format
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-11T19:30:11.083

包装[日期::DateCalc](http://guest.engelschall.com/~sb/download/pkg/DateCalc-3.2.README)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-11T19:47:02.010

[Date::Manip](http://search.cpan.org/~sbeck/Date-Manip-5.54/lib/Date/Manip.pod)似乎是 Perl 中的规范日期模块。它有一个奇怪的 API，但它可以工作。下面是一个使用 ParseRecur 函数来做你想做的事情的例子：

```
#!/usr/bin/perl
use warnings;
use strict;

use Date::Manip;
use Data::Dumper;

my ($start, $end) = qw(2009-01-29 2009-02-03);

# Exclude start date
$start = DateCalc($start, "+1 day");

# y:m:w:d:h:m:s
my @dates = ParseRecur('0:0:0:1:0:0:0', $start, $start, $end);

for my $date (@dates) {
    print UnixDate($date, "%Y-%m-%d\n");
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T20:56:47.973

由于[POSIX::mktime](http://search.cpan.org/~nwclark/perl-5.8.9/ext/POSIX/POSIX.pod#mktime)的强大功能，您可以执行以下操作：

```
use POSIX qw<mktime strftime>;

my ( $month, $day, $year )  = ( 8, 16, 2008 );
my $end_date   = mktime( 0, 0, 0, 1, 2 - 1, 2009 - 1900 );
while ( 1 ) { 
    my $date = mktime( 0, 0, 0, $day++, $month - 1, $year - 1900 );
    push @date_range, strftime( '%x', localtime $date );
    last if $date >= $end_date;
} 
```

有了`mktime( 0, 0, 0, 500, 0, 108 )`意义。但是`mktime( 0, 0, 0, 0, 2, x )`对于任何一年的二月最后一个日期也是如此。

# php - 从 html 字符串中去除广告

> ID：635995
> 
> 赞同：0
> 
> 时间：2009-03-11T19:29:02.537
> 
> 标签：php, regex

我有一个包含 html 字符串的变量。这个字符串有这个特定的代码

```
<a href="http://www.pheedo.com/click.phdo?s=xxxxxxxx&amp;p=1"><img border="0" src="http://www.pheedo.com/img.phdo?s=xxxxxxxxxx&amp;p=1" style="border: 0pt none ;" alt=""/></a> 
```

使用正则表达式，我该如何删除它。基本上是在寻找 pheedo.com 域，并去掉链接和图像标签。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T19:51:44.323

这是一个反答案：不要使用正则表达式操作任意 HTML！HTML 是一个非常复杂的规范，正确解析它可能是一场噩梦。

使用[phpQuery](http://code.google.com/p/phpquery/)之类的库或内置的[DOMDocument](http://ca2.php.net/dom)，它们知道如何为您处理 HTML 的所有怪异之处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-11T19:40:34.507

对于更通用的方法，（文本/html广告，同一域上的不同网址等...）您可以尝试

```
<a.*href="[^"]*pheedo.com[^"]*".*</a> 
```

只需替换您找到的任何匹配项。请记住，如果有孩子`<a/>`，您将遇到问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-11T19:35:04.723

这应该与标签匹配（用 PHP 编写）：

```
$regex = "#<a href=\"http:\/\/www\.pheedo\.com[^>]+><img[^>]+><\/a>#" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T19:52:32.357

```
 $text = '<a href="http://www.pheedo.com/click.phdo?s=xxxxxxxx&amp;p=1"><img border="0" src="http://www.pheedo.com/img.phdo?s=xxxxxxxxxx&amp;p=1" style="border: 0pt none ;" alt=""/></a>';
    $reg = "/href=\"(http:\/\/\S+?)\"/i";
    preg_match_all($reg, $text, $matches, PREG_PATTERN_ORDER);

    // $matches[1] should now hold all the domain name "www.pheeedo.com" 
```

我这样做是为了您可以将页面传递给 preg 并在数组中获取所有匹配结果.../

如果你有兴趣，我做了一些类似的东西来制作这个图像搜索工具。

[http://www.iansimpsonarchitects.com/fraser](http://www.iansimpsonarchitects.com/fraser)

您可以从页面上的链接查看完整的 PHP 源代码。

F。

# pdf - 如何使用 XFDF 向 PDF 动态添加注释

> ID：635996
> 
> 赞同：0
> 
> 时间：2009-03-11T19:29:07.327
> 
> 标签：pdf

我正在向用户发送 xfdf 数据以在我的网站上预填充 PDF。

但我也想添加针对不同情况可能不同的评论。注释是为了帮助用户通过提供一些他们可以用来粘贴到字段中的数据来填充一些字段。

我使用了现有 pdf 中的注释，将其导出为 xfdf 作为模板，但问题是当我使用它创建 xfdf 时，会弹出来自 Acrobat Reader 的安全消息说“无法导入注释，因为文档的权限确实不允许评论导入操作。” ...但是文档没有安全限制。

这发生在其他 PC 上，但不是我创建它的那台……但那台有 Acrobat Pro。

那么，动态创建评论的正确方法是什么？

***好的，解决了.... PDF 必须启用用户权限，Acrobat Reader 才能看到评论。请参阅[http://help.adobe.com/en_US/Acrobat/8.0/Professional/help.html?content=WS58a04a822e3e50102bd615109794195ff-7e0d.html](http://help.adobe.com/en_US/Acrobat/8.0/Professional/help.html?content=WS58a04a822e3e50102bd615109794195ff-7e0d.html)***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-15T04:12:48.740

好的，解决了.... PDF 必须启用用户权限，Acrobat Reader 才能看到评论。请参阅[http://help.adobe.com/en_US/Acrobat/8.0/Professional/help.html?content=WS58a04a822e3e50102bd615109794195ff-7e0d.html](http://help.adobe.com/en_US/Acrobat/8.0/Professional/help.html?content=WS58a04a822e3e50102bd615109794195ff-7e0d.html)

# apache-flex - 从 swc 创建优化的 swf

> ID：635998
> 
> 赞同：0
> 
> 时间：2009-03-11T19:30:09.303
> 
> 标签：apache-flex, flash, actionscript-3

我创建了一个 swc 库。打开这个swc，我可以解压library.swf。

将 library.swf 放在我的服务器上并将其用作 RSL，一切正常。

如果我针对 library.swf 运行[优化器](http://livedocs.adobe.com/flex/3/html/help.html?content=rsl_04.html)，则生成的 library-optimized.swf 不能用作 RSL。我明白了

```
Flex Error #1001: Digest mismatch with RSL
...
Redeploy the matching RSL or relink your application with the matching library. 
```

在日志中。

关于创建工作优化的 rsl swf，我有什么遗漏吗？我试过链接[我能找到](http://livedocs.adobe.com/flex/3/html/help.html?content=metadata_3.html)的每一条元数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-11T19:50:13.343

问题是文档跳过了使用摘要工具的步骤。

有关完整详细信息，请参阅[FLEXDOCS-432](http://bugs.adobe.com/jira/browse/FLEXDOCS-432)。******`**