# StackOverflow 问答 10586000-10586999

# actionscript-3 - 在动作脚本 3 中向上转换

> ID：10586001
> 
> 赞同：0
> 
> 时间：2012-05-14T15:06:55.627
> 
> 标签：actionscript-3, flash, casting

嗨，我有一个扩展 Sprite 的自定义类，它控制舞台上的定位。我希望管理舞台的类能够获取添加到舞台的任何精灵并将其转换为自定义类类型，即包装它，以便管理类可以相应地定位本机精灵。有谁知道是否可以执行以下操作

```
var managed:managedSprite = new managedSprite(nativeSprite); 
```

managedSprite 在哪里扩展了 Sprite 类？如果可能的话，我不想合成对 sprite 的引用，以防止与已扩展 Sprite 的 managedSprite 相关的开销。

无论如何使用反射（也许是 commons.reflection 库）？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:16:17.923

您可能想要使用“装饰器”模式。

乍一看似乎有点复杂，但它很容易理解和使用。 [http://www.as3dp.com/2009/04/actionscript-30-easy-and-practical-decorator-design-pattern/](http://www.as3dp.com/2009/04/actionscript-30-easy-and-practical-decorator-design-pattern/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:25:24.663

您可以将事件侦听器添加到舞台并用于`Event.ADDED`获取对添加到显示列表中任何位置的任何显示对象的引用。

如果添加的项目是`ManagedSprite`（顺便说一句，约定是以大写字母开头的类名），则只需键入 cast：

```
stage.addEventListener (Event.ADDED, onAdded); 

function onAdded( ev:Event ):void {
    if (ev.target is ManagedSprite) {
        var managed:ManagedSprite = ManagedSprite( ev.target );
        doStuffWith( managed );
    }
} 
```

**编辑**

我想我只是理解了您的问题：您不是在尝试进行实际的类型转换-这需要您已经设置了类层次结构，即您必须已经扩展了 ManagedSprite 类-但是要添加功能运行！

我强烈劝阻你不要尝试做深拷贝等——这会严重影响性能，这取决于你要添加多少精灵，而且你将不再有你的编译器来帮助你防止错误。

相反，看看你是否不赞成组合而不是继承：为精灵创建一种“代理”类，我们称之为它`ManagedSpriteProxy`，它实现了你在 ManagedSprite 上调用的所有方法，但将所有实际操作转发给它的 `managedSprite ' 财产。然后使用我上面概述的事件处理程序来创建代理对象并附加相应的精灵：

```
public class ManagedSpriteProxy {
    private var _managedSprite:Sprite;

    public function ManagedSpriteProxy( managedSprite:Sprite ) {
        this.managedSprite = managedSprite;
    }

    public function get managedSprite():Sprite {
        return _managedSprite;
    }

    public function set managedSprite( managedSprite : Sprite ):void {
        _managedSprite = managedSprite;
        setUpAnyHandlersOrWhatever();
    }

    private function setUpAnyHandlersOrWhatever():void {
        // Many wonderful things happening
    }

    // Many more wonderful things happening via public API
}

// somewhere else

public class SpriteManager {
    private var _managedSprites:Array = [];

    public function SpriteManager() {
        addEventListener( Event.ADDED_TO_STAGE, onAddedToStage );
    }

    private function onAddedToStage( ev:Event ):void {
        removeEventListener( Event.ADDED_TO_STAGE );
        stage.addEventListener( Event.ADDED, onAdded );
    }

    private function onAdded( ev:Event ):void {
        if( ev.target is Sprite ) {
            addWithProxy( ev.target as Sprite );
        }
    }

    private function addWithProxy( sprite:Sprite ) : void {
        var proxy:ManagedSpriteProxy = new ManagedSpriteProxy( sprite );
        _managedSprites.push( proxy );
    }

    // Insert here whatever methods used to manage the sprites, 
    // all of them call the proxies instead of the sprites!
} 
```

# c - 尝试 C 中的 catch 语句

> ID：10586003
> 
> 赞同：129
> 
> 时间：2012-05-14T15:07:03.130
> 
> 标签：c

我今天在想其他语言中存在的 try/catch 块。谷歌了一段时间，但没有结果。据我所知，C 中没有 try/catch 这样的东西。但是，有没有办法“模拟”它们？
当然，有断言和其他技巧，但没有像 try/catch 这样的技巧，它们也可以捕获引发的异常。谢谢

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-05-14T15:12:03.250

C 本身不支持异常，但您可以使用`setjmp`和`longjmp`调用在一定程度上模拟它们。

```
static jmp_buf s_jumpBuffer;

void Example() { 
  if (setjmp(s_jumpBuffer)) {
    // The longjmp was executed and returned control here
    printf("Exception happened here\n");
  } else {
    // Normal code execution starts here
    Test();
  }
}

void Test() {
  // Rough equivalent of `throw`
  longjmp(s_jumpBuffer, 42);
} 
```

这个网站有一个很好的教程，介绍如何使用`setjmp`和模拟异常`longjmp`

*   [http://www.di.unipi.it/~nids/docs/longjump_try_trow_catch.html](https://web.archive.org/web/20091104065428/http://www.di.unipi.it/~nids/docs/longjump_try_trow_catch.html)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-05-14T15:08:14.517

您可以在 C 中使用**[goto](http://www.roseindia.net/c-tutorials/c-goto-statement.shtml)**来处理类似的错误处理情况。
这是您可以在 C 中获得的最接近异常的等价物。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2016-09-06T16:26:29.943

好的，我忍不住回复了这个。首先让我说我认为在 C 中模拟它不是一个好主意，因为它对于 C 来说确实是一个陌生的概念。

我们可以~~滥用~~预处理器和本地堆栈变量来使用有限版本的 C++ try/throw/catch。

**版本 1（本地范围抛出）**

```
#include <stdbool.h>

#define try bool __HadError=false;
#define catch(x) ExitJmp:if(__HadError)
#define throw(x) {__HadError=true;goto ExitJmp;} 
```

版本 1 仅是本地抛出（不能离开函数的范围）。它确实依赖于 C99 在代码中声明变量的能力（如果 try 是函数中的第一件事，它应该在 C89 中工作）。

这个函数只是创建一个本地变量，所以它知道是否有错误并使用 goto 跳转到 catch 块。

例如：

```
#include <stdio.h>
#include <stdbool.h>

#define try bool __HadError=false;
#define catch(x) ExitJmp:if(__HadError)
#define throw(x) {__HadError=true;goto ExitJmp;}

int main(void)
{
    try
    {
        printf("One\n");
        throw();
        printf("Two\n");
    }
    catch(...)
    {
        printf("Error\n");
    }
    return 0;
} 
```

这适用于：

```
int main(void)
{
    bool HadError=false;
    {
        printf("One\n");
        {
            HadError=true;
            goto ExitJmp;
        }
        printf("Two\n");
    }
ExitJmp:
    if(HadError)
    {
        printf("Error\n");
    }
    return 0;
} 
```

**版本 2（范围跳跃）**

```
#include <stdbool.h>
#include <setjmp.h>

jmp_buf *g__ActiveBuf;

#define try jmp_buf __LocalJmpBuff;jmp_buf *__OldActiveBuf=g__ActiveBuf;bool __WasThrown=false;g__ActiveBuf=&__LocalJmpBuff;if(setjmp(__LocalJmpBuff)){__WasThrown=true;}else
#define catch(x) g__ActiveBuf=__OldActiveBuf;if(__WasThrown)
#define throw(x) longjmp(*g__ActiveBuf,1); 
```

版本 2 要复杂得多，但基本上以相同的方式工作。它使用从当前函数到 try 块的长跳转。try 块然后使用 if/else 将代码块跳过到 catch 块，该块检查局部变量以查看它是否应该捕获。

该示例再次扩展：

```
jmp_buf *g_ActiveBuf;

int main(void)
{
    jmp_buf LocalJmpBuff;
    jmp_buf *OldActiveBuf=g_ActiveBuf;
    bool WasThrown=false;
    g_ActiveBuf=&LocalJmpBuff;

    if(setjmp(LocalJmpBuff))
    {
        WasThrown=true;
    }
    else
    {
        printf("One\n");
        longjmp(*g_ActiveBuf,1);
        printf("Two\n");
    }
    g_ActiveBuf=OldActiveBuf;
    if(WasThrown)
    {
        printf("Error\n");
    }
    return 0;
} 
```

这使用全局指针，因此 longjmp() 知道上次运行的尝试。我们正在滥用堆栈~~，~~因此子函数也可以有一个 try/catch 块。

使用此代码有许多缺点（但这是一种有趣的心理练习）：

*   它不会释放分配的内存，因为没有调用解构函数。
*   一个范围内不能有超过 1 个 try/catch（无嵌套）
*   您实际上不能像 C++ 中那样抛出异常或其他数据
*   根本不是线程安全的
*   您正在将其他程序员设置为失败，因为他们可能不会注意到黑客并尝试像 C++ try/catch 块一样使用它们。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-05-14T15:10:01.730

~~在 C99 中，~~您可以将[`setjmp`](http://pubs.opengroup.org/onlinepubs/7908799/xsh/setjmp.html)/[`longjmp`](http://pubs.opengroup.org/onlinepubs/7908799/xsh/longjmp.html)用于非本地控制流。

在单个范围内，在存在多个资源分配和多个出口的情况下，C 的通用结构化编码模式使用`goto`，就像[在这个例子](https://stackoverflow.com/a/10464368/596781)中一样。这类似于 C++ 如何在后台实现自动对象的析构函数调用，如果您坚持这一点，即使在复杂的函数中也应该允许您在一定程度上保持清洁。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-11-20T00:31:43.357

虽然其他一些答案已经涵盖了使用`setjmp`and的简单案例`longjmp`，但在实际应用程序中，有两个真正重要的问题。

1.  try/catch 块的嵌套。为您使用单个全局变量`jmp_buf`将使这些不起作用。
2.  穿线。在这种情况下，一个单一的全局变量`jmp_buf`会给你带来各种痛苦。

解决这些问题的方法是维护一个线程本地堆栈，`jmp_buf`该堆栈会随着您的使用而更新。（我认为这是 lua 内部使用的）。

所以而不是这个（来自JaredPar的真棒答案）

```
static jmp_buf s_jumpBuffer;

void Example() { 
  if (setjmp(s_jumpBuffer)) {
    // The longjmp was executed and returned control here
    printf("Exception happened\n");
  } else {
    // Normal code execution starts here
    Test();
  }
}

void Test() {
  // Rough equivalent of `throw`
  longjump(s_jumpBuffer, 42);
} 
```

你会使用类似的东西：

```
#define MAX_EXCEPTION_DEPTH 10;
struct exception_state {
  jmp_buf s_jumpBuffer[MAX_EXCEPTION_DEPTH];
  int current_depth;
};

int try_point(struct exception_state * state) {
  if(current_depth==MAX_EXCEPTION_DEPTH) {
     abort();
  }
  int ok = setjmp(state->jumpBuffer[state->current_depth]);
  if(ok) {
    state->current_depth++;
  } else {
    //We've had an exception update the stack.
    state->current_depth--;
  }
  return ok;
}

void throw_exception(struct exception_state * state) {
  longjump(state->current_depth-1,1);
}

void catch_point(struct exception_state * state) {
    state->current_depth--;
}

void end_try_point(struct exception_state * state) {
    state->current_depth--;
}

__thread struct exception_state g_exception_state; 

void Example() { 
  if (try_point(&g_exception_state)) {
    catch_point(&g_exception_state);
    printf("Exception happened\n");
  } else {
    // Normal code execution starts here
    Test();
    end_try_point(&g_exception_state);
  }
}

void Test() {
  // Rough equivalent of `throw`
  throw_exception(g_exception_state);
} 
```

同样，一个更现实的版本将包括一些将错误信息存储到的方法`exception_state`，更好地处理`MAX_EXCEPTION_DEPTH`（可能使用 realloc 来增加缓冲区，或类似的东西）。

免责声明：上面的代码是在没有任何测试的情况下编写的。这纯粹是为了让您了解如何构建事物。不同的系统和不同的编译器需要以不同的方式实现线程本地存储。该代码可能同时包含编译错误和逻辑错误 - 因此，尽管您可以随意使用它，但请在使用之前对其进行测试；）

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-07-04T18:04:27.940

这是在 C 中进行错误处理的另一种方法，它比使用 setjmp/longjmp 更高效。不幸的是，它不适用于 MSVC，但如果只使用 GCC/Clang 是一个选项，那么您可能会考虑它。具体来说，它使用“标签作为值”扩展，它允许您获取标签的地址，将其存储在一个值中并无条件跳转到它。我将使用一个例子来展示它：

```
GameEngine *CreateGameEngine(GameEngineParams const *params)
{
    /* Declare an error handler variable. This will hold the address
       to jump to if an error occurs to cleanup pending resources.
       Initialize it to the err label which simply returns an
       error value (NULL in this example). The && operator resolves to
       the address of the label err */
    void *eh = &&err;

    /* Try the allocation */
    GameEngine *engine = malloc(sizeof *engine);
    if (!engine)
        goto *eh; /* this is essentially your "throw" */

    /* Now make sure that if we throw from this point on, the memory
       gets deallocated. As a convention you could name the label "undo_"
       followed by the operation to rollback. */
    eh = &&undo_malloc;

    /* Now carry on with the initialization. */
    engine->window = OpenWindow(...);
    if (!engine->window)
        goto *eh;   /* The neat trick about using approach is that you don't
                       need to remember what "undo" label to go to in code.
                       Simply go to *eh. */

    eh = &&undo_window_open;

    /* etc */

    /* Everything went well, just return the device. */
    return device;

    /* After the return, insert your cleanup code in reverse order. */
undo_window_open: CloseWindow(engine->window);
undo_malloc: free(engine);
err: return NULL;
} 
```

如果您愿意，您可以在定义中重构​​通用代码，从而有效地实现您自己的错误处理系统。

```
/* Put at the beginning of a function that may fail. */
#define declthrows void *_eh = &&err

/* Cleans up resources and returns error result. */
#define throw goto *_eh

/* Sets a new undo checkpoint. */
#define undo(label) _eh = &&undo_##label

/* Throws if [condition] evaluates to false. */
#define check(condition) if (!(condition)) throw

/* Throws if [condition] evaluates to false. Then sets a new undo checkpoint. */
#define checkpoint(label, condition) { check(condition); undo(label); } 
```

那么例子就变成了

```
GameEngine *CreateGameEngine(GameEngineParams const *params)
{
    declthrows;

    /* Try the allocation */
    GameEngine *engine = malloc(sizeof *engine);
    checkpoint(malloc, engine);

    /* Now carry on with the initialization. */
    engine->window = OpenWindow(...);
    checkpoint(window_open, engine->window);

    /* etc */

    /* Everything went well, just return the device. */
    return device;

    /* After the return, insert your cleanup code in reverse order. */
undo_window_open: CloseWindow(engine->window);
undo_malloc: free(engine);
err: return NULL;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-05-14T15:10:49.053

[一个快速的谷歌搜索会产生像其他人提到的那样](http://www.on-time.com/ddj0011.htm)使用 setjmp/longjmp 的kludgey 解决方案。没有什么比 C++/Java 的 try/catch 更直接和优雅了。我自己比较偏爱 Ada 的异常处理。

使用 if 语句检查所有内容 :)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-05-14T15:11:26.577

这可以`setjmp/longjmp`在 C中完成[。P99](http://p99.gforge.inria.fr/p99-html/group__try.html)有一个非常舒适的工具集，这也与 C11 的新线程模型一致。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-07-17T19:15:53.973

在 C 中，您可以通过手动使用 if + goto 来“模拟”异常以及自动“对象回收”以进行显式错误处理。

我经常编写如下 C 代码（归结为突出错误处理）：

```
#include <assert.h>

typedef int errcode;

errcode init_or_fail( foo *f, goo *g, poo *p, loo *l )
{
    errcode ret = 0;

    if ( ( ret = foo_init( f ) ) )
        goto FAIL;

    if ( ( ret = goo_init( g ) ) )
        goto FAIL_F;

    if ( ( ret = poo_init( p ) ) )
        goto FAIL_G;

    if ( ( ret = loo_init( l ) ) )
        goto FAIL_P;

    assert( 0 == ret );
    goto END;

    /* error handling and return */

    /* Note that we finalize in opposite order of initialization because we are unwinding a *STACK* of initialized objects */

FAIL_P:
    poo_fini( p );

FAIL_G:
    goo_fini( g );

FAIL_F:
    foo_fini( f );

FAIL:
    assert( 0 != ret );

END:
    return ret;        
} 
```

这是完全标准的 ANSI C，将错误处理与您的主线代码分开，允许（手动）堆栈展开初始化对象，就像 C++ 所做的那样，这里发生的事情是完全显而易见的。因为您在每个点都明确地测试失败，所以在每个可能发生错误的地方插入特定的日志记录或错误处理确实变得更容易。

如果您不介意一点宏魔术，那么您可以在执行其他操作（例如使用堆栈跟踪记录错误）时使其更加简洁。例如：

```
#include <assert.h>
#include <stdio.h>
#include <string.h>

#define TRY( X, LABEL ) do { if ( ( X ) ) { fprintf( stderr, "%s:%d: Statement '%s' failed! %d, %s\n", __FILE__, __LINE__, #X, ret, strerror( ret ) ); goto LABEL; } while ( 0 )

typedef int errcode;

errcode init_or_fail( foo *f, goo *g, poo *p, loo *l )
{
    errcode ret = 0;

    TRY( ret = foo_init( f ), FAIL );
    TRY( ret = goo_init( g ), FAIL_F );
    TRY( ret = poo_init( p ), FAIL_G );
    TRY( ret = loo_init( l ), FAIL_P );

    assert( 0 == ret );
    goto END;

    /* error handling and return */

FAIL_P:
    poo_fini( p );

FAIL_G:
    goo_fini( g );

FAIL_F:
    foo_fini( f );

FAIL:
    assert( 0 != ret );

END:
    return ret;        
} 
```

当然，这并不像 C++ 异常 + 析构函数那样优雅。例如，以这种方式在一个函数中嵌套多个错误处理堆栈不是很干净。相反，您可能希望将它们分解为类似处理错误的自包含子函数，像这样显式地初始化 + 终结。

这也只适用于单个函数，并且不会继续向上跳转堆栈，除非更高级别的调用者实现类似的显式错误处理逻辑，而 C++ 异常只会继续向上跳转堆栈，直到找到合适的处理程序。它也不允许您抛出任意类型，而只能抛出错误代码。

以这种方式系统地编码（即 - 具有单个入口和单个出口点）也使得插入无论如何都会执行的前后（“最终”）逻辑变得非常容易。您只需将“最终”逻辑放在 END 标签之后。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-05-21T19:39:54.547

警告：以下内容不是很好，但可以完成工作。

```
#include <stdio.h>
#include <stdlib.h>

typedef struct {
    unsigned int  id;
    char         *name;
    char         *msg;
} error;

#define _printerr(e, s, ...) fprintf(stderr, "\033[1m\033[37m" "%s:%d: " "\033[1m\033[31m" e ":" "\033[1m\033[37m" " ‘%s_error’ " "\033[0m" s "\n", __FILE__, __LINE__, (*__err)->name, ##__VA_ARGS__)
#define printerr(s, ...) _printerr("error", s, ##__VA_ARGS__)
#define printuncaughterr() _printerr("uncaught error", "%s", (*__err)->msg)

#define _errordef(n, _id) \
error* new_##n##_error_msg(char* msg) { \
    error* self = malloc(sizeof(error)); \
    self->id = _id; \
    self->name = #n; \
    self->msg = msg; \
    return self; \
} \
error* new_##n##_error() { return new_##n##_error_msg(""); }

#define errordef(n) _errordef(n, __COUNTER__ +1)

#define try(try_block, err, err_name, catch_block) { \
    error * err_name = NULL; \
    error ** __err = & err_name; \
    void __try_fn() try_block \
    __try_fn(); \
    void __catch_fn() { \
        if (err_name == NULL) return; \
        unsigned int __##err_name##_id = new_##err##_error()->id; \
        if (__##err_name##_id != 0 && __##err_name##_id != err_name->id) \
            printuncaughterr(); \
        else if (__##err_name##_id != 0 || __##err_name##_id != err_name->id) \
            catch_block \
    } \
    __catch_fn(); \
}

#define throw(e) { *__err = e; return; }

_errordef(any, 0) 
```

用法：

```
errordef(my_err1)
errordef(my_err2)

try ({
    printf("Helloo\n");
    throw(new_my_err1_error_msg("hiiiii!"));
    printf("This will not be printed!\n");
}, /*catch*/ any, e, {
    printf("My lovely error: %s %s\n", e->name, e->msg);
})

printf("\n");

try ({
    printf("Helloo\n");
    throw(new_my_err2_error_msg("my msg!"));
    printf("This will not be printed!\n");
}, /*catch*/ my_err2, e, {
    printerr("%s", e->msg);
})

printf("\n");

try ({
    printf("Helloo\n");
    throw(new_my_err1_error());
    printf("This will not be printed!\n");
}, /*catch*/ my_err2, e, {
    printf("Catch %s if you can!\n", e->name);
}) 
```

输出：

```
Helloo
My lovely error: my_err1 hiiiii!

Helloo
/home/naheel/Desktop/aa.c:28: error: ‘my_err2_error’ my msg!

Helloo
/home/naheel/Desktop/aa.c:38: uncaught error: ‘my_err1_error’ 
```

请记住，这是使用嵌套函数和`__COUNTER__`. 如果您使用 gcc，您将是安全的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-12-10T09:45:13.087

Redis 使用 goto 来模拟 try/catch，恕我直言，它非常干净优雅：

```
/* Save the DB on disk. Return REDIS_ERR on error, REDIS_OK on success. */
int rdbSave(char *filename) {
    char tmpfile[256];
    FILE *fp;
    rio rdb;
    int error = 0;

    snprintf(tmpfile,256,"temp-%d.rdb", (int) getpid());
    fp = fopen(tmpfile,"w");
    if (!fp) {
        redisLog(REDIS_WARNING, "Failed opening .rdb for saving: %s",
            strerror(errno));
        return REDIS_ERR;
    }

    rioInitWithFile(&rdb,fp);
    if (rdbSaveRio(&rdb,&error) == REDIS_ERR) {
        errno = error;
        goto werr;
    }

    /* Make sure data will not remain on the OS's output buffers */
    if (fflush(fp) == EOF) goto werr;
    if (fsync(fileno(fp)) == -1) goto werr;
    if (fclose(fp) == EOF) goto werr;

    /* Use RENAME to make sure the DB file is changed atomically only
     * if the generate DB file is ok. */
    if (rename(tmpfile,filename) == -1) {
        redisLog(REDIS_WARNING,"Error moving temp DB file on the final destination: %s", strerror(errno));
        unlink(tmpfile);
        return REDIS_ERR;
    }
    redisLog(REDIS_NOTICE,"DB saved on disk");
    server.dirty = 0;
    server.lastsave = time(NULL);
    server.lastbgsave_status = REDIS_OK;
    return REDIS_OK;

werr:
    fclose(fp);
    unlink(tmpfile);
    redisLog(REDIS_WARNING,"Write error saving DB on disk: %s", strerror(errno));
    return REDIS_ERR;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-07-22T11:19:45.880

如果您将 C 与 Win32 一起使用，则可以利用其[结构化异常处理 (SEH)](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680657%28v=vs.85%29.aspx)来模拟 try/catch。

如果您在不支持`setjmp()`and的平台上使用 C，请`longjmp()`查看 pjsip 库的这个[异常处理](http://www.pjsip.org/pjlib/docs/html/group__PJ__EXCEPT.htm)，它确实提供了自己的实现

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2013-04-09T15:28:22.920

也许不是主要语言（不幸的是），但在 APL 中，有 ⎕EA 操作（代表 Execute Alternate）。

用法：'Y' ⎕EA 'X' 其中 X 和 Y 是作为字符串或函数名称提供的代码片段。

如果 X 遇到错误，将改为执行 Y（通常是错误处理）。

# apache - ActiveMQ/Camel 消息中的回车“%0A”引发异常

> ID：10586005
> 
> 赞同：0
> 
> 时间：2012-05-14T15:07:10.507
> 
> 标签：apache, encoding, activemq, apache-camel, carriage-return

我正在为我的网站开发一个 API，使用 ActiveMQ 和 Camel 以便 iPhone 通过 Stomp 协议进行连接。消息的主体是一个带有不同参数的 JSON，然后我将其传递给 PHP Web 应用程序，例如 Post 数据等。

我们在 iphone 上得到了一个带有“textarea”的表格。如果我提交一个简单的行，没有回车，ActiveMQ 和 Camel 会处理它，将它传递给我的 PHP 应用程序，它将它保存在数据库中，一切都很好。

但是当 textarea 值中有回车，编码为“%0A”时，ActiveMQ 会引发异常，并且不会调用 PHP 应用程序。

在我的 apache 错误日志中，我只有这一行：

```
[Mon May 14 16:08:54 2012] [error] [client 127.0.0.1] An URL must be provided 
```

在我的 ActiveMQ 日志中，我有（我没有粘贴所有内容，只有第一次加注）：

```
2012-05-14 16:42:22,038 | DEBUG | Caused by: [org.apache.camel.RuntimeCamelException - org.apache.camel.component.http.HttpOperationFailedException: HTTP operation failed invoking http//localapi:80/api_dev.php/dispatcher with statusCode: 500] | org.apache.camel.component.jms.EndpointMessageListener | Camel (camel) thread #0 - JmsConsumer[query]
org.apache.camel.RuntimeCamelException:    org.apache.camel.component.http.HttpOperationFailedException: HTTP operation failed invoking http//localapi:80/api_dev.php/dispatcher with statusCode: 500   
at org.apache.camel.util.ObjectHelper.wrapRuntimeCamelException(ObjectHelper.java:1139)
at org.apache.camel.component.jms.EndpointMessageListener.onMessage(EndpointMessageListener.java:115)
at org.springframework.jms.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:560)
at org.springframework.jms.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:498)
at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:467)
at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:323)
at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:261)
at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1056)
at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1048)
at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:947)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
at java.lang.Thread.run(Thread.java:636)
Caused by: org.apache.camel.component.http.HttpOperationFailedException: HTTP operation failed invoking http//localapi:80/api_dev.php/dispatcher with statusCode: 500
at org.apache.camel.component.jetty.DefaultJettyHttpBinding.populateHttpOperationFailedException(DefaultJettyHttpBinding.java:143)
at org.apache.camel.component.jetty.DefaultJettyHttpBinding.populateResponse(DefaultJettyHttpBinding.java:61)
at org.apache.camel.component.jetty.JettyContentExchange.doTaskCompleted(JettyContentExchange.java:149)
at org.apache.camel.component.jetty.JettyContentExchange.onResponseComplete(JettyContentExchange.java:86)
at org.eclipse.jetty.client.HttpExchange$Listener.onResponseComplete(HttpExchange.java:887)
at org.eclipse.jetty.client.HttpExchange.setStatus(HttpExchange.java:258)
at org.eclipse.jetty.client.HttpConnection$Handler.messageComplete(HttpConnection.java:580)
at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:314)
at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:211)
at org.eclipse.jetty.client.HttpConnection.handle(HttpConnection.java:254)
at org.eclipse.jetty.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:506)
at org.eclipse.jetty.util.thread.QueuedThreadPool$2.run(QueuedThreadPool.java:436)
... 1 more 
```

消息的正文如下所示：

```
Message: 
    body={
        "session_id":"XXXX",
        "method":"post",
        "params":{
            "post":{
                "form_name":{
                    "field_name":"foo%0Abar"
                }
            }
        },
        "url":"/my_object/update",
        "query_id":"XXX"
    } 
```

我的 ActiveMQ conf 是用 Spring 制作的，因为我（一点也不）对 Java 不太了解

谢谢你的任何线索

# javascript - 在 IndexedDB 中存储图像文件

> ID：10586006
> 
> 赞同：5
> 
> 时间：2012-05-14T15:07:13.440
> 
> 标签：javascript, html, indexeddb

我在尝试将图像文件存储在 IndexedDB 中时遇到问题，我抓取了文件对象并尝试将其推送到 IndexedDB 中，但它似乎引发了错误：

> `DOM Exception: DATA_CLONE_ERR (25)`

如何将文件对象（如下所示）转换为可以存储在 indexedDB 中并在以后从 indexedDB 中检索的内容？

```
attribute: 32
contentType: "image/png"
displayName: "image1"
displayType: "PNG File"
fileType:    ".png"
name:        "image1.png"
path:        "C:\pictures\image1.png" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T00:56:13.783

IndexedDB 支持在 Firefox 和 Chrome 中存储 blob。有关于将图像存储到 IndexedDB 的可用[示例](http://hacks.mozilla.org/2012/02/storing-images-and-files-in-indexeddb/)。该代码适用于最新版本的 Chrome 和 Firefox。希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T00:45:57.473

我相信您的对象可能会发生一些事情，使其看起来与上面列出的键/值对创建的对象文字不同。我建议`console.log`在对象通过后对其进行检查`JSON.stringify`，以确保它与您的意图一一对应。

[IndexedDB 使用 HTML5结构化克隆算法](https://developer.mozilla.org/en/DOM/The_structured_clone_algorithm)将对象复制到对象存储中。根据[规范](http://www.w3.org/TR/IndexedDB/)，不能克隆 Error 和 Function 对象并抛出 a `DATA_CLONE_ERR`，因此请将此视为可能的解释。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-05T04:02:41.087

另请注意，Chrome（至少到版本 23）尚不支持在 IndexedDB 中存储 blob，如果您尝试直接存储它们，则会抛出您描述的错误。与此同时，您将不得不使用 FileSystem API。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T20:41:58.153

这篇 Mozilla hacks 文章应该有所帮助 - [http://hacks.mozilla.org/2012/02/storing-images-and-files-in-indexeddb/](http://hacks.mozilla.org/2012/02/storing-images-and-files-in-indexeddb/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-09T19:47:32.063

您可以使用**ydn-db** API。

请参阅下面链接的“存储文件和 Blob 数据”部分。

[http://dev.yathit.com/ydn-db/transaction.html](http://dev.yathit.com/ydn-db/transaction.html)

干杯。

# html - 如何使用剃刀引擎在视图中为 TextAreaFor 添加 maxlength

> ID：10586007
> 
> 赞同：15
> 
> 时间：2012-05-14T15:07:13.723
> 
> 标签：html, asp.net-mvc, asp.net-mvc-3, razor

我的视图中有一个使用 Razor 引擎实现的 TextArea() 控件。

```
@Html.TextArea("EventNature",new { style = "width: 200px; height: 100px;" }) 
```

如何设置此控件的 Maxlength 属性？
RazorEngine 中是否有任何内置属性或者我必须使用脚本？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-14T15:10:07.757

你可以这样做：

```
@Html.TextArea("EventNature",new { maxlength=50, // or other value
                                  style = "width: 200px; height: 100px;" }) 
```

请注意这是一个 HTML5 属性

> maxlength **HTML5**
> 用户可以输入的最大字符数（Unicode 代码点）。如果未指定，用户可以输入不限数量的字符。

[**MDN**](https://developer.mozilla.org/en/HTML/Element/textarea)

* * *

HTML <5的Javascript（使用jQuery）验证：

```
$('#EventNature').keypress(function(){
    if (this.value.length >= 10) // allowing you to enter only 10 chars.
    return false;        
});​ 
```

[**演示**](http://jsfiddle.net/gdoron/35WAV/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-02-18T22:29:08.383

这也适用于具有多个匿名类型的**TextAreaFor助手**`new`

**确认**在带有**MVC 5**的**Visual Studio 2015**中可以**正常工作**

 ****```
@Html.TextAreaFor(model => model.Comments, 5, 500, new {maxlength=4000,  @class = "form-control" }) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-23T07:09:52.997

您还可以限制文本框的长度，如下所示：

```
<textarea id="EventNature1" maxlength="10"></textarea>

        OR
@Html.TexareaFor(m=>m.Name,new{@maxlength="10"}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-10T21:24:27.647

```
<p>Customer Number: @Html.TextBox("SearchString1",null, new {maxlength = 6})
 <input type="submit" value="Filter" /></p> 
```

上面是一个示例，它对我来说限制了允许输入的最大字符数。在使用 .Net 环境时显示的提示非常有用。（*注意，这不会物理上改变文本框的大小）

"SearchString1" = 字符串名称 ----- null = 对象值 ------ new {maxlength = 6} = 对象 htmlAttributes

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-14T15:08:09.523

> 如何设置此控件的 Maxlength 属性？

该属性对元素`maxlength`无效。`<textarea>`这不是 ASP.NET MVC 限制。在 HTML 规范中，此属性仅针对简单的文本输入字段定义。如果您想限制用户可以在 textarea 中输入的字符数，您可以使用 javascript。****

# php - 有没有更简单的方法来使用 PHP 正则表达式截断字符串？

> ID：10586011
> 
> 赞同：3
> 
> 时间：2012-05-14T15:07:26.313
> 
> 标签：php

我有一个如下所示的字符串：

```
Security/Flow_Setup/Steady_State/Verification 
```

我只需要前两个级别（例如**Security/Flow_Setup**）有没有更简单的方法来获得这个。目前我将字符串分解为一个数组，使用：'/' 作为分隔符，然后将元素 0 和 1 拼凑在一起。

这可行，但我希望有一个更优雅的解决方案。

有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T15:10:23.080

如果您只需要前两部分，我认为您不会比这更优雅/更短：

```
list($var1, $var2) = explode('/', $str); 
```

正则表达式在这里完全没有必要。

[`dirname`](http://php.net/manual/en/function.dirname.php)有人在[评论](https://stackoverflow.com/questions/10586011/is-there-an-easier-way-to-truncate-a-string-with-php-regex/10586064#comment13713538_10586011)中提到，我认为这是一个聪明且可能合适的想法，并且非常简短易读（并为您提供所需的字符串，而不是像上面的代码那样的两个单独的部分）：

```
$str = 'Security/Flow_Setup/Steady_State/Verification';

echo dirname(dirname($str));

// Output: Security/Flow_Setup 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T15:12:47.147

我相信你做的一切都很好。如果你喜欢，你可以这样尝试：

```
$str = "Security/Flow_Setup/Steady_State/Verification";
echo substr($str, 0, strpos($str, '/', strpos($str, '/') + 1)); 
```

（不涉及数组，应该快一点）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T16:18:03.487

不是典型用法也不是字符串函数，但由于您的字符串实际上是一条路径，也许这就足够了......

```
dirname(dirname('Security/Flow_Setup/Steady_State/Verification')); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T15:23:24.773

这是我能想到的最短和最有效的单线：

```
$firstTwoParts = implode('/', array_slice(explode('/', $str, 3), 0, 2)); 
```

这可以包装成一个函数，让你控制你想要多少部分：

```
function first_n_parts ($str, $n, $delimiter = '/') {
  return ($n = (int) $n) ? implode($delimiter, array_slice(explode($delimiter, $str, $n + 1), 0, $n)) : '';
} 
```

...所以你可以这样做：

```
echo first_n_parts($str, 1); // Security
echo first_n_parts($str, 2); // Security/Flow_Setup
echo first_n_parts($str, 3); // Security/Flow_Setup/Steady_State 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T15:11:14.653

这个正则表达式应该这样做

```
'/^([a-zA-Z]+\/[a-zA-Z]+)?/' 
```

# iphone - IOS 5 中的 AVCaptureVideoDataOutput 问题

> ID：10586018
> 
> 赞同：1
> 
> 时间：2012-05-14T15:08:04.283
> 
> 标签：iphone, objective-c

我用这个方法初始化 AVCaptureVideoDataOutput：

```
// Setup the video output
_videoOutput = [[AVCaptureVideoDataOutput alloc] init];
_videoOutput.alwaysDiscardsLateVideoFrames = YES;
_videoOutput.minFrameDuration = kCMTimeZero;
_videoOutput.videoSettings =
[NSDictionary dictionaryWithObjectsAndKeys:[NSNumber numberWithInt:kCVPixelFormatType_32BGRA],(id)kCVPixelBufferPixelFormatTypeKey
 ,AVVideoCodecH264, AVVideoCodecKey, nil];

// Setup the audio output
_audioOutput = [[AVCaptureAudioDataOutput alloc] init];

NSLog(@"dispatch_queue_t");
// Setup the queue
dispatch_queue_t queue = dispatch_queue_create("MyQueue", NULL);
[_videoOutput setSampleBufferDelegate:self queue:queue];
[_audioOutput setSampleBufferDelegate:self queue:queue];
dispatch_release(queue); 
```

我有一个委托方法的问题：

*   (void)captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection

不会被调用。在 IOS4 中调用了这个方法，知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T22:50:42.267

向会话添加输入和输出。然后调用 [session startRunning]。

# php - (php) 在初始表单后获得额外的输入？

> ID：10586022
> 
> 赞同：2
> 
> 时间：2012-05-14T15:08:09.990
> 
> 标签：php, forms, session

我正在继续写一个迷宫生成器来自学php...

我已经设置了一个会话和一个表格来收集名称和迷宫大小（5-20​​）。

在第一次运行时，效果很好，迷宫就生成了。

我希望进一步的会话是记住名称，但重新输入大小。

如果会话不是新的，我尝试使用另一种（不同的）表单，但它无法识别/运行它，并且出现错误，告诉我 $mazesize 是一个无法识别的索引。

代码：

```
<?php
session_start();
error_reporting(-1);
?>
<html>
<head>
</head>
<body>
<?php

include 'ClassFunc1.php';

//program functionality
if (!isset($_SESSION['name']) && !isset($_POST['name'])){
    //if no data, print form
        ?><table><tr>
        <form action="<?php echo $_SERVER['PHP_SELF'] ?>" method="post">
        <td>Name: </td><td><input type="text" name="name"></td></tr>
        <tr><td>Maze size (min 5 max 20): </td><td><input type="text" name="mazesize"></td></tr>
        <tr><td colspan="2" align="center"><input type="submit" name="submit" value="Submit"></td></tr>
        </form></table>
        <?php
}else if (!isset($_SESSION['name']) && isset($_POST['name']) && isset($_POST['mazesize'])){
        //if a session doesn't exist but the form has been submitted
        //check to see if the form has all required values
        //create a new session
        if(!empty($_POST['name'])){
        $_SESSION['name']=$_POST['name'];
        $_SESSION['start']=time();
        echo "Welcome, ".$_POST['name'].". A new session has been activated for you. Click <a href=".$_SERVER['PHP_SELF'].">here</a> to refresh the page.";
        if($_POST['mazesize']>20){
            $m_size=20;
        }elseif($_POST['mazesize']<5){
            $m_size=5;
        }else{
            $m_size=$_POST['mazesize'];
        }
        define("COL_MAX",$m_size);
        define("ROW_MAX",$m_size);
        run_maze($_POST['name']);
        close_down();
        }else{
            echo "ERROR. Please enter your name and a maze size";
        }
}else if (isset($_SESSION['name'])) {
        //if a previous session exists
        //calculate elapsed time since session start and now
        echo "Welcome back, ".$_SESSION['name'].". This session was activated ".round((time()-$_SESSION['start'])/60)." minute(s) ago. Click <a href=".$_SERVER['PHP_SELF'].">here</a> to refresh the page.<br />";
        echo "Current session ID: ".session_id();
    //Ask for a new maze size
        ?><table><tr>
        <form action="<?php echo $_SERVER['PHP_SELF'] ?>" method="post">
        <td>Maze size (min 5 max 20): </td><td><input type="text" name="mazesize"></td></tr>
        <tr><td colspan="2" align="center"><input type="submit" name="submit" value="Submit"></td></tr>
        </form></table>
        <?php
        if($_POST['mazesize']>20){
            $m_size=20;
        }elseif($_POST['mazesize']<5){
            $m_size=5;
        }else{
            $m_size=$_POST['mazesize'];
        }
    define("COL_MAX",$m_size);
    define("ROW_MAX",$m_size);
    run_maze($_POST['name']);
    close_down();
}

//session_destroy();

?> 
```

“包含”文件是类、方法和函数。

我确定我做错了什么，有人可以帮忙吗？

非常感谢

预计到达时间：

（在 echo "ERROR... line 之后修改了代码）

```
 }else if (isset($_SESSION['name']) && !isset($_POST['n_mazesize'])) {
            //if a previous session exists but n_mazesize not set
            //calculate elapsed time since session start and now
            echo "Welcome back, ".$_SESSION['name'].". This session was activated ".round((time()-$_SESSION['start'])/60)." minute(s) ago. Click <a href=".$_SERVER['PHP_SELF'].">here</a> to refresh the page.<br />";
            echo "Current session ID: ".session_id();
        //Ask for a new maze size
            ?><table><tr>
            <form action="<?php echo $_SERVER['PHP_SELF'] ?>" method="post">
            <td>Maze size (min 5 max 20): </td><td><input type="text" name="n_mazesize"></td></tr>
            <tr><td colspan="2" align="center"><input type="submit" name="submit" value="Submit"></td></tr>
            </form></table>
            <?php
    }else if (!isset($_SESSION['name']) && isset($_POST['n_mazesize'])){
            //if a previous session exists and n_mazesize is set
            //calculate elapsed time since session start and now
            echo "Welcome back, ".$_SESSION['name'].". This session was activated ".round((time()-$_SESSION['start'])/60)." minute(s) ago. Click <a href=".$_SERVER['PHP_SELF'].">here</a> to refresh the page.<br />";
            echo "Current session ID: ".session_id();
            if(!empty($_POST['n_mazesize'])){
            if($_POST['n_mazesize']>20){
                $m_size=20;
            }elseif($_POST['n_mazesize']<5){
                $m_size=5;
            }else{
                $m_size=$_POST['n_mazesize'];
            }
        run_maze($_SESSION['name'], $m_size);
        close_down();
        }

    //session_destroy();
    }

    ?>
</body>
</html> 
```

这要求尺寸，但在提交时返回一个空白屏幕:-(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:22:54.317

$_POST['mazesize'] 的值仅在提交表单时可用。您应该添加一个条件：

```
if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    // use posted data here
} 
```

# javascript - 从 URL 读取 JSON

> ID：10586024
> 
> 赞同：6
> 
> 时间：2012-05-14T15:08:20.680
> 
> 标签：javascript, ajax, json, url

我面临一个应该很容易解决的问题，但我现在迷路了。

我有一个网址：[http ://search.twitter.com/search.json?q=bacon](http://search.twitter.com/search.json?q=bacon)

使用 JavaScript（不是 JQuery 或 php。只是 JavaScript），我想读取这个 JSON 字符串并解析它。就是这样。

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-14T15:10:23.417

您将受到[SOP](http://en.wikipedia.org/wiki/Same_origin_policy)的限制（`XMLHttpRequest`s 只能用于同一域上的 URI；JSON 只能通过此方法检索）。要绕过这一点，您必须改用 [JSONP](https://stackoverflow.com/questions/3839966/can-any-one-explain-me-what-is-jsonp-in-layman-terms/3840118#3840118)（[其他解释*](http://www.mattlunn.me.uk/blog/2011/10/json-vs-jsonp/)）。

似乎端点[支持 JSONP](http://search.twitter.com/search.json?q=bacon&callback=foo)，所以你可以这样做：

```
function foo(response) {
    // response is already a JavaScript object
}

var script = document.createElement("script");
script.src = "http://search.twitter.com/search.json?q=bacon&callback=foo";

document.body.appendChild(script); 
```

^(^(* 免责声明：是的，那是我的博客))

# android - 垃圾收集后Android是否可以使用Parcelable数据？

> ID：10586026
> 
> 赞同：0
> 
> 时间：2012-05-14T15:08:22.297
> 
> 标签：android, android-intent, garbage-collection, parcelable, parcel

可打包数据是持久的吗？我在 android 生命周期函数中销毁了一些变量，例如`onDestroy()`，但是写入 parcelable 的东西呢？

最终我想通过意图传递我的可打包对象的元素，垃圾收集后它们是否仍然可用（java或dalvik）？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:26:06.207

简短的回答是：是的。Parcelable 数据是持久的。

当你从一个对象中创建一个 Parcel 时，你基本上是在创建一个 at 对象的序列化版本。一旦你有了序列化的版本，对象本身就可以被垃圾收集，你仍然会拥有 Parcel（假设你已经保留了一个句柄，或者如果你已经通过 Intent 发送了它，那么操作系统就有了它的句柄） .

在另一个时候，您可以从 Parcel 中实例化一个新对象，最终将得到原始对象的副本，而不管原始对象是否已被垃圾回收。

# wordpress - Wordpress MU (WPMU) / Multi Site - 有时图片不显示

> ID：10586029
> 
> 赞同：1
> 
> 时间：2012-05-14T15:08:24.933
> 
> 标签：wordpress, wpmu

我还是新来的 - 但我希望有人愿意并且能够帮助我解决我的问题：

我们最近将我们常规的老式 Wordpress 博客合并到 1 WP MU/多站点安装中。

但这付出了可怕的代价。

我现在有 5 个站点在我的安装中 - 这就是我在 WPMU 安装中看到它们的方式（供以后参考）：

**主站点：** site1.com

**具有自己域的辅助站点：（**指向同一服务器的停放域）site2.com site3.com site4.com

**没有自己域的辅助站点：（**带子目录的主域）site1.com/site4com

所有图像都在我的主站点 (site1.com) 上工作。

在我的辅助站点（有或没有自己的域）上，我的图像有时可以工作，有时不能。我将尝试解释这种模式：

早上一切正常。它“感觉”就像访问者的数量以及他们对系统的“压力”程度会引发图像加载错误。当“它不工作”时，通常一半的图像加载正确，而另一半则没有。选择一个未加载的图像并将 URL 粘贴到新的窗格/窗口并单独加载它总是有效的 - 无论我按 F5 对服务器施加压力的速度和时间有多长。

因此，从上面的描述中，我将尝试得出此错误与 WP MU 如何处理辅助站点图像有关。我认为有一些与 WP MU 和常规 WP 不同的“服务器转发”/“url 解析”逻辑（我假设主站点就像常规博客一样工作）。

**因此，如果有人可以：**

*   帮我彻底解决这个问题
*   或帮助我确定主要/次要 url 解析之间的区别

我将不胜感激！

不管怎样，谢谢你读到这里！！

编辑：刚刚在 wordpress.org 上发现了同样问题的帖子 - 但没有解决方案： [http ://wordpress.org/support/topic/subdirectory-images-randomly-not-loading](http://wordpress.org/support/topic/subdirectory-images-randomly-not-loading)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T14:32:51.073

我认为这是您的 WP 更新的问题。您是否在安装后进行过 Wp 更新，如果是，请尝试将以下代码添加到您的 wp-config 文件中。

```
define('WP_DEBUG', false);
define('WP_ALLOW_MULTISITE', true); 
```

如果它也不起作用，请在此处发布，让我们搜索不同的解决方案。

# java - 修改作为托管属性从另一个托管 bean 访问的托管 bean 的私有对象属性

> ID：10586030
> 
> 赞同：0
> 
> 时间：2012-05-14T15:08:29.157
> 
> 标签：java, jsf, jakarta-ee, jsf-2, managed-bean

尝试向我们的 JSF 2 应用程序添加功能以列出活动用户（具有活动会话），为此我决定使用应用程序范围的托管 bean 并存储用户列表，并在成功登录时添加每个用户。然后我会从 jsf 页面访问活动用户列表（存储在应用程序范围的托管 bean 上）——只有当我能弄清楚如何解决以下问题时：

应用程序范围的 bean：AppBean.java

```
@ManagedBean(name = "appBean")
@ApplicationScoped
public class AppBean implements java.io.Serializable {

    private List<User> connectedUsers = new ArrayList<User>();

    public AppBean() {
    }

    public List<User> getConnectedUsers() {
        return connectedUsers;
    }

    public void setConnectedUsers(List<User> connectedUsers) {
        this.connectedUsers = connectedUsers;
    }  
} 
```

登录 Bean：

```
@Named(value = "loginBean")
@SessionScoped
public class LoginBean implements Serializable {

    @ManagedProperty("#{appBean}")
    private AppBean appBean;

    private User userInSession;

    public LoginBean() {
    }

    public String authenticate() {
        if (this.authClearsOut()) {
            if (appBean != null)
                appBean.getConnectedUsers().add(userInSession);
            else System.out.println("appBean = null !!!!");
            return "/next_screen.xhtml?redirect=true";
        }
        else return "/login.xhtml?authentication=failed";
    }

    public AppBean getAppBean() {
        return appBean;
    }

    public void setAppBean(AppBean appBean) {
        this.appBean = appBean;
    }
} 
```

现在这里有两个问题：1）appBean 为空，除非我将 LoginBean.java 的第 6 行更改为 private AppBean appBean = new AppBean(); 2) 用户 userinSession 永远不会添加到（列表）connectedUsers。

这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:15:08.990

JSF`@ManagedProperty`注释`@ManagedBean`仅在 JSF 中有效，在 CDI 中无效`@Named`。

改为`LoginBean`由 JSF 管理`@ManagedBean`，或者将`AppBean`bean 改为由 CDI 管理`@Named`，然后使用`@Inject`代替`@ManagedProperty`.

# java - 使用 1 个数组实现 3 个堆栈，此代码可以工作吗？

> ID：10586031
> 
> 赞同：4
> 
> 时间：2012-05-14T15:08:31.457
> 
> 标签：java, algorithm

这是我在一本算法/面试题书上找到的，别人在这本上发了好几篇帖子，但我还是有一些疑问，以下是书中的原文和代码：

```
implement 3 stacks using 1 array:
Approach 2: 
```

在这种方法中，只要数组中有任何可用空间，任何堆栈都可以增长。我们按顺序为堆栈分配空间，并将新块链接到前一个块。这意味着堆栈中的任何新元素都会保留指向该特定堆栈的前一个顶部元素的指针。在这个实现中，我们面临一个未使用空间的问题。例如，如果堆栈删除了它的一些元素，则删除的元素可能不一定出现在数组的末尾。因此，在这种情况下，我们将无法使用那些新释放的空间。为了克服这个缺陷，我们可以维护一个空闲列表，整个数组空间最初会被分配给空闲列表。对于每次插入，我们将从空闲列表中删除一个条目。在删除的情况下，我们只需将空闲单元格的索引添加到空闲列表中。

```
1 int stackSize = 300;
2 int indexUsed = 0;
3 int[] stackPointer = {-1,-1,-1};
4 StackNode[] buffer = new StackNode[stackSize * 3];

5 void push(int stackNum, int value) {
6     int lastIndex = stackPointer[stackNum];
7     stackPointer[stackNum] = indexUsed;
8     indexUsed++;
9     buffer[stackPointer[stackNum]]=new StackNode(lastIndex,value);
10 }

11 int pop(int stackNum) {
12    int value = buffer[stackPointer[stackNum]].value;
13    int lastIndex = stackPointer[stackNum];
14    stackPointer[stackNum] = buffer[stackPointer[stackNum]].previous;
15    buffer[lastIndex] = null;
16    indexUsed--;
17    return value;
18 }

19 int peek(int stack) { return buffer[stackPointer[stack]].value; }

20 boolean isEmpty(int stackNum) { return stackPointer[stackNum] == -1; }
21
22 class StackNode {
23    public int previous;
24    public int value;
25    public StackNode(int p, int v){
26       value = v;
27       previous = p;
28    }
29 } 
```

我的问题是：在 pop() 方法中，将 buffer[lastIndex] 设置为 null（第 15 行），然后 indexUsed--（第 16 行），indexUsed 是否会成为空白空间的头部？让我们调用第一个堆栈的**堆栈顶部节点**：S1，第二个堆栈：S2，第三个堆栈：S3；如果出现以下情况会发生什么情况：在我想弹出 s1 之前，我先推送了 s1，然后是 s2 和 s3，

```
index:    10   11   12    13
-------------------------------
| ...   | s1 | s2 | s3 | null |
------------------------------- 
```

**indexUsed**现在是13。现在，如果我想在第一个堆栈上执行 pop()，它将变为：

```
index:     10    11   12    13
----------------------------------
| ...   | null | s2 | s3 | null |
---------------------------------- 
```

并且**indexUsed**现在是 13-- ，即 12，所以如果我想根据 push() 方法将一个新节点推送到这个数组上会发生什么，在第 7 行，indexUsed 被分配给 stackPointer 并用作将索引推入数组，这不会覆盖第 12 个条目中的 s3（stack3 的顶部节点）吗？

```
added: 
```

以及如何更改它以使其工作？乍一看，我会考虑实现一个 boolean[] 来跟踪存储阵列中每个条目的使用情况，但这会耗费时间和空间。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:31:10.927

据我所知，你是对的——它没有存储足够的信息来指示内存中的漏洞。

堆栈的一大优点是它可以分配在数组列表而不是链接列表的顶部，从而节省了前一个/下一个指针的内存——这种实现消除了这个优势——很难想象一个应用程序这实际上是一个很好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T20:43:42.493

“为了克服这个缺陷，我们可以维护一个空闲列表，整个数组空间最初会被分配给空闲列表”

基本上你可以保留一个“第四个”堆栈，其中包含所有数组的空点。数组将在第 4 个堆栈已满时初始化。每次你推入堆栈 1/2/3 时，你都会从第 4 个堆栈中弹出一个。每次从 1/2/3 弹出时，您都会将其推回 4 号。这样，您始终知道空闲插槽在哪里。

# ruby-on-rails - Rails 为具有多个 has_many 关系的模型渲染 fields_for

> ID：10586033
> 
> 赞同：0
> 
> 时间：2012-05-14T15:08:46.537
> 
> 标签：ruby-on-rails, forms, fields-for

我有一个`components`属于主容器模型的模型。该`components`模型有许多`servers`和`services`。基本上一切都很好，除了它从每个中渲染出两个，因为在我的控制器中我`fields_for`使用以下代码设置了：

```
@reference.components.build.servers.build
@reference.components.build.services.build 
```

所以很清楚为什么我会得到多种表格，有没有办法`has_many`在一条线上建立关系？我试过了：

```
@reference.components.build.servers.build.services.build 
```

和

```
1.times { @reference.components.build.servers.build }
1.times { @reference.components.build.services.build } 
```

谢谢

**更新->**

将代码移动到一个块中似乎可行（我只是在猜测）

```
@reference.components.build do |f|
  f.servers.build
  f.services.build
end 
```

该代码在控制器中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:31:24.843

关键是只调用`components.build`一次，否则每次调用都会添加一个组件来构建

例如

```
component = @reference.components.build
component.servers.build
component.services.build 
```

应该可以正常工作。你偶然发现的块形式实现了同样的事情（我感觉这只是在 3.2 中添加的，可能是 3.2 之后的次要版本之一）

# yui - 雅虎cdn信心+ YUI

> ID：10586034
> 
> 赞同：0
> 
> 时间：2012-05-14T15:08:50.923
> 
> 标签：yui, yahoo, cdn

我正在将我网站的 javascript 迁移到 YUI3，并正在考虑使用托管在 Yahoo's cdn 上的 YUI 文件。

由于我的网站吸引了大量流量，我想知道是否有人有使用 cdn 的经验，以及他们是否遇到过任何问题或吸取了教训。

理想情况下，我很想将带宽卸载到雅虎，但有点担心我会因为不受控制而增加一点风险。

任何意见表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T04:55:01.303

至少在我的经验中，它完全坚如磐石。底层平台是我们 (flickr) 使用的同一个 CDN，以及所有其他雅虎网站。

# mysql - mySQL 选择 IN 范围

> ID：10586035
> 
> 赞同：95
> 
> 时间：2012-05-14T15:08:51.097
> 
> 标签：mysql

是否可以为查询的 IN 部分定义一个范围，像这样

```
SELECT job FROM mytable WHERE id IN (10..15); 
```

代替

```
SELECT job FROM mytable WHERE id IN (10,11,12,13,14,15); 
```

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2012-05-14T15:10:48.973

你不能，但你可以使用`BETWEEN`

```
SELECT job FROM mytable WHERE id BETWEEN 10 AND 15 
```

请注意，这`BETWEEN`是包容性的，并且将包括 id 为 10 和 15 的项目。

如果您不想包含，您将不得不回退到使用`>`and`<`运算符。

```
SELECT job FROM mytable WHERE id > 10 AND id < 15 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-07-13T05:49:16.010

要选择数字范围内的数据，您可以使用`BETWEEN`包含在内的数据。

```
SELECT JOB FROM MYTABLE WHERE ID BETWEEN 10 AND 15; 
```

# caching - Azure - Azure 缓存中 applicationName 的用途是什么？

> ID：10586037
> 
> 赞同：0
> 
> 时间：2012-05-14T15:09:13.730
> 
> 标签：caching, azure, distributed-caching, azure-caching

[为 Windows Azure 缓存配置 ASP.NET 输出缓存提供程序](http://technet.microsoft.com/en-us/library/gg185670.aspx)

我对 applicationName 属性有点困惑。

这是否意味着我可以使用多个应用程序共享同一个 Azure 缓存（只要我不最大化事务、数据传输和连接）？

换句话说，只要 applicationName 不同，相同的缓存键就不会在不同的 Web 应用程序之间发生冲突？

1 GB 缓存 110.00 美元比 10 X 128 MB 缓存 45.00 美元便宜很多。

谢谢你的光！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:23:12.953

如果我们考虑开箱即用缓存的架构设计，那么当您在云中运行同一应用程序的多个实例并使用开箱即用缓存时，要使所有实例在输出缓存方面保持同步。

当您有多个应用程序 1) / Root 2) /production 3) /test 您真的不想在两个不同的应用程序之间混合输出缓存，因为输出缓存可能会根据应用程序名称在缓存端点分配完整页面和部分页面缓存（如果已配置）或 IIS 系统提供的 AppID。

如果您在同一个 ASP.NET Web 角色应用程序中使用多个站点，那么您可以使用 dataCacheClient 根据具有相同应用程序的不同站点的不同主机头来分离输出缓存，这将是首选解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T11:53:17.647

基于 MSDN 链接，ApplicationName 在内部用于生成 Cache Key。如果未提供应用程序密钥，则使用 HttpRuntime.AppDomainAppId。现在开发团队有责任更新 IIS 元数据库，以便每个实例中的 HttpRuntime.AppDomainAppId 解析为相同的值。

简而言之，ApplicationName 名称用于提供额外的隔离层，如果 ApplicationName 在不同的应用程序中匹配，则这些应用程序将使用相同的缓存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T10:50:16.910

此处提到了会话状态和输出缓存的 applicationName 标记的用法差异：http: [//msdn.microsoft.com/en-us/library/hh361708.aspx](http://msdn.microsoft.com/en-us/library/hh361708.aspx)

在此处提出的问题的上下文中，applicationName 标记可以方便地在同一角色的多个实例之间缓存数据。

# c# - Asp.net 从文本框和下拉列表添加数据库

> ID：10586038
> 
> 赞同：0
> 
> 时间：2012-05-14T15:09:22.403
> 
> 标签：c#, asp.net, visual-studio-2010

net 添加数据库。我正在尝试在两个文本框和下拉列表中的一个选定值上添加文本以添加我的表格。这是我的代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data.SqlClient;

public partial class _Default : System.Web.UI.Page

{

    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void Button1_Click(object sender, EventArgs e)
    {
        string connectionString = @" Data Source=.\SQLEXPRESS;AttachDbFilename=C:\USERS\CEM\DOCUMENTS\VISUAL STUDIO 2010\WEBSITES\EKLEMEDENE\APP_DATA\DATABASE.MDF;Integrated Security=True;User Instance=True";
        string queryString = "INSERT INTO ekle(flight, name, food) VALUES   ('" + TextBox1.Text + " ' , '" + TextBox2.Text + " ' ,  '" + DropDownList1.SelectedValue + " '  )";
        SqlConnection con = new SqlConnection(connectionString);
        SqlCommand command = new SqlCommand(queryString, con);
        con.Open();
        command.ExecuteNonQuery();

        con.Close();
    }
} 
```

执行后我会出错

> 数据库“C:\Users\Cem\Documents\Visual Studio 2010\WebSites\eklemedene\App_Data\Database.mdf”已经存在。选择不同的数据库名称。尝试为文件 C:\USERS\CEM\DOCUMENTS\VISUAL STUDIO 2010\WEBSITES\EKLEMEDENE\APP_DATA\DATABASE.MDF 附加自动命名数据库失败。存在同名数据库，或无法打开指定文件，或位于 UNC 共享上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:24:25.897

1.  你对 SQL 注入很开放。避免直接从控件传递参数。而是使用[`Parameters`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.aspx).
2.  用于`using-statement`任何实现`IDisposable`，如连接或命令：
3.  您的 ConnectionString 有问题，您可以尝试使用[`SqlConnectionStringBuilder`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnectionstringbuilder.aspx)类：

* * *

```
//Build the connection 
SqlConnectionStringBuilder bldr = new SqlConnectionStringBuilder();

//Put your server or server\instance name here.  Likely YourComputerName\SQLExpress
bldr.DataSource = ".\\SQLEXPRESS";

//Attach DB Filename
bldr.AttachDBFilename = @"C:\USERS\CEM\DOCUMENTS\VISUAL STUDIO 2010\WEBSITES\EKLEMEDENE\APP_DATA\DATABASE.MDF";

//User Instance
bldr.UserInstance = true;

//Whether or not a password is required.
bldr.IntegratedSecurity = true;

using(var connection = new SqlConnection(bldr.ConnectionString))
{
    var sql = "INSERT INTO ekle(flight, name, food) VALUES (@flight, @name , @food)";
    using(var command = new SqlCommand(sql, connection))
    {
        command.Parameters.AddWithValue("@flight", TextBox1.Text);
        command.Parameters.AddWithValue("@name", TextBox2.Text);
        command.Parameters.AddWithValue("@food", DropDownList1.SelectedValue); 
        connection.Open();
        command.ExecuteNonQuery();
    }
} // closes the connection implicitely 
```

# objective-c - Paint App的软刷？

> ID：10586041
> 
> 赞同：1
> 
> 时间：2012-05-14T15:09:40.303
> 
> 标签：objective-c, ios, opengl-es, core-graphics, quartz-graphics

就像在 Photoshop 和许多其他绘画/照片编辑程序中一样，它可以让您设置画笔的硬度。是否可以使用核心图形来做到这一点？或者我必须使用 OpenGL

PS。如果我必须使用 OpenGL，请给我一些代码和更多详细信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:11:00.300

试试`CGContextSetShadowWithColor`。阴影不透明度取决于绘制对象的阴影颜色和不透明度。我相信如果没有一些遮罩，就不可能对完全透明的对象应用阴影。

...该死的，我想添加一条新评论...

# node.js - 在 Windows Azure 上托管现有的 node.js 应用程序

> ID：10586045
> 
> 赞同：0
> 
> 时间：2012-05-14T15:09:45.997
> 
> 标签：node.js, azure

是否可以将现有的 node.js 应用程序移植到 Windows Azure 平台？我目前在我的 Mac 上开发，但在不久的将来需要将应用程序部署到 Windows Azure。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T20:25:56.380

您可能还想查看有关 Channle 9 的视频。

Azure 上的 node.js：http: [//channel9.msdn.com/Events/Patterns-Practices-Symposium-Online/Patterns-Practices-Symposium-Online-2012/node-js-on-Azure](http://channel9.msdn.com/Events/Patterns-Practices-Symposium-Online/Patterns-Practices-Symposium-Online-2012/node-js-on-Azure)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:37:40.943

是的，很有可能。你可能还需要考虑进行更改以在 node.js 代码使用本地文件系统的情况下使用 Azure Blob 存储（如果需要）。该部署与任何其他 Windows Azure 应用程序非常相似，并且您拥有适用于 node.js 的 Azure SDK，您可以使用 powershell cmdlet 来简化您的工作。

下载适用于 Azure 的 Node.js SDK [https://www.windowsazure.com/en-us/develop/nodejs/](https://www.windowsazure.com/en-us/develop/nodejs/)

在这里您可以了解将 node.js 应用程序部署到 Azure 的基础知识： [https ://www.windowsazure.com/en-us/develop/nodejs/tutorials/getting-started/](https://www.windowsazure.com/en-us/develop/nodejs/tutorials/getting-started/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T22:02:29.357

将 node.js 应用程序移植到 Azure 是可能的，但还不是一个是/否的答案。

您可以在 Azure 中运行 Node 应用程序，但您需要查看您正在使用的模块，以确保您不依赖于 Azure 上尚不可用的工具或命令或其他工具。例如，您是否使用类似`redis`or`couchDB`或的数据库`mysql`？这些在 Azure 中本机不存在，因此您可能能够或可能无法移植该层——您必须检查。

由于您使用的是 Mac，因此还没有本机 OS X 部署工具。微软和 Cloud9 人员一直在展示一种从 Cloud9 IDE 部署 Mac 的方法，该方法可行，但随着时间的推移，Mac 的故事肯定会有所改善。我在 Mac 上工作，但我保持 Windows VM 处于打开状态（Parallels），如果我从桌面部署，我一直在使用[Windows Azure SDK for Node.js](http://www.windowsazure.com/en-us/develop/nodejs/)中的 Powershell cmdlet，这使得 Windows 的事情变得相当交钥匙。

您将需要关注几个 repos 及其贡献者： [Azure SDK for Node](http://github.com/windowsazure/azure-sdk-for-node)`npm install azure` ，它允许通过和[iisnode](http://github.com/tjanczuk/iisnode) （在 Github 上）本机访问 Azure 存储，这是一个帮助您的节点应用程序在 IIS（Windows Web 服务器）下运行的组件在 Azure 上。

很高兴看到 Azure 上的 Node 故事不断发展；现在还为时过早，但他们似乎正在迅速取得很大进展。

# php - 如何将 XML 数据解析为 PHP 变量

> ID：10586046
> 
> 赞同：3
> 
> 时间：2012-05-14T15:09:46.383
> 
> 标签：php, xml, parsing, geolocation

我对 php 很平庸，对 XML 很无知……如果你能详细说明，它将帮助我学习。

我正在尝试使用 PHP 编程来执行此链接的脚本... [http://ws.geonames.org/postalCodeSearch?postalcode=VARIABLE_ZIP&country=US](http://ws.geonames.org/postalCodeSearch?postalcode=VARIABLE_ZIP&country=US)。VARIABLE_ZIP 是输入到表单中的实际邮政编码，将在上面的链接中提交信息。该链接的输出会创建一个 XML 页面，我不想在我的网站上的任何位置显示该页面。

我想要做的是捕获 XML 数据纬度和经度值作为 php 中的变量并将它们存储到数据库中。

1）我有一个表格

2) 用户在表单中输入他们的邮政编码

3) 在提交表单时：我想要代码来捕获由添加了邮政编码变量的链接生成的 XML 数据：[http](http://ws.geonames.org/postalCodeSearch?postalcode=90210&country=US) ://ws.geonames.org/postalCodeSearch?postalcode=90210&country=US （我不想要这个页面显示在任何地方，我只想捕获数据）

4) 我想将这些变量带回 PHP，以便将它们存储在我的数据库中

*第 3 步对我来说是一个未知的过程。这是 XML 代码在单独页面上生成的内容...（我不希望显示页面）：

= = = = =

```
<geonames>
<totalResultsCount>1</totalResultsCount>
<code><postalcode>90210</postalcode>
<name>Beverly Hills</name>
<countryCode>US</countryCode>
<lat>34.09011</lat>
<lng>-118.40648</lng>
<adminCode1>CA</adminCode1>
<adminName1>California</adminName1>
<adminCode2>037</adminCode2>
<adminName2>Los Angeles</adminName2>
<adminCode3/><adminName3/>
</code>
</geonames> 
```

= = = = =

有人向我提供了以下内容，但我不确定如何执行它并解析我需要的变量：

```
<?php
$pc = $_POST['postalcode'];
$c = $_POST['country'];
$xml = file_get_contents("http://ws.geonames.org/postalCodeSearch?postalcode={$pc}&country={$c}");
file_put_contents("geopost_{$pc}_{$c}.xml",$xml);
?> 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T15:20:29.263

最好的办法是通过直接导航到链接（我使用自己的邮政编码和国家/地区）来查看 XML 的结构，然后使用 SimpleXMLElement 在树中导航以获取您需要的数据。此示例获取纬度和经度：

```
<?php
$pc = $_POST['postalcode'];
$c = $_POST['country'];
$xml = new SimpleXMLElement(file_get_contents("http://ws.geonames.org/postalCodeSearch?postalcode=".$pc."&country=".$c));
$lat = $xml->code->lat;
$lng = $xml->code->lng;
echo "Lat: $lat<br/>Lng: $lng";
?> 
```

这应该有助于您开始存储这些值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:13:33.997

[第 3 步是使用 PHP 处理 xml，这些简单 XML 示例](http://php.net/manual/en/simplexml.examples-basic.php)很好地概述了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T15:13:18.020

看看 PHPs [SimpleXML](http://se.php.net/manual/en/simplexml.examples-basic.php "简单XML")如何解析和读取接收到的 XML 数据。

# django - 干草堆搜索多个字段

> ID：10586050
> 
> 赞同：0
> 
> 时间：2012-05-14T15:09:55.537
> 
> 标签：django, django-haystack, whoosh

我目前正在 django 中构建一个页面，其中有 4 个表单字段、2 个文本、2 个选择字段，当提交时，它会获取这些字段并搜索多个模型以查找匹配项。

模型如下所示：

```
class Person(models.Model):
    user = models.ForeignKey(User, blank=True, null=True, verbose_name="the user associated with this profile")
    first_name = models.CharField(max_length=255)
    last_name = models.CharField(max_length=255)
    about = models.TextField(max_length=255, blank=True, null=True)
    birthdate = models.DateField(blank=True, null=True, verbose_name="Birthdate (yyyy-mm-dd)")
    GENDER_CHOICES = (
        (u'M', u'Male'),
        (u'F', u'Female'),
    )
    gender = models.CharField(max_length=1, choices = GENDER_CHOICES, default = 'M')
    picture = models.ImageField(upload_to='profile', blank=True, null=True)
    nationality = CountryField(blank=True, null=True)
    location = models.CharField(max_length=255, blank=True, null=True)
    command_cert = models.BooleanField(verbose_name="COMMAND certification")
    experience = models.ManyToManyField('userProfile.MartialArt', blank=True, null=True) 
```

我正在尝试搜索 first_name 字段、last_name 字段、nationality 字段和 experience 字段，但是如果 first_name 字段为空，我需要传递一个空值，以便它返回所有行，然后从那里过滤姓氏以同样的方式，由于某种原因，它对我来说根本不起作用。这是我的sqs：

```
results = SearchQuerySet().models(Person).filter(first_name=sname, last_name=slastname, nationality=scountry, experience__pk=sexperience) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:16:22.263

在没有看到特定错误或堆栈跟踪的情况下，很难确定什么“根本不起作用”。

编辑：查看您提供的视图代码，我将删除过滤器并返回您的 Fighter、Referee、Insider 和 Judge 模型的所有对象。这是为了确保这里的问题在于过滤器，而不是其他问题。

然后，一旦我确认对象被放入结果中，我会一次放入一个过滤器以确定有问题的过滤器是什么。试一试，然后回复您的结果。

# php - XMLHttpRequest 中的 UTF-8 字符已损坏

> ID：10586057
> 
> 赞同：1
> 
> 时间：2012-05-14T15:10:08.427
> 
> 标签：php, mysql, ajax, utf-8, xmlhttprequest

我正在使用一个`XMLHttpRequest`用于将一些行插入到 MYSQL 数据库中。我定义了相关的表列以接受 UTF-8 字符 ( `Collation: utf8_general_ci`)。

从请求发起的查询是：

```
INSERT INTO e4s_event_list (producerID, eventID, eventName, eventDescription, eventVenue, eventDate) 
VALUES('2', 'f49c104b-6193-47b7-b196-ca914e5238c4', 'בכורה מאת שרון אייל וטאבולה ראסה מאת אוהד נהרין', '', 'Conversion Venue - 0', '2012-06-04T20:30:00') 
```

如果我从列中查询此`phpMyAdmin`值`eventDescription`，则可以毫无问题地获得所需的值。但是，当从 启动查询时`XMLHttpRequest`，该`eventDescription`列将获得以下值：

`×‘×›×•×¨×” ×ž××ª ×©×¨×•×Ÿ ××™×™×œ ×•×˜××‘×•×œ×”..`

我目前的标题是：

```
XMLHttpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
XMLHttpRequest.setRequestHeader("Content-length", params.length);
XMLHttpRequest.setRequestHeader("Connection", "close"); 
```

我试图更改`Content-Type`为：

```
XMLHttpRequest.setRequestHeader("Content-Type", "text/plain;charset=UTF-8"); 
```

但是，由于某种原因，该请求根本不起作用。

我知道这不是数据库定义问题，因为不是从 an 发起的所有其他查询`XMLHttpRequest`都**没有**被搞砸。

如何正确插入希伯来语字符？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:19:02.743

MySQL 可能认为 PHP 将字符串作为另一种字符编码（例如 ISO-8859-1）传递。如果是这种情况，您可以通过在将数据写入数据库之前将此查询发送到 MySQL 来解决此问题：

```
SET NAMES=UTF8; 
```

# django - 将夹具加载到 django 中的多个数据库中

> ID：10586058
> 
> 赞同：1
> 
> 时间：2012-05-14T15:10:13.780
> 
> 标签：django, integration-testing, multiple-databases

我有一个使用两个数据库的网站。我按照 django 文档中的说明设置了路由器。当我使用 runserver 时，路由工作正常。但是我无法使用 LiveServerTestCase 对其进行测试。查询集为空。我假设固定装置没有正确加载到第二个数据库中。如果我删除数据库路由器（因此只使用一个 db），测试就可以工作。

这是我的路由器配置：

```
class ScreenerRouter(object):
    def db_for_read(self, model, **hints):
        if model._meta.app_label == 'screener':
            return 'filemaker'
        return None

    def db_for_write(self, model, **hints):
        if model._meta.app_label == 'screener':
            return 'filemaker'
        return None

    def allow_relation(self, obj1, obj2, **hints):
        if obj1._meta.app_label == 'screener' or obj2._meta.app_label == 'screener':
            return True
        return None

    def allow_syncdb(self, db, model):
        if db == 'filemaker':
            return model._meta.app_label == 'screener'
        elif model._meta.app_label == 'screener':
            return False
        return None 
```

我在 TestCase 中设置了 multi_db = True 。

另一个问题是 dumpdata --database=filemaker screener.ScreenerRouter 返回一个空数组，即使数据库中有条目。我什至可以在 DjangoAdmin 中编辑它们。我不得不将数据复制到默认数据库并从那里转储。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T18:35:12.387

我解决了这个问题。我有多个需要访问“filemaker”数据库的应用程序，每个应用程序都有自己的路由器。路由器按顺序处理。但是第一个路由器的 allow_syncdb 方法已经返回了一个值，该值阻止了所有其他应用程序的 syncdb 和 dumpdata。

解决方案是为 filemaker db 编写一个 MasterRouter 并将所有应用程序放在那里。如：

```
if obj1._meta.app_label in ['app1', 'app2']:
    return 'filemaker' 
```

# c++ - 线程池可以用于生产吗？如果没有，是否有任何替代库？

> ID：10586066
> 
> 赞同：1
> 
> 时间：2012-05-14T15:10:26.137
> 
> 标签：c++, multithreading

我正在将一些 Java 代码移植到 C++，并希望找到一些像 Java 的`ThreadPoolExecutor`. 我看到了一些建议[线程池](http://threadpool.sourceforge.net/)的帖子，但是在阅读了其他一些论坛后，我阅读了有关问题（[内存泄漏](http://www.cplusplus.com/forum/general/56971/)等）并浏览了[代码库](http://threadpool.cvs.sourceforge.net/viewvc/threadpool/threadpool/)，我看到最后一次更新是在 3 年前。所以我的问题是，我没有完全跟上速度来制作我自己的线程池库，但我不想使用没有积极维护的东西。

环顾四周，有一些线程池项目，但它们似乎并没有被大量使用（我基于 github/code.google 上的家庭最爱/手表）。我想知道其他人在生产环境中使用什么线程池？我正在寻找两种类型的线程池，一种是固定的，一种是动态增长的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T09:38:54.323

哪个平台？如果windows和[ppl](http://msdn.microsoft.com/en-us/library/dd492427.aspx)可以使用Visual C++编译器，那么
看看创建任务的方法`task_group`和方法。[英特尔 TBB](http://threadingbuildingblocks.org/)是 另一种选择。 `make_task`

如果您可以使用 boost，那么[boost 并发编程 API](https://github.com/boost-vault/Concurrent-Programming) 会很有用。

# image - 如何在visualforce页面中为图像标签的id属性赋值？

> ID：10586071
> 
> 赞同：1
> 
> 时间：2012-05-14T15:10:49.897
> 
> 标签：image, dynamic, salesforce

我无法为图像动态分配 id 值...我引用此图像 javascript 以相应地显示向上/向下箭头...这是代码片段...

```
<apex:variable var="count" value="{!1}"/>
<apex:image id="msn{!count}" url="{!URLFOR($Resource.style_resources, 'images/up-arrow.gif')}" alt="Open-close" /> 
```

但我收到编译错误，因为“id 需要文字值”...

我们不能动态分配 id 属性的值吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-07-20T15:11:12.177

从[Apex 图像](http://%3Capex:image%20id=%22theImage%22%20value=%22/img/myimage.gif%22%20width=%22220%22%20height=%2255%22/%3E)，

```
<apex:image id="theImage" value="/img/myimage.gif" width="220" height="55"/> 
```

*上面的示例呈现以下 HTML：*

```
<img id="theImage" src="/img/myimage.gif" width="220" height="55"/> 
```

所以改变

```
<apex:image id="msn{!count}" url="{!URLFOR($Resource.style_resources, 'images/up-arrow.gif')}" alt="Open-close" /> 
```

至

```
<img id="msn{!count}" src="{!URLFOR($Resource.style_resources, 'images/up-arrow.gif')}" alt="Open-close" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:53:19.237

你是对的，你不能动态分配元素 id。它必须是字符串文字。然而，我使用了 class 属性来创建以后可以在 javascript 中使用的自定义 id。我用 jQuery 来做这件事，它是强大的选择器，可以根据标签类型和类来选择元素。

下面的示例只是一个示例，但是使用 jQuery，您可以获得非常有创意的东西。

```
<apex:variable var="count" value="{!1}"/>
<apex:image id="msn" 
    url="{!URLFOR($Resource.style_resources, 'images/up-arrow.gif')}" 
    alt="Open-close"
    styleClass="msn{!count}" />

    <apex:includeScript value="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"/>

    <script>
        jQuery.noConflict();

        function doSomethingWithImg() {
            try {
                var imgElement = jQuery('.msn1');

                /*Do what you need to do with the element*/
            } catch (e) { /*Ignore Error*/ }
        }
     </script> 
```

这是 jQuery 选择器的链接：[jQuery 选择器文档](http://api.jquery.com/class-selector/)

# sql-server-2008 - 除了 ISDATE 之外，检查 LEN 和 ISNULL 有用吗？

> ID：10586072
> 
> 赞同：1
> 
> 时间：2012-05-14T15:10:52.227
> 
> 标签：sql-server-2008

我正在查看存储过程并看到许多行，例如：

```
case when len(isnull(INVOICE.INVOICE_DATE,'')) > 0 
      and isdate(INVOICE.INVOICE_DATE) = 1 
    then convert(datetime,INVOICE.INVOICE_DATE)
    else null end 
```

和

```
case when len(isnull(SHIPMENT.NET_AMOUNT_DUE,'')) > 0 
      and isnumeric(SHIPMENT.NET_AMOUNT_DUE) = 1
   then convert(money,SHIPMENT.NET_AMOUNT_DUE) 
   else null end 
```

我不明白为什么`ISNULL`和`LEN`检查总是在那里。我缺少一些好处吗？相反，代码当前的编写方式是否有任何损害？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T15:14:11.217

`LEN`不需要和检查`ISNULL`。

`ISDATE`如果值为或为空，`ISNUMERIC`将返回 a ，所以这不是必需的。可能有人特别小心...`0``NULL`

这些可以写成：

```
case when ISDATE(INVOICE.INVOICE_DATE) = 1 
    then convert(datetime,INVOICE.INVOICE_DATE)
    else null end 
```

和：

```
case when ISNUMERIC(SHIPMENT.NET_AMOUNT_DUE) = 1
   then convert(money,SHIPMENT.NET_AMOUNT_DUE) 
   else null end 
```

# c++ - Valgrind 不报告“删除数组”的内存泄漏

> ID：10586076
> 
> 赞同：1
> 
> 时间：2012-05-14T15:11:10.317
> 
> 标签：c++, memory-leaks, valgrind, delete-operator

在实现了下面的 C++ 代码之后，我跑来`valgrind --leak-check=full`检查是否有任何内存泄漏。结果是**退出时使用了 0 个字节，**并且 **不可能发生泄漏**。

但是，后来我发现我忘记了使用`delete[] x`，而不仅仅是`delete x`在析构函数内部。

我搜索了一些解释（例如：[C++ 中的 delete vs delete[] 运算符](https://stackoverflow.com/questions/2425728/delete-vs-delete-operators-in-c "C++ 中的 delete vs delete[] 运算符")），我读到的所有内容都说使用`delete`without`[]`会导致内存泄漏，因为它只调用数组中第一个对象的析构函数。

我将代码更改为 delete[] 并且 valgrind 输出是相同的（如预期的那样）。但现在我很困惑：**“valgrind 有问题吗，或者`delete`即使没有操作符，数组真的可以正常工作`[]`？”**

```
#include <iostream>
#include <string.h>
using namespace std;
class Foo {
  private: char *x;
  public:
    Foo(const char* px) {
       this->x = new char[strlen(px)+1];
       strcpy(this->x, px);
    }
    ~Foo() {
       delete x;
    }
    void printInfo() {  cout << "x: " << x << endl;  }
};
int main() {
   Foo *objfoo = new Foo("ABC123");
   objfoo->printInfo();
   delete objfoo;
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T15:12:41.057

**使用不带 [] 的 delete 会导致内存泄漏。**

不，它会导致**Undefined Behavior**。

您分配使用`new []`和取消分配使用的程序`delete`具有未定义的行为。实际上，您很幸运（相当不幸）它没有表现出一些奇怪的行为。

作为旁注，您还需要为您的班级遵循**[三原则。](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)**目前，您不这样做，并且在不久的将来会找麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T15:44:45.730

`delete`和之间的主要区别`delete[]`不是关于内存释放，而是关于析构函数调用。

虽然形式上是**未定义的行为**，但实际上它或多或少会起作用……除了`delete`只会调用第一项的析构函数。

作为旁注，您可能会遇到一个问题：

```
#include <iostream>

struct A{
  ~A() { std::cout << "destructor\n"; }
};

int main() {
  A* a = new A[10];
  delete a;
} 
```

有一点像：

```
*** glibc detected *** ./prog: munmap_chunk(): invalid pointer: 0x093fe00c ***
======= Backtrace: =========
/lib/libc.so.6[0xb759dfd4]
/lib/libc.so.6[0xb759ef89]
/usr/lib/gcc/i686-pc-linux-gnu/4.3.4/libstdc++.so.6(_ZdlPv+0x21)[0xb77602d1]
./prog(__gxx_personality_v0+0x18f)[0x8048763]
./prog(__gxx_personality_v0+0x4d)[0x8048621]
======= Memory map: ======== 
```

[在ideone](http://ideone.com/k7ykD)看到它。

# python - Python 中的 KNX 和 KNXnet/IP 实现

> ID：10586080
> 
> 赞同：3
> 
> 时间：2012-05-14T15:11:15.283
> 
> 标签：python, home-automation, knx

[对于任何与 Python 中的KNX](http://en.wikipedia.org/wiki/KNX_%28standard%29)实现相关的东西，尤其是 KNXnet/IP，我都在寻找高低。到目前为止，我找不到任何东西。我知道很少有项目是用 Java 编写的，但我想在开始从其他语言移植代码之前先在这里试一试。

另外，有人知道 KNX 标准、其数据结构和 KNXnet/IP 的任何免费文档吗？KNX 协会的官方文档非常昂贵，尤其是对于应该是“开放”标准的东西。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T14:39:28.740

有用于 KNX 的开源[BCUSDK](http://sourceforge.net/projects/bcusdk/)软件堆栈，它有一个基于 C 的系统守护程序 ( [eibd](http://www.auto.tuwien.ac.at/~mkoegler/index.php/eibd) )，带有用于多种语言的客户端（基于 Unix 和 TCP-socket）（Python 就是其中之一）。我还编写了[Ruby](https://github.com/ekarak/eibd_ruby)和[Lua](https://github.com/ekarak/eibd_lua)客户端库，并且我将它用于日常使用 KNX 进行黑客攻击。

此外，还有[OpenRemote](http://openremote.org)，其中包含大量关于 KNXnet/IP 和一些 Java 类的信息，如果您愿意，可以从头开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T14:43:38.880

KNX 协会已经发布了 Falcon Runtime Developer 工具包，但我认为只有 KNX 会员才能获得它。它不支持 Python，但嘿，我猜是它。

关于文档，我可能会有所帮助。这个网站上是否有 PM 功能或有什么东西可以给我你的电子邮件地址？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-07-05T13:42:54.587

你可能想看看这个（如果到那时你还在寻找这样的库）：[https](https://github.com/leadrien/knxnet) ://github.com/leadrien/knxnet 这让我可以通过 IP/KNX 接口很好地控制 KNX 设备.

亚历山大

# java - 带有子对象的 pojo 的 JSON 序列化

> ID：10586083
> 
> 赞同：2
> 
> 时间：2012-05-14T15:11:20.297
> 
> 标签：java, json, serialization, jersey

假设我有一个带有以下接口的宁静网络服务：

```
GET /some/parent 
```

这将返回类似

```
[
    {
        urn: "/some/parent/1",
        name: "parent1",
        children: [ "/some/child1", "/some/child2" ]
    },
    {
        urn: "/some/parent/2",
        name: "parent2",
        children: [ "/some/child3", "/some/child4" ]
    }
] 
```

而且，我有

```
GET /some/parent/{id} 
```

返回如下内容：

```
{
    urn: /some/parent/1,
    name: parent1,
    children: [
        {
            urn: "/some/child1",
            name: "child1"
        },
        {
            urn: "/some/child2",
            name: "child2"
        }
    ]
} 
```

因此，当请求父母列表时，每个父母的 json 表示将与孩子骨灰盒一起列出。当请求特定的父资源时，json 表示将包含一个子 json 表示的列表。

使用 jersey 的常用方法是定义两个简单的 java pojo 和一个简单的资源：

```
public class Parent {
    private String id;
    private String name;
    private List<String> childIds;
    ...
    @JsonIgnore
    public String getId()...
    @JsonProperty
    public String getUrn()...
}

public class Child {
    private String id:
    private String name;
    ...
    @JsonIgnore
    public String getId()...
    @JsonProperty
    public String getUrn()...
}

@Path("/some/parent")
@Produces(MediaType.APPLICATION_JSON)
public class ParentResource() {
    @GET
    public List<Parent> findAll() {
        List<Parent> result = // some database query call
        return result;
    }

    @GET
    @Path("{id}")
    public Parent find(@PathParam("id") String id) {
        Parent parent = // some database call
        return parent;
    }
} 
```

如何在上述情况下注入子骨灰盒/对象？有没有最佳实践？你如何解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T09:25:48.323

在这种情况下，我宁愿做一个像这样的扩展父类：

```
public class ParentExtended extends Parent {
    private List<Child> childrenObjects;

    public ParentExtended(Parent parent) {
        this.id = parent.getId();
        ...
    }

    @JsonProperty("children")
    public List<Child> getChildrenObjects() { ... }

    @Override
    @JsonIgnore
    public List<String> getChildren() { ... }
}

@Path("/some/parent")
@Produces(MediaType.APPLICATION_JSON)
public class ParentResource() {
    @GET
    public List<Parent> findAll() {
        List<Parent> result = // some database query call
        return result;
    }

    @GET
    @Path("{id}")
    public ParentExtended find(@PathParam("id") String id) {
        Parent parent = // some database call
        ParentExtended parentEx = new ParentExtended(parent);

        for (String childId : parent.getChildren()) {
            parentEx.getChildrenObjects().add(// fetch the child object);
        }
        return parentEx;
    }
} 
```

这不是一个很好的方法。我对其他选择持开放态度...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T02:58:59.740

您不会将子 ID 存储在父对象中，而是将子对象列表存储为对象...

```
public class Parent {
    private String id;
    private String name;
    private List<Child> children;
    ...
    @JsonIgnore
    public String getId()...
    @JsonProperty
    public String getUrn()...
} 
```

# cuda - 写入数据时性能损失巨大

> ID：10586085
> 
> 赞同：0
> 
> 时间：2012-05-14T15:11:23.197
> 
> 标签：cuda

我在我的代码中对 float* 内存块进行了一些计算。由于我正在处理图像，因此我必须使用宽度 * 高度点和 180 次旋转来执行此操作。我正在启动 180 个线程（每度旋转 1 个），因为这是代码中唯一可并行化的过程。我旋转图像，并为每次旋转获取每个点的结果浮点值。我有另一个 float* 块，它存储每个点的当前最大值。

```
if(resultMap[i] < convrst)
{
    resultMap[i] = convrst;
    rMap[i] = (unsigned char)r0;
    oMap[i] = (unsigned char)index;
} 
```

使用 resultMap 存储当前的最大值。convrst 是卷积的结果，如果当前结果高于之前的结果，则保存该值，加上该点的半径（r0）和旋转（索引）。r0 最初是一个 int，以及索引。i 是一个从 0 到 imgsize-1 的计数器

如果没有 { } 部分中的分配，整个代码将在 2 秒内完成，而分配则需要 50 秒（这没有考虑到在该代码中我省略了锁以避免同步问题）。

为什么该代码这么慢，我该怎么做才能让它更快完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:10:01.670

当您在内核中包含写入时大幅减速的原因与[此问题](https://stackoverflow.com/q/10494326/681865)相同（尽管它与 OpenCL 相关，但原理相同）。NVIDIA 编译器非常积极地优化掉“死”代码，即对共享内存或全局内存写入没有贡献的代码。所以我猜当你不包括对全局内存的写入时，如你的问题所示，编译器只是在优化大量内核，大大减少了执行时间。

所以，就像我链接的另一个问题一样，真正的问题应该是为什么你的内核需要 50 秒才能完成。这将需要有关代码和调用它的执行参数的更多信息，但如果如您所写，您只运行 180 个线程，那可能是罪魁祸首。GPU 需要更多的并行性才能实现峰值性能。

# vb.net - VB.Net HTTPWebRequest 登录 403 错误

> ID：10586095
> 
> 赞同：1
> 
> 时间：2012-05-14T15:12:09.380
> 
> 标签：vb.net, http, httpwebrequest, webrequest

我正在尝试通过 VB.Net 中的 Web 请求登录网站（“https://instagram.com/”）。我的凭据是正确的，并且我正确获取了所需的令牌，但是在登录时返回了 403 HTTP 错误。我当前的代码，包括我的 POST/GET 函数，可以在下面找到。

> POST_ERROR：远程服务器返回错误：（403）禁止。

代码：

```
Imports System.Net
Imports System.IO
Imports System.Text

Module Main
    Dim Token$ = ""
    Dim myCookie As New CookieContainer

    Private Sub UpdateToken(ByVal Page$)
        Token = GetBetween(Page, "csrfmiddlewaretoken" & Chr(34) & " value=" & Chr(34), Chr(34) & "/>")
    End Sub

    Private Function GETreq(ByVal URL$)
        Try
            Dim tempCookie As New CookieContainer
            Dim Request As HttpWebRequest = TryCast(WebRequest.Create(URL), HttpWebRequest)
            Request.Method = "GET"
            Request.CookieContainer = myCookie
            Request.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:12.0) Gecko/20100101 Firefox/12.0"
            Request.KeepAlive = True

            Dim Response As HttpWebResponse = Request.GetResponse()
            Dim ResponseStream As Stream = Response.GetResponseStream()
            Dim StreamReader As New StreamReader(ResponseStream)
            Dim Text$ = StreamReader.ReadToEnd()

            tempCookie.Add(Response.Cookies)
            myCookie = tempCookie

            Return Text
        Catch ex As Exception
            Console.ForegroundColor = ConsoleColor.Gray
            Console.WriteLine("GET_ERROR: " & ex.Message)
            Return ""
        End Try
    End Function

    Private Function POSTreq(ByVal URL$, ByVal Data$)
        Try
            Dim tempCookie As New CookieContainer
            Dim DataBytes As Byte() = Encoding.ASCII.GetBytes(Data)
            Dim Request As HttpWebRequest = TryCast(WebRequest.Create(URL), HttpWebRequest)
            Request.Method = "POST"
            Request.ContentType = "application/x-www-form-urlencoded"
            Request.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:12.0) Gecko/20100101 Firefox/12.0"
            Request.ContentLength = DataBytes.Length
            Request.CookieContainer = myCookie
            Request.KeepAlive = True

            Dim PostData As Stream = Request.GetRequestStream()
            PostData.Write(DataBytes, 0, DataBytes.Length)
            PostData.Close()

            Dim Response As HttpWebResponse = Request.GetResponse()
            Dim ResponseStream As Stream = Response.GetResponseStream()
            Dim StreamReader As New StreamReader(ResponseStream)
            Dim Text$ = StreamReader.ReadToEnd()

            tempCookie.Add(Response.Cookies)
            myCookie = tempCookie

            Return Text
        Catch ex As Exception
            Console.ForegroundColor = ConsoleColor.Gray
            Console.WriteLine("POST_ERROR: " & ex.Message)
            Return ""
        End Try
    End Function

    Public Function GetBetween(ByRef strSource$, ByRef strStart$, ByRef strEnd$, Optional ByRef startPos As Integer = 0) As String
        Try
            Dim iPos As Integer, iEnd As Integer, lenStart As Integer = strStart.Length
            Dim strResult$

            strResult = String.Empty
            iPos = strSource.IndexOf(strStart, startPos)
            iEnd = strSource.IndexOf(strEnd, iPos + lenStart)
            If iPos <> -1 AndAlso iEnd <> -1 Then
                strResult = strSource.Substring(iPos + lenStart, iEnd - (iPos + lenStart))
            End If
            Return strResult
        Catch ex As Exception
            Return ""
        End Try
    End Function

    Sub Main()
        Dim Username$ = "XXX"
        Dim Password$ = "XXX"

        UpdateToken(GETreq("https://instagram.com/accounts/login/"))
        UpdateToken(POSTreq("https://instagram.com/accounts/login/", String.Format("csrfmiddlewaretoken={0}&username={1}&password={2}", Token, Username, Password)))

        Console.ReadLine()
    End Sub

End Module 
```

# .net - 如何在 Excel 中更新图表缓存数据

> ID：10586098
> 
> 赞同：1
> 
> 时间：2012-05-14T15:12:31.570
> 
> 标签：.net, openxml-sdk

我有一个 Excel 电子表格，它会更新并使用 openXML(c#) 生成图表。生成的 excel 图表必须在 powerpoint 中更新。除非我打开 excel 文件并手动保存，否则我无法将更新的图表复制到 powerpoint。

我想知道如何更新图表和基础数据（缓存数据），而无需手动打开和保存 excel 文件

任何帮助/建议都是有价值的。

# java - java - 如何在Java中的同一网络上创建服务器和客户端之间的同时连接？

> ID：10586099
> 
> 赞同：1
> 
> 时间：2012-05-14T15:12:33.170
> 
> 标签：java, multithreading, networking

我正在尝试为我的计算机科学决赛创建一个 MapleStory 类型的游戏。它基本上是通过 LAN 播放的 2D 角色扮演游戏。我的问题是如何让两台计算机之间的连接同时进行？

```
 class MagicServer extends Thread
    {
       private ServerSocket serverSocket;

       public MagicServer(int port) throws IOException
       {
          serverSocket = new ServerSocket(port);
          //serverSocket.setSoTimeout(10000);
       }

       public void run()
       {
          Scanner kb = new Scanner(System.in);
          while(true)
          {
             try
             {
                System.out.println("Waiting for client on port " + serverSocket.getLocalPort() + "...");
                Socket server = serverSocket.accept();

                System.out.println("Just connected to " + server.getRemoteSocketAddress());

                DataInputStream in = new DataInputStream(server.getInputStream());
                DataOutputStream out = new DataOutputStream(server.getOutputStream());

                System.out.println(in.readUTF());

                for(int i=0; i<5; i++)
                {
                    System.out.println(in.readUTF());
                    out.writeUTF(kb.nextLine());
                }

                server.close();

             }

             catch(SocketTimeoutException s)
             {
                System.out.println("Socket timed out!");
                break;
             }

             catch(IOException e)
             {
                e.printStackTrace();
                break;
             }
          }
       }
       public static void main(String [] args)
       {
          int port = 2001;
          try
          {
             Thread t = new MagicServer(port);
             t.start();
          }catch(IOException e)
          {
             e.printStackTrace();
          }
       }
    } 
```

我正在试验这个，我只能在两台计算机之间按顺序发送/接收消息（即服务器发送到客户端，然后客户端发送到服务器），我不能乱序。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:54:00.543

您必须通过使用多个线程或通过互锁队列来分离您的读/写来管理您的工作。

在循环中，您通过在代码中执行读取然后写入来强制序列化。

没有理由不能生成一个读取器线程，该线程馈入队列以执行工作线程的工作，而写入发生在另一个线程上。您只需要在工作队列上进行同步。

您还可以轮询套接字以查看是否有任何数据可供读取，如果没有，则发送任何等待写入的数据。

有更多奇特的方法可以做到这一点，还有很多例子，四处搜索，看看你喜欢什么。

[这里](https://stackoverflow.com/questions/5190895/java-share-data-between-thread)有一个类似的线程

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-14T15:28:53.067

您可以使用多个线程在一个端口的一个线程中以一种方式连接，在另一个线程的不同端口上以另一种方式连接。但是，这可能会引入一些同步问题，因此我建议重新考虑您的设计，以便一次只需要在一个方向上进行通信（如果需要，您可以随意来回切换）。

# jquery - Spring控制器中json数组的奇怪反序列化

> ID：10586102
> 
> 赞同：1
> 
> 时间：2012-05-14T15:12:44.123
> 
> 标签：jquery, ajax, json, spring, serialization

我正在使用带有注释控制器方法的 Spring 3.1.1，如下所示：

```
@RequestMapping(value = "/my/url", method = RequestMethod.POST)
public @ResponseBody Response<SomeModel>
doStuff(HttpServletRequest request, @RequestParam List<String> ids) 
```

我用 jQuery 发布到这个：

```
$.post('/my/url', 
            {ids: JSON.stringify($ids.get())},
            function(response) {
                alert(response);
            }, 'json'); 
```

如果我查看浏览器的流量，似乎还可以：

```
ids:["770409362","771999003","775080915","775119397","775831772"] 
```

`List<String>`但是我得到的 Java在第一个和最后一个元素中添加了额外的 [ 和 ]：

```
[["770409362", "771999003", "775080915", "775119397", "775831772"]] 
```

并且报价仍然存在。

我不知道如何摆脱它。非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:27:17.580

发布后几秒钟找到了 join() 方法：

[http://www.w3schools.com/jsref/jsref_join.asp](http://www.w3schools.com/jsref/jsref_join.asp)

所以我做了

```
{ids: $ids.get().join()} 
```

这给了我

```
ids:133753573,1198385893,1513233125,12117275 
```

相反，哪个有效。然而，这似乎不是正确的方法。真的想要某种最佳实践的 Spring/jQuery 方法吗……？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T19:32:01.397

尝试 在服务器端使用`@RequestBody List<String> ids`而不是。`@RequestParam List<String> ids`

# dotnetnuke - 如何通过 DNN 皮肤安装添加新目录？

> ID：10586106
> 
> 赞同：0
> 
> 时间：2012-05-14T15:12:50.130
> 
> 标签：dotnetnuke, manifest

如何在皮肤安装时向 DNN 添加新目录？是通过清单中的引用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T00:54:20.203

是的，您可以通过清单文件创建一个新目录。这适用于模块、皮肤——任何使用清单文件的东西。

您将需要在清单文件中使用 fileComponent，特别是 basePath 元素，以指定您的文件将安装在网站的哪个位置。您也可以安装在相对路径中。

在此处查看更多信息：http: [//www.dotnetnuke.com/Resources/Wiki/Page/Manifest-File-Component.aspx](http://www.dotnetnuke.com/Resources/Wiki/Page/Manifest-File-Component.aspx)

# emacs - 使用行号、emacs 进行动态全局替换

> ID：10586107
> 
> 赞同：3
> 
> 时间：2012-05-14T15:12:52.480
> 
> 标签：emacs

我正在尝试对一些 Prolog 代码进行一些调试，并且我对一个方法进行了多次调用。

是否可以在 emacs 中进行全局替换，以便我可以创建一个写入语句来替换程序中的当前行？

本质上，假设一个方法调用 X 和一个 write 语句 write(some string)，我可以替换所有的实例吗

X，

和

X，写（行号）

LINE-NUMBER 是通过一些 emacs 调用获得的？

如果我不清楚，请让我知道并提前感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:56:07.363

[这个页面](http://steve-yegge.blogspot.com/2006/06/shiny-and-new-emacs-22.html) 有一个类似的例子。

从中，我尝试了以下命令

```
M-x replace-regexp
Replace regexp: \(word_to_replace\)
Replace regexp with: \1, write(\,(line-number-at-pos) 
```

可能会很笨拙，因此`replace-regexp`您必须小心用于该模式的正则表达式。 `M-x query-replace-regexp`如果没有太多匹配项，也可能很有用。

# ruby - char（又名字符）字段类型的数据映射器类型

> ID：10586109
> 
> 赞同：0
> 
> 时间：2012-05-14T15:12:58.470
> 
> 标签：ruby, ruby-on-rails-3, postgresql, orm, ruby-datamapper

我正在使用一个开源数据库。我正在尝试使用 DataMapper 将其映射到类，稍后我将更改模型驱动的近似值，而不是数据库驱动的近似值。

但首先我想以精确的方式映射开源数据库。该数据库是 PostgreSQL 数据库，在某些表中有些字段具有`character`类型。

如何`character`在 DataMapper 中映射类型？这种类型既不是[原始类型](http://rubydoc.info/github/datamapper/dm-core/master/DataMapper/Property)，也不是 in [`dm-types`](http://datamapper.org/docs/dm_more/types.html)，也不是 in [`dm-types-legacy`](https://github.com/postmodern/dm-types-legacy/)。

如果它提供更多信息，实际上我不是手动编写模型，而是使用[`dm-is-reflective`](https://github.com/godfat/dm-is-reflective)自动映射现有数据库表的模型。它给了我以下错误：

```
/var/lib/gems/1.9.1/gems/dm-is-reflective-1.0.0/lib/dm-is-reflective/is/adapters/data_objects_adapter.rb:141:in `reflective_lookup_primitive': bpchar not found for DataMapper::Adapters::PostgresAdapter (TypeError) 
```

**编辑** 这是核心问题`dm-is-reflective`而不是`datamapper`核心问题，它可以很好地与`char`类型一起作为`String`具有长度集的类型。我回答问题的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T15:54:46.767

教父，工作的人`dm-is-reflective`很快解决了这个问题:) 非常感谢他！

[https://github.com/godfat/dm-is-reflective/issues/3#issuecomment-5726650](https://github.com/godfat/dm-is-reflective/issues/3#issuecomment-5726650)

# iphone - 按钮不会添加到视图

> ID：10586111
> 
> 赞同：0
> 
> 时间：2012-05-14T15:13:02.343
> 
> 标签：iphone, objective-c, ios, xcode, for-loop

我想创建一个有 4 个按钮的行，循环正在做它应该做的事情，并且它只输入了 4 次 if 语句，但是当视图弹出时，我只能看到一个按钮。

这是为什么？难道我做错了什么？

```
btnFrame = 18;
for (int i = 0; i < [arrImages count]; i++)
{
    if (btnFrame <= 237)
    {
        NSLog(@"%i",btnFrame);
        UIButton * tempBtn = [UIButton buttonWithType:UIButtonTypeCustom];
        tempBtn.frame = CGRectMake(btnFrame, 20, 65, 65);
        [tempBtn setTitle:[NSString stringWithFormat:@"Button%i",i] forState:UIControlStateNormal];
        [self.view addSubview:tempBtn];
        btnFrame = btnFrame + 73;
    }
} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:25:42.600

我认为当你的 viewWillDisappear 那时这个视图将被清除，所以做下面的事情......

```
-(void)viewWillAppear:(BOOL)animated
{
   [self SetButton];    
}

-(void)setButton{

btnFrame = 18;
    for (int i = 0; i < [arrImages count]; i++)
    {
        if (btnFrame <= 237)
        {
            NSLog(@"%i",btnFrame);
            UIButton * tempBtn = [UIButton buttonWithType:UIButtonTypeCustom];
            tempBtn.frame = CGRectMake(btnFrame, 20, 65, 65);
            [tempBtn setTitle:[NSString stringWithFormat:@"Button%i",i] forState:UIControlStateNormal];
            [self.view addSubview:tempBtn];
            btnFrame = btnFrame + 73;
        }
    }
} 
```

希望这对你有帮助.... :)

# iphone - 将设备添加到配置文件后，您是否必须重新归档项目？

> ID：10586114
> 
> 赞同：2
> 
> 时间：2012-05-14T15:13:08.130
> 
> 标签：iphone, ios, xcode, ipad, provisioning-profile

假设您有一些设备的现有配置文件，并且您使用该配置文件归档目标。然后，您进入会员中心并将更多设备添加到配置文件中。您是否必须重新下载/重新归档项目才能让这些设备安装目标应用程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T15:31:14.980

不，只要配置文件的名称相同，您现在就可以将包含它的应用程序分发到新设备，只要新设备获得包含其设备 ID 的配置文件。

编辑：进一步解释的说明。您的存档应用程序不会将配置文件存储在其存档中。您只需告诉它要查找的配置文件，以确定它是否可以在特定设备上运行。因此，您可以随心所欲地更改您的配置文件，只要它与应用程序被告知要查找的配置文件相同，您就不必重新编译应用程序来识别新设备。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T15:30:24.403

是的，如果不是 - 以前的配置文件如何知道您添加了更多设备？

您必须删除管理器中的旧配置文件，然后您需要重新下载配置有新设备的相同配置文件。

注意：安装新配置文件后，不要忘记检查项目设置中的代码签名。

```
 (OR) 
```

如果您已经在系统中配置了 iOS 开发者网络配置文件，

只需按组织者右下角的刷新按钮

![在此处输入图像描述](../Images/63dafe881e3b8549b83d35ccaef4317a.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:25:09.797

是的，必须将新配置文件内置到您的应用程序中才能与添加的设备一起使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:40:30.397

您必须再次下载配置文件（或让 XCode 为您完成工作）。

您不必重新归档。只需与新的/更新的配置文件共享现有的存档但再次签名。

# jquery - 问题阅读下拉框文本

> ID：10586121
> 
> 赞同：0
> 
> 时间：2012-05-14T15:13:24.493
> 
> 标签：jquery, asp.net

我正在尝试检查下拉框的选定值是否“请选择..”我需要显示相关的警报消息说请选择，但即使我从下拉框中选择“ETF太大”我仍然得到提示框说请选择。有人可以在下面纠正我的错误，因为我看不到哪里出错了。当我将鼠标悬停在变量上`Diarised`时，它会从下拉列表中向我显示相关的选定文本，但它仍然会给我警报框。

```
var Diarised = $('[id*=drpDiarisedReason] :selected').text();
                    if (Diarised == "Please Select..");
                    {
                        alert('Please Select Diarised Reason');
                        return false;
                    } 
```

这是我的 HTML

```
<select id="drpDiarisedReason">
        <option value="">Please Select..</option>
        <option value="1">ETF Too Big</option>
        <option value="2">Equipment Cost</option>
        <option value="3">Spend Too Little</option>
    </select> 
```

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:22:29.280

```
if ($('#drpDiarisedReason').val()=== "")
{
    alert('Please Select Diarised Reason');
    return false;
} 
```

[在此处](http://jsfiddle.net/nanoquantumtech/7SFH8/)查看演示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:27:29.247

尝试类似的东西

```
var text = $('#drpDiarisedReason').val(); 
```

阅读更多关于[.val()](http://api.jquery.com/val/)

# .net - WinDbg 在崩溃时创建转储文件？

> ID：10586122
> 
> 赞同：4
> 
> 时间：2012-05-14T15:13:26.937
> 
> 标签：.net, debugging, windbg, dump

我们的应用程序出现异常。使用 Dr.Watson 我们没有捕获任何 dmp 以及日志文件。有人告诉我，WinDbg 是在程序异常/崩溃时创建转储文件的替代方法。谷歌搜索后，我遇到了一堆混乱。首先，我想确认是否可以在 WinDbg 的帮助下创建转储文件。其次，是否有任何推荐的简单命令行将 WinDbg 附加到应用程序以在其崩溃时获取转储文件？非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T20:29:00.373

在这种情况下，我们通常建议我们的用户下载[procdump](http://technet.microsoft.com/en-us/sysinternals/dd996900)（可以直接从 zip 文件中提取，无需安装），然后我们给他们一个包含如下内容的批处理文件：

```
mkdir c:\dumps
procdump -e -c 10 -w myprocess.exe c:\dumps 
```

当进程生成未处理的异常时，它将在`c:\dumps`您可以加载到 Visual Studio 或 Windbg 的目录中创建一个转储文件（该`!analyze -v`命令是您的朋友）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T05:28:28.640

您可以使用 WinDbg .dump 命令，

```
.dump /mfh /u C:\crash.dmp 
```

对于崩溃场景，另外两个工具更适合，

*   调试诊断[http://support.microsoft.com/kb/2580960](http://support.microsoft.com/kb/2580960)
*   ADPlus.exe [http://blogs.msdn.com/b/cobold/archive/2010/03/01/collection-crash-dumps.aspx](http://blogs.msdn.com/b/cobold/archive/2010/03/01/collection-crash-dumps.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T16:14:32.287

[选择最佳工具](http://msdn.microsoft.com/en-us/library/windows/hardware/ff539117%28v=vs.85%29.aspx)确认 WinDbg 将帮助您创建转储文件，但也提供了一些可能更易于使用的替代方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T15:57:09.217

如果您可以在异常处理程序中拦截崩溃，那么您可以使用代码编写转储：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms680360%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680360%28v=vs.85%29.aspx)

否则，您需要指示 Watson 博士拦截并使用特定标志为您创建转储，这些标志指定转储将持有的详细程度：http: [//blogs.technet.com/b/askperf/archive/2007/06/ 15/capturing-application-crash-dumps.aspx](http://blogs.technet.com/b/askperf/archive/2007/06/15/capturing-application-crash-dumps.aspx)和[http://social.technet.microsoft.com/wiki/contents/articles/8103.application-crash-dump-analysis-windows-7.aspx](http://social.technet.microsoft.com/wiki/contents/articles/8103.application-crash-dump-analysis-windows-7.aspx)和[msdn](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787181%28v=vs.85%29.aspx)

要从命令行执行此操作，您需要执行以下操作：

```
cdb -pn myApp.exe -c ".symfix;.reload;.dump /ma c:\memdump\crash.dmp;qd" 
```

这假定 cdb.exe 路径是可搜索的，您可能需要使用完整路径作为前缀，例如：

```
C:\Program Files (x86)\Debugging Tools for Windows (x86)\cdb -pn myApp.exe -c ".symfix;.reload;.dump /ma c:\memdump\crash.dmp;qd" 
```

所以这里的命令

```
cdb -pn   -->attaches cdb to your process name myApp.exe
-c        -->execute command
.symfix   -->fix microsoft symbols
.reload   -->reload
.dump /ma c:\memdump\crash.dmp --> write minidump to location (the flags /ma is effectively everything you want)
qd        -->quit and detach 
```

您可能不需要其中一些命令，如果不需要，您可以删除它们。

# c++ - Ofstream not writing to file C++

> ID：10586127
> 
> 赞同：2
> 
> 时间：2012-05-14T15:14:06.540
> 
> 标签：c++, file, io, ofstream

I have this method which supposed to get a buffer and write some content to a file:

```
void writeTasksToDevice()
{

TaskInfo *task;
unsigned int i = lastTaskWritten;

printf("writing elihsa\n");
outputFile.write(" Elisha2", 7);
//pthread_mutex_lock(&fileMutex);

for(; i < (*writingTasks).size(); i++)
{
    task = (*writingTasks).at(i);
    if(NULL == task)
    {
        printf("ERROR!!! in writeTasksToDevice - there's a null task in taskQueue. By "
                " design that should NEVER happen\n");
        exit(-1);

    }
    if(true == task->wasItWritten)
    {
        //continue;
    }
    else // we've found a task to write!
    {

        printf("trying to write buffer to file\n");
        printf("buffer = %s, length = %d\n", task->buffer, task->length);<====PRINT HERE IS OK< PRINTING WHAT IS WANTED
        outputFile.write(task->buffer, task->length); <===SHOULD WRITE HERE
        printf("done writing file\n");
    }

}

//pthread_mutex_unlock(&fileMutex);

// TODO: check if we should go to sleep and wait for new tasks
// and then go to sleep

} 
```

the buffer content is:

task->buffer: `elishaefla`

task->length: `10`

i opened the stream in another init function using:

```
outputFile.open(fileName, ios :: app);
if(NULL == outputFile)
{
    //print error;
    return -1;
} 
```

but at the end, the file content is empty, nothing is being written.

any idea why?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:21:35.350

You did not provide enough information to answer the question with certainty, but here are some of the issues you might be facing:

1.  You did not flush the buffer of the `ofstream`

2.  You did not close the file that you are trying to open later on (if I'm correct, `outputFile` is a global variable, so it is not closed automatically until the end of the program)

# unit-testing - 如何在对 javascript 代码进行单元测试之前初始化 mongodb？

> ID：10586128
> 
> 赞同：0
> 
> 时间：2012-05-14T15:14:07.663
> 
> 标签：unit-testing, mongodb, mongoose

我正在用 nodejs+mongoose+mongodb 创建一个网站。我正在寻找一种用一些准备好的数据初始化 mongodb 的好方法。

目前，我正在做以下工作`beforeEach`：

1.  删除数据库
2.  编写一些代码将一些数据插入数据库

但是我发现这个操作不够快，需要将近1s。

我想知道有没有更好更快的方法来准备测试数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:23:33.290

您可以删除所有集合而不删除不会删除文件且不会在磁盘上重新分配 192 mb 空间的数据库。

伪代码

```
var collections = ['collectionA', 'collectionB', 'collectionC'].
for each collection in collections 
  db[collection].drop() 
```

在 mongodb shell 中，您可以为 foo 集合名称执行 db['foo']。我不知道猫鼬是否支持这种方式。

# c# - 使用 T' 类型的变量设置 T 类型的属性，并在 setter 中处理转换？

> ID：10586130
> 
> 赞同：0
> 
> 时间：2012-05-14T15:14:15.823
> 
> 标签：c#, properties, type-conversion, setter

假设我有一个内部有公共属性的类，如下所示：

```
class Data
{
    public int Property { get; set; }
} 
```

现在，出于某种原因，我想将一个字符串传递给这个属性。我可以在传递它之前将字符串转换为一个`Int32`，但懒惰更容易。是否可以更改设置器以便自动完成转换？如：

```
if (value is string) Property = Int32.Parse(value); 
```

当然，这个例子是行不通的。VS 抛出一个错误以及一个关于 value 永远不会是字符串的警告。

编辑：是的，我知道这是一个坏主意。这只是好奇。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:17:16.360

如果您想避免转换，您可以创建 setter 方法，而不是使用属性 setter：

```
void SetProperty(int value);
void SetProperty(String value); 
```

等等。

如果你*真的*想疯狂，你可以创建一个`PropertyValue`从整数、字符串和任何你想要的类型进行隐式转换的类型，并将其用作属性类型。它会让 setter 表现得像你想要的那样，但是你会遇到 getter 的问题。如果您真的想保存这些转换，请使用第一个解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T15:18:07.537

无法以这种方式更改设置器。C# 中属性的 setter 必须与属性本身具有相同的类型。作为 setter 的函数，无法插入来自任何其他类型的静态转换。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T15:22:32.090

不，根据语言规范，如果您将属性声明为某种类型`T`，那么在编译时`value`将保证是`T`（或其派生类型之一或实现接口的类型）。`T`

如果您希望您的 setter 接收任何类型的值，请使用`object`：

```
private int prop;

public object Property
{
    get { return this.prop; }
    set
    {
        this.prop = value != null ? Int32.Parse(value.ToString()) : 0;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:21:00.793

您可以使用以下类型的属性`object`：

```
class Data {
  private int _property;
  public object Property {
    get {
      return _property;
    }
    set {
      if (value is string) {
        _property = Int32.Parse(value);
      } else {
        _property = (int)value;
      }
    }
  }
} 
```

不过，这不是很实用。当您将 an`int`分配给该属性时，它将被隐式地装箱`object`，然后取消装箱。当您获得值时，getter 会返回`int`装箱的 an `object`，因此如果您希望将其作为`int`值，则必须将其拆箱（强制转换）。

# linux - 在不安装 RPM 的情况下检查缺少的依赖项

> ID：10586135
> 
> 赞同：2
> 
> 时间：2012-05-14T15:14:31.853
> 
> 标签：linux, perl, rpm

我想构建一个脚本来下载所有丢失的包但不立即安装它们。为此，我试图在使用 Perl 程序安装新 RPM 时获取缺少的依赖项列表。

我尝试使用**rpm -qpR**标志，但它输出所有要求，而不仅仅是缺少的要求。

接下来，我尝试使用**rpm -Uvh --test**标志，但无法让它工作 - 它输出一个空字符串。

我的 Perl 程序：

```
#!/usr/bin/perl -w
$output="";
open(README, "rpm -Uvh ".$ARGV[0]." --test |") or die "Can't run program: $!\n";
while(<README>) {
    $output .= $_;
}
close(README);
print "OUTPPUT=".$output."\n"; 
```

我认为问题在于输出到**stderr**而不是**stdout**。

坦克为您提供帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T05:35:08.247

使用 yum-downloadonly

[http://www.cyberciti.biz/faq/yum-downloadonly-plugin/](http://www.cyberciti.biz/faq/yum-downloadonly-plugin/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:31:08.480

如果问题是你的问题，

```
open(README, "rpm -Uvh ".$ARGV[0]." --test 2>&1 |")
                                           ^^^^
                                         add this 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:37:44.200

我建议使用`rpm -qpR`然后循环遍历结果以查看是否安装了软件包。

为此，请 grep 中的包名称`rpm -qa`。

即使它不一定是最好的方法，这也可以工作。

# javascript - 使用 CSS 和 JQUERY 在图像上显示标题

> ID：10586136
> 
> 赞同：0
> 
> 时间：2012-05-14T15:14:32.763
> 
> 标签：javascript, jquery, css, xhtml

我有以下 jsfiddle，但似乎没有显示标题：http: [//jsfiddle.net/KumcX/189/](http://jsfiddle.net/KumcX/189/)

**HTML：**

```
<ul>
<li>
    <div class="caption" style="width: 220px; height: 140px; display: block; opacity: 0.0524612;">this is my caption</div>
    <a href="#"><img src="http://dribbble.com/system/users/22122/screenshots/244072/empirestate02_d_teaser.png?1314126367" alt=""></a></li>
    <li>
    <div class="caption" style="width: 220px; height: 140px; display: block; opacity: 0.0524612;">this is my caption</div>
    <a href="#"><img src="http://dribbble.com/system/users/22122/screenshots/244072/empirestate02_d_teaser.png?1314126367" alt=""></a></li>
    <li>
    <div class="caption" style="width: 220px; height: 140px; display: block; opacity: 0.0524612;">this is my caption</div>
    <a href="#"><img src="http://dribbble.com/system/users/22122/screenshots/244072/empirestate02_d_teaser.png?1314126367" alt=""></a></li>
    <li>
    <div class="caption" style="width: 220px; height: 140px; display: block; opacity: 0.0524612;">this is my caption</div>
    <a href="#"><img src="http://dribbble.com/system/users/22122/screenshots/244072/empirestate02_d_teaser.png?1314126367" alt=""></a></li>
    <li>
    <div class="caption" style="width: 220px; height: 140px; display: block; opacity: 0.0524612;">this is my caption</div>
    <a href="#"><img src="http://dribbble.com/system/users/22122/screenshots/244072/empirestate02_d_teaser.png?1314126367" alt=""></a></li>
    <li>
    <div class="caption" style="width: 220px; height: 140px; display: block; opacity: 0.0524612;">this is my caption</div>
    <a href="#"><img src="http://dribbble.com/system/users/22122/screenshots/244072/empirestate02_d_teaser.png?1314126367" alt=""></a></li>
</ul> 
```

**CSS：**

```
ul li{ float:left; padding:20px; border:solid gray 4px; margin:5px;}
ul li div{display:none; background:white; opacity:.5; position:absolute;} 
```

**JS：**

```
$('ul li').mouseenter(function(){
    var image= $(this).find('a img'),
        caption = $(this).find('div');

    caption.width(image.width());
    caption.height(image.height());
    caption.fadeIn();
}).mouseleave(function(){
     var image= $(this).find('img'),
        caption = $(this).find('div');

    caption.width(image.width());
    caption.height(image.height());
    caption.fadeOut();
}); 
```

它应该显示标题，但不是..有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:21:19.870

你可能会用 firebug 复制 html，

删除 li 元素上的样式。

检查这个 [http://jsfiddle.net/kuyabiye/KumcX/194/](http://jsfiddle.net/kuyabiye/KumcX/194/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:27:32.620

重构了一些 JS，放弃了内联标题样式，并更新了 css 类

**jQuery**

```
$(".caption").css('opacity', 0);

$('ul li').mouseenter(function() {    
    $(this).find(".caption").animate({ 'opacity': 0.9 });
}).mouseleave(function() {
    $(this).find(".caption").animate({ 'opacity': 0 });
});​ 
```

**css**

```
ul li {
    float:left; 
    padding:20px; 
    border:solid gray 4px; 
    margin:5px;
}
.caption {
    width: 220px;
    background: #fff; 
    height: 150px;        
    position: absolute;
}​​​ 
```

**示例**：http: [//jsfiddle.net/hunter/KumcX/201/](http://jsfiddle.net/hunter/KumcX/201/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T15:20:28.607

使用动画效果，配置不透明度：

```
$('ul li').mouseenter(function(){
    var image= $(this).find('a img'),
        caption = $(this).find('div');

    caption.width(image.width());
    caption.height(image.height());
    caption.animate({'opacity':0.5});
}).mouseleave(function(){
    var image= $(this).find('img'),
        caption = $(this).find('div');

    caption.width(image.width());
    caption.height(image.height());
    caption.animate({'opacity':0});
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:28:09.590

只需要进行一些调整，首先在您的 CSS 中，您需要提供`<div>`左侧和顶部位置以及一些高度和宽度，我已将其设置为 100% 以跨越图像和`<li>`相对位置，因此标题很好地定位在图像上。哦，我还给`<div>`背景设置了 255,255,255,0.5 的 rgba 颜色来实现你的透明效果。

你的 JS 很好，但你的问题是你有很多内联样式，所以删除这些，从那时起一切都应该正常工作。

这是一个更新的小提琴：http: [//jsfiddle.net/KumcX/197/](http://jsfiddle.net/KumcX/197/)

和更新的 CSS：

```
ul li{ float:left; padding:20px; border:solid gray 4px; margin:5px;position:relative}
ul li div{display:none; background:rgba(255,255,255,.5); position:absolute;left:0;top:0;width:100%;height:100%;} 
```

希望这会有所帮助。

# blackberry - 从 BlackBerry WebWorks App 启动 BlackBerry App

> ID：10586138
> 
> 赞同：1
> 
> 时间：2012-05-14T15:14:37.757
> 
> 标签：blackberry, blackberry-webworks

我还是 BlackBerry 开发的新手，但我正在尝试找到一种方法，如果我有一个 WebWorks 应用程序（应用程序 A）和一个本机应用程序 B，我想使用应用程序 A 提供的一些数据启动应用程序 B。一旦应用程序B，然后它需要能够将更多数据传递回应用程序 A。

我已经开始环顾四周并通读 blackberry.launch api

[https://origin-bdsc.webapps.blackberry.com/html5/documentation/ww_webrefs/blackberry_launch_971534_1](https://origin-bdsc.webapps.blackberry.com/html5/documentation/ww_webrefs/blackberry_launch_971534_1) ...

但从那里我只看到你能够启动特定的应用程序。

任何建议在这里表示赞赏。亲切的问候，迈克尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:24:24.950

如果这是一个真正的 WebWorks 应用程序，请将[blackberry.invoke.invoke](https://origin-bdsc.webapps.blackberry.com/html5/apis/blackberry.invoke.html)与[JavaArguments](https://origin-bdsc.webapps.blackberry.com/html5/apis/blackberry.invoke.JavaArguments.html)一起使用：

```
<script type="text/javascript"> 
   var args = new blackberry.invoke.JavaArguments('net_rim_bb_memo_app');
   blackberry.invoke.invoke(blackberry.invoke.APP_JAVA, args);  // Java
</script> 
```

**编辑**：我没有阅读关于将数据传递回应用程序 A 的部分。您要么需要：

*   [用 Java 编写一个 JavaScript 扩展](http://developer.blackberry.com/bbos/html5/documentation/creating_and_using_a_js_extensiong_in_your_widget_1316872_11.html)来返回数据
*   让应用程序 B[写入文件系统](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/io/package-summary.html)并[让 webworks 应用程序读取它](https://origin-bdsc.webapps.blackberry.com/html5/apis/blackberry.io.file.html)。

# java - 使用带有密码摘要的 usernametoken 配置文件使用 Web 服务

> ID：10586140
> 
> 赞同：2
> 
> 时间：2012-05-14T15:14:50.847
> 
> 标签：java, web-services, jax-ws, webservice-client, ws-security

伙计们，请帮帮我！！！

我创建了一个 Web 服务，它使用 UserNameToken 配置文件安全性和密码类型，如“摘要”。当我尝试使用来自 SOAP-UI 的 web 服务（在 xml 的头部发送信息）时，我可以正常使用 web 服务，但是当我尝试使用 JAVA 使用这个 web 服务时，服务器不会对用户进行身份验证。

我尝试使用axis和JAX-WS（在信封的头部发送信息——比如SOAP-UI），但服务器不对用户进行身份验证。

有人能帮我吗？

这是我的代码：

```
public void faz() throws NoSuchAlgorithmException, Exception {

    /////////////////////////////////////////////////////////////
    //get the timestamp, nonce and password in SHA-1 and BASE64//       
    /////////////////////////////////////////////////////////////

    String nonce, timestamp, secret;
    nonce = String.valueOf(this.hashCode());
    BASE64Encoder encoder2 = new BASE64Encoder();
    nonce = encoder2.encode(nonce.getBytes());
    Calendar c = Calendar.getInstance();
    c.setTime(new Date());

    timestamp = DatatypeConverter.printDateTime(c);
    timestamp = timestamp.substring(0, 19);
    timestamp = timestamp+"Z";
    secret = "weblogic1";
    MessageDigest SHA1 = null;
    try {
        SHA1 = MessageDigest.getInstance("SHA1");
    } catch (NoSuchAlgorithmException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
    ;

    String beforeEncryption = nonce + timestamp + secret;
try {

        SHA1.reset();
        byte[] toEncrypt = beforeEncryption.getBytes("UTF-8");
        SHA1.update(beforeEncryption.getBytes());
    } catch (UnsupportedEncodingException uee) {
        throw new RuntimeException(uee);
    }

    byte[] encryptedRaw = SHA1.digest();
    byte[] encoded = Base64.encodeBase64(encryptedRaw);
    MessageDigest digest = MessageDigest.getInstance("SHA-1");
    digest.update("password".getBytes());
    BASE64Encoder encoder = new BASE64Encoder();
    String senha = encoder.encode(digest.digest());
    System.err.println(senha);
    ////////////////////////////////////
    //////////END //////////////////////        
    ////////////////////////////////////

    CalculaServiceService ss = new CalculaServiceServiceLocator();

    CalculaService service = ss.getCalculaServicePort();

    String uri = "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd";
    String uriCrea = "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"; 

    SOAPHeaderElement securityE = new SOAPHeaderElement(uri, "Security",
            null);
    SOAPHeaderElement tokenE = new SOAPHeaderElement(uri, "UsernameToken",
            null);
    SOAPHeaderElement userE = new SOAPHeaderElement(uri, "Username", null);
    tokenE.setObjectValue(null);

    securityE.setObjectValue(null);

    userE.setValue("username");
    SOAPHeaderElement pwdE = new SOAPHeaderElement(uri, "Password", null);
    pwdE.addAttribute(uri, "Type", "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest");
    pwdE.setValue(senha);

    SOAPHeaderElement nonceE = new SOAPHeaderElement(uri, "Nonce", null);
    nonceE.addAttribute(uri, "EncodingType", "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest");
    nonceE.setValue(nonce);

    SOAPHeaderElement createdE = new SOAPHeaderElement(uriCrea, "Created", null);
    createdE.setValue(timestamp);

    tokenE.addChildElement(userE);
    tokenE.addChildElement(pwdE);
    tokenE.addChildElement(nonceE);
    tokenE.addChildElement(createdE);
    securityE.addChildElement(tokenE);
    ((Stub) service).setHeader(securityE);
    service.calcula(13, 10, "somar");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:40:19.130

WS-Security 标准将密码摘要定义为 Base64 (SHA-1 (nonce + created + password))。

*您可以通过散列beforeEncryption*变量的内容正确反映这一点，并将结果存储到*encryptedRaw*，然后将其 base64 编码为*编码*变量。到目前为止，一切都很好。但是*编码*变量不在任何地方使用。出于某种原因，您计算了第二个摘要 base64(sha1("password")) 并将其存储到*senha*变量中，该变量稍后用于填充 WSS 密码元素。

完全删除计算第二个摘要的代码并使用编码变量的内容：

从概念上讲，将 pwd.setValue() 从：

```
pwdE.setValue(senha) 
```

至：

```
pwdE.setValue(encoded) 
```

并确保*编码*变量是字符串，而不是字节数组。

此外，您应该考虑为*nonce*使用比对象哈希码更好的值。

# java - 如何将 MapWritable 与 SequenceFile 一起使用？Hadoop

> ID：10586141
> 
> 赞同：1
> 
> 时间：2012-05-14T15:14:58.083
> 
> 标签：java, hadoop, mapreduce, writable

我正在尝试使用 SequenceFile 在两个 mapReduce 程序之间传递数据。我要传递的数据格式为 >. 由于某种原因，地图中的某些条目似乎没有从一个程序传递到另一个程序。这是我的代码，首先是生成 de SequenceFileOutput 的 reducer，然后是从中读取的映射器。

公共静态类 IntSumReducer 扩展 Reducer {

```
public void reduce(Text key, Iterable<Text> values, 
                   Context context
                   ) throws IOException, InterruptedException {

    MapWritable vector = new MapWritable() ;

    for (Text val : values){
        if(vector.containsKey(val)){
            vector.put(val , new IntWritable(((IntWritable)vector.get(val)).get() + 1));
        }
        else
            vector.put(val , new IntWritable(1));
    }

    context.write(key, vector);

        }
    } 
```

和映射器：

公共静态类 TokenizerMapper 扩展 Mapper{

```
 private final static int cota = 100;
  private final static double ady = 0.25;

  public void map(Text key, MapWritable value, Context context
          ) throws IOException, InterruptedException {

      IntWritable tot = (IntWritable)value.get(key);

      int total = tot.get();

      if(total > cota){
          MapWritable vector = new MapWritable() ;
          Set<Writable> keys = value.keySet();

          Iterator<Writable> iterator = keys.iterator();
          while(iterator.hasNext()){
              Text llave = (Text) iterator.next();
              if(!llave.equals(key)){
                  IntWritable cant = (IntWritable) value.get(llave);
                  double rel = (((double)cant.get())/(double)total);
                  if(cant.get() > cota && rel > ady ){
                      vector.put(llave, new DoubleWritable(rel));
                  }
              }
          }
          context.write(key,vector);     
      }
  } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:25:27.060

```
for (Text val : values){
    if(vector.containsKey(val)){
        vector.put(val , new IntWritable(((IntWritable)vector.get(val)).get() + 1));
    }
    else
        vector.put(val , new IntWritable(1));
} 
```

这就是你的问题 - val Text 对象被 hadoop 重用，所以在调用 vector.put 时，你应该创建一个新的 Text 对象以脱离 val 引用（其值将在 for 循环的下一次迭代中改变）。

您可以将您的逻辑修改为以下内容，它应该可以工作（我还更新了计数器增量逻辑以提高效率）：

```
IntWritable tmpInt;
for (Text val : values){
    tmpInt = (IntWritable) vector.get(val);

    if(tmpInt == null) {
        tmpInt = new IntWritable(0);
        // create a copy of val Text object
        vector.put(new Text(val), tmpInt);
    }

    // update the IntWritable wrapped int value
    tmpInt.set(tmpInt.get() + 1);

    // Note: you don't need to re-insert the IntWritable into the map
} 
```

# objective-c - 多语言应用程序和 .string 文件

> ID：10586146
> 
> 赞同：1
> 
> 时间：2012-05-14T15:15:15.053
> 
> 标签：objective-c, ios

我正在查看一些使用示例，`NSLocalizedString`项目中有一个 .string 文件，我可以在其中找到：

```
"Loading" = "Wczytuję..."; 
```

然后在应用程序代码中我可以找到：

```
return NSLocalizedString(@"Loading", @""); 
```

我如何使用它创建我的应用程序的多语言版本？还是有其他方法？

我想要有按钮来改变语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:22:28.983

这正是您本地化 iOS 应用程序的方式。任何你想显示你写的本地化文本的地方`NSLocalizedString(@"Something", @"Optional Description")`。然后将一个名为 Localized.strings 的文件添加到应用程序的资源中并在那里翻译文本：

```
"Something" = "Something in other language"; 
```

您可以通过选择 .strings 文件来添加新语言，然后在 XCode 的右侧添加新语言：

![在此处输入图像描述](../Images/8905d7c556701e1ef2340bd8bdf6d4a8.png)

您还可以在项目中拥有其他单独的 .strings 文件。然后你必须指定在哪里寻找翻译：`NSLocalizedStringFromTable(string, filename, comment)`

# php - 在使用 jquery fancybox 时捕获单击时的图像视图计数

> ID：10586149
> 
> 赞同：0
> 
> 时间：2012-05-14T15:15:41.670
> 
> 标签：php, jquery, fancybox

有没有人知道当用户单击 Fancybox 中的下一个/上一个按钮时我如何捕获图像 ID？我喜欢 Fancybox 如何根据图像的大小而变化，所以我更喜欢在我见过的其他一些画廊上使用它。有没有人成功做到这一点？该网站使用 PHP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:32:29.380

一般的想法是通过 PHP 脚本“代理”您的图像。

该脚本将：

1.  将图像的查看次数加 1
2.  将图像提供给浏览器（而不是像往常一样提供 HTML 页面）

然后，您将更新图片标签的`src`属性：`img`

```
<img src="mypicture.png"/> 
```

会成为

```
<img src="view_picture.php?picture=1"/> 
```

请注意，您**必须**小心，不要在图片参数中授权文件名和/或仔细检查用户是否没有尝试查看您不想显示给他的文件（想想 view_picture.php?picture=../ .htpasswd )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:17:13.453

考虑使用通用网站分析软件，例如[Piwik](http://piwik.org/)。这将为您提供有关访问者及其在您网站上的操作的更多见解，而不是简单的图像查看计数器。

我正在运行一个使用 Fancybox 和 Piwik 的站点，通过 Fancybox 的所有图像视图将自动显示在 Piwik 报告的**下载**部分，无需任何额外配置。

但是您可以通过 Fancybox 的`onComplete`回调和 Piwik 的`trackPageView()`. 有关详细信息，请参阅[Piwik Javascript API](http://piwik.org/docs/javascript-tracking/#toc-manually-trigger-a-page-view-on-click-or-on-js-event)和[Fancybox API](http://fancybox.net/api)。

# jquery - 带有动画/延迟的数组输出

> ID：10586150
> 
> 赞同：1
> 
> 时间：2012-05-14T15:15:43.913
> 
> 标签：jquery

我有一个需要数组的函数。该数组应在循环中打印出来（带有动画）。每个值都会被应用到下面的 div 中。首先它是空的。然后数组中的第一个值淡入，显示几秒钟，最后淡出。数组中的所有值都应如此处理。并且 div 一次只能显示一个值。

```
<div id="text_wrapper"></div> 
```

功能：

```
function runAni(arr){
    $.each(arr, function(key, value) { 
        //alert(key + ': ' + value); 
    });
} 
```

我已经尝试过队列，但失败了。请帮忙 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:18:22.743

```
function runAni(arr) {
    var $div = $('#text_wrapper');

    $.each(arr, function(index, value) {
        setTimeout(function() {
            $div.html(value).fadeIn().fadeOut();
        }, 1000 * index);
    });
}

var arr = ["foo", "more foo", "Even more of that"];
runAni(arr);​ 
```

[**现场演示**](http://jsfiddle.net/gdoron/v3bLH/)

# c# - 在谷歌站点地图中查找重复项

> ID：10586151
> 
> 赞同：0
> 
> 时间：2012-05-14T15:15:44.490
> 
> 标签：c#, linq, c#-4.0, xpath

我想根据 loc 元素在我的谷歌站点地图中找到任何重复项。

示例 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
 <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" xsi:s chemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> 
  <url><loc>http://mysite.net/Members.aspx</loc><lastmod>2011-07-01</lastmod></url>      
  <url><loc>http://mysite.net/Topics.aspx</loc><lastmod>2011-05-27</lastmod></url>
  <url><loc>http://mysite.net/Members.aspx</loc><lastmod>2011-07-02</lastmod></url>      
</urlset> 
```

示例 LINQ：

```
 var duplicates = (from req in doc.Descendants("urlset")
                          group req by req.Descendants("//loc").First().Value
                              into g
                              where g.Count() > 1
                          select g.Skip(1)).SelectMany(elements => elements
                        ); 
```

为什么重复返回空？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:17:48.330

`doc.Descendants("urlset")`只会返回一个元素（the `<urlset>`）。

您需要选择`<url>`元素：

```
from u in doc.Descendants("url")
group u by u.Element("loc").Value into g
from elem in g.Skip(1)    //This is the SelectMany()
select elem 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:18:48.890

您的查询未找到元素，因为您没有指定命名空间。它也比必要的复杂：

```
XNamespace ns = "http://www.sitemaps.org/schemas/sitemap/0.9";
var duplicates =
    from loc in doc.Root.Elements(ns + "url").Elements(ns + "loc")
    group loc by loc.Value into g
    where g.Count() > 1
    select g.Key; 
```

# arrays - 如何在 Bash 中将字符串拆分为数组？

> ID：10586153
> 
> 赞同：819
> 
> 时间：2012-05-14T15:15:58.363
> 
> 标签：arrays, bash, split

在 Bash 脚本中，我想将一行分成几部分并将它们存储在一个数组中。

例如，给定以下行：

```
Paris, France, Europe 
```

我想让结果数组看起来像这样：

```
array[0] = Paris
array[1] = France
array[2] = Europe 
```

一个简单的实现是可取的；速度无所谓。我该怎么做？

* * *

## 回答 #1

> 赞同：1344
> 
> 时间：2012-05-14T15:16:48.597

```
IFS=', ' read -r -a array <<< "$string" 
```

请注意，其中的字符`$IFS`被单独视为分隔符，因此在这种情况下，字段可以用*逗号*或空格而不是两个字符的顺序分隔。有趣的是，当逗号空格出现在输入中时，不会创建空字段，因为空格是经过特殊处理的。

要访问单个元素：

```
echo "${array[0]}" 
```

迭代元素：

```
for element in "${array[@]}"
do
    echo "$element"
done 
```

要同时获取索引和值：

```
for index in "${!array[@]}"
do
    echo "$index ${array[index]}"
done 
```

最后一个示例很有用，因为 Bash 数组是稀疏的。换句话说，您可以删除一个元素或添加一个元素，然后索引不连续。

```
unset "array[1]"
array[42]=Earth 
```

要获取数组中的元素数：

```
echo "${#array[@]}" 
```

如上所述，数组可以是稀疏的，因此您不应该使用长度来获取最后一个元素。以下是在 Bash 4.2 及更高版本中的方法：

```
echo "${array[-1]}" 
```

在任何版本的 Bash 中（从 2.05b 之后的某个地方）：

```
echo "${array[@]: -1:1}" 
```

较大的负偏移选择距离数组末尾较远的位置。请注意旧表格中减号前的空格。这是必需的。

* * *

## 回答 #2

> 赞同：522
> 
> 时间：2017-07-19T21:20:22.683

这个问题的所有答案在某种程度上都是错误的。

* * *

[***错误答案#1***](https://stackoverflow.com/a/10586169/4272464)

```
IFS=', ' read -r -a array <<< "$string" 
```

**1：**这是对`$IFS`. `$IFS`变量的值**不**被视为*单个可变长度*字符串分隔符，而是被视为一*组**单字符*字符串分隔符，其中从输入行分离的每个字段`read`都可以由集合中的*任何*字符终止（在此示例中为逗号**或**空格）。

实际上，对于真正的坚持者来说，完整的含义`$IFS`稍微复杂一些。从[bash 手册](https://www.gnu.org/software/bash/manual/html_node/Word-Splitting.html#Word-Splitting)：

> shell 将**IFS**的每个字符视为分隔符，并将其他扩展的结果拆分为使用这些字符作为字段终止符的单词。如果**IFS**未设置，或者它的值恰好是**<space><tab><newline>**（默认值），那么**<space>**、**<tab>**和**<newline>**的序列位于先前扩展结果的开头和结尾处被忽略，并且任何不在开头或结尾的**IFS字符序列都用于分隔单词。**如果**IFS**的值不是默认值，则空格字符**<space>**、**<tab>**和**<的序列**只要空白字符在 IFS 的值中（一个 IFS 空白字符），就会在单词的开头和**结尾**被**忽略**。**IFS**中不是**IFS**空白的任何字符，以及任何相邻的**IFS**空白字符，都会分隔一个字段。**IFS**空白字符序列也被视为分隔符。如果**IFS**的值为空，则不发生分词。

基本上，对于 的非默认非空值`$IFS`，字段可以用（1）一个或多个字符的序列来分隔，这些字符都来自“IFS 空白字符”集（即**<space>**中的任何一个，**<tab>**和**<newline>**（“换行符”表示换行符[（LF）](https://en.wikipedia.org/wiki/Newline)）`$IFS`，或（2）任何非“IFS 空白字符”`$IFS`与围绕它的任何“IFS 空白字符”一起出现在输入行中。

对于 OP，我在上一段中描述的第二种分离模式可能正是他想要的输入字符串，但我们可以确信我描述的第一种分离模式根本不正确。例如，如果他的输入字符串是`'Los Angeles, United States, North America'`？

```
IFS=', ' read -ra a <<<'Los Angeles, United States, North America'; declare -p a;
## declare -a a=([0]="Los" [1]="Angeles" [2]="United" [3]="States" [4]="North" [5]="America") 
```

**2：**即使您要使用带有单字符分隔符的解决方案（例如逗号本身，即没有后面的空格或其他包袱），如果`$string`变量的值恰好包含任何LF，那么`read`将一旦遇到第一个 LF 就停止处理。`read`内置每次调用只处理一行。即使您*仅*将输入管道或重定向到`read`语句也是如此，正如我们在此示例中使用[here-string](https://www.gnu.org/software/bash/manual/html_node/Redirections.html#Here-Strings)机制所做的那样，因此保证会丢失未处理的输入。支持内置命令的代码`read`不知道其包含的命令结构中的数据流。

您可能会争辩说这不太可能导致问题，但仍然是一个微妙的危险，应该尽可能避免。这是由于`read`内置函数实际上做了两级输入拆分：首先是行，然后是字段。由于 OP 只想要一个级别的拆分，因此`read`内置函数的这种用法是不合适的，我们应该避免它。

**3：**此解决方案的一个不明显的潜在问题是，`read`如果尾随字段为空，则始终删除它，尽管否则它会保留空字段。这是一个演示：

```
string=', , a, , b, c, , , '; IFS=', ' read -ra a <<<"$string"; declare -p a;
## declare -a a=([0]="" [1]="" [2]="a" [3]="" [4]="b" [5]="c" [6]="" [7]="") 
```

也许OP不会关心这一点，但这仍然是一个值得了解的限制。它降低了解决方案的鲁棒性和通用性。

这个问题可以通过在输入字符串之前附加一个虚拟尾随分隔符来解决，`read`稍后我将演示。

* * *

[***错误答案#2***](https://stackoverflow.com/a/15400047/4272464)

```
string="1:2:3:4:5"
set -f                     # avoid globbing (expansion of *).
array=(${string//:/ }) 
```

[类似的想法：](https://stackoverflow.com/a/31405855/4272464)

```
t="one,two,three"
a=($(echo $t | tr ',' "\n")) 
```

（注意：我在命令替换周围添加了缺少的括号，回答者似乎已经省略了。）

[类似的想法：](https://stackoverflow.com/a/37618160/4272464)

```
string="1,2,3,4"
array=(`echo $string | sed 's/,/\n/g'`) 
```

这些解决方案利用数组赋值中的分词将字符串拆分为字段。有趣的是，就像 一样`read`，一般分词也使用`$IFS`特殊变量，尽管在这种情况下暗示它被设置为其默认值**<space><tab><newline>**，因此任何一个或多个 IFS 的序列字符（现在都是空白字符）被认为是字段分隔符。

这解决了由 提交的两级拆分问题`read`，因为分词本身仅构成一级拆分。但是和以前一样，这里的问题是输入字符串中的各个字段已经可以包含`$IFS`字符，因此在分词操作期间它们会被不正确地拆分。这些回答者提供的任何示例输入字符串都不是这种情况（多么方便......），但这当然不会改变任何使用此成语的代码库都会冒着以下风险的事实如果这个假设在某个时间点被违反，就会爆炸。再一次考虑我的反例`'Los Angeles, United States, North America'`（或`'Los Angeles:United States:North America'`）。

此外，分词之后通常是[文件名扩展](https://www.gnu.org/software/bash/manual/html_node/Filename-Expansion.html#Filename-Expansion)（*又名*路径名扩展，*又名*通配符），如果这样做，可能会损坏包含字符`*`,`?`或`[`后跟`]`（并且，如果`extglob`设置，括号片段前面是`?`, `*`, `+`, `@`, ）的单词或`!`）通过将它们与文件系统对象进行匹配并相应地扩展单词（“globs”）。`set -f`这三个回答者中的第一个通过预先运行禁用通配符巧妙地解决了这个问题。从技术上讲，这是可行的（尽管您可能应该添加`set +f`之后为可能依赖于它的后续代码重新启用 globbing），但是为了破解本地代码中的基本字符串到数组解析操作而不得不弄乱全局 shell 设置是不可取的。

此答案的另一个问题是所有空字段都将丢失。这可能是也可能不是问题，具体取决于应用程序。

注意：如果您要使用此解决方案，最好使用[参数扩展](https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html#Shell-Parameter-Expansion)`${string//:/ }`的“模式替换”形式，而不是麻烦地调用命令替换（它分叉 shell）、启动管道和运行外部可执行文件（或），因为参数扩展纯粹是 shell 内部操作。（此外，对于and解决方案，输入变量应在命令替换中用双引号引起来；否则分词将在命令中生效并可能与字段值混淆。此外，命令替换的形式比旧的形式更可取`tr``sed``tr``sed``echo``$(...)```...``形式，因为它简化了命令替换的嵌套并允许文本编辑器更好地突出显示语法。）

* * *

[***错误答案#3***](https://stackoverflow.com/a/39474755/4272464)

```
str="a, b, c, d"  # assuming there is a space after ',' as in Q
arr=(${str//,/})  # delete all occurrences of ',' 
```

**这个答案与#2**几乎相同。不同之处在于，回答者假设字段由两个字符分隔，其中一个在 default 中表示，`$IFS`另一个不是。他通过使用模式替换扩展删除非 IFS 表示的字符，然后使用分词来拆分幸存的 IFS 表示的分隔符字符上的字段，解决了这个相当具体的情况。

这不是一个非常通用的解决方案。此外，可以说逗号实际上是这里的“主要”分隔符，并且剥离它然后根据空格字符进行字段拆分是完全错误的。再次考虑我的反例：`'Los Angeles, United States, North America'`.

同样，文件名扩展可能会损坏扩展的单词，但这可以通过使用`set -f`和 then临时禁用分配的通配符来防止`set +f`。

同样，所有空白字段都将丢失，这可能会或可能不会成为问题，具体取决于应用程序。

* * *

[***错误答案#4***](https://stackoverflow.com/a/13196466/4272464)

```
string='first line
second line
third line'

oldIFS="$IFS"
IFS='
'
IFS=${IFS:0:1} # this is useful to format your code with tabs
lines=( $string )
IFS="$oldIFS" 
```

这与**#2**和**#3**类似，因为它使用分词来完成工作，只是现在代码明确设置`$IFS`为仅包含输入字符串中存在的单字符字段分隔符。应该重复的是，这不适用于多字符字段分隔符，例如 OP 的逗号分隔符。但对于本例中使用的 LF 等单字符分隔符，它实际上已经接近完美。正如我们在之前的错误答案中看到的那样，字段不能在中间无意中拆分，并且根据需要只有一个拆分级别。

一个问题是文件名扩展会破坏受影响的单词，如前所述，尽管这可以通过将关键语句包装在`set -f`and中再次解决`set +f`。

另一个潜在的问题是，由于 LF 符合前面定义的“IFS 空白字符”的条件，所有空字段都将丢失，就像在**#2**和**#3**中一样。如果分隔符恰好是非“IFS 空白字符”，这当然不会成为问题，并且根据应用程序，它可能并不重要，但它确实破坏了解决方案的一般性。

因此，总而言之，假设您有一个单字符分隔符，并且它是非“IFS 空白字符”或者您不关心空字段，并且您将关键语句包装在`set -f`and中`set +f`，那么此解决方案有效，但否则不是。

（另外，为了提供信息，在 bash 中将 LF 分配给变量可以更容易地使用`$'...'`语法来完成，例如`IFS=$'\n';`.）

* * *

[***错误答案#5***](https://stackoverflow.com/a/41225957/4272464)

```
countries='Paris, France, Europe'
OIFS="$IFS"
IFS=', ' array=($countries)
IFS="$OIFS" 
```

[类似的想法：](https://stackoverflow.com/a/30744597/4272464)

```
IFS=', ' eval 'array=($string)' 
```

该解决方案实际上是**#1**（因为它设置`$IFS`为逗号空间）和**#2-4**（因为它使用分词将字符串拆分为字段）之间的交叉。正因为如此，它遭受了困扰上述所有错误答案的大多数问题，有点像世界上最糟糕的问题。

此外，关于第二个变体，调用似乎`eval`完全没有必要，因为它的参数是单引号字符串文字，因此是静态已知的。`eval`但是以这种方式使用实际上有一个非常不明显的好处。*通常，当您运行一个仅*由变量赋值组成的简单命令时，这意味着它后面没有实际的命令字，赋值在 shell 环境中生效：

```
IFS=', '; ## changes $IFS in the shell environment 
```

即使简单命令涉及*多个*变量赋值也是如此；同样，只要没有命令字，所有变量赋值都会影响 shell 环境：

```
IFS=', ' array=($countries); ## changes both $IFS and $array in the shell environment 
```

但是，如果变量赋值附加到命令名称（我喜欢称之为“前缀赋值”），那么它不会*影响*shell 环境，而只会影响执行命令的环境，无论它是否是内置的或外部：

```
IFS=', ' :; ## : is a builtin command, the $IFS assignment does not outlive it
IFS=', ' env; ## env is an external command, the $IFS assignment does not outlive it 
```

[bash手册](https://www.gnu.org/software/bash/manual/html_node/Simple-Command-Expansion.html#Simple-Command-Expansion)中的相关引用：

> 如果没有产生命令名，变量分配会影响当前的 shell 环境。否则，变量会被添加到执行命令的环境中，并且不会影响当前的 shell 环境。

可以利用变量赋值的这一特性来`$IFS`临时更改，这使我们能够避免整个保存和恢复策略，就像`$OIFS`在第一个变体中对变量所做的那样。但是我们在这里面临的挑战是我们需要运行的命令本身只是一个变量赋值，因此它不会涉及一个命令词来使`$IFS`赋值临时。你可能会想，为什么不直接在语句中添加一个 no-op 命令词来[`: builtin`](https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html#Bourne-Shell-Builtins)使`$IFS`赋值临时呢？这不起作用，因为它也会使`$array`分配成为临时的：

```
IFS=', ' array=($countries) :; ## fails; new $array value never escapes the : command 
```

所以，我们实际上陷入了僵局，有点像第 22 条规则。但是，当`eval`运行它的代码时，它是在shell环境中运行的，就好像它是正常的静态源代码一样，因此我们可以`$array`在参数内部运行赋值，`eval`使其在shell环境中生效，而`$IFS`前缀赋值以命令为前缀`eval`不会超过`eval`命令。这正是该解决方案的第二个变体中使用的技巧：

```
IFS=', ' eval 'array=($string)'; ## $IFS does not outlive the eval command, but $array does 
```

因此，如您所见，这实际上是一个非常聪明的技巧，并且以一种相当不明显的方式准确地完成了所需的工作（至少在分配效果方面）。`eval`尽管有;的参与，我实际上并不反对这个技巧。只是要小心单引号参数字符串以防止安全威胁。

但是同样，由于“世界上最糟糕的”问题聚集在一起，这仍然是对 OP 要求的错误答案。

* * *

[***错误答案#6***](https://stackoverflow.com/a/35789043/4272464)

```
IFS=', '; array=(Paris, France, Europe)

IFS=' ';declare -a array=(Paris France Europe) 
```

嗯什么？OP 有一个字符串变量，需要将其解析为数组。这个“答案”从粘贴到数组文字中的输入字符串的逐字内容开始。我想这是一种方法。

看起来回答者可能假设该`$IFS`变量会影响所有上下文中的所有 bash 解析，这是不正确的。从 bash 手册：

> **IFS内部字段分隔符，用于扩展后的分词，并使用****read**内置命令    将行拆分为单词。默认值为**<space><tab><newline>**。

所以这个`$IFS`特殊变量实际上只在两种情况下使用：（1）*在扩展之后*执行的分词（意味着在解析 bash 源代码时*不*执行）和（2）用于将输入行拆分为`read`内置的单词。

让我试着更清楚地说明这一点。我认为区分*parsing*和*execution*可能会很好。Bash必须先*解析*源代码，这显然是一个*解析*事件，然后它*执行*代码，这就是扩展进入画面的时候。扩展实际上是一个*执行*事件。此外，我对`$IFS`上面刚刚引用的变量的描述有异议；与其说分词是*在扩展之后*执行的，我会说分词是*在*扩展期间执行的，或者更准确地说，分词*是*扩展过程。短语“分词”仅指扩展这一步；它永远不应该用来指对 bash 源代码的解析，尽管不幸的是，文档似乎确实经常使用“split”和“words”这两个词。这是 bash 手册的[linux.die.net 版本](https://linux.die.net/man/1/bash#Expansion)的相关摘录：

> 将其拆分为单词后在命令行上执行扩展。执行的扩展有七种：*大括号扩展*、*波浪号扩展*、*参数和变量扩展*、*命令替换*、*算术扩展*、*分词*和*路径名扩展*。
> 
> 展开顺序为：大括号展开；波浪号扩展、参数和变量扩展、算术扩展和命令替换（以从左到右的方式完成）；分词；和路径名扩展。

您可能会争辩说[GNU 版本](https://www.gnu.org/software/bash/manual/html_node/Shell-Expansions.html#Shell-Expansions)的手册做得稍微好一些，因为它在扩展部分的第一句中选择了“令牌”而不是“单词”：

> 将其拆分为令牌后，在命令行上执行扩展。

重要的一点是，`$IFS`不会改变 bash 解析源代码的方式。解析 bash 源代码实际上是一个非常复杂的过程，涉及到对 shell 语法的各种元素的识别，例如命令序列、命令列表、管道、参数扩展、算术替换和命令替换。在大多数情况下，bash 解析过程不能通过变量赋值之类的用户级操作来改变（实际上，这个规则有一些小例外；例如，请参阅各种[`compatxx`shell 设置](https://www.gnu.org/software/bash/manual/html_node/The-Shopt-Builtin.html#The-Shopt-Builtin)，它可以即时改变解析行为的某些方面）。然后根据上述文档摘录中分解的“扩展”的一般过程，扩展从这个复杂的解析过程产生的上游“单词”/“令牌”，其中扩展（扩展？）文本的分词到下游文字只是该过程的一个步骤。分词只涉及从前一个扩展步骤中吐出的文本；它不会影响直接从源字节流解析的文字文本。

* * *

[***错误答案#7***](https://stackoverflow.com/a/31620022/4272464)

```
string='first line
        second line
        third line'

while read -r line; do lines+=("$line"); done <<<"$string" 
```

这是最好的解决方案之一。请注意，我们又回到了使用`read`. 我之前不是说`read`不合适，因为它执行两级拆分，而我们只需要一个吗？这里的诀窍是，您可以`read`以这样一种方式调用，即它只有效地进行一级拆分，特别是每次调用只拆分一个字段，这需要在循环中重复调用它的成本。这有点花招，但它确实有效。

但也有问题。*第一：当您向NAME*提供至少一个参数时`read`，它会自动忽略从输入字符串中分离出来的每个字段中的前导和尾随空格。如本文前面所述，无论是否`$IFS`设置为其默认值都会发生这种情况。现在，OP 对于他的特定用例可能并不关心这一点，事实上，它可能是解析行为的一个理想特性。但并不是每个想要将字符串解析为字段的人都会想要这个。然而，有一个解决方案：一个有点不明显的用法`read`是传递零个*NAME*参数。在这种情况下，`read`将从输入流中获取的整个输入行存储在名为 的变量中`$REPLY`，并且，作为奖励，它*不会*从值中去除前导和尾随空格。`read`这是我在 shell 编程生涯中经常使用的一种非常强大的用法。这是行为差异的演示：

```
string=$'  a  b  \n  c  d  \n  e  f  '; ## input string

a=(); while read -r line; do a+=("$line"); done <<<"$string"; declare -p a;
## declare -a a=([0]="a  b" [1]="c  d" [2]="e  f") ## read trimmed surrounding whitespace

a=(); while read -r; do a+=("$REPLY"); done <<<"$string"; declare -p a;
## declare -a a=([0]="  a  b  " [1]="  c  d  " [2]="  e  f  ") ## no trimming 
```

此解决方案的第二个问题是它实际上并没有解决自定义字段分隔符的情况，例如 OP 的逗号空格。和以前一样，不支持多字符分隔符，这是此解决方案的一个不幸限制。我们可以尝试通过在选项中指定分隔符来至少以逗号分隔`-d`，但看看会发生什么：

```
string='Paris, France, Europe';
a=(); while read -rd,; do a+=("$REPLY"); done <<<"$string"; declare -p a;
## declare -a a=([0]="Paris" [1]=" France") 
```

可以预见的是，未计算的周围空白被拉入字段值，因此必须随后通过修剪操作进行纠正（这也可以直接在 while 循环中完成）。但是还有另一个明显的错误：欧洲不见了！这是怎么回事？答案是，`read`如果它到达文件结尾（在这种情况下，我们可以称之为字符串结尾）而没有在最终字段上遇到最终字段终止符，则返回失败的返回码。这会导致 while 循环过早中断，并且我们丢失了 final 字段。

从技术上讲，同样的错误也影响了前面的例子。不同之处在于字段分隔符被视为 LF，这是您未指定`-d`选项时的默认值，并且`<<<`("here-string") 机制在将其提供为之前自动将 LF 附加到字符串命令的输入。因此，在这些情况下，我们无意中在输入中附加了一个额外的虚拟终止符，从而*意外地*解决了最终字段丢失的问题。让我们将此解决方案称为“虚拟终结者”解决方案。我们可以在此处字符串中实例化它时，通过自己将其与输入字符串连接起来，手动为任何自定义分隔符应用虚拟终止符解决方案：

```
a=(); while read -rd,; do a+=("$REPLY"); done <<<"$string,"; declare -p a;
declare -a a=([0]="Paris" [1]=" France" [2]=" Europe") 
```

到了，问题解决了。`read`另一种解决方案是仅在 (1)返回失败和 (2)`$REPLY`为空时才中断 while 循环，这意味着`read`在到达文件结尾之前无法读取任何字符。演示：

```
a=(); while read -rd,|| [[ -n "$REPLY" ]]; do a+=("$REPLY"); done <<<"$string"; declare -p a;
## declare -a a=([0]="Paris" [1]=" France" [2]=$' Europe\n') 
```

`<<<`这种方法还揭示了由重定向运算符自动附加到此处字符串的秘密 LF 。它当然可以通过如前所述的显式修剪操作单独剥离，但显然手动虚拟终结器方法直接解决了它，所以我们可以这样做。手动 dummy-terminator 解决方案实际上非常方便，因为它一次性解决了这两个问题（dropped-final-field 问题和 appended-LF 问题）。

所以，总的来说，这是一个非常强大的解决方案。唯一剩下的弱点是缺乏对多字符分隔符的支持，我将在稍后解决。

* * *

[***错误答案#8***](https://stackoverflow.com/a/31620022/4272464)

```
string='first line
        second line
        third line'

readarray -t lines <<<"$string" 
```

（这实际上来自与**#7**相同的帖子；回答者在同一个帖子中提供了两个解决方案。）

内置函数是的`readarray`同义词`mapfile`，是理想的。这是一个内置命令，可以一次性将字节流解析为数组变量；不要搞乱循环、条件、替换或其他任何东西。它不会偷偷地从输入字符串中删除任何空格。并且（如果`-O`没有给出）它在分配给它之前方便地清除目标数组。但它仍然不完美，因此我将其批评为“错误答案”。

首先，只是为了解决这个问题，请注意，就像`read`进行字段解析时的行为一样，`readarray`如果尾随字段为空，则删除它。同样，这可能不是 OP 关心的问题，但它可能适用于某些用例。稍后我会回到这个问题。

其次，和以前一样，它不支持多字符分隔符。我稍后也会对此进行修复。

第三，所写的解决方案不解析OP的输入字符串，事实上，它不能按原样使用来解析它。我也会对此进行扩展。

由于上述原因，我仍然认为这是对 OP 问题的“错误答案”。下面我将给出我认为正确的答案。

* * *

**正确答案**

这是通过仅指定选项来使**＃8**工作的天真的尝试：`-d`

```
string='Paris, France, Europe';
readarray -td, a <<<"$string"; declare -p a;
## declare -a a=([0]="Paris" [1]=" France" [2]=$' Europe\n') 
```

我们看到结果与我们从**#7**`read`中讨论的循环解决方案的双条件方法得到的结果相同。我们*几乎*可以通过手动虚拟终结器技巧来解决这个问题：

 ***```
readarray -td, a <<<"$string,"; declare -p a;
## declare -a a=([0]="Paris" [1]=" France" [2]=" Europe" [3]=$'\n') 
```

这里的问题是`readarray`保留了尾随字段，因为`<<<`重定向运算符将 LF 附加到输入字符串，因此尾随字段*不*为空（否则它会被删除）。我们可以通过在事后显式取消设置最终数组元素来解决这个问题：

```
readarray -td, a <<<"$string,"; unset 'a[-1]'; declare -p a;
## declare -a a=([0]="Paris" [1]=" France" [2]=" Europe") 
```

剩下的唯一两个实际相关的问题是 (1) 需要修剪的无关空白，以及 (2) 缺乏对多字符分隔符的支持。

之后当然可以修剪空格（例如，请参阅[如何从 Bash 变量中修剪空格？](https://stackoverflow.com/questions/369758/how-to-trim-whitespace-from-a-bash-variable)）。但是，如果我们可以破解多字符分隔符，那么这将一次性解决这两个问题。

不幸的是，没有*直接*的方法可以让多字符分隔符起作用。我想到的最佳解决方案是对输入字符串进行预处理，将多字符定界符替换为单字符定界符，保证不会与输入字符串的内容发生冲突。唯一具有此保证的字符是[NUL 字节](https://en.wikipedia.org/wiki/Null_character)。这是因为，在 bash 中（虽然不是在 zsh 中，顺便说一句），变量不能包含 NUL 字节。这个预处理步骤可以在进程替换中内联完成。以下是使用[awk](https://www.gnu.org/software/gawk/)的方法：

```
readarray -td '' a < <(awk '{ gsub(/, /,"\0"); print; }' <<<"$string, "); unset 'a[-1]';
declare -p a;
## declare -a a=([0]="Paris" [1]="France" [2]="Europe") 
```

终于到了！此解决方案不会在中间错误地拆分字段，不会过早剪切，不会删除空字段，不会在文件名扩展时损坏自身，不会自动去除前导和尾随空格，不会在最后留下偷偷摸摸的 LF，不需要循环，并且不满足于单字符分隔符。

* * *

**修整解决方案**

最后，我想展示我自己的相当复杂的修剪解决方案`-C callback`，使用`readarray`. 不幸的是，我已经用完了 Stack Overflow 严格的 30,000 个字符的帖子限制，所以我无法解释它。我将把它作为练习留给读者。

```
function mfcb { local val="$4"; "$1"; eval "$2[$3]=\$val;"; };
function val_ltrim { if [[ "$val" =~ ^[[:space:]]+ ]]; then val="${val:${#BASH_REMATCH[0]}}"; fi; };
function val_rtrim { if [[ "$val" =~ [[:space:]]+$ ]]; then val="${val:0:${#val}-${#BASH_REMATCH[0]}}"; fi; };
function val_trim { val_ltrim; val_rtrim; };
readarray -c1 -C 'mfcb val_trim a' -td, <<<"$string,"; unset 'a[-1]'; declare -p a;
## declare -a a=([0]="Paris" [1]="France" [2]="Europe") 
```

* * *

## 回答 #3

> 赞同：250
> 
> 时间：2013-03-14T02:20:13.680

这是一种不设置 IFS 的方法：

```
string="1:2:3:4:5"
set -f                      # avoid globbing (expansion of *).
array=(${string//:/ })
for i in "${!array[@]}"
do
    echo "$i=>${array[i]}"
done 
```

这个想法是使用字符串替换：

```
${string//substring/replacement} 
```

用空格替换 $substring 的所有匹配项，然后使用替换的字符串来初始化数组：

```
(element1 element2 ... elementN) 
```

注意：此答案使用[split+glob 运算符](https://unix.stackexchange.com/q/108963/79743)。因此，为了防止某些字符（例如`*`）的扩展，最好暂停此脚本的通配符。

* * *

## 回答 #4

> 赞同：121
> 
> 时间：2015-07-14T11:54:19.137

```
t="one,two,three"
a=($(echo "$t" | tr ',' '\n'))
echo "${a[2]}" 
```

打印三个

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2015-07-24T21:24:27.003

接受的答案适用于一行中的值。
如果变量有几行：

```
string='first line
        second line
        third line' 
```

我们需要一个非常不同的命令来获取所有行：

`while read -r line; do lines+=("$line"); done <<<"$string"`

或者更简单的 bash *readarray*：

```
readarray -t lines <<<"$string" 
```

利用 printf 功能打印所有行非常容易：

```
printf ">[%s]\n" "${lines[@]}"

>[first line]
>[        second line]
>[        third line] 
```

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2012-11-02T13:44:37.083

有时我碰巧接受的答案中描述的方法不起作用，特别是如果分隔符是回车符。
在这些情况下，我以这种方式解决了：

```
string='first line
second line
third line'

oldIFS="$IFS"
IFS='
'
IFS=${IFS:0:1} # this is useful to format your code with tabs
lines=( $string )
IFS="$oldIFS"

for line in "${lines[@]}"
    do
        echo "--> $line"
done 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2020-08-05T15:29:18.850

如果你使用 macOS 并且不能使用 readarray，你可以简单地这样做——

```
MY_STRING="string1 string2 string3"
array=($MY_STRING) 
```

迭代元素：

```
for element in "${array[@]}"
do
    echo $element
done 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2019-05-15T09:03:02.900

这适用于我在 OSX 上：

```
string="1 2 3 4 5"
declare -a array=($string) 
```

如果您的字符串有不同的分隔符，只需第一次用空格替换它们：

```
string="1,2,3,4,5"
delimiter=","
declare -a array=($(echo $string | tr "$delimiter" " ")) 
```

简单的 ：-）

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2016-06-03T15:24:19.477

这类似于[Jmoney38 的方法](https://stackoverflow.com/a/31405855/347339)，但使用 sed：

```
string="1,2,3,4"
array=(`echo $string | sed 's/,/\n/g'`)
echo ${array[0]} 
```

打印 1

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2017-11-26T19:59:33.320

将字符串拆分为数组的关键是`", "`. 使用多字符分隔符的任何解决方案`IFS`本质上都是错误的，因为 IFS 是一组这些字符，而不是字符串。

如果您指定`IFS=", "`，则字符串将在 EITHER `","`OR`" "`或它们的任何组合上中断，这不是 . 的两个字符分隔符的准确表示`", "`。

您可以使用`awk`或`sed`拆分字符串，并使用进程替换：

```
#!/bin/bash

str="Paris, France, Europe"
array=()
while read -r -d $'\0' each; do   # use a NUL terminated field separator 
    array+=("$each")
done < <(printf "%s" "$str" | awk '{ gsub(/,[ ]+|$/,"\0"); print }')
declare -p array
# declare -a array=([0]="Paris" [1]="France" [2]="Europe") output 
```

直接在 Bash 中使用正则表达式会更有效：

```
#!/bin/bash

str="Paris, France, Europe"

array=()
while [[ $str =~ ([^,]+)(,[ ]+|$) ]]; do
    array+=("${BASH_REMATCH[1]}")   # capture the field
    i=${#BASH_REMATCH}              # length of field + delimiter
    str=${str:i}                    # advance the string by that length
done                                # the loop deletes $str, so make a copy if needed

declare -p array
# declare -a array=([0]="Paris" [1]="France" [2]="Europe") output... 
```

使用第二种形式，没有子外壳，它本质上会更快。

* * *

**由 bgoldst 编辑：**这里有一些基准比较我`readarray`的解决方案和 dawg 的正则表达式解决方案，我还包括了`read`解决方案（注意：我稍微修改了正则表达式解决方案，以便与我的解决方案更加协调）（另请参阅下面的评论邮政）：

```
## competitors
function c_readarray { readarray -td '' a < <(awk '{ gsub(/, /,"\0"); print; };' <<<"$1, "); unset 'a[-1]'; };
function c_read { a=(); local REPLY=''; while read -r -d ''; do a+=("$REPLY"); done < <(awk '{ gsub(/, /,"\0"); print; };' <<<"$1, "); };
function c_regex { a=(); local s="$1, "; while [[ $s =~ ([^,]+),\  ]]; do a+=("${BASH_REMATCH[1]}"); s=${s:${#BASH_REMATCH}}; done; };

## helper functions
function rep {
    local -i i=-1;
    for ((i = 0; i<$1; ++i)); do
        printf %s "$2";
    done;
}; ## end rep()

function testAll {
    local funcs=();
    local args=();
    local func='';
    local -i rc=-1;
    while [[ "$1" != ':' ]]; do
        func="$1";
        if [[ ! "$func" =~ ^[_a-zA-Z][_a-zA-Z0-9]*$ ]]; then
            echo "bad function name: $func" >&2;
            return 2;
        fi;
        funcs+=("$func");
        shift;
    done;
    shift;
    args=("$@");
    for func in "${funcs[@]}"; do
        echo -n "$func ";
        { time $func "${args[@]}" >/dev/null 2>&1; } 2>&1| tr '\n' '/';
        rc=${PIPESTATUS[0]}; if [[ $rc -ne 0 ]]; then echo "[$rc]"; else echo; fi;
    done| column -ts/;
}; ## end testAll()

function makeStringToSplit {
    local -i n=$1; ## number of fields
    if [[ $n -lt 0 ]]; then echo "bad field count: $n" >&2; return 2; fi;
    if [[ $n -eq 0 ]]; then
        echo;
    elif [[ $n -eq 1 ]]; then
        echo 'first field';
    elif [[ "$n" -eq 2 ]]; then
        echo 'first field, last field';
    else
        echo "first field, $(rep $[$1-2] 'mid field, ')last field";
    fi;
}; ## end makeStringToSplit()

function testAll_splitIntoArray {
    local -i n=$1; ## number of fields in input string
    local s='';
    echo "===== $n field$(if [[ $n -ne 1 ]]; then echo 's'; fi;) =====";
    s="$(makeStringToSplit "$n")";
    testAll c_readarray c_read c_regex : "$s";
}; ## end testAll_splitIntoArray()

## results
testAll_splitIntoArray 1;
## ===== 1 field =====
## c_readarray   real  0m0.067s   user 0m0.000s   sys  0m0.000s
## c_read        real  0m0.064s   user 0m0.000s   sys  0m0.000s
## c_regex       real  0m0.000s   user 0m0.000s   sys  0m0.000s
##
testAll_splitIntoArray 10;
## ===== 10 fields =====
## c_readarray   real  0m0.067s   user 0m0.000s   sys  0m0.000s
## c_read        real  0m0.064s   user 0m0.000s   sys  0m0.000s
## c_regex       real  0m0.001s   user 0m0.000s   sys  0m0.000s
##
testAll_splitIntoArray 100;
## ===== 100 fields =====
## c_readarray   real  0m0.069s   user 0m0.000s   sys  0m0.062s
## c_read        real  0m0.065s   user 0m0.000s   sys  0m0.046s
## c_regex       real  0m0.005s   user 0m0.000s   sys  0m0.000s
##
testAll_splitIntoArray 1000;
## ===== 1000 fields =====
## c_readarray   real  0m0.084s   user 0m0.031s   sys  0m0.077s
## c_read        real  0m0.092s   user 0m0.031s   sys  0m0.046s
## c_regex       real  0m0.125s   user 0m0.125s   sys  0m0.000s
##
testAll_splitIntoArray 10000;
## ===== 10000 fields =====
## c_readarray   real  0m0.209s   user 0m0.093s   sys  0m0.108s
## c_read        real  0m0.333s   user 0m0.234s   sys  0m0.109s
## c_regex       real  0m9.095s   user 0m9.078s   sys  0m0.000s
##
testAll_splitIntoArray 100000;
## ===== 100000 fields =====
## c_readarray   real  0m1.460s   user 0m0.326s   sys  0m1.124s
## c_read        real  0m2.780s   user 0m1.686s   sys  0m1.092s
## c_regex       real  17m38.208s   user 15m16.359s   sys  2m19.375s
## 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2018-11-13T13:19:11.633

**纯 bash 多字符分隔符解决方案。**

正如其他人在这个线程中指出的那样，OP的问题给出了一个逗号分隔字符串被解析为数组的例子，但没有表明他/她是否只对逗号分隔符、单字符分隔符或多字符感兴趣分隔符。

由于谷歌倾向于将这个答案排在搜索结果的顶部或附近，我想为读者提供一个关于多字符分隔符问题的强有力的答案，因为至少在一个回复中也提到了这一点。

如果您正在寻找多字符分隔符问题的解决方案，我建议您查看[Mallikarjun M](https://stackoverflow.com/users/6427595/mallikarjun-m)的帖子，特别是[gniourf_gniourf](https://stackoverflow.com/users/1815797/gniourf-gniourf)的回复， 他使用参数扩展提供了这个优雅的纯 BASH 解决方案：

```
#!/bin/bash
str="LearnABCtoABCSplitABCaABCString"
delimiter=ABC
s=$str$delimiter
array=();
while [[ $s ]]; do
    array+=( "${s%%"$delimiter"*}" );
    s=${s#*"$delimiter"};
done;
declare -p array 
```

链接到[引用的评论/引用的帖子](https://stackoverflow.com/questions/40686922/howto-split-a-string-on-a-multi-character-delimiter-in-bash#comment82225797_47633817)

链接到引用的问题：[如何在 bash 中的多字符分隔符上拆分字符串？](https://stackoverflow.com/questions/40686922/howto-split-a-string-on-a-multi-character-delimiter-in-bash)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-03-04T06:02:07.580

试试这个

```
IFS=', '; array=(Paris, France, Europe)
for item in ${array[@]}; do echo $item; done 
```

这很简单。如果需要，您还可以添加声明（并删除逗号）：

```
IFS=' ';declare -a array=(Paris France Europe) 
```

添加 IFS 以撤消上述操作，但在新的 bash 实例中没有它也可以工作

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-05-31T05:56:22.787

在不修改 IFS 的情况下执行此操作的另一种方法：

```
read -r -a myarray <<< "${string//, /$IFS}" 
```

与其更改 IFS 以匹配我们想要的分隔符，我们可以用**via****的内容****替换所有出现的我们想要的分隔符。`", "``$IFS``"${string//, /$IFS}"`**

也许这对于非常大的字符串来说会很慢？

这是基于丹尼斯威廉姆森的回答。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-01-24T16:51:13.547

我在解析如下输入时遇到了这篇文章：word1,word2,...

以上都没有帮助我。通过使用 awk 解决了它。如果对某人有帮助：

```
STRING="value1,value2,value3"
array=`echo $STRING | awk -F ',' '{ s = $1; for (i = 2; i <= NF; i++) s = s "\n"$i; print s; }'`
for word in ${array}
do
        echo "This is the word $word"
done 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-06-09T23:28:20.287

更新：不要这样做，因为 eval 有问题。

稍微少一点仪式：

```
IFS=', ' eval 'array=($string)' 
```

例如

```
string="foo, bar,baz"
IFS=', ' eval 'array=($string)'
echo ${array[1]} # -> bar 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-01-10T15:39:43.030

```
#!/bin/bash

string="a | b c"
pattern=' | '

# replaces pattern with newlines
splitted="$(sed "s/$pattern/\n/g" <<< "$string")"

# Reads lines and put them in array
readarray -t array2 <<< "$splitted"

# Prints number of elements
echo ${#array2[@]}
# Prints all elements
for a in "${array2[@]}"; do
        echo "> '$a'"
done 
```

此解决方案适用于较大的分隔符（超过一个字符）。
如果原始字符串中已有换行符，则不起作用

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2018-01-31T20:45:59.900

**这是我的黑客！**

使用 bash 将字符串按字符串拆分是一件非常无聊的事情。发生的情况是，我们的方法有限，仅在少数情况下有效（由“;”、“/”、“.”等分割），或者我们在输出中有各种副作用。

下面的方法需要一些操作，但我相信它可以满足我们的大部分需求！

```
#!/bin/bash

# --------------------------------------
# SPLIT FUNCTION
# ----------------

F_SPLIT_R=()
f_split() {
    : 'It does a "split" into a given string and returns an array.

    Args:
        TARGET_P (str): Target string to "split".
        DELIMITER_P (Optional[str]): Delimiter used to "split". If not 
    informed the split will be done by spaces.

    Returns:
        F_SPLIT_R (array): Array with the provided string separated by the 
    informed delimiter.
    '

    F_SPLIT_R=()
    TARGET_P=$1
    DELIMITER_P=$2
    if [ -z "$DELIMITER_P" ] ; then
        DELIMITER_P=" "
    fi

    REMOVE_N=1
    if [ "$DELIMITER_P" == "\n" ] ; then
        REMOVE_N=0
    fi

    # NOTE: This was the only parameter that has been a problem so far! 
    # By Questor
    # [Ref.: https://unix.stackexchange.com/a/390732/61742]
    if [ "$DELIMITER_P" == "./" ] ; then
        DELIMITER_P="[.]/"
    fi

    if [ ${REMOVE_N} -eq 1 ] ; then

        # NOTE: Due to bash limitations we have some problems getting the 
        # output of a split by awk inside an array and so we need to use 
        # "line break" (\n) to succeed. Seen this, we remove the line breaks 
        # momentarily afterwards we reintegrate them. The problem is that if 
        # there is a line break in the "string" informed, this line break will 
        # be lost, that is, it is erroneously removed in the output! 
        # By Questor
        TARGET_P=$(awk 'BEGIN {RS="dn"} {gsub("\n", "3F2C417D448C46918289218B7337FCAF"); printf $0}' <<< "${TARGET_P}")

    fi

    # NOTE: The replace of "\n" by "3F2C417D448C46918289218B7337FCAF" results 
    # in more occurrences of "3F2C417D448C46918289218B7337FCAF" than the 
    # amount of "\n" that there was originally in the string (one more 
    # occurrence at the end of the string)! We can not explain the reason for 
    # this side effect. The line below corrects this problem! By Questor
    TARGET_P=${TARGET_P%????????????????????????????????}

    SPLIT_NOW=$(awk -F"$DELIMITER_P" '{for(i=1; i<=NF; i++){printf "%s\n", $i}}' <<< "${TARGET_P}")

    while IFS= read -r LINE_NOW ; do
        if [ ${REMOVE_N} -eq 1 ] ; then

            # NOTE: We use "'" to prevent blank lines with no other characters 
            # in the sequence being erroneously removed! We do not know the 
            # reason for this side effect! By Questor
            LN_NOW_WITH_N=$(awk 'BEGIN {RS="dn"} {gsub("3F2C417D448C46918289218B7337FCAF", "\n"); printf $0}' <<< "'${LINE_NOW}'")

            # NOTE: We use the commands below to revert the intervention made 
            # immediately above! By Questor
            LN_NOW_WITH_N=${LN_NOW_WITH_N%?}
            LN_NOW_WITH_N=${LN_NOW_WITH_N#?}

            F_SPLIT_R+=("$LN_NOW_WITH_N")
        else
            F_SPLIT_R+=("$LINE_NOW")
        fi
    done <<< "$SPLIT_NOW"
}

# --------------------------------------
# HOW TO USE
# ----------------

STRING_TO_SPLIT="
 * How do I list all databases and tables using psql?

\"
sudo -u postgres /usr/pgsql-9.4/bin/psql -c \"\l\"
sudo -u postgres /usr/pgsql-9.4/bin/psql <DB_NAME> -c \"\dt\"
\"

\"
\list or \l: list all databases
\dt: list all tables in the current database
\"

[Ref.: https://dba.stackexchange.com/questions/1285/how-do-i-list-all-databases-and-tables-using-psql]

"

f_split "$STRING_TO_SPLIT" "bin/psql -c"

# --------------------------------------
# OUTPUT AND TEST
# ----------------

ARR_LENGTH=${#F_SPLIT_R[*]}
for (( i=0; i<=$(( $ARR_LENGTH -1 )); i++ )) ; do
    echo " > -----------------------------------------"
    echo "${F_SPLIT_R[$i]}"
    echo " < -----------------------------------------"
done

if [ "$STRING_TO_SPLIT" == "${F_SPLIT_R[0]}bin/psql -c${F_SPLIT_R[1]}" ] ; then
    echo " > -----------------------------------------"
    echo "The strings are the same!"
    echo " < -----------------------------------------"
fi 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2020-03-22T03:17:30.503

由于有很多方法可以解决这个问题，让我们从定义我们希望在我们的解决方案中看到的内容开始。

1.  Bash`readarray`为此提供了一个内置函数。让我们使用它。
2.  避免丑陋和不必要的技巧，例如更改`IFS`、循环、使用`eval`或添加额外元素然后删除它。
3.  找到一种简单易读的方法，可以很容易地适应类似的问题。

该`readarray`命令最容易使用换行符作为分隔符。使用其他分隔符，它可能会向数组添加额外的元素。最简洁的方法是首先将我们的输入调整为一个可以很好地工作的表单，`readarray`然后再将其传入。

此示例中的输入**没有**多字符分隔符。如果我们应用一点常识，最好将其理解为逗号分隔的输入，每个元素可能需要对其进行修剪。我的解决方案是用逗号将输入分成多行，修剪每个元素，并将其全部传递给`readarray`.

```
string='  Paris,France  ,   All of Europe  '
readarray -t foo < <(tr ',' '\n' <<< "$string" |sed 's/^ *//' |sed 's/ *$//')
declare -p foo

# declare -a foo='([0]="Paris" [1]="France" [2]="All of Europe")' 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2020-05-09T16:42:31.100

对于多线元素，为什么不类似

```
$ array=($(echo -e $'a a\nb b' | tr ' ' '§')) && array=("${array[@]//§/ }") && echo "${array[@]/%/ INTERELEMENT}"

a a INTERELEMENT b b INTERELEMENT 
```

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2017-08-09T03:21:05.540

另一种方法是：

```
string="Paris, France, Europe"
IFS=', ' arr=(${string}) 
```

现在您的元素存储在“arr”数组中。遍历元素：

```
for i in ${arr[@]}; do echo $i; done 
```

* * *

## 回答 #21

> 赞同：-3
> 
> 时间：2016-09-13T16:21:10.617

另一种方法可以是：

```
str="a, b, c, d"  # assuming there is a space after ',' as in Q
arr=(${str//,/})  # delete all occurrences of ',' 
```

在这个 'arr' 之后是一个包含四个字符串的数组。这不需要处理 IFS 或读取或任何其他特殊的东西，因此更简单和直接。***

# c++ - 使用变量创建/初始化新对象

> ID：10586159
> 
> 赞同：0
> 
> 时间：2012-05-14T15:16:15.427
> 
> 标签：c++, object, initialization

我打算使用变量初始化或创建一个新对象。该错误表明我声明冲突。

```
 //instantiate new node object***********************
        string peer = "peer";
        string pNo = convertInt(addPeerNum); //convert peer number to string to concatenate 2 strings
        string NewPeerObject = peer+pNo; << ERROR POINTS TO HERE
        nodes NewPeerObject; << ERROR POINTS TO HERE 
```

错误信息：

> 冲突声明 'nodes NewPeerObject' <-- 最后一行错误 'NewPeerObject' 之前的声明为 'string NewPeerObject' <-- 最后第二行

我的主要观点是当我添加更多对等点时创建一个新对象。如果我添加peer 1，它将创建一个新对象“peer1”如果我添加peer 2，它将是“peer2”等。

我正在阅读包含

```
 addpeer 1
 addpeer 100
 addpeer 28 
```

在我的程序中，它读取文件并将数字存储在一个名为“addPeerNum”的变量中，而我这样做，它实际上具有不同的字符串内容“NewPeerObject”。

所以在这种情况下，我实际上是在尝试创建 3 个新对象。

有什么方法可以做到吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:17:42.213

您不能有两个具有相同名称的对象。它违反了**[One definition Rule](http://en.wikipedia.org/wiki/One_Definition_Rule)**，编译器自然会抱怨。
请帮自己一个忙并更改其中任何一个的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:33:28.393

我认为您正在寻找的是一种动态调整大小的对象数组。你可以使用`std::list`来实现那种行为。

```
std::list<PeerObject> list;
PeerObject peer(peer_string);
list.insert(peer); 
```

或者`std::map`如果你想使用你的对等字符串作为键

```
std::map<std::string, PeerObject> peer_map;
PeerObject peer(peer_string);
peer_map.insert(peer_string, peer);
//    .... add more
PeerObject& foundObj = peer_map[a_key];
foundObj.doSomething(); 
```

您也可以使用 MACRO 来执行此操作，但只能在编译时进行，如果可能，您应该避免使用它们。

# sql - 在 dense_rank 查询期间忽略空值

> ID：10586166
> 
> 赞同：1
> 
> 时间：2012-05-14T15:16:35.617
> 
> 标签：sql, oracle

我有一个表格，其中每一行对应于特定日期的对象价格。同一对象的不同行可以有不同日期的价格（它们将具有相同的`object_ids`字段）我试图在单个查询中获取包含每个对象的最新价格的行，如下所示：

```
SELECT
   MAX(price1) KEEP (DENSE_RANK FIRST
ORDER BY day DESC),
MAX(price2) KEEP (DENSE_RANK FIRST
ORDER BY day DESC)

FROM historic_prices H3
GROUP BY object_ids; 
```

不幸的是，当最新价格为 NULL 并且它只返回 NULL 时，这不起作用......有没有办法忽略空值？我什么也找不到。谢谢

编辑：基本上我想做以下事情：

```
table:

col 1 | col 2 | obj_id | date
----------------------------
null  | null  |   1    |  100
----------------------------
5     | null  |   1    |  90
---------------------------
3     | null  |   0    |  80
-----------------------------
7     |  4    |   1    |  70

result : 

col 1 | col 2 | obj_id |
-------------------------
5     | 4     | 1
---------------------
3     | null  | 0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:52:16.480

如果您使用的是 10g+，则可以使用`IGNORE NULLS`分析函数的子句[`FIRST_VALUE`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions066.htm#SQLRF00642)：

```
SELECT DISTINCT 
       object_ids, 
       FIRST_VALUE(price1 IGNORE NULLS)
          OVER (PARTITION BY obj_id ORDER BY DAY DESC
                ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) p1, 
       FIRST_VALUE(price2 IGNORE NULLS) 
          OVER (PARTITION BY obj_id ORDER BY DAY DESC
                ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) p2
  FROM historic_prices; 
```

这适用于 9iR2（至少使用您的数据集）：

```
SQL> WITH DATA AS (
  2     SELECT NULL col1, NULL col2, 1 obj_id, 100 DAY FROM dual
  3     UNION ALL SELECT 5, NULL, 1, 90 FROM dual
  4     UNION ALL SELECT 3, NULL, 0, 80 FROM dual
  5     UNION ALL SELECT 7, 4, 1, 70 FROM dual
  6  )
  7  SELECT obj_id,
  8         MAX(col1)
  9            KEEP (DENSE_RANK FIRST ORDER BY DECODE(col1, NULL, 1, 0),
 10                                            DAY DESC) last_price1,
 11         MAX(col2)
 12            KEEP (DENSE_RANK FIRST ORDER BY DECODE(col2, NULL, 1, 0),
 13                                            DAY DESC) last_price2
 14    FROM DATA
 15   GROUP BY obj_id;

    OBJ_ID LAST_PRICE1 LAST_PRICE2
---------- ----------- -----------
         0           3 
         1           5           4 
```

# python - Python中的程序代码不起作用“不在”语句

> ID：10586172
> 
> 赞同：0
> 
> 时间：2012-05-14T15:16:56.757
> 
> 标签：python, date

这段代码每次都返回不在文件中的日期，我不知道为什么。

```
testDate = open("Sales.txt")

#Declaring variables for later in the program
printNum = 1

newcost = 0

startTestLoop = 1

endTestLoop = 1

#Creating a loop in case input is invalid
while startTestLoop > 0:

    #Asking user for start date
    #startDate = raw_input("Please input the desired start date in the form YYYY,MM,DD: ")

    #Checking if input is valid, and arranging it to be used later
    try :
        startDate = startDate.strip().split(',')
        startYear = startDate[0]
        startMonth = startDate[1]
        startDay = startDate[2]
        startYear = int(startYear)
        startMonth = int(startMonth)
        startDay = int(startDay)
        startDate = date(startYear, startMonth, startDay)
    #Informing user of invalid input
    except:
        "That is invalid input."
        print
    #EndTry

    #Testing to see if date is in the file, and informing user
    if startDate not in testDate:
        print "That date is not in the file."
    #Exiting out of loop if data is fine 
    else:
        startTestLoop -= 1
        print "Aokay"
    #EndIf 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:20:08.917

该表达式`not in`测试可迭代元素（列表、元组，甚至字符串）中元素的成员资格。它不像您假设的那样用于测试日期（或与此相关的任何其他内容）是否在打开的文件中。您必须逐行遍历文件并询问日期（作为字符串）是否在一行中，您可以在*那里*使用`not in`.

**编辑 ：**

正如评论中所建议的，您可以使用：

```
f = open("Sales.txt")
testDate = f.read()
f.close() 
```

...用于将文件中的内容作为字符串读取，但无论如何您需要确保文件中的日期和代码中的日期都使用相同的字符串格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:25:53.797

```
 #assume your Sales.txt contains a list of dates split by space
  if startDate not in testDate.read().split():
        print "That date is not in the file." 
```

# c - 没有这样的文件或目录，但文件在那里

> ID：10586182
> 
> 赞同：1
> 
> 时间：2012-05-14T15:17:16.750
> 
> 标签：c, linux, compilation, gstreamer, kdevelop

我试图在 Kubuntu 12.04 中使用 Kdevelop 编译 gstreamer 插件，但出现以下错误：

```
gcc: error: /usr/lib/libgstvideo-0.10.so: No such file or directory
gcc: error: /usr/lib/libgstcontroller-0.10.so: No such file or directory
gcc: error: /usr/lib/libgstbase-0.10.so: No such file or directory
gcc: error: /usr/lib/libgstreamer-0.10.so: No such file or directory
make: *** [libvpefTEMPLATE.la] Error 1
*** Failed *** 
```

当我 cd 进入 /usr/lib/ 时，文件就在那里，而且它们没有拼写错误或其他任何东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T15:01:33.583

感谢所有帮助过我的人。

我`cd`进入文件夹然后输入

```
file libgstvideo-0.10.so 
```

并得到

```
libgstvideo-0.10.so: broken symbolic link to `libgstvideo-0.10.so.0.24.0' 
```

我搜索了 libgstvideo ，发现当前文件名为 libgstvideo-0.10.so.0.25.0 ，所以我做了以下操作：

```
sudo rm libgstvideo-0.10.so.0.24.0
sudo ln /usr/lib/i386-linux-gnu/libgstvideo-0.10.so.0.25.0 ./libgstvideo-0.10.so 
```

并重复其余的文件。多谢你们。

# php - Drupal Views Nivo Slider "undifined offset error"

> ID：10586186
> 
> 赞同：0
> 
> 时间：2012-05-14T15:17:24.287
> 
> 标签：php, jquery, drupal, drupal-views, nivo-slider

im trying to use the "views nivo slider" module after the minor update to the lates drupal i am always seeing this error

```
Notice: Undefined offset: 0 in template_preprocess_views_nivo_slider_view_nivo_sliderfields() (line 122 of /var/www/html/drupal/modules/views_nivo_slider/views_nivo_slider.module).
Notice: Undefined offset: 0 in template_preprocess_views_nivo_slider_view_nivo_sliderfields() (line 122 of /var/www/html/drupal/modules/views_nivo_slider/views_nivo_slider.module).
Notice: Undefined offset: 0 in template_preprocess_views_nivo_slider_view_nivo_sliderfields() (line 122 of /var/www/html/drupal/modules/views_nivo_slider/views_nivo_slider.module).
Notice: Undefined offset: 0 in template_preprocess_views_nivo_slider_view_nivo_sliderfields() (line 122 of /var/www/html/drupal/modules/views_nivo_slider/views_nivo_slider.module). 
```

It seems the slider is trying to pull in new pages that i have created.

These are the effected lines from views_nivo_slider.module

```
 switch ($id) {
  case $options['image_field']:
  //$image_url = $field_output;
  $field_image_name = "field_{$options['image_field']}";
  $image_url = $field_output = $row->{$field_image_name}[0]['raw']['uri'];
  break; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:20:13.367

Deleted the entire nivo slider install and associated data, and then re-installed.

Problem solved!! :S

# java - 我有一个带有边框的网格，如何绘制网格的内部？

> ID：10586188
> 
> 赞同：1
> 
> 时间：2012-05-14T15:17:31.493
> 
> 标签：java, android, grid

好的，我正在开发一个游戏，它在屏幕上设置一个 12x16 的网格，然后在屏幕上绘制一个图案，如下所示[http://oi49.tinypic.com/53odih.jpg](http://oi49.tinypic.com/53odih.jpg)

我只是想知道是否有一种方法可以使用代码来查看框是否存在于模式中？

这就是我循环我的网格框的方式

```
 //Set all blocks to default
    for(int i=0;i<tilesX;i++){
        for(int j=0;j<tilesY;j++){
            blocks[i][j] = 0;
        }
    } 
```

如果块是模式的一部分，我将块设置为 1。我希望模式内的块设置为 2，但我想不出一种以编程方式执行此操作的方法。图案将始终是一个完整的形状，并将始终连接回起点。

我希望这不会太令人困惑，我愿意为您提供您需要的任何东西，但我只是迷失了如何去做。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:29:19.340

您需要实现[洪水填充算法](http://en.wikipedia.org/wiki/Flood_fill)。根据绘制状态 2 的方式，您可以从形状内的已知点开始填充区域。然后检查它是 0（外部）、1（边界）还是 2（内部）。

我想我在这里掌握了你想要的东西，但如果我不在基地，请告诉我。

# xamarin.android - 升级到 Android 4.2 的 Mono 时，SetRequestedOrientation 不存在

> ID：10586205
> 
> 赞同：3
> 
> 时间：2012-05-14T15:18:06.427
> 
> 标签：xamarin.android

我刚刚升级到 Mono for Android 4.2 版。从那时起，我在尝试`SetRequestedOrientation`从 Activity 调用时遇到错误。只是得到一个错误，说它在当前上下文中不存在。我正在使用 v4.0，这工作正常。

只是想知道自升级后是否还有其他人遇到此问题，或者您是否知道修复。谢谢。

这段代码过去可以正常工作。

```
using System;

using Android.App;
using Android.Content.PM;
using Android.OS;

namespace AndroidApplication1
{
    [Activity(Label = "AndroidApplication1")]
    public class Activity1 : Activity
    {
        protected override void OnCreate(Bundle bundle)
        {
            base.OnCreate(bundle);

            SetRequestedOrientation(ScreenOrientation.Portrait);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-14T15:32:51.023

这是通过[`RequestedOrientation`](http://docs.mono-android.net/?link=P:Android.App.Activity.RequestedOrientation)财产暴露出来的。

```
RequestedOrientation = ScreenOrientation.Portrait; 
```

# .net - 无法将“System.Collections.Generic.List`1[System.Int32]”类型的对象转换为“crmWebService.ArrayOfInt”类型

> ID：10586212
> 
> 赞同：1
> 
> 时间：2012-05-14T15:18:23.990
> 
> 标签：.net, vb.net, exception-handling, casting

将列表发送到 Web 服务后出现错误。

这是调用 Web 服务的代码：

```
Dim sProgramInterest As New List(Of Integer)    
crmService.InsertProspectGetId(sProgramInterest.ToList) 
```

但我收到了这个错误。

> 无法将“System.Collections.Generic.List`1[System.Int32]”类型的对象转换为“crmWebService.ArrayOfInt”类型。

Web服务接受的参数是：

```
ByVal sProgramInterest As List(Of Integer) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:20:04.630

而不是调用`ToList`，调用`ToArray`：

```
crmService.InsertProspectGetId(sProgramInterest.ToArray) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:21:18.860

似乎服务接受 int 数组，而不是 int 列表。因此尝试：

```
crmService.InsertProspectGetId(sProgramInterest.ToArray()) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T18:38:07.680

我假设你必须做类似的事情，

```
Dim sProgramInterest As New crmWebService.ArrayOfInt    
crmService.InsertProspectGetId(sProgramInterest) 
```

根据错误，参数必须是`crmWebService.ArrayOfInt`类型。您必须使用该类而不是`List(Of Integer)`.

# bash - 我在 Bash 脚本中遇到了“预期的一元运算符”

> ID：10586213
> 
> 赞同：15
> 
> 时间：2012-05-14T15:18:45.927
> 
> 标签：bash, if-statement, unary-operator

在我的 Bash 脚本中，我有一个函数为后面的*主*函数的条件返回 0 或 1（真或假）。

```
function1 () {
    if [[ "${1}" =~ "^ ...some regexp... $" ]] ; then
        return 1
    else
        return 0
    fi
} 
```

然后在我的*主要*功能中：

```
main () {
    for arg in ${@} ; do
        if [ function1 ${arg} ] ; then
            ...
        elif [ ... ] ; then
            ...
        fi
    done
} 
```

但是，当我运行此脚本时，它总是给我一条错误消息：

> [：function1：需要一元运算符

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-14T15:20:59.483

您犯了一个常见错误，即假设这`[`是`if`命令语法的一部分。它不是; 的语法`if`很简单

```
if command; then
    ... things which should happen if command's result code was 0
else
    ... things which should happen otherwise
fi 
```

我们常用`command`的 s之一`[`是 command 的别名`test`。这是一个比较字符串、数字和文件的简单命令。它接受相当狭窄的参数组合，并且如果您不将预期参数传递给它，往往会产生令人困惑和误导性的错误消息。（或者更确切地说，一旦您习惯了错误消息，它们就足够了并且很有帮助，但是如果您不习惯它们，它们很容易被误解。）

在您的`main`函数中，调用`[`似乎放错了地方。你大概是说

```
if function "$arg"; then
    ...
elif ... ; then ... 
```

顺便说一句，为了更好地衡量，您还应该始终引用您的字符串。使用`"$1"`not `$1`，而`"$arg"`不是`$arg`。

`test`作者不想将其作为通用厨房水槽的历史原因是其语法的一部分，这`if`是原始 Bourne shell 不太吸引人的设计之一。Bash 并`zsh`提供不太笨拙的替代方案（例如`[[`bash 中的双括号，您在`function1`定义中使用），当然，POSIX`test`比贝尔实验室的原始创建要好得多。

作为附加说明，您的功能可以简化为

```
function1 () {
    ! [[ "$1" =~ "^ ...some regexp... $" ]]
} 
```

也就是说，使用`[[`并反转其结果代码执行测试。（“正常”情况是返回 0 表示成功，但也许您正试图验证字符串不匹配？）

# android - 为什么我的分机中的“#”没有在 Android 中拨号？

> ID：10586216
> 
> 赞同：2
> 
> 时间：2012-05-14T15:18:54.770
> 
> 标签：android

这是我用来拨打电话号码的一些代码。它工作正常，除了我在扩展名中放了一个“#”。',' 将在分机拨号前造成延迟。为什么不拨“#”？基本上，# 之后的任何数字都会被丢弃。

```
String number = "555-555-5555,,1#123"
// # is not dialed, neither are 123
Intent intent = new Intent();
intent.setAction(Intent.ACTION_CALL);
Uri uri = Uri.parse("tel:" + number);
Log.d("URI", uri.toString());
intent.setData(Uri.parse("tel:" + number));
context.startActivity(intent); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:23:50.717

> 字符“#”被排除在外，因为它用于从 URI 引用中的片段标识符分隔 URI

你需要使用`Uri.encode(yourEncodeDailString)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:24:38.743

您需要`String encodedHash = Uri.encode("#")`使用 ACTION_CALL 发送它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-14T19:39:16.887

您也许可以将 # 替换为 %23。

# iphone - Objective c - NSMutableSet 唯一的对象属性

> ID：10586218
> 
> 赞同：18
> 
> 时间：2012-05-14T15:18:58.717
> 
> 标签：iphone, objective-c, nsset, nsmutableset

在我的应用程序中，我有一个`Person`带有`personId`属性的类。
现在我需要一些数据结构来保存一堆独特的`Person`对象（独特的=不同的personId）

所以我想我应该使用 NSMutableSet 作为我的数据结构，但是如何让 NSMutableSet`personId`在添加一个人时比较属性（所以我不会再添加同一个人）？

我的目标是始终拥有一组独特的人（即使我添加了两个具有相同 ID 的人），我希望 NSMutableSet 将为我完成所有艰苦的工作，如果我要添加一个已经存在的人它不会添加两次。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-14T15:34:23.193

您可以通过了解`NSSet`. 当您向集合添加新对象时，会针对集合的每个元素`isEqual:`调用方法（它是一个方法）。`NSObject`因此，您可以做的是覆盖此方法并提供如下自定义比较：

**笔记：**

如果你覆盖`isEqual:`方法，你也**必须**覆盖`hash`方法

```
// In your Person.m
- (BOOL)isEqual:(id)anObject
{
    return [self.personId isEqual:anObject.personId]; 
    // If it's an object. Otherwise use a simple comparison like self.personId == anObject.personId
}

- (NSUInteger)hash
{
    return self.personId; //Must be a unique unsigned integer
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T15:26:12.160

我认为你想要的是一个`NSMutableDictionary`, 映射`personId`到`Person`对象。

```
NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];

Person *person = something;
[dict setObject:personObj forKey:[NSNumber numberWithInt:[person personId]]];
... etc ... 
```

（不要忘记`dict`稍后在某个地方发布）。

为了找到`Person`指定`personId`（例如 12 个）的类，您可以简单地执行以下操作：

```
Person *person = [dict objectForKey:[NSNumber numberWithInt:12]]; 
```

注意：您必须将键和值都存储为对象（不能存储原始类型）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:22:52.043

当您向数组添加项目时，您不必担心这一点。只要您每次都添加一个唯一的对象，对象的属性就无关紧要。

如果您对此感到担心并希望加倍确定，请改用 NSMutableSet（除非您需要维护每个对象的顺序）。

**更新**

您可以使用谓词来检查具有相同值的对象在添加之前是否不存在。这适用于 NSMutableArray 和 NSMutableSet。

```
//create array
NSMutableArray *array = [[NSMutableArray alloc] init];

//create person
Person *newPerson = [[Person alloc] init];

//add person
[array addObject:newPerson]

//check new object exists
if([[array filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"personID == %@", [newPerson personID]]] count] == 0)
{
    //add object
    [array addObject:newPerson];
} 
```

非常粗略的伪代码，但希望你能明白要点:)

# ruby-on-rails - 设置 SQL 数据库架构

> ID：10586221
> 
> 赞同：1
> 
> 时间：2012-05-14T15:19:13.370
> 
> 标签：ruby-on-rails, database-design, sqlite

我有一个需要满足以下条件的数据库：

*   存放各种产品
*   每个产品都属于一个特定的类别
*   需要有大约。14种不同类别的产品
*   每个产品类别的属性略有不同

非常像从头开始构建 PC。您需要机箱、硬盘、mb、cpu 等。它们都有不同的属性。

我对需要多少张桌子感到困惑。如果每个类别都有不同的属性，我是否需要为每个类别创建一个表格？我需要访问每个类别及其相关产品的 CRUD 功能。还是我有一个涵盖所有不同属性的通用产品表？拥有一个包含大量空列的新产品表单似乎有很多冗余。

任何帮助是极大的赞赏！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T15:46:35.487

在设计架构时，您需要识别构成系统的实体。如果产品种类繁多以至于产品表中会有大量的 mull 值，我建议“产品”可能不是实体——如果是，它没有大小、has_gov 等属性等。对于您提供的两个示例，在我看来，即使两者都作为“产品”出售，它们也是离散的实体，您应该为它们提供单独的表格。作为一个速写，可能是这样的：

```
electric_motor
--------------
id
product_id (FK to product.id)
size
mfg_id

receiver
--------
id
product_id (FK to product.id)
num_channels
has_gov
has_volt_reg

product
-------
id
part_num
description
location
price 
```

简而言之，一个类别的每个成员所独有的属性——那些真正将它定义为一个单独实体的属性——一起属于一个表，而所有类别成员作为“产品”共有的那些属性属于一个表。单独的表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:40:02.243

您可能想为自己画下来，这在开始时帮助了我很多！

网上商店最常见的架构是这样的`product_categorie>product_type>product>product_variants`

看看： http: [//guides.rubyonrails.org/migrations.html](http://guides.rubyonrails.org/migrations.html)

关于如何使用帮助器生成表和列，还可以尝试使用 rails for zombies，它将深入了解表关系并附带一些任务要完成。

在学习 RoR 时，这些东西是必须的

学习愉快！

# php - 从局域网中的另一台计算机访问 Zend 应用程序（使用 LAMP）

> ID：10586223
> 
> 赞同：0
> 
> 时间：2012-05-14T15:19:23.880
> 
> 标签：php, zend-framework, lamp, lan, virtual-hosts

您好，我在 Ubuntu 机器和 Zend Framework 项目上设置了 LAMP 服务器。

我在我的 /etc/apache2/sites-available 中创建了一个虚拟主机，使用 a2ensite 命令启用它，并且在 localhost 上一切正常，但是我在使用我的 IP 从局域网中的另一台计算机访问应用程序时遇到问题

如果我去 192.168.xx/application_name/public （那是 index.php 所在的位置），我会得到文件夹列表。

PS：phpmyadmin 工作（192.168.xx/phpmyadmin）

我错过了一些配置吗？

我的虚拟主机

`<VirtualHost *:80>
ServerAdmin xx@localhost
ServerName application.local
ServerAlias www.application.local
DirectoryIndex index.php
DocumentRoot /var/www/application/public/
</VirtualHost>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T20:54:58.847

您需要做的就是在第二台机器上编辑 hosts 文件以添加一个条目

```
192.168.x.x    application.local 
```

其中 192.168.xx 是打开应用程序的机器的 IP 地址，而 application.local 与您的虚拟主机的 ServerName 中的值匹配。然后只需打开浏览器并转到[http://application.local/](http://application.local/)

# c# - 数据绑定类型的组合框并覆盖它们的显示字符串

> ID：10586226
> 
> 赞同：0
> 
> 时间：2012-05-14T15:19:36.830
> 
> 标签：c#, wpf, xaml, data-binding, combobox

这似乎并没有让我的组合框显示更友好的名称。我不确定我做错了什么。

```
<ComboBox ItemsSource="{Binding MyTypes, Mode=OneTime}"
          SelectedItem="{Binding SelectedType}"/> 
```

```
public sealed class MyType : IMyInterface
{
    public override string ToString()
    {
        return "Friendlier Name";
    }
} 
```

另外，我尝试使用`IValueConverter`（不起作用）...

```
<ComboBox ItemsSource="{Binding MyTypes, Mode=OneTime}"
          MemberDisplayPath="{Binding Converter={StaticResource MyConverter}}"
          SelectedItem="{Binding SelectedType}"/> 
```

```
[ValueConversion(typeof(Type), typeof(String))]
public sealed class MyConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var type = value as Type;

        if (type == null)
        {
            return DependencyProperty.UnsetValue;
        }

        return type.ToString();
    }

    ...
} 
```

问题是 IValueConverter 似乎只能获取我的 ViewModel，因为它的值被传入......所以不确定那里发生了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:24:51.947

使用 a`DataTemplate`并在那里应用您的转换器。

```
<ComboBox.ItemTemplate>
    <DataTemplate>
         <TextBlock Text="{Binding Converter={StaticResource MyConverter}}"/>
    </DataTemplate>
</ComboBox.ItemTemplate> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:45:39.023

我为您修复`IValueConverter`了您的问题……只要您绑定到`Type`对象，您就需要创建一个实例并`ToString()`在该实例上使用覆盖。请记住，如果你的类对它们有一些疯狂的构造逻辑，这可能会变得混乱。

```
[ValueConversion(typeof(Type), typeof(String))]
internal sealed class TypeNameConverter : IValueConverter
{
    private static readonly IDictionary<Type, string> TypeNameCache = new Dictionary<Type, string>();
    private static readonly object TypeNameCacheLock = new Object();

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var type = value as Type;

        if (type == null)
        {
            return DependencyProperty.UnsetValue;
        }

        string result;

        lock (TypeNameCacheLock)
        {
            if (!TypeNameCache.TryGetValue(type, out result))
            {
                var instance = Activator.CreateInstance(type);

                result = instance.ToString();

                TypeNameCache.Add(type, result);
            }
        }

        return result;
    }

    ...
} 
```

* * *

这部分是从 HB 的答案中复制的，它是工作所必需的:)

```
<ComboBox.ItemTemplate>
    <DataTemplate>
         <TextBlock Text="{Binding Converter={StaticResource MyConverter}}"/>
    </DataTemplate>
</ComboBox.ItemTemplate> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:26:55.707

您正在使用的属性实际上被称为`DisplayMemberPath`，它的工作方式比您的代码建议的要简单得多。

像这样更改您的代码：

```
public sealed class MyType : IMyInterface
{
    public string FriendlyName
    {
        get { return "Friendlier Name"; }
    }
} 
```

然后在您的 Xaml 集中`DisplayMemberPath="FriendlyName"`，您就完成了。

（我建议把你的转换器扔掉。如果你要将整个类转换为字符串值，那么通常有一种更简单的方法。）

# autofac - 为什么 IContainer.IsRegistered(Type serviceType) 添加注册？

> ID：10586227
> 
> 赞同：0
> 
> 时间：2012-05-14T15:19:41.620
> 
> 标签：autofac

为什么 IContainer.IsRegistered(Type serviceType) 添加注册？

```
Type serviceType = typeof (string[]);
int rc = container.ComponentRegistry.Registrations.Count();
container.IsRegistered(serviceType);
int rc2 = container.ComponentRegistry.Registrations.Count();
Assert.AreEqual(rc, rc2); 
```

上述行为可能会产生以下副作用：

```
public class Test
{
      public Entity[] Entities { get; set; }
}
//...
var bldr = new ContainerBuilder();
bldr.RegisterModule<ArraysInjectionGuardModule>();
var container = bldr.Build();
var t = new Test();
container.InjectProperties(t);
Assert.IsNull(t.Entities); 
```

因为`container.InjectProperties(...);`调用`container.IsRegistered(..)`并`typeof(Entity[])`作为参数传递，所以 t.Entities 使用空数组进行初始化。当我发现这种行为时，我有点困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T10:24:12.173

我发现上述行为是[设计使然](https://groups.google.com/d/msg/autofac/VYDnoDjZy6o/-kQga1fQ2GUJ)

这是避免注入空数组的解决方法。
它使用反射，因此使用这种方法需要您自担风险。
请注意，它**会降低分辨率性能**。您只需要注册以下模块：

```
containerBuilder.RegisterModule<ArraysInjectionGuardModule>();

class ArraysInjectionGuardModule : Module
{
    protected override void AttachToComponentRegistration(IComponentRegistry componentRegistry,
        IComponentRegistration registration)
    {
        registration.Activating += (s, e) =>
        {
            var ts = e.Component.Services.Single() as TypedService;
            if (ts != null && ts.ServiceType.IsArray &&
                !e.Context.IsRegistered(ts.ServiceType.GetElementType()))
            {
                FieldInfo t = e.GetType().GetField("_instance",
                                                   BindingFlags.Instance | BindingFlags.NonPublic);
                t.SetValue(e, null);
            }
        };
    }
} 
```

# ios - iOS 编程风格——人们通常会在哪里期待@synthesize 语句？

> ID：10586228
> 
> 赞同：0
> 
> 时间：2012-05-14T15:19:43.800
> 
> 标签：ios, coding-style

我已经看到了 @synthesize 语句放置的各种风格变化。我想知道 - 对此是否存在多数共识，或者，如果没有，来自集中式样式指南（即苹果指南）的关于放置它们的位置的声明？

请提供参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:22:49.610

您可以在@implementation 块中使用@synthesize 和@dynamic 指令。

[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocProperties.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocProperties.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:33:22.003

是的，当然它在@implementation 中……但我认为这不是问题所在。

我想知道同样的问题，如

*   @synthesize 到底在哪里？
*   为要加载的每个属性编写@synthesize，还是将每个属性链接在一行中？

绝对没有区别，我不确定是否有某种约定，但这是我的；）：

*   @implementation 和 @synthesize 之间有一行
*   按含义分组的属性（例如，一行 UI、一行数据结构等...）

    ```
    @implementation MyClass

    @synthesize label1, label2, button;
    @synthesize array, dictionay; 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T15:36:35.027

通常就`@implementation ClassName`在线以下

这样您就可以轻松查看它们并轻松添加新的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T15:44:18.427

在 Apple 的示例中，他们将 @synthesize 语句放在实现的顶部。这似乎是很多人这样做的方式。我认为主要是因为苹果就是这样做的。

我更喜欢将它们放在实现的底部。我尝试以最重要的代码靠近顶部的方式对我的代码进行排序。坦率地说，属性不应该那么有趣。如果您的属性中有任何不是样板的东西，那么您很可能做错了。

我的顺序通常是公共方法、视图生命周期、委托回调、私有方法、内存管理，然后是合成属性（带有访问器）。

# xml - 有什么方法可以加快 JAXB 编组？

> ID：10586231
> 
> 赞同：5
> 
> 时间：2012-05-14T15:19:54.057
> 
> 标签：xml, jaxb, schema, marshalling

有什么方法可以加快对**JAXB** `Marshaller.marshal(Object, OutputStream)`的调用？

我正在处理的项目是使用 JAXB 来 [un] 编组具有相当大的 XML 模式的对象。通话`someJaxbMarshaller.marshal(results, out)`需要 2 秒才能完成。其他一切（JPA 获取、空间过滤、相当多的其他逻辑）只需要大约 1 秒。所以使用 JAXB 使我的请求响应时间增加了三倍。我正在缓存 JAXBContext 和 Marshaller 对象，以尽可能加快速度。只有实际的编组让我放慢了速度。有什么建议么？

我正在使用与**JAX-WS 2.2.3**捆绑在一起的**JAXB 2.2.3u1**。较新的版本似乎破坏了很多东西，所以我们被锁定在那个版本的 JAXB 中（覆盖使用*JAXB 2.2.4u1的包含 Java 的**JAX-WS 2.2.5* - 我们不能使用它，因为它会引发负载）。我们也在**JDK 1.3.0_30**上，它正在*Eclipse Indigo*中运行。我看到了使用 Woodstox 的建议，但*JAX-WS 2.2.3*已经包含它。我尝试将其换成最新版本，但这会使编组速度减慢了约 0.2 秒。删除 Woodstox 与使用 JAX-WS 中包含的版本具有完全相同的性能。****`NullPointerException`****

 *******支持正在编组的对象的架构大小约为**5 MB**。JAXB 生成的实际 XML 文档大小为**117 KB**。*******

# qtp - QTP：为什么总是调用智能识别？

> ID：10586242
> 
> 赞同：1
> 
> 时间：2012-05-14T15:20:25.960
> 
> 标签：qtp

显然，我是 QTP 的新手。我用它来测试一个包含多种表单的 HTML 页面；一个接一个。

它曾经工作得很好。现在我经常看到这个：

调用了智能识别机制 - 未找到对象。

为什么会这样？我要做的就是将焦点设置为文本输入并输入一些数据并单击提交。

任何有用的提示都会很棒。QTP 有如此陡峭的学习曲线。

谢谢！

让我更具体一点：这个 HTML 页面上有 40 个表单，其中一些使用具有相同名称属性的输入元素。这是问题吗？

```
<input type="text" name="meetingId" />
<input type="text" name="meetingid" /> 
```

请注意这两个示例中的 meetingId/meetingid 区分大小写。这是一个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T18:02:06.113

当 QTP 记录（或学习）一个对象时，它会捕获一组足以唯一标识该对象的属性/值。此外，如果启用了智能识别，它将捕获一些额外的属性/值对以供将来使用。

在执行测试时，如果找不到要识别的对象（没有元素与描述匹配或有多个元素匹配），它将尝试使用*额外的*属性来查找元素。

如果一开始您的测试在没有触发智能识别的情况下运行，现在它被触发，则意味着 HTML 已更改，因此描述不再唯一标识元素，QTP 对测试描述的元素做出有根据的猜测（显然在你的情况是一个很好的猜测，因为测试仍然有效）。

QTP 认为这是次优的，因为它确实是一个猜测，这就是智能识别出现在报告中的原因。实际上，系统会提示您通过改进测试对象的描述来改进您的测试。

* * *

**更多***细节**：*如果在*对象*`Tools -> Object Identification`识别对话框*（* _ 序号标识符被认为是最后的手段，QTP 将在使用序号标识符**之前**尝试使用智能识别。因此，如果您的对象使用序号标识符，即使 HTML 页面根本没有更改，它也会使用智能标识。 此规则的例外是使用*`Index`*`N``#X`* **`source index`（并从 QTP 11 开始生成的 XPath 表达式）可能有助于识别对象。如果这些是活动的 ( `Tools -> Options -> Web -> Advanced -> Run settings`) 并且建议的元素与现有描述匹配（不包括序号标识符）**，则不**使用智能标识。***

 ***如果您检查`Browser`的对象标识，您将看到描述中没有列出**任何**属性，因此如果存在多个浏览器，我们将始终获得一个序号，并且智能标识将尝试运行。***

# hadoop - hbase 找不到现有表

> ID：10586246
> 
> 赞同：18
> 
> 时间：2012-05-14T15:20:33.760
> 
> 标签：hadoop, hbase, opentsdb

我建立了一个 hbase 集群来存储来自 opentsdb 的数据。最近由于部分节点重启，hbase 丢失了“tsdb”表。我仍然可以在 hbase 的主节点页面上，但是当我点击它时，它给了我一个 tableNotFoundException

```
org.apache.hadoop.hbase.TableNotFoundException: tsdb
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegionInMeta(HConnectionManager.java:952)
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:818)
    at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:782)
    at org.apache.hadoop.hbase.client.HTable.finishSetup(HTable.java:249)
    at org.apache.hadoop.hbase.client.HTable.<init>(HTable.java:213)
    at org.apache.hadoop.hbase.client.HTable.<init>(HTable.java:171)
...... 
```

我进入 hbase shell，试图找到“tsdb”表，但得到了类似的消息

```
hbase(main):018:0> scan 'tsdb'
ROW                                                          COLUMN+CELL

ERROR: Unknown table tsdb! 
```

但是，当我尝试重新创建此表时，hbase shell 告诉我该表已经存在...

```
hbase(main):013:0> create 'tsdb', {NAME => 't', VERSIONS => 1, BLOOMFILTER=>'ROW'}

ERROR: Table already exists: tsdb! 
```

而且我还可以在 hbase shell 中列出表

```
hbase(main):001:0> list
TABLE
tsdb
tsdb-uid
2 row(s) in 0.6730 seconds 
```

查看日志，我发现这应该是我的问题的原因

```
2012-05-14 12:06:22,140 WARN org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation: Encountered problems when prefetch META table:
org.apache.hadoop.hbase.TableNotFoundException: Cannot find row in .META. for table: tsdb, row=tsdb,,99999999999999
    at org.apache.hadoop.hbase.client.MetaScanner.metaScan(MetaScanner.java:157)
    at org.apache.hadoop.hbase.client.MetaScanner.access$000(MetaScanner.java:52)
    at org.apache.hadoop.hbase.client.MetaScanner$1.connect(MetaScanner.java:130)
    at org.apache.hadoop.hbase.client.MetaScanner$1.connect(MetaScanner.java:127) 
```

它说在.META中找不到tsbb行，但.META中确实有tsdb行。

```
hbase(main):002:0> scan '.META.'
ROW                                                          COLUMN+CELL
 tsdb,\x00\x00\x0FO\xA2\xF1\xD0\x00\x00\x01\x00\x00\x0E\x00\ column=info:regioninfo, timestamp=1336311752799, value={NAME => 'tsdb,\x00\x00\x0FO\xA2\xF1\xD0\x00\x00\x01\x00\x00\x0E\x00\x00\x02\x00\x00\x12\x00\x00\x03\x00\x00\x13\x00\x00\x
 x00\x02\x00\x00\x12\x00\x00\x03\x00\x00\x13\x00\x00\x05\x00 05\x00\x001,1336311752340.7cd0d2205d9ae5fcadf843972ec74ec5.', STARTKEY => '\x00\x00\x0FO\xA2\xF1\xD0\x00\x00\x01\x00\x00\x0E\x00\x00\x02\x00\x00\x12\x00\x00\x03\x00\x00\x13\x00\
 \x001,1336311752340.7cd0d2205d9ae5fcadf843972ec74ec5\.       x00\x05\x00\x001', ENDKEY => '\x00\x00\x10O\xA3\x8C\x80\x00\x00\x01\x00\x00\x0B\x00\x00\x02\x00\x00\x19\x00\x00\x03\x00\x00\x1A\x00\x00\x05\x00\x001', ENCODED => 7cd0d2205d9ae5f
                                                             cadf843972ec74ec5,}
 tsdb,\x00\x00\x0FO\xA2\xF1\xD0\x00\x00\x01\x00\x00\x0E\x00\ column=info:server, timestamp=1337011527000, value=brycobapd01.usnycbt.amrs.bankofamerica.com:60020
 x00\x02\x00\x00\x12\x00\x00\x03\x00\x00\x13\x00\x00\x05\x00
 \x001,1336311752340.7cd0d2205d9ae5fcadf843972ec74ec5.
 tsdb,\x00\x00\x0FO\xA2\xF1\xD0\x00\x00\x01\x00\x00\x0E\x00\ column=info:serverstartcode, timestamp=1337011527000, value=1337011518948
......

 tsdb-uid,,1336081042372.a30d8074431c6a31c6a0a30e61fedefa.   column=info:server, timestamp=1337011527458, value=bry200163111d.usnycbt.amrs.bankofamerica.com:60020
 tsdb-uid,,1336081042372.a30d8074431c6a31c6a0a30e61fedefa.   column=info:serverstartcode, timestamp=1337011527458, value=1337011519807
6 row(s) in 0.2950 seconds 
```

这是我在集群上运行“hbck”后的结果

```
ERROR: Region hdfs://slave-node-1:9000/hbase/tsdb/249438af5657bf1881a837c23997747e on HDFS, but not listed in META or deployed on any region server
ERROR: Region hdfs://slave-node-1:9000/hbase/tsdb/4f8c65fb72910870690b94848879db1c on HDFS, but not listed in META or deployed on any region server
ERROR: Region hdfs://slave-node-1:9000/hbase/tsdb/63276708b4ac9f11e241aca8b56e9def on HDFS, but not listed in META or deployed on any region server
ERROR: Region hdfs://slave-node-1:9000/hbase/tsdb/e54ee4def67d7f3b6dba75a3430e0544 on HDFS, but not listed in META or deployed on any region server
ERROR: (region tsdb,\x00\x00\x0FO\xA2\xF1\xD0\x00\x00\x01\x00\x00\x0E\x00\x00\x02\x00\x00\x12\x00\x00\x03\x00\x00\x13\x00\x00\x05\x00\x001,1336311752340.7cd0d2205d9ae5fcadf843972ec74ec5.) First region should start with an empty key.  You need to  create a new region and regioninfo in HDFS to plug the hole.
ERROR: Found inconsistency in table tsdb
Summary:
  -ROOT- is okay.
    Number of regions: 1
    Deployed on:  master-node,60020,1337011518948
  .META. is okay.
    Number of regions: 1
    Deployed on:  slave-node-2,60020,1337011519845
Table tsdb is inconsistent.
    Number of regions: 5
    Deployed on:  slave-node-2,60020,1337011519845 slave-node-1,60020,1337011519807 master-node,60020,1337011518948
  tsdb-uid is okay.
    Number of regions: 1
    Deployed on:  slave-node-1,60020,1337011519807
5 inconsistencies detected.
Status: INCONSISTENT 
```

我跑了

```
bin/hbase hbck -fix 
```

不幸的是，这并不能解决我的问题

有人可以帮我解决这个问题吗

1.  是否可以恢复此表“tsdb”？
2.  如果 1 无法完成，是否建议优雅地删除“tsdb”并创建一个新的？
3.  如果有人可以让我知道重新启动节点的最建议方法是什么，我将不胜感激？目前，我让我的主节点始终处于运行状态。对于其他节点，我在重新启动后立即运行此命令。

命令：

```
# start data node
bin/hadoop-daemon.sh start datanode
bin/hadoop-daemon.sh start jobtracker    
# start hbase
bin/hbase-daemon.sh start zookeeper
bin/hbase-daemon.sh start regionserver 
```

非常感谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2017-02-22T08:53:44.627

有点晚了，也许它对搜索者有帮助。

1.  运行 ZooKeeper 外壳`hbase zkcli`
2.  在外壳运行`ls /hbase/table`
3.  跑`rmr /hbase/table/TABLE_NAME`
4.  重启Hbase

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T17:44:17.603

我不太确定您为什么无法扫描它。但是，要重新创建表，您可以尝试以下操作：

1）手动删除该表的.META表中的所有条目，并且

2）从HDFS中删除该表对应的目录

之后再次尝试创建表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-06T08:34:24.793

如果您使用的是 cdh4.3，那么 zookeeper 中的路径应该是 /hbase/table94/

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-22T12:11:32.630

要扩展@Devin Bayer 的答案，请运行：

```
delete /hbase/table/<name_of_zombie_table> 
```

如果您发现动物园管理员正在维护任何僵尸表。有关此问题的更多帮助，您应该搜索“HBase 僵尸表”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-11T08:14:50.240

尝试修复元

1.  hbase hbck
2.  hbase hbck -fixMeta
3.  hbase hbck -fixAssignments
4.  hbase hbck -fixReferenceFiles

之后再试一次

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-07T23:41:08.503

有关删除表的更多说明：

```
~/hbase-0.94.12/bin/hbase shell

> truncate 'tsdb'
> truncate 'tsdb-meta'
> truncate 'tsdb-uid'
> truncate 'tsdb-tree'
> exit 
```

我还不得不重新启动 tsd 守护进程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-11T18:01:48.747

当我在没有访问 HBase 机器的 TCP 权限的机器上尝试来自 Java 客户端的 HBase 连接时，我收到了类似的错误消息。当我在 HBase 机器上执行 hbase shell 时，该表确实存在。

opentsdb 是否具有访问 HBase 机器的所有权限/端口配置？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-24T16:17:36.900

我在工作场所确实面临这些问题。我通常要么删除 znodes 并删除相应的表，要么重新启动 hbase HMaster 和 Hregionserver 以使 hbck 状态正常。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-08-25T14:17:42.583

从 Zookeeper 路径中删除指定的表就足够了。例如，如果**zookeeper.znode.parent**配置为hbase-site.xml 中的**blob**，您应该在 zookeeper 服务器 shell 中启动并通过命令**`zkCli.sh`**删除该目录。**`rmr /blob/table/tsdb`**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-03T13:41:12.260

`hbase-clean.sh --cleanZk`

它工作得很好，很简单。

# java - AspectJ 属性的问题

> ID：10586248
> 
> 赞同：2
> 
> 时间：2012-05-14T15:20:46.300
> 
> 标签：java

当我在我的应用程序中使用维护J 进行逆向工程时，我收到以下错误。请协助我们修复

---- AspectJ 属性 --- AspectJ 编译器 1.6.11 于格林威治标准时间 2011 年 3 月 15 日星期二 15:31:04 构建 ---- 转储属性 --- 转储文件：ajcore.20120507.210546.187.txt 转储原因： java.lang.NullPointerException 异常转储：true 退出条件转储：abort ---- 异常信息 --- java.lang.NullPointerException at org.aspectj.weaver.bcel.LazyMethodGen.remap(LazyMethodGen.java:1415) at org.aspectj.weaver.bcel.LazyMethodGen.addExceptionHandlers(LazyMethodGen.java:1269) 谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:35:09.087

您遇到的错误类似于[MaintainJ 博客](http://maintainj.com/blog/?p=36)中描述的错误。

基本上，您需要从范围中排除导致类的麻烦。典型的 CGLIB 异常如下：

```
SEVERE: xxx/yyy/zzz/SampleClassABC$$FastClassByCGLIB$$2eb78e34
java.lang.NullPointerException
    at org.aspectj.weaver.bcel.LazyMethodGen.remap(LazyMethodGen.java:1415)
    at org.aspectj.weaver.bcel.LazyMethodGen.addExceptionHandlers(LazyMethodGen.java:1269) 
```

您可以在 aop.xml 文件中排除此类，如下所示：

```
<exclude within="xxx.yyy.zzz.SampleClassABC*ByCGLIB*"/> 
```

以类似的方式排除所有导致类的问题并重新启动服务器。我们基本上从 AspectJ 工具中排除了 CGLIB 生成的代理类。

# c - 一行矩阵分配

> ID：10586249
> 
> 赞同：1
> 
> 时间：2012-05-14T15:20:48.627
> 
> 标签：c, arrays, memory-management, matrix

观看在互联网上找到的一些代码，我遇到了这段代码：

```
int (*p)[3];

p = (int(*)[3]) calloc(5*3,sizeof(int)); 
```

它只是一种分配矩阵的方法吗？

我知道这`int (*p)[3]`会创建一个指向 3 int 数组的指针，但我不确定`calloc`调用：我知道`calloc`分配和初始化`int`（在本例中）等于第一个参数 ( `5*3`) 的数量。
因此，如果我将它分配给`p`它应该意味着指针现在指向刚刚分配的内存位置。

所以，既然我知道我的推理是错误的，有人可以纠正我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:24:46.827

```
int (*p)[3]; 
```

你确实这是一个指向三个整数数组的指针，但是这个指针也可以指向一个由三个整数**组成的数组**的开头。

```
p = (int(*)[3]) calloc(5*3,sizeof(int)); 
```

在这里，您为此指针分配了 5 * 3 个整数。与`int[3]`3 个整数一样，您刚刚分配了 5 个这样`int[3]`的数组。

然后，您可以将这些`int[3]`数组称为

`p[0]`...`p[4]`

所以你得到一个二维数组

`p[0][0]`...`p[0][2]`

`p[4][0]`...`p[4][2]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:24:29.947

你的理解是正确的。 `calloc`分配并清零足够的连续内存以容纳 15`int`秒，并返回指向其开头的指针。

# php - PHP & MySQL - 比较存储的 IP

> ID：10586259
> 
> 赞同：0
> 
> 时间：2012-05-14T15:21:36.127
> 
> 标签：php, mysql

我正在尝试创建一个系统来存储最后登录的 IP，并将其与当前 IP 进行比较，然后稍后执行一些功能，但目前，如果不转到最后一个 else 语句，我无法比较它们。这是代码。

```
<?php

$userToPull = $session->userinfo['username'];

$query = "SELECT * FROM users WHERE username='$userToPull'";
            $result = mysql_query($query);      

            while($row = mysql_fetch_row($result)){

                    $userToShow = $row[25];
                    $IPtoVerify = $row[26];

                    }

$lastActivity = RelativeTime($userToShow);
$currIP = $_SERVER['REMOTE_ADDR'];

/*

Shows Partner Stuff

}elseif(!$session->isAdmin()){

echo "<div style='text-align:right;' id='homebox'";
echo "<b>Partner Total:</b> ".$database->getNumMembers()."<br>";
echo $database->num_active_users." partners logged in and ";
echo $database->num_active_guests." guests viewing the site.<br><br>";
echo "</div>";

*/

if(!$IPtoVerify == $currIP){

echo "<div style='text-align:right; background-color: #FAAAB3' id='homebox_partner'";
echo "<b>You are logged on from an unrecognized location.</b><br>";
echo "You will be sent a notification for security purposes.";
echo "<br>This location will automatically be remembered.";
echo "</div><br>";

}elseif($IPtoVerify == $currIP){

echo "<div style='text-align:right;' id='homebox_partner'";
echo "<b>You are logged on from a recognized location.</b><br>";
echo "Your IP is ".$_SERVER['REMOTE_ADDR'];
echo "<br>Your last login was approximately ".$lastActivity;
echo "</div><br>";

}else{

echo "<div style='text-align:right;' id='homebox_partner'";
echo "<b>An error has occurred.</b><br>";
echo "</div><br>";

}

?> 
```

唯一不起作用的是`if(!$IPtoVerify == $currIP){`if 语句。

IP 以正常方式存储，echo 类似于：100.100.100.100。（正常时尚）

也许我没有正确比较它们，但它在过去对我有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:27:18.807

这段代码不符合你的想法：

```
if (!$IPtoVerify == $currIP) { 
```

PHP 将其解释为：

```
if ((!$IPtoVerify) == $currIP) { 
```

你会想把它写成：

```
if ($IPtoVerify != $currIP) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:25:47.970

尝试`($IPtoVerify !== $currIP)`代替`(!$IPtoVerify == $currIP)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:29:52.077

```
!$IPtoVerify == $currIP 
```

方法

```
0==$currIP, 
```

因为它首先验证

```
`!$IPtoVerify` 
```

除非 $IPtoVerify 为 1，否则它总是返回 0。

添加额外的括号，例如

```
if(!($IPtoVerify == $currIP))... 
```

解决问题。

# postgresql - 如何使用 Postgresql 全文搜索来模拟 Solr“更像这个查询”？

> ID：10586262
> 
> 赞同：6
> 
> 时间：2012-05-14T15:22:03.180
> 
> 标签：postgresql, solr

我想模拟这种类型的 Solr 查询：

[http://wiki.apache.org/solr/MoreLikeThis](http://wiki.apache.org/solr/MoreLikeThis)

使用 PostgreSQL 的全文搜索工具。

有没有办法用纯 postgres 做类似“更像这样”的查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T04:38:42.277

恐怕不是开箱即用。可能可以比较两个 tsvector 以确定它们是否足够相似，或者提取前 n 个相似的 tsvector，但是没有开箱即用的功能可以做到这一点。好消息是，由于 tsvectors 支持 GIN 索引，复杂的部分已经为您完成了。

我认为您需要做的是在 C 中创建一个函数，该函数确定两个 tsvector 的交集。从那里您可以创建一个确定它们是否重叠的函数和一个解决此问题的运算符。从那里创建基于最大重叠的排名应该不会太难。

当然，我怀疑这在像 C 这样的语言中是最容易做到的，但如果需要，你也可以使用其他过程语言。

PostgreSQL 的美妙之处在于一切皆有可能。当然，缺点是当您远离核心功能时，您需要自己做很多事情。

# ios - 日本书画图书馆

> ID：10586264
> 
> 赞同：0
> 
> 时间：2012-05-14T15:22:11.027
> 
> 标签：ios, graphics, drawing

我想在 iOS 上制作一个用于日本书法的绘图软件，如下页所示。 [http://www1.mahoroba.ne.jp/~matumoto/msyoS.html](http://www1.mahoroba.ne.jp/~matumoto/msyoS.html)

所以，我很期待一些用于绘制日本书法的图书馆。

当然，该库不兼容 iOS 也没关系。

有人有什么主意吗？

# javascript - 是否可以从外部页面链接到超大幻灯片中的图像？

> ID：10586265
> 
> 赞同：-1
> 
> 时间：2012-05-14T15:22:11.167
> 
> 标签：javascript, jquery, supersized

我仍在尝试使用单击事件来充当指向超大幻灯片中的幻灯片的链接。是不是毫无意义？拜托，如果有人有任何想法，我很想读一读。

[http://api.jquery.com/click/](http://api.jquery.com/click/)

我正在尝试使用为超大幻灯片引用的 .click 函数。

```
api.goTo

$(element).click(function(){
api.goTo(5);
}); 
```

该功能将在页面内工作，但我将如何从外部页面链接？我有一个充满缩略图的页面，并试图将每个缩略图链接到幻灯片页面上的相应幻灯片。不确定这是否可能。这个事情谁有经验？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:16:34.160

您的链接最好将页码包含为查询字符串变量，例如：

```
<a href="mydomain.com/myslideshow?page=5">Slideshow p.5</a> 
```

然后您可以使用一些 javascript 获取查询字符串变量（有关如何执行此操作的示例，请参见定义为*getParameterByName*的 fn ：[如何在 JavaScript 中获取查询字符串值？](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript)）

```
var pageNumber = getParameterByName(page);

$(element).click(function(){
    api.goTo(pageNumber);
}); 
```

# android - 在 web 视图中打开一个 Sqlite 数据库

> ID：10586269
> 
> 赞同：1
> 
> 时间：2012-05-14T15:22:19.857
> 
> 标签：android, html, sqlite, webview

我在使用 android webview、SQLite 和我的目标设备时遇到了一些问题。在物理设备上，无法访问数据库（请参阅最后的错误）。

webview的设置：

```
 settings.setJavaScriptEnabled(true);
    settings.setDatabaseEnabled(true);
    settings.setDatabasePath("/data/data/de.sqlite.webview/databases"); 
```

我在`onCreate`方法中定义了 webview，并将更新配额设置为估计值的两倍或大于 HTML5 定义中的值。

```
mWebView.setWebChromeClient(new WebChromeClient() {
    @Override
    public void onExceededDatabaseQuota(String url, String databaseIdentifier, long currentQuota, long estimatedSize, long totalUsedQuota, WebStorage.QuotaUpdater quotaUpdater)
    {
            quotaUpdater.updateQuota(204801); //estimatedSize * 2
    }
}); 

    mWebView.setWebViewClient(new WebViewClient() {                 
    @Override
    public boolean shouldOverrideUrlLoading( ... ) 
    } 
```

在 Emulator 和 Chrome 上一切正常，但如果我将应用程序部署到我的 galaxy2 我会收到一个错误：***openDatabase is not defined***。

以下 html 代码适用于 chrome 和模拟的 webview：

```
 db = new HKSQL();
    db.openSQL();
    today = getTodayDate();
    createDbTable_LastLogin();

    //HKSQL Class 
    function HkSQL(){
    this.query;
    this.result;
    this.database;
    }

    HkSQL.prototype.openSQL = function(){
    this.database = openDatabase("hkapp","1.0","HKApp","65536");    
    } 

    //an example query to create my db
    CREATE TABLE IF NOT EXISTS HK_lastlogin (id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, datum TEXT NOT NULL) 
```

我不知道为什么它在我的设备上不起作用。我考虑了读写权限，但`.db`文件已经创建。以下是一些我认为针对相同问题的错误消息：

```
Uncaught ReferenceError: openDatabase is not defined 
Uncaught TypeError: Object [object DOMWindow] has no method 'openDatabase' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T05:48:35.373

答案是**两个**Webview 都需要初始化为具有完整功能的 WebChromeClients。

```
myWebView = (WebView) findViewById(R.id.l_webview);

myWebView.setWebViewClient(new WebViewClient() {  });
myWebView.setWebChromeClient(new WebChromeClient() { ... } );

myWebView2 = (WebView) findViewById(R.id.l_navi);

myWebView2.setWebViewClient(new WebViewClient() {        });
myWebView2.setWebChromeClient(new WebChromeClient() { ... } ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:01:08.653

那不应该`dbclassname.openDatabase`代替`window.openDatabase`吗？

**编辑**

[这里](https://stackoverflow.com/a/2474524/1105376)有一个 SO 答案，我看到他们所拥有的和你所拥有的之间的唯一区别是这一行：

```
settings.setJavaScriptCanOpenWindowsAutomatically(true); 
```

尝试添加它，然后看看它是否有效。

**编辑 2**

您尚未设置 LinearLayout 的方向，因此它默认为水平，其中您有两个使用 layout_width="match_parent" 的 webview，这会将第二个 webview 推离屏幕。

您应该添加`android:orientation="vertical"`到线性布局 xml，并将 l_webview 更改为`android:layout_height="0dp" android:layout_weight="1"`. 这将使 l_webview 在另一个就位后占用所有剩余空间。

我不知道这是否会解决您的问题，但它会使两个视图都可见，而无需将一个视图推离屏幕。

您还需要使用 findViewById 来获取每个单独视图的 id。

# kentico - 内容分级控制始终隐藏

> ID：10586279
> 
> 赞同：2
> 
> 时间：2012-05-14T15:22:51.463
> 
> 标签：kentico

我已将以下代码添加到新闻列表 Web 部件的选定转换中：

```
<%@ Register Src="~/CMSAdminControls/ContentRating/RatingControl.ascx" TagName="RatingControl" TagPrefix="cms" %>

<cms:RatingControl ID="elemRating" runat="server" Enabled="true" RatingType="Stars"  ExternalValue='
<%# Convert.ToString(CMS.GlobalHelper.ValidationHelper.GetDouble(Eval("DocumentRatingValue"), 0)/((CMS.GlobalHelper.ValidationHelper.GetDouble(Eval("DocumentRatings"), 0) == 0?1:CMS.GlobalHelper.ValidationHelper.GetDouble(Eval("DocumentRatings"), 1)))) %>' /> 
```

所选转换的其余部分与默认值相同。

根据 Kentico[文档](http://devnet.kentico.com/docs/devguide/index.html)，这应该将 webpart 添加到新闻项目的详细信息页面。

由于某种原因，输入标签呈现如下：

```
<input type="hidden" name="p$lt$zoneContent$pageplaceholder$pageplaceholder$lt$News$NewsList$repItems$ctl00$ctl00$elemRating$RatingControl$elemRating_RatingExtender_ClientState" id="p_lt_zoneContent_pageplaceholder_pageplaceholder_lt_News_NewsList_repItems_ctl00_ctl00_elemRating_RatingControl_elemRating_RatingExtender_ClientState" value="0"> 
```

注意`type="hidden"`属性。这会导致控件不呈现，我不确定在哪里解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:30:29.993

正如我的评论中提到的。实际上只是用于存储值。在此之下，它会呈现一些额外的内容，除非某些 CSS 类是从 CMSDesk.css 中继承的，否则这些内容不会显示。

您可以将必要的 CSS 类复制到您自己的 CSS 中，或者只在必要时导入 CMSDesk.css 文件以确保显示评级元素。

# c# - MVC 3 中的链接控制器行为

> ID：10586284
> 
> 赞同：0
> 
> 时间：2012-05-14T15:23:10.933
> 
> 标签：c#, asp.net-mvc-3

是否可以从控制器显示一个视图，然后取决于用户在 dropDownList 中选择的内容 - 在原始调用控制器中呈现另一个不同的视图？一种“菊花链”效果。

这背后的想法 - 是用户在视图中选择车辆类型 - （与 ID 号相关联），回到控制器中，取决于所选择的内容将根据他们选择的车辆类型立即呈现另一个视图显示 HTML，例如 HTML汽车或船或飞机等的页面...

如果这是可能的，有人可以指出我的代码示例吗？

下面是实际的数据库模型——但它是用于文档，而不是车辆！

![在此处输入图像描述](../Images/728d3623ba66441d7995de58a3e1bd32.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:42:16.900

检查您的操作方法的方法参数并返回基于此的不同视图。像这样的东西。

```
public ActionResult GetInfo(string id,string vehicleTypId)
{
  if(String.IsNullOrEmpty(vehicleTypeId))
  {
    var vehicle=GetVehicleType(vehicleTypId);
    return View("ShowSpecificVehicle",vehicle)    ;
  }

  var genericVehicle=GetVehicle(id);
  return View(genericVehicle);

} 
```

**编辑：**这么说，我认真地认为你应该将它们保留在 2 个单独的 Action 方法中。这使您的代码更干净且更具可读性。您可以将通用功能移动到一个函数中，并在需要的操作方法 id 中调用。所以我会这样做

假设您有第一页的 ViewModel（显示所有车辆类型）

```
public class VehicleTypesViewModel
{
  //other relevant properties
  public IEnumerable Types { set;get;}
  public int SelectedTypeId { set;get;}
} 
```

您对初始视图的 GET 请求将由此操作结果处理。它获取所有车辆类型并将其返回到 ViewModels 类型属性中的视图。

```
public ActionResult VehicleTypes()
{
  VehicleTypesViewModel objVM=new VehicleTypesViewModel();
  objVM.Types=dbContext.VehicleTypes.ToList();      
  return View(objVM);
} 
```

在您的名为 VehicleTypes.cshtml 的视图中，

```
@model VehicleTypesViewModel     
@using(Html.BeginForm())
{
  @Html.DropDownListFor(Model.SelectedTypeId,new SelectList(Model.Types,"Text",Value"),"Select")
<input type="submit" value="Go" />

} 
```

另一种处理表单发布的 Action 方法。您在此处具有选定的类型 ID，您可以在此处获取具体详细信息并返回不同的视图

```
[HttpPost]
public ActionResult VehicleTypes(VehicleTypesViewModel model)
{
  // you have the selected Id in model.SelectedTypeId property
  var specificVehicle=dbContext.Vehicles.Where(x=>x.TypeId=model.SelectedTypeId);
  return View("SpecificDetails",specificVehicle);

} 
```

或者，您可以使用 RedirecToAction 方法对特定车辆执行 Get 请求。我更喜欢这种方法，因为它坚持 PRG 模式。

```
[HttpPost]
public ActionResult VehicleTypes(VehicleTypesViewModel model)
{
  int typeId=model.SelectedTypeId;
  return RedirectToAction("GetVehicle",new {@id=typeId});
}
public ActionResult GetVehicle(int id)
{
  var specificVehicle=dbContext.Vehicles.Where(x=>x.TypeIdid);
  return View(specificVehicle);

} 
```

**使用 Javascript：**您也可以从您的 javascript 中调用新视图。没有 HTTPpost 到控制器。您应该为此在初始视图中添加一些 javascript

```
 @model VehicleTypesViewModel 
    //Include jQuery library reference here    
    @Html.DropDownListFor(Model.SelectedTypeId,new SelectList(Model.Types,"Text",Value"),"Select")
   <script type="text/javascript">
      $(function(){
        $("#SelectedTypeId").change(){
          window.location.href="@Url.Action("GetVehicle","Yourcontroller")"+"/"+$(this).attr("id");
        });
      });
   </script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:13:38.750

我认为为了获得更好的用户体验，创建一个，并通过 ajax 调用在同一页面`partial view`中加载该部分视图。`div`

```
public ActionResult GetVehicalInfo(string id, string vehicleType)
{
    var vehicle = GetVehicleType(id, vehicleTypId);
    return PartialView("vehicle);      
} 
```

# jsf-2 - 什么是从恢复视图到呈现响应的 JSF“无查询数据”短路示例

> ID：10586287
> 
> 赞同：1
> 
> 时间：2012-05-14T15:23:23.477
> 
> 标签：jsf-2

Core JavaServer Faces 第三版提到了 JSF 可以从恢复视图阶段直接进入呈现响应阶段的情况。什么是现实世界的例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:32:12.943

当没有回发请求的方式（即它是一个普通的 GET 请求）并且目标视图不包含任何视图参数（即视图中没有`<f:viewParam>`标签）时，就会发生这种情况。然后在应用请求值阶段（收集请求参数）、验证阶段（转换/验证它们）、更新模型值阶段（设置 bean 属性）和调用操作阶段（调用 bean 操作方法）根本没有什么需要处理的。然后 JSF 将绕过所有这些阶段。

现实世界的例子，嗯，只是一个没有视图参数的普通 GET 请求，比如当您通过链接或书签直接打开页面或在浏览器地址栏中输入其 URL 时，目标视图没有任何`<f:viewParam>`.

# bash - 检查 shell 脚本中命令的输出

> ID：10586290
> 
> 赞同：21
> 
> 时间：2012-05-14T15:23:33.177
> 
> 标签：bash, shell

我正在编写一个非常简单的 shell 脚本，它将查看所​​有失败测试的日志，并打印出当前目录中日志中所有文件的所有名称

```
 1  #! /bin/sh

 2  for file in *
 3  do
 4      echo "checking: $file"
 5      if [$(grep $file failed.txt -c) -ne 0]
 6      then
 7          echo "$file FAILED"
 8      fi
 9  done 
```

当我执行它时，我得到这个错误：

```
line 6: [0: command not found 
```

有谁知道为什么？

谢谢！！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-14T15:33:25.237

`[`实际上是 linux 中的命令（如 bash 或 cat 或 grep）。

`$(grep $file failed.txt -c)`是一个命令替换，在您的情况下评估为 0。因此，该行现在读取`[0 -ne 0]`，这被解释为运行一个`[0`使用 arguments调用的程序`-ne 0]`。

你应该写的是`[ $(grep $file failed.txt -c) -ne 0 ]`. Shell 脚本要求在左方括号和右方括号之间有空格。否则，您更改执行的命令（关闭`]`表示没有更多参数要读取。

所以现在命令评估为`[ 0 -ne 0 ]`. 您可以尝试在您的 shell 中执行此操作，看看会发生什么。如果表达式为真且为假`[`，则以 的值退出。您可以通过回显（要运行的最后一个命令的退出值）来查看退出值。`0``1``$?`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-14T15:37:38.767

您可以测试以下的返回码，而不是测试计数`grep`：

```
if grep -q $file failed.txt &>/dev/null 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T17:51:37.800

脚本可以

```
#!/bin/sh

for file in *; do
    echo "checking: $file"
    grep failed.txt $file && echo "$file FAILED"
done 
```

或者，作为用户 shell 命令历史记录中的单行：

`for file in *; do { echo "checking: $file" && grep failed.txt $file && echo "$file FAILED"; done`

在`man grep`

> EXIT STATUS
> 如果找到选定的行，则退出状态为 0，如果未找到，则退出状态为 1。如果发生错误，则退出状态为 2。（注意：POSIX 错误处理代码应检查“2”或更大。）

# android - 来自 lockCanvas 方法的游戏循环中的偶尔卡顿/滞后

> ID：10586294
> 
> 赞同：2
> 
> 时间：2012-05-14T15:23:48.233
> 
> 标签：android, android-canvas, game-loop, surfaceholder

我以给定的速度平滑滚动位图。我正在使用游戏循环来执行此操作。它滚动非常流畅，大约 60 fps，除了偶尔的口吃/跳跃。这些跳跃发生在任何地方，从每秒一次到每秒几次。通常它们在运行几秒钟后开始或变得更加频繁，但我不确定这是否是一个大线索。

跳跃的原因是偶尔运行循环的迭代会花费大约两倍的时间，因此位图会在一个地方停留一段时间，然后进一步跳跃以赶上并保持其恒定速度。我使用插值根据经过的时间计算每次更新时位图的新位置。当经过比平时更长的时间时，我尝试进行几次小型更新，而不是一次移动整个距离，但暂停的位图仍然非常明显。

我运行了 traceview，额外的时间花在了 lockCanvas 中。大多数情况下，此方法大约需要 10 毫秒，但在这些较长的情况下，大约需要 24 毫秒。当我追踪四秒钟时，这种情况发生了 7 次。

在下面的代码中，如果它运行得很快，我会让它睡一会儿，但这实际上并没有什么区别。如果我摆脱那部分代码，我的问题就没有解决。不需要恒定的帧速率，因为我只是根据经过的时间来计算位置。

```
@Override
    public void run() {

         long beginTime = 0;     // the time when the cycle begun
         long timeDiff;      // the time it took for the cycle to execute
         int sleepTime;      // ms to sleep (<0 if we're behind)
         sleepTime = 0;
        while (mRun) {
            Canvas c = null;

            try {
                beginTime = System.currentTimeMillis();

                c = mSurfaceHolder.lockCanvas(null);
                synchronized (mSurfaceHolder) {

                    if (mMode == STATE_RUNNING) {
                        updatePhysics();
                    }
                    doDraw(c);
                }

            } catch(Exception e){
                System.out.println(e.getStackTrace());
            }finally {

                if (c != null) {
                    mSurfaceHolder.unlockCanvasAndPost(c);
                }
            }
            timeDiff = System.currentTimeMillis() - beginTime;

            sleepTime = (int)(FRAME_PERIOD - timeDiff);

            if(sleepTime > 0){

                 try {
                    Thread.sleep(sleepTime);
                 } catch (InterruptedException e) {}
            }
        }
    } 
```

updatePhysics() 和 doDraw() 的代码做了一些数学运算，我试图让它尽可能高效。基本上他们只是根据时间和速度计算位图的新位置。我只有一个位图，并且不会每次都重新分配它或类似的东西。

另外，我很肯定我的surfaceHolder 已经准备好了，所以我从谷歌搜索中找到的常见答案不是重复调用未准备好的surfaceHolder 已被限制。

有什么想法可能导致这种情况吗？我的表面支架使用 PixelFormat.RGB_565 并且我的位图被编码为 Bitmap.Config.RGB_565 如果这有所不同。我最初是从我制作的相对布局中获得位图的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:24:30.583

一种可能的解释是您的代码生成了许多短期对象，并且垃圾收集器会定期启动以回收内存。

这些明显的停顿是 Java 早期版本中开发人员的祸根，直到分代垃圾收集几乎消除了这个问题。但是，据我所知，Android 的 Dalvik 虚拟机不采用分代垃圾回收，因此您应该谨慎创建立即丢弃的对象，尤其是在循环中。

分析内存分配将更清楚地说明这个问题。

如果这确实是问题所在，您可以尝试重用对象，或使用原语处理数据。

# java - 用于大规模顺序写入文件的 Java 库

> ID：10586298
> 
> 赞同：0
> 
> 时间：2012-05-14T15:24:18.267
> 
> 标签：java, database, performance, file-io

在我的应用程序中，我需要将大量数据写入数据库。为了加快速度，我正在考虑实时写入顺序二进制文件，然后将批量插入到数据库中。有不同的日志库可以配置为每 x 秒或 MB 创建一个新文件，但是它们在重负载下会显着降低系统速度，并且它们可以处理字符串消息。

是否有任何用于二进制文件的高性能库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:40:16.917

如果我是你，我会研究使用 JDBC 批量插入的可能性。相关方法是[`PreparedStatement.addBatch()`](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#addBatch%28%29)和[`Statement.executeBatch()`](http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#executeBatch%28%29)。

这是一个讨论它们的教程：http: [//viralpatel.net/blogs/2012/03/batch-insert-in-java-jdbc.html](http://viralpatel.net/blogs/2012/03/batch-insert-in-java-jdbc.html)

根据我的经验（使用 PostgreSQL），它们比单次插入要快得多。很可能它们的速度足以满足您的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-06T10:14:03.013

Kafka 旨在能够充当一个统一的平台来处理所有实时数据馈送。 [https://kafka.apache.org/08/design.html](https://kafka.apache.org/08/design.html)

# javascript - 为什么此 JavaScript 会导致页面在 Chrome 的选项卡中打开

> ID：10586300
> 
> 赞同：4
> 
> 时间：2012-05-14T15:24:23.650
> 
> 标签：javascript

为什么传递给 window.open('SomeWinName') 的这些参数会在选项卡中打开：

```
toolbar=1,
location=1,
directories=1,
addressbar=1,
scrollbars=1,
status=1,
menubar=1,
resizable=1,
outerWidth="+x+",
outerHeight="+ 
```

但如果我使用这些参数，窗口会在新窗口中打开：

```
resizable=1,
outerWidth="+x+",
outerHeight="+y 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:29:43.943

这与当您只使用 window.open("name") 时，它没有设置地址栏和菜单栏等的参数有关。*所以它会在没有*这些东西的情况下在新窗口中打开。它无法在新选项卡中执行此操作，因为显然它需要与当前窗口相同的 UI 设置。

基本上，谷歌的“期望”行为是在新标签中打开。但是，如果它没有足够的信息来做到这一点，它会做次佳的事情并打开一个新窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:32:16.140

指定`width`或`outerWidth`强制新窗口的大小不同于源窗口的大小。如果`width`是默认设置（与当前窗口相同），则浏览器将默认使用新选项卡（如果用户在首选项中检查了新选项卡而不是新窗口，我相信大多数现代浏览器默认都会这样做。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:42:25.590

在 w3c 规范中没有 outerWidth 和 outerHeight：[W3C Specs](http://www.w3schools.com/jsref/met_win_open.asp)

所以，这对我很有用：

```
var x = y = 10;
window.open ('Yeah', "toolbar=1,location=1,directories=1,addressbar=1,scrollbars=1,status=1,menubar=1,resizable=1,width="+x+",height="+y);
window.open ('Yeah2', "resizable=1,width="+x+",height="+y); 
```

它在两个不同的选项卡中打开两个新窗口。

# wordpress - 自定义菜单链接说明

> ID：10586304
> 
> 赞同：0
> 
> 时间：2012-05-14T15:24:33.087
> 
> 标签：wordpress, menu, hyperlink

我正在构建一个自定义 WordPress 主题，需要向我的自定义菜单链接添加描述。根据WordPress，有一种方法可以做到这一点：

“如果当前主题支持，描述将显示在菜单中。”

有谁知道如何支持这个？

提前致谢，

蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:35:15.770

Wordpress 在这方面的文档具有误导性。实际上，我花了相当长的时间来找出自己如何做到这一点。只要您的主题支持菜单（也就是说，您已经在 functions.php 或其他地方[注册了自定义菜单](http://codex.wordpress.org/Function_Reference/register_nav_menu)），您就可以默认添加链接描述和其他有用信息。

要查看这些选项，请转到外观-> 菜单并单击屏幕选项（在屏幕右上角）。您将能够在“显示高级菜单属性”下启用您喜欢的选项。

# c++ - 清除qt场景访问冲突

> ID：10586307
> 
> 赞同：0
> 
> 时间：2012-05-14T15:24:37.953
> 
> 标签：c++, qt, qgraphicsview

我有一个包含`QGraphicsScene`. 在某些功能中，我希望从所有项目中“清除”这个场景（然后用新项目填充它）。

我尝试了以下代码，但这给了我访问冲突：

```
NewScene->clear(); 
```

NewScene 定义如下：

```
private:
    std::unique_ptr<QGraphicsScene> NewScene; 
```

出了什么问题，我该如何清除这个场景？

# assembly - LLVM 是否支持 IEEE-694？

> ID：10586314
> 
> 赞同：0
> 
> 时间：2012-05-14T15:25:05.720
> 
> 标签：assembly, llvm

LLVM 会生成[IEEE-694](http://standards.ieee.org/findstds/standard/694-1985.html)汇编器字节码还是我必须修改它的源代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T20:10:29.443

如果您平台的 ISA 具有与上述标准兼容的汇编程序，则 LLVM 将生成此类兼容的输出。请注意，该标准已被撤回，很可能是因为它非常无用 - 它无法更改现有拱门/汇编器的种类繁多。

# visual-studio-2010 - 如何创建 SharePoint 2010 安装程序/MSI

> ID：10586321
> 
> 赞同：1
> 
> 时间：2012-05-14T15:25:28.673
> 
> 标签：visual-studio-2010, sharepoint-2010, installation, windows-installer

我已经使用 Visual Studio 2010 开发了一个带有多个可视化 Web 部件的 Sharepoint 2010 可视化 Web 部件应用程序。我能够使用下面给出的命令将其成功部署到生产服务器：

```
Add-SPSolution c:\sp\MySampleProject.wsp
Install-SPSolution -Identity MySampleProject.wsp -WebApplication https://MYURL -GACDeployment 
```

在我的可视化 webparts 中，我引用了一些共享点自定义列表并使用列表项执行添加/更新操作。现在，如果我使用上面的命令手动部署 webpart，我还需要在生产服务器上创建所有引用列表。为此，我只是将列表模板用于生产并将列表结构复制到生产中。

有什么办法，我可以创建一个自动安装程序（EXE SETUP 或 MSI），它应该能够创建所有列表以及将所有 webpart 部署到生产服务器。我知道这是可以做到的，因为每当我们从其他供应商处购买一些第三方 Web 部件时，它们都会为我们提供 MSI 或我们刚刚执行的其他可执行文件，它为我们做所有事情。但我不知道该怎么做。他们使用什么工具来开发这类安装程序。

任何帮助或建议？?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:54:48.207

CodePlex 可能有您需要的实用程序。据我所知，Microsoft 没有提供开箱即用的解决方案。从外观上看，这可能是大多数 3rd 方开发人员也使用的 [http://sharepointinstaller.codeplex.com/](http://sharepointinstaller.codeplex.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T03:48:19.590

您的功能应该是在激活时创建这些依赖列表/列表项，然后将 Web 部件添加到库中。这正是功能激活的目的！

实际上，我会将它们作为两个功能（都适用于网站集级别）。一个功能创建列表/列表项，第二个功能部署 Web 部件。第二个将取决于第一个。如果您愿意，第一个可能是“隐藏”功能。

是否在停用时删除这些列表取决于您。无论哪种方式都有很好的论据。

# c# - 为什么我得到“控件不支持透明背景颜色”？

> ID：10586322
> 
> 赞同：5
> 
> 时间：2012-05-14T15:25:32.943
> 
> 标签：c#, winforms

我正在开发一个 C# - Winforms 应用程序，并尝试像这样设置只读文本框的背景颜色......

```
txtMyBox.BackColor = Color.FromName ("Red"); 
```

这失败并显示错误消息...

```
System.ArgumentException was unhandled
Message=Control does not support transparent background colors.
Source=System.Windows.Forms 
```

首先要做的事；这是为只读文本框设置背景颜色的正确方法吗？我为普通的文本框做了很多，它似乎工作正常。

如果是的话，有人可以帮我弄清楚“透明背景颜色”是什么，为什么我应该想要一个？我不认为我这样做；我只是想让背景改变颜色。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-04-13T16:58:39.633

相当老的帖子但是......你以前试过这个吗？

```
public partial class MyForm : Form
{
    public MyForm()
    {
        this.SetStyle(ControlStyles.SupportsTransparentBackColor, true);

        InitializeComponent();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-11-22T22:27:21.680

有点晚了 - 但最终帮助这个人 - 像我一样 - 根据 OPs 问题找到了这个页面：

设置由 a 生成的 Winforms Splitter 背景颜色时出现此错误

```
Color.FromArgb(0xC9,0xD9,0xEB); 
```

解决方案是使用以下辅助方法生成颜色值：

```
ColorTranslator.FromHtml("#C9D9EB") 
```

这避免了生成透明度信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T15:37:12.017

更好的方法是：

```
txtMyBox.BackColor = Color.Red; 
```

你得到的错误是由于你的代码中的其他地方你试图将表单本身的背景颜色设置为透明并且不受支持，仔细检查你的代码，你会发现类似的东西：

```
BackColor = Color.Transparent; 
```

由于没有元素名称（即 myControl.BackColor = somthing）并且您的句子以 BackColor = somthing 开头 - 编译器认为您想要将 windows 窗体的背景颜色更改为透明，请检查您的表单编辑器 - 您可能会这样做从那里开始。

这是您的错误的重现：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        BackColor = Color.Transparent; //Control does not support transparent background colors.
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-06T07:38:45.337

```
ColorTextBox.BackColor = colorDialog1.Color;
textBox2.BackColor = System.Drawing.Color.FromArgb(
                     ColorTextBox.BackColor.ToArgb()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T15:30:57.183

试试这个而不是`FromName`

```
 txtMyBox.BackColor = Color.Red; 
```

# c++ - 这个网络库可以在 iOS 上运行吗？

> ID：10586324
> 
> 赞同：1
> 
> 时间：2012-05-14T15:25:34.377
> 
> 标签：c++, ios, c, networking, liblacewing

我想将此库用于跨平台网络。

[http://lacewing-project.org/](http://lacewing-project.org/)

它适用于 OSX、Linux、Windows 并具有适用于 Android 的特定代码。我不知道它是否可以在 iOS 上运行（作为客户端）。（意味着我不会在 iOS 上托管服务器）

由于它在内部使用 POSIX 套接字，这是否使它与 iOS 兼容？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:01:40.433

如果不尝试，我的猜测是它会起作用。你需要用 Objective-C 编写你的 UI，但你应该能够使用 Objective-C++ 将你的库绑定到 UI。在开始使用 Objective-C++ 路径之前，请注意这些限制（请参阅：[Objective-C++ 的支持情况如何？](https://stackoverflow.com/questions/406753/how-well-is-objective-c-supported)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:04:32.770

我会`AFNetworking`先尝试使用 gowalla 的创建者提供的 Objective-c 库。

你可以在这里得到它： [https ://github.com/AFNetworking/AFNetworking](https://github.com/AFNetworking/AFNetworking)

关于 的主题`lacewing`，它应该可以正常工作，只要它依赖于 BSD 套接字 API，因为我可以确认它存在于 iOS 上。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-14T15:36:22.357

如果它只用 C/C++ 编写，那么没有，除非你有适用于 iOS 的 C/C++ SDK（AFAIK 不公开存在）。iOS SDK 适用于 Objective-C。

# xcode - 我可以在 OS X 上使用 OpenFrameworks 而不必使用 XCode 吗？

> ID：10586332
> 
> 赞同：12
> 
> 时间：2012-05-14T15:25:56.643
> 
> 标签：xcode, macos, openframeworks

我无法忍受 XCode，但我真的很喜欢 OpenFrameworks，而且我知道它可以在 Linux+Win32 上运行，所以我不明白为什么它*应该*依赖于 XCode。如果我需要安装 XCode，那很好，我根本不想使用它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-16T11:49:50.683

Xcode 内部使用 gcc/llvm。实际上，您可以从命令行 cd 进入包含 openFrameworks 项目的目录，然后键入`xcodebuild`. 但这不允许您编辑项目文件并添加新的源代码等。

Linux makefile 也可以适用于 OSX。它们已经包含许多有关查找正确源文件、库路径等所需的信息。但是 Linux 允许我们将更多组件安装为共享系统库，而在 OSX 上，我们静态链接大多数库，因此还有一些额外的需要添加库路径。可能最大的问题是所有东西都必须编译为 32 位，这意味着`-arch i386`到处传递，所以你不能只使用 Homebrew 或 MacPorts 安装依赖库。我们正在过渡到 64 位，但仍有一些 QuickTime 调用需要我们坚持使用 32 位，主要是为了访问我们很多人仍然用于计算机视觉的遗留视频捕获设备。

就像@cdelacroix 指出的那样，我们只在 OSX 上维护 Xcode 项目文件。这主要是由于缺乏像样的替代品。有一个适用于 OSX 的 Code::Blocks 版本，但它的支持不是很好，在原生 gui 渲染方面存在一些问题，并且往往落后于其他平台。Xcode 也是在 OSX 上安装工具链的最简单方法，因此对于大多数用户来说安装 Xcode 是必要的。

如果您确实获得了基于 makefile 的构建系统，并且有兴趣从中长期维护它，请考虑将其贡献给 GitHub 存储库，我们很乐意接受。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-24T17:01:02.480

[截至 2013 年 3 月](https://github.com/openframeworks/openFrameworks/pull/1887)，openFrameworks 对编译库本身提供了官方 makefile 支持。但是，在撰写本文时，这些更改尚未合并到稳定版本中。您需要克隆[Git 存储库](https://github.com/openframeworks/openFrameworks)并切换到开发分支。

```
git clone https://github.com/openframeworks/openFrameworks
cd openFrameworks && git checkout develop
cd libs/openFrameworksCompiled/project
make 
```

据我所知，我们仍然需要使用非官方的解决方案来针对库编译应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T16:21:53.733

您需要 Xcode，或者至少需要一组编译器（更多信息可[在此处](http://kennethreitz.com/xcode-gcc-and-homebrew.html)获得），但否则，您可以在任何您想要的编辑器或环境中编辑/使用代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-27T09:04:49.493

这是一个生成文件的链接，它将在 OsX 上编译 OpenFrameworks 应用程序：

[https://gist.github.com/labe-me/1190981](https://gist.github.com/labe-me/1190981)

将 makefile 放在应用程序的目录中并运行 make。在 OsX 10.6 上测试，但尚未尝试使用插件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-15T23:06:35.977

正如@mipadi 所说，不需要实际使用 Xcode，您可以使用 make 或 cake 或您选择的任何构建系统来完成您在 Xcode 中所做的几乎所有事情。您所要做的就是找到正确的命令行选项集以传递给常用工具（编译器、链接器、条带等），有时更简单的方法是……在 Xcode 构建窗口中查看它是怎样的做事（用每行右侧的小按钮展开行）。

例如，您可以使用 ld -framework Framework -FPathToFramework foo.o 链接您选择的框架，或者使用 ld -lLib -LPathToDylib foo.o 链接您的动态库。您可能需要了解 @rpath、@loader_path 和 install_name_tool 才能发布自包含的打包应用程序。

对于 OpenFrameworks，Xcode 的“要求”是作者决定只维护 Xcode 项目文件。我只是看看他们是如何做到的，他们发布了构建静态库的源代码和 Xcode 项目文件，因此对您来说会更加简单（尽管您需要手动链接库依赖项）。您必须选择在构建系统中从源代码编译所有内容（如果您想要在不接触 Xcode 的情况下获得更多自定义功能），或者只使用 Xcode 生成 2 个静态库（openFrameworks.a 和 openFrameworksDebug.a），然后在你的构建系统（推荐直到你真的需要持续定制）。

# objective-c - 重用变量名作为循环索引不会产生我期望的错误

> ID：10586335
> 
> 赞同：1
> 
> 时间：2012-05-14T15:26:06.863
> 
> 标签：objective-c, for-loop, scope

我可以`for`在 Objective-C 的不同循环中重复使用相同的变量名吗？例如：

```
// This doesn't give me an error but I feel like it should:

for(int i = 0; i < 10; i++){
    //do something
}

for (int i = 0; i < 5; i++){    // I'm using "i" again.  Is this allowed?
    //do something else
} 
```

这可以编译并且似乎运行良好，但我只是想确保这是合法的并且是允许的，而不会在我的程序中造成某种复杂性。我对 ObjC 很陌生，但在 Java 中，我通常会从中得到错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:29:37.577

那应该没问题。您显示的代码段中的范围`i`仅限于每个`for`循环，因此没有冲突。如果你改为这样做：

```
int i;
for (i = 0; i < 2; i++) {
    //...
}

int i;
for (i = 5; i < 10; i++) {
    //...
} 
```

那么您将遇到问题，因为您`i`在同一范围内声明了两次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:29:13.140

这很好。因为您没有在 for 循环之外初始化整数。如果你有两次这样的：

```
int i;
for (i = 0; ...) 
```

那么你当然会得到一个编译错误，因为你不能在同一个块中定义两个同名的变量。

# jquery - jQuery TableSorter 困难排序不起作用

> ID：10586336
> 
> 赞同：1
> 
> 时间：2012-05-14T15:26:10.747
> 
> 标签：jquery, tablesorter

该表有几列，包括包含自定义日期格式（dd-mm-yyyy HH:MM:SS）的第一列，例如

```
 <tr>
        <td>14-05-2012 13:57:04</td>
        <td>MTUPTTC01V4.3_E2E-LoadBalancer-1336992891.jtl</td>
        <td>14-05-2012 13:10:03</td>
        <td>14-05-2012 13:56:38</td>
        <td>00:46:35</td>
        <td>400</td>
        <td>152328</td>
        <td>2494</td>
        <td>1.64%</td>
        <td><a href="2012-05-14_13_56_52">Results</a></td>
    </tr> 
```

我正在使用以下自定义解析器，但它似乎不起作用。

```
 $.tablesorter.addParser({
                id: 'jmeterDate',
                is: function(s) {
                        return false;
                },
                format: function(s) {
                        var date = s.match(/^(\d{2})-(\d{2})-(\d{4})[ ](\d{2}):(\d{2}):(\d{2})$/);
                        var d = date[1];
                        var m = date[2];
                        var y = date[3];
                        var H = date[4];
                        var M = date[5];
                        var S = date[6];
                        var MS = 0;
                        //return '' + y + m + d;
                        return new Date(y, m, d, H, M, S, MS).getTime();
                },
                type: 'Numeric'
        });
        $("#tablesorter-table").tablesorter({
                headers: {
                        0: {
                                sorter: 'jmeterDate'
                        }
                }
        }); 
```

有关完整示例，请参见以下链接

[http://jsfiddle.net/Ese5A/1/](http://jsfiddle.net/Ese5A/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T11:25:45.570

我已经解决了这个问题，它不是 jQuery 或自定义表格排序器，它实际上是表格内容本身。某些日期的长度不是正则表达式所期望的，例如

04-05-2012 13:7:1

注意 7 和 1，下面的正则表达式需要至少 2 位数字。

s.match(/^(\d{2})-(\d{2})-(\d{4}) :(\d{2}):(\d{2})$/)

使固定：

s.match(/^(\d{1,2})-(\d{1,2})-(\d{4}) :(\d{1,2}):(\d{1, 2})$/)

它现在接受长度为 1 或 2 的数字

# java - Base 64 对包含电子邮件地址的用户名进行编码——java

> ID：10586339
> 
> 赞同：1
> 
> 时间：2012-05-14T15:26:25.483
> 
> 标签：java, http, encoding, base64

我一直在使用 httpClient 尝试将连接字符串写入 https-base API，并且用户名/密码验证有点棘手。

使用 Appache commons base64 编码器我被迫将一个字节数组传递给构造函数，我的身份验证应该是 email@companyName:password 但是 base 64 转换器不支持 @ 符号（因为它不是 0-9 az 或 az或 /+)，但是这显然需要在我可以进行身份​​验证之前解决......帮助？

代码（在请求之前）：

```
import org.apache.commons.codec.binary.Base64;
....
        String encoding = Base64.encodeBase64String("username@company.com:password");
        HttpPost httppost = new HttpPost("https://webapi.com/api/protectedarea");
        httppost.setHeader("Authorization", "Basic " + encoding); 
```

完整的错误代码：

```
javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated
at sun.security.ssl.SSLSessionImpl.getPeerCertificates(SSLSessionImpl.java:397)
at org.apache.http.conn.ssl.AbstractVerifier.verify(AbstractVerifier.java:128)
at org.apache.http.conn.ssl.SSLSocketFactory.connectSocket(SSLSocketFactory.java:397)
at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:148)
at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:150)
at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:121)
at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(DefaultRequestDirector.java:575)
at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:425)
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:754)
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:732) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:30:47.277

问题是您对字符串进行了双重编码。首先在第一行，然后在第三行。

除非您在另一端进行双重解码，否则您会遇到问题（您为什么要这样做？）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:49:38.697

您的服务器似乎没有有效的 SSL 证书。

我过去为开发环境所做的是实现一个新的 X509TrustManager - 这基本上是检查证书凭据是否有效。

# excel - 使用 Excel VBA 删除超链接时如何保留单元格格式？

> ID：10586341
> 
> 赞同：6
> 
> 时间：2012-05-14T15:26:33.160
> 
> 标签：excel, vba

从单元格中删除超链接也会删除格式。

```
Selection.Hyperlinks.Delete 
```

有没有办法保留格式，或者我需要在删除超链接后重新应用它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-01-27T12:04:18.633

我发现解决方案是打电话

```
Range.ClearHyperlinks 
```

代替

```
Range.Hyperlinks.Delete 
```

前者清除超链接并保持格式不变。参考这里：[https ://msdn.microsoft.com/en-us/library/office/ff194741.aspx](https://msdn.microsoft.com/en-us/library/office/ff194741.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T17:56:29.503

我知道这也有点奇怪......不确定这是否会被你接受。尝试这个：

```
Selection.Hyperlinks(1).Address = "" 
```

这几乎就像没有超链接一样。唯一的区别是您的光标变为手形而不是默认的加号，但您仍然可以像任何其他单元格一样单击它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-05T14:35:00.367

如果您使用合并的单元格，上述解决方案会出现问题。这可以解决这个问题

```
data = Selection.value
Selection.Value = ""                            'this removes the hyperlink
Selection.Font.Underline = xlUnderlineStyleNone 'remove the hyperlink underlining
With ActiveCell.Font                            'replace hyperlink blue with black
   .ThemeColor = xlThemeColorLight1
   .TintAndShade = 0
End With
Selection.Value = data 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-23T11:44:17.097

```
For Each cll In Selection
    cll_val = cll.Value
    cll.ClearContents
    cll.Value = cll_val
    With cll.Font
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .Underline = xlUnderlineStyleNone
    End With
Next 
```

This also helps when you don't want to copy paste information to/from another location. Have't tried this on merged cells, but I guess this should work.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-14T17:48:27.070

我不知道如何防止格式被破坏。我想出的解决方法是在删除超链接之前复制单元格，然后在删除超链接后将格式粘贴回单元格：

```
' copy cell to remote location to "remember" formatting
ActiveCell.Copy Sheets("Templates").Range("a1")

' remove hyperlink
ActiveCell.Hyperlinks.Delete

' reapply formatting
Sheets("Templates").Range("A1").Copy
ActiveCell.PasteSpecial Paste:=xlPasteFormats 
```

告诉我一个更好的方法，我会接受你的回答作为答案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-12T00:34:51.437

```
ActiveCell.Style = "Normal" 
```

换句话说：您重新应用应该存在的样式。而“正常”可以更改为 Excell 中存在的任一单元格样式的名称。如果您希望以这种方式应用您自己的样式，请将其添加到 cellstyles 列表中。

如果你想更进一步。您可以使用已经存在的单元格样式，将其捕获在字符串中并重新应用。

```
Dim sStyleName as String
sStyleName = ActiveCell.Style 'Capture the current cellstyle
ActiveCell.Hyperlinks.Delete  'Remove the hyperlink
ActiveCell.Style = sStylename 'Reapply the cellstyle used before 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-06T19:57:22.417

```
Dim temp As Variant
temp = (RangeObject).Interior.Color
(RangeObject).Hyperlinks.Delete
(RangeObject).Interior.Color = temp 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-14T21:41:28.673

您还可以将超链接应用到透明的形状并覆盖您想要超链接的单元格。

这里的缺点是光标在未链接时会随着鼠标悬停而变化。形状可以由最终用户移动和删除。

# binding - 如何从 .framework 创建 MonoTouch 绑定

> ID：10586342
> 
> 赞同：17
> 
> 时间：2012-05-14T15:26:37.037
> 
> 标签：binding, xamarin.ios, couchdb, couchcocoa

我下载了[TouchDB](https://github.com/couchbaselabs/TouchDB-iOS)，这是一个“适合嵌入移动或桌面应用程序的轻量级 Apache CouchDB 兼容数据库引擎”，它为我提供了一堆`.framework`文件夹（CouchCocoa.framework、TouchDB.framework 和 TouchDBListener.framework）。

我一直在阅读[关于将 Obj-C 库绑定到 MonoTouch 的文章](http://docs.xamarin.com/ios/advanced_topics/binding_objective-c_types)，它展示[了如何绑定 a`.a`](http://docs.xamarin.com/ios/advanced_topics/binding_objective-c_types#Binding_an_API)，但没有展示如何绑定 a `.framework`。

我如何为这些绑定`.framework`？`.a`或者我应该在使用它们之前以某种方式制作`.framework`它们（如果可能的话）？

- 编辑 -

相关：[https ://bitbucket.org/LouisBoux/touchdb-monotouchbinding](https://bitbucket.org/LouisBoux/touchdb-monotouchbinding)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-25T13:48:10.687

在 MonoTouch 中绑定 .framework 需要几个步骤，.framework 是一个目录，通常包含库包的所有部分（例如，头文件、资源和库文件）。以下是绑定 .framework 所需的一般步骤。

*   像创建普通库文件 (libXXX.a) 一样创建绑定项目

*   .framework 中的等效库是 .framework 目录根目录下没有扩展名的文件，例如我最近为 RDPDFKit.framework 编写了绑定，顶层文件是一个名为 RDPDFKit（无扩展名）的文件，重命名将此复制到“libRDPDFKit.a”并复制到您的绑定项目并将其添加到项目中。它将使用支持的平台（例如，x86、arm6 等）创建一个代码隐藏文件。这方面的所有文档都在 Xamarin 的网站上。

*   像定义普通库一样定义绑定。

*   如果框架有 .bundle，请将其复制到您的 Program 项目（不是绑定项目），它需要作为程序的资源添加。将此目录添加到项目及其下面的所有项目中，这是因为 DLL 不支持 monotouch 中的资源。

*   生成的 monotouch 绑定 DLL 将包含整个 .a 文件以供以后链接，因此在构建 .dll 后您将不需要 .a 文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T15:55:08.950

You can use the `.framework` files just like the `.a` files. E.g. all the bindings MonoTouch provides (in monotouch.dll) are made from `.framework` files.

# joomla - 是否可以获取 Virtuemart 订单中每个项目的税值？

> ID：10586343
> 
> 赞同：0
> 
> 时间：2012-05-14T15:26:36.917
> 
> 标签：joomla, joomla-extensions, virtuemart

Virtuemart 根据购物者地址计算税款，并将此值添加到 jos_vm_orders 表中。但我需要一个“详细”版本的税收。我需要知道订单每一行 (jos_vm_order_item) 的税金。有什么建议么？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:30:10.120

我希望是这样......税收是在订单级别计算和存储的，而不是行项目详细信息。我在过去“逆向工程”中获得了一些运气，该项目的税收是多少，但这高度依赖于所涉及的业务规则，而且通常不可靠。

# ruby - Rubywarrior Level 4（清理我的代码帮助）

> ID：10586351
> 
> 赞同：3
> 
> 时间：2012-05-14T15:27:03.690
> 
> 标签：ruby, code-cleanup

我正在通过 Ruby 学习编程，并且我发现了 Railscasts 的 Ryan Bates 写的很棒的 Rubywarrior。不幸的是，我被困在我的代码抛出语法错误消息（意外的 $end）。

我不是在要求答案，我想自己解决这个问题，但如果有人能指出我的代码从哪里得到错误，那就太好了。谢谢！

```
class Player

  def initialize
    @maxhealth = 20
    @dying = 7
    @previoushealth = @maxhealth
    @health = warrior.health
    @warrior = warrior
  end

  def play_turn(warrior)
  # If there are no enemies, rest until health is 100%
    turn_start_check(warrior)
    actions(warrior)
    turn_end_check(warrior)
  end

  def actions(warrior)
    if @damaged_since_last_turn
      warrior.shoot!
    elsif
      @health < @maxhealth
        warrior.rest!
    else
      warrior.walk!
    end
  end

  def hurt?(warrior)
    warrior.health < 20
  end

  def healthy?(warrior)
    warrior.health = 20
  end

  def alone?(warrior)
    warrior.feel.empty?
  end

  def should_i_move?(warrior)
    if healthy? and alone?
      warrior.rest!
    else
      warrior.walk!
  end

  # Put code here for if health from previous turn is less than last term
  # If true don't rest and keep moving forward
  def turn_start_check(warrior)
    @damaged_since_last_turn = @previoushealth > warrior.health
  end

  def turn_end_check(warrior)
    @previoushealth = warrior.health
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:30:46.090

我猜：

```
def should_i_move?(warrior)
  if healthy? and alone?
    warrior.rest!
  else
    warrior.walk!
  end  # <<MISSING THIS ONE
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T15:31:16.230

该错误消息意味着您在`end`某处缺少关键字。检查您的代码以查看您的所有语句是否正确编写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T22:49:00.970

在 Ruby 1.9.3 中，如果您打开警告，您会收到以下警告：

```
-:46: warning: mismatched indentations at 'end' with 'if' at 42
-:57: warning: mismatched indentations at 'end' with 'def' at 41 
```

然后是错误

```
-:57: syntax error, unexpected $end, expecting keyword_end 
```

第 46 行对应于第一个`end`之后`def should_i_move?(warrior)`

这也适用于早期版本的 Ruby 1.9。

# c# - 多态性与职责分工：如何避免“切换类型”

> ID：10586357
> 
> 赞同：2
> 
> 时间：2012-05-14T15:27:26.497
> 
> 标签：c#, .net, polymorphism, single-responsibility-principle

在设计具有层次关系的系统时，我经常遇到一个需要多态行为的问题，但不止一种类型的工作可以从这种多态实现中受益。

例如，考虑一个编译器，它使用抽象语法树来组织已解析的源代码以进行编译。以多态方式组织逻辑很方便，因为您可能有不止一种类型的 ValueProvider，每种类型负责发射不同的代码以将值加载到操作堆栈上。问题是您可能还想对 AST 执行静态分析，在这种情况下，您想对树进行完全不同的工作，但可能具有取决于所分析节点类型的行为。换句话说，您需要多态行为，但不想将分析代码与编译代码混合在一起。

我目前处理这个的方法是用一个对象模型来存储数据，它的职责只是提供树。树的每个使用者（例如编译器或静态分析器）然后使用运行时类型信息来执行其逻辑的条件分支。根据节点的类型，这不可避免地会导致大量的“if/else if”或“switch”编码。多态性旨在解决的正是这种丑陋的分支，但并行的、不相交的职责似乎需要它。

有没有更好的方法来构建它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:43:36.400

您似乎正在寻找[访客模式](http://en.wikipedia.org/wiki/Visitor_pattern)：

> 访问者设计模式是一种将算法与其操作**的对象结构分离的方法。**这种分离的实际结果是**能够在不修改现有对象结构的情况下向现有对象结构添加新操作**。

（强调我的）

# python - 如何从 pyodbc 连接到 Oracle 10？

> ID：10586361
> 
> 赞同：2
> 
> 时间：2012-05-14T15:27:43.343
> 
> 标签：python, oracle, odbc, pyodbc

我有“Oracle in OraClient10g”和“Microsoft ODBC for oracle”驱动程序（使用 ODBCAD32.EXE 检查）。

有没有办法用pyodbc连接到oracle数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T08:03:26.497

我使用带有 DSN 的 Oracle 驱动程序，对我来说它连接：

```
db = pyodbc.connect('DSN=my_test_db;PWD=tiger')

print('-' * 20)
try:
    c = db.cursor()
    rs = c.execute("select * from v$version where banner like 'Oracle%'")
    for txt in c.fetchall():
        print('%s' % (txt[0]))
finally:
    db.close() 
```

# string - Opa：如何操作字符串映射（和其他映射）

> ID：10586367
> 
> 赞同：2
> 
> 时间：2012-05-14T15:28:12.370
> 
> 标签：string, map, opa

我想创建一个 Stringmap，在里面添加一些值，然后传递一些函数。我试过这个：

```
import stdlib.core.map

mymap = StringMap_empty

mymap["rabbit"] = 12

function addmap(map)
{
        map["rabbit"] = 24
} 
```

但没有任何编译。我只能使用stringmap througt 数据库！(-> 数据库字符串映射 (int) /myMap )

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:54:36.410

Opa is a functional programming language. You should read this thread for more information: [Opa: Iterating through stringmap and forming a new string based on it](https://stackoverflow.com/questions/10511445/opa-iterating-through-stringmap-and-forming-a-new-string-based-on-it)

```
mymap = StringMap.empty

mymap = StringMap.add("rabbit", 12, mymap)
// you can't just write StringMap.add("rabbit", 12, mymap)
// because values are by default not mutable
// the function returns the map with the new element added

function addmap(map)
{
        StringMap.add("rabbit", 24, map)
}

mymap = addmap(mymap) 
```

# hbase - Hbase shell：值被切割

> ID：10586368
> 
> 赞同：1
> 
> 时间：2012-05-14T15:28:16.800
> 
> 标签：hbase

我有一个名为“mytable”的 hbase 表，只有一个列族“默认”和一个限定符“详细信息”。

现在我做这个查询：

```
get 'mytable', 'test' 
```

结果的价值被削减了。它应该是一个数字（长）：

```
COLUMN                      CELL                                                                           
default:details            timestamp=1337007859494, value=\x00\x00\x00\x00\x00\x00\xDFH                   
1 row(s) in 0.0360 seconds 
```

为什么我只看到前七个字节？我怎样才能看到完整的价值？

如果我要求价值很小的东西，它会起作用。但是大值是不完整的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T06:57:50.100

您 long 的所有 8 个字节都在该字符串中：

```
\x00\x00\x00\x00\x00\x00\xDFH 
```

这样更容易看到：

```
\x00 \x00 \x00 \x00 \x00 \x00 \xDF H 
```

前 6 个字节是 0（十六进制 \x00），下一个是 223（十六进制 \xDF），最后一个是 ASCII H（\x48），这使得十进制的 long 为 57,160。HBase 的值只是字符数组，不识别类型，因此 shell 将所有不可打印的 ASCII 字节作为十六进制转义，只留下那些并不总是最清晰的字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T13:15:26.623

好的，我写了一个小 Java 来告诉我价值。这行得通。愚蠢的 hbase shell。

```
import java.io.IOException;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.hbase.client.Get;
import org.apache.hadoop.hbase.client.HTable;
import org.apache.hadoop.hbase.client.Result;
import org.apache.hadoop.hbase.util.Bytes;

public class HBaseGet {

public static void main(String[] args) throws IOException {

    if(args.length < 4) {
        throw new IOException("Parameters: table rowid columnFamily qualifier");
    }

    assert args.length >= 4;

    String tablename = args[0];
    byte[] rowid = Bytes.toBytes(args[1]);
    byte[] family = Bytes.toBytes(args[2]);
    byte[] qualifier = Bytes.toBytes(args[3]);

    Configuration config = HBaseConfiguration.create();
    HTable table = new HTable(config, tablename);

    Get get = new Get(rowid);
    Result result = table.get(get);

    if (result != null) {
        byte[] value = result.getValue(family, qualifier);
        String valueStr = Bytes.toString(value);

        // convert bytes to long
        long valueLong = 0L;
        for (int i = 0; i < value.length; i++)
        {
            valueLong = (valueLong << 8) + (value[i] & 0xff);
        }

        System.out.println("================");
        System.out.println("String: "+valueStr);
        System.out.println("Long: "+valueLong);
        System.out.println("================");
    }

}

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T05:27:46.370

尝试让 MR 作业在插入之前打印值，以确保不会插入错误的值。

还可以尝试使用 java 文件读取值，以确保这不是 jruby shell 的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-06T16:39:26.763

您的问题的简短回答是：

```
get 'mytable', 'test', {COLUMN => 'default:details:toLong'} 
```

`Long`:) 版本：

如果你输入`help 'get'`HBase 的 shell，你会发现：

```
Besides the default 'toStringBinary' format, 'get' also supports custom formatting by
column.  A user can define a FORMATTER by adding it to the column name in the get
specification.  The FORMATTER can be stipulated: 

 1\. either as a org.apache.hadoop.hbase.util.Bytes method name (e.g, toInt, toString)
 2\. or as a custom class followed by method name: e.g. 'c(MyFormatterClass).format'.

Example formatting cf:qualifier1 and cf:qualifier2 both as Integers: 
  hbase> get 't1', 'r1' {COLUMN => ['cf:qualifier1:toInt',
    'cf:qualifier2:c(org.apache.hadoop.hbase.util.Bytes).toInt'] } 
```

# php - 按下链接以显示 javascript 警报框

> ID：10586370
> 
> 赞同：2
> 
> 时间：2012-05-14T15:28:30.623
> 
> 标签：php, javascript, jquery, mysql, ajax

[在继续之前显示一条javascript消息](https://stackoverflow.com/questions/10585840/display-a-javascript-message-before-proceeding) 从该线程继续，我想知道一旦ajax get函数获取'1'的数据，我是否可以执行php源代码以显示数据库中的一些相关数据

那是

```
$.get("display.php",function(data)
    {
        if(data!='1')
        {
            if(confirm("Display this item"))
            {
                // use this place to execute a php file. But how ?
            }
        }
    }
    ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:30:15.097

您不能在 JavaScript 中执行 PHP 文件。此时，您将需要使用 ajax 来获取您要执行的 PHP 脚本生成的任何内容，然后使用 JavaScript 将其放置在页面上（或执行它说的任何其他操作）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T15:30:56.747

您可以执行另一个 ajax 请求（`$.get`在您的情况下再次使用）

```
if(confirm("Display this item")) {
    $.get("file.php", function(data) {
        // Handle data
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:31:13.083

再次调用 ajax 函数从 php 文件中获取数据。

# java - 仅验证少数元素的单元测试

> ID：10586374
> 
> 赞同：1
> 
> 时间：2012-05-14T15:28:41.520
> 
> 标签：java, unit-testing, junit, mockito

有一个界面：

```
interface IEventListener
{
  void onEvent(List <IEvent> events);
} 
```

有一个事件类：

```
class EventB
{
  private final int id;
  private final A a;
  private final String somethingElse;
...
// constructors, getters
...
} 
```

还有一个类要测试：

```
class Doer
{
 IEventListener eventListener;
 void doSomething(Aaa a)
 {
   eventListener.onEvent(Arrays.asList(new EventA(1), new EventC(2)));
...
   eventListener.onEvent(Arrays.asList(new EventB(42, a.getA(), "foo"), new EventA(3), new EventB(0, a.getA(), "bar")));
...
   eventListener.onEvent(Arrays.asList(new EventC(4)));
 }
} 
```

这`Doer`是我需要测试的代码，该方法`doSomething`产生事件包，我需要测试它是否在某些特定条件下产生特定事件。

更准确地说，我希望有一个单元测试，它调用该方法`doSomething`并检查 EventB 是否以“42”和`A`来自方法参数的方式发送`a`。所有其他事件都应该被忽略。

为了进行这样的测试，我只提出了涉及带有 ArgumentCaptor、for 块和魔术布尔标志的非常冗长代码的解决方案......

对其进行单元测试的最佳方法是什么？也许代码设计不好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:15:51.547

设计是正确的，这就是您使用 Mockito 测试它的方式：

```
import org.hamcrest.Matchers;
import org.mockito.Mockito;
public void firesEventsOnDoSomething() {
  Listener listener = Mockito.mock(Listener.class);
  Doer doer = new Doer(listener);
  doer.doSomething(aaa);
  Mockito.verify(listener).onEvent(
    Mockito.argThat(
      Matchers.hasItem(
        Matchers.allOf(
          Matchers.instanceOf(EventB.class),
          Matchers.hasProperty("a", Matchers.equalTo(aaa.getA())),
          // whatever you want
        )
      )
    )
  );
} 
```

它是 Mockito 1.9.0 和 Hamcrest-library 1.2.1。

要将 JUnit 4.10 与 Hamcrest-library 1.2.1 一起使用，您应该使用`junit:junit-dep:4.10`工件，并从中排除`org.hamcrest:hamcrest-core`：

```
<dependency>
  <groupId>junit</groupId>
  <artifactId>junit-dep</artifactId>
  <version>4.10</version>
  <scope>test</scope>
  <exclusions>
    <exclusion>
      <groupId>org.hamcrest</groupId>
      <artifactId>hamcrest-core</artifactId>
    </exclusion>
  </exclusions>
</dependency>
<dependency>
  <groupId>org.hamcrest</groupId>
  <artifactId>hamcrest-core</artifactId>
  <version>1.2.1</version>
  <scope>test</scope>
</dependency>
<dependency>
  <groupId>org.hamcrest</groupId>
  <artifactId>hamcrest-library</artifactId>
  <version>1.2.1</version>
  <scope>test</scope>
</dependency>
<dependency>
  <groupId>org.mockito</groupId>
  <artifactId>mockito-core</artifactId>
  <version>1.9.0</version>
  <scope>test</scope>
  <exclusions>
    <exclusion>
      <groupId>org.hamcrest</groupId>
      <artifactId>hamcrest-core</artifactId>
    </exclusion>
  </exclusions>
</dependency> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:39:45.030

如果您使用的是 JUnit4，您可以尝试参数化测试。这里有一个例子[http://www.mkyong.com/unittest/junit-4-tutorial-6-parameterized-test/](http://www.mkyong.com/unittest/junit-4-tutorial-6-parameterized-test/)。

如果每个参数都必须与不同的结果进行比较，则最好将它们视为不同的测试用例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:45:20.330

创建虚拟实现`EventListener`：

```
class DummyEventListener implements EventListener {
    private int expectedId;
    DummyEventListener(int expectedId) {
       this.expectedId = expectedId;
    }
    void onEvent(List <IEvent> events) {
        for (IEvent event : events) {
            if (!(event instanceof EventB)) {
                continue;
            }
            EventB eb = (EventB)event;
            assertEquals(expectedId, eb.getId());
            // add more asserts here
        }
    }
} 
```

或者，您可以使用可用的 java 模型框架之一：EasyMock、JMock、Mockito、JMockit 等。

# jqgrid - jqGrid 高级过滤器 - 执行自定义过滤器

> ID：10586375
> 
> 赞同：0
> 
> 时间：2012-05-14T15:28:42.690
> 
> 标签：jqgrid

```
 var cFilter = {
                "groupOp": "AND",
                "rules":
                    [
                        { "field": "accountname", "op": "eq", "data": "06"} 
                    ]
             };    

$('#jqGrid').setGridParam({
        postData: {
          filters: cFilter 
        }
      }); 
```

这是否会在 jqGrid 中获取过滤后的数据，因为我似乎无法使其正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:27:57.823

我认为你应该做以下事情：

```
var cFilter = {
        groupOp: "AND",
        rules: [
            { field: "accountname", op: "eq", data: "06"} 
        ]
    };    

$('#jqGrid').setGridParam({
    search: true, // to force searching 
    postData: {
        filters: JSON.stringify(cFilter); 
    }
}); 
```

例如，查看[答案](https://stackoverflow.com/a/5273385)以获取更多详细信息。

# javascript - mootools、addthis 和 IE9 = 错误

> ID：10586376
> 
> 赞同：0
> 
> 时间：2012-05-14T15:28:44.113
> 
> 标签：javascript, mootools, addthis

我正在使用 MooTools 1.4.4 并将其添加到共享页面，但仅在 IE9 上出现错误。当我单击任何服务（电子邮件、更多、StumbleUpon 等）时，什么都没有发生，没有新页面打开，没有菜单，没有弹出窗口。等 IE7、8、chrome 和 FF 运行良好。

IE9 上的错误是（取自开发者工具，控制台选项卡）：

```
SCRIPT5007: Unable to get the value of the property 'contains': object is null or undefined 
MooTools-Yui-compressed.js, line 366 character 37 
```

第 366 行：

```
if(i[f].keys.contains(h)){return this;} 
```

如果我删除那行代码：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/mootools/1.4.4/mootools-yui-compressed.js"></script> 
```

然后，添加这些图标按预期工作，所以我猜错误来自 Mootools 本身？我在这里错了吗？

我不知道为什么会发生这个错误。你们对这种类型的错误有任何线索吗？

编辑：找到了在页面页脚中调用我的 MooTools 脚本的原因。将其移至标题解决了该问题。

# asp.net - IE 中的会话变量

> ID：10586378
> 
> 赞同：1
> 
> 时间：2012-05-14T15:28:57.887
> 
> 标签：asp.net, vb.net, internet-explorer-9, session-variables

搜索，但找不到一个好的答案。

我有一个`ASP.NET`正在开发的应用程序。我在应用程序中使用会话变量。

在`Firefox`&`Chrome`中，它们都有效。
但是在`IE`(ver 9) 中，有一个变量不起作用。目前我不确定它是存储还是检索（或两者兼而有之）。我要存储的变量是 List(T) 类型。这是我正在使用的唯一一种。不禁认为那里有相关性。

另一篇旧帖子提到缓存可能导致问题，但我不太了解答案。

PS 如果可能，请将任何代码示例发布在`VB`. 有时我可以阅读`C#`并翻译它，有时则不能。

```
Dim Rec_IDs As New List(Of String)
Rec_IDs = Session("Rec_IDs")
and
       Dim Rec_IDs As New List(Of String)
        Dim Rec_ID As Int32
        Rec_IDs = Session("Rec_IDs")
        For Each Row As GridViewRow In gvParts.Rows
            If CType(Row.FindControl("chkSelect"), CheckBox).Checked Then
                Rec_ID = gvParts.DataKeys(Row.RowIndex).Value
                If Not Rec_IDs.Contains(Rec_ID) Then
                    Rec_IDs.Add(Rec_ID)
                End If
                CType(Row.FindControl("chkSelect"), CheckBox).Checked = False
            End If
        Next
Session("Rec_IDs") = Rec_IDs
lblCount.Text = String.Format("You have {0} records selected", Rec_IDs.Count.ToString) 
```

其他答案：[会话变量在 Internet Explorer 中不起作用，但在 Firefox / Chrome 中可以正常工作](https://stackoverflow.com/questions/6020330/session-variable-not-working-in-internet-explorer-but-works-fine-in-firefox-c)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:47:53.200

首先检查您的浏览器是否启用了 cookie。如果 cookie 被阻止，这将是问题`IE`

也看看

[Cookieless ASP.NET](http://msdn.microsoft.com/en-us/library/aa479314.aspx) , [ASP.NET 状态管理概述](http://msdn.microsoft.com/en-us/library/75x4ha6s.aspx),[浏览器会话和 asp.net 会话的区别](http://www.eggheadcafe.com/community/asp-net/17/10303311/difference-between-browser-session-and-aspnet-session.aspx)

# javascript - javascript，表格的动态ID：如何识别？

> ID：10586379
> 
> 赞同：-5
> 
> 时间：2012-05-14T15:28:58.697
> 
> 标签：javascript

在我的应用程序中，我使用了一个框架，该框架生成一个表格，其中包含运行时单元格的 id 以升序排列。所以我有 row1 和 column1 的“ElementX1X1”，row1 和 column2 的“ElementX1X2”等......生成的 HTML 结构将是：

```
<tr>
<td class="my_msg" align="left">
<id="ElementX1X1"> 
```

我可以设置的是类（my_msg）和单元格的内容（表格）。我只想制作：

```
var test=document.getElementById("ElementX1X1");
test.onclick=function(); 
```

但我无法识别单元格......我只想让getElementById在“my_msg”类中或者只有当它具有特定内容时（正如我所说的我可以设置的唯一两件事）.. . 任何人都知道我该如何解决这个问题？！提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:36:45.037

将 HTML 更新为：<td id="ElementX1X1" class="my_msg" >...

已编辑 - 解决损坏的框架：

```
<tr>
  <td class="my_msg" align="left">
   <id="ElementX1X1">
   some content
  </td>
  <td class="my_msg" align="left">
   <id="ElementX1X2">
   some content
  </td>
</tr> 
```

如果要查找第 1 行第 2 列，可以使用一些 jQuery 作弊来检查元素的内容：

```
var row = 1; 
var column = 2;
var matched = null;
$(".my_msg").each({ 
    if($(this).html().indexOf('<id="ElementX' + row + 'X' + column + '">')!=-1){ 
        matched = $(this);
    } 
}); 
```

match 将指向您要查找的元素或 null - 但是如果您已经知道单元格的行和列 ID，那么为什么不直接遍历 DOM？

```
var row = 1; 
var column = 2;
var matched = null;
var table = document.getElementsByTagName("TABLE")[0]; // up to you how your find it
try {
    matched = table.getElementsByTagName("TR")[row-1].getElementsByTagName("TD")[column-1];
} 
catch(err) { 
    // not found
} 
```

或蛮力方式（即修复框架输出）：

```
var table = $("#tableid");  // up to you how your find it
table.html(table.html().replace(/">\n<id="/g,'" id="')); 
```

你的代码现在是：

```
<tr>
    <td class="my_msg" align="left" id="ElementX1X1">…&lt;/td>
    <td class="my_msg" align="left" id="ElementX1X2">…&lt;/td>
… 
```

所以你可以使用

```
$("#ElementX2X1"); 
```

选择第一行，第二列

两者都不是特别优雅，但应该在等待修复错误框架时完成工作；）

# java - 为什么 Maven 会生成此错误：“...在 -source 1.5 中不支持”？

> ID：10586384
> 
> 赞同：25
> 
> 时间：2012-05-14T15:29:25.890
> 
> 标签：java, maven

今天早上 Maven 开始抱怨这个错误：

`error: multi-catch statement is not supported in -source 1.5`

奇怪的是，我使用的是 JDK 7，并且这段代码已经构建好几个星期了。我只是在没有指定编译器版本的情况下使用带有默认 POM 的 m2e。

这是我的 Maven 版本信息：

```
Apache Maven 3.0.2 (r1056850; 2011-01-08 19:58:10-0500)
Java version: 1.7.0_03, vendor: Oracle Corporation
Java home: C:\SDKs\Java\jdk1.7.0_03\jre
Default locale: en_US, platform encoding: Cp1252
OS name: "windows 7", version: "6.1", arch: "amd64", family: "windows" 
```

我可以通过使用 Maven 编译器插件来解决它，如下所示：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.4</version>
            <configuration>
                <source>1.7</source>
                <target>1.7</target>
            </configuration>
        </plugin> 
```

尽管如此，我还是想了解为什么 Maven 会突然开始行为不端并需要使用编译器插件。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-14T15:36:11.893

这很可能是您的环境有问题，而不是 Maven（即，您的 JAVA_HOME 环境变量已更改）。值得注意的是，无论如何都需要编译器插件。通过在您的 pom 中包含此编译器部分，您可以确保您的代码使用正确的编译器进行编译，而不管您的环境设置如何。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-14T15:53:47.867

默认源/目标级别是 1.5，显然不支持 Java 1.7 语法。

*   [http://maven.apache.org/plugins/maven-compiler-plugin/compile-mojo.html#source](http://maven.apache.org/plugins/maven-compiler-plugin/compile-mojo.html#source)
*   [http://maven.apache.org/plugins/maven-compiler-plugin/compile-mojo.html#target](http://maven.apache.org/plugins/maven-compiler-plugin/compile-mojo.html#target)

至于为什么它会“突然”改变，你的 m2e 或项目配置发生了一些变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-22T07:06:08.867

您还可以通过对 Eclips 用户使用以下步骤来解决此问题，并且也可以用于 IntelliJ -

右键单击项目并选择 Buid Path，然后选择 Configure Build Path.. 选择 Maven 下的 Project Facets。然后选择Java版本为1.8并应用ok。

# unit-testing - 如何测试受保护的方法？

> ID：10586386
> 
> 赞同：3
> 
> 时间：2012-05-14T15:29:35.140
> 
> 标签：unit-testing, visual-studio-2008, protected

我有一个 ASP.NET 页面，它是更多派生页面的基础，它包含以下受保护的方法

```
protected Change SetupApproval(string changeDescription)
{
    Change change = Change.GetInstance();
    change.Description = changeDescription;
    change.DateOfChange = DateTime.Now;
    change.MadeBy = Common.ActiveDirectory.GetUsersFullName(AccessCheck.CurrentUser());
    change.Page = PageName;
    return change;
} 
```

我想编写以下单元测试

```
[TestMethod]
public void SetupApproval_SubmitChange_ValidateDescription()
{
    var page = new DerivedFromBaseClass();
    var messageToTest = "This is a test description";

    var change = (page as InternalAppsPage).SetupApproval(messageToTest);

    Assert.IsTrue(messageToTest == change.Description);
} 
```

我确信这段代码有很多错误（所以请随时提出更正建议），但我的主要目标是开始为整个项目实施一些测试。我决定从小处着手——一次一种方法。我首先尝试创建一个新的测试项目，但后来我无法访问 SetupApproval 方法，因为它受到保护。我的下一个尝试是将 TestMethod 放在基本页面中，但是没有办法运行测试。

最后，我正在使用 Visual Studio 2008 的默认测试框架。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-14T15:32:36.897

两种选择：

*   假设`DerivedFromBaseClass`是一个仅用于测试的类，只需给它一个新的*公共*（或内部）方法，该方法只调用`SetupApproval`并返回返回值。
*   改为使用该方法`protected internal`，并确保您已`InternalsVisibleTo`为测试程序集进行设置，以便它可以访问内部方法。记录这是为了测试。

第一个选项更简洁，第二个更简单，特别是如果您有很多受保护的方法*并且*基类是非抽象的。

# c# - 使用可变父标记解析 XmlDocument

> ID：10586388
> 
> 赞同：0
> 
> 时间：2012-05-14T15:29:38.347
> 
> 标签：c#, .net, xmldocument

假设我有一个这样的 XmlDocument：

```
<xmlFile>
  <details>
    <code1>ADJ</code1>
    <code2>ADC </code2>
    <Shipment>
      <foo></foo>
      <bar></bar>
    </Shipment>
    <Shipment>
      <foo></foo>
      <bar></bar>
    </Shipment>
  </details>
  <details>
    <code1>ADJ</code1>
    <code2>SCC </code2>
    <Shipment>
      <foo></foo>
      <bar></bar>
    </Shipment>
  </details>
</xmlFile> 
```

我需要在一个 xml 文件中处理每一个，但只处理属于具有值为“ADC”的子节点的标签下的货物。到目前为止，我有：

```
// Assume there is an XmlDocument named xml 
XmlNodeList details= xml.GetElementsByTagName("details");

foreach (XmlNode node in details)
{
   if (node["code2"].InnerText == "ADC ")
   {
   // Get each shipment and process it accordingly.
   }
} 
```

我不知道下一步该做什么。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:49:59.470

这就是你所追求的东西

```
 XmlNodeList details = xml.GetElementsByTagName("details");

        foreach (XmlNode node in details)
        {
            if (node["code2"].InnerText.Trim() == "ADC")
            {
                // Get each shipment and process it accordingly.
                foreach(XmlNode shipment in node.SelectNodes("Shipment"))
                {
                    var foo = shipment.SelectSingleNode("foo");
                    var bar = shipment.SelectSingleNode("bar");
                }
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T20:43:53.157

我正在向这个库添加 XPath 解析：[https ://github.com/ChuckSavage/XmlLib/](https://github.com/ChuckSavage/XmlLib/)

我修改了它，所以你可以这样做：

```
XElement root = XElement.Load(file);
var shipments = root.XPath("details[starts-with(*,'ADC')]/Shipment"); 
```

长手看起来像：

```
var shipments = root.Elements("details")
                    .Where(x => x.Elements().Any(xx => ((string)xx).StartsWith("ADC")))
                    .Elements("Shipment"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:04:55.470

XPath 可以简化您的匹配搜索：

```
foreach (XmlNode node in xml.SelectNodes("/xmlFile/details[normalize-space(code2)='ADC']"))
{
    string foo = node.SelectSingleNode("foo").InnerText;
    string bar = node.SelectSingleNode("bar").InnerText;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:40:13.330

假设 Data\Sample.xml 包含问题中提到的 xml，
以下是 XLINQ 查询

```
 XElement root = XElement.Parse(File.ReadAllText(@"Data\Sample.xml"));
    var adcShipment = root.Descendants().Where(e=>String.Equals(e.Value, "ADC "));
    //next query for nodes/elements inside/next to ADC shipments 
```

# magento - Magento，致命错误，“在非对象上调用 ... getAllOptions() ... Core\Model\Cache.php”

> ID：10586389
> 
> 赞同：10
> 
> 时间：2012-05-14T15:29:43.250
> 
> 标签：magento

添加到我的 frontend/default/[theme]/ 文件夹后，我遇到了一个错误，该站点将不再加载。我删除了有问题的文件，但该网站仍然无法加载。启用 PHP 错误输出会导致此消息：

```
Fatal error: Call to a member function getAllOptions() on a non-object in C:\websites\[snip]\htdocs\app\code\core\Mage\Core\Model\Cache.php on line 449 
```

我已经清除了缓存，当页面（尝试）加载时，var/cache 文件夹中没有创建任何内容......还有什么想法可以缓存在某个地方吗？

另请注意，这已使前端和后端都脱机，因此我无法访问管理系统。

这似乎与此处提到的问题相同（[站点关闭 - 致命错误：第 434 行的 includes/src/Mage_Core_Model_Cache.php](https://stackoverflow.com/questions/8979305/site-down-fatal-error-includes-src-mage-core-model-cache-php-on-line-434)）。我没有启用编译器，所以错误直接在 Core/Model/Cache.php 中。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-29T17:21:47.293

就我而言，发生此问题是因为我的**app/etc/config.xml**文件丢失了。尝试查看您的 XML 配置文件是否存在。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-30T09:16:43.990

解决方案：

将 app/etc/config.xml 从原始 magento 复制到您的 magento。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-29T14:26:33.077

这是修复它的方法（经过大量研究后它对我有用）：

```
chmod 644 app/etc/config.xml
chmod 755 app/etc
chmod 755 app/etc/modules

rm -rf var/cache/* var/session/*
php shell/indexer.php --reindexall 
```

# google-chrome - 谷歌浏览器中奇怪的水平和垂直线

> ID：10586390
> 
> 赞同：7
> 
> 时间：2012-05-14T15:29:43.833
> 
> 标签：google-chrome

问题是谷歌浏览器在我的网站上显示了一些奇怪的垂直和水平线。我认为是渲染问题，但我不确定。

谷歌浏览器版本是 18.0.1025.168

您可以在这里访问网站：[http ://www.plastic-data.com/hotel/](http://www.plastic-data.com/hotel/)

在这里，屏幕截图：

![在此处输入图像描述](../Images/78dd56d806fa3aa2dab0f1871b480dee.png)

我检查了扩展程序，我的谷歌浏览器没有。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2021-03-24T16:32:42.763

装有 Chrome 版本 89.0.4389.90 的 Mac。@cybersholt 和 @Alex_J 提供的方法为我解决了这个问题（尽管 Mac 用户的选项略有不同）：

1.  在 URL 栏中输入 chrome://flags

2.  转到 GPU 光栅化（当前默认）。

3.  设置为禁用

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-06-17T03:45:31.753

这对我有用..！

1) 在 URL 栏中输入 chrome://flags

2）单击“搜索标志”附近顶部的“全部重置为默认值”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-06T16:57:48.957

我希望以下步骤对您有用！

按照步骤：-

1) 在 URL 栏中输入 chrome://flags

2）找到以下条目“合成渲染层边框”

3）确保将其设置为“启用”

4）重新启动浏览器，然后检查！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T15:43:42.630

问题不在浏览器上，也不在您的网站上，我在我安装的 Google Chrome 18.0.1025.168 上进行了测试，如下图所示，没有发现问题：

![在此处输入图像描述](../Images/9f124bb9cede992630036926bbe3031c.png)

**笔记：**

我过去遇到过这个问题，并且是图形驱动程序问题。

我相信这是您使用的计算机上的图形驱动程序问题！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-12T14:30:17.720

我也遇到了同样的问题，45° 水平白色虚线在任何具有纯色背景的 chrome 网站上重复出现。它发生在仅使用 chrome 浏览器的多台计算机上。@cybersholt 解决方案解决了这个问题。

1) 在 URL 栏中输入 chrome://flags

2) 转到 GPU 光栅化 MSAA 样本计数（应设置为默认值）。

3) 设置为 0

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-30T18:28:00.613

有同样的问题。必须禁用此功能：1）在 URL 栏中键入 chrome://flags 2）找到以下条目“合成渲染层边框”。非常感谢您的提示！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-09T20:40:52.033

刚遇到这个问题，虽然我有彩色水平线而不是这样的垂直线：

[![在此处输入图像描述](../Images/424cb200a5c0d0dd81d38f7d6e2a4b33.png)](https://i.stack.imgur.com/fgymi.jpg)

[@Cat-Friend](https://support.google.com/chrome/thread/38144053/weird-horizontal-lines-rendering-for-certain-webpages?hl=en)在这篇文章中描述的评论之一在经过大量搜索后终于解决了这个问题。

要解决此问题：

1.  在 Chrome 中打开设置页面 ( `chrome://settings`)
2.  搜索`hardware acceleration`
3.  禁用硬件加速

# android - 向所有客户端发送输入 SocketServer Android

> ID：10586392
> 
> 赞同：0
> 
> 时间：2012-05-14T15:29:44.437
> 
> 标签：android, sockets, client

我正在尝试创建一个服务器，它将接收到的任何输入发送回所有连接的客户端。我正在使用一个在创建它时启动一个线程的服务。

```
public void onCreate() 
{       
    Thread fst = new Thread(new ServerThread());
    fst.start();
} 
```

这是线程

```
 public void run() 
        {
        try 
            {                                           
                        serverSocket = new ServerSocket(SERVERPORT);
            while (true) 
                {
                    // listen for incoming clients
                    Socket client = serverSocket.accept();
                    mclients = new Vector<Socket>();
                    mclients.add(client);
                    boolean finished = false;   
                    try                             
                        {
                        for(int i=0; i<mclients.size(); i++)        {
                            DataInputStream in = new DataInputStream(mclients.get(i).getInputStream());
                            PrintStream out = new PrintStream(mclients.get(i).getOutputStream());
                            // Print a message:
                            System.out.println("Client from : " + mclients.get(i).getInetAddress() + " port " + mclients.get(i).getPort());
                            // now get the input from the socket...
                            while(!finished) 
                            {
                                String st = in.readLine();
                                // Send the same back to client
                                out.println(st);
                                // Write it to the screen as well
                                System.out.println(st);
                                // If the input was "quit" then exit...
                                if (st.equals("quit")) { finished = true; System.out.println("Thread exiting..."); }
                            }
                                                                    }
                                handler.post(new Runnable() {@Override public void run() {}});                                  

                        }
                    catch (final Exception e) {handler.post(new Runnable() {@Override public void run() {}});e.printStackTrace();}
                } 
```

它仅适用于发送输入的客户端。输入没有回显给所有客户端。任何人都可以帮我解决这个问题。我认为我的客户端代码是错误的，但我无法弄清楚。这是我的客户端代码：

```
public class Client extends Activity implements OnClickListener{

private EditText serverIp;
private static EditText data;
private TextView receivedata, answer1 ,answer2, answer3, answer4;
private Button connectPhones, send;
private String serverIpAddress = "";
private boolean connected = false;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.client);

    serverIp = (EditText) findViewById(R.id.server_ip);
    receivedata = (TextView) findViewById(R.id.textView1);
    answer1 = (TextView) findViewById(R.id.txtans1);
    answer2 = (TextView) findViewById(R.id.txtans2);
    answer3 = (TextView) findViewById(R.id.txtans3);
    answer4 = (TextView) findViewById(R.id.txtans4);
    data = (EditText) findViewById(R.id.data);
    connectPhones = (Button) findViewById(R.id.connect_phones);
    send = (Button) findViewById(R.id.send);
    connectPhones.setOnClickListener(this);
    send.setOnClickListener(this);
}

    @Override
    public void onClick(View v) {        
        if(v == send)
        {
            if (!connected)
            {
                serverIpAddress = serverIp.getText().toString();
                if (!serverIpAddress.equals("")) 
                {
                    Thread cThread = new Thread(new ClientThread());
                    cThread.start();
                }
            }
        }
                                }  
    public class ClientThread implements Runnable 
    {           
        String line;
        String[] answers = new String[5];
            final Handler handler = new Handler();
            final Runnable updateUI = new Runnable()    {
                public void run()   {
                   receivedata.setText( line );
                   //answer1.setText( answers[1] ); 
                   //answer2.setText( answers[2] ); 
                   //answer3.setText( answers[3] ); 
                   //answer4.setText( answers[4] ); 
                                    }
                                                        };
        public void run() 
        {
            try 
            {
                InetAddress serverAddr = InetAddress.getByName(serverIpAddress);
                Log.d("ClientActivity", "C: SENDING...");
                Socket socket = new Socket(serverAddr, 5000);
                connected = true;
                while(connected) 
                {
                    try 
                    {                           
                    BufferedReader in = new BufferedReader( new InputStreamReader( socket.getInputStream()));                        
                    PrintStream out = new PrintStream(socket.getOutputStream());                                            
                    out.println(data.getText());                                 
                    line = in.readLine();       // read server
                    System.out.println("Echo: " + line);                        
                    handler.post(updateUI);
                    in.close();                     // Close stream
                    out.close();
                    }                       
                    catch (Exception e) 
                        {
                            Log.e("ClientActivity", "S: Error", e);                             
                        }                                       
                        connected = false;
                }
                            Log.d("ClientActivity", "C: Closed.");
            }   catch (Exception e)
                        {
                            Log.e("ClientActivity", "C: Error", e);

                        }
        }        
        }} 
```

-----编辑-----
我应该使用不同的线程来处理客户端还是会出现问题？我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T21:25:45.007

我看到您也在循环中实例化 ServerSocket 本身。您不需要为每个连接创建一个新的服务器套接字，您只需要一个服务器套接字然后循环接受连接并将连接添加到（已经在 oncreate() 中实例化）列表。请参见下面的示例。

如果这仍然不起作用，那么我们还必须查看其余代码。我想再次强调，这并不总是适用于 android，因为 android 也可以杀死你的服务和应用程序以获取资源，并且每次 wifi、3g 或手机上的任何东西失去连接时，你的套接字都可能失败。

```
ArrayList<Socket> mCLients;
ServerSocket serverSocket;

public void onCreate() 
{       
    mCLients; = new ArrayList<Socke>();
    serverSocket = new ServerSocket(SERVERPORT);
    Thread fst = new Thread(new ServerThread());
    fst.start();
} 
```

//.....

```
private Static void send(final String message){
    Thread thread = new Thread(){
        for(Socket socket: mClients){
        // send message to the socket
        }
    }
    thread.start();
} 
```

//....

```
public void run(){

            while (true) 
                {
                    // listen for incoming clients
                    Socket client = serverSocket.accept();
                    mclients.add(client);
                    //Read client input
                    MyService.send(message);
                }  

 } 
```

请注意，此代码绝不是最好的方法，我只是给您一个快速示例，说明您应该如何处理这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:41:12.190

通过快速（非常快速）查看，我相信您的问题似乎是 run() 中的以下代码

mclients = 新向量（）；

每次程序运行时，您都在创建一个新的矢量对象。

我建议将其移出 run()，并确保在启动侦听传入连接的线程之前创建您的 mClients。

但是请注意：在安卓手机上运行服务器是个坏主意！手机有一些限制，例如有限的电池寿命、处理能力、内存和不一致的互联网连接，还有其他方法可以处理这种通信。例如考虑消息传递、c2dm、xmpp 等。

# java - JTextField：如何限制字符数？

> ID：10586395
> 
> 赞同：6
> 
> 时间：2012-05-14T15:29:54.847
> 
> 标签：java, swing, jtextfield

请看下面的代码。

```
import java.awt.FlowLayout;
import java.awt.GridLayout;
import javax.swing.*;
import javax.swing.text.AbstractDocument;
import javax.swing.text.AttributeSet;
import javax.swing.text.BadLocationException;
import javax.swing.text.DocumentFilter;

public class Bean extends JFrame
{
    private JTextField field1, field2, field3, field4;
    private JLabel text;
    private JButton ok, cancel;
    private JPanel centerPanel,southPanel, textPanel;
    private GridLayout grid;
    private FlowLayout flow1, flow2;

    public Bean()
    {
        //Declaring instance Variables

        field1 = new JTextField(10);

        field2 = new JTextField(5);
        field3 = new JTextField(5);
        field4 = new JTextField(5);        
        text = new JLabel("Insert Your Numbers Here");

      AbstractDocument d = (AbstractDocument) field1.getDocument();
      d.setDocumentFilter(new Bean.Field1Listener());

        ok = new JButton("OK");
        cancel = new JButton("Cancel");

        /***********************Creating the main view*************************/
        centerPanel = new JPanel();
        grid = new GridLayout(2,1,1,1);

        //Adding TextFields
        textPanel = new JPanel();
        flow1 = new FlowLayout(FlowLayout.CENTER);
        textPanel.setLayout(flow1);

        textPanel.add(field1);

        //Adding Buttons
        southPanel = new JPanel();
        southPanel.setLayout(new FlowLayout(FlowLayout.RIGHT));
        southPanel.add(ok);
        southPanel.add(cancel);

        //Creating Center View
        centerPanel.setLayout(grid);
        centerPanel.add(text);
        centerPanel.add(textPanel);

        //Gathering everything together
        getContentPane().add(centerPanel,"Center");
        getContentPane().add(southPanel,"South");

        this.setSize(500,200);
        this.validate();
        this.setVisible(true);
        this.setLocationRelativeTo(null);

        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    }

    private class Field1Listener extends DocumentFilter
    {

       @Override  
        public void insertString(DocumentFilter.FilterBypass fb, int offset, String string, AttributeSet attr) throws BadLocationException  
        {
            if(fb.getDocument().getLength()+string.length()>5)
            {
                return;
            }

            fb.insertString(offset, string, attr);

        }  

        @Override  
        public void remove(DocumentFilter.FilterBypass fb, int offset, int length) throws BadLocationException 
        {  

            fb.insertString(offset, "", null);
        }  

        @Override  
        public void replace(DocumentFilter.FilterBypass fb, int offset, int length, String text, AttributeSet attrs)throws BadLocationException 
        {  

                 if(fb.getDocument().getLength()+text.length()>5)
                 {
                    System.out.println("OK");
                    return;
                }

                fb.insertString(offset, text, attrs);
        }
    }

    public static void main(String[]args)
    {
        new Bean();
    }
} 
```

在这里，我试图将字符数限制为 5。好的，当它达到 5 时它会停止插入更多字符，但情况是，它也不允许删除插入的字符、替换或任何操作。如何纠正这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T15:51:01.127

只需更改您当前的删除方法：

```
 @Override  
 public void remove(DocumentFilter.FilterBypass fb, int offset, int length) throws BadLocationException 
 {  

     fb.insertString(offset, "", null);
 } 
```

对于这个：

```
 @Override  
 public void remove(DocumentFilter.FilterBypass fb, int offset, int length) throws BadLocationException 
 {  
     fb.remove(offset, length);
 } 
```

它现在应该可以工作了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T15:33:42.840

您应该创建自己的类来检查您是否提供了超过最大允许长度的输入：请参阅[http://www.java2s.com/Tutorial/Java/0240__Swing/LimitJTextFieldinputtoamaximumlength.htm](http://www.java2s.com/Tutorial/Java/0240__Swing/LimitJTextFieldinputtoamaximumlength.htm)上的示例。

# c++ - SDL x 和 y 移动

> ID：10586397
> 
> 赞同：0
> 
> 时间：2012-05-14T15:30:05.653
> 
> 标签：c++, sdl

为什么这段代码不能让我向上或向左移动？

```
while( quit == false )
    { 

    apply_surface( 0,0, back,screen );
    apply_surface( playerx,playery,player, screen );

    SDL_Flip( screen );

        //While there's an event to handle
        while( SDL_PollEvent( &event ) )
        {
            if(event.type == SDL_KEYDOWN)
            {
                switch(event.key.keysym.sym)
                {
                case SDLK_UP:playery=playery-10;
                case SDLK_DOWN:playery=playery+10;
                case SDLK_LEFT:playerx=playerx-10;
                case SDLK_RIGHT:playerx=playerx+10;
                }
            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:33:01.077

您需要`break`在每个之后`case`使用a`switch` 否则执行“失败”到下一行，可能会取消您的操作（实际上`SDLK_UP`并且`SDLK_LEFT`是发生取消的操作）

# layout - 如何在时间轴上的单个数字字段中显示多个值？

> ID：10586399
> 
> 赞同：0
> 
> 时间：2012-05-14T15:30:12.750
> 
> 标签：layout, facebook-opengraph, facebook-timeline

您如何在地图上方的数字字段中显示“3.77 mi run in 30:31 April 21”之类的内容，例如开发人员博客中的此示例：[https ://developers.facebook.com/attachment/endo_agg5.jpg](https://developers.facebook.com/attachment/endo_agg5.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T03:30:34.910

您需要将对象链接到触发墙贴的操作类型。因此，例如，当您有以下情况时：

行动：运行对象：路线

然后，在 MapLayout 中，应填写以下字段：

标题：{route.title}

现在，您将有一个如图所示的可点击链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:26:22.673

在该示例中，“3.77mi run”是对象的标题，其余是时间和持续时间字段，您应该能够在应用程序设置中配置显示类型

# php - 尝试发布时表单输入名称显示为未定义索引

> ID：10586401
> 
> 赞同：0
> 
> 时间：2012-05-14T15:30:19.367
> 
> 标签：php, html, forms

我正在尝试将表单字段的内容发布到 MySql 数据库中。博客的标题和内容应该发布到 mysql 表中，但我不断收到此错误：注意：未定义索引：第 10 行 /home/ooze/public_html/main2/uploadblog.php 中的标题博客注意：未定义索引：/中的博客内容第 11 行的 home/ooze/public_html/main2/uploadblog.php。

```
<table>
<tr class="top row" style="font-weight: bold;"><td>
<p>Upload your blog</p>
<form name="f4" action="uploadblog.php" method="post"  enctype="multipart/form-data">
title: <input type="text" name="titleblog" />
<br/>
<textarea name="blogcontent" rows="10" columns="60" style="width:350px; height:150px;">Enter you blog here
</textarea>
<br/>
<input type="submit" value="Submit" style="margin-left: 300px;"/>
</form>
</td></tr>
</table> 
```

这是php代码：

```
<?php
session_start();
?>
<?php
$a = $_POST["titleblog"];
$b = $_POST["blogcontent"];
$conn = mysql_connect("localhost","ooze","");
mysql_select_db ("ooze");
$mysql="INSERT INTO blog (title, blog_content, date, username) VALUES ('$a','$b', CURDATE(), $_SESSION[gatekeeper])";
mysql_query($mysql) or die(mysql_error());
echo "<p>Blog submitted</p>";
mysql_close($conn);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:00:45.393

您忘记转义字符串以防止 SQL 注入：

```
<?php
session_start();
?>
<?php
$a = mysql_real_escape_string($_POST["titleblog"]); // <--
$b = mysql_real_escape_string($_POST["blogcontent"]); // <--
$conn = mysql_connect("localhost","ooze","");
mysql_select_db ("ooze");
$mysql="INSERT INTO blog (title, blog_content, date, username) VALUES ('$a','$b',     CURDATE(), $_SESSION[gatekeeper])";
mysql_query($mysql) or die(mysql_error());
echo "<p>Blog submitted</p>";
mysql_close($conn);
?> 
```

有关 SQL 注入的更多信息，请参阅：

[http://php.net/manual/en/security.database.sql-injection.php](http://php.net/manual/en/security.database.sql-injection.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:36:58.057

```
<?php
if(isset($_post['submit']) && $_post['submit'] == 'Submit') {
$a = $_POST["titleblog"];
$b = $_POST["blogcontent"];
$conn = mysql_connect("localhost","ooze","");
mysql_select_db ("ooze");
$mysql="INSERT INTO blog (title, blog_content, date, username) VALUES ('$a','$b', CURDATE(), $_SESSION[gatekeeper])";
mysql_query($mysql) or die(mysql_error());
echo "<p>Blog submitted</p>";
mysql_close($conn);
}
?> 
```

并且字段的值也丢失了。像这样给`<input type="text" name="titleblog" value="" />`

# sql - 查询 oracle 数据库的可用性

> ID：10586403
> 
> 赞同：0
> 
> 时间：2012-05-14T15:30:30.537
> 
> 标签：sql, oracle

是否有一个轻量级的 sql 语句可以针对 oracle 数据库来测试数据库是否已启动、可用并能够执行 sql？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:31:34.630

```
SELECT 1
  FROM dual 
```

是一个常见的。您也可以从中选择任何常数值`DUAL`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T21:38:29.070

如果不想先连接，可以通过链接查询，例如我有一组外部系统的链接，我运行如下形式的SQL：

```
select * from global_name@myLink01.WORLD; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T10:09:20.317

如果您编写sql语句来描述双表，那么您也将了解db是否启动并运行。

描述双;

# asp.net - 在asp.net中实现缓存的合适方法

> ID：10586407
> 
> 赞同：1
> 
> 时间：2012-05-14T15:30:42.847
> 
> 标签：asp.net, .net, vb.net, caching

我需要在 Asp.net Web 应用程序中实现缓存 我需要存储具有不同 ID 的数据。那么哪种方法更好呢？

1.  使用字典变量。插入数据（键作为 ID，数据作为值）。

    ```
     Dim mDict As New Dictionary(Of String, String)
        mDict .Add(bID, uwtTree.WriteXmlString(True, True))
        Cache.Insert("mTree", mDict) 
    ```

    将其添加到缓存变量中。访问缓存变量

    ```
     If Not Cache("mTree") is Nothing Then 
            'cast to dictionary and check ID exists , if exsitis get the data
         End iF 
    ```

2.  对不同的 ID 使用缓存变量

    ```
     Cache.Insert(ID,data)
          ' each insertion for each ID
         If Not Cache(ID) is Nothing Then 
            ' get the data. '
         End IF 
    ```

哪种方法是最好的方法？或者还有其他方法存在吗？我正在使用 .Net 3.5 /IIS 7 (VB.Net)。提前致谢

**提高性能和内存优化的方法**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:46:03.813

没有上下文就不可能说哪个“更好”。

但是，如果您将字典放入缓存中（选项 1），最好确保它是线程安全的字典（例如 .NET 4 ConcurrentDictionary）。

两种方法之间最明显的区别是，使用选项 1，缓存项到期将导致字典中的所有项被立即删除。使用选项 2，单个项目将独立过期。

回应评论：

> 我有 xml 数据，我将作为字符串存储在缓存（数据缓存）中。如果我将它存储为 XmlObject 有什么区别吗？

我看到的主要区别是：

*   String 是不可变的，因此您在访问它时无需担心线程安全。XML 对象不是不可变的——因此您需要确保不修改从缓存中检索到的对象（或使用锁来确保任何此类修改都是线程安全的）。

*   如果您存储一个字符串，您可能会在每次从缓存中检索它时将其解析为一个 XML 对象，这将导致潜在的性能损失。

# c++ - WM_EX_TRANSPARENT 不会重绘子窗口

> ID：10586410
> 
> 赞同：5
> 
> 时间：2012-05-14T15:30:54.393
> 
> 标签：c++, winapi, user-interface, ws-ex-transparent

我`WM_EX_TRANSPARENT`在某些窗口上使用窗口样式以尝试进行具有透明度的双缓冲。但是，我遇到了一个问题，因为当我`InvalidateRect`在父窗口上执行时，子窗口不会重绘。

迭代子窗口并让它们重新绘制自己是父窗口的责任，还是我做错了？如果它是父窗口的责任，我怎样才能得到父无效矩形内的所有子窗口？

这是一个完全可编译的示例，说明了我正在谈论的行为。当您将鼠标移到父窗口上时，您可以看到该按钮消失了。如果单击它，该按钮会自行重绘，但当您将鼠标移开并返回父窗口时，它会再次消失。

```
#include <Windows.h>

LRESULT CALLBACK WndProc(HWND window, UINT uMsg, WPARAM wParam, LPARAM lParam) {
    switch (uMsg) {
    case WM_CREATE:
        return 0;

    case WM_MOUSEMOVE:
        InvalidateRect(window, NULL, true);

        return 0;

    case WM_NCDESTROY:
        PostQuitMessage(0);
        break;
    }

    return DefWindowProc(window, uMsg, wParam, lParam);
}

int PASCAL WinMain(HINSTANCE hinst, HINSTANCE, LPSTR, int nShowCmd) {
    WNDCLASS wc;
    wc.style         = 0;
    wc.lpfnWndProc   = WndProc;
    wc.cbClsExtra    = 0;
    wc.cbWndExtra    = 0;
    wc.hInstance     = hinst;
    wc.hIcon         = NULL;
    wc.hCursor       = LoadCursor(NULL, IDC_ARROW);
    wc.hbrBackground = (HBRUSH)(COLOR_WINDOW + 1);
    wc.lpszMenuName  = NULL;
    wc.lpszClassName = "test_window";

    RegisterClass(&wc);

    HWND wnd = CreateWindowEx(WS_EX_TRANSPARENT, "test_window", "test", WS_CLIPCHILDREN | WS_OVERLAPPEDWINDOW, 50, 50, 400, 400, NULL, NULL, hinst, NULL);

    ShowWindow(wnd, SW_SHOW);

    HWND btn = CreateWindowEx(WS_EX_TRANSPARENT, "BUTTON", "button 1", WS_CHILD, 50, 50, 100, 50, wnd, NULL, hinst, NULL);

    ShowWindow(btn, SW_SHOW);

    MSG m;

    while (GetMessage(&m, NULL, 0, 0)) {
        TranslateMessage(&m);
        DispatchMessage(&m);
    }

    return 0;
} 
```

* * *

# 最终的解决方案

是按照下面建议的答案去做，然后在父窗口的`WM_PAINT`消息中向`WM_PAINT`每个孩子发送 a 并让孩子们在父母的双缓冲区中绘画（而不是在自己身上绘画任何东西），然后让父母`BitBlt`在它的缓冲区中（已被绘制到由它自己，然后由它的每个孩子从 Z 顺序的底部到顶部）进入它的`HDC`. 这允许在父项和子项中进行无闪烁绘图，并为子项提供透明度。这是我们得到的最终演示程序：

```
#include <Windows.h>

// the handle to the single child window
HWND child;

// parent's backbuffer so we can use it in the child
HDC bbuf = 0;

LRESULT CALLBACK WndProc(HWND window, UINT uMsg, WPARAM wParam, LPARAM lParam) {
    switch (uMsg) {
    case WM_CREATE:
        return 0;

    case WM_MOUSEMOVE:
        InvalidateRect(window, NULL, true);

        return 0;

    case WM_PAINT: {
        PAINTSTRUCT ps;
        POINT mpos;
        GetCursorPos(&mpos);
        ScreenToClient(window, &mpos);

        BeginPaint(window, &ps);

        // create the backbuffer once
        bbuf = bbuf ? bbuf : CreateCompatibleDC(ps.hdc);

        // hardcoded size is the same in the CreateWindowEx call
        static auto backbmp = CreateCompatibleBitmap(ps.hdc, 400, 400);

        static auto unused = SelectObject(bbuf, backbmp);

        POINT points[2] = {
            { 0, 0 },
            { mpos.x, mpos.y }
        };

        // painting into bbuf
        // give ourselves a white background so we can see the wblack line
        SelectObject(bbuf, (HBRUSH)GetStockObject(WHITE_BRUSH));
        Rectangle(bbuf, 0, 0, 400, 400);
        SelectObject(bbuf, (HBRUSH)GetStockObject(BLACK_BRUSH));
        Polyline(bbuf, points, 2);

        // get the child to paint itself into our bbuf
        SendMessage(child, WM_PAINT, 0, 0);

        // and after the child has drawn, bitblt everything onto the screen
        BitBlt(ps.hdc, 0, 0, 400, 400, bbuf, 0, 0, SRCCOPY);

        EndPaint(window, &ps);

        return 0;
    }

    case WM_ERASEBKGND:
        return 0;

    case WM_NCDESTROY:
        PostQuitMessage(0);
        break;
    }

    return DefWindowProc(window, uMsg, wParam, lParam);
}

LRESULT CALLBACK ChildWndProc(HWND window, UINT uMsg, WPARAM wParam, LPARAM lParam) {
    switch (uMsg) {
    case WM_CREATE:
        return 0;

    case WM_PAINT: {
        PAINTSTRUCT ps;

        BeginPaint(window, &ps);

        static auto backbuffer = CreateCompatibleDC(ps.hdc);
        static auto backbmp = CreateCompatibleBitmap(ps.hdc, 100, 50);

        static auto unused = SelectObject(backbuffer, backbmp);

        // copy the parent's stuff into our backbuffer (the parent has already drawn)
        BitBlt(backbuffer, 0, 0, 100, 50, bbuf, 50, 150, SRCCOPY);

        RECT r = { 0, 0, 50, 100 };

        // draw into our backbuffer
        SetBkMode(backbuffer, TRANSPARENT);
        SetTextColor(backbuffer, RGB(255, 0, 0));
        DrawText(backbuffer, "hello", 5, &r, DT_NOCLIP | DT_TABSTOP | DT_EXPANDTABS | DT_NOPREFIX);

        // bitblt our stuff into the parent's backbuffer
        BitBlt(bbuf, 50, 150, 100, 50, backbuffer, 0, 0, SRCCOPY);

        EndPaint(window, &ps);

        return 0;
    }

    case WM_ERASEBKGND:
        return 0;
    }

    return DefWindowProc(window, uMsg, wParam, lParam);
}

int PASCAL WinMain(HINSTANCE hinst, HINSTANCE, LPSTR, int nShowCmd) {
    WNDCLASS wc;
    wc.style         = 0;
    wc.lpfnWndProc   = WndProc;
    wc.cbClsExtra    = 0;
    wc.cbWndExtra    = 0;
    wc.hInstance     = hinst;
    wc.hIcon         = NULL;
    wc.hCursor       = LoadCursor(NULL, IDC_ARROW);
    wc.hbrBackground = (HBRUSH)(COLOR_WINDOW + 1);
    wc.lpszMenuName  = NULL;
    wc.lpszClassName = "test_window";

    RegisterClass(&wc);

    wc.style         = 0;
    wc.lpfnWndProc   = ChildWndProc;
    wc.cbClsExtra    = 0;
    wc.cbWndExtra    = 0;
    wc.hInstance     = hinst;
    wc.hIcon         = NULL;
    wc.hCursor       = LoadCursor(NULL, IDC_ARROW);
    wc.hbrBackground = (HBRUSH)(COLOR_WINDOW + 1);
    wc.lpszMenuName  = NULL;
    wc.lpszClassName = "transparent_window";

    RegisterClass(&wc);

    HWND wnd = CreateWindowEx(NULL, "test_window", "test", WS_OVERLAPPEDWINDOW | WS_VISIBLE, 50, 50, 400, 400, NULL, NULL, hinst, NULL);

    child = CreateWindowEx(NULL, "transparent_window", "", WS_VISIBLE | WS_CLIPSIBLINGS | WS_CLIPCHILDREN | WS_CHILD, 50, 150, 100, 50, wnd, NULL, hinst, NULL);

    MSG m;

    while (GetMessage(&m, NULL, 0, 0)) {
        TranslateMessage(&m);
        DispatchMessage(&m);
    }

    return 0;
} 
```

再次感谢 johnathon 花了这么多时间帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T06:21:38.847

从您的父窗口窗口样式中删除 WS_CLIPCHILDREN。这将允许父窗口在子窗口的不动产上进行绘制，然后子窗口将在其绘制调用期间有效地在其上绘制。首先调用父窗口的绘制，然后调用任何子窗口的绘制。祝赛斯好运！

# php - 动态地将选项添加到从 mysql 数据库获取值的下拉列表

> ID：10586426
> 
> 赞同：0
> 
> 时间：2012-05-14T15:31:46.947
> 
> 标签：php

我想在不刷新表单的情况下向下拉列表添加一个选项，以便其他控件保留其值。我曾尝试寻找教程，但我发现的只是使用静态选项动态填充下拉列表的教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:55:23.120

为了方便这项任务，我推荐使用 jQuery 库：http: [//jquery.com/](http://jquery.com/)

查找ajax函数： [http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

所以你会有2页，

索引.php：

```
<html>
    <head>
    </head>
    <body>
        <select id="dropdown">
            <option value="default" selected="selected">Default option</option>
        </select>
        <script type="text/javascript">
            $.ajax({
              url: 'dropdown-choices.php',
              success: function(data) {
                $('#dropdown').append(data);
              }
            });                
        </script>
    </body>
</html> 
```

下拉选择.php：

```
<?php
    $sql = mysql_query("SELECT * FROM dropdown_choices;");
    while ($data = mysql_fetch_assoc($sql)) {
        echo '<option value="'+$data['value']+'">'+$data['name']+'</option>';
    }
?> 
```

这应该这样做:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:35:22.903

您必须通过 AJAX 调用获得该选项，然后使用 DOM 在请求回调中的下拉列表中添加一个选项。

# image - 图像比较 结果图像配准。归一化互相关 Opencv

> ID：10586427
> 
> 赞同：1
> 
> 时间：2012-05-14T15:31:47.403
> 
> 标签：image, opencv, comparison, registration, cross-correlation

我需要检查一个图像注册过程的结果有多好。为此，我想到了在两个图像之间使用标准化互相关：过程的基础和结果。问题是我从未使用过互相关，我不知道它是否是更好的方法。

然后通过结果，我可以看到图像在哪里更不相似，并尝试改进图像这部分的配准。

我需要做一个二维互相关吗？那么我会得到一张不同的地图，对吧？

任何帮助/建议都会很有用

# javascript - jQueryUI 内联 DatePicker 直到我更改月份后才起作用

> ID：10586429
> 
> 赞同：0
> 
> 时间：2012-05-14T15:31:59.867
> 
> 标签：javascript, jquery, jquery-ui, datepicker

我正在使用带有 jquery 1.7.2 和 jqueryui 1.8.20 的内联 Datepicker。我遇到的问题是，在我更改日期选择器中的月份之前，以下内容不起作用，然后它就可以正常工作。任何帮助，将不胜感激。

```
$( "#datepicker" ).datepicker({ 
       dateFormat: 'D, dd M yy',
       minDate:0,
       onSelect: function(dateText, inst){ 
            //$('.field_pickDate').html(dateText);
            alert('boo');
            //console.log(dateText);
        } 
    }); 
```

`dateFormat`并且`minDate`都在工作，但`onSelect`事件并没有从一开始就触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:51:52.857

这是该事件的默认功能。

当用户在日期选择器中“选择”某些东西时，它会被触发。

要调用点击事件（在显示日期选择器之前），您可以使用“beforeShow”。

```
$( "#datepicker" ).datepicker({ 
       dateFormat: 'D, dd M yy',
       minDate:0,
       beforeShow: function(input, inst) {
             alert("Fired on click, before the picker is shown");
       },
       onSelect: function(dateText, inst){ 
            //$('.field_pickDate').html(dateText);
            alert('boo');
            //console.log(dateText);
        } 
    }); 
```

这是一个使用您的代码的 JSFiddle 示例。

[http://jsfiddle.net/applehat/jukJa/1/](http://jsfiddle.net/applehat/jukJa/1/)

您总是可以在文本框中添加另一个事件，例如`$('#datepicker').select(function(){ /* do something */ });` ，如果您想检测他们选择字段。

================= 编辑===============

由于您将其用作内联元素，因此我不确定您的问题是什么。我在这里更新了我的 JSFiddle：http: [//jsfiddle.net/applehat/jukJa/2/](http://jsfiddle.net/applehat/jukJa/2/)

一切都在这里按预期工作，所以也许你有其他代码导致问题？

# regex - 主机后的 nginX 匹配路径

> ID：10586430
> 
> 赞同：0
> 
> 时间：2012-05-14T15:32:08.130
> 
> 标签：regex, nginx

我正在尝试实施以下规则：

```
location ~ ^/stylesheets|javascripts|assets/ 
```

但是它匹配：

```
mysite.com/something/something/javascripts 
```

我的想法是这个简单的正则表达式只会匹配。

```
mysite.com/javascripts 
```

我希望它忽略嵌套，这里有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:52:53.233

您必须对 OR'ed 表达式进行分组：`^/(stylesheets|javascripts|assets)/`

否则你会有三个稍微不同的潜在匹配：

1.  `/stylesheets`任何以,开头的路径
2.  `javascripts`任何包含某处的路径和
3.  任何包含任何地方的路径`assets/`。

# java - Schemacrawler 忽略无法访问的架构

> ID：10586436
> 
> 赞同：0
> 
> 时间：2012-05-14T15:32:22.913
> 
> 标签：java, database, schema, database-metadata, schemacrawler

我目前正在使用[Schemacrawler](http://schemacrawler.sourceforge.net/)收集有关各种数据库的信息。

我遇到的问题是运行应用程序的用户无法访问每个数据库。如果我尝试检索模式列表：

```
SchemaCrawlerOptions schemaCrawlerOptions = new SchemaCrawlerOptions();
schemaCrawlerOptions.setSchemaInfoLevel(SchemaInfoLevel.minimum());
schemaCrawlerOptions.setTableTypes(new TableType[] { TableType.table });

Database database = SchemaCrawlerUtility.getDatabase(connection, schemaCrawlerOptions);
database.getSchemas() 
```

...抛出 SchemaCrawlerException（服务器主体“...”在当前安全上下文下无法访问数据库“...”。）。有没有办法只获取可访问的数据库（无需显式声明每个模式名称）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T22:33:07.497

根据您得到的异常，我将假设您使用的是 SQL Server。您需要设置架构包含规则。您可以将其添加到上面的代码片段中：

```
schemaCrawlerOptions.setSchemaInclusionRule(new InclusionRule("schema_name.dbo.*", "")); 
```

# json - 将 Facebook.JsonObject 转换为我的模型

> ID：10586437
> 
> 赞同：-1
> 
> 时间：2012-05-14T15:32:28.713
> 
> 标签：json, facebook-c#-sdk

我在从 facebook（朋友列表）检索信息的应用程序上工作，当我从 facebook 检索列表时，想要将它们转换为我的模型并将它们存储在数据库中之后，可以将 Facebook.JsonObject 转换为我的模型吗？：

```
 dynamic myInfo = _fb.Get("/me/friends?fields=id,name,picture");

            dynamic fbfsort = from dynamic friend in (IList<object>) myInfo["data"] 
                              orderby friend.name ascending 
                              select friend;

             foreach (UserFriend friend in fbfsort) {
                    entity.Friends.Add(friend);

                    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:37:16.673

```
dynamic myInfo = _fb.Get("/me/friends?fields=id,name,picture");

entity.Friends = (
     from dynamic friend 
       in (IList<object>) myInfo["data"] 
  orderby friend.name ascending  
   select new UserFriend()  {
               Id = (long)friend.id, 
               Name = (string)friend.name,
               Picture = (string)friend.picture }
).ToList(); 
```

# vb.net - 如何使用扩展在非实例类型上重载共享方法？

> ID：10586440
> 
> 赞同：3
> 
> 时间：2012-05-14T15:32:36.053
> 
> 标签：vb.net, extension-methods, overloading

我所说的非实例类型是指不公开公共构造函数的类型，因为没有更好的术语。

我想用一个重载来扩展[BitConverter](http://msdn.microsoft.com/en-us/library/system.bitconverter.aspx)类，`ToString()`它需要一个 type 的参数`Char`，代表一个值分隔符。

为什么？默认情况下，`ToString()`调用返回字节数组的字符串表示形式，由破折号分隔。签名不允许您指定不同的分隔符，我觉得这很不幸。

现在因为这不是实例类型，或者可能是因为我正在重载共享方法，所以我很难找到合适的语法来定义我的扩展方法。

我在这里做错了什么，导致重载没有显示在 IntelliSense 中：

```
Imports System.Runtime.CompilerServices

Module BitConverterExtensions
    <Extension()>
    Public Function ToString(ByVal converter As BitConverter, ByVal value() As Byte, ByVal delimiter As Char) As String
        Return BitConverterExtensions.ToString(converter, value, 0, value.Length, delimiter)
    End Function

    <Extension()>
    Public Function ToString(ByVal converter As BitConverter, ByVal value() As Byte, ByVal startIndex As Integer, ByVal delimiter As Char) As String
        Return BitConverterExtensions.ToString(converter, value, startIndex, value.Length, delimiter)
    End Function

    <Extension()>
    Public Function ToString(ByVal converter As BitConverter, ByVal value() As Byte, ByVal startIndex As Integer, ByVal length As Integer, ByVal delimiter As Char) As String
        Dim bytes As String = BitConverter.ToString(value, startIndex, length)
        Return bytes.Replace("-"c, delimiter)
    End Function

End Module 
```

还是根本不可能扩展共享方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:35:12.833

不可能在`shared / static`类型上引入方法的重载。扩展方法是一种功能，其使用由类型的实例而不是类型本身驱动。

# javascript - 仅在第一次出现窗口调整大小时运行命令

> ID：10586449
> 
> 赞同：1
> 
> 时间：2012-05-14T15:33:02.723
> 
> 标签：javascript, jquery, resize

我想知道以下情况是否可能。假设我有下一个`$.resize()`功能：

```
$(window).resize(function(){
    if($(window).width() < 500) console.log('Small');
}); 
```

我知道`Small`只要窗口的大小低于 500，上面的内容就会记录。所以这意味着如果你将窗口的大小从 500 调整到 200，`Small`则将记录大约 300 次。

好吧，这意味着如果您在这些情况下确实运行了一些繁重的功能，浏览器可能会崩溃，因为它会一遍又一遍地运行，直到您停止调整大小或情况发生变化。

所以这就是为什么我要问是否有办法只在条件第一次出现时运行该假设函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:35:15.103

使用[`one`](http://api.jquery.com/one/)事件绑定，它只在事件第一次发生时运行传入的函数一次。

```
$(window).one("resize", function(){
    if($(window).width() < 500) console.log('Small');
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:35:21.147

这应该工作

```
$(window).resize(function(){
    // apply whatever you want to do with it, other conditions etc... 
    // regardless of what you want to do, the following line unbinds the resize event 
    // from within the handler.. consider calling this once all your conditions are met
    $(window).unbind("resize");
}); 
```

此处理程序执行您的代码，然后`resize`从`window`

**编辑**：删除条件。这段代码的目的只是展示如何调用`unbind`，应用最适合您的场景的条件

**编辑 2**：解决其中一条评论，`unbind`我在上面的代码中呈现的方式，最终将取消绑定`resize`事件的所有处理程序。更好的方法是在单独的方法中声明事件处理程序，如下所示：

```
var Window_Resize = function(e) {
   // code goes here
};

$(window).resize(Window_Resize); 
```

并解除绑定，使用这个

```
$(window).unbind(Window_Resize) 
```

这样，您只需删除该特定处理程序。其他处理程序仍将绑定到此事件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T15:36:40.227

您可以`one`在 jquery 中使用事件处理程序来执行此操作。

[http://api.jquery.com/one/](http://api.jquery.com/one/)

像这样

```
$(window).one('resize', function(){alert('lol');}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T15:47:08.797

有两种可能的解决方案。如果您希望处理程序在您*第*一次调整窗口大小时运行，您可以强制它只运行一次：

```
$(window).one('resize', function () {
    if ($(window).width() < 500) console.log('Small');
}); 
```

但是你有一个问题：它实际上只运行*一次*。如果他们再次将其调整为大会发生什么？

一种解决方案是引入一个“容差”区域，仅当窗口在特定时间段内调整大小时才运行代码：

```
var RESIZE_TOLERANCE = 200; // milliseconds

var last_resize = 0;

$(window).resize(function () {
    var current_time = (new Date()).getTime();

    if (current_time - last_resize < RESIZE_TOLERANCE) {
        return; // stop
    }

    last_resize = current_time;

    if ($(window).width() < 500) console.log('Small');
}); 
```

这会强制调整大小处理程序每​​秒最多运行五次。如果您愿意，可以更改容差。

然而，想想这种情况：我们从 999px 调整到 998px，触发调整大小处理程序。然后我们在 200ms 结束之前从 998px 调整到 200px。问题是我们错过了调整大小事件。

一个更好的解决方案是跟踪当前的小状态，并且仅*在状态发生变化*时才执行繁重的代码：

```
var RESIZE_TOLERANCE = 100; // milliseconds
var SMALL_TOLERANCE = 500; // pixels
var last_resize = 0;
var small = $(window).width() < SMALL_TOLERANCE;

$(window).resize(function () {
    var current_time = (new Date()).getTime();

    if (current_time - last_resize < RESIZE_TOLERANCE) {
        return; // stop
    }

    last_resize = current_time;

    var is_small = $(window).width() < SMALL_TOLERANCE;

    if (is_small !== small) {
        // run expensive code here
        small = is_small;
    }
}); 
```

现在容差是 100 毫秒，这意味着我们不会重新计算窗口的宽度。（如果需要，您可以删除或更改它。）我们仅在屏幕状态发生更改时才运行昂贵的代码。我不知道这是否是您正在寻找的，但是如果您的要求略有不同，您将必须具有创造性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T15:37:24.953

直截了当的答案是：

```
$(window).resize(function(){
  if($(window).width() < 500 && !ranfirst) {
    ranfirst = true;
    console.log('Small');
  }
}); 
```

这可能不会按照您的想法工作，尽管它确实满足您问题的措辞。您可能会发现需要设置超时来轮询窗口的大小，并`ranfirst`在大小保持不变 10 秒左右时取消设置。

# gwt - SimplePager 错误显示元素计数

> ID：10586450
> 
> 赞同：1
> 
> 时间：2012-05-14T15:33:03.940
> 
> 标签：gwt

[JAVA]

我正在使用 CellTable 和 SimplePager，通过 RPC 在我的数据提供程序中获取数据。效果很好。

寻呼机显示例如“14-28 of 120”，这是正确的。当查询返回要显示的零个元素时，寻呼机显示“1-1 of 0”，即使我使用`my_cellTable.setRowCount(0);`

如何让它显示“0 of 0”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T01:05:07.587

是的，有这个问题。要解决此问题，您需要创建自己的自定义寻呼机。扩展 `SimplePager`和覆盖方法`createText()`。例如：

```
public class MySimplePager extends SimplePager {
    @Override
    protected String createText() {
        NumberFormat formatter = NumberFormat.getFormat("#,###");
        HasRows display = getDisplay();
        Range range = display.getVisibleRange();
        int pageStart = range.getStart() + 1;
        int pageSize = range.getLength();
        int dataSize = display.getRowCount();
        int endIndex = Math.min( dataSize, pageStart + pageSize - 1);
        endIndex = Math.max(pageStart, endIndex);
        boolean exact = display.isRowCountExact();
        if (dataSize == 0) {
           return "0 of 0";
        } else if (pageStart == endIndex) {
                 return formatter.format(pageStart) 
                        + " of "
                        + formatter.format(dataSize);
        }
        return formatter.format(pageStart)
            + "-"
            + formatter.format(endIndex)
            + (exact ? " of " : " of over ")
            + formatter.format(dataSize);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-19T08:39:17.357

我所做的只是在元素数量为 0 时将寻呼机的可见性设置为 false。

# ios - 具有对 CSS 的绝对路径引用的 UIWebView

> ID：10586455
> 
> 赞同：4
> 
> 时间：2012-05-14T15:33:20.987
> 
> 标签：ios

我有许多在 UIWebView 中使用的网页，它们当前使用相对路径和绝对路径引用资源，如下所示：

```
<link rel="stylesheet" type="text/css" href="/css/path/mycss.css"/>
<img src="myimage.png" /> 
```

HTML 文件本身位于路径“/page/path/page.html”，myimage.png 位于同一目录中。这些相同的页面也用于直接在浏览器中呈现，理想情况下我宁愿不更改路径。在 iPad 上，网站内容被动态加载到 Documents 目录中以供离线查看。问题是似乎没有任何方法可以让 UIWebView 处理绝对路径的分辨率。我正在使用以下内容加载内容：

```
NSData *data = [NSData dataWithContentsOfFile:fullPath];    
[self loadData:data MIMEType:@"text/html" textEncodingName:@"utf-8" baseURL:baseURL]; 
```

如果我将 baseURL 指向“/page/path”目录，UIWebView 将正确找到 myimage.png，但不会找到 mycss.css。我还尝试将 baseURL 指向 Documents 目录，但这无法解析任一资源。事实上，我根本无法让 UIWebView 解析任何绝对路径。

有没有人能够获得使用 UIWebView 的绝对路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:37:26.673

您是否尝试对 CSS 的路径使用类似的东西（见下文）？

```
<link rel="stylesheet" type="text/css" href="../../css/path/mycss.css"/>
<img src="myimage.png" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:45:49.847

为什么要在 html 文件中添加一些绝对路径引用？

我认为这不是一个好主意，因为您无法知道未来用户的应用程序安装路径。

例如，我的嵌入式网页位于

```
file://localhost/var/mobile/Applications/0E8A7BA5-8DB7-4F88-AC69-0E48F9182DD2/MyApp.app/homepage/index.html 
```

每次删除应用程序时，0E8A7BA5-8DB7-4F88-AC69-0E48F9182DD2 部分都会更改！

我认为好的方法是

*   通过选择“为任何添加的文件夹创建文件夹引用”在 xCode 中添加您的网站
*   只有一些相对路径
*   利用 ：

    ```
    NSString * urlString = [[NSBundle mainBundle] pathForResource:@"index" ofType:@"html" inDirectory:@"homepage"];
    NSURL * url = [NSURL fileURLWithPath:urlString isDirectory:NO];
    NSURLRequest *request = [NSURLRequest requestWithURL:url cachePolicy:NSURLRequestReloadIgnoringCacheData timeoutInterval:(NSTimeInterval)10.0 ]; 
    ```

# .net - 做 WCF 回调超时

> ID：10586466
> 
> 赞同：11
> 
> 时间：2012-05-14T15:33:52.747
> 
> 标签：.net, wcf, callback, publish-subscribe

我编写了一个系统，它使用带有回调的双工 NetTcp 通道来充当发布/订阅服务器。

如果一段时间后没有发送连接，我是否必须担心回调超时，或者回调管道会无限期地维护？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-14T15:51:08.223

回调不会无限期维护，它会查找您在配置中设置的超时值。如果启用可靠会话，则可以设置客户端的不活动超时。您可以像这样配置超时：

```
 <netTcpBinding>
    <binding 
             closeTimeout="00:01:00"
             openTimeout="00:01:00" 
             receiveTimeout="00:10:00" 
             sendTimeout="00:01:00"
             transactionFlow="false" 
           ......>
        <reliableSession ordered="true" inactivityTimeout="00:10:00" enabled="true" />
    </binding>
  </netTcpBinding> 
```

当达到这些值并且仍然没有响应时，您的通信通道出现故障，您需要重新创建客户端代理以使用服务。默认值为`receiveTimeout`10 分钟，因此您可以增加该值，但也要确保增加您`inactivityTimeout`的，您的`inactivityTimeout`应该大于您的`receiveTimeout`.

**编辑：**

`receiveTimeout`您可以根据客户端发送回服务器的值以编程方式不断更改您的值，关键是在服务和客户端上保持*新*的超时值相同。您将在客户端上执行此操作（我从使用 WCF 制作并使用 Silverlight 客户端的聊天服务中获取示例）：

```
//Create different clients dynamically
MyChatServiceClient _client1 = new MyChatServiceClient( "NetTcpBinding_IMyChatService_1");
MyChatServiceClient _client2 = new MyChatServiceClient( "NetTcpBinding_IMyChatService_2"); 
```

在客户端配置中：

```
<!--In your config file, define multiple endpoints/behaviors with different values based on your needs-->
        <bindings>
            <customBinding>
                <binding name="NetTcpBinding_IMyChatService_1" receiveTimeout="00:01:00" ...>
                    <binaryMessageEncoding />
                    <tcpTransport maxReceivedMessageSize="283647" maxBufferSize="283647" />
                </binding>
                <binding name="NetTcpBinding_IMyChatService_2" receiveTimeout="00:22:00" ...>
                    <binaryMessageEncoding />
                    <tcpTransport maxReceivedMessageSize="2147483647" maxBufferSize="2147483647" />
                </binding>
            </customBinding>
        </bindings>
        <client>
            <endpoint address="net.tcp://192.168.1.51:4520/VideoChatServer/"
                binding="customBinding" bindingConfiguration="NetTcpBinding_IMyChatService_1"
                contract="IMyChatService" name="NetTcpBinding_IMyChatService_1" />

          <endpoint address="net.tcp://192.168.1.51:4522/VideoChatServer/"
                binding="customBinding" bindingConfiguration="NetTcpBinding_IMyChatService_2"
                contract="IMyChatService" name="NetTcpBinding_IMyChatService_2" />
        </client> 
```

因此，您可以在客户端或服务器的配置中定义多个端点或绑定，然后根据应用程序中的任何事件，您可以实例化 _clientProxyX 以使用 _serviceInstanceX ，这将具有不同的绑定/端点值，但与您*之前*的服务实例具有相同的合同. 在上面的示例中，第一个绑定的超时时间为 1 分钟，第二个绑定的超时时间为 2 分钟。需要考虑的重要一点是，如果您希望像这样重新创建新的客户端代理，那么您需要拆除旧的客户端代理并创建一个新的代理，这样可以有效地将您的客户端与服务断开连接，至少暂时如此。

您还可以在实例化新服务主机时在两个服务器上以编程方式修改这些值（等）`openTimeout`。`closeTimeout`您可以根据您在配置中定义的绑定配置之一创建新主机，或者以编程方式创建新配置，如下所示：

```
var host = new ServiceHost(typeof(MyChatService));
            var webHttpBinding = new System.ServiceModel.WebHttpBinding();
            //Modify new timeout values before starting the host
            webHttpBinding.OpenTimeout = new TimeSpan(1, 0, 0);
            webHttpBinding.CloseTimeout = new TimeSpan(1, 0, 0);
            host.AddServiceEndpoint(webHttpBinding, "http://192.168.1.51/myService.svc");
            //start the host after necessary adjustments
            host.Open(); 
```

我知道这看起来很混乱，但关键是 WCF 为您提供了很大的灵活性，能够以编程方式修改您的绑定配置。请务必查看有关[修改](https://stackoverflow.com/a/966349/189756)WCF 配置文件的出色答案。[您还可以轻松地以编程](https://stackoverflow.com/a/292810/189756)方式创建整个服务配置。

# php - 从下拉列表中按字母顺序选择“最近”选项

> ID：10586468
> 
> 赞同：0
> 
> 时间：2012-05-14T15:33:55.743
> 
> 标签：php, javascript, html

我在下拉列表中有一个单词列表，我有一个单词正在寻找合适的合作伙伴（用户正在选择它）为了使用户更容易（因为列表可能很长并且过程必须快速) 我想给出一个可能的选择。

我已经看过了我是如何更改所选单词的。

我想找到按字母顺序排列的“最近”选项，但我不知道如何找出哪个单词是最近的 neigbore....

我已经用谷歌搜索了我能想到的所有单词以获得解决方案，但我找不到任何东西。

有人有一个想法我该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:43:31.100

该[`levenshtein`函数](http://php.net/manual/en/function.levenshtein.php)将计算 2 个字符串的“接近度”。您可以相对于用户的字符串对您拥有的单词进行排名，并返回具有最低值的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:43:42.747

看看这个库，它包含 javascript 的模糊字符串匹配函数，包括词干、列文斯坦距离和变音：[http ://code.google.com/p/yeti-witch/](http://code.google.com/p/yeti-witch/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:38:03.967

如果按字母顺序表示从左侧读取的匹配字母，那么答案很简单。只需浏览单词的每个字母并将其与选择下拉列表中的字母进行比较。共享最长起始子字符串的单词是您的“最近的”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:46:01.670

`<`javascript 中最简单（可能也是最快）的事情是（通过二进制搜索）使用和`>`字符串运算符找到将单词放在选项单词的排序数组中的位置。

要获得更高级和更精确的结果，请使用[Levenshtein distance](http://en.wikipedia.org/wiki/Levenshtein_distance)

# configuration - 如何定义要从 IPython 的提示调用的自定义函数？

> ID：10586471
> 
> 赞同：2
> 
> 时间：2012-05-14T15:34:00.673
> 
> 标签：configuration, ipython

我有一个旧的 ipy_user_conf.py ，其中我在用户命名空间中包含了一个简单的函数，如下所示：

```
import IPython.ipapi
ip = IPython.ipapi.get()

def myfunc():
   ...

ip.user_ns['myfunc'] = myfunc 
```

然后，我可以在提示符中使用 myfunc 。

但是，我更新到 IPython 0.12.1，现在 ip_user_conf.py 不起作用。我还没有看到如何将这种用于提示的自定义函数转换为新的配置模型。

哪种方法可以做到这一点？

最好的问候，曼努埃尔。

更新：将主题更改为问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T14:48:16.973

在阅读了一些文档（并查看了线索的源代码）后，我找到了解决这个问题的方法。

现在，您应该将所有自定义函数移动到`.ipython`目录中的模块中。因为我所做的是一个简单的函数，它返回当前目录的 git 分支和状态，所以我创建了一个名为的文件`gitprompt.py`，然后我在`exec_file`配置选项中包含了文件名：

```
c.InteractiveShellApp.exec_files = [b'gitprompt.py'] 
```

此类文件中的所有定义都放置在用户命名空间中。所以现在我可以在提示符中使用它：

```
# Input prompt.  '\#' will be transformed to the prompt number
c.PromptManager.in_template = br'{color.Green}\# {color.LightBlue}~\u{color.Green}:\w{color.LightBlue} {git_branch_and_st} \$\n>>> '

# Continuation prompt.
c.PromptManager.in2_template = br'... ' 
```

请注意，为了使函数表现得如此（即每次打印提示时调用），您需要使用`IPython.core.prompts.LazyEvaluation`该类。您可以将它用作您的功能的装饰器。已`gitprompt.py`作为要点置于公共领域：[https ://gist.github.com/2719419](https://gist.github.com/2719419)

# asp.net-mvc - ASP.NET MVC - 为同一个控制器和操作创建 2 个 URL

> ID：10586472
> 
> 赞同：0
> 
> 时间：2012-05-14T15:34:02.067
> 
> 标签：asp.net-mvc, url-routing, asp.net-mvc-routing

我是否可以在不创建新控制器的情况下为控制器/操作创建 url 别名？

mypage.com/Hello/World

我想要那个页面

mypage.com/Hi/Universe

实际上将显示 /Hello/World 的内容以及如何创建 Hi 控制器。

谢谢

**更新**

我有一个控制器： `OpenRealAccountController`with action `Start`。
我想路由`GlobalAccount/StepOne`以显示以下内容：`OpenRealAccount/Start`
这是我添加到方法中的内容`RegisterRoutes`：：

```
routes.MapRoute(
              "GlobalOnBoarding_Change",
              "GlobalAccount/StepOne",
              new { controller = "OpenRealAccount", action = "Start" }); 
```

问题是我得到：`"The resource cannot be found."`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:36:21.897

是的，在 global.asax.cs 文件中使用路由：

*   定义`hello/world`指向控制器和动作的路由
*   定义一个路由`hi/universe`也指向相同的控制器动作

一个例子是：

```
routes.MapRoute(
              "helloWorld",
              "hello/world",
              new { controller = "HelloWorld", action = "index" });

routes.MapRoute(
              "hiUniverse",
              "hi/universe",
              new { controller = "HelloWorld", action = "index" }); 
```

# ruby-on-rails - How do I set a custom ETag value in a Rails controller response?

> ID：10586475
> 
> 赞同：-2
> 
> 时间：2012-05-14T15:34:05.937
> 
> 标签：ruby-on-rails, etag, actioncontroller

For one controller (only), I'd like to use an ETag value generated outside of rails caching logic, and manage 304-vs-200 responses myself. It seems that nothing I do to set the ETag header works:

```
response.etag = myEtag
headers['ETag'] = myEtag
render :text => myText, :etag => myEtag 
```

Rails always uses its own version.

I know I could disable caching app-wide, but I don't want that - just want to override it in the responses for one `ActionController` subclass.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:39:33.597

`fresh_when`, etc. didn't quite suit my needs - in my case the solution was to refuse caching via

```
def caching_allowed?
  false
end 
```

then set *just* the `headers['ETag']` member on my response - setting any of the `.etag` options seems to cause Rails to MD5 All The Things.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-03T07:29:14.460

Also if you would like to overwrite it directly, you can set the etag value like below:

```
headers['ETag'] = 'xxxxxx' 
```

Code reference from Rack (**rack-1.6.11/lib/rack/etag.rb**)

```
if etag_status?(status) && etag_body?(body) && !skip_caching?(headers)
    original_body = body
    digest, new_body = digest_body(body)
    body = Rack::BodyProxy.new(new_body) do
        original_body.close if original_body.respond_to?(:close)
    end
    headers[ETAG_STRING] = %(W/"#{digest}") if digest
end

private

def skip_caching?(headers)
    (headers[CACHE_CONTROL] && headers[CACHE_CONTROL].include?('no-cache')) ||
      headers.key?(ETAG_STRING) || headers.key?('Last-Modified')
end 
```

# xml - 寻求使用 XSLT 将 XML 转换为 HTML 树视图的优雅解决方案

> ID：10586477
> 
> 赞同：1
> 
> 时间：2012-05-14T15:34:07.803
> 
> 标签：xml, xslt

（我已经广泛研究了这个问题，但还没有找到合适的解决方案。）

我正在使用 XSLT 将一系列 XML 文件转换为类似“树”的 HTML 文档，其中元素之间的父子关系通过缩进反映出来。

下面的解决方案工作正常，但它太冗长，我们还需要适应将来向模式中添加一些新元素。

有什么好的通用解决方案可以满足我们的需要？我在网上看到了递归解决方案，其中使用“深度”变量并递增并作为参数传入，并用于驱动缩进级别；这似乎是一种常见的模式，但我无法让它为我工作。

谢谢。

所以我的数据文件如下所示：

```
<document>
  <metadata>
    <version>1.0</version>
    <date>1/1/12</date>
    etc...
  </metadata>
  <trackdata>
    <tracks>
      <track>123</track>
      <track>456</track>
      etc...
  </trackdata>
</document> 
```

和 XSLT（注意不同级别的文本缩进的不同值）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="html" indent="no"/>
    <xsl:template match="@*|node()">
        <xsl:apply-templates select="@*|node()" />
    </xsl:template>

        <xsl:template match="metadata">
            Metadata: <xsl:apply-templates/>
        </xsl:template>

        <xsl:template match="version">
          <div style="text-indent:3em">Version: <xsl:value-of select="text()"/></div>
        </xsl:template>

        <xsl:template match="date">
          <div style="text-indent:3em">Date: <xsl:value-of select="text()"/></div>
        </xsl:template>

        <xsl:template match="trackdata">
          Track Data: <xsl:value-of select="text()"/></div>
        </xsl:template>

        <xsl:template match="tracks">
            <div style="text-indent:3em">Tracks: <xsl:apply-templates/>
        </xsl:template>

        <xsl:template match="track">
          <div style="text-indent:6em">Track: <xsl:value-of select="text()"/></div>
        </xsl:template> 
```

ETC...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:57:30.783

尝试创建一个变量来保存该`text-indent`值。像这样的东西：

```
 <xsl:template match="version">
    <xsl:variable name="vIndent" select="count(ancestor::*) * 3"/>    
    <div style="text-indent:{$vIndent}em">Version: <xsl:value-of select="text()"/></div>
  </xsl:template> 
```

这是另一个完整的用法示例...

**XML 输入**（格式正确）

```
<document>
  <metadata>
    <version>1.0</version>
    <date>1/1/12</date>
  </metadata>
  <trackdata>
    <tracks>
      <track>123</track>
      <track>456</track>
    </tracks>
  </trackdata>
</document> 
```

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="html" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="text()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/">
    <html>
      <xsl:apply-templates/>
    </html>
  </xsl:template>

  <xsl:template match="*">
    <xsl:variable name="vIndent" select="count(ancestor::*) * 3"/>
    <div style="text-indent:{$vIndent}em"><xsl:value-of select="name()"/>: <xsl:apply-templates/></div>
  </xsl:template>

  <xsl:template match="document">
    <xsl:apply-templates/>
  </xsl:template>  

</xsl:stylesheet> 
```

**原始 HTML 输出**

```
<html>
   <div style="text-indent:3em">metadata: 
      <div style="text-indent:6em">version: 1.0</div>
      <div style="text-indent:6em">date: 1/1/12</div>
   </div>
   <div style="text-indent:3em">trackdata: 
      <div style="text-indent:6em">tracks: 
         <div style="text-indent:9em">track: 123</div>
         <div style="text-indent:9em">track: 456</div>
      </div>
   </div>
</html> 
```

如果您希望第一个 div 没有缩进，您可以将变量更改为：

```
<xsl:variable name="vIndent" select="(count(ancestor::*) * 3) - 3"/> 
```

# c# - 在用户控件内的 modalpopup 内的按钮的单击事件后刷新 UpdatePanel

> ID：10586478
> 
> 赞同：0
> 
> 时间：2012-05-14T15:34:16.030
> 
> 标签：c#, asp.net, updatepanel, ajaxcontroltoolkit, modalpopupextender

我有一个带有列表框的页面和一个放置在更新面板中的用户控件，如下所示：

```
<%@ Register TagPrefix="uc1" TagName="CMessage" Src="~/Controls/CMessage.ascx" %>
<ajaxToolkit:ToolkitScriptManager runat="server" ID="ToolkitScriptManager1" EnableScriptGlobalization="true" EnableScriptLocalization="true" />
    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
        <ContentTemplate>
            <asp:ListBox ID="lbox" runat="server"></asp:ListBox>
            <asp:Button ID="btnDelete" OnClick="btnDelete_Click" runat="server" Text="Delete selected item" Enabled="True"></asp:Button>
            <uc1:CMessage ID="CMessage1" runat="server" />
        </ContentTemplate>
    </asp:UpdatePanel> 
```

页面代码隐藏是这样的：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        lbox.Items.Add("test1");
        lbox.Items.Add("test2");
    }
}
protected void btnDelete_Click(object sender, EventArgs e)
{
    CMessage.MessageConfirm("Delete item?", "Yes", "No", DeleteItem);
}
protected void DeleteItem()
{
  lbox.Items.Remove(lbox.SelectedItem);
  CMessage.Message("Item deleted succesfully!");
} 
```

用户控件是这样的：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="CMessage.ascx.cs" Inherits="Controles.CMessage" %>
    <table id="tableMessage" runat="server" style="display: none" class="modalPopup">
        <tr>
            <td>
                <asp:Label ID="lb5" runat="server" Text="Message"></asp:Label>
            </td>
        </tr>
        <tr>
            <td>
                <asp:Label ID="lbMessage" runat="server"></asp:Label>
            </td>
        </tr>
        <tr>
            <td>
                <asp:Button ID="btnOk" runat="server" Text="Ok" OnClick="btnOk_Click" />
                <asp:Button ID="btnCancel" runat="server" Text="Cancel" OnClick="btnCancel_Click" />
            </td>
        </tr>
   </table>
   <asp:Button ID="btnOKError" runat="server" Text="OK" style="display: none" />    
   <ajaxToolkit:ModalPopupExtender ID="ModalPopupMessage" runat="server" TargetControlID="btnOKError" PopupControlID="tableMessage" OkControlID="btnOKError" CancelControlID="btnOKError"></ajaxToolkit:ModalPopupExtender> 
```

用户控件代码隐藏是这样的：

```
public partial class CMensaje : UserControl
{
    public delegate void FunctionButtonPressed();

    private FunctionButtonPressed FunctionButtonPressedOk
    {
        get { return (FunctionButtonPressed)Session["FunctionButtonPressedOk"]; }
        set { Session["FunctionButtonPressedOk"]= value; }
    }
    protected void btnOk_Click(object sender, EventArgs e)
    {
        ModalPopupMenssage.Hide();
        if (FunctionButtonPressedOk!= null)
        {
            FunctionButtonPressedOk();
        }
    }
    protected void btnCancel_Click(object sender, EventArgs e)
    {
        ModalPopupMessage.Hide();
    }
    public void Mensaje(string message)
    {
        lbMessage.Text = message;
        FunctionButtonPressedOk= null;
        btnCancel.Visible = false;
        ModalPopupMessage.Show();
    }
    public void MessageConfirm(string message, FunctionButtonPressed FunButtonOkx)
    {
        lbMessage.Text = message;
        FunctionButtonPressedOk= FunBotonAceptarx;
        btnCancel.Visible = true;
        ModalPopupMensaje.Show();
    }
} 
```

一切正常，显示弹出窗口，如果用户按下 ok 并正确触发等，从页面调用的函数被传递给用户控件以触发它。但是在最后一个函数 DeleteItem() 中对页面所做的更改（在此例如从列表框中删除的项目和启动的通知消息）不起作用。

它就像更新面板不刷新。我不能手动调用 UpdatePanel1.Update() 因为我有更新模式一如既往。理论上，在页面周期的这一部分中，它应该用更改刷新页面......

我尝试在用户控件页面加载中添加 OK 按钮作为 UpdatePanel 的 PostBackTrigger，但无济于事，并且作为 AsyncPostBackTrigger。

请记住，这是页面和用户控件的精简版本，因此人们可以专注于手头的问题，所以如果您需要更多详细信息，请咨询我...

代码流程是这样的：

1.  用户点击删除项目按钮并触发页面中的btnDelete_Click()（第一次回发）

2.  btnDelete_Click() 调用用户控件 CMessage.MessageConfirm 传递 DeleteItem 作为参数

3.  在用户控件 MessageConfirm() 显示 modalpopup 并保存参数函数 DeleteItem() 以便稍后调用它（第一次回发结束）

4.  显示 modalpopup 后，用户单击其 Ok 按钮并触发用户控件中的 btnOk_Click()（第二次回发）

5.  在用户控件 btnOk_Click() 调用之前保存的 DeleteItem() 函数

6.  在页面 DeleteItem() 从 ListBox 中删除项目（假设我不调用第二条消息来简化，这将是第二次回发的结束，并且更新面板尚未刷新：S）

我想我已经隔离了问题，将所有控件和函数从用户控件移动到页面，问题仍然存在，但是如果我直接调用 DeleteItem() 函数而不是他的委托它工作（请记住，在这两种情况下DeleteItem() 处的断点已触发，因此函数代码正确执行）：

```
protected void btnOk_Click(object sender, EventArgs e)
    {
        ModalPopupMenssage.Hide();
        /*if (FunctionButtonPressedOk!= null)
        {
            FunctionButtonPressedOk();
        }*/
        DeleteItem(); //page updates correctly! why?
    } 
```

与代表有一些不兼容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T08:35:58.117

最后我解决了它，改变了以下几行：

```
if (FunctionButtonPressedOk!= null)
        {
            //FunctionButtonPressedOk();
            Page.GetType().InvokeMember(FunctionButtonPressedOk.Method.Name, BindingFlags.InvokeMethod, null, Page, new []{sender, e});
        } 
```

为什么它会这样工作？内部有什么区别？

# c# - 为 UAC 提示自定义 app.manifest 的作者姓名/外观

> ID：10586480
> 
> 赞同：1
> 
> 时间：2012-05-14T15:34:36.460
> 
> 标签：c#, .net-3.5, uac

到目前为止，我的 UAC 提示出现了，但其中没有我的作者姓名，并且是黄色的。我该如何改变呢？

谢谢特雷弗·海因斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T06:20:54.717

您已经对可执行文件进行了数字签名。这是让您的名字显示为发布者并将 UAC 的颜色更改为蓝色的唯一方法。

请参阅[数字代码签名分步指南](http://msdn.microsoft.com/en-us/library/aa140234%28v=office.10%29.aspx)。这篇文章讨论了 Office 和智能标签，但它可以用作对其他文件进行数字签名的指南。

您用于签名的证书必须是*受信任*的，即您必须从受信任的证书颁发机构购买它。如果您使用文章中所示的自签名证书对可执行文件进行签名，则它将不受信任，并且 UAC 提示中不会发生任何变化。

# android - Android GUI XML 与代码

> ID：10586482
> 
> 赞同：2
> 
> 时间：2012-05-14T15:34:56.810
> 
> 标签：android

根据在 android 中创建 GUI，我有一个简短的问题。哪种方式更好的 xml 或编码？我总是读到 xml 更好，但想象一下你有一个滚动视图。滚动视图内部是一个相对布局。里面应该有几行，一个 ImageView 旁边是一个 RadioButton 旁边的 TextView。行数可以变化。让我们说 xml 中的 50 个视图或创建这些视图的代码中的循环真的更好吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T15:39:19.140

每个都有其优点和缺点。仅举几个：

**XML**

*   优点 -> 快速的 GUI 开发，保持代码干净
*   缺点->静态

**动态（代码）**

*   专业人士 -> 能够对运行时条件做出反应
*   缺点 -> 更多代码，这意味着更差的可维护性和潜在的错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:37:25.280

如果您需要动态添加组件，唯一的方法是使用代码（或）混合方法（在 XML 中定义布局并在代码中添加组件）。如果您的组件是静态 XML 可能是最好的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T15:39:15.490

当然，动态内容是动态添加的。所以你的例子需要一些java代码。不过，您应该只以编程方式添加动态部分，因此您仍然会为静态部分使用 xml 文档（布局完全动态是非常不寻常的）。

如果您有固定数量的视图，那么可以，我会在 xml 中而不是循环中编写其中的 50 个。我猜您想知道代码重复问题，据我所知，您在使用 xml 时会遇到一些问题。

（在 xmls 中最小化代码重复的一种方法是使用样式和主题）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T15:51:06.647

我同意以上所述。XML 是一种更好的方法，即使您需要动态更新，您仍然可以使用 XML 的点点滴滴来呈现内容。您的代码将基于 XML 元素，但 XML 文件将是独立的。因此，如果您破坏了代码中的功能，您就会知道是您的业务逻辑被破坏而不是 UI 部分，这将使开发和发现问题变得更加容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T15:40:13.880

为什么不使用 ListView 而不是 ScrollView。实施起来会更简单，并且性能必须更好。

使用 ListView 创建一个 XML 文件，并在您的活动中实现您自己的适配器来实例化行。你可以在网上找到很多关于这个的教程，我相信你会找到你需要的！祝你好运。

# jsf - 未调用 JSF 操作方法

> ID：10586489
> 
> 赞同：4
> 
> 时间：2012-05-14T15:35:17.763
> 
> 标签：jsf, methods, action

我有一个 JSF 视图，其中包含 Primefaces 数据表和其中的命令按钮，如下所示：

```
<p:messages id="statusMessages" showDetail="true" />
    <h:form id="listForm">
        <p:panel header="Wellsite List">
            <br />
            <h:outputLabel value="Welcome, #{wellsiteController.loggedUser.login}" />
            <br />
            <br />

            <p:dataTable id="dataTable" var="wellsite" value="#{wellsiteController.wellsiteDataTableModel}"
                         paginator="true" rows="10" selection="#{wellsiteController.wellsite}">

                <p:column selectionMode="single" style="width:18px" id="radioSelect" />

                <p:column sortBy="#{wellsite.reference}" headerText="Wellsite ID">
                    <h:outputText value="#{wellsite.reference}" />
                </p:column>

                <p:column headerText="Allowed Groups">
                    <h:outputText value="#{wellsite.allowedGroups.toString()}" />
                </p:column>

                <f:facet name="footer">
                    <h:panelGrid columns="3">
                        <p:commandButton id="addWellsite" value="Add New Wellsite" icon="ui-icon-flag" ajax="false" action="#{wellsiteController.showAddWellsite}"/>
                        <p:commandButton id="editWellsite" value="Edit Selected Wellsite" icon="ui-icon-wrench" ajax="false" action="#{wellsiteController.showEditWellsite}"/>

                        <p:commandButton id="deleteWellsiteButton" value="Remove Selected Wellsite" icon="ui-icon-trash" onclick="confirmation.show()" type="button"/>

                    </h:panelGrid>
                </f:facet>
            </p:dataTable>
            <p:spacer height="20" />
        </p:panel>
        <p:confirmDialog id="confirmDialog" message="Are you sure you want to remove the selected Wellsite along with all it's data?" header="Confirmation" severity="alert" widgetVar="confirmation">  
            <p:commandButton id="confirm" value="Yes" ajax="false" oncomplete="confirmation.hide()" action="#{wellsiteController.deleteWellsite}" />
            <p:commandButton id="decline" value="Cancel" onclick="confirmation.hide()" type="button" />   

        </p:confirmDialog>
    </h:form> 
```

这是控制器：

```
@ManagedBean(name = "wellsiteController")
@RequestScoped
public class WellsiteController implements Serializable {
private static final long serialVersionUID = 1L;

@ManagedProperty("#{wellsiteDao}")
private WellsiteDao wellsiteDao;

@ManagedProperty("#{userDao}")
private UserDao userDao;

@ManagedProperty("#{groupDao}")
private GroupDao groupDao;

@ManagedProperty("#{userController.loggedUser}")
private UserEnt loggedUser;

private WellsiteEnt wellsite;
private List<WellsiteEnt> wellsiteList;
DualListModel<GroupEnt> pickGroupsModel;

public WellsiteController(){
}

@PostConstruct
public void build(){
    wellsite = new WellsiteEnt();
    wellsite.setAllowedGroups(new ArrayList<GroupEnt>());
}

/*some getters & setters*/

public WellsiteDataTableModel getWellsiteDataTableModel(){
    return new WellsiteDataTableModel(getWellsiteList());
}

public void setPickGroupsModel(DualListModel<GroupEnt> model){
    pickGroupsModel = model;
}

public DualListModel<GroupEnt> getPickGroupsModel() {
    if(pickGroupsModel == null){
        List<GroupEnt> allGroups = groupDao.getAll();
        List<GroupEnt> currentGroups = wellsite.getAllowedGroups();
        for(GroupEnt g : currentGroups){
            allGroups.remove(g);
        }
        pickGroupsModel = new DualListModel<GroupEnt>(allGroups, currentGroups);
    }
    return pickGroupsModel;
}

public String listWellsites(){
    getWellsiteList();
    return "listWellsites";
}

public String showAddWellsite(){
    FacesContext context = FacesContext.getCurrentInstance();
    setWellsite(new WellsiteEnt());
    wellsite.setAllowedGroups(new ArrayList<GroupEnt>());
    pickGroupsModel = null;
    context.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_INFO,
                                            "Fields annotated with a ' * ' are mandatory",""));
    return "addWellsite";
}

public String addWellsite(){
    FacesContext context = FacesContext.getCurrentInstance();

    wellsite.setDate(new Date());
    wellsite.setLastUpdate(wellsite.getDate());
    try {
        wellsiteDao.addWell(wellsite);

        for(GroupEnt g : pickGroupsModel.getTarget()){
            GroupEnt group = groupDao.getOne(g.getGroupId());
            group.getGroupWellsites().add(wellsite);
            groupDao.update(group);
        }
        return listWellsites();

    } catch (Exception ex) {
        Logger.getLogger(WellsiteController.class.getName()).log(Level.SEVERE, null, ex);
        context.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR,
                                            ex.getMessage(),""));
        return null;
    }
}
} 
```

该视图被正确渲染。数据表和按钮看起来不错。问题是当我第一次单击“addWellsite”命令按钮时，什么也没有发生。该页面似乎正在刷新。如果我再次单击它，则会发生异常：

`java.lang.NumberFormatException: For input string: "null"`

使用调试器，我发现第一次没有调用“addWellsite”的操作，因此没有生成结果（因此，页面刷新）。

异常可能是由于当前视图或目标视图中缺少初始化（因为两个视图都是从页面刷新中未调用的操作方法显示的）

问题是：**为什么第一次没有调用action方法？**

从[这个答案](https://stackoverflow.com/questions/2118656/hcommandlink-is-not-being-invoked/2120183#2120183)：

> 每当`UICommand`组件未能调用关联的操作时，请验证以下内容：
> 
> 1.  `UICommand`组件必须放置在`UIForm`组件内（例如`h:form`）。

我有啊：表格

> 2.  您不能将多个组件相互**嵌套（注意包含文件！）。**`UIForm`

只有一个。

> 3.  不应发生验证/转换错误（用于`h:messages`获取所有错误）。

我有 ah:messages 没有显示任何错误。

> 4.  如果`UICommand`组件被放置在组件内，请确保保留`UIData`完全相同（位于's属性`DataModel`后面的对象）。`UIData``value`

commandButton 在 dataTable 中，但目标视图不需要 dataModel。正如我的控制器代码所示，该对象是在视图尝试检索它时构建的。下一个请求不使用此数据表，我不再处理它。

> 5.  在应用请求值阶段不应评估组件和所有父组件的`rendered`和属性。`disabled``false`

没有`rendered`或`disbled`属性。

> 6.  确保请求-响应链中没有`PhaseListener`或有任何`EventListener`更改了 JSF 生命周期以跳过调用操作阶段。

没有定义 phaseListener。

> 7.  确保没有`Filter`或`Servlet`在同一个请求-响应链中以某种方式阻止了请求`FacesServlet`。

没有定义其他 Servlet。我什至不知道过滤器是什么。

**为什么第一次没有调用 action 方法？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T16:29:43.887

当它的父级`<h:form>`由*另一个* `<h:form>`事先发起的 ajax 请求呈现时，可能会发生这种情况。渲染/更新`<h:form>`后将失去其视图状态。这是由 JavaScript API 中的错误引起的，如[JSF 问题 790](http://java.net/jira/browse/JAVASERVERFACES_SPEC_PUBLIC-790)中所述，该错误已在即将推出的 JSF 2.2 中修复。

同时，在 JSF 2.0/2.1 中，您需要在另一种形式的动作`<h:form>`的`render`（或 PrimeFaces 的`update`）属性中明确指定客户端 ID。

例如

```
<h:commandButton ...>
   <f:ajax ... render=":listForm" />
</h:commandButton> 
```

或者

```
<p:commandButton ... update=":listForm" /> 
```

或者只是让它成为一个普通的（非ajax）请求。

### 也可以看看：

*   [JSF 2 中的通信 - 包含另一种形式的内容的 Ajax 呈现](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#AjaxRenderingOfContentWhichContainsAnotherForm)

# jqtransform - 使用 jqtransform 后，选择选项中的 scoll 被禁用

> ID：10586493
> 
> 赞同：0
> 
> 时间：2012-05-14T15:35:23.497
> 
> 标签：jqtransform

我对 Jqtransform 有疑问，当它转换选择输入时，它会禁用选项值上的滚动并使它看起来像我附加的图像中的下拉选择很长！[在此处输入图像描述][1]我需要帮助谢谢

[http://imm.io/pi0d](http://imm.io/pi0d)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T16:17:08.023

jquery.jqtransform.js

添加此代码 -> **.css('height', 120)**

行=265

好像

> var $ul = $('ul', $wrapper).css('width',$select.width()) **.css('height', 120)** .hide();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T07:23:21.670

我建议不要给它高度，而是给它一个**溢出-y：滚动**

var $ul = $('ul', $wrapper).css('width',$select.width()).css('overflow-y', 'scroll').hide();

让高度通过 CSS 而不是通过 JS...

希望这可以帮助 ：）

# c# - 动态添加的 ASP.NET 控件未存储在 ViewState 中

> ID：10586494
> 
> 赞同：0
> 
> 时间：2012-05-14T15:35:30.740
> 
> 标签：c#, events, dynamic, postback

我有一个应用程序，我需要将多个（和嵌套的）控件添加到 PlaceHolder。用户输入“周数”，我的应用程序添加了一个 RadSplitter（使用 Telerik 控件集），以及相关的窗格/网格。我使用后面的代码添加这些控件。

这在第一次绑定时工作正常（输入周数并单击提交时）。但我还需要在控件之间启用拖放功能，这会导致回发。

我的占位符中的控件数量似乎在回发时始终为“0”，所以我猜测它们没有存储在 ViewState 中。我如何确保我的控件存储在 ViewState 中，而不必在每次回发时都阅读这些内容？

这是一些示例代码：

```
 protected void btnSubmit_Click(object sender, EventArgs e)
        {
            if (plcSplitter.Controls.Count > 0)
                plcSplitter.Controls.Remove(plcSplitter.Controls[0]);
            var splitter = new Telerik.Web.UI.RadSplitter();
            splitter.Width = Unit.Percentage(100);
            int noOfWeeks = int.Parse(txtNoOfWeeks.Text);
            DateTime dt = new DateTime(2012, 05, 13);
            for (int i = 0; i < noOfWeeks; i++)
            {
                var range = new Common.DateRange(dt.AddDays(-6),dt);
                var pane = new Telerik.Web.UI.RadPane();
                Label lbl = new Label();
                lbl.ID = "lblText";
                lbl.Text = range.To.ToShortDateString();
                pane.Controls.Add(lbl);
                var gv = AddGrid(i);
                pane.Controls.Add(gv);
                splitter.Items.Add(pane);

                var splitLine = new Telerik.Web.UI.RadSplitBar();
            splitter.Items.Add(splitLine);

                dt = dt.AddDays(-7);
            }
            plcSplitter.Controls.Add(splitter);
            splitter.DataBind();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:46:32.357

控件不存储在视图状态中，只有部分控件属性*可以*存储在视图状态中。因此，在回发时，您必须再次创建这些标签。

将该逻辑从 btnSubmit_Click 创建标签移动到单独的方法，在按钮单击时调用该方法并存储在某处（可能是会话）重新创建标签所需的数据，然后在 OnInit 方法的回发中检查存储的数据，如果有一些标签创建它在那次活动中。

请务必阅读有关 viewstate 的博客文章：

[http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/Truly-Understanding-Viewstate.aspx](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/Truly-Understanding-Viewstate.aspx)

这是关于在运行时创建控件

[http://weblogs.asp.net/infinitiesloop/archive/2006/08/25/TRULY-Understanding-Dynamic-Controls-_2800_Part-1_2900_.aspx](http://weblogs.asp.net/infinitiesloop/archive/2006/08/25/TRULY-Understanding-Dynamic-Controls-_2800_Part-1_2900_.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:10:26.167

您可以将构建控件所需的数据存储在 ViewState 中，但真正重要的部分是确保在尝试访问控件之前构建控件。

这是一个超级基本的例子。

```
 protected void Page_Load(object sender, EventArgs e)
    {
        BuildControl(GetLabelData());
    }

    private Tuple<string, string> GetLabelData()
    {
        if (Page.IsPostBack)
            return (Tuple<string, string>)ViewState["MyLabelData"];
        else
            return new Tuple<string, string>("lblTest", "Test");
    }

    private void BuildControl(Tuple<string, string> t)
    {
        Label l = new Label();
        l.ID = t.Item1;
        l.Text = t.Item2;
        ViewState["MyLabelData"] = t;
        plcSplitter.Controls.Add(l);
    }

    protected void bDoSomething_Click(object sender, EventArgs e)
    {
        Response.Write(String.Format("plcSplitter.Controls.Count:{0}", plcSplitter.Controls.Count));
    } 
```

同样重要的是要认识到这些控件是在服务器上构建的，如果它们可以被客户端更改，您需要为重要的信息位实现一些通信机制，以便您可以重建您的控件，然后应用任何来自客户端的修改。

例如，您正在实现一个可拖动控件，在客户端拖动时，您需要手动将坐标存储在隐藏控件中，以便可以发布回服务器，并且在重建时可以使用该信息控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:41:41.003

我认为这些控件未存储在 ViewState 中的原因是，在生成页面 ViewState 之后，它们“为时已晚”被添加到页面中。看看这个帖子：

[页面中仍然会影响页面视图状态的最后一个事件](https://stackoverflow.com/questions/8265831/last-event-in-page-that-can-still-affect-a-pages-viewstate)

# php - 如何使用javascript从链接中弹出一个窗口

> ID：10586497
> 
> 赞同：0
> 
> 时间：2012-05-14T15:35:56.133
> 
> 标签：php, url, bookmarklet

我正在为我的网址缩短器制作一个书签。它的作用是在您单击小书签时缩短页面的当前网址，因此您不必去网站缩短网址，但我需要的是小书签返回一个弹出窗口使用下面列出的缩短网址。

到目前为止我所做的是：

`javascript:u=encodeURIComponent(location.href);s='http://n1x.co.uk/create.php?url='+u;window.open(s,'shortened','location=no,width=400,height=300');`

如果你收藏了这个，当你点击它时，你会注意到，它*确实*缩短了当前页面的 url，但它也显示了 url 缩短网页，我只需要纯文本和复制它的链接。

请帮忙！

**编辑：**对不起，我在 php 方面很糟糕，但我怎样才能制作一个参数“responseType”？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:44:01.407

弹出窗口中显示的是[http://n1x.co.uk/create.php](http://n1x.co.uk/create.php)返回的内容。您将不得不修改 php 以仅以纯文本形式返回缩短的 url。如果 php 也被缩短站点使用，您可以做的是向 create.php 传递一个参数，告诉它是像现在一样返回整个页面还是只返回纯文本 url。例如一个名为“responseType”的参数。您可以修改 create.php 以说明当 responseType = 'plainurl' 时，仅返回缩短的 url 而不是整个页面。

```
javascript:u=encodeURIComponent(location.href);s='http://n1x.co.uk/create.php?url='+u + '&responseType=plainurl';window.open(s,'shortened','location=no,width=400,height=300'); 
```

# nhibernate - Fluent NHibernate 自动映射参考键

> ID：10586498
> 
> 赞同：1
> 
> 时间：2012-05-14T15:36:04.527
> 
> 标签：nhibernate, fluent-nhibernate

我最近通过 NuGet 从 1.3.0.717 和 3.2.0.4000 版本将我的项目更新为 FNH 1.3.0.727 和 NH 3.3.0.4000。使用 automap，更新前生成的 XML 如下所示：

```
 <class xmlns="urn:nhibernate-mapping-2.2" name="APP.Domain.Module, APP.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" table="Module">
    <id name="Id" type="System.Guid, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
      <column name="ModuleId" />
      <generator class="guid.comb" />
    </id>
    <many-to-one class="APP.Domain.Product, APP.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" name="Product">
      <column name="ProductId" />
    </many-to-one>
    <joined-subclass name="APP.Domain.Audit.Trail, APP.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null">
      <key>
        <column name="TrailId" />
      </key>
      <bag cascade="all" inverse="true" lazy="true" name="Arguments">
        <key>
          <column name="TrailId" />
        </key>
        <one-to-many class="APP.Domain.Audit.Argument, APP.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
      </bag>
      <property name="Action" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <column name="Action" />
      </property>
      <property name="Date" type="System.DateTime, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <column name="Date" />
      </property>
      <property name="Workflow" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <column name="Workflow" />
      </property>
      <property name="Identity" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <column name="[Identity]" />
      </property>
    </joined-subclass>
  </class> 
```

更新后：

```
 <class xmlns="urn:nhibernate-mapping-2.2" name="APP.Domain.Module, APP.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" table="`Module`">
    <id name="Id" type="System.Guid, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
      <column name="ModuleId" />
      <generator class="guid.comb" />
    </id>
    <many-to-one class="APP.Domain.Product, APP.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" name="Product">
      <column name="ProductId" />
    </many-to-one>
    <joined-subclass name="APP.Domain.Audit.Trail, APP.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null">
      <key>
        <column name="TrailId" />
        <column name="ModuleId" />
      </key>
      <bag cascade="all" inverse="true" lazy="true" name="Arguments">
        <key>
          <column name="TrailId" />
          <column name="TrailId" />
        </key>
        <one-to-many class="APP.Domain.Audit.Argument, APP.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
      </bag>
      <property name="Name" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <column name="Name" />
      </property>
      <property name="Date" type="System.DateTime, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <column name="Date" />
      </property>
      <property name="Workflow" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <column name="Workflow" />
      </property>
      <property name="Identity" type="System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
        <column name="[Identity]" />
      </property>
    </joined-subclass>
  </class> 
```

我的模型中没有复合键，一切正常，现在我开始异常了`"Foreign key (FK4B9386BFF4D27734:Argument [TrailId])) must have same number of columns as the referenced primary key (Trail [TrailId, ModuleId])"`。

我错过了新版本的一些东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T13:38:18.050

问题在于约定和覆盖的组合。以前的版本在每种情况下都正确地覆盖了键列（foreign、joined、hasmany、manytomany 等），但现在正在添加它们。漏洞？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T16:25:12.073

使用 IReferenceConvention 代替在 ForeignKeyconvention 类中覆盖 GetKeyName 解决了该问题。

# javascript - Twitter Bootstrap datetimepicker days vertical - LESS Import？

> ID：10586499
> 
> 赞同：-3
> 
> 时间：2012-05-14T15:36:10.393
> 
> 标签：javascript, html, twitter-bootstrap, less

[https://i.stack.imgur.com/vK4OB.png](https://i.stack.imgur.com/vK4OB.png)

目前我的显示是这样的。

我有一个母版页，用于导入我的 css 和 js。

```
<link href="assets/css/datepicker.css" rel=Stylesheet />
<link href="assets/css/bootstrap-responsive.css" rel=Stylesheet />
<link href="assets/css/bootstrap.css" rel=Stylesheet />
<link href="assets/css/docs.css" rel=Stylesheet />
<link href="assets/less/bootstrap.less" type="text/css" rel="Stylesheet/less" /> 
```

在头部和 javascript 中：

```
<script src="assets/js/less-1.3.0.min.js" type="text/jscript"></script>
<script src="assets/js/jquery.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-transition.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-alert.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-modal.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-dropdown.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-scrollspy.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-tab.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-tooltip.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-popover.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-button.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-collapse.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-carousel.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-datepicker.js" type="text/jscript"></script>
<script src="assets/js/bootstrap-typeahead.js" type="text/jscript"></script>
<script>
  $('#datepicker').datepicker();
</script> 
```

控制：

```
<div class="input-append date" id="datepicker" data-date="12-02-2012"
data-date-format="dd-mm-yyyy">
<input size="16" type="text" value="12-02-2012" readonly>
<span class="add-on"><i class="icon-th"></i></span> </div> 
```

想让日子像他们应该的那样水平，不知道我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:27:16.387

我认为这就是你需要的**[DEMO](https://jsfiddle.net/MDUZq/)**

**HTML：**

```
<div class="input-append date" id="dp3" data-date="12-02-2012" data-date-format="dd-mm-yyyy">
  <input class="span2" size="16" type="text" value="12-02-2012">
  <span class="add-on"><i class="icon-th"></i></span>
</div>​ 
```

**脚本：**

```
$('#dp3').datepicker();
var startDate = new Date(2012,1,20);
var endDate = new Date(2012,1,25);​ 
```

# java - 如何在 Java 中定义一个接口方法来接受一个类或其任何子类？

> ID：10586505
> 
> 赞同：0
> 
> 时间：2012-05-14T15:36:32.733
> 
> 标签：java, interface

假设我有一个名为 Animal 的类和一个名为 AnimalTrainer 的接口。

```
public interface AnimalTrainer
 {
    void trainAnimal(Animal animal);
 } 
```

现在，当我想编写一个只训练 Lion 的实现时，问题就出现了，例如，Lion 扩展了 Animal。

```
public class LionTrainer implements AnimalTrainer
 {
    public void trainAnimal(Lion lion)
      {
         // code 
      }
 } 
```

但这不起作用。如何在 AnimalTrainer 中定义 trainAnimal 方法，以使上述 LionTrainer 实现成为可能？还是我必须更改 LionTrainer 的实施？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:39:27.527

你需要输入 AnimalTrainer

```
public interface AnimalTrainer<T extends Animal>
 {
    public void trainAnimal(T animal);
 }

public class LionTrainer implements AnimalTrainer<Lion>
 {
    public void trainAnimal(Lion lion);
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:39:29.600

使用泛型：

```
public interface AnimalTrainer<T extends Animal> {
   void trainAnimal(T animal);
}
class LionTrainer implements AnimalTrainer<Lion> {
   public void trainAnimal(Lion lion) {...}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T15:40:24.970

您应该使用泛型类型...

```
public interface AnimalTrainer<T extends Animal>
 {
    public void trainAnimal(T animal);
 } 
```

然后`LionTrainer implements AnimalTrainer<Lion>`...

# robots.txt - 阻止 robots.txt 中具有 [可能] 多个文件扩展名的文件

> ID：10586508
> 
> 赞同：0
> 
> 时间：2012-05-14T15:36:35.540
> 
> 标签：robots.txt

这是正确的语法吗？

```
 Disallow: /file_name.* 
```

如果没有，有没有办法在不列出每个文件两次[多次]的情况下完成此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T17:10:49.050

好的，根据[http://tool.motoricerca.info/robots-checker.phtml](http://tool.motoricerca.info/robots-checker.phtml)

> 此代码块寻址的（所有）用户代理不支持文件名中的“*”通配符。您应该在专门针对支持通配符的蜘蛛（例如 Googlebot）的代码块中使用通配符“*”。

所以，我只是使用：

```
 <meta name="robots" content="noindex,nofollow"> 
```

在我想阻止搜索引擎的每个页面中。

# c - 在子进程中操作来自父亲的 var

> ID：10586511
> 
> 赞同：2
> 
> 时间：2012-05-14T15:36:48.770
> 
> 标签：c, process

有人可以解释为什么以下程序的输出是 1 而不是 2？

```
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <sys/wait.h>

int main(int argc, char *argv[])
{
int x = 1;
int *y = &x; 

pid_t pid = fork();

if (pid == 0) {
    *y = 2;
    exit(0);
} else {
    wait(NULL);
    printf("father: %d\n", x); 
}   

return 1;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:40:32.907

`fork`不会创建线程，它会创建一个全新的进程。

孩子的地址空间是父母地址空间的副本，他们不共享它。

父母所做的修改对孩子来说是不可见的，反之亦然，除非专门设置了一些东西（例如通过共享内存段）。

# java - 在独立应用程序的休眠中配置 sessionFactory

> ID：10586512
> 
> 赞同：1
> 
> 时间：2012-05-14T15:36:53.907
> 
> 标签：java, hibernate, sax, saxparseexception

我正在尝试制作一个第 3 方简单的独立/摇摆应用程序，该应用程序使用休眠连接数据库以用于另一个应用程序，所以这就是我所做的：

**1- 使用的罐子：**

```
hibernate-core-3.5.1-Final
hibernate-entitymanager-3.5.1-Final
hibernate-jpa-2.0-api-1.0.0.Final
hibernate-annotations-3.5.1-Final
hibernate-commons-annotations-3.2.0.Final
dom4j-1.6.1
slf4j-api-1.6.4
slf4j-log4j12-1.6.4
log4j-1.2.16.jar
commons-collections-3.2
jta-1.1
mysql-connector-java-5.1.14 (or compatible connector with your DB)
commons-logging-1.1.1
commons-collections-3.2 
```

**2- hibernate.cfg.xml （它在 src 文件夹内）：**

```
<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
"-//Hibernate/Hibernate Configuration DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
   <session-factory>

            <property name="show_sql">true</property>
            <property name="format_sql">true</property>
            <property name="connection.driver_class">com.mysql.jdbc.Driver</property>
            <property name="connection.url">jdbc:mysql://127.0.0.1:3306/myapp</property>
            <property name="connection.username">myuser</property>
            <property name="connection.password">mypass</property>
            <property name="dialect">org.hibernate.dialect.MySQLDialect</property>
            <property name="current_session_context_class">thread</property>

   </session-factory>
</hibernate-configuration> 
```

**3- SessionFactoryHelper：**

```
public class SessionFactoryHelper {

    private static final SessionFactory sessionFactory;

    static {
        try {
            /*
             * Build a SessionFactory object from session-factory configuration
             * defined in the hibernate.cfg.xml file. In this file we register
             * the JDBC connection information, connection pool, the hibernate
             * dialect that we used and the mapping to our hbm.xml file for each
             * POJO (Plain Old Java Object).
             */
            sessionFactory = new Configuration().configure()
                    .buildSessionFactory();
        } catch (Throwable e) {
            System.err.println("Error in creating SessionFactory object."
                    + e.getMessage());
            throw new ExceptionInInitializerError(e);
        }
    }

    /*
     * A static method for other application to get SessionFactory object
     * initialized in this helper class.
     */
    public static SessionFactory getSessionFactory() {
        return sessionFactory;
    }
} 
```

**4-示例查询：**

```
Session session = SessionFactoryHelper.getSessionFactory()
            .getCurrentSession();
    session.beginTransaction();
    int count = (Integer) session.createSQLQuery(
            "select count(*) from users").uniqueResult();
    session.getTransaction().commit();
    System.out.println("Users Count: " + count); 
```

运行应用程序时，我得到以下异常：

```
Error in creating SessionFactory object.invalid configuration
Exception in thread "main" java.lang.ExceptionInInitializerError
    at com.xeno.xecamp.desktopManagement.SessionFactoryHelper.<clinit>(SessionFactoryHelper.java:24)
    at com.myapp.Main.main(Main.java:9)
Caused by: org.hibernate.MappingException: invalid configuration
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:1579)
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1520)
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1506)
    at com.xeno.xecamp.desktopManagement.SessionFactoryHelper.<clinit>(SessionFactoryHelper.java:19)
    ... 1 more
Caused by: org.xml.sax.SAXParseException: Document is invalid: no grammar found.
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:195)
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(ErrorHandlerWrapper.java:131)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:384)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:318)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanStartElement(XMLNSDocumentScannerImpl.java:250)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl$NSContentDriver.scanRootElementHook(XMLNSDocumentScannerImpl.java:626)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:3103)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(XMLDocumentScannerImpl.java:922)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:648)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:140)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)
    at org.dom4j.io.SAXReader.read(SAXReader.java:465)
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:1576)
    ... 4 more 
```

谁能告诉我我的配置有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:52:49.030

这个问题根本与 Hibernate 无关，而是与 XML 结构有关。

SAX Reader 由 Hibernate 设置为使用验证[(org.hibernate.util.XMLHelper#createSAXReader(String,List,EntityResolver)](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/util/XMLHelper.html#createSAXReader%28java.lang.String,%20java.util.List,%20org.xml.sax.EntityResolver%29)

它不像这样：

```
SAXParserFactory factory = SAXParserFactory.newInstance();
    factory.setValidating(true);
    factory.setNamespaceAware(true); 
```

Java dosc 说

方法 setValidating(boolean) - 请求 DTD 验证并在不存在 DTD 时导致失败。如果您只需要模式验证而不需要 DTD 验证，请使用 setValidating(false)。

你的错误说得很清楚：

`Caused by: org.xml.sax.SAXParseException: Document is invalid: no grammar found.`

[在本教程中，您将找到有关 hibernate conf 文件的所有必需信息。](http://docs.jboss.org/hibernate/core/3.5/reference/en/html/session-configuration.html)

要修复它，您需要添加：

```
<!DOCTYPE hibernate-configuration PUBLIC
"-//Hibernate/Hibernate Configuration DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:44:41.377

您没有在 hibernate.cfg.xml 中声明任何 DTD

> ```
> The message is saying that you are trying to validate the document, but no DTD has been declared, because no DOCTYPE declaration is present. 
> ```

# android - 安卓应用磁盘使用情况

> ID：10586513
> 
> 赞同：0
> 
> 时间：2012-05-14T15:36:57.760
> 
> 标签：android

是否有 API 可以通过包名称获取 android 应用程序的磁盘使用情况？我认为磁盘使用量是 /data/data/ 文件夹中的数据大小。API 可能如下所示：

`int getDiskUsage(String packageName)`

有人可以帮忙吗，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:30:24.327

查看 PackageStats 类（例如，[此处](http://developer.android.com/reference/android/content/pm/PackageStats.html)）。

# sql - 左连接查询的奇怪行为

> ID：10586516
> 
> 赞同：-3
> 
> 时间：2012-05-14T15:37:12.287
> 
> 标签：sql, sql-server, tsql

我有一个类似的查询：

```
SELECT *
FROM TableA a
LEFT JOIN TABLEB b
ON a.ColA = b.ColA
WHERE b.Col1 IS NULL 
OR (b.Col1 = A AND b.Col2 = B AND b.Col3 BETWEEN @StartDate AND @EndDate) 
```

我得到一个奇怪的结果集，因为我希望从 TableA 返回每一行，但查询的日期部分搞砸了结果集，只返回 3 行。我知道这一点，因为当我删除日期时间过滤器并保留其他两个过滤器时，我会得到正确的结果。

真的很难过这似乎是“意外行为”，我无法从逻辑上解释为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:44:46.310

尽管您的语法错误....

您应该执行右连接，因为 where 子句中的所有逻辑都在表 B 上。

```
SELECT * 
FROM TABLEB b 
RIGHT JOIN TABLEA a on a.SomeId = b.SomeId
WHERE b.Col1 IS NULL  OR (b.Col1 = A AND b.Col2 = B AND b.Col3 BETWEEN @StartDate AND @EndDate) 
```

但是，这可能是您真正想要的...

```
SELECT *  
FROM TableA a  
LEFT JOIN TABLEB b on b.SomeId = a.SomeId and b.Col1 = A AND b.Col2 = B AND b.Col3 BETWEEN @StartDate AND @EndDate  
WHERE b.Col1 IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:24:19.557

我修复了这个问题，我只是将它们更改为派生表，因此所有谓词都在连接之前应用。

感谢大家的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:48:00.510

您的 SQL 最好以这种方式编写：

```
SELECT *
FROM TableA a
LEFT JOIN TABLEB b ON a.col1 = b.col2
WHERE (b.col3 IS NULL) or (b.Col3 BETWEEN @StartDate AND @EndDate) 
```

`b.Col1 = A AND b.Col2 = B`应该在 LEFT JOIN 部分，因为这是左连接语句的正确语法。

所以上面的 SQL 现在可以翻译成：从 tableA 和 tableB 中选择每一行，其中 tableA 中的 col1 等于 tableB 中的 col2，通过 tableB 中的 col3 过滤结果，它为 null 或通过 tableB 中的 col3 过滤结果，它的值介于@StartDate 和@EndDate。

希望能帮助到你。

此致。

# java - Android JSON未终止的字符串在字符

> ID：10586523
> 
> 赞同：2
> 
> 时间：2012-05-14T15:37:31.330
> 
> 标签：java, android, json

我从 WCF 服务获取 JSON 字符串，但有时会遇到问题，有时它工作正常。这很奇怪，因为返回的结果应该完全相同，但有时它工作正常，有时我需要在我的应用程序中刷新几次，它工作正常。所以我不确定我的 JSON 字符串中的某些内容是否不稳定，或者是否有人有任何想法。这是正在返回的 JSON 字符串

```
[{"AssmtStatus":1,"AssmtStatusText":null,"CreatedBy":"","IntervalDescr":null,"Status":0,"WoundLocation":null,"dtAssmtDate":"1\/1\/1900","dtLastCompleted":"3\/30\/2012 3:19:00 PM","iAssessmentID":1,"iAssessmentType":2,"sAssmtName":"Weekly Skin"},{"AssmtStatus":1,"AssmtStatusText":null,"CreatedBy":"","IntervalDescr":null,"Status":0,"WoundLocation":null,"dtAssmtDate":"1\/1\/1900","dtLastCompleted":"1\/1\/1900","iAssessmentID":1,"iAssessmentType":4,"sAssmtName":"Admission Skin"},{"AssmtStatus":1,"AssmtStatusText":null,"CreatedBy":"","IntervalDescr":null,"Status":0,"WoundLocation":null,"dtAssmtDate":"1\/1\/1900","dtLastCompleted":"1\/1\/1900","iAssessmentID":1,"iAssessmentType":5,"sAssmtName":"PHQ - 9 - Resident"},{"AssmtStatus":1,"AssmtStatusText":null,"CreatedBy":"","IntervalDescr":null,"Status":0,"WoundLocation":null,"dtAssmtDate":"1\/1\/1900","dtLastCompleted":"1\/1\/1900","iAssessmentID":1,"iAssessmentType":6,"sAssmtName":"PHQ - 9 - Staff"},{"AssmtStatus":1,"AssmtStatusText":null,"CreatedBy":"","IntervalDescr":null,"Status":0,"WoundLocation":null,"dtAssmtDate":"1\/1\/1900","dtLastCompleted":"1\/1\/1900","iAssessmentID":1,"iAssessmentType":7,"sAssmtName":"Brief Interview for Metal Status (BIMS)"},{"AssmtStatus":1,"AssmtStatusText":null,"CreatedBy":"","IntervalDescr":null,"Status":0,"WoundLocation":null,"dtAssmtDate":"1\/1\/1900","dtLastCompleted":"1\/1\/1900","iAssessmentID":1,"iAssessmentType":8,"sAssmtName":"Staff Assessment for Mental Status"},{"AssmtStatus":1,"AssmtStatusText":null,"CreatedBy":"","IntervalDescr":null,"Status":0,"WoundLocation":null,"dtAssmtDate":"1\/1\/1900","dtLastCompleted":"1\/1\/1900","iAssessmentID":1,"iAssessmentType":1001,"sAssmtName":"Open Note"},{"AssmtStatus":1,"AssmtStatusText":null,"CreatedBy":"","IntervalDescr":null,"Status":0,"WoundLocation":null,"dtAssmtDate":"1\/1\/1900","dtLastCompleted":"1\/1\/1900","iAssessmentID":1,"iAssessmentType":1002,"sAssmtName":"Labs Test"},{"AssmtStatus":1,"AssmtStatusText":null,"CreatedBy":"","IntervalDescr":null,"Status":0,"WoundLocation":null,"dtAssmtDate":"1\/1\/1900","dtLastCompleted":"1\/1\/1900","iAssessmentID":1,"iAssessmentType":1003,"sAssmtName":"Smoking Assessment"},{"AssmtStatus":1,"AssmtStatusText":null,"CreatedBy":"","IntervalDescr":null,"Status":0,"WoundLocation":null,"dtAssmtDate":"1\/1\/1900","dtLastCompleted":"5\/7\/2012 9:15:00 AM","iAssessmentID":1,"iAssessmentType":1004,"sAssmtName":"Inquiry Assessment"}] 
```

如果有人有任何想法，我得到的错误是“字符 2431 处的未终止字符串”，我将非常感谢您的帮助。谢谢

编辑：这是我用来获取 JSON 的整个类。

```
private class GetAssmts extends AsyncTask<String,Void,Void>{
     private ProgressDialog Dialog = new ProgressDialog(AssmtSelectionUnScheduled.this);

     protected void onPreExecute(){
         Dialog.setMessage("Loading..");
         Dialog.show();
     }

    @Override
    protected Void doInBackground(String... params) {
        try {
            HttpGet request = new HttpGet(SERVICE_URL + "/GetAssmtsUnScheduled/" + FacID + "/" + ResID + "/" + UserID);
            request.setHeader("Accept", "application/json");
            request.setHeader("Content-type", "application/json");

            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpResponse response = httpClient.execute(request);

            HttpEntity responseEntity = response.getEntity();

            // Read response data into buffer
            char[] buffer = new char[(int)responseEntity.getContentLength()];
            InputStream stream = responseEntity.getContent();
            InputStreamReader reader = new InputStreamReader(stream);
            reader.read(buffer);
            stream.close();

            JSONArray plates = new JSONArray(new String(buffer));
            MyAssmts.clear();
            for (int i = 0; i < plates.length(); ++i) {
                JSONObject jo = (JSONObject) plates.get(i);
                Assmt myassmt = new Assmt(Integer.parseInt(jo.getString("iAssessmentType")),Integer.parseInt(jo.getString("iAssessmentID")),jo.getString("sAssmtName"),jo.getString("dtLastCompleted"),
                        Integer.parseInt(jo.getString("Status")),jo.getString("WoundLocation"),jo.getString("IntervalDescr"),jo.getString("CreatedBy"),Integer.parseInt(jo.getString("AssmtStatus")),
                        jo.getString("AssmtStatusText"),jo.getString("dtAssmtDate"));
                MyAssmts.add(myassmt);
            }  
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e){
            e.printStackTrace();
        } catch (Exception e){
            e.printStackTrace();
        }
        return null;
    }

    protected void onPostExecute(Void unused){
        Dialog.dismiss();
            final GridView lv = (GridView) AssmtSelectionUnScheduled.this.findViewById(R.id.gridView_AssmtList);
            lv.setAdapter(new MyAdapter(AssmtSelectionUnScheduled.this, MyAssmts));
            lv.setOnItemClickListener(new OnItemClickListener() {
                public void onItemClick(AdapterView<?> arg0, View arg1,int arg2, long arg3) {
                    Assmt sel = (Assmt) (lv.getItemAtPosition(arg2));   
                    boolean isNewAssmt = true;
                    if(sel.getsCreatedBy().length() > 0 && sel.getsCreatedBy().toUpperCase().equals(UserID.toUpperCase())){
                        isNewAssmt = false;
                    }
                    launchAssmt(sel.getiAssessmentType(), sel.getiAssessmentID(), isNewAssmt, sel.getsAssmtDate());
                }
            });
        }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T15:49:01.520

我有同样的错误，但发现`reader.read(buffer)`没有阅读所有内容。你可以做一个循环，直到你拥有一切，就像这样：

```
int contentLength = (int) responseEntity.getContentLength();
char[] buffer = new char[contentLength];
InputStream stream = responseEntity.getContent();
InputStreamReader reader = new InputStreamReader(stream);

int hasRead = 0;
while (hasRead < contentLength)
    hasRead += reader.read(buffer, hasRead, contentLength-hasRead);

stream.close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T17:24:12.753

我的猜测`responseEntity.getContentLength()`是没有返回正确的值，所以你的字符缓冲区最终太小了。

# php - 在干草堆中查找所有针的位置

> ID：10586524
> 
> 赞同：2
> 
> 时间：2012-05-14T15:37:32.627
> 
> 标签：php, strpos

我试图在大海捞针中找到所有针的位置：

```
$haystack = 'one twoo two one postpone twool';
$needles = array('one', 'two', 'three');
foreach ($needles as $needle) { 
  if (stristr($haystack, $needle)) { // list position of all needles
    $pos[strpos($haystack, $needle)] = $needle;
  }
}
print_r($pos); 
```

的值在`$pos`这里：

```
Array ( [0] => one [4] => two ) 
```

然而，预期是：

```
Array ( [0] => one [9] => two [13] => one) 
```

所以有两件事出错了：

*   `twoo`被标记为发生`two`
*   循环显然与第二次出现不匹配`one`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:47:51.997

如果你想要一个简单的方法，你可以使用`preg_match`：

```
foreach ($needles as $needle) {
    if( preg_match_all( '/\b' . $needle . '\b/', $haystack, $matches, PREG_OFFSET_CAPTURE ) ) {
        foreach( $matches[0] as $match )
            $pos[$match[1]] = $needle;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:44:19.790

根据 Rawkode 的建议：

```
function strpos_recursive($haystack, $needle, $offset = 0, &$results = array()) {                
    $offset = strpos($haystack, $needle, $offset);
    if($offset === false) {
        return $results;            
    } else {
        if(substr ($haystack, $offset + strlen ($needle), 1) == ' ' || ( $offset + strlen ($needle) ) == strlen ($haystack)) {  
            if(substr ($haystack, $offset - 1, 1) == ' ' || $offset == 0) {
                $results[$offset] = $needle;
            }
        }
        return strpos_recursive($haystack, $needle, ($offset + 1), $results);
    }
}

$haystack = 'one twoo two one postpone twool one three';
$needles = array('one', 'two', 'three');
$pos = array ();

foreach ($needles as $needle) { 
    if (stristr($haystack, $needle)) {
        $pos += strpos_recursive($haystack, $needle);
    }
}
ksort($pos);
print_r($pos); 
```

我还添加了一个检查以确保下一个字符是空格或者它已经是大海捞针的尽头，所以它不会匹配`twoo`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:10:57.670

你应该使用正则表达式。尝试这个：

```
$haystack = 'one twoo two one postpone twool';
$needles = array('one', 'two', 'three');

foreach($needles as $needle) 
{
    $regex = "/\b$needle\b/";

    if (preg_match_all($regex, $haystack, $matches, PREG_OFFSET_CAPTURE))
    {
        if (is_array($matches[0]))
        {
            foreach($matches[0] as $match)
            {
                $pos[$match[1]] = $match[0];
            }
        }

    }
}

print_r($pos); 
```

输出是：

```
Array
(
    [0] => one
    [13] => one
    [9] => two
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:45:11.780

第一点：使用 stristr 每个子字符串都被接受为解决方案，所以我建议使用正则表达式（参见 preg_match_all）。

第二点：对于数组的每个元素，从大海捞针的开头开始搜索字符串，并且只取第一个匹配项。再次使用 preg_match_all！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T15:41:56.617

您需要添加最后找到的位置的偏移量才能找到未来的事件。

有人已经在文档评论 [http://www.php.net/manual/en/function.strpos.php#107678上提供了这样的解决方案](http://www.php.net/manual/en/function.strpos.php#107678)

# java - 球衣中的文件上传错误

> ID：10586525
> 
> 赞同：1
> 
> 时间：2012-05-14T15:37:35.267
> 
> 标签：java, jakarta-ee, jersey

我正在创建一个用于使用球衣上传文件的 API。

```
 @Path("/api")
 public class GreetingService {

     @POST
             @Path("/upload")
      @Consumes("multipart/form-data")
     //@Produces("text/plain")
     public String uploadFile(@FormParam("file") File file, @FormParam("file")    FormDataContentDisposition fcdsFile) {
      String fileLocation = "/files/" + fcdsFile.getFileName();
      //File destFile = new File(fileLocation);  

      return "1"; 
```

} }

当我做 curl -v -X POST --form file=@rt.txt url 我得到

```
 SEVERE: Servlet.service() for servlet ServletAdaptor threw exception
     java.lang.NullPointerException for this line    String fileLocation = "/files/" + fcdsFile.getFileName(); 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T18:39:13.933

这就是你应该打电话的方式

```
@POST
@Path("/upload")
@Consumes(MediaType.MULTIPART_FORM_DATA) // same as "multipart/form-data"
//@Produces("text/plain")
public String uploadFile(
    @FormDataParam("file") InputStream file,
    @FormDataParam("file") FormDataContentDisposition fileDetail
){
    doSomething();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:45:11.677

我认为您应该将第二个注释从表单参数更改为

```
@FormDataParam("file") FormDataContentDisposition fcdsFile 
```

# .net - .NET Image.Save 方法在 Windows 64 位上产生不可重现的结果

> ID：10586538
> 
> 赞同：9
> 
> 时间：2012-05-14T15:38:19.270
> 
> 标签：.net, image, system.drawing

我正在使用 .NET 框架（尝试 3.5 和 4.0）来加载 .TIFF 文件并将其保存为 .PNG。我希望对 Save() 方法的两个后续调用（使用相同的 TIFF 文件）生成相同的 PNG 文件。但是，生成的文件“有时”是不同的。

下面的 C# 代码显示了问题：

```
Image sourceToConvert = Bitmap.FromFile("c:\\tmp\\F1.tif");
sourceToConvert.Save("c:\\tmp\\F1_gen.png", ImageFormat.Png);           

for (int i = 0; i < 100; i++)
{
    sourceToConvert = Bitmap.FromFile("c:\\tmp\\F1.tif");
    sourceToConvert.Save("c:\\tmp\\F1_regen.png", ImageFormat.Png);

    if (!CompareFileBytes("c:\\tmp\\F1_gen.png", "c:\\tmp\\F1_regen.png"))
        MessageBox.Show("Diff" + i);                
} 
```

这将在 Windows 64 上的第 8、32、33、73 114、155、196 次迭代中显示“Diff”，而在 32 位机器上不显示任何错误。（我使用 x86 目标；使用 x64 目标更糟糕：迭代 12、13、14、15 时的差异，...）

有没有办法从 Save() 获得可重现的结果？

可以在此[FTP 站点上找到示例图像](ftp://ftp1.cstb.fr/ftp_sop/software/tmp/stackoverflow/F1.tif)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:32:42.810

我无法解释为什么会发生这种情况，但似乎`Image`终结器线程上对象的非确定性终结正在影响主线程上的图像编码。（`Image`implements `IDisposable`，所以你应该`Dispose`在用完它时调用它来确定性地清理它；否则，它将在未来的任意时间完成。）

如果我将您的示例代码更改为以下内容，则每次调用都会得到相同的结果`Save`：

```
using (Image sourceToConvert = Bitmap.FromFile("c:\\tmp\\F1.tif"))
    sourceToConvert.Save("c:\\tmp\\F1_gen.png", ImageFormat.Png);           

for (int i = 0; i < 100; i++)
{
    using (Image sourceToConvert = Bitmap.FromFile("c:\\tmp\\F1.tif"))
        sourceToConvert.Save("c:\\tmp\\F1_regen.png", ImageFormat.Png);

    // files are the same
} 
```

Note that I did find one further oddity: when running a 32-bit (x86) build on Windows 7 SP1 x64, the first *two* calls to `Save` returned different results, then every subsequent call to `Save` produced the same output as the second call. In order to make the test pass, I had to repeat the first two lines (before the loop) to force two saves before performing the equality checks.

# c# - OpenSkeletonFrame 上的 NullReferenceException

> ID：10586540
> 
> 赞同：1
> 
> 时间：2012-05-14T15:38:35.030
> 
> 标签：c#, kinect

你好，我`NullReferenceException`在运行这个时得到一个：

```
void newSensor_AllFramesReady(object sender, AllFramesReadyEventArgs e)
    {
        Skeleton first = GetFirstSkeleton(e);
        if (first == null)
        {
            return;
        }
        /**
         * @TODO
         * obsluzyc wyjatek null reference na wypadek gdy gubi szkielet
         */ 
        long timestamp = e.OpenSkeletonFrame().Timestamp; 
```

它在`long timestamp`

如果相同的动作，它会在 10-15 秒内发生。例如，我正在记录一些静止的数据。我将它们记录在每一帧中。几秒钟后，我得到了`NullReferenceException`.

问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:53:33.550

好的，所以我找到了我的问题的答案。这很简单。

当我的系统/机器超载或由于任何其他原因而减速时，帧的分析速度不如他们想象的那么快。当这种滞后发生时，我无法打开框架。这就是为什么我得到空值。

问题的波纹管解决方案

```
bool haveSkeletonData = false;
using (SkeletonFrame skeletonFrame = e.OpenSkeletonFrame())
{
if (skeletonFrame != null)
{
    if ((this.skeletonData == null) || (this.skeletonData.Length != skeletonFrame.SkeletonArrayLength))
    {
        this.skeletonData = new Skeleton[skeletonFrame.SkeletonArrayLength];
    }
    skeletonFrame.CopySkeletonDataTo(skeletonData);
    haveSkeletonData = true;
}
else
{
    haveSkeletonData = false;
}
}

if (haveSkeletonData)
{
   // here i can put code that is using my timestamp 
} 
```

这样我就可以避免 null 并且我可以根据需要使用我的时间戳:)

# maven - 在多模块maven项目中，如果没有为每个子模块定义插件，如何防止错误？

> ID：10586543
> 
> 赞同：2
> 
> 时间：2012-05-14T15:38:44.430
> 
> 标签：maven, maven-plugin

我有一个多模块 maven 项目，我需要通过 mvn clean install liferay:liferay 启动它

由于某些子模块内部没有liferay插件，因此出现此错误：[错误]在当前项目和插件组[org.apache.maven.plugins，org.codehaus中找不到前缀“liferay”的插件.mojo] 可从存储库 [local (C:\Users\xxxxxxx.m2\repository), central (http://repo.maven.apache.org/maven2)] -> [Help 1] 获得

如何让 Maven 仅在支持它的模块上调用 liferay:liferay？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T18:28:10.733

比你不应该从你的多模块构建的根目录调用生命周期。您可以像这样从根目录调用它。

```
mvn -pl ModuleWhichContainsConfigForLifeRay liferay:liferay 
```

但这只有在您之前执行过 mvn install 时才能正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T19:14:32.687

您可以`profile`在 pom 中为 Liferay 模块创建一个，如下所示：

```
 <profiles>
      <profile>
        <id>liferay-modules</id>
        <modules>
            <module>MyPortlet</module>
                <module>MyHook</module>
        </modules>
      </profile>
  </profiles> 
```

要仅为此模块运行 liferay 插件，请开始：

```
 #/> mvn clean package liferay:deploy -P liferay-modules 
```

# macos - 重定向到 shell(bash) 中的管道(fifo)，可以被 trap:Interrupted system call 中断。奇怪，但为什么呢？

> ID：10586545
> 
> 赞同：0
> 
> 时间：2012-05-14T15:38:47.087
> 
> 标签：macos, bash, shell, unix

我的shell脚本如下：

```
waiter()
{
    wait
    echo wait exit with $?
}

trap waiter SIGCHLD
rm -f fifo
mkfifo fifo
set -m

sleep 5&
read dummy < fifo 
```

但是，它被信号陷阱动作打断了。

```
bogon:xunlei ly$ waiter()
> {
>     wait
>     echo wait exit with $?
> }
bogon:xunlei ly$ 
bogon:xunlei ly$ 
bogon:xunlei ly$ trap waiter SIGCHLD
bogon:xunlei ly$ rm -f fifo
wait exit with 0
bogon:xunlei ly$ mkfifo fifo
wait exit with 0
bogon:xunlei ly$ set -m
bogon:xunlei ly$ 
bogon:xunlei ly$ sleep 5&
[1] 1089
bogon:xunlei ly$ read dummy < fifo
wait exit with 0
-bash: fifo: Interrupted system call 
```

据我所知，从 FIFO 读取时，系统调用：'read' 可以从中断自动重启。我什至编写代码来验证它：

```
set -x
cat <<-EOC  > $$.r.c
#include <fcntl.h>
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <errno.h>

int main(void)
{
    int fd = open("fifo", O_RDONLY);
    if (fd < 0 ){
        fprintf(stderr, "open");
        exit(1);
     }
    char buf [1024] = {0};
    int n = read(fd, buf, 1024);
    if(n < 0){
        fprintf(stderr, "read:%s",strerror(errno));
        exit(1);
     }
     write(1,buf,n);
     return 0;

}
EOC

cc -o  $$.r $$.r.c
rm -f $$.r.c

waiter()
{
    wait
    echo wait exit with $?
}

trap waiter SIGCHLD
rm -f fifo
mkfifo fifo
set -m

sleep 5&
read dummy < fifo

sleep 5&
./$$.r

trap '' SIGCHLD 
```

第二个 c 程序的读取系统调用句柄并重新启动信号中断。我的环境是：OS X 10.7, bash:3.2.48(1)-release。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T09:20:43.753

如果中断，Unix/Linux 系统调用**不会自动重新启动。**例如，如果您查看[read(2)](http://linux.die.net/man/2/read)手册页，您将看到

> 如果[读取的字节数]小于请求的字节数，则不是错误；这可能会发生，例如因为现在实际可用的字节较少（可能是因为我们接近文件结尾，或者因为我们正在从管道或终端读取），或者因为 read() 被中断信号。

如果根本没有读取任何字节，则返回 -1 而不是 0，并将 errno 设置为 EINTR。

# active-directory - Active Directory LDAP 中的错误 533

> ID：10586546
> 
> 赞同：5
> 
> 时间：2012-05-14T15:38:50.617
> 
> 标签：active-directory

我正在尝试配置 Active Directory (AD LDS) 以用于我的应用程序。我在 Weblogic 应用服务器中使用 ForeignJNDIProvider 来配置 AD 的设置。从我的基于 Java 的应用程序中，我对 InitialContext 进行了查找，如下所示：

```
InitialContext iCtx = new InitialContext();
DirContext dir = (DirContext) iCtx.lookup(<JNDI name>); 
```

上面的第二个代码行失败并出现以下错误：

```
javax.naming.AuthenticationException: [LDAP: error code 49 - 8009030C: LdapErr: DSID-0C0903A9, comment: AcceptSecurityContext error, data 533, v1db1 ]
at com.sun.jndi.ldap.LdapCtx.mapErrorCode(LdapCtx.java:3067)
at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:3013)
at com.sun.jndi.ldap.LdapCtx.processReturnCode(LdapCtx.java:2815)
at com.sun.jndi.ldap.LdapCtx.connect(LdapCtx.java:2729)
at com.sun.jndi.ldap.LdapCtx.<init>(LdapCtx.java:296)
at com.sun.jndi.ldap.LdapCtxFactory.getUsingURL(LdapCtxFactory.java:175)
at com.sun.jndi.ldap.LdapCtxFactory.getUsingURLs(LdapCtxFactory.java:193)
at com.sun.jndi.ldap.LdapCtxFactory.getLdapCtxInstance(LdapCtxFactory.java:136)
at com.sun.jndi.ldap.LdapCtxFactory.getInitialContext(LdapCtxFactory.java:66)
at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:667)
at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:288)
at javax.naming.InitialContext.init(InitialContext.java:223)
at javax.naming.InitialContext.<init>(InitialContext.java:197)
at weblogic.jndi.internal.ForeignOpaqueReference.getReferent(ForeignOpaqueReference.java:70)
at weblogic.jndi.internal.WLNamingManager.getObjectInstance(WLNamingManager.java:96)
at weblogic.jndi.internal.ServerNamingNode.resolveObject(ServerNamingNode.java:377)
at weblogic.jndi.internal.BasicNamingNode.resolveObject(BasicNamingNode.java:856)
at weblogic.jndi.internal.BasicNamingNode.lookup(BasicNamingNode.java:209)
at weblogic.jndi.internal.WLEventContextImpl.lookup(WLEventContextImpl.java:254)
at weblogic.jndi.internal.WLContextImpl.lookup(WLContextImpl.java:411)
at javax.naming.InitialContext.lookup(InitialContext.java:392) 
```

我尝试查找 AD 中的错误 533 是什么意思。我得到的唯一答案是它的意思是“帐户已禁用”。我不确定情况是否如此。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T09:05:21.377

明白了...通过将属性 msDS-UserAccountDisabled 的值更改为 false 来解决问题。默认情况下，创建时禁用 AD 帐户。资源：[http ://technet.microsoft.com/en-us/library/cc725934](http://technet.microsoft.com/en-us/library/cc725934)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-23T07:14:31.347

对我来说，错误出在属性“userAccountControl”中。我不得不将它从 546 (ACCOUNTDISABLE | PASSWD_NOTREQD | NORMAL_ACCOUNT) 更改为 512 (NORMAL_ACCOUNT)。另请参阅：http: [//support.microsoft.com/kb/305144/de](http://support.microsoft.com/kb/305144/de)

# apache - cgi-bin 目录中的基础设施标准

> ID：10586547
> 
> 赞同：2
> 
> 时间：2012-05-14T15:38:51.567
> 
> 标签：apache, web-applications, migration, standards, cgi-bin

我正在维护一些 CGI Web 应用程序，我正在将其迁移到一个新的 Linux Web 服务器，在该服务器上我有一个非管理员帐户，说`www_maintainer.`所以我在里面安装 CGI 应用程序`/home/www_maintainer/`，我想借此机会清理东西，特别是`cgi-bin/`目录可以更好地组织；我想了解一个最佳实践标准。

例如，在内部调用 subdirs`bin/`以及辅助事物的二进制文件和库是否正常？`lib/``cgi-bin/`

我将描述一个具体的例子，即数学和数据绘图应用程序[gnuplot](http://www.gnuplot.info)及其依赖项（libfontconfig、libpng、libgd、libjpeg、libreadline.so、...）。
Python 可能是另一个例子（发行版提供 2.4，但我需要 >2.6），但是我希望管理员可以从包中安装 2.6，这样我就不必担心了。

新的 Web 服务器具有基于 Redhat RHEL 的[Scientific Linux (SL)。](https://www.scientificlinux.org/)不幸的是，我们当前 SL 版本的发行版存储库没有提供我需要的 gnuplot 4.4 版，因此它不能安装在`/usr/bin/`像`cgi-bin/tools/`. 实际的 CGI Web 应用程序是由脚本`launch1.sh`或`launch2.sh`.

这是目录树和其中一些文件的插图（当然省略了许多目录和文件）。

```
cd /home/www_maintainer/www_root/

|-- html/
|   |-- index.html
|   `-- info.html
|-- cgi-bin/
|   |-- gen/
|   |   |-- status.sh*
|   |   `-- sybase/
|   |       `-- DataAccess64/
|   |           `-- ODBC/
|   |               |-- lib/
|   |               |-- samples/
|   |               `-- spl/
|   |-- exe1/
|   |   `-- launch1.sh*
|   |-- exe2/
|   |   `-- launch2.sh*
|   |-- javascript/
|   |   `-- check-input.js
|   |-- scripts/
|   |   |-- decode.pl*
|   |   |-- generate-random-string.bash*
|   |   |-- gnuplot -> ../tools
|   |   `-- upload.php*
|   |-- tools
|   |   |-- bin/
|   |   |   |-- gnuplot*
|   |   |   |-- python -> python2.6
|   |   |   |-- python-config -> python2.6-config
|   |   |   |-- python2.6*
|   |   |   |-- python2.6-config*
|   |   |   `-- xmlwf*
|   |   |-- etc
|   |   |   `-- fonts/
|   |   |-- include/
|   |   |-- info/
|   |   |-- lib/
|   |   |   |-- libfontconfig.so
|   |   |   |-- libpdf.so
|   |   |   |-- libreadline.so
|   |   |   |-- libpng15.so
|   |   |   |-- libpng15.so
|   |   |   |-- pkgconfig/
|   |   |   |-- libpng.so
|   |   |   |-- libjpeg.so
|   |   |   |-- libreadline.so
|   |   |-- libexec/
|   |   |-- man/
|   |   `-- share/
|-- tests/
|   `-- results/
|       `-- info/
|           |-- readme.pdf
|           `-- readme.html
|-- fonts/
|-- index.html -> html/index.html
|-- log/
|   `-- log.txt
`-- tmp -> /tmp/ 
```

最好安装在目录之外`www_root`，例如目录`/home/www_maintainer/bin/` 并 `/home/www_maintainer/lib/`配置Web服务器以允许这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T01:42:33.767

**编辑：美国太平洋时间 2012 年 5 月 23 日下午 3 点**

如果您被限制在用户的目录中，您几乎可以做任何您想做的事情。

*过去*常见的情况是您将所有使用 CGI 的文件（Perl 等）放入目录`cgi-bin`中，并且您可以（并且可能应该）根据用途或应用程序将它们放入子目录中。

然后将非 CGI 文件放在目录*之外*，`cgi-bin`其中包括任何裸 HTML 文件、图形文件、CSS 文件、JS 文件等。

对于任何由 CGI 文件使用但不是由 Web 用户直接使用的程序，根本不要将它们放在 webroot 中，因为这不是必需的，并且如果 Web 用户可以在某些程序中将值提交到这些程序中，则可能是一个安全漏洞时尚。

目录树示例：

```
/home/www_maintainer/public_html/index.html
/home/www_maintainer/public_html/images/logo.png
/home/www_maintainer/public_html/scripts/something.js
/home/www_maintainer/public_html/cgi-bin/application1/app1.cgi
/home/www_maintainer/public_html/cgi-bin/application2/app2.cgi
/home/www_maintainer/public_html/cgi-bin/application2/app2helper.cgi
/home/www_maintainer/tools/gnuplot/gnuplot
/home/www_maintainer/tools/python/python -> python2.6
/home/www_maintainer/tools/python/python2.6
/home/www_maintainer/tools/python/python2.6-config 
```

然后在您的 CGI 文件中，确保`tools`根据需要正确设置路径。Web 用户没有必要直接访问这些工具，因此请不要访问这些工具*。*如果您`python`通过 CGI 进行操作（在这种情况下我假设是这样），请确保您的 shebang 行显示正确的路径；`#!/home/www_maintainer/tools/python/python`， 例如。

* * *

**原答案：**

许多应用程序所做的，例如与 Debian 一起分发的应用程序，是将它们的应用程序放在`/usr/share/lib/programname`目录中，然后使用 Apache`Alias`并将`ScriptAlias`它们映射到基本 URL。这也是我过去运行我们自己内部开发的应用程序的方式，而且效果很好。

For your situation, I'd recommend changing as little as possible unless you plan to enhance the code or the system more and more over time. Making changes could bring headache if paths change, especially if any are bookmarked, unless you want to get cozy with some `mod_rewrite` in your config.

Do you have any specific examples that I could use to demonstrate what I've described?

Also, with regard to ancient `/usr/bin/python`, is your system completely up-to-date? Or is the problem that your Linux distribution just doesn't push a newer version? I'd avoid installing a version of Python that isn't managed by your distro's package management system.

# ruby-on-rails - Capistrano 和载波

> ID：10586548
> 
> 赞同：2
> 
> 时间：2012-05-14T15:38:54.553
> 
> 标签：ruby-on-rails, ruby, deployment, capistrano, carrierwave

我正在使用 Capistrano 部署 Ruby on Rails 和 NodeJS 应用程序。每次部署时都会删除上传文件夹。

这出现在几个地方，但似乎不起作用：

```
# Keep File Uploads
  task :symlink_uploads do
    run "ln -nfs #{shared_path}/rails/uploads  #{release_path}/rails/public/uploads"
  end

  after 'deploy:update_code', 'deploy:symlink_uploads' 
```

回购：

```
 repo:
    /node
    /rails 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T21:47:18.487

这个问题还有另一种解决方案。你可以将你的`uploads`目录添加到 Capistrano's `shared_children`，它会自动完成所有的魔法。您可以在此答案中找到更多详细信息：[https ://stackoverflow.com/a/9710542/835935](https://stackoverflow.com/a/9710542/835935)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T21:38:17.333

确保删除现有的 public/uploads 文件夹，传递`-f`给`ln`不包括删除目标目录（或者至少对我来说没有这样做）

我的符号链接目录任务通常看起来像

```
task :symlink_uploads do
  run "rm -rf #{release_path}/rails/public/uploads} && ln -nfs #{shared_path}/rails/uploads  #{release_path}/rails/public/uploads"
end 
```

显然，请确保您需要的公共/上传的签入版本中没有任何内容！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T21:05:20.787

你试过了吗

```
after 'deploy:update_code', ':symlink_uploads' 
```

您的`:symlink_uploads`任务不在命名空间中，因此请执行上述操作或将其放在命名空间中

```
namespace :deploy do
  task :symlink_uploads do
    # ...
  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T21:57:01.547

我的 RoR 应用程序上传的文件也有类似的问题。这是我的 capistrano 任务：

```
...
task :link_public_folder, :roles => [:app, :web] do
    run "mv -u #{release_path}/public/* #{shared_path}/public"
    run "rm -rf #{release_path}/public"
    run "ln -s #{shared_path}/public #{release_path}/public"
  end
  after "deploy:update", "deploy:link_public_folder"

  task :setup_config, :roles => :app do
    sudo "ln -nfs #{current_path}/config/apache.conf /etc/apache2/sites-available/#{application}"
    run "mkdir -p #{shared_path}/config"
    run "mkdir -p #{shared_path}/public"
    put File.read("config/database.yml"), "#{shared_path}/config/database.yml"
    puts "Now edit the config files in #{shared_path}."
  end
  after "deploy:setup", "deploy:setup_config"
... 
```

或许能帮到你

编辑：我也使用 Carrierwave。

# .net - 在 .NET 中解密用 3DES 加密的 ColdFusion 中的字符串

> ID：10586551
> 
> 赞同：2
> 
> 时间：2012-05-14T15:39:08.820
> 
> 标签：.net, encryption, coldfusion, 3des

我无法解密在 .NET 中加密的字符串。我在这里看到了其他几个解决方案，主要是[在 C# 中解密用 3DES 加密的 ColdFusion 中的字符串，](https://stackoverflow.com/questions/9196207/decrypting-a-string-in-coldfusion-encrypted-with-3des-in-c-sharp)但我在尝试解密传递给我的 .NET 加密字符串时仍然遇到问题。这是错误：

“尝试加密或解密您的输入字符串时发生错误：给定最终块未正确填充。”

在进一步的测试中，当开始使用相同的解密文本时，我在 CF 中得到的加密字符串与在 .NET 中不同

这是用于加密/解密的 .NET 代码 - 我用填写信息替换了密钥和 IV 数据：

```
Imports System.IO
Imports System.Text
Imports System.Security.Cryptography

Public Class TripleDES

    ' define the triple des provider
    Private Shared m_des As New TripleDESCryptoServiceProvider

    ' define the string handler
    Private m_utf8 As New UTF8Encoding

    ' define the local property arrays
    Private m_key() As Byte
    Private m_iv() As Byte
    Private key As String = "48-digit hex key"
    Private iv As String = "16-digit hex iv"

    Public Sub New()
        Me.m_key = convertHexStringToByteArray(key)
        Me.m_iv = convertHexStringToByteArray(iv)
    End Sub
    Public Sub New(ByVal _key As String, ByVal _iv As String)
        key = _key
        iv = _iv
        Me.m_key = convertHexStringToByteArray(key)
        Me.m_iv = convertHexStringToByteArray(iv)
    End Sub
    Public Sub New(ByVal _key() As Byte, ByVal _iv() As Byte)
        Me.m_key = _key
        Me.m_iv = _iv
    End Sub
    Public Function Encryptfrombyte(ByVal input() As Byte) As Byte()
        Return Transform(input, m_des.CreateEncryptor(m_key, m_iv))
    End Function

    Public Function EncryptBytes(ByVal text As String) As Byte()
        Dim input() As Byte = m_utf8.GetBytes(text)
        Dim DesEnc As ICryptoTransform = m_des.CreateEncryptor(m_key, m_iv)
        Dim output() As Byte = Transform(input, DesEnc)
        Return output 'convertByteArrayToHexString(output)
    End Function

    Public Function encrypt(ByVal key As Byte(), ByVal data As Byte()) As Byte()
        Dim des As TripleDESCryptoServiceProvider = New TripleDESCryptoServiceProvider
        des.Key = key
        des.Mode = CipherMode.ECB
        des.Padding = PaddingMode.PKCS7
        Return des.CreateEncryptor.TransformFinalBlock(data, 0, data.Length)
    End Function
    Public Function Decrypt(ByVal input() As Byte) As String
        Dim DesEnc As ICryptoTransform = m_des.CreateDecryptor(m_key, m_iv)
        Dim output() As Byte = Transform(input, DesEnc)

        Return m_utf8.GetString(output)
    End Function
    Public Function Decrypt(ByVal text As String) As String
        Dim input() As Byte = m_utf8.GetBytes(text)
        Dim output() As Byte = Transform(input, _
                         m_des.CreateDecryptor(m_key, m_iv))
        Return m_utf8.GetString(output)
    End Function

    Private Function Transform(ByVal input() As Byte, _
        ByVal CryptoTransform As ICryptoTransform) As Byte()
        ' create the necessary streams
        Dim memStream As MemoryStream = New MemoryStream
        Dim cryptStream As CryptoStream = New _
            CryptoStream(memStream, CryptoTransform, _
            CryptoStreamMode.Write)
        ' transform the bytes as requested
        cryptStream.Write(input, 0, input.Length)
        cryptStream.FlushFinalBlock()
        ' Read the memory stream and convert it back into byte array
        memStream.Position = 0
        Dim result(CType(memStream.Length - 1, System.Int32)) As Byte
        memStream.Read(result, 0, CType(result.Length, System.Int32))
        ' close and release the streams
        memStream.Close()
        cryptStream.Close()
        ' hand back the encrypted buffer
        Return result
    End Function
    Public Function convertHexStringToByteArray(ByVal str As String) As Byte()

        '//String in Hex - 2 chars represet a byte.
        Dim size As Integer = (str.Length() / 2) - 1
        Dim b(size) As Byte
        'ReDim b  str.Length() / 2
        Dim j As Integer = 0

        Try
            For i As Integer = 0 To str.Length() - 1 Step 2
                Dim s As String = str.Substring(i, 2)
                '//parse the substring as an integer, as the 8th bit may be set
                Dim k As Integer = Convert.ToInt32(s, 16)
                '//downcast integer to byte, this down casting does not do any
                ' //harm since memory footprint of first 8 bits remains same.
                b(j) = New Byte
                b(j) = CType(k, Byte)
                j += 1
            Next
        Catch e As Exception
            Dim ti As String = 1
            'TraceLog.trace2(e)
        End Try
        Return b
    End Function
    Public Function convertByteArrayToHexString(ByVal b() As Byte) As String
        Dim buffer As String
        ' Dim hexDigit() As String = Split("0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f", "', '")

        For i As Integer = 0 To b.Length - 1
            'dim  array as char()= (hexDigit((b(i) >> 4) & chr(0x0f)), hexDigit(b(i) & 0x0f))
            Dim tmp As String = Hex(b(i))
            If tmp.Length = 1 Then
                tmp = "0" & tmp
            End If
            buffer += (tmp)
        Next

        Return buffer.ToString()
    End Function
    Public Function bytetoHex(ByVal hextBt() As Byte) As String
        Dim disc As Integer = 0
        bytetoHex = HexEncoding.ToString(hextBt)

    End Function

    Public Function hexToByte(ByVal hex As String) As Byte()
        Dim disc As Integer = 0
        hexToByte = HexEncoding.hexidecimaltoByte(hex)
    End Function

End Class 
```

这是加密/解密的 CF 代码：

```
<!--- Get The Key from Hex to base64 --->
<cfset theKeyHex    = "48-digit hex key" />
<cfset theKeyBin    = BinaryDecode(theKeyHex,"hex")>
<cfset theKeyB64    = BinaryEncode(theKeyBin,"base64")>

<!--- Get the IV to Binary --->
<cfset theIV        = "16-digit hex iv" />
<cfset theIVBin     = BinaryDecode(theIV,"hex")>

<!--- Define Encoding parameters --->
<cfset theAlgorithm = "DESede/ECB/PKCS5Padding">
<cfset theEncoding  = "Base64">

<!--- Define string --->
<cfset str = "108644" >

<cfoutput>
    <cfset enc = Encrypt(str, theKeyB64, theAlgorithm, theEncoding, theIVBin)>
    encrypted = #enc#<br />

    <cfset dec = Decrypt(enc, theKeyB64, theAlgorithm, theEncoding, theIVBin)>
    decrypted = #dec#<br />
</cfoutput> 
```

为了清楚起见 - 在尝试测试此代码时，我在解密 .NET 加密字符串时遇到了错误，因此我尝试加密 CF 中的值以查看是否得到相同的加密字符串。

在 CF 中，108644 被加密为 63Yp6O+8K+U=

在 .NET 中，108644 被加密为 7loa00RCdZo=

我陷入了僵局。我不知道从这里去哪里。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:04:38.673

`ECB`mode 不使用初始化向量，因此被忽略。您需要将模式更改为`CBC`：

```
<cfset theAlgorithm = "DESede/CBC/PKCS5Padding"> 
```

**编辑：**详细说明，模式因.NET 代码使用的功能而异。该`encrypt(key, data)`函数使用`ECB`模式。虽然`EncryptBytes(text)`隐式使用`CBC`模式，但由于存在`iv`. 因此，您需要相应地更改您的 CF 代码。

# c - 如何在 C 程序中为 unsigned char 变量分配十六进制值

> ID：10586552
> 
> 赞同：-6
> 
> 时间：2012-05-14T15:39:13.950
> 
> 标签：c, hex, unsigned-char

我要存储在变量中的十六进制值的长度为 32。“DC4938C31B9E8B30F32FC0F5EC894E16”。我还想打印这个值，但我不知道 printf 中 unsigned char 的格式说明符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:44:47.947

那是一个 32 个*字符*的字符串，是十六进制数字。这使得 16*字节*，或 128*位*。

m0skit0 告诉你如何将它存储在一个字符串中。如果你真的想把它存储在一个整数中，你需要类似的东西`unsigned long long intvar = strtoull( stringvar, NULL, 16 )`——只要你的机器上的“long long”可以容纳 128 位。

**但是你想要的是完全不同的东西，**只有在你链接到另一个问题之后才变得清楚。（像这样断章取意真的很糟糕，*尤其是*当你对自己实际在做什么感到困惑时。）

如果您查看 API 文档，您会看到您正在查看的参数是**指向 DES_cblock**的指针。那不是字符串，也不是整数。看看另一个问题`seed`，`ivsetup`它们是如何初始化的，并*思考*一分钟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:41:48.920

那不是一个`char`. 这是一个字符串：

```
unsigned char* value = "DC4938C31B9E8B30F32FC0F5EC894E16";
printf("%s\n", value); 
```

此外，如果这是一个数字，我强烈不建议您将其转换为字符串或字符，因为字符串比数字更慢并且更容易出现编码错误。

表示为十六进制的数字（而不是十六进制数字，所有数字都是十六进制，它只是值的表示）没有任何字符。再次，它是一个数字。您当然可以将其转换为字符串（与任何其他数字一样），但这样做您应该有充分的理由（例如，您要使用的算法使用字符串比使用数字更快）。

我建议您阅读有关[数字表示的](http://www.swarthmore.edu/NatSci/echeeve1/Ref/BinaryMath/NumSys.html)内容。很多新程序员在这个话题上都有问题。

# c++ - C++ 堆损坏：导致问题的局部堆变量

> ID：10586570
> 
> 赞同：2
> 
> 时间：2012-05-14T15:40:21.620
> 
> 标签：c++, heap-memory, heap-corruption

我正在使用 DirectX9 通过手动组装地面的顶点来处理一些简单的地形。

在我设置索引的代码部分，我得到了一个错误：

Windows 在 test.exe 中触发了一个断点。

这可能是由于堆损坏，这表明 test.exe 或其已加载的任何 DLL 中存在错误。

这是我的代码中给我带来问题的部分，我几乎 100% 确定它已链接到我的索引指针，但我完成后将其删除......所以我不确定是什么问题是。

```
int total = widthQuads * heightQuads * 6;
DWORD *indices = new DWORD[totalIdx];
for (int y = 0; y < heightQuads; y++)
{
    for (int x = 0; x < widthQuads; x++)
    { //Width of nine:
        int lowerLeft = x + y * 9;
        int lowerRight = (x + 1) + y * 9;
        int topLeft = x + (y + 1) * 9;
        int topRight = (x + 1) + (y + 1) * 9;
        //First triangle:
        indices[counter++] = topLeft;
        indices[counter++] = lowerRight;
        indices[counter++] = lowerLeft;
        //Second triangle:
        indices[counter++] = topLeft;
        indices[counter++] = topRight;
        indices[counter++] = lowerRight;
    }
}

d3dDevice->CreateIndexBuffer(sizeof(DWORD)* total, 0, D3DFMT_INDEX16, 
    D3DPOOL_MANAGED, &groundindex, 0);
void* mem = 0;
groundindex->Lock(0, 0, &mem, 0);
memcpy(mem, indices, total * sizeof (DWORD));
groundindex->Unlock();

delete[] indices; 
```

当我删除此块时，我的程序运行正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:55:04.090

您给出的代码看起来不错 - 有一个警告：初始值`counter`不在代码本身中。因此，要么您没有从 开始`counter = 0`，要么其他一些代码正在踩踏您的`indices`缓冲区。

这就是堆损坏的美妙之处。无法保证该错误位于代码的已删除部分中。它可能只是隐藏代码中其他地方存在的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:09:48.453

```
int total = widthQuads * heightQuads * 6;
DWORD *indices = new DWORD[totalIdx]; 
```

你不应该做“new DWORD [total];”吗？这里？

# javascript - 如何将 4 小时添加到格式化的日期/时间

> ID：10586576
> 
> 赞同：2
> 
> 时间：2012-05-14T15:40:57.680
> 
> 标签：javascript, date

我使用 Date Format 1.2.3 将我的时间格式化为 yyyy-mm-dd hh:MM:ss 并将其用于 startTime 变量。如何将 4 小时添加到 startTime 字符串并将其用于新变量（endTime）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T15:43:09.023

您可以尝试将其解析为`Date`，添加 4 小时，然后再次将其格式化为文本。

```
var d = new Date(startTime);
d.setHours(d.getHours() + 4);
var endTime = // Format d variable as you like 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:47:53.470

将其解析为日期，然后将 4 添加到小时

这是日期对象的示例

```
var today = new Date();
today.setHours(today.getHours() + 4); 
```

如果需要，Javascript 将自动更新日/月/年

# objective-c - 更改子视图后 UIScrollView 不尊重 minimumZoomScale

> ID：10586577
> 
> 赞同：4
> 
> 时间：2012-05-14T15:40:58.447
> 
> 标签：objective-c, ios, uiscrollview, uiscrollviewdelegate

我遇到了一个问题，让 UIScrollView 正确更新以响应最小缩放比例的变化。

scrollview有一个UIImageView作为子视图，UIImageView的image属性是响应UIPickerView的didFinishPickingMediaWithInfo方法设置的：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info {

    UIImage *takenImage = [info objectForKey:UIImagePickerControllerOriginalImage];

    [self.imageView setImage:takenImage];
    [self.imageView setFrame:CGRectMake(self.imageView.frame.origin.x, self.imageView.frame.origin.y, takenImage.size.width, takenImage.size.height)];

    [self.scrollView setContentSize:CGSizeMake(takenImage.size.width, takenImage.size.height)];

    [self.scrollView setMinimumZoomScale:[self.scrollView frame].size.width / takenImage.size.width];
    [self.scrollView setMaximumZoomScale:2.0];
    [self.scrollView setZoomScale:[self.scrollView minimumZoomScale] animated:YES];

    [self dismissModalViewControllerAnimated:YES];        

} 
```

第一次使用此方法添加图像时，这可以正常工作。但是，如果再次触发此方法——即使是添加与第一次相同的图像——后续图像在scrollView中以全尺寸显示，并且无法缩小——只能放大。

我已将scrollView 的`contentSize`、和转储到日志中`zoomScale`，并且它们每次都是相同的。每次都正确计算。`minimumZoomScale``maximumZoomScale``minimumZoomScale`

就好像 scrollView 正在用`minimumZoomScale`1.0 重绘，忽略它已被显式设置的事实。我在这里有什么明显的遗漏吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-02T09:41:12.567

问题似乎是 - 不确定此行为是否记录在某处 - 在当前缩放比例设置为 1.0 以外的其他值时重置内容大小。

修复很简单：在设置新内容大小*之前*`zoomScale`将属性重置为 1.0 ：

 *```
// See http://stackoverflow.com/questions/10586577
// first reset before new content size
scroller.zoomScale = 1.0f;
// set new content size
scroller.contentSize = newImage.size;
// ... adjust minimum/maximum zoom scales if needed 
```*

# objective-c - MFMailComposeViewController 自定义发送按钮

> ID：10586578
> 
> 赞同：2
> 
> 时间：2012-05-14T15:40:59.373
> 
> 标签：objective-c, ios4, uibarbuttonitem, mfmailcomposeviewcontroller, mfmailcomposer

我需要能够`UIBarButtonItem`更改`MFMailComposeViewController`.

更改 customView 属性会强制它不再运行。

示例代码：

```
MFMailComposeViewController* vc = [[MFMailComposeViewController alloc] init];
vc.mailComposeDelegate = self;

//This fails:
[self.navigationController presentModalViewController:vc animated:TRUE];
self.topViewController.navigationItem.rightBarButtonItem.customView = 
     [self makeMyView]; 
```

也通过覆盖我的方法的属性（目标，动作）。这也不再被称为。

有没有办法覆盖这个按钮上的 customView？

我支持 iOS4，否则我不会遇到这个麻烦，而且我目前没有时间集成完整的 SMTP 客户端，例如`SKPSMTPMessage`.

# android - APK 首次启动需要很长时间

> ID：10586584
> 
> 赞同：0
> 
> 时间：2012-05-14T15:41:37.673
> 
> 标签：android, apk, tablet

我们开发了一个在平板电脑上运行的 APK 应用程序。在这个应用程序中，我们创建了各种 csv 文件，通过读取这些 csv 文件，apk 在第一次运行时会创建数据库（sqllite）文件。该数据库文件在应用程序中的各种下拉列表中使用（其他关键字中的 masters）。我在这方面面临一个非常严重的问题。我们有一个大约 12000 行的 csv 文件，因此 apk 第一次需要大约 1 小时。第一次，我的意思是当我在平板电脑上安装 apk 并第一次运行它时。这在我的应用程序中成为一个非常严重的问题，我需要解决这个问题。任何人都可以给出任何想法如何克服这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:51:33.337

您应该尝试使用运行特殊版本应用程序的 Android 模拟器/设备预处理 SQL 数据库，将结果数据库放入您的发布 APK，并在应用程序首次运行期间将数据库复制到适当的位置。从 Android 模拟器/设备中检索数据库的过程可以在[这里](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)找到。

# css - 基于百分比的填充打破了我的布局

> ID：10586588
> 
> 赞同：2
> 
> 时间：2012-05-14T15:41:52.610
> 
> 标签：css, responsive-design, percentage

我正在尝试将所有宽度和边距以及填充转换为百分比，以使我正在处理的网站具有响应性。我得到了没有问题的标题，但现在我被卡住了。

当我更改我的 li 项目的填充时，布局会中断。在整个站点上，内边距应该是 6px，但即使我将内边距设置为一个百分比，即使小到 0.1%，它也会将其中一个元素向下颠倒。该网站尚未上线，但我提供了一些屏幕截图和一些代码。有任何想法吗？

```
aside#footer-brands ul  {
margin:0;
padding:0;
}

aside#footer-brands ul li {
padding:6px;
float:left;
list-style: none;   
}

aside#footer-brands ul li a {
background-image: url(/images/csr/footer/brands/sprite-brands.png);
background-repeat:  no-repeat;
display: block;
text-indent: 100%;
white-space: nowrap;
overflow: hidden;
}

<aside id="footer-brands">
            <h6>Our Brands</h6>
            <ul>
                <li><a class="keurig-logo" href="http://www.keurig.com">Keurig</a></li>
                <li><a class="gmcr-logo" href="http://www.greenmountaincoffee.com">Green Mountain Coffee</a></li>
                <li><a class="tullys-logo" href="http://www.tullys.com">Tullys</a></li>
                <li><a class="timothys-logo" href="http://www.timothys.com">Timothys</a></li>
                <li><a class="diedrich-logo" href="http://www.diedrich.com">Diedrich</a></li>
                <li><a class="vanhoutte-logo" href="http://www.keurig.com/shop/k-cups/all-k-cups?hdnCategoryFacets=Brand:Van%20Houtte&hdnBaseFacets=Brand">Van Houtte</a></li>
            </ul>
</aside> 
```

第一个问题，所以我不能发布图片，但[它应该是这样](https://img.skitch.com/20120514-ng553b28ana6khsss619cag72e.jpg)的......

![https://img.skitch.com/20120514-ng553b28ana6khsss619cag72e.jpg](../Images/f6dc3529e296b719f88f8ac42f516f1a.png)

以及[当我将填充更改为百分比时的](https://img.skitch.com/20120514-j94cgs2g8dppktcacbns3jmig2.jpg)外观...

![https://img.skitch.com/20120514-j94cgs2g8dppktcacbns3jmig2.jpg](../Images/12a73ed25ba5b9c11c81fc937001d2c2.png)

编辑添加网址：

[您可以在http://nightowlsrock.com/3-col.html](http://nightowlsrock.com/3-col.html)查看页面

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T20:01:55.370

你试过 CSS3 flexbox 吗？它不需要任何百分比（只是比例和浏览器本身处理宽度）。它还确保事物总是在同一条线上（不会像浮动那样颠簸）。

[http://www.html5rocks.com/en/tutorials/flexbox/quick/](http://www.html5rocks.com/en/tutorials/flexbox/quick/)

至于填充，我认为大多数浏览器都存在宽度小于 1px 的问题，因此如果您希望事情“像素完美”，您可能必须使用媒体查询的固定像素宽度来实现这一点。但我发现你通常可以使用 flexbox 获得“足够接近”的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:09:58.237

编辑：忽略我之前说的。

[W3C 关于填充](http://www.w3.org/TR/CSS21/box.html#padding-properties)的页面说

> 百分比是根据生成框的包含块的宽度计算的，即使对于“padding-top”和“padding-bottom”也是如此。如果包含块的宽度取决于此元素，则结果布局在 CSS 2.1 中未定义。

是的，未定义的行为就是你所看到的。`.8%`通过将值设置为,等`1%`，我可以产生截然不同的结果。 所以答案似乎是您应该首先将 UL 设置为某个预定宽度。`1.2%`

# iphone - 从 iPhone 上的视频输出中获取静止图像？

> ID：10586589
> 
> 赞同：2
> 
> 时间：2012-05-14T15:41:54.347
> 
> 标签：iphone, objective-c

我正在编写一个应用程序来显示 iphone 相机看到的光照条件的统计信息。我每秒拍摄一张图像，并对其进行计算。

要捕获图像，我使用以下方法：

```
-(void) captureNow
{
    AVCaptureConnection *videoConnection = nil;
    for (AVCaptureConnection *connection in captureManager.stillImageOutput.connections)
    {
        for (AVCaptureInputPort *port in [connection inputPorts])
        {
            if ([[port mediaType] isEqual:AVMediaTypeVideo] )
            {
                videoConnection = connection;
                break;
            }
        }
        if (videoConnection) { break; }
    }

    [captureManager.stillImageOutput captureStillImageAsynchronouslyFromConnection:videoConnection completionHandler: ^(CMSampleBufferRef imageSampleBuffer, NSError *error)
     {   
         NSData *imageData = [AVCaptureStillImageOutput jpegStillImageNSDataRepresentation:imageSampleBuffer];
         latestImage = [[UIImage alloc] initWithData:imageData];
     }];
} 
```

但是，该`captureStillImageAsynhronously....`方法会导致手机播放“快门”声音，这对我的应用程序没有好处，因为它会不断地捕捉图像。

我已经读到无法禁用此音效。相反，我想从手机的视频输入中捕获帧：

```
AVCaptureDeviceInput *newVideoInput = [[AVCaptureDeviceInput alloc] initWithDevice:[self backFacingCamera] error:nil]; 
```

并希望将这些变成`UIImage`对象。

我将如何实现这一目标？我不太了解 AVFoundation 的工作原理——我下载了一些示例代码并为我的目的对其进行了修改。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T21:43:03.403

不要为此使用静态相机。相反，从设备的摄像机中抓取并处理包含在像素缓冲区中的数据，以响应 AVCaptureVideoDataOutputSampleBufferDelegate。

您可以使用如下代码设置视频连接：

```
// Grab the back-facing camera
AVCaptureDevice *backFacingCamera = nil;
NSArray *devices = [AVCaptureDevice devicesWithMediaType:AVMediaTypeVideo];
for (AVCaptureDevice *device in devices) 
{
    if ([device position] == AVCaptureDevicePositionBack) 
    {
        backFacingCamera = device;
    }
}

// Create the capture session
captureSession = [[AVCaptureSession alloc] init];

// Add the video input  
NSError *error = nil;
videoInput = [[[AVCaptureDeviceInput alloc] initWithDevice:backFacingCamera error:&error] autorelease];
if ([captureSession canAddInput:videoInput]) 
{
    [captureSession addInput:videoInput];
}

// Add the video frame output   
videoOutput = [[AVCaptureVideoDataOutput alloc] init];
[videoOutput setAlwaysDiscardsLateVideoFrames:YES];
[videoOutput setVideoSettings:[NSDictionary dictionaryWithObject:[NSNumber numberWithInt:kCVPixelFormatType_32BGRA] forKey:(id)kCVPixelBufferPixelFormatTypeKey]];

[videoOutput setSampleBufferDelegate:self queue:dispatch_get_main_queue()];

if ([captureSession canAddOutput:videoOutput])
{
    [captureSession addOutput:videoOutput];
}
else
{
    NSLog(@"Couldn't add video output");
}

// Start capturing
[captureSession setSessionPreset:AVCaptureSessionPreset640x480];
if (![captureSession isRunning])
{
    [captureSession startRunning];
}; 
```

然后，您需要在如下所示的委托方法中处理这些帧：

```
- (void)captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection
{
    CVImageBufferRef cameraFrame = CMSampleBufferGetImageBuffer(sampleBuffer);
    CVPixelBufferLockBaseAddress(cameraFrame, 0);
    int bufferHeight = CVPixelBufferGetHeight(cameraFrame);
    int bufferWidth = CVPixelBufferGetWidth(cameraFrame);

        // Process pixel buffer bytes here

    CVPixelBufferUnlockBaseAddress(cameraFrame, 0);
} 
```

BGRA 图像的原始像素字节将包含在从`CVPixelBufferGetBaseAddress(cameraFrame)`. 您可以遍历这些以获得所需的值。

但是，您会发现在 CPU 上对整个图像执行的任何操作都会有点慢。您可以使用 Accelerate 来帮助进行平均颜色操作，就像您在这里想要的那样。我过去曾使用`vDSP_meanv()`过平均亮度值，一旦你将它们放在数组中。对于类似的事情，最好从相机中获取 YUV 平面数据，而不是我在此处下拉的 BGRA 值。

我还编写[了一个开源框架](https://github.com/BradLarson/GPUImage)来使用 OpenGL ES 处理视频，尽管我还没有像你需要的那种图像分析那样的全图像缩减操作。我的直方图生成器可能是最接近你想要做的事情的。

# regex - 访问日志中的 sed 时间和 http 请求

> ID：10586593
> 
> 赞同：1
> 
> 时间：2012-05-14T15:42:00.537
> 
> 标签：regex, sed, awk

我正在查看具有大量条目的访问日志，例如：

```
localhost_access_log.2012-05-07.txt:129.223.57.10 - - [07/May/2012:00:02:11 +0000] 2434 "POST /maker/www/jsp/opp/OpportunityForm.do HTTP/1.1" 302 - "https://dm2.myjones.com/maker/www/jsp/opp/Opportunity.jsp?screenDisplay={0}&forecastIcon={1}" "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2; MS-RTC LM 8)" 
```

日期时间戳后面的数字是执行时间，引号中的字符串是 URL。

我希望只是 sed，URL 和响应时间，并将它们的格式

```
URL, response time 
```

例如

```
POST /maker/www/jsp/opp/OpportunityForm.do HTTP/1.1,  2434 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:48:28.463

`sed`：

```
sed 's/^[^]]\+\] \([[:digit:]]\+\) \("[^"]\+"\).*/\2,\1/' inputfile 
```

珀尔：

```
perl -lne 'print "$2,$1" if /.*? (\d+) (".*?")/' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:47:52.140

您可以`awk`像这样打印第 6、7、8 和 9 个条目：

```
awk '{print $7, $8, $9, ", " $6}' <access_log> 
```

输出：`"POST /maker/www/jsp/opp/OpportunityForm.do HTTP/1.1" , 2434`

`awk`默认情况下按空格分隔字段。`nth`存储在`$n`. 所以在你的输入行中：

```
$7: "POST
$8: /maker/www/jsp/opp/OpportunityForm.do
$9: HTTP/1.1"
$6: 2434 
```

# javascript - 跨域发布 Javascript

> ID：10586595
> 
> 赞同：0
> 
> 时间：2012-05-14T15:42:07.733
> 
> 标签：javascript, client

所以我正在尝试制作一个网页，通过客户端启动本地应用程序。

我能想到的最简单的解决方案就是将数据发布或获取到我想要使用的端口；说端口 3000。不幸的是，我遇到了一个错误：`XMLHttpRequest cannot load %3127.0.0.1:3000\. Cross origin requests are only supported for HTTP.`

我的问题：有没有办法使用 XMLHttpRequest() 将数据发布或获取到 127.0.0.1:3000？

对格式混乱感到抱歉，我玩了很长时间，但无法正确缩进 D：

```
function Post_Command(Command_String){
if(typeof(Command_String) != "string"){
 console.log(
    "Invalid Call:\Post_Command(\n\t"+Command_String+":"+typeof(Command_String)+"\n)"
);
} else {
    xmlhttp=new XMLHttpRequest();
    xmlhttp.onreadystatechange=function(){
        if (xmlhttp.readyState==4 && xmlhttp.status==200){
            console.log(xmlhttp.responseText);
        }
    }
    xmlhttp.open(
        "POST",
        "127.0.0.1:3000",
        true
    );
    xmlhttp.send(Command_String);
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:44:30.347

是的，有附带条件。您的第一个问题是您必须使用 HTTP 或 HTTPS。您的 URI 上需要一个方案（或者您需要启动它`//`以维护当前方案，如果您正在访问特定端口，这是不明智的）。

```
"127.0.0.1:3000" --> "http://127.0.0.1:3000" 
```

[在端口 3000 上运行的服务器需要使用CORS](https://developer.mozilla.org/en/HTTP_access_control)向该站点授予权限。用户还必须配备[支持 CORS 的浏览器](http://caniuse.com/#search=cors)。

# mysql - MySQL 表 MATCH AGAINST

> ID：10586603
> 
> 赞同：0
> 
> 时间：2012-05-14T15:42:42.863
> 
> 标签：mysql, match-against

![在此处输入图像描述](../Images/e31d2eb5ea6d264c04fc305071f8b547.png)

大家好，

我创建了这个简单的表，在名为 XAMMP 的数据库中称为经典。我正在尝试对我认为我理解的作者姓名进行 MATCH AGAINST 搜索。

此外，我已确保该表是 FULLTEXT 索引，根据需要包括作者和标题列。该表也是 MyISAM 类型。

我试过这个，但失败了。

从经典中选择作者 WHERE MATCH(author) AGAINST('Charles');

我知道查尔斯必须出现在作者列中，正如您所见，但我没有返回任何行。

现在，如果我将其重写给任何其他作者，它就可以了

SELECT author FROM classics WHERE MATCH(author) AGAINST ('jane');

这是我和简一起得到的……

![在此处输入图像描述](../Images/e2ff4c200ff76909b216648fef28af64.png)

我不确定，但似乎早些时候我必须在查询中包含我索引的两个字段，而不仅仅是能够单独搜索作者。这是正确的吗？有人知道为什么我不能让查尔斯回来吗？

非常感谢！。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:46:33.287

它不会返回这些行，因为“charles”出现在 50% 的行中。这是 MySQL FULLTEXT 搜索的一个有据可查的限制。

如果你想绕过这个限制，你可以使用[`BOOLEAN MODE`](http://dev.mysql.com/doc/refman/5.0/en/fulltext-boolean.html).

[这是手册](http://dev.mysql.com/doc/refman/5.0/en/fulltext-natural-language.html)的相关摘录：

***匹配表中一半行的单词不太可能找到相关文档。事实上，它很可能会找到大量不相关的文档。我们都知道，当我们尝试使用搜索引擎在 Internet 上查找内容时，这种情况经常发生。正是由于这种推理，包含该词的行被赋予了它们出现的特定数据集的低语义值。一个给定的单词可能在一个数据集中达到 50% 的阈值，但在另一个数据集中则不会。***

***当您第一次尝试全文搜索以了解其工作原理时，50% 阈值具有重要意义：如果您创建一个表格并仅在其中插入一两行文本，则文本中的每个单词至少出现 50%的行。因此，没有搜索返回任何结果。确保插入至少三行，最好更多。需要绕过 50% 限制的用户可以使用布尔搜索模式；请参阅第 12.9.2 节，“布尔全文搜索”。***

# javascript - 如何使用greasemonkey和javascript将页面上每个字母的颜色更改为随机选择的颜色？

> ID：10586604
> 
> 赞同：3
> 
> 时间：2012-05-14T15:42:50.073
> 
> 标签：javascript, greasemonkey

所以我已经阅读了一些类似的问题，并且我已经设法做一些事情，比如改变背景颜色，但我还不能让它工作；

我想要的是让页面上的每个后续字母随机着色。使用的色彩空间并不是很重要，因为一旦它真正起作用就很容易修复（目前正在使用[这个](https://stackoverflow.com/a/1484514/432913)），但我什至无法让文本改变颜色。我希望我只是在某个地方犯了一个愚蠢的错误......

这就是我目前正在尝试的；它*有点*工作，但它非常依赖于我使用的标签名，并且由于大多数网页的性质，如果我不小心，它可能会破坏很多东西......

[jsFiddle](http://jsfiddle.net/bXZZQ/)

```
var elements = document.getElementsByTagName('p');
for(var i=0,l=elements.length;i<l;++i) {

    var str = elements[i].textContent;
    elements[i].innerHTML = '';

    for(var j=0,ll=str.length;j<ll;++j) {
        var n = document.createElement('span');
        elements[i].appendChild(n);
        n.textContent = str[j];
        n.style.color = get_random_colour();
    }
}
function get_random_colour() {
    var letters = '0123456789ABCDEF'.split('');
    var colour = '#';
    for (var i = 0; i < 6; i++ ) {
        colour += letters[Math.round(Math.random() * 15)];
    }
    return colour;
}​ 
```

在这个例子中， p 工作正常，并且似乎没有破坏任何东西，但如果我这样做，或者`*`它会破坏页面。有没有办法获取页面上的所有文本，而不是破坏它？`html``body`

还有一件事；后来我更改了颜色函数，*希望*只选择 HSV(random,1,1) 中的颜色，这样我只能得到漂亮的明亮颜色，但它不起作用。我假设我只是有一些 JS 错误，但我对 JS 不是很熟悉，所以我发现很难找到......

[以下](http://jsfiddle.net/bXZZQ/1/)是变化

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:58:31.107

为此，您将希望仅通过文本节点进行递归，注意不要破坏子 HTML 元素。

[**请参阅 jsFiddle 上的演示。**](http://jsfiddle.net/wXNsG/)

```
var x  = document.querySelector ("body"); // Etc.
buggerTextNodesIn (x);

function buggerTextNodesIn (node) {
    var wrapClass   = 'gmColorBarf';

    function turnerizeTextNodes (node) {
        if (node.nodeType === Node.TEXT_NODE) {
            //--- Skip this node if it's already been wrapped.
            if ( ! node.parentNode.classList.contains (wrapClass) ) {
                var oldText = node.nodeValue;
                var parent  = node.parentNode;

                for (var J = 0, len = oldText.length;  J < len;  ++J) {
                    var wrapSpan    = document.createElement ("span");
                    wrapSpan.classList.add (wrapClass);
                    wrapSpan.textContent = oldText[J];
                    wrapSpan.style.color = getRandomColor ();

                    parent.insertBefore (wrapSpan, node);
                }
                parent.removeChild (node);
            }
        }
        else if (node.nodeType === Node.ELEMENT_NODE) {
            /*--- IMPORTANT! Start "bottom up" since we will be adding
                gazillions of nodes and "top down" would skew our length measurement.
            */
            for (var K = node.childNodes.length - 1;  K >= 0;  --K) {
                turnerizeTextNodes (node.childNodes[K] );
            }
        }
    }

    turnerizeTextNodes (node);
}

function getRandomColor () {
    var letters = '0123456789ABCDEF'.split ('');
    var color   = '#';
    for (var J = 0;  J < 6; ++J) {
        color += letters[Math.round(Math.random() * 15)];
    }
    return color;
} 
```

* * *

请注意，要获取 iframe 内容，最简单的方法是调整`@include`、`@exclude`和/或`@match`指令以在 iframe URL 上触发——如果它们还没有。

# ruby-on-rails - Rails：在服务器上启动脚本，然后“离开”

> ID：10586607
> 
> 赞同：3
> 
> 时间：2012-05-14T15:43:20.113
> 
> 标签：ruby-on-rails, heroku, rake

我想在 Heroku 上的应用程序上运行一个 rake 脚本，这需要几个小时。如果我从笔记本电脑上的控制台启动它，然后关闭笔记本电脑，脚本将停止（并且我必须在脚本完成之前关闭笔记本电脑）。

如何在不将它“绑定”到我的笔记本电脑的情况下启动这个 rake 脚本。即让它继续运行直到它中断或完成？

```
heroku run rake update_feeds_complete --app myapp 
```

是要运行的脚本...

就 Google 的哪些命令等向我提供建议也会有所帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-10T20:35:42.470

您可以使用并关闭终端窗口运行命令，`run:detached`它们将继续运行。所以你只需要运行

`heroku run:detached rake update_feeds_complete --app myapp`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T18:54:54.743

您可能还想看看调度程序。[https://devcenter.heroku.com/articles/scheduler](https://devcenter.heroku.com/articles/scheduler)

运行 rake 任务非常方便，即使是一次性的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T19:07:40.037

一般来说，我使用 resque 和 redis 来处理我想在 heroku 上运行的作业。如果这是一次性工作，我可能不会，但如果这是我要定期做的事情，那么安装它们会非常方便。

*   **redis**通过[带有 Heroku 的“Redis To Go”插件安装](https://addons.heroku.com/redistogo)。

*   **resque**是[用于运行](https://github.com/defunkt/resque/)不同类型的后台作业的 gem。有很多用于[发送电子邮件](https://github.com/zapnap/resque_mailer)、[作业调度](https://github.com/bvandenbos/resque-scheduler)等[的 resque 插件。](https://github.com/defunkt/resque/wiki/plugins)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:47:49.133

我特别不熟悉 Heroku，但过去当我遇到这种情况时，我通过 SSH 使用远程执行：

```
ssh username@your.server -f 'your command here' 
```

这将打开一个 ssh 会话，执行您的命令，然后关闭连接。但是您的脚本将继续远程运行。

# jquery - jQuery - 在 div 单击时触发函数运行良好，但在页面加载时不运行

> ID：10586611
> 
> 赞同：1
> 
> 时间：2012-05-14T15:43:33.343
> 
> 标签：jquery, function

我有以下功能，我想在页面加载时运行并在单击 div#trigger 时重新运行。当您单击 div#trigger 时，一切都很好。然而，在页面加载时，代码似乎有时可以工作，但有时会缩进错误的数量，并且警报（我只是为了调试目的而放入其中）永远不会触发。谢谢

```
 function textIndentFunc () {

     textString = $('#from-1 :selected').text();

     $('#hidden').text(textString);

     textWidth = $('#hidden').width();

     inputWidth = $('#from-1 select').width();

     indentMy = (inputWidth / 2) - (textWidth / 2);

    $('#from-1').css('text-indent',indentMy);

}

 $('#trigger').click(function(){
    textIndentFunc();
    alert('fire');
 });

textIndentFunc(); 
```

更新 - 我应该提到这段代码在 document.ready 上运行。

更新 - 将代码移动到 window.load 不会改变任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:46:05.333

像这样将函数调用包装在 document.ready 处理程序中......

```
$(function() {
    textIndentFunc();
}); 
```

这可以确保在尝试对它进行任何操作之前加载 DOM，否则您将在不同的时间得到不同的结果，具体取决于加载的内容和未加载的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:46:22.797

您的函数需要在 document.ready 调用中调用

```
$(document).ready(function() {
   textIndentFunc();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-30T10:06:30.233

尝试如下

```
 $(document).ready(function () {
$('#trigger').click(function(){
    textIndentFunc();
    alert('fire');
 });
});

function textIndentFunc () {

     textString = $('#from-1 :selected').text();

     $('#hidden').text(textString);

     textWidth = $('#hidden').width();

     inputWidth = $('#from-1 select').width();

     indentMy = (inputWidth / 2) - (textWidth / 2);

    $('#from-1').css('text-indent',indentMy);

}
textIndentFunc();
```

```
<div id="trigger">Hai</div>
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:47:20.797

您是否还有另一个在页面加载时运行的功能？因为如果是这种情况，可能这两个函数有冲突......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-14T15:49:44.073

如果您已经拨打电话但仍未收到您所期望的，请`textIndendFunc`尝试转至.`$(document).ready``textIndentFunc``$(window).load`

# php - 当前日期 + 2 个月

> ID：10586615
> 
> 赞同：22
> 
> 时间：2012-05-14T15:43:43.890
> 
> 标签：php, date, strtotime

我编写了这段代码以显示当前日期 + 2 个月：

```
<?php
    $date = date("d/m/Y");
    $date = strtotime(date("d/m/Y", strtotime($date)) . "+2 months");
    $date = date("d/m/Y",$date);
    echo $date;
?> 
```

它似乎不起作用，因为它显示：01/03/1970。

我究竟做错了什么？

谢谢你的帮助。

编辑 ：

阅读评论和答案后，我对其进行了简化和更正。

```
<?php
    $date = date("d/m/Y", strtotime(" +2 months"));
    echo $date;
?> 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-14T15:45:02.407

您缺少第二次`strtotime()`调用的第二个参数：

```
echo date('d/m/Y', strtotime('+2 months')); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-14T15:44:51.900

尝试使用[DateTime 对象](http://us3.php.net/manual/en/book.datetime.php)：

```
$date = new DateTime("+2 months");
echo $date->format("d/m/Y"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-07-28T03:48:34.737

如果今天是“YYYY-mm-31”，而下个月没有第31天，则显示下个月该天，使系统显示“+3个月”的结果，而不是“+2个月”的结果。

所以我想这是最安全的：

```
$end_date=date("Y-m-d",strtotime("+2 month",strtotime(date("Y-m-01",strtotime("now") ) ))); 
```

首先将日期更改为第一天。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-03-11T14:45:28.847

使用**[DateTime->add()](http://us3.php.net/manual/en/datetime.add.php)**或**[DateTime->modify()](http://us3.php.net/manual/en/datetime.modify.php)**

如果您正在使用现有的 DateTime 对象，则可以使用以下之一：

```
// Your date
$date = new DateTime(); // empty for now or pass any date string as param

// Adding
$date->add(new DateInterval('P2M')); // where P2M means "plus 2 months"

// or even easier
$date->modify('+2 months');

// Checking
echo $date->format('Y-m-d'); 
```

**注意**PHP 中添加月份，如果原始日期中的天数大于新月份的总天数，可能会溢出到下个月。添加年份时，闰年也会发生同样的溢出。不知何故，PHP 开发人员不认为这是一个错误，只是在没有解决方案的情况下记录在案。更多信息： [PHP DateTime::modify 添加和减去月份](https://stackoverflow.com/questions/3602405/php-datetimemodify-adding-and-subtracting-months)

我发现这是解决溢出问题的最直接的解决方案：

```
$day = $date->format('j');
$date->modify('first day of +2 months')->modify('+'. (min($day, $date->format('t')) - 1) .' days'); 
```

# list - VBA中分离工作表中的动态依赖列表

> ID：10586616
> 
> 赞同：1
> 
> 时间：2012-05-14T15:43:45.010
> 
> 标签：list, excel, dynamic, worksheet, vba

我不是真正的 VBA 专家，我的代码有问题，我不知道如何解决。（代码来自：[http](http://siddharthrout.wordpress.com/2011/07/29/excel-data-validationcreate-dynamic-dependent-lists-vba/) ://siddharthout.wordpress.com/2011/07/29/excel-data-validationcreate-dynamic-dependent-lists-vba/ ）

我正在使用 8 个动态依赖列表，并且我认为如果我修改列表，那么自动化该过程并避免在将来修改宏的最佳方法是 VBA 代码。

试图找到正确的代码，我只是在处理列表。之后，将其应用于所有列表。

我检查了代码，发现存在错误（对象“_global”的方法“相交”失败），因为我正在比较来自不同工作表的两个范围。

我的代码是：

```
Private Sub Worksheet_Change(ByVal Target As Range)

Dim i As Long, LastRow As Long, n As Long
Dim MyCol As Collection
Dim SearchString As String, Templist As String

Application.EnableEvents = False

On Error GoTo Whoa

' Find LastRow in Col A
LastRow = Sheet2.Range("A" & Rows.Count).End(xlUp).Row

If Not Intersect(Target, Sheet2.Columns(1)) Is Nothing Then
Set MyCol = New Collection

' Get the data from Col A into a collection
For i = 2 To LastRow
    If Len(Trim(Sheet2.Range("A" & i).Value)) <> 0 Then
        On Error Resume Next
        MyCol.Add CStr(Sheet2.Range("A" & i).Value), CStr(Sheet2.Range("A" & i).Value)
        On Error GoTo 0
    End If
Next i

' Create a list for the Data Validation List
For n = 1 To MyCol.Count
    Templist = Templist & "," & MyCol(n)
Next

Templist = Mid(Templist, 2)

Range("A2").ClearContents: Range("A2").Validation.Delete

' Create the Data Validation List
If Len(Trim(Templist)) <> 0 Then
    With Range("A2").Validation
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=Templist
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
End If

' Capturing change in cell A2
ElseIf Not Intersect(Target, Range("A2")) Is Nothing Then
SearchString = Range("A2").Value

Templist = FindRange(Sheet2.Range("A2:A" & LastRow), SearchString)

Range("B2").ClearContents: Range("B2").Validation.Delete

If Len(Trim(Templist)) <> 0 Then
    ' Create the DV List
    With Range("B2").Validation
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=Templist
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
End If
End If
LetsContinue:
Application.EnableEvents = True
Exit Sub
Whoa:
MsgBox Err.Description
Resume LetsContinue
End Sub

' Function required to find the list from Col B
Function FindRange(FirstRange As Range, StrSearch As String) As String
Dim aCell As Range, bCell As Range, oRange As Range
Dim ExitLoop As Boolean
Dim strTemp As String

Set aCell = FirstRange.Find(what:=StrSearch, LookIn:=xlValues, lookat:=xlWhole, SearchOrder:= _
xlByRows, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)

ExitLoop = False

If Not aCell Is Nothing Then
    Set bCell = aCell
    strTemp = strTemp & "," & aCell.Offset(, 1).Value
    Do While ExitLoop = False
        Set aCell = FirstRange.FindNext(After:=aCell)

        If Not aCell Is Nothing Then
            If aCell.Address = bCell.Address Then Exit Do
            strTemp = strTemp & "," & aCell.Offset(, 1).Value
        Else
            ExitLoop = True
        End If
    Loop
    FindRange = Mid(strTemp, 2)
End If
End Function 
```

进入Sheet1，我只想让单元格选择列表选项，进入Sheet2，我想要所有动态和依赖列表。

是否有可能使用这些算法比较来自不同工作表的两个范围？或者为 8 个依赖和动态列表创建选择列表的替代代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T15:29:26.010

我将带你到这个页面，这个页面很好地描述了动态依赖列表的用法。 [动态依赖列表](http://excelsemipro.com/2011/05/a-dynamic-dependent-drop-down-list-in-excel/)

也许您根本不需要 VBA，除非您必须即时更改这些内容，或者基于其他一些变量。最好先使用 Excel 的内置功能，然后再使用代码。

如果您正在徘徊，您可以通过将命名范围范围设置为整个工作簿来绕过在两个不同工作表上的列表。

编辑：添加对直接 VBA 错误的答案。

既然您没有说，不确定您的 Intersect 是否在这里中断：

```
If Not Intersect(Target, Sheet2.Columns(1)) Is Nothing Then 
```

但我认为是。试试这个：

```
If Not Intersect(Target, Columns(1).EntireColumn) Is Nothing Then 
```

# caching - C# Cache of Object 引用字符串

> ID：10586619
> 
> 赞同：0
> 
> 时间：2012-05-14T15:44:07.227
> 
> 标签：caching, c#-4.0

这是我无法相信的事情，但它正在发生。

我有以下代码：

```
public class UserData
{
  public string displayname;
  public int age;
}

UserData ud = new UserData();
ud.displayname = "bar";
ud.age = 2;

HttpContext.Current.Cache.Insert("foo", ud, null, DateTime.Now.AddMinutes(20), TimeSpan.Zero, CacheItemPriority.Normal, null);

UserData lud = HttpContext.Current.Cache["foo"];

HttpContext.Current.Trace.Write("displayname",ud.displayname); 
```

猜猜输出是什么？

```
"bar" 
```

引！！！！ *（int 字段不受影响，它以 int 形式返回，不带引号等...）*

这是为什么？我在 MSDN 和谷歌上搜索无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T11:23:05.790

使用 ashx 页面查看输出。

# bash - 为什么管道到同一个文件在某些 平台上不起作用？

> ID：10586623
> 
> 赞同：5
> 
> 时间：2012-05-14T15:44:28.287
> 
> 标签：bash, pipeline, overwrite, io-redirection, in-place

在 cygwin 中，以下代码可以正常工作

```
$ cat junk
bat
bat
bat

$ cat junk | sort -k1,1 |tr 'b' 'z' > junk

$ cat junk
zat
zat
zat 
```

但是在linux shell（GNU/Linux）中，覆盖似乎不起作用

```
[41] othershell: cat junk
cat
cat
cat
[42] othershell: cat junk |sort -k1,1 |tr 'c' 'z'
zat
zat
zat
[43] othershell: cat junk |sort -k1,1 |tr 'c' 'z' > junk
[44] othershell: cat junk 
```

两种环境都运行 BASH。

我问这个是因为有时在我进行文本操作之后，由于这个警告，我不得不制作 tmp 文件。但我知道在 Perl 中，您可以在一些操作/操作后给出“i”标志来覆盖原始文件。我只是想问一下unix管道中是否有任何万无一失的方法来覆盖我不知道的文件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-14T20:38:52.403

这里有四个要点：

1.  *“猫*没用。” 不要那样做。
2.  您实际上并没有使用 sort 对任何内容进行*排序*。不要那样做。
3.  您的管道没有说出您认为的内容。不要那样做。
4.  您试图在读取文件时就地覆盖文件。不要那样做。

您获得不一致行为的原因之一是您正在管道到具有重定向的进程，而不是重定向整个管道的输出。区别很微妙，但很重要。

您想要的是使用[Command Grouping](http://www.gnu.org/software/bash/manual/html_node/Command-Grouping.html#Command-Grouping)创建一个复合命令，以便您可以重定向整个管道的输入和输出。在您的情况下，这应该可以正常工作：

```
{ sort -k1,1 | tr 'c' 'z'; } < junk > sorted_junk 
```

请注意，如果没有任何要排序的内容，您也可以跳过*排序*命令。然后您的命令可以在不需要命令分组的情况下运行：

```
tr 'c' 'z' < junk > sorted_junk 
```

保持重定向和管道尽可能简单。它使调试脚本变得更加容易。

但是，如果您出于某种原因仍想滥用管道，则可以使用**moreutils**包中的*海绵*实用程序。手册页说：

 **> 海绵读取标准输入并将其写入指定文件。与 shell 重定向不同，海绵在打开输出文件之前会吸收所有输入。这允许限制读取和写入同一文件的管道。

因此，您的原始命令行可以像这样重写：

```
cat junk | sort -k1,1 | tr 'c' 'z' | sponge junk 
```

并且由于在海绵从管道接收到 EOF 之前不会覆盖垃圾，因此您将获得预期的结果。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-14T15:48:43.997

一般来说，这可能会被打破。管道中的进程都是并行启动的，因此`> junk`行尾的通常会在流水线头部的进程完成（甚至开始）读取输入文件之前截断输入文件。

即使 Cygwin 下的 bash 让你摆脱了这个，你也不应该依赖它。一般的解决方案是重定向到一个临时文件，然后在管道完成时重命名它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-14T23:09:45.523

你想编辑那个文件，你可以使用编辑器。

```
ex junk << EOF
%!(sort -k1,1 |tr 'b' 'z')
x
EOF 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-20T11:15:43.027

在管道中覆盖相同的文件不是建议，因为当你犯了错误时，你无法取回它（除非你有备份或者它是受版本控制的）。

发生这种情况是因为管道中的输入和输出是自动缓冲的（这给您一个有效的印象），但实际上它是并行运行的。不同的平台可以以不同的方式缓冲输出（基于设置），所以在一些平台上你最终会得到空文件（因为文件将在开始时创建），在另一些平台上会有半成品文件。

解决方案是在文件仅在遇到具有完整缓冲和处理输入的 EOF 时才被覆盖时使用某种方法。

这可以通过以下方式实现：

*   使用可以在打开输出文件之前吸收所有输入的实用程序。

    这可以通过`sponge`（与`unbuffer`from `expect`package 相反）来完成。

*   避免使用 I/O 重定向语法（它可以在启动命令之前创建空文件）。

    例如使用`tee`（缓冲其标准流），例如：

    ```
    cat junk | sort | tee junk 
    ```

    这仅适用于`sort`，因为它希望所有输入都处理排序。因此，如果您的命令不使用`sort`，请添加一个。

    可以使用的另一个工具是`stdbuf`修改其标准流的缓冲操作，您可以在其中指定缓冲区大小。

*   使用可以就地编辑文件的文本处理器（例如`sed`或`ex`）。

    例子：

    ```
    $ ex -s +'%!sort -k1' -cxa myfile.txt
    $ sed -i '' s/foo/bar/g myfile.txt 
    ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-19T13:47:22.197

使用下面的简单脚本，你可以让它像你想要的那样工作：

```
$ cat junk | sort -k1,1 |tr 'b' 'z' | overwrite_file.sh junk 
```

### 覆盖文件.sh

```
#!/usr/bin/env bash

OUT=$(cat -)

FILENAME="$*"

echo "$OUT" | tee "$FILENAME" 
```

请注意，如果您不希望将更新后的文件发送到标准输出，则可以改用此方法

### overwrite_file_no_output.sh

```
#!/usr/bin/env bash

OUT=$(cat -)

FILENAME="$*"

echo "$OUT" > "$FILENAME" 
```**

# php - 使用 PHP SDK 的 Facebook 应用程序身份验证

> ID：10586625
> 
> 赞同：0
> 
> 时间：2012-05-14T15:44:33.893
> 
> 标签：php, facebook, authentication, facebook-php-sdk

我目前正在尝试为 Facebook 创建一个画布应用程序，并且我正在尝试获取它，以便用户必须验证他们想要在应用程序运行之前对其进行授权。

我正在尝试使用 PHP SDK 执行此操作，但到目前为止无济于事。

有没有办法自动重定向以检查用户是否已对应用程序进行身份验证？

谢谢，斯科特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T08:10:15.427

您可以查看本教程[http://thinkdiff.net/facebook/graph-api-iframe-base-facebook-application-development-php-sdk-3-0/](http://thinkdiff.net/facebook/graph-api-iframe-base-facebook-application-development-php-sdk-3-0/)这是一个不错的入门教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:47:33.400

如果您向 facebook 请求应用程序身份验证，并且该应用程序已被用户授权，则身份验证窗口不会再次显示。它直接返回一个令牌。

# asp.net - 在 TFS 中为 Dot Net Nuke 网站设置 AutoDeployment 的最佳方法是什么

> ID：10586644
> 
> 赞同：0
> 
> 时间：2012-05-14T15:45:32.587
> 
> 标签：asp.net, vb.net, deployment, dotnetnuke

我正在寻找一种在签入后通过 TFS 自动部署 Dot Net Nuke 网站的方法。我还需要了解如何将 Web 配置转换为部署服务器的正确连接。

由于这是一个网站而不是 Web 应用程序，因此事情变得棘手。如果你以前做过，请给我一些想法。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:58:26.273

我没有使用 TFS 进行自动部署，但使用 SVN 自动执行了该过程。我们所做的只是让脚本部署自上次登录到 Web 服务器后发生的所有更改——除了 web.config。

数据库脚本由这样的过程处理，但它们不如 SVN 代码部署可靠。

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T05:53:16.740

您可以使用部署工具，例如[kwatee](http://www.kwatee.net)（自我提升）。Kwatee 通过 Web GUI 进行配置，然后可以通过 python 脚本部署任何应用程序或站点，并在此过程中转换文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T17:37:42.790

您可以使用 Visual Studio Web 部署功能。ALM Rangers 为此目的提供了一个随时可用的 BRDLite 参考模板，您可以[在此处](http://vsarbuildguide.codeplex.com/releases/82962/download/347183)下载。此外，请查看此[链接](http://vsarbuildguide.codeplex.com/releases/82962/download/347182)以获取有关模板使用的文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-23T19:02:03.133

如果您使用的是 VS2010，则可以在解决方案中使用 Web 部署项目。TFS 将与 WDP 对话，就像与 Web 应用程序的项目文件对话一样。

对于配置转换，您可以使用名为 SlowCheetah 的工具。

# php - 是否可以使用 PHP 同时更新屏幕并等待用户输入？

> ID：10586646
> 
> 赞同：7
> 
> 时间：2012-05-14T15:45:34.663
> 
> 标签：php

我想编写一个小型管理工具来监督我的服务器进程，我现在的问题是，我如何等待用户输入并同时使用当前统计信息更新屏幕？甚至可以使用 PHP-CLI 或者我目前缺少的任何技巧？

我已经研究过 newt 和 ncurses PECL 扩展，但两者似乎都不符合我的需求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T10:11:55.310

去 libevent [http://www.php.net/manual/en/book.libevent.php](http://www.php.net/manual/en/book.libevent.php)

您可以在听控制台的同时运行您的主循环，代码大致如下：

```
<?php   
// you need libevent, installable via PEAR
$forever=true;
$base=event_base_new();
$console=event_buffer_new(STDIN,"process_console");
event_buffer_base_set($console,$base);
event_buffer_enable($console,EV_READ);
while ($forever) {
    event_base_loop($base,EVLOOP_NONBLOCK); // Non blocking poll to console listener
    //Do your video update process
}
event_base_free($base); //Cleanup
function process_console($buffer,$id) {
    global $base;
    global $forever;
    $message='';
    while ($read = event_buffer_read($buffer, 256)) {
        $message.=$read;
    }
    $message=trim($message);
    print("[$message]\n");
    if ($message=="quit") {
        event_base_loopexit($base);
        $forever=false;
    }
    else {
        //whatever.....
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T06:17:52.620

我不认为你可以用 PHP CLI 做到这一点。据我所知，使用 PHP 解释脚本时，您只能查看最终输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T03:19:54.987

我认为您确实想要ncurses。如果您可以在[此处](http://tldp.org/HOWTO/NCURSES-Programming-HOWTO/keys.html)转换简单的示例 C 代码，您应该能够使用 PHP 包装器进行转换，那么您将拥有解决问题的“引导程序”。

确保在某处写博客！:)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-15T08:33:44.000

我的建议是尽量避免任何涉及在退出 PHP 时保持进程运行的解决方案。这是一个非常简单的示例，说明如何使用一些 jQuery 来完成它：

```
window.setInterval(checkstat, 10000); //10 second interval

function checkstat() {

    //Change a div with id stat to show updating (don't need this but it's nice)
    $('#stat').html('Updating...'); 

    $.get('/getmystats.php?option=blah', function(data) {
        //Update the results when the data is returned.
        $('#stat').html(data);
    });

} 
```

如果您需要更新页面上的多个区域，您可以进行一次调用但返回 JSON 或 XML，然后根据需要填充位。

# ruby-on-rails - 渲染特定的模型 ID？

> ID：10586647
> 
> 赞同：1
> 
> 时间：2012-05-14T15:45:35.513
> 
> 标签：ruby-on-rails

我希望以模型为例（在本例中为*Book*），并通过 ID 呈现该模型的特定实例。

该模型只是一个基本的脚手架生成模型——通常的`show`方法；

```
def show
    @book = Book.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @book }
    end
  end 
```

我希望在视图中嵌入这个实例：

```
<div class="tab-pane active" id="tab1">
    <%= render :template "books/show", :book => 1 %>
</div> 
```

我可以说我在这里做错了。但我不知道从哪里开始！非常感谢任何帮助。我知道我需要以某种方式传递图书 ID，但我不知道该怎么做。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:50:53.480

`<%= render :template "books/show", :book => 1 %>`只呈现部分，它不*加载*页面。
例如，您需要做的是`"books/show/#{book_id}"`从 iframe 调用路由。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:54:45.427

也许？

```
<div class="tab-pane active" id="tab1">
  <%= render 'books/show', book: @book %>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T15:52:41.427

您在控制器中创建的变量@book 会自动显示在模板中。因此，如果您的模板 show.html.erb 放置在正确的位置，那么

```
<%= @book.title %> 
```

应该呈现文本（我假设这本书在这里有一个属性标题）。

我不确定您提供的 html 位于何处。它在 show.html.erb 中没有意义，因为您实际上是从那里引用该文件。如果您想呈现一本书的链接，那么您应该这样做

```
<%= link_to 'Link text', book_path(1) %> 
```

# r - R - 使用匹配运算符时保留顺序 (%in%)

> ID：10586652
> 
> 赞同：6
> 
> 时间：2012-05-14T15:45:53.050
> 
> 标签：r, operators

我正在使用匹配运算符从单独的数据框中获取出现在矩阵中的值。但是，结果矩阵的值按照它们在数据框中出现的顺序排列，而不是在原始矩阵中。有没有办法使用匹配运算符保留原始矩阵的顺序？

这是一个简单的例子：

```
vec=c("b","a","c"); vec

df=data.frame(row.names=letters[1:5],values=1:5); df

df[rownames(df) %in% vec,1] 
```

这产生了出现在数据框中`> [1] 1 2 3`的顺序。`"a" "b" "c"`但是，我想生成`>[1] 2 1 3`它们在原始向量中出现的顺序。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T16:01:21.943

使用`match`.

```
df[match(vec, rownames(df)), ]
# [1] 2 1 3 
```

请注意，如果您在`vec`或中有重复值`rownames(df)`，`match`则可能不会按预期运行。

**编辑：** 我刚刚意识到行名索引将更简单优雅地解决您的问题：

```
df[vec, ]
# [1] 2 1 3 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T15:55:04.983

使用[match](http://stat.ethz.ch/R-manual/R-devel/library/base/html/match.html)（并为在另一个向量中不匹配的元素去掉 NA 值）：

```
Filter(function(x) !is.na(x), match(rownames(df), vec)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-03T22:58:02.297

由于行名索引也适用于向量，我们可以更进一步并定义：

```
'%ino%' <- function(x, table) {
    xSeq <- seq(along = x)
    names(xSeq) <- x
    Out <- xSeq[as.character(table)]
    Out[!is.na(Out)]
} 
```

我们现在得到了想要的结果：

```
df[rownames(df) %ino% vec, 1]
[1] 2 1 3 
```

在函数内部，names() 会自动转换为字符，并使用 as.character() 更改表，因此当 %ino% 的输入是数字时，这也可以正常工作：

```
LETTERS[1:26 %in% 4:1]
[1] "A" "B" "C" "D"

LETTERS[1:26 %ino% 4:1]
[1] "D" "C" "B" "A" 
```

在 %in% 之后，删除缺失值：

```
LETTERS[1:26 %in% 3:-5]
[1] "A" "B" "C"

LETTERS[1:26 %ino% 3:-5]
[1] "C" "B" "A" 
```

使用 %in% 时，逻辑序列会沿着被子集化的对象的维度重复，而 %ino% 则不是这样：

```
data.frame(letters, LETTERS)[1:5 %in% 3:-5,] 

    letters LETTERS
 1        a       A
 2        b       B
 3        c       C
 6        f       F
 7        g       G
 8        h       H
 11       k       K
 12       l       L
 13       m       M
 16       p       P
 17       q       Q
 18       r       R
 21       u       U
 22       v       V
 23       w       W
 26       z       Z

data.frame(letters, LETTERS)[1:5 %ino% 3:-5,]

   letters LETTERS
 3       c       C
 2       b       B
 1       a       A 
```

# vba - 无法从 VBA 函数返回值

> ID：10586654
> 
> 赞同：3
> 
> 时间：2012-05-14T15:45:59.333
> 
> 标签：vba, excel, ms-office

我正在尝试从我的代码中返回一个值。只显示代码要容易得多：

```
Function writeHeaderData() As IXMLDOMNode

    Dim xmlDoc As New MSXML2.DOMDocument30
    xmlDoc.async = False
    xmlDoc.LoadXML "<Foo></Foo>"
    Dim Foo As IXMLDOMNode
    Set Foo = xmlDoc.DocumentElement

    'code snip; includes appending lots of things to Foo

    'the error is on this line:
    writeHeaderData = Foo
    Exit Function

End Function 
```

我已经用谷歌搜索了，但没有用。这个函数是从主子例程调用的，我试图将返回的 IXMLDOMNode 附加到一个更大的函数，但我一直收到一个`"Object variable or With block variable not set`“错误” `writeHeaderData = Foo`。这是怎么回事？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T16:05:20.663

在VB(A)中，当你想给一个**对象**变量赋值时，*包括*给一个函数的返回值赋值，你需要使用`Set`，所以：

```
'the error is on this line:
writeHeaderData = Foo 
```

应该

```
Set writeHeaderData = Foo 
```

# c++ - Qt 单槽多 webview 处理

> ID：10586656
> 
> 赞同：0
> 
> 时间：2012-05-14T15:46:02.520
> 
> 标签：c++, c, multithreading, qt, qwebview

```
#include <QWebView>
#include <QObject>

class MyWebview  : public QObject {
    Q_OBJECT

private:
    QWebView *v1, *v2, *v3, *v4;

public:
    MyWebview() {
        v1 = new QWebView(0);
        v2 = new QWebView(0);
        v3 = new QWebView(0);
        v4 = new QWebView(0);

        v1->load(QUrl("http://google.com"));
        v2->load(QUrl("http://facebook.com"));
        v3->load(QUrl("http://bing.com"));
        v4->load(QUrl("http://twitter.com"));

        connect(v1, SIGNAL(loadFinished(bool)), this, SLOT(finished(bool)));
        connect(v2, SIGNAL(loadFinished(bool)), this, SLOT(finished(bool)));
        connect(v3, SIGNAL(loadFinished(bool)), this, SLOT(finished(bool)));
        connect(v4, SIGNAL(loadFinished(bool)), this, SLOT(finished(bool)));
    }

public slots:
    void    MyWebview::finished(bool ok)    {   // [ SLOT ]
        switch( /**/ ) {
            case /*if it is v1*/:
            disconnect(v1, SIGNAL(loadFinished(bool)), this, SLOT(finished(bool)));
            break;

        case /*if it is v2*/:
            disconnect(v2, SIGNAL(loadFinished(bool)), this, SLOT(finished(bool)));
            break;

        case /*if it is v3*/:
            disconnect(v3, SIGNAL(loadFinished(bool)), this, SLOT(finished(bool)));
            break;

        case /*if it is v3*/:
            disconnect(v4, SIGNAL(loadFinished(bool)), this, SLOT(finished(bool)));
            break;
        }

        // do something..
    }
} 
```

如何解决这种情况？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:59:25.610

使用[QSignalMapper](http://qt-project.org/doc/qt-4.8/qsignalmapper.html)。它允许您识别信号的发送者。

# ant - 如何使用 Ant 找到特定的子目录，然后使用它来创建符号链接？

> ID：10586659
> 
> 赞同：0
> 
> 时间：2012-05-14T15:46:08.723
> 
> 标签：ant

我需要使用 Ant 创建指向子目录的符号链接。问题是我不知道目标子目录在哪里。

要使用 ant 创建符号链接，我这样做：

```
<symlink link="${parent.dir}/FOO/linkname" resource="${parent.dir}/BAR/target"/> 
```

但我不知道提前调用什么 BAR，所以我需要在 parent.dir 下搜索“目标”，然后将一个结果传递到资源中。

这可能使用文件集吗？还是另一种方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:02:00.777

可能可以使用文件集，但这可能会给您几个符号链接或没有。

更好的方法是`BAR`在属性中定义路径。如果此路径中有动态部分，请更改代码，以便 Ant 评估动态部分，而其他所有人都使用 Ant 的值。

这里的典型示例是路径包含版本或时间戳。在您的构建文件中定义它们，以便您可以在任何地方使用它们。如果 Java 进程需要这些值，请将它们作为系统属性 ( ) 传递给进程`-D...`。

# mysql - 将杂项数据存储在 DB 表行中

> ID：10586661
> 
> 赞同：0
> 
> 时间：2012-05-14T15:46:15.420
> 
> 标签：mysql, sql, database, row, separator

假设我需要在数据库表中存储一些未知数量的数据。我不想创建额外的表，因为这将花费更多时间来获取数据。数据量可以不同。

我最初的想法是以某种格式存储数据，但这里的问题是它的主体中`key1=value1;key2=value2;key3=value3`可以包含一些值。`;`在这种情况下，最好的分隔符是什么？我可以使用哪些其他方法来将各种数据存储在一行中？

行的示例内容就像`data=2012-05-14 20:07:45;text=This is a comment, but what if I contain a semicolon?;last_id=123456`在使用分隔符正确分解行文本后，我可以从中通过 PHP 获得一个具有相应键和值的数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:52:45.260

**首先：如果您需要单独访问它们或通过其中一个进行搜索，**您永远不会在一个字段中存储多个信息。这已经在这里讨论过很多次了。

假设您都想一次访问完整的信息集合，我建议使用您的开发环境的本机序列化格式：例如，如果是 PHP，则使用`serialze()`.

如果它是跨平台的，JSON 可能是一种可行的方法：良好的 JSON 编码/解码库适用于所有环境。XML 也是如此，但在他的上下文中，XML 的文本开销会有点小。

旁注：您确定将数据存储在其他表中会更慢吗？您可能希望在最终决定之前对其进行基准测试。

**编辑：**

阅读后，您使用 PHP：如果您不想将其放在表格中，请坚持使用`serialize()`/`unserialize()`和`MEDIUMTEXT`字段，这非常有效，我一直这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:17:01.173

EAV ( *cringe* ) 可能是存储任意值的最佳方式，但无论出于何种原因，听起来您都坚决反对附加表。鉴于此，您可以将 json_encode 的结果保存在表中。当您读回它时，只需 json_decode 将其放回数组中。

请记住，如果您需要在此字段中搜索任何内容，您将不得不使用 SQL LIKE。如果您**从**不需要搜索此字段或将其加入任何内容，我想没关系，但如果您这样做，您就完全将性能抛到了窗外。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-14T15:54:19.750

它可以是分隔它们的引号。

```
key1='value1';key2='value2';key3='value3' 
```

如果不是这样，请给出您的 sql 示例，我们可以看看如何去做。

# java - 私有变量是否与私有类中的包/默认/无修饰符变量具有相同的访问权限？

> ID：10586662
> 
> 赞同：2
> 
> 时间：2012-05-14T15:46:16.900
> 
> 标签：java, variables, private

私有变量是否与私有类中的包/默认/无修饰符变量具有相同的访问权限？

```
public class PublicClass {

    public void test() {

        InnerClass in = new InnerClass();

        in.name1 = "a";
        in.name2 = "b";

        in.getName1();
        in.getName2();

    }

    private class InnerClass {

        private String name1;
        String name2;

        private String getName1() {
            return name1;
        }

        String getName2() {
            return name2;
        }

    }

} 
```

方法 test 可以访问 name1 和 name2，那么，在私有类的变量上设置 private 的目的是什么？

更新：private 关键字实际上如何禁止访问的代码示例会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:48:51.910

私有成员可以在顶级封闭类中的任何地方访问，即`PublicClass`在[JLS 6.6.1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-6.html#jls-6.6.1)中定义：

> 如果成员或构造函数被声明为私有，则当且仅当它出现在包含成员或构造函数声明的顶级类（第 7.6 节）的主体内时，才允许访问。

所以没有办法阻止方法访问内部类的私有成员。

由于您的内部类是私有的，您可以按照您想要的方式声明其成员（包括公共），它们只能在`OuterClass`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:58:48.617

`private`表示/允许在同一（顶级）类中访问。您正在使用内部类...

来自 Java 语言规范：

> 私有类成员或构造函数只能在顶级类的主体内访问（第 7.6 节）

[http://docs.oracle.com/javase/specs/jls/se7/html/jls-6.html#jls-6.6.1](http://docs.oracle.com/javase/specs/jls/se7/html/jls-6.html#jls-6.6.1)

所以在这种情况下，在内部私有类中声明方法/字段私有的用处不大。如果您移动`InnerClass`主体的外部`PublicClass`（仍然可以将它放在同一个文件中，但不能将类声明为私有），您将看到不同之处。

# python - 时间序列的 Python 绘图

> ID：10586663
> 
> 赞同：2
> 
> 时间：2012-05-14T15:46:18.307
> 
> 标签：python, linux, graphing

我有一个需要图形数据的项目（使用 Python）。rrdtool 似乎几乎正是我所需要的——除了它只支持 1 秒分辨率而且我的数据点更接近。

GNUPlot 看起来像一头野兽。我还没有深入研究它，但粗略一瞥，它似乎更适合图形表达，而不是快速学习的东西。

是否有另一个（希望相对容易使用）图形系统为时间序列量身定制或易于适应？如果没有比 GNUplot 更好的了，我将开始深入研究它——我只是想确定没有其他东西我应该考虑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T15:48:26.757

我以前使用过[PyX](http://pyx.sourceforge.net/)。当我需要绘制各种数据时，它很好地满足了我的目的。

还有[matplotlib](http://matplotlib.sourceforge.net/)，这是一个非常流行的 Python 绘图库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:30:10.343

您没有完全指定您要查找的内容，但这里有一个快速剪切和粘贴示例，它显示了`matplotlib`. 该示例还将图像保存为 png 和 pdf（分别为光栅化和矢量化）：

```
import numpy as np
import pylab as plt

# Create some sample "time-series" data
N = 200
T = np.linspace(0, 5, N)
Y1 = T**2 - T*np.cos(T*5) + np.random.random(N)
Y2 = T**2 - T*np.sin(T*5) + np.random.random(N)

pargs = {"lw":5, "alpha":.6}

plt.plot(T,Y1, 'r',**pargs)
plt.plot(T,Y2, 'b', **pargs)

skip = 30
plt.scatter(T[::skip],Y2[::skip], color='k', s=200, alpha=.6)

plt.xlabel("time")
plt.ylabel("money")
plt.axis('tight')

# Save as a png and a pdf
plt.savefig("example.png")
plt.savefig("example.pdf")

plt.show() 
```

![在此处输入图像描述](../Images/4d6bb9cfa4b1ef1cb9d7a123311c3fee.png)

# c# - 如何将序列号打印到 Crystal Reports - WPF C#

> ID：10586667
> 
> 赞同：0
> 
> 时间：2012-05-14T15:46:43.750
> 
> 标签：c#, wpf, crystal-reports

我有一个 WPF 应用程序，可以在其中打印产品标签。有时，我必须打印多份同一个标签。但是每个副本的序列号会有所不同。我有一个数据库表，它跟踪打印的最后一个序列号。我怎样才能使用公式做到这一点？

目前我使用的公式如下：

```
WhilePrintingRecords;
numbervar slno = ToNumber ({CustomerApp_TblBagLabel.TransactionNo});
slno := slno + 1; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:19:07.153

Crystal Reports 不会更新数据库（根据设计）。

在您的情况下，我建议采用以下方法（伪代码）：

```
begin transaction;

retrieve and increment transaction #;

open report;

pass transaction # to report (via a parameter would be easiest);

print report;

if report prints successfully then
  commit;
else
 rollback;
end if 
```

# r - 从 d_ply 中访问分组变量

> ID：10586668
> 
> 赞同：4
> 
> 时间：2012-05-14T15:46:45.980
> 
> 标签：r, plyr

我刚刚发现了这个很棒的`plyr`包裹，正在试一试。

我有一个问题如下：有没有办法从内部访问分组变量`d_ply`？

假设我有一个`df`带有列的数据框`x,y,z`，我想为每个`z`值`x`与`y`. 如果我执行以下操作：

```
plotxy = function(df, ...) {plot(df$x, df$y, ...)}
d_ply(df, .(z), plotxy(df, main=.(z))) 
```

那么显示在图上的标题都是“z”，而不是 z 变量的值。有没有办法从内部访问这些值`d_ply`？

编辑：正如@Justin 指出的那样，上述表述是错误的，因为我将整个`df`to传递给`plotxy`. 因此这条线

```
d_ply(df, .(z), plotxy(df, main=.(z))) 
```

应该

```
d_ply(df, .(z), plotxy, main=.(z)) 
```

为了使我原来的问题有意义（我想这也是@joran 所暗示的）。

然而，我意识到了另一件事。即使被`df`切片，函数接收的子数据帧仍然有一列——只是总是具有相同的值。因此，问题显然可以解决如下：`z``d_ply``z`

```
plotxy = function(df, ...) {plot(df$x, df$y, main=df$z[1])}
d_ply(df, .(z), plotxy) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T16:29:26.953

举例来说，我将扩展 Joran 的关注点。

```
df <- data.frame(x=rnorm(100), y=rnorm(100), z=letters[1:10]) 
```

让我们使用你的函数，看看我们在没有 plyr 的情况下得到了什么：

```
plotxy(df, main=.(z)) 
```

与可能更预期的（？）相比：

```
plotxy(df, main=df$z) 
```

但是，在您的代码中，您将在 z 上拆分数据帧，然后将*整个 data.frame df*再次发送到您的函数。相反，您可以创建一个包装函数：

```
d_ply(df, .(z), function(ply.df) plotxy(ply.df, main=unique(ply.df$z))) 
```

这样，该`plotxy`函数只能看到您通过包装函数传递的较小的拆分 data.frame ply.df。

# asterisk - MixMonitor - 如何使用 lame 转换然后删除源文件？

> ID：10586670
> 
> 赞同：0
> 
> 时间：2012-05-14T15:47:01.427
> 
> 标签：asterisk, agi

通话结束后如何删除源 wav 文件？如果我必须使用 AGI，我可以有一个示例脚本吗？

这就是我使用 MixMonitor exten => s,n,MixMonitor(${source_file}.wav,W(1),lame -V3 ${source_file}.wav ${mp3_from_source}.mp3) 的方式

失败，因为它在转换之前被删除。exten => h,n,System(rm ${source_file}.wav)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T03:22:11.240

老实说，你需要停止创造性。只需将系统级呼叫作为单独的拨号计划线路执行。mixmonitor 一行，lame 一行，验证 lame 的返回值，然后删除。这就是我在我的应用程序中所做的，并且效果很好。您不需要将转换过程的每一步都合并到一个拨号方案行中。

我使用这个命令行：

```
 /usr/local/bin/lame -b16 --noshort "/var/spool/asterisk/monitor/$1.wav" "/var/www/html/asterisk/calls/$1.mp3" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T10:38:53.033

怎么样：

```
exten => s,n,MixMonitor(${source_file}.wav,W(1),lame -V3 ${source_file}.wav ${mp3_from_source}.mp3 && rm ${source_file}.wav) 
```

并跳过电话`h`？

# javascript - Object(o) 的合法使用

> ID：10586673
> 
> 赞同：4
> 
> 时间：2012-05-14T15:47:29.350
> 
> 标签：javascript, theory

当向构造函数提供对象值时`Object`，该值将原封不动地返回。所以，给定一个对象`obj`：

```
obj === new Object( obj ) 
```

和

```
obj === Object( obj ) 
```

那么，当初做的意义`Object( obj )`何在？我可以理解做`Object( 'foo' )`，或者`Object( 123 )`- 它为原始值创建一个包装对象，但如果我们已经有一个对象`obj`，我们为什么要这样做`Object( obj )`？

这种模式没用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:02:24.557

比较将检查是否`obj`是一个真实的对象。它几乎等同于检查

```
typeof obj == "object" 
```

`true`然而，当我们尝试访问它的属性时，这也`null`可能导致奇怪的错误。因此，`if (typeof obj == "object" && obj !== null)`通常将其缩短为`if (obj === Object(obj))`.

此外，它`true`也会产生函数对象，而`typeof`测试不会产生 - 但有时您希望允许所有可以保存属性的东西，如果您忘记函数，有人会对您的库生气。

关于该模式，Reid 写了一个关于 内部结构的出色答案`Object`，它解释了您在问题中已经描述的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:55:17.433

假设这`obj`是一个 Object 值，它将没有效果。让我们看看 ES5 的规范（耶！）。

根据[§ 15.2.1.1`Object([value])`](http://es5.github.com/#x15.2.1.1)，如果`obj`is not `null`or `undefined`，那么我们返回`ToObject(value)`。

现在我们将注意力转向[第 9.9 节 ToObject](http://es5.github.com/#x9.9)。它说如果参数是 Object 类型，“结果是输入参数（没有转换）。”

因此，没有理论上的理由使用`Object(obj)`where you *know* `obj` is an Object：它与 writing 完全相同`obj`。

您列出的另一种情况是`new Object(obj)`，这取决于[§ 15.2.2.1`new Object([value])`](http://es5.github.com/#x15.2.2.1)。它表示如果`value`提供了并且类型`value`是对象，则返回`obj`如果`obj`是本机 ECMAScript 对象。如果它不是本机的，那么结果是实现定义的（因此在我看来，依赖于浏览器并且*不推荐*使用）。

# matlab - 在matlab中为fmincon函数添加约束

> ID：10586674
> 
> 赞同：1
> 
> 时间：2012-05-14T15:47:29.787
> 
> 标签：matlab, convex-optimization

我想在 fmincon 函数中添加一些约束。我有三个参数，因此所有三个参数的值都应该大于 0 。如何在 matlab 中使用 fmincon 函数实现这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:52:28.827

`lb`例如，将函数的参数设置`fmincon`为一些小的值`1.0E-08`。

# vb.net - VB.NET：将带有单引号的文本转换为上传到 Oralce DB

> ID：10586675
> 
> 赞同：0
> 
> 时间：2012-05-14T15:47:30.367
> 
> 标签：vb.net, oracle

我在 VB.NET 中有一个函数，它从 MS SQL DB 运行查询，将结果放入临时变量，然后更新 Oracle DB。我的问题是，如果 MS SQL 中的字符串包含单引号 ( ' )，我如何更新 Oracle DB 以获取具有该单引号的内容？

例如：吉姆的请求

将产生以下错误：ORA-01756: 带引号的字符串未正确终止

ueio_tmpALM_Comments（来自 MS SQL）是可能包含或不包含单引号的罪魁祸首。

```
update_oracle =
"update Schema.Table set ISSUE_ADDED_TO_ALM = '1'," & _
"ISSUE_COMMENTS = '" & ueio_tmpALM_Comments & "'," & _
"where ISSUE_SUMMARY = '" & ueio_tmpALM_Summary & "' "
Dim or_cmd_2 = New NetOracle.OracleCommand(update_oracle, OracleConn)
or_cmd_2.ExecuteNonQuery() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:59:29.980

从您的问题很明显，您正在使用字符串连接构建更新查询。
像这样的东西

```
Dim myStringVar as string = "Jim's request"
Dim sqlText as String = "UPDATE MYTABLE SET MYNAME = '" + myStringVar + "' WHERE ID = 1" 
```

这是 SQL 世界的大罪。您的代码将因单引号问题而失败，但最重要的是该代码受到[Sql Injection Attacks](http://en.wikipedia.org/wiki/SQL_injection)的影响。

你应该改成这样

```
Dim cmd As OraclCommand = new OracleCommand()
cmd.Connection = GetConnection()
cmd.CommandText = "UPDATE MYTABLE SET MYNAME = :myName WHERE ID = 1"
cmd.CommandType = CommandType.Text
cmd.Parameters.AddWithValue(":myName", myStringVar)
cmd.ExecuteNonQuery() 
```

# jquery - 从 jQuery 选择器创建 DOM 元素

> ID：10586678
> 
> 赞同：5
> 
> 时间：2012-05-14T15:47:37.977
> 
> 标签：jquery, dom, selector

我想知道是否有可能，而不是通过 jQuery 选择器从 DOM 中选择一个元素，如果我可以创建一个。

例如：

```
$.create('#hello').insertAfter('#test'); 
```

将生成以下内容：

```
<div id="test">This element already existed in the DOM.</div>
<div id="hello"></div> 
```

或者，更好的是，对于更复杂的操作：

```
$.create('#test.a.b'); 
```

为了：

```
<div id="test" class="a b"></div> 
```

显然，不需要实现更复杂的操作，例如 :selected 或 :nth-child 或 :not() 以及所有这些操作。

有人知道解决方案吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T15:49:09.100

去创造`<div id="hello"></div>`

尝试

```
$('<div id="hello"></div>').appendTo('body'); 
```

创建`<div id="test" class="a b"></div>`与

```
$('<div id="test" class="a b"></div>').appendTo('body'); 
```

`$('<div id="test" class="a b"></div>')`将创建新元素但不会将其添加到 DOM。

要添加该元素，您需要使用[append()](http://api.jquery.com/append)或[appendTo()](http://api.jquery.com/appendTo/)或[insetAfter()](http://api.jquery.com/insertAfter/)或[insertBefore()](http://api.jquery.com/insertBefore/)等等。

最好使用函数来：

```
function createElement(el, target) {
   $(el).appendTo(target);
} 
```

使用如下功能：

```
createElement('<div id="test" class="a b"></div>', 'body'); 
```

您还可以将新创建​​的元素附加到任何其他目标而不是`body`.

我认为以下功能会对您有所帮助：

```
function createElement(el, prop, target) {
  var props = prop.split('.'),
      newelement = $(el),
      id = '',
      className = '';
    $.each(props, function(i, val) {
        if(val.indexOf('#') >= 0) {
           id += val.replace(/^#/, '');
        } else {
           className += val + ' ';
        }
    });
    if(id.length) newelement.attr('id', id);
    if(className.length) newelement.attr('class', className.trim());

    $(newelement).html('Newly born').appendTo(target);
}

createElement('div', '#test.a.b', '#con');​ // will work for #test.a.b or, .a.b or, #test.a 
```

**[演示](http://jsfiddle.net/thesystemrestart/7HXcZ/2/)**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-23T11:10:17.253

实际上，我之前创建了一个，仍然有点错误，但可以适用于您正在考虑的情况，就像使用它一样

```
$.jseldom('#test.a.b') 
```

你甚至可以将它与兄弟选择器一起使用

```
$.jseldom('#test #abc .child +.sibling-of-child') 
```

[https://github.com/shekhei/jseldom](https://github.com/shekhei/jseldom)

如果您觉得它有用，请使用它，并报告那里的所有问题：PI 我真的希望将它变成有益于人们的东西 :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T16:07:11.517

我没有看到会从 css 选择器语法创建元素的东西。JQuery 确实允许您创建和添加元素，但语法不像您的示例那样基于 css 选择器。例如，在#test div 之后添加一个带有a 和b 类的#hello div，您可以使用.after()：

```
$('#test').after("<div id='hello' class='a b'>Hello</div>");​​​​​​​​​ 
```

jsfiddle：http: [//jsfiddle.net/septerr/RmAW6/](http://jsfiddle.net/septerr/RmAW6/)

或者

```
$('#test').after('<div>Hello</div>').attr('id', 'hello').addClass('a').addclass('b');​ 
```

jsfiddle：http: [//jsfiddle.net/septerr/EQjLE/](http://jsfiddle.net/septerr/EQjLE/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T15:49:27.163

只需将html标签插入其中

```
$("<div id='hello'></div>") 
```

有关更多详细信息，请参见此处 [jQuery document.createElement 等效项？](https://stackoverflow.com/questions/268490/jquery-document-createelement-equivalent)

# php - K2 Joomla 项目评论中的错误网址

> ID：10586680
> 
> 赞同：0
> 
> 时间：2012-05-14T15:47:42.160
> 
> 标签：php, regex, joomla2.5, joomla-k2

K2 正在将不必要的文本解析为项目评论中的 url。

1.使用 joomla 管理面板创建一个项目，并作为访客输入评论，并带有以下文本“node.js 是一个强大的完整 js 引擎。Enven.虽然这不是一个有效的 url，但它已被呈现为 valid.url 任何带有 xxx 的内容。 xxx 被解析为 url，甚至像子域语法 iam.not.valid 即 mail.yahoo.com 这太有趣了”

1.  在上面的注释 node.js 中，即使，valid.url，xxx.xxx iam.not.valid 即 mail.yahoo.com 被呈现为有效 url。但在这种情况下，只有 mail.yahoo.com 有效，其他无效。

K2 使用 $JHOME/components/com_k2/views/item/view.html.php 行 (159-178) 中的以下代码段使用一些智能智能

```
$comments = $model->getItemComments($item->id, $limitstart, $limit, $commentsPublished);
                $pattern = "@\b(https?://)?(([0-9a-zA-Z_!~*'().&=+$%-]+:)?[0-9a-zA-Z_!~*'().&=+$%-]+\@)?(([0-9]{1,3}\.){3}[0-9]{1,3}|([0-9a-zA-Z_!~*'()-]+\.)*([0-9a-zA-Z][0-9a-zA-Z-]{0,61})?[0-9a-zA-Z]\.[a-zA-Z]{2,6})(:[0-9]{1,4})?((/[0-9a-zA-Z_!~*'().;?:\@&=+$,%#-]+)*/?)@";

                for ($i = 0; $i < sizeof($comments); $i++) {
                    $comments[$i]->commentText = nl2br($comments[$i]->commentText);
                    $comments[$i]->commentText = preg_replace($pattern, '<a target="_blank" rel="nofollow" href="\0">\0</a>', $comments[$i]->commentText);
                    $comments[$i]->userImage = K2HelperUtilities::getAvatar($comments[$i]->userID, $comments[$i]->commentEmail, $params->get('commenterImgWidth'));
                    if ($comments[$i]->userID>0) {
                        $comments[$i]->userLink = K2HelperRoute::getUserRoute($comments[$i]->userID);
                    }
                    else {
                        $comments[$i]->userLink = $comments[$i]->commentURL;
                    }
                    if($reportSpammerFlag && $comments[$i]->userID>0) {
                        $comments[$i]->reportUserLink = JRoute::_('index.php?option=com_k2&view=comments&task=reportSpammer&id='.$comments[$i]->userID.'&format=raw');
                    }
                    else {
                        $comments[$i]->reportUserLink = false;
                    }
                } 
```

有人可以帮助修复上述正则表达式吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T01:51:43.430

每当用户键入时，您都会遇到此问题。在其周围没有空格的时间段内。您可以添加一些登录信息来测试有效的 TLD，但即使这样也不完美，因为有很多 TLD 会欺骗逻辑，比如 .it。

如果您想尝试修复正则表达式，确定字符串是否为 URL 的模式在这里 -

```
$pattern = "@\b(https?://)?(([0-9a-zA-Z_!~*'().&=+$%-]+:)?[0-9a-zA-Z_!~*'().&=+$%-]+\@)?(([0-9]{1,3}\.){3}[0-9]{1,3}|([0-9a-zA-Z_!~*'()-]+\.)*([0-9a-zA-Z][0-9a-zA-Z-]{0,61})?[0-9a-zA-Z]\.[a-zA-Z]{2,6})(:[0-9]{1,4})?((/[0-9a-zA-Z_!~*'().;?:\@&=+$,%#-]+)*/?)@"; 
```

就个人而言，我会通过删除或注释掉这段代码来完全禁用评论中的链接 -

```
$comments[$i]->commentText = preg_replace($pattern, '<a target="_blank" rel="nofollow" href="\0">\0</a>', $comments[$i]->commentText); 
```

# php - 通过PHP触发javascript函数

> ID：10586683
> 
> 赞同：0
> 
> 时间：2012-05-14T15:47:47.243
> 
> 标签：php, javascript

我正在尝试通过 PHP 调用 JavaScript 函数，但遇到了一些问题。我有三个代码片段供您理解：

1）我的javascript函数：

```
function addPoints(radiobutton){
    //code
} 
```

该参数是一个实际的按钮，函数内部有很多代码读取按钮的值和名称，并处理按钮的检查状态。

2）我创建按钮的 php 代码如下所示。请注意，我将“this”发送给函数。

```
echo "<input type=\"radio\" name=\"X\" value=\"Y\" onClick=\"addPoints(this)\"/>"; 
```

3）最后我在文档的最后有这段代码，用于在页面加载时触发 javascript 函数。

```
echo "<SCRIPT LANGUAGE='javascript'>addPoints();</SCRIPT>"; 
```

如果`addPoints`只包含警报，这将起作用。但我的问题是我需要发送一个实际按钮作为函数的参数。我需要在页面加载时触发功能（从数据库加载一些数据）和正常的按钮 onClick 事件。

如果我不使用另一个服务器请求来捕获所需的按钮，是否有任何解决方案？重要的是我得到了上面创建的按钮（实际上我有很多按钮，但我们认为是一个）并将其作为参数发送。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T18:30:50.947

将按钮传递给加载`id="initial_radio_button"`属性时的函数，然后制作最后一个片段：

```
echo "<script type='text/javascript'>addPoints(document.getElementById('initial_radio_button')‌​);</script>"; 
```

# python - RabbitMQ / Pika - 保证按创建的顺序接收消息？

> ID：10586694
> 
> 赞同：0
> 
> 时间：2012-05-14T15:48:20.333
> 
> 标签：python, messaging, rabbitmq, amqp, pika

作为一个简单的例子，我将 5 个项目添加到一个新的 RabbitMQ(v 2.6.1) 队列中：

```
import pika
connection = pika.BlockingConnection(pika.ConnectionParameters(host='not.my.real.server.net'))
channel = connection.channel()
channel.queue_declare(queue='dw.neil',durable=True)
# add 5 messages to the queue, the numbers 1-5
for x in range(5):
    message = x+1
    channel.basic_publish(exchange='',routing_key='dw.neil', body=str(message))
    print " [x] Sent '%s'" % message
connection.close() 
```

我清除我的队列，然后运行上面的代码来添加 5 个项目：

```
nkodner@hadoop4 sports_load_v2$ python send_5.py 
 [x] Sent '1'
 [x] Sent '2'
 [x] Sent '3'
 [x] Sent '4'
 [x] Sent '5' 
```

现在，我正在尝试模拟失败的处理。给定以下代码以从队列中使用。请注意，我对 basic_ack 的调用已注释掉：

```
#!/usr/bin/env python
import pika

connection = pika.BlockingConnection(pika.ConnectionParameters(host='not.my.real.server.net'))
channel = connection.channel()
channel.queue_declare(queue='dw.neil',durable=True)
method_frame, header_frame, body=channel.basic_get(queue='dw.neil')
print method_frame, header_frame
print "body: %s" % body
#channel.basic_ack(delivery_tag=method_frame.delivery_tag)
connection.close() 
```

我运行接收代码以从队列中获取一个项目。正如我所料，我得到了第 1 项：

```
nkodner@hadoop4 sports_load_v2$ python r5.py 
<Basic.GetOk(['message_count=9', 'redelivered=False', 'routing_key=dw.neil', 'delivery_tag=1', 'exchange='])>
<BasicProperties([])>
body: 1 
```

由于对 channel.basic_ack() 的调用被注释掉了，我希望将未确认的消息放在队列中，以便下一个消费者得到它。我希望消息 #1 是队列中的第一条消息（再次），并将 Redelivered 属性设置为 True。相反，收到消息 #2：

```
nkodner@hadoop4 sports_load_v2$ python r5.py 
<Basic.GetOk(['message_count=9', 'redelivered=False', 'routing_key=dw.neil', 'delivery_tag=1', 'exchange='])>
<BasicProperties([])>
body: 2 
```

并且队列中的所有其他消息都在 #1 返回之前接收到，并将 Redelivered 标志设置为 True：

...

```
nkodner@hadoop4 sports_load_v2$ python r5.py 
<Basic.GetOk(['message_count=9', 'redelivered=False', 'routing_key=dw.neil', 'delivery_tag=1', 'exchange='])>
<BasicProperties([])>
body: 5

nkodner@hadoop4 sports_load_v2$ python r5.py 
<Basic.GetOk(['message_count=9', 'redelivered=True', 'routing_key=dw.neil', 'delivery_tag=1', 'exchange='])>
<BasicProperties([])>
body: 1 
```

是否有任何属性或选项我可以设置，以便我一直收到 #1 直到它被确认？

我的用例是用顺序生成的文件加载数据仓库。我们正在使用基于消息的处理来让我的程序知道一些新文件已准备好并要加载到 DW 中。我们必须按照它们生成的顺序处理这些文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T20:32:58.647

这已在 RabbitMQ 2.7.0 中得到解决——我们运行的是 2.6.1。

从[发行说明](http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-November/016069.html)：

> 此版本中的新功能包括：
> 
> *   为消费者重新排队的消息的保留顺序

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:01:52.617

尝试使用 channel.basic_reject - 这应该将未确认的消息推送回 RabbitMQ，RabbitMQ 会将消息视为新消息。另外——如果你有一条失败的消息卡住了，你可以使用 channel.basic_recover 告诉 RabbitMQ 重新传递所有未确认的消息。

*   [http://pika.github.com/communicating.html#channel.Channel.basic_reject](http://pika.github.com/communicating.html#channel.Channel.basic_reject)
*   [http://pika.github.com/communicating.html#channel.Channel.basic_recover](http://pika.github.com/communicating.html#channel.Channel.basic_recover)

[http://www.rabbitmq.com/extensions.html#negative-acknowledgements](http://www.rabbitmq.com/extensions.html#negative-acknowledgements)提供了 Basic.Reject 与 Basic.Nack 的区别信息。

消息排序语义在[http://www.rabbitmq.com/semantics.html进行了解释](http://www.rabbitmq.com/semantics.html)

# php - PHP 闭包作为可选函数参数

> ID：10586695
> 
> 赞同：16
> 
> 时间：2012-05-14T15:48:22.407
> 
> 标签：php, closures

当参数是 PHP 闭包时，是否可以指定默认参数值？喜欢：

```
public function getCollection($filter = function($e) { return $e; })
{
    // Stuff
} 
```

我错过了什么（可能是不同的语法？）还是根本不可能？我当然知道我能做到：

```
public function getCollection($filter = null)
{
    $filter = is_callable($filter) ? $filter : function($e) { return $e; };
    // Stuff
} 
```

（**注意：**我没有测试上面的代码）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-14T15:55:00.440

[Default arguments](http://www.php.net/manual/en/functions.arguments.php#functions.arguments.default) can only be "scalar arguments", arrays, or NULL.

["scalar values"](http://php.net/manual/en/function.is-scalar.php) in PHP are numbers, strings, and booleans.

If you want a function to be a default argument, you're gonna need to use the 2nd way, the 1st is a syntax error.

# c# - C# 应用程序重启不调用程序 Main()

> ID：10586696
> 
> 赞同：1
> 
> 时间：2012-05-14T15:48:23.887
> 
> 标签：c#, winforms, multithreading

我已经编写了一个适用于用户群的应用程序。我正在寻找用于当前用户注销的最佳方式。所以我用过 `Application.Restart();` 不久我发现代码不能正常工作，`Program.Main()`也没有再回调。我想知道我的***登录表单加载方法***不会执行（登录表单正在从程序类调用）。

因此，如果您让我知道我的错误和正确的解决方案，我将非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T15:53:44.130

[http://msdn.microsoft.com/en-us/library/system.windows.forms.application.restart.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.restart.aspx)

**评论列出“VS2010 SP1 中的错误”**

> 调用此方法后，应用程序不再在调试模式下运行，它不是由 IDE 生成的，并且所有断点都停止运行。

*编辑：* 这是 log4net 之类的东西真正有用的地方。这是一个非常简单的库，可以添加到您的项目中，并且可以让您将调试信息写到文件中，因此，即使下一个实例不是由 IDE 生成并且不会获得断点，您仍然可以进行一些验证，以确保它达到了什么您期望通过使用调试跟踪。只是一个建议...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T15:54:52.277

A new process gets created, and it's not spawned by the IDE.

A breakpoint is not a valid way to test if `Main` is entered again.

See somewhat related post: [Does Application.Restart() creates new process for application or no?](https://stackoverflow.com/questions/3530722/does-application-restart-creates-new-process-for-application-or-no)

If you'd like, you could write to a file or some other simple test in `Main` just to prove to yourself that it is entered.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-16T17:53:57.763

微软最近发布了一个解决方案，允许在 之后继续调试`Application.Restart()`，以 Power Tool 的形式：

# 子进程调试电动工具

*   [博客文章](http://blogs.msdn.com/b/visualstudioalm/archive/2014/11/24/introducing-the-child-process-debugging-power-tool.aspx)
*   [在 VS 库中下载](https://visualstudiogallery.msdn.microsoft.com/a1141bff-463f-465f-9b6d-d29b7b503d7a)

# java - PropertyChangeSupport 泄露了这个参考

> ID：10586697
> 
> 赞同：0
> 
> 时间：2012-05-14T15:48:25.823
> 
> 标签：java

我有一个包含私有字段 PropertyChangeSupport pcs 的 bean。如果我在 bean 构造函数中调用 pcs = new PropertyChangeSupport(this) 那么我不确定这种方法是否存在潜在危险。在这种情况下，您如何看待在构造函数中泄漏此引用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:55:17.317

我看不出有什么危险。`PropertyChangeSupport`不会对 做任何危险的事情`this`，也不会有任何方法可以`this`从中找到另一个线程。

# c++ - boost::进程间内存大小

> ID：10586699
> 
> 赞同：1
> 
> 时间：2012-05-14T15:48:28.257
> 
> 标签：c++, memory-management, boost, boost-interprocess

我有一个`managed_shared_memory`对象，其中包含`SharedMap`定义如下的地图容器。

```
typedef std::pair<std::string, T> ValueType;
typedef allocator<ValueType, managed_shared_memory::segment_manager> ShmemAllocator;
typedef map<std::string, T, std::less<std::string>, ShmemAllocator> SharedMap; 
```

我的问题是我需要确定我正在使用的共享内存的大小。地图的键是一个未知大小的std::string，数据是一个未知大小的模板类型，其中每个数据的大小都会有所不同。

谁能建议我如何跟踪我正在使用的内存？

我是 boost::interprocess 的新手，所以任何建议都会有很大帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T20:31:58.997

我通过使用异常处理解决了这个问题。我插入到地图中，直到`bad_alloc`抛出异常。我捕捉到异常并重新调整共享内存的大小。

* * *

我使用了`static bool grow(const char *shmname, size_type extra_bytes)`应该是成员函数的方法`managed_shared_memory`

# google-maps - 缩放时如何吸引地图

> ID：10586700
> 
> 赞同：0
> 
> 时间：2012-05-14T15:48:30.080
> 
> 标签：google-maps, maps

在我的应用程序中，我面临地图问题..

最初的地图视图放大到我的位置，但几秒钟后，它会闪烁，然后让我看到美国西海岸的视图。请告诉我一些要点，以便它保持在放大视图中，以便用户无需放大即可看到他们当前的位置。

# javascript - 检测 ASP 表单提交不再有效

> ID：10586701
> 
> 赞同：0
> 
> 时间：2012-05-14T15:48:32.797
> 
> 标签：javascript, jquery, asp.net

我的 ASP.Net 页面上有以下代码。

```
$(window).submit(function () {
    prompt = false;
}); 
```

这段代码的重点是，如果用户单击页面上的按钮并执行回发，那么我将提示标志设置为 false，并且不提示用户“您确定要离开此页面吗？”

直到今天，只要用户单击页面上的按钮，他就会突然收到提示，这一直很好。我想不通。不再在任何页面上调用此函数。即使我将页面恢复到它工作的时候仍然没有。

所以问题不在于页面本身，而在于其他地方。有什么想法吗？

谢谢，迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T11:34:38.373

所以问题出在 Site.Master

改变这个：

```
<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE" /> 
```

至：

导致该方法永远不会被执行。问题是我不知道为什么即使问题

# java - Java - 接口方法

> ID：10586702
> 
> 赞同：3
> 
> 时间：2012-05-14T15:48:34.013
> 
> 标签：java, methods, interface, implements

只是在玩界面，我有一个我无法真正理解的问题。

以下代码不运行，**这是我期望的行为，因为接口方法要求该方法适用于任何对象，并且实现的方法已将签名更改为仅允许字符串对象。**

```
interface I {
    public void doSomething(Object x);
}

class MyType implements I {
    public void doSomething(String x) {
        System.out.println(x);
    }
} 
```

然而，使用下面的代码块，我很震惊地看到它确实有效。**我认为它不起作用，因为我们期望返回一个对象，而实现的方法只会返回一个字符串对象。为什么会这样？这里传递参数和返回类型这两个原则有什么区别？**

```
interface I {
    public Object doSomething(String x);
}

class MyType implements I {
    public String doSomething(String x) {
        System.out.println(x);
        return(x); 
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:57:09.847

```
public Object doSomething(String x); 
```

必须返回一些东西。事实上，任何东西，只要它是某种类型的对象。所以如果你实现

```
public String doSomething(String x) {stuff} 
```

这很好，因为它确实返回了一个对象。它将返回的对象始终是 String 的事实没什么大不了的。

第一个示例不起作用的原因是，仅接受字符串比接受任何对象更具限制性。但是只返回字符串就可以了。

打个比方，假设你有一份粉刷建筑物的合同，你将雇佣一些员工来帮助你。合同要求您雇用任何适用的油漆工，无论他们有多高，但没有指定使用什么颜色的油漆。如果您只雇用超过 6 英尺高的画家（这是输入，只接受 String 而不是所有 Object），您将违反合同。但是选择只用蓝色油漆（只返回字符串）就可以了，因为合同没有指定颜色，只是你必须给建筑物涂漆。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:07:09.397

这与 Java SE 5.0 中引入的协变返回类型有关。[您可以在http://docs.oracle.com/javase/tutorial/java/javaOO/returnvalue.html](http://docs.oracle.com/javase/tutorial/java/javaOO/returnvalue.html)
中查看更多详细信息

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T15:53:04.827

它之所以有效，是因为 a`String`是一个`Object`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-14T15:55:11.450

From the java language specification:

> Return types may vary among methods that override each other if the return types are reference types. The notion of return-type-substitutability supports covariant returns, that is, the specialization of the return type to a subtype.

So in other words, it works as you did it, but it would not work if the return type in the interface is String, and in the implementing class is Object.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-14T15:57:28.603

这种行为背后的原理称为[**协变返回类型**](http://en.wikipedia.org/wiki/Covariant_return_type)。在这种特殊情况下，覆盖类型可能会“缩小”最初声明的参数类型。

这意味着 as`String`是子类化`Object`，`Object`可以被`String`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-14T15:59:26.030

string 类继承自 object 类，所以只有这段代码有效。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-14T15:55:26.483

第一个示例不起作用而第二个示例起作用的原因是因为函数原型仅由名称和所有参数定义，而不是返回类型。在第一个示例中，存在差异，因此编译器认为它们是两个不同的函数。

在第二个例子中，实现的函数并没有扩展类型，而是特化了类型（String 是 Object 的特化），所以它可以工作。

同样，您可以限制已实现方法的可见性，但不能扩大它。

此外，Java 有泛型，在这种情况下很有用。

例子：

```
interface I<T>
{
    public void doSomething(T x);
}

class MyType implements I<String>
{
    public void doSomething(String x)
    {
        System.out.println(x);
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-14T15:55:47.503

方法签名不考虑返回类型。（虽然声明两个具有相同签名但返回类型不同的方法是错误的）。所以：

```
void doSomething(Object)
void doSomething(String) 
```

只是两个方法，没有一个覆盖或实现另一个

# facebook - 通过 Javascript 的 Facebook 评论

> ID：10586705
> 
> 赞同：0
> 
> 时间：2012-05-14T15:48:39.007
> 
> 标签：facebook, comments, facebook-javascript-sdk

有谁知道是否可以在 FB 应用程序上通过 javascript 插入评论，这样我就可以通过 jQuery 访问元素，而不是使用`<fb:comments>`插入 iFrame 的方法，这意味着我无法触摸任何元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:58:31.750

预制的 Facebook 插件有一些很大的限制，这就是其中之一。您可以编写自己的评论工具（我在过去有一个文件存储应用程序，我多年前写的允许人们对其他人上传的文件发表评论）。请参阅：[https](https://developers.facebook.com/docs/reference/api/) ://developers.facebook.com/docs/reference/api/ ，了解如何与 Graph API 交互。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:03:06.303

决定建立自己的评论系统，而不用担心尝试使用 Facebook 评论系统。

# jquery - 任何泛化函数fadeIn 淡出？

> ID：10586709
> 
> 赞同：1
> 
> 时间：2012-05-14T15:48:59.567
> 
> 标签：jquery, fadein, fadeout

查询：

```
$(document).ready(function () {
    $('#myfirstDiv').click(function () {
        $('#seconDiv').fadeIn("fast");
    });
    $('#closeBtn').click(function () {
        $('#seconDiv').fadeOut("fast");
    });
}); 
```

这些函数在我的站点中有多种用法，Div 和 Button 的 id 不同。
我如何为每个 Div 和 Button 概括这些功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:56:05.037

1.  为按钮 div 定义一个类
2.  为淡入淡出的 div 定义一个类
3.  `data-target`在`div`按钮中创建自定义属性
4.  `data-action`在`div`按钮中创建自定义属性
5.  让您的 jQuery 查找所有按钮 div 元素（按类选择）并根据它们的操作（显示/淡入或隐藏/淡出）将它们链接到目标

这样，无论有多少按钮或 div，如果设置正确，您的 jQuery 都会“自动”链接它们。

抱歉，暂时没有代码，但这种方法有效。

**更新**

一些链接可帮助您实现此方法：

*   [jQuery 自定义属性](https://stackoverflow.com/questions/4145636/jquery-custom-attributes)
*   [jQuery 的类选择器](http://api.jquery.com/class-selector/)
*   [jQuery的绑定](http://api.jquery.com/bind/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T16:08:37.350

这是一个插件，它接收第二个 div 和关闭它的按钮：

```
(function($) {
    $.fn.extend({
        FadeInOut: function(divTwo, closeBtn) {
            return this.each(function() {
                $(this).click(function() {
                    $(divTwo).fadeIn("fast");
                });
                $(closeBtn).click(function() {
                    $(divTwo).fadeOut("fast");
                });
            });
        }
    });
})(jQuery); 
```

[**演示**](http://jsfiddle.net/NcNaH/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T06:01:32.170

我找到了一个解决方案来概括这些淡入淡出和淡出功能。
你可以看到这个[例子](http://jsfiddle.net/hbW2u/13/)

可能对其他任何人都有帮助。

# javascript - 在 JavaScript 中存储文本文件（包含 25% 的重复单词）的算法

> ID：10586711
> 
> 赞同：4
> 
> 时间：2012-05-14T15:49:03.577
> 
> 标签：javascript, algorithm

我有文本文件格式的原始数据，其中包含大量重复标记（~25%）。我想知道是否有任何算法可以帮助：（A）以紧凑的形式存储数据（B），但允许在运行时重新构成原始文件。

有任何想法吗？

更多细节：

*   原始数据在纯 html+javascript 应用程序中使用，用于使用正则表达式进行即时搜索。
*   数据由包含（区分大小写）字母字符和少量标点符号的标记组成。
*   标记用空格、换行符分隔。

迄今为止最有前途的算法：下面讨论的简洁数据结构，但重构看起来很困难。

[http://stevehanov.ca/blog/index.php?id=120](http://stevehanov.ca/blog/index.php?id=120)

[http://ejohn.org/blog/dictionary-lookups-in-javascript/](http://ejohn.org/blog/dictionary-lookups-in-javascript/)

[http://ejohn.org/blog/revised-javascript-dictionary-search/](http://ejohn.org/blog/revised-javascript-dictionary-search/)

PS：服务器端 gzip 目前正在使用，但它只是一个传输层优化，并无助于最大限度地利用离线存储。鉴于 25% 的大量重复性，应该可以以更紧凑的方式存储，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:23:52.437

鉴于实际使用还不清楚，我不知道这是否有用，但对于最小的总大小（html+javascript+data），有些人想出了将文本数据存储在灰度 .png 文件中的想法，一个字节到每个像素。然后，一个小的加载器脚本可以将 .png 绘制到画布上，逐个像素地读取它并以这种方式重新组合原始数据。这使您无需在 Javascript 中实现压缩即可缩小压缩。有关更多详细信息，请参见[此处](http://blog.nihilogic.dk/2008/05/compression-using-canvas-and-png.html)。

请不要使用这样的技术，除非您有非常深奥的要求，例如对于规模受限的编程竞赛。你的同事会感谢你的:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:55:41.513

一般来说，尝试在 JavaScript 中实现压缩是个坏主意。压缩正是 JS 最不擅长的工作类型：CPU 密集型计算。

请记住，JS 是单线程的¹，因此在解压缩数据的整个过程中，您都会阻塞浏览器 UI。相反，HTTP gzipped 内容由浏览器异步解压缩。

鉴于您必须重建整个数据集（以便针对正则表达式测试每条记录），我怀疑 Succinct Trie 是否适合您。老实说，我怀疑你会得到比原生 gzipping 更好的压缩。

* * *

^(1 - 尽管有网络工作者。)

# sencha-touch - 在视图上显示文本

> ID：10586713
> 
> 赞同：1
> 
> 时间：2012-05-14T15:49:08.603
> 
> 标签：sencha-touch, extjs, sencha-touch-2

下面的代码是我的控制器功能的一部分；

```
success: function (response) {

                            var text = response.responseText;

                            var result = Ext.decode(response.responseText);

                            var indexPanel = Ext.create('app.view.PersonDetails');

                            Ext.getCmp('mainView').push({

   xtype:'person',

   data: result

   });

} 
```

下面的代码是视图，我从控制器函数（上图）传递值。`Hard coded text`下面的代码演示了该视图中的硬编码数据`data: result`（我怎样才能做到这一点 ？

```
Ext.define('app.view.UserInformation',{

           extend:'Ext.Panel',

           xtype:'person',

           config: {
                title:'Person details',       
    html:['Hard coded text'].join("")
           }

}); 
```

**更新**

`result`包含几个值，例如；

`result.name, result.age. result.gender`

我将`result`转到另一个视图。

1.）从视图中，我如何添加按钮？并且当用户单击该按钮时，我如何获取该`result.age`字段并执行 if 条件来检查年龄是否低于 10 岁？

2.）想象一下，如果有一个名为的字段，`result.imageurl`我怎么能在另一个视图上显示图像（在一个框架中）？

**更新2**

```
Ext.getCmp('mainpanel').push({

 title: 'Hello ' ,
xtype:'person'
});
Ext.getCmp('idOfTheView').setRecord(result.first_name); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T15:51:46.837

您的问题仅是 Sencha Touch，与 PhoneGap 无关。:)

假设您的视图有一个 id：`view_id`

然后在您的控制器功能中：

`Ext.getCmp('view_id').setHtml(what you want to put into your view)`

**更新的答案：**

您的问题由几个子问题组成。恐怕你问的范围太广，但我会回答最重要的部分。

（来自我自己的应用程序）：

```
Ext.define('rs.view.ProductInfo', {
    extend: 'Ext.Container',
    xtype: 'ProductInfo',
    id: 'product-info',
    cls: 'product-info',

    config: {
            items: [
                    {
                            xtype: 'panel',
                            styleHtmlContent: true,
                            id: 'product-info-header',
                            tpl: [
                                    '<div class="product-info-header">',
                                            '<img src={image} width="100px" height="100px"/>',
                                            '<h3>{name}</h3>',
                                            '<h4>Price: {price}</h4>',
                                            '<h4>Seller: {sellerUsername}</h4>',
                                    '</div>',
                            ],
                    },
            ],
    }
}); 
```

请注意，我定义了一个带有属性的模型`{image},{name},{price},{sellerUsername}`，然后在上面的代码片段中，您可以看到我在 config 中使用它们就像在(with config)`tpl`中正常使用一样。那么我该怎么做呢？`Ext.List``store`

首先，您必须定义一个模型来描述您的结果。明显地。

其次，`tpl`在你看来定义，我相信你可以从上面的例子中弄清楚。

最后，使用它（假设您已经将从服务器接收到的结果写入到我在第一步中提到的模型实例中）：

`Ext.getCmp('your_view_id').setRecord(your_model_instance)`

100% 工作保修，因为我已经使用了很多次。希望能帮助到你。如果您有任何问题，请发表评论。

# html - Chromium Web 浏览器：“出现错误：无法准备语句（1 个表项没有名为 due_date 的列）”

> ID：10586715
> 
> 赞同：0
> 
> 时间：2012-05-14T15:49:24.007
> 
> 标签：html, web-sql

我使用 websql 进行离线存储。以下 addItem 函数适用于除 Chromium 之外的其他浏览器：

```
 itemset.webdb.createTable = function() {
     var db = itemset.webdb.db;
     db.transaction(function(tx) {
      tx.executeSql("CREATE TABLE IF NOT EXISTS items(ID INTEGER PRIMARY KEY ASC,        
          item_name TEXT, desp TEXT, due_date DATE)", []);
    });
  }

   itemset.webdb.addItem = function(item_name, desp, due_date) {
        var db = itemset.webdb.db;
        db.transaction(function(tx){
          //var added_on = new Date();
          tx.executeSql("INSERT INTO items(item_name, desp, due_date) VALUES (?,?,?)",
              [item_name,desp,due_date],
              itemset.webdb.onSuccess,
              itemset.webdb.onError);
         });
      } 
```

Chromium 给出错误：“出现错误：无法准备语句（1 个表项没有名为 due_date 的列）”。为什么它不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T19:08:01.117

只需将新字段添加到表中，例如下一个代码：

```
db.transaction(function(txt))
{
    txt.executeSql("ALTER TABLE items ADD item_name TEXT, desp TEXT, due_date DATE");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-23T11:28:34.830

创建新表名或删除并创建表。

# c++ - cin >> i 输入错误，符号 +

> ID：10586720
> 
> 赞同：2
> 
> 时间：2012-05-14T15:49:29.210
> 
> 标签：c++, stream, cin

在 C++ 程序中，我试图处理由整数操作数和运算符 (+ - / *) 组成的用户输入。我可以要求用户在每个运算符之前和之后放置空格。我的方法是假设任何不是 int 的东西都是运算符。因此，一旦流中出现非 eof 错误，我就会调用 cin.clear() 并将下一个值读入字符串。

```
#include <iostream>
#include <string>

//in some other .cpp i have these functions defined
void process_operand(int);
void process_operator(string);

using namespace std;

int main()
{
    int oprnd;
    string oprtr;
    for (;; )
    {
        while ( cin >> oprnd)
            process_operand(oprnd);
        if (cin.eof())
            break; 
        cin.clear();
        cin >> oprtr;
        process_operator(oprtr);
    }
} 
```

这适用于 / 和 * 运算符，但不适用于 + - 运算符。原因是 `operator>>`在报告错误之前吃掉 + 或 - 并且不会将其放回流中。所以我得到一个无效的令牌读入 optrr。

```
Ex: 5 1 * 2 4 6 * /   works fine
    5 1 + 2 
          ^ ---> 2 becomes the oprnd here. 
```

处理这个问题的好 C++ 方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T15:52:37.270

读入`std::string`s 并使用[`boost::lexical_cast<>`](http://www.boost.org/doc/libs/1_49_0/doc/html/boost_lexical_cast.html)或等价物转换它们。

```
int main()
{
    string token;
    while ( cin >> token) {
        try {
            process_operand(boost::lexical_cast<int>(token));
        } catch (std::bad_cast& e) {
            process_operator(token);
        }
    }
} 
```

* * *

*后记*：如果你对 Boost 过敏，可以使用 lexical_cast 的这个实现：

```
template <class T, class U>
T lexical_cast(const U& u) {
  T t;
  std::stringstream s;
  s << u;
  s >> t;
  if( !s )
    throw std::bad_cast();
  if( s.get() != std::stringstream::traits_type::eof() )
    throw std::bad_cast();
  return t;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T16:48:16.500

我认为 >> 认为您正在使用 +/- 开始另一个整数。然后当你不跟随数字时会生气。

正如@Robᵩ所说，阅读一个字符串并进行转换。我只会从标准库中提供另一种选择：

```
int stoi(const string& str, size_t *idx = 0, int base = 10); 
```

`invalid_argument`如果无法执行转换或`out_of_range`转换后的值超出返回类型的可表示值范围，则会引发此错误。

这是从[标准。](http://www.open-std.org/JTC1/sc22/WG21/docs/papers/2012/n3376.pdf)

# javascript - IE9 中的 jQuery JavaScript Library v1.4.2 在第一次调用时死掉

> ID：10586723
> 
> 赞同：0
> 
> 时间：2012-05-14T15:49:41.763
> 
> 标签：javascript, jquery, internet-explorer-9, compatibility

我有一个要克隆到 div 的 div，该 div 最初是隐藏的，并且有一些我更改的其他属性。

任何人都知道为什么它在 IE 怪癖模式下第一次调用失败而第二次调用失败？

`$("#TRtemplate").before($("#TRtemplate").clone().show().removeAttr("id").css('background-color', color));`

任何提示都更受欢迎，你和 arigato 和 hvala unapred 和 domo arigato 和 dankeschon：p

# java - Itext pdf生成jar中的页眉页脚

> ID：10586725
> 
> 赞同：0
> 
> 时间：2012-05-14T15:49:53.217
> 
> 标签：java, pdf, itext

在哪个版本的 IText pdf 生成 jar 将支持 HeaderFooter 类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:33:09.837

直到 iText 2.1.7 才找到该类`HeaderFooter`，它已经很老了，不再受支持，并且可能包含一些严重的错误。

如果使用更高版本，您应该使用更好的[PageEvent](http://itextpdf.com/themes/keyword.php?id=221)来构建页眉和页脚。

# java - 在 Java 或 C 中附加两个十六进制长值

> ID：10586727
> 
> 赞同：1
> 
> 时间：2012-05-14T15:50:09.410
> 
> 标签：java, c, hex, append

我正在用 Java 实现 SHA-2 算法。但是，我遇到了一个问题。我需要将两个十六进制值附加到一个中，但我无法这样做。我尝试将两者附加为字符串并使用`Long.parseLong(appendedString)`，但这会导致数字格式异常。无论如何我可以在Java中做到这一点吗？如果没有的话，无论如何都可以在 C 中执行此操作，我将在 C 中实现它？谢谢阅读。

这是代码：

```
 String temp = h[0] + "" + h[1]; //Where h[0] and h[1] are two hex values stored as Long
    //I also tried String temp = String.valueOf(h[0]) + String.valueOf(h[1]); but no dice
    Long appended = Long.parseLong(temp); //Number format exception here 
```

当我说附加时，我的意思是：0x6a09e667 + 0xbb67ae85 = 0x6a09e667bb67ae85

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T15:55:45.993

我假设您的代码看起来像这样：

```
long hex1 = 0x6a09e667;
long hex2 = 0xbb67ae85; 
```

并且您想要`0x6a09e667bb67ae85`.

您可以通过一些位移来做到这一点，例如：

```
long result = hex2 | (hex1 << 32); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:57:32.197

`0x6a09e667 + 0xbb67ae85`给出`0x6a09e6670xbb67ae85`无效的。试试这个代码：

```
String temp = h[0] + h[1].substring( 2 ); // Strip "0x" from second string 
```

# c - 系统中打开的文件太多，而实际上没有打开任何文件

> ID：10586728
> 
> 赞同：1
> 
> 时间：2012-05-14T15:50:12.563
> 
> 标签：c, macos, file-descriptor

我正在开发一个备份实用程序，但出现错误：

> 系统中打开的文件太多

运行一段时间后。错误由`stat()`.

由于我实际上并没有打开任何文件`fopen()`（

*   `getwd()`
*   `chdir()`
*   `mkdir()`
*   `stat()`
*   `time()`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-14T15:55:31.603

您列出的功能是安全的；他们都没有返回任何你可以“关闭”的东西。

要了解更多信息，请运行`lsof -p`备份进程的命令 + PID。这将为您提供该进程已打开的文件列表，这反过来将使您了解正在发生的事情。

请参阅：[`lsof`手册页](http://www.unix.com/man-page/Linux/8/lsof/)。

# jquery - 2级UL下滑时打勾背景

> ID：10586729
> 
> 赞同：0
> 
> 时间：2012-05-14T15:50:20.003
> 
> 标签：jquery, html, css

我正在尝试制作一个 2 级垂直导航菜单。现在发生的事情是，当它所属的第一级导航悬停时，我可以显示第二级导航。我的问题是，当第二级菜单向下滑动时，使它看起来像丝带的元素的背景不会显示为一个块，看起来它会先向下滑动，然后背景会在它出现时显示做了效果。

这是小提琴：http: [//jsfiddle.net/BapmB/](http://jsfiddle.net/BapmB/)

我一直在尝试更改我的 html 和 CSS，但我没有任何运气。有人可以向我解释这有什么问题吗？或者至少指导我如何解决它？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T18:44:32.730

您只需要`<div>`在导航功能区周围放置一个包装器元素，并将`<span>`块放置在该 div 内。

看到这个小提琴：http: [//jsfiddle.net/stevenschobert/4Q6Ye/](http://jsfiddle.net/stevenschobert/4Q6Ye/)

# javascript - 让浏览器从模式化内容重定向窗口

> ID：10586730
> 
> 赞同：0
> 
> 时间：2012-05-14T15:50:24.843
> 
> 标签：javascript, jquery, joomla, modal-dialog

我在模态窗口中有内容，当用户单击链接时，我希望整个浏览器重定向，而不仅仅是模态窗口。 [不幸的是，这](https://stackoverflow.com/questions/1226714/how-to-get-browser-to-navigate-to-url-in-javascript)不起作用。

我目前拥有的代码：

```
<a onclick="window.location.href = 'http://insert/url/here'">morestuff!</a> 
```

这只会在模式窗口中加载 url。我该怎么做才能让整个窗口加载所述网址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:59:05.283

像这样的东西应该工作：

```
<a onclick="window.parent.location.href='http://insert/url/here'">morestuff!</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:03:01.353

当您说“模态化”时 - 您是指 jquery 对话框/IFrame 窗口还是物理上不同的浏览器窗口。

如果是第一种情况，那么您需要对外部父级的引用：

window.parent.location.href = "http://www...";

如果是第二个，那么您需要对开瓶器的引用：

window.opener.location.href = "http://www...";

# c# - WCF -Stream.Read - 错误？

> ID：10586731
> 
> 赞同：2
> 
> 时间：2012-05-14T15:50:26.173
> 
> 标签：c#, wcf, filestream

首先，我把我的问题尽可能简单地告诉你，简单地说，当我在 wcf 中转换一个流对象时，'Read' 方法不关心我给他的任何参数。

我有 WCF 客户端和服务，TransferMode = Streamed 双方。基本的HttpBinding。客户端向服务发送 Stream 对象，服务读取流并将其写入他创建的新文件中。客户端发送我创建的流的子类：从**FileStream**继承的**FileStreamEx**。

我把这个类放在那个命名空间中，这样我就可以在每次服务调用“读取”方法时观看。

```
namespace ConsoleApplication1
{
    /// <summary>
    /// The only thing I gain from this class is to know how much was read after every time I call "Read" method
    /// </summary>
    public class FileStreamEx : FileStream
    {
        /// <summary>
        /// how much was read until now
        /// </summary>
        public long _ReadUntilNow { get; private set; }
        public FileStreamEx(string path, FileMode mode, FileAccess access, FileShare share)
            : base(path, mode, access, share)
        {
            this._ReadUntilNow = 0;
        }
        public override int Read(byte[] array, int offset, int count)
        {
            int ReturnV = base.Read(array, offset, count);
            _ReadUntilNow += ReturnV;
            Console.WriteLine("Read: " + _ReadUntilNow);//Show how much was read until now
            return ReturnV;
        }
    }
    public class Program
    {
        static void Main(string[] args)
        {
            ServiceReference1.IJob Service1 = new ServiceReference1.JobClient();
            string FileName = "Chat.rar";
            string Path = @"C:\Uploadfiles\";
            FileStreamEx TheStream = new FileStreamEx(Path + FileName, FileMode.Open, FileAccess.Read, FileShare.None);
            Service1.UselessMethod1(TheStream);
        }
    }
} 
```

到目前为止，没有什么复杂的。下面是 UselessMethod1 方法代码。但在此之前，问题已经开始：在我调用 Service1.UselessMethod1(TheStream) 后，Insted 转到 UselessMethod1 方法，'Read' 方法开始 3 次，无论文件大小和输出是（仅在客户端）：

阅读：256

阅读：4352

阅读：69888

**只有在 'Read' 方法被调用 3 次之后， UselessMethod1** Begin 。如果您查看下面的代码，您会看到每次读取的我的缓冲区 arr 大小仅为 1024！按逻辑，在 MyStream.Read(buffer, 0, bufferSize)) 之后，我的“读取”方法需要开始，但事实并非如此，**“读取”方法随机启动**（或者不是，我无法理解），当我的'Read' 方法开始，我的 'Read' 方法所具有的参数 'byte[] array' 的 Arr 的长度在它被调用时永远不会是 1024。

```
public void UselessMethod1(Stream MyStream)
        {
            using (FileStream fs = new FileStream(@"C:\Upload\"+"Chat.rar", FileMode.Create))
            {
                int bufferSize = 1024 ;
                byte[] buffer = new byte[bufferSize];
                int totalBytes = 0;
                int bytes = 0;
                while ((bytes = MyStream.Read(buffer, 0, bufferSize)) > 0)
                {
                    fs.Write(buffer, 0, bytes);
                    fs.Flush();
                    totalBytes += bytes;
                }
            }
        } 
```

这段代码中的一些输出是：（抱歉，我不明白如何显示图像） [http://desmond.imageshack.us/Himg36/scaled.php?server=36&filename=prlbem.jpg&res=landing](http://desmond.imageshack.us/Himg36/scaled.php?server=36&filename=prlbem.jpg&res=landing)

但在我的逻辑中，这段代码的输出需要从一开始：

阅读：1024

阅读：1024

阅读：1024

阅读：1024

阅读：1024

阅读：1024

...

..

.

**但它不是出局！我的错误在哪里？甚至有什么误会吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:57:52.833

服务器和客户端在读取数据时可能（并且很可能）使用不同的缓冲区大小。您的代码本身没有问题。

如果您想强制客户端使用较小的缓冲区，您可以考虑设置绑定的传输模式`Streamed`，并为绑定的属性使用较小的值`MaxBufferSize`（如果您使用的是自定义绑定，这些属性可能会在传输绑定元素）。

# javascript - 将当前时间写入 SVG 文档

> ID：10586733
> 
> 赞同：1
> 
> 时间：2012-05-14T15:50:37.633
> 
> 标签：javascript, svg

我正在尝试使用 ECMAScript 将当前时间添加到 SVG 文件。以下是我的代码。不幸的是，它不起作用。我如何解决它？

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN"
"http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"   width="300" height="300">
<text x="0" y="15" fill="red">It is now
<script type="text/javascript">
<![CDATA[
var currentTime = new Date();
var month = currentTime.getMonth() + 1;
var day = currentTime.getDate();
var year = currentTime.getFullYear();
document.write(month + "/" + day + "/" + year);
]]>
</script>
</text>
</svg> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T17:37:33.333

## 演示：http: [//jsfiddle.net/M8YXS/](http://jsfiddle.net/M8YXS/)

```
<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300">
  <text x="0" y="15" fill="red">It is now <tspan id="now">(time)</tspan></text>

  <!--
    This script block must either be after the element in the source code
    or else the code below must be wrapped in a callback that is invoked
    only after the DOM is created (e.g. window.onload in a browser)
  -->
  <script>
    // Create whatever string you want
    var dateString = (new Date).toDateString();

    // Set the string content of the Text Node child of the <tspan>
    document.getElementById('now').firstChild.nodeValue = dateString;
  </script>
</svg> 
```

# javascript - 验证输入文本字段敲除验证插件时会触发错误的验证消息

> ID：10586734
> 
> 赞同：0
> 
> 时间：2012-05-14T15:50:49.487
> 
> 标签：javascript, knockout.js

我正在研究淘汰赛验证器插件。我在视图中有一个输入文本控件：

```
Prefix:
<input data-bind = "value: Prefix" /> 
```

我正在对 Prefix observable 变量进行一些验证：

```
Prefix.extend({
            minLength: 3,
            required: true
        }); 
```

验证正在工作，但是当我在输入文本框中输入一个字符并更改焦点时，将显示所需规则的消息，而不是 minLength 的消息。我尝试了一些替代语法：

```
Prefix.extend({ required: true })
            .extend({ minLength: 3 }) 
```

但没有任何改变。如果我输入最少需要的字符，然后将它们一一删除，则会触发正确的规则消息（minLength 消息和没有字符时的必需消息）。我对javascript不是很熟悉，我不知道我做错了什么。任何帮助将不胜感激。谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T00:08:44.293

检查您正在使用的淘汰赛版本。我遇到了这个问题，发现我使用的是淘汰赛 2.0.0，最新版本（2.1.0）似乎解决了这个问题。

# c# - 获取两个字典的公共键和公共值

> ID：10586736
> 
> 赞同：8
> 
> 时间：2012-05-14T15:50:51.733
> 
> 标签：c#, dictionary, lambda, linq-to-entities

嗨，我有两个下一个类型的字典：

```
SortedDictionary<string, ClusterPatternCommonMetadata> PatternMetaData { get; set; } 
```

ClusterPatternCommonMetadata 对象如下所示：

```
int ChunkQuantity { get; set; }

SortedDictionary<int, int> ChunkOccurrences { get; set; } 
```

首先，我需要找到存在于两个字典中的 PatternMetaData 键的方法。我发现这种方式：

```
List<string> commonKeysString=
            vector.PatternMetaData.Keys.Intersect(currentFindingVector.PatternMetaData.Keys) 
```

然后我需要找到建立键的共同值......

是否有快速方法（lambda、linq 等）来执行此类操作

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-14T15:54:02.370

这称为交集。

您可以使用获取密钥

```
var data = dictionary1.Keys.Intersect(dictionary2.Keys) 
```

如果您想找到两个字典中包含的相同键和值，那么只需

```
var equalDictionarys = dictionary1.Intersect(dictionary2); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-19T15:14:35.443

您还可以获得具有公共键的整个字典项目：

```
var commonDictionaryItems = Dic1.Where(d => Dic2.ContainsKey(d.Key)).ToList(); 
```

# php - 推进创建查询中的多个变量

> ID：10586744
> 
> 赞同：0
> 
> 时间：2012-05-14T15:51:07.613
> 
> 标签：php, mysql, propel

根据`api`（[http://trac.propelorm.org/wiki/Documentation/1.6/ModelCriteria](http://trac.propelorm.org/wiki/Documentation/1.6/ModelCriteria)），我正在寻找类似的东西：

```
$param1 = 5;
$param2 = 3;

select id, name from testtable where ((sin(?) * (cos(?)); 
```

等于

```
select id, name from testtable where ((sin($param1) * (cos($param2)); 
```

我怎么能用推进器做到这一点？我只找到了一次只绑定一个变量的方法。

（我不想做一个“AND”我只想绑定**多个**变量）

从文档中，这是用于绑定**一个**变量：

```
<?php
// Finding all Books where title = 'War And Peace'
$books = BookQuery::create()
  ->where('Book.Title = ?', 'War And Peace')
  ->find();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:08:15.940

好吧，我想 Propel 在这一点上就像 Doctrine 一样，你试过了吗：

```
$res = TestQuery::create()
  ->where('((sin(?) * (cos(?))', array($param1, $param2))
  ->find(); 
```

Ps：文档的链接太旧了，使用新的：http: [//www.propelorm.org/reference/model-criteria.html](http://www.propelorm.org/reference/model-criteria.html)

# sql - 如何让 GROUP BY 和 COUNT 包含零和？

> ID：10586746
> 
> 赞同：15
> 
> 时间：2012-05-14T15:51:10.000
> 
> 标签：sql, sqlite

我有这样的 SQL（`$ytoday`5 天前在哪里）：

```
$sql = 'SELECT Count(*), created_at FROM People WHERE created_at >= "'. $ytoday .'" AND GROUP BY DATE(created_at)'; 
```

我希望它每天返回一个值，因此在这种情况下它会返回 5 个结果（从 5 天前到今天）。

但是说`Count(*)`昨天为 0，而不是返回零，它根本不返回该日期的任何数据。

如何更改该 SQLite 查询，使其也返回计数为 0 的数据？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-14T15:56:15.957

如果没有复杂的（在我看来）查询，您的输出数据集将不包含输入数据集中不存在的日期。这意味着您需要一个有 5 天时间才能加入的数据集。

简单的版本是创建一个包含 5 个日期的表，然后加入该表。我通常会创建并保留*（有效缓存）*日历表，其中包含我可能需要的每个日期。 *（例如从 1900-01-01 到 2099-12-31。）*

```
SELECT
  calendar.calendar_date,
  Count(People.created_at)
FROM
  Calendar
LEFT JOIN
  People
    ON Calendar.calendar_date = People.created_at
WHERE
  Calendar.calendar_date >= '2012-05-01'
GROUP BY
  Calendar.calendar_date 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T15:55:56.253

您需要根据日期列表离开加入。您可以创建一个包含所需日期的表格，也可以采用我在此处概述的动态方法：

[从日期范围生成天数](https://stackoverflow.com/questions/2157282/generate-days-from-date-range/2157776#2157776)

# jquery - 淘汰赛 - 取消变更事件？

> ID：10586752
> 
> 赞同：12
> 
> 时间：2012-05-14T15:51:54.133
> 
> 标签：jquery, mvvm, knockout.js

我有一个复选框绑定到视图模型上的可观察对象。我需要基本上弹出一个“你确定吗？” 如果用户将其从 true 更改为 false，则确认提示。我很难找到使更改“可取消”的最佳位置。. .

1) 单击事件的 jQuery 处理程序 2) Viewmodel 内部订阅“beforeChange” 3) Viewmodel 内部订阅（正常）

无论如何，我更愿意有机会彻底取消更改，而不是对更改做出反应，如果需要，可能会将其恢复到以前的值。

Knockout 的订阅事件是否让您有机会取消更改？任何见解将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-14T16:28:05.493

这是一个使用 jQuery 的 stopImmediatePropagation 的简单选项：

[http://jsfiddle.net/rniemeyer/cBvXM/](http://jsfiddle.net/rniemeyer/cBvXM/)

```
<input type="checkbox" data-bind="click: confirmCheck, checked: myvalue" /> 
```

js：

```
var viewModel = {
    myvalue: ko.observable(false),
    confirmCheck: function(data, event) {
        if (!confirm("Are you sure?")) {
            event.stopImmediatePropagation();            
            return false;
        }
        return true;
    }
}; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-01-31T14:40:29.403

由于@RP Niemeyer 回答中评论的问题，我刚刚实现了这个扩展器：

```
ko.extenders.confirmable = function(target, options) {
    var message = options.message;
    var unless = options.unless || function() { return false; }
    //create a writeable computed observable to intercept writes to our observable
    var result = ko.computed({
        read: target,  //always return the original observables value
        write: function(newValue) {
            var current = target();

            //ask for confirmation unless you don't have
            if (unless() || confirm(message)) {
                target(newValue);
            } else {
              target.notifySubscribers(current);
            }
        }
    }).extend({ notify: 'always' });

    //return the new computed observable
    return result;
}; 
```

然后，您可以将其应用于您的模型，如下所示：

```
var viewModel = {
    myvalue: ko.observable(false).extend({confirmable: "Are you sure?"});
} 
```

而且，如果有不要求确认的情况（在这个愚蠢的例子中，我们将在 3 月跳过确认），你可以这样做：

```
var viewModel = {
    myvalue: ko.observable(false).extend({confirmable: { message: "Are you sure?", unless: function() { return new Date().getMonth() == 2 }} });
} 
```

# oracle - ORACLE 11g UTL_SMTP 和“回复”/“代表”

> ID：10586753
> 
> 赞同：1
> 
> 时间：2012-05-14T15:51:54.460
> 
> 标签：oracle, email, smtp, oracle11g

我们正在使用`UTL_SMTP`ORACLE 11g 中的软件包代表用户从我们的系统发送电子邮件。

这一切都通过一个通用的 SENDER 帐户发送出去，以针对 SMTP 服务器进行验证。

我们希望电子邮件看起来来自通过系统发送它们的用户。有没有办法使用 UTL_SMTP 包向发送的电子邮件添加以下一个或两个属性：

REPLYTO - 邮件回复应定向到的地址
ONBEHALFOF - 我知道 Outlook 允许您在发送电子邮件时指定此地址，然后当收件人收到它时，它会*代表其他用户显示为来自 smtp 帐户*

我认为 REPLYTO 将是最重要的，因此收件人可以回复发送电子邮件的用户，但如果有 ONBEHALFOF 也很好。

不过，仔细阅读软件包的智能感知和文档，我看不到任何添加这些的方法。有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:26:09.857

请参阅此[AskTom 问题](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3aNO%3a%3aP11_QUESTION_ID:1739411218448)以了解解决方法。如果“代表”字段有标题，您应该可以同时执行这两项操作，但示例中包含“回复”。

这是 Tim Hall 的 Oracle-Base 站点的[另一个示例](http://www.oracle-base.com/articles/misc/email-from-oracle-plsql.php)。请参阅“多行电子邮件”部分。

这几乎相当于将整个邮件信封强制写入 SMTP 服务器。

# salesforce - 如何通过 API 一次显示 Salesforce 验证规则错误消息

> ID：10586755
> 
> 赞同：5
> 
> 时间：2012-05-14T15:52:12.000
> 
> 标签：salesforce

在当前版本的 Salesforce 中，

*   如果我在一个对象上定义了多个验证规则错误消息
*   如果在点击保存时不遵守这些规则
*   然后我收到多条错误消息（一次全部）。

这是我在使用 API 调用时想要的。

就像现在一样，我只能通过 API 调用一一收到错误消息。有没有办法像在 Salesforce 界面中那样一次显示所有错误消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T14:42:45.833

不，目前 API 处理在第一个错误时停止并报告，没有办法必须报告所有错误。

# .net - 将多个格式化单元格粘贴到excel 12中

> ID：10586756
> 
> 赞同：0
> 
> 时间：2012-05-14T15:52:13.733
> 
> 标签：.net, winforms, excel, clipboard

我使用自定义数据网格在单元格中存储一些格式化文本，然后使用 winforms 内置 rtf 编辑器在单元格中显示和存储数据。我想使用 windows 剪贴板与 excel 交换数据。但是，我不能让 excel 接受 RTF 标记。我得到的不是格式化数据，而是所有文本以及 RTF 标记。请注意，我想复制/粘贴多个单元格。

有没有办法提示 excel 12 使其使用标记？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T20:21:42.010

考虑在将网格推送到剪贴板时生成与[数据交换格式](http://en.wikipedia.org/wiki/Data_Interchange_Format)兼容的剪贴板条目。

Excel 将给定网格部分的许多变体推送到剪贴板中。以相同的方式进行操作，Excel 将能够以表格的形式读取剪贴板内容。

[您还可以使用这样](http://www.freeclipboardviewer.com/)的剪贴板查看器查看 Excel 在剪贴板中生成的格式。

# c# - 隐藏动态 div 标签，包含动态输入按钮

> ID：10586760
> 
> 赞同：0
> 
> 时间：2012-05-14T15:52:35.993
> 
> 标签：c#, asp.net, css

我在 C#(Asp.net) 中的标签内动态创建了一个 div 标签，该标签将包含 3 个动态生成的按钮。我只希望当用户将鼠标悬停在表格单元格（td 标记）上时显示 div。我可以通过 .css 实现这一目标吗？

C# 中的动态生成如下所示：

```
HtmlTableCell cell = (HtmlTableCell)c;

                        HtmlInputButton PopupAddButton = new HtmlInputButton();
                        PopupAddButton.ID = "PBA" + c.ID.ToString();
                        PopupAddButton.Value = "Add";
                        PopupAddButton.Style["Height"] = "14px";
                        PopupAddButton.Style["Width"] = "40px";
                        PopupAddButton.Style.Add(HtmlTextWriterStyle.Top, "-100");
                        PopupAddButton.Style["right"] = "0";
                        PopupAddButton.Style["float"] = "left";
                        PopupAddButton.Style["vertical-align"] = "top";
                        PopupAddButton.Style["font-size"] = "9px";

                        HtmlInputButton PopupEditButton = new HtmlInputButton();
                        PopupEditButton.ID = "PBE" + c.ID.ToString();
                        PopupEditButton.Value = "Edit";
                        PopupEditButton.Style["Height"] = "14px";
                        PopupEditButton.Style["Width"] = "40px";
                        PopupEditButton.Style["top"] = "0";
                        PopupEditButton.Style["right"] = "0";
                        PopupEditButton.Style["float"] = "left";
                        PopupEditButton.Style["vertical-align"] = "top";
                        PopupEditButton.Style["font-size"] = "9px";

                        HtmlInputButton PopupDeleteButton = new HtmlInputButton();
                        PopupDeleteButton.ID = "PBD" + c.ID.ToString();
                        PopupDeleteButton.Value = "Delete";
                        PopupDeleteButton.Style["Height"] = "14px";
                        PopupDeleteButton.Style["Width"] = "40px";
                        PopupDeleteButton.Style["top"] = "0";
                        PopupDeleteButton.Style["right"] = "0";
                        PopupDeleteButton.Style["float"] = "left";
                        PopupDeleteButton.Style["font-size"] = "9px";
                        PopupDeleteButton.Style.Add(HtmlTextWriterStyle.VerticalAlign, "top");

                        PopupAddButton.Attributes.Add("onClick", "AddPopupControlToTableCell('" + cell.ClientID + "', '" + cell.Height.ToString() + "', '" + g_PopupControlId + "');");
                        PopupEditButton.Attributes.Add("onClick", "EditPopupControlToTableCell('" + cell.ClientID + "', '" + cell.Height.ToString() + "', '" + g_PopupControlId + "');");
                        PopupDeleteButton.Attributes.Add("onClick", "DeletePopupControlToTableCell('" + cell.ClientID + "', '" + cell.Height.ToString() + "', '" + g_PopupControlId + "');");

                        HtmlGenericControl ButtonDiv = new HtmlGenericControl("div");
                        ButtonDiv.ID = "buttonBlock" + c.ID.ToString();
                        ButtonDiv.Attributes.Add("class", "buttonBlock");

                        ButtonDiv.Controls.Add(PopupAddButton);
                        ButtonDiv.Controls.Add(PopupEditButton);
                        ButtonDiv.Controls.Add(PopupDeleteButton);

                        cell.Controls.Add(ButtonDiv); 
```

我的 .css 目前看起来像这样

```
.buttonBlock input{
  display:none;
}
td:hover #buttonBlock input{
 display:inline;
} 
```

但是，这不起作用。我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:01:05.610

尝试先修复此代码

```
td:hover #buttonBlock input{
display:inline;
} 
```

到

```
td:hover .buttonBlock input{
display:inline;} 
```

您的原件正在寻找 buttonBlock ( `#buttonBlock`) 的 id，而它应该寻找 buttonBlock ( `.buttonBlock`)的类

# java - 通过 Dijkstra 算法从每个节点作为源计算到所有节点的最短路径时出现 Java 内存堆错误

> ID：10586767
> 
> 赞同：4
> 
> 时间：2012-05-14T15:52:58.363
> 
> 标签：java, algorithm, out-of-memory, shortest-path, dijkstra

我有一个由 7 个节点和 8 个链接组成的网络。我从互联网上的示例中学习了以下课程。我想计算从每个节点到所有其他节点的最短路径。为此，我在 Solve (main) 中编写了所需**的 for**循环。但是，我得到了显示的输出。从第一个节点 Harrisburg 出发的最短路径很好。从第二个节点开始，出现 java 内存不足。我需要做什么？谢谢你的帮助。

顶点.java

```
 public class Vertex implements Comparable<Vertex> {

    public final String name;
    public Edge[] adjacencies;
    public double minDistance = Double.POSITIVE_INFINITY;
    public Vertex previous;
    public double population, employment;
    public double targetPopulation, targetEmployment;

    public Vertex (String argName, double population, double employment, double targetPopulation, double targetEmployment) {
        this.name = argName;
        this.population = population;
        this.employment = employment;
        this.targetPopulation = targetPopulation;
        this.targetEmployment = targetEmployment;
    }

    public String toString() {
        return name;
    }

    //Vertex comparator
    @Override
    public int compareTo(Vertex other) {
        // TODO Auto-generated method stub
        return Double.compare(minDistance, other.minDistance);
    }

    } 
```

Edge.java

```
public class Edge {

public final Vertex target;
public final double weight;

public Edge(Vertex argTarget, double argWeight) {
    this.target = argTarget;
    this.weight = argWeight;
}

} 
```

Dijkstra.java

```
public class Dijkstra {

//simple compute paths function
public void computePaths(Vertex source) {
    source.minDistance = 0.;

    //Visit each vertex u, always visiting vertex with smallest minDistance first
    PriorityQueue<Vertex> vertexQueue = new PriorityQueue<Vertex>();
    vertexQueue.add(source);

    while (!vertexQueue.isEmpty()) {
        Vertex u = vertexQueue.poll();

        //Visit each edge exiting u
        for (Edge e : u.adjacencies) {
            Vertex v = e.target;
            double weight = e.weight;

            //relax the edge (u,v)
            double distanceThroughU = u.minDistance + weight;
            if(distanceThroughU < v.minDistance) {
                //remove v from queue
                vertexQueue.remove(v);

                v.minDistance = distanceThroughU;
                v.previous = u;

                //re-add v to queue
                vertexQueue.add(v);
            }
        }
    }

}

//get shortest path function
public List<Vertex> getShortestPathTo(Vertex target) {
    List<Vertex> path = new ArrayList<Vertex>();
    for (Vertex vertex = target; vertex != null; vertex = vertex.previous) {
        path.add(vertex);
    }

    Collections.reverse(path);
    return path;
}

} 
```

求解.java

```
Vertex v0 = new Vertex("Harrisburg", 5, 0.5, 9, 5);
Vertex v1 = new Vertex("Baltimore", 61, 21, 91, 32);
Vertex v2 = new Vertex("Washington", 99, 10, 10, 10);
Vertex v3 = new Vertex("Philadelphia", 159, 30, 100, 45);
Vertex v4 = new Vertex("Binghamton", 10, 10, 10, 10);
Vertex v5 = new Vertex("Allentown", 10, 10, 10, 10);
Vertex v6 = new Vertex("New York", 891, 200, 400, 220);

v0.adjacencies = new Edge[] { new Edge(v1, distances[0]),
                                new Edge(v5, distances[1]) };

    v1.adjacencies = new Edge[] { new Edge(v0, distances[0]),
                                new Edge(v2, distances[2]),
                                new Edge(v3, distances[3])};

    v2.adjacencies = new Edge[] { new Edge(v1, distances[2])};

    v3.adjacencies = new Edge[] { new Edge(v1, distances[3]),
                                new Edge(v5, distances[4]),
                                new Edge(v6, distances[5])};

    v4.adjacencies = new Edge[] { new Edge(v5, distances[6])};

    v5.adjacencies = new Edge[] { new Edge(v0, distances[1]),
                                new Edge(v3, distances[4]),
                                new Edge(v4, distances[6]),
                                new Edge(v6, distances[7]) };

    v6.adjacencies = new Edge[] { new Edge(v3, distances[5]),
                                new Edge(v5, distances[7]) };

Vertex[] vertices = {v0, v1, v2, v3, v4, v5, v6};

Dijkstra dijkstra = new Dijkstra();

........

for(int i = 0; i < vertices.length; i++) {

                    for(Vertex v : vertices) {
            v.setMinDistance(Double.POSITIVE_INFINITY);
        }
        dijkstra.computePaths(vertices[i]);
        //print out shortest paths and distance

        System.out.println("Shortest paths from "+ vertices[i].name);
        for (Vertex v: vertices) {
            System.out.println("Distance to " + v + ": " + v.minDistance);
            List<Vertex> shortestPath = dijkstra.getShortestPathTo(v);
            System.out.println("Path: " + shortestPath);

            currentAccE[i] = currentAccE[i] + (v.employment)*impedance(v.minDistance);
            currentAccP[i] = currentAccP[i] + (v.population)*impedance(v.minDistance);

        }
    }

........ 
```

输出：

```
Solve started..........
Shortest paths from Harrisburg
Distance to Harrisburg: 0.0
Path: [Harrisburg]
Distance to Baltimore: 79.0
Path: [Harrisburg, Baltimore]
Distance to Washington: 118.0
Path: [Harrisburg, Baltimore, Washington]
Distance to Philadelphia: 142.0
Path: [Harrisburg, Allentown, Philadelphia]
Distance to Binghamton: 214.0
Path: [Harrisburg, Allentown, Binghamton]
Distance to Allentown: 81.0
Path: [Harrisburg, Allentown]
Distance to New York: 172.0
Path: [Harrisburg, Allentown, New York]
Shortest paths from Baltimore
Distance to Harrisburg: 79.0
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
at java.util.Arrays.copyOf(Arrays.java:2760)
at java.util.Arrays.copyOf(Arrays.java:2734)
at java.util.ArrayList.ensureCapacity(ArrayList.java:167)
at java.util.ArrayList.add(ArrayList.java:351)
at umd.sapeksha.shortestpath.Dijkstra.getShortestPathTo(Dijkstra.java:48)
at umd.sapeksha.shortestpath.Solve.main(Solve.java:109) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T17:57:51.830

每次更改源时都需要重新初始化`minDistance`顶点，否则算法将使用先前计算的最小距离，这显然会根据您从哪里开始而有所不同。`Double.POSITIVE_INFINITY`

# regex - grep 和替换表单内容

> ID：10586768
> 
> 赞同：0
> 
> 时间：2012-05-14T15:53:01.420
> 
> 标签：regex, perl, replace, grep

致力于识别和调整表单内容条目。提交表单时，我正在使用 grep 消除数组中的值：

```
# Get the input
read(STDIN, $buffer, $ENV{'CONTENT_LENGTH'});

# The following zaps entire value containing the item(s) grepped.
  @OrigArray = split(/&/, $buffer);
  @pairs = grep(!/kartridgeclub|bubba.org|\.ru/i, @OrigArray); 
```

但我更愿意确定输入了哪些不需要的字符序列，并且（无论输入了哪个），包括一个条件语句，如果提交了任何不需要的字符序列，它将产生唯一的“返回页面”文本。

我认为，我不能使用简单替换而不是 grep，因为我需要替换包含不需要的字符的整个数组元素。

换句话说，用户在表单字段中输入了一堆垃圾总是包含一些.org-with-ru 扩展名（或 bubba.org 等）。我如何识别他输入的 grep 中的哪些短语？然后，用我选择的短语替换它（而不是仅仅从数组中删除它）并为该用户生成不同的“谢谢”页面？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T18:58:24.380

Cfreak 的问题是务实的：使用 CGI 处理表单的输入。使用 CGI 的 param 函数，检查表单的“不需要的字符序列”参数，然后根据您发现的内容进行相应的更改和/或分支。例如：

```
use strict;
use warnings;
use CGI qw(:standard);
use 5.010;

my $input_field = param('input_field');

given(lc $input_field) {
    when(/kartridgeclub/) {
        print 'kartridgeclub';
        # do something else
    }
    when(/bubba\.org\b/) {
        print 'bubba.org';
        # do something else
    }
    when(/\.ru\b/) {
        print '.ru';
        # do something else
    }
    when(/this|that/) {
        print 'this or that';
        # do something else
    }
    default {
        print 'Your entry seems OK.';
        # do something else
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T05:30:26.390

虽然我完全同意您最好使用 CGI 的其他帖子，但我认为这条线应该可以实现您想要的。

```
my %pairs = map { $_ => ($_ =~ /kartridgeclub|bubba.org|\.ru/i ? 'invalid' : 'valid')} @orig_array; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:09:37.250

只是不要使用 grep。使用良好的旧 for 循环并编写一些代码。

```
for my $i (0 .. $#OrigArray) {
    my $pair = $OrigArray[$i];
    if ($pair =~ m/whatever/) {
        # you're welcome to change $OrigArray[$i] here
    }
} 
```

# python - 玛雅/蟒蛇援助！有人熟悉 Maya API 吗？

> ID：10586773
> 
> 赞同：-4
> 
> 时间：2012-05-14T15:53:41.900
> 
> 标签：python, maya

所以..我想要做的是更改引用（即到文件 C:/User/Desktop/file01/Cindi.ma）..我将如何使用 Python 代码来更改对 C:/User 的引用/Desktop/file02/Cindi.ma? 任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T12:08:07.500

```
import maya.cmds as mc

#First query the reference node name to replace reference. 
rfn = mc.file( "C:/User/Desktop/file01/Cindi.ma", q=1, rfn=1 )

#then use reference node name(rfn) to replace the path.
mc.file ( "C:/User/Desktop/file02/Cindi.ma", loadReference=rfn, type="mayaAscii", options="v=0") 
```

# python - 在 Python 字符串中测试布尔表达式

> ID：10586778
> 
> 赞同：5
> 
> 时间：2012-05-14T15:53:48.990
> 
> 标签：python, parsing

我在字符串中有一个布尔表达式。例如。`20 < 30`. 有没有一种简单的方法来解析和评估这个字符串，所以它会返回`True`（在这种情况下）。

`ast.literal_eval("20 < 30")`不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T15:58:45.777

这是用户定义的字符串，还是您正在定义的字符串？

如果它是您正在创建的字符串，您可以使用`eval`( `eval("20 < 30")`)，但如果字符串是由用户提供的，您可能需要先对其进行清理...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:56:34.107

```
>>> eval("20<30")
True 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:12:11.117

`ast.literal_eval`不应该工作，因为（来自文档）“提供的字符串或节点可能只包含以下 Python 文字结构：字符串、数字、元组、列表、字典、布尔值和无。”。该表达式在*返回*a`20<30`之前需要某种评估。*`bool`*

 *一个更安全的建议是`literal_eval`在传递给之前拆分运算符和每一侧的字符串`eval`，即。

```
import ast

expr = "20 < 30"
operator = "<"
lhs,rhs = map(ast.literal_eval, map(str.strip, expr.split(operator)))
eval("%s %s %s"%(lhs,operator,rhs)) 
```

将事物包装在`try, except`子句中会在评估时捕获一些输入错误`lhs,rhs`。*

# .htaccess - redirectmatch 更改帖子以获取

> ID：10586779
> 
> 赞同：10
> 
> 时间：2012-05-14T15:53:51.263
> 
> 标签：.htaccess, redirect

我有两个分开的虚拟主机。在万维网。一，我在 .htaccess 上安装了这一行

```
redirectMatch 301 ^(.*)$ http://d_blur_blur_s.com$1 
```

除了将 POST 转换为 GET 的情况外，一切都按预期工作。
请注意，帖子有参数作为获取（我没有这样做，我不会更改它）我只是想避免重复的内容。我正在显示萤火虫痕迹。

我希望通过 redirectmatch 或其他技巧将 POST 重定向到主域。

![萤火虫踪迹](../Images/69bcd2a00ac815c1212a9c594a8043b7.png)

**更新**
我在网站上有一半的内部链接写有 www，另一半没有。所以我需要保持公开但不重复。我需要将 GET 作为 GET 转发，将 POST 作为 POST 转发。问题很大，我有 12000 页索引，还有很多表格。所以我首先在不更改代码的情况下寻找通用解决方案。我完全控制服务器。

非常感谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T18:08:15.693

您使用 307 而不是 301 进行重定向来保留帖子数据，但是如果用户确定要发送帖子数据，某些浏览器会向用户显示一个对话框，因此并不漂亮。

但我宁愿从根本上解决问题。如果 html-form 引用了错误的域（例如`<form action="www.d_blur_blur_s/public/main/loginGenerator.php" ...`），您会得到一个错误域的帖子的唯一方法。只需修复html。

不要担心重复的内容，因为搜索引擎从不发送后期请求，只会获取。您当前的解决方案应该可以防止重复的内容。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-14T15:57:25.243

无论是 POST 还是 GET 请求，服务器对您发出的任何请求的重定向响应总是会导致您的客户端发出 GET 请求（除非您以某种方式使其不会自动跟随重定向——有时我使用 curl 执行此操作，但我不知道任何具有此功能的广泛使用的浏览器可供用户轻松使用）。客户端浏览器获取重定向提供的 URL 并将其视为 URL 以执行 GET 请求。没有办法，POST 数据被服务器丢弃，因为它是为原始 URL 上的服务器资源准备的。

如果您在 .htaccess 之外重定向，例如在 PHP 文件中构建重定向响应，您唯一的选择是将 POST 参数转换为 GET 参数字符串并将其添加到您发送回客户端的 URL 的末尾重定向响应。

我相当有信心，无论您使用重定向指令还是通过 mod_rewrite 模块的重写指令，都无法在 .htaccess 文件或 httpd.conf 文件中进行自动 POST 参数附加到重定向。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-18T15:19:03.647

进行重定向和保留 POST 数据*（我知道）*的唯一方法是将 mod_rewrite 与 mod_proxy 一起使用，然后`P`在 RewriteRule 中使用标志。

在您的`www`主机上启用**mod_rewrite、mod_rewrite 和 .htaccess**，`httpd.conf`然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteRule ^ http://d_blur_blur_s.com%{REQUEST_URI} [P] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-04T23:06:55.160

我也碰到了这个 POST->GET 重写。像这样的 API 调用：

```
 curl -X POST https://example.com/api/user/123456789 
```

正在使用 GET 请求方法进入我的 API 框架。

原因似乎与带有空正文的 POST 请求有关。为避免此问题，您可以设置`Content-Length`标题：

```
 curl -X POST https://example.com/api/user/123456789 -H 'Content-Length: 0' 
```

或在体内传递一些东西：

```
 curl -X POST https://example.com/api/user/123456789 -d '' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-13T12:39:55.503

将 www 添加到基本 URL 为我做了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-29T10:17:54.933

在 HTTP 1.1 中，statusCode (307) 表示应该使用相同的方法重复请求并发布数据。更改重定向类型以修复它。 [![在此处输入图像描述](../Images/6005d4f7ea8d8b8c7e85e3455fd5193a.png)](https://i.stack.imgur.com/eM0wh.jpg)

# python - 向 python 子进程发送复杂的 shell 命令

> ID：10586780
> 
> 赞同：4
> 
> 时间：2012-05-14T15:53:55.847
> 
> 标签：python, python-3.x, subprocess, python-2.7

我正在编写一个在 python 中使用一系列复杂 Imagemagick 命令的脚本。我想知道如何称呼这样的东西......

`convert 1.png \( +clone -background black -shadow 110x1+9+9 \) +swap -background none -layers merge +repage 2.png`

我很乐意用子进程调用简单的命令，但我还不知道如何指定执行顺序（转义括号）。

当然我可以使用 os.system 或 commands 模块，但由于这些都离开了语言，我肯定更喜欢使用子进程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:01:46.417

是的，您想使用`subprocess`. 您只需将每个参数放在您提供给的参数列表中的一个单独项目中`Popen`：

```
subprocess.Popen(['convert', '1.png', '(', '+clone', '-background', 'black', '-shadow', '110x1+9+9',
                  ')', '+swap', '-background', 'none', '-layers', 'merge', '+repage', '2.png'],
                 otherargments=values, etc=etc) 
```

您也可以预先建立该参数列表，以防您的参数顺序需要更改。

您不需要对参数进行任何转义（例如参数内的空格或其他特殊的 shell 字符，如“（”和“）”），因为这不会被 shell 解释。

# android - 如何从另一个 XML 文件中查找 ViewById？

> ID：10586783
> 
> 赞同：2
> 
> 时间：2012-05-14T15:54:02.823
> 
> 标签：android, android-layout, android-inflate

我用 addevent.xml 连接一个 addevent.java 是一个列表视图，列表视图从另一个 XML 文件“item.xml”中获取它的元素

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

        <Button
            android:id="@+id/d"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:drawablePadding="0dip"
            android:drawableRight="@drawable/icon_name" />

        <EditText
            android:id="@+id/en"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentTop="true"
            android:layout_toLeftOf="@+id/d" >
        </EditText>

</LinearLayout> 
```

现在我需要findviewbyId不是从基本的xml文件而是形成另一个“item.xml”

我尝试**了 LayoutInflater**这样的代码，但它不起作用：

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.addevent);
        myList = (ListView) findViewById(R.id.MyList);
        myList.setItemsCanFocus(true);
        myAdapter = new MyAdapter();
        myList.setAdapter(myAdapter);

        final LayoutInflater factory = getLayoutInflater();

        final View textEntryView = factory.inflate(R.layout.item, null);

        tvDisplayDate = (EditText)textEntryView.findViewById(R.id.editd);
        btnChangeDate=(Button)textEntryView.findViewById(R.id.d); 
```

请有任何帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T16:05:49.217

试试这个`View view = LayoutInflater.from(getApplication()).inflate(R.layout.item, null);`

您如何看到，静态 from() 方法需要 1 个参数（上下文），并且您从给定的上下文中获取 LayoutInflater，在您的情况下，它将是您想要为 View 膨胀的 Activity。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:07:14.043

在您的`MyAdapter`类中，您可以覆盖该`getView`方法（即按需生成项目渲染器的方法）。

在为当前项目（例如`convertView`）回收/膨胀正确的布局之后，您可以使用`findViewById`调用的方法访问其所有子项`convertView`：

```
 @Override
    public View getView(int position, View convertView, ViewGroup parent)
    {
        // initialize, inflate convertView from your layout if needed; 
        tvDisplayDate = (EditText)convertView.findViewById(R.id.editd);
        // populate convertView with the item's details
    } 
```

|  
<canvas id="wf1" class="wfblock" style="background-color:red;"></canvas>

 |  
<canvas id="pm1" style="background-color: green; width: 200px; height: 84px;"></canvas>

<canvas id="pm2" style="background-color: blue; width: 200px; height: 84px;"></canvas>

 |

There are several probable causes of this: Cellular data networks are not "always-on". Depending on the underlying technology, there can be a substantial delay between when a first packet is sent and when IP connectivity is actually established. This will be most noticeable after IP networking has been idle for some time. Your receiver may not be correctly checking the socket for readability. Regardless of what high-level APIs you may be using, underneath there needs to be a call to select() to check whether the socket is readable. When a datagram arrives, select() should unblock and signal that the socket descriptor is readable. Alternatively, but less efficiently, you could set the socket to non-blocking and poll it with a read. Polling wastes CPU time when there is no data and delays detection of arrival for up to the polling interval, but can be useful if for some reason you can't spare a thread to wait on select(). I said above that select() should signal readability on a watched socket when data arrives, but this behavior can be modified by the socket's "Receive low-water mark". The default value is usually 1, meaning any data will signal readability. But if SO_RCVLOWAT is set higher (via setsockopt() or a higher-level equivalent), then readability will be not be signaled until more than the specified amount of data has arrived. You can check the value with getsockopt() or whatever API is equivalent in your environment. Item 1 would cause the first datagram to actually be delayed, but only when the IP network has been idle for a while and not once it comes up active. Items 2 and 3 would only make it appear to your program that the first datagram was delayed: a packet sniffer at the receiver would show the first datagram arriving on time. htmlcanvas 4 1 回答 1 This answer is useful 0 您的画布可以在两个方向上调整：增长和缩小。 我经常这样做，但我发现唯一始终有效的方法（尤其是在涉及表格时）是为宽度和高度提供 100% 的尺寸，并以经典方式调整容器（无论是 atd还是 a div）。 为了避免视口尺寸与画布尺寸不同的问题，我总是为调整大小事件添加一个侦听器。 使用 jquery，我通常会得到这种类，其中为每个画布创建一个 Grapher 实例： function Grapher(options) { this.graphId = options.canvasId; this.dimChanged = true; // you may remove that if you want (see above) }; Grapher.prototype.draw = function() { if (!this._ensureInit()) return; // makes all the drawing, depending on the state of the application's model // uses dimChanged to know if the positions and dimensions of drawed objects have // to be recomputed due to a change in canvas dimensions } Grapher.prototype._ensureInit = function() { if (this.canvas) return true; var canvas = document.getElementById(this.graphId); if (!canvas) { return false; } if (!$('#'+this.graphId).is(':visible')) return false; this.canvas = canvas; this.context = this.canvas.getContext("2d"); var _this = this; var setDim = function() { _this.w = _this.canvas.clientWidth; _this.h = _this.canvas.clientHeight; _this.canvas.width = _this.w; _this.canvas.height = _this.h; _this.dimChanged = true; _this.draw(); // calls the function that draws the content }; setDim(); $(window).resize(setDim); // other inits (mouse hover, mouse click, etc.) return true; }; 在你的情况下，我会创建例如new Grapher({canvasId:'#wf1'}). 于 2012-05-14T19:41:30.793 回答 Related 1 perl - 使用 cgi 上传 Jquery 文件 2 bash - 在 sqlplus comman 中传递变量 user,pass,sid 2 php - 以编程方式设置基础图像 3 regex - 如何从结果中的正则表达式中排除匹配 1 android - 在android中打开文本文件 2 java - 提升java单线程性能——在软件端 4 java - 这个例子的正确正则表达式是什么？ 3 php - 如何使按钮在同一页面上执行但不在下一页上 1 javascript - jQuery 手风琴 | 在页面加载和活动状态混淆时打开第一个元素 1 stored-procedures - db2 存储过程动态创建选择查询 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641 <link href="../Styles/Style.css" type="text/css" rel="stylesheet">

# html - 拿不到 在 a 中缩小宽度 I am having a problem getting the desired layout of canvas elements on a page. I am using a table to do the layout. The desired layout is to have one canvas to the left that is full height and two other canvases to th 问问题 问问题 2012-05-14T15:54:05.507 1799 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I am having a problem getting the desired layout of canvas elements on a page. I am using a table to do the layout. The desired layout is to have one canvas to the left that is full height and two other canvases to the right, one on top of the other, with a combined height of the left canvas. The two right canvases are of fixed width and height. When the browser window is resized I want the left canvas to resize to take up all the width available (up to the width of the right canvases). I am using window.onresize event to catch the resize events and to resize the left canvas. The problem I see is that the left cavas will resize correctly when the browser window width gets bigger, but fails to shrink when the browser window width gets smaller! The code is below. What gives? Is there something inherent in canvas that doesn't allow flexible resizing? I have searched for a answer to this issue with no luck. Hopefully someone here has conquered this and can give me a hand. Here is sample code: <title>SO Example</title>  

|  
<canvas id="wf1" class="wfblock" style="background-color:red;"></canvas>

 |  
<canvas id="pm1" style="background-color: green; width: 200px; height: 84px;"></canvas>

<canvas id="pm2" style="background-color: blue; width: 200px; height: 84px;"></canvas>

 |

There are several probable causes of this: Cellular data networks are not "always-on". Depending on the underlying technology, there can be a substantial delay between when a first packet is sent and when IP connectivity is actually established. This will be most noticeable after IP networking has been idle for some time. Your receiver may not be correctly checking the socket for readability. Regardless of what high-level APIs you may be using, underneath there needs to be a call to select() to check whether the socket is readable. When a datagram arrives, select() should unblock and signal that the socket descriptor is readable. Alternatively, but less efficiently, you could set the socket to non-blocking and poll it with a read. Polling wastes CPU time when there is no data and delays detection of arrival for up to the polling interval, but can be useful if for some reason you can't spare a thread to wait on select(). I said above that select() should signal readability on a watched socket when data arrives, but this behavior can be modified by the socket's "Receive low-water mark". The default value is usually 1, meaning any data will signal readability. But if SO_RCVLOWAT is set higher (via setsockopt() or a higher-level equivalent), then readability will be not be signaled until more than the specified amount of data has arrived. You can check the value with getsockopt() or whatever API is equivalent in your environment. Item 1 would cause the first datagram to actually be delayed, but only when the IP network has been idle for a while and not once it comes up active. Items 2 and 3 would only make it appear to your program that the first datagram was delayed: a packet sniffer at the receiver would show the first datagram arriving on time. htmlcanvas 4 1 回答 1 This answer is useful 0 您的画布可以在两个方向上调整：增长和缩小。 我经常这样做，但我发现唯一始终有效的方法（尤其是在涉及表格时）是为宽度和高度提供 100% 的尺寸，并以经典方式调整容器（无论是 atd还是 a div）。 为了避免视口尺寸与画布尺寸不同的问题，我总是为调整大小事件添加一个侦听器。 使用 jquery，我通常会得到这种类，其中为每个画布创建一个 Grapher 实例： function Grapher(options) { this.graphId = options.canvasId; this.dimChanged = true; // you may remove that if you want (see above) }; Grapher.prototype.draw = function() { if (!this._ensureInit()) return; // makes all the drawing, depending on the state of the application's model // uses dimChanged to know if the positions and dimensions of drawed objects have // to be recomputed due to a change in canvas dimensions } Grapher.prototype._ensureInit = function() { if (this.canvas) return true; var canvas = document.getElementById(this.graphId); if (!canvas) { return false; } if (!$('#'+this.graphId).is(':visible')) return false; this.canvas = canvas; this.context = this.canvas.getContext("2d"); var _this = this; var setDim = function() { _this.w = _this.canvas.clientWidth; _this.h = _this.canvas.clientHeight; _this.canvas.width = _this.w; _this.canvas.height = _this.h; _this.dimChanged = true; _this.draw(); // calls the function that draws the content }; setDim(); $(window).resize(setDim); // other inits (mouse hover, mouse click, etc.) return true; }; 在你的情况下，我会创建例如new Grapher({canvasId:'#wf1'}). 于 2012-05-14T19:41:30.793 回答 Related 1 perl - 使用 cgi 上传 Jquery 文件 2 bash - 在 sqlplus comman 中传递变量 user,pass,sid 2 php - 以编程方式设置基础图像 3 regex - 如何从结果中的正则表达式中排除匹配 1 android - 在android中打开文本文件 2 java - 提升java单线程性能——在软件端 4 java - 这个例子的正确正则表达式是什么？ 3 php - 如何使按钮在同一页面上执行但不在下一页上 1 javascript - jQuery 手风琴 | 在页面加载和活动状态混淆时打开第一个元素 1 stored-procedures - db2 存储过程动态创建选择查询 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10586785
> 
> 赞同：0
> 
> 时间：
> 
> 标签：html, canvas

I am having a problem getting the desired layout of canvas elements on a page. I am using a table to do the layout. The desired layout is to have one canvas to the left that is full height and two other canvases to the right, one on top of the other, with a combined height of the left canvas. The two right canvases are of fixed width and height. When the browser window is resized I want the left canvas to resize to take up all the width available (up to the width of the right canvases). I am using window.onresize event to catch the resize events and to resize the left canvas.

The problem I see is that the left cavas will resize correctly when the browser window width gets bigger, but fails to shrink when the browser window width gets smaller! The code is below. What gives? Is there something inherent in canvas that doesn't allow flexible resizing?

I have searched for a answer to this issue with no luck. Hopefully someone here has conquered this and can give me a hand.

Here is sample code:

```
<!DOCTYPE html>
<html>
    <head>
        <title>SO Example</title>
        <script type="text/javascript">
            window.onload = function ()
            {
                var canvas = document.getElementById("wf1");
                canvas.width = canvas.parentNode.clientWidth;
                canvas.height = canvas.parentNode.clientHeight;
            }
            window.onresize = function ()
            {
                var canvas = document.getElementById("wf1");
                canvas.width = canvas.parentNode.clientWidth;
                canvas.height = canvas.parentNode.clientHeight;
            }
        </script>

        <style type="text/css">
            table
            {
                border-collapse: collapse;
                background-color: #ccc;
            }
            tr, td
            {
                padding: 0;
                line-height: 0;
                width: 100%;
            }
        </style>
    </head>

    <body>
        <table>
            <tr class="slot">
                <td>
                    <canvas id="wf1" class="wfblock" style="background-color:red;"></canvas>
                </td>
                <td>
                    <canvas id="pm1" style="background-color: green; width: 200px; height: 84px;"></canvas>
                    <canvas id="pm2" style="background-color: blue;  width: 200px; height: 84px;"></canvas>
                </td>
            </tr>
        </table>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T19:41:30.793

您的画布可以在两个方向上调整：增长和缩小。

我经常这样做，但我发现唯一始终有效的方法（尤其是在涉及表格时）是为宽度和高度提供 100% 的尺寸，并以经典方式调整容器（无论是 a`td`还是 a `div`）。

为了避免视口尺寸与画布尺寸不同的问题，我总是为调整大小事件添加一个侦听器。

使用 jquery，我通常会得到这种类，其中为每个画布创建一个 Grapher 实例：

```
function Grapher(options) {
    this.graphId = options.canvasId;
    this.dimChanged = true; // you may remove that if you want (see above)
};

Grapher.prototype.draw = function() {
    if (!this._ensureInit()) return;

    // makes all the drawing, depending on the state of the application's model

    // uses dimChanged to know if the positions and dimensions of drawed objects have
    //  to be recomputed due to a change in canvas dimensions

}

Grapher.prototype._ensureInit = function() {
    if (this.canvas) return true;
    var canvas = document.getElementById(this.graphId);
    if (!canvas) {
        return false;
    }
    if (!$('#'+this.graphId).is(':visible')) return false;
    this.canvas = canvas;
    this.context = this.canvas.getContext("2d");
    var _this = this;
    var setDim = function() {
        _this.w = _this.canvas.clientWidth;
        _this.h = _this.canvas.clientHeight;
        _this.canvas.width = _this.w;
        _this.canvas.height = _this.h;
        _this.dimChanged = true;
        _this.draw(); // calls the function that draws the content
    };
    setDim();
    $(window).resize(setDim);
    // other inits (mouse hover, mouse click, etc.)
    return true;
}; 
```

在你的情况下，我会创建例如`new Grapher({canvasId:'#wf1'})`.

# extjs - 网格 ext 4.1 中的日期格式

> ID：10586786
> 
> 赞同：1
> 
> 时间：2012-05-14T15:54:16.223
> 
> 标签：extjs, extjs4.1

我的约会结果不稳定。有时它们会转换为我们的格式。我有以下 json

```
{ "Created":"09/03/12" } 
```

在我的网格中，我有

```
{
  id: 'Created',
  text: "Created",
  dataIndex: 'Created',
  xtype: 'datecolumn',
  format: 'd/m/y',
  width: 150,
  sortable: true,
  field: {
    xtype: 'datefield',
    allowBlank: false,
    format: 'd/m/y'
  }
}, 
```

所以我想显示

`09/03/12`（3 月 9 日）但我得到了`03/09/12`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T21:01:51.550

确保为数据模型中的字段提供正确的 dateFormat `Created`，例如：

```
Ext.define('App.model.FrostysModel', {
    extend: 'Ext.data.Model',
    fields: [
        {name: 'IntData',       type: 'int'}, 
        {name: 'StringData',    type: 'string'},
        {name: 'Created',       type: 'date',   dateFormat: 'd/m/y'}
    ]
}); 
```

我认为 'm/d/y' 是默认值。

**编辑：**

如果添加 dateFormat 不起作用，则 ExtJS 代码中也可能有一些奇怪的东西。

回到 4.02a，我记得必须重写一些东西来处理类似的问题：任何可能是 01 - 12 月份的日期都会自动转换为默认格式，或者类似的奇怪的东西。即 05/01/12（2012 年 1 月 5 日）变成了 2012 年 5 月 1 日，但是像 28/01/12（2012 年 1 月 28 日）这样的日期不会有这个问题，因为 28 不能是一个月。

不幸的是，我再也找不到那个覆盖了，所以你可能需要做一些跟踪。

# python - 我应该什么时候使用@classmethod，什么时候使用def method(self)？

> ID：10586787
> 
> 赞同：109
> 
> 时间：2012-05-14T15:54:17.317
> 
> 标签：python, language-lawyer, class-method, method-dispatch, language-details

在集成我以前没有使用过的 Django 应用程序时，我发现了两种不同的方法来定义类中的函数。作者似乎既独特又有意地使用它们。第一个是我自己经常使用的：

```
class Dummy(object):

    def some_function(self, *args, **kwargs):
        # do something here
        # self is the class instance 
```

另一个是我从不使用的，主要是因为我不明白何时以及将其用于什么用途：

```
class Dummy(object):

    @classmethod
    def some_function(cls, *args, **kwargs):
        # do something here
        # cls refers to what? 
```

python文档中的`classmethod`装饰器说：

> 类方法接收类作为隐式第一个参数，就像实例方法接收实例一样。

所以我猜`cls`是指`Dummy`它自己（`class`不是实例）。我不完全理解为什么会这样，因为我总是可以这样做：

```
type(self).do_something_with_the_class 
```

这只是为了清楚起见，还是我错过了最重要的部分：没有它就无法完成的怪异和迷人的事情？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-05-14T15:58:43.770

您的猜测是正确的 - 您了解*s* `classmethod`的工作原理。

原因是这些方法既可以在实例上也可以在类上调用（在这两种情况下，类对象都将作为第一个参数传递）：

```
class Dummy(object):

    @classmethod
    def some_function(cls,*args,**kwargs):
        print cls

#both of these will have exactly the same effect
Dummy.some_function()
Dummy().some_function() 
```

**关于在实例上使用这些**：在实例上调用类方法至少有两个主要用途：

1.  `self.some_function()`将`some_function`在 的实际类型上调用 的版本`self`，而不是该调用碰巧出现的类（如果类被重命名，则不需要注意）；和
2.  在`some_function`需要实现某些协议但单独调用类对象很有用的情况下。

**与 的区别`staticmethod`**：还有另一种定义不访问实例数据的方法的方法，称为`staticmethod`. 这会创建一个根本不接收隐式第一个参数的方法；因此，它不会传递有关调用它的实例或类的任何信息。

```
In [6]: class Foo(object): some_static = staticmethod(lambda x: x+1)

In [7]: Foo.some_static(1)
Out[7]: 2

In [8]: Foo().some_static(1)
Out[8]: 2

In [9]: class Bar(Foo): some_static = staticmethod(lambda x: x*2)

In [10]: Bar.some_static(1)
Out[10]: 2

In [11]: Bar().some_static(1)
Out[11]: 2 
```

我发现它的主要用途是将现有函数（不期望接收 a `self`）改编为类（或对象）上的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-23T08:38:25.470

Python中最常见的用途之一`classmethod`是工厂，它是构建对象的最有效方法之一。因为`classmethod`s 和`staticmethod`s 一样，不需要构造类实例。（但是如果我们使用`staticmethod`，我们将不得不在函数中硬编码实例类名）

这个博客很好地解释了它： [https ://iscinumpy.gitlab.io/post/factory-classmethods-in-python/](https://iscinumpy.gitlab.io/post/factory-classmethods-in-python/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-02-27T18:11:28.453

基本上，当您意识到方法的定义不会被更改或覆盖时，您应该使用@classmethod。

另外：理论上，类方法比对象方法更快，因为不需要实例化并且需要更少的内存。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-05-14T15:59:47.243

如果你添加装饰器@classmethod，这意味着你要将该方法作为java或C++的静态方法。（我猜静态方法是一个**通用术语****；）**）Python 也有@staticmethod。classmethod 和 staticmethod 之间的区别在于您是否可以使用参数或类名本身访问类或静态变量。

```
class TestMethod(object):
    cls_var = 1
    @classmethod
    def class_method(cls):
        cls.cls_var += 1
        print cls.cls_var

    @staticmethod
    def static_method():
        TestMethod.cls_var += 1
        print TestMethod.cls_var
#call each method from class itself.
TestMethod.class_method()
TestMethod.static_method()

#construct instances
testMethodInst1 = TestMethod()    
testMethodInst2 = TestMethod()   

#call each method from instances
testMethodInst1.class_method()
testMethodInst2.static_method() 
```

所有这些类都将 cls.cls_var 增加 1 并打印它。

并且在相同范围内使用相同名称的每个类或使用这些类构造的实例都将共享这些方法。只有一个 TestMethod.cls_var 也只有一个 TestMethod.class_method() , TestMethod.static_method()

和重要的问题。为什么需要这些方法。

classmethod 或 staticmethod 在您将该类作为工厂或只需要初始化一次类时很有用。就像打开文件一次，并使用 feed 方法逐行读取文件。

# google-maps - Display netCDF files to Google Maps

> ID：10586792
> 
> 赞同：7
> 
> 时间：2012-05-14T15:54:34.103
> 
> 标签：google-maps, netcdf

I have some meteorological data wich are exported to `netCDF` format and I want to display them in Google Maps.

I tried the Panoply software, mainly following these [http://marinedataliteracy.org/ops/pano_gridsvecs.htm](http://marinedataliteracy.org/ops/pano_gridsvecs.htm) instructions and succesfully exported the data into `.kml` files.

The kml file displays fine in Google Earth, but when loading it in Google Maps nothing is being displayed.

The JavaScript code that is loading the kml is definitely correct, because other types of kml are displayed correctly. Just in case, this is the code:

```
var kmzLayer = new google.maps.KmlLayer("LINK_TO_KML");
kmzLayer.setMap(map); 
```

There is also a project called `netcdf2gmaps` here [http://code.google.com/p/netcdf2gmaps/](http://code.google.com/p/netcdf2gmaps/) but it seems abandoned and there is no feedback for it.

So is there any way to display the netCDF data to Google Maps?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-25T17:54:26.957

我不知道你是否解决了你的问题，但为了参考问题标题，我想添加更多信息。

Panoply（或 IDV）以它们当前显示和 lon/lat 边界的简单 PNG 快照的方式导出到 KMZ（压缩 KML），如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<kml xmlns="http://earth.google.com/kml/2.0">
    <GroundOverlay>
        <name>Maximum_temperature_Maximum_unwe in GEFS_Global_1p0deg_Ensemble_deri</name>
        <Icon>
            <href>Maximum_temperature_Maximum_unwe in GEFS_Global_1p0deg_Ensemble_deri.png</href>
        </Icon>
        <LatLonBox>
            <west>-29.1622</west>
            <north>55.0</north>
            <east>49.1622</east>
            <south>25.0</south>
        </LatLonBox>
    </GroundOverlay>
</kml> 
```

这似乎是谷歌地球界面的唯一方式——位图图像。令人遗憾的是，Google 地球不是为可视化或数值模型数据而设计的，因为它不能代表各种其他特征。

如果在 Google Earth/Maps 中覆盖位图是一项任务，那么您已经注意到这只是双击生成的 KMZ 文件的问题：

![在此处输入图像描述](../Images/0c5671a4660e122665a9c6200e1f34bb.png)

或者对于谷歌地图，上传文件并将路径粘贴到谷歌地图搜索栏中：

![在此处输入图像描述](../Images/3bf9da8299df4c6d8b2f64c2003c2620.png)

# c# - 在浏览器端拦截 HTTP 请求以更改某些 html 内容

> ID：10586794
> 
> 赞同：1
> 
> 时间：2012-05-14T15:54:38.837
> 
> 标签：c#

我想做如下。最好的方法是什么？一般的答案也可以。

我想在客户端拦截一个 HTTP 请求以更改一些 html 内容。例如，我访问 CNN.com，而不是显示“两只洛杉矶狗结婚”的文章，而应该说“可笑的标题被屏蔽”。

即使是安全的证书也不会受到干扰，这应该很顺利。

我正在使用 C#。

谢谢！

更新：谢谢大家的回答！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-16T19:49:40.630

您可以通过[Privoxy](http://www.privoxy.org/)的[过滤器文件](http://www.privoxy.org/user-manual/filter-file.html)执行此操作。他们[有趣的过滤器](http://www.privoxy.org/user-manual/actions-file.html#FILTER-FUN)是您想要做的那种替换的一个很好的例子。

要将 cnn.com 上的“Two LA Dogs Marry”替换为“Ridiculous Title Blocked”，您的操作文件将如下所示：

> ```
> { +filter{ridiculous-title-censor} }  
> .cnn.com 
> ```

你的过滤器文件看起来像

> ```
> # FILTER: ridiculous-title-censor Remove ridiculous titles
> # This keeps CNN from getting too ridiculous
> #
> s/Two LA Dogs Marry/Ridiculous Title Blocked/ig 
> ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T16:05:14.827

本地 HTTP 代理是可能的，也是最通用的方法。

即您可以使用[Fiddler](http://www.fiddler2.com/fiddler2/)来查看它是否适合您。除了定期监视流量外，我还支持修改请求/响应。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-20T15:34:08.460

如果您使用 Firefox，另一种选择是使用[Greasemonkey](https://addons.mozilla.org/en-US/firefox/addon/greasemonkey/)脚本。这是一个更改 cnn.com 主标题的[示例脚本](http://www.ironicsans.com/2007/01/idea_cnn_fortune_cookie_grease.html)

如果您不熟悉制作 Greasemoney 脚本所需的 Javascript 编码，您可以使用[Platypus 插件](http://platypus.mozdev.org/)就地编辑页面并自动生成脚本文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-22T06:40:42.767

您可以使用 HTTPListener 设置代理。但我认为如果你想把它做好，你需要一个更底层的程序。

*   打开 2 个 TCP 端口（80 和 443）并主动监听传入连接。
*   一旦收到
    *   代表请求者外出提出请求
*   检索 HTTP 响应
*   检查并更改 HTTP 响应（在适当的情况下）
    *   也许修改标题（在适当的情况下）
*   将响应转发给请求者

我将从一个简单的代理开始，它只转发所有请求并返回所有响应。一旦到位，您就可以开始检查响应。

这是一个很好的起点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-23T08:15:29.477

这种方法是做您想要实现的目标的效率最低的方法。

如果这是客户端应用程序，客户端可能会禁用它，从而使其无用。它也很难维护，需要更复杂的编程来确保它与 SSL 一起工作。

*   如果使用浏览器插件或工具栏，则需要为特定浏览器制作。
*   如果使用侦听服务器拦截 HTTP 请求，这会在加密内容时增加复杂性和难度，也会带来不必要的开销。
*   如果使用本地代理（意味着客户端的浏览器需要指向本地代理服务），可能是最有效的客户端方法，但仍然存在上述缺点（难以维护等）

**我相信您要做的是完全重新发明轮子。**

您提供赏金的事实引出了一个问题，即您确实需要在 C# 和客户端中执行此操作，但是“审查坏事”意味着您需要禁止内容，并且任何客户端方法最终都会赋予客户端权力以消除此限制。

就个人而言，我在[Squid](http://en.wikipedia.org/wiki/Squid_%28software%29)及其[内容适应功能](http://wiki.squid-cache.org/SquidFaq/ContentAdaptation)方面取得了巨大成功。

这意味着，客户端需要有一个受控的 Internet 源。这意味着，如果它们都在 LAN 中并共享一个公共 Internet 网关，那么如果您有备用服务器作为代理，这很容易实现。

我建议你买一个小的 linux 盒子，里面可以有一个简单的 Ubuntu 服务器版，然后添加 Squid。网络上到处都是教程，但即使没有教程，实现的水平也变得很容易。

我可能已经完全跑题了，但我希望我能提供帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-23T10:13:45.017

你可以来中国^_^这样的审查无处不在，你不必自己实施。

好吧，这是个玩笑，答案是您可以为此类任务实现浏览器插件。或者您可能需要在路由器上实现一个路由过滤器（类似 GFW）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-23T13:48:41.107

取自[这里](https://stackoverflow.com/a/1008423/1113272)。

它可以通过Windows上的[分层服务提供程序来完成。](http://en.wikipedia.org/wiki/Layered_Service_Provider)

来自维基百科：

`"A Layered Service Provider (LSP) is a feature of the Microsoft Windows Winsock 2 Service Provider Interface (SPI). A Layered Service Provider is a DLL that uses Winsock APIs to insert itself into the TCP/IP stack. Once in the stack, a Layered Service Provider can intercept and modify inbound and outbound Internet traffic. It allows processing all the TCP/IP traffic taking place between the Internet and the applications that are accessing the Internet (such as a web browser, the email client, etc). "`

例如 AdMuncher 正在拦截和插入 http 代码以避免广告。另一个建议是找到一个开源的广告拦截程序，看看他们是如何实现的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-14T15:58:44.957

你是说你想为你自己的网站截取这个吗？

在任何情况下，它都需要在 javascript 或 jQuery 中完成，因为 C# 不是客户端语言。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-22T10:11:32.367

或者，你可以编写一个工具栏，或者一个简单的 chrome 插件，这真的很简单，但它不是 C#

您可以搜索库以通过代理监控浏览，如下所示：

[http://httpproxynet.codeplex.com/](http://httpproxynet.codeplex.com/)

java在这个项目中使用的相同概念：http: [//www.charlesproxy.com/](http://www.charlesproxy.com/)

听起来很有趣，祝你好运:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-23T02:12:46.737

很久以前，我使用[Plugable Mime Filters](http://msdn.microsoft.com/en-us/library/aa767916%28VS.85%29.aspx#Creating_a_Pluggable)为 IE 实现了这个功能，所以在我用 c# 在[stackoverflow](https://stackoverflow.com/questions/687287/why-isnt-my-ie-mime-filter-being-created-or-called)中搜索它之后，我创建了这篇文章，应该可以帮助你开始使用它。

希望这对你有用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-23T14:47:36.313

[Asynchronous Pluggable Protocols](http://msdn.microsoft.com/en-us/library/aa767743%28v=vs.85%29) can be used for this type of thing. Although, as stated here [INFO: Implementing HTTP-like Asynchronous Pluggable Protocols](http://support.microsoft.com/kb/303740): "For various reasons, Microsoft neither supports nor recommends that you replace or wrap the default HTTP protocol."

# asp.net - Directly Print PDF in client side without viewing it

> ID：10586803
> 
> 赞同：1
> 
> 时间：2012-05-14T15:55:06.337
> 
> 标签：asp.net, pdf, printing, dom-events, c#-3.0

I have PDF file in server, when user clicks print button on my asp.net page I need to show print dialogue directly without showing the PDF. How can I achieve this? Please guide me.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:06:14.463

这仅适用于 IE，但您可以将 Adob​​e ActiveX 控件嵌入到 HTML 页面中，如下所示：

```
<object classid="clsid:CA8A9780-280D-11CF-A24D-444553540000" style="height:75%; width: 100%; display: none;" id="viewer" name="viewer" VIEWASTEXT>
    <param name="src" value="document.pdf">
</object> 
```

然后在打印按钮的 onclick 中，您可以执行以下操作：

```
viewer.printWithDialog(); 
```

可能可以针对其他浏览器进行调整。

# jsf - JSTL 我试过寻找，它只是变得愚蠢。 我正在运行 Glassfish 3.1.1、 JSF 版本 2 和 netbeans 7.0.1 以下内容根本行不通。 剪断 < c:remove var="test" scope="session"/> 我知道这一定是愚蠢的，这就是 netbeans 一直在说的： 组件库 Jstl Core 不包含组件 在我检查过的每个 JSTL 标记库中，确实如此！ 它<c:remove>最初位于用于遗留 JSP 视图技术的JSTL库中。Facelets是 JSP 的继承者，只重新定义了 JSTL 标记的一个子集（JSP 标记在 Facelets 中不起作用，它们已被移植/重写）。<c:remove>不在其中。 您的具体问题必须以不同的方式解决。由于具体的功能需求不清楚，我无法详细回答。但我猜您实际上需要一个 JSF@ViewScoped或一个 CDI @ConversationScopedbean 并将所需的属性存储在其中。当视图范围或对话范围结束时，它将被删除。这些范围定义明确，位于请求范围和会话范围之间。另请参阅如何选择正确的 bean 范围？ jsfglassfishjstl 4 1 回答 1 This answer is useful 1 它<c:remove>最初位于用于遗留 JSP 视图技术的JSTL库中。Facelets是 JSP 的继承者，只重新定义了 JSTL 标记的一个子集（JSP 标记在 Facelets 中不起作用，它们已被移植/重写）。<c:remove>不在其中。 您的具体问题必须以不同的方式解决。由于具体的功能需求不清楚，我无法详细回答。但我猜您实际上需要一个 JSF@ViewScoped或一个 CDI @ConversationScopedbean 并将所需的属性存储在其中。当视图范围或对话范围结束时，它将被删除。这些范围定义明确，位于请求范围和会话范围之间。另请参阅如何选择正确的 bean 范围？ 于 2012-05-14T15:57:02.073 回答 Related 1 titanium - 我们如何在钛工作室移动应用程序的照片库中显示视频？ 1 list - 在 JavaFX TableView 中显示数据库中的项目 1 angularjs - 如何将两个模块注册到 ng-app？ 2 c++ - boost asio tcp - 套接字写入数据与缓冲区中的数据不同 - 某处可能存在线程不安全 0 php - 为了在 PHP 中使用 Oracle 语义函数传递 pl/sql 语句 3 java - lwjgl 和 slick-util 渲染文本 1 android - 在活动之间切换 1 java - JTextArea 不显示在 JTabbedPane 内的 JPanel 上 1 iphone - 向 MKMapView 添加子视图（不是覆盖） 1 php - PHP 不显示错误行 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</c:remove></c:remove></c:remove></c:remove>

> ID：10586807
> 
> 赞同：0
> 
> 时间：
> 
> 标签：jsf, glassfish, jstl

我试过寻找，它只是变得愚蠢。

我正在运行 Glassfish 3.1.1、
JSF 版本 2
和 netbeans 7.0.1

以下内容根本行不通。

> <html xmlns="http://www.w3.org/1999/xhtml" xmlns:c="http://java.sun.com/jsp/jstl/core">
> 
> *剪断*
> 
> < c:remove var="test" scope="session"/>

我知道这一定是愚蠢的，这就是 netbeans 一直在说的：

> 组件库 Jstl Core 不包含组件

在我检查过的每个 JSTL 标记库中，确实如此！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:57:02.073

它`<c:remove>`最初位于用于遗留 JSP 视图技术的[JSTL](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/)库中。[Facelets](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/)是 JSP 的继承者，只重新定义了 JSTL 标记的一个[子集](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/c/tld-summary.html)（JSP 标记在 Facelets 中不起作用，它们已被移植/重写）。`<c:remove>`不在其中。

您的具体问题必须以不同的方式解决。由于具体的功能需求不清楚，我无法详细回答。但我*猜*您实际上需要一个 JSF`@ViewScoped`或一个 CDI `@ConversationScoped`bean 并将所需的属性存储在其中。当视图范围或对话范围结束时，它将被删除。这些范围定义明确，位于请求范围和会话范围之间。另请参阅[如何选择正确的 bean 范围？](https://stackoverflow.com/questions/7031885/how-to-choose-the-right-bean-scope)

# c# - 如何使用带有默认对象实例的编辑器模板

> ID：10586809
> 
> 赞同：0
> 
> 时间：2012-05-14T15:55:11.747
> 
> 标签：c#, asp.net-mvc-3, razor

在我的视图文件中，我当前具有以下代码：

```
 @if ((Model.CustomerOrderTrackings != null) && (Model.CustomerOrderTrackings.Count > 0)) {
        for (int i = 0; i < Model.CustomerOrderTrackings.Count; i++) {
            @Html.EditorFor(m => m.CustomerOrderTrackings[i])
        }
    } else {
        @*The problem is here*@
        @Html.EditorFor(m => new CustomerOrderTracking())
    } 
```

然后，我的编辑器模板如下所示：

```
@model Models.CustomerOrderTracking

<tr class="gridrow">
    <td class="carrierName">
        @Html.HiddenFor(m => m.Id, new { id = "" })
        @Html.HiddenFor(m => m.ShipperId, new { id = "", @class = "trackingShipperId" })
        @Html.DropDownListFor(m => m.CarrierName, ViewExtensions.ToFriendlySelectList<CustomerOrderTracking.CarrierNames>(Model.CarrierName), new { id = "" })
    </td>
    <td class="service">@Html.DropDownListFor(m => m.ShippingType, ViewExtensions.ToFriendlySelectList<CustomerOrderTracking.ShippingTypes>(Model.ShippingType), new { id = "" })</td>
    <td class="trackingNumber">@Html.TextBoxFor(m => m.ShippingTrackingNumber, new { @class = "trackingInput", id = "" }) <a href="" target="_blank" class="icon track"></a></td>
    <td class="shippingCost">
        @Html.TextBoxFor(m => m.ShippingCost, new { @class = "shippingInput", id = "" })
        <div onclick="Operations.Orders.DeleteTrackingRow(this)" class="icon delete deleteTracking" title="Delete this shipment?"></div>
    </td>
</tr> 
```

我要做的是在当前没有任何项目附加到对象的情况下向该表添加默认行。对象的新实例不起作用，因为这会导致以下错误：`Templates can be used only with field access, property access, single-dimension array index, or single-parameter custom indexer expressions.`

我可以手动编码输入，但是我的代码相当草率，因为我将使用手动编码输入，然后从 ASP.NET MVC 扩展自动生成输入。

有没有办法可以将对象的默认实例传递给我的编辑器模板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:00:52.410

我在 MVC 框架中看到它的方式是，在控制器中检测您的需求并在模型到达视图之前根据需要调整模型。另一个答案，即 99% 不是宗教财产的方式，是在你的观点中有逻辑（ew！）。

```
public ActionResult SomeAction()
{

  if (model.CustomerOrderTrackings == null 
      || model.CustomerOrderTrackings.Count > 0) 
  {
    // Do Something with model
  }

  this.View(model)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-11T01:20:43.757

> 在我的视图文件中，我当前具有以下代码：
> 
> ```
> @if ((Model.CustomerOrderTrackings != null) && (Model.CustomerOrderTrackings.Count > 0)) {
>     for (int i = 0; i < Model.CustomerOrderTrackings.Count; i++) {
>         @Html.EditorFor(m => m.CustomerOrderTrackings[i])
>     }
> } else {
>     @*The problem is here*@
>     @Html.EditorFor(m => new CustomerOrderTracking())
> } 
> ```

解决方法是在 Html EditorFor 之外声明模型的实例。例如：

```
@if ((Model.CustomerOrderTrackings != null) && (Model.CustomerOrderTrackings.Count > 0)) {
    for (int i = 0; i < Model.CustomerOrderTrackings.Count; i++) {
        @Html.EditorFor(m => m.CustomerOrderTrackings[i])
    }
} else {
    @{ CustomerOrderTracking stubModel = new CustomerOrderTracking(); }
    @Html.EditorFor(m => stubModel)
} 
```

# business-intelligence - Microsoft 商业智能平台与 QlikView

> ID：10586814
> 
> 赞同：12
> 
> 时间：2012-05-14T15:55:27.860
> 
> 标签：business-intelligence, powerpivot, qlikview, powerbi, qliksense

我完全没有使用 QlikView 的经验，但我读过关于它的好评。根据 Gartner 2012 年研究报告，QlikView 与微软、甲骨文、SAP 和 IBM（领导者和有远见者）一起位居榜首。

我有兴趣从社区听到 QlikView 如何与 Microsoft 的商业智能 (BI) 平台相提并论。在我的公司中，他们在 Microsoft 和 QlikView 之间进行选择，以构建未来的解决方案。我们基本上是一家微软商店，但我读到 QlikView 是为用户友好、超级直观等而设计的。

我还读到选择 QlikView 的一些缺点是：

1.  硬件要求高
2.  技术资源（知道QlikView的人）非常稀缺
3.  许可成本高
4.  可扩展性问题

对此事的任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-24T11:29:42.143

我是一名前 Microsoft 员工，他出售了他们的 BI 工具集 - 我目前在 Tableau 工作。

解决您最初的问题。“Power+”用户通常可以相当快地启动和运行 Qlik——比该用户需要学习 Microsoft/IBM/SAP Oracle 等 BI 平台时更快。您需要的一切都在一个地方，您无需像使用 Microsoft 一样担心安装/配置/维护多个组件 - SQL Server、SQL Analysis Services、SharePoint（至少）。

在我看来，与使用 Microsoft 平台创建的相同解决方案相比，Qlik 需要更少的“技术人员”。Qlik 的脚本/导入功能有点“技术性/笨拙”，但是一旦您克服了这些，事情就不是很困难 - 我在一个下午就搞定了。

如果您正在处理大型数据集，*则*必须在 RAM 中投入一些美元，因为 Qlik 必须将整个数据集加载到内存中。是的，RAM 相对便宜，但数据大小的增长速度超过了 RAM 成本的下降速度——所以这是值得考虑的事情。

由于 Qlik 需要在其内存数据库中“拥有所有数据”，因此它可能会在未来面临挑战。例如，您会看到很少有人运行像 Teradata / Greenplum 等“大数据”存储。将 Qlik 置于重新存储所有数据的硬件要求的首位。微软在这方面更加灵活，它可以将数据存储在内存中（SSAS 的新表格数据模型）或直接访问原始数据库中的数据。

您会发现用户对 Qlik、Tableau 和 Spotfire 等“数据发现”工具的接受度通常要高得多——用户只是倾向于“获得”这些工具，并且感觉对正在发生的事情有更多的控制权。他们可以在较少的 IT 协助下完成工作。

我完全同意之前的海报——在与 Microsoft 进行测试时，你真的应该考虑在“数据发现”空间中添加其他工具——Tableau、Spotfire 和 Qlik 有免费/评估版本——尝试一下。我当然偏爱 Tableau - 它仍然比 Qlik 更友好，允许内存存储或可以“实时”连接到数据源，并且具有非常高端的可视化效果。

祝好运并玩得开心点！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-07-31T16:08:28.380

[Microsoft Power BI](https://powerbi.microsoft.com/en-us/desktop/)拥有功能齐全的 FISMA HIPAA 安全云，每位[用户每年约 144 美元](https://powerbi.microsoft.com/en-us/pricing/)，他们的桌面客户端每月升级一次，完全**免费**。

更重要的是，SSRS 将作为一等公民在内部内部托管 Power BI，并**在 2017 年第二季度免费生产整个服务器组件**

Power BI 还深度集成了 Revolution R 统计分析，在统计集成方面击败了市场上的所有数据发现工具。

没有 Qlik 或 Tableau 对上述陈述的回答，因为这些 TCO 和功能推出与数据发现队列的其余部分一样非常昂贵，而且 Qlik 不进行每月迭代发布。

**2017 年**，Power BI 显然是数据发现的最佳解决方案，而无需在五年 TCO 上花费**700 万美元来完成它。**

Gartner 2016 让微软在几乎所有数据类别中都名列前茅，这对于页面中列出的任何产品（或任何其他公司）都不能说。

[![在此处输入图像描述](../Images/967348e6d65bf10262bfbde080f83c83.png)](https://i.stack.imgur.com/Xncfk.png)[![在此处输入图像描述](../Images/b674fe2e9b218f99cbbe2e6ee29bf9e6.png)](https://i.stack.imgur.com/ELxjG.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T14:37:53.497

为什么只有那两个？看看 Tableau、Altosoft、Spotfire。它们肯定比 MS 更易于使用，并且没有 QV 问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-30T18:24:12.107

上面的一张海报嵌入了 2016 年 Gartner 现代商业智能魔力象限，但该公司对产品优势的更具分析性的审查是他们的“关键能力”报告。我自己当然有偏见，但您可以看到 TIBCO Spotfire 在关键功能方面对 Tableau、Qliktech 和 Microsoft 进行了评分。

TIBCO 的 TERR 引擎在市场上是独一无二的，因为它是 R 的唯一更高性能、受支持的商业引擎，与 Spotfire 中的视觉体验紧密结合。Revolution 有很棒的软件包，但它们基于原始的开源 R 引擎，因此继承了它的缺陷。

这是一个关键汇总表： [2016 年 Gartner 关键能力汇总得分表](http://i.stack.imgur.com/y3JhP.jpg)

我想你可以在这里看到整个重印： [https ://www.gartner.com/doc/reprints?id=1-2RVRL5R&ct=151110&st=sb](https://www.gartner.com/doc/reprints?id=1-2RVRL5R&ct=151110&st=sb)

# iis-7 - NETWORK SERVICE 用户和 joomla，文件/文件夹不可写，Windows 2008 IIS7

> ID：10586815
> 
> 赞同：0
> 
> 时间：2012-05-14T15:55:29.567
> 
> 标签：iis-7, joomla, file-permissions

我正在尝试为运行 Joomla (v1.6) 的用户提供正确的权限，以便在 Windows 2008 IIS7 机器上启用上传。我在 ye-ole 互联网上发现了很多相互矛盾的反应。

当我转到 Joomla 管理员中的系统信息 -> 目录权限页面时，我可以看到所有目录都是不可写的。而且，我尝试了以下方法。

我检查以确保 - 我的 www 服务运行为：NETWORK SERVICE 我的 php-cgi.exe 运行为：NETWORK SERVICE

我将 NETWORK SERVICE 用户添加到站点的根目录（作为一个简单的测试）并具有完全控制权，然后转到高级并将所有权限传播到子目录。从 Joomla 的角度来看，没有一个文件夹是可写的。

到目前为止，获取 Joomla 可写文件夹（并且有很多）的唯一方法是授予每个用户写入权限。

这完全让我感到困惑。我真的很感激任何人都可以提供的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T21:00:52.290

正如我评论的那样，您必须设置适当的访问权限。NETWORK SERVICE 是您的应用程序池的用户。您可以设置访问本地文件的用户实体。

正如您在屏幕截图中看到的（抱歉，仅限德语），您可以选择您的站点，然后检查默认设置并编辑“连接为”并选择一个用户（您之前创建了一个 yoomla 用户并授予对本地目录的权限）。

![在此处输入图像描述](../Images/cdafee9f1e768f5981cd785ddecff22b.png)

有了这个，你可以让它运行恕我直言。

# android - 使用 FFMPEG 在 Android 上转码 Mp4 视频

> ID：10586816
> 
> 赞同：0
> 
> 时间：2012-05-14T15:55:29.803
> 
> 标签：android, ffmpeg

我已经从[Bambuser 项目](http://bambuser.com/opensource)（参考[问题](https://stackoverflow.com/questions/2645041/ffmpeg-for-a-android-using-tutorial-ffmpeg-and-android-mk)）编译了 FFMPEG 二进制文件，并将二进制文件和 .so 文件推送到应用程序目录。

但是当我尝试使用输入文件运行 FFMPEG 时，它总是抱怨找不到文件。

```
1|root@android:/data/data/com.bambuser.broadcaster # ls                        
cache           libavcodec.so   libavfilter.so  libswscale.so
ffmpeg          libavcore.so    libavformat.so  tutorial.mp4
lib             libavdevice.so  libavutil.so
1|root@android:/data/data/com.bambuser.broadcaster # ./ffmpeg -i tutorial.mp4 out.mp4                                                              
FFmpeg version UNKNOWN, Copyright (c) 2000-2010 the FFmpeg developers
  built on May  8 2012 10:11:37 with gcc 4.4.3
  configuration: --target-os=linux --cross-prefix=arm-linux-androideabi- --arch=arm --sysroot=/home/tarandeep/tools/android-ndk/platforms/android-3/arch-arm --soname-prefix=/data/data/com.bambuser.broadcaster/lib/ --enable-shared --disable-symver --enable-small --optimization-flags=-O2 --disable-everything --enable-encoder=mpeg2video --enable-encoder=nellymoser --prefix=../build/ffmpeg/armeabi-v7a --extra-cflags='-march=armv7-a -mfloat-abi=softfp' --extra-ldflags=
  libavutil     50.34\. 0 / 50.34\. 0
  libavcore      0.16\. 0 /  0.16\. 0
  libavcodec    52.99\. 1 / 52.99\. 1
  libavformat   52.88\. 0 / 52.88\. 0
  libavdevice   52\. 2\. 2 / 52\. 2\. 2
  libavfilter    1.69\. 0 /  1.69\. 0
  libswscale     0.12\. 0 /  0.12\. 0
tutorial.mp4: No such file or directory 
```

我试过将文件放在 /sdcard 和其他位置，我总是得到相同的输出

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-18T16:18:28.383

我下载了代码“客户端版本 1.3.7 到 1.6.0 的存档。”。我发现在 build.sh 文件中有一行`FLAGS="$FLAGS --disable-everything"`禁用了所有用于加载文件的协议（文件、http 等）。注释此行或启用您需要的协议允许您正确加载文件。

# css - 堆叠伪类语法？

> ID：10586818
> 
> 赞同：1
> 
> 时间：2012-05-14T15:55:42.963
> 
> 标签：css, pseudo-class

我已经在网上搜索了大约一个小时，但是，我似乎只找到“一般”教程。

如果我有类似的 CSS 代码，我有

```
.foo {
   border-color: #ff000;
}

.foo:hover {
   border-color: #0000ff;
} 
```

我可以把它变成一个类元素吗？下面是一个想法的演示，不知道有没有可能。

```
.foo {
   border-color: #ff0000;
   border-color-hover: #0000ff;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T15:56:39.797

不，你不能这样做，你必须`:hover`像你的第一个例子那样把它分成一个类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T15:58:20.567

对于你想要完成的事情，你不会使用 vanilla CSS。您可以查看[SASS/SCSS](http://sass-lang.com/)或[LESS](http://lesscss.org/)。

LESS 会让你这样做：

```
foo { 
    border-color: #ff0000;
    &:hover { border-color: #0000ff; }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T15:57:04.633

不，这是不可能的。为什么会这样？你的第一个例子工作正常。

# database - 在大型数据库中达到性能和可伸缩性之间的适当平衡

> ID：10586819
> 
> 赞同：2
> 
> 时间：2012-05-14T15:55:44.700
> 
> 标签：database, database-design, nlp, data-mining

我正在尝试确定众多数据库模型中的哪一个最能支持概率记录比较。具体来说，我有大约 2000 万个由各种属性（名称、类型、作者、所有者等）定义的文档。文本属性在数据集中占主导地位，但仍有大量图像。读取操作是最关键的相对性能，但我预计每周插入大约 20,000 个新文档。幸运的是，插入速度根本不重要，我很乐意将传入的文档排队以进行受控处理。

数据库查询通常采用以下形式：

*   `Find documents containing at least five sentences that reference someone who'a a member of the military`
*   `Predict whether User A will comment on a specific document written by User B, given User A's entire comment history`
*   `Predict an author for Document X by comparing vocabulary, word ordering, sentence structure, and concept flow`

我的第一个想法是使用像[MongoDB这样的简单](http://www.mongodb.org/)[文档存储](http://en.wikipedia.org/wiki/Document-oriented_database)，因为每个文档不一定包含相同的数据。但是，复杂的查询有效地将其降级​​为文件系统包装器，因为我无法构建产生我想要的结果的查询。因此，这种方法使我不得不遍历整个数据库并分别处理每个文件。尽管文档存储可以很好地横向扩展，但这里的好处并没有体现出来。

这让我意识到我的粒度*不在*文档级别，而是在*实体关系*级别。因此，[图数据库](http://en.wikipedia.org/wiki/Graph_database)似乎是合乎逻辑的选择，因为它们有助于将句子中的每个单词与下一个单词、下一段、当前段落、词性等联系起来。图数据库限制了数据复制，提高了统计聚类的速度，并且除其他外，横向扩展。不幸的是，确保您的查询得到明确的答案仍然需要遍历整个图表。即便如此，索引将有助于提高性能。

我还评估了关系数据库的使用，如果设计得当（即通过避免不必要的规范化），它们会非常有效。关系数据库擅长查找用户 A 创作的所有文档，但无法进行结构比较（这涉及昂贵的连接）。关系数据库还有效地强制执行约束（主键、外键、唯一性等）——这是一些 NoSQL 解决方案难以完成的任务。

**考虑到上面列出的要求，有没有数据库模型结合了关系模型的“精确性”（*即*，域的有效耗尽）和图数据库的灵活性？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T00:37:41.747

这不是一个真正的答案，只是一个讨论。

您所说的数据库是一个大型数据库。您没有提及文档的性质，但报纸文章通常在 2-3k 范围内，因此您谈论的是数百 GB 的原始数据。

如果查询性能是一个问题，那么您谈论的是一个大型且相当昂贵的系统。

您的要求也相当复杂，而且不太可能是开箱即用的。我会考虑一个混合系统。将文档元数据存储在关系数据库系统中，以便您可以通过简单的查询快速访问它们。您可以将文档本身作为 blob 存储在数据库中。

您的某些要求可以通过关系数据库上的文本插件来满足。因此，使用倒排索引技术进行简单的搜索是可行的。这处理了你的三个场景中的第一个。

其他两个更具挑战性。第三个（“预测作者”）可能可以通过一个并行系统来处理，该系统存储作者信息，当它们被加载时从文档中总结出来。然后是使用简单的统计分析（朴素贝叶斯，有人吗？）将文档与作者进行比较的问题。

中间一个很棘手，但它提出了另一个用于管理文档评论的组件。根据音量，这可能容易或困难。

最后，需求变化如何？你真的知道系统应该做什么吗？或者一旦启动并运行，功能会完全不同吗？

# asp.net-mvc - 如何根据 HTTP Accept 标头的值进行路由？

> ID：10586822
> 
> 赞同：3
> 
> 时间：2012-05-14T15:55:47.773
> 
> 标签：asp.net-mvc, rest, asp.net-mvc-routing, asp.net-mvc-4

我开始使用 ASP.NET MVC 4 Web API 工具，我想使用 HTTP Accept 标头中 MIME 类型的参数对我的服务进行版本控制，其方式类似于此处讨论的内容：[API 版本控制的最佳实践?](https://stackoverflow.com/questions/389169/best-practices-for-api-versioning)

我尝试了路线限制，但感觉就像我走错了路。有没有其他人已经解决了这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:35:25.310

路线约束是“正确”的道路，因为它是一种可行的方式。

如果您觉得这有点太 hacky，您可以随时编写自己的 HTTP 模块并处理更高级别的请求。

# google-analytics - 将主机名与页面级自定义变量一起使用

> ID：10586824
> 
> 赞同：1
> 
> 时间：2012-05-14T15:55:50.247
> 
> 标签：google-analytics

我有一个标记有自定义变量的站点，用于确定“页面类型”，该变量设置为页面级变量：

```
_gaq.push(['_setCustomVar', 1, 'PageType', 'List', 3]); 
```

在大多数情况下，这很有效，因为我可以报告所有列表页面的页面查看次数，并查看我网站上所有列表页面的指标。

但是，我最近在 m.mydomain.com 添加了一个移动站点，我正在尝试针对这些移动页面浏览量报告我的页面类型。我设计了一个简单的自定义报告，其中包含自定义变量值 1 的页面视图和访问者，然后按主机名 m.mydomain.com 过滤 - 但现在我得到的数字非常低，远低于应有的数字。

有谁知道主机名过滤器是否与页面级自定义变量不兼容？或者还有其他原因导致 GA 可能无法使用主机名正确报告此自定义变量吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:27:30.287

**选项 1**是为您的移动站点与常规站点创建单独的配置文件。对配置文件应用过滤器以根据域包含或排除流量。您如何设置实际的配置文件过滤器取决于您的设置，但例如，您可以使用以下内容：

```
mobile profile > include "m.mydomain.com"
desktop profile > include "www.mydomain.com"
rollup profile > (no filters, like what you currently have) 
```

或者，如果您有多个“非移动”（子）域，则可以改为执行以下操作：

```
mobile profile > include "m.mydomain.com"
desktop profile > exclude "m.mydomain.com"
rollup profile > (no filters, like what you currently have) 
```

**选项 2**是使用“m.mydomain.com”与“www.mydomain.com”弹出一个额外的自定义字段，并将其用作过滤器。

**选项 3**将您的域添加到您的页面名称。在 _trackPageview 调用中。默认情况下，报告的页面名称是页面的相对路径。`_gaq.push(['_trackPageview',location.href.replace(/https?:\/\//,'')]);`但是，如果您想进入跨多个域的汇总配置文件， 您可以使用类似这样的内容弹出该调用的自定义值，这实际上有点有用。

# java - Java新手：有没有更好的方法来编写这个简单的代码

> ID：10586825
> 
> 赞同：0
> 
> 时间：2012-05-14T15:55:56.533
> 
> 标签：java

```
private void addMember() {
    while (true) {
        String mNum = readLine("Please enter a membership number: ");
        if (mNum == null) break;
        Integer mNumAsInteger = Integer.parseInt(mNum);
        String mName = readLine("Please enter the member's name: ");
        members.put(mNumAsInteger, mName);
    }
}

private Map<Integer, String> members = new HashMap<Integer, String>(); 
```

代码的目的是不断添加成员，直到用户输入空白输入。

有没有办法将第一行更改为类似

```
Integer mNum = readInt("Please enter a membership number: "); 
```

并以某种方式检测到空白输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:57:49.690

您可以使用 a [`Scanner`](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)，它提供了一个更简单的 API 用于从流中读取。

```
private static void addMember() {
    Scanner sc = new Scanner(System.in).useDelimiter("\n");
    while (true) {
        try {
            System.out.println("Please enter a membership number: ");
            int mNum = sc.nextInt();
            System.out.println("Please enter the member's name: ");
            String mName = sc.next();
            members.put(mNum, mName);
        } catch (Exception e) {
            break;
        }
    }
} 
```

[http://ideone.com/jhN3j](http://ideone.com/jhN3j)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T15:59:24.707

不确定是否最好，但也许您正在寻找：

```
try{
Integer mNum = Integer.parseInt(readLine("Please enter a membership number: "));
}catch (NumberFormatException e){
 System.out.println("Error parsing membership number");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:02:29.130

你可以试试这个课程：[http ://www.cs.kzoo.edu/GridPkg/GridPkgClassDocumentation/edu/kzoo/util/ValidatedInputReader.html](http://www.cs.kzoo.edu/GridPkg/GridPkgClassDocumentation/edu/kzoo/util/ValidatedInputReader.html)

# c++ - 跨平台 C++ 解析器库

> ID：10586831
> 
> 赞同：2
> 
> 时间：2012-05-14T15:56:15.833
> 
> 标签：c++, file, parsing, cross-platform

在空格和制表符分隔的 txt 文件上使用什么好的跨平台 C++ 解析器？我正在寻找解析文件，然后根据解析的信息输出一个新的 txt 文件。

输入文件包含网络流量脚本的详细信息，其中包含主机 IP 地址、主机接口、子网等多个列。

我需要从输入文件中获取信息，并以另一个应用程序所需的格式创建交通脚本。

以下是输入文件格式的示例：

```
Hostname    HostIP Area    Host Interface   Number of Routes
test1    128.1.1.1 0.0.0.0       128.100.1.1       100   
test1    128.1.1.2 0.0.0.0
test1    128.1.1.3 0.0.0.0
test2    128.2.2.4 0.0.0.0       128.200.5.6       100
test2    128.2.2.5 0.0.0.0
test2    128.2.2.6 0.0.0.0 
```

我要求一个库来解析这种类型的数据并创建一个新的文本文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T18:00:20.407

对于像您给出的示例这样的简单输入文件，您可以为这种文件类型编写自己的文件。您可以使用标准 C++ 类并构建自己的文件解释器。这是一个很棒的指南：

[http://www.cplusplus.com/doc/tutorial/files](http://www.cplusplus.com/doc/tutorial/files/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T18:09:07.520

Boost可能是一个解决方案。如果您只想根据空格和制表符拆分数据，请查看[boost::split](http://www.boost.org/doc/libs/1_49_0/doc/html/string_algo/usage.html#id3184031)。

# c++ - 使用纯虚方法克隆 C++ 类

> ID：10586832
> 
> 赞同：6
> 
> 时间：2012-05-14T15:56:19.467
> 
> 标签：c++, virtual

我有以下类关系。我想克隆派生类，但我收到错误“无法实例化抽象类”。如何克隆派生类？谢谢。

```
class Base {
public:
    virtual ~Base() {}
    virtual Base* clone() const = 0;
};

class Derived: public Base {
public:
    virtual void func() = 0;
    virtual Derived* clone() const {
        return new Derived(*this);
    }
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T16:05:04.657

只有具体的类可以被实例化。您必须重新设计 Derived 的界面才能进行克隆。首先，删除*virtual void func() = 0;* 然后您将能够编写以下代码：

```
class Base {
public:
    virtual ~Base() {}
    virtual Base* clone() const = 0;
};

class Derived: public Base {
public:
    virtual Derived* clone() const {
        return new Derived(*this);
    }
}; 
```

另一个解决方案是保留纯虚函数并添加一个具体类：

```
class Base {
public:
    virtual ~Base() {}
    virtual Base* clone() const = 0;
};

class Derived: public Base {
public:
    virtual void func() = 0;
};

class Derived2: public Derived {
public:
    virtual void func() {};
    virtual Derived2* clone() const {
        return new Derived2(*this);
    }
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T15:57:56.470

您不能像这样实例化具有纯虚函数的类：

```
virtual void yourFunction() = 0 
```

创建一个子类或删除它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T15:57:52.930

只能实例化具体类。Func 不应该是纯的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T07:30:09.437

我可能在这里说一些愚蠢的话，但我认为派生类中的 clone 方法仍然应该返回一个指向基类的指针。也许它仍然编译得很好，但就代码的可维护性而言，我认为最好只使用方法克隆来返回指向基类的指针。毕竟，如果您的派生类必须克隆为指向派生类的指针，您也可以这样做

```
Derived original;
Derived* copy = new Derived(original) 
```

当然，您需要实现复制构造函数，但通常无论如何都应该实现（极端情况除外）。

# apache-flex - 如何在 AIR 应用程序中打印账单（小尺寸页面）

> ID：10586837
> 
> 赞同：1
> 
> 时间：2012-05-14T15:56:46.530
> 
> 标签：apache-flex, printing, air, invoice

我正在为沙龙创建 AIR 应用程序，我想以小页打印发票。

我怎样才能实现这些？？？请帮我

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T06:24:32.527

Web 示例可以将其转换为 AIR： - 请查找示例 dataGrid 打印以及如何将其更改为 250*250。您可以仅为打印视图创建自定义组件布局并在其中包含打印组件。

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955" minHeight="600">
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>
    <fx:Script>
        <![CDATA[
        import mx.printing.*;

        // Create a PrintJob instance.
        private function doPrint():void {
            var printJob:FlexPrintJob = new FlexPrintJob();
            if (printJob.start() != true) 
                return;
            myDataGridPrint.height = 250;
            myDataGridPrint.width = 250;
            myDataGridPrint.dataProvider = myDataGrid.dataProvider;
            printJob.addObject(myDataGridPrint, FlexPrintJobScaleType.NONE);
            printJob.send();
        }
        ]]>

    </fx:Script>

    <mx:VBox id="myVBox">
        <mx:DataGrid id="myDataGrid" width="300">
            <mx:dataProvider>
                <fx:Object Product="Flash" Code="1000"/>
                <fx:Object Product="Flex" Code="2000"/>
                <fx:Object Product="ColdFusion" Code="3000"/>
                <fx:Object Product="JRun" Code="4000"/>
            </mx:dataProvider>
        </mx:DataGrid>
        <!--Print Data Grid-->
        <mx:DataGrid id="myDataGridPrint" visible="false" includeInLayout="false"/>
        <mx:Button id="myButton" 
                   label="Print" 
                   click="doPrint();"/>
    </mx:VBox>

</s:Application> 
```

希望这可能会有所帮助...

# c# - 使用 XDocument 加载字符串时路径中有非法字符

> ID：10586838
> 
> 赞同：45
> 
> 时间：2012-05-14T15:56:46.643
> 
> 标签：c#, xml, .net-4.0

我在尝试加载的字符串中有非常简单的 XML，`XDocument`以便可以使用 LINQ to XML：

```
 var xmlString = @"<?xml version=""1.0"" encoding=""utf-8"" standalone=""yes""?>
 <person>Test Person</person>";

 var doc = XDocument.Load(xmlString); //'Illegal characters in path' error thrown here 
```

`Illegal characters in path.`当我尝试加载 XML 时出现错误；有人可以解释为什么会这样吗？谢谢。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2012-05-14T15:58:54.723

您正在寻找`XDocument.Parse`-`XDocument.Load`是不是 xml 字符串的*文件：*

```
var doc = XDocument.Parse(xmlString); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-14T16:00:44.207

采用

```
var doc = XDocument.Parse(xmlString); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-05T06:32:41.217

将此用于 XML 字符串

```
 XDocument reader;
        using (StringReader s = new StringReader(**XmlResult**))
        {
            reader = XDocument.Load(s);
        } 
```

# ruby-on-rails - 有什么方法可以让我的 webbrick 服务器运行得更快？

> ID：10586841
> 
> 赞同：0
> 
> 时间：2012-05-14T15:56:55.263
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我在我的电脑上运行 webbrick 服务器，这是一个非常简单的图片上传网站。目前我已将图像上传到数据库并保存为二进制文件。但实际上上传一个 1MB 的文件需要一分钟。有没有办法让它跑得更快？也许像 BLOBS 这样的不同存储方法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:22:41.337

尝试使用不同的网络服务器。[独角兽](http://rubygems.org/gems/unicorn)一开始就很简单。

# c++ - TBB 和其他库中的线程池模式

> ID：10586842
> 
> 赞同：2
> 
> 时间：2012-05-14T15:57:00.837
> 
> 标签：c++, multithreading, tbb

[TBB库](http://en.wikipedia.org/wiki/Intel_Threading_Building_Blocks)中是否有[线程池模式](http://en.wikipedia.org/wiki/Thread_pool_pattern)实现？

如果没有，我在哪里可以找到它？我已经发现的大多数开源实现看起来都未完成且不稳定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:49:35.877

TBB 不包含您可以自己获得的任何类型的线程池类（但请参见下文）。如果我真的需要自己创建一个线程池（我希望我不会，因为我宁愿处理更高级别的概念 TBB 或 OpenMP 公开），那么我可能会采用这种可爱[的方式用于`boost::asio`提供线程池功能](http://think-async.com/Asio/Recipes)。

关于 TBB 的更多信息：如果 TBB 包含一个线程池，那么它是一个内部实现细节，您可以通过在调用`task_scheduler_init`. 但是完全有可能不调用它并让 TBB 使用它的默认值。

事实上请注意，文档状态：

> 构造函数和方法初始化的可选参数允许您指定用于任务执行的线程数。此参数对于开发期间的缩放研究很有用，但不应设置为生产使用。没有在生产代码中指定线程数的原因是，在大型软件项目中，各个组件无法知道有多少线程对于其他线程是最佳的。硬件线程是共享的全局资源。最好将使用多少线程的决定留给任务调度程序。

但是，如果您担心线程池，或者使用 TBB 对显式线程对象的支持来实现线程池，那么您将错过 TBB 中的大部分价值。要利用这一点，您确实需要考虑任务和任务并行性，而不是线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T17:55:38.970

简短的回答：没有

长答案：

TBB 线程类只是近似 C++11 线程的底层 OS 线程的包装器。但它对代码可移植性很有用。

我同意一般建议，您可能会更好地依赖 TBB 提供的高度优化的任务调度。

或者考虑新添加的 flow_graph 结构。

如果您想自己探索线程，那么滚动您自己的线程组类开始停止并加入其所有包含的线程相对简单，不是吗？

# salesforce - Salesforce API 请求数量不断增加

> ID：10586848
> 
> 赞同：0
> 
> 时间：2012-05-14T15:57:11.677
> 
> 标签：salesforce, salesforce-service-cloud

在我们的 Salesforce 帐户中，我们有 20,000 个 API 调用的限制。

我有一个每天早上运行的脚本，就是这样，它消耗了大约 100 个 API 调用。

但在白天，我注意到使用的 API 调用不断增加，每分钟大约 5 次调用。

我确实有工作流程和触发器。

这些会触发 API 调用吗？我不这么认为，但我不明白为什么调用的 API 调用数量不断增加。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:49:21.190

您是否安装了任何 AppExchange 产品？许多与 Salesforce 集成的第 3 方应用程序都使用 API 来实现。鉴于您看到每 5 分钟增加一次，这表明正在使用 API 轮询系统。

我所知道的最常见的一种营销应用程序需要与当前的联系人和潜在客户数据保持同步。

# asp.net - 如何在 asp:DataGrid 中设置单元格的样式？

> ID：10586854
> 
> 赞同：3
> 
> 时间：2012-05-14T15:57:29.067
> 
> 标签：asp.net

如何设置单元格的（css）样式`asp:DataGrid`？

* * *

我真正想要达到什么目的？一个`html` `table`，我控制每个单元格的 html 内容，以及每行和每个单元格的 css 样式：

```
<TABLE>
   <TR class="odd available">
      <TD class="holiday available hassub firstColumn">
          <P ...>...
      <TD class="blackout">
          <A href="...">...</A>
      <TD style="available">
          <SPAN ...>...</SPAN>
      <TD class="booked">
          <DIV ...>...</DIV>
      <TD class="orphan available">
          <DIV ...>...</DIV>
      <TD style="orphan booked checked">
          <SPAN ...>...</SPAN>
          <A href="...">...</A>
          <DIV ...>...</DIV>
   </TR>
   <TR class="blackout">
      <TD>34 points
      <TD><%# GetHtmlForCell() %>
   </TR>
</TABLE> 
```

并且在这种情况下[不能正常工作是公认](https://stackoverflow.com/questions/9361729/create-a-html-table-with-an-asp-repeater)[的。`asp:Repeater`](https://stackoverflow.com/questions/9361729/create-a-html-table-with-an-asp-repeater)

我有需要生成的 HTML；我只需要看看 ASP.net 是否可以生成所需的 html。我猜不是，因为“WebForms”意味着您不生成 HTML。

## 奖金喋喋不休

ASP.net 中的一个`asp:DataGrid`控件呈现多个单元格。可以通过[设置各种格式属性](http://msdn.microsoft.com/en-us/library/1yef90x0.aspx)来调整每种样式的格式，例如：

*   [`BackColor`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcellstyle.backcolor.aspx)
*   [`ForeColor`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcellstyle.forecolor.aspx)
*   [`Font`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcellstyle.font.aspx)

但是没有办法调整`Style`单元格的，例如

```
style="holiday blackout hassub" 
```

## 奖金阅读

一些不相​​关的奖金阅读：

*   [更改数据网格中单元格的样式](http://forums.silverlight.net/t/42372.aspx/1)
*   [MSDN：DataGridViewCellStyle 类](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewcellstyle.aspx)
*   如何在 asp:ListView 中设置单元格的样式？
*   [使用 ASP 中继器创建 HTML 表](https://stackoverflow.com/questions/9361729/create-a-html-table-with-an-asp-repeater)
*   [如何在 ASP.Net Repeater 中创建三列表](https://stackoverflow.com/questions/3442897/how-to-create-a-three-column-table-in-asp-net-repeater)
*   [中继器中的自定义 html 代码](https://stackoverflow.com/questions/9366762/html-table-layout-when-binding-with-asp-net-c-sharp-repeater)
*   [MSDN：Windows 窗体 DataGridView 控件中的单元格样式](http://msdn.microsoft.com/en-us/library/1yef90x0.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:09:24.517

假设您实际上是指 a`GridView`而不是 old `DataGrid`，您可以使用and的[`CssClass`属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.webcontrol.cssclass.aspx)。`GridViewRow``TableCells`

例如在[`RowDataBound`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)：

```
protected void Grid_RowDataBound(Object sender, GridViewRowEventArgs e)
{
    if(e.Row.RowType == DataControlRowType.DataRow)
    {
        if(e.Row.RowIndex == 0)
        {
            e.Row.CssClass = "odd available";
            e.Row.Cells[0].CssClass = "holiday available hassub firstColumn";
            // ....
            e.Row.Cells[4].CssClass = "orphan booked checked";
        }
        else if(e.Row.RowIndex == 1)
            e.Row.CssClass = "blackout";
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:11:38.887

如果您处理 OnRowDataBound，这很容易完成。例子：

```
<style>
.class25
{
    background-color:Red;  
}
.class25a
{
    font-weight:bolder;
}
.class23
{
    background-color:Yellow;  
}
.class23a
{
    font-size:20px;
}
.class33
{
    background-color:Fuchsia;  
}
.class33a
{
    font-style:italic;
}
</style>
<asp:GridView ID="customGrid" runat="server" OnRowDataBound="customGrid_RowDataBound"> 
```

现在在后面的代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        BindData();
    }
}

private void BindData()
{
    List<Employee> emp = new List<Employee>(){
        new Employee{Age=25,ID=1,First="John",Last="Smith"},
        new Employee{Age=23,ID=2,First="Juan",Last="Cabrera"},
        new Employee{Age=33,ID=3,First="Richard",Last="Mar"}
    };

    customGrid.DataSource = emp;
    customGrid.DataBind();

}

protected void customGrid_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        if ((e.Row.DataItem as Employee).Age == 25)
            e.Row.Cells[0].Attributes.Add("class", "class25 class25a");
        else if((e.Row.DataItem as Employee).Age == 23)
            e.Row.Cells[0].Attributes.Add("class", "class23 class23a");
        else
            e.Row.Cells[0].Attributes.Add("class", "class33 class33a");
    }
}

public class Employee
{
    public int ID { get; set; }
    public int Age { get; set; }
    public string First { get; set; }
    public string Last { get; set; }
} 
```

渲染：

![在此处输入图像描述](../Images/3e2e6dc2c2e2ea1ab5f25965abbcc563.png)

# java - 阵列适配器 附加到视图

> ID：10586863
> 
> 赞同：1
> 
> 时间：2012-05-14T15:57:53.720
> 
> 标签：java, android

早上好，

我似乎缺少将 ArrayAdapter 连接到视图的一条信息（仍在学习我的第一个 Android 应用程序）。我创建了一个名为 MyInfoClass 的类，它只是一些用于保存数据的属性。我用数据行填充类，最后我有一个 ArrayList(MyInfoClass>。到目前为止一切都很好，一切看起来都很好，并且值与我在 Debug 透视图中所期望的一样。

我还有一个 XML 布局，上面有一些 TextView。我想使用此布局来显示 ArrayList(MyInfoClass> 中保存的不同“数据集”。我知道要做到这一点，我将使用 ArrayAdapter，并且使用以下行：

```
ArrayAdapter<MyInfoClass> X = new ArrayAdapter<MyInfoClass>(this, R.layout.main, R.id.txtvw_PrevLift, ld_data); 
```

(ld_data 是 ArrayList(MyInfoClass> 对象)

我的困惑来自......嗯，不知道我在做什么，但无论如何它来自不了解如何将 MyInfoClass 的属性连接到它们相应的 TextView。ArrayAdapter 文档没有显示采用 TextView id 列表的构造函数？？？？

感谢您的帮助。JB

为了帮助消除我的困惑，我不绑定到列表....也许我应该？我只是想让整个视图代表一行数据。我已经修剪了很多代码以提高可读性，但这是我的观点。一些文本视图是静态标签，而另一些会被填充。这些按钮用于来回导航。

```
<RelativeLayout....>

    <ImageView
        android:id=.../>

    <TextView
        android:id=.../>

    <ImageView
        android:id=.../>

    <TextView
        android:id=.../>

    <TextView
        android:id=.../>

    <TextView
        android:id=.../>

    <Button
        android:id=.../>

    <Button
        android:id=.../>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:27:54.683

在你的情况下最好使用`SimpleAdapter`

您定义一个代表您的列表项的 XML 文件。此 XML 文件将包含`TextViews`您将在其中显示来自`MyInfoClass`. 说是`my_list_item.xml`

```
<LinearLayout...>
<TextView android:id=name.../>
<TextView android:id=gender.../>
<TextView android:id=occupation.../>
</LinearLayout> 
```

假设你有他们的数据`MyInfoClass.getName(), .getGender(), .getOccupation()`

您创建一个 Map 列表，每个 Map 代表一个列表项的数据：

```
List<HashMap<String, String>> maps = new ArrayList<HashMap<String, String>>(); 
```

您在此列表中填写您的信息：

```
for(int i=0; i<myArray.size(); ++i) {
        HashMap<String, String> map = new HashMap<String, String>();
        map.put("name", myArray.get(i).getName()); 
        map.put("gender", myArray.get(i).getGender()); 
        map.put("occupation", myArray.get(i).getOcupation()); 
        maps.add(map); // add this entry to the list
    ); 
```

您还创建了 2 个数组：一个带有键名（“name”、“occupation”、“gender”），另一个带有相应资源的 id。它们是`String[] from, int[] to`，因此地图中带有键的数据`from[n]`将显示在带有 id 的视图中`to[n]`

```
String[] from = new String[] {"name", "gender", "occupation" };
int[] to = {R.id.name, R.id.gender, R.id.occupation } 
```

然后`SimpleAdapter`使用该列表和 XML 文件创建一个：

```
SimpleAdapter mAdapter = new SimpleAdapter(YourActivity.this, maps, R.layout.my_list_item, from, to); 
```

然后您在您的中设置此适配器，`ListActivity`列表将显示：

```
setListAdapter(mAdapter); 
```

如果你想显示字符串以外的东西，你需要继承 SimpleAdapter 并重新定义一些函数`setViewText`，`setViewImage`但我对此不太了解

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:13:13.370

我认为您正在寻找一个简单的列表适配器。

[http://developer.android.com/reference/android/widget/SimpleAdapter.html](http://developer.android.com/reference/android/widget/SimpleAdapter.html)

它允许您指定从哪些字段获取数据（构造函数中的 from[]）以及放置数据的位置（构造函数中的 to[]）

我不知道简单列表适配器是否适用于数据对象，但我知道它适用于哈希图。当我使用数据对象列表时，我使用扩展 BaseAdapter 类型的自定义适配器。

有关如何在列表视图中使用简单适配器的信息，请参阅本教程：http: [//eureka.ykyuen.info/2010/01/03/android-simple-listview-using-simpleadapter/](http://eureka.ykyuen.info/2010/01/03/android-simple-listview-using-simpleadapter/)

**编辑**：如果您更喜欢使用数据对象，这里是另一个 QA，它显示了使用数据对象轻松实现自定义 SimpleAdapter[如何使用 ArrayAdapter<myClass>](https://stackoverflow.com/questions/2265661/how-to-use-arrayadaptermyclass)

**编辑＃2：：**对不起，我以为你绑定到一个列表。其他人最近遇到了这个问题，我建议使用列表视图的基本基础结构，但对其进行修改，以便只有一个项目跨越列表视图的整个大小。该*项目*本质上是包含所有文本视图的布局。在该示例中，您需要跟踪要显示的项目（从哪个数据对象获取信息）并使用它。您可以在此处查看我建议的解决方案：[Android - 带有适配器支持数据的向导类型活动](https://stackoverflow.com/questions/10483514/android-wizard-type-activity-with-adapter-backed-data/10483788#10483788)

# hover - jqplot 格式工具提示值

> ID：10586868
> 
> 赞同：11
> 
> 时间：2012-05-14T15:58:14.630
> 
> 标签：hover, tooltip, jqplot, format-string, jqplot-highlighter

我想在 jqplot 中有一个工具提示悬停突出显示的东西。问题是我希望它在轴上提供更多细节。所以格式化程序应该不同。我无法让它显示秒数：

[这里](http://jsfiddle.net/DWFTb/12/ "用于测试")有一个 JS 文件！

我希望时间戳显示为小时：分钟：秒，这将是格式字符串“%H:%M:%S”或“%T”或“%X”。但是我该怎么做呢？

```
 highlighter: {
        show: true,
        sizeAdjust: 3,
        //useAxesFormatters: false,
        //tooltipFormatString: '%H:%M:%S',
        formatString: '<table class="jqplot-highlighter"><tr><td>tijd:</td><td>%s</td></tr><tr><td>snelheid:</td><td>%s</td></tr></table>',
    }, 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-05-13T12:29:24.217

这个问题很老，但我一直在寻找相同的问题，并且有一个选项（即使在此处使用的版本中）可以做到：

[http://jsfiddle.net/coma/DWFTb/151/](http://jsfiddle.net/coma/DWFTb/151/)

```
highlighter: {
    show: true,
    sizeAdjust: 3,
    tooltipContentEditor: function(str, seriesIndex, pointIndex, jqPlot) {

        return series[seriesIndex][pointIndex][0];

    }
}... 
```

我希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-17T14:27:14.280

我正在寻找同样的问题，不幸的是还没有答案。我带来的丑陋解决方案是修改 jqplot.highlighter.js 以获得我想要的。这是我如何做到的，

声明 xAxisFormatString 和 yAxisFormatString 属性

```
// prop: xAxisFormatString
// If this is provided then it will override the axesformatter format string
this.xAxisFormatString = '';
// prop: xAxisFormatString
// If this is provided then it will override the axesformatter format string
this.yAxisFormatString = ''; 
```

然后在 showtooltip 方法中使用 this 而不是轴格式字符串

```
var xfstr = series._xaxis._ticks[0].formatString;
if('' != hl.xAxisFormatString) {
    xfstr = hl.xAxisFormatString;
}
var yfstr = series._yaxis._ticks[0].formatString;
if('' != hl.yAxisFormatString) {
    yfstr = hl.yAxisFormatString;
} 
```

调用图表时，

```
highlighter: {
    show: true,
    useAxesFormatters: true,
    xAxisFormatString: '%m-%Y',
    formatString: 'hi - %s',
    sizeAdjust: 7.5
}, 
```

我有 useAxesFormatters true 因为我不想弄乱工具提示格式字符串。我可以使用相同的格式化程序，但我想覆盖格式化字符串。这样我就可以正常工作了。

这是完整的 jqplot.highlighter.js

```
/**
* jqPlot
* Pure JavaScript plotting plugin using jQuery
*
* Version: 1.0.0b2_r792
*
* Copyright (c) 2009-2011 Chris Leonello
* jqPlot is currently available for use in all personal or commercial projects 
* under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
* version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
* choose the license that best suits your project and use it accordingly. 
*
* Although not required, the author would appreciate an email letting him 
* know of any substantial use of jqPlot.  You can reach the author at: 
* chris at jqplot dot com or see http://www.jqplot.com/info.php .
*
* If you are feeling kind and generous, consider supporting the project by
* making a donation at: http://www.jqplot.com/donate.php .
*
* sprintf functions contained in jqplot.sprintf.js by Ash Searle:
*
*     version 2007.04.27
*     author Ash Searle
*     http://hexmen.com/blog/2007/03/printf-sprintf/
*     http://hexmen.com/js/sprintf.js
*     The author (Ash Searle) has placed this code in the public domain:
*     "This code is unrestricted: you are free to use it however you like."
* 
*/
    (function($) {
    $.jqplot.eventListenerHooks.push(['jqplotMouseMove', handleMove]);

    /**
    * Class: $.jqplot.Highlighter
    * Plugin which will highlight data points when they are moused over.
    * 
    * To use this plugin, include the js
    * file in your source:
    * 
    * > <script type="text/javascript" src="plugins/jqplot.highlighter.js"></script>
    * 
    * A tooltip providing information about the data point is enabled by default.
    * To disable the tooltip, set "showTooltip" to false.
    * 
    * You can control what data is displayed in the tooltip with various
    * options.  The "tooltipAxes" option controls wether the x, y or both
    * data values are displayed.
    * 
    * Some chart types (e.g. hi-low-close) have more than one y value per
    * data point. To display the additional values in the tooltip, set the
    * "yvalues" option to the desired number of y values present (3 for a hlc chart).
    * 
    * By default, data values will be formatted with the same formatting
    * specifiers as used to format the axis ticks.  A custom format code
    * can be supplied with the tooltipFormatString option.  This will apply 
    * to all values in the tooltip.  
    * 
    * For more complete control, the "formatString" option can be set.  This
    * Allows conplete control over tooltip formatting.  Values are passed to
    * the format string in an order determined by the "tooltipAxes" and "yvalues"
    * options.  So, if you have a hi-low-close chart and you just want to display 
    * the hi-low-close values in the tooltip, you could set a formatString like:
    * 
    * > highlighter: {
    * >     tooltipAxes: 'y',
    * >     yvalues: 3,
    * >     formatString:'<table class="jqplot-highlighter">
    * >         <tr><td>hi:</td><td>%s</td></tr>
    * >         <tr><td>low:</td><td>%s</td></tr>
    * >         <tr><td>close:</td><td>%s</td></tr></table>'
    * > }
    * 
    */
$.jqplot.Highlighter = function(options) {
    // Group: Properties
    //
    //prop: show
    // true to show the highlight.
    this.show = $.jqplot.config.enablePlugins;
    // prop: markerRenderer
    // Renderer used to draw the marker of the highlighted point.
    // Renderer will assimilate attributes from the data point being highlighted,
    // so no attributes need set on the renderer directly.
    // Default is to turn off shadow drawing on the highlighted point.
    this.markerRenderer = new $.jqplot.MarkerRenderer({shadow:false});
    // prop: showMarker
    // true to show the marker
    this.showMarker  = true;
    // prop: lineWidthAdjust
    // Pixels to add to the lineWidth of the highlight.
    this.lineWidthAdjust = 2.5;
    // prop: sizeAdjust
    // Pixels to add to the overall size of the highlight.
    this.sizeAdjust = 5;
    // prop: showTooltip
    // Show a tooltip with data point values.
    this.showTooltip = true;
    // prop: tooltipLocation
    // Where to position tooltip, 'n', 'ne', 'e', 'se', 's', 'sw', 'w', 'nw'
    this.tooltipLocation = 'nw';
    // prop: fadeTooltip
    // true = fade in/out tooltip, flase = show/hide tooltip
    this.fadeTooltip = true;
    // prop: tooltipFadeSpeed
    // 'slow', 'def', 'fast', or number of milliseconds.
    this.tooltipFadeSpeed = "fast";
    // prop: tooltipOffset
    // Pixel offset of tooltip from the highlight.
    this.tooltipOffset = 2;
    // prop: tooltipAxes
    // Which axes to display in tooltip, 'x', 'y' or 'both', 'xy' or 'yx'
    // 'both' and 'xy' are equivalent, 'yx' reverses order of labels.
    this.tooltipAxes = 'both';
    // prop; tooltipSeparator
    // String to use to separate x and y axes in tooltip.
    this.tooltipSeparator = ', ';
    // prop; tooltipContentEditor
    // Function used to edit/augment/replace the formatted tooltip contents.
    // Called as str = tooltipContentEditor(str, seriesIndex, pointIndex)
    // where str is the generated tooltip html and seriesIndex and pointIndex identify
    // the data point being highlighted. Should return the html for the tooltip contents.
    this.tooltipContentEditor = null;
    // prop: useAxesFormatters
    // Use the x and y axes formatters to format the text in the tooltip.
    this.useAxesFormatters = true;
// prop: xAxisFormatString
// If this is provided then it will override the axesformatter format string
this.xAxisFormatString = '';
// prop: xAxisFormatString
// If this is provided then it will override the axesformatter format string
this.yAxisFormatString = '';
    // prop: tooltipFormatString
    // sprintf format string for the tooltip.
    // Uses Ash Searle's javascript sprintf implementation
    // found here: http://hexmen.com/blog/2007/03/printf-sprintf/
    // See http://perldoc.perl.org/functions/sprintf.html for reference.
    // Additional "p" and "P" format specifiers added by Chris Leonello.
    this.tooltipFormatString = '%.5P';
    // prop: formatString
    // alternative to tooltipFormatString
    // will format the whole tooltip text, populating with x, y values as
    // indicated by tooltipAxes option.  So, you could have a tooltip like:
    // 'Date: %s, number of cats: %d' to format the whole tooltip at one go.
    // If useAxesFormatters is true, values will be formatted according to
    // Axes formatters and you can populate your tooltip string with 
    // %s placeholders.
    this.formatString = null;
    // prop: yvalues
    // Number of y values to expect in the data point array.
    // Typically this is 1\.  Certain plots, like OHLC, will
    // have more y values in each data point array.
    this.yvalues = 1;
    // prop: bringSeriesToFront
    // This option requires jQuery 1.4+
    // True to bring the series of the highlighted point to the front
    // of other series.
    this.bringSeriesToFront = false;
    this._tooltipElem;
    this.isHighlighting = false;

    $.extend(true, this, options);
};

var locations = ['nw', 'n', 'ne', 'e', 'se', 's', 'sw', 'w'];
var locationIndicies = {'nw':0, 'n':1, 'ne':2, 'e':3, 'se':4, 's':5, 'sw':6, 'w':7};
var oppositeLocations = ['se', 's', 'sw', 'w', 'nw', 'n', 'ne', 'e'];

// axis.renderer.tickrenderer.formatter

// called with scope of plot
$.jqplot.Highlighter.init = function (target, data, opts){
    var options = opts || {};
    // add a highlighter attribute to the plot
    this.plugins.highlighter = new $.jqplot.Highlighter(options.highlighter);
};

// called within scope of series
$.jqplot.Highlighter.parseOptions = function (defaults, options) {
    // Add a showHighlight option to the series 
    // and set it to true by default.
    this.showHighlight = true;
};

// called within context of plot
// create a canvas which we can draw on.
// insert it before the eventCanvas, so eventCanvas will still capture events.
$.jqplot.Highlighter.postPlotDraw = function() {
    // Memory Leaks patch    
    if (this.plugins.highlighter && this.plugins.highlighter.highlightCanvas) {
        this.plugins.highlighter.highlightCanvas.resetCanvas();
        this.plugins.highlighter.highlightCanvas = null;
    }

    if (this.plugins.highlighter && this.plugins.highlighter._tooltipElem) {
        this.plugins.highlighter._tooltipElem.emptyForce();
        this.plugins.highlighter._tooltipElem = null;
    }

    this.plugins.highlighter.highlightCanvas = new $.jqplot.GenericCanvas();

    this.eventCanvas._elem.before(this.plugins.highlighter.highlightCanvas.createElement(this._gridPadding, 'jqplot-highlight-canvas', this._plotDimensions, this));
    this.plugins.highlighter.highlightCanvas.setContext();

    var elem = document.createElement('div');
    this.plugins.highlighter._tooltipElem = $(elem);
    elem = null;
    this.plugins.highlighter._tooltipElem.addClass('jqplot-highlighter-tooltip');
    this.plugins.highlighter._tooltipElem.css({position:'absolute', display:'none'});

    this.eventCanvas._elem.before(this.plugins.highlighter._tooltipElem);
};

$.jqplot.preInitHooks.push($.jqplot.Highlighter.init);
$.jqplot.preParseSeriesOptionsHooks.push($.jqplot.Highlighter.parseOptions);
$.jqplot.postDrawHooks.push($.jqplot.Highlighter.postPlotDraw);

function draw(plot, neighbor) {
    var hl = plot.plugins.highlighter;
    var s = plot.series[neighbor.seriesIndex];
    var smr = s.markerRenderer;
    var mr = hl.markerRenderer;
    mr.style = smr.style;
    mr.lineWidth = smr.lineWidth + hl.lineWidthAdjust;
    mr.size = smr.size + hl.sizeAdjust;
    var rgba = $.jqplot.getColorComponents(smr.color);
    var newrgb = [rgba[0], rgba[1], rgba[2]];
    var alpha = (rgba[3] >= 0.6) ? rgba[3]*0.6 : rgba[3]*(2-rgba[3]);
    mr.color = 'rgba('+newrgb[0]+','+newrgb[1]+','+newrgb[2]+','+alpha+')';
    mr.init();
    mr.draw(s.gridData[neighbor.pointIndex][0], s.gridData[neighbor.pointIndex][1], hl.highlightCanvas._ctx);
}

function showTooltip(plot, series, neighbor) {
    // neighbor looks like: {seriesIndex: i, pointIndex:j, gridData:p, data:s.data[j]}
    // gridData should be x,y pixel coords on the grid.
    // add the plot._gridPadding to that to get x,y in the target.
    var hl = plot.plugins.highlighter;
    var elem = hl._tooltipElem;
    if (hl.useAxesFormatters) {
        var xf = series._xaxis._ticks[0].formatter;
        var yf = series._yaxis._ticks[0].formatter;
        var xfstr = series._xaxis._ticks[0].formatString; 
    if('' != hl.xAxisFormatString)
    xfstr = hl.xAxisFormatString;
        var yfstr = series._yaxis._ticks[0].formatString;
    if('' != hl.yAxisFormatString)
    yfstr = hl.yAxisFormatString;
        var str;
        var xstr = xf(xfstr, neighbor.data[0]);
        var ystrs = [];
        for (var i=1; i<hl.yvalues+1; i++) {
            ystrs.push(yf(yfstr, neighbor.data[i]));
        }
        if (hl.formatString) {
            switch (hl.tooltipAxes) {
                case 'both':
                case 'xy':
                    ystrs.unshift(xstr);
                    ystrs.unshift(hl.formatString);
                    str = $.jqplot.sprintf.apply($.jqplot.sprintf, ystrs);
                    break;
                case 'yx':
                    ystrs.push(xstr);
                    ystrs.unshift(hl.formatString);
                    str = $.jqplot.sprintf.apply($.jqplot.sprintf, ystrs);
                    break;
                case 'x':
                    str = $.jqplot.sprintf.apply($.jqplot.sprintf, [hl.formatString, xstr]);
                    break;
                case 'y':
                    ystrs.unshift(hl.formatString);
                    str = $.jqplot.sprintf.apply($.jqplot.sprintf, ystrs);
                    break;
                default: // same as xy
                    ystrs.unshift(xstr);
                    ystrs.unshift(hl.formatString);
                    str = $.jqplot.sprintf.apply($.jqplot.sprintf, ystrs);
                    break;
            } 
        }
        else {
            switch (hl.tooltipAxes) {
                case 'both':
                case 'xy':
                    str = xstr;
                    for (var i=0; i<ystrs.length; i++) {
                        str += hl.tooltipSeparator + ystrs[i];
                    }
                    break;
                case 'yx':
                    str = '';
                    for (var i=0; i<ystrs.length; i++) {
                        str += ystrs[i] + hl.tooltipSeparator;
                    }
                    str += xstr;
                    break;
                case 'x':
                    str = xstr;
                    break;
                case 'y':
                    str = ystrs.join(hl.tooltipSeparator);
                    break;
                default: // same as 'xy'
                    str = xstr;
                    for (var i=0; i<ystrs.length; i++) {
                        str += hl.tooltipSeparator + ystrs[i];
                    }
                    break;

            }                
        }
    }
    else {
        var str;
        if (hl.tooltipAxes == 'both' || hl.tooltipAxes == 'xy') {
            str = $.jqplot.sprintf(hl.tooltipFormatString, neighbor.data[0]) + hl.tooltipSeparator + $.jqplot.sprintf(hl.tooltipFormatString, neighbor.data[1]);
        }
        else if (hl.tooltipAxes == 'yx') {
            str = $.jqplot.sprintf(hl.tooltipFormatString, neighbor.data[1]) + hl.tooltipSeparator + $.jqplot.sprintf(hl.tooltipFormatString, neighbor.data[0]);
        }
        else if (hl.tooltipAxes == 'x') {
            str = $.jqplot.sprintf(hl.tooltipFormatString, neighbor.data[0]);
        }
        else if (hl.tooltipAxes == 'y') {
            str = $.jqplot.sprintf(hl.tooltipFormatString, neighbor.data[1]);
        } 
    }
    if ($.isFunction(hl.tooltipContentEditor)) {
        // args str, seriesIndex, pointIndex are essential so the hook can look up
        // extra data for the point.
        str = hl.tooltipContentEditor(str, neighbor.seriesIndex, neighbor.pointIndex, plot);
    }
    elem.html(str);
    var gridpos = {x:neighbor.gridData[0], y:neighbor.gridData[1]};
    var ms = 0;
    var fact = 0.707;
    if (series.markerRenderer.show == true) { 
        ms = (series.markerRenderer.size + hl.sizeAdjust)/2;
    }

    var loc = locations;
    if (series.fillToZero && series.fill && neighbor.data[1] < 0) {
        loc = oppositeLocations;
    }

    switch (loc[locationIndicies[hl.tooltipLocation]]) {
        case 'nw':
            var x = gridpos.x + plot._gridPadding.left - elem.outerWidth(true) - hl.tooltipOffset - fact * ms;
            var y = gridpos.y + plot._gridPadding.top - hl.tooltipOffset - elem.outerHeight(true) - fact * ms;
            break;
        case 'n':
            var x = gridpos.x + plot._gridPadding.left - elem.outerWidth(true)/2;
            var y = gridpos.y + plot._gridPadding.top - hl.tooltipOffset - elem.outerHeight(true) - ms;
            break;
        case 'ne':
            var x = gridpos.x + plot._gridPadding.left + hl.tooltipOffset + fact * ms;
            var y = gridpos.y + plot._gridPadding.top - hl.tooltipOffset - elem.outerHeight(true) - fact * ms;
            break;
        case 'e':
            var x = gridpos.x + plot._gridPadding.left + hl.tooltipOffset + ms;
            var y = gridpos.y + plot._gridPadding.top - elem.outerHeight(true)/2;
            break;
        case 'se':
            var x = gridpos.x + plot._gridPadding.left + hl.tooltipOffset + fact * ms;
            var y = gridpos.y + plot._gridPadding.top + hl.tooltipOffset + fact * ms;
            break;
        case 's':
            var x = gridpos.x + plot._gridPadding.left - elem.outerWidth(true)/2;
            var y = gridpos.y + plot._gridPadding.top + hl.tooltipOffset + ms;
            break;
        case 'sw':
            var x = gridpos.x + plot._gridPadding.left - elem.outerWidth(true) - hl.tooltipOffset - fact * ms;
            var y = gridpos.y + plot._gridPadding.top + hl.tooltipOffset + fact * ms;
            break;
        case 'w':
            var x = gridpos.x + plot._gridPadding.left - elem.outerWidth(true) - hl.tooltipOffset - ms;
            var y = gridpos.y + plot._gridPadding.top - elem.outerHeight(true)/2;
            break;
        default: // same as 'nw'
            var x = gridpos.x + plot._gridPadding.left - elem.outerWidth(true) - hl.tooltipOffset - fact * ms;
            var y = gridpos.y + plot._gridPadding.top - hl.tooltipOffset - elem.outerHeight(true) - fact * ms;
            break;
    }
    elem.css('left', x);
    elem.css('top', y);
    if (hl.fadeTooltip) {
        // Fix for stacked up animations.  Thnanks Trevor!
        elem.stop(true,true).fadeIn(hl.tooltipFadeSpeed);
    }
    else {
        elem.show();
    }
    elem = null;

}

function handleMove(ev, gridpos, datapos, neighbor, plot) {
    var hl = plot.plugins.highlighter;
    var c = plot.plugins.cursor;
    if (hl.show) {
        if (neighbor == null && hl.isHighlighting) {
            var ctx = hl.highlightCanvas._ctx;
            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            if (hl.fadeTooltip) {
                hl._tooltipElem.fadeOut(hl.tooltipFadeSpeed);
            }
            else {
                hl._tooltipElem.hide();
            }
            if (hl.bringSeriesToFront) {
                plot.restorePreviousSeriesOrder();
            }
            hl.isHighlighting = false;
            ctx = null;

        }
        else if (neighbor != null && plot.series[neighbor.seriesIndex].showHighlight && !hl.isHighlighting) {
            hl.isHighlighting = true;
            if (hl.showMarker) {
                draw(plot, neighbor);
            }
            if (hl.showTooltip && (!c || !c._zoom.started)) {
                showTooltip(plot, plot.series[neighbor.seriesIndex], neighbor);
            }
            if (hl.bringSeriesToFront) {
                plot.moveSeriesToFront(neighbor.seriesIndex);
            }
        }
    }
}
})(jQuery); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-27T13:58:31.923

我尝试使用[昏迷的答案](https://stackoverflow.com/a/16522083/311976)，但首先将其修改为：

```
return jqPlot.series[seriesIndex]._plotData[pointIndex][0]; 
```

这是一个hack（因为它使用_plotData），然后将其更改为

```
return jqPlot.data[seriesIndex][pointIndex][0]; 
```

这应该没问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-21T11:13:31.757

如果你想使用荧光笔，你可以通过将格式设置`tickOptions`为荧光笔使用的格式来快速获得想要的结果。

否则，您必须为自己服务，如此`jqplotMouseMove`处[所示。](https://bitbucket.org/cleonello/jqplot/src/4f8bccac8cb9/examples/customHighlighterTooltip.html)

# php - 多语言网站的 SEO 友好网址

> ID：10586869
> 
> 赞同：3
> 
> 时间：2012-05-14T15:58:16.547
> 
> 标签：php, multilingual, seo

我有一个使用 php 构建的网站，该网站将允许多语言的内容。该网站的一部分将有企业列表。我设置了 SEO 友好的 url 来查看这些列表，例如，我会有一个名为“A bar down the street”的商家列表。网址如下所示：

```
/listing/a-bar-down-the-street 
```

但是，假设此列表有阿拉伯语版本，则名称将如下所示：

شريط أسفل الشارع

我如何将其制作成与英文版相同的 url 格式，但使用它当前使用的语言？当我在阿拉伯语版本上尝试将字符串转换为 seo 友好 url 的函数时，它返回为空。

**编辑：** 为了进一步澄清，我正在寻找的只是一个 php 函数，它允许我将任何字符串转换为 SEO 友好的 url，无论网站使用什么语言。

**编辑第 2 部分** 下面是我用来将字符串重写为 SEO 友好 url 的函数。也许您可以告诉我需要添加什么以使其语言友好？

```
 public function urlTitle($str,$separator = 'dash',$lowercase = TRUE)
    {

        if ($separator == 'dash')
        {

            $search     = '_';
            $replace    = '-';

        }else
        {

            $search     = '-';
            $replace    = '_';

        }

        $trans = array(
                        '&\#\d+?;'              => '',
                        '&\S+?;'                => '',
                        '\s+'                   => $replace,
                        '[^a-z0-9\-_]'          => '',
                        $replace.'+'            => $replace,
                        $replace.'$'            => $replace,
                        '^'.$replace            => $replace,
                        '\.+$'                  => ''
                        );

        $str = strip_tags($str);
        $str = preg_replace("#\/#ui",'-',$str);

        foreach ($trans AS $key => $val)
        {

            $str = preg_replace("#".$key."#ui", $val, $str);

        }

        if($lowercase === TRUE)
        {

            $str = mb_strtolower($str);

        }

        return trim(stripslashes($str));

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:04:47.427

我在现有的 SO 讨论中发现了类似的[讨论](https://stackoverflow.com/questions/3952200/seo-friendly-url-to-dynamic-arabic-category-url-using-php)。看来您所要求的应该是“开箱即用”的。

我建议查看您的网络服务器配置以查看问题所在，对 seo 友好的英文 url 和任何其他 url 可编码字符串之间应该没有区别。

你在运行什么网络服务器？

**更新** 我看到你只接受字母数字字符：

```
'[^a-z0-9\-_]'          => '', 
```

我怀疑这可能会过滤掉任何非 az 字符并导致空返回。或者，或者，您可以尝试调试您的函数以查看哪个替换条件导致您的内容被清除。

您在这里遇到的是默认情况下 URL 不能包含任何字符，浏览器通常使用编码来实现美观的多语言 URL。

[请参阅链接](http://www.wamda.com/2011/11/arabic-seo-part-two-accessibility)中的示例：

> URL 只允许使用一组特定的英文字母字符，包括数字、破折号、斜杠和问号。所有其他字符都必须进行编码，这适用于非拉丁域名。如果您访问 فنادق.com，您会注意到一些浏览器会对其进行解码并向您显示 فنادق.com，但像 Chrome 这样的浏览器会向您显示类似[http://www.xn--mgbq6cgr.com/](http://www.xn--mgbq6cgr.com/)的内容。

这意味着您不能再过滤您的帖子标题而只允许 url-valid 字符，您需要对标题进行编码并希望浏览器按照您的意愿呈现它们。

另一种选择是使用音译，可能是在检测到已知不会呈现 url 编码的特殊字符的浏览器之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T18:35:19.877

所以似乎对我有用的是我的 php 函数的这一部分：

```
'[^a-z0-9\-_]'          => '', 
```

并将 strtolower 行更新为：

```
$str = mb_strtolower($str,'UTF-8'); 
```

它似乎正常工作。但是，任何人都可以确认这将继续工作吗？浏览器能理解所有语言吗？还是我必须规范化字符串以确保每个浏览器都能理解 url？问题是我不在 php 5.3 上，这是为 php 安装规范化扩展所必需的。恐怕如果我升级它会破坏事情，我目前在 5.2x 上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T20:04:49.553

约翰，你是对的，主要问题是你的正则表达式字符类 ( `[^a-z0-9\-_]`) 不允许 UTF-8 字符。这应该会更好：`[^\p{L}0-9\-_]`

我最近一直在研究这样的函数，刚刚发布了一篇博客文章，其中包括我想出的函数：[使用 url_slug() 在 PHP 中创建 SEO 友好 URL](http://iamseanmurphy.com/creating-seo-friendly-urls-in-php-with-url-slug/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-23T14:38:48.107

我有一个网站，我们支持 48 种不同的语言。我用来清理 url 的函数在这里（在 javascript 中），也许这对你有帮助：

```
const noHyphenLangs = ['ko', 'ja', 'zh-cn', 'zh-tw', 'ar', 'th']
const formatTranslationIntoPath = (text, symbol) => { // utf-8 encoding
  let t = text
  const replaceChar = noHyphenLangs.includes(symbol) ? '' : '-'
  t = t.replace(/-/g, ' ')
  t = t.replace(/\s/g, replaceChar)
  t = t.replace(/['`’]/g, '') // remove quotes
  t = t.replace(/[,，()]/g, '') // remove junk
  t = t.normalize('NFD').replace(/\p{Diacritic}/gu, '') // simplify letters for url https://stackoverflow.com/questions/990904/remove-accents-diacritics-in-a-string-in-javascript
  t = t.replace(/[Łł]/g, 'l') // doesn't get replaced in diacritic replacements

  return t.toLowerCase()
}

const ex1 = formatTranslationIntoPath('让我们  尝试-这样-做', 'zh-cn') // 让我们尝试这样做
const ex2 = formatTranslationIntoPath('Việt miễn phí', 'vi') // viet-mien-phi 
```

PS：对于大多数语言，如果没有可用的变音符号替换，您不想删除非字母数字字符。

参考：[https ://gist.github.com/KevinDanikowski/24c79cbb7a3ef2a7f3e452e740848249](https://gist.github.com/KevinDanikowski/24c79cbb7a3ef2a7f3e452e740848249)

# sql - SQL 数据库设计中的关系循环

> ID：10586870
> 
> 赞同：4
> 
> 时间：2012-05-14T15:58:19.200
> 
> 标签：sql, database-design

我正在制作房地产数据库，似乎我做错了什么，因为我的设计中有几个循环。可以吗，还是我需要重新设计所有数据库架构？

这是我当前的架构：

![图片](../Images/ce6bb3261a046cdeeec50a4adedbb03c.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:02:26.787

数据库设计中的“循环”没有任何问题。有时您确实需要在多个方向上遍历数据。

这是否适合您的应用程序和应用程序需求是一个更加困难的问题，如果没有应用程序及其数据需求的完整详细信息，就无法回答这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:02:19.867

如果不进入您的特定设计，一般来说，周期性关系本身并没有什么问题。对某些情况进行建模实际上需要它们（例如，“真正的”一对一关系）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:01:50.537

如果您的目标是高度规范化的数据库，这对我来说很好。我看不出这个设计有什么问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-30T22:15:21.673

您正在将事务链接到不同的表，这些表链接到也链接到事务的中间表。听起来有点多余？

然而，这就是模型所说的。事务具有 TownRegion，并且在该 TownRegion 内，事务可以具有全部、部分或没有的区域、区、街道和地铁（取决于设置的规则）。

如果任何链接到事务的表可能位于不同的 TownRegion 中，则必须更改数据库。不幸的是，模式可能难以与某些技术一起使用，但无论如何定义数据的是这种情况。

这是一个稍旧的帖子，但我想我应该提到这一点。

# javascript - Jquery按钮按下

> ID：10586878
> 
> 赞同：-2
> 
> 时间：2012-05-14T15:58:49.820
> 
> 标签：javascript, jquery, button

当光标单击模板中的按钮时，我们如何在 JQuery 中执行某些操作。该模板将有一个按钮元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:00:09.303

一般使用[`click`](http://api.jquery.com/click/)事件：

```
$("#buttonID").click(function() {
    // do something
}); 
```

或使用[`on`](http://api.jquery.com/on/)（JQuery v1.7 及更高版本）：

```
$("#buttonID").on("click", function() {
    // do something
}); 
```

* * *

如果您的模板是字符串或 JQuery 对象，请在应用模板之前尝试此操作：

```
$("#buttonID", template).click(function() {
    // do something
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:11:40.387

请仔细阅读[http://api.jquery.com/on/](http://api.jquery.com/on/)中关于“直接和委托事件”的部分。它解释了在某些情况下可能会对您的网页性能产生重大影响的事情。

考虑到这一点，以这种方式做事通常是最安全的：

```
$("some selector").on("click", "itemtag", function(event){
    // Do something (may include figuring out which element was clicked)
}); 
```

# c# - 64 位机器上的 32 位 COM dll

> ID：10586879
> 
> 赞同：0
> 
> 时间：2012-05-14T15:58:52.533
> 
> 标签：c#, dll, com, 64-bit

我有一个奇怪的微星！！！

我已经在 64 位机器上安装了我的 32 位 msi(target=x86)，除了一些 COM dll 无法加载并得到“尝试加载格式不正确的程序。（来自 HRESULT 的异常） : 0x8007000B)”这个错误。

我注意到相同的 COM dll 在开发环境的 64 位机器上运行良好。我不知道为什么 msi 安装的 COM 有问题。

问候，

吉里什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:27:57.543

如果您使用 InstallShield 创建 MSI，则合并到注册表中的 COM 信息可能位于也可能不在正确的位置。由于 InstallShield 通常会在安装程序构建期间提取注册表信息，并在安装时将其合并到注册表中，因此如果您没有仔细检查，它可能会或可能不会正确。

您需要确保 32 位组件的 COM 信息仅存在于 Wow6432Node 键下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:03:55.033

您的 C# 程序（exe 项目）必须编译为 x86（32 位）才能加载 x86 库。

# ruby-on-rails - 从终端调用实例操作

> ID：10586881
> 
> 赞同：0
> 
> 时间：2012-05-14T15:58:56.157
> 
> 标签：ruby-on-rails, mongoid

我在需要模型中有这个动作 check_num_reports_on_need ，我需要对其进行测试，所以我想在特定需要的终端上调用它.. 这怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:05:15.467

1.  打开 Rails 控制台：

    ```
    $ rails c 
    ```

2.  在控制台内部加载或创建模型实例：

    ```
    my_model = MyModel.create( ... ) 
    ```

3.  通过在实例上调用方法开始测试该方法：

    ```
    my_model.check_num_reports_on_need # => some value 
    ```

4.  更改`check_num_reports_on_need`方法定义中的代码后，通过调用重新加载控制台环境：

    ```
    reload! 
    ```

# c - 如何在你的makefile中链接静态glibc

> ID：10586883
> 
> 赞同：1
> 
> 时间：2012-05-14T15:59:19.217
> 
> 标签：c, linux, gcc, x86-64

我已经编译`glibc`了`libc.a`结果。我如何在makefile中链接它。makefile 目前看起来像这样。

```
CXX = g++

CXXFILES = file1.cpp file2.cpp file3.cpp

CXXFLAGS =  -O3 -o prog -D_GNU_SOURCE
LIBS = -lpthread

all:
    $(CXX) $(CXXFILES) $(LIBS) $(CXXFLAGS)

clean:
    rm -f prog *.o 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:01:41.217

将库行更改为如下所示：

```
LIBS =  -lc -lpthread 
```

如果`libc.a`不在通常的目录中，请更改库路径以首先查看您的目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:43:29.947

像这样修改它。将*LIBPATH*`libc.a`替换为放置的路径。

```
CXX = g++

CXXFILES = file1.cpp file2.cpp file3.cpp

CXXFLAGS =  -O3 -o prog -D_GNU_SOURCE
LIBS = -LIBPATH/libc.a -lpthread

all:
    $(CXX) $(CXXFILES) $(LIBS) $(CXXFLAGS)

clean:
    rm -f prog *.o 
```

# jquery - 水平滚动条问题

> ID：10586888
> 
> 赞同：0
> 
> 时间：2012-05-14T15:59:25.820
> 
> 标签：jquery, html, css, xhtml

我有一个 div 在固定宽度高度 div 中包含大量“图块”的问题，我希望它水平滚动，因此容器内的图块随滚动条滚动。

这是jsfiddle中的一些东西。[http://jsfiddle.net/jNbxU/2/](http://jsfiddle.net/jNbxU/2/)

它缺少一些东西，但必需品在那里。如果您单击一个框，例如“儿童版”，然后查看标有“现在选择图片”的容器，那么“设计 1、设计 2 等”中的 div 不应该换成两行，它们都应该在一行并滚动。我无法让它工作...

任何帮助都会很棒，谢谢。:D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:11:57.030

你需要的是一个容器中的容器。外部容器具有`overflow: scroll`允许滚动的固定尺寸，内部容器具有非常大的宽度，足以容纳其中的所有元素。我通常使用javascript将内部容器的宽度设置为所有元素的宽度（+边距/边框）。

在 html 中，它看起来像：

```
<div class="outer">
  <ul class="inner">
    <li></li> 
    <li></li> 
    <li></li> 
    <li></li> 
    <li></li> 
    ...
  </div>
</div> 
```

还有一些解决方案使用`white-space: nowrap`内部容器之类的东西，但我上次尝试时无法让它在浏览器中可靠地工作。

# javascript - 将整数加 1；每 1 秒

> ID：10586890
> 
> 赞同：7
> 
> 时间：2012-05-14T15:59:35.643
> 
> 标签：javascript, time, raphael

我的目标是创建识别一段代码，每 1 秒将数字增加 1：

我们将基数称为 indexVariable，然后我想： indexVariable = indexVariable + 1 每 1 秒；直到我的 indexVariable 达到 360 - 然后我希望它重置为 1 并再次执行循环。

这在Javascript中怎么可能？- 如果它有所作为，我正在使用 Raphael 框架。

我已经对 JavaScript 计时事件和 Raphael 延迟函数进行了研究——但这些似乎不是答案——有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-14T16:01:17.147

你可以使用`setInterval()`这个原因。

```
var i = 1;

var interval = setInterval( increment, 1000);

function increment(){
    i = i % 360 + 1;
} 
```

编辑：您的后续问题的代码：

```
var interval = setInterval( rotate, 1000);

function rotate(){
      percentArrow.rotate(1,150,150);
} 
```

我不完全确定您的旋转是如何工作的，但是您可能必须将度数存储在 var 中并像上面的示例一样增加这些 var。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:02:42.370

```
var indexVariable = 0;
setInterval(function () {
    indexVariable = ++indexVariable % 360 + 1; // SET { 1-360 }
}, 1000); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:02:51.340

尝试：

```
var indexVariable = 0;
setInterval(
    function () {
        indexVariable = (indexVariable + 1) % 361;
    }, 1000} 
```

# vim - 使用 set option=value 时 vim 中的文件名扩展

> ID：10586891
> 
> 赞同：0
> 
> 时间：2012-05-14T15:59:37.047
> 
> 标签：vim

我正在尝试向 vim 添加一个 autocmd，每当我在某个子目录中打开文件并设置搜索路径时，它就会执行。不幸的是，路径名扩展似乎在 set 命令中不起作用。

具体来说，我想在我的 vimrc 中有这样一行：

```
setlocal path+=**;%:p:h 
```

但这只会给我文字价值。只是打电话`expand()`也不行。有没有办法让变量扩展在这里工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:31:37.530

关于什么：

```
execute 'setlocal path +=**;' . fnameescape(expand('%:p:h')) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T19:30:20.600

无需扩展当前文件的目录；只需添加`.`即可`path`。从帮助：

> *   要相对于当前文件的目录进行搜索，请使用：
>     `:set path=.`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T19:09:01.627

采用

```
let &l:path.=(empty(&l:path)?(''):(',')).'**;'.escape(expand('%:p:h'), ',\*; ') 
```

. 这比使用要干净得多`:execute 'setlocal path'`，特别是知道它`fnameescape()`旨在为命令而不是选项转义路径，我可以说在这里使用它并不安全：它绝对不会转义逗号和分号并添加额外的转义空间（一个用于转义`:set`，一个用于选项本身）。`(empty(&l:path)?(''):(','))`是来模仿的行为`set+=`。

# jquery - 如何在反应式环境中触发 jQuery？

> ID：10586893
> 
> 赞同：-1
> 
> 时间：2012-05-14T15:59:43.127
> 
> 标签：jquery, coffeescript, publish-subscribe, meteor

jQuery 和流星

Meteor 是响应式的，诞生于一个只有一个初始页面加载的 Web 应用世界，jQuery 诞生于一个服务器生成页面的世界。

所以，问题是……什么时候在 Meteor 模板上调用 jQuery 插件？

1) 在页面加载时 -> 不起作用。数据还没有。

```
Template.contextualFeed.feedItems = ->
    Feed.find()
    $("abbr.timeago").timeago() # Calling the feed right away is useless as Feed.find() is initially empty and will populate a bit later when subscription is delivering the initial data.

<template name="contextualFeed">
    <ul class="feed {{isActive "feed"}}">
    {{#each feedItems}}
    <li class="popup-holder">
        {{> contextualFeedItem}}
    </li>
    {{/each}}
    </ul>
</template> 
```

2) 在每个 Item-> Works 上，但似乎非常浪费。

```
Template.contextualFeed.feedItems = ->
    Feed.find()

Template.contextualFeed.jQueryMe = ->
    $("abbr.timeago").timeago() # Works, but seems incredibly wasteful

<template name="contextualFeed">
    <ul class="feed {{isActive "feed"}}">
    {{#each feedItems}}
    <li class="popup-holder">
        {{> contextualFeedItem}}
        {{jQueryMe}}
    </li>
    {{/each}}
    </ul>
</template> 
```

3）在所有项目加载后 -> 工作，但仍然没有应有的优雅......

```
Template.contextualFeed.feedItems = ->
    Feed.find()

Template.contextualFeed.jQueryMe = ->
    Meteor.defer ->
        #(cut) some ugly code to make sure it only executes once.
        $("abbr.timeago").timeago() # Works, but seems incredibly wasteful

<template name="contextualFeed">
    <ul class="feed {{isActive "feed"}}">
    {{#each feedItems}}
    <li class="popup-holder">
        {{> contextualFeedItem}}
        {{jQueryMe}}
    </li>
    {{/each}}
    </ul>
</template> 
```

4）当数据不是作为添加单独加载到每个项目上时，是否有一些事件会触发？

那么，你有在 Meteor 模板中调用 jQuery 的更简洁的方法吗？

PS：代码示例在 Coffeescript 中……尽管如此，请保持良好状态；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:28:42.423

我认为这里有两种潜在的思路。您在 #4 中提出的想法，“dataLoaded”事件可能需要一些对话。然而，我想到的第一个论点是，正如你所说的那样，Meteor 是新一代流体 Web 应用程序框架。在那个世界中，加载了初始数据集究竟意味着什么？

第二个可能是您的问题有更好的解决方案。在某些情况下，jQuery 和 Meteor 的合并可能会让人感觉很笨拙，但是在粗略阅读了您的示例代码之后，我觉得在这个示例中可能有更好的方法。看起来您有一个 Feed 集合，并希望显示每个 Feed 项的实时时间戳，例如“2 小时前”。那是对的吗？

如果是这样：如果您不打算将活动时间戳存储在 Mongo 中，我*认为*示例 #2 不会非常浪费。诚然，我不确定 Meteor 中的最佳方式，但您应该能够在应用程序中缓存时间戳值。您可能要考虑的另一件事是将值与 Unix 时间戳分开存储在 Mongo 中 - 例如，几个小时。您可以在服务器上运行一个进程来更新提要项目的已用时间。假设提要项目最终过时，这是可持续的，它们的数量并不多，而且您不需要对时间戳非常精确。

我没有任何数据，也不认为这些方法 a) 正确且 b) 比明显的解决方案更快，但它值得深思。

* * *

ETA：Meteor.subscribe 可能有用[http://docs.meteor.com/#meteor_subscribe](http://docs.meteor.com/#meteor_subscribe)。查看 todo 示例中的用法：[https ://github.com/meteor/meteor/blob/master/examples/todos/client/todos.js](https://github.com/meteor/meteor/blob/master/examples/todos/client/todos.js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T16:30:29.527

从一开始`wordplay/client/wordplay.js`，Meteor 的例子之一：

```
Words.find({player_id: Session.get('player_id'), state: 'bad'})
    .observe({
        added: function (word) {
            setTimeout(function () {
                $('#word_' + word._id).fadeOut(1000, function () {
                    Words.remove(word._id);
                });
            }, 5000);
        }
    }
); 
```

你不需要你的模板来触发你的 JS 逻辑。只需使用[.observe](http://docs.meteor.com/#observe)。

# objective-c - Objective C - 在保持旧索引的同时对数组中的数字进行排序

> ID：10586895
> 
> 赞同：0
> 
> 时间：2012-05-14T15:59:54.217
> 
> 标签：objective-c, sorting, nsmutablearray, nsdictionary, nsnumber

> **可能重复：**
> [如何使用 sortedArrayUsingDescriptors 对 NSMutableArray 进行排序？](https://stackoverflow.com/questions/1844031/how-to-sort-nsmutablearray-using-sortedarrayusingdescriptors)

我很困惑如何进行排序。我并不完全理解 NSDictionary 对象，但我做了一些搜索，很多人建议在排序之前使用它们来维护数组元素的原始索引。如果有更好的方法，请告诉我，但现在我正在将 NSDicitonary 对象（带有 NSNumber 值 + NSNumber 键）添加到 NSMutableArray。然后我想根据 NSNumber 值对数组进行排序。这就是我现在设置的方式：

```
NSMutableArray *sortindx = [[[NSMutableArray alloc] initWithCapactiy: M] autorelease];

for(int i = 0; i < M; i++) {
    //Each element is  a single number value with a key of its original array index
    NSDictionary *anElement=[NSDictionary dictionaryWithObject:[NSNumber numberWithInt: numbers[i]] forKey:[NSNumber numberWithInt:i]];
    [sortindx addObject: anElement];
} 
```

如何在不更改其键的情况下根据字典的值对“sortindx”进行排序？

我的最终目标是这样的：

```
{100, 0}, {20, 1}, {50, 2} //before sort
{20, 1}, {50, 2},  {100,0} //after sort 
```

# java - Java比较两张图

> ID：10586897
> 
> 赞同：17
> 
> 时间：2012-05-14T16:00:01.180
> 
> 标签：java

在 java 中，我想比较两个地图，如下所示，我们是否有现有的 API 来执行此操作？

谢谢

```
Map<String, String> beforeMap ;
beforeMap.put("a", "1");
beforeMap.put("b", "2");
beforeMap.put("c", "3");

Map<String, String> afterMap ;
afterMap.put("a", "1");
afterMap.put("c", "333");

//--- it should give me:
b is missing, c value changed from '3' to '333' 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-14T16:16:37.053

我会使用 Set 的 removeAll() 功能来设置键的差异以查找添加和删除。可以通过使用作为 HashMap 的条目集进行集差来检测实际变化。Entry 使用键和值实现 equals()。

```
Set<String> removedKeys = new HashSet<String>(beforeMap.keySet());
removedKeys.removeAll(afterMap.keySet());

Set<String> addedKeys = new HashSet<String>(afterMap.keySet());
addedKeys.removeAll(beforeMap.keySet());

Set<Entry<String, String>> changedEntries = new HashSet<Entry<String, String>>(
        afterMap.entrySet());
changedEntries.removeAll(beforeMap.entrySet());

System.out.println("added " + addedKeys);
System.out.println("removed " + removedKeys);
System.out.println("changed " + changedEntries); 
```

输出

```
added []
removed [b]
changed [c=333] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-14T16:10:02.793

Guava[`Maps`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Maps.html)类有一些方法可以计算一对地图之间的差异。但是，这些方法为您提供了一个表示差异的数据结构，而不是一个漂亮的字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:03:44.623

没有任何开箱即用的组件可以帮助解决这个问题。不幸的是，您可能不得不对其进行编码。好消息是逻辑很简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T16:08:46.837

根据您的特定需求，您还可以考虑使用其他旨在完成这项工作的应用程序，例如 diff。您可以将这两个映射写入两个不同的文件，并对文件进行比较。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-14T16:11:30.697

您可以使用包含键和值的自定义对象（实际上 Map 在内部执行此操作，对用户隐藏，因此我们不能使用它）

将这些元组放入`Set`

要比较两个集合，请将它们都转换为数组，对数组进行排序并从头到尾并行遍历两个数组，如果第一个数组的键小于第二个数组中的键，则降低第一个数组，反之亦然。

```
class Tuple implements Comparable<Tuple>
{
    public String   key;
    public String   value;

    public Tuple(String key, String value)
    {
        this.key = key;
        this.value = value;
    }

    @Override
    public int compareTo(Tuple o)
    {
        return key.compareTo(o.key);
    }
}

public static void main(String[] args)
{
    // TreeSet is already sorted. If you use HashSet, use Arrays.sort()
    Set<Tuple> beforeSet = new TreeSet<>();
    beforeSet.add(new Tuple("a", "1"));
    beforeSet.add(new Tuple("b", "2"));
    beforeSet.add(new Tuple("c", "4"));

    Set<Tuple> afterSet = new TreeSet<>();
    afterSet.add(new Tuple("a", "1"));
    afterSet.add(new Tuple("c", "333"));
    afterSet.add(new Tuple("aa", "4"));

    Tuple[] beforeArray = beforeSet.toArray(new Tuple[beforeSet.size()]);
    Tuple[] afterArray = afterSet.toArray(new Tuple[afterSet.size()]);

    int beforePtr = 0;
    int afterPtr = 0;
    while (beforePtr < beforeArray.length || afterPtr < afterArray.length)
    {
        int difference = afterPtr >= afterArray.length? -1 : beforePtr >= beforeArray.length? 1 : beforeArray[beforePtr].compareTo(afterArray[afterPtr]);
        if (difference == 0)
        {
            if (!beforeArray[beforePtr].value.equals(afterArray[afterPtr].value))
            {
                System.out.println(beforeArray[beforePtr].key + " value changed from '" + beforeArray[beforePtr].value + "' to '" + afterArray[afterPtr].value + "'");
            }
            beforePtr++;
            afterPtr++;
        }
        else if (difference < 0)
        {
            System.out.println(beforeArray[beforePtr].key + " is missing");
            beforePtr++;
        }
        else
        {
            System.out.println(afterArray[afterPtr].key + " is added");
            afterPtr++;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-14T16:18:40.127

```
String output = new String();
for (String key:beforeMap.getKeys()){
  String beforeValue = beforeMap.getValue(key);
  String afterValue = afterMap.getValue(key);
  //nullsafe
  if(beforeValue.equals(afterValue){}
  else if (afterValue == null){
      output = output + key + " is missing, ";
      continue;
  }else {
      output = output + key + " has changed from " + beforeValue + " to " + afterValue + " , ";
  }
  afterMap.remove(key);

}

for (String key:afterMap.getKeys()){
    output = output + key + " was added with value " + afterMap.getValue(key) + ", ";
}

if(output == null){
    output = "Same map";
}
output = output.substring(0,output.length-2);
System.out.println(output); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-10T11:34:10.550

@ user595234要比较两个映射，您可以将映射的键添加到列表中，对于这两个列表，您可以使用方法retainAll() 和removeAll() 并将它们添加到另一个公共键列表和不同的键列表中。使用公共列表和不同列表的键可以遍历映射，使用等于可以比较映射。

```
 public class Demo
    {
           public static void main(String[] args) 
            {
                Map<String, String> beforeMap = new HashMap<String, String>();
                beforeMap.put("a", "1");
                beforeMap.put("b", "2");
                beforeMap.put("c", "3");

                Map<String, String> afterMap = new HashMap<String, String>();
                afterMap.put("a", "1");
                afterMap.put("c", "333");

                System.out.println("Before "+beforeMap);
                System.out.println("After "+afterMap);

                List<String> beforeList = getAllKeys(beforeMap);

                List<String> afterList = getAllKeys(afterMap);

                List<String> commonList1 = beforeList;
                List<String> commonList2 = afterList;
                List<String> diffList1 = getAllKeys(beforeMap);
                List<String> diffList2 = getAllKeys(afterMap);

                commonList1.retainAll(afterList);
                commonList2.retainAll(beforeList);

                diffList1.removeAll(commonList1);
                diffList2.removeAll(commonList2);

                System.out.println("Common List of before map "+commonList1);
                System.out.println("Common List of after map "+commonList2);
                System.out.println("Diff List of before map "+diffList1);
                System.out.println("Diff List of after map "+diffList2);

                if(commonList1!=null & commonList2!=null) // athough both the size are same
                {
                    for (int i = 0; i < commonList1.size(); i++) 
                    {
                        if ((beforeMap.get(commonList1.get(i))).equals(afterMap.get(commonList1.get(i)))) 
                        {
                            System.out.println("Equal: Before- "+ beforeMap.get(commonList1.get(i))+" After- "+afterMap.get(commonList1.get(i)));
                        }
                        else
                        {
                            System.out.println("Unequal: Before- "+ beforeMap.get(commonList1.get(i))+" After- "+afterMap.get(commonList1.get(i)));
                        }
                    }
                }
                if (CollectionUtils.isNotEmpty(diffList1)) 
                {
                    for (int i = 0; i < diffList1.size(); i++) 
                    {
                        System.out.println("Values present only in before map: "+beforeMap.get(diffList1.get(i)));
                    }
                }
                if (CollectionUtils.isNotEmpty(diffList2)) 
                {
                    for (int i = 0; i < diffList2.size(); i++) 
                    {
                        System.out.println("Values present only in after map: "+afterMap.get(diffList2.get(i)));
                    }
                }
            }

            /** getAllKeys API adds the keys of the map to a list */
            private static List<String> getAllKeys(Map<String, String> map1)
            {
                List<String> key = new ArrayList<String>();
                if (map1 != null) 
                {
                    Iterator<String> mapIterator = map1.keySet().iterator();
                    while (mapIterator.hasNext()) 
                    {
                        key.add(mapIterator.next());
                    }
                }
                return key;
            }
    } 
```

下面的代码会给你这个输出：

之前：`{b=2, c=3, a=1}`
之后：不相等：之前- `{c=333, a=1}`
3 之后- 333
相等：之前- 1 之后- 1
仅在之前映射中存在的值：2

# javascript - 实时检测 iframe 页面加载

> ID：10586898
> 
> 赞同：2
> 
> 时间：2012-05-14T16:00:01.597
> 
> 标签：javascript, jquery, dom, iframe

我有一个包含一些 iframe 的 div 元素。有时，我会销毁这些 iframe 并创建一个新的，但我总是需要知道它们中的每一个（以及后来添加的）何时完成加载。我认为以下代码可以工作，但调试控制台中没有任何记录。有什么帮助吗？

```
 // doesn't work
  $('#viewport').on('load', 'iframe', function() {
    console.log('LOADED!');
    return true;
  });

  // doesn't work either
  $('#viewport').on('ready', 'iframe', function() {
    console.log('LOADED!');
    return true;
  }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-29T22:26:33.467

我非常相信动态 iframe 无法做到这一点。来自 jQuery 站点（在已弃用的`load()`函数下：

> 注意： .live() 和 .delegate() 方法不能用于检测 iframe 的加载事件。load 事件没有正确地冒泡父文档，并且 event.target 不是由 Firefox、IE9 或 Chrome 设置的，这是执行事件委托所必需的。

我也无法进行类似的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:17:51.050

可能是框架在您添加事件之前完成加载。

在将事件添加到 DOM 之前尝试添加事件。

```
var iframe = document.createElement("iframe");
// set iframe properties
$(iframe ).on('ready', 'iframe', function() {
  console.log('LOADED!');
});
document.body.appendChild(iframe); 
```

# wordpress - wordpress => 在可视化编辑器中显示存储在数据库中的内容，而不添加/删除 br 或 p

> ID：10586900
> 
> 赞同：0
> 
> 时间：2012-05-14T16:00:10.070
> 
> 标签：wordpress, tags, editor

www 中到处都有很多关于此的线程......他们都没有帮助我。

希望有人可以帮助我解决我的具体问题：

WordPress 添加`/`strips `<p>`, `<br />`-tags 但我只想将内容存储在可视化编辑器中，因为它存储在数据库中而不添加`/`删除`<p>`等`<br />`（HTML 编辑器工作正常，但我不能要求客户只使用 HTML 编辑器） .

我的问题：有谁知道为什么会这样？

我尝试使用 TinyMCE-advanced 和许多其他插件以及向 functions.php 添加代码，但没有任何效果。我确信必须有一个解决方案，因为这是根本不使用 wp 的主要原因，因为 wp 似乎无法像存储在 DB 中一样留下帖子和页面；真是令人沮丧。

期待有人找到解决方案。

非常感谢任何帮助。谢谢和最好的问候，

丹尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T17:12:41.910

在你的functions.php中添加这个：

```
remove_filter( 'the_content', 'wpautop' );
remove_filter( 'the_excerpt', 'wpautop' ); 
```

这将禁用 break 和 p 标签的自动添加/删除。

# cocoa - 控制在 OSX 应用程序中记录用户热键

> ID：10586901
> 
> 赞同：2
> 
> 时间：2012-05-14T16:00:20.570
> 
> 标签：cocoa

我正在处理热键注册，我找不到让用户能够注册其热键的方法。我尝试了 ShortcutRecorder，但似乎无法让它工作，对我来说，它会因一些与 CG 相关的错误消息而崩溃。

我想知道是否有办法让 ShortcutRecorder 与 ARC 环境和 Xcode 4.0 一起使用，或者您是否使用其他控件来获取用户热键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T19:23:05.037

您应该查看 ShortCut Recorder 的这个分支：

[https://github.com/youknowone/shortcutrecorder](https://github.com/youknowone/shortcutrecorder)

原版似乎已经有一段时间没有更新了，但我能够让这个 fork 在 10.7 上运行而无需任何更改。

# sql - 需要帮助将格式 20120130 的日期转换为日期数据类型 oracle sql

> ID：10586902
> 
> 赞同：1
> 
> 时间：2012-05-14T16:00:22.710
> 
> 标签：sql, oracle

您能否帮我将日期从格式“20120101”转换为 Orcle Sql 中的 DATE 格式。

我查看了这个[链接](http://www.mandsconsulting.com/oracle-to_date-function-sql-syntax-examples)，但它没有提到日期格式是否是自定义的..

编辑：是否可以将任何排除规则写入转换函数？

像这样的“99999999”到“9999-12-31”？是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:02:51.487

```
SELECT to_date('20120101','YYYYMMDD') FROM dual; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-14T16:03:44.270

```
to_date('20120101','YYYYMMDD') 
```

应该没事...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-14T16:01:47.310

您可以指定格式：

```
to_date('20120101', 'yyyymmdd') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T16:02:43.707

如果您有一个要转换为日期的字符串“20120101”，假设该字符串包含一个 4 位数的年份，后跟一个 2 位数的月份和一个 2 位数的日期

```
to_date( '20120101', 'YYYYMMDD' ) 
```

# php - 使用定义的常量创建对象

> ID：10586910
> 
> 赞同：2
> 
> 时间：2012-05-14T16:00:59.760
> 
> 标签：php

任意 PHP 问题，或多/少出于好奇。如果这是一个愚蠢的问题，我深表歉意。

```
$class  = 'ClassName';
$object = new $class(); 
```

或者

```
$object = $class::functionName(); 
```

这显然有效。

```
define(CLASS, 'ClassName');
$object = new CLASS(); 
```

或者

```
$object = CLASS::functionName(); 
```

这不起作用。

只是想知道是否可以使用已定义的常量来创建新对象。如果不是，我绝对明白为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:03:59.777

好吧，你可以这样做：

```
define(MYCLASS, 'ClassName');
$class = MYCLASS;
$object = new $class(); 
```

...但据我所知，您不能像 in 那样直接使用常量`new MYCLASS()`，因为它当然会查找名为`MYCLASS`.

旁注：您不能有名称与保留字冲突的常量，例如`class`or `function`，即使它们是大写的。

如果由于某种原因你经常这样做，你可以做一些像这样愚蠢的事情：

```
function newClass($str, $args = NULL) {
    return new $str($args);
}
$class = newClass(MYCLASS); 
```

......但我真的不推荐它。我还猜想你可能不需要这么多常量，或者有一种更优雅的方式来做你正在做的事情，根本不涉及常量。

# python - 创建字典键的更好方法

> ID：10586917
> 
> 赞同：1
> 
> 时间：2012-05-14T16:01:22.757
> 
> 标签：python

我有一个需要存储在字典中的对象列表。这些对象的一个​​属性是标题，当我将对象存储在字典中时，这就是我使用的键。我首先处理标题，以便我可以通过删除空格并将其截断为 50 个字符来将其用作键。

但是有些标题很长，前 50 个字符与另一个标题完全相同。正因为如此，钥匙被搞砸了。谁能建议一个更好的方法来做到这一点。我正在考虑以某种方式对标题进行编码然后使用它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-14T16:04:57.130

您无需删除空格或截断标题即可将其用作字典键。Python 字典键可以是任何不可变的 Python 类型，`str`其中包括（甚至是带有空格和特殊字符的长键）。

只需使用整个标题，或使用哈希对标题进行编码：

```
>>> import hashlib
>>> hashlib.md5('some random title').hexdigest()
'bc847ea8db214557c611c9b3c2f043b1' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:12:09.637

只需散列整个标题。

```
from hashlib import sha1
sha1('title1').hexdigest() 
```

# php - 将动态添加的表单元素的值插入 mysql 数据库

> ID：10586921
> 
> 赞同：0
> 
> 时间：2012-05-14T16:01:40.747
> 
> 标签：php, mysql

我正在制作一个耗材申请表，用户可以在其中申请耗材。我完成了本[教程](http://charlie.griefer.com/blog/2009/09/17/jquery-dynamically-adding-form-elements/)，允许我动态添加表单元素。我能够生成重复的`Stock_No`、文本字段和`Quantity_Available`下拉列表。我应该如何在动态添加的表单元素中插入用户输入的值？`Quantity``Item_Name`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:03:21.353

每个动态添加的表单元素都应该对每个字段的名称使用数组语法。然后，当提交表单时，您的 PHP 脚本应该接收每个项目的数组值。此时，您只需要遍历数组即可将它们添加到数据库中。

基本示例：

```
$item_names  = $_POST['item_names'];
$item_prices = $_POST['item_prices'];
$item_qty    = $_POST['item_qty'];

$num_items = count($item_names);
for ($i = 0; $i < $num_items; $i++)
{
    // Create your SQL
} 
```

# ruby-on-rails - 连接到 Rails 的 I18n

> ID：10586927
> 
> 赞同：0
> 
> 时间：2012-05-14T16:01:59.060
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.2, i18n-gem

我写了一个小库来保存模型属性中的翻译内容。您所要做的就是将以下内容添加到模型中：

```
class Page < ActiveRecord::Base
  i18n_attributes :title, :content
end 
```

按照惯例，数据作为散列（或 Postgres 的 hstore 散列）写入真实属性 i18n_title 和 i18n_content。许多 getter 和 setter 让您可以访问“本地化的虚拟属性”：

```
page = Page.new
page.title_en = 'Hello'
page.title_es = 'Hola'
page.i18n_title   # => { en: "Hello", es: "Hola" }
I18n.locale = :es
page.title        # => "Hola"
page.title_en     # => "Hello" 
```

您也可以在表单中使用这些虚拟属性，但有一个缺点：表单构建器使用 I18n 来获取标签并转换属性验证错误。它当然会寻找键，例如`activerecord.attributes.page.title_en`您`title_en`在表单中使用的键。

`locales/en.yml`为etc 文件中的每个 available_locale 复制相同的翻译会非常麻烦：

```
activerecord:
  attributes:
    page:
      title_en: "Title"
      title_es: "Title"
      ... 
```

我想做的是在 Rails 在启动过程中加载所有语言环境之后执行一些代码，然后克隆这些键的翻译。有没有办法做到这一点？也许是在从 YAML 文件加载翻译后调用的钩子？（当我的库加载时，翻译尚未加载。）

或者您是否看到了解决此问题的另一种方法？（我尝试为 I18n.translate 起别名，但我担心这可能会在未来引起严重的头痛。）

感谢您的提示！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:05:33.063

尽管您放弃了这种方法，但请让我分享一下我的想法：

我认为将其他语言环境字符串添加到翻译文件中以进行特定本地化并不是非常有用的。因为 a`config/locales/$locale.yml`通常开始（至少在我的情况下）

```
$locale:
  ... 
```

不需要`activerecord.attributes.page.title_es`在英文本地化文件中。我只是把它`es.yml`作为`activerecord.attributes.page.title`.

我的意思是：这不是单独的本地化文件的全部目的吗？（或者从开发人员/翻译人员的角度来看：我应该在哪个文件中搜索、`.title_es`in或两者都搜索？）`en.yml``es.yml`

# javascript - 从字符串 jquery 中删除字符串

> ID：10586930
> 
> 赞同：8
> 
> 时间：2012-05-14T16:02:01.853
> 
> 标签：javascript, jquery

忽略我的jquery新手知识。我最近开始学习，我面前有一个挑战。我有一个名为 checkbox_0、checkbox_1 的复选框，并希望从字符串中删除“checkbox_”，以便在循环中使用 0、1 来提取该索引的数据。谢谢

aData 值提醒我值 checkbox_0、checkbox_1 等。这些是选中的复选框。

```
submitButton.on("click", function() {
           $("Table :checked").each(function(e) {
                var iData =Table.fnGetData( this.parentNode);
                // Strip of the checkbox_ from the string
                for(var i=0; i<=iData.length; i++) {
                  aData = iData[i][7];
                }
                alert(aData);
                Table.fnDraw();             

            });
        }); 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-05-14T16:04:37.047

这只是一个 JavaScript，而不是 jQuery，东西。

要删除第一次出现的作品“checkbox_”：

```
var updatedString = originalString.replace("checkbox_", ""); 
```

或者如果你知道它总是采用数字的形式`"checkbox_n"`，`n`

```
var updatedString = originalString.substring(9); 
```

...从字符串中删除前九个字符。

无论哪种情况，您都会得到一个字符串。如果你想要一个数字，你可以使用`parseInt`：

```
var updatedString = parseInt(originalString.replace("checkbox_", ""), 10);
// or
var updatedString = parseInt(originalString.substring(9), 10); 
```

...或者只是`+`在它前面放一个以导致自动转换（但请注意，在这种情况下，十进制和十六进制字符串都将被处理）：

```
var updatedString = +originalString.replace("checkbox_", "");
// or
var updatedString = +originalString.substring(9); 
```

* * *

请注意，我已经写过`updatedString = originalString.blah(...);`，但您当然可以替换您的参考，例如，“originalString = originalString.blah(...);`。

更多探索：

*   [MDN 页面在`String`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T16:06:51.593

```
submitButton.on("click", function() {
           $("Table :checked").each(function(e) {
                var iData =Table.fnGetData( this.parentNode);
                // Strip of the checkbox_ from the string
                for(var i=0; i<=iData.length; i++) {
                  aData = iData[i].replace("checkbox_", "");
                }
                alert(aData);
                Table.fnDraw();             

            });
        }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-14T16:05:14.710

要删除该`checkbox_`部分，您可以简单地执行以下操作：

```
cbName=cbName.replace("checkbox_", ""); 
```

要对`.each()`循环内的所有复选框执行此操作：

```
var cbIndex=this.name.replace("checkbox_", "");
//or...
var cbIndex=this.name.split("checkbox_").join(""); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-14T16:05:56.730

有很多方法可以做到这一点，其中一些：

```
$("table :checked").each(function() {
    var theNumber = this.name.replace(/\D/g, "");
    var theNumber = this.name.replace(/[^\d]/g, ""); // or this
    var theNumber = this.name.match(/\d/g).join();   // or this 
```

# regex - 有效匹配必须不连续的可选字符

> ID：10586931
> 
> 赞同：1
> 
> 时间：2012-05-14T16:02:12.490
> 
> 标签：regex

好吧，我让它工作了，但不知何故，它看起来很慢而且效率低下（或者可能没有）。

我得到的是一系列字符，为了简单起见，我们就说它是

```
123456789 
```

我想要做的是确保输入以相同的方式开始，并且是相同的序列，但不需要是完整的序列。

我得到的是这样的：

```
^1(2(3(4(5(6(7(8(9)?)?)?)?)?)?)?)? 
```

这看起来很可怕，但有没有更好的方法来做到这一点？

**编辑**添加了`^`原始代码中的内容，我忘记在此处包含。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:26:17.137

一个 ？量词就像一个备件。想想没有它运行良好的引擎。如果可能的话，它会尝试忽略它。

确定 x?x?x?x?x? 看起来很糟糕。但是，除非与它周围的某些上下文一起使用，否则它几乎毫无意义。

假设您的分组只是为了表示选项，您可以使用 this 排除最后一个内部组`1(2(3(4(5(6(7(89?)?)?)?)?)?)?)?`。

例子：

`1(2(3(4(5(6(7(8(9)?)?)?)?)?)?)?)?`将全局匹配这个

987654321 1111111111111112121211112121121212312111 多次。

所以，都是相对的。

# sql-server - 查找和删除重复的子字符串

> ID：10586932
> 
> 赞同：4
> 
> 时间：2012-05-14T16:02:15.313
> 
> 标签：sql-server, sql-server-2008, tsql

我在 SQL Server 2008 表中有一个列，其中部分字符串被意外重复。

有没有人有一种快速简便的方法来删除尾随的重复子字符串？

例如，

```
alpha\bravo\charlie\delta\charlie\delta 
```

应该

```
alpha\bravo\charlie\delta 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-14T16:36:57.917

如果您还没有数字表：

```
SET NOCOUNT ON;
DECLARE @UpperLimit int = 4000;

;WITH n(rn) AS
(
    SELECT ROW_NUMBER() OVER (ORDER BY [object_id])
    FROM sys.all_columns
)
SELECT [Number] = rn - 1
INTO dbo.Numbers FROM n
WHERE rn <= @UpperLimit + 1;

CREATE UNIQUE CLUSTERED INDEX n ON dbo.Numbers([Number]); 
```

现在是一个通用的拆分函数，它将把你的分隔字符串变成一个集合：

```
CREATE FUNCTION dbo.SplitString
(
    @List  nvarchar(max),
    @Delim char(1)
)
RETURNS TABLE
AS
    RETURN ( SELECT 
        rn, 
        vn = ROW_NUMBER() OVER (PARTITION BY [Value] ORDER BY rn), 
        [Value]
      FROM 
      ( 
        SELECT 
          rn = ROW_NUMBER() OVER (ORDER BY CHARINDEX(@Delim, @List + @Delim)),
          [Value] = LTRIM(RTRIM(SUBSTRING(@List, [Number],
          CHARINDEX(@Delim, @List + @Delim, [Number]) - [Number])))
        FROM dbo.Numbers
        WHERE Number <= LEN(@List)
        AND SUBSTRING(@Delim + @List, [Number], 1) = @Delim
      ) AS x
    );
GO 
```

然后是一个将它们重新组合在一起的函数：

```
CREATE FUNCTION dbo.DedupeString
(
    @List nvarchar(max)
)
RETURNS nvarchar(max)
AS
BEGIN
    RETURN ( SELECT newval = STUFF((
     SELECT N'\' + x.[Value] FROM dbo.SplitString(@List, '\') AS x
      WHERE (x.vn = 1)
      ORDER BY x.rn
      FOR XML PATH(''), TYPE).value(N'./text()[1]', N'nvarchar(max)'), 1, 1, N'')
    );
END
GO 
```

示例用法：

```
SELECT dbo.DedupeString(N'alpha\bravo\bravo\charlie\delta\bravo\charlie\delta'); 
```

结果：

```
alpha\bravo\charlie\delta 
```

你也可以这样说：

```
UPDATE dbo.MessedUpTable
  SET OopsColumn = dbo.DedupeString(OopsColumn); 
```

@MikaelEriksson 可能会以一种更有效的方式使用 XML 消除重复项，但在那之前我可以提供。:-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-14T16:53:15.420

```
create function RemoveDups(@S nvarchar(max)) returns nvarchar(max)
as
begin
  declare @R nvarchar(max)
  declare @W nvarchar(max)
  set @R = ''

  while len(@S) > 1
  begin
    -- Get the first word
    set @W = left(@S, charindex('/', @S+'/')-1)

    -- Add word to result if not already added
    if '/'+@R not like '%/'+@W+'/%'
    begin
      set @R = @R + @W + '/'
    end 

    -- Remove first word
    set @S = stuff(@S, 1, charindex('/', @S+'/'), '')
  end

  return left(@R, len(@R)- 1)
end 
```

根据[Aaron Bertrand](https://stackoverflow.com/users/61305/aaron-bertrand)的要求。但是，我不会声称执行速度最快。

```
-- Table to replace in
declare @T table
(
  ID int identity,
  Value nvarchar(max)
)

-- Add some sample data
insert into @T values ('alpha/beta/alpha/gamma/delta/gamma/delta/alpha')
insert into @T values ('delta/beta/alpha/beta/alpha/gamma/delta/gamma/delta/alpha')

-- Update the column
update T
set Value = NewValue
from (
       select T1.ID,
              Value,
              stuff((select '/' + T4.Value
                     from (
                            select T3.X.value('.', 'nvarchar(max)') as Value,
                                   row_number() over(order by T3.X) as rn
                            from T2.X.nodes('/x') as T3(X)
                          ) as T4
                     group by T4.Value
                     order by min(T4.rn)
                     for xml path(''), type).value('.',  'nvarchar(max)'), 1, 1, '') as NewValue
       from @T as T1
         cross apply (select cast('<x>'+replace(T1.Value, '/', '</x><x>')+'</x>' as xml)) as T2(X)
     ) as T

select *
from @T 
```

# c++ - 用 std::complex 创建复无穷大 在 C++ 中

> ID：10586933
> 
> 赞同：14
> 
> 时间：2012-05-14T16:02:16.390
> 
> 标签：c++, nan, infinity, complex-numbers, numeric-limits

我正在尝试创建一个等于 Inf+Inf*j 的复无穷大，其中 j 是复变量。当我这样做时：

```
#include <complex>
#include <limits>
using std;

...

complex<double> attempt1 =
   complex<double>( numeric_limits<double>::infinity(),
                    numeric_limits<double>::infinity() ); 
```

返回复数 (NaN + Inf*j)。

但

```
complex<double> attempt2 =
   complex<double>( numeric_limits<double>::infinity() ); 
```

返回复数 (Inf + 0*j)。

还 ：

```
complex<double> attempt_at_imag_inf =
   complex<double>(any_value_here, numeric_limits<double>::infinity()); 
```

返回复数 (NaN + Inf*j)。

有人知道这里发生了什么吗？每当我尝试将虚部设为无穷大时，就会在实部上写入 NaN。

当然，以上仅适用于支持 NaN 和 Infinity 的类型。我正在使用 g++ v4.6.1。我查看了 numeric_limits 标头，没有迹象表明上述情况应该发生。

为了将上述内容置于上下文中，我实际上是在对复杂的 numeric_limits 进行部分专业化时执行上述操作。非常感谢您考虑这个问题。

对原帖的修订

我提供了一个完整但简短的程序来说明这个问题。我还提供了一些关于如何编译程序以生成结果的更多限定信息。

```
#include <iostream>
#include <complex>
#include <limits>

using namespace std;

int main(int argc, char* argv[])
{

   complex<double> my_complex_inf =
      complex<double>(numeric_limits<double>::infinity(),
                      numeric_limits<double>::infinity());

   cout << "my_complex_inf = " << my_complex_inf << endl;

   complex<double> attempt2 =
      complex<double>( numeric_limits<double>::infinity() );

   cout << "attempt2 = " << attempt2 << endl;

   double any_value_here = 0;

   complex<double> attempt_at_imag_inf =
      complex<double>(0, numeric_limits<double>::infinity());

   cout << "attempt_at_imag_inf = " << attempt_at_imag_inf << endl;

   return 0;

} 
```

在 Ubuntu 上使用 -std=c++0x 在 g++ 版本 4.6.1 中编译上述内容，得到以下结果：

```
my_complex_inf = (nan,inf)
attempt2 = (inf,0)
attempt_at_imag_inf = (nan,inf) 
```

如果没有 -std=c++0x 选项，结果是：

```
my_complex_inf = (inf,inf)
attempt2 = (inf,0)
attempt_at_imag_inf = (0,inf) 
```

所以问题真的是为什么 GNU g++ V4.6.1 在指定 C++0x 时给出它的答案？

对原始帖子的修订 2

我刚刚在 Octave (MATLAB-like numerics package) 中尝试了以下内容：

a=inf + j*inf

答案是：

a = NaN + Infi

这正是我在 C++11 代码 (C++0x) 中看到的。我不知道 Octave 是用什么编译的（我相信它是 C++ 和 FORTRAN 的组合），但如果该包返回我得到的结果，那么我认为这是众所周知的行为。

但是，我查看了 C++11 草案标准，找不到任何关于这种行为的提及。

对原始帖子的修订 3

添加以下行

```
my_complex_inf.real(my_complex_inf.imag()); 
```

在为 C++11 编译时，在构建 my_complex_inf 之后返回“正确”答案（inf，inf）。不幸的是，现在这是一个两步过程，我无法在 constexpr 函数中创建这种复杂的无穷大。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T20:31:14.117

转换为复数的标量 Inf 是 inf+0 j。上面是对的。复平面中的标量 Inf 偏移意味着 a 旋转并且不可计算，因此 Nan 是正确的。又是什么问题？

“有龙。”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T23:18:17.613

您遇到了 C++11（和 C11）指定复数并感到困惑的方式。

基本上，在规范规定的模型中，只有一个无穷大（由 (inf,0) 表示），并试图将“无穷大”放入 Nan 中复数结果的虚部，因为在那个模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T02:29:32.430

在主线（gcc-4.8）中，我得到了 -std=c++0x 预期的（无 -std）答案：

```
my_complex_inf = (inf,inf)
attempt2 = (inf,0)
attempt_at_imag_inf = (0,inf) 
```

带有 -std-c++11 的 gcc-4.6.3 给出了意想不到的答案：

```
my_complex_inf = (-nan,inf)
attempt2 = (inf,0)
attempt_at_imag_inf = (-nan,inf) 
```

我认为构造函数应该只根据相应的参数设置实数和虚数类型。应该没有`nan`。

# vb.net - 如何将 vb.net ComboBox 绑定到相关表

> ID：10586941
> 
> 赞同：0
> 
> 时间：2012-05-14T16:02:31.697
> 
> 标签：vb.net, winforms, data-binding, relational-database

我正在针对 SQL Server 关系数据库开发 Windows 窗体应用程序。数据库模式的一个示例是：

```
TableA
------------------
PK  A_ID    uniqueidentifier
    A_NAME  varchar(254)

TableB
------------------
PK  B_ID    uniqueidentifier
FK  A_ID    uniqueidentifier
    B_NAME  varchar(254)

TableC
------------------
PK  C_ID    uniqueidentifier
FK  A_ID    uniqueidentifier
    C_NAME  varchar(254) 
```

在表单中，我有一个 ComboBox ( `cboA_ID`) 来选择`TableA`记录（DataSource = TableA、DisplayMember = A_NAME、ValueMember = A_ID）和一个 TabControl，其中每个选项卡上的控件都绑定到`TableB`或中的字段`TableC`。

我的问题是，是否可以绑定`cboA_ID`到`TableB.A_ID`and `TableC.A_ID`？

这是我的第一个数据库应用程序，所以如果有更好的方法可以做到这一点，我会全力以赴。我已经使用 Visual Studio 2010 中的向导设置了所有内容，因此我仍然不是 100% 熟悉所有各种 TableAdapter 和 DataSet 的功能。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T16:11:44.180

您可能无法同时将 ComboBox 数据绑定（数据绑定？）到两个表 - 它们会在 ComboBox 中显示哪个值方面相互争斗，并且很可能最终会错误地破坏您的数据表数据。

您可能需要为每个选项卡使用单独的 ComboBox，或者根据当前选项卡更改 ComboBox 的数据绑定。

# php - 简单的登录脚本

> ID：10586943
> 
> 赞同：0
> 
> 时间：2012-05-14T16:02:36.907
> 
> 标签：php, mysql, login-control

我正在尝试做一个简单的登录脚本。也就是说，通过 POST 操作接受表单内容。检查数据库中的匹配记录。从该行中提取其他信息，例如`Full Name`.

我的代码是；

```
if ( !isset($_POST['loginsubmit']) ) {
    //Show login form
    ?>

    <form action="<?php echo htmlentities($_SERVER['PHP_SELF']); ?>" method="post">
        <p>
            Account ID:
            <input name="AccountID" type="text" />
        </p>
        <p>
            Username:
            <input name="userEmail" type="text" />
        </p>
        <p>Password:
            <input name="userPassword" type="password" />
        <p>
            <input name="loginsubmit" type="submit" value="Submit" />
        </p>
    </form>
    <?php
}
else {
    //Form has been submitted, check for logon details
    $sql = "SELECT * FROM users WHERE 'accountID'=". $_POST['AccountID']. " AND     'userEmail'=". $_POST['userEmail'] . " AND 'userPassword'=". $_POST['userPassword']. "     LIMIT 1";
    $result = mysql_query($sql);
    $count = mysql_num_rows($result);
    if ($count == 1){
        echo"Correct Username/Password";
    }
    else {
        echo "Wrong Username or Password";
    }
} 
```

我有两个问题。首先使用上面的代码，我不断收到以下错误。

> 警告：mysql_num_rows() 期望参数 1 是资源，布尔值在 ...

其次，如何从数据库中获取其他详细信息字段。我相信

```
$result=mysql_query($sql); 
```

包含 MySQL 行的数组，所以我可以做类似的事情；

```
echo $result['fullName']; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:13:55.137

首先清理字段以防止 SQL 注入。

```
$sanitize_fields = array('AccountID','userEmail','userPassword'); 
foreach( $sanitize_fields as $k => $v ) 
{
    if( isset( $_POST[ $v ] ) ) 
        $_POST[ $v ] = mysql_real_escape_string( $_POST[ $v ] ); 
} 
```

然后引用查询中的字符串字段。最初，您的查询中有错误。这就是为什么你得到一个布尔值 false 的原因。

```
$sql = "SELECT * FROM users WHERE accountID='". $_POST['AccountID']. "' AND userEmail='". $_POST['userEmail'] . "' AND userPassword='". $_POST['userPassword']. "' LIMIT 1"; 
```

我建议您在运行查询后执行以下操作，以查看 MySQL 生成的错误，如果有的话。

```
$result = mysql_query($sql) or die('Query failed: ' . mysql_error()); 
```

MySQL 扩展正在逐步淘汰，并且有更新更好的扩展，例如 MySQLi 和 PDO，看看这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:16:42.827

这里的问题是您的查询无法选择任何行，因此从调用`FALSE`中返回了一个布尔值。`mysql_query`

您应该修复您的查询并始终检查`$result = mysql_query($query);`返回是否为假，如下所示：

```
// ...
$result = mysql_query($query);
if($result !== false) {
    $count = mysql_num_rows($result);
    // ...
} 
```

但我建议使用 PDO 或至少 mysqli [http://php.net/mysqli](http://php.net/mysqli)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:08:48.273

在您的 SQL 语句中：

```
$sql = "SELECT * FROM users WHERE 'accountID'=". $_POST['AccountID']. " AND 'userEmail'=". $_POST['userEmail'] . " AND 'userPassword'=". $_POST['userPassword']. " LIMIT 1"; 
```

如果在表格中，userEmail 和 userPassword 是字符串，请添加单个 qoutes：

```
$sql = "SELECT * FROM users WHERE accountID=". $_POST['AccountID']. " AND userEmail='". $_POST['userEmail'] . "' AND userPassword='". $_POST['userPassword']. "' LIMIT 1"; 
```

要获得结果：

```
$result = mysql_query($sql);

while ($row = mysql_fetch_array($result))
{
    if(mysql_num_rows($result) > 0)
        echo $row['COLUMN_NAME'];
    }
} 
```

您的代码非常不安全：

*   请使用[MySQLi](http://en.wikipedia.org/wiki/MySQLi)或[PDO](http://en.wikipedia.org/wiki/PHP#History)与数据库交互
*   在发送到数据库之前转义所有输入数据

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T16:10:19.893

尝试这个：

```
 else {
        //Form has been submitted, check for logon details
        $conn = mysql_connect("db-host-here","db-user-here","db-pass-here");

        $sql = "SELECT * FROM users WHERE accountID=". mysql_real_escape_string($_POST['AccountID']). " AND userEmail='". $_POST['userEmail']=mysql_real_escape_string($_POST['userEmail']); . "' AND userPassword='".  $_POST['userPassword']=mysql_real_escape_string($_POST['userPassword']);. "' LIMIT 1";
        $result = mysql_query($sql,$conn);
        $count = mysql_num_rows($result);
        if($count == 1){
            echo"Correct Username/Password";
        }
        else {
            echo "Wrong Username or Password";
        }
    }
    // Get other information:

    $dbInfo = mysql_fetch_assoc(); //If more than one row can be selected, use a while loop.

    //Now play with $dbInfo:

    echo $dbInfo['some_other_column']; 
```

您的查询中有单引号，而您不需要它们，而您在需要的地方却错过了它们。试试上面的代码。

将`db-host-here`,`db-user-here`和替换`db-password-here`为正确的数据库信息。

我在你的代码中做了一些转义，以防止注入攻击。但是你真的应该考虑使用准备好的语句。

# java - Java - 从字符串生成条件

> ID：10586950
> 
> 赞同：0
> 
> 时间：2012-05-14T16:02:57.513
> 
> 标签：java

我正在尝试使用作为输入的字符串生成一些条件。
例如，我得到输入字符串“length = 15”，我想从中创建条件：length == 15。更具体地说，我的程序中有一个名为 length 的 int，它被设置为具体值。
我想从用户那里得到一个条件作为输入（“length < 15”或“length = 15”....）并创建一个 if 语句来生成条件并对其进行测试。
最好的方法是什么？
非常感谢
本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:23:30.317

除非您在谈论代码生成（即通过输入字符串生成 Java 代码），否则您无法基于字符串生成 if 语句。

您必须为您的条件语言编写一个解析器，并解释生成的解析树。

最后它看起来像这样：

```
Condition cond = ConditionParser.parse("length = 15");

if (cond.eval()) {
    // condition is true
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:20:54.713

使用字符串标记器。区分标记（或输入字符串的最小部分）的默认方法是空格，这对您有利。查看 javadocs 了解详情： [http ://docs.oracle.com/javase/1.3/docs/api/java/util/StringTokenizer.html](http://docs.oracle.com/javase/1.3/docs/api/java/util/StringTokenizer.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:57:43.623

根据您对输入格式的限制，您可以考虑使用 Rhino 嵌入 Javascript。您的“条件”必须是有效的 JavaScript 代码。像这样的东西（免责声明：尚未编译）：

```
import javax.script.*;

public bool evalCondition (Object context, String javascript)  {
  ScriptEngine engine = new ScriptEngineManager().getEngineByName("javascript");
  Object result = engine.eval(javascript);
  Boolean condTrue = (Boolean)result;
  return condTrue;
} 
```

有关更多详细信息，请参阅[嵌入 Rhino 教程](http://www.mozilla.org/rhino/tutorial.html)。

# android - base64 图像和 html.fromhtml android

> ID：10586953
> 
> 赞同：4
> 
> 时间：2012-05-14T16:03:05.773
> 
> 标签：android, base64

我的数据以 html 格式存储在 db 上。

图像以 base64 格式存储（作为 db 中的字符串）。

我试图展示这些数据。

我的 textView 设置如下：

> setText(Html.fromHtml(内容));

“内容”中的所有 html 标记都正确显示。除了“img”标签（它包含一个 base64 编码图像）。

所以，我的问题是：'Html.fromHtml'的标签'img'可以解码带有base64图像的字符串吗？

ps：标签所在的地方只是显示了一个灰色的小方块。没有错误。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T17:02:13.087

结合`Html.fromHtml`您自己的`Html.ImageGetter`.

见[这里](http://developer.android.com/reference/android/text/Html.html#fromHtml%28java.lang.String,%20android.text.Html.ImageGetter,%20android.text.Html.TagHandler%29)。

覆盖时`Html.ImageGetter.getDrawable`，将 Base64 字符串转换为字节数组（您可以使用`android.util.Base64`）并将其输入`BitmapFactory.decodeByteArray`以生成 a `Bitmap`，然后您可以将其传递给 a 的构造函数`BitmapDrawable`以返回。

例如：

```
Html.fromHtml(content, new Html.ImageGetter() {
        @Override
        public Drawable getDrawable(String source) {
            byte[] data = Base64.decode(source, Base64.DEFAULT);
            Bitmap bitmap = BitmapFactory.decodeByteArray(data, 0, data.length);                
            return new BitmapDrawable(getResources(), bitmap);
        }
}, null); 
```

# c++ - 什么会导致 D3D11CreateDevice() 因 E_FAIL 而失败？

> ID：10586956
> 
> 赞同：6
> 
> 时间：2012-05-14T16:03:27.640
> 
> 标签：c++, directx, directx-11

我正在使用以下代码调用 D3D11CreateDevice()：

```
ID3D11Device* md3dDevice;
ID3D11DeviceContext* md3dImmediateContext;
D3D_DRIVER_TYPE md3dDriverType = D3D_DRIVER_TYPE_HARDWARE;
createDeviceFlags = D3D11_CREATE_DEVICE_DEBUG;
HRESULT hr = D3D11CreateDevice(
            0,                 
            md3dDriverType,
            0,                 
            createDeviceFlags, 
            0, 0,              
            D3D11_SDK_VERSION,
            &md3dDevice,
            &featureLevel,
            &md3dImmediateContext); 
```

但是，存储在中的结果`HRESTUL hr`是`E_FAIL`. 控制台有以下输出：

> Init Direct3D.exe 中 0x7590b9bc 处的第一次机会异常：Microsoft
> C++ 异常：内存位置 0x0049ec64 处的 _com_error ..
> c:\users\andrew\desktop\code\common\d3dapp.cpp(389):
> D3D11CreateDevice(0, md3dDriverType, 0 , createDeviceFlags, 0, 0, D3D11_SDK_VERSION, &md3dDevice, &featureLevel, &md3dImmediateContext)
> hr=E_FAIL (0x80004005) 初始化 Direct3D.exe 已触发断点

我不认为这是代码构建时的链接问题，但定义了以下附加依赖项：

> d3d11lib
> d3dx11d.lib
> D3DCompiler.lib
> Effects11d.lib
> dxerr.lib

我的下一个想法是我的卡与 D3D11 不兼容。然而，这种情况并非如此。这是输出`dxdiag`：

```
------------------
System Information
------------------
Time of this report: 5/14/2012, 02:29:16
       Machine name: WINDOZE
   Operating System: Windows 7 Professional 64-bit (6.1, Build 7601) Service Pack 1 (7601.win7sp1_gdr.120330-1504)
           Language: English (Regional Setting: English)
System Manufacturer: Gigabyte Technology Co., Ltd.
       System Model: GA-880GMA-UD2H
               BIOS: Award Modular BIOS v6.00PG
          Processor: AMD Phenom(tm) II X4 955 Processor (4 CPUs), ~3.2GHz
             Memory: 8192MB RAM
Available OS Memory: 8188MB RAM
          Page File: 4121MB used, 12254MB available
        Windows Dir: C:\Windows
    DirectX Version: DirectX 11
DX Setup Parameters: Not found
   User DPI Setting: Using System DPI
 System DPI Setting: 96 DPI (100 percent)
    DWM DPI Scaling: Disabled
     DxDiag Version: 6.01.7601.17514 64bit Unicode

------------
DxDiag Notes
------------
      Display Tab 1: No problems found.
      Display Tab 2: No problems found.
        Sound Tab 1: No problems found.
        Sound Tab 2: No problems found.
        Sound Tab 3: No problems found.
        Sound Tab 4: No problems found.
          Input Tab: No problems found.

--------------------
DirectX Debug Levels
--------------------
Direct3D:    0/4 (retail)
DirectDraw:  0/4 (retail)
DirectInput: 0/5 (retail)
DirectMusic: 0/5 (retail)
DirectPlay:  0/9 (retail)
DirectSound: 0/5 (retail)
DirectShow:  0/6 (retail)

---------------
Display Devices
---------------
          Card name: ATI Radeon HD 5670
       Manufacturer: Advanced Micro Devices, Inc.
          Chip type: ATI display adapter (0x68D8)
           DAC type: Internal DAC(400MHz)
         Device Key: Enum\PCI\VEN_1002&DEV_68D8&SUBSYS_56701545&REV_00
     Display Memory: 1774 MB
   Dedicated Memory: 2032 MB
      Shared Memory: 3838 MB
       Current Mode: 1920 x 1080 (32 bit) (60Hz)
       Monitor Name: Generic PnP Monitor
      Monitor Model: E2241
         Monitor Id: GSM581A
        Native Mode: 1920 x 1080(p) (60.000Hz)
        Output Type: HDMI
        Driver Name: aticfx64.dll,aticfx64.dll,aticfx64.dll,aticfx32,aticfx32,aticfx32,atiumd64.dll,atidxx64.dll,atidxx64.dll,atiumdag,atidxx32,atidxx32,atiumdva,atiumd6a.cap,atitmm64.dll
Driver File Version: 8.17.0010.1119 (English)
     Driver Version: 8.951.0.0
        DDI Version: 11
       Driver Model: WDDM 1.1
  Driver Attributes: Final Retail
   Driver Date/Size: 3/9/2012 01:14:42, 958464 bytes
        WHQL Logo'd: Yes
    WHQL Date Stamp: 
  Device Identifier: {D7B71EE2-2B98-11CF-AA72-7A76BEC2C535}
          Vendor ID: 0x1002
          Device ID: 0x68D8
          SubSys ID: 0x56701545
        Revision ID: 0x0000
 Driver Strong Name: oem1.inf:ATI.Mfg.NTamd64.6.1:ati2mtag_Evergreen:8.951.0.0:pci\ven_1002&dev_68d8
     Rank Of Driver: 00E62001
        Video Accel: ModeMPEG2_A ModeMPEG2_C 
   Deinterlace Caps: {6E8329FF-B642-418B-BCF0-BCB6591E255F}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_PixelAdaptive 
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_BOBVerticalStretch 
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY 
                     {6E8329FF-B642-418B-BCF0-BCB6591E255F}: Format(In/Out)=(UYVY,UYVY) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_PixelAdaptive 
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(UYVY,UYVY) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_BOBVerticalStretch 
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(UYVY,UYVY) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY 
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(YV12,0x32315659) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {3C5323C1-6FB7-44F5-9081-056BF2EE449D}: Format(In/Out)=(NV12,0x3231564e) Frames(Prev/Fwd/Back)=(0,0,2) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_PixelAdaptive 
                     {552C0DAD-CCBC-420B-83C8-74943CF9F1A6}: Format(In/Out)=(NV12,0x3231564e) Frames(Prev/Fwd/Back)=(0,0,2) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_PixelAdaptive 
                     {6E8329FF-B642-418B-BCF0-BCB6591E255F}: Format(In/Out)=(NV12,0x3231564e) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_PixelAdaptive 
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(NV12,0x3231564e) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_BOBVerticalStretch 
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(NV12,0x3231564e) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY 
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC1,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC2,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC3,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC4,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(S340,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(S342,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
       D3D9 Overlay: Not Supported
            DXVA-HD: Not Supported
       DDraw Status: Enabled
         D3D Status: Enabled
         AGP Status: Enabled

          Card name: ATI Radeon HD 5670
       Manufacturer: Advanced Micro Devices, Inc.
          Chip type: ATI display adapter (0x68D8)
           DAC type: Internal DAC(400MHz)
         Device Key: Enum\PCI\VEN_1002&DEV_68D8&SUBSYS_56701545&REV_00
     Display Memory: 1774 MB
   Dedicated Memory: 2032 MB
      Shared Memory: 3838 MB
       Current Mode: 1600 x 900 (32 bit) (60Hz)
       Monitor Name: Generic PnP Monitor
      Monitor Model: W2043
         Monitor Id: GSM4E9D
        Native Mode: 1600 x 900(p) (60.000Hz)
        Output Type: HD15
        Driver Name: aticfx64.dll,aticfx64.dll,aticfx64.dll,aticfx32,aticfx32,aticfx32,atiumd64.dll,atidxx64.dll,atidxx64.dll,atiumdag,atidxx32,atidxx32,atiumdva,atiumd6a.cap,atitmm64.dll
Driver File Version: 8.17.0010.1119 (English)
     Driver Version: 8.951.0.0
        DDI Version: 11
       Driver Model: WDDM 1.1
  Driver Attributes: Final Retail
   Driver Date/Size: 3/9/2012 01:14:42, 958464 bytes
        WHQL Logo'd: Yes
    WHQL Date Stamp: 
  Device Identifier: {D7B71EE2-2B98-11CF-AA72-7A76BEC2C535}
          Vendor ID: 0x1002
          Device ID: 0x68D8
          SubSys ID: 0x56701545
        Revision ID: 0x0000
 Driver Strong Name: oem1.inf:ATI.Mfg.NTamd64.6.1:ati2mtag_Evergreen:8.951.0.0:pci\ven_1002&dev_68d8
     Rank Of Driver: 00E62001
        Video Accel: ModeMPEG2_A ModeMPEG2_C 
   Deinterlace Caps: {6E8329FF-B642-418B-BCF0-BCB6591E255F}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_PixelAdaptive 
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_BOBVerticalStretch 
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(YUY2,YUY2) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY 
                     {6E8329FF-B642-418B-BCF0-BCB6591E255F}: Format(In/Out)=(UYVY,UYVY) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_PixelAdaptive 
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(UYVY,UYVY) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_BOBVerticalStretch 
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(UYVY,UYVY) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY 
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(YV12,0x32315659) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {3C5323C1-6FB7-44F5-9081-056BF2EE449D}: Format(In/Out)=(NV12,0x3231564e) Frames(Prev/Fwd/Back)=(0,0,2) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_PixelAdaptive 
                     {552C0DAD-CCBC-420B-83C8-74943CF9F1A6}: Format(In/Out)=(NV12,0x3231564e) Frames(Prev/Fwd/Back)=(0,0,2) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_PixelAdaptive 
                     {6E8329FF-B642-418B-BCF0-BCB6591E255F}: Format(In/Out)=(NV12,0x3231564e) Frames(Prev/Fwd/Back)=(0,0,1) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_PixelAdaptive 
                     {335AA36E-7884-43A4-9C91-7F87FAF3E37E}: Format(In/Out)=(NV12,0x3231564e) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY DeinterlaceTech_BOBVerticalStretch 
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(NV12,0x3231564e) Frames(Prev/Fwd/Back)=(0,0,0) Caps=VideoProcess_YUV2RGB VideoProcess_StretchX VideoProcess_StretchY 
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC1,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC2,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC3,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(IMC4,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(S340,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
                     {5A54A0C9-C7EC-4BD9-8EDE-F3C75DC4393B}: Format(In/Out)=(S342,UNKNOWN) Frames(Prev/Fwd/Back)=(0,0,0) Caps=
       D3D9 Overlay: Not Supported
            DXVA-HD: Not Supported
       DDraw Status: Enabled
         D3D Status: Enabled
         AGP Status: Enabled 
```

任何有关可能导致 E_FAIL 的原因的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T21:29:56.373

最新版本的 SDK 调试层不在旧版 DirectX SDK（2010 年 6 月）中。您需要安装独立的 Windows 8.0 SDK、Visual Studio 2012，或者您可以只安装 VS 2012 远程调试工具包。

[http://blogs.msdn.com/b/chuckw/archive/2013/02/26/directx-11-1-and-windows-7-update.aspx](http://blogs.msdn.com/b/chuckw/archive/2013/02/26/directx-11-1-and-windows-7-update.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-14T17:03:18.833

问题似乎是您没有`Direct X Debug Runtime`安装（安装时有一个选项可以安装`Direct X SDK`），而只是常规的`Direct X Runtime`. 提供更少的`Direct X Runtime`开销并且速度更快，但您不能使用它来调试应用程序。

```
--------------------
DirectX Debug Levels
--------------------
Direct3D:    0/4 (retail)
DirectDraw:  0/4 (retail)
DirectInput: 0/5 (retail)
DirectMusic: 0/5 (retail)
DirectPlay:  0/9 (retail)
DirectSound: 0/5 (retail)
DirectShow:  0/6 (retail) 
```

或者，如果您安装了它，它没有打开。您可能会发现一些有用的信息[，如何在 Direct X Runtime 的 Debug 和 Release 版本之间切换](http://legalizeadulthood.wordpress.com/2009/06/28/direct3d-programming-tip-5-use-the-debug-runtime/)。

# entity-framework-4.1 - 默认为 EF 4.3.1 时需要使用 EF 4.1

> ID：10586958
> 
> 赞同：3
> 
> 时间：2012-05-14T16:03:34.947
> 
> 标签：entity-framework-4.1, nuget, entity-framework-4.3

我在 VS2010 SP1 上运行开发，当我运行 Install-Package EntityFramework 时，我得到了 Nuget 安装的 EF 4.3.1。有没有办法可以将版本限制为 EF 4.1？我想对它们进行不同的检查。请帮忙！

-谢谢，拉姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T16:25:06.790

默认情况下，Nuget 将安装给定包的最新版本。

[但是您可以在包管理器控制台](http://docs.nuget.org/docs/start-here/using-the-package-manager-console#Installing_a_Package)中安装任何以前版本的 nuget 包（在 nuget.org 上可用），指定[Version](http://docs.nuget.org/docs/reference/package-manager-console-powershell-reference#Install-Package)选项，例如：

```
PM> Install-Package EntityFramework -Version 4.1.10715.0 
```

[您可以在此处](http://nuget.org/packages/EntityFramework/4.3.1)查看可用的 EF 版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T04:16:15.533

此外，要查看包的可用版本，请在控制台中输入：Get-Package -ListAvailable -Filter entityframework（包的名称）

萨吉

# javascript - 当鼠标悬停在链接旁边时，如何在链接旁边创建弹出框？

> ID：10586962
> 
> 赞同：8
> 
> 时间：2012-05-14T16:03:43.997
> 
> 标签：javascript, jquery, css

这是我想要实现的：

我有两个显示在网页上的超链接：

```
<a href="http://foo.com"> foo </a>

<a href="http://bar.com"> bar </a> 
```

我也有两个对链接作为 div 的描述：

```
<div id="foo">foo means foo</div>

<div id="bar">bar means bar</div> 
```

现在，当我将鼠标悬停在 foo 的链接上时，应该会弹出相应的描述 div，并且它应该会在我的光标所在的位置旁边弹出。

因此，如果我将鼠标悬停在“foo”上，一个包含“foo 表示 foo”的弹出框应该出现在鼠标光标旁边。同样的事情也适用于“酒吧”。

请使用 javascript/jquery、CSS 或这些方法的组合展示一种快速简单的方法来实现这一点。

PS 我很抱歉之前没有解释清楚，我实际上想在描述 div 中添加更多链接或图像而不是纯文本，所以常规的工具提示可能不会这样做。

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-14T16:16:41.043

这是最简单的解决方案。

*HTML：*

```
<a href="http://foo.com" data-tooltip="#foo">foo</a>
<a href="http://bar.com" data-tooltip="#bar">bar</a>

<div id="foo">foo means foo</div>
<div id="bar">bar means bar</div> 
```

*CSS：*

```
div {
    position: absolute;
    display: none;
    ...
}​ 
```

*JavaScript：*

```
$("a").hover(function(e) {
    $($(this).data("tooltip")).css({
        left: e.pageX + 1,
        top: e.pageY + 1
    }).stop().show(100);
}, function() {
    $($(this).data("tooltip")).hide();
}); 
```

```
$("a").hover(function(e) {
  $($(this).data("tooltip")).css({
    left: e.pageX + 1,
    top: e.pageY + 1
  }).stop().show(100);
}, function() {
  $($(this).data("tooltip")).hide();
});
```

```
div {
  position: absolute;
  display: none;
  border: 1px solid green;
  padding:5px 15px;
  border-radius: 15px;
  background-color: lavender;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>

<a href="http://foo.com" data-tooltip="#foo">foo</a>
<a href="http://bar.com" data-tooltip="#bar">bar</a>

<div id="foo">foo means foo</div>
<div id="bar">bar means bar</div>
```

**​演示：http:** [//jsfiddle.net/8UkHn/](http://jsfiddle.net/8UkHn/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-14T16:08:44.167

您是否考虑过在这种情况下使用“标题”属性？

```
<a href="http://foo.com" title="foo means foo"> foo </a> 
```

看看这是否符合您的需要。

它的作用是，当您将鼠标移到链接“foo”上时，鼠标指针旁边会出现一个包含“foo mean foo”的小框。

# javascript - Array() 和 Array.prototype 用法

> ID：10586968
> 
> 赞同：0
> 
> 时间：2012-05-14T16:03:54.940
> 
> 标签：javascript

首先，如果答案很明显和/或很容易找到，我想找个借口。我没有找到任何完整的答案。

问题很简单：

```
var array1 = Array().slice.call(arguments,1);
var array2 = Array.prototype.slice.call(arguments,1); 
```

他们做同样的事情。你能对对象、日期、字符串等原型做这样的事情吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T16:06:59.997

是的，您可以，因为每个实例都继承自其构造函数的原型。

即`(new Array()).slice`（或更好，`[].slice`）与 完全相同的方法`Array.prototype.slice`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:07:46.823

第二种方法更好，因为您没有创建一个未使用的数组。使用第一种方法，您正在构建一个数组，然后使用动态原型链解析来定位它的 slice 方法，然后您`call`使用您的参数作为上下文。第二种方法直接访问该`slice`方法，因此您避免了对象创建和原型链解析，所以一切都更好。

# jquery - 调整窗口大小后，Jquery UI tabe 无法与 JScrollPane 一起使用

> ID：10586970
> 
> 赞同：1
> 
> 时间：2012-05-14T16:03:55.267
> 
> 标签：jquery, jquery-ui, fancybox, jscrollpane

我正在使用 Jquery、fancybox、jScrollPane 和 Jquery Ui 选项卡制作 html 视频库。画廊使用 jquery ui 分成选项卡，然后每个选项卡托管一个 jScrollPane。为了在调整窗口大小时保持数据大小调整，编写了一个函数来更改容器的 css 并重新初始化 jscrollpanes。jquery的代码如下：

```
$('.thumbNails').jScrollPane({});
$('.Captions').jScrollPane();
$(window).resize(function(){
    $('.video__gallery_container').css('width',$(window).width()-40);
    $('.thumbNails').css('width','95%');
    $('.Captions').css('width','95%');
    $('.thumbNails').jScrollPane().reinitialize();
    $('.Captions').jScrollPane().reinitialize();
}); 
```

html：视频库

```
 <!--[if lt IE 9]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <link rel="stylesheet" type="text/css" href="includes/video_gallery_ie.css" />
    <![endif]-->
</head>
<body>

    <div id="tabs" class="video_gallery_container">
        <ul>
            <li><a href="#tabs-1" class="tab">All</a></li>
            <li><a href="#tabs-2" class="tab">Pilots</a></li>
            <li><a href="#tabs-3" class="tab">Pilots</a></li>
            <li><a href="#tabs-4" class="tab">145 Repair Station</a></li>
            <li><a href="#tabs-5" class="tab">Supply</a></li>
        </ul>
        <div id="tabs-1" class="thumbNails">
                         <a href="#" rel="tooltip" title="first tooltip" class="videoLink" videowidth="800" videoheight="450" videofile="cycling_large"  videocaption="Caption for cycling_large goes here" ></a>
                         <a class="videoLink" videowidth="640" videoheight="360" videofile="ocean_medium" videocaption="Caption for ocean_medium goes here" ></a>
                         <a class="videoLink" videowidth="400" videoheight="250" videofile="winecountry_part1" videocaption="Caption for winecountry_part1 goes here"></a>
                         <a class="videoLink" videowidth="640" videoheight="402"  videofile="winecountry_part2" videocaption="Caption for winecountry_part2 goes here"></a>
                         <a class="videoLink" videowidth="860" videoheight="540" videofile="winecountry_part3" videocaption="Caption for winecountry_part3 goes here"></a>
                         <a class="videoLink" videowidth="300" videoheight="168" videofile="cycling_small"  videocaption="Caption for cycling_small goes here" ></a>
                         <div class="clear_both"></div></div>

        <div id="tabs-2" class="thumbNails">
                         <a class="videoLink" videowidth="860" videoheight="540" videofile="winecountry_part3" videocaption="Caption for winecountry_part3 goes here"></a>
                         <a class="videoLink" videowidth="300" videoheight="168" videofile="cycling_small"  videocaption="Caption for cycling_small goes here" ></a>
                         <div class="clear_both"></div></div>
        <div id="tabs-3" class="thumbNails">
                         <a class="videoLink" videowidth="800" videoheight="450" videofile="cycling_large"  videocaption="Caption for cycling_large goes here" ></a>
                         <a class="videoLink" videowidth="640" videoheight="360" videofile="ocean_medium" videocaption="Caption for ocean_medium goes here" ></a>
                         <div class="clear_both"></div></div>
        <div id="tabs-4" class="thumbNails">
                         <a class="videoLink" videowidth="400" videoheight="250" videofile="winecountry_part1" videocaption="Caption for winecountry_part1 goes here"></a>
                         <a class="videoLink" videowidth="640" videoheight="402"  videofile="winecountry_part2" videocaption="Caption for winecountry_part2 goes here"></a>
                         <a class="videoLink" videowidth="860" videoheight="540" videofile="winecountry_part3" videocaption="Caption for winecountry_part3 goes here"></a>
                         <div class="clear_both"></div></div>
        <div id="tabs-5" class="thumbNails">
                         <a class="videoLink" videowidth="860" videoheight="540" videofile="winecountry_part3" videocaption="Caption for winecountry_part3 goes here"></a>
                         <a class="videoLink" videowidth="300" videoheight="168" videofile="cycling_small"  videocaption="Caption for cycling_small goes here" ></a>
                         <div class="clear_both"></div></div>
    <div class="Captions"></div>
    </div>

    <!-- Hidden DIV container for video overlay code -->
    <div style="display: none;">
        <div id="videoPlayer"></div>
    </div>
<!-- Placed at the end of the document so the pages load faster-->
<script src="includes/bootstrap-tooltip.js"></script>
    <script src="includes/bootstrap-popover.js"></script>
    <script type="text/javascript" src="includes/jquery.jscrollpane.min.js"></script>
    <script type="text/javascript" src="includes/jquery.mousewheel.js"></script>
    <link type="text/css" href="includes/jquery-ui-1.8.20.custom/css/vader/jquery-ui-1.8.20.custom.css" rel="stylesheet" />
<script type="text/javascript" src="includes/jquery-ui-1.8.20.custom/js/jquery-ui-1.8.20.custom.min.js"></script>

<script type="text/javascript">
$(function(){

    // Tabs
    $('#tabs').tabs();

    //hover states on the static widgets
    $('#dialog_link, ul#icons li').hover(
        function() { $(this).addClass('ui-state-hover'); },
        function() { $(this).removeClass('ui-state-hover'); 
    });
});
</script>

</body>
</html> 
```

现在到问题的核心，代码运行完美，直到调整窗口大小，调整大小后，如果选择了选项卡，则不显示选项卡的内容，但是如果随后调整窗口大小，内容将出现。同样在调整大小后，如果选择了另一个选项卡，您可以返回在调整大小完成时加载的选项卡并且它仍然具有内容。我尝试使用诸如 $('.tab').live('click',function(){ $(this).trigger('resize'); }; 之类的代码手动触发调整大小事件；感谢您的帮助。

# spring - 从 Spring 3.0.5 移到 Spring 3.1.1 现在我的应用程序不起作用

> ID：10586971
> 
> 赞同：-1
> 
> 时间：2012-05-14T16:03:58.647
> 
> 标签：spring, spring-security

从 Spring 3.0.5 移到 Spring 3.1.1 现在我的应用程序无法运行，有人可以告诉我发生了什么吗？我删除了所有 3.0.5 罐子并添加了 3.1.1 罐子

```
2012-05-14 12:01:41,195 [main] ERROR org.springframework.web.context.ContextLoader - Context initialization failed
org.springframework.context.ApplicationContextException: Couldn't locate: org.springframework.ldap.core.support.BaseLdapPathContextSource.  If you are using LDAP with Spring Security, please ensure that you include the spring-ldap jar file in your application; nested exception is java.lang.ClassNotFoundException: org.springframework.ldap.core.support.BaseLdapPathContextSource
    at org.springframework.security.config.ldap.ContextSourceSettingPostProcessor.postProcessBeanFactory(ContextSourceSettingPostProcessor.java:34)
    at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:681)
    at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:664)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:446)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:385)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4206)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4705)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: java.lang.ClassNotFoundException: org.springframework.ldap.core.support.BaseLdapPathContextSource
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
    at org.springframework.util.ClassUtils.forName(ClassUtils.java:258)
    at org.springframework.security.config.ldap.ContextSourceSettingPostProcessor.postProcessBeanFactory(ContextSourceSettingPostProcessor.java:32)
    ... 21 more
May 14, 2012 12:01:41 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Exception sending context initialized event to listener instance of class org.springframework.web.context.ContextLoaderListener
org.springframework.context.ApplicationContextException: Couldn't locate: org.springframework.ldap.core.support.BaseLdapPathContextSource.  If you are using LDAP with Spring Security, please ensure that you include the spring-ldap jar file in your application; nested exception is java.lang.ClassNotFoundException: org.springframework.ldap.core.support.BaseLdapPathContextSource
    at org.springframework.security.config.ldap.ContextSourceSettingPostProcessor.postProcessBeanFactory(ContextSourceSettingPostProcessor.java:34)
    at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:681) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:10:15.410

您是否按照它的建议进行操作并验证您的应用程序中包含 spring-ldap ？那[显然是有问题的班级所在的地方](http://search.maven.org/#search%7Cga%7C1%7Cfc%3a%22org.springframework.ldap.core.support.BaseLdapPathContextSource%22)。我的猜测是您盲目地删除了所有名为 spring-* 的 jar 并添加到所有 3.1 spring-* jar 文件中，但 spring-ldap[不包含在基本 spring 3.1 发行版](http://www.springsource.org/ldap)中。事实上，它的版本控制是完全独立的，[目前是 1.3.1 版本](http://www.springsource.com/download/community?project=Spring%20LDAP)。

# android - Android 模拟器 互联网连接

> ID：10586979
> 
> 赞同：2
> 
> 时间：2012-05-14T16:04:21.760
> 
> 标签：android, android-emulator

我正在使用 win 7 64 位操作系统，使用 Android 2.2 我的模拟器无法连接到计算机。我在代理服务器后面使用互联网。我通过填写机器的代理设置来更改 APN 设置。但是我还是无法连接到互联网 请任何可以帮助我的人吗？感谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-07-08T21:20:58.723

您可以在模拟器中设置代理。此链接描述了所有选项[https://developer.android.com/studio/run/emulator-networking.html](https://developer.android.com/studio/run/emulator-networking.html)。

一种方法是从命令行运行模拟器时添加 -http-proxy：

```
emulator.exe -avd YOUR_AVD_NAME_HERE -http-proxy http://<machineName>:<port> 
```

或者

```
emulator.exe -avd YOUR_AVD_NAME_HERE -http-proxy http://<username>:<password>@<machineName>:<port> 
```

并考虑您的计算机是否有多个网络接口。也许您的模拟器正在尝试使用未连接的模拟器，这很常见。如果您使用 WIFI 接口，最简单的解决方案就是禁用 ETHERNET 接口。另一种方法是更改​​操作系统中接口的优先级。在 Windows 10 中，您可以通过以下方式执行此操作：

1.  转到控制面板 > 网络和 Internet > 网络连接
2.  右键单击所需的连接（更高优先级的连接）
3.  单击属性 > Internet 协议版本 4
4.  单击属性 > 高级
5.  取消选中“自动指标”
6.  在“接口度量”中输入 1
7.  单击 OK 重复较低优先级的连接，但这次将 20 放入“接口度量”您现在将使用较高优先级的连接作为默认值。

# excel - 搜索特定单词并将行复制到另一个工作表

> ID：10586984
> 
> 赞同：0
> 
> 时间：2012-05-14T16:04:32.687
> 
> 标签：excel, vba

我有一个电子表格，其中包含从 AP 和第 1 行到 2016 年的列（并且仍在增长）。我正在寻找一种简单的方法来搜索电子表格中的特定单词，例如“Gap”，并将包含单词“gap”的行复制到 Sheet2。我想它是否可以使用我输入单词的框，以便我可以根据需要搜索不同的内容。

我不希望电子表格变得更小（这是一个操作项列表，我需要它进行搜索，直到它到达一个空白行）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:34:36.303

```
'all variables must be declared    
Option Explicit
Sub CopyData()

'this variable holds a search phrase, declared as variant as it might be text or number
Dim vSearch As Variant
'these three variables are declared as long, technically the loop might exceed 32k (integer) therefore it is safer to use long
Dim i As Long
Dim k As Long
Dim lRowToCopy As Long

'the macro prompts a user to enter the search phrase
vSearch = InputBox("Search")
'varialbe i initially declared as 1 - macro starts calculations from the 1st row
i = 1
'macro will loop until it finds a row with no records
'I called a standard XLS function COUNTA to count the number of non-blank cells
'if the macro finds a row with no records it quits the loop
Do Until WorksheetFunction.CountA(Sheets("Main").Rows(i)) = 0

 'here I let the macro to continue its run despite a possible errors (explanation below)
  On Error Resume Next
  lRowToCopy = 0
 'if Find method finds no value VBA returns an error, this is why I allowed macro to run despite that. In case of error variable lRowToCopy keeps 0 value
 'if Find method finds a searched value it assigns the row number to var lRowToCopy
  lRowToCopy = Sheets("Main").Rows(i).Find(What:=vSearch, LookIn:=xlValues,     LookAt:=xlPart, SearchOrder:=xlByRows).Row
 'here we allow macro to disiplay error messages
  On Error GoTo 0

 'if var lRowToCopy does not equal to 0 that means a row with a searched value has been found
  If lRowToCopy > 0 Then

    'this loop looks for the first blank row in 2nd sheet, I also used COUNTA to find absolutely empty row
    For k = 1 To Sheets("ToCopy").Rows.Count

      'when the row is found, the macro performs copy-paste operation
      If WorksheetFunction.CountA(Sheets("ToCopy").Rows(k)) = 0 Then

          Sheets("Main").Rows(i).Copy
          Sheets("ToCopy").Select
          Rows(k).Select
          ActiveSheet.Paste
          'do not forget to exit for loop as it will fill all empty rows in 2nd sheet
          Exit For

      End If
    Next k

  End If

i = i + 1
Loop

End Sub 
```

# mysql - SQL：如何将分号附加到列值。

> ID：10586985
> 
> 赞同：1
> 
> 时间：2012-05-14T16:04:35.707
> 
> 标签：mysql, sql

我的数据库中有一个名为 details_location 的列，它引用了 url ex 的第二部分。“manager\reports\user\description\UsersRights.htm” 我想在每个行值后面附加一个分号，以便上面显示为“manager\reports\user\description\UsersRights.htm;”

我试过使用类似的东西

```
update reportdescriptions
set details_location = details_location+';' 
```

无济于事，我敢肯定这是我缺少的一些简单的东西。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T16:06:26.220

试试 CONCAT 函数

```
update reportdescriptions set details_location = concat(details_location,';') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:06:32.340

试试这个：

```
update reportdescriptions
set details_location = CONCAT(details_location, ';'); 
```

有关 的更多信息`CONCAT`，请查看[此](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_concat)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T16:06:29.153

你要`concat(field_name,"string to add")`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-14T16:07:17.727

你得到什么错误？如果您有一列 text 类型，您可能需要先将其转换为 varchar() 或 CONCAT() 之类的

```
UPDATE reportdescriptions
SET details_location = CONCAT(details_location , ';'); 
```

# java - 从控制台输入掩码

> ID：10586988
> 
> 赞同：1
> 
> 时间：2012-05-14T16:04:41.430
> 
> 标签：java

你能帮我输入掩码吗？

字符串格式 = "X-XX-XXX"

X 是来自控制台/键盘的用户输入。

我一直想在用户输入字符串格式时显示破折号 (-)。

你能帮我解决我的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-14T16:09:23.817

键入时不可能显示整个掩码，但您可以做的是一次读取单个字符，当您到达相关位置时，输出一个破折号。

**编辑：**可以在控制台中移动光标，这样您就可以输出掩码，然后相应地操纵光标（取​​决于按下了多少键）。

我刚刚在[这里](https://stackoverflow.com/questions/1001335/java-gotoxyx-y-for-console-applications)找到了这个：

```
char escCode = 0x1B;
int row = 10; int column = 10;
System.out.print(String.format("%c[%d;%df",escCode,row,column)); 
```

这应该将光标移动到控制台上的 10,10 位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T16:07:58.430

不幸的是，Java 没有无缓冲的控制台 I/O。您可能必须通过 JNI 绑定诅咒：

[http://plindenbaum.blogspot.com/2008/01/java-native-interface-jni-notebook.html](http://plindenbaum.blogspot.com/2008/01/java-native-interface-jni-notebook.html)

# php - Zend Framework - 验证上传内容（二次验证）

> ID：10586989
> 
> 赞同：0
> 
> 时间：2012-05-14T16:04:43.223
> 
> 标签：php, zend-framework

我目前正在让用户上传一个 MS Word 文档，我在其中检查 XML 中的版本。控制器当前检查 isValid() 然后点击一个进行解析和提取的库（因为 word 是一个存档）。现在由于它在技术上已经“有效”，我需要通过库再次检查有效性。Zend Framework 中最好的做法是什么？

来自 Kohana Land 的欢呼声；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T06:54:50.787

我想我明白你在找什么。
您当前调用的表单对表单有效，您的文件通过表单验证（正确的大小、扩展名......）现在您需要解压缩文件并验证内容。

我将假设您已经拥有验证内容的代码，并且只想了解如何在控制器中使用它。
'

```
public function anyAction() {

$form = new Form();
//test for $_POST
if ($this->getRequest()->isPost(){
    //Test form for validity
    if ($form->isValid($this->getRequest()->getPost()){
        //will receive file upload (unless disabled in element) and filter form values,
        //based on filters attached to the elements.
        $data = $form->getValues();
        //placeholder for whatever code is required to validate contents of file
        $validateFile = new MyFileValidator();
        //test for valid file contents
        if ($validateFile->isValid($data['file']){
            //Do some Stuff 
        }
        //if file contents is not valid, display form and populate values with unfiltered values
        $form->populate($this->getRequest()->getPost());
    }
   //if form is not valid, it should stay populated and display element errors
  }
//if not post send form to view
$this->view->form = $form;
} 
```

此示例应为此类问题提供基本的控制器工作流程。我希望它能解决你的问题。