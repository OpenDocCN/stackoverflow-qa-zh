# StackOverflow 问答 000581000-000581999

# java - 在 Java2D 中动态着色精灵？

> ID：581006
> 
> 赞同：2
> 
> 时间：2009-02-24T09:01:33.497
> 
> 标签：java, java-2d

我正在使用 Linux 上的 Java2D 创建一个带有类似 ascii 的地图的游戏（如 roguelike）。

通过 Graphics2D.drawImage 渲染 BufferedImages 可以渲染地形。我想动态更改每个绘制图像的色调，而不会对性能造成太大影响。我怎样才能做到这一点？

我怀疑 setComposite 是难题的一部分。目前我不需要保持背景完整（所以透明度不是问题）。我想使用多种颜色，所以预生成着色精灵对我来说不是一个解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T09:16:25.460

[不久前我问了一个类似的问题，并在这里](https://stackoverflow.com/questions/23763/colorizing-images-in-java)得到了一个很好的答案，尽管我提前做了所有的着色。在任何情况下，您都可能希望查看 BufferedImageOp。此外，[JH Labs 网站](http://www.jhlabs.com/ip/)有大量关于在 java 中进行图像处理的有用信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T11:23:35.030

为了获得高性能，您可能需要使用 JOGL。它使您可以很好地访问硬件加速，即使您不需要 3D 功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T14:51:26.263

鉴于 Tom Hawtin 的回答，我决定切换到一个允许更多控制的框架。JOGL 和 LWJGL 似乎都提供了对着色机制的访问。我选择了 LWJGL，因为它与我的其他需求重叠更多。

我发现这个[Space Invaders 教程](http://www.cokeandcode.com/spaceinvaderstutorial "太空入侵者教程")很有用，因为它是 Java2D 和 JOGL、LWJGL 之间的一个很好的玫瑰石。

这是我为 LWJGL Sprite 类创建的方法。

```
public void drawTinted(int x, int y, float red, float green, float blue) 
{
    GL11.glPushMatrix();

    texture.bind();

    GL11.glTranslatef(x, y, 0);     
    GL11.glColor3f(red,green,blue);

    GL11.glBegin(GL11.GL_QUADS);
    {
      GL11.glTexCoord2f(0, 0);
      GL11.glVertex2f(0, 0);
      GL11.glTexCoord2f(0, texture.getHeight());
      GL11.glVertex2f(0, height);
      GL11.glTexCoord2f(texture.getWidth(), texture.getHeight());
      GL11.glVertex2f(width,height);
      GL11.glTexCoord2f(texture.getWidth(), 0);
      GL11.glVertex2f(width,0);
    }
    GL11.glEnd();

    GL11.glPopMatrix();
} 
```

# java - struts中找不到JSP的路径

> ID：581013
> 
> 赞同：0
> 
> 时间：2009-02-24T09:04:43.273
> 
> 标签：java, struts, wcs

我正在研究使用 struts 框架的 WCS 6.0。其中一个视图（CategoryDisplayView）的条目在 struts config xml 中定义为以下全局转发

```
<forward className="com.ibm.commerce.struts.ECActionForward" name="CategoryDisplayView/10001" path="/"/> 
```

还有一个为相同定义的动作映射，如下所示

```
<action path="/CategoryDisplayView" type="com.ibm.commerce.struts.BaseAction">
<set-property property="credentialsAccepted" value="0:P,0:P,0:P,0:P,0:P,0:P,0:P,0:P,0:P,0:P,0:P,0:P,0:P"/>
<set-property property="https" value="10151:1,11301:1,11301:1,13652:1,11351:1,11301:1,12601:1,12601:1"/>
</action> 
```

问题是我找不到 JSP 的路径。wcs 在哪里获取此视图的 JSP 路径？是的，它正在找到正确的路径，但不知道从哪里来

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T12:12:23.897

```
Product and Category pages in Struts do not behave as expected. 

For example, when changing: 
<forward className="com.ibm.commerce.struts.ECActionForward" name="CategoryDisplayView/10101" path="/"/> 
<forward className="com.ibm.commerce.struts.ECActionForward" name="ProductDisplayView/10101" path="/"/> 
to: 
<forward className="com.ibm.commerce.struts.ECActionForward" name="CategoryDisplayView/10101" path="SubCategoriesDisplayDef"/> 
<forward className="com.ibm.commerce.struts.ECActionForward" name="ProductDisplayView/10101" path="ProductDisplayDef"/> 
There are no resulting changes. The pages continue to render as they did before any configuration changes were made. 
Cause 
The above behaviour happens since WebSphere Commerce uses the DISPCGPREL and DISPENTREL tables to determine the jsp which will render the final view 
```

从技术说明 **[http://publib.boulder.ibm.com/infocenter/wchelp/v6r0m0/index.jsp?topic=/com.ibm.commerce.esupport.doc/html/Customization___Application_Development/swg21328797.html](http://publib.boulder.ibm.com/infocenter/wchelp/v6r0m0/index.jsp?topic=/com.ibm.commerce.esupport.doc/html/Customization___Application_Development/swg21328797.html)**

# html - CSS - 固定流体列

> ID：581024
> 
> 赞同：9
> 
> 时间：2009-02-24T09:07:50.503
> 
> 标签：html, css

在我的网站正文中，我正在尝试创建两列 - 最右侧的一列具有固定宽度（300 像素）用于广告等，另一列位于左侧，它将占用页面上的剩余空间。这如何在 CSS 中实现？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-01T15:36:16.807

CSS：

```
.column-right {
    float: left;
    width: 100%;
    height: 200px;
    background-color: red;
}

.column-right .column-content {
    margin-left: 250px;
}

.column-left {
    float: left;
    margin-left: -100%;
    width: 250px;
    height: 200px;
    background-color: green;
} 
```

HTML：

```
<div class="column-right">
    <div class="column-content">
        <strong>Right Column:</strong><em>Liquid</em>
    </div>
</div>
<div class="column-left">
    <strong>Left Column:</strong><em>250px</em>
</div> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-12-19T15:50:46.423

这是一个[生成固定液柱](http://www.pagecolumn.com/liquidfixed/2_col_fix_liquid.htm)的工具，用于放置 AdSense 广告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T09:12:58.760

CSS：

```
#right-column{
 width:300px;
 float:right;
}

#other-column{
 float:left;
 width:100%;
 padding-right:20px; /*to prevent text overlap as suggested in the comment*/
} 
```

在 HTML 中：

```
<div id='right-column'>
 <!-- ads here -->
</div>
<div id='other-column'>
 <!-- content here -->
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T18:29:48.277

您可能还想查看[YUI：CSS Grid Builder](http://developer.yahoo.com/yui/grids/builder/)。这是一个简单的 Web 界面，您可以在其中指定要查找的网格布局，它们会为您提供 html 代码，您可以将其与[YUI Grids CSS 框架](http://developer.yahoo.com/yui/grids/)结合使用以获得所需的布局。YUI Grids CSS 框架的一个优点是它具有[良好的跨浏览器支持](http://developer.yahoo.com/yui/articles/gbs/index.html#history)，可以节省您让它在不同浏览器上工作的时间。您还可以对网格生成器提供的代码进行逆向工程，以获取有关如何自行完成的一些想法。您将要与 YUI 一起使用的设置：CSS Grid Builder 以获得所需的布局如下：

1.  车身尺寸：100%
2.  正文栏：侧边栏右侧 300px

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-18T04:28:18.013

我为此找到的一种解决方案是将右列浮动到右侧，并为左列提供一个绝对位置，其中 left:0 和 right:300px。这将使它变得流畅，就好像你给了它一个宽度：80%，但它会以不同的方式相对于父容器。

这是一个例子：http: [//jsfiddle.net/tkane2000/dp9GZ/](http://jsfiddle.net/tkane2000/dp9GZ/)

您可能会发现一个问题是，由于它是绝对的，它不会自然地向下推它下面的元素。

另一种可能的解决方案是给左列宽度：100% padding-right: 300px;

和右（固定宽度）列：位置：绝对：顶部：0；对：0；

您可能需要在左列设置 box-sizing:border-box。

这也作为一些限制。想到的一个问题是，如果您希望左栏有一个右边框来分隔每个栏，则边框将位于右栏的错误一侧。

# javascript - Javascript/jQuery 中类似 MVC 的 UI 更新：最佳实践？

> ID：581033
> 
> 赞同：1
> 
> 时间：2009-02-24T09:12:44.517
> 
> 标签：javascript, jquery, model-view-controller

我遇到了一个尴尬的问题。我有一个网页，上面有很多按钮，需要在各个点禁用和启用。现在，如果这是一个 Swing（或任何其他桌面 UI 界面），那将非常简单：我只需为我感兴趣的模型更改添加侦听器并相应地更新 UI。

这真的是基本的 MVC 东西。

问题是，我对如何在 Javascript 中很好地处理这个问题有点茫然。我正在走一条最终会得到一些真正的意大利面条代码的路线，其中按钮的单击侦听器正在更新 UI 控件，而这不会很好地结束。

**编辑：**让我给你一个更具体的例子。

**例子**

想象一个列出未结订单的屏幕。这些订单显示在表格中，因为每一行（订单）都有多个属性，例如当前管理订单的人员、下订单的人员、订单的用途、下订单的时间和订单的状态。

我已经完成了，因此您可以通过单击行来选择这些订单中的一个（或多个）。这添加了一个“选定”类，它改变了样式，很像一个列表。

至于行为，如果用户选择一个订单，则某些操作变为可用，例如打开订单（查看详细信息）、拥有所有权、取消等。订单的属性也可能影响可用的操作，例如，如果订单已经被其他人“拥有”，则某些操作将被禁用。

如果您选择了多个订单，则其中一些选项（例如打开订单）不可用。

此外，通过后台 Ajax 调用，列表会定期刷新新订单。用户还可以单击刷新或过滤订单（按名称、日期范围等），然后重新加载订单。当订单重新加载时，某些按钮会被禁用。

我打算做第二个例子，但我认为这个例子足够复杂来说明这种问题。现在我通过提供各种控件类开始了这一点。For example, elements with the "select" class might be disabled/enabled/styled when an item is selected.

现在这在简单的情况下工作得相当好，但我遇到了控件状态取决于多个条件的问题。此外，这些类也因某些元素想要样式化、某些控件想要被禁用/启用以及在某些情况下两者都需要发生之类的事情而分裂。

在 Swing 中，我倾向于通过一种 updateUI() 方法来处理这类事情，只要相关控件或模型的状态发生更改，就会调用该方法。然后它将显式设置所有控件的状态。现在这可以说不是最有效的方式（例如，如果您有 30 个控件并且只需要更新其中一个，这有点浪费），但我发现这种简单性是值得的。另一种选择是控件/模型最终获得了太多关于它们所依赖的控件或依赖于它们的控件的信息。从耦合的角度来看，它变得很混乱。

但是我在 Javascript 中没有这种（明显的）机制。jQuery 提倡的不显眼的 Javascript 非常棒，因为它可以阻止随机代码片段在您的代码中乱扔垃圾。但我需要更进一步，有一些方法可以管理它的复杂性（因为它是一个相当复杂的屏幕，只会变得更复杂）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T13:00:01.350

如果您想保持理智，请使用状态机。

您并没有真正提供有关您的 UI 功能的详细信息，因此我将举一个示例。假设您有一个文件上传页面。用户应该能够选择一个文件，单击一个上传按钮，然后在上传完成后返回到他们来自的页面。所以你可以有三种状态，“SelectFile”、“Uploading”、“Finished”。在“SelectFile”状态下，应启用控件以允许用户选择文件。在“上传”状态下，这些控件应该被禁用，并且用户应该看到一个进度指示器。在“完成”状态下，用户应该被重定向。

当然，听起来你的情况更复杂，但同样的想法也适用。如果用户界面的某些部分进行交互，您可能需要多个状态机。没关系。

当您想要更改用户界面上启用/禁用的元素时，您只需更改状态机的状态。状态机本身告诉各种用户界面控件根据当前状态更新自己。您可以使用 Bharani 的（好的，赞成的）建议使用类来执行此操作。或者任何适合你的机制。

好消息是控件不再相互交互。它们只与状态机交互。因此，您摆脱了所有状态错误反弹或无休止递归的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T09:55:46.333

为 div 分配特定的类名。这样，即使它们在功能上重叠，您也可以简单地继续向 div 添加类名，并且由于 jquery 的链性质，所有注册的事件处理程序都将被执行。

为了在 ajax 调用期间控制表单元素 - 您可以添加 ajaxStart 和 ajaxEnd 或者您可以使用 ajaxComplete 并在回调中处理所有代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T07:04:25.580

我想我明白了你的问题。我以前在这样的屏幕上工作过，我总是最终重构以更好地构建代码。但有时，如果您可以重新组织功能本身，这样您就不必在一个地方处理所有事情，这会更容易。我认为 GUI 也应该被视为一种功能——做好一件事，做好一件事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T20:03:46.077

我认为数据建模对于 JavaScript 应用程序很重要。我正在为医疗诊所做这个调度项目，我有一个 JSON 数据结构，可以为办公室的椅子/病人建模。当模型中的业务逻辑发生变化时，Ember 会自动更新视图（UI 小部件）。所以马上就消除了很多 sphagetti 代码。如果你正在做一些图形密集的用户交互，那么不使用现有的 MVC 模式或创建你自己的 MVC JS 类几乎是一种犯罪。结构化的纪律起初并不受欢迎，但当您稍后看到它如何降低血压并使维护变得更加愉快时，这是值得的。如果它们很小，我不会将它用于简单的一次性项目。它更适合中等复杂性或高级复杂性。任何需要我超过一周的时间我都会使用 Ember。我用过 knockout.js 和 Angular，我真的很喜欢 Ember 的 Handlebars 模板语法。眼睛容易，效率高。

# python - Python网络编程

> ID：581038
> 
> 赞同：12
> 
> 时间：2009-02-24T09:15:24.853
> 
> 标签：python, cherrypy

早上好。

正如标题所示，我有一些关于使用 python 进行 Web 开发的问题。

*   什么是开发环境的最佳设置，更具体地说，使用什么网络服务器，如何将 python 与它绑定。最好，我希望它在 *nix 和 win 环境中都可以实现。

当我上次尝试 apache + mod_python + CherryPy 时，我主要担心的是必须重新加载网络服务器才能看到更改。算不算正常？由于某种原因，cherrypy 的自动重载根本不起作用。

*   将工作的 Python 应用程序部署到生产环境的最佳设置是什么？为什么？我现在将 lighttpd 用于我的 PHP Web 应用程序，但是与 nginx 相比，它对 python 的作用如何？

*   是否值得直接使用框架或自己推出一些简单的东西？我看到 Django 有很多粉丝，但我认为这对我的需求来说太过分了，所以我开始研究 CherryPy。

*   如果我必须重新加载 httpd 才能看到更改，那么 Python 应用程序究竟如何提供服务？类似于生成子进程的永久进程，所有主要文件都包括在服务器启动时发生，然后只是延迟加载所需的资源？

*   Python 支持多线程，在开发 Web 应用程序时是否需要考虑使用它以获得好处？那会有什么好处，在什么情况下？

非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T11:05:43.043

**开发环境的最佳设置是什么？**

没关系。我们使用 Django，它可以很好地在 Windows 和 Unix 中运行。对于生产，我们在 Red Hat 中使用 Apache。

**是否必须重新加载网络服务器才能看到被认为正常的更改？**

是的。不清楚为什么你想要不同的东西。Web 应用软件不应该是动态的。内容是的。软件编号

在 Django 中，我们在桌面上不使用任何类型的 Web 服务器进行*开发。*在大多数情况下，Django“runserver”命令会重新加载应用程序。对于开发，这很有效。它不会重新加载的时候是我们已经严重损坏了东西以至于应用程序无法正常运行。

**将工作的 Python 应用程序部署到生产环境的最佳设置是什么？为什么？**

在这种情况下，“最佳”是未定义的。因此，请为“巢”提供一些限定条件（例如，“最快”、“最便宜”、“最蓝”）

**是否值得直接使用框架或自己推出一些简单的东西？**

不要浪费时间自己动手。我们使用 Django 是因为我们不需要编写或维护内置的管理页面。节省大量工作。

**如果我必须重新加载 httpd 才能看到更改，那么 Python 应用程序究竟如何提供服务？**

两种方法：

*   守护进程 - mod_wsgi 或 mod_fastcgi 有一个 Python 守护进程与之相连。改变你的软件。重新启动守护程序。

*   Embedded - mod_wsgi 或 mod_python 具有嵌入式模式，其中 Python 解释器位于 mod 内部，位于 Apache 内部。您必须重新启动 httpd 才能重新启动该嵌入式解释器。

**我需要考虑使用多线程吗？**

是和不是。是的，您确实需要意识到这一点。不，你不需要做太多事情。Apache 和 mod_wsgi 和 Django 应该为您处理这个问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T09:26:54.980

所以这是我的想法：

我正在使用[Python Paste](http://pythonpaste.org/)来开发我的应用程序并最终运行它（或任何其他 Python Web 服务器）。我通常不使用 mod_python 或 mod_wsgi，因为它使开发设置更加复杂。

我正在使用[zc.buildout与](http://pypi.python.org/pypi/zc.buildout)[virtualenv](http://pypi.python.org/pypi/virtualenv)一起管理我的开发环境和所有依赖项。这给了我一个独立的沙箱，它不会干扰系统范围内安装的任何 Python 模块。

对于部署，我也使用 buildout/virtualenv，最终使用不同的 buildout.cfg。我也在使用[Paste Deploy](http://pythonpaste.org/deploy/)，它是一种配置机制，我有不同的配置文件用于开发和部署。

因为我通常独立运行 paste/cherrypy 等，所以我正在使用 Apache、NGINX 或者可能只是在它前面单独使用 Varnish。这取决于您需要哪些配置选项。例如，如果不需要虚拟主机、重写规则等，那么我不需要前面有一个功能齐全的 Web 服务器。使用 Web 服务器时，我通常使用 ProxyPass 或使用 mod_rewrite 进行一些更复杂的重写。

顺便说一句，我现在使用的 Python Web 框架是[repoze.bfg](http://static.repoze.org/bfgdocs/)。

至于您关于重新加载的问题，我知道在使用 mod_python 运行它时会遇到这些问题，但是当使用独立的“paster serve ... -reload”等时，它到目前为止工作得非常好。repoze.bfg 还具有一些设置，用于在模板更改时自动重新加载模板。如果您使用的框架具有，则应记录在案。

至于通常在 python web 服务器内部使用的多线程。由于 CherryPy 支持这一点，我想你不必担心，它应该自动使用。您最终应该进行一些基准测试，以了解您的应用程序在多少线程下执行得最好。

希望有帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-24T09:54:17.473

对 MrTopf 的回答 +1，但我会添加一些额外的意见。

**网络服务器**

Apache 是可以为您提供最大可配置性的网络服务器。避免使用 mod_python，因为它基本上不受支持。另一方面，[mod_wsgi](http://code.google.com/p/modwsgi/)得到了很好的支持，并为您提供了更好的稳定性（换句话说，与尖峰和不可预测相比，更容易配置 cpu/内存使用以保持稳定）。

另一个巨大的好处，你可以配置 mod_wsgi 来重新加载你的应用程序，如果 wsgi 应用程序脚本被触及，不需要重新启动 Apache。对于开发/测试服务器，您甚至可以配置 mod_wsgi 以在应用程序中的任何文件更改时重新加载。这非常有用，我什至在开发期间在我的笔记本电脑上运行 Apache+mod_wsgi。

Nginx 和 lighttpd 通常用于 web 服务器，或者通过 fastCGI 接口直接为 Python 应用程序提供服务（暂时不要在这些服务器上使用任何 WSGI 接口），或者将它们用作 Apache 前面的前端。对应用程序的调用通过（通过代理）传递到 Apache+mod_wsgi，然后 nginx/lighttpd 直接提供静态内容。

Nginx 具有额外的优势，如果您想要更复杂，可以直接从 memcached 提供内容。我听说过对 lighttpd 的贬低评论，它似乎确实存在一些开发问题，但肯定有一些大公司成功地使用了它。

**Python 堆栈**

在最低级别，您可以直接对 WSGI 进行编程以获得最佳性能。有很多有用的 WSGI 模块可以在您不想自己开发的领域为您提供帮助。在这个级别，您可能希望选择第三方 WSGI 组件来执行 URL 解析和 HTTP 请求/响应处理等操作。一个很好的请求/响应组件是[WebOb](http://pythonpaste.org/webob/)。

如果您查看[Pylons](http://pylonshq.com/)，您会看到他们关于“同类最佳”WSGI 组件的想法以及一个比 Django 更容易选择您自己的组件（如模板引擎）的框架。

Django 可能有点矫枉过正，但我​​不认为这是一个很好的反对理由。Django 让简单的事情变得更容易。当您开始进入非常复杂的应用程序时，您确实需要考虑迁移到较低级别的框架。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T17:30:04.697

看看谷歌应用引擎。从他们的网站：

> Google App Engine 可让您在 Google 的基础架构上运行您的网络应用程序。App Engine 应用程序易于构建、易于维护，并且随着您的流量和数据存储需求的增长而易于扩展。使用 App Engine，无需维护服务器：您只需上传应用程序，即可为用户提供服务。
> 
> 您可以使用appspot.com 域上的免费域名来提供您的应用程序，或者使用Google Apps 从您自己的域中提供它。您可以与全世界共享您的应用程序，或限制对您组织成员的访问。
> 
> App Engine 无需任何费用即可开始使用。注册一个免费帐户，您就可以开发和发布您的应用程序，让全世界都可以看到，而无需任何费用和义务。免费帐户最多可使用 500MB 的持久存储空间以及足够的 CPU 和带宽，每月可浏览约 500 万次页面。

最好的部分：它包括 Python 支持，包括 Django。转到[http://code.google.com/appengine/docs/whatisgoogleappengine.html](http://code.google.com/appengine/docs/whatisgoogleappengine.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T16:33:18.327

当您`mod_python`在线程化的 Apache 服务器（Windows 上的默认设置）上使用时，CherryPy 运行在与 Apache 相同的进程中。在这种情况下，您几乎肯定**不**希望 CP 重新启动该过程。

解决方法：使用`mod_rewrite`or`mod_proxy`让CherryPy在自己的进程中运行。然后你可以自动重新加载到你心中的内容。:)

# html - 如何使用 CSS 将图像定位在最右侧？

> ID：581039
> 
> 赞同：1
> 
> 时间：2009-02-24T09:15:52.247
> 
> 标签：html, css, xhtml

我有以下代码：我想要的是使用 css 将“MYIMAGE”放在最右侧。 [替代文字 http://igurr.com/resized-image.ashx/__size/500x400/__key/CommunityServer.Components.PostAttachments/00.00.00.01.73/OneContact.JPG](http://igurr.com/resized-image.ashx/__size/500x400/__key/CommunityServer.Components.PostAttachments/00.00.00.01.73/OneContact.JPG)

```
<div style="cursor: pointer;" onclick="javascript:SelectContact('17');" onmouseover="javascript:this.className='onfocus';" onmouseout="javascript:this.className='tempClass';" id="contact_17" class="tempClass">
                <input type="checkbox" class="contactChk contactItem" id="chk_17" name="chkContact" onclick="javascript:alert('clicked');"/>
                <img height="25" width="25" class="contactItem" src="Images/Contacts/NoImage.gif" alt=""/>
                <span class="contactName" id="contactName_17">
                    Amr ElGarhy
                </span>
                <img id="MYIMAGE" src="Images/Common/Motiva.png" alt="" class="contactItem"/>
                <br/>
            </div> 
```

CSS：

```
.contactChk {
margin-left:10px;
}
.contactItem {
display:inline;
vertical-align:middle;
}

.contactName {
display:inline;
vertical-align:middle;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T09:19:41.537

尝试：

```
img#MYIMAGE {
  float: right;
} 
```

不确定这是否可行-这取决于`div#contact_17`样式的样式，这从您的问题中不清楚。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T09:59:02.987

另一种方法是使用绝对定位。

如果 #contact_17 是 position:relative，您可以将 #MYIMAGE 设置为 position:absolute 并将其 'right' 属性设置为 0（或者离您想要的右边缘有多远）。但是，绝对定位将忽略 div 中的任何其他内容，因此如果您这样做，请确保将其余内容设置为不重叠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T09:20:00.130

只是浮动它正确

```
#MYIMAGE{
 float:right;
} 
```

固定图像的宽度也是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T09:20:07.540

尝试`float:right;`

# sql - SQL 查询抛出“不在聚合函数或 group by 子句中”异常

> ID：581043
> 
> 赞同：1
> 
> 时间：2009-02-24T09:17:14.723
> 
> 标签：sql, hibernate, hsqldb, dbunit

我正在为我们的一个项目修复测试套件，该项目正在通过 Hibernate/DBUnit 进行测试。有几个测试用例都从 Hibernate 抛出了类似的异常，看起来像这样：

*java.sql.SQLException：不在聚合函数或 group by 子句中：语句中的 org.hsqldb.Expression@109062e [... blah ...]*

通过我的谷歌搜索，我怀疑这是由于我们使用了聚合函数 AVG() 引起的，因为它在异常的消息中，并且所有抛出的查询都包含它。但是，我发现了几个指向遇到此错误的人的链接，并且能够通过注释掉“ORDER BY”或“GROUP BY”子句或将 SELECT 子句中的其他列包含在分组中来修复它。我理解为什么这会修复这样的错误消息，但我不确定它是否适用于我的情况，因为我尝试做同样的事情并且没有任何区别。此外，我们有一些测试用例会抛出使用 ORDER/GROUP 的异常，但不是全部。例如：

```
ThingerVO myThinger = (ThingerVO)session.createQuery("SELECT new ThingerVO(" +
"r.id, " + "u.id, " + "u.alias, " + "s.id, " +
"s.name, " + "r.URL," + "AVG(v.rating), " +
"r.totalCount, " + "r.isPrivate, " + "a.id, " +
"a.name, " + "r.transactionId, " + "r.size, " +
"u.hasPicture " +
") FROM Thinger r LEFT OUTER JOIN r.votes as v, Table1S s " +
"JOIN s.Table2A AS a, User u " +
"WHERE r.userId = u.id AND " +
"s.id = r.Table1SId AND " +
"r.id = :thingId")    
.setInteger("thingId", thingId)
.uniqueResult(); 
```

此查询也会引发相同的异常，即使它不使用 ORDER/GROUP 子句。此外，我将 Hibernate 生成的 HSQL 代码直接剪切/粘贴到 MySQL 查询浏览器中，它运行没有问题。此外，值得指出的是，所有这些代码在我们的生产数据库上都可以正常工作，所以我真的很困惑它为什么会在这里抛出。

其他一些可能有用的信息——我们正在使用一个平面 XML 数据库结构，其中包含一些用于测试用例的虚拟测试数据，以及用于休眠的 MySQL 方言。我们正在使用 dbunit 2.4.3/hibernate 3.2.6。我尝试使用最新的休眠版本 3.3.1，但它的行为相同。

任何指针或提示将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T10:47:39.327

如果您`AVG()`在 SQL 查询的 SELECT 部分中使用聚合函数（例如 ）以及其他非聚合表达式，那么您必须有一个 GROUP BY 子句，该子句应该列出所有非聚合表达式。

我对 java 不熟悉，但是查看代码，看起来它会创建和运行类似这样的查询（不太正确，但我认为足够接近）：

```
SELECT r.id, 
       u.id,
       u.alias,
       s.id, 
       s.name, 
       r.URL, 
       AVG(v.rating), 
       r.totalCount, 
       r.isPrivate, 
       a.id, 
       a.name, 
       r.transactionId,
       r.size, 
       u.hasPicture 
FROM Thinger r 
LEFT OUTER JOIN r.votes as v, 
                     Table1S s 
JOIN s.Table2A AS a, User u 
WHERE r.userId = u.id 
AND s.id = r.Table1SId 
AND r.id = :thingId 
```

...这没有`GROUP BY`，但在 SELECT 子句中混合了聚合和非聚合表达式。问题是 SQL 格式不正确。

解决方法是将 a 添加`GROUP BY`到查询的末尾。

我不能说为什么这在您的生产系统中有效，但我怀疑那里存在一些细微的差异。也许有些东西正在`GROUP BY`自动添加？

您可以发布它执行的 SQL 的打印输出吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-22T16:18:04.100

此外，`ORDER BY`当 order-by 字段不是字符串时，在 hsqldb 中不起作用。

不幸的是，这会导致*Not in aggregate function or group by 子句*错误消息，这表明存在分组问题，因此会造成混淆......

见： http: [//markmail.org/message/42vmifme4opz4jgl](http://markmail.org/message/42vmifme4opz4jgl)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-27T11:41:39.270

在某些系统（例如 TALEND）中，如果有注释行示例，查询将不起作用：

```
SELECT r.id,   
   u.alias,
   AVG(v.rating), 
   r.totalCount
FROM Thinger r 
LEFT OUTER JOIN r.votes as v, 
                     Table1S s 
JOIN s.Table2A AS a, User u 
WHERE r.userId = u.id 
AND s.id = r.Table1SId 
AND r.id = :thingId
--AND r.name is not null 
GROUP BY r.id, u.alias, r.totalCount 
```

为 MS SQL 查询提供错误。而不是注释行

> --

使用这些符号进行评论

> /* AND r.name 不为空 */

也许它会帮助某人并节省一些时间。

# c++ - sqlite 准备好的语句 - 如何调试

> ID：581049
> 
> 赞同：12
> 
> 时间：2009-02-24T09:19:02.550
> 
> 标签：c++, sqlite

我正在编写一些使用 sqlite3 库的 c++ 代码。我正在使用一个准备好的语句，我在运行时将一个变量绑定到该语句。

**如何检查绑定后*语句中的 SQL 查询？***

例如，下面的代码不返回一行。使用预制字符串和 sqlite3_exec 时，我得到了我期望的结果。

```
sqlite3_stmt *statement;
const char *query = "SELECT * FROM foo WHERE (name='?');";
sqlite3_prepare_v2(db, query, strlen(query), &statemtnt, NULL);
sqlite3_bind_text(statement, 1, "bar", -1, SQLITE3_STATIC);
int result = sqlite3_step(statement);
// expected: result = SQLITE_ROW
// actual: result = SQLITE_DONE 
```

编辑：正如费迪南德在下面所说，上面查询中的问题是 ? 周围的引号。但是，对于将来，我仍然想知道如何检查 sqlite3_stmt 以了解将要执行的实际查询。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T09:30:25.770

绑定后 SQL 查询不会更改——您的变量不会插入到 SQL 字符串或任何内容中。

除了 Neil 所说的，去掉 ? 周围的引号。占位符：

```
"SELECT * FROM foo WHERE name = ?" 
```

否则 SQLite 不会替换问号，而是将其视为字符串“？”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-08T00:53:46.337

是的，您可以通过定义这样的配置文件函数来做到这一点：

```
static void profile(void *context, const char *sql, sqlite3_uint64 ns) {
fprintf(stderr, "Query: %s\n", sql);
fprintf(stderr, "Execution Time: %llu ms\n", ns / 1000000);} 
```

然后在使用 sqlite3_open 打开数据库后，立即进行以下调用：

```
sqlite3_profile(fDBLink, &profile, NULL); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T09:25:18.060

sqlite3_bind_text 的第三个参数应该是您要绑定的值 - 在您的代码中，您试图将查询绑定到自身！

此外，丢失 SELECT 末尾的分号。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-24T09:38:01.163

不太了解 sqlite，但实际查询可能会被记录，或者您可以翻转开关以使其被记录。

# .net - SharePoint 开发环境设置

> ID：581050
> 
> 赞同：7
> 
> 时间：2009-02-24T09:19:07.667
> 
> 标签：.net, sharepoint, development-environment

我需要设置一个开发环境来编写 Share Point Web 部件。我到底需要什么？

我的开发机器是 Windows XP Prof. with Visual Studio 2008 Prof. If found [Windows Share Point Services 3.0: Software Development Kit (SDK)](http://www.microsoft.com/downloads/details.aspx?FamilyId=05E0DD12-8394-402B-8936-A07FE8AFAFFD) and [Windows Share Point Services 3.0: Tools Visual Studio 2008 Extensions, Version 1.2](http://www.microsoft.com/downloads/details.aspx?FamilyID=7bf65b28-06e2-4e87-9bad-086e32185e68)。但我无法在 Windows XP 上安装它，因为需要在本地安装 Share Point Services 3.0。我无法想象真的有必要在服务器操作系统上安装 Visual Studio。

有没有其他方法可以在 Windows XP 下设置干净的开发环境并使用专用的 Windows Server 来运行 Share Point Services？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T14:47:05.820

我强烈推荐使用虚拟机。SharePoint 很大。它需要多台服务器和大量服务。基本上它保证会减慢您安装它的任何工作站。使用 VM 进行开发的其他好处：

*   撤消磁盘
*   将您的开发环境从工作站转移到工作站
*   轻松备份

这是构建功能齐全的 SharePoint VM 的非常全面的指南：http://www.pptspaces.com/sharepointreporterblog/Lists/Posts/Post.aspx [? List=7537e639%2Db4e5%2D48b6%2D97c0%2Da75e44ee9be3&ID=28&Source=http% 3A%2F%2Fwww%2Epptspaces%2Ecom%2Fsharepointreporterblog%2FLists%2FPosts%2FAllPosts%2Easpx](http://www.pptspaces.com/sharepointreporterblog/Lists/Posts/Post.aspx?List=7537e639%2Db4e5%2D48b6%2D97c0%2Da75e44ee9be3&ID=28&Source=http%3A%2F%2Fwww%2Epptspaces%2Ecom%2Fsharepointreporterblog%2FLists%2FPosts%2FAllPosts%2Easpx)

不过，如果您要进行大量 SharePoint 开发，我会构建一个带有操作系统、SharePoint 和数据库的父 VM。然后使用开发工具（VS 2008、Office 2007、SharePoint Designer）创建一个子 VM（[差异磁盘](http://www.andrewconnell.com/blog/articles/UseVirtualPCsDifferencingDisksToYourAdvantage.aspx)）。这样，如果需要，您始终可以回滚到干净的 SharePoint 环境。

此外，我认为进行认真的解决方案开发的最佳方法是花时间学习如何构建自己的解决方案文件，并滚动自己的功能。 [NANT](http://nant.sourceforge.net)可以为此发挥很大的作用。现有的自动化工具有一些限制，如果你做任何有点复杂的事情，你将不可避免地遇到这些限制。

学习解决方案开发的所有活动部分有点令人生畏，但是一旦你这样做了，你就可以更好地了解 SharePoint 在幕后所做的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T09:24:08.157

您通常有两种选择：

1.  创建一个带有 Windows Server 和 Visual Studio 的物理机或虚拟机，将其用于开发。
2.  在您的工作站上使用 Vista 并[“破解”SharePoint 以在其上安装](http://community.bamboosolutions.com/media/p/193.aspx)。

[对于我的所有 SharePoint 工作，我现在将后者与STSDev](http://www.codeplex.com/stsdev)一起使用，我发现它比选项 1 好得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T09:28:46.770

[本文](http://blogs.msdn.com/martinv/archive/2008/10/29/remote-sharepoint-development-webparts-with-visual-studio-2008-and-vsewss-1-2.aspx)是否解决了您的安装问题？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T14:29:25.677

您还可以尝试在运行 Windows Server 2003 的虚拟机上安装 SharePoint。使用 Windows Vista、VMware Workstation、主机上的 4 GB 内存和快速磁盘，您将体验到不错的性能。此外，如果您要安装 MOSS 2007，我还建议您设置第二台运行 Windows Server 2003 和 Active Directory 的虚拟机。对于 WSS 3.0 安装，将 SharePoint 服务器连接到 AD 不太重要。

这是我曾经拥有的灵活且具有成本效益的设置。现在，我很幸运有一个更好的设置。我自己在托管环境中的 1U Dell PowerEdge 服务器。如今，这样的服务器非常便宜，托管它每月只需花费我公司 110 美元。现在，我可以通过远程桌面访问它并享受所有这些功能，而不必听桌子下嘈杂的服务器或接受笔记本电脑上以前的虚拟机设置的较低性能。

我强烈推荐任何认真的 SharePoint 开发人员选择后一种选择。以这种方式使用 SharePoint 就像是一个愉快的梦想；-) 让您的老板相信这是您有效工作所需要的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-25T23:10:14.120

你真的需要去虚拟化。是的，Visual Studio 在服务器上运行。这并不像听起来那么糟糕。您可以根据自己的喜好安装虚拟映像并配置所有内容，包括 Visual Studio，并拍摄服务器快照。这样您就不必重新配置所有自定义 Visual Studio 设置和工具。

您可以根据需要创建任意数量的不同虚拟映像（如果您为多个客户工作，则为每个客户创建一个），并且可以拍摄虚拟机的快照，然后在需要清理工作站时丢弃所有虚拟机。

经常删除您的开发环境（我听说过每周都这样做的团队）并返回到快照（您可以在 PowerShell 中自动执行此过程以在每个周末发生）是一个很好的做法，这样您的开发环境将像尽可能类似于您的开发测试、集成测试、预生产和生产环境！

我在这里看到了几个问题，人们无法理解某些“在我的开发平台上运行良好”的部署在推送到生产环境时不起作用。环境之间的差异是最明显的原因之一！

选择什么虚拟环境？

我使用过[Virtual PC](http://en.wikipedia.org/wiki/Windows_Virtual_PC) /Server 并且可以证明它们很*慢*。所以我强烈反对这些。

如果您想要一个*快速*的开发平台，您应该在您的 PC 上安装 Windows Server 2008，[将您的 Windows 2008 服务器转换为工作站](http://www.win2008workstation.com/)并安装 HyperV。它是微软新推出的免费虚拟化工具。您需要 Windows Server 2008（或 Windows 7 beta）的原因是操作系统本身支持虚拟化。这也是为什么它与替代品相比如此之快的原因。设置起来并不难，做一个谷歌搜索，你会发现很多关于它的指南。

另一个不错的选择是 VMware 工作站。它不如 HyperV 快，但我已经使用了很多年，它就像一个魅力。不过，并非所有版本都受 Microsoft 支持，因此如果您在某些时候致电 Microsoft 支持可能会给您带来问题。

出于上述原因，我不建议使用 Jonas “SharePoint on Windows Vista”帮助程序：虚拟化使您有可能保持开发环境干净！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-25T16:23:12.117

我相信开始为 SharePoint 开发的最简单和最快的方法是使用 Microsoft Virtual PC 并[从 Microsoft 下载 MOSS 2007 VHD](http://www.microsoft.com/downloads/details.aspx?FamilyID=67f93dcb-ada8-4db5-a47b-df17e14b2c74&displaylang=en)。它已安装并预配置了 Windows Server 2003、MOSS 2007、MS Office 2007（带有 SharePoint Designer）和 Visual Studio 2005，因此可供您使用。您还可以安装自己的 VS 2008 副本，有助于工作流开发。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-08-12T05:03:22.453

我是来自 Bamboo 的 Jonas，他创建了设置助手。这就是我这样做的原因以及我如何使用它。

我 100% 同意虚拟化是您测试解决方案时要走的路。您不能在 Windows Vista 上测试解决方案，因为我们不知道在 Windows Vista 上运行将如何影响解决方案。我会更进一步，您必须在真实的​​农场环境中测试您的解决方案。

1) 专用盒子上的 SQL Server。（双跳） 2）多个前端 Web 服务器。（状态，部署...） 3）您命名的操作系统时区的不同语言包和不同语言。4）？？？填满空隙 ？？？

但是坐下来开发在虚拟环境中调试的运行单元测试让我很生气……太慢了。您需要快速反馈。**因此，您要么在 Windows Vista 上使用 WSS/MOSS 进行开发、调试和测试，要么安装 Windows 2003 或 Windows Server 2008，除非**您有足够的硬件（我运行四核 8 GB RAM ），否则您的开发环境不会在 VM 中开发机器）。

快乐编码！

# cohesion - “连贯性”的良好定义

> ID：581058
> 
> 赞同：4
> 
> 时间：2009-02-24T09:22:33.183
> 
> 标签：cohesion

我试图告诉某人他的代码不是“连贯的”，因为它有多种用途。我认为我不能很好地解释它，所以我正在寻找一个好的参考和/或定义。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T09:28:13.013

我认为正确的术语是[凝聚力](http://en.wikipedia.org/wiki/Cohesion_(computer_science))。

> 在计算机编程中，[凝聚力](http://en.wikipedia.org/wiki/Cohesion_(computer_science))是衡量一个软件模块的各种职责之间的相关性和集中度的指标。凝聚力是一种序数类型的度量，在讨论时通常表示为“高凝聚力”或“低凝聚力”。
> 
> 具有高内聚性的模块往往更受欢迎，因为高内聚性与软件的几个理想特性相关联，包括健壮性、可靠性、可重用性和可理解性，而低内聚性与难以维护、难以测试、难以重用等不良特性相关联，甚至难以理解。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T09:44:05.783

我的电脑旁边有史蒂夫·麦康奈尔（Steve McConnell）编写的 Code Complete（即程序员圣经），打开的页面解释了凝聚力，所以我想我会分享，

> 内聚源于结构化设计，通常在与耦合相同的背景下讨论。内聚力是指一个类中的所有例程或例程中的所有代码支持一个中心目的的紧密程度——该类的集中程度。包含强相关功能的类被描述为具有强内聚力，启发式目标是使内聚力尽可能强。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T09:56:16.220

我在重构时使用术语“关注点分离”来解释这一点。通常，当代码相当新时，由于最初并不清楚单独的关注点，事情会被混为一谈。

向您的同事说明这一点的一种简单方法是要求他们为代码编写测试用例。这应该说明代码不清晰或连贯。

另一个好用的短语是函数/对象“应该做一件事，并且做得好”，这对从对象/方法名称到系统整体架构的所有内容都有影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T10:14:15.990

除了到目前为止给出的答案之外，考虑高内聚的一种简单方法是缺乏功能重复，以及将相关功能明确分离为不同的模块、组件或类。因此，如果您想要一个类似于另一个函数的函数，并且您剪切和粘贴并随后修改代码的副本，那么您正在减少内聚。如果您修改原始案例以处理新案例，其中新案例明显与现有功能相关，那么您正在增加凝聚力。换句话说，如果你的程序必须做一件给定的事情，无论多少次或在多少个地方，为了获得最大的凝聚力，应该只有一段代码可以做那件事。同时，给定的类、模块或组件应该有一个单一的职责范围。

正如 CodeWiki 所说，内聚通常与耦合一起讨论，其中两者可以相互对立，特别是在没有仔细规划严格接口的情况下。许多关于内聚的 google 文章都与 OO 设计有关，但内聚和耦合并不局限于 OO。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T09:29:05.117

以有序、合乎逻辑和美学上一致的零件关系为标志；“一个连贯的论点” - 来自[http://www.websters-online-dictionary.org/definition/coherent](http://www.websters-online-dictionary.org/definition/coherent)

# silverlight - 我可以检测到在 Silverlight 中排序的数据网格列吗？

> ID：581073
> 
> 赞同：3
> 
> 时间：2009-02-24T09:26:06.293
> 
> 标签：silverlight, sorting, datagrid

我需要能够从数万个可能的结果中将结果页面加载到网格中。我想从服务器获取 50 页的数据，使用 SQL Server 在返回数据以绑定到数据网格之前对数据进行排序。当用户通过单击列标题对数据网格中的 dta 进行排序时，我需要检测到这一点并确定新的顺序，然后再返回数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T07:59:44.777

我不认为有办法询问数据网格在哪一列上排序。但是查看[http://blogs.msdn.com/scmorris/archive/2008/06/10/sorting-data-in-the-silverlight-datagrid.aspx](http://blogs.msdn.com/scmorris/archive/2008/06/10/sorting-data-in-the-silverlight-datagrid.aspx)我发现您可以在实现 ICollectionView 时实现自己的排序你的物品。

所以你也许可以在你的结果上实现ICollectionView（一个包装器）？

如果你将它的 ItemSource 设置为 IList，Datagrid 会在内部执行此操作，所以也许你可以看看它的实现，看看他们是如何做到的？（参见 Datagrids 内部类 ListCollectionView 使用反射器）

当你有一个 ICollectionView 时，你可以使用它的 SortDescriptions 来找出当前的排序。

我希望这可以帮助您朝着正确的方向前进？

吉普克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-25T15:24:49.337

您可以使用[PagedCollectionView](http://msdn.microsoft.com/en-us/library/system.windows.data.pagedcollectionview(v=vs.95).aspx)并将[SortDescriptions](http://msdn.microsoft.com/en-us/library/system.windows.data.pagedcollectionview.sortdescriptions(v=vs.95).aspx)属性转换为`INotifyCollectionChanged`. 然后，您收听该`CollectionChanged`事件。像这样：

```
var collectionView = new PagedCollectionView(items);
(collectionView.SortDescriptions as INotifyCollectionChanged).CollectionChanged += (object sender, NotifyCollectionChangedEventArgs e) =>
{
  // This gets fired multiple times based on the previous sort and new sort
};
dataGrid.ItemsSource = collectionView; 
```

# scripting - 开始 Lua 脚本

> ID：581074
> 
> 赞同：19
> 
> 时间：2009-02-24T09:26:09.070
> 
> 标签：scripting, lua

我正处于被迫学习 Lua 的阶段，所以你对我如何做到这一点有什么建议吗？除了 PHP，我对任何其他脚本语言都没有太多经验。

那么，关于“Head start Lua”页面的一些建议？

**编辑**

作为精彩教程页面的补充，您能否建议我可以制作的任何“程序”来帮助我学习 Lua？想象一下，我想学习 C++ 中的指针，我会创建一个链接列表。我想接触 Lua 的基础知识，但同时对相当高级的东西持开放态度。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-24T09:27:23.093

首先，通过[Lua 编程](http://www.lua.org/pil/)，你应该花一两天时间来掌握 Lua 的要点。

但是我可以在你第一次通过忽略协程和元表时立即告诉你，它们非常强大，但需要一段时间才能掌握。首先学习语法、作用域（幸运的是你和 PHP 一样）和标准库。

之后回到协程和元表，阅读它们并尝试它们，到第三遍你可能会得到它。除非你有很好的 CS 背景，否则这些都是复杂的主题

**编辑：**这本书是免费的在线==网站。除了它是 Lua 上最好的教程之外，每个人都用它来学习 Lua。

**另外：**如果您的目的是魔兽世界的 Lua（可能不是但以防万一），您可以查看[本教程](http://wow.gamegate2k.com/viewwow/wowuiscriptingtutorial)

**并且：**这是 StackOverflow 上的[提示和技巧](http://www.stackprinter.com/export?question=89523&service=stackoverflow)线程，可能有助于您对 Lua 的期望有所了解

**建议的程序/练习：**

由于您最初是在使用 Lua 进行 Web 开发，因此请尝试理解和改进 PIL 中的[数据描述](http://www.lua.org/pil/10.1.html)示例。它会给你一些好的想法和对权力或 Lua 的良好感觉。

然后你可能想尝试一下[数据结构](http://www.lua.org/pil/11.html)一章，尽管 Lua 有一个复杂的数据类型，表格，该章将向你展示类似 Lua 的方法来让表格做你需要的任何事情。

最后，一旦你开始了解元表，你应该设计一个类系统（是的，使用 Lua，你决定你的类系统如何工作）。我敢肯定每个知道 Lua 的人都做过十几个类系统，让你开始学习类系统的好章节是[面向对象编程](http://www.lua.org/pil/16.html)

如果你有时间并且了解 C 或类似的东西（包括 C# 和 Java）尝试使用 Lua 扩展应用程序，但这需要一两个星期才能完成

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T12:09:26.200

看到所有这些精心制作的列表很有趣（尽管它们肯定是正确的）。早在 2002 年，我阅读了 Lua 参考手册的前 20 多页，并开始使用它。真的*就是*这么简单。Lua（和 ANSI C）是为数不多的能够同时真正融入人们脑海的语言 - 并留在那里。对于其他人，至少我需要不断地重新学习。

请注意，在 Lua 中*思考*需要时间。我想我的是6个月左右。当来自 C/C++ 时，我们倾向于以某些方式解决问题。Lua 可能会提供更好的方法（即通过使用表），但需要一段时间才能开始看到这些方法。这种向更高抽象级别的转变类似于 1980 年代的 Assembler->C 转变。许多人仍然在 C 中编写了一段时间，就好像它只是一个便携式汇编程序一样。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T10:39:52.700

[LuaForge](http://luaforge.net/ "LuaForge 主页")也有大量与 Lua 相关的项目。

如果您碰巧使用 Windows 作为您的日常平台，那么我建议您将[Lua for Windows](http://luaforge.net/projects/luaforwindows/ "Lua for Windows 项目页面")软件包作为一个不错的起点。它包括大量有用的模块，所有这些模块都与​​ Lua 解释器一起预构建和安装。

在您第一次通过[PiL](http://www.lua.org/pil/)和[参考手册](http://www.lua.org/manual/5.1/)之后，您将需要阅读目前仅提供纸质版的[Lua Programming Gems 。](http://www.lua.org/gems/)

`<plug>`[请考虑通过Lua 书籍页面](http://www.lua.org/docs.html#books)或[LuaForge](http://luaforge.net/ "LuaForge 主页")上的关联链接购买书籍以支持这些项目。`</plug>`

*编辑：*至于适合 Lua 的编程项目的想法，寻找`table`提供杠杆作用的问题。表是 Lua 的核心，因为即使是全局变量也只是表中的字段。表可以由除 之外的任何数据类型的值来索引`nil`，但如果用作数组，则具有特别有效的实现。

一个让来自类 C 背景的人感到困惑的怪癖是 Lua 中的所有事物自然是从 1 开始索引的。字符串从 1 开始索引，数组从 1 开始，等等。不要太担心，有使用 没有错`a[0]`，但由 给出的数组的长度是在`#a`假设数组以 开头的情况下定义的`a[1]`。

另一个怪癖是函数实际上没有名字。它们是一流的值，通常存储在某个具有名称的变量中。语法糖使它看起来像他们有名字，但这只是一种方便。

元表是表（和其他类型，但这是一个非常高级的主题）的一个特别 Lua 风格的特性，它是在 Lua 中做面向对象的事情的大多数方案的基础。

闭包和真正的尾调用是 Lua 的其他特性，这些特性在小型脚本语言中并不常见，它们可以真正使一些习语易于实现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T10:05:18.447

除了上述建议之外，还有值得一游的[Lua wiki 。](http://lua-users.org/wiki/)那里有大量有用的代码片段和小食谱。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T10:37:53.487

你可以安装魔兽世界并为此制作一个模组（它使用 Lua）。实际上，这可能是个坏主意。

也许尝试将 Lua 集成到 .NET 应用程序中（假设您是 C# 程序员）并用它做一些“有趣”的事情：

[在 C# 中使用 Lua](http://www.gamedev.net/reference/articles/article2275.asp)

或者只是浏览 lua.org

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T17:10:54.540

我写了一个简短[的 Lua 快速入门指南，](http://www.physle.com/lua/)供人们在我正在从事的项目中使用它。如果您熟悉其他脚本语言，它可能会让您快速上手并运行。[Lua.org](http://www.lua.org/manual/5.1/)上的文档非常好，应该涵盖您需要的大部分其他内容。Lua 是一种非常小的语言，可以很快学会。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T17:40:54.513

这是一个非常普遍的建议，但是如果您想以软件工程师的身份开始使用新的编程语言，那么开始用您的新编程语言解决[Project Euler](http://www.projecteuler.net/)中发现的问题会很有趣。我最近一直在用 Python 做这件事，发现它很鼓舞人心，并为编码带来了很多热情。

# python - 使用 wxpython 进行双缓冲

> ID：581085
> 
> 赞同：10
> 
> 时间：2009-02-24T09:29:15.490
> 
> 标签：python, user-interface, wxpython, doublebuffered

我正在使用 wxpython 开发一个多平台应用程序，在面板上绘图时，我在 Windows 上遇到了闪烁问题。我曾经在鼠标运动事件期间在缓冲区（wx.Bitmap）上绘制，而我的 OnPaint 方法仅由在线组成：

```
dc = wx.BufferedPaintDC(self, self.buffer) 
```

相当标准，但我在 Windows 上仍然有闪烁的问题，而在 Linux 上一切正常。

我**解决了我**`SetDoubleBuffered(True)`在方法中调用的问题`__init__`。

奇怪的是，即使我不再使用 BufferedPaintDC，现在一切正常。我更改了我的应用程序，以便所有绘图部分都在 OnPaint 方法中完成。我不使用缓冲区，直接在 wx.PaintDC 上完成绘图，完全没有闪烁问题。

所以我的问题是：BufferedPaintDC 完全没用吗？还是以某种方式弃用？我是“WxPython in Action”（2006 年）一书的所有者，它甚至没有提到 SetDoubleBuffered

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T17:00:58.337

SetDoubleBuffered 实际上很有可能使您的面板自动使用缓冲的 dc，文档没有提到这些类已被弃用（如果是这样的话，我宁愿认为它们会被弃用）。

关于 wxPython in Action... 2006 年是很久以前的事了... 可能当时不存在 SetDoubleBuffered 方法，或者作者想展示事情在较低级别是如何工作的。

# tfs - 如何停止来自 TFS 2008 的 401 响应

> ID：581090
> 
> 赞同：0
> 
> 时间：2009-02-24T09:30:50.307
> 
> 标签：tfs, authorization, http-status-code-401

每当 Visual Studio 向 TFS 发出 Web 请求时，Fiddler 都会显示 401 Unauthorized 错误。然后，Visual Studio 将使用适当的授权协商标头再次尝试，TFS 将使用该标头以适当的数据和 200 状态代码进行响应。

如何在第一时间发送正确的标头以停止 401？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T10:40:41.637

这就是 Windows 集成身份验证 (NTLM) 的工作方式。NTLM 是一种基于连接的身份验证机制，实际上涉及 3 次调用来建立经过身份验证的会话。

然后，TFS API 会竭尽全力确保以最有效的方式完成握手。它将使经过身份验证的连接保持打开一段时间，以尽可能避免这种握手。它还将使用内容最少的 HTTP 有效负载进行初始身份验证，然后如果您要发送的消息超过一定长度，则发送真实消息。它还做了很多其他技巧来优化与 TFS 的连接。

基本上，我会不理会它，因为它运作良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T09:45:19.587

您将看到 Web 浏览器在与网站通信时也会执行此操作。它总是会尝试在第一次调用时提供最少的细节。如果这失败了，它将揭示更多关于你的信息。

这是设计使然，并且有充分的理由。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-19T05:06:55.913

这就是它的一贯做法——请求，取回 401，然后发送授权。它是 http 身份验证协议的一部分。

# unix - 检查 shell 中的文件大小并显示文件和路径高于阈值

> ID：581094
> 
> 赞同：2
> 
> 时间：2009-02-24T09:34:16.493
> 
> 标签：unix, shell

我正在尝试检查大于给定阈值的文件。我知道“du”命令为我提供了每个文件/文件夹的输出，但是如何将它放在 shell 的一行中（使用带有 if 子句的 awk？）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T09:38:14.783

`find`带`-size`参数。前置`+`将产生所有大小相等或更大的文件。例如在当前目录中查找至少 10MB 的所有文件：

```
find . -size +10M 
```

# c++ - 我可以使用块来管理 C++ 中的内存消耗吗？

> ID：581097
> 
> 赞同：5
> 
> 时间：2009-02-24T09:35:17.660
> 
> 标签：c++, object, scoping

我试图在 C++ 程序中节省一些内存，我想知道是否可以使用块作为变量的范围（如在 Perl 中）。假设我有一个**巨大**的对象，它执行一些计算并给出结果，这样做是否有意义：

```
InputType  input;
ResultType result;

{
    // Block of code
    MyHugeObject mho;
    result = mho.superHeavyProcessing();
}

/*
   My other code ...
*/ 
```

我可以期望对象在退出块时被销毁吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-24T09:36:13.353

是的你可以。

一旦变量**超出范围**，析构函数就会被调用，它应该释放堆分配的内存。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-02-24T09:41:13.887

绝对是的，除了节省内存之外，在范围退出时调用析构函数通常用于您希望析构函数在调用析构函数时实际执行某些操作（请参阅 RAII）。例如，创建一个基于范围的锁并以异常安全的方式轻松释放它，或者确定性地放弃对共享或宝贵资源（如文件句柄/数据库连接）的访问。

-瑞克

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T10:49:17.967

请记住，您使用在析构函数中释放的 new/malloc 在堆上分配的任何内存可能不会被释放回操作系统。您的进程可能会保留它，并且操作系统在进程终止之前不会将其取回。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T16:32:32.040

是的。它将在右花括号处被销毁。但要注意在堆栈上分配非常大的对象。这会导致堆栈溢出。如果您的对象还分配大量内存，请确保它是用 new、malloc 或类似方法分配的堆。

# actionscript-3 - 检测特定字符串当前是否在 TextField() 上可见

> ID：581107
> 
> 赞同：1
> 
> 时间：2009-02-24T09:40:06.977
> 
> 标签：actionscript-3, flex3

我有一个 TextField() 的文本很长，有时最后几行在屏幕上不可见（不滚动）。

现在我想检测例如 IBM 一词当前是否在屏幕上可见，或者它是否在屏幕之外。任何想法如何做到这一点？我想通过将 textField() 滚动到正确的位置来显示这个特定的词 IBM。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T09:46:31.753

检查文档[`getLineIndexOfChar()`](http://livedocs.adobe.com/flex/2/langref/flash/text/TextField.html#getLineIndexOfChar%28%29)以确定包含给定字符的行，然后将检索到的值与[`scrollV`](http://livedocs.adobe.com/flex/2/langref/flash/text/TextField.html#scrollV)并[`bottomScrollV`](http://livedocs.adobe.com/flex/2/langref/flash/text/TextField.html#bottomScrollV)确定给定行是否可见。

# sql-server-ce - 使用 MS Sync Framework 同步两个 SQL CE Db

> ID：581110
> 
> 赞同：7
> 
> 时间：2009-02-24T09:41:54.320
> 
> 标签：sql-server-ce, microsoft-sync-framework

我只是在研究 Microsoft Sync Framework。使用 SqlSyncAdapterBuilder 和 SqlServerChangeTracking 将本地 SQL CE 3.5 数据库与远程 SQL Server 2008 同步看起来很容易。

不幸的是，同步两个 SQL CE 3.5 数据库看起来并不容易......
文档非常稀少，我真的不知道如何从这里开始。

我的具体情况如下所示：

*   我有一个中央 SQL Server 2008。
*   多个客户端连接到此服务器（其中一些仅部分连接）。
*   那些（部分连接的）客户端正在使用在同一个数据库上工作的多个应用程序（可能同时运行）。

将客户端与中央服务器同步应该没有问题。在离线客户端上同步多个应用程序是我考虑使用多个 SQL CE 数据库（一个作为服务器，一个用于每个应用程序实例）的地方。在将客户端与服务器同步以及在客户端上同步多个应用程序时，我真的很高兴能够使用相同的冲突解决机制。在每个客户端上安装 SQL Server 2008 Express 是不行的。

有没有人有同步两个 SQL CE 数据库的经验？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-31T20:56:34.760

[Sync Framework 2.0](http://msdn.microsoft.com/en-us/library/bb902854(SQL.105).aspx)允许在 SQL Server Compact Edition 数据库之间进行同步。

> SqlCeSyncProvider 用于同步 SQL Server Compact 数据库。
> 
> 此提供程序可用于与中央服务器同步，但也具有与其他客户端同步的能力，这是 SqlCeClientSyncProvider 无法实现的。这种能力使开发人员能够针对新的场景，例如协作场景，在这种场景中，团队需要在没有与中央服务器的连接的情况下相互同步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:32:17.773

所有 ado.net 同步都需要客户端提供程序和服务器提供程序。

遗憾的是，当前版本的框架没有开箱即用的SqlCe **Server SyncProvider。**这意味着您必须继承 DBServerSyncProvider 并包装一个 SqlCe**客户端**SyncProvider。

有关如何使用 sql express 执行此操作的示例，请参阅[本文。](http://code.msdn.microsoft.com/Release/ProjectReleases.aspx?ProjectName=sync&ReleaseId=1200)

这是相同的概念，只是您将包装 SqlCeClientProvider。好消息是包装可能更容易。

祝你好运！

# websphere - Websphere 类加载器委托模式

> ID：581118
> 
> 赞同：7
> 
> 时间：2009-02-24T09:44:34.113
> 
> 标签：websphere, classloader

我们正在使用 WebSphere 6.1 应用程序服务器和默认的类加载器委托模式，即**PARENT-FIRST**。我们考虑将其更改为**PARENT-LAST**以便能够选择我们的 jsf 实现或我们的 web 服务堆栈。

由于 PARENT-FIRST 是默认设置，我想知道有多少人切换到 PARENT-LAST，切换的原因是什么，以及切换后你的生活是否变得更好:)

我们在生产中有很多应用程序，所以我不能只是切换到看看会发生什么，如果我们这样做，我们将进行大量测试，所以如果您切换到 PARENT-LAST，我希望得到一些反馈。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T20:19:41.277

在我分配到的项目中，我们实际上为大多数应用程序切换到 PARENT-LAST。其原因通常是特定于应用程序的某些东西的实现，或者需要 Websphere 也使用的特定于应用程序的属性包（例如，覆盖公共日志记录的 Websphere 设置）。

如果在切换后出现问题，通常是因为突然开始使用的应用程序设置有些错误（而在切换之前它被 Websphere 的资源覆盖）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-13T13:51:56.030

Portlet 应用程序（部署在 WebSphere Portal Server 上）总是最后将它们的配置切换到父级。根据我的经验，最好最后切换到父级，特别是如果您使用公共日志记录。这是因为 WebSphere 在其自己的类加载器中包含了一大堆东西，这些加载器通常与您想要使用的版本/配置不同。

如果您正在这样做，我建议您编写应用程序的部署脚本，因为它可能是您进行部署时遗漏的事情之一。

# c# - C# 的对象缓存

> ID：581119
> 
> 赞同：22
> 
> 时间：2009-02-24T09:44:39.290
> 
> 标签：c#, .net, caching

我正在为某些文档格式做一个文档查看器。为了更容易，假设这是一个 PDF 查看器，一个**桌面应用程序**。对软件的一项要求是渲染速度。所以，现在，当用户滚动浏览文档时，我正在为下一页缓存图像。

这行得通，UI 响应速度非常快，看起来应用程序几乎可以立即呈现页面......但代价是：内存使用量有时会达到 600MB。我把它全部缓存在内存中。

现在，我可以缓存到磁盘，我知道，但是一直这样做会明显变慢。我想做的是实现一些缓存（LRU？），其中一些缓存页面（图像对象）在内存上，其中大部分在磁盘上。

在我开始之前，框架中是否有一些东西可以为我做这件事？这似乎是一个相当普遍的问题。（这是一个桌面应用程序，不是 ASP.NET）

或者，您对这个问题有其他想法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-26T06:04:26.870

我写了一个 LRU Cache 和一些测试用例，请随意使用。

您可以阅读[我博客](http://samsaffron.com/archive/2009/08/21/Behaviour+driven+design+using+rspec+IronRuby+and+C)上的源代码。

对于懒惰的人（这里减去测试用例）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace LRUCache {
    public class IndexedLinkedList<T> {

        LinkedList<T> data = new LinkedList<T>();
        Dictionary<T, LinkedListNode<T>> index = new Dictionary<T, LinkedListNode<T>>();

        public void Add(T value) {
            index[value] = data.AddLast(value);
        }

        public void RemoveFirst() {
            index.Remove(data.First.Value);
            data.RemoveFirst();
        }

        public void Remove(T value) {
            LinkedListNode<T> node;
            if (index.TryGetValue(value, out node)) {
                data.Remove(node);
                index.Remove(value);
            }
        }

        public int Count {
            get {
                return data.Count;
            }
        }

        public void Clear() {
            data.Clear();
            index.Clear();
        }

        public T First {
            get {
                return data.First.Value;
            }
        }
    }
} 
```

LRUCache

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace LRUCache {
    public class LRUCache<TKey, TValue> : IDictionary<TKey, TValue> {

        object sync = new object();
        Dictionary<TKey, TValue> data;
        IndexedLinkedList<TKey> lruList = new IndexedLinkedList<TKey>();
        ICollection<KeyValuePair<TKey, TValue>> dataAsCollection;
        int capacity;

        public LRUCache(int capacity) {

            if (capacity <= 0) {
                throw new ArgumentException("capacity should always be bigger than 0");
            }

            data = new Dictionary<TKey, TValue>(capacity);
            dataAsCollection = data;
            this.capacity = capacity;
        }

        public void Add(TKey key, TValue value) {
            if (!ContainsKey(key)) {
                this[key] = value;
            } else {
                throw new ArgumentException("An attempt was made to insert a duplicate key in the cache.");
            }
        }

        public bool ContainsKey(TKey key) {
            return data.ContainsKey(key);
        }

        public ICollection<TKey> Keys {
            get {
                return data.Keys;
            }
        }

        public bool Remove(TKey key) {
            bool existed = data.Remove(key);
            lruList.Remove(key);
            return existed;
        }

        public bool TryGetValue(TKey key, out TValue value) {
            return data.TryGetValue(key, out value);
        }

        public ICollection<TValue> Values {
            get { return data.Values; }
        }

        public TValue this[TKey key] {
            get {
                var value = data[key];
                lruList.Remove(key);
                lruList.Add(key);
                return value;
            }
            set {
                data[key] = value;
                lruList.Remove(key);
                lruList.Add(key);

                if (data.Count > capacity) {
                    data.Remove(lruList.First);
                    lruList.RemoveFirst();
                }
            }
        }

        public void Add(KeyValuePair<TKey, TValue> item) {
            Add(item.Key, item.Value);
        }

        public void Clear() {
            data.Clear();
            lruList.Clear();
        }

        public bool Contains(KeyValuePair<TKey, TValue> item) {
            return dataAsCollection.Contains(item);
        }

        public void CopyTo(KeyValuePair<TKey, TValue>[] array, int arrayIndex) {
            dataAsCollection.CopyTo(array, arrayIndex);
        }

        public int Count {
            get { return data.Count; }
        }

        public bool IsReadOnly {
            get { return false; }
        }

        public bool Remove(KeyValuePair<TKey, TValue> item) {

            bool removed = dataAsCollection.Remove(item);
            if (removed) {
                lruList.Remove(item.Key);
            }
            return removed;
        }

        public IEnumerator<KeyValuePair<TKey, TValue>> GetEnumerator() {
            return dataAsCollection.GetEnumerator();
        }

        System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator() {
            return ((System.Collections.IEnumerable)data).GetEnumerator();
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-03-15T21:04:25.483

对于 .NET 4.0，您还可以使用`MemoryCache`from `System.Runtime.Caching`.

[http://msdn.microsoft.com/en-us/library/system.runtime.caching.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.caching.aspx)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-24T09:50:15.270

有[模式和实践企业库](http://www.codeplex.com/entlib)（更具体地说，[缓存应用程序块](http://msdn.microsoft.com/en-us/library/cc511588.aspx)），但 IMO 倾向于过度设计和过于复杂。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-24T10:03:58.543

.NET Framework 一直有能力保持对对象的[弱引用。](http://www.switchonthecode.com/tutorials/csharp-tutorial-weak-references)

基本上，弱引用是对运行时认为“不重要”的对象的引用，并且可以在任何时间点被运行的垃圾收集删除。例如，这可以用于缓存内容，但您无法控制收集的内容和不收集的内容。

另一方面，它使用起来非常简单，可能正是您所需要的。

戴夫

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-24T10:23:21.273

经典的权衡情况。将所有内容保存在内存中会很快，但会大大增加内存消耗，而从磁盘中检索会减少内存消耗，但性能不高。然而，你已经知道了这一切！

内置的[System.Web.Caching.Cache](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx)类很棒，我自己在 ASP.NET 应用程序中多次使用它，效果很好（虽然主要用于数据库记录缓存），但是，缺点是缓存只能在一台机器上运行（通常是一个单独的 Web 服务器），并且不能分布在多台机器上。

如果可以在问题上“抛出一些硬件”，并且不一定需要昂贵的硬件，只需具有大量内存的盒子，那么您总是可以使用分布式缓存解决方案。这将为您提供更多的内存来玩，同时保持（几乎）相同的性能水平。

.NET 的分布式缓存解决方案的一些选项是：

[内存缓存.NET](http://sourceforge.net/projects/memcacheddotnet/)

[索引网](http://www.sharedcache.com/cms/)

甚至是微软自己的[Velocity](http://msdn.microsoft.com/en-us/data/cc655792.aspx)项目。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-24T09:51:57.277

你是如何实现你的缓存的？

您可以使用[`Cache`from 中的类`System.Web.Caching`](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx)，即使在非 Web 应用程序中，如果/当它需要内存时，它将基于 LRU 清除项目。

在非 Web 应用程序中，您需要使用它[`HttpRuntime.Cache`](http://msdn.microsoft.com/en-us/library/system.web.httpruntime.cache.aspx)来访问`Cache`实例。

请注意，文档声明`Cache`该类不打算在 ASP.NET 之外使用，尽管它总是对我有用。（不过，我从未在任何关键任务应用程序中依赖它。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T10:09:53.660

缓存应用程序块和 ASP.NET 缓存都是选项，尽管它们使用 LRU，但发生的唯一一种磁盘利用率是通过内存分页。我认为有一些方法可以优化它，这些方法更具体到你的目标以获得更好的输出。以下是一些想法：

*   既然它是一个 ASP.NET 应用程序，为什么不生成图像，将它们写入磁盘，当浏览器请求下一页时让 IIS 提供它。这使您的 ASP.NET 工作进程保持较低水平，同时让 IIS 做它擅长的事情。
*   使用有关用户交互方式的统计信息。在 ASP.NET 缓存中实现的 LRU 通常适用于单独的图像文件 - 从它的声音来看，这种情况并没有多大用处。相反，可能是一些逻辑，例如：“如果用户在最后 Y 秒内滚动了 X 页，则一般是下一个 X*Y 图像”。用户快速滚动会生成更多页面；缓慢阅读的用户将需要更少的缓存。
*   让 IIS 从磁盘提供图像，并为您真正想要控制缓存的图像使用自定义 HTTP 处理程序。
*   让浏览器也提前请求文件，并依赖浏览器缓存。
*   一旦图像被提供给客户端，是否可以说它几乎可以从缓存中删除？这可以大大减少足迹。

不过，我当然会避免使用普通的哈希表。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-18T20:56:05.620

除了  [rsbarro](https://stackoverflow.com/users/342113/rsbarro)对使用 [MemoryCache](http://msdn.microsoft.com/en-us/library/system.runtime.caching.aspx)的[回答](https://stackoverflow.com/a/5318052/52277)之外， 我建议使用 PostSharp AOP，如中所述 

[http://www.codeproject.com/Articles/493971/Leveraging-MemoryCache-and-AOP-for-expensive-calls](http://www.codeproject.com/Articles/493971/Leveraging-MemoryCache-and-AOP-for-expensive-calls)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-11T09:18:27.910

有一个高效的开源 RAM 虚拟器，它使用 MRU 算法将最新的引用对象保存在内存中，并使用快速、轻量级的后备存储（在磁盘上）进行“分页”。

这是 Code Project 中有关它的迷你文章的链接：http: [//www.codeproject.com/Tips/827339/Virtual-Cache](http://www.codeproject.com/Tips/827339/Virtual-Cache)

希望对你有帮助。

# c# - 从 XmlElement 创建 XPathDocument

> ID：581120
> 
> 赞同：4
> 
> 时间：2009-02-24T09:44:50.803
> 
> 标签：c#, xml, xpath

我正在使用一个 Web 服务，它将一个`XmlElement`对象返回给我的 C# 程序。我想从`XmlElement`使用 Xpath 中读取信息。创建`XPathDocument`from 的最佳方法是`XmlElement`什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T09:49:40.887

如果你有一个`XmlElement`，你能不只使用`SelectNodes()`/`SelectSingleNode()`吗？

此外，所有`XmlNode`s 都是`IXPathNavigable`，允许您获得导航器。

最后，您可以使用`new XmlNodeReader(element)`, 并使用它来创建一个`XPathDocument`使用接受 的重载`XmlReader`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T09:48:17.973

您可以[直接针对 XmlElement 创建一个导航](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.createnavigator.aspx)器，并从那里将您的 xpath 与导航器的 Select* 方法一起使用，不需要 XPathDocument。

# mysql - 如何在场景中使用 INNER JOIN？

> ID：581130
> 
> 赞同：1
> 
> 时间：2009-02-24T09:47:44.590
> 
> 标签：mysql, inner-join

我有 2 张桌子：

“用户”表

```
id 用户名  
---- --------
0001 用户1          
0002 用户2          
0003 用户3          
0004 用户4     

```

“朋友”表

```
user_idfriend_id 朋友
-------- --------- ------
0001 0004 1
0002 0004 1
0005 0004 0

```

如何显示所有 user4 朋友的姓名？如果在friends表的朋友列中，1表示他们是朋友，0表示他们仍然不是朋友。

我使用 INNER JOIN，如下所示：

```
SELECT users.username
FROM `users`
INNER JOIN `friends` ON users.id = friends.friend_id
WHERE friends.user_id = 0004
  AND friend = 1; 
```

但我得到的是：

user4 和 user4 而不是 user1 和 user2

可以帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T10:13:33.670

```
SELECT u.username
FROM   Friends f, Users u
WHERE  f.user_id = u.id
       AND f.friend = 1
       AND f.friend_id = '0004' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T09:58:35.967

```
SELECT users.username
FROM `users`
INNER JOIN `friends` ON users.id = friends.user_id
WHERE friends.user_id = 0004
  AND friend = 1; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T09:52:49.100

```
select u.username
from friends f, users u
where f.friend_id='0004' and f.friend=1 and f.id=u.user_id; 
```

编辑：这与：

```
select u.username
from friends f inner join users u on f.id=u.user_id
where f.friend_id='0004' and f.friend=1; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T10:06:12.797

您确定不想将friends 表链接到user_id 而不是friend_id 上的users 表吗？然后更改 where 子句以使用friend_id 而不是user_id。格式化连接有不同的方法，但使用内部连接的方式看起来不错。

```
SELECT users.username
FROM `users` 
INNER JOIN `friends` ON users.id = friends.user_id 
WHERE friends.friend_id = 0004   
AND friend =1 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T10:15:43.710

你的意思是这样吗？

```
SELECT u.username
FROM friends AS f
INNER JOIN users AS u USING user_id
WHERE f.friend_id = 0004 AND f.friend = 1 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T10:26:27.850

```
select U.Username
from
    Users as U
    inner join Friends as F on U.Id = F.user_id and F.friend = 1
where
    F.friend_id = '0004' 
```

如果朋友表只是一个映射表，那么您不想双向映射吗？

```
select U.Username
from
    Users as U
    left outer join
    (
        select 
            F.user_id as Id
        from
            Friends as F
        where
            F.friend_id = '0004'
        and
            F.friend = 1

    ) as Mapping1 on Mapping1.Id = U.id
    left outer join
    (
        select 
            F.friend_id as Id
        from
            Friends as F
        where
            F.user_id = '0004'
        and
            F.friend = 1

    ) as Mapping2 on Mapping2.Id = U.id

where
    Mapping1.Id is not null or Mapping2.Id is not null 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-31T11:58:31.310

从用户 us 中选择用户名，其中 us.id 在（从用户中选择 f.[user_id] 加入好友 f ON u.id = f.friend_id where f.friend=1）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T09:51:10.510

```
SELECT u.username
FROM Friends f, Users u
WHERE f.friend = 1 AND 
 ((f.friend_id = @userid AND f.user_id = u.id) OR
  (f.user_id = @userid AND f.friend_id = u.id)) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-25T03:14:19.893

dmcgiv 有一个重要的点，您需要考虑朋友映射是否是双向的（即，如果 A 与 B 成为朋友，则 B 自动与 A 成为朋友）。您需要检查您感兴趣的用户是否在 Friends 表映射的任一侧。

您可以按照 dmcgiv 的方式执行此操作，或者另一种方式是在添加友谊时将两个方向的链接插入到 Friends 表中。例如，如果用户 0004 是用户 0006 的朋友，您将在 Friends 表中插入：

```
user_id | friend_id | friend
0004    | 0006      |   1
0006    | 0004      |   1 
```

顺便说一句，我不认为你真的需要朋友专栏。除非出于某种原因要跟踪“非朋友”，否则如果友谊结束，您可以从 Friends 表中删除映射。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-12T09:13:56.937

试试这个查询

```
select u.username from users u join friends f on u.id=f.user_id  and f.friend=1; 
```

# iphone - 什么是好的c编译器

> ID：581136
> 
> 赞同：5
> 
> 时间：2009-02-24T09:48:47.847
> 
> 标签：iphone, c, objective-c, windows, compiler-construction

我正在使用 windows xp 什么是好的 c 编译器？我想学习c，以便更好地理解iphone的objective-c语言。我在 php 方面有很好的背景，所以希望有些东西会有意义

ps：

在学习 c 为 Objective-c 做准备时，我应该更加关注哪些部分？

谢谢

复制：

*   [用于windows的c编译器](https://stackoverflow.com/questions/116368/c-compiler-for-windows)
*   [用于 Windows 的 C/C++ 编译器](https://stackoverflow.com/questions/397377/c-c-compiler-for-windows)
*   [您推荐哪个 C 编译器用于 Windows](https://stackoverflow.com/questions/575840/which-c-compiler-do-you-recommend-for-windows)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-24T09:50:17.373

GCC 是一个免费的、开源的、高质量的编译器。你可以用[cygwin](http://www.cygwin.com/)得到它。

Microsoft 制作了一个 C 编译器，它随 Visual Studio 一起提供，这是 Microsoft 的集成开发环境。您可以下载 Visual C++ 的[“Express”版](http://www.microsoft.com/express/vc/)来尝试一下。

此外，[英特尔](http://www.intel.com/cd/software/products/asmo-na/eng/284132.htm)制作了一个很好的编译器。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-24T09:51:53.893

iphone 使用 gcc 编译器。这适用于使用[MinGW/MSYS](http://www.mingw.org/)或其他兼容包的 Windows。

Apple 有[Objective-C 教程](http://developer.apple.com/documentation/Cocoa/ObjectiveCLanguage-date.html)，假设很少有 C 经验；我很想潜入。如果你被卡住了，那就买[K&R](http://en.wikipedia.org/wiki/The_C_Programming_Language_(book))。（不知道php有没有类型和指针，不然马上就卡住了）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-24T09:52:59.990

[Visual C++ express](http://www.microsoft.com/express/vc/)是免费的，有一个非常好的 IDE 并编译 C 代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T09:53:16.090

我会通过下载 cygwin 来使用 gcc。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T09:54:18.613

Gcc 是一种方式，你可以安装 mingw 这是一个本地 Windows 端口。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-24T09:57:24.800

我也推荐 gcc，但如果你想编写可移植的代码，不要太习惯 GNU 扩展，例如 asprintf()。在某些系统上，缺少 strdup() 等等。编译器本身不会宠坏你，但 glibc 会。

一方面你有 POSIX，另一方面你有 ISO/c89/c99，然后你有 gcc。

我强烈推荐 gcc，在您继续探索其他编译器时，请牢记上述警告。例如，如果您喜欢涉足 C++，围绕 Lestes 的限制编写代码会很有趣。

无论如何，gcc 非常强大，拥有出色的优化功能，并且可以非常迂腐，以至于您认为它可以让您受益。但是，不要忘记可移植代码 .. 或者在哪里/如果可移植性 kludges 实际上是合适的。

正如 DasBoot 所发布的，Cygwin 也被强烈推荐。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-24T10:24:59.240

您可以在 7 天内查看这本免费的电子书[Programming in C](http://www.download.com/Programming-in-C-in-7-days/3000-2125_4-10063731.html)作为初学者，他们使用[Dev-CPP](http://www.bloodshed.net/devcpp.html) for windows

笔记

> 它仅包含更完整的电子书“快速学习 C 语言编程”的前 7 课</p>

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-24T10:56:20.883

通常我会推荐[Pelles C](http://www.smorgasbordet.com/pellesc/)在 Windows 中编程 C。这是一个很好的用户友好的编程环境，具有我见过的最好的 c99 合规性……但是，在这里我要告诉你，你应该立即使用 gcc，而不是在 Windows 上。使用 Linux（也许是 Ubuntu？）。

我说在 Linux 上使用 gcc 的原因是因为你想为 iphone 开发。我建议您熟悉您可能使用的工具。我不认为你使用官方的 iphone sdk（你需要一台 Mac）所以我认为你会使用[免费的工具链](http://code.google.com/p/iphone-dev/)。它不能在 Windows 上编译，因此请切换到[受支持的平台](http://code.google.com/p/iphone-dev/wiki/Portability)并熟悉这些工具。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-24T11:10:52.890

如果您正在寻找一个可以同时编译 C 和 Objective-C 的编译器，那么将 GCC 移植到 Windows 可能是您最好的选择。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-24T11:10:57.010

在学习 C 时，请专注于指针、数组、字符串和内存管理——这些东西会让你从任何类型的托管环境中绊倒。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-24T10:14:36.083

我个人推荐MinGW。您可以从 SourceForge 下载它。它甚至适用于 64 位配置。我认为它不支持目标 C。但是，我发现它在 Windows 上运行 C 代码时很有用。

我对目标 C 以及在学习时需要关注 C 的哪些部分以使过渡变得容易没有任何想法。我会把它留给有更多经验的人。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-24T10:17:12.973

[如果您想在 Window XP 平台上学习 C， cygwin](http://www.cygwin.com/)中包含的 gcc是一个完美的首选。cygwin/gcc 包含一个基本的 Objective-C 环境。

无论如何，如果你想以 iPhone 为目标，最好的举措是更改为 Mac 平台（可以原生运行 XP 以平滑切换）以获得 Xcode、Mac 和 iPhone 开发环境。您还将能够学习 CocoaTouch，即 iPhone 操作系统。

同时，您可以注册到[iPhone 开发中心](http://developer.apple.com/iphone/)以访问所有学习 iPhone 编程的资源。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-26T03:51:21.153

GCC 是最便宜的编译器，Intel 最快，MSVC 功能最多。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-26T03:46:42.740

gcc 最好的地方在于它有很多特性并且支持最新的语言标准。但是对于快速编译和良好的编程环境，您无法击败[Lcc-Win32](http://www.cs.virginia.edu/~lcc-win32/)。

# sql - 如何避免结果集之间的 sqlcmd 空行？

> ID：581153
> 
> 赞同：4
> 
> 时间：2009-02-24T09:53:37.727
> 
> 标签：sql, stored-procedures, sqlcmd

参考我关于将 SQL 存储过程提取到 .sql 文件中的最后一个问题[（请参见此处）](https://stackoverflow.com/questions/568734/how-save-sql-stored-prodecures-to-sql-files-via-batch/581111#581111)我还有另一个问题：

如何避免或删除结果集之间的 sqlcmd 空行？

原因[（参见 MSDN）](http://msdn.microsoft.com/en-us/library/ms162773.aspx) 当返回多个结果时，sqlcmd 会在批处理中的每个结果集之间打印一个空行。

这意味着存储过程（超过 4000 个字符）分别在 syscomments 中拆分为两部分，如果使用 sqlcmd 导出到文本 (.sql) 文件中，则在此拆分点将有一个新行。如何消除或避免它？

提前致谢！

肖恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T17:04:31.083

这是[您的](https://stackoverflow.com/questions/568734/how-save-sql-stored-prodecures-to-sql-files-via-batch/581111#581111)批处理文件的更新（它将适用于> 8000个字符的限制，但很容易调整此限制）：

```
for /f %%a in (sp_list.txt) do sqlcmd -E -S SERVER -d DB -h-1 -Q "DECLARE @I INT, @SP1 NVARCHAR(4000), @SP2 NVARCHAR(4000) SET @I = 0 SET @SP1 = '' SET @SP2 = '' SELECT @I = @I + 1, @SP1 = CASE WHEN @I = 1 THEN text ELSE @SP1 END, @SP2 = CASE WHEN @I = 2 THEN text ELSE @SP2 END from dbo.syscomments WHERE id = OBJECT_ID('%%a') SELECT @SP1+@SP2" -o "%%a.sql" 
```

我个人担心这么大的程序。

> 这是一个限制，但是如果您的存储过程的行号超过 4000 个字符，那么您可能会遇到比阅读这篇博客所能解决的问题要大得多的问题......我的存储过程中没有一个行的长度超过 150 个字符，所以这对大多数人来说可能不是什么大不了的事。正如我所说，如果你的线路那么长，你就有更大的问题！
> [Adam Machanic - “反映” TSQL 例程](http://sqlblog.com/blogs/adam_machanic/archive/2006/07/12/reflect-a-tsql-routine.aspx)

但也有人认为大程序不是问题：

> “文本”字段定义为 NVARCHAR(4000)，因此每行最多只能容纳 4000 个字符。但是，目标代码远大于 4000 个字符的情况并不少见。 [Solomon Rutzky - 在对象中搜索文本](http://www.sqlservercentral.com/articles/Stored+Procedure/62975/)

# ios - 如何在 iPhone 上创建多个窗口/视图？

> ID：581165
> 
> 赞同：7
> 
> 时间：2009-02-24T09:58:26.247
> 
> 标签：ios, objective-c, iphone, cocoa-touch

是否可以在（基于窗口的）iPhone 应用程序中创建多个视图或窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T10:12:50.957

是的，有可能。只需使用视图控制器创建一个新视图并在您的类中创建该视图的一个实例。然后在一个 ibaction 中你可以做一些删除和添加子视图。这只是一种快速简便的方法，您可以更详细地了解如何管理每个视图等。

**按需编辑：** 在您的课程中，您将在界面中创建它的一个实例，如下所示：

```
MyClass *myClass; (make sure to alloc and init in the init or awakeFromNib method) 
```

然后在 ibaction 中创建一个应用委托的实例，如下所示：

```
MyAppDelegate *myAppDelegate = (MyAppDelegate *)[[UIApplication sharedApplication] delegate]; 
```

然后您可以这样做以从一种视图切换到另一种视图：

```
[self removeFromSuperView]; (or self.view in case this is a view controller)
[[myAppDelegate window] addSubview:myClass]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-02T14:47:11.590

您可以执行以下操作以编程方式添加视图：

```
 //If you create controllers via XCode, just link them in the .h file with IBOutlet
     UIViewController *aViewController = [[UIViewController alloc] initWithNibName:@"YourNibName" bundle:[NSBundle mainBundle]];
     self.viewController = aViewController;
     [aViewController release];
     // Add the view controller's view as a subview of the window
     UIView *controllersView = [viewController view];
     [window addSubview:controllersView];
     [window makeKeyAndVisible]; 
```

# asp.net - 使用 UserControls 时的 ASP.NET AJAX 问题

> ID：581168
> 
> 赞同：0
> 
> 时间：2009-02-24T09:59:59.397
> 
> 标签：asp.net, ajax, user-controls

我有一个名为 TenantList.ascx 的用户控件，其中包含来自 DevExpress (Web.ASPxGridView) 的稍微修改的 GridView。这个控件在不引起回发的情况下进行回调，这正是我所需要的。我需要响应的特定事件是 CustomButtonClicked。我在用户控件 TenantList.ascx 上创建了 onCustomButtonClicked 事件，该事件在 GridView CustomButtonClicked 事件触发时触发。

我在使用 UC 的页面上有一个事件处理程序。当我使用 VS 进行调试时，我可以看到我进入了我想的事件处理程序。我的事件处理程序如下所示：

```
 protected void uc_TenantList_CustomButtonCallback(object sender, ASPxGridViewCustomButtonCallbackEventArgs e)
    {
        Tenant tenant = (Tenant)uc_TenantList.GetGridView().GetRow(e.VisibleIndex);

        switch (e.ButtonID)
        {
            case "btn_show":
                ShowRow(tenant);
                break;
            case "btn_edit":
                EditRow(tenant);
                break;
            case "btn_delete":
                DeleteRow(tenant.Id);
                break;
            default:
                break;
        } 
    }

    private void EditRow(Tenant tenant)
    {
        uc_TenantDetails.SetTenantData(cBLL.GetTenant(tenant.Id));
        UpdatePanel1.Update();
    } 
```

调用了 EditRow 函数，并且 UserControl TenantDetails.ascx 正确填充了数据。然而 UpdatePanel1.Update(); 没有更新我的 TenantDetails UserControl 所在的面板。

但是，如果我调用 UpdatePanel1.Update(); 从注册到 ScriptManager 的普通控件，它更新得很好。

```
 protected void Button1_Click(object sender, EventArgs e)
        {
            uc_TenantDetails.SetTenantData(cBLL.GetTenant(17));
            UpdatePanel1.Update();
        } 
```

这没有问题......我100％被卡住并且不知道这里可能存在什么问题。

欢迎任何建议！！

干杯真正的 Napster - 真正的麻烦:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T12:36:13.563

好的解决了这个问题

我需要做的是在我的用户控件内的 gridview 控件上启用回发。然后将 Gridview 用户控件放在一个更新面板中，并将详细信息用户控件保留在另一个更新面板中。

就这样，一切顺利。解决方案虽然没有留下深刻的印象。看起来有点难看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T10:07:53.417

确保您的更新面板设置为始终更新（不是有条件的）。您可能还会发现本文中的信息很有用：

[http://www.asp.net/AJAX/Documentation/Live/overview/PartialPageRenderingOverview.aspx](http://www.asp.net/AJAX/Documentation/Live/overview/PartialPageRenderingOverview.aspx) [http://msdn.microsoft.com/en-us/library/system.web.ui.updatepanel.update.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.updatepanel.update.aspx)

第一个链接将为您提供有关部分页面渲染的一些历史记录，第二个链接为您提供有关 Update 方法的更多信息。

从文档中调用 UpdatePanel.Update 将导致更新面板在调用后在客户端上重新呈现，但前提是 UpdatePanel 设置为有条件更新。如果它设置为始终更新，这应该会引发错误。

如果您的更新面板设置为始终更新，它是否嵌套在另一个更新模式设置为条件的 UpdatePanel 中？

# c++ - 如何使用 IGlobalInterfaceTable 传递接口指针？

> ID：581172
> 
> 赞同：1
> 
> 时间：2009-02-24T10:03:54.130
> 
> 标签：c++, visual-studio-2008, multithreading, com

*   **没有**：
    *   MFC
    *   ATL

**问题：**

*   当使用[CreateThread](http://msdn.microsoft.com/en-us/library/ms682453(VS.85).aspx)将特定**接口指针****传递**给**多个线程**时，使用[IGlobalInterfaceTable](http://msdn.microsoft.com/en-us/library/ms678517(VS.85).aspx)涉及哪些步骤？

 ******* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T12:02:42.987

我认为[这个页面](http://msdn.microsoft.com/en-us/library/ms678517(VS.85).aspx)很好地涵盖了它。调用 RegisterInterfaceInGlobal 将您的 COM 接口放入 GIT，将其 cookie 传递给您的其他线程，然后可以使用该 cookie 调用 GetInterfaceFromGlobal 以获取原始接口。

请注意，每个线程都必须调用 CoCreateInstance(CLSID_StdGlobalInterfaceTable... 但不要担心，它们都会获得指向同一 GIT 实例的接口指针。

# functional-programming - 什么是“向下的函数”？

> ID：581182
> 
> 赞同：62
> 
> 时间：2009-02-24T10:09:08.233
> 
> 标签：functional-programming, lisp, terminology

[Jamie Zawinski](http://en.wikipedia.org/wiki/Jwz)在他的 (1997)[文章“java 糟透了”](http://www.jwz.org/doc/java.html)中使用了这个术语，好像你应该知道它的意思：

> 我真的很讨厌缺乏向下的燃料；匿名类是一个蹩脚的替代品。（我可以不用长寿命的闭包，但我发现缺少函数指针是一个巨大的痛苦。）

这似乎是 Lisper 的俚语，我可以在[这里](http://www.delorie.com/gnu/docs/emacs/cl_21.html)找到以下简短定义，但不知何故，我想我还是不明白：

> 许多闭包仅在它们所指的绑定范围内使用；在 Lisp 用语中，这些被称为“downward funargs”。

如果不是因为[Steve Yegge](http://steve-yegge.blogspot.com/)，我现在会觉得很愚蠢，但看起来，问一下可能没问题：

> 杰米·扎温斯基是个英雄。一个活生生的传奇。[...]**一个可以使用“downward funargs”这个词然后瞪着你的家伙，只是胆敢让他解释它，你这个白痴。**
> 
> -- [XEmacs 已死，XEmacs 万岁](http://steve-yegge.blogspot.com/2008/04/xemacs-is-dead-long-live-xemacs.html)

那么这里有没有一个 Lisper 可以为像我这样的 C 风格程序员编译这个？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-24T10:12:35.700

向下的函数参数是不返回或以其他方式离开其声明范围的局部函数。它们只能从当前范围*向下传递给其他函数。*

两个例子。这是一个向下的函数：

```
function () {
    var a = 42;
    var f = function () { return a + 1; }
    foo(f); // `foo` is a function declared somewhere else.
} 
```

虽然这不是：

```
function () {
    var a = 42;
    var f = function () { return a + 1; }
    return f;
} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-02-25T20:18:48.027

为了更好地理解该术语的来源，您需要了解一些历史。

一个老 Lisp 黑客可能会从一般的函数参数中区分出*向下*函数参数的原因是，向下函数参数在缺乏词法变量的传统 Lisp 中很容易实现，而一般情况下很难实现。

传统上，局部变量是在 Lisp 解释器中通过向环境添加*绑定*（变量的符号名称，与其值配对）来实现*的*。这样的环境很容易使用关联列表来实现。每个函数都有自己的环境，以及指向父函数环境的指针。通过查看当前环境来解析变量引用，如果在当前环境中找不到，则在父环境中，依此类推，直到到达全局环境。

在这样的实现中，局部变量会*影响*同名的全局变量。例如，在 Emacs Lisp 中，`print-length`是一个全局变量，用于指定要在缩写之前打印的列表的最大长度。通过在对函数的调用周围绑定此变量，您可以更改该函数中打印语句的行为：

```
(defun foo () (print '(1 2 3 4 5 6))) ; 输出取决于 print-length 的值

(foo) ; 使用 print-length 的全局值
  ==> (1 2 3 4 5 6)

(let ((print-length 3)) (foo)) ; 在对 foo 的调用周围本地绑定 print-length。
  ==> (1 2 3 ...)

```

您可以看到，在这样的实现中，*向下*的函数参数非常容易实现，因为在函数创建时处于函数环境中的变量在计算时仍将在函数环境中。

这种行为的变量称为*特殊*变量或*动态*变量，您可以使用[`special`](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Body/dec_special.html#special)声明在 Common Lisp 中创建它们。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-24T15:45:02.513

在 Common Lisp 中：

```
(let ((a 3))
  (mapcar (lambda (b) (+ a b))
          (list 1 2 3 4)))

->  (4 5 6 7) 
```

在上面的形式中，lambda 函数向下传递。当由高阶函数 MAPCAR 调用时（它获取一个函数和一个值列表作为参数，然后将该函数应用于列表的每个元素并返回一个结果列表），lambda 函数仍然引用变量'a' 来自 LET 表达式。但它发生在 LET 表达式中。

将上面与此版本进行比较：

```
(mapcar (let ((a 3))
          (lambda (b) (+ a b)))
        (list 1 2 3 4)) 
```

这里的 lambda 函数是从 LET 返回的。向上一点。然后它被传递给 MAPCAR。当 MAPCAR 调用 lambda 函数时，其周围的 LET 不再执行 - 函数仍然需要从 LET 中引用变量“a”。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-24T10:11:36.247

Wiki 上有一篇描述性很强的文章，叫做[Funarg 问题](http://en.wikipedia.org/wiki/Funarg_problem)

> “向下函数参数也可以指函数未实际执行时的状态。但是，根据定义，向下函数参数的存在包含在创建它的函数的执行中，函数的激活记录通常仍然可以存储在堆栈中。”

# python - 有人可以解释为什么 scipy.integrate.quad 在积分 sin(X) 的同时在同样长的范围内给出不同的结果吗？

> ID：581186
> 
> 赞同：5
> 
> 时间：2009-02-24T10:10:29.447
> 
> 标签：python, integration, scipy, numerical-methods

我正在尝试使用数值积分方法在我的程序中对任意（我编码时已知）函数进行数值积分。我正在使用 Python 2.5.2 和 SciPy 的数值集成包。为了感受它，我决定尝试整合 sin(x) 并观察这种行为 -

```
>>> from math import pi
>>> from scipy.integrate import quad
>>> from math import sin
>>> def integrand(x):
...     return sin(x)
... 
>>> quad(integrand, -pi, pi)
(0.0, 4.3998892617846002e-14)
>>> quad(integrand, 0, 2*pi)
(2.2579473462709165e-16, 4.3998892617846002e-14) 
```

我觉得这种行为很奇怪，因为 -
1\. 在普通积分中，整个周期的积分为零。
2\. 在数值积分中，这 (1) 不一定是这种情况，因为您可能只是在近似曲线下的总面积。

无论如何，假设 1 为真或假设 2 为真，我发现行为不一致。两种积分（-pi 到 pi 和 0 到 2*pi）都应该返回 0.0（元组中的第一个值是结果，第二个是错误）或返回 2.257...

有人可以解释为什么会这样吗？这真的是矛盾吗？有人能告诉我我是否遗漏了一些关于数值方法的基本知识吗？

无论如何，在我的最终应用程序中，我打算使用上述方法来查找函数的弧长。如果有人在这方面有经验，请告诉我在 Python 中执行此操作的最佳策略。

**编辑**
**注意**
我已经在数组中存储了范围内所有点的第一个微分值。
当前误差是可以容忍的。
**尾注**

我已经阅读了有关此的维基百科。正如 Dimitry 所指出的，我将整合 sqrt(1+diff(f(x), x)^2) 以获得弧长。我想问的是 - 是否有更好的近似/最佳实践（？）/更快的方法来做到这一点。如果需要更多上下文，我会按照您的意愿单独发布/在此处发布上下文。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T10:32:18.523

该`quad`函数是来自旧 Fortran 库的函数。它的工作原理是通过它正在积分的函数的平坦度和斜率来判断如何处理它用于数值积分的步长，以最大限度地提高效率。这意味着您可能会从一个区域到下一个区域得到略微不同的答案，即使它们在分析上是相同的。

毫无疑问，两个积分都应该返回零。返回 1/（10 万亿）的东西非常接近于零！细微的差异是由于`quad`滚动方式`sin`和改变步长的方式。对于您计划的任务，`quad`将是您所需要的。

编辑：对于你正在做的事情，我认为`quad`这很好。它快速且非常准确。我的最后声明是自信地使用它，除非你发现某些东西确实出了问题。如果它没有返回无意义的答案，那么它可能工作得很好。不用担心。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T10:32:55.667

我认为这可能是机器精度，因为两个答案实际上都是零。

如果您想从马口中得到答案，我会将这个问题发布在[scipy 讨论板上](http://www.nabble.com/Scipy-User-f33045.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-24T10:52:04.667

我会说一个数字 O(10^-14) 实际上为零。你的容忍度是多少？

可能是基于 quad 的算法不是最好的。您可以尝试另一种集成方法，看看是否可以改善情况。5 阶 Runge-Kutta 可能是一种非常好的通用技术。

这可能只是浮点数的本质：[“每个计算机科学家都应该知道的关于浮点运算的知识”。](http://www.physics.ohio-state.edu/~dws/grouplinks/floating_point_math.pdf)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-24T10:22:12.103

这个输出对我来说似乎是正确的，因为你在这里有绝对误差估计。在普通积分和数值积分中，sin(x) 的积分值确实应该在整个周期（2*pi 长度的任何间隔）中为零，并且您的结果接近该值。
要评估弧长，您应该计算 sqrt(1+diff(f(x), x)^2) 函数的积分，其中 diff(f(x), x) 是 f(x) 的导数。另见[弧长](http://en.wikipedia.org/wiki/Arclength)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-24T23:53:11.357

```
0.0 == 2.3e-16 (absolute error tolerance 4.4e-14) 
```

两个答案都是相同且*正确*的，即在给定的容差范围内为零。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-04T18:33:05.030

不同之处在于 sin(x)=-sin(-x) 即使在有限精度下也是如此。而有限精度只给出了 sin(x)~sin(x+2*pi) 的近似值。当然，如果 quad 足够聪明来解决这个问题会很好，但它确实无法先验地知道你给出的两个区间上的积分是等价的，或者第一个是更好的结果。

# actionscript-3 - 在舞台周围绘制边框的最简单方法？

> ID：581193
> 
> 赞同：3
> 
> 时间：2009-02-24T10:12:22.673
> 
> 标签：actionscript-3, flex3

AS 3 中似乎没有 stage.border 属性？

我的课程扩展了 Sprite，在 Flash 对象周围绘制边框的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T10:28:00.903

this.graphics.lineStyle(0,0x555555,0.5); this.graphics.drawRect(0,0,this.width,this.height);

其中“this”是您的 Sprite 对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-16T16:37:16.723

OXMO456 的代码有错字。下面是固定版本：

```
this.graphics.lineStyle(0,0x555555,0.5);
this.graphics.drawRect(0,0,this.width,this.height); 
```

另外，我应该提到 this.width 和 this.height 在应用程序启动时都以 0 开始，因此将上面的代码放在主 MovieClip 的构造函数中不会做任何事情——它将绘制一个 0 x 0 大的矩形. 一种解决方法是将上面的代码放在 ADDED_TO_STAGE 事件处理程序中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T10:16:50.790

使用过滤器。看到[这个](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/DisplayObject.html#filters)。

# winforms - 使用 WinForms 显示带有大量 ComboBox 控件的选项卡很慢

> ID：581196
> 
> 赞同：4
> 
> 时间：2009-02-24T10:13:23.920
> 
> 标签：winforms, optimization, combobox, performance

我已经设置了一个带有多个选项卡的对话框。其中一个包含二十个组合框，每个组合框有 100 多个项目，添加如下：

```
foreach (var x in collection)
{
    string text = FormatItem (x);
    combo.Items.Add (text);
} 
```

所以这些物品一点都不花哨。它们是纯字符串，并且在创建对话框时组合框会被填充。这几乎是瞬间发生的。

但是，当用户第一次单击包含所有这些组合框的选项卡时，GUI 会冻结几秒钟（我正在一台非常强大的机器上运行）。

我加载了符号`System.Windows.Forms`并试图在程序卡住时闯入调试器。我发现的是带有以下调用的堆栈跟踪：

```
System.Windows.Forms.Control.CreateHandle()
System.Windows.Forms.ComboBox.CreateHandle()
System.Windows.Forms.Control.CreateControl(...) x 3
System.Windows.Forms.Control.SetVisibleCore(true)
System.Windows.Forms.TabPage.Visible.set(true) 
```

这会导致大量的本地转换、`WndProc`调用等。我想这发生在每个组合框中的每个项目上。呸。

显然，我无法优化 WinForms。但也许我可以采取一些措施来避免所有这些地狱在我可怜的 GUI 上迷失方向？有任何想法吗？

注意事项：

1.  我没有在组合框上附加任何事件处理程序，当控件真正创建时可以调用这些事件处理程序。

2.  如果我在创建并填充表单后尝试访问`Handle`组合框的属性，我会在那个时候支付罚金，而不是在选项卡第一次可见时支付。但是在创建表单时必须等待几秒钟也是不可接受的。我真的很想摆脱漫长的设置时间。

3.  `BeginUpdate`在这里应用和`EndUpdate`不应用的想法：这些应该用于防止控件在其项目列表被填充时重新绘制。但就我而言，问题发生在控件设置好之后。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T10:37:29.320

你所说的与我观察到的任何事情都不一致......：s

但是您是否尝试过使用 .BeginUpdate / .EndUpdate ？

您可以尝试的另一件事是在需要之前*不要*填​​充这些框。例如，将其延迟到框获得焦点...（如果您捕获下拉事件，某些用户*可能*会因为向上/向下箭头键不起作用而感到恼火。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T20:21:25.640

到目前为止，我尝试的一切都未能加快包含所有组合框的选项卡的首次显示。数据绑定也没有帮助。

我最终决定通过一个技巧来解决这个问题，类似于[danbystrom](https://stackoverflow.com/users/64121/danbystrom)提出的建议，即仅`Items`在焦点首次到达组合时才填充集合。这仍然会产生明显的延迟，即创建所有项目的时间（在一`BeginUpdate`对`EndUpdate`方法调用内），但这是可以容忍的（大约 200 毫秒，而在我的原始场景中为几秒）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T13:34:31.110

不是迭代您的集合，而是设置 ComboBox.DataSource 是一种可行且更快的选择吗？

```
comboBox1.DataSource = myCollection1;
comboBox2.DataSource = myCollection2;
comboBox3.DataSource = myCollection3;
// and so on... 
```

这是一个更完整的示例：

```
public class Entity
    {
        public string Title { get; set; }
        public override string ToString()
        {
            return Title;
        }
    }
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();

            List<Entity> list = new List<Entity>
                                    {
                                        new Entity {Title = "Item1"},
                                        new Entity {Title = "Item2"},
                                        new Entity {Title = "Item3"}
                                    };

            comboBox1.DataSource = list;

        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-18T14:16:12.897

我刚刚遇到了同样的问题，用大约 4000k 项填充组合框的速度慢得令人无法接受。

我在表单的 OnLoad 事件处理程序中填充组合，但是，当我将此代码转移到构造函数时，在 InitializeComponent() 之后，根本没有延迟。

我猜在 OnLoad 中执行此操作会导致重绘组合触发，因此延迟？无论如何，只是想我会添加它以防在这种情况下对其他人有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T21:35:56.150

表单上的许多控件可能是个问题。我曾经有一个动态创建 50-100 个文本框控件的表单。加载速度很慢。

我们通过使用数据网格解决了这个问题。这是一个针对大量数据进行优化的控件。我不知道您的确切要求是什么，但它可能会起作用。

# nhibernate - 防止 Fluent NHibernate 选择 n+1

> ID：581199
> 
> 赞同：5
> 
> 时间：2009-02-24T10:14:18.847
> 
> 标签：nhibernate, select, fluent-nhibernate

我有一个相当深的对象图（5-6 个节点），当我遍历它的一部分时，NHProf 告诉我我遇到了“选择 N+1”问题（我确实这样做了）。

我知道的两个解决方案是

1.  急切的负载孩子
2.  分解我的对象图（和急切的负载）

我真的不想做这些（尽管我可能会在以后将图表分开，因为我预见到它会增长）

目前....

是否可以告诉 NHibernate（使用 FluentNHibernate）每当我尝试访问孩子时，一次性加载它们，而不是在我迭代它们时选择-n+1-ing？

我也得到了“无限的结果集”，这可能是同一个问题（或者更确切地说，如果可能的话，将通过上述解决方案来解决）。

每个子集合（在整个图表中）将只有大约 20 个成员，但是 20^5 很多，所以我不想在获得根时急切加载所有内容，而只是在我获得所有子集合时靠近它。

编辑：事后诸葛亮......如果我想在渲染孩子时引入分页怎么办？我必须在这里打破我的对象图，还是我可以利用一些鬼鬼祟祟的方法来解决所有这些问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T11:40:16.393

在我看来，您希望采用使用域模型的方法，而不是创建特定的休眠查询来处理这种情况。鉴于此，我建议您查看可以应用于您的集合的批量大小属性。Fluent NHibernate fluent interface 尚不支持此属性，但作为一种解决方法，您可以使用：

```
HasMany(x => x.Children).AsSet().SetAttribute("batch-size", "20") 
```

鉴于普遍缺乏有关您的确切场景的信息，我不能确定批量大小是否是理想的解决方案，但我当然建议您试一试。如果您还没有，我建议您阅读以下内容：

[http://www.nhforge.org/wikis/howtonh/lazy-loading-eager-loading.aspx](http://www.nhforge.org/wikis/howtonh/lazy-loading-eager-loading.aspx)

[http://nhibernate.info/doc/nhibernate-reference/performance.html](http://nhibernate.info/doc/nhibernate-reference/performance.html)

NHibernate 性能文档将解释批量大小的工作原理。

编辑：我不知道有任何方法可以从您的域模型中分页。我建议您为需要分页的场景编写 NH 查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-28T08:08:42.890

> 编辑：事后诸葛亮....如果我想在渲染孩子时引入分页怎么办？我必须在这里打破我的对象图吗，还是我可以利用一些鬼鬼祟祟的方法来解决所有这些问题？

好吧，如果您只加载孩子，那么您可以分页它们:)。但是，如果您想要类似的东西： LoadParent AND PageChildren ，那么我认为您不能这样做。

# c++ - 如何检查用户是否在win32中具有本地管理员权限

> ID：581204
> 
> 赞同：8
> 
> 时间：2009-02-24T10:16:05.160
> 
> 标签：c++, winapi

如何从 c++ 检查用户是否在 win32 中具有本地管理员权限

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T11:10:27.073

刚刚在 shlobj.h 中找到[了 IsUserAnAdmin()](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776463%28v=vs.85%29.aspx "IsUserAnAdmin()";")，它为我完成了这项工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T11:14:49.637

你可能需要更多的东西来处理海拔等等......

我这样做是这样的......

```
bool CProcessToken::IsUserAnAdmin() const
{
#if _WIN32_WINNT >= 0x0600 

   bool isAdmin = false;

   DWORD bytesUsed = 0;

   TOKEN_ELEVATION_TYPE tokenElevationType;

   if (!::GetTokenInformation(m_hToken, TokenElevationType, &tokenElevationType, sizeof(tokenElevationType), &bytesUsed))
   {
      const DWORD lastError = ::GetLastError();

      throw CWin32Exception(_T("CProcessToken::IsUserAnAdmin() - GetTokenInformation - TokenElevationType"), lastError);
   }

   if (tokenElevationType == TokenElevationTypeLimited)
   {
      CSmartHandle hUnfilteredToken;

      if (!::GetTokenInformation(m_hToken, TokenLinkedToken, reinterpret_cast<void *>(hUnfilteredToken.GetHandle()), sizeof(HANDLE), &bytesUsed))
      {
         const DWORD lastError = ::GetLastError();

         throw CWin32Exception(_T("CProcessToken::IsUserAnAdmin() - GetTokenInformation - TokenLinkedToken"), lastError);
      }

      BYTE adminSID[SECURITY_MAX_SID_SIZE];

      DWORD sidSize = sizeof(adminSID);

      if (!::CreateWellKnownSid(WinBuiltinAdministratorsSid, 0, &adminSID, &sidSize))
      {
         const DWORD lastError = ::GetLastError();

         throw CWin32Exception(_T("CProcessToken::IsUserAnAdmin() - CreateWellKnownSid"), lastError);
      }

      BOOL isMember = FALSE;

      if (::CheckTokenMembership(hUnfilteredToken, &adminSID, &isMember))
      {
         const DWORD lastError = ::GetLastError();

         throw CWin32Exception(_T("CProcessToken::IsUserAnAdmin() - CheckTokenMembership"), lastError);
      }

      isAdmin = (isMember != FALSE);
   }
   else
   {
      isAdmin = ToBool(::IsUserAnAdmin());         
   }

   return isAdmin;

#else
   return ToBool(::IsUserAnAdmin());         
#endif
} 
```

我不记得我从哪里得到信息来编写那段代码......

# asp.net-mvc - VS08 中没有 SQL Server Express 的 SQL Server 数据库项

> ID：581206
> 
> 赞同：1
> 
> 时间：2009-02-24T10:16:29.607
> 
> 标签：asp.net-mvc, sql-server-2008

我遇到了这个问题（在尝试将 SQL Server 数据库（.mdf）文件添加到我的 asp.net mvc 项目时）：

*与 SQL Server 文件 (* .mdf) 的连接需要 SQL Server Express 2005 才能正常运行。请验证组件的安装或从 URL 下载：http: [//go.microsoft.com/fwlink/](http://go.microsoft.com/fwlink/?LinkId=49251) ?LinkId=49251 *

我有 SQL Server 2008。有人知道如何将该文件添加到项目中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T11:08:42.057

如果您使用 SQL Developer、Standard 或除 Express 之外的任何其他版本，则需要先将数据库附加到 SQL 服务器，然后才能使用它。在 SQL management studio 中连接到您的服务器，右键单击 Databases 文件夹并选择附加，浏览到您的数据库并选择它（请注意，您可能需要将其移动到 SQL 可以看到的目录 - 默认情况下 SQL 作为网络服务运行并且无法在 C:\Users 内窥视）。

完成后，您需要告诉 ASP.NET 那是您希望使用的数据库。有几种方法可以做到这一点，但公平地说，最简单的方法是通过将以下内容添加到 web.config 来覆盖 SQL Express 数据库连接

```
<connectionStrings>
    <remove name="LocalSqlServer" />
    <add name="LocalSqlServer" connectionString="Data Source=myServerAddress;Initial Catalog=myDataBase;Integrated Security=SSPI;" providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

不要忘记授予网络服务或您运行应用程序池的任何身份，以访问 SQL 服务器中的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T13:35:39.987

（我相信这会奏效。）

将 MDF 文件移动到 SQL Server 框并使用 Management Studio 附加它，从而在 SQL Server 中创建一个数据库。（您需要创建一个事务日志文件来使用它。）

然后连接到该数据库作为数据源。

完整 SQL Server 无法使用连接字符串中指定的数据库文件的连接。

# c++ - 如何最好地将 std::vector < std::string > 容器写入 HDF5 数据集？

> ID：581209
> 
> 赞同：15
> 
> 时间：2009-02-24T10:16:56.640
> 
> 标签：c++, stl, hdf5

给定一个字符串向量，将它们写入 HDF5 数据集的最佳方法是什么？目前我正在做类似以下的事情：

```
 const unsigned int MaxStrLength = 512;

  struct TempContainer {
    char string[MaxStrLength];
  };

  void writeVector (hid_t group, std::vector<std::string> const & v)
  {
    //
    // Firstly copy the contents of the vector into a temporary container
    std::vector<TempContainer> tc;
    for (std::vector<std::string>::const_iterator i = v.begin ()
                                              , end = v.end ()
      ; i != end
      ; ++i)
    {
      TempContainer t;
      strncpy (t.string, i->c_str (), MaxStrLength);
      tc.push_back (t);
    }

    //
    // Write the temporary container to a dataset
    hsize_t     dims[] = { tc.size () } ;
    hid_t dataspace = H5Screate_simple(sizeof(dims)/sizeof(*dims)
                               , dims
                               , NULL);

    hid_t strtype = H5Tcopy (H5T_C_S1);
    H5Tset_size (strtype, MaxStrLength);

    hid_t datatype = H5Tcreate (H5T_COMPOUND, sizeof (TempConainer));
    H5Tinsert (datatype
      , "string"
      , HOFFSET(TempContainer, string)
      , strtype);

    hid_t dataset = H5Dcreate1 (group
                          , "files"
                          , datatype
                          , dataspace
                          , H5P_DEFAULT);

    H5Dwrite (dataset, datatype, H5S_ALL, H5S_ALL, H5P_DEFAULT, &tc[0] );

    H5Dclose (dataset);
    H5Sclose (dataspace);
    H5Tclose (strtype);
    H5Tclose (datatype);
} 
```

至少，我真的很想更改上述内容，以便：

1.  它使用可变长度字符串
2.  我不需要临时容器

我对如何存储数据没有任何限制，例如，如果有更好的方法，它不必是*COMPOUND数据类型。*

**编辑：** 只是为了缩小问题的范围，我对在 C++ 端处理数据比较熟悉，在 HDF5 端我需要大部分帮助。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T13:24:20.917

[非常感谢[dirkgently](https://stackoverflow.com/users/66692/dirkgently)帮助回答这个问题。]

要在 HDF5 中写入可变长度字符串，请使用以下命令：

```
// Create the datatype as follows
hid_t datatype = H5Tcopy (H5T_C_S1);
H5Tset_size (datatype, H5T_VARIABLE);

// 
// Pass the string to be written to H5Dwrite
// using the address of the pointer!
const char * s = v.c_str ();
H5Dwrite (dataset
  , datatype
  , H5S_ALL
  , H5S_ALL
  , H5P_DEFAULT
  , &s ); 
```

编写容器的一种解决方案是单独编写每个元素。这可以使用[hyperslabs](http://www.hdfgroup.org/HDF5/Tutor/select.html)来实现。

例如：

```
class WriteString
{
public:
  WriteString (hid_t dataset, hid_t datatype
      , hid_t dataspace, hid_t memspace)
    : m_dataset (dataset), m_datatype (datatype)
    , m_dataspace (dataspace), m_memspace (memspace)
    , m_pos () {}

private:
  hid_t m_dataset;
  hid_t m_datatype;
  hid_t m_dataspace;
  hid_t m_memspace;
  int m_pos; 
```

//...

```
public:
  void operator ()(std::vector<std::string>::value_type const & v)
  {
    // Select the file position, 1 record at position 'pos'
    hsize_t count[] = { 1 } ;
    hsize_t offset[] = { m_pos++ } ;
    H5Sselect_hyperslab( m_dataspace
      , H5S_SELECT_SET
      , offset
      , NULL
      , count
      , NULL );

    const char * s = v.c_str ();
    H5Dwrite (m_dataset
      , m_datatype
      , m_memspace
      , m_dataspace
      , H5P_DEFAULT
      , &s );
    }    
}; 
```

// ...

```
void writeVector (hid_t group, std::vector<std::string> const & v)
{
  hsize_t     dims[] = { m_files.size ()  } ;
  hid_t dataspace = H5Screate_simple(sizeof(dims)/sizeof(*dims)
                                    , dims, NULL);

  dims[0] = 1;
  hid_t memspace = H5Screate_simple(sizeof(dims)/sizeof(*dims)
                                    , dims, NULL);

  hid_t datatype = H5Tcopy (H5T_C_S1);
  H5Tset_size (datatype, H5T_VARIABLE);

  hid_t dataset = H5Dcreate1 (group, "files", datatype
                             , dataspace, H5P_DEFAULT);

  // 
  // Select the "memory" to be written out - just 1 record.
  hsize_t offset[] = { 0 } ;
  hsize_t count[] = { 1 } ;
  H5Sselect_hyperslab( memspace, H5S_SELECT_SET, offset
                     , NULL, count, NULL );

  std::for_each (v.begin ()
      , v.end ()
      , WriteStrings (dataset, datatype, dataspace, memspace));

  H5Dclose (dataset);
  H5Sclose (dataspace);
  H5Sclose (memspace);
  H5Tclose (datatype);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T09:45:38.480

这是一些使用 HDF5 c++ API 编写可变长度字符串向量的工作代码。

我在其他帖子中加入了一些建议：

1.  使用 H5T_C_S1 和 H5T_VARIABLE
2.  用于`string::c_str()`获取指向字符串的指针
3.  将指针放入 a `vector`of`char*`并传递给 HDF5 API

**不必**创建昂贵的字符串副本（例如 with `strdup()`）。`c_str()`返回一个指向底层字符串的空终止数据的指针。这正是该功能的用途。当然，带有嵌入空值的字符串不适用于此...

`std::vector`保证具有连续的底层存储，因此使用`vector`and`vector::data()`与使用原始数组相同，但当然比笨重、老式的 c 处理方式更整洁、更安全。

```
#include "H5Cpp.h"
void write_hdf5(H5::H5File file, const std::string& data_set_name,
                const std::vector<std::string>& strings )
{
    H5::Exception::dontPrint();

    try
    {
        // HDF5 only understands vector of char* :-(
        std::vector<const char*> arr_c_str;
        for (unsigned ii = 0; ii < strings.size(); ++ii) 
            arr_c_str.push_back(strings[ii].c_str());

        //
        //  one dimension
        // 
        hsize_t     str_dimsf[1] {arr_c_str.size()};
        H5::DataSpace   dataspace(1, str_dimsf);

        // Variable length string
        H5::StrType datatype(H5::PredType::C_S1, H5T_VARIABLE); 
        H5::DataSet str_dataset = file.createDataSet(data_set_name, datatype, dataspace);

        str_dataset.write(arr_c_str.data(), datatype);
    }
    catch (H5::Exception& err)
    {
        throw std::runtime_error(string("HDF5 Error in " ) 
                                    + err.getFuncName()
                                    + ": "
                                    + err.getDetailMsg());

    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T10:27:15.070

如果您正在查看更简洁的代码：我建议您创建一个函子，它将接受一个字符串并将其保存到 HDF5 容器（以所需的模式）。理查德，我使用了错误的算法，请重新检查！

```
std::for_each(v.begin(), v.end(), write_hdf5);

struct hdf5 : public std::unary_function<std::string, void> {
    hdf5() : _dataset(...) {} // initialize the HDF5 db
    ~hdf5() : _dataset(...) {} // close the the HDF5 db
    void operator(std::string& s) {
            // append 
            // use s.c_str() ?
    }
}; 
```

这对开始有帮助吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-19T22:50:18.043

我有一个类似的问题，需要注意的是我想要一个字符串向量存储为*属性*。属性的棘手之处在于我们不能使用像 hyperslabs 这样的花哨的数据空间功能（至少对于 C++ API）。

但在任何一种情况下，将字符串向量输入到数据集中的单个条目中可能很有用（例如，如果您总是希望将它们一起读取）。在这种情况下，所有的魔法都来自*type*，而不是数据空间本身。

基本上有4个步骤：

1.  做一个`vector<const char*>`指向字符串的。
2.  创建一个`hvl_t`指向向量并包含其长度的结构。
3.  创建数据类型。这是一个`H5::VarLenType`包装 a (variable length) `H5::StrType`。
4.  将`hvl_t`类型写入数据集。

这种方法真正好的部分是您将整个条目填充到 HDF5 认为的标量值中。这意味着将其作为属性（而不是数据集）是微不足道的。

无论您选择此解决方案还是选择每个字符串都在其自己的数据集条目中的解决方案，这可能也是所需性能的问题：如果您正在寻找对特定字符串的随机访问，最好将字符串写在数据集中，这样它们可以被索引。如果您总是将它们全部一起阅读，则此解决方案也可以正常工作。

下面是一个简短的示例，说明如何使用 C++ API 和一个简单的标量数据集执行此操作：

```
#include <vector>
#include <string>
#include "H5Cpp.h"

int main(int argc, char* argv[]) {
  // Part 0: make up some data
  std::vector<std::string> strings;
  for (int iii = 0; iii < 10; iii++) {
    strings.push_back("this is " + std::to_string(iii));
  }

  // Part 1: grab pointers to the chars
  std::vector<const char*> chars;
  for (const auto& str: strings) {
    chars.push_back(str.data());
  }

  // Part 2: create the variable length type
  hvl_t hdf_buffer;
  hdf_buffer.p = chars.data();
  hdf_buffer.len = chars.size();

  // Part 3: create the type
  auto s_type = H5::StrType(H5::PredType::C_S1, H5T_VARIABLE);
  s_type.setCset(H5T_CSET_UTF8); // just for fun, you don't need this
  auto svec_type = H5::VarLenType(&s_type);

  // Part 4: write the output to a scalar dataset
  H5::H5File out_file("vtest.h5", H5F_ACC_EXCL);
  H5::DataSet dataset(
    out_file.createDataSet("the_ds", svec_type, H5S_SCALAR));
  dataset.write(&hdf_buffer, svec_type);

  return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-08T12:01:09.433

我迟到了，但我已经根据有关段错误的评论修改了 Leo Goodstadt 的答案。我在linux上，但我没有这样的问题。我编写了 2 个函数，一个用于将 std::string 的向量写入打开的 H5File 中给定名称的数据集，另一个用于将结果数据集读回 std::string 的向量。请注意，类型之间可能有几次不必要的复制，可以更优化。这是用于编写和阅读的工作代码：

```
void write_varnames( const std::string& dsetname, const std::vector<std::string>& strings, H5::H5File& f)
  {
    H5::Exception::dontPrint();

    try
      {
        // HDF5 only understands vector of char* :-(
        std::vector<const char*> arr_c_str;
        for (size_t ii = 0; ii < strings.size(); ++ii)
      {
        arr_c_str.push_back(strings[ii].c_str());
      }

        //
        //  one dimension
        // 
        hsize_t     str_dimsf[1] {arr_c_str.size()};
        H5::DataSpace   dataspace(1, str_dimsf);

        // Variable length string
        H5::StrType datatype(H5::PredType::C_S1, H5T_VARIABLE); 
        H5::DataSet str_dataset = f.createDataSet(dsetname, datatype, dataspace);

        str_dataset.write(arr_c_str.data(), datatype);
      }
    catch (H5::Exception& err)
      {
        throw std::runtime_error(std::string("HDF5 Error in ")  
                 + err.getFuncName()
                 + ": "
                 + err.getDetailMsg());

      }
  } 
```

并阅读：

```
std::vector<std::string> read_string_dset( const std::string& dsname, H5::H5File& f )
  {
    H5::DataSet cdataset = f.openDataSet( dsname );

    H5::DataSpace space = cdataset.getSpace();

    int rank = space.getSimpleExtentNdims();

    hsize_t dims_out[1];

    int ndims = space.getSimpleExtentDims( dims_out, NULL);

    size_t length = dims_out[0];

    std::vector<const char*> tmpvect( length, NULL );

    fprintf(stdout, "In read STRING dataset, got number of strings: [%ld]\n", length );

    std::vector<std::string> strs(length);
    H5::StrType datatype(H5::PredType::C_S1, H5T_VARIABLE); 
    cdataset.read( tmpvect.data(), datatype);

    for(size_t x=0; x<tmpvect.size(); ++x)
      {
        fprintf(stdout, "GOT STRING [%s]\n", tmpvect[x] );
        strs[x] = tmpvect[x];
      }

    return strs;
  } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T11:13:56.380

您可以使用简单的 std::vector 代替 TempContainer （您也可以将其模板化以匹配 T -> basic_string 。像这样：

```
#include <algorithm>
#include <vector>
#include <string>
#include <functional>

class StringToVector
  : std::unary_function<std::vector<char>, std::string> {
public:
  std::vector<char> operator()(const std::string &s) const {
    // assumes you want a NUL-terminated string
    const char* str = s.c_str();
    std::size_t size = 1 + std::strlen(str);
    // s.size() != strlen(s.c_str())
    std::vector<char> buf(&str[0], &str[size]);
    return buf;
  }
};

void conv(const std::vector<std::string> &vi,
          std::vector<std::vector<char> > &vo)
{
  // assert vo.size() == vi.size()
  std::transform(vi.begin(), vi.end(),
                 vo.begin(),
                 StringToVector());
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-30T21:53:59.090

为了能够*阅读* `std::vector<std::string>`，我发布了我的解决方案，基于来自 Leo 的提示[https://stackoverflow.com/a/15220532/364818](https://stackoverflow.com/a/15220532/364818)。

我混合了 C 和 C++ API。请随时编辑它并使其更简单。

请注意，`char*`当您调用 read 时，HDF5 API 返回一个指针列表。这些`char*`指针在使用后必须释放，否则会出现内存泄漏。

使用示例

```
H5::Attribute Foo = file.openAttribute("Foo");
std::vector<std::string> foos
Foo >> foos; 
```

这是代码

```
 const H5::Attribute& operator>>(const H5::Attribute& attr0, std::vector<std::string>& array)
  {
      H5::Exception::dontPrint();

      try
      {
          hid_t attr = attr0.getId();

          hid_t atype = H5Aget_type(attr);
          hid_t aspace = H5Aget_space(attr);
          int rank = H5Sget_simple_extent_ndims(aspace);
          if (rank != 1) throw PBException("Attribute " + attr0.getName() + " is not a string array");

          hsize_t sdim[1];
          herr_t ret = H5Sget_simple_extent_dims(aspace, sdim, NULL);
          size_t size = H5Tget_size (atype);
          if (size != sizeof(void*))
          {
              throw PBException("Internal inconsistency. Expected pointer size element");
          }

          // HDF5 only understands vector of char* :-(
          std::vector<char*> arr_c_str(sdim[0]);

          H5::StrType stringType(H5::PredType::C_S1, H5T_VARIABLE);
          attr0.read(stringType, arr_c_str.data());
          array.resize(sdim[0]);
          for(int i=0;i<sdim[0];i++)
          {
              // std::cout << i << "=" << arr_c_str[i] << std::endl;
              array[i] = arr_c_str[i];
              free(arr_c_str[i]);
          }

      }
      catch (H5::Exception& err)
      {
          throw std::runtime_error(string("HDF5 Error in " )
                                    + err.getFuncName()
                                    + ": "
                                    + err.getDetailMsg());

      }

      return attr0;
  } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-24T10:28:08.173

我不知道 HDF5，但你可以使用

```
struct TempContainer {
    char* string;
}; 
```

然后以这种方式复制字符串：

```
TempContainer t;
t.string = strdup(i->c_str());
tc.push_back (t); 
```

这将分配一个具有确切大小的字符串，并且在从容器中插入或读取时也会有很大的改进（在您的示例中，复制了一个数组，在这种情况下只有一个指针）。您还可以使用 std::vector：

```
std::vector<char *> tc;
...
tc.push_back(strdup(i->c_str()); 
```

# java - 天基建筑？

> ID：581212
> 
> 赞同：14
> 
> 时间：2009-02-24T10:17:51.677
> 
> 标签：java, architecture, jakarta-ee, workflow, rule-engine

Pragmatic Programmer 中的一章建议将黑板/基于空间的架构 + 规则引擎视为传统工作流系统的更灵活替代方案。

我正在处理的项目目前使用工作流引擎，但我想评估替代方案。我真的觉得 SBA 会更好地解决我们的业务问题，但我担心完全缺乏社区支持/用户群/供应商/选项。

JavaSpaces 已经死了，而 JINI 的衍生产品 Apache River 似乎正在获得生命支持。SemiSpace 看起来很完美，但它是一场单人表演。唯一可行的解​​决方案似乎是 GigaSpaces。

我想听听您对基于空间的架构的想法以及您在现实世界实现中的任何经验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T11:27:33.257

为什么你认为 Javaspaces 已经死了，除了 Jini 2.1 版本是很久以前（2005 年 10 月）的事实？使用它后，我建议它表示成熟和完整的技术集，而不是被遗弃和不复存在的东西。

有关 Javaspaces 的另一种实现，请查看[Blitz Javaspaces](http://www.dancres.org/blitz/index.html)。它得到更定期的维护和增强（最新版本 2008 年 7 月），并且提供了比`outrigger`Sun 提供的默认值更高的性能和更易于管理的 Javaspace 实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T14:39:49.183

Gigaspaces 是 JavaSpaces 的成功商业实现——所以，我不会说 JavaSpaces 已死。

您可以查看[Java Shared Data Toolkit](http://java.sun.com/products/java-media/jsdt/)（[也是这篇文章](http://www.ddj.com/184403999)），看看它是否满足您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-14T19:45:49.887

虽然它不支持 JavaSpaces API，但我建议查看 Oracle Coherence 以获得可以驱动基于事件的工作流的分布式且可靠的“实时”数据存储。例如，由于可靠性和性能问题，德意志银行成功地将“SBA”（基于空间的架构）替换为基于 Coherence 的事件驱动系统，用于其外汇交易。

*为了全面披露，我在 Oracle 工作。这篇文章中表达的观点和观点是我自己的，并不一定反映我雇主的观点或观点。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-01T08:35:26.807

基于空间的体系结构是一种分布式计算体系结构，用于使用元组空间范式实现有状态、高性能应用程序的线性可伸缩性。在基于空间的体系结构中，应用程序由一组自给自足的单元构建而成，称为处理-单位。例如：Gigaspaces 在这里我附上了 gigaspaces 的参考。 [https://docs.gigaspaces.com/latest/overview/space-based-architecture.html](https://docs.gigaspaces.com/latest/overview/space-based-architecture.html)

# c# - DataGridView - 在列中设置对象的显示值

> ID：581217
> 
> 赞同：3
> 
> 时间：2009-02-24T10:19:18.663
> 
> 标签：c#, .net, datagridview

我将一些集合绑定到**DataGridView**。Collection 包含**KeyValuePair**对象，其中键是字符串，值是我的类**Field**的对象。**DataGridView**显示两列 - 一列包含键，另一列包含值。值（**Field**对象）与其**ToString** () 方法一起显示。但我希望使用它的 Name 属性来显示它。问题是该列不包含**DisplayMember**属性。
我该怎么做？

编辑：我知道我可以覆盖 ToString() 以返回对象的名称，但我不想这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T10:24:42.690

`DataGridView`（与大多数直接基于列表的绑定相同）只能绑定到行项的直接属性。您也许可以为此创建一个外观对象？即接受实例并将名称作为直接属性返回的类：

```
public string Name {
    get {return innerObject.Name;}
    set {innerObject.Name = value;}
}
// snipped: other properties - Key etc 
```

或者，您可以投影到一个新对象中？例如，数据绑定（至少是只读的）对匿名类型非常有效：

```
grid.DataSource = originalData.Select(x=>
    new {x.Key, Name = x.Field.Name}).ToList(); 
```

最后，您可以在运行时破解`ComponentModel`模型以展平模型，但仅仅为此**真的不值得。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T22:58:08.027

您可以将 DataGridView 置于虚拟模式 (view.VirtualMode = true)，并处理 CellValueNeeded（可能还有 CellValuePushed）事件以访问“Name”属性。这将避免创建大量包装对象，但确实会使代码不那么优雅。

# windows - 找出谁在网络共享上锁定文件

> ID：581219
> 
> 赞同：149
> 
> 时间：2009-02-24T10:19:20.503
> 
> 标签：windows, locking

我想知道谁将文件锁定在网络共享上。

问题是：网络共享在 NAS 上，所以我无法登录。我需要一个工具来远程找出谁在锁定文件。每次都重启 NAS 是不切实际的，因为有几个用户。

[Handle.exe](https://stackoverflow.com/questions/241178/command-line-tool-for-finding-out-who-is-locking-a-file)， Process Explorer 和[PsFile](https://stackoverflow.com/questions/208283/is-it-possible-to-programatically-find-out-what-process-is-locking-a-file-acros)似乎仅限于本地计算机上的文件，因此它们对我不起作用。

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2009-10-12T11:38:14.427

以防万一有人为基于 Windows 的系统或 NAS 寻找解决方案：

Windows 中有一个内置函数，可以显示本地计算机上的哪些文件被远程计算机打开/锁定（通过文件共享打开文件）：

*   选择“管理计算机”（打开“计算机管理”）
*   点击“共享文件夹”
*   选择“打开文件”

在那里你甚至可以强行关闭文件。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-12-21T17:08:56.040

在 Windows 2008 R2 服务器上，您有两种方法可以查看打开的文件和关闭这些连接。

**通过共享和存储管理**

服务器管理器 > 角色 > 文件服务 > 共享和存储管理 > 右键单击​​ SaSM > 管理打开的文件

**通过 OpenFiles**

CMD > Openfiles.exe /query /s SERVERNAME

请参阅[http://technet.microsoft.com/en-us/library/bb490961.aspx](http://technet.microsoft.com/en-us/library/bb490961.aspx)。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-05-21T15:38:28.850

[PsFile](http://technet.microsoft.com/en-us/sysinternals/bb897552.aspx)确实可以在远程机器上工作。如果我的登录帐户已经可以访问远程共享，我可以输入：

```
psfile \\remote-share 
```

（将“remote-share”替换为您的文件服务器的名称）它会列出该共享上每个打开的文档，以及打开它的人，以及如果我想强制关闭文件的文件 ID。对我来说，这是一个很长的列表，但可以通过输入路径的一部分来缩小范围：

```
psfile \\remote-share I:\\Human_Resources 
```

这有点棘手，因为在我的情况下，这个远程共享安装为 Z: 在我的本地计算机上，但是 psfile 识别路径，因为它们是在远程文件服务器上定义的，在我的情况下是 I: （你的会不同） . 我只需要梳理我第一次运行 psfile 的结果以查看它返回的一些路径，然后使用部分路径再次运行它以缩小结果范围。

或者，如果您需要提供远程共享凭据以供访问，PsFile 将允许您为远程共享指定凭据。

最后，一个鲜为人知的提示：如果有人在 Windows 资源管理器中单击文件并剪切或复制该文件并打算将其粘贴到其他位置，那么该行为也会锁定该文件。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-05-10T11:23:27.740

如果只是在任何特定时间了解/查看文件中的人员（如果您使用的是 Windows），只需选择文件“视图”作为“详细信息”，即而不是缩略图、图块或图标等。一次在“详细信息”视图中，默认情况下会显示您；- 文件名 - 大小 - 类型，以及 - 修改日期

您现在需要做的就是右键单击所述工具栏上的任意位置（文件名、大小、类型等...），您将获得工具栏可以显示的其他选项列表。

选择“所有者”，一个新列将显示使用该文件的人的用户名，或者如果没有其他人使用它，则显示最初创建该文件的人的用户名。

这在使用共享 MS Access 数据库时特别有用。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-24T10:46:10.580

会话由 NAS 设备处理。您要问的内容取决于 NAS 设备，与 Windows 无关。您必须查看您的 NAS 固件才能了解它支持的内容。唯一的另一种方法是嗅探数据包并自己解决。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-24T12:53:57.650

**部分答案：使用 Process Explorer，您可以查看从您的机器打开**的网络共享上的句柄。

使用菜单“查找句柄”，然后您可以键入这样的路径

```
\Device\LanmanRedirector\server\share\ 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-24T11:40:59.027

听起来你有同样的问题，我试图在[这里](https://stackoverflow.com/questions/142007/force-a-samba-process-to-close-a-file)解决。就我而言，它是一个 Linux 文件服务器（当然是运行 samba），所以我可以登录并查看锁定文件的进程；不幸的是，我还没有找到如何在不终止负责会话的情况下关闭它。AFAICT，Windows 客户端“认为”它已关闭；但没有打扰告诉文件服务器。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-12-21T18:43:18.930

关闭文件`e:\gestion\yourfile.dat`，由任何用户打开 ( `/a *`)

```
openfiles /disconnect /a * /op "e:\gestion\yourfile.dat" 
```

更多内容： http: [//dosprompt.info/commands/openfiles.asp](http://dosprompt.info/commands/openfiles.asp)

# svn - 什么是工作副本，在 Tortoise SVN 中“切换”对我有什么作用？

> ID：581220
> 
> 赞同：61
> 
> 时间：2009-02-24T10:19:26.337
> 
> 标签：svn, tortoisesvn, working-copy, svn-switch

我有一个软件应用程序，我已经达到了一个重要的里程碑，2.0 版。

我决定将此版本标记为“2.0 版”，因此我命名了此快照。我还创建了一个“2.0 版”分支，以防我需要修复任何东西并将其合并回我的主干。

阅读 Tortoise SVN 帮助文件后，它通知我可以将“工作副本”切换到新创建的分支。

这是什么意思？

目前，我有：

> /Project/Trunk/
> /Project/Tags/
> /Project/Branches/

都签了。那么“切换”的意义何在？目前，我只是去我的 /trunk 文件夹做我的工作。当我创建标签和分支时，它会在我更新后在我的 /Tags/ 和 /Branches/ 文件夹中创建文件夹。

如果我愿意，我为什么不直接去 /Branches/Experimental-v3.0/ 并在那里做我的工作？

**有人可以向我解释“工作副本”和“切换”的概念吗？我错过了什么？人们通常不会检查整个存储库，是这样吗？**

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-02-24T10:30:23.817

工作副本是您已签出到工作区的副本。不管是树枝还是树干。这就是你正在做的事情。

您可以使用 svn switch 在同一父级的分支（或更正确的副本）之间切换。这基本上会说，当前工作副本和我切换到的分支之间有什么不同。然后它会在您当前的工作副本上执行更新到您切换到的分支的修订版。

因此，工作副本是您的结帐，无论它是如何获得的。

切换只是更改您的工作副本提交的分支。可以将其想象为更改提交所在的存储库中的指针。借助获取从分支机构到您的工作区域的任何差异。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-24T10:35:46.610

通常不需要检查整个存储库。subversion 中的分支和标签旨在廉价——即，它们不会创建相同文件的副本，只是引用它们。当您检查了整个存储库时，当任何人出于任何原因进行分支或标记时，它会突然增加本地硬盘驱动器上使用的空间。

您可以根据需要签出存储库的任意多个部分。因此，您可以有一个名为“trunk”的文件夹，它只是主干的工作副本，另一个“version2”将是您的分支的工作副本。这样，创建的任何附加标签都不会被检出。

或者你可以有一个名为“项目”的结帐，如果它最初指向主干，你可以将它切换到一个分支或标签——这是一种重新使用原始结帐的方式，这样你就不必得到一切从头再来。

当你在主干上工作并突然意识到你需要将你的更改提交到一个分支时，这样做是非常有用的——也许是因为它们太实验性了。为此，从您的工作副本分支，切换到新分支然后提交，您的更改将转到分支而不是主干。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-24T10:28:04.710

工作副本是您已签出的代码副本。通常，您只检查 /Project/trunk/，而不是存储库的整个结构。切换正在更改您的工作副本的根。您使用 SVN 的方式不是应该如何完成的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-24T10:26:23.340

您的工作副本是硬盘驱动器上用于从 subbversion 签出项目的任何文件夹。您可以为该工作副本“切换”到不同的项目，以便版本控制的内容类似于该其他项目的内容。

这对于从主干切换到分支很有用，而无需签出新副本。例如，它可以为您节省一些构建时间，因为未删除或更改未版本化的文件（您的编译对象、库、可执行文件）。

戴夫

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T10:32:26.463

您已经检查了整个项目树 - 这可能不是您想要的。对于主干工作，请查看以“主干”为根的副本，而不是从项目根目录。同样，对于分支工作，只签出您想要的分支。

# vba - 在 MS-Access VBA 代码中取消了 Openform 操作

> ID：581223
> 
> 赞同：0
> 
> 时间：2009-02-24T10:20:23.403
> 
> 标签：vba, ms-access

我支持一个运行了 3 年的应用程序。它完全在 MS Access 中开发并用 VBA 编写。

突然，应用程序在以下几行面临上述错误：

```
DoCmd.OpenForm FormName:="frmNewPeerGroup", View:=acNormal, windowmode:=acWindowNormal, OpenArgs:=5 
```

FrmNewPeerGroup 代码

```
Private Sub Form_Open(取消为整数)

    Dim lDept As Long, lDiv As Long

    lType = OpenArgs '由调用者提供
    lAssmtVer = 1 '当前
    sName = ""
    s描述 = ""
    dtCreatedDate = 格式（现在（），“dd/mm/yyyy”）
    sCreatedBy = UCase(userPerms.NTLoginName)
    lSupervisorID = userPerms.userID
    l 团队 = 0

    使用 cmbBxType
        .RowSourceType = "值列表"
        .RowSource = GetValueListDict(pgType)
        .Value = lType
        .Enabled = (OpenArgs = 1)
    结束于
    使用 cmbBxVersion
        .RowSourceType = "值列表"
        .RowSource = GetValueListDict(pgAssmtType)
        .Value = lAssmtVer
    结束于

    mgLogoDesc.Visible = False
    txtBxCreatedDate.Value = dtCreatedDate
    txtBxCreatedBy.Value = sCreatedBy

    如果 OpenArgs = 5 那么
        lTeam = oActiveAssmt.TeamID
        lDept = GetParentID(aTeams(), CInt(lTeam))
        lDiv = GetParentID(aDepts(), CInt(lDept))
        与 cmbBxDivision
            .RowSourceType = "值列表"
            .RowSource = GetValueListArray(aDivs())
            .Value = lDiv
            .启用 = 假
        结束于
        与 cmbBx 部门
            .RowSourceType = "值列表"
            .RowSource = GetValueListArray(aDepts())
            .Value = lDept
            .启用 = 假
        结束于
        与 cmbBxTeam
            .RowSourceType = "值列表"
            .RowSource = GetValueListArray(aTeams())
            .Value = lTeam
            .启用 = 假
        结束于
    别的
        与 cmbBxDivision
            .RowSourceType = "值列表"
            .RowSource = GetValueListArray(aDivs())
            .启用 = 假
        结束于
        cmbBxDepartment.Enabled = False
        cmbBxTeam.Enabled = False
    万一

结束子

```

该命令的许多实例`DoCmd.OpenForm`都在消息框中给出错误消息：

```
您输入的表达式 On Click 作为事件属性设置
产生以下错误： OpenForm 操作已取消。

- 表达式可能不会导致宏的名称，
  用户定义的函数，或 [事件过程]。
- 评估函数、事件或宏时可能出错。

```

这是我收到的错误消息。

我的问题是，相同的代码运行了大约 3 年，但突然对 Microsoft 或 Office 的一些更新可能会给此代码带来麻烦。

过去几周有没有人遇到过这个错误？请让我知道我们还能做些什么来使这项工作再次发挥作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-04-25T06:06:12.460

这个线程很老，但我遇到了同样的错误，花了几个小时寻找答案。一段时间后，我能够找到原因并考虑发布我的答案，因为它可能会帮助处于类似情况的人。使用 Access Forms 创建应用程序对我来说是新事物，因此错误消息并不直接直观。

我的表单是主表数据输入表单，并配置为`Pop-up`使用`Modal`按钮（事件）在命令中`Me.Form.Name`作为参数发送，该按钮（事件）放置在事务表单上的 Combo 控件旁边，以允许用户快速添加新记录。该参数值是在事件中获取的，稍后在使用弹出表单将数据提交到主表后用于刷新组合框 ( )。`DoCmd.OpenForm``OnClick``Form_Open(Cancel As Integer)``Forms!<formname>.Controls!<controlname>.Requery`

当您激活已打开的表单时，似乎不会发生 Open 事件（参考：[https](https://msdn.microsoft.com/en-us/library/office/aa211439(v=office.11).aspx) ://msdn.microsoft.com/en-us/library/office/aa211439(v=office.11​​).aspx ） . 每次我收到错误时，我的数据输入表单都会在 Access 的设计视图中打开。所以我在设计模式下关闭了表单，并重复了这些步骤。瞧！没有错误！

由于我将打开多个表单，因此我现在需要`Form_Activate()`按照上述 MSDN 参考链接中的建议进行测试并尝试使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T10:24:25.873

难道是安全设置是访问？所有最新版本的 Access 都有一个安全设置对话框，您可以在其中启用（或禁用）应用程序中的宏。我*认为*如果禁用宏，您会收到此错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T10:27:09.143

frmNewPeerGroup 表格上的代码是什么？您使用的是哪个版本的 Access？如果是 2003，则 sp3 会导致存在修补程序的问题。您是否尝试过反编译和/或压缩和修复？

如果您有原始 mdb，请检查参考以确保它们都没有标记为 MISSING。这很可能是问题的原因，因为它是突然发生的。

**要检查参考，请查看代码窗口菜单上的工具->参考。**

如果没有缺少任何引用，您可以尝试单步执行表单代码以更准确地了解错误发生的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T11:26:00.903

*   您确定没有缺少所需的参考资料之一（VBA IDE > 选项 > 参考资料）吗？

*   如果您引用 Excel/Word 或外部对象，您确定对类型库的引用是正确的（如果您使用特定版本而不是[后期绑定](http://www.granite.ab.ca/access/latebinding.htm)）

*   您是否有机会在 64 位机器上构建 MDE？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T05:26:17.617

我不知道这是否可以作为答案，但 OnOpen 事件中的代码依赖于许多外部函数。具体来说，代码为一堆组合框的 RowSources 分配值列表。我立即想到的危险信号是非 SQL 行源的长度是有限的，而在 Access 97 中，该限制是 2048 个字符（在 Access 2003 中，它是 32,750——不要问我为什么是*这个*数字！）。

因此，我立即看到的是，驱动创建这些值列表的函数的数据可能已经开始超过 2048 个字符的长度。

如果这是实际答案，那么您可以编写一个回调函数来返回数组中的值，并且它不会对返回的长度有限制。您将 RowsourceType 设置为回调函数的名称，并将 Rowsource 属性留空。

在 A97 帮助中找到了回调函数的示例（尽管我在 A2K3 帮助中找不到相同的示例）。在 A97 帮助中，您可以通过搜索 RowsourceType 到达那里，然后在帮助窗口中，单击“您也可以使用____用户定义的函数____设置 RowSourceType 属性”句子中的链接。

要检查这一点，您只需找出 OnOpen 事件中引用的每个数组从 GetValueListArray() 返回的字符串的长度。

向 OnOpen 事件添加错误处理程序也可能会有所帮助，特别是考虑到该特定子代码中的代码中有如此多的外部依赖项。

最后，让我说它看起来像可怕的编程。在我看来，其中大部分应该可以使用默认属性进行设置。我还质疑这种对 OpenArgs 的依赖以及这种未记录的输入值。“5”是什么意思？“1”是什么意思？这在某处有记录吗？在我看来，这只是可怕的、糟糕的代码。

我可能会用一个独立的类模块来代替，因为这将在做什么方面是自我记录的。您将一个特定的命名属性设置为 5，这将控制表单从用于填充组合框的类模块方法中获取的内容。这一切都在一个地方，您可以使用有意义的属性名称来明确值 5 和 1 代表什么。如果您在多个表单的 OnOpen 事件中具有相同类型的代码，则这样做特别有帮助。在这种情况下，将其从表单模块中移出是不费吹灰之力的，唯一的问题是您是将它放在常规模块中还是放在独立类模块中（正如我所建议的那样）。

无论如何，也许这些都不是重点，但它可能会给你一些想法。

# asp.net - 如何重新分发 aspnet_regsql.exe？

> ID：581228
> 
> 赞同：0
> 
> 时间：2009-02-24T10:23:41.787
> 
> 标签：asp.net

我正在为我的 ASP.NET 网站编写一个安装程序，我需要将 aspnet_regsql 工具用于注册/取消注册成员资格/角色表到我的数据库中。

如果我将它与我的设置捆绑在一起，我需要包含哪些依赖文件以确保一切正常？

或者最好不要捆绑它，而是在运行时找到 .NET Framework 文件夹并从那里启动它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T10:28:31.683

您不应该分发它，您应该在适当的框架运行时使用 find 它并从那里使用它。

可能是 SP 和修补程序补丁可能会稍微修改文件以适应对其所属框架的其他调整。如果您在您的发行版中包含一个版本，它可能与客户端计算机上的框架修订不同步。

好的，在这种情况下实际上不太可能，但最好不要重新分发应该在预安装框架中的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T10:31:16.183

最好不要捆绑它，而是找到 .NET Framework 文件夹并启动它。请参阅[如何获取 .NET Framework 目录](http://nerddawg.blogspot.com/2006/10/how-do-i-get-net-framework-directory.html)以了解它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T10:32:26.977

使用我们值得信赖的朋友 Reflector，它引用了：

*   mscorlib
*   系统
*   系统数据
*   系统绘图
*   系统.Web
*   System.Windows.Forms
*   advapi32.dll
*   kernel32.dll

所以没什么特别的，只是 .NET 框架。我的 .exe 位于

```
C:\Windows\winsxs\x86_aspnet_regsql_b03f5f7f11d50a3a_6.0.6000.16720_none_50001be1bbe18d26 
```

所以从框架目录启动可能不起作用（或者我的机器安装奇怪）。

这是它引用的表，来自 SqlCacheDependencyAdmin

```
internal const string SQL_CREATE_ENABLE_DATABASE_SP = "/* Create notification table */ \nIF NOT EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{0}' AND type = 'U') \n   IF NOT EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{0}' AND type = 'U') \n      CREATE TABLE dbo.{0} (\n      tableName             NVARCHAR(450) NOT NULL PRIMARY KEY,\n      notificationCreated   DATETIME NOT NULL DEFAULT(GETDATE()),\n      changeId              INT NOT NULL DEFAULT(0)\n      )\n\n/* Create polling SP */\nIF NOT EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{1}' AND type = 'P') \n   IF NOT EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{1}' AND type = 'P') \n   EXEC('CREATE PROCEDURE dbo.{1} AS\n         SELECT tableName, changeId FROM dbo.{0}\n         RETURN 0')\n\n/* Create SP for registering a table. */ \nIF NOT EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{2}' AND type = 'P') \n   IF NOT EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{2}' AND type = 'P') \n   EXEC('CREATE PROCEDURE dbo.{2} \n             @tableName NVARCHAR(450) \n         AS\n         BEGIN\n\n         DECLARE @triggerName AS NVARCHAR(3000) \n         DECLARE @fullTriggerName AS NVARCHAR(3000)\n         DECLARE @canonTableName NVARCHAR(3000) \n         DECLARE @quotedTableName NVARCHAR(3000) \n\n         /* Create the trigger name */ \n         SET @triggerName = REPLACE(@tableName, ''['', ''__o__'') \n         SET @triggerName = REPLACE(@triggerName, '']'', ''__c__'') \n         SET @triggerName = @triggerName + ''{3}'' \n         SET @fullTriggerName = ''dbo.['' + @triggerName + '']'' \n\n         /* Create the cannonicalized table name for trigger creation */ \n         /* Do not touch it if the name contains other delimiters */ \n         IF (CHARINDEX(''.'', @tableName) <> 0 OR \n             CHARINDEX(''['', @tableName) <> 0 OR \n             CHARINDEX('']'', @tableName) <> 0) \n             SET @canonTableName = @tableName \n         ELSE \n             SET @canonTableName = ''['' + @tableName + '']'' \n\n         /* First make sure the table exists */ \n         IF (SELECT OBJECT_ID(@tableName, ''U'')) IS NULL \n         BEGIN \n             RAISERROR (''00000001'', 16, 1) \n             RETURN \n         END \n\n         BEGIN TRAN\n         /* Insert the value into the notification table */ \n         IF NOT EXISTS (SELECT tableName FROM dbo.{0} WITH (NOLOCK) WHERE tableName = @tableName) \n             IF NOT EXISTS (SELECT tableName FROM dbo.{0} WITH (TABLOCKX) WHERE tableName = @tableName) \n                 INSERT  dbo.{0} \n                 VALUES (@tableName, GETDATE(), 0)\n\n         /* Create the trigger */ \n         SET @quotedTableName = QUOTENAME(@tableName, '''''''') \n         IF NOT EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = @triggerName AND type = ''TR'') \n             IF NOT EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = @triggerName AND type = ''TR'') \n                 EXEC(''CREATE TRIGGER '' + @fullTriggerName + '' ON '' + @canonTableName +''\n                       FOR INSERT, UPDATE, DELETE AS BEGIN\n                       SET NOCOUNT ON\n                       EXEC dbo.{6} N'' + @quotedTableName + ''\n                       END\n                       '')\n         COMMIT TRAN\n         END\n   ')\n\n/* Create SP for updating the change Id of a table. */ \nIF NOT EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{6}' AND type = 'P') \n   IF NOT EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{6}' AND type = 'P') \n   EXEC('CREATE PROCEDURE dbo.{6} \n             @tableName NVARCHAR(450) \n         AS\n\n         BEGIN \n             UPDATE dbo.{0} WITH (ROWLOCK) SET changeId = changeId + 1 \n             WHERE tableName = @tableName\n         END\n   ')\n\n/* Create SP for unregistering a table. */ \nIF NOT EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{4}' AND type = 'P') \n   IF NOT EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{4}' AND type = 'P') \n   EXEC('CREATE PROCEDURE dbo.{4} \n             @tableName NVARCHAR(450) \n         AS\n         BEGIN\n\n         BEGIN TRAN\n         DECLARE @triggerName AS NVARCHAR(3000) \n         DECLARE @fullTriggerName AS NVARCHAR(3000)\n         SET @triggerName = REPLACE(@tableName, ''['', ''__o__'') \n         SET @triggerName = REPLACE(@triggerName, '']'', ''__c__'') \n         SET @triggerName = @triggerName + ''{3}'' \n         SET @fullTriggerName = ''dbo.['' + @triggerName + '']'' \n\n         /* Remove the table-row from the notification table */ \n         IF EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = ''{0}'' AND type = ''U'') \n             IF EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = ''{0}'' AND type = ''U'') \n             DELETE FROM dbo.{0} WHERE tableName = @tableName \n\n         /* Remove the trigger */ \n         IF EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = @triggerName AND type = ''TR'') \n             IF EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = @triggerName AND type = ''TR'') \n             EXEC(''DROP TRIGGER '' + @fullTriggerName) \n\n         COMMIT TRAN\n         END\n   ')\n\n/* Create SP for querying all registered table */ \nIF NOT EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{5}' AND type = 'P') \n   IF NOT EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{5}' AND type = 'P') \n   EXEC('CREATE PROCEDURE dbo.{5} \n         AS\n         SELECT tableName FROM dbo.{0}   ')\n\n/* Create roles and grant them access to SP  */ \nIF NOT EXISTS (SELECT name FROM sysusers WHERE issqlrole = 1 AND name = N'aspnet_ChangeNotification_ReceiveNotificationsOnlyAccess') \n    EXEC sp_addrole N'aspnet_ChangeNotification_ReceiveNotificationsOnlyAccess' \n\nGRANT EXECUTE ON dbo.{1} to aspnet_ChangeNotification_ReceiveNotificationsOnlyAccess\n\n";
    internal const string SQL_DISABLE_DATABASE = "/* Remove notification table */ \nIF EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{0}' AND type = 'U') \n    IF EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{0}' AND type = 'U') \n    BEGIN\n      /* First, unregister all registered tables */ \n      DECLARE tables_cursor CURSOR FOR \n      SELECT tableName FROM dbo.{0} \n      DECLARE @tableName AS NVARCHAR(450) \n\n      OPEN tables_cursor \n\n      /* Perform the first fetch. */ \n      FETCH NEXT FROM tables_cursor INTO @tableName \n\n      /* Check @@FETCH_STATUS to see if there are any more rows to fetch. */ \n      WHILE @@FETCH_STATUS = 0 \n      BEGIN \n          EXEC {3} @tableName \n\n          /* This is executed as long as the previous fetch succeeds. */ \n          FETCH NEXT FROM tables_cursor INTO @tableName \n      END \n      CLOSE tables_cursor \n      DEALLOCATE tables_cursor \n\n      /* Drop the table */\n      DROP TABLE dbo.{0} \n    END\n\n/* Remove polling SP */ \nIF EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{1}' AND type = 'P') \n    IF EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{1}' AND type = 'P') \n      DROP PROCEDURE dbo.{1} \n\n/* Remove SP that registers a table */ \nIF EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{2}' AND type = 'P') \n    IF EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{2}' AND type = 'P') \n      DROP PROCEDURE dbo.{2} \n\n/* Remove SP that unregisters a table */ \nIF EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{3}' AND type = 'P') \n    IF EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{3}' AND type = 'P') \n      DROP PROCEDURE dbo.{3} \n\n/* Remove SP that querys the registered table */ \nIF EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{4}' AND type = 'P') \n    IF EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{4}' AND type = 'P') \n      DROP PROCEDURE dbo.{4} \n\n/* Remove SP that updates the change Id of a table. */ \nIF EXISTS (SELECT name FROM sysobjects WITH (NOLOCK) WHERE name = '{5}' AND type = 'P') \n    IF EXISTS (SELECT name FROM sysobjects WITH (TABLOCKX) WHERE name = '{5}' AND type = 'P') \n      DROP PROCEDURE dbo.{5} \n\n/* Drop roles */ \nIF EXISTS ( SELECT name FROM sysusers WHERE issqlrole = 1 AND name = 'aspnet_ChangeNotification_ReceiveNotificationsOnlyAccess') BEGIN\nCREATE TABLE #aspnet_RoleMembers \n( \n    Group_name      sysname, \n    Group_id        smallint, \n    Users_in_group  sysname, \n    User_id         smallint \n) \nINSERT INTO #aspnet_RoleMembers \nEXEC sp_helpuser 'aspnet_ChangeNotification_ReceiveNotificationsOnlyAccess' \n \nDECLARE @user_id smallint \nDECLARE @cmd nvarchar(500) \nDECLARE c1 CURSOR FORWARD_ONLY FOR  \n    SELECT User_id FROM #aspnet_RoleMembers \n  \nOPEN c1 \n  \nFETCH c1 INTO @user_id \nWHILE (@@fetch_status = 0)  \nBEGIN \n    SET @cmd = 'EXEC sp_droprolemember ''aspnet_ChangeNotification_ReceiveNotificationsOnlyAccess'',''' + USER_NAME(@user_id) + '''' \n    EXEC (@cmd) \n    FETCH c1 INTO @user_id \nEND \n \nclose c1 \ndeallocate c1 \n    EXEC sp_droprole 'aspnet_ChangeNotification_ReceiveNotificationsOnlyAccess'\nEND\n";
    internal const string SQL_QUERY_REGISTERED_TABLES_SP = "AspNet_SqlCacheQueryRegisteredTablesStoredProcedure";
    internal const string SQL_QUERY_REGISTERED_TABLES_SP_DBO = "dbo.AspNet_SqlCacheQueryRegisteredTablesStoredProcedure";
    internal const string SQL_REGISTER_TABLE_SP = "AspNet_SqlCacheRegisterTableStoredProcedure";
    internal const string SQL_REGISTER_TABLE_SP_DBO = "dbo.AspNet_SqlCacheRegisterTableStoredProcedure";
    internal const string SQL_TRIGGER_NAME_POSTFIX = "_AspNet_SqlCacheNotification_Trigger";
    internal const string SQL_UNREGISTER_TABLE_SP = "AspNet_SqlCacheUnRegisterTableStoredProcedure";
    internal const string SQL_UNREGISTER_TABLE_SP_DBO = "dbo.AspNet_SqlCacheUnRegisterTableStoredProcedure";
    internal const string SQL_UPDATE_CHANGE_ID_SP = "AspNet_SqlCacheUpdateChangeIdStoredProcedure"; 
```

# javascript - 对象原型方法中私有变量的作用域

> ID：581239
> 
> 赞同：1
> 
> 时间：2009-02-24T10:28:00.373
> 
> 标签：javascript, prototype, scoping

这个问题是关于一个对象的行为，它的原型链中添加了方法和一些私有变量。只是出于好奇，想弄清楚这个谜语。

```
function SomeObject() {
    if (this instanceof SomeObject) {
      var args  = arguments[0],
          proto = SomeObject.prototype,
          privatevalue = 0,
      /** assign first element of args[0] 
        * (=instance name) to private variable [id],
        * to be able to keep track of the instance
        */
          id = args[0] ||'no id';

      /** public 'set' adds a value to
        * the private variable [privatevalue]
        */
      this.set =
         function(){
           privatevalue += arguments[0] || 1;
           return privatevalue;
          };
       /** toString functions as a kind of getter */
       this.toString = function(){
            return id+' privatevalue: '+privatevalue;
       }

       /** add two methods to the prototype chain 
         * this happens only once
         */
       if (!proto._initialized_) {
         /** SomeObject.prototype.add 
           * uses 'this.set' to add a value
           * to [privatevalue] and returns
           * the object value (from tostring)
           */
         proto.add =
           function(){
             this.set(arguments[0]);
             return this;
         };
         /** SomeObject.prototype.add2 
           * uses 'this.set' to add a value
           * to [privatevalue] but returns
           * a string using private variables
           * [id] and [privatevalue] 
           */
         proto.add2 =
            function(){
              this.set(arguments[0]);
              return id+' privatevalue: '+privatevalue;
         };
         proto._initialized_ = true;
        }

        } else {
           return new SomeObject(Array.prototype.slice.call(arguments));
        }
  }

  /** create 2 instances of SomeObject */
  var objA = SomeObject('objA'),
      objB = SomeObject('objB');

  /** show the values and use the prototype [add] method
    * to change [privatevalue]
    */
  alert ([objA, objB].join(' | ')); 
        //=> objA privatevalue: 0 | objB privatevalue: 0
  alert ([objA.add(4), objB.add(2)].join(' | ')); 
         //=> objA privatevalue: 4 | objB privatevalue: 2

  /** use prototype method 'add2' to change and view the
    * private variables [id] and [privatevalue] for objA
    */
  alert (objA.add2()); 
         //=> objB privatevalue: 2! 
```

现在的问题是：为什么来自 ojbA 的原型方法 add2（因此：objA.add2()）返回来自 objB 的私有变量的值？我会说这些私人不应该被 objA 访问。换句话说：这里发生了什么样的范围界定？还是陌生的。如果你这样做：

```
 alert (objA.add2()); 
  alert (objB.add2()); 
```

你得到 objA.add2():`objA privatevalue: 5`和 objB.add():`objA privatevalue: 5`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T10:41:41.870

问题是您创建添加函数的范围。

当您实例化“objA”时，它们是在 SomeObject 执行范围内创建的。

因此，无论您将 .Add2 称为“objA”还是“objB”，Add2 访问的 id 和 privatevalue 变量都是属于“objA”的变量。

基本上基于原型的方法不能访问类的私有成员。为了访问私有成员，需要在这些成员的相同范围（或子范围）中创建一个函数。这就是为什么 set 起作用的原因，因为它是在 SomeObject 的每个实例上创建的。

# c# - C++ 程序中的 C# 表单

> ID：581245
> 
> 赞同：0
> 
> 时间：2009-02-24T10:30:25.657
> 
> 标签：c#, .net, c++-cli

在我的最后一个问题中，我询问了有关在 C++-cli 程序中运行 C# 表单的问题。我得到了它的工作，但我遇到了问题。我会尽量简短。

我的 C++ 程序必须执行一个 C# 表单并在其中执行一些简单的功能（增加计数器并显示它们）。但是我不知道最好的方法来做到这一点。我在 init 函数中初始化了表单：

C++-cli

```
SUTAdapter::Form1^ *ptForm1; // Global variable 
```

...

```
FormProject::Form1^ form1;
form1 = gcnew FormProject::Form1();
ptForm1 = &form1;
(*ptForm1)->Show();
(*ptForm1)->incCounter(0); 
```

C++ 程序中的一些其他函数只是调用incCounter。我的问题是，从另一个函数对 incCounter 的第二次调用使我的 C# Form1 为空（this == null），因此我可以使用 incCounter 的函数代码，但不能使用类变量。很奇怪，好像程序处理了FormProject。

C＃

```
public void incCounter(int counter)
{
  int param1 = counter;
  this.count[counter]++; // this == null in sucessive calls from c++ program
} 
```

我究竟做错了什么？我实际上已经禁用了表单，只使用了函数和变量，以防问题出在 UI 上（调用等）。退出 C++ 初始化函数（第一块代码）是否清除 Form1？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T00:36:49.897

如果您必须获取托管堆上的 .NET 对象的地址，请将其放入[pin_ptr<>](http://msdn.microsoft.com/en-us/library/1dz8byfh.aspx)以便 GC 不会移动它。这可能是你问题的根源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T14:33:59.923

I think you should just be storing the handle in a global (i.e. static) object, or at least a static field of a convenient class to use. Like danbystrom said, keeping a pointer to the Form reference will not prevent the garbage collector from reclaiming the form once the original handle goes null.

```
static ref class Globals
{
    static FormProject::Form1^ MyForm;
}

// Later on...
Globals::MyForm = form1;
form1->DoStuff();
form1 = nullptr;

// Globals::MyForms still exists! 
```

Though I suspect the Form reference going null means something else is wrong too.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T10:45:42.903

我的*猜测*是 *ptForm1 不足以让 CLR 将其视为参考。也许它应该是 Form1^^ ptForm，而不是？或者你为什么不把 form1 变量作为你全局插入的指针？

# java - 列出序列化数据中的 serialVersionUID

> ID：581246
> 
> 赞同：1
> 
> 时间：2009-02-24T10:30:38.947
> 
> 标签：java, serialization

我有一个包含序列化 Java 类的文件。我想解析这个文件以获得文件中的类列表和每个类的serialVersionUID。

是否有任何人可以推荐的工具来执行此操作，或者有人可以提供一些关于我应该自己开始完成此操作的指示？

干杯

富有的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T10:51:25.823

我不知道是否已经有这样的工具（如果您可以访问类本身，[serialver](http://java.sun.com/j2se/1.4.2/docs/tooldocs/solaris/serialver.html)工具可以告诉您 ID），但如果您需要自己推出，Sun 的[序列化规范](http://java.sun.com/javase/6/docs/platform/serialization/spec/serialTOC.html)应该包含您需要的所有信息- 具体来说，[流格式的语法](http://java.sun.com/javase/6/docs/platform/serialization/spec/protocol.html#10258)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T11:18:53.573

不幸的是，并非所有类（即使在 JDK 中）都遵守序列化规范。尤其`readObject`不总是调用`defaultReadObject`or `readFields`，与中的等价错误`writeObject`。

您可以检测反序列化时正在使用哪些类。`ObjectInputStream`使用`resolveClass`and`resolveProxyClass`将类描述符映射到实际的`Class`es （一些子类你有不同的类加载器查找规则）。

# authentication - 如何离线使用 LDAP 凭据？

> ID：581247
> 
> 赞同：5
> 
> 时间：2009-02-24T10:31:04.873
> 
> 标签：authentication, ldap, kerberos, ldif

我想使用 LDAP 服务器（可能是[Apache 目录](http://directory.apache.org/)）来管理应用程序的登录名和凭据。有时，应用程序需要离线工作（在笔记本电脑上），而无需连接到 LDAP 服务器。

在本地复制凭据的最佳方法是什么？

我已经想过：

*   使用[Mitosis](http://mitosis.safehaus.org/)在笔记本电脑上复制 LDAP 服务器。

    但这将是一个相当“沉重”和复杂的解决方案。而且有丝分裂似乎还没有完成。

*   将凭据导出为可以存储在笔记本电脑上的 LDIF 文件。

    但我需要一种方法来检查 LDIF 文件是否真的来自 LDAP 服务器（该文件应该包含一种签名）。此外，我想拒绝超过一周未更新的 LDIF 文件。如果我可以避免自己实施签名和年龄检查，那就太好了。

还有其他可以帮助我的想法或工具吗？

**编辑编辑：**我查看了 Kerberos，因为[Java-Kerberos-API 的文档](http://java.sun.com/j2se/1.4.2/docs/guide/security/jaas/spec/com/sun/security/auth/module/Krb5LoginModule.html)似乎说可以在本地缓存中使用缓存票证，我认为这可能是我的解决方案。此外，Kerberos 可以作为插件添加到 Apache Directory。但是 Kerberos 缓存存储解密的票据（旨在与其他应用程序共享它们）。我需要票证的加密版本才能在离线会话期间检查用户密码。结论：Kerberos 没有为我的问题提供简单的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-25T23:46:36.780

知道*如果用户必须在线登录一次才能离线登录可能没问题*，请考虑以下算法：

1.  用户为您的应用程序提供`(username + password)`
2.  应用程序尝试联系`LDAP`以进行身份​​验证
    *   *在线工作？（例如连接成功）*
        1.  应用程序使用 LDAP 进行身份验证`(username + password)`
            *   *认证成功？*
                1.  应用程序存储*或更新* `hash(password)`到本地安全存储`(cached_credentials)``(username)`
                2.  应用程序进行**身份验证** **`[[STOP]]`**
            *   *认证失败？*
                1.  应用程序以**未经身份验证的**方式进行（不正确的凭据）**`[[STOP]]`**
    *   *离线工作？（例如网络错误）*
        1.  `(cached_credentials)`应用程序尝试`(username)`从本地安全存储 中检索
            *   *`(cached_credentials)`存在`AND`比`(1 week)`?*
                1.  `(cached_credentials)`应用程序比较`hash(password)`
                    *   *匹配？*
                        1.  应用程序进行**身份验证** **`[[STOP]]`**
                    *   *没有匹配？*
                        1.  应用程序以**未经身份验证的**方式进行（不正确的凭据）**`[[STOP]]`**
            *   *`(cached_credentials)`不存在`OR`比`(1 week)`?*
                1.  应用程序以**未经身份验证的**方式进行（网络错误）**`[[STOP]]`**

顺便说一下，这是（或曾经是 IIRC）Windows NT+ 用于针对域控制器进行用户身份验证的相同模型。登录时会尝试对域控制器进行身份验证，并创建或更新用户配置文件的本地（缓存）版本。如果域控制器不可用，则会提示用户继续对本地（缓存）配置文件（如果存在）中捕获的凭据进行身份验证。

* * *

**编辑**

*   是的，从精神上讲，这与在本地复制 ldif 文件的解决方案相同，只是在离线时不必解析 ldif。:)
*   据了解，您可以在缓存中存储任何附加属性（权限等）
*   还可以理解，“安全存储”至少是签名的。:) 您可以使用 SHA-1 哈希和密钥轻松完成此操作，或者您可以使用平台上可用的成熟加密提供程序（或在 Java 中，如果使用 Java。）您不需要加密它因为里面没有存储任何秘密信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-08T10:13:48.510

这是我决定使用的解决方案（我已经在对我的问题的编辑中对其进行了描述，但我希望能够接受“关闭”问题的答案）：

由于我还没有找到其他解决方案，我决定使用 LDIF 导出，在文件开头添加时间戳作为注释，然后对文件进行签名。为了签署文件，我计算了文件的哈希值 (SHA-1) + 一个密钥。签名作为注释添加到文件的开头。为了检查签名，我删除了签名文件的第一行并重新计算了哈希值。

# java - 学习 Ajax 和 Java 或用 C# 重写

> ID：581257
> 
> 赞同：-1
> 
> 时间：2009-02-24T10:33:53.090
> 
> 标签：java, ajax, web-services, jsp

我有用 Java 编写的后端代码。该代码有大约 12 个类。然而，我在这个项目中编写界面（使用 Ajax）的合作伙伴更熟悉 C# 和 .net。用 Java 学习 Ajax 或用 C# 重写它会更快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T10:46:07.460

这是您正在开放的一个很大的学科领域，您应该去买几本书并进行一些网络研究。

我开始使用[Eclipse Web 工具](http://www.eclipse.org/webtools/)包并且仍然使用它。当时我已经在使用 Eclipse 进行 Java 开发，所以过渡非常顺利。

编辑：天哪，你完全改变了问题！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T11:22:29.180

如果您有一个标准的 Java servlet 基础设施并且没有周边框架，您可能想尝试[直接 Web 远程处理](http://directwebremoting.org/)。它是你的一个额外的 config/.jar`web.xml`和服务器端的其他东西。

它将指定的 Java 对象自动公开为 Javascript 对象，并使您在 AJAX 环境中启用 Java 域对象非常简单（实际上是微不足道的）。

我已经使用它来将现有的 servlet 应用程序迁移到更专注于 AJAX 的解决方案，并且效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T10:52:33.933

直接的 Java 和 Ajax 将涉及一些严肃的 servlet 编程。您可能需要 Web 框架的帮助，即 JSP、Groovy、Tapestry、Wicket、Spring MVC 等。此外，Javascript 库将有助于样板 AJAX 和 DOM 操作的东西，即 jQuery 或 Prototype。缺点是您必须花费时间来学习这些框架，尽管取决于您的 Ajax 的复杂性，我敢打赌您可以在一两天内运行一些东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T20:48:38.087

AJAX 前端不应该知道也不关心后端。前端向控制器发送请求并接收返回的 JSON（XML，...）响应。只需下载一些像样的 AJAX javascript 框架（其中有很多 - jQuery、Prototype、ExtJS 等），它将为您处理所有低级通信内容。

# asp.net - 数据绑定通用集合与数据表，

> ID：581262
> 
> 赞同：0
> 
> 时间：2009-02-24T10:35:48.840
> 
> 标签：asp.net, data-binding, collections, telerik

将对象集合数据绑定到网格（具体来说是telerik gridview）与常规数据表相比，成本有多大，

我不会认为这是一个问题，但我正在通过 web 服务 AJAX 回调进行数据绑定，如果网格有超过 20 行，它开始需要相当长的时间来绑定，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T08:50:48.727

我在某处读到（不记得确切的位置，似乎我的记忆力不太好:)）通常绑定到 DataTable 比绑定到对象集合更耗费资源/时间。

我前段时间使用过 Telerik 网格，并且知道它支持绑定到对象集合甚至子对象的集合。在评估过程中，我找到了一个示例和一个帮助主题，解释了如何微调与集合的绑定，我将它们粘贴在这里：

[演示](http://demos.telerik.com/aspnet-ajax/grid/examples/programming/binding/defaultcs.aspx)

[帮助主题](http://www.telerik.com/help/aspnet-ajax/grdtipswhenbindingtocustomcollections.html)

希望你会发现它们很有用。

迪克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T15:36:20.273

尽管它仅限于 WinForms，但请看一下[BindingListView](http://blw.sourceforge.net/)。它[比使用 DataView/Table 更快](http://blogs.warwick.ac.uk/andrewdavey/entry/bindinglistview_speedy_sorting/)。由于您使用的是 ASP.NET，我怀疑您是否可以直接使用它，但是用 JavaScript 重写类似的东西应该不会太难，特别是因为它是开源的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T15:47:19.013

您绑定到的这些对象有多大？如果这些对象很大并且包含与您将绑定它们的控件无关的数据，那么您就有开销。

换句话说，如果您有一个具有 30 个属性的对象，并且您只使用其中的 2 个来绑定到控件，您将看到性能问题。我认为它`DataTable`更快，因为它只包含您需要的数据。否则，对于相同数量的字段/属性，没有理由比另一个快得多。

# c# - 将人们带到所选页面的下拉列表

> ID：581270
> 
> 赞同：0
> 
> 时间：2009-02-24T10:39:41.080
> 
> 标签：c#, asp.net

我希望人们从下拉列表中进行选择，他们的选择会将他们带到他们选择的页面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T10:44:19.977

在 aspx 中

```
<asp:DropDown ID="MyDropDown" runat="server" AutoPostBack="true" OnSelectedIndexChanged="RedirectUser">
   <asp:ListItem Value="/MyPage.aspx" Text="MyPage"/>
</asp:DropDown> 
```

在后面的代码中

```
protected void RedirectUser(object sender, EventArgs e)
{
   Response.Redirect(MyDropDown.SelectedValue);
} 
```

好的，再次阅读“问题”，您没有指定 ASP.NET，但没关系，问题中的更多细节会有所帮助

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T10:45:05.120

你可以用一些 javascript 来使用这样的东西：

```
<select name='jumpMenu' onchange='javascript:window.location.href = this.value;'>
  <option value='Department.aspx?DeptID=0'>--Department 0</option>
  <option value='Department.aspx?DeptID=1'>--Department 1</option>
  <option value='Department.aspx?DeptID=2'>--Department 2</option>
  <option value='Department.aspx?DeptID=3'>--Department 3</option>
</select> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-30T21:54:50.777

如果使用 ASP.NET MVC 和 Bootstrap，请使用此代码。您所要做的就是将您将使用的控制器命名为“后面没有控制器”以及您将使用的操作“视图”。它应该适合你。此外，如果您不使用 MVC，您可以使用带有 href="" 方法的 < a > 标记来执行相同的操作。希望这会有所帮助，我确实意识到这是一篇旧帖子，但我讨厌找到没有答案的问题。

```
<div class="dropdown">
        <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">Legal Links<span class="caret"></span></button>
        <ul class="dropdown-menu">
            <li><a asp-controller="Disclaimers" asp-action="CopyRight">Copyright</a></li>
            <li><a asp-controller="Disclaimers" asp-action="AcceptUse">Acceptable Use</a></li>
            <li><a role="separator" class="divider"></a></li>
            <li>Terms &amp; Conditions</li>
            <li><a asp-controller="Disclaimers" asp-action="TermsAndConditions">General</a></li>
            <li><a asp-controller="Disclaimers" asp-action="ITTerms">IT Support</a></li>
            <li><a asp-controller="Disclaimers" asp-action="Microsoft">Microsoft Software</a></li>
            <li><a asp-controller="Disclaimers" asp-action="HostingServices">Hosting Services</a></li>
            <li><a asp-controller="Disclaimers" asp-action="ManagedTerms">Managed Services</a></li>
            <li><a asp-controller="Disclaimers" asp-action="Privacy">Privacy Policy</a></li>
        </ul>
    </div> 
```

# asp.net - 业务逻辑层是否应该实现授权和认证？

> ID：581272
> 
> 赞同：11
> 
> 时间：2009-02-24T10:39:56.100
> 
> 标签：asp.net, design-patterns

我有一个业务逻辑层（“存储库”），它被公开为一组由可交换的具体实现支持的 .NET 接口。

最初我让这个业务层实现身份验证和授权（authn/authz），这意味着我有 IUserIdentity 和 IUserRole 等接口，并且所有访问敏感数据的方法都采用 IUserIdentity 并在允许操作之前执行授权。

到目前为止，业务层与前端非常不可知......但是现在当我尝试集成到 ASP.NET 网站时，我意识到 ASP.NET 本身内置了丰富的身份验证/授权系统通过成员资格和角色 API。

那么问题来了，我是否应该从业务逻辑层中移除所有的 authn/authz 并依赖 Web 前端来执行此操作？这会简化很多事情，但我不知道我以后是否会后悔把它搬出去。

另一种方法是将 authn/authz 保留在我的业务逻辑中，但通过自定义 Membership/Role 提供程序将其与 ASP.NET 集成。然而，这似乎真的很麻烦......我仍然需要调查这样做的成本。

你会做什么（或已经做过），为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T10:46:02.920

我认为安全是一个跨领域的问题，属于各个方面。我不知道.NET 是否有方面，除非你使用 Spring.NET。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T10:58:59.223

留着它。ASP.NET 中的表单身份验证非常容易自定义，并且您的业务逻辑层与前端无关。

考虑远离[这种方法](http://msdn.microsoft.com/en-us/library/44w5aswa.aspx)，而是尝试[Forms Authentication](http://msdn.microsoft.com/en-us/library/aa480476.aspx)。基本上，您可以从 Login 控件的 Authenticate 事件中调用已建立的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T11:58:22.387

我建议你保留现有的逻辑，并在你现有的安全类周围编写一个自定义的成员资格/角色提供程序，如果你想直接使用 asp.net 来使用它。这应该比您想象的要容易。

[http://www.codeproject.com/KB/aspnet/customaspnetproviders.aspx](http://www.codeproject.com/KB/aspnet/customaspnetproviders.aspx)

由于您已经拥有用于管理安全权限的类，这仅意味着包装您现有的逻辑。

这也将帮助您以后使用您的安全逻辑，让我们说，当您创建一个使用您的业务逻辑的 Winform 客户端时，或者当您将您的业务逻辑公开为 Web 服务时

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T11:52:18.550

您打算使用多个前端（asp.net、winforms、mobile？），还是通过（Web）服务公开业务层？那么您可能应该在业务层之上实现身份验证。

当您只想授予/拒绝访问权限时，您可以在 IIS 上使用集成安全性，而永远不要为其编写自定义代码。

您还可以查看 asp.net 会员提供程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-30T13:00:30.823

我认为基于角色的安全性应该在 CSLA 所放置的业务层中。

# validation - XHTML 验证、自定义名称空间和属性

> ID：581279
> 
> 赞同：9
> 
> 时间：2009-02-24T10:43:26.157
> 
> 标签：validation, xhtml, namespaces

我有一个客户端要求 XHTML 有效的网站。他们使用 W3C 验证器对其进行检查。

我想添加我自己的命名空间和属性，所以我可以做这样的事情：

```
<div my:userid="123"> ... </div> 
```

据我了解，定义自定义命名空间是完全有效的 XHTML，只要我这样做：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:my="http://www.example.com/my"> 
```

但是，我的 XHTML 验证失败。问题似乎是验证器实际上并没有出去检查我的自定义 DTD 文档是否有我的自定义命名空间，它只检查 XHTML 与已知的 DTD。任何人都能够阐明我如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T11:00:53.820

对于 XHTML 1.0，您只能使用 XHTML 1.0 元素和属性：

[XHTML 1.0 的规范定义](http://www.w3.org/TR/xhtml1/#normative)

> 此版本的 XHTML 提供了严格符合 XHTML 1.0 文档的定义，这些文档仅限于来自 XML 和 XHTML 1.0 名称空间的元素和属性。

我的理解是 XHTML 2.0 旨在提供一个框架来做你想做的事。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T15:21:20.013

> 据我了解，定义自定义命名空间是完全有效的 XHTML

没有。*自定义名称空间在*XML 中格式完美，但“有效”具有特定含义，即使用的每个元素和属性都在文档的模式中声明。该模式可以是 DTD、XML 模式或其他东西，但您必须声明它。

因此，您可以声明自己的模式来为语言添加自定义属性，而 XHTML 模块化确实使这变得非常容易。您必须在序言中添加对 DTD 的引用作为 <!DOCTYPE> ；仅仅设置命名空间 URI 并没有给 XML 处理器提供任何钩子来查找其自身的模式。

但是你写的是“valid my-language-which-is-a-bit-like-XHTML”，而不是“valid XHTML”。其中一些“我的语言”是众所周知的，例如“XHTML+MathML+SVG”，但它仍然不是 XHTML，如果您的客户端死守“有效 XHTML”，您将无法使用其中任何一种。

您还遇到了潜在的浏览器问题，尤其是 IE，它（IE8 之前）对 Element.*etAttribute* 系列 DOM 调用做了一些奇怪的事情。除非您实际上将文档作为 XML Content-Type 提供（IE 也无法处理），否则您的所有命名空间内容实际上并没有使用命名空间。

在 [X]HTML5 中，有一项提议允许用户自定义属性（主要用于脚本目的）进入名称以“data-”开头的属性。但与此同时，通常的方法是将值隐藏在另一个属性中，例如类：

```
<div class="userid-123">...</div> 
```

然后在脚本中对 className 使用合适的字符串处理来提取数据。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T20:02:13.137

> 我有一个客户端要求 XHTML 有效的网站。他们使用 W3C 验证器对其进行检查。

我使用 W3C 验证器取得了一些成功，它使用`xmlns=`了标准 XHTML DTD 并在最后添加了一些属性，如*bobince*上面所述。我正在使用它来添加 PHPTAL 模板系统使用的属性，例如

```
<html metal:define-macro="m"> 
```

我同意您需要的不是 XHTML，而是 XHTML 的超集。但是，如果您的客户准备好通过将 W3C 验证器指向您的 URL 来进行测试，那么请继续。有关建议，请参阅[WDG](http://www.htmlhelp.com/design/dtd/customdtd.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-02T16:13:29.807

1.0 不允许这样做。如果您真的想这样做，您应该下载现有的 dtd 并将其保存在您的服务器中并定义私有而不是公共。但 w3c 验证未通过，因为它仅针对原始验证

# python - Python C-API 对象初始化

> ID：581281
> 
> 赞同：1
> 
> 时间：2009-02-24T10:43:49.493
> 
> 标签：python, c, python-3.x, python-c-api

将python对象初始化到已经存在的内存中的正确方法是什么（如c ++中的就地新）

我尝试了此代码，但是由于未设置 _ob_prev 和 _ob_next ，因此它会导致调试版本出现访问冲突。

```
//PyVarObject *mem; -previously allocated memory

Py_INCREF(type);
//couldnt get PyObject_HEAD_INIT or PyVarObject_HEAD_INIT to compile
//however the macros resolve to this
PyVarObject init = {{_PyObject_EXTRA_INIT 1, ((_typeobject*)type)}, 0};
*mem = init;
//...other init code for type... 
```

崩溃发生在 object.c 的第 1519 行

```
void
_Py_ForgetReference(register PyObject *op)
{
#ifdef SLOW_UNREF_CHECK
        register PyObject *p;
#endif
    if (op->ob_refcnt < 0)
        Py_FatalError("UNREF negative refcnt");
    if (op == &refchain ||
        op->_ob_prev->_ob_next != op || op->_ob_next->_ob_prev != op) { //----HERE----//
        fprintf(stderr, "* ob\n");
        _PyObject_Dump(op);
        fprintf(stderr, "* op->_ob_prev->_ob_next\n");
        _PyObject_Dump(op->_ob_prev->_ob_next);
        fprintf(stderr, "* op->_ob_next->_ob_prev\n");
        _PyObject_Dump(op->_ob_next->_ob_prev);
        Py_FatalError("UNREF invalid object");
    }
#ifdef SLOW_UNREF_CHECK
    for (p = refchain._ob_next; p != &refchain; p = p->_ob_next) {
        if (p == op)
            break;
    }
    if (p == &refchain) /* Not found */
        Py_FatalError("UNREF unknown object");
#endif
    op->_ob_next->_ob_prev = op->_ob_prev;
    op->_ob_prev->_ob_next = op->_ob_next;
    op->_ob_next = op->_ob_prev = NULL;
    _Py_INC_TPFREES(op);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-27T01:32:02.343

正在做的事情非常可怕。除非此代码路径对性能非常关键，否则我建议您像通常那样在堆上分配对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T00:38:03.287

Taking your question at face value, you have a few options. The quick and dirty method is to put an extra Py_INCREF into your initialisation code. Assuming you have no refcount bugs, the refcount will never return to zero, deallocation code will never be called, and there should be no crash. (In fact this may be the way that the statically allocated builtin type objects are managed!)

You could write a custom allocator and deallocator for your type that manages memory in your preferred manner. You could in fact write a custom allocator and deallocator for the whole python interpreter.

You could manage your python objects in the normal way but store pointers in them to data in the memory you are managing yourself.

Looking at the bigger picture... why are you trying to do this?

Also, your comments that

> I tried this code however it causes an access violation with a debug build because the _ob_prev and _ob_next are not set..

and

```
//couldnt get PyObject_HEAD_INIT or PyVarObject_HEAD_INIT to compile
//however the macros resolve to this
```

are worrying! Have you successfully defined a type which uses standard memory management, before moving on to more advanced stuff?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T21:35:31.530

您可以查看 Py_NoneStruct 以了解这是如何完成的。您的代码看起来基本正确。

这是一个引用计数错误。静态分配的对象永远不能被释放，所以永远不应该调用 _Py_ForgetReference。

如果您希望能够释放它们，则必须使用自定义分配器而不是静态初始化。

# windows - 补丁和服务包如何工作？

> ID：581282
> 
> 赞同：5
> 
> 时间：2009-02-24T10:43:51.223
> 
> 标签：windows, architecture

补丁或服务包如何工作？我不知道如何解释我的问题，但我会试一试

以 Windows 为例。它的文件总共消耗了 100 MB。现在单个服务包（可能是 300 MB 文件）更新整个 Windows 操作系统。

同样，我看到 adobe reader 等软件的更新发生了。在所有这些情况下，主 exe 与更新相比要大得多。整个进程如何运作？如果主文件引用了任何依赖文件，并且更新更改了版本或大小。不会影响exe吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T10:50:19.413

补丁和服务包通常只需要更新系统的核心共享库。这些库是从压缩档案中替换或修补的，因此它们的大小。更新库后，操作系统的其余软件可以继续使用新版本。

如今的应用程序被设计为模块化并使用可以轻松更新的外部库。有时不需要更换主应用程序或使用的任何媒体，只需更换已更改的库即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T11:01:49.420

为了补充早期的答案，在过去，当文件大小真的很重要时，一些补丁作为二进制差异交付，这意味着补丁本身是一个可执行文件，它知道需要更改哪些文件以及如何更改，它实际上只更改了一个文件的零和一的某些部分，在本地，而不是完全替换文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T10:57:50.800

以下 URL 可能对您了解架构感兴趣。

[http://msdn.microsoft.com/en-us/library/aa387291(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa387291(VS.85).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T11:11:33.873

补丁（也称为增量）只是两个文件之间的差异。如果 1GB 文件只有几个字节发生变化，补丁将只有几个字节大小。对于文本文件，使用[diff](http://en.wikipedia.org/wiki/Diff)，对于二进制文件 xdelta 或类似文件。服务包是补丁的集合。

# c# - 在运行时问题 ASP.Net 中添加控件

> ID：581286
> 
> 赞同：0
> 
> 时间：2009-02-24T10:45:39.770
> 
> 标签：c#, asp.net, javascript, html

我在页面上放了一个链接，点击后我写了一些代码来添加一些控件，

```
 DropDownList newDropdownlist = new DropDownList();
    panel.Controls.Add(newDropdownlist);
    CheckBox newChkbox = new CheckBox();
    panel.Controls.Add(newChkbox);
    TextBox txt = new TextBox();
    txt.ID = "txtPhoneValue";
    panel.Controls.Add(txt); 
```

我的问题是，当我单击此链接时，它会添加一次这些控件，但如果我再次单击它不会添加更多，接缝它会删除以前添加的控件并重新添加它们。

我想添加越来越多的每个链接点击。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T11:04:51.393

好的，这些添加的控件不会在回发之间的任何地方保留。因此，您应该在每次页面重新加载时添加它们。

考虑使用一些标志（例如存储在 Session 中）来指示必须添加额外的控件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T11:12:10.907

您的控件正在消失，因为它们没有存储在任何地方（页面在回发时忘记了它们）。请记住，在每次回发时，您的页面都必须重新创建。

有很多关于使用动态创建的控件的好文章。此外，要充分了解问题所在，您还需要熟悉页面生命周期。

这里有两篇对我很有帮助的文章：

*   [使用动态创建的控件](http://aspnet.4guysfromrolla.com/articles/081402-1.aspx)

*   [真正理解视图状态](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/Truly-Understanding-Viewstate.aspx)（这很棒）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T11:25:09.533

您需要在回发时重新创建控件（**具有相同的 ID！**），您可以在[CreateChildControls](http://msdn.microsoft.com/en-us/library/system.web.ui.control.createchildcontrols.aspx)方法中执行此操作。

值得查看[ASP.NET 的页面生命周期，](http://www.eggheadcafe.com/articles/o_aspNet_Page_LifeCycle.jpg)以了解何时何地可以修改内容。如果为时已晚，它不会被添加到 ViewState 等中，因此值得理解，尤其是在使用动态创建的控件时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T11:06:36.210

这个链接是如何构造的？

如果您的链接控件是 html 控件（客户端控件），那么您所经历的行为是正确的。

# wpf - 如何重新设置嵌套在自定义控件中的控件？

> ID：581298
> 
> 赞同：1
> 
> 时间：2009-02-24T10:48:52.133
> 
> 标签：wpf, custom-controls, styling

假设您正在WPF中开发一个**自定义控件，该控件内部包含一些其他基本控件。****为简单起见，假设它包含 2 个按钮**。

现在你想在你的应用程序中使用这个自定义控件，但你想重新**设置**它的样式。

**情况1**

如果在自定义控件定义中，两个按钮具有相同的样式（wpf 默认）并且您想重新设置两者的样式，则应该很容易：

```
<mc:MyControl>
   <mc:MyControl.Resources>
      <Style x:Key={x:Type Button}, TargetType={x:Type Button}>
         <!-- Insert the new style here -->
      </Style>
   </mc:MyControl.Resources>
<mc:MyControl> 
```

**案例二**

如果在自定义控件定义中，两个按钮具有相同的样式（wpf 默认），但您想**用两种不同的样式重新设置它们的样式**，那么解决它的最佳方法是什么？

**案例 3**

如果在自定义控件定义中，两个按钮具有相同的样式，**即引用自定义控件中定义的样式**，并且您想重新设置它们的样式，那么解决它的最佳方法是什么？

预先感谢您的所有帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T23:29:11.130

您可以在自定义控件中定义 2 个不同的**Style属性并将****它们绑定到各个按钮的 Style 属性**，从而允许客户端彼此独立地设置两个控件的样式。

XAML 文件：

```
<UserControl x:Class="MyNamespace.MyControl"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  Name="MyControl">
  <StackPanel>
    <Button Name="FirstButton"
            Style={Binding ElementName=MyControl, Path=FirstButtonStyle}
            Content="First Button" />
    <Button Name="SecondButton"
            Style={Binding ElementName=MyControl, Path=SecondButtonStyle}
            Content="Second Button" />
  </StackPanel>
</UserControl> 
```

代码隐藏文件：

```
using System;
using System.Windows;
using System.Windows.Controls;

namespace MyNamespace
{
  [StyleTypedProperty(
  Property = "FirstButtonStyle",
  StyleTargetType = typeof(Button))]
  [StyleTypedProperty(
  Property = "SecondButtonStyle",
  StyleTargetType = typeof(Button))]
  public partial class MyControl : UserControl
  {
    public static readonly DependencyProperty FirstButtonStyleProperty =
      DependencyProperty.Register(
        "FirstButtonStyle",
        typeof(Style),
        typeof(MyControl)
      );

    public Style FirstButtonStyle
    {          
      get { return (Style)GetValue(FirstButtonStyleProperty); }
      set { SetValue(FirstButtonStyleProperty, value); }
    }

    public static readonly DependencyProperty SecondButtonStyleProperty =
      DependencyProperty.Register(
        "SecondButtonStyle",
        typeof(Style),
        typeof(MyControl)
      );

    public Style SecondButtonStyle
    {          
      get { return (Style)GetValue(SecondButtonStyleProperty); }
      set { SetValue(SecondButtonStyleProperty, value); }
    }
  }
} 
```

将这两个属性实现为依赖属性是一个好主意，因为这将使它们符合标准 WPF 控件中的其他 Style 属性。

现在您可以像在任何 WPF 控件中一样设置按钮的样式：

```
<Window 
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:local="clr-namespace:MyNamespace"
  Title="MyControl Sample" 
  Height="300" 
  Width="300">
  <Window.Resources>
    <Style x:Key="GreenButton" TargetType="{x:Type Button}">
      <Setter Property="Background" Value="Green" />
    </Style>
    <Style x:Key="RedButton" TargetType="{x:Type Button}">
      <Setter Property="Background" Value="Red" />
    </Style>
  </Windows.Resources>
  <StackPanel>
    <local:MyControl FirstButtonStyle="{StaticResource GreenButton}"
                     SecondButtonStyle="{StaticResource RedButton}" />
  </StackPanel>
</Window> 
```

或者，您可以通过在您绑定到两个内部控件的 Style 属性的自定义控件中**公开一个属性，让 2 个按钮共享相同的样式。**

**更新**

您不必将**FirstButtonStyle**和**SecondButtonStyle**属性定义为依赖属性。重要的是，按钮**样式**属性的内部绑定会在其值更改时更新。您可以通过在用户控件中实现**INotifyPropertyChanged接口并在属性设置器中引发****OnPropertyChanged**事件来完成此操作。

您还可以为用户控件的构造函数中的 2 个属性分配“默认样式”。这是一个例子：

```
using System;
using System.ComponentModel;
using System.Windows;
using System.Windows.Controls;

namespace MyNamespace
{
  [StyleTypedProperty(
  Property = "FirstButtonStyle",
  StyleTargetType = typeof(Button))]
  [StyleTypedProperty(
  Property = "SecondButtonStyle",
  StyleTargetType = typeof(Button))]
  public partial class MyControl : UserControl, INotifyPropertyChanged
  {
    private Style firstButtonStyle;
    private Style secondButtonStyle;

    public MyControl()
    {
      Style defaultStyle = new Style();
      // assign property setters to customize the style

      this.FirstButtonStyle = defaultStyle;
      this.SecondButtonStyle = defaultStyle; 
    }

    public Style FirstButtonStyle
    {          
      get { return firstButtonStyle; }
      set
      {
         firstButtonStyle = value;
         OnPropertyChanged("FirstButtonStyle");
      }
    }

    public Style SecondButtonStyle
    {          
      get { return secondButtonStyle; }
      set
      {
         secondButtonStyle = value;
         OnPropertyChanged("SecondButtonStyle");
      }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    protected virtual void OnPropertyChanged(string propertyName)
    {
      if (PropertyChanged != null)
      {
        PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
      }
    }
  }
} 
```

# .net - 在 Vista 中从另一个应用程序控制服务

> ID：581300
> 
> 赞同：1
> 
> 时间：2009-02-24T10:49:03.943
> 
> 标签：.net, windows-services

我想知道是否可以在 .NET 中创建一个 windows 服务，然后创建另一个 windows.forms 进程来连接到该服务并传递参数、修改和查看其数据结构和连接的数据库等。

我相信在 Vista 中，这只能通过使用套接字而不是 ServiceController 类来实现。任何人都可以指导我如何执行此操作的示例或教程吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T10:53:42.480

我不知道有`ServiceController`限制，但是：我很少使用 Vista ;-p

而不是原始套接字......一种选择是让服务充当 WCF 主机，通过[`ServiceHost`](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicehost.aspx). 您的应用程序将是 WCF 客户端（通过`svcutil.exe`或通过 IDE 生成的代理）。这将使交谈变得轻松，唯一的问题是使用哪个通道 - 可能是命名管道，因为这是特定于机器的。

# silverlight - Silverlight 自定义控件中的 100% 宽度数据模板

> ID：581302
> 
> 赞同：1
> 
> 时间：2009-02-24T10:49:18.793
> 
> 标签：silverlight

我有一个扩展面板的自定义 Silverlight 控件。我要求数据模板（根节点是堆栈面板）占用 100% 的可用宽度 - 但是目前，堆栈面板仅填充到文本的宽度。

我控制的安排覆盖：

```
protected override Size MeasureOverride(Size availableSize)
{
    foreach (FrameworkElement element in Children)
    {
        element.Measure(new Size(availableSize.Width, availableSize.Height));
    }
    return base.MeasureOverride(availableSize);
} 
```

还有我的模板：

```
<DataTemplate x:Name="itemTemplate">
    <StackPanel Background="Aqua" HorizontalAlignment="Stretch">
        <TextBlock TextWrapping="Wrap" Text="{Binding Name}" HorizontalAlignment="Stretch"/>
    </StackPanel>
 </DataTemplate> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T10:51:59.100

~~将 Width="*" 添加到 StackPanel~~

糟糕，适用于网格行、列定义。

你为什么要覆盖 Measure 代码呢？Width 的自动行为是使用可用空间。同样，面板上的 Width 是标准的 FrameworkElement Width 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-08T16:48:33.873

我会说你应该考虑从 ItemsControl 而不是 Panel 继承。默认情况下，ItemsControl 中生成的元素将占据整个宽度。

# iis - 跟踪 IIS 内部错误

> ID：581308
> 
> 赞同：0
> 
> 时间：2009-02-24T10:50:46.760
> 
> 标签：iis, iis-7, iis-6

我使用 JavaScript 将异步请求发布到 Web 服务。这在大约 95% 的时间里都有效。*有时*，请求无法处理。

下面是 IIS 的 Trace 文件中的错误信息：

> 2009-02-24 06:14:40 W3SVC861612620 10.248.24.20 POST /TestWebService /TestWebService.asmx - 3112 - 10.250.201.45 Mozilla/4.0+（兼容；+MSIE+6.0；+MS+Web+Services+Client+Protocol+ 1.1.4322.2032) 500 0 0 1148 954 124876

这说明内部`Error 500`已经发生了请求。有什么方法可以让我在发布请求的 JavaScript 中了解这一点？任何解决方法也都可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T12:00:29.450

由于您没有提供有关您的 javascript 库的信息，因此很难排除故障。但是，如果您在 IIS 7 上运行，则可以启用[Failed Request Tracing](http://learn.iis.net/page.aspx/266/troubleshooting-failed-requests-using-tracing-in-iis7/)。

旧式故障排除方法：您的 Web 方法有 5% 的时间会产生错误，这意味着它在某些情况下有效，但在其他情况下会失败。这很可能是由发送到您的 Web 方法的参数引起的。即使您无法捕获对 Web 方法的任何运行时请求，您也可以检查您的逻辑以查看哪些参数条件会导致失败。更好的是，构建一组单元测试来调用您的 Web 方法，传递所有可行的参数组合。

# c# - c#从字节数组中检测xml编码？

> ID：581318
> 
> 赞同：6
> 
> 时间：2009-02-24T10:55:29.620
> 
> 标签：c#, xml, encoding, binary-data

好吧，我有一个字节数组，我知道它是字节数组中的一个 xml 序列化对象，有什么方法可以从中获取编码吗？

我不打算对它进行反序列化，但我将它保存在 sql 服务器上的 xml 字段中......所以我需要将它转换为字符串？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-12T10:56:13.713

[与此问题](https://stackoverflow.com/questions/637855/how-to-best-detect-encoding-in-xml-file)类似的解决方案可以通过在字节数组上使用 Stream 来解决此问题。然后你就不必在字节级别上摆弄了。像这样：

```
Encoding encoding;
using (var stream = new MemoryStream(bytes))
{
    using (var xmlreader = new XmlTextReader(stream))
    {
        xmlreader.MoveToContent();
        encoding = xmlreader.Encoding;
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-24T11:05:01.003

您可以查看前 40 个字节¹。它们*应该*包含文档声明（假设它*有*一个文档声明），它应该包含编码*，或者*您可以假设它是 UTF-8 或 UTF-16，这应该从您对这`<?xml`部分的理解中显而易见。（只需检查两种模式。）

实际上，您是否期望得到除 UTF-8 或 UTF-16 之外的任何东西？如果不是，您可以检查在这两种模式开始时获得的模式，如果它不遵循任何一种模式，则抛出异常。或者，如果您想再次尝试，您可以随时尝试将文档解码为 UTF-8，重新编码并查看是否返回相同的字节。这并不理想，但它可能只是工作。

我敢肯定有更严格的方法可以做到这一点，但它们可能很挑剔:)

* * *

¹很可能比这个少。我认为 20 个字符应该足够了，在 UTF-16 中是 40 个字节。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-24T11:08:51.070

前 2 或 3 个字节可能是字节顺序标记 (BOM)，它可以告诉您流是 UTF-8、Unicode-LittleEndian 还是 Unicode-BigEndian。

UTF-8 BOM 是 0xEF 0xBB 0xBF Unicode-Bigendian 是 0xFE 0xFF Unicode-LittleEndiaon 是 0xFF 0xFE

如果这些都不存在，那么您可以使用 ASCII 进行测试`<?xml`（请注意，大多数现代 XML 生成都遵循在 xml 声明之前没有空格的标准）。

ASCII 被用完，直到`?>`你可以找到 encoding= 的存在并找到它的值。如果 encoding 不存在或`<?xml`declare 不存在，那么您可以假设 UTF-8。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-02-23T19:19:16.253

[W3C XML 规范有一节](https://www.w3.org/TR/xml/#sec-guessing)介绍如何确定字节字符串的编码。

## 首先检查 Unicode 字节顺序标记

BOM 只是另一个字符；它是：

> ['零宽度无间断空间' (U+FEFF)](http://www.fileformat.info/info/unicode/char/FEFF/index.htm)

例如：

*   `NWNBSP``<``?``x``m``l``v``e``r``s`
*   `"\ufeff<xml vers"`
*   `"\ufeff\u003c\u003f\u0078\u006d\u006c\u0020\u0076\u0065\u0072\u0073"`
*   `U+FEFF``U+003C``U+003F``U+0078``U+006D``U+006C``U+0020``U+0076``U+0065``U+0072``U+0073`

字符**U+FEFF**以及文件中的所有其他字符都使用适当的编码方案进行编码：

*   **`00 00 FE FF`**：*UCS-4，大端机（1234顺序）*
*   **`FF FE 00 00`**: *UCS-4, little-endian machine (4321 order)*
*   **`00 00 FF FE`**：*UCS-4，不寻常的八位字节顺序 (2143)*
*   **`FE FF 00 00`**：*UCS-4，不寻常的八位字节顺序 (3412)*
*   **`FE FF ## ##`**：*UTF-16，大端*
*   **`FF FE ## ##`**：*UTF-16，小端*
*   **`EF BB BF`**: *UTF-8*

*where`## ##`可以是任何东西 - 除了都为零*

*   `U+FEFF``U+003C``U+003F``U+0078``U+006D``U+006C``U+0020``U+0076``U+0065``U+0072``U+0073`
*   ``ff` `fe````3c` `00````3f` `00````78` `00````6d` `00````6c` `00````20` `00````76` `00````65` `00````72` `00````73` `00``
*   `ff` `fe` `3c` `00` `3f` `00` `78` `00` `6d` `00` `6c` `00` `20` `00` `76` `00` `65` `00` `72` `00` `73` `00`

因此，首先检查任何这些签名的初始字节。如果找到其中之一，则返回该[代码页标识符](https://msdn.microsoft.com/en-us/library/windows/desktop/dd317756%28v=vs.85%29.aspx?f=255&MSPPError=-2147217396)

```
UInt32 GuessEncoding(byte[] XmlString)
{
   if BytesEqual(XmlString, [00, 00, $fe, $ff]) return 12001; //"utf-32BE" - Unicode UTF-32, big endian byte order
   if BytesEqual(XmlString, [$ff, $fe, 00, 00]) return 1200;  //"utf-32" - Unicode UTF-32, little endian byte order
   if BytesEqual(XmlString, [00, 00, $ff, $fe]) throw new Exception("Nobody supports 2143 UCS-4");
   if BytesEqual(XmlString, [$fe, $ff, 00, 00]) throw new Exception("Nobody supports 3412 UCS-4");
   if BytesEqual(XmlString, [$fe, $ff])
   {
      if (XmlString[2] <> 0) && (XmlString[3] <> 0)
         return 1201;  //"unicodeFFFE" - Unicode UTF-16, big endian byte order
   }
   if BytesEqual(XmlString, [$ff, $fe])
   {
      if (XmlString[2] <> 0) && (XmlString[3] <> 0)
         return 1200;  //"utf-16" - Unicode UTF-16, little endian byte order
   }
   if BytesEqual(XmlString, [$ef, $bb, $bf])    return 65001; //"utf-8" - Unicode (UTF-8) 
```

## 或者寻找 <?xml

如果 XML 文档没有字节顺序标记字符，则继续查找每个 XML 文档必须具有的前五个字符：

> `<?xml`

知道这一点很有帮助

*   **`<`**是#x0000003C
*   **`?`**是#x0000003F

这样我们就可以查看前四个字节了：

*   **`00 00 00 3C`**：*UCS-4，大端机（1234顺序）*
*   **`3C 00 00 00`**: *UCS-4, little-endian machine (4321 order)*
*   **`00 00 3C 00`**：*UCS-4，不寻常的八位字节顺序 (2143)*
*   **`00 3C 00 00`**：*UCS-4，不寻常的八位字节顺序 (3412)*
*   **`00 3C 00 3F`**：*UTF-16，大端*
*   **`3C 00 3F 00`**：*UTF-16，小端*
*   **`3C 3F 78 6D`**: *UTF-8*
*   **`4C 6F A7 94`**:*一些EBCDIC的味道*

所以我们可以在我们的代码中添加更多内容：

```
 if BytesEqual(XmlString, [00, 00, 00, $3C])    return 12001; //"utf-32BE" - Unicode UTF-32, big endian byte order
   if BytesEqual(XmlString, [$3C, 00, 00, 00])    return 1200;  //"utf-32" - Unicode UTF-32, little endian byte order
   if BytesEqual(XmlString, [00, 00, $3C, 00])    throw new Exception("Nobody supports 2143 UCS-4");
   if BytesEqual(XmlString, [00, $3C, 00, 00])    throw new Exception("Nobody supports 3412 UCS-4");
   if BytesEqual(XmlString, [00, $3C, 00, $3F])   return return 1201;  //"unicodeFFFE" - Unicode UTF-16, big endian byte order
   if BytesEqual(XmlString, [$3C, 00, $3F, 00])   return 1200;  //"utf-16" - Unicode UTF-16, little endian byte order
   if BytesEqual(XmlString, [$3C, $3F, $78, $6D]) return 65001; //"utf-8" - Unicode (UTF-8)
   if BytesEqual(XmlString, [$4C, $6F, $A7, $94])
   {
      //Some variant of EBCDIC, e.g.:
      //20273   IBM273  IBM EBCDIC Germany
      //20277   IBM277  IBM EBCDIC Denmark-Norway
      //20278   IBM278  IBM EBCDIC Finland-Sweden
      //20280   IBM280  IBM EBCDIC Italy
      //20284   IBM284  IBM EBCDIC Latin America-Spain
      //20285   IBM285  IBM EBCDIC United Kingdom
      //20290   IBM290  IBM EBCDIC Japanese Katakana Extended
      //20297   IBM297  IBM EBCDIC France
      //20420   IBM420  IBM EBCDIC Arabic
      //20423   IBM423  IBM EBCDIC Greek
      //20424   IBM424  IBM EBCDIC Hebrew
      //20833   x-EBCDIC-KoreanExtended IBM EBCDIC Korean Extended
      //20838   IBM-Thai    IBM EBCDIC Thai
      //20866   koi8-r  Russian (KOI8-R); Cyrillic (KOI8-R)
      //20871   IBM871  IBM EBCDIC Icelandic
      //20880   IBM880  IBM EBCDIC Cyrillic Russian
      //20905   IBM905  IBM EBCDIC Turkish
      //20924   IBM00924    IBM EBCDIC Latin 1/Open System (1047 + Euro symbol)
      throw new Exception("We don't support EBCDIC. Sorry");
   }

   //Otherwise assume UTF-8, and fail to decode it anyway
   return 65001; //"utf-8" - Unicode (UTF-8)

   //Any code is in the public domain. No attribution required.
} 
```

# xaml - 有没有办法自动重新格式化 Blend 的 XAML 视图？

> ID：581319
> 
> 赞同：1
> 
> 时间：2009-02-24T10:55:35.627
> 
> 标签：xaml, expression-blend

Blend 倾向于在很长的行中创建它的 XAML。

有没有办法重新格式化它，使每个元素的属性在彼此下方垂直排列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T23:27:55.820

Blend 中没有自动格式化 XAML 的功能。我通常使用 Visual Studio 进行 xaml 格式化。

另一种选择是将您的 XAML 粘贴到 Kaxaml 并使用其出色的 XAML 清理器，然后将结果粘贴回 Blend。您可以在 Channel9 上看到演示：http: [//channel9.msdn.com/shows/Continuum/Kaxaml/](http://channel9.msdn.com/shows/Continuum/Kaxaml/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T11:12:00.533

您可以使用 Visual Studio 来完成：

> 更改 XAML 文档的默认设置，然后使用 CTRL+E,D（编辑 | 高级 | 格式化文档）或 CTRL+E,F（编辑 | 高级 | 格式选择）。

[http://weblogs.asp.net/fmarguerie/archive/2008/06/07/xaml-markup-formatting-in-visual-studio.aspx](http://weblogs.asp.net/fmarguerie/archive/2008/06/07/xaml-markup-formatting-in-visual-studio.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-21T01:00:46.933

或者尝试在[http://xamlstyler.codeplex.com/](http://xamlstyler.codeplex.com/) 上为 Visual Studio 2010 托管的 xaml 样式器。如果您曾经使用过 Kaxaml 的 Xaml Scrubber 并且喜欢它，那么您可以认为这个扩展是 Visual Studio 的“Xaml Scrubber”。

检查[http://xamlstyler.codeplex.com/](http://xamlstyler.codeplex.com/)以了解功能亮点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-22T15:50:19.267

进入 Visual Studio。（我使用的是 2012 年）。

1.  工具 > 选项 > Xaml 样式器（在底部）
2.  在**杂项下**
3.  设置`Beautify on saving xaml`为假

您现在可以随心所欲地保存您的 xaml，它会保持这种状态。

# asp.net - 将 Microsoft Search Server 2008 与 asp.net/vb.net 一起使用

> ID：581322
> 
> 赞同：2
> 
> 时间：2009-02-24T10:55:48.700
> 
> 标签：asp.net, vb.net, sharepoint, search

我正在安装 Microsoft Search Server 2008 express 以索引 Intranet 应用程序的某些内容。

之前没有使用过搜索服务器，我正在研究我的 asp.net 应用程序（.net 3.5）查询搜索服务器的方式。

我刚刚开始研究[搜索社区工具包](http://www.codeplex.com/sctsc)，看看它是否与我想要实现的目标相关。但想知道你们是否能指出我正确的方向（代码、文章等）。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T11:08:10.543

Microsoft 提供开发人员 API。这些程序集是 Search Server 2008 SDK 的一部分。

[http://msdn.microsoft.com/en-us/library/bb931107.aspx](http://msdn.microsoft.com/en-us/library/bb931107.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T15:02:15.567

经过几次谷歌搜索，发现这个网站非常符合要求。

[http://labs.episerver.com/en/Blogs/Ted-Nyberg/Dates/2009/1/Using-EPiServer-and-Microsoft-Search-Server-2008/](http://labs.episerver.com/en/Blogs/Ted-Nyberg/Dates/2009/1/Using-EPiServer-and-Microsoft-Search-Server-2008/)

描述使用 Search Server Web 服务，这是一种非常简洁的方法。

# visual-c++ - Visual C++ - 组合框的事件

> ID：581335
> 
> 赞同：0
> 
> 时间：2009-02-24T10:58:41.563
> 
> 标签：visual-c++, combobox

我想知道 Visual C++ 中的 ComboBox 是否有一个事件，当鼠标经过组合框的项目时，我可以利用它来做某事。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T11:17:46.510

您可以尝试 WM_DRAWITEM 通知，但您可能需要一个所有者绘制的样式。

绘制项目成员包含一个 itemAction，它指示项目需要在什么情况下绘制自身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T11:46:08.580

看看 TrackMouseEvent()。

您可能需要为您的组合框创建一个类（从 CComboBox 派生）；在其中添加 TrackMouseEvent()。

有消息来处理鼠标悬停（当鼠标在 CWnd 的客户区域内时）和鼠标离开（当鼠标离开 CWnd 的客户区域时）。

# c# - 类似于 Pass in Python for C#

> ID：581343
> 
> 赞同：43
> 
> 时间：2009-02-24T11:00:30.747
> 
> 标签：c#, python

在python中，我们可以...

```
a = 5
if a == 5:
    pass #Do Nothing
else:
    print "Hello World" 
```

在 C# 中是否有类似的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-24T11:03:27.980

使用空括号。

```
int a = 5;
if (a == 5) {}
else {
  Console.Write("Hello World");
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2017-02-22T12:50:54.867

如果您不想使用空块，请使用

```
; 
```

所以代码应该看起来像

```
int a = 5;
if (a == 5)
  ;
else 
{
  Console.Write("Hello World");
} 
```

虽然，代码可读性仍然受到影响。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-24T11:05:56.257

为什么不直接说：

```
if (a != 5) 
{
   Console.Write("Hello World");
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-24T11:03:58.180

空块：

```
{} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-24T11:10:15.780

是`pass`在循环的上下文中使用的吗？如果是这样，请使用以下`continue`语句：

```
for (var i = 0; i < 10; ++i)
{
    if (i == 5)
    {
        continue;
    }

    Console.WriteLine("Hello World");
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-24T11:06:48.657

要么按照其他答案中的建议使用空块，要么反转条件：

```
if (a != 5)
{
    Console.WriteLine("Hello world");
} 
```

或更机械地：

```
if (!(a == 5))
{
    Console.WriteLine("Hello world");
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-24T11:07:57.047

一个更好的问题是你为什么想做这样的事情。如果你不打算做任何事情，那就把它排除在外，而是。

```
int a = 5;
if (a != 5) {
    Console.Write("Hello World");
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-05-12T09:52:55.830

当你可以做不必要的困难时，为什么要让它变得容易？

```
((Action) (() => { }))(); 
```

严肃地说，Python pass 语句的 C# 等效项是

```
; 
```

因为这是一行什么都不做的代码。尽管

```
{} 
```

将获得相同的结果，您实际上是在创建一个不包含任何代码行的范围。

# c# - 安装 Windows 服务 - 没有错误，但它不在服务控制管理器中

> ID：581351
> 
> 赞同：2
> 
> 时间：2009-02-24T11:04:05.280
> 
> 标签：c#, visual-studio, service, windows-services, installation

我已经在 C# 中创建了一个 Windows 服务，我正在尝试使用这里推荐的 installutil 安装它以进行调试：http: [//msdn.microsoft.com/en-us/library/sd8zc8ha.aspx](http://msdn.microsoft.com/en-us/library/sd8zc8ha.aspx)

installutil 说安装完成。但是，服务控制管理器中没有出现任何内容。

我已经在 Server 2008 和 XP 上尝试过，结果相同。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T11:49:19.820

我的一位同事有或多或少相同的问题。

您是否在项目中添加了安装程序？要安装该服务，您需要将安装程序添加到您的 Visual Studio 项目中。在 Visual Studio 中添加安装程序的最简单方法是在设计模式下打开您的服务，然后右键单击设计区域并选择添加安装程序。这将添加一个文件 ProjectInstaller.cs，它本身包含一个 ServiceInstaller 对象和一个 ServiceProcessInstaller 对象。添加安装程序后，您可以设置安装服务时将使用的服务名称、描述和其他选项。如果您现在尝试使用 InstallUtil，您的服务应该已安装并应显示在“服务”列表中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-05T15:16:15.453

我有一个类似的问题（构建安装程序，没有错误，没有服务出现`services.msc`），但是一个不同的解决方案，因为我已经配置了安装程序。

在我的例子中，服务项目的`Application Properties`（Alt-Enter，Application-tab）启动**对象**`(not set)`如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/li2Q6.png)

选择默认的**.Program**并重建服务和安装程序工作（服务出现在 中`services.msc`）。

设置此属性是[此 SO 答案](https://stackoverflow.com/questions/407109/installing-a-windows-service-from-a-visual-studio-installer-project/407127#407127)中引用[的 MSDN 服务安装程序演练中的步骤之一。](http://msdn.microsoft.com/en-us/library/zt39148a.aspx)确保遵循所有步骤！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T11:25:14.480

我不能具体说明 C# 或 .NET 的任何问题，但我有一个关于安装服务必须发生的事情的文章，并以广泛记录的框架（包括源代码）的形式工作用于[在 Lua](http://luaforge.net/projects/luaservice/)中编写服务。我在这里提供它作为另一种方法的示例，因为有时仅从另一个角度看待事物可能会有所帮助。

免责声明：它非常处于 alpha 质量级别，是的，我是它的作者。

该框架具有与 Windows SCM 交互以安装和删除服务所需的所有代码。

# jquery - IE 中表格的 jQuery UI 性能问题

> ID：581353
> 
> 赞同：6
> 
> 时间：2009-02-24T11:04:31.783
> 
> 标签：jquery, performance, internet-explorer, jquery-ui, dhtml

我在让 UI 代码在 IE 中运行良好时遇到问题。

我有一个表格 - 一个值矩阵。每个单元格可以为空或包含项目列表。

我希望用户能够在单元格之间拖动项目。

所以我的 HTML 看起来像这样：

```
<table>
    <tr><td></td><th scope="col">col 1</th><th scope="col">col 2</th></tr>
    <tr><th scope="row">row 1</th>
        <td class="droppable-cell">
            <div class="draggable-item">item A</div>
            <div class="draggable-item">item B</div>
        </td>
        <td class="droppable-cell"></td>
    </tr>
    <tr><th scope="row">row 2</th>
        <td class="droppable-cell"></td>
        <td class="droppable-cell">
            <div class="draggable-item">item C</div>
            <div class="draggable-item">item D</div>
        </td>
    </tr>
</table> 
```

然后我使用 jQuery 1.3.1 和 jQuery UI 1.6rc6：

```
$j('.draggable-item').each(function()
{
    $j(this).draggable({
       addClasses: false,
       revert: true, 
       zIndex: 2000,
       cursor: 'move'
    });
});

$j('.droppable-cell').each(function()
{
    $j(this).droppable({
        addClasses: false,
        activeClass: 'droppable-cell-candrop',
        hoverClass: 'droppable-cell-hover',
        tolerance: 'pointer',

        drop: function(event, ui)
        {
            //function to save change
        });
    });
}); 
```

请注意，这是简化、截断和未完成的代码。

我的问题是，在 FX、Safari、Chrome 等（即所有不错的浏览器）中，它运行良好。

IE 真的很挣扎。对于 5x5 表格，IE 在拖动开始时的延迟很明显。在可能有 100 个项目的 10x10 表上，拖动的开始会挂起浏览器。

我希望能够支持多达 20x15 个单元格，也许多达 500 个项目 - 这是不可能的吗？似乎不应该如此。

难道我做错了什么？有没有办法做到这一点，不会像这样减慢 IE 中的页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T19:14:16.603

缩小 jQuery 必须搜索的 DOM 部分可能会有所帮助。向包含的 DOM 元素添加一个 id

```
<table id="myTable"> 
```

然后更改您的 jQuery 选择器以在此容器中查找元素

```
$j('#myTable .draggable-item').each(function() { ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T12:04:20.390

这正是 iGoogle 和其他类似应用程序使用边缘有虚线的透明框的原因。由于您上面概述的问题，IE 无法拖动完整的对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T15:02:44.050

可能是表格渲染...您可以尝试不使用表格吗？

如果您的单元格大小相同，则可以实现浮动它们的类似表格的显示：

```
<style>
.droppable-cell{
  float:left; width: 50%; height: 20px; border: 1px solid black;
}
</style>

<div class="droppable-cell">
        <div class="draggable-item">item A</div>
        <div class="draggable-item">item B</div>
</div>
<div class="droppable-cell"></div>
<div class="droppable-cell"></div>
<div class="droppable-cell">
        <div class="draggable-item">item C</div>
        <div class="draggable-item">item D</div>
</div> 
```

如果必须使用表格，请将[表格布局](http://msdn.microsoft.com/en-us/library/ms531161.aspx)样式设置为“固定”并指定单元格大小可能会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-15T16:57:55.000

我的工作是从可放置定义中删除“activeClass”，并且只使用“hoverClass”。

在大约 150 行和大约 10 列的表上。它从 10 秒的延迟变为不到 1 秒。拖动变得有点生涩，但并非无法使用。

# c# - 在组合框中显示选项时，将“空值”写入 SQL 数据库的最佳方法是什么？

> ID：581366
> 
> 赞同：0
> 
> 时间：2009-02-24T11:10:18.773
> 
> 标签：c#, sql, combobox, null, tableadapter

我正在编写数据库的前端，将选项显示为组合框。而且我需要能够将空值返回到数据库。

我目前有一个解决方案，它涉及在查询中“伪造”一条记录以填充数据表，然后在`null`我的更新语句中检测到选择和硬编码（如果已选择该项目）。

```
--GetDataByAvailableTechs query 
            SELECT     tblLEMSCredentialsId, TechNumber
            FROM         tblLEMSCredentials AS aLEMSCreds
            UNION ALL
            SELECT     '99999' AS Expr1, '<NONE>' AS Expr2 
```

.

```
 //populate combo box
            BV_LEMSHIPDataSet.tblLEMSCredentialsDataTable dtAvailableTechs = taLEMSCreds.GetDataByAvailableTechs(selectedSerial);  
            cboTechNumber.DataSource = dtAvailableTechs; 
```

.

```
 //Save back to DB
            if (lemsCredsID == 99999)
            {
                taDevice.UpdateQuery_Restage(null, selectedSerial);
            }
            else
            {
                taDevice.UpdateQuery_Restage(lemsCredsID, selectedSerial);
            } 
```

任何人都可以建议一个更好的方法吗？我需要让应用程序处理另外 5 个类似的字段，并且不想创建多个 if else 版本的更新。

G

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T11:18:57.850

在过去，我使用过类似的方法，但对 NULL 值使用负数 - 这样您就可以在一个 if 语句中将任何小于零的值视为 NULL。

这假设您在表中的 ID 始终为正数：)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T11:22:27.387

空对象模式。让它为 UI 返回一个空字符串，并在更新数据库时提供一个方法调用来提取值。在正常情况下，这将返回您的真实值，但 null 对象将覆盖此行为以提供您的 null。

不需要幻数，您只需在将控件绑定到数据源时将此值添加到“可绑定值”的开头。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T11:21:41.697

您可以将字符串值作为组合框的“空值”，例如：“thenullvalue”，然后将组合框值解析为可为空的 int 类型（int？）。对于正确的选择，您将获得所需的值，对于“空选择”，您将获得 null（将“thenullvalue”解析为 int 将为您提供 null）:)

然后将值保存到数据库中，如下所示：

```
int? lemsCredsID = parseInt(combobox.Value);

 //Save back to DB
taDevice.UpdateQuery_Restage(lemsCredsID, selectedSerial); 
```

根据您的数据库提供程序，您可能还需要将可空类型 null 值转换为 DBNull，如下所示：

```
taDevice.UpdateQuery_Restage((lemsCredsID==null ? DBNull : (int)lemsCredsID), selectedSerial); 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T11:33:10.700

如果该值打算为 null，则将 null 传递给数据库将是一个很好的解决方案，这减少了对 null 特殊值的额外逻辑处理，并且可能非常危险和模棱两可。

视图或应用程序层应该能够处理从数据库返回或传递给它的空值。

例如，您可以在绑定控件之前将 null 转换为 string.Empty，也可以在传递到数据库之前将 string.Empty 转换为 null。

# spring - 在春季拆分应用程序上下文文件时出错

> ID：581377
> 
> 赞同：-1
> 
> 时间：2009-02-24T11:11:36.463
> 
> 标签：spring, spring-mvc

我正在尝试在 Spring 中拆分 ApplicationContext 文件。

例如。该文件是包含所有条目的 testproject-servlet.xml。现在我想根据逻辑组将这个单个文件拆分为多个文件，例如：group1-services.xml、group2-services.xml

我在 web.xml 中创建了以下条目：

```
<servlet>
    <servlet-name>testproject</servlet-name>
    <servlet-class>
        org.springframework.web.servlet.DispatcherServlet
    </servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>
            /WEB-INF/group1-services.xml, /WEB-INF/group2-services.xml
        </param-value>
    </init-param>       
    <load-on-startup>1</load-on-startup>
</servlet> 
```

我使用 SimpleUrlHandlerMapping 作为：

```
<bean id="simpleUrlMapping"class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
    <property name="order" value="0"/>
    <property name="mappings">
    <props>
        <prop key="/register.htm">RegisterController</prop>             <prop key="/payroll_services.htm">PayrollServicesController</prop>
    </props>
    </property>
</bean> 
```

我还将控制器定义为：

```
<bean id="PayrollServicesController" class="com.triforce.b2bseek.businessservices.controller.PayrollServicesController">
      <property name="facadeLookup" ref="FacadeLookup"/>
      ..
      ..
      </property>
</bean> 
```

问题是我已将 ApplicationContext 文件“testproject-servlet.xml”拆分为两个不同的文件，并将上述条目保留在“group1-services.xml”中。好吗？我想根据它们在单独的 .xml 文件中的用途对它们进行逻辑分组。

但是当我尝试访问应用程序内的页面时出现以下错误：

```
org.springframework.web.servlet.DispatcherServlet noHandlerFound
WARNING: No mapping for [/TestProject/payroll_services.htm] in DispatcherServlet with name 'testproject' 
```

请告诉我如何解决它。

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-05-10T06:33:07.210

替换这个 /WEB-INF/group1-services.xml, /WEB-INF/group2-services.xml

与 /WEB-INF/group1-services.xml /WEB-INF/group2-services.xm

希望这会奏效...... :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T21:04:36.460

您需要在每个文件中包含以下内容：

```
<context:component-scan base-package="com.example.dao" /> 
```

如果文件中缺少它，则在该文件的上下文中似乎不知道带注释的类。

您可能需要重新访问[文档](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-classpath-scanning)以获取详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T13:27:44.043

您是否将 ContextLoaderListener 添加到您的 web.xml 中？我没看到：

```
 <listener>
     <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
   </listener> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T11:36:26.153

我不认为这是你的`contextConfigLocation`问题

我认为更重要的是调度程序需要知道发送`payroll_servives.htm`到哪里，并且找不到合适的处理程序知道如何处理这种模式。

请参阅[参考文档](http://static.springframework.org/spring/docs/2.5.x/reference/mvc.html#mvc-servlet)

***您真的希望`*.htm`文件与调度程序 servlet 匹配吗？***

如果您使用的是基于注解的控制器 ( `@Controller`)，那么您需要有类似于以下内容的行：

```
<context:component-scan base-package="org.springframework.samples.petclinic.web"/> 
```

这将安装一个适当的基于注释的处理程序，它搜索注释如下的类/方法：

```
@Controller
public class PayrollController {
     @RequestMapping("payroll_services.htm")
     public ModelAndView payrollServices() {
         ....
     }
} 
```

否则，如果您使用更传统的处理程序/控制器，则需要使用 XML 定义它。本文前面的参考文档链接提到了两个这样的处理程序：`SimpleUrlHandlerMapping`或`BeanNameUrlHandlerMapping`

也许如果您使用处理程序/控制器 XML 片段更新了您的问题，这可能会有所帮助？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-27T14:54:13.010

DispatcherServlet 的处理程序映射不正确，或者您使用了错误的 url。如果您修复 SimpleUrlHandlerMapping 配置周围的布局，我可以告诉您要更改的内容。

# visual-studio - 在您最喜欢的 IDE 中打开源文件的 Firefox 插件

> ID：581382
> 
> 赞同：0
> 
> 时间：2009-02-24T11:12:36.757
> 
> 标签：visual-studio, firebug, external

在 Visual Studio 中开发 Web 应用程序时，我希望能够在 Visual Studio 中快速打开源文件（xsl、js 等，而不是“查看源”结果）。我的想法是：

*   写出 http 响应标头（在调试模式下），识别有助于构建响应的本地文件 (c:...\bla.aspx)
*   在 FireBug 中阅读这些 http 标头，以在新选项卡中将它们呈现为可点击
*   使这些可点击的 url 启动具有某些参数的 IDE（可配置）

我很确定这可以通过结合使用 http 标头、firebug 和 launchy 来实现。但我想知道是否有人知道实现这一目标的现有/更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T11:33:23.197

例如 Zend Studio 工具栏。

# javascript - 使用 JavaScript 添加自定义 HTTP 标头

> ID：581383
> 
> 赞同：45
> 
> 时间：2009-02-24T11:12:48.987
> 
> 标签：javascript, http-headers

在 HTML 页面上，单击图像（“img”）或锚点（“a”）标签的链接时，我想为 GET 请求添加自定义标头。这些链接通常用于下载动态内容。这些标头可以是 SAML 标头或自定义应用程序特定标头。

是否可以通过 JavaScript 添加这些自定义标头？或者如果我通过 XMLHttpRequest 添加这些，如何实现下载功能？

此要求仅适用于 IE6 或 7。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-24T11:15:11.117

如果您使用的是[XHR](http://en.wikipedia.org/wiki/XMLHttpRequest "维基百科上的 XMLHttpRequest")，那么`setRequestHeader`应该可以工作，例如

```
xhr.setRequestHeader('custom-header', 'value'); 
```

PS 你应该使用[Hijax](http://domscripting.com/blog/display/41 "Hijax 概述")来修改你的锚的行为，这样如果由于某种原因 AJAX 不能为你的客户工作（比如页面上其他地方的破坏脚本），它就可以工作。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-24T11:15:54.923

我认为完成它的最简单方法是使用查询字符串而不是 HTTP 标头。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-24T11:26:02.793

从浏览器内部向请求添加标头的唯一方法是使用 XmlHttpRequest setRequestHeader 方法。

将此与“GET”请求一起使用将下载资源。那么诀窍就是以预期的方式访问资源。从表面上看，您应该能够允许 GET 响应在短时间内缓存，因此导航到新 URL 或使用 src url 创建 IMG 标记应该使用来自先前“GET”的缓存响应。但是，这很可能会失败，尤其是在 IE 中，这在涉及缓存的情况下可能有点自成一格。

最终我同意 Mehrdad，使用查询字符串是最简单和最可靠的方法。

另一个古怪的选择是使用 XHR 向 URL 发出请求，表明您打算访问资源。它可以使用会话 cookie 进行响应，该会话 cookie 将由后续对图像或链接的请求携带。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-04-05T18:23:54.600

在 2021 年，这可以通过[Service Workers](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API)来实现。

首先，您必须在您的页面上注册一个 Service Worker。

```
// index.html
window.addEventListener('load', function () {
    navigator
        .serviceWorker
        .register('/service-worker.js');
}); 
```

在 Service Worker 中，通过调用该[`WindowOrWorkerGlobalScope.fetch()`](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch)方法来捕获、修改和转发请求。

```
// service-worker.js
self.addEventListener('fetch', function (event) {
    event.respondWith(async function () {
        let headers = new Headers()
        headers.append("X-Custom-Header", "Random value")
        return fetch(event.request, {headers: headers})
    }());
}); 
```

请注意，某些 Web 浏览器不会在开发者控制台中显示修改后的请求。在这种情况下，可以使用 tcpdump、Wireshark 等工具或在服务器日志中观察请求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-09T16:26:25.277

如前所述，最简单的方法是使用查询字符串。

但如果您不能，出于安全原因，您应该考虑使用 cookie。

# c++ - typedef 的有效使用？

> ID：581387
> 
> 赞同：5
> 
> 时间：2009-02-24T11:14:31.230
> 
> 标签：c++, typedef

我有一个`char`通过网络发送的（即字节）缓冲区。在将来的某个时候，我可能想将缓冲区切换为不同的类型，例如`unsigned char`or `short`。我一直在考虑做这样的事情：

```
typedef char bufferElementType; 
```

每当我对缓冲区元素做任何事情时，我都会将其声明为`bufferElementType`而不是`char`. 这样我可以通过改变这个typedef来切换到另一种类型（当然不会那么简单，但至少可以很容易地识别出需要修改的地方......`bufferElementType`附近会有一个）。

这是对 typedef 的有效/良好使用吗？不值得麻烦吗？将来某个时候会不会让我头疼？它会让维护程序员讨厌我吗？

我已经阅读了[When Should I Use Typedef In C++](https://stackoverflow.com/questions/516237/when-should-i-use-typedef-in-c)，但没有人真正涵盖这一点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T11:16:56.230

这是一个很好的（和正常的）用法。但是，您必须小心，例如，您选择的类型符合相同的有符号/无符号标准，或者它们对运算符的响应类似。那么之后更改类型会更容易。

另一种选择是使用模板来避免在编译之前修复类型。定义为的类：

```
template <typename CharType>
class Whatever
{
   CharType aChar;
   ...
}; 
```

能够使用您选择的任何字符类型，同时以相同的方式响应所有运算符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T13:41:55.460

typedef 的另一个优点是，如果使用得当，它们可以提高可读性。作为一个非常愚蠢的示例，Meter 和 Degree 都可以是双精度数，但您想区分它们。使用 typedef 是一种快速简便的解决方案，可以[使错误更加明显](http://www.joelonsoftware.com/articles/Wrong.html)。

**注意**：对上述示例更强大的解决方案是为仪表和度数创建不同的类型。因此，编译器可以自己强制执行。这需要一些工作，但这并不总能得到回报。如上面链接的文章中所述，使用 typedefs 是使错误**可见的一种快速简便的方法。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T13:31:42.850

是的，这是 typedef 的完美用法，至少在 C 中是这样。

对于 C++，可能有人认为模板是一个更好的主意（正如 Diego Sevilla 所建议的那样），但它们也有其缺点。（如果使用该数据类型的所有内容尚未包装在几个类中、编译时间较慢和源文件结构更复杂等，则需要额外的工作。）

将这两种方法结合起来也很有意义，即为模板参数提供 typedef 名称。

请注意，当您通过网络发送数据时，char 和其他整数类型可能无法互换（例如，由于字节序）。在这种情况下，使用具有专门功能的模板类可能更有意义。（send<char> 发送字节，send<short> 先将其转换为网络字节序）

另一种解决方案是使用辅助方法 (convertToNetworkOrderBytes()) 创建一个“BufferElementType”类，但我敢打赌，这对你来说太过分了。

# c# - 需要 Alt-Ctrl-Del 的键码

> ID：581390
> 
> 赞同：0
> 
> 时间：2009-02-24T11:15:23.473
> 
> 标签：c#

我需要c#中++的键码`Alt`，例如`Ctrl``Del`

```
const int KEYEVENTF_KEYUP = 0x2;
const int KEYEVENTF_KEYDOWN = 0x0;      
keybd_event(0x11, 0, KEYEVENTF_KEYDOWN, 0);
keybd_event(0x41, 0, KEYEVENTF_KEYDOWN, 0);
keybd_event(0x11, 0, KEYEVENTF_KEYUP, 0); 
keybd_event(0x41, 0, KEYEVENTF_KEYUP, 0); 
```

这是`ctrl`+的代码`a`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T11:20:01.760

您无法捕获`Alt`++ 。它被操作系统捕获并且**非常**安全。`Ctrl``Del`

 **甚至像 VMWare 这样的程序也必须使用`Alt`++`Ctrl`来模拟它，`Ins`因为 Windows 可以很好地保护它，而且有充分的理由。如果你能颠覆它，Windows 登录安全将毫无用处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T11:19:56.457

`Alt`++被操作系统使用（我记得从前，甚至是 BIOS）`Ctrl`。`Del`

所以我认为你不能在 C# 中使用它，甚至不能用于发送击键。

# windows - Joomla 1.5：为什么尝试发送电子邮件会导致：PHPMAILER_RECIPIENTS_FAILED

> ID：581393
> 
> 赞同：0
> 
> 时间：2009-02-24T11:17:18.010
> 
> 标签：windows, email, smtp, joomla

我正在尝试从 Joomla 发送电子邮件！1.5.9，但不断收到此错误消息：PHPMAILER_RECIPIENTS_FAILED *recipient_name* < *recipient_email* >

还有一些事实：

*   这是一个 WAMP 服务器（joomla 1.5.9，PHP 5.2.8）
*   验证电子邮件发送完全没有问题
*   Joomla！设置为使用 SMTP
*   使用了 IIS SMTP 服务（虽然我不是 100% 确定它的配置）
*   检查发件人/收件人时，诊断工具 smtpdiag 显示没有问题

有任何想法吗？

谢谢，奥马尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T11:31:39.597

也许在@Joomla 论坛本身之前已经回答了这个问题。

[http://forum.joomla.org/viewtopic.php?f=431&t=272547](http://forum.joomla.org/viewtopic.php?f=431&t=272547)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-02T09:41:08.407

我尝试了 Sukumar 提供的链接中给出的许多解决方案，但都没有奏效。

然后我尝试使用 PHP 邮件功能而不是 SMTP 并且它起作用了:)

在根文件夹的 configuration.php 中更改以下行

```
var $mailer = 'smtp'; 
```

到

```
var $mailer = 'PHP mail'; 
```

# .net - 做跨线程 Winforms 的最简单方法是什么？

> ID：581405
> 
> 赞同：1
> 
> 时间：2009-02-24T11:22:15.250
> 
> 标签：.net, winforms, multithreading

为了能够进行正确的跨线程访问，我使用了如下代码：

```
Private Delegate Sub DelSetButton(ByVal button As Button, ByVal label As String, ByVal enabled As Boolean)

Private Sub SetButton(ByVal button As Button, ByVal label As String, ByVal enabled As Boolean)
    If InvokeRequired Then
        Invoke(New DelSetButton(AddressOf SetButton), button, label, enabled)

    Else
        button.Enabled = enabled
        button.Text = label

    End If
End Sub 
```

这不可爱。

*   我必须创建一个具有相同签名的委托
*   我需要为每种控件类型或我想要的每个操作编写一个类似的调用

我正在使用 VB.NET 9 / .NET Framework 3.5。

有没有更好的方法呢？还是我坚持使用这个模型？

**更新 ：**

回答完我最喜欢这个：

```
Private Sub ContSetButton(ByVal button As Button, ByVal label As String, ByVal enabled As Boolean)
    Invoke(New Action(Of Button, String, Boolean)(AddressOf SetButton), button, label, enabled)
End Sub

Private Sub SetButton(ByVal button As Button, ByVal label As String, ByVal Enabled As Boolean)
    button.Text = label
    button.Enabled = Enabled
End Sub 
```

仍然不完美，但比我最初所做的要好。

如果你能做得比这更好，请随时回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T11:31:18.007

您可以使用 a`BackgroundWorker`和使用该`ReportProgress`方法与 UI 线程进行通信。在 UI 线程中，您处理`ProgressChanged`事件并适当地更新 UI。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T11:32:01.717

（这是假设您需要比`BackgroundWorker`提供的更详细的控制 - 如果这对您来说足够了，那么这是正确的答案，正如 Mehrdad Afshari 所建议的那样。）

您不需要创建委托类型。使用泛型`Func`和`Action`类型。

与其测试 InvokeRequired，您可能只想拥有两种方法 - 一种*总是*调用，然后是一种“Impl”（或其他）方法，它只在 UI 线程上调用并且不执行任何调用。这是对模式的改变而不是新模式，但它可能会更干净一些。

应该可以编写一个更通用的方法来处理这个问题，但是我需要一点时间来思考它......而且我也会用 C# 而不是 VB 来呈现它......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T11:34:30.713

有很多选择。其中之一是使用`SynchronizationContext`（对不起我的 C#）

```
SynchronizationContext context = SynchronizationContext.Current;

// Later on
private void SetButton(Button button, string label)
{
    context.Send(delegate 
        {
            button.Text = label;
        }, null);
} 
```

差不多就是这样。将匿名委托翻译成 VB.NET 就可以了。

另一种选择是使用面向方面的编程（AOP）并有一个方面来编组对 UI 线程的某些调用：

```
[ExecuteOnUIThread()]
protected virtual void SetButton(Button button, string label)
{
    button.Text = label;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-19T15:05:54.353

作为此处所有出色答案的旁注，也许[PostSharp](http://www.postsharp.org)可以让您创建一个对您有帮助的方面。

这样，您可以像这样编写代码：

```
<InvokeMightBeRequired>
Private Sub SetButton(ByVal button As Button, ByVal label As String, ByVal enabled As Boolean)
    button.Enabled = enabled
    button.Text = label
End Sub 
```

这将注入必要的代码来处理调用部分。

请注意，我不知道这是否可能，但我怀疑它是可能的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T11:38:48.860

我在 EventHandler 和 EventHandler 上创建了一个扩展方法，它允许您以安全的方式引发事件。那是; 如果需要，将调用事件处理程序。因此，如果您想在另一个线程上进行某些处理时更新 Winforms 控件，您可以安全地引发事件。如有必要，将调用事件处理程序。

看起来像这样（对不起 C# 代码）

```
public static class EventExtensions
{

    public static void Raise( this EventHandler target, object sender, EventArgs e )
    {
        EventHandler handler = target;

        if( handler != null )
        {
            Delegate[] delegates = handler.GetInvocationList ();

            EventExtensions.Raise (delegates, sender, e);
        }
    }

    public static void Raise<TEventArgs>(this EventHandler<TEventArgs> target, object sender, TEventArgs e ) 
                         where TEventArgs : EventArgs
    {
        EventHandler<TEventArgs> handler = target;

        if( handler != null )
        {
            Delegate[] delegates = handler.GetInvocationList ();

            EventExtensions.Raise (delegates, sender, e);
        }
    }

    private static void Raise( Delegate[] delegates, object sender, EventArgs e )
    {
        foreach( Delegate d in delegates )
        {
            ISynchronizeInvoke target = d.Target as ISynchronizeInvoke;

            if( target != null && target.InvokeRequired )
            {
               target.Invoke (d, new object[] { sender, e });
            }
            else
            {
               d.DynamicInvoke (sender, e);
            }
        }
    }
} 
```

此扩展方法使您能够引发事件，而不必担心是否需要线程同步。只需像这样提出您的事件：

```
MyEvent.Raise (this, new MyEventArgs ( ... )); 
```

（我也有一个需要 SynchronizationContext 的重载）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-18T19:46:37.990

我在代码中使用匿名方法的委托，因为这不需要在当前代码块之外创建方法（每个人都知道）。但有时需要使用参数化委托来消除重复代码，然后匿名方法就没有用了。我试过这样的解决方案：

```
// somewhere in class body
delegate EventHandler d(ComboBox c1, ComboBox c2);

// in a method (eg. in contructor)
d d1 = delegate(arg1, arg2) // eg. 2 args
{
 return new EventHandler(
  delegate
  {
   // some doing ...   
  }
 );
};

// And then installation of event handler 
combo1.SelectionChangeCommitted += d1(combo1, combo2); 
```

问题是提出这个事件。使用命名方法时（例如，在键入 += 后使用 VS 中的 TAB 键生成命名方法，例如 eg. `combo1_SelectionChangeCommited`），总是有可能运行：`combo1_SelectionChangeCommited(c1, c2)`.

要在 d1 上运行 typed，我找到的一个解决方案是 Frederik 的 class `EventExtensions`。在我看来这是件好事。这意味着，作者在核心 C# 编程方面的水平比我高。因此我想问他：Frederick，我可以在我刚刚研究的硕士论文中正式使用这个代码吗？宣布代码片段课程的作者。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-04-28T17:21:53.750

如上所述，但认为会给 lambda 等效项

```
//module parameter - initialise on load
private SynchronizationContext = SynchronizationContext.Current;
//in the method where you want to modify UI control parameters
ctx.Send(state =>
{
    Left = Screen.PrimaryScreen.WorkingArea.Width - Width - 10;
    Top = Screen.PrimaryScreen.WorkingArea.Height - Height;
    SetBounds(Left, Top, Width, Height);
    Opacity = 5;
}, null); 
```

我知道你已经得到了这个答案，但思想会分享我所知道的一点点。

# c++ - 为什么 C++ 向量称为向量？

> ID：581426
> 
> 赞同：178
> 
> 时间：2009-02-24T11:30:53.577
> 
> 标签：c++, stl, vector

这个问题真的很不言自明。我对数学中的向量知之甚少，但我并没有真正看到与 C++ 向量的链接。

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2009-04-17T00:12:32.850

它被称为向量是因为标准模板库的设计者 Alex Stepanov 正在寻找一个名称来将其与内置数组区分开来。他现在承认他犯了一个错误，因为数学已经使用术语“向量”来表示固定长度的数字序列。C++11 通过引入一个行为类似于数学向量的类“数组”来加剧这个错误。

亚历克斯的教训：每次命名时都要非常小心。

* * *

## 回答 #2

> 赞同：124
> 
> 时间：2009-02-24T11:36:05.250

向量的数学定义是集合的成员，集合是特定集合 ( )`S`^(`n`)中的有序值序列。`S`这就是 C++`vector`存储的内容。

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2009-02-24T13:41:36.337

Bjarne Stroustrup*的《C++ 编程语言*》节选：

> “有人可能会争辩说*valarray* 应该被称为*向量* ，因为它是一个传统的数学向量，并且该*向量* 应该被称为*数组*。然而，这不是术语演变的方式。”

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-02-24T11:36:10.570

该名称来自线性代数，其中向量是只有一列或只有一行的矩阵。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2014-01-10T17:13:48.193

为了补充@MarkRuzon 的出色回应：

Alex 说，为了给现在称为 std::vector 的东西起个名字，他观察到了[Scheme](https://en.wikipedia.org/wiki/Scheme_(programming_language))和[Common Lisp](https://en.wikipedia.org/wiki/Common_Lisp)给类似数据结构起的名字。

后来他承认他错了，因为[C++](https://isocpp.org/)向量与数学中的向量无关。

他还说，他将 50 人社区的错误引入了 500 万人的社区，因此错误很可能永远存在。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-02-24T13:57:53.177

只是说为什么它可能不被调用`array`：因为`std::vector`有一个动态大小。从概念上讲，数组的长度是固定的。顺便说一句，下一个 C++ 标准有一个`std::array`模板，它的大小是固定的，应该优先于普通数组：

```
std::array<int, 4> f = { 1, 2, 3, 4 }; 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-05-19T14:04:13.890

这只是名字。C++*向量*可以很好地（或者甚至更准确）称为*动态数组*或*可调整大小的数组*，但这个名称只是简单地**选择**了。这个*向量*与数学中的向量不同，因为在数学中向量是任何集合**V**的成员，因此在这个集合上定义了两个重要的**操作：** **+**（向量的加法）和**x**（向量乘以来自场的标量**F** ) 并且这些操作**满足 8 个公理**：

* * *

**加法的结合性**

u + (v + w) = (u + v) + w

**加法交换律**

u + v = v + u

**添加的标识元素**

存在一个元素 0 ∈ **V**，称为*零向量*，使得 v + 0 = v 对于所有 v ∈ **V**。

**加法的逆元素**

对于每个 v ∈ V，存在一个元素 -v ∈ **V**，称为 v 的*加法逆*元，使得 v + (-v) = **0**

**标量乘法与域乘法的兼容性**

a(bv) = (ab)v

**标量乘法的单位元**

**1** v = v，其中**1**表示**F**中的*乘法恒等式*。

 ****标量乘法相对于向量加法的分布**  </p>

a(u + v) = au + av

**标量乘法相对于场加法的分布**

(a + b)v = av + bv

* * *

C++`std::vector`支持所有这些（不是直接支持，而是通过 C++ 特性），因此它可以以某种方式称为向量，但这只是俗语，例如Bjarne Stroustrup 在*“C++ 编程语言”*`Vallaray`中指出的直接支持其中一些。

 ** * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-05-19T13:38:30.437

很久以前，在[B 语言](http://www.example.com/)中有向量类型。然后 C 语言称它们为“数组”。然后带有类的 C 和 C++ 语言只是派生它...

这当然不是故事的全部。如上所述，斯捷帕诺夫做出了实际决定。但是如果“向量”仍然在 C 中使用，结果可能看起来完全不同。

PS。我想知道为什么 C 重命名“数组”。确切的原因是什么？

PS2。对于 C++ 这样的语言，IMO 更好地表示“一个类型保存元素可以通过 operator[] 合理访问”（即不是 42[some_array_object]），例如将 std::map 实例化为“关联数组”。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-24T11:33:45.050

向量只是一个值序列，所有类型都相同。这与在数学中的使用非常吻合。我猜向量应该支持一些常见操作（例如加法和标量缩放）的数学思想没有被继承，重要的方面主要是结构。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-24T11:35:23.050

此外，如果你让它存储整数或浮点数，它确实是存储 N 维向量的绝佳类型。毕竟，向量是按特定顺序保存的数字列表。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-02-21T05:49:29.567

但是数学向量不是动态的，我从未见过从 2D 到 3D 或其他任何东西的变化，如果传统数组可以产生更好的向量的话。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-24T11:35:13.287

我猜它来自术语[row vector](http://en.wikipedia.org/wiki/Row_vector)。此外，计算机科学家喜欢为事物想出新的名字……

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-03-15T11:17:12.270

将 C++ 向量视为动态数组，可以通过插入或删除元素来更改其大小。它们与向量的数学定义无关。

**数学中的向量**

考虑一个`nxm`称为 的矩阵`A`，其中`n`对应于行数，`m`对应于列数。在数学上下文中，一旦你引入了这样的矩阵，那么以后，你就不能在`A`' 范围之外进行任何操作，你也不能扩展`A`' 的大小。这意味着您不能引用`[n + 1]`和/或的索引`[m + 1]`。

现在，一个向量也`A`派生了这些属性，而它们的维度将始终是`1xm`（`[i]`在 中选择的任何行`A`）或`nx1`（`[j]`在 中选择的任何列`A`）。向量也不能指定为`2xn`，因为向量的集合不能被解释为*一个*向量，而一个向量——假设它是 的`[i]`列向量，`A`维度为`1xm`——可以被解释为一个矩阵。

重要的一点是，一旦从数学角度引入向量，就无法更改向量的维度。

**C++ 中的向量**

在 C++ 中，向量就像数学中的向量，但与数学不同，**它们的大小可以更改**。大小作为一个术语在这里适用，因为它意味着一个特定向量包含的元素计数。

当您有一个向量向量时，您可以根据 C++ 向量使用术语维度：`std::vector<std::vector<T>>> ragged_array`. 在这个例子中，我称这个向量为“ragged”，因为它演示了如何独立改变该向量的每个向量的大小。它不仅违反了一旦在数学中引入特定向量就不能改变维度的规则，而且还证明了它不能用作矩阵。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-24T11:38:27.880

不知道真正的原因，但 C++ 将其称为向量而不是数组，减少了 C 和 C++ 结构之间的混淆，尽管它们具有相同的作用。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-17T00:46:28.290

想知道类型的参数化对名称有什么作用..

这里有一个专栏被炸毁了..（查看一些服务器端 ASP.NET HTML 编码技巧的源代码）

还是一排？

话又说回来，在 MIMD 甚至 SSE 向量机上下文中考虑它，这个名字听起来仍然非常好。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2011-01-06T18:57:38.737

它来自由向量构建的矩阵结构

# sql - 如何检查数据库中是否存在临时表

> ID：581427
> 
> 赞同：5
> 
> 时间：2009-02-24T11:31:00.643
> 
> 标签：sql, sql-server, sql-server-2005

我实际上是在数据库中删除一个临时表。只有当它存在于数据库中时，我才必须删除它。请让我知道如何检查数据库中是否存在表。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T11:35:58.167

```
if object_id('tempdb..#myTempTable') is not null
    drop table #myTempTable 
```

# deployment - 将 Web 应用程序部署到正在运行的 Tomcat

> ID：581436
> 
> 赞同：9
> 
> 时间：2009-02-24T11:33:15.850
> 
> 标签：deployment, configuration, tomcat, servlets

我想收集一些关于将 Web 应用程序部署到正在运行的 Tomcat 的最佳实践。不久前，我不得不描述我们的 Web 应用程序的部署过程，这个过程看起来相当混乱。

假设我们在 WAR 文件 (foo.war) 中正确配置了一个应用程序，并且不需要额外的配置。在这种情况下，部署过程相当简单：

*   将 foo.war 文件复制到 $CATALINA_HOME/webapps 目录。如果应用程序正确启动，应用程序将自动部署到 $CATALINA_HOME/webapps/foo 目录。

要取消部署应用程序：

*   从 $CATALINA_HOME/webapps 中删除 foo.war 文件。如果应用程序正确卸载，它将被卸载并且 $CATALINA_HOME/webapps/foo 将被删除。

现在我想在我正在运行的应用程序中覆盖一些上下文参数。阅读完[文档](http://tomcat.apache.org/tomcat-6.0-doc/config/context.html)后，我需要做的就是：

1.  创建一个名为 foo.xml 的 context.xml 文件
2.  将文件复制到 $CATALINA_BASE/conf/[enginename]/[hostname]/ 目录。

不幸的是，这不起作用：应用程序不会重新启动。根据经验，我们发现唯一可行的解​​决方案是将 war 文件部署到 $CATALINA_HOME/webapps 之外的位置。此外，WAR文件中可配置的上下文参数的默认值应该在web.xml中指定，因为WAR文件中的context.xml在外面有context.xml时是不会被读取的。

这是 foo.xml 的一个简单示例：

```
<?xml version='1.0' encoding='utf-8'?>                           
<Context docBase="/path-to-deployment-directory/foo.war">
    <Parameter name="myparam" value="newvalue" override="false"/>
</Context> 
```

如果您希望“newvalue”覆盖 WAR 的 web.xml 中指定的值，请务必为参数指定 override=false。这对我们来说并不明显。

因此，要将应用程序部署到正在运行的 Tomcat：

1.  创建一个名为 foo.xml 的 context.xml 文件
2.  将文件复制到 $CATALINA_BASE/conf/[enginename]/[hostname]/ 目录。
3.  将 foo.war 复制到 foo.xml 的 docBase 中指定的位置；应用程序将自动部署。

要应用新的上下文参数：

*   将参数值添加到 foo.xml 并保存文件；应用程序将自动重新部署。

要取消部署应用程序：

*   从 $CATALINA_BASE/conf/[enginename]/[hostname]/ 目录中删除 foo.xml

请注意，删除 foo.war 也可以，但也会删除 foo.xml。

* * *

到目前为止，我有以下问题：

1.  在不停止 tomcat 的情况下部署 Web 应用程序是否是最佳实践？我听到一种观点，即从不需要部署到正在运行的 tomcat 上，因为人们在单独的 tomcat 中运行每个应用程序。
2.  将 WAR 文件复制到 $CATALINA_HOME/webapps 是个好主意，还是最好将它们保存在单独的位置？
3.  如何配置部署到 $CATALINA_HOME/webapps 的应用程序
4.  为什么 catalina.out 中没有用于部署应用程序的 INFO 行，而有用于取消部署的行？是否可配置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T06:07:04.903

关于问题 (1)，Tomcat 非常适合将 servlet 部署到正在运行的服务器中。可能存在安全性问题或可能是 DOS 或配置原因，您将拥有单独的服务器实例。

您可以灵活地执行任何一种方式，但部署到已经运行的服务器通常更方便。这是 servlet 体系结构中的一个内置功能。:)

对于 (2)，您可以自行决定将 WAR 放在哪里。听起来您已经将其配置为非标准（我应该说是非默认）方式。检查*server.xml*文件以获取服务器实例中的设置。检查类似`unpackWARs`和的属性`autoDeploy`。

对于 (3) 和 (4) 以及您的 (1,2) 问题，最好查阅 Tomcat 文档以了解您的 Tomcat 版本的部署模型。您应该能够使用相同的文档来确定您的服务器是如何配置的。

请参阅Tomcat 手册中的[Tomcat Web 应用程序部署](http://tomcat.apache.org/tomcat-6.0-doc/deployer-howto.html)，根据您的 Tomcat 版本进行调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T12:15:20.660

一种解决方案是使用管理器应用程序。如果您认为使用它是安全的，那么您可以轻松部署、启动、停止和取消部署应用程序：

[http://localhost:8080/manager/deploy?path=[context_path]](http://localhost:8080/manager/deploy?path=[context_path]) [http://localhost:8080/manager/start?path=[context_path]](http://localhost:8080/manager/start?path=[context_path]) [http://localhost:8080/manager/stop?path=[context_path ]](http://localhost:8080/manager/stop?path=[context_path]) [http://localhost:8080/manager/undeploy?path=[context_path]](http://localhost:8080/manager/undeploy?path=[context_path])

有一些 ant 任务可以帮助您完成这些任务。

我在猜测，但不确定，停止和启动应用程序会使其重新读取 context.xml。

关于您的第二个问题，我认为出于维护原因，最好将战争文件保存在 webapps 目录中。

# sql - 选择子查询的 COUNT(*) 而不运行两次

> ID：581440
> 
> 赞同：19
> 
> 时间：2009-02-24T11:34:30.323
> 
> 标签：sql, sql-server, tsql, count, paging

我有一个程序来返回一个受页码和其他东西限制的结果集。作为 OUTPUT 参数，我需要根据除页码以外的参数返回所选行的总数。所以我有这样的事情：

```
WITH SelectedItems AS
(SELECT Id, Row1, Row2, ROW_NUMBER() OVER (ORDER BY Row1) AS Position
FROM Items
WHERE Row2 = @Row2)
SELECT Id, Row1, Row2
FROM SelectedItems
WHERE Position BETWEEN @From AND @To 
```

然后我需要将 OUTPUT 参数设置为内部查询中的行数。我可以只复制查询并对其进行计数，但是此查询可能会返回数千行（并且将来会更多），因此我正在寻找具有良好性能的方法。我在考虑表变量，这是个好主意吗？或者有什么其他建议？

更具体地说，它是 Microsoft SQL Server 2008。

谢谢你，简

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-24T15:46:34.070

您可以使用 COUNT(*) 在主查询中将总行数计为单独的列。像这样：

```
WITH SelectedItems AS
(SELECT Id, Row1, Row2, ROW_NUMBER() OVER (ORDER BY Row1) AS Position, 
COUNT(*) OVER () AS TotalRows
FROM Items
WHERE Row2 = @Row2)
SELECT Id, Row1, Row2
FROM SelectedItems
WHERE Position BETWEEN @From AND @To 
```

这将在您的结果集中而不是在输出参数中返回计数，但这应该符合您的要求。否则，结合临时表：

```
DECLARE @tmp TABLE (Id int, RowNum int, TotalRows int);

WITH SelectedItems AS
(SELECT Id, Row1, Row2, ROW_NUMBER() OVER (ORDER BY Row1) AS Position, 
COUNT(*) OVER () AS TotalRows
FROM Items
WHERE Row2 = @Row2)
INSERT @tmp
SELECT Id, Row1, Row2
FROM SelectedItems
WHERE Position BETWEEN @From AND @To

SELECT TOP 1 @TotalRows = TotalRows FROM @tmp
SELECT * FROM @tmp 
```

您会发现仅对分页结果使用临时表不会使用太多内存（当然取决于您的页面大小），并且您只能将其保持很短的时间。从临时表中选择完整的结果集并选择 TotalRows 只会花费一点时间。

这将比运行一个完全独立的查询快得多，在我的测试中（重复 WITH）使执行时间加倍。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T11:38:15.900

我认为您应该在单独的查询中执行此操作。虽然这两个查询可能看起来几乎相同，但查询优化器处理它们的方式会有很大不同。

从理论上讲，SQL Server 甚至可能不会遍历子查询中的所有行来计算它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T12:03:21.907

我现在无法访问我的代码库，但我相信您可以使用 COUNT() OVER（或类似命令）将总行数作为子查询的一部分返回。然后，您可以将其作为最终结果集的一部分返回。它在每一行中都会重复，但在我看来，对于使用分页并且最终结果应该有限的应用程序来说，这是一个较小的性能损失。

几个小时后，我将发布确切的代码。

编辑：这是我用来生成计数的行。最后，我们的开发人员想要一个单独的方法来自己获取计数，所以现在我在同一个存储过程中的两个位置维护搜索条件。

```
COUNT(*) OVER (PARTITION BY '') AS TotalCount 
```

将其添加到您的 CTE，然后您可以选择 TotalCount，它将成为您每一行中的一列。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-17T19:25:23.030

您必须在不限制范围的情况下运行整个查询至少一次以获得完整的行数。由于无论如何您都将这样做，因此您应该选择@@RowCount 以输出找到的总行数，而不是在每行中使用冗余的 count(*) 列重载数据读取器。

## 1.第一次运行NEW查询时：

```
select YOUR_COLUMNS 
from YOUR_TABLE 
where YOUR_SEARCH_CONDITION 
order by YOUR_COLUMN_ORDERING_LIST;
select @@rowcount; 
```

## 2\. 只读取前 X 行

上面的查询避免了用冗余的 COUNT(*) 列淹没 SqlDataReader，否则每次调用 SqlDataReader.Read() 时都会发送该列。 **由于您是第一次运行查询...而不是选择范围，只需读取前 X 行。** 这正是您想要的……完整的结果计数、前 X 条记录以及没有冗余计数列的结果集的高效流式传输。

## 3\. 对于 SAME 查询的后续运行以获取结果的子集

```
select YOUR_COLUMNS 
from (select YOUR_COLUMNS, ROW_NUMBER() 
over(order by BY YOUR_COLUMN_ORDERING_LIST) as RowNum) Results 
where Results.RowNum between @From and @To; 
```

在任何情况下，`@@rowcount`这是在不限制结果集的情况下在第一次运行查询时访问计数的最直接方法（无论如何你都想要第 X 个结果），不运行单独的 count() 查询，不使用临时表，并且不包括冗余的 count() 列。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-25T03:13:55.370

您不能将输出变量设置为@@RowCount 吗？这将获得受最后执行语句影响的行：

```
SELECT stuff FROM mytable

SET @output = @@ROWCOUNT 
```

这应该为您提供所需的内容，并且不涉及再次运行查询。

# algorithm - 使用分隔符连接字符串

> ID：581448
> 
> 赞同：27
> 
> 时间：2009-02-24T11:36:23.173
> 
> 标签：algorithm, language-agnostic, string

将字符串列表加入组合分隔字符串的最佳方法是什么。我主要关心何时停止添加分隔符。我将在我的示例中使用 C#，但我希望这与语言无关。

编辑：我没有使用 StringBuilder 使代码稍微简单一些。

**使用 For 循环**

```
for(int i=0; i < list.Length; i++)
{
    result += list[i];
    if(i != list.Length - 1)
        result += delimiter;
} 
```

**使用 For Loop 设置之前的第一项**

```
result = list[0];
for(int i = 1; i < list.Length; i++)
    result += delimiter + list[i]; 
```

这些不适用于您事先不知道列表长度的 IEnumerable，因此

**使用 foreach 循环**

```
bool first = true;
foreach(string item in list)
{
    if(!first)
        result += delimiter;
    result += item;
    first = false;
} 
```

**foreach 循环的变体**

从乔恩的解决方案

```
StringBuilder builder = new StringBuilder();
string delimiter = "";
foreach (string item in list)
{
    builder.Append(delimiter);
    builder.Append(item);
    delimiter = ",";       
}
return builder.ToString(); 
```

**使用迭代器**

再次来自乔恩

```
using (IEnumerator<string> iterator = list.GetEnumerator())
{
    if (!iterator.MoveNext())
        return "";
    StringBuilder builder = new StringBuilder(iterator.Current);
    while (iterator.MoveNext())
    {
        builder.Append(delimiter);
        builder.Append(iterator.Current);
    }
    return builder.ToString();
} 
```

还有哪些其他算法？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-24T11:43:48.430

在这里不可能给出真正与语言无关的答案，因为不同的语言和平台以不同的方式处理字符串，并为加入字符串列表提供不同级别的内置支持。你可以用两种不同的语言编写几乎*相同*的代码，用一种语言会很棒，而用另一种语言会很糟糕。

在 C# 中，您可以使用：

```
StringBuilder builder = new StringBuilder();
string delimiter = "";
foreach (string item in list)
{
    builder.Append(delimiter);
    builder.Append(item);
    delimiter = ",";       
}
return builder.ToString(); 
```

这将在除第一个项目之外的所有项目前*加上*逗号。类似的代码在 Java 中也会很好。

编辑：这是另一种选择，有点像伊恩后来的回答，但正在研究一般 `IEnumerable<string>`.

```
// Change to IEnumerator for the non-generic IEnumerable
using (IEnumerator<string> iterator = list.GetEnumerator())
{
    if (!iterator.MoveNext())
    {
        return "";
    }
    StringBuilder builder = new StringBuilder(iterator.Current);
    while (iterator.MoveNext())
    {
        builder.Append(delimiter);
        builder.Append(iterator.Current);
    }
    return builder.ToString();
} 
```

在原始答案后近 5 年编辑...

在 .NET 4 中，[`string.Join`](http://msdn.microsoft.com/en-us/library/system.string.join%28v=vs.100%29.aspx)重载非常显着。有一个`IEnumerable<T>`自动调用`ToString`的重载，并且有一个重载 for `IEnumerable<string>`。因此，无论如何，对于 .NET，您不再需要上面的代码了。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-24T11:46:18.547

在 .NET 中，您可以使用[String.Join 方法](http://msdn.microsoft.com/en-us/library/57a79xd0.aspx)：

```
string concatenated = String.Join(",", list.ToArray()); 
```

使用[.NET Reflector](http://www.red-gate.com/products/reflector/)，我们可以了解它是如何做到的：

```
public static unsafe string Join(string separator, string[] value, int startIndex, int count)
{
    if (separator == null)
    {
        separator = Empty;
    }
    if (value == null)
    {
        throw new ArgumentNullException("value");
    }
    if (startIndex < 0)
    {
        throw new ArgumentOutOfRangeException("startIndex", Environment.GetResourceString("ArgumentOutOfRange_StartIndex"));
    }
    if (count < 0)
    {
        throw new ArgumentOutOfRangeException("count", Environment.GetResourceString("ArgumentOutOfRange_NegativeCount"));
    }
    if (startIndex > (value.Length - count))
    {
        throw new ArgumentOutOfRangeException("startIndex", Environment.GetResourceString("ArgumentOutOfRange_IndexCountBuffer"));
    }
    if (count == 0)
    {
        return Empty;
    }
    int length = 0;
    int num2 = (startIndex + count) - 1;
    for (int i = startIndex; i <= num2; i++)
    {
        if (value[i] != null)
        {
            length += value[i].Length;
        }
    }
    length += (count - 1) * separator.Length;
    if ((length < 0) || ((length + 1) < 0))
    {
        throw new OutOfMemoryException();
    }
    if (length == 0)
    {
        return Empty;
    }
    string str = FastAllocateString(length);
    fixed (char* chRef = &str.m_firstChar)
    {
        UnSafeCharBuffer buffer = new UnSafeCharBuffer(chRef, length);
        buffer.AppendString(value[startIndex]);
        for (int j = startIndex + 1; j <= num2; j++)
        {
            buffer.AppendString(separator);
            buffer.AppendString(value[j]);
        }
    }
    return str;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-24T11:42:49.100

当某些语言在一行中提供对此的支持时，几乎没有理由让它与语言无关，例如 Python 的

```
",".join(sequence) 
```

有关更多信息，请参阅[加入文档](http://docs.python.org/library/stdtypes.html#str.join)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-24T11:58:07.270

对于 python，请确保您有一个字符串列表，否则 ','.join(x) 将失败。对于使用 2.5+ 的安全方法

```
delimiter = '","'
delimiter.join(str(a) if a else '' for a in list_object) 
```

"str(a) if a else ''" 适用于 None 类型，否则 str() 最终会生成 then 'None'，这不好;)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-24T19:52:48.410

在 PHP 的[implode()](http://php.net/implode)中：

```
$string = implode($delim, $array); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-24T11:45:35.680

我总是添加分隔符，然后在必要时将其删除。这样，当您只关心执行一次工作时，您不会为循环的每次迭代都执行 if 语句。

```
StringBuilder sb = new StringBuilder();

foreach(string item in list){
    sb.Append(item);
    sb.Append(delimeter);
}

if (list.Count > 0) {
    sb.Remove(sb.Length - delimter.Length, delimeter.Length)
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-24T13:20:21.957

我会递归地表达这一点。

*   检查字符串参数的数量是否为 1。如果是，则返回它。
*   否则递归，但将前两个参数与它们之间的分隔符结合起来。

Common Lisp 中的示例：

```
(defun join (分隔符 &rest 字符串)
  （如果（空（其余字符串））
      （第一个字符串）
      （申请#'加入
             分隔符
             （连接'字符串
                          （第一个字符串）
                          分隔符
                          （第二个字符串））
             （cddr 字符串））））

```

更惯用的方法是使用`reduce`，但这扩展为与上面几乎完全相同的指令：

```
(defun join (分隔符 &rest 字符串)
  （减少（λ（ab）
            (concatenate 'string a delimiter b))
          字符串））

```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-11-24T01:01:26.720

```
List<string> aaa = new List<string>{ "aaa", "bbb", "ccc" };
string mm = ";";
return aaa.Aggregate((a, b) => a + mm + b); 
```

你得到

```
aaa;bbb;ccc 
```

lambda 非常方便

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-24T11:49:31.923

在 C# 中，您可以只使用[String.Join(separator,string_list)](http://msdn.microsoft.com/en-us/library/system.string.join(VS.71).aspx)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-02-22T04:13:45.993

问题是计算机语言很少有字符串布尔值，也就是说，字符串类型的方法可以做任何有用的事情。SQL Server 至少有 is[not]null 和 nullif，它们结合起来解决分隔符问题，顺便说一句：isnotnull(nullif(columnvalue, ""),"," + columnvalue))

问题是在语言中有布尔值和字符串，除了丑陋的编码形式外，两者永远不会相遇，例如

连接字符串 = 字符串 1 + "," + 字符串 2；if (fubar) concatstring += string3 concatstring += string4 等

我已经尽力避免所有这些丑陋，玩逗号游戏和连接连接，但我仍然留下了一些，包括当我错过了一个逗号并且变量为空时的 SQL Server 错误。

乔纳森

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-24T11:42:55.247

这就是python解决问题的方式：

```
','.join(list_of_strings) 
```

不过，在琐碎的情况下，我永远无法理解对“算法”的需求

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-24T11:49:50.100

由于您将此语言标记为不可知论者，

这就是你在 python 中的做法

```
# delimiter can be multichar like "| trlalala |"
delimiter = ";"
# sequence can be any list, or iterator/generator that returns list of strings
result = delimiter.join(sequence)
#result will NOT have ending delimiter 
```

**编辑：**我看到我被几个人打败了。对不起重复

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-24T11:50:42.250

这是 C# 中的一个工作解决方案，在 Java 中，您可以在迭代器上使用类似的每个。

```
 string result = string.Empty; 

        // use stringbuilder at some stage.
        foreach (string item in list)
            result += "," + item ;

        result = result.Substring(1);
        // output:  "item,item,item" 
```

如果使用 .NET，您可能希望使用扩展方法，以便您可以执行 **list.ToString(",")** 有关详细信息，请查看[分隔符分隔 ToString for Array、List、Dictionary、Generic IEnumerable](http://www.codemeit.com/linq/c-array-delimited-tostring.html)

```
// contains extension methods, it must be a static class.
public static class ExtensionMethod
{
    // apply this extension to any generic IEnumerable object.
    public static string ToString<T>(this IEnumerable<T> source,
      string separator)
    {
        if (source == null)
           throw new ArgumentException("source can not be null.");

        if (string.IsNullOrEmpty(separator))
           throw new ArgumentException("separator can not be null or empty.");

        // A LINQ query to call ToString on each elements
        // and constructs a string array.
        string[] array =
         (from s in source
          select s.ToString()
          ).ToArray();

        // utilise builtin string.Join to concate elements with
        // customizable separator.
        return string.Join(separator, array);
    }
} 
```

编辑：出于性能原因，用此线程中提到的字符串生成器解决方案替换连接代码。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-24T12:10:35.353

我认为做这样的事情的最好方法是（我将使用伪代码，所以我们将使它真正与语言无关）：

```
function concat(<array> list, <boolean> strict):
  for i in list:
    if the length of i is zero and strict is false:
      continue;
    if i is not the first element:
      result = result + separator;
    result = result + i;
  return result; 
```

`concat()`, ,的第二个参数`strict`是一个标志，用于知道是否必须在连接中考虑最终的空字符串。

我习惯于不考虑附加最后的分隔符；另一方面，如果 strict 为 false，则生成的字符串可能不含“A,B,,,F”之类的内容，前提是分隔符是逗号，但会显示为“A,B,F”。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-04-10T15:10:13.050

看过 3 次 Python 的答案，但没有 Ruby？！？！？

代码的第一部分声明了一个新数组。然后你可以调用 .join() 方法并传递分隔符，它会返回一个中间有分隔符的字符串。我相信 join 方法在连接之前会在每个项目上调用 .to_s 方法。

```
["ID", "Description", "Active"].join(",")
>> "ID, Description, Active" 
```

这在将元编程与数据库交互相结合时非常有用。

有谁知道 c# 是否有类似于这种语法糖的东西？

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-12-22T11:40:29.263

在 Java 8 中，我们可以使用：

```
List<String> list = Arrays.asList(new String[] { "a", "b", "c" });
System.out.println(String.join(",", list)); //Output: a,b,c 
```

要有前缀和后缀，我们可以做

```
StringJoiner joiner = new StringJoiner(",", "{", "}");
list.forEach(x -> joiner.add(x));
System.out.println(joiner.toString()); //Output: {a,b,c} 
```

在 Java 8 之前，您可以像 Jon 的回答那样做

```
StringBuilder sb = new StringBuilder(prefix);
boolean and = false;
for (E e : iterable) {        
    if (and) {
        sb.append(delimiter);
    }
    sb.append(e);
    and = true;
}
sb.append(suffix); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-24T11:39:59.297

```
string result = "";
foreach(string item in list)
{
    result += delimiter + item;
}
result = result.Substring(1); 
```

编辑：当然，您不会使用此算法或任何一种算法来连接字符串。使用 C#/.NET，您可能会使用 StringBuilder：

```
StringBuilder sb = new StringBuilder();
foreach(string item in list)
{
    sb.Append(delimiter);
    sb.Append(item);
}
string result = sb.ToString(1, sb.Length-1); 
```

以及此解决方案的变体：

```
StringBuilder sb = new StringBuilder(list[0]);
for (int i=1; i<list.Count; i++)
{
    sb.Append(delimiter);
    sb.Append(list[i]);
}
string result = sb.ToString(); 
```

两种解决方案都不包括任何错误检查。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-24T11:45:18.737

您可以编写自己的 AppendTostring(string, delimiter) 方法，当且仅当字符串不为空时才附加分隔符。然后，您只需在任何循环中调用该方法，而不必担心何时追加以及何时不追加。

编辑：如果可用，当然最好在方法中使用某种 StringBuffer 。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-02-24T11:49:55.480

在 .NET 中，如果可能，我会使用 String.join 方法，它允许您指定分隔符和字符串数组。可以使用 ToArray 将列表转换为数组，但我不知道这样做会对性能造成什么影响。

你提到的三种算法是我会使用的（我喜欢第二种，因为它没有 if 语句，但如果长度未知，我会使用第三种，因为它不会重复代码）。第二个仅在列表不为空时才有效，因此可能需要另一个 if 语句。

第四个变体可能是在每个连接的元素前面放置一个分隔符，然后从结果中删除第一个分隔符。

如果您确实在循环中连接字符串，请注意，对于非平凡的情况，使用 stringbuilder 将大大优于重复的字符串连接。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-24T14:48:20.933

来自[http://dogsblog.softwarehouse.co.zw/post/2009/02/11/IEnumerable-to-Comma-Separated-List-(and-more).aspx](http://dogsblog.softwarehouse.co.zw/post/2009/02/11/IEnumerable-to-Comma-Separated-List-(and-more).aspx)

开发时我最讨厌的一个是制作一个逗号分隔的 id 列表，它非常简单但总是有丑陋的代码.... 常见的解决方案是循环并在每个项目后放置一个逗号，然后删除最后一个字符，或者有一个 if 语句来检查你是在列表的开头还是结尾。以下是您可以在任何 IEnumberable 上使用的解决方案，即列表、数组等。这也是我能想到的最有效的方法，因为它依赖于比编辑字符串或使用 if 更好的赋值。

```
public static class StringExtensions
{
    public static string Splice<T>(IEnumerable<T> args, string delimiter)
    {
        StringBuilder sb = new StringBuilder();
        string d = "";
        foreach (T t in args)
        {
            sb.Append(d);
            sb.Append(t.ToString());
            d = delimiter;
        }
        return sb.ToString();
    }
} 
```

现在它可以与任何 IEnumerable 一起使用，例如。

StringExtensions.Splice(billingTransactions.Select(t => t.id), ",")

给我们 31,32,35

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-06-05T18:00:20.183

[对于java，this question](https://stackoverflow.com/questions/63150/whats-the-best-way-to-build-a-string-of-delimited-items-in-java)或this [question](https://stackoverflow.com/questions/523871/best-way-to-concatenate-list-of-string-objects)已经给出了非常完整的答案。

那就是在 Apache Commons 中使用 StringUtils.join

```
String result = StringUtils.join(list, ", "); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-06-11T18:11:10.540

在 Clojure 中，您可以只使用 clojure.contrib.str-utils/str-join：

```
(str-join ", " list) 
```

但对于实际算法：

```
(reduce (fn [res cur] (str res ", " cur)) list) 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2010-08-01T20:36:11.047

Groovy 还有一个 String Object.join(String) 方法。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-04-23T02:05:58.240

Java（来自乔恩的解决方案）：

```
 StringBuilder sb = new StringBuilder();
    String delimiter = "";
    for (String item : items) {
        sb.append(delimiter).append(item);
        delimeter = ", ";
    }
    return sb.toString(); 
```

# java - 枚举定义中的静态上下文

> ID：581450
> 
> 赞同：11
> 
> 时间：2009-02-24T11:37:37.053
> 
> 标签：java, enums, javac

Java`enum`工具提供的语法糖有时会有点混乱。考虑这个不编译的例子：

```
public enum TestEnum {

    FOO("foo") {
        public void foo() {
            helper();  // <- compiler error
        }
    };

    String name;
    TestEnum(String name) {
        this.name = name;
    }

    public abstract void foo();

    private void helper(){
        // do stuff (using this.name, so must not be static)
    }
} 
```

谁能解释为什么编译器说

> 不能从静态上下文中引用非静态方法“helper()”

这个上下文究竟是如何静态的？

您可以通过将调用更改为（这是一个令人困惑的点：如果我们真的像编译器建议的那样处于“静态上下文”中，“ ”如何工作？）或通过将可见性提高到默认级别来进行编译。你更喜欢哪个？另外，请随时提出更好的问题标题:-)**`this.`**`helper()``this``helper()`

**编辑**：我发现[了一些关于这个](http://74.125.77.132/search?q=cache:yTkD6C3gZTEJ:x86.sun.com/thread.jspa%3FmessageID%3D3780246)的讨论- 但没有真正的答案。我的同事认为这实际上`this.helper()`是一个编译器错误。实际上，对于较新的 Java 版本，它似乎*不起作用*（尽管`super.helper()`确实如此）：“找不到符号 helper()”。（尽管发生了一些奇怪的事情：在尝试了不同的 Java 版本之后，我无法`this.helper()`再次使用它们中的任何一个进行编译......）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-28T15:52:31.497

该错误消息具有误导性，只需将`helper`其设为受保护即可。

```
protected void helper(){
    // can be called from subclasses (such as FOO) since it is not private
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T12:13:15.130

Java Puzzlers 一书中介绍了类似的内容。IIRC，外部类上下文总是在超类之前查看。在这种情况下会找到助手。但是我们在静态上下文中构造值（实际上有一个`private static final`before `FOO`）。因此错误。

试试`super.helper();`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T14:24:59.587

如果我将你的枚举翻译成它的类结构，它看起来大概是这样的：

```
public abstract class TestEnum {

  public static final TestEnum FOO = new FOO("foo") {
    public void foo() {
        helper();  // <- compiler error
    }
 };

  String name;
  TestEnum(String name) {
      this.name = name;
  }

  public abstract void foo();

  private void helper(){
    // do stuff (using this.name, so must not be static)
  } 
```

}

FOO 实例是扩展 TestEnum 的任意类。这就是为什么我相信你不能访问 helper()，因为它是私有的。所以 this.helper() 可能不应该工作。我不确定为什么 super.helper() 也可以工作，但也许 enum 可以让您对父级进行私有访问。

至于静态上下文错误，我同意错误消息似乎没有意义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T03:56:11.157

您可以将每个枚举常量视为枚举类的子类的唯一实例。就像“常规”类一样，枚举“子类”不能访问枚举“超类”的私有成员。（我无法重新创建您提到的“this.”解决方法。）

一个合理的解决方案是**将方法访问从*私有*更改为*受保护***，以提供对枚举常量“子类”的访问。

更好的问题标题建议：“Java 私有枚举方法？” 或者只是“私有枚举方法”（让 Java 标记处理 Java 特性）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T12:04:31.513

有[一篇文章](http://www.angelikalanger.com/Articles/EffectiveJava/29.EnumPitfall/29.EnumPitfall.html)提到了这个问题，不幸的是它是德文的。也许您仍然可以提取一些有用的信息。

编辑：似乎与您的问题有些不同。我仍然不明白你的例子的行为，我也在这里看到。

# .net - StructureMap 非泛型配置

> ID：581454
> 
> 赞同：1
> 
> 时间：2009-02-24T11:39:45.973
> 
> 标签：.net, generics, structuremap

我正在努力在不使用通用流利界面​​的情况下设置 StructureMap，

我不能使用泛型方法，因为我在设计时不知道类型。

IE：

要选择默认构造函数，我能找到的唯一方法是使用'SelectConstructor<T>()'，但我只知道运行时的类型......

这是相关的：[http](http://groups.google.com/group/structuremap-users/browse_thread/threa) ://groups.google.com/group/structuremap-users/browse_thread/threa ...

如何在没有通用流畅接口的情况下设置 StructureMap？或者，至少，我如何在设计时不知道类型的情况下选择默认构造函数。

提前致谢，

雷姆科

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-13T01:25:25.913

雷姆科，

您能否发布一些代码，以便我们更好地了解您在运行时尝试执行的通用构造？

我只是[遇到问题](https://stackoverflow.com/questions/1116607/)，`SelectContructor<T>()`所以也许我可以提供一些见解或为您指明正确的方向。

njapp

# visual-studio - VS2008 - 添加资源总是导致源文件被添加到csproj

> ID：581461
> 
> 赞同：0
> 
> 时间：2009-02-24T11:42:09.150
> 
> 标签：visual-studio, visual-studio-2008, resx

当我在 Visual Studio 2008（C# 项目）中将图像添加到 .resx 资源文件时，VS 总是决定将文件本身添加到解决方案（在 Resources 文件夹中）并将其 Persistence 属性设置为“在编译时链接”。

我想要的行为是将源图像文件内容添加到 .resx 文件中，将 Persistence 属性设置为“嵌入 .resx”，并且不将图像添加到 .csproj 中。

有人知道有什么方法可以做到这一点吗？目前，它是每个资源的手动步骤，我很快将不得不这样做数百次。

亲切的问候

汤姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T13:07:48.087

您也许可以编写一个宏来执行此操作。API 很好地涵盖了项目系统。

# maven-2 - Maven：如何进行并行构建？

> ID：581465
> 
> 赞同：181
> 
> 时间：2009-02-24T11:45:04.073
> 
> 标签：maven-2, build-process, build-automation

当您在多核/多 CPU 机器上使用 maven 构建时，通常可以并行构建不同的子项目。有没有办法用maven做到这一点？有这个/什么的插件吗？

* * *

## 回答 #1

> 赞同：274
> 
> 时间：2010-07-23T11:58:28.400

Maven 3（从 beta 1 开始）现在支持并行构建作为实验性功能。

例如，

```
mvn -T 4 clean install # Builds with 4 threads
mvn -T 1C clean install # 1 thread per cpu core
mvn -T 1.5C clean install # 1.5 thread per cpu core 
```

完整的文档可以在 Maven wiki 上找到：[Parallel builds in Maven 3 - Apache Maven - Apache Software Foundation](https://cwiki.apache.org/confluence/display/MAVEN/Parallel+builds+in+Maven+3)。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2017-05-14T09:00:44.590

建议的解决方案很棒，但我想在这里添加一些关于**并行构建期间的测试稳定性**的答案。

因此，当使用[Maven 并行构建](https://cwiki.apache.org/confluence/display/MAVEN/Parallel+builds+in+Maven+3)时：

```
mvn -T 4 clean install # Builds with 4 threads
mvn -T 1C clean install # 1 thread per cpu core
mvn -T 1.5C clean install # 1.5 thread per cpu core 
```

可能会出现一些**测试问题**。注意测试中串行和并行测试执行之间不同的任何行为。大多数情况下，它发生在**不正确的测试隔离资源方面**。

例如，`test1`使用 key 操作 db 条目`12345`，它是硬编码的并且`test2`使用相同的条目！不会很好……</p>

这是一种首先应该考虑的情况，但有时它会被遗忘，一旦切换到并行 maven 构建，可能会导致不同的问题。

如果发生这种情况，并且您至少在某些情况下仍希望使用并行执行，您可以（当然，除了尝试修复测试并使其正确隔离）使用参数[禁用 Maven 测试运行：](http://maven.apache.org/plugins-archives/maven-surefire-plugin-2.12.4/examples/skipping-test.html)`-DskipTests`

```
mvn clean install -T 4 -DskipTests 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-24T11:59:41.777

一些 CI 构建应用程序（例如 hudson）可以同时构建多个 maven 项目（甚至在多台机器上）。

在 maven 'standalone' 中对此的支持也会很好，快速浏览一下 maven 问题跟踪器给了我：http: [//jira.codehaus.org/browse/MNG-3004](http://jira.codehaus.org/browse/MNG-3004)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-09-24T13:31:00.907

如果您来这个问题是为了整理您的构建服务器，并且您没有使用本机处理 maven 的服务器，那么您正在寻找的魔法标志是这样的：

```
-Dmaven.repo.local=someNoneGlobalDir 
```

对你的每一个构建都这样做，你可以让它们同时运行，而不是让所有使用 maven 的东西都排在队列中！

# javascript - 在 if 语句中使用未定义的变量

> ID：581470
> 
> 赞同：17
> 
> 时间：2009-02-24T11:46:49.000
> 
> 标签：javascript

此代码段导致 JavaScript 运行时错误：（`foo`未定义）

```
if (foo) {
    // ...
} 
```

我必须先定义`foo`，如下所示：

```
var foo = foo || null // or undefined, 0, etc. 
```

...只有这样我才能做到：

```
if (foo) {
    // ...
} 
```

这是为什么？

**更新：**

这对我来说有点愚蠢：'当然你不能访问一个没有分配的变量。

有趣的东西，你可以对未定义的变量执行 typeof() 。我会接受[miccet](https://stackoverflow.com/users/66841/miccet)的回答，因为我认为这是最优雅的解决方案。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-24T12:03:52.453

我感觉到您在问，因为您知道 javascript 在某些情况下（即没有运行时错误）似乎允许未定义的变量，而在其他情况下则不允许。

原因如下：只要您只使用一级间接， javascript在检查未定义变量时*总是会抛出错误，但在检查未定义**属性时**永远不会*抛出错误。

 *例子：

```
// throws runtime error
if(foo) {
    // ...
}

// does not throw runtime error
if(window.foo) {
    // ...
}

// does not throw runtime error
var obj = {};
if(obj.foo) {
    // ...
}

// throws runtime error
if(obj.foo.bar) { // going two levels deep, but foo is undefined
    // ...
} 
```

希望这能澄清一点。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-24T11:50:01.393

您必须定义它，以便能够检查它的值。在这种情况下，您正在检查天气，这是真的。这个变量显然根本没有设置任何东西，例如在 C# 中为 null ，在 VB 中为 Nothing 。

如果必须，调试问题或其他什么，您可以检查变量是否未定义，如下所示：

```
if (typeof(variable) == "undefined") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T11:50:04.840

那是因为您现在使用以下方式定义它：

```
var foo = foo || null 
```

你为什么不首先定义它？这对我来说似乎很简单（除非我遗漏了什么）。

在创建（或设置为）之前使用变量是不好的编程习惯，应该避免。我的建议是**不要**使用该技巧来确保将其设置为某个值，而是跟踪逻辑错误并修复它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T11:53:21.400

这对我来说似乎很奇怪。可以说我想调用一个函数：-

事物（）;

如果事情没有在任何地方定义，我肯定会认为它会失败。

为什么您希望使用一个名为 foo 的变量而不在代码中的任何地方定义它？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T12:09:23.920

我觉得这是一个奇怪的问题。要回答这个问题，我认为最好反过来问这个问题......

预期的结果是什么

```
if (foo) {
    // ...
} 
```

其中 foo 未定义为变量？

我认为唯一可能的答案是 if 总是会评估为 false 并且您永远不会执行该块。

向您提出一个更直接的问题，您为什么希望引用不存在且未分配值的变量的代码可以工作？在您上面定义的上下文中， foo 是什么？

底线是没有声明，后续声明没有任何意义。foo 不是一个可以单独评估的术语，因此您必须为解释器提供一个上下文以引用 foo 以便它可以评估它。

有些语言在首次分配变量时会自动为您创建变量（python 和 VB 具有这种危险特性），但即使是那些语言也无法在分配之前评估变量，因此解释器会抛出错误。

如果你有一个编译器，它也会告诉你这个......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-31T03:02:49.287

这不是一个奇怪的问题，因为我在同一条船上：p

我在谷歌搜索“javascript 使用未定义的变量”后到达这里。我很困惑，因为我在某处看到人们可以简单地在循环中使用未定义的变量。

也许我用不同的语言看到它

* * *

我已经找到了。第一个代码成功执行，而第二个代码运行时出错。

第一个代码：

```
test();
function test() { x = 4; }
console.log(x); //this produce 4 
```

第二个代码：

```
test();
function test() { x[0] = 1; }
console.log(x[0]); 
```

# html - IE 英镑 (£) 符号

> ID：581483
> 
> 赞同：1
> 
> 时间：2009-02-24T11:51:32.153
> 
> 标签：html, internet-explorer, character-encoding

我有一个 html 表单，它可以做各种奇怪的后端事情。这在 Firefox 中运行良好。在大多数情况下它在 IE 中运行良好

然而，（英镑）£ 符号会导致问题，并且似乎在提交时会受到影响。

表格是这样的

```
 <form action="*MyFormAction*"  accept-charset="UTF-8" method="post"> 
```

我想我以前见过这个问题，但不记得解决方案。

编辑，欧元符号€工作正常

编辑 2，事实上，如果我将 € 符号与 £ 符号放在一起，它也可以正常工作。如果我使用不在 iso8859-1 扩展部分中的字符，请查看问题，它可以正常工作。如果我使用来自 iso8859-1 的扩展字符，它们就会被淘汰。那么如何让 IE 使用接受字符集所说的字符集呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T14:12:14.000

> 接受字符集="UTF-8"

在 IE 中不做你认为它做的事情（或标准说它做的事情）。相反，如果不能使用通常的默认编码（与页面自己的编码相同）对字段进行编码，IE 会使用值 ('UTF-8') 作为替代的编码列表。

因此，如果您添加此属性并且您的页面尚未使用 UTF-8，您可能会以页面编码*或*UTF-8 的形式提交字符，并且您的表单提交阅读脚本无法知道！

出于这个原因，你不应该使用 accept-charset；相反，您应该始终确保包含表单的页面正确地提供为“Content-Type: text/html;charset=utf-8”（通过 HTTP 标头和/或 <meta>）。

> 事实上，如果我将 € 符号与 £ 符号放在一起，它也可以正常工作。

是的，这是因为“€”不能以页面的默认编码（大概是 ISO-8859-1）进行编码。因此 IE 求助于发送编码为 UTF-8 的字段，这正是您一直想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T14:25:25.000

我认为 bobince 的理想答案是“以 UTF-8 提供页面”，但是由于我不能这样做，所以我发布我的工作以求繁荣。

使用非 ISO-8859-1（我们的页面服务于）扩展字符添加隐藏字段 unmunge 强制提交为 UTF8

所以

```
<input type="hidden" name="unmunge" value="&#x20ac;"  /> 
```

修复编码（实体是欧元符号）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T11:55:15.483

英镑是如何提交的？如果它在价格的输入框中，请不要提交，只允许提交数字并在再次显示价格时添加 £。或者在后端脚本中添加货币符号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T11:58:20.220

我不确定这是否有帮助（在[http://fyneworks.blogspot.com/2008/06/british-pound-sign-encoding-revisited.html](http://fyneworks.blogspot.com/2008/06/british-pound-sign-encoding-revisited.html)阅读整篇文章）

摘抄：

> 问题 如果您查看 UTF-8/Latin-1 (AKA ISO-8859-1) 字符表，您会发现英镑符号的十进制代码是 163 - 而十六进制代码是 A3。
> 
> 英镑 = %A3
> 
> 但是，在 Javascript 中的（所有）编码/解码函数中并非如此......
> 
> ```
> encodeURI/encodeURIComponent
> Encodes a Uniform Resource Identifier (URI) component by 
> ```
> 
> 用一个、两个或三个表示字符的 UTF-8 编码的转义序列替换某些字符的每个实例
> 
> 这意味着，为了编码我们心爱的磅符号，Javascript 使用 2 个字符。这就是烦人的“Â”出现的地方......
> 
> 英镑 = %C2%A3

希望能帮助到你。

# svn - 通过 svn+ssh 更改 Subversion 提交的用户名

> ID：581485
> 
> 赞同：5
> 
> 时间：2009-02-24T11:52:18.453
> 
> 标签：svn, ssh

我在这里遇到了我们的 Subversion 配置问题：我在本地 Linux 系统上通过 svn+ssh 检查了一个项目。所以 svn info 报告了以下内容：

```
URL: svn+ssh://MYUSERNAME@server/svn/project/trunk/ 
```

现在我的同事无法更新签出的工作副本（它在实时服务器上），因为命令行参数 --username 不适用于 svn+ssh。

如何从存储库 URL 中临时更改或删除用户名？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T11:53:23.180

使用“svn switch --relocate”将存储库服务器 URL 更改为没有用户名的地址。

**编辑**：语法很简单；抱歉，我在最初的回答中没有解释。基本上，您只需 cd 进入工作副本，然后运行：

```
svn switch --relocate svn+ssh://MYUSERNAME@server/ svn+ssh://server/ 
```

那应该使用运行该命令的用户的用户名。我也相当确定您还可以在该 URL 中指定新用户名（尽管现在不在 unix 框前面，所以我无法对此进行测试）。

当您从命令行运行它时，该命令是否没有按照您的意图执行？

有关更多信息，请参阅[关于 svn switch 的红豆章节](http://svnbook.red-bean.com/en/1.0/ch04s05.html)。

# c# - 鼠标拖放

> ID：581491
> 
> 赞同：1
> 
> 时间：2009-02-24T11:53:52.180
> 
> 标签：c#, winforms, mouse

如何实现鼠标拖放过程示例 SetCursorPos(32, 32); mouse_event((uint)MouseEventFlags.RIGHTDOWN,0,0 ,0,0); mouse_event((uint)MouseEventFlags.RIGHTUP,0,0 ,0,0); SetCursorPos(38, 38); mouse_event((uint)MouseEventFlags.LEFTDOWN,0,0 ,0,0);
mouse_event((uint)MouseEventFlags.LEFTUP,0,0 ,0,0);

这是在屏幕左上角打开任何内容的代码如何在此特定代码或其他方式中实现拖放？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T12:01:02.413

这是微软的拖放概述

.NET 1.1 表格：

[http://msdn.microsoft.com/en-us/library/ms973845.aspx](http://msdn.microsoft.com/en-us/library/ms973845.aspx)

.NET 2.0 表格：

[http://msdn.microsoft.com/en-us/library/za0zx9y0(VS.80).aspx](http://msdn.microsoft.com/en-us/library/za0zx9y0(VS.80).aspx)

WPF：

[http://msdn.microsoft.com/en-us/library/ms742859.aspx](http://msdn.microsoft.com/en-us/library/ms742859.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T12:03:11.487

您将不得不查看表单的拖放事件，我认为您还需要在表单上启用 OnEnter，因为我已经完成了 Windows 表单编程。

认为它被称为 DragEnter，您可以在以下页面上阅读更多内容：

[http://vicky4147.wordpress.com/2007/02/04/a-simple-drag-drop-in-winforms/](http://vicky4147.wordpress.com/2007/02/04/a-simple-drag-drop-in-winforms/)

[c-锐角](http://www.c-sharpcorner.com/UploadFile/mgold/DoingDragandDropUsingCSharp11302005020610AM/DoingDragandDropUsingCSharp.aspx)

除此之外，我会调查[uzbones 的](https://stackoverflow.com/questions/581491/mouse-drag-drop/581511#581511)答案

# java - C# 中 TreeBidiMap 的等价物是什么？

> ID：581502
> 
> 赞同：0
> 
> 时间：2009-02-24T11:58:31.030
> 
> 标签：java, c#, dictionary

什么相当于`[TreeBidiMap][1]`C# 中的[Commons Collections](http://commons.apache.org/collections/) in Java？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T12:04:50.937

`BidiMap`是一个定义映射的接口，它允许从键映射到值以及从值映射到键（因此是“双向”）。`TreeBidiMap`是这个接口的实现，它使用了红黑树。

.NET BCL 本身中不存在这些类，但我认为这些类可以由更简单的原语组成。具体来说，[C5 Generic Collection Library](http://www.itu.dk/research/c5/)提供了一个红黑树的实现，双向映射可以在标准之上实现`Dictionary<TKey, TValue>`。

# sql - 主键总是聚集的吗？

> ID：581505
> 
> 赞同：20
> 
> 时间：2009-02-24T11:59:37.190
> 
> 标签：sql, sql-server, indexing, primary-key

请清除我对此的疑问，在 SQL Server（2000 及更高版本）中，主键是自动聚集索引还是我们可以选择在主键上使用非聚集索引？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-24T12:01:50.693

不，它可以是非集群的。但是，如果您没有明确将其定义为非聚簇并且表上没有聚簇索引，它将被创建为聚簇。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-24T18:16:13.663

人们还可能会补充说，允许对主键进行群集通常是不好的。特别是，当主键由 IDENTITY 分配时，它没有内在意义，因此任何保持表相应排列的努力都是浪费的。

考虑具有 ProductID INT IDENTITY PRIMARY KEY 的表 Product。如果这是集群的，那么以某种方式相关的产品很可能遍布整个磁盘。最好根据我们可能查询的内容（例如 ManufacturerID 或 CategoryID）进行聚类。在任何一种情况下，聚集索引都会（其他条件相同）使相应的查询更加高效。

另一方面，指向它的子表中的外键可能是集群的一个很好的候选者（我反对的是实际上具有 IDENTITY 属性的列，而不是它的亲戚）。因此，在我上面的示例中，ManufacturerID 很可能是 Manufacturer 表的外键，在该表中它被设置为 IDENTITY。*该*列不应该被聚类，但 Product 中引用它的列可能会这样做有很好的优势。

# c# - 9i 的 ODP.NET OracleCommandBuilder.DeriveParameters

> ID：581509
> 
> 赞同：0
> 
> 时间：2009-02-24T12:00:48.170
> 
> 标签：c#, oracle, ado.net, odp.net

我安装了 Oracle9i 第 2 版 ODAC，我们正在从 Microsoft .NET Data Provider for Oracle 迁移。我们实现了一些 SqlCommand 缓存，它使用 System.Data.SqlCommandBuilder.DeriveParameters(result)（var 结果是 SqlCommand 的类型），但在 ODP.NET 版本 10 之前没有 DeriveParameters() 方法。

也许任何人都有在 Oracle 9i 中使用 ODP.NET 10.1.XXXXXX 或更高版本的经验并且没有问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T13:15:53.357

您可以在 9i 上使用 ODP.NET R2 for 10g 而不会出现问题，如 odp.net R2 的自述文件中所述。我会选择 R2 版本（所以 2.10.2.xxx），因为它有一个原生的 .NET 2.0 版本和 10.1 版本中不存在的许多错误修复。它也比 9.2.0.xxx 版本少错误。

它将安装 10g 客户端，该客户端可以访问 8i R3 或更高版本的 Oracle 数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:24:56.260

您甚至可以将 odp.net 11.1.0.6.20 与 Oracle 9i 一起使用。但是使用 Oracle 服务器 9.2.0.7，而不是 9.2.0.6 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T00:36:31.907

看看 Metalink 的以下文档，它可能会有所帮助。它包含 ODP 驱动程序版本、支持的操作系统、SQL*Net、RDBMS、.NET Framework 和 Visual Studio 的支持矩阵。

主题：Oracle Data Provider for .NET (ODP) 支持的配置

文件编号：726240.1

# apache - 我怎样才能将除了我的 IP 地址之外的所有地址都重写到 std. Apache 503 暂时停机错误信息？

> ID：581516
> 
> 赞同：4
> 
> 时间：2009-02-24T12:02:44.013
> 
> 标签：apache

我即将进行一些服务器维护，并希望将请求重写为 Apache 的标准 503 暂时不可用消息。

我用谷歌搜索并找到了一些 mod_rewrite 片段，但它们都涉及对 PHP 脚本执行 [R=503]，然后发送它自己的 503 标头和手写消息……这对我来说似乎很难看，当Apache 的默认设置供我使用。

那么，如何将所有请求重写为 Apache 的标准 503 错误消息？

谢谢你的帮助

（这里的长期编码恐怖 RSS 订阅者......只是有点匆忙！）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T12:22:48.133

我不知道从什么时候 mod_rewrite 允许其他状态代码而不是 3xx 作为`R`标志。但这应该这样做：

```
RewriteEngine on
RewriteRule ^ - [L,R=503] 
```

如果您设置了自定义错误文档，请使用它来防止其他内部错误：

```
RewriteEngine on
RewriteRule !^path/to/my-custom-error-document$ - [L,R=503] 
```

* * *

**编辑**`REDIRECT_STATUS`使用环境变量   找到了更好的解决方案：

```
RewriteEngine on
RewriteCond %{ENV:REDIRECT_STATUS} !=503
RewriteRule ^ - [L,R=503] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T12:33:26.437

再补充一点，我经常有以下几点：

```
RewriteEngine on
RewriteCond -f path/to/my-custom-error-document
RewriteRule !^path/to/my-custom-error-document$ - [L,R=503] 
```

这样做是检查错误文档是否存在。如果是这样，它会提供错误页面。这允许我做的是抛出自定义错误而无需重新启动 apache。要将其放回原处，我只需删除（或重命名）错误页面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T19:37:23.983

谢谢你们 - 工作得很好。

这是我在维护期间使用的确切 .htaccess 配置（没有我的 IP 地址）：

```
RewriteEngine on
RewriteCond %{REMOTE_HOST} !^123\.456\.789\.012$
RewriteCond %{ENV:REDIRECT_STATUS} !=503
RewriteRule ^ - [L,R=503] 
```

# sql-server - 在 SQL 2005 中更改聚集索引列的排序规则

> ID：581517
> 
> 赞同：3
> 
> 时间：2009-02-24T12:02:51.487
> 
> 标签：sql-server, sql-server-2005, collation

我有一个使用不正确的排序规则创建的数据库。我更改了数据库的排序规则，但这也使各个列的排序规则不正确。这给我带来了一个问题。

因此，我编写了一个脚本来循环并更改各个列的排序规则，这基本上是可行的，除了一些列是它们各自表上的聚集索引的一部分。这些我无法改变。

例如，如果我运行：

```
ALTER TABLE MyTable 
ALTER COLUMN MyColumn varchar(50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL 
```

我得到以下回复：

```
Msg 5074, Level 16, State 1, Line 1
The object 'DF_MyTable_MyColumn' is dependent on column 'MyColumn'.
Msg 5074, Level 16, State 1, Line 1
The object 'PK_MyTable_MyColumn_MyOtherColumn' is dependent on column 'MyColumn'.
Msg 4922, Level 16, State 9, Line 1
ALTER TABLE ALTER COLUMN deleted failed because one or more objects access this column. 
```

有没有办法解决这个问题来改变这些列的排序规则？显然，我不能删除索引，因为它构成了主键。我想我可以暂时删除 PK，但我宁愿不这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T12:22:51.190

您必须删除所有依赖项。

当您更改数据库排序规则时，您只更改系统表。所有其他文本类型的列都需要手动更改。

通常，[MS KB 325335](http://support.microsoft.com/default.aspx?scid=kb;en-us;325335)有关于如何为整个数据库和所有列执行此操作的选项

# mysql - MySQL 中的 SELECT DISTINCT 或 GROUP BY 哪个更快？

> ID：581521
> 
> 赞同：304
> 
> 时间：2009-02-24T12:04:19.143
> 
> 标签：mysql, sql, database, group-by, distinct

如果我有一张桌子

```
CREATE TABLE users (
  id int(10) unsigned NOT NULL auto_increment,
  name varchar(255) NOT NULL,
  profession varchar(255) NOT NULL,
  employer varchar(255) NOT NULL,
  PRIMARY KEY  (id)
) 
```

我想获得`profession`字段的所有唯一值，什么会更快（或推荐）：

```
SELECT DISTINCT u.profession FROM users u 
```

或者

```
SELECT u.profession FROM users u GROUP BY u.profession 
```

?

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2009-02-24T12:09:22.143

它们本质上是等价的（实际上这就是一些数据库在后台实现`DISTINCT`的方式）。

如果其中一个更快，它将是`DISTINCT`. 这是因为，尽管两者是相同的，但查询优化器必须抓住这样一个事实，即您`GROUP BY`没有利用任何组成员，而只是利用他们的键。`DISTINCT`明确这一点，因此您可以使用稍微笨拙的优化器。

如有疑问，请测试！

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2009-02-27T14:50:08.283

如果您对 有索引`profession`，则这两个是同义词。

如果你不这样做，那么使用`DISTINCT`.

`GROUP BY`在`MySQL`排序结果中。你甚至可以这样做：

```
SELECT u.profession FROM users u GROUP BY u.profession DESC 
```

并按顺序排列您的职业`DESC`。

`DISTINCT`创建一个临时表并将其用于存储重复项。`GROUP BY`做同样的事情，但之后对不同的结果进行排序。

所以

```
SELECT DISTINCT u.profession FROM users u 
```

如果您没有索引，则速度会更快`profession`。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-05-16T10:49:53.613

对于单列上的 DISTINCT 与单列上的 GROUP BY 的情况，上述所有答案都是正确的。每个数据库引擎都有自己的实现和优化，如果您关心非常小的差异（在大多数情况下），那么您必须针对特定服务器和特定版本进行测试！由于实施可能会改变......

但是，如果您在查询中选择多个列，则 DISTINCT 本质上是不同的！因为在这种情况下，它将比较所有行的所有列，而不仅仅是一列。

所以如果你有类似的东西：

```
// This will NOT return unique by [id], but unique by (id,name)
SELECT DISTINCT id, name FROM some_query_with_joins

// This will select unique by [id].
SELECT id, name FROM some_query_with_joins GROUP BY id 
```

认为 DISTINCT 关键字通过您指定的第一列来区分行是一个常见的错误，但 DISTINCT 是这种方式的通用关键字。

因此，您必须小心不要将上述答案视为对所有情况都是正确的……您可能会感到困惑并得到错误的结果，而您想要的只是优化！

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-02-24T13:37:28.670

如果可以，请选择最简单和最短的 - DISTINCT 似乎更符合您的要求，只是因为它会为您提供您需要的答案，而且仅此而已！

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-11-18T13:56:26.670

在 postgres 中的某些情况下，well distinct 可能比 group by 慢（不知道其他数据库）。

测试示例：

```
postgres=# select count(*) from (select distinct i from g) a;

count 

10001
(1 row)

Time: 1563,109 ms

postgres=# select count(*) from (select i from g group by i) a;

count
10001
(1 row)

Time: 594,481 ms 
```

[http://www.pgsql.cz/index.php/PostgreSQL_SQL_Tricks_I](http://www.pgsql.cz/index.php/PostgreSQL_SQL_Tricks_I)

所以要小心...... :)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-06-21T01:09:18.553

Group by 比 Distinct 昂贵，因为 Group by 对结果进行排序，而 distinct 避免了它。但是，如果你想让 group by 产生与 distinct 相同的结果给***order by null*** ..

```
SELECT DISTINCT u.profession FROM users u 
```

**等于**

```
SELECT u.profession FROM users u GROUP BY u.profession order by null 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-24T12:20:18.247

查询似乎并不完全相同。至少对于 MySQL。

比较：

1.  描述从 northwind.products 中选择不同的产品名称
2.  按产品名称描述从 northwind.products 组中选择产品名称

第二个查询在 Extra 中另外给出了“使用文件排序”。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-02-11T18:27:20.043

在*MySQL*中，" `Group By`" 使用了一个额外的步骤：`filesort`. 我意识到`DISTINCT`比 快`GROUP BY`，这是一个惊喜。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-06-09T09:12:37.410

经过大量测试，我们得出的结论是 GROUP BY 更快

SELECT sql_no_cache opnamegroep_intern FROM `telwerken` WHERE `opnemergroep`IN (7,8,9,10,11,12,13)​​ group by opnamegroep_intern

总共 635 条 0.0944 秒 Weergave van 记录 0 - 29 条（总共 635 条，查询 duurde 0.0484 秒）

SELECT sql_no_cache distinct (opnamegroep_intern) FROM `telwerken` WHERE `opnemergroep`IN (7,8,9,10,11,12,13)

635 总 0.2117 秒（几乎 100% 慢） Weergave van 记录 0 - 29 （635 总，查询 duurde 0.3468 秒）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-05-21T17:15:41.027

（更多功能说明）

在某些情况下，您必须使用 GROUP BY，例如，如果您想获取每个雇主的雇员人数：

```
SELECT u.employer, COUNT(u.id) AS "total employees" FROM users u GROUP BY u.employer 
```

在这种情况下`DISTINCT u.employer`无法正常工作。也许有办法，但我就是不知道。（如果有人知道如何使用 DISTINCT 进行此类查询，请添加注释！）

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-06-03T09:56:42.863

这是一个简单的方法，它将为每个查询打印 2 个不同的经过时间。

```
DECLARE @t1 DATETIME;
DECLARE @t2 DATETIME;

SET @t1 = GETDATE();
SELECT DISTINCT u.profession FROM users u; --Query with DISTINCT
SET @t2 = GETDATE();
PRINT 'Elapsed time (ms): ' + CAST(DATEDIFF(millisecond, @t1, @t2) AS varchar);

SET @t1 = GETDATE();
SELECT u.profession FROM users u GROUP BY u.profession; --Query with GROUP BY
SET @t2 = GETDATE();
PRINT 'Elapsed time (ms): ' + CAST(DATEDIFF(millisecond, @t1, @t2) AS varchar); 
```

或尝试[SET STATISTICS TIME (Transact-SQL)](https://msdn.microsoft.com/en-us/library/ms190287.aspx)

```
SET STATISTICS TIME ON;
SELECT DISTINCT u.profession FROM users u; --Query with DISTINCT
SELECT u.profession FROM users u GROUP BY u.profession; --Query with GROUP BY
SET STATISTICS TIME OFF; 
```

它只是显示解析、编译和执行每条语句所需的毫秒数，如下所示：

```
 SQL Server Execution Times:
   CPU time = 0 ms,  elapsed time = 2 ms. 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-07-16T23:24:28.337

这不是规则

对于每个查询 .... 分别尝试 distinct 然后分组 ... 比较完成每个查询的时间并使用更快的 ....

在我的项目中，有时我使用 group by 和其他不同的

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-24T12:09:28.150

如果您不必执行任何组函数（求和、平均值等，以防您想将数字数据添加到表中），请使用 SELECT DISTINCT。我怀疑它更快，但我没有什么可证明的。

无论如何，如果您担心速度，请在列上创建索引。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-27T14:55:01.720

SELECT DISTINCT 将始终与 GROUP BY 相同或更快。在某些系统（即 Oracle）上，它可能被优化为与大多数查询的 DISTINCT 相同。在其他（如 SQL Server）上，它可能会快得多。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-06-09T19:37:04.070

**如果**问题允许，请尝试使用 EXISTS，因为它已优化为在找到结果后立即结束（并且不缓冲任何响应），因此，如果您只是尝试为这样的 WHERE 子句规范化数据

```
SELECT FROM SOMETHING S WHERE S.ID IN ( SELECT DISTINCT DCR.SOMETHING_ID FROM DIFF_CARDINALITY_RELATIONSHIP DCR ) -- to keep same cardinality 
```

更快的响应是：

```
SELECT FROM SOMETHING S WHERE EXISTS ( SELECT 1 FROM DIFF_CARDINALITY_RELATIONSHIP DCR WHERE DCR.SOMETHING_ID = S.ID ) 
```

这并不总是可能的，但如果可用，您会看到更快的响应。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-10-09T23:06:04.880

在 mySQL 中，我发现 GROUP BY 会将 NULL 视为不同的，而 DISTINCT 不会。
采用完全相同的 DISTINCT 查询，删除 DISTINCT，并将所选字段添加为 GROUP BY，由于其中一个字段为 NULL，我得到了更多行。

所以.. 我倾向于相信 mySQL 中的 DISTINCT 更多。

# c# - C# Winforms：多个顶级窗口和 ShowDialog()

> ID：581528
> 
> 赞同：2
> 
> 时间：2009-02-24T12:08:54.920
> 
> 标签：c#, winforms, modal-dialog

我有一个使用显示多个顶级窗口的 Winforms 应用程序：

```
Form1 form1 = new Form1();
form1.Show();
Form2 form2 = new Form2();
form2.Show();
Application.Run(); 
```

在 Form1 中的一个事件处理程序中，我希望能够显示一个模式对话框：

```
Dialog dialog = new Dialog();
dialog.ShowDialog(form1); 
```

不暂停其他顶级窗口。

这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T12:11:10.313

我相信，您需要在其自己的 STA 线程上运行每个顶级窗口来实现这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-17T12:49:33.677

有一个简单的解决方案似乎可以正常工作。您可以简单地检查我们是否被禁用并在需要时重新启用。

```
 [DllImport("user32.dll")]
    private static extern void EnableWindow(IntPtr handle, bool enable);

    protected override void WndProc(ref System.Windows.Forms.Message msg)
    {
        if (msg.Msg == 0x000a /* WM_ENABLE */ && msg.WParam == IntPtr.Zero)
        {
            EnableWindow(this.Handle, true);
            return;
        }

        base.WndProc(ref msg);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T12:42:41.580

如果您需要另一种方法来运行多个 UI 线程，您可以处理[WM_ENABLE](http://msdn.microsoft.com/en-us/library/ms632621(VS.85).aspx)消息并使用[EnableWindow](http://msdn.microsoft.com/en-us/library/ms646291.aspx)方法来防止窗体被禁用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T12:44:27.050

一旦显示模态对话框，它将使同一 STA 线程上的所有其他窗口不可用。这背后的原因是模式对话框将开始拦截该特定线程的所有消息。在模式对话框关闭之前，其他顶级窗口将无法响应。

# language-agnostic - 在我们的网站上限制投票的最佳方式是什么？

> ID：581538
> 
> 赞同：0
> 
> 时间：2009-02-24T12:11:14.243
> 
> 标签：language-agnostic

我们的网站上有用户可以投票的文章。限制投票的推荐方法是什么？

有很多网站实施了投票，我知道一些可能的解决方案，但我想这是一些基于会话、IP、时间限制等的基本**防弹推荐方法。**

从浏览器发送投票的最佳方式是什么？基本的 GET/POST 或 AJAX 请求？是否有必要使用一些预先生成的请求 ID？

**更新：**我们不能使用用户注册。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T13:03:55.910

> [...]**防弹**[...]

[不可能的。](http://www.google.com/search?q=voting+machine+fraud)

通过帐户进行限制将有所帮助 - IP 地址远非动态且易于更改以实现远程“安全”。然后，您当然必须限制帐户创建，再一次，困难..

Stackoverflow 做得很好（最近有一篇关于此的博客条目，[“新问题/回答率限制”](https://blog.stackoverflow.com/2009/02/new-question-answer-rate-limits/)） - 基本上有帐户，您必须积极参与一段时间才能投票。然后，在您参与的时间更长之前，您将受到速率限制（按帐户）。然后取消限制，因此您不会惹恼更多活跃（更受信任）的用户。

如果您只是想防止因果、“意外”投票、cookie 限制，也可能是 IP 限制（请记住，一个 IP 后面可以有多个用户）.. 如果您想尝试防止滥用，请要求帐户您不能只单击“注册”（或者更确切地说，您不能为其编写“单击注册 2000 次”的脚本），尽管这并不总是可能的（或实际的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-18T15:46:53.927

The best approach should be by user_id, one user can only vote one time on each challenge, each challenge should have an unique ID.

*   Allow new users to register.
*   Check if user is authenticated.
*   Check if user already voted in challenge ID, before creating a new vote.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T12:17:17.740

防止重复帖子的最佳方法是仅登录用户投票。这样您就可以将他们的投票存储在一些数据存储 (DB) 中。

如果您想允许用户匿名投票，请使用浏览器会话。这样做的缺点是他们可以关闭/重新打开浏览器并重新投票。

我不建议使用 IP 来限制投票，因为许多用户可以在代理后面，所以看起来他们拥有相同的 IP。如果其中一个用户投票，其他用户就不能再投票了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T12:19:12.603

这可能有助于您的 bulletprof 推荐请求：[内容投票数据库和应用程序设计](https://stackoverflow.com/questions/572723/stopping-users-voting-multiple-times-on-a-website)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T12:19:18.467

除非您需要一些严肃的（银行级别）身份验证，否则没有防弹解决方案。也就是说，基本的解决方案是使用会话（cookies）。IP 限制是一个非常糟糕的主意（例如，我与大约 20 个人共享一个 IP）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T12:35:54.357

*   使用经过身份验证的用户
*   不要阻止IP
*   不要通过 cookie 验证投票
*   如果同一 IP 使用不同帐户多次投票，请尝试使用验证码

如果您想允许未经身份验证的用户，那么您肯定必须使用验证码来避免机器人。但我仍然认为最好的办法是只允许对经过身份验证的用户投票。您可以制作类似，小于 1h/2h 的用户无法投票，以避免机器人创建帐户和提供投票。

# c# - 使用 C# 解析 SQL 中的嵌套块

> ID：581544
> 
> 赞同：2
> 
> 时间：2009-02-24T12:15:06.107
> 
> 标签：c#, sql, parsing

我想对 SQL 代码进行分析。在此我想将 SQL 代码中的块分开。例如，在下面的代码中

```
for condition1 loop
stmt1;
for condition2 loop
stmt2;
end loop;
end loop; 
```

我想将这两个块分开并创建一个数据结构，该结构将包含外循环块并且还将具有内循环块。

最好的方法是什么？是否有任何可用的解析器可以以最佳方式处理嵌套循环？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T15:01:08.477

我会建议这种块的合成模式（也适用于 SELECT、CASE、WITH 和类似的）。

```
public interface ICodeEntity { }
public interface IObjectEntity { }
public class Column: IObjectEntity
{
    public string name;
    public System.Data.DbType type;
}
public class Table: IObjectEntity
{
    public List<Column> columns = new List<Column>();
    public string alias;
}
public class Where : ICodeEntity { }
public class GroupBy : ICodeEntity { }
public class OrderBy : ICodeEntity { }
public class Select : Table, ICodeEntity
{
    public List<Table> joinList = new List<Table>();
    public Where where;
    public GroupBy groupBy;
    public OrderBy orderBy;
}
public class Condition : ICodeEntity { }
public class If : ICodeEntity
{
    public Condition condition;
    public List<ICodeEntity> codeList = new List<ICodeEntity>();
} 
```

在程序的某个地方：

```
If if1 = new If();
if1.codeList.Add(new If()); 
```

请参阅相关链接：
[CodeProject：C#](http://www.codeproject.com/KB/architecture/csdespat_2.aspx#Composite)
[数据和对象工厂中的说明性 GOF 设计模式：复合模式](http://www.dofactory.com/Patterns/PatternComposite.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-04T13:13:49.157

应该已经有可用的 SQL Parser 可以自动为您执行此操作，您无需重新发明轮子。只需谷歌“sql解析器”。

# svn - 如何在 Unix 中进行批量 svn mv

> ID：581546
> 
> 赞同：3
> 
> 时间：2009-02-24T12:15:58.850
> 
> 标签：svn

我想在 svn 中将大量文件从一个目录批量移动到另一个目录。不幸的是 svn 一次只支持移动一个文件。

基本上我想将某种类型的文件（*.xml）移动到一个完全不同的目录，例如 mv foo/bar/* .xml forbar/xml

我尝试使用 find 并使用 -exec 但我需要为第二个参数剥离目录。有任何想法吗？

编辑：使用 bash

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T12:19:48.733

假设您正在使用 bash：

```
for x in `find -name *.xml`; do
   echo svn move $x forbar/`basename $x`;
done 
```

一旦您对输出正确感到满意，请从第二行中删除“回声”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T12:31:52.027

您可以使用该`-execdir`选项进行操作。这*从*源文件所在的目录运行（这避免了目录链接等的竞争条件）。

```
find -name '*.xml' -execdir svn move {} `pwd`/foobar/{} \; 
```

# c++ - C++ Builder 运行时错误 - 无法聚焦已禁用或不可见的窗口

> ID：581548
> 
> 赞同：0
> 
> 时间：2009-02-24T12:17:01.390
> 
> 标签：c++, c++builder

在主窗体上，我有 TPageControl，在它的所有选项卡上，我都有相应的保存按钮，这些按钮在 Alt+S 组合中被激活。

当然，根据当前打开的选项卡，应该调用相应的保存按钮的处理程序；但是如果我尝试使用 Alt+S 保存，则会出现“无法聚焦已禁用或不可见的窗口”运行时错误。

而且我注意到，在当前选项卡之前处于活动状态的选项卡中的保存按钮的处理程序被调用，但不知道为什么。

我尝试将保存按钮放在面板中（对于一些类似的问题效果很好），但仍然发生同样的事情。

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T15:50:18.977

您可以一键完成所有操作。在`OnClick`处理程序中，检查哪个页面是当前页面，并调用该页面的保存函数。

# c# - 枚举作为标志的使用、设置和移位

> ID：581555
> 
> 赞同：3
> 
> 时间：2009-02-24T12:19:19.700
> 
> 标签：c#, .net, enums, flags

我有两个标志：

```
[Flags]
enum Flags
{
  A = 1,
  B = 2
}; 
```

我这样设置它们：

```
Mode = Flags.A | Flags.B; // default value
for(int i = 0; i < args.Length; i++) {
switch(args[i])
{
  case "--a":
  {
    if ((Mode & Flags.A) == Flags.A && (Mode & Flags.B) == Flags.B) 
     // both, default assume
    {
      Mode = Flags.A; // only A
    }
    else
    {
      Mode |= Flags.A; // append A
    }
    break;
  }
  case "--b":
  {
    if ((Mode & Flags.A) == Flags.A && (Mode & Flags.B) == Mode.B)
    {
      Mode = Flags.B;
    }
    else
    {
      Mode |= Flags.B;
    }
    break;
  }
} } 
```

然后像这样使用它们：

```
if((Mode & Flags.A) == Flags.A)
{
 //
}
if((Mode & Flags.B) == Flags.B)
{
 //
} 
```

主要保留：可以设置两个标志。或者只是一个，在这种情况下，只执行一部分代码。

我的代码好吗？设置标志的最佳方法是什么？

**Upd** : 是不是先不那么丑了，你怎么看？

```
Mode = 0; // default value now is empty
for(int i = 0; i < args.Length; i++) {
switch(args[i])
{
  case "--a":
  {
    Mode |= Flags.A;
    break;
  }
  case "--b":
  {
    Mode |= Flags.B;
    break;
  }
} }
if(Mode == 0)
{
  Mode = Flags.A | Flags.B; // if no parameters are given, setup both flags
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T12:26:44.580

这是我设置标志的方式：

```
Mode = 0;
for(int i = 0; i < args.Length; i++) {
    switch(args[i]) {
    case "--a":
        Mode |= Flags.A;
        break;
    case "--b":
        Mode |= Flags.B;
        break;
    }
} 
```

`--not-a`如果默认情况下这两个标志都应该打开，我认为将命令行参数更改为类似and更有意义`--not-b`。这既反映了默认设置，又让你摆脱了`(Mode & Flags.A) == Flags.A && (Mode & Flags.B) == Flags.B`IMHO，这是相当难看的。

然后你可以像这样设置你的标志：

```
Mode = Flags.A | Flags.B;
for(int i = 0; i < args.Length; i++) {
    switch(args[i]) {
    case "--not-a":
        Mode &= ~Flags.A;
        break;
    case "--not-b":
        Mode &= ~Flags.B;
        break;
    }
} 
```

最后，如果您有很多标志（而不仅仅是两个），那么像这样设置您的枚举可能会更容易：

```
[Flags]
enum Flags
{
    A = 1,
    B = 1 << 1,
    C = 1 << 2,
    D = 1 << 3,
    E = 1 << 4,
    F = 1 << 5
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T12:29:14.450

您可以使用以下精彩语句关闭“位”：

```
Mode &= ~Flags.A; 
```

我建议在你的枚举中包含一个“null”值：

```
[Flags]
enum Flags
{
  Null = 0;
  A = 1,
  B = 2;
} 
```

它会让你的生活更简单！:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T14:00:48.583

第二个版本要好得多——这正是我会做的。改为虽然`Mode == null`。`Mode == 0`

```
Mode = 0; // default value now is empty
for(int i = 0; i < args.Length; i++) {
    switch(args[i])
    {
        case "--a":
            Mode |= Flags.A;
            break;

        case "--b":
            Mode |= Flags.B;
            break;
    }
}

if(Mode == 0)
{
    Mode = Flags.A | Flags.B; // if no parameters are given, setup both flags
} 
```

# iphone - 使用 UINavigation “返回”到视图时是否触发任何功能

> ID：581560
> 
> 赞同：2
> 
> 时间：2009-02-24T12:22:17.620
> 
> 标签：iphone, objective-c

我知道这可能是一件非常简单的事情，但是如果从子视图进行了一些更改然后返回到主视图，我需要重新加载一些数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T12:24:01.360

看看实施

```
- (void)viewDidAppear:(BOOL)animated 
```

或者

```
- (void)viewWillAppear:(BOOL)animated 
```

[但请注意，UINavigationControllers Link>>](http://davidebenini.it/2009/01/03/viewwillappear-not-being-called-inside-a-uinavigationcontroller/)可能存在需要注意的问题

# c# - Windows窗体的多个滑块轨迹栏

> ID：581568
> 
> 赞同：7
> 
> 时间：2009-02-24T12:26:31.460
> 
> 标签：c#, winforms

有没有人知道如何在 WinForms 中创建具有多个滑块的轨迹栏？我想标记一个范围。另外，是否可以将滑块垂直偏移一点？我的目标是在轨迹栏上方有两个滑块，在其下方有两个。

```
 v-----------------v
________________________________________
                                ^------^ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T13:46:28.510

您可以通过编写自己的`UserControl`处理鼠标事件的位置并自己绘制来做到这一点。您将需要几个命中测试区域；每个拇指一个。

要绘制轨迹栏，您需要结合命名空间[`ControlPaint`](http://msdn.microsoft.com/en-us/library/system.windows.forms.controlpaint.aspx)提供的主题 API [`System.Windows.Forms.VisualStyles`](http://msdn.microsoft.com/en-us/library/system.windows.forms.visualstyles.aspx)。最值得注意的是 [`VisualStyleElement.TrackBar.ThumbTop`](http://msdn.microsoft.com/en-us/library/system.windows.forms.visualstyles.visualstyleelement.trackbar.thumbtop.aspx)，[`VisualStyleElement.TrackBar.ThumbBottom`](http://msdn.microsoft.com/en-us/library/system.windows.forms.visualstyles.visualstyleelement.trackbar.thumbbottom.aspx)、 和[`VisualStyleElement.TrackBar.Track`](http://msdn.microsoft.com/en-us/library/system.windows.forms.visualstyles.visualstyleelement.trackbar.track.aspx)分别用于绘制拇指和轨道。

`ControlPaint`当主题不可用时（例如在 Win2k 上或主题被禁用时），您可以使用调用为轨道和拇指绘制框架和按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T12:45:17.283

您可以自己绘制`ControlPaint`，以确保渲染与您的 UI 的其余部分保持一致。

# c# - 如何使用 .NET 创建具有特定扩展名的临时文件？

> ID：581570
> 
> 赞同：303
> 
> 时间：2009-02-24T12:26:55.767
> 
> 标签：c#, .net, file, temporary-files

我需要生成一个带有 .csv 扩展名的唯一临时文件。

我现在做的是

```
string filepath = System.IO.Path.GetTempFileName().Replace(".tmp", ".csv"); 
```

但是，这并不能保证我的 .csv 文件是唯一的。

我知道我遇到冲突的机会非常低（特别是如果您认为我不删除 .tmp 文件），但这段代码对我来说并不好。

当然，我可以手动生成随机文件名，直到最终找到一个唯一的文件名（这应该不是问题），但我很想知道其他人是否找到了解决这个问题的好方法。

* * *

## 回答 #1

> 赞同：394
> 
> 时间：2009-02-24T12:29:14.637

保证是（统计上）唯一的：

```
string fileName = System.IO.Path.GetTempPath() + Guid.NewGuid().ToString() + ".csv"; 
```

（引用关于碰撞概率的维基文章：

> ...一个人每年被陨石击中的风险估计为 170 亿分之一 [19]，这意味着概率约为 0.00000000006 (6 × 10−11)，相当于产生几十个一年内有数万亿个 UUID，并且有一个重复。换句话说，仅在接下来的 100 年每秒生成 10 亿个 UUID 之后，仅创建一个副本的概率约为 50%。如果地球上每个人都拥有 6 亿个 UUID，那么重复的概率约为 50%

编辑：另请参阅 JaredPar 的评论。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-02-24T12:38:13.040

试试这个功能...

```
public static string GetTempFilePathWithExtension(string extension) {
  var path = Path.GetTempPath();
  var fileName = Guid.NewGuid().ToString() + extension;
  return Path.Combine(path, fileName);
} 
```

它将返回带有您选择的扩展名的完整路径。

请注意，不能保证生成唯一的文件名，因为从技术上讲，其他人可能已经创建了该文件。然而，有人猜测您的应用程序生成的下一个 guid 并创建它的机会非常低。假设这将是独一无二的，这是非常安全的。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2012-04-14T09:20:27.913

```
public static string GetTempFileName(string extension)
{
  int attempt = 0;
  while (true)
  {
    string fileName = Path.GetRandomFileName();
    fileName = Path.ChangeExtension(fileName, extension);
    fileName = Path.Combine(Path.GetTempPath(), fileName);

    try
    {
      using (new FileStream(fileName, FileMode.CreateNew)) { }
      return fileName;
    }
    catch (IOException ex)
    {
      if (++attempt == 10)
        throw new IOException("No unique temporary file name is available.", ex);
    }
  }
} 
```

注意：这类似于 Path.GetTempFileName。创建一个空文件以保留文件名。如果 Path.GetRandomFileName() 产生冲突，它会进行 10 次尝试；

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-07-14T02:03:10.703

您也可以使用[System.CodeDom.Compiler.TempFileCollection](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.tempfilecollection.aspx)。

```
string tempDirectory = @"c:\\temp";
TempFileCollection coll = new TempFileCollection(tempDirectory, true);
string filename = coll.AddExtension("txt", true);
File.WriteAllText(Path.Combine(tempDirectory,filename),"Hello World"); 
```

这里我使用了 txt 扩展名，但你可以指定任何你想要的。我还将keep标志设置为true，以便临时文件在使用后保留。不幸的是，TempFileCollection 会为每个扩展名创建一个随机文件。如果需要更多临时文件，可以创建多个 TempFileCollection 实例。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-24T13:25:06.157

为什么不检查文件是否存在？

```
string fileName;
do
{
    fileName = System.IO.Path.GetTempPath() + Guid.NewGuid().ToString() + ".csv";
} while (System.IO.File.Exists(fileName)); 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-10-01T15:18:31.347

[C++ 的 GetTempFileName](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364991.aspx)的 MSDN 文档讨论了您的问题并回答了它：

> **GetTempFileName 不能保证文件名是唯一的**。
> 
> 仅使用 uUnique 参数的低 16 位。如果 lpPathName 和 lpPrefixString 参数保持不变，这会将 GetTempFileName 限制为最多 65,535 个唯一文件名。
> 
> 由于用于生成文件名的算法，GetTempFileName 在创建大量具有相同前缀的文件时性能不佳。在这种情况下，**建议您根据 GUID 构造唯一的文件名**。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-24T14:39:08.350

您还可以执行以下操作

```
string filepath = Path.ChangeExtension(Path.GetTempFileName(), ".csv"); 
```

这也可以按预期工作

```
string filepath = Path.ChangeExtension(Path.GetTempPath() + Guid.NewGuid().ToString(), ".csv"); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-07-27T08:12:39.917

怎么样：

```
Path.Combine(Path.GetTempPath(), DateTime.Now.Ticks.ToString() + "_" + Guid.NewGuid().ToString() + ".csv") 
```

计算机在同一时刻生成相同 Guid 的可能性很小。我在这里看到的唯一弱点是 DateTime.Now.Ticks 将添加的性能影响。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-01-06T08:19:43.793

在我看来，这里提出的大多数答案都是次优的。最接近的一个是最初由 Brann 提出的。

临时文件名必须是

*   独特
*   无冲突（尚不存在）
*   原子（在同一操作中创建名称和文件）
*   很难猜

由于这些要求，自己编写这样的野兽并不是一个好主意。编写 IO 库的聪明人会担心锁定（如果需要）等问题。因此，我认为没有必要重写 System.IO.Path.GetTempFileName()。

即使它看起来很笨拙，也应该可以完成这项工作：

```
//Note that this already *creates* the file
string filename1 = System.IO.Path.GetTempFileName()
// Rename and move
filename = filename.Replace(".tmp", ".csv");
File.Move(filename1 , filename); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-10-29T14:04:02.967

我混合[了@Maxence](https://stackoverflow.com/a/10152460/1315873)和[@Mitch Wheat](https://stackoverflow.com/a/581574/1315873)答案，记住我想要GetTempFileName 方法的语义（fileName 是创建的新文件的名称）添加首选扩展名。

```
string GetNewTempFile(string extension)
{
    if (!extension.StartWith(".")) extension="." + extension;
    string fileName;
    bool bCollisions = false;
    do {
        fileName = Path.Combine(System.IO.Path.GetTempPath(), Guid.NewGuid().ToString() + extension);
        try
        {
            using (new FileStream(fileName, FileMode.CreateNew)) { }
            bCollisions = false;
        }
        catch (IOException)
        {
            bCollisions = true;
        }
    }
    while (bCollisions);
    return fileName;
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-05-30T12:49:30.917

这对你来说可能很方便......这是为了创建一个临时文件。文件夹并将其作为 VB.NET 中的字符串返回。

轻松转换为 C#：

```
Public Function GetTempDirectory() As String
    Dim mpath As String
    Do
        mpath = System.IO.Path.Combine(System.IO.Path.GetTempPath, System.IO.Path.GetRandomFileName)
    Loop While System.IO.Directory.Exists(mpath) Or System.IO.File.Exists(mpath)
    System.IO.Directory.CreateDirectory(mpath)
    Return mpath
End Function 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-07-25T12:52:43.627

这对我来说似乎很好用：它检查文件是否存在并创建文件以确保它是可写位置。应该可以正常工作，您可以将其更改为直接返回 FileStream （这通常是您需要的临时文件）：

```
private string GetTempFile(string fileExtension)
{
  string temp = System.IO.Path.GetTempPath();
  string res = string.Empty;
  while (true) {
    res = string.Format("{0}.{1}", Guid.NewGuid().ToString(), fileExtension);
    res = System.IO.Path.Combine(temp, res);
    if (!System.IO.File.Exists(res)) {
      try {
        System.IO.FileStream s = System.IO.File.Create(res);
        s.Close();
        break;
      }
      catch (Exception) {

      }
    }
  }
  return res;
} // GetTempFile 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-02-06T19:19:51.347

C# 中的简单函数：

```
public static string GetTempFileName(string extension = "csv")
{
    return Path.ChangeExtension(Path.GetTempFileName(), extension);
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-03-01T08:04:20.887

根据我从互联网上找到的答案，我的代码如下：

```
public static string GetTemporaryFileName()
{       
    string tempFilePath = Path.Combine(Path.GetTempPath(), "SnapshotTemp");
    Directory.Delete(tempFilePath, true);
    Directory.CreateDirectory(tempFilePath);
    return Path.Combine(tempFilePath, DateTime.Now.ToString("MMddHHmm") + "-" + Guid.NewGuid().ToString() + ".png");
} 
```

正如 Jay Hilyard 的 C# Cookbook 所言，Stephen Teilhet 在[Using a Temporary File in Your Application 中](https://www.oreilly.com/library/view/c-cookbook/0596003390/ch11s18.html)指出：

*   当您需要临时存储信息以供以后检索时，您应该使用临时文件。

*   您必须记住的一件事是在创建它的应用程序终止之前删除这个临时文件。

*   如果没有被删除，它将保留在用户的临时目录中，直到用户手动删除它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-04-15T20:13:27.357

这就是我正在做的事情：

```
字符串 tStamp = String.Format("{0:yyyyMMdd.HHmmss}", DateTime.Now);
字符串 ProcID = Process.GetCurrentProcess().Id.ToString();
字符串 tmpFolder = System.IO.Path.GetTempPath();
字符串 outFile = tmpFolder + ProcID + "_" + tStamp + ".txt"；

```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-05-16T20:45:34.570

这是生成增量文件名的一种简单但有效的方法。它将直接查看当前（您可以轻松地将其指向其他地方）并搜索具有基本 YourApplicationName*.txt 的文件（同样您可以轻松更改它）。它将从 0000 开始，因此第一个文件名将是 YourApplicationName0000.txt。如果由于某种原因在左右部分（不是数字）之间存在带有垃圾的文件名，则这些文件将通过 tryparse 调用而被忽略。

```
 public static string CreateNewOutPutFile()
    {
        const string RemoveLeft = "YourApplicationName";
        const string RemoveRight = ".txt";
        const string searchString = RemoveLeft + "*" + RemoveRight;
        const string numberSpecifier = "0000";

        int maxTempNdx = -1;

        string fileName;
        string [] Files = Directory.GetFiles(Directory.GetCurrentDirectory(), searchString);
        foreach( string file in Files)
        {
            fileName = Path.GetFileName(file);
            string stripped = fileName.Remove(fileName.Length - RemoveRight.Length, RemoveRight.Length).Remove(0, RemoveLeft.Length);
            if( int.TryParse(stripped,out int current) )
            {
                if (current > maxTempNdx)
                    maxTempNdx = current;
            }
        }
        maxTempNdx++;
        fileName = RemoveLeft + maxTempNdx.ToString(numberSpecifier) + RemoveRight;
        File.CreateText(fileName); // optional
        return fileName;
    } 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2011-08-22T07:16:55.863

我认为你应该试试这个：

```
string path = Path.GetRandomFileName();
path = Path.Combine(@"c:\temp", path);
path = Path.ChangeExtension(path, ".tmp");
File.Create(path); 
```

它生成一个唯一的文件名并在指定位置创建一个具有该文件名的文件。

# ms-access - 如何以 CSV 格式导出 Access 数据库？

> ID：581577
> 
> 赞同：1
> 
> 时间：2009-02-24T12:29:49.923
> 
> 标签：ms-access, vbscript

我有一个要导出到文本文件的 Access 数据库。我在 Access 中定义了一个架构，目前使用宏来导出它。我想使用 VBScript 始终将查询结果附加到同一个文件。如果无法使用我定义的架构，我只需要将字段用逗号分隔并用 括起来`"`，并且文本文件必须是`UTF-8`格式。

我找到了以下代码片段，但我不确定如何根据我的需要采用它。

```
db = "C:\Docs\LTD.mdb"
TextExportFile = "C:\Docs\Exp.txt"

Set cn = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")

cn.Open _
   "Provider = Microsoft.Jet.OLEDB.4.0; " & _
   "Data Source =" & db

strSQL = "SELECT * FROM tblMembers"

rs.Open strSQL, cn, 3, 3

Set fs = CreateObject("Scripting.FileSystemObject")

Set f = fs.CreateTextFile(TextExportFile, True)

a = rs.GetString

f.WriteLine a

f.Close 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T12:52:51.150

也许最简单的方法是使用 [text...].filename 方法：-

```
Dim db: db = "C:\Docs\LTD.mdb"
Dim exportDir: exportDir = "C:\Docs\" '" SO prettify does not do VB well
Dim exportFile: exportFile = "Exp.txt"

Dim cn: Set cn = CreateObject("ADODB.Connection")

cn.Open _
    "Provider = Microsoft.Jet.OLEDB.4.0; " & _
    "Data Source =" & db

cn.Execute "SELECT * INTO [text;HDR=Yes;Database=" & exportDir & _
   ";CharacterSet=65001]." & exportFile & " FROM tblMembers" 
```

FileSystemObject 不会帮助您，因为它不执行 UTF-8。UTF-8 是通过指定 CharacterSet=65001 来实现的（65001 是 UTF-8 代码页）。请注意，生成的文件不包含 UTF-8 BOM，但创建的 schema.ini 文件会注意到 CharacterSet 是 UTF-8。

请注意，这并没有达到您的附加要求，您确定这还是有意义的，您最终不会有很多重复吗？

**编辑**：

以上内容已调整为包括 UTF-8 要求。您可以简单地附加日期之类的内容来为表创建多个快照文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T13:47:36.133

方向 (2) 这是一些 VBA，从 Access 数据库运行：

```
Sub InsertRecs()
Set db = CurrentDb

'DSN=Suitable system DSN for MySQL
'Then, depending on your set up, you can incude:
'Database=DBName;
'Trusted_Connection=Yes;

'NameOfMySQLTable
strSQL = "INSERT INTO [ODBC;DSN=baywotch;].tblAuction Select * FROM tblAuction;"

db.Execute strSQL, dbFailOnError
End Sub 
```

这是同样的事情，但在 VBScript 中，使用 DAO：

```
Dim objEngine
Dim objWS
Dim objDB
Dim db: db = "C:\Docs\baywotch.db5"

Set objEngine = wscript.CreateObject("DAO.DBEngine.36")

Set objDB = objEngine.OpenDatabase(db)

objDB.Execute "INSERT INTO [ODBC;DSN=baywotch].[tblAuction] SELECT * FROM tblAuction;" 
```

方向 (1)

我建议一个完全不同的方向，那就是让 MySQL 来做这个工作：

[MySQL 迁移工具包](http://dev.mysql.com/doc/migration-toolkit/en/index.html)

我对您的数据库进行了测试，它似乎可以正确导入，只需要几分钟，并且会生成各种可重用的脚本等等。

如果您在设置 MySQL 时遇到问题，不妨阅读： [9.1.4。连接字符集和排序规则](http://dev.mysql.com/doc/refman/5.0/en/charset-connection.html)

方向 (0)

重写 (2)

```
'========================================================================'
'
'                   FROM: AnthonyWJones, see post ' 
'
'========================================================================'
Dim db: db = "C:\Docs\baywotch.db5"
Dim exportDir: exportDir = "C:\Docs\" '" SO prettify does not do VB well
Dim exportFile: exportFile=NewFileName(exportDir)

Dim cn: Set cn = CreateObject("ADODB.Connection")

cn.Open _
    "Provider = Microsoft.Jet.OLEDB.4.0; " & _
    "Data Source =" & db

cn.Execute "SELECT * INTO [text;HDR=Yes;Database=" & exportDir & _
   ";CharacterSet=65001]." & exportFile & " FROM tblAuction"

'Export file

'========================================================================'

'Support functions

Function NewFileName(ExportPath)
Dim fs 
Dim NewFileTemp

Set fs = CreateObject("Scripting.FileSystemObject")

NewFileTemp = "CSV" & Year(Date) _
    & Right("00" & Month(Date),2) & Right("00" & Day(Date) ,2) & ".csv"

a = fs.FileExists(ExportPath & NewFileTemp)

i = 1
Do While a
    NewFileTemp = "CSV" & Year(Date) _
        & Right("00" & Month(Date),2) & Right("00" & Day(Date) ,2) & "_" & i & ".csv"

    a = fs.FileExists(ExportPath & NewFileTemp)
    i = i + 1
    If i > 9 Then
        'Nine seems enough times per day to be 
        'exporting a table
        a = True
        MsgBox "Too many attempts"
        WScript.Quit
    End If
Loop

NewFileName = NewFileTemp
End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T13:05:02.507

我已经对这些行进行了编号以供参考。

```
1\. db = "C:\Docs\LTD.mdb"
2\. TextExportFile = "C:\Docs\Exp.txt"
3\. strSQL = "SELECT * FROM tblMembers"
4\. Set f = fs.CreateTextFile(TextExportFile, True) 
```

第 1 行 - 是您正在使用的当前访问数据库文件。在这种情况下，它是 LTD.mdb
第 2 行 - 是您要写入/附加的文件的名称。它是 Exp.txt
第 3 行 - 是用于收集数据的 sql 语句。
第 4 行 - 是打开要写入的文件的命令。

将第 2 行更改为所需文件的名称。
将第 3 行更改为您要使用的表。如果您只想通过名称识别它们，选择 * 将使用所有列。从 mytable 中选择 col1、col2 ... 您还需要考虑使用 where 子句。

将第 4 行从 CreateTextFile 更改为 OpenTextFile 并使用 ForAppending 进行追加。 [MSDN VBA](http://msdn.microsoft.com/en-us/library/aa265018(VS.60).aspx)

我在格式化行时画了一个空白。我使用的一种方法是修改 select 语句以包含逗号。例如从 mytable 中选择 col1 & "," & col2。

对于 UTF-8（我没有工作示例）尝试：

```
utf = new String(a, 0, a.length, UTF-8);
f.WriteLine utf; 
```

[UTF-8 VBA](http://www.xtremevbtalk.com/showthread.php?p=1320077)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:46:30.783

```
 Const adOpenStatic = 3
Const adLockOptimistic = 3
Const adClipString = 2
Const ForWriting = 2
Const ForAppending = 8
Const strDB = "C:\Docs\LTD.mdb"
Const strCSV = "C:\Docs\Exp.csv"

Set objAccessConnection = CreateObject("ADODB.Connection")
objAccessConnection.Open "Provider=Microsoft.Jet.OLEDB.4.0;Persist Security Info=False;Data Source=" & strDB

Set objAccessRecordset = CreateObject("ADODB.Recordset")

strAccessQuery =  "SELECT * FROM tblMembers"
objAccessRecordset.Open strAccessQuery, objAccessConnection, adOpenStatic, adLockOptimistic

Set objCSV = CreateObject("Scripting.FileSystemObject").OpenTextFile(strCSV, ForAppending, True)
objCSV.Write objAccessRecordset.GetString(adClipString,,",",CRLF)

objCSV.Close
Set objCSV = Nothing
objAccessRecordset.Close
Set objAccessRecordset = Nothing
objAccessConnection.Close
Set objAccessConnection = Nothing 
```

# unit-testing - 有没有办法从 MSTest 获取测试结果和覆盖率 html 报告

> ID：581578
> 
> 赞同：9
> 
> 时间：2009-02-24T12:30:25.790
> 
> 标签：unit-testing, report, mstest, code-coverage

我希望能够从 MSTest 创建的`Results.trx`和`data.coverage`文件中生成基于 HTML 的报告。理想情况下，这只会列出所有故障，并显示一些基本的覆盖率统计信息。

有谁知道这样做的工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2020-02-27T06:24:14.583

您可以使用**TRXER**工具从 trx 文件生成 HTML 报告。[从这里](https://github.com/NivNavick/trxer/releases)下载 TrxerConsole.exe 文件

1.  构建/重建项目以创建 .dll 文件。
2.  如果您的项目名称是 UnitTest1，则 .dll 文件名将是 UnitTest1.dll。转到 .dll 的位置，例如

> C:\Users\NAME\source\repos\UnitTest1\UnitTest1\bin\Debug\netcoreapp3.1\UnitTest1.dll

3.  打开**Visual Studio 2019 的开发者命令提示符**
4.  运行命令设置位置

> cd C:\Users\NAME\source\repos\UnitTest1\UnitTest1\bin\Debug\netcoreapp3.1\UnitTest1.dll

5.  运行命令生成 trx 文件：

> vstest.console.exe UnitTest1.dll /logger:trx

6.  Trx 文件将在文件夹**TestReults**中生成，该文件夹与项目 dll 文件所在的位置相同。

7.  如果 TrxerConsole.exe 在下载中，则运行命令以转换为 HTML。

    trxerconsole.exe 文件的路径，然后是空格，然后是 trxfile 的路径，如下所示

> C:\Users\NAME\Downloads\TrxerConsole.exe C:\Users\NAME\source\repos\DesktopWithMSTest\DesktopWithMSTest\bin\Debug\netcoreapp3.1\TestResults\TestResult.trx

8.  HTML 文件将在相同的 TestResults 文件夹中生成。

参考[链接](https://github.com/NivNavick/trxer)

您的报告将如下所示：

[![报告](https://i.stack.imgur.com/9InRA.png)](https://i.stack.imgur.com/9InRA.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T17:15:51.383

实际上，我们使用开源工具[Trx2Html做到了这一点](http://www.codeplex.com/trx2html)

它非常简单 - 获取 trx 文件并输出 html。VS2005 trx 和 VS2008 trx 有特定的版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T23:42:33.917

trx 文件是相当简单的 xml 文档，可以使用 XSLT 轻松处理以生成灵活和定制的报告。

如果你在谷歌上搜索 trx 和 xslt，你会发现很多例子可以帮助你入门。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T12:37:42.527

您可以发布到报表服务器，然后可以从 Web 界面访问报表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T12:39:52.927

（我是在 PowerShell 中完成的）

你需要这个dll

Microsoft.VisualStudio.Coverage.Analysis.dll

那么这一行将把 .coverage 变成一个 xml 文件（.trx 已经是）

```
$dataStore = ([Microsoft.VisualStudio.CodeCoverage.CoverageInfoManager]::CreateInfoFromFile("$homeDir\tests.coverage")).BuildDataSet($null)

$dataStore.WriteXml("$homeDir\Coverage.xml") 
```

然后，您可以使用来自 Cruisecontrol.net 的 MsTest xsl 文件将测试结果转换为漂亮的 html 格式，并且我有一个用于覆盖范围的 XSL。不适合这里。我希望他们有办法上传文件。在 hotmail 给我发电子邮件给我 alex dot hutton，我可以给你 xsl 以显示该覆盖范围

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-20T18:32:03.330

我为此添加了一个 codeplex 项目，您可以从 trx 生成 html 以及将代码覆盖率数据添加到同一个报告中。[http://trxtohtml.codeplex.com/](http://trxtohtml.codeplex.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-05-16T10:24:37.177

尝试新的 trx2html.codeplex.com，它不是基于 XSLT，而是基于 LINQ2XML，因此更容易扩展

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-29T08:50:42.513

> 我正在编写一个简单的批处理文件来将您的 XML 报告转换为 HTML

## 先决条件

1.  从[这里](http://www.codeplex.com/trx2html)下载**trx2html.exe**
2.  将其粘贴到计算机上生成 XML 文件的任何位置
3.  创建一个**report.bat**文件并粘贴下面给出的代码

    @echo off ::**********************************常量*************** ******************************************************设置“trxFileName=TestResult”
    设置“trx2html_path=C:\Users\Desktop\0.6\TrxerConsole.exe”::****************************** ****************************************************** *****************

    echo ------------"生成测试报告"-------- -------------------------- %trx2html_path% ".\Results\%trxFileName%"

    echo -----------"在位置生成的测试报告=.\Results\%trxFileName%"----------- - 暂停

# java - 使用 java.util.TimeZone 查找 DST 转换时间戳

> ID：581581
> 
> 赞同：4
> 
> 时间：2009-02-24T12:32:22.570
> 
> 标签：java, jodatime

是否可以使用 Java Calendar/Date/TimeZone API 获取上一个和下一个 DST 转换时间戳？
我`Joda-Time`可以写：

```
DateMidnight today = new DateMidnight(2009, 2, 24);
DateTimeZone zone = today.getZone();

DateTime previousTransition =
    new DateTime(zone.previousTransition(today.getMillis()));
// 2008-10-26T02:59:59.999+02:00 for Europe/Berlin
System.out.println(previousTransition);

DateTime nextTransition =
    new DateTime(zone.nextTransition(today.getMillis()));
// 2009-03-29T03:00:00.000+02:00 for Europe/Berlin
System.out.println(nextTransition); 
```

有没有办法使用标准的 Java API 来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T12:40:34.547

java Date/Calendar/TimeZone API 中没有这样的功能

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T13:53:56.807

当我需要这样的功能时，我想出的最好的方法是使用日历并在指定的时区遍历整年，并询问每天的每个小时是 DST 的开始还是结束。

您必须这样做，因为在 Sun 的 JVM 上，TimeZone (sun.util.calendar.ZoneInfo) 的实现以某种“编译”形式保存有关时区转换的数据。

代码是这样的：

```
public class Dst {
    Date start;
    Date end;

    public static Dst calculate(TimeZone tz, int year) {
        final Calendar c = Calendar.getInstance(tz);
        c.setLenient(false);
        c.set(year, Calendar.JANUARY, 1, 1, 0, 0);
        c.set(Calendar.MILLISECOND, 0);

        if (tz.getDSTSavings() == 0) {
            return null;
        }

        Dst dst = new Dst();

        boolean flag = false;

        do {
            Date date = c.getTime();
            boolean daylight = tz.inDaylightTime(date);

            if (daylight && !flag) {
                flag = true;
                dst.start = date;
            }
            else if (!daylight && flag) {
                flag = false;
                dst.end = date;
            }

            c.add(Calendar.HOUR_OF_DAY, 1);
        }
        while (c.get(Calendar.YEAR) == year);

        return dst;
    }
} 
```

当然，缓存/记忆这些计算的结果等是有意义的。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-05T01:16:10.860

使用 Java 8，您可以使用

```
ZoneRules#nextTransition(Instant) 
```

&

```
ZoneRules#previousTransition(Instant) 
```

做同样事情的方法。

[https://docs.oracle.com/javase/8/docs/api/java/time/zone/ZoneRules.html](https://docs.oracle.com/javase/8/docs/api/java/time/zone/ZoneRules.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-01T10:33:23.887

是的，有一种间接的方法可以从 Java API 中检索它。检查一下，让我知道这是否适用于问题：

[http://monisiqbal.blogspot.com/2009/12/retrieving-time-zones-dst-information.html](http://monisiqbal.blogspot.com/2009/12/retrieving-time-zones-dst-information.html)

这应该为您提供当年所需的信息，如果您愿意，您可以轻松地为前几年做同样的事情。

# asp.net - 使用 Gridview 和文件传输

> ID：581583
> 
> 赞同：1
> 
> 时间：2009-02-24T12:35:21.910
> 
> 标签：asp.net, httpwebrequest, file-transfer

我需要在运行时针对 GridView 中的事件生成 Excel 工作表`ItemCommand_click`并传输文件，然后将 GridView 与状态更改重新绑定。

当我们使用 File transfer 重定向响应时，如何更新 GridView？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T16:20:30.400

我希望对行上的选定索引更改执行非常类似的操作，以将报告服务报告输出为 PDF。我只能使用 response.redirect 来处理文件输出的另一个页面。看起来您的问题确实变成了状态更改后重新绑定网格，如果您执行 response.redirect，则无法触摸您的网格...

看看这段代码。我在[encosia.com](http://encosia.com/2007/02/23/ajax-file-downloads-and-iframes/)上找到了它。看起来您可以使用 iFrame 进行输出，然后您可以使用 JavaScript 调用回发页面以重新绑定网格。

```
<html>
<body>
<form id="form1" runat="server">
<asp:ScriptManager runat="server" />
<script language="javascript">
  // Get a PageRequestManager reference.
  var prm = Sys.WebForms.PageRequestManager.getInstance();

  // Hook the _initializeRequest event and add our own handler.
  prm.add_initializeRequest(InitializeRequest);

  function InitializeRequest(sender, args)
  {
    // Check to be sure this async postback is actually 
    //   requesting the file download.
    if (sender._postBackSettings.sourceElement.id == "DownloadFile")
    {
      // Create an IFRAME.
      var iframe = document.createElement("iframe");

      // Get the desired region from the dropdown.
      var region = $get("Region").value;

      // Point the IFRAME to GenerateFile, with the
      //   desired region as a querystring argument.
      iframe.src = "GenerateFile.aspx?region=" + region;

      // This makes the IFRAME invisible to the user.
      iframe.style.display = "none";

      // Add the IFRAME to the page.  This will trigger
      //   a request to GenerateFile now.
      document.body.appendChild(iframe); 
    }
  }
</script>
<asp:UpdatePanel runat="server">
  <ContentTemplate>
    <asp:DropDownList runat="server" ID="Region">
      <asp:ListItem Value="N">North Region</asp:ListItem>
      <asp:ListItem Value="W">West Region</asp:ListItem>
      <asp:ListItem Value="SE">Southeast Region</asp:ListItem>
    </asp:DropDownList>
    <asp:Button runat="server" ID="DownloadFile" Text="Generate Report" />
  </ContentTemplate>
</asp:UpdatePanel>
</form>
</body>
</html> 
```

处理下载的页面...

```
protected void Page_Load(object sender, EventArgs e)
{
  string FileResponse;
  string Region = Request.QueryString["Region"];

  // Code here to fill FileResponse with the 
  //  appropriate data based on the selected Region.

  Response.AddHeader("Content-disposition", "attachment; filename=report.csv");
  Response.ContentType = "application/octet-stream";
  Response.Write(FileResponse);
  Response.End();
} 
```

# c++ - 可重复的目标代码生成 C++

> ID：581585
> 
> 赞同：5
> 
> 时间：2009-02-24T12:35:55.090
> 
> 标签：c++, binary-reproducibility

当我使用 c++ 编译器构建项目时，如果源代码没有更改，我能否确保生成的二进制文件不受影响？看起来每次我重新编译我的源代码时，二进制文件的 md5 校验和都会受到影响。编译时间是否会以某种方式影响生成的二进制文件？如何生成可重复的编译结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T12:46:18.310

可以反汇编二进制文件并在输出上运行 md5

MacOSX 上的示例

```
otool -tV a.out | md5
ee2e724434a89fce96aa6b48621f7220 
```

但是，一个人错过了全局数据......（也可能是一个要包含的参数）

*我正在回答 md5 检查二进制文件的问题......您如何管理您的源代码和构建系统，正如其他人所写的那样也是值得关注的*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T12:42:54.900

我怀疑它在很大程度上取决于您的工具链和操作系统。例如，如果其中一个可执行标头包含时间戳，那么您总是会发现生成的 MD5 是不同的。

您要达到的最终结果是什么（即为什么它们相同如此重要）..？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T22:11:30.400

您不能对 Visual Studio 进行 md5 校验和比较。对于来自 Visual Studio 的普通发行版 .exe 文件，每次重新编译都会有 3 个位置发生变化。其中两个是时间戳，第三个是唯一的 GUID，Visual Studio 使用它来匹配 .exe 的版本与帮助文件以确保它们同步。

可能可以编写一个工具将 3 个更改字段归零，但我不确定解析文件有多容易。

此外，如果您调用任何 .dll，如果我没记错的话，您将在生成的文件中获得更多唯一标识符。

调试版本是另一回事。我认为还有很多很多不同之处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T12:39:15.767

使用增量构建系统 - 例如`make`确保在源不更改时不会重新编译代码。

有可能让您的编译器从相同的源生成相同的二进制文件 - 或者它可能不会 - 这取决于编译器。大多数会将当前时间嵌入到生成的二进制文件中。

# java - 如何开始创建 Java Web 服务？

> ID：581590
> 
> 赞同：1
> 
> 时间：2009-02-24T12:39:04.193
> 
> 标签：java, web-services

我想创建一个简单的`hello world`java web 服务。

我需要什么工具才能开始？

我需要知道什么才能开始在 Tomcat 中部署它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T12:40:45.560

有很多[Tomcat+axis 教程](http://www.google.com/search?q=tomcat+axis+tutorial)。例如，[这篇博文](http://tomcat-configure.blogspot.com/2009/01/tomcat-axis-tutorial.html)似乎做得很合理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T23:49:34.237

当我开始学习如何构建和使用 Java Web 服务时，我阅读了本教程 [http://www.netbeans.org/kb/60/websvc/jax-ws.html](http://www.netbeans.org/kb/60/websvc/jax-ws.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T12:54:12.627

在 JEE5 中，您可以使用注释来注释 POJO 以创建 Web 服务：http: [//www.netbeans.org/kb/55/websvc-jax-ws.html](http://www.netbeans.org/kb/55/websvc-jax-ws.html)

# sql-server - 是否所有 SQL Server 版本都会自动重建索引或具有默认的重建标准？

> ID：581592
> 
> 赞同：12
> 
> 时间：2009-02-24T12:39:07.453
> 
> 标签：sql-server, indexing, maintenance

是否所有 SQL Server 版本都会自动重建索引或具有默认的重建标准？我了解统计信息是自动重建的，但不确定索引是否也可以。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T12:42:38.817

任何版本的 Microsoft SQL Server 都不支持自动重建索引 - 原因是重建索引可能是非常昂贵的操作，因此需要仔细安排和计划。

在许多环境中，将编写特殊脚本来处理此问题，例如：

[http://weblogs.sqlteam.com/tarad/archive/2008/09/03/Defragmenting-Indexes-in-SQL-Server-2005.aspx](http://weblogs.sqlteam.com/tarad/archive/2008/09/03/Defragmenting-Indexes-in-SQL-Server-2005.aspx)

请注意，虽然 SQL 可以在许多情况下为您自动更新统计信息，但通过更仔细地管理这些统计信息也可以获得性能提升。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-24T14:55:58.233

正如人们在这里提到的那样，您的索引不会自动重建。这在 SQL Server 中是一个相当大的问题，因为您的索引会随着时间的推移而碎片化。您会发现您的索引有 95% 以上是碎片化的，严重影响了查询性能。

这是一个简单的查询来检查现有索引上的碎片：

```
DECLARE @DBNAME VARCHAR(130);
SET @DBNAME = 'MYDBNAME';

DECLARE @DBID INT;
SET @DBID = DB_ID(@DBNAME);

SELECT
OBJECT_ID AS objectID
, index_id AS indexID
, avg_fragmentation_in_percent AS fragmentation
, page_count 
INTO #indexDefragList
FROM
sys.dm_db_index_physical_stats 
(@DBID, NULL, NULL , NULL, N'Limited')
WHERE
index_id > 0
OPTION (MaxDop 1);

SELECT
i.[name] as indexname,
d.fragmentation,
d.page_count
FROM
#indexDefragList d
INNER JOIN sys.indexes i
ON d.objectid = i.object_id
ORDER BY 
d.fragmentation DESC

DROP TABLE #indexDefragList 
```

这将返回当前数据库中所有索引的列表及其碎片百分比。

您可以轻松构建脚本以自动重建或重组它们。SQLFool有一篇[很棒的文章，](http://sqlfool.com/2008/11/updated-index-defrag-script-)其中包括一个完整的预制脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T12:48:31.393

正如@Chris 所指出的，在任何 SQL Server 版本中都不会自动重建索引。没有专门的 DBA 角色的站点经常缺少适当的索引维护，并且通常当数据库只是从开发转移到生产时（以及事务日志维护）。

SQL Server 2005+ 能够进行在线索引重组和离线完全重建。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T16:13:53.367

扩展克里斯所说的内容：

关于统计信息，索引未覆盖的列将不会通过重建所有索引来更新其统计信息。SQL Server 可能会定期更新它们，但是您可能需要自己使用 UPDATE STATISTICS 语句进行更新。

SQL Server 2005 确定是否根据对列修改计数器 (colmodctrs) 的更改自动更新统计信息。

在以下情况下，统计对象被视为过期：

1.表格大小已从 0 行变为 >0 行。

2.统计时表中的行数为500或更少，并且统计对象的前导列的colmodctr从那时起变化了500多。

3.统计时表超过500行，统计对象前导列colmodctr变化超过统计时表行数的500+20%

您可以找到以下有关使用统计的参考：

[http://blogs.technet.com/rob/archive/2008/05/16/sql-server-statistics.aspx](http://blogs.technet.com/rob/archive/2008/05/16/sql-server-statistics.aspx)

希望这会有所帮助，但请随时提出进一步的疑问。

干杯，约翰

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T12:46:37.467

必须自己安排和安排。

整理时，取决于表的大小和维护窗口。

此外，在重建索引时会自动重建统计信息，但可以单独安排。

为了快速修复，假设维护窗口很长且不太大（最多 100 GB），只需安排以下时间：

```
EXEC sp_msforeachtable 'SET QUOTED_IDENTIFIER ON ALTER INDEX ALL ON ? REBUILD WITH (FILLFACTOR = 90)' 
```

编辑：仅适用于 > SQL 2005 这个 SQL

# c++ - 向量、迭代器和 std::find

> ID：581595
> 
> 赞同：3
> 
> 时间：2009-02-24T12:39:41.850
> 
> 标签：c++, vector, iterator

有没有办法在不同的向量中使用不同类型的迭代器？或者，是否有一个函数可以将向量中元素的位置作为整数返回？

```
std::vector<DWORD>::iterator it;        // Iterator

// monsterQueue is a <DWORD> vector

it = std::find(bot.monsterQueue.begin(), bot.monsterQueue.end(), object);   
// Check do we have the object in the queue

if(it != bot.monsterQueue.end())    // If we do have it
{
    bot.monsterDists.at(it) = mobDist; // monsterDists is <int> vector
    bot.monsterCoordX.at(it) = PosX; // monsterCoordX is <int> vector
    bot.monsterCoordY.at(it) = PosY; // monsterCoordY is <int> vector too
} 
```

这是一些示例代码，有人有任何指示吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-24T12:49:50.390

```
index = std::distance( monsterQueue.begin(), it ); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-24T12:48:11.130

简单计算

```
it - bot.monsterQueue.begin() 
```

获取索引。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-24T12:53:15.203

尝试

```
std::vector<DWORD>::iterator it;        // Iterator

// monsterQueue is a <DWORD> vector

it = std::find(bot.monsterQueue.begin(), bot.monsterQueue.end(), object);   
// Check do we have the object in the queue

if(it != bot.monsterQueue.end())    // If we do have it
{ 
```

**size_t idx = 它 - bot.monsterQueue.begin()**

```
 bot.monsterDists.at(idx) = mobDist; // monsterDists is <int> vector
    bot.monsterCoordX.at(idx) = PosX; // monsterCoordX is <int> vector
    bot.monsterCoordY.at(idx) = PosY; // monsterCoordY is <int> vector too
} 
```

也可能创建一个具有 4 个成员 'monster'、monsterDist 和坐标 X 和坐标 Y 的结构并将结构对象存储在向量中会是一个更好的主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T12:44:57.063

您可以在 std::vectors 中使用随机访问：

```
DWORD find_this = 0x0;
int pos = 0;
for (; i<monsterQueue.size(); ++i)
{
    if (monsterQueue[i]==find_this)
        break;
} 
```

在循环之后， pos 将是循环中断的位置，即所在`find_this`的位置。当然，除非 if`find_this`甚至不在向量中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T12:50:57.877

您是否考虑过将 monsterQueue 的基础类型更改为包含或具有指向 monsterDists 等的引用/指针的对象

# c++ - 寻找开源平面文件/xml 数据库 C++ 库

> ID：581609
> 
> 赞同：9
> 
> 时间：2009-02-24T12:45:23.367
> 
> 标签：c++, database, open-source, flat-file

我正在寻找一个可以编译成 C++ 应用程序的轻量级数据库库。

有没有这样的存在？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-24T12:50:21.590

[SQLite](http://www.sqlite.org/)。不是平面文件，而是基于文件的，可以很容易地嵌入到应用程序中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T12:53:58.197

对于纯 XML 嵌入式数据库，您可能需要查看[Oracle Berkeley DB XML](http://www.oracle.com/database/berkeley-db/xml/index.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T13:07:28.023

也许这个非常轻量级的 XML 库也可以提供帮助：[RapidXML](http://rapidxml.sourceforge.net/)。它是一个 XML 解析器，而不是数据库库，但取决于您的应用程序可能就足够了（您提到了一个平面文件 XML 数据存储）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T13:05:54.347

你也可以看看berkleyDB

来自[维基百科](http://en.wikipedia.org/wiki/Berkeley_DB)：

> Berkeley DB (BDB) 是一个提供高性能嵌入式数据库的计算机软件库，绑定了 C、C++、Java、Perl、Python、Ruby、Tcl、Smalltalk 和许多其他编程语言。BDB 将任意键/数据对存储为字节数组，并支持单个键的多个数据项。BDB 可以在包括大多数类 Unix 和 Windows 系统以及实时操作系统在内的各种操作系统上支持数千个同时控制线程或并发进程来操作高达 256 TB 的数据库。

# java - 站点间通信：如何将在站点 A 上注册的身份验证用户与站点 B 进行通信？

> ID：581612
> 
> 赞同：0
> 
> 时间：2009-02-24T12:46:04.440
> 
> 标签：java, communication

我的情况是，在站点 A 上注册了“n”个用户。用户使用站点 A 上的服务后，他/她被重定向到站点 B 以访问站点 B 托管的服务。如何站点 B 上的应用程序确保/验证用户是站点 A 的经过身份验证的用户，而不是恶意重定向请求。

有可能使用联合身份。但是，我正在寻找其他解决方案。

有人可以指导我应该从哪里开始寻找启用这样的服务/功能。

托管在站点 B 上的应用程序是用 JAVA 开发的。当然，通信是独立于技术的，但是使用 JAVA 的技能集将是一个额外的优势。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T12:49:10.080

这个主题通常被称为[单点登录](http://www.ibm.com/developerworks/java/library/j-gss-sso/)，有很多很多的解决方案，完整的主题真的超出了这里单一答案的范围。

这取决于很多因素，您需要/想要使用的技术堆栈等等等等。

我已经使用 Oracle SSO 完成了一些工作。这实际上有点烦人，您必须拦截自定义标头的 HTTP 请求以验证用户等。

一些值得一试的项目是[JOSSO](http://www.google.com.au/search?hl=en&q=josso&btnG=Google+Search&meta=lr%3Dlang_en)和[CAS](http://www.jasig.org/cas)。

# javascript - JS/jQuery：如何根据 img src自动将标签包装在 s 周围，并且 href 是动态的？

> ID：581645
> 
> 赞同：4
> 
> 时间：2009-02-24T12:55:00.240
> 
> 标签：javascript, jquery, dynamic, href, word-wrap

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-24T12:58:35.800

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T13:25:58.933

如果您只需要可点击的图像，请执行以下操作：

```
$(".displayWrapper img").click(function(){
  document.location.href = this.src.replace("img_T", "img_L");
}); 
```

# user-input - 处理 From 和 To 范围字段值

> ID：581646
> 
> 赞同：0
> 
> 时间：2009-02-24T12:55:29.317
> 
> 标签：user-input

例如，我从用户那里得到一系列整数：

*在nnn*和*nnn*小部件之间生成。

是的，大多数用户会确保第一个数字等于或小于第二个数字：

生成**3**到**7**个小部件。

但是还有**那个**用户，他想“从后到前”输入这些数据；

生成**7**到**3**个小部件。

当用户单击确定/应用时，您是否*悄悄地*切换字段，所以在上面的示例中，您在 GUI 中将 7 到 3 的范围更改回 3 到 7？这在用户输入一些数据然后提交表单再也看不到它的 Web 表单上可能不太实用，但我更多地考虑的是桌面应用程序的设置页面，其中用户的输入被保存并随后查看和用户再次编辑。

尝试并教育用户通过错误/警报消息输入“有意义”的范围，还是悄悄地哄骗他们进入应用程序所期望的形状更重要？

我怀疑“哄骗选项”更可取，但是这个“嘿，程序弄乱了我的数据！” 方法对用户来说是个问题吗？

我目前正在编写一个应用程序，其中包含一些用户可配置的范围，因此我非常有兴趣遵循 SO 专家的普遍共识。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T13:02:58.050

如果用户输入数据不正确，您不应该假设特定的错误模式并自动更正它。要么向用户报告错误并要求他们更正它，要么提出他们可以批准的更正。在您的示例中，如果用户打算输入 7 和 13 但只是输入错误怎么办。如果您将其更改为 3 和 7，则您在用户不知情的情况下输入了不正确的数据。我可能会做简单的事情，并在输入不正确的数据时使用视觉警报（但在实际提交之前）并拒绝接受不正确的数据，如果提交不正确则返回错误。

# exec - unix 中 exec 系列的任何函数都不会忽略 SIGINT 吗？

> ID：581654
> 
> 赞同：2
> 
> 时间：2009-02-24T13:01:02.423
> 
> 标签：exec, signals

是否可以启动一个进程`exec`并让该进程在后台运行，并且（不像`System()`），`kill`一旦将中断信号传递给创建它的父进程，该进程是否会被编辑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T14:48:52.697

Yeah. Ignoring SIGINT is a behavior specific to system(). If you roll your own system() using fork() and execl(), you won't get that.

Of course, unless you're really careful you're going to make zombies.

# java - 服务器端 API 中的权限检查

> ID：581655
> 
> 赞同：3
> 
> 时间：2009-02-24T13:01:13.860
> 
> 标签：java, security, spring, permissions, spring-security

我们的产品建立在客户端-服务器架构上，服务器用 Java 实现（我们使用 POJO 和 Spring 框架）。我们在服务器上有两个 API 级别：

*   **外部 API**，它使用 REST Web 服务 - 对于外部客户端和与其他服​​务器的集成很有用。
*   **内部 API** ，它使用纯 Java 类 -对于内部的实际代码（业务逻辑多次调用 API 调用）以及与公司内部开发并作为我们产品的一部分部署的 plusins 集成很有用。外部 REST API 也使用内部 API。

我们在内部 API 中实现了权限检查（使用 Spring 安全性），因为我们希望在最低 API 级别控制访问。

**但是问题来了**：在 API 级别上定义了一些操作，这些操作被认为对当前登录的用户是禁止的，但应该由服务器本身顺利执行。例如，可以禁止用户删除某些实体，但服务器可能希望删除该实体，作为用户执行的某些其他操作的副作用，我们希望允许这样做。

那么，允许服务器执行实际登录用户可能禁止的操作（在某种超级用户模式下）的最佳方法是什么？

正如我所看到的，我们有几个选择，每个都有其优点和缺点：

1.  在外部级别 API (REST) 中实施权限检查 - 不好，因为插件将绕过权限检查。
2.  在请求被授予后关闭当前线程的权限检查 - 太危险了，我们可能允许太多应该被禁止的服务器操作。
3.  明确要求内部 API 级别以特权模式执行操作（就像 java 安全框架中的 PrivilegedAction 一样） - 太冗长了。

由于上述方法都不是理想的，**我想知道这个问题的最佳实践方法是什么？**

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T03:56:02.273

安全性应用于模块的边界。如果我理解您，您的系统将安全性应用于（大致）相同 API 的两个抽象级别。这听起来很复杂，因为您必须对整个两个 API 进行双重安全检查。

考虑将 REST 所需的方法从内部 API 迁移到外部 API，并删除内部 API 中的安全内容。

*   外部 API 将管理外部客户端的安全性（在您的应用程序的边界）
*   内部 API 将严格保留给内部应用程序和插件使用（你会很乐意破解它，因为没有外部客户端绑定到它）

您真的需要控制插件对您的应用程序逻辑的权限吗？有充分的理由吗？毕竟，插件是由贵公司开发的。也许向插件的开发人员解释不应该做什么的正式文档，或者插件的安全测试套件验证（例如，断言插件不调用“this”方法）也可以完成这项工作。

如果您仍然需要将这些插件视为“不受信任”，请将它们所需的方法添加到您的外部 API（在您的应用程序边界上）并为每次使用创建特定的安全配置文件：“restProfile”、“clientProfile”和“pluginProfile”。每个人都将对您的外部 API 方法拥有特定的权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T10:46:09.730

听起来您需要两个级别的内部 API，一个暴露给插件，一个不暴露。

启用它的最佳方法是使用 OSGi（或 Spring 模块）。它允许您明确声明其他模块（即 REST 模块和插件模块）可以访问哪些包和类。这些将是您的新内部 API 的公开级别，您将使用 Spring Security 进一步有选择地限制访问。内部包和类将包含执行所有低级操作（如删除实体）的方法，您将无法直接调用它们。一些公开的 API 只会通过安全检查复制内部 API，但这没关系。

最好的方法的问题是 Spring Modules 在我看来仍然有点太不成熟，甚至无法放入一个新的 webapp 项目中。我绝不会想把它硬塞进一个旧项目中。

您可能可以使用 Spring Security 和 AspectJ 实现类似的目标，但令我震惊的是，性能开销会令人望而却步。

如果您可以重新构建系统，那么一种非常酷的解决方案是让需要安全提升的任务脱机，或者让它们异步。使用 Quartz 和/或 Apache Camel（或适当的 ESB），您可以使“删除我的帐户”方法创建一个离线任务，该任务可以在将来作为具有管理员权限的原子工作单元执行。这意味着您可以在与实际发生删除的完全独立的线程中对请求删除帐户的用户进行干净的安全检查。这将具有使网络线程更具响应性的优势，尽管您仍然希望立即执行某些操作以保持所请求的操作已完成的错觉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T14:41:45.147

If you're using Spring, you may as well utilize it fully. Spring offers [AOP](http://en.wikipedia.org/wiki/Aspect-oriented_programming) that allows you to use interceptors and perform these cross-system checks, and in the event of an unauthorized action, prevent the action.

You can read more about this in Spring's online documentation [here](http://static.springframework.org/spring/docs/2.5.x/reference/aop.html).

Hope this helps...

Yuval =8-)

# c - 为什么我必须在 Objective-C 中只写 *myPointerVar？

> ID：581657
> 
> 赞同：3
> 
> 时间：2009-02-24T13:03:21.077
> 
> 标签：c, objective-c, pointers

这是一个我仍然不明白的问题。

有时我必须写：

```
NSString* myVariable;
myVariable = @"Hey!"; 
```

然后，例如，我定义一个结构“DemoStruct”并获得一个使用它的变量。假设我有一个结构，其中包含来自 double 类型的 x 和 y 变量。

我想将此 var 传递给一个方法，然后该方法操作我的 var，并且我希望此操作对我将 var 传递给该方法的上下文产生影响。所以我需要一个指针，对。

我将它传递给这样的方法：

```
[someObject someMethod:&myVarThatUsesTheStruct] 
```

该方法现在看起来像这样：

```
- (void)someMethod:(DemoStruct*)myVar {
(*myVar).x += 10;
} 
```

在调用之前，结构的组件 x 可以说是 1000。现在，添加了 10，在方法调用之后是 1010。

但是我真的很难不明白为什么我必须在方法中为 myVar 使用星号 *，因为我已经在方法头中说 myVar 是指向 DemoStruct 的指针。我只是用 &myVarThatUsesTheStruct 传递内存地址。

有人可以解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T13:09:11.280

正如你所说，`myVar`是一个指针。因此，myVar.x 是不正确的：它将通过指针的字段，这在 C/Objective-C 中没有意义。

如果要访问指针所指向的变量，必须加星号：`myVar`是指针，`*myVar`是指针所指向的变量`myVar`。

此外，在您的情况下，您可以通过编写 来使用 C 的特殊构造`myVar->x`，它严格等同于`(*myVar).x`.

所有这些都是标准 C，而不是特定于 Objective-C。

关于您的第一个示例，您不必添加星号，因为您更改的是指针的值，而不是变量的值：`myVariable`是指向在声明时分配`nil`值的对象的指针。下一条指令 ( `myVariable = @"Hey!"`) 是指针值的赋值：`@"Hey!"`是指向`NSString`对象的指针。这个指针的值（不是指向常量的值）被分配给`myVariable`，然后指向对象`@"Hey!"`。

是的，这第一次很难理解...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T13:22:38.380

* 是取消引用运算符。*myVar 的全部意思是“把指针 myVar 指向的东西给我”。您需要这种区别，因为您需要告诉计算机您要更改 myVar 指向的东西，而不是 myVar 本身。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-11T10:31:46.797

通过 iPhone 开发者门户的学习目标 c 链接获取：

> Objective-C 支持包含对象的变量的强类型和弱类型。强类型变量在变量类型声明中包含类名。弱类型变量使用对象的类型 ID。弱类型变量经常用于诸如集合类之类的事物，其中集合中对象的确切类型可能是未知的。如果您习惯于使用强类型语言，您可能会认为使用弱类型变量会导致问题，但它们实际上提供了极大的灵活性，并为 Objective-C 程序提供了更大的活力。
> 
> 以下示例显示了强类型和弱类型的变量声明：
> 
> 我的类 *myObject1; // 强类型
> 
> id myObject2; // Weak typing
> 
> Notice the * in the first declaration. In Objective-C, object references are pointers. If this doesn’t make complete sense to you, don’t worry—you don’t have to be an expert with pointers to be able to start programming with Objective-C. You just have to remember to put the * in front of the variable names for strongly-typed object declarations. The id type implies a pointer.

# scala - Scala：使用子列表的谓词拆分列表

> ID：581665
> 
> 赞同：2
> 
> 时间：2009-02-24T13:05:59.010
> 
> 标签：scala, functional-programming

我刚刚有一个用例，我需要将一个列表拆分为 n 个子列表，以便从原始列表中按顺序获取元素并分组，而子列表的谓词为真（当它为假时，启动一个新的子列表） . 我在标准库中没有找到这个功能，我认为尝试以功能样式解决它是一个很好的练习（因为我离功能大师还很远）。

下面是我想出的代码。但我怀疑它可以改进很多。你能帮我找到更好的编码方法吗？

```
class ListWithSplitter[A](val theList:List[A])
{
  private def sublistWhile(list:List[A], pred:(List[A] => Boolean)):(List[A],List[A]) =
  {
    def combine(okList:List[A], remaining:List[A], pred:(List[A] => Boolean)):(List[A],List[A]) =
    {
      if(pred(okList ::: remaining.head :: Nil))
        combine(okList ::: remaining.head :: Nil, remaining.tail, pred)
      else
        (okList, remaining)
    }

    list match {
      case Nil => (Nil, Nil)
      case x :: Nil => (list, Nil)
      case x :: xs => combine(List(x), xs, pred)
    }
  }

  private def combinedSplit(list:List[A], pred:(List[A] => Boolean)):List[List[A]] =
  {
    val r = sublistWhile(list, pred)
    r match {
      case (Nil, Nil) => List(Nil)
      case (x, Nil) => List(x)
      case (x, y) => x :: combinedSplit(y, pred)
    }
  }

  def combinedSplit(pred:(List[A] => Boolean)):List[List[A]] =
  {
    combinedSplit(theList, pred)
  }
}

trait ListCombinedSplit
{
  implicit def list2combSplitter[A](x:List[A]) : ListWithSplitter[A] = new ListWithSplitter(x)
}

object ListSplitter extends ListCombinedSplit {

  def main(args:Array[String])
  {
    // sample usage: sum of each sublist is less than 100
    val a = List(4, 59, 10, 24, 42, 9, 2, 44, 44, 44, 44)
    val b = a combinedSplit { list:List[Int] => ((0 /: list)(_ + _)) < 100 }

    b foreach println
  }
} 
```

样品的结果是：

```
List(4, 59, 10, 24)
List(42, 9, 2, 44)
List(44, 44)
List(44) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T09:37:13.583

以下情况如何：

```
def toggledPartition[A](xs: List[A])(p: A => Boolean): List[List[A]] =
  if (xs.isEmpty) Nil
  else xs span p match { case (a,b) => a :: toggledPartition(b)(x => !p(x)) } 
```

[http://ideone.com/HBrOv](http://ideone.com/HBrOv)上的可运​​行示例

顺便说一句，我觉得我在 scalaz 中看到了类似的功能，但不记得在哪里。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-01T21:42:04.407

您的代码存在一个问题，即仅调用谓词就使其成为 O(N^2)。另外，我认为面向对象的东西太复杂了。

我想出了：

```
scala> def lsplit(x : List[Int], limit : Int) =
  (x foldLeft (0, Nil.asInstanceOf[List[List[Int]]])) ((x, y) => x match {
    case (v, l::xs) if v+y < limit => (v+y, (y::l)::xs)
    case (_, xs) => (y, (y::Nil)::xs)
  })._2.reverse.map(x => x.reverse)

lsplit: (List[Int],Int)List[List[Int]]

scala> lsplit(List.range(1,50), 100)
res9: List[List[Int]] = List(List(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13), List(14, 15, 16, 17, 18, 19), List(20, 21, 22, 23), List(24, 25, 26), List(27, 28, 29), List(30, 31, 32), List(33, 34), List(35, 36), List(37, 38), List(39, 40), List(41, 42), List(43, 44), List(45, 46), List(47, 48), List(49))

scala> lsplit(List.range(1,50), 122)
res10: List[List[Int]] = List(List(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15), List(16, 17, 18, 19, 20, 21), List(22, 23, 24, 25, 26), List(27, 28, 29, 30), List(31, 32, 33), List(34, 35, 36), List(37, 38, 39), List(40, 41), List(42, 43), List(44, 45), List(46, 47), List(48, 49)) 
```

这不允许您指定任意谓词，但您可以通过使用 foldLeft 中对的第一个元素更改操作，使其适用于类似折叠的谓词。

# sharepoint - SharePoint Webpart 反序列化错误

> ID：581670
> 
> 赞同：3
> 
> 时间：2009-02-24T13:09:32.310
> 
> 标签：sharepoint, web-parts, serialization

我收到一个随机的 Web 部件错误，它会在一次刷新后运行，然后在下一次刷新时运行：

> **Web 部件错误**：Web 部件的属性之一的格式不正确。Windows SharePoint 服务无法反序列化 Web 部件。检查属性的格式，然后重试。

Web 部件在网站上已经存在很长时间了，我已经检查了 Micorsoft 支持，[http://support.microsoft.com/kb/826786](http://support.microsoft.com/kb/826786)。这不是一个权限错误，因为它已经这样很久了。关于 web 部件的唯一更改是进入站点设置 > Web 部件 > 新建并选择了一些不在列表中的 web 部件，我想我还检查了那些出现此随机错误的 web 部件并单击了“Populae Gallery”。有没有人有线索？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T15:49:40.637

这也可能是因为托管 SharePoint 的服务器上的磁盘空间不足。[http://www.sharepointblogs.com/vipul/archive/2006/09/25/webpart-error-due-to-space-crunch.aspx](http://www.sharepointblogs.com/vipul/archive/2006/09/25/webpart-error-due-to-space-crunch.aspx)检查可用磁盘空间。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-19T12:39:46.290

您是否尝试过重新启动服务器。我刚刚从这个确切的问题中恢复过来。我的一个前端服务器昨天用完了磁盘空间，我恢复了 10Gb，但这并没有纠正我在尝试查看或添加页面查看器 webpart 时收到的错误，直到我重新启动它。现在一切都很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-18T10:31:44.087

但尝试这样做：

去中央行政

> 运营服务帐户 Web 应用程序池（单选按钮） Web 服务（下拉）；选择 windows sharepoint services web app 应用程序池（第二个下拉菜单）；选择出现问题的站点，例如 home_port_80 用户名（文本字段）：输入您在 sharepoint 安装后配置时使用的帐户信息 密码：最后输入密码。

希望能帮助到你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T15:30:00.240

可能导致此问题的另一件事是 SPD 中的“未记录的功能”，它将 Web 部件属性分成两行，如下所示：

```
<FrameType>
None</FrameType> 
```

刚刚删除了换行符，如下所示：

```
<FrameType>None</FrameType> 
```

一切又开始工作了......

# sql-server - 通过 Microsoft.Reporting.WebForms ReportViewer 取消报表运行

> ID：581671
> 
> 赞同：0
> 
> 时间：2009-02-24T13:10:41.637
> 
> 标签：sql-server, reporting-services

是否可以通过编程方式取消已使用 Web 表单 ReportViewer 控件启动的长时间运行的报表？方法文件`.Reset()`说

> 调用 Reset 方法以**取消任何当前呈现**并将 ReportViewer 控件重置为其默认状态。

但是，如果我（例如）在 Web 表单上放置一个按钮来调用，则`reportViewer1.Reset()`在`postback`报告完成之前，该行实际上不会被点击。查看`trace.axd`，我可以看到在报告完成之间和`postback`之间挂起。`BeginLoadState``EndLoadState`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T12:47:26.190

您需要异步调用报表才能在呈现时取消它。

希望这可以帮助，

账单

# c# - 如何以编程方式制作鼠标滚动？

> ID：581673
> 
> 赞同：0
> 
> 时间：2009-02-24T13:10:55.303
> 
> 标签：c#, user-interface, automation

**相关问题：** [鼠标拖放](https://stackoverflow.com/questions/581491/mouse-drag-drop)（相同的代码片段）

* * *

如何以编程方式使鼠标滚动？我试过了：

```
SetCursorPos(32, 32);
 mouse_event((uint)MouseEventFlags.RIGHTDOWN,0,0,0,0);
 mouse_event((uint)MouseEventFlags.RIGHTUP,0,0 ,0,0); 
 SetCursorPos(38, 38);
 mouse_event((uint)MouseEventFlags.LEFTDOWN,0,0 ,0,0);          
 mouse_event((uint)MouseEventFlags.LEFTUP,0,0 ,0,0); 
```

上面的代码片段在屏幕中打开了最左上角的项目。

有没有人有可以让鼠标滚动的代码片段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T13:31:33.257

您是要滚动到特定位置还是一般滚动？

如果您尝试滚动到特定位置，例如文本框的末尾，您可以执行代码代码之类的操作：

```
myTxtBox.SelectionStart = myTxtBox.TextLength;
myTxtBox.ScrollToCaret(); 
```

# sql - 难以组合 JET SQL 查询

> ID：581675
> 
> 赞同：1
> 
> 时间：2009-02-24T13:12:01.773
> 
> 标签：sql, ms-access, jet

警告：这里是初学者 SQL！要温柔...

我有两个查询可以以合理的及时方式从相关表中独立地给我我想要的东西，但是当我尝试将两者组合成一个（丑陋的）联合时，事情很快就会落空，查询要么给我重复的记录，运行时间过长，或者根本拒绝运行，并引用我的各种语法错误。

注意：我必须创建一个“虚拟”表 (tblAllDates)，其中包含一个包含 2008 年 1 月 1 日的日期的字段，因为我需要查询从每天返回一条记录，并且两个表中都有几天没有数据。这是我能想到的唯一方法，毫无疑问有更聪明的方法......

以下是查询：

```
选择 tblAllDates.date，SUM（tblvolumedata.STT）
FROM tblvolumedata RIGHT JOIN tblAllDates ON tblvolumedata.date=tblAllDates.date
按 tblAllDates.date 分组；

SELECT tblAllDates.date, SUM(NZ(tblTimesheetData.batching)+NZ(tblTimesheetData.categorisation)+NZ(tblTimesheetData.CDT)+NZ(tblTimesheetData.CSI)+NZ(tblTimesheetData.destruction)+NZ(tblTimesheetData.extraction)+NZ (tblTimesheetData.indexing)+NZ(tblTimesheetData.mail)+NZ(tblTimesheetData.newlodgement)+NZ(tblTimesheetData.recordedDeliveries)+NZ(tblTimesheetData.retrieval)+NZ(tblTimesheetData.scanning)) AS VA
FROM tblTimesheetData RIGHT JOIN tblAllDates ON tblTimesheetData.date=tblAllDates.date
按 tblAllDates.date 分组；
```

我管理的最佳结果如下：

```
SELECT tblAllDates.date, 0 AS STT, SUM(NZ(tblTimesheetData.batching)+NZ(tblTimesheetData.categorisation)+NZ(tblTimesheetData.CDT)+NZ(tblTimesheetData.CSI)+NZ(tblTimesheetData.destruction)+NZ(tblTimesheetData.提取)+NZ(tblTimesheetData.indexing)+NZ(tblTimesheetData.mail)+NZ(tblTimesheetData.newlodgement)+NZ(tblTimesheetData.recordedDeliveries)+NZ(tblTimesheetData.retrieval)+NZ(tblTimesheetData.scanning)) AS VA
FROM tblTimesheetData RIGHT JOIN tblAllDates ON tblTimesheetData.date=tblAllDates.date
按 tblAllDates.date 分组
UNION SELECT tblAllDates.date, SUM(tblvolumedata.STT) AS STT, 0 AS VA
FROM tblvolumedata RIGHT JOIN tblAllDates ON tblvolumedata.date=tblAllDates.date
按 tblAllDates.date 分组；

```

这为我提供了我想要的 VA 和 STT 数据，但在两条记录中，我在一天内同时拥有来自两者的数据，如下所示：

```
日期 STT VA
2008 年 7 月 28 日 0 54020
2008 年 7 月 28 日 33812 0
2008 年 7 月 29 日 0 53890
2008 年 7 月 29 日 33289 0
2008 年 7 月 30 日 0 51780
30/07/2008 30456 0
2008 年 7 月 31 日 0 52790
2008 年 7 月 31 日 31305 0
```

我追求的是每天单行的 STT 和 VA 数据。这是如何实现的，我离一个可以被认为是最优的查询还有多远？（别笑，我只求学！）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T13:21:59.783

您可以像这样将所有这些放入一个查询中

```
SELECT 
dates.date, 
SUM(volume.STT) AS STT,
SUM(NZ(timesheet.batching)+NZ(timesheet.categorisation)+NZ(timesheet.CDT)+NZ(timesheet.CSI)+NZ(timesheet.destruction)+NZ(timesheet.extraction)+NZ(timesheet.indexing)+NZ(timesheet.mail)+NZ(timesheet.newlodgement)+NZ(timesheet.recordedDeliveries)+NZ(timesheet.retrieval)+NZ(timesheet.scanning)) AS VA
FROM 
tblAllDates dates 
LEFT JOIN tblvolumedata volume
ON dates.date = volume.date
LEFT JOIN tblTimesheetData timesheet
ON 
dates.date timesheet.date
GROUP BY dates.date; 
```

我将日期表放在`FROM`子句中，然后再`LEFT JOIN`编辑另外两个表。

jet 数据库在查询中有多个连接时可能会很有趣，因此您可能需要将其中一个连接括在括号中（我相信这被称为比尔的 SQL！） - 我建议`LEFT JOIN`在查询生成器中使用表然后查看 SQL 代码视图并对其进行修改以添加到`SUM`s、`GROUP BY`等中。

**编辑：**

确保每个表中的日期字段都已编入索引，因为您要在此字段上连接每个表。

**编辑2：**

这个怎么样 -

```
SELECT date, 
Sum(STT), 
Sum(VA)
FROM 
(SELECT dates.date, 0 AS STT, SUM(NZ(tblTimesheetData.batching)+NZ(tblTimesheetData.categorisation)+NZ(tblTimesheetData.CDT)+NZ(tblTimesheetData.CSI)+NZ(tblTimesheetData.destruction)+NZ(tblTimesheetData.extraction)+NZ(tblTimesheetData.indexing)+NZ(tblTimesheetData.mail)+NZ(tblTimesheetData.newlodgement)+NZ(tblTimesheetData.recordedDeliveries)+NZ(tblTimesheetData.retrieval)+NZ(tblTimesheetData.scanning)) AS VA
FROM tblTimesheetData RIGHT JOIN dates ON tblTimesheetData.date=dates.date
GROUP BY dates.date
UNION SELECT dates.date, SUM(tblvolumedata.STT) AS STT, 0  AS VA
FROM tblvolumedata RIGHT JOIN dates ON tblvolumedata.date=dates.date
GROUP BY dates.date
)
GROUP BY date; 
```

有趣的是，当我针对一些测试数据运行第一个语句时，与第二个语句相比，STT 和 VA 的数字都乘以 4。非常奇怪的行为，当然不是我所期望的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T13:17:08.470

日期表是最好的方法。

在 FROM 子句中组合连接。像这样的东西......

```
SELECT d.date,
  a.value,
  b.value
FROM tableOfDates d
  RIGHT JOIN firstTable a
    ON d.date = a.date
  RIGHT JOIN secondTable b
    ON d.date = b.date 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T13:17:23.447

将 SQL 转换为视图并在日期上加入它们。

# java - 如何获取 SortedSet 的最后 25 个元素？

> ID：581677
> 
> 赞同：11
> 
> 时间：2009-02-24T13:13:54.983
> 
> 标签：java, sortedset

在 Java 中，我有一个 SortedSet，它可能有 100,000 个元素。我想高效优雅地获取最后 25 个元素。我有点疑惑。

为了获得*前*25 个元素，我将迭代并在 25 个元素之后停止。但我不知道如何以相反的顺序迭代。有任何想法吗？

```
SortedSet<Integer> summaries = getSortedSet();
// what goes here :-( 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-24T13:19:48.777

你需要一个`NavigableSet`. 否则，您将不得不低效地进行操作，遍历整个`SortedSet`元素并将元素收集到一个`Queue`您一直修剪为 25 个元素的元素中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T13:27:24.793

SortedSet`<T>`的设计假设一个非常简单的迭代模型，仅向前，因此找到前 n 个条目很容易，但找到最后一个将需要通过迭代器进行昂贵的读取，以维护最后 n 个条目的窗口。

[在 1.6 中添加的NavigableSet`<T>`](http://java.sun.com/javase/6/docs/api/java/util/NavigableSet.html)解决了这个问题（并且 1.4 TreeSet 中唯一的 SortedSet 实现实现了它，因此它很可能成为您的替代品）。

```
NavigableSet<T> set = new TreeSet<T>();
// add elements
set.descendingIterator() // iterate over the last n entires as needed 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T18:25:36.030

反转您的排序并获取前 25 个项目。然后，您可以将那些将是有效的，因为它只有 25 个项目。

布鲁斯

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T13:22:18.957

不同的数据结构将更适合此操作。

*这不是一种优雅的方式或非常有效的方式*，但假设 SortedSet 是按升序排列的，您可以获得 Last() 项并将其删除，将其存储在另一个列表中，然后重复 25 次。然后，您将不得不再次将这些元素放回去！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T16:48:37.650

将 Set 放入 List 并使用 subList()。我不确定创建列表的性能如何，因此您必须运行一些测试。不过，它肯定会使编码变得容易。

```
 List f = new ArrayList( summaries);
    List lastTwentyFive = f.subList( summaries.size() - 25, summaries.size() ); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-27T13:40:27.600

[https://github.com/geniot/indexed-tree-map](https://github.com/geniot/indexed-tree-map)

您可能想看看[IndexedTreeMap](https://github.com/geniot/indexed-tree-map/blob/master/src/src/main/java/com/dictiography/collections/IndexedTreeMap.java) in [indexed-tree-map](https://github.com/geniot/indexed-tree-map)

使用exact(size-25) 无需迭代即可到达索引处的元素。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T14:40:04.120

我假设这在您的项目中不太可能有任何实际用途，但值得注意的是，您可能只是能够将列表按相反方向排序:)

# iphone - 免费桥接和内存管理

> ID：581678
> 
> 赞同：1
> 
> 时间：2009-02-24T13:14:34.060
> 
> 标签：iphone, objective-c, cocoa-touch, memory-management

我的 iPhone 应用程序需要对表单参数进行一些 URL 转义序列编码。NSString stringByAddingPercentEscapesUsingEncoding as stringByAddingPercentEscapesUsingEncoding 并没有逃脱很多。这就是我所拥有的

```
-(NSString*)currentMessageUrlEncoded{
  CFStringRef originalURLString = (CFStringRef) self.currentMessage;
  CFStringRef urlString = CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault, originalURLString, NULL, (CFStringRef) @"&+", kCFStringEncodingUTF8);  
  NSString *result =  (NSString*) urlString;
  [result autorelease]; // Is this sufficient?
  return result;
} 
```

我不确定这里的内存管理？结果上的自动释放是否足够，还是我完全找错了树？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T14:30:26.873

[是的](http://developer.apple.com/documentation/Cocoa/Conceptual/CarbonCocoaDoc/Articles/InterchangeableDataTypes.html)。你甚至可以稍微缩短你的方法：

```
- (NSString *)urlEncodedMessage:(NSString *)message {
    CFStringRef urlString = CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault, (CFStringRef) message, NULL, (CFStringRef) @"&+", kCFStringEncodingUTF8);  
    return [(NSString *)urlString autorelease];
} 
```

# javascript - 为什么在使用之前在 Javascript 中声明一个变量不是必须的？

> ID：581679
> 
> 赞同：7
> 
> 时间：2009-02-24T13:15:45.790
> 
> 标签：javascript, variables

在 Javascript 中，我们不必`var`在使用之前用关键字声明变量。我们可以立即执行`myCount = 12;`or `myStr = "Hello";`（其中 myCount、myStr 之前未声明）之类的操作。任何此类用法都在“全局”范围内声明和初始化变量。

提供此功能的原因可能是什么？这是一个很好的标准吗？

**更新：**我的问题不是“使用变量而不声明”和“声明然后使用”之间的区别以及它如何影响范围。

我的问题是“为什么允许在 javascript 中直接使用变量而不声明它”，因为大多数编程语言对此都有严格的检查。

**更新**：我认为以下引用的文本是此功能的不良影响。那么，为什么有这个功能呢？

“假设已经有一个我不知道的全局声明变量`x`（ ），并且我打算在我的一个函数中创建自己的全局'x'，初始化一个（ ）并且我最终破坏了其他功能。`var x="comparison string"``x=-1`

那么，有什么好的理由吗？因为有这个功能？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-24T14:05:13.207

Javascript 旨在用于浏览器中非常简单的脚本。要求变量声明似乎没有必要。

当然，这是语言上的错误。javascript 的制造商知道这一点。他们想改变它。但他们做不到。为什么？

因为微软已经对 JavaScript 进行了逆向工程，并创建了他们的重复 JScript，其中包含错误等等。微软否决了任何更改，甚至是错误修复，因为他们坚持不破坏任何人的脚本。因此，即使他们更改了 JavaScript，IE 中的 JScript 也会保持不变。

这不是一个很好的理由。但这是我们拥有的。

资料来源：我从 Douglas Crockford 那里得到了我的 javascript 历史课程：“JavaScript 编程语言”， http: [//video.yahoo.com/watch/111593/1710507](http://video.yahoo.com/watch/111593/1710507)这部分故事发生在视频的 9 到 11 分钟之间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T13:21:38.083

好的理由？老实说想不出一个，这是我真正不喜欢 JS 的少数几件事之一。

这是可能的，因为如果没有其他控制，一切都发生在全局范围内，并且 JS 允许像这样创建隐式变量。这样做的代价是界定错误和污染的巨大潜力，并且只有考虑到“this”的存在是为了明确定义自身范围并且“window”和“document”存在用于全局引用，才能节省一些字符——这不是理由一点也不。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T13:44:42.460

> 我的问题是“为什么允许在 javascript 中直接使用变量而不声明它”，因为大多数编程语言对此都有严格的检查。

这就是静态类型语言和动态类型语言之间的区别。Javascript是动态类型的，所以不需要先声明。正如在其他答案中指出的那样，`var`关键字对变量的范围比对它的声明更负责。

而且我认为*大多数编程语言*都不会对此进行检查。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T13:53:33.170

[Lua](http://lua.org)也有类似的问题：任何未声明的变量默认都是全局的。在邮件列表中，这是一个反复出现的主题，询问为什么不应该是“默认本地”。不幸的是，这会在语言中引入非常令人讨厌的歧义，因此结论通常是“默认情况下全局是不好的，默认情况下是本地的更糟”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T13:52:24.657

因为它是一种脚本语言。事实孩子。这就是它的设计方式！

# c++-cli - 如何在 C++-CLI 中创建全局句柄

> ID：581682
> 
> 赞同：0
> 
> 时间：2009-02-24T13:16:09.173
> 
> 标签：c++-cli

我正在尝试在 C++-CLI 项目中使用 C# 类，但 Visual Studio 只允许我在函数内部声明本地范围内的 C# 对象的句柄 (^)。我让它工作的唯一方法是声明一个指向句柄的全局指针：

```
SUTAdapter::Form1^ *ptForm1; 
```

但是，如果我在函数内部创建一个对象并将其地址提供给全局指针：

```
SUTAdapter::Form1^ form1;
form1 = gcnew SUTAdapter::Form1();
ptForm1 = &form1;
(*ptForm1)->incCounter(0); 
```

当函数退出并且我尝试在其他一些 C++-CLI 函数中使用 incCounter 函数时，该对象似乎消失了（调试器说 this == null）。有没有办法在 C++-CLI 中拥有 C# 代码的全局句柄？我猜出于某种我不明白的原因禁止全局句柄，但我没有想法，我需要这样做。谢谢你。

编辑：

```
*ptForm1 = gcnew SUTAdapter::Form1(); 
```

给出空引用异常。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T14:25:14.063

这种限制似乎与其他基于 CLR 的语言一致。例如，C# 没有静态的、函数范围的变量的概念。C++/CLI 中缺少此类功能表明这就是 CLR 的工作方式 - 静态对象必须在类范围内定义。

CLR 是基于对象的，所以这只是面向对象的特性影响在其上运行的语言设计的一个例子。

从面向对象的角度来看，无论如何我更喜欢 C# 方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T13:52:30.867

Visual Studio 是否允许您在本地范围内声明 C# 对象的*静态句柄？*

```
SUTAdapter::Form1^ theForm() {
   static SUTAdapter::Form1^ form1 = gcnew SUTAdapter::Form1();
   return form1;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T14:03:07.610

好的，谢谢您的回答，但我终于解决了，我发现它在谷歌上搜索：

[http://bytes.com/groups/net-vc/473036-how-define-global-com-object-vc-8-a](http://bytes.com/groups/net-vc/473036-how-define-global-com-object-vc-8-a)

似乎 VS 不允许在函数中使用全局句柄或静态句柄。我对此感到困惑，因为有时需要全局访问托管对象。

解决方案是声明一个带有静态句柄的“GlobalObjects”类：

```
ref class GlobalObjects
{
public:
static SUTAdapter::Form1^ hndForm1;
}; 
```

这样我就可以全局访问 C# 表单/类。上一个错误的错误代码是C3145，我还在想为什么VS不允许声明全局句柄。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T14:08:57.957

```
*ptForm1 = gcnew SUTAdapter::Form1(); 
```

给出一个空引用异常，因为您正在取消引用一个空指针 - 在这方面它就像指向任何其他类型的指针。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T13:32:06.297

我认为 - 并且没有测试它 - 你遇到的问题是因为你正在存储一个指向本地句柄的指针，这可能会使垃圾收集器有点困惑，因为你正在获取一个指向自动对象。

您是否尝试将上述作业替换为

```
 *ptForm1 = gcnew SUTAdapter::Form1(); 
```

而不是通过本地对象引用绕道而行？

# database - 您如何确定数据库表关系是否值得强制执行参照完整性？

> ID：581684
> 
> 赞同：2
> 
> 时间：2009-02-24T13:16:54.460
> 
> 标签：database, cascade, referential-integrity

我有一个应用程序，其中大多数数据库表与另一个表有很强的关系。目前我正在使用外键强制执行参照完整性，但我想知道这是否真的是最好的方法。业务用户可以从管理界面删除主表中的数据，这意味着必须执行级联删除（或编写多个删除语句），但我不确定我是否真的要删除所有其他数据同时。可能有很多数据*可能*在以后有用（可能报告？）。但是，除非与主表存在关系，否则从表中的数据对应用程序本身来说基本上是无用的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-24T13:22:25.883

如果可以选择，我总是保留数据。而且由于您已经有了外键，因此您有一些内置的保护措施可以防止完整性违规。

如果您的用户想要“删除”一条记录，从而将其从应用程序中隐藏，请考虑“虚拟删除”策略——将记录标记为非活动，而不是从数据库中物理删除它。

至于实现，根据您的数据库，为您的表添加任何等同于布尔/位逻辑的内容。默认情况下，所有行都分配为 true/1；“删除”被标记为 false/0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T13:21:40.660

您可以使用外键和关系来强制引用完整性，而不必使用级联删除。我很少使用级联删除，因为我一直发现**拥有数据并管理/归档它通常比删除它更好**。

只需编写您自己的删除逻辑来支持您自己的业务规则。

**逻辑删除也很有效**，我广泛使用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T13:27:34.513

您不想删除某些数据——您最终可能会得到流氓数据，因为您一开始就不知道它属于哪里。要么全有，要么全无。

软删除，即在每一行上都有一个位字段来确定记录是否被“删除”是要走的路。这样，您只需检查 API 中的记录是否已删除 == true，然后将其隐藏在应用程序中。

您保留数据，但没有人可以通过应用程序检索它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T13:24:06.613

我会说作为一项规则使用外键约束 - 这可以长期“保护”您的数据库设计，以及数据完整性本身。约束也用于明确说明设计师的决定。

我已经看到在非常大的数据库上放弃了约束——如果你比较性能并且存在显着的外键开销，那将是不使用它们的一个原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T13:24:14.850

我会使用*逻辑/软删除*。这基本上意味着在有问题的表中再添加一列（可能是位列`Deleted`），这会将特定行标记为已删除。

也就是说，“已删除”的数据就是：已删除。因此，它不能在逻辑上用于报告和类似的东西。为了克服这个问题，我还引入了`Hidden`column 来隐藏某些保留其逻辑含义的行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T13:39:11.787

永远不要进行物理删除。您可以添加一个 BOOL 标志 IsDeleted 来指示记录已被删除。当您想“删除”一条记录时，只需将标志设置为 True。

# objective-c - 星号 * 在 Objective-C 中是什么意思？

> ID：581689
> 
> 赞同：27
> 
> 时间：2009-02-24T13:19:27.137
> 
> 标签：objective-c, pointers

是真的吗，星号总是意味着“嘿，那是一个指针！” 指针总是保存一个内存地址？

（是的，我知道 * 用于数学运算的例外情况）

例如：

```
NSString* myString; 
```

或者

```
SomeClass* thatClass; 
```

或者

```
(*somePointerToAStruct).myStructComponent = 5; 
```

我觉得我需要了解的关于 Asterirsk (*) 的知识比我在定义作为类指针的变量时使用的要多。

因为有时我在参数的声明中已经说过 Parameter 变量是一个指针，但我仍然必须在 Variable 前面使用星号才能访问该值。这最近发生在我想以 [myObj myMethod:&myStruct] 之类的方式将结构的指针传递给方法之后，即使我的方法声明已经说有一个参数，我也无法从该结构访问组件值（ DemoStruct*)myVar 确实应该被称为指向该 demostruct 的指针，但我仍然不得不说：“伙计，编译器。听着！它 IIISSS 是一个指针：”并写：(*myVar).myStructComponentX = 5;

我真的真的真的不明白为什么我要说两次。并且仅在这种情况下。

当我在 NSString* myString 的上下文中使用 Asterisk 时，我可以随心所欲地访问 myString，而无需每次都告诉编译器它是一个指针。即喜欢使用 *myString = @"yep"。

这对我来说毫无意义。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-24T13:31:27.577

* 实际上是一个取消引用指针的运算符。唯一一次表示“嘿，我是指针”是在变量声明期间。

```
Foo* foo  // declare foo, a pointer to a Foo object
&foo      // the memory address of foo
*foo      // de-reference the pointer - gives the Foo object (value) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T13:44:34.987

mmattax 很好地涵盖了声明（作为指针）和取消引用之间的区别。

但是，关于您的观点：

```
 (*myVar).myStructComponentX = 5; 
```

要访问 C 结构实例的成员（就像这样），您可以执行您所做的操作，或者更常见的是使用以下`->`符号：

```
 myVar->myStructComponentX = 5; 
```

Objective-C 在这里有点令人困惑，因为它最近（在 ObjC 2.0 中）引入了*属性语法*，这是一个捷径：

```
 int val = [myObject someIntProperty]; 
```

现在可以写成：

```
 int val = myObject.someIntProperty; 
```

这是用于访问您已声明的属性（不是实际的成员变量）的 Objective C (2.0) 语法，而您的示例是访问 C 结构的成员。

确保你清楚区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T13:29:17.660

正如我在[回答您上一个问题](https://stackoverflow.com/questions/581657/why-do-i-have-to-write-mypointervar-only-sometimes-in-objective-c/581669#581669)时所说，`@"yep"`已经是一个指针，所以不需要`*`before `myString`which 也是一个指针。在这种情况下，您分配的是指针而不是值。

# macos - 使用 FLEX 3 的最低 Flash 播放器版本是多少

> ID：581690
> 
> 赞同：1
> 
> 时间：2009-02-24T13:19:37.573
> 
> 标签：macos, actionscript-3, flex3

我的页面目前已设置 - 我可以在此处配置的最小修订版是多少：

```
// Major version of Flash required
var requiredMajorVersion = 9;
// Minor version of Flash required
var requiredMinorVersion = 0;
// Minor version of Flash required
var requiredRevision = 124; 
```

例如，我的 MacOSX ibook 机器根本不启动此页面，它只是说“您正在尝试在不受支持的操作系统上安装 flash palyer”

所以我真的很喜欢尽可能降低版本要求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T13:28:51.000

看到[这个](http://www.adobe.com/products/flex/systemreqs/)。最好有 9.0.124.0。这意味着您将需要升级您的 Macbook Flash 播放器。

# c# - 在后面的代码中修改现有 cookie 时未将对象引用设置为实例

> ID：581698
> 
> 赞同：1
> 
> 时间：2009-02-24T13:21:53.030
> 
> 标签：c#, asp.net

在“Response.Cookies ...”行中，我得到一个未设置为对象实例的对象引用。有没有办法解决这个问题并在我的 ASPX 代码中使用计时器？

```
protected void Page_Load(object sender, EventArgs e)
{

    object o = new object();

    TimerCallback timercallback = new TimerCallback(StartCallback);

    System.Threading.Timer timer = new Timer(timercallback, o, 0, 50000);

    if (are.WaitOne())
    {
        Response.Redirect("Default.aspx");
    }
}

public void StartCallback(object o)
{
    //Request.Cookies["haspassed?"].Value = "";

    Response.Cookies["haspassed?"].Expires = System.DateTime.Now.AddMonths(-1);

    are.Set();
} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T13:31:19.217

iirc StartCallback 将在其中运行的新线程不会有 HTTPContext，因此空指针是 Response 不存在。为什么不将上下文传递为“o”？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T14:37:36.497

So I cast o to a HttpContext object? I'll give that a go.

I'm using a C# timer out of preference of server side coding than JS, really.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T14:54:33.790

这是一个奇怪的问题；`Response`（根据反射器）是：

```
[Browsable(false), DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public HttpResponse Response
{
    get
    {
        if (this._response == null)
        {
            throw new HttpException(SR.GetString("Response_not_available"));
        }
        return this._response;
    }
} 
```

所以它不能返回 null - 你会得到一个`HttpException`。

同样，`Cookies`是：

```
public HttpCookieCollection Cookies
{
    get
    {
        if (this._cookies == null)
        {
            this._cookies = new HttpCookieCollection(this, false);
        }
        return this._cookies;
    }
} 
```

所以你也不会在那里得到 null 。

' 索引器`Cookies`？没有：

```
public HttpCookie Get(string name)
{
    HttpCookie cookie = (HttpCookie) base.BaseGet(name);
    if ((cookie == null) && (this._response != null))
    {
        cookie = new HttpCookie(name);
        this.AddCookie(cookie, true);
        this._response.OnCookieAdd(cookie);
    }
    return cookie;
} 
```

所以我想，我们唯一剩下的就是在`Cookies`索引器内部，如果`this._response == null`，cookie 设置将不会发生，这将返回`null`。但这也不会发生，因为`_cookies`仅在我们之前看到的那一行中，它调用了一个构造函数，该构造函数是唯一`_response`设置-设置为正确的地方`HttpRespones`，从不`null`。

总之，我已经深入挖掘了那里，看不出`Response.Cookies["haspassed?"].Expires`二传手有任何方法可以抛出`NullReferenceException`.

# asp.net - 如何使用 multipart/form-data 进行 ASP.NET MVC Ajax 表单发布？

> ID：581703
> 
> 赞同：26
> 
> 时间：2009-02-24T13:22:41.077
> 
> 标签：asp.net, html, asp.net-mvc

我正在开发一个 ASP.NET MVC 网站，该网站有一个表单，允许使用表单标签上的 multipart/form data enctype 选项上传文件，如下所示

```
<form enctype="multipart/form-data" method="post" action='<%= Url.Action("Post","Entries",new {id=ViewData.Model.MemberDetermination.DeterminationMemberID})  %>'> 
```

我将如何编写这个来代替 ASP.NET MVC Ajax 表单发布？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-11-23T01:18:32.323

这是可能的，但还有很长的路要走。第 1 步：编写表格

前任：

```
@using (Ajax.BeginForm(YourMethod, YourController, new { id= Model.Id }, new AjaxOptions {//needed options }, new { enctype = "multipart/form-data" }))
{
    <input type="file" id="image" name="image" />
    <input type="submit" value="Modify" />
} 
```

第二步：拦截请求并发送给服务器

```
<script type="text/javascript">
    $(function() {
        $("#form0").submit(function(event) {
            var dataString;
            event.preventDefault();
            var action = $("#form0").attr("action");
            if ($("#form0").attr("enctype") == "multipart/form-data") {
                //this only works in some browsers.
                //purpose? to submit files over ajax. because screw iframes.
                //also, we need to call .get(0) on the jQuery element to turn it into a regular DOM element so that FormData can use it.
                dataString = new FormData($("#form0").get(0));
                contentType = false;
                processData = false;
            } else {
                // regular form, do your own thing if you need it
            }
            $.ajax({
                type: "POST",
                url: action,
                data: dataString,
                dataType: "json", //change to your own, else read my note above on enabling the JsonValueProviderFactory in MVC
                contentType: contentType,
                processData: processData,
                success: function(data) {
                    //BTW, data is one of the worst names you can make for a variable
                    //handleSuccessFunctionHERE(data);
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    //do your own thing
                    alert("fail");
                }
            });
        }); //end .submit()
    });
</script> 
```

第 3 步：因为您进行了 ajax 调用，所以您可能想要替换一些图像或类似的东西`multipart/form-data`

前任：

```
handleSuccessFunctionHERE(data)
{
    $.ajax({
        type: "GET",
        url: "/Profile/GetImageModified",
        data: {},
        dataType: "text",
        success: function (MSG) {
            $("#imageUploaded").attr("src", "data:image/gif;base64,"+msg);
        },
        error: function (msg) {
            alert(msg);
        }
    });
} 
```

MSG 变量是一个 base64 加密字符串。在我的情况下，它是图像的来源。

通过这种方式，我设法更改了个人资料图片，然后立即更新了图片。还要确保添加*Application_Start (global.asax)* `ValueProviderFactories.Factories.Add(new JsonValueProviderFactory());` 很好，不是吗？

PS：此解决方案有效，因此请随时询问更多详细信息。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2014-12-18T11:15:09.403

我遇到了这个小技巧，它很好地解决了它

```
window.addEventListener("submit", function (e) {
    var form = e.target;
    if (form.getAttribute("enctype") === "multipart/form-data") {
        if (form.dataset.ajax) {
            e.preventDefault();
            e.stopImmediatePropagation();
            var xhr = new XMLHttpRequest();
            xhr.open(form.method, form.action);
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    if (form.dataset.ajaxUpdate) {
                        var updateTarget = document.querySelector(form.dataset.ajaxUpdate);
                        if (updateTarget) {
                            updateTarget.innerHTML = xhr.responseText;
                        } 
                    }
                }
            };
            xhr.send(new FormData(form));
        }
    }
}, true); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-24T13:40:05.497

1.  您可以使用一些额外的上传器（例如[jQuery 多文件上传器](http://www.fyneworks.com/jquery/multiple-file-upload/)）（我更喜欢这种方式，我更喜欢不使用 MS Ajax）
2.  采用：

    ```
    AjaxHelper.BeginForm("Post", "Entries", new {id=ViewData.Model.MemberDetermination.DeterminationMemberID}, new AjaxOptions(){/*some options*/}, new {enctype="multipart/form-data"}) 
    ```

但在第二种情况下，我不确定它是否会起作用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-24T13:34:06.493

[jquery forms 插件](http://malsup.com/jquery/form/)支持这种方式的[文件上传](http://malsup.com/jquery/form/file/)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-12-03T18:16:02.823

我使用的代码并且有效！这是@James 'Fluffy' Burton 解决方案的副本。我只是即兴创作了他的答案，以便 MVC 新手能够快速了解​​后果。

以下是我的看法：

```
@using (Ajax.BeginForm("FileUploader", null, new AjaxOptions { HttpMethod = "POST", UpdateTargetId = "AjaxUpdatePanel" }, new { enctype = "multipart/form-data", id = "frmUploader" })){
<div id="AjaxUpdatePanel">     
    <div class="form-group">
        <input type="file" id="dataFile" name="upload" />
    </div>

    <div class="form-group">
        <input type="submit" value="Upload" class="btn btn-default" id="btnUpload"/>
    </div>

</div>}

<script>
window.addEventListener("submit", function (e) {
    var form = e.target;
    if (form.getAttribute("enctype") === "multipart/form-data") {
        if (form.dataset.ajax) {
            e.preventDefault();
            e.stopImmediatePropagation();
            var xhr = new XMLHttpRequest();
            xhr.open(form.method, form.action);
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    if (form.dataset.ajaxUpdate) {
                        var updateTarget = document.querySelector(form.dataset.ajaxUpdate);
                        if (updateTarget) {
                            updateTarget.innerHTML = xhr.responseText;
                        }
                    }
                }
            };
            xhr.send(new FormData(form));
        }
    }
}, true); 
```

以下是我的控制器：

```
[HttpPost]
    public JsonResult FileUploader(HttpPostedFileBase upload)
    {
        if (ModelState.IsValid)
        {
            if (upload != null && upload.ContentLength > 0)
            {

                if (upload.FileName.EndsWith(".csv"))
                {
                    Stream stream = upload.InputStream;
                    DataTable csvTable = new DataTable();
                    using (CsvReader csvReader = new CsvReader(new StreamReader(stream), true))
                    {
                        csvTable.Load(csvReader);
                    }
                }
                else
                {
                    return Json(new { dataerror = true, errormsg = "This file format is not supported" });
                }
            }
            else
            {
                return Json(new { dataerror = true, errormsg = "Please Upload Your file" });
            }
        }
        return Json(new { result = true });
    } 
```

以下是上述代码的快速注释：通过 Ajax，我已将我的 excel (*.csv) 文件发布到服务器，并使用 Nuget 包 (LumenWorksCsvReader) 将其读取到 DataTable。

欢呼！有用。谢谢@詹姆斯

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-24T13:39:52.317

其实我自己回答了这个问题...

```
<% using (Ajax.BeginForm("Post", "Entries", new { id = ViewData.Model.MemberDetermination.DeterminationMemberID }, new AjaxOptions { UpdateTargetId = "dc_goal_placeholder" }, new { enctype = "multipart/form-data" })) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-01-16T13:26:15.973

***对于那些`@Ajax.BeginForm`在 MVC 中使用多部分编码/文件上传仍然有问题的人***

# 诊断和建议的解决方案

在助手生成的表单元素上运行“检查元素”工具会`@Ajax.BeginForm`发现助手莫名其妙地覆盖了指定的控制器参数。如果您为部分回发实现了单独的控制器，就会出现这种情况。

该问题的快速解决方法是将您的 html 操作属性值明确指定为`/<yourcontrollername>/<youractionname>`.

## 例子

```
@using (Ajax.BeginForm("", "", new AjaxOptions() { HttpMethod = "POST", UpdateTargetId = "<TargetElementId>", InsertionMode = InsertionMode.Replace }, new { enctype = "multipart/form-data", action = "/<Controller>/<Action>" })) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-04-19T12:47:58.973

如果您需要使用`OnSuccess`AjaxOption 和/或`Request.IsAjaxRequest()`在控制器中使用来检查请求类型，即

```
@using (Ajax.BeginForm("FileUploader", null, new AjaxOptions { HttpMethod = "POST", UpdateTargetId = "elementToUpdate", OnSuccess = "mySuccessFuntion(returnedData)", OnFailure = "myFailureFuntion(returnedData)"}, new { enctype = "multipart/form-data" })) 
```

然后您可以使用以下代码（我修改了@James 'Fluffy' Burton 的答案）。如果可以的话，这也会将响应文本转换为 JSON 对象（如果需要，可以省略它）。

```
<script>
if(typeof window.FormData === 'undefined') {
    alert("This browser doesn't support HTML5 file uploads!");
}
window.addEventListener("submit", function (e) {
    var form = e.target;
    if (form.getAttribute("enctype") === "multipart/form-data") {
        if (form.dataset.ajax) {
            e.preventDefault();
            e.stopImmediatePropagation();
            var xhr = new XMLHttpRequest();
            xhr.open(form.method, form.action);
            xhr.setRequestHeader("x-Requested-With", "XMLHttpRequest"); // this allows 'Request.IsAjaxRequest()' to work in the controller code
            xhr.onreadystatechange = function () {
                if (xhr.readyState === XMLHttpRequest.DONE && xhr.status === 200) {
                    var returnedData; //this variable needs to be named the same as the parameter in the function call specified for the AjaxOptions.OnSuccess
                    try {
                        returnedData = JSON.parse(xhr.responseText); //I also want my returned data to be parsed if it is a JSON object
                    }catch(e){
                        returnedData = xhr.responseText;
                    }
                    if (form.dataset.ajaxSuccess) {
                        eval(form.dataset.ajaxSuccess); //converts function text to real function and executes (not very safe though)
                    }
                    else if (form.dataset.ajaxFailure) {
                        eval(form.dataset.ajaxFailure);
                    }
                    if (form.dataset.ajaxUpdate) {
                        var updateTarget = document.querySelector(form.dataset.ajaxUpdate);
                        if (updateTarget) {
                            updateTarget.innerHTML = data;
                        }
                    }
                }
            };
            xhr.send(new FormData(form));
        }
    }
}, true);
</script> 
```

注意我使用javascript函数`eval()`将字符串转换为函数......如果有人有更好的解决方案，请发表评论。我也使用 JQuery `JSON.parse()`，所以这不是一个普通的 javascript 解决方案，但是脚本不需要它来运行，所以它可以被删除。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-03-31T22:24:02.803

我将 Brad Larson 的回答与 Amirhossein Mehrvarzi 混合在一起，因为 Brad 的回答没有提供任何处理响应的方法，而 Amirhossein 导致了 2 次回发。我刚刚添加 ($('#formBacklink').valid()) 在发送之前调用模型验证。

```
window.addEventListener("submit", function (e) {
        if ($('#formBacklink').valid()) {
            var form = e.target;
            if (form.getAttribute("enctype") === "multipart/form-data") {
                if (form.dataset.ajax) {
                    e.preventDefault();
                    e.stopImmediatePropagation();

                    var dataString;
                    event.preventDefault();
                    var action = $("#formBacklink").attr("action");
                    if ($("#formBacklink").attr("enctype") == "multipart/form-data") {
                        //this only works in some browsers.
                        //purpose? to submit files over ajax. because screw iframes.
                        //also, we need to call .get(0) on the jQuery element to turn it into a regular DOM element so that FormData can use it.
                        dataString = new FormData($("#formBacklink").get(0));
                        contentType = false;
                        processData = false;
                    } else {
                        // regular form, do your own thing if you need it
                    }
                    $.ajax({
                        type: "POST",
                        url: action,
                        data: dataString,
                        dataType: "json", //change to your own, else read my note above on enabling the JsonValueProviderFactory in MVC
                        contentType: contentType,
                        processData: processData,
                        success: function (data) {
                            //BTW, data is one of the worst names you can make for a variable
                            //handleSuccessFunctionHERE(data);   
                        },
                        error: function (jqXHR, textStatus, errorThrown) {
                            //do your own thing       
                        }
                    });
                }
            }
        }
    }, true); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-16T09:51:07.827

Ajax.BegineForm() 适用于多部分表单数据，这是相同的工作代码示例：

**看法：**

```
@using(Ajax.BeginForm("UploadFile","MyPOC",
        new AjaxOptions { 
            HttpMethod = "POST"
        }, 
        new 
        {
            enctype = "multipart/form-data"
        }))
    {
        <input type="file" name="files" id="fileUploaderControl" />
        <input type="submit" value="Upload" id="btnFileUpload" />
    } 
```

**控制器动作方法：**

```
public void UploadFile(IEnumerable<HttpPostedFileBase> files)
    {
        HttpPostedFileBase file = files.FirstOrDefault(); //Attach a debugger here and check whether you are getting your file on server side or null.
        if (file != null && file.ContentLength > 0)
        {
            //Do other validations before saving the file

            //Save File
            file.SaveAs(path);
        }
    } 
```

PS 确保文件上传器控件的“名称”属性和传递给 Action 方法 UploadFile() 的参数名称必须相同（即本例中的“文件”）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-06-29T14:12:56.127

根据我的小调查。根据 Ajax.BeginForm 遇到的问题，上述所有答案似乎都是正确的。但是，我刚刚观察到在某些情况下问题出在 ~/Scripts/jquery.unobtrusive-ajax.min.js javascript 库上。因此，在我的情况下，我只是将它从视图模型中删除，并决定使用 JQuery Form 插件来满足我的需求以及 HTML 表单。这已在上面提出。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-03-08T07:45:54.943

您可以使用此代码而不是 eval

```
 var body = "function(a){ " + form.dataset.ajaxSuccess + "(a) }";
  var wrap = s => "{ return " + body + " };"
  var func = new Function(wrap(body));
  func.call(null).call(null, returnedData); 
```

# .net - .NET 中方法名称能否以 Get 开头

> ID：581714
> 
> 赞同：3
> 
> 时间：2009-02-24T13:26:48.243
> 
> 标签：.net, naming-conventions, coding-style

我最近在我们公司遇到了一份关于我们维护的代码的审计报告，其中说我们不应该在方法（而不是属性）命名中使用 Get，就像在 GetSearchResults 或 GetXyzInformation 中一样。我查阅了[MS 指南](http://msdn.microsoft.com/en-us/library/4df752aw(VS.71).aspx)（[http://msdn.microsoft.com/en-us/library/4df752aw(VS.71).aspx](http://msdn.microsoft.com/en-us/library/4df752aw(VS.71).aspx)）以获取方法命名，并且根据允许 Get ，您对此有何看法，从标准的角度来看，我们能不能拥有它，如果不能，为什么？

附加信息
我在第一组答案之后添加了更多信息，我所指的方法是涉及数据库交互的方法，因此显然属性不是理想的选择。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-24T13:28:44.183

是的，他们当然可以——标准 API 中有很多示例（例如[Delegate.GetInvocationList](http://msdn.microsoft.com/en-us/library/system.delegate.getinvocationlist.aspx)）。

但是，通常值得考虑的是在创建 GetFoo 方法时是否*真的需要一个属性。*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-24T13:30:47.313

你**可以**做到，是的，但它通常强烈表明你真的应该创建一个属性（特别是如果你的方法没有参数）。

从[框架设计指南](http://www.amazon.co.uk/gp/product/0321545613?ie=UTF8&tag=ianesbl-21&linkCode=as2&camp=1634&creative=19450&creativeASIN=0321545613)：

> **没有**与“获取方法”名称匹配的属性，如下例所示：

```
public string TextWriter { get {...} set {...}}
public string GetTextWriter(int value) {...} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-24T13:33:44.483

这是完全合法的（如果您要使用 getter 声明属性 Foo，则编写“get_Foo”形式的方法甚至会与编译器合成的 get 方法冲突甚至是合法的）。

至于**好不好**：

1.  如果该方法确实有效、有副作用或可能引发异常，它是否可能不是一个好的属性候选者，并且名称是描述性的，因此不应不必要地更改
2.  如果该方法没有认真工作，则将其作为属性可能是一件好事，因为它会使调用代码更容易使用。
3.  如果该方法实际上没有“获取”任何东西，则名称不好，应该更改

以上几点是*主观*的，但是像“从不”“总是”这样的硬规则可能是一个坏主意的原因是多个主观和竞争因素的平衡是成为一名优秀开发人员的全部内容的一部分。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-24T13:36:30.000

如果您的 Get-method**接受 parameters**，那么相应地命名它是绝对可以的。

如果它不接受参数，将其重命名为`SearchResults { get; }`

它比使用 VB.NET 中的参数属性要好得多：

```
ReadOnly Property Foo(ByVal i As Integer, ByVal j As Integer) As String
  Get
    Return ""
  End Get
End Property 
```

事实上，在 IL 中它是方法`GetFoo(int, int)`，但 VB.NET 是很棒的语言！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-24T13:38:53.130

是的，`GetXyz`如果该方法有一些副作用、执行速度慢或需要参数（在所有情况下您绝对不应该使用`Xyz`属性），我确实会使用。

就个人而言，我混合和匹配`GetXyz`，并且`FindXyz`在返回`null`可能不是正确的事情的情况下做*get*。例如，如果*get*没有找到它正在寻找的东西，它可以分配一个新对象，而*find*会返回`null`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T13:31:30.090

绝对可以在方法名称中使用 Get。我个人用它来区分：

*不称为获取：*

```
public string GetSomeString()
{
     return _someMemberVariable;
} 
```

**编辑：**似乎我在这里不清楚，我的意思是表明名称中带有 Get 的属性如果不进行处理会产生误导。

**方法名称中的Get**一词意味着需要付出努力。

```
public string GetSomeString()
{
     //Some code that does processing or includes logic.
} 
```

我相信这在 Clean Code 中被提到是一种好的做法（以明确它不是简单地返回一个值）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-24T14:58:00.863

我使用了与上述一些示例相似的技术——我的标准是，如果属性/方法正在公开已经保存在类中的数据，请使用属性。如果我们触发某种操作来获取请求的值，例如从数据库或其他尚未存储在类中的源，请使用 Get。

过于简单化了，属性是名词，方法是动词。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T13:34:07.023

在我看来，使用 Get 作为方法名称的开头是很自然的。

# .net - 绑定到数据网格中的命令

> ID：581715
> 
> 赞同：18
> 
> 时间：2009-02-24T13:27:11.177
> 
> 标签：.net, wpf, data-binding, mvvm

我在 WPF 应用程序中使用 MV-VM 模式。我将 ViewModel 绑定到 ContentControl 并使用窗口资源中定义的数据模板来呈现该 ViewModel 的视图（UserControl）。

在 ViewModel 中，我有一个项目集合。我将该集合绑定到 WPF 工具包中提供的数据网格。同样在视图模型中，我定义了一个 RemoveItem 命令，该命令接受要删除的项目 ID 的参数。

我将如何绑定到数据网格中的该命令？网格的数据上下文就是那个集合，所以类似于：

```
<Button Command="{Binding Path=RemoveCommand}" CommandParameter="{Binding Path=id}">X</Button> 
```

不起作用 - 它找不到命令。我想我需要进行 RelativeSource 绑定，但那会是什么样子？祖先类型是 UserControl 还是 ContentControl？我的 ViewModel 作为 DataContext 驻留在哪里？

还是我离这儿很远？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-24T13:44:29.590

是的，你只需要升一级。我会`ElementName`先尝试绑定，`RelativeSource`只有在必要时才使用。例如，我更喜欢这个：

```
<DataGrid x:Name="_grid">
    ...
        <Button Command="{Binding DataContext.RemoveItem, ElementName=_grid}"/>
    ...
</DataGrid> 
```

也就是说，当涉及到元素名称和控件范围时，XAML 编译器可能会陷入困境，因此您可能需要求助于`RelativeSource`：

```
<DataGrid x:Name="_grid">
    ...
  <Button Command="{Binding DataContext.RemoveItem, 
                    RelativeSource={RelativeSource FindAncestor, 
                                    AncestorType={x:Type DataGrid}}
                   }"/>
    ...
</DataGrid> 
```

您只需要搜索直到数据上下文成为您的视图模型。如果你愿意，你可以搜索`UserControl`- 不确定它是否真的很重要。两者都是非常脆弱的绑定，这就是我更喜欢这种`ElementName`方法的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-09T08:41:13.487

我喜欢在名为 ViewModel 的控件的数据上下文中定义视图模型。使用 ElementName 更容易编写绑定

```
...
<UserControl.DataContext>
    <local:UserControlViewModel x:Name="ViewModel"/>
</UserControl.DataContext>
...

...
<DataGridTemplateColumn  Width="30">
    <DataGridTemplateColumn.CellTemplate>
         <DataTemplate>
             <Button Command="{Binding RemoveCommand, ElementName=ViewModel}" 
                     CommandParameter="{Binding}">Remove</Button>
         </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
</DataGridTemplateColumn>
... 
```

请注意，在这种情况下，命令参数是行的整个数据对象。有时比

```
CommandParameter="{Binding Id}" 
```

因为您不必再​​次查找数据。

# database - 实体关系

> ID：581719
> 
> 赞同：0
> 
> 时间：2009-02-24T13:28:23.263
> 
> 标签：database

我对这个设计有疑问（[er_lp](http://www.xtupload.com/new/share-E656_49A3F378.html)）。我的疑问是如何与具有复合键的实体创建多对多关系，其次，使用日期类型作为 pk。在这里，每台机器每天为一个或多个领域的不同用户部门工作三班倒。因此，为了记录机器的工作和停机时间，我使用了 shift、taskDay 和 machinePlate 作为 pks。正如您从 ER 图中看到的那样，我最终在很多地方的链接表中出现了太多的 pk。我犹豫不要在编码阶段遇到麻烦

有一个更好的方法吗？

谢谢 ！！

德杰内

* * *

另请参阅作为第二个问题[实体关系](https://stackoverflow.com/questions/581933/entity-relationship)发布的额外信息。重新格式化的材料是：

> 阐述：是的，“田地”是指土地面积。我们在不同的地点有几个甘蔗种植地。它[每个字段？] 被命名并有预算。
> 
> 用户不是指在机器上工作的个人。他们是部门。我使用“isDone”表将 userDept 与机器链接起来。一台机器可以供多个部门使用，许多机器可以为一个用户部门工作。
> 
> 一台特定的机器可用于给定班次的多项任务。它可以工作 2 个小时，并且可以在另一个领域开始另一个任务。我们每天三班，每班8小时！
> 
> 如果我使用自动增量 PK，您认为其他键重要吗？我不喜欢使用它！
> 
> 通常，我在表中单独使用自动增量键。我们如何创建涉及自动增量键的关系？
> 
> 谢谢你用心的评论！！

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T13:35:19.707

您总是使用第三个表在两个表之间创建多对多关系，第三个表的行包含每个表的主键列，所有列的组合是第三个表的主键。对于具有复合主键的表，该规则不会更改。

```
 CREATE TABLE Table1(Col11 ..., Col12 ..., Col1N ...,
                     PRIMARY KEY(Col11, Col12));
 CREATE TABLE Table2(Col21 ..., Col22 ..., Col2N ...,
                     PRIMARY KEY(Col21, Col22));

 CREATE TABLE RelationTable
 (
    Col11 ...,
    Col12 ...,
    FOREIGN KEY (Col11, Col12) REFERENCES Table1,
    Col21 ...,
    Col22 ...,
    FOREIGN KEY (Col21, Col22) REFERENCES Table2,
    PRIMARY KEY (Col11, Col12, Col21, Col22)
 ); 
```

这工作正常。它确实建议您尽可能保持键简单，但如果引用表具有方便使用的自然复合键，则绝对没有必要向后弯腰将自动增量列添加到引用表中。OTOH，如果您使用复合键，则涉及关系表的连接更难编写 - 如果任一复合键涉及多于两列，我会多次思考我的意思，尤其是因为它可能表明存在问题参考表的设计。

查看实际的 ER 图 - 问题中的 'er_lp' URL - 'tbl' 前缀似乎有点不必要；在数据库中存储数据的东西总是表，所以告诉我前缀是......不必要的。名为“机器”的表似乎命名错误；它与其说是描述一台机器，不如说是在特定班次分配给一台机器的职责。我猜“字段”表指的是土地区域，而不是数据库的一部分。您有一个“IsDone”表（同样，不是特别好命名），它标识了在机器上工作以完成特定轮班并因此完成特定任务的用户。这涉及到 Machine 表（具有 3 部分主键）和 User 表之间的链接。它为N' t 明确特定机器是否可用于给定班次的多项任务。目前尚不清楚轮班编号是否在一天中循环，或者每个轮班编号是否在几天内是唯一的，但假设必须假设每天有三个班次，并且需要轮班编号和日期来确定某事何时发生发生了。据推测，Shift 表将识别时间和其他此类信息。

Machine 上的三部分主键很好 - 但最好有两个唯一标识符。一个是当前的主键组合；另一个将是一个自动分配的数字——自动递增、序列、序列或其他......

* * *

解决扩展信息。

我不再清楚您要跟踪的内容。如果“机器”表应该跟踪给定机器的用途，那么您可能需要对数据进行更多的结构化。鉴于一台机器可以在一个班次期间用于不同领域的不同任务，您也许应该考虑一个 MachineTasks 表，该表将识别操作开始和完成的（日期和）时间以及操作类型. 对于维修操作，您将信息存储在描述维修的表中；对于现场的常规操作，您可能不需要太多额外信息。或者这可能是矫枉过正。

我不清楚是否代表多个部门执行特定任务，或者您是否只是想指出，在一个轮班期间，一台机器可能由多个部门使用，但每个任务一次一个部门使用。如果每个任务都针对一个单独的部门，则只需将部门信息作为外键字段包含在 MachineTasks 主表中。

如果您决定使用自增键，您仍然需要保持复合键的唯一性。这是我看到人们使用自动增量字段犯的最大错误。它并不像“具有自动增量键的表还必须具有第二个唯一约束”那么简单，但它并不算太离谱。

当您使用自增键时，您需要检索在向表中插入记录时分配的值；然后，当您将其他记录插入其他表时，您可以在外键列中使用该值。

您需要阅读数据库设计 - 我不确定当前的好书是什么，因为我在十多年前学习的大部分时间都是如此，因此我的书不太可能仍然可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T13:33:39.040

避免主键出现问题的一种好方法是为主键设置一个字段。通常一个数字（自动增量）列就可以了。您仍然可以拥有具有多列的唯一键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T13:55:20.920

*   tblWorksOn
*   tbl机器
*   完成

...似乎是问题表。

看起来您可以将**tblMachine**表的 taskDate 用作主键。其余的可以是外键。

随着对 tblMachine 表的更改，您可以将 taskDate 与 fieldNo 用于 tblWorksOn 表，并将 taskDate 与 userID 用于 tblIsDone。使用这两个字段创建复合键 (CK)

例如

**tblMachine** taskDate (PK)

**tblWorksOn** fieldNo (CK) taskDate (CK)

**tblIsDone** 用户 ID (CK) 任务日期 (CK)

# language-agnostic - 什么时候返回这个引用有意义？

> ID：581722
> 
> 赞同：2
> 
> 时间：2009-02-24T13:29:06.630
> 
> 标签：language-agnostic, oop

目前我只能想到三个以（公共）方法**返回** `this`的好理由，即：

1.  ( [mmyers](https://stackoverflow.com/questions/577575/using-the-keyword-this-in-java/577588#577588) ) 实现**流畅的接口**时，例如

    ```
    public class X
    {
      ...
      public X enableValidation()
      {
        setValidation(true);
        return this;
      }
      ...
    } 
    ```

2.  ( [Jon Skeet](https://stackoverflow.com/questions/581722/when-does-it-make-sense-to-return-this-reference/581725#581725) ) 用于**身份转换**，例如

    ```
    public class X
    {
      ...
      public X toX()
      {
        return this;
      }
      ...
    } 
    ```

3.  ( [Dave Ray ) 在](https://stackoverflow.com/questions/581722/when-does-it-make-sense-to-return-this-reference/581797#581797)**不可变对象**上实现**`clone()`or`copy()`**方法，例如

     **```
    @Immutable
    public class X
    {
      ...
      public X copy()
      {
        return this;
      }
      ...
    } 
    ```** 

 **在面向对象语言中是否还有其他有用的场景可以返回`this`或`self`从方法返回？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T13:51:28.840

如果您正在创建链接操作（但是这可能不是非常 OOP'ish - 得墨忒耳法则等）。

示例（并不是说它很有意义）：

```
public class X 
{
   public X Add(int i) 
   { 
      this.Value += i; 
      return this;
   }

   public X Subtract(int i) 
   {
      this.Value -= i;
      return this;
   }

   public int Value 
   {
      get;
      set;
   }
}

new X().Add(4).Subtract(5).Value; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T13:30:11.060

String.toString() :)

更严肃地说，有类似的“转换为 [x]”场景，可以只返回“this”......但我想不出很多其他情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T13:49:40.170

不可变对象上的 clone() 或 copy() 方法的任何实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:39:29.457

Quick addition when it comes to fluent interfaces:

As mentioned in this "A simple example of a fluent interface" article (at the end of the comments), :

> You'll hit a brick when *using inheritance* along with fluent interfaces because:
> 
> *   **using polymorphic methods break your call chains** and
> *   you definitely don't want to make your interfaces non-fluent by using ugly casting and parenthesis where they are not needed or by doing lots of un-useful overrides in the children that do the casting

[alt text http://withasmiletomeltathousandhearts.files.wordpress.com/2009/02/fluent_interfaces_order_class_hierarchy.jpg?w=300&h=255](http://withasmiletomeltathousandhearts.files.wordpress.com/2009/02/fluent_interfaces_order_class_hierarchy.jpg?w=300&h=255)

In this [article about a **more robust pattern for complex (and yet fluent) hierarchy of classes**](http://withasmiletomeltathousandhearts.wordpress.com/2009/02/16/fluent-interfaces-constraints-at-compile-time/) , "`this`" is used to return the instance of the base class "Builder", whereas Builder for concrete classes uses casting.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T14:43:44.470

Take the following implementation.

```
public interface Monitorable {
   public Statistics getStatistics();
}

public interface MonitorManager {
   public Monitorable getMonitorable();
}

class MonitorableService implements Monitorable, MonitorManager {
   public Monitorable getMonitorable() {
      return this;
   }
}

// Meanwhile somwhere else...
MonitorManager manager = getMonitorManagerFromSomewhere();
Monitorable monitorable = manager.getMonitorable(); 
```

I admit this is rather contrived, but the overal pattern/message should be clear.

Here I do not need to know the MonitorManager is implemented by the Application class. Nor do I need to know that Monitorable is implemented by Application.

Here polymorphism is used to encapsulate the implementation details of Application. Which is not a public class. This is a very common pattern, and can be seen in a wide variety of projects.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T13:54:17.943

C++ 一直这样做是为了允许级联运算符。

例如 << 运算符始终返回自身（ostream），以便您可以通过以下方式级联调用：

```
 std::cout << "call 1" << "call2" << std::endl; 

```

我认为这种级联效应流行的唯一语言是 C++。

# xcode - 我的程序是否在到达 main() 之前就崩溃了？

> ID：581727
> 
> 赞同：0
> 
> 时间：2009-02-24T13:30:38.140
> 
> 标签：xcode, gcc

我正在尝试使用 XCode 3.1.2 将包括 SDL 和 WxWidgets 的项目移植到 MacOS X。该项目相当大，但我终于成功编译了它。但是，它在启动后立即退出，并显示消息“MyApplication 已退出，状态为 99”。

出于调试目的，我将 main 函数更改为如下所示：

```
int main(int argc, char *argv[])
{
    cout <<"hello world";
    cout <<"and goodbye";
    throw "test";
} 
```

我还在所有三个主要功能行中添加了断点。但是，调试器仍然没有中断，应用程序在启动后仍然退出。

调试控制台输出如下所示：

> (gdb) run [切换到进程 94140 本地线程 0x3607] 正在运行...</p>
> 
> 调试器停止。找不到 test.xml ！
> 
> 调试器停止。程序以状态值退出：99.(gdb)

我不知道“找不到 test.xml”指的是什么文件，为什么 XCode 首先要查找它，或者它是否与我的问题有关。

这是我的第一个 XCode 项目，所以我不知道如何进行。任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T13:55:23.900

SDL 对您的主要功能使用了一些技巧。您的主要代码很可能永远不会到达。

尝试打破“开始”并从那里开始 - AFAIK“开始”是任何男子气概可执行文件的入口点。

您所看到的看起来像您的二进制退出，错误代码为“99”。您可能希望在 SDL 或 WX 中查找错误代码 99。

稍后编辑：*来自 SDL 站点：头文件“SDL_main.h”使用函数宏将您的 main() 函数重新映射到 SDL_main() 函数。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T13:33:54.263

您可能没有正确的项目设置。您选择了哪个项目模板？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T16:03:15.497

最后，我发现单元测试文件中有一个与我错误包含的第三方库不同的 main() 函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-25T06:30:10.343

而且我希望 test.xml 是该单元测试的数据文件，并且它可能希望它位于默认目录中。Project > Edit Active Executable 并确保启动时的工作目录是代码预期的位置（根目录、项目目录或可执行目录）。

不过，我不得不说，我不建议通过移植您不熟悉的源代码来学习新工具。您将很难从 SDL/WxWidgets 的奇怪期望中分辨出哪些问题是由于学习 Xcode 而引起的。

# sql - MySQL SELECT 语句使用 Regex 识别现有数据

> ID：581729
> 
> 赞同：1
> 
> 时间：2009-02-24T13:30:56.347
> 
> 标签：sql, mysql

我的 Web 应用程序从上传的文件中解析数据并将其插入到数据库表中。由于输入数据（银行交易数据）的性质，从一个上传到另一个上传可能存在重复数据。目前，我正在使用极其低效的代码来检查是否存在重复项，方法是将数据库中日期范围内的所有行加载到内存中，然后遍历它们并将每个行与上传的文件数据进行比较。

不用说，随着数据集大小的增加，这可能会变得非常慢。

所以，我希望用 SQL 查询（针对 MySQL 数据库）替换它，以检查是否存在重复数据，例如

```
SELECT count(*) FROM transactions WHERE desc = ? AND dated_on = ? AND amount = ? 
```

这很好用，但我的真实案例有点复杂。输入数据中的交易描述有时可能包含错误的标点符号（例如“BANK 12323 DESCRIPTION”通常可以表示为“BANK.12323.DESCRIPTION”），因此我们现有的（在内存中）匹配逻辑对该描述进行了一些清理在我们做一个比较之前。

虽然这在内存中有效，但我的问题是这种清理可以在 SQL 语句中完成，以便我可以将此匹配逻辑移动到数据库中，例如：

```
SELECT count(*) FROM transactions WHERE CLEAN_ME(desc) = ? AND dated_on = ? AND amount = ? 
```

其中 CLEAN_ME 是一个删除错误数据字段的过程。

显然，最干净（没有双关语！）的解决方案是将*已经清理*的数据存储在数据库中（在同一列或单独的列中），但在我诉诸于此之前，我想我会尝试找出是否有更聪明的方法来解决这个问题。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T13:41:21.813

最简单的方法是在适当的列上添加唯一索引并使用[ON DUPLICATE KEY UPDATE](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)。我会进一步建议将文件转换为 csv 并将[其加载到临时表中](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)，以充分利用 mysql 的内置函数，这肯定比你自己编写的任何东西都要快 - 如果你认为你必须提取数据到您自己的应用程序中，而 mysql 会完成所有工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T13:45:52.223

> 这种清理可以在 SQL 语句中完成吗

是的，您可以在数据库层编写一个[存储过程来执行此操作：](http://dev.mysql.com/doc/refman/5.0/en/stored-programs-views.html)

```
mysql> CREATE FUNCTION clean_me (s VARCHAR(255))
    -> RETURNS VARCHAR(255) DETERMINISTIC
    -> RETURN REPLACE(s, '.', ' ');

mysql> SELECT clean_me('BANK.12323.DESCRIPTION');

BANK 12323 DESCRIPTION 
```

不过，这将在一张大桌子上表现得非常糟糕。

> 显然，最干净（没有双关语！）的解决方案是将已经清理的数据存储在数据库中（在同一列或单独的列中），但在我诉诸于此之前，我想我会尝试找出是否有更聪明的方法来解决这个问题。

不，就数据库而言，最干净的方法总是最聪明的方法（只要性能不差）。

这样做，并为您正在进行批量比较的列添加索引，以提高性能。如果 desc/dated-on/amount 始终是唯一的数据类型实际上是固有的，那么通过使其成为唯一索引约束在模式中表达它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T13:40:16.917

最干净的方法确实是确保数据库中只有正确的数据。

在此示例中，“BANK.12323.DESCRIPTION”将由以下方式返回：

```
SELECT count(*) FROM transactions
WHERE desc LIKE 'BANK%12323%DESCRIPTION' AND dated_on = ? AND amount = ? 
```

但是，当表中有大量数据时，这可能会带来性能问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:43:51.477

您可以这样做的另一种方法如下：

*   插入前清洁描述。

*   为表创建一个主键，它是唯一标识条目的列的组合。听起来可能是清洁的描述、日期和金额。

*   使用更合适的“替换”或“重复键”语法。当发生现有的唯一密钥冲突时，“替换”实际上将数据库中的现有行替换为更新的行，例如：

    REPLACE INTO 交易 (desc, dated_on, amount) 值 (?,?,?)

    'on duplicate key' 允许您指定在重复键错误时更新哪些列：

    INSERT INTO transaction (desc, dated_on, amount) values (?,?,?) ON DUPLICATE KEY SET amount = amount

通过使用多列主键，您将获得很多性能，因为主键查找通常非常快。

如果您希望保留现有的主键，您还可以在这三列上创建一个唯一的 unix。

无论您选择哪种方式，我都建议您在进入数据库之前清理描述，即使您还存储了原始描述并仅使用清理后的描述进行索引。

# javascript - 是否有免费/开源的 JavaScript 到 JavaScript 压缩编译器（如 Google 的）？

> ID：581730
> 
> 赞同：3
> 
> 时间：2009-02-24T13:31:08.420
> 
> 标签：javascript, optimization, compiler-construction, obfuscation

如果您查看带有 JavaScript 的 Google 页面的源代码，您会发现 JavaScript 显然不可读——或可维护。例如，所有变量和函数都是一个字母命名的（至少，前 26 个是……）；没有多余的空格或换行符；没有评论；等等。

这个编译器的好处很明显：页面加载速度更快，JavaScript 执行速度更快，而且作为奖励，竞争对手将很难理解你的混淆代码。

显然，谷歌正在使用某种 JavaScript 到 JavaScript 的压缩编译器。我想知道他们使用的是内部工具吗？如果没有，*他们在*用什么？是否有任何此类公开可用（理想情况下是免费/开源）工具？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T13:35:17.710

[YUI Compressor](http://developer.yahoo.com/yui/compressor/)是一个 Java 应用程序，可以压缩和混淆你的 Javascript 代码。它是您从命令行运行的 Java 应用程序（并且可能是构建过程的一部分）。

另一个是[PHP Minify](http://code.google.com/p/minify/)，它做类似的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T20:57:27.800

另一种是 ShrinkSafe，它是 Dojo 的一部分，但可以单独使用（在构建脚本、命令行或网站中）： [http ://shrinksafe.dojotoolkit.org/](http://shrinksafe.dojotoolkit.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T13:33:16.793

您*可能*正在寻找[GWT——](http://code.google.com/webtoolkit/)它是 Java-to-JavaScript 而不是 JavaScript-to-JavaScript，但您可能仍然会发现它很有用。

我无法评论我们用于 JavaScript 到 JavaScript 的内部工具（如果有的话）。（老实说，我什至不知道……我必须先查一下，然后再明确地不告诉任何人:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T13:36:05.693

实际上不太可能是 JS->JS，更不可能是 Java->JS。这些天我相信推荐的 JS 压缩器（因为这是他们所谓的）是[YUI 压缩器](http://developer.yahoo.com/yui/compressor/)，但其他像 /packer/ 存在

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T20:59:45.940

Crockford.com 的[JSMin](http://www.crockford.com/javascript/jsmin.html "JSMin")是朝这个方向迈出的一步，假设您只是在寻找最小化而不是混淆。

# ruby-on-rails - 我的乘客驱动的 Rails 应用程序有时需要很长时间才能加载

> ID：581737
> 
> 赞同：6
> 
> 时间：2009-02-24T13:31:40.353
> 
> 标签：ruby-on-rails, apache, passenger

我使用 Apache + Passenger 来托管一些 Rails 应用程序。当长时间没有请求时，某些东西似乎进入了睡眠模式。然后网站加载需要 10-20 秒。当长时间没有请求时，感觉有些东西必须醒来。

我该如何解决？我有足够的内存，所以如果什么东西睡着了就保持清醒应该没问题。;)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-24T13:46:40.647

看一下`PassengerPoolIdleTime`Passenger的参数。它规定了应用程序实例在关闭以节省内存之前可以空闲的最大秒数。

默认值为 300，但您可以尝试设置更高的数字，看看是否有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:51:45.573

此外，如果您在共享主机上并且无法更改该设置，您始终可以编写一个 cron 脚本以每 x 秒访问一次您的站点（其中 x 略小于PassengerPoolIdleTime），并更新您的分析包以忽略来自进行轮询的盒子的 IP 地址的请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-13T11:26:32.253

乘客文档建议在仅运行少数 Rails 应用程序的非共享主机上将 PassengerPoolIdleTime 设置为 0。除非绝对必要，否则这应该可以防止它被卸载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-18T17:47:10.273

@x0ne，您可以在全局服务器配置中设置 PoolIdleTime（nginx 中的 pool_idle_time）。在我安装的 Nginx 中，它是 /opt/nginx/conf/nginx.conf。

这是涵盖 PoolIdleTime 的乘客文档部分：[http ://www.modrails.com/documentation/Users%20guide.html#PassengerPoolIdleTime](http://www.modrails.com/documentation/Users%20guide.html#PassengerPoolIdleTime)

# .net - 使用 BackgroundWorker 或 Threading 以获得高性能

> ID：581743
> 
> 赞同：0
> 
> 时间：2009-02-24T13:33:28.820
> 
> 标签：.net, winforms, multithreading, backgroundworker

如何为我的代码使用 BackgroundWorker 或 Threading。我更新 TreeView (Winforms) 并调用 WCF 服务。

请有任何建议。亲切的问候。

提前致谢

```
AdministradorUILogging.TrazarDebug("PanelArbolFicheros. tslGuardarArbol_Click")
Dim listaFichero As New List(Of Fichero)

Windows.Forms.Cursor.Current = Cursors.WaitCursor

Me.TreeViewGB1.SuspendUpdate()

For Each nodo As NodoArbol In TreeViewGB1.Nodes

ProcesarNodo(nodo, listaFichero)

Next

Me.TreeViewGB1.ResumeUpdate()

' Cambiamos el cursor , tener en cuena si hacerlo asincrono '

Try

Using bfll As New ComunBfll()

bfll.AltaManualListaFicheros(listaFichero)

Mensajes.InformacionGuardada()

End Using

Catch ex As WCF.ServicioBase.Contrato.Excepciones.NoExisteOperacionException

Mensajes.AdvertenciaErrores("No existe la operación")

Catch ex As WCF.ServicioBase.Contrato.Excepciones.NoExisteExpedienteException

Mensajes.AdvertenciaErrores("No existe el expediente")

Catch ex As WCF.ServicioBase.Contrato.Excepciones.ConsistenciaException

Mensajes.AdvertenciaErrores("Inconsistencia detectada al superar el máximo permitido de ficheros para un tipo documental")

Catch ex As Exception

AdministradorUILogging.TrazarError(Me.[GetType]().FullName & " -> " & System.Reflection.MethodBase.GetCurrentMethod().Name & "." & ex.Message)

ExcepcionesIUUtil.ProcesarExcepcionPresentacion(ex, Me.Container)

End Try

InicializarArbol()

Windows.Forms.Cursor.Current = Cursors.Arrow 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T13:44:23.490

使用 BackgroundWorker 或**一个**线程不会使您的应用程序运行得更快，但只会阻止您的应用程序没有响应。

如果您只需要一个线程，只需使用 BackgroundWorker，这就是它的意义所在。

**如果**在这种精确的情况下，您的**listaFichero**变量可以拆分为更小的列表并并行处理，**并且**客户端和服务器之间的带宽不是瓶颈，**并且**您的服务器支持并行处理，**那么**您可以创建多个线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T13:38:11.320

老实说，只要你做得好，这并不重要。

与后台工作人员一起更容易正确完成，所以我建议这样做。

# .net - Windows 安装程序出错...“无法获取安装程序类型”

> ID：581750
> 
> 赞同：7
> 
> 时间：2009-02-24T13:34:24.420
> 
> 标签：.net, visual-studio, deployment, windows-installer

使用 Windows 安装程序在我正在部署的产品中安装事件源时遇到错误。

我收到的错误消息指出以下...

> 无法在 c:\temp\program.exe 程序集中获取安装程序类型。--> 无法加载一种或多种请求的类型。检索 LoaderExceptions 属性以获取更多信息。

这是创建事件源安装程序的代码块...

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Configuration.Install;
using System.Diagnostics;

namespace myapplication
{
    [RunInstaller(true)]
    public partial class EventSourceInstaller : Installer
    {
        public EventSourceInstaller()
        {
            InitializeComponent();

            string eventSourceName = "MyAppSourceName";
            if (!EventLog.SourceExists(eventSourceName))
            {
                EventSourceCreationData data = new EventSourceCreationData(eventSourceName, "Application");
                EventLog.CreateEventSource(data);
                EventLog.WriteEntry(eventSourceName, "Source Added.");
            }
        }
    }
} 
```

在安装程序项目中，我在安装上添加了一个名为“MyApplication 的主要输出（活动）”的自定义操作，以运行事件源安装程序。

我有以下问题

1.  有没有其他人遇到过这个问题？

2.  如何检索安装程序的 LoaderExceptions 属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T19:02:50.730

我从未见过那个错误，但路径 c:\temp\program.exe 很奇怪。您是否尝试从 c:\temp\ 目录运行安装程序？

您确定所有项目的输出和您使用的所有第三方 DLL 都包含在部署项目中吗？单击 Deployment 项目中所有包含的文件并检查其 SourcePath 属性；它们是原始源文件而不是目标输出文件夹吗？不是临时文件夹？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T19:22:13.007

我有完全相同的问题。

我猜你的程序正在引用安装程序安装在 GAC 或应用程序目录之外的其他地方的其他 DLL。您不能指望在安装操作运行之前安装这些 DLL。

解决方案：为您的安装操作创建一个单独的 DLL，并确保 DLL 不引用任何其他未安装在您的应用程序文件夹中的 DLL（直接或间接）。

顺便说一句，如果可以，请切换到其他技术。我不知道哪个竞争对手更好，但是如果你做非标准的东西，VS安装项目只会给你带来麻烦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-20T09:31:33.157

安装项目的“检测到的依赖项”不是最新的。在我的情况下，刷新依赖项不起作用。由于将 dll 添加到安装项目依赖项中，Visual Studio 将它们全部刷新。重建安装项目后，错误不再发生！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-20T19:25:27.733

我的问题是我使用的是 64 位版本的 installutil.exe 而不是 32 位版本。

*   32 位路径 - C:\Windows\Microsoft.NET\Framework\v4.0.30319

*   64 位路径 - C:\Windows\Microsoft.NET\Framework64\v4.0.30319

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-06T23:31:58.320

我有同样的问题。解决方案是将 bin\debug 或 bin\release 文件夹中的所有 dll 等复制到服务的文件夹

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-28T14:05:39.960

尝试安装 Windows 服务时，我遇到了同样的异常。我尝试了上述方法，但只是将服务从我们的开发环境复制到我们的现场，我没有意识到现场服务器中缺少目标版本的 .net。

# php - OS X 上的 GD2 和 PHP

> ID：581764
> 
> 赞同：3
> 
> 时间：2009-02-24T13:39:39.103
> 
> 标签：php, macos, gd

关于这个主题有很多链接 - 但都有不同的方法。我有一个全新安装的 os x 10.5.6。我正在使用操作系统附带的 PHP 版本。

我已经使用 FINK 安装了 GD，它已经安装了相关的软件包。**我的问题是，我现在如何在 PHP 中获得 GD 支持？**

*（首选没有 macports 或 marc liyanage 建议，因为这涉及撤消我已经完成的 pear、mysql 和 php 的其他安装）*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T00:29:51.740

*正如Nerdling*所指出的，PHP 必须在启用 GD 扩展的情况下进行编译，因此无法将 GD2 添加到 Mac OS X 附带的 PHP 版本中。

这个解决方案对我有用（Mac OS X 10.5.2，应该适用于任何 10.5），但你必须重新安装 PHP。但是，**这不会撤消您对 PEAR 和 MySQL 的其他安装**，您只需`sudo`多写一行。

在我们开始之前，如果您已经启用了内置 PHP，则必须重新注释 (/etc/apache2/)httpd.conf 中的 PHP 行 (LoadModule php5_module libexec/apache2/libphp5.so)。现在，步骤：

1.  在 Terminal.app 中，键入`sudo ln -s /etc/apache2 /etc/httpd`
    This 创建一个符号链接，以便 entropy 的包可以正确安装和运行。

2.  下载 entropy 的[PHP 5.2.4 for Apache 2](http://www2.entropy.ch/download/entropy-php-5.2.4-1-apache2.tar.gz)包并安装它。

3.  再次在终端中输入： 这会将 Apache 2 降级为 32 位，因此它可以很好地与 entropy 的 PHP 包配合使用。 这修复了一个放错位置的文件。 这修复了 PEAR/PHP 扩展可能出现的错误。

    `sudo cp /usr/sbin/httpd /usr/sbin/httpd-fat
    sudo lipo /usr/sbin/httpd -thin i386 -output /usr/sbin/httpd`

    `sudo ln -s /usr/local/php5 /usr/local/apache2
    sudo ln -s /usr/lib/libexpat.dylib /usr/local/apache2/lib/libexpat.0.dylib`

    `sudo mv /usr/bin/php /usr/bin/php_back
    sudo ln -s /usr/local/php5/bin/php /usr/bin/php`

4.  重新启动 Apache（可以通过键入来完成`sudo apachectl restart`）。

5.  点赞；）

6.  完毕。

*一些参考：[http ://www.entropy.ch/phpbb2/viewtopic.php?t=3074](http://www.entropy.ch/phpbb2/viewtopic.php?t=3074)*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T19:20:14.743

PHP 必须在启用 GD 扩展的情况下编译。

您可以使用以下 PHP 代码查看使用了哪些扩展和编译标志：

```
<?php phpinfo() ?> 
```

# c++ - 在进程之间共享类实例的方法

> ID：581773
> 
> 赞同：2
> 
> 时间：2009-02-24T13:41:50.830
> 
> 标签：c++, dll, process, share

我编写了一个 C++ 类，我需要在至少两个 Windows 进程之间共享一个实例。有哪些不同的方法可以做到这一点？

最初，我查看了[#pragma data_seg](http://msdn.microsoft.com/en-us/library/h90dkhs0(VS.80).aspx)，但当我意识到它不适用于类或任何在堆上分配的东西时，我才感到失望。

类的实例必须可以通过 dll 访问，因为现有的完整应用程序已经使用此 dll。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T13:46:28.617

您可以潜在地使用[内存映射文件](http://msdn.microsoft.com/en-us/library/aa366551(VS.85).aspx)在进程之间共享数据。如果您需要在对象上调用函数，则必须使用 COM 或类似的东西，或者您必须实现自己的 RPC 协议。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-24T14:29:00.077

查看[Boost::interprocess](http://www.boost.org/doc/libs/1_38_0/doc/html/interprocess.html)。这需要一点时间来适应，但效果很好。我在共享内存中制作了相对复杂的数据结构，这些数据结构在进程之间运行良好。

编辑：它也适用于内存映射文件。关键是您可以以结构化的方式使用数据；您不必将内存块（在文件或共享内存中）视为您必须仔细读/写才能保持有效状态的原始数据。Boost::interprocess 负责该部分，您可以使用 STL 容器，如树、列表等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T14:56:43.130

您可以使用placement new 在共享内存区域中创建对象。只要对象不使用任何指针，就可以了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T13:47:48.333

它是 POD 还是您需要能够跨进程共享单个实例？您是否考虑过使用单例模式（出于线程安全原因的静态初始化版本）？您还需要使用互斥锁来保护并发写入和东西。

在 Windows 上，您也可以使用 COM。

# project-management - 你们中有多少人正在记录他们的历史项目数据——以供未来估计，你们是如何做到的？

> ID：581783
> 
> 赞同：3
> 
> 时间：2009-02-24T13:45:12.897
> 
> 标签：project-management, estimation, time-management

在做一个项目时——我总是估计我的任务并计算我需要多长时间才能完成。所以最后我得到了一个项目应该完成的时间跨度（很少是这样）。

我的问题是 - 您是否在项目期间记录您在估算中使用的数据和假设，并将它们用于以后的项目或对同一项目的改进估算？

如果是这样 - 您如何记录这些数据以及如何存储它们？

我使用了一个 excel 表 - 但不知何故（无法想象这是怎么发生的；））我倾向于忘记填写新的假设或获得的信息。另一方面，它对于在完成项目后评估我的预测并没有真正的可读性或有用性——在下一个项目中从中学习。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T13:54:54.853

听起来像是 Joel 写[FogBugz](http://www.fogcreek.com/FogBUGZ/)的目的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T14:13:08.100

我最近和一位朋友讨论了一个实用的变体，更具体地说，是使用代码签入时的粗略级别证据的可行性。

如果您以合理的连贯方式工作，您的签到可以（至少通过所涉及的文件）与某些工作单元和用于确定平均生产力的经过时间相关联。

这与FogBugz 中包含[的基于证据的调度](http://en.wikipedia.org/wiki/Evidence-based_Scheduling)方法非常吻合。如果您碰巧在其他事情上花费了*不寻常*的时间，那么将来您的工作效率将比签到率所暗示的要高。任何错误都在过度分配时间的安全方面。

对我来说，像这样的方法的主要缺陷是我通常将至少两个项目交织在一起，通常更多，在不同的存储库和语言中。我需要将细节放在一起并粗略分配它们之间的相对时间以实现相同的目标。在一个更专注的团队中，我认为存储库日期戳可能就足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T13:48:10.563

这不就是项目经理的职责吗？;)

# iphone - 我必须学习什么才能完成 iPhone 的 3D 赛车游戏？我需要什么工具？

> ID：581784
> 
> 赞同：4
> 
> 时间：2009-02-24T13:45:46.170
> 
> 标签：iphone, objective-c, core-animation, 3d

我非常了解Java。我现在知道 Objective-C 的大部分基础知识。我对Photoshop一无所知。我知道如何使用 TurboCAD 10 Professional，所以我在 3D 对象建模方面确实有一些经验。虽然不多。

我必须逐步学习什么，才能开始 iPhone 的 3D 游戏开发？我需要什么工具？哪些书籍有帮助？你学了多长时间？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T20:11:29.503

在 iPhone 上学习 OpenGL ES 的基本细节花了我大约 3 周的时间。[我在这里](http://www.sunsetlakesoftware.com/2008/08/05/lessons-molecules-opengl-es)发表我对这个主题的一些看法。我的 Molecules iPhone 应用程序使用 OpenGL ES 的源代码可[在此处](http://www.sunsetlakesoftware.com/2008/10/02/molecules-source-code-now-available)获得。也许您将能够在该示例中找到有用的东西。但是，其中没有任何内容可以处理您的游戏可能需要的纹理。Bill Dudney在 iPhone 上[发布了 Wavefront OBJ 建模器的源代码](http://bill.dudney.net/roller/objc/entry/wave_front_obj_textures_working)，这可能会有所帮助。对于 OpenGL ES 的好文本，我推荐["Mobile 3D Graphics: with OpenGL ES and M3G"](https://rads.stackoverflow.com/amzn/click/com/0123737273)。

一般来说，当涉及到 Cocoa 开发时，您需要一点时间才能跟上进度。对我来说，大约 6 个月后，我才对它感到满意，尽管那是在更复杂的 Mac 桌面环境中。[我在这里](http://www.sunsetlakesoftware.com/2009/02/13/resources-getting-started-cocoa)发布了一些学习 Cocoa 的资源，尽管这绝不是一个详尽的列表。

我同意 diciu 的观点，这对于刚开始使用该平台的人来说有点过分。我会找到一个更简单的应用程序或一系列目标应用程序（您甚至可能永远不会发布）来帮助您在进入 3-D 游戏设计之前学习核心概念。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T14:15:51.340

你的目标非常雄心勃勃——我认为这是一个非常难以解决的项目，因为它是 iPhone 上的第一个项目，你最好从几个简单的 Cocoa 触摸应用程序开始来感受这个平台。

对于模拟游戏，我会先尝试一些物理引擎，例如[bullet](http://en.wikipedia.org/wiki/Bullet_(software))。Bullet 是 C++，你可以在 Objective-C++ 中使用它。

对于渲染 3D，您可能想要使用[OpenGL ES](http://en.wikipedia.org/wiki/OpenGL_ES)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T14:15:29.670

我想[OpenGL](http://developer.apple.com/documentation/GraphicsImaging/Conceptual/OpenGL-MacProgGuide)值得一看。

# asp.net - 在单击共享点 Web 部件按钮控件时发送异步请求

> ID：581787
> 
> 赞同：0
> 
> 时间：2009-02-24T13:46:02.020
> 
> 标签：asp.net, sharepoint

我对整个 sharepoint 和 aspx 编程很陌生。我开发了一个带有按钮控件的共享点 Web 部件。onclick 事件映射到我的 Web 部件代码中的方法。当我单击该按钮时，整个页面重新加载并再次呈现 Web 部件。有没有办法防止重新加载页面？有没有办法在后台调用函数方法？类似于 AJAX 的东西。

谢谢，贾格纳特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T16:09:16.480

Ajax 或 SilverLight 是您在不刷新页面的情况下进行异步操作的仅有的两个选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T09:32:46.590

一旦您了解了让 SharePoint 和 ASP.NET AJAX 协同工作所需的技巧，就不会那么难了。

以下是所需的步骤：

1.  确保在所有前端 Web 服务器上都安装了 ASP.NET AJAX 扩展（如果您使用 .NET 3.5，则不需要这样做，因为扩展包含在框架中）
2.  更新 SharePoint 应用程序的 Web.config 文件以支持 ASP.NET AJAX
3.  确保任何要使用 AJAX 的页面都有 ScriptManager
4.  使用 UpdatePanel 或客户端服务调用来获取更新的数据并重新呈现 Web 部件

这篇博文中有一些资源来自我在 TechEd Barcelona 2008 上就该主题所做的一次演讲。这些资源应该为您提供入门所需的信息。

[http://msmvps.com/blogs/windsor/archive/2008/11/13/teched-emea-resources-and-demos-integrating-asp-net-ajax-with-sharepoint-2007.aspx](http://msmvps.com/blogs/windsor/archive/2008/11/13/teched-emea-resources-and-demos-integrating-asp-net-ajax-with-sharepoint-2007.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T14:31:51.020

You can use Ajax, it just requires some sharepoint configuration. Here are a few posts to get you started:

*   [http://weblogs.asp.net/jan/archive/2007/02/26/using-the-ajax-control-toolkit-in-sharepoint.aspx](http://weblogs.asp.net/jan/archive/2007/02/26/using-the-ajax-control-toolkit-in-sharepoint.aspx)
*   [http://sharepoint.microsoft.com/blogs/mike/Lists/Posts/Post.aspx?ID=3](http://sharepoint.microsoft.com/blogs/mike/Lists/Posts/Post.aspx?ID=3)

# search - 没有搜索框按钮可以吗？

> ID：581794
> 
> 赞同：16
> 
> 时间：2009-02-24T13:49:07.830
> 
> 标签：search, button, usability

我想知道是否可以在网页的搜索框附近没有提交按钮（例如，确定、执行或搜索）。

我知道按回车键要快得多，并且它会执行搜索。

但是，**对于普通的非技术精通用户还是仅适用于技术社区，这是公认的惯例吗？**

例如，stackoverflow 的搜索框没有提交按钮，但我认为没有人在抱怨（我当然不会）。

另一方面，有人建议以谷歌为例：如果按钮被删除，人们会注意到吗？

我刚开始阅读*Steve Krug的***[Don't Make Me Think](https://rads.stackoverflow.com/amzn/click/com/0321344758)**，他提到每个搜索框都应该有一些东西告诉我我可以点击它来启动搜索。

 *你的意见？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-24T13:52:09.633

为什么你应该有一个按钮：

*   不是每个人都知道他们可以按 Enter 键，因此您将一些不太精明的人拒之门外。
*   某些设备（例如手机和游戏机）可能无法在没有按钮的情况下提交。基于 PC 的浏览器仍然占主导地位，但不要认为它是人们访问您网站的唯一方式。

如果（必须满足两个条件），您可能没有按钮：

*   您的听众精通技术（如 SO）
*   您提供了一个视觉提示，即搜索框实际上是一个搜索框
    *   通过在其中添加文本提及它应该用于搜索
    *   通过在框内添加图标

一般来说，我认为按回车键是提交的捷径，而不是主要手段。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-24T13:52:41.130

我认为这取决于您的目标市场。如果您是 StackOverflow，那么认为他们知道如何使用浏览器（使用浏览器上的后退按钮进行导航是一种类似的设计约定）并按 Enter = submit 进行搜索并不难。

但是，如果您的目标市场是不经常使用浏览器/计算机的机械师（无意冒犯机械师），那么看看谷歌是如何做到的（他们的目标范围最广）——他们有一个提交按钮。

您可以看到一个中间立场，它有一个像 StackOverflow 这样的水印，它告诉用户“单击此处，输入搜索值并按 Enter 键进行搜索”——或者类似的东西（希望更短），您实际上是在为用户提供服务的所有级别。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T15:07:57.407

是否需要按钮取决于观众。以下是需要考虑的问题：

*   面向技术的用户可能不需要按钮，并且通常不必考虑按 Enter 来提交搜索请求。
*   相反，非技术人员甚至可能不知道可以按 Enter 键提交搜索请求。因此，再多的思考都不可能对他们有用。
*   可能存在需要按钮的技术限制。如果您希望您的观众从一个不提供提交搜索请求的隐式方式的平台浏览您的表单，那么您可能需要提供一个显式按钮。

因此，本质上您需要了解您的受众并确定边缘案例的位置以及它们的重要性。以 SO 为例，它针对的是技术用户，因此可能不需要显式按钮。然而，对于像谷歌这样的网站，您需要使用每个可能的平台让每个用户都可以访问，一个清晰的明确搜索按钮是必须的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-24T13:56:26.627

“别让我思考”——给我一个按钮。

总会有人第一次使用该应用程序；也不要让他们思考。而且您的屏幕不应该太繁琐以至于无法舒适地安装按钮 - 这表明存在不同的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T13:52:25.717

我认为对于非技术人员来说，需要某种提交按钮。想想那些不经常使用电脑的人。他们经常点击所有需要的按钮而不是按回车，因为他们没有意识到回车做同样的事情。我的意见......如果它不只是针对技术人员，那么它应该尽可能简单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T13:55:56.690

这取决于你的听众。史蒂夫的听众是所有人。其中大部分离 IT 很远，你需要一个望远镜才能看到它们。如果您的听觉是单个用户，您可能会跳过所有线索：按钮（带或不带名称）、收件箱标签。

对于我自己的登录窗口，我留下了两个字段：没有标签、没有按钮、没有 javascript 来告诉你哪个是哪个。但这不是一个公共项目。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T13:58:10.243

不久前，Smashing Magazine 上有一篇关于此的文章。有一些替代品，比如镜子或其他图标，但基本上总是有一个按钮，或者代表它的东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T14:11:14.783

有一个按钮可以更清楚地表明文本字段是一个搜索字段。仅仅让文本字段本身在其内容中表明这一点是不够的。

# c# - 如何从其 Win32 句柄中获取 System.Windows.Form 实例？

> ID：581795
> 
> 赞同：8
> 
> 时间：2009-02-24T13:49:13.493
> 
> 标签：c#, winforms, winapi, interop, ipc

以下代码实现了一个简单的单例，以确保我的应用程序只能运行 1 个实例。但是，如果启动另一个实例，我需要能够获取该实例的命令行参数，将它们传递给初始实例，然后终止第二个实例。

当我试图获取应用程序的第一个实例时，问题就出现了。一旦我找到了该实例的主窗体的句柄，我将它传递给该`Control.FromHandle()`方法，期望得到一个`MainForm`. 相反，返回值始终是`null`. （`Control.FromChildHandle()`给出相同的结果。）

因此，我的问题很简单：我做错了什么？这在 .NET 中是否可行？

```
public class MainForm : Form
{
[DllImport("user32")]
extern static int ShowWindowAsync(IntPtr hWnd, int nCmdShow);

[DllImport("user32")]
extern static bool SetForegroundWindow(IntPtr hWnd);

private Mutex singletonMutex;

private void MainForm_Load(object sender, EventArgs e)
{
  bool wasCreated;
  singletonMutex = new Mutex(false, Application.ProductName + "Mutex", out wasCreated);

  // returns false for every instance except the first
  if (!wasCreated)
  {
    Process thisProcess = Process.GetCurrentProcess();
    Process[] peerProcesses = Process.GetProcessesByName(thisProcess.ProcessName.Replace(".vshost", string.Empty));

    foreach (Process currentProcess in peerProcesses)
    {
      if (currentProcess.Handle != thisProcess.Handle)
      {
        ShowWindowAsync(currentProcess.MainWindowHandle, 1); // SW_NORMAL
        SetForegroundWindow(currentProcess.MainWindowHandle);

        // always returns null !!!
        MainForm runningForm = (MainForm) Control.FromHandle(currentProcess.MainWindowHandle);

        if (runningForm != null)
        {
          runningForm.Arguments = this.Arguments;
          runningForm.ProcessArguments();
        }

        break;
      }
    }

    Application.Exit();

    return;
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T16:15:11.490

.NET 框架很好地支持单实例应用程序。检查[此线程](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/a7082d6a-627f-436e-88d6-20ebff7efc8d/)以获取完全符合您需要的示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T13:53:13.797

尝试以下

```
var form = (Form)(Control.FromHandle(myHandle)); 
```

**编辑**

重新阅读您的问题并意识到您正在查看另一个进程中的句柄。无法将另一个进程中的句柄转换为当前进程中的 Form 实例。我的解决方案仅适用于同一进程中的句柄。

获得 Form 实例的唯一方法是使用 Remoting。但这需要两个过程的合作，而这似乎不是您想要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T14:00:41.593

Control.FromHandle 不起作用，因为您要查找的控件在另一个进程中（因此在另一个应用程序域中）。

您已经拥有 WindowHandle，但它的使用仅限于 Win32 API。WinForms 中的任何内容都不起作用。

您可以发送 (WM_) 消息，但很难获取数据。

选项

1.  在临时文件中使用低级别的东西。

2.  使用远程处理 (WCF)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-24T14:10:13.147

您确实在尝试实现单例应用程序。网上有几个例子（对不起，我自己没有真正尝试过），例如

[http://www.codeproject.com/KB/cs/SingletonApplication.aspx](http://www.codeproject.com/KB/cs/SingletonApplication.aspx)

[http://www.nathanm.com/csharp-wpf-singleton-application/](http://www.nathanm.com/csharp-wpf-singleton-application/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T14:25:35.310

你不能直接调用另一个进程中的代码，你需要使用某种形式的进程间通信

如果您仅在同一台计算机上由同一用户启动的进程之间进行通信，则可以使用窗口消息（使用 WinAPI PostMessage 并覆盖 WndProc），否则我认为远程处理是 .net 中最容易使用的

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-25T03:35:04.163

我使用 nobugz 指向的线程中描述的 Microsoft.VisualBasic.dll 库。是的，您可以在 C# 中使用它。您只需覆盖 OnStartupNextInstance 并以最适合您的方式将命令行传递到您的程序中。

这比手动处理线程要容易得多。

# linux - 从 Linux 迁移到 OpenSolaris 会有多痛苦？

> ID：581799
> 
> 赞同：1
> 
> 时间：2009-02-24T13:50:52.540
> 
> 标签：linux, migration, centos, redhat, opensolaris

我们有一个业务应用程序，它基本上运行在与操作系统无关的堆栈（tomcat+java+mysql）上，但我们总是运行它 redhat 或 centos。

有一位客户出于自己的原因坚持在 opensolaris 上运行它（与 Sun 签订的昂贵的“包罗万象”的支持协议）。

这样的迁移会有多痛苦？我们有很多配置文件和支持脚本，例如：

*   阿帕奇
*   apache/tomcat 连接器
*   与后缀的电子邮件交互
*   定制服务启动/停止
*   几个 cron 作业（备份、监控）
*   不同的用户和权限（java、mysql、电子邮件、备份...）

我们的构建过程会输出一个 .tar.gz 文件，其中包含我们的业务代码 + 一些编辑所有操作系统配置文件的 shell 脚本。

以前有这方面的经验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T14:03:37.080

最大的问题将是您用于 Linux 上提供的 GNU 工具的非 POSIX（非标准）选项，这些选项不在 Solaris 标准命令中。您可能认为从 GNU 集中移植相关工具比修改系统更简单。如果您在代码中添加了命令 ( `/usr/bin/ls`) 的绝对路径名，但您决定改用 GNU 版本，那么您必须找到解决这些问题的方法。对于用 GNU 版本替换 OpenSolaris 版本，我会非常谨慎。你不知道什么时候会破坏系统所依赖的东西。因此，您会将 GNU 命令放在单独的目录中 - 可能不会`/usr/local`因为那是由机器所有者填充的，而不是你作为应用程序贩子 - 并安排使用它来代替系统命令。（注意：在 Solaris 上，`/bin`是指向 的符号链接`/usr/bin`；我假设 OpenSolaris 也是如此。） AFAIK，Postfix 在 OpenSolaris 上不是标准的，所以你必须确保你也安装了它。

所有这一切都是可行的——没有什么是不可克服的。但很大程度上取决于您的代码库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T14:41:13.853

虽然我们不使用 OpenSolaris 作为 Web 服务器，但我们同时运行这两者。

好的：

*   OpenSolaris 附带了 gnu 工具，因此，让您的路径正确，就可以了。

*   大多数东西只是构建和运行得很好。

不太好：

*   确保您已安装并正在使用 bash。否则，您使用的所有那些您认为自己没有使用的 bashism 都会咬您一口。

*   确保您没有使用 /usr/bin 或 /bin 的硬编码路径。这些工具不是 GNU 的，因此有不同的选择。如上所述使用 /usr/gnu。

*   您没有像使用 yum 或 apt 那样可以直接安装的大量软件包。是的，你有一个包管理器，它只是没有那么好。因此，您可能会手动安装软件包。他们应该安装，这对您的系统管理员来说只是更多的工作。

*   您确定 OpenSolaris 在您的硬件上运行良好吗？值得一试。您可能会发现某些硬件驱动程序没有经过很好的测试。

否则我们会发现 OpenSolaris 很好。它有很多好主意。

你看过 Nexenta - [http://www.nexenta.org/os](http://www.nexenta.org/os) 它是带有 Ubuntu 用户空间的 OpenSolaris 内核。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T14:16:17.983

OpenSolaris 已经包含所有 GNU 实用程序，只需将脚本指向 /usr/gnu/bin

安装 Postfix 应该不会出现任何问题，并且 Apache/MySQL 存在于基本的 OpenSolaris 安装中（事实上，Cool Web Stack 的东西使它与 WAMP/Instant Rails 一样易于管理）。除此之外，SMF 清单（SMF 是 rc 脚本的替代品，有点像 OSX 的 launchd，尽管您仍然可以使用常规的 init 脚本）可能会让您的生活更轻松，因为指定依赖关系和运行顺序会更好一些（它会递归启动/也停止所有依赖服务）。

Tomcat 确实有效，尽管我在 OpenSolaris 上认识的每个人都使用 GlassFish。YMMV，但是在任何地方部署 .war 几乎都是一样的。

部署到 LX 品牌区域可能不是一个糟糕的第一步（想想 FreeBSD 监狱或 Linux vServer 进行比较），因为 LX 品牌区域可以运行 Linux 二进制文件，并且明确基于 CentOS/RHEL。

除此之外，OpenSolaris 是自 b77 或其他东西以来的 Xen dom0，如果可以选择的话，将 CentOS/RHEL 放入 domU 非常简单。

您还可以获得所有 Solaris 的好东西（DTrace、ZFS、网络虚拟化 [通过 CrossBow] 等）。谁知道？你甚至可能喜欢它！Java 是 Java，所以这不应该造成任何问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:18:24.780

*   您可能必须重写大部分脚本（用户创建、服务启动），因为它在 CentOS 和 OpenSolaris 中可能不同。

*   如前所述，请您的客户安装 GNU 工具，这样您就可以减少重写脚本的工作量。

*   os 配置文件的格式也可能不同，您需要检查一下。

*   您的 tar.gz 文件应该可以毫无问题地提取出来，但是如果您使用 GNU 工具，那么您的惊喜也会减少。一些 Unix 操作系统的 tar 有一些限制

> 以前有这方面的经验。

（可能有点题外话）

我们使用脚本中引用的所有二进制文件打包和分发我们的 java/tomcat/postgresql/unix 应用程序。这意味着我们支持的每个操作系统都有 1 个构建系统，这意味着我们支持我们的应用程序以及外部二进制文件，但最终我们并没有给客户带来不好的惊喜。

我们还要求他们在安装应用程序之前执行所有 root 操作（用户创建、目录创建、sendmail 配置、系统调整）。我们为所有受支持的操作系统编写了关闭/启动脚本，它们的安装是我们在客户机器上以 root 身份执行的唯一操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-24T22:32:21.237

除了你是一个巨魔之外，有人刚刚在上面说（Open）Solaris 有： - ZFS - DTrace

我们可以理解您害怕失去您的 RHCE 工作，但您再次证明了我作为雇主在面试人员时忽略所有认证的决定是一个很好的决定。似乎很大一部分这样的人（尤其是在微软世界）并不那么……开放，说得好听点。

问候，亚历克斯

# asp.net-mvc - 如何使用 Html.DropDownList 为默认选项设置值

> ID：581805
> 
> 赞同：6
> 
> 时间：2009-02-24T13:52:40.257
> 
> 标签：asp.net-mvc

我正在使用 ASP MVC RC1。

我正在使用的表单包含一个下拉列表，我已使用此代码将其放入视图中。

```
<%= Html.DropDownList("areaid", (SelectList)ViewData["AreaId"], "Select Area Id")%> 
```

但是，当渲染时，这就是我得到的

```
<select id="areaid" name="areaid">
   <option value="">Select Area Id</option>
   <option value="1">Home</option>
   ...
</select> 
```

我想要的是 Select Area Id 选项的值为 0 并将其标记为默认选中，因此它与其他值一致，我可以验证是否选择了一个区域，因为它是强制性的价值。AreaId 是一个整数，因此当我当前单击表单时根本没有触摸下拉列表，MVC 抱怨“”不是整数并给我一个绑定错误。

那么如何为默认选项设置一个值，然后在表单上选择它？

谢谢，丹

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-24T14:31:01.333

我认为你有~~三个~~四个选项。首先，当您构建 SelectList 或 SelectItemList 的可枚举项时，请在选择之前添加您的选项标签和默认值。如果模型中尚未选择其他值，则将其放在顶部将使其成为默认值。其次，您可以使用循环在视图中“手动”构建选择（和选项）来创建选项。同样，如果模型中未提供默认选择，请预先添加默认选择。第三，使用DropDownList扩展，但是在页面加载后使用javascript修改第一个选项的值。

似乎不可能使用 DropDownList 扩展来为 optionLabel 分配一个值，因为它是硬编码的`string.Empty`。[以下是来自http://www.codeplex.com/aspnet](http://www.codeplex.com/aspnet)的相关代码片段。

```
 // Make optionLabel the first item that gets rendered.
    if (optionLabel != null) {
        listItemBuilder.AppendLine(ListItemToOption(new SelectListItem() { Text = optionLabel, Value = String.Empty, Selected = false }));
    } 
```

**编辑**：最后，最好的方法是让您的模型采用 Nullable 值并使用 RequiredAttribute 将其标记为必需。我建议使用视图特定的模型而不是视图的实体模型。由于该值为 Nullable，因此如果在不选择值的情况下回发空字符串，则可以正常工作。将其设置为必需值将导致模型验证失败，并显示需要该值的适当消息。这将允许您按原样使用 DropdownList 助手。

```
public AreaViewModel
{
    [Required]
    public int? AreaId { get; set; }

    public IEnumerable<SelectListItem> Areas { get; set; }
    ...
}

@Html.DropDownListFor( model => model.AreaId, Model.Areas, "Select Area Id" ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-22T18:39:55.350

对于 MVC3，SelectList 有一个重载，您可以在其中定义选定的值。

```
Function Create() As ViewResult

        ViewBag.EmployeeId = New SelectList(db.Employees, "Id", "Name", 1)

        Return View()

    End Function 
```

在这种情况下，我碰巧知道 1 是我想要的默认列表项的 id，但大概您可以通过查询选择默认值或任何漂浮的船

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-30T10:59:08.110

您可以在控制器的列表的第 0 个索引处添加“选择区域”数据，而不是从视图中的定义中传递默认项。

这样，选择区域数据的索引值为 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-04T06:37:14.967

我想对多个下拉菜单使用相同的 SelectList，并且不想在模型中复制 SelectList，所以我只是添加了一个新的 Html Extension 方法，该方法接受一个值并设置所选项目。

```
public static MvcHtmlString DropDownList(this HtmlHelper htmlHelper, string name, string value, IList<SelectListItem> selectList, object htmlAttributes)
{
    IEnumerable<SelectListItem> items = selectList.Select(s => new SelectListItem {Text = s.Text, Value = s.Value, Selected = s.Value == value});
    return htmlHelper.DropDownList(name, items, null /* optionLabel */, htmlAttributes);
} 
```

# java - 遵循 DDD 从应用程序批量导出时的最佳实践是什么

> ID：581821
> 
> 赞同：1
> 
> 时间：2009-02-24T13:55:30.327
> 
> 标签：java, .net, export, domain-driven-design

假设您有一个包含大量产品/客户/订单的数据库，并且代码库 (java/c#) 包含所有业务逻辑。在夜间，需要分批将数据导出到平面文件，然后通过 ftp 将它们传输到专有系统。

我们应该如何做到这一点“将数据库写入平面文件？最佳实践是什么？

一些想法：

*   我们可以创建一个存储过程并使用 f.ex ssis 来获取数据吗？如果我们有一个“batch-output-database-table”也许我们可以做到这一点，但如果我们必须在文件写入之前执行逻辑就不行了？

*   我们可以使用与域的其余部分相同的存储库/业务逻辑来完成托管代码中的所有逻辑吗？（与存储过程解决方案相比，这可能是一个缓慢的过程）

*   如果域服务的唯一接口是 Web 服务（每个请求可能需要“很长时间”），“最佳实践”会改变吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T14:06:15.170

我个人更喜欢使用普通（托管）代码来实现提要而不是存储过程，主要是因为：1）通常更容易与其他系统交互（即使它只是共享驱动器）2）很容易记录你的一切如果出现问题，需要并调试 3) 您可以重用用于正常业务逻辑的相同代码（即使您只是引用相同的项目等，它也是有益的） 4) 通常您需要使用来自其他系统的一些信息来丰富数据而这又比托管代码更容易做到。5) 测试托管代码、进行所有单元测试、自动构建等要容易得多。

我不确定为什么它需要比在存储过程中完成所有操作要慢得多。您只需要编写一个好的存储过程来提取您需要的数据，C#/java 应用程序将完成所有的转换、丰富等。

编辑：回答评论：我认为不可能说您是否应该重用现有的存储过程、调整它们或创建新的。我认为这是对性能的影响或所需的更改并不会比我尝试使用一组 proc 大，以避免重复逻辑。但如果差异很大，那么维护额外 proc 的成本可能会低于更改和发布现有的成本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T07:41:31.387

使用您已经拥有的存储库代码。做一些性能测试，看看它是否符合性能。要求。如果有显着的性能。可以将问题归结为过多的 DB IO，然后选择 sproc 或实施批量导出存储库。

# debugging - Windows服务停止工作，回收修复它

> ID：581822
> 
> 赞同：0
> 
> 时间：2009-02-24T13:55:30.733
> 
> 标签：debugging, windows-services

我有一个 Windows 服务，它有一个每 30 秒触发一次方法的计时器。

然后该方法调用 thread.sleep() 并在完成时调用 thread.start();

该方法中的所有代码都包含在 try/catch 中，除了对线程睡眠/启动的调用。

出于某种原因，该服务停止工作，但如果我回收它或将其设置为在崩溃时回收它工作正常。

如何诊断问题？
是否有其他事件，如 OnCrash 或我可以挂钩以挖掘堆栈跟踪的其他事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T13:57:35.923

不，没有，但是为什么不自己尝试/捕获并在发生异常时记录异常呢？

另外，我发现对 Sleep and Start 的调用非常可疑。通常，您不应该使用这些调用进行同步。你为什么打这些电话？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T13:57:44.877

我认为首先你需要找到它崩溃的原因。崩溃？好吧，如果它崩溃了，我想它就没什么好说的了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T14:03:49.370

***它的计时器！***. 摆脱它，你的问题就会得到解决。

查看这篇[文章](https://stackoverflow.com/questions/397744/-net-windows-service-with-timer-stops-responding)了解更多信息。

你最好做这样的操作......

```
While (stopSignal = False)
 'do your work'
 Thread.Sleep(yourInterval)
End While 
```

编辑：如果您想调试服务并且不必通过附加调试器而受苦，那么请执行[此](http://www.codeproject.com/KB/dotnet/DebugWinServices.aspx)操作。

无论您是否同意，MS 都已确认这是一个[错误](https://stackoverflow.com/questions/397744/-net-windows-service-with-timer-stops-responding/398273#398273)，删除计时器是避免此问题的唯一方法。如果可以的话，您也不应该将异常用作程序流控制（Catch and Retry）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:06:45.840

Windows 服务与普通应用程序一样，只是执行方式不同。所以问问自己，如果你的普通应用程序没有崩溃，而是停止工作，是什么原因导致的？很多事情都会浮现在脑海中，比如锁定问题、并发问题等......

虽然没有 OnCrash 事件，但我为 Windows 服务所做的是将所有逻辑放在一个单独的程序集中，使用一个简单的启动方法，这样我就可以将它托管在控制台应用程序中并轻松进行测试并转移到 Windows 服务也不是太难。

您的另一个选择是[将 Visual Studio 调试器附加到 Windows 服务](http://msdn.microsoft.com/en-us/library/7a50syb3.aspx)并正常调试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-27T01:53:24.517

您可以使用 Microsoft 的调试诊断工具 v1.1 来监控服务并在服务崩溃时创建转储。然后你可以调试转储。

[http://www.microsoft.com/download/en/details.aspx?id=24370](http://www.microsoft.com/download/en/details.aspx?id=24370)

# f# - F# 中的 Project Euler 问题 27

> ID：581824
> 
> 赞同：1
> 
> 时间：2009-02-24T13:56:10.467
> 
> 标签：f#, functional-programming, primes

我一直在努力解决 Project Euler 的第[27](http://projecteuler.net/index.php?section=problems&id=27)题，但这似乎难倒我。首先，代码运行时间太长（在我的机器上可能需要几分钟，但更重要的是，它返回了错误的答案，尽管在浏览了一段时间后我真的无法发现算法有什么问题.

这是我当前的解决方案代码。

```
/// Checks number for primality.
let is_prime n = 
    [|1 .. 2 .. sqrt_int n|] |> Array.for_all (fun x -> n % x <> 0)

/// Memoizes a function.
let memoize f = 
    let cache = Dictionary<_, _>()
    fun x -> 
        let found, res = cache.TryGetValue(x)
        if found then
            res
        else
            let res = f x
            cache.[x] <- res
            res

/// Problem 27
/// Find a quadratic formula that produces the maximum number of primes for consecutive values of n.
let problem27 n =
    let is_prime_mem = memoize is_prime
    let range = [|-(n - 1) .. n - 1|]
    let natural_nums = Seq.init_infinite (fun i -> i)
    range |> Array.map (fun a -> (range |> Array.map (fun b ->
        let formula n = n * n + a * n + b
        let num_conseq_primes = natural_nums |> Seq.map (fun n -> (n, formula n))
                                |> Seq.find (fun (n, f) -> not (is_prime_mem f)) |> fst
        (a * b, num_conseq_primes)) |> Array.max_by snd)) |> Array.max_by snd |> fst

printn_any (problem27 1000) 
```

关于如何a）让这个算法真正返回正确答案的任何提示（我认为我至少采取了一种可行的方法）和b）提高性能，因为它显然超过了项目中规定的“一分钟规则”欧拉常见问题。我是函数式编程的新手，所以任何关于我如何考虑更实用的解决方案的问题的建议也将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-24T14:42:19.560

两个备注：

1.  **您可以利用`b`必须是素数**的事实。这是因为问题要求`n = 0, 1, 2, ...` So的最长素数序列`formula(0)`以 开头，但`formula(0) = b`必须是素数，因此 b 必须是素数。

2.  我不是 F# 程序员，但**在我看来，代码根本没有尝试 n=0**。这当然不符合问题`n`必须从 开始的要求`0`，因此产生正确答案的机会可以忽略不计。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T16:39:29.107

是的，经过大量检查所有辅助函数都在做他们应该做的事情之后，我终于找到了一个可行的（并且相当有效的）解决方案。

首先，*is_prime*函数是完全错误的（感谢 Dimitre Novatchev 让我看一下）。我不太确定我是如何得出我在原始问题中发布的函数的，但我认为它是有效的，因为我在以前的问题中使用过它。（很可能，我刚刚对其进行了调整并打破了它。）无论如何，这个函数的工作版本（对于所有小于 2 的整数至关重要地返回 false）是这样的：

```
/// Checks number for primality.
let is_prime n = 
    if n < 2 then false
    else [|2 .. sqrt_int n|] |> Array.for_all (fun x -> n % x <> 0) 
```

主要功能更改为以下内容：

```
/// Problem 27
/// Find a quadratic formula that produces the maximum number of primes for consecutive values of n.
let problem27 n =
    let is_prime_mem = memoize is_prime
    let set_b = primes (int64 (n - 1)) |> List.to_array |> Array.map int
    let set_a = [|-(n - 1) .. n - 1|]
    let set_n = Seq.init_infinite (fun i -> i)
    set_b |> Array.map (fun b -> (set_a |> Array.map (fun a ->
        let formula n = n * n + a * n + b
        let num_conseq_primes = set_n |> Seq.find (fun n -> not (is_prime_mem (formula n)))
        (a * b, num_conseq_primes))
    |> Array.max_by snd)) |> Array.max_by snd |> fst 
```

这里提高速度的关键是只为*b*的值生成 1 到 1000 之间的素数集（使用*素数*函数，我实现的埃拉托色尼筛法）。通过消除不必要的 Seq.map，我还设法使这段代码更加简洁。

所以，我对我现在拥有的解决方案非常满意（它只需要不到一秒钟的时间），当然任何进一步的建议仍然是受欢迎的......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T14:16:30.700

您可以使用概率算法加速您的“is_prime”函数。最简单的快速算法之一是[Miller-Rabin](http://en.wikipedia.org/wiki/Miller-Rabin_primality_test)算法。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-29T15:18:41.120

为了摆脱一半的计算，您还可以使可能的数组只包含奇数

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2010-12-13T14:49:07.410

我的超快python解决方案：P

```
flag = [0]*204
primes = []

def ifc(n): return flag[n>>6]&(1<<((n>>1)&31))

def isc(n): flag[n>>6]|=(1<<((n>>1)&31))

def sieve():
    for i in xrange(3, 114, 2):
        if ifc(i) == 0:
            for j in xrange(i*i, 12996, i<<1): isc(j)

def store():
    primes.append(2)
    for i in xrange(3, 1000, 2):
        if ifc(i) == 0: primes.append(i)

def isprime(n):
    if n < 2: return 0
    if n == 2: return 1
    if n & 1 == 0: return 0
    if ifc(n) == 0: return 1
    return 0    

def main():
    sieve()
    store()
    mmax, ret = 0, 0
    for b in primes:
        for a in xrange(-999, 1000, 2):
            n = 1
            while isprime(n*n + a*n + b): n += 1
            if n > mmax: mmax, ret = n, a * b
    print ret

main() 
```

# ios - 自动释放范围

> ID：581828
> 
> 赞同：6
> 
> 时间：2009-02-24T13:57:14.690
> 
> 标签：ios, objective-c, xcode, cocoa, cocoa-touch

我想知道 autorelese 如何在 iPhone 上工作。我认为，一旦您向对象发送自动释放，**就可以保证**将其保留到`autorelease`发送的块范围的末尾。那是对的吗？

我正在从NIB初始化一个视图，`applicationDidFinishLaunching`如下所示：

```
 (void)applicationDidFinishLaunching:(UIApplication *)application {

    loginViewController = [[[LoginViewController alloc] initWithNibName:@"LoginView" bundle:nil] autorelease];

    [window addSubview: [loginViewController view]];
    [window makeKeyAndVisible];
} 
```

并且视图根本没有显示，屏幕上只有`UIWindow`

现在，一旦我`autorelease`从控制器初始化的末尾删除了，从那里开始一切顺利。

这是关于什么的？

干杯，K。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-24T19:50:25.590

当您调用 时`autorelease`，您将对象的所有权授予当前自动释放池。运行循环在调度事件（例如`applicationDidFinishLaunching:`）之前创建一个新的自动释放池，并在事件完成时销毁该池。

当您将所有权授予`LoginViewController`自动释放池时，它会在`applicationDidFinishLaunching:`返回后立即释放。当视图控制器释放自己时，它会从超级视图（在本例中为您的窗口）中删除其视图。

您的应用程序委托应在应用程序委托的方法中保留对`LoginViewController`和`release`它的所有权`dealloc`（或者当您完成登录并移至另一个视图时）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-28T22:13:58.310

为了扩展 Don 的答案，说“您将对象的所有权授予当前的自动释放池”可能有些令人困惑。这可能会被误解为意味着当自动释放池耗尽时，对象肯定会被销毁。这是不正确的（尽管在这种情况下会发生）。发送`-autorelease`请求，要求自动释放池`-release`在耗尽时发送消息。如果该`-release`消息使retainCount = 0，则该对象将被销毁。

因此，为了执行 Don 的建议，您需要创建一个 ivar 来跟踪此视图控制器。他对视图为何消失的解释是完全正确的；但你不想只是泄漏视图控制器。你想抓住它，当你完成它时释放它。

```
@interface ... {
   LoginViewController *_loginViewController;
}

@property (readwrite, retain) LoginViewController *loginViewController;

@implementation ...
@synthesize loginViewController = _loginViewController;

- (void)applicationDidFinishLaunching:(UIApplication *)application {

    self.loginViewController = [[[LoginViewController alloc] initWithNibName:@"LoginView" bundle:nil] autorelease];

    [window addSubview: [loginViewController view]];
    [window makeKeyAndVisible];
}

- (void)dealloc {
    [_loginViewController release]; _loginViewController = nil;
    [super dealloc];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T14:09:54.303

自动释放池在运行循环结束时被清理。这意味着只要您调用方法并执行操作，它就仍然存在。

我在您的代码中看不到错误，但在您的示例中正确保留了 Window。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T17:50:47.143

由于您将您的添加`LoginViewController`到自动释放池中，因此它在运行循环结束时被释放。发生这种情况时，它还会释放其视图并将其从显示中删除。

# wpf - WPF：旋转后获取新坐标

> ID：581837
> 
> 赞同：13
> 
> 时间：2009-02-24T14:00:02.580
> 
> 标签：wpf, math, transform

*参考我目前正在构建的[这个编程游戏。](https://stackoverflow.com/questions/505040/developing-a-robocode-type-game-with-net-for-a-school-assignment)*

[替代文字 http://img12.imageshack.us/img12/2089/shapetransformationf.jpg](http://img12.imageshack.us/img12/2089/shapetransformationf.jpg)

为了在 WPF 中翻译画布，我使用了两种形式：（`TranslateTransform`移动它）和`RotateTransform`（旋转它）[*相同的孩子* `TransformationGroup`]

当画布不旋转（或旋转 90 度，因为它是相同的）时，我可以很容易地获得画布的左上角 x，y 坐标，但我面临的问题是左上角（和其他 3 个点）坐标。

这是因为当应用 a`RotateTransform`时，`TranslateTransform`'s`X`和`Y`属性没有改变（因此仍然表明正方形的左上角就像虚线正方形（来自图像）

画布从其中心旋转，这就是它的原点。

那么**如何在旋转后获得 4 个点的“新”x 和 y 坐标**？

**[更新]**

[替代文字 http://img25.imageshack.us/img25/8676/shaperotationaltransfor.jpg](http://img25.imageshack.us/img25/8676/shaperotationaltransfor.jpg)

我找到了一种在旋转后找到**左上角**坐标的方法（正如您从新图像中看到的那样），方法是将 OffsetX 和 OffsetY 从旋转添加到起始 X 和 Y 坐标。

但是我现在无法确定其余的坐标（其他 3 个）。

有了这个旋转的形状，**我怎样才能算出剩余 3 个角的 x 和 y 坐标？**

**[编辑]**

第二张图像中的点**不是准确和精确的点**。我在脑海中做出了估计。

**[更新]解决方案：**

首先，我要感谢[Jason S](https://stackoverflow.com/questions/581837/wpf-getting-new-coordinates-after-a-rotation/591058#591058)的那篇冗长且内容丰富的帖子，他在其中描述了整个过程背后的数学；通过阅读您的帖子并尝试这些价值观，我当然学到了很多东西。

但我现在找到了一个代码片段（感谢[EugeneZ](https://stackoverflow.com/questions/581837/wpf-getting-new-coordinates-after-a-rotation/593552#593552)提到的`TransformBounds`），它完全符合我的要求：

```
public Rect GetBounds(FrameworkElement of, FrameworkElement from)
{
    // Might throw an exception if of and from are not in the same visual tree
    GeneralTransform transform = of.TransformToVisual(from);

    return transform.TransformBounds(new Rect(0, 0, of.ActualWidth, of.ActualHeight));
} 
```

*参考：[http ://social.msdn.microsoft.com/Forums/en-US/wpf/thread/86350f19-6457-470e-bde9-66e8970f7059/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/86350f19-6457-470e-bde9-66e8970f7059/)*

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-26T15:38:40.687

如果我理解你的问题是正确的：

```
given:
shape has corner (x1,y1), center (xc,yc)
rotated shape has corner (x1',y1') after being rotated about center

desired:
how to map any point of the shape (x,y) -> (x',y') by that same rotation 
```

以下是相关方程式：

```
(x'-xc) = Kc*(x-xc) - Ks*(y-yc)
(y'-yc) = Ks*(x-xc) + Kc*(y-yc) 
```

其中`Kc=cos(theta)`和是逆时针旋转的角度`Ks=sin(theta)`。`theta`（验证：如果 theta=0 则保持坐标不变，否则如果 xc=yc=0，则将 (1,0) 映射到 (cos(theta),sin(theta)) 并将 (0,1) 映射到 (- sin(theta), cos(theta)) . 警告：这是用于坐标系，其中 (x,y)=(1,1) 位于右上象限。对于您位于右下象限的坐标系，theta 将是顺时针旋转的角度，而不是逆时针旋转的角度。）

如果您知道矩形的坐标与 xy 轴对齐，则 xc 将只是两个 x 坐标的平均值，而 yc 将只是两个 y 坐标的平均值。（在您的情况下，它是 xc=75,yc=85。）

如果您知道 theta，您现在就有足够的信息来计算新坐标。如果你不知道theta，你可以解出Kc，Ks。这是您的示例的相关计算：

```
(62-75) = Kc*(50-75) - Ks*(50-85)
(40-85) = Ks*(50-75) + Kc*(50-85)

-13 = -25*Kc + 35*Ks = -25*Kc + 35*Ks
-45 = -25*Ks - 35*Kc = -35*Kc - 25*Ks 
```

这是一个可以求解[的线性方程组（读者练习：在 MATLAB 中它是：](http://en.wikipedia.org/wiki/System_of_linear_equations)

```
[-25 35;-35 -25]\[-13;-45] 
```

产生，在这种情况下，Kc=1.027, Ks=0.3622 这没有意义（K ² = Kc ² + Ks ²对于纯旋转应该等于 1；在这种情况下它是 K = 1.089）所以它不是围绕矩形中心的纯旋转，这就是您的绘图所指示的。它似乎也不是关于原点的纯粹旋转。要检查，请使用勾股定理比较旋转前后到旋转中心的距离，d ² = deltax ² + deltay ². （绕xc=75，yc=85，前距离为43.01，后距离为46.84，比值为K=1.089；绕原点旋转时，前距离为70.71，后距离为73.78，比值为1.043。我可以相信 1.01 或更低的比率会因坐标舍入为整数而产生，但这显然大于舍入误差）

所以这里有一些缺失的信息。你是怎么得到数字（62,40）的？

然而，这是旋转背后数学的基本要点。

编辑：啊哈，我没有意识到它们是估计值。（虽然非常接近现实！）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-23T11:27:43.720

我使用这种方法：

```
Point newPoint = rotateTransform.Transform(new Point(oldX, oldY)); 
```

其中 rotateTransform 是我工作并设置 Angle...等的实例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T04:46:11.230

查看 GeneralTransform.TransformBounds() 方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T14:05:46.917

我不确定，但这是你要找的 - 笛卡尔坐标系中点的旋转： [链接](http://musr.physics.ubc.ca/~jess/p200/str/str16.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T15:34:06.533

您可以在 Point 上使用具有相同转换的 Transform.Transform() 方法来获取应用这些转换的新点。

# .net - 如何给 WPF 元素一个矩形平面 3D 边框？

> ID：581838
> 
> 赞同：8
> 
> 时间：2009-02-24T14:00:06.510
> 
> 标签：.net, wpf, border

我想为我的一个控件模板创建一个矩形“平面 3D”外观。在最简单的版本中，这意味着底部的线比顶部的线更暗，左右线之间也可能存在一些变化。

更复杂的版本将允许我提供一个或多个画笔，以便可以应用渐变。

WPF 中的默认`<Border>`元素允许您为每个边缘指定不同的厚度，但我找不到指定多个画笔的方法。

那么，如何才能尽可能简单地产生我想要的效果呢？

**编辑**有人建议我发布一个我想如何使用它的例子。就我个人而言，我很乐意拥有样式或用户控件。用户控件可以这样使用：

```
<FourSidedBorder LeftSideBrush="#00f" RightSideBrush="#0f0" ... /> 
```

或者甚至更简单：

```
<FourSidedBorder BorderBrush="#00f,#0f0,#f00,#fff"
                 BorderThickness="1,2,3,4" ... /> 
```

这些只是想法。欢迎任何明智、简洁的解决方案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-24T16:23:37.787

这是我设计的一个解决方案，可以实现我想要的大部分功能。它不能独立地完全控制所有四个边，但它确实提供了我想要的矩形平面 3D 视图。

这是它的外观：

[![][1]][1]

将其粘贴到[Kaxaml](https://github.com/thinkpixellab/kaxaml)中以亲自查看：

```
<Page
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  Background="#CCC">
  <Page.Resources>
    <!-- A brush for flat 3D panel borders -->
    <LinearGradientBrush x:Key="Flat3DBorderBrush"
                         StartPoint="0.499,0" EndPoint="0.501,1">
      <GradientStop Color="#FFF" Offset="0" />
      <GradientStop Color="#DDD" Offset="0.01" />
      <GradientStop Color="#AAA" Offset="0.99" />
      <GradientStop Color="#888" Offset="1" />
    </LinearGradientBrush>
  </Page.Resources>
  <Grid>  
    <!-- A flat 3D panel -->
    <Border
          HorizontalAlignment="Center" VerticalAlignment="Center"
          BorderBrush="{StaticResource Flat3DBorderBrush}"
          BorderThickness="1" Background="#BBB">

          <!-- some content here -->
          <Control Width="100" Height="100"/>

    </Border>  
  </Grid>
</Page> 
```

希望能帮助别人。我仍在寻找解决此问题的创新解决方案，因此请继续发帖，我会接受比这个更好的答案。[1]：[https ://i.stack.imgur.com/eMStF.png](https://i.stack.imgur.com/eMStF.png)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-03-17T18:05:59.627

我只是通过将多个边框直接放在彼此之上来完成类似的操作。例如：

```
<Border 
  x:Name="TopAndLeft" 
  BorderThickness="3,3,0,0" 
  BorderBrush="{x:Static SystemColors.ControlLightBrush}">
<Border 
  x:Name="BottomAndRight" 
  BorderThickness="0,0,3,3" 
  BorderBrush="{x:Static SystemColors.ControlDarkBrush}">
    <ContentPresenter ... />
</Border>
</Border> 
```

这提供了边界提供的所有其他功能的额外优势 - 拐角半径等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-24T14:10:23.413

老实说，最简单的方法可能是使用分层技术。例如创建一个像这样的网格：

```
 <Grid Width="50" Height="50">  
     <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
        <RowDefinition Height="Auto" />
     </Grid.RowDefinitions>
     <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
     </Grid.ColumnDefinitions>

     <!-- Top Border -->
     <Border Height="3" Background="LightGray" Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="2" />

     <!-- Right Border -->
     <Border Width="3" Background="DarkGray" Grid.Column="2" Grid.Row="0" Grid.RowSpan="3" />

     <!-- Content -->
     <Border Background="Gray" Grid.Row="1" Grid.Column="1" />

     <!-- Left Border -->
     <Border Width="3" Background="LightGray" Grid.Row="1" Grid.Column="0" Grid.RowSpan="2" />

     <!-- Bottom Border -->
     <Border Height="3" Background="DarkGray" Grid.Row="2" Grid.Column="1" />

  </Grid> 
```

我想你应该已经明白了。这可能是最简单的方法。您可以将其设置为模板并像这样使用它：

```
<Template x:Key="My3DBorder" TargetType="ContentControl">
    <!-- Put the Grid definition in here from above -->
</Template>

<ContentControl Template="{StaticResource My3dBorder}">
   <!-- My Content Goes Here -->
</ContentControl> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-03-20T21:24:37.280

需要一个经典的 3D 'inset' 边框。基于@GregD 的回答（谢谢！）：

```
 <Border BorderThickness="0,0,1,1" BorderBrush="{x:Static SystemColors.ControlLightLightBrush}">
        <Border BorderThickness="1,1,0,0" BorderBrush="{x:Static SystemColors.ControlDarkBrush}">
            <Border BorderThickness="0,0,1,1" BorderBrush="{x:Static SystemColors.ControlLightBrush}">
                <Border BorderThickness="1,1,0,0" BorderBrush="{x:Static SystemColors.ControlDarkDarkBrush}">
                ..
                </Border>
            </Border>
        </Border>
    </Border> 
```

要使其成为“开始”，请恢复第一个和第二个元素对的顺序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-22T21:39:36.200

您可以引用**PresentationFramework.Classic**程序集，然后使用

```
<Window xmlns:mwt="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Classic">
...

<Grid Width="50" Height="50">
    <mwt:ClassicBorderDecorator BorderThickness="3,3,3,3"/>
</Grid> 
```

我正在使用[这种技术来查看控件模板](http://learnwpf.com/post/2006/03/19/How-can-I-decompileextract-a-WPF-Controls-default-template-as-Xaml.aspx)以查看默认按钮的样式

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-04T11:25:20.760

我更喜欢的酷方法的两分钱 - 也使用阴影（作为一种风格，所以你可以在任何地方使用它）：

```
 <Style x:Key="border_style" TargetType="{x:Type Border}">
        <Style.Resources>
            <DropShadowEffect x:Key="dropShadowEffect" BlurRadius="8" ShadowDepth="1" Color="#FF2686AA" RenderingBias="Quality"/>
         </Style.Resources>

        <Setter Property="CornerRadius" Value="2" />
        <Setter Property="Effect" Value="{StaticResource dropShadowEffect}"/>
        <Setter Property="BorderBrush" Value="Gray"/>
        <Setter Property="BorderThickness" Value="1.2,1.2,0.3,0.3"/>
    </Style> 
```

用法（当您注册样式时）：

```
<Border Style="{StaticResource border_style}">

 </Border> 
```

3D 边框效果的位置由 BorderThickness 完成。您可以使用颜色、ShadowDepth、BlurRadius、CornerRadius 等。

# actionscript - 没有镀铬的 Adob e 空气窗口在最大化时会严重计算尺寸

> ID：581840
> 
> 赞同：1
> 
> 时间：2009-02-24T14:00:31.250
> 
> 标签：actionscript, air, google-chrome

当我最大化没有镀铬的空气窗口时（没有系统镀铬，没有弹性镀铬，但我认为即使只使用弹性镀铬也是一样的），所有侧面的几个像素都会离开屏幕。

任何人都有解决方案或知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T21:24:54.093

实际上最简单的方法是将空气窗口设置为显示器的大小，然后将您的自定义 UI 设置为显示器的大小减去几个像素。这是我想出的唯一解决方法。

这种方法的唯一缺点可能是小的渲染性能损失，因为 AIR 窗口必须为窗口后面的所有内容拍摄 alpha 透明图片，但这可能非常小以至于不会产生影响（我邀请某人对此进行基准测试）。

# python - 在 Python 中，如何创建一个持续到下一次运行的临时文件？

> ID：581851
> 
> 赞同：4
> 
> 时间：2009-02-24T14:03:26.067
> 
> 标签：python, temporary-files

我需要创建一个我只使用一次的文件夹，但需要让它存在直到下一次运行。似乎我应该在标准库中使用 tmp_file 模块，但我不确定如何获得我想要的行为。

目前，我正在执行以下操作来创建目录：

```
randName = "temp" + str(random.randint(1000, 9999))
os.makedirs(randName) 
```

而当我想删除目录时，我只是寻找一个包含“temp”的目录。
这似乎是一个肮脏的黑客，但我目前不确定更好的方法。

顺便说一句，我需要该文件夹的原因是我启动了一个使用以下文件夹的进程：

```
subprocess.Popen([command], shell=True).pid 
```

然后退出我的脚本让其他进程完成工作。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-24T14:18:50.647

使用 4 位随机数创建文件夹是不安全的，您还需要担心与程序的其他实例发生冲突。

一个更好的方法是使用创建文件夹[`tempfile.mkdtemp`](http://docs.python.org/library/tempfile.html)，这正是你想要的（即当你的脚本退出时文件夹不会被删除）。然后，您将文件夹名称作为参数传递给第二个 Popen'ed 脚本，它会负责删除它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-24T15:43:23.627

你的建议很危险。如果其他人试图创建这些目录——包括您的应用程序的其他实例，您可能会遇到竞争条件。此外，删除任何包含“temp”的内容可能会导致删除超出您预期的内容。正如其他人所提到的，[tempfile.mkdtemp](http://docs.python.org/library/tempfile.html#tempfile.mkdtemp)可能是最安全的方法。这是您所描述的示例，包括启动子进程以使用新目录。

```
import tempfile
import shutil
import subprocess

d = tempfile.mkdtemp(prefix='tmp')
try:
    subprocess.check_call(['/bin/echo', 'Directory:', d])
finally:
    shutil.rmtree(d) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T14:40:04.010

“我需要创建一个我只使用一次的文件夹，但需要让它存在到下一次运行。”

“顺便说一句，我需要这个文件夹的原因是我启动了一个进程……”

一点也不偶然。至关重要的。

看来您具有以下设计模式。

```
mkdir someDirectory
proc1 -o someDirectory # Write to the directory
proc2 -i someDirectory # Read from the directory
if [ %? == 0 ]
then
    rm someDirectory
fi 
```

你会在shell级别写那种东西吗？

如果是这样，请考虑将您的 Python 应用程序分成几个部分。

*   做实际工作的部分（“proc1”和“proc2”）

*   管理资源和进程的外壳；本质上是 bash 脚本的 Python 替代品。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-24T14:12:06.263

临时文件是持续单个程序运行的东西。

因此，您需要的不是临时文件。

此外，请注意单台计算机上的多个用户 - 仅删除具有“临时”模式的任何内容可能是反社会的，如果目录没有安全地放置，则更是如此。

另外，请记住，在某些机器上，`/tmp`文件系统会在机器重新启动时重建。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-02T01:04:20.843

您还可以通过执行以下操作自动注册一个函数以在任何退出（有或没有错误）时完全删除临时目录：

```
import atexit
import shutil
import tempfile

# create your temporary directory
d = tempfile.mkdtemp()

# suppress it when python will be closed
atexit.register(lambda: shutil.rmtree(d))

# do your stuff...
subprocess.Popen([command], shell=True).pid 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-24T14:19:27.900

`tempfile`很好，但是为了安全起见，您需要在某个地方保护目录名称，直到下一次运行，例如腌制它。然后在下一次运行中读取它并删除目录。并且您不需要具有`/tmp`根，`tempfile.mkdtemp`具有一个可选`dir`参数。不过，总的来说，它与您目前正在做的事情并没有什么不同。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-12T06:00:59.420

创建临时文件名的最佳方法是使用 tempName.TemporaryFile(mode='w+b', suffix='.tmp', prifix='someRandomNumber' dir=None) 或者你可以使用 mktemp() 函数。

mktemp() 函数实际上不会创建任何文件，但会提供一个唯一的文件名（实际上不包含 PID）。

# asp.net - 我可以跳过 ASP.NET 菜单控件中的节点吗？

> ID：581852
> 
> 赞同：2
> 
> 时间：2009-02-24T14:03:27.640
> 
> 标签：asp.net, web.sitemap

我有一个这样的 web.sitemap：

```
<siteMapNode url="~/Default.aspx" title="Home" description="" >
    <siteMapNode title="Node 1" description="">
        <siteMapNode url="" title="Node 1-1" description="" />
        <siteMapNode url="" title="Node 1-2" description="" />
    </siteMapNode>
    <siteMapNode title="Node 2" description="">
        <siteMapNode url="" title="Node 2-1" description="" />
        <siteMapNode url="" title="Node 2-2" description="" />
    </siteMapNode>
</siteMapNode> 
```

如果我使用 ASP.NET 菜单控件（StaticDisplayLevels=2），我会得到：

> | 主页 | 节点 1 | 节点 2 |

是否有跳过“主页”并获取此菜单的属性（从该站点地图）：

> | 节点 1 | 节点 2 |

?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T14:16:15.380

如果您使用的是 SiteMapsDataSource，您可以通过将 ShowStartingNode 属性设置为 false 来跳过根节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T14:16:02.697

如果您还没有使用 a`SiteMapDataSource`来填充`Menu`，您可以这样做并将其`ShowStartingNode`属性设置为`false`（并且，如上面的评论中所述，将 a 递减`StaticDisplayLevels`1，因为您正在删除一个级别），如下所示：

```
<asp:SiteMapDataSource ID="MenuSource" runat="server" ShowStartingNode="false" /> 
```

当然，这只适用于根节点。要跳过其他节点或整个节点级别，有必要在填充之前对源 Xml 进行处理`Menu`（例如，使用一些 xslt 去除一类节点）。

# c# - Form.ShowDialog(IWin32Window) 应该与任何窗口句柄一起使用吗？

> ID：581855
> 
> 赞同：2
> 
> 时间：2009-02-24T14:03:55.270
> 
> 标签：c#, .net, winforms, modal-dialog, bho

使用时`System.Windows.Forms.ShowDialog(IWin32Window)`，我是否应该能够传入`IWin32Window`代表任何窗口句柄并使其相对于该窗口成为模态？

作为 Internet Explorer 7 扩展的一部分，我正在尝试打开与 Internet Explorer 选项卡相关的窗口模式。它不是当前选择的选项卡，但我可以确定选项卡的 hwnd。但是，当我将它传递给 ShowDialog 时，我的表单会显示出来，但它对于任何东西都不是模态的：我仍然可以在 Internet Explorer 中执行操作，包括在应该是所有者的选项卡中。我的表单显示在 Internet Explorer 窗口上方并停留在顶部，因此它不像只是作为普通表单打开，但它不是正确的模式。

使用[Spy++](http://msdn.microsoft.com/en-us/library/aa264396%28v=vs.60%29.aspx)，我可以找到我的表单并且它的所有者句柄设置正确。

这是否意味着出现问题，或者我做错了什么？如何使我的表单正确模态？

仅供参考，我正在使用这个包装类来创建`IWin32Window`一个`hwnd`（感谢[Ryan！](http://ryanfarley.com/blog/archive/2004/03/23/465.aspx)）：

```
/// <summary>
/// Wrapper class so that we can return an IWin32Window given a hwnd
/// </summary>
public class WindowWrapper : System.Windows.Forms.IWin32Window
{
    public WindowWrapper(IntPtr handle)
    {
        _hwnd = handle;
    }

    public IntPtr Handle
    {
        get { return _hwnd; }
    }

    private IntPtr _hwnd;
} 
```

更新：使用 Internet Explorer 7 和 .NET 2.0

更新：使用 Spy++ 及其公开的句柄进行更多尝试，我发现如果我使用不同的，`hwnd`那么我可以使我的窗口模态到选项卡：

我正在使用[IWebBrowser2.HWND doc](http://msdn.microsoft.com/en-us/library/aa752126(VS.85).aspx)`hwnd`建议的选项卡，它在 Spy++ 中显示为 class 。它有一个 class 的孩子，它有一个 Internet_Explorer_Server 的孩子。如果我使用 的那么它可以正常工作，例如，当我用鼠标单击其他选项卡时，Internet Explorer 会正常反应。当我在感兴趣的选项卡上单击鼠标时，它会播放 windows d'oh 声音并且不执行任何操作。`TabWindowClass``Shell DocObject View``hwnd``Internet Explorer_Server`

我还不知道如何以编程方式获取 Internet_Explorer_Server `hwnd`，但它应该是可能的。

此外，就其价值而言，在使用其他窗口句柄时，我通常能够使我的表单成为其他应用程序和对话框的模态。所以我想我的问题的答案是“很多但不是所有的句柄”......可能它取决于应用程序？

更新：另一个旁注：我想让我的表单模式化到选项卡而不是整个窗口的最初原因是，当`MessageBox`从我的表单打开一个，将表单作为所有者传递时，`MessageBox`不会总是在我的表单顶部打开. 如果一个新的 Internet Explorer 选项卡刚刚打开但未处于活动状态，则该`MessageBox`选项卡将被隐藏并且该选项卡将开始闪烁。但是，由于 Internet Explorer 在我的表单打开模式下被禁用，因此无法切换到该选项卡，因此 Internet Explorer 将被冻结。我认为将我的表单模式打开到选项卡可以解决这个问题，但我发现另一个解决方案是避免使用`MessageBox`：如果我使用第二个表单并且`ShowDialog(this)`从我的第一个表单开始，那么第二个表单正确打开到前面。所以它似乎`Form.ShowDialog()`比`MessageBox.Show()`在某些情况下。*[模态对话框和消息框问题](http://social.msdn.microsoft.com/Forums/en-US/ieextensiondevelopment/thread/df0fe7f2-0153-47d9-b18f-266d57ab7909)*中的更多讨论。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T15:43:00.867

ShowDialog() 做了两件重要的事情。它开始泵送消息循环，因此它以模态方式对调用代码起作用。它使用 EnableWindow(false) API 调用禁用应用程序中的任何其他窗口。后者是您的情况没有发生的事情。考虑到需要禁用的窗口不是 WF 窗口，这并不奇怪。

您可能需要自己调用 EnableWindow()。确保在对话框关闭之前重新启用它，否则 Windows 将寻找另一个应用程序的窗口以提供焦点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T14:59:16.617

你的代码是正确的。您可能遇到的问题是 IE 有一个与其选项卡相关的线程模型。我不知道确切的细节，但简短的版本是每个选项卡可以并且很可能在与其他选项卡不同的线程上运行。

对话框的模态性特定于对话框正在运行的线程。其他线程上的 UI 将不受另一个线程上的模型对话框的影响。因此，您完全有可能访问在不同线程上运行的选项卡。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-02-26T13:34:18.323

这是 Ryan/Rory 的 WindowWrapper 代码的更简洁版本：

```
internal class WindowWrapper : IWin32Window
{
    public IntPtr Handle { get; private set; }
    public WindowWrapper(IntPtr hwnd) { Handle = hwnd; }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:12:23.127

我从来没有从 IE 扩展中尝试过这个，但我有一种预感，IE 可能不会“尊重”Win32 样式的模式窗口，就像它使用 Javascript 引发的模式窗口一样`window.open().`

您是否针对 IE 以外的其他东西测试过这段代码，只是为了确认它在其他应用程序中的工作方式？

# wix - WiX 包含 vs 片段

> ID：581857
> 
> 赞同：33
> 
> 时间：2009-02-24T14:05:03.847
> 
> 标签：wix, wix3

*   `.wxi`WiX 包含（文件）和 WiX 片段（文件）有什么区别`.wxs`？
*   每个的用例是什么？
*   *应该*使用哪个，为什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-24T14:46:32.967

文件扩展名是一种方便，文件的内容才是真正重要的。这种区别使得管理实际安装（wxs 文件）和创建安装所需的属性（wxi 文件）之间的差异变得更加容易。

例如，您的 wxs 文件指定产品及其内容（您安装哪些文件），而您将使用 wxi 文件指定产品版本、升级代码、公共路径等。

WiX 文档提供了一些清晰的信息。

*   [包含文件 (.wxi)](http://wix.sourceforge.net/manual-wix2/wxi.htm)
*   [源文件 (.wxs)](http://wix.sourceforge.net/manual-wix2/wxs.htm)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-07-30T23:37:37.620

就个人而言，我只使用 .wxi 文件来包含 common `<?define?>`s。我将产品的其余部分组织成许多不同的片段逻辑分组。将片段视为典型过程语言中的函数。将类似的东西组合在一起，不要让它们太长。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-08T16:23:14.673

需要注意的一件事是，将 wxs 文件添加到您的项目意味着 MSBuild 将在您更新 wxs 文件时执行增量构建。包含 wxi 文件不会这样做。

但另一方面，当您包含在 msi 中的任何文件已更新时，MSBuild 不会进行自动构建，因此您可能无论如何都不会进行增量构建。

# c# - 如何在 C# 中强制格式化字符串的最小宽度

> ID：581859
> 
> 赞同：4
> 
> 时间：2009-02-24T14:05:25.217
> 
> 标签：c#, .net, string, formatting

我有以下声明

```
DateTime now = DateTime.Now;
string test = string.Format("{0}{1}{2}{3}", now.Day, now.Month, now.Year, now.Hour); 
```

这给了我：

```
test = "242200915" 
```

但我想要类似的东西：

```
test = "2402200915" 
```

所以问题是，如何强制字符串格式化程序输出宽度为 2 的每个 int，同时用零填充？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-24T14:07:07.913

```
DateTime now = DateTime.Now;
string test = now.ToString("ddMMyyyyHH"); 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-24T14:13:52.903

你可以用`string.Format("{0:000} {0:D3}", 7)`
得到`007 007`

这是关于 MSDN 的有用概述：[自定义数字格式字符串](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T14:09:59.870

为什么不只是做

```
String test = DateTime.Now.ToString("ddMMyyyyHH"); 
```

您可以将数字格式化为一定的宽度，但这似乎更像您想要的。

# c# - 使用 Linq to XML 创建 KML

> ID：581865
> 
> 赞同：3
> 
> 时间：2009-02-24T14:06:34.653
> 
> 标签：c#, linq, kml

大约 9 个月前，我在 C# 中创建了一组对应于 KML 2.2 元素的类。所以你可以做类似 myPlacemark = new Placemark("name"); 在内部，它使用 XmlDocument、XmlElement 等来创建各种节点和标签。这是一个记忆猪，它可能会更快。不，我没有使用 XSD 生成类。

我看到有关于使用 Linq 读取和解析 KML 的帖子。但是，有没有人使用 Linq to XML 创建 KML？如果不是，您认为创建 progammatic 的最佳方法是什么。易于使用的一组类来抽象 KML？使用 Linq to XML 会提高性能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-27T12:02:53.717

不是 KML，但这是使用 System.Xml.Serialization 的示例

给定这两个类（带有属性）和初始化：

```
[XmlRoot("BookList")]
public class BookList
{
    [XmlElement("BookData")]
    public List<Book> Books = new List<Book>();
}

public class Book
{
    [XmlElement("Title")]
    public string Title { get; set; }
    [XmlAttribute("isbn")]
    public string ISBN { get; set; }
}

var bookList = new BookList
{
    Books = { new Book { Title = "Once in a lifetime", ISBN = "135468" } }
}; 
```

您可以像这样序列化为 xml：

```
var serializer = new XmlSerializer(typeof(BookList));
using (var writer = new StreamWriter("YourFileNameHere")) 
{
    serializer.Serialize(writer, bookList); 
} 
```

与 XML 等效的 Linq 看起来像这样（未经测试）

```
XElement bookXML = 
    new XElement("BookList", 
        from book in bookList.Books
        select new XElement("BookData",
            new XElement("Title", book.Title),
            new XAttribute("isbn", book.ISBN)
        )
    ); 
```

结论，两者都比使用 XmlDocument 更干净，XmlSerializer 更短，Linq to XML 为您提供更大的灵活性（XmlSerializer 在您的类结构与 xml 结构的不同方面非常“刚性”）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-24T14:16:47.577

我没有使用过 KML，但 Linq to XML 库本质上是 System.Xml 中 XmlDocument、XmlElement 等模型的替代品。从内存的角度来看，我不知道它们是否比您当前的解决方案更好。

我经常使用的一种方法是创建一组表示 Xml 文档的数据类，然后使用 XmlSerializer 将对象转换为 Xml。我很公平，这个实现不是一个很好的记忆猪，我认为，为了你的目的，这可能是有道理的。

这是一个简单的例子。假设我要创建以下 Xml：

```
<Packages>
  <Package Name="A">

  </Package>
  <Package Name="B">
      <Dependencies>
          <Dependency Package="C" />
          <Dependency Package="A" />
      </Dependencies>
  </Package>
  <Package Name="C">
      <Dependencies>
          <Dependency Package="A" />
      </Dependencies>
  </Package>
</Packages > 
```

您可以创建以下类：

```
class Package 
{
    private List<Dependency> dependencies = new List<Dependency>();
    public string Name { get; set; }
    public List<Dependency> Dependencies { get { return dependencies; } set { dependencies = value; } }
}

class Dependency
{
    public string Package { get; set; }
} 
```

使用 System.Xml.Serialization.XmlSerializer 类，您可以将 List 转换为上面的 Xml。

因此，如果您为 KML 创建一个可以轻松映射到实际 KML 的对象模型（如上面的示例），那么它应该是一个稍微简单的实现。

# java - 如何将旧数据转换为新系统？使用 sql 或托管代码？

> ID：581868
> 
> 赞同：2
> 
> 时间：2009-02-24T14:08:12.293
> 
> 标签：java, .net, import, domain-driven-design

假设一家公司正在构建一个全新的应用程序。该应用程序遵循 DDD 原则。旧代码库有很多他们想要转换为新代码库的产品（或公司的另一个“实体”）。

这项工作应该怎么做？通常，使用例如 ssis 导入会更快、更容易——从一个数据库传输到另一个数据库。但是这里的主要问题是跳过了很多 BusinessRules（在 DomainLayer 中的托管代码中实现）......如果开发人员说：“我控制它。规则被复制为 sql 脚本.. 。”

我们是否应该将托管代码库导入 SQL Server（至少这在 .NET 和 MS SQL Server 中是可能的）？或者我们应该在托管代码中创建一个导入脚本，以便在将实体保存在数据库中时遍历域中的所有层？...（可能需要很多小时..）

你怎么认为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T14:30:14.770

我建议您在 .NET 中编写一些导入应用程序，您可以在其中应用业务规则。因为这个任务（至少我想是这样）只会运行一次（或两次;））速度并不那么重要 - 为了加快它 - 如果可能的话，将它设计为多线程。

不，这还不够好-如果有人说“我已经控制住了”-这是一个嗡嗡声，我所有的警钟都会响起。一些细节将永远被遗忘，这主要是一场小灾难；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T14:41:07.020

这两个选项并不相互排斥。SQL Server 可以使用 Web 服务。您可以将导入服务创建为 Web 服务，然后从 SQL Server 调用它。当然，您甚至可以使用 SSIS 执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T14:43:00.743

就像该联盟中的许多其他问题一样（这是解决这个问题和那个问题的最佳方法，选择哪种语言，ORM 与否）在不了解旧应用程序、新应用程序和数据的详细信息的情况下很难回答模型（关系和 OO）.... 或者简单：仔细分析您的任务，然后选择您的工具。

*   新应用程序是否会构建在新的*关系*层之上，并且具有自己的新域层，还是会保留所提到的域层？
*   我们在谈论什么样的业务规则和多少业务规则？
*   ...？

在不了解这一切的情况下，我想说：新应用程序必须遵循旧的业务规则，并且必须为域设计新的关系层。开发人员应该了解业务和域规则，并且（sql-）脚本应该是一种可行的方式。

# java - 在 Java 中处理多个构造函数的最佳方法

> ID：581873
> 
> 赞同：89
> 
> 时间：2009-02-24T14:10:22.553
> 
> 标签：java, constructor, field

我一直想知道在 Java 中处理多个构造函数的最佳（即最干净/最安全/最有效）的方法是什么？尤其是当在一个或多个构造函数中没有指定所有字段时：

```
public class Book
{

    private String title;
    private String isbn;

    public Book()
    {
      //nothing specified!
    }

    public Book(String title)
    {
      //only title!
    }

    ...     

} 
```

没有指定字段怎么办？到目前为止，我一直在类中使用默认值，以便字段永远不会为空，但这是一种“好”的做事方式吗？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2009-02-24T14:14:03.467

一个稍微简化的答案：

```
public class Book
{
    private final String title;

    public Book(String title)
    {
      this.title = title;
    }

    public Book()
    {
      this("Default Title");
    }

    ...
} 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-02-24T14:19:05.187

考虑使用 Builder 模式。它允许您设置参数的默认值并以清晰简洁的方式进行初始化。例如：

```
 Book b = new Book.Builder("Catcher in the Rye").Isbn("12345")
       .Weight("5 pounds").build(); 
```

编辑：它还消除了对具有不同签名的多个构造函数的需要，并且更具可读性。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-02-24T14:36:18.217

You need to specify what are the class invariants, i.e. properties which will always be true for an instance of the class (for example, the title of a book will never be null, or the size of a dog will always be > 0).

These invariants should be established during construction, and be preserved along the lifetime of the object, which means that methods shall not break the invariants. The constructors can set these invariants either by having compulsory arguments, or by setting default values:

```
class Book {
    private String title; // not nullable
    private String isbn;  // nullable

    // Here we provide a default value, but we could also skip the 
    // parameterless constructor entirely, to force users of the class to
    // provide a title
    public Book()
    {
        this("Untitled"); 
    }

    public Book(String title) throws IllegalArgumentException
    {
        if (title == null) 
            throw new IllegalArgumentException("Book title can't be null");
        this.title = title;
        // leave isbn without value
    }
    // Constructor with title and isbn
} 
```

However, the choice of these invariants highly depends on the class you're writing, how you'll use it, etc., so there's no definitive answer to your question.

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-02-24T17:57:18.950

您应该始终构造一个有效且合法的对象；如果你不能使用构造函数参数，你应该使用一个构建器对象来创建一个，只有在对象完成时才从构建器中释放对象。

关于构造函数的使用问题：我总是尝试使用一个所有其他构造函数都遵循的基本构造函数，将“省略”参数链接到下一个逻辑构造函数并在基本构造函数处结束。所以：

```
class SomeClass
{
SomeClass() {
    this("DefaultA");
    }

SomeClass(String a) {
    this(a,"DefaultB");
    }

SomeClass(String a, String b) {
    myA=a;
    myB=b;
    }
...
} 
```

如果这是不可能的，那么我尝试使用所有构造函数都遵循的私有 init() 方法。

并保持构造函数和参数的数量很少——每个最多 5 个作为指导。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-09-14T16:19:55.307

可能值得考虑使用静态工厂方法而不是构造函数。

我说的是，但显然你不能*替换**构造*函数。但是，您可以做的是将构造函数隐藏在静态工厂方法后面。这样，我们将静态工厂方法作为类 API 的一部分发布，但同时隐藏构造函数，使其成为私有或包私有。

这是一个相当简单的解决方案，尤其是与 Builder 模式相比（如 Joshua Bloch 的*Effective Java 2nd Edition*中所见——请注意，Gang of Four 的*设计模式*定义了一个完全不同的设计模式，名称相同，因此可能会有点混乱）意味着创建一个嵌套类、一个构建器对象等。

这种方法在您和您的客户之间增加了一个额外的抽象层，加强了封装并使更改变得更容易。它还为您提供实例控制——因为对象是在类中实例化的，所以您而不是客户端决定何时以及如何创建这些对象。

最后，它使测试更容易——提供了一个愚蠢的构造函数，它只是将值分配给字段，而不执行任何逻辑或验证，它允许您将无效状态引入系统以测试它的行为和反应方式。如果您在构造函数中验证数据，您将无法做到这一点。

您可以在（已经提到的）Joshua Bloch 的*Effective Java 2nd Edition*中阅读更多相关内容——它是所有开发人员工具箱中的重要工具，难怪它是本书第一章的主题。;-)

按照你的例子：

```
public class Book {

    private static final String DEFAULT_TITLE = "The Importance of Being Ernest";

    private final String title;
    private final String isbn;

    private Book(String title, String isbn) {
        this.title = title;
        this.isbn = isbn;
    }

    public static Book createBook(String title, String isbn) {
        return new Book(title, isbn);
    }

    public static Book createBookWithDefaultTitle(String isbn) {
        return new Book(DEFAULT_TITLE, isbn);
    }

    ... 
```

}

无论您选择哪种方式，最好有一个**主**构造函数，它只是盲目地分配所有值，即使它只是被另一个构造函数使用。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-02-24T15:56:55.527

一些通用的构造函数提示：

*   尝试将所有初始化集中在一个构造函数中，并从其他构造函数中调用它
    *   如果存在多个构造函数来模拟默认参数，这很有效
*   永远不要从构造函数调用非最终方法
    *   根据定义，私有方法是最终的
    *   多态可以在这里杀死你；您最终可以在子类初始化之前调用子类实现
    *   如果您需要“帮助”方法，请确保将它们设为私有或最终的
*   在调用 super() 时要明确
    *   你会惊讶于有多少 Java 程序员没有意识到 super() 被调用，即使你没有明确地编写它（假设你没有调用 this(...) ）
*   了解构造函数的初始化规则顺序。基本上是：

    1.  this(...) 如果存在（*只需*移动到另一个构造函数）
    2.  调用 super(...) [如果不显式，则隐式调用 super()]
    3.  （递归地使用这些规则构造超类）
    4.  通过声明初始化字段
    5.  运行当前构造函数的主体
    6.  返回之前的构造函数（如果你遇到过 this(...) 调用）

整个流程最终是：

*   一直向上移动超类层次结构到 Object
*   虽然没有完成
    *   初始化字段
    *   运行构造函数体
    *   下拉到子类

对于邪恶的一个很好的例子，试着弄清楚下面会打印什么，然后运行它

```
package com.javadude.sample;

/** THIS IS REALLY EVIL CODE! BEWARE!!! */
class A {
    private int x = 10;
    public A() {
        init();
    }
    protected void init() {
        x = 20;
    }
    public int getX() {
        return x;
    }
}

class B extends A {
    private int y = 42;
    protected void init() {
        y = getX();
    }
    public int getY() {
        return y;
    }
}

public class Test {
    public static void main(String[] args) {
        B b = new B();
        System.out.println("x=" + b.getX());
        System.out.println("y=" + b.getY());
    }
} 
```

我将添加评论，描述为什么上面的工作原理......其中一些可能是显而易见的；有些不是...

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-24T15:32:42.917

另一个考虑因素，如果字段是必需的或范围有限，请在构造函数中执行检查：

```
public Book(String title)
{
    if (title==null)
        throw new IllegalArgumentException("title can't be null");
    this.title = title;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-24T17:51:49.230

我会做以下事情：

```
公共课本
{
    私有最终字符串标题；
    私有最终字符串 isbn；

    公共书（最终字符串 t，最终字符串 i）
    {
        如果（t == 空）
        {
            throw new IllegalArgumentException("t 不能为 null");
        }

        如果（我 == 空）
        {
            throw new IllegalArgumentException("我不能为空");
        }

        标题 = t;
        isbn = 我;
    }
}

```

我在这里假设：

1）标题永远不会改变（因此标题是最终的）2）isbn永远不会改变（因此isbn是最终的）3）没有标题和isbn的书是无效的。

考虑一个学生类：

```
公开课学生
{
    私人最终学生ID；
    私人字符串名；
    私人字符串姓氏；

    公共学生（最终学生ID i，
                   最终字符串优先，
                   最后一个字符串最后）
    {
        如果（我 == 空）
        {
            throw new IllegalArgumentException("我不能为空");
        }

        如果（第一个 == 空）
        {
            throw new IllegalArgumentException("first cannot be null");
        }

        如果（最后一个 == 空）
        {
            throw new IllegalArgumentException("last 不能为 null");
        }

        身份证=我;
        名字=第一；
        姓氏 = 最后一个；
    }
}

```

必须创建一个带有 id、名字和姓氏的 Student。学生证永远不会改变，但一个人的姓氏和名字可以改变（结婚，由于输掉赌注而改变名字，等等......）。

在决定拥有哪些构造函数时，您真正需要考虑拥有什么是有意义的。人们经常添加 set/get 方法，因为他们被教导要这样做 - 但通常这是一个坏主意。

与可变类相比，不可变类（即具有最终变量的类）要好得多。这本书： http: [//books.google.com/books](http://books.google.com/books?id=ZZOiqZQIbRMC&pg=PA97&sig=JgnunNhNb8MYDcx60Kq4IyHUC58#PPP1,M1) ?id=ZZOiqZQIbRMC&pg=PA97&sig= JgnunNhNb8MYDcx60Kq4IyHUC58#PPP1,M1 (Effective Java) 对不变性进行了很好的讨论。查看第 12 和 13 项。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-24T17:53:50.957

有几个人建议添加一个空检查。有时这是正确的做法，但并非总是如此。查看这篇出色的文章，了解您为什么要跳过它。

[http://misko.hevery.com/2009/02/09/to-assert-or-not-to-assert/](http://misko.hevery.com/2009/02/09/to-assert-or-not-to-assert/)

# java - 既然可以捕获 Throwables，为什么还要在 Java 中捕获异常？

> ID：581878
> 
> 赞同：70
> 
> 时间：2009-02-24T14:11:16.780
> 
> 标签：java

我们最近遇到了一个 Java 服务器应用程序的问题，该应用程序抛出了没有被捕获的错误，因为 Error 是 Throwable 的一个单独的子类，我们只捕获了异常。

我们通过捕获 Throwables 而不是 Exceptions 解决了当前的问题，但这让我思考为什么你会想要捕获 Exceptions 而不是 Throwables，因为那样你会错过错误。

那么，**当您可以捕获 Throwables 时，为什么还要捕获 Exceptions**呢？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-02-24T14:14:59.343

来自 Java API 文档：

> 类`Exception`及其子类是一种`Throwable`表示合理应用程序可能想要捕获的条件的形式。
> 
> An`Error`是它的子类，`Throwable`它指示合理的应用程序不应尝试捕获的严重问题。

错误通常是低级别的（例如，由虚拟机引发）并且不应被应用程序捕获，因为可能无法合理地继续。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-02-24T14:29:26.610

这一切都取决于一旦你抓住了错误，你将如何处理它。一般来说，捕获错误可能不应该被视为“正常”异常流程的一部分。如果你确实抓住了一个，你不应该考虑“像什么都没发生一样继续”，因为 JVM（和各种库）将使用错误作为一种信号方式，表明“发生了非常严重的事情，我们需要尽快关闭”。一般来说，当他们告诉你末日临近时，最好听他们说。

另一个问题是是否可以从错误中恢复可能取决于特定的虚拟机，这可能是您可能控制或无法控制的。

也就是说，在某些极端情况下，捕获错误或至少某些子类是安全和/或可取的：

*   在某些情况下，您确实希望停止正常的流程：例如，如果您在 Servlet 中，您可能不希望 Servlet 运行程序的默认异常处理程序向世界宣布您遇到了 OutOfMemoryError，无论是不是你能从中恢复过来。
*   有时，如果 JVM 可以从错误原因中完全恢复，则会抛出错误。例如，如果在尝试分配数组时发生 OutOfMemoryError，至少在 Hotspot 中，您似乎可以安全地从中恢复。（当然还有其他情况可能会抛出 OutOfMemoryError ，而尝试耕作并不安全。）

所以底线是：如果你确实捕获 Throwable/Error 而不是 Exception，那么它应该是一个**明确定义的情况，你知道你正在“做一些特别的事情”**。

编辑：可能这很明显，但我忘了说在实践中，**JVM 可能实际上不会**在错误上调用你的 catch 子句。我确实看到 Hotspot 巧妙地掩盖了捕获某些 OutOfMemoryErrors 和 NoClassDefFoundError 的尝试。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-24T20:00:21.853

许多其他答案都过于狭隘地看待事物。

正如他们所说，如果您正在编写应用程序代码，则不应捕获 Throwable。您对此无能为力，因此最好让周围的系统（JVM 或框架）来处理这些问题。

但是，如果您正在编写“系统代码”，例如框架或其他低级代码，那么您可能非常希望捕获 Throwable。原因是*尝试*报告异常，可能在日志文件中。在某些情况下，您的日志记录会失败，但在大多数情况下会成功，并且您将获得解决问题所需的信息。一旦您进行了日志记录尝试，您应该重新抛出、终止当前线程或退出整个 JVM。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-24T14:15:53.650

通常错误是您无法恢复的问题，例如[OutOfMemoryError](http://java.sun.com/javase/6/docs/api/java/lang/OutOfMemoryError.html)。抓到它们也没用，所以你通常应该让它们逃跑，并关闭虚拟机。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-24T15:25:53.073

我会走一条与其他人略有不同的路线。

在很多情况下，您想要捕获 Throwable（主要是记录/报告发生了一些邪恶的事情）。

*但是*，您需要小心并重新抛出任何您无法处理的东西。

ThreadDeath 尤其如此。

如果您曾经捕获 Throwable，请务必执行以下操作：

```
try {
    ...
} catch (SomeExceptionYouCanDoSomethingWith e) {
    // handle it
} catch (ThreadDeath t) {
    throw t;
} catch (Throwable t) {
    // log & rethrow
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-24T15:32:38.690

这篇文章不会让“检查的异常很糟糕”的人高兴。但是，我的答案基于的是创建该语言的人所定义的 Java 异常是如何使用的。

快速参考图表：

*   可投掷 - 永远不要抓住这个
*   错误 - 表示 VM 错误 - 永远不要捕获这个
*   RuntimeException - 表示程序员错误 - 永远不要抓住这个
*   例外 - 永远不要抓住这个

您不应该捕获 Exception 的原因是它捕获了所有子类，包括 RuntimeException。

不应该捕获 Throwable 的原因是它捕获了所有子类，包括 Error 和 Exception。

上述“规则”有例外（没有双关语）：

*   您正在使用的代码（来自第 3 方）抛出 Throwable 或 Exception
*   您正在运行不受信任的代码，如果出现异常，可能会导致程序崩溃。

对于第二种情况，通常只需将 main、事件处理代码和带有 catch 的线程包装到 Throwable 中，然后检查异常的实际类型并适当地处理它就足够了。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-24T16:50:27.990

至少在一种情况下，我认为您可能必须捕获可抛出或通用异常 - 如果您正在运行单独的线程来执行任务，您可能想知道线程的“运行”方法是否捕获了一些例外与否。在这种情况下，您可能会执行以下操作：

```
 public void run() {
   try {
       ...
   }
   catch(Throwable t) {
       threadCompletionError = t;
   }
} 
```

我真的不确定这是否是最好的方法，但它确实有效。而且我遇到了 JVM 引发的“ClassNotFound”错误，这是一个错误而不是异常。如果我让异常被抛出，我不确定如何在调用线程中捕获它（可能有一个方法，但我还不知道）。

至于 ThreadDeath 方法，不要调用“Thread.stop()”方法。调用 Thread.interrupt 并让你的线程检查它是否被某人打断。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-24T14:47:55.053

***永远***不要捕获`Throwable`or`Error`并且您通常也不应该简单地捕获泛型`Exception`。 `Error`s 通常是最合理的程序不可能从中恢复的东西。如果您知道发生了什么，您可能能够从一个特定错误中恢复，但在这种情况下，您应该*只*捕获一个特定错误，而不是一般的所有错误。

不抓的一个很好的理由`Error`是因为[`ThreadDeath`](http://java.sun.com/javase/6/docs/api/java/lang/ThreadDeath.html). `ThreadDeath`这是一个相当正常的事件，理论上可以从任何地方抛出（其他进程，如 JVM 本身可以生成它），它的全部意义在于杀死你的线程。 `ThreadDeath`显然是 a`Error`而不是 an，`Exception`因为太多人抓住了所有`Exception`s。如果你要 catch `ThreadDeath`，你*必须*重新抛出它，这样你的线程才会真正死掉。

如果您可以控制源，则可能应该对其进行重组以抛出一个`Exception`而不是一个`Error`. 如果你不这样做，你可能应该打电话给供应商并投诉。 `Error`s 应该只保留给那些无法从它们中恢复的终端。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-24T14:20:37.693

通常在编程时，您应该只捕获特定的异常（例如`IOException`）。在很多程序中你可以看到一个非常顶级的

```
try {
    ...
} catch(Exception e) {
    ...
} 
```

这会捕获所有可以恢复的错误以及所有表明代码中存在错误的错误，`InvalidArgumentException`例如`NullPointerException`. 然后您可以自动发送电子邮件、显示消息框或任何您喜欢的内容，因为 JavaVM 本身仍然可以正常工作。

一切衍生出来`Error`的东西都是非常糟糕的，你不能做任何反对。`OutOfMemoryError`问题是，捕捉 a或 a是否有意义`VirtualMachineError`。（这是JavaVM本身的错误，可能你甚至无法显示消息框或发送电子邮件）

您可能不应该从 派生一个类`Error`，而应该从`Exception`or派生`RuntimeException`。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-24T14:30:15.813

我知道这可能违反直觉，但仅仅因为您可以捕获各种异常、Throwables 和错误并不**意味着**您应该这样做。

过度积极地捕获 java.lang.Exception 可能会导致应用程序中出现一些严重的错误——因为意外的异常永远不会冒泡，在开发/测试期间永远不会被捕获等。

最佳实践：只抓

1.  您可以处理的异常
2.  必须捕获的异常

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-24T19:48:19.420

一般来说，如果可以正确报告错误，尝试捕获错误是合理的。

但是，我相信在某些情况下捕获错误而不报告它是合适的。我指的是 UnsatisfiedLinkError。在 JAI 中，出于性能原因，该库使用一些本机库来实现大多数运算符，但是如果库无法加载（不存在、格式错误、平台不受支持），该库仍然可以运行，因为它会退回到纯 Java 模式.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-24T14:28:56.660

稍微偏离主题，但您可能还想看看[这篇](http://www.oracle.com/technology/pub/articles/dev2arch/2006/11/effective-exceptions.html)关于异常的非常好的文章。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-02-21T11:07:16.827

为什么不把他们都抓起来？然后记录它们，至少你知道你有一个错误。所以更好地捕捉 Throwable/s 而不是 Exception/s。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-02-24T19:59:15.460

**捕捉Error**没有意义。

错误用于指示您的应用程序中确实出现了问题，应该重新启动它。

例如，一个常见的错误是

```
java.lang.OutOfMemoryError 
```

发生这种情况时，您无能为力**。**已经太晚了，JVM 已经用尽了所有选项来获取更多内存，但这是不可能的。

请参阅this other answer以了解有关这[三种异常](https://stackoverflow.com/questions/462501/exception-other-than-runtimeexception/462745#462745)的更多信息。

# silverlight - 我需要哪些工具来进行 Silverlight 开发？

> ID：581900
> 
> 赞同：3
> 
> 时间：2009-02-24T14:17:25.970
> 
> 标签：silverlight

我已经拥有 Visual Studio 2008 团队版，并且订阅了 MSDN……而且我是一位经验丰富的 ASP.Net 开发人员。

我需要安装什么来进行 Silverlight 开发，并且所有这些工具都可以与我当前的“生产”开发机器一起安装（要确保不会有任何副作用）。

我知道我想学习silverlight，但我不清楚需要和/或推荐哪些工具才能开始......

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T14:20:17.133

下载 Silverlight 2.0 SDK 和 Visual Studio 2008 工具

Microsoft® Silverlight™ 2 软件开发工具包

适用于 Visual Studio 2008 SP1 的 Microsoft® Silverlight™ 工具

在这里查看链接

[http://www.microsoft.com/downloads/details.aspx?FamilyId=4E03409A-77F3-413F-B108-1243C243C4FE&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=4E03409A-77F3-413F-B108-1243C243C4FE&displaylang=en)

另一个很棒的资源是原始资源：

[http://www.asp.net/downloads/](http://www.asp.net/downloads/) 和 [http://silverlight.net/GetStarted/](http://silverlight.net/GetStarted/)

希望这会有所帮助：安德鲁 :-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T14:21:34.650

[这个链接](http://www.microsoft.com/silverlight/resources/tools.aspx)几乎有你需要的所有东西。

如果您已经熟悉 VS 开发，您可以通过下载 Microsoft Silverlight Tools for Visual Studio 2008 在 VS 中开发 Silverlight。

如果您更像是一名设计师而不是开发人员，那么 Microsoft Expression Studio 可能更适合您。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T14:22:06.270

请按照此处的步骤操作：-

[http://silverlight.net/GetStarted/](http://silverlight.net/GetStarted/)

将这些东西与我的常规开发并排使用没有问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:20:54.620

[Silverlight.net](http://silverlight.net/GetStarted/)是一个很好的起点。所有工具都已完成，因此您应该能够安装所有东西 silverlight 并且没问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T14:27:05.900

我也在尝试开始使用 Silverlight 开发。这是我开始的方式。

1.) 设置开发环境：[Silverlight 入门](http://silverlight.net/GetStarted/)

2.) 要跟上的网站。

*   [MSDN Silverlight 开发中心](http://msdn.microsoft.com/en-us/silverlight/default.aspx)
*   [Shawn Wildermuth](http://wildermuth.com/)：他已经从 ADO 人变成了 Silverlight 大师/培训师。
*   [Scott Gu 的 Silverlight 标记的故事](http://weblogs.asp.net/scottgu/archive/tags/Silverlight/default.aspx)

我的机器上安装了 Visual Studio 2003/5/8(+Resharper 4.1) 以及 silliverlight SDK 和 Expression Suite。

到目前为止，即使几个月后在我的开发机器上安装了所有这些工具，我也没有看到任何副作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T15:07:20.390

您可以使用[Silerlight Spy](http://silverlightspy.com/silverlightspy/download-silverlight-spy/)查看 Web 上任何 Silverlight 应用程序的“反映”源代码。但是，您也可以使用它来验证正在运行的应用程序中组件的结构。调试体验让我想起了在尝试破译网页的视觉结构时使用 Firebug。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-24T15:27:40.107

除了视觉工作室的东西，你可能应该得到混合和所有它的服务包。

# silverlight - SharePoint 中的 Silverlight WebPart

> ID：581908
> 
> 赞同：1
> 
> 时间：2009-02-24T14:20:51.063
> 
> 标签：silverlight, sharepoint, web-parts, file-not-found

我正在为 SharePoint 制作一个 WebPart，它将实例化 Silverlight UserControl 并为其提供一些数据。我的问题是，当我创建了我的示例 WebPart 并仅实例化 Silverlight 控件时，当 Web 部件添加到页面或显示在 Web 部件库中时，而不是呈现空白，呈现一个错误页面，显示“找不到文件”。日志文件中没有关于未找到哪个文件或引发此错误的原因的线索。这是我的代码：

```
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.SilverlightControls;

namespace TestSLWP {
  public class CustomWebPart1 : WebPart {

    protected override void CreateChildControls() {
      Label lblHello = new Label();
      lblHello.Text = "Hello";
      Controls.Add(lblHello);
      Silverlight sl = new Silverlight();
    }
  }
} 
```

我在项目中添加了对 System.Web.Extensions 和 System.Web.Silverlight 的引用。它们位于 GAC 中，并且 Web 部件是在 SharePoint 所在的同一台计算机上编写和编译的。如果我将 CreateChildControls() 更改为：

```
protected override void CreateChildControls() {
  Silverlight sl = new Silverlight();
  sl.ID = "CustomWebPart1SL";
  sl.Source = "/Silverlight/CustomWebPart.xap";
  this.Controls.Add(sl);
} 
```

我犯了同样的错误。此外，如果我删除 sl.Source 中的第一个斜杠，我会收到相同的错误，即使该文件存在于与 SharePoint 相同的应用程序池中的虚拟目录中。因此，由于仅实例化 Silverlight 对象时出现错误，因此我相信无法找到的文件不是我的 XAP。

SharePoint 找不到哪些文件，我该怎么办？

这是错误消息：

[http://www.freeimagehosting.net/uploads/2dca8dbdfb.png](http://www.freeimagehosting.net/uploads/2dca8dbdfb.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-25T15:38:32.507

嗨，我找到了有关如何让 Silverlight Web 部件在您的应用程序上运行的完整演练：[http ://www.vbforums.com/archive/index.php/t-557072.html](http://www.vbforums.com/archive/index.php/t-557072.html)

如您所见，除了程序集注册之外，web.config 中还添加了更多内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T16:04:24.870

启用 SilverLight 需要大量的 Web 配置修改。你加了那些？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-13T08:52:31.643

There could be the problem with your storage folder with silverlight control. You must register path to this storage as safe in web.config (for example find in web.config line with "~/controltemplates").

# c# - 有什么新的希望吗？使窗口成为 MDI 子项

> ID：581910
> 
> 赞同：1
> 
> 时间：2009-02-24T14:21:03.793
> 
> 标签：c#, winforms, mdi

获得了一些 C# 窗体/控件，可以从 Winforms MDI 应用程序中 Winform 上的 C# 控件或 PowerBuilder MDI 应用程序通过 COM 使用的相同 C# 控件调用。

我一直在使用 WinAPI 调用 SetParent 将表单附加到 MDI。

1.  它在两种环境中都有效（或似乎有效）。
2.  它让子窗口拥有自己的 WindowState（正常，最大化），而不是承担已经打开的子窗口的状态（这真的很痛苦）。

假设控件称为 T。控件 T 上的代码调用表单 D。

控件 T 在表单 X 上。
控件 T 也在表单 Y 上 。

在 .Net 中一切都很好，并且表格 D 保留在 MDI 中。

在 PB 中：
控制 T 在 PB 控制 PX 上。控制 T 也在 PB 控制 PY 上。

对于 PX，一切都很好。
然而，对于 PY，有一个问题 - 表格 D 似乎没有成为 MDI 子 - 它可以超出应用程序并具有任务栏图标。我强调这是使用与有效的对象*相同*的对象。SetParent 实际上是同一行代码。

进一步的研究表明，SetParent 并不*真正*适用于正确的 MDI childing——但这没关系（ish）因为我们不需要合并菜单等。

有趣的是，发现虽然 SetParent 似乎“工作”，但如果您尝试 GetParent，您将无法找回句柄......

```
Form form = new MyForm();
WindowsMessageHelper.SetParent(form.Handle, MDIParentHandle); //passed down 
int parentHandle = WindowsMessageHelper.GetParent(form.Handle); 
```

parentHandle 将始终为 0....

有没有办法让表格 D 在所有情况下都能正常工作？我自己的研究并不乐观。我真的不想回去将我的表单重写为控件并让 PowerBuilder 管理它们 - 主要是因为每个表单可以有多个实例并且 PowerBuilder 必须处理它（而不是控制器类/基类我已经在 .net 应用程序中进行操作）。

我可以强调.Net 中没有问题吗，问题只出现在 PowerBuilder 应用程序中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T17:08:56.673

最后，我们发现不同之处在于 PB 相当于为控制 PX 设置了 .MDIParent（调用表格 D 起作用的那个），而不是为 PY 设置 .MDIParent。

排序后，我们就得到了正确的 MDIParent 句柄，现在一切都很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T18:05:58.667

您的孩子需要是 System.Windows.Forms.Form，并将其 MdiParent 属性设置为 MDI 专利窗口（而不是其父窗口）。

容器还需要遵循一些规则。

通读[MSDN 上的 MDI 说明](http://msdn.microsoft.com/en-gb/library/7aw8zc76.aspx)可能会有所帮助。

* * *

选项二：您可能无法使用单个控件执行此操作。Instad 考虑在两个包装器中组合核心实现。第一个包装器作为 WinForms MDI 子级，第二个作为 COM 包装器，用于 PowerBuilder 工作的任何 GUI 框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T18:21:19.800

如果您尚未解决的唯一问题是 GetParent 不起作用，您可能可以忍受它。

编辑：但询问者有更多问题。

有许多 API poke 必须依次完成才能完成这项工作。当通过 COM 接口使用它时，将其作为用户控件并将其放置在本机 MDI 父级上或将其放置在 .NET MDI 父级中时，将其放置在 .NET MDI 子级上时，您将更容易将其设置为用户控件。

此处必须使用不同的基本窗口过程（DefWindowProc 与 DefMdiChildProc），为了完成这项工作，您最终需要实现 DefMdiChildProc。

如果您使用 .NET 反射器，您可能会找到一种方法来使 System.Windows.Forms.Form 为您调用 DefMdiChildProc。

# latex - 你如何在 LaTeX 中扩展文章文档类？

> ID：581916
> 
> 赞同：14
> 
> 时间：2009-02-24T14:23:59.853
> 
> 标签：latex, customization

我真的不需要对默认文章文档类进行大量更改。我想要的是：

*   重新定义页边距（我希望它们在所有页面上都相同，但与默认值不同）；
*   使用扉页；
*   在标题页上添加更多元素（*标题*、*作者*和*日期*对我来说还不够，我希望*公司*和公司*徽标*也出现在标题页上）；
*   更改 section 、 subsections 和 subsubsections 的样式*（*我*不*希望*显示*数字，否则 - 它们很好）。

也许，有一些软件包在这种情况下可能会有所帮助？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-25T17:41:55.907

有许多软件包可以帮助您实现所需的结果。我在下面选择的软件包是我喜欢的，但是有不止一种方法可以做到。

```
\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{paulius-article}[2009/02/25 v0.1 Paulius' modified article class]

% Passes and class options to the underlying article class
\DeclareOption*{\PassOptionsToClass{\CurrentOption}{article}}
\ProcessOptions

% Load LaTeX's article class with the `titlepage' option so that \maketitle creates a title page, not just a title block
\LoadClass[titlepage]{article}

% Redefine the page margins
% TODO: Adjust margins to your liking
\RequirePackage[left=1in,right=1in,top=1in,bottom=1in]{geometry}

% Remove the numbers from all the headings (\section, \subsection, etc.)
\setcounter{secnumdepth}{-1}

% To modify the heading styles more thoroughly use the titlesec package
%\RequirePackage{titlesec}

% Adjust the title page design
% NOTE: This is the default LaTeX title page -- free free to make it look like whatever you want.
% TODO: Add company name and logo somewhere in here.
\newcommand{\maketitlepage}{%
  \null\vfil
  \vskip 60\p@
  \begin{center}%
    {\LARGE \@title \par}%
    \vskip 3em%
    {\large
     \lineskip .75em%
      \begin{tabular}[t]{c}%
        \@author
      \end{tabular}\par}%
      \vskip 1.5em%
    {\large \@date \par}%       % Set date in \large size.
  \end{center}\par
  \@thanks
  \vfil\null%
  \end{titlepage}%
}

% This some before-and-after code that surrounds the title page.  It shouldn't need to be modified.  
% I've pulled out the part the actually typesets the title page and placed it in the \maketitlepage command above.
\renewcommand\maketitle{\begin{titlepage}%
  \let\footnotesize\small%
  \let\footnoterule\relax%
  \let \footnote \thanks%
  \maketitlepage%
  \setcounter{footnote}{0}%
  \global\let\thanks\relax
  \global\let\maketitle\relax
  \global\let\@thanks\@empty
  \global\let\@author\@empty
  \global\let\@date\@empty
  \global\let\@title\@empty
  \global\let\title\relax
  \global\let\author\relax
  \global\let\date\relax
  \global\let\and\relax
}

% TODO: If there are any other article modifications required, add them here.

% That's all, folks!
\endinput 
```

您需要阅读[几何包](http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=geometry)的文档以调整边距。如果你想修改标题的外观（除了关闭数字），可以使用titlesec[包。](http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=titlesec)

标题页是 LaTeX 的默认标题页。您需要对其进行修改以添加您的公司名称和徽标。我已经从与标题页相关的所有其他代码中分离出“要打印的东西”。您应该只需要更改`\maketitlepage`命令。在您的文档中，用于`\maketitle`打印标题页。

```
\documentclass{paulius-article}

\title{My New Document Class}
\author{Paulius}

\usepackage{lipsum}% provides some filler text

\begin{document}
\maketitle% Actually makes a title page

\section{Section Heading}
\subsection{Look no numbers!}
\lipsum[1-10]

\end{document} 
```

如果我错过了您的任何要求，请告诉我。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-24T14:34:33.650

你从

```
\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{classname}[2009/02/24]
\LoadClass{article} 
```

并在此之后添加任何自定义。

**更新：**我建议您阅读 LaTeX2e 以供类和包编写者使用：[PDF](http://www.latex-project.org/guides/clsguide.pdf)、[HTML](http://tex.loria.fr/ctan-doc/macros/latex/doc/html/clsguide/clsguide.html)。第 3 节（类或包的结构）中的示例应该会有所帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-24T14:39:31.720

有几点可能很有趣：

*   您可以重新定义页眉中的边距（即在`\begin{document}`} 之前通过重置控制长度，如`\setlength{\textwidth}{6.80in}`，`\setlength{\oddsidemargin}{0.0in}`等等。

*   `\section*{...}`已经给你未编号的部分了。对于`\subsection*`和 也是如此`\subsubsection*`。如果您确实使用了这个技巧并且还想要工作参考，您可以看看[如何在 LaTeX 中发出参考的文本内容？](https://stackoverflow.com/questions/522838/how-do-i-emit-the-text-content-of-a-reference-in-latex).

*   你看过`titlepage`环境吗？

但也许最重要的是，[回忆录课程](http://www.ctan.org/tex-archive/macros/latex/contrib/memoir/)可以为您提供所需的所有控制权，而无需任何课程黑客攻击。查看[文档](http://tug.ctan.org/tex-archive/macros/latex/contrib/memoir/memman.pdf)。

或者使用[Can Berk Güder 的建议](https://stackoverflow.com/questions/581916/how-do-you-extend-article-document-class-in-latex/581952#581952)。

# html - 我应该使用什么语言/工具进行 HTML 解析？

> ID：581920
> 
> 赞同：6
> 
> 时间：2009-02-24T14:25:14.110
> 
> 标签：html, screen-scraping, html-parsing

我有几个网站，我想从以前的经验中提取数据，这并不像听起来那么容易。为什么？仅仅是因为我必须解析的 HTML 页面格式不正确（缺少结束标记等）。

考虑到我对我可以使用的技术、语言或工具没有任何限制，**您对轻松解析和提取 HTML 页面中的数据有什么建议**？我尝试过 HTML Agility Pack、BeautifulSoup，甚至这些工具都不是完美的（HTML Agility Pack 有问题，BeautifulSoup 解析引擎不适用于我传递给它的页面）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T14:26:40.393

您可以使用几乎任何您喜欢的语言，**只是不要尝试使用正则表达式解析 HTML。**

所以让我换个说法说：你可以使用任何你喜欢的具有 HTML 解析器的语言，这几乎是过去 15 到 20 年发明的所有东西。

如果您遇到特定页面的问题，我建议您考虑使用[HTML Tidy](http://tidy.sourceforge.net/)修复它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T14:48:38.343

我认为 hpricot（由 Colin Pickard 链接）是王牌。将scrubyt添加到组合中，您将获得一个很棒的html抓取和浏览界面以及Ruby的文本匹配功能[http://scrubyt.org/](http://scrubyt.org/)

[这是来自http://github.com/scrubber/scrubyt_examples/blob/7a219b58a67138da046aa7c1e221988a9e96c30e/twitter.rb](http://github.com/scrubber/scrubyt_examples/blob/7a219b58a67138da046aa7c1e221988a9e96c30e/twitter.rb)的一些示例代码

```
require 'rubygems'
require 'scrubyt'

# Simple exmaple for scraping basic
# information from a public Twitter
# account.

# Scrubyt.logger = Scrubyt::Logger.new

twitter_data = Scrubyt::Extractor.define do
  fetch 'http://www.twitter.com/scobleizer'

  profile_info '//ul[@class="about vcard entry-author"]' do
    full_name "//li//span[@class='fn']"
    location "//li//span[@class='adr']"
    website "//li//a[@class='url']/@href"
    bio "//li//span[@class='bio']"
  end
end

puts twitter_data.to_xml 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-04T12:28:55.623

作为语言 Java 和开源库，[Jsoup](http://jsoup.org/)将是一个非常适合您的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:31:45.297

[hpricot](http://wiki.github.com/why/hpricot)可能是您正在寻找的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T14:45:57.493

你可以试试 PHP 的[DOMDocument](http://www.php.net/manual/en/book.dom.php)类。它有几种加载 HTML 内容的方法。我通常使用这个类。我的建议是在 HTML 中添加一个 DOCTYPE 元素以防它没有，并在 Firebug 中检查解析后产生的 HTML。在某些情况下，遇到无效标记时，DOMDocument 会对 HTML 元素进行一些重新排列。此外，如果有一个元标记指定源中的字符集，请注意它会在解析标记时被 libxml 内部使用。这是一个小例子

```
$html = file_get_contents('http://example.com');

$dom = new DOMDocument;
$oldValue = libxml_use_internal_errors(true);
$dom->loadHTML($html);
libxml_use_internal_errors($oldValue);

echo $dom->saveHTML(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-09T21:17:50.317

任何在 DOM 级别上使用 HTML 的语言都是好的。

对于 perl，它是 HTML::TreeBuilder 模块。

# visual-studio - 使用单个输出文件创建安装项目 (Visual Studio 2005)

> ID：581929
> 
> 赞同：2
> 
> 时间：2009-02-24T14:27:42.077
> 
> 标签：visual-studio, visual-studio-2005, installation, visual-studio-project

我正在使用 Visual Studio 2005 安装项目为我的应用程序创建安装程序。安装项目的输出是：-Setup.exe（一个引导程序，如果它不存在，则安装.Net framework）-.Net framework 文件夹（用于通过上面的.exe 安装）-我的项目的.msi 安装（由 setup.exe 调用）

我的问题是：

有什么办法可以让我安装一个 .exe（或 msi）来完成整个安装（并封装上面提到的所有功能）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T09:18:37.957

It seams that the Visual Studio installer doen't let you create a single installation file.

I finally decided to use Win-Zip self extractor to create a single installation file which extract all of the above files and run the setup.exe

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-20T06:31:25.887

我目前正在使用 Visual Studio 标准设置，然后将 exe 和 msi 与[Make SFX](http://74.cz/en/makesfx/)结合起来，因为它支持命令行（用于自动构建）并且是免费的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-12-14T17:25:53.500

[SFX Compiler](http://www.uticasoft.com/)是一个免费程序，可为您创建自解压 .exe 文件。

# javascript - Silverlight下Javascript调用C#函数

> ID：581930
> 
> 赞同：1
> 
> 时间：2009-02-24T14:28:47.190
> 
> 标签：javascript, silverlight, function

我有一个使用 C# 的 Silverlight 应用程序，其中有 2 个我想从 JavaScript 函数访问的主要函数。我已经在类中完成了 RegisterScriptableObject() 并为我想要访问的函数设置了 [ScriptableMember]。

这是 Silverlight 对象：

```
<div id="silverlightControlHost">
    <object id="silverlightControl" data="data:application/x-silverlight," type="application/x-silverlight-2" width="1024px" height="300px">
        <param name="source" value="DrawingWaveForm.xap"/>
        <param name="onerror" value="onSilverlightError" />
        <param name="background" value="white" />
        <param name="minRuntimeVersion" value="2.0.31005.0" />
        <param name="autoUpgrade" value="true" />
        <a href="http://go.microsoft.com/fwlink/?LinkID=124807" style="text-decoration: none;">
            <img src="http://go.microsoft.com/fwlink/?LinkId=108181" alt="Get Microsoft Silverlight" style="border-style: none"/>
        </a>
    </object>
    <iframe style='visibility:hidden;height:0;width:0;border:0px'></iframe>
</div> 
```

这些是我的 JavaScript 函数：

```
 function Start()
    {
        var control = document.getElementById("silverlightControl");            
        control.Content.Page.Start();
    }

    function Stop()
    {
        var control = document.getElementById("silverlightControl");            
        control.Content.Page.Stop();
    } 
```

谁能告诉我哪里出错了，因为它似乎不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T15:42:32.987

正如 timheuer 所说，在您的 Silverlight 方法上 [Scriptable]。

在你的课堂上调用这个：

```
HtmlPage.RegisterScriptableObject("Page", this); 
```

从您的 javascript 中调用标记为 Scriptable 的 Silverlight 方法，如下所示：

```
function CenterMap(latitude, longitude)
{
     var silvercontrol = document.getElementById("ctl00_cphMain_slControl");
     if (silvercontrol)
     silvercontrol.Content.Page.CenterOnCoordinates(latitude, longitude);
} 
```

[此页面](http://blogs.vertigo.com/personal/ralph/Blog/archive/2008/05/15/call-silverlight-from-javascript-call-javascript-from-silverlight.aspx)向您展示了这一点以及如何执行相反的操作，从 Silverlight 调用 javascript 方法。这是一个非常好的模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T15:37:04.513

您需要确保您的 C# 函数被标记为 Scriptable。有关如何完成此操作的一些演练，请参阅[http://silverlight.net/learn/learnvideo.aspx?video=65683 。](http://silverlight.net/learn/learnvideo.aspx?video=65683)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T15:05:38.443

这只是一个想法，但您是否可能需要公开这些方法（它们似乎不在您的代码中）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-22T22:57:07.227

我自己只是在努力解决这个问题。第一个 js 函数有效，但其他一切都会引发此错误。修补后，我注意到更改成功运行的底层 C# 函数没有任何影响——浏览器正在使用 Silverlight 控件的缓存版本。尝试清除浏览器的缓存。

# database - Entity relationship

> ID：581933
> 
> 赞同：1
> 
> 时间：2009-02-24T14:29:10.043
> 
> 标签：database

This question is a continuation to another question, also entitled [Entity Relationship](https://stackoverflow.com/questions/581719/entity-relationship).

Dejene: you should transfer the material here into the original question and then delete this question.

* * *

Elaboration: Yes, 'Field ' is referring to areas of land. We have several cane growing fields at different location. It [each field?] is named and has budget.

User is not referring to individual who are working on the machine. They are departments. I used 'isDone' table to link userDept with machine. A machine can be used by several departments and many machines can work for a userDept.

A particular machine can be used for multiple tasks on a given shift. It can work for say 2 hours and can start another task on another field. We have three shifts per day, each of 8 hrs!

If I use Auto increment PK, do you think that other key are important? I don't prefer to use it!

Usually, I use auto increment key alone in a table. How can we create relationship that involves auto increment keys? Thank you for thoughtful comment!!

Dejene

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T14:50:56.997

Relations between tables ("foreign keys") are *defined* between columns, not values. Example:

```
create table machine ( id identity );
create table owner ( id identity );
create table isDone ( machineId, ownerId ); 
```

Now you can say "`isDone.machineId` must exist in the `machine` table":

```
ALTER TABLE isDone 
  ADD CONSTRAINT machineFK 
  FOREIGN KEY (machineId) 
  REFERENCES machine (id)
; 
```

This has the effect that the database will return an error if you try to insert a row into `isDone` with a value for the column `machineId` which doesn't exist anywhere in the table `machine` (where `select Count(*) from machine where id = machineId` returns 0).

So you must separate the definition time (where you say what is valid and what is not) and the time when you manipulate the data in the database.

When you use this feature of your database, you must make sure that the machine and the owner exist at the time when you create a new row in `isDone`. This is usually simple: There are new shifts every day but no new machines and departments. So you can create new machines and departments when they are bought/founded. The first shift using one of them is probably going to happen a long time after that.

As for other keys: The auto-increment column should be the primary key (PK) of your table and nothing else. Later, you can create indexes on other column if you find that certain queries perform badly. But for starters, an auto-inc PK column should be enough. This makes it more simple to form foreign key constraints.

Example: If you would use the name of the department as the primary key, you could have problems when a department changes its name.

Also, I suggest that you use the real name of the objects (for example, "department" or "owner" instead of "user") in your design. This will make it more simple to see what is what and where to look when you search something.

# c# - 一个大字节缓冲区还是几个小的缓冲区？

> ID：581936
> 
> 赞同：2
> 
> 时间：2009-02-24T14:30:09.013
> 
> 标签：c#, networking, sockets, buffer

我正在学习 C# 异步套接字编程，并且我了解到在某种池中重用字节缓冲区是一个好主意，然后在从套接字接收数据时根据需要检查一个。

但是，我看到了两种不同的字节数组池方法：一种使用简单的队列系统，然后根据需要从队列中添加/删除它们。如果请求了一个并且队列中没有剩余，则创建一个新的字节数组。

我见过的另一种方法对整个程序使用一个大字节数组。队列的想法仍然适用，但它是一个整数队列，它确定要使用的字节数组的切片（偏移量）。如果请求了一个并且队列中没有剩余，则必须调整数组的大小。

对于高度可扩展的服务器，哪一个是更好的解决方案？我的直觉是只使用许多字节数组会更便宜，因为我想根据需要调整数组的大小（即使我们以大块的形式分配它）会非常昂贵，尤其是当它变大时。使用多个数组似乎也更直观——使用一个我没有想到的大型数组有什么好处吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-24T14:43:05.377

你的直觉是正确的。每次需要使数组更大时，您都将重新创建数组并复制现有字节。由于我们在这里讨论字节，因此数组的大小可能会很快变大。因此，您每次都会要求一块连续的内存，这取决于您的程序如何使用内存，可能可行也可能不可行。这实际上也将成为一个虚拟池，可以这么说。根据定义，池具有一组由各种客户端管理和共享的多个项目。

单一阵列解决方案实施起来也更加复杂。好消息是一个数组解决方案允许您提供可变大小的块，但这是以重新实现 malloc 为代价的：处理您不应该进入的碎片等。

多阵列解决方案允许您使用 N 数量的缓冲区初始化池，并以简单的方式轻松管理它们。绝对是我推荐的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T14:44:11.163

我不建议调整大小选项。从简单开始，一路向上。一个字节缓冲区队列在耗尽时将一个新的缓冲区添加到末尾将是一个好的开始。您可能必须注意线程问题，所以我的建议是使用其他人的线程安全队列实现。

接下来，您可以查看指向大字节数组块的更复杂的“指针”，除了我的建议是有一个 4k/16k（页面大小的两倍的幂）块的队列，您可以索引到，当它已满时，您将另一个大块添加到队列中。实际上，由于复杂性和性能上的可疑增益，我根本不推荐这样做。

从简单开始，一路向上。缓冲区池，使其线程安全，看看你是否需要更多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T14:50:01.430

对多个缓冲区再投一票，但另外，由于您正在异步执行操作，因此您需要确保您的队列是线程安全的。默认`Queue<T>`集合绝对*不是*线程安全的。

SO用户和MS员工[JaredPar](https://stackoverflow.com/users/23283/jaredpar)在这里有一个很好的线程安全队列实现：http:
[//blogs.msdn.com/jaredpar/archive/2009/02/16/a-more-usable-thread-safe-collection.aspx](http://blogs.msdn.com/jaredpar/archive/2009/02/16/a-more-usable-thread-safe-collection.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T14:58:06.730

如果您使用单个缓冲区，您需要一个策略来确定它在需要时应该以多快的速度增长。如果您以较小的增量增长它，您可能必须经常这样做并经常复制所有数据。如果您以较大的增量增长它（例如下一个大小是前一个大小的 1.5 倍），您可能会面临“内存不足”的情况，而只是试图增加缓冲区。对于可扩展系统来说，这是一个双输的选择。这就是为什么重用小缓冲区更可取的原因。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T16:01:22.023

使用垃圾收集堆，您应该始终偏爱具有较短生命周期的小型、大小合适的缓冲区。.NET 堆分配器*非常*快，第 0 代集合非常便宜。

当您保留一个静态缓冲区时，您将在程序的生命周期内耗尽系统资源。最坏的情况是当它大到可以在大对象堆中移动时，它将成为无法移动的永久障碍。

# java - Java 6 中对 xinclude 的默认支持？

> ID：581939
> 
> 赞同：9
> 
> 时间：2009-02-24T14:30:20.523
> 
> 标签：java, xml, xslt, xalan, xinclude

我在我的应用程序中看到我解析的 XML 文件中的 xinclude 在我的 Java XSLT 转换中不起作用。

但是，虽然我这样做：

```
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setXIncludeAware(true); 
```

我没有专门将变压器工厂设置为`System.getProperty("javax.xml.transform.TransformerFactory")`返回“null”。

我的问题：默认的 Java（1.6 或 6）是否支持 xinclude，或者我是否必须添加替代的 XSLT 解析器，例如 Apache Xerces？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-24T15:44:41.657

根据[规范](https://jaxp-sources.dev.java.net/nonav/docs/spec/html/)，从 Java 1.5 (5) 开始就提供支持。我相信 XInclude 支持依赖于[命名空间感知](http://java.sun.com/javase/6/docs/api/javax/xml/parsers/DocumentBuilderFactory.html#setNamespaceAware(boolean))，出于向后兼容性的原因，默认情况下它是关闭的。

```
public class XIncludeDemo {

    private static final String XML = "<?xml version=\"1.0\"?>\n"
            + "<data xmlns=\"foo\" xmlns:xi=\"http://www.w3.org/2001/XInclude\">\n"
            + "<xi:include href=\"include.txt\" parse=\"text\"/>\n"
            + "</data>\n";

    private static final String INCLUDE = "Hello, World!";

    public static void main(String[] args) throws Exception {
        // data
        final InputStream xmlStream = new ByteArrayInputStream(XML
                .getBytes("UTF-8"));
        final InputStream includeStream = new ByteArrayInputStream(INCLUDE
                .getBytes("UTF-8"));
        // document parser
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        factory.setXIncludeAware(true);
        factory.setNamespaceAware(true);
        DocumentBuilder docBuilder = factory.newDocumentBuilder();
        if (!docBuilder.isXIncludeAware()) {
            throw new IllegalStateException();
        }
        docBuilder.setEntityResolver(new EntityResolver() {
            @Override
            public InputSource resolveEntity(String publicId, String systemId)
                    throws SAXException, IOException {
                if (systemId.endsWith("include.txt")) {
                    return new InputSource(includeStream);
                }
                return null;
            }
        });
        Document doc = docBuilder.parse(xmlStream);
        // print result
        Source source = new DOMSource(doc);
        Result result = new StreamResult(System.out);
        TransformerFactory transformerFactory = TransformerFactory
                .newInstance();
        Transformer transformer = transformerFactory.newTransformer();
        transformer.transform(source, result);
    }

} 
```

# visual-studio - VS2008 宏：对解决方案中的每个代码文件执行操作

> ID：581941
> 
> 赞同：0
> 
> 时间：2009-02-24T14:30:41.693
> 
> 标签：visual-studio, macros

我最近注意到 Visual Studio 的宏是多么有趣。我已经很久没有使用VB了，所以我花了一段时间才终于写了一个小宏来在当前打开的文档上执行一些操作。

热情地，接下来我想在解决方案中的每个源代码文件 (.cs) 上使用此宏，而无需手动打开所有文件。你能给我一个关于如何做到这一点的快速提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T23:32:46.977

查看[DTE 对象](http://msdn.microsoft.com/en-us/library/aa301306(VS.71).aspx)引用。在宏中，您可以引用一些非常简洁的全局属性，例如`DTE.Solution`，它返回一个描述当前打开的解决方案的[解决方案对象](http://msdn.microsoft.com/en-us/library/aa301150(VS.71).aspx)（毫不奇怪，它有一个项目属性，它是解决方案中所有项目的集合）。那时你应该能够迭代几乎任何你想要的东西！

玩得开心 ：）

# c# - 用于更新数据的 ASP.NET 列表框

> ID：581945
> 
> 赞同：0
> 
> 时间：2009-02-24T14:31:11.710
> 
> 标签：c#, asp.net, listbox

我正在设计一个 ASP.NET 屏幕，它配置与特定类型的记录相关的屏幕。例如，汽车记录将可以访问福特和法拉利页面。我在左侧显示一个包含所有可用项目的列表框，在右侧显示一个包含当前选定项目的列表框。两个箭头图标允许您将项目从左侧列表框移动到右侧列表框，反之亦然。

我正在尝试找出一种存储所选访问权限的好方法。最简单的方法是删除所有当前选定的项目，然后从“选定项目”列表框中重新插入这些项目。但是需要更准确地审核更改，因此需要单独的插入和删除。我是否应该将原始项目存储在隐藏字段中，然后尝试将最终选择的项目与原始项目进行比较？工作应该在表示层、对象内还是存储过程中完成？

感谢您的指导，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T14:35:09.467

我不会在表示层上这样做，将新列表发送到您的业务层。在那里检索当前列表并与新列表进行比较。在此基础上进行插入和删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T14:40:07.193

如果您希望选择是持久的，您应该将它们存储在 DataLayer 中。

**业务层：** **汽车实体**和**汽车集合**

在服务器端，您可以创建包含所有（选定/未选定）项目的项目集合。

汽车实体项需要其名称、ID 和选定信息。当用户进入页面时将此集合存储在会话中并随时检查。

这是一个汽车项目：

> 汽车项目
> 
> *   ID
> *   姓名
> *   被选中

# xml - 订购不超过 10 件商品

> ID：581949
> 
> 赞同：2
> 
> 时间：2009-02-24T14:33:34.293
> 
> 标签：xml, vb.net, sorting

我正在尝试使用以下代码使用 linq 查询对 xml 进行排序

```
Dim SortedFields = From field In feedXML.Descendants("fields")
Dim sFieldList = From field In SortedFields.Descendants("field") Order By field.@position 
```

xml 如下所示，但问题是它按以下顺序 1,10,11,12,13,14...19,2,3,4,5,6,7 而不是 1,2 ,3,4,5....10,11,12,....19。

有人可以帮我按正确的顺序排序吗？

```
<fields>
    <field position="'6'" tablename="Students" headername="6" fieldreference="ClientField1" orderbydirection="ASC" displaycolumn="T" />
    <field position="'7'" tablename="Students" headername="7" fieldreference="ClientField2" orderbydirection="ASC" displaycolumn="T" />
    <field position="'8'" tablename="Students" headername="8" fieldreference="ClientField3" orderbydirection="ASC" displaycolumn="T" />
    <field position="'9'" tablename="Students" headername="9" fieldreference="ClientField4" orderbydirection="ASC" displaycolumn="T" />
    <field position="'10'" tablename="Students" headername="10" fieldreference="ClientField5" orderbydirection="ASC" displaycolumn="T" />
    <field position="'1'" tablename="Students" headername="1" fieldreference="ClientField6" orderbydirection="ASC" displaycolumn="T" />
    <field position="'2'" tablename="Students" headername="2" fieldreference="ClientField7" orderbydirection="ASC" displaycolumn="T" />
    <field position="'3'" tablename="Students" headername="3" fieldreference="ClientField8" orderbydirection="ASC" displaycolumn="T" />
    <field position="'4'" tablename="Students" headername="4" fieldreference="ClientField9" orderbydirection="ASC" displaycolumn="T" />
    <field position="'5'" tablename="Students" headername="5" fieldreference="ClientField10" orderbydirection="ASC" displaycolumn="T" />
    <field position="'11'" tablename="Students" headername="11" fieldreference="ClientField11" orderbydirection="ASC" displaycolumn="T" />
    <field position="'12'" tablename="Students" headername="12" fieldreference="ClientField12" orderbydirection="ASC" displaycolumn="T" />
    <field position="'13'" tablename="Students" headername="13" fieldreference="ClientField13" orderbydirection="ASC" displaycolumn="T" />
    <field position="'14'" tablename="Students" headername="14" fieldreference="ClientField14" orderbydirection="ASC" displaycolumn="T" />
    <field position="'15'" tablename="Students" headername="15" fieldreference="ClientField15" orderbydirection="ASC" displaycolumn="T" />
    <field position="'16'" tablename="Students" headername="16" fieldreference="ClientField16" orderbydirection="ASC" displaycolumn="T" />
    <field position="'17'" tablename="Students" headername="17" fieldreference="ClientField17" orderbydirection="ASC" displaycolumn="T" />
    <field position="'18'" tablename="Students" headername="18" fieldreference="ClientField18" orderbydirection="ASC" displaycolumn="T" />
    <field position="'19'" tablename="Students" headername="19" fieldreference="ClientField19" orderbydirection="ASC" displaycolumn="T" />
</fields> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-24T14:37:32.660

正如 Paul Tomblin 指出的，这是按字母顺序排列的。如果位置将始终是一个数字，那么您可以使用 (int?) 将其转换为整数

```
Dim SortedFields = From field In feedXML.Descendants("fields")
                            Dim sFieldList = From field In SortedFields.Descendants("field") Order By (int?)field.@position 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-24T14:41:25.303

它按字母顺序排序。您需要`position`在 Order By 子句中将该属性转换为整数：

```
Dim SortedFields = From field In feedXML.Descendants("fields")
Dim sFieldList = From field In SortedFields.Descendants("field") _
    Order By CType(field.@position, Integer) 
```

[（抱歉，如果有更好的转换可用......这是XAttribute 转换操作页面](http://msdn.microsoft.com/en-us/library/bb358993.aspx)建议的代码）

# asp.net - 我可以动态更改嵌套母版页的母版吗？

> ID：581950
> 
> 赞同：9
> 
> 时间：2009-02-24T14:33:43.480
> 
> 标签：asp.net, master-pages

好的，所以我们都知道在页面的 OnPreInit 事件中动态更改母版页。

但是嵌套母版页呢？可以换master的master吗？

MasterPage 类中没有公开 OnPreInit 事件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T14:52:38.270

刚刚对此进行了测试，它可以从使用嵌套 MasterPage 的页面的 PreInit 中工作。

```
protected void Page_PreInit(object sender, EventArgs e)
{
    this.Master.MasterPageFile = "/Site2.Master";
} 
```

显然，您需要确保 ContentPlaceholderId 在您正在交换的页面之间保持一致。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T00:20:58.190

我们将 Andy 的方法与“BasePage”类结合起来——我们创建一个继承自 System.Web.UI.Page 的类，然后我们所有的页面都继承自这个类。

然后，在我们的基页类中，我们可以执行相关检查以查看应该使用哪个根母版页——在我们的例子中，我们有一个“演示”母版和一个“创作”母版——演示版具有所有导航和页面家具，以及繁重的显示 CSS，而创作大师有一些额外的 JS 用于创作工具，更轻的 CSS，并且没有导航（这是我们在用户实际创作页面时使用的，而不是修改站点布局）。

然后，此基本页面可以调用 Page.Master.MasterPageFile 并将其设置为 Authoring master（如果这是页面的正确状态）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T08:13:39.633

以防万一有人在尝试 Andy 的代码时遇到“*内容控件必须是内容页面中的顶级控件或引用母版页的嵌套母版页*”错误而将头发扯掉的情况，请摆脱`this.Master`. 因此，代码变为：

```
protected void Page_PreInit(object sender, EventArgs e)
{
    MasterPageFile = "/Site2.Master";
} 
```

**编辑**正如 Zhaph 在下面指出的那样，我拥有的代码 ^^ 只会更改当前页面的主人，而不是主人的主人。这是 Hainesy 在提到“*我们都知道动态更改母版页*”时所说的代码（我没有，d'oh）。*如果您碰巧通过谷歌搜索“ stackoverflow 更改母版页*”（这是我所做的）到达此页面，那么这可能是您正在寻找的代码:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-16T17:31:29.007

要补充 Zhaph - Ben Duguid 的答案，（顺便说一下 +1）：

这是设置嵌套母版页的母版页的示例代码。所有页面都继承自此 BasePage，因此此代码仅存在于一处。

```
public class BasePage : System.Web.UI.Page
{
    private void Page_PreInit(object sender, System.EventArgs e)
    {
        if (Request.Browser.IsMobileDevice)
        {
            if (Page.MasterPageFile == "~/master/nested.master")) 
            {
                Page.Master.MasterPageFile = "~/master/mobile.master";
            } 
            else 
            {
                MasterPageFile = "~/master/mobile.master";
            }
        }
    }
} 
```

# c# - C# - Vista - 使用 CommonApplicationData 时虚拟化解压缩

> ID：581955
> 
> 赞同：1
> 
> 时间：2009-02-24T14:35:11.870
> 
> 标签：c#, windows-vista, compression, virtualstore

假设 UAC 为 ON。这不会产生关闭它的问题。

我有具有备份/恢复功能并使用 sql server 2005 express 的 ac# 应用程序。

获取 backupPath 的代码用于备份和还原，所有用途的名称都是 backup.dat

生成备份路径

```
string path = Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData);
 path = Path.Combine(path, "CompName");
 if(!Directory.Exists(path))
        Directory.CreateDirectory(path);
 path = Path.Combine(path, "AppName");
 if(!Directory.Exists(path))
        Directory.CreateDirectory(path);
 return path; 
```

备份时，db 在 **C:\ProgramData\CompName\AppName** 中生成 backup.dat，并且从该位置压缩到用户选择的目标目录没有任何困难。

恢复时，获取存档目录或文件没有问题，但解压缩时会转到 **C:\Users\UserName\AppData\Local\VirtualStore\ProgramData\CompName\AppName**

我需要知道为什么我的解压缩文件会进入虚拟存储，以便我可以恢复数据库，因为根据我对 vista sql server 编程的理解，不应该/将无法访问该虚拟存储路径。

编辑：未能提供减压 - 我认为这不是问题，但问题就在这里。

```
private void DecompressArchiveFile(string compressedFile, string backupPath)
{
    GZipStream gzip = new GZipStream(new FileStream(compressedFile, FileMode.Open, FileAccess.Read, FileShare.None), CompressionMode.Decompress, false);
    FileStream fs = new FileStream(backupPath, FileMode.Create, FileAccess.Write, FileShare.None);

    byte[] buffer = new byte[10000];
    int count = -1;
    while (count != 0)
    {
        count = gzip.Read(buffer, 0, 10000);
        fs.Write(buffer, 0, count);
    }
    gzip.Close();
    fs.Close();
} 
```

感谢您的所有帮助-TK

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T15:54:45.563

我认为您正在使用 Vista 虚拟化功能 - 它旨在防止旧的行为不良的应用程序无法在不允许写入 %ProgramData% 的 Vista 上运行。

您的应用程序可以从 %ProgramData% 读取但不能写入。如果您真的想在 %ProgramData% 下编写，则必须运行提升（或更改子路径上的 DACL 以让您编写）。

有关详细信息，请参阅[http://technet.microsoft.com/en-us/magazine/cc160980.aspx](http://technet.microsoft.com/en-us/magazine/cc160980.aspx)（数据重定向）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T02:58:44.470

请参阅此相关的 Stack Overflow[问题](https://stackoverflow.com/questions/131666/vista-and-programdata)，特别是来自此[答案的](https://stackoverflow.com/questions/131666/vista-and-programdata/313120#313120)[链接](http://blogs.msdn.com/cjacks/archive/2008/02/05/where-should-i-write-program-data-instead-of-program-files.aspx)：

> **FOLDERID_ProgramData / System.Environment.SpecialFolder.CommonApplicationData**
> 
> 用户永远不想在资源管理器中浏览此处，并且此处更改的设置会影响计算机上的每个用户。默认位置是 %systemdrive%\ProgramData，它是 Windows Vista 安装上的隐藏文件夹。*您需要在安装时创建目录并设置所需的 ACL。*

因此，如果您希望您的用户能够写入此文件夹，则必须在安装程序运行时授予他们适当的访问权限。

如果他们对该文件夹具有写访问权，那么我认为您不会遇到虚拟化问题。[但是，您应该通过在清单（详细信息](http://channel9.msdn.com/posts/jmazner/How-To-Tell-Vistas-UAC-What-Privelege-Level-Your-App-Requires/)）中添加类似这样的内容来真正标记您的应用程序所需的权限级别：

```
<security>
  <requestedPrivileges>
    <requestedExecutionLevel level="asInvoker" />
  </requestedPrivileges>
</security> 
```

这将禁用您的进程的虚拟化。您可以通过将“虚拟化”列添加到“查看 - 选择列...”下的“任务管理器”来查看您的进程是否正在被虚拟化。

顺便说一下， Directory.CreateDirectory() 将自动创建父目录。

# php - 提前一周从数据库中获取事件

> ID：581957
> 
> 赞同：1
> 
> 时间：2009-02-24T14:35:39.623
> 
> 标签：php, mysql, database, datetime

我目前正在开发一个体育网站，其中一个页面是即将到来的装置，用户将能够在其中了解哪支球队以及球队在哪里进行下一场比赛。

我有一个包含以下字段的数据库...

*   ID
*   团队编号
*   反对
*   场地
*   日期
*   见面时间
*   比赛类型

所以从数据库和 print_r'd 中提取的一行数据可能看起来像这样

ID=>[1] 球队号码=>[1] 对手=>[约克郡] 地点=>[主场] 日期=>[2009/4/25] 比赛时间=>[13.00] 比赛类型=>[杯赛]

我的问题是我不知道如何根据当前日期显示下一场比赛，所以例如现在我希望网站显示将在 2009 年 4 月 25 日周末发生的所有比赛，然后一次下周末的比赛已经结束了。

希望这是有道理的，有人给我一个如何解决这个问题的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T14:47:48.877

```
select * from my_events where date between now() and date_add(now(), interval 7 day); 
```

我认为应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T14:44:56.060

您可以获取系统日期（在 Oracle 中使用`sysdate`），然后添加到它，因此查找`DATE = sysdate + 7`. 您可能需要稍微尝试一下，格式化日期以便`sysdate + 7`返回没有时间的日期，但这基本上是您所需要的。

编辑：

如果您想要从现在到一周后的活动（如果比赛只在周末举行，那么这将返回下周末的比赛）

```
DATE > sysdate AND DATE <= sysdate + 7 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T14:46:55.460

### 获得 xxx 队的下一场比赛

```
SELECT * 
FROM   myTable
WHERE  TEAM NUMBER = xxx
AND    DATE = ( SELECT MIN(DATE) 
                FROM   myTable
                WHERE  TEAM NUMBER = xxx
                AND    DATE        > NOW() ) 
```

我怀疑这是你真正想要的，如果比赛只在周末进行（这似乎是你问题的一个假设）。
今天 + 7 天与下周末不同，除非今天恰好与比赛在一周中的同一天。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:48:45.863

对于 MySQL，请查看[日期和时间](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)函数。您可以使用[CURDATE()](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_curdate)和[ADDDATE()](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_adddate)的组合来实现您所需要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T14:50:39.463

您的描述非常模糊，但请尝试以下操作：

```
SELECT all_fields_you_need
FROM table_name
WHERE `DATE` > CURDATE() AND `DATE` <= DATE_ADD(CURDATE(), INTERVAL 7 DAY)
ORDER BY `DATE` ASC 
```

（未经测试，只是在我脑海中写下......）

将其全部加载到数组中并显示数据

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-24T19:26:32.840

除了完全依赖 MySQL，你还可以使用 PHP 的 strtotime() 函数：

```
$query = "select * from my_events where date between now() and ".
date("Y-m-d", strtotime("+1 week")); 
```

# javascript - 推荐的轻量气球 javascript 库

> ID：581959
> 
> 赞同：-2
> 
> 时间：2009-02-24T14:35:42.587
> 
> 标签：javascript, popup, balloon

寻找小巧轻便的弹出气球 JS 库。（不是其他库的一部分，例如 jquery）

必须是跨浏览器。

我找到了几个。有推荐的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T09:59:54.300

我喜欢这个：[JavaScript Tooltip](http://sandbox.scriptiny.com/tooltip/)。

简单、轻巧、光滑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T23:02:55.467

一个稍微复杂的：http: [//mckay.cshl.edu/balloons.html](http://mckay.cshl.edu/balloons.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-23T22:09:19.340

对于其他搜索者，一段时间后：

[http://www.acooltip.com/](http://www.acooltip.com/)

# javascript - ready-to-use xmlRequest snippet returns status code 0 on a call

> ID：581961
> 
> 赞同：0
> 
> 时间：2009-02-24T14:36:38.857
> 
> 标签：javascript, xmlhttprequest, widget, feed, dashcode

I'm creating a very basic dashcode widget. I'm using customized snippets from Apple: xmlRequest setup and xmlLoaded. Below is my code

```
function sendURL(){
    // Values you provide
    var textField = document.getElementById("searchqeue");  // replace with ID of text field
    var textFieldValue = textField.value;
    var feedURL = "feed://isohunt.com/js/rss/"+textFieldValue+"?iht=&noSL";                     // The feed to fetch

    // XMLHttpRequest setup code
    httpFeedRequest = new XMLHttpRequest();

    function loadedXML()
    {
        alert("xmlLoaded");
        if (httpFeedRequest.status == 200)
        {
            // Parse and interpret results
            // XML results found in xmlRequest.responseXML
            returnvalue = httpFeedRequest.responseText;
            alert(returnvalue);
            var textField = document.getElementById("resultarea");
            textField.value = returnvalue;
            // Text results found in xmlRequest.responseText
        }
        else
        {
            alert("Error fetching data: HTTP status " + httpFeedRequest.status);
        }
    }
    httpFeedRequest.onload = loadedXML();
    alert ("onload executed");

    //httpFeedRequest.overrideMimeType("text/html");
    httpFeedRequest.open("GET", feedURL);
    httpFeedRequest.setRequestHeader("Cache-Control", "no-cache");

    // Send the request asynchronously
    httpFeedRequest.send(null);
    alert("sent");
} 
```

I want to keep it all in one single function to keep it simple. I could ofcourse separate the xmlLoaded function and the sendURL function but for me this is clearer.

the code I get back in the error console:

> xmlLoaded (inside the loadedXML function first line)
> 
> Error fetching data: HTTP status 0 (the error message from the loadedXML function)
> 
> onload executed (the line beneath httpFeedRequest.onload = loadedXML();)
> 
> sent (the last line of the function)

Thes esnippets come with dashcode itself, so I guess the problem is with my url. This is a feed:// page instead of a html or xml page. But as feeds are xml too, I though I could just use the xmlRequest. Also, calling the same page with http:// instead of feed:// returns the same.

httpFeedRequest.responseText returns ***""*** (empty string)

httpFeedRequest.responseXML returns ***null***

any help will be more than appreciated!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-21T08:06:37.430

您现在可能已经对此进行了排序，但有几件事。httpFeedRequest.status == 200 用于 http 响应。如果您正在调用提要，那么它可能不会给出相同的数字响应。如果您使用 Safari 并进入开发人员模式，然后在您的脚本上设置一个断点并遍历它，您可以看到返回来检查这一点的响应。此外，您没有检查请求的就绪状态 - if(myRequest.readyState == 4)

就绪状态是数字；0 表示未初始化，open() 尚未被调用；1 表示加载，send() 没有被调用；2 表示已加载，已调用 send()，并且标头/状态可用；3 表示交互，responseText 保存部分数据；4 表示完成。

所以通常检查 4。

而在 httpFeedRequest.open("GET", feedURL); 您可以尝试添加 true 参数来告诉请求它是异步的 httpFeedRequest.open("GET", feedURL, true);

# sql-server - 对表进行可序列化更新的最佳方法

> ID：581962
> 
> 赞同：2
> 
> 时间：2009-02-24T14:37:16.467
> 
> 标签：sql-server, sql-server-2005

我是 Firebird 的长期用户，它有一个名为 Generators 的功能（我认为 Oracle 也有它，它被称为 Sequences）。我是 SQL Server 的新手，我需要模拟相同的功能。我不能使用身份字段来解决我的问题。我需要一系列命名的值，而不是每行的唯一数字。

我最担心的是多个用户同时调用该过程并获得重复值，因此我决定使用 SERIALIZABLE 隔离级别进行锁定。

所以我想出了这段代码（我使用的是 SQL Server 2005）：

```
CREATE TABLE dbo.GENERATORS
    (
      [NAME] VARCHAR(30) NOT NULL,
      [VALUE] INT,
      CONSTRAINT UNQ_GENERATORS_NAME UNIQUE NONCLUSTERED ( [NAME] )
    )
GO

CREATE PROCEDURE GEN_ID
    (
      @GENERATOR_NAME VARCHAR(30)
    )
AS 
    DECLARE @RETURN_VALUE INT ;
    SET NOCOUNT ON
    SET TRANSACTION ISOLATION LEVEL SERIALIZABLE
    BEGIN TRANSACTION
    UPDATE  GENERATORS
    SET     [VALUE] = [VALUE] + 1
    WHERE   [NAME] = @GENERATOR_NAME
    IF @@ROWCOUNT = 0 
        BEGIN
            INSERT  INTO dbo.GENERATORS ( [NAME], [VALUE] )
            VALUES  ( @GENERATOR_NAME, 1 )
            SET @RETURN_VALUE = 1
        END
    ELSE 
        BEGIN
            SELECT  @RETURN_VALUE = [VALUE]
            FROM    GENERATORS
            WHERE   [NAME] = @GENERATOR_NAME
        END
    COMMIT TRANSACTION
    RETURN @RETURN_VALUE
GO 
```

所以我的问题是：

*   这是一个好的解决方案吗？
*   有没有更好的办法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T15:58:25.040

而不是 UPDATE 和 SELECT，要取回您刚刚添加的值，您可以这样做

```
UPDATE  GENERATORS
SET     @RETURN_VALUE = [VALUE] = [VALUE] + 1
WHERE   [NAME] = @GENERATOR_NAME 
```

这可能会消除对隔离级别的需要

我更愿意将 @RETURN_VALUE 作为 OUTPUT 参数返回，而不是作为返回值 - 在执行期间将返回值留给任何错误代码。

# windows - Vista 环境变量中的 %TMP% 和 %TEMP% 有什么区别？

> ID：581966
> 
> 赞同：22
> 
> 时间：2009-02-24T14:37:59.820
> 
> 标签：windows, variables, temp

在我的计算机上，环境变量 %TMP% 和 %TEMP% 都指向同一个位置。

那些只是为了向后兼容问题，还是有真正的区别？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-24T15:12:48.067

这是为了兼容性。它一直回到DOS。由于没有标准，一些 DOS（和 Win 3.x）应用程序会寻找 %TMP% 环境变量，而其他应用程序会寻找 %TEMP%。如果将它们都设置在 AUTOEXEC.BAT 文件中，则最好。

Windows NT 自动设置它们，只是为了确保所有应用程序继续正常工作。%TEMP% 现在是标准，但 %TMP% 仍然存在。

编辑：看起来理查德已经在评论中提到了 DOS 方面。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-24T15:32:09.020

要完成其他答案：

[环境变量](http://en.wikipedia.org/wiki/Environment_variable#Examples_of_DOS_environment_variables)

> 在**[MS-DOS 5](http://en.wikipedia.org/wiki/Comparison_of_x86_DOS_operating_systems)** (1991-1994)中**，%TEMP% 有时会指向 C:\DOS**，因此删除 %TEMP% 中的所有文件至少会导致很大的问题。

![http://www.operating-system.org/betriebssystem/bsgfx/microsoft/msdos500-scr-01.png](https://i.stack.imgur.com/ZZqTI.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-24T14:41:10.437

我认为只是为了兼容性，正如我在从 NT 4.0 开始的 Windows 中看到的那样，这两个变量都针对相同的位置`%WinDir%\Temp\`

另外我从来没见过用`%TMP%`，每次都在说`%TEMP%`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-05-31T11:39:48.767

[Raymond Chen](https://devblogs.microsoft.com/oldnewthing/20150417-00/?p=44213)谈到了 and 的历史用途，`TMP`并`TEMP`专门谈到了 Windows：

> 无论出于何种原因，[GetTempFileName](https://docs.microsoft.com/en-us/windows/desktop/api/fileapi/nf-fileapi-gettempfilenamea)函数的原始作者都选择在查找之前先`TMP`查找`TEMP`.

本文的其余部分值得一读，以解释两者在 DOS 中的历史用途。听起来 DOS 是`TEMP`半官方的首选，而不是`TMP`.，但第三方程序员可以自由使用他们喜欢的东西，特别是考虑到 Windows 缺少标准 API 函数。

# c# - 为什么我不能在调试器中编辑包含匿名方法的方法？

> ID：581967
> 
> 赞同：19
> 
> 时间：2009-02-24T14:38:04.313
> 
> 标签：c#, debugging, visual-studio-2010, lambda, anonymous-methods

因此，每次我在一个我*不太*正确的方法中编写了一个 lambda 表达式或匿名方法时，我都不得不重新编译并重新启动整个应用程序或单元测试框架以修复它。这很烦人，而且我最终浪费的时间比我最初使用这些构造所节省的时间还要多。很糟糕，如果可以的话，我会尽量远离它们，尽管 Linq 和 lambdas 是我最喜欢的 C# 功能之一。

我想有一个很好的技术原因为什么会这样，也许有人知道？此外，有谁知道它是否会在 VS2010 中修复？

谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-24T15:15:49.777

是的，你不能这样做是有充分理由的。原因很简单，就是成本。在 C#（或 VB）中启用此功能的成本**非常**高。

编辑 lambda 函数是一类 ENC 问题的特定情况，这些问题很难用当前的 ENC (Edit'n'Continue) 架构解决。也就是说，很难对 ENC 执行以下操作之一的任何方法进行 ENC：-

1.  以类的形式生成元数据
2.  编辑或生成泛型方法

第一个问题更多是逻辑约束，但它也遇到了 ENC 架构中的一些限制。即问题是生成第一类并不是非常困难。麻烦的是在第二次编辑之后生成类。ENC 引擎必须开始跟踪符号表，不仅是实时代码，还包括生成的类。通常这不是那么糟糕，但是当生成的类的形状基于使用它的上下文时，这变得越来越困难（就像由于闭包而使用 lambdas 的情况一样）。更重要的是，您如何解决与流程中已经存在的类实例的差异？

第二个问题是 CLR ENC 架构中的严格限制。C#（或 VB）无法解决此问题。

不幸的是，Lambdas 解决了这两个问题。简短的版本是对 lambda 进行 ENC 处理涉及现有类的大量突变（可能是也可能不是从其他 ENC 生成的）。最大的问题在于解决新代码与当前进程空间中存在的现有闭包实例之间的差异。此外，与其他代码相比，lambda 更倾向于使用泛型并遇到问题 #2。

对于正常的 SO 答案，细节非常繁琐，而且有点过于复杂。我考虑过写一篇关于这个主题的长篇博文。如果我解决它，我会将它链接回这个特定的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T14:56:04.300

根据[支持的代码更改](http://msdn.microsoft.com/en-us/library/ms164927.aspx)列表，您不能将字段添加到现有类型。匿名方法被编译成奇怪命名的类（kinda `<>_c__DisplayClass1`），它们就是：类型。即使您对匿名方法的修改可能不包括更改封闭变量集（添加这些变量会改变现有类的字段），我想这就是无法修改匿名方法的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-25T16:33:55.963

VB 部分支持此功能但 C# 不支持此功能有点遗憾：http: [//msdn.microsoft.com/en-us/library/bb385795.aspx](http://msdn.microsoft.com/en-us/library/bb385795.aspx)

在 C# 中实现相同的行为将使包含 lambda 表达式的函数的痛苦程度降低 80%，在这种情况下，我们不需要修改 lambda 表达式或任何依赖于它们的表达式，而且可能不需要“巨额成本”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:50:16.000

如果那样的话，重新启动一个单元测试应该需要几秒钟。老实说，我从不喜欢“编辑并继续”模型——你应该总是从头开始重新运行 IMO，以防万一执行中途的更改会影响之前运行的代码。鉴于此，您最好使用可以快速运行的单元测试。如果您的个人单元测试开始时间难以忍受，那么您应该考虑解决这个问题。

编辑：至于为什么它不起作用-您可能会发现它适用于某些 lambda，但不适用于其他 lambda。不捕获任何变量（包括`this`）的 Lambda 表达式被缓存在私有静态变量中，因此只创建了一个委托实例。更改代码意味着重新初始化该变量，这可能会产生我怀疑的有趣副作用。

# windows - How does a windows service set off an application at a standard interval?

> ID：581975
> 
> 赞同：2
> 
> 时间：2009-02-24T14:40:27.770
> 
> 标签：windows, windows-services, srvany

A consultant setup a windows service to run a application. The application is supposed to run every 15 minutes. The application is not running at all and the service appears to be running fine.

I am not familiar with how an application will run at a standard interval when running as a service.

The service uses the SRVANY.EXE tool.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T15:00:37.003

任何设置服务以使用 SRVANY.EXE 运行的“顾问”都应该被解雇。SRVANY 是一个不幸的 hack，应该在十年前就被淘汰了。**它不应该在生产环境中使用**。

如果该服务的唯一目的是按计划运行应用程序，那么它根本不应该存在。将应用程序作为计划任务运行。如果它具有其他功能，则将其重写为真正的服务。如果它写得相当好，它应该是一个相当容易的转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T14:47:46.270

There are many potential issues with your application.

SRVANY.EXE turns any application into a Windows Service. If that application ever asks for user input, it will hang. You will want to confirm that the application running as a service does nothing more than start the other application.

You should also be able to run the "starter" application manually, outside the Windows Service. If it still doesn't work as it should you know it's not related to being run as a service.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T14:58:23.860

要添加到其他答案：请参阅[KB137890](http://support.microsoft.com/kb/137890)，了解 SRVANY.EXE 的实际作用以及如何找出它正在运行的应用程序。

在我看来，如果可以的话，您最好（如果可以的话）设置一个计划任务，该任务每 15 分钟运行一次每个应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:47:39.360

I'm not sure if this is correct, but I believe one way of a serivce running an application is merely to have a thread within OnStart and set it to run the application on an invertal of 15 minutes.

# crystal-reports - 如何根据多个布尔字段对水晶报表进行分组？

> ID：581983
> 
> 赞同：1
> 
> 时间：2009-02-24T14:42:06.893
> 
> 标签：crystal-reports, grouping

我的数据表看起来像这样（第一行 = 列名）：

> 姓名; 数字; 第 1 组；第 2 组；第 3 组；

```
Leslie; 555-555-5555; Y; N; Y;
John; 555-555-1234; N; Y; N;
Mary; 555-555-2222; Y; Y; N;
James; 555-555-3333; N; N; Y;
Sue; 555-555-4444; Y; Y; Y; 
```

我希望我的报告看起来像这样：

> 组名 1

```
 Leslie; 555-555-5555
  Mary; 555-555-2222
  Sue; 555-555-4444 
```

> 组名 2

```
 John; 555-555-1234
  Mary; 555-555-2222
  Sue;  555-555-4444 
```

> 组名 3

```
 Leslie; 555-555-5555
  James;  555-555-3333
  Sue;  555-555-4444 
```

我觉得我一定是多虑了。有人可以告诉我根据多个布尔字段对报告进行分组的最佳方法（并允许报告根据需要重复详细信息）吗？

提前致谢，

莱斯利·沃特斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T19:05:16.027

您要么必须更改您的记录源以按照您想要的方式对它们进行分组。

例子：

```
SELECT 'Group 1' as GroupName, Name, Number
FROM Table
WHERE Group1 = 'Y'

UNION

SELECT 'Group 2' as GroupName, Name, Number
FROM Table
WHERE Group2 = 'Y'

UNION

SELECT 'Group 3' as GroupName, Name, Number
FROM Table
WHERE Group3 = 'Y' 
```

**或者**

您可以为每个组创建一个子报告 - 每个子报告将选择相同的记录，但过滤它们以仅显示特定组

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T18:46:39.987

对公式进行分组。使公式成为您希望在复合键中的任何字段的串联。

# c# - C# 替换标准 Treeview？

> ID：581985
> 
> 赞同：2
> 
> 时间：2009-02-24T14:42:23.070
> 
> 标签：c#, treeview

我想找到提供的 System.Windows.Form.Treeview 的替代品。我需要以下改进：

*   多选项目
*   更好的性能（标准小部件的性能简直太糟糕了，特别是在添加一长串项目时）
*   在树视图小部件内拖放项目时滚动

我可能会忘记一些，但这些非常重要。因为我已经有一个使用标准 Treeview 的软件，所以我会考虑 API 的差异。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T14:44:11.147

作为开源替代品，[TreeViewAdv](http://sourceforge.net/projects/treeviewadv/)非常好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T14:43:53.737

[这个](http://www.codeproject.com/KB/tree/treeviewadv.aspx)怎么样？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-12T05:12:08.923

[ObjectListView](http://objectlistview.sourceforge.net)是另一种开源的可能性。

# c# - VS2005 C#：重新加载引用

> ID：581989
> 
> 赞同：0
> 
> 时间：2009-02-24T14:43:12.210
> 
> 标签：c#, visual-studio, dll, vb6

与 coryr 类似（请参阅[此问题](https://stackoverflow.com/questions/566297/force-reload-of-a-referenced-net-component-in-vs2005)），我在 C# 项目中引用了一个 dll。DLL 经常更改，但我的 C# 项目无法识别这一点。与coryr 不同，DLL 是一个VB6 ActiveX DLL。除了删除和添加之外，有关如何重新加载参考的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-24T14:55:31.977

这里的问题是，当您添加对 COM DLL 的引用时，您实际上并没有添加对 DLL 的引用。而是为 DLL 生成一个主互操作程序集，并向其中添加一个引用。更改主 DLL 时，不会生成新的 PIA（主互操作程序集）。

您可以通过执行以下操作来验证这一点

1.  展开引用集合
2.  按 F4。这将打开属性页面
3.  查看路径属性

该路径将是通往 PIA 的路径。

问题是 VS 正在监视 PIA 而不是原始 DLL。因此，当原始 DLL 发生更改时，它实际上并没有重新加载引用。让它工作的最好方法是不幸地删除并重新添加引用。

另一种解决方案是手动生成 PIA 并将其放置在磁盘上引用的 PIA 上。这将强制 VS 重新加载 DLL 引用。

# c# - 自定义控件中的 OnValidating 事件

> ID：581990
> 
> 赞同：0
> 
> 时间：2009-02-24T14:43:32.880
> 
> 标签：c#, validation

`OnValidate`事件在控件的生命周期中何时触发？

我正在创建一个`DateBox`允许用户输入 MM/DD/YYYY 格式（文本）的日期，并且需要验证日期是否采用该格式。它永远不会转换为日期（存储为字符串），但我想知道验证该数据（并提供反馈）的最佳时间。

注意：这似乎有点像重新发明轮子，但是我正在编写的应用程序被部署到平板电脑上，winforms`DateTimePicker`是用手写笔编辑的地狱，我的用户只想能够写日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T14:55:21.853

[MaskedTextBox 控件](http://msdn.microsoft.com/en-us/library/system.windows.forms.maskedtextbox.aspx)可能会对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T14:56:43.177

OnValidate 发生在 Loading 事件之后（[来源](http://msdn.microsoft.com/en-us/library/ms178472.aspx)）

您应该使用 OnValidate 或在处理表单提交时（或两者）在客户端（javascript）**和服务器端进行验证。**

# .net - Web 服务的 .NET 编码标准和框架

> ID：581994
> 
> 赞同：2
> 
> 时间：2009-02-24T14:44:04.313
> 
> 标签：.net, web-services, frameworks, coding-style

我的任务是编写编码标准文档并为 Web 服务创建框架。

我看过很多文章，但我仍然对究竟需要什么感到困惑，尤其是在开发框架时，因为它与应用程序代码完全不同。

有没有人可以推荐任何有用的技巧或书籍？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-24T14:50:21.273

查看[Brad Abrams](http://blogs.msdn.com/brada/archive/category/2656.aspx)的[框架设计指南](https://rads.stackoverflow.com/amzn/click/com/0321545613)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-24T15:32:02.670

如果您考虑框架，最好的方法是让重复的编码任务更容易、[干](http://c2.com/cgi/wiki?DontRepeatYourself)，并且如果可能的话，自动化。考虑到这一点，确定 Web 服务层中的重复性任务。也许：

*   安全？
*   从传输对象到业务对象、数据对象或其他对象的映射？
*   特殊序列化处理？
*   ...

如果您有特定的用例或服务合同，请仔细研究它们并在每个 Web 服务方法中找到您不想编码的内容。

从那开始，制定一个方案来自动化或简化服务内部的代码，更好的是，为服务消费者服务。也许：

*   一个组件，可让您通过简单的配置更改换出不同的安全方法
*   单个通用对象映射器与每次需要时都映射属性到属性。
*   一种属性方案，告诉服务如何处理特殊序列化而不是显式处理每种情况
*   ?

在推出自己的框架时，我想说最重要的是开始谦虚。不要试图成为每个人的一切，也不要试图预测每一种可能性。相反，从您知道乏味且容易出错的任务开始，并使其自动化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-24T16:22:45.357

在考虑框架时，请考虑使用其他人的框架。看看[服务工厂](http://www.codeplex.com/servicefactory "服务工厂")。它不仅是一个框架和开发方法；它也是可定制的。

# javascript - 防止 ASP.NET MVC 在 Html Helper ID 中用下划线替换句点

> ID：581998
> 
> 赞同：7
> 
> 时间：2009-02-24T14:44:27.527
> 
> 标签：javascript, jquery, asp.net-mvc, prototype

刚刚升级到最新的 ASP.NET MVC Release Candidate，我注意到，在使用 Html Helpers 时，任何带有句点“。”的名称。当输出元素的 ID 时，它将被替换为下划线“_”。

我相信这是[为了帮助使用 JQuery](https://stackoverflow.com/questions/350292/how-do-i-get-jquery-to-select-elements-with-a-period-in-their-id)而使用句号是为了帮助使用 ModelBinders。这破坏了我们所有使用原型的 javascript，因为 ID 都已更改。

有没有办法轻松关闭此功能？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-24T14:49:38.840

来自 ASP.NET MVC RC1 发行说明（第 15 页）。

> 在此版本中，默认情况下，点字符会自动替换为 ID 属性值中的下划线。因此，示例 TextBox 呈现以下标记：
> 
> `<input type="text" name="Person.FirstName" id="Person_FirstName" />`
> 
> 若要更改默认替换字符，您可以将 HtmlHelper.IDDotReplacementChar 属性设置为您要改用的字符。

供参考。查看[http://www.codeplex.com/aspnet](http://www.codeplex.com/aspnet)上的源代码，RC1 中的属性的真实名称似乎是 IdAttributeDotReplacement。相关代码片段如下。要保留点，您只需将此属性设置为点字符 - 即，将点字符替换为其自身。

```
public static string IdAttributeDotReplacement {
    get {
        if (String.IsNullOrEmpty(_idAttributeDotReplacement)) {
            _idAttributeDotReplacement = "_";
        }
        return _idAttributeDotReplacement;
    }
    set {
        _idAttributeDotReplacement = value;
    }
} 
```

# java - Anyone using JavaSpaces technology?

> ID：581999
> 
> 赞同：3
> 
> 时间：2009-02-24T14:44:41.177
> 
> 标签：java, distributed-computing, javaspaces

Are there real practical uses of JavaSpaces technology out there and how exactly is it implemented?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T14:57:50.927

我们目前正在使用 javaspaces（Sun outrigger 实现）来协调松散耦合的进程。它背后的想法令人信服，而且 API 非常简单。实际执行一直有问题。它是建立在 Jini 之上的，因此需要 5 或 6 个进程来调出一个空间。而且，至少在 Sun 的实现中，没有办法让它通过特定端口进行通信，这使得防火墙有点痛苦。

我们遇到的另一个问题是空间中没有隐含的排序。因此，如果您放入 5 个对象，并且您的读取/获取模板与所有 5 个匹配，则未指定您将获得哪一个。根据应用程序，这可能是也可能不是问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-23T20:45:31.530

[GigaSpaces](https://www.gigaspaces.com/)是 JavaSpaces 的成熟版本。它广泛用于保持安静的金融应用程序。

[至于实现，它基本上是Jini](http://java.sun.com/products/jini/)之上的事务对象数据库。查询类似于 db4o。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-21T06:23:38.547

我已经看到它在金融应用程序中使用，主要用于管理计算工作者（网格样式），其中条目从前端应用程序写入空间，并通过匹配显示需要工作的字段由工作者提取。结果可以写回空间，触发`notify`由前端应用程序注册，然后读回完成的工作。

对于计算工作者来说没关系，但是缺少排序可能对您来说是个问题（如果只是因为不可预测性） - 某些实现具有强制执行 FIFO 排序的功能。它也被用于长期数据存储，因为它是持久的，但我认为这不是一个好主意。管理工具不足以使其易于管理，并且由于数据量而导致性能受到影响。

使用了Dan Creswell 的[Blitz JavaSpaces](http://www.dancres.org/blitz/)实现——它有很多特性（可以在瞬态或持久模式下运行），被设计成健壮的（带有事务日志记录）并保持高性能，并且非常可调。与其他 Jini 服务一样，您可以配置“导出器”以使其侦听特定端口以使防火墙更容易 - SSL 传输和完整的 PKI 也被使用，并且通过 Jini 的通信抽象来实现。

我认为 Gigaspaces 是唯一通过以多种方式扩展规范而继续创新的实现，这很高兴看到。他们使其适用于各种用例，并增加了集群和高可用性等实现特性。不过使用它会让我担心，因为我会更高兴在社区中看到这些功能的两个或多个实现，因为 Gigaspaces 是相当专有的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-23T20:37:20.003

几年前我用过它，但它可能没有太大变化。

@Keith：（过去至少）可以在单个进程/JVM 中启动所有服务，我认为那里有关于如何执行此操作的文档。

我相信 Jini/Javaspaces 在欧洲的一些大型应用程序（票务、手机等）中使用。GE Aircraft 也将其用于研究和分析。

[Texas Tech 的SORCER 实验室](http://www.cs.ttu.edu/~sorcer/)有一个构建在 Jini/Javaspaces 之上的大型 SOA 架构，您也许可以在那里找到一些帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-24T15:20:07.723

我相信酒店预订系统 Orbitz 在 Jini 上运行。

基于 Java Posse[第 82](http://javaposse.com/index.php?post_id=131159)集、第 84 集和第 86 集，这是对 Vin Simmons 的采访，该技术有时用于军事或金融应用程序，这些应用程序在安静时很不幸。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-14T19:31:04.220

目前我还不知道 JavaSpaces 的任何新用法。对于分布式计算，大多数大型系统都是使用内存数据网格技术或分区的类似 NoSQL 的解决方案构建的。（我看到很多 Oracle Coherence 被使用，但这可能是因为我使用它。）

*为了全面披露，我在 Oracle 工作。这篇文章中表达的观点和观点是我自己的，并不一定反映我雇主的观点或观点。****************