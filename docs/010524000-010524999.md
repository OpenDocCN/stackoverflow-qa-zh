# StackOverflow 问答 10524000-10524999

# iphone - 在 iOS 应用上绘制错误

> ID：10524001
> 
> 赞同：0
> 
> 时间：2012-05-09T21:00:53.217
> 
> 标签：iphone, objective-c, ios5, drawing

我正在开发一个 iOs 5 应用程序，您可以在其中在主视图的子视图内的 UIImageView 上进行绘制。当您绘制线条的前 30 像素时，不会跟随您的笔划。但真正罕见的是，如果您调整 ImageView 的大小并将其设置为所有屏幕 460x320 的大小（尽管您看不到完整的 ImageView，因为它比它所在的视图大。）它工作正常。所以也许有一个解决方案。那是我的代码：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {   
    mouseSwiped = NO;
    UITouch *touch = [touches anyObject];

    if ([touch tapCount] == 2) {
        drawImage.image = nil;
        return;
    }

    lastPoint = [touch locationInView:self.view];
    lastPoint.y -= 10;
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    mouseSwiped = YES;
    UITouch *touch = [touches anyObject];   
    CGPoint currentPoint = [touch locationInView:self.drawImage];
    currentPoint.y -= 10; // only for 'kCGLineCapRound'
    UIGraphicsBeginImageContext(self.drawImage.frame.size);

    [drawImage.image drawInRect:CGRectMake(0, 0, drawImage.frame.size.width, drawImage.frame.size.height)]; //originally self.frame.size.width, self.frame.size.height)];
    CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound); //kCGLineCapSquare, kCGLineCapButt, kCGLineCapRound
    CGContextSetLineWidth(UIGraphicsGetCurrentContext(), 5); // for size
    CGContextSetRGBStrokeColor(UIGraphicsGetCurrentContext(), 0.0, 1.0, 0.0, 1.0); //values for R, G, B, and Alpha
    CGContextBeginPath(UIGraphicsGetCurrentContext());
    CGContextMoveToPoint(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y);
    CGContextAddLineToPoint(UIGraphicsGetCurrentContext(), currentPoint.x, currentPoint.y);
    CGContextStrokePath(UIGraphicsGetCurrentContext());
    drawImage.image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    lastPoint = currentPoint;

    mouseMoved++;

    if (mouseMoved == 10) {
        mouseMoved = 0;
    }
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {      
    UITouch *touch = [touches anyObject];

    if ([touch tapCount] == 2) {
        drawImage.image = nil;
        return;
    }
    if(!mouseSwiped) {
        //if color == green
        UIGraphicsBeginImageContext(self.drawImage.frame.size);
        [drawImage.image drawInRect:CGRectMake(0, 0, drawImage.frame.size.width, drawImage.frame.size.height)]; //originally self.frame.size.width, self.frame.size.height)];
        CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound); //kCGLineCapSquare, kCGLineCapButt, kCGLineCapRound
        CGContextSetLineWidth(UIGraphicsGetCurrentContext(), 5);
        CGContextSetRGBStrokeColor(UIGraphicsGetCurrentContext(), 0.0, 1.0, 0.0, 1.0);
        CGContextMoveToPoint(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y);
        CGContextAddLineToPoint(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y);
        CGContextStrokePath(UIGraphicsGetCurrentContext());
        CGContextFlush(UIGraphicsGetCurrentContext());
        drawImage.image = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();
    }
} 
```

![这就是我得到的](../Images/8057fecaa7db99e06d71a45fa27efaa7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T07:20:24.530

问题是第一个`touchesMoved:`被 API 延迟了。我不确定是否有人能够解决这个问题。

[请在https://feedbackassistant.apple.com/](https://feedbackassistant.apple.com/)提交错误报告

不过，在您的情况下，真正的问题是一个简单的错误：您在 和 中使用了两个不同的坐标`touchesBegan:`系`touchesMoved:`。

接触开始：

```
lastPoint = [touch locationInView:self.view];
                                 ////////// 
```

感动：

```
CGPoint currentPoint = [touch locationInView:self.drawImage];
                                            /////////////// 
```

# c++ - C++ 使用 send_to 提升 unix 域套接字

> ID：10524003
> 
> 赞同：3
> 
> 时间：2012-05-09T21:00:59.640
> 
> 标签：c++, ipc, boost-asio

我正在尝试编写一个非常简单的 unix 域数据报客户端/服务器。

这是python服务器：

```
import socket,os

s = socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM)
try:
    os.remove("/tmp/socketname")
except OSError:
    pass
s.bind("/tmp/socketname")
while 1:
    data = s.recv(1024)
    print data

conn.close() 
```

这是一个 python 客户端，它似乎可以在服务器上正常工作

```
import socket
import time

sock = socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM)
sock.sendto('Hello, world', "/tmp/socketname")
sock.close() 
```

本练习的目的是使用 boost::asio 网络库，python 代码只是通过一个简单的客户端来简化服务器，以证明（-ish）服务器正在工作。

我在使用 C++ 客户端时遇到了一些问题：

```
#include <boost/asio.hpp>

int
main(void)
{
    const pid_t pid = getpid();
    boost::asio::io_service my_service;
    const boost::asio::local::datagram_protocol::endpoint ep("/tmp/socketname");
    boost::asio::local::datagram_protocol::socket my_sock(my_service);

    //my_sock.connect(ep);
    //my_sock.send(boost::asio::buffer(&pid, sizeof(pid)));
    my_sock.send_to(boost::asio::buffer(&pid, sizeof(pid)), ep);

    return 0;
} 
```

如果我注释掉使用连接/发送的 2 行，似乎可以工作。但是使用 send_to 的行失败并出现以下错误。

在抛出 'boost::exception_detail::clone_impl >' 的实例后调用终止 what(): Bad file descriptor Aborted

感谢您提供的所有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:09:15.317

您从未通过调用`open()`或任何其他自动打开套接字的方法（例如`connect()`.

```
int
main(void)
{
    const pid_t pid = getpid();
    boost::asio::io_service my_service;
    const boost::asio::local::datagram_protocol::endpoint ep("/tmp/socketname");
    boost::asio::local::datagram_protocol::socket my_sock(my_service);

    //my_sock.connect(ep);
    //my_sock.send(boost::asio::buffer(&pid, sizeof(pid)));
    my_sock.open();
    my_sock.send_to(boost::asio::buffer(&pid, sizeof(pid)), ep);

    return 0;
} 
```

# php - 为什么在使用许多等待响应的 CURL 请求时我的 CPU 很高？

> ID：10524004
> 
> 赞同：1
> 
> 时间：2012-05-09T21:01:02.570
> 
> 标签：php, curl, apache, curl-multi

我有一个大型 php 脚本，它使用 curl 和 multi-curl 对我自己的服务器和其他服务器的请求。除此之外，它在我自己的服务器上执行许多数据库请求和其他操作。

脚本太大，无法放在这里，不会让事情变得更容易。

我测量了整个剧本的时间。我区分了自己服务器上的操作和外部服务器上的操作所需的时间。

看来，将我自己服务器上所有操作的经过时间加起来不会超过 0.5 秒。因此，我希望我自己的脚本对我的服务器来说不会很重。总经过时间平均为 25 秒。

大多数时间：24.5 秒我的服务器正在等待来自外部服务器的响应。我的服务器确实发出了大约 300 个 curl 请求，但是 curl 请求本身并不重。

**问题：** 当我运行脚本时，cpu 达到 95%，只要这个脚本正在运行，服务器（几乎）就不会响应其他请求。

这是一个多卷曲请求的示例：

```
<?PHP
// Multi curl:
$imax=20;
// build the individual requests as above, but do not execute them
for ($i=1; $i<$imax; $i ++ ):
${'ch_'.$i} = curl_init('http://www.domain.com/');
//$ch_2 = curl_init('http://www.domain.com/');
curl_setopt(${'ch_'.$i}, CURLOPT_RETURNTRANSFER, true);
//curl_setopt($ch_2, CURLOPT_RETURNTRANSFER, true);
endfor;

// build the multi-curl handle, adding both $ch
$mh = curl_multi_init();
for ($i=1; $i<$imax; $i ++ ):
curl_multi_add_handle($mh, ${'ch_'.$i});
endfor;

// execute all queries simultaneously, and continue when all are complete
$running = null;
do {
curl_multi_exec($mh, $running);
} while ($running);

// all of our requests are done, we can now access the results
for ($i=1; $i<$imax; $i ++ ):
${'response_'.$i} = curl_multi_getcontent(${'ch_'.$i});
endfor;
//$response_2 = curl_multi_getcontent($ch_2);

for ($i=1; $i<$imax; $i ++ ):
echo "${'response_'.$i}"; // same output as first example
endfor
?> 
```

httpd.conf：

```
#
# This is the main Apache HTTP server configuration file.  It contains the
# configuration directives that give the server its instructions.
# See <URL:http://httpd.apache.org/docs/2.2> for detailed information.
# In particular, see 
# <URL:http://httpd.apache.org/docs/2.2/mod/directives.html>
# for a discussion of each configuration directive.
#
# Do NOT simply read the instructions in here without understanding
# what they do.  They're here only as hints or reminders.  If you are unsure
# consult the online docs. You have been warned.  

ServerRoot "/etc/httpd"
Listen 80

#LoadModule dummy_module /usr/lib/apache/mod_dummy.so
#LoadModule php5_module        /usr/lib/apache/libphp5.so
Include /etc/httpd/conf/extra/httpd-phpmodules.conf

User apache
Group apache

KeepAlive On
KeepAliveTimeout 10

ServerAdmin admin@localhost
DocumentRoot "/var/www/html"

MaxClients 10000
MaxRequestsPerChild 50000

<Directory /home/*>
    AllowOverride All
    Options -MultiViews -Indexes FollowSymlinks IncludesNoExec +Includes
<Limit GET POST OPTIONS PROPFIND>
    Order allow,deny
    Allow from all
</Limit>
<LimitExcept GET POST OPTIONS PROPFIND>
    Order deny,allow
    Deny from all
</LimitExcept>
</Directory>

<Directory />
    Options All
    AllowOverride All
</Directory>

<Directory "/var/www/html">
    Options Indexes FollowSymLinks
    AllowOverride All
    Order allow,deny
    Allow from all
   <IfModule mod_suphp.c>
        suPHP_Engine On
        suPHP_UserGroup webapps webapps
    SetEnv PHP_INI_SCAN_DIR
   </IfModule>
</Directory>

<IfModule mod_dir.c>
    DirectoryIndex index.html index.htm index.shtml index.php index.php5 index.php4 index.php3 index.phtml index.cgi
</IfModule>

<FilesMatch "^\.ht">
    Order allow,deny
    Deny from all
    Satisfy All
</FilesMatch>

ErrorLog /var/log/httpd/error_log
LogLevel warn

#replace %b with %O for more accurate logging
<IfModule mod_logio.c>
    LogFormat "%h %l %u %t \"%r\" %>s %O \"%{Referer}i\" \"%{User-Agent}i\"" combined
    LogFormat "%h %l %u %t \"%r\" %>s %O" common
    LogFormat "%O %I" bytes
    LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %I %O" combinedio
</IfModule>

    CustomLog /var/log/httpd/access_log common

<IfModule mod_alias.c>
    # Include some DirectAdmin alias
    Include conf/extra/httpd-alias.conf
</IfModule>

<Directory "/var/www/cgi-bin">
    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
</Directory>

DefaultType text/plain

<IfModule mod_mime.c>
    TypesConfig conf/mime.types
    AddType application/x-gzip .tgz
    AddEncoding x-compress .Z
    AddEncoding x-gzip .gz .tgz
    AddType application/x-compress .Z
    AddType application/x-gzip .gz .tgz
    AddHandler cgi-script .cgi
    AddHandler type-map var
    AddType text/html .shtml
    AddOutputFilter INCLUDES .shtml
    AddType video/x-ms-asf .avi
    AddType video/mpeg .mpg
    AddType video/mpeg .mpeg
    AddType video/quicktime .mov
    AddType video/x-ms-wmv .wmv
</IfModule>

#EnableMMAP off
#EnableSendfile off

#######################################################################################
# Do not change anything in included files, because they are rewritten by DirectAdmin #
#######################################################################################

# This is needed for PHP
Include conf/extra/httpd-php-handlers.conf

# Server-pool management (MPM specific)
Include conf/extra/httpd-mpm.conf

# Multi-language error messages
Include conf/extra/httpd-multilang-errordoc.conf

# Fancy directory listings
Include conf/extra/httpd-autoindex.conf

# Language settings
Include conf/extra/httpd-languages.conf

# User home directories
#Include conf/extra/httpd-userdir.conf

# Real-time info on requests and configuration
Include conf/extra/httpd-info.conf

# Virtual hosts
Include conf/extra/httpd-vhosts.conf

# Local access to the Apache HTTP Server Manual
#Include conf/extra/httpd-manual.conf

# Distributed authoring and versioning (WebDAV)
Include conf/extra/httpd-dav.conf

# Various default settings
Include conf/extra/httpd-default.conf

# Secure (SSL/TLS) connections
Include conf/extra/httpd-ssl.conf

# Deflate module settings
Include conf/extra/httpd-deflate.conf

# All the DirectAdmin vhosts
Include conf/extra/directadmin-vhosts.conf

# All suPHP directives
Include conf/extra/httpd-suphp.conf

# For user configurations not maintained by DirectAdmin. Empty by default.
Include conf/extra/httpd-includes.conf

#######################################################################################
# End of included files that are rewritten by DirectAdmin                             #
#######################################################################################

<IfModule mod_ssl.c>
SSLRandomSeed startup builtin
SSLRandomSeed connect builtin
</IfModule> 
```

**我的问题：** 如何更好地配置我的服务器以防止过载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:30:30.667

只是一个猜测：curl-multi-exec 返回一个您可以（并且应该）在 while 块中检查的值

```
do {
    $mrc = curl_multi_exec($mh, $active);
} while ($active && $mrc == CURLM_CALL_MULTI_PERFORM); 
```

如 PHP 文档中所述

# apache-flex - 在 Flex 3 的渲染器中如何测量 mx:Canvas？

> ID：10524005
> 
> 赞同：0
> 
> 时间：2012-05-09T21:01:08.997
> 
> 标签：apache-flex, flex3

我遇到了位于 HBox 内的画布的尺寸问题。似乎“_graphic”、“_border”和“_fill”画布（在 com.example.ThingRenderer.mxml 中）没有与渲染器内的所有其他测量值同时进行测量。但是，此问题仅在第一次通过时观察到。请参阅图像以获得视觉效果... 第一张图像显示了应用程序完成加载后的状态。`Populate`第二张图片代表点击按钮后屏幕的样子。第三张图片显示了当步进器增加时会发生什么。问题是，如何将数据填充到表格中后，第三张图像中的绘图不会被渲染？

渲染器测试.mxml

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"
    layout="absolute"
    creationComplete="handleCreationComplete(event)"
>
    <mx:Script>
        <![CDATA[
            import com.example.Thing;

            import mx.collections.ArrayCollection;
            import mx.events.FlexEvent;
            import mx.events.NumericStepperEvent;

            private const _thingProvider:ArrayCollection = new ArrayCollection();
            private var _thing1:Thing;

            protected function handleCreationComplete(event:FlexEvent):void {
                _thing1 = new Thing("thingy", 0xff0000, 0.3);
                _stepper.value = _thing1.ratio;
            }

            protected function handlePopulateClick(event:MouseEvent):void {
                _thingProvider.addItem(_thing1);
            }

            protected function handleStepperChange(event:NumericStepperEvent):void {
                _thing1.ratio = event.value;
            }

        ]]>
    </mx:Script>
    <mx:VBox>
        <mx:Button label="Populate" click="handlePopulateClick(event)" />
        <mx:NumericStepper id="_stepper" minimum="0" maximum="1" stepSize="0.01" change="handleStepperChange(event)" />
        <mx:AdvancedDataGrid dataProvider="{_thingProvider}" variableRowHeight="true" width="100%" height="100%">
            <mx:columns>
                <mx:AdvancedDataGridColumn headerText="Name" dataField="name" />
                <mx:AdvancedDataGridColumn headerText="Display"
                    width="150" sortable="false"
                    itemRenderer="com.example.ThingRenderer"
                />
            </mx:columns>
        </mx:AdvancedDataGrid>
    </mx:VBox>
</mx:Application> 
```

com.exampleThingRenderer.mxml

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas
    xmlns:mx="http://www.adobe.com/2006/mxml"

    width="100%"
    horizontalScrollPolicy="off" verticalScrollPolicy="off"
>
    <mx:Script>
        <![CDATA[
            import mx.binding.utils.ChangeWatcher;

            private var _thing:Thing;
            private var _ratioWatcher:ChangeWatcher;

            private var _doClearContent:Boolean;
            private var _doDrawBorder:Boolean;
            private var _doUpdateFill:Boolean;

            override public function set data(value:Object):void {
                if(value && value is Thing) {
                    _thing = Thing(value);
                    if(_ratioWatcher) {
                        _ratioWatcher.unwatch();
                    }
                    _ratioWatcher = ChangeWatcher.watch(_thing, "ratio", handleRatioChanged);

                    _doClearContent = false;
                    _doDrawBorder = true;
                    _doUpdateFill = true;
                    _graphic.invalidateSize();
                    _border.invalidateSize();
                }
                else {
                    _doClearContent = true;
                    _doDrawBorder = false;
                    _doUpdateFill = false;
                }
                super.data = value;
            }

            private function handleRatioChanged(event:Event):void {
                _doUpdateFill = true;
                invalidateDisplayList();
            }

            override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void {
                if(_doClearContent) {
                    _container.visible = false;
                    _container.includeInLayout = false;
                    _doClearContent = false;
                }

                super.updateDisplayList(unscaledWidth, unscaledHeight);

                if(_doDrawBorder) {
                    trace("_thingContainer.width="+_container.width, "_thingGraphic.width="+_graphic.width, "_thingBorder.width="+_border.width);
                    _border.graphics.clear();
                    _border.graphics.moveTo(0, 0);
                    _border.graphics.lineStyle(1, _thing.color);
                    _border.graphics.lineTo(_border.width, 0);
                    _border.graphics.lineTo(_border.width, _border.height);
                    _border.graphics.lineTo(0, _border.height);
                    _border.graphics.lineTo(0, 0);

                    _doDrawBorder = false;
                }

                if(_doUpdateFill) {
                    _percentage.text = Math.round(_thing.ratio * 100.0) + "%";
                    _fill.graphics.clear();
                    _fill.graphics.beginFill(_thing.color);
                    _fill.graphics.drawRect(0, 0, _fill.width * _thing.ratio, _fill.height);

                    _doUpdateFill = false;
                }
            }
        ]]>
    </mx:Script>

    <mx:HBox id="_container" width="100%" paddingLeft="5" paddingTop="5" paddingRight="5" paddingBottom="5">
        <mx:Label id="_percentage" width="45" />
        <mx:Canvas id="_graphic" width="100%" height="15">
            <mx:Canvas id="_border" x="0" y="0" width="100%" height="100%" />
            <mx:Canvas id="_fill" x="0" y="0" width="100%" height="100%" />
        </mx:Canvas>
    </mx:HBox>
</mx:Canvas> 
```

com.example.Thing.as

```
package com.example {
    public class Thing {
        [Bindable] public var name:String;
        [Bindable] public var color:uint;
        [Bindable] public var ratio:Number;

        public function Thing(name:String, color:uint, ratio:Number) {
            this.name = name;
            this.color = color;
            this.ratio = ratio;
        }
    }
} 
```

![应用程序完成加载后的初始外观](../Images/e5f07688ef4a9e35638dfd0b35e32123.png)

![单击填充按钮后](../Images/e254f8528f6db9a4cdb084921dbeba8e.png)

![步进器从 0.30 增加到 0.40 后](../Images/1cf8d953842bbd0ea6f6941f98047a0e.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T14:31:30.733

这一切的发生是因为你不能在 updateDisplayList 中使用 width 和 height 属性，它们还没有更新。制作单独的组件（例如 ThingProgressBar）并将绘图逻辑放入其中，这将解决所有问题：

```
package
{
import mx.core.UIComponent;

public class ThingProgressBar extends UIComponent
{
    private var _ratio:Number;
    public function get ratio():Number
    {
        return _ratio;
    }
    public function set ratio(value:Number):void
    {
        _ratio = value;
        invalidateDisplayList();
    }

    override protected function updateDisplayList(
                     unscaledWidth:Number, unscaledHeight:Number):void
    {
        super.updateDisplayList(unscaledWidth, unscaledHeight);
        graphics.clear();
        if (unscaledWidth > 0 && unscaledHeight > 0)
        {
            graphics.lineStyle(1, 0xFF0000);
            graphics.drawRect(0, 0, unscaledWidth, unscaledHeight);

            graphics.beginFill(0xFF0000);
            graphics.drawRect(0, 0, unscaledWidth * ratio, unscaledHeight);
            graphics.endFill();
        }
    }
}
} 
```

所以你的渲染器可能看起来像这样：

```
<mx:HBox
xmlns:fx="http://ns.adobe.com/mxml/2009" 
xmlns:mx="library://ns.adobe.com/flex/mx"
horizontalScrollPolicy="off" verticalScrollPolicy="off" xmlns:local="*"
>
<fx:Script>
    <![CDATA[
        [Bindable] private var _thing:Thing;

        override public function set data(value:Object):void
        {
            _thing = value as Thing;
            super.data = value;
        }
    ]]>
</fx:Script>

<mx:HBox width="100%"
             paddingLeft="5" paddingTop="5"
             paddingRight="5" paddingBottom="5">
    <mx:Label text="{_thing.name}" width="45" />
    <local:ThingProgressBar width="100%" height="15"
                                    ratio="{_thing.ratio}"/>
</mx:HBox>
</mx:HBox> 
```

1.  我删除了观察者。通过观察者绑定被认为是一种不好的做法，请改用 mxml 绑定或事件。
2.  我删除了两个带有分离边框和填充的画布 - 它们可以组合在一起。
3.  我使用 UIComponent 而不是 Canvas。除非您需要布局，否则不要使用容器，它们很重。
4.  我在渲染器中使用 HBox 而不是 Canvas，因为我更喜欢盒子 :) 但是如果您需要自定义样式，则无法避免在渲染器中使用第二个容器，因为 List 会覆盖渲染器的样式表。

# asp.net - asp.net treeview的截止线

> ID：10524009
> 
> 赞同：1
> 
> 时间：2012-05-09T21:01:54.923
> 
> 标签：asp.net, treeview

我有一个 ASP.NET TreeView，当我定义它的样式时需要将 ShowLine 设置为“true”。但是，树视图的线条将被截断。我试过[这个教程](http://blogs.msdn.com/carloc/archive/2007/05/23/broken-line-in-asp-net-2-0-treeview-in-ie-7.aspx)，但没有帮助。

```
.tree
{
      font-size: 40px;
      height: 40px !important;
 }

<asp:TreeView ID="TreeView1" runat="server" ShowLines="True" CssClass="tree">
    <Nodes>
            <asp:TreeNode Text="test1" Value="1">
                <asp:TreeNode Text="test1.1" Value="11"></asp:TreeNode>
            </asp:TreeNode>
            <asp:TreeNode Text="test2" Value="2">
                <asp:TreeNode Text="test2.1" Value="21"></asp:TreeNode>
            </asp:TreeNode>
        </Nodes>
    </asp:TreeView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:37:56.327

您是否尝试过示例中提到的样式？你`td div`在风格中失踪了

```
.tree td div {
   height: 20px !important
} 
```

![在此处输入图像描述](../Images/ed16a642f2dbddb238c7e01218b3f4de.png)

那可行。请注意，设置 40px 不会直接起作用，因为在 div 中使用的垂直线图像似乎是 20px 高度；因此，如果您想改变它，您将需要实现自己的方式。这也会影响树节点上的展开/折叠图标。

```
.tree td div {
       height: 40px !important
    } 
```

![在此处输入图像描述](../Images/27ff15159f694e1f49c92539c1756736.png)

**编辑**

使用的默认图像大小为 20 x 20 像素。要设置自己的图像集，您需要设置`LineImagesFolder`树视图的属性（通过这样做，您将提供自己的图像集）。看看这个[MSDN 链接](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treeview.lineimagesfolder.aspx)

# bug-tracking - Mantis Bug Tracker 中的自定义状态

> ID：10524011
> 
> 赞同：6
> 
> 时间：2012-05-09T21:02:06.857
> 
> 标签：bug-tracking, mantis, bug-tracker

我想向 Mantis Bug 跟踪器添加一个名为“On Hold”的自定义状态。根据我在网上找到的一些博客，我在 config_local.php 中添加了以下几行：

```
$g_status_enum_string = '10:new,20:feedback,30:acknowledged,40:confirmed,50:assigned,55:onhold,80:resolved,90:closed';
$g_status_colors['onhold'] = '#cceedd';
$s_status_enum_string = '10:new,20:feedback,30:acknowledged,40:confirmed,50:assigned,55:onhold,80:resolved,90:closed'; 
```

但是，当我将此状态分配给错误时，它会在下拉列表中显示为@55@。

任何想法为什么会这样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T08:41:05.447

请参阅[有关自定义状态值的 Mantis 参考](https://www.mantisbt.org/docs/master/en-US/Admin_Guide/html/admin.customize.status.html)：

定义一个将新状态映射到的常量。在 mantisbt 主目录的新文件 custom_constants_inc.php 中：

`<?php define ( 'TEST', 60 ); ?>`

定义所需的语言字符串。这可能需要用多种语言定义。在 mantisbt 主目录中的新文件 custom_strings_inc.php 中：

```
<?php
$s_status_enum_string = '10:new,20:feedback,30:acknowledged,40:confirmed,50:assigned, 60:to be tested,80:resolved,90:closed';
$s_to_be_tested_bug_button = "Issue Ready to Test";
$s_to_be_tested_bug_title = "Set Issue Ready to Test"; 
$s_email_notification_title_for_status_bug_to_be_tested = "The following issue is ready TO BE TESTED.";
?> 
```

定义所需的任何配置。在 mantisbt 主目录中的现有文件 config_inc.php 中：

```
$g_status_enum_string = '10:new,20:feedback,30:acknowledged,40:confirmed,50:assigned, 60:to be tested,80:resolved,90:closed'; # Status color additions
$g_status_colors['to be tested'] = '#ACE7AE'; 
```

将状态添加到 config_inc.php 中定义的任何工作流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-23T04:48:26.297

我正在使用 MantisBT 2.1.0 版并且遇到了同样的问题。`custom_constants_inc.php`对我来说，解决方法是将文件`custom_strings_inc.php`从 mantisbt 主目录移动到 config 目录。

# ruby-on-rails-3 - 将非输入行插入到 Formtasic 表单中

> ID：10524012
> 
> 赞同：16
> 
> 时间：2012-05-09T21:02:08.410
> 
> 标签：ruby-on-rails-3, activeadmin, formtastic

我在 Rails 3.2（带有 Active Admin）中使用 Formtastic 2.1.1，我想在我的表单中插入一行，但**没有**输入字段。这可能吗？实现这一点的 Formtastic DSL 中的语法是什么？

这是一个例子：

```
form do |f|

    f.inputs "Model Info" do
      f.input :title
      f.input :published
      f.input :path
    end

end 
```

我想做这样的事情：

```
form do |f|

    f.inputs "Model Info" do
      f.input :title
      f.input :published
      f.input :path
      f.div "This is some important text that people using this form need to know"
    end

end 
```

以前有人用Formtastic做过这个吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-10T00:11:08.023

我自己想通了。我只需要在没有任何方法调用的情况下插入 html，如下所示：

```
form do |f|

  f.inputs "Model Info" do
    f.input :title
    f.input :published
    f.input :path
  end

  f.inputs "Custom HTML Stuff" do
    "<div id=\"element-name\">
      Some kind of content
    </div>".html_safe
  end

end 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-06-19T16:08:49.820

*要在任何*地方插入任何自定义代码，您可以使用`f.form_buffers.last`：

```
form do |f|
  f.form_buffers.last << "<p>Hello world!</p>".html_safe # The simple way

  ft = f.template # just a helper variable

  f.inputs "Foo" do
    f.input :title

    f.form_buffers.last << ft.content_tag(:li) do
      ft.content_tag(:p, "Hello again!") +
          ft.tag(:input, type: :hidden, name: "bar[]", value: "baz")
    end
    f.input :path
  end
end 
```

请注意 HTML 结构。如果你从`f.inputs`块中调用它，你的代码将被放置在一个`<ol>`元素中。在“表单”级别，您位于`<form>`元素内部。

**一点警告：**与任何“未记录的功能”一样，此方法可能会在任何新版本中更改而不会发出警告。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-02-18T21:51:11.440

IDK，如果这仍然是人们搜索的东西，但它是给我的。由于`form_buffers`已被弃用，我做了以下事情并且效果很好（在一些 CSS 帮助下）。

```
form do |f|

  f.inputs "Model Info" do
    f.input :title
    f.input :published
    f.input :path
    li "Your important text here", class: "some_class"
  end
end 
```

这输出：

```
<li class="some_class">
  Your important text here
</li> 
```

[在此处FORMS](https://github.com/activeadmin/activeadmin/blob/master/docs/5-forms.md)和此处[ARBRE](https://activeadmin.github.io/arbre/)进行了太长时间的 Google 搜索后，从文档中得到了这个想法 。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-10-28T20:44:07.630

**这是@arsen7 答案的稍微简化的形式：**

```
f.form_buffers.last << 
  "<p>Activate interlock, dynatherms connected</p>".html_safe 
```

在我的表格中看起来像这样：

![简单的 HTML 插入](../Images/da2856fddc4235a008db7e7dd1447984.png)

**这是一个模仿 ActiveAdmin 的默认样式的：**

```
f.form_buffers.last << (<<END
<li class="string input optional stringish">
  <label class="label">Activate interlock</label>
  <div style="display: inline-block;">Dynatherms connected</div>
</li>
END
).html_safe 
```

看起来像这样：

![ActiveAdmin 样式的 HTML 插入](../Images/e3f078e5718f710a30b830c9718b14ba.png)

# magento - Magento 分层导航“您不能多次定义相关名称‘mycustomattribute’”

> ID：10524017
> 
> 赞同：14
> 
> 时间：2012-05-09T21:02:35.657
> 
> 标签：magento, filter, navigation

我将 Magento 的分层导航与我的自定义属性和价格一起使用。如果我按价格过滤它会起作用；但是当按我的自定义属性过滤时，它显示：

> 您不能多次定义相关名称“mycustomattribute”

痕迹：

```
#0 /home/coloresh/public_html/ColoreSG.com/lib/Varien/Db/Select.php(281):
Zend_Db_Select->_join('inner join', Array, 'metal_idx.entit...', Array, NULL)
#1 /home/coloresh/public_html/ColoreSG.com/lib/Zend/Db/Select.php(336):          Varien_Db_Select->_join('inner join', Array, 'metal_idx.entit...', Array, NULL)
#2 /home/coloresh/public_html/ColoreSG.com/lib/Zend/Db/Select.php(315): Zend_Db_Select->joinInner(Array, 'metal_idx.entit...', Array, NULL)
#3 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Catalog/Model/Resource/Layer/Filter/Attribute.php(70): Zend_Db_Select->join(Array, 'metal_idx.entit...', Array)
#4 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Catalog/Model/Layer/Filter/Attribute.php(94): Mage_Catalog_Model_Resource_Layer_Filter_Attribute->applyFilterToCollection(Object(Mage_Catalog_Model_Layer_Filter_Attribute), '49')
#5  /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Catalog/Block/Layer/Filter/Abstract.php(91): Mage_Catalog_Model_Layer_Filter_Attribute->apply(Object(Mage_Core_Controller_Request_Http), Object(Mage_Catalog_Block_Layer_Filter_Attribute))
#6 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Catalog/Block/Layer/Filter/Abstract.php(73): Mage_Catalog_Block_Layer_Filter_Abstract->_initFilter()
#7 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Catalog/Block/Layer/View.php(136): Mage_Catalog_Block_Layer_Filter_Abstract->init()
#8 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Core/Block/Abstract.php(238): Mage_Catalog_Block_Layer_View->_prepareLayout()
#9 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Core/Model/Layout.php(456): Mage_Core_Block_Abstract->setLayout(Object(Mage_Core_Model_Layout))
#10 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Core/Model/Layout.php(472): Mage_Core_Model_Layout->createBlock('catalog/layer_v...', 'catalog.leftnav')
#11 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Core/Model/Layout.php(239): Mage_Core_Model_Layout->addBlock('catalog/layer_v...', 'catalog.leftnav')
#12 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Core/Model/Layout.php(205): Mage_Core_Model_Layout->_generateBlock(Object(Mage_Core_Model_Layout_Element), Object(Mage_Core_Model_Layout_Element))
#13 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Core/Model/Layout.php(210):  Mage_Core_Model_Layout->generateBlocks(Object(Mage_Core_Model_Layout_Element))
#14 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Core/Controller/Varien/Action.php(344): Mage_Core_Model_Layout->generateBlocks()
#15 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Catalog/controllers/CategoryController.php(146): Mage_Core_Controller_Varien_Action->generateLayoutBlocks()
#16 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Core/Controller/Varien/Action.php(419): Mage_Catalog_CategoryController->viewAction()
#17 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Core/Controller/Varien/Router/Standard.php(250): Mage_Core_Controller_Varien_Action->dispatch('view')
#18 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Core/Controller/Varien/Front.php(176): Mage_Core_Controller_Varien_Router_Standard->match(Object(Mage_Core_Controller_Request_Http))
#19 /home/coloresh/public_html/ColoreSG.com/app/code/core/Mage/Core/Model/App.php(354): Mage_Core_Controller_Varien_Front->dispatch()
#20 /home/coloresh/public_html/ColoreSG.com/app/Mage.php(683): Mage_Core_Model_App-    >run(Array)
#21 /home/coloresh/public_html/ColoreSG.com/index.php(87): Mage::run('', 'store')
#22 {main} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-28T04:24:33.517

这是因为 catalog/layer_view 模块被调用了两次。您可以通过 xml 文件搜索 'type="catalog/layer_view"'。删除不需要的块。或将类型更改为另一个类

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-10T19:21:36.280

我有`<block type="catalog/layer_view" name="catalog.leftnav" after="currency" template="catalog/layer/view.phtml"/>` 两次。删除了一行并修复了它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-21T09:18:38.923

我的情况是，我必须从 local.xml 和 catalog.xml 中获取 type="catalog/layer_view" 的块，然后放入我修改后的 type="catalog/layer_view" 块。确保只有一个块包含 type="catalog/layer_view"。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T17:35:58.863

对我来说 Dubbo 的回答是对的，但更具体地说我发现 Magento Enterprise 触及了 enterprise_search.xml 文件中的 catalog_category_layered xml 节点

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-11T03:57:59.567

这会导致同样的问题。- 在构建集合时两次将相同的属性添加到排序中：

```
...
    ->addAttributeToSort('color', 'asc')
    ->addAttributeToSort('color', 'asc'); 
```

注意：调用 setCollection($this->getMyCollection); 在模板上导致我的错误，因为“颜色”已作为默认排序顺序添加到排序顺序中。

解决方案：解决此问题的快速方法是在获取值后从请求中删除默认排序顺序：

```
$this->getRequest()->setParam('order',''); 
```

否则扩展 Block 并覆盖 setCollection() 方法以满足您的特定需求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-04T18:45:13.863

对于在 Magento Enterprise Edition 中寻找解决此问题的方法的任何人，请检查您的 catalog.xml 或 local.xml 模板是否具有目录搜索分层导航。如果确实有，请从企业主题中覆盖当前主题中的 search.xml，并清空其中的所有块引用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-09T13:46:25.200

在 Enterprise 版本上遇到了类似的问题，因此发布给其他需要它的人 - 结果我必须使用以下内容才能使其正常工作：

```
<remove name="enterprisecatalog.leftnav" /> 
```

# ruby - Ruby 将我的变量视为注释

> ID：10524025
> 
> 赞同：1
> 
> 时间：2012-05-09T21:03:17.927
> 
> 标签：ruby

完全披露：我真的不了解 Ruby。我主要是在假装。

我有一个脚本，我想用它来收集 Casper 中的库存，我用它来管理一堆 Mac。我正在尝试将变量传递给带有`%x`. 问题是，Ruby 将变量视为注释。以下是相关代码：

```
def get_host
 host=%x(/usr/sbin/dsconfigad -show | /usr/bin/awk '/Computer Account/ {print $4}').chomp
 raise Error, "this machine must not be bound to AD.\n try again." if host == nil
end

def get_ou
  host = get_host
  dsout = %x(/usr/bin/dscl /Search -read /Computers/#{host}).to_a
  ou = dsout.select {|item| item =~ /OU=/}.to_s.split(",")[1].to_s.gsub(/OU=/, '').chomp
end 
```

我尝试使用反引号而不是`%x`，但得到了相同的结果。该命令应该返回一堆关于它运行的主机的信息，但它返回的结果`dscl /Search -read /Computers`总是`name: dsRecTypeStandard:Computers`.

我怎样才能完成我想做的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T21:23:27.673

问题就在这里。Ruby 总是返回方法中的最后一个表达式。

```
def get_host
  host=%x(/usr/sbin/dsconfigad -show | /usr/bin/awk '/Computer Account/ {print $4}').chomp
  raise Error, "this machine must not be bound to AD.\n try again." if host == nil
end 
```

在这种情况下，最后一个表达式是：

```
raise Error, "this machine must not be bound to AD.\n try again." if host == nil 
```

它将返回 if或 will return if的返回值`raise`（实际上不会发生）。所以你的方法永远不会返回. 将其替换为：`host == nil``nil``host != nil``nil`

```
def get_host
  host=%x(/usr/sbin/dsconfigad -show | /usr/bin/awk '/Computer Account/ {print $4}').chomp
  raise Error, "this machine must not be bound to AD.\n try again." if host == nil
  host
end 
```

# silverlight - 在 Silverlight 中使用 SOAP Web 服务

> ID：10524027
> 
> 赞同：1
> 
> 时间：2012-05-09T21:03:23.423
> 
> 标签：silverlight, .net-4.0, wcf-client, silverlight-5.0

我试图在 Silverlight 5 应用程序中使用 SOAP 服务，但我完全迷路了。这是我的第一个 Silverlight 应用程序，也是我第二次在 .NET 应用程序中使用 Web 服务。

在一个单独的 .NET 应用程序中，我能够让它工作的唯一方法是将 WSDL 添加为 Web 引用；当我将其添加为服务参考时，该应用程序不会构建。在与 WSDL 提供者交谈时，我发现 WSDL 是使用 .NET 2.0 框架编译的……因此需要将其添加为 Web 参考。

从我到目前为止所做的研究中，我发现 Silverlight 不支持添加 Web 引用。所以我尝试将它作为 Web 引用添加到托管 ASP.NET 应用程序中，然后启动服务器。

回到我的 Silverlight 应用程序，我选择了添加服务引用的选项并指向现在位于`http://localhost:55265/Web%20References/THINKWebService/SLWebSvc_734_Upgrade.wsdl`. Visual Studio 似乎可以很好地处理它并生成代理。

这就是我开始陷入困境的地方。如果我的研究是正确的，则创建了 WCF 引用并且应该以这种方式使用。我从来没有使用过 WCF，所以我阅读了一些关于如何发送/接收请求的内容，这是我根据 MSDN 库中的示例提出的最好的代码（我将它插入到按钮单击事件中，所以我会确切知道代码何时执行）：

```
private void Button1Click(object sender, RoutedEventArgs e)
{
  var client = new ThinkSoapClient();
  var userLoginData = new user_login_data {login = "foo", password = "bar"};
  var customerIdentifier = new customer_identifier {customer_id = 6677070};
  // the debugger halts on this next line and
  // references the "dsn"...it's the 4th argument
  client.CustomerLoginInfoSelectAsync(userLoginData, customerIdentifier, "", "myDSN");
  // I'm not sure if this next line is even needed
  client.CustomerLoginInfoSelectCompleted += CustomerLoginInfoSelectCallback;
  MessageBox.Show(string.Format("CustomerLoginInfoSelectAsync({0},{1})", userLoginData, customerIdentifier));
}

// here's the callback method
static void CustomerLoginInfoSelectCallback(object sender, CustomerLoginInfoSelectCompletedEventArgs e)
{
  MessageBox.Show(string.Format("CustomerLoginInfoSelect Result: {0}", e.Result));
} 
```

`client.CustomerLoginInfoSelectAsync`正如我在上面的代码中提到的，调试器在执行该方法时会停止。这是错误消息：`XmlSerializer attribute System.Xml.Serialization.XmlAttributeAttribute is not valid in dsn. Only XmlElement, XmlArray, XmlArrayItem and XmlAnyElement attributes are supported when IsWrapped is true.`

从我所做的研究来看，我认为这个错误是由于 SOAP 操作元素包含一个属性而引起的`dsn`（但不确定，如果子元素也有属性，我是否会收到这个错误）。

`IsWrapped=true`我为to `IsWrapped=false`in做了一个查找/替换，`Reference.cs`但我得到了同样的错误，但最后一个词是假的而不是真的。

我不确定我是否对我所追求的有任何意义，所以如果它有帮助，生成的 XML 应该是这样的：

```
...
  <customer_login_info_select_request dsn="myDSN">
    <user_login_data>
      <login>foo</login>
      <password>bar</password>
    </user_login_data>
    <customer_identifier>
      <customer_id>6677070</customer_id>
    </customer_identifier>
    <login/> <!--corresponds to the empty string in the call to CustomerLoginInfoSelectAsync-->
  </customer_login_info_select_request>
... 
```

所以在这一点上，我完全迷失了。任何见解将不胜感激。如果我可以提供任何其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T09:40:51.603

虽然可能的正常解决方案是假设它“只是另一个数据源”，并在您的服务器端使用 Web 引用来提供数据（并提供对未来变化的隔离）。

```
Silverlight App <=> Silverlight Web Services <= External/Legacy Web Service 
```

让您的 Silverlight 应用程序保持精简，让服务器为您完成任何繁重的工作。

# performance - 二进制搜索效率与 fortran 中的线性搜索效率

> ID：10524032
> 
> 赞同：9
> 
> 时间：2012-05-09T21:03:36.643
> 
> 标签：performance, fortran, binary-search, fortran77, linear-search

这个问题是关于线性搜索的效率与对连续存储中预排序数组的二进制搜索的效率...

我有一个用 fortran (77!) 编写的应用程序。我的部分代码的一个常见操作是在数组中查找索引，使得`gx(i) <= xin < gx(i+1)`. 我目前已将其实现为`binary search`- 对语句标签感到抱歉，并且`goto`- 我已经评论了使用 fortran 90 的等效语句......

```
 i=1
        ih=nx/2
201     continue  !do while (.true.)
           if((xin.le.gx(i)).and.(xin.gt.gx(i+1)))then  !found what we want
              ilow=i+1; ihigh=i
              s1=(gx(ihigh)-xin)/(gx(ihigh)-gx(ilow))
              s2=1.0-s1
              return
           endif
           if(i.ge.ih)then
              goto 202 !exit
           endif
           if(xin.le.(gx(ih))then !xin is in second half of array
              i=ih
              ih=nx-(nx-ih)/2
           else !xin is in first half of array
              i=i+1
              ih=i+(ih-i)/2
           endif
        goto 201  !enddo 
```

但是，今天，我在 Wikipedia 上阅读有关二分搜索的内容时遇到了这个问题：

```
Binary search can interact poorly with the memory hierarchy 
(i.e. caching), because of its random-access nature. For 
in-memory searching, if the span to be searched is small, a
linear search may have superior performance simply because 
it exhibits better locality of reference. 
```

我不完全理解这个说法——我的印象是缓存提取是一次以大（ish）块收集的，所以如果我们从数组的开头开始，我认为大部分数组都会在缓存中已经（至少与线性搜索一样多），所以我认为这并不重要。

所以我的问题是，有什么方法可以判断哪种算法性能更好（线性搜索还是二进制搜索？）是否存在数组大小边界？我目前正在使用大小约为 100 个元素的数组...

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-09T21:15:07.723

对于小型阵列，问题不在于缓存。你是对的：一个小数组很可能被快速缓存。

问题是分支预测对于二分搜索很可能会失败，因为分支是以数据相关的方式随机选取或跳过的。分支预测未命中会使 CPU 流水线停滞。

这种影响可能很严重。您可以在执行单个二进制搜索分支（并且您需要执行多个二进制搜索分支）的同时轻松地线性搜索 3 到 8 个元素。需要测量准确的盈亏平衡点。

停止 CPU 流水线非常昂贵。Core i7 每个时钟周期最多可以退出 4 条指令（3 GHz 时每秒 12 条千兆指令！）。但只有在你不拖延的情况下。

有无分支算法通过使用条件移动 CPU 指令进行二进制搜索。这些算法基本上展开 32 个搜索步骤并`CMOV`在每个步骤中使用 a（32 个步骤是理论上的最大值）。它们是无分支的，但不是无停顿的：每个下一步都 100% 依赖于前一步，因此 CPU 无法在指令流中提前充电。它必须一直等待。所以他们没有解决这个问题，只是稍微改进一下。

# jquery - 点击页面加载获取url

> ID：10524034
> 
> 赞同：0
> 
> 时间：2012-05-09T21:03:40.387
> 
> 标签：jquery, jquery-mobile

下面的代码应该在页面加载时以 root 身份获取新的 url。我尝试将课程定位为 .click，但效果不佳。任何帮助，将不胜感激。

```
 <script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'></script>

    <script>
    $(document).ready(function() {
        $("a").trigger('click');
    });
    </script>

    <a href="/" class="click">&nbsp;</a> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T21:06:28.467

您可以使用它并完全跳过 jQuery 和 a 标签：

```
<script>
    window.location.href = '/';
</script> 
```

这会将浏览器的地址设置为站点根目录，并将您带到那里，而无需模拟任何点击，甚至无需等待文档准备好。此外，不需要 jQuery。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T21:14:37.647

您可以使用`trigger('click')`来触发点击事件的 JavaScript 代码。但是，出于安全原因，您不能使用它来模拟实际打开链接的鼠标单击。您**必须**通过直接分配来做到这一点`window.location`：

```
$('a.click').trigger('click'); // everything but changing the URL
window.location = $('a.click').attr('href'); // change the URL 
```

另外，[请阅读此](https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work)。

# java - 过滤 RESTful Web 服务中的资源集合

> ID：10524036
> 
> 赞同：1
> 
> 时间：2012-05-09T21:03:56.313
> 
> 标签：java, web-services, hibernate, rest, spring-mvc

我在一个使用 Spring MVC 和 Hibernate 的应用程序上工作。我正在实现一些 RESTful Web 服务，并且很好奇如何轻松过滤集合服务器端。

例如，我希望能够过滤员工实体的集合。我研究了几个选项，例如[RQL](http://www.sitepen.com/blog/2010/11/02/resource-query-language-a-query-language-for-the-web-nosql/)、[Google](https://developers.google.com/custom-search/docs/structured_search)处理自定义搜索的方式、[Ebay 的](https://www.x.com/developers/ebay/use-cases/srching-by-keywords)答案，甚至是 Yahoo 的[YQL](http://developer.yahoo.com/yql/guide/two-minute-tutorial.html)。它们似乎都是过滤问题的好答案，但我似乎找不到任何可以让我轻松实现这个概念的库。

我确实在[这里](http://nsinfra.blogspot.com/2011/12/simplifying-restful-search.html)找到了：

> 自 2.3.0 版本以来，Apache CXF 通过其 JAX-RS 实现引入了 FIQL 支持

但我们已经在使用 Spring MVC。

我很惊讶没有库可以获取下面的粗体查询字符串，例如，并将其转换为 SQL 或 Hibernate 可以用来过滤的东西。

> /雇员？**lastname=john 或 jon&hiredate lt 20010201**

完全有可能我想错了，但我想利用社区的经验和知识。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-17T12:44:59.953

我知道这是旧的，但为了完整起见，至少有两个库可以处理解析 RQL：

*   [https://github.com/jazdw/rql-parser](https://github.com/jazdw/rql-parser)
*   [https://github.com/jirutka/rsql-parser](https://github.com/jirutka/rsql-parser)（默认不是 RQL，但可配置）

我自己使用 jazdw/rql-parser 并开始使用 SQL 映射器，但正如 Oleksi 提到的，验证、字段映射等需要很多自定义代码，所以我不知道我能做到多通用.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T21:15:28.547

直接将这样的 GET 转换为 SQL 的库可能非常不安全。您需要有一个中间层来进行一些验证，以确保用户不会弄乱 URL 来执行 SQL 注入。

据我所知，您能做的最好的事情就是使用您的 JAX-RS 实现来干净地读取这些查询参数，验证它们，并使用准备好的 SQL 语句之类的东西来安全地执行它们。

# mysql - 运行此插入命令时，mysql datatime 列返回 null

> ID：10524039
> 
> 赞同：0
> 
> 时间：2012-05-09T21:04:03.290
> 
> 标签：mysql

下面是我正在使用的插入命令，当我运行该命令时，它给出的 OpenDate cannot be null 错误，但我不知道为什么。如果我切换 Ymd，它会说格式无效。我真的不知道为什么我会收到这个错误。该列是 DateTime，数据库是 InnoDB

```
插入到 tbldealershipcars（价格，
                              开放日期，
                              `年`，
                              制作，
                              模型，
                              汽车内饰，
                              英里，
                              身份识别，
                              车辆识别号）
   价值观
          ('16888',
           STR_TO_DATE('8/12/2011', '%m-%d-%Y'),
           '2007',
           '87',
           '701',
           '12299',
           '73387',
           '演示'，
           '我的测试ID'）
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:06:04.097

你的日期有`/`s，你的格式有`-`s。他们需要匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T21:16:15.460

> 该列是日期时间

如果您只插入 Ymd，则需要为**Date**

或者您需要更改您的 str_to_date 函数以包含时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T21:19:23.513

你可以试试

```
STR_TO_DATE('8/12/2011',  '%m/%d/%Y') 
```

或者

```
STR_TO_DATE('8-12-2011',  '%m-%d-%Y') 
```

[STR_TO_DATE(str,format)](http://www.java2s.com/Tutorial/MySQL/0280__Date-Time-Functions/STRTODATEstrformat.htm)与所有说明符。

[来自 dev.mysql.com 的日期和时间函数](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)

# android - Eclipse 无法检测到 Android 4.0.3 选项卡

> ID：10524042
> 
> 赞同：1
> 
> 时间：2012-05-09T21:04:12.037
> 
> 标签：android, eclipse

您好我正在尝试从 Eclipse 加载和调试 Android 4.0.3 应用程序。

但是 Eclipse 没有在 Android 设备选择器中检测到。我已经在平板电脑中启用了 USB 调试模式。我的电脑也检测到了这款平板电脑。

我对我的 Android 2.1 手机做了同样的事情，它立即被检测到并显示在设备选择器中。

是否可以指出任何其他事情，我解决了这个问题，Eclipse 检测到了我的选项卡。

谢谢，阿尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T14:01:24.207

得到它的工作！

缺少所需的驱动程序，Micromax 并未正式提供 Funbook 的驱动程序。

您可以从这里下载下摆：[驱动程序](http://www.mediafire.com/?c041z8h54v3pd15)

感谢[http://funbook.gizmolord.com/](http://funbook.gizmolord.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:09:52.520

连接设备后，重置 ADB 进程（从命令行：adb kill-server; adb start-server）

或者从 Eclipse 的设备选项卡中，右侧最后一个菜单中有一个“重新启动 ADB”（倒三角形）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T21:47:11.007

我遇到了调试器识别我的设备的问题。首先尝试启动 AVD 并让它运行，然后尝试您的设备。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T22:09:26.597

通过 SDK 管理器下载 Google USB 驱动程序。如果它不起作用，请尝试下载标签的特定驱动程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-22T16:54:14.707

我在使用 Micromax funbook 时遇到了同样的问题。问题是未安装此设备的 USB 驱动程序。我通过从 Micromax funbook 官方网站“http://www.micromaxfunbook.com/support.php”安装设备驱动程序解决了这个问题

注意：驱动程序下载链接将在支持页面底部提供。

希望这可以帮助！

# java - 在 Play Framework 2.0 中路由重载函数

> ID：10524047
> 
> 赞同：4
> 
> 时间：2012-05-09T21:04:33.760
> 
> 标签：java, playframework, playframework-2.0

在 Play 中，当重载控制器方法时，这些单独的方法不能被多次路由，导致编译器不喜欢它。

有没有办法解决这个问题？

假设我的`Product`控制器中有两个功能：`getBy(String name)`和`getBy(long id)`.

对于在以下声明的这些函数，我有两条不同的路线`routes`：

```
GET /p/:id            controllers.Product.getBy(id: Long)
GET /p/:name          controllers.Product.getBy(name: String) 
```

我想对不同的路线使用“相同”的功能，这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T22:02:29.523

不，这是不可能的，有两种解决方案。

**首先是**使用2个名字：

```
public static Result getByLong(Long id) {
    return ok("Long value: " + id);
}

public static Result getByString(String name) {
    return ok("String value: " + name);
} 
```

你也应该为它使用单独的路线，否则你会得到类型不匹配

```
GET   /p-by-long/:id         controllers.Monitor.getByLong(id: Long)
GET   /p-by-string/:name     controllers.Monitor.getByString(name: String) 
```

**第二种解决方案**是使用带有 String 参数的一种方法，并在内部检查它是否可以转换为 Long

```
public static Result getByArgOfAnyType(String arg) {
    try {
        Long.parseLong(arg);
        return ok("Long: " + arg);
    } catch (Exception e) {
        return ok("String: " + arg);
    }
} 
```

路线：

```
GET   /p/:arg     controllers.Monitor.getByArgOfAnyType(arg : String) 
```

我知道这不适合您的问题，但至少可以节省您的时间。还要记住，可能有更好的方法来确定 String 是否可以转换为数字类型，即在这个问题中：[检查 String 是否表示 Java 中的整数的最佳方法是什么？](https://stackoverflow.com/questions/237159)

# cuda - 在 Cuda 中简单地添加两个 int，结果总是相同的

> ID：10524050
> 
> 赞同：5
> 
> 时间：2012-05-09T21:04:45.377
> 
> 标签：cuda

我开始了学习 Cuda 的旅程。我正在玩一些 hello world 类型的 cuda 代码，但它不起作用，我不知道为什么。

代码非常简单，取两个整数并将它们添加到 GPU 上并返回结果，但无论我将数字更改为什么，我都会得到相同的结果（如果数学以这种方式工作，我在该主题上会做得比我确实做到了）。

这是示例代码：

```
// CUDA-C includes
#include <cuda.h>
#include <stdio.h>

__global__ void add( int a, int b, int *c ) {
    *c = a + b;
}

extern "C"
void runCudaPart();

// Main cuda function

void runCudaPart() {

    int c;
    int *dev_c;

    cudaMalloc( (void**)&dev_c, sizeof(int) );
    add<<<1,1>>>( 1, 4, dev_c );

    cudaMemcpy( &c, dev_c, sizeof(int), cudaMemcpyDeviceToHost );

    printf( "1 + 4 = %d\n", c );
    cudaFree( dev_c );

} 
```

输出似乎有点偏离：`1 + 4 = -1065287167`

我正在设置我的环境，只是想知道代码是否有问题，否则可能是我的环境。

更新：我尝试添加一些代码来显示错误，但我没有得到输出，但数字发生了变化（它是输出错误代码而不是答案吗？即使我没有在内核中做任何工作，除了分配一个变量我仍然得到类似的结果）。

```
// CUDA-C includes
#include <cuda.h>
#include <stdio.h>

__global__ void add( int a, int b, int *c ) {
    //*c = a + b;
    *c = 5;
}

extern "C"
void runCudaPart();

// Main cuda function

void runCudaPart() {

    int c;
    int *dev_c;

    cudaError_t err = cudaMalloc( (void**)&dev_c, sizeof(int) );
    if(err != cudaSuccess){
         printf("The error is %s", cudaGetErrorString(err));
    }
    add<<<1,1>>>( 1, 4, dev_c );

    cudaError_t err2 = cudaMemcpy( &c, dev_c, sizeof(int), cudaMemcpyDeviceToHost );
    if(err2 != cudaSuccess){
         printf("The error is %s", cudaGetErrorString(err));
    }

    printf( "1 + 4 = %d\n", c );
    cudaFree( dev_c );

} 
```

代码似乎很好，可能与我的设置有关。在 OSX lion 上安装 Cuda 是一场噩梦，但我认为它可以工作，因为 SDK 中的示例似乎很好。到目前为止，我采取的步骤是访问 Nvida 网站并下载驱动程序、工具包和 SDK 的最新 mac 版本。然后我添加了`export DYLD_LIBRARY_PATH=/usr/local/cuda/lib:$DYLD_LIBRARY_PATH`'PATH=/usr/local/cuda/bin:$PATH` 我做了一个 deviceQuery 并且它传递了关于我的系统的以下信息：

```
[deviceQuery] starting...

/Developer/GPU Computing/C/bin/darwin/release/deviceQuery Starting...

 CUDA Device Query (Runtime API) version (CUDART static linking)

Found 1 CUDA Capable device(s)

Device 0: "GeForce 320M"
  CUDA Driver Version / Runtime Version          4.2 / 4.2
  CUDA Capability Major/Minor version number:    1.2
  Total amount of global memory:                 253 MBytes (265027584 bytes)
  ( 6) Multiprocessors x (  8) CUDA Cores/MP:    48 CUDA Cores
  GPU Clock rate:                                950 MHz (0.95 GHz)
  Memory Clock rate:                             1064 Mhz
  Memory Bus Width:                              128-bit
  Max Texture Dimension Size (x,y,z)             1D=(8192), 2D=(65536,32768), 3D=(2048,2048,2048)
  Max Layered Texture Size (dim) x layers        1D=(8192) x 512, 2D=(8192,8192) x 512
  Total amount of constant memory:               65536 bytes
  Total amount of shared memory per block:       16384 bytes
  Total number of registers available per block: 16384
  Warp size:                                     32
  Maximum number of threads per multiprocessor:  1024
  Maximum number of threads per block:           512
  Maximum sizes of each dimension of a block:    512 x 512 x 64
  Maximum sizes of each dimension of a grid:     65535 x 65535 x 1
  Maximum memory pitch:                          2147483647 bytes
  Texture alignment:                             256 bytes
  Concurrent copy and execution:                 Yes with 1 copy engine(s)
  Run time limit on kernels:                     Yes
  Integrated GPU sharing Host Memory:            Yes
  Support host page-locked memory mapping:       Yes
  Concurrent kernel execution:                   No
  Alignment requirement for Surfaces:            Yes
  Device has ECC support enabled:                No
  Device is using TCC driver mode:               No
  Device supports Unified Addressing (UVA):      No
  Device PCI Bus ID / PCI location ID:           4 / 0
  Compute Mode:
     < Default (multiple host threads can use ::cudaSetDevice() with device simultaneously) >

deviceQuery, CUDA Driver = CUDART, CUDA Driver Version = 4.2, CUDA Runtime Version = 4.2, NumDevs = 1, Device = GeForce 320M
[deviceQuery] test results...
PASSED 
```

更新：真正奇怪的是，即使我删除了内核中的所有工作，我仍然得到 c 的结果？我已经重新安装了 cuda 并在示例中使用了 make 并且所有这些都通过了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-10T07:08:23.853

这里基本上有两个问题：

1.  您没有为正确的架构编译内核（从评论中收集）
2.  您的代码包含不完善的错误检查，它错过了发生运行时错误的点，从而导致神秘和无法解释的症状。

在运行时 API 中，大多数与上下文相关的操作都是“惰性”执行的。当您第一次启动内核时，运行时 API 将调用代码以智能地从工具链为目标硬件发出的胖二进制图像中找到合适的 CUBIN 图像并将其加载到上下文中。这还可以包括 PTX 的 JIT 重新编译以实现向后兼容的架构，但不能反过来。因此，如果您为计算能力 1.2 设备编译了内核并在计算能力 2.0 设备上运行它，则驱动程序可以 JIT 编译它包含的新架构的 PTX 1.x 代码。但反过来是行不通的。因此，在您的示例中，运行时 API 将生成错误，因为它无法在嵌入在可执行文件中的 CUDA fatbinary 映像中找到可用的二进制映像。[这个问题](https://stackoverflow.com/q/6689129/681865)了解更多信息）。

如果您的代码包含这样的错误检查：

```
cudaError_t err = cudaMalloc( (void**)&dev_c, sizeof(int) );
if(err != cudaSuccess){
     printf("The error is %s", cudaGetErrorString(err));
}

add<<<1,1>>>( 1, 4, dev_c );
if (cudaPeekAtLastError() != cudaSuccess) {
    printf("The error is %s", cudaGetErrorString(cudaGetLastError()));
}

cudaError_t err2 = cudaMemcpy( &c, dev_c, sizeof(int), cudaMemcpyDeviceToHost );
if(err2 != cudaSuccess){
     printf("The error is %s", cudaGetErrorString(err));
} 
```

内核启动后的额外错误检查应捕获内核加载/启动失败生成的运行时 API 错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-01T11:32:58.817

```
#include <stdio.h>
#include <conio.h>
#include <cuda.h>
#include <cuda_runtime.h>
#include <device_launch_parameters.h>

__global__ void Addition(int *a,int *b,int *c)
{

   *c = *a + *b;
}
int main()
{
  int a,b,c;
  int *dev_a,*dev_b,*dev_c;
  int size = sizeof(int);

  cudaMalloc((void**)&dev_a, size);
  cudaMalloc((void**)&dev_b, size);
  cudaMalloc((void**)&dev_c, size);

  a=5,b=6;

  cudaMemcpy(dev_a, &a,sizeof(int), cudaMemcpyHostToDevice);  
  cudaMemcpy(dev_b, &b,sizeof(int), cudaMemcpyHostToDevice);  

  Addition<<< 1,1 >>>(dev_a,dev_b,dev_c);
  cudaMemcpy(&c, dev_c,size, cudaMemcpyDeviceToHost);

   cudaFree(&dev_a);
   cudaFree(&dev_b);
   cudaFree(&dev_c);

   printf("%d\n", c);
   getch();
   return 0;
} 
```

# php - Zend Doctrine 1.2 foreignAlias 在 YAML 模式文件中被忽略。在 Doctrine Cli 中构建所有 cmd 期间出错

> ID：10524051
> 
> 赞同：0
> 
> 时间：2012-05-09T21:04:50.480
> 
> 标签：php, zend-framework, doctrine, yaml, relationship

我有一个简单的问题，我不明白为什么它不起作用...服务器：最新的 ZendServer CE，ZF：1.11.11，Doctrine：1.2.2

YAML 架构：

```
        乌兹特科尼克：
          表名：uzytkownicy
          列：
            ID：
              类型：整数
              固定：假
          无符号：真
          主要：真
          自动增量：真
        uzytkownik_dane_id：
          类型：整数
        登录：
          类型：字符串（64）
          非空：真
        哈斯洛：
          类型：字符串（96）
          非空：真
        电子邮件：
          类型：字符串（192）
          非空：真
        纳兹瓦：
          类型：字符串（64）
      关系：
        Uzytkownik丹麦人：
          本地：uzytkownik_dane_id
          国外：身份证
          外号：Dane
          外国类型：一

    Uzytkownik丹麦人：
      表名：uzytkownicy_dane
      列：
        ID：
          类型：整数
          固定：假
          无符号：真
          主要：真
          自动增量：真
        咪咪：
          类型：字符串（128）
        纳兹维斯科：
          类型：字符串（128）
        克拉吉：
          类型：字符串（32）
        wojewodztwo：
          类型：字符串（64）
        米耶斯科沃斯克：
          类型：字符串（128）
        地址：
          类型：字符串（128）
        科德：
          类型：字符串（16）
        电话：
          类型：字符串（16）
      关系：
        乌兹特科尼克：
          本地：身份证
          外国：uzytkownik_dane_id

```

通过 Doctrine Cli build-all-reload 生成的模型：

```
    hasOne('Application_Model_UzytkownikDane as UzytkownikDane', array(
                 '本地' => 'uzytkownik_dane_id',
                 '外国' => 'id'));
        }
    }

```

如您所见，学说 Cli 忽略了我的别名并设置默认值：Application_Model_UzytkownikDane as UzytkownikDane ... 为什么？第二件事是（可能很重要，我不知道......）当我从 yml 文件构建所有模型时，Doctrine Cli 输出错误：

```
    build-all-reload - 您确定要删除数据库吗？（是/否）
    是的
    build-all-reload - 成功删除名为“doctrine”的连接的数据库

    build-all-reload - 从 YAML 模式成功生成模型
    build-all-reload - 成功为名为“doctrine”的连接创建数据库

    SQLSTATE[HY000]: 一般错误: 1005 Can't create table 'testdb.#sql-188_3a' (e
    rrno：150）。查询失败：“ALTER TABLE uzytkownik ADD CONSTRAINT uzytkownik_uzy
    tkownik_dane_id_uzytkownik_dane_id 外键 (uzytkownik_dane_id) 参考 u
    zytkownik_dane(id)"。失败的查询：ALTER TABLE uzytkownik ADD CONSTRAINT uzytko
    wnik_uzytkownik_dane_id_uzytkownik_dane_id 外键 (uzytkownik_dane_id) 参考
    RENCES uzytkownik_dane(id)

```

为什么？ofc 所有工作关系都在工作等等。但别名不起作用，Cli 输出错误...问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:34:27.053

不知道为什么`foreignAlias`设置不被尊重，我回家后会检查一些代码。

但我认为您收到失败`alter table`响应的原因是因为：

```
Uzytkownik:
  ....
  uzytkownik_dane_id:
    type: integer
    # This is missing the unsigned attribute, as set in `UzytkownikDane.columns.id`
    # Also it may not hurt to add the fixed attribute as well, although I don't think it will matter 
```

MySQL 期望两列的数据类型相同，因此如果一个被标记为无符号，而另一个被标记为有符号，您将收到您发布的 SQL 错误。

**- 更新 -**

根据[Doctrine 1.2 文档](http://readthedocs.org/docs/doctrine/en/latest/en/manual/yaml-schema-files.html)：

> 指定关系时，只需要指定**存在外键的那一端**的关系。解析模式文件时，它会反映关系并自动构建对端。如果您手动指定关系的另一端，则自动生成将不起作用。

我遵循他们的指导方针，只在包含外键的表上建立关系，所以试试这个：

```
Uzytkownik:
  tableName: uzytkownicy
    columns:
      id:
        type: integer
        fixed: false
        unsigned: true
        primary: true
        autoincrement: true
      uzytkownik_dane_id:
        type: integer
      login:
        type: string(64)
        notnull: true
      haslo:
        type: string(96)
        notnull: true
      email:
        type: string(192)
        notnull: true
      nazwa:
        type: string(64)
      relations:
        UzytkownikDane:
          local: uzytkownik_dane_id
          foreign: id
          foreignAlias: Dane # Set this if you want the UzytkownikDane to reference this as Dane
          alias: Dane # Set this if you want this table to reference UzytkownikDane as Dane (which I think is what you want)
          foreignType: one

UzytkownikDane:
  tableName: uzytkownicy_dane
  columns:
    id:
      type: integer
      fixed: false
      unsigned: true
      primary: true
      autoincrement: true
    imie:
      type: string(128)
    nazwisko:
      type: string(128)
    kraj:
      type: string(32)
    wojewodztwo:
      type: string(64)
    miejscowosc:
      type: string(128)
    adres:
      type: string(128)
    kod:
      type: string(16)
    telefon:
      type: string(16)    
  # No need for references here, they will be auto-generated by Doctrine 
```

我测试了构建模型并按照 Doctrine 文档的要求行事。

# mysql - MySQL：排除 id 出现在表的两个单独列中的行

> ID：10524054
> 
> 赞同：0
> 
> 时间：2012-05-09T21:05:11.690
> 
> 标签：mysql

我有一个看起来像这样的表：

```
| id    | order_id  |  product_id |  category_id  |name | cost |  returned_product_id |
| 3100  |   900     |  0125       |      3        | Foo |  14  |  NULL                |
| 3101  |   901     |  0145       |      3        | Bar |  10  |  NULL                |
| 3102  |   901     |  2122       |      3        | Baz |  11  |  NULL                |
| 3103  |   900     |  0125       |      3        | Foo | -14  |  3100                |
| 3104  |   902     |  0125       |      3        | Foo |  14  |  NULL                |
| 3105  |   902     |  0125       |      3        | Foo | -14  |  3104                |
| 3106  |   903     |  0125       |      3        | Foo |  14  |  NULL                | 
```

id 是包含 product_id 的订单的单个行项目。如果产品被退回，则会创建一个带有新 ID 的新订单项。每个产品都有一个，可以再次回购退回的物品，然后再次退货。

在特定条件下，我将表数据与其他表中的数据连接起来。作为最后一个条件，我试图排除任何最初退回的订单项。这是为了尝试执行一个查询，该查询基本上为我提供了所有已购买且尚未返回的 product_id，如下所示：

```
select product_id 
  from orders o,
       line_items i 
 where o.state = 'paid' 
   and o.id = i.order_id  
   and i.category_id = 3 
   and i.product_id not in (select li.returned_product_id  
                      from line_items li 
                     where li.refunded_product_id is not null 
                       and li.product_id = 3) 
```

即使我在 id 和 returned_product_id 上都有索引，但上面的查询确实很慢（数千行），如果我的子选择查询 id，它很快。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:13:31.283

如果您的查询来自您公开内容的表，则该行：

```
and i.id not in (select li.returned_product_id 
```

会查看表格的 id 而不是产品的 id，对吗？

那应该是

```
and i.product_id not in (select li.returned_product_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T21:29:25.887

就像是：

```
 select distinct i.product_id from 
      line_items i left join line_items j
      on i.product_id = j.refunded_product_id            
      where j.refunded_product_id is null 
```

?

# java - 按键后做某事（但稍等片刻）

> ID：10524066
> 
> 赞同：0
> 
> 时间：2012-05-09T21:05:55.297
> 
> 标签：java, android, keypress

我需要在按键事件后一秒钟做一些事情（在相对较大的 ArrayList 中搜索，然后在自定义且有点复杂的适配器中显示它），但如果发生另一个按键事件，那么我应该重置倒计时并再等一秒钟。

我可以在 Java 中做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:28:03.857

您可以为此使用处理程序：

```
private Handler handler = new Handler();     

private Runnable actionRunnable = new Runnable() {
    public void run(){
        // your action here
    }
}; 

private void handleKeypress() {
    handler.removeCallbacks(actionRunnable);
    handler.postDelayed(actionRunnable, 1000); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T21:16:33.903

您可以制作一次性[计时器](http://developer.android.com/reference/java/util/Timer.html)并使用新的关键事件取消它。

这是类似于 AutoCompleteTextView 的东西吗？我假设仅添加“搜索”按钮不是一个选项。

# ruby-on-rails - Ruby on Rails/Haml 部分和嵌套表单的问题

> ID：10524067
> 
> 赞同：0
> 
> 时间：2012-05-09T21:05:57.360
> 
> 标签：ruby-on-rails, haml

我正在创建一个嵌套表单并使用 Ryan Bates Railscast。我正在创建一个使用部分的典型表单。

```
= form_for(@project, :html => { :class => 'addProjectForm' }) do |f|
  ...
  %p
    = f.fields_for :crew_members do |crew|
      #fields
      = render 'crew_member_fields', :m => crew
      = link_to_add_fields "Add Crew Members", f, :crew_members
  %p 
```

然后我调用一个助手类，以便能够克隆“字段”类并将其添加到我的表单中。

```
module ProjectsHelper
  def link_to_add_fields(name, f, association)
    new_object = f.object.class.reflect_on_association(association).klass.new
    fields = f.fields_for(association, new_object, :child_index => "new_#{association}") do |builder|
      render(association.to_s.singularize + "_fields", :f => builder)
    end
    link_to_function(name, h("add_fields(this, \"#{association}\", \"#{escape_javascript(fields)}\")"))
  end
end 
```

然后帮助程序类调用一个 javascript 函数来处理细节。

```
function add_fields(link, association, content) {
        var new_id = new Date().getTime();
        var regexp = new RegExp("new_" + association, "g");
        $(link).parent().before(content.replace(regexp, new_id));
} 
```

我的问题是当我添加

```
= link_to_add_fields "Add Crew Members", f, :crew_members 
```

行，我得到错误

```
undefined local variable or method `m' for #<#<Class:0xa763964>:0xa761588>

    Extracted source (around line #1):

    1: = m.label "Crew Member Name"
    2: = m.label "Crew Member Role"
    3: %br
    4: = m.text_field :name 
```

这使得看起来部分没有获得 builder 变量，但如果我没有

```
= link_to_add_fields "Add Crew Members", f, :crew_members 
```

行，然后部分显示就好了。我对接下来如何调试感到困惑。很抱歉，这篇文章很长，但我希望你拥有所有信息。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:15:42.310

我认为您的助手中有错字。

```
module ProjectsHelper
  def link_to_add_fields(name, f, association)
    new_object = f.object.class.reflect_on_association(association).klass.new
    fields = f.fields_for(association, new_object, :child_index => "new_#{association}") do |builder|
      render(association.to_s.singularize + "_fields", :f => builder)
    end
    link_to_function(name, h("add_fields(this, \"#{association}\", \"#{escape_javascript(fields)}\")"))
  end
end 
```

`render(association.to_s.singularize + "_fields", :f => builder)`应该 `render(association.to_s.singularize + "_fields", :m => builder)`

# tomcat - 覆盖 Spring MVC freemarker 数据绑定字符编码

> ID：10524068
> 
> 赞同：0
> 
> 时间：2012-05-09T21:05:58.013
> 
> 标签：tomcat, spring-mvc, character-encoding, freemarker

我一直在为使用 Spring MVC 3.1.1 构建的 Tomcat Web 应用程序的编码问题而摸不着头脑。

**问题**

Spring 通过 Freemarker Spring 宏绑定的表单输入字段值被解码为 ISO-8859-1 而不是 UTF-8。

**当前配置**

我已将 freemarker 配置为以 UTF-8 编码所有内容。

```
 <bean id="freemarkerConfig"
       class="org.springframework.web.servlet.view.freemarker.FreeMarkerConfigurer">
       <property name="templateLoaderPath" value="/WEB-INF/templates/" />
       <property name="freemarkerSettings">
          <props>
            <prop key="auto_import">spring.ftl as spring</prop>
            <prop key="url_escaping_charset">UTF-8</prop>
          </props>
       </property>
    </bean> 
```

这是我在 web.xml 文件中设置的字符编码过滤器。

```
<filter>
   <filter-name>characterEncodingFilter</filter-name>
   <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
   <init-param>
      <param-name>encoding</param-name>
      <param-value>UTF-8</param-value>
   </init-param>
   <init-param>
      <param-name>forceEncoding</param-name>
      <param-value>true</param-value>
   </init-param>
</filter>

<filter-mapping>
   <filter-name>characterEncodingFilter</filter-name>
   <url-pattern>/*</url-pattern>
</filter-mapping> 
```

HTML 标记头标签包含：

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
```

UTF-8 编码非常适合显示在我的 freemarker 视图中返回的数据，但绑定到表单值的数据除外，例如下面的输入。

```
<form id="main-search-form" action="search" method="GET">
   <@spring.formInput 'searchForm.q' 'id="q" maxlength="2048" autocomplete="off" spellcheck="false"'/>
</form> 
```

据我所知，在互联网上阅读了数小时后，在大多数情况下，Spring 似乎默认为 ISO-8859-1，但我还没有找到一个可以覆盖的 bean 来更改绑定数据的解码类型. 即使 HTTP 请求使用 UTF-8 编码并且 tomcat 容器的连接器节点设置为 URIEncode="UTF-8"，Spring 也会尝试使用 ISO-8859-1 进行解码。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:45:50.530

我需要指定

```
 <form ... accept-charset="UTF-8"> ... 
```

让我的 UTF-8 字符正确提交到后端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T15:20:46.207

在我的头在桌子上敲了几个小时之后，我想我终于弄清楚了问题所在。我上面的配置都是正确的（包括 Tomcat 连接器属性**URIEncode="UTF-8"**）。

我错误地假设是 Spring MVC 通过表单提交处理我的 GET 请求的编码。

但是，这实际上只是表单标记的问题。我需要将表单字符集指定为 UTF-8。

```
<form id="main-search-form" action="search" method="GET" accept-charset="UTF-8"> 
   ...
</form> 
```

这与上述配置相结合，解决了我的问题。

# websphere - Websphere 门户和 Moodle 之间的 SSO

> ID：10524073
> 
> 赞同：0
> 
> 时间：2012-05-09T21:06:18.250
> 
> 标签：websphere, single-sign-on, moodle, websphere-portal

我们有一个公开的供应商门户网站和一个公开的 Moodle 站点。它们都设置为使用相同的 Active Directory。

有没有办法在它们之间配置sso？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T13:42:30.553

我以前研究过这个问题，我发现的只是将用户凭据保留在全局 Portal 会话中并将它们发布到服务器 Moodle 登录表单。

似乎 Moodle 不支持 LTPA，因为这是为 Websphere 和 Domino 设计的专有 IBM 协议。此外，LTPA 令牌不包含实际密码，因此当 Moodle 表示特定用户已在特定时间（时间戳）进行身份验证时，它必须信任 Websphere。

可能其他人可能对这个主题有更多的意见......

# spring-data - 在 Spring 容器之外使用 Spring Data Neo4j

> ID：10524074
> 
> 赞同：1
> 
> 时间：2012-05-09T21:06:20.587
> 
> 标签：spring-data, spring-data-neo4j

Spring Data Neo4j 可以像 Spring Data JPA 一样“独立”使用（即在 Spring 容器之外）吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T10:47:09.070

目前，您不能在 Spring 容器之外使用 Spring Data Neo4j，因为它尚未与[Spring Data Commons中的](http://www.springsource.org/spring-data/commons)[CDI 集成](http://static.springsource.org/spring-data/data-jpa/docs/current/reference/html/#jpd.misc.cdi-integration)支持集成。

如果您希望看到对此的支持，请随时打开[JIRA问题。](https://jira.springsource.org/browse/DATAGRAPH)

# python - 当 Python 3.3 附带新包时，Distribute 会过时吗？

> ID：10524075
> 
> 赞同：6
> 
> 时间：2012-05-09T21:06:25.090
> 
> 标签：python, packaging, distutils, distribute, python-3.3

[Python 3.3](http://www.python.org/download/releases/3.3.0/)将附带一个名为“打包”的新打包工具：

> 新的“打包”模块，基于“distribute”和“distutils2”项目，弃用“distutils”

这是否意味着[Distribute](http://packages.python.org/distribute/)将在 Python 3.3 中过时？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T04:11:52.757

3.3 发行说明有点误导：打包*是*distutils2，它不是基于分发构建的，而是模仿一些功能，但具有不同的行为或规范，特别是对于已使用 PEP [376](http://www.python.org/dev/peps/pep-0376/)、[386](http://www.python.org/dev/peps/pep-0386/)和[345](http://www.python.org/dev/peps/pep-0345/)标准化的部分，以及非常不同的代码和用法。

对于最终用户，在某种程度上 distutils2/packaging 不会使分发过时，因为分发仍然提供独特的功能，但从另一个角度来看，它已经过时了，因为它不支持当前的 PEP 并且不受官方支持（即在标准库中）。

关于各种打包项目，我认为分发开发人员计划支持新的 PEP，我不知道 setuptools。从长远来看，pip 和 buildout 将使用 distutils2 而不是作为底层库分发。

# java - 如何制作带有嵌入选项的自定义视频播放器！稀有的

> ID：10524086
> 
> 赞同：-1
> 
> 时间：2012-05-09T21:07:16.720
> 
> 标签：java, wordpress, actionscript-3

**第一个问题：** 创建视频播放器的最佳语言是什么？/ 有人指出我可以帮助我编写脚本的方向吗？

**第二个问题：**我如何编码这样的播放器来回显每个视频的嵌入代码：Ala youtube/break/viemo。

^ 令我惊讶的是，我在谷歌上搜索了一天半，甚至没有接近有人解释如何构建视频播放器，更不用说它可以选择吐出嵌入代码或任何其他共享选项。

**使用信息：** 一旦播放器完成，它将被导入到 wordpress，所以我可以完全控制每个视频并相应地管理它们。不寻求帮助以导入 WP，但任何提示都会很棒。

{请不要将我指向 VideoJS 或任何其他视频服务，因为我将自己制作并且不支付许可证费用。}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T22:18:06.967

通常，视频播放器是一个图片库，在整个电影期间每秒按顺序显示二十四张（或更多）图片。24 是一个人在视觉上将静态图片与运动混淆的最低限度，为了获得更好的效果，我建议 30 或更多。

视频播放器的第二个组件通常是音乐播放器，它每秒显示许多音乐“帧”，这些“帧”通过数字到模拟播放系统混合成类似于连续声音的东西。

“视频播放”系统通常需要让这两个子系统在不让一个领先于另一个的情况下运行。有许多“已经完成”的系统，但听起来您想构建自己的系统（添加独特的“功能”）。

请记住，在“视频播放”中移动的数据量非常大。这意味着如果可能的话，压缩数据对于合理的性能至关重要。压缩例程并不像看起来那么简单，主要的视频编解码器是那些在平衡 CPU 周期以解压缩、文件大小和生成的图像质量方面做得很好的编解码器。

假设您真的不想编写视频播放器，而只想使用“带有增强功能”的其他视频播放器，那么您将受制于现有视频播放器的构建程度，无论它是否支持任何类型定制，如果是，它对您所考虑的定制的支持程度。

由于速度是这样一个考虑因素，即使存在更高级的语言，传统上这些事情都是在 C、汇编甚至硬件加速芯片中完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:03:01.493

这些是我的想法，尽管您应该尝试搜索得更好一些...教程很容易找到...

您可以使用 Flash / ActionScript 创建自定义视频播放器。尽管越来越多的非 Flash 播放器正在兴起（HTML5），但它在网络上仍然很常见。由于性能，我仍然更喜欢 Flash，但请记住 iPhone / iPad 不支持 Flash...

如果您要在 Flash 中编写自己的视频播放器脚本，[本](http://active.tutsplus.com/tutorials/actionscript/build-a-dynamic-video-player-with-actionscript-3-part-1-of-3/)教程将引导您创建自己的实现...

对于您的第二个问题：只需为您的播放器将拥有的每个视频 URL 创建一个具有唯一 ID 的数据库。创建嵌入代码时，您可以将此唯一 ID 作为 URL 变量包含在主视频播放器中。从那里您可以使用 URL 变量调用您的播放器页面（例如：[http](http://www.yourlink.com?videoid=ID) ://www.yourlink.com?videoid=ID ）。

当您嵌入您的 SWF 对象时，您可以将 videoid 与 a 一起传递`FlashVar`，或者预取匹配的视频 URL 并将该 URL 与 a一起发送`FlashVar`到您的 SWF。这并不复杂，更多信息可以在[这里](http://helpx.adobe.com/flash/kb/pass-variables-swfs-flashvars.html)找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T23:40:54.457

试试[osmf.org](http://osmf.org "www.osmf.org")。您可以使用频闪媒体播放，也可以围绕它构建自己的播放器。OSMF 非常强大

# c# - 用于大型代码库的 C# 编译器会在具有巨大 RAM 的机器上运行得更快吗？

> ID：10524091
> 
> 赞同：1
> 
> 时间：2012-05-09T21:07:54.033
> 
> 标签：c#, clr, build-time

我在 2G RAM 机器上运行的大型遗留代码库中看到了一些真正缓慢的构建时间，而没有适当的程序集分解。所以，如果我想在不进行代码大修的情况下加快速度，如果童话 IT 部门提供一台 16G（或其他如此巨大的数量）RAM 机器，会不会快得多？换句话说，RAM 是足够大的 dotnet 项目的主要瓶颈还是存在其他主要问题？

出于纯粹的好奇，任何关于构建 Java 的类似情况的输入也受到赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:12:41.440

一旦您的 RAM 多于应用程序使用的 RAM，性能并不会随着 RAM 的增加而提高。使用 128GB 的​​ RAM，您可能看不到任何改进。

我们无法猜测所需的数量。通过查看任务管理器来衡量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T21:13:49.620

它肯定不会对你造成任何伤害...

2G对于开发机来说是很小的，我当然用16G。

但是，构建时间迟早会受到文件访问的限制，因此虽然您可能会得到一点改进，但​​我怀疑您不会被它所震撼。（[编辑]正如评论者所说，编译也可能受 CPU 限制）。

您是否研究过并行构建（例如，请参阅此 SO 问题：[Visual Studio 2010，如何在多核上并行构建项目](https://stackoverflow.com/questions/2849004/visual-studio-2010-how-to-build-projects-in-parallel-on-multicore)）。

或者，您是否可以重组您的代码库，并可能将一些更新频率较低的程序集删除到一个单独的 sln 中，然后将它们作为 DLL 引用（这在所有情况下都不是一个好主意，但有时它可能是权宜之计）。根据您对问题的描述，我猜这说起来容易做起来难，但这就是我们在代码库中取得良好结果的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-12T20:00:17.943

整个 RAM 问题实际上是 ROI（利息回报率）之一。您添加到系统的 RAM 越多，应用程序就越不可能搜索足够大的内存位置来存储特定大小的对象，并且运行速度越快；然而，在某个点之后，系统不太可能选择一个不够大的位置来存储对象，因此再往上走就毫无意义了。（请注意，RAM 棒的读/写速度也在其中发挥作用）。

**总结**：@ 2gb RAM，你绝对应该将它升级到更像 8gb 或建议的 16gb 但是做更多的事情几乎没有意义，因为瓶颈将来自处理器。 另外，注意 RAM 的速度可能也是一个好主意，因为这样你的 RAM 可能会成为瓶颈，因为它最多只能处理 XXXXmhz 时钟速度**。**不过，一般来说，1600mhz 就可以了。

# python - Pyglet 使用过多的 cpu

> ID：10524093
> 
> 赞同：2
> 
> 时间：2012-05-09T21:07:57.683
> 
> 标签：python, performance, pyglet

我最近开始从 pygame 进入 pyglet 和 rabbyt，但我遇到了一些障碍。

我创建了一个基本示例，其中一个 Sprite（在 pyglet.sprite.Sprite 中找到的类型）以每秒 60 帧的速度显示。问题是这个简单的程序以某种方式占用了 50% 的 CPU 时间。我用在 rabbyt 库中找到的 sprite 类型重复了实验，结果相同。

我决定以每秒 60 帧的速度渲染 1000 个精灵，然后是 10000 个精灵，令我惊讶的是 CPU 使用率保持在 50%。唯一的问题是移动或动画精灵会导致轻微的卡顿。

最后，我尝试以每秒 360 帧的速度运行。结果相同，使用率为 50%。

这是示例代码：

```
import pyglet
import rabbyt

def on_draw(dt):
    window.clear()
    spr.render()

global window
window = pyglet.window.Window(800, 600)
spr = rabbyt.Sprite('ship.png')
spr.x = 100
spr.y = 100
pyglet.clock.schedule_interval(on_draw, 1.0/60.0)

if __name__ == '__main__':
    pyglet.app.run() 
```

我正在使用带有 ATI HD 3500 卡的 Core 2 Duo。

任何建议/想法表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T06:42:01.200

请注意，默认的 pyglet 事件处理程序将在每次清除事件队列时触发“on_draw”事件。

[http://www.pyglet.org/doc/programming_guide/the_application_event_loop.html](http://www.pyglet.org/doc/programming_guide/the_application_event_loop.html)

> pyglet 应用程序事件循环在窗口事件（例如鼠标和键盘输入）发生时分派它们，并在循环的每次迭代后将 on_draw 事件分派到每个窗口。

这意味着**任何事件都可以触发重绘**。

因此，如果您正在移动鼠标或执行任何触发事件的操作，当它开始触发渲染调用时，您的速度会大大降低。

这也引起了问题，因为我正在执行自己的渲染调用，所以我会让两个缓冲区发生冲突，从而在屏幕上产生“幽灵”效果。我花了一段时间才意识到这是原因。

我猴子修补了事件循环以不这样做。 [https://github.com/adamlwgriffiths/PyGLy/blob/master/pygly/monkey_patch.py](https://github.com/adamlwgriffiths/PyGLy/blob/master/pygly/monkey_patch.py)

请注意，此修补**的事件循环将不再自行渲染**，您必须手动翻转缓冲区或触发“on_draw”事件。

可能的情况是，尽管您已经以 60fps 的速度进行连接，但内部渲染循环正在以最大可能的速率运行。

我不喜欢失去控制权的代码，因此我的补丁让我决定何时发生渲染事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T14:49:09.513

嗯..如果有帮助，您可能想知道游戏运行的 fps：

```
cldis = pyglet.clock.ClockDisplay() 
```

然后将其添加到您的 on_draw 函数中：

```
cldis.draw() 
```

它以半透明颜色在屏幕的左下角绘制当前 fps。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T03:07:20.580

我知道在 Pygame 中有内置的“时钟”。您可以使用 tick 方法限制游戏每秒循环的次数。在我的示例中，我设置了 30 FPS 的限制。这可以防止您的 CPU 处于持续需求状态。

```
clock = pygame.time.Clock() 

While 1:

    clock.tick(30) # Puts a limit of 30 frames per second on the loop 
```

在 pyglet 中似乎有类似的东西：

```
 pyglet.clock.schedule_interval(on_draw, 1.0/60.0)
    clock.set_fps_limit(60) 
```

希望有帮助！

编辑：关于 fps 限制的文档：http: [//pyglet.org/doc/api/pyglet.clock-module.html#set_fps_limit](http://pyglet.org/doc/api/pyglet.clock-module.html#set_fps_limit)

# php - 使用 jQuery (cakephp 2.1) 向表单添加标签

> ID：10524097
> 
> 赞同：1
> 
> 时间：2012-05-09T21:08:27.683
> 
> 标签：php, jquery, cakephp-2.1

我正在使用 cakephp 2.1 就好了；我想使用 jquery 让我的表单按标签划分。已经在蛋糕外使用了 jquery 并让标签演示工作。[http://jqueryui.com/demos/tabs/](http://jqueryui.com/demos/tabs/)
我还让 jquery 可用于 webroot 文件夹中的 cakephp 和

项目控制器.php

```
public $helpers = array('Js' => array('Jquery')); 
```

add.ctp（在最后一行）

```
echo $this->Js->writeBuffer(); // Write cached scripts 
```

我应该在哪里以及如何在我的视图中调用 jquery？我知道我应该使用类似于演示的东西：

```
<script>
        $(function() {
            $( "#tabs" ).tabs();
        });
    </script> 
```

但不知道在我看来在哪里做它和sintax。

任何人都可以帮忙吗？

非常感谢 ！

如果我的完整 add.ctp

```
<div class="projects form">
<?php echo $this->Form->create('Project');?>

<fieldset>
    <legend><?php echo __('Add Project'); ?></legend>
<?php
            $arr_pr_subject = Configure::read('AR_SUBJECT'); 
            $arr_pr_status = Configure::read('AR_STATUS'); 
            $arr_pr_payment = Configure::read('AR_PAYMENT'); 
            $arr_pr_country = Configure::read('AR_COUNTRY'); 
            echo $this->Form->input('name', array('label' => 'Name:'));
            echo $this->Form->input('pr_subject', array('label' => 'Subject:', 'options' => $arr_pr_subject));
            echo $this->Form->input('pr_country', array('label' => 'Country:', 'options' => $arr_pr_country));
            echo $this->Form->input('pr_number', array('label' => 'ASC Project Number:'));
            echo $this->Form->input('pr_status', array('label' => 'Status:', 'options' => $arr_pr_status));
            echo $this->Form->input('client_id', array('label' => 'Client:', 'options' => $clients));
            echo $this->Form->input('pr_client_number', array('label' => 'Client Project Number:'));
            echo $this->Form->input('exec_id', array('label' => 'Sales Executive:', 'options' => $execs));
            echo $this->Form->input('pr_start', array('label' => 'Est. Start Date:'));
            echo $this->Form->input('pr_end', array('label' => 'Est. End Date:'));
            echo $this->Form->input('pr_notes', array('label' => 'Notes:'));
            echo $this->Form->input('pr_payment', array('label' => 'Payment options:', 'options' => $arr_pr_payment));
?>
</fieldset>
<?php echo $this->Form->end(__('Submit'));?>
</div>
<?php
echo $this->Js->writeBuffer(); // Write cached scripts
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:21:24.567

在您的`<head>`中，包括 jquery 和 jqueryui：

```
<script src="/js/path/to/jquery.js" type="text/javascript"></script>
<script src="/js/path/to/jqueryui.js" type="text/javascript"></script> 
```

然后在它下面，包含一个单独的 js 文件来保存你的所有*代码*

`<script src="/js/myscripts.js" type="text/javascript"></script>`

在该文件 (myscripts.js) 中放入您的 jQuery 代码：

```
$(function() {
  $( "#tabs" ).tabs();
}); 
```

然后构建表单输入以匹配 jQuery Tabs 语法

```
<form action="...">
<div id="tabs">
  <ul>
    <li><a href="#tab1">Tab 1</a></li>
    <li><a href="#tab2">Tab 2</a></li>
  </ul>
  <div id="tab1">
    <!-- Tab 1 inputs in here -->
  </div>
  <div id="tab2">
    <!-- Tab 2 inputs here -->
  </div>
</div>
</form> 
```

# caching - Railo 正在缓存我的 cfc 和模板

> ID：10524099
> 
> 赞同：-1
> 
> 时间：2012-05-09T21:08:36.190
> 
> 标签：caching, cfc, railo, cfcache

我目前正在 railo 开发一个 cfc。

每次我对 cfc 进行更改时，我都必须进入管理员并清除所有四个缓存才能看到任何更改。

在设置 > 性能/缓存下，检查模板设置为始终。
在 Archives & Resources > Components 下，我没有选中缓存复选框。

这些设置都在 Web.cfm 和 Server.cfm 区域下设置。

在我工作的区域中，唯一的文件是一个空白的 Application.cfm 和一个带有 service.cfc 的 index.cfm，它们都没有调用`<cfcache>`标签。

我现在能做些什么来停止这种缓存？

我正在使用 Railo 3.3.1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T22:05:54.180

检查您的**映射**- 确保所有相关映射的检查模板选项设置为“始终”。

此选项独立于全局检查模板选项。（例如，允许您缓存很少更新的框架的映射，同时保持更改的映射不被缓存。）

# php - Joomla 1.5 管理员模块说明

> ID：10524100
> 
> 赞同：0
> 
> 时间：2012-05-09T21:08:44.377
> 
> 标签：php, joomla, joomla1.5, joomla-extensions

我为 Joomla 1.5 的管理后端开发了一个模块。描述是基于语言的，如下例所示：

```
MODULE_DESCRIPTION=This is the description of the module 
```

安装模块后，由于某种原因，描述显示为 MODULE_DESCRIPTION 但是当我在模块管理器中查看它时，它会正确显示。我不确定为什么会发生这种情况。我的代码中不能出现错误，因为它确实在模块管理器中正确显示。

安装时基于语言的描述中可能存在错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T11:42:24.233

在 Joomla 1.5 中，我认为您不需要下划线，但我不确定这是否是安装期间语言查找的原因 - 更有可能是我在下面提出的观点。

我能找到的两个最有用的语言文件参考是： [http](http://docs.joomla.org/Specification_of_language_files) ://docs.joomla.org/Specification_of_language_files （适用于所有 Joomla 版本） [http://docs.joomla.org/Creating_a_language_definition_file](http://docs.joomla.org/Creating_a_language_definition_file)（仅适用于 1.5）

一个潜在的问题是，在安装过程中，Joomla 会寻找 .sys.ini 文件来进行语言翻译，而在正常使用中它使用 .ini 文件。模块虽然不使用 .sys.ini 文件 - 或者至少我在 J1.5 中的模块构建文档中没有看到任何地方提到它们

# session - Node.JS / Express.JS CouchDB 会话存储

> ID：10524102
> 
> 赞同：1
> 
> 时间：2012-05-09T21:08:46.797
> 
> 标签：session, node.js, couchdb, express

是否有任何有效的会话存储或者我必须使用`MemoryStore`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T08:53:36.550

我不知道任何使用 CouchDB 的会话存储。您可以使用 MemoryStore，但是当您的进程重新启动时，您会丢失所有会话。我认为大多数人使用 redis 来存储他们的会话，但是在你的堆栈中还有其他额外的技术可能是不可取的。

# java - 如何使用 JDom 针对 XSD 模式验证 XML 文档

> ID：10524104
> 
> 赞同：0
> 
> 时间：2012-05-09T21:09:04.640
> 
> 标签：java, validation, jdom

我正在开发一个使用 JDom 解析**XML**文档的应用程序。

以下是现有代码：

```
private Document openDocumentAtPath(File file) {

        // Create a sax builder for building the JDOM document
        SAXBuilder builder = new SAXBuilder();

        // JDOM document to be created from XML document
        Document doc = null;

        // Try to build the document
        try {

            // Get the file into a single string
            BufferedReader input =  new BufferedReader(
                new FileReader( file ) );
            String content = "";
            String line = null;
            while( ( line = input.readLine() ) != null ) {
                content += "\n" + line;
            }

            StringReader reader = new StringReader( content );
            doc = builder.build(reader);

        }// Only thrown when a XML document is not well-formed
        catch ( JDOMException e ) {
            System.out.println(this.file + " is not well-formed!");
            System.out.println("Error Message: " + e.getMessage());
        } 
        catch (IOException e) {
            System.out.println("Cannot access: " + this.file.toString());
            System.out.println("Error Message: " + e.getMessage());
        }
        return doc;
    } 
```

现在我还想针对**XSD**验证 XML 。我阅读了[API](http://www.jdom.org/docs/apidocs.1.1/index.html?org/jdom/input/package-summary.html)，它告诉使用 JAXP 和其他东西，但我不知道如何使用。

该应用程序使用的是**JDom 1.1.1**，我在网上找到的示例使用了一些此版本中不可用的类。有人可以解释如何针对 XSD 验证 XML，尤其是对于这个版本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T21:13:31.787

从[JDOM FAQ](http://www.jdom.org/docs/faq.html#a0360)中简单地复制粘贴代码怎么样？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T21:32:48.590

或者，使用 JDOM 2.0.1，并更改行：

```
SAXBuilder builder = new SAXBuilder(); 
```

成为

```
SAXBuilder builder = new SAXBuilder(XMLReaders.XSDVALIDATING); 
```

请参阅 JDOM 2.0.1 javadoc（页面底部的示例）：[http ://hunterhacker.github.com/jdom/jdom2/apidocs/org/jdom2/input/sax/package-summary.html](http://hunterhacker.github.com/jdom/jdom2/apidocs/org/jdom2/input/sax/package-summary.html)

哦，我应该更新常见问题解答

# c# - 委托会导致内存泄漏吗？GC.TotalMemory(true) 似乎表明了这一点

> ID：10524107
> 
> 赞同：15
> 
> 时间：2012-05-09T21:09:13.803
> 
> 标签：c#, .net, memory-leaks, delegates, garbage-collection

**代码**

```
using System;
internal static class Test
{
    private static void Main()
    {
        try
        {
            Console.WriteLine("{0,10}: Start point", GC.GetTotalMemory(true));
            Action simpleDelegate = SimpleDelegate;
            Console.WriteLine("{0,10}: Simple delegate created", GC.GetTotalMemory(true));
            Action simpleCombinedDelegate = simpleDelegate + simpleDelegate + simpleDelegate;
            Console.WriteLine("{0,10}: Simple combined delegate created", GC.GetTotalMemory(true));
            byte[] bigManagedResource = new byte[100000000];
            Console.WriteLine("{0,10}: Big managed resource created", GC.GetTotalMemory(true));
            Action bigManagedResourceDelegate = bigManagedResource.BigManagedResourceDelegate;
            Console.WriteLine("{0,10}: Big managed resource delegate created", GC.GetTotalMemory(true));
            Action bigCombinedDelegate = simpleCombinedDelegate + bigManagedResourceDelegate;
            Console.WriteLine("{0,10}: Big combined delegate created", GC.GetTotalMemory(true));
            GC.KeepAlive(bigManagedResource);
            bigManagedResource = null;
            GC.KeepAlive(bigManagedResourceDelegate);
            bigManagedResourceDelegate = null;
            GC.KeepAlive(bigCombinedDelegate);
            bigCombinedDelegate = null;
            Console.WriteLine("{0,10}: Big managed resource, big managed resource delegate and big combined delegate removed, but memory not freed", GC.GetTotalMemory(true));
            GC.KeepAlive(simpleCombinedDelegate);
            simpleCombinedDelegate = null;
            Console.WriteLine("{0,10}: Simple combined delegate removed, memory freed, at last", GC.GetTotalMemory(true));
            GC.KeepAlive(simpleDelegate);
            simpleDelegate = null;
            Console.WriteLine("{0,10}: Simple delegate removed", GC.GetTotalMemory(true));
        }
        catch (Exception e)
        {
            Console.WriteLine(e);
        }
        Console.ReadKey(true);
    }
    private static void SimpleDelegate() { }
    private static void BigManagedResourceDelegate(this byte[] array) { }
} 
```

**输出**

```
GC.TotalMemory(true)
    105776: Start point
    191264: Simple delegate created
    191328: Simple combined delegate created
 100191344: Big managed resource created
 100191780: Big managed resource delegate created
 100191812: Big combined delegate created
 100191780: Big managed resource, big managed resource delegate and big combined delegate removed, but memory not freed
    191668: Simple combined delegate removed, memory freed, at last
    191636: Simple delegate removed 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-09T21:27:25.187

有趣的案例。这是解决方案：

![在此处输入图像描述](../Images/0fd113027f65a74e5427dac7d4137980.png)

结合委托在**观察上是纯粹**的：看起来委托对外部是不可变的。但**在内部，现有的代表正在被修改**。在某些情况下，出于性能原因，它们共享相同`_invocationList`的内容（针对少数代表连接到同一事件的场景进行优化）。不幸的是，`_invocationList`对于导致内存保持活动的`simpleCombinedDelegate`引用。`bigMgdResDelegate`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T21:34:28.313

我可能错过了这里的重点，但是垃圾收集在设计上是不确定的。因此，由 .NET 框架决定何时回收内存。

您可以在一个简单的循环中运行 GC.GetTotalMemory 并获得不同的数字。也许不足为奇，因为文档指定返回的数字是一个近似值。

# php - mysqli 不与 php 对话

> ID：10524109
> 
> 赞同：1
> 
> 时间：2012-05-09T21:09:17.653
> 
> 标签：php, mysql, mysqli

在基于 Ubuntu 的全新虚拟服务器上工作。

我正在通过 SSH 安装 Moodle（这些页面上没有帮助）。在安装过程中，系统提示我安装 cURL。我这样做了，但出错了。我找到了一个没有错误的更好的命令。当 Apache2 重新启动时，我的安装状态页面（放置 curl 通知的位置）被破坏，并且出现一个静态的“检测到数据库驱动程序错误”页面，显示 mysqli 和 php 没有通信。当我查看 phpinfo 时，我没有在加载的模块中看到 mysql 或 mysqli 。正在解析 mysqli.ini 文件，但未加载。

在终端中，MySQL 运行正常。我可以登录并做任何我想做的事情。除此错误外，网络服务器运行正常。

我什至升级到最新版本的 Ubuntu (12.x) 并且错误仍然存​​在，即使我使用了包维护者的 .ini 文件。

对于如何在我的 Web 服务器中恢复 mysqli 功能的任何想法，我将不胜感激。

# javascript - 使用选定元素实现滚轮效果

> ID：10524117
> 
> 赞同：0
> 
> 时间：2012-05-09T21:09:46.370
> 
> 标签：javascript, html, css

我将尽力解释这一点。我使用本教程[http://tympanus.net/codrops/2010/06/28/awesome-cufonized-fly-out-menu/](http://tympanus.net/codrops/2010/06/28/awesome-cufonized-fly-out-menu/)为我的网站使用水平导航菜单。我目前正在尝试调整教程中的 javascript。当我在每个链接上移动鼠标时，我想保持鼠标悬停在每个链接上，但我希望始终突出显示选定的链接（它目前没有此功能）。

我遇到的问题：如果我目前在投资组合链接上并且它被突出显示并且我最后将鼠标悬停在主页按钮上（在将鼠标从菜单 div 移开之前）它会突出显示我的主页链接，即使我目前在我的投资组合页面。

这是我的代码：

```
$(document).ready(function(){
            var $menu = $("#slidingMenu");

            /**
            * the first item in the menu, 
            * which is selected by default
            */
            var $selected = $menu.find('li:first');

            /**
            * this is the absolute element,
            * that is going to move across the menu items
            * it has the width of the selected item
            * and the top is the distance from the item to the top
            */
            var $moving = $('<li />', {
                'class' : 'move',
                'top'   : $selected[0].offsetTop + 'px',
                'width' : $selected[0].offsetWidth + 'px'
                });

            /**
            * each sliding div (descriptions) will have the same top
            * as the corresponding item in the menu
            */
            $('#slidingMenuDesc > div').each(function(i){
                var $this = $(this);
                $this.css('top',$menu.find('li:nth-child('+parseInt(i+2)+')')[0].offsetTop + 'px');
            });

            /**
            * append the absolute div to the menu;
            * when we mouse out from the menu 
            * the absolute div moves to the top (like innitially);
            * when hovering the items of the menu, we move it to its position 
            */
            $menu.bind('mouseleave',function(){
                    //moveTo($selected,400);
                  })
                 .append($moving)
                 .find('li')
                 .not('.move')
                 .bind('mouseenter',function(){
                    var $this = $(this);
                    var offsetLeft = $this.offset().left + $(window).width() - ($this.outerWidth() + 20);
                    //slide in the description
                    $('#slidingMenuDesc > div:nth-child('+ parseInt($this.index()) +')').stop(true).animate({'width':offsetLeft+'px'},400, 'easeOutExpo');
                    //move the absolute div to this item
                    moveTo($this,400);
                  })
                  .bind('mouseleave',function(){
                    var $this = $(this);
                    var offsetLeft = $this.offset().left - 20;
                    //slide out the description
                    $('#slidingMenuDesc > div:nth-child('+ parseInt($this.index()) +')').stop(true).animate({'width':'0px'},400, 'easeOutExpo');
                  });

            /**
            * moves the absolute div, 
            * with a certain speed, 
            * to the position of $elem
            */
            function moveTo($elem,speed){
                $moving.stop(true).animate({
                    top     : $elem[0].offsetTop + 'px',
                    width   : $elem[0].offsetWidth + 'px'
                }, speed, 'easeOutExpo');
            }
        }); 
```

这是我的菜单CSS：

```
body{
background:#292929;
overflow: hidden;
font-family: Arial, Helvetica, sans-serif;
}
.slidingMenu {
position: absolute;
top:250px;
left: 0px;
padding-bottom: 10px;
width: 400px;
}
.slidingMenu li {
display:block;
float:left;
clear:both;
padding-left: 12px;
height: 52px;
line-height: 52px;
}

.slidingMenu li.selected{
display:block;
float:left;
clear:both;
padding-left: 12px;
height: 52px;
line-height: 52px;
}
.slidingMenu li.move {
width: 9px;
position: absolute;
z-index: 8;    
background: #df0101;     
background: 
    -webkit-gradient(
        linear, 
        left top, 
        left bottom, 
        from(#a70404), 
        to(#df0101)
    );     
background: 
    -moz-linear-gradient(
        top, 
        #a70404, 
        #df0101
    );     
-moz-border-radius: 0px 8px 8px 0px;  
-webkit-border-top-right-radius: 8px;       
-webkit-border-bottom-right-radius: 8px; 
border-top-right-radius: 8px;  
border-bottom-right-radius: 8px;        
-moz-box-shadow:1px 1px 5px #000;
-webkit-box-shadow:1px 1px 5px #000;
box-shadow:1px 1px 5px #000;    
}
.slidingMenu li a {
font-size:50px;
text-transform:uppercase;
text-decoration: none;
color: #FFF;
text-indent:5px;
z-index: 10;
display: block;
z-index: 10;
float: right;
line-height: 50px;
position: relative;
padding-right:10px;
}

/* Descriptions */
.slidingMenuDesc{
margin-top:40px;
position:relative;
}
.slidingMenuDesc div{
background: #df0101;     
background: 
    -webkit-gradient(
        linear, 
        left top, 
        left bottom, 
        from(#a70404), 
        to(#df0101)
    );     
background: 
    -moz-linear-gradient(
        top, 
        #a70404, 
        #df0101
    );      
height: 52px;
right:-5px;
width:0px;
overflow:hidden;
position:absolute;
-moz-box-shadow:1px 1px 5px #000;
-webkit-box-shadow:1px 1px 5px #000;
box-shadow:1px 1px 5px #000;
-moz-border-radius: 8px 0px 0px 8px;  
-webkit-border-top-left-radius: 8px;        
-webkit-border-bottom-left-radius: 8px; 
border-top-left-radius: 8px;  
border-bottom-left-radius: 8px; 
}
.slidingMenuDesc div span {
font-size:24px;
color: #f0f0f0;
display: block;
z-index: 10;
line-height: 52px;
position:absolute;
margin-left: 30px;
} 
```

希望我已经解释得足够清楚了。我的 javascript 技能非常薄弱——我才开始使用这种编码格式，因为这是我第一次尝试创建网站。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:15:54.600

你可以为它制作一个jsfiddle吗？我会欣赏 html 部分，仅用于 id、类等。然后我将编辑我的问题以正确回答。

我真的不明白你的问题。您希望链接在悬停时具有样式，并且即使您将鼠标移离它也希望它保持这种样式，但是您希望链接以第三种方式设置样式（悬停之前，悬停，但是，悬停并且仍然亮着）如果鼠标当前位于链接顶部，我明白了吗？

***- 更新：***

在这里，有相应的评论：

**[jsfiddle.net/VYuS6/2](http://jsfiddle.net/VYuS6/2)**

我认为您唯一的问题是缺少对所需 API 等的参考。

PS。：它在我的 PC 上的所有浏览器中都能完美运行。PS.2：Jsfiddle 不接受我的 css 引用，但它在 jsfiddle 之外工作。

# node.js - 使用 NodeJS fs.watch 重命名操作获取以前的文件名

> ID：10524121
> 
> 赞同：4
> 
> 时间：2012-05-09T21:10:03.940
> 
> 标签：node.js, filesystems

是否可以在 NodeJS 中使用 fs.watch 获取重命名文件的先前名称？例如：

```
var fs = require("fs");
fs.watch("some_file",function(action,filename){
    if (action == "rename" && filename)
        console.log("what was the old filename, before the rename action?");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:12:51.113

仅在 Windows 和 Linux 上。在 OS X 上，内核不支持将文件名发送回回调的必要功能。

哦，我误解了这个问题。您不想看到新名称。您想获得旧名称。

据我所知，该 API 目前不支持该功能。

# version-control - 在 TFS 中存储第三方 ISV 补丁、脚本和二进制文件的有效方法是什么

> ID：10524133
> 
> 赞同：0
> 
> 时间：2012-05-09T21:11:01.860
> 
> 标签：version-control, tfs

我们主要购买软件，然后在其上编写集成和 Web 服务（或者“它们之间”可能更准确）。我们需要使用大量供应商提供的补丁、DLL 文件、数据库脚本，这些文件会随着时间的推移收集并存储它们。然后我们需要将它们部署到开发，然后进行测试，然后是 staging，然后是生产。有没有人有聪明的方法在 TFS 项目/文件夹中构造这种类型的数据？TFS 可能不是最好的解决方案，但恐怕对于这个问题必须给出它。

示例：按环境划分的项目？按环境分支？按日期按时间顺序排列的文件夹？（鉴于像源代码一样对文件本身进行版本控制并没有真正意义）

作为解决方案的一部分，我们希望跟踪这些文件何时部署到哪个环境中，并且可以很容易地返回并发现 x .dll 作为项目 y 的一部分部署在 12 月 5 日。的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T12:32:56.300

我想说，首选的解决方案是将这些外部依赖项版本控制在与您自己的开发并行的自己的目录中，然后引用该目录。然后它将成为任何分支的一部分，如果需要，您可以在开发、测试和生产中拥有单独的版本。您还可以创建特定的分支来针对来自任何供应商的补丁测试您的解决方案。例子：

```
$/Development-Branch
   |+3PP
   ||+Vendor-1
   |||+ Bin
   |||+ ...
   ||+Vendor-2
   | |+...
   |+Our-Project-1
   ||+ ...
   |+Our-Project-2
    |+ ...
$/Test-Branch (based on $Develeopment-Branch version XXX)
   |+3PP
    |+ ... 
```

缺点是这些外部依赖项可能会占用大量空间（如果它们很大的话），但这现在应该不是什么大问题，而且如果供应商本身并不真正支持它。他们可能会在不同版本之间的库等上使用不同的名称，这会使以正确的方式对它们进行版本控制很痛苦。

# wpf - 如何使用 WPF 中的 UI 线程以外的另一个线程捕获所有键盘事件？

> ID：10524135
> 
> 赞同：1
> 
> 时间：2012-05-09T21:11:07.867
> 
> 标签：wpf, multithreading, user-interface, keyboard, capture

我希望在 WPF 窗口上触发的所有键盘事件都由 UI 线程之外的另一个线程处理。如何分离 UI 渲染和键盘捕获？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:21:49.683

我不认为有任何超级优雅的方式来做到这一点，你想要的不是......

```
private void KeyPress(object sender, RoutedEventArgs e)
{
    bgWorkerKeyPress.RunWorkerAsync();
} 
```

# joomla - 仅在菜单项上显示模块，但不在 Joomla 中的项目（文章）页面上显示模块

> ID：10524141
> 
> 赞同：0
> 
> 时间：2012-05-09T21:11:28.977
> 
> 标签：joomla, joomla-k2

我在一个网站上工作，我只想在菜单页面上显示一些模块，而不是在 joomla 中该菜单项的子文章上。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T23:35:35.543

您可以使用此扩展来更好地控制模块的显示位置，甚至可以根据 url 进行设置... [LINK](http://extensions.joomla.org/extensions/style-a-design/modules-management/10307)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-06-01T04:47:29.133

只需转到管理员 > 扩展 > 模块 > 单击您要编辑的菜单。然后，您将在该模块内有一个菜单分配选项卡。然后在该下拉列表中选择“仅在所选页面上”。您将拥有下面的所有菜单项。只需选择或取消选择要显示该项目的位置。[在此处输入图像描述](http://i.stack.imgur.com/ArA7u.png)

# python - 如果值不存在，Python 字典返回请求的键

> ID：10524142
> 
> 赞同：6
> 
> 时间：2012-05-09T21:11:41.510
> 
> 标签：python, python-2.7

我正在寻找一种能够从字典中获取值的简单方法，如果它不存在，则返回用户传入的键。

例如：

```
>>> lookup = defaultdict(magic)
>>> print lookup['DNE']
'DNE'
>>> print lookup.get('DNE')
'DNE'
>>> print lookup['exists']
'some other value'
>>> print lookup.get('exists')
'some other value' 
```

这些将始终是字符串，但基本上我正在创建一个语言映射并且需要一种简单的方法来获取一个值，如果它存在则返回它，否则返回键。

有什么简单的方法可以做到这一点？或者我应该扩展 dict 并手动完成。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-09T21:13:58.127

我认为`defaultdict`在这里不会对您有所帮助，因为生成默认值的函数无权访问请求的密钥。

但是，您使用普通字典并使用[`get`](http://docs.python.org/library/stdtypes.html#dict.get)默认值：

```
>>> lookup = {}
>>> key = 'DNE'
>>> lookup.get(key, key)
'DNE' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-09T21:22:03.107

应该可以使用 lambda 函数

```
from collections import defaultdict
a = defaultdict((lambda : 'DNE')) 
```

编辑：对不起，我误读了这个问题。正如上面的评论已经说过的。要走的路是扩展 dict 类。

```
>>> class mydict(dict):
...     def __missing__(self,key):
...         return key
... 
>>> a = mydict()
>>> a['asd']
'asd' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T05:33:24.913

这至少在 Python 2.7 下有效：

```
from collections import defaultdict

class KeyAwareDefaultDict(defaultdict):
    def __missing__(self, key):
        if self.default_factory is None:
            raise KeyError(key)
        self[key] = value = self.default_factory(key)
        return value

lookup = KeyAwareDefaultDict((lambda key: key)) 
```

与标准 dict 不同，defaultdict.get() 似乎也调用了 __missing__，因此它为扩展提供了更好的基础。

# c++ - vector.insert() 导致内存损坏

> ID：10524145
> 
> 赞同：1
> 
> 时间：2012-05-09T21:11:54.183
> 
> 标签：c++, vector, memory-corruption

我对 C++ 不是很有经验，所以我可能会遗漏一些明显的东西。我知道 vector.insert 的“无效迭代器”问题，但我不知道在这种情况下会发生什么。还涉及一些 OpenMP，但插入本身位于并行块之外。

```
void doWork(vector<Solution> &sol)
{
    vector<Solution> partial[40];

    #pragma omp parallel for ... shared(partial) ...
    for (...) {
        ...
        partial[tid].push_back(Solution(i,j));
        ...
    }

    for (i = 0; i < 40; i++)
        sol.insert(sol.end(), partial[i].begin(), partial[i].end());
} 
```

编辑：错误消息是标准错误分配。我确信没有超过 40 个线程。显然，即使有 1 个线程也会发生这种情况（打开和关闭）。更有趣的是另一种解决方案：

```
for(i = 0; i < 40; i++)
    for(j = 0; j < partial[i].size(); j++)
        sol.push_back(partial[i][j]); 
```

似乎一直在工作，在可变数量的线程上。

# javascript - JS 可以在 Firefox 中运行，但不能在 chrome 和 IE 中加载

> ID：10524149
> 
> 赞同：1
> 
> 时间：2012-05-09T21:12:26.620
> 
> 标签：javascript, jquery, internet-explorer, google-chrome, cross-browser

我们的 js 播放器在 Firefox 中正确加载，但在 Chrome 或 IE 中无法运行。对于以下错误，我尝试了 stackoverflow 上提到的其他解决方法：

未捕获的类型错误：对象 # 没有方法 'fancybox'

4event.layerX 和 event.layerY 在 WebKit 中被破坏和弃用。它们将在不久的将来从引擎中移除。

但不起作用。我尝试异步加载 js 文件，但它似乎没有在 chrome 和 IE 中加载。

这是我们的页面网址：[http ://www.iorad.com/?a=app.htmlplayer&accessCode=GUEST&remote=true&module=3225](http://www.iorad.com/?a=app.htmlplayer&accessCode=GUEST&remote=true&module=3225)

按下绿色播放按钮应打开下一张幻灯片，您可以在 Firefox 中看到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:43:22.097

我得到的唯一错误是：“未捕获的 ReferenceError：分配中的左侧无效”。在标签内使用 javascript 注释语法而不是 html。

# django - 使用迭代器（）时，Django“生成器”对象不可下标

> ID：10524154
> 
> 赞同：0
> 
> 时间：2012-05-09T21:12:49.963
> 
> 标签：django, iterator

我正在尝试通过在我的查询集上使用 iterator() 来优化我的 Web 应用程序以节省内存。

但是，如果我这样做：

```
q = (
    Q(longname__icontains = query) |
    Q(genus__icontains = query) |
    Q(specific_epithet__icontains = query) |
    Q(infraspecific_epithet__icontains = query) |
    Q(collectedby__personname__icontains = query) |
    Q(islandname__icontains = query) |
    Q(es_name__icontains = query) |
    Q(en_name__icontains = query) |
    Q(local_name__icontains = query)
)
query_set = Specimen.objects.filter(q).order_by('longname').iterator()[:1000] 
```

我收到以下错误：

```
TypeError at /search/
'generator' object is not subscriptable 
```

如果我尝试：

```
query_set.count() 
```

我得到：

```
AttributeError at /search/
'generator' object has no attribute 'count' 
```

我的问题是 - 我如何在这种类型的查询上使用迭代器，它真的值得吗？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T01:10:35.520

`iterator()`将 QuerySet 转换为生成器对象，该对象不再可下标且没有`.count()`方法。
在将 QuerySet 转换为生成器之前，切片和其他特定于 QuerySet 的操作也是如此（之后您只能通过迭代来访问生成器）：

```
query_set = Specimen.objects.filter(q).order_by('longname')[:1000].iterator() 
```

或者您可以按照 Ignacio 的建议对发电机进行操作

```
query_set = Specimen.objects.filter(q).order_by('longname').iterator()
from itertools import islice
g = islice(query_set, 1000) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T21:57:52.007

您可以使用`itertools.islice()`切片生成器。您将需要执行单独的`COUNT(*)`查询以获取返回的记录总数。

# php - 重新索引数字数组键

> ID：10524156
> 
> 赞同：22
> 
> 时间：2012-05-09T21:12:51.427
> 
> 标签：php, arrays, indexing

我有一个使用该`explode()`函数构建的数组，但是看到我如何将它与随机/动态数据一起使用，我发现索引不断变化：

```
Array
(
    [2] => Title: Warmly little before cousin sussex entire set Blessing it ladyship.
    [3] => Snippet: Testing
    [4] => Category: Member
    [5] => Tags: little, before, entire
) 
```

我需要始终从 0 开始对数组进行排序。我正在使用不同的数据进行测试，有时它从 0 开始，而在其他测试中，它从不同的数字开始。我研究并发现[Array 从零开始](https://stackoverflow.com/questions/5113325/array-starting-at-zero)，但似乎只适用于该用户的特定情况。我用来构建数组的代码可以在这里看到： [https ://stackoverflow.com/a/10484967/1183323](https://stackoverflow.com/a/10484967/1183323)

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-05-09T21:17:10.423

```
$your_new_array = array_values($your_old_array); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-09T21:15:45.663

使用[array_merge()](http://php.net/array_merge)对数组重新编号：

```
$your_old_array = array( 2 => 'whatever', 19 => 'huh', 22 => 'yep' );
$your_new_array = array_merge($your_old_array);
print_r($your_new_array); 
```

打印这个：

```
Array ( 
  [0] => whatever 
  [1] => huh 
  [2] => yep ) 
```

# java - 将特定字符串转换为 byte[]

> ID：10524159
> 
> 赞同：1
> 
> 时间：2012-05-09T21:13:01.547
> 
> 标签：java, string, byte

我正在尝试将特定的字符串转换为字节 []。

字符串看起来像：55 55 F5 FF FF

这是我为它写的方法，希望有人能告诉我哪里出了问题或有更好的解决方案。

```
public static byte[] stringToByte(String text) {
    //byte[] length ==> String (length+1)/3
    byte raw[] = new byte[(text.length() + 1) / 3];
    int j = 0;
    for (int i = 0; i < text.length(); i += 2) {
        String h = "";
        h += text.charAt(i);
        h += text.charAt(i + 1);
        i++;
        raw[j] = Byte.valueOf(h);
        j++;
    }
    return raw;
} 
```

问题是它在 F5 之前一直有效。

我需要在 byte[] 中使用相同的值，就好像我使用

```
byte raw[] = {(byte) 0x55, (byte) 0x55, (byte) 0x5F,(byte) 0xFF,(byte) 0xFF}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:20:40.130

这将起作用：

```
public static byte[] stringToByte(String text) {
  final String[] split = text.split("\\s+");
  final byte[] result = new byte[split.length];
  int i = 0;
  for (String b : split) result[i++] = (byte)Integer.parseInt(b, 16);
  return result;
} 
```

为什么？`byte`是一个有符号数量，您不能将任何超出其范围的内容直接解析为`byte`. 但是，如果您解析 an`int`然后使用缩小转换为`byte`，您将得到结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T21:18:59.190

看起来您只是在循环使用空格分隔的 String 并解析 Byte 对象。在这种情况下，我建议使用类似的东西：

```
 String text = "";
         String[] strArr = text.split(" ");
         for (String str: strArr)
         {
             //convert string to byte here
         } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T21:24:50.933

```
byte[] raw = new byte[text.length() >> 1];
for(int i=0; i<text.length();i+=2){
    raw[i >> 1] = Integer.parseInt(text.substring(i, i+2),16);
} 
```

我使用`Integer.parseInt()`而不是`Byte.parseByte()`因为 Byte 不是无符号字节。我试过了`String text = "55555FFF";`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T21:43:15.240

您也可以使用`StringTokenizer`每个令牌。

```
public static byte[] stringToByte(String text) {
    StringTokenizer st = new StringTokenizer(text);
    byte raw[] = new byte[st.countTokens()];
    for (int i = 0; i < raw.length; i++) {
        raw[i] = (byte) Integer.parseInt(st.nextToken(), 16);
    }
    return raw;
} 
```

# spring - Spring Data Mongodb：更新文档

> ID：10524160
> 
> 赞同：2
> 
> 时间：2012-05-09T21:13:05.397
> 
> 标签：spring, mongodb

我目前正在尝试弄清楚如何通过 Spring Data 更新 MongoDb 中的文档。当然还有 mongoTemplate.updateFirst 等。但是考虑一下：

```
User u = mongoTemplate.findOne(new Query(Criteria.where("_id").is(s)), User.class);
if (u == null) throw new UsernameNotFoundException("user " + s + " does not exist");
Session.setCurrentUser(u);
mongoTemplate.updateFirst(new Query(Criteria.where("_id").is(s)), new Update().inc("logincount", 1), User.class); 
```

...查询用户，如果发现将 logincount 增加 1，则在 null 上抛出异常。完美运行。但这是正确的方法吗？我必须*再次*查询用户吗？我不能修改对象并重新保存它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T14:24:34.943

您可以通过执行以下操作来避免额外的查询：

```
WriteResult result = mongoTemplate.updateFirst(new Query(Criteria.where("_id").is(s)), new Update().inc("logincount", 1), User.class);
if (result.getN() != 1) {
   throw new UsernameNotFoundException("user " + s + " does not exist");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:45:41.013

您可能应该使用 upsert 语义。

请参阅这篇文章中的答案：[MongoDB and upsert issue](https://stackoverflow.com/questions/10490205/mongodb-and-upsert-issue/10494130)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T23:48:30.210

如果您准备使用模板进出实体，只需执行以下操作：

```
User user = template.findOne(query(where("id").is(id)), User.class);
// manipulate object
template.save(user); 
```

您可能还想查看存储库，因为它们实际上不需要您制定查询。

# android - 立即让 ProgressBar 覆盖在 VideoView 上显示

> ID：10524164
> 
> 赞同：0
> 
> 时间：2012-05-09T21:13:29.567
> 
> 标签：android, android-videoview, android-progressbar

我在 RelativeLayout 内都有一个 ProgressBar 和一个 VideoView，ProgressBar 以 z 顺序浮动在 VideoView 上方（在 XML 之后）。ProgressBar 是不确定的。当我切换视频源时，我通过将其可见性设置为 View.VISIBLE 来显示 ProgressBar，直到新视频正在播放。我在 UI 线程中执行此操作。

但是我的 ProgressBar 不会立即显示，尽管我的日志语句（也在 UI 线程中，在 setVisibility() 调用之前）立即发生。这需要几（2 或 3）秒。我已经尝试了很多方法来使 ProgressBar 立即显示并且已经没有想法了。

*   添加动画（到 ProgressBar；也到 RelativeLayout）
*   使可见性变化发生在动画结束时
*   进度条.bringToFront()
*   progressBar.invalidate() 和 postInvalidate()
*   relativeLayout.invalidate() 和 postInvalidate()

如何让 ProgressBar 立即出现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:04:15.790

可能尝试使完整视图无效或执行 setContentView(R.layout.abc);

我在类似情况下所做的也是使用调度程序启动后续代码，以便 UI 屏幕更新有时间更新并且不会被优先推回。如果您可以在代码中执行此操作，甚至 0.5 秒通常就足够了...？

# python - 使用 Python 比较 UTC 时间和东部时间的时间

> ID：10524165
> 
> 赞同：6
> 
> 时间：2012-05-09T21:13:30.560
> 
> 标签：python, datetime, timezone, pytz

我正在尝试使用 Python 模块比较两次`datetime`，但我似乎无法`time`在 UTC 中创建时区感知对象。

```
>>> import pytz, datetime
>>> UTC_TZ = pytz.utc
>>> EASTERN_TZ = pytz.timezone('America/New_York')
>>> d1 = datetime.time(10, tzinfo = UTC_TZ)
>>> d1
datetime.time(10, 0, tzinfo=<UTC>)
>>> d2 = datetime.time(10, tzinfo = EASTERN_TZ)
>>> d2
datetime.time(10, 0, tzinfo=<DstTzInfo 'America/New_York' EST-1 day, 19:00:00 STD>)
>>> d1 < d2
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: can't compare offset-naive and offset-aware times 
```

这是一个错误吗？我需要使用特殊的 UTC 时区吗？这是怎么回事？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-09T22:49:32.617

所有的功劳都归功于 wberry 解决了这个问题，但为了得到一个简洁的答案，我将在这里总结一下。

根据 datetime 文档，在比较两个 datetime.time 对象时：“如果两个比较对象都知道并且具有不同的 tzinfo 属性，则首先通过减去它们的 UTC 偏移量（从 self.utcoffset() 获得）来调整比较对象”

在您给出的示例中，比较会引发 TypeError，因为 EASTERN_TZ.utcoffset() 返回 None。utcoffset 为无，因为美国东部遵守夏令时，因此与 UTC 的时间偏移取决于 datetime.time 中不可用的日期。

您应该使用 datetime.datetime 对象进行跨时区比较：

```
>>> import pytz, datetime
>>> UTC_TZ = pytz.utc
>>> EASTERN_TZ = pytz.timezone('America/New_York')
>>> d1 = datetime.datetime(2012, 1, 1, 10, 0, tzinfo=UTC_TZ)
>>> d2 = datetime.datetime(2012, 1, 1, 10, 0, tzinfo=EASTERN_TZ)
>>> d1 < d2
True 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T21:47:42.487

您收到错误是因为您试图测量一个`time`可以绑定到特定 UTC 时刻的`time`对象与另一个“幼稚”且不能绑定到特定 UTC 时刻的对象之间的差异。解决方法是使两个比较对象都具有偏移感知，或者两者都幼稚。

下面使用`datetime`对象，但它基本上是相同的想法。

```
import datetime, time, pytz

EST = pytz.timezone('America/New_York')
UTC = pytz.timezone('Etc/UTC')
dt1 = datetime.datetime.fromtimestamp(time.time(), EST)
# ... time passes
dt2 = datetime.datetime.fromtimestamp(time.time(), UTC)
elapsed = dt2 - dt1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T21:22:57.780

我猜问题是UTC被认为不是任何时区，或者“偏移天真”，也许？我建议在进行任何比较之前将所有内容都转换为 UTC。

显然，您需要知道输入和输出的时区，但是您应该尝试将内部表示全部保持为 UTC，并且可能只存储每个用户的时区并在需要时进行转换。从长远来看，它会省去很多麻烦。

另外，你不应该这样做。最好用

```
timezone.localize(dt) 
```

如此处所述：http: [//pytz.sourceforge.net/#localized-times-and-date-arithmetic](http://pytz.sourceforge.net/#localized-times-and-date-arithmetic)

# biztalk - SQL 发送端口完成将数据放入数据库后的通知

> ID：10524170
> 
> 赞同：0
> 
> 时间：2012-05-09T21:13:35.613
> 
> 标签：biztalk, biztalk-2010, biztalk-2009, biztalk2006r2

我有 6 个发送端口……一旦将数据放入所有 6 个表中……

我想从一个表中获取一个数据并在所有其他 5 个表上更新它.....

我已经为此编写了存储过程...

但我只想在它完成它的过程后才这样做.....

反正有没有。。

我只想在将数据放入所有表中后才运行我的存储过程...

因为如何知道我的发送端口是用插入语句完成的......现在我可以运行我的存储过程......

它是一个大文件..将数据放入数据库大约需要 2 小时......但我想自动化这个过程......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T05:35:18.530

你需要的可能是一个简单的编排来处理这个过程。

可以通过接收传入文件并将其发送到所有发送端口来激活编排。然后它将等待每个端口的响应。收到所有回复后，您可以继续前进并触发您的最终 SP 以读取和更新最后一个表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T10:39:26.403

我可以看到两个潜在的解决方案：

**1.简单而稍微复杂的方法：**

“数据插入”编排使用并行操作形状（具有六个单独的操作）将插入语法发送到相关数据库（或者可能是单个复合插入语法 - 但我无法评论并行性）。一旦每个插入动作完成，后续的顺序动作就会更新控制表以将数据标记为“成功插入”。

一个单独的编排轮询控制表，等待每个“成功插入”的记录被插入；一旦有六个，调用您的存储过程。

**2\. 复杂而优雅的方法：**

使用分散和聚集模式（Google 'BizTalk Scatter Gather Pattern'），主编排在插入数据时接收响应（这将为您提供真正的并行性）。完成所有分散编排后，调用您的存储过程。

# python - QTableWidget - 将按钮拖放到 QTableWidget 中的单元格中

> ID：10524178
> 
> 赞同：1
> 
> 时间：2012-05-09T21:14:29.987
> 
> 标签：python, pyqt

当我将按钮拖放到 QTableWidget 中时，按钮从旧位置消失，并且在我放置按钮的单元格中不显示任何内容。

任何人都可以建议有什么问题吗？

请在下面找到代码

```
import sys
from PyQt4 import QtGui
from PyQt4 import QtCore

class Button(QtGui.QPushButton):

    def __init__(self, title, parent):
        super(Button, self).__init__(title, parent)

    def mouseMoveEvent(self, e):
        if e.buttons() != QtCore.Qt.RightButton:
            return 

        mimeData = QtCore.QMimeData()
        drag = QtGui.QDrag(self)
        drag.setMimeData(mimeData)
        drag.setHotSpot(e.pos() - self.rect().topLeft())

        dropAction = drag.start(QtCore.Qt.MoveAction)

    def mousePressEvent(self, e):
        if e.button() == QtCore.Qt.LeftButton:
            print 'Left Button Pressed'

class MyTable(QtGui.QTableWidget):

    def __init__(self, rows, columns, butObject, parent):
        super(MyTable, self).__init__(rows, columns, parent)
        self.setAcceptDrops(True)
        self.butObject = butObject

    def dragEnterEvent(self, e):
        e.accept()

    def dropEvent(self, e):
        position = e.pos()

        print position

        self.butObject.move(position)

        e.setDropAction(QtCore.Qt.MoveAction)
        e.accept()

    def dragMoveEvent(self, e):
        e.accept()

class Example(QtGui.QWidget):

    def __init__(self):
        super(Example, self).__init__()
        self.initUI()

    def initUI(self):
        self.setAcceptDrops(True)

        self.button = Button('Button', self)
        self.button.move(50, 200)

        self.table = MyTable(2, 2, self.button, self)
        self.table.setAcceptDrops(True)
        self.table.setDragEnabled(True)

        self.setWindowTitle('Click or Move')
        #self.setGeometry(300, 300, 280, 150)

def main():

    app = QtGui.QApplication(sys.argv)
    ex = Example()
    ex.show()
    app.exec_()

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T11:06:12.020

当您将按钮放入表格时，“打印位置”是否有效？它应该将放置位置的坐标打印到您的外壳上。我认为您需要使用它们然后将按钮插入表中。

让它工作 - 将你的 drop 事件更改为：

```
 position = e.pos()

    print position

    row = self.rowAt(position.y())

    column = self.columnAt(position.x())

    self.setCellWidget(row,column,self.butObject)

    e.setDropAction(QtCore.Qt.MoveAction)
    e.accept() 
```

干杯

戴夫

# c# - 创建一个仅限管理员访问的目录

> ID：10524188
> 
> 赞同：5
> 
> 时间：2012-05-09T21:15:22.390
> 
> 标签：c#, .net, security, file, directory

我有一个以提升的权限运行的管理应用程序，我需要它将一些敏感文件存储在只有系统管理员可以访问的目录中。

它可能与以下调用有关，但我不确定如何配置它。

```
Directory.CreateDirectory(@"C:\SomePath", new AccessControl.DirectorySecurity() { AccessRightType = ?, AccessRuleType = ?, AuditRuleType = ?); 
```

如果有更好的方法来达到同样的效果，请告诉我。谢谢。

**编辑：**[在这里](http://www.pcreview.co.uk/forums/createdirectory-security-straightaway-t3714724.html)找到了一个很好的实现。如果有任何其他建议，将把问题留一天。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T14:08:15.137

[在这里](http://www.pcreview.co.uk/forums/createdirectory-security-straightaway-t3714724.html)找到了一个很好的解决方案。

```
FileSystemAccessRule administratorRule = new FileSystemAccessRule("Administrators", FileSystemRights.FullControl, InheritanceFlags.ContainerInherit | InheritanceFlags.ObjectInherit, PropagationFlags.None, AccessControlType.Allow);

FileSystemAccessRule guestRule = new FileSystemAccessRule("Guest", FileSystemRights.CreateDirectories | FileSystemRights.CreateFiles, AccessControlType.Allow);

DirectorySecurity dirSec = new DirectorySecurity();
dirSec.AddAccessRule(administratorRule);
dirSec.AddAccessRule(guestRule);

Directory.CreateDirectory(@"C:\GuestTemp", dirSec); 
```

# java - 用Java编写像Tomcat这样的服务器

> ID：10524189
> 
> 赞同：0
> 
> 时间：2012-05-09T21:15:23.340
> 
> 标签：java

用 Java 或其他编程语言编写像 Tomcat 这样的服务器有多难？

我一直很享受使用 UDP 和 TCP 套接字将它们塑造成简单的客户端和服务器以在我的计算机周围传递数据，我想知道从头开始编写服务器会有多难？

我知道至少有一个使用 JVM 用 Ja​​va 编写的操作系统，在通常用 C 或 ASM 编写的部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:28:50.767

[Java 在编写客户端/服务器程序时非常有能力](http://docs.oracle.com/javase/tutorial/networking/sockets/clientServer.html)。虽然联网并不容易，但有许多工具包使编写此类程序变得更加困难，并且具有更多的先决知识。

至于“Tomcat”类型的服务器，您还需要学习很多关于类加载的知识，以防止标识为“应用程序”的 java 类的“树”交叉通信。类加载需要更多时间才能正确，主要是因为编写一组体面的测试以真正确保类在正确的位置并且*确实*存在安全性是一项工作。

是不是有点工作？是的。但究竟有多少工作在很大程度上取决于细节。一个简单的服务器套接字和接受连接的代码可以由一个有经验的程序员在一天内（或至少在一周内）编写出来。实现协议（预期和发送的位）将花费更长的时间，具体取决于协议支持多少“功能”。这就是为什么所有“示例”客户端/服务器 Java 程序基本上都是“回显”服务器、时间服务器或其他一些*非常琐碎*的协议。

如果您想要一个复杂的线程模型来确保服务器在额外的内核上扩展，或者即使在处理需要相对较长时间的其他请求时也能快速处理请求，那么请继续增加更多时间（因为您放弃简单的线程模型以获得更复杂的线程模型） .

到现在为止，您已经决定需要配置一些东西，而您决定*如何*配置它们将决定您需要在配置子系统上投入多少时间。

实际成本；但是，不是在应用程序的编写中，而是在测试和错误修复中。对于在正常情况下编写的每一行代码，许多未经考虑的情况最终会减慢速度。为了预先支付一些已知但通常是计划外的额外时间，请使用测试驱动开发来避免在您想说“我完成了”时让自己支付巨额测试债务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T01:20:02.070

我认为这对学生来说是一个很棒的项目，因为它可以教你很多关于编程的知识。特别是，它将帮助您了解在您尝试进行项目时遇到的所有小（而不是小）问题。当我在大学时，我想从头开始编写自己的简单 SMTP 服务器。我必须学习协议、网络编程、线程和大量其他我在开始时没有考虑过的细节。我认为它非常有用（而且很耗时），而且当我完成时，我觉得我实际上已经完成了一些事情。我还了解了为什么人们使用现有的库并倾向于专注于构建他人的工作而不是从头开始，但直到最后我才知道这一点。

我的建议是给自己一个具体且看似很小的目标，**并确保完成它**。最重要的教训是成为那种完成他们开始的事情的人。很多人都有很棒的想法，但执行（和完成）即使是很小的想法也始终是最重要的。

我不会选择像 Tomcat 这样的 Servlet 容器，因为 Servlet 规范是一头野兽。我会找到您感兴趣的东西，限制范围并开始工作。我的朋友想要一个邮件列表，所以我从那里开始。也许您对 HTTP 感兴趣，或者您想要一种让您的手机在计算机上播放 MP3 的方法。如果您自己解决问题（即使已经存在“真正的”解决方案），这有助于保持动力。

祝你好运！

你能行的！

# database - 使用 MS Access 文件的 Visual Studio 2010

> ID：10524190
> 
> 赞同：-1
> 
> 时间：2012-05-09T21:15:28.360
> 
> 标签：database, vb.net, winforms, visual-studio, ms-access-2007

当我从数据集拖放到表单时，我正在尝试连接到 Access DB 文件，但出现以下错误

![在此处输入图像描述](../Images/f98fcef1d8eca0a3980e5b3cd4f45588.png) 我做错了吗，我该怎么办？

```
Dataset not defined
TableAdapter not defined
TableAdapterManager not defined 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-10T00:57:05.680

我不确定您要完成什么。但是使用数据库比拖放要复杂一些。但幸运的是，在某些情况下你并没有太多。

[这个网站](http://www.dreamincode.net/forums/topic/74114-a-really-simple-database/)有一个关于使用访问数据库和数据集的非常基础的教程。

[这是一次很棒的步行。](http://www.mltek.co.uk/tips_accessdb_vb.aspx)

[YouTube](http://www.youtube.com/watch?v=C-Ga8pXiv6U)也有很多视频，只要搜索 vb.net ms access 和 Dataset。应该找到一些视频来逐步向您展示。

如果这对您没有帮助，您将不得不更详细地了解您正在尝试做的事情。

# javascript - 有什么方法可以在 chrome 扩展中只初始化一次？

> ID：10524193
> 
> 赞同：4
> 
> 时间：2012-05-09T21:15:44.440
> 
> 标签：javascript, jquery, html, google-chrome-extension, local-storage

我正在尝试使用 html5 本地存储编写一个简单的 chrome 扩展。我正在使用一个索引变量，每次将新值添加到本地存储时它都会自动递增。

但是当我加载 chrome 浏览器操作时，它会将该变量初始化为 0。

我们可以在浏览器操作中只声明一次任何变量吗？

PS 我是 chrome 开发的新手

先感谢您

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T21:39:14.780

浏览器操作页面，就像`popup.html`每次单击扩展图标时加载一样。使用背景页面代替，它存在于背景中，并且在您加载应用程序时仅初始化一次。

Backgorund 页面需要在 manifest -> [Background Pages中注册](http://code.google.com/chrome/extensions/background_pages.html)

允许后台页面处理localStorage。

例如：在后台页面初始化一个变量counter，并做一个函数来增加它，比如

```
var counter = 0;
function incCounter(){
    window.counter++;
} 
```

然后，您可以像这样调用此函数`popup.html`：

```
var bgp = chrome.extension.getBackgroundPage();
bgp.incCounter(); 
```

问候

# python - 在 PyGObject 中使用 GtkSourceView 从 Glade 加载 GUI

> ID：10524196
> 
> 赞同：9
> 
> 时间：2012-05-09T21:15:49.233
> 
> 标签：python, glade, pygobject, gtksourceview

我正在尝试使用在 PyGObject 中具有 GtkSourceView 小部件的 Glade 文件。我写了一个关于如何开始在 Glade 中使用新的 GtkSourceView 3.0 的小指南：http: [//cjenkins.wordpress.com/2012/05/08/use-gtksourceview-widget-in-glade/](http://cjenkins.wordpress.com/2012/05/08/use-gtksourceview-widget-in-glade/)

问题是当我想从 PyGObject 加载 Glade 时：

```
from gi.repository import Gtk, GtkSource
from os.path import abspath, dirname, join

WHERE_AM_I = abspath(dirname(__file__))

class MyApp(object):

    def __init__(self):
        self.builder = Gtk.Builder()
        self.glade_file = join(WHERE_AM_I, 'test.glade')
        self.builder.add_from_file(self.glade_file)

if __name__ == '__main__':
    try:
        gui = MyApp()
        Gtk.main()
    except KeyboardInterrupt:
        pass 
```

当我运行该文件时，出现此错误：

```
Traceback (most recent call last):
  File "test.py", line 15, in <module>
    gui = MyApp()
  File "test.py", line 11, in __init__
    self.builder.add_from_file(self.glade_file)
  File "/usr/lib/python2.7/dist-packages/gi/types.py", line 43, in function
    return info.invoke(*args, **kwargs)
gi._glib.GError: Invalid object type `GtkSourceView' 
```

Glade 文件 (test.glade) 只是一个带有 GtkSourceView 小部件的窗口：

```
<?xml version="1.0" encoding="UTF-8"?>
<interface>
  <!-- interface-requires gtksourceview 3.0 -->
  <!-- interface-requires gtk+ 3.0 -->
  <object class="GtkWindow" id="window1">
    <property name="can_focus">False</property>
    <child>
      <object class="GtkSourceView" id="gtksourceview1">
        <property name="visible">True</property>
        <property name="can_focus">True</property>
        <property name="has_tooltip">True</property>
        <property name="left_margin">2</property>
        <property name="right_margin">2</property>
        <property name="tab_width">4</property>
        <property name="auto_indent">True</property>
        <property name="indent_on_tab">False</property>
      </object>
    </child>
  </object>
</interface> 
```

我现在不知道如何解决这个问题。我想我需要在调用 add_from_file() 之前注册某种类型，不是吗？欢迎任何想法。

我正在使用：

*   Ubuntu 精确 12.04
*   林间空地 3.12.0
*   libgtksourceview 3.0
*   gtk+ 3.0

亲切的问候

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-10T05:33:57.647

我想通了：DI 只需要在调用**add_from_file()**之前在 GObject 中注册新类型，正如我所怀疑的那样。只需要在 gi.repository 的导入中添加 GObject 并像这样调用**type_register()**：

```
from gi.repository import Gtk, GtkSource, GObject
from os.path import abspath, dirname, join

WHERE_AM_I = abspath(dirname(__file__))

class MyApp(object):

    def __init__(self):
        self.builder = Gtk.Builder()
        self.glade_file = join(WHERE_AM_I, 'test.glade')
        GObject.type_register(GtkSource.View)
        self.builder.add_from_file(self.glade_file)

if __name__ == '__main__':
    try:
        gui = MyApp()
        Gtk.main()
    except KeyboardInterrupt:
        pass 
```

我将使用此信息更新页面。

亲切的问候

# php - 使用 sha256WithRSAEncryption 签名需要什么版本的 OpenSSL

> ID：10524198
> 
> 赞同：2
> 
> 时间：2012-05-09T21:16:08.800
> 
> 标签：php, cryptography, openssl

使用 PHP 5.2.4 和 OpenSSL 0.9.8g 模块我正在尝试创建签名摘要

```
openssl_sign($stuff, $signeddigest, $key, 'sha256WithRSAEncryption'); 
```

唉 $signeddigest 返回为空，我没有收到任何错误。

如果不指定 'sha256WithRSAEncryption' 算法，则使用默认算法返回签名摘要。

相同的代码在 PHP 5.3.10 和 OpenSSL 1.0.0g 上运行良好。OpenSSL 0.9.8g 不支持“sha256WithRSAEncryption”算法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-20T10:12:33.720

一位好朋友想出了在旧的 PHP 5.2.4 和 OpenSSL 0.9.8g 模块上使用 sha256WithRSAEncryption 的解决方法。

使用[http://www.di-mgt.com.au/rsa_alg.html](http://www.di-mgt.com.au/rsa_alg.html)上提供的信息，他给我写了以下片段：

```
function my_openssl_sign($data, &$signature, $priv_key_id, $signature_alg = 'sha256WithRSAEncryption') {
    $pinfo = openssl_pkey_get_details($priv_key_id);
    $hash = hash('sha256', $data);
    $t = '3031300d060960864801650304020105000420'; # sha256
    $t .= $hash;
    $pslen = $pinfo['bits']/8 - (strlen($t)/2 + 3);

    $eb = '0001' . str_repeat('FF', $pslen) . '00' . $t;
    $eb = pack('H*', $eb);

    return openssl_private_encrypt($eb, $signature, $priv_key_id, OPENSSL_NO_PADDING); 
} 
```

谢谢你，Mads，你真是太棒了！

# javascript - 循环遍历 Json 数据存储 extjs

> ID：10524199
> 
> 赞同：1
> 
> 时间：2012-05-09T21:16:13.760
> 
> 标签：javascript, extjs

我需要遍历 Json 数据存储并收集所有值。最后，它应该在警报窗口中显示所有价格的总金额。我不知道如何循环遍历 Json 数据，如果有更快或更简单的方法可以做到这一点，我很感兴趣。我的想法是：

```
var myStore = new Ext.data.Store({
    id: 'ID_Store',
    proxy: new Ext.data.HttpProxy({
        url: 'get.php',
        method: 'POST'
    }),
    baseParams: {
        task: "LIST"
    },
    reader: new Ext.data.JsonReader({
        root: 'results',
        totalProperty: 'total',
        id: 'id'
    }, [{
        name: 'IDbook',
        type: 'int',
        mapping: 'id_book'
    }, {
        name: 'price',
        type: 'int',
        mapping: 'price'
    }])
});

var sum = 0;

myStore.load();
myStore.on('load', function () {
    for (var i = 0; i < myStore.getTotalCount(); i++) {
        sum = sum + myStore.price[i];
    }
});

alert("total sum is:", sum); 
```

JSON是：

```
{success:true}{total:5,results:[{"id_book":"1","price":"10},{"id_book":"2","price":"15"},{"id_book":"3","price":"5"},{"id_book":"4","price":"7"},{"id_book":"5","price":"30"}]} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T21:24:39.523

再简单不过了：

```
var total = 0;
myStore.each(function(r) {
   total += r.get('price');
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T22:43:46.523

认为json第一个标签价格有一个错误`"price":"10`而不是

# xpath - 无法使用 webdriver 定位图像的 xpath

> ID：10524201
> 
> 赞同：1
> 
> 时间：2012-05-09T21:16:13.707
> 
> 标签：xpath, selenium, automation, webdriver

我正在尝试使用 selenium Webdriver 访问 png 图像中的选项卡：

```
div id="navbar6ClickDiv" 
a onclick="return hdlClick('navbar6ClickDiv', 'navbar')" target="workspace" href="/setup.htm"
img width="90" height="23" border="0" src="/xyz.png" 
```

我尝试了以下方法来访问该选项卡，但没有任何效果：

*   第一个：

    ```
    WebElement div = driver.findElement(By.id("navbar6ClickDiv"));   
                 div.click(); 
    ```

*   第二：

    ```
    WebElement div = driver.findElement(By.tagName("img").name("/images/banner/setupt.png"));
                                 div.click(); 
    ```

*   第三：

    ```
    WebElement div = driver.findElement(By.xpath("//img[contains(@src,'/images/banner/setupt.png')]"));
                 div.click(); 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T11:40:46.300

当使用 WebDriver 测试 DHTML/AJAX 页面时，很常见的是发现 WebDriver 速度太快，互联网延迟和浏览器 javascript 无法呈现页面。

该元素可能还不**存在**。在Java 中，WebDriver [WaitUntil](http://seleniumhq.org/docs/04_webdriver_advanced.html)习惯用法通过等待容器（例如div）被显示来避免这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-03T09:48:51.020

步骤1：

导出图像的完整 CSS 选择器。

```
css=a[onclick*='navbar6ClickDiv'] > img[src*='xyz.png'] 
```

第2步：

点击图片

```
driver.findElement(
  By.cssSelector("a[onclick*='navbar6ClickDiv'] > img[src*='xyz.png']")
).click(); 
```

# ruby - 在 Rails 中自动创建全局对象

> ID：10524211
> 
> 赞同：0
> 
> 时间：2012-05-09T21:16:36.070
> 
> 标签：ruby, ruby-on-rails-3, oop

我有一个带有类的库，该类在创建时会定期自动从一系列 FTP 服务器中抓取数据。它是线程化的，您可以简单地调用“结果”方法来查看迄今为止的结果。我对 Rails 还很陌生，但我想为这个对象创建一个 Web 界面，允许人们查看结果、启动它、停止它，并且基本上只是与一般的对象交互。我希望它首先被创建并保持不变，无论是否有人使用 Web 界面，以便它可以在后台运行并收集数据。我还希望它可以从控制器访问，以便我可以拥有启动/停止/信息页面。关于实现这一目标的最佳方法的任何想法？

PS 我正在运行 Rails 3.2.3 和 Ruby 1.9.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:20:04.507

有更好的方法来运行后台进程并从 Rails 应用程序访问它，但要直接回答您的问题：

只需将其放入初始化程序中即可。有一个 /config/initializers 目录。将一个 .rb 文件放在那里，它会在你的 rails 应用程序启动时自动运行。

/config/initializers/hello.rb：

```
Rails.logger.debug "Hello World" 
```

启动你的 Rails 服务器，你会看到“Hello World”

要使您的类的实例全局可用，只需创建一个全局变量：

```
MYCLASS = MyClass.new 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T21:20:45.993

您不应该在 Rails 应用程序中创建线程。这很混乱，很危险，而且由于 Rails 不是一个单一的进程，而是由你的启动器框架创建的许多进程，例如Passenger，所以你需要在每个进程中都有一个这个对象的实例，这可能会重复工作。

更好的方法是有一个在后台运行的单一进程，但它公开了某种 API，可以由您的各种 Rails 实例使用。一种方法是使用像 Memcached、Redis、传统数据库甚至平面文件这样的系统作为共享存储系统。另一种方法是通过公开一个可供 Rails 使用的接口来直接响应 API 调用。制作一个“说 memcached”的进程并不太难。

通常，最简单的方法是使用共享存储来完成工作。它易于使用，并且更容易检查该过程是否产生了正确的结果。例如，使用 ActiveRecord 将抓取的结果保存到数据库中，并使用这些相同的模型在应用程序中取回数据。

您在 Rails 应用程序中构建的是某种用于访问此共享数据的包装器。这可能是一系列 ActiveRecord 模型、一些 Memcached 调用或其他东西，但最终结果将是一个干净的接口，可以在 N 个进程中独立运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T21:31:38.357

唔。这是在 Linux 机器上运行的吗？

如果是这样，您可以轻松地编写一个守护程序并选择在系统启动时启动它。我会将数据及其当前状态（运行/关闭）放入某种内存存储（Memcache？Redis）或数据库中。您的控制器从那里访问数据。

你也可以让你的控制器直接做类似的事情`/etc/init.d/my_service stop/start/restart`。

如果您要运行许多这些小守护进程，可能在不同的机器上（或由不同的机器管理），我建议您编写一个应用程序来管理它们的状态并通过 RabbitMQ 之类的东西与之通信，但这可能有点过头了你想做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T21:39:01.590

Redis 和 Resque 是您想要的 - 以及您的 rails 应用程序。

Redis：[http ://redis.io/](http://redis.io/)

Resque：[https ://github.com/defunkt/resque](https://github.com/defunkt/resque)

Redis 是一个缓存服务器，而 resque 是一个建立在它之上的作业调度工具。Resque 有许多与之配合使用的扩展，可让您自定义和扩展其行为。例如：

*   [https://github.com/quirkey/resque-status](https://github.com/quirkey/resque-status) - Resque 状态（允许您在运行时监控正在运行的作业的进度和信息）

*   [https://github.com/bvandenbos/resque-scheduler](https://github.com/bvandenbos/resque-scheduler) Resque Scheduler（允许您以交互方式午餐作业，或定期启动作业，类似 cron 的时间表）

*   [https://github.com/jayniz/resque-loner](https://github.com/jayniz/resque-loner) - Resque Loner（允许您确保一次只有一个作业实例排队运行）

Resque 还带有一个 Web 用户界面，可让您跟踪所有作业和队列的状态。

因此，我基本上通过创建一个页面来构建您的应用程序，该页面允许您启动作业 - 或监控正在运行的作业的完成或进度。

您的所有作业都将在“worker”服务器上运行，并且与 rails 应用程序发生的情况无关。所有进度数据都将存储在 redis 中，因此如果您的 rails 应用程序重新启动，您只需在重新启动时连接到 redis 并且您拥有当前数据。

所有这些基础设施在 Heroku 上运行得非常好，也可以使用他们的“Redis-to-Go”插件。我目前将它用于许多任务，并且效果很好。

# php - 不使用子 ID 进行导航

> ID：10524215
> 
> 赞同：1
> 
> 时间：2012-05-09T21:16:51.263
> 
> 标签：php

我只是为我的网站设置通用模板，而我正在做的一点 php 只是从页面到页面获取用户 ID，换句话说，我希望用户在登录时从页面到页面，例如，不使用 user_id=3 标题中的子 ID，然后使用 get 函数获取它并显示他们的信息，我希望能够做到这一点。

这是我的代码，但我不断收到错误

```
Notice: Undefined index: user_id in C:\xampp\htdocs\Arken\profile.php on line 7 
```

登录代码（当然不是全部，只是设置会话凝灰岩的一点）

```
// Create session var for their raw id
                $user_id = $row["user_id"];   
                $_SESSION['user_id'] = $user_id;
                // Create the idx session var
                $_SESSION['idx'] = base64_encode("g4p3h9xfn8sq03hs2234$id");
                // Create session var for their username
                $login_username = $row["login_username"];
                $_SESSION['login_username'] = $login_username;
                // Create session var for their password
                $login_userpass = $row["login_password"];
                $_SESSION['login_userpass'] = $login_userpass; 
```

每个页面的PHP

```
 session_start();

$user_id = "";

if ($_GET['user_id']) {

     $user_id = $_GET['user_id'];

} else if (isset($_SESSION['user_id'])) {

     $user_id = $_SESSION['user_id'];

} else {

   include_once "index.php";
   exit();
}
include 'connect_to_mysql.php'; 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:19:45.727

此错误是由警告级别`E_NOTICE`和此行引起的：

```
if ($_GET['user_id']) 
```

如果`user_id`未设置 for 的值，则会产生错误。如果您只想检查该值是否存在，则应使用：

```
if (isset($_GET['user_id'])) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T21:19:56.140

我假设第 7 行是

```
if ($_GET['user_id']) { 
```

在使用它之前尝试确保它已设置：

```
if (isset($_GET['user_id'])) { 
```

# php - PHP：MY SQL 历史功能？

> ID：10524223
> 
> 赞同：-1
> 
> 时间：2012-05-09T21:17:49.773
> 
> 标签：php, mysql

我将用户输入（评论）保存在这些表中。

```
NEWS_COMMENTS
- id
- comment

PRODUCT_COMMENTS
- id
- comment
- product_id 
```

我想在我的网站上添加历史功能。像;

```
-Someone commented on XX news.
-Someone commented on YY product.
-Someone commented on ZZ product. 
```

你注意到了这个问题。我不保存时间戳或日期，所以我不能确定哪个评论先出现。它可以是新闻评论或产品评论。

MySQL 是否具有选择最近 24 小时输入的功能？例如，

NEWS_COMMENTS 在过去 24 小时内有 3 个新条目。PRODUCT_COMMENTS 在过去 24 小时内有 5 个新条目。

查询应选择这 8 个条目，按条目日期/时间戳排序。

我可以在不更改当前页面的情况下执行此操作吗？你能提供一个查询吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:21:56.663

您需要做的就是添加一个带有 type`timestamp`和 option的列`DEFAULT CURRENT_TIMESTAMP`。您可能不需要对代码进行任何其他修改 - MySQL 会神奇地确保在您插入行时自动填写时间戳。

*   [TIMESTAMP 和 DATETIME 的自动初始化和更新](http://dev.mysql.com/doc/refman/5.6/en/timestamp-initialization.html)

然后您可以通过一个简单的查询获取过去 24 小时的行：

```
SELECT col1, col2, ..., coln
FROM yourtable
WHERE yourtimestampcol > NOW() - interval 24 hour 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T21:24:06.297

```
SELECT * FROM  table WHERE timeStamp > NOW() - INTERVAL 24 HOUR 
```

通过添加具有类型`timestamp`及其打开的列，`DEFAULT CURRENT_TIMESTAMP`这应该是您要查找的内容，显然会更改表名和时间戳列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T21:25:50.250

*“MySQL 是否具有选择最近 24 小时输入的功能？”*

使用您当前的数据库结构，没有。有可能吗？是的。您**需要**使用[时间戳](http://dev.mysql.com/doc/refman/5.0/en/timestamp-initialization.html)。您还没有新评论的事实表明您还没有考虑到您想要实现的目标的整个过程。

本质上，您需要将`cooment_timestamp`字段（或其他名称）作为时间戳类型添加到数据库并添加`ON UPDATE`子句 : `ON UPDATE CURRENT_TIMESTAMP`。

然后，您可以`SELECT`使用时间戳信息查询（）您需要的数据。

```
SELECT * FROM  `COMMENT_TABLE` WHERE comment_timetamp > NOW() - INTERVAL 24 HOUR 
```

# jquery - jQuery 在固定位置元素上淡化元素 - 仅限 iPad？

> ID：10524227
> 
> 赞同：1
> 
> 时间：2012-05-09T21:17:54.607
> 
> 标签：jquery, ipad, mobile-safari, positioning, fadein

在位于固定定位背景元素之上的两个元素之间淡入淡出时，我看到了笨重的淡入淡出。将背景更改为绝对定位可以解决此问题。

奇怪的是，这种笨拙仅适用于 iOS，而不适用于我的桌面。就好像淡入淡出发生了，然后 Mobile Safari 想要再次重绘该框。

有没有其他人看过这个？

我的代码太详尽而无法发布，所以我将这个问题广泛地提出来。

谢谢！

** 更新 **

这是一个类似于我正在做的小提琴，但它不会重现我在 iPad 上看到的问题：http: [//jsfiddle.net/pyhxL/5/](http://jsfiddle.net/pyhxL/5/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-14T22:12:15.953

我没有看到它，所以我不能给你任何关于这个问题的原因的建议。但是：如果小提琴确实有效而您的代码无效，那么我会从小提琴版本向后工作到您的版本，看看它从哪里开始中断。

# amazon-s3 - 具有 Cloudformation 的非标准 ACL S3 存储桶

> ID：10524231
> 
> 赞同：3
> 
> 时间：2012-05-09T21:18:29.553
> 
> 标签：amazon-s3, amazon-ec2, amazon-web-services, amazon-cloudformation

使用 Cloudformation，您可以在创建 S3 存储桶时将 Authenticated Users 组设置为具有放置/删除访问控制吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-27T20:14:11.403

这对于[Amazon S3的初始和分别受限的](http://aws.amazon.com/s3/)[访问控制列表 (ACL)](http://docs.amazonwebservices.com/AmazonS3/latest/dev/ACLOverview.html)是不可能的，其中只有预定义的[罐装 ACL](http://docs.amazonwebservices.com/AmazonS3/latest/dev/ACLOverview.html#CannedACL)可用于依次由[AWS CloudFormation](http://aws.amazon.com/cloudformation/)支持的[AWS 资源类型](http://docs.amazonwebservices.com/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html)，请参阅 AWS的属性*AccessControl* [:: S3::桶](http://docs.amazonwebservices.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html)资源：

 *> 对存储桶授予预定义权限的标准 ACL。默认为私人。有关标准 ACL 的更多信息，请参阅[Amazon S3 文档中的标准 ACL](http://docs.amazonwebservices.com/AmazonS3/latest/dev/CannedACL.html)。
> 
> AccessControl 的有效值：AuthenticatedRead | AwsExec读取 | BucketOwner阅读 | BucketOwnerFullControl | 日志传递写 | 私人 | 公开阅读 | 公共读写

假设您实际上不想向**所有**S3 用户授予 put/delete 访问权限（*Authenticated Users*组实际上暗示了不知情的 S3 开发人员的惊讶），但仅授予您自己的用户（或一组众所周知的) 帐户与大多数用例一样，您可以通过使用[S3 存储桶策略](http://docs.amazonwebservices.com/AmazonS3/latest/dev/UsingBucketPolicies.html)来实现您的目标。

[Amazon S3 存储桶策略](http://docs.amazonwebservices.com/AmazonS3/latest/dev/AccessPolicyLanguage_UseCases_s3_a.html)的示例案例提供了一个示例策略，用于*向具有附加限制的多个账户授予权限，*该策略向多个账户*授予 PutObject 和 PutObjectAcl 权限，并要求包含公共读取的标准 acl* - 将其剥离到请求的集合并将其转换为 CloudFormation 模板片段将大致产生以下结果（当然，您需要将*Principal*调整为您的帐户）：

```
"Resources" : {
  "S3Bucket" : {
    "Type" : "AWS::S3::Bucket"
  },
  "BucketPolicy" : {
    "Type" : "AWS::S3::BucketPolicy",
    "Properties" : {
      "PolicyDocument": {
        "Id"           : "Grant access to all account users",
        "Statement"    : [{
          "Sid"        : "PutObjectAccess",
          "Action"     : ["s3:PutObject"],
          "Effect"     : "Allow",
          "Resource"   : { "Fn::Join" : ["", ["arn:aws:s3:::", {"Ref" : "S3Bucket"} ]]},
          "Principal"  : { "AWS": ["arn:aws:iam::111122223333:root","arn:aws:iam::444455556666:root"] }
        }]
      },
      "Bucket" : {"Ref" : "S3Bucket"}
    }
  },
}, 
```

[请注意同时使用 ACL 和存储桶策略](http://docs.amazonwebservices.com/AmazonS3/latest/dev/UsingACLsandBucketPoliciesTogether.html)的特殊性，以防万一。*

# javascript - HTML5 适合屏幕分辨率

> ID：10524241
> 
> 赞同：1
> 
> 时间：2012-05-09T21:19:03.533
> 
> 标签：javascript, css, html

我一直在寻找解决此问题的方法，但运气不佳。我不太擅长 HTML 或 CSS。我了解基础知识，但我需要我在 HTML 5 中所做的事情。所以我非常感谢任何帮助。

我使用这个网站来了解我想要的[Here](http://jbkflex.wordpress.com/2012/01/09/replicating-the-swipe-gesture-iphone-gallery-for-mobile-web-html5-part-1/)。

它应该是一个可以在 Android、iPhone 和 iPad 上显示的 HTML5 应用程序。它确实没有太多功能。主要只是像链接显示的那样滑动翻页的能力。我的问题是我无法获取图像，并且它作为一个整体适合它所在的任何屏幕。在 iPhone 尺寸上工作似乎是硬编码的，但在 iPad 上显示时，它只占屏幕的一小部分。我将在下面发布他的代码，这样您就不必去那里看到它。

HTML：

```
<!DOCTYPE html>
<html>
<head>
<title>Swipe Gesture - Gallery</title>
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="viewport" content="initial-scale=1.0; minimum-scale=1.0; maximum-scale=1.0;" />
<link href="css/styles.css" rel="Stylesheet" />
</head>
<body>
  <div id="wrapper">
    <ul id="slideContainer">
      <li>
        <img src="img/1.jpg" width="100%" height="100%"/>
      </li>
      <li>
        <img src="img/2.jpg" width="100%" height="100%" />
      </li>
      <li>
        <img src="img/3.jpg" width="100%" height="100%" />
      </li>
      <li>
        <img src="img/4.jpg" width="100%" height="100%" />
      </li>
      <li>
        <img src="img/5.jpg" width="100%" height="100%"/>
      </li>
      <li>
        <img src="img/6.jpg" width="100%" height="100%"/>
      </li>
      <li>
        <img src="img/7.jpg" width="100%" height="100%"/>
      </li>
    </ul>
  </div>
</body>
<script type="text/javascript" src="js/scripts.js">
</script>
</html> 
```

CSS：

```
body
{
  margin:0;
  padding:10px;
}

#wrapper
{
  overflow:hidden;
}

#wrapper ul
{
  list-style:none;
  margin:0;
  padding:0;
  -webkit-transition: -webkit-transform 0.3s linear;
}

#wrapper ul li
{
  float:left;
}
#imgFit {
   width: 100%;
   min-width: 320px;
   max-width: 768px
} 
```

JS：

```
 (function() {
var swipey = {
slideContainer: null, //<ul> element object that holds the image slides
wrapper: null, //meant for masking/clipping
slides: null, //array of all slides i.e <li> elements
distanceX: 0, //distance moved in X direction i.e left or right
startX: 0, //registers the initial touch co-ordinate
preferredWidth: 0, //dynamic variable to set width
preferredHeight: 0, //dynamic variable to set height
direction: "", //direction of movement
timer: null, //timer that set starts when touch starts
timerCounter: 0, //counter variable for timer
isTouchStart: false, //boolen to chk whether touch has started
maxDistance: 0, //maximum distance in X direction that slide container can move
currentDistance: 0, //current distance moved by slide container through translate

initSwipey: function() {
//scroll the window up to hide the address bar of the browser.
window.setTimeout(function() { window.scrollTo(0, 1); }, 100);
//get all the instances of the HTML elements
swipey.wrapper = document.getElementById("wrapper");
swipey.slideContainer = document.getElementById("slideContainer");
swipey.slides = slideContainer.getElementsByTagName("li");

//for iPhone, the width and height
swipey.preferredWidth = 320;
swipey.preferredHeight = 416; //510 for android
//setting the width and height to our wrapper with overflow = hidden
swipey.wrapper.style.width = swipey.preferredWidth + "px";
swipey.wrapper.style.height = swipey.preferredHeight + "px";
//setting the width to our <ul> element which holds all the <li> elements
swipey.slideContainer.style.width = swipey.slides.length * swipey.preferredWidth + "px";
swipey.slideContainer.style.height = swipey.preferredHeight + "px";
//calculating the max distance of travel for Slide Container i.e <ul> element
swipey.maxDistance = swipey.slides.length * swipey.preferredWidth;
//initialize and assign the touch events
swipey.initEvents();
},
initEvents: function() {
//registering touch events to the wrapper
swipey.wrapper.addEventListener("touchstart", swipey.startHandler, false);
swipey.wrapper.addEventListener("touchmove", swipey.moveHandler, false);
swipey.wrapper.addEventListener("touchend", swipey.endHandler, false);
},
//funciton called when touch start event is fired i.e finger is pressed on the screen
startHandler: function(event) {
//stores the starting X co-ordinate when finger touches the device screen
swipey.startX = event.touches[0].pageX; //.changedTouches[0]
//timer is set on
swipey.timer = setInterval(function() { swipey.timerCounter++; }, 10);
swipey.isTouchStart = true;
event.preventDefault(); //prevents the window from scrolling.
},
//funciton called when touch move event is fired i.e finger is dragged over the screen
moveHandler: function(event) {
if (swipey.isTouchStart) {
swipey.distanceX = event.touches[0].pageX - swipey.startX;
//move the slide container along with the movement of the finger
swipey.slideContainer.style.webkitTransform = "translate3d(" + (swipey.distanceX + swipey.currentDistance) + "px, 0,0)";
}
},
//funciton called when touch end event is fired i.e finger is released from screen
endHandler: function(event) {
clearInterval(swipey.timer); //timer is stopped
if (swipey.distanceX > 0) {
swipey.direction = "right";
}
if (swipey.distanceX < 0) {
swipey.direction = "left";
}
//the following conditions have been discussed in details
if ((swipey.direction == "right" && swipey.currentDistance == 0) || (swipey.direction == "left" && swipey.currentDistance == -(swipey.maxDistance - swipey.preferredWidth))) {
swipey.comeBack();
}
else if (swipey.timerCounter < 30 && swipey.distanceX > 10) {
swipey.moveRight();
}
else if (swipey.timerCounter < 30 && swipey.distanceX < -10) {
swipey.moveLeft();
}
else if (swipey.distanceX <= -(swipey.preferredWidth / 2)) { //-160
swipey.moveLeft();
}
else if (swipey.distanceX >= (swipey.preferredWidth / 2)) { //160
swipey.moveRight();
}
else {
swipey.comeBack();
}

swipey.timerCounter = 0; //reset timerCounter
swipey.isTouchStart = false; //reset the boolean var
swipey.distanceX = 0; //reset the distance moved for next iteration
},
moveLeft: function() {
swipey.currentDistance += -swipey.preferredWidth;
swipey.slideContainer.style.webkitTransitionDuration = 300 + "ms";
//using CSS3 transformations - translate3d function for movement
swipey.slideContainer.style.webkitTransform = "translate3d(" + swipey.currentDistance + "px, 0,0)";
},
moveRight: function() {
swipey.currentDistance += swipey.preferredWidth;
swipey.slideContainer.style.webkitTransitionDuration = 300 + "ms";
swipey.slideContainer.style.webkitTransform = "translate3d(" + swipey.currentDistance + "px, 0,0)";
},
comeBack: function() {
swipey.slideContainer.style.webkitTransitionDuration = 250 + "ms";
swipey.slideContainer.style.webkitTransitionTimingFunction = "ease-out";
swipey.slideContainer.style.webkitTransform = "translate3d(" + swipey.currentDistance + "px, 0,0)";
}
}; //end of swipey object
window.swipeyObj = swipey; //expose to global window object
})();

swipeyObj.initSwipey(); //invoke the init method to get started 
```

我添加了 imageFit 之一，因为图像没有缩放到屏幕尺寸，这是我的尝试。无论如何，它似乎都适用于最大宽度。如果有任何更好的方法可以做到这一点，或者如果您知道修复方法，我将非常感谢您的帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T05:45:38.337

尝试更改这段代码：

```
//for iPhone, the width and height
swipey.preferredWidth = 320;
swipey.preferredHeight = 416; //510 for android 
```

至：

```
//Auto-detect resolution via javascript:
swipey.preferredWidth = screen.width;
swipey.preferredHeight = screen.height; 
```

这将使用 javascript 自动检测屏幕分辨率。

然后脚本将 li 宽度乘以 li 元素的数量来调整 slideContainer ul 以适应内容：

```
//setting the width to our <ul> element which holds all the <li> elements
swipey.slideContainer.style.width = swipey.slides.length * swipey.preferredWidth + "px";
swipey.slideContainer.style.height = swipey.preferredHeight + "px";
//calculating the max distance of travel for Slide Container i.e <ul> element
swipey.maxDistance = swipey.slides.length * swipey.preferredWidth; 
```

如果上述方法不起作用，还请尝试删除 #imgFit 样式并查看它是否修复了滚动。问题。它可能会干扰某些东西。

此外，通过使用内联样式将图像宽度和高度设置为 100%，它们在以不同分辨率加载时会显得不成比例。如果您希望图像保持特定比例，您可以尝试将宽度设置为 100%，然后浏览器应该正确缩放它。

# javascript - 对象预期 IE8 JS/JQuery 问题 IE8

> ID：10524243
> 
> 赞同：3
> 
> 时间：2012-05-09T21:19:05.777
> 
> 标签：javascript, jquery, internet-explorer

这是我在这里的第一篇文章，尽管我浏览了很多答案。我遇到了一个问题，IE8 将继续抛出“Object Expected”错误。我使用了 IE8 的开发者工具，它指向“mymh.js”文件

```
 <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="/MyMHome/javascript/mymh.js"></script> 
```

mymh.js 文件只有以下代码

```
 $(document).ready(function() {          

        $('#hNumber').focus();

        $('#ddlDir').change(function () {

            var selVal = $('#ddlDir').val();

             if (selVal == 'N' || selVal == 'S' || selVal == 'E' || selVal == 'W'){

             $.getJSON('/MyMHome/DimeServlet?strDir='+$('#ddlDir option:selected').val(), function(data) {

                    $('#ddlSt')
                    .find('option')
                    .remove()
                    .end()

                $.each(data, function(i,field){
                    var name = field;
                    $('#ddlSt')

                    .append('<option value= ' + '"' + name + '"' + '>' + name + '</option>');   
                    });
                });

                $('#ddlSt').focus();    
             }else{ 

                    $('#ddlSt')
                    .find('option')
                    .remove()
                    .end()
                    .append('<OPTION selected value="">Choose a direction first</OPTION>');

                }                   
        })
        .trigger('change');             

        $('#reset').click(function(){
             $('#ddlSt')
            .find('option')
            .remove()
            .end()
            .append('<OPTION selected value="">Choose a direction first</OPTION>'); 
             $('#hNumber').focus();                
        });

        $('#hNumber').bind('keyup', function() {
            if($('#hNumber').val().length == 5){
                    $('#ddlDir').focus();
            }
        });             

        $('#submitQuery').click(function(){
            var houseNumber = $('#hNumber').val();
            if(houseNumber.replace(/\s+/g, '').length == 0){
                alert('Please enter a house number.');
                $('#hNumber').focus();  
                return false;
            }else if( (!$.isNumeric(houseNumber)) || houseNumber.indexOf('-') > -1 || houseNumber.indexOf('.') > -1){
                alert('Please enter numbers only. You will be prompted later, if the address requires a suffix.');
                $('#hNumber').focus();  
                return false;
            }else if(houseNumber < 100 || houseNumber > 12999){
                alert('Please enter a house number between 100 and 12999');
                $('#hNumber').focus();
                return false;
            }else if($('#ddlDir option:selected').val() == 'none'){
                alert('Please select a street direction.');
                $('#ddlDir').focus();
                return false;
            }       
        });         

        $('form').keypress(function(e) {
              if (e.keyCode == '13') {
                 e.preventDefault();
                 if($('#ddlSt').is(":focus")){
                     $('#submitQuery').trigger('click');
                 }
                 else{
                     return false;
                 }
               }
        });
}); 
```

错误指向`<script ... mymh.js></script>`但在调试器中它指向`$document.ready(function() {`

任何人都认为为什么 IE8 会继续抛出该错误有什么问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T23:21:58.447

尝试在第 16 行末尾放置一个分号

从

```
$('#ddlSt')
.find('option')
.remove()
.end()

$.each(data, function(i,field){ 
```

到

```
$('#ddlSt')
.find('option')
.remove()
.end();

$.each(data, function(i,field){ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-01T21:51:17.523

```
$(document).ready(function() { }); 
```

由于以下原因，此语句可能会引发 Object Expected 错误：

首先，如果我们指向外部 javascript 文件（例如 jquery-1.8.2.min.js）的链接不正确。确保您的链接位于正确的路径。我将文件保存在“js”文件夹中，并将路径指定为：

```
<script type="text/javascript" src="js/jquery-1.8.2.min.js"></script> 
```

其次，如果我们将脚本标签写为：

```
<script type="application/javascript"></script> 
```

代替

```
<script type="text/javascript"></script> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-17T19:48:49.090

我在 IE8 中使用 jQuery 2.0.0 时遇到了这个问题。根据 jQuery 站点“jQuery 2.x 不支持 Internet Explorer 6、7 或 8”。用 jQuery 1.10.2 替换 jQuery 2.0.0 为我解决了这个问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-18T14:30:52.593

有点旧的帖子，但它可能对路过的人有用，我遇到了同样的问题，我删除了脚本标签中的 defer 属性。

```
<script type="text/javascript" defer="defer" src="js/libs/jquery-1.8.3.min.js"></script> 
```

进入：

```
<script type="text/javascript" src="js/libs/jquery-1.8.3.min.js"></script> 
```

这对我有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-08-23T09:52:23.527

这可能无关紧要，但我刚刚解决了与 IE8 相同的问题 - 代码在 IE9 上运行良好，而在 IE8 上其他所有内容都阻塞了。

答案就像改变一样简单

```
 <script type="text/javascript" src="/myjavascript.js"></script> 
 <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script> 
```

到

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="/myjavascript.js"></script> 
```

...换句话说，首先是 JQuery。这为我解决了问题；YMMV。

# jquery - 从表单元素查询实时预览

> ID：10524246
> 
> 赞同：0
> 
> 时间：2012-05-09T21:19:30.157
> 
> 标签：jquery, ajax

我有一个表单，在提交表单之前单击预览按钮后，我希望在页面的其他位置以图形方式表示该表单。我写了以下内容：

```
 $('#preview').click(function() {
            var title = $('#inputTitle').attr('value');
            var location = $('#inputLocation').attr('value');

            $('.title').append(title);
            $('.location').append(location);                
        })

#inputTitle is a <input type="text"> from element
.title is an <h1> tag 
```

这似乎有效，但 APPEND 是正确的使用方法吗？每次我单击预览时，它只会将值添加到现有值中，而我需要先以某种方式将其剥离（在每次单击之前）或替换它。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:20:20.230

请改用[.text()](http://api.jquery.com/text)或[.html()](http://api.jquery.com/html)。

还要记住，使用像`.title`选择器这样的类将替换页面上该类的每个实例的内容，这可能不是您想要的。考虑改用 ID 选择器，它保证只匹配一次（或从不匹配）。

# file - 保存文件时设置初始文件扩展名

> ID：10524250
> 
> 赞同：5
> 
> 时间：2012-05-09T21:20:05.537
> 
> 标签：file, javafx

我有以下代码

```
FileChooser choose = new FileChooser();
choose.getExtensionFilters().add(new FileChooser.ExtensionFilter("Text doc(*.txt)", "*.txt"));
File f = choose.showSaveDialog(stage);
```

但是在选择器对话框中单击“保存”按钮后，创建的文件是文件格式，而不是 .txt，如何解决这个问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-02T14:35:24.570

我在使用 JavaFX 2.2 时遇到了同样的问题。我正在使用以下解决方法：

```
FileChooser choose = new FileChooser();
choose.getExtensionFilters().add(new FileChooser.ExtensionFilter("Text doc(*.txt)", "*.txt"));
File f = choose.showSaveDialog(stage);
if(!f.getName().contains(".")) {
  f = new File(f.getAbsolutePath() + ".txt");
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-03-20T10:32:18.643

对我来说效果最好，

```
FileChooser choose = new FileChooser();
choose.getExtensionFilters().add(new FileChooser.ExtensionFilter("Text doc(*.txt)", "*.txt"));
choose.setInitialFileName("*.txt");
File file = choose.showSaveDialog(stage);
if (file != null) {
  if (file.getName().endsWith(".txt")) {
    // do the operation with the file (i used a builder)
  } else {
    throw new Exception(file.getName() + " has no valid file-extension.");
  }
} 
```

像这样手动替换扩展的问题：

```
if(!f.getName().contains(".")) {
  f = new File(f.getAbsolutePath() + ".txt");
} 
```

也就是说，没有扩展名的文件可能不存在，但如果文件存在扩展名，它会被覆盖而没有任何警告。不是预期的行为。

# django - 当“loaddata”不起作用时，如何创建用于测试的夹具？

> ID：10524251
> 
> 赞同：0
> 
> 时间：2012-05-09T21:20:14.057
> 
> 标签：django, django-fixtures, dumpdata

我正在尝试为要扩展的开源项目创建一些测试装置。

有一个**Node**模型，它是**Question**模型的子类。

似乎问题在于 Node 使用了**自定义管理器**。

我可以创建固定装置，但它们无法重新加载，因为所有记录都没有转储。

当我尝试通过**loaddata**加载固定装置时，出现此错误：

```
IntegrityError: forum_node.author_id may not be NULL 
```

由于某种原因，未生成超类 Node。

有没有其他方法可以创建夹具以便我可以测试这个项目？

# jquery - 从jquery中隐藏的ul中选择li

> ID：10524252
> 
> 赞同：0
> 
> 时间：2012-05-09T21:20:17.620
> 
> 标签：jquery, jquery-selectors, drop-down-menu

我正在尝试选择一个已隐藏但可以使用滑动切换方法显示的列表项。

这是HTML

```
<ul>
  <li>item 1</li>
  <li>item 2</li>
  <li id="par1">parent 1</li>
    <ul id="par1list">
      <li>items to select1</li>
      <li>items to select2</li>
      <li>items to select3</li>
    </ul>
  <li id="par2">parent 2</li>
    <ul id="par2list">
      <li>items to select1</li>
      <li>items to select2</li>
      <li>items to select3</li>
    </ul>
</ul> 
```

在 jquery 中，我隐藏了子父列表（par1list 和 par2list），但是当单击父 1 或父 2 时它们会滑动切换。这是jQuery：

```
$(document).ready(function(){
    $("#par1list, #par2list").hide(); //hide elements

    $("#par1").click(function() {
        $("#par1list").slideToggle(400); //click parents to show hidden elements
    });
    $("#par2").click(function() {
        $("#par2list").slideToggle(400); //click parents to show hidden elements
    });

    $("#par1list > li").click(function(){  //select list item from previous hidden ul
        this.css('color', 'red');
    });
}); 
```

我正在尝试从 ul par1 中选择一个列表项，但我无法弄清楚。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:25:38.263

如果我理解正确，您需要使用`$(this)`而不是`this`

[**演示**](http://jsfiddle.net/skram/9JeCu/)

```
$("#par1list > li").click(function(){  //select list item from previous hidden ul
    $(this).css('color', 'red');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T08:16:56.650

我知道这个已经有一个很好的答案，但我想补充说明它为什么会这样工作：“this”是一个 DOM 元素。像“hello”，所以为了使用 jQuery，你首先需要将它包装在一个 jQuery 对象中，执行 $(this).

希望这会有所帮助。

# ios - AIR 移动调试 - “输入 ip 地址或主机名”

> ID：10524254
> 
> 赞同：1
> 
> 时间：2012-05-09T21:20:23.283
> 
> 标签：ios, flash, apache-flex, air, flash-builder

我正在使用 Flash Builder 4.6/AIR 开发一个移动应用程序。到目前为止，我一直能够在设备（iPhone 4s）上进行调试。我用 USB corad 将我的 iPhone 连接到我的 mac，然后进行调试。

突然间我黑屏了将近一分钟。然后我看到“输入 IP 地址或主机名”对话框。如果我输入我的机器的 IP 地址，那没关系。窗口消失约 15 秒，然后又回来。同时，我的 mac 上的 Flash Builder 超时。我真正看到程序运行的唯一方法是在该对话框上点击“取消”。然后应用程序启动，但我无法设置任何断点，无法调试。

我在互联网上找到的关于这个问题的所有内容都提到了 AIR for android——而不是 iOs。但我在 iOs 上看到了它。

有人知道这里发生了什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T15:48:04.783

为了方便以后的读者阅读，官方给出了这个问题的答案；

对于当前（官方）版本的 AIR SKD (3.2)，iOS 设备不支持 USB 调试。这将随着未来的 3.3 版本而改变，该版本（以及其他）增加了 USB 调试支持：

“ **AIR iOS 的 USB 调试** 这个新功能允许 iOS 开发人员在调试他们的移动应用程序时通过 USB 连接到桌面，而不是依赖网络连接。”

在 3.2 版中，iOS 调试工作在本地网络上，因此两个设备（运行调试器的机器和 iOS 设备）必须在同一个网络中，以便它们可以相互通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T16:01:55.107

另请参阅[我的 Flash 调试器的地址是什么？](https://stackoverflow.com/questions/4162180/what-is-the-address-of-my-flash-debugger)，它确实帮助我解决了类似的问题。使用“ios-debug”模式是要走的路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-23T17:42:58.913

如果在设备连接到同一个 wifi 的情况下使用 Android 时仍然存在此问题，请**尝试检查防火墙规则**。在我的情况下，FlashDevelop 被阻止了，我没有怀疑，因为更新工作得很好。

# c++ - c ++：没有正确进入for循环

> ID：10524258
> 
> 赞同：-2
> 
> 时间：2012-05-09T21:20:41.230
> 
> 标签：c++, debugging, for-loop

![for 循环](../Images/7acecc03d6654678b98f2878d40cafd1.png)

这两个函数是我的 cpp 文件的一部分。向量类型是类类型 (WordInText)。

当我的程序进入这些循环时，它会在一个循环内退出。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T21:24:03.217

我怀疑你想要：

`iter != wordintext_vec.end()`

而不是：

`iter < wordintext_vec.end()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T21:25:07.120

您以错误的方式执行循环条件。不要比较“小于”，而是“不等于”。返回的迭代器在比较时将像指针一样工作，从而导致未定义的行为（即循环可能在到达结束之前的任何时间结束）。

要解决此问题，只需与“不等于”进行比较：

```
for(vector<WordInText>::const_iterator iter = wordintext_vec.begin(); iter != wordintext_vec.end(); ++iter) {
    // ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T21:30:51.860

当你第一次进入这个方法时，检查向量中是否有元素。

您应该能够执行类似（伪代码）的操作：

if (wordintext_vec.length == 0) 或 if (wordintext_vec.isnull())

{

ERROR_LOGIC("向量为空");

}

# tcl - 预期脚本问题

> ID：10524261
> 
> 赞同：1
> 
> 时间：2012-05-09T21:20:47.777
> 
> 标签：tcl, telnet, expect, cisco

我是新手，我正在使用一种逻辑来自动断开用户登录的 telnet 会话并保持其他行不变：

```
for {set i 0} {$i ==4} {incr i} {  
send "clear line vty $i\r"  
"confirm]" {send "\r"}  
"% Not allowed" {send "quit\r"; exit}  
} 
```

它断开所有线路

现在我使用“显示用户”命令，但我很难围绕它编写脚本，输出对我来说不够友好。所以我在这个 for 循环中编写了 IF 语句，但它并不好，甚至不值得在这里包含. 请有人指导我如何匹配输出结果中的字符串，并根据字符串决定是否清除行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:47:06.280

这是算法的一个有趣的旋转......您目前在遍历所有行时遇到的问题是，如果您的脚本仅在其中一行上看到自己，那么您的脚本将退出......

```
for {set i 0} {$i == 4} {incr i} {
send "clear line vty $i\r"
"confirm]" {send "\r"}
"% Not allowed" {send "quit\r"; exit}
} 
```

如果您看到`% Not allowed`，只需绕过此行并移至下一行，而不是退出脚本...

```
for {set i 0} {$i < 4} {incr i} {
    send "clear line vty $i\r"
    expect {
        "confirm]" { send "\r"; expect "*#" }
        "% Not allowed" { send "! refusing to clear line vty $i\r"; expect "*#" }
    }
} 
```

如果一行以`!`

* * *

以下脚本登录并清除除脚本运行的行之外的所有行...这在我的实验室中运行良好。

```
#!/usr/bin/expect -f

spawn telnet 172.16.1.5
set user [lindex $argv 0]
set pass [lindex $argv 1]

expect "Username: "
send "$user\r"
expect "assword: "
send "$pass\r"
expect ">"
send "enable\r"
expect "assword: "
send "$pass\r"
expect "*#"
for {set i 0} {$i < 5} {incr i} {
    send "clear line vty $i\r"
    expect {
            "confirm]" { send "\r"; expect "*#" }
            "% Not allowed" { send "! refusing to clear line vty $i\r"; expect "*#" }
    }
}
exit 
```

# gridview - Yii 简单的主从 CGridView 解决方案？

> ID：10524262
> 
> 赞同：0
> 
> 时间：2012-05-09T21:20:47.853
> 
> 标签：gridview, grid, widget, components, yii

我有类似 order-order_details 的东西
- 所以当我连续选择时，我想在它下面显示细节（作为另一个网格）

并且能够从那里添加细节并编辑它们（可能在对话框中）

有没有简单的解决方案？组件.. 用于主详细信息或对话框编辑、删除、添加？

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T09:15:30.373

试试这个扩展：[http ://www.yiiframework.com/extension/eupdatedialog/](http://www.yiiframework.com/extension/eupdatedialog/)

# php - 多次运行 while($row = sqlsrv_fetch_array($result))

> ID：10524263
> 
> 赞同：1
> 
> 时间：2012-05-09T21:20:54.917
> 
> 标签：php, sql-server, while-loop

我正在从 MSSQL 数据库中检索几个表，然后运行这些表以从中获取订单信息。

我的代码如下所示：

```
 while($row = sqlsrv_fetch_array($orderResult))
    {
        ......code........
        ..................
        while($statusRow = sqlsrv_fetch_array($statusResult))
        {
            ....code....
        }
        ....code....
    } 
```

现在我的问题是，在第二个循环运行之后，它就再也不会运行了。每次第一个循环运行时，我都需要它运行。

我可以做些什么来重置第二个循环以再次运行？

先感谢您。任何帮助或朝着正确方向的推动都会非常有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:31:26.943

阅读[sqlsrv_fetch_array()中的其他参数](http://www.php.net/manual/en/function.sqlsrv-fetch-array.php)

你可以做这样的事情来重置

```
// reset, and get first row
$row = sqlsrv_fetch_row($result, SQLSRV_FETCH_BOTH, SQLSRV_SCROLL_FIRST);

// get second (and nth row) normally
$row = sqlsrv_fetch_row($result); 
```

或者，我认为您可以从`JOIN`在查询中执行 a 返回单个结果中受益。像这样手动合并结果似乎有点骇人听闻。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-19T18:44:25.463

从返回多个结果集的数据库调用存储过程时，我遇到了类似的问题。我发现 Macek 的答案对我不起作用，但[另一个答案](http://social.msdn.microsoft.com/Forums/sqlserver/en-US/eec88358-0c51-4d94-aff1-48bc151cfee1/result-set-metadata-from-ctp-php-driver-feedback?referrer=http://social.msdn.microsoft.com/Forums/sqlserver/en-US/eec88358-0c51-4d94-aff1-48bc151cfee1/result-set-metadata-from-ctp-php-driver-feedback?forum=sqldriverforphp)确实有效：

```
$resultSet = array();
$isNotLastResult = true;
$i = 0;

while (!is_null($isNotLastResult))
{
    $resultSet[$i] = array();

    while ($row = sqlsrv_fetch_array($result, SQLSRV_FETCH_ASSOC))
    {
        $resultSet[$i][] = $row;
    }

    $isNotLastResult = sqlsrv_next_result($result);
    $i++;
}

print_r($resultSet); 
```

PS：我给了你一个向上箭头来抵消你的向下箭头。你问了一个问题，我花了很多时间寻找答案。好问题！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-02T00:55:41.433

使用以下命令重置指针：

```
sqlsrv_fetch_array ($Res, SQLSRV_FETCH_ASSOC, SQLSRV_SCROLL_ABSOLUTE, -1); 
```

然后使用与之前相同的代码循环遍历结果集。sql_fetch_array 似乎在检索数据后递增指针。请求 -1 记录不会检索任何内容，但会将指针设置为 0，即第一条记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T21:25:54.863

你确定你的第二个循环得到了第二次运行的结果吗？也许，如果你的 $statusResult 依赖于你的 $row 并且你的 $row 只有第一个循环的条目，你应该在你的数据库中插入一些伪条目。

第二个循环应该在下一个“大”循环中刷新自身，因为整个内部块将在大块的末尾被销毁，并将在下一个条目时（完全）重建。

# jquery - ajax 请求的数量重要吗？如何？

> ID：10524264
> 
> 赞同：0
> 
> 时间：2012-05-09T21:21:00.833
> 
> 标签：jquery, ajax, web, httprequest

我有一个向客户显示各种信息的网站。它有一个聊天、不同类型的聊天、几个通知等。

我构建它的方式是每个 ajax 调用，对于每个聊天和通知，每秒发生一次。所以在任何给定的点上，我至少有 5 个请求发生。

例如，聊天必须看起来很活跃，如果有电子邮件通知我想在它发生时显示它，如果有朋友请求我想立即显示它。

到目前为止一切看起来都很好，但我想知道是否有限制，或者这样做是否只是不好。同时我希望用户体验最好。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:34:24.437

如果您真的进行并发调用并且并发对您来说真的很重要，它确实如此！

在任何浏览器中每个域都允许有限数量的并发请求，[您可以在此处阅读更多内容](https://stackoverflow.com/questions/561046/how-many-concurrent-ajax-xmlhttprequest-requests-are-allowed-in-popular-browse)，如果您过度使用它，您的请求可能会被阻止等待其他人完成！但是，如果它不关心您，浏览器将创建请求队列并在空闲时将其发送到服务器。

# iphone - iOS 中的日历计算在 1577 年之前就被破坏了……（朱利安 -> 格里高利）

> ID：10524266
> 
> 赞同：4
> 
> 时间：2012-05-09T21:21:07.207
> 
> 标签：iphone, ios, nscalendar

相同的代码

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"d MMMM yyyy GG"];
//13th of December 1577
NSDate * aDate = [NSDate dateWithTimeIntervalSince1970:-12371067248]; 

NSString * formattedDate = [dateFormatter stringFromDate:aDate]; 
```

Mac OS X 目标正确显示 formattedDate

> 1577 年 12 月 13 日

iOS 5.0 目标显示

> 1577 年 12 月 23 日

好像 Julian -> Gregorian 转换被窃听了

任何想法如何克服？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-19T10:32:18.877

尝试在 Mac 和 iOS 上运行此代码

```
NSDateFormatter *localFormatter = [[NSDateFormatter alloc] init];
localFormatter.timeStyle = NSDateFormatterNoStyle;
localFormatter.dateStyle = NSDateFormatterMediumStyle;

NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"g"];  // g = julian day number
NSDate *d2299159 = [dateFormatter dateFromString:@"2299159"];
NSDate *d2299160 = [dateFormatter dateFromString:@"2299160"];
NSDate *d2299161 = [dateFormatter dateFromString:@"2299161"];
NSDate *d2299162 = [dateFormatter dateFromString:@"2299162"];

NSLog(@"Julian Day Number 2299159 = %@", [localFormatter stringFromDate:d2299159]);
NSLog(@"Julian Day Number 2299160 = %@", [localFormatter stringFromDate:d2299160]);
NSLog(@"Julian Day Number 2299161 = %@", [localFormatter stringFromDate:d2299161]);
NSLog(@"Julian Day Number 2299162 = %@", [localFormatter stringFromDate:d2299162]); 
```

你会得到这些输出（除了 <-- 注释）：

**苹果电脑**

```
Julian Day Number 2299159 = 1582-10-03   <-- Julian calendar
Julian Day Number 2299160 = 1582-10-04   <-- Julian calendar
Julian Day Number 2299161 = 1582-10-15   <-- Gregorian calendar
Julian Day Number 2299162 = 1582-10-16   <-- Gregorian calendar 
```

**iOS**

```
Julian Day Number 2299159 = 1582-10-13   <-- Proleptic Gregorian calendar
Julian Day Number 2299160 = 1582-10-14   <-- Proleptic Gregorian calendar
Julian Day Number 2299161 = 1582-10-15   <-- Gregorian calendar
Julian Day Number 2299162 = 1582-10-16   <-- Gregorian calendar 
```

在 Mac 上，NSDateFormatter 切换到儒略历（也称为旧式日期），用于 1582 年 10 月 15 日之前的日期，这是公历中的第一天（Apple 使用的日期。某些国家/地区采用不同的日期）。如果您引用此日期之前的公历日期，则这些日期在预测的公历中，即公历存在之前的日期。而且，正如您从第二个输出中看到的那样，iOS 平台上的 NSDateFormatter 并没有切换到儒略历，而是保留在预测的公历中。您的输出中的差异正是在从儒略到格里高利的过渡中跳过的 10 天。

如果您想使用不同的日历来了解更多关于这些东西的信息，我强烈推荐这个小程序： [http](http://www.cs.tau.ac.il/~nachum/calendar-book/Calendrica.html) ://www.cs.tau.ac.il/~nachum/calendar-book/Calendrica.html 这些人还写道一本关于这个主题的精彩书。

此外，Apple 在其文档中有一小部分关于历史日期：[https ://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/DatesAndTimes/Articles/dtHist.html#//apple_ref/doc/ uid/TP40010240-SW1](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/DatesAndTimes/Articles/dtHist.html#//apple_ref/doc/uid/TP40010240-SW1) 但是，他们并没有提到NSDateFormatter在不同平台上的实现差异！

使用日历来自地狱 - 祝你好运:-)

# ios - Apple Mach-O 链接器错误 (5)

> ID：10524267
> 
> 赞同：1
> 
> 时间：2012-05-09T21:21:16.033
> 
> 标签：ios, xcode, mach-o

每当我尝试构建我的项目（它同时具有[IFUnicodeURL](https://github.com/BigZaphod/IFUnicodeURL)和[JSON](https://github.com/stig/json-framework)）时，我都会不断收到这 5 个 Mach-O 错误。

架构 armv7 的未定义符号：

```
 "_kUTTagClassMIMEType", referenced from:
      -[NSString(NPMimeType) mimeType] in NSString+NPMimeType.o
  "_UTTypeCopyPreferredTagWithClass", referenced from:
      -[NSString(NPMimeType) mimeType] in NSString+NPMimeType.o
  "_UTTypeCreatePreferredIdentifierForTag", referenced from:
      -[NSString(NPMimeType) mimeType] in NSString+NPMimeType.o
  "_kUTTagClassFilenameExtension", referenced from:
      -[NSString(NPMimeType) mimeType] in NSString+NPMimeType.o
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我不知道如何阅读这些东西，这让我发疯。有人可以帮我吗？任何帮助，将不胜感激。提前致谢。

# python - 用于引导置信区间和非参数多数据集比较的 Python 统计包

> ID：10524269
> 
> 赞同：11
> 
> 时间：2012-05-09T21:21:29.763
> 
> 标签：python, statistics, statistics-bootstrap

我正在寻找一个 Python 包，它可以计算一个/两个引导置信区间并执行非参数多数据集比较。有人知道吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-11T01:22:21.473

在我的实验室伙伴的帮助下，我找到了包含我需要的所有统计数据的软件包。

自举 CI：[http ://scikits.appspot.com/bootstrap](http://scikits.appspot.com/bootstrap)

方差分析： http: [//docs.scipy.org/doc/scipy/reference/generated/scipy.stats.f_oneway.html](http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.f_oneway.html)

我希望这对其他发现自己处于我困境中的人有所帮助！

# mysql - 用另一行更新数据库行（Mysql）

> ID：10524272
> 
> 赞同：2
> 
> 时间：2012-05-09T21:21:48.027
> 
> 标签：mysql, sql

如果我有一个表 Emp 并且我希望第 2 行的地址 id 与第 1 行的地址 id 相同，我可以在没有存储过程的情况下这样做吗？

就像是

```
UPDATE Emp SET address_id = (SELECT address_id FROM Emp WHERE id = 1) WHERE id = 2; 
```

也许我可以做一些类似 update Emp e1, Emp e2 set ... 的事情？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:57:34.950

这应该对你有用。

```
UPDATE Emp t, (SELECT address_id
    FROM Emp
    WHERE ID = 1) t1
SET t.address_id = t1.address_id
WHERE ID = 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T03:27:01.090

您的更新可以工作（在其他数据库上），但 MySQL 坚持认为表不能自行更新，即您不能这样做：

```
update tbl
  set address = (select address from tbl where name = 'paul')
where name = 'george'; 
```

但你可以做一个解决方法：[http ://www.sqlfiddle.com/#!2/5f373/6](http://www.sqlfiddle.com/#!2/5f373/6)

```
update tbl
  set address = ( select address from 
                      (select address from tbl where name = 'paul') x )
where name = 'george'; 
```

无论如何，您应该使用[Gregology 的答案](https://stackoverflow.com/a/10524668)。这是面向未来的，您可以在要更新两个或更多字段时使用它。Gregology 在 sqlfiddle 中的答案演示：[http ://www.sqlfiddle.com/#!2/5f373/10](http://www.sqlfiddle.com/#!2/5f373/10)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T02:45:14.243

试试这个。

UPDATE Emp SET address_id = (SELECT t.address_id FROM Emp t WHERE t.id = 1) WHERE id = 2

-- 表的别名只能通过更新语句的子查询来完成。

瑞安 A. (NZT)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-09T21:24:08.877

事实上，您发布的查询应该可以工作。此功能称为子查询。

# php - 你能检查在 PHPUnit 中没有 getMock 的情况下调用了多少次函数吗

> ID：10524275
> 
> 赞同：0
> 
> 时间：2012-05-09T21:22:00.140
> 
> 标签：php, phpunit

我的测试套件调用`accepted`对象 A。然后，该函数将调用`insert`对象 B 一定次数，具体取决于我正在运行的测试。

我想验证`insert`在每个测试中被调用的次数是否正确。我*认为*我不能使用模拟来计算它，因为对象 A 在我的测试中不会碰到模拟。

我从 2 年前看到了这个问题： [PHPUnit Test How Many Times A Function Is Called](https://stackoverflow.com/questions/3809260/phpunit-test-how-many-times-a-function-is-called)

使用全局变量进行计数并不理想，因为我的类中不应该有专门用于类的代码。

**编辑**

注意它`insert`是静态的可能会有所帮助。即使我模拟该类并指定我只想模拟该函数，它仍然会调用模拟`new`对象，这是我面临的另一个障碍。

**答案** 答案是否定的。我只想@zerkms 给出这个答案，因为他是帮助我的人，所以我可以接受。

我最终发现我只能使用一个对象，但确实遇到了另一个障碍： [为什么 PHPUnit 不将此函数计算为已运行？](https://stackoverflow.com/questions/10537100/why-isnt-phpunit-counting-this-function-as-having-ran)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:31:34.697

似乎在这种特殊情况下这是不可能的。

但在某些特定情况下，您可以模拟静态方法：[http ://sebastian-bergmann.de/archives/883-Stubbing-and-Mocking-Static-Methods.html](http://sebastian-bergmann.de/archives/883-Stubbing-and-Mocking-Static-Methods.html)

```
class Foo
{
    public static function doSomething()
    {
        return static::helper();
    }

    public static function helper()
    {
        return 'foo';
    }
} 
```

测试：

```
public function testQQQ()
{
    $class = $this->getMockClass(
        'Foo',          /* name of class to mock     */
        array('helper') /* list of methods to mock   */
    );

    $class::staticExpects($this->exactly(2))
        ->method('helper')
        ->will($this->returnValue('bar'));

    $this->assertEquals(
        'bar',
        $class::doSomething()
    );
} 
```

结果：

```
$ phpunit --filter QQQ
PHPUnit 3.6.10 by Sebastian Bergmann.

Configuration read from /var/www/.../phpunit.xml

F

Time: 1 second, Memory: 10.75Mb

There was 1 failure:

1) ...::testQQQ
Expectation failed for method name is equal to <string:helper> when invoked 2 time(s).
Method was expected to be called 2 times, actually called 1 times.

FAILURES!
Tests: 1, Assertions: 2, Failures: 1. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:38:44.777

您可以使用[runkit 动态](http://php.net/manual/en/book.runkit.php)重新定义静态方法（但您可能不应该这样做）。除此之外，您将不得不重组代码。要么使用非静态调用和依赖注入（因此对象 A 从外部源接收对象 B，并且您的测试可以改为通过模拟）或使用依赖注入容器，以便不连接类名并且您的测试可以创建一个模拟子类并让 A 类使用它（这更混乱，但您的非测试代码需要更少的更改，因为您可以让您的方法保持静态）。

# python - 如何在 Python 中创建由原始表的列子集组成的数据表

> ID：10524277
> 
> 赞同：0
> 
> 时间：2012-05-09T21:22:11.453
> 
> 标签：python, python-3.x

我是 Python 的初学者。我的数据表（Table1）有 21 列和数千行。它太大了，我无法在笔记本电脑上打开它。它看起来有点像这样：

ABCDEFG、HIJKLMNO、PQRSTUVW、TEYHDSJD ........

TRGFHFJ，GDGSANTO，JDKNVWWR，URNWHJX ........

…………

但是，我需要重现该表的一个子集，该子集仅包含第 10-21 列。我尝试了以下方法：

```
import sys
import csv

with open(sys.argv[1], "r") as input:
   readinput = csv.reader(input, delimiter=',')
   with open("output.csv", 'wt') as output:
      writer=csv.writer(output, delimiter="\t")
      for row in input:
         values =  [row[10],row[11],row[12],row[13],row[14],row[15],row[16],row[17],row[18],row[19],row[20],row[21]]
         writer.writerow([values])
         print (row[10]) 
```

但事实证明 cvs.reader 的表达式“row[10]”没有将其解释为行的第 10 个元素（=第 10 列）。相反，它给了我第 10 个字母。所以输出的不是Table1的第10到21列，而是第10到21个字母，有点像这样：

K、L、M、N、O、""、P、Q、R、S、T、U

S、A、N、T、O、""、J、D、K、N、V、W

我究竟做错了什么？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:28:14.857

你正在使用`for row in input`，我猜你想要`for row in readinput`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:14:25.753

如果您有一个 .csv 文件，并且想要创建另一个 .csv 以使后一个文件仅包含前一个文件的第 10 到 21 列，则可以执行以下操作：

```
with open('old_file.csv') as old_f, open('new_file.csv', 'w') as new_f:
    for line in old_f:
        new_f.write(','.join(line.split(',')[10:])) 
```

# javascript - Javascript 操作订单表单的值

> ID：10524279
> 
> 赞同：0
> 
> 时间：2012-05-09T21:22:29.470
> 
> 标签：javascript, jquery, forms, controls

我目前正在创建一个订单。但是，我一直停留在获得的价值上。它是一个产品订单，我想显示价格并根据用户的选择计算数量。

例如，我有一个产品数量下拉列表，所以当用户选择一种产品时，价格 div 将显示一个值，如果用户选择 0，价格 div 将显示 $0。哪里有问题？

```
var productValue = document.getElementById("e_Product");
var productQuantity = document.getElementById("e_Quantity");
var stringValue = productValue.options[productValue.selectedIndex].text;

if (stringValue == "Product Name" && productQuantity == 1) 
{
    var singleValue = "$800.00";
    $('#e_Price').val(singleValue);
}
else
{
    var singleValue1 = "$0.00";
    $('#e_Price').val(singleValue1);
} 
```

当我在 if 语句中设置两个条件时，整个函数就不再起作用了。另外，当我从 1 到 0 选择产品数量时，表单的价格字段没有更新数字，我是否错过了下拉列表的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:34:26.600

您应该使用事件处理程序来更新字段：

```
$("#e_Product").change(function(){
   var val = $(this).val();
   var quan = $("#e_Quantity").val();
   if (val == "Product Name" && quan == 1)
     var singleValue = "$800.00";
     $('#e_Price').text(singleValue); // if e_Price is a div tag you should use text() instead of val() 
   }
   else
   {
     var singleValue1 = "$0.00";
     $('#e_Price').text(singleValue1);
   }
}) 
```

# php - 无法使用 jQuery 建立 ajax 连接，表单自动提交？

> ID：10524280
> 
> 赞同：0
> 
> 时间：2012-05-09T21:22:30.153
> 
> 标签：php, jquery, forms, form-submit

我是 Jquery 的新手，只是遇到了一个我无法克服的问题。

简单地说，我有一个页面上有几个元素的 HTML 表单。我想在单击提交按钮时验证表单值，然后使用 JQuery 将一些表单值插入到数据库中。插入过程成功完成后，我希望表单自然提交。

我进行了验证，并从表单中成功获取了所有值，但我无法连接到 PHP 页面。我有两页。

这是JQuery代码：

```
 <script type="text/javascript">
        $(document).ready(function() {
            $("#odeme").submit(function() {

                $('#ok').attr('disabled', 'disabled');
                $("#ok").after('<span id="info" style="font-size:8pt;color:green;padding-left:5px;"><img align="absmiddle" src="loading.gif" border="0" /> &nbsp; Ödemeniz Yapılıyor</span>');

                //değişkenler

                var jad = $("#ad").val().length;  
                var jsoyad = $("#soyad").val().length;  
                var jadres = $("#adres").val().length;  
                var jeposta = $("#eposta").val().length;
                var isEposta = $("#eposta").val();
                var epostaReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;  
                var jsehir = $("#sehir").val(); 
                var jtaksit = $("#taksit").val();  
                var jkartisim = $("#kartisim").val().length;  
                var jkartno = $("#kartno").val().length;
                var jkartay = $("#kartay").val();  
                var jkartyil = $("#kartyil").val(); 
                var jkartcvv = $("#kartcvv").val().length;
                var hasError = false;

                // kontrollere başla

                if (jad < 6) {
                    $('#ad').css('border', 'solid 1px red');
                    hasError = true;
                    }

                if (jsoyad < 2) {
                    $('#soyad').css('border', 'solid 1px red');
                    hasError = true;
                    }

                if (jadres < 10) {
                    $('#adres').css('border', 'solid 1px red');
                    hasError = true;
                    }

                if (jeposta < 6) {
                    $('#eposta').css('border', 'solid 1px red');
                    hasError = true;
                    }

                if (jsehir == 0) {
                    $('#sehir').css('border', 'solid 1px red');
                    hasError = true;
                    }

                if (jtaksit == 20) {
                    $('#taksit').css('background', '#FF9494');
                    hasError = true;
                    }

                if (jkartisim < 6) {
                    $('#kartisim').css('border', 'solid 1px red');
                    hasError = true;
                    }

                if (jkartno < 15) {
                    $('#kartno').css('border', 'solid 1px red');
                    hasError = true;
                    }

                if (jkartay == 0) {
                    $('#kartay').css('border', 'solid 1px red');
                    hasError = true;
                    }

                if (jkartyil == 0) {
                    $('#kartyil').css('border', 'solid 1px red');
                    hasError = true;
                    }

                if (jkartcvv != 3) {
                    $('#kartcvv').css('border', 'solid 1px red');
                    hasError = true;
                    }

                if ($('#sozlesme').is(':checked')) {
                    hasError = false;

                }   else { 
                    $('#sozlesme').css('outline-color', 'red');
                    $('#sozlesme').css('outline-style', 'solid');
                    $('#sozlesme').css('outline-width', 'thin');
                    hasError = true; 
                    }

                if (!epostaReg.test(isEposta)) {
                    $('#eposta').css('border', 'solid 1px red');
                    hasError = true;
                    }

                if (hasError == true) {
                    $("#info").remove();
                    $("#ok").after('<span id="errorSpan" style="color:red;padding-left:5px;">Lütfen formu eksiksiz doldurunuz.</span>');
                    $("#errorSpan").delay(3000).fadeOut(2000);
                    $('#ok').removeAttr("disabled");
                    return false;

                    } else {

                // form verilerini db ye at 

                var form_ad = $("#ad").val();  
                var form_soyad = $("#soyad").val();  
                var form_adres = $("#adres").val();  
                var form_eposta = $("#eposta").val();
                var form_sehir = $("#sehir").val(); 
                var form_taksit = $("#taksit").val(); 
                var form_telno = $("#telno").val(); 
                var form_cinsiyet = $("#cinsiyet").val(); 

                var dataString = 'ad='+ form_ad + 
                                 '&soyad=' + form_soyad + 
                                 '&adres=' + form_adres + 
                                 '&eposta=' + form_eposta + 
                                 '&sehir=' + form_sehir + 
                                 '&taksit=' + form_taksit + 
                                 '&telno=' + form_telno + 
                                 '&cinsiyet=' + form_cinsiyet;

                alert(dataString);

                JQuery.ajax({ 
                    type: "POST", 
                    url: "form.php", 
                    data: dataString, 
                    cache: false,
                    success: function(result){ 

                            if(result == 1) { 
                            alert(result); 

                            return false; } 

                            else {

                            $("#ok").after('<span id="errorSpan" style="color:red;padding-left:5px;">Lütfen formu eksiksiz doldurunuz.</span>');

                            }
                        } 
                    }); 

                }
            });
        });

    </script> 
```

这是form.php的代码

```
<?php

If (!isset($_POST['ad'])) {
    echo 0;
    }
    else {

$ad = $_POST['ad'];

If ($ad == "asdasd") {
    echo 1;
} else {

echo 0;
}

}
?> 
```

我已阅读有关此问题的所有问题并尝试应用所有解决方案，但我被卡住了：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:35:25.523

尝试这个：

```
$(document).ready(function() {
    $("#odeme").submit(function() {

        //validation
        //and
        //ajax

        return false; //this suppresses default form submission behaviour 

    });
}); 
```

# playframework - 在 Play 中托管静态 HTML！CloudFront 上的应用程序

> ID：10524285
> 
> 赞同：2
> 
> 时间：2012-05-09T21:23:01.560
> 
> 标签：playframework, cdn, amazon-cloudfront

我的网站有一部分（高流量）完全是静态的。所有站点的 URL 都是相对的，所以现在只要我将浏览器指向`http://gj232j2j213.cloudfront.net/blah`.

我想在 Cloudfont（或其他一些 CDN）上托管整个东西（不仅仅是图像和 css，还有 HTML）。

理想情况下，我可以这样说：

```
GET    /static/    staticDir:http://gj232j2j213.cloudfront.net/blah 
```

在我的路线文件中。这样我的 URL 看起来像`www.mydomain.com/static/main.html`，当用户在我的静态和非静态 URL 之间来回移动时，我不必将用户反弹到不同的子域。

有任何想法吗？我被误导了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T13:35:14.627

我在我的`conf/routes`文件中使用了以下内容来执行此操作：

```
# Map static resources from the /app/public folder to the /public path
#{if play.Play.mode.isDev()}
    GET     /public/                        staticDir:public
#{/}
#{else}
    GET     d2iu8jbjgczc8x.cloudfront.net/public  staticDir:public
    GET     /public/                              staticDir:public
#{/} 
```

然后，您只需以正常方式引用静态资产，URL 将使用 CloudFront 服务器（在 Prod 模式下）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-10T11:40:15.827

永远无法让它在 Play 2.x 中工作。

```
GET     /public/      staticDir:public 
```

对我有用的是这样的。

```
GET  /somefile.html   controllers.Assets.at(path="/public", file="somefile.html") 
```

# php - 数组的操作（生成表）

> ID：10524288
> 
> 赞同：0
> 
> 时间：2012-05-09T21:23:12.590
> 
> 标签：php, arrays, multidimensional-array

我有以下数组：

数组`$eventos`：

```
Array (
    [0] => Array (
            [Evento] => Array (
                    [id] => 1
                    [nome] => Event 1
                )
            [Obreiro] => Array (
                    [0] => Array (
                            [id] => 2
                            [usuario_id] => 4
                            [nome] => Teste
                        )
                    [1] => Array (
                            [id] => 5
                            [usuario_id] => 8
                            [nome] => Teste
                         )
                )
        )
    [1] => Array (
            [Evento] => Array (
                    [id] => 2
                    [nome] => Event 2
                )

            [Obreiro] => Array (
                    [0] => Array (
                            [id] => 3
                            [usuario_id] => 6
                            [nome] => Teste
                        )
                    [1] => Array
                        (
                            [id] => 5
                            [usuario_id] => 7
                            [nome] => Teste
                        )
                )
        )
) 
```

和数组`$obreiros`：

```
Array (
    [0] => Array (
            [Obreiro] => Array (
                    [id] => 2
                    [usuario_id] => 4
                    [nome] => Foo
                )
        )
    [1] => Array (
            [Obreiro] => Array (
                    [id] => 5
                    [usuario_id] => 8
                    [nome] => Bar
                )
        )
) 
```

我想做：对于每个`$obreiros`用户，显示是否参与了事件（在 array 中定义`$evento[x]['Obreiro'][y]`，其中 x 和 y 是数字）。

样本：

```
 | Event 1 | Event 2 | Event n
--------------------------------------
Foo    |    x    |         |    x    
Bar    |    x    |    x    |
Foo 2  |         |         |    x 
```

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:49:56.873

已经完成了代码的工作：

```
foreach($obreiros as $kObreiro => $obreiro) {
    foreach($eventos as $kEvento => $evento) {
        $faltou = true;

        if(isset($evento['Obreiro']) && is_array($evento['Obreiro']) && count($evento['Obreiro']) > 0) {
            foreach($evento['Obreiro'] as $kEventoObreiro => $eventoObreiro) {
                if($eventoObreiro['usuario_id'] == $obreiro['Usuario']['id']) {
                    $faltou = false;
                }
            }
        }

        if($faltou) {
            echo'X';
        } else {
            echo' ';
        }
    }
    echo '<br />';
} 
```

# c++ - 实现在 C++ 表达式模板中评估表达式的能力

> ID：10524292
> 
> 赞同：2
> 
> 时间：2012-05-09T21:23:51.047
> 
> 标签：c++, templates, template-meta-programming

我必须评估格式 x 幂 n + 1 的表达式。我使用以下格式重载了 +、-、*、/

```
template<class L,class R>
Expr<L,R,plus<double> > operator+(const L l,const R r){
return Expr<L,R,plus<double> >(l,r);
}; 
```

我如何为权力做同样的事情？

我的程序可以评估 x+1+2x 类型的表达式或任何没有幂的表达式。我希望能够评估具有 (2xpower2)+2 等幂的表达式，其中 x 的值是一个变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:28:17.710

为 x^0 定义一个返回 1 的模板特化。

为返回的一般情况（即 x^y）定义一个模板`x * pow<x, y-1>`

# php - 如何在不同的日期应用两个不同的查询php

> ID：10524297
> 
> 赞同：1
> 
> 时间：2012-05-09T21:24:15.523
> 
> 标签：php

我有一张这样的桌子

```
+-----------------------------------------------------------------+
|                              seeker                             |
+----+-------+----------+---------------+-------------------------+
| id | name  | password | register_date | login_date | limit_date |
+----+-------+----------+---------------+------------+------------+
| 01 | ali   |   ****   |  2012-02-08   | 2012-02-09 | 2012-03-09 |
| 02 | hamza |   ****   |  2012-04-10   | 0000-00-00 | 0000-00-00 |
| 03 | sam   |   ****   |  2012-04-15   | 0000-00-00 | 0000-00-00 |
+----+-------+----------+---------------+------------+------------+

register_date = when user ger registered
login-date= when user attempt to login
limit date= login-date + 1 month 
```

现在我必须为注册和登录“ali”的用户应用两个不同的删除查询，一个为只注册但没有尝试登录“hamza，sam”并且登录日期='0000-00-00'的用户应用

我正在这样`if-statment`使用

```
 $qry="select * from seeker where login_date='0000-00-00'";
    $rs= mysql_query($qry, $con);
    $res=mysql_fetch_array($rs);

    if($res==0)
    {
      //query to delete user who has login date
      $q= "delete from seeker where current_date = limit_date'";
      if($rq=mysql_query($q, $con));
      echo "$q";

    }

   else if($res!=0)
    {
        //query to delete user who didnot login and has login-date='0000-00-00'
        $qry1="delete from seeker where '$days' >= 30";
            $rs1= mysql_query($qry1, $con);
            echo $qry1;
    } 
```

我很困惑，`making some mistake in if-statment`我猜。当我运行此代码时，它只执行`else if`。它也应该执行`first if`，因为这两种情况都根据我的数据库发生

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T21:38:02.980

我想你想检索行数，所以：

```
 $qry="select * from seeker where login_date='0000-00-00'";
    $rs= mysql_query($qry, $con);
    $res=mysql_num_rows($rs);

    if($res==0)
    {
      //query to delete user who has login date
      $q= "delete from seeker where current_date = limit_date'";
      if($rq=mysql_query($q, $con));
      echo "$q";

    }

   else if($res!=0)
    {
        //query to delete user who didnot login and has login-date='0000-00-00'
        $qry1="delete from seeker where '$days' >= 30";
            $rs1= mysql_query($qry1, $con);
            echo $qry1;
    } 
```

编辑 ：

```
<?php

    $qry="select * from seeker where login_date='0000-00-00'";
    $rs= mysql_query($qry, $con);
    $res=mysql_num_rows($rs);

    if($res!=0)
    {
        $qry1="delete from seeker where '$days' >= 30";
            $rs1= mysql_query($qry1, $con);
            echo $qry1;
    }

    $qry="select * from seeker where current_date = limit_date";
    $rs= mysql_query($qry, $con);
    $res=mysql_num_rows($rs);

    if($res!=0)
    {
         $q= "delete from seeker where current_date = limit_date";
            $rs1= mysql_query($qry1, $con);
            echo $qry1;
    }

?> 
```

# php - PHP DOMDocument loadHTML 错误

> ID：10524300
> 
> 赞同：3
> 
> 时间：2012-05-09T21:24:30.707
> 
> 标签：php, html, parsing, dom, domdocument

它回来了

> ( ! ) 警告：DOMDocument::loadHTML() [domdocument.loadhtml]: Misplaced DOCTYPE declaration in Entity, line: 3 in C:\wamp\www\source.php on line 8

编码：

```
<?php

    $url = "http://www.some-plain-html-website.com";

    $content = file_get_contents($url);

    $dom = new DOMDocument;
    $dom->loadHTML($content);

?> 
```

由于某种原因，它不会解析 $content。如果我将内容设为 $content = ""; 这样的字符串 我通过元素标签名称对其进行解析它没有问题但是如果我给它返回 file_get_content() 方法它会产生该错误。

file_get_contents() 的文档说它返回一个字符串，但由于某种原因它不起作用我什至尝试了 $content = (string)file_get_contents($url);

同样的事情提前感谢所有的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-07-22T21:59:26.737

在许多情况下，建议先`libxml_use_internal_errors(true);`使用`$dom->loadHTML($content);`

这样就不会引发警告，并且无论如何都会加载页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T21:37:38.827

您尝试抓取的 html 页面格式不正确。文档类型声明必须是文档的第一行。您可以尝试在使用`loadHTML()`.

# java - Tomcat 6 通过 JDBC Driver Manager 运行 mysql 准备好的语句（低于 10 秒）时没有得到任何响应

> ID：10524310
> 
> 赞同：1
> 
> 时间：2012-05-09T21:25:11.020
> 
> 标签：java, mysql, windows, tomcat, jdbc

我对现有的基于 servlet 的应用程序（一个有点旧的应用程序）有一个奇怪的问题。

我无法让任何 servlet 完成操作，如果它有一个运行速度低于 10 秒的 mysql 准备语句（我在这个应用程序中只有准备语句）。

我没有更快的查询（少于 10 秒）的问题。

catelina.out 没有任何痕迹，也没有浏览器界面。当我通过提琴手检查浏览器请求时，它显示

> “此会话尚未完成。会话完成时按 F5 刷新以获取更新的统计信息。请求计数：1 发送的字节：
> 437（标头：437；正文：0）接收的字节：0（标头：0；正文：0） "

MySQL“SHOW FULL PROCESSLIST”命令显示特定套接字连接（慢查询）在 COMMAND="Execute" 和 STATE="Sending Data" 下运行约 12 秒，然后更改为 COMMAND="Sleep" 和 STATE=""并保持这种状态很长时间（超过 500 秒）。理想情况下，此连接不应作为 SLEEP 保持如此长时间，而是在完成发送数据后关闭。

netstat -ab 命令显示与tomcat6.exe 和mysqld.exe 下的ESTABLISHED 相同的连接。理想情况下，一旦查询执行完成，这应该保持为 TIME_WAIT，直到“TcpTimedWaitDelay”值。

此查询的预期负载非常小（大约 2kbytes）。

MySQL connect_timeout=100 和 Tomcat connectionTimeout="100000"（对于我正在运行应用程序的端口 8000）。

我没有尝试更改的一件事是 JDBC DriverManager.setLoginTimeout 属性，因为它只在获得连接之前才受到关注。

这个应用程序运行良好，直到几天前。但我没有关于那几天查询执行时间的任何统计数据。

我正在运行 Windows 2008 R2 标准版、tomcat 6 和 MySQL 5.5。

我无法将这种行为归咎于任何原因。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T11:42:33.193

这似乎是与 MySQL 连接器相关的问题。我们使用的是旧的连接器（版本 3.1.x）。最新的稳定版本（5.1.20）修复了这个问题。

# iphone - 在 xcode 中以 iPad/iPhone 的形式打开网站

> ID：10524314
> 
> 赞同：0
> 
> 时间：2012-05-09T21:25:28.120
> 
> 标签：iphone, xcode, ipad, mobile-website, m3u

我正在尝试解析流媒体视频网站，以便在 iPad/iPhone 应用程序中播放它们。例如，在 www.veetle.com 中，使用 iPad 或 iPhone 打开频道可以看到视频，因为此代码会找到可以播放的 .m3u（或 .m3u8）文件。但是从计算机浏览器打开，或者在 Xcode 中解析通道地址不会显示这个 .m3u 文件，它使用的是 flash。

我想要的是让这个 .m3u 文件能够播放频道，我一直在网上搜索如何在 Xcode 中将网站作为移动设备打开，但我没有找到任何东西。任何想法？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:53:05.040

您需要在请求中更改所谓的[用户代理](https://en.wikipedia.org/wiki/User_agent)字符串。

请参阅此处：[更改 NSURLConnection 的 userAgent](https://stackoverflow.com/questions/1532206/changing-the-useragent-of-nsurlconnection) 和此处：[什么是 iOS 5.0 用户代理字符串？](https://stackoverflow.com/questions/7825873/what-is-the-ios-5-0-user-agent-string)

safari 的开发人员工具还提供了快速更改用户代理的能力，如果您只想快速检查一个站点，这很好：http: [//designshack.net/articles/developer-tools-in-safari/](http://designshack.net/articles/developer-tools-in-safari/)

例如，使用它来查看您当前的用户代理：[https ://duckduckgo.com/?q=user+agent+](https://duckduckgo.com/?q=user+agent+)

# atg - 如何通过 AJAX 直接调用 FormHandler

> ID：10524315
> 
> 赞同：0
> 
> 时间：2012-05-09T21:25:29.880
> 
> 标签：atg

我们可以通过 AJAX 调用 ATG FormHandler 吗？我有希望吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-13T13:49:25.733

一般来说：是的:-)

但是可能性可能是有限的，或者需要一些奇怪的黑客来让它们运行，所以它可能取决于你到底想做什么。

有几种不同的方法：

您不能直接将请求发送到表单处理程序，就像您可以在 Struts 或 Spring MVC 等框架中使用 servlet 或控制器一样，但您始终必须在 JSP 页面中有一个表单（使用 DSP taglib 创建），然后提交该表格。这意味着如果您的 JSP 页面中没有相应的表单，您将无法触发表单处理程序。但是，如果您的页面中有该表单，您可以通过 AJAX 请求提交它。然后，您的 AJAX 请求将触发表单处理程序并以与正常表单提交相同的方式获取结果。这种方法是可能的并且通常有效。如果您不想让 AJAX 请求的表单在页面中可见，您可以隐藏它，例如使用 CSS。

另一种方法是使用 ATG 的 REST Web 服务模块，它允许您将任何组件公开为 RESTful Web 服务。这还允许您调用表单处理程序，而无需为它们提供表单或首先呈现 JSP 页面。标题为“ATG Web 服务和集成框架指南”的文档（来自 Oracle 的 ATG 文档）有一整章介绍了如何将表单处理程序作为 REST Web 服务调用。

或者您可以编写一个小的自定义 servlet 来接收您的 AJAX 请求，然后使用接收到的数据来调用表单处理程序，就像它会查找和调用任何其他 Nucleus 组件一样......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T15:59:07.177

是的，在您发出 ajax 请求的页面中调用 handle 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-09T15:47:08.603

我已经使用 API 完成了这项工作。

您需要使用 API 填充所需的表单数据，然后从 API 调用 handle 方法。如果需要，您可以使用 ATG 的 REST API 或 Spring。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-16T08:23:11.377

只需制作一个简单的 JSP 不需要复杂的代码来调用句柄方法，创建一个 JSP 并添加 dsp:setvalue 标记和 bean 属性应该指向您的句柄方法，现在通过简单的 ajax 调用这个 JSP

```
<dsp:setvalue bean="TestFormahandler.submit" value="" /> 
```

这将调用 formhandler 的 handleSubmit

总有一个希望的朋友:)

# c# - Nhibernate 3.3 懒加载一对一关联

> ID：10524316
> 
> 赞同：0
> 
> 时间：2012-05-09T21:25:31.923
> 
> 标签：c#, nhibernate, fluent-nhibernate

我在 3.3 版的 NHibernate 更改日志中读到，您现在可以延迟加载一对一的关联，这在以前是不可能的，我尝试在我的关联上设置延迟，但它仍然会变得渴望加载，映射将如何对于延迟加载的一对一关联？我正在使用fluentNhibernate。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T11:11:25.390

由于只有在保证有可用目标的情况下才能生成代理（因为 NHibernate 在加载时不能用 null 替换代理），所以 NHibernate 需要知道您的一对一关联在数据库中受到约束。这是通过标签`constrained`上的属性完成的。`<one-to-one>`

# ios - iOS 离线 MapKit 解决方案

> ID：10524317
> 
> 赞同：12
> 
> 时间：2012-05-09T21:25:35.073
> 
> 标签：ios, ipad, mapkit, offline

给你一个快速的问题。我正在开发一个需要使用地图的应用程序，但没有网络连接。我看到其他人对此提出了类似的问题，但我的要求略有不同，所以我想发布一个新问题。

这是我对应用程序的要求。

1.  允许对带有可定义注释的地图进行捏合/缩放
2.  地图必须离线可用
3.  地图应限制在某个地理区域
4.  应用程序不必通过苹果检查。这是一个将用作信息亭的企业应用程序。

那么，是否有任何人可以建议的缓存地图图块的框架或方法？

谢谢提前出去。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-08-27T09:01:33.810

我使用 MapKit 的默认地图和 MKTileOverlay 的子类来保存下载的切片并返回已缓存的切片而不下载它们。

1）从 MapKit 更改默认地图的源并使用 MKTileOverlay 的子类（此处使用“开放街道地图”）

```
- (void)viewDidLoad{
    [super viewDidLoad];
    static NSString * const template = @"http://tile.openstreetmap.org/{z}/{x}/{y}.png";

    VHTileOverlay *overlay = [[VHTileOverlay alloc] initWithURLTemplate:template];
    overlay.canReplaceMapContent = YES;
    [self.mapView addOverlay:overlay level:MKOverlayLevelAboveLabels];
} 
```

2) MKTileOverlay 的子类

```
@interface VHTileOverlay() // MKTileOverlay subclass
@property (nonatomic, strong) NSOperationQueue *operationQueue;
@end

@implementation VHTileOverlay

-(instancetype)initWithURLTemplate:(NSString *)URLTemplate{

    self = [super initWithURLTemplate:URLTemplate];
    if(self){
        self.directoryPath = cachePath;
        self.operationQueue = [NSOperationQueue new];
    }
    return self;
}

-(NSURL *)URLForTilePath:(MKTileOverlayPath)path {
    return [NSURL URLWithString:[NSString stringWithFormat:@"http://tile.openstreetmap.org/%ld/%ld/%ld.png", (long)path.z, (long)path.x, (long)path.y]];
}

-(void)loadTileAtPath:(MKTileOverlayPath)path
                result:(void (^)(NSData *data, NSError *error))result
{
    if (!result) {
        return;
    }

    NSString *pathToFilfe = [[self URLForTilePath:path] absoluteString];
    pathToFilfe = [pathToFilfe stringByReplacingOccurrencesOfString:@"/" withString:@"|"];
    // @"/" - those are not approriate for file's url...

    NSData *cachedData = [self loadFileWithName:pathToFilfe]; 
    if (cachedData) {
        result(cachedData, nil);
    } else {
        NSURLRequest *request = [NSURLRequest requestWithURL:[self URLForTilePath:path]];
        __block VHTileOverlay *weakSelf = self;
        [NSURLConnection sendAsynchronousRequest:request
                                           queue:self.operationQueue
                               completionHandler:^(NSURLResponse *response, NSData *data, NSError *connectionError) {
                                   NSLog(@"%@",[weakSelf URLForTilePath:path]);

                                   if(data){
                                       [self saveFileWithName:[[weakSelf URLForTilePath:path] absoluteString] imageData:data];
                                   }
                                   result(data, connectionError);
        }];
    }
}

-(NSString *)pathToImageWithName:(NSString *)fileName
{
    NSString *imageFilePath = [[OfflineMapCache sharedObject].cachePath stringByAppendingPathComponent:fileName];
    return imageFilePath;
}

- (NSData *)loadFileWithName:(NSString *)fileName
{
    NSString *imagePath = [self pathToImageWithName:fileName];
    NSData *data = [[NSData alloc] initWithContentsOfFile:imagePath];
    return data;
}

- (void)saveFileWithName:(NSString *)fileName imageData:(NSData *)imageData
{
//    fileName = [fileName stringByReplacingOccurrencesOfString:@"/" withString:@"|"];
//    NSString *imagePath = [self pathToImageWithName:fileName];
//    [imageData writeToFile:imagePath atomically:YES];
} 
```

取消注释“saveFileWithName”并在模拟器上运行它。您还可以添加 NSLog(fileName) 以了解从何处获取所需的所有图块。（模拟器缓存在Users/YOU/Library/Developer/CoreSimulator/Devices/...而Library是一个隐藏目录）

缓存所有内容后，您只需将其放入应用程序的包中（就像任何其他图像一样，如果您想从盒子缓存地图中获取）。并告诉你

```
- (void)loadTileAtPath:(MKTileOverlayPath)path
                result:(void (^)(NSData *data, NSError *error))result 
```

从捆绑中获取瓷砖。

所以现在我可以安装我的应用程序，关闭 wi-fi，无论如何我都会得到这些地图。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T14:02:03.040

尝试使用[http://mapbox.com/](http://mapbox.com/)，它有一个 iOS SDK 和一个用于构建离线地图的应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T21:31:21.010

[查看Google Maps 服务条款的](https://developers.google.com/maps/iphone/terms)第 10.3 节，您会发现您无权存储任何 Google Maps 内容。这意味着您不仅需要提供自己的地图，还需要替换方便的 MapKit 功能。据我所知，你真的不能将 MapKit 用于离线应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-21T12:01:37.837

请参阅[skobbler/Telenav SDK](http://developer.skobbler.com/features) - 它基于 OpenStreetMap，是 mapkit（地图渲染、路由和转弯导航）的（几乎）全栈替代品，集成了对离线地图的支持

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-03T09:58:24.790

不幸的是 MapKit 框架不支持离线地图访问。你应该更喜欢 MapBox iOS SDK（MapBox iOS SDK 是一个用于构建地图应用程序的工具集，它支持离线缓存策略、缩放限制、视网膜显示行为、起始坐标和地图视图拖动减速等......

[找到示例链接](https://github.com/route-me/route-me)

快乐编码

# iphone - 将图像转换为base64并以JSON格式上传到服务器

> ID：10524323
> 
> 赞同：1
> 
> 时间：2012-05-09T21:26:02.127
> 
> 标签：iphone, objective-c, ipad, base64, nsurlrequest

我有个问题。我需要将 base64 字符串转换为 JSON 字符串并将其传递给服务器。例如我有一个 base64 字符串`/9j/4AAQSkZJRgABAQAAAQABAAD/4QBYRXhpZgAATU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAACqADAAQAAAABAAAACgAAAAD/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/Z`

我需要将其转换为 JSON 格式。我执行以下操作：

```
+(NSData *)prepareForUploading:(NSString *)base64Str
{
    NSDictionary *dict=[NSDictionary dictionaryWithObjects:[NSArray arrayWithObjects:base64str, nil] forKeys:[NSArray arrayWithObjects:@"picture", nil]];

    NSData *preparedData=[NSJSONSerialization dataWithJSONObject:dict options:NSJSONWritingPrettyPrinted error:nil];    
    return preparedData;
}; 
```

这里我是怎么做的`NSURLRequest`

```
-(NSString *)uploadPict:(NSString *)pict
{
    NSLog(@"Server: upload: called");
    NSData *prepPictData=[[self class] prepareForUploading:pict];
    NSString *preparedBase64StrInJSON=[[NSString alloc] initWithData:prepPictData encoding:NSUTF8StringEncoding];

    //here I'm adding access token to request
    NSString *post = [NSString stringWithFormat:@"accessToken=%@&object=%@", self.key, preparedBase64StrInJSON];
    NSData *postData = [post dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];
    NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];

    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
    [request setURL:[NSURL URLWithString:[NSString stringWithFormat:@"%@upload.aspx", serverAPIPath]]];
    [request setHTTPMethod:@"POST"];
    [request setValue:@"postLength" forHTTPHeaderField:@"Content-Length"];
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
    [request setHTTPBody:postData];    

    NSURLResponse *response;
    NSError *error;
    NSData *urlData=[NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
    //....
} 
```

但是我从服务器收到“Base-64 字符数组的长度无效”。怎么了？如果我将令牌和 JSON 粘贴到[http://hurl.it/](http://hurl.it/)并使用它发出请求 - 一切正常。

我认为问题在于`/`base64 字符串中的符号以及 JSON 中的 / 符号。也许是这样的`[postData length]`：如果我从 JSON 字符串中删除`\/`字符： `9j4AAQSkZJRgABAQAAAQABAAD4QBYRXhpZgAATU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAACqADAAQAAAABAAAACgAAAAD2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQHZ`请求将正常执行，但这个 base64 编码的字符串不一样。

请帮我解决这个问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T13:22:37.327

jString 是您的 base64 字符串，首先使用以下行

`[self encodeString:jString]`;

然后调用使用以下。

```
NSString *URL = [NSString stringWithFormat:@"forms.asmx/CreateUpdate?"];

URL=[NSString stringWithFormat:@"%@%@", USERS_API_ROOT_URL, URL];
NSString *post = [NSString stringWithFormat:@"apiKey=A0B1I2L3A4L5-A1D3-4F30-5AB2-C8DEE266&strPost=%@",jString];

unsigned long long postLength = [post length];
NSString *contentLength = [NSString stringWithFormat:@"%llu",postLength];

NSData *postData = [post dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];

NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init] ;
[request setURL:[NSURL URLWithString:URL]];
[request setHTTPMethod:@"POST"];
[request setValue:contentLength forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
[request setHTTPBody:postData ];

(void)[[NSURLConnection alloc] initWithRequest:request  delegate:self];

-(NSString *)encodeString:(NSString *)string
{
    NSString *newString = (__bridge_transfer NSString*)CFURLCreateStringByAddingPercentEscapes(kCFAllocatorDefault, (CFStringRef)string, NULL,CFSTR(":/?#[]@!$ &'()*+,;=\"<>%{}|\\^~`"), CFStringConvertNSStringEncodingToEncoding(NSUTF8StringEncoding));
    return newString;
} 
```

希望它会奏效。

# css - 将 !important 应用于具有多个选项的字体系列

> ID：10524324
> 
> 赞同：15
> 
> 时间：2012-05-09T21:26:07.323
> 
> 标签：css

如何将 !important 应用于以下样式：

```
font-family: "Trebuchet MS" , Verdana, Helvetica, Sans-Serif; 
```

我试过这个，但不起作用：

```
font-family: "Trebuchet MS" , Verdana, Helvetica, Sans-Serif !important; 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-10-15T22:43:21.997

使用通配符 (*) 在父容器中选择子容器：

```
div * {font-family: "Trebuchet MS" , Verdana, Helvetica, Sans-Serif !important; } 
```

[http://jsfiddle.net/4d3K4/50/](http://jsfiddle.net/4d3K4/50/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-09T21:37:57.243

代码很好。它会根据您将属性赋予的元素而有所不同。最好使用特定的选择器，例如类：

[http://jsfiddle.net/4d3K4/](http://jsfiddle.net/4d3K4/)

# c# - 将多个对象插入 MySQL

> ID：10524326
> 
> 赞同：0
> 
> 时间：2012-05-09T21:26:14.787
> 
> 标签：c#, mysql

除了此处显示的方式之外，还有其他方法可以将多个对象插入 MySQL 数据库。这可行，但需要时间来执行。

```
 using (MySql.Data.MySqlClient.MySqlConnection conn = new MySql.Data.MySqlClient.MySqlConnection(connStr))
        {
            //Goes thrue the List<object>
            foreach(List<object> sub in listSubject)
            {
            MySql.Data.MySqlClient.MySqlCommand cmd = new MySql.Data.MySqlClient.MySqlCommand();
            cmd.Connection = conn;
            cmd.CommandText = "CALL stp_InsertSubject(@param_SubjectId, @param_ProjectId, @param_Used);";
            cmd.Parameters.AddWithValue("@param_SubjectId",Convert.ToInt32(sub[0]) );
            cmd.Parameters.AddWithValue("@param_ProjectId", Convert.ToInt32(sub[1]));
            cmd.Parameters.AddWithValue("@param_Used", Convert.ToBoolean(sub[2]) );

            conn.Open();

            cmd.ExecuteNonQuery();

            conn.Close();
                } 
```

我的存储过程：

```
CREATE DEFINER=`mortenstarck`@`%` PROCEDURE `stp_InsertSubject`(param_SubjectId int(45), param_ProjectId int(45), param_Used tinyint(1)) 
```

开始插入`Subject_has_Projects`( `Subject_Id`, `Projects_Id`, `Used`) 值 (param_SubjectId, param_ProjectId, param_Used); 结尾

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:37:02.447

有几点需要改进：

*   在循环外只打开一次连接（无需关闭使用）
*   创建命令，在循环前一次分配连接
*   使用虚拟值在循环之前创建所有参数
*   仅分配循环内的值并调用 ExecuteScalar()

```

`using(MySql.Data.MySqlClient.MySqlConnection conn = new MySql.Data.MySqlClient.MySqlConnection(connStr))
{  
    conn.Open(); 
    MySql.Data.MySqlClient.MySqlCommand cmd = new MySql.Data.MySqlClient.MySqlCommand();   
    cmd.Connection = conn;   
    cmd.CommandText = "CALL stp_InsertSubject(@param_SubjectId, @param_ProjectId, @param_Used);";  
    cmd.Parameters.AddWithValue("@param_SubjectId",0 );   
    cmd.Parameters.AddWithValue("@param_ProjectId", 0);   
    cmd.Parameters.AddWithValue("@param_Used", false );   
    foreach(List<object> sub in listSubject)   
    {   
        cmd.Parameters["@param_SubjectId"].Value = Convert.ToInt32(sub[0]) ;   
        cmd.Parameters["@param_ProjectId"].Value = Convert.ToInt32(sub[1]);   
        cmd.Parameters["@param_Used"].Value = Convert.ToBoolean(sub[2]);   
        Id = (Int64)cmd.ExecuteScalar();   
    }   
}` 

            回答 #2

赞同：1

时间：2012-05-09T21:35:30.090

你可以试试。打开连接`foreach`外环。这将节省每次循环打开和关闭连接的时间。这将提高性能。

```
Int64 Id = 0;
using (MySql.Data.MySqlClient.MySqlConnection conn = new MySql.Data.MySqlClient.MySqlConnection(connStr))
{
    //Goes through the List<object>
    conn.Open();
    foreach(List<object> sub in listSubject)
    {
        MySql.Data.MySqlClient.MySqlCommand cmd = new MySql.Data.MySqlClient.MySqlCommand();
        cmd.Connection = conn;
        cmd.CommandText = "CALL stp_InsertSubject(@param_SubjectId, @param_ProjectId, @param_Used);";
        cmd.Parameters.AddWithValue("@param_SubjectId",Convert.ToInt32(sub[0]) );
        cmd.Parameters.AddWithValue("@param_ProjectId", Convert.ToInt32(sub[1]));
        cmd.Parameters.AddWithValue("@param_Used", Convert.ToBoolean(sub[2]) );
        Id = (Int64)cmd.ExecuteScalar();
    }
     conn.Close();
} 
```

[多次打开和关闭 SQL 连接有多糟糕？确切的效果是什么？](https://stackoverflow.com/questions/1404261/how-bad-is-opening-and-closing-a-sql-connection-for-several-times-what-is-the-e)

            回答 #3

赞同：0

时间：2012-05-09T21:31:41.257

您是否考虑过通过单个事务处理这些调用？

```

# php - 带多行字符串的 Aptana 代码格式？

> ID：10524327
> 
> 赞同：0
> 
> 时间：2012-05-09T21:26:18.613
> 
> 标签：php, eclipse, ide, aptana

是否可以让 Aptana Studio 3 在自动格式化代码时保持标签？现在，它只是删除了我在多行字符串上的所有选项卡，这在处理长查询等时真的很烦人。但是，据我所知，没有任何使用字符串格式化代码的选项。另外，我不想在我的代码中添加额外的注释，这样 Aptana 就不会破坏它——这太草率了。

任何帮助将不胜感激！谢谢！

**编辑**- 进一步的测试证实，这只发生在 PHP 与 HTML 混合时，而不是 PHP 代码独立时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:49:54.167

我不能保证这个功能对你有用，但你可以试试菜单：

> Mac：Aptana Studio 3 => 偏好 => Aptana Studio/Editors/Formatter
> 
> Windows：Window => Preference => Aptana/Editors/Formatter

有格式代码的设置，选择PHP并自定义您自己的。

# sockets - 写入套接字

> ID：10524336
> 
> 赞同：0
> 
> 时间：2012-05-09T21:27:13.997
> 
> 标签：sockets, node.js, chat

当用户尝试向服务器写入任何内容时，我无法理解错误的原因：

```
TypeError: Object #<identifyClient> has no method 'write'
at writeToAll (/root/node/mud/server.js:13:15) 
```

为什么 identifyClient() 抱怨 write()，而它发生在 writeToAll() 中（第 15 行旁边有注释）？identifyClient() 实际上只设置客户端的名称，不应该关心 writeToAll() 中发生的情况。

```
var net = require("net");

var clients = [];

function identifyClient(client) {
    this.name = null;
    this.client = client;
}

function writeToAll(data, client) {
    for (var i = 0; i < clients.length; i++) {
        if (clients[i] != client) {
            clients[i].write(data); // This is line 15
        }
    }
}

var server = net.createServer(function(client) {
    var clientID = new identifyClient(client);
    clients.push(clientID);

    client.on("data", function(data) {
        writeToAll(data, client);
    });
});

server.listen(4444); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:34:56.770

替换`clients[i]`为`clients[i].client`

`clients`一旦断开连接，您还必须从阵列中删除客户端。

# ruby-on-rails - 未调用嵌套属性验证

> ID：10524337
> 
> 赞同：0
> 
> 时间：2012-05-09T21:27:21.283
> 
> 标签：ruby-on-rails, validation, activerecord, ruby-on-rails-3.2

我已经为此苦苦挣扎了一段时间。我只是想获得嵌套属性以在 Rails 3.2 上进行验证，但没有运气。就好像它完全忽略了对嵌套属性的验证。下面是一个无效的示例验证：

```
class Invoice < ActiveRecord::Base
  validates :description, :presence => true
  belongs_to  :client_branch
  has_many    :invoice_items

  accepts_nested_attributes_for :invoice_items, :allow_destroy => true
end

class InvoiceItem < ActiveRecord::Base
  belongs_to  :invoice
  validate :thisisatest

  def thisisatest
    errors.add(:qty, 'QTY NOT VALIDATING TEST.')
  end
end 
```

当保存带有一些 InvoiceItems 的 Invoice 时，它​​会成功保存它，即使自定义验证显然会为 :qty 属性添加错误。有什么我应该添加到我的模型中以使嵌套验证工作的东西，还是我可能遗漏了其他东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:58:10.270

其实，我是个傻子。我更改了模型名称以及对它的所有引用，我花了这么长时间才错过仍然指向 javascript 中旧模型的引用。因此，动态添加的项目未正确命名，导致验证未触发。：/

# android - Android Geocoder 不检测高速公路/州际公路？

> ID：10524341
> 
> 赞同：3
> 
> 时间：2012-05-09T21:27:52.237
> 
> 标签：android, google-maps

我正在使用 getThoroughwayfare() 来获取街道名称，但是当在高速公路/州际公路上时，该方法返回 null。我找不到另一种可以检测州际公路的方法。有没有人能够成功检测到州际公路？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-01T06:35:47.043

好的，这是一个很老的问题，但我想我为别人回答。

我也需要了解我是否在州际公路上，而地理编码器也无济于事。所以我遇到了`Google geocode api`它提供了大量信息。

例如

纬度：39.249121,-122.182131

而网址将是：

[https://maps.googleapis.com/maps/api/geocode/json?latlng=39.249121,-122.182131&sensor=false](https://maps.googleapis.com/maps/api/geocode/json?latlng=39.249121,-122.182131&sensor=false)

如果您从手机发送，则传感器为真，如果使用浏览器，则为假。

现在您可以打开链接并自己查看详细回复，在这些`json`对象中，您将获得一个`type = route`并且您将获得您**`I-5`**所在`short_name`的道路。

# spring - Spring Data JPA，Spring 3.1.1，无 xml 配置，不创建存储库 bean

> ID：10524343
> 
> 赞同：1
> 
> 时间：2012-05-09T21:28:11.767
> 
> 标签：spring, jpa, spring-3, servlet-3.0, spring-data-jpa

尝试使用**[Spring Data JPA](http://static.springsource.org/spring-data/data-jpa/docs/current/reference/html/)**[使用<repositories />](http://static.springsource.org/spring-data/data-jpa/docs/current/reference/html/#namespace-dao-config)自动生成 DAO 对象，其中 base-package 链接包含 DAO 接口的包，例如：

```
public interface UserDAO extends JpaRepository<User, String> {
} 
```

但它无法在服务 bean 中连接 DAO 对象，确切的错误是：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'ACLService': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private pkg.service.UserServ pkg.service.ACLServ.userServ; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'userServ': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private pkg.repositories.UserDAO pkg.service.UserServ.userDAO; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No matching bean of type [pkg.repositories.UserDAO] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: {@org.springframework.beans.factory.annotation.Autowired(required=true)}
at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
at pkg.config.WebAppInit.onStartup(WebAppInit.java:35) 
```

应用程序引导从**WebAppInit.Java**开始，因为它实现了 WebApplicationInitializer 接口，web.xml 代码为：

```
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" version="3.0"></web-app> 
```

**WebAppInit.Java**将onStartup 方法编码为：

```
public class WebAppInit implements WebApplicationInitializer {
public void onStartup(ServletContext container) throws ServletException {
    AnnotationConfigWebApplicationContext context  = 
        new AnnotationConfigWebApplicationContext();
    context.register(ApplicationContextConfig.class);
    context.refresh();
    ... 
```

然后**ApplicationContextConfig**类用@Configuration注解，代码为：

```
@Configuration
@PropertySource("classpath:application.properties")
@ImportResource("classpath:*springDataConfig.xml")
@Import({BasicDataSourceConfig.class,PersistenceSpringDataJpaConfig.class})
@ComponentScan(basePackages={"pkg.service","pkg.utils"})
public class ApplicationContextConfig {
} 
```

所以这只是Java配置的主要/入口点，然后它遵循*application.properties*（不包括但只是要求它），然后是带有代码的**springDataConfig.xml ：**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns="http://www.springframework.org/schema/data/jpa"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/data/jpa
    http://www.springframework.org/schema/data/jpa/spring-jpa.xsd">

  <repositories base-package="pkg.repositories" />

</beans:beans> 
```

BasicDataSourceConfig.Java将DataSource **@Bean**配置为：

```
@Bean
public DataSource dataSource() {
    BasicDataSource dataSource = new BasicDataSource();
    ... 
```

**PersistenceSpringDataJpaConfig.Java**将*LocalContainerEntityManagerFactoryBean*配置为：

```
@Configuration
public class PersistenceSpringDataJpaConfig {
    ...

    @Autowired
    DataSource dataSource;

    @Bean
    public LocalContainerEntityManagerFactoryBean entityManagerFactoryBean(){
        LocalContainerEntityManagerFactoryBean entityManagerFactoryBean = new LocalContainerEntityManagerFactoryBean();
    ... 
```

如果我切断了删除/注释代码的依赖项，则其他文件没有直接关系：

```
@Autorire 
private UserDAO userDAO 
```

在 UserService 类中；应用程序运行没有错误，我的意思是在访问服务 bean 中的 dao 对象时出现空指针异常。

所以问题是：***为什么 Spring Data JPA 不创建 userDAO bean？***

PS：我确实故意摆脱了所有@Transactions 管理以简化它，除了它应该在没有事务的情况下工作，不是吗？

# git - 由于需要快进合并提交而复杂化了两个非常不同的分支的合并

> ID：10524349
> 
> 赞同：3
> 
> 时间：2012-05-09T21:28:46.667
> 
> 标签：git, git-branch, branching-and-merging, git-merge, git-rebase

我有麻烦。有树枝`master`和`feature`. 一百年前`master`，`feature`有共同的祖先，但从那时起已经过去了 100500 次提交。`master`和`feature`分支现在非常不同。好的。我花了一整天的时间，终于完成了这个 %#$%# 合并。但是...在一天结束时，我打算将此结果推送到存储库，并注意到我的队友在“主”分支中进行了大约 5 次新提交... $#%#$ 这对我们很重要做**rebase**以在此提交之前快进我的合并。所以我需要将这 5 个提交合并到我的合并结果中。我已经`E`在我的本地仓库上提交（查看方案），这是合并`master`到的结果`feature`. 由于 C1, ... C5 - 远程上的新提交，我无法将其推送到服务器上`feature`。当我在远程有新东西时，当我已经做出改变时，我的标准做法是`git pull --rebase`保持一个分支的历史线性。我跑`git pull --rebase`了，实际上从 git 那里得到了重新合并的建议。在 C1,...C5 提交中甚至未触及的文件中再次存在很多冲突。我做错了什么？请帮忙。如何获得结果，我已经淹没在第二个计划中？我疯了吗？有可能做吗？

```
Now:

o--A--o-----...100500 commits....[master]....--o-----------B
       \                                                    \ 
        o---...100500 commits....[feature - local repo]...C--E(local repo - epic merge result)
        |                                    
        o---...100500 commits....[feature - remote repo]..C--C1--C2--C3--C4--C5(remote repo, feature branch - additional 5 commits)

Need to fast-forward E ahead C1, C2,... C5, that were added on remote when I was busy with merge:

o--A--o-----...100500 commits....[master]....--o-----------------------B
       \                                                                \ 
        o---...100500 commits....[feature]...--o--C--C1--C2--C3--C4--C5--E(epic merge result) 
```

**更新**
当我在做`git pull --rebase`（留在`feature`分支上）时，我注意到 git 试图首先放在 C1、..、C5 （提交到`feature`分支的远程）之上，然后是第二个，然后是其他 100500 个`master`分支提交。这不是我想要的。我只`E`需要在 C1、..C5 之上提交，但不是所有`master`分支的提交。我看到这种行为，当我查看`gitk --all`between `git rebase --continue`， get 冲突，`git mergetool`循环时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:34:59.823

通过合并获取您的历史记录，并在此基础上重新调整 5 个新提交。是的，这不是您要求的，但请耐心等待。

解决出现的任何合并冲突。这应该很简单，因为您只处理 5 个新提交。

现在你有一个结果树，这正是你想要的。在这里放一个标签，然后扔掉一切重新开始。

重新执行合并，这次包括您要合并的分支中的 5 个新提交。但`-s ours`作为策略选项传递并`--no-commit`避免实际执行提交。

现在从您之前的合并+变基中读取树。这应该很简单`git checkout $tag -- .`（`$tag`您在之前的结果中放置的标签在哪里）。

现在运行`git commit`。这将提交您的合并、您想要的历史记录以及您之前工作生成的树。

如果这看起来不错，请继续推送它并删除您的标签。

# java - 需要更好的模板语言

> ID：10524352
> 
> 赞同：8
> 
> 时间：2012-05-09T21:28:52.797
> 
> 标签：java, templates, velocity, freemarker, stringtemplate

是的，我知道[以前](https://stackoverflow.com/questions/29516/template-engines-for-spring-framework)[有人](https://stackoverflow.com/questions/2613404/template-engine-recommendations)[问](https://stackoverflow.com/questions/2381619/best-template-engine-in-java)[过](https://stackoverflow.com/questions/174204/suggestions-for-a-java-based-templating-engine)[这个](https://stackoverflow.com/questions/3793880/lightweight-template-engine-in-java) 问题。但大多数问题都是两年前的问题，今天必须有更好的答案。

我需要一种模板语言来呈现 HTML。要求：

1.  必须可以从 Java 调用。

2.  不能是 Freemarker、Velocity 或 StringTemplate。我们已经使用 Freemarker 一年了，它太慢了。它在负载下消耗了我们 50% 的 CPU 周期。Velocity 比 Freemarker 差，StringTemplate 也有自己的问题。

3.  它必须使用 JSON 或其 Java 等价物，即 Maps、Lists 和原语。

我开始嫉妒 Node.js。去年有大量的 Javascript 模板活动，但 Java 很少（据我所知）。

理想的语言应该是[Liquid](http://liquidmarkup.org/)，它只存在于 Rails 中。

[Jade](http://jade-lang.com/)存在于 Java 中，但我不希望它附带的所有 HTML 重新格式化。

**更新**

我最终选择了[Handlebars](http://handlebarsjs.com/)，它也[可用于 Java](https://github.com/jknack/handlebars.java)。两者都工作得很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-06T01:14:40.770

[块](http://www.x5software.com/chunk/)是 json 友好的。JSON 可用作控制器代码或模板本身中的标记值，用于执行/宏调用。

```
{% exec %}
  {% data @json %}
    { name: "whatever",
      vitals: ["an","array","of","data"],
      friends: [{name: "bob"},{name: "crystal"}]
    }
  {% enddata %}

  <div>Name: {$name}</div>

  {% if ($friends) %}
    <div>Friends:

      <ul>
      {% loop in $friends as $friend %}
        <li>{$friend.name}</li>
      {% endloop %}
      </ul>

    </div>
  {% endif %}

{% endexec %} 
```

或者，只需使用内部模板并从 java 端注入 json。

src/themes/example.chtml

```
 <div>Name: {$name}</div>

  {% if ($friends) %}
  <div>Friends:

    <ul>
    {% loop in $friends as $friend %}
     <li>{$friend.name}</li>
    {% endloop %}
    </ul>

  </div>
  {% endif %} 
```

MyController.java

```
Theme theme = new Theme();
Chunk html = theme.makeChunk("example");

html.set("name", "whatever");
html.set("vitals", getJsonArray() );
html.set("friends", getJsonFriendObjects() );

html.render( out ); 
```

只要 getJsonXXX() 方法返回实现 List 和 Map 的内容，Chunk 就会正确地将其粘贴到模板中（即使这些 List 和 Map 嵌套了更多 List 和 Map）。

输出：

```
<div>Name: whatever</div>

<div>Friends:

  <ul>
   <li>bob</li>
   <li>crystal</li>
  </ul>

</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:38:44.003

[Java+](http://virtualschool.edu/java+/syntax.html)是一个简单的预处理器解决方案。它只是对标记进行字符串化：

```
System.out.println({{
 <html>
  <body>
   ...
  </body>
</html>}}) 
```

它具有可配置的分隔符并通过 Java 代码而不是使用它：

```
System.out.println({{
<xmlExample>
  <name>{{fpp}}</name>
  <number>{{bar}}</number>
</xmlExample>
}}); 
```

**参考**

*   [Java+ 预处理器 2.0 版：语法](http://www.virtualschool.edu/java+/syntax.html)

# actionscript-3 - 链接到 AS3 中的 URL

> ID：10524353
> 
> 赞同：0
> 
> 时间：2012-05-09T21:28:55.117
> 
> 标签：actionscript-3, flash

我在 Flash 5.5 文件末尾有一个无效的 URL 链接。我在 AS3 中有以下代码。保存 SWF 时没有收到错误消息。

```
import flash.events.*;
import flash.display.*;
//import flash.ui.Keyboard;

var weblinkURL:String = "http://www.optiosolutions.com";

weblink_btn.addEventListener(MouseEvent.CLICK, webLink);

function webLink(e:Event):void {
  var request:URLRequest = new URLRequest(weblinkURL);
  try {
    navigateToURL(request, '_blank');
  } catch (e:Error) {
    trace("Error occurred!");
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:45:24.013

我将您的代码粘贴到了一个新的 Flash 项目中，并且可以正常工作！似乎没有什么问题......所以我建议你看看你的其他代码......

您确定按钮 ID`weblink_btn`是您认为的按钮的正确按钮 ID？

一个小提示：

```
import flash.events.*;
import flash.display.*; 
```

真的不需要使用 a 导入`*`，因为您正在处理 KeyFrame，这些导入可能会被忘记。一般来说，您永远不应该使用 导入`*`，而应该只导入需要的类。

# arrays - Magento 产品显示文本“数组”而不是多个值

> ID：10524354
> 
> 赞同：0
> 
> 时间：2012-05-09T21:28:57.430
> 
> 标签：arrays, magento, custom-attributes

在我的 Magento 产品页面上；当产品的一个自定义属性具有多个值时；它不显示值，而是显示文本“数组”。它适用于一个值。谢谢，-山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T02:05:08.430

您可以执行以下操作：

```
<?php
    foreach($_product->getMetal() as $name => $value): ?>
<?php echo $name;?> = <?php echo $value;?>
<?php
    endforeach; ?> 
```

Magento 利用了 PHP 神奇的 getter/setter 功能 (http://www.php.net/manual/en/language.oop5.overloading.php#object.get)。

您可以`vardump($_product)`查看可用属性（它们存储在产品的 _data 数组中）。然后要检索其中一个，您只需删除下划线并将每个单词的第一个字母更改为大写即可。

**编辑：**

如果上面的代码没有输出值，你可以这样做（它会告诉你如何获取值）：

```
<?php
    foreach($_product->getMetal() as $attribute): ?>
<?php var_dump($attribute); ?>
<?php
    endforeach; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:13:49.273

我在 Magento 论坛上找到了这个，它似乎有效：`getData('attribute_name')): ?>

getResource()->getAttribute('attribute_name')->getFrontend()->getValue($_product)) ?>

`

# php - 提交后在表单中回显

> ID：10524355
> 
> 赞同：0
> 
> 时间：2012-05-09T21:29:01.203
> 
> 标签：php, forms, echo

我有一个将信息发送到 mysql 数据库的表单。错误消息和确认显示在表单右侧的单独 div 中，因此表单操作需要将用户发送到同一页面。我正在回显用户输入的字段，以防他们需要根据出现的错误消息编辑某些内容。但是，如果表单提交正确，我怎样才能使 php 不在表单中回显？

```
<?php

$submit = filter_input(INPUT_POST, 'submit');
//form data
$fullname = filter_input(INPUT_POST, 'fullname');
$email = filter_input(INPUT_POST, 'email');
$business = filter_input(INPUT_POST, 'business');
$date = date("Y-m-d");

?> 
```

然后在其他html代码之后....

```
 <div class="wrap">
      <div id="reg">

  <form action='register.php' method='POST'>
<table>
    <tr>
        <td>
        Your full name:
        </td>
        <td>
        <input type='text' name='fullname' value='<?php echo $fullname;?>'>
        }
        </td>

    </tr>
    <tr>
        <td>
        Your email:
        </td>
        <td>
        <input type='text' name='email' value='<?php echo $email;?>'>
        </td>

    </tr>

    <tr>
        <td>
        Your business:
        </td>
        <td>
        <input type='text' name='business' value='<?php echo $business;?>'>
        </td>

    </tr>

 </table>
 </br>
 <input type='submit' name='submit' value='Register'>

</form>
 </br>       

    </div>
    <?php
 if ($submit)
  {
    //open database
  $connect=mysql_connect("localhost","root","Ryweb1994");
  mysql_select_db("phapsy");

  //check for existence
if($fullname&&$business&&$business)
{

   $queryreg = mysql_query("INSERT INTO users VALUES                           ('','$fullname','$email','$business','$date')");
    echo ("<div id='message'><p>You have been registered! We will send you an email            with login information. Thank you for your interest in Phapsy!<p></div>");

   }
else echo "Please fill in <b>all</b> fields!";

   }

  ?>
    </div>
  </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:33:09.610

`$submit`只需用变量包裹您的表单：

```
+ <?php if($submit) { ?>
 <div class="wrap">
  ... 
  <form action='register.php' method='POST'>
  ...
  </form>
</div>
+ <?php }; ?>

    <?php
 if ($submit)
  {
    //open database
  $connect=mysql_connect("localhost","root","Ryweb1994");
  mysql_select_db("phapsy");

  //check for existence
if($fullname&&$business&&$business)
{

   $queryreg = mysql_query("INSERT INTO users VALUES                           ('','$fullname','$email','$business','$date')");
    echo ("<div id='message'><p>You have been registered! We will send you an email            with login information. Thank you for your interest in Phapsy!<p></div>");

   }
else echo "Please fill in <b>all</b> fields!";

   }

  ?>
    </div>
  </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T21:37:07.557

既然您说您正在回显确认，那么您显然是在以某种方式测试是否成功输入 - 但您没有显示该代码。

所以像`<input type='text' name='fullname' value='<?php if(!$successful){echo $fullname;} ?>'>`会做的事情

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T21:43:54.597

将处理逻辑放在显示逻辑之前。

设置一个反映数据库交互是否成功的变量。

在整个表单中更新您的 echo 语句，以便仅在交互失败（或验证失败）时打印一个值：

```
<?php $successfullyProcessed = false;

//processing logic
$successfullyProcessed = true;

<input type='text' name='fullname' value='<?php if (!successfullyProcessed) echo $fullname;?>'> 
```

# iphone - 如果我将 UIImage 设置为背景视图，UITableViewCell 旋转滞后/挂起

> ID：10524357
> 
> 赞同：1
> 
> 时间：2012-05-09T21:29:06.227
> 
> 标签：iphone, ios, uitableview, uiimageview

我通过 UIImageView 设置 UIImage 作为子类 UITableViewCell 的背景视图，如下所示：

```
-(void)awakeFromNib {

UIImage *backImg = [[UIImage imageNamed:@"CellBackground"]  
                    resizableImageWithCapInsets:UIEdgeInsetsMake(16, 132, 16, 16)];
UIImageView *imv = [[UIImageView alloc] initWithImage:backImg];
self.backgroundView = imv;

} 
```

这非常有效，每个单元格的高度不同（通过 heightForRowAtIndexPath 暴露，它计算带有文本的 UILabel 的高度），并且背景图像根据我想要的单元格调整大小。

但是，当我旋转设备时，视图会在旋转过程中挂起，并且需要 5-10 秒才能在风景中重绘，或者崩溃而没有错误。如果我从背景视图中删除这个图像视图，旋转效果很好。模拟器和设备。

[编辑] 或者，我将 imageview 添加为 cell.contentView 的子视图 - 性能更好，但仍然滞后。

```
UIImage *backImg = [[UIImage imageNamed:@"CellBackground"]  
                    resizableImageWithCapInsets:UIEdgeInsetsMake(16, 132, 16, 16)];
UIImageView *imv = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
imv.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
imv.image = backImg;

[self.contentView addSubview:imv]; 
```

另外，如上所述，我的 UITableViewCell 是一个子类。上面的代码在 awakeFromNib 中，我正在加载我的 UITableViewCell，如下所示：

```
// within initWithNibName: of UIViewcontroller:

cellLoader = [UINib nibWithNibName:@"MasterTableViewCell" bundle:[NSBundle mainBundle]];

// and UITableView method:

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{   
    MasterTableViewCell *cell = (MasterTableViewCell *)[tableView dequeueReusableCellWithIdentifier:@"MasterTableViewCell"];
    if (cell == nil) {
        NSArray *topLevelItems = [cellLoader instantiateWithOwner:self options:nil];
        cell = [topLevelItems objectAtIndex:0];
    }
    return cell;
} 
```

难道我做错了什么？有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:45:13.653

每次绘制单元格时都调用它吗？这真的会损害你的表现。我建议只在绘制新单元格时这样做。所以它看起来像

```
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if(cell == nil) 
{
    UIImage *backImg = [[UIImage imageNamed:@"CellBackground"]  
                resizableImageWithCapInsets:UIEdgeInsetsMake(16, 132, 16, 16)];
    UIImageView *imv = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
    imv.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
    imv.image = backImg;

    [self.contentView addSubview:imv];
} 
```

# ios - 临时测试安装失败

> ID：10524362
> 
> 赞同：1
> 
> 时间：2012-05-09T21:29:55.443
> 
> 标签：ios, cocos2d-iphone, xcode4.3, box2d-iphone

我有一个项目，我可以使用开发人员/调试成功地构建/安装到设备或模拟器。

当我进行临时构建时，我可以在模拟器上构建运行，但不能在设备上运行。

我正在尝试执行直接安装，因为临时安装的应用程序在调试版本不存在的情况下崩溃（添加到数组中为零）。

我还尝试附加到正在运行的临时安装的应用程序。该应用程序将无限期运行（但如果我执行特定的用例会崩溃。）但如果我尝试附加到正在运行的应用程序，它会崩溃。

它恰好是一个 Box2d/Cocos2d 应用程序——但我没有任何理由认为它们是原因。Xcode 4.3.2，iPhone4 iOS 5.1

尝试构建并运行时的消息： `error: failed to launch '/Users/bshirley/Library/Developer/Xcode/DerivedData/foo-bar-evrbckppmbsspqhezhleaxkmymxn/Build/Products/Adhoc-iphoneos/foo-bar.app/foo-bar' -- failed to get the task for process 6892`

任何人都对问题有所了解或追踪它？

* * *

编辑，我想我会添加一些关键词，以便搜索更有可能找到：

诊断事后崩溃的一个问题是堆栈跟踪没有在 Xcode 的管理器的设备日志中符号化。这给我留下了 6 个以上的深度堆栈跟踪，其中包含我的代码，并且没有真正的理由来确定它的实际位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T14:53:07.697

如果 borrrden 是正确的（他似乎是合理的，将一个应用程序连接到已签名的运行应用程序将是一个安全问题），我无法主动调试临时应用程序。

我发现对追踪此问题最有用的是`Build Settings -> Symbols Hidden by Default`- 此值仅`NO`适用于`debug`. 将其设置为`NO`on允许我在 Xcode Organizer 中`adhoc`检查时查看整个堆栈跟踪。`Device Logs`

这使我想到了调用导致崩溃的问题的特定方法。这导致了一个问题，为什么它*没有*在调试版本中崩溃。没有时间诊断，只是解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T01:34:05.333

如果它是发布版本，应用程序将（在默认设置中）有一个标志，防止外部进程挂接到它（出于安全原因）。这包括调试器。如果您尝试，您将收到您指示的确切错误消息。

*编辑*对不起，小错误。单独的发布版本不会导致这种情况。带有临时证书的构建会导致这种情况，因为它旨在最终安装在设备上（而不是调试）。

# tsql - tsql 触发器行为异常

> ID：10524363
> 
> 赞同：1
> 
> 时间：2012-05-09T21:29:58.827
> 
> 标签：tsql, triggers

我有一个触发器，如下所示：

```
 ALTER TRIGGER [trigger_CATEGORY_VALUE_ID] ON [dbo].[tblA]
FOR UPDATE
AS
SET NOCOUNT ON
IF ( UPDATE([CATEGORY_VALUE_ID]))
BEGIN
  INSERT INTO [dbo].[htblB]
  ( ID
  , CATEGORY_VALUE_ID
  , STATUS_END_DATE
  , STATUS_END_DATE_SOURCE)
  SELECT
  t.ID
  , t.CATEGORY_VALUE_ID
  , GETDATE()
  , t.UPDATE_SOURCE
  FROM [dbo].[tblCAPITATION] t
  INNER JOIN inserted ins
  ON t.CATEGORY_VALUE_ID = ins.CATEGORY_VALUE_ID 
END 
```

它需要做的是在更新列 CATEGORY_VALUE_ID 时在 htblB 中插入一个新行。如果只更新一行，它工作正常。但如果它有多个行更新，则 2 的行数更新量的新行插入 htblB。

```
UPDATE dbo.tblCAPITATION
SET CAPITATION_STATUS_CATEGORY_VALUE_ID = '80574', UPDATE_SOURCE = 'TEST3'
WHERE CAPITATION_ID = 2 OR CAPITATION_ID = 3 
```

该语句将向 htblB 插入 4 个新行而不是 2 个。

能否请您解释一下为什么会出现这种情况以及如何预防？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:35:13.170

我将假设 ID 是主键，如果是这样，那么你应该加入插入 ID 而不是 category_value_id

```
ALTER TRIGGER [trigger_CATEGORY_VALUE_ID] ON [dbo].[tblA]
FOR UPDATE
AS
SET NOCOUNT ON
IF ( UPDATE([CATEGORY_VALUE_ID]))
BEGIN
  INSERT INTO [dbo].[htblB]
  ( ID
  , CATEGORY_VALUE_ID
  , STATUS_END_DATE
  , STATUS_END_DATE_SOURCE)
  SELECT
  t.ID
  , t.CATEGORY_VALUE_ID
  , GETDATE()
  , t.UPDATE_SOURCE
  FROM [dbo].[tblCAPITATION] t
  INNER JOIN inserted ins
  ON t.ID = ins.ID
END 
```

# c# - 互操作导致 Unity 崩溃

> ID：10524365
> 
> 赞同：6
> 
> 时间：2012-05-09T21:30:05.750
> 
> 标签：c#, c, callback, interop, unity3d

**如果您可以从脚本创建一个新线程，是否有可能将 C/C++ 函数回调到 Unity 脚本中？**我试过了，但一旦脚本执行，Unity 就会崩溃。

我用谷歌搜索了一下，发现[这个帖子](http://answers.unity3d.com/questions/201598/interop-wrapper-causes-unity-crash.html)说

> Unity 不是回调也不是线程安全的，对扩展 UnityEngine.Object 的类的任何访问只允许在运行统一脚本的同一线程内进行，不能与其他线程异步，也不能来自 COM / OS 异步操作的异步回调
> 
> 如果你是这种情况，有两种可能的方法：
> 
> (1) 编写一个包装器来获取这些回调并将这些东西排队，然后公开一个函数，该函数允许统一请求下一个事件/数据对象或以阻塞、非线程形式的任何内容 (2) 使回调调用到某事物上的静态函数从 System.Object 扩展并编写与上述相同的逻辑来请求有关扩展 UnityEngine.Object 的类的信息

**但是我认为如果我创建一个线程并回调到该线程中，就可以了，对吧？**我之所以这样想，是因为我读过类似[这样的线程，其中](https://stackoverflow.com/questions/2167895/howto-implement-callback-interface-from-unmanaged-dll-to-net-app)介绍了如何使 C 函数回调 C# 函数。所以我推断如果我创建一个新线程，它不再是 Unity，它只是单声道和 C#。

这是使 Unity 崩溃的代码：

C++ 代码：

```
#include <iostream>
// #include "stdafx.h"

typedef int (__stdcall * Callback)(const char* text);

Callback Handler = 0;

extern "C" __declspec(dllexport)
void __stdcall SetCallback(Callback handler) {
    Handler = handler;
}

extern "C" __declspec(dllexport)
void __stdcall TestCallback() {
    int retval = Handler("hello world");
} 
```

C# 代码：

```
using UnityEngine;
using System;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;
using System.Threading;

class UnManagedInterop : MonoBehaviour {
  private delegate int Callback(string text);
  private Callback mInstance;   // Ensure it doesn't get garbage collected

  public void Test() {
        mInstance = new Callback(Handler);
        SetCallback(mInstance);
        TestCallback();
  }

  private int Handler(string text) {
    // Do something...
    print(text);
    return 42;
  }

  [DllImport("test0")]
  private static extern void SetCallback(Callback fn);
  [DllImport("test0")]
  private static extern void TestCallback();

    void Start()
    {
        Thread oThread = new Thread(new ThreadStart(Test));

        // Start the thread
        oThread.Start();

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T11:20:20.610

答案是**肯定**的！

我在 2012 年 8 月 8 日再次测试，使用 Unity 3.5.2f2，Pro 许可证。感谢@hatboyzero 的评论，我找到[了这个例子](http://www.mono-project.com/Embedding_Mono#C.23_to_C_delegate_registration)。

虽然我的问题中的代码不起作用，但以下代码有效：

```
// C#
using System.Runtime.InteropServices;

class Demo {
    delegate int MyCallback1 (int a, int b);

    [DllImport ("MyRuntime")]
    extern static void RegisterCallback (MyCallback1 callback1);

    static int Add (int a, int b) { return a + b; }
    static int Sub (int a, int b) { return a - b; }

    void Init ()
    {
        // This one registers the method "Add" to be invoked back by C code
        RegisterCallback (Add);
    }
}

// C
typedef int (*callback_t) (int a, int b);
static callback_t my_callback;

void RegisterCallback (callback_t cb)
{
    my_callback = cb;
}

int InvokeManagedCode (int a, int b)
{
    if (my_callback == NULL){
         printf ("Managed code has not initialized this library yet");
         abort ();
    }
    return (*my_callback) (a, b);
} 
```

我不必像教程建议的那样嵌入 MonoRuntime。只是上面两段代码解决了我的问题。

# html - 画布上的 CSS 纵横比

> ID：10524366
> 
> 赞同：0
> 
> 时间：2012-05-09T21:30:17.960
> 
> 标签：html, canvas

最近，Mozilla 推出了一款名为 Browser Quest 的 HTML5 游戏。在游戏中，如果您调整窗口大小，画布也会随之调整大小。

我进行了更多调查，发现这是因为在这里找到了使用 CSS3 媒体查询[https://developer.mozilla.org/en/CSS/Media_queries](https://developer.mozilla.org/en/CSS/Media_queries)

但是，我仍然认为我做得不对。我的画布 ID 是`#canvas`. 我将如何将它放在我的画布上？

我的画布特定宽度/高度：`height:352px;` `width:512px;`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T16:09:53.137

因此，您不想在 CSS 中定义画布的大小，因为您只会将其从“真实”大小缩放。您总是希望使用 Canvas 的`width`和`height`属性。

但这并不意味着您不能以这种方式定义它的父级大小。将画布包裹在一个 div 中并将 div 的 CSS 宽度/高度设置为 100%（或任何你喜欢的）

在设置期间的代码中，您将必须执行以下操作：

```
// javascript pseudocode
canvas.width = theCanvasParent.clientWidth; // or whatever attribute it is, I'd reccomend putting all of those things in one giant container div
canvas.height = theCanvasParent.clientHeight; 
```

由于大多数浏览器不会在父 div 更改大小时触发事件，因此您只需使用计时器每隔半秒检查一次，以查看 div 是否更改了大小。如果有，那么您相应地调整画布的大小。

但是有`onresize`事件，根据您的页面设置方式，这可能会起作用。

在 Firefox、Opera、Google Chrome 和 Safari 中，**仅当浏览器窗口的大小发生更改时**`onresize`才会触发该事件。

 **在 Internet Explorer 中，`onresize`当浏览器窗口或元素的大小发生更改时会触发该事件。

因此，如果更改 div 大小的唯一方法是更改​​窗口大小，那么 onresize 就可以了。否则，您将需要一个计时器来不断检查画布大小和 div 大小是否不同（如果是，则调整画布大小）。

不断检查的计时器是 Mozilla Bepsin 团队所做的（在 Bespin 成为 Skywriter 并与 Ace 项目合并之前，放弃了所有 Canvas 的使用）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:42:00.537

媒体查询不会为您提供您所寻求的功能。它们的目的只是限制将特定样式表应用于页面的时间。

此外，CSS`width`和`height`属性不会调整画布元素的实际尺寸。相反，它们将元素缩放到请求的大小。在您的情况下，我假设您希望画布实际上具有不同的分辨率。画布的分辨率是通过标签上的 DOM`width`和`height`属性指定的。`<canvas>`

为了处理调整大小，您将需要使用`window.onresize`来捕获调整大小事件。然后，您的画布代码将需要创建一个所需大小的新画布，并正确复制原始画布中的所有内容（当您调整画布对象的大小时，其像素数据会被清除）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T06:50:49.040

正如 Xenethyl 所指出的，最重要的一点是挂钩 onresize 以便您可以适应新的画布对象大小：

*   将画布尺寸（绘图区域尺寸）调整为画布渲染区域（clientWidth 和 clientHeight）
*   为您的绘图算法考虑画布的新尺寸
*   重绘画布

您不必制作新的画布（这将迫使您重新挂钩其他事件处理程序）。

我的 Web 应用程序中的大多数画布，为了完美地调整到窗口，由一个专门的类管理，其骨架在这里：

```
function Grapher(options) {
    this.graphId = options.canvasId;
    this.dimChanged = true; // you may remove that if you want (see above)
};

Grapher.prototype.draw = function() {
    if (!this._ensureInit()) return;

    // makes all the drawing, depending on the state of the application's model

    // uses dimChanged to know if the positions and dimensions of drawed objects have
    //  to be recomputed due to a change in canvas dimensions

}

Grapher.prototype._ensureInit = function() {
    if (this.canvas) return true;
    var canvas = document.getElementById(this.graphId);
    if (!canvas) {
        return false;
    }
    if (!$('#'+this.graphId).is(':visible')) return false;
    this.canvas = canvas;
    this.context = this.canvas.getContext("2d");
    var _this = this;
    var setDim = function() {
        _this.w = _this.canvas.clientWidth;
        _this.h = _this.canvas.clientHeight;
        _this.canvas.width = _this.w;
        _this.canvas.height = _this.h;
        _this.dimChanged = true;
        _this.draw(); // calls the function that draws the content
    };
    setDim();
    $(window).resize(setDim);
    // other inits (mouse hover, mouse click, etc.)
    return true;
}; 
```

在您的情况下，我将创建一个`new Grapher({canvasId:'#canvas'})`并且 #canvas 尺寸在 css 中定义（并且通常以复杂的方式调整到可用空间）。

最有趣的地方在于 setDim 函数。**

# php - 使用 PHP 的 SimpleXMLElement 类查找指定元素的最佳方法是什么？

> ID：10524370
> 
> 赞同：2
> 
> 时间：2012-05-09T21:30:38.590
> 
> 标签：php, python, xml, get

我目前正在进行的项目涉及将一个用 Python 编写的网站翻译成 PHP 代码。我现在正在做的部分需要我向 Web 服务器发送 $_GET 请求。我得到的响应总是 XML 格式，所以我使用 *simplexml_load_file()* 函数来获取结果。

我需要解析 Web 服务器发回给我的 XML。Python 有一个很好的库，叫做 BeautifulStoneSoup，它有一个*find()*方法，可以返回指定属性的内容。

查看[http://php.net/manual/en/book.simplexml.php](http://php.net/manual/en/book.simplexml.php)上的 PHP 函数列表后，我似乎找不到任何允许我指定属性名称并获取内容的内容。请记住，我可能正在寻找的属性不一定总是深入 XML 数组的一层。它可能是数组的几个维度。

如果这不够具体，我可以提供一个例子。谢谢朋友的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:33:31.623

Xpath 听起来像您正在寻找的东西。它允许在 XML 目录的任何级别进行搜索。

以下示例使用 xml 目录查看多个级别，并检查描述节点是否包含其中包含的任何内容`$txtSearch`

```
$holidayDoc = simplexml_load_file($url);    
$qry = "//channel/item[description[contains(text(),\"$txtSearch\")]]";
$holidayDoc->xpath($qry); 
```

然后可以使用 foreach 循环迭代结果

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T21:35:00.097

您可以运行 XPath 查询：

```
$xml->xpath('//@myattribute') 
```

# regex - 在 Mac OS X Lion 上使用 sed 替换文本文件的第一行

> ID：10524373
> 
> 赞同：1
> 
> 时间：2012-05-09T21:30:54.653
> 
> 标签：regex, macos, sed

我有一个文件**cache.md**，它的开头是这样的：

```
# 2012-05-09.8271
CACHE MANIFEST

CACHE:
/index.html 
```

我正在尝试编写一个 shell 脚本（在 OS X Lion 中使用 Automator）来替换第一行并将文本（在哈希之后）更改为今天的日期、一个点和一个随机数。

这是我到目前为止的 bash 脚本，但它什么也没做。

```
_now=$(date +"%Y-%m-%d")
_rand=$RANDOM
sed -i '' '1 s/[\d\-\.]+/$_now.$_rand/' ~/Desktop/cache.mf 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:58:28.520

使用这个 sed 命令：

```
sed -i '' '1 s/^#.*$/'"# $_now.$_rand"'/' ~/Desktop/cache.mf 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T21:37:46.643

看起来你离开了 -e 的 sed 表达式！

我没有检查您的 sed 表达式本身，但基本问题是您需要使用 -e 选项识别您的 sed 表达式：

```
sed -i '' -e '1 s/[\d\-\.]+/$_now.$_rand/' ~/Desktop/cache.mf 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T21:50:06.203

给你：

```
_now=$(date +"%Y-%m-%d")
_rand=$RANDOM
sed -i -e "s/# [0-9]\+-[0-9]\+-[0-9]\+.[0-9]\+/\# $_now.$_rand/" ~/Desktop/cache.mf 
```

# c# - MVC 3 中的谓词生成器

> ID：10524374
> 
> 赞同：0
> 
> 时间：2012-05-09T21:30:56.710
> 
> 标签：c#, linq, search, predicatebuilder

我已经用 Predicate Builder 搞砸了两天了，尽管每个网站都说由于某种原因它非常容易实现（很可能是我的错），但我无法让它工作。我决定使用谓词生成器，因为我知道我想搜索哪些列，并且它们都在同一个表中。我要做的就是在多个列中搜索可能存在于 3 列中的任何一个中的关键字。我读过 Predicate Builder 可以轻松完成此操作，但教程显然没有考虑到我。以下是我到目前为止所拥有的，如果有人能指出我正确的方向，我将不胜感激。现在当我搜索时它什么也没做，它只是返回所有记录。谢谢你的帮助！

```
if (!String.IsNullOrEmpty(searchString))
            {

                var predicate = PredicateBuilder.True<iamp_mapping>();

                predicate = predicate.Or(p => p.PA.Contains(searchString));
                predicate = predicate.Or(p => p.MAJOR_PROGRAM.Contains(searchString));
                predicate = predicate.Or(p => p.INVESTMENT_AREA.Contains(searchString));

            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:02:17.263

尝试

```
var predicate = PredicateBuilder.False<iamp_mapping>(); 
```

由于您使用“或”连接。

# java - 如何使 JFileChooser 默认为计算机视图而不是我的文档

> ID：10524376
> 
> 赞同：8
> 
> 时间：2012-05-09T21:31:07.500
> 
> 标签：java, windows, swing, jfilechooser, jdialog

在 JFileChooser 的 Windows 外观中，JFileChooser 对话框的左侧显示了五个按钮：Recent Items、Desktop、My Documents、Computer 和 Network。这些每个都代表文件系统的视图，就像 Windows 资源管理器将显示的那样。除非调用 setSelectedFile() 或 setCurrentDirectory() 方法，否则 JFileChooser 似乎默认为 My Documents View。

我试图让用户可以轻松地选择多个映射网络驱动器之一，这些驱动器应该出现在“计算机”视图中。有没有办法将 JFileChooser 设置为默认打开“计算机”视图？

我尝试了几种方法来强制它，最近的是找到根目录并将其设置为 currentDirectory，但这显示了该根节点的内容。最新的代码包含在下面。

```
private File originalServerRoot;
private class SelectOriginalUnitServerDriveListener implements ActionListener
    {
        @Override
        public void actionPerformed(ActionEvent e)
        {
            JFileChooser origDriveChooser = new JFileChooser();
            origDriveChooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            File startFile = new File(System.getProperty("user.dir")); //Get the current directory

            // Find System Root
            while (!FileSystemView.getFileSystemView().isFileSystemRoot(startFile))
            {
                startFile = startFile.getParentFile();
            }

            origDriveChooser.setCurrentDirectory(startFile);
            origDriveChooser.setDialogTitle("Select the Mapped Network Drive");
            int origDriveChooserRetVal = origDriveChooser.showDialog(contentPane,"Open");
            if (origDriveChooserRetVal == JFileChooser.APPROVE_OPTION)
            {
                originalUnitServerRoot = origDriveChooser.getSelectedFile();

            }
        }
    } 
```

有没有一种方法可以让我默认选择“计算机”视图（或网络，或任何其他视图），或者以任何方式欺骗 JFileChooser？

**编辑**
感谢您提供快速而彻底的答案。我结合了 Hovercraft Full Of Eels 和 Guillaume Polet 的答案，试图让代码在任何驱动器号上工作。结果代码如下。再一次，谢谢。

```
private File originalServerRoot;
private class SelectOriginalUnitServerDriveListener implements ActionListener
    {
        @Override
        public void actionPerformed(ActionEvent e)
        {
            JFileChooser origDriveChooser = new JFileChooser();
            origDriveChooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            File startFile = new File(System.getProperty("user.dir")); //Get the current directory

            // Find System Root
            while (!FileSystemView.getFileSystemView().isFileSystemRoot(startFile))
            {
                startFile = startFile.getParentFile();
            }
            //Changed the next line
            origDriveChooser.setCurrentDirectory(origDriveChooser.getFileSystemView().getParentDirectory(rootFile));
            origDriveChooser.setDialogTitle("Select the Mapped Network Drive");
            int origDriveChooserRetVal = origDriveChooser.showDialog(contentPane,"Open");
            if (origDriveChooserRetVal == JFileChooser.APPROVE_OPTION)
            {
                originalUnitServerRoot = origDriveChooser.getSelectedFile();

            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T22:01:22.733

这是一个工作示例。它假设 C:\ 是有效路径。它使用`FileSystemView.getParentDir(File)`

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.File;

import javax.swing.JButton;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class Test {

    /**
     * @param args
     */
    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new Test().initUI();
            }
        });
    }

    protected void initUI() {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JPanel panel = new JPanel();
        final JButton button = new JButton("Select files...");
        button.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                final JFileChooser chooser = new JFileChooser();
                chooser.setCurrentDirectory(
                                 chooser.getFileSystemView().getParentDirectory(
                                     new File("C:\\")));  
                            chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
                chooser.showDialog(button, "Select file");
            }
        });
        panel.add(button);
        frame.add(panel);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-09T21:57:06.173

这样做的一种方法是获取默认目录的父目录，直到`toString()`获得的文件是“计算机”。就像是：

```
 FileSystemView fsv = FileSystemView.getFileSystemView();
  File defaultFile = fsv.getDefaultDirectory();
  while (defaultFile != null) {
     defaultFile = defaultFile.getParentFile();
     if (defaultFile != null && "Computer".equalsIgnoreCase(defaultFile.toString())) {
        JFileChooser fileChooser = new JFileChooser(defaultFile);
        fileChooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
        int result = fileChooser.showOpenDialog(null);
        if (result == JFileChooser.APPROVE_OPTION) {
           File file = fileChooser.getSelectedFile();
           System.out.println(file);
        }
     }
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-26T20:52:07.150

```
//Specify the absolute path of the Mapped Drive

chooser.setCurrentDirectory(new File("B:\\exampleFolder")); 
```

或者

```
// set the file opener to look at the desktop    

JFileChooser chooser = new JFileChooser();        
chooser.setCurrentDirectory(new File(System.getProperty("user.home") + "\\Desktop")); 
```

# xml - 在 XSLT 文件中添加页眉和页脚

> ID：10524380
> 
> 赞同：0
> 
> 时间：2012-05-09T21:31:29.513
> 
> 标签：xml, xslt, ms-word, xsl-fo

我有一个 XSLT 文件，可以将 XML 转换为 word 文档。我的问题是我想在文档中添加页眉和页脚。我该怎么做？

我的问题基本上类似于[使用 xslt 的页眉和页脚和页码](https://stackoverflow.com/questions/4838613/header-and-footer-and-page-numbers-using-xslt)。

可以在[此处](http://www.w3schools.com/xslfo/obj_region-after.asp)找到有关页眉和页脚的更多帮助。基本上我需要使用这些标签，但如何在我的模板中使用它？我把它放在最后还是中间的某个地方？我还想将单词页面布局更改为默认为纵向的横向。

```
<fo:region-before> defines the top region (header)
<fo:region-after> defines the bottom region (footer) 
```

假设这是我的 XSLT

```
<?xml version="1.0" encoding="ISO-8859-1"?>

<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">
  <html>
  <body>
    <h2>My CD Collection</h2>
    <table border="1">
      <tr bgcolor="#9acd32">
        <th>Title</th>
        <th>Artist</th>
      </tr>
      <xsl:for-each select="catalog/cd">
        <tr>
          <td><xsl:value-of select="title"/></td>
          <td><xsl:value-of select="artist"/></td>
        </tr>
      </xsl:for-each>
    </table>
  </body>
  </html>
</xsl:template>

</xsl:stylesheet> 
```

上面的例子是从[w3school复制过来的](http://www.w3schools.com/xsl/tryxslt.asp?xmlfile=cdcatalog&xsltfile=cdcatalog)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T08:06:06.943

正如大量评论中所说，不要生成 HTML，而是完全生成 XSL-FO 或 Word XML。由于 Word XML 是最直接的方法，因此我将使用我能想到的最小示例来帮助您，该示例返回类似于您的 HTML 的内容，但带有页眉和页脚。实际上，我只是在 Word 中打开了一个生成的 HTML，将其保存为 Word XML，添加了页眉和页脚，并去掉了 Word 自动添加的大多数多余的 XML 标记。

将以下内容放入您的根 xsl 模板中，为每个表格行添加一个，并以您喜欢的方式动态填充页眉/页脚..

```
<w:wordDocument xmlns:aml="http://schemas.microsoft.com/aml/2001/core" xmlns:wpc="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w10="urn:schemas-microsoft-com:office:word" xmlns:w="http://schemas.microsoft.com/office/word/2003/wordml" xmlns:wx="http://schemas.microsoft.com/office/word/2003/auxHint" xmlns:wne="http://schemas.microsoft.com/office/word/2006/wordml" xmlns:wsp="http://schemas.microsoft.com/office/word/2003/wordml/sp2" xmlns:sl="http://schemas.microsoft.com/schemaLibrary/2003/core" w:macrosPresent="no" w:embeddedObjPresent="no" w:ocxPresent="no" xml:space="preserve">

<w:docPr>
<w:view w:val="print"/>
<w:zoom w:percent="100"/>
</w:docPr>

<w:styles>
<w:style w:type="paragraph" w:styleId="Heading2">
<w:name w:val="heading 2"/>
<wx:uiName wx:val="Heading 2"/>
<w:basedOn w:val="Standaard"/>
<w:pPr>
<w:spacing w:before="100" w:before-autospacing="on" w:after="100" w:after-autospacing="on"/>
<w:outlineLvl w:val="1"/>
</w:pPr>
<w:rPr>
<w:b/>
<w:sz w:val="36"/>
</w:rPr>
</w:style>

<w:style w:type="paragraph" w:styleId="Headertext">
<w:name w:val="header"/>
<wx:uiName wx:val="Header text"/>
<w:basedOn w:val="Standaard"/>
<w:pPr>
<w:tabs>
<w:tab w:val="center" w:pos="4536"/>
<w:tab w:val="right" w:pos="9072"/>
</w:tabs>
</w:pPr>
</w:style>

<w:style w:type="paragraph" w:styleId="Footertext">
<w:name w:val="footer"/>
<wx:uiName wx:val="Footer text"/>
<w:basedOn w:val="Standaard"/>
<w:pPr>
<w:tabs>
<w:tab w:val="center" w:pos="4536"/>
<w:tab w:val="right" w:pos="9072"/>
</w:tabs>
</w:pPr>
</w:style>
</w:styles>

<w:body>
<w:p>
<w:pPr>
<w:pStyle w:val="Heading2"/>
</w:pPr>
<w:r>
<w:t>My CD Collection</w:t>
</w:r>
</w:p>

<w:tbl>
<w:tblPr>
<w:tblW w:w="5000" w:type="pct"/>
<w:tblCellSpacing w:w="15" w:type="dxa"/>
<w:tblBorders>
<w:top w:val="outset" w:sz="6" wx:bdrwidth="15" w:space="0" w:color="auto"/>
<w:left w:val="outset" w:sz="6" wx:bdrwidth="15" w:space="0" w:color="auto"/>
<w:bottom w:val="outset" w:sz="6" wx:bdrwidth="15" w:space="0" w:color="auto"/>
<w:right w:val="outset" w:sz="6" wx:bdrwidth="15" w:space="0" w:color="auto"/>
</w:tblBorders>
<w:tblCellMar>
<w:top w:w="15" w:type="dxa"/>
<w:left w:w="15" w:type="dxa"/>
<w:bottom w:w="15" w:type="dxa"/>
<w:right w:w="15" w:type="dxa"/>
</w:tblCellMar>
<w:tblLook w:val="04A0"/>
</w:tblPr>
<w:tr>
<w:tc>
<w:p>
<w:r>
<w:rPr>
<w:b/>
</w:rPr>
<w:t>Title</w:t>
</w:r>
</w:p>
</w:tc>
<w:tc>
<w:p>
<w:r>
<w:rPr>
<w:b/>
</w:rPr>
<w:t>Artist</w:t>
</w:r>
</w:p>
</w:tc>
</w:tr>
<w:tr>
<w:tc>
<w:p>
<w:r>
<w:t>title1</w:t>
</w:r>
</w:p>
</w:tc>
<w:tc>
<w:p>
<w:r>
<w:t>artist1</w:t>
</w:r>
</w:p>
</w:tc>
</w:tr>
<w:tr>
<w:tc>
<w:p>
<w:r>
<w:t>title2</w:t>
</w:r>
</w:p>
</w:tc>
<w:tc>
<w:p>
<w:r>
<w:t>artist2</w:t>
</w:r>
</w:p>
</w:tc>
</w:tr>
</w:tbl>

<w:p />

<w:hdr w:type="odd">
<w:p>
<w:pPr>
<w:pStyle w:val="Headertext"/>
</w:pPr>
<w:r>
<w:t>Header text</w:t>
</w:r>
<w:r>
<w:tab/>
<w:t>center</w:t>
</w:r>
<w:r>
<w:tab/>
<w:t>right</w:t>
</w:r>
</w:p>
</w:hdr>

<w:ftr w:type="odd">
<w:p>
<w:pPr>
<w:pStyle w:val="Footertext"/>
</w:pPr>
<w:r>
<w:t>left</w:t>
</w:r>
<w:r>
<w:tab/>
<w:t>Footer text</w:t>
</w:r>
<w:r>
<w:tab/>
</w:r>
<w:r>
<w:fldChar w:fldCharType="begin"/>
</w:r>
<w:r>
<w:instrText>PAGE   \* MERGEFORMAT</w:instrText>
</w:r>
<w:r>
<w:fldChar w:fldCharType="separate"/>
</w:r>
<w:r>
<w:t>1</w:t>
</w:r>
<w:r>
<w:fldChar w:fldCharType="end"/>
</w:r>
</w:p>
</w:ftr>
</w:body>
</w:wordDocument> 
```

它还有助于确保在根元素之前添加以下处理指令：

```
<?mso-application progid="Word.Document"?> 
```

！

# java - GPS Android - 仅获取一次定位

> ID：10524381
> 
> 赞同：37
> 
> 时间：2012-05-09T21:31:34.387
> 
> 标签：java, android, gps, locationmanager

有没有办法访问 GPS 一次，而不是让 Looper 不断检查位置更新？

在我的场景中，我感兴趣的只是找到当前坐标，而不是与 GPS 卫星的持续连接。有谁知道如何做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2016-08-05T16:54:23.033

不要使用 getLastKnownLocation，因为这可能会返回 null 或旧数据。

此代码**仅在按下按钮后才获取位置，**而不是每次都获取。人们习惯于让位置监听器在每个实例中都进行监听，这会**缩短电池寿命**，因此请使用我通过大量研究发布的代码片段：

```
// get the text view and buttons from the xml layout
Button button = (Button) findViewById(R.id.btnGetLocation);
final TextView latitude = (TextView) findViewById(R.id.textview4);
final TextView longitude = (TextView) findViewById(R.id.textview5);
final LocationListener locationListener = new LocationListener() {
        @Override
        public void onLocationChanged(Location location) {
            mlocation = location;
            Log.d("Location Changes", location.toString());
            latitude.setText(String.valueOf(location.getLatitude()));
            longitude.setText(String.valueOf(location.getLongitude()));
        }

        @Override
        public void onStatusChanged(String provider, int status, Bundle extras) {
            Log.d("Status Changed", String.valueOf(status));
        }

        @Override
        public void onProviderEnabled(String provider) {
            Log.d("Provider Enabled", provider);
        }

        @Override
        public void onProviderDisabled(String provider) {
            Log.d("Provider Disabled", provider);
        }
    };

    // Now first make a criteria with your requirements
    // this is done to save the battery life of the device
    // there are various other other criteria you can search for..
    Criteria criteria = new Criteria();
    criteria.setAccuracy(Criteria.ACCURACY_COARSE);
    criteria.setPowerRequirement(Criteria.POWER_LOW);
    criteria.setAltitudeRequired(false);
    criteria.setBearingRequired(false);
    criteria.setSpeedRequired(false);
    criteria.setCostAllowed(true);
    criteria.setHorizontalAccuracy(Criteria.ACCURACY_HIGH);
    criteria.setVerticalAccuracy(Criteria.ACCURACY_HIGH);

    // Now create a location manager
    final LocationManager locationManager = (LocationManager)getSystemService(Context.LOCATION_SERVICE);

   // This is the Best And IMPORTANT part
    final Looper looper = null;

   // Now whenever the button is clicked fetch the location one time
   button.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            locationManager.requestSingleUpdate(criteria, locationListener, looper);
       }
   }); 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-05-09T21:35:45.160

首先检查最后知道的位置是否是最近的。如果没有，我相信您必须设置 onLocationChanged 侦听器，但是一旦您获得第一个有效位置，您就可以随时停止更新流。

**添加**

```
public class Example extends Activity implements LocationListener {
    LocationManager mLocationManager;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mLocationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

        Location location = mLocationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
        if(location != null && location.getTime() > Calendar.getInstance().getTimeInMillis() - 2 * 60 * 1000) {
            // Do something with the recent location fix
            //  otherwise wait for the update below
        }
        else {
            mLocationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, this);
        }
    }

    public void onLocationChanged(Location location) {
        if (location != null) {
            Log.v("Location Changed", location.getLatitude() + " and " + location.getLongitude());
            mLocationManager.removeUpdates(this);
        }
    }

    // Required functions    
    public void onProviderDisabled(String arg0) {}
    public void onProviderEnabled(String arg0) {}
    public void onStatusChanged(String arg0, int arg1, Bundle arg2) {}
} 
```

# jquery - 如何同时在多个元素上运行一个 jQuery 动画功能？

> ID：10524386
> 
> 赞同：0
> 
> 时间：2012-05-09T21:31:49.510
> 
> 标签：jquery, animation

这个想法是让一定数量的元素摇摆，并且只使用一个函数来做到这一点（我认为这是最好的选择）。我制作了一个可以让单个元素摇摆的函数，***效果非常好***，但后来我试图让它适用于多个元素，但我遇到了真正的问题。

更复杂的是，摇摆函数的设计目的是在每次调用时产生略微不同的直径和速度，因此摇摆看起来很自然。它还可以无限期地循环运动。

因此，该函数分为三个部分，**第一个**设置它将应用到的元素数组，**第二个**（称为 main）生成该元素摇摆所需的变量，**第三个**（称为 act）运行和循环摇摆动画。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Balloon Proof of Concept Page</title>

    <link rel="stylesheet" type="text/css" href="main.css">

    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            var now;
            var balloons = new Array();
            balloons[0] = "#box1"
            balloons[1] = "#box2"
            balloons[2] = "#box3"

            var main = function(hello) {

                var speed = Math.random() * (2500 - 2000 + 1) + 2000;
                var change = Math.random() * (35 - 10 + 1) + 10;

                var act = function() {
                    $(hello).animate({
                        left : change
                    }, speed);
                    $(hello).animate({
                        left : -change
                    }, speed);
                    act();
                }
                act();
            }

        for( now = 0; now < balloons.length; now++) {
                main(balloons[now]);
            }
        });
    </script>
</head>

<body>

    <div class="box" id="box1" style="margin-left:300px; margin-top:60px">
        Proj 1
    </div>
    <div class="box" id="box2" style="margin-left:500px; margin-top:20px">
        Proj 2
    </div>
    <div class="box" id="box3" style="margin-left:700px; margin-top:50px">
        Proj 3
    </div>

</body>
</html> 
```

我**预计**该函数可能会卡在循环的第一个数组元素上，现在基本代码已经修复，我正好处于这种情况。有没有人有任何想法如何解决这个问题或替代方法。

CSS 非常简单，只是一些基本的样式

```
.box {
width:100px;
height:100px;
position: absolute;
background-color:red;}

.html .body {position: absolute;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:37:01.803

当您调用`.animate()`它时，将动画*排队*，然后立即返回。

由于您随后`act`再次递归调用，因此代码将进入无限循环。

试试这个，而不是：

```
function act() {
    $(hello)
       .animate({ left :  change }, speed)
       .animate({ left : -change }, speed, act);
} 
```

即注册`act`为动画第二阶段的*完成回调*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T21:47:33.780

您可以使用计时器，这将在一段时间后重复运动。

```
<script type="text/javascript">                                                                                                                                                                                                                
        $(document).ready(function() {                                                                                                                                                                                                             
            var now;                                                                                                                                                                                                                               
            var balloons = new Array();                                                                                                                                                                                                            
            balloons[0] = "#box1"                                                                                                                                                                                                                  
            balloons[1] = "#box2"                                                                                                                                                                                                                  
            balloons[2] = "#box3"                                                                                                                                                                                                                  

            var main = function(hello) {                                                                                                                                                                                                           

                var speed = Math.random() * (2500 - 2000 + 1) + 2000;                                                                                                                                                                              
                var change = Math.random() * (35 - 10 + 1) + 10;                                                                                                                                                                                   

                var act = function() {                                                                                                                                                                                                             
                    $(hello).animate({                                                                                                                                                                                                             
                        left : change                                                                                                                                                                                                              
                    }, speed);                                                                                                                                                                                                                     
                    $(hello).animate({                                                                                                                                                                                                             
                        left : -change                                                                                                                                                                                                             
                    }, speed);                                                                                                                                                                                                                     
                }                                                                                                                                                                                                                              
                act();                                                                                                                                                                                                                             
                setInterval( act, 1000);                                                                                                                                                                                                           

            }                                                                                                                                                                                                                                      
var now = 0;                                                                                                                                                                                                                               
for( now = 0; now < balloons.length; now++) {                                                                                                                                                                                              
     main(balloons[now]);                                                                                                                                                                                                               
}                                                                                                                                                                                                                                          

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:30:50.717

如果重新排列如下，可能更容易理解：

```
$(function(){
    function act(jqObj, speed, change) {
        jqObj.animate({
            'left': change // stage 1
        }, speed).animate({
            'left': -change // stage 2
        }, speed, function(){
            act(jqObj, speed, change); // repeat stages 1 and 2 (indefinitely)
        });
    };
    var balloons = [ // array of jQuery objects.
        $("#box1"),
        $("#box2"),
        $("#box3")
    ];
    for (i = 0; i < balloons.length; i++) {
        var speed = 2000 + Math.random() * 501;
        var change = 10 + Math.random() * 26;
        act(balloons[i], speed, change);
    }
}); 
```

[在此处](http://jsfiddle.net/BWbJj/1/)查看工作演示。

# python - BeautifulSoup get_text 不会去除所有标签和 JavaScript

> ID：10524387
> 
> 赞同：7
> 
> 时间：2012-05-09T21:31:49.997
> 
> 标签：python, html, xml, screen-scraping, beautifulsoup

我正在尝试使用 BeautifulSoup 从网页中获取文本。

下面是我为此编写的脚本。它有两个参数，第一个是输入 HTML 或 XML 文件，第二个是输出文件。

```
import sys
from bs4 import BeautifulSoup

def stripTags(s): return BeautifulSoup(s).get_text()

def stripTagsFromFile(inFile, outFile):
    open(outFile, 'w').write(stripTags(open(inFile).read()).encode("utf-8"))

def main(argv):
    if len(sys.argv) <> 3:
        print 'Usage:\t\t', sys.argv[0], 'input.html output.txt'
        return 1
    stripTagsFromFile(sys.argv[1], sys.argv[2])
    return 0

if __name__ == "__main__":
    sys.exit(main(sys.argv)) 
```

不幸的是，对于许多网页，例如：[http](http://www.greatjobsinteaching.co.uk/career/134112/Education-Manager-Location) ://www.greatjobsinteaching.co.uk/career/134112/Education-Manager-Location 我得到了这样的东西（我只显示了几行第一行）：

```
html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"
    Education Manager  Job In London With  Caleeda | Great Jobs In Teaching

var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-15255540-21']);
_gaq.push(['_trackPageview']);
_gaq.push(['_trackPageLoadTime']); 
```

我的脚本有什么问题吗？我试图将“xml”作为第二个参数传递给 BeautifulSoup 的构造函数，以及“html5lib”和“lxml”，但它没有帮助。有没有比 BeautifulSoup 更适合这项任务的替代品？我想要的只是提取将在浏览器中为该网页呈现的文本。

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-14T19:48:38.470

nltk's`clean_html()`在这方面做得很好！

假设您已经将 html 存储在一个变量中，`html`例如

```
html = urllib.urlopen(address).read() 
```

然后只需使用

```
import nltk
clean_text = nltk.clean_html(html) 
```

**更新**

对 nltk 未来版本的支持`clean_html`并将被删除。`clean_url`请暂时使用 BeautifulSoup ......这很不幸。

此页面上有一个如何实现此目的的示例：

[BeatifulSoup4 get_text 仍然有 javascript](https://stackoverflow.com/questions/22799990/beatifulsoup4-get-text-still-has-javascript)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-05T17:48:52.277

这是我遇到的问题。似乎没有解决方案能够返回文本（实际上将在网络浏览器中呈现的文本）。其他解决方案提到 BS 不适合渲染，而 html2text 是一个很好的方法。我尝试了 html2text 和 nltk.clean_html 并且对计时结果感到惊讶，因此认为他们需要为后代提供答案。当然，速度增量​​可能在很大程度上取决于数据的内容......

@Helge 的一个答案是关于使用所有事物的 nltk。

```
import nltk

%timeit nltk.clean_html(html)
was returning 153 us per loop 
```

返回带有呈现的 html 的字符串非常有效。这个 nltk 模块甚至比 html2text 更快，尽管 html2text 可能更健壮。

```
betterHTML = html.decode(errors='ignore')
%timeit html2text.html2text(betterHTML)
%3.09 ms per loop 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T22:58:00.707

这是一种基于此处答案的方法：[BeautifulSoup Grab Visible Webpage Text](https://stackoverflow.com/questions/1936466/beautifulsoup-grab-visible-webpage-text) by jbochi。这种方法允许在包含页面文本的元素中嵌入注释，并通过去除换行符、合并空格等来清理输出。

```
html = urllib.urlopen(address).read()
soup = BeautifulSoup.BeautifulSoup(html)
texts = soup.findAll(text=True)

def visible_text(element):
    if element.parent.name in ['style', 'script', '[document]', 'head', 'title']:
        return ''
    result = re.sub('<!--.*-->|\r|\n', '', str(element), flags=re.DOTALL)
    result = re.sub('\s{2,}|&nbsp;', ' ', result)
    return result

visible_elements = [visible_text(elem) for elem in texts]
visible_text = ''.join(visible_elements)
print(visible_text) 
```

# powershell - Powershell插入多个XML元素

> ID：10524389
> 
> 赞同：1
> 
> 时间：2012-05-09T21:32:00.877
> 
> 标签：powershell

我有一个类似于以下结构的 XML 文件：

```
<a>
  <b>
    <c>aa</c>
  </b>
  <d>
    <e>bb</e>
  </d>
</a> 
```

我需要做的是在 中插入额外的元素，以获得以下内容：

```
<a>
  <b>
    <c>aa</c>
  </b>
  <d>
    <e>bb</e>
    <e>cc</e>
    <e>dd</e>
    <e>ff</e>
    <e>gg</e>
  </d>
</a> 
```

我正在尝试在 Powershell 中执行此操作。这是我尝试过的：

```
$xml = "path_to_xml_file"
$e1 = $xml.a.d.e
$e2 = $e1.clone()
$e2 = "cc"
$xml.a.d.InsertAfter($e2,$e1)
$xml.save("path_to_xml_file") 
```

但这给了我一个错误。有人可以建议如何去做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T23:11:10.260

您应该`CreateElement`在实例上使用该方法，`XmlDocument`例如：

```
$xml = [xml]@'
<a>
  <b>
    <c>aa</c>
  </b>
  <d>
    <e>bb</e>
  </d>
</a>
'@

$newNode = $xml.CreateElement('e')
$newNode.InnerText = "cc"
$xml.a.d.AppendChild($newNode) 
```

此外，如果从文件中获取 XML，您应该使用：

```
$xml = [xml](Get-Content path_to_xml_file) 
```

# php - ajax 调用不会从 php-script 返回

> ID：10524392
> 
> 赞同：0
> 
> 时间：2012-05-09T21:32:03.903
> 
> 标签：php, jquery, ajax

我的问题是我有两个对 php 的 ajax 调用以获取注册表单。首先是用户名可用性检查，它工作得非常好，其次是密码检查，它不起作用，数据库和所有三个文件肯定是连接的，但我找不到问题。如果有人知道，谢谢。
这是html：

```
<div id="registration_form">
    <table>
         <tr>
            <td>Choose Username:</td>
            <td><input type="text" id="username" autofocus="autofocus"  /><span id="username_status"> </span></td>
         </tr>
        <tr>
            <td>Choose Password:</td>
            <td><input type="password" id="password" /> <span  id="password_status"></span></td>
         </tr>
         <tr>
            <td>Confirm Password:</td>
            <td><input type="password" id="confirmpassword" /> <span  id="pconfirm_status"></span></td>
         </tr>
        <tr>
            <td>Email:</td>
            <td><input type="text" id="email" /><span id="email_status"></span></td>
         </tr> 
         <tr>
            <td>Confirm Email:</td>
            <td><input type="text" id="confirmemail" /><span id="econfirm_status"></span></td>
         </tr>
        <tr>
            <td><input type="submit" value="Register" id="submit" />    </td>
         </tr>
    </table>
        <div id="regform_reply"></div>
</div> 
```

这是jQuery：

```
$('#password').keyup(function()
{
var password = $(this).val();
$('#password_status').text('Searching...');
    if (password != '')
    {
        $.post('php/register.php', { password: password }, function(data)
        {
            $('#password_status').text(data);
        });
    }
    else
    {
        $('#password_status').text('');
    }           
});

$('#username').keyup(function()
{
var username = $(this).val();
$('#username_status').text('Searching...');
    if (username != '')
    {
        $.post('php/register.php', { username: username }, function(data)
        {
            $('#username_status').text(data);
        });
    }
    else
    {
        $('#username_status').text('');
    }           
}); 
```

这是php：

```
<?php
include '../connect/userdb_connect.php';

if (isset($_POST['password']))
{
$password = mysql_real_escape_string($_POST['password']);
if (!empty($password))
{
    if (strlen($password)>25)
    {
        echo 'Too long';
    }
    else if(strlen($password)<6)
    {
        echo 'Too short';
    }
    else
    {
        echo 'Fine';
    }
}   
}

if (isset($_POST['username']))
{
$username = mysql_real_escape_string($_POST['username']);
if (!empty($username))
{
    $check = mysql_query("SELECT `user_name` FROM `userbase` WHERE `user_name`  = '$username'");
    $result = mysql_num_rows($check);

    if ($result == 0 && strlen($username) <25)
    {
        echo 'Available';
    }
    else if($result == 1 && strlen($username) <25)
    {
        echo 'Already taken';
    }
    else
    {
        echo 'Too long';
    }
}           
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:38:34.057

您可能想要删除 mysql_real_escape_string，因为您没有将其传递给 mysql。某些转义序列可能会混淆您的比较。

所以`$password = mysql_real_escape_string($_POST['password']);`

应该只是`$password = $_POST['password'];`

（并不是说当你将它放入数据库时​​就可以了，但是对于执行 strlen 函数应该没问题）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:47:31.837

我会选择类似的东西：

```
$('#password').on('keyup', function() {
    //there's no need to do ajax to check input length, just always validate on the server aswell
    var password = this.value;
    if (password != '') {
        $('#password_status').text('Searching...');
        if (password.length>25) {
            $('#password_status').text('Too long');
        }else if (password.length<6) {
            $('#password_status').text('Too short');
        }else{
            $.post('php/register.php', { password: password }, function(data) {
                //do you really need to check this, other then when inserting to DB ?
                $('#password_status').text(data); 
            });
        }
    }else{
        $('#password_status').text('');
    }
});

$('#username').on('keyup', function() {
    var username = this.value;
    if (username != '') {
        $('#username_status').text('Searching...');
        if (username.length>25) {
            $('#username_status').text('Too long'); 
        }else if (username.length<6) {
            $('#username_status').text('Too short'); 
        }else{
            $.post('php/register.php', { username: username }, function(data) {
                $('#username_status').text(data);
            });
    }else{
        $('#username_status').text('');
    }
}); 
```

PHP

```
<?php
    include '../connect/userdb_connect.php';

    if (isset($_POST['password'])) {
        $password = mysql_real_escape_string($_POST['password']);
        if (!empty($password) && strlen($password)<25 && strlen($password)>6) {
            //hash and insert into db
        }else{
            //error
        }
    }else{
       //no POST var
    }

    if (isset($_POST['username'])) {
        $username = mysql_real_escape_string($_POST['username']);
        if (!empty($username) && strlen($username)<25 && strlen($username)>6) {
            $check = mysql_query("SELECT `user_name` FROM `userbase` WHERE `user_name`  = '$username'");
            $result = mysql_num_rows($check);
            if ($result == 0) {
                echo 'Available';
            }else if ($result == 1) {
                echo 'Already taken';
            }
        }else{
            //error
        }
    }else{
       //no POST var
    }
?> 
```

# asp.net-mvc - MVC 模型绑定/验证

> ID：10524395
> 
> 赞同：1
> 
> 时间：2012-05-09T21:32:28.193
> 
> 标签：asp.net-mvc, model-view-controller, validation, data-annotations, model-binding

经过一年左右的 MVC 经验，我仍然对一件事感到困惑：如何有效地将 DataAnnotations 与 ModelState.IsValid 一起使用？对于简单的教程示例，这一切都很好，我对此没有任何疑问。但假设我有以下模型：

```
Public Class Movie

    Public Property MovieID As Integer
    Public Property Title As String
    Public Property Year As Integer
    Public Property AddedByUser As String

End Class 
```

现在数据库中需要字段 AdditionalByUser 但是我不希望用户提供这个，而是基于当前登录用户的业务逻辑。在这种情况下，我将如何使用 DataAnnotation 属性？如果我将这个字段设为必填，那么当我说：

```
 Public Function SaveMovie(ByVal entity as Movie) As ActionResult
    If ModelState.IsValid
       // Save to DB here...
    End If
    Return View(entity)
 End Function 
```

...验证将失败，因为我在视图绑定中没有该字段。我应该为此设置一个隐藏字段吗？我应该为 SaveMovie 操作编写自定义视图模型吗？我想我可以在业务逻辑中编写自己的验证，但是为什么要使用模型验证呢？自定义模型粘合剂也许？处理这些类型的场景的最佳方法是什么？

再举一个示例场景，插入和更新操作与验证之间的区别是什么？对于更新操作，需要对象的主键。但是，插入的情况并非如此。您是否应该仅仅因为这一关键属性而具有用于插入和更新的单独模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-14T12:17:34.837

所以我处理这个的方式是我使用基于 DataAnnotation 的用户输入类型的验证。即验证电子邮件地址、日期、必填字段等。您需要快速“健全性检查”并需要仔细检查用户条目的内容。

我没有在我的数据库控制或我的代码控制的字段上放置任何 DataAnnotations，即主键，您的 [AddedByUser] 属性，因为用户不直接访问这些属性，因此您不必添加验证检查这个。既然你的代码是唯一更新这些属性的东西，为什么要验证它们呢？

对于更多“业务规则”类型验证，我在我的模型上实现了 IValidatableObject，在所有属性级验证成功后，该模型在 MVC 中运行。请注意，如果属性级验证失败，它将不会运行。这是有道理的，因为如果数据是“脏”的，你就不想继续运行更复杂的验证等。

希望这可以帮助 ：）

# asp.net - 每个人都如何存储连接字符串？

> ID：10524397
> 
> 赞同：14
> 
> 时间：2012-05-09T21:32:34.263
> 
> 标签：asp.net, .net, web-config, connection-string

我想知道人们是否可以在源代码控制中的一个项目中发布针对本地数据库和许多开发人员之间的不同连接字符串的持续问题的解决方案？

更具体地说，我说的是一个项目处于源代码控制中并且有许多开发人员每个都有一个本地数据库的问题。每个开发人员都有自己的连接字符串（命名实例、默认实例、机器名、用户名、密码等）。每次签入都会覆盖以前的版本，并且拉取最新版本会导致使用其他人的连接字符串。

那么，人们，您使用哪种解决方案来解决这个问题？额外加分解释为什么他们的解决方案有效，优点和缺点。

**编辑** 请记住，此答案不应仅针对您可以完全控制设置的企业环境。正确的解决方案应该适用于所有人：企业、初创公司和开源开发人员。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-09T22:03:30.763

对我来说，您的问题似乎暗示了两种结果之一：

1.  在 Web.config 文件中指定了一个连接字符串，该字符串足够通用以适用于数据库的所有本地版本。您已经指出，在您无法完全控制的环境中，这不是一个理想的设置。
2.  每个开发人员都需要提供他或她自己的连接字符串，这些连接字符串从未被检入源代码控制。

其他一些人已经涵盖了第一种情况。使用 localhost 并遵循数据库名称的约定。对于选项 2，我建议指定一个不检查到源代码控制的配置源：

```
<configuration>
  <connectionStrings configSource="connectionStrings.config"/>
</configuration> 
```

编辑：

连接字符串.config

```
<connectionStrings>
  <add name="Name" 
    providerName="System.Data.ProviderName" 
    connectionString="Valid Connection String;" />
</connectionStrings> 
```

来自： http: [//msdn.microsoft.com/en-us/library/ms254494 (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms254494(v=vs.80).aspx)

connectionStrings.config 将是您明确从源代码管理中排除的项目根目录中的文件。每个开发人员在本地工作时都需要提供此文件。您的生产连接字符串可以通过构建/部署时的 Web.config 转换来替换。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-09T21:38:44.987

我们所有的开发站的设置都有些相同。

1.  我们对数据库使用集成身份验证，因此不需要存储用户/密码。
2.  每个人都使用默认实例。
3.  由于它们都是本地数据库，因此您可以使用 localhost。
4.  相同的数据库名称

所以一个连接字符串可能最终是：

```
Data Source=localhost;Initial Catalog=TheDatabaseName;Integrated Security=SSPI; 
```

每个人都使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T21:44:16.170

我们有一个在它自己的服务器上运行的测试数据库。它只是每晚从实时服务器实际复制的测试数据。所有开发人员都使用它进行测试。这是真实的数据，但不重要，因为它是一天前的。当然，我们将连接字符串存储在 web.config 中。我有一个从 web.config 获取连接字符串的函数，我只是看看它是否是 localhost 返回测试连接字符串。如果不是，则返回实时连接字符串。这对我们有用。而且我们只是不使用本地数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T21:42:14.240

我见过各种使用的方法。

i）您只维护一个实时连接字符串，开发人员对相关模块进行修改并且从不签入。

ii) app.config 与连接字符串一起维护，就源代码控制而言，它是一个共享文件。

iii) 在调试配置中，连接字符串详细信息从 IDE 在命令行中传递。

# wcf - Windows 2003 服务器上的 wcf 服务 - 用作服务器但不用作使用者/客户端

> ID：10524401
> 
> 赞同：0
> 
> 时间：2012-05-09T21:32:56.033
> 
> 标签：wcf

这是一个非常简单的 wcf 服务。由于我最初的 wcf 服务在那里不起作用，我决定创建一个测试服务。基本上我使用的是默认方法 GetData(int)。

我在 Windows 2003 服务器上托管了这项服务。当我从另一台机器上使用它时效果很好。我使用 Windows 窗体测试应用程序来使用此服务。当我在同一台 ws2003 服务器上运行此表单应用程序并尝试在同一台服务器上使用该服务时，它会引发以下错误：

在 http:// 没有端点监听...

我使用 asp.net 创建了另一个 wcf 客户端，也是 silverlight，没有任何效果。

基本上，它看起来不能使用任何 wcf 服务。

我无法弄清楚可能是什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T17:55:25.280

基本上，这台机器安装了 McAfee 防病毒软件，并阻止了与 aspnet_wp.exe 的 http 通信。完整路径为 c:\windows\microsoft.net\framework\v4.0.30319\aspnet_wp.exe

取消阻止此特定 exe 后一切正常。

# coffeescript - 粗箭头“this”范围

> ID：10524403
> 
> 赞同：3
> 
> 时间：2012-05-09T21:33:05.250
> 
> 标签：coffeescript, scope, this, arrow-functions

考虑这段代码

```
 _bindEvents: ->
  @input.bind 'keyup', =>
    @filter($(this).val())
    if $this .val() is ''
      @clearBtn.hide()
    else
      @clearBtn.show() 
```

我很清楚“@”代表“_this”。所以它引用了父范围，但是如果我需要“内部 this”怎么办。

像这一行：

```
@filter($(this).val()) 
```

编译为：

```
_this.filter($(_this).val()); // $(_this) 
```

我需要这个：

```
_this.filter($(this).val());  // $(this) 
```

有没有办法做到这一点而不使用细箭头并使用 closue (that = this) 手动保存 this 引用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:44:52.300

AFAIK 没有办法做到这一点；我会出于几个原因警告它：

*   **易于理解：**当您使用哈希火箭 ( `=>`) 时，您实际上是在告诉读者您需要/想要保留`this`;的当前值 重新引入第二个`this`混淆了这一点。

*   **未来兼容性：**据我了解，下一个 ECMAScript 规范`=>`将以一种甚至不引入新的`this`. （如果 CoffeeScript 在该功能落地时直接采用新的箭头语法，我不会感到惊讶）

带有显式引用的细箭头最终可能会使事情变得更加清晰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T19:35:10.290

您总是可以使用嵌入式 javascript 破解它：

```
`var second_this = this;`
@filter($(second_this).val()) 
```

# c - c中的客户端和服务器套接字

> ID：10524406
> 
> 赞同：-4
> 
> 时间：2012-05-09T21:33:16.257
> 
> 标签：c, sockets, multiplayer

我似乎无法弄清楚如何在现有套接字之间发送和接收数据。现在我只是想来回发送一个字符串并能够看到它。任何关于我做错了什么的帮助将不胜感激。

问题部分在这里：

```
 char hostm[10];
    printw("you are host!\n");
    printw("Type the number you would like to pick %s: ", req.hostname);//gets row1
    scanw("%s", &hostm);
    printw("%s\n", hostm);

                write( (struct sockaddr *)&req.sa, &hostm, sizeof(hostm));
                char response[80];
                read( (struct sockaddr *)&resp.sa, &response, sizeof(response));

                printw("Response: %s\n", response);
    recvfrom(sock, (void *)&resp, sizeof (matchrequest), 0, (struct sockaddr *)&sa, &fromlen); 
```

和

```
 char response[80];
char response2[80];
read( (struct sockaddr *) &host.sa, &response, sizeof(response));
read( (struct sockaddr *) &req.sa, &response2, sizeof(response2));
printf("\n\nresponse was %s\n%s\n", &response, &response2);
        write( (struct sockaddr *) &req.sa, &response, sizeof(response));
write((struct sockaddr *) &host.sa, &response2, sizeof(response2)); 
```

我也不知道它是否在正确的位置，所以这里是所有代码：

对等体.c

```
#include <ncurses.h>
#include <stdlib.h>
#include <stdio.h>
#include <errno.h>
#include <string.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <unistd.h>
#include <arpa/inet.h>
#include <pthread.h>
#include "match.h"

int sock;
struct sockaddr_in serveraddr;
matchrequest req;
int matched = 0;

void *thread_start(void *args) {
int bytes_sent;
while(!matched) {
    printf("waiting for peers...\n");
    bytes_sent = sendto(sock, &req, sizeof(matchrequest), 0,(struct sockaddr*)&serveraddr, sizeof serveraddr);
    if (bytes_sent < 0) {
        printf("Error sending packet: %s\n", strerror(errno));
        exit(EXIT_FAILURE);
    }
    sleep(3);
}
}
void writeResponse(char * response) {
write(sock, &response, sizeof(response));
}

int main(int argc, char *argv[])
{
pthread_t th;
struct sockaddr_in sa; 

matchrequest resp;
ssize_t recsize;
socklen_t fromlen;

sock = socket(PF_INET, SOCK_DGRAM, IPPROTO_UDP);

if (argc != 3) {
    printf("specify name and game type for this peer!\n");
    return;
}

req.gametype = atoi(argv[2]);
req.state = 0;
strncpy(req.peername, argv[1], 100);

printf("using name: %s\n", req.peername);

memset(&sa, 0, sizeof sa);
sa.sin_family = AF_INET;
sa.sin_addr.s_addr = INADDR_ANY;
sa.sin_port = 0;

if (-1 == bind(sock,(struct sockaddr *) &sa, sizeof(sa)))
{
        perror("error bind failed");
        close(sock);
        exit(EXIT_FAILURE);
}

memset(&serveraddr, 0, sizeof serveraddr);
serveraddr.sin_family = AF_INET;
serveraddr.sin_addr.s_addr = inet_addr("127.0.0.1");
serveraddr.sin_port = htons(7652);
pthread_create(&th, NULL, &thread_start, NULL);

for (;;) 
{
    fromlen = sizeof(sa);
        recsize = recvfrom(sock, (void *)&resp, sizeof (matchrequest), 0, (struct sockaddr *)&sa, &fromlen);
        if (recsize < 0) {
            fprintf(stderr, "%s\n", strerror(errno));
            exit(EXIT_FAILURE);
        }
    if (recsize != sizeof(matchrequest)) {
        fprintf(stderr, "invalid datagram received");
        continue;
    }

    initscr();
        printw("matched with peer %s.  Game can start!\n", resp.peername);

    if(strcmp(resp.hostname, req.peername) == 0)
    {

        char hostm[10];
        printw("you are host!\n");
        printw("Type the number you would like to pick %s: ", req.hostname);//gets row1
        scanw("%s", &hostm);
        printw("%s\n", hostm);

                    write( (struct sockaddr *)&req.sa, &hostm, sizeof(hostm));
                    char response[80];
                    read( (struct sockaddr *)&resp.sa, &response, sizeof(response));

                    printw("Response: %s\n", response);
        recvfrom(sock, (void *)&resp, sizeof (matchrequest), 0, (struct sockaddr *)&sa, &fromlen);

    }
    else
    {
        char peerm[10];
                    printw("you are peer!\n");
                    printw("Type the number you would like to pick %s: ", req.peername);//gets row1
                    scanw("%s", &peerm);
                    printw("%s\n", &peerm);

                    // send to client, transmitted fine
                    write(sock, &peerm, sizeof(peerm));
                    char response[80];
                    read(sock, &response, sizeof(response));
                    // Prints the missing character symbol, and 'random' letters
                    printw("Response: %s\n", response);

    }
    endwin();
}
close(sock); /* close the socket */
return 0;
} 
```

匹配的.c

```
#include <sys/types.h>
 #include <sys/socket.h>
 #include <netinet/in.h>
#include <arpa/inet.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>
#include "match.h"

#define MAX_REQUESTS 100

matchrequest ready[MAX_REQUESTS];
int outsock;

void handlerequest(struct sockaddr_in sa, matchrequest req) {

matchrequest host;
int idx = req.gametype % MAX_REQUESTS;

req.state = READY;
req.sa = sa;

printf("%s on %s:%d requested game type %d \n", req.peername, inet_ntoa(req.sa.sin_addr), req.sa.sin_port, req.gametype);

// if room, place in ready position
if (strncmp(ready[idx].peername, req.peername, 100) == 0) {
    // peer is just checking in
} else if (ready[idx].state == MATCHED) {
    ready[idx] = req;
    printf("%s selected as host.  waiting for peers...\n", req.peername);
    strcpy(req.hostname, req.peername);
} else {
// match with existing peer
    printf("%s matched with existing host\n", req.peername);
    req.state = MATCHED;
    host = ready[idx];
    host.state = HOST;
    ready[idx] = req;
    strcpy(req.hostname, host.peername);
    req.peermove = req.hostmove;
    req.hostmove = req.peermove;

    char response[80];
    char response2[80];
    read( (struct sockaddr *) &host.sa, &response, sizeof(response));
    read( (struct sockaddr *) &req.sa, &response2, sizeof(response2));
    printf("\n\nresponse was %s\n%s\n", &response, &response2);
            write( (struct sockaddr *) &req.sa, &response, sizeof(response));
    write((struct sockaddr *) &host.sa, &response2, sizeof(response2));

 //     read(outsock, &response, sizeof(response));
 //     printf("\n\nresponse was %s\n\n", &response);
 //     write(outsock, &response, sizeof(response));

    printf("sending response to %s at %s:%d\n", host.peername, inet_ntoa(host.sa.sin_addr), host.sa.sin_port);
    sendto(outsock, (void *) &req, sizeof(matchrequest), 0, (struct sockaddr *) &host.sa, sizeof(host.sa));
    printf("sending response to %s at %s:%d\n", req.peername, inet_ntoa(req.sa.sin_addr), req.sa.sin_port);
    sendto(outsock, (void *) &host, sizeof(matchrequest), 0, (struct sockaddr *) &req.sa, sizeof(req.sa));
        fprintf(stderr, "%s\n", strerror(errno));
}
}

int main(void)
{
int sock = socket(PF_INET, SOCK_DGRAM, IPPROTO_UDP);
struct sockaddr_in sa; 
matchrequest req;
ssize_t recsize;
socklen_t fromlen;

outsock = socket(PF_INET, SOCK_DGRAM, IPPROTO_UDP);

memset(&sa, 0, sizeof sa);
sa.sin_family = AF_INET;
sa.sin_addr.s_addr = INADDR_ANY;
sa.sin_port = htons(7652);

if (-1 == bind(sock,(struct sockaddr *)&sa, sizeof(sa)))
{
        perror("error bind failed");
        close(sock);
        exit(EXIT_FAILURE);
} 
for (;;) 
{
    fromlen = sizeof(sa);
        printf ("receiving....\n");

        recsize = recvfrom(sock, (void *)&req, sizeof (matchrequest), 0, (struct sockaddr *)&sa, &fromlen);
        if (recsize < 0) {
            fprintf(stderr, "%s\n", strerror(errno));
            exit(EXIT_FAILURE);
        }
    if (recsize != sizeof(matchrequest)) {
        fprintf(stderr, "invalid datagram received");
        continue;
    }
    handlerequest(sa, req);
}
} 
```

匹配.h

```
 #include <sys/types.h>
 #include <sys/socket.h>
 #include <netinet/in.h>
 #include <arpa/inet.h>

 typedef enum matchstate {MATCHED = 0, READY, HOST} matchstate;

 typedef struct matchrequest {
    matchstate state;
    int gametype;
    char board[4][4];
    char covboard[4][4];
    int player1pts;
    int player2pts;
    int gameover;
    int turn;
    int hostmove;
    int peermove;
    char peername[100];
    char hostname[100];
    struct sockaddr_in sa;
 } matchrequest; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:53:07.667

我认为问题在于`read`并`write`期望文件描述符作为第一个参数，但您完全提供了其他东西。请参阅文档[`write`](http://pubs.opengroup.org/onlinepubs/007904975/functions/write.html)并注意您没有按照应有的方式调用它。另外，我没有阅读您的所有代码，但它似乎会产生很多您不应该忽略的警告。

另请注意，这`read`可能会过早返回，或者在等待更多数据到达时可能会阻塞。您必须自己应对这些情况。

此外，请记住，与 TCP 不同，使用 UDP 并不能保证或确认数据的传递。因此，尽管您的程序已经发送了数据，但它可能会在传输到客户端时丢失。

# mysql - 存储来自 10000 个节点的遥测数据

> ID：10524416
> 
> 赞同：7
> 
> 时间：2012-05-09T21:34:16.413
> 
> 标签：mysql, database, web-services, telemetry

我需要存储每隔几分钟从超过 10000 个节点（可能会增加）生成的遥测数据，每个节点都通过 Internet 将数据提供给服务器进行日志记录。我还需要从 Web 应用程序中查询这些数据。

我在决定什么是最好的存储解决方案时遇到了一些麻烦。

每个节点都有一个唯一的ID，每个变量包都会有一个时间戳。（可能需要由服务器生成）。

遥测数据在同一个数据包中包含所有变量，因此从概念上讲，它可以很容易地存储在单个数据库表中，每个变量有一列。序列号 + 时间戳足以作为密钥。每个遥测数据包的大小为 64 字节，包括设备 ID 和时间戳。所以每年大约 100Gb+。

我希望能够查询数据以获取跨时间范围的变量，并存储这些数据的汇总报告，以便我可以绘制图表。

现在，如何最好地处理这个问题？我对使用 MySQL 非常熟悉，所以我倾向于这个。如果我要使用 MySQL，为每个设备 ID 设置一个单独的表是否有意义？- 这会使查询更快还是拥有 10000 个表会成为问题？

我认为不需要一次性从所有设备中查询变量，但可能需要。或者如果它变得非常大，我应该把它全部放在一个表中并使用 MySQL 集群吗？

还是有更好的解决方案？我一直在寻找一些非关系数据库，但看不到任何完全符合要求或看起来非常成熟的东西。例如，MongoDB 每行会有相当多的大小开销，与 MySQL 相比，我不知道在大时间范围内查询单个变量的值的效率如何。MySQL也已经存在了一段时间并且很健壮。

我还希望它能够轻松复制数据并进行备份。

任何想法或如果有人做过类似的事情，您将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-07-28T18:07:39.273

你看过[时间序列数据库](https://en.wikipedia.org/wiki/Time_series_database)吗？它们专为您所描述的用例而设计，并且由于内置数据折叠和压缩，实际上可能最终在空间要求方面更加高效。

我建议研究使用 HBase 或 Cassandra 进行原始存储的实现，因为它为您提供了经过验证的异步复制功能和吞吐量。

HBase 时间序列数据库：

*   [开放TSDB](http://www.opentsdb.net/)

*   [凯罗斯数据库](https://github.com/kairosdb/kairosdb)

*   [Axibase 时间序列数据库](https://axibase.com/docs/atsd/)- 我的附属机构

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T22:29:53.650

如果您想使用 MySQL，请记住，尽管当您在现代硬件上轻松地每年投入 100GB 之类的东西时它会继续运行，但请注意，您不能在之后执行架构更改（在实时系统上） . 这意味着您必须首先拥有一个良好、完整的数据库模式。

我不知道这个遥测数据是否会增加更多功能，但如果他们这样做了，如果您需要添加列或索引，您不希望将数据库锁定数小时。

但是，现在可以使用一些工具，例如[http://www.percona.com/doc/percona-toolkit/pt-online-schema-change.html](http://www.percona.com/doc/percona-toolkit/pt-online-schema-change.html)，这使得这些更改变得更加容易。只要您继续使用 InnoDB，就不会出现性能问题。

另一种选择可能是使用 PostgreSQL，它允许您在线更改模式，并且有时在使用索引方面更聪明。（例如， http: [//kb.askmonty.org/en/index-condition-pushdown](http://kb.askmonty.org/en/index-condition-pushdown)是 MySQL/MariaDB 的一个新技巧，它允许您在查询时组合两个索引。PostgreSQL 已经这样做了很长时间.)

关于开销：您可能会以未打包的形式存储 64 字节的遥测数据，因此您的记录将在磁盘上占用超过 64 字节的空间。任何类型的结构化存储都会受此影响。

如果您使用 SQL 解决方案，备份很容易：只需转储数据，然后您就可以恢复它。

# java - 当鼠标退出时 SWT MouseMove 监听器

> ID：10524417
> 
> 赞同：1
> 
> 时间：2012-05-09T21:34:19.960
> 
> 标签：java, events, swt

我使用鼠标移动侦听器来处理 SWT 画布上的鼠标移动。但我想要两种行为，一种是鼠标移入画布区域时，另一种是鼠标离开该区域时。

事实上，我真正喜欢做的是在鼠标在该区域时更改光标图标，并在它不在时恢复它。但是我只能在鼠标在该区域时捕获事件。

是否有特定的侦听器来处理 Canvas 上的 Mouse Out 事件？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:37:41.073

您正在寻找一个 MouseTrackListener，它具有进入、退出和悬停元素的方法。请参阅[http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/events/MouseTrackListener.html](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/events/MouseTrackListener.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T21:40:29.180

这就是你要找的：

```
public void mouseExited(MouseEvent e) {
   saySomething("Mouse exited", e);
} 
```

按照这个链接：

[Oracle 鼠标监听器](http://docs.oracle.com/javase/tutorial/uiswing/events/mouselistener.html)

# jquery - jQuery 数组随机索引

> ID：10524420
> 
> 赞同：-1
> 
> 时间：2012-05-09T21:34:25.997
> 
> 标签：jquery, arrays, random

我在 jQuery 中有一个包含 19 个字段的数组，并且想提醒一个随机字段。我在想一些 Math.rand()？

谢谢！

丹尼斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T21:36:34.343

懒惰问题的懒惰答案：

```
alert( arr[(~~(Math.random() * arr.length))] ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T21:37:07.637

就像下面这样使用`Math.random`，

```
var randomnumber = Math.floor(Math.random()* $('selector').length)
//                                                 ^--$('selector').length = 19 
```

# php - 如何让 jQuery Validator 远程触发 errorPlacement？

> ID：10524426
> 
> 赞同：4
> 
> 时间：2012-05-09T21:34:40.310
> 
> 标签：php, jquery, validation

谁能告诉我如何让**[jQuery Validator](http://docs.jquery.com/Plugins/Validation/validate#toptions)**在函数失败时调用**`errorPlacement`**处理程序？**`remote`**我提供了一个简短的例子：

**Cliff Notes：**根据他们的文档，我必须输出 JSON，但我一定遗漏了一些东西，因为我只是回显 json_encode，还是提供了一个密钥，就像`echo json_encode(array('result' => 0))`它在这个**[文本块中](http://docs.jquery.com/Plugins/Validation/Methods/remote#options)**所说的那样。

**JS：**

```
var validator = $("form#signup").validate({
    onfocousout: true,
    rules: {
        email: {
            required: true,
            email: true,
            remote: {
                type: "POST",
                url: 'test.php',
                data: {
                    email: function() {return $("#email").val();}
                }
            }
        },
        errorPlacement: function(error, el) {
            console.log('ERR' + $(el).attr('id'));
        }
    }
}); 
```

**PHP：**

```
<?php
echo false; // This should allow the errorPlacement to call shouldn't it? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-20T15:58:07.737

我认为您需要`false`从 PHP 脚本中以字符串的形式回显：

```
<?php
echo 'false'; 
```

我根据您的问题创建了一个[jsfiddle 。](http://jsfiddle.net/J7swe/)pastebin 链接只返回单词“false”。

# svn - 创建来自另一个 SVN 存储库的文件的外部 SVN 存储库

> ID：10524427
> 
> 赞同：0
> 
> 时间：2012-05-09T21:34:40.643
> 
> 标签：svn, version-control, tortoisesvn

我有*原始*颠覆回购的工作副本。*我想对工作副本中的某些文件进行实验性更改，而不在原始*存储库中进行分支、标记等。

### 目标

*   能够随手点回*原点*。
*   无意将更改合并回*原始*repo 主干。
*   捕获许多离散的“实验”，尽可能少地捕获代码
*   并将其全部排除在*原始*存储库之外。
*   不需要与特定的*原始*repo 版本同步。
*   我希望能够从*原始*repo 的工作副本开始，并以特定文件夹和/或文件为目标以进入*实验性*repo。

### 细节是魔鬼

我知道`external`财产。我认为这是关键，但我一定是误用了乌龟界面，因为我无法解决问题。

*   *从原始*回购的工作副本开始...
*   我已经创建了*实验性*repo 和最小的文件夹结构
*   “签出”到我要试验的文件夹。
*   R-单击/添加目标文件夹。此时乌龟挂起然后中止。
*   R-click/properties 在目标文件夹上，`external`使用本地路径和 URL 创建属性。
*   目标文件夹上的 R-click/Update... 会导致乌龟挂起然后中止。
*   试图“导出”该文件夹以从*原始文件夹中取消版本*
*   注意：我没有对*原始*存储库的管理员级别访问权限。

### 请不要

*   建议我研究 Stack Overflow
*   建议我使用代码库的完整副本创建*实验性存储库。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T14:34:53.730

让我们看看你想要什么。我要给它们编号，以便我以后可以参考它们……

1.  能够随手点回原来的随意。
2.  无意将更改合并回原始 repo 主干。
3.  捕获许多离散的“实验”，尽可能少地捕获代码并将其全部排除在原始存储库之外。
4.  不需要与特定的原始 repo 版本同步。
5.  我希望能够从原始 repo 的工作副本开始，并以特定文件夹和/或文件为目标以进入实验性 repo。

根据＃2，您永远不会将此代码合并到原始代码中。没关系。您可以拥有分支机构，但永远不要对它们做任何事情。根据第 4 点，您甚至不想同步回原始存储库。完成更改后，您将不希望从 repo 中获得更新的内容。

第 1 点和第 3 点让我感到困惑。*能随手点回原点是*什么意思？你的意思是如果必要的话，需要在你的原始仓库中进行更改？而且，你所说的许多离散实验是什么意思？你的意思是你想尝试与原来的改变不同的方向吗？

是什么阻止您检查您的*基本代码*并简单地创建您自己的私有存储库？

您可以通过简单地从您通过创建标记来标记的原始代码库一次又一次地分支来将分支用于您的*许多离散实验。*您只需返回标签即可随意返回*原始状态*。

那行得通吗？

```
$ # First create the experimental repo
$ cd $HOME/my_repo
$ svnadmin create my_repo
$ # Now let's start it up
$ svnserve -r . -d
$ # Now, let's do a checkout and get some work done!
$ mkdir $HOME/my_workspace
$ cd $HOME/my_workspace
$ svn co svn://localhost my_project
$ cd my_project
$ # This is an empty directory. Let's fill it up!
$ svn mkdir trunk tags, branches
$ cd truck
$ # Now, get the revision you want and put it in your repository
$ svn export http://server.com/src/trunk/project .
$ # We have all of the code, let's add it to our repository
$ svn add *
$ cd ..
$ svn commit -m"Original code"   #This is  your original
$ # Now, we'll mark the original, so you can get back to it
$ svn cp -m"Tagging original" svn://localhost/trunk svn://localhost/tags/ORIGINAL 
```

现在，您拥有自己的存储库，因此您的更改不会显示在原始存储库中。`ORIGINAL`而且，您可以通过查找标签返回原始来源。

让我们做三个实验

```
$ svn cp -m"Experiment #1" svn://localhost/tags/ORIGINAL svn://localhost/branches/experiment_1
$ svn cp -m"Experiment #2" svn://localhost/tags/ORIGINAL svn://localhost/branches/experiment_2
$ svn cp -m"Experiment #3" svn://localhost/tags/ORIGINAL svn://localhost/branches/experiment_3 
```

注意到我是如何从我的`ORIGINAL`标签中分支出来的吗？这样，我知道我回到了我的原始代码。请注意，每个实验都使用分支。我可能永远不会在它们之间合并，但这很好。没有什么说你必须从一个分支合并到下一个分支。

而且，完成实验后，您可以随时删除分支：

```
$ svn delete svn://localhost/branches/experiment_1 
```

`svn ls`这仍然在存储库中，但在 HEAD 上执行时您将不再看到它。但是，如果需要，它仍然可以访问。它可以防止杂乱无章的分支，但如果您再次需要它，它仍然可以使用。

所以，不用担心外部因素，只需创建一个新的存储库，导入您的代码，然后玩得开心。

然而，当有人想在我的系统上做这样的事情时，我通常会劝阻它，并给他们一个可以在原始存储库上使用的分支。例如，我可能会给 bob 一个名为`/branches/BOB/trunk`,的目录`branches/BOB/branches` `branches/BOB/tags`。这样，就标明这是 Bob 的私人区域，他可以到处玩耍，为所欲为。同时，Bob 可以一遍又一遍地从 repo 中获取代码，甚至捕获更新的代码。如果很多人想要这样做，我将在初始层次结构中添加一个私有文件夹：

```
/trunk
/branches
/tags
/private 
```

并在 /private 下为每个用户提供自己的目录。我有一个预提交钩子，可以防止用户接触其他用户的代码。通过将所有内容都保存在存储库中，我们拥有了更大的灵活性。用户可以共享代码、进行不同的修订并进行尝试。在主存储库中保留私有实验时，我从来没有遇到过问题。

# mysql - 执行查询语句后从 SQL 中获取 Row 数据

> ID：10524428
> 
> 赞同：0
> 
> 时间：2012-05-09T21:34:44.473
> 
> 标签：mysql, sql

我有一个将数据插入一行的 MYSQL 语句。行 ID 将自动递增。

但是我如何取回插入并执行的那一行数据呢？那行数据应该包括我不知道那是什么的行ID。

我想要整行 $row，而不仅仅是 id。我不知道 id 因为它是自动递增的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:51:55.307

由于您有一个自动递增的 id，您可以使用[LAST_INSERT_ID()](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_last-insert-id)

例如

```
INSERT INTO supportContacts
(type, details)
VALUES
('Twitter', '@sqlfiddle');

SELECT * FROM 
supportContacts 
WHERE id = LAST_INSERT_ID(); 
```

[演示](http://sqlfiddle.com/#!2/9c787/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T21:40:20.917

如果您有一个自动递增的 id 列，则以下内容适用于任何数据库：

```
select *
from table
where id = (select max(id) from table) 
```

在没有其他人插入行的假设下。

在 SQL Server 中，您可以执行以下操作：

```
declare @id int;

insert . . .

select @id = @@Identity;

select *
from table
where id = @id; 
```

请注意，带有@@Identity 的行需要在插入之后立即跟随。

# ruby - 如何使用 Capybara 检查列出的项目是否正确？

> ID：10524434
> 
> 赞同：5
> 
> 时间：2012-05-09T21:35:05.837
> 
> 标签：ruby, capybara

我正在尝试使用 Capybara 来测试列表是否包含正确的项目。例如：

```
<table id="rodents">
  <tr><td class="rodent_id">1</td><td class="rodent_name">Hamster</td></tr>
  <tr><td class="rodent_id">2</td><td class="rodent_name">Gerbil</td></tr>
</table> 
```

此列表**应**包含 id 1 和 2，但**不应**包含 3。

我想要的是这样的：

```
ids = ? # get the contents of each row's first cell
ids.should include(1)
ids.should include(2)
ids.should_not include(3) 
```

**我怎么能做这样的事情？**

我用我发现的几个不满意的解决方案来回答，但我很想看到一个更好的解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-10T01:22:27.957

这是一个稍微简化的表达式：

```
 rodent_ids = page.all('table#rodents td.rodent_id').map(&:text) 
```

从那里，您可以进行比较。

```
 rodent_ids.should include(1)
  rodent_ids.should include(2)
  rodent_ids.should_not include(3) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T21:39:13.197

## 寻找特定的行和 ID

一个糟糕的解决方案：

```
within ('table#rodents tr:nth-child(1) td:nth-child(1)') do
  page.should have_content @rodent1.id
end

within ('table#rodents tr:nth-child(2) td:nth-child(1)') do
  page.should have_content @rodent1.id
end

page.should_not have_selector('table#rodents tr:nth-child(3)') 
```

这既冗长又丑陋，并不是说 id 3 不应该在表中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-09T22:09:04.633

## 将 id 收集到一个数组中

这就是我一直在寻找的：

```
 rodent_ids = page.all('table#rodents td:nth-child(1)').map{|td| td.text} 
```

从那里，我可以做到：

```
 rodent_ids.should include(1)
  rodent_ids.should include(2)
  rodent_ids.should_not include(3) 
```

要不就：

```
 rodent_ids.should eq(%w[1 2]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T21:44:46.533

## 使用`has_table?`

一个糟糕的解决方案：

```
 page.has_table?('rodents', :rows => [
                    ['1', 'Hamster'],
                    ['2', 'Gerbil']   
                  ]
                 ).should be_true 
```

这读起来很清楚，但是：

*   它很脆。如果表结构或文本发生变化，它就会失败。
*   如果失败，它只是说它期望 false 为真；我不知道有一种简单的方法可以将表格的真实外观与预期的外观进行比较，除了`print page.html`
*   该`has_table?`方法[可能会在某个时候被删除](https://groups.google.com/forum/#!msg/ruby-capybara/1pHXUbT3AL8/b0YOih4xP3MJ)

# c# - Windows 窗体中的 MDI 子窗体

> ID：10524436
> 
> 赞同：0
> 
> 时间：2012-05-09T21:35:12.980
> 
> 标签：c#, winforms

我有一个带有标记为 true 的 MDI 容器的表单。此表单是具有子表单的父表单。在子窗体中，我使用此代码以最大化大小加载它。

```
this.WindowState = FormWindowState.Maximized; 
```

我使用此代码显示子表单：

```
Form2 f2 = new Form2();
f2.MdiParent = this;
f2.Show(); 
```

而且子窗体是固定的，因此无法调整大小。但是，但是我禁用了最大化按钮，它会消失并且可以恢复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T21:42:37.840

尝试这个：

```
f2.MinimizeBox = false; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T18:41:54.553

有同样的问题，最终解决问题的是处理 OnMove 事件并重置那里的可见性（即使它们已经设置为 false）。不知道为什么会这样，但它对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T02:39:00.517

你可以试试

```
f2.ControlBox = False; 
```

这可以隐藏MaximumBox 和MinimumBox 但不能隐藏关闭按钮。

# html - 选择 具有两个之间特定属性值的元素 元素也具有特定属性

> ID：10524438
> 
> 赞同：2
> 
> 时间：2012-05-09T21:35:23.493
> 
> 标签：html, xslt, xpath

我正在处理一些非常混乱的 HTML 源内容，并尝试将单个 ol 构造成一个属性（来自源）确定是否应将某些列表项放入自己的子列表中。该列表也分为几个 ol，但我认为可以通过忽略父节点来解决。

来源：

```
<div class="x-popup-text c3" id="POPUP172050488">
  <p>To add multiple balance adjustments:</p>
  <ol>
    <li class="kadov-p-CStep">
      <p class="Step">Check 
      <span class="hcp1">Add to queue</span> at the bottom of the page.</p>
    </li>
    <li class="kadov-p-CStep">
      <p class="Step">At the top of the page, enter the 
      <span class="hcp1">Account</span>. &#160;This is a three-part field:</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">In the first part, select the bank number &#160;from the drop-down list.</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">In the second part, select the application code from the drop-down list.</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">In the third part, enter the account number or click the account search button 
      <img src="../mag_glass_blue_bkgrd.gif" x-maintain-ratio="TRUE" width="16" height="16" border="0" class="hcp2 c1" /> to find it.</p>
    </li>
  </ol>
  <ol start="3">
    <li class="kadov-p-CStep">
      <p class="Step">Enter the start date for the adjustment in the 
      <span class="hcp1">From</span> field or click the calendar button 
      <img src="../calendar.gif" x-maintain-ratio="TRUE" width="16" height="18" border="0" class="hcp2 c2" /> to select the date.</p>
    </li>
    <li class="kadov-p-CStep">
      <p class="Step">Enter the end date for the adjustment in the 
      <span class="hcp1">Through</span> field or click the calendar button 
      <img src="../calendar.gif" x-maintain-ratio="TRUE" width="16" height="18" border="0" class="hcp2 c2" /> to select the date.</p>
    </li>
  </ol>
  <p class="StepText">
  <span class="hcp1">Tip:</span> &#160;The Through date must be the same as or after the From date.</p>
  <ol start="5">
    <li class="kadov-p-CStep">
      <p class="Step">For each balance you want to adjust, do the following:</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">In the table at the bottom of the page, find the appropriate 
      <span class="hcp1">Balance Type</span> for the adjustment.</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">Enter the 
      <span class="hcp1">Amount</span> of the adjustment to the right of the balance type.</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">If you want the adjustment to appear on the customer's statement, check the 
      <span class="hcp1">Print on Statements</span> checkbox that corresponds to the adjustment amount you entered.</p>
    </li>
  </ol>
  <ol start="6">
    <li class="kadov-p-CStep">
      <p class="Step">Click 
      <span class="hcp1">Add</span>.</p>
    </li>
    <li class="kadov-p-CStep">
      <p class="Step">Repeat steps 2 through 7 for each additional adjustment you want to add.</p>
    </li>
    <li class="kadov-p-CStep">
      <p class="Step">Click the 
      <span class="hcp1">View queue</span> link at the bottom of the page to enter the Work Queue and apply the adjustments.</p>
    </li>
  </ol>
</div> 
```

我知道，这是一团糟。

因此，本质上：任何带有@class='kadov-p-CStep' 的 li 都应该是一级 li。任何在下一个 'kadov-p-Step' li 之前带有 @class='kadov-p-CStepBullet' 的后续兄弟 li 都应该进入其新父级下方的从属列表中。

在这里的其他地方，我找到了一个选择节点集交集的公式：

```
$ns1[count(.|$ns2)=count($ns2)] 
```

我试图以自己（可能非常困惑）的方式遵循：

```
 <xsl:for-each select="following::li[contains(./@class,'CStepBullet')][count(.|following-sibling::li[not(contains(./@class,'Bullet'))][1]/preceding-sibling::li[contains(./@class,'CStepBullet')]) = count(following-sibling::li[not(contains(./@class,'Bullet'))][1]/preceding-sibling::li[contains(./@class,'CStepBullet')])] "> 
```

这目前不会在输出 XML 中产生任何结果。我也确信它是不必要的过度设计。

感谢您的关注，并提前为您提供任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T02:12:47.823

**I. 这个 XSLT 1.0 转换**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kFollowing" match="li[@class='kadov-p-CStepBullet']"
  use="generate-id(preceding-sibling::li[@class='kadov-p-CStep'][1])"/>

 <xsl:template match="node()|@*" name="identity">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="li[@class='kadov-p-CStep']">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>

    <xsl:variable name="vFollowing" select="key('kFollowing', generate-id())"/>

    <xsl:if test="$vFollowing">
      <ul>
        <xsl:apply-templates select="$vFollowing" mode="inGroup"/>
      </ul>
    </xsl:if>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="li[@class='kadov-p-CStepBullet']"/>

 <xsl:template match="li[@class='kadov-p-CStepBullet']" mode="inGroup">
  <xsl:call-template name="identity"/>
 </xsl:template>
 </xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<div class="x-popup-text c3" id="POPUP172050488">
  <p>To add multiple balance adjustments:</p>
  <ol>
    <li class="kadov-p-CStep">
      <p class="Step">Check
      <span class="hcp1">Add to queue</span> at the bottom of the page.</p>
    </li>
    <li class="kadov-p-CStep">
      <p class="Step">At the top of the page, enter the
      <span class="hcp1">Account</span>. &#160;This is a three-part field:</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">In the first part, select the bank number &#160;from the drop-down list.</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">In the second part, select the application code from the drop-down list.</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">In the third part, enter the account number or click the account search button
      <img src="../mag_glass_blue_bkgrd.gif" x-maintain-ratio="TRUE" width="16" height="16" border="0" class="hcp2 c1" /> to find it.</p>
    </li>
  </ol>
  <ol start="3">
    <li class="kadov-p-CStep">
      <p class="Step">Enter the start date for the adjustment in the
      <span class="hcp1">From</span> field or click the calendar button
      <img src="../calendar.gif" x-maintain-ratio="TRUE" width="16" height="18" border="0" class="hcp2 c2" /> to select the date.</p>
    </li>
    <li class="kadov-p-CStep">
      <p class="Step">Enter the end date for the adjustment in the
      <span class="hcp1">Through</span> field or click the calendar button
      <img src="../calendar.gif" x-maintain-ratio="TRUE" width="16" height="18" border="0" class="hcp2 c2" /> to select the date.</p>
    </li>
  </ol>
  <p class="StepText">
  <span class="hcp1">Tip:</span> &#160;The Through date must be the same as or after the From date.</p>
  <ol start="5">
    <li class="kadov-p-CStep">
      <p class="Step">For each balance you want to adjust, do the following:</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">In the table at the bottom of the page, find the appropriate
      <span class="hcp1">Balance Type</span> for the adjustment.</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">Enter the
      <span class="hcp1">Amount</span> of the adjustment to the right of the balance type.</p>
    </li>
    <li class="kadov-p-CStepBullet">
      <p class="StepBullet">If you want the adjustment to appear on the customer's statement, check the
      <span class="hcp1">Print on Statements</span> checkbox that corresponds to the adjustment amount you entered.</p>
    </li>
  </ol>
  <ol start="6">
    <li class="kadov-p-CStep">
      <p class="Step">Click
      <span class="hcp1">Add</span>.</p>
    </li>
    <li class="kadov-p-CStep">
      <p class="Step">Repeat steps 2 through 7 for each additional adjustment you want to add.</p>
    </li>
    <li class="kadov-p-CStep">
      <p class="Step">Click the
      <span class="hcp1">View queue</span> link at the bottom of the page to enter the Work Queue and apply the adjustments.</p>
    </li>
  </ol>
</div> 
```

**产生想要的正确结果：**

```
<div class="x-popup-text c3" id="POPUP172050488">
   <p>To add multiple balance adjustments:</p>
   <ol>
      <li class="kadov-p-CStep">
         <p class="Step">Check
      <span class="hcp1">Add to queue</span> at the bottom of the page.</p>
      </li>
      <li class="kadov-p-CStep">
         <p class="Step">At the top of the page, enter the
      <span class="hcp1">Account</span>.  This is a three-part field:</p>
         <ul>
            <li class="kadov-p-CStepBullet">
               <p class="StepBullet">In the first part, select the bank number  from the drop-down list.</p>
            </li>
            <li class="kadov-p-CStepBullet">
               <p class="StepBullet">In the second part, select the application code from the drop-down list.</p>
            </li>
            <li class="kadov-p-CStepBullet">
               <p class="StepBullet">In the third part, enter the account number or click the account search button
      <img src="../mag_glass_blue_bkgrd.gif" x-maintain-ratio="TRUE" width="16"
                       height="16"
                       border="0"
                       class="hcp2 c1"/> to find it.</p>
            </li>
         </ul>
      </li>
   </ol>
   <ol start="3">
      <li class="kadov-p-CStep">
         <p class="Step">Enter the start date for the adjustment in the
      <span class="hcp1">From</span> field or click the calendar button
      <img src="../calendar.gif" x-maintain-ratio="TRUE" width="16" height="18" border="0"
                 class="hcp2 c2"/> to select the date.</p>
      </li>
      <li class="kadov-p-CStep">
         <p class="Step">Enter the end date for the adjustment in the
      <span class="hcp1">Through</span> field or click the calendar button
      <img src="../calendar.gif" x-maintain-ratio="TRUE" width="16" height="18" border="0"
                 class="hcp2 c2"/> to select the date.</p>
      </li>
   </ol>
   <p class="StepText">
      <span class="hcp1">Tip:</span>  The Through date must be the same as or after the From date.</p>
   <ol start="5">
      <li class="kadov-p-CStep">
         <p class="Step">For each balance you want to adjust, do the following:</p>
         <ul>
            <li class="kadov-p-CStepBullet">
               <p class="StepBullet">In the table at the bottom of the page, find the appropriate
      <span class="hcp1">Balance Type</span> for the adjustment.</p>
            </li>
            <li class="kadov-p-CStepBullet">
               <p class="StepBullet">Enter the
      <span class="hcp1">Amount</span> of the adjustment to the right of the balance type.</p>
            </li>
            <li class="kadov-p-CStepBullet">
               <p class="StepBullet">If you want the adjustment to appear on the customer's statement, check the
      <span class="hcp1">Print on Statements</span> checkbox that corresponds to the adjustment amount you entered.</p>
            </li>
         </ul>
      </li>
   </ol>
   <ol start="6">
      <li class="kadov-p-CStep">
         <p class="Step">Click
      <span class="hcp1">Add</span>.</p>
      </li>
      <li class="kadov-p-CStep">
         <p class="Step">Repeat steps 2 through 7 for each additional adjustment you want to add.</p>
      </li>
      <li class="kadov-p-CStep">
         <p class="Step">Click the
      <span class="hcp1">View queue</span> link at the bottom of the page to enter the Work Queue and apply the adjustments.</p>
      </li>
   </ol>
</div> 
```

**说明**：

适当地使用**[键](http://www.w3.org/TR/1999/REC-xslt-19991116#key)**将 any 定义`li[@class='kadov-p-CStepBullet']`为其第一个前面的兄弟的函数`li[@class='kadov-p-CStep']`。此外，正确使用**[模式](http://www.w3.org/TR/1999/REC-xslt-19991116#modes)**。

* * *

**二、XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="node()|@*" mode="#default inGroup">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*" mode="#current"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="ol[1]">
  <xsl:copy>
   <xsl:apply-templates select="@*"/>
   <xsl:for-each-group select="li"
                       group-starting-with="li[@class='kadov-p-CStep']">
     <xsl:apply-templates select="." mode="inGroup"/>
   </xsl:for-each-group>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="li[@class='kadov-p-CStep']">
  <xsl:copy>
    <xsl:apply-templates select="@*|node()"/>

    <xsl:if test="current-group()[2]">
      <ul>
        <xsl:apply-templates select="current-group()[position() gt 1]" mode="inGroup"/>
      </ul>
    </xsl:if>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="li[@class='kadov-p-CStepBullet']"/>
</xsl:stylesheet> 
```

**说明**：

正确使用**[`xsl:for-each-group`](http://www.w3.org/TR/xslt20/#xsl-for-each-group)**具有属性`group-starting-with`和**[`current-group()`](http://www.w3.org/TR/xslt20/#current-group)**功能的指令。此外，适当使用**[模式](http://www.w3.org/TR/xslt20/#modes)**、内置模式`#current`和`#default`模式列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T16:02:12.453

对于我的特定用例，我需要在`<template match="div">`.

键仍然是正确的答案，所以我逐字使用了解决方案样式表的这一部分：

```
 <xsl:key name="kFollowing" match="li[@class='kadov-p-CStepBullet']" use="generate-id(preceding-sibling::li[@class='kadov-p-CStep'][1])"/> 
```

然后，我的 div 模板的这一部分正确处理了 kadov-p-CStepBullet`<li>`元素（我正在将此内容迁移到 DITA）：

```
 <steps>
   <xsl:for-each select="descendant::li[@class='kadov-p-CStep']">
     <xsl:variable name="vFollowing" select="key('kFollowing', generate-id())"/> 
         <step>
           <cmd>
             <xsl:value-of select="."/>
           </cmd>
           <xsl:if test="following-sibling::li[1][@class='kadov-p-CStepBullet']">
             <info>
               <ul>
               <xsl:for-each select="following-sibling::li[$vFollowing]">
                 <li><xsl:value-of select="."/></li>
               </xsl:for-each>
               </ul>
             </info>
           </xsl:if>
         </step> 
```

谢谢！

# utf-8 - 尝试将 UTF-8 兼容性添加到现有配置文件

> ID：10524439
> 
> 赞同：3
> 
> 时间：2012-05-09T21:35:25.367
> 
> 标签：utf-8

这里是我的第一个问题，所以请多多包涵。

我正在使用一些使用专有配置文件的软件（想想 INI 文件）。这些文件在程序启动时加载，数据在运行时使用。数据可以在运行时更改，配置文件本身会在程序关闭时更新。

我们一直在为我们的软件添加新的语言支持，但遇到了问题。当我们在运行时向这些配置文件提供包含非 ASCII 字符的数据时，配置文件无法正确识别它们，因为它们不兼容 UTF-8。

我尝试修改启动时填写的 FILE 对象的创建以使用 ccs=UTF-8 模式，并且我还尝试执行 _setmode(_fileno(fin), _O_U8TEXT); 在 FILE 流打开后调用，但两次尝试都会导致以下断言：

```
File: fgets.c
Line: 75

Expression: ( (_Stream->_flag & _IOSTRG) || 
((_textmode_safe(_fileno(_Stream)) == _IOINFO_TM_ANSI) && 
!_tm_unicode_safe(_fileno(_Stream)))) 
```

更奇怪的是，这种说法似乎源于

```
_VALIDATE_STREAM_ANSI_SETRET(stream, EINVAL, retval, NULL); 
```

fgets.c 中的行，它被#ifndef _UNICODE 块包围，我为我的项目定义了_UNICODE。

任何解决此问题的见解，以便我可以通过 _setmode 或 ccs 模式标志获得 UTF-8 兼容性，我们将不胜感激。

谢谢。

# python - 获取 [@unittest.skipIf 装饰器] 条件的过时值

> ID：10524440
> 
> 赞同：1
> 
> 时间：2012-05-09T21:35:25.383
> 
> 标签：python, unit-testing, decorator

我刚刚遇到了一个问题`@unittest.skipIf(expression)`。好吧，问题是如果我在装饰器中使用变量，在开始测试之前声明并分配一个值，并且在测试期间这个变量的值被改变，效果就是装饰器包含旧值。例如：

```
class Settings(object):
    flag=False
class TestCase(object):

    # during the test variable is changed (in this module or another)
    Settings.flag=True

    @unittest.skipIf(Settings.flag==True)
    def test_something(self):
        ... 
```

的值`Settings.flag`可以在另一个模块或此模块中更改（这无关紧要）。在这两种情况下`Setting.flag==True`，呼叫期间的条件`test_something`仍然采用“假”值，尽管它已经更改为“真”值。这很奇怪，我承认我不明白这种机制是如何工作的。似乎在测试期间无法更改此装饰器中使用的值。也许还有其他一些有趣的方法可以在特定条件下跳过测试，这可能会在测试期间发生变化。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:32:11.237

是的，这是预期的行为。调用函数时会评估函数参数。装饰器是在定义被装饰的函数时调用的函数。因此，在定义装饰函数时会测试该标志。装饰者甚至无法知道测试是什么；它只看到`True`或`False`（或更可能是真实性或虚假性），因此它不能将条件存储起来以供以后评估。

为了`skipIf()`按您的意愿工作，它需要采用函数（例如`lambda: Settings.flag==True`）而不是布尔值。然后，当实际调用装饰函数时，它将能够评估此条件。但它实际上并不是这样工作的。（不过，这可能是一个易于添加的增强功能。）

您可以通过在确定值之前不导入包含单元测试的模块来解决此问题`Settings.flag`。这将推迟测试函数的定义（以及装饰），直到那时，装饰器将可以访问所需的标志值。不知道您的代码结构如何，我不知道这对您是否实用。

此外，有些东西看起来很可疑`Settings.flag==True`......我不能完全理解它...... ;-)

# python - 正则表达式拆分字符串并去除重复字符

> ID：10524453
> 
> 赞同：4
> 
> 时间：2012-05-09T21:37:02.673
> 
> 标签：python, regex

使用 python 我正在解析几个字符串。有时字符串会附加几个分号。

示例字符串：

```
s1="1;Some text"  
s2="2;Some more text;;;;" 
```

附加分号的数量各不相同，但如果有的话，它永远不会少于两个。
以下模式匹配 s1，其中 s2 包含附加的分号。
我该如何重做以删除它们？

```
pat=re.compile('(?m)^(\d+);(.*)') 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-09T21:39:15.893

您可以使用`str.rstrip([chars])`

此方法返回字符串的副本，其中所有字符都已从字符串末尾剥离（默认空白字符）。

例如你可以这样做：

```
s2 = s2.rstrip(";") 
```

[您可以在此处](http://docs.python.org/library/stdtypes.html#str.rstrip)找到更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T21:41:00.677

```
pat = re.compile(r'\d+;[^;]*') 
```

# android - 应用程序在第二次计时器运行时崩溃

> ID：10524455
> 
> 赞同：1
> 
> 时间：2012-05-09T21:37:06.020
> 
> 标签：android, timer, crash, apk

我正在开发一个 Android 应用程序，我想每 30 秒更新一次背景。

我使用了一个计时器，它可以工作，但只有一次！应用程序第二次崩溃。

```
public Timer mTimer = null;    

public void loadColor()
    {
        setContentView(R.layout.color);

        cur_scr = (LinearLayout) findViewById(R.id.colorScreen);
    }

    public void onClick(View v) throws InterruptedException
    {
        int id = v.getId();

        switch (id)
        {
                case R.id.nextColor:
                    loadColor();

                    mTimer = new Timer();

                    mTimer.scheduleAtFixedRate(new TimerTask()
                    {
                      public void run()
                      {
                         Random gen = new Random();
                         cur_scr.setBackgroundColor(Color.argb(255, gen.nextInt(256), gen.nextInt(256), gen.nextInt(256)));
                      }
                    }, 0, 2000);

                    break;
        }
    } 
```

日志猫：

```
05-10 15:46:12.325: W/dalvikvm(346): threadid=9: thread exiting with uncaught exception (group=0x40015560)
05-10 15:46:12.344: E/AndroidRuntime(346): FATAL EXCEPTION: Timer-0
05-10 15:46:12.344: E/AndroidRuntime(346): android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
05-10 15:46:12.344: E/AndroidRuntime(346):  at android.view.ViewRoot.checkThread(ViewRoot.java:2932)
05-10 15:46:12.344: E/AndroidRuntime(346):  at android.view.ViewRoot.invalidateChild(ViewRoot.java:642)
05-10 15:46:12.344: E/AndroidRuntime(346):  at android.view.ViewRoot.invalidateChildInParent(ViewRoot.java:668)
05-10 15:46:12.344: E/AndroidRuntime(346):  at android.view.ViewGroup.invalidateChild(ViewGroup.java:2511)
05-10 15:46:12.344: E/AndroidRuntime(346):  at android.view.View.invalidate(View.java:5279)
05-10 15:46:12.344: E/AndroidRuntime(346):  at android.view.View.setBackgroundDrawable(View.java:7626)
05-10 15:46:12.344: E/AndroidRuntime(346):  at android.view.View.setBackgroundColor(View.java:7516)
05-10 15:46:12.344: E/AndroidRuntime(346):  at com.haxad0x.tools.Core$1.run(Core.java:162)
05-10 15:46:12.344: E/AndroidRuntime(346):  at java.util.Timer$TimerImpl.run(Timer.java:284)
05-10 15:46:14.194: D/AndroidRuntime(346): Shutting down VM
05-10 15:46:14.194: W/dalvikvm(346): threadid=1: thread exiting with uncaught exception (group=0x40015560)
05-10 15:46:14.194: I/Process(346): Sending signal. PID: 346 SIG: 9 
```

请帮我！多谢你们！

* * *

```
 case R.id.nextColor:
            loadColor();

            mTimer = new Timer();

            mTimer.scheduleAtFixedRate(new TimerTask()
            {
              public void run()
              {
                  runOnUiThread(new Runnable()
                  {
                      public void run() {
                         Random gen = new Random();
                         cur_scr.setBackgroundColor(Color.argb(255, gen.nextInt(256), gen.nextInt(256), gen.nextInt(256)));
                      }
                  });
              }
            }, 0, 2000);

            break; 
```

代码以这种方式工作。我只有一个问题：它是一个长代码吗？我是说; 它会因为所有空隙而影响性能吗？我可以缩短它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:57:36.440

很可能在您的活动被销毁后您的计时器仍然存在，并且您的视图不再存在（导致 findViewById 失败），并且您可以看到不同的视图。

您需要做的是在 onDestroy 中停止该活动的计时器。

将您的计时器变量创建为类级别变量，也许是 mTimer.. 所以你会有

```
public class YourActivity extends Activity {
  private Timer mTimer = null;

  public void onCreate(Bundle state) {
    //setContentView
    mTimer = new Timer();
    mTimer.scheduleAtFixedRate(new TimerTask()
    {
      public void run()
      {
         Random gen = new Random();
         cur_scr = (LinearLayout) findViewById(R.id.colorScreen);
         cur_scr.setBackgroundColor(Color.argb(255, gen.nextInt(256), gen.nextInt(256), gen.nextInt(256)));
      }
    }, 0, 30000);
  } 

  public void onDestroy() {
    mTimer.cancel();
  }
} 
```

-- 更新 -- 虽然我仍然同意您应该进行上述更改，但看起来 TimerTask 是在一个新线程（而不是主 UI 线程）中运行的。您需要在 UI 线程上运行与 UI 配合使用的任何代码。像这样使用[Activity.runOnUiThread](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)：

```
mTimer.scheduleAtFixedRate(new TimerTask()
{
      public void run()
      {
         Random gen = new Random();
         runOnUiThread(new Runnable() {
            @Override
            public void run() {
               //actually you should probably put a try catch around the code below so it doesn't crash your app if somehow the view isn't found any longer.. It should work as long as you remove the timer task on onDestroy but to be safe i would put a try catch in.
               cur_scr = (LinearLayout) findViewById(R.id.colorScreen);
               cur_scr.setBackgroundColor(Color.argb(255, gen.nextInt(256), gen.nextInt(256), gen.nextInt(256)));
            }
         });

      }
} 
```

还有另一种使用 Handler 可能更容易做到这一点的方法。

我会这样做：

```
public class YourActivity extends Activity {
  private static final int BG_CHANGE_INTERVAL = 30 * 1000;
  private Handler mHandler = null;
  private Runnable mUpdateBgRunnable = new Runnable() {
    Random gen = new Random();
    @Override
    public void run() {
      cur_scr = (LinearLayout) findViewById(R.id.colorScreen);
      cur_scr.setBackgroundColor(Color.argb(255, gen.nextInt(256), gen.nextInt(256), gen.nextInt(256)));
      updateBg();
    }

  }
  public void onCreate(Bundle state) {
    //setContentView
    mHandler = new Handler();
    updateBg();
  } 

  private void updateBg() {
     mHandler.removeCallbacks(mUpdateBgRunnable);
     mHandler.postDelayed(mUpdateBgRunnable, BG_CHANGE_INTERVAL);
  }

  public void onDestroy() {
    mTimer.cancel();
  }
} 
```

有关处理程序与计时器的更多信息，请参阅[本文](http://developer.android.com/resources/articles/timed-ui-updates.html)。

# postgresql - PostgreSQL 9.1 流式复制 restore_command：退出代码 255 的特殊含义？

> ID：10524458
> 
> 赞同：2
> 
> 时间：2012-05-09T21:37:28.283
> 
> 标签：postgresql, database-replication, postgresql-9.1

我在 Ubuntu 10.04.2 LTS（主要和备用）上有一个 PostgreSQL 9.1.3 流复制设置。使用流式基本备份 ( [`pg_basebackup`](http://www.postgresql.org/docs/9.1/static/warm-standby.html)) 初始化复制。该[`restore_command`](http://www.postgresql.org/docs/9.1/static/archive-recovery-settings.html#RESTORE-COMMAND)脚本尝试使用 .从远程存档位置获取所需的 WAL 存档`rsync`。

当 restore_command 脚本失败并出现退出代码 <> 255 时，一切都像[文档中描述的那样工作：](http://www.postgresql.org/docs/9.1/static/warm-standby.html)

> 启动时，备用数据库首先恢复存档位置中所有可用的 WAL，调用 restore_command。一旦到达那里可用的 WAL 的末尾并且 restore_command 失败，它就会尝试恢复 pg_xlog 目录中可用的任何 WAL。如果失败，并且已经配置了流式复制，则备用服务器会尝试连接到主服务器并从存档或 pg_xlog 中找到的最后一条有效记录开始流式传输 WAL。如果失败或未配置流复制，或者如果连接稍后断开，则备用数据库将返回步骤 1 并再次尝试从存档中恢复文件。这个从归档、pg_xlog 和通过流复制的重试循环继续进行，直到服务器停止或由触发器文件触发故障转移。

但是，当 restore_command 脚本以退出代码 255 失败（因为脚本返回失败的 rsync 调用的退出代码）时，服务器进程因以下错误而死：

```
2012-05-09 23:21:30 CEST - @  LOG:  database system was interrupted; last known up at     2012-05-09 23:21:25 CEST
2012-05-09 23:21:30 CEST - @  LOG:  entering standby mode
rsync: connection unexpectedly closed (0 bytes received so far) [Receiver]
rsync error: unexplained error (code 255) at io.c(601) [Receiver=3.0.7]
2012-05-09 23:21:30 CEST - @  FATAL:  could not restore file "00000001000000000000003D" from archive: return code 65280
2012-05-09 23:21:30 CEST - @  LOG:  startup process (PID 8184) exited with exit code 1
2012-05-09 23:21:30 CEST - @  LOG:  aborting startup due to startup process failure 
```

所以我现在的问题是：这是一个错误，还是退出代码 255 的特殊含义在其他优秀的文档中缺失，或者我在这里遗漏了其他东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:51:57.850

在主服务器上，您`WAL`的目录中有文件`pg_xlog/`。当`WAL`文件在那里时，PostgreSQL 能够在需要时将它们传送到备用数据库。

通常，您也有本地存档`WAL`位置，当 PostgreSQL 将文件移动到那里时，它们不再可以在线传递到备用数据库，备用数据库希望它们来自存档`WAL`位置，通过`restore_command`.

如果您`WAL`在主服务器和备用服务器上的存档设置位置不同，那么暂时无法到达备用服务器，并且您有一个间隙。

在您的情况下，这可能意味着：

*   `00000001000000000000003D`已被主 PostgreSQL 归档；
*   备用`restore_command`服务器从配置的源位置看不到它。

`scp`您可以考虑使用或手动将丢失的 WAL 文件从主数据库复制到备用数据库`rsync`。还可能需要检查您的`WAL`位置并确保两台服务器的方向相同。

* * *

**编辑：** `grep` -ing for `restore_command`in 来源，仅`access/transam/xlog.c`引用它。在功能`RestoreArchivedFile`几乎结束时（9.1.3 源的第 3115 行），检查是否`restore_command`正常退出或是否收到信号。

在第一种情况下，消息被分类为`DEBUG2`。如果`restore_command`收到其他信号`SIGTERM`（并且我猜无法正确处理它），`FATAL`将报告错误。这适用于所有大于 125 的代码。

不过，我无法告诉你为什么。
我建议在[黑客名单](http://archives.postgresql.org/pgsql-hackers/)上询问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-27T07:19:43.393

这看起来像是我使用 NFS 临时遇到的 rsync 问题（在端口 837 上使用 rpcbind/rstatd）：

```
$ rsync -avz /var/backup/* backup@storage:/data/backups
rsync: connection unexpectedly closed (0 bytes received so far) [sender]
rsync error: unexplained error (code 255) at io.c(600) [sender=3.0.6] 
```

这为我修复了它：

```
service rpcbind stop 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-08T13:39:34.423

我在创建热备用（postgres 9.5）时遇到了同样的问题。流式传输正在工作（我通过 pg_basebackup 使用与稍后将在备用数据库的 recovery.conf 中使用的凭据相同的凭据为备用数据库播种）。

完成基本备份后，我设置了以下 recovery.conf：

```
standby_mode = 'on'
primary_conninfo = 'host=ip.of.master port=5432 user=pgstandby password=password'
recovery_target_timeline = 'latest'
restore_command = 'sftp -q user@ip.of.wal.archive.host:data/master_wal_archive/%f "%p"'
trigger_file = '/srv/pgsql/9.5/data/trigger' 
```

启动服务器会产生：

```
2016-03-08 12:34:58.981 UTC  (/)LOG:  database system was interrupted; last known up at 2016-03-08 12:26:10 UTC
Couldn't read packet: Connection reset by peer
2016-03-08 12:34:59.525 UTC  (/)FATAL:  could not restore file "00000002.history" from archive: child process exited with exit code 255
2016-03-08 12:34:59.526 UTC  (/)LOG:  startup process (PID 26636) exited with exit code 1
2016-03-08 12:34:59.526 UTC  (/)LOG:  aborting startup due to startup process failure 
```

如果我从 recovey.conf 中删除了 restore_command 行，则备用服务器启动正常并开始从主服务器流式传输 WAL。

我最终将问题追溯到没有将备用 postgres 用户的公钥添加到 WAL 归档主机的 authorized_hosts 文件中。我还忘记将 WAL 存档主机的服务器指纹添加到备用 postgres 用户的 known_hosts 文件中。

这两个错误（我假设）导致 sftp restore_command 以代码 255 退出。正如 tscho 所说，Postgres 文档建议如果 restore_command 以任何非零值退出，Postgres 将继续尝试从 master 流式传输而不是拒绝开始。实际上，如果退出代码高于某个数字（可能是 125，正如 vyegorov 的源代码 grepping 所暗示的那样？），情况似乎并非如此。

一旦我修复了这两个 SSH 问题，备用服务器就可以使用 recovery.conf 中的 restore_command 正常启动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-25T15:48:39.077

这是描述为什么选择命令进程的高退出状态的这种行为的注释，以及实现它的当前代码。

```
 /*
     * Remember, we rollforward UNTIL the restore fails so failure here is
     * just part of the process... that makes it difficult to determine
     * whether the restore failed because there isn't an archive to restore,
     * or because the administrator has specified the restore program
     * incorrectly.  We have to assume the former.
     *
     * However, if the failure was due to any sort of signal, it's best to
     * punt and abort recovery.  (If we "return false" here, upper levels will
     * assume that recovery is complete and start up the database!) It's
     * essential to abort on child SIGINT and SIGQUIT, because per spec
     * system() ignores SIGINT and SIGQUIT while waiting; if we see one of
     * those it's a good bet we should have gotten it too.
     *
     * On SIGTERM, assume we have received a fast shutdown request, and exit
     * cleanly. It's pure chance whether we receive the SIGTERM first, or the
     * child process. If we receive it first, the signal handler will call
     * proc_exit, otherwise we do it here. If we or the child process received
     * SIGTERM for any other reason than a fast shutdown request, postmaster
     * will perform an immediate shutdown when it sees us exiting
     * unexpectedly.
     *
     * Per the Single Unix Spec, shells report exit status > 128 when a called
     * command died on a signal.  Also, 126 and 127 are used to report
     * problems such as an unfindable command; treat those as fatal errors
     * too.
     */
    if (WIFSIGNALED(rc) && WTERMSIG(rc) == SIGTERM)
        proc_exit(1);

    signaled = WIFSIGNALED(rc) || WEXITSTATUS(rc) > 125;

    ereport(signaled ? FATAL : DEBUG2,
            (errmsg("could not restore file \"%s\" from archive: %s",
                    xlogfname, wait_result_to_str(rc)))); 
```

# c# - IEXPLORE.exe 出现奇怪的 ProcessorAffinity 问题

> ID：10524465
> 
> 赞同：1
> 
> 时间：2012-05-09T21:37:53.150
> 
> 标签：c#, multithreading, internet-explorer

我需要启动 IE 并将关联设置为特定的单个 CPU。运行以下 c# 代码时，正如预期的那样，notepad.exe 已启动并且其关联设置为仅 cpu2，奇怪的是 iexplore.exe 启动时其关联设置为仅 cpu0。无论我将 ProcessorAffinity 设置为什么，iexplore.exe 总是转到 cpu0。

我已经在 4 核 xp 32 位和 4 核 2008 64 位 IE8 上对此进行了测试。

```
using System;
using System.Diagnostics;
public class Launch
{

    public static void Main(string[] args)
    {
        lauchWithAffinity("c:/windows/system32/notepad.exe");
        lauchWithAffinity("c:/Program Files/Internet Explorer/IEXPLORE.EXE");
    }
    static void lauchWithAffinity(string exePath)
    {
        ProcessStartInfo start = new ProcessStartInfo();
        start.FileName = exePath;
        Process myProcess =Process.Start(start);
        myProcess.ProcessorAffinity = (System.IntPtr)4; //3rd cpu aka cpu2 
        //http://msdn.microsoft.com/en-us/library/system.diagnostics.process.processoraffinity.aspx
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T08:44:01.077

我已经测试了你的程序，它对我来说很好。我什至检查了任务管理器，并且将其关联`iexplore.exe`设置为 CPU 2。

# php - php synatax 这些是做什么的？'^' 和 '|'

> ID：10524468
> 
> 赞同：-1
> 
> 时间：2012-05-09T21:38:19.203
> 
> 标签：php, syntax, operands

在 php 中，以下操作数如何工作？

^ |

例如`$a = 11; $b = 7; echo $a ^ $b;`

输出 12

和

```
 $a =    11;
$b =    7;
echo $a | $b; 
```

输出 15

我不知道为什么在每种情况下。有人可以阐明一下吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T21:41:49.540

这些是按位[XOR](http://en.wikipedia.org/wiki/Bitwise_operation#XOR)和[OR](http://en.wikipedia.org/wiki/Bitwise_operation#OR)。

```
$a = 11; // 1011
$b =  7; // 0111 
```

通过**异或**，每个不同`$a`的位`$b`变成一个`1`，相同的位变成一个`0`。

```
$a ^ $b: // 1100 = 12 
```

与**OR**中的每个位都是 a`1`或成为 a `$a`，在这种情况下是所有位。`$b``1`

```
$a | $b: // 1111 = 15 
```

还有一个**AND**等价物：`$a & $b: // 0011 = 3`

[PHP 的位运算符的完整列表](http://php.net/manual/en/language.operators.bitwise.php)[。](http://en.wikipedia.org/wiki/Full_stop)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T21:39:37.563

它们是按位运算符。

[http://php.net/manual/en/language.operators.bitwise.php](http://php.net/manual/en/language.operators.bitwise.php)

基本上这些用于二进制数据。这些经常用于在一个整数中组合一系列标志。例如，如果我有两个标志：

```
FLAG1 = (binary)'1' = (integer)1
FLAG2 = (binary)'10' = (integer)2 
```

我可以使用按位运算符将两者结合起来：

```
$combined_flags = FLAG1 | FLAG2 = (binary)'11' = (integer)3 
```

然后我可以检查是否使用按位运算符设置了一个标志：

```
if ($combined_flags & FLAG1) echo 'flag 1 is set to true.'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T21:44:43.283

它们是按位运算符，这意味着它们对二进制数进行运算。

`11`是`1011`二进制的，并且`7`是`0111`.

`^`是`XOR`。对于两个值中的每一位，如果它们不同，则返回 1。

```
11 ^ 7 = 1011 ^ 0111 = 1100 = 12 
```

`|`是`OR`。对于两个值中的每一位，如果至少有一个为 1，则返回 1。

```
11 | 7 = 1011 | 0111 = 1111 = 15 
```

更多信息： http: [//php.net/manual/en/language.operators.bitwise.php](http://php.net/manual/en/language.operators.bitwise.php)

# c# - 序列化列表 带有父标签的基类

> ID：10524470
> 
> 赞同：2
> 
> 时间：2012-05-09T21:38:21.973
> 
> 标签：c#, .net, serialization

我似乎能够在网上找到试图避免这种行为的人，但我似乎无法获得我想要的行为。

我有一个动物列表，我想为每种动物类型使用不同的标签对它们进行序列化（与带有附加属性的默认行为相反）

为了获得这种行为，我使用以下代码

```
 [XmlElementAttribute(Order = 4)]
    [XmlElement("Frog", typeof(Frog))]
    [XmlElement("Cat", typeof(Cat))]
    [XmlElement("Dog", typeof(Dog))]
    public List<Animal> lines = new List<Animal>(); 
```

效果很好，除了它会使列表变平，如果 xml 输出更像保留标签，我更 `<animals> <Dog>Bob</Dog> <Cat>Fred</Cat> <Dog>Mike</Dog> </animals>` 喜欢`<animals>`它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T23:25:47.120

更改`[XmlElementAttribute(Order = 4)]`为`[XmlArrayAttribute(Order=4)]`

您还可以`ElementName`在属性中指定一个参数，该参数将是根名称，即：`[XmlArrayAttribute(Order=4, ElementName="animals")]`

**注意：Order=4 是针对这种情况的。你通常不需要它。**

**编辑：（感谢OP评论）：**

您还必须将属于列表的对象的类的属性从更改`[XmlElement]`为`[XmlArrayItem]` [(MSDN doc here)](http://msdn.microsoft.com/en-us/library/3z6zh05s.aspx)，如下所示：

```
[XmlArrayItem("Frog", typeof(Frog))]
[XmlArrayItem("Cat", typeof(Cat))]
[XmlArrayItem("Dog", typeof(Dog))] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:03:41.307

您始终可以将列表包装在其自己的类中，并且您将获得您期望的 XML：

```
public class StackOverflow_10524470
{
    public class Animal
    {
        [XmlText]
        public string Name { get; set; }
    }
    public class Dog : Animal { }
    public class Cat : Animal { }
    public class Frog : Animal { }
    public class Root
    {
        [XmlElementAttribute(Order = 4, ElementName = "animals")]
        public Animals animals;
    }
    public class Animals
    {
        [XmlElementAttribute(Order = 4)]
        [XmlElement("Frog", typeof(Frog))]
        [XmlElement("Cat", typeof(Cat))]
        [XmlElement("Dog", typeof(Dog))]
        public List<Animal> lines = new List<Animal>();
    }
    public static void Test()
    {
        MemoryStream ms = new MemoryStream();
        XmlSerializer xs = new XmlSerializer(typeof(Root));
        Root root = new Root
        {
            animals = new Animals
            {
                lines = new List<Animal> 
                { 
                    new Dog { Name = "Fido" },
                    new Cat { Name = "Fluffy" },
                    new Frog { Name = "Singer" },
                }
            }
        };
        xs.Serialize(ms, root);
        Console.WriteLine(Encoding.UTF8.GetString(ms.ToArray()));
    }
} 
```

# javascript - ajax 加载后刷新 DOM 元素

> ID：10524471
> 
> 赞同：2
> 
> 时间：2012-05-09T21:38:27.680
> 
> 标签：javascript, ajax, dom, refresh

这是我遇到的问题的简要说明：

我从

```
<container>
    <div id="foo"></div>
</container> 
```

`div`然后我使用 Ajax将内容加载到容器中

```
<container>
    <div id="bar"></div>
</container> 
```

然后重新加载原件

```
<container>
    <div id="foo"></div>
</container> 
```

但是我不能再`#foo`使用javascript作为目标，因为javascript认为它是一个新元素

实际代码显然要复杂得多，我需要在 ajax 加载后刷新整个 DOM，以便我可以使用之前存在的几个元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-28T21:41:00.927

（在评论和问题编辑中回答的问题。转换为社区 wiki 答案。请参阅[没有答案的问题，但问题在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

OP写道：

> 出现问题是因为我正在创建一个将元素作为变量的对象，所以当我再次调用该变量时，它所代表的实际元素不再存在，只是一个具有相同 id 的元素
> 
> 解决了：
> 
> 感谢@felix 在评论中的建议，我意识到这样做的方法是获取存储在对象变量中的元素的 id，并使用它来定位 ajax 加载的内容中的新元素：
> 
> 我的对象变量是从原始内容创建的：`playlist.trackdiv`它代表元素`div#track1`
> 
> `div`当我稍后通过 ajax加载它时，它`playlist.trackdiv`不再代表`div#track1`，而是具有相同 id 的元素的全新实例。解决方案是使用像这样的对象的 id `playlist.trackdiv.i`d 然后使用它来定位新元素：`document.getElementById(playlist.trackdiv.id)`

# javascript - 从经度和纬度google api获取邮政编码

> ID：10524474
> 
> 赞同：2
> 
> 时间：2012-05-09T21:38:40.250
> 
> 标签：javascript, jquery, ajax, google-maps

我只需要知道如何从经度和纬度中获取邮政编码。

我使用谷歌地图 api 基于诸如“曼彻斯特”之类的搜索来获取经纬度，然后我需要从中获取邮政编码来查询我的数据库。

到目前为止我的代码是

```
function getLatLng()
{
    var localSearch = new google.maps.Geocoder();
    var postcode = $("#address").val();
    localSearch.geocode({ 'address': postcode },
                    function(results, status) {
                        if (results.length == 1) {
                            var result = results[0];
                            var location = result.geometry.location;
                        }
                        else 
                        {
                            $("#error").html("Address not found");
                        }
                    });
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T21:42:39.477

你想要做的是（一个例子）'反向地理编码'

请参阅： [Google 反向地理编码 - 如何捕捉到最近的完整邮政编码](https://stackoverflow.com/questions/9689692/google-reverse-geocoding-how-to-snap-to-nearest-full-postcode)

具体链接到：

[https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-reverse](https://google-developers.appspot.com/maps/documentation/javascript/examples/geocoding-reverse)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T09:02:13.363

> .. 搜索诸如“曼彻斯特”，然后我需要一个来获取邮政编码..

您可能需要考虑：-

世界上不止一个“曼彻斯特”。

英国的“曼彻斯特”被许多邮政编码覆盖；如果查询过于笼统，地理编码可能只给你其中一个，或者一个都不给。

显然，由于邮局许可问题，退回的英国邮政编码可能是零碎的——只有最重要的部分被退回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T07:57:27.030

首先，您应该知道，当您搜索“曼彻斯特”时，您可以获得邮政编码以及经纬度。查看[这部分文档](https://developers.google.com/maps/documentation/geocoding/#Geocoding)。查看[您从谷歌获得的回复](https://developers.google.com/maps/documentation/geocoding/#Results)，您可以从中获取邮政编码。

或者，如果您想运行另一个查询以从您拥有的坐标中获取邮政编码（这似乎没有用，因为正如我所说，您可以在一次调用 API 中执行此操作），您可以按照 Geert-Jan 的建议进行反向地理编码.

# ruby - 如何检测缩写中使用的'和引号之间的区别

> ID：10524475
> 
> 赞同：3
> 
> 时间：2012-05-09T21:38:40.653
> 
> 标签：ruby, regex, parsing

我正在尝试解析文本块，并且需要一种方法来检测不同上下文中撇号之间的差异。拥有和缩写在一组中，在另一组中的引用。

例如

> “我是汽车的所有者”-> [“我是”、“该”、“汽车”、“所有者”]

但

> “他说‘你好’” -> [“他”，“说”，“你好””]

检测两边的空白将无济于事，因为像“'ello”和“cars'”这样的东西会被解析为引号的一端，与匹配的撇号对相同。我感觉除了极其复杂的 NLP 解决方案之外别无他法，我将不得不忽略任何没有出现在单词中间的撇号，这将是不幸的。

编辑：

自从写作以来，我意识到这是不可能的。任何基于正则表达式的解析器都必须解析：

> “你好，我的伙伴们”的狗

以两种不同的方式，并且只能在理解句子的其余部分的情况下做到这一点。猜猜我赞成忽略最不可能的情况并希望它足够罕见而只会导致不常见的异常的不雅解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T17:58:29.900

使用非常简单的两阶段过程。

在 pass 1 of 2 中，从这个正则表达式开始，将文本分解为单词和非单词字符的交替段。

```
/(\w+)|(\W+)/gi 
```

将匹配项存储在这样的列表中（我使用的是 AS3 样式的伪代码，因为我不使用 ruby​​）：

```
class MatchedWord
{
    var text:String;
    var charIndex:int;
    var isWord:Boolean;
    var isContraction:Boolean = false;
    function MatchedWord( text:String, charIndex:int, isWord:Boolean )
    {
        this.text = text; this.charIndex = charIndex; this.isWord = isWord;
    }
}
var match:Object;
var matched_word:MatchedWord;
var matched_words:Vector.<MatchedWord> = new Vector.<MatchedWord>();
var words_regex:RegExp = /(\w+)|(\W+)/gi
words_regex.lastIndex = 0; //this is where to start looking for matches, and is updated to the end of the last match each time exec is called
while ((match = words_regex.exec( original_text )) != null)
    matched_words.push( new MatchedWord( match[0], match.index, match[1] != null ) ); //match[0] is the entire match and match[1] is the first parenthetical group (if it's null, then it's not a word and match[2] would be non-null) 
```

在 pass 2 of 2 中，遍历匹配列表以通过检查每个（修剪的、非单词）匹配是否以撇号结尾来查找缩写。如果是，则检查下一个相邻（单词）匹配，看它是否匹配仅有的 8 个常见收缩结尾之一。尽管我能想到所有的两部分收缩，但只有 8 个共同的结尾。

```
d
l
ll
m
re
s
t
ve 
```

一旦您确定了这样的一对匹配项 (non-word)="'" 和 (word)="d"，那么您只需包含前面的相邻 (word) 匹配项并将三个匹配项连接起来即可得到您的收缩。

了解刚刚描述的过程，您必须进行的一项修改是扩展该收缩结尾列表以包括以撇号开头的收缩，例如“'twas”和“'tis”。对于那些，您根本不连接前面的相邻（单词）匹配，并且您更仔细地查看撇号匹配以查看它之前是否包含其他非单词字符（这就是为什么它以撇号结尾很重要）。如果修剪后的字符串等于撇号，则将其与下一个匹配项合并，如果它仅以撇号结尾，则剥离撇号并将其​​与下一个匹配项合并。同样，包含先前匹配的条件应首先检查以确保以撇号结尾的（修剪的非单词）匹配等于撇号，

您可能需要进行的另一项修改是扩展 8 个词尾的列表，以包括诸如“g'day”和“g'night”之类的整个词的词尾。同样，这是一个简单的修改，涉及对前面（单词）匹配的条件检查。如果它是“g”，那么你包括它。

该过程应该捕获大多数收缩，并且足够灵活，可以包含您能想到的新收缩。

数据结构看起来像这样。

```
Condition(Ending, PreCondition) 
```

前提条件是

```
"*", "!", or "<exact string>" 
```

最终的条件列表如下所示：

```
new Condition("d","*") //if apostrophe d is found, include the preceding word string and count as successful contraction match
new Condition("l","*");
new Condition("ll","*");
new Condition("m","*");
new Condition("re","*");
new Condition("s","*");
new Condition("t","*");
new Condition("ve","*");
new Condition("twas","!"); //if apostrophe twas is found, exclude the preceding word string and count as successful contraction match
new Condition("tis","!");
new Condition("day","g"); //if apostrophe day is found and preceding word string is g, then include preceding word string and count as successful contraction match
new Condition("night","g"); 
```

如果你只是按照我解释的那样处理这些条件，那应该涵盖所有这 86 个收缩（以及更多）：

> 这不是 不是 不能 不能 不能 不能 不能 不是 不是 每个人的日子他是如何 我会 我会 我会 我会不会她会 她会 她应该会 不应该 那会't what''d 为什么会为什么不会

在旁注中，不要忘记不使用撇号的俚语收缩，例如“gotta”>“got to”和“gonna”>“going to”。

这是最终的 AS3 代码。总体而言，您只需不到 50 行代码即可将文本解析为交替的单词和非单词组，并识别和合并缩略语。简单的。您甚至可以在 MatchedWord 类中添加一个布尔“isContraction”变量，并在识别出收缩时在下面的代码中设置标志。

```
//Automatically merge known contractions
var conditions:Array = [
    ["d","*"], //if apostrophe d is found, include the preceding word string and count as successful contraction match
    ["l","*"],
    ["ll","*"],
    ["m","*"],
    ["re","*"],
    ["s","*"],
    ["t","*"],
    ["ve","*"],
    ["twas","!"], //if apostrophe twas is found, exclude the preceding word string and count as successful contraction match
    ["tis","!"],
    ["day","g"], //if apostrophe day is found and preceding word string is g, then include preceding word string and count as successful contraction match
    ["night","g"]
];
for (i = 0; i < matched_words.length - 1; i++) //not a type-o, intentionally stopping at next to last index to avoid a condition check in the loop
{
    var m:MatchedWord = matched_words[i];
    var apostrophe_text:String = StringUtils.trim( m.text ); //check if this ends with an apostrophe first, then deal more closely with it
    if (!m.isWord && StringUtils.endsWith( apostrophe_text, "'" ))
    {
        var m_next:MatchedWord = matched_words[i + 1]; //no bounds check necessary, since loop intentionally stopped at next to last index
        var m_prev:MatchedWord = ((i - 1) >= 0) ? matched_words[i - 1] : null; //bounds check necessary for previous match, since we're starting at beginning, since we may or may not need to look at the prior match depending on the precondition
        for each (var condition:Array in conditions)
        {
            if (StringUtils.trim( m_next.text ) == condition[0])
            {
                var pre_condition:String = condition[1];
                switch (pre_condition)
                {
                    case "*": //success after one final check, include prior match, merge current and next match into prior match and delete current and next match
                        if (m_prev != null && apostrophe_text == "'") //EQUAL apostrophe, not just ENDS with apostrophe
                        {
                            m_prev.text += m.text + m_next.text;
                            m_prev.isContraction = true;
                            matched_words.splice( i, 2 );
                        }
                        break;
                    case "!": //success after one final check, do not include prior match, merge current and next match, and delete next match
                        if (apostrophe_text == "'")
                        {
                            m.text += m_next.text;
                            m.isWord = true; //match now includes word text so flip it to a "word" block for logical consistency
                            m.isContraction = true;
                            matched_words.splice( i + 1, 1 );
                        }
                        else
                        {   //strip apostrophe off end and merge with next item, nothing needs deleted
                            //preserve spaces and match start indexes by manipulating untrimmed strings
                            var apostrophe_end:int = m.text.lastIndexOf( "'" );
                            var apostrophe_ending:String = m.text.substring( apostrophe_end, m.text.length );
                            m.text = m.text.substring( 0, m.text.length - apostrophe_ending.length); //strip apostrophe and any trailing spaces
                            m_next.text = apostrophe_ending + m_next.text;
                            m_next.charIndex = m.charIndex + apostrophe_end;
                            m_next.isContraction = true;
                        }
                        break;
                    default: //conditional success, check prior match meets condition
                        if (m_prev != null && m_prev.text == pre_condition)
                        {
                            m_prev.text += m.text + m_next.text;
                            m_prev.isContraction = true;
                            matched_words.splice( i, 2 );
                        }
                        break;
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T21:52:11.613

嗯，恐怕这并不容易。这是一个有点作用的正则表达式，唉，只适用于“I'm”和“I've”之类的东西：

```
>> s1 =~ /[\w\s]*((?<!I)'(?:[^']+)')[\w\s]*/
=> nil
>> s2 =~ /[\w\s]*((?<!I)'(?:[^']+)')[\w\s]*/
=> 0
>> $1
=> "'hello there'" 
```

如果你多玩一点，你也许可以消除一些其他常见的宫缩，但总比没有好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T04:35:24.073

需要考虑的一些规则：

*   引号将以带有空格字符的撇号开头，或者在它之前没有任何内容。
*   引号将以带标点符号的撇号或后面的空格字符结尾。
*   有些词可能看起来像引号的结尾，例如，`peoples'`。
*   引号分隔的撇号永远不会在它们之前和之后直接有字母。

# regex - 使用 sed 在句号后插入空格

> ID：10524476
> 
> 赞同：2
> 
> 时间：2012-05-09T21:38:41.567
> 
> 标签：regex, macos, sed

我有一堆文件的句子结尾是这样的：`\@.Next sentence`. 我想在句号之后插入一个空格。

然而，并非所有出现的`\@.`都没有空格，所以我的正则表达式检查句点之后的下一个字符是否是大写字母。

因为我在句号之后检查一个字符，所以我不能只对`\@.`to进行替换`\@.`，而且因为我不知道句号后面是什么字符，所以我被卡住了。

我目前的命令：

```
sed -i .bak -E 's/\\@\.[A-Z]/<SOMETHING IN HERE>/g' *.tex 
```

如何获取匹配字符串的最后一个字母以在替换正则表达式中使用？

编辑：为了记录，我使用的是`sed`（我正在使用 OS X）的 BSD 版本 - 从我[之前关于 的问题`sed`](https://stackoverflow.com/questions/9525834/pre-pend-word-to-the-last-word-of-a-line)来看，显然 BSD sed（或至少是 Apple 版本）并不总是与 GNU sed常用表达。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:51:45.307

正确的命令应该是这样的：

```
sed -i.bak -E "s/\\\@.(\S)/\\\@. \1/g" *.tex 
```

有了它，你匹配任何`\@`后跟非空格（`\S`）并插入一个空格（通过将整个匹配替换为`'\@ '`加上刚刚找到的非空格）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:14:36.507

使用这个 sed 命令：

```
sed -i.bak -E 's/(\\@\.)([A-Z])/\1 \2/g' *.tex 
```

或更好：

```
sed -i.bak -E 's/(\\@\.)([^ \t])/\1 \2/g' *.tex 
```

`\@.`如果后面**没有任何空白字符**（不仅仅是大写字母），它将插入空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T00:07:32.910

这可能对您有用：

```
sed -i .bak -E 's/\\@\. \?/\\@. /g' *.tex 
```

解释：

如果有空格，则用空格替换，否则插入空格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T21:43:20.990

我认为以下是正确的：

```
s/\\@\.[^\s]/\\@. /g 
```

仅当表达式后面没有空格时才替换它。

# meteor - 查询被另一个查询过滤时的反应更新

> ID：10524482
> 
> 赞同：3
> 
> 时间：2012-05-09T21:39:19.920
> 
> 标签：meteor

我今天才开始使用流星，似乎无法弄清楚我做错了什么。我有一个在发布函数内部运行的查询，但是这个查询被另一个查询的结果过滤了。

简而言之，当我将文档添加到正在发布的数据库（CollectionTwo）时，它会按预期工作，但是当我在用于过滤的数据库（CollectionOne）中进行更改时，meteor 不会做出反应.

```
CollectionOne = new Meteor.Collection("one")
CollectionTwo = new Meteor.Collection("two")

Meteor.publish("items", ->
  not_hidden = CollectionOne.find().fetch()
  return CollectionTwo.find( _id: {'$in':( t.my_id for t in not_hidden )} )
) 
```

同时，在客户端...

```
CollectionOne = new Meteor.Collection("one")
CollectionTwo = new Meteor.Collection("two")

Meteor.subscribe("items")

_.extend( Template.items,
  items: ->
    not_hidden = CollectionOne.find().fetch()
    return CollectionTwo.find( _id: {'$in':( t.my_id for t in not_hidden )} )
) 
```

任何想法可能是适当的解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T23:46:15.037

`Meteor.publish`反应性在服务器内部不起作用。`CollectionTwo.find`当内容发生`CollectionOne`变化时， Meteor 不会重新计算查询。

要实现您想要的，请手动管理发布，而不仅仅是返回光标。您需要`observe`在您的发布函数内部使用来观察 上的更改`CollectionOne`，然后手动调用`this.set`并将`this.unset`更改推送到客户端。[发布文档](http://docs.meteor.com/#meteor_publish)中有一个这种技术的例子。该示例仅查看一个集合，但您可以将这个想法扩展到一组嵌套的观察。

我们将致力于糖，以使这种模式更容易实现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-25T00:18:41.287

在核心流星中有更好的模式之前，这两个大气包解决了这个问题：

[https://atmosphere.meteor.com/package/server-deps](https://atmosphere.meteor.com/package/server-deps)

[https://atmosphere.meteor.com/package/reactive-publish](https://atmosphere.meteor.com/package/reactive-publish)

使用陨石安装第二个包，使用“Meteor.reactivePublish”而不是“Meteor.publish”，当任何带有选项{“reactive”：true}的查询结果发生变化时，它将自动更新。

自述文件中的这个示例将准确发布用户团队可以看到的那些项目，并在用户更改团队或团队的可见项目更改时更新。

```
Meteor.reactivePublish(null, function() {
  if (this.userId) {
    var user = Meteor.users.findOne({_id: this.userId}, {reactive: true});
    if (user.team) {
      var team = Collections.teams.findOne({_id: user.team}, {reactive: true});
      var visibleItems = _.compact(team.visibleItems);
      return Collections.items.find({_id: {$in: visibleItems}});
    }
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-03T12:08:46.500

您可以使用[reactive-publish](https://github.com/peerlibrary/meteor-reactive-publish)包（我是作者之一）：

```
Meteor.publish "items", ->
  @autorun (computation) =>
    not_hidden = CollectionOne.find({}, {fields: my_id: 1}).fetch()
    CollectionTwo.find _id: $in: _.pluck not_hidden, 'my_id' 
```

重要的是将查询的字段从 限制`CollectionOne`为 only `my_id`，否则`autorun`将在`CollectionOne`文档中的任何字段更改时重新运行，而不仅仅是`my_id`.

# php - Doctrine2：单表继承中的父类应该是抽象的吗？

> ID：10524483
> 
> 赞同：1
> 
> 时间：2012-05-09T21:39:20.443
> 
> 标签：php, orm, doctrine-orm

我正在为我的类在 Doctrine2 应用程序中编写构造函数，比如说 Fruits、Apple、Bananas。

`Fruits`是父类，其中`Apples`并`Bananas`继承`Fruits`自在 field 上使用单表继承`type`。

在 Doctrine2 文档页面上，有一个为单表继承提供的示例。如果我们总是使用单表继承进行区分，那么基类是否应该`Fruits`是抽象的，因为必须始终设置鉴别器字段？如果是这样，构造函数是否`Fruits`也应该受到保护以防止这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T13:22:37.577

由于您的父类“Fruits”中没有您需要重新声明的方法，我认为没有明确需要将其声明为抽象。

此外，您可能会发现一个用例，您可能希望保留“水果”的实例（不确定它是什么类型的水果）。将父级标记为摘要将阻止您执行此操作。

也许水果就是一个不好的例子。但是他们在文档中的 Person 示例更好。员工将继承 Person 定义。但我可能还想只保留一个未确定类型的 Person 实例。因此@DiscriminatorMap 中的“person” = “Person”。

[http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/inheritance-mapping.html#single-table-inheritance](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.0.x/reference/inheritance-mapping.html#single-table-inheritance)

# c# - 使用响应式框架观察线程安全集合

> ID：10524487
> 
> 赞同：1
> 
> 时间：2012-05-09T21:39:38.440
> 
> 标签：c#, multithreading, c#-4.0, system.reactive

这将归结为一个相当高层次的问题。我有一个大型数据集，需要（独立地）验证每一行。我想使用 Parallel.Foreach，并在该行上调用验证方法。假设此方法是线程安全的。如果验证返回错误，我需要使用此错误更新数据行。我显然不能从后台线程执行此操作。但是，我不确定实现此错误处理的最佳方法是什么。我实现这一点的想法是将行 ID 和错误存储在 BlockingCollection 中，因为这对于编写来说是线程安全的。然后我会不断地轮询（从后台线程），当后台线程找到数据时，调用表单并更新当前行。

我想知道是否有更简单的方法来做到这一点，使用反应式框架？基本上，我需要一个多生产者线程安全集合，它可以被“观察”，当一个新值被添加到集合中时，“OnNext”将在主线程上执行——这可能吗？理想情况下，我还可以控制这种情况发生的频率（比如每 2-3 秒一次，这样主线程上的回调每 2-3 秒就会更新多行），所以我不会经常调用主线程。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T18:14:08.370

这对你有什么影响：

```
IObservable<bool> ValidateAsync(Row item)
{
    return Observable.Start(() => {
        // TODO: Figure out if the row is valid
        return true;
    }, Scheduler.TaskPoolScheduler);
}

myBigDataTable.ToObservable()
    .Select(x => ValidateAsync(x).Select(y => new { Row = x, IsValid = y }))
    .Merge(10 /* rows concurrently */)
    .ObserveOn(SynchronizationContext.Current /*assuming WinForms */)
    .Subscribe(x => {
        Console.WriteLine("Row {0} validity: {1}", x.Row, x.IsValid);
    }); 
```

没有锁，没有愚蠢的容器，没有阻塞，100% 线程安全。

# html - 在 IE7 中堆积

> ID：10524489
> 
> 赞同：0
> 
> 时间：2012-05-09T21:39:41.760
> 
> 标签：html

我在水平显示 li 时遇到问题。我通过论坛阅读并尝试了几个建议的解决方案，但没有帮助。我在这里附上我的代码，有人可以帮我水平显示这个导航（并且跨浏览器兼容）。

这是我的代码：

> nav.PgHdrMenu{ 高度：35px; 浮动：对；a{ 文字装饰：无；字母间距：-1px；颜色：@darkGrey；padding-right: 6px;"

```
&:hover{
  color: @mainColor;
    }
 }

 ul{
padding-top:10px;
width:100%;
float:right;

li{
   list-style-type: none;
   float: right;
   margin-left: 5px;
   display: block; 

a{
  text-decoration: none;
  color: #f1f1f1;
  padding: 7px;
  border-right: 1px solid #1686a2;
  background: #1686a2;
  background: -webkit-gradient(linear, left top, left bottom, from(#1686a2), to(@darkGrey)); 
  background: -moz-linear-gradient(top,  #1686a2,  @darkGrey);
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#1686a2', endColorstr='@darkGrey', GradientType=0);

-moz-border-radius:5px;
    -webkit-border-radius:5px;
border-radius:5px;

     &:hover{
   background: #1686a2;
   background: -webkit-gradient(linear, left top, left bottom, from(@darkGrey), to(#1686a2)); 
   background: -moz-linear-gradient(top,  @darkGrey, #1686a2);
   filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='@darkGrey', endColorstr='#1686a2', GradientType=0);
    color:@lightGrey;
    }
}

     &:last-child > a{// get rid of last right-margin
 border: none;
        }
}
 } 
```

HTML标签：

```
<nav class=PgContentMenu >
<ul>
  <li>
    <a href="index.html">Home</a>
  </li>
  <li>
    <a href="about.html">About Us</a>
  </li>
  <li>
    <a href="product.html">Products</a>
  </li>
 </ul>
</nav> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:48:11.020

您确实忘记使用`}`.

例如：

```
ul{
padding-top:10px;
width:100%;
float:right; 
```

无效，因为您没有关闭`{`您打开的定义 ul 元素的样式。改成：

```
ul
{
    padding-top:10px;
    width:100%;
    float:right;
} 
```

检查所有定义，您确实忘记关闭其中的大部分。我希望我能给你一个小建议：我们都忘记关闭一个开放的大括号（即使没有深度嵌套），这就是为什么一个好的缩进可以帮助你避免这些错误。此外，如果您将左括号单独放在一行上（就像在我的第二个示例中一样），您会以更清晰的方式看到该*块。*这只是编码风格，但它可能会节省大量时间，并且会让你的*代码*更清晰（这是 90% 的个人品味）。

# java - 在 Restlet/GAE 中发回压缩的 JSON

> ID：10524491
> 
> 赞同：2
> 
> 时间：2012-05-09T21:39:51.183
> 
> 标签：java, google-app-engine, gzip, restlet

我正在 GAE 上编写一个 Restlet 应用程序，如下所述： [第一个应用程序](http://wiki.restlet.org/docs_2.2/13-restlet/21-restlet/318-restlet/303-restlet.html)

我正在发回一个实体的 JSON 表示，这很有效。但到目前为止，我未能成功发送压缩响应。

我尝试添加以请求带有“gzip”的接受编码标头。但这没有帮助。这是我测试它的方法：

```
URL url = new URL(address);
URLConnection urlConn = url.openConnection();
urlConn.setRequestProperty("Accept-Encoding", "gzip");
InputStream openStream = urlConn.getInputStream(); 
```

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T05:05:17.110

我相信您还需要指定 User-Agent 标头来强制压缩。从文档：

[https://developers.google.com/appengine/docs/python/runtime#Responses](https://developers.google.com/appengine/docs/python/runtime#Responses)

> 如果客户端在请求中发送 HTTP 标头，表明客户端可以接受压缩（gzipped）内容，App Engine 会自动压缩响应数据并附加适当的响应标头。它使用 Accept-Encoding 和 User-Agent 请求标头来确定客户端是否可以可靠地接收压缩响应。自定义客户端可以通过将 Accept-Encoding 和 User-Agent 标头指定为“gzip”来强制压缩内容。

# macos - OSX Applescript - 指定通用本地用户目录

> ID：10524499
> 
> 赞同：3
> 
> 时间：2012-05-09T21:40:31.427
> 
> 标签：macos, applescript

我正在寻找一个将在我们办公室运行的applescript，并将选择的文件复制到同事用户/同事用户名/图书馆/应用程序支持/adobe/cameraraw 目录。是否有通用别名，以便我可以将文件复制到当前用户库是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:50:34.753

你可以使用这样的东西：

```
set adobeCameraRawFolderPath to (((path to application support from user domain)
                    as string) & "Adobe:CameraRaw:") as alias 
```

获取 POSIX 路径：

```
set posixAdobeCameraRawFolderPath to POSIX path of adobeCameraRawFolderPath 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T21:47:24.883

您可以使用标准的 Unix 快捷方式来访问用户的主文件夹：

```
set path_ to "~/Library/Application Support/..." 
```

前面`~`是用户家目录的简写（相当于`$HOME`环境变量）

# linux-kernel - 在Linux中如何检索进行系统调用的进程的pid

> ID：10524500
> 
> 赞同：3
> 
> 时间：2012-05-09T21:40:36.953
> 
> 标签：linux-kernel

我试图了解系统调用在 Linux 内核中是如何工作的。我的一个问题是，如何检索进行系统调用的进程的 pid？

例如，我正在查看我认为在**fs/read_write.c**中`read()`定义为的调用（同步读取）

 **```
ssize_t do_sync_read(struct file *filp, char __user *buf, size_t len, loff_t *ppos) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-09T21:51:49.227

在系统调用上下文（这是调用进程的上下文）中，您可以检查`current`类型为`struct task_struct`this的全局变量，该变量包含`pid`您可以从中获取 pid 的字段。

只需`current->pid`获取您所在的当前任务上下文的 pid。

我假设您的意思是内核中定义的系统调用的实际代码。**

# javascript - CFcookie 在各种浏览器中表现怪异

> ID：10524503
> 
> 赞同：0
> 
> 时间：2012-05-09T21:41:01.143
> 
> 标签：javascript, cookies, coldfusion

所以下面的代码在 Firefox 中完美运行

```
<!--Cookies-->
<cfset timer = createTimeSpan(0,3,0,0)>
<cfcookie name = "user.ID" value = "#userID#" expires="#timer#">               <!--this will expire in three hours -->
<cfcookie name = "user.Site" value = "#userSite#" expires="#timer#">
<cfcookie name = "user.Sess" value = "#userSess#" expires="#timer#">
<cfcookie name = "user.FName" value = "#userFName#" expires="#timer#">
<cfcookie name = "user.LName" value = "#userLName#" expires="#timer#">
<cfcookie name = "user.Email" value = "#userEmail#" expires="#timer#">
<cfcookie name = "user.SiteFirst" value = "#userSiteFirst#" expires="#timer#">
<cfcookie name = "user.RoundsTotal" value = "#userRoundsTotal#" expires="#timer#">
<cfcookie name = "user.RoundsCurrent" value = "#userRoundsCurrent#" expires="#timer#">

<!-- And now we send the user off to wait.cfm where they will wait --->
<!-- Users will not head to choose their picture choice --->

<script type="text/javascript">
    location.href='picChoice.cfm';
</script> 
```

在 Firefox 中，所有 cookie 中的值都可以完美传递。任何其他浏览器，所有 cookie 均为空。

希望有人能在我看不到的地方看到错误。如果您想查看完整的 cfm，可以在此处进行：http: [//pastebin.com/4G4wvjLd](http://pastebin.com/4G4wvjLd)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T21:57:41.620

我认为你有一个负载问题 - 在完成 cookie 操作之前重定向浏览器。将您的 location.href 更改为 cflocation 或将其放入主体“onLoad()”事件中（或使用 jquery 的 load 事件来处理浏览器重定向的细微差别）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T10:48:59.117

代码对我来说看起来不错。我在这里运行它，使用 cookie 名称作为 cookie 值，例如，cookie 已正确设置并在 IE 和 Chrome 中通过 OK。Cookie 规范（由 Netscape 早先编写）中存在一些漏洞，导致某些浏览器在某些情况下做的事情略有不同。我推荐两件事：

1) 简化正在发送的值。就我而言，我使用 cookie 名称作为 cookie 值，它似乎可以工作。我会做与测试相同的操作，只需在 picChoice.cfm 中执行 cfdump #cookie#（这就是我在此处的测试页面中所做的）

2) 使用 fiddler 作为代理运行请求并观察浏览器获取和发送的内容，以确保您的代码确实发送了 set-cookie 标头并查看浏览器发送回服务器的内容。

# image - 悬停或单击时更改按钮图像

> ID：10524508
> 
> 赞同：4
> 
> 时间：2012-05-09T21:41:55.357
> 
> 标签：image, xaml, button, windows-8, windows-runtime

如何在悬停和单击时更改按钮的背景图像？Visual Studio 的 UI 似乎没有提供任何简单的方法来做到这一点。目前，默认行为似乎将我的图像替换为纯色，这看起来很棒。

到目前为止，我只有 Button 基础：

```
 <Button Content="" Height="75" VerticalAlignment="Center" Width="75" HorizontalAlignment="Center" ClickMode="Press">
        <Button.Background>
            <ImageBrush ImageSource="../data/images/icons/skill_icon_0.png"/>
        </Button.Background>
    </Button> 
```

我试图处理事件并手动设置它，但它不适用于 Pressed/Released：

```
 Button skillButton = new Button();
        skillButton.Width = 75;
        skillButton.Height = 75;
        skillButton.ClickMode = ClickMode.Press;
        skillButton.Background = GetIconImage(iconIndex, 0);
        skillButton.PointerEntered += 
            (object sender, Windows.UI.Xaml.Input.PointerEventArgs e) => {
                skillButton.Background = GetIconImage(iconIndex, 1);
            };
        skillButton.PointerExited +=
            (object sender, Windows.UI.Xaml.Input.PointerEventArgs e) => {
                skillButton.Background = GetIconImage(iconIndex, 0);
            };
        skillButton.PointerPressed +=
            (object sender, Windows.UI.Xaml.Input.PointerEventArgs e) => {
                skillButton.Background = GetIconImage(iconIndex, 2);
            };
        skillButton.PointerReleased +=
            (object sender, Windows.UI.Xaml.Input.PointerEventArgs e) => {
                if (skillButton.FocusState == FocusState.Pointer)
                    skillButton.Background = GetIconImage(iconIndex, 1);
                else skillButton.Background = GetIconImage(iconIndex, 0);
            }; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T03:34:26.327

我最终编辑 ControlTemplate 只是为了创建和更改边框。但它也可以用来改变图像。

```
 <Button Width="75" Height="75" ClickMode="Press">
        <Button.Template>
            <ControlTemplate TargetType="Button">
                <Border x:Name="RootElement" CornerRadius="10" BorderThickness="2">
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup x:Name="CommonStates">
                            <VisualStateGroup.Transitions>
                                <VisualTransition To="MouseOver" GeneratedDuration="0:0:0.1"/>
                                <VisualTransition To="Pressed" GeneratedDuration="0:0:0.1"/>
                            </VisualStateGroup.Transitions>
                            <VisualState x:Name="Normal" />
                            <VisualState x:Name="MouseOver">
                                <Storyboard>
                                    <ColorAnimation Storyboard.TargetName="BorderBrush" 
                                                    Storyboard.TargetProperty="Color" 
                                                    To="Yellow" />
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Pressed">
                                <Storyboard>
                                    <ColorAnimation Storyboard.TargetName="BorderBrush" 
                                                    Storyboard.TargetProperty="Color"
                                                    To="Black"/>
                                </Storyboard>
                            </VisualState>
                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                    <Border.BorderBrush>
                        <SolidColorBrush x:Name="BorderBrush" Color="White"/>
                    </Border.BorderBrush>
                    <Border.Background>
                        <ImageBrush ImageSource="ms-appx:/data/images/icons/skill_icon_0.png"/>
                    </Border.Background>
                </Border>
            </ControlTemplate>
        </Button.Template>
    </Button> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-02T17:27:27.137

你几乎在那里。您始终可以在文本/内容下方的图片顶部应用半透明颜色，但由于您要求更改整个图像，因此您可以执行以下操作：

在 Visual Studio 2012 中，如果您已经有一个大部分样式/配置为您想要的按钮，请右键单击它，编辑模板 -> 编辑副本。选择要放置新样式/模板的位置。这就像选择放置 CSS 的位置。可能位于全局文件（App.xaml 或 StandardStyle.xaml）中，也可能位于标头（页面资源）或内联（控制资源）中。

下面的 XAML 可能过于简化并且不起作用，但这是它的想法：

```
<ControlTemplate x:Key="MyButton" TargetType="Button">
    <Grid>
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="CommonStates">
                <VisualState x:Name="Normal" />
                <VisualState x:Name="PointerOver">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="HoverBackground"
                            Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="Visible" />
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
                <VisualState x:Name="Pressed">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="PressedBackground"
                            Storyboard.TargetProperty="Visibility">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="Visible" />
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
                [...]
            </VisualStateGroup>
            <VisualStateGroup x:Name="FocusStates">
                [...]
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
        <Border x:Name="Border" [...]>
            <Grid>
                <Image Source="[...]" Stretch="None" />
                <Image x:Name="HoverBackground" Source="[...]" Visibility="Collapsed" />
                <Image x:Name="PressedBackground" Source="[...]" Visibility="Collapsed" />
                <ContentPresenter x:Name="ContentPresenter"
                Content="{TemplateBinding Content}"
                ContentTransitions="{TemplateBinding ContentTransitions}"
                ContentTemplate="{TemplateBinding ContentTemplate}"
                Margin="{TemplateBinding Padding}"
                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                VerticalAlignment="{TemplateBinding VerticalContentAlignment}" 
                    [...]/>
            </Grid>
        </Border>
        [...]
    </Grid>
</ControlTemplate> 
```

现在您可以将 3 个图像放在 3 个`<Image>`标签中，并且由于 ContentPresenter 在顶部，当您使用带有 的模板时`<Button Template="{StaticResource MyButton}">`，您仍然可以放入内容，它会出现在背景图像的顶部。或者您也可以只使用带有图像的全图形按钮。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-28T18:47:55.500

Windows UI XAML 工具包现在具有以下功能：

[图像按钮和切换图像按钮](http://blogs.msdn.com/b/pakistan/archive/2013/02/14/an-overview-of-ui-controls-from-win-rt-xaml-toolkit.aspx)

在 Visual Studio 2012 中使用包管理器控制台命令“Install-Package winrtxamltoolkit”来安装工具包......它对很多事情都非常有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-09T01:42:39.477

这是一种样式，可以打开和关闭您在 Blend 中添加的一些额外图像的可见性。这些图像是透明的，并且通过使用“Send to Back”在按钮背景图像后面。换句话说，您可以继续为每个按钮使用不同的背景图像画笔，以及交换的 Normal、Pointer 和 Pressed 图像。所以两个背景图像重叠。

```
 <Style x:Key="qButtonStyle" TargetType="Button">
    <Setter Property="Background" Value="{StaticResource ButtonBackgroundThemeBrush}" />
    <Setter Property="Foreground" Value="{StaticResource ButtonForegroundThemeBrush}" />
    <Setter Property="BorderBrush" Value="{StaticResource ButtonBorderThemeBrush}" />
    <Setter Property="BorderThickness" Value="{StaticResource ButtonBorderThemeThickness}" />
    <Setter Property="Padding" Value="4" />
    <Setter Property="HorizontalAlignment" Value="Left" />
    <Setter Property="VerticalAlignment" Value="Center" />
    <Setter Property="FontFamily" Value="{StaticResource ContentControlThemeFontFamily}" />
    <Setter Property="FontWeight" Value="SemiBold" />
    <Setter Property="FontSize" Value="{StaticResource ControlContentThemeFontSize}" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Button">
                <Grid x:Name="grid">
                    <VisualStateManager.VisualStateGroups>
                        <VisualStateGroup x:Name="CommonStates">
                            <VisualState x:Name="Normal" >
                                <Storyboard>
                                    <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="imageNormal" d:IsOptimized="True"/>
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="PointerOver">

                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.BorderBrush)" Storyboard.TargetName="Border">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Null}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.BorderThickness)" Storyboard.TargetName="Border">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <Thickness>0</Thickness>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="imageNormal">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Collapsed</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="imagePressed">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Collapsed</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                    <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="imagePointer" d:IsOptimized="True"/>
                                </Storyboard>

                            </VisualState>
                            <VisualState x:Name="Pressed">
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background"
                                        Storyboard.TargetName="Border"/>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground"
                                        Storyboard.TargetName="ContentPresenter"/>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(Border.BorderBrush)" Storyboard.TargetName="Border">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Null}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(Shape.Fill)" Storyboard.TargetName="FocusVisualWhite">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <SolidColorBrush Color="#7F006400"/>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(Shape.Fill)" Storyboard.TargetName="FocusVisualBlack">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <SolidColorBrush Color="#7F006400"/>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                    <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="imagePressed" d:IsOptimized="True"/>
                                    <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="imagePointer" d:IsOptimized="True"/>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="imageNormal">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Collapsed</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="imagePointer">
                                        <DiscreteObjectKeyFrame KeyTime="0">
                                            <DiscreteObjectKeyFrame.Value>
                                                <Visibility>Collapsed</Visibility>
                                            </DiscreteObjectKeyFrame.Value>
                                        </DiscreteObjectKeyFrame>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Disabled">
                                <Storyboard>
                                    <DoubleAnimation Duration="0" To="0.25" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="grid" d:IsOptimized="True"/>
                                </Storyboard>
                            </VisualState>
                        </VisualStateGroup>
                        <VisualStateGroup x:Name="FocusStates">
                            <VisualState x:Name="Focused">
                                <Storyboard>
                                    <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity"
                                        Storyboard.TargetName="FocusVisualWhite" />
                                    <DoubleAnimation Duration="0" To="1" Storyboard.TargetProperty="Opacity"
                                        Storyboard.TargetName="FocusVisualBlack" />
                                </Storyboard>
                            </VisualState>
                            <VisualState x:Name="Unfocused" />
                            <VisualState x:Name="PointerFocused" />
                        </VisualStateGroup>
                    </VisualStateManager.VisualStateGroups>
                    <Image x:Name="imagePointer" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Source="ms-appx:///Assets/btnBGPointer.png" Opacity="0"/>
                    <Image x:Name="imagePressed" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Source="ms-appx:///Assets/btnBGPressed.png" Opacity="0"/>
                    <Image x:Name="imageNormal" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Source="ms-appx:///Assets/bgButtonBase.png"/>
                    <Border x:Name="Border"
                        Background="{TemplateBinding Background}" Margin="3">
                        <ContentPresenter x:Name="ContentPresenter"
                            ContentTemplate="{TemplateBinding ContentTemplate}"
                            ContentTransitions="{TemplateBinding ContentTransitions}"
                            Content="{TemplateBinding Content}"
                            HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                            Margin="{TemplateBinding Padding}"
                            VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                    </Border>
                    <Rectangle x:Name="FocusVisualWhite" IsHitTestVisible="False" Opacity="0"
                        StrokeDashOffset="1.5" StrokeEndLineCap="Square"
                        Stroke="{StaticResource FocusVisualWhiteStrokeThemeBrush}" StrokeDashArray="1,1" />
                    <Rectangle x:Name="FocusVisualBlack" IsHitTestVisible="False" Opacity="0"
                        StrokeDashOffset="0.5" StrokeEndLineCap="Square"
                        Stroke="{StaticResource FocusVisualBlackStrokeThemeBrush}" StrokeDashArray="1,1" />
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-09T23:23:42.393

在按钮上的 Pointer_Entered 事件中使用此代码，它将起作用:)

```
 private void Button_PointerEntered_1(object sender, PointerEventArgs e)
    {
        BitmapImage bmp = new BitmapImage();
        Uri u = new Uri("ms-appx:/Images/Shapes/blueball.png", UriKind.RelativeOrAbsolute);
        bmp.UriSource = u;
        ImageBrush i = new ImageBrush();
        i.ImageSource=bmp;
        button.Background= i;

    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-08T01:09:06.860

PointerPressed / PointerReleased 的 += 在您的原始代码中不起作用的原因是 Button（实际上是 ButtonBase）类处理这些事件。那是因为它们被合并到 Click 事件中（发布时）。如果您将 SkillButton.AddHandler 与第一个参数 PointerPressedEvent 一起使用，第二个参数是对命名处理程序的新处理程序引用，第三个参数为 true，则您可以使用 PointerPressed 而不是 Entered/Exited 作为事件。

# google-app-engine - Python 2.7 应用程序在 App Engine 上作为 CGI 而不是 WSGI 执行

> ID：10524519
> 
> 赞同：3
> 
> 时间：2012-05-09T21:43:14.113
> 
> 标签：google-app-engine, cgi, wsgi

以下代码生成 CGI 方法而不是 WSGI，如下面的日志所示。这是开发服务器上 WSGI 应用程序的正常执行吗？如果不是，需要改变什么才能让应用程序作为 WSGI 执行？

主文件

```
import webapp2
import wsgiref.handlers
import logging
from google.appengine.api import users

class HomeHandler(webapp2.RequestHandler):
    def get(self):
        self.response.out.write("Hi World")

app = webapp2.WSGIApplication([
    (r'/', HomeHandler),
], debug=True)

app.run() 
```

应用程序.yaml

```
application: WSGITEST
version: 1
runtime: python27
api_version: 1
threadsafe: yes

libraries:
- name: webapp2
  version: latest

handlers:
- url: /.*
  script: main.app 
```

日志

```
DEBUG    2012-05-09 21:31:14,921 dev_appserver.py:656] Matched "/" to CGI dispatcher with path main.app
DEBUG    2012-05-09 21:31:14,926 dev_appserver_import_hook.py:1246] Enabling webapp2: None
DEBUG    2012-05-09 21:31:14,928 dev_appserver.py:1624] Executing CGI with env:
{'REQUEST_ID_HASH': '77DE68DA', 'SERVER_SOFTWARE': 'Development/1.0', 'SCRIPT_NAME': '', 'REQUEST_METHOD': 'GET', 'PATH_INFO': '/', 'SERVER_PROTOCOL': 'HTTP/1.0', 'QUERY_STRING': '', 'CONTENT_LENGTH': '', 'USER_ID': '', 'APPENGINE_RUNTIME': 'python27', 'TZ': 'UTC', 'SERVER_NAME': 'localhost', 'REMOTE_ADDR': '127.0.0.1', 'SDK_VERSION': '1.6.5', 'PATH_TRANSLATED': '/home/bear/dev/appengine/code/ae-baseapp/401/main3.app', 'SERVER_PORT': '8080', '_AH_THREADSAFE': '1', 'CURRENT_VERSION_ID': '1.1', 'USER_ORGANIZATION': '', 'HTTP_USER_AGENT': 'Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:12.0) Gecko/20100101 Firefox/12.0', 'HTTP_HOST': 'localhost:8080', 'HTTP_CONNECTION': 'keep-alive', 'USER_EMAIL': '', 'HTTP_ACCEPT': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'APPLICATION_ID': 'dev~WSGITEST', 'GATEWAY_INTERFACE': 'CGI/1.1', 'HTTP_ACCEPT_LANGUAGE': 'en-us,en;q=0.5', 'HTTP_DNT': '1', 'CONTENT_TYPE': 'application/x-www-form-urlencoded', '_AH_ENCODED_SCRIPT_NAME': '/', 'AUTH_DOMAIN': 'gmail.com'}
INFO     2012-05-09 21:31:14,933 dev_appserver.py:2891] "GET / HTTP/1.1" 200 - 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T22:05:21.943

此日志是硬编码字符串：

```
/usr/local/google_appengine/google/appengine/tools/dev_appserver.py:
 1622      sys.modules['__builtin__'] = __builtin__
 1623  
 1624:     logging.debug('Executing CGI with env:\n%s', repr(env)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T21:51:13.840

首先，您应该删除这行代码，因为它[不正确](http://webapp-improved.appspot.com/api/webapp2.html#webapp2.WSGIApplication.run)：

```
app.run() 
```

[正如我在评论中所写并由schmid00](https://stackoverflow.com/a/10524763/130929)指出的那样，可能是一个旧的调试语句。

# mysql - MySQL InnoDB 事务 + 锁定

> ID：10524525
> 
> 赞同：2
> 
> 时间：2012-05-09T21:43:38.030
> 
> 标签：mysql, transactions, locking, innodb

MySQL 版本：v5.0.95

基本上我有客户试图获取数据 - 每个客户应该只获得唯一的行。

```
START TRANSACTION;

SELECT id where result='new';

UPDATE SET result='old' WHERE id=$id;

COMMIT; 
```

`LOCK IN SHARED MODE`在 select 语句上仍然让其他客户端读取数据，这似乎是一个问题。

基本上我需要选择一次的数据，更新，而不是被另一个客户端再次读取。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T09:38:45.810

`SELECT FOR UPDATE`将阻止另一个读取，同时`LOCK IN SHARED MODE`将允许读取，但不允许来自另一个客户端的更新

# c - GMP天花板功能

> ID：10524526
> 
> 赞同：2
> 
> 时间：2012-05-09T21:43:53.313
> 
> 标签：c, math, gmp

我想用GMP找到一个非常大的平方根的上限。在 C 中，`ceil(sqrt(n))`.

整数的 GMP 平方根会截断结果，因此 10 的平方根将报告为 3。浮点平方根按预期工作，但我需要取下一个最大的整数。`mpf_get_d`向零舍入，但除此之外做我想要的。我怎样才能得到一个大数的平方根的上限？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T21:49:33.327

这是一个快速而肮脏的技巧：

```
ceil( sqrt(n) ) = trunc_sqrt(n - 1) + 1 
```

`trunc_sqrt(n)`您当前使用的 GMP 整数平方根函数在哪里。

这应该适用于所有整数`n > 0`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T21:49:40.150

有什么不使用的具体原因`mpf_ceil()`吗？对我来说，这听起来像是最合乎逻辑的一步，除非我错过了什么。

编辑：重新阅读您的问题后，有什么理由将数字视为整数而不是浮点数？

# button - PayPal 快速结帐按钮 - 是否有不同的变化/颜色？

> ID：10524527
> 
> 赞同：1
> 
> 时间：2012-05-09T21:43:53.657
> 
> 标签：button, paypal, express-checkout

为了使用 Express Checkout，我[必须使用](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECGettingStarted#idbec8c969-cd47-4d23-bb4b-18a5e0c1fd17)PayPal 服务器上的按钮。但它只提供一种按钮样式：[https](https://www.paypal.com/express-checkout-buttons) ://www.paypal.com/express-checkout-buttons 。在深色背景下看起来真的很糟糕。是否有另一个“官方”页面提供更多样式（例如，类似于 FB 为 LIKE 按钮提供的内容）？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-21T09:53:59.317

以下链接是最新按钮样式的官方页面

[https://www.paypal.com/au/webapps/mpp/logos-buttons](https://www.paypal.com/au/webapps/mpp/logos-buttons)

# php - cpanel XML API 404 错误

> ID：10524537
> 
> 赞同：2
> 
> 时间：2012-05-09T21:44:50.713
> 
> 标签：php, xml, cpanel, whm

看了很多关于堆栈和 cpanel 论坛的帖子，但似乎仍然找不到解决方案。

我试图通过 api 调用检索信息，但它似乎总是失败。我知道它与 url 404'ing 有关，但不知道如何修复。

我正在使用 XMl API 类： [https ://github.com/CpanelInc/xmlapi-php/](https://github.com/CpanelInc/xmlapi-php/)

我的代码是：

```
$this->load->library('xmlapi');

$xmlapi = new xmlapi(XMLAPI_HOST);
$xmlapi->password_auth(CPANEL_USER, CPANEL_PASSWORD);

$xmlapi->set_debug(1);

echo '<pre>';
print_r($xmlapi->accountsummary(CPANEL_USER));
echo '</pre>'; 
```

以上输出xml数组。在 error_notice 中它说：

```
HTTP error 404, The requested page was not found. 
```

没关系。所以我回显出它使用哪个 404 的 url： [http ://mysite.co.uk:2082/xml-api/accountsummary](http://mysite.co.uk:2082/xml-api/accountsummary)

cpanel 文档导航起来有点尴尬，但除了编译 url 的类之外，在实际的 url 结构上找不到任何东西。我尝试添加 www，尝试了 ip 等，但不知道为什么会出错。

此外，如果它有助于我访问普通的 cpanel 帐户，而不是 WHM 管理员及其通过 http。

感谢您的阅读，任何有关使其正常工作的帮助指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-06T17:24:58.123

您遇到的问题是您试图从 cPanel 端口 (2082/2083) 使用 accountsummary 功能。accountsummary 功能仅限于管理员帐户，因为此功能旨在提供管理 api 级别的访问权限，以从服务器上的任何用户提取帐户信息。

要访问 accountsummary api，您需要从以下 url 调用 accountsummary api：

```
https://$SERVER_IP:2087/xml-api/accountsummary?user=$USERNAME 
```

您需要将 $SERVER_IP 和 $USERNAME 替换为它们各自的值。

*   [http://docs.cpanel.net/twiki/bin/view/SoftwareDevelopmentKit/ShowAccountInformation](http://docs.cpanel.net/twiki/bin/view/SoftwareDevelopmentKit/ShowAccountInformation)

# c++ - 如何从对象数组中检索字段数组？

> ID：10524538
> 
> 赞同：1
> 
> 时间：2012-05-09T21:44:51.707
> 
> 标签：c++

> **可能重复：**
> [按对象的属性对对象向量进行排序](https://stackoverflow.com/questions/5174115/sorting-a-vector-of-objects-by-a-property-of-the-object)

我有一个如下结构：

```
strcut Point
{
   int x;
   int y;
   int z;
}; 
```

我还有一个用于整数的通用排序函数：

```
void sort(vector<int>); 
```

在我的程序中，我需要经常使用不同的字段（即 x、y 或 z）对点数组 std::vector 进行排序。如何有效地将点数组转换为整数数组？

# php - 如何将自定义标头传递给 RESTful 调用？

> ID：10524543
> 
> 赞同：2
> 
> 时间：2012-05-09T21:45:29.790
> 
> 标签：php, rest, http-headers

我需要为我的网站连接一些 Web 服务 API。大多数 API 都涉及以下内容：

```
$data = file_get_contents("http://www.someservice.com/api/fetch?key=1234567890 
```

但是一项 Web 服务需要在自定义 HTTP 标头中设置 API 密钥。如何向此 API url 发出请求并同时传递自定义标头？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-09T21:50:09.507

您可以像这样使用[stream_context_create](http://de2.php.net/manual/en/function.stream-context-create.php)：

```
<?php
$options = array(
  'http'=>array(
    'method'=>"GET",
    'header'=>"CustomHeader: yay\r\n" .
              "AnotherHeader: test\r\n"
  )
);
$context=stream_context_create($options);
$data=file_get_contents('http://www.someservice.com/api/fetch?key=1234567890',false,$context);
?> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-09T21:52:41.753

你可以使用卷曲。例如：

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'http://www.someservice.com/api/fetch?key=1234567890');
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Header: value'));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

$result = curl_exec($ch);
curl_close($ch); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T21:55:36.473

```
$context = stream_context_create(array(
'http' => array(
'method' => 'GET',
'header' => 'CUSTOM HEADER HERE',
)
));

$result = file_get_contents($url, false, $context); 
```

# actionscript - 示例 red5 代码

> ID：10524544
> 
> 赞同：0
> 
> 时间：2012-05-09T21:45:33.490
> 
> 标签：actionscript, red5

我想要非常用于聊天的示例代码（仅限文本，无流式传输......）

这段代码就像我想在客户端的 actionscript 和服务器端的 java 中寻找的一样：

**服务器端**

```
function receiveMsg(data){
    toClient("Server says" + data);
} 
```

**客户端**

```
btn.event(click, function(){
    toServer("Hello Server");
} 
```

就这样！提前感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T00:24:16.657

它可能比你想要的更多，但它肯定是一个简单的聊天应用程序。我为 Red5 中的集群聊天应用写了一篇博文和演示代码；随意做你喜欢的事。 [http://blog.infrared5.com/2011/07/clustering-with-red5/](http://blog.infrared5.com/2011/07/clustering-with-red5/)

# tridion - 将 Tridion 2009 事件系统迁移到 Tridion 2011 SP1 时出错

> ID：10524548
> 
> 赞同：3
> 
> 时间：2012-05-09T21:46:25.843
> 
> 标签：tridion

将我现有的 Tridion 2009 事件 DLL（在 2011 服务器上编译）添加到 bin 目录并在 Content Manager 配置文件中注册 DLL 后，GUI 现在返回以下错误。我已经检查了事件日志、Tridion 日志等以获取有关“缺少依赖项”的更多详细信息，有人有什么想法吗？

```
Could not load file or assembly 'Tridion.Extensions.Events, Version=1.0.20.521,
Culture=neutral, PublicKeyToken=ecb60dbe3cbb7440' or one of its dependencies. 
The system cannot find the file specified.

Unable to get LangID of User (tcm:0-2851-65552). Initialization of the extension
'C:\Program Files (x86)\Tridion\bin\Tridion.Extensions.Events.MDO.dll' failed.

System.Reflection.RuntimeAssembly.GetExportedTypes(RuntimeAssembly,ObjectHandleOnStack) 
    System.Reflection.RuntimeAssembly.GetExportedTypes() 
    Tridion.ContentManager.Extensibility.TcmExtension.LoadExtensions() 
    Tridion.ContentManager.Extensibility.TcmExtension.LoadExtensions() 
    Tridion.ContentManager.Extensibility.TcmExtension.InitializeExtensions() 
    Tridion.ContentManager.Extensibility.EventSystem.DeliverEvent(IEnumerable`1,TcmEventArgs,EventDeliveryPhase) 
    Tridion.ContentManager.Extensibility.EventSystem.DeliverEvent(IdentifiableObject,TcmEventArgs,EventDeliveryPhase) Tridion.ContentManager.IdentifiableObject.Load(LoadFlags,Boolean) 
    Tridion.ContentManager.IdentifiableObject.Load(LoadFlags) 
    Tridion.ContentManager.BLFacade.IdentifiableObjectFacade.Read(UserContext,String,XMLReadFilter) XMLState.GetPropertyElem XMLState.GetProperty User.LangID 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T00:21:33.290

看起来你有两个程序集：`Tridion.Extensions.Events.dll`和`Tridion.Extensions.Events.MDO.dll`. 由于您通过 Tridion.ContentManager.config 中的完整路径引用 TcmExtension DLL，因此您不能在同一目录中拥有依赖于另一个的 TcmExtension DLL。

解决方案是将“共享库”（可能`Tridion.Extensions.Events.MDO.dll`为您）放在 GAC 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T06:46:04.690

Fortunately, .NET assemblies contain all the dependency information you need in their metadata. Faced with this problem, I would generally try to open up the assembly with a tool that can read this, for example, ILDASM, or IlSpy. That gives you a concrete list of things to look for, instead of the vague and mysterious "or one of its dependencies".

An alternative approach is to use FUSLOGVW to monitor where the .NET runtime is looking for assemblies.

# javascript - 如何在 JavaScript 中检查 {} 值？

> ID：10524558
> 
> 赞同：0
> 
> 时间：2012-05-09T21:47:19.820
> 
> 标签：javascript

出于某种原因，在 currentRow.cells 下面的代码中返回 {}。我该如何检查呢？如果 currentRow.cells 返回 {}，我不想执行行。

```
 currentRow = document.createElement("TR");
 if(currentRow.cells.length > 0) { .. do something } 
```

更新 1：

我想要的只是检查空对象。如果 currentRow.cells 是一个空对象，则什么也不做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:03:28.497

我总是得到一个 HTMLCollection 类型的对象。

然后，您应该能够使用如下代码检查集合的长度：

```
if(currentRow.cells.length != 0) {
    //row and cells exist, work with them
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:01:03.293

jQuery 有一个名为[`$.isEmptyObject()`](http://api.jquery.com/jQuery.isEmptyObject/).

他们的代码很简单：

```
function isEmptyObject( obj ) {
    for ( var name in obj ) {
        return false;
    }
    return true;
} 
```

如果您不想使用整个 jQuery 库，您可以使用此方法并将其放在您自己的代码库中的某个位置！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:11:39.517

`currentRow`是 a `<tr>`（或 a `HTMLTableRowElement`），并且`currentRow.cells`是 a [`HTMLCollection`](https://developer.mozilla.org/En/DOM/HTMLCollection)（不是数组 ( `[]`) 或对象 ( `{}`)）。

如果`currentRow.cells`未定义，则表示该`current`行不是 a `<tr>`，而是另一个元素。

要检查 DOM 元素是否为空，您可以使用[`childNodes`](https://developer.mozilla.org/en/DOM/Node.childNodes)(this will *never* be `undefined`)。

```
if(currentRow.childNodes.length === 0){
    // empty
}
else{
    // not empty
} 
```

编辑：更好的是，您可以使用[`hasChildNodes`](https://developer.mozilla.org/en/DOM/Node.hasChildNodes).

```
if(!currentRow.hasChildNodes()){
    // empty
}
else{
    // not empty
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T03:29:34.987

`cells``<tr>`属性在 IE8 及更低版本中不可用。按照上面的建议进行锻炼`childNodes`。以下代码检查是否`cells`未定义：

```
var currentRow = document.createElement("TR");
if (typeof currentRow.cells === "undefined") {
    // use currentRow.childNodes
}
else {
    // use currentRow.cells
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-09T22:01:21.233

要在标题中回答您的问题：

```
function is_empty(obj) {
    for(var i in obj) {
        if(obj.hasOwnProperty(i))
            return false;
    }
    return true;
}

alert(is_empty({})); // true 
```

# python - 由于 Python 安装失败，无法在 VirtualBox 共享文件夹上安装 Plone

> ID：10524564
> 
> 赞同：2
> 
> 时间：2012-05-09T21:47:41.923
> 
> 标签：python, debian, plone, virtualbox, zope

我正在运行 Windows 7 64 位作为我的主机操作系统和 Debian AMD64 作为我的客户操作系统。在我的 Windows 机器上，一个名为 www 的文件夹安装在 Debian 的 /home/me/www 下。

使用统一安装程序在 Debian（来宾操作系统）上安装 Plone 没有问题。但是，当我尝试将默认安装路径从 /home/me/Plone 更改为 /home/me/www/plone 时，安装总是失败，因为 Python 无法安装。在 install.log 它说

ln: 未能创建硬链接 'python' => 'python2.6': 不允许操作

看起来它可能与访问权限有关，但我尝试使用 sudo 或作为普通用户运行安装脚本，但都没有帮助。该脚本可以在其他地方正常安装，而不是在 Virtualbox 的共享文件夹中。

有什么建议么？

更多信息：我在 Debian 上没有 root 帐户（测试中，系统 Python 版本是 2.7）并且总是使用 sudo。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T03:48:47.377

我最近对 ​​VirtualBox 做了一些试验。这很棒，但我很确定共享文件夹将仅限于主机操作系统支持的内容。Windows 没有硬链接或符号链接。

我怀疑您正在尝试这样做，以便您可以使用主机工具从共享目录中编辑实例文件。您可以通过安装到非共享文件，然后将关键部分（如 src 目录，如果您出于开发目的而这样做）复制到主机目录，然后（并且仅在那时）建立现有的主机目录作为共享目录。

如果您尝试一下，请告诉我们它是如何工作的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T00:24:57.877

如何使用 Debian`mount --bind`将特定的主机文件夹挂载到安装树的某些部分？

# gwt - 如何在 GWT 中构建 JSP/JSF 之类的 UiBinder 标签？

> ID：10524566
> 
> 赞同：0
> 
> 时间：2012-05-09T21:48:05.813
> 
> 标签：gwt, uibinder

我过去广泛使用过 JSP 标签库、freemarker、tiles、JSF-Facelets。与他们使用标记库类似，我是否可以在 GWT UiBinder 中执行以下操作：

1) 组合：在 UiBinder 中创建一个标签库（没有 java 代码），并将标签包含到另一个 uiBinder 文件中 2) 继承：创建一个基本布局 UiBinder 文件（主布局）并覆盖子 UiBinder 文件中的特定内容区域？3) 将客户端变量传递到 UiBinder ($(map.property))

一般来说，我不确定 UiBinder 与其他模板库的比较。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T09:21:04.413

要使用 UiBinder 将一个页面的内容插入另一个页面，请在同一个包中创建一个类`mypackage.Header`和一个文件。然后你的 UiBinder holder-file 应该是这样的：`Header.ui.xml``mypackage`

```
<ui:UiBinder 
    xmlns:ui='urn:ui:com.google.gwt.uibinder'
    xmlns:g='urn:import:com.google.gwt.user.client.ui'
    xmlns:my='urn:import:mypackage'>

  <g:HTMLPanel>
    <my:Header />
    <!-- other content  -->
  </g:HTMLPanel>
</ui:UiBinder> 
```

首先，UiBinder 是一个非常方便的工具，可以将 UI 与其行为分开。此外，它有助于提高生产力（这是真的！）、可维护性，并具有其他功能。GWT 中的 UiBinder 与 JSF 方法非常不同。此工具不是渲染器。与 JSF 相比，它不包含任何循环或条件。它的标记中没有`if`语句，只有非常有限的表达语言。所有逻辑都在Java类中。没错。在类中有循环和条件而不是在视图中是合乎逻辑的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:11:42.980

UiBinder 不是模板工具。这个想法是 XML 比 Java 更容易阅读和维护。

UiRenderer (GWT 2.5) 和 SafeHtmlTemplates 是，但它们非常基础。他们只回答你的第三点。

GWT 没有回答您的前两点。

# winjs - WinJS：在列表视图中隐藏 scollbars

> ID：10524567
> 
> 赞同：0
> 
> 时间：2012-05-09T21:48:10.863
> 
> 标签：winjs

我试图隐藏 WinJS [ListView](http://msdn.microsoft.com/en-us/library/windows/apps/br211837.aspx)控件中的水平滚动条。有任何想法吗？我将进行一个限制返回项目数量的 API 调用，但如果出现问题并返回更多项目，或者返回错误，我想确保布局不会中断并且出现水平滚动条。这是我并排浮动四个列表视图的情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-10T22:31:47.317

您应该能够根据您所需的行为使用[`-ms-overflow-style`](http://msdn.microsoft.com/en-us/library/windows/apps/hh441298.aspx)css 属性或css 属性。`overflow`

如果您希望用户仍然能够滚动，即使没有滚动条，您也应该使用：

`#listviewid .win-viewport{ -ms-overflow-style: none; }`

如果您不希望用户能够滚动，只需使用：

`#listviewid .win-viewport{ overflow: hidden; }`

# desire2learn - Desire2Learn 中的小部件和 API

> ID：10524572
> 
> 赞同：0
> 
> 时间：2012-05-09T21:48:41.757
> 
> 标签：desire2learn

可以从 D2L 小部件内部使用 Desire2Learn API 吗？是否会提示用户输入凭据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T14:18:03.860

是的，API 可以通过小部件工作。不，不会提示用户输入凭据。

小部件是 HTML 代码块，可以嵌入到 Desire2Learn UI 的不同区域（组织主页和课程主页）。小部件是扩展 Desire2Learn 的 UI 的两种主要方式之一（以及通常添加到课程中的 LTI 链接的“外部学习工具”）。它们是通过配置一小块 html 来实现的。对于大多数重要小部件的开发人员来说，这最终将只是一个连接到 Web 应用程序的 iframe（在混合解决方案中，有时小部件 iframe 将*作为*LTI 链接连接到 Web 应用程序）。

小部件通常希望显示特定于正在查看页面的用户的应用程序内容。小部件可以通过立即尝试将 API 身份验证回调用服务器来识别用户。因为小部件是在会话中调用的，所以此过程不会提示用户输入凭据。此时，应用程序具有执行 API 调用（例如“whoami”）所需的 valence userid 和密钥，这将使应用程序能够识别用户并进行其他调用（例如显示从 LMS 检索到的成绩或其他信息）或只需将用户与特定于小部件的数据相关联。

# mysql - MySQL过程随机数生成

> ID：10524573
> 
> 赞同：0
> 
> 时间：2012-05-09T21:48:43.840
> 
> 标签：mysql, stored-procedures

我正在编写我的第一个 MySQL 程序。我尝试生成一个随机数并使用该数字更新表中的值，但前提是它不存在（由于唯一约束）。我的程序如下所示：

```
create procedure generaterc()
begin
declare _rc char;
declare _id int;
set _id = 1;

while _id < ((select count(*) from patient) - 1) do
    begin
    set _rc = cast(FLOOR(1000000000 + (RAND() * 8999999999)) AS char);
    select _rc;
    if not exists(select * from patient where patient.rc = _rc) then
        update patient set rc=_rc where id=_id;
        set _id=_id+1;            
    end if;
    end;
end while;    
end 
```

执行过程时出现此错误：数据截断：第 8 行的“_rc”列的数据太长。我的 rc 列是 varchar(255)，但我想这不是问题的核心。有什么建议么？

非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:04:27.973

代替

```
declare _rc char; 
```

尝试：

```
declare _rc varchar(255); 
```

目前 _rc 只能容纳单个字符，不足以存储您的号码。

但是，对于您的用例，您可能希望查看[uuid_short()](http://dev.mysql.com/doc/refman/5.5/en/miscellaneous-functions.html#function_uuid-short)函数。它生成一个保证唯一的大随机数（受某些规则约束）。这样，您可以用单个语句替换您的过程：

```
update patient set rc = uuid_short(); 
```

# java - BigQuery 和 OAuth2

> ID：10524576
> 
> 赞同：3
> 
> 时间：2012-05-09T21:49:04.813
> 
> 标签：java, google-api, oauth-2.0, google-bigquery

我正在尝试使用[服务帐户](http://code.google.com/p/google-api-java-client/wiki/OAuth2#Service_Accounts)方法访问 Google BigQuery。我的代码如下：

```
private static final HttpTransport HTTP_TRANSPORT = new NetHttpTransport();

private static final JsonFactory JSON_FACTORY = new JacksonFactory();

GoogleCredential credentials = new GoogleCredential.Builder()
            .setTransport(HTTP_TRANSPORT)
            .setJsonFactory(JSON_FACTORY)
            .setServiceAccountId("XXXXX@developer.gserviceaccount.com")
            .setServiceAccountScopes(BigqueryScopes.BIGQUERY)
            .setServiceAccountPrivateKeyFromP12File(
                    new File("PATH-TO-privatekey.p12"))
            .build();
    Bigquery bigquery = Bigquery.builder(HTTP_TRANSPORT, JSON_FACTORY).setHttpRequestInitializer(credentials)
            .build();
    com.google.api.services.bigquery.Bigquery.Datasets.List datasetRequest = bigquery.datasets().list(
            "PROJECT_ID");

    DatasetList datasetList = datasetRequest.execute();
    if (datasetList.getDatasets() != null) {
        java.util.List<Datasets> datasets = datasetList.getDatasets();
        System.out.println("Available datasets\n----------------");
        for (Datasets dataset : datasets) {
            System.out.format("%s\n", dataset.getDatasetReference().getDatasetId());
        }
    } 
```

但它会引发以下异常：

```
Exception in thread "main"  com.google.api.client.googleapis.json.GoogleJsonResponseException: 401 Unauthorized
{
  "code" : 401,
  "errors" : [ {
    "domain" : "global",
    "location" : "Authorization",
    "locationType" : "header",
    "message" : "Authorization required",
    "reason" : "required"
  } ],
  "message" : "Authorization required"
}
at com.google.api.client.googleapis.json.GoogleJsonResponseException.from(GoogleJsonResponseException.java:159)
at com.google.api.client.googleapis.json.GoogleJsonResponseException.execute(GoogleJsonResponseException.java:187)
at com.google.api.client.googleapis.services.GoogleClient.executeUnparsed(GoogleClient.java:115)
at com.google.api.client.http.json.JsonHttpRequest.executeUnparsed(JsonHttpRequest.java:112)
at com.google.api.services.bigquery.Bigquery$Datasets$List.execute(Bigquery.java:979) 
```

异常在这一行被触发：

```
 DatasetList datasetList = datasetRequest.execute(); 
```

我从 Google API 控制台的第二行获取帐户 ID，如下所示：

```
 Client ID:  XXXXX.apps.googleusercontent.com
    Email address:  XXXXX@developer.gserviceaccount.com 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T22:56:56.860

尤里卡！Eric 和 Michael 的代码都运行良好。

通过错误地设置客户端计算机上的时间，可以重现问题中发布的错误。幸运的是，**可以通过正确设置客户端机器上的时间来解决**。

注意：对于它的价值，我使用“Internet 时间设置”对话框中的“立即更新”按钮同步了 Windows 7 机器上的时间。我认为这应该是非常防白痴的......但我想我击败了系统。它更正了秒数，但机器关闭了整整一分钟。之后 BigQuery 调用失败。我手动更改时间后它成功了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T22:58:28.940

我们在 Java 库中的错误处理代码需要改进一下！

用于请求 OAuth 访问令牌的签名 JWT 似乎失败了。您可以通过启用上面提到的@MichaelManoochehri 的日志来看到这一点。

我认为只有几件事可能导致此失败：

1.  无效的签名（使用错误的密钥）
2.  服务帐户的电子邮件地址无效（我认为已排除）
3.  用于生成签名 blob 的日期/时间戳无效（发布日期和到期日期）
4.  范围无效（我认为已排除）

您应该使用正确的时区检查您的服务器上的日期/时间是否正确设置——同步到 NTP。您可以使用 time.gov 查看美国官方原子钟时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T22:16:35.107

**编辑：我在下面给出的答案与使用 Google App Engine 服务帐户有关 - 留在这里以供参考。**

仔细检查您是否已将服务帐户地址作为所有者添加到项目的团队页面。

我建议使用 AppIdentityCredential 类来处理服务帐户身份验证。这是一个演示这一点的小片段，我将在 BigQuery API 开发人员页面上添加有关此的其他文档。

此外，请确保您使用的是最新版本的 Google Java API 客户端（截至今天，此处为“v2-rev5-1.5.0-beta”版本[）](http://code.google.com/p/google-api-java-client/wiki/APIs#BigQuery_API)。

```
import java.io.IOException;

import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.google.api.client.googleapis.extensions.appengine.auth.oauth2.AppIdentityCredential;
import com.google.api.client.http.HttpTransport;
import com.google.api.client.http.javanet.NetHttpTransport;
import com.google.api.client.http.json.JsonHttpRequest;
import com.google.api.client.http.json.JsonHttpRequestInitializer;
import com.google.api.client.json.JsonFactory;
import com.google.api.client.json.jackson.JacksonFactory;
import com.google.api.services.bigquery.Bigquery;
import com.google.api.services.bigquery.BigqueryRequest;

@SuppressWarnings("serial")
public class Bigquery_service_accounts_demoServlet<TRANSPORT> extends HttpServlet {

// ENTER YOUR PROJECT ID HERE
private static final String PROJECT_ID = "";

private static final HttpTransport TRANSPORT = new NetHttpTransport();
private static final JsonFactory JSON_FACTORY = new JacksonFactory();
private static final String BIGQUERY_SCOPE = "https://www.googleapis.com/auth/bigquery";

AppIdentityCredential credential = new AppIdentityCredential(BIGQUERY_SCOPE);
Bigquery bigquery = Bigquery.builder(TRANSPORT,JSON_FACTORY)

 .setHttpRequestInitializer(credential)
 .setJsonHttpRequestInitializer(new JsonHttpRequestInitializer() {
   public void initialize(JsonHttpRequest request) {
     BigqueryRequest bigqueryRequest = (BigqueryRequest) request;
     bigqueryRequest.setPrettyPrint(true);
   }
 }).build();    

public void doGet(HttpServletRequest req, HttpServletResponse resp)
    throws IOException {
  resp.setContentType("text/plain");
  resp.getWriter().println(bigquery.datasets()
    .list(PROJECT_ID)
    .execute().toString());
 }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-10T01:05:20.050

这是一个完整的片段供参考：

```
import com.google.api.client.http.HttpTransport;
import com.google.api.client.http.javanet.NetHttpTransport;
import com.google.api.client.json.JsonFactory;
import com.google.api.client.json.jackson.JacksonFactory;

import com.google.api.client.googleapis.auth.oauth2.GoogleCredential;
import com.google.api.services.bigquery.Bigquery;
import com.google.api.services.bigquery.Bigquery.Datasets;
import com.google.api.services.bigquery.model.DatasetList;

import java.io.File;
import java.io.IOException;
import java.security.GeneralSecurityException;

public class BigQueryJavaServiceAccount {

  private static final String SCOPE = "https://www.googleapis.com/auth/bigquery";
  private static final HttpTransport TRANSPORT = new NetHttpTransport();
  private static final JsonFactory JSON_FACTORY = new JacksonFactory();

  public static void main(String[] args) throws IOException, GeneralSecurityException {
    GoogleCredential credential = new GoogleCredential.Builder().setTransport(TRANSPORT)
        .setJsonFactory(JSON_FACTORY)
        .setServiceAccountId("XXXXXXX@developer.gserviceaccount.com")
        .setServiceAccountScopes(SCOPE)
        .setServiceAccountPrivateKeyFromP12File(new File("my_file.p12"))
        .build();

    Bigquery bigquery = Bigquery.builder(TRANSPORT, JSON_FACTORY)
        .setApplicationName("Google-BigQuery-App/1.0")
        .setHttpRequestInitializer(credential).build();

    Datasets.List datasetRequest = bigquery.datasets().list("publicdata");
    DatasetList datasetList = datasetRequest.execute();
    System.out.format("%s\n", datasetList.toPrettyString()); 
} 
```

# git - 如何在保留历史记录的同时将文件从一个 git 存储库移动到另一个

> ID：10524578
> 
> 赞同：46
> 
> 时间：2012-05-09T21:49:16.187
> 
> 标签：git, git-filter-branch

我正在尝试将单个文件（称为 foo.txt）从一个存储库移动到另一个（不相关的）存储库，并保留其历史记录。[ebneter 的问题](https://stackoverflow.com/questions/1365541/how-to-move-files-from-one-git-repo-to-another-not-a-clone-preserving-history)显示了如何为子目录执行此操作。[taw 的问题](https://stackoverflow.com/questions/3192828/is-it-possible-to-move-a-bunch-of-files-from-one-git-repository-to-another-while)有一些提示和建议，但不是一个循序渐进的过程。[jkeating 的问题](https://stackoverflow.com/questions/5998987/splitting-a-set-of-files-within-a-git-repo-into-their-own-repository-preserving)看起来很有希望，但对我没有用。对于这个特定的用例，谷歌搜索是空的。我正在寻找的是完成此任务的明确命令序列。

我开始遵循的命令序列是这样的：

```
$ git clone source-repo/ source-repo-copy
$ cd source-repo-copy
$ git filter-branch --tree-filter 'test ! "$@" = "foo.txt" && \
  git rm --cached --ignore-unmatch $@ || true' --prune-empty 
```

我的过滤器命令的逻辑是针对`git rm`所有不是 foo.txt 的文件。我`|| true`在命令中添加了 以强制它具有零返回值以满足过滤器分支。

我的意图是将 source-repo-copy 设置为我的目标存储库 (target-repo) 的远程，并假设`git filter-branch`过滤掉除 foo.txt 之外的所有内容，获取 source-repo-copy 并将其合并到 target-repo 中。不幸的是，该`git filter-branch`命令似乎没有效果。它运行没有错误，并且似乎通过了 source-repo 中的 600 多个提交，但是当它完成时，`git log`source-repo-copy 中的和文件看起来是一样的。除了 foo.txt 之外的所有文件都不应该丢失，并且所有没有触及它的提交都应该从日志中消失吗？

在这一点上，我不知道如何进行。有什么建议么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-09T21:57:07.583

这对我有用，但有一个完整的目录。

[如此处](http://www.mactricks.de/de/Programmieren/VCS/git/repo_split/)所示

```
~$ cd neu
~/neu$ git filter-branch --subdirectory-filter FooBar HEAD
~/neu$ git reset --hard
~/neu$ git remote rm origin
~/neu$ rm -r .git/refs/original/
~/neu$ git reflog expire --expire=now --all
~/neu$ git gc --aggressive
~/neu$ git prune
~/neu$ git remote add origin git://github.com/FooBar/neu.git 
```

**编辑：对于单个文件：**

先过滤目录：

```
 git filter-branch --prune-empty --subdirectory-filter myDirectory -- --all 
```

过滤单个文件：

```
 git filter-branch -f --prune-empty --index-filter "git rm --cached --ignore-unmatch $(git ls-files | grep -v 'keepthisfile.txt')" 
```

做一些清理工作：

```
 git reset --hard
 git gc --aggressive
 git prune 
```

这应该这样做。

# internet-explorer - 为 IE 提供托管的 EOT 字体

> ID：10524580
> 
> 赞同：0
> 
> 时间：2012-05-09T21:49:24.533
> 
> 标签：internet-explorer, webfonts

当我尝试将 @font-face 用于 IE 的 EOT 字体时，当字体托管在其他地方时它不起作用。它仅在本地的 Web 应用程序中有效。

这不起作用：

```
@font-face
{
    font-family: 'AvantGardeMdBTMedium';    
    src: url('http://myhost.com/fonts/fontname.eot')
} 
```

这有效：

```
@font-face {
    font-family: AvantGardeNormal;
    src: url('fontname.eot');
} 
```

是否可以通过完整的 http 地址使用托管字体？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T18:54:12.513

可以将您的字体托管在不同的域上，但如果出现任何跨域策略问题，您将不得不处理它们。在 IE 中检查您的开发人员工具（在 IE8 或 IE9 中按 F12）并查看控制台以查找任何错误（此处将显示跨域策略错误）。有关更正跨域策略标头的更多详细信息，请参阅[IE9 阻止下载跨域 Web 字体](https://stackoverflow.com/questions/5065362/ie9-blocks-download-of-cross-origin-web-font)。

# vb.net - 如何从这个 JSON 创建一个 VB.net 类？

> ID：10524588
> 
> 赞同：1
> 
> 时间：2012-05-09T21:49:56.103
> 
> 标签：vb.net, json, json.net

我正在尝试从下面的 JSON 示例在 vb.net 中创建一个类。

我对 JSON 相当陌生，我只是无法找出正确的方法。我已经查看了许多有关如何执行此操作的示例，但它们的格式比我在下面提供的格式要简单得多。

```
LEVEL0({
  "LEVEL1": [
    {
      "LEVEL2": [
        {
          "City": "Billings",
          "State": "MO",
          "Country": "US",
          "Id": "1122334455",
          "Percent": "39.10"
          }
      ],
      "City": "Billings",
      "Country": "US",
      "NumFound": "1",
      "NumReturned": "1",
      "State": "MO",
      "Status": "Success"
    }
  ],
  "Status": "1"
}); 
```

我在想这会很容易，但引起我问题的是 LEVEL2 是一个列表。它可以返回多个城市。因此，它可以在 [] 中返回类似的内容。

```
{"City": "Billings","State": "MO","Country": "US","Id": "1122334455","Percent": "39.10"},
{"City": "Fairmount","State": "MN","Country": "US","Id": "1177775","Percent": "64.10",} 
```

因此，无论哪种方式，该部分都需要是一个列表，但列表下方的部分也需要是该类的一部分。您在哪里看到 numFound。

我猜这措辞不好，但我正在努力寻找一个很好的例子来说明如何做到这一点。对此的任何指导或建议将不胜感激。我需要正确格式化该类，因此当我反序列化到该类时它可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:15:55.393

如果您正在使用某种 Web 服务，如果您正在使用具有所有这些属性的对象，它应该会自动为您绑定。就像是：

```
Public Class WrapperClass
    Dim Status As Integer
    Dim LEVEL1 As New List(Of MiddleClass)
End Class

Public Class MiddleClass
    Dim LEVEL2 As New List(Of InnerClass)
    Dim City As String
    Dim Country As String
    Dim NumFound As Integer
    Dim NumReturned As Integer
    Dim State As String
    Dim Status As String

    Public Sub MiddleClass()
    'init code
    End Sub
End Class

Public Class InnerClass
    Dim City As String
    Dim Country As String
    Dim State As String
    Dim Id As Integer
    Dim Percent As Decimal
End Class 
```

然后在您的网络服务中，让它接受一个类型的参数`WrapperClass`

# entity-framework-4.1 - 如何在 Entity Framework 4.1 中使用子查询生成 where-in 查询

> ID：10524594
> 
> 赞同：0
> 
> 时间：2012-05-09T21:50:12.740
> 
> 标签：entity-framework-4.1, ef-code-first, subquery, union, where-in

我正在尝试使用实体框架生成此查询`dbContext`：

```
SELECT     id
FROM         menuitems
WHERE     (parent_id = 11)
UNION
SELECT     id
FROM         menuitems AS menuitems_2
WHERE     (parent_id IN
    (SELECT     id
    FROM          menuitems AS menuitems_1
    WHERE      (parent_id = 11))) 
```

表 menuitems 有 2 列：id、parent_id

我试过这个：

```
List<int> mi = ctx.MenuItems.Where(i => i.parent_id == this.id).Select(id => id.id)
.Union(ctx.MenuItems.Where(c => ctx.MenuItems
              .Where(i => i.parent_id == this.id).Select(id => id.id)
              .Contains((int)c.parent_id)).Select(id => id.id))
              .ToList(); 
```

但它不起作用，因为我收到以下错误：

```
 Unable to create a constant value of type 'Menuitem'. Only primitive types ('such as Int32, String, and Guid') are supported in this context. 
```

有没有办法生成这个查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:36:37.530

您可以将其分解为两个更简单的查询：

```
List<int> allItems=new List<int>();
var items= menuitems.Where(m=>m.parent_id == 11).Select(m=>m.id);
var children= menuitems.Where(items.Contains(m=>m.parent_id)).Select(m=>m.id);
allItems.AddRange(items.ToList());
allItems.AddRange(children.ToList()); 
```

我很确定这和你想做的事情一样。您实际上可以像这样进行一次查询：

```
List<int> allItems=new List<int>();
var items= menuitems.Where(m=>m.parent_id == 11).Select(m=>m.id)
allItems= items.Union(menuitems.Where(items.Contains(m=>m.parent_id)).Select(m=>m.id)); 
```

此查询仅在返回 allItems 时运行一次。即使看起来像两个查询，Linq 在最终对象请求它之前不会运行查询。

# php - 带地板的数学函数

> ID：10524595
> 
> 赞同：1
> 
> 时间：2012-05-09T21:50:30.260
> 
> 标签：php

这段代码：

```
$hour = 2.2;
    if (floor($hour) > 1) {
        $str = $str . floor($hour) . " hours";
    }
    else if (floor($hour) === 1) {
        $str = $str . floor($hour) . " hour";
    }
echo $str; 
```

将输出：`2 hours`

但是，这一点：

```
$hour = 1.2;
    if (floor($hour) > 1) {
        $str = $str . floor($hour) . " hours, ";
    }
    else if (floor($hour) === 1) {
        $str = $str . floor($hour) . " hour ";
}
echo $str; 
```

不会输出，因为 的条件由于某种原因**不**匹配。这是为什么？`1 hour``else if`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T21:52:09.117

Floor 返回一个浮点数，您正在测试一个整数。

[http://php.net/manual/en/function.floor.php](http://php.net/manual/en/function.floor.php)

为清楚起见进行编辑：

```
<?php
$str = "";
$hour = 1.2;
    if (floor($hour) > 1) {
        $str = $str . floor($hour) . " hours, ";
    }
    else if ((int) floor($hour) === 1) {
        $str = $str . floor($hour) . " hour ";
}
echo $str;

?> 
```

# c++ - 动态转换不适用于非多态基类？

> ID：10524598
> 
> 赞同：2
> 
> 时间：2012-05-09T21:51:06.013
> 
> 标签：c++, casting

这里的第二个演员给出了一个错误说

`cast.cc:35:35: error: cannot dynamic_cast ‘base’ (of type ‘class CBase*’) to type ‘class CDerived*’ (source type is not polymorphic)`

```
 CBase * base = new CDerived; 
    CBase* pb;
    CDerived * der = new CDerived; 
    CDerived* pd;
    pb = dynamic_cast<CBase*>(der);     // ok: derived-to-base
    pd = dynamic_cast<CDerived*>(base);  // wrong: base-to-derived 
```

这是什么意思？？

如果我使基类多态，为什么这会起作用？

有人可以让我知道这背后的基本概念吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T21:52:41.780

因为标准是这样说的（参见 C++ 标准中的 [expr.dynamic.cast] 部分）：

> ...`dynamic_cast<T>(v)`
> 
> ...`v`应该是指向多态类型的指针或左值

在实践中，因为使动态向下转换（即从基到派生）成为可能所需的[运行时类型信息 (RTTI)是与](http://en.wikipedia.org/wiki/RTTI)[vtbl/vptr 机制](http://en.wikipedia.org/wiki/VTBL)一起生成的，如果没有多态成员函数则不需要.

另一方面，向上转换（即派生到基础）不需要 RTTI（不需要做出运行时决定）。引用标准的同一部分：

> ```
> struct B { };
> struct D : B { };
> void foo(D* dp) {
>     B* bp = dynamic_cast<B*>(dp); // equivalent to B* bp = dp;
> } 
> ```

# paypal - PayPal Express Checkout - 如何正确获取送货地址（用于计算运费）？

> ID：10524599
> 
> 赞同：0
> 
> 时间：2012-05-09T21:51:08.707
> 
> 标签：paypal, workflow, express-checkout

我需要在去贝宝快递结账之前获取买家的送货地址，以便我可以正确估算运费。据我了解，我需要使用快速结帐的“付款流程”选项 - 请转到[https://www.paypal-labs.com/integrationwizard/ecpaypal/intro.php](https://www.paypal-labs.com/integrationwizard/ecpaypal/intro.php)并单击“付款流程”选项卡看见。

问题是：如果我在购物车屏幕（第一个）上有“使用 PayPal 结帐”按钮并且用户单击它 - 那么用户将不会被重定向到 PayPal 页面，而是会转到我网站上的“输入您的送货地址”页面. 只有在该用户将重定向到 PayPal 页面之后。我认为这很令人困惑，并且可能违反了 PayPal 规则。我对吗？在这种情况下，正确的工作流程应该是什么样子？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T02:01:07.607

我想我找到了答案——为了根据用户的送货地址提供运费选项，应该使用[Instant Update API 。](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_ECInstantUpdateAPI)这将是来自 PayPal 的您服务器上的 Web 服务调用，带有买家选择的地址。

# apache - 目录访问被禁止

> ID：10524603
> 
> 赞同：1
> 
> 时间：2012-05-09T21:51:43.510
> 
> 标签：apache, .htaccess, easyphp

我无法访问我的根目录

```
http://localhost/zabjournal/ 
```

我的`index.php`根目录中有一个未被处理的。

这有效

```
http://localhost/zabjournal/index.php 
```

我在用着`easyphp`

我的 .htaccess 文件

```
RewriteEngine On
RewriteBase /zabjournal/

RewriteRule ^account/signin                 /zabjournal/pages/login.php [L]
RewriteRule ^account/validate               /zabjournal/pages/do_login.php [L]
RewriteRule ^account/signout                /zabjournal/pages/logout.php [L]
RewriteRule ^account/register               logout.php [L]

RewriteRule ^author/submit/progress         /zabjournal/pages/author/progress.php [L]

RewriteRule ^author/article/([0-9]+)$       /zabjournal/pages/author/viewArticle.php?id=$1 [L]
RewriteRule ^author/accepted-submissions    /zabjournal/pages/author/accepted_submissions.php [L]
RewriteRule ^author/new-submission          /zabjournal/pages/author/progress.php?addSubmission=1&progress=0 [L]
RewriteRule ^author/submission/([0-9]+)$    /zabjournal/pages/author/progress.php?loadArticleId=$1 [L]
RewriteRule ^author/submit/1                /zabjournal/pages/author/submit_step1.php [L]
RewriteRule ^author/submit/2                /zabjournal/pages/author/submit_step2.php [L]
RewriteRule ^author/submit/3                /zabjournal/pages/author/submit_step3.php [L]
RewriteRule ^author                         /zabjournal/pages/author/active_submissions.php

RewriteRule ^reviewer/form/process/([0-9]+)$                        /zabjournal/pages/reviewer/process_form.php?form_id=$1 [L]
RewriteRule ^reviewer/form/([0-9]+)$                                /zabjournal/pages/reviewer/viewForm.php?id=$1 [L,QSA]
RewriteRule ^reviewer/view-submission/([0-9]+)$                     /zabjournal/pages/reviewer/viewSubmission.php?id=$1 [L]
RewriteRule ^reviewer                                               /zabjournal/pages/reviewer/home.php

RewriteRule ^editor/issue/([0-9]+)$                                 /zabjournal/pages/editor/manage_issues.php?issue_id=$1 [L]
RewriteRule ^editor/issues                                          /zabjournal/pages/editor/list_issues.php [L]
RewriteRule ^editor/review-form/([0-9]+)$                           /zabjournal/pages/editor/viewForm.php?id=$1 [L]
RewriteRule ^editor/review-form/dialog/([0-9]+)$                    /zabjournal/pages/editor/viewForm_dialog.php?id=$1 [L]
RewriteRule ^editor/review-forms                                    /zabjournal/pages/editor/viewForms.php [L]
RewriteRule ^editor/assign-form                                     /zabjournal/pages/editor/assign_reviewer.php [L,QSA]
RewriteRule ^editor/article/([0-9]+)$                               /zabjournal/pages/editor/viewArticle.php?id=$1 [L]
RewriteRule ^editor/articles/review/assign                          /zabjournal/pages/editor/assign_reviewer.php?form_id=$1 [L,QSA]
RewriteRule ^editor/articles/review/existing                        /zabjournal/pages/editor/existing_forms.php [L,QSA]
RewriteRule ^editor/articles/review/new                             /zabjournal/lib/form_builder/index.php [L,QSA]
RewriteRule ^editor/articles/review                                 /zabjournal/pages/editor/review_option.php [L,QSA]
RewriteRule ^editor/articles                                        /zabjournal/pages/editor/accepted_submissions.php [L]
RewriteRule ^editor/submissions/download/pdf/([A-Za-z0-9_.\s*]+)    /zabjournal/lib/flexpaper/php/pdf/$1
RewriteRule ^editor/submission/assign/([0-9]+)$                     /zabjournal/pages/editor/assign_editor.php?article_id=$1 [L]
RewriteRule ^editor/submission/reject/([0-9]+)$                     /zabjournal/pages/editor/viewSubmission.php?reject_submission=1&id=$1 [L]
RewriteRule ^editor/submissions/([0-9]+)$                           /zabjournal/pages/editor/viewSubmission.php?id=$1 [L]
RewriteRule ^editor                                                 /zabjournal/pages/editor/editor.php

RewriteRule ^article/view/([0-9]+)$ /zabjournal/lib/flexpaper/php/split_document.php?doc=Report.pdf [L,QSA]
    php_value upload_max_filesize 10M
    php_value post_max_size 10M 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T23:37:10.920

您需要有一个包含“index.php”的“DirectoryIndex”指令，例如：

```
 DirectoryIndex index.php index.html 
```

# matlab - 易于编辑的 matlab 函数配置文件

> ID：10524607
> 
> 赞同：7
> 
> 时间：2012-05-09T21:51:57.433
> 
> 标签：matlab

像 ini 文件一样，我基本上想要一个易于编辑的配置文件，可用于读取信息并将其分发到 matlab 对象中。我知道人们会推荐 xml，但格式对于用户来说并不容易编辑。任何人都可以有其他方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T09:29:27.637

我一直将[YAML](http://www.yaml.org/about.html)文件用于 MATLAB 应用程序的配置文件。我发现它们易于人类阅读和编辑，版本可控，并且非常易于使用。

如果配置文件也需要被更广泛的应用程序的其他部分使用，它们的优势（相对于 MATLAB 脚本）还可以被其他语言（Perl、Python、Ruby、Java 等）广泛阅读。

有一个用于 MATLAB 的[YAML 文件阅读器](http://code.google.com/p/yamlmatlab/)（一个免费的 Apache 许可的 SnakeYaml Java 库的包装器），它是公开可用的。我还编写了我自己的，我很乐意分享（它基于我链接到的包，功能略少，但更容易理解代码并且更健壮）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T14:19:26.073

为什么不使用 ini 文件——为了便于编辑和阅读，它们是不可战胜的？他们的问题变得越来越复杂，但只要你意识到这一点。

文件交换是你的朋友： http: [//www.mathworks.com/matlabcentral/fileexchange/24992-ini-config](http://www.mathworks.com/matlabcentral/fileexchange/24992-ini-config)

您还可以使用 Java 属性文件。（我在文件交换中找不到任何东西。您必须自己编写接口。）

# php - 有事吗？

> ID：10524609
> 
> 赞同：-8
> 
> 时间：2012-05-09T21:51:59.203
> 
> 标签：php, javascript

当我运行以下代码时：

```
<html><head>
<title>Code</title> 
<script type="text/javascript">
var height = "<?= $height ?>";
var width = "<?= $width ?>";
if (self.parent.frames.length && self.parent.frames.length != 0) 
self.parent.location = document.location;

window.resizeTo(width,height);
window.moveTo(0,0);
</script>
</head>
<body>
<?php
$url_path = $_GET['url'];
echo "<img src={$url_path} />";
list($width,$height) = getimagesize({$url_path})
?>
</body>
</html> 
```

什么都没发生。（显然页面上有一个表格要求输入图像网址..）

我需要一些帮助，我是 javascript 和 php 的绝对初学者，有帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:56:43.710

```
list($width,$height) = getimagesize({$url_path}) 
```

这是一个语法错误。你不需要`{}`周围`$url_path`。删除它们。

您可能还想在这一行的末尾添加一个分号。当语句是 PHP 块中的最后一个语句时，您可能不需要它们，但如果您在此之后添加行，它会防止头痛。

更新：您的`list($width,$height)`行位于文件末尾（在 之后`var height = "<?= $height ?>";`）。这意味着`$height`并且`$width`将*在*您尝试访问它们之后设置。

# node.js - 如何在 Rabbit.js 上创建 REP/REQ

> ID：10524613
> 
> 赞同：2
> 
> 时间：2012-05-09T21:52:17.963
> 
> 标签：node.js, rabbitmq

我在 .Net 上使用 RabbitMQ 已经有一段时间了，对此我没有太大的问题。现在我正在使用 node.js 迁移到 rabbit.js，但我对它不太熟悉。rabbit.js 的文档有限。我只知道基本的 PUSH/PULL 或 PUB/SUB。现在我想做 REQ/REP 但我不知道怎么做。任何人都可以分享一些片段。

非常感谢您的回复。

最好的，

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-17T19:19:34.937

这可能比您要求的要多，但我有一个片段（即使它很长）用于使用[node-amqp](https://github.com/postwait/node-amqp)而不是 REQ/RES 和 rabbit.js 进行 RPC。我所做的类似于您在[RabbitMQ 教程](http://www.rabbitmq.com/tutorials/tutorial-six-python.html)中找到的关于 RPC的内容

目前，消息中的内容应该是一个对象（散列），它将被 amqp 模块转换为 json。

AmqpRpc 类在初始化时采用 amqp 连接，然后只需调用 makeRequest 并等待回调中的响应即可。响应具有**function(err, response)**的形式，其中 err 可能是超时错误

很抱歉，它不完全符合您的要求，但可能已经足够接近了。我还将代码作为要点发布在 github 上：[https ://gist.github.com/2720846](https://gist.github.com/2720846)

**编辑：** 示例更改为支持多个未完成的请求。

**amqprpc.js**

```
var amqp = require('amqp')
  , crypto = require('crypto')

var TIMEOUT=2000; //time to wait for response in ms
var CONTENT_TYPE='application/json';

exports = module.exports = AmqpRpc;

function AmqpRpc(connection){
  var self = this;
  this.connection = typeof(connection) != 'undefined' ? connection : amqp.createConnection();
  this.requests = {}; //hash to store request in wait for response
  this.response_queue = false; //plaseholder for the future queue
}

AmqpRpc.prototype.makeRequest = function(queue_name, content, callback){
  var self = this;
  //generate a unique correlation id for this call
  var correlationId = crypto.randomBytes(16).toString('hex');

  //create a timeout for what should happen if we don't get a response
  var tId = setTimeout(function(corr_id){
    //if this ever gets called we didn't get a response in a 
    //timely fashion
    callback(new Error("timeout " + corr_id));
    //delete the entry from hash
    delete self.requests[corr_id];
  }, TIMEOUT, correlationId);

  //create a request entry to store in a hash
  var entry = {
    callback:callback,
    timeout: tId //the id for the timeout so we can clear it
  };

  //put the entry in the hash so we can match the response later
  self.requests[correlationId]=entry;

  //make sure we have a response queue
  self.setupResponseQueue(function(){
    //put the request on a queue
    self.connection.publish(queue_name, content, {
      correlationId:correlationId,
      contentType:CONTENT_TYPE,
      replyTo:self.response_queue});
  });
}

AmqpRpc.prototype.setupResponseQueue = function(next){
  //don't mess around if we have a queue
  if(this.response_queue) return next();

  var self = this;
  //create the queue
  self.connection.queue('', {exclusive:true}, function(q){  
    //store the name
    self.response_queue = q.name;
    //subscribe to messages
    q.subscribe(function(message, headers, deliveryInfo, m){
      //get the correlationId
      var correlationId = m.correlationId;
      //is it a response to a pending request
      if(correlationId in self.requests){
        //retreive the request entry
        var entry = self.requests[correlationId];
        //make sure we don't timeout by clearing it
        clearTimeout(entry.timeout);
        //delete the entry from hash
        delete self.requests[correlationId];
        //callback, no err
        entry.callback(null, message);
      }
    });
    return next();    
  });
} 
```

下面是一个关于如何使用它的小例子。保存两个代码部分，然后运行...

```
node client.js 
```

如果您没有服务器来提供回复，则请求将超时。

**客户端.js**

```
//exmaple on how to use amqprpc
var amqp = require('amqp');
var connection = amqp.createConnection({host:'127.0.0.1'});

var rpc = new (require('./amqprpc'))(connection);

connection.on("ready", function(){
  console.log("ready");
  var outstanding=0; //counter of outstanding requests

  //do a number of requests
  for(var i=1; i<=10 ;i+=1){
    //we are about to make a request, increase counter
    outstanding += 1;
    rpc.makeRequest('msg_queue', {foo:'bar', index:outstanding}, function response(err, response){
      if(err)
        console.error(err);
      else
        console.log("response", response);
      //reduce for each timeout or response
      outstanding-=1;
      isAllDone();
    });
  }

  function isAllDone() {
    //if no more outstanding then close connection
    if(outstanding === 0){
      connection.end();
    }
  }

}); 
```

我什至会投入一个示例服务器以进行良好的衡量

**服务器.js**

```
//super simple rpc server example
var amqp = require('amqp')
  , util = require('util');

var cnn = amqp.createConnection({host:'127.0.0.1'});

cnn.on('ready', function(){
  console.log("listening on msg_queue");
  cnn.queue('msg_queue', function(q){
      q.subscribe(function(message, headers, deliveryInfo, m){
        util.log(util.format( deliveryInfo.routingKey, message));
        //return index sent
        cnn.publish(m.replyTo, {response:"OK", index:message.index}, {
            contentType:'application/json',
            contentEncoding:'utf-8',
            correlationId:m.correlationId
          });
      });
  });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T05:30:07.860

[https://github.com/demchenkoe/node-amqp-rpc](https://github.com/demchenkoe/node-amqp-rpc)

我发现这对于在 rabbitMQ 上使用 node 执行 rpc 非常有用。强烈推荐。

# c++ - Opencv：cvCaptureFromCAM返回NULL

> ID：10524616
> 
> 赞同：3
> 
> 时间：2012-05-09T21:52:28.573
> 
> 标签：c++, opencv, video, webcam

我在 Linux Mint 中（不知道版本）并且正在使用 Logitech Orbit AF 网络摄像头。我尝试以下代码，但我得到的只是“错误：捕获为空！” 请帮忙！！！！！

```
#include<cv.h>
#include<highgui.hpp>
#include<iostream>

using namespace std;

int main() {
    //Data Structure to store cam.
    CvCapture* cap=cvCaptureFromCAM(0);
    //Image variable to store frame
    IplImage* frame;
    //Window to show livefeed
    cvNamedWindow("LiveFeed",CV_WINDOW_AUTOSIZE);
    if(!cap)
    {
        cout << "ERROR: Capture is null!\n";
    }
    while(1)
    {
        //Load the next frame
        frame=cvQueryFrame(cap);
        //If frame is not loaded break from the loop
        if(!frame)
            break;
        //Show the present frame
        cvShowImage("LiveFeed",frame);
        //Escape Sequence
        char c=cvWaitKey(33);
        //If the key pressed by user is Esc(ASCII is 27) then break out of the loop
        if(c==27)
           break;
    }
    //CleanUp
    cvReleaseCapture(&cap);
    cvDestroyAllWindows(); 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T21:57:17.703

当此调用返回时`NULL`：

```
CvCapture* cap = cvCaptureFromCAM(0);
if (!cap)
{
    // print error and exit
    cout << "ERROR: Capture is null!\n";
    return -1;
} 
```

这意味着在 index 处未找到任何设备`0`。尝试通过`CV_CAP_ANY`让 OpenCV 为您选择一个有效的索引号。

如果这不起作用，则可能是 OpenCV 不支持您的相机。尝试在[此列表](http://opencv.willowgarage.com/wiki/Welcome/OS)中找到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T00:03:22.970

我注意到最新版本的 opencv 对我不起作用（2.4.9）。我安装了 2.3，它现在神奇地工作了。

# hadoop - 为什么 RunJar 解压 jar 文件？

> ID：10524618
> 
> 赞同：0
> 
> 时间：2012-05-09T21:52:30.970
> 
> 标签：hadoop

示例： http: [//grepcode.com/file/repository.cloudera.com/content/repositories/releases/com.cloudera.hadoop/hadoop-core/0.20.2-320/org/apache/hadoop/util/RunJar。爪哇](http://grepcode.com/file/repository.cloudera.com/content/repositories/releases/com.cloudera.hadoop/hadoop-core/0.20.2-320/org/apache/hadoop/util/RunJar.java)

我正在查看 RunJar.main()，并观察到它解压缩了指定的 jar 文件，然后从原始 jar 和本地分解副本中的几个根构建了一个精心制作的类路径。

这是为了什么？单独包含原始 jar 文件未涵盖的爆炸 jar 支持哪些用例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T23:18:55.847

Hadoop 支持 Jar-in-jars（即 jar 文件中的 lib 文件夹中的 jar 文件 - 满口是不是！）。当前的 Java 版本都不支持 jar-in-jar（我认为有传言称 8 支持这一点，至少我认为我已经读过一些关于此的抱怨，但当然不要引用我的话），这就是Hadoop 实现了这一点。

当你可以创建一个 uber-jar 时，为什么还要做 jar-in-jar？构建时间可能是一个原因（解压和重新打包巨大的依赖罐可能会增加几秒钟甚至几分钟的构建时间）。我敢肯定还有更多，但对我来说，我认为由此产生的罐子“更干净”——我猜是个人喜好。

# python - 为什么数据没有写入数据库？（数据库管理，Python 3.2）

> ID：10524620
> 
> 赞同：0
> 
> 时间：2012-05-09T21:52:40.080
> 
> 标签：python, database, python-3.x, dbm

我一直在努力学习`pickle`和`dbm`python 模块。我编写了一些连接到 dbm 数据库并写入数据和腌制信息的代码。

```
import dbm
import pickle
class PickleDB:
    def set_dbname(self):
        self.db = dbm.open("pickle", "n")
    def get_data(self):
        self.raw_data = input("Enter your raw data")
        self.pickled_data = pickle.dumps(self.raw_data)
    def write_to_db(self):
        self.db["Raw"] = self.raw_data
        self.db["Pickled"] = self.pickled_data
pickled_db = PickleDB()
pickled_db.set_dbname()
pickled_db.get_data()
pickled_db.write_to_db() 
```

运行程序时一切正常，但是当我尝试访问数据库时出现问题。钥匙不可用。

```
>>> db = dbm.open("pickle", "n")
>>> db["Raw"]
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
KeyError: 'Raw'
>>>  db.keys()
[] 
```

为什么是这样？为什么数据没有写入数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T18:46:08.090

问题是当您使用选项“n”打开数据库时，您会清除数据库。来自`pydoc dbm`：

> 'n' 总是创建一个新的数据库。

您可能想看一下[搁置包](http://docs.python.org/py3k/library/shelve.html)。如果我了解您正在尝试做正确的事情，那么“搁置”已经为您完成了。

# google-app-engine - 如何在 GAE 中显示 Web 文件夹索引？

> ID：10524624
> 
> 赞同：0
> 
> 时间：2012-05-09T21:52:44.610
> 
> 标签：google-app-engine

我`myapp.appspot.com/myfolder`在 GAE 应用程序的公共静态文件夹中有几个文件，并且希望在打开该 URL 而不是错误 404 时查看文件夹索引（内容）。

我可以访问其中的单个文件，但看不到文件夹索引。

应用程序.yaml：

```
- url: /myfolder
  static_dir: myfolder 
```

也许在 app.yaml 中添加一些额外的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:08:15.710

如何[列出静态目录中的文件？](https://stackoverflow.com/questions/477135/how-to-list-the-files-in-a-static-directory).

App Engine 中没有用于浏览静态文件的内置解决方案。有人确实提出了一些示例代码[http://code.google.com/p/appfilesbrowser/](http://code.google.com/p/appfilesbrowser/)您可能可以利用。

# c++ - 尝试使用 make 文件编译时出错

> ID：10524628
> 
> 赞同：2
> 
> 时间：2012-05-09T21:53:07.443
> 
> 标签：c++, makefile, g++

``当我尝试使用 make 文件访问我的应用程序时出现错误。这是我第一次尝试自己创建一个 make 文件，我在网上找到了很多例子，但我无法让我的工作。然而，我得到的错误是一个编译错误，我手动编译的，我没有得到。错误是：

```
`dave@ubuntu:~/School/CS647/Programs/Homework4$ make
g++ -Wall -o StatWrapper StatWrapper.o tools.o
/usr/lib/gcc/x86_64-linux-gnu/4.6.1/../../../x86_64-linux-gnu/crt1.o: In function `_start':
(.text+0x20): undefined reference to `main'
collect2: ld returned 1 exit status
make: *** [StatWrapper] Error 1 
```

` 这是我的制作文件：

```
CC = g++
CFLAGS = -Wall
UTILDIR = ../../Utilities/
OBJECTS =  Sweeper.o FileID.o P4Ford.o DirentWrapper.o StatWrapper.o tools.o

all: StatWrapper DirentWrapper FileID Sweeper P4Ford

#P4Ford: $(OBJECTS)
#   $(CC) $(OBJECTS) -o P4Ford

DirentWrapper: DirentWrapper.o tools.o
    $(CC) $(CFLAGS) -o DirentWrapper DirentWrapper.o tools.o

StatWrapper: StatWrapper.o tools.o
    $(CC) $(CFLAGS) -o StatWrapper StatWrapper.o tools.o

P4Ford: P4Ford.o Sweeper.o
    $(CC) $(CFLAGS) -o P4Ford P4Ford.o Sweeper.o

Sweeper: Sweeper.o FileID.o StatWrapper.o DirentWrapper.o tools.o
    $(CC) $(CFLAGS) -o Sweeper Sweeper.o FileID.o StatWrapper.o DirentWrapper.o tools.o

FileID: FileID.o tools.o
    $(CC) $(CFLAGS) -o FileID FileID.o tools.o

#tools: tools.o
#   $(CC) $(CFLAGS) $(UTILDIR)tools.cpp

# dependencies ---------------------------------------------------
DirentWrapper.o: $(UTILDIR)DirentWrapper.cpp  $(UTILDIR)DirentWrapper.hpp
StatWrapper.o: $(UTILDIR)StatWrapper.cpp  $(UTILDIR)StatWrapper.hpp
P4Ford.o: P4Ford.cpp  Sweeper.hpp
Sweeper.o: Sweeper.cpp  FileID.hpp
FileID.o: FileID.cpp  $(UTILDIR)tools.hpp
tools.o: $(UTILDIR)tools.cpp $(UTILDIR)tools.hpp

# cleanup
clean:
    rm -f $(OBJECTS) 
```

我相信这是我的 make 文件的一个问题，因为它在我手动编译时可以工作，但我不能确定。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:37:59.667

只需添加`-c`到构建目标文件的规则中。如果没有这个，编译器会假定您正在创建一个需要`main()`定义的可执行文件。该`-c`标志表示不应该进行链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:24:41.583

```
StatWrapper: StatWrapper.o tools.o
    $(CC) $(CFLAGS) -o StatWrapper StatWrapper.o tools.o 
```

在此规则中，您将链接`StatWrapper.o`并`tools.o`创建可执行文件`StatWrapper`。这是行不通的，因为它们都没有`main`功能。

您需要删除所有这些无效规则并只留下一条，这会将所有目标文件组合成一个可执行文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:56:57.207

让我们从一个目标文件开始。Make 有一个用于编译文件的内置规则`.cpp`，但为了安全起见（和实践），我们将编写一个规则：

```
Sweeper.o: Sweeper.cpp FileID.hpp
    $(CC) $(CFLAGS) -c Sweeper.cpp -o Sweeper.o 
```

**在你走得更远之前测试一下。**

我们在该规则中看到了一些冗余，因此我们将使用[自动变量](http://www.gnu.org/software/make/manual/make.html#Automatic-Variables)对其进行一些清理：

```
Sweeper.o: Sweeper.cpp FileID.hpp
    $(CC) $(CFLAGS) -c $< -o $@ 
```

**在你走得更远之前测试一下。**

请注意，该命令没有`Sweeper`明确提及。当我们为其他目标文件编写规则时，它们都将具有相同的命令。所以我们可以将它们收集在一个[静态模式规则](http://www.gnu.org/software/make/manual/make.html#Static-Pattern)中：

```
OBJECTS =  Sweeper.o FileID.o P4Ford.o DirentWrapper.o StatWrapper.o tools.o

DirentWrapper.o: $(UTILDIR)DirentWrapper.cpp  $(UTILDIR)DirentWrapper.hpp
StatWrapper.o: $(UTILDIR)StatWrapper.cpp  $(UTILDIR)StatWrapper.hpp
P4Ford.o: P4Ford.cpp  Sweeper.hpp
Sweeper.o: Sweeper.cpp  FileID.hpp
FileID.o: FileID.cpp  $(UTILDIR)tools.hpp
tools.o: $(UTILDIR)tools.cpp $(UTILDIR)tools.hpp

$(OBJECTS) : %.o: %.cpp
    $(CC) $(CFLAGS) -c $< -o $@ 
```

现在您应该能够，例如，`make FileID.o`.

**在你走得更远之前测试一下。**

现在 Make 知道如何构建对象，我们只需要一条规则将它们链接到可执行文件中：

```
P4Ford: P4Ford.o Sweeper.o
    $(CC) $(CFLAGS) $^ -o $@ 
```

如果您将此作为第一条规则，Make 会将其视为默认规则。（你确定`P4Ford`只需要这两个目标文件吗？也许应该是`P4Ford: $(OBJECTS)`。）

# javascript - jQuery，如何禁用或启用页面加载时带有复选框的元素？我有一个简单的功能，可以在选中/取消选中复选框时禁用/启用选择元素。它运作良好。但是，一旦提交表单并且已经检查了复选框加载（在 PHP 的帮助下），选择不会被禁用，直到我单击该复选框两次。

> ID：10524631
> 
> 赞同：5
> 
> 时间：2012-05-09T21:53:17.737
> 
> 标签：javascript, jquery, html

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-09T22:00:46.553

看起来你快到了。只是几个语法错误。

```
$("#worldcb").click(function(){
    var el = $("#worldSelect");
    if (el){
        el.removeAttr("disabled");
        if (this.checked){
            el.attr("disabled", "disabled");     
        }
    }
}); 
```

这是一个[jsFiddle](http://jsfiddle.net/v22BB/6/)来演示。

至于页面回发时保持禁用状态，只需要在页面加载时运行一些逻辑即可。

```
if ($("#worldcb").is(":checked")){
    $("#worldSelect").attr("disabled", "disabled");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:12:55.063

好吧，您需要在加载时同步两者。还要更改toggleSelection，使其既可以作为事件处理程序调用，也可以独立运行

```
function toggleSelection( element, scope ){
    scope = scope || this;
    if (scope.checked) {
        $(element.data).attr('disabled', 'disabled');
    } else {
        $(element.data).removeAttr('disabled');
    }
}

$(function() {
    $('#worldcb').click('#worldSelect', toggleSelection);
    toggleSelection( { data : '#worldSelect' }, document.querySelector( '#worldcb' ) );
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T22:01:15.083

最简单的方法是将您的 toggleFunction 分配给文档就绪，因此每次页面加载时都会检查复选框状态，并正确显示选择。您可以将 autocomplete="off" 属性赋予特定的表单字段，使其不缓存（因此该复选框将在页面刷新后关闭）。

例子：

```
$(document).ready(function() {
    toggleSelection('#worldcb');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T22:00:57.290

如果您总是希望在页面加载时禁用它，只需将 disabled 属性添加到 select html 元素。

```
<select id="worldSelect" class="select" name="world" disabled></select> 
```

# winjs - WinJS 中的嵌套 Promise

> ID：10524632
> 
> 赞同：3
> 
> 时间：2012-05-09T21:53:39.890
> 
> 标签：winjs

我正在实现一个 DataAdapter 来绑定到一个 WinJS ListView 控件。该接口需要一个返回 Promise 的 getCount 方法。如果我直接返回一个 WinJS.xhr 对象，那效果很好。但是，我想在将其传递回调用者之前对其响应进行按摩。

我的问题是，如果我返回相同的 WinJS.xhr 对象，但在它的末尾加上一个“then”，它将输出并按摩它，那么调用者没有得到预期的输出（事情在肠子里爆炸了WinJS 库）。

所以，我想我不明白如何返回嵌套在 Promise 中的 Promise。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-14T05:47:16.670

一旦你弄清楚了，这很简单。

你需要知道两件事：

1.  在 promise 上调用 .then() 会返回一个新的 promise，
2.  您传递给的函数的返回值将成为该新承诺的值。

所以，要做你想做的事情，它是这样的：

```
return WinJS.xhr({url: whateverYourURlIs })
    .then(function (response) {
        var tweakedResponse = processResponse(response);
        return tweakedResponse;
    }); 
```

# java - Java - 从匿名内部类访问变量

> ID：10524635
> 
> 赞同：1
> 
> 时间：2012-05-09T21:53:54.727
> 
> 标签：java, inner-classes

> **可能重复：**
> [无法引用在不同方法中定义的内部类中的非最终变量](https://stackoverflow.com/questions/1299837/cannot-refer-to-a-non-final-variable-inside-an-inner-class-defined-in-a-differen)

我只是在做实验，有一个问题。

为什么当我从匿名内部类访问非最终类变量时这是可以接受的：

```
static JLabel e = new JLabel("");
    public static void main(String[] args) {

        JButton b = new JButton("ok");
        b.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent arg0) {
                String l = e.getText();

            }

        });

    } 
```

但是如果没有 final 修饰符，以下内容是不可接受的：

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T22:00:14.350

因为类变量是静态的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T22:08:48.907

我在下面修改了这个类。希望这可以帮助您看到答案。

`e.getText()`在原始代码中只是`SomeClass.e.getText()`下面代码中的简写。同一包中的任何类`SomeClass`都可以对`e.`.

另一方面，同一包中的其他类`SomeClass`不能引用`args`。

```
class SomeClass {
    static JLabel e = new JLabel("");
    public static void main(String[] args) {

        JButton b = new JButton("ok");
        b.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent arg0) {
                String l = SomeClass.e.getText();

            }

        });

    }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-09T21:59:26.667

前几天我给别人回答了这个问题

答案是 args 超出了您的范围上下文。如果它不是最终的，它可能会在你的 actionPerformed 方法被调用时发生变化。在这种情况下，您将 args 视为另一个可能存在或可能不存在的堆栈帧上的一个位置 - 这在 Java 中绝对是不可以的。当您声明 args final 时，它可以将变量复制到您的内部类中

# typo3 - TYPO3 4.7 colPos 不适用于 TemplaVoila，需要替代

> ID：10524636
> 
> 赞同：1
> 
> 时间：2012-05-09T21:54:21.180
> 
> 标签：typo3, typoscript, templavoila

我是 TypoScript 的新手，我想知道如何在我的 TemplaVoila 结构的第二列中获取内容。我以前用过`colPos = <position>`，但它不再工作了。我展示了我的 TypoScript！有人知道替代方法`colPos`，如果是，请帮助我

```
lib.sliderThumbs = CONTENT
lib.sliderThumbs{
  table = tt_content
  select.pidInList = 2
  select.where = colPos = 2
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:44:06.947

首先检查是否`select.where = colPos = 0`适合您。

在 TemplaVoila (TV) 中，当您添加新`Page-Content Element`内容时，默认设置为将内容元素放置在`colPos = 0`. 所以别管你有多少电视栏目，因为 TypoScript 都会把它们放在`normal column`. 要更改此设置，您需要更改每个电视栏的电视设置中的`Old style column number`字段值。`Extra`如电视向导中所述：

```
Column number (0=normal, 1=left, 2=right, 3=border) 
```

您也可以直接在 DataStructure 的选定字段的 XML 中更改它：

```
<oldStyleColumnNumber>2</oldStyleColumnNumber> 
```

但是我认为使用电视向导会更容易。

# .net - 使用 ClickOnce .NET 应用程序显示修订历史的机制

> ID：10524637
> 
> 赞同：2
> 
> 时间：2012-05-09T21:54:24.880
> 
> 标签：.net, clickonce, history, revision, changelog

> **可能重复：**
> [寻找在 ClickOnce 应用程序中显示发行说明的建议](https://stackoverflow.com/questions/6871144/looking-for-recomendation-to-show-release-notes-in-clickonce-applications)

我正在使用 ClickOnce 部署一个 .NET Winforms 应用程序，主要是为了便于自动检测到软件更新。

目前，当发布新版本时，会通知用户有可用的更新，但是没有机制可以向他们显示此新更新中实际包含的内容。理想情况下，我想要一种简单的方法将其连接到我的错误跟踪系统（我们正在使用 Redmine）。

现在我不致力于 ClickOnce，因此对允许轻松自动更新的其他替代方案持开放态度，但我真的想让用户知道新软件更新中包含哪些类型的更改，并可能允许他们重新访问此信息帮助 \ 新功能菜单。

与 .NET 无关，但我看到 Adob​​eAir 似乎做得很好，而且 iTunes 应用程序也有一种方法可以在升级之前显示更改的内容，ClickOnce 或其他 .NET 替代品可以做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T03:38:23.050

我处理这个问题的方法是在部署中包含一个 html 页面；在此页面上，显示更新信息。然后，当您的应用程序运行时，检查文件是否存在，以及 ApplicationDeployment.IsFirstRun 是否为真，如果是，则显示页面。您也可以只打开浏览器并显示一个在线页面（如果他们可以访问互联网）。

IsFirstRun 仅在用户在更新或安装 ClickOnce 应用程序后首次运行应用程序时为真。您还想在检查 IsFirstRun 之前检查 IsNetworkDeployed；这将检查它是否作为 ClickOnce 应用程序运行。如果您检查 IsFirstRun 并且它没有作为 C/O 应用程序运行，它将引发异常。

```
 if (ApplicationDeployment.IsNetworkDeployed)
     {
        if (ApplicationDeployment.CurrentDeployment.IsFirstRun)
        {
           //Show the page if it exists
        }
     } 
```

# express - Express.js 和 Mustache 中的局部渲染

> ID：10524640
> 
> 赞同：3
> 
> 时间：2012-05-09T21:55:18.320
> 
> 标签：express, mustache

我正在尝试在 express.js 中加载 Mustache 部分，但显然我遇到了一些麻烦。是否可以采用这样的 EJS 方法，其中包含视图部分文件：

[Node.js - EJS - 包括部分](https://stackoverflow.com/questions/5404830/node-js-ejs-including-a-partial)

我有一个名为**index.html的模板文件**

```
<html>
    <head>
        <title>My Title</title>
    </head>
    <body>
        {{>header}}
    </body>
</html> 
```

和**header.mustache**

```
<div class="header">
    <div style="display: table-cell;padding-left: 10px;padding-top: 8px;vertical-align: middle;">
        <img src="images/logo.png">
    </div>
</div> 
```

在 express.js 中，我的渲染函数是这样的：

```
app.get('/', function(req, res) {
    res.render('signup.html', {
        partials: {
            header: partial('header.mustache')   //this line is wrong        
        }
    });
}); 
```

我是这方面的新手，但想以某种方式将 header.mustache 的全部内容呈现或读取到 header 对象。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:46:39.550

查看以下链接，它可能会解释如何使用 express.js 设置 mustache

[在 Express 中使用 Mustache 模板](http://bitdrift.com/post/2376383378/using-mustache-templates-in-exress)

现在为了能够从外部文件加载部分修改 tmpl.compile 到以下

```
compile : function(source, options) {
    var views = options.views || './views';
    var extension = options.extension || '.html';

    if (typeof source == 'string') {
        return function(options) {
            options.locals = options.locals || {};
            options.partials = options.partials || {};

            if (options.body) // for express.js > v1.0
                locals.body = options.body;

            for(var p in options.partials) {
                var partialFileName = views + '/' + options.partials[p] + extension;

                if(path.existsSync(partialFileName)) {
                    options.partials[p] = fs.readFileSync(partialFileName, "utf-8");
                }
            }               
            return mustache.to_html(source, options.locals, options.partials);
        };
    } else {
        return source;
    }
} 
```

您还需要添加以下 2 个要求语句

```
var fs = require("fs"),
var path = require("path"); 
```

此更改假定您的部分位于`views`目录中并以扩展名结尾`.html`（因此，例如，您可能希望将部分的扩展名更改为 .html 或相应地调整上述代码）

现在您可以使用以下进行部分渲染

```
app.get('/', function(req, res) {
    res.render('signup.html', {
        partials: {
            header: 'header'   //this now works :)
        }
    });
}); 
```

# c# - 正则表达式帮助从字符串中提取值

> ID：10524643
> 
> 赞同：2
> 
> 时间：2012-05-09T21:55:26.317
> 
> 标签：c#, regex

我不知道如何从字符串中提取具有特定匹配的特定数字。

例子：

```
string myString = "blah blah **[10]** blah **[20]** and some more blah **[30]**";
Regex myIDsReg = new Regex(@"\*\*\[(\d+)\]\*\*"); 
```

显然正则表达式是合理的。

```
Match myMatch = myIDsReg.Match(myString); 
```

产生 "**[10]**" 但没有别的。

我不知道如何获得具有以下值的数组：10、20、30

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T21:57:38.420

使用[`Matches`](http://msdn.microsoft.com/en-us/library/e7sf90t3.aspx)而不是`Match`.

```
foreach (Match match in myIDsReg.Matches(myString))
{
    // etc...
} 
```

在线查看它：[ideone](http://ideone.com/xyo6u)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:05:04.697

我会这样做

```
string myString = "blah blah **[10]** blah **[20]** and some more blah **[30]**";
Regex myIDsReg = new Regex(@"\*\*\[(\d+)\]\*\*");
string[] regexResult = (from Match match in myIDsReg.Matches(myString) select match.Groups[1].Value).ToArray(); 
```

您也可以选择所需的输出

```
List<string> regexResult = (from Match match in myIDsReg.Matches(myString) select match.Groups[1].Value).ToList(); 
```

或者

```
IEnumerable<string> regexResult = (from Match match in myIDsReg.Matches(myString) select match.Groups[1].Value); 
```

我更喜欢后两者之一

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T22:19:39.067

Trikks 想出了最好的答案。我只需要对其进行一些修改以使其最适合我。

```
string myString = "blah blah **[10]** blah **[20]** and some more blah **[30]**";
Regex myIDsReg = new Regex(@"\*\*\[(\d+)\]\*\*");
string[] regexResult = (from Match match in myIDsReg.Matches(myString) select match.Groups[1].Value).ToArray(); 
```

我基本上用“select match.Groups[1].Value”替换了“select match.Value”。

谢谢你的帮助！

# svn - tortoise svn 给我“检测到 URL 'domain/svn' 的重定向周期”

> ID：10524646
> 
> 赞同：14
> 
> 时间：2012-05-09T21:55:37.670
> 
> 标签：svn, apache2, tortoisesvn, mod-dav-svn

我想在 /var/svn 和 repositories(projects) 中实现 svn-root。我可以让它在浏览器中工作（[http://domain/url](http://domain/url)给了我“存储库集合”）但是 TortoiseClient 给了我标题中提到的错误。

我通过执行以下操作（缩短）在我的 ubuntu 服务器上设置了一个颠覆：

```
mkdir /var/svn
svnadmin create /var/svn/test 
```

我的 dav_svn.conf 如下所示：

```
<Location /svn>
  DAV svn
  SVNParentPath /var/svn
  SVNListParentPath On
</Location> 
```

我阅读了可能导致问题的符号链接，所以我也会附上我的 000-default 站点（这是标准的顺便说一句）：

```
<VirtualHost *:80>
    ServerAdmin webmaster@localhost

    DocumentRoot /var/www
    <Directory />
            Options FollowSymLinks
            AllowOverride None
    </Directory>
    <Directory /var/www/>
            Options Indexes FollowSymLinks MultiViews
            AllowOverride None
            Order allow,deny
            allow from all
    </Directory>

    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
    <Directory "/usr/lib/cgi-bin">
            AllowOverride None
            Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
            Order allow,deny
            Allow from all
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/error.log
    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel warn

    CustomLog ${APACHE_LOG_DIR}/access.log combined

Alias /doc/ "/usr/share/doc/"
<Directory "/usr/share/doc/">
    Options Indexes MultiViews FollowSymLinks
    AllowOverride None
    Order deny,allow
    Deny from all
    Allow from 127.0.0.0/255.0.0.0 ::1/128
</Directory> 
```

我尝试了[如何在 Apache+SVN 上使用 SVNParentPath 指令列出所有存储库中的建议？](https://stackoverflow.com/questions/488778/how-do-i-list-all-repositories-with-the-svnparentpath-directive-on-apachesvn) 但不幸的是，我得到了另一个乌龟错误（虽然我仍然可以在浏览器中看到它）然后它给了我“OPTIONS 请求在响应中返回了无效的 XML：第 1 行的 XML 解析错误：未找到元素”（和 HTTP OPTIONS到那个 url 确实没有给出响应体）

有谁知道是什么导致了这个问题？

干杯!

编辑：这是尝试通过 tortoise访问[http://server/svn后的 access.log 输出](http://server/svn)

（带位置 /svn）注意 301 .. TortoiseSVN 将路径更改为 ' [http://server/svn](http://server/svn) ' 没有前导斜杠，但我指定在 ' [http://server/svn](http://server/svn) **/** '中搜索

```
[10/May/2012:00:42:29 +0200] "OPTIONS /svn HTTP/1.1" 301 573 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:29 +0200] "OPTIONS /svn HTTP/1.1" 301 573 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:29 +0200] "OPTIONS /svn HTTP/1.1" 301 573 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:29 +0200] "PROPFIND /svn HTTP/1.1" 301 516 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:29 +0200] "OPTIONS /svn HTTP/1.1" 301 573 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:29 +0200] "PROPFIND /svn HTTP/1.1" 301 516 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:30 +0200] "OPTIONS /svn HTTP/1.1" 301 573 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:30 +0200] "PROPFIND /svn HTTP/1.1" 301 516 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:30 +0200] "OPTIONS /svn HTTP/1.1" 301 573 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:30 +0200] "OPTIONS /svn HTTP/1.1" 301 573 "-" "SVN/1.7.4 neon/0.29.6"
[10/May/2012:00:42:30 +0200] "OPTIONS /svn HTTP/1.1" 301 573 "-" "SVN/1.7.4 neon/0.29.6"
[10/May/2012:00:42:30 +0200] "OPTIONS /svn HTTP/1.1" 301 573 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:30 +0200] "OPTIONS /svn HTTP/1.1" 301 573 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:30 +0200] "OPTIONS /svn HTTP/1.1" 301 573 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:42:30 +0200] "OPTIONS / HTTP/1.1" 200 236 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6" 
```

（位置/svn/）

```
[10/May/2012:00:36:57 +0200] "OPTIONS /svn HTTP/1.1" 200 236 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:36:57 +0200] "OPTIONS /svn HTTP/1.1" 200 236 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:36:57 +0200] "OPTIONS /svn HTTP/1.1" 200 236 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:36:57 +0200] "OPTIONS /svn HTTP/1.1" 200 236 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:36:58 +0200] "OPTIONS /svn HTTP/1.1" 200 236 "-" "SVN/1.7.4 neon/0.29.6"
[10/May/2012:00:36:58 +0200] "OPTIONS /svn HTTP/1.1" 200 236 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:36:58 +0200] "OPTIONS /svn HTTP/1.1" 200 236 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6"
[10/May/2012:00:36:58 +0200] "OPTIONS / HTTP/1.1" 200 236 "-" "SVN/1.7.4/TortoiseSVN-1.7.6.22632 neon/0.29.6" 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-26T14:56:47.007

我知道这是一个旧线程，但是为了其他找到它的人的利益：

只是一个猜测，但是您的浏览器给您的 url 是否有“viewvc”或 svn 浏览器添加的其他部分？

```
i.e. http://mysvn/viewvc/trunk/..... 
```

Tortoise 不会检查它，因为它不是一个实际的 svn url；您的 svn 网址可能类似于

```
http://mysvnsvr/mysvn/trunk..... 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-08-12T16:48:33.880

在 CentOS7 上，我删除了 Alias 指令并且它可以工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-29T18:18:00.487

TortoiseSVN 存储库浏览器似乎不支持浏览存储库集合。

因此，如果您有存储库：

```
/var/svn/repo1
/var/svn/repo2
/var/svn/repo3 
```

和`dav_svn.conf`

```
<Location /svn>
  DAV svn
  SVNParentPath /var/svn
  SVNListParentPath on
</Location> 
```

您可以使用指向 的 Web 浏览器浏览它们`http://server/svn`。

使用 TortoiseSVN 您还必须指定存储库的名称，例如

```
http://server/svn/repo1
http://server/svn/repo2
http://server/svn/repo3 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-03-15T22:28:20.173

在 Ubuntu 16.04 上遵循 @rdconsolo 建议，删除 Alias 指令，对我有用

```
#Alias /svn /var/lib/svn
<Location /svn>

DAV svn
SVNParentPath /var/lib/svn
SVNListParentPath On
AuthType Basic
AuthName "Subversion Repository"
AuthUserFile /etc/apache2/dav_svn.passwd
Require valid-user

</Location> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-08-27T20:32:34.703

`DocumentRoot`我在标准配置中遇到了问题，原因是我使用了与web 服务器和`SVNPath`websvn/davsvn 配置相同的目录。

有关详细信息，另请参阅[“svn：E195019：检测到 URL 的重定向周期”的原因是什么？](https://stackoverflow.com/questions/18474825/what-is-the-cause-of-svn-e195019-redirect-cycle-detected-for-url/18474826#18474826)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-03-05T14:44:14.273

对我来说，问题是我的文档根目录中有一个 .htaccess RewriteRule，要求在每个没有的 URL 中添加一个尾随 /。

因此，SVN 客户端尝试调用没有尾随 / 的 URL，例如“ [https://site/repos/project](https://site/repos/project) ”被 apache 重定向到“ [https://site/repos/project/](https://site/repos/project/) ”，因此 SVN客户端尝试再次访问“ [https://site/repos/project](https://site/repos/project) ”，依此类推。

**解决方案**：不要有任何添加尾随 / 可能影响您的 SVN url 的规则。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-07T01:52:13.497

添加：

```
SVNListParentPath on 
```

仅行就为我解决了这个问题。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-11-04T15:15:55.817

我有同样的问题，但不是针对多个存储库，只是存储库中的标签、分支等。删除 conf 文件中的 Alias 标记修复了此问题。我正在使用 SVN 1.8 和 Tortoise 1.9 运行 Centos 7。

# cakephp - cake php paginator 和 ajax - 如何在 ajax 请求之前调用函数？

> ID：10524647
> 
> 赞同：0
> 
> 时间：2012-05-09T21:55:41.377
> 
> 标签：cakephp, cakephp-2.0

我正在使用带有 ajax 的分页器：

```
$this->Paginator->options(array(
    'update' => '#content',
    'evalScripts' => true
)); 
```

它工作正常，但就在发送 ajax 请求之前（例如，当用户单击下一页时）我想在网站上显示一些“加载”信息。是否有任何选项可以在分页器中设置一些回调（javascript函数）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T14:24:59.893

由于 PaginatorHelper 在检测到“更新”键时使用 JsHelper 创建链接，因此您可以使用与 JsHelper 的链接和请求功能相关的所有键。

```
$this->Paginator->options(array(
    'update' => '#content',
    'evalScripts' => true,
    'beforeSend' => // do js stuff here
)); 
```

# cocos2d-iphone - 为什么 [TMXLayer positionAt: CGPoint] 对我不起作用？

> ID：10524648
> 
> 赞同：0
> 
> 时间：2012-05-09T21:55:54.633
> 
> 标签：cocos2d-iphone, position, cgpoint, tmx

我试图在我的 .tmx 地图中找到特定图块的像素位置。CCTMXLayer 类的 positionAt: 方法应该可以解决问题，但是每当我尝试使用它时，它都会返回一个坐标为 (0,0) 的 CGPoint。这是我正在使用的代码的一部分。

```
 // CCTMXTiledMap Declaration using my class MapLayer
    //which inherits from CCTMXTiledMap
    MapLayer *tileMap = [MapLayer node];
    CCTMXLayer *myLayer = [tileMap layerNamed: @"Middle"];
    NSLog(@"%i", [myLayer positionAt: CGPointMake(x,y)].x);
    NSLog(@"%i", [myLayer positionAt: CGPointMake(x,y)].y); 
```

无论 CGPointMake 的 x 和 y 的值是什么，CGPoint (0,0) 的值都会不断被记录，我不明白为什么。

编辑：

我只是用地图错误地声明我的图层吗？这是我的代码。

```
 //init method for MapLayer.m class file 
    @implementation MapLayer 
    -(id) init { 
    if( (self=[super initWithTMXFile: @"ZombearTilemap.tmx"])) { 
    } 
    return self; 
    } 

    //in my MainScene.m class init method
    MapLayer *tileMap = [MapLayer node]; 
    [self addChild: tileMap];
    CCTMXLayer *tileMapLayer = [tileMap layerNamed: @"Middle"];

    // (tileMapLayer == nil) returns false

    //tileMap.mapSize.width returns 0
    //[[tileMapLayer tileAt:ccp(x,y)] boundingBox].size.height returns 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T23:26:25.517

几件事要检查...

1.  有效（不是`myLayer`零）？如果它为 nil，则您的 TMX 文件中没有名为“Middle”的层，或者您的 TMX 文件没有被加载。
2.  是`myLayer.mapTileSize.width`和`myLayer.mapTileSize.height`非零？如果它们为零，那么您的 TMX 文件和/或`CCTMXTiledMap`.

**总体建议：** Cocos2d 是开源的！设置一个断点，进入`CCTMXLayer`'s 的代码`-(CGPoint) positionAt:(CGPoint)pos`并找出那里发生了什么。

* * *

**编辑：**

如果您使用“平铺”来创建 TMX 文件，请进入首选项并将“将平铺图层数据存储为：”从“Base64（gzip 压缩）”更改为“XML”。Cocos2d 无法读取这种 TMX 编码，但这让您可以通过在任何类型的文本编辑器或 Web 浏览器中打开 TMX 文件轻松查看数据。
（如果你不使用 Tiled，我不知道你是如何创建 TMX 文件的，但是去这里获取它：http: [//www.mapeditor.org/](http://www.mapeditor.org/)）

更改首选项后，打开并将您的 TMX 文件重新保存到其他位置。您可能应该将其重命名为 -XML.tmx 或其他名称，这样您就不会意外地尝试稍后将其提供给 cocos2d 并想知道为什么它没有加载。;)

您的图层`mapTileSize`从地图的属性中获取其`tileSize`属性。该属性是从您的 TMX 文件的元素中设置的。这是一个例子：`<map version="1.0" orientation="orthogonal" width="160" height="96" tilewidth="16" tileheight="16">`

如果那里的一切看起来都不错，那么您在代码中的某处不小心将此值重置为 0。如果它搞砸了，那么您需要手动调整这个 xml 文件，或者使用正确的 tilesize 值从头开始重新创建您的 TMX 文件。

不要忘记将您在 Tiled 中的首选项更改回“Base64（gzip 压缩）”以将您的工作保存为 cocos2d 可以加载的格式。

# c - c语言中的sockets tcp示例

> ID：10524650
> 
> 赞同：1
> 
> 时间：2012-05-09T21:56:05.713
> 
> 标签：c, sockets, tcp

我正在寻找一个简单的 TCP 服务器/客户端的好例子，它可以将消息从一个客户端传递到另一个客户端。我看过很多例子，但我只能找到非常复杂的例子，或者只有一个客户端与服务器通信并返回，而不是彼此通信。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T22:03:22.913

[请参阅http://beej.us/guide/bgnet/output/html/singlepage/bgnet.html](http://beej.us/guide/bgnet/output/html/singlepage/bgnet.html)上的 selectserver.c 。客户端在页面的前面定义，服务器似乎很容易扩展。

# mysql - 索引布尔字段是否有任何性能提升？

> ID：10524651
> 
> 赞同：128
> 
> 时间：2012-05-09T21:56:12.643
> 
> 标签：mysql, indexing, innodb

我正要编写一个包含`WHERE isok=1`. 顾名思义，`isok`是一个布尔字段（实际上`TINYINT(1) UNSIGNED`是根据需要设置为 0 或 1 的 a）。

索引该字段是否有任何性能提升？引擎（在这种情况下为 InnoDB）在查找索引时的性能会更好还是更差？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2013-12-10T20:12:22.433

只是在这里对其他几个答案提出更详细的说明，因为根据我的经验，那些查看此类问题的人与我们在同一条船上，我们都听说索引布尔字段是没有意义的，但是......

我们有一个大约有 400 万行的表，一次只有大约 1000 行左右会标记一个布尔开关，这就是我们搜索的内容。在我们的布尔字段上添加索引将查询速度提高了几个数量级，从大约 9 多秒到几分之一秒。

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2012-05-09T22:02:12.383

并不真地。你应该把它当作一本书来思考。如果一本书中只有 3 种单词并且您将它们全部编入索引，那么您的索引页数将与普通页数相同。

如果一个值的记录相对较少，则会有性能提升。例如，如果您有 1000 条记录，其中 10 条为 TRUE，那么如果您使用`isok = 1`

正如迈克尔杜兰特所提到的，它也使写入速度变慢。

编辑：可能的重复：[索引布尔字段](https://stackoverflow.com/questions/1844991/indexing-boolean-fields)

在这里它解释说，即使你有一个索引，如果你有太多的记录，它也不会使用索引。 [MySQL 在检查 = 1 时不使用索引，而是在 = 0 时使用它](https://stackoverflow.com/questions/6084460/mysql-not-using-index-when-checking-1-but-using-it-with-0)

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2012-05-09T22:11:27.223

这取决于实际查询和索引/查询组合的选择性。

**案例A**：条件`WHERE isok = 1`，没有别的：

```
SELECT *
FROM tableX
WHERE isok = 1 
```

*   如果索引有足够的选择性（假设您有 1M 行，而只有 1k 行`isok = 1`），那么 SQL 引擎可能会**使用该索引**并且比没有它更快。

*   如果索引的选择性不够（假设您有 1M 行且超过 100k 行`isok = 1`），那么 SQL 引擎可能**不会使用索引**并进行表扫描。

**案例 B**：条件`WHERE isok = 1`和更多内容：

```
SELECT *
FROM tableX
WHERE isok = 1
  AND another_column = 17 
```

然后，这取决于您拥有的其他索引。上的索引`another_column`可能比`isok`只有两个可能值的索引更具选择性。一个索引`(another_column, isok)`或`(isok, another_column)`会更好。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2017-04-07T08:53:53.327

这取决于数据的分布。

想象一下，我有一本书，有 1000 页紧密排版，而我书中唯一的词是“是”和“否”，一遍又一遍地重复并随机分布。如果我被要求圈出所有“是”的实例，书后的索引会有所帮助吗？这取决于。

如果是和否的随机分布有一半，那么在索引中查找将无济于事。索引会使这本书变得更大，无论如何我会更快地从前面开始，通过每一页寻找“是”的所有实例并圈出它们，而不是查找每个项目索引，然后将索引条目中的引用指向它所引用的页面。

但是，如果在我的一千页书中只有十个“是”实例，而其他所有内容都只是数百万个“否”，那么索引将节省我大量时间来找到这十个“是”实例并圈出它们.

在数据库中也是如此。如果是 50:50 分布，那么索引将无济于事 - 数据库引擎最好从头到尾遍历数据（全表扫描），索引只会使数据库更大，并且写入和更新速度较慢。但是，如果它类似于 4000:1 分布（根据此线程中的*oucil*），那么如果它是您要查找的 4000 个项目中的 1 个，则索引搜索可以大大加快它的速度。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-05-09T22:05:20.297

不，通常不会。

当它们具有高选择性/基数时，您通常会索引字段以进行搜索。在大多数表中，布尔字段的基数非常低。它还会使您的写入速度稍微变慢。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-09T21:59:40.967

实际上，这取决于您运行的查询。但是，通常是的，以及索引任何其他类型的字段。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-09T21:59:54.493

是的，索引会提高性能，检查 EXPLAIN 有无索引的输出。

从文档：

> 索引用于快速查找具有特定列值的行。如果没有索引，MySQL 必须从第一行开始，然后读取整个表以查找相关行。桌子越大，成本越高。如果表有相关列的索引，MySQL 可以快速确定要在数据文件中间查找的位置，而无需查看所有数据。

我认为在这种情况下说索引不会*降低*性能也是安全的，所以你只需要从中获益。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-12-16T19:56:08.600

索引只是一张地图。检索所有将 i​​s_xxx 设置为 true 的行是 O(1)。没有它，您需要扫描整个表并针对其中的每一行检查此谓词，即 O(n)

# c++ - 正确使用 C++ 'for each' 选项

> ID：10524653
> 
> 赞同：2
> 
> 时间：2012-05-09T21:56:20.650
> 
> 标签：c++, qt, boost, foreach, std

[这些](https://stackoverflow.com/q/10522155/594137) [问题让我](https://stackoverflow.com/q/10523152/594137)*对每个*宏的 Boost 和 Qt 的用途感到好奇。

我使用过 Qt 并发现宏一直都能很好地满足我的需求，但从未广泛测试过它的性能。我以前没有使用过 Boost 的产品。

我想知道什么时候是使用 Qt 和 Boost over 提供的替代品的好时机`std::for_each`？

[*注意：措辞已经从[原来](https://stackoverflow.com/revisions/10524653/6)的改变，使问题更客观。*]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T21:31:51.923

的目的和功能`std::for_each`与宏`BOOST_FOREACH`和`Q_FOREACH`.

`std::for_each`首先是一个*函数调用*。它是一种算法。您调用它，提供一对迭代器。在迭代器范围的每个成员上，它将使用从相关迭代器中获取的值调用给定函数。

`std::for_each`从概念上讲，它的目的实际上是与已经存在的更具体的算法相匹配。使用 , 等算法`count`，`copy`让一个简单地为每个元素执行任意代码的算法是有意义的。

`BOOST_FOREACH`和`Q_FOREACH`是等效的结构（我将统称为`FOREACH`），但*行为*与`std::for_each`.

`FOREACH`首先是一个*for 循环*。现在，这听起来可能没什么不同，但想想看。你不能从内部调用`continue`和。可以很容易地模拟（尽管这也意味着您不能从发出调用的函数返回）。但是如果你想停下来，就没有办法摆脱循环。同样，您也不能跳出循环。在任何一种情况下，你能做的最好的事情就是抛出一个异常，那就是使用异常来进行流控制（即：不是一个好主意）。`break``std::for_each``continue``return``std::for_each``std::for_each``goto``for_each`

使用时`std::for_each`，必须提供一些可调用函数。这可以是函数指针或函数对象。因此，您的代码有些去本地化。如果您在每次迭代中所做的是一个复杂的多行函数，这很好。但是如果每次迭代的逻辑都非常简单，那么代码的可读性就会降低一点。

`FOREACH`执行本地代码块。所以代码就在那里；您无需跟踪函数即可查看每次迭代中发生的情况。

此外，调用函数意味着必须编写该函数。如果您需要跟踪状态，您现在需要一个函子，这需要编写更多代码。

C++11使用 lambda 函数`std::for_each` *更具*吸引力。这消除了代码局部性问题：源代码就在那里。而且由于 lambdas 可以捕获内容，它几乎可以像常规`for`循环一样工作。好吧，除了没有`break`功能，但这通常是可以避免的。

当然，C++11 还通过基于范围的循环使其有效地*过时*（连同`FOREACH`） 。`for`但是由于与 C++11 有不同级别的一致性，因此在某些环境中您有 lambda 但不是基于范围的`for`.

你*应该*使用什么取决于你。`FOREACH`很好，如果您已经在使用 Boost 和/或 Qt，请随意。但我不会突然开始使用这些只是为了`FOREACH`. `std::for_each`就个人而言，除非您还使用 lambdas 或其他东西，否则我不会使用，因为代码位置问题。只需使用一个`for`循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:19:15.523

`std::for_each`是 C++ 标准的一部分，并且自 1998 年以来一直是（至少）。因此，任何（不那么）现代 C++ 都是*不兼容的*，因此如果它不提供`for_each`. 我每天使用的所有编译器都支持它。

您提到的两个库都存在于 C++ 语言本身之外。 `for_each`是唯一一个保证出现在符合标准的编译器中的。

至于利弊，我留给你决定。如果可以选择，我会选择标准保证的东西，而不是不保证的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T21:20:56.903

std::for_each 需要一个**仿函数**、**lambda**或**函数指针**来执行。如果您在代码中的多个位置循环相同的方法，使用它可以避免大量样板。

```
 void hello(int i){
      printf("World %d \n",i);
 }

 std::vector<int> vals;
 vals.push_back(1);
 vals.push_back(2);
 std::for_each(vals.begin(),vals.end(),hello); 
```

BOOST_FOREACH 和 Q_FOREACH 用于隐藏 c++ 迭代器的样板文件，它们替换了正常的 for 语句并在循环体上循环。

```
 for(vector<int>::iterator iter = vals.begin();iter != vals.end();++iter)
  {
      hello(*iter);
  }

  Q_FOREACH(int val, vals){
      hello(val);
  } 
```

用法：您认为哪个最易读，并避免不必要的代码重复。

性能：每一个都是宏或模板函数，并且对编译器完全可见，差异应该只存在于调试版本中。

# emacs - 使抄送直接传递给emacs中的术语

> ID：10524656
> 
> 赞同：5
> 
> 时间：2012-05-09T21:56:34.617
> 
> 标签：emacs

我试图让 Cc 直接传递给 Emacs 中的术语（而不是必须键入 Cc Cc）。我定义了一个函数：

(defun newterm() (interactive) (term "/bin/bash") (rename-unique) (term-set-escape-char ?\Cx) (local-unset-key ?\Cc))

这成功地将转义字符设置为 Cx（我想要的），但我无法让 Emacs 不捕获 Cc。

也许不可能“禁用”但可以将 Cc 设置为仅将 Cc 放入终端吗？

默认值对我来说没有任何意义——我一直在终端中输入 Cc，而我在终端中运行的唯一 Emacs 命令是 Cx b 以获取不同的缓冲区。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T02:21:39.940

您需要重新设计键盘映射，因为它在很多事情上都使用“抄送”。但`(define-key term-raw-map [?\C-c] 'term-send-raw)`应该回答你的特定问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-12T21:26:19.490

您可以自定义变量`term-unbind-key-list`。

```
term-unbind-key-list is a variable defined in `multi-term.el'.
Its value is ("C-x" "C-h" "M-x" "C-z")
Original value was 
("C-z" "C-x" "C-c" "C-h" "C-y" "<ESC>")

Documentation:
The key list that will need to be unbind. 
```

在你的`.emacs`：

```
(setq term-unbind-key-list '("C-x"
                             "C-h"
                             "M-x"
                             "C-z")) 
```

# ms-access - MS Access问题将记录集中的值分配到文本框中

> ID：10524657
> 
> 赞同：1
> 
> 时间：2012-05-09T21:56:43.320
> 
> 标签：ms-access

这是一个非常简单的问题，但我一直无法使用谷歌找到解决方案。我很可能使用了错误的术语。对于解决我的问题或为我指明正确方向的任何帮助，我们将不胜感激。由于我公司的内部要求，我正在创建一个带有与 SQL Server 的 ODBC 连接的 Access 数据库，以维护用户定义的表。我已经有一段时间没有用 VBA 编程了。

我正在使用访问表单来提取要编辑的数据。按下按钮，查询运行并根据条件返回一行。我正在使用记录集来保存从查询中提取的信息。我的目标是将查询中的数据放入可以编辑的文本框中，然后对所做的更改执行更新语句。但是，我编写的将记录集数据放入各种文本框中的代码失败了，我无法弄清楚原因。

这是我的代码：

```
Dim rst As Recordset
    'add rows to record set
Set rst = CurrentDb.OpenRecordset("Select Parent_Name, Child_Name, Address, City, State, Zip, CustomerID, Facility, SystemID, " & _
            "from Table where CustomerID = '" & Forms!Frm_Edit_Child!cbx_Cust_ID & "' and  Facility = '" & Forms!Frm_Edit_Child!cbx_Facility & "' and SystemID = '" & _
            Forms!Frm_Edit_Child!cmb_SystemID & "';")

rst.MoveLast

Me.txt_Edit_IDN_Name.Text = rst.Fields("Parent_Name").Value
Me.txt_Edit_Customer_ID.Text = rst.Fields("CustomerID").Value
Me.txt_Edit_Facility.Text = rst.Fields("Child_Name").Value
Me.txt_Edit_Facility_Num.Text = rst.Fields("Facility").Value
Me.txt_Edit_Address.Text = rst.Fields("Address").Value
Me.txt_Edit_City.Text = rst.Fields("City").Value
Me.cmb_Edit_State.Text = rst.Fields("State").Value
Me.txt_Edit_Zip.Text = rst.Fields("Zip").Value
Me.cmb_Edit_SystemID.Text = rst.Fields("SystemID").Value 
```

我认为我尝试引用记录集中数据的方式是错误的，但我无法弄清楚我出错的地方或使用正确的术语通过 Google 找到解决方案。感谢您的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:50:00.417

我认为您对该代码有多个问题。在讨论它们之前，我会给你这个建议。告诉我们您的代码失败**远**不如告诉我们“`CurrentDb.OpenRecordset`触发错误 #3141，‘ *SELECT 语句包含保留字或参数名称拼写错误或缺失，或者标点不正确*’”

丢弃语句字段列表`SystemID`中的逗号。`SELECT`最后一个字段表达式后面不能跟逗号，否则会触发错误 #3141。

将您的`SELECT`语句存储在字符串变量中，然后`Debug.Print`在使用它打开记录集之前将其存储。

```
Dim strSelect As String
strSelect = "Select Parent_Name, Child_Name, Address, City, " & _
    "State, Zip, CustomerID, Facility, SystemID " & _
    "from [Table] where CustomerID = '" & _
    Forms!Frm_Edit_Child!cbx_Cust_ID & "' and  Facility = '" & _
    Forms!Frm_Edit_Child!cbx_Facility & "' and SystemID = '" & _
    Forms!Frm_Edit_Child!cmb_SystemID & "';"
Debug.Print strSelect
Set rst = CurrentDb.OpenRecordset(strSelect) 
```

然后，如果您仍然遇到错误`CurrentDb.OpenRecordset`，您可以转到立即窗口 (CTRL+g) 查看您要求 db 引擎使用的语句。当您看到实际完成的声明时，您可能会立即发现问题。如果没有，您可以复制该语句并将其粘贴到新查询的 SQL 视图中...找出需要进行哪些更改以避免错误，然后修改您的 VBA 代码，使其生成相同的正确 SQL 语句。如果这仍然不能解决您的问题，请将 SQL 粘贴到您的问题中，并告诉我们您从*该*SQL 获得的错误消息。

`Table`是保留字。请参阅[Access 中的问题名称和保留字](http://allenbrowne.com/AppIssueBadWord.html#T)。如果您必须将其保留为表名，请将其括在方括号中以避免混淆 Access 的数据库引擎。

如果您的应用程序包含 Microsoft ActiveX 数据对象的引用并且它的优先级高于 DAO，则下一行可能存在问题。

```
Dim rst As Recordset 
```

显式声明所需的记录集类型更安全。

```
Dim rst As DAO.Recordset 
```

`.Text`按照@user247245 的建议，从这些行中删除。该`.Text`属性仅适用于当前具有焦点的控件。

```
Me.txt_Edit_IDN_Name.Text 
```

你想要`.Value`。您可以添加它，但您不需要，因为`.Value`它是默认属性。所以这两个在功能上是等效的：

```
Me.txt_Edit_IDN_Name.Value
Me.txt_Edit_IDN_Name 
```

`SELECT`最后，我认为使用绑定到语句的表单会更简单。您不必填写文本框值，因为 Access 将使用绑定控件自动为您完成此操作。您可以根据 、 和在这些控件的更新后事件或命令按钮的单击事件中修改表单的`cbx_Cust_ID`记录`cbx_Facility`源`cmb_SystemID`。如果您向我们展示的代码来自不同的表单（不是`Frm_Edit_Child`），您将不得不使用命令按钮方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:07:53.180

已经很久了，但是：

*   .Text 是要走的路吗？尝试省略。

*   为什么不链接源表（到链接的 MS-Acess 表）并在表单上应用过滤器？根本不需要代码。查询很容易让 JET 解析这么少的带宽。还是完整性/安全问题？

# php - 将表单发布给自己时如何保留GET参数？

> ID：10524659
> 
> 赞同：13
> 
> 时间：2012-05-09T21:57:04.770
> 
> 标签：php, html, forms, post, get

我有一个带有一个 GET 参数的 URL。我正在尝试发布一个简单的表单，基本上只是简单地向 URL 添加一个 GET 参数。

当前网址：mysite.com/page.php?first=123

表单 HTML：

```
<?php $first = $_GET['first']; ?>

<form method="get" action="page.php?first=<?php echo $first; ?>">
<input type="text" name="second"><br>
<input type="submit" value="Submit"><br>
</form> 
```

我正在尝试获取 URL：mysite.com/page.php?first=123&second=456

但是，在提交表单时，页面 URL 会丢弃第一个 GET 参数并更改为：mysite.com/page.php?second=456

如何提交此表单并在第一个已经存在的 GET 参数之后添加第二个 GET 参数以添加到 URL 的末尾？

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-09T21:58:38.033

您需要改用隐藏输入：

```
<input type="hidden" name="first" value="<?php echo htmlspecialchars($first, ENT_QUOTES); ?>" /> 
```

# c# - 从分层集合中删除对象

> ID：10524663
> 
> 赞同：3
> 
> 时间：2012-05-09T21:57:12.720
> 
> 标签：c#, linq

我在分层列表中有一组 NodeObject 类。该列表可以是任意数量的深度。

```
public class NodeModel : ViewModelBase
{
    public Guid Id { get; set; }
    public string Caption { get; set; }
    public string Description { get; set; }
    public NodeType Type { get; set; }
    public List<NodeModel> Children { get; set; }
} 
```

如何使用其 Guid Id 从列表中删除一个项目，而不管它在列表中的哪个位置？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-09T22:37:01.223

这是一种递归方式：

```
private void DeleteNode(IList<Node> nodes, Guid id)
{
    Node nodeToDelete = null;
    foreach (var node in nodes)
    {
        if (node.Id == id)
        {
            nodeToDelete = node;
            break;
        }
        DeleteNode(node.Children, id);
    }
    if (nodeToDelete != null)
    {
        nodes.Remove(nodeToDelete);
    }
} 
```

如果您想在一个循环中完成所有操作，请使用 for 循环。不过，在我看来，阅读起来要困难得多。

```
private void DeleteNode(IList<Node> nodes, int id)
{
    for (var index = 0; index < nodes.Count; index++)
    {
        var currentNode = nodes[index];
        if (currentNode.Id == id)
        {
            nodes.Remove(currentNode);
            break;
        }
        DeleteNode(currentNode.Children, id);
    }
} 
```

另一种方法是使用包含所有元素的平面（非分层）列表**甚至字典（最快的方式！）。**您可以添加另一个属性，其中包含孩子的父 ID。在某些情况下，尤其是当您拥有包含大量项目的深层树时，这种方式的性能会更高。如果要删除某个项目，请执行以下操作：

```
private void DeleteNode(IList<Node> flatNodes, Guid id)
{
    var nodeToDelete = flatNodes.FirstOrDefault(n => n.Id == id);
    if (nodeToDelete != null)
    {
        var parent = flatNodes.First(n => n.Id == nodeToDelete.ParentId);
        parent.Children.Remove(nodeToDelete);
    }
}

private void DeleteNodeFromFlatDictionary(IDictionary<Guid, Node> flatNodes, Guid id)
{
    if (!flatNodes.ContainsKey(id)) return;
    var nodeToDelete = flatNodes[id];
    flatNodes[nodeToDelete.ParentId].Children.Remove(id);
} 
```

但是，如果您希望 UI 识别您需要使用的更改`ObservableCollection<Node>`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:42:03.977

换句话说，您要遍历一个图形并删除该项目。这里有一些问题：

*   它可以有循环吗？节点 A 有一个子节点，它有一个子节点 B，B 有 C 并且 C 指向 A（A -> B -> C -> A 等等）
*   有多个根吗？
*   是多图吗？

删除项目的问题是您如何处理孩子？如果 root 有 sam Guid 怎么办？最好的解决方案是遍历树并获取节点集合。

```
public static IEnumerable<T> Traverse<T>(T root, Func<T, IEnumerable<T>> children)
{
    var seen = new HashSet<T>();
    var stack = new Stack<T>();
    stack.Push(root);

    while(stack.Count != 0)
    {
        T item = stack.Pop();
        if (seen.Contains(item))
            continue;
        seen.Add(item);
        yield return item;
        foreach(var child in children(item))
            stack.Push(child);
    }
} 
```

然后打电话

```
var nodes = Traverse<NodeModel>(root, node => node.Children).ToList(); 
```

现在您可以从列表中删除（）元素或使用 Where（）过滤它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:26:10.630

我确信 LINQ 忍者可以编写一些不错的脚本，但我还不够精明。至少这里有一些可能对您有用的非递归、***未经测试的***代码：

```
public void RemoveNodeModelByGuid(NodeModel root, Guid guid)
{
    Stack<NodeModel> nodes = new Stack<NodeModel>();
    nodes.Add(root);

    while (nodes.Count > 0)
    {
        var currentNode = nodes.Pop();
        for (int i = currentNode.Children.Count - 1; i >= 0; i--)
        {
            if (currentNode.Children[i].Id == guid)
                currentNode.Children.RemoveAt(i);
            else
                nodes.Push(currentNode.Children[i]);
        }
    }
} 
```

请注意，它不会检查“根”节点的 ID（如果需要，您可以添加该检查），只是不知道在这种情况下该怎么做，因为没有任何东西可以删除。此外，如果其中一个与 Guid 匹配，它会停止检查分支（因此，如果父节点的 Id 匹配，它不会检查该节点的可能也具有匹配 Id 的子节点）。如果您确实需要检查已删除节点的子节点，只需将子节点推入堆栈，然后再将其删除。

# git - 真正可移植的 Git

> ID：10524664
> 
> 赞同：6
> 
> 时间：2012-05-09T21:57:15.380
> 
> 标签：git, bash, cygwin, portable-applications

我正在尝试使用它自己的 SSH 密钥在 USB 驱动器上创建一个完全可移植的 git 版本，并且我希望它能够工作，而不管 Windows 提供的驱动器号。我已经安装了便携式 git 并且大部分都可以工作。我遇到的问题是将它设置`$HOME`为动态的，我希望它指向`/DRIVELETTER/PortableApps/PortableGit`所以当我生成和使用我的 SSH 密钥时，它会转到`/DRIVELETTER/PortableApps/PortableGit/.ssh/`

现在`$HOME`是`/`，它为`//.ssh/id_rsa`不存在的 ssh 生成提供了默认路径。我找到了说“设置为`/e/bla/bla/bla/`”的网站，但如果驱动器号是`J`.

我还没有找到任何好的指南来设置真正可移植的 git。

感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T07:37:25.633

在批处理文件中首先执行

```
for /F "delims=\: usebackq" %%i in (`cd`) do SET USB_DRIVE=%%i 
```

然后其余时间（在批处理文件中）使用`%USB_DRIVE%`而不是 d: 或任何字母。

# c# - 以编程方式更改 AD 中的密码时访问被拒绝

> ID：10524665
> 
> 赞同：0
> 
> 时间：2012-05-09T21:57:16.690
> 
> 标签：c#, dll, active-directory

我们设置了一个小型库 (DLL)，用于更新 AD 中的密码。在我们的测试应用程序中测试这个应用程序时，它工作得很好。但是，一旦我们开始在另一个应用程序中使用该库，我们就会在尝试更改密码时收到**拒绝访问错误。**

当我们调用任何其他函数时，例如进行简单查找以查看用户是否存在的函数，一切正常。

```
 PrincipalContext ctx = new PrincipalContext(ContextType.Domain, TargetDomainServer, TargetDomainContainer, TargetDomainUser, TargetDomainPassword);
    UserPrincipalExt user = UserPrincipalExt.FindByIdentity(ctx, userLogonName);
    user.SetPassword(userPassword); 
```

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T22:05:12.093

您的测试应用程序可能以管理员身份运行。要么是因为它是从您的 IDE 运行的，要么是因为它有一个带有`requestedExecutionLevel`.

在 Windows Vista 和 7 上，以普通用户身份登录时运行应用程序并不意味着该进程没有以管理员身份运行。标有 的可执行文件有自动提升`requestedExecutionLevel`。尝试通过右键单击并选择它以管理员身份运行您的测试应用程序。

也有没有任何刻意的可执行标记的自动提升。Windows 有一个已知安装程序的内部列表。它实际上通过版本信息和二进制签名识别其中一些，并尝试以管理员身份运行它们，因此安装实际上会成功。IIRC，另一种识别方法是文件名。命名的可执行文件`setup.exe`也被提升（只要`requestedExecutionLevel`不覆盖它）。

# java - Android AsyncTaskLoader 不启动 loadInBackground？

> ID：10524667
> 
> 赞同：63
> 
> 时间：2012-05-09T21:57:22.790
> 
> 标签：java, android

我正在尝试在 Android 上实现加载程序示例，但无法启动加载程序。我正在使用以下代码。它会点击“Create Loader”，但永远不会到达“Loading started”日志消息。我错过了我需要的电话吗？

活动：

```
 public class TestingZoneActivity extends ListActivity implements LoaderCallbacks<ArrayList<Content>>{

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);

            getLoaderManager().initLoader(0, null, this);
        }

        @Override
        public Loader<ArrayList<Content>> onCreateLoader(int id, Bundle args) {
            Log.e("TEST", "Create Loader");
            return new ImageLoader(this);
        }

        @Override
        public void onLoadFinished(Loader<ArrayList<Content>> loader, ArrayList<Content> data) {
            setListAdapter(new ImageAdapter(this, data));
        }

        @Override
        public void onLoaderReset(Loader<ArrayList<Content>> loader) {
            setListAdapter(null);
        }
    } 
```

装载机：

```
 public class ImageLoader extends AsyncTaskLoader<ArrayList<Content>> {

        public ImageLoader(Context context) {
            super(context);
        }

        @Override
        public ArrayList<Content> loadInBackground() {
            Log.e("TEST", "Loading started");
        }

    } 
```

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2012-05-10T15:30:51.920

我在使用兼容性库时遇到了同样的问题。我通过调用解决了它`forceLoad`

```
getLoaderManager().initLoader(0, null, this).forceLoad(); 
```

显然 AsyncLoader 上的文档是缺失的，而且 HoneyComb 上也存在这个问题。更多信息可以在[这里找到](http://code.google.com/p/android/issues/detail?id=14944)

AsyncTaskLoader的官方[示例](http://developer.android.com/reference/android/content/AsyncTaskLoader.html)也是调用 forceLoad() 所以它不是一个错误，但我仍然认为这种行为不是很直观。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-05-17T17:41:09.877

覆盖`loadInBackground()`是不够的。

看看[http://developer.android.com/reference/android/content/AsyncTaskLoader.html](http://developer.android.com/reference/android/content/AsyncTaskLoader.html)。`AppListLoader`_

至少将这两种方法添加到您的加载程序中：

```
 @Override
        protected void onStartLoading() {
            if (takeContentChanged())
                forceLoad();
        }

        @Override
        protected void onStopLoading() {
            cancelLoad();
        } 
```

并`onContentChanged()`从其构造函数调用。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-10-20T18:36:26.893

[rayst](https://stackoverflow.com/users/2273946/rrayst)的建议非常紧凑。如果你这样写你的方法：

```
protected void onStartLoading() {
    forceLoad();
} 
```

您会注意到，当子活动出现然后您返回父活动时，`onStartLoading`（因此`loadInBackground`）再次被调用！

你能做什么？在构造函数内部将一个内部变量 ( `mContentChanged`) 设置为 true；然后在里面检查这个变量`onStartLoading`。只有当它为真时，才开始真正加载：

```
package example.util;

import android.content.Context;
import android.support.v4.content.AsyncTaskLoader;

public abstract class ATLoader<D> extends AsyncTaskLoader<D> {

    public ATLoader(Context context) {
        super(context);
        // run only once
        onContentChanged();
    }

    @Override
    protected void onStartLoading() {
        // That's how we start every AsyncTaskLoader...
        // -  code snippet from  android.content.CursorLoader  (method  onStartLoading)
        if (takeContentChanged()) {
            forceLoad();
        }
    }

    @Override
    protected void onStopLoading() {
        cancelLoad();
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-09-02T15:12:06.573

由于这里没有一个答案（除了接受的答案）单独帮助我解决了这个问题，这就是它对我的工作方式。

我不认为接受的答案是正确的解决方案，因为它会导致`loadInBackground()`调用频率超过必要，即在方向更改时，这在加载程序中正确覆盖以下方法时也不会发生：

```
@Override
public void deliverResult(final List<Participant> data) {
    participants = data;

    if (isStarted()) {
        super.deliverResult(data);
    }

}

@Override
protected void onStartLoading() {
    if (takeContentChanged() || participants == null) {
        forceLoad();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-03T16:50:26.190

如果您使用的是自定义加载器，则可以保存最后一个数据引用，并通过 getter 使其可用。当用户旋转他的屏幕时，您可以从 getLoaderManager().getLoader 方法中获取加载器，然后返回引用。对于我的测试，我注意到 startLoadering 一直到 CustomLoader.onLoadFinished 但结果永远不会传递给 activity.onLoadFinished。我怀疑活动参考在旋转时会丢失。顺便说一句，创建加载器的好处是它们通过 LoaderManager 持久化。把它想象成另一种无头碎片的味道……哈哈。

```
Loader loader  =  getLoaderManager().getLoader(LOADER_ID);

if( loader == null )
{
    getLoaderManager().initLoader(LOADER_ID, null, MyActivity.this );
}
else
{
    listAdapter.addAll(((CustomLoader) loader).getLastData());
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-30T09:05:25.427

我发现上述每个解决方案都有问题，尤其是当应用程序在屏幕关闭时启动，并且加载需要一些时间。

这是我的解决方案（基于[**此**](https://github.com/alexjlockwood/AppListLoader)）：

[https://stackoverflow.com/a/22675607/878126](https://stackoverflow.com/a/22675607/878126)

# c++ - 将来自套接字的 read() 的输出存储在 char 变量中

> ID：10524669
> 
> 赞同：1
> 
> 时间：2012-05-09T21:57:35.363
> 
> 标签：c++, sockets, char, recv

将来自 Socket 的 read() 或 recv() 操作的输出存储在 char 变量中的最简单方法是什么？

我正在将一段文本从客户端传递到服务器，并且需要将其读入一个 char 变量，然后将其显示并在应用程序的下方进一步使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:10:15.133

如果您正在从套接字读取，只需将您的 char 缓冲区的地址作为第二个参数传递给`read()` （或第二个参数，`recv()`或者`recvfrom()`如果您正在使用其中任何一个）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:17:28.743

你可以尝试这样的事情：

```
char buf[1024];
ssize_t n = read(fd, buf, sizeof(buf)); 
```

不要忘记检查和解释返回值`n`。

如果要传递数据，还可以使用`vector`：

```
std::vector<char> buf(1024);
ssize_t n = read(fd, buf.data(), buf.size()); 
```

# java - PreparedStatement 和 Connection 的“关闭”之间的关系？

> ID：10524670
> 
> 赞同：7
> 
> 时间：2012-05-09T21:57:35.567
> 
> 标签：java, database, prepared-statement

Javadoc 说 for `.close()`of the`PreparedStatement`说它..

> 立即释放此 Statement 对象的数据库和 JDBC 资源，而不是等待它自动关闭时发生。通常最好在使用完资源后立即释放资源，以避免占用数据库资源。
> 
> 对已关闭的 Statement 对象调用方法 close 无效。
> 
> 注意：当 Statement 对象关闭时，其当前的 ResultSet 对象（如果存在）也将关闭。

考虑以下场景

```
 MyConnector databaseConnector = DBManager.instance().getConnector();

    Connection con = databaseConnector.getConnection(); // returns java.sql.Connection
    PreparedStatement pstmt = null;

    try {
        pstmt = con.prepareStatement("some query");
         ...
    } finally {  
        if (pstmt != null)
            pstmt.close();
    } 
```

在这个例子中，`pstmt.close()`也将关闭`con`？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-09T22:00:29.793

关闭 a`Statement` *不会*关闭 a `Connection`。但是，关闭 a`Connection` *将*关闭 a `Statement`。

可以这样想：

*   连接 -> 创建并自动关闭 -> 语句
*   语句 -> 创建并自动关闭 -> ResultSet

所以关闭 a`Connection`将自动关闭任何`Statement`s*和*`ResultSet`它包含的任何s。

但是，如果可能的话，仍然认为最好手动关闭所有三个（`ResultSet`后跟）。`Statement``Connection`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T22:00:45.980

> 注意：当*Statement*对象关闭时，其当前的*ResultSet* [但不是 Connection] 对象（如果存在）也将关闭。

它不会关闭连接，它只是关闭结果集对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:07:52.917

如果您使用的是 Java 7，并且**`try-with-resources`**无需担心关闭连接或`Statement`任何`ResultSet`.

```
try (Connection conn = databaseConnector.getConnection();
     PreparedStatement pstmt = conn.prepareStatement("some query")) {
    ...
} catch (Exception e) {
    ...
} 
```

# activex - 是否有 x64 版本的 MsStkPrp.dll

> ID：10524676
> 
> 赞同：2
> 
> 时间：2012-05-09T21:57:55.743
> 
> 标签：activex, 64-bit, atl, clsid

我正在将 ATL 控件移植到 64 位。该控件在其属性对话框中使用 Stock 属性页（CLSID_StockFontPage、CLSID_StockColorPage）。

为 x64 重新编译后，颜色和字体选项卡丢失（因为 MsStkPrp.dll 是 32 位的）。是否有 64 位版本的 dll，或者是否有更好的方法在 ATL ActiveX 控件中实现字体和颜色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-07-19T21:53:59.113

即使是 32 位版本的 msstkprp.dll 也不存在于 Windows 10 中，因此我将它从我的 Windows XP 虚拟机 (%WINDIR%\System32\msstkprp.dll) 复制到了一个目录。然后您可以通过启动管理提示符成功注册它，切换到该目录，然后键入

```
regsvr32 msstkprp.dll 
```

# android - Acer Iconia A100 不能与 Android ADK 一起使用？

> ID：10524677
> 
> 赞同：0
> 
> 时间：2012-05-09T21:57:56.400
> 
> 标签：android, arduino, adk

我刚刚将我的三星 Galaxy Tab 2 7" （通过我在这里提出的这个问题发现无法正常工作： [如何判断 Android 设备是否具有打开附件模式](https://stackoverflow.com/questions/10506786/how-to-tell-if-an-android-device-has-open-accessory-mode)）换成了 Acer Iconia A100 选项卡，以便使用 ADK 和打开附件模式。但是，现在我有了这款平板电脑，它仍然无法正常工作！我用 2.3 开箱即用（什么都没有）尝试过，然后我更新到 2.3.1，但仍然一无所获！这变得非常令人沮丧.

A100 可在多个站点上使用，包括此处的站点：http: [//www.whizzosoftware.com/forums/blog/1/entry-47-tablets-and-the-android-open-accessory-development-kit- adk/](http://www.whizzosoftware.com/forums/blog/1/entry-47-tablets-and-the-android-open-accessory-development-kit-adk/) 以及“Beginning Android ADK with Arduino”一书的第 11 页（可在 google 图书上找到）

我无法弄清楚为什么这不起作用。我根据此处设置了所有内容：http: [//developer.android.com/guide/topics/usb/adk.html](http://developer.android.com/guide/topics/usb/adk.html) 并且一切正常，直到我进入最后一步，在“运行 DemoKit Android 应用程序”第 8 步下。当我执行此步骤时，平板电脑永远不会通过“请连接 DemoKit 板”屏幕。我将平板电脑的微型 USB 插入 Arduino ADK 板（安装了固件），并将 ADK 板插入我的计算机以供电。

这个平板电脑也不能用吗？试图让它工作是非常烦人的。感谢任何可以提供帮助的人。

我可能做错的唯一可能区域是在构建 android 应用程序时：在“运行 DemoKit Android 应用程序”步骤 5 下。它列出了“对于构建目标，选择 Google API（平台 2.3.3，API 级别 10） " 为此，我在 Eclipse 中右键单击我的项目，然后选择属性>android，然后选择 Google API 的级别 10。

此外，当我从 google 编译 ADK 板的固件时，Arduino IDE 给了我几个错误，这些错误都是由于更新而需要更改的语法。我完全忘记了这是什么，但我相信它正在改变一些读取和接收功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T06:17:33.190

默认 Google 的 DemoKit 过于复杂，无法将其作为 ADK 的起点。您可能想尝试一些更简单的东西，比如[https://github.com/yanzm/HelloADK](https://github.com/yanzm/HelloADK) - 这对我有用。

有迹象表明 ADK 控制台正在发生什么——您可能想要运行 arduino IDE 或任何其他串行端口监视器，并在连接 Android 设备时查看串行输出中弹出的消息。

此外，请注意编译固件时使用的资源。此页面提供了一组比您使用的页面更新的说明：http: [//labs.arduino.cc/ADK/Index](http://labs.arduino.cc/ADK/Index)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T02:06:14.990

我能够使用 Circuits@Home USB Shield 在 Acer Iconia Tab A100 上运行 Ice Cream Sandwich 4.0.3 和 Arduino 上的演示套件示例和另一个示例工作。

我的设置听起来与您在 Arduino 端尝试做的有点不同，但也许我所做的会有所帮助。我已经在[http://digitalhacksblog.blogspot.com/2012/05/arduino-to-android-turning-led-on-and_29.html](http://digitalhacksblog.blogspot.com/2012/05/arduino-to-android-turning-led-on-and_29.html)记录了对我有用的东西。

# c++ - C++（虚拟）函数表

> ID：10524678
> 
> 赞同：2
> 
> 时间：2012-05-09T21:58:07.687
> 
> 标签：c++, oop

C++ vtable 是否仅用于确定在调用虚函数时应执行哪一段代码，还是在运行时有其他用途？

在维基百科上，它列出了“动态调度”作为一个原因，但没有详细介绍 C++ .....

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T22:00:25.503

一些实现将指向 RTTI 代码 ( `typeid`, `dynamic_cast`, ...) 使用的信息的指针放置在 vtable 的插槽中（请参阅此处有关[Itanium ABI](http://sourcery.mentor.com/public/cxx-abi/abi.html#vtable)的信息，g++ ABI 是基于它的）。

[（实际上，如果您阅读 Itanium ABI 规范，它会稍微复杂一些，但这是一般的想法）]

此外，正如您从链接文档中看到的那样，还有一些东西可以访问基类的数据，在调用基类方法时执行指针调整，...，主要是“复杂”对象层次结构中需要的东西（多重继承，虚拟基类，...），就像在经典的单继承场景中一样，派生类的布局很简单，不需要大惊小怪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:36:37.857

C++ vtable 只是一个函数指针的查找表。任何特定的 C++ 实现都可以将 vtable 用于其他事情；但这是特定于实现（和版本）的。依靠 vtable 来调用 C++ 以外的任何东西来调用你的虚拟方法是一个非常糟糕的主意。

# ajax - 制表符导致 ajax Coldfusion 组件失败，500 内部服务器错误

> ID：10524680
> 
> 赞同：2
> 
> 时间：2012-05-09T21:58:11.960
> 
> 标签：ajax, coldfusion, cfc, cffunction

我有一个表单，用户可以从 Word 文档中复制和粘贴文本。此内容可能包含制表符。点击函数使用 JSMX ajax 调用 Coldfusion 远程函数来处理表单提交。表单通过 ajax 调用传递给组件。

```
<form name="test">
<textarea name="swPurpose"></textarea>
<input type="button" value=" Go " onclick="goForm(this.form);" />
</form>

function goForm(f){
var param=f; 
http('POST','testCFC.cfc?method=test',goForm_RTN,param);
}

<cfcomponent output="false">
<cffunction name="test" access="remote" output="false">
<cfset rtn=structNew()/>
<cfsavecontent variable="rtn.html">
<cfoutput><p>#form.swPurpose#</p></cfoutput>
</cfsavecontent>
<cfreturn rtn />
</cffunction>
</cfcomponent> 
```

除非表单内容中有制表符，否则这非常有效。如果内容中有一个选项卡，我会收到 500 内部服务器错误。

这是表单中提交的示例文本。

```
1 这是文字
2 这是文字
3 这是文字

```

这是发布到函数的 Firebug 的编码文本。

```
swPurpose=1%9This%20is%20text%0a2%9This%20is%20text%0a3%9This%20is%20text&btn=%20OnClick%20,%20Submit%20

```

使用 Firebug，我可以看到发布到函数的内容已编码。制表符是 %9。我可以将 cfc 放入表单的操作中，并且该功能不会失败。

我的解决方法是在将标签发送到函数之前使用 javascript 去除标签。但是，我想了解为什么选项卡会导致 500 错误，以及是否可以采取任何措施来防止这种情况发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T15:39:16.690

在交还之前，您可以用 CF 代码中的简单正则表达式替换选项卡。

```
<cfcomponent output="false">
    <cffunction name="test" access="remote" output="false">
        <cfargument name="form">
        <cfset var rtn=structNew()/>

        <cfsavecontent variable="rtn.html">
            <cfoutput><p>#ReReplace(form.swPurpose, "\t", "&nbsp;&nbsp;", "ALL")#</p></cfoutput>
        </cfsavecontent>
        <cfreturn rtn />
    </cffunction>
</cfcomponent> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:16:47.823

试试这个代码：

```
function goForm(f){
    var param = escape(f);//Or also encodeURI(f) or even encodeURIComponent(f)
    http('POST','testCFC.cfc?method=test',goForm_RTN,param);
} 
```

# ruby-on-rails - Ruby/Rails - 带有空白数据集的双管

> ID：10524682
> 
> 赞同：1
> 
> 时间：2012-05-09T21:58:21.970
> 
> 标签：ruby-on-rails, ruby

我有一个返回空白的对象，这就是我想做的

```
@photo = [] # this is coming back blank, but it won't do the correct comparison in the ||
@sanitized_photos = PhotoPresenter.new(@photo).to_json || PhotoPresenter.default_layout.to_json 
```

关于如何在没有强大的 if 语句的情况下使其工作的任何想法

更新 ::: 这是我的演示者的副本，效果很好。我知道我已经把收集逻辑放在这里，但它的工作方式最干净

```
class PhotoPresenter < Presenter

  def initialize(photo)
    @photo = photo
  end

  def to_gallery
    {
      "thumb" => @photo.image.url(:thumb),
      "image" => @photo.image.url(:large),
      "big" => @photo.image.url,
      "title" => @photo.attachable.name
    }
  end

  def self.blank_gallery
    {
        "thumb" => help.polymorphic_photo_url(nil, :large),
        "image" => help.polymorphic_photo_url(nil, :large),
        "big" => help.polymorphic_photo_url(nil, :large),
        "title" => "No photo provided"
      }
  end

  def self.as_gallery(photos)
    unless photos.blank?
      photos.collect{|object| self.new(object).to_gallery}.to_json
    else
      blank_gallery.to_json
    end
  end

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:07:38.220

```
@sanitized_photos = @photo.any? ? PhotoPresenter.new(@photo).to_json : PhotoPresenter.default_layout.to_json 
```

话虽如此，您最好将此逻辑移入 PhotoPresenter 类初始化程序

# vba - 使用 VBA 将选项卡添加到 Excel 中的多页表单

> ID：10524686
> 
> 赞同：3
> 
> 时间：2012-05-09T21:58:41.557
> 
> 标签：vba, excel, userform, multipage

我需要找到 VBA 代码以将 x 个选项卡添加到 excel 用户表单中的多页中。如果我使用 Visual Basic 编辑器，我可以手动添加选项卡，但我希望能够在运行时使用 VBA 动态添加/删除选项卡。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T23:03:17.113

`Tabs`in a`MultiPage1`被调用，`Pages`您可以使用添加它们

```
MultiPage1.Pages.Add 
```

您可以在循环中使用上述代码来添加页面。有关详细信息，请参阅 Excel 的内置帮助

**编辑**：

刚刚看到问题的第二部分。要删除，说第一页使用这个

```
MultiPage1.Pages.Remove (0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T02:10:26.163

您可以将它们永久添加/删除到表单中

```
Sub Test()
Dim vbComp As Object
Dim objCntrl As Control
Set vbComp = ThisWorkbook.VBProject.VBComponents("UserForm1")
Set objCntrl = vbComp.Designer.Controls("MultiPage1")
'add page
objCntrl.Pages.Add
'remove page
objCntrl.Pages.Remove (1)
End Sub 
```

# nhibernate - NHibernate / Linq 使用 SQL CE 创建无效 SQL

> ID：10524688
> 
> 赞同：1
> 
> 时间：2012-05-09T21:58:43.477
> 
> 标签：nhibernate, sql-server-ce, linq-to-nhibernate

我正在使用 NHibernate 3.1 和 SQL CE 4（使用 MsSqlCe40Dialect）。使用 Linq 生成查询。

如果我使用 String.Contains、String.StartsWith 或 String.EndsWith，则会产生无效的 SQL。

例如：

```
Session.Query<User>.Where(user => user.Name.Contains("Joe")) 
```

生成如下 SQL：

```
SELECT Name FROM User WHERE (User.Name like ('%'||@p0||'%')) 
```

这从实际生成的 SQL 中有所简化，但问题在于额外的`'||...||'`

我预计这是 SQL CE 方言的问题，但我不确定从这里去哪里。有关修复/解决方法的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T16:33:44.450

看起来这在 3.1 版本发布后不久（[在此提交中](https://github.com/nhibernate/nhibernate-core/commit/41dbbf58c6a0c45d5cb4e1404e2d236272e30bb0)）已修复。不幸的是，由于其他依赖项，我无法升级 NHibernate。与此同时，我通过`MsSqlCe40Dialect`使用以下代码进行子类化解决了这个问题：

```
using NHibernate;
using NHibernate.Dialect;
using NHibernate.Dialect.Function;

namespace DataAccess
{
    public class CustomMsSqlCe40Dialect : MsSqlCe40Dialect
    {
        public CustomMsSqlCe40Dialect ()
        {
            RegisterFunction("concat", new VarArgsSQLFunction(NHibernateUtil.String, "(", "+", ")"));
        }
    }
} 
```

# algorithm - 广度优先搜索实施

> ID：10524691
> 
> 赞同：3
> 
> 时间：2012-05-09T21:59:03.520
> 
> 标签：algorithm, search, memory, path

我正在尝试在 Javascript 中实现广度优先搜索（还有其他算法，但目前是 bfs）。

最终我想在一个网格上应用所有的搜索算法，找到一条从起点到目标节点的路径（我知道 bfs 并不是特别擅长这个）。我已经做了一个实现，但问题是我没有提前整棵树。我想要的是给它一个 startnode 和 endnode 并在此基础上找到它们之间的路径。

我遇到的问题是，当我确定相邻的方格时，它会返回所有邻居，甚至那些已经遍历过的邻居。这将其变成图形搜索而不是树搜索。解决它的一种方法是记住所有路径，以便我可以检查哪些邻居已经被遍历，因此不需要进一步检查。但是，正如我在搜索算法课程中学到的那样，bfs 具有当前深度级别上所有节点的内存使用情况。如果我存储所有路径，那么它会消耗更多的内存，对吧？

当我事先没有树结构并且仍然避免循环时，是否可以只将 bfs 正在搜索的当前深度的节点保存在内存中？

我希望我已经把自己说清楚了。

在此先感谢，斯特凡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:03:45.467

如果你会“忘记”你访问的节点，你可能会遇到[DFS](http://en.wikipedia.org/wiki/Depth-first_search)遇到的同样的麻烦——它不是最优的（可能找不到最优路径）也不是完整的（由于无限循环，它可能找不到解决方案，即使一个存在）。

注意：

*   即使你只记得最深层次的节点——它仍然对你没有多大帮助——请记住，例如，在二叉树中，一半的节点是叶子，所以空间复杂度仍然很大。
*   只记住部分节点并不能保证最优性，因为最终你会重新发现一个你忘记的顶点——到那时——你让自己陷入了循环。

如果您正在寻找既完整又优化的内存效率更高的算法 -[**迭代深化 DFS**](http://en.wikipedia.org/wiki/Iterative_deepening_depth-first_search)可能就是您所追求的。

# android - 如何使用应用内订阅模式实现 Android 应用

> ID：10524693
> 
> 赞同：0
> 
> 时间：2012-05-09T21:59:13.507
> 
> 标签：android, google-play

我目前正在尝试实现一个可免费下载的应用程序，用户必须一次支付 30 天的访问费用。

我已经搜索了很长时间，一切都表明当前不支持使用应用内计费服务。如果这是真的，我有什么选择？我想要一些不违反 Android 商店服务条款的东西。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:05:04.240

为了确认，您实际上会使用 Google 的 In App Billing 服务，该服务符合他们的 TOS。使用外部支付流程将不合规，或者销售实物商品（只有虚拟商品可以通过 IAB 出售）。

您只能使用 Google 的 IAB 来避免违反他们的 TOS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:51:21.617

谷歌最近添加了对应用内计费的订阅。

[http://developer.android.com/guide/market/billing/billing_subscriptions.html](http://developer.android.com/guide/market/billing/billing_subscriptions.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T23:21:38.620

不久前我找到了我的问题的答案，所以如果有人有同样的问题，我会回答它。

订阅功能于 5 月 24 日在 Android 开发者博客上公布：[http ://android-developers.blogspot.co.uk/2012/05/in-app-subscriptions-in-google-play.html](http://android-developers.blogspot.co.uk/2012/05/in-app-subscriptions-in-google-play.html)

# linux - 使用 BioAPI 转换和比较两个指纹位图图像

> ID：10524700
> 
> 赞同：1
> 
> 时间：2012-05-09T21:59:47.397
> 
> 标签：linux, bitmap, comparison, fingerprint, biometrics

我正在开发一个应用程序，它从指纹读取器硬件获取用户的指纹图像 bmp 并将其发送到具有此类指纹位图集合的 linux 服务器。服务器应交叉验证指纹并获取与匹配指纹相关联的先前注册用户数据的记录。

到目前为止，我能够为 linux 编译 BioAPI 并从密码创建两个 BIR 模板。我找不到使用 BioAPI（或类似的免费指纹匹配 SDK）来比较两个位图图像或从此类指纹位图创建 BIR 模板的示例。

如果有人可以就如何实现我想要做的事情提供任何帮助或建议，我将不胜感激。

在此先感谢 Nikhil Mathew

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T18:05:09.173

NIST 编写了公共领域的[NIST 生物特征图像软件 (NBIS) 包](http://www.nist.gov/itl/iad/ig/nbis.cfm)，其中包括 BOZORTH3 指纹匹配算法。它是用 ANSI C 编写的，因此可以在 Linux 上编译和运行。要使用 BOZORTH3，您必须首先通过 NBIS 中包含的 MINDTCT 细节检测器运行您的指纹。

另请参阅[NBIS 用户指南](http://www.nist.gov/customcf/get_pdf.cfm?pub_id=51097)和[下载链接](http://www.nist.gov/itl/iad/ig/nigos.cfm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T11:02:32.107

所以看起来你正在这个场景中工作

*   你正在使用指纹扫描仪来捕捉手指（或拇指）的图像
*   在新注册指纹之前，您需要检查此人是否已经注册

如果这里是相同的情况，您不需要比较两个拇指打印的位图图像位图图像是无法比较的

相反，您应该将两个位图图像都提供给指纹匹配 SDK，此 sdk 将创建输入图像的可比较模板，并且 SDK 还提供将采用输入模板的方法，在比较这些模板后，它会告诉您指纹是否匹配

我希望这对你有帮助

# linq-to-sql - 向 Linq-To-Sql 数据提供者提供连接字符串

> ID：10524710
> 
> 赞同：8
> 
> 时间：2012-05-09T22:00:32.430
> 
> 标签：linq-to-sql, f#, f#-3.0, dataprovider

有没有办法从 App.Config 文件中为 F# 中的 Linq-To-Sql 数据提供程序提供连接字符串。

我已经尝试了以下只是为了测试：

```
let mutable connString = @"Data Source=PCSQLEXPRESS;Initial Catalog=NortwindDB;Integrated Security=True"
type SqlConnection = SqlDataConnection<ConnectionString = connString> 
```

但我收到一条错误消息“这不是常量表达式或有效的自定义属性值”

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-10T12:49:13.777

类型提供程序本身需要一个硬编码的连接字符串来生成`SqlConnection`要在编译时开发的类型（在您的情况下），但是，您可以配置在运行时使用的实际连接字符串，如下所示：

```
type SqlConnection = SqlDataConnection<"Data Source=PCSQLEXPRESS;Initial Catalog=NortwindDB;Integrated Security=True">
let runtimeConnStr = ...
type dataContext = SqlConnection.GetDataContext(runtimeConnStr) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T21:23:21.667

也许使用“？ConnectionStringName”参数会让你到达你想要的地方。

[http://msdn.microsoft.com/en-us/library/hh362320(v=VS.110).aspx](http://msdn.microsoft.com/en-us/library/hh362320(v=VS.110).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-29T11:38:58.287

您可能还想查看以下问题，该问题在 [F# Type Providers and Continuous Integration的答案中有解决方案](https://stackoverflow.com/questions/18969181/f-type-providers-and-continuous-integration)

# jquery - Railcasts 103 - 从原型到 Jquery 的转换，需要帮助

> ID：10524730
> 
> 赞同：0
> 
> 时间：2012-05-09T22:01:52.320
> 
> 标签：jquery, ruby-on-rails-3, prototypejs, ujs

说到这个，我是个笨蛋，我完全被困住了。在[railscast 103](http://railscasts.com/episodes/103-site-wide-announcements)之后，我正在尝试使用 rails 3.2.3 实现公告系统

本教程使用原型，我不知道如何将其转换为 jquery。

在我的`application.html.haml`我有这个：

```
%h3{:id => "alert", :class=>'alert-danger fade in', :style=>"padding: 10px;"}
  - unless current_announcements.empty?
    #announcement
      - for announcement in current_announcements
        %ul{:class=>'unstyled'}
          %li
            = h announcement.message
            = link_to "Hide this message", :url => "/javascripts/hide_announcement.js"#, :remote => true 
```

单击隐藏按钮应该删除视图，同时还将 设置`announcement_hide_time`为当前时间。我的 javascript 控制器中有这个：

```
class JavascriptsController < ApplicationController

  respond_to :js

  attr_accessible :announcement_hide_time

  def hide_announcement
    session[:announcement_hide_time] = Time.now
  end
end 
```

这在我的路线中：

```
match ":controller/:action.:format" 
```

现在的问题是，在 railscast 中，它说我需要 hide_announcement.js.rjs 中的以下内容

```
page[:announcement].hide 
```

我在 hide_announcement.js.erb 中将其替换为：

```
$("#announcement").hide() 
```

但是当我单击该链接时，我在控制台中没有收到任何错误，并且消息也没有被删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T23:11:53.823

我建议你不要模仿那个 Railscast。从 2008 年开始，事情发生了很大变化。在服务器上编写 Javascript 以在客户端执行是过时的；整个`JavascriptsController`想法对我来说都是令人畏惧的。

相反，您可以让“隐藏此消息”链接在客户端触发 AJAX 请求，告诉服务器停止显示公告，等待`success`-type 响应，然后删除消息本身。

我做了一个[小提琴](http://jsfiddle.net/5hYAp/)，显示了这个的基本版本。请注意，它会伪造服务器对 AJAX 请求的响应，但您的应用程序所要做的就是返回一个 HTTP 成功代码。

如果您的应用程序很简单，这就足够了，但最终这些 jQuery 事件会失去控制，并可能需要一个客户端框架（如主干.js）来跟踪事情。

# javascript - javascript，函数返回一个值，但我不能将返回分配给一个变量

> ID：10524732
> 
> 赞同：1
> 
> 时间：2012-05-09T22:01:56.440
> 
> 标签：javascript, rhino

以下是一些代码，用于在 linux 系统上返回文件大小，使用 rhino 运行 javascript。

运行以下函数会返回一个值：

```
function fsize(file){
    var filesize = runCommand("stat","-c %s",file).output();
    return filesize;
} 
```

例如：

```
fsize(testfile); 
```

返回文件大小（以字节为单位）

但如果我运行：

```
var filesize = fsize(testfile); 
```

当我尝试输出时，var 文件大小是“未定义”

我在做什么错？

编辑：我的输出功能：

```
function output(strings){
        print(strings);
} 
```

编辑：这是外壳输出：

```
js> var file = "/var/www/javascript/ProgressMon/progressmon.js"

js> fsize(file);

683
js> var filesize = fsize(file);

683
js> output(filesize);

undefined

js> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:08:56.653

执行此操作并检查函数 runCommand 是否无法执行

```
function fsize(file){
    try{
       return runCommand("stat","-c %s",file).output();
    catch(err) {
       alert('Error:'+ err);
       return -1;
    }
}

var filesize = fsize(testfile); 
```

编辑

基于[此](https://developer.mozilla.org/en/Rhino_Shell#runCommand%28commandName.2C_.5Barg.2C_....5D_.5Boptions.5D%29)

语法`runCommand(command, arg1, ..., argN, options)`我不确定`.output();`

尝试这样做

```
var opt={err: ''}
runCommand("stat","-c %s",file, opt) 
```

编辑

而不是打电话`output(filesize);`

直接调用`filesize`

这是你想做的事

```
js> var opt={output: ''}
js> runCommand("stat","-c %s",file, opt)
js> print(opt.output) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:08:42.057

我只是在猜测，但看起来您正在通过 Ajax 运行命令。如果你要这样做：

```
var filesize = fsize(testfile);
alert(filesize); 
```

就像 Javascript将`undefined`继续代码并执行下一行，即使它仍在等待来自服务器的响应。

您可以尝试做的是添加超时或回调`runCommand()`完成时提醒返回的变量。

同样，这只是一种猜测，但在处理 Ajax 和 Javascript 时通常会出现这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T23:44:17.797

问题是你期望返回一些东西，但你从来没有告诉函数返回任何东西。

```
function output(strings){
    print(strings);
    //missing return
} 
```

因此，如果该函数从未执行过任何`return`，它将返回`undefined`（如果您只使用 ，也会发生这种情况`return;`）

* * *

另外，要使用此功能，我认为您需要更改：

```
var filesize = runCommand("stat","-c %s",file).output(); 
```

和

```
var filesize = output(runCommand("stat","-c %s",file)); 
```

# asp.net - vb.net 谓词包装错误

> ID：10524737
> 
> 赞同：-1
> 
> 时间：2012-05-09T22:02:37.687
> 
> 标签：asp.net, vb.net, namespaces, predicates

所以我有一些我已经使用了一段时间的代码，它运行良好。这个项目相当大，所以我使用了一个详细的命名空间，但我无法让它工作。

我已经使用了一百次，但我在这个项目中遇到了这个错误：

> 方法“公共共享函数 ProductIdMatch(p As BusinessLayer.DataContainer.oProduct, id As Integer) As Boolean”与委托“Delegate Function PredicateWrapperDelegate(Of T, A)(item As BusinessLayer.DataContainer.oProduct, argument) 没有相同的签名作为字符串）作为布尔值'。

这个项目与其他项目的唯一不同之处在于命名空间的级别。以下是支持程序。

有谁知道那里发生了什么？谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T21:04:41.070

是的，我打算发布那个，但在我发布问题后的一天内它不会让我这样做。我不知道为什么它让我以前这样做，但它只是签名中的一种类型。

# php - 为什么在使用 file_get_contents() 时出现 500 错误，但在浏览器中有效？

> ID：10524748
> 
> 赞同：35
> 
> 时间：2012-05-09T22:03:57.413
> 
> 标签：php, file-get-contents

```
$html = file_get_contents("https://www.[URL].com"); 
echo $html; 
```

在错误日志中产生这个：

> PHP 警告：file_get_contents(https://www.[URL].com) [function.file-get-contents]：打开流失败：HTTP 请求失败！第 13 行 /Applications/MAMP/htdocs/test.php 中的 HTTP/1.1 500 内部服务器错误"；

但是，该站点在浏览器中运行良好。

我也尝试过使用 cURL。我在日志文件中没有收到任何错误，但`$html`现在回显：

> “/”应用程序中的服务器错误。
> 你调用的对象是空的。
> 
> ...更多调试信息

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-05-09T22:08:37.577

试试这个解决方法：

```
$opts = array('http'=>array('header' => "User-Agent:MyAgent/1.0\r\n"));
$context = stream_context_create($opts);
$header = file_get_contents('https://www.example.com',false,$context); 
```

如果这不起作用，也许您无法从 https 读取？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-05-19T13:05:15.683

我不得不在标题中输入更多数据：

```
$opts = array('http' => array(
    'method' => "GET",
    'header' => "User-Agent Mozilla/5.0 (Windows NT 6.1; WOW64; rv:24.0) Gecko/20100101 Firefox/24.0\r\n"
    . "Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    . "Accept-Encoding:gzip, deflate\r\n"
    . "Accept-Language:cs,en-us;q=0.7,en;q=0.3\r\n"
    . "Connection:keep-alive\r\n"
    . "Host:your.domain.com\r\n"
    ));
$context = stream_context_create($opts);
$html = file_get_contents($sap_url, FALSE, $context); 
```

# php - .addClass 与基于值的 IF 语句

> ID：10524751
> 
> 赞同：0
> 
> 时间：2012-05-09T22:04:24.097
> 
> 标签：php, jquery, mysql

我正在尝试使用 if 语句和两个 .addClass 背景颜色变量，具体取决于“shift_times”的列值是否=“SAT AM/SUN PM”或=“SAT PM/SUN AM”。我正在寻找值是数字而不是文本时的解决方案。

```
 $query = "SELECT COUNT(confirmed) as cnt, 
     position, shift_times 
     FROM volConfirm 
     WHERE confirmed='yes'  
     GROUP BY shift_times, position
     order by position"; 

     $result = mysql_query($query) or die(mysql_error());

     while($row = mysql_fetch_array($result))
      {
      echo "<tr>";
  echo "<td>" . $row['position'] ." ". $row['shift_times'] ."= " . $row['cnt'] . "</td>";
  echo "</tr>";
       } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:42:18.413

像这样的东西是你要找的吗？

```
$query = "SELECT
      COUNT(confirmed) as cnt, 
      position,
      shift_times 
   FROM volConfirm 
   WHERE confirmed='yes'  
   GROUP BY shift_times, position
   ORDER BY position"; 

$result = mysql_query($query) or die(mysql_error());

while($row = mysql_fetch_array($result)) {
   if ($row['shift_times'] === 'SAT AM/SUN PM') {
      echo '<tr class="class1">';
   } else if ($row['shift_times'] === 'SAT PM/SUN AM') {
      echo '<tr class="class2">';
   } else {
      echo '<tr>';
   }
   echo "<td>" . $row['position'] ." ". $row['shift_times'] ."= " . $row['cnt'] . "</td>";
   echo "</tr>";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:35:07.120

我假设您正在根据问题的内容和`addClass`jQuery 函数这一事实来寻找 jQuery 答案……如果我错了，我深表歉意。如果这就是你的意思，这是你的答案：

PHP：

```
while($row = mysql_fetch_array($result))
{
    echo "<tr>";
    echo "<td>" . $row['position'] ." <span class='shifttimes'>". $row['shift_times'] ."</span>= " . $row['cnt'] . "</td>";
    echo "</tr>";
} 
```

jQuery：

```
$(function() {
  $.each($('.shifttimes'), function() {
    var $this = $(this);
    $this.text() == "SAT AM/SUN PM" ? $this.addClass('className') : $this.addClass('otherClassName');
  });
}); 
```

# delphi - AnsiString 流式传输

> ID：10524752
> 
> 赞同：4
> 
> 时间：2012-05-09T22:04:25.077
> 
> 标签：delphi, stream, delphi-xe2, ansistring

我创建了以下代码：

```
Function AnsiStringToStream(Const AString: AnsiString): TStream;
Begin
  Result := TStringStream.Create(AString, TEncoding.ANSI);
End; 
```

但我是“W1057 隐式字符串从 'AnsiString' 转换为 'string'”

他有什么问题吗？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T22:10:57.777

构造`TStringStream`函数需要一个**字符串**作为其参数。当您给它 an 时`AnsiString`，编译器必须插入转换代码，而您指定的事实`TEncoding.ANSI`并不会改变这一点。

试试这样：

```
Function AnsiStringToStream(Const AString: AnsiString): TStream;
Begin
  Result := TStringStream.Create(string(AString));
End; 
```

这使用显式转换，并将与编码相关的工作留给编译器，编译器已经知道如何处理它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-10T00:22:04.130

在 D2009+ 中，`TStringStream`需要 a `UnicodeString`，而不是`AnsiString`. 如果您只想按`AnsiString`原样写入内容，而不必将数据转换为 Unicode，然后再转换回 Ansi，请`TMemoryStream`改用：

```
function AnsiStringToStream(const AString: AnsiString): TStream; 
begin 
  Result := TMemoryStream.Create;
  Result.Write(PAnsiChar(AString)^, Length(AString));
  Result.Position := 0; 
end; 
```

由于`AnsiString`在 D2009+ 中可识别代码页，因此传递给您的函数的任何字符串都将强制使用操作系统默认的 Ansi 编码。如果您希望能够传递任何 8 位字符串类型，例如`UTF8String`，而根本不转换数据，请使用`RawByteString`而不是`AnsiString`：

```
function AnsiStringToStream(const AString: RawByteString): TStream; 
begin 
  Result := TMemoryStream.Create;
  Result.Write(PAnsiChar(AString)^, Length(AString));
  Result.Position := 0; 
end; 
```

# php - 有没有办法通过 PHP 自动将 XML 页面转换为 JSON？

> ID：10524756
> 
> 赞同：1
> 
> 时间：2012-05-09T22:04:42.667
> 
> 标签：php, javascript, xml, json

> **可能重复：**
> [PHP 将 XML 转换为 JSON](https://stackoverflow.com/questions/8830599/php-convert-xml-to-json)

这是我的输出 XML 示例的样子：

```
<item>
 <Barcode>0602527522593</Barcode>
 <albumid>1818</albumid>
 <Title>Gold</Title>
 <Country>Sweden</Country>
 <Format>CD</Format>
 <Length></Length>
 <Number_of_Discs></Number_of_Discs>
 <Type>album</Type>
 <Description></Description>
 <Band_or_Artist>Adams, Ryan</Band_or_Artist>
</item> 
```

是否有易于使用的内置 PHP 函数或插件快速将其转换为 JSON 并输出？如果它不是内置的，我应该使用哪个扩展？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:08:57.860

作为在客户端执行此操作的替代方法是来自 fyneworks的[XML 到 JSON 插件。](http://www.fyneworks.com/jquery/xml-to-json/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:10:58.967

您可以使用 SimpleXML (http://php.net/manual/en/book.simplexml.php) 读取 XML 输入，然后使用 json_encode (http://php.net/manual/en/book.json.php)创建输出。

您可能只想遍历节点列表并使用标签名称作为键将所有内容放入数组中，这应该相当简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:09:54.003

有很多。这是来自 IBM 的一个：http: [//www.ibm.com/developerworks/xml/library/x-xml2jsonphp/](http://www.ibm.com/developerworks/xml/library/x-xml2jsonphp/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T22:16:43.410

像这样的东西？

```
<?php

$xmlstr = "<item>
 <Barcode>0602527522593</Barcode>
 <albumid>1818</albumid>
 <Title>Gold</Title>
 <Country>Sweden</Country>
 <Format>CD</Format>
 <Length></Length>
 <Number_of_Discs></Number_of_Discs>
 <Type>album</Type>
 <Description></Description>
 <Band_or_Artist>Adams, Ryan</Band_or_Artist>
</item>";

$movies = new SimpleXMLElement($xmlstr);
echo $output = json_encode($movies);
?> 
```

# internet-explorer-8 - Internet Explorer 8 限制注册表位置

> ID：10524758
> 
> 赞同：-1
> 
> 时间：2012-05-09T22:04:47.247
> 
> 标签：internet-explorer-8, registry, toolbar, restriction

我试图将 IE8 限制为没有工具栏，什么都没有。

我在 Windows XP Home 版中使用 Kiosk 模式。

我已经使用 Group Edit 和 Windows Steady State 正确设置了一些 XP pro 计算机。

但是，我无法在 XP pro 和 XP home 上进行相同的设置：

在 XP pro 上，每当通过链接打开一个新窗口时，它都会在一个没有工具栏的小窗口中打开。在 XP 主页中，当通过链接打开一个新窗口时，它会打开一个标准浏览器窗口，所有工具栏仍然存在。

我知道我可以在注册表中以某种方式禁用工具栏，但我找不到在哪里；我看到的所有在线信息都没有将我发送到任何现有的注册表位置。

有人帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:12:21.597

据我所知，您可以从 cmd 行以 kiosk 模式启动 IE - 通过运行 iexplore -k 后跟要打开的网址。如果您需要用来锁定浏览器的注册表值不存在，您可以创建它们。

HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Internet Explorer\Restrictions

将它们创建为 DWORD 值 - 值为 1 执行策略。

NoBrowserClose（禁止关闭浏览器窗口）

NoBrowserContextMenu（禁用右键单击上下文菜单）

NoFileOpen（禁止使用 Ctrl-O 或 Ctrl-L 来启动任意 URL）

NoOpenInNewWnd（禁止通过 Ctrl-N 或 Shift-单击在新窗口中打开链接）

这些应该几乎涵盖了用户可以绕过信息亭模式的所有正常方式。

除上述之外，还有：

```
AlwaysPromptWhenDownload - Always prompt user when downloading files.
NoBrowserBars - Disable changes to browsers bars.
NoBrowserClose - Disable the option of closing Internet Explorer.
NoBrowserContextMenu - Disable right-click context menu.
NoBrowserOptions - Disable the Tools > Internet Options menu.
NoBrowserSaveAs - Disable the ability to Save As.
NoFavorites - Disable the Favorites.
NoFileNew - Disable the File > New command.
NoFileOpen - Disable the File > Open command.
NoFindFiles - Disable the Find Files command.
NoNavButtons - Disables the Forward and Back navigation buttons
NoOpeninNewWnd - Disable Open in New Window option.
NoPrinting - Remove Print and Print Preview from the File menu.
NoSelectDownloadDir - Disable the option of selecting a download directory.
NoTheaterMode - Disable the Full Screen view option.
NoViewSource - Disable the ability to view the page source HTML.
RestGoMenu - Remove Mail and News menu item. 
```

# objective-c - 收集统计数据

> ID：10524764
> 
> 赞同：0
> 
> 时间：2012-05-09T22:05:33.180
> 
> 标签：objective-c, cocoa, statistics, mac-app-store

我正在用 Obj-C/Cocoa 为 Mac App Store 编写一个应用程序。该应用程序处理 .html 文件，不需要互联网连接。

我想知道，收集统计数据的最佳方法是什么？我感兴趣的是处理的文件数量。

这样，在应用程序的主页上，我可以显示已处理的 XXX,XXX 文件。

我在想，只要文件被转换，我就会发布到网络服务器，但这会大大减慢应用程序的速度，并且如果用户没有连接到互联网，它将无法工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T23:20:33.040

您可以在内部累积统计信息，以便每隔一段时间（也许每天）上传一次。您可以使用`NSUserDefaults`.

您应该请求用户允许上传数据，即使是看似无害的处理文件计数。

您将使用一个简单的 HTTP 请求来上传数据。（你知道它很容易受到欺骗，对吧？）你应该在尝试之前使用[网络可达性 API](https://developer.apple.com/library/mac/#documentation/SystemConfiguration/Reference/SCNetworkReachabilityRef/Reference/reference.html)检查系统是否已连接网络，例如，你不要强制拨号。可达性 API 无法告诉您连接肯定会成功，因此您应该优雅地处理连接失败。

# ruby-on-rails - Rails Paperclip未定义方法“validates_attachment”？

> ID：10524771
> 
> 赞同：3
> 
> 时间：2012-05-09T22:06:20.953
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paperclip, attachment

我从模型中的一些验证代码中收到错误消息。我的系统正在使用回形针将许多文件附加到帮助文章中，并且我知道我安装了回形针，因为我能够上传文件而不是验证它们。

这是我的模型：

```
class HelpAttachment < ActiveRecord::Base

  belongs_to :help

  has_attached_file :attachment, 
                    :styles => { :medium => "300x300>",
                                 :thumb => "100x100>" }

  validates_attachment :attachment, :content_type => [ 'image/png', 'image/jpg', 'image/gif', "application/pdf", 
                                    'video/mpeg', 'video/quicktime', 'video/x-ms-asf', 'video/x-msvideo', 
                                    'video/x-flv' ]

end 
```

这是我尝试提交新附件时收到的错误消息：

```
NoMethodError in HelpsController#create

undefined method `validates_attachment' for #<Class:0x00000005581498> 
```

如果我删除 validates_attachment 行一切正常，只是没有文件验证。

我的 gemfile 中有 gem 'paperclip' 并且我正在开发模式下运行。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T22:18:06.180

根据[回形针的 github，](https://github.com/thoughtbot/paperclip) “新样式”验证器应该是这样的。这适用于回形针 3.0 及更高版本

```
validates :attachment, :attachment_content_type => { :content_type => ['image/png', 'image/jpg']} 
```

# iphone - 目标 c 中的属性。复制并保留

> ID：10524772
> 
> 赞同：5
> 
> 时间：2012-05-09T22:06:59.497
> 
> 标签：iphone, objective-c, properties, retain

我从苹果文档中读到的内容 retain 会将保留计数增加 1 ，而 release 将减少 1。这对我来说非常清楚。

但是在复制和保留的情况下，我有点困惑。

让我用我正在尝试的代码解释一下。

财产 - -

```
 @property(nonatomic, retain) NSMutableString *a;

   @property(nonatomic, copy) NSMutableString *b;

   @synthesize a = _a ,b = _b

   a=[[NSMutableString alloc]initWithString:@"Hello Ankit"];
   NSLog(@"a memory location A - %p", &a );
   b=[[NSMutableString alloc]initWithString:@"Hello Nigam"];
   NSLog(@"a memory location B- %p", &b );
   c= [[NSMutableString alloc]initWithString:@"Ankit Nigam"];
   NSLog(@"a memory location C %p",&c);

NSMutableString *temp =[[NSMutableString alloc]initWithString:@"hey"];

NSLog(@"temp = %@ %p",temp,&temp);
self.b = temp;
NSLog(@"B is now %@ %p",self.b,&b);

self.a = temp;
NSLog(@"A is now %@ %p",self.a,&a);

And i get the output as -- - -

2012-05-10 03:24:34.756 retainCountTest[2655:f803] a memory location A - 0x6d314fc
2012-05-10 03:24:34.757 retainCountTest[2655:f803] a memory location B- 0x6d31500
2012-05-10 03:24:34.764 retainCountTest[2655:f803] a memory location C 0x6d31504
2012-05-10 03:24:34.764 retainCountTest[2655:f803] temp = hey 0xbfffdd04
2012-05-10 03:24:34.764 retainCountTest[2655:f803] B is now hey 0x6d31500
 2012-05-10 03:24:34.765 retainCountTest[2655:f803] A is now hey 0x6d314fc 
```

但据我从文档中了解到，保留对象必须具有相同的内存地址，其中复制对象将创建一个具有不同内存位置的新对象。

当我再次将日志更改为 ---

```
self.b = temp;
NSLog(@"B is now %@ %p",self.b,&_b);

self.a = temp;
NSLog(@"A is now %@ %p",self.a,&_a);
It return me a complete different memory location for both the object.

2012-05-10 03:28:49.905 retainCountTest[2688:f803] a memory location A - 0x6d4a4ac
2012-05-10 03:28:49.906 retainCountTest[2688:f803] a memory location B- 0x6d4a4b0
2012-05-10 03:28:49.907 retainCountTest[2688:f803] a memory location C 0x6d4a4b4
2012-05-10 03:28:49.907 retainCountTest[2688:f803] temp = hey 0xbfffdd04
2012-05-10 03:28:49.908 retainCountTest[2688:f803] B is now hey 0x6d4a4c0
2012-05-10 03:28:49.908 retainCountTest[2688:f803] a is now hey 0x6d4a4bc 
```

任何人都可以帮助我理解这些保留和复制的完整概念。还有为什么我会得到这些意想不到的结果。

非常感谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-09T23:27:19.213

属性只是一个声明，它允许 setter、getter 和点语法访问器（接口变量隐藏）。

它本身绝对没有任何作用，但允许您使用`-[myInstance myProperty]`来获取变量或使用`-[myInstance setMyProperty:]`来设置它（是的，方法名称自动分配给`-setProperty:`and `-property`）。

当声明一个属性时，你有三个类别——线程锁定、访问控制和内存管理。您只能为每个类别选择一个修饰符，如果您不选择一个，它会自动自动分配给一个。

`@property (<thread locking>, <access control>, <memory management>) id property;`

第一类可以是`atomic`或`nonatomic`。修饰符强制变量上的`atomic`@synchronized(myInstance) 锁定，以允许线程安全。`nonatomic`不使用同步块，并且不是线程安全的。如果您两者都不使用，它会自动设置为`atomic`。

第二类可以是`readonly`或`readwrite`。`readwrite`修饰符也允许修改属性，并允许自动生成 -setProperty: 方法。使用`readonly`修饰符时，不能使用该`-setProperty:`方法。您必须使用对象内部的内部变量来直接设置变量。

第三类可以是`assign`、`retain`和`copy`。修饰符意味着将`assign`内部对象指针设置为传递给`-setProperty:`消息的指针。修饰符分配传递的`retain`指针并将 a 传递`-retain`给对象。

修饰符直接克隆对象-`copy`指向内存中新地址的新对象的新指针。这通过调用传递的对象将内部对象指针设置为传递对象的副本`-copy`。默认修饰符是`assign`，如果您没有在对象上设置内存管理类别修饰符，编译器会警告您 - 因为对象`assign`上的修饰符不受欢迎（除非明确声明）。

有关 -copy 的示例，请查看以下内容：

```
- (void)setProperty:(GXMyObject *)property {

    // This points to the original passed object.
    GXMyObject *original = property;

    // This points to a copy of the passed object.
    CGMyObject *copied = [property copy];

    // This points to yet another copy of the passed object-
    // Independent of the other copies and original.
    _property = [property copy];

    // The anotherProperty is now different on this copy
    // than on the original and the other copies.
    _property.anotherProperty = 4;

    // This will prove that they are all individual objects.
    NSLog(@"%p, %p, %p", original, copied, _property);
} 
```

有一个可选的方法名称声明修饰符，用法如下：`getter = myCustomPropertyGetter`and `setter = myCustomPropertySetter:`（setter 方法名称末尾的冒号`:`是必需的，因为它表示必须传递参数）。

后半部分是属性合成器或动态化器。一旦声明了一个属性（例如，`myView`），如下所示：

`@property (nonatomic, retain) NSView *myView;`

您可以：自己定义 setter 和 getter；`@synthesize`设置器和获取器；`@dynamic`该属性表示它存在于类别或主类中，或者可能在运行时添加（请注意，这不是一个有趣的想法，并且可能导致不良的运行时异常）。

第一个示例，自己编写方法如下所示：

```
// In Apple's LLVM 3.1 Compiler, instance variables can be added 
// within {} below the @implementation as well as the @interface, 
// and in private categories (@interface GXMyClass ()) like before.
@implementation GXMyClass {
    // The internal object pointer is prefixed with an _ to avoid name confusions.
    NSView *_myView;
}

- (NSView *)myView {
    return _myView;
}

- (void)setMyView:(NSView *)myView {
    _myView = [myView retain];
}

@end 
```

第二个例子是使用`@synthesize`指令自动合成它：

```
@implementation GXMyClass

// In the new Apple LLVM 3.1 Clang compiler, the = operator when used 
// next to the @synthesize directive declares an internal private 
// variable and automatically sets to that variable.
@synthesize myView = _myView;

// The internal variable name is now myOtherView, because we did not use the
// = operator to assign an internal variable name to the property.
@synthesize myOtherView;

@end 
```

在最后一个示例中，可能是最令人困惑的，因为它需要使用 @dynamic 指令，您需要添加一些类别或运行时方法：

```
@interface GXMyClass (InternalMethods)
@end

@implementation GXMyClass

// The = assignment operator does not work here.
@dynamic myView;

@end

@implementation GXMyClass (InternalMethods)

- (NSView *)myView {
    return [self methodThatReturnsAnNSView];
}

- (void)setMyView:(NSView *)myView {
    [self methodThatAcceptsAnNSViewArgument:myView];
}

@end 
```

该`@property`声明要求存在上述三个声明之一 - 它自己不做任何事情。然而，它允许的是点语法访问器（用于设置和获取属性的类似 Java 的访问器）。

例如，`@property (copy) NSString *myName;`可以使用 访问`-[myObject myName]`和设置使用`-[myObject setMyName:]`。

现在可以设置 using`myObjectInstance.myName = @"Bob";`和 get using `myObjectInstance.myName`。利用上述所有概念，可以创建一个像这样的对象：

```
// The GXBufferQueue is a queue which buffers all requests, till they are read
// asynchronously later. The backing store is an NSMutableArray to which all
// buffer writes are appended to, and from which the first object is pulled and
// returned when the buffer is read to.   
@interface GXBufferQueue

@property (nonatomic, readwrite, copy, setter = write:, getter = read) id buffer;

+ (GXBufferQueue *)queue;

@end

@implementation GXBufferQueue {
    // This queue is an internal array and is 'tacked on' to the @implementation
    // so no others can see it, and it can be marked @private so subclasses cannot
    // use it. It is also good code practice to have @interfaces composed of only
    // @properties, setters, and getters, rather than expose internal variables.
    NSMutableArray *_internalQueue;
}

+ (GXBufferQueue *)queue {
    return [[[GXBufferQueue alloc] init] autorelease];
}

- (id)init {
    if((self = [super init])) {
        _internalQueue = [[NSMutableArray alloc] init];
    }
}

- (void)write:(id)buffer {
    [_internalQueue addObject:buffer];
}

- (id)read {
    if(!(_internalQueue.count > 0)) return nil;

    id buffer = [_internalQueue objectAtIndex:0];
    [_internalQueue removeObjectAtIndex:0];
    return buffer;
}

@end 
```

注意：此代码未经测试。现在你有了一个 GXBufferQueue，下面所有的工作：

```
GXBufferQueue *queue = [GXBufferQueue queue];

// Option One: using the traditional message syntax:
[queue write:@"This will be now added to the buffer."];
NSLog(@"Now the string written to the queue will be read \
and removed from the queue, like a stack pop. ", [queue read]);

// Option Two: using the new dot-syntax accessors:
queue.buffer = @"As clunky as this looks, it works the same as above.";
NSLog(@"These lines work just the same as the ones above: ", queue.buffer); 
```

正如你所看到的，属性有很多可能，而且它们可以做的不仅仅是变量声明。如果有任何问题或社区希望我在帖子中添加/纠正的任何内容，请发表评论！:D

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-09T22:35:17.310

是的，`retainCount`没用——不要调用它——假设`copy`总是返回一个新实例是不正确的。

如果发送了一个不可变对象`copy`，它通常会被实现为：

```
- copy { return [self retain]; } 
```

即没有必要制作一个实际的副本，因为内容不能改变。

当然，由于您正在处理静态，编译成二进制字符串，因此实现可能更接近：

```
- retain { return self; }
- copy { return self; }
- (void)release { ; }
- (void)dealloc { ; } 
```

也许——以上所有都是可能随时更改的实现细节。不过，最重要的是，以上所有内容都履行了保留/释放/复制/等合同......

# java - 油漆闪烁的java

> ID：10524774
> 
> 赞同：1
> 
> 时间：2012-05-09T22:07:35.837
> 
> 标签：java, swing, paint

1.重绘时窗口闪烁。我怎样才能消除它？使用更新方法也不起作用。2.如何更新netbeans中所有非最新的类？看起来我的 netbeans 使用了一些旧类（在 jdk 7 之前）。

```
import java.awt.Frame;
import java.awt.Graphics;
import java.awt.GraphicsConfiguration;
import java.awt.*;
import java.awt.event.ActionListener;
import java.util.Timer;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JWindow;

public class Splash extends JWindow {

    private boolean mIsRunning;
    private boolean mIsFadingOut;
    volatile static boolean s = true;
    private int mAngle;
    private int mFadeCount;
    private int mFadeLimit = 15;

    Splash(Frame f) {
        super(f);
    }

    public void startt() {
        while (s) {
            repaint();

            mAngle += 3;
            if (mAngle >= 360) {
                mAngle = 0;
            }
            if (mIsFadingOut) {
                if (--mFadeCount == 0) {
                    mIsRunning = false;
                }
            } else if (mFadeCount < mFadeLimit) {
                mFadeCount++;
            }
            try {
                Thread.sleep(100);
            } catch (InterruptedException ex) {
                Logger.getLogger(Splash.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
    }

    public void paint(Graphics g) {
        int w = getWidth();
        int h = getHeight();

        // Paint the view.
        super.paintComponents(g);
        Graphics2D g2 = (Graphics2D) g.create();
        float fade = (float) mFadeCount / (float) mFadeLimit;
        // Gray it out.
        Composite urComposite = g2.getComposite();
        g2.setComposite(AlphaComposite.getInstance(
                AlphaComposite.SRC_OVER, .5f * fade));
        g2.fillRect(0, 0, w, h);
        g2.setComposite(urComposite);

        // Paint the wait indicator.
        int s = Math.min(w, h) / 5;
        int cx = w / 2;
        int cy = h / 2;
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                RenderingHints.VALUE_ANTIALIAS_ON);
        g2.setStroke(
                new BasicStroke(s / 4, BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND));
        g2.setPaint(Color.white);
        g2.rotate(Math.PI * mAngle / 180, cx, cy);
        for (int i = 0; i < 12; i++) {
            float scale = (11.0f - (float) i) / 11.0f;
            g2.drawLine(cx + s, cy, cx + s * 2, cy);
            g2.rotate(-Math.PI / 6, cx, cy);
            g2.setComposite(AlphaComposite.getInstance(
                    AlphaComposite.SRC_OVER, scale * fade));
        }

        g2.dispose();
    }
}

public void showSplash(){
    final JFrame p = this; //parent
    final  Rectangle s = this.getBounds(); //parent size

    new Thread(){
         public void run(){
             splash = new Splash(p);
             splash.setBounds(s);
             splash.setVisible(true);
             splash.startt();
         }
    }.start();
} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T22:22:00.927

不要调用`Thread.sleep(...)`EDT，而是使用示例所示的 Swing Timer。此外，您还需要`paintComponent(...)`在 JWindow 持有的 JPanel 方法中绘制以使用 Swing 的默认双缓冲。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T22:23:06.920

问题来自您覆盖 JWindow 的绘制方法这一事实。改写`paintComponent()`JPanel 的，它有双缓冲：

```
import java.awt.AlphaComposite;
import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Composite;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.RenderingHints;
import java.util.logging.Level;
import java.util.logging.Logger;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JWindow;
import javax.swing.SwingUtilities;

public class Test extends JFrame {

    /**
     * @param args
     */
    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                JWindow window = new JWindow();
                final Splash splash = new Splash();
                window.add(splash);
                window.setSize(100, 30);
                window.setVisible(true);

                new Thread() {

                    @Override
                    public void run() {
                        splash.startt();
                    }
                }.start();
            }
        });
    }

    public static class Splash extends JPanel {

        private boolean mIsRunning;
        private boolean mIsFadingOut;
        volatile static boolean s = true;
        private int mAngle;
        private int mFadeCount;
        private int mFadeLimit = 30;

        Splash() {
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            int w = getWidth();
            int h = getHeight();

            // Paint the view.
            super.paintComponents(g);
            Graphics2D g2 = (Graphics2D) g.create();
            float fade = (float) mFadeCount / (float) mFadeLimit;
            // Gray it out.
            Composite urComposite = g2.getComposite();
            g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, .5f * fade));
            g2.fillRect(0, 0, w, h);
            g2.setComposite(urComposite);

            // Paint the wait indicator.
            int s = Math.min(w, h) / 5;
            int cx = w / 2;
            int cy = h / 2;
            g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            g2.setStroke(new BasicStroke(s / 4, BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND));
            g2.setPaint(Color.white);
            g2.rotate(Math.PI * mAngle / 180, cx, cy);
            for (int i = 0; i < 12; i++) {
                float scale = (11.0f - i) / 11.0f;
                g2.drawLine(cx + s, cy, cx + s * 2, cy);
                g2.rotate(-Math.PI / 6, cx, cy);
                g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, scale * fade));
            }

            g2.dispose();
        }

        public void startt() {
            while (s) {

                mAngle += 3;
                if (mAngle >= 360) {
                    mAngle = 0;
                }
                if (mIsFadingOut) {
                    if (--mFadeCount == 0) {
                        mIsRunning = false;
                    }
                } else if (mFadeCount < mFadeLimit) {
                    mFadeCount++;
                }
                repaint();
                try {
                    Thread.sleep(100);
                } catch (InterruptedException ex) {
                    Logger.getLogger(Splash.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        }

    }

} 
```

# android - 当用户在对话框中按下确定按钮时出现 NullPointerException？

> ID：10524776
> 
> 赞同：0
> 
> 时间：2012-05-09T22:07:46.707
> 
> 标签：android, dialog, nullpointerexception, sharedpreferences, checkbox

我目前正在尝试调试我的应用程序，但是，我遇到了 NullPointerException 的一些困难。我有一个带有 4 个复选框、一个保存按钮和一个取消按钮的对话框。当用户在对话框中标记他们的选择然后按下保存按钮时，它返回 NullPointerException，我不明白为什么。以下是与查找解决方案相关的 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/scrollviewPref"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:fillViewport="true"
android:layout_marginTop="10dip">

    <LinearLayout
        android:layout_width="300dip"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:minWidth="200dip">

            <CheckBox
                android:id="@+id/altitudeCheckbox"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Altitude"
                android:layout_gravity="left" />

            <CheckBox
                android:id="@+id/latitudeCheckbox"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Latitude"
                android:layout_gravity="left" />

            <CheckBox
                android:id="@+id/longitudeCheckbox"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Longitude"
                android:layout_gravity="left" />

            <CheckBox
                android:id="@+id/velocityCheckbox"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Velocity"
                android:layout_gravity="left" />

            <LinearLayout 
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginLeft="10dip"
                android:layout_marginRight="10dip"
                android:layout_marginBottom="10dip"
                android:layout_marginTop="10dip">

                    <Button
                        android:id="@+id/saveBtn"
                        android:layout_width="0dp"
                        android:layout_height="wrap_content"
                        android:text="Save"
                        android:layout_weight="1" />

                    <Button
                        android:id="@+id/cancelBtn"
                        android:layout_width="0dp"
                        android:layout_height="wrap_content"
                        android:text="Cancel"
                        android:layout_weight="1" />

    </LinearLayout>

</LinearLayout>

</ScrollView> 
```

代码集是将用户的选择保存到 SharedPreferences 的代码。

```
package shc_BalloonSat.namespace;
import android.app.Dialog;
import android.content.Context;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.util.Log;
import android.view.View;
import android.widget.CheckBox;

public class CheckPreferences extends Dialog
{
Context shc;
private CheckBox altitudeCheckBox = null;
private CheckBox latitudeCheckbox = null;
private CheckBox longitudeCheckbox = null;
private CheckBox velocityCheckbox = null;
private CheckPreferencesListener listener;
SharedPreferences pref;
Editor prefEditor;
String userAltitudePreference = "";
String userLatitudePreference = "";
String userLongitudePreference = "";
String userVelocityPreference = "";
String userAltitudeChoice = "";
String userLatitudeChoice = "";
String userLongitudeChoice = "";
String userVelocityChoice = "";

public interface CheckPreferencesListener 
{
public void onSettingsSaved();
public void onCancel();
}

public CheckPreferences(Context context, CheckPreferencesListener l)
{
super(context);
shc = context;
this.listener = l;
this.setContentView(R.layout.custompreferences);

altitudeCheckBox = (CheckBox) findViewById(R.id.altitudeCheckbox);
latitudeCheckbox = (CheckBox) findViewById(R.id.latitudeCheckbox);
longitudeCheckbox = (CheckBox) findViewById(R.id.longitudeCheckbox);
velocityCheckbox = (CheckBox) findViewById(R.id.velocityCheckbox);

this.setCancelable(false);
this.setCanceledOnTouchOutside(false);
this.setTitle("Data View Settings");
pref = shc.getSharedPreferences("shared_prefs", 1);
prefEditor = pref.edit();
initOnClick();
}

private void initOnClick()
{
View.OnClickListener click = new View.OnClickListener()
{
    public void onClick(View v)
    {
    switch (v.getId())
    {
            case R.id.saveBtn:
            {
                saveSettings();
                listener.onSettingsSaved();
                dismiss();
                break;
            }

            case R.id.cancelBtn:
            {
                listener.onCancel();
                dismiss();
                break;
            }
    }
    }
};

    // Save Button
    this.findViewById(R.id.saveBtn).setOnClickListener(click);

    // Cancel Button
    this.findViewById(R.id.cancelBtn).setOnClickListener(click);
}

// This function is called when the user chooses the save their preferences
public void saveSettings()
{
try
{
    if (altitudeCheckBox.isChecked())
    {
    userAltitudeChoice = "true";
    prefEditor.putString(userAltitudePreference, userAltitudeChoice);
    prefEditor.commit();
    }
    else if (latitudeCheckbox.isChecked())
    {
    userLatitudeChoice = "true";
    prefEditor.putString(userLatitudePreference, userLatitudeChoice);
    prefEditor.commit();
    }

    else if (longitudeCheckbox.isChecked())
    {
    userLongitudeChoice = "true";
    prefEditor.putString(userLongitudePreference, userLongitudeChoice);
        prefEditor.commit();  
    }

    else if (velocityCheckbox.isChecked())
    {
    userVelocityChoice = "true";
    prefEditor.putString(userVelocityPreference, userVelocityChoice);
    prefEditor.commit(); 
    }

    else
    {

    } 
}

catch (NullPointerException npe)
{
    if (npe.getMessage() != null)
    {
            Log.e("<tag>", npe.getMessage());
    }

    else
    {
    Log.e("<tag>", "Save Settings e.getMessage() was null");
    }
}
}
} 
```

NullPointerException 发生在 savedSettings 函数中。该函数所做的只是将数据放入 SharedPreferences 中。知道为什么这会导致某些东西为空吗？提前感谢您提供的任何帮助。

更新：以下是错误日志。

```
05-09 17:25:28.835: E/<tag>(5447): Save Settings e.getMessage() was null
05-09 17:25:28.866: E/AndroidRuntime(5447): FATAL EXCEPTION: main
05-09 17:25:28.866: E/AndroidRuntime(5447): java.lang.NullPointerException
05-09 17:25:28.866: E/AndroidRuntime(5447):     at shc_BalloonSat.namespace.CheckPreferences$1.onClick(CheckPreferences.java:59)
05-09 17:25:28.866: E/AndroidRuntime(5447):     at android.view.View.performClick(View.java:2408)
05-09 17:25:28.866: E/AndroidRuntime(5447):     at android.view.View$PerformClick.run(View.java:8816)
05-09 17:25:28.866: E/AndroidRuntime(5447):     at android.os.Handler.handleCallback(Handler.java:587)
05-09 17:25:28.866: E/AndroidRuntime(5447):     at android.os.Handler.dispatchMessage(Handler.java:92)
05-09 17:25:28.866: E/AndroidRuntime(5447):     at android.os.Looper.loop(Looper.java:123)
05-09 17:25:28.866: E/AndroidRuntime(5447):     at android.app.ActivityThread.main(ActivityThread.java:4627)
05-09 17:25:28.866: E/AndroidRuntime(5447):     at java.lang.reflect.Method.invokeNative(Native Method)
05-09 17:25:28.866: E/AndroidRuntime(5447):     at java.lang.reflect.Method.invoke(Method.java:521)
05-09 17:25:28.866: E/AndroidRuntime(5447):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
05-09 17:25:28.866: E/AndroidRuntime(5447):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
05-09 17:25:28.866: E/AndroidRuntime(5447):     at dalvik.system.NativeStart.main(Native Method) 
```

下面是我在其中实例化侦听器的主类。

```
package shc_BalloonSat.namespace;
import java.text.DecimalFormat;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.net.ConnectivityManager;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.view.SubMenu;
import android.widget.TextView;
import android.widget.Toast;

public class Shc_BalloonSat_Activity extends Activity
{
int historyCountFromUser;
httpAPI api;
mapAPI map;
runDialog dialog;
CheckPreferences check;
DecimalFormat df = new DecimalFormat("##.#####");
DecimalFormat decimalf = new DecimalFormat("##.######");
AlertDialog alert;
SharedPreferences pref;
Editor prefEditor;
String lastpacketsPHP;
TextView historyTV;
TextView infoTV;

// User to determine how many packet the user would like to see.
int userDefinedCount = 5;

/*
 *  Called when the activity is first created. 
*/

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    loadApp();
}

public boolean isNetworkConnected(Context context)
{
    ConnectivityManager connectionManager = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
    if (connectionManager.getActiveNetworkInfo() != null && connectionManager.getActiveNetworkInfo().isAvailable() && connectionManager.getActiveNetworkInfo().isConnected())
    {
        return true;
    }

    else 
    {
        return false;
    }
}

public void showAlert()
{
    alert.setTitle("Sorry!");
    alert.setMessage("Please connect to the internet to access the full functionality of this app.");
    alert.setButton("OK", new DialogInterface.OnClickListener()
    {
        public void onClick(DialogInterface dialog, int which)
        {

        }
    });
    alert.show();
}

public void loadApp()
{
    setContentView(shc_BalloonSat.namespace.R.layout.main);
    alert = new AlertDialog.Builder(this).create();
    lastpacketsPHP = "";
    pref = getSharedPreferences("shared_prefs", 1);
    prefEditor = pref.edit();
    //prefEditor.putString(lastpacketsPHP, "\* PHP file location goes here. */");
    //prefEditor.commit();

    // These next two lines are used to test the PHP files on the SHC server by determining if PHP is set up correctly.
    prefEditor.putString(lastpacketsPHP, "\* PHP file location goes here. */");
    prefEditor.commit();   

    if (!isNetworkConnected(this))
    {
    showAlert();
    }

    else
    {
    api = new httpAPI(this);
        map = new mapAPI(this);
        dialog = new runDialog(this, api, new runDialog.OnDataLoadedListener()
        {

            public void dataLoaded(String textViewString)
            {
            infoTV = (TextView)findViewById(shc_BalloonSat.namespace.R.id.info);
                infoTV.setText(textViewString);
            }
        });

        dialog.execute();
    }

    CheckPreferences cp = new CheckPreferences(this, new CheckPreferences.CheckPreferencesListener()
    {

        public void onSettingsSaved()
        {
            // This function let's the activity know that the user has saved their preferences and
            // that the rest of the app should be now be shown.
            check.saveSettings();
            assignInfoToInfoTextView();
            assignInfoToHistoryTextView();
        }

        public void onCancel()
        {
            Toast.makeText(getApplicationContext(), "Settings dialog cancelled", Toast.LENGTH_LONG).show();
        }
    });

    cp.show();
}

@Override
public boolean onCreateOptionsMenu(Menu menu)
{
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(shc_BalloonSat.namespace.R.menu.mainmenu, menu);

    SubMenu submenu = menu.addSubMenu(0, Menu.FIRST, Menu.NONE, "Preferences");
    submenu.add(0, 5, Menu.NONE, "Get Last 5 Packets");
    submenu.add(0, 10, Menu.NONE, "Get Last 10 Packets");
    submenu.add(0, 20, Menu.NONE, "Get Last 20 Packets");
    inflater.inflate(shc_BalloonSat.namespace.R.menu.mainmenu, submenu);

    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item)
{
    // Handle item selection
    switch (item.getItemId())
    {
        case shc_BalloonSat.namespace.R.id.viewKML:
            viewKML();
            return true;
        case 5:
            viewLast5Packets();
            return true;
        case 10:
            viewLast10Packets();
            return true;
        case 20:
            viewLast20Packets();
            return true;
        default:
            return super.onOptionsItemSelected(item);
    }
}

public void assignInfoToInfoTextView()
{       
    try
    {
        String result = api.result.substring(1, api.result.length()-2);
        JSONObject json_data = new JSONObject(result);
        String infoText = "";

        if (check.userAltitudePreference.equals("true"))
        {
        double altitudeData = json_data.getDouble("altitude");
        double altitudeInFeet = altitudeData * 3.281;
        infoText = "Last Known Altitude: " + df.format(altitudeInFeet) + " ft\n";
        }

        else if (check.userVelocityPreference.equals("true"))
        {
        Double speedData = json_data.optDouble("speed");

        if (speedData.isNaN())
        {
            speedData = 0.00;
        }

        Double direction = json_data.optDouble("heading");
        String directionUnits = " degrees from N";
        String directionText = "";

        if (direction == 0)
        {
            directionText = ", N";
        }

        else if (direction > 0 && direction < 45)
        {
            directionText = ", N NE";
        }

        else if (direction == 45)
        {
            directionText = ", NE";
        }

        else if (direction > 45 && direction < 90)
        {
            directionText = ", E NE";
        }

        else if (direction == 90)
        {
            directionText = ", E";
        }

        else if (direction > 90 && direction < 135)
        {
            directionText = ", E SE";
        }

        else if (direction == 135)
        {
            directionText = ", SE";
        }

        else if (direction > 135 && direction < 180)
        {
            directionText = ", S SE";
        }

        else if (direction == 180)
        {
            directionText = ", S";
        }

        else if (direction > 180 && direction < 225)
        {
            directionText = ", S SW";
        }

        else if (direction == 225)
        {
            directionText = ", SW";
        }

        else if (direction > 225 && direction < 270)
        {
            directionText = ", W SW";
        }

        else if (direction == 270)
        {
            directionText = ", W";
        }

        else if (direction > 270 && direction < 315)
        {
            directionText = ", W NW";
        }

        else if (direction == 315)
        {
            directionText = ", NW";
        }

        else if (direction > 315 && direction < 360)
        {
            directionText = ", N NW";
        }

        else if (direction.isNaN())
            {
            directionText = " Invalid direction";
            }

        else
        {

            }

        infoText += "Last Known Velocity: " + df.format(speedData) + " m/s " + direction + directionUnits + directionText + "\n";
        }

        else if (check.userLatitudePreference.equals("true"))
        {
        double recentLatitudeData = json_data.getDouble("latitude");
        infoText += "Last Known Latitude: " + df.format(recentLatitudeData) + "\n";
        }

        else if (check.userLongitudePreference.equals("true"))
        {
        double recentLongitudeData = json_data.getDouble("longitude");
        infoText += "Last Known Longtitude: " + df.format(recentLongitudeData) + "\n";
        }

        infoTV.setText(infoText);
    }

    catch (JSONException e)
    {
        if (e.getMessage() != null)
        {
        Log.e("<tag>", e.getMessage());
        }

        else
        {
        Log.e("<tag>", "Last Known Textview 1 e.getMessage() was null");
        }

        Toast.makeText(this,"JSON Error in (Last Known) method!",Toast.LENGTH_SHORT).show();

    }

    catch (Exception e)
    {
        //broke here, not getting a message for some reason
    if (e.getMessage() != null)
    {
            Log.e("<tag>", e.getMessage());
    }

    else
    {
    Log.e("<tag>", "Last Known Textview 2 e.getMessage() was null");
    }

    Toast.makeText(this,"Error in (Last Known) method!",Toast.LENGTH_SHORT).show();
    }
}

public void assignInfoToHistoryTextView()
{

    try
    {
        JSONArray jArray = new JSONArray(api.result);
        historyTV = (TextView)findViewById(shc_BalloonSat.namespace.R.id.history);

        for (int count = 1; count < userDefinedCount; count++)
        {
                JSONObject json_data = jArray.getJSONObject(count);

                double altitudeData = json_data.getDouble("altitude");
                double altitudeInFeet = altitudeData * 3.281;
                String historyText = "Altitude: " + decimalf.format(altitudeInFeet) + " ft\n";

                Double speedData = json_data.optDouble("speed");

                if (speedData.isNaN())
                {
                    speedData = 0.00;
                }

                    Double direction = json_data.optDouble("heading");
                    String directionUnits = " degrees from N";
            String directionText = "";

            if (direction == 0)
            {
                directionText = ", N";
            }
            else if (direction > 0 && direction < 45)
            {
                directionText = ", N NE";
            }

            else if (direction == 45)
            {
                directionText = ", NE";
            }

            else if (direction > 45 && direction < 90)
            {
                directionText = ", E NE";
            }

            else if (direction == 90)
            {
                directionText = ", E";
            }

            else if (direction > 90 && direction < 135)
            {
                directionText = ", E SE";
            }

            else if (direction == 135)
            {
                directionText = ", SE";
            }

            else if (direction > 135 && direction < 180)
            {
                directionText = ", S SE";
            }

            else if (direction == 180)
            {
                directionText = ", S";
            }

            else if (direction > 180 && direction < 225)
            {
                directionText = ", S SW";
            }

            else if (direction == 225)
            {
                directionText = ", SW";
            }

            else if (direction > 225 && direction < 270)
            {
                directionText = ", W SW";
            }

            else if (direction == 270)
            {
                directionText = ", W";
            }

            else if (direction > 270 && direction < 315)
            {
                directionText = ", W NW";
            }

            else if (direction == 315)
            {
                directionText = ", NW";
            }

            else if (direction > 315 && direction < 360)
            {
                directionText = ", N NW";
            }

            else if (direction.isNaN())
            {
                directionText = " Invalid direction";
            }

            else
            {

            }

            if (direction.isNaN())
            {
                historyText += "Velocity: " + df.format(speedData) + " m/s " + directionText + "\n";
            }

            else
            {
                historyText += "Velocity: " + df.format(speedData) + " m/s,\n" + direction + directionUnits + directionText + "\n";
            }

                double latitudeData = json_data.getDouble("latitude");
                historyText += "Latitude: " + df.format(latitudeData) + "\n";

                double longitudeData = json_data.getDouble("longitude");
                historyText += "Longtitude: " + df.format(longitudeData) + "\n\n";

                historyTV.setText(historyTV.getText().toString() + historyText);
        }
    }

    catch (JSONException e)
    {
        if (e.getMessage() != null)
        {
        Log.e("log_tag", "Error parsing data: " + e.toString());
        }

        else
    {
    Log.e("<tag>", "History TextView 1 e.getMessage() was null");
    }   
    }

    catch(Exception e)
    {
        if (e.getMessage() != null)
    {
        Log.e("log_tag", "Error parsing data: " + e.toString());
    }

        else
    {
    Log.e("<tag>", "History TextView 2 e.getMessage() was null");
    }

    }

}

void viewLast5Packets()
{
    if (!isNetworkConnected(this))
    {
        showAlert();
    }

    else
    {
        historyTV.setText("");

        userDefinedCount = 5;
        //prefEditor.putString(lastpacketsPHP, "\* PHP file location goes here. */");
        //prefEditor.commit();

        // These next two lines are used to test the PHP files on the SHC server by determining if PHP is set up correctly.
        prefEditor.putString(lastpacketsPHP, "\* PHP file location goes here. */");
        prefEditor.commit();

        dialog = new runDialog(this, api, new runDialog.OnDataLoadedListener()
        {
        public void dataLoaded(String textViewString)
        {
            TextView infoTV = (TextView)findViewById(shc_BalloonSat.namespace.R.id.info);
            infoTV.setText(textViewString);
            assignInfoToInfoTextView();
            assignInfoToHistoryTextView();
        }
        });

        dialog.execute();
    }
}

void viewLast10Packets()
{
    if (!isNetworkConnected(this))
    {
        showAlert();
    }

    else
    {
        historyTV.setText("");           

    userDefinedCount = 10;
    //prefEditor.putString(lastpacketsPHP, "\* PHP file location goes here. */");
    //prefEditor.commit();

    // These next two lines are used to test the PHP files on the SHC server by determining if PHP is set up correctly.
    prefEditor.putString(lastpacketsPHP, \* PHP file location goes here. */");
    prefEditor.commit();

    dialog = new runDialog(this, api, new runDialog.OnDataLoadedListener()
    {
    public void dataLoaded(String textViewString)
    {
        TextView infoTV = (TextView)findViewById(shc_BalloonSat.namespace.R.id.info);
        infoTV.setText(textViewString);
        assignInfoToInfoTextView();
        assignInfoToHistoryTextView();
    }
    });

    dialog.execute();
    }
}

void viewLast20Packets()
{
    if (!isNetworkConnected(this))
    {
        showAlert();
    }

    else
    {
            historyTV.setText("");
        userDefinedCount = 20;
        //prefEditor.putString(lastpacketsPHP, "\* PHP file location goes here. */");
        //prefEditor.commit();

        // These next two lines are used to test the PHP files on the SHC server by determining if PHP is set up correctly.
    prefEditor.putString(lastpacketsPHP, "\* PHP file location goes here. */");
    prefEditor.commit();

        dialog = new runDialog(this, api, new runDialog.OnDataLoadedListener()
        {

            public void dataLoaded(String textViewString)
            {
            TextView infoTV = (TextView)findViewById(shc_BalloonSat.namespace.R.id.info);
                infoTV.setText(textViewString);
                assignInfoToInfoTextView();
                assignInfoToHistoryTextView();
            }
        });

        dialog.execute();
    }
}

public void viewKML()
{
    if (!isNetworkConnected(this))
    {
        showAlert();
    }

    else
    {
        map.openKML();
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:14:24.270

最容易找到 NullPointerException 原因的方法是查看调试 logcat 输出。它将准确地向您显示问题发生的位置。

只需查找以您的包名称开头的第一行，就可以了。

ps你需要从你的代码中取出catch，这样代码就会崩溃

或者如果找不到，请发布日志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:15:50.527

从对代码的粗略检查来看，您似乎从未初始化过`listener`，所以当您这样做时`listener.onSettingsSaved();`它会崩溃。

编辑：

伙计，你仍然永远不会设置它：

```
public CheckPreferences(Context context, CheckPreferencesListener l)
{
super(context);
shc = context;
this.setContentView(R.layout.custompreferences);
this.setCancelable(false);
this.setCanceledOnTouchOutside(false);
this.setTitle("Data View Settings");
pref = shc.getSharedPreferences("shared_prefs", 1);
prefEditor = pref.edit();
initOnClick();
} 
```

你失踪了`this.listener = l;`！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:37:26.420

我的想法是

```
private CheckBox altitudeCheckBox = (CheckBox) findViewById(R.id.altitudeCheckbox);
private CheckBox latitudeCheckbox = (CheckBox) findViewById(R.id.latitudeCheckbox);
private CheckBox longitudeCheckbox = (CheckBox) findViewById(R.id.longitudeCheckbox);
private CheckBox velocityCheckbox = (CheckBox) findViewById(R.id.velocityCheckbox); 
```

在对话框的构造函数之前调用，因此它们为空，因为 findViewById 找不到布局视图。尝试将它们更改为：

```
private CheckBox altitudeCheckBox = null;
private CheckBox latitudeCheckbox = null;
private CheckBox longitudeCheckbox = null;
private CheckBox velocityCheckbox = null; 
```

然后在构造函数中的 this.setContentView(R.layout.custompreferences) 行之后添加以下内容：

```
altitudeCheckBox = (CheckBox) findViewById(R.id.altitudeCheckbox);
latitudeCheckbox = (CheckBox) findViewById(R.id.latitudeCheckbox);
longitudeCheckbox = (CheckBox) findViewById(R.id.longitudeCheckbox);
velocityCheckbox = (CheckBox) findViewById(R.id.velocityCheckbox); 
```

希望这可以帮助...

# javascript - 从 JSON 对象的内部深处获取信息

> ID：10524780
> 
> 赞同：1
> 
> 时间：2012-05-09T22:08:07.877
> 
> 标签：javascript, json, object, loops, for-loop

我有一个来自 CrunchBase API 的 JSON 对象，它为我提供了来自给定公司的一堆信息。现在我正在尝试通过 JSON 对象并创建他们的投资者列表。投资者可以属于以下三类之一`"company", "financial_org", or "person"`。所有三种类型都将附加到同一个列表中，`finalInvestorList`

该脚本运行没有错误，但仅生成第一轮上市的投资者名单。我已经记录了我认为可能有帮助的所有内容。日志在同一行注释中。

基本上我的问题是它只循环一次，因此只增加了第一轮的投资者。任何帮助将不胜感激。如果您需要更多信息，请告诉我！

```
 var investorList = function(data, num) {
        var fundingRounds = data["funding_rounds"];
        var finalInvestorList = []
        console.log(fundingRounds.length) // 3

        for (i=0; i < fundingRounds.length; i++) {
            var investments = data["funding_rounds"][i]["investments"];
            console.log(data["funding_rounds"][1]["investments"]); //correctly logs the index 1 round for spling (2nd round)
            var round = data["funding_rounds"][i];
            console.log('round' + i); //only logs round0, never loops around for round1, round2
            for (i=0; i < investments.length; i++) {

                var angelObject = round["investments"][i]["person"];
                if (angelObject != null) {
                    console.log("angel fired"); //fires for "Mitch Blumenfeld"
                    var angel = angelObject["first_name"] + " " + angelObject["last_name"];
                    finalInvestorList[i] = angel;
                }

                var financialOrgObject = round["investments"][i]["financial_org"];
                if (financialOrgObject != null) {
                    console.log("financial_org fired"); //fires for "Bucknell Venture Plan Competition"
                    console.log(financialOrgObject['name']); //Bucknell VPC
                    var financialOrg = financialOrgObject["name"]
                    finalInvestorList[i] = financialOrg
                }

                var companyObject = round['investments'][i]["company"];
                if (companyObject != null) {
                    console.log('company fired'); //i haven't bothered with this yet.. just logging it so ill know if its firing
                }
            }
        }
        console.log(finalInvestorList); //["Bucknell Venture Plan Competition", "Mitch Blumenfeld"]

    } 
```

数据表示的 JSON 对象如下所示，我已将其缩短为所需的位。JSON 响应数据中的对象由 data["funding_rounds"] 表示，此数据是使用 crunch API 检索的，可以在[http://api.crunchbase.com/v/1/company/spling 找到完整格式。 js](http://api.crunchbase.com/v/1/company/spling.js)

```
"funding_rounds":
  [{"round_code": "seed",
    "source_url": "",
    "source_description": "",
    "raised_amount": 50000.0,
    "raised_currency_code": "USD",
    "funded_year": 2011,
    "funded_month": 2,
    "funded_day": 1,
    "investments":
     [{"company": null,
       "financial_org":
        {"name": "Bucknell Venture Plan Competition",
         "permalink": "bucknell-venture-plan-competition",
         "image": null},
       "person": null},
      {"company": null,
       "financial_org": null,
       "person":
        {"first_name": "Mitch",
         "last_name": "Blumenfeld",
         "permalink": "mitch-blumenfeld",
         "image": null}}]},
   {"round_code": "seed",
    "source_url": "http://techcrunch.com/2011/09/08/dreamit-ventures-launches-its-fall-2011-philadelphia-class/",
    "source_description": "",
    "raised_amount": 25000.0,
    "raised_currency_code": "USD",
    "funded_year": 2011,
    "funded_month": 9,
    "funded_day": 1,
    "investments":
     [{"company": null,
       "financial_org":
        {"name": "DreamIt Ventures",
         "permalink": "dreamit-ventures",
         "image":
          {"available_sizes":
            [[[150,
               57],
              "assets/images/resized/0002/7773/27773v5-max-150x150.jpg"],
             [[250,
               96],
              "assets/images/resized/0002/7773/27773v5-max-250x250.jpg"],
             [[251,
               97],
              "assets/images/resized/0002/7773/27773v5-max-450x450.jpg"]],
           "attribution": null}},
       "person": null}]},
   {"round_code": "a",
    "source_url": "http://techcrunch.com/2011/12/05/new-content-sharing-network-spling-launches-announces-400k-series-a/",
    "source_description": "New Content Sharing Network Spling Launches, Announces $400K Series A",
    "raised_amount": 400000.0,
    "raised_currency_code": "USD",
    "funded_year": 2011,
    "funded_month": 12,
    "funded_day": 5,
    "investments":
     [{"company": null,
       "financial_org":
        {"name": "Deep Fork Capital",
         "permalink": "deep-fork-capital-2",
         "image":
          {"available_sizes":
            [[[150,
               20],
              "assets/images/resized/0008/0167/80167v1-max-150x150.png"],
             [[250,
               34],
              "assets/images/resized/0008/0167/80167v1-max-250x250.png"],
             [[450,
               62],
              "assets/images/resized/0008/0167/80167v1-max-450x450.png"]],
           "attribution": null}},
       "person": null},
      {"company": null,
       "financial_org": null,
       "person":
        {"first_name": "John",
         "last_name": "Ason",
         "permalink": "john-ason",
         "image": null}},
      {"company": null,
       "financial_org": null,
       "person":
        {"first_name": "Mitchell",
         "last_name": "Blumenfeld",
         "permalink": "mitchell-blumenfeld",
         "image": null}},
      {"company": null,
       "financial_org": null,
       "person":
        {"first_name": "Gianni",
         "last_name": "Martire",
         "permalink": "gianni-martire",
         "image":
          {"available_sizes":
            [[[138,
               150],
              "assets/images/resized/0006/3720/63720v4-max-150x150.jpg"],
             [[230,
               250],
              "assets/images/resized/0006/3720/63720v4-max-250x250.jpg"],
             [[414,
               450],
              "assets/images/resized/0006/3720/63720v4-max-450x450.jpg"]],
           "attribution": ""}}}]}] 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T22:20:58.770

您在每个循环中为计数器使用相同的变量名称，因此当内部循环完成并且外部循环进行第二次迭代时，`i`is `investments.length`， not `1`。为每个循环使用不同的变量名：

```
for (var roundIdx = 0; roundIdx < fundingRounds.length; roundIdx++) {
    ...
    for (var invIdx = 0; invIdx < investments.length; invIdx++) {
        ... 
```

此外，不要使用`array[i] = value`符号填充您的数组，只需使用`array.push(value)`. 您不需要跟踪索引。

但是，我建议`Array.forEach()`使用点语法而不是方括号表示法来迭代您的数组：

```
function investorList(data, num) {
    var finalInvestorList = [];
    data.funding_rounds.forEach(function (round, i) {
        round.investments.forEach(function (investment, i) {
            if (investment.person) {
                finalInvestorList.push(investment.person.first_name + " " +
                                       investment.person.last_name);
            }
            else if (investment.financial_org) {
                finalInvestorList.push(investment.financial_org.name)
            }
            else if (investment.company) {
                finalInvestorList.push(investment.company.name)
            }
        }
    }
} 
```

对于本机不支持的旧版浏览器，请`Array.forEach()`使用[此处的实现](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach#Compatibility)来填充浏览器。

# android - Android上的AIR中真正的全屏？

> ID：10524784
> 
> 赞同：1
> 
> 时间：2012-05-09T22:08:43.903
> 
> 标签：android, mobile, air, fullscreen, tablet

我正在使用 Android 上的 AIR 开发交互式视频应用程序。该应用程序适用于高危社区，以鼓励他们进行常见的癌症筛查，并将部署在诊所中。我正在测试并最终部署在 1280x800 ICS 平板电脑 ASUS TF300 上。

当我通过各种方法将应用程序置于全屏模式时，它看起来很棒，除了按钮的底部栏没有隐藏，而是在按钮通常出现的位置显示为带有“隐形”点的黑条。我需要完全隐藏此栏，以免用户无意中导航到主页或其他 Android 视图。

我无法解决这个问题，因为我不确定 - 是否可以在 ICS 中隐藏这个底栏？如果是这样，是否有已知的方法可以在 AIR 中实现这一目标？

非常感谢您的任何建议。

相关 - ICS 中这个底部按钮栏的正式名称是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-13T13:32:36.003

我遇到了同样的问题，我不得不在用于电视的 Android 棒的数字标牌应用程序中隐藏系统栏。我使用了名为[Application的](http://distriqt.com/native-extensions#application)[distriqt 本机扩展](http://distriqt.com/)。

然后就像在 ApplicationDisplayModes 类中使用 UI_NAVIGATION_HIDE 以及在我的 init 函数中使用 FULLSCREEN 一样简单。

正如您所知，这是一个付费扩展，但值得购买该软件包，因为您可以获得许多其他好东西。我不确定从哪里开始构建我自己的 ANE，所以我选择了 distinqt。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-30T02:50:20.287

是的，这应该是可能的。在把我的头撞到墙上几天之后，我在一个运行 ICS 的便宜的中国 android 棒上工作。要点是您需要创建一个运行以下 Java 行的 Adob​​e Native Extension：

```
Window window = context.getActivity().getWindow();
window.setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN); 
```

当然，您需要大约十几个样板文件来运行这些行。这是一个关于构建原生扩展的好[教程](http://www.adobe.com/devnet/air/articles/building-ane-ios-android-pt1.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:41:15.443

名称是系统栏。

[http://developer.android.com/design/get-started/ui-overview.html](http://developer.android.com/design/get-started/ui-overview.html)

除非您使用的是有根设备，否则您无法真正删除它们，因为它们是用户导航控件。

看到这个 SO 问题： [Is there a way to hide the system/navigation bar in Android ICS](https://stackoverflow.com/questions/9926767/is-there-a-way-to-hide-the-system-navigation-bar-in-android-ics)

# ios - 如何将自定义 TabBarItem 添加到选项卡栏控制器

> ID：10524790
> 
> 赞同：0
> 
> 时间：2012-05-09T22:09:25.303
> 
> 标签：ios, xcode, storyboard, xcode-storyboard

我正在使用 XCode 中的 Storyboard 来设计我的视图。我也在`Tab Bar Controller`编辑器中使用 ，但我似乎无法弄清楚如何添加可以用于的自定义项目`UIPopoverController`。

有可能还是我必须以编程方式创建这个控制器并添加它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T00:50:42.413

苹果文档声明您不应该继承 UITabBarController，但是，您可以使用自定义实现，如此处找到的实现之一：

[http://cocoacontrols.com/platforms/ios/controls/altabbarcontroller](http://cocoacontrols.com/platforms/ios/controls/altabbarcontroller)

[http://cocoacontrols.com/platforms/ios/controls/center-button-in-tab-bar](http://cocoacontrols.com/platforms/ios/controls/center-button-in-tab-bar)

编辑：这个网站似乎有你想要的 - [http://idevrecipes.com/2010/12/16/raised-center-tab-bar-button/](http://idevrecipes.com/2010/12/16/raised-center-tab-bar-button/)

# c# - Neo4JClient：如何找到给定节点的关系列表（任何类型）？

> ID：10524793
> 
> 赞同：0
> 
> 时间：2012-05-09T22:09:42.043
> 
> 标签：c#, neo4j, neo4jclient

我知道如何获取相关节点，并指定关系以找到这些节点，但似乎没有任何机制可以自己找到关系？

查看 Neo4JClient 的源代码，您可以找到“Relationship”类型，但它仅在创建关系时使用，而不是在检索它们时使用。

检索时，您可以获得“RelationshipInstance”，但它由一个RelationshipReference 和两个NodeReferences 组成。除了与每个关联的唯一整数ID 之外，它们都没有与它们关联的任何数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T23:43:06.827

听起来您想要访问存储在关系中的数据。我们将这些称为“有效载荷”。

您可以像这样查询它们：

```
client
    .RootNode
    .OutE<FooPayload>()
    .Select(p =>
    {
        p.Reference.Id,         // Relationship ID
        p.StartNodeReference,   // Outbound vertex
        p.EndNodeReference,     // Inbound vertex
        p.Data,                 // Payload as FooPayload
        p.Data.Bar              // A property in the payload
    }); 
```

更有可能的是，您希望使用按类型过滤关系的 OutE 重载，例如：

```
client
    .RootNode
    .OutE<FooPayload>("HAS_FOO") 
```

如果你在没有泛型类型参数的情况下使用 OutE 的重载，你将获得引用但没有负载数据（因为我们不知道将数据反序列化成什么）。

HTH。

——泰坦

# django - 防止 Django 的 list_editable 与多个用户发生编辑冲突

> ID：10524794
> 
> 赞同：0
> 
> 时间：2012-05-09T22:09:44.213
> 
> 标签：django, listview, django-admin

我想使用 Django 的 list_editable 功能让我的网站管理员一次快速更新一大堆项目，甚至只是快速更新单个项目。但是，此站点上有多个管理员。

我主要关心的是：如果一个管理员编辑记录 A (B, C) 而另一个管理员在同一页面上从不同的计算机编辑记录 D (E, F) 会发生什么？是在每个用户点击“保存”时提交了所有可见记录的信息，还是只提交了修改后的记录？换句话说，第二个提交者是否会覆盖第一个提交者的数据，即使他们正在编辑不同的记录？

问题不大，但我可以忍受：如果两个用户都编辑相同的记录会发生什么？我假设第二次提交将覆盖第一次，即使 Django 有一些东西可以解决我的主要问题，但是如果 Django 也能以某种方式防止这里的错误，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T06:58:40.567

Django 没有内部防碰撞系统。但是您可以使用[django-reversion](https://github.com/etianen/django-reversion)或破解管理员的[get_changelist_forms](https://github.com/django/django/blob/master/django/contrib/admin/options.py#L492)并[保存表单](https://github.com/django/django/blob/master/django/contrib/admin/options.py#L1188)以手​​动合并不同用户的更改（例如，如果对象不同，则将表单验证更改为失败）。

# c# - 实体框架/LINQ 错误：列前缀“Project1”与查询中使用的表名或别名不匹配

> ID：10524795
> 
> 赞同：3
> 
> 时间：2012-05-09T22:09:48.527
> 
> 标签：c#, linq, entity-framework, sap-ase

我有以下 LINQ 查询：

```
var queryEvents = (from p in db.cl_contact_event
                   where p.time_of_contact >= beginDate && p.time_of_contact < endDate
                   group p by p.contact_list_name into g
                   select new PenRawModel
                   {
                        listName           = g.Key,
                        download           = g.Max(a => a.total_number_of_records),
                        dials              = g.Where(a => a.ov_dial_start_time != null).Count(), //This fails.
                        //dials              = g.Sum(a => a.ov_dial_start_time != null ? 1 : 0), //This works.
                        agentConnects      = g.Sum(a => a.ov_trunk_released_time != null ? 1 : 0),
                        abandons           = g.Sum(a => a.response_status == "DAC" || a.response_status == "DAD" ? 1 : 0),
                        rightPartyContacts = g.Sum(a => a.response_status == "PTP" || a.response_status == "RPC" ? 1 : 0),
                        promiseToPays      = g.Sum(a => a.response_status == "PTP" ? 1 : 0),
                        talkTime           = g.Sum(a => EntityFunctions.DiffSeconds(a.ov_call_connected_time, a.ov_trunk_released_time)) ?? 0,
                        wrapTime           = g.Sum(a => EntityFunctions.DiffSeconds(a.ov_trunk_released_time, a.record_released_time)) ?? 0
                   } 
```

运行时它给了我错误：

> “列前缀 'Project1' 与查询中使用的表名或别名不匹配。该表未在 FROM 子句中指定，或者它具有必须使用的相关名称。”

失败的原因是：

```
dials = g.Where(a => a.ov_dial_start_time != null).Count(), 
```

如果我用下面注释掉的那一行代码替换那行代码，那么查询就可以正常工作。我更喜欢使用 .Where/.Count ，因为其他人更容易破译和理解代码的意图。

任何人都可以帮助我了解为什么会失败以及如何解决它吗？

**编辑 -**这是从失败的查询发送到**Sybase 数据库的 SQL：**

```
SELECT 
1 AS [C1], 
[Project2].[contact_list_name] AS [contact_list_name], 
[Project2].[C1] AS [C2], 
[Project2].[C10] AS [C3], 
[Project2].[C2] AS [C4], 
[Project2].[C3] AS [C5], 
[Project2].[C4] AS [C6], 
[Project2].[C5] AS [C7], 
CASE WHEN ([Project2].[C6] IS NULL) THEN 0 ELSE [Project2].[C7] END AS [C8], 
CASE WHEN ([Project2].[C8] IS NULL) THEN 0 ELSE [Project2].[C9] END AS [C9]
FROM ( SELECT 
    [Project1].[C1] AS [C1], 
    [Project1].[C2] AS [C2], 
    [Project1].[C3] AS [C3], 
    [Project1].[C4] AS [C4], 
    [Project1].[C5] AS [C5], 
    [Project1].[C6] AS [C6], 
    [Project1].[C7] AS [C7], 
    [Project1].[C8] AS [C8], 
    [Project1].[C9] AS [C9], 
    [Project1].[contact_list_name] AS [contact_list_name], 
    (SELECT 
        Count([Filter2].[A1]) AS [A1]
        FROM ( SELECT 
            1 AS [A1]
            FROM [mel].[cl_contact_event] AS [Extent2]
            WHERE ((([Extent2].[time_of_contact] >= @p__linq__0) AND ([Extent2].[time_of_contact] < @p__linq__1)) AND (([Project1].[contact_list_name] = [Extent2].[contact_list_name]) OR (([Project1].[contact_list_name] IS NULL) AND ([Extent2].[contact_list_name] IS NULL)))) AND ([Extent2].[ov_dial_start_time] IS NOT NULL)
        )  AS [Filter2]) AS [C10]
    FROM ( SELECT 
        [GroupBy1].[A1] AS [C1], 
        [GroupBy1].[A2] AS [C2], 
        [GroupBy1].[A3] AS [C3], 
        [GroupBy1].[A4] AS [C4], 
        [GroupBy1].[A5] AS [C5], 
        [GroupBy1].[A6] AS [C6], 
        [GroupBy1].[A7] AS [C7], 
        [GroupBy1].[A8] AS [C8], 
        [GroupBy1].[A9] AS [C9], 
        [GroupBy1].[K1] AS [contact_list_name]
        FROM ( SELECT 
            [Filter1].[K1] AS [K1], 
            Max([Filter1].[A1]) AS [A1], 
            Sum([Filter1].[A2]) AS [A2], 
            Sum([Filter1].[A3]) AS [A3], 
            Sum([Filter1].[A4]) AS [A4], 
            Sum([Filter1].[A5]) AS [A5], 
            Sum([Filter1].[A6]) AS [A6], 
            Sum([Filter1].[A7]) AS [A7], 
            Sum([Filter1].[A8]) AS [A8], 
            Sum([Filter1].[A9]) AS [A9]
            FROM ( SELECT 
                [Extent1].[contact_list_name] AS [K1], 
                [Extent1].[total_number_of_records] AS [A1], 
                CASE WHEN ([Extent1].[ov_trunk_released_time] IS NOT NULL) THEN 1 ELSE 0 END AS [A2], 
                CASE WHEN ((N'DAC' = [Extent1].[response_status]) OR (N'DAD' = [Extent1].[response_status])) THEN 1 ELSE 0 END AS [A3], 
                CASE WHEN ((N'PTP' = [Extent1].[response_status]) OR (N'RPC' = [Extent1].[response_status])) THEN 1 ELSE 0 END AS [A4], 
                CASE WHEN (N'PTP' = [Extent1].[response_status]) THEN 1 ELSE 0 END AS [A5], 
                DATEDIFF (second, [Extent1].[ov_call_connected_time], [Extent1].[ov_trunk_released_time]) AS [A6], 
                DATEDIFF (second, [Extent1].[ov_call_connected_time], [Extent1].[ov_trunk_released_time]) AS [A7], 
                DATEDIFF (second, [Extent1].[ov_trunk_released_time], [Extent1].[record_released_time]) AS [A8], 
                DATEDIFF (second, [Extent1].[ov_trunk_released_time], [Extent1].[record_released_time]) AS [A9]
                FROM [mel].[cl_contact_event] AS [Extent1]
                WHERE ([Extent1].[time_of_contact] >= @p__linq__0) AND ([Extent1].[time_of_contact] < @p__linq__1)
            )  AS [Filter1]
            GROUP BY [K1]
        )  AS [GroupBy1]
    )  AS [Project1]
)  AS [Project2] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T22:58:39.473

**完全编辑的答案**

问题最终在于 Sybex ASE 提供程序从 LINQ 到 SQL 的转换：

*   实体框架 4.1（不应该影响错误）
*   SDK 15.7 SED #02 的 Sybex ASE 驱动程序（对故障负责）

应该使用任何 LINQ sintax 很好地呈现查询。他们可以产生不同的查询，但他们都应该工作。但是，此提供程序无法正确处理某些可能的 sintax。

很高兴知道：

```
dials = g.Where(a => a.ov_dial_start_time != null).Count(), // fails.
dials = g.Count(a => a.ov_dial_start_time != null), // also fails.
dials = g.Sum(a => a.ov_dial_start_time != null ? 1 : 0), // works. 
```

根据 OP，在过滤器`AsEnumerable()`之前添加`Where()`也可以使其工作。

如果您发现此数据库和提供程序出现故障，最好检查将发送到服务器的查询以找到有问题的部分并尝试替代 sintax，直到问题得到解决。您可以使用 来检查将发送到服务器的查询`toString()`。然后你可以检查sintax，或者直接在服务器中运行它，看看是什么失败了。

# python - 使用基递归提取数字

> ID：10524803
> 
> 赞同：0
> 
> 时间：2012-05-09T22:10:29.920
> 
> 标签：python, recursion

这里需要家庭作业帮助。我真的很难理解递归及其工作方式。

问题是，编写一个递归函数 dec2base(n,b)，它返回正整数 n 中以 b 为基数的列表

示例：

```
dec2base(120, 10) => [1,2,0] (1*10*2 + 2/10**1 + 0*10**0) 
```

我知道应该有一个停止案例，但我想不出它可能是什么。

所以目前，我所有的代码看起来都是：

```
def dec2base(n, b):
    if 
```

就是这样。任何指导都会很棒。谢谢！

编辑：厌倦了这样的代码：

```
def dec2base(n, b):
    if n < 10:
        return [n]
    else:
        return getdigits(n/b) + [n%b] 
```

但这并没有让我感到不安......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:15:46.710

要了解递归，首先必须了解递归。你自己说了停止的情况，当然是到达的时候`base**0`

编辑：@你的编辑：你几乎明白了，不要放弃。dec2base 需要多少个参数？思考！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:27:53.593

这项任务的关键要素是理解（或设计） [霍纳的方法](http://en.wikipedia.org/wiki/Horner%27s_method)。我们可以按照您的方式写数字：

1234 = 1*10 ³ + 2*10 ² + 3*10 ¹ + 4*10 ⁰

但经过一番思考，我们提出了这个表示：

1234 = 123*10 + 4 = (12*10 + 3)*10 + 4 = ((1*10 + 2)*10 + 3)*10 + 4

我希望你能更清楚地看到递归。在每个步骤中，检查数字是否可以除以 10。如果可以，余数是下一个数字，商可以递归处理。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-05-26T06:30:55.683

```
def dec2base(n,b):
    if n < b:
        return [n]
    else:
        return dec2base(n//b, b) + [n%b] 
```

# mysql - 为什么我的 SQL 语句会引发语法错误？

> ID：10524808
> 
> 赞同：2
> 
> 时间：2012-05-09T22:11:07.597
> 
> 标签：mysql, sql

我试图创建一个像这样的表：

```
CREATE TABLE Persons
(
id int PRIMARY KEY AUTOINCREMENT,
metalId varchar(255),
colorId varchar(255)
) 
```

但它得到一个错误：

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 3 行的 'AUTOINCREMENT, metalId varchar(255), colorId varchar(255) )' 附近使用正确的语法

有人知道我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T22:12:36.910

你漏掉了一个下划线。`AUTOINCREMENT`应该是`AUTO_INCREMENT`。

*   [使用 AUTO_INCREMENT](http://dev.mysql.com/doc/refman/5.6/en/example-auto-increment.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-09T22:15:38.610

尝试

```
CREATE TABLE Persons
(
id int PRIMARY KEY AUTO_INCREMENT,
metalId varchar(255),
colorId varchar(255)
) 
```

[这里是主要来源。](http://www.w3schools.com/sql/sql_autoincrement.asp)

> MySQL 的语法
> 
> 以下 SQL 语句将“P_Id”列定义为“Persons”表中的自增主键字段：

```
CREATE TABLE Persons
(
P_Id int NOT NULL AUTO_INCREMENT,
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255),
PRIMARY KEY (P_Id)
) 
```

> MySQL 使用 AUTO_INCREMENT 关键字来执行自动增量功能。
> 
> 默认情况下，AUTO_INCREMENT 的起始值为 1，每增加一条新记录，它就会增加 1。
> 
> 要让 AUTO_INCREMENT 序列从另一个值开始，请使用以下 SQL 语句： ALTER TABLE Persons AUTO_INCREMENT=100

# java - 后台全屏视频查看

> ID：10524809
> 
> 赞同：1
> 
> 时间：2012-05-09T22:11:12.553
> 
> 标签：java, android, android-video-player

我有一个 ImageView 在后台全屏显示图像。这是以这种方式完成的。

```
public void handleImage(String imageLocation) {
    LinearLayout layout = (LinearLayout) findViewById(R.id.mediaView);
    ImageView image = new ImageView(this);

    layout.addView(image);

    Uri imageLocUri = Uri.parse(imageLocation);
    image.setImageURI(imageLocUri);
    image.setScaleType(ImageView.ScaleType.FIT_XY);
} 
```

现在我需要对视频做同样的事情，但 VideoView 没有 .setScaleType()。

视频需要点击即可播放，我将在视频顶部显示按钮和内容。

有任何想法吗？

# android - 在设备中安装 android 应用程序

> ID：10524813
> 
> 赞同：-1
> 
> 时间：2012-05-09T22:11:31.487
> 
> 标签：android

我完成了我的应用程序，它在 eclipse 模拟器中运行良好，但它也无法安装在我的设备和我朋友的设备中。我从我的下拉框中打开了 apk 文件，然后当 apk 上传完成时，我找不到我的应用程序的徽标，运行按钮不可见，无法单击它并且完成按钮可见，我可以在我的设置中看到我的应用程序> 应用程序> 管理应用程序> 下载.. 但只能卸载它并且在我的应用程序页面中看不到。整个应用程序没有安装，但我每个朋友的分段代码已正确安装并在设备上运行。？我的应用程序大小为 29 MB

> 1- [2012-05-10 00:26:05 - aya] Android 发布！
> 
> 2- [2012-05-10 00:26:05 - aya] adb 运行正常。
> 
> 3- [2012-05-10 00:26:05 - aya] 未找到启动器活动！
> 
> 4- [2012-05-10 00:26:05 - aya] 启动只会同步设备上的应用程序包！
> 
> 5- [2012-05-10 00:26:05 - aya] 执行同步
> 
> 6- [2012-05-10 00:26:05 - aya] 自动目标模式：使用设备“37C708442409657”
> 
> 7- [2012-05-10 00:26:05 - aya] 将 aya.apk 上传到设备“37C708442409657”
> 
> 8- [2012-05-10 00:26:29 - aya] 安装 aya.apk...
> 
> 9- [2012-05-10 00:26:44 - aya] 成功！
> 
> 10- [2012-05-10 00:26:44 - aya] \aya\bin\aya.apk 安装在设备上
> 
> 11- [2012-05-10 00:26:44 - aya] 完成！`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T22:24:58.023

从日志的第 3 行（3- [2012-05-10 00:26:05 - aya] 未找到启动器活动！）在我看来，您在应用的 AndroidManifest.xml 中缺少以下活动声明

```
<activity android:name=".Main Activity Class Name Goes Here">
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
</activity> 
```

您可能需要阅读[Android 应用程序基础知识](http://developer.android.com/guide/topics/fundamentals.html)以获取更多信息。

此外，如果您没有使用非调试密钥签署您的 apk 或者您从非市场位置分发它，您可能必须在您的设备上启用“允许虚假位置”设置，但这是另一个故事......

希望这可以帮助...

# android - 如何在 Android 中使用来自 java 的 OpenGL ES 2.0 扩展？

> ID：10524817
> 
> 赞同：0
> 
> 时间：2012-05-09T22:11:39.640
> 
> 标签：android

我正在尝试使用 PVRTC 扩展在我的游戏中加载压缩纹理。我知道许多设备都支持此扩展，但我找不到的是如何查询它并在我的应用程序中使用它。我看到 OpenGL ES 1.0 和 1.1 都有 Ext 类，但我找不到 OpenGL ES 2.0。关于如何从 Java 加载压缩的 PVR 纹理的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T06:02:45.573

ICS 源代码在各个地方都包含来自 Khronos 的 ES 2 扩展头文件，其中一个是`ICS/frameworks/base/opengl/include/GLES2`. 也许可以为这些函数创建一个小的 JNI 绑定。

# java - Java 中的 for (;;) 是什么意思？

> ID：10524821
> 
> 赞同：1
> 
> 时间：2012-05-09T22:11:56.677
> 
> 标签：java

> **可能重复：**
> [Java 中的 for (;;) 是什么意思？](https://stackoverflow.com/questions/7081339/what-does-for-mean-in-java)

我正在阅读一些 Java API 文档，我遇到了这个看起来非常奇怪的循环，这让我很高兴来到这里询问它是关于什么的。会很高兴尽快找到它。感谢您即将做出的努力。

```
 public int read() throws IOException {
       synchronized (lock) {
          ensureOpen();
           **for (;;)** {
               if (nextChar >= nChars) {
                  fill();
                  if (nextChar >= nChars)
                       return -1;
               }
              if (skipLF) {
                     skipLF = false;
                  if (cb[nextChar] == '\n') {
                     nextChar++;
                      continue;
                   }
               }
             return cb[nextChar++];
          }
       }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T22:13:14.660

> 为了（;;）

那是一个无限循环。

例如，它相当于类似

> 而（真）

[自然，要退出这样的循环，需要使用分支语句。](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html)

编辑：显然使用“无限”这个词是一个糟糕的选择。尽管如此，出于所有意图和目的，`for(;;)`循环不会使用与典型`for`循环相同的条件机制来终止。我相信这是问题的重点。评论在这一点上只是分裂的头发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T22:18:15.063

```
for(;;) 
```

这是一个无限循环，没有变量初始化，没有要检查的条件，没有增量步骤……只有在条件内执行“返回”语句时才退出循环。

常见的for循环：

```
for(int i = 0 ; i < max ; i++) 
```

希望有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T22:17:56.767

这意味着循环终止的条件没有以通常的形式表示。

终止循环的唯一方法是两条`return`语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T22:18:01.150

正如@Tom 所说，这是一个无限循环。如果您想永远执行某些操作，则可以在您的程序中使用它。

# security - 我应该只通过IP地址限制兑换优惠券还是不可靠？

> ID：10524824
> 
> 赞同：0
> 
> 时间：2012-05-09T22:12:04.657
> 
> 标签：security, ip

我的网站允许所有用户兑换优惠券。但是，该网站的会员资格是免费的。我如何构建我的兑换系统以最好地阻止人们创建许多免费帐户来兑换许多优惠券？

我正在考虑每周只允许每个 ip 兑换一次。这可靠吗？最可靠的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:15:11.317

使用 IP 通常不是很好，因为取决于客户 ISP，它可能不是个别客户独有的。您最好查看[用于跟踪的 cookie](http://en.wikipedia.org/wiki/HTTP_cookie#Tracking)（并在一周后使它们过期）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T11:25:49.257

可怕的想法。放弃。

这里只是几个原因：

*   在同一个办公室工作的每个人都可能共享一个 IP。
*   住在同一所房子里的每个人都可能共享一个 IP。
*   在路上的星巴克通过 wifi 上网的每个人都可能共享一个 IP。
*   路由器设置为使用 DHCP 的家庭网络每次被退回时都会获得不同的 IP 地址。
*   手机网络上的用户很可能会通过代理服务器池进行路由，即使在同一会话期间也可以拥有不同的 IP。

# javascript - 如何正确地将嵌入的 ruby 代码放入 JavaScript？

> ID：10524827
> 
> 赞同：3
> 
> 时间：2012-05-09T22:12:23.057
> 
> 标签：javascript, ruby-on-rails, ruby, json, sinatra

我正在尝试在 JavaScript 中嵌入 Ruby 代码的输出：

```
var stuff= "<% Representative.get('http://0.0.0.0:4568/') %>"; 
```

嵌入部分自行工作，显示如下结果：

```
{ "name":"John Johnson", "street":"Oslo West 555", "age":33, "phone":"555 1234567"} 
```

上面的行是 EXACT PAGE SOURCE；它虽然在本地运行，所以我无法向您显示该页面。

在变量中时，我尝试将其发送到我的应用程序：

```
document.getElementById("X_Axis").value=stuff.name; 
```

通过输入：

```
<input type="text" id="X_Axis" /> 
```

`undefined`我每次都得到一个值。

我尝试在 JavaScript 中对值进行硬编码，它工作得很好，当嵌入式 Ruby 被放入 JavaScript 变量时，它总是给我这个`undefined`值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T22:19:18.207

您不应该在 ERB 代码周围加上引号，否则它会将结果放在字符串中，而不是将其`stuff`作为哈希/JSON 对象分配。删除它们，它应该可以工作。（另外，`<%`应该是`<%=`）。

```
var stuff = <%= Representative.get('http://0.0.0.0:4568/') %>; 
```

# ruby-on-rails - 将带有 &-hash-char-semicolon 字符的 Ruby 字符串转换为 ascii 或 html 友好字符串

> ID：10524830
> 
> 赞同：4
> 
> 时间：2012-05-09T22:12:41.170
> 
> 标签：ruby-on-rails, ruby, html-entities, html-safe

使用 Rails 3 我正在使用在 drupal 或其他东西中生成的 XML 提要。它给我的标签看起来像：

```
<body><![CDATA[&#60;p&#62;This is a title&#60;br /&#62;A subheading&#60;/p&#62;]]></body> 
```

所以意图是这应该看起来像：

```
<p>This is a title<br />A subheading</p> 
```

然后可以使用`<%= @mystring.html_safe %>`or`<%= raw @mystring %>`或其他东西在视图中呈现。问题在于以这种方式呈现字符串只会将子字符串`&#60;`转换为`<`字符。我需要一种双重原始或双重未编码来首先处理 chr，*然后*将标签呈现为 html 安全。

任何人都知道这样的事情：

```
<%= @my_double_safed_string.html_safe.html_safe %> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T22:52:01.110

我不认为这是有效的 XML - 他们通过使用实体*和*cdata 以两种不同的方式对文本进行了两次转义。不过，您可以使用 nokogiri 解析它，例如：

```
require 'nokogiri'

xml = Nokogiri::XML.parse "<body><![CDATA[&#60;p&#62;This is a title&#60;br /&#62;A subheading&#60;/p&#62;]]></body>"
text = Nokogiri::XML.parse("<e>#{xml.text}</e>").text
#=> text = "<p>This is a title<br />A subheading</p>" 
```

看到这个 drupal 站点正在喷出疯狂的双重转义 xml，我什至倾向于使用正则表达式。解决问题的黑客创建的黑客？身份证。不管：

```
xml.text
#=> "&#60;p&#62;This is a title&#60;br /&#62;A subheading&#60;/p&#62;"
xml.text.gsub(/\&\#([0-9]+);/) { |i| $1.to_i.chr }
#=> "<p>This is a title<br />A subheading</p>" 
```

希望这可以帮助！

# java - 棋盘不移动

> ID：10524831
> 
> 赞同：0
> 
> 时间：2012-05-09T22:12:41.927
> 
> 标签：java, swing, jbutton

我正在尝试将按钮移动到另一个地方，我使用了以下代码：

```
public void actionPerformed(ActionEvent e)
{
    for(int i = 0; i<=29; i++)
    {
        if(e.getSource() == gB[i])
        {
            System.out.println(i);
        }
    }
} 
```

这是画板

```
public void drawBoard()
{
    JPanel gboard = new JPanel();

    for(int i = 0; i < 30; i++)
    {
        gboard.add(gB[i]);
        gB[i].setText(Integer.toString(gB[i].getPieceValue()));

    } 
```

我认为这是错误的。有人知道吗？我无法让球员移动到下一个位置。

谢谢

错误是：（**全部为红色**）

```
 Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
at Controller.actionPerformed(Controller.java:22)
at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:2018)
at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2341)
at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:402)
at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:259) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:44:23.897

```
public void actionPerformed(ActionEvent e)
{
    for(int i = 0; i<=29; i++)
    {
        if(e.getSource() == gB[i])
        {
            System.out.println(i);
        }
    }
} 
```

只有几个名称可以保存一个值。命名为“ `ActionEvent`e”和名为“gB”的数组是唯一可以设置为 null 的名称。

这意味着要么你在没有定义源的情况下抛出了一个自定义 ActionEvent，要么你没有初始化数组 gB。

如果你想让你的棋子移动，除了在动作处理程序中打印“i”的值之外，它可能还有助于做更多的事情；但是，我猜你的努力还没有那么远。

# android - Toast 消息后开始活动

> ID：10524836
> 
> 赞同：1
> 
> 时间：2012-05-09T22:13:08.707
> 
> 标签：android, android-intent, toast

当我的活动没有从数据库中获取数据时，我会显示一条 Toast 消息来说明这一点。然后我为之前的活动充电，但这次充电非常快，并且 Toast 消息仍然存在几秒钟。我想要这个消息持续时间，但我不知道如何延迟我想在消息之后启动的活动的初始化。

```
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);     
setContentView(R.layout.aeiou);

...

if(!oArrayList.isEmpty()){

    ...

}else{          
    Toast.makeText(this.getApplicationContext(), "NO hay datos", Toast.LENGTH_LONG).show();     

    Intent intent = new Intent(this, PreviousActivity.class);
    startActivity(intent);   
} 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T21:12:38.557

在“else”中，我添加了一个线程，该线程在显示 Toast 消息并启动下一个 Activity 时休眠。

```
...}else{           
        Toast.makeText(this.getApplicationContext(), "NO hay datos", Toast.LENGTH_LONG).show();             

        final Intent intent = new Intent(this, OtherActivity.class);        

        Thread thread = new Thread(){
           @Override
           public void run() {
                try {
                   Thread.sleep(3500); // As I am using LENGTH_LONG in Toast
                   startActivity(intent);   
               } catch (Exception e) {
                   e.printStackTrace();
               }
           } 
        };

        thread.start();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-09T23:08:38.753

据我所知，吐司的持续时间只能设置为两个值（长和短）之一，两者都可以由用户定义。

为了设置自己的时间并在结束时收到通知，您需要创建自己的机制而不是内置的 toast ...

尝试使用对话框（可能是progressDialog）或创建一个位于所有其他对话框之上的视图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T00:38:31.800

```
Toast.makeText(this, "your message", Toast.LENGTH_LONG).show();  

(new Handler())
    .postDelayed(
    new Runnable() {
    public void run() {
    // launch your activity here
    }
    }, timeInMillisecondTheToastIsShowingFor); 
```

这将延迟启动活动，无论您想要多长时间

# php - 获得价值

> ID：10524838
> 
> 赞同：4
> 
> 时间：2012-05-09T22:13:22.573
> 
> 标签：php

我有一个 HTTP (craigslist) 链接的 var `$link`，并将内容放入`$linkhtml`. 在这个 var 中是 craigslist 页面的 HTML 代码，`$link`.

我需要提取 和 之间的`<h2>`文本`</h2>`。我可以使用正则表达式，但是如何使用 PHP DOM 做到这一点？到目前为止我有这个：

```
$linkhtml= file_get_contents($link);
$dom = new DOMDocument;
@$dom->loadHTML($linkhtml); 
```

接下来我该怎么做才能将元素的内容`<h2>`放入 var中`$title`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T22:21:52.967

如果`DOMDocument`您看起来很难理解/使用，那么您可以尝试[PHP Simple HTML DOM Parser](http://simplehtmldom.sourceforge.net/)，它提供了最简单的 html 解析方法。

```
require 'simple_html_dom.php';
$html = '<h1>Header 1</h1><h2>Header 2</h2>';
$dom = new simple_html_dom();
$dom->load( $html );
$title = $dom->find('h2',0)->plaintext; 
echo $title; // outputs: Header 2 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T22:20:36.353

您可以使用以下代码：

```
$linkhtml= file_get_contents($link);

$doc = new DOMDocument();
libxml_use_internal_errors(true);
$doc->loadHTML($linkhtml); // loads your html
$xpath = new DOMXPath($doc);
$h2text = $xpath->evaluate("string(//h2/text())");
// $h2text is your text between <h2> and </h2> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T22:16:13.143

您可以使用 XPath 执行此操作：*未经测试，可能包含错误*

```
$linkhtml= file_get_contents($link);
$dom = new DOMDocument;
@$dom->loadHTML($linkhtml);

$xpath = new DOMXpath($dom);

$elements = $xpath->query("/html/body/h2");

if (!is_null($elements)) {
    foreach ($elements as $element) {
        $nodes = $element->childNodes;
        foreach ($nodes as $node) {
            echo $node->nodeValue. "\n";
        }
    }
} 
```

# perl - 在 @INC 中找不到 LWP/Simple.pm

> ID：10524840
> 
> 赞同：23
> 
> 时间：2012-05-09T22:13:48.563
> 
> 标签：perl

> **可能重复：**
> [安装缺少的 Perl 模块的最简单方法是什么？](https://stackoverflow.com/questions/65865/whats-the-easiest-way-to-install-a-missing-perl-module)

我正在尝试运行[Perl 脚本](http://code.google.com/p/scxml2dot/source/browse/trunk/scxml2dot.pl)将 SCXML 转换为 Graphviz DOT。我将脚本的第一行修改为：

```
#!/usr/bin/env perl 
```

和`chmod +x`文件。当我通过运行它时，`./scmxl2dot.pl`我看到以下错误输出：

> 在 @INC 中找不到 LWP/Simple.pm（@INC 包含：/opt/local/lib/perl5/site_perl/5.12.3/darwin-multi-2level /opt/local/lib/perl5/site_perl/5.12\. 3 /opt/local/lib/perl5/vendor_perl/5.12.3/darwin-multi-2level /opt/local/lib/perl5/vendor_perl/5.12.3 /opt/local/lib/perl5/5.12.3/darwin- multi-2level /opt/local/lib/perl5/5.12.3 /opt/local/lib/perl5/site_perl /opt/local/lib/perl5/vendor_perl .) at ./scmxml2dot.pl line 14\.
> BEGIN failed--编译在 ./scmxml2dot.pl 第 14 行中止。

该文件的第 14 行是`use LWP::Simple;`

我如何：

1.  看看我是否安装了这个东西（模块？），和/或
2.  获取 LWP::Simple 并使其可用于脚本？

*这是在 OS X 10.7.3 和 Perl 5.12.3 下运行的（如错误所示）。*

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-09T22:23:05.850

1.  你已经确定你没有它（在某个地方可以找到它）。

2.  `perl -MCPAN -e'install "LWP::Simple"'`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-09T22:22:30.287

1.  从命令行执行以下命令：

    ```
    perl -MLWP::Simple -e 1 
    ```

    如果您没有从上述命令中获得任何输出，则说明该模块已安装；如果出现错误，则说明未安装

2.  安装使用

    ```
    perl -MCPAN -e'install "LWP::Simple"' 
    ```

当 perl 遇到 use My::Module 时，它​​会遍历包含目录名称的内置 @INC 模块的元素。在每个目录中，它检查是否有一个名为“My”的子目录，以及在该子目录中是否有一个名为“Module.pm”的文件。

检查系统上 LWP::Simple 模块的安装位置，然后在代码的 use LWP::Simple 语句上方键入以下行。

```
 use lib '/usr/local/module';
    use LWP::Simple; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-09T22:39:26.170

看看[Perldoc](http://perldoc.perl.com)网页。这将告诉您哪些模块是标准 Perl 模块，哪些不是。

您还可以使用[perldoc](http://www.manpagez.com/man/1/perldoc/)命令来查明是否安装了 Perl 模块，如果安装了，请查看其文档。

```
$ perldoc LWP::Simple 
```

（如果 Perldoc 不作为命令执行 do `ls -l /usr/bin/perl*`。在 Mac 上，某些 Perl 命令没有打开执行位。要打开它， do `sudo chmod a+x /usr/bin/perl`）。

它只是碰巧`LWP::Simple`不是标准的 Perl 模块，如果你没有它，你将不得不安装它。大多数人已经告诉过你`cpan`。不幸的是，默认情况下，Mac 没有安装所需的命令行开发工具。[您必须安装它们](http://www.mkyong.com/mac/how-to-install-gcc-compiler-on-mac-os-x/)。

安装后，您可以使用`cpan`命令安装 LWP::Simple：

```
$ sudo cpan   #Run cpan and configure it. It takes about 3 minutes
cpan> install LWP::Simple
cpan> exit 
```

# python - C 程序作为 Python 子进程更快

> ID：10524842
> 
> 赞同：11
> 
> 时间：2012-05-09T22:14:11.090
> 
> 标签：python, c, subprocess, benchmarking

我有一个 C 语言的多线程合并排序程序，以及一个用 0、1、2 或 4 个线程对其进行基准测试的程序。我还用 Python 编写了一个程序来进行多项测试并汇总结果。

奇怪的是，当我运行 Python 时，与直接在 shell 中运行测试相比，测试的运行时间总是大约一半。

例如，当我用 400 万个整数单独运行测试程序时（最后两个参数是用于生成整数的种子和模数）：

```
$ ./mergetest 4000000 4194819 140810581084
0 threads:  1.483485s wall;  1.476092s user;  0.004001s sys
1 threads:  1.489206s wall;  1.488093s user;  0.000000s sys
2 threads:  0.854119s wall;  1.608100s user;  0.008000s sys
4 threads:  0.673286s wall;  2.224139s user;  0.024002s sys 
```

使用python脚本：

```
$ ./mergedata.py 1 4000000
Average runtime for 1 runs with 4000000 items each:
0 threads:   0.677512s wall;   0.664041s user;   0.016001s sys
1 threads:   0.709118s wall;   0.704044s user;   0.004001s sys
2 threads:   0.414058s wall;   0.752047s user;   0.028001s sys
4 threads:   0.373708s wall;    1.24008s user;   0.024002s sys 
```

无论我排序多少次，或者运行多少次，都会发生这种情况。python 程序使用 subprocess 模块调用测试器，然后解析和聚合输出。任何想法为什么会发生这种情况？Python是否以某种方式优化了执行？或者当我直接运行它时是否有一些我不知道的东西减慢它？

代码：[https ://gist.github.com/2650009](https://gist.github.com/2650009)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T01:56:19.590

原来我将 sys.maxint 作为生成随机数的模数传递给子进程。C 正在截断 64 位整数并将其解释为有符号，即二进制补码中的 -1，因此每个随机数都被它修改并变为 0。因此，对所有相同的值进行排序似乎需要大约一半很多时间作为随机数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T00:19:24.983

将其包装在 shell 脚本中可能会产生相同的效果。如果是这样，它的控制台操作

# java - 两次保存 JPA 实体

> ID：10524847
> 
> 赞同：0
> 
> 时间：2012-05-09T22:14:32.493
> 
> 标签：java, jpa, clone

我想保存一个 JPA 实体两次，因为我想存储我的文章的父级和修订版。

当我创建新文章时，我实际上想创建父级和一个与父级重复的修订。就像是：

```
Article parent = new Article();
Article revision = parent.clone();

em.persist(parent);
em.persist(revision); 
```

但实际发生的是，我在第二次调用persist时遇到了异常：

```
org.hibernate.StaleStateException: 
     Batch update returned unexpected row count from update [0]; actual row count: 0; expected: 1 
```

如何克隆文章以免出现此类异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:25:06.027

您的克隆方法是否也复制了@Id（可能还有@Version）？你真的应该给你的副本一个新的ID（或者如果你使用@GeneratedValue，那么未保存的值就会生成一个新值）。

# html - 居中可变长度定价表的内容

> ID：10524849
> 
> 赞同：2
> 
> 时间：2012-05-09T22:14:39.013
> 
> 标签：html, css, twitter-bootstrap

我正在尝试创建一个基本的定价表。

该表可以是可变长度的：在某些情况下只有 1 个计划，在其他情况下可能有 5 个计划。

**我不知道如何将所有计划集中在一个更大的灰色 div 中。**

我正在使用推特引导程序。

这是jsfiddle。注意计划是如何向左浮动而不是在灰色区域的中间居中

[http://jsfiddle.net/vyjru/](http://jsfiddle.net/vyjru/)

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:40:13.080

您可以将它们设置为`display:inline-block`，然后简单地将`.pricing_sequence`容器设置为，而不是将您的定价表项目浮动到左侧`text-align:center;`

[http://jsfiddle.net/vyjru/1/](http://jsfiddle.net/vyjru/1/)

**CSS**

```
.pricing_sequence{
    border:1px solid gainsboro;
    background-color:white;  
    text-align:center;
}

.pricing_sequence ol li{
    list-style:none;
    border-left:1px dashed gainsboro;    
    display:inline-block;
    *display:inline; /* ie7 fix */
    vertical-align:top;
    padding: 10px;
    text-align: center;
    width: 160px;
    overflow: visible;   
} 
```

# xpages - 打开时仅展开视图面板中的某些分类列

> ID：10524850
> 
> 赞同：3
> 
> 时间：2012-05-09T22:14:56.673
> 
> 标签：xpages

我正在使用 ViewPanel 来显示分类视图。此视图有 4 列类别。总共有 3 个附加列。

我想打开这个视图，以便前 3 个分类列被展开，第 4 个被折叠。

是否有某种类型的 SSJS / CSJS 可以添加到可以执行此操作的视图中？

在视图面板的属性中打开视图时，我没有看到展开/折叠列的选项。

我尝试在后端视图上使用折叠选项，但这对 Xpage 端没有影响。我尝试隐藏详细信息行，但它们还是出现了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T14:41:31.663

为此，只需更改数据源的扩展级别：

```
<xp:this.data>
    <xp:dominoView var="view1" viewName="NameOfYourView" expandLevel="4" />
</xp:this.data> 
```

**编辑：**

您甚至可以通过添加一个简单的 URL 参数来控制它：*nameOfXPage.xsp?expandLevel=3*

祝你今天过得愉快

斯文

# php - HTML5 网络存储与 Cookie

> ID：10524851
> 
> 赞同：2
> 
> 时间：2012-05-09T22:15:10.657
> 
> 标签：php, javascript, html, session, cookies

我想向我网站上特定页面的首次访问者显示一条消息。该消息只需要出现一次。

使用 cookie 会很简单，但使用 HTML5 localStorage 有更多好处吗？如果是这样，它将如何实施？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-09T22:18:03.357

根据您的描述，仅使用 cookie 几乎更容易且更不容易出错。并非所有浏览器都具有相同的 HTML localStorage 实现，尤其是 IE 7+8。但是，它们都使用 cookie，并且不会出现跨浏览器兼容性问题。

查看此 SO 以获取更多信息：[本地存储、会话存储、Web 存储、Web 数据库和 HTML5 中的 cookie](https://stackoverflow.com/questions/5398604/local-storage-session-storage-web-storage-web-database-and-cookies-in-html5)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T22:30:20.160

1.  HTML5 localStorage 实现起来会容易得多，它不需要这么多行，而且实现起来非常简单。这是一个示例：[http ://www.w3schools.com/html5/tryit.asp?filename=tryhtml5_webstorage_local_clickcount](http://www.w3schools.com/html5/tryit.asp?filename=tryhtml5_webstorage_local_clickcount)
2.  此处描述的另一个选项是 cookie。Cookie 是一种广泛使用的解决方案，但它需要更多的行来编写 cookie，但正如上面提到的那样，优点是 cookie 在许多旧浏览器中都被使用。这是 cookie 的示例： [http ://www.w3schools.com/js/tryit.asp?filename=tryjs_cookie_username](http://www.w3schools.com/js/tryit.asp?filename=tryjs_cookie_username)

展望未来，考虑到 OP 和浏览器都在发生巨大变化，现在越来越多的浏览器必须支持 HTML5，我会考虑 localStorage

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T22:25:11.267

即兴发挥，我可能会推荐 cookie，但这取决于您的用户使用的浏览器以及您希望如何呈现您的消息。

Cookie 更适合更广泛的受众，因为所有浏览器都支持它们。IE 6 和 7 等较旧的浏览器不支持本地存储。Cookies 也可以在服务器端进行操作。因此，如果您要显示的消息是在服务器端呈现的，那么 cookie 可能是一个更好的选择。

本地存储更容易通过 JavaScript 访问，但使用它并没有太多优势。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-09T22:38:06.873

localstorage 将在用户计算机上保存最多 5 MB 的数据，唯一不好的是存储永远存在，如果您需要过期，则需要这样做，cookie 会自动处理。

使用本地存储的示例：

var 访问 = parseInt(localStorage["numVisits"]);

```
var el = document.getElementById("cookieData");

if (isNaN(visits)) {
    visits = 1;
    el.innerHTML = "Welcome to the site!";
} else {
    visits += 1;
    el.innerHTML = "Welcome back! You've been here " + visits + " times.";
}

localStorage["numVisits"] = visits; 
```

# assembly - 如何检查 x86 程序集中的键状态？

> ID：10524855
> 
> 赞同：7
> 
> 时间：2012-05-09T22:15:35.770
> 
> 标签：assembly, input, keyboard, x86, x86-16

去年 1 月，我将 x86 组装作为一种爱好，因此我可以制作适用于 PCj 和 Tandy 1000 等老式 8086 计算机的游戏，但我发现的书籍并没有确切地教授该特定主题的内容。虽然一些 dos 和 bios 中断可以完成这项工作，但它们远非完美。

我的主要问题是在不停止程序的情况下读取按键的键盘状态。我找到了一些方法，但它们非常有限。INT 21h, AH 0Ch 读取最后按下的键，但以文本版本的方式。它不仅一次只能读取一个键，而且类似记事本的命中检测功能也使得无法知道该键被按住了多长时间。在我的谷歌旅行期间，我还看到了对端口 60h 到 64h 的引用，但仅此而已。实际的解释和工作代码几乎不存在。或者，也许我只是不擅长使用搜索引擎。

我需要知道的是一个键是否被按下。最好的解决方案是拥有所有键盘键的缓冲区/数组并读取其状态；1 表示已关闭，0 表示未关闭。或者只是访问最后一个被击中和释放的键的列表会很好（当然，有一种方法可以清除该缓冲区）。谁能指出我正确的方向？

**编辑：**首先，我应该提到我使用 Borland TASM。现在我编译了你的代码，它运行良好，尽管我几乎羞于承认我不理解其中的一半。我试图让它与 TASM 兼容，但它所做的只是在屏幕上创建垃圾并冻结。

这就是我想出的；

```
.MODEL TINY
.STACK 256

.DATA
kbdbuf DB 128 DUP (0)

msg1 db "Press and hold ESC", 13, 10, "$"
msg2 db "ESC pressed, release ESC", 13, 10, "$"
msg3 db "ESC released", 13, 10, "$"

.CODE
main PROC
    org 0100h
    mov ax, @data
    mov ds, ax

    xor     ax, ax
    mov     es, ax

    cli                         ; update ISR address w/ ints disabled
    push    word [es:9*4+2]     ; preserve ISR address
    push    word [es:9*4]
    lea si, irq1isr
    mov     word [es:9*4], si   ; requires a register
    mov     [es:9*4+2],cs
    sti

        mov     ah, 9
        lea     dx, msg1
        int     021h                ; print "Press and hold ESC"

    test1:
        mov     al, [kbdbuf + 1]    ; check Escape key state (Esc scan code = 1)
        or      al, al
        jz      test1               ; wait until it's nonzero (pressed/held)

        lea     dx, msg2
        int     021h                ; print "ESC pressed, release ESC"

    test2:
        mov     al, [kbdbuf + 1]    ; check Escape key state (Esc scan code = 1)
        or      al, al
        jnz     test2               ; wait until it's zero (released/not pressed)

        lea     dx, msg3            ; print "ESC released"
        int     021h

    cli                         ; update ISR address w/ ints disabled
    pop     word [es:9*4]       ; restore ISR address
    pop     word [es:9*4+2]
    sti

    ret

    irq1isr:
    push    ax bx

    ; read keyboard scan code
    in      al, 060h

    ; update keyboard state
    xor     bh, bh
    mov     bl, al
    and     bl, 07Fh            ; bx = scan code
    shr     al, 7               ; al = 0 if pressed, 1 if released
    xor     al, 1               ; al = 1 if pressed, 0 if released
    mov     [cs:bx+kbdbuf], al

    ; send EOI to XT keyboard
    in      al, 061h
    mov     ah, al
    or      al, 080h
    out     061h, al
    mov     al, ah
    out     061h, al

    ; send EOI to master PIC
    mov     al, 020h
    out     020h, al

    pop     bx ax
    iret
main ENDP

END main 
```

我不确定我是否正确编码了中断。如果我知道端口 060h - 064h 是如何工作的，那就见鬼了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T23:08:36.907

以下是您的操作方法：

```
; compile with NASM: nasm.exe -f bin kbd.asm -o kbd.com

bits 16
org 0x100

    xor     ax, ax
    mov     es, ax

    cli                         ; update ISR address w/ ints disabled
    push    word [es:9*4+2]     ; preserve ISR address
    push    word [es:9*4]
    mov     word [es:9*4], irq1isr
    mov     [es:9*4+2],cs
    sti

    call    test

    cli                         ; update ISR address w/ ints disabled
    pop     word [es:9*4]       ; restore ISR address
    pop     word [es:9*4+2]
    sti

    ret

test:
    mov     ah, 9
    mov     dx, msg1
    int     0x21                ; print "Press and hold ESC"

test1:
    mov     al, [kbdbuf + 1]    ; check Escape key state (Esc scan code = 1)
    or      al, al
    jz      test1               ; wait until it's nonzero (pressed/held)

    mov     dx, msg2
    int     0x21                ; print "ESC pressed, release ESC"

test2:
    mov     al, [kbdbuf + 1]    ; check Escape key state (Esc scan code = 1)
    or      al, al
    jnz     test2               ; wait until it's zero (released/not pressed)

    mov     dx, msg3            ; print "ESC released"
    int     0x21

    ret

irq1isr:
    pusha

    ; read keyboard scan code
    in      al, 0x60

    ; update keyboard state
    xor     bh, bh
    mov     bl, al
    and     bl, 0x7F            ; bx = scan code
    shr     al, 7               ; al = 0 if pressed, 1 if released
    xor     al, 1               ; al = 1 if pressed, 0 if released
    mov     [cs:bx+kbdbuf], al

    ; send EOI to XT keyboard
    in      al, 0x61
    mov     ah, al
    or      al, 0x80
    out     0x61, al
    mov     al, ah
    out     0x61, al

    ; send EOI to master PIC
    mov     al, 0x20
    out     0x20, al

    popa
    iret

kbdbuf:
    times   128 db 0

msg1 db "Press and hold ESC", 13, 10, "$"
msg2 db "ESC pressed, release ESC", 13, 10, "$"
msg3 db "ESC released", 13, 10, "$" 
```

在 DOS/Win9x/NT/2K/XP/32-bit Vista/7 或 DosBox 中运行它。

**更新：** TASM 版本：

```
; file: kbdt.asm
; compile with TASM/TLINK:
;   tasm.exe kbdt.asm
;   tlink.exe /t kbdt.obj

.286

code segment use16
assume cs:code, ds:code, ss:code
org 100h

main:
    xor     ax, ax
    mov     es, ax

    cli                         ; update ISR address w/ ints disabled
    push    word ptr es:[9*4+2]     ; preserve ISR address
    push    word ptr es:[9*4]
    mov     word ptr es:[9*4], offset irq1isr
    mov     es:[9*4+2],cs
    sti

    call    test0

    cli                         ; update ISR address w/ ints disabled
    pop     word ptr es:[9*4]   ; restore ISR address
    pop     word ptr es:[9*4+2]
    sti

    ret

test0:
    mov     ah, 9
    mov     dx, offset msg1
    int     21h                 ; print "Press and hold ESC"

test1:
    mov     al, [kbdbuf + 1]    ; check Escape key state (Esc scan code = 1)
    or      al, al
    jz      test1               ; wait until it's nonzero (pressed/held)

    mov     dx, offset msg2
    int     21h                 ; print "ESC pressed, release ESC"

test2:
    mov     al, [kbdbuf + 1]    ; check Escape key state (Esc scan code = 1)
    or      al, al
    jnz     test2               ; wait until it's zero (released/not pressed)

    mov     dx, offset msg3     ; print "ESC released"
    int     21h

    ret

irq1isr:
    pusha

    ; read keyboard scan code
    in      al, 60h

    ; update keyboard state
    xor     bh, bh
    mov     bl, al
    and     bl, 7Fh             ; bx = scan code
    shr     al, 7               ; al = 0 if pressed, 1 if released
    xor     al, 1               ; al = 1 if pressed, 0 if released
    mov     cs:[bx+kbdbuf], al

    ; send EOI to XT keyboard
    in      al, 61h
    mov     ah, al
    or      al, 80h
    out     61h, al
    mov     al, ah
    out     61h, al

    ; send EOI to master PIC
    mov     al, 20h
    out     20h, al

    popa
    iret

kbdbuf      db 128 dup (0)

msg1 db "Press and hold ESC", 13, 10, "$"
msg2 db "ESC pressed, release ESC", 13, 10, "$"
msg3 db "ESC released", 13, 10, "$"

code ends

end main 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:44:19.227

通常对于像这样的旧系统，人们使用 BIOS 有点像预先提供的一组库函数，其中只有在方便时才使用键盘功能等功能。在您的情况下，BIOS 键盘服务不方便，因此您不要使用它们。

相反，您想用自己的键盘中断处理程序替换 BIOS 键盘中断处理程序并实现自己的键盘驱动程序。键盘使用 IRQ1，即中断 9。中断向量表从 0x0000:0x0000 开始，因此您希望在 0x0000:9*4 = 0x0000:0x0024 处获取 4 个字节并将它们存储在某处（这样您就可以将它们放回去当您的软件退出时恢复正常）并将您自己的键盘 IRQ 处理程序的地址（偏移然后段）放在那里。

要编写自己的键盘驱动程序，首先要了解涉及到 2 个硬件。计算机中有键盘控制器芯片（或“PS/2 控制器”），它（通过串行通信）与键盘本身内部的芯片通信。

有关键盘控制器芯片的信息，请参见[http://wiki.osdev.org/%228042%22_PS/2_Controller](http://wiki.osdev.org/%228042%22_PS/2_Controller)

有关键盘本身内部芯片的信息，请参阅[http://wiki.osdev.org/PS/2_Keyboard](http://wiki.osdev.org/PS/2_Keyboard)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-07T09:49:32.063

使用端口 60h 和端口 64h 轮询键盘的示例：

```
 cli            ; stop software-Interrupts
       mov  al, 2     ; stop IRQ 1
       out  21h, al
       sti
P1:
       in   al, 64h     ; get Status
       test al, 1       ;  is there something in the outputbuffer?
       jz  P1
       test al, 20h     ;  it is a byte from the PS2-Mouse?
       jnz  P1
       in   al, 60h     ; get a key
       cmp  al, 1       ;  Escape-key?
       jz  XRAUS        ; then goto end
;───────────────────────────────────────────────────────────────
       mov  si, OFFSET SONTAB  ; get the offsetaddress of our special-key table
       mov  cl, Extablen       ; lenght
XSUCH: cmp  al, [si]
       jz  XFOUND
       lea  si, [si+1]         ; instead of "inc si"
       dec  cl
       jnz XSUCH
;───────────────────────────────────────────────────────────────
       mov  si, OFFSET TASTTAB  ; get the offsetaddress of our key table
       mov  cx, tablen
       mov  bx, OFFSET TEXTTAB  ; our corresponding ASCII table
SUCH:  cmp  al, [si]
       jz  short FOUND
       lea  si, [si+1]
       dec  cx
       jnz SUCH
       jmp  P1
;───────────────────────────────────────────────────────────────
XRAUS: in   al, 60h ; clear outputbuffer
       cli
       xor  al, al  ; enable IRQ 1
       out  21h, al
       sti
       mov  ah, 1  ; clear buffer in the ram
       int  16h
; ...some more instructions
;───────────────────────────────────────────────────────────────
FOUND:  mov  si, tablen   ; Length
        sub  si, cx
        xor  ecx, ecx
        mov  cl, [bx+si]  ; get the ASCII from our table
;  ...some more instructions
;───────────────────────────────────────────────────────────────
XFOUND:
;  Tab,shift li.,shift re.,HOME,UP,LEFT,RIGHT,END,DOWN
        cmp  cl, 1       ; DOWN-key
        jnz short  ...   ; jump to next
        ....
        ....
        cmp  cl, 9       ; Tab-key
        jnz  P1
;  ...some more instructions
:------------------------Data area----------------------
TASTTAB DB 02h,03h,04h,05h,06h,07h,08h,09h,0Ah,0Bh,0Ch,0Dh
        DB 10h,11h,12h,13h,14h,15h,16h,17h,18h,19h,1Ah,1Bh,1Eh,1Fh
        DB 20h,21h,22h,23h,24h,25h,26h,27h,28h,29h,2Bh,2Ch,2Dh,2Eh,2Fh
        DB 30h,31h,32h,33h,34h,35h,39h
        DB 56h
tablen =  ($-TASTTAB)
TEXTTAB DB "1234567890ß'"     ; with some german letters inside
        DB "qwertzuiopü+as"
        DB "dfghjklöä^#yxcv"
        DB "bnm,.- "
        DB "<"
Textablen  =  ($-TEXTTAB)
;---------------------------------------------------------------------------
;  Tab,shift left.,shift rigth.,HOME,UP,LEFT,RIGHT,END,DOWN
;----------
SONTAB  DB 0Fh,2Ah,36h,47h,48h,4Bh,4Dh,4Fh,50h
Extablen  =  ($-SONTAB)
        DB 0,0,0 ; for data_alignment of following entries 
```

# java - 将 cronTrigger 与包含年份值的表达式一起使用时出错

> ID：10524862
> 
> 赞同：1
> 
> 时间：2012-05-09T22:15:53.597
> 
> 标签：java, cron, quartz-scheduler, crontrigger

我正在观察使用包含年份值的 CronTrigger 在 Quartz 中安排作业的奇怪行为。

以下是我创建触发器并使用它安排作业的方式：

```
CronTrigger trigger =  cronJobTriggerFactory.getObject();
trigger.setName(triggerName);
trigger.setGroup(triggerGroupName);
trigger.setCronExpression(cronSchedule);
trigger.setVolatility(false);

JobDetail job = schedulableJobFactory.getObject();
job.setName(jobName);
job.setGroup(jobGroupName);
job.setVolatility(false);
job.setDurability(true);
Date scheduleTime1 = scheduler.scheduleJob(job, trigger);
logger.info(job.getKey() + " will run at: " + scheduleTime1); 
```

然后在我的单元测试中，我确定“现在”日期，添加 5 分钟，计算这个日期/时间的 cron 表达式，并用这个时间表调用我的主要课程安排一个工作。这是单元测试的输出，显示通过了哪个 cron 表达式：

```
NotificationSchedulerTest - Today is: 9 May 2012 05:32 PM
NotificationSchedulerTest - 5 min later is: 9 May 2012 05:37 PM
NotificationSchedulerTest - cron schedule is: 0 37 17 * 4 ? 2012 
```

但是，当尝试使用此 cron 表达式安排作业时 - 我收到以下错误：

```
org.quartz.SchedulerException: Based on configured schedule, the given trigger will never fire. 
```

如您所见，相对于我正在运行测试的日期/时间，该日期是未来的……因此，尝试将作业安排在过去的某个时间运行应该不是问题。

现在下一个奇怪的事情：注意我确实在我的 cron 表达式中指定了年份值：“0 37 17 * 4 ? **2012** ”。

如果我修改 cron 表达式的生成并将年份字段保留为未指定（因为它是可选的）：“ 0 37 17 * 4 ？” 然后调度确实成功了，但是，调度程序显示下一次触发作业是在 2013 年！（一年后...... - 当然我不能等待那么久来验证它被解雇......）：

```
NotificationSchedulerTest - Today is: 9 May 2012 06:11 PM
NotificationSchedulerTest - 5 min later is: 9 May 2012 06:16 PM
NotificationSchedulerTest - cron schedule is: 0 16 18 * 4 ?
...
NotificationScheduler - myJobKey will run at: Mon Apr 01 18:16:00 EDT 2013 
```

我在这些 cron 表达式中遗漏了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T21:25:01.710

cron 表达式中的月份是从 1 开始的。这`0 37 17 * 4 ? 2012`就是永远不会执行的原因：今天是 5 月 10 日，您希望它在 4 月的每一天运行。当您删除年份时，它会在 2013 年打印下一个预定日期，但在 4 月！*myJobKey 将在：Mon **Apr** 01 18:16:00 EDT 2013*运行。

显然你的表达应该是：

```
0 37 17 * 5 ? 2012 
```

或为避免将来混淆：

```
0 37 17 * May ? 2012 
```

# c++ - C++：从 *std::shared_ptr 复制时出错

> ID：10524867
> 
> 赞同：2
> 
> 时间：2012-05-09T22:16:11.057
> 
> 标签：c++, c++11, valgrind, shared-ptr

我有一个返回指向对象的共享指针的函数（由于许多大的依赖关系，很难包含 MyObject 定义）：

```
std::shared_ptr<MyObject> f(std::string params)
{
  return std::shared_ptr<MyObject>(new MyObject(params));
} 
```

有谁知道为什么这段代码有效：

**案例1：没有错误`valgrind -v --tool=memcheck`**

```
std::shared_ptr<MyObject> obj_ptr = f("hello");
MyObject obj = *obj_ptr; 
```

虽然此代码崩溃：

**案例2：崩溃并给出了几个错误`valgrind -v --tool=memcheck`**

```
MyObject obj = *f("hello"); 
```

MyObject 类有一个工作赋值运算符和复制构造函数（都在**案例 1**中验证）。

我还尝试创建一个`std::shared_ptr<MyObject>`（通过`f`），将其复制到指针，将指针复制到堆栈上的对象，然后删除指针。堆栈上的最终对象仍然可以：

**案例3：没有错误`valgrind -v --tool=memcheck`**

```
std::shared_ptr<MyObject> obj_ptr = f("hello");
MyObject * obj_ptr2 = new MyObject(*obj_ptr);
MyObject obj3 = *obj_ptr2;
delete obj_ptr2;
obj3.print(); 
```

错误是否可能是因为`std::shared_ptr`它是作为右值创建的，并在`*`运算符运行后立即释放其内存？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-09T22:49:36.073

问题是（几乎可以肯定）您正在浅复制`MyObject`其复制构造函数中的成员之一。然后，您要么尝试访问不再有效的浅层数据，要么将其双重删除。

考虑以下情况：在第一种和第三种情况下，当您对堆栈对象进行操作时，创建所有副本的第一个对象仍然是活动的。在第二种情况下`shared_ptr`，复制构造后消失，调用`MyObject`.

如果您因此更改了第三种情况，我怀疑它会崩溃：

```
MyObject * obj_ptr2 = new MyObject("hello");
MyObject obj3 = *obj_ptr2;
delete obj_ptr2;
obj3.print(); 
```

# python - django 在 heroku 上发布 url

> ID：10524871
> 
> 赞同：2
> 
> 时间：2012-05-09T22:16:43.487
> 
> 标签：python, django, heroku, cloud

您好，我正在 heroku 上部署一个测试项目，但出现此错误

```
Exception Type: ImportError
Exception Value:    No module named hello.urls 
```

这是我的 Procfile 文件 web: python manage.py runserver 0.0.0.0:$PORT

项目名称是 hello all run ok 除了我运行 heroku ps give 时的应用程序

```
Process  State       Command
-------  ----------  -----------------------------------
web.1    up for 29s  python manage.py runserver 0.0.0.0. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T21:46:16.347

看起来这是一个 python 路径问题。如果您将项目代码粘贴到某处，我很乐意为您寻找。我基本上需要看看：

*   站点结构（文件夹、文件）。
*   你的`settings.py`档案。

# php - 将php变量返回到jquery ajax

> ID：10524875
> 
> 赞同：3
> 
> 时间：2012-05-09T22:17:02.477
> 
> 标签：php, jquery, ajax

我在 jquery 中有一个 ajax 函数调用一个 php 文件来对我的数据库执行一些操作，但结果可能会有所不同。无论成功与否，我都想输出不同的消息

我有这个 ：

```
echo '<button id="remove_dir" onclick="removed('.$dir_id.')">remove directory</button>';

<script type="text/javascript">
    function removed(did){
        $.ajax({ 
            type: "POST", 
            url: "rmdir.php", 
            data: {dir_id: did},
            success: function(rmd){ 
                if(rmd==0)
                    alert("deleted");
                else
                    alert("not empty");
                window.location.reload(true);
            } 
        }); 
    }
</script> 
```

还有这个

```
 <?php
require('bdd_connect.php');
require('functions/file_operation.php');
if(isset($_POST['dir_id'])){
    $rmd=remove_dir($_POST['dir_id'],$bdd);
}
?> 
```

我的问题是，如何在 $.ajax 中返回 $rmd，我可以提醒正确的消息？

谢谢您的回答

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-09T22:21:14.360

PHP

```
<?php
   require('bdd_connect.php');
   require('functions/file_operation.php');
   if (isset($_POST['dir_id'])){
      $rmd=remove_dir($dir_id,$bdd); 
      echo $rmd;
   }
?> 
```

JS

```
function removed(did){
    $.ajax({ 
        type: "POST", 
        url: "rmdir.php", 
        data: {dir_id: did}
    }).done(function(rmd) {
         if (rmd===0) {
            alert("deleted");
         }else{
            alert("not empty");
            window.location.reload(true);  
         }
    });
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T22:19:30.253

我建议使用 json 或：

```
if(isset($_POST['dir_id'])){
    $rmd=remove_dir($dir_id,$bdd);  
    echo $rmd;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T22:36:08.653

您需要您的 php 文件发送回一些东西，然后您需要原始页面上的 ajax 调用根据响应来运行。

php:

```
if(isset($_POST['dir_id'])){
    $rmd=remove_dir($dir_id,$bdd);  
    echo "{'rmd':$rmd}";
} 
```

这将输出以下两件事之一：`{"rmd": 0}`或`{"rmd": 1}`

我们可以在[jsBin上模拟这个返回](http://jsbin.com/iwokag/3)

然后使用 jquery 获取值并根据我们回调中的响应做一些事情：

```
$.ajax({ 
    type: "POST",
    dataType: 'json',
    url: "http://jsbin.com/iwokag/3",
    success: function(data){ 
        alert('rmd = ' + data.rmd)
    } 
}); 
```

[查看代码](http://jsbin.com/egizoc/5/edit#javascript,html)，然后[观察它的运行](http://jsbin.com/egizoc/5)。只是我没有在这里发送任何数据，我的示例页面总是返回相同的响应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T22:19:38.030

只需尝试在您的 ajax 文件中回显 $rmd，然后查看控制台（尝试`console.log(rmd)`在您的 ajax 响应块中）

```
$.ajax({ 
        type: "POST", 
        url: "rmdir.php", 
        data: {dir_id: did},
        success: function(rmd){ 

            console.log(rmd);
        } 
    }); 
```

然后，您可以根据响应采取相应的行动

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-09T22:24:18.317

尝试在 php 代码中回显 $rmd，作为对 ajax 的返回。

```
if(isset($_POST['dir_id'])){
    $rmd=remove_dir($dir_id,$bdd);  
    //if $rmd = 1 alert('directory not empty');
    //if $rmd = 0 alert('directory deleted');
    echo $rmd;
} 
```

你的“rmd”`success: function(rmd)`应该收到callabck。

# ruby-on-rails - Ruby/Rails - Presenter 类和实例方法

> ID：10524876
> 
> 赞同：0
> 
> 时间：2012-05-09T22:17:08.810
> 
> 标签：ruby-on-rails, ruby

我有一个基本演示者，主要用于 JSON 和 CSV 类型的演示。我遇到了一个我不知道如何处理的问题。如果我有一个带有类方法的 PhotoPresenter，我无法访问实例方法帮助，所以我不得不创建 self.help 方法，但我认为这很糟糕......关于如何避免与实例和类级别方法重叠的任何想法。可能只是累了，对此很愚蠢

```
class Presenter
  include Rails.application.routes.url_helpers

  def self.as_collection(collection)
    collection.collect{|object| self.new(object)}
  end

  def help
    Helper.instance
  end

  def self.help
    Helper.instance
  end

  class Helper
    include Singleton
    include ActionView::Helpers::TextHelper
    include ActionView::Helpers::TagHelper
    include ActionView::Helpers::UrlHelper
  end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T04:26:34.710

您可以避免一些重复，如下所示：

```
def self.help
  Helper.instance
end

def help
  self.class.help
end 
```

# ruby-on-rails - 如何强制瘦以使用 Rails 记录器？

> ID：10524877
> 
> 赞同：1
> 
> 时间：2012-05-09T22:17:13.943
> 
> 标签：ruby-on-rails, rack, thin

默认情况下`thin`登录一个单独的文件（类似于`thin.0.log`）。这使得调试变得困难，因为异常将记录在 Thin.0.log 中，而所有其他信息都在 Rails 日志中。你怎么能强制thin 与Rails 登录同一个文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-09T22:25:19.893

`development.log`尽管可能很烦人，但该数据应该与or `production.log`（我假设您指的是）分开。精简日志处理与精简服务器直接相关的所有内容，包括无法启动的原因、说明它启动、绑定到哪个端口等。其他日志用于您的应用程序本身，例如异常、页面呈现, 请求等...

当您遇到由于模型中的语法错误或其他原因而导致瘦身无法启动的问题时，您会为此感到高兴。为这些实例提供一个干净的日志会更好，而不是过滤数千行`served static asset...`

Rails 就是一切都被组织起来并拥有自己的位置。

# c# - 如何找出我的错误来自哪里？

> ID：10524878
> 
> 赞同：7
> 
> 时间：2012-05-09T22:17:19.420
> 
> 标签：c#, .net, visual-studio

我有一个恼人的错误弹出来，我不知道它来自哪里。错误是：

```
Error   31  Unable to copy file "app.config" to "bin\Debug\Framework.Tests.dll.config". Could not find file 'app.config'.   Framework.Tests 
```

问题是，我在任何地方都没有 bin\Debug 文件夹，也没有说明它试图从哪里复制 app.config。双击错误不会把我带到它试图复制的任何代码，所以这对我也没有帮助。所以我不知道应该在哪里制作 app.config。

我怎样才能找到这个？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-09T22:19:44.900

您已添加对名为的文件的引用，`app.config`或者 Visual Studio 已为您完成此操作。该文件在磁盘上不存在，可能是因为在添加引用后您后来删除了该文件。

在解决方案资源管理器中搜索丢失的文件，然后删除引用或创建文件。

它很可能位于您的某个项目的根文件夹中，并且应该有一个黄色三角形警告图标，表明该文件丢失。

![在此处输入图像描述](../Images/185b35145bcf53cf5a3c09c751ea4f5c.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:21:51.797

在 MSTest 项目中，app.config 是您希望提供对`ConfigurationManager`类的任何调用的那个。

它位于测试项目的根目录中。

首次编译项目后，将创建 bin\debug 文件夹。在解决方案资源管理器中显示所有文件应该会有所帮助，因为它们不（也不应该）包含在项目中。

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:33:44.663

您的项目文件夹下可能确实有一个 bin\Debug 文件夹，它是 Visual Studio 在为调试配置构建项目时创建的构建目标文件夹。

我的猜测是某些东西（可能是测试框架）仍然加载了 DLL 文件，因此 Visual Studio 无法删除现有的 Framework.Tests.dll.config 文件并将其替换为 app.config 的内容。[注意：app.config 文件的项目构建操作是将其复制到重命名的目标文件夹，以匹配附加了 .config 扩展名的可执行文件。]

# ios - NSURLConnection 有时会截断 NSMutableURLRequest 的主体

> ID：10524881
> 
> 赞同：3
> 
> 时间：2012-05-09T22:17:37.500
> 
> 标签：ios, http, nsurlconnection, nsurlrequest, nsmutableurlrequest

我在 appStore 上有一个将 xml 数据同步到 web 服务的应用程序。我今天收到了两个错误报告，原因是 xml 文档过早结束。一个在 xml 标记的中间结束，所以我知道这不是由特殊字符引起的问题。其中一个错误发生在 184kb，另一个发生在 302kb，因此请求在这么多字节后被截断不是问题。不过，这似乎只是较长请求的问题。

是否有任何特定设置可以防止这种截断发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T17:04:15.293

我已经能够通过在 NSURLConnection 完成发送请求之前关闭我的应用程序来重现这一点。我猜我的几个应用用户也发生了同样的事情。

# objective-c - 在 prepareForSegue 期间得到 [UIViewController ] 何时尝试为属性赋值？

> ID：10524885
> 
> 赞同：0
> 
> 时间：2012-05-09T22:18:02.057
> 
> 标签：objective-c, ios, exception, segue

在prepareForSegue期间，我尝试为属性赋值并得到错误

> 2012-05-09 23:14:22.122 LeakSpotter [17709:15b03] ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[UIViewController setCoordLong:]：无法识别的选择器发送到实例 0xa86e930”

标题：

```
@property (nonatomic, retain) NSString *CoordLong;
@property (nonatomic, retain) NSString *CoordLat; 
```

它们是合成的。

> -(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{

```
NSLog(@"Fired segue %@", [segue identifier]);
if([[segue identifier] isEqualToString:@"returnToLeakSpotter"]){
    NSLog(@"Return to leak spotter segue...");
    //ContactsViewController *cvc = (ContactsViewController *)[segue destinationViewController];

}else if ([[segue identifier] isEqualToString:@"gotoTakePhoto"]) {
    NSLog(@"Go to photo view");
    takePhotoViewController *takePhotoC = [segue destinationViewController];

    takePhotoC.CoordLong = @"-9.88";
    takePhotoC.CoordLat = @"45.45"; 
```

我错过了什么明显的东西吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T22:38:43.963

看起来您还没有在情节提要中的 takePhotoViewController 上设置视图控制器子类，因此它正在实例化一个不知道 CoordLat 是什么的基本 UIViewController（如错误所示）。

顺便说一句，按照惯例，类名以大写字母开头，变量/属性以小写字母开头，您似乎反其道而行之。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T23:25:39.740

您可能需要转换您的 viewController，因为 destinationViewController 默认返回 UIViewController。

```
takePhotoViewController *takePhotoC = (takePhotoViewController *)[segue destinationViewController]; 
```

# sed - sed 匹配多行然后追加

> ID：10524888
> 
> 赞同：3
> 
> 时间：2012-05-09T22:18:06.830
> 
> 标签：sed

我想在 verilog 端口列表之后附加一些代码，其形式如下：

```
module module_name (
input wire in1,
input wire in2,
output wire out1
); 
```

我正在寻找有关如何使用 sed（或其他命令）查找以“module”开头并以“);”结尾的端口列表的帮助。然后在“);”之后的行附加一些代码

命令：

```
sed '/^module/,/);/a code to append' test.v 
```

将“要附加的代码”放在匹配序列中的每一行上，而不仅仅是在它之后

```
module module_name (
code to append
input wire in1,
code to append
input wire in2,
code to append
output wire out1
code to append
);
code to append 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T23:58:57.817

这可能对您有用：

```
sed '/^module/,/);/!b;/);/a\NEWCODE' file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:37:01.960

这有点笨拙，但它会完成这项工作：

```
sed ':a /module/s/);/);\ncode to append/;t;N;b a' filename 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:35:36.887

您可以使用这样的命令行来代替 sed `perl`：

```
perl -0pe 's@(module[^(]*\([^)]*\)\s*;)@$1'"\na code to append"'@' test.v 
```

### 输出

```
module module_name (
input wire in1,
input wire in2,
output wire out1
);
a code to append 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T22:46:35.007

既然你说 sed 或任何其他命令，我会用 perl 回答。您可以在 perl 中使用以下命令执行此操作：

```
# perl -pe 'BEGIN { $/ = undef; }s#(^module.+?\);)#$1\ncode to append#omgs' test.v

module module_name (
input wire in1,
input wire in2,
output wire out1
);
code to append 
```

# javascript - 用javascript绘制图表

> ID：10524891
> 
> 赞同：0
> 
> 时间：2012-05-09T22:18:34.970
> 
> 标签：javascript, flot

我对javascript很陌生。我喜欢从以下数组中绘制图表：

```
var sampleData = [
                                    { Period: '1981', Size: 80.01 , Age: 32 },
                                    { Period: '1981', Size: 89.11, Age : 35 }]; 
```

我使用 jquery.flot.js 库来绘制图表。这是绘制图表的示例，它工作正常：

```
var d1 = [];
    for (var i = 0; i < 14; i += 0.5)
        d1.push([i, Math.sin(i)]);
var d2 = [[0, 3], [4, 8], [8, 5], [9, 13]];

    $.plot($("#placeholder"), [d1, d2]); 
```

根据示例，这是我绘制图表的代码：

```
var myData1 = [];
     for (var i in sampleData) {
        myData.push( sampleData[i].Period, sampleData[i].Size);
    } 
var myData2 = [];
     for (var i in sampleData) {
        myData.push( sampleData[i].Period, sampleData[i].Age);
    }              
$.plot($("#placeholder"), [myData1, myData2 ]); 
```

但是使用此代码，我的图表没有任何线条！

有人能指出我的错在哪里吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T23:46:26.500

代替

```
myData.push( sampleData[i].Period, sampleData[i].Size); 
```

我想你想要

```
myData.push( [sampleData[i].Period, sampleData[i].Size] ); 
```

这将创建一个数组数组（其中内部数组是 x,y 坐标）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:25:49.570

这可能是你的循环：

```
 var myData1 = [];
   for (var i in sampleData) {
     myData.push( sampleData[i].Period, sampleData[i].Size);
 } 
 var myData2 = [];
   for (var i in sampleData) {
     myData.push( sampleData[i].Period, sampleData[i].Age);
 }

 $.plot($("#placeholder"), [myData1, myData2 ]); 
```

在每个循环中，您将数据推送到`myData`数组中，但是您定义`myData1`and `myData2`，将循环内部分别更改为`myData1.push`and `myData2.push`。

# html - 如何将某物直接放在另一物的右侧（HTML/CSS）？

> ID：10524892
> 
> 赞同：2
> 
> 时间：2012-05-09T22:18:35.377
> 
> 标签：html, css

基本上我所拥有的是一个带有“主要内容”块的 HTML 页面，如果你愿意的话。该页面的所有主要内容都在我拥有的 div 中。我想要的是在它的右侧有一个包含更多内容的列，但无论我尝试做什么，它总是最终会在它下方或某个随机位置。这是我页面的代码，如果有人可以帮助指导我完成它，那就太棒了。

HTML：[http://pastebin.com/Hh2TNGdj](http://pastebin.com/Hh2TNGdj) CSS： http: [//pastebin.com/ZCEJkFmH](http://pastebin.com/ZCEJkFmH)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:30:12.700

您可能已经接近了... 直接放入新的 div `#pagecontent`，然后将其向右浮动，然后将`#pagecontent`div 向左浮动，将允许他们并排坐下。

请注意，下一个内容（例如页脚）需要正确清除，以免与浮动 div 重叠。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:35:40.390

我个人会改用 HTML5 标签。如果我要做这样的事情，我会沿着这条线使用代码（未经测试）：

```
 <div id="wrapper"> #wrap both sections in a container
        <section id="left">Left Section</section>
        <section id="right">Right Section</section>
    </div> 
```

对于 CSS，您可以执行以下操作：

```
 #wrapper {
        width: 1000px;
        height: auto;
    }
    #left {
         width: 500px;
         height: auto;
         float: left;
     }
    #right {
          width: 500px;
          height: auto;
          float: left;
     } 
```

一些重要的事情要记住。如果添加填充，请从宽度中减去（如果填充在左右两侧，则减去填充 x2）。在你的页脚上写清楚：两者。

希望这可以帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:30:37.160

这是一个小提琴：http: [//jsfiddle.net/n6D7U/](http://jsfiddle.net/n6D7U/)

*   新的 div `#aside`,
*   两列都以固定宽度浮动（此处为 700+20+240 像素），
*   最后一个 CSS 规则在那里，因为父级只有浮动的子级，因此流中没有更多的内容来推动背景......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T22:35:07.893

我认为这应该有效：

```
<div style="padding:20px;">
        <div id="pagecontent">
                <span class="main-content-font">
                            The title of this page goes in the gray box above. This is the homepage, you can put <u>anything</u> here  (the main content of your website
                            which has some neat features and explains what your site is about should go here)!<br />
                            <br>
                            Content, content, and more content!<br />
                            <br>
                            Try to make it fill up as much space as possible, making the page longer. Don't fill it with useless junk, just anything
                            you can think of that will benefit the page.
               </span> 
               <span class="whatever">
                    some things
               </span>
        </div>
</div> 
```

我没试过，但是做`main-content-font`一个 span 不会添加换行符，所以`whatever`span 会放在它的右边。

# php - 通过jquery在ajax中使用php post请求检索JSON格式的结果，用于添加谷歌地图标记关闭

> ID：10524893
> 
> 赞同：1
> 
> 时间：2012-05-09T22:18:42.047
> 
> 标签：php, json, jquery, google-maps-markers

只是做一个与谷歌地图有关的小项目。

基本上，我在数据库中有要使用 ajax 检索的坐标，并在无需刷新页面的情况下更新地图。

php部分：-

```
$deviceID = $_POST['deviceID'];
$sqlLocation = "SELECT * FROM Location WHERE DeviceID = '".$deviceID."' AND Type ='network'";
$sqlResult = mysql_query($sqlLocation); 

while($row = mysql_fetch_assoc($sqlResult))
{
    $response["uid"] = $row["DeviceID"];
    $response["deviceInfo"]["Longitude"] = $row["Longitude"];
    $response["deviceInfo"]["Latitude"] = $row["Latitude"];
    $response["deviceInfo"]["Type"] = $row["Type"];
    $response["deviceInfo"]["latlontime"] = $row["latlontime"];

    echo json_encode($response);
} 
```

多个json结果的格式：-

```
{"uid":"*deviceID here*","deviceInfo":
   {"Longitude":"x.xxxxxxx","Latitude":"x.xxxxxxx","Type":"network","latlontime":"2012-05-05 18:55:12"}
}

{"uid":"*deviceID here*","deviceInfo":
   {"Longitude":"y.yyyyyyyyy","Latitude":"y.yyyyyyyyy","Type":"network","latlontime":"2012-05-05 18:55:56"}
} 
```

带有一些伪代码的 JavaScript 部分抱歉！

```
 var map;
var count =0;
function initialize(DeviceID) 
  {
    if(DeviceID!=null)
    {
    $.ajax({
                type:"POST",
                dataType:"json",
                data:{deviceID: DeviceID},
                url: "json_coords.php",
                contentType: "application/json; charset=utf-8",
                success: function(data) 
                {
 *****problem used be here******
                    var len = data.length;
                    for( var i = 0; i<len; i++) 
                    {
                            var json_row = data[i];
                            var latitude = json_row.deviceInfo.Latitude;
                            var longitude = json_row.deviceInfo.Longitude;
                            var title = "pos: "+i+json_row.deviceInfo.Type + " " 
                            +json_row.deviceInfo.latlontime ;
                            //alert_test(latitude,student.Longitude);

                            setMarker(latitude,longitude,title);
*********************************************************************************
                    }

                }
            });
    }

    else 
    {
        // do nothing
    }

    var latloncenter = new google.maps.LatLng(51,-1.4469157);
    var myOptions = 
    {
      zoom: 4,
      center: latloncenter,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

  }

function setMarker(lat,lon,titletxt)
{

var latlongMarker = new google.maps.LatLng(lat,lon);

var marker = new google.maps.Marker
    (
        {
            position: latlongMarker, 
            map: map,
            title:titletxt
        }
    ); 

} 
```

在网站上按下某个 div 后将调用初始化函数：-

```
$('#leftcolumn>a').click(function() 
    {
    var deviceID = $(this).attr("name");

      //alert(deviceID);
      initialize(deviceID)
    }); 
```

如果您能帮助我，我将不胜感激

谢谢 ：）

*******最初的问题是关于如何从带有 json 结果的 php 页面中检索数据* *********

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:42:18.907

jQuery 的 Ajax 函数（在 JSON 模式下）需要一个唯一的 json 对象，你 ara 发送 2，格式无效。

你可以做：

```
$response = array();

while($row = mysql_fetch_assoc($sqlResult))
{
    $response[] = (object) array(
         'uid'        => $row["DeviceID"],
         'deviceInfo' => (object) array  (
               'Longitude'  => $row["Longitude"],
               'Latitude'   => $row["Latitude"],
               'Type'       => $row["Type"],
               'latlontime' => $row["latlontime"]
         )
    );

}

echo json_encode($response); 
```

和 onsuccess 回调：

```
success: function(data) {
     $.each(data, function (device) {
          var title = device.Type + ' ' + device.latlontime;
          setmarker( device.Longitude ,device.Latitude , title);
     });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T23:01:12.423

```
<html>
<head>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false&region=GB"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
</head>
<body onload="initialize();">
<div id="map_canvas" style="height:300px;width:500px"></div>
<a href="#" onclick="loaddata(1);">Load markers</a>
<script type="text/javascript">
 var map;
var count =0;
function initialize() 
  {    
    var latloncenter = new google.maps.LatLng(51,-1.4469157);
    var myOptions = 
    {
      zoom: 4,
      center: latloncenter,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    }
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
  }

function loaddata(DeviceID)
{
if(DeviceID!=null)
    {
    $.ajax({
              type: "POST",
              dataType: "json",
              data:{deviceID: DeviceID },
              url: 'mapdata.php',
       success: function(data) 
       {       
           $.each(data,function(index,value) {
             console.log(value);
              /// I know there is no such thing as data.jsonGetvalueByID just trying to explain what I want to do 
             var longitude = value.deviceInfo.Longitude;
             var latitude = value.deviceInfo.Latitude;
             var type = value.deviceInfo.Type;
             var time = value.deviceInfo.latlontime;
             var title = type + " " +time;
             //calling function to add map marker
             createmarker(longitude, latitude, title);          
            });

       }
    }); 
    }

}

function createmarker(lat,lon,titletxt)
{
var latlongMarker = new google.maps.LatLng(lat,lon);

var marker = new google.maps.Marker
    (
        {
            position: latlongMarker, 
            map: map,
            title:titletxt
        }
    ); 

    return marker;
}
</script>
</body>
</html>
// my ajax file that just fakes the data needed, so replace with your database code.
<?php
$response = array();
$rows = array();
$rows[] = array("DeviceID"=>1,"Type"=>"Network","Longitude"=>"51.4343","Latitude"=>"-2.344","latlontime"=>date("Y-m-d H:i:s"));
$rows[] = array("DeviceID"=>2,"Type"=>"Network","Longitude"=>"55.4343","Latitude"=>"-2.644","latlontime"=>date("Y-m-d H:i:s"));
foreach ($rows as $row)
{
$data["uid"] = $row["DeviceID"];
    $data["deviceInfo"]["Longitude"] = $row["Longitude"];
    $data["deviceInfo"]["Latitude"] = $row["Latitude"];
    $data["deviceInfo"]["Type"] = $row["Type"];
    $data["deviceInfo"]["latlontime"] = $row["latlontime"];

    $response[] = $data;
}

echo json_encode($response);

?> 
```**

# iphone - 重新排序行时，最后一行的源索引路径设置为“0”

> ID：10524894
> 
> 赞同：0
> 
> 时间：2012-05-09T22:18:44.230
> 
> 标签：iphone, objective-c, ios, cocoa-touch, uitableview

有没有人遇到过这种情况？

当我从最底部到最顶部重新排序单元格时，我会崩溃。这些崩溃发生在 iSourceIndexPath.row 变为 0 时。我想知道我的 iSourceIndexPath.row 是如何变为 0 的，因为这是我总是选择的最后一行。有什么线索吗？

```
- (NSIndexPath *)tableView:(UITableView *)iTableView targetIndexPathForMoveFromRowAtIndexPath:(NSIndexPath *)iSourceIndexPath toProposedIndexPath:(NSIndexPath *)iProposedDestinationIndexPath {
    NSIndexPath *aReturnIndexPath = iProposedDestinationIndexPath;
    if(iProposedDestinationIndexPath.row == 0) {
        aReturnIndexPath = iSourceIndexPath;
    }

    NSLog(@"iProposedDestinationIndexPath=%d iSourceIndexPath=%d aReturnIndexPath=%d",iProposedDestinationIndexPath.row,iSourceIndexPath.row,aReturnIndexPath.row);
    return aReturnIndexPath;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T01:37:31.730

移动单元格后我忘记重新加载表格。除了定期处理其中的单元格之外，您还应该这样做。

```
- (void)tableView:(UITableView *)iTableView moveRowAtIndexPath:(NSIndexPath *)iFromIndexPath toIndexPath:(NSIndexPath *)iToIndexPath {
    [self.tableView reloadData]
} 
```

# php - PHP将全局变量设置为类的句柄

> ID：10524895
> 
> 赞同：0
> 
> 时间：2012-05-09T22:18:45.580
> 
> 标签：php, oop, globals

出于某种原因，在定义时：

```
 function __construct() {
    if(!isset($_GLOBALS["className"])) {
      $_GLOBALS["className"] = new className;
    }
    return true;
  }

 $_GLOBALS["className"]->classMethod(); 
```

PHP 出于某种原因声明 $_GLOBALS["className"] 未定义。

哦，即使我在该类中将全局值设置为其他值，也会发生同样的情况。我可以通过构造或其他方法来测试全局的值，但不能在外面测试——似乎全局由于某种原因在类之外丢失了。

从外部类中声明全局后，有没有办法保留全局？真诚感谢任何帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-09T22:21:11.827

你想使用`$GLOBALS`而不是`$_GLOBALS`：

[http://php.net/manual/en/reserved.variables.globals.php](http://php.net/manual/en/reserved.variables.globals.php)

`$_GLOBALS`将仅在您的功能范围内可用。

# vba - VBA：将范围内的不同值添加到新范围

> ID：10524897
> 
> 赞同：0
> 
> 时间：2012-05-09T22:18:56.830
> 
> 标签：vba, excel

我在 Sheet1，A 列中有一个未排序的名称列表。其中许多名称在列表中出现不止一次。

在 Sheet2 Column AI 上，需要一个按字母顺序排序的名称列表，没有重复值。

使用 VBA 实现这一目标的最佳方法是什么？

到目前为止我见过的方法包括：

1.  以 CStr(name) 为键创建一个集合，遍历范围并尝试添加每个名称；如果有错误，它不是唯一的，忽略它，否则将范围扩大 1 个单元格并添加名称
2.  与 (1) 相同，但忽略错误。循环完成后，集合中只有唯一值：然后将整个集合添加到范围中
3.  在范围上使用匹配工作表功能：如果不匹配，则将范围扩大一个单元格并添加名称
4.  也许对数据选项卡上的“删除重复项”按钮进行一些模拟？（没看过这个）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T01:37:18.357

我真的很喜欢 VBA 中的字典对象。它不是本机可用的，但功能非常强大。您需要添加一个引用，`Microsoft Scripting Runtime`然后您可以执行以下操作：

```
Dim dic As Dictionary
Set dic = New Dictionary
Dim srcRng As Range
Dim lastRow As Integer

Dim ws As Worksheet
Set ws = Sheets("Sheet1")

lastRow = ws.Cells(1, 1).End(xlDown).Row
Set srcRng = ws.Range(ws.Cells(1, 1), ws.Cells(lastRow, 1))

Dim cell As Range

For Each cell In srcRng
    If Not dic.Exists(cell.Value) Then
        dic.Add cell.Value, cell.Value   'key, value
    End If
Next cell

Set ws = Sheets("Sheet2")    

Dim destRow As Integer
destRow = 1
Dim entry As Variant

'the Transpose function is essential otherwise the first key is repeated in the vertically oriented range
ws.Range(ws.Cells(destRow, 1), ws.Cells(dic.Count, 1)) = Application.Transpose(dic.Items) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T07:33:30.017

正如您所建议的，某种字典是关键。我会使用一个 Collection - 它是内置的（与 Scripting.Dictionary 相反）并且可以完成这项工作。

如果“最佳”是指“快速”，第二个技巧是不要单独访问每个单元格。而是使用缓冲区。即使有数千行输入，下面的代码也会很快。

代码：

```
' src is the range to scan. It must be a single rectangular range (no multiselect).
' dst gives the offset where to paste. Should be a single cell.
' Pasted values will have shape N rows x 1 column, with unknown N.
' src and dst can be in different Worksheets or Workbooks.
Public Sub unique(src As Range, dst As Range)
    Dim cl As Collection
    Dim buf_in() As Variant
    Dim buf_out() As Variant
    Dim val As Variant
    Dim i As Long

    ' It is good practice to catch special cases.
    If src.Cells.Count = 1 Then
        dst.Value = src.Value   ' ...which is not an array for a single cell
        Exit Sub
    End If
    ' read all values at once
    buf_in = src.Value
    Set cl = New Collection
    ' Skip all already-present or invalid values
    On Error Resume Next
    For Each val In buf_in
        cl.Add val, CStr(val)
    Next
    On Error GoTo 0

    ' transfer into output buffer
    ReDim buf_out(1 To cl.Count, 1 To 1)
    For i = 1 To cl.Count
        buf_out(i, 1) = cl(i)
    Next

    ' write all values at once
    dst.Resize(cl.Count, 1).Value = buf_out

End Sub 
```

# sql - 使用 ../../ 引用父节点时，XPath 查询运行缓慢

> ID：10524901
> 
> 赞同：3
> 
> 时间：2012-05-09T22:19:10.367
> 
> 标签：sql, xpath, performance

我想从我的 xml 文档中的每个会话中获取所有读取节点及其值，以及从父节点获取会话 ID。我在 SQL Server 2008 实例上运行它。

我的xml设置是：

```
<Sessions>
<SessionID>99</SessionID>
<Readings>
  <Reading>
    <Point>
      <Lat>-40.411558</Lat>
      <Lng>175.63504</Lng>
    </Point>
    <Heading>54</Heading>
    <Speed>0.1</Speed>
    <Height>0</Height>
    <FlowRate>0.69</FlowRate>
    <AppRate>74</AppRate>
  </Reading>
  ... more readings
</Readings>
<Sessions> 
```

我最初的尝试（有效）如下所示，但是当我运行它时这似乎非常慢。但是，当我取出添加 SessionID 即 ../../SessionID 的行时，它似乎执行得更快。一个 12 秒的查询只需 2 秒。

```
 SELECT
            [SessionID] = c.value('(../../SessionID)[1]', 'int'),
            [Heading] = c.value('(Heading)[1]', 'float'),
            [Speed] = c.value('(Speed)[1]', 'float'),
            [Height] = c.value('(Height)[1]', 'float'),
            [FlowRate] = c.value('(FlowRate)[1]', 'float'),
            [AppRate] = c.value('(AppRate)[1]', 'float'),
            [Latitude] = c.value('(Point/Lat)[1]', 'float'),
            [Longtitude] = c.value('(Point/Lng)[1]', 'float')
        FROM
            @XMLData.nodes('/Sessions/Readings/Reading') XMLData(c) 
```

无论如何我可以做到这一点，而无需使用 ../../ 符号来引用 SessionID。我确实需要 SessionID，因为此查询用于将记录插入临时表：

```
insert into #MyTempTable
SELECT
            [SessionID] = c.value('(../../SessionID)[1]', 'int'),
            [Heading] = c.value('(Heading)[1]', 'float'),
            [Speed] = c.value('(Speed)[1]', 'float'),
            [Height] = c.value('(Height)[1]', 'float'),
            [FlowRate] = c.value('(FlowRate)[1]', 'float'),
            [AppRate] = c.value('(AppRate)[1]', 'float'),
            [Latitude] = c.value('(Point/Lat)[1]', 'float'),
            [Longtitude] = c.value('(Point/Lng)[1]', 'float')
        FROM
            @XMLData.nodes('/Sessions/Readings/Reading') XMLData(c) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T03:21:08.333

对于避免 ../../ 的第一部分，您可以使用 CROSS APPLY 来提供两个数据集。

此外，如果您想要更快的 INSERT 并且不担心日志记录，则 SELECT INTO 语句将提供更快的插入：

```
SELECT
    s.value('(SessionID)[1]', 'int') SessionID,             
    r.value('(Heading)[1]', 'float') Heading,
    r.value('(Speed)[1]', 'float') Speed,
    r.value('(Height)[1]', 'float') Height,
    r.value('(FlowRate)[1]', 'float') FlowRate,
    r.value('(AppRate)[1]', 'float') AppRate,
    r.value('(Point/Lat)[1]', 'float') Latitude,
    r.value('(Point/Lng)[1]', 'float') Longtitude
INTO #Reading
FROM
    @XMLData.nodes('/Sessions') as S(s)
    CROSS APPLY 
    s.nodes('./Readings/Reading') XMLData(r) 
```

# java - Java：抽象方法中的多态返回类型？

> ID：10524908
> 
> 赞同：11
> 
> 时间：2012-05-09T22:19:39.910
> 
> 标签：java, gwt, parametric-polymorphism

我在抽象 java 类中有以下代码：

```
protected abstract <E extends HasText & IsWidget> E createNewDisplayWidget(); 
```

编译得很好。但是，如果我在任何地方调用它，编译器都会抱怨：

```
Bound mismatch: The generic method createNewDisplayWidget() of type DemoClass is not applicable for the arguments (). The inferred type HasText is not a valid substitute for the bounded parameter <E extends HasText & IsWidget> 
```

有没有办法要求抽象方法返回应该实现多个接口的东西？

注意：不，我不能创建一个特殊的接口来实现我喜欢的两个。GWT 有像 Label 这样的小部件，它们已经实现了上述接口，我想使用上述小部件。

编辑：我从这里得到了这样做的想法（第 22 页）：

[http://java.sun.com/j2se/1.5/pdf/generics-tutorial.pdf](http://java.sun.com/j2se/1.5/pdf/generics-tutorial.pdf)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T23:53:39.090

我已经根据您的问题进行了尝试，并且能够顺利通过。请检查我创建的课程。

**测试类**

```
public abstract class TestClass {

    protected abstract <E extends HasText & IsWidget > E createNewDisplayWidget();

} 
```

**HasText 类**

```
public class HasText {

} 
```

**小部件**

```
public interface IsWidget {

} 
```

**演示类**

```
 public class DemoClass extends HasText implements IsWidget{

    } 
```

**测试类1**

```
public class TestClass1 extends TestClass{

    @Override
    protected DemoClass createNewDisplayWidget() {
        // TODO Auto-generated method stub
        DemoClass type = new DemoClass();
        return type;
    }

    public void checkOut(){
        if(createNewDisplayWidget() instanceof HasText || createNewDisplayWidget() instanceof IsWidget){
            System.out.println("Yes it works");
        }
        else{
            System.out.println("It doesnt");
        }
    }

    public static void main(String[] args){
        TestClass1 check = new TestClass1();
        check.checkOut();

    }

} 
```

当我运行我的主程序时，我总是得到“是的，它可以工作”。请让我知道我错过了什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T19:49:29.017

问题出在 Eclipse 中。我从 3.7 升级到 3.7.2，编译器错误消失了。

我不知道这有什么影响的细节。如果有人有线索，请随时更新我的​​答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T07:38:34.743

所以我尝试做完整的代码来生成错误，但由于某种原因它没有给出错误。稍后会研究一下：

```
import java.util.LinkedList;

public abstract class DemoClass {

    public static void main(String[] args) {
        DemoClass dc = new DemoClassImpl();
        dc.createNewLivingAndDying().live();
        dc.killAll();
    }

    LinkedList<Dies> dying = new LinkedList<Dies>();

    public Lives createNewLivingAndDying() {
        Lives ab = newLivingAndDying(); // This is where I expected an error
        dying.add((Dies) ab);
        return ab;
    }

    public void killAll() {
        for (Dies dead : dying)
            dead.die();
    }

    protected abstract <E extends Lives & Dies> E newLivingAndDying();

}

class DemoClassImpl extends DemoClass {

    @SuppressWarnings("unchecked")
    @Override
    protected <E extends Lives & Dies> E newLivingAndDying() {
        return (E) new SomePrivateClass(); // This is what I don't understand
    }

}

interface Lives {
    public void live();
};

interface Dies { 
    public void die();
};

class SomePrivateClass implements Lives, Dies {

    @Override
    public void die() {
        System.out.println("Object Dies");
    }

    @Override
    public void live() {
        System.out.println("Object Lives");
    }
} 
```

此代码在我的家用计算机上编译并运行良好，但在我的工作计算机上给出错误。

```
Bound mismatch: The generic method newLivingAndDying() of type DemoClass is not applicable for the arguments (). The inferred type Lives is not a valid substitute for the bounded parameter <E extends Lives & Dies> 
```

在这一点上，我认为这是一个项目设置问题，但我不知道它是什么。JRE 1.6 两者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T04:52:29.330

你想做的只有当Java直接支持拦截类型时才有可能，那么你可以简单地

```
 HasText&IsWidget createNewDisplayWidget(); 
```

任何实现都必须返回一个作为 type 子类型的对象`HasText&IsWidget`；换句话说，返回的类型必须是两者的子类型`HasText`和`IsWidget`

不幸的是，Java 不支持这一点。

您尝试解决的问题可以从两个角度来理解：

1) 对类型变量的约束是对调用者的约束；调用者提供实际的类型参数，它必须满足约束。你真正想要的是对被调用者的限制。

2) 如果一个类型变量只出现在返回类型中，而没有出现在方法参数的类型中，这*通常*是问题的征兆。在 Java 中，由于邪恶的*类型擦除*，方法体无法知道运行时类型参数，因此它无法返回调用者所需的正确类型的值，除了一些琐碎的值，如`null`; 平凡返回值的另一个经典例子是

```
java.util.Collections  
    <T> Set<T> emptySet() 
```

# c# - asp.net mvc 4 异步控制器挂在无 TaskAsync 方法上

> ID：10524914
> 
> 赞同：1
> 
> 时间：2012-05-09T22:20:03.670
> 
> 标签：c#, asp.net-mvc-4, async-await

我正在使用带有 4.5 Beta 的 Visual Studio 2011 Beta。ASP.Net MVC 4 似乎存在一个错误，如果该方法返回一个无“TaskAsync”任务，它会挂起请求。

```
public class HomeController : Controller
{
    //
    // GET: /Home/

    public async Task<ActionResult> Test1()
    {
        string s = await new WebClient().DownloadStringTaskAsync("http://google.com");
        return Content("asdf");
    }

    public async Task<ActionResult> Test2()
    {
        string MyConString = ConfigurationManager.ConnectionStrings["Master"].ConnectionString;
        MySqlConnection connection = new MySqlConnection(MyConString);
        await connection.OpenAsync();
        connection.Close();
        return Content("asdf");
    }
} 
```

Test1 工作正常。一旦方法返回，Test2 就会挂起。我能够毫无错误地通过代码进行调试。

有谁知道这个的修复/解决方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T03:16:10.817

[MVC 4 Beta 的已知问题。](http://forums.asp.net/p/1778103/4880898.aspx/1?Re+Using+an+Async+Action+to+Run+Synchronous+Code)

简而言之，将以下内容添加到 ~/Web.config：

```
 <appSettings> 
    <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" /> 
  </appSettings> 
```

然后`await Task.Yield();`在您的操作方法中添加为第一行。（不要忘记*等待*！）

# .net - MonoCode 中是否有 MessageBox.Show() 等价物

> ID：10524919
> 
> 赞同：5
> 
> 时间：2012-05-09T22:21:12.320
> 
> 标签：.net, monomac

MonoMac 中是否有等价物`MessageBox.Show()`，还是我必须专门为此目的创建某种弹出类？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-10T16:46:00.887

您正在寻找 NSAlert，它几乎等同于 MessageBox。

您可以使用 NSAlert.RunModal() 来显示 NSAlert，如果您希望它在特定窗口上显示为工作表，则可以使用 NSAlert.BeginSheet()。

例如

```
var alert = new NSAlert {
    MessageText = "Hello, this is an alert!",
    AlertStyle = NSAlertStyle.Informational
};

alert.AddButton ("OK");
alert.AddButton ("Cancel");

var returnValue = alert.RunModal();
// returnValue will be 1000 for OK, 1001 for Cancel 
```

你可以在这里从 MonoMac 的角度来看看如何更多地使用它：

[https://github.com/picoe/Eto/blob/master/Source/Eto.Platform.Mac/Forms/MessageBoxHandler.cs](https://github.com/picoe/Eto/blob/master/Source/Eto.Platform.Mac/Forms/MessageBoxHandler.cs)

# hibernate - JPQL 选择具有最大值的记录

> ID：10524922
> 
> 赞同：4
> 
> 时间：2012-05-09T22:21:29.057
> 
> 标签：hibernate, jpa, hql, jpql

我正在尝试选择对特定列具有最大值的记录，这就是我到目前为止所拥有的：

```
select o from Order o 
    where o.orderNumber = :orderNumber
    and o.version =
        (select max(o.version) from Order o where o.orderNumber = :orderNumber) 
```

这似乎正在生成 SQL：

```
SELECT *
FROM   Order
WHERE  ordernumber = :orderNumber
       AND orderversion = (SELECT Max(orderversion)
                           FROM   order
                           WHERE  ordernumber = :orderNumber); 
```

我认为下面的 SQL 会更有效：

```
SELECT *
FROM   order ord
       INNER JOIN (SELECT ordernumber,
                          Max (version) AS version
                   FROM   order
                   WHERE  ordernumber = :ordernumber
                   GROUP  BY ordernumber) mx
         ON ord.ordernumber = mx.ordernumber
            AND ord.version = mx.version; 
```

无论如何我可以用JPQL表达这个吗？

（与在特定字段上选择具有最大值的记录相关的问题的大多数在线答案似乎暗示了我提出的上述 JPQL ......）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-10T05:45:51.763

不，不可能使用 HQL 生成上述 SQL 查询。[文档](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#queryhql-subqueries)说：

> 请注意，HQL 子查询只能出现在 select 或 where 子句中。

# android - Android：如何更改 ProgressDialog 的文本颜色？

> ID：10524925
> 
> 赞同：12
> 
> 时间：2012-05-09T22:21:48.010
> 
> 标签：android, progressdialog, android-theme

> **可能重复：**
> [透明、无边框 ProgressDialog](https://stackoverflow.com/questions/5291978/transparent-borderless-progressdialog)

我`Theme.Light`在我的应用程序中使用。使用`Progress Dialog`时，对话框颜色的文本是黑色的，并不令人鼓舞。

我试过这个只改变对话框的文本颜色，但没有奏效：

```
<style name="Theme.MyDialog" parent="@android:style/Theme.Dialog">
    <item name="android:windowNoTitle">true</item>
    <item name="android:windowContentOverlay">@null</item>
    <item name="android:textColor">#FFFFFF</item>
</style> 
```

我必须在任何 XML 中设置样式（MyDialog）吗？或者如何更改对话框的文本颜色？

提前致谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-29T15:32:46.453

在 ProgressDialog 构造函数中应用您的自定义主题：

```
ProgressDialog progressDialog = new ProgressDialog(this, R.style.Theme_MyDialog); 
```

也改变`<item name="android:textColorSecondary">*my_text_color*</item>`了这个主题。就我而言，它适用于模拟器和 Acer LicuidE，但三星 Galaxy Mini 不想为文本设置我的自定义颜色（（。

# python - OpenERP：fields.function的简单使用

> ID：10524929
> 
> 赞同：5
> 
> 时间：2012-05-09T22:22:02.627
> 
> 标签：python, openerp

我尝试对我的对象的字段进行一些计算并将它们存储到一个新字段中。我从一个使用fileds.function的简单示例开始，但是当我尝试登录openerp时，系统会出现用户或密码不正确的错误。

在我的课堂上，我添加了以下字段：

```
 'a' : fields.integer('A'),
      'b' : fields.integer('B'),
      'total' : fields.function(fnct, method=True, string='Tot',type='integer'), 
```

函数定义：

```
 def fnct(self, cr, uid, ids, fields, arg, context):

          x = {}

          for record in self.browse(cr, uid, ids):

              x[record.id] = record.a + record.b

          return x 
```

请问，谁能帮帮我？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T04:51:32.530

OpenERP 登录时归档的功能没有连接。

因此，您可能提供了错误的用户 ID 或密码。

**函数字段的主要用途是：**

根据其他字段自动计算字段的值。

即总计 = 字段 1 + 字段 2 + 字段 3

示例：'total'：fields.function(get_total, method=True, string='Total',type='integer'),

**如何定义函数：**

```
def get_total(self, cr, uid, ids, fields, arg, context):

    x={}

    for record in self.browse(cr, uid, ids):

        x[record.id]= record.field1 + record.field2 + record.field3

    return x 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T12:03:45.943

为了解决这个问题，我检查了一些意图，并且我的函数的定义应该在声明之前 fields 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-06T07:03:30.117

```
def fnct(self, cr, uid, ids, fields, arg, context):

    x = {}

    for record in self.browse(cr, uid, ids):

    x[record.id] = record.a - record.b

if x[record.id]<0:

    raise osv.except_osv(("Warning"),("You Cant Subtract %s ")%(record.a - record.b))

else:

return x

    "a":fields.integer('A'),
    "b":fields.integer('B'),

 "total":fields.function(fnct, method=True, string='Total',type='integer'), 
```

# java - 将图像序列化为字符串

> ID：10524933
> 
> 赞同：0
> 
> 时间：2012-05-09T22:22:33.153
> 
> 标签：java, android, serialization

好朋友们。

几个月来，我正在寻找一种方法来序列化存储在 imageView 中的图像。

此图像由相机拍摄并启动 ImageView，但问题 esque 需要序列化并将其传递给文本字符串。

我在谷歌和论坛上搜索了高低，但没有找到答案。

任何人都知道我该怎么做的一些方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T22:32:46.240

如果您想将二进制数据作为文本安全地移动，您可以对二进制数据进行 Base64 编码。如果您使用的是不包含 Base64 实用程序的 Android API，请参阅：[如何在 android 项目 api 3 (android 1.5) 中使用 Base64（自 api 8 (2.2) 起包含在 android 中）？](https://stackoverflow.com/questions/4836760/how-to-use-base64-included-in-android-since-api-8-2-2-in-a-android-project-a)

一旦您的二进制数据经过 Base64 编码，它就可以安全地通过只需要“纯”ascii 文本的系统。

请记住，您的位图数据将被解压缩，因此在 Base64 编码时会生成大量文本（Base64 编码导致表示数据所需的字节数增加 1/3）。为了缓解这种情况，您应该`Bitmap`在 Base64 编码之前压缩图像数据，使用类似：

```
try
{
    ByteArrayOutputStream baos = new ByteArrayOutputStream(8192);
    bitmap.compress(CompressFormat.JPEG, COMPRESSION_AMOUNT, baos);     
    byte[] compressedBytes = baos.toByteArray();
} 
```

您希望将 COMPRESSION_AMOUNT 设置为 50-80 之间的值，具体取决于您想要的尺寸和质量之间的权衡。

任何接收您的数据的客户端首先需要对 Base64 进行反编码，然后将生成的字节解析为 JPEG 数据以重新创建图像。

# objective-c - 运行具有不同日期的 NSRunLoop 会更改观察到的线程数

> ID：10524935
> 
> 赞同：1
> 
> 时间：2012-05-09T22:22:41.127
> 
> 标签：objective-c, nsdate, nsthread, nsrunloop

在编写应用程序时，我遇到了一些我没有预料到的奇怪行为，并将其提炼为以下内容：

我做了一个应用程序，其主要功能如下。在活动监视器中观察它时，它使用一个线程。

```
int main(int argc, const char * argv[])
{
    @autoreleasepool
    {
        while (YES)
        {
            [[NSRunLoop currentRunLoop] runMode:NSDefaultRunLoopMode
                                     beforeDate:[NSDate distantFuture]];
        }
    }

    return 0;
} 
```

如果我更改`[NSDate distantFuture]`为`[NSDate dateWithTimeIntervalSinceNow:1.0]`，则该应用程序使用 ~3 个线程。在检查了一下之后，似乎 a`dispatch_queue`已代表我隐式创建，这反过来又创建了一个线程池。

只是好奇：为什么会发生这种情况？怎么样`[NSDate dateWithTimeIntervalSinceNow:1.0]`导致运行循环创建一个`dispatch_queue`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:31:43.320

最有可能的是一个实现细节，没有什么可担心的......

一种可能的实现`distantFuture`是“永远做”，因此，不需要像带有特定日期的计时器那样的计时器。鉴于“计时器”实际上可能是`dispatch_after()`，这可能解释了队列。

或不。有趣的问题，但可能与您的应用完全无关。

# maxima - 在 Maxima 中堆叠矩阵的列

> ID：10524937
> 
> 赞同：5
> 
> 时间：2012-05-09T22:23:02.017
> 
> 标签：maxima

我想在 Maxima 中堆叠矩阵的列。

**例子**

```
b3: matrix(
 [1,0,0], 
 [-a21,1,0], 
 [-a31,-a32,1]
); 
```

我想知道如何堆叠这个矩阵的列。提前感谢您的帮助和时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T05:43:04.230

这是一种天真的方法：

```
c : transpose( b3 );
transpose( append( c[0], c[1], c[2] ) ); 
```

这是一种更通用的方法：

```
apply(append, map(lambda([r], transpose(b3)[r]), makelist(i,i,3))); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T12:47:49.343

甚至只是：

```
transpose(apply(append,args(transpose(b3)))); 
```

# c# - 为什么语句会在 Toad 中执行，而不是在我的代码中？

> ID：10524942
> 
> 赞同：0
> 
> 时间：2012-05-09T22:23:22.313
> 
> 标签：c#, sql, oracle, devart, dotconnect

这是我的代码：

```
private void UpdatePlatypus(String APetPlatypus) 
{
    oracleConnectionMainForm.Open();
    OracleCommand ocmd = new OracleCommand();
    ocmd.Connection = oracleConnectionMainForm;
    try 
    {
        ocmd.CommandText = @"<Update SQL statement that contains one parameter, like so: "WHERE DUCKBILLEDPLATYPUS = :PLATYPUS">)";
        ocmd.Parameters.Add("PLATYPUS", APetPlatypus);
        ocmd.ExecuteNonQuery();
    } 
    catch (Exception e) 
    {
        MessageBox.Show(String.Format("UpdatePlatypus failed with message {0}", e.Message));
    } 
    finally 
    {
        oracleConnectionMainForm.Close();
    }
    MessageBox.Show(String.Format("UpdatePlatypus to {0} succeeded", APetPlatypus));
} 
```

在 Toad 中，此 SQL 工作正常——我只需在 Toad SQL 编辑器中将“:PLATYPUS”替换为值“Phineas”，并且确实更新了记录，因为“27 个记录受影响”消息和随后的 SQL 选择返回更新的记录显示。

但是在我的 C# 应用程序中，它挂在对 ExecuteNonQuery() 的调用上......我从来没有看到任何消息 - 更新失败也没有成功 - 它只是挂在那里，像蓝精灵球一样漂浮在太空中在月球上。

## 更新

我为 dotConnect for Oracle 复制了一些旧的更新代码，但它仍然做同样的事情（挂在对 ExecuteNonQuery() 的调用上

```
private void UpdatePlatypus(String APetPlatypus) {

    OracleCommand ocmd;

    oracleConnectionMainForm.Open();
    String update = @"<same update sql as above>";
    ocmd = new OracleCommand(update, oracleConnectionMainForm);
    ocmd.CommandType = CommandType.Text;
    try {
        OracleParameter p_DuckbilledPlatypus =
        new OracleParameter("DIVISION", OracleDbType.NVarChar, ParameterDirection.Input);
        p_DuckbilledPlatypus.Value = APetPlatypus;
        ocmd.Parameters.Add(p_DuckbilledPlatypus);
        using (var transaction = oracleConnectionMainForm.BeginTransaction()) {
            try {
                ocmd.Transaction = transaction;
                ocmd.ExecuteNonQuery();
                transaction.Commit();
            } catch (Exception ex) {
                transaction.Rollback();
                throw;
            }
        }
    } catch (Exception e) {
        MessageBox.Show(String.Format("UpdatePlatypus failed with message {0}", e.Message));
    } finally {
        oracleConnectionMainForm.Close();
    }
    MessageBox.Show(String.Format("UpdatePlatypus to {0} succeeded", APetPlatypus));
} 
```

## 另一个更新

是否有可能 SQL 语句对于解析它的任何东西来说都太混乱了，即使它是有效的 SQL 也是如此？

同样，此查询在 Toad 中运行良好，但*相当*复杂：它包含两个嵌套的 Select 语句，如下所示：

```
Update <tableName> 
Set <col = value> 
where <col> in 
(select bla from bla where bla = :Platypus) 
and (bla is null or bla)
and bla in (select distinct bla from bla 
where bla = bla and bla is not null) 
```

## 另一个更新

如果我通过将子选择替换为参数（通过从那些 atmoic SQL 选择语句返回的结果提供）来简化查询，它会运行（并且几乎是即时的）。

所以，我猜嵌套的子选择对于解析更新语句的任何东西来说*都*太多了......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T05:31:27.927

执行 UPDATE 后，您是否在 TOAD 中点击了“提交”按钮？看起来它只是因为更新行上的锁而挂起。

顺便说一句：在 TOAD 中，菜单 Database -> Monitor -> Session Browser，找到您的“C#”或 TOAD oracle 会话并查看“Locks”选项卡，有两个子选项卡“Blocking locks”和“Blocked locks”。您的会话挂起时是否有任何条目？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T11:09:53.433

在您再次使用 CommandText`ExecuteNonQuery()`调用之后。甲骨文说它记录了它自动提交的文件，但实际上并非如此。只有在您关闭连接时才会提交。`ExecuteNonQuery``COMMIT`

# haskell - Haskell 中的行为树

> ID：10524947
> 
> 赞同：0
> 
> 时间：2012-05-09T22:23:37.697
> 
> 标签：haskell, behavior-tree

我听说 Haskell 中存在树实现的策略，但我还没有找到任何关于良好行为树替代方案的信息。

我的目标：给定一个表示状态的元组，将该元组提供给行为节点树的最佳模式是什么，每个行为节点都根据元组返回忙/错误/已完成/正在运行。该行为也可能改变元组（导致状态改变）。

嵌套节点可以根据其父节点的策略执行。例如，如果子节点返回“错误”，则不会评估更多子节点。另一种策略是即使返回错误状态也执行所有子节点。

我希望这是有道理的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T04:24:17.677

不幸的是，您似乎是一个很少有 Haskell 用户了解的领域的专家。关于这些技术，我所知道的只是我从非技术人员那里听到的关于不同业务规则引擎的讨论，所以我可能不太了解，但我认为值得一试，因为其他人都被难住了。

就前向链接推理系统，尤其是 Rete 算法而言，它们基本上已经可以正常工作了。他们在进行过程中迭代并向数据库添加更多知识，直到没有事情可做。如果您不允许任意效果，那将是一个简单的`Control.Monad.State`端口；如果你需要任意效果，你可以使用状态单子变换器，而不是中级/高级 Haskellers 会被吓倒的东西。[您可能会在 Haskell 网站上](http://www.haskell.org/haskellwiki/Applications_and_libraries/Compilers_and_interpreters#CHR_.28Constraint_Handling_Rules.29)找到可以使用的东西，但如果您最终自己这样做，那么*Real World Haskell*[的 Monad Transformers](http://book.realworldhaskell.org/read/monad-transformers.html)章节是必不可少的。

 *我对行为树一无所知，但在维基百科上一目了然，它们在我看来就像 Rete 算法加上后台的并发进程。如果这甚至接近正确，那么您必须决定是否需要并发性或并行性。如果您满足于“神奇地”更快地计算纯值（并且，通过扩展，所有内容都是用 Haskell 编写的），那么您可以`Control.Parallel`不费力气地使用这些东西，但您将无法（比如说) 查询哪些进程正在运行，哪些没有。如果您真的需要不同的可观察行为，那么您将需要`Control.Concurrent`它并且它不那么神奇，所以更多的簿记。Simon Marlow 写[了一个很好的教程](http://community.haskell.org/~simonmar/par-tutorial.pdf)关于你在那里的选择。你所描述的对我来说听起来比 Haskell 可以为你做的大多数很酷的东西都低级。如果您决定接受更高级别的接口，您可能会发现它更容易实现。我也不是这个主题的专家。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-03-28T00:49:50.397

我最近发布了关于 hackage 的 smarties 行为树库

[https://hackage.haskell.org/package/smarties](https://hackage.haskell.org/package/smarties)

我确信还有其他在 haskell 中实现 BT 的好方法，但我对这个设计非常满意。注意 smarties 仅支持 2 个节点状态 SUCCESS 和 FAIL。

针对您的问题：

> 将该元组提供给行为节点树的最佳模式是什么，每个行为节点都根据元组返回忙/错误/已完成/正在运行。该行为也可能改变元组（导致状态改变）。

smarties 的主要类型是一个 monad，它表示具有内部感知（状态）的节点序列。从这个意义上说，它与 State monad 非常相似。还有一些接口可以强制执行不可变的感知。

> 嵌套节点可以根据其父节点的策略执行。例如，如果子节点返回“错误”，则不会评估更多子节点。另一种策略是即使返回错误状态也执行所有子节点。

每当它遇到 FAIL 节点时，它都会将状态和最终输出短路。然而，它仍然运行剩余的节点来获取它的一元返回值，这对于在 BT 中组合逻辑非常有用。

因此，选择器（代表分支逻辑）是通过传入节点单子列表并采用第一个具有成功状态的单子来实现的。

Monadic 语法在行为树中非常强大。您在树中的某个点读取状态，然后在树中使用它的值。这使得节点更容易组合！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T00:37:32.103

您的问题我们都有些困惑，当您说“元组”时，我可能不明白您的意思，而是在黑暗中拍摄：

我编写了一个名为 simple-actors 的小型库，用于[Actor Model concurrency](http://en.wikipedia.org/wiki/Actor_model)。如果您可以想象通过“演员”在并发“频道”上侦听并相互交流需要完成什么，那么您可能有兴趣看一下。

此处文档的顶部是一种[演员二叉搜索树](http://hackage.haskell.org/packages/archive/simple-actors/0.1.0/doc/html/Control-Concurrent-Actors.html)的示例（您的问题让我想到了这一点，抱歉，如果这一切都离题了）。

**编辑：我应该提到我发现**[行为树上](http://en.wikipedia.org/wiki/Behavior_Trees)的维基百科页面完全难以理解；也许熟悉企业术语的人可以提供帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-11T08:59:43.973

由于没有找到 BT 实现，我自己在 Haskell 中开始了某种 BT 实现，如下所述：

[http://www.brainific.com/blog/2015/09/twisting-your-trees/](http://www.brainific.com/blog/2015/09/twisting-your-trees/)

并存储在这里：

[https://bitbucket.org/brainific/action-fw/src](https://bitbucket.org/brainific/action-fw/src)

这里有具体的测试：

[https://bitbucket.org/brainific/action-fw/src/a6081b740dc4b8258f67f49df473458737fc4240/test/BehaviourTrees21Test.hs?at=master&fileviewer=file-view-default](https://bitbucket.org/brainific/action-fw/src/a6081b740dc4b8258f67f49df473458737fc4240/test/BehaviourTrees21Test.hs?at=master&fileviewer=file-view-default)

请注意标准行业 BT 的一些不同功能：

*   这些树是事件驱动的，在某种程度上更像是一棵事件处理过程树，而不是更常见的轮询树；
*   事件类型是通用的：成功/失败/运行状态只是另一种事件类型，由转换函数处理，因此您实际上可以轻松混合和匹配 BT 节点和 FSM 节点；
*   事件节点不是静态的，而是在运行时从某些 Env 数据类型生成的（我没有进行深入的性能检查，但希望 Haskell RTS 在这里应该有所帮助）；
*   节点是通过代码指定的，因此它们可以比平时更奇特（其中一个可以产生计划过程并等待“继续”开始，在执行计划时中断默认的 BT 运行）；
*   尚未实现黑板或代理间消息（尽管添加地图和频道应该相当简单）。

使用 Haskell 有一些问题（例如，我仍然不能弯曲类型系统来表示处理事件类型 T1 的树只能包含触发事件类型 T1 的子树），但可以提供一些具有很强表达能力的功能（例如循环作为无限懒惰列表）。

请注意，它仍然是相当 alpha 甚至是 pre-alpha！我开始将它与 The Dark Mod ( [http://thedarkmod.com](http://thedarkmod.com) ) 集成，我希望在其中验证我的假设。如果您最终感兴趣，请随时发送邮件。*

# sql - ORDER BY 是否应该影响返回 SELECT 查询的行数？

> ID：10524949
> 
> 赞同：5
> 
> 时间：2012-05-09T22:23:55.810
> 
> 标签：sql, ingres

我正在经历规范化一个可怕的遗留数据库的痛苦，并且发现了我认为是 DBMS 的一个错误。

此查询按我的预期返回结果：

```
SELECT DISTINCT RIGHT(SQUEEZE(thing_id), 2) AS thing_id, TRIM(thing_name)
FROM thing
ORDER BY thing_id, thing_name;
(16 rows) 
```

第一次运行查询时，我无意中在 ORDER BY 中使用了错误的列，如下所示：

```
SELECT DISTINCT RIGHT(SQUEEZE(thing_id), 2) AS thing_id, TRIM(thing_name)
FROM thing
ORDER BY thing_name, location;
(33 rows) 
```

请注意，唯一要更改的是 ORDER BY，返回的行数从 16 增加到 33。它给出的结果不是查询指定的 DISTINCT。

我相信这是一个彻头彻尾的错误，但一位同事说这是正常的，因为当我们按“位置”订购时，它会被选择一个不可见的包含在结果中。

ORDER BY 是否应该影响 SELECT 查询中返回的行数？

编辑：我让另一个人查看查询并将查询复制到两个单独的文件中，然后对它们运行 diff 命令。100% 确定这两个查询之间的唯一区别是 ORDER BY 中列出的列。

更新：Ingres 自发布补丁 14301 以来已修复错误：“错误 126640 (GENERIC) 使用 order-by 表达式和 distinct 聚合的查询返回的行数比预期的多。order-by 表达式中的列不在选择列表中。”

即有问题的查询现在将导致错误，因为结果不正确。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T23:10:30.900

我看到的问题是第二个查询中的列 ( `location`)`ORDER BY`未包含在`SELECT DISTINCT`列表中。实际上这两个查询都是无效的 SQL（尽管 Ingres 似乎允许它们）。我将它们（所以第一个可以）简化为：

查询一（有效 SQL）：

```
SELECT DISTINCT 
      thing_id 
    , thing_name
FROM thing
ORDER BY thing_id
       , thing_name ; 
```

查询二（无效的SQL，应该产生错误）：

```
SELECT DISTINCT 
      thing_id 
    , thing_name
FROM thing
ORDER BY thing_name
       , location; 
```

为什么要给出错误？因为`ORDER BY`应该在`SELECT`和之后处理`DISTINCT`。因此，原始表中的两行或多行可能具有相同`thing_id`但`thing_name`不同的`location`. 这些行将折叠成一个。因此，没有用于排序的位置值。即使保留了（隐藏的位置值），它应该是众多中的哪一个？

`SELECT DISTINCT`可以用`SELECT ALL`and重写查询`GROUP BY`（在这种情况下也无效）：

```
SELECT ALL
      thing_id 
    , thing_name
FROM thing
GROUP BY thing_id 
       , thing_name
ORDER BY thing_name
       , location; 
```

上述（查询 2）实际上确实在 PostgreSQL、SQL-Server 和 Oracle 中产生了错误。[在SQL-Fiddle](http://sqlfiddle.com/#!1/1857b/1)中测试它

* * *

从 Ingres 中第二个查询返回的错误行数来看，我猜幕后发生的事情是他`location`被秘密保存在`SELECT`列表中，因此可以用于`ORDER BY`然后删除。`DISTINCT`这与非标准越野车行为的结果相结合：

```
SELECT DISTINCT 
      thing_id 
    , thing_name
   (, location         --- hidden column) 
FROM thing
ORDER BY thing_name
       , location; 
```

您可以将其称为错误或功能，这没关系，只要您知道它实际上不应该首先被允许。

似乎一年前在 Actian 论坛上报告了一个类似的问题：[DISTINCT + ORDER BY](http://community.actian.com/forum/vectorwise-discussion/13345-problem-distinct-order-random.html)的问题，据说已经修复。不知道他们指的是哪个版本，或者它是否已实际修复（以及“修复”的含义）。

* * *

如果您希望查询有效并按预期运行，则可以使用如下所示：

```
SELECT
      RIGHT(SQUEEZE(thing_id), 2)  AS squeezed_thing_id
    , TRIM(thing_name)             AS trimmed_thing_name 
    , MIN(location)                AS a_location            --- or MAX()
FROM 
    thing
GROUP BY 
      RIGHT(SQUEEZE(thing_id), 2)
    , TRIM(thing_name)     
ORDER BY 
      trimmed_thing_name
    , a_location ; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-09T22:26:25.443

不，*不*`order by`应该影响返回的行数。

 *如果你说的是真的，那将是一个非常奇怪和根本的错误。在给 Ingres 人发电子邮件之前，我会三倍（然后四倍）检查两个查询的返回列，以*确保*这不是一个简单的用户错误。

***编辑***

实际上，我也会尝试在备份数据库上运行查询。如果您没有可用的备份，则可以通过复制您拥有的数据库（如果 Ingres 支持）而侥幸成功。

我之前曾在硬件故障的机器上遇到过查询返回无意义的结果。这肯定是你想要检查的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-09T22:27:09.643

由于 SQL 中的操作顺序是：

```
FROM > WHERE > GROUP BY > HAVING > SELECT > ORDER BY 
```

这似乎确实是一个错误。它是哪个 DBMS？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-19T09:42:25.363

如果您添加`location`到第一个查询，那么两者都将返回相同数量的行。第二个查询返回更多行的原因是因为在该查询中您没有选择`location`。如前所述，一些 RDBMS 不允许这样做，而 Ingres 允许。可能是因为*SQL 标准没有禁止它*？*

# javascript - 将数据从子 Javascript 页面传递到父 Javascript 页面

> ID：10524951
> 
> 赞同：0
> 
> 时间：2012-05-09T22:24:14.673
> 
> 标签：javascript, parent-child, data-transfer

我正在使用 Javascript。我正在使用警报从用户那里获取密码。但是，您可能知道，警报不会将密码从其他“肩冲浪”中屏蔽掉。为了解决这个问题，我创建了一个页面，该页面只允许用户输入从父 javascript 页面打开的密码。问题是 javascript 在执行更多 javascript 指令之前不会等待用户输入密码。我的问题是，如何让我的 javascript 在执行下一条指令之前等待接收来自用户的信息？

下面的父页面是我正在使用的示例。由于我在网上阅读到您无法屏蔽 window.prompt 输入，因此决定尝试打开一个新窗口并让用户将其输入到 html 表单中。这是父级所需的最低限度的代码（真正的父级页面要长得多，与问题无关）。父页面：

```
<html>
    <head>
    <script language="javascript">
        function start()
        {
            document.write("here");
            var w = window.open('password.html','newWindow','width=550,height=170,left=150,top=200,toolbar=no,resizable=false');
            var password = "holder value";

document.write(password);
        }
    </script>
        <title>
            Parent Window
        </title>
    </head>
    <body onload="start()">
    </body>
</html> 
```

子页面：

```
<html>  
    <head>
        <title>This is for the user to input their password</title>
        <script language="javascript">
            function Parent()
            {
console.log("working");
                //opener.document.form.parent_name.value =  document.frm.child_name.value;
//              opener.document.form.parent_name.value = document.Input.pwd.value;
                opener.document.password= document.Input.pwd.value;
                self.close();
            }
        </script>
    </head>

    <body>
        <form name="Input" method="post" action="">
            <input type="password" name="pwd">
            <input type="button" value="Submit" onClick="Parent()">     
        </form>
    </body>
</html> 
```

# jquery - 尝试用新数据重新加载/刷新动态树

> ID：10524952
> 
> 赞同：4
> 
> 时间：2012-05-09T22:24:14.687
> 
> 标签：jquery, dynatree

我已经看到了这个[问题](https://stackoverflow.com/questions/7318116/how-to-reload-refresh-reinit-dynatree)，并且我已经尝试了给出的解决方案（使用 tree.reload()），但它对我不起作用。我有一个树，它使用 initAjax() 在准备好的文档上初始化，我正在尝试使用不同的值在选择输入的更改时重新加载树。基本上是这样的：

```
$(document).ready(function(){
    // global variables
    var myVal = 'initial value';

    // initialize tree
    $('#tree').dynatree({
        persist: false,
        initAjax: {
            url: 'getMyStuff.cfc',
            data: { myParam: myVal }
        },
        ... more params
    )};

    // select change handler
    $('#mySelect).change(function(){
        var tree = $('#tree').dynatree('getTree');
        myVal = $(this).find('option:selected').val();
        tree.reload();           
    )};
)}; 
```

问题是树不断重新加载相同的参数......我可以在控制台的网络选项卡中看到每次发送的参数都是相同的，即使我已经验证我的目标是正确的元素并在更改时获得正确的值。

我试过改变变量的范围，我试过把 dynatree 选项放在一个单独的变量中，我试过打电话

```
$('#tree').children().remove();
$('#tree').dynatree(treeoptions); 
```

在 change() 函数中，我尝试调用 tree.initialize()（是的，我知道它是一个构造函数），我尝试过 tree.redraw()，我尝试在调用 reload( ），我被困住了。

有任何想法吗？

此时，我决定唯一要做的就是将树初始化放入一个函数中，并在更改选择选项时，将树（包括其父 div）吹走并重建它。如果真的没有其他方法可以用新数据重建树，我会感到惊讶，这与我使用其他小部件的经验背道而驰。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-11T06:23:19.067

这个问题与此重复： [如何重新加载/刷新/重新初始化 DynaTree？](https://stackoverflow.com/questions/7318116/how-to-reload-refresh-reinit-dynatree)

我的解决方案不需要像 empty() 和 destroy() 等这样的弯路。想一想：创建 Dynatree 时，您指定它必须使用的设置字典。然而，由于这是一个配置字典，即使某些参数是变量并且由于点击等而发生变化，它也不会被重新评估。所以为了解决这个问题并避免像删除 DOM 和重新创建它这样的昂贵操作，我们按照我认为 Dynatree 开发人员的方式进行操作有这个意图（但在 AJAX/JSON 示例中没有如此清楚地记录）：

```
 //The HTML:
      <input name="filter" id="checkbox" type="checkbox" value="X">Checkme<br>
      <label id="mylabel"></label>

  $("#checkbox").click(function() {
    $("#mylabel").text($(this).is(":checked"))
    $("#tree").dynatree("option", "initAjax", {
             url: "myurl/myphp.php",
             data: {
                myparameter: $("#checkbox").is(":checked").toString()
             }
     });

    $("#tree").dynatree("getTree").reload();
  }); 
```

此示例在每次单击按钮时设置 #tree 上的配置，然后重新加载树。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-14T15:20:03.727

我在 dynatree google group 上找到了这个。这个对我有用。

```
$('.tree').dynatree('destroy'); 
$('.tree').empty(); 
```

这是[原始链接](https://groups.google.com/forum/?fromgroups#!topic/dynatree/iLnaTtLSeSY)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-05T02:04:16.617

我想用默认的 json 初始化块，然后单击一个按钮，我想从服务器刷新它，这就是我所做的。最初，var treeData = [{title: "Dynamic Tree Demo",isFolder : false, tooltip: “这里，是你的动态树！” }];

```
jQuery(document).ready(function() {
    initReqActions(treeData);   
});

initReqActions= function(myTree){
    $("#dynaTree").dynatree({
        checkbox: false,            
        selectMode: 2,
         // create IDs for HTML elements that are generated
          generateIds: true, 
          cookie: {
              expires :-1  
          },    
        children: myTree,           
        onQuerySelect: function(select, node) {
            if( node.data.isFolder )
                return false;
        },
        onSelect: function(select, node) {
            // Display list of selected nodes
            var selNodes = node.tree.getSelectedNodes();
            // convert to title/key array
            //var selKeys = $.map(selNodes, function(node){
            //     return "[" + node.data.key + "]: '" + node.data.title + "'";
            //});
            //$("#echoSelection4").text(selKeys.join(", "));
        },
        onClick: function(node, event) {
            if( ! node.data.isFolder )
                node.toggleSelect();
        },
        onDblClick: function(node, event) {
            node.toggleExpand();
        },
        onKeydown: function(node, event) {
            if( event.which == 32 ) {
                node.toggleSelect();
                return false;
            }
        }

    });
} 
```

然后当一个按钮被点击

```
 jQuery(document).ready(function() {
      $("#RefreshButton").click(function() {           
       $("#dynaTree").dynatree("option", "initAjax", {
          url: "refreshTree",
          dataType: "json"

       });

      $("#dynaTree").dynatree("option", "children", null);          
      $("#dynaTree").dynatree("getTree").reload();
     });

    }); 
```

# regex - 匹配 url 的模式

> ID：10524953
> 
> 赞同：0
> 
> 时间：2012-05-09T22:24:17.773
> 
> 标签：regex, routes

我有以下模式： www.domain.com:8051/(. *** )/(.*)

以及以下两个网址：

www.domain.com:8051/first/second

www.domain.com:8051/first/second/third/fourth

两个网址都匹配。但我只想匹配第一个。我必须怎么做才能将“/”排除为要匹配的字符？

谢谢，琼。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:30:18.643

为了排除字符，您应该`[^<characters to exclude>]`在您的情况下使用：

```
www.domain.com:8051/([^/]*)/([^/]*) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:31:34.420

当您需要使用不情愿的量词时，您正在使用贪婪的正则表达式量词。

而不是`.*`，使用`.*?`. 当我第一次学习如何使用正则表达式时，我发现[这个备忘单非常有用。](http://www.omicentral.com/cheatsheets/JavaRegularExpressionsCheatSheet.pdf)

`www.domain.com:8051/(.*?)/(.*?)`

编辑：在弄乱了模式之后，我无法想出一个有效的模式，但你可以检查是否找到了上述模式，而以下模式不是：`www.domain.com:8051/(.*?)/(.*?)/$`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-09T22:36:55.157

如果这些是唯一的模式，为什么不在“/”上拆分并检查长度？

您仍然可以访问这些组件。

# java - 使用 PowerMock、Mockito 和 TestNG 模拟公共方法中使用的私有方法

> ID：10524958
> 
> 赞同：4
> 
> 时间：2012-05-09T22:24:42.047
> 
> 标签：java, testng, mockito, powermock

我想为我的课程编写单元测试。这个类有一个公共方法，在公共方法内部有对同一个类的私有方法的调用。我想模拟对那些私有方法的调用。该类与此类似：

```
public class SomeClass {
    public int somePublicMethod(int num) {
        int num2 = somePrivateMethod1(num);
        int num3 = somePrivateMethod2(num);

        return num2 + num3;
    }

    private int somePrivateMethod1(int num) {
        return 2*num;
    }

    private int somePrivateMethod2(int num) {
        return 3*num;
    }
} 
```

对于我的单元测试，我正在尝试将 PowerMock 与 Mockito 和 TestNG 一起使用。这是我在测试 somePublicMethod 的测试中的尝试：

```
import static org.powermock.api.mockito.PowerMockito.doReturn;
import static org.powermock.api.mockito.PowerMockito.spy;

import org.powermock.core.classloader.annotations.PrepareForTest;
import org.testng.Assert;
import org.testng.annotations.Test;

@PrepareForTest(SomeClass.class)
public class SomeClassTest {

    @Test
    public void testSomePublicMethod() throws Exception {
        int num = 4;        

        SomeClass someClassSpy = spy(new SomeClass());

        doReturn(8).when(someClassSpy, "somePrivateMethod1", num);
        doReturn(12).when(someClassSpy, "somePrivateMethod2", num);

        int result = someClassSpy.somePublicMethod(num);

        Assert.assertEquals(result, 20);
    }
} 
```

当我运行这个测试时，我得到一个异常和一些提示：

```
FAILED: testSomePublicMethod
org.mockito.exceptions.misusing.UnfinishedStubbingException: 
Unfinished stubbing detected here:
-> at org.powermock.api.mockito.internal.PowerMockitoCore.doAnswer(PowerMockitoCore.java:31)

E.g. thenReturn() may be missing.
Examples of correct stubbing:
    when(mock.isOk()).thenReturn(true);
    when(mock.isOk()).thenThrow(exception);
    doThrow(exception).when(mock).someVoidMethod();
Hints:
 1\. missing thenReturn()
 2\. you are trying to stub a final method, you naughty developer! 
```

我在网上查看了一些示例，但我没有找到一个专门使用 PowerMock 和 Mockito 和 TestNG 来做我想做的事。有人可以给我一些关于我可以做些什么不同的指示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T12:34:58.660

我不认为这是 PowerMock 的问题。看起来它应该可以正常工作。我想知道 TestNG 与 PowerMock 交互是否有问题？

我没有使用 TestNG 的经验，所以我尝试在 JUnit 中运行该类。 `SomeClass`保持原样，`SomeClassTest`进行了最低限度的修改以使用 JUnit：

```
import static org.powermock.api.mockito.PowerMockito.*;

import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.powermock.core.classloader.annotations.PrepareForTest;
import org.powermock.modules.junit4.PowerMockRunner;

@RunWith(PowerMockRunner.class)
@PrepareForTest(SomeClass.class)
public class SomeClassTest {

    @Test
    public void testSomePublicMethod() throws Exception {
        final int num = 4;

        final SomeClass someClassSpy = spy(new SomeClass());

        doReturn(8).when(someClassSpy, "somePrivateMethod1", num);
        doReturn(12).when(someClassSpy, "somePrivateMethod2", num);

        final int result = someClassSpy.somePublicMethod(num);

        Assert.assertEquals(result, 20);
    }
} 
```

测试通过。

您是否需要像 JUnit 一样指定`PowerMockRunner.class`using`@RunWIth`或类似的注解？如果我删除该注释，我会收到您发布的相同错误消息。

**编辑：**

根据此链接： [http ://code.google.com/p/powermock/wiki/TestNG_usage](http://code.google.com/p/powermock/wiki/TestNG_usage)

您需要告诉 TestNG 使用 PowerMock 对象工厂。要以编程方式执行此操作，请将这样的方法添加到您的测试类中：

```
@ObjectFactory
public IObjectFactory getObjectFactory() {
    return new org.powermock.modules.testng.PowerMockObjectFactory();
} 
```

或者为了安全起见，您还可以从 PowerMockTestCase 扩展：

```
@PrepareForTest(SomeClass.class)
public class SomeClassTest extends PowerMockTestCase {
   //...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T09:38:16.457

你不能那样做。您是否尝试使用反射？

通过使用反射，您可以通过模拟调用方法来模拟私有方法，或者更简单：您可以将其更改为临时公共，然后在测试之后（可能在拆解中） - 您可以将其更改回私有。

希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T09:33:28.090

我认为你在这里达到了 Mockito 限制。在类似的情况下，我使用 Powermock 方法替换，或者，将目标方法声明为受保护并在构造测试类实例时覆盖它。希望有帮助。

# c++ - 获取模板中已经延迟的类型

> ID：10524959
> 
> 赞同：1
> 
> 时间：2012-05-09T22:24:44.153
> 
> 标签：c++, templates, template-meta-programming

我创建了一个模板类，它工作正常：

（我正在使用 openCV 库，所以我有 cv::Mat 类型的矩阵）

```
template < class T, T V >
class MatFactory
{

  private:

    const T static VALUE = V;

  public:

    void create(/* some args */)
    {
      cv::Mat M;

      // filling the matrice with values V of type T

      // loop i,j
      M.at<T>(i,j) = V;

      return M;
    }
}; 
```

但稍后在代码中，我需要在某些索引 (i,j) 处获取矩阵 M 的元素。但是我怎么知道 T 型呢？

```
MatFactory<int, 1> MF;

// getting object
cv::Mat m = MF.create();

// then I need to get some value (with `.at<>` method)
int x = m.at<int>(2,3);

// But, it means I should every time explicitly declare INT type
// Can I somehow get the type, that was passed to template factory
// Than i'll write something like this:
T x = m.at<T>(2,3);

// How to get T from the deferred template? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T22:51:35.867

只需将`type`成员添加到您的`MatFactory`：

```
template <typename T, T V>
class MatFactory {
public:
    typedef T type;
   ...
}; 
```

请注意，非类型模板参数相当有限。特别是，浮点类型是不允许的（想想这可能已经被 C++2011 改变了）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T23:08:12.697

> 如果您知道数组元素类型（可以使用方法 Mat::type() 检索），您可以访问二维数组的元素 M_{ij}：
> 
> > `M.at<double>(i,j) += 1.f;`
> 
> 假设 M 是一个双精度浮点数组。对于不同数量的维度，该方法有几种变体。

[http://docs.opencv.org/modules/core/doc/basic_structures.html#mat](http://docs.opencv.org/modules/core/doc/basic_structures.html#mat)

# javascript - Javascript 切换图像边框在 Firefox 中有效，但在 IE 中无效

> ID：10524961
> 
> 赞同：1
> 
> 时间：2012-05-09T22:25:00.410
> 
> 标签：javascript, internet-explorer, firefox, compatibility

我下面的代码在 Firefox 中可以切换图像的边框，但在 IE 中不起作用。任何想法为什么？在 IE 中，第一次单击会添加边框，但第二次单击不会再次删除边框。

谢谢，莱斯利

```
<html>
<head>

<script type="text/javascript">

window.onload=function(){

    for(var i = 0; i < document.images.length; i++){
        document.images[i].onclick=function(){
        if(this.style.border == '2px solid red')
        {
            this.style.border='';
        }
        else this.style.border='2px solid red';
        }
    }

}

</script>

</head>
<body>
    <div>
        <img src="Cat.jpg" width="250"/>
        <img src="Dog.jpg" width="250"/>
        <img src="Fish.jpg" width="250"/>
    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-09T22:48:51.377

你已经使用`if(this.style.border == '2px solid red')`了，它对于 FF 是正确的，但 IE 会返回`red 2px solid`，所以如果条件与 IE 不匹配。你可以试试这个

```
window.onload=function(){
for(var i = 0; i < document.images.length; i++)
{
    document.images[i].onclick=function(){
        if(this.style.borderColor == 'red' && this.style.borderStyle=='solid' && this.style.borderWidth=='2px')
        {
            this.style.border='none';
        } 
        else this.style.border='2px solid red';
      }
    }
} 
```

[**演示。**](http://jsfiddle.net/heera/RK2Gb/5/)

**替代方案：** [**DEMO**](http://jsfiddle.net/heera/RK2Gb/4/) **或** [**DEMO**](http://jsfiddle.net/heera/RK2Gb/7/)（如果你有其他课程更好）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T22:26:48.740

[http://jsfiddle.net/BPPvv/1/](http://jsfiddle.net/BPPvv/1/)

注意返回的差异。这可能只是一个 IE 问题 - 您应该使用类分配而不是字符串比较

```
for(var i = 0; i < document.images.length; i++)
       {
        alert(this.style.border);
        document.images[i].onclick=function(){
        if(this.style.border == '2px solid red')
         {
            this.style.border='';
         }
        else 
         { // missed this bracket AND shorthand for borders should be
         this.style.border='2px solid red';
         }
       }

    }​ 
```

# iphone - 就像从控制器到 Three20 一样？

> ID：10524973
> 
> 赞同：-3
> 
> 时间：2012-05-09T22:26:14.980
> 
> 标签：iphone, objective-c, ios

如何实现按钮的这种刺痛Three20并更改Three20的xib？

```
if (!self.albumController) {
    self.albumController = [[AlThumbsViewController alloc] initWithNibName:@"" bundle:[NSBundle mainBundle]];
 //I put in initWithNibName?
}

[self.navigationController pushViewController:self.albumController animated:YES];
[self.albumController release];
self.albumController = nil; 
```

没办法就是生成了三个xib 我有一个例子但是我不是很懂。谢谢大家

* * *

如何在没有看到另一个“.xib”的情况下从一个视图移动到另一个视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:01:08.797

我认为您只想构建一个新的控制器。

`self.albumController = [[AlThumbsViewController alloc] init];`

您需要确保 AlThumbsViewController 支持这种类型的构造。

# asp.net - ASP.NET MVC3 无法访问字体（静态内容）

> ID：10524976
> 
> 赞同：4
> 
> 时间：2012-05-09T22:26:36.510
> 
> 标签：asp.net, css, asp.net-mvc-3, webfonts

我认为 MVC3 有一个奇怪的问题。我的 css 文件包含一个用于 IE 的 @font-face，如下所示：

```
@font-face {
    font-family: AvantGardeNormal;
    src: url('fontname.eot');
} 
```

它在本地（在我的机器上）运行良好，但是当我发布到服务器（Azure）时，我收到了这个错误：（就像它试图像控制器中的操作一样访问字体文件）错误（System.Web.HttpException ): 路径“/Content/fontname.eot”的控制器未找到或未实现 IController。

当然，字体不会加载。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T14:38:29.583

将每个字体文件的“构建操作”设置为“内容”，否则将不会部署它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T16:09:07.753

有几种方法可以验证参考、内容或数据文件是否是部署的一部分。大多数常见的描述如下：

**首先**，您可以检查引用的属性或静态内容，以查看“Copy Local”是否设置为“True”。

**其次**，您可以解压缩 CSPKG 文件（如果需要，将其重命名为 zip），然后解压缩 CSPKG 中的 CSSX 文件。解压缩 CSSX 文件后，您可以看到那里可用的内容，因为这是部署后您的应用程序可用的内容。

**第三**，如果您可以通过 RDP 访问您的 Azure VM，您只需使用您的 RD 凭据登录并查找驱动器 E: 和文件夹 Approot\ 文件夹以获取所有引用和静态内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-06T10:25:23.277

本周我遇到了同样的问题，将带有可下载字体的 MVC 应用程序部署到运行 IIS 的服务器上。

为了让 IIS 返回正确的内容，它使用一个名为 MimeTypes 的查找表。基本上是文件扩展名查找。您必须将 .eot 文件扩展名添加到 IIS 或 web.config 中的 Mimetypes

```
<system.webServer>
   <staticContent>
     <remove fileExtension=".eot" />
     <mimeMap fileExtension=".eot" mimeType="application/application/vnd.ms-fontobject" />
   </staticContent>    
</system.webServer> 
```

起初对我来说并不明显的第二部分是在您的项目中添加一个 httpHandler 以根据 http 请求提供字体文件。

```
<system.web>
   <httpHandlers>
     <add verb="*" path="*.eot" type="System.Web.StaticFileHandler" />
   </httpHandlers>    
</system.web> 
```

并非所有浏览器都支持 eot 字体。 [关联](https://stackoverflow.com/questions/9654166/font-face-how-to-make-it-work-on-all-browsers)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T22:34:57.243

当我使用 ELMAH 捕获这些异常时，根据我的经验，100% 的时间是因为我的部署没有部署字体文件。您应该仔细检查服务器上是否存在该文件。

# html - HTML5/SVG：preserveAspectRatio "none" 在 Firefox 中不起作用

> ID：10524978
> 
> 赞同：4
> 
> 时间：2012-05-09T22:26:39.587
> 
> 标签：html, svg

我想使用 SVG 图像作为背景图像 html div 元素。SVG 应该相应地拉伸到它嵌入的 div。这在 Google Chrome 中效果很好，但在 Firefox 中，SVG 在调整大小时会保持其宽度/高度比并且不会被拉伸。我正在使用`preserverAspectRatio = "none"`.

SVG 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
xmlns="http://www.w3.org/2000/svg"
version="1.1" preserveAspectRatio="none" viewBox="0 0 180 95">
<g
 id="layer1">
<path
   d="m 1.0714286,31.469326 140.0000014,0 0,-30.0000009 30,40.0000009 -30,40 0,-30 -140.0000014,0 z"
   id="path3015"
   style="fill:#4f81bd; fill-opacity:1; stroke:#385d8a; stroke-width:3; stroke-linecap:butt; stroke-linejoin:miter; stroke-opacity:1" />
</g>
</svg> 
```

HTML 看起来像这样：

```
<div style="
      width: 250px; 
      height: 200px; 
      background-image:url(file.svg); 
      background-repeat:no-repeat;">
          test
 </div> 
```

在 Chrome 中，我可以更改 div 元素的宽度/高度，并且 SVG 图像在不考虑原始宽度/高度比的情况下被拉伸。这种行为是有意的。在 Firefox 中，它只是调整大小并保持其原始比例。你知道我怎么能改变这个吗？谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-18T06:31:29.143

尝试添加`background-size: 100% 100%;`到您的“风格” `div`（它适用于我）。

# android - 为什么不可用的声音列表总是空的？

> ID：10524980
> 
> 赞同：1
> 
> 时间：2012-05-09T22:26:49.257
> 
> 标签：android, text-to-speech

Android 使应用程序能够查询平台以获取语言文件的可用性：只需实例化下面的意图并通过使用`startActivityForResult`方法将其以异步请求的形式发送。

```
Intent checkIntent = new Intent();
checkIntent.setAction(TextToSpeech.Engine.ACTION_CHECK_TTS_DATA);
startActivityForResult(checkIntent, TTS_CHECK_DATA_REQUEST_CODE); 
```

调用方法返回上述请求的结果`onActivityResult`：第二个参数是代表上述请求成功或失败的值，第三个参数包含一些附加数据。在附加数据中，有两个列表（可能为空）：

*   可用的声音；

    ```
    ArrayList<String> availableVoices = data.getStringArrayListExtra(TextToSpeech.Engine.EXTRA_AVAILABLE_VOICES);
    Log.i(LOG_TAG, String.format("Available voices: %s %s", availableVoices.size(), availableVoices.toString())); 
    ```

*   不可用的声音。

    ```
    ArrayList<String> unavailableVoices = data.getStringArrayListExtra(TextToSpeech.Engine.EXTRA_UNAVAILABLE_VOICES);
    Log.i(LOG_TAG, String.format("Unavailable voices: %s %s", unavailableVoices.size(), unavailableVoices.toString())); 
    ```

对于如上所示的简单请求，不可用语音列表是空的，而可用语音阵列则填充了系统上安装的所有语音。

如果添加`TextToSpeech.Engine.EXTRA_CHECK_VOICE_DATA_FOR`额外内容，行为会发生变化：根据文档，此额外内容用于向 TTS 引擎提供指令以检查某些特定声音。这是源代码的示例：

```
ArrayList<String> checkVoiceDataFor = new ArrayList<String>(3);
checkVoiceDataFor.add("ita-ITA");   // installed on emulator
checkVoiceDataFor.add("eng-USA-female");  // not installed
checkVoiceDataFor.add("eng-USA");   // installed on emulator
Intent checkIntent = new Intent();
checkIntent.setAction(TextToSpeech.Engine.ACTION_CHECK_TTS_DATA);
checkIntent.putStringArrayListExtra(TextToSpeech.Engine.EXTRA_CHECK_VOICE_DATA_FOR, checkVoiceDataFor); 
```

我希望响应包含：

*   可用声音列表中的 ita-ITA 和 eng-USA；
*   eng-USA-female 在不可用的声音列表中。

但是，结果如下：

*   可用声音：2 [eng-USA ita-ITA]
*   不可用的声音：0 []

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T23:37:14.570

对于不可用的声音，我使用以下内容：

```
 ArrayList<String> unavailable = data
            .getStringArrayListExtra("unavailableVoices"); 
```

结果始终采用“eng-GBR”或“eng”格式。

如果我误解了你的问题并且你想知道为什么你没有得到专门用于搜索“eng-USA-female”（而不是根本）的“不可用”输出，那么我只能建议格式不适合过去搜索。我建议搜索“zzz-ZZZ”以查看实际问题所在...

希望有帮助。

# grep - grep 并忽略缩小的 javascript

> ID：10524982
> 
> 赞同：5
> 
> 时间：2012-05-09T22:26:52.050
> 
> 标签：grep, minify, ack

有没有办法告诉 ack/grep 忽略缩小的 Javascript？这些文件每行有数千个字符，并且会破坏搜索输出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-05T17:04:48.457

ack 1.x 没有办法直接忽略缩小的 javascript。这将在 ack 2.0 中解决。我们正在[http://github.com/petdance/ack2](http://github.com/petdance/ack2)上处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:44:21.000

尝试这样的事情：

```
grep foo $(find -name '*.js' -exec file {} \; | grep -v "long lines" | sed 's/:.*//') 
```

*   `find -name '*.js'`查找当前目录和子目录中的所有 .js 文件。

*   添加`-exec file {} \;`到命令会在每个结果上`find`运行命令。`file`

*   的结果`file`通过管道传输到`grep`，并从结果中删除列为具有“长行”的文件。

*   中的描述`file`被剥离`sed`，只留下文件名。这些是`grep`将搜索“foo”的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T22:33:37.307

取决于您是否可以以某种方式指示应排除哪些文件。例如，如果您遵循`.min.js`约定，那么只需确保不搜索这些文件就很简单了。否则不，grep 没有`--maximum-number-of-characters-per-line-to-count-as-a-match`选项。

# jquery - jQuery 多个选择器，但缓存在一个变量中

> ID：10524985
> 
> 赞同：1
> 
> 时间：2012-05-09T22:27:17.363
> 
> 标签：jquery

我试图避免以下情况：

```
var dynS = $('#dyn-style');
var cssA = $('#css-active');

$('#selectors li').click(function(){
    switch($(this).attr('data-id')){
        case 'first-of-type':
            dynS.empty().text('#target p:first-of-type {color: red;}');
            cssA.empty().text('#target p:first-of-type {color: red;}'); 
```

有什么办法可以使用缓存的选择器变量并将 text() 设置为两者相同，以避免这种重复？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-09T22:28:54.320

尝试使用`.add`见下文，

```
dynS.add(cssA).empty().text('#target p:first-of-type {color: red;}'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-09T22:28:57.167

采用`.add`

```
dynS.add(cssA).empty().text('#target p:first-of-type {color: red;}'); 
```

# postgresql - 是否有离线 postgres 代理工具/库？

> ID：10524986
> 
> 赞同：1
> 
> 时间：2012-05-09T22:27:21.013
> 
> 标签：postgresql, proxy, offline

我正在寻找类似 PL/Proxy 之类的工具，但是当数据库离线时，它可以通过排队查询以供以后执行。它只需要一些非常简单的插入和更新（并且可以通过存储的过程调用），因此客户端应用程序自然不需要实时知道响应。

应该重试瞬时故障（例如 DB 离线），并且应该记录永久故障。

客户端应用程序是用 perl 编写的，但真正的代理服务器不应该关心这一点。

我准备自己写，但如果有人已经发明了这个轮子，我很想节省一些时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T12:37:24.197

这在很大程度上取决于您的需求。您可能可以按照 kgrittn 的建议使用连接池。我不相信，因为听起来你需要一些异步的东西。我想你可能需要写一个。话虽这么说，我认为大多数情况下都可以使用开箱即用的组件。我认为您可能需要一些最后一英里的代码，但就是这样。

我会考虑用三个基本组件来构建它：

1.  消息队列。你可以为此使用各种东西。你可以使用电子邮件、jabber、RabbitMQ ......随你选。我猜 RabbitMQ 之类的会是最简单的。

2.  一个小程序，它会监听队列、抓取消息并在你的数据库上运行查询。数据库不可用将被视为临时错误。无法运行它们的程序将被视为永久性错误。

3.  您可能需要一个库来接口和抽象消息队列（因此​​您的应用程序不必知道它正在向消息队列发送内容）。

# c++ - 计算一个非常大的矩阵的逆

> ID：10524989
> 
> 赞同：10
> 
> 时间：2012-05-09T22:27:31.360
> 
> 标签：c++, sparse-matrix, matrix-inverse

我正在尝试在 C++ 中计算一个非常大的矩阵（11300x21500）的逆。到目前为止，我已经尝试过 Eigen 和 Armadillo 库，但在初始化阶段都失败了，说内存不足。有什么办法可以克服这种情况吗？

提前致谢

PS
我应该将矩阵的大小更正为21500x21500。正如 UmNyobe 所建议的，这不是方阵。它实际上是观察矩阵**X**，我正在尝试计算 ( **X** ^T **X** ) ^(-1)

我有一个 8GB 内存（在 64 位系统中），但我不认为我正在使用所有这些内存空间。任务管理器显示出错时的内存使用量为1GB。也许在 Windows7 中有一个操作系统命令，当应用程序的内存使用量超过 1GB 时会关闭它。

顺便说一句，我最初的目的是对这个观察矩阵进行回归。

还有一件事：观察矩阵 X 的每一行中的大多数列都为零。有没有办法利用这一点来限制反转操作中的内存使用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-09T22:35:31.880

假设矩阵*是*正方形的，您可能正在寻找的是就地矩阵求逆算法。

你应该看看[这个](https://math.stackexchange.com/questions/16940/in-place-inversion-of-large-matrices)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-09T22:51:45.440

假设一个`(11300 x 11300)`整数矩阵（32位），你有

```
4*(11300^2)/(1024^3) = 0.4757 GB 
```

如果您使用双精度，则将该数字加倍。

如果库正在使用 Strassen 算法，这需要相同数量级的额外内存，那么您将前一个数字加倍。

因此，使用 Strassen 或 gaussian 反转这种大小的双基矩阵将花费您 1.9 GB。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-09T22:33:57.670

您不能对非方阵求逆。

[http://en.wikipedia.org/wiki/Invertible_matrix](http://en.wikipedia.org/wiki/Invertible_matrix)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-31T13:39:43.303

我想提出另一种解决方案，该解决方案仅在您对矩阵本身的逆不感兴趣但对逆与向量的乘积不感兴趣时​​才有效。例如，假设您想找到向量 的倒数乘积`v`，即`w := (X^T X)^{-1} v`。在这种情况下，您实际上是在寻找问题的解决方案

```
Find w such that (X^T X) w = v 
```

使用迭代算法，可以在上面的等式中找到`w`给定的`X`和**而无需反转**。我想到的一种可能性是使用[共轭梯度方法](http://en.wikipedia.org/wiki/Conjugate_gradient_method)。这个算法可以用大约 10 行来实现，并且只需要能够计算给定向量的乘积。在我们的例子中，这甚至可以分两步完成，即计算和第二步，这将节省空间，因为您不需要存储产品。`v` **`X``(X^T X) y``y``z := X y``X^T z``X^T X`**

 *** * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-21T09:40:15.590

尽管您是在 64 位机器上编译程序，但您还应该确保使用正确的 64 位库。否则，程序可能会以 32 位编译，您仍然会遇到相同的内存问题。

至于逆的计算，OpenCV 的逆函数可能会有所帮助。确保使用 DECOMP_SVD 逆，因为我发现它对近奇异矩阵更有效。**

# javascript - 在 iframe 中更改页面的按钮或链接

> ID：10524990
> 
> 赞同：5
> 
> 时间：2012-05-09T22:27:37.103
> 
> 标签：javascript, html, button, iframe, hyperlink

我希望在页面中创建一个链接或按钮来更改 iframe 所在的页面。这将是一个本地页面：

> idreesinc.com/iframe.html

你可以看到我已经在这里：

> idreesinc.com/research

帮助将不胜感激，因为我多年来一直在寻找答案。谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-04-07T20:28:32.733

You can simply make an link with its target to the iframe name as follows:

```
<iframe name="demo" src="example.php"></iframe> 
```

Your link in the parent will be:

```
<a href="newpage.html" target="demo">Change Link</a> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-09T22:40:06.063

```
<script>
function setURL(url){
    document.getElementById('iframe').src = url;
}
</script>
<iframe id="iframe" src="idreesinc.com/research.html" />
<input type="button" onclick="setURL('URLHere')" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-08-14T21:26:07.713

Create a button inside a link with its target pointing to the iframe name:

```
<iframe name="demo" src="site1.html"></iframe>
<a href="site2.html" target="demo"><button>site2</button></a> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-09T22:40:50.780

# forms - 使用 Get 参数时如何验证 Codeigniter 中的表单字段？

> ID：10524992
> 
> 赞同：10
> 
> 时间：2012-05-09T22:27:38.630
> 
> 标签：forms, validation, codeigniter, post, get

我有一个完美运行的表单，直到我将表单切换到`method="get"`. 现在我无法`form_validation->run()`评估为 TRUE。

这就是我打开表单的方式：

```
echo form_open( '', array( 'method' => 'get' ) ); 
```

这是唯一需要验证的部分：

```
$this->form_validation->set_rules( 'states', 'states', 'required' ); 
```

这是我检查表单是否经过验证的方式：

```
if( $this->form_validation->run() == FALSE ) 
```

我还需要做些什么来使用 Get 参数吗？我在配置（`$config['allow_get_array'] = TRUE;`）中打开了参数。如果我跳过验证，表单可以正常工作，所以我知道 CI 系统正在读取 url。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2015-03-10T11:15:20.127

对于 CodeIgniter 3，您可以将 GET 数组传递给`set_data`函数。例如：
`$this->form_validation->set_data($this->input->get());`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-15T17:38:12.953

只需添加：

```
$_POST['states'] = $this->input->get('states'); 
```

用于在表单验证之前验证状态字段

```
$this->form_validation->set_rules('states', 'states', 'required|trim'); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-09T22:35:10.717

Codeigniter 论坛上的这篇文章表明[表单验证不适用于 Get Parameters](http://codeigniter.com/forums/viewthread/193200/#911280)，而这正是 Codeigniter 的方式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-06-19T13:23:21.240

Codeigniter 在其中一些帖子之后发生了变化。我认为gX的答案是正确的。

用户手册中的说明，特别是[Validating an Array (other than $POST)](https://www.codeigniter.com/userguide3/libraries/form_validation.html#validating-an-array-other-than-post)部分，对我来说非常有用（截至今天），而且非常简单。

在 $this->form_validation->set_rules 行之前，指定要验证的数组：

```
$data = array(
    'username' => 'johndoe',
    'password' => 'mypassword',
    'passconf' => 'mypassword');

$this->form_validation->set_data($data); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-07-28T11:47:30.010

正如您在 Form_validation.php 文件中看到的那样，他们在类中的任何地方都对 $_POST 进行了硬编码；-(

如果您也想支持 $_GET，这很容易（而且很脏 Oooo），您可以创建一个新属性：

```
public function __construct($rules = array())
{
    $this->inputData = array_merge($_POST, $_GET);
    ...
} 
```

由于没有静态方法，因此在此类中的任何地方都将 $_POST 替换为 $this->inputData。

我知道不建议重新开始编辑供应商文件，但真的，你需要它，去做吧 ;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-06T00:44:22.100

试图做类似的事情，但归结为你的代码结构。

1.  使用通常的 post 方法提交您的表单。这将允许您执行所有后验证。
2.  然后使用 redirect() 将所有数据发送到使用“/”的控制器内部或外部的不同方法。
3.  最后，接收所有参数的方法将处理数据库事务并将其呈现给视图。

希望能帮助到你。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-19T05:43:53.910

**验证数组（$_POST 除外）**

有时您可能想要验证不是源自 $_POST 数据的数组。

在这种情况下，您可以指定要验证的数组：

```
$data = array(
        'username' => 'johndoe',
        'password' => 'mypassword',
        'passconf' => 'mypassword'
);

$this->form_validation->set_data($data); 
```

**注意。在定义任何验证规则之前，您必须调用 set_data() 方法。**

无论您是在验证 $_POST 数据还是您选择的另一个数组，创建验证规则、运行验证和检索错误消息的工作方式都是一样的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-11T14:09:00.043

将文件 Form_validation.php 复制到 Form_get_validation.php 并在所有 POST 单词中重命名为单词 GET 并将类命名为 CI_Form_get_validation。验证时，调用 form_get_validation