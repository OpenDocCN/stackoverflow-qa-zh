# StackOverflow 问答 000491000-000491999

# c++ - 朋友类：继承的类也不是朋友吗？

> ID：491000
> 
> 赞同：4
> 
> 时间：2009-01-29T09:27:52.183
> 
> 标签：c++, class, friend

在 C++ 中，我有一个 A 类，它是 B 类的朋友。

我看起来 B 的继承类不是 A 类的朋友。

我这是 C++ 的限制还是我的错误？

这是一个例子。编译时，“return new Memento”行出现错误：

Memento::Memento ：无法访问在 Memento 中声明的私有成员。

```
class Originator;

class Memento
{
  friend class Originator;

  Memento() {};

  int m_Data;

public:
  ~Memento() {};
};

class Originator
{
public:
  virtual Memento* createMemento() = 0;
};

class FooOriginator : public Originator
{
public:
  Memento* createMemento()
  {
    return new Memento; // Impossible to access private member of Memento
  }
};

void main()
{
  FooOriginator MyOriginator;
  MyOriginator.createMemento();

} 
```

我当然可以将 FooOriginator 添加为 Memento 的朋友，但是，这意味着我必须将所有 Originator 继承的类添加为 Memento 的朋友，这是我想避免的。

任何的想法 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T13:00:23.877

请参阅：[C++ 中的朋友范围](https://stackoverflow.com/questions/437250/friend-scope-in-c/437507)
投票完全相同。

```
I looks like inherited classes of B are not friend of class A. 
```

正确的

```
I this a limitation of C++ or my mistake ? 
```

这就是 C++ 的工作方式。我不认为这是一种限制。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-29T09:40:29.600

友谊不是继承的，您必须明确声明每个朋友关系。（另见“[友谊不是继承的、传递的或互惠的](http://www.parashift.com/c++-faq-lite/friends.html#faq-14.4)”）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T17:13:28.000

友谊不是传递的或继承的。毕竟，你朋友的朋友可能不是你的朋友，或者你父亲的朋友一般也不是你的朋友。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T09:40:51.377

*朋友*指令最初是为了绕过封装机制的一些“漏洞” 。

对于*朋友*，您必须准确指定（！），哪些类是您的朋友。友谊不是继承的，因此**FooOriginator**在您的示例中无法访问**Memento**。

但理想情况下，在您考虑如何使用*friend*指令解决问题之前，我建议您总体上看一下您的设计并尝试摆脱使用*friend*的需要，因为它可以被视为居住在与我们喜爱的*goto*相同的类别:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T09:43:40.047

友谊不是继承的，见[http://www.cplusplus.com/doc/tutorial/inheritance.html](http://www.cplusplus.com/doc/tutorial/inheritance.html)，从基类继承什么？

# sharepoint - SharePoint/MOSS - 从列表中删除其他人的未签入项目

> ID：491004
> 
> 赞同：5
> 
> 时间：2009-01-29T09:29:26.767
> 
> 标签：sharepoint, moss

一个简单的场景：

我想从我们的 MOSS 发布站点中删除一个过时的页面布局。一位前同事使用此页面布局创建了一个新页面，但他尚未签入。我无法删除该页面布局，因为他的文件正在引用它。我无法“看到”该文件，因为它尚未被签入，因此无法将其删除。

我尝试了 SPFolder.Items、SPList.GetItemById() 和其他几个对象模型方法。但 SharePoint 根本不会向我显示该项目。我什至在 SPList.GetItem(new SPQuery() { IncludeAllUserPermissions = true; })

任何人都知道如何摆脱这个项目？:-)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-29T22:59:31.593

Abs 的回答给了我们提示 - 嘿，ManageCheckedOutFiles 页面如何查看其他用户尚未签入的文件？

1.  转到 ~layouts/ManageCheckedOutFiles.aspx
2.  继承自 Microsoft.SharePoint.ApplicationPages.ManageCheckedOutFilesPage
3.  反射器 12\CONFIG\BIN\Microsoft.SharePoint.ApplicationPages.dll
4.  在受保护的 void PrepareContent() 中，我们阅读了关键行：
5.  IList checkOutFiles = this.CurrentList.CheckedOutFiles;

所以回到我们的代码

```
SPDocumentLibrary doclib = PublishingWeb.PagesList as SPDocumentLibrary;
foreach(var checkedoutfile in doclib.CheckedOutFiles)
{
    checkedoutfile.TakeOverCheckOut();
    var file = doclib.GetItemById(checkedoutfile.ListItemId);
    file.CheckIn();
} 
```

谢谢大家 ：-）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T14:42:27.947

如果您是网站集管理员，您还可以强制签入其他人的签出文件。诀窍是您必须知道它在哪个库中。如果您知道，可以导航到该库，然后执行以下操作：

1.  单击*Settings -> Document Library Settings*（或*List Settings*，我想）
2.  单击**权限和管理**列中的*管理签出文件*
***   您现在应该会看到一个已签出文件的列表，您可以选择这些文件，然后单击工具栏中*的 Take Ownership of Selection*。*   完成后，您可以自己检查文件。**

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T09:35:11.560

尝试来自 codeplex 的[SharePoint Sushi 。](http://www.codeplex.com/sushi)

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T10:07:01.167

首先，您应该对网站集拥有管理员权限。然后：

1.  单击站点操作、管理内容和结构。
2.  在母版页库中浏览到要删除的页面布局。
3.  在要删除的页面布局旁边打勾。
4.  单击显示相关资源。

这*应该*让您看到连接到该页面布局的每个页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T19:48:40.370

快速简便的非 SharePoint 解决方案：如果是*前*同事，是否有可能要求临时使用他的帐户和新密码，以便您可以登录门户并重新签入或放弃签入？

# refresh - 刷新 Jtable

> ID：491005
> 
> 赞同：4
> 
> 时间：2009-01-29T09:29:28.450
> 
> 标签：refresh, jtable

我有一个从 Vector 创建的 JTable。如何刷新 JTable 以显示添加到 Vector 的新数据？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-29T09:37:44.207

当 TableModel 发生更改时，您的 JTable 应该会自动更新。我在这里迈出了一大步，但我猜你没有使用自己的 TableModel，只是用你的 Vector 调用了 JTable 构造函数。在这种情况下，您可以获取 TableModel 上的挂钩并将其转换为 DefaultTableModel，然后调用其通知方法以让 JTable 知道更改，例如：

```
DefaultTableModel model = (DefaultTableModel)table.getModel();
model.fireTableChanged(new TableModelEvent(........)); 
```

我**真正**建议的是使用您自己的 TableModel，除非这是非常微不足道的事情，但您正在更新数据的事实表明它不是。

查看 sun[使用表](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html)的教程，特别是关于[监听数据变化](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html#modelchange)的部分。

这似乎需要更多的前期工作，但从长远来看，它会为您省去很多麻烦，并且是*正确的*方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-02T15:54:37.273

我调用 initTable 方法，然后调用 loadTable()。我敢肯定还有很多其他方法，但这就像魅力一样。

```
private void initBerkheimerTable() {
        tblBerkheimer = new JTable();
        tblBerkheimer.getSelectionModel().addListSelectionListener(new SelectionListener());
        tblBerkheimer.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        tblBerkheimer.setModel(new DefaultTableModel(
            new Object[][] {
            },
            new String[] {
                "Id", "Name", "Berkheimer PSD", "Rate", "Current PSD", "Current Rate"
            }
        ) {
            Class[] columnTypes = new Class[] {
                String.class, String.class, String.class, String.class, String.class, String.class
            };
            public Class getColumnClass(int columnIndex) {
                return columnTypes[columnIndex];
            }
            boolean[] columnEditables=new boolean[]{false,false,false,false,false,false,false,false,false,false};
            public boolean isCellEditable(int row, int column) {
                return columnEditables[column];
            }
        });
        scrollPane.setViewportView(tblBerkheimer);
        add(scrollPane);
    }

private void loadTable(){
        PreparedStatement ps=null;
        ResultSet rs=null;
        try {
            PayrollPsdAuditing.payroll=Database.connectToSQLServerDataBase(PayrollPsdAuditing.payrollIni);
            ps=PayrollPsdAuditing.payroll.prepareStatement(
                "SELECT a.EMPLOYID, " +
                "   a.NAME, " +
                "   a.PSD_CODE, " +
                "   a.RATE, " +
                "   b.STRINGS_I_2 as CURRENT_PSD, " +
                "   c.lcltaxrt as CURRENT_RATE " +
                "FROM PYRL_PSD_VALIDATION a, " +
                "   EX010130 b, " +
                "   UPR41400 c " +
                "WHERE a.employid=b.empid_i " +
                "   AND c.localtax=b.strings_i_2");
            rs=ps.executeQuery();
            while(rs.next()) {
                Swing.fillJTable(tblBerkheimer,
                        new String[]{rs.getString("EMPLOYID").trim()
                            ,rs.getString("NAME").trim()
                            ,rs.getString("PSD_CODE").trim()
                            ,String.valueOf(rs.getDouble("RATE"))
                            ,rs.getString("CURRENT_PSD").trim()
                            ,String.valueOf(rs.getDouble("CURRENT_RATE")/100000)});
            }
        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {
            Database.close(PayrollPsdAuditing.payroll);
        }
    } 
```

# jboss - JBoss：来自 InterceptorRegistry 的警告 EJBTHREE-1246 是什么意思？

> ID：491007
> 
> 赞同：20
> 
> 时间：2009-01-29T09:30:28.607
> 
> 标签：jboss, ejb-3.0, warnings, session-bean

我目前正在 JBoss AS 5.0.0.GA 上开发基于 EJB 3.0 的应用程序，最近服务器日志中出现以下警告：

```
09:50:19,735 WARN [InterceptorsFactory] ​​EJBTHREE-1246：不要将 InterceptorsFactory 与 ManagedObjectAdvisor 一起使用，应通过 bean 容器使用 InterceptorRegistry
09:50:19,735 WARN [InterceptorsFactory] ​​EJBTHREE-1246：不要将 InterceptorsFactory 与 ManagedObjectAdvisor 一起使用，应通过 bean 容器使用 InterceptorRegistry
09:50:19,735 WARN [InterceptorRegistry] 适用的拦截器不存在...
...

```

只要将 EJB（无状态会话 bean）注入我的 JSF Web 应用程序的支持 bean，就会生成警告。虽然豆子确实可以正常工作，但我仍然想知道该警告来自哪里以及我可以做些什么来避免它。

我已经搜索了一下，但没有找到一个好的答案（有人说，bean开发者不必担心，但它是一个警告，所以我希望有一个更好的解决方案）：

*   [http://www.jboss.com/index.html?module=bb&op=viewtopic&t=147292](http://www.jboss.com/index.html?module=bb&op=viewtopic&t=147292)
*   [http://www.jboss.com/index.html?module=bb&op=viewtopic&p=4180366](http://www.jboss.com/index.html?module=bb&op=viewtopic&p=4180366)
*   [http://www.jboss.com/index.html?module=bb&op=viewtopic&p=4140136](http://www.jboss.com/index.html?module=bb&op=viewtopic&p=4140136)
*   [关于警告的 JBoss JIRA 问题](https://jira.jboss.org/jira/browse/EJBTHREE-1246)（我认为没有帮助）

那么有没有人解释导致警告的原因（对于 bean 开发人员，而不是应用程序服务器开发人员）以及如何避免它？

**更新：**我刚刚将 JBoss 升级到 5.0.1.GA（[下载](http://www.jboss.org/downloading/?projectId=jbossas&url=https://sourceforge.net/project/showfiles.php?group_id=22866&package_id=16942&release_id=663566)，[发行说明](https://sourceforge.net/project/shownotes.php?release_id=663566&group_id=22866)）但不幸的是警告仍然出现。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-22T12:26:12.650

据我了解有关此警告的所有可用资源，JBoss 5 的用户无能为力，本质上只是提醒 JBoss 的开发人员他们错误地使用了自己的类。

根据开发人员的建议，我现在通过更改 conf/jboss-log4j.xml 中的日志配置来忽略它。我刚刚添加了：

```
<category name="org.jboss.ejb3.interceptors">
    <priority value="ERROR" />
</category> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T06:34:20.203

甚至 JBoss EJB3 教程/文档都说您可以放心地忽略这些警告。好吧，如果每个人都可以忽略这些，请不要记录它们！看到这个问题没有得到解决令人沮丧。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-30T01:13:35.653

我有同样的问题，修改ejb3-interceptors-aop.xml，现在可以正常工作了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-11T14:27:24.640

我已经在 ejb3-interceptors-aop.xml 中尝试过这种修改

我评论了这些行：

```
<aspect name="InterceptorsFactory" factory="org.jboss.ejb3.interceptors.aop.InterceptorsFactory" scope="PER_INSTANCE"/>  
<advice name="invoke" aspect="InterceptorsFactory"/> 
```

它有效

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-19T15:59:19.047

警告不再出现在 JBoss 5.1.0 中，但添加 Simon 发布的类别消除了 5.0.x 中警告的日志记录

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-15T06:34:52.677

只需按照步骤

1.  停止 JBoss 并右键单击服务器实例并选择 clean
2.  右键单击项目并选择运行 -> 运行配置
3.  选择类路径-> 添加 jars
4.  从 JBoss ASHOME/client 添加罐子 - `jbossall-client.jar`,JBoss ASHome/common/lib - 所有罐子。
5.  应用并运行。

# .net - 是否有用于读取 RAW 文件的良好 .NET 库？

> ID：491015
> 
> 赞同：5
> 
> 时间：2009-01-29T09:32:38.460
> 
> 标签：.net

我们正在编写一个基于 .NET 的应用程序来读取包括 RAW 文件在内的图像。我们可以使用一个好的库吗？也许是 dcraw 或 libraw 的包装器？许可方面，LGPL 很好，但 GPL 不行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T09:41:01.423

目前还没有，但可能很快就会有，根据[我在这里提出的问题](https://stackoverflow.com/questions/455018/extending-the-list-of-supported-image-formats-in-gdi)中的信息，这更旨在将支持扩展到所有 GDI+ 应用程序。

我遇到的几乎所有其他选项都涉及包装 dcraw（Paint.Net 插件的示例代码）

编辑：可能还应该提到明显的（现在我已经发现了）；至少佳能支持[Windows 映像组件，它有一个可下载的](http://msdn.microsoft.com/en-us/library/ms737408.aspx)[编解码器，它将](http://software.canon-europe.com/software/0032411.asp?model=)在 WPF 应用程序中为您提供支持

EDIT2：它不一定是 WPF 应用程序本身，只需要框架的 v3+ 来从 BitmapFrame/etc 拉入 System.Windows.Media.Imaging 命名空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-06T21:53:48.957

有[http://sourceforge.net/projects/dcrawnet/](http://sourceforge.net/projects/dcrawnet/)但它只是在 alpha

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T18:21:24.883

ImageMagick 库可以读取几乎所有图像格式，它有一个可以使用的 .NET 包装器。

# c# - .NET 词典：潜在的并发问题？

> ID：491023
> 
> 赞同：8
> 
> 时间：2009-01-29T09:34:27.053
> 
> 标签：c#, .net, concurrency, dictionary, locking

我正在维护一个.NET项目，我遇到了一些麻烦，我很乐意与你们分享=）

问题代码：

```
if( evilDict.Count < 1 )
{
    foreach (Item item in GetAnotherDict())
        if (!evilDict.containsKey(item.name.ToLower().Trim()))
            evilDict.add(item.name.ToLower().Trim(), item.ID);
} 
```

尽管进行了 contains() 检查，但我收到了一个 ArgumentException，告诉我已经添加了具有相同键的项目。我们只在生产中遇到过这个问题，从来没有在测试中遇到过，这让我怀疑是并发问题。我想知道的是：

*   你认为这是一个并发问题吗？
*   我如何解决它？
*   我的修复可行吗（见下文）？
*   这是我第一次尝试 .NET，字典通常是问题的根源吗？

这是我的潜在修复，替换 dictionary.add() 东西

```
protected static void DictAddHelper(Dictionary<String, int> dict, String key, int value)
{
    lock (dict)
    {
        key = key.ToLower().Trim();
        if (dict.ContainsKey(key) == false)
        {
            try
            {
                dict.Add(key, value);
            }
            catch (ArgumentException aex)
            {
                StringBuilder debugInfo = new StringBuilder();
                debugInfo.AppendLine("An argumentException has occured: " + aex.Message);
                debugInfo.AppendLine("key = " + key);
                debugInfo.AppendLine("value = " + value);
                debugInfo.AppendLine("---Dictionary contains---");

                foreach (String k in dict.Keys)
                    debugInfo.AppendLine(k + " = " + dict[k]);

                log.Error(debugInfo, aex);
            }
        }
    }
} 
```

**编辑：**

不需要我对 Dict 类进行线程安全实现的建议会更好，因为这将是一个相当大的重构，不会是一个非常受欢迎的建议 =)

**编辑2：**

我试过了

```
lock (((IDictionary)dict).SyncRoot) 
```

但我明白了

```
Error   28  Using the generic type 'System.Collections.Generic.IDictionary<TKey,TValue>' requires '2' type arguments 
```

然后我试试这个：

```
lock (((IDictionary<String, int>)dict).SyncRoot) 
```

错误：

```
Error   28  'System.Collections.Generic.IDictionary<string,int>' does not contain a definition for 'SyncRoot' 
```

最终编辑（我猜）：

感谢所有的答案！

**现在，我只想知道这些。我的方法（DictAddHelper）会起作用吗？如果没有，为什么？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T09:41:46.117

如果您怀疑您在访问字典时遇到并发问题，那么您的修复将没有任何用处。它将解决您遇到的特定问题，但是如果您可以同时访问字典，那么您将来会遇到更多问题。

考虑在修改字典时锁定对字典的访问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T10:08:40.977

使用 ng5000 的示例，修改为建议的锁定策略会给我们：

```
public static class ThreadSafeDictionary
{
    private static readonly Dictionary<string, int> dict = new Dictionary<string, int>();

    public static void AddItem(string key, int value)
    {
        lock (((IDictionary)dict).SyncRoot)
        {
            if (!dict.ContainsKey(key))
                dict.Add(key, value);
        }
    }
} 
```

请享用 。. .

吉米

编辑：请注意，类必须是静态的才能理解这个例子！;)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T10:01:19.167

第一个代码（假设 Dictionary 类型是 System.Collections.Generic.Dictionary）不会编译。没有公共包含（也没有包含方法）。

也就是说，您可能会遇到并发问题。正如您暗示的那样，另一个线程可以在 ContainsKey 检查之后和插入之前修改字典。要纠正这一点，锁定语句是要走的路。

一点 - 我更希望看到字典包装在线程安全类中，例如（警告：不完整，不打算作为参考代码，可以改进）：

```
public class ThreadSafeDictionary
{
    private Dictionary<string, int> dict = new Dictionary<string, int>();
    private object padlock = new object();

    public void AddItem( string key, int value )
    {
        lock ( padlock )
        {
            if( !dict.ContainsKey( key ) )
                dict.Add( key, value );
        }
    }
} 
```

如何实现线程安全字典已在[此处](https://stackoverflow.com/questions/157933/whats-the-best-way-of-implementing-a-thread-safe-dictionary-in-net)完整介绍。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T12:26:50.917

正如 Megacan 所说，您可能希望专注于解决您的解决方案中可能遇到的任何并发问题。

我建议使用 SynchronizedKeyedCollection，尽管这对您来说可能需要很多重构，因为 cals 的成员与字典的成员不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T10:03:21.533

```
 lock (((IDictionary)dict).SyncRoot)
    {
        if(!dict.Contains( .. ))
        dict.Add ( );
    } 
```

这对我有用（请参阅下面的更新 ng5000 示例）:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T12:29:13.690

.NET Framework 中内置了一个线程安全的字典类，它已经为解决可能与并发相关的问题提供了一个良好的开端。

它是一个名为[SynchronizedKeyedCollection(K, T)](http://msdn.microsoft.com/en-us/library/ms668294.aspx)的抽象类，您可以从中派生并添加一个方法，该方法包含对 Contains 的调用，然后在锁定 base.SyncRoot 的锁中添加。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T12:39:53.513

Ace - 奇怪的是它不适用于您的代码，它确实按照示例执行（我知道这对您没有帮助，真的只是好奇！！）。

希望你能解决，我相信这将是一个相当简单的失败原因。您甚至可能想尝试使用该示例代替您的代码，看看是否是其他问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-29T13:22:21.663

高手，

创建一个新的 WindowsFormsApplication (.Net 2.0) 并将代码粘贴到 Form1.cs 代码中。（您可能必须将命名空间的名称从 WindowsFormsApplication1 更改为系统默认的名称）。此外，将命令按钮添加到窗体。无论如何，一切都在这里：

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        private readonly Dictionary<string, int> localDict1 = new Dictionary<string, int>();
        private readonly Dictionary<string, string> localDict2 = new Dictionary<string, string>();

        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            // use two different dictionaries just to show it working with
            // different data types (i.e. we could use class objects too)
            if (localDict1 != null)
            {
                ThreadSafeDictionaryStatic.AddItem(localDict1, "New Item :1", 1);
                ThreadSafeDictionaryStatic.AddItem(localDict1, "New Item :2", 2);
            }
            if (localDict2 != null)
                ThreadSafeDictionaryStatic.AddItem(localDict2, "New Item :1", "this is not a number");
        }
    }

    public static class ThreadSafeDictionaryStatic
    {

        public static void AddItem<T>(IDictionary<string, T> dict, string key, T value)
        {
            if (dict == null) return;
            lock (((IDictionary)dict).SyncRoot)
            {
                if (!dict.ContainsKey(key))
                    dict.Add(key, value);
                else
                {
                    // awful and we'd never ever show a message box in real life - however!!
                    var result = dict[key];
                    MessageBox.Show(String.Format("Key '{0}' is already present with a value of '{1}'", key, result));
                }
            }
        }

        public static T GetItem<T>(IDictionary<string, T> dict, string key)
        {
            if (dict == null) return default(T);
            if (dict.ContainsKey(key))
                return dict[key];
            else
                return default(T);
        }

        public static bool Remove<T>(IDictionary<string, T> dict, string key)
        {
            if (dict == null) return false;
            lock (((IDictionary)dict).SyncRoot)
            {
                if (dict.ContainsKey(key))
                    return dict.Remove(key);
            }
            return false;
        }
    }
} 
```

让我知道这是怎么回事...

编辑：重新制作类以匹配您的方法签名，还使用泛型，因为您希望该方法接受任何类型的对象。`<T>`您可以通过删除参考等轻松地将其更改回来。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-29T09:40:30.380

不应该

```
if (!evilDict.contains(item.name.ToLower().Trim())) 
```

是

```
if (!evilDict.ContainsKey(item.name.ToLower().Trim())) 
```

?

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-29T09:43:19.110

很难说是否确实是并发问题。如果字典被多个线程访问，那么它确实可能是一个并发问题，但我认为你应该添加一些跟踪代码来找出罪魁祸首。

如果字典被多个线程访问，那么您确实应该确保在一个原子事务中调用 Contains（或 ContainsKey）和 Add 方法。为此，您确实应该在锁中调用这两个方法。

```
lock( dict.SyncRoot )
{
   if( dict.Contains( .. ) == false )
      dict.Add ( );
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-01-17T16:59:05.080

重构不必痛苦或难以执行。只需进行以下重构：

1）为您的字典创建一个包装容器类，该类实现与字典相同的接口

2）查找您的字典的声明并应用重构更改声明的类型（到您刚刚创建的类型）

3）尝试构建，此时，如果你的包装器实现了所有接口成员，你应该不会得到任何编译错误

4）在您的字典的访问器上，将所有内容包装在锁中或您想要应用的任何同步策略中

# maven-2 - Maven 2 Checkstyle configLocation

> ID：491026
> 
> 赞同：6
> 
> 时间：2009-01-29T09:36:04.383
> 
> 标签：maven-2, maven-plugin, checkstyle

I have a project which has as maven dependency a jar file which includes a xml file where I stored my rules for checkstyle. I thought it would be ok to just use this configuration:

```
<configLocation>mycheckstyle.xml</configLocation> 
```

My understanding is that the file should be searched on the classpath and my jar file is a Maven dependency so it should be found, however I get a resource not found exception.

Any suggestions?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-11T05:22:59.447

Try adding a dependencies section to your plugin configuration.

E.g.,

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-checkstyle-plugin</artifactId>
    <dependencies>
      <dependency>
        <groupId>com.example.whizbang</groupId>
        <artifactId>build-tools</artifactId>
        <version>1.0</version>
      </dependency>
    </dependencies>
  </plugin> 
```

See [Maven Checkstyle Plugin - Multimodule Configuration](http://maven.apache.org/plugins/maven-checkstyle-plugin/examples/multi-module-config.html) for more information.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T09:58:17.520

As explained in the [Checkstyle plugin page](http://maven.apache.org/plugins/maven-checkstyle-plugin/checkstyle-mojo.html#configLocation),

> configLocation :
> 
> Specifies the location of the XML configuration to use.
> 
> Potential values are a filesystem path, a URL, **or a classpath resource**.

I never did that on my project...

Are you sure that the JAR containing the XML file is in the classpath when the checkstyle plugin is starting?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T10:11:49.990

I'm having a parent which specifies the checkstyle plugin and has in its resource folder the appropriate mycheckstyle.xml. I use the maven assembly plugin to make a jar of my parents resource folder and define that jar as a dependency in my child. So when the child inherits the checkstyle plugin + it's configuration from the parent it should be able to find the mycheckstyle.xml. I have followed the instructions on the checkstyle plugin page but it didn't work.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T12:34:17.377

If you have a local maven repository for your self-created and compiled checks, please be aware to not forget defining

```
<repositories>
    <repository>
        <id>my local repository</id>
        <url>file:${basedir}/.m2artifacts</url>
    </repository>
    <!-- ... -->
</repositories> 
```

but also

```
<pluginRepositories>
    <pluginRepository>
        <id>my local repository</id>
        <url>file:${basedir}/.m2artifacts</url>
    </pluginRepository>
    <!-- ... -->
</pluginRepositories> 
```

otherwise the plugin dependency will just look in central maven repo but will not find your local JAR file with your check-classes

# windows - 系统信息作为远程桌面上的桌面壁纸

> ID：491030
> 
> 赞同：5
> 
> 时间：2009-01-29T09:38:18.700
> 
> 标签：windows, remote-desktop

将远程桌面打开到不同的 Windows 服务器时，很容易混淆两个远程桌面。

如何让每个远程服务器自动将一些系统信息显示为桌面墙纸，即。计算机名称、操作系统、IP 地址等。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-29T09:44:38.703

我过去曾使用SysInternals 人员的[BGInfo](http://technet.microsoft.com/en-us/sysinternals/bb897557.aspx)来执行此操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T09:52:01.400

几乎没有那么复杂，但我将桌面颜色更改为易于区分的相当强烈的主要颜色。现在人们说“它是红色的”，所以它可以作为一种简单而轻松地区分机器的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T09:45:33.007

桌面小部件有许多产品。为什么不尝试以下初学者：

*   [雅虎！小部件](http://widgets.yahoo.com/)
*   [谷歌桌面](http://desktop.google.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-13T21:09:57.687

除非我遗漏了什么，否则最简单的方法是为每台机器创建一个桌面映像，列出计算机名称、操作系统、IP 地址等。

假设您使用的是 Windows，一个更复杂但更酷的方法是使用[Rainmaker 和 Enigma](http://lifehacker.com/5087956/customize-your-own-killer-enigma-desktop)动态生成信息并将其嵌入桌面。安装和使用 Rainmaker 和 Enigma 只是为了获取主机名可能有点矫枉过正，但你也可以让它显示各种进程的输出，这样你就可以监控你需要的任何系统指标：空闲/已用内存、CPU 使用、网络流量、什么你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-10T21:07:08.887

桌面信息显示更多信息并且易于配置： [http ://www.glenn.delahoy.com/software/](http://www.glenn.delahoy.com/software/)

# .net - ASP.Net 编译冲突...我的用户控件存在于两个位置

> ID：491046
> 
> 赞同：0
> 
> 时间：2009-01-29T09:44:56.953
> 
> 标签：.net, asp.net, iis, webserver

我在尝试运行我的页面时收到以下错误消息

```
Compiler Error Message: CS0433: The type 'usercontrols_BirthDetails' exists in both 'c:\windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\5c377e82\1f883022\App_Web_ub0hcxgl.dll' and 'c:\windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\5c377e82\1f883022\App_Web_3ndqr5wn.dll' 
```

该代码在我的机器上运行良好，但在服务器上失败，如上所述。

有时这会发生在我的机器上，但我可以通过关闭 Visual Studio 并重新启动它来修复它。所以我猜这是由于 ASP.Net 正在犯的一些编译错误而发生的一些冲突。

我的问题是，如何在不重新启动服务器的情况下在我的服务器上解决此问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T10:54:14.927

我已经在我的开发机器上多次发生过这种情况，但我从来不知道它会发生在服务器上。而且，我是一名编码员，而不是系统管理员，所以请对我所说的持保留态度，但是 . . .

停止 IIS 进程，并删除 Temporary ASP.NET files\root\ 目录下的所有内容。这只是您的 .aspx 页面被编译下来的地方 - 这并不像听起来那么可怕。重新启动 IIS，一切都应该很好。而且，如果不是，请记住，这不是我的错 - 您是在 StackOverflow 上听取陌生人建议的人 :-)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T15:52:26.557

好吧，我确实解决了这个问题，但根本原因是别的……显然它与声明我的用户控件类型的变量有关。出于某种原因，这与服务器上的 ASP.Net 不一致（尽管它在我自己的机器上被很好地消化了）......我不知道为什么会发生这种情况，但这个线索是给 Jon 的一个信号Skeet 介入并用技术性的废话来描述这件事。

我的解决方案是删除 usercontrol 变量声明。我得到了解决方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-04T13:18:40.883

我在我接管的网站中发现了同样的问题。

UserControl 的名称在部分类中定义了多次。

例如：

UC1.ascx -> 公共部分类 UC1

UC2.ascx -> 公共部分类 UC1

我更正了第二个用户控件的部分类的名称，并且发布工作。

# asp.net - 如何创建类似 polldaddy 的编辑器

> ID：491047
> 
> 赞同：1
> 
> 时间：2009-01-29T09:44:57.233
> 
> 标签：asp.net, ajax, panels

你们中的大多数人一定用过polldaddy。我想从你们那里得到一些建议，关于如何设计一个像 polldaddy 中看到的编辑器。下面是一个截图。

左侧有一个控件列表（文本框、列表等），右侧有一个面板（编辑器）。我可以单击并拖动控件，只要将其放入面板中，它就会在面板中对齐并显示其他选项。如何使用 asp.net 做到这一点？任何样品或想法都会很棒。

谢谢

[替代文字 http://hdwall1.googlepages.com/poll.JPG](http://hdwall1.googlepages.com/poll.JPG)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T02:15:34.753

你有很多工作要做。

忽略您的服务器端模型，您可能会使用 jQuery/jQuery UI/ExtJS 或任何其他 UI 框架来允许拖放排序功能。

我不熟悉 PollDaddy，但我想那里有很多代码可以实现投票/表单构建器。假设它没有打包，你也可以查看他们的代码。

希望这可以帮助。

# html - z-index的最小值和最大值？

> ID：491052
> 
> 赞同：566
> 
> 时间：2009-01-29T09:50:20.530
> 
> 标签：html, css, z-index

我的 HTML 页面中有一个 div。我根据某些条件显示此 div，但 div 显示在我指向鼠标光标的 HTML 元素后面。

我已经尝试了从 0 到 999999 的所有 z-index 值。谁能告诉我为什么会这样？

CSS 的 Z-INDEX 属性是否有最小值或最大值？

```
.divClass {
     position: absolute; 
     left: 25px; 
     top: 25px; 
     width: 320px;
     height: 300px; 
     z-index: 1000; 
}
```

```
<table cellspacing="0" cellpadding="0" width="100%">
  <tr>
    <td>
      <asp:HyperLink ID="lnkProgram" runat="server"></asp:HyperLink>
    </td>
  </tr>
  <tr>
     <td>
         <div class="divClass">
           Some Data
         </div>
     </td>
  </tr> 
</table>
```

我通过使用 jQuery使用`.divClass`onclick显示和隐藏 div。`<asp:hyperlink>`

* * *

## 回答 #1

> 赞同：336
> 
> 时间：2009-01-29T10:11:14.123

[http://www.w3.org/TR/CSS21/visuren.html#z-index](http://www.w3.org/TR/CSS21/visuren.html#z-index)

> **'z-索引'**
> 
> *值*：自动 | <整数> | 继承

[http://www.w3.org/TR/CSS21/syndata.html#numbers](http://www.w3.org/TR/CSS21/syndata.html#numbers)

> 某些值类型可能具有整数值（由 <integer> 表示）或实数值（由 <number> 表示）。实数和整数仅以十进制表示法指定。<integer> 由一个或多个数字“0”到“9”组成。<number> 可以是 <integer>，也可以是零个或多个数字，后跟一个点 (.)，后跟一个或多个数字。整数和实数前面都可以用“-”或“+”表示符号。-0 相当于 0，不是负数。
> 
> 请注意，许多允许整数或实数作为值的属性实际上将值限制在某个范围内，通常是非负值。

所以基本上 CSS 标准中的 z-index 值没有限制，但我猜大多数浏览器在实践中将其限制为带符号的 32 位值（-2147483648 到 +2147483647）（64 会有点偏离顶部，而且它这些天使用小于 32 位的任何东西都没有意义）

* * *

## 回答 #2

> 赞同：170
> 
> 时间：2009-05-13T07:35:52.070

我的测试表明这`z-index: 2147483647`是最大值，在 OS X 的 FF 3.0.1 上进行了测试。我发现了一个整数溢出错误：如果您键入`z-index: 2147483648`（即 2147483647 + 1），则该元素将落后于所有其他元素。至少浏览器不会崩溃。

要吸取的教训是，您应该注意不要为`z-index`属性输入过大的值，因为它们会环绕。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2010-08-18T16:43:30.533

根据经验，我认为正确的最大值`z-index`是 2147483647。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2012-06-01T12:32:24.190

它是 32 位整数的最大值：2147483647

另请参阅文档：[https](https://www.w3.org/TR/CSS22/visuren.html#z-index) ://www.w3.org/TR/CSS22/visuren.html#z-index （允许使用负数）

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2010-10-07T15:14:08.420

这取决于浏览器（尽管所有浏览器的最新版本应最大为 2147483638），超过最大值时浏览器的反应也是如此。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-01-29T10:06:34.023

Z-Index 仅适用于具有`position: relative;`或`position: absolute;`应用于它们的元素。如果这不是问题，我们将需要查看示例页面以提供更多帮助。

编辑：好医生已经给出了最完整的解释，但快速版本是最小值是 0，因为它不能是负数和最大值——嗯，对于大多数设计，你永远不需要超过 10。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-06-07T20:13:41.787

我发现如果 z-index 不起作用，通常是因为它的父/兄弟没有指定的 z-index。

因此，如果您有：

```
<div id="1">
    <a id="2" style="z-index:2"></a>
    <div id="3" style="z-index:1"></div>
    <button id="4"></button>
</div> 
```

项目#3，甚至#4，可能会与#2 争夺点击/悬停空间，但如果将#1 设置为z-index 0，则z-index 的兄弟姐妹现在将它们放在独立堆栈中，它们在同一个堆栈中并将正确地进行 z-index。

这有一个有用且相当人性化的描述： http: [//foohack.com/2007/10/top-5-css-mistakes/](http://foohack.com/2007/10/top-5-css-mistakes/)  

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2020-08-26T07:00:13.587

结论 最大 z-index 值为 2,147,483,647，超过此值转换为 2,147,483,647

| ‌浏览器 | 最大 | 超过最大值 |
| --- | --- | --- |
| 铬 >= 29 | 2,147,483,647 | 2,147,483,647 |
| 歌剧 >= 9 | 2,147,483,647 | 2,147,483,647 |
| IE >= 6 | 2,147,483,647 | 2,147,483,647 |
| 野生动物园 >= 4 | 2,147,483,647 | 2,147,483,647 |
| 野生动物园 = 3 | 16,777,271 | 16,777,271 |
| 火狐 >= 4 | 2,147,483,647 | 2,147,483,647 |
| 火狐 = 3 | 2,147,483,647 | 0 |
| 火狐 = 2 | 2,147,483,647 | 错误：标签隐藏 |

在 BrowserStack 中测试的所有值。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2010-12-01T06:27:52.523

上面的一位用户说：“嗯，对于大多数设计，你永远不需要超过 10。”

根据您的项目，您可能只需要 z-indexes 0-1 或 z-indexes 0-10000。您经常需要以较高的数字播放...特别是如果您使用灯箱查看器（9999 似乎是标准，如果您想超过他们的 z-index，您需要超过它！）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-26T16:11:49.993

虽然`INT_MAX`可能是最安全的选择，但 WebKit 显然在内部使用双精度数，因此允许*非常大*的数字（达到一定精度）。`LLONG_MAX`例如工作正常（至少在 64 位 Chromium 和 WebkitGTK 中），但将四舍五入为 9223372036854776000。

（尽管您应该仔细考虑您是否*真的*需要这么多 z 索引……）。

# python - Pydev 中没有代码完成和语法高亮

> ID：491053
> 
> 赞同：18
> 
> 时间：2009-01-29T09:50:56.473
> 
> 标签：python, ide

我刚刚使用 PyDev 最新版本配置了 Eclipse，但是当我导入外部模块时，代码完成和语法高亮都不起作用。如何启用它？

显然，Komodo Edit 可以更好地突出显示语法。- 但是 Ctrl+R 不运行程序。

我更喜欢 SciTE 类型的编辑器，它具有类似的突出显示和字体（美学）和 F5 工作，但可以动态显示文件夹和文件，如 Komodo Edit 以及更好的代码完成和 vi 仿真。建议，请。

如果我想购买 Py IDE、Komodo 或 Wingware，哪个更好？-- Wrt 语法高亮和代码完成

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-29T15:32:20.263

要启用代码完成，请转到 Window > Preferences > Pydev > Editor > Code Completion，然后选中“Use Code Completion？” 框，以及您要完成的其他框。加载似乎需要一秒钟，这是它第一次必须完成某些事情。

默认情况下，语法着色应该可以正常工作。右键单击包资源管理器中的文件，转到“打开方式”，并确保使用 Python 编辑器而不是常规文本编辑器打开它。

我不知道您导入外部模块的确切含义。我的源代码位于磁盘上的单独目录结构中；我的 PyDev 项目包含链接到这些的文件夹。代码完成适用于此，以及其他模块，如“os”。如果您遇到问题，是否将模块添加到 PyDev 的 Python 搜索路径中（不一定与常规路径相同）？

不久前我简要介绍了 Komodo 和 Wingware，所以我无法回答您问题的第二部分。但最终选择了 PyDev。我不是 Eclipse 的忠实粉丝，但 PyDev 对我来说工作得相当好。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-12-02T23:07:53.407

代码完成在 PyDev 下不起作用的典型原因是库不在 PYTHONPATH 中。如果您进入项目属性，并设置 PyDev PYTHONPATH 首选项以包含您尝试完成的代码所在的位置，它将正常工作......

项目 > 属性 > PyDev-PYTHONPAH > 单击“添加源文件夹”

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-07-25T00:43:03.603

确保通过右键单击文件将“打开方式”用作“Python 编辑器”-它对我有用

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-09T13:38:23.837

打开后，检查您的项目和编辑器顶部是否显示“P”图标。如果没有出现，可能是文件关联有问题，因此，转到窗口 > 首选项 > 常规 > 编辑器 > 文件关联，并确保 .py 文件与 Python 编辑器关联（注意，因为一个 Eclipse 错误，如果它看起来正确，您可能必须删除关联并重新添加它）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-12T04:47:00.957

听起来您必须指定 Python 解释器的位置。在 Preferences > Pydev > Interpreter - Python 下执行此操作。创建一个新的解释器并将其指向 Python 解释器可执行文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T12:03:46.347

好吧，我尝试了 Wing Professional，我认为它确实是最好的 Py IDE。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T12:28:52.833

在科莫多和wingide之间，我会选择wing。许可证并不昂贵，而且它是商业的事实使您更有可能获得更多更新和错误修复。如果您像我一样喜欢免费的解决方案，那么请坚持使用 pydev。至少在 aptana 关闭免费门之前 :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-21T14:39:21.423

检查您的主题配置。Python 突出显示使用主题颜色

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-10T16:37:05.513

万一其他人犯了我所做的令人尴尬的错误：确保您的源代码文件实际上以“.py”结尾。即使它在 Python 项目中，PyDev 也不会在没有扩展的情况下进行猜测。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-08-22T05:13:15.723

**如果您想使用 Eclipse，请查看这些插件。**

- 让你的 Eclipse 编辑器像 vim 一样工作。我用这个插件。 [http://vrapper.sourceforge.net/home/](http://vrapper.sourceforge.net/home/)

-然后如果你用 HTML、CSS 等做一些事情。这个插件可能很有用。 [https://github.com/emmetio/emmet-eclipse](https://github.com/emmetio/emmet-eclipse)

**如果您正在寻找文本编辑器。我建议你使用： -**

**Notepad++（在 Windows 中）** - 带有插件，如 - ViSimulator - Emmet - Explorer - Python Script - NppExec

**Kate(KDE Advanced Text editor)** ,[In Linux]，具有vim模式和许多特性。在我看来，它也有更好的语法支持。我不确定它是否有插件。

我相信您已经阅读了 DNS 和 tim-white 的答案

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-02-04T18:24:59.730

当使用 PyDev 的语法高亮对我不起作用时，我发现在我的 Eclipse/PyDev 安装中以某种方式为 .py 文件定义了两个“Python 编辑器”关联。从 Eclipse 主菜单中，转到 Window > Preferences > General > Editors > FileAssociations 以查看文件扩展名 <-> 编辑器映射。我在对话框底部为 .py 文件设置了一个不同的默认值，并且语法高亮再次工作。

# java - 布局管理器可以生成多个 JPanel 吗？

> ID：491059
> 
> 赞同：3
> 
> 时间：2009-01-29T09:53:12.723
> 
> 标签：java, swing, netbeans, netbeans6.5, layout-manager

我必须构建一个包含许多控件的相当大的表单。控件分为*基本*控件/设置和*扩展*控件/设置。用户可以决定他是否只想查看基本控件或同时查看基本控件和扩展控件。

我已经将所有扩展控件放到了它们自己的 JPanel 上，这样我就可以通过显示或隐藏此面板轻松地在两个视图之间切换。

目前我正在使用 GroupLayout 并且发生的情况是不同面板上的控件未对齐：

```
Label aaa:     Text field
Label a:       Text field
Label aaaaaa:  Text field
----------------------------
Label b:    Text field
Label bbb:  Text field
Label bb:   Text field 
```

不幸的是，我现在找到了“同步”两个面板布局的方法（使用 AbsoluteLayout 和固定控制坐标除外）

*   有没有办法做到这一点？
*   我的整个设计有缺陷吗？

**编辑：**如果可能的话，我想保留 GroupLayout 管理器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T14:35:09.317

据我所知，没有任何 Swing LayoutManager（来自 JRE 或开源）可以跨越多个面板。

我目前正在为我的[DesignGridLayout](https://designgridlayout.dev.java.net/)项目开发这样一个功能（我称之为“布局同步”），但实现起来并不容易（我大约 2 周前就开始了，我仍然不知道我是否以及何时会得到一些有趣的东西，但我仍然对它寄予厚望；-))

您可以检查的一个选项是将所有组件添加到同一个面板（然后只有一个 GroupLayout）并根据用户的选择隐藏/显示它们。希望 GroupLayout 能够根据情况调整大小（在调用 pack() 之后）。

如果 GroupLayout 表现良好，那么每次用户更改选择以显示/隐藏扩展字段后，只需调用 pack() 即可。

否则，每次用户更改其选择时，您都必须手动设置面板的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T13:34:27.037

可能最简单（好的）方法是将所有组件添加到主面板。将子面板设置为不透明，并将其也添加到主面板。主面板需要优化绘图被关闭。

另一种技术是添加间隔组件。在底部面板中添加一个与标签在同一列中的组件，该组件动态地从顶部标签中获取其各种尺寸方法的宽度组件。对顶部面板执行相同操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T16:13:58.883

我认为标准布局管理器无法做到这一点。您可能必须编写自己的布局管理器，但如果您将 GroupLayout 子类化，这应该不会太难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T09:56:16.323

您可以使用 GridLayout 而不是 GroupLayout 这将为您提供列之间的统一间距

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T10:00:29.030

这是[GridLayout](http://java.sun.com/docs/books/tutorial/uiswing/layout/grid.html)的解释。这会将每个组件设置为您期望的大小。使用 GridData 对象，您可以指定组件的排序方式。

[例子](http://www.java2s.com/Tutorial/Java/0280__SWT/UseGridLayouttolayoutadialog.htm)

[![替代文字](https://i.stack.imgur.com/wUbVo.png)](https://i.stack.imgur.com/wUbVo.png)
[（来源：[sun.com](http://java.sun.com/docs/books/tutorial/figures/uiswing/layout/GridLayoutDemo.png)）]

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T18:16:46.017

如果要将它们保存在具有单独布局的单独面板中：

遍历您添加的所有标签，并找到每个标签的最大首选宽度。第二次迭代，并将首选大小设置为每个标签的首选高度，但最大宽度。

# c++ - 如何将标准 IP 地址格式字符串转换为十六进制和长字符串？

> ID：491060
> 
> 赞同：5
> 
> 时间：2009-01-29T09:53:31.243
> 
> 标签：c++, format, ip-address

有谁知道如何从标准 IP 地址格式字符串（“xxx.xxx.xxx.xxx”）中获取十进制或十六进制的 IP 地址？

我尝试使用 inet_addr() 函数，但没有得到正确的结果。

我在“84.52.184.224”上测试过

该函数返回不正确的 3770168404（正确的结果是 1412741344）。

谢谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-29T10:01:22.303

您刚刚得到了与预期相反的字节 - 它们按[网络字节顺序排列](https://en.wikipedia.org/wiki/Endianness#Networking)

```
3770168404 = 0xE0 B8 34 54     network byte order
               |         |
                \       /
                 \     /
                  \   /
                   \ /
                   /\
                  /  \   
                 /    \
                /      \
               |        |
1412741344 = 0x54 34 B8 E0     machine order 
```

您可以使用[ntohl()](http://msdn.microsoft.com/en-us/library/ms740069(VS.85).aspx)从网络顺序转换为机器顺序。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-29T10:07:20.777

htonl、htons、ntohl、ntohs 函数可用于在网络和本地字节顺序之间进行转换。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-29T10:00:07.907

返回结果正确，字节按网络字节序排列

```
84 => 0x54
52 => 0x34
184 => 0xb8
224 => 0xe0
0xe0b83454 => 3770168404 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T09:59:28.233

我认为您可能遇到了字节顺序问题。从手册页：

> 所有 Internet 地址都按网络顺序返回（字节从左到右排序）。所有网络号和本地地址部分都作为机器字节顺序整数值返回。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T16:24:55.820

仔细检查以下链接：

http://msdn.microsoft.com/en-us/library/ms738563(VS.85).aspx

# c# - 如何让 TabControl 使用其父级的整个宽度？

> ID：491061
> 
> 赞同：8
> 
> 时间：2009-01-29T09:55:29.647
> 
> 标签：c#, .net, winforms, tabcontrol

标准 System.Windows.Forms.TabControl 组件在其包含的 TabPages 周围绘制边框。如果将其 Dock 设置为 Fill，这些边框会一直延伸到父控件的边缘，但它们仍然存在，占用了屏幕空间。

在 Visual Studio 中，如果将两个窗口停靠在同一个位置，则会在底部获得一组类似于 TabControl 的选项卡，但两侧没有边框。

是否可以让 TabControl 以这种方式显示其 TabPages，而不会在两侧浪费屏幕空间？如果可能的话，我想避免涉及自己绘制控件的解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-19T00:25:36.470

1.  从 TabControl 中删除高度和宽度属性
2.  设置水平和垂直对齐以拉伸

例如不会拉伸；

```
<TabControl Height="373" Width="609" HorizontalAlignment="Stretch" Name="tabControl1" VerticalAlignment="Stretch"  VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch"> 
```

例如会拉伸；

```
<TabControl HorizontalAlignment="Stretch" Name="tabControl1" VerticalAlignment="Stretch"  VerticalContentAlignment="Stretch" HorizontalContentAlignment="Stretch"> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-03T01:31:02.067

您应该尝试使用 Anchor 锚定四个边中的每一个，而不是使用 Dock 属性。然后，您需要定位 TabControl，使其在父级的所有侧面都大几个像素。这样边框是隐藏的，因为它们在父控件后面时无法绘制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-10T03:10:28.013

使用标准的 .NET 选项卡控件，这是不可能直接实现的。这样做的最终目标是什么？您是否尝试模拟与 Visual Studio 相同类型的选项卡式 MDI 样式显示？如果是这种情况，有几个第三方解决方案可用——一些是开源的，一些是商业的。

关于结合使用 Anchor 属性并设置大小使其比实际窗口大一点的其他响应可能会起作用，但我认为它在视觉上可能看起来有点奇怪。无论主题和可访问性设置如何，它都应该可以工作，但您最终可能不得不以编程方式将大小设置为比父级大几个像素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-01-21T21:58:05.450

> 是否可以让 TabControl 以这种方式显示其 TabPages，而不会在两侧浪费屏幕空间？如果可能的话，我想避免涉及自己绘制控件的解决方案。

如果我正确理解了您的问题，并阅读了[当前接受的答案](https://stackoverflow.com/a/1252960/6674014)，您想知道如何使 TabControl 的选项卡在整个控件**中延伸而不会浪费空间**，如下所示：

[![](https://i.stack.imgur.com/Mzmb6.png)](https://i.stack.imgur.com/Mzmb6.png)

为此，请设置*cTabControl.Dock = Fill*，然后创建以下函数并在*Form1_Shown()*和*Form1_Resize()*或您创建的任何“Resize()”函数中调用它。

## **C＃**

```
void ResizeTabs()
{
    int numTabs = cTabControl.TabCount;

    float totLen = 0;
    using(Graphics g = CreateGraphics())
    {
        // Get total length of the text of each Tab name
        for(int i = 0; i < numTabs; i++)
            totLen += g.MeasureString(cTabControl.TabPages[i].Text, cTabControl.Font).Width;
    }

    int newX = (int)((cTabControl.Width - totLen) / numTabs) / 2;
    cTabControl.Padding = new Point(newX, cTabControl.Padding.Y);
} 
```

## **VB**

```
Sub ResizeTabs()
    Dim numTabs As Integer = cTabControl.TabCount

    Dim totLen As Decimal = 0
    Using g As Graphics = CreateGraphics()
        ' Get total length of the text of each Tab name
        For i As Integer = 0 To numTabs - 1
            totLen += g.MeasureString(cTabControl.TabPages(i).Text, cTabControl.Font).Width
        Next
    End Using

    Dim newX As Integer = ((cTabControl.Width - totLen) / numTabs) / 2
    cTabControl.Padding = New Point(newX, cTabControl.Padding.Y)
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T08:19:00.850

```
<Grid>
   <TabControl Name="tabControl1" >
       <TabItem Header="tabItem1" Name="tabItem1">
          <Grid />
       </TabItem>
       <TabItem Header="tabItem2" Name="tabItem2">
          <Grid />
       </TabItem>
       <TabItem Header="tabItem3" Name="tabItem3">
          <Grid />
       </TabItem>
  </TabControl>
</Grid> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-16T15:19:00.997

我通过在标签标题中添加空格解决了同样的问题：

var pageAlignment = 50;

TabPage1.Text = TabPage1.Text.PadLeft(pageAlignment / 2).PadRight(pageAlignment); TabPage2.Text = TabPage2.Text.PadLeft(pageAlignment / 2).PadRight(pageAlignment); TabPage3.Text = TabPage3.Text.PadLeft(pageAlignment / 2).PadRight(pageAlignment);

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-03T01:33:14.977

以设置为父控件宽度的宽度锚定控件的左侧和右侧。

childControl.Anchor = Anchor.Left|Anchor.Right; childControl.Width = parentControl.Width;

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-02-07T02:20:30.603

不要停靠 TabControl。在设计器上拉伸它，使其左右边缘延伸到窗口之外。

# dependency-injection - 原始类型和 IoC 容器

> ID：491065
> 
> 赞同：6
> 
> 时间：2009-01-29T09:56:19.113
> 
> 标签：dependency-injection, inversion-of-control

使用 IoC 容器时如何处理原始类型？

即假设你有：

```
class Pinger {
    private int timeout;
    private string targetMachine;

    public Pinger(int timeout, string targetMachine) {
        this.timeout = timeout;
        this.targetMachine = targetMachine;
    }

    public void CheckPing() {
        ...
    }
} 
```

您将如何获得 int 和 string 构造函数参数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T10:01:17.670

为此制作另一个界面。

然后你会得到类似的东西：

```
public Pinger(IExtraConfiguration extraConfig)
{
   timeout = extraconfig.TimeOut;
   targetmachine = extraconfig.TargetMachine;
} 
```

我不知道其他 IOC 容器，但 Castle Windsor 会自动解析这些额外的构造函数参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T18:33:41.643

我不确定您的困难是值类型还是具体类型。两者都不是问题。您不需要引入配置接口（如果您想将相同的参数传递给多个对象，这很有用，但在您给出的情况下则不然）。无论如何，这是Windsor fluent 代码，我相信很快就会有人提交XML 版本。

```
container.Register(
            Component.For(typeof(Pinger))
                .ImplementedBy(typeof(Pinger))  // This might not be necessary
                .Parameters(Parameter.ForKey("timeout").Eq("5000"),
                            Parameter.ForKey("targetMachine").Eq("machine")
                )
            ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T10:06:13.243

这取决于。当您在执行开始时配置实例时，IoC-Container StructureMap 将允许您声明这些依赖项。

例如在注册表中

```
ForRequestedType<Pinger>()
  .TheDefault.Is.OfConcreteType<Pinger>()
  .WithCtorArg("timeout").EqualTo(5000)
  .WithCtorArg("targetMachine").EqualToAppSetting("machine"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T10:26:18.320

在 Spring 中，可以使用 ${propertyName} 表示法从属性文件中查找属性值

```
<bean class="blah.Pinger">
    <constructor-arg value="${blah.timeout}"/>
    <constructor-arg value="${blah.targetMachine}"/>
</bean> 
```

在 Spring.net 中，PropertyPlaceholderConfigurer 提供了相同的功能，它具有相同的语法，并在配置文件中使用名称值部分。

# jquery - MooTools 和 jQuery 集成

> ID：491066
> 
> 赞同：3
> 
> 时间：2009-01-29T09:57:03.777
> 
> 标签：jquery, continuous-integration, mootools

我正在使用代码[MooTools](http://en.wikipedia.org/wiki/MooTools) (1.11) 和 jQuery (1.2.6)。当它们分开时，它工作正常。当我集成 Firefox 时，它会抛出：

> (document).ready(){} 不是函数。

我的概念有什么问题吗？我该怎么做才能纠正它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T10:28:32.420

```
jQuery.noConflict(); 
jQuery(function($){ 

   $works with jQuery here. 
});
$ Works with MooTools here. 
```

但是，也就是说，我建议您放弃 MooTools。

它对所有对象原型的完全修改可能会导致 jQuery 的函数随机和无法解释的导致错误，最重要的是，MooTools 对所有对象原型的修改（甚至修改了 Object 和 Function 原型），根据我的经验，导致在 jQuery 中执行比没有时慢得多，仅仅是因为 MooTools 在同一页面上。

此外，MooTools 为 50 KB，jQuery 为 25 KB（平均数字，包括扩展）。让它们都将大大减慢页面加载速度，只是为了获取额外的数据。

我正在工作的一个项目遇到了 JavaScript 性能问题，而且我说的*是非常* *严重*的减速，在看似简单的代码中。*我们迁移到 jQuery，在完成迁移代码后停止加载 MooTools之前*，性能没有任何提升，而一旦我们放弃 MooTools，速度又恢复了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T10:03:25.747

jQuery 和 MooTools 都使用 '$' 作为调用其主要函数的简写方式。jQuery 团队已经建立了一种方法来阻止这种情况，因此您可以编写如下内容：

```
jQuery(document).ready(function(){...}); 
```

代替

```
$(document).ready(function(){...}); 
```

这将让您并排使用 jQuery 和任何其他 JavaScript 库。阅读他们关于该主题的文档 - *[Using jQuery with Other Libraries](http://docs.jquery.com/Using_jQuery_with_Other_Libraries)*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T10:22:37.847

除了 sanchothefat 说的，你真的应该尽量避免同时使用两个这样的框架，因为它们本质上做同样的事情。如果您没有对 Javascript 进行 gzip 压缩，那么您可能仅向用户发送了至少 150-200k 的 JavaScript 以及库，更不用说您正在使用的插件了。几乎你在 MooTools 中所做的任何事情都可以在 jQuery 中完成，反之亦然。如果您环顾四周，您可能会发现执行您正在寻找的操作的脚本已被双向移植。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T10:25:06.000

您还可以看到 jQuery 的[.noConlict](http://docs.jquery.com/Core/jQuery.noConflict)方法的使用。不知道对你有没有用...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-02T08:07:58.320

jQuery 的 MooTools：http: [//moo4q.com/](http://moo4q.com/)

**jQuery <3 DOM** jQuery 很棒，但它的范围是（通常）DOM [操作]
**MooTools <3 对象**MooTools 可以处理 [javascript] 对象哈克贝利派。

# grails - 如何在已部署的 grails 应用程序中查找 GSP 文件的物理路径

> ID：491067
> 
> 赞同：4
> 
> 时间：2009-01-29T09:57:45.260
> 
> 标签：grails

我需要找出 grails GSP 文件的物理路径。

我的要求是我想在运行时创建一个新的布局文件并在应用程序中使用它。

当应用程序在码头（grails run-app）上运行时，我已经能够毫无问题地实现这一点，但是，当我在 Jboss 上部署应用程序时，需要创建文件的路径会发生变化。

所以，理想情况下，我想在运行时使用一些神奇的实用程序找出特定 GSP 的路径（比如说 main.gsp 布局文件），我需要在 main.gsp 所在的同一目录中创建我的新布局。

任何指针？

-迪帕克

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-29T11:17:56.830

这是一些在生产环境中查找布局文件夹路径的常规代码（例如，当部署为 jboss 上的战争时）：

```
import org.codehaus.groovy.grails.commons.ApplicationHolder

...

File layoutFolder = ApplicationHolder.application.parentContext.getResource("WEB-INF/grails-app/views/layouts").file      
def absolutePath = layoutFolder.absolutePath
println "Absolute Path to Layout Folder: ${absolutePath}"
File newLayoutFile = new File(layoutFolder, "foo.gsp") 
```

要使用新创建的布局，您可能需要重新启动 Web 应用程序或容器，因为视图是在生产模式下进行的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-19T02:49:56.870

有一个确定的方法...

```
grailsApplication.parentContext.getResource("WEB-INF/grails-app/views/path/to/my.gsp").file.toString() 
```

没有控制器（例如引导程序）？注入就行了。。

```
def grailsApplication 
```

最好的祝福！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-25T02:06:17.120

在控制器中，您可以使用

```
grailsAttributes.getApplicationContext().getResource("/relative/path/").getFile().toString() 
```

# sharepoint - 列表中的最大查找字段

> ID：491070
> 
> 赞同：1
> 
> 时间：2009-01-29T09:59:06.177
> 
> 标签：sharepoint, list, lookupfield

在 SharePoint 2007 中，列表中可以拥有的查找字段的数量是否有限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T12:45:14.500

不，但是您可能需要牢记“2000 年规则”。

微软声明如下：

每个文档库 2,000 列和每个列表 4,096

但这些不是硬性限制，它们是性能指南。您可以[在此处查看有关 SharePoint 体系结构和性能限制的完整 TechNet 文章](http://technet.microsoft.com/en-us/library/cc262787.aspx)

# javascript - 在 iframe 中获取 img 标签

> ID：491072
> 
> 赞同：1
> 
> 时间：2009-01-29T09:59:53.367
> 
> 标签：javascript, iframe, prototype

我有一个类名 =“blaclass”的 iframe。在它里面，我有一个没有名字（或 id）的 div，在这个 id 里面有一个类名 = "classs" 的 div。在这个 div 里面，有两张图片（没有类名/id）。

我怎样才能得到那些 image.src？如果有原型版本就更好了！

PS：我无法在页面完全呈现之前添加类名/ID（我没有创建 iframe - 它是通过 javascript 动态创建的，然后我运行我的脚本）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T12:45:31.473

一个.html：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<body onLoad="foo()">
  <iframe src="b.html">
    </iframe>
<script type="text/javascript">
function foo()
{
alert(window.frames[0].document.getElementsByClassName("classs")[0].getElementsByTagName("img")[0].src);
}
</script>
</body>
</html> 
```

b.html：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<body>
   <div>
   <div class="classs">
   <img id="img" src="test.png" />
   <img id="img" src="test.png" />
   </div>
   </div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T16:14:17.807

还要确保 iframe 所在的域与其指向的域相同。否则您将无法从 iframe 中获取任何信息。

# iphone - iPhone 开发 - 模拟内存警告

> ID：491075
> 
> 赞同：5
> 
> 时间：2009-01-29T10:00:24.613
> 
> 标签：iphone, memory, warnings, simulator

**背景**：

我有一个标签栏应用程序。每个选项卡都包含导航控制器，允许用户从一个视图转换到另一个视图，显示数据的深入信息（每个视图都由视图控制器处理，每个视图控制器类都有`didReceiveMemoryWarning`方法）。通过从 Web 服务中提取数据来填充列表。

**问题**：

当我使用 iPhone 模拟器的“硬件 > 模拟内存警告”选项时，`didReceiveMemoryWarning`我的所有视图控制器都会调用该方法 - 甚至是用户正在查看的那个。我不想清除活动视图控制器正在使用的任何内容。我怎样才能做到这一点？

由于内存警告而释放数据后，哪种方法应该具有重新加载数据的实现？`viewDidLoad`（当用户返回该视图时，我看到包含表视图调用方法的视图控制器类，但如果视图包含（例如 UIWebView）`viewDidLoad`则不调用方法。为什么会这样？）

**已编辑（2009 年 1 月 30 日星期五 - 下午 3:10）**

（注意：我使用 Interface builder 来创建视图，并且`loadView`方法被注释掉了。）

因此，当视图控制器收到内存警告消息时，将执行以下步骤：

1.  调用以下方法：

    ```
    - (void)didReceiveMemoryWarning {
        [super didReceiveMemoryWarning]; 
    } 
    ```

2.  作为调用的结果`[super didReceiveMemoryWarning]`，`[self setView:nil]`被自动调用？

3.  如果要清除任何资源，`setView`则应覆盖方法以清除本地资源。

4.  `[self setView:nil]`如果视图当前处于活动状态，则不会调用（默认情况下）。对？- 我真的很好奇哪种方法做出这个决定以及如何做出决定？

请你确认一下。另外，我在遵循这种方法时遇到了一个错误，但是在控制器类的方法中`myObject = nil`发布后添加解决了这个问题。谢谢。`myObject``dealloc`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-05-05T03:43:56.687

这是一个老问题，但我没有看到正确的答案，所以这里是：

当收到内存警告时，`-didReceiveMemoryWarning`会在所有视图控制器中调用，无论它们是否是“当前”视图控制器。视图控制器只是监听内存警告事件广播。

如果在内存警告时没有使用视图控制器的视图，控制器将通过将属性设置为 nil 来卸载它。它如何知道视图是否被使用？由视图的`-superview`属性。如果`view.superview`为 nil，则视图不属于任何树，可以安全卸载。

一旦发生这种情况，控制器`-viewDidUnload`就会被调用。这是卸载任何出口的正确位置，以及将在`-viewDidLoad`.

* * *

那是`-didReceiveMemoryWarning`为了什么？您的控制器可能具有在访问之前不会被实例化的对象。例如，您可能有一个控制器有时需要文件中的大量数据，但并非总是如此。您可以为它设置一个属性，如下所示：

```
- (NSData*)bigChunkOfData {
  // Get data from our instance variable _data, read from disk if necessary
  if (_data == nil) {
    _data = [[NSData alloc] initWithContentsOfFile:@"/path/to/data"];
  }
  return _data;
} 
```

这将第一次从磁盘读取数据，然后将其保存在实例变量中。由于该`_data`变量是按需创建的，因此我们可以安全地在内存不足的情况下将其卸载：下次我们需要它时会再次创建它。

```
- (void)didReceiveMemoryWarning {
  [super didReceiveMemoryWarning];

  [_data release];
  _data = nil;  // <-- Very important: don't leave strong references dangling.
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-29T10:31:20.933

我是这样清理的：

```
-(void)setView:(UIView*)view
{
    [super setView:view];
    if(view == nil)
    {
       // Our view has been cleared, therefore we should clean up everything 
       // we are not currently using
.... 
```

`setView:nil`由 UIViewController 调用以响应内存警告，如果该视图当前不可见 - 这基本上是您想知道的。

已编辑

在回答后续行动：

1.  正确的。
2.  这就是我所做的，它对我有用。
3.  正确的。`didReceiveMemoryWarning`UIViewController 中的实现就是这样做的。如果你不覆盖`didReceiveMemoryWarning`，那么 UIViewController 中的基类实现将被调用——如果你覆盖它，显然你应该调用：

    ```
    [super didReceiveMemoryWarning] 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-01T03:48:50.363

关于视图管理和内存警告：

UIKit 不仅允许从视图控制器导航回来，还允许从现有视图控制器导航到其他视图控制器。在这种情况下，将分配一个新的 UIViewController，然后将其加载到视图中。旧的视图控制器将离开屏幕并变为非活动状态，但仍拥有许多对象——一些在自定义属性和变量中，而另一些在视图属性/层次结构中。就其视图对象而言，新的可见视图控制器也是如此。

由于移动设备的内存量有限，拥有这两组对象——一组在屏幕外视图控制器中，另一组在屏幕视图控制器中——可能难以处理。如果 UIKit 认为有必要，它可以回收一些屏幕外视图控制器的内存，这些内存无论如何都不会显示；UIKit 知道哪个视图控制器在屏幕上，哪个在屏幕外，毕竟，它是管理它们的人（当您调用`presentModalViewController:animated:`或`dismissModalViewControllerAnimated:`）。因此，每当它感到有压力时，UIKit 都会生成一个内存警告，它会从视图层次结构中卸载并释放您的屏幕外视图，然后调用您的自定义 viewDidUnload 方法来为您的属性和变量执行相同的操作。UIKit 自动释放 self.view，允许我们在 viewDidUnload 代码中手动释放变量和属性。它适用于所有屏幕外视图控制器。

当系统内存不足时，它会触发`didReceiveMemoryWarning`. 屏幕外视图将在内存警告时被回收和释放，但您的屏幕视图不会被释放——它是可见的和需要的。如果您的班级拥有大量内存，例如缓存、图像等，`didReceiveMemoryWarning`您应该清除它们，即使它们在屏幕上；否则，您的应用程序可能会因系统资源过剩而终止。您需要重写此方法以确保清理内存；只记得你打电话`[super didReceiveMemoryWarning];`。

此处提供了更详细的解释：http: [//myok12.wordpress.com/2010/11/30/custom-uiviewcontrollers-their-views-and-their-memory-management/](http://myok12.wordpress.com/2010/11/30/custom-uiviewcontrollers-their-views-and-their-memory-management/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-29T05:28:01.200

为了确保我不必为我编写的每一个视图控制器都处理这个问题。我刚刚制作了一个 Xcode ViewController 模板，它提供了关于释放哪些对象以及何时释放的指南。

更多解释在这里[http://iphone2020.wordpress.com/2010/05/30/efficient-memory-handling-in-uiviewcontroller-part-1/](http://iphone2020.wordpress.com/2010/05/30/efficient-memory-handling-in-uiviewcontroller-part-1/)

希望它有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-29T16:05:24.117

幸运的是，模拟器有一个方便的功能，可以让您测试内存不足的情况。在 viewDidLoad 和 didReceiveMemoryWarning 中都放一些 NSLog() 语句，像这样：￼</p>

```
- (void)viewDidLoad {
    NSLog(@"viewDidLoad"); 
    ...
}

- (void)didReceiveMemoryWarning {
    NSLog(@"didReceiveMemoryWarning");
} 
```

# python - 如何将文件名作为参数传递到我的模块中？

> ID：491085
> 
> 赞同：11
> 
> 时间：2009-01-29T10:04:13.280
> 
> 标签：python, command-line, parameters, module

我在 .py 文件中有以下代码：

```
import re

regex = re.compile(
    r"""ULLAT:\ (?P<ullat>-?[\d.]+).*?
    ULLON:\ (?P<ullon>-?[\d.]+).*?
    LRLAT:\ (?P<lrlat>-?[\d.]+)""", re.DOTALL|re.VERBOSE) 
```

我将 .txt 文件中的数据作为一个序列：

```
QUADNAME: rockport_colony_SD
RESOLUTION: 10 ULLAT: 43.625 ULLON:
-97.87527466 LRLAT: 43.5 LRLON: -97.75027466 HDATUM: 27 ZMIN: 361.58401489 ZMAX: 413.38400269 ZMEAN: 396.1293335 ZSIGMA: 12.36359215 PMETHOD: 5 QUADDATE: 20001001 
```

如何使用 Python 文件来处理 .txt 文件？

我想我们需要 .py 文件中的参数，以便我们可以使用终端中的语法：

```
$ py-file file-to-be-processed 
```

这个问题是由[这里](https://stackoverflow.com/questions/489901/how-can-i-extract-x-y-and-z-coordinates-from-geographical-data-by-python/490347#490347)的帖子提出的。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-29T10:50:05.370

您需要读入文件，然后使用正则表达式搜索内容。sys 模块包含一个列表 argv，其中包含所有命令行参数。我们拉出第二个（第一个是用来运行脚本的文件名），打开文件，然后读入内容。

```
重新进口
导入系统

文件名 = sys.argv[1]
fp = 打开（文件名）
内容 = fp.read()

正则表达式 = 重新编译（
    r"""ULLAT:\ (?P-?[\d.]+).*?
    乌隆：\ (?P-?[\d.]+).*?
    LRLAT:\ (?P-?[\d.]+)""", re.DOTALL|re.VERBOSE)

匹配 = 正则表达式。搜索（内容）

```

有关可以使用匹配对象做什么的详细信息，请参阅[Python 正则表达式文档。](http://docs.python.org/library/re.html#id1)请参阅[文档的这一部分，](http://docs.python.org/library/re.html#search-vs-match)了解为什么我们在扫描文件时需要搜索而不是匹配。

此代码将允许您使用您在问题中指定的语法。

# c - 有程序员必须懂C吗？是的，为什么？没有为什么？

> ID：491086
> 
> 赞同：8
> 
> 时间：2009-01-29T10:04:15.433
> 
> 标签：c

自从我上大学的第一年以来，我一直羡慕我的同学（主要来自以技术为导向的专业学校）了解 C。我来自以自然科学为导向的学校，从未有过编程经验或课程，但在某个夏天使用 PHP 从 7 小时内自学 PHP 学习（我的编程兴趣是最近才发生的）。我想知道……这是一种正当的嫉妒吗？有程序员必须懂C吗？C 是否提供了对系统如何工作或必须如何进行编程的深入理解？我知道，在编写 C 语言时，您必须对缓冲区、内存等有深入的了解。所以我想听听你的意见。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-29T10:07:44.490

不，您不必了解 C。但是了解 C（或任何其他“接近机器但非汇编语言”的语言）极大地提高了您作为程序员的潜力。因为你会了解更多的内部运作。

当然，汇编程序的知识也很有价值。但是在上面的段落中，我想针对计算机语言的低端。仅仅因为在现代语言中，我们认为太多是理所当然的（OO、广泛的库、垃圾收集等等）。是的，它可以帮助我们程序员更有效地工作。但它隐藏了我们有时需要看到的一些机器方面，这就是为什么我们需要了解内部运作如此重要的原因。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-29T10:21:19.300

虽然我认为理解内存分配、指针、寄存器等很重要……但我想说，过多的 C 语言经验也可能成为掌握高级语言或 OO 语言的障碍。C 倾向于让你在程序上思考，在某些情况下这可能是一件坏事......

我绝对不会推荐 C 作为第一语言，但在某些时候做一些 C 会很有帮助......

作为旁注，我认为汇编可以更有用地帮助您理解基本原理。同时，汇编与您将使用的任何语言都相距甚远（除非您在非常专业的领域工作）。这将帮助您在进行汇编时保持与使用更高级别语言时不同的心态。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-29T10:12:05.433

这是一个非常值得讨论的话题。我个人认为，当您了解幕后发生的事情时，了解 C 也可以增强您使用其他语言的*能力*。但是您不必了解 C**就**能够生成高质量的代码。

埃里克·辛克也曾想过[这个问题](http://www.ericsink.com/entries/c_morse_code.html)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-29T15:22:12.343

我发现大多数答案中缺少的一点是 C 是一种非常容易学习的语言。您需要了解的有关语法的所有内容都包含在一本简明扼要的书 (K&R) 中，其中包括所有标准库。所以我鼓励你至少浏览一本书，看看它的全部内容，即使你不打算使用它。

这种简单的 C 语法仅*适用*于大多数基于 C 的现代语言（C++、C#、Java）。在您至少掌握了数百个库中的一个子集之前，您不能说您真的了解这些语言，这可能需要数月或数年的经验。

C 语言的难点在于它可以让你了解底层机器的真实本质。如果您真的想了解计算机的工作原理，您需要了解指针、内存分配以及堆栈与堆与可执行代码等内容。您可以在几个小时内学习基本的 C 语法，这将使您走上理解更多内容的道路。说“我是 C 专家”只是说“我真的了解计算机是如何工作的”的代名词。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-29T10:11:08.227

您不一定必须了解 C，但 imo 每个程序员都应该了解基本的机器架构以及应用程序如何与操作系统和硬件交互。

显然，如果你要学习这个，C 语言是一个不错的选择，但不是唯一的选择。

了解 C 的另一个好理由是很多代码都是用 C 编写的，所以如果你想从其他代码中学习，这将非常有帮助。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-29T10:12:55.633

除了 Gamecats 的回答之外，根据我与其他语言的人一起工作的经验，懂 C 的人和不懂 C 的人在技能上存在差异。我主要使用 Java 工作，当然很高兴在我之前用 C 语言工作了几年。除此之外，我还做了相当多的 Perl 工作。我想说的是，了解尽可能多的语言有助于让您对自己的工作有不同的看法并应用不同的范式

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-29T10:24:16.330

C 不是我选择的语言，但直到今天，C 无处不在。

当我使用 LuaCurl 在 Lua 中编写一些小代码时，我使用 C 库。Lua 本身是用 C 语言编写的。

当我在 Squeak Smalltalk 中做一些 Seaside Web 应用程序时，我使用用 C 生成的 VM（Squeak VM 是用 Smalltalk 编写的，然后它生成 C 代码作为可移植的汇编程序）。

所以我不会开始学习 C 编程（请参阅[此线程](https://stackoverflow.com/questions/4769/what-is-the-easiest-language-to-start-with)以了解其他选择），但作为一名程序员，即使它不是您选择的语言，了解 C 也非常方便。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-29T14:16:59.883

就像不是每个机械师都需要知道修理汽车的发动机的内部工作原理一样，也不是每个程序员都需要学习 C 来编写代码。但是，这样做的人会更好地了解工艺并最终取得更高水平的成功。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-29T10:25:33.113

**内存分配和指针。**

在开始处理 C 和 C++ 之后，即使只是在学校，您也可以更好地了解内存中需要发生的事情，以便您可以抛出对象和引用，并且您可以更好地了解垃圾收集等内容暗示。

此外，在学校里，从 Pascal 开始，然后是 C，我们可以先用旧方法学习“编程”，然后在此基础上转向更高级的语言（OOP 等**）**。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-29T10:38:44.287

但是，我与该线程中的其他人有着相同的看法，以回答所提出的问题：

唯一*必须*了解 C 的程序员是 C 程序员。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-29T10:50:00.550

所有的知识都是有用的，所以是的，你应该羡慕他们的知识。你还应该羡慕那些 AI nerd 并且知道 LISP 等的人。最好的组合是动态语言、函数式语言、SQL、低级语言和面向对象的语言。

如果你想让陌生人提出一些建议，我会选择 Python、OCaml、SQL、C 和 Java/C#。但是，找到你自己的路径:-)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-29T10:59:26.367

我想你有。

语言有自己的演变。它们是在计算机系统的一个非常有趣和快速发展的过程中发展起来的。CPU 能力增加了，功能增加了，汇编器变得更复杂了……一切都变得更强大了。

问题是：如果您从未见过低级和“简单”的开端，而是从一些高级语言（如 C#、C++ 或 Java）开始，您将无法理解这些非常强大的语言的优雅或后端视角。

我认为您不需要学习 LISP，因为 if 与常见的类 C 语言有很大不同。但是有些C是必须知道的。它适用于来自开发人员的开发人员，非常接近机器代码。编程时了解机器的功能。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-29T10:30:19.500

必须知道/学习C？可能不会，尽管它可能会使学习一些概念更容易。了解一些关于内存分配、结构和各种指针的知识是值得的，C 是一种很好的语言来获得这种理解。另外，老实说，“直接”C 真的不复杂。做对很棘手，当然，但本身并不复杂。我建议获取一个也不是 C++ 的编译器，那样会很疯狂。（Quick C For Windows 的美好回忆）

必须了解/学习 C++？当然不。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-29T11:18:55.390

我会用一个比喻：对于程序员来说了解 C 就像对于（西方语言）作家来说了解拉丁语一样。这不是你需要的东西，特别是如果你只是写体育专栏或烹饪食谱书，但如果你想改进你的手艺，我认为这几乎是强制性的。但它对于普通软件的日常工作没有用处。或者了解汽车飞行员的机械师，或者如何为水手制造风帆。在一定程度的专业知识上，您需要知道您使用的东西在内部是​​如何工作的。

如果您学习 C，请尝试掌握指针概念，以及它们映射到硬件的方式。这就是学习 C 的真正意义所在。不要把时间花在语言的其余部分上。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-29T15:13:52.343

也许这只是我的特殊教育经历，但我在大学时讨厌 C/C++，从那以后就再也没有碰过它。我很感谢学习所涉及的概念，例如指针和内存分配，但是尝试使用可用的工具来完成任何事情对我来说太麻烦了。我希望你的体验会更好。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-29T15:19:24.347

（“稍微”含糊其辞）你应该学习它，如果没有其他原因，它会让你**爱上**你当时正在使用的任何语言。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-29T15:24:16.380

我不称自己为 C 程序员，但我可以用 C 编写代码。它在我的职业生涯中帮助了我很多次。我花了很多时间使用 Visual Basic，而有些事情是用 VB 做不到的。下拉到 C 来做诸如 windows 钩子之类的事情非常方便。这让我有一两次成为“英雄”。

# programming-languages - 除了内存之外，是否有编程语言支持自动管理资源的示例？

> ID：491092
> 
> 赞同：1
> 
> 时间：2009-01-29T10:06:25.350
> 
> 标签：programming-languages, resource-management, language-concepts

自动内存管理的想法得到了新编程语言的大力支持。如果存在用于自动管理其他资源（如文件、网络套接字等）的概念，我很感兴趣？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T10:21:09.220

对于单线程应用程序，在代码块的范围内可用资源的模式，在最后进行清理，存在于多种语言中。示例是在 C++ 中使用[RAII ，或在 Common Lisp 中](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)[使用 with-open-file](http://www.lispworks.com/documentation/HyperSpec/Body/m_w_open.htm)（以及在受 Lisp 影响的较新语言中的等价物 - 在 Dylan、[C#](http://msdn.microsoft.com/en-us/library/yh598w02(VS.80).aspx)、[Python](http://docs.python.org/reference/compound_stmts.html#the-with-statement)和 Ruby 中相同，您可以将块传递给文件对象）。

我不知道有什么更适合现代垃圾收集闪耀的多线程环境，除了在 C++ 中结合 RAII 和引用计数或 auto_ptr，这并不总是一个微不足道的组合。

资源自动管理和自动内存管理之间的一个重要区别是，内存管理通常可以承受非确定性，并且仅在进程需要时才回收，而资源通常在操作系统级别受到限制，因此应尽快回收因为它不再使用。因此选择智能指针而不是垃圾收集作为管理实现。有一个中间级别的资源 - GDI 对象、临时文件句柄、线程 - 应用程序希望限制它使用的总量，但不太关心将它们释放给其他进程 - 这些通常是池化的，这会让你得到一些走向自动化管理的道路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T10:28:17.257

我们现在可以自动管理内存分配的原因之一是我们拥有这么多内存。

在记忆紧张的日子里，您必须充分利用系统的每一口。

文件句柄和套接字等其他资源要少得多，仍然需要手动处理（双关语）。

再考虑一下 .net compact 框架，Windows 移动设备拥有 32mb 或 64mb 的易失性内存来玩的情况并不少见 - 当你考虑它时 - 仍然是“很多”。

我想知道 .net 紧凑框架的占用空间是多少，以及它在具有 4mb 易失性内存的诺基亚手机上的性能如何。

有人有什么想法吗？（这是一个维基答案，请随时更正或添加更多细节）

所以，IMHIO，我们可以承受缓慢的内存回收，因为我们不会匆忙用完它，而其他资源则不是这样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T11:21:20.037

Object persistence and caching subsystems can be considered an automatic allocation of files and resources. If you apply a caching subsystem to a network connection you don't have to care about file opening, file deleting, and so on.

A way to manage automatically network connection could be done in parallel computing environment (i.e MPI), you can set programmatically the shape of the processors interconnections. Than you just send a message from a process to another, almost ignoring the way it's implemented. Sometimes those messages are translated in sockets.

If you have a function that let you get a page from its Url, would you consider it a sort of Automatic socket management?

# open-source - Ms-RL - 需要解释

> ID：491099
> 
> 赞同：3
> 
> 时间：2009-01-29T10:08:56.623
> 
> 标签：open-source, licensing

我目前正在努力理解[Ms-RL](http://en.wikipedia.org/wiki/Shared_source#Microsoft_Reciprocal_License_.28Ms-RL.29)（微软互惠许可证）。我现在读了四次许可证，但我仍然不确定以下几点：（特别是关于许可证的 3A 和 3E）

如果我使用该库，没有任何更改，我是否必须发布我的应用程序的源代码？

将 Ms-RL 添加到我自己的许可证中是否足以说明它对使用的库的有效性？

更新：

我必须在 Ms-RL 下发布我的整个应用程序吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T10:19:52.110

[完整许可文本](http://www.opensource.org/licenses/ms-rl.html)的链接。

并引用要求的段落：

*   3(A) 互惠赠款 - 对于您分发的任何包含软件代码（源代码或二进制格式）的文件，您必须向收件人提供该文件的源代码以及本许可的副本，该许可将管辖文件。您可以根据您选择的任何条款许可其他完全属于您自己作品且不包含软件代码的文件。

[翻译：对于每个使用Ms-RL](http://en.wikipedia.org/wiki/Shared_source#Microsoft_Reciprocal_License_.28Ms-RL.29)下文件的文件，您需要提供源和许可证副本。

*   3(E) 如果您以源代码形式分发软件的任何部分，您只能在本许可下这样做，在您的分发中包含本许可的完整副本。如果您以编译或目标代码的形式分发软件的任何部分，您只能在符合本许可的许可下这样做。

翻译：如果您在 Ms-RL 下分发任何部分代码（作为源代码），您只能使用 Ms-RL 执行此操作。您需要附上许可证的副本。如果您仅分发已编译或目标代码，则可以使用与 Ms-RL 兼容的任何许可证来执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-22T02:59:48.260

来自维基百科：

> 只要包含修改后的源文件并保留 Ms-RL，此 Microsoft 许可证就允许分发派生代码。Ms-RL 允许分发中不包含最初根据 Ms-RL 许可的代码的那些文件根据版权所有者的选择获得许可。这相当于 CDDL、EPL 或 LGPL（GPL 具有典型的“链接异常”）。

我会说这个许可证就像 LGPL。

> For any file you distribute that contains code from the software (in source code or binary format), you must provide recipients the source code to that file along with a copy of this license, which license will govern that file.

As long as your source files do not **contain code** from the software with this license, you don't have to apply the MS-RL to those files. The license is still attached to the "files" containing MS-RL code.

Typically you would license the entire software any way you wish, then add an exception for the files containing MS-RL code.

Disclaimer: I'm not a lawyer and i could be wrong.

# unit-testing - 使用依赖注入系统如何对代码进行单元测试

> ID：491103
> 
> 赞同：7
> 
> 时间：2009-01-29T10:10:58.960
> 
> 标签：unit-testing, dependency-injection

据我所知，有两种方法，都有各自的缺点。

1.  从依赖注入系统中获取您正在单元测试的对象。这是低维护，因为您在更改框架时无需管理任何内容。但是您实际上是从对象的角度测试整个系统，如果一个组件失败，它可能会破坏大量单元测试，并且可能不清楚哪个失败了。

2.  是在单元测试中手动管理依赖关系，在某些情况下创建测试对象，以便您可以单独测试每个对象。这使单元测试保持谨慎，但大大增加了单元测试本身的维护。这也意味着您不会发现由于对象在您的实时系统上交互的方式而导致的错误。

方法是对还是错？是否应该使用妥协？有没有人有任何成功的故事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T10:16:21.603

如果您正在编写**单元**测试，您应该为您的依赖项使用模拟，并且 IoC 容器不应该出现在图片中。您应该使用模拟手动注入的依赖项来实例化您的测试类。

如果您从已经连接好的 IoC 容器中获取对象，那么您正在编写的是非常不同的集成测试。

您编写单元测试的目标应该是将您的测试与系统的其他部分*隔离*开来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T10:13:15.460

您想使用自动模拟容器为您管理依赖项。StructureMap中[内置了一个](http://codebetter.com/blogs/jeremy.miller/archive/2008/02/09/automocker-in-structuremap-2-5.aspx)，并且您自己的滚动并不难。

自动模拟容器的基本前提是您对需要/关心的依赖项设置期望，并为您创建任何其他依赖项的模拟。这意味着，如果您向一个类添加依赖项，您不一定要返回并更改它的每个测试；只是那些将使用新依赖项的人。

在我看来，第一种方法是错误的——正如你所提到的——它不一定是你正在测试的对象会导致测试失败。

# ruby-on-rails - 在 Rails 中运行测试套件的速度

> ID：491106
> 
> 赞同：4
> 
> 时间：2009-01-29T10:11:48.553
> 
> 标签：ruby-on-rails, testing

我的应用程序（使用 Shoulda）有 357 个测试（534 个断言）。整个测试套件在大约 80 秒内运行。这次可以吗？我只是好奇，因为这是我第一个广泛编写测试的应用程序之一。我的应用程序中没有花哨的东西。

顺便说一句：我尝试在内存中使用 sqlite3 数据库，但结果出奇的差（大约 83 秒）。这里有什么线索吗？

我正在使用具有 2GB RAM 和 2GHz Intel Core Duo 处理器的 Macbook 作为我的开发机器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T10:46:14.380

我不觉得这个问题是特定于 Rails 的，所以我会插话。

测试的主要内容是它应该足够快，让您可以多次运行它们（例如，一直）。此外，您可能希望将测试分成几个不同的集合，特别是“长时间运行测试”和“单元测试”之类的东西。

如果您的数据库设置很耗时，最后一个要考虑的选项是通过从备份恢复来创建您的域，而不是执行一大堆插入操作。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-26T14:52:10.257

您应该尝试这种方法[https://github.com/dchelimsky/rspec/wiki/spork---autospec-==-pure-bdd-joy-](https://github.com/dchelimsky/rspec/wiki/spork---autospec-==-pure-bdd-joy-)使用 spork 来启动几个保持运行并批量处理的进程测试。我发现它非常快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T10:42:55.230

这实际上取决于您的测试在做什么。测试代码可以高效地编写，也可以与任何其他代码完全不同。

在许多情况下，一个明显的优化是以这样一种方式编写测试代码，即一切（或尽可能多地）都在内存中完成，而不是对数据库进行多次读/写。但是，您可能必须更改应用程序代码才能拥有正确的接口来实现此目的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T11:58:50.147

Large test suites can take some time to run.

I generally use "autospec -f" when developing, this only runs the specs that have changed since the last run - makes it much more efficient to keep your tests running.

Of course, if you are really serious, you will run a Continuous Integration setup like Cruise Control - this will automate your build process and run in the background, checking out your latest building and running the suite.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T12:32:11.563

如果您希望加快测试套件的运行时间，那么我会使用[来自 Roman Le Négrate 的测试服务器。](http://roman.flucti.com/a-test-server-for-rails-applications)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-08T19:50:45.367

您可以尝试使用预加载装置，但它会更难维护，而且，恕我直言，不值得提高速度（我认为最多 20%，但这取决于）

众所周知，SQLite 比 mysql/pgsql 慢，除了**非常小的 DB**。

正如有人已经说过的，您可以将 mysql（或其他 DB）数据文件放在某种 RAMDisk 上（我在 linux 上使用 tmpfs）。

PS：我们现在有 1319 个 Rspec 示例，它在 C2D-3Ghz-4GRam 上运行了 230 秒，我认为这很好。所以，你的也很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-08T19:39:48.413

与内存 SQLite 相反，您可以将 MySQL 数据库放在 RAMDISK（Windows 上）或 Linux 上的 tmpfs 上。

MySQL 有一个非常有效的缓冲，所以将数据库放在内存中并没有多大帮助，除非你真的经常更新大量数据。

更重要的是每个测试的测试隔离和数据准备的方式。

您可以使用事务性固定装置。这意味着每个测试都将被包装到事务中，因此下一个测试将从初始点开始。

这比在每次测试之前清理数据库要快。

在某些情况下，您想同时使用事务和显式数据擦除，这里有一篇关于它的好文章：[http ://www.3hv.co.uk/blog/2009/05/08/switching-off-transactions-for -a-single-spec-when-using-rspec/](http://www.3hv.co.uk/blog/2009/05/08/switching-off-transactions-for-a-single-spec-when-using-rspec/)

# java - flash 如何通过 J2EE 身份验证 - 它无法发送包含 jsessionid 的 cookie

> ID：491109
> 
> 赞同：0
> 
> 时间：2009-01-29T10:12:07.680
> 
> 标签：java, flash, security, authentication, cookies

我们有一个 J2EE 应用程序的网页，用户可以在其中登录应用程序。它包含一个 Flash 小部件，该小部件需要使用用户创建的会话调用服务器中的服务。网页将 jsessionid 传递给 flash 小部件，以便 flash 使用它来通过身份验证。

但是，由于安全限制，flash 播放器阻止了此操作，禁止 flash 发送 cookie。

有没有办法让闪存访问受保护的服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T11:30:04.980

I don't know flash but you should be able to configure your app/server to encode the session in the url instead of using a cookie. It is a bit messy but it does work.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T06:21:54.313

您应该能够将您的应用服务器配置为使用 URL 重写而不是 JSESSIONID cookie。这是有关如何在 WebSphere v5 中执行此操作[的一些信息](http://publib.boulder.ibm.com/infocenter/wasinfo/v5r0/index.jsp?topic=/com.ibm.websphere.base.doc/info/aes/ae/rprs_sesd.html)

# wpf - 单击某个空白区域时如何取消选择WPF树视图中的所有选定项目？

> ID：491111
> 
> 赞同：9
> 
> 时间：2009-01-29T10:12:53.277
> 
> 标签：wpf

我对 WPF 有一个相当有趣的问题。我有一个树视图，到目前为止选择项目工作正常。问题是，当用户在树视图的空白区域内单击时，我想取消选择当前选定的项目。默认情况下，树视图保持当前项目处于选中状态，并且我添加了一个上下文菜单选项来取消选择它，这是相当硬核的：

```
// Note: This is done recursivly from the start, so it
// works for child items as well
treeView.ItemContainerGenerator.ContainerFromItem(treeView.SelectedItem) as TreeViewItem).IsSelected = false; 
```

而且，这是违反直觉的，因为它需要用户首先右键单击，其次，使用这种方式取消选择后，用户无法通过单击该项目再选择它。这应该如何工作？

编辑：更多信息：我添加了一个处理程序来`TreeView`处理鼠标单击事件，但发送者始终是一个`TreeView`实例，即使我直接单击`TreeViewItem`. 如果我向我添加一个处理程序`TreeView.ItemTemplate`（即模板中的第一个孩子），当我单击空白区域时，我永远不会收到事件（这是相当合乎逻辑的）。代码如下所示：

```
 private void MyTreeView_MouseUp(object sender, System.Windows.Input.MouseButtonEventArgs e)
    {
        if ((sender as TreeViewItem) == null)
        {
            // Always triggered
            System.Diagnostics.Trace.Write("Empty area clicked");
        }
    } 
```

用于此的 XAML 是：

```
<TreeView x:Name="MyTreeView" Margin="3" MouseUp="MyTreeView_MouseUp"> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-15T14:36:28.957

我发现这对我来说效果更好。我检查了原始来源，如果它来自树视图项，对我来说将是图像或文本块。我还使用带有 HierarchicalDataTemplate 的视图对象，BasicTreeViewBase 是我所有不同对象的基类。这是代码。

```
private void TemplateTreeView_MouseDown(object sender, MouseButtonEventArgs e)
    {
        if (e.ChangedButton == MouseButton.Right && !(e.OriginalSource is Image) && !(e.OriginalSource is TextBlock))
        {
            BasicTreeViewBase item = TemplateTreeView.SelectedItem as BasicTreeViewBase;
            if (item != null)
            {
                TemplateTreeView.Focus();
                item.IsSelected = false;
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-30T19:53:36.053

在设置 TreeViewItem.IsSelected 后，可以通过在 TreeView 上调用 Focus 来解决不可选择的问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-06-06T11:35:15.027

可能还有两个问题：

1.  树视图已绑定，因此 SelectedItem 是绑定集合的一项。
2.  有很多级别，因此 ItemContainerGenerator 不包含最深级别的对象

出于所有这些原因，我使用此功能，但选择不得触发任何事件。

```
private void UnselectTreeViewItem(TreeView pTreeView)
{ 
  if(pTreeView.SelectedItem == null)
    return;

  if(pTreeView.SelectedItem is TreeViewItem)
  {
    (pTreeView.SelectedItem as TreeViewItem).IsSelected = false;
  }
  else
  {
    TreeViewItem item = pTreeView.ItemContainerGenerator.ContainerFromIndex(0) as TreeViewItem;
    if (item != null)
    {
      item.IsSelected = true;
      item.IsSelected = false;
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-15T14:43:54.983

我实现了一次通用选择控制，并且需要这种行为。

这就是我的方法的外观（适用于树视图）：

```
protected override void OnMouseUp(MouseButtonEventArgs e)
{
    base.OnMouseUp(e);

    DependencyObject dpSource = e.OriginalSource as DependencyObject;

    if (dpSource.FindVisualAncestor(o => typeof(TreeViewItem).IsAssignableFrom(o.GetType())) == null)
            UnselectAll();
} 
```

基本上，从源头向上走。如果未找到 TreeViewItem，则表示用户单击了空白区域。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-09-16T14:09:24.523

使用下面的扩展类

```
public static class TreeViewExtensions
{
    public static TreeViewItem ContainerFromItem(this TreeView treeView, object item)
    {
        TreeViewItem containerThatMightContainItem = (TreeViewItem)treeView.ItemContainerGenerator.ContainerFromItem(item);
        if (containerThatMightContainItem != null)
            return containerThatMightContainItem;
        else
            return ContainerFromItem(treeView.ItemContainerGenerator, treeView.Items, item);
    }

    private static TreeViewItem ContainerFromItem(ItemContainerGenerator parentItemContainerGenerator, ItemCollection itemCollection, object item)
    {
        foreach (object curChildItem in itemCollection)
        {
            TreeViewItem parentContainer = (TreeViewItem)parentItemContainerGenerator.ContainerFromItem(curChildItem);
            TreeViewItem containerThatMightContainItem = (TreeViewItem)parentContainer.ItemContainerGenerator.ContainerFromItem(item);
            if (containerThatMightContainItem != null)
                return containerThatMightContainItem;

            TreeViewItem recursionResult = ContainerFromItem(parentContainer.ItemContainerGenerator, parentContainer.Items, item);
            if (recursionResult != null)
                return recursionResult;
        }
        return null;
    }
} 
```

然后在 Treeview 的 MouseDown 事件中使用如下扩展方法：

```
 private void trview_MouseDown(object sender, System.Windows.Input.MouseButtonEventArgs e)
    {
        if ((sender as TreeViewItem) == null)
        {
            if (this.trview.ContainerFromItem(trview.SelectedItem) != null)
            {
                this.trview.ContainerFromItem(trview.SelectedItem).IsSelected = false;
            }
        }
        this.trview.Focus();
    } 
```

希望对你有效。我让它以这种方式工作......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-12T19:18:01.033

在寻找了很长时间后，我自己使用自定义树列表视图实现遇到了这种情况，我终于找到了适合我的解决方案。

完整的解释可以在[http://social.msdn.microsoft.com/Forums/vstudio/en-US/36aca7f7-0b47-488b-8e16-840b86addfa3/getting-treeviewitem-for-the-selected-item-in找到-a-treeview](http://social.msdn.microsoft.com/Forums/vstudio/en-US/36aca7f7-0b47-488b-8e16-840b86addfa3/getting-treeviewitem-for-the-selected-item-in-a-treeview)

基本思想是捕获`TreeViewItem.Selected`事件并将事件源保存到`Tag`TreeView 的属性中。然后，当您需要清除它时，您可以访问`Tag`控件上的属性并将`IsSelected`值设置为 False。这适用于我有 2 级嵌套子级。希望它对你有用。

为了坚持：

树视图声明

```
 <TreeView Name="myTreeView" TreeViewItem.Selected="OnItemSelected"
    ItemsSource="{Binding Source={StaticResource myHierarchicalData}}"/> 
```

事件处理程序

```
private void OnItemSelected(object sender, RoutedEventArgs e)
{
    myTreeView.Tag = e.OriginalSource;
} 
```

清除选择逻辑

```
if (myTreeView.SelectedItem != null)
{
    TreeViewItem selectedTVI = myTreeView.Tag as TreeViewItem;
    // add your code here mine was selectedTVI.IsSelected = false;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T04:21:21.613

如果没有点击，这将取消选择当前选择的 TreeViewItem：

```
private void MyTreeView_PreviewMouseDown(object sender, MouseButtonEventArgs e) {
    if ((sender as TreeViewItem) == null) {
        TreeViewItem item = MyTreeView.SelectedItem as TreeViewItem;
        if(item != null){
            item.IsSelected = false;                    
        }
    }
} 
```

希望这就是你要找的！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-24T09:26:27.103

MVVM：在事件处理程序中调用此方法鼠标右键/左键单击：

```
private void SetTreeViewSelection(object sender, MouseButtonEventArgs mouseButtonEventArgs)
{
  var treeView = (TreeView)sender;
  if (treeView.SelectedItem == null)
  {
    return;
  }

  IInputElement dropNode = treeView.InputHitTest(mouseButtonEventArgs.GetPosition(treeView));
  if (dropNode is ScrollViewer)
  {
    var myBindableObject = (MyBindableObject)treeView.SelectedItem;
    myBindableObject.IsSelected = false;
  }
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-05-27T15:02:13.093

对于 C# 树视图，您使用 treeview.SelectedNode = null; 我不确定这是否适用于 WPF。

# sql-server - 动态 SQL 是否更容易受到 SQL 注入/黑客攻击？

> ID：491130
> 
> 赞同：1
> 
> 时间：2009-01-29T10:23:22.820
> 
> 标签：sql-server

动态 SQL 是否更容易受到 SQL 注入/黑客攻击？如果是，如何预防？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T10:25:12.973

如果您使用参数而不是字符串连接来指定您的过滤条件，那么它不应该容易受到 Sql 注入的攻击。

例如：

做这个：

```
string sqlQuery = "SELECT * FROM Persons WHERE Persons.Name LIKE @name";

SqlCommand cmd = new SqlCommand ( sqlQuery );
...
cmd.Parameters.Add ("@name", SqlDbType.VarChar).Value = aName + "%"; 
```

而不是这个：

```
 string sqlQuery = "SELECT * FROM Persons WHERE Persons.Name LIKE \'" + aName + "%\'"; 
```

第一个例子对于 sql 注入来说并不容易受到攻击，但是第二个例子是非常容易受到攻击的。

例如，这同样适用于您在存储过程中使用的动态 SQL。在那里，您可以创建一个也使用参数的动态 sql 语句；然后，您应该执行动态语句，使用`sp_executesql`它可以指定参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T10:34:35.607

快速回答是肯定的，如果您在您的应用程序中动态构建 Sql，您必须了解流氓将尝试的每一个小技巧。当您使用存储过程时，其中大部分将由您的供应商处理。

减少 sql 注入机会的一个好方法是使用上述参数查询，如果不合适，请确保删除任何用户生成的字段中的非字母字符。去掉引号、分号等。还要确保你的连接只有足够的访问权限来做它需要做的事情，如果你只是查询数据，那么创建一个用户/安全组，无论它只允许选择，而不是更新，尤其是不允许删除。将 sql 写入日志也是一种很好的做法 - 这样您就可以知道人们在做什么，并且可以调整和发现注入尝试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T10:35:38.053

在 TSQL 中，您应该使用它`sp_ExecuteSql`来执行您需要的任何动态命令（例如，提供灵活的搜索/排序）。

请注意，除非您使用证书跳过一些障碍，否则您仍然需要`SELECT`对表的直接（等）权限（与 cab 隐式提供访问权限的 SPROC 不同），但它应该是注入安全的。例如：

```
DECLARE @command nvarchar(4000), @name varchar(50)

SELECT @command = 'SELECT * FROM [CUSTOMER] WHERE [Name] = @Name',
       @name = 'Fred'

EXEC sp_ExecuteSql @command, N'@Name varchar(50)', @name 
```

上面显然没有必要使用动态SQL——这只是为了说明！这很有用的主要时间是当（在 SPROC 内）您有多个可选的搜索条件或灵活的`ORDER BY`子句时。

在非 TSQL 客户端中，您可以对命令的参数执行相同的操作。

另请注意，`sp_ExecuteSql`它还利用了过程缓存，因此比 raw 更有效`EXEC (@command)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T10:38:59.013

这取决于您的查询的动态程度。

如果您的意思是存储动态值，那么只要您按照 Frederik 的建议使用参数，这不是问题。

如果您的意思是根据动态标准构建查询，那么您可能会遇到麻烦:-)

例如，假设您有一个字段字符串字典作为键更新，新值作为项目更新。然后，您可以使用字典动态构建更新查询。现在，如果黑客设法更改您的一个字段名称，他可能会设法插入自定义查询，从而破解您的系统。

为避免这种情况，您可以对字段名称进行一些巧妙的验证。也许对照表格列检查它们。但更安全的选择是使用更新所有值的固定查询，并为所有未更改的列赋予其原始值。这样，您可以使用参数作为值，这是安全的，并且可以安全地防止字段名称中的 sql 注入。

[在这里查看有关此主题的有趣讨论](https://stackoverflow.com/questions/306668/are-parameters-really-enough-to-prevent-sql-injections)。

# asp.net - 使用 SSRS 的用户定义报告

> ID：491133
> 
> 赞同：4
> 
> 时间：2009-01-29T10:24:44.377
> 
> 标签：asp.net, reporting-services, rdlc

我有一个 Web 应用程序，它通过 reportviewer 控件提供 SQL 报告服务报告。由于某些报告的复杂性，我使用附加到业务对象的 rdlc 报告。

现在我想扩展系统并允许某种形式的用户定义报告。理想情况下，我希望用户将他们的报告连接到我用来创建 rdlc 报告的相同业务对象。

1.  是否有允许用户创建/编辑自己的 rdlc 文件的控件？
2.  rdl 文件可以附加到业务对象吗？
3.  编写我自己的控件以编辑 rdlc 文件的任何提示/提示？（我认为这是很多工作，只有在没有合适的答案 1 或 2 时才会尝试）。

我所有的开发都是在 VS 2005 中使用 SQL 2005 完成的，但如果 2008 年的新功能有助于解决方案，我可以升级。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-31T18:44:23.337

这不是一个很好的答案，但在我的公司，我已经建立了我们自己的报表生成器。

我们有大约 30 份报告服务报告，我们的用户可以通过 Web 或桌面应用程序访问这些报告。我们想要做的是让我们的用户能够获取这些报告中的任何给定部分并创建自己的部分。

如果有我们为他们构建的报告，但他们不想看到图表，他们可以创建没有它的相同报告。如果他们想将 4 个不同报告中的部分组合成一份摘要报告，他们可以将这些部分拖到我们的自定义构建器上并保存。

我必须放在一起的报表生成器会下拉他们选择的所有不同的子报表，并通过 XML 读取将它们添加到我创建的报表生成器模板 XML 文件中。然后，我必须汇总所有参数，以免多次要求它们（如果您不希望它们汇总，参数名称在所有报告中必须是唯一的）。这个新的报告 XML 被部署到服务器上，用户可以随时访问它们。

我还让他们能够通过在空白画布上的任何位置拖动文本框、图像、全局变量（运行日期、创建时间、运行人、页码等）来创建自己的封面、页眉和页脚。然后，我将他们在此画布上使用并调整大小的所有项目转换为另一个报告 XML 文件，并将其部署为他们可以添加到自定义报告中的子报告。

是的，这需要做很多工作，但我们的用户喜欢它。我们现在正在允许他们创建具有特殊分组的报告，以便可以在不同级别运行报告。

所以这是可能的，但没有简单的答案。=) 我很乐意向任何提出建议的人提供建议，但直接复制代码违反了我的合同，但除此之外我会尽我所能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T10:55:51.663

我认为 SQL Reporting Services 不适合这种自定义。您可以隐藏和显示控件和子报表，但不存在交互式分组等内容。

您可能会研究第三方报告框架，例如[Telerik 的](http://www.telerik.com/products/reporting.aspx?gclid=CJeImeLOs5gCFQ4i3godox8dVA).

# .net - 您如何更改每个 HTTP 请求的 NHibernate 的连接字符串？

> ID：491139
> 
> 赞同：9
> 
> 时间：2009-01-29T10:28:09.177
> 
> 标签：.net, nhibernate

真的如上。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-29T16:41:19.860

可以`ISessionFactory.OpenSession()`提供一个`IDbConnection`.

另一种选择是实现一个将根据某些条件`IConnectionProvider`创建适当的实例（必须是全局的，因此使这个解决方案不是很干净）。`IDbConnection`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-01-12T21:46:55.077

请注意，在提供`IDbConnection`to时`OpenSession()`，您将无法使用二级缓存。

见[https://forum.hibernate.org/viewtopic.php?f=25&t=959178](https://forum.hibernate.org/viewtopic.php?f=25&t=959178)

> ...“这不是错误。如果您正在管理自己的连接，NHibernate 会禁用二级缓存以确保会话安全。”...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T13:04:27.333

好吧，这可能很棘手，但我认为不应该这样做，但这是一个想法：

```
var cfg = new Configuration(); // Get a new NHibernate Configuration
cfg.SetProperty("connection.connection_string", yourConnectionString); // Alter the property
cfg.Configure(); // Configure with this configuration
var sf = cfg.BuildSessionFactory(); // Get a new ISessionFactory 
```

我不知道这是否是最好的方法，但可能会奏效。您也可以拥有 2 个配置 xml 文件并执行以下操作：

```
var cfg = new Configuration("hibernate1.cfg.xml"); // OR
var cfg = new Configuration("hibernate2.cfg.xml"); 
```

回应评论，您可以初始化多个会话工厂并准备好使用，但这并不完全是“更改连接字符串”。然后选择你需要的那个。代价高昂的部分是创建 Configuration 对象并调用 Configure()。

还有 NHibernate Burrow 库，它同时管理多个会话并根据实体选择正确的会话。

```
var session = new BurrowFramework().GetSession(); // default session
var session = new BurrowFramework().GetSession(typeof(Entity)); // session that manages Entity class 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T16:37:06.700

SessionFactory 是设置你的连接、方言等的东西，所以如果你想改变你的连接字符串，你需要重新配置。但是，是的，你的评论是对的。设置会话工厂是最昂贵的操作之一，因此您只想在需要时执行此操作，而不再执行此操作。

[nHibernate Burrow](http://nhcontrib.wiki.sourceforge.net/BurrowIntroduction)中有一些非常棒的对话概念。如果你看看他们是如何管理会话的，你可能会发现一些创造性的想法来管理跨多个数据库的多个会话。

我有一个与@Marc 原则相同的建议：您可以很好地将动态连接封装在提供程序中。查看[有关动态连接提供程序的 nhibernate.info wiki](http://nhibernate.info/doc/howto/various/dynamically-change-user-info-in-connection-string)。您可以轻松地构建一个提供程序，您可以在其中传递您需要的信息，以便建立一个指向您想要的数据库的会话。

我在 100 多个数据库之上使用 nHibernate 2.0（所有数据库都具有相同的架构，但数据在物理上是分开的），所以它绝对可以用一点 TLC 来完成；-)

# c# - 静态变量应该用枚举代替吗？

> ID：491147
> 
> 赞同：13
> 
> 时间：2009-01-29T10:32:34.330
> 
> 标签：c#, enums, static-members

所以我正在查看一些签入的代码，我很困惑：

```
// Amount of days before cancellation can't be done
enum Cancellation { Limit = 2 }; 
```

问检查它的人，他认为使用枚举而不是静态变量要好得多，比这更好：

```
private static int CANCELLATION_LIMIT = 2; 
```

于是我们开始争论。我的论点是他使用枚举作为存储值的一种方式（如果有两个枚举符号具有相同的值，它将中断）。他认为在一个类中有静态变量是一种反模式。

我的问题是应该使用什么最佳实践？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-29T10:39:19.637

返回“它在逻辑上是一组值”吗？“枚举是合适的”：“静态常量很好”

*（我是逻辑一致的忠实粉丝）*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-29T10:39:32.757

枚举类型。

也就是说，如果你有一个方法，你必须将某个“状态”传递给一个方法，那么你只能传递“有效”参数。例如：

```
enum OrderState 
{
  pending = 1,
  shipped = 2
}

public IList<Order> GetOrdersInState( OrderState )
{
} 
```

这是一个很好的例子——恕我直言——使用枚举。当 OrderState 是您为其创建 2 个 const int 的 int 时，您没有任何限制并且能够传递无效值。编译器不会抱怨。

但是，在您提出的情况下，我认为使用枚举不是一个有效的解决方案。这是对 int 的误用，应该使用 const int。

枚举很好，但它们应该用在必须使用的地方。它们不是每种情况下的首选工具。在这种情况下，拥有 const 或 static var 不是反模式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T10:40:19.777

不，如何在枚举中定义静态字符串变量或十进制值？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T10:42:11.037

我不认为这`CANELLATION_LIMIT`听起来像一个枚举，它通常是一组选择。

对于不同的东西，如果它是一个`const`，那么也许......但目前它是一个可变字段？

请注意，枚举仅限于基于整数的类型，因此不能用于`float`,`string`等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T10:45:23.073

对于旨在唯一的不可变值，枚举是要走的路。要问的问题很简单：对象是否应该存储值本身，甚至是静态的？在许多情况下，例如在描述错误或操作时，答案是否定的。请记住，*enum*是作为*#define*的替代品而诞生的：它将典型值与标识符相关联并提供了一种类型，它实际上并没有说“在此处存储此常量”。

我认为您实际上并不想存储任何东西，而是提供这样的典型值。*静态 const*成员仅在您打算这样使用它们时才有用，例如，如果您需要通过引用方法来传递它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T10:38:48.577

如果您有一组直接连接的值，我认为您应该使用枚举。

类似于：枚举状态 { Open = 1, Closed =2, Waiting=3 };

对于其他一切，我会说静态变量是要走的路。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T10:39:14.113

我不知道在类中有静态变量是一种反模式（？）。例如，.Net 框架中的 Color 类有很多静态公共变量，例如 Color.Red。所以，从这个角度来说，我同意你的看法。

但是，可能会有妥协：使用 private const CANCELLATION_LIMIT = 2; 你们俩都应该高兴。对他来说，类 (?) 将没有全局变量，因为 const 将被编译器替换，并且您将获得具有明确名称的单点更改。

# fuzzy-search - 最佳模糊匹配算法？

> ID：491148
> 
> 赞同：32
> 
> 时间：2009-01-29T10:33:22.580
> 
> 标签：fuzzy-search

在更短的时间内处理超过 100000 条记录的最佳模糊匹配算法（模糊逻辑、N-Gram、Levenstein、Soundex ......）是什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-29T11:34:16.093

[*我建议您阅读 Navarro 在题为Approximate string matching*](https://en.wikipedia.org/wiki/Approximate_string_matching#References)的 Wikipedia 文章的参考部分中提到的文章 。根据实际研究做出决定总是比随机陌生人的建议更好。特别是如果已知记录集的性能对您很重要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T12:30:22.533

这在很大程度上取决于您的数据。某些记录可以比其他记录更好地匹配。例如，邮政编码是一种已定义的格式，因此可以以不同的方式与普通字符串进行比较。人们可以根据姓名首字母和出生日期，或其他组合等进行匹配。

# javascript - 单击文本时在中继器中选择/取消选择复选框

> ID：491149
> 
> 赞同：0
> 
> 时间：2009-01-29T10:33:24.890
> 
> 标签：javascript, jquery, asp.net, repeater

假设我们有一个简单的 asp.net 中继器，我们连续有一个复选框、一个标签（记录的数据库 ID）并且不可见（用于回发）和一个文本（在 tabelcell 中）

现在我想让它像在 Windows 中一样，如果你点击文本，复选框应该被选中或取消选中。

有人为此提供链接或解决方案，也许已经使用 jQuery？

编辑：正如我所说，它是一个 asp.repeater。并且表格用于布局，因此使用 checkbox.text 属性是不可设计的（例如换行）复选框和文本的 id 在转发器的呈现时动态添加/更改。因此标签解决方案也不起作用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T11:29:43.920

假设你不需要 jQuery 和 table-construct

```
<asp:Repeater runat="server">
    <ItemTemplate>
        <asp:CheckBox runat="server" Text="your text" />
    </ItemTemplate>
</asp:Repeater> 
```

这基本上呈现了 Ricardo Vega 提供的解决方案，无论您在复选框的属性文本中得到什么都是可点击的，并且选中/取消选中复选框......因此您应该使用 <%# Eval("...") %> 您可以皮肤（通过 css）标签的边距

**编辑：**

再想一想，还有一个解决办法：

```
<asp:Repeater runat="server">
    <HeaderTemplate>
        <table>
    </HeaderTemplate>
    <ItemTemplate>
        <tr>
            <td><asp:Checkbox runat="server" ID="checkbox" /></td>
            <td><asp:Label runat="server" AssociatedControlID="checkbox">Your text</asp:Label></td>
        </tr>
    </ItemTemplate>
    <FooterTemplate>
        </table>
    </FooterTemplate>
</asp:Repeater> 
```

注意：您也可以使用 asp:Label-Element 的 Text-attribute！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T10:54:26.330

也许我不完全理解，但你为什么不在标签标签中使用 html 属性“for”？

像：

```
<label for="field_id">Checkbox 1</label>
<input id="field_id" type="checkbox" /> 
```

如果单击标签，这将使复选框充当单击状态。所以你不必依赖 JS 来做到这一点。

编辑：如果你真的想为此使用 jQuery：

```
$('td').click(function(){
  $(':checkbox',this).attr('checked',!$(':checkbox',this).attr('checked'));
}); 
```

根据需要更改“td”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T11:40:00.263

如果您使用其中一种 jQuery 单击解决方案，请确保忽略复选框本身触发的单击事件。

```
$('td').click(function(e){
    if (!$(e.target).is(':checkbox')) { // toggle only on non-checkbox click
        var checked = $(':checkbox', this).attr('checked');
        $(':checkbox', this).attr('checked', !checked); // toggle
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T10:48:22.333

这样的事情怎么样？

```
$('.yourtableclass td').click( function( e ) {
    var cb = $(this).children('input[type=checkbox]').get(0);
    cb.checked = !cb.checked;
}); 
```

# php - PHP中的round显示科学记数法而不是完整数字

> ID：491154
> 
> 赞同：11
> 
> 时间：2009-01-29T10:38:15.113
> 
> 标签：php, floating-point, integer, rounding

我正在尝试对包含 1400000 的变量进行回显。所以写着：`echo round(1400000);` 这给出了 1,4E+6 而不是完整的数字。有人知道如何充分展示它吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-29T10:58:44.620

It seems that round was the problem. I changed it with `number_format()` and this does the job just fine. Thanks Aron and Paul for the answers.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-29T10:52:41.747

与您的问题相关，我也在PHP 网站上看到了[此评论。](http://www.php.net/manual/en/language.types.float.php#83577)

> 对于某些“特殊”浮点数，PHP 从标准十进制表示法切换到指数表示法。您可以通过以下方式查看此类“特殊”值的部分列表：

```
for( $tmp = 0, $i = 0; $i < 100; $i++ ) 
{
    $tmp += 100000;
    echo round($tmp),"\n"; 
} 
```

> 因此，如果您添加两个浮点数，最终得到一个“特殊”值，例如 1.2E+6，然后将该值未经修改地放入更新查询中以将值存储在十进制列中，例如，您可能会得到一个失败的事务，因为数据库会将“1.2E+6”视为 varchar 数据，而不是十进制。同样，如果将值放入 xml，您可能会收到 XSD 验证错误。
> 
> 老实说：这是我在 20 多年的编码中看到的任何语言中最奇怪的事情之一，解决它是一个巨大的痛苦。

似乎还没有“真正的”修复，但从[Paul Dixon](https://stackoverflow.com/questions/491154/round-in-php-shows-power-in-stead-of-full-number/491174#491174)之前提到的错误报告中的评论来看，他的解决方案似乎有效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T10:44:26.960

可能与此[错误报告](http://bugs.php.net/bug.php?id=43053)有关，因此您可以尝试

```
printf("%d", $myvar); 
```

# java - 数行数、字数、字数、前十字数？

> ID：491177
> 
> 赞同：2
> 
> 时间：2009-01-29T10:45:55.083
> 
> 标签：java, count

嗨，我对 Stack Overflow 还是很陌生，所以我希望我做的正确，并且那里的人有我需要的答案。

我目前正在使用 Eclipse IDE 编写 Java 程序，我的问题是：

我需要一段代码来执行以下操作

它应该得到一个包含文本的 .TXT 文件，并从该 .TXT 文件中计算行数并打印，计算字数并打印，计算字符数并打印。最后列出最常用的 10 个单词并打印出来。

全部打印到系统 outprintln

我对 Java 很陌生，遇到了一些困难。

任何可以为我提供这些代码行或知道我在哪里可以找到它们的人？我想研究提供的代码，这就是我最好的学习方式=)

谢谢大家

没有找到编辑按钮对不起...

我将此添加到我的问题中：

呵呵，这是一项作业，但不是家庭作业，好吧，我明白了，我可以提供到目前为止所做的工作，我认为我已经很接近了，但这对我不起作用。有什么我错过的吗？

```
// Class    Tip

import java.io.*;
import java.util.*;

class Tip
{
    public static void main(String [] args) throws Exception
    {

        String root = System.getProperty("user.dir");   
        InputStream is = new FileInputStream( root + "\\tip.txt" );
        Scanner scan = new Scanner( is );

        String tempString = "";
        int lines = 0;
        int words = 0;
        Vector<Integer> wordLength = new Vector<Integer>();
        int avarageWordLength = 0;

        while(scan.hasNextLine() == true)
        {
                tempString = scan.nextLine();
                lines++;
        }

        is.close();

        is = new FileInputStream( root );
        scan = new Scanner( is );

        while(scan.hasNext() == true)
        {
                tempString = scan.next();
                wordLength.add(tempString.length());
                words++;
        }

        for(Integer i : wordLength)
        {
                avarageWordLength += i;
        }
        avarageWordLength /= wordLength.size();

        System.out.println("Lines : " + lines);
        System.out.println("Words : " + words);
        System.out.println("Words Avarage Length : " + avarageWordLength);

        is.close();     
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T10:52:28.707

这听起来有点像家庭作业，不能保证提供完整的答案，但我会给你一些关于在哪里查看 Java API 的提示：

FileReader 和 BufferedReader 用于获取数据。 Collections API 用于存储数据 自定义数据结构，用于存储单词列表和出现计数 Comparator 或 Comparable 用于对数据结构进行排序以获得前 10 个列表

一旦您开始工作并有一些功能并需要具体帮助，请回到这里提出具体问题，然后我们会尽力帮助您。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T10:55:43.863

[在Google](http://www.google.com.au/search?hl=en&q=java+count+words+example&meta=)中输入“java count words example”会得到一些建议。

这个[链接](http://www.java.happycodings.com/Beginners_Lab_Assignments/code7.html)看起来是一个不错的起点。

[此处](http://blog.taragana.com/index.php/archive/simplifying-java-how-to-count-the-number-of-words-in-a-string-using-java-one-liner/)的这个简单示例也可能会给您一些想法：

```
public class WordCount
{
  public static void main(String args[]) 
  {
    System.out.println(java.util.regex.Pattern.compile("[\\w]+").split(args[0].trim()).length);
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T11:56:47.093

这是一个解决方案：

```
public static void main(String[] args) {
    int nRows = 0;
    int nChars = 0;
    int nWords = 0;

    final HashMap<String, Integer> map = new HashMap<String, Integer>();

    try {
        BufferedReader input = new BufferedReader(new FileReader("c:\\test.txt"));
        try {
            String line = null;
            Pattern p = Pattern.compile("[^\\w]+");
            while ((line = input.readLine()) != null) {
                nChars += line.length();
                nRows++;
                String[] words = p.split(line);
                nWords += words.length;
                for (String w : words) {
                    String word = w.toLowerCase();
                    Integer n = map.get(word);
                    if (null == n)
                        map.put(word, 1);
                    else
                        map.put(word, n.intValue() + 1);
                }
            }
            TreeMap<String, Integer> treeMap = new TreeMap<String, Integer>(new Comparator<String>() {
                @Override
                public int compare(String o1, String o2) {
                    if (map.get(o1) > map.get(o2))
                        return -1;
                    else if (map.get(o1) < map.get(o2))
                        return 1;
                    else
                        return o1.compareTo(o2);

                }
            });
            treeMap.putAll(map);

            System.out.println("N.º Rows: " + nRows);
            System.out.println("N.º Words: " + nWords);
            System.out.println("N.º Chars: " + nChars);
            System.out.println();
            System.out.println("Top 10 Words:");    
            for (int i = 0; i < 10; i++) {
                Entry<String, Integer> e = treeMap.pollFirstEntry();
                System.out.println("Word: " + e.getKey() + "  Count: " + e.getValue());
            }

        } finally {
            input.close();
        }
    } catch (IOException ex) {
        ex.printStackTrace();
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T10:54:31.027

不是一个完整的答案，但我建议查看 Sun 的 Java IO 教程。它处理文件的读取和写入。特别是[有关扫描仪和格式化程序的教程](http://java.sun.com/docs/books/tutorial/essential/io/scanfor.html)

这是网站上的教程摘要

> I/O 编程通常涉及与人类喜欢使用的格式整齐的数据进行转换。为了帮助您完成这些琐事，Java 平台提供了两个 API。扫描仪 API 将输入分解为与数据位相关联的单个令牌。格式化 API 将数据组装成格式良好、人类可读的形式。

所以对我来说，它看起来正是你要问的 API

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T14:24:44.113

您可能会从使用[Apache Commons Utils](http://commons.apache.org/lang/api-2.4/org/apache/commons/lang/WordUtils.html)中获得一些优势，它有一个名为 WordUtil 的方便实用程序，它可以用句子和单词做一些简单的事情。

# c# - 我是 Windows Forms\WPF 开发人员。我应该阅读 Petzold 的 Programming Windows（C 语言之一）一书吗？

> ID：491178
> 
> 赞同：0
> 
> 时间：2009-01-29T10:45:58.517
> 
> 标签：c#, winforms, winapi

我是一名使用 Windows 窗体或 WPF 的 C# 开发人员。有时我必须处理我不喜欢的非托管代码。我认为我不喜欢这个的主要原因是无知。我不知道底层的 Win API。

我认为我不是唯一对非托管 Windows 代码有负面情绪的人。

问题：Windows Forms\WPF 开发人员是否应该开始挖掘 WinAPI 以成为更好的开发人员？

很抱歉不是很清楚..

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T10:50:48.507

不。

WPF 是对当前 Win32 api 的（几乎）重写。它不像 WPF 是基于 Win32 构建的。

学习 Win32 的人是 windows 编程的新手——需要学习 windows 应用程序的基本结构：winmain、messageloop、windows 类等。现在有了 WPF，您将很好地掌握 WPF 中的类似概念（并且还专注于了解 XAML）。

win32 会有很多概念上相似的主题，但你可以留在 WPF 中。为 wpf 学习 win32 不会有任何收获。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T10:56:14.517

我会插话说我同意上面的两个帖子。使用谷歌 - Petzold 对你的要求来说太过分了。

如果您想扩展知识并扩展知识（所有学习都是好的学习），这将很有用，但不适用于您提到的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T10:50:26.667

我认为查看 WinAPI 可能会对 WPF 产生反作用，因为它有大量重写的堆栈。如果您将 WPF 与 Silverlight 并行查看，则更是如此。

**有时**它可能对 winform 有点用处——但我多年来一直在编写 winform，并且只有一两次需要较低级别的细节。每次我这样做时，“google”都做得很好；或者最近，stackoverflow ;-p

如果您直接编写原始窗口，那么也许。但这对于 C# 来说是不寻常的。

# asp.net - FxCop 抑制

> ID：491182
> 
> 赞同：4
> 
> 时间：2009-01-29T10:47:40.087
> 
> 标签：asp.net, fxcop, suppression, generated-code

我在 Asp.Net 页面上有一个控件，该页面上有一个名为“PaReq”的控件，它违反了规则：

> CA1704：标识符应正确拼写

在我不确定如何抑制此错误之前，我使用了抑制，因为它是在生成的文件中定义的。

我可以在自定义字典中执行此操作，但这意味着所有开发人员都需要保持同步该字典的副本，如果可能的话，我宁愿避免这样做。此外，术语“PaReq”仅在该项目中使用。

我将如何以及在哪里应用抑制？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T10:50:56.993

我为每个项目保留一个自定义词典，其中包含该项目的特定单词。该字典文件位于我的 SourceControl 存储库中，因此其他开发人员也可以使用它（并添加新单词）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T10:56:07.763

AFAIK 您可以在装配级别添加抑制，尽管我没有在愤怒中使用它！如果你这样做，你最终会得到一些假阴性。（即压制所有违反此规则的事件）。

[SuppressMessage("Microsoft.Design", "CA1704",Scope="Assembly")]

我认为源代码管理中的自定义字典是最好的选择，或者您可以将 FxCop 项目保留在源代码管理中。

# agile - 可以在 Scrum 站立会议上带备忘吗？

> ID：491183
> 
> 赞同：1
> 
> 时间：2009-01-29T10:47:55.673
> 
> 标签：agile, scrum

很多时候，我会完成大量的日常任务，即不专门处理任何一个组件。因此，我发现在第二天的站立会议上很难记住这些单独的任务。前几天的任务可以带一些提醒点的小便签吗？例如，便签的内容可能是：

```
Yesterday:
----------------
- Implemented component X
- Refactored Y class
- Updated Bamboo build settings
- Submit test request to 3rd party harness
- Read up on X API

Today:
----------
- Write tests for component B
- Implement component B
- Document install instructions
- Code review meeting

Obstacles:
----------------
- Sys admin still haven't opened external port 
```

您对此有何看法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-29T10:49:44.513

Scrum 的一个关键点是它不是一成不变的——你应该让它适应你组织中最有效的方法。但是，每日站立会议的目的是*简短*的，因此如果您携带笔记，则应将其用作参考，而不是会议议程。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-29T10:58:32.483

是的，简短的笔记很好。长篇大论可能会破坏与同事的关系。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T12:18:36.193

以您感觉舒适的方式实施 Scrum。站立会议应该很短，但是谁说他们不能花你需要的时间呢？

如果你使用某种 Scrum 工具，你不必做笔记，一切都写在工具里——障碍、任务状态、评论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T10:53:50.917

我不知道它是否“正式”可以，但我一直这样做。如果你和我一样，因为你现在专注于新事物而忘记了你做的最后一件事，那就把事情写下来。最好是带着一份简短的清单出现在 SCRUM 上，然后出现并说：“现在……我在做什么？”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T12:24:35.180

我认为笔记没问题，但是您谈论的主题可能与您的 sprint 中的用户故事无关。如果您继续专注于这一点而不是您已执行的其他任务，您将保持 Scrum 会议简短且相关。

如果任务相关，请说出他们参与的故事，以便为同事提供背景信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T12:36:58.277

我看不出有什么理由不能在日常会议上带一些笔记。

在我们的团队中，我们稍微延长了每日 Scrum。它由以下部分组成：

1.  正常的每日 Scrum（昨天，今天，障碍）。这不应超过 5-10 分钟。
2.  我们更新了 sprint backlog。时间不应超过 5 分钟。这确保了整个团队都知道 sprint backlog 的当前状态。
3.  如果需要，我们会讨论任何重要的话题（涉及整个团队）
4.  如果需要，我们会安排团队成员之间的会议（或在每日 Scrum 之后直接召开会议）。

由于我们进行每日 Scrum/每日会议的方式，每个人都带一些简短的笔记是很正常的，例如关于他们需要与他人讨论的主题。

毕竟（正如其他人已经提到的），您应该以适合您和您的团队的方式实施 SCRUM。当然，如果您发现一些问题（例如在回顾过程中），您应该始终乐于改进/更改您的流程。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-23T10:21:10.623

**为什么他们不会呢？**

只有规则是：

*   回答三个问题
    *   你昨天做了什么
    *   你今天打算做什么
    *   是什么阻碍了你
*   你和团队说话（不是任何一个人）
*   你保持简短
*   没有故事
*   没有问题解决
*   当你有令牌时说话
*   知道将令牌发送给下一个（不是已经说过的人）
*   如果有人长篇大论或试图解决问题，其他人可能会在站立后召开焦点会议
*   故事卡墙应该是可见的
*   房间里的一个人在呼叫阻拦者时更新阻拦板

笔记很好，投影仪、激光笔和带螺旋桨的无檐小便帽也很好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T05:14:32.663

基本问题的答案是肯定的。如果对您有帮助，将笔记带到站立会议上是完全合适的。

但是，您的示例指出了站立会议中的一个常见陷阱……提供对团队可能不重要的活动的详细信息。你读了一些东西，你参加了一个会议。这些是我有时称之为“证明你的 8 小时合理性”的例子。

关键是 - 分享你做了什么以及你将做什么，无需详细说明。如果有人对某件事有疑问，他们可以在会议之外询问细节。

# wpf - 在 WPF 中，如何在耗时的过程完成之前和之后显示控件的更改状态？

> ID：491192
> 
> 赞同：1
> 
> 时间：2009-01-29T10:50:37.897
> 
> 标签：wpf

下面的 LoadIt() 方法需要 5-10 秒才能完成。我希望消息区域在 LoadIt() 启动之前显示“正在加载...”，并在完成后显示“重新加载”。

我怎样才能做到这一点？

以下代码不起作用。在一切完成之前，它似乎不会更新标签，此时它只是再次显示“重新加载”。

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    lblMessage.Text = "Loading...";
    LoadIt();
    lblMessage.Text = "Reloaded";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T10:58:53.310

你可以将 LoadIt 移到一个单独的线程，或者你可以模拟 WinForms Application.DoEvents 但这很 hack ( [http://shevaspace.spaces.live.com/blog/cns!FD9A0F1F8DD06954!526.entry](http://shevaspace.spaces.live.com/blog/cns!FD9A0F1F8DD06954!526.entry) )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T11:17:14.507

您可以使用 Dispatcher 对象在后台线程中启动任务：

```
public delegate void LoadItDelegate();

this.Dispatcher.BeginInvoke(
    System.Windows.Threading.DispatcherPriority.Background,
    new LoadItDelegate(LoadIt)); 
```

确保它在后台，因为 UI 线程具有更高的优先级，因此 UI 得到更新.. 并将您的“我完成消息”移动到您的 LoadIt 方法的末尾:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T11:22:15.337

这里讨论的解决方案不止一种：

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/6fce9b7b-4a13-4c8d-8c3e-562667851baa/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/6fce9b7b-4a13-4c8d-8c3e-562667851baa/)

# c# - 如果将数据模板添加到控件的资源中，使用什么键

> ID：491195
> 
> 赞同：-1
> 
> 时间：2009-01-29T10:52:09.970
> 
> 标签：c#, .net, wpf, datatemplate

我有一个在 XAML 文件中定义的数据模板。XAML 的根**不是**资源字典，而是数据模板本身。现在我想将此数据模板添加到控件的资源中。不幸的是，我不知道使用什么键。

```
myControl.Resources.Add(???, dataTemplate); 
```

虽然我使用数据模板 DataType 属性（即我想要模板的类型），但 WPF 资源查找引擎不使用我的数据模板。

任何人？谢谢！

**编辑：** 我知道使用样式，目标的类型可以解决问题，但是使用数据模板，这似乎有所不同......

**编辑：**

答：好的，我做了一点调试。这是正确的代码

```
myControl.Resources.Add(new DataTemplateKey(typeof(...)), dataTemplate); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T11:21:12.640

Actually Moser is right,

DataTemplates work on data objects.. ControlTemplates are for well.. controls... If your DataTemplate is for, lets say Car objects, use Mosers example like so:

```
myControl.Resources.Add(typeof(Car), dataTemplate); 
```

Set your Car object on DataContext of the control that needs to use this DataTemplate, et voila :)

* * *

Or you could always make up your own key:

```
myControl.Resources.Add("MyAwesomeDataTemplate", dataTemplate); 
```

And then set the Template property like so:

```
Template="{StaticResource MyAwesomeDataTemplate}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T11:02:57.110

使用为其设计数据模板的类型作为键：myControl.Resources.Add(typeof(TheType), dataTemplate);

# delphi - 是否可以在 Virtual Treeview 中选择多个列？

> ID：491198
> 
> 赞同：6
> 
> 时间：2009-01-29T10:52:46.270
> 
> 标签：delphi, virtualtreeview

我需要添加功能来复制节点和列的矩形选择，但我找不到任何方法来实际选择虚拟树视图中的多个列（在 toFullRowSelect 旁边）。

我只是错过了什么吗？如果没有，是否有类似网格的多列选择支持的后代？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T14:30:01.403

所以经过一些测试后，我想出了以下内容，感谢 DiGi 的额外推动。DrawSelection 不适用于此解决方案，因此需要禁用它。由于我认为我不需要很快再这样做，所以我没有写后代。

将 toDisableDrawSelection、toExtendedFocus 和 toMultiSelect 设置为 True。

在合适的地方声明以下变量/属性：

```
StartSelectedColumn: integer;
FirstSelectedColumn: integer;
LastSelectedColumn: integer;
Selecting: boolean; 
```

更新以下事件：

OnKeyDown

```
if (not Selecting) and (Key = VK_SHIFT) then
begin
  StartSelectedColumn := vtMain.FocusedColumn;
  FirstSelectedColumn := StartSelectedColumn;
  LastSelectedColumn := StartSelectedColumn;
  Selecting := true;
end; 
```

OnKeyUp

```
if Key = VK_SHIFT then
  Selecting := false; 
```

焦点改变

```
if Selecting then
begin
  if column < StartSelectedColumn then
  begin
    FirstSelectedColumn := column;
    LastSelectedColumn := StartSelectedColumn;
  end
  else if column > StartSelectedColumn then
  begin
    FirstSelectedColumn := StartSelectedColumn;
    LastSelectedColumn := column
  end
  else
  begin
    FirstSelectedColumn := column;
    LastSelectedColumn := column;
  end;
end
else
begin
  StartSelectedColumn := column;
  FirstSelectedColumn := column;
  LastSelectedColumn := column;
end; 
```

OnBeforeCellPaint

```
if vtMain.Selected[node] and InRange(column, FirstSelectedColumn, LastSelectedColumn) then
begin
  if vtMain.Focused then
    TargetCanvas.Brush.Color := vtMain.Colors.FocusedSelectionColor
  else
    TargetCanvas.Brush.Color := vtMain.Colors.UnfocusedSelectionColor;
  TargetCanvas.Brush.Style := bsSolid;
  TargetCanvas.FillRect(CellRect);
end; 
```

OnPaintText

```
if vtMain.Selected[node] and InRange(column, FirstSelectedColumn, LastSelectedColumn) then
begin
  if vtMain.Focused then
    TargetCanvas.Font.Color := clHighlightText
  else
    TargetCanvas.Font.Color := vtMain.Font.Color;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T12:29:23.813

您可以尝试在 TreeOptions.MiscOptions 中*启用/添加**toGridExtensions*。它可以通过光标键在列中自由移动，但 VT 在离开时仍会取消选择列。但我确信可以通过自定义绘制并记住起始节点和列来“修复”它。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T11:17:35.207

另一个提示 - 看看**OnStateChange**事件，也许你可以使用

```
procedure TSomeForm.VTreeStateChange(Sender: TBaseVirtualTree; Enter,Leave: TVirtualTreeStates);
begin
  if tsDrawSelecting in Enter then
  begin
    // Save position
  end;
end; 
```

# c# - 为什么 Java、C# 和 C++ 没有范围？

> ID：491199
> 
> 赞同：12
> 
> 时间：2009-01-29T10:53:13.493
> 
> 标签：c#, java, c++, typing, spec#

[Ada](http://en.wikibooks.org/wiki/Ada_Programming/Types/range)、[Pascal](http://web.mit.edu/sunsoft_v5.1/www/pascal/lang_ref/ref_data.doc.html)和许多其他语言支持范围，这是一种对整数进行子类型化的方法。范围是一个有符号整数值，范围从一个值（第一个）到另一个值（最后一个）。在 OOP 中实现相同功能的类很容易，但我认为原生支持该功能可以让编译器进行额外的静态检查。

我知道不可能静态验证范围内定义的变量不会“溢出”运行时，即由于输入错误，但我认为可以做些什么。我考虑了[按合同设计的](http://en.wikipedia.org/wiki/Design_by_contract)方法 (Eiffel) 和 Spec# ( [C# Contracts](http://research.microsoft.com/en-us/projects/contracts/) )，它们提供了更通用的解决方案。

是否有一个更简单的解决方案，至少在 C++、C# 和 Java 的编译时检查静态越界赋值？某种[静态断言](http://en.wikipedia.org/wiki/C%2B%2B0x#Static_assertions)？

**编辑**：我知道“范围”可以用于不同的目的：

1.  迭代器
2.  枚举器
3.  整数子类型

我会关注后者，因为前者很容易映射到 C* 语言上。我考虑一组封闭的值，比如音乐音量，即从 1 到 100 的范围。我想增加或减少一个值。我想在静态溢出的情况下出现编译错误，例如：

```
volume=rangeInt(0,100);
volume=101;  // compile error!
volume=getIntFromInput(); // possible runtime exception 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T11:03:04.673

Java 从 1.4 版开始就有了 assert 关键字。如果您通过合同进行编程，您可以自由地使用它们来检查正确的分配。并且在设置之前应检查对象内应落在特定范围内的任何可变属性。您也可以抛出 IllegalArgumentException。

为什么没有范围类型？我的猜测是，最初的设计者没有在 C++ 中看到它，并且认为它不像他们试图正确处理的其他功能一样重要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T12:04:49.323

子范围类型在实践中实际上并不是很有用。我们不经常分配固定长度的数组，也没有理由分配固定大小的整数。通常在我们确实看到固定大小的数组时，它们充当枚举，我们对此有更好的（尽管“更重”）的解决方案。

子范围类型也使类型系统复杂化。在变量之间引入约束比引入固定常量更有用。

（必须提到整数在任何合理的语言中都应该是任意大小。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T16:05:47.730

当您可以简洁地在该范围内做某事时，范围是最有用的。这意味着关闭。至少对于 Java 和 C++，范围类型与迭代器相比会很烦人，因为您需要定义一个内部类来定义您将在该范围内执行的操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T11:22:12.623

Pascal（以及 Delphi）使用子范围类型，但仅限于序数类型（整数、字符甚至布尔值）。

它主要是一个带有额外类型检查的整数。您可以使用课程以其他语言伪造它。这提供了可以应用更复杂范围的优势。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T16:29:43.970

对于 C++，约束值变量的库目前正在实施中，并将在 boost 库中提出： http: [//student.agh.edu.pl/~kawulak/constrained_value/index.html](http://student.agh.edu.pl/~kawulak/constrained_value/index.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T16:18:39.373

C++ 允许您通过模板实现此类类型，我认为已经有一些库可以做到这一点。但是，我认为在大多数情况下，收益太小，不足以证明增加的复杂性和编译速度损失是合理的。

至于静态断言，它已经存在。Boost 有一个`BOOST_STATIC_ASSERT`, 在 Windows 上，我认为微软的 ATL 库定义了一个类似的库。

`boost::type_traits`和 boost::mpl 可能是你最好的朋友来实现这样的东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-30T21:26:57.083

自己滚动的灵活性比将它内置到语言中要好。例如，如果您想要饱和算术，而不是为超出范围的值抛出异常怎么办？IE

```
MyRange<0,100> volume = 99;
volume += 10; // results in volume==100 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-30T21:45:09.807

我想补充一下 Tom Hawtin 的回应（我同意），对于 C++，范围的存在并不意味着它们会被检查——如果你想与一般语言行为保持一致——例如，数组访问是无论如何也没有进行范围检查。对于 C# 和 Java，我相信这个决定是基于性能的——检查范围会带来负担并使编译器复杂化。

请注意，范围主要在调试阶段有用 - 生产代码中绝不应该发生范围违规（理论上）。因此，范围检查最好不在语言本身内部实现，而是在前置和后置条件中实现，在生成发布版本时可以（应该）将其剥离。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-26T21:00:49.050

这是一个老问题，但只是想更新它。Java 本身没有范围，但如果你真的想要这个功能，你可以使用**Commons Lang**，它有许多范围类，包括**[IntRange](http://commons.apache.org/lang/api-2.4/org/apache/commons/lang/math/IntRange.html)**：

```
IntRange ir = new IntRange(1, 10); 
```

奇怪的是，这在 Commons Math 中不存在。我部分同意接受的答案，但我不认为范围是无用的，尤其是在测试用例中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-29T11:26:50.883

在 C# 中，您可以这样做：

```
foreach(int i in System.Linq.Enumerable.Range(0, 10))
{
    // Do something
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-30T20:37:09.493

JSR-305 为范围提供了一些支持，但我不知道这是否会成为 Java 的一部分。

# string - Erlang 构建动态文件名

> ID：491206
> 
> 赞同：1
> 
> 时间：2009-01-29T10:54:56.487
> 
> 标签：string, erlang

我正在尝试创建一个名称基于函数的整数值的文件，显然下面不起作用，但给了你这个想法：

```
getValue() -> 1.

createFile() ->
    {ok, File} = file:open( getValue(), [write]),
    io:format(File,"Test~n"), 
    file:close(File). 
```

这应该很简单，即使 Erlangs 缺乏对字符串的支持，所以我一定只是遗漏了一些明显的东西（就像新事物的代价一样）：

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T11:02:25.627

如果您只想打开一个名称为“1”的文件，那么您可以使用它`integer_to_list/1`来执行此操作（因为字符串只是字符的 ASCII 值的整数列表）：

```
getValue() -> 1.

....
{ok, File} = file:open(integer_to_list(getValue()), [write]), 
```

如果您想根据 from 的值创建文件名`getValue/0`，则适用相同的原则，但您只需通过将多个列表粘合在一起来创建文件名。

# asp.net-mvc - asp.net mvc 博客引擎

> ID：491207
> 
> 赞同：34
> 
> 时间：2009-01-29T10:55:38.263
> 
> 标签：asp.net-mvc, frameworks, blogs

我正在寻找一些基于 ASP.NET MVC 的开源博客引擎。是否有可用的生产就绪项目？

*来自 svinto 的注释：我也想要这个，而是使用任何 DI/IoC 或 ORM 插入到任何 asp.net mvc 站点的东西。- 我没有创建一个新的类似问题，而是使用这个问题。*

这些是我发现的博客引擎及其依赖项、子依赖项等：

**[氧化物](http://www.codeplex.com/oxite)**

*   [LINQ 到 SQL](http://msdn.microsoft.com/en-us/library/bb425822.aspx)

**[原子站点](http://atomsite.net/)**

*   [NLog](http://www.nlog-project.org/)（日志框架）
*   [雅虎！UI 库：YUI Compressor for .net](http://yuicompressor.codeplex.com/)（缩小 js 和 css，[YUI Compressor](http://developer.yahoo.com/yui/compressor/)的 .net 端口）
    *   ecmascript.net 已修改
*   [Tidy.net](http://tidynet.sourceforge.net/)（[HTML TIDY](http://www.w3.org/People/Raggett/tidy/)的.net 端口）
*   [SGMLReader](http://developer.mindtouch.com/Community/SgmlReader)（将 SGML 转换为 XML）
*   [StructureMap](http://structuremap.sourceforge.net/Default.htm)（DI/IoC 框架）
*   [SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/Default.aspx)

这两个似乎是更独立的应用程序，而不是你与其他东西混合和匹配的东西。有谁知道：

*   有一个单独的组件（或一个用于控制器，一个用于模型）
*   使用存储库模式
*   允许使用任何 DI/IoC
*   允许使用任何 ORM
*   附带我可以更改的视图模板

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2011-01-19T14:58:03.293

[http://www.funnelweblog.com](http://www.funnelweblog.com) - ASP.NET MVC 3.0，Razor，已经被许多博主使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-04-19T12:38:58.933

我会推荐一个[NBlog](https://github.com/ChrisFulstow/NBlog)。真的很轻。最好集成到现有站点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-25T12:08:21.243

[http://orchardproject.net/](http://orchardproject.net/) 基于 ASP.NET MVC 2、Razor 等

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T11:00:52.510

不确定您确定生产准备好什么？

Oxite 处于测试阶段，但鉴于 MVC 尚未进入 RTM，我怀疑您会发现任何未确定为预发布的内容。

[http://www.visitmix.com/Lab/Oxite](http://www.visitmix.com/Lab/Oxite)

我希望这会有所帮助。

*编辑： http: [//www.codeplex.com/oxite](http://www.codeplex.com/oxite)*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-02T13:04:01.793

在这篇文章中值得一提的是 BlogEngine.Net，所以： http:
[//www.dotnetblogengine.net/](http://www.dotnetblogengine.net/)

及其功能列表：http:
[//www.dotnetblogengine.net/page/features.aspx](http://www.dotnetblogengine.net/page/features.aspx)

这里是文档：
[http ://blogengine.codeplex.com/documentation](http://blogengine.codeplex.com/documentation)

**它不是 MVC，但值得考虑。**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-28T22:00:17.967

这个看起来不错[http://thebeerhouse.codeplex.com/](http://thebeerhouse.codeplex.com/)

# .net - 转变？DTO 的域对象 - 无法创建接口的实例

> ID：491212
> 
> 赞同：0
> 
> 时间：2009-01-29T10:57:24.547
> 
> 标签：.net, apache-flex, flash, nhibernate, remoting

嗨，我需要在 .Net 和 Flex 表示层之间传递一些对象。

我需要传递并接收以下对象。

```
 public class Room: BasicRoom
{

    private int _seatingCap; 
    private RoomType _roomType;
    private IList<Equipment> _equipment;

public virtual RoomType roomType
    {
        get { return _roomType; }
        set { _roomType = value; }
    }
    public virtual IList<Equipment> equipment
    {
        get { return _equipment; }
        set { _equipment = value; }
    }
    public virtual int seatingCap
    {
        get { return _seatingCap; }
        set { _seatingCap = value; }
    } 
```

目前，我只是将上述（域对象）传递给表示层，这很好。但是，当我想将对象发送回 .Net 时，我遇到了问题。

因为，我使用 NHibernate 作为 orm 工具，它要求我在这种情况下使用 IList 的接口来映射集合。当我尝试将对象传递回 .Net 时出现问题 - 网关（flash remoting - fluorineFX）对输入为 IList 的设备犹豫不决并引发错误。“无法创建接口的实例”。

我显然需要将设备键入 List 而不是 IList。

有什么想法可以解决这个问题？转换成dto会更好吗？

有没有人有这方面的经验？

我对.Net 相当陌生，因此非常感谢任何帮助/指针。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T11:03:01.897

列表是否有任何理由需要设置器？通常，集合属性是只读的——您只需//`Add`它们...`Remove``Clear`

这`virtual`使得这更棘手 - 通常我会这样做：

```
public IList<Foo> Foos {get; private set;}
public Bar() { // ctor
    Foos = new List<Foo>();
} 
```

在这种情况下，也许（因为我们不想在 ctor 中调用虚方法）：

```
private IList<Foo> foos;
protected virtual IList<Foo> CreateFooList() {
    return new List<Foo>();
}
public IList<Foo> Foos {
    get {
        if(foos == null) foos = CreateFooList();
        return foos;
    }
} 
```

如果这仍然不起作用，请尝试具体的列表类型。

# c# - LINQ 如何定义与 ElementAtOrDefault 运算符一起使用的默认类型

> ID：491224
> 
> 赞同：9
> 
> 时间：2009-01-29T11:02:31.320
> 
> 标签：c#, linq, list

我非常喜欢这个 ElementAtOrDefaultOperator 用于通用列表的声音，但我不知道如何为我的对象列表定义默认类型。据我了解，如果我有如下对象列表，则默认值将为 null，但我想返回我自己的具有正确值的默认对象版本。这就是我的意思：

```
ClassA {

string fieldA;
string fieldB;
ClassB fieldC;

//constructor

}

List<ClassA> myObjects = new List<ClassA>();

myObjects.Add( //new object )
myObjects.Add( //new object ) 
```

所以我希望能够做到以下几点：

```
ClassA newObject = myObjects.ElementAtOrDefault(3); 
```

并让 newObject 成为我在某处定义的 ClassA 的默认类型。我认为可能有 SetDefaultElement 或其他方法，但我认为它不存在。

有什么想法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-29T11:08:18.143

只需编写自己的扩展方法：

```
static T ElementAtOrDefault<T>(this IList<T> list, int index, T @default)
{
    return index >= 0 && index < list.Count ? list[index] : @default;
} 
```

并致电：

```
var item = myObjects.ElementAtOrDefault(3, defaultItem); 
```

或者，如果您希望延迟评估默认值，请使用 a`Func<T>`作为默认值：

```
static T ElementAtOrDefault<T>(this IList<T> list, int index,
    Func<T> @default)
{
    return index >= 0 && index < list.Count ? list[index] : @default();
} 
```

例如，此表单将允许您使用预定义的项目（例如，第一个项目）：

```
var item = myObjects.ElementAtOrDefault(3, myObjects.First); 
```

或更灵活：

```
var item = myObjects.ElementAtOrDefault(3, () => myObjects[2]); 
```

或者

```
var item = myObjects.ElementAtOrDefault(3, () => new MyObject {...}); 
```

# asp.net - 以编程方式将 TextBox 控件插入 GridView.FooterRow

> ID：491229
> 
> 赞同：1
> 
> 时间：2009-01-29T11:03:15.423
> 
> 标签：asp.net, c#-3.0

您可以修改**GridView**的**HeaderRow**中的列和列的**ItemTemplate**。但是在**FooterRow**上是不可能的，因为它是只读的。

 ******有什么方法可以以编程方式将**TextBox控件添加到****GridView**控件中的 FooterRow 中？

注意：我不需要对我添加的控件进行数据绑定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T11:17:55.177

我可能遗漏了一些东西，但您不能像这样连接到 RowDataBound 事件并添加您的控件吗？

```
protected void GridView_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.Footer)
    {
        TextBox textBox = new TextBox();
        textBox.Text = "Hello";
        e.Row.Cells[0].Controls.Add(textBox);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T10:41:48.727

是的，我自己试过了，效果很好，这是完整的代码......

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<body>
    <form id="form1" runat="server">
    <div>
        <asp:GridView ID="GridView1" runat="server"    OnRowDataBound="GridView1_RowDataBound"
            ShowFooter="True">
        </asp:GridView>
    </div>
    </form>
</body>
</html>

using System;
using System.Collections.Generic;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {
        List<string> animals = new List<string>();
        animals.Add("Cat");
        animals.Add("Dog");
        animals.Add("Horse");

        GridView1.DataSource = animals;
        GridView1.DataBind();
    }

    protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType != DataControlRowType.Footer) return;
        TextBox textBox = new TextBox();
        e.Row.Cells[0].Controls.Add(textBox);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T02:55:09.627

尝试`gridview`在`gridview_RowCreated`事件中添加控件

```
protected void GridView1_RowCreated(object sender, GridViewRowEventArgs e)
    {`enter code here`
        if (e.Row.RowType == DataControlRowType.Footer)
        {
            TextBox txt = new TextBox();
            txt.ID = "txt_Name";
            e.Row.Cells[0].Controls.Add(txt);

        } 
```

# delphi - 如何检查链接到组件的属性是否“丢失”？

> ID：491246
> 
> 赞同：6
> 
> 时间：2009-01-29T11:17:10.840
> 
> 标签：delphi

我正在使用 Delphi 2007。有时链接到组件的属性会丢失。这通常是动作属性和查找数据集。我有几次进行了一些紧急错误修复，并因此向客户发送了一个版本，结果有点灾难性:-) 任何人都知道一种方法来验证应该设置的属性是否真的设置了，或者一种防止这种情况发生？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-29T11:37:42.170

显然，您可以在代码中分配这些值。

更重要的是，在提交源代码控制之前，您必须对每个文件进行比较。总是。

确保您的 dfm 文件是文本，而不是二进制文件。然后在签入/提交之前很容易看到不需要的更改。

对所有事物进行区分已经阻止了我很多潜在的错误。

自动构建和测试系统也会让您对交付的内容有信心。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T15:10:05.050

您已经收到了几个关于如何检测何时发生这种情况的好答案（投票赞成）。但是（有时）防止它发生的一种方法是确保您已将所有引用的单位添加到您的 DPR 中。例如，如果您打开一个表单，其中包含引用数据模块上其他组件的组件，并且该数据模块尚未添加到 DPR/项目，您几乎可以保证 IDE 删除这些引用，因为它删除它无法确定有效的引用。另一方面，如果数据模块在 DPR 中，那么 IDE 将能够找到它，并且不太可能首先删除引用

不幸的是，它仍然不时发生，因此您仍然需要采取其他答案中详述的预防措施。但这会让事情变得更好，如果你还没有这样做的话。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T13:50:23.590

创建 dunit 测试项目。发布前运行测试。测试失败时敲响所有警钟。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T11:44:00.957

您需要一种方法来验证这些值是否设置正确。好吧，您可以为此使用单元测试。只需启动一个表单，比较属性并完成。

当然，比较 dfm 也是一个好方法，但它没有考虑由于更改默认值或代码更改而导致的更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T04:34:42.617

当您将表单、数据模块或框架添加到项目时，IDE 会在 dpr 文件中的单元名称后插入一个小注释“tag”。根据我的经验，如果由于某种原因该标签不存在，IDE 更容易丢失跨模块组件引用。

如果您正在使用这样的东西，我完全支持在每次提交版本控制之前始终查看差异的想法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-30T09:24:47.260

我不想这么说，但源代码控制可以在这些情况下提供帮助。即使有紧急错误修复，您也应该将所有内容检入源代码存储库（[Perforce](http://www.perforce.com)是我个人的最爱）。在一个小修复中，您可以查看哪些文件已更改，是否有任何您不期望的更改。

# emacs - Emacs 区域突出显示

> ID：491257
> 
> 赞同：4
> 
> 时间：2009-01-29T11:21:18.413
> 
> 标签：emacs, elisp

有没有办法在字体锁定模式打开的缓冲区中突出显示文本中的字符串（但不是所有此类字符串）。

假设我有一个 SQL 模式的缓冲区，我想突出显示其中的一个字符串。以下代码不起作用

```
(set-text-properties 10 20 '(face hi-yellow)) 
```

当我打电话

```
(font-lock-mode -1) 
```

它有效，但所有 sql 突出显示都消失了。

必须有一个解决方案，因为可以选择一个区域并且它将突出显示，但我无法弄清楚如何以编程方式进行

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T12:39:58.443

看看[http://www.emacswiki.org/emacs/HighlightTemporarily](http://www.emacswiki.org/emacs/HighlightTemporarily)。

MarkerPens 和 Highlight 都提供了突出显示区域的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T12:46:31.143

也许这有帮助：

*   打开 ***scratch* 缓冲区并输入：

```
 (with-current-buffer "foo" (add-text-properties 1 10 '(comment t face highlight))) 
```

*   然后用 Cj 评估

字符 1-10 将在缓冲区“foo”中突出显示。

# .net - asp.net 菜单控件 - 格式化

> ID：491265
> 
> 赞同：1
> 
> 时间：2009-01-29T11:24:41.043
> 
> 标签：.net, asp.net, controls

我正在尝试使用 .sitemap 文件在我的站点中构建菜单；但是我的输出有很多问题。

首先，表格输出不太好——我下载了“CSSFriendly”DLL（[http://www.codeplex.com/cssfriendly](http://www.codeplex.com/cssfriendly)）..现在给出了 ul 和 li's 中的输出。

但我希望菜单没有javascript或css，一次弹出一个级别等。

我认为一开始使用 StaticDisplayLevels 就可以解决这个问题，但它似乎忽略了它并只输出第一级，然后我必须将鼠标悬停以获得更多菜单选项..

我想长和短是：人们是否应该远离菜单控件而自己编写标记？如果没有，这也不是一条可怕的路线——我怎样才能摆脱所有的格式和鼠标悬停在爵士乐上。我只想要一个水平显示的整个菜单（不过我可以用我的 CSS 来做到这一点）。

感谢您的帮助，如果这个问题似乎是乱码（令人沮丧），也很抱歉。皮特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T12:12:21.803

我的经验是 ASP.net 菜单可以被驯服，它并不像最初出现的那么糟糕。

（我试图为您的静态显示级别问题找到一些代码，但目前无法访问我的 SVN 存储库。但是我遇到了同样的问题，而且很容易解决。）

当然，MS 菜单永远不会像您自己用 HTML 编写的那样简洁，但是如果您不想花太长时间在上面并且想要使用所有 SiteMapProvider 的东西，那就太好了。

只是不要陷入“MS 提供的一切都是垃圾，我必须自己编写”的陷阱，因为它真的没那么糟糕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-01T19:42:48.773

皮特，

我挖出了一些使用asp.net 菜单控件的旧代码。那里的内容很少，将 StaticDisplayLevels 设置为 2 并将 Orientation 设置为“Horizo​​ntal”可以一切正常。大部分工作都在对其进行剥皮（如果某些 url 仅因查询字符串不同，则有一些技巧可以突出显示当前位置）。

但是，切换到使用 CSS 友好适配器，我遇到了与您描述的完全相同的问题（仅显示了根项目并且无法水平渲染）。

让我想知道 CSS 友好的菜单适配器是否坏了？有旧版本代码的工作示例[http://www.asp.net/CSSAdapters/Menu.aspx](http://www.asp.net/CSSAdapters/Menu.aspx)

克里斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T09:43:14.617

彼得斯基22，

我最近在**[jQuery Menu 和 ASP.Net Sitemap](https://stackoverflow.com/questions/103630/jquery-menu-and-asp-net-sitemap/647656#647656)**上回答了一个类似的问题。我在这里再次总结了一下：

基本上我将`<asp:Menu>`控件与**.sitemap**文件一起使用，添加了`CSSFriendly.DLL`和`CSSFriendlyAdapters.browser`文件（您已经完成了所有这些）以使菜单呈现为`<ul><li>`...

进而

[...使用 jQuery](http://users.tpg.com.au/j%5Fbirch/plugins/superfish/#download)（.js 和 .css 文件）下载/添加Superfish 并*搜索并替换*以`superfish.css`将“默认”Superfish 样式更改为 Menu 控件呈现的样式（例如`sf-menu`→ `AspNet-Menu`）。

jQuery 非常酷 - 并且[被 Microsoft '推荐'](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)。

[您可以在conceptdevelopment.net](http://conceptdevelopment.net)上“查看源代码”以查看它的工作原理……或下载包含您需要的所有文件**[的示例项目。](http://conceptdevelopment.net/Fun/Superfish)**

*（我仍在试图弄清楚如何更改菜单的默认类，而不是搜索和替换黑客）*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-19T18:06:05.120

我创建了一个简洁的小示例项目，您可以在[http://simplesitemenu.codeplex.com/使用](http://simplesitemenu.codeplex.com/)

It is a composite control which generates a nested UL/LI listing from your sitemap.

Enjoy!

# sql-server - Sequential Scheduling of Jobs

> ID：491266
> 
> 赞同：2
> 
> 时间：2009-01-29T11:25:28.653
> 
> 标签：sql-server

We have scheduled a number of jobs in SQL Server 2000\. We want these jobs to be executed in a sequential order i.e. the failure of one job should prevent the next job from running. Can someone help me on doing this or creating dependency between scheduled jobs.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T11:41:04.270

You could define your jobs as **steps of one single job**. So you'll can specify on every step if the next step should be executed in case of error.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T22:38:25.163

与其将作业合并到一个块中，不如将其分成几部分以简化错误检测并简化管理。它使您可以逐步控制您的过程。如果您的 SQL 作业可以通过批处理文件执行，则可以使用 windows 任务调度程序并定义依赖项。但如果主题是更复杂的 ETL 流程管理，最好在作业调度程序上管理此流程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T11:55:36.347

I've done this in a queue system to cache data where there were 4 or 5 steps involved and had to allow delays for replication between the steps.

It was rather time consuming to implement as there were parent tasks which spawned 1 to n child steps which sometimes needed to be executed in order, sometimes irrelevant.

If you go down this path, you then need to create a location for error messages and process logs.

I highly recommend if in any way it can be created as one job with multiple steps, you should use the existing jobs agent. Each individual step can be configured to exit on fail, continue on fail, email on fail, etc - It's rather flexible.

# c# - 如何在禁用按钮上显示工具提示？

> ID：491267
> 
> 赞同：38
> 
> 时间：2009-01-29T11:26:13.613
> 
> 标签：c#, .net, winforms

如果您在 Winform 上有一个禁用的按钮，如何在鼠标悬停时显示工具提示以告知用户为什么该按钮被禁用？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-19T22:25:59.547

将按钮（或适合此方案的任何控件）放置在容器（面板、tableLayoutPanel）中，并将工具提示与相应的底层面板单元格相关联。在多种情况下都可以很好地工作，灵活。提示：使单元格足够大以容纳 bttn，因此鼠标悬停响应（工具提示显示）不会出现在 bttn 边界之外“流血”。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-29T12:58:57.670

从那以后，我将 BobbyShaftoe 的答案改编得更笼统一些

笔记：

*   必须在父控件上设置 MouseMove 事件（在我的例子中是一个面板）

    ```
    private void TimeWorks_MouseMove(object sender, MouseEventArgs e)
    {
        var parent = sender as Control;
        if (parent==null)
        {
            return;
        }
        var ctrl = parent.GetChildAtPoint(e.Location);
        if (ctrl != null && !ctrl.Enabled)
        {
            if (ctrl.Visible && toolTip1.Tag==null)
            {
                var tipstring = toolTip1.GetToolTip(ctrl);
                toolTip1.Show(tipstring, ctrl, ctrl.Width / 2, ctrl.Height / 2);
                toolTip1.Tag = ctrl;
            }
        }
        else
        {
            ctrl = toolTip1.Tag as Control;
            if (ctrl != null)
            {
                toolTip1.Hide(ctrl);
                toolTip1.Tag = null;
            }
        }

    } 
    ```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-04-12T05:08:31.767

Sam Mackrill，感谢您的回答，使用标签来了解您要离开的控件是个好主意。但是，根据 BobbyShaftoe 的回答，您仍然需要 IsShown 标志。如果你把鼠标放在了错误的位置，如果工具提示出现在它下面，它会触发另一个 MouseMove 事件（即使你没有实际移动鼠标）。这可能会导致一些不需要的动画，因为工具提示会不断消失并重新出现。

这是我的代码：

```
 private bool toolTipShown = false;
    private void TimeWorks_MouseMove(object sender, MouseEventArgs e)
    {
        var parent = sender as Control;
        if (parent == null)
        {
            return;
        }
        var ctrl = parent.GetChildAtPoint(e.Location);
        if (ctrl != null)
        {
            if (ctrl.Visible && toolTip1.Tag == null)
            {
                if (!toolTipShown)
                {
                    var tipstring = toolTip1.GetToolTip(ctrl);
                    toolTip1.Show(tipstring.Trim(), ctrl, ctrl.Width / 2, ctrl.Height / 2);
                    toolTip1.Tag = ctrl;
                    toolTipShown = true;
                }
            }
        }
        else
        {
            ctrl = toolTip1.Tag as Control;
            if (ctrl != null)
            {
                toolTip1.Hide(ctrl);
                toolTip1.Tag = null;
                toolTipShown = false;
            }
        }
    } 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-29T11:33:30.387

所以假设你的控件被调用`button1`，你可以做这样的事情。
您必须通过处理`MouseMove`表单的事件来做到这一点，因为这些事件不会从您的控件中触发。

```
bool IsShown = false;      

void Form1_MouseMove(object sender, MouseEventArgs e)
{
   Control ctrl = this.GetChildAtPoint(e.Location);

   if (ctrl != null)
   {
       if (ctrl == this.button1 && !IsShown)
       {
           string tipstring = this.toolTip1.GetToolTip(this.button1);                 
           this.toolTip1.Show(tipstring, this.button1, this.button1.Width /2, 
                                                       this.button1.Height / 2);
           IsShown = true;
       }
   }
   else
   {
       this.toolTip1.Hide(this.button1);
       IsShown = false;
   } 
```

}

# asp.net - ASP.Net MVC 授权操作过滤器

> ID：491271
> 
> 赞同：10
> 
> 时间：2009-01-29T11:29:41.627
> 
> 标签：asp.net, asp.net-mvc

我试图了解在 MVC Preview 4 中使用 Authorize [Authorize] Action Filter 时错误处理的工作原理。

我有一个看起来像这样的动作：

```
[Authorize(Roles = "DOMAIN\\NOTAUTHORISED_ROLE" )]
[HandleError]
public ActionResult NeedAuthorisation()
{
    throw new NotImplementedException();
} 
```

当我访问 url:`http://localhost:2197/testAuthorisation/NeedAuthorisation`时，我的浏览器中出现了一个空白页面。在 Firebug 中，我可以看到发出了一个请求并`401 - Unauthorised`返回了一个响应状态。但我没有被重定向或返回 customError。使用我被授权的角色时，一切都按预期工作。

这是使用 Windows 身份验证。我正在编写一些代码来尝试表单身份验证，看看我是否遇到了同样的问题。我已经`<customerrors mode="On"/>`在 testAuthorisation 文件夹和 Shared 文件夹中设置并创建了错误页面。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-29T16:30:20.397

我最终发现[这个 MVC 教程](http://www.asp.net/learn/mvc/tutorial-18-vb.aspx)解决了我的问题：

> 当您尝试在没有正确权限的情况下调用控制器操作时发生的确切情况取决于启用的身份验证类型。默认情况下，使用 ASP.NET 开发服务器时，您只会得到一个空白页面。该页面以 401 Not Authorized HTTP 响应状态提供。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T12:10:50.140

如果您将 CustomErrors 设置为 Off 或 RemoteOnly，那么您将不会被重定向到 HandleError 指定的页面（默认为 Error.aspx）。将其设置为“开”，然后看看会发生什么。但是，您明确指定的任何自定义错误页面都将优先，因此您需要删除这些页面，并且只需：

`<customErrors mode="On" />`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T12:16:46.087

您需要相应视图文件夹中的错误视图，即您需要该文件`Views/TestAuthorization/Error.aspx`才能显示任何内容。

您还可以通过要使用的视图以及要触发它的异常来自[定义此行为。](https://stackoverflow.com/questions/183316/asp-net-mvc-handleerror/192371#192371)

```
[HandleError(ExceptionType = typeof(SqlException), View = "DatabaseError")]]
[HandleError(ExceptionType = typeof(NullReferenceException), View = "LameErrorHandling")]] 
```

# silverlight - 有人知道任何好的silverlight教程吗？

> ID：491280
> 
> 赞同：5
> 
> 时间：2009-01-29T11:33:55.143
> 
> 标签：silverlight

正如标题所说：）

我一直在等待 Wrox 发布“Professional silverlight 2.0”，但它已经推迟了将近一年，我想与 silverlight 一起玩。

忽略silverlight.net 网站，有谁知道任何专注于Visual Studio 编码而不是Blend 的优秀初学者教程？

乔恩

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T11:38:30.407

我目前正在浏览这[组教程](http://weblogs.asp.net/scottgu/pages/silverlight-2-end-to-end-tutorial-building-a-digg-search-client.aspx)。作为 Silverlight 世界的非常基本的入门读物，非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T19:51:34.997

我为 Wrox Press 写了一篇 57 页的文章，名为“从 ASP.NET 跳转到 Silverlight 2”。它专注于提升基础知识，不涉及 Blend。而且是七块钱。

[链接在这里](http://www.wrox.com/WileyCDA/WroxTitle/Jumping-from-ASP-NET-to-Silverlight-2.productCd-0470477164.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T18:50:40.500

[Jesse Liberty 的博客](http://jesseliberty.com/)有大量有用的学习材料，包括教程和视频——强烈推荐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T11:42:25.703

看看这个[MSDN Silverlight 页面。](http://code.msdn.microsoft.com/silverlightsdk/Release/ProjectReleases.aspx?ReleaseId=1821)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T12:10:20.873

虽然不是严格意义上的教程，但我的同事一直在阅读[C# 2008 中的 Pro Silverlight](http://www.apress.com/book/view/1590599497) ，据我所知，他对此非常满意。当然，它不是免费的，但也许它会在*Professional silverlight 2.0*发布之前让您坚持下去？:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T12:37:28.337

我一直在看 Silverlight 2 In Action 和 Silverlight 2 Unleashed 并且对两者都非常满意

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T19:56:41.307

虽然不完全是教程，但 MS 官方 Silverlight 网站上的视频包含各种主题的精彩视频。
从这里开始
 [http://silverlight.net/Learn/](http://silverlight.net/Learn/)
并在此处观看许多截屏视频
 [http://silverlight.net/Learn/videocat.aspx?cat=10](http://silverlight.net/Learn/videocat.aspx?cat=10)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-07-31T11:29:29.670

视频对我很有帮助：

[http://channel9.msdn.com/continuum/tutorials/](http://channel9.msdn.com/continuum/tutorials/) [http://www.microsoft.com/showcase/en/us/details/9b002e70-78c2-4741-9093-93e42228d8d1](http://www.microsoft.com/showcase/en/us/details/9b002e70-78c2-4741-9093-93e42228d8d1)

# msbuild - 如何使用 MSbuild 通过电子邮件发送多个地址

> ID：491281
> 
> 赞同：3
> 
> 时间：2009-01-29T11:33:55.347
> 
> 标签：msbuild, msbuildcommunitytasks

我的构建脚本中有一个目标，它将发送一封电子邮件，其中包含详细说明模块的 svn 更改的附件。

如果我对单个电子邮件地址进行硬编码，则此方法有效，但是我现在想向多个开发人员发送电子邮件并且脚本失败了。下面是代码

```
 <Target Name="MailInformationUpdate" DependsOnTargets="ZipArtifact" Condition="!Exists('BUILD_IS_PERSONAL')">

    <ReadLinesFromFile File="$(BuildDir)\$(recipientListFileName)">
      <Output PropertyName="Recipients"  TaskParameter="Lines"/>
    </ReadLinesFromFile>
    <Mail SmtpServer="$(smptServer)"
           To="@(Recipients)"
           From="$(senderEmail)"
           Body="Attached is a list of the changes made since the last release. "
       Subject="This module has been updated. You may wish to update." Attachments="$(BuildDir)\Builds\$(svnChangeFileName)"   
          />    
  </Target> 
```

如果我将 To 行更改为 $(Recipients) 列表中的第一个人将收到电子邮件，后续地址不会收到电子邮件。

然后，我将“收件人”行更改为您在@（收件人）下方看到的内容，因为我认为它可能会循环每个收件人。没有这样的运气！！！我收到错误消息

```
Emailing "{0}".
    <path> error : A recipient must be specified. 
```

我读入的文件只是格式为 (emailAddress1)、(emailAddress2) 等的文本文件

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T13:39:32.363

任务**ReadLinesFromFile**从文本文件中读取项目列表。但是文件的每一行必须有一个项目。

使用格式为 (emailAdress1),emailAddress2)... 的文本文件，您将只有一个包含*(emailAdress1),emailAddress2)...*的项目。您的 email.txt 应该是这样的：

```
emailAdress1
emailAdress2
... 
```

您从 ReadLinesFromFile 任务而不是属性中获取项目，因此请像这样修改您的任务：

```
<Target Name="MailInformationUpdate" DependsOnTargets="ZipArtifact" Condition="!Exists('BUILD_IS_PERSONAL')">

  <ReadLinesFromFile File="$(BuildDir)\$(recipientListFileName)">
    <Output ItemName="Recipients"  TaskParameter="Lines"/>
  </ReadLinesFromFile>
  <Mail SmtpServer="$(smptServer)"
       To="@(Recipients)"
       From="$(senderEmail)"
       Body="Attached is a list of the changes made since the last release. "
       Subject="This module has been updated. You may wish to update."
       Attachments="$(BuildDir)\Builds\$(svnChangeFileName)"   
      />    
</Target> 
```

（邮件目标的日志中有一个错误，即使有多个收件人，日志中也只会显示第一个。）

# jquery - JQuery Tablesorter issue

> ID：491286
> 
> 赞同：1
> 
> 时间：2009-01-29T11:35:58.993
> 
> 标签：jquery, tablesorter

I have this table where the is initially blank. Then when the document is ready I call a function that runs an AJAX query for the table content. The initial content is sorted awesomely! But when I call my function again with different parameters to get new content, things start to go wrong. The table fills with the new content just fine, but clicking on a header column to sort reverts the table content back to what it was when the page first loaded and the sorting also stops working.

This is the code snippet that I am using. will using $('.tablesorter').trigger("update") help? At what point should i make a call to this?

```
jQuery(".tablesorter > tbody").load(path, function(){
    jQuery(".tablesorter").tablesorter({
                    onRenderHeader: function (){
                    this.wrapInner("<span></span>");
                }
                , widthFixed: true
                , widgets: ['zebra','hovering','selected']
                , debug: true
              });
} 
```

Thanks, MM

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T15:23:56.957

我相信您需要使用 livequery 让 tablesorter 了解新的 ajax 内容。

这个花了我一段时间来解决这个问题，但基本上这应该可以工作，在你包含 livequery js 之后：

```
$("#table").livequery(function(){
  $(this).tablesorter({
    ...
  })
}); 
```

诺亚

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T12:24:55.563

如果您无法触发小部件，请调用此方法`$("Table").trigger("applyWidgets");`

这将确保所有小部件，如斑马效果、悬停等。将被启用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-19T12:27:05.913

只需使用

```
$(".tablesorter").livequery(function(){
    $(this).tablesorter({
    .
    .
    .
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-19T12:22:21.410

```
include  $("#table_name").tablesorter(); in ajax call. 
```

您需要通过 ajax 调用挂钩 tablesorter 功能。

如果您以这种方式挂钩，新表格内容也将具有排序功能。

# wpf - 为什么我不能在 WPF 中设置选定 ListBoxItem 的背景颜色？

> ID：491293
> 
> 赞同：5
> 
> 时间：2009-01-29T11:39:15.117
> 
> 标签：wpf, background, listboxitem

当用户单击 ListBoxItem 时，我希望它是粗体大字体红色背景黄色

除背景外，一切正常。所选项目似乎有标准（蓝色）背景。如何覆盖它并更改选定的背景黄色？

这是代码：

```
<Window x:Class="AlternateListBox2.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300"
    xmlns:local="clr-namespace:AlternateListBox2">
    <Window.Resources>
        <local:Countries x:Key="countries"/>
        <Style TargetType="{x:Type ListBoxItem}">
            <Setter Property="Content" Value="{Binding Path=Name}"/>
            <Setter Property="Margin" Value="2"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="FontWeight" Value="Bold"/>
                    <Setter Property="FontSize" Value="18"/>
                    <Setter Property="Background" Value="Yellow"/>
                    <Setter Property="Foreground" Value="Red"/>
                </Trigger>
            </Style.Triggers>

        </Style>
    </Window.Resources>
    <StackPanel>
        <ListBox
            ItemsSource="{Binding Source={StaticResource countries}}"
            Width="100"
            Margin="10"
            HorizontalAlignment="Left"
            />
    </StackPanel>
</Window> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-29T14:13:37.817

它可以做得更简单。所选 ListBox 项的背景颜色取自 SystemColors。因此，您需要做的是覆盖 ListBox 资源中的 SystemColors：

```
<ListBox.Resources>
    <!--Selected color when the ListBox is focused-->
    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Yellow" />
    <!--Selected color when the ListBox is not focused-->
    <SolidColorBrush x:Key="{x:Static SystemColors.ControlBrushKey}" Color="Yellow" />
</ListBox.Resources> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T13:53:30.633

此代码应适用于设置背景。问题是您需要创建一个 ControlTemplate 并将值“Yellow”分配给 ContentPresenter 的 Background 属性。

```
 <Style x:Key="ListBoxItemStyle1" TargetType="{x:Type ListBoxItem}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListBoxItem}">
                    <Border x:Name="Bd" SnapsToDevicePixels="true" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" x:Name="contentPresenter"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="true">
                            <Setter Property="OpacityMask" TargetName="contentPresenter" Value="{x:Null}"/>
                            <Setter Property="Background" TargetName="Bd" Value="Yellow"/>
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="FontSize" Value="18"/>
                            <Setter Property="Foreground" Value="Red"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsSelected" Value="true"/>
                                <Condition Property="Selector.IsSelectionActive" Value="false"/>
                            </MultiTrigger.Conditions>
                            <Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
                        </MultiTrigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-06T07:42:07.263

> “它可以做得更简单。所选 ListBox 项目的背景颜色取自 SystemColors。因此，您需要做的是覆盖 ListBox 资源中的 SystemColors”

ListBoxItem 模板将用于背景/前景的重写 SystemColors 的概念很糟糕，并且经常使 WPF 新手感到困惑。因此，我的建议是覆盖 ListBoxItem 模板并对其进行自定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-30T15:40:16.507

谢谢弗朗西丝！！这对我来说是这样，在某种程度上。这是我的代码，它允许模板对选定和未选定的列表项使用“StrColor”属性。

```
 <Style TargetType="ListBoxItem">
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <!--Nice Brush-->
        <Setter Property="Background">
            <Setter.Value>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <!-- This is a gradient from white to StrColor and back to white -->
                    <!--<GradientStop Color="White" Offset="0"/>
                    <GradientStop Color="{Binding Path=StrColor}" Offset="0.445"/>
                    <GradientStop Color="White" Offset="1"/>
                    <GradientStop Color="{Binding Path=StrColor}" Offset="0.53"/>-->
                    <!-- This is a gradient from StrColor to white -->
                    <GradientStop Color="{Binding Path=StrColor}" Offset="0"/>
                    <GradientStop Color="White" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <!--Standard Color-->
        <!--<Setter Property="Background" Value="{Binding Path=StrColor}"/>-->
        <Setter Property="Foreground" Value="{Binding Path=TextColor}"/>
        <Setter Property="Height" Value="{Binding Path=Height}"/>
        <Setter Property="Margin" Value="0"/>
        <Setter Property="Focusable" Value="False"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ListBoxItem}">
                    <Border x:Name="Bd" SnapsToDevicePixels="true" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}">
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" x:Name="contentPresenter"/>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsSelected" Value="true">
                            <Setter Property="OpacityMask" TargetName="contentPresenter" Value="{x:Null}"/>
                            <Setter Property="Background" TargetName="Bd">
                                <Setter.Value>
                                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                        <GradientStop Color="{Binding Path=StrColor}" Offset="0"/>
                                        <GradientStop Color="White" Offset="1"/>
                                    </LinearGradientBrush>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="Foreground" Value="{Binding Path=TextColor}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</UserControl.Resources> 
```

# svn - 从 Source Depot 迁移到 SVN

> ID：491295
> 
> 赞同：4
> 
> 时间：2009-01-29T11:40:25.753
> 
> 标签：svn, version-control, migration, source-depot

自从我在 Microsoft 工作以来，我就有一个用于版本控制的本地 Source Depot 存储库。最近，我一直想迁移到 SVN 并随身携带更改历史记录，但似乎没有脚本可以迁移到 SVN。

由于有很多微软人在这里闲逛，我想我会在这里尝试。我基本上是在寻找一个可以为我处理事情的简单迁移脚本。

除此之外，欢迎任何其他建议让我上路。仅供参考，Source Depot 基于 Perforce，我尝试过 perforce 迁移[工具](http://p42svn.tigris.org/)但没有任何成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-02T21:07:15.437

Source Depot 是否有类似于 Perforce 的命令行？

大约一年前，我使用 Python 脚本通过几个步骤将我的家庭 SCC 仓库从 Perforce 迁移到了 SVN。虽然我不再有剧本，但它很简单，一下午就写好了。

基本上，脚本从第一个 perforce 更改列表开始，并按顺序运行它们。它将同步到每个更改列表并将文件拆分为编辑/添加/分支列表。然后将这些文件复制到 SVN 路径并使用适当的命令进行更新/添加/分支。然后将使用原始更改列表中的注释提交它们。

这给了我一个完整的 Perforce 仓库的 SVN 镜像，其中保留了所有历史记录/评论和分支信息。我只有一个用户（我！），但支持多个用户并不难。

我什至玩弄了让脚本更改系统时钟以使历史日期正确的想法，但这似乎不值得。对我来说，历史和分支/标签信息是最重要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-02T20:46:03.513

不久前，我公司的一位承包商拜访了我们，参加了一次关于将所有源代码和版本历史从 MKS 迁移到 SVN 的信息会议。事实证明，实际上很难通过迁移过程保持版本历史完整，因为它们都有自己的存储历史的方法。我从那次访问中得到的是，有一些昂贵的第三方工具可以进行迁移，但它们很难找到，而且真的不是那么好。

我们最终决定，对于大多数项目，我们会咬紧牙关，只使用现有源创建新的源代码控制项目，丢失新软件的版本历史记录并将旧软件备份到磁盘上。

当然，我们的情况略有不同，因为我们的基本版本历史记录格式不同（我的是 MKS，你的是 SD）。但是，我不相信找到一个转换它的魔法脚本会很容易。我可能是错的，但无论如何，这就是我从那次会议中得到的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-02T20:39:46.707

也许我误解了您的问题，但是是什么阻止您从 Source Depot 全面检出代码，然后将其检入 Subversion？

除非您还打算导入已设置的任何用户/组控件，否则在这种情况下，签出/签入不会完全实现这一点。

# vb.net - 如何将文件复制到vista中路径长度超过260个字符的新位置？

> ID：491298
> 
> 赞同：3
> 
> 时间：2009-01-29T11:41:56.327
> 
> 标签：vb.net

在我之前的问题中如下：

“**如何创建长度超过 260 个字符的文件的副本**。”

我问了几乎相同的问题，我得到了一个解决方案来重命名目录名，然后复制到一个新位置。但是根据客户的要求，我们无论如何都不能重命名目录。

所以现在我的问题是，当我们尝试复制路径长度（包括文件名）超过**260 个字符**（比如 267 个字符）的文件时，它允许我们手动复制，但在 vista OS 中以编程方式抛出异常。

请让我知道是否有人有解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T12:08:23.280

附加**`\\?\`**到您的路径以启用最长 32767 个字符的路径长度。例如：

```
copy \\?\C:\big\dir\hierarchy\myfile.txt \\?\C:\tohere.txt 
```

[此页面](http://msdn.microsoft.com/en-us/library/aa365247.aspx)有更多详细信息。

我只`DIR`在 WinXP 中对此进行了测试，但这似乎可行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T12:07:26.010

如果问题只是文件的长度（而不是前面的路径），那么您可以使用文件的短名称版本（可能是 Outloo~1.xls ）。

但是，唯一真正可行的解决方案是使用网络重定向或 SUBST 命令来缩短路径。我可以想象你必须跟踪程序中的路径长度，并在超过长度时生成一个 SUBST 驱动器号......当不再需要驱动器号时删除它。丑陋的编程，但没有希望。

或者

我知道一些 unicode 版本的 windows api 函数（copyfileex..？ http: [//msdn.microsoft.com/en-us/library/aa363852](http://msdn.microsoft.com/en-us/library/aa363852(VS.85).aspx) (VS.85).aspx ）可以处理 32,767 个字符。

尝试使用 \\?\ 前缀命名它，例如 \\?\D:\。我不确定CLR是否使用这种命名风格，但你可以尝试一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T11:57:35.843

您可以检查[7zip 等压缩工具](http://dotnetperls.com/Content/7-%5Aip-Examples.aspx)是否受 Vista 中路径长度的限制。

如果不是，这意味着“按程序复制”将通过：

*   压缩要复制的目录/文件树
*   将 .zip/.rar 复制到目的地
*   解压缩

# c++ - 带有继承的 Pimpl 成语

> ID：491304
> 
> 赞同：19
> 
> 时间：2009-01-29T11:44:29.100
> 
> 标签：c++, inheritance, oop, pimpl-idiom

我想将 pimpl 成语与继承一起使用。

这是基础公共类及其实现类：

```
class A
{
    public:
      A(){pAImpl = new AImpl;};
      void foo(){pAImpl->foo();};
    private:
      AImpl* pAImpl;  
};
class AImpl
{
    public:
      void foo(){/*do something*/};
}; 
```

我希望能够使用其实现类创建派生的公共类：

```
class B : public A
{
    public:
      void bar(){pAImpl->bar();};    // Can't do! pAimpl is A's private.
};        

class BImpl : public AImpl
{
    public:
      void bar(){/*do something else*/};
}; 
```

但是我不能在 B 中使用 pAimpl，因为它是 A 的私有的。

所以我看到了一些解决方法：

1.  在 B 中创建 BImpl* pBImpl 成员，并使用附加的 A 构造函数 A(AImpl*) 将其传递给 A。
2.  将 pAImpl 更改为受保护（或添加 Get 函数），并在 B 中使用它。
3.  B 不应该从 A 继承。在 B 中创建 BImpl* pBImpl 成员，并在 B 中创建 foo() 和 bar()，这将使用 pBImpl。
4.  还有什么办法吗？

我应该选择什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-30T06:53:40.403

```
class A
{
    public:
      A(bool DoNew = true){
        if(DoNew)
          pAImpl = new AImpl;
      };
      void foo(){pAImpl->foo();};
    protected:
      void SetpAImpl(AImpl* pImpl) {pAImpl = pImpl;};
    private:
      AImpl* pAImpl;  
};
class AImpl
{
    public:
      void foo(){/*do something*/};
};

class B : public A
{
    public:
      B() : A(false){
          pBImpl = new BImpl;
          SetpAImpl(pBImpl);
      };
      void bar(){pBImpl->bar();};    
    private:
      BImpl* pBImpl;  
};        

class BImpl : public AImpl
{
    public:
      void bar(){/*do something else*/};
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T13:37:37.857

我认为从纯粹的面向对象理论的角度来看，最好的方法是不要让 BImpl 从 AImpl 继承（这就是你在选项 3 中的意思吗？）。但是，让 BImpl 从 AImpl 派生（并将所需的 impl 传递给 A 的构造函数）也是可以的，只要 pimpl 成员变量是`const`. 使用 get 函数还是直接从派生类访问变量并不重要，除非您想在派生类上强制执行 const 正确性。让派生类改变 pimpl 不是一个好主意——它们可能会破坏 A 的所有初始化——而且让基类改变它也不是一个好主意。考虑对您的示例进行此扩展：

```
class A
{
protected:
   struct AImpl {void foo(); /*...*/};
   A(AImpl * impl): pimpl(impl) {}
   AImpl * GetImpl() { return pimpl; }
   const AImpl * GetImpl() const { return pimpl; }
private:
   AImpl * pimpl;
public:
   void foo() {pImpl->foo();}

   friend void swap(A&, A&);
};

void swap(A & a1, A & a2)
{
   using std::swap;
   swap(a1.pimpl, a2.pimpl);
}

class B: public A
{
protected:
   struct BImpl: public AImpl {void bar();};
public:
   void bar(){static_cast<BImpl *>(GetImpl())->bar();}
   B(): A(new BImpl()) {}

};

class C: public A
{
protected:
   struct CImpl: public AImpl {void baz();};
public:
   void baz(){static_cast<CImpl *>(GetImpl())->baz();}
   C(): A(new CImpl()) {}
};

int main()
{
   B b;
   C c;
   swap(b, c); //calls swap(A&, A&)
   //This is now a bad situation - B.pimpl is a CImpl *, and C.pimpl is a BImpl *!
   //Consider:
   b.bar(); 
   //If BImpl and CImpl weren't derived from AImpl, then this wouldn't happen.
   //You could have b's BImpl being out of sync with its AImpl, though.
} 
```

尽管您可能没有 swap() 函数，但您可以很容易地想到会发生类似的问题，特别是如果 A 是可分配的，无论是偶然还是有意。这有点微妙地违反了 Liskov 可替代性原则。解决方案是：

1.  请勿在施工后更改 pimpl 成员。将它们声明为`AImpl * const pimpl`. 然后，派生构造函数可以传递适当的类型，派生类的其余部分可以自信地向下转换。但是，您不能进行非抛出交换、分配或写时复制等操作，因为这些技术要求您可以更改 pimpl 成员。但是，如果您有继承层次结构，您可能并不真的打算做这些事情。

2.  分别为 A 和 B 的私有变量提供不相关（和愚蠢）的 AImpl 和 BImpl 类。如果 B 想对 A 做某事，则使用 A 的公共或受保护接口。这也保留了使用 pimpl 的最常见原因：能够将 AImpl 的定义隐藏在派生类无法使用的 cpp 文件中，因此当 A 的实现发生更改时，一半的程序不需要重新编译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T13:18:47.240

正如 stefan.ciobaca 所说，如果您真的希望 A 是可扩展的，那么您会希望`pAImpl`受到保护。

但是，您在`B`of中的定义`void bar(){pAImpl->bar();};`似乎很奇怪，`bar`方法 on`BImpl`和 not 也是如此`AImpl`。

至少有三个简单的替代方案可以避免这个问题：

1.  您的替代方案 (3)。
2.  (3) 的变体，其中`BImpl`extends `AImpl`（继承现有实现`foo`而不是定义另一个），`BImpl`定义`bar`并`B`使用其私有`BImpl* pBImpl`来访问两者。
3.  委托，其中`B`持有指向每个的私有指针，并将每个`AImpl`和`BImpl`转发给适当的实现者。`foo``bar`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T11:59:19.087

我会做（1），因为 A 的私人对 B 来说是或没有业务。

实际上，我不会按照您的建议将其传递给 A，因为 A 在 A::A() 中创建了自己的。从 Bis打电话`pApimpl->whatever()`也不合适（私人**意味着**私人）。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-01-29T12:18:12.293

正确的做法是做（2）。

一般来说，您可能应该考虑让所有成员变量默认受保护而不是私有。

大多数程序员选择私有的原因是他们不考虑其他想要从他们的类派生的人，并且大多数介绍性 C++ 手册都教授这种风格，因为所有示例都使用私有。

编辑

代码重复和内存分配是使用 pimp 设计模式的不良副作用，据我所知是无法避免的。

如果需要让 Bimpl 继承 Aimpl，并且希望通过 A 和 B 向它们公开一致的接口，则 B 也需要继承 A。

在这种情况下，您可以做的简化事情的一件事是让 B 从 A 继承，并且只更改构造器，以便 B::B(...) {} 创建 Bimpl，并为 Bimpl 的所有方法添加调度不在 Aimpl 中。

# .net - 是否有可用的 WPF 备忘单？

> ID：491312
> 
> 赞同：81
> 
> 时间：2009-01-29T11:51:00.427
> 
> 标签：.net, wpf, xaml

我正在寻找一个 WPF 备忘单，其中包含 WPF 标记扩展，用于 WPF 中的绑定、资源和其他常见事物。但到目前为止，我很难找到它。

有谁知道我在哪里可以找到一个？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-02-02T10:19:17.820

我专门为数据绑定编写了一份备忘单，并将其发布在我的博客上：

[http://www.nbdtech.com/blog/archive/2009/02/02/wpf-xaml-data-binding-cheat-sheet.aspx](http://www.nbdtech.com/blog/archive/2009/02/02/wpf-xaml-data-binding-cheat-sheet.aspx)

它非常详细，涵盖了 Binding 类的所有属性（因为我永远不会忘记如何编写 {StaticResource something} 但如何单向绑定到目标元素的祖先是另一回事）。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-01T10:33:25.793

我创建了一个备忘单并将其发布在我的博客上：

[http://blog.blueboxes.co.uk/2009/02/01/xaml-for-wpf-cheatsheet-10-draft/](http://blog.blueboxes.co.uk/2009/02/01/xaml-for-wpf-cheatsheet-10-draft/)

它只是一个草稿（目前在 word 中，最终将是 PDF），我正在寻找有关如何改进它的反馈。

**更新：**现在可以在这里找到最终的 PDF 副本：

[http://blog.blueboxes.co.uk/2009/02/03/xaml-for-wpf-cheatsheet/](http://blog.blueboxes.co.uk/2009/02/03/xaml-for-wpf-cheatsheet/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-06-11T15:04:43.040

我正在寻找装订备忘单并找到了这个线程。我管理常见 WPF 类型的图表。它可以[在这里](http://kittencode.wordpress.com/2013/06/11/wpf-class-hierarchy-diagram-1-2/)

![1.2版](https://i.stack.imgur.com/vVDyE.jpg)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-04-01T18:43:49.263

在即将发布的 Visual Studio 2010 发布之前，我整理了一张可能感兴趣的快速参考挂图。在一个页面上，我比较并对比了以下以***工具箱为中心***的功能：

*   Visual Studio 2008 与 2010
*   .Net 3.5 与 4.0
*   WinForm 与 WPF

我关于此挂图含义的文章可在[Simple-Talk.com](http://www.simple-talk.com/dotnet/.net-framework/from-winform-to-wpf-a-quick-reference-guide/)上找到。在文章顶部的“气泡”中，您可以找到 PDF 格式的挂图链接，提供 LTR 和 A4 两种尺寸。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-06-16T04:45:41.723

我创建了一个 XAML 备忘单，目前专注于 Silverlight。在未来的某个时候，我也打算拥有一个 WPF，尽管我注意到在 WPF 方面的重复工作。周围已经有数了。它将专注于补充它们而不是竞争。

[http://www.xamlsource.net/xamlcheatsheet](http://www.xamlsource.net/xamlcheatsheet)

欢迎所有反馈！

更新：我没有更新域名，但是 Wayback 机器在[这里存档了](https://web.archive.org/web/20120104133557/http://www.xamlsource.net/xamlcheatsheet)一个副本。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-11T15:01:20.250

Refcardz 有一个免费的 WPF 备忘单。您可以在线查看。要将其下载为 PDF，您需要在该站点注册。

[http://blog.codebeach.com/2009/11/free-wpf-cheat-sheet.html](http://blog.codebeach.com/2009/11/free-wpf-cheat-sheet.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-08-29T06:16:23.790

我最近为我的公司写了一份备忘单。如果您有兴趣，可以在这里找到：http: [//objectis.ch/Blog/tabid/105/post/wpf-binding---cheat-sheet](http://objectis.ch/Blog/tabid/105/post/wpf-binding---cheat-sheet)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-29T12:11:29.950

.NET Framework 3.5[常用类型和命名空间海报](http://blogs.msdn.com/brada/archive/2008/01/12/net-framework-3-5-namespace-poster-updated.aspx)有一个关于 WPF 中常见事物的部分以及包括基础知识在内的其他几个部分。

它有几种不同的格式，如 XPS 和 PDF。也许它可能有用...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-05-25T17:07:55.357

在 WPF 首次出现后不久，我创建了一个 XAML 备忘单。这很好，因为它不仅仅是数据绑定。

[https://www.mindfiretechnology.com/blog/archive/xaml-cheat-sheet/](https://www.mindfiretechnology.com/blog/archive/xaml-cheat-sheet/)

# javascript - 有没有办法从 MSXML XPath 评估器获得非节点结果？

> ID：491314
> 
> 赞同：2
> 
> 时间：2009-01-29T11:52:13.657
> 
> 标签：javascript, dom, xpath, msxml

我知道 selectNode/selectSingleNode 方法的名称实际上表明它们旨在返回一个节点，但是也许还有其他方法或设置可用于使 XPath 评估器返回其他类型的数据（这也是有效的 XPath 结果）

```
oDocument.selectSingleNode("'1'"); 

```

抛出错误“表达式不返回 DOM 节点”

我想查询 oDocument.selectSingleNode("concat(@day, '-', @month, '-', @year") 并得到一个结果（这可以通过标准 DOM XPath API）。确实我可以查询节点然后用 DOM 遍历它们，但是这将是低效的方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T11:58:54.173

`selectSingleNode()`并`selectNodes()`选择由 XPath 表达式标识的节点。

它们的返回值分别是`IXMLDOMNode`和`IXMLDOMNodeList`。没有其他东西可以退货。

不返回节点集的表达式（否则是有效的 XPath 表达式）将导致错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T14:16:32.787

**msxml 公开的 API 不允许这样做**。

**您可以查看[XPath Visualizer](http://www.topxml.com/code/cod-422_10119_xpath-visualizer-14.aspx)[的源代码](http://www.topxml.com/code/cod-422_10119_xpath-visualizer-14.aspx)，了解如何成功评估此类 XPath 表达式**。简而言之，当捕获到试图评估 XPath 表达式的异常时，并且此异常的消息正是您（原始）问题中提供的消息，然后动态创建特殊的 XSLT 转换，并返回 XPath 的结果表达式使用`<xsl:value-of>`

# vb.net - How to do Mailmerge in Openoffice using Vb.net

> ID：491318
> 
> 赞同：-2
> 
> 时间：2009-01-29T11:56:12.180
> 
> 标签：vb.net, openoffice.org, mailmerge

Its 5th Question and apart of one I didn't get response from the experts....

Hope this time I will get the helping hand.

I want to do mailmerge in openoffice using Vb.net and I am totally new with openoffice. I searched on net for some help to understand how to use openoffice with vb.net but all I get is half info.....So can you please help me and give me code for mailmerge in vb.net for openoffice.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T15:13:58.300

好吧，我有 DB 中的工人名单，并且有这个设施，如果他们想邮寄给所有或部分工人，那么他们可以做到。我现在使用 Microsoft Office 作为插件完成了这项任务，我们正在提供设施使用 Open Office 执行相同的任务。

他们所要做的就是选择工作人员列表并单击一个按钮，它将使用数据库中这些工作人员数据的字段自动进行邮件合并。我的代码如下所示

```
Public Sub OpenOfficeMail(ByVal StrFilter As String)
    Dim oSM ''Root object for accessing OpenOffice from VB
    Dim oDesk, oDoc As Object ''First objects from the API
    Dim arg(-1) ''Ignore it for the moment !

    ''Instanciate OOo : this line is mandatory with VB for OOo API
    oSM = CreateObject("com.sun.star.ServiceManager")
    ''Create the first and most important service
    oDesk = oSM.createInstance("com.sun.star.frame.Desktop")

    ''Create a new doc
    oDoc = oDesk.loadComponentFromURL("private:factory/swriter", "_blank", 0, arg)
    ''Close the doc
    oDoc.Close(True)
    oDoc = Nothing

    ''Open an existing doc (pay attention to the syntax for first argument)
    oDoc = oDesk.loadComponentFromURL("file:///C:\Users\Savan\Documents\1.odt", "_blank", 0, arg)
    Dim t_OOo As Type
    t_OOo = Type.GetTypeFromProgID("com.sun.star.ServiceManager")
    Dim objServiceManager As New Object
    objServiceManager = System.Activator.CreateInstance(t_OOo)
    Dim oMailMerge As New Object
    oMailMerge = t_OOo.InvokeMember("createInstance", Reflection.BindingFlags.InvokeMethod, Nothing, _
 objServiceManager, New [Object]() {"com.sun.star.text.MailMerge"}) 'com.sun.star.text.MailMerge"})
    oMailMerge.DocumentURL = "file:///C:\Users\Savan\Documents\1.odt"
    oMailMerge.DataSourceName = CreateSource(StrFilter)''Function that will return the datasource name which will be a text file's path
    oMailMerge.CommandType = 0
    oMailMerge.Command = "file:///C:\Mail.txt"
    oMailMerge.OutputType = 2
    oMailMerge.execute(New [Object]() {})**---->I am getting Error here**
End Sub 
```

# java - 不在事件调度线程上构造 Swing/AWT 小部件是否安全？

> ID：491323
> 
> 赞同：34
> 
> 时间：2009-01-29T11:57:42.770
> 
> 标签：java, multithreading, user-interface, swing, awt

我一直在将[Substance](https://substance.dev.java.net/)的外观和感觉集成到我的应用程序中，并遇到了一些关于其内部 EDT（事件调度线程）检查例程的问题。Substance 绝对拒绝在 EDT 之外构建 UI 类。我已经做了很多 Swing/AWT 并且我知道大部分关于 EDT 的规则。我使用 SwingWorker、SwingUtilties.invokeLater 来修改组件。我一直认为组件可以在 EDT 之外***构建***，但必须在EDT 上***实现***和***操作***。换句话说，您可以在后台构造和设置默认值，但对 pack/setVisible 的调用必须是 EDT 以及任何后续调用来操作组件。

我问的原因是我有一个特别“强大”的窗口要构建，涉及许多小部件、状态和资源（很多图标）。之前，我在 SwingWorker 的背景方法上构建了窗口，并在 done 方法中使窗口可见。从来没有一个问题。切换到 Substance 后，内部 EDT 检查让我很头疼。

我已经能够重构代码来解决这个问题。我可以在 EDT 上进行构建，这不是一个好的解决方案，因为整个应用程序都会阻塞。我还可以进行更多重构，并尽我所能加载 EDT 之外的所有额外资源。

结束它......在事件调度线程上***构建***Swing/AWT 小部件是否安全？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-29T12:20:22.880

**Sun 在 2004 年更改了规则——之前，您可以在 EDT 之外创建组件，并且只有在组件实现**后才需要进入 EDT 。

新规则现在如下：

> 为避免死锁的可能性，您必须格外小心，仅从事件调度线程**创建、修改和查询 Swing 组件和模型。**

[我的这篇](http://netzwerg.ch/blog/2007/06/20/threads-and-swing)博文提供了更多详细信息，包括指向其他​​相关文章的链接。请注意，所有官方 Sun[示例](http://java.sun.com/docs/books/tutorial/uiswing/examples/start/HelloWorldSwingProject/src/start/HelloWorldSwing.java)都已重写，并且对此非常严格。

从历史上看，多核计算机作为台式机的日益普及可能推动了规则的重新制定——线程问题在客户端堆栈上变得越来越明显，并且由于对 EDT 指南非常严格，很多他们可以从一开始就被阻止。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-29T12:02:12.513

不。

原因很简单，即使是 EDT 在极少数情况下也喜欢死锁，而且通常在使用 Swing 时很容易死锁 UI（*至少有人告诉过我*）。我建议您阅读 Kirill（Substance 开发者）博客中的这三篇文章：

*   [关于 Swing EDT 违规的新文章](http://www.pushing-pixels.org/?p=126)
*   [使用 Swing 的 EDT 的不成文规则](http://www.pushing-pixels.org/?p=204)
*   [对物质中的 EDT 违规行为进行更严格的检查](http://www.pushing-pixels.org/?p=368)

# .net - "Reliable" file work with .NET

> ID：491325
> 
> 赞同：0
> 
> 时间：2009-01-29T11:58:09.417
> 
> 标签：.net, file, io

An application needs a counter, which value to be stored in a text file. Sometimes it happens on very short intervals.

This test code rewrites a text file very often (f.e. every 100 milliseconds):

```
int counter = 0;

while (true)
{
    WriteToFile(counter);
    counter++;
    Thread.Sleep(100);
}

private void WriteToFile(int counter)
{
    byte[] buffer = Encoding.ASCII.GetBytes(counter.ToString());
    using (FileStream createFile = new FileStream("Counter.txt", FileMode.Create))
    {
        createFile.Write(buffer, 0, buffer.Length);
        createFile.Close();
    }
} 
```

It works basically fine except in one of our "reliable tests" - stopping the computer electricity supply while the application is running.

The bad surprise was - in the file wasn't any text (should be a number) but only one or two space characters.

The missing last value it tries to write is understandable but making the file not consistent is really bad...

Trying the use of:

```
createFile.Flush();
createFile.Close();
createFile.Dispose();

GC.Collect();
GC.WaitForPendingFinalizers(); 
```

doesn't help.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T12:08:25.260

各种选择浮现在脑海中：-

1）保留当前文件的临时副本，例如重命名旧文件，写入新文件，删除旧文件（或用临时名称写入新文件，删除旧文件，重命名新文件），但也许您也在写出文件经常为了这种事情

2) 写入多个文件，并定期清理，例如 0001.txt、0002.txt、0003.txt 等，每 10 秒删除除最后一个文件之外的所有文件。

3）多次写入同一个文件，也许定期创建一个新文件，比如每10分钟一次，再次定期清理。

4) 使用第三方日志平台，例如 log4net，它可能可以防止断电等事件，并且可以记录到各种目标，例如文件、数据库、IRC

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T12:04:34.503

我认为最简单的做法是在 Windows Vista/2008 中使用事务文件系统：

[http://www.michaelckennedy.net/blog/2007/12/07/SystemTransactionsAndWindowsVistaNTFSUpdated.aspx](http://www.michaelckennedy.net/blog/2007/12/07/SystemTransactionsAndWindowsVistaNTFSUpdated.aspx)

[http://msdn2.microsoft.com/magazine/2fc4ae05-f7b8-49d2-8630-f24bc9dfc2e6](http://msdn2.microsoft.com/magazine/2fc4ae05-f7b8-49d2-8630-f24bc9dfc2e6)

也就是说，如果你是少数几个运行它的人之一......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T13:03:04.853

您的文件缺少值，因为电源中断在 Windows 有机会将其刷新到磁盘之前将其关闭。您可以随心所欲地调用 Flush、Close、Dispose 等，但如果电源故障中断调用，它们将无法操作。充其量，它们会减少脆弱性的窗口。

我认为亚当拉尔夫的答案是最适合在任何系统上运行的答案。我投了他的票，但想加我的 0.02 美元，因为你的各种系统调用失败来纠正这个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T14:03:19.973

关闭文件系统分区中的“优化性能”。您正在写入文件，但 Windows 并不费心将数据写入物理磁盘，而是将其保存在内存中，以便最终写入，即。当有一些空闲时间。

显然你没有给它任何空闲时间:)

因此，关闭该标志并让 Windows 每次都将内容写入磁盘。这就像您用于闪存驱动器的同一标志，以确保在您将东西从 USB 端口中拉出之前实际写入数据。[您可以强制 Windows 使用FlushFileBuffers](http://msdn.microsoft.com/en-us/library/aa364439(VS.85).aspx) API 调用写入数据。

或者您可以使用[FILE_FLAG_WRITE_THROUGH](http://support.microsoft.com/kb/99794)选项。

显然，确保你的硬件也在写入数据——如果你有一个 RAID 卡，它会缓存数据写入本身，你需要一个电池来备份它以确保数据被物理写入驱动器。

我认为你不会对表演感到满意。最好的办法是使用电池支持的 RAID 卡写入磁盘。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T15:15:07.677

谢谢大家的回答。

听他们说，现在的解决方案变成了：

使用 (FileStream createFile = new FileStream("Counter.txt", FileMode.Create, FileAccess.Write, FileShare.None, 8, FileOptions.WriteThrough)) {}

由于最后一个参数 - FileOptions.WriteThrough，所有参数都包含在内。其目的是避免使用各种现金、缓冲区、内存等。

由于此解决方案不提供 100% 的保证（由于硬件原因 :)），因此保留了备份。事实上，每次写入都会进行两次 - 在原始文件和备份文件中。

# php - Creating an isset if function using php to avoid and update if the input is empty for a MYSQL update

> ID：491330
> 
> 赞同：-1
> 
> 时间：2009-01-29T12:01:06.290
> 
> 标签：php, mysql, validation, isset

Hi I am newish to php and I have created an update page for Content Management System. I have a file upload in this case a picture. I have other inputs that contain text and I can get them to populate my form and thats fine and works great because the user can see what has already been entered. But the file name for the photo can not have a value so if the user doesn't pick the picture from the directory again it will update minus the picture. **What I think I need is a isset function that says if the file (picture) input is left blank don't update this field and use whatever what already in the database for it, that way if it was left blank when created it will still be, and if the user has changed it this time it will change; or if they want to leave it the same it won't leave their picture blank. Hope that makes sence.**

Here is my coding currently for the Form:

```
 <p>
              Photo:
            </p>
            <input type="hidden" name="MAX_FILE_SIZE" value="350000">
            <input type="file" name="photo"/> 
```

Below is my php code for my update if the update button is pressed:

```
 $con = mysql_connect("localhost","******","********");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("*******", $con);

  // run this only, once the user has hit the "Update" button

  if (isset($_POST['update'])) {

    // assign form inputs

    $name = $_POST['nameMember'];

    $position = $_POST['bandMember'];

    $pic = $_POST['photo'];

    $about = $_POST['aboutMember'];

    $bands = $_POST['otherBands'];

      // add member to database

    $result = mysql_query("UPDATE dbProfile SET nameMember='".$name."',bandMember='".$position."',photo='".$pic."',aboutMember='".$about."',otherBands='".$bands."' WHERE id='".$id."'");

        mysql_close($con);

      Header("Location: listMember.php"); 

      exit; 

    }

  else { // read member data from database

    $result = mysql_query ("SELECT * FROM dbProfile WHERE id='".$id."'");

    while($row = mysql_fetch_array($result))

{

   $name = $row['nameMember'];

    $position = $row['bandMember'];

    $pic = $row['photo'];

    $about = $row['aboutMember'];

    $bands = $row['otherBands'];

  }
  }
  mysql_close($con);
?> 
```

If you could help I would be very please and greatful.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T12:03:59.153

您必须使用该[`$_FILES`变量](http://docs.php.net/manual/en/reserved.variables.files.php)来上传文件。有关详细信息，请参阅PHP 手册中的[处理文件上传](http://docs.php.net/manual/en/features.file-upload.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T20:47:16.553

尝试：

```
if(is_uploaded_file($_FILES['photo']['tmp_name'])) 
```

从手册：

> 如果 filename 命名的文件是通过 HTTP POST 上传的，则返回 TRUE。这有助于确保恶意用户没有试图欺骗脚本来处理它不应该在其上工作的文件——例如，/etc/passwd。

# testing - 针对 Windows CE 和 PDA 设备的自动化测试工具的建议

> ID：491333
> 
> 赞同：2
> 
> 时间：2009-01-29T12:02:04.930
> 
> 标签：testing, automation, windows-ce

有没有人知道在 Windows CE / 移动平台上进行自动化测试的任何好的甚至合理的工具。我知道的潜在工具包括 TestQuest、Countdown、SOTI 袖珍控制器和 Eggplant。还有什么我错过的吗？

或者，是否有人知道用于 Windows 移动设备的 VNC 或远程显示工具可以在 PC 上复制 Windows 视觉对象层次结构，而不是将整个设备显示为单个位图？如果能做到这一点，主流的桌面自动化工具就可以应用到 Windows mobile 上。

注意我已经阅读了这个有用的[相关问题](https://stackoverflow.com/questions/122198/automated-test-framework-windows-ce)，但我正在寻找一个可行的现成替代方案。这篇文章是[对 SQAforums 的 PDA/Embedded 部分中](http://www.sqaforums.com/postlist.php?Cat=0&Board=UBB29&page=0)的一些相关文章的跟进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T17:24:46.293

我意识到您的问题直接是“是否有工具可以在 CE 上进行自动化测试”，但是您是否考虑过将您的自动化针对可以从标准桌面环境访问的应用程序版本？通过这种方式，您可以使用所有标准自动化工具。

例如，我参与了一些需要对设备执行自动化测试的项目。在所有情况下，RF 设备实际上只是一个连接到基于 Web 的应用程序的 Web 浏览器。相同的 URL 和简单的表单可以插入标准桌面浏览器，并由任何常用的自动化工具集自动化。自动化永远不会取代手动测试，因此我们在这些项目中所做的是对射频设备使用的同一 Web 界面进行自动化回归测试，但仍然直接在设备上进行一些健全的手动测试。

此外，关于 VNC/位图问题，我之前一直在走这条路，并同意这是一场噩梦。在 VNC 位图上使用标准桌面 UI 自动化不仅不可靠且无法维护，而且速度很慢 - 在大多数工具中，CPU 会不停地从左上角到右下角搜索整个位图以查找所需的图像。真的真的很慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T13:04:35.070

检查[Hopper](http://msdn.microsoft.com/en-us/library/bb158517.aspx)，一个用于 Windows Mobile 的测试工具。

# c# - 为什么 Boolean.ToString 输出“真”而不是“真”

> ID：491334
> 
> 赞同：254
> 
> 时间：2009-01-29T12:02:08.410
> 
> 标签：c#, .net, boolean

```
true.ToString() 
false.toString();

Output:
True
False 
```

它是“真实”而不是“真实”有正当理由吗？在编写 XML 时它会中断，因为 XML 的 boolean 类型*是小写*，并且与 C# 的 true/false 不兼容（虽然不确定 CLS）。

**更新**

这是我在 C# 中绕过它的非常老套的方法（用于 XML）

```
internal static string ToXmlString(this bool b)
{
    return b.ToString().ToLower();
} 
```

当然，这会在堆栈中增加 1 个方法，但会在任何地方删除 ToLowers()。

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2009-01-29T12:23:36.837

只有微软的人才能真正回答这个问题。但是，我想提供一些有趣的事实；）

首先，这是 MSDN 中关于**Boolean.ToString()**方法的说法：

> **返回值**
> 
> 类型：System.String
> 
> *如果此实例的值为 true，则为*TrueString ；如果此实例的值为 false，**则为 FalseString*。*
> 
>  ***评论**
> 
> 此方法返回常量“True”或“False”。请注意，XML 区分大小写，并且 XML 规范将“true”和“false”识别为有效的布尔值集。如果要将 ToString() 方法返回的 String 对象写入 XML 文件，则应首先调用其 String.ToLower 方法将其转换为小写。*

 *有趣的事实#1 出现了：它根本不返回 TrueString 或 FalseString。它使用硬编码的文字“True”和“False”。如果它使用这些字段对你没有任何好处，因为它们被标记为只读，所以没有改变它们。

另一种方法**Boolean.ToString(IFormatProvider)**更有趣：

> **评论**
> 
> 提供者参数是保留的。它不参与此方法的执行。这意味着 Boolean.ToString(IFormatProvider) 方法与大多数具有提供程序参数的方法不同，它不反映特定于区域性的设置。

解决方案是什么？取决于你到底想做什么。不管是什么，我打赌它都需要破解 ;)

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2009-01-29T12:14:49.227

...因为 .NET 环境旨在支持多种语言。

System.Boolean（在 mscorlib.dll 中）旨在供语言在内部使用以支持布尔数据类型。C# 的关键字使用全部小写，因此使用“bool”、“true”和“false”。

然而，VB.NET 使用标准大小写：因此是“布尔”、“真”和“假”。

由于语言必须协同工作，因此您不能让 true.ToString() (C#) 给出与 True.ToString() (VB.NET) 不同的结果。CLR 设计者为 ToString() 结果选择了标准的 CLR 大小写表示法。

布尔值 true 的字符串表示定义为 Boolean.TrueString。

（System.String 也有类似的情况：C# 将其呈现为“字符串”类型）。

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2009-01-29T12:13:45.750

对于 Xml，您可以使用[XmlConvert.ToString](http://msdn.microsoft.com/en-us/library/system.xml.xmlconvert.tostring.aspx)方法。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-01-29T12:11:05.270

将其转换为所有小写字母的简单代码。

然而，将“真”转换回“真”并不是那么简单。

```
true.ToString().ToLower() 
```

是我用于 xml 输出的。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-29T12:10:41.760

它如何与 C# 不兼容？Boolean.Parse 和 Boolean.TryParse 不区分大小写，解析是通过将值与“True”和“False”的 Boolean.TrueString 或 Boolean.FalseString 进行比较来完成的。

编辑：当查看反射器中的 Boolean.ToString 方法时，事实证明字符串是硬编码的，因此 ToString 方法如下：

```
public override string ToString()
{
    if (!this)
    {
        return "False";
    }
    return "True";
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-10-28T12:19:58.953

我知道为什么它已经被解决了，但是当涉及到“自定义”布尔格式时，我有两个我不能没有的扩展方法:-)

```
public static class BoolExtensions
{
    public static string ToString(this bool? v, string trueString, string falseString, string nullString="Undefined") {
        return v == null ? nullString : v.Value ? trueString : falseString;
    }
    public static string ToString(this bool v, string trueString, string falseString) {
        return ToString(v, trueString, falseString, null);
    }
} 
```

用法是微不足道的。下面将各种布尔值转换为它们的葡萄牙语表示：

```
string verdadeiro = true.ToString("verdadeiro", "falso");
string falso = false.ToString("verdadeiro", "falso");
bool? v = null;
string nulo = v.ToString("verdadeiro", "falso", "nulo"); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-10T23:33:21.120

之所以`true`是“True”，是因为 Microsoft 与 XML 标准的紧密联系。

来自[维基百科：“可扩展标记语言 (XML) 是一种标记语言，它定义了一组规则，用于以](http://en.wikipedia.org/wiki/XML)**人类可读**和机器可读的格式对文档进行编码。”

人类可读性是主观的，但在 XML 的眼中，使用单词“One”代替数字“1”是首选。您会注意到使用枚举会发生这种情况，因为单词被序列化而不是其值（“FirstOption”而不是“0”或“1”）。

同样，文本通常遵循[CamelCasing](http://en.wikipedia.org/wiki/CamelCase)。因此，XML 更喜欢“字符串”而不是“字符串”。这就是默认情况下 Boolean.TrueString 为“True”而 Boolean.FalseString 为“False”的原因。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-29T12:25:24.947

这可能来自旧的 VB NOT .Net 时代，当时 bool.ToString 产生 True 或 False。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2022-01-24T07:51:59.193

```
 public bool CheckBool(string res)
    {
        if (res == null)
        {
            return false;
        }

        if (res.ToLower() == "true")
        {
            return true;
        }
        if (res.ToLower() == "false")
        {
            return false;
        }
        if (res == "0")
        {
            return false;
        }
        if (res == "1")
        {
            return true;
        }
        else
        {
            return bool.Parse(res);
        }
    } 
```

# asp.net-mvc - ASP.NET MVC 框架“类 REST”API

> ID：491340
> 
> 赞同：0
> 
> 时间：2009-01-29T12:04:40.057
> 
> 标签：asp.net-mvc, restful-authentication

我开发了一个“类似 REST”的 XML API，我希望将其公开以供第三方 Web 应用程序使用。我现在正在寻求实现一个安全模型，用于在第三方应用程序和“类似 REST”的 XML API 之间交换数据。我将不胜感激有关合适的非对称加密模型的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T12:45:04.813

如果你想要加密，为什么不只使用 SSL 来加密连接而不是加密响应数据呢？如果 128 位 SSL 还不够，那么您要么需要使用外部可信机构集成一些现有的 PKI 基础架构，要么自己开发密钥分发/共享基础架构并发布您的公钥和合适的私钥/标识符您的 API 消费者。在 System.Security.Cryptography 中选择支持公钥/私钥交换的加密提供程序之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T12:59:54.237

HTTPS 使用非对称密钥加密。它是众所周知的易于实现的协议。它可以防止您的通信中的 3p 入侵。

您需要实现“以下”的只是身份验证 - 以确保您知道您的用户。

常见的做法是为用户提供每个请求都需要发送的密钥。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-14T01:05:49.970

最常见的是实现 OAuth 协议。这就是 OpenSocial 提供商使用 2-legged 和/或 3-legged oAuth 检查授权的内容

只要做一些谷歌搜索，你会发现很多实现。

# sql - 有效地检查文本列中是否存在文本

> ID：491343
> 
> 赞同：2
> 
> 时间：2009-01-29T12:05:23.770
> 
> 标签：sql, database, oracle

我有一个大约 2,000,000 行的表。我需要查询其中一列以检索字符串作为值的一部分存在的行。

当我运行查询时，我会知道字符串的位置，但不是事先知道的。因此，采用子字符串的视图不是一种选择。

据我所知，我有三个选择

1.  使用类似 '% %'</li>
2.  使用指令
3.  使用 substr

如果我对 dba 很好，我确实可以选择创建基于函数的索引。

目前所有查询都需要大约两秒钟。有没有人知道这些选项中的哪一个效果最好，或者是否还有其他选项？选择将用于每隔几秒删除一次，它通常会选择 10 行。

**编辑更多信息**

当我们使用一个表来存储具有任意键和值的对象时，问题就出现了。对象来自我们的系统外部，因此我们控制它们的范围有限，因此文本列类似于 'key1=abc,key2=def,keyn=ghi' 我知道这是非常非规范化的，但因为我们不知道是什么键将（在某种程度上）它是存储和检索值的可靠方法。检索一行是相当快的，因为我们正在搜索整个列，这是索引。但是如果我们要检索 key2=def 的行，性能并不好。

我们也许可以为最常用的键创建一个包含列的表，但我想知道是否有办法通过现有设置来提高性能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T12:51:39.293

您可以使用[Tom Kyte 的 runstats 包](http://asktom.oracle.com/tkyte/runstats.html)来比较不同实现的性能 - 每个都在循环中运行 1000 次。例如，我刚刚将 LIKE 与 SUBSTR 进行了比较，它说 LIKE 更快，大约占 SUBSTR 时间的 80%。

请注意，“col LIKE '%xxx%'”不同于“SUBSTR(col,5,3) = 'xxx'”。等效的 LIKE 将是：

```
col LIKE '____xxx%' 
```

对每个要忽略的前导字符使用一个“_”。

我认为无论您采用哪种方式，结果都会相似——它总是涉及全表（或者可能是全索引）扫描。仅当您在创建索引时知道子字符串的偏移量时，基于函数的索引才会有所帮助。

当您说“选择将用于每隔几秒删除一次”时，我很担心。这确实暗示了某处的设计缺陷，但在不知道要求的情况下很难说。

**更新：**

如果您的列值类似于 'key1=abc,key2=def,keyn=ghi' 那么也许您可以考虑添加另一个像这样的表：

```
 create table key_values
    ( main_table_id references main_table
    , key_value varchar2(50)
    , primary key (fk_col, key_value)
    );

 create index key_values_idx on key_values (key_value); 
```

拆分键值并将它们存储在此表中，如下所示：

```
main_table_id key_value
123           key1=abc
123           key2=def
123           key3=ghi 
```

（例如，这可以在 main_table 上的 AFTER INSERT 触发器中完成）

那么你的删除可能是：

```
delete main_table
where id in (select main_table_id from key_values
             where key_value = 'key2=def'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T13:42:28.817

在甲骨文 10 中：

```
CREATE TABLE test (tst_test VARCHAR2(200));

CREATE INDEX ix_re_1 ON test(REGEXP_REPLACE(REGEXP_SUBSTR(tst_test, 'KEY1=[^,]*'), 'KEY1=([^,]*)', '\1'))

SELECT  *
FROM    TEST
WHERE   REGEXP_REPLACE(REGEXP_SUBSTR(TST_TEST, 'KEY1=[^,]*'), 'KEY1=([^,]*)', '\1') = 'TEST' 
```

这将使用新选择的索引。

`KEY`您将需要与数据中的 s一样多的索引。

当然，存在 a 会`INDEX`影响性能，但它很少依赖于`REGEXP`存在：

```
SQL> CREATE INDEX ix_test ON test (tst_test)
  2  /
Index created
Executed in 0,016 seconds

SQL> INSERT
  2  INTO   test (tst_test)
  3  SELECT 'KEY1=' || level || ';KEY2=' || (level + 10000)
  4  FROM   dual
  5  CONNECT BY
  6     LEVEL <= 1000000
  7  /
1000000 rows inserted
Executed in 47,781 seconds

SQL> TRUNCATE TABLE test
  2  /
Table truncated
Executed in 2,546 seconds

SQL> DROP INDEX ix_test
  2  /
Index dropped
Executed in 0 seconds

SQL> CREATE INDEX ix_re_1 ON test(REGEXP_REPLACE(REGEXP_SUBSTR(tst_test, 'KEY1=[^,]*'), 'KEY1=([^,]*)', '\1'))
  2  /
Index created
Executed in 0,015 seconds

 SQL> INSERT
      2  INTO   test (tst_test)
      3  SELECT 'KEY1=' || level || ';KEY2=' || (level + 10000)
      4  FROM   dual
      5  CONNECT BY
      6     LEVEL <= 1000000
      7  /
1000000 rows inserted
Executed in 53,375 seconds 
```

如您所见，在我的速度不是很快的机器（`Core2 4300`, `1 Gb RAM`）上，您可以每秒向索引字段插入`20000`记录，而且这个速度几乎不取决于`INDEX`所使用的类型：普通或基于函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T12:22:10.380

我建议重新考虑你的逻辑。

与其寻找字符串存在的位置，不如检查它的长度是否大于 0 并且不是字符串可能会更快。

您可以使用 oracle 中的 TRANSLATE 函数将所有非字符串字符转换为空值，然后检查结果是否为空值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T12:47:15.510

你能提供更多信息吗？

您是在查询字符串列的任意子字符串，还是在列中存储的字符串上有一些语法可以允许进行一些预处理以最大限度地减少重复工作？

您是否已经对您的三个选项进行了任何时序测试，以确定它们在您查询的数据上的相对性能？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T14:07:49.730

单独回答对表格设计的评论。

你不能至少有一个 KEY/VALUE 结构，所以不是存储在单个列中，'key1=abc,key2=def,keyn=ghi' 你会有一个像这样的子表

```
KEY     VALUE
key1    abc
key2    def
key3    ghi 
```

然后您可以在键和值上创建单个索引，并且您的查询要简单得多（因为我认为您实际上是在寻找给定键值的完全匹配）。

有些人可能会评论说这是一个糟糕的设计，但我认为它比你现在拥有的要好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T14:03:06.683

如果您总是要寻找相同的子字符串，那么使用 INSTR 和基于函数的索引对我来说很有意义。如果您有一小组要查找的常量子字符串，您也可以这样做，为每个子字符串创建一个 FBI。

Quassnoi 的 REGEXP 想法看起来也很有希望。我还没有在 Oracle 中使用过正则表达式。

我认为 Oracle Text 将是另一种方式。相关信息在[这里](http://www.oracle.com/technology/products/text/index.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T14:07:00.623

不确定改进现有设置的东西，但 Lucene（全文搜索库；移植到许多平台）确实可以提供帮助。将索引与数据库同步会有额外的负担，但是如果您有任何类似于某种编程语言中的服务层的东西，这将变得很容易。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T22:03:08.790

[与 Anton Gogolev 的回复类似，Oracle 确实包含了此处](http://mis3nt.gsnu.ac.kr/publicdata/Oracle11gDoc/text.111/b28304/toc.htm)记录的文本搜索引擎

还有可扩展的索引，因此您可以构建自己的索引结构，记录[在这里](http://mis3nt.gsnu.ac.kr/publicdata/Oracle11gDoc/appdev.111/b28425/toc.htm)

正如您所同意的，这是一个非常糟糕的数据结构，我认为您将难以实现每隔几秒钟删除一次内容的目标。根据这些数据的输入方式，我会考虑在加载时正确构建数据，至少在具有“parent_id”、“key_name”、“key_value”行的范围内。

# sql - 实体框架生成的用于字符串匹配的 SQL

> ID：491345
> 
> 赞同：7
> 
> 时间：2009-01-29T12:06:56.527
> 
> 标签：sql, entity-framework

鉴于此针对 EF 数据上下文的 linq 查询：

```
var customers = data.Customers.Where(c => c.EmailDomain.StartsWith(term)) 
```

你会期望它产生这样的 SQL，对吧？

```
SELECT {cols} FROM Customers WHERE EmailDomain LIKE @term+’%’ 
```

好吧，实际上，它做了这样的事情：

```
SELECT {cols} FROM Customer WHERE ((CAST(CHARINDEX(@term, EmailDomain) AS int)) = 1) 
```

你知道为什么吗？

此外，将 Where 选择器替换为：

```
c => c.EmailDomain.Substring(0, term.Length) == term 
```

它运行速度快了 10 倍，但仍然会产生一些非常糟糕的 SQL。

**注意：** Linq to SQL 正确地将 StartsWith 转换为 Like {term}%，并且 nHibernate 有一个专用的 LikeExpression。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-09-27T08:36:45.420

我不了解 MS SQL 服务器，但在 SQL 服务器上，紧凑型 LIKE 'foo%' 比 CHARINDEX 快数千倍，如果您在 seach 列上有 INDEX。现在我正坐着把头发拉出来，如何强迫它使用 LIKE。

[http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/1b835b94-7259-4284-a2a6-3d5ebda76e4b](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/1b835b94-7259-4284-a2a6-3d5ebda76e4b)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T12:35:49.230

原因是 CharIndex 比 LIKE 执行 SQL 更快、更清晰。原因是，你***可以***有一些疯狂的“LIKE”子句。例子：

```
SELECT * FROM Customer WHERE EmailDomain LIKE 'abc%de%sss%' 
```

但是，“CHARINDEX”函数（基本上是“IndexOf”）只处理查找一组字符的第一个实例......不允许使用通配符。

所以，这就是你的答案:)

编辑：我只是想补充一点，我鼓励人们在他们的 SQL 查询中使用 CHARINDEX 来处理他们不需要“LIKE”的事情。需要注意的是，尽管在 SQL Server 2000 中……“文本”字段可以使用*LIKE*方法，但不能使用 CHARINDEX。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T12:37:19.930

LIKE 和 CHARINDEX 之间的性能似乎大致相同，所以这不应该是原因。请参阅[此处](http://bytes.com/groups/ms-sql/81467-using-charindex-vs-like-where)或[此处](http://204.9.76.233/Community/forums/p/16120/95084.aspx#95084)进行一些讨论。CAST 也很奇怪，因为 CHARINDEX 返回一个 int。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T14:22:31.963

charindex 返回第一项在第二项中的位置。

sql 以 1 作为第一个位置开始（0 = 未找到）

[http://msdn.microsoft.com/en-us/library/ms186323.aspx](http://msdn.microsoft.com/en-us/library/ms186323.aspx)

我不知道它为什么使用那种语法，但这就是它的工作原理

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T13:39:56.027

我同意它并没有更快，我正在从我们的数据库中检索数以万计的带有字母 i 名称的行。但是我确实发现您需要使用 > 而不是 = ... 所以使用

```
{cols} FROM Customer WHERE ((CAST(CHARINDEX(@term, EmailDomain) AS int)) > 0) 
```

而不是

```
{cols} FROM Customer WHERE ((CAST(CHARINDEX(@term, EmailDomain) AS int)) = 1) 
```

这是我的两个测试....

```
select * from members where surname like '%i%'    --12 seconds

select * from sc4_persons where ((CAST(CHARINDEX('i', surname) AS int)) > 0)  --12 seconds

select * from sc4_persons where ((CAST(CHARINDEX('i', surname) AS int)) = 1)  --too few results 
```

# apache-flex - 处理 flash.events.MouseEvent 时，如何找到相对于 currentTarget 的 localX/Y？

> ID：491346
> 
> 赞同：1
> 
> 时间：2009-01-29T12:07:22.500
> 
> 标签：apache-flex, flash, actionscript

我有一个绘制事物网格的组件，我想要一个小的高亮方块跟随鼠标，突出鼠标当前所在的方块。

整个网格基本上只是一个大精灵（它是一个非常大的网格，这比使用预先存在的组件要快），高亮方块是另一个我试图根据鼠标位置移动的精灵。

所以，我有一个附加到网格精灵的 MouseEvent.MOUSE_MOVE 处理程序，它试图确定鼠标在哪里以及它在哪个方格上，以便它可以将高亮方格移动到正确的位置。我为此使用了localX/localY，但是一旦我将高亮精灵移动到鼠标下，这些精灵就会变成高亮的本地，而不是网格！

我也在玩 stageX/Y，但是当舞台滚动或你的组件隐藏在嵌套的显示容器中时，这些似乎变得毫无用处。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T12:23:28.350

基本上，我认为，您想检查网格组件 mouseX 和 mouseY 属性，这将为您提供相对于该组件的鼠标坐标。然后一点点数学应该可以告诉你你已经结束了什么网格元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T16:05:02.320

假设您的高亮精灵是网格的兄弟，并且它们都是主应用程序的子项，并且您已经在网格中绘制了子精灵（正方形）：您可以将事件侦听器添加到网格的每个正方形精灵。在翻转时，突出显示正方形。然后，您可能不需要使用 grid.localToGlobal(new Point(targetSquare.x, targetSquare.y)) 或 highlightSquare.globalToLocal(grid_point) 执行任何网格或鼠标坐标转换。

# javascript - 我需要做什么才能让 JS3 环境（或至少 couchdb）启动并运行？

> ID：491353
> 
> 赞同：0
> 
> 时间：2009-01-29T12:10:06.350
> 
> 标签：javascript, linux, couchdb

我主要是前端编码员，但我对服务器端编程或命令行并不陌生。无论如何，关于设置服务器和诸如此类的东西，我还有很多东西要学习，所以我想知道是否有人可以帮助我整理一些在（最好是）ubuntu 上设置 CouchDB 的步骤。

这是我的主要目标，但如果可能的话，我也想让“JS3”环境运行起来。[有关更多信息，请参阅此帖子](http://labs.mudynamics.com/2009/01/14/js3/)。

我最挣扎的事情是知道我需要安装哪些包以及如何获取它，以便我可以在本地主机上的浏览器中工作。感谢您能给我的任何指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T08:02:21.480

软件包非常依赖于您使用的操作系统风格。在 Freebsd 上，您可以使用

```
cd /usr/ports/www/helma ; make install clean
cd /usr/ports/databases/couchdb ; make install clean 
```

你的服务器上有所有相关的软件。然后你需要在某个地方托管[jQuery蜜蜂。](http://jquery.com/)Helma 的 Jetty Webserver 可以为您处理。

对于 Ubuntu，我现在读到它带有一个 couchdb 包，你可以这样做

```
sudo apt-get install couchdb 
```

# linux - Enlightment 是否有 KDE 系统托盘小程序？

> ID：491360
> 
> 赞同：0
> 
> 时间：2009-01-29T12:11:50.120
> 
> 标签：linux, usability, opensuse, kde4

Enlightenment DR16 与 openSUSE 11.1 打包在一起，但与 KDE 应用程序一起使用有点痛苦，因为没有明显的方法（在 Enlightenment 站点、google 等上）为需要系统托盘的 KDE 应用程序（例如，ktorrent）提供系统托盘。

有人知道解决这个问题的方法吗？

我没有使用 e 来吸引眼球——我在 2.6GHz Celeron 上运行，而 KDE (4.1) 的性能并不是很出色，所以我正在尝试一些替代方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T06:11:45.480

[Trayer](http://packages.debian.org/unstable/x11/trayer)是一个独立的系统托盘。无论您在什么环境中，它都应该可以工作，包括 e16。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T13:51:49.047

使用[Docker](http://icculus.org/openbox/2/docker/)

我不知道它是否适用于 e16，但它适用于 Openbox，它是一款适用于低端机器的优秀窗口管理器

您是否在“少数选择”中尝试过 openbox？

# oracle - odp.net 追踪

> ID：491373
> 
> 赞同：2
> 
> 时间：2009-01-29T12:19:20.793
> 
> 标签：oracle, odp.net

如何从连接字符串启用 odp.net 客户端中的跟踪？只需添加参数 traceFileName、TraceLevel 和 TraceOption ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-13T18:55:59.223

经过一番研究，我发现ODP.net在11及以上版本可以通过web.config olny进行配置。对于 ODP.Net 的早期版本，唯一的方法是使用 windows 注册表

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T17:25:20.970

你不能。您将需要注册表或 XML 修复程序。

但是您可以在登录后立即发出`ALTER SESSION SET SQL_TRACE=true`，无论是在您的应用程序中还是在`AFTER LOGON`触发器中。

`ODP.NET`完全相同：它查看注册表并执行此语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-24T20:35:34.523

对于那些从谷歌找到这个的人的一些提示：

请注意，跟踪将默认进入 C 驱动器的根目录。对于 Windows 7 及更高版本，这需要管理员权限，否则它会静默失败。因此，要么确保您的应用程序以管理员身份运行，要么您更改文件的路径。

另请注意，如果要跟踪完全托管的 ODP.NET，则需要将设置放在应用程序或 Web 配置文件中，而不是注册表中，并且 TraceLevel 的设置不同（1 到 7）。

最后，在跟踪非托管 ODP.NET 时，请记住对于 32 位 Windows 有一个单独的 WOW 注册表节点。如果您的应用程序是 32 位的，请不要意外将其设置在注册表的 64 位部分下。

# c# - C# - 有人能告诉我为什么以及在哪里应该使用委托吗？

> ID：491374
> 
> 赞同：8
> 
> 时间：2009-01-29T12:19:42.353
> 
> 标签：c#, delegates

我想我将 C# 中委托的概念理解为指向方法的指针，但我找不到任何好的例子来说明在哪里使用它们是个好主意。有哪些例子对于代表来说更优雅/更好，或者不能使用其他方法解决？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-29T12:24:19.393

.NET 1.0 代表：

```
this.myButton.Click += new EventHandler(this.MyMethod); 
```

.NET 2.0 代表：

```
this.myOtherButton.Click += delegate {
    var res = PerformSomeAction();
    if(res > 5)
        PerformSomeOtherAction();
}; 
```

它们看起来非常有用。怎么样：

```
new Thread(new ThreadStart(delegate {
    // do some worker-thread processing
})).Start(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-29T12:23:07.617

我主要使用简单的异步编程。使用委托开始一个方法 Begin... 如果你想开火然后忘记，方法真的很容易。

当接口不可用时，委托也可以*像接口一样使用。*例如，从 COM 类、外部 .Net 类等调用方法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-29T12:39:38.067

你说的代表到底是什么意思？以下是可以使用它们的两种方式：

```
void Foo(Func<int, string> f) {
 //do stuff
 string s = f(42);
 // do more stuff
} 
```

和

```
void Bar() {
 Func<int, string> f = delegate(i) { return i.ToString(); } 
//do stuff
 string s = f(42);
 // do more stuff
} 
```

第二个要点是您可以动态声明新函数，作为委托。这可以在很大程度上被 lambda 表达式所取代，并且在您想要将一小段逻辑 1) 传递给另一个函数或 2) 只是重复执行时很有用。LINQ 就是一个很好的例子。每个 LINQ 函数都将 lambda 表达式作为其参数，指定行为。例如，如果你有一个`List<int> l`then`l.Select(x=>(x.ToString())`将对列表中的每个元素调用 ToString()。我写的 lambda 表达式是作为委托实现的。

第一个案例展示了如何实现 Select。您将委托作为参数，然后在需要时调用它。这允许调用者自定义函数的行为。再次以 Select() 为例，函数本身保证了你传递给它的委托会在列表中的每个元素上被调用，并且每个元素的输出都会被返回。该代表实际*做*什么取决于您。这使它成为一个非常灵活和通用的功能。

当然，它们也用于订阅事件。简而言之，委托允许您引用函数，将它们用作函数调用中的参数，将它们分配给变量以及您喜欢做的任何其他事情。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-29T12:26:20.747

事件是最明显的例子。比较观察者模式是如何在 Java（接口）和 C#（委托）中实现的。

此外，许多新的 C# 3 功能（例如 lambda 表达式）都基于委托，并进一步简化了它们的使用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-29T12:27:26.017

例如在多线程应用程序中。如果您希望多个线程使用某些控制，您应该使用委托。抱歉，代码在 VisualBasic 中。

首先你声明一个委托

```
Private Delegate Sub ButtonInvoke(ByVal enabled As Boolean) 
```

编写一个函数以从多个线程启用/禁用按钮

```
Private Sub enable_button(ByVal enabled As Boolean)
    If Me.ButtonConnect.InvokeRequired Then

        Dim del As New ButtonInvoke(AddressOf enable_button)
        Me.ButtonConnect.Invoke(del, New Object() {enabled})
    Else
        ButtonConnect.Enabled = enabled
    End If

End Sub 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-29T12:27:40.167

我一直将它们与 LINQ 一起使用，尤其是 lambda 表达式，以提供一个函数来评估条件或返回选择。还可以使用它们来提供一个功能，该功能将比较两个项目以进行排序。后者对于默认排序可能合适也可能不合适的通用集合很重要。

```
 var query = collection.Where( c => c.Kind == ChosenKind )
                         .Select( c => new { Name = c.Name, Value = c.Value } )
                         .OrderBy( (a,b) => a.Name.CompareTo( b.Name ) ); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-29T12:29:51.457

委托的好处之一是异步执行。

当您异步调用一个方法时，您不知道它何时完成执行，因此您需要将一个委托传递给该方法，该委托指向另一个方法，该方法将在第一个方法完成执行时调用。在第二种方法中，您可以编写一些代码来通知您执行已完成。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-29T13:30:32.770

**从技术上讲，委托是一种引用类型，用于封装具有特定签名和返回类型的方法**

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-29T12:32:27.350

其他一些评论触及了异步世界......但无论如何我都会发表评论，因为我最喜欢这样做的“味道”已经提到：

```
ThreadPool.QueueUserWorkItem(delegate
{
    // This code will run on it's own thread!
}); 
```

此外，代表的一个重要原因是“回调”。假设我做了一些功能（异步），并且您希望我调用一些方法（例如“AlertWhenDone”）......您可以将“委托”传递给您的方法，如下所示：

```
TimmysSpecialClass.DoSomethingCool(this.AlertWhenDone); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-29T12:35:26.783

除了它们在事件中的角色之外，如果您使用过 winforms 或 asp.net，您可能会熟悉委托，委托对于使类更灵活（例如它们在 LINQ 中的使用方式）很有用。

“查找”事物的灵活性非常普遍。你有一个东西的集合，你想提供一种查找东西的方法。您现在可以允许调用者提供算法，以便他们可以搜索您的集合，但他们认为合适，而不是猜测某人可能想要查找的每种方式。

这是一个简单的代码示例：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Delegates
{
    class Program
    {
        static void Main(string[] args)
        {
            Collection coll = new Collection(5);
            coll[0] = "This";
            coll[1] = "is";
            coll[2] = "a";
            coll[3] = "test";

            var result = coll.Find(x => x == "is");

            Console.WriteLine(result);

            result = coll.Find(x => x.StartsWith("te"));

            Console.WriteLine(result);

    }

}

public class Collection
{
    string[] _Items;

    public delegate bool FindDelegate(string FindParam);

    public Collection(int Size)
    {
        _Items = new string[Size];

    }

    public string this[int i]
    {
        get { return _Items[i]; }
        set { _Items[i] = value; }
    }

    public string Find(FindDelegate findDelegate)
    {
        foreach (string s in _Items)
        {
            if (findDelegate(s))
                return s;
        }
        return null;
    }

}
} 
```

**输出**

是

测试

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-29T12:23:11.097

确实没有什么可以用其他方法解决的，但它们提供了一个更优雅的解决方案。

使用委托，任何函数都可以使用，只要它具有所需的参数。

另一种方法通常是在程序中使用一种自定义构建的事件系统，从而创造额外的工作和更多的区域让错误潜入

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-01-25T09:49:55.873

在处理对数据库的外部调用时使用委托是否有优势？

例如可以编码 A ：

```
static void Main(string[] args) {

           DatabaseCode("test");

}

public void DatabaseCode(string arg) {

           .... code here ...

} 
```

在代码 B 中进行改进：

```
static void Main(string[] args) {

           DatabaseCodeDelegate slave = DatabaseCode;
           slave ("test");

}

public void DatabaseCode(string arg) {

           .... code here ...

}
public delegate void DatabaseCodeDelegate(string arg); 
```

这似乎是主观的，但是一个存在强烈冲突观点的领域？

# c# - ReadOnlyCollection 或 IEnumerable 用于公开成员集合？

> ID：491375
> 
> 赞同：133
> 
> 时间：2009-01-29T12:20:04.550
> 
> 标签：c#, .net, collections, ienumerable, readonly-collection

如果调用代码仅迭代集合，是否有任何理由将内部集合公开为 ReadOnlyCollection 而不是 IEnumerable？

```
class Bar
{
    private ICollection<Foo> foos;

    // Which one is to be preferred?
    public IEnumerable<Foo> Foos { ... }
    public ReadOnlyCollection<Foo> Foos { ... }
}

// Calling code:

foreach (var f in bar.Foos)
    DoSomething(f); 
```

正如我所看到的，IEnumerable 是 ReadOnlyCollection 接口的子集，它不允许用户修改集合。因此，如果 IEnumberable 接口足够了，那么它就是可以使用的接口。这是一种正确的推理方式还是我错过了什么？

谢谢/埃里克

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-01-29T13:32:26.200

**更现代的解决方案**

除非您需要内部集合是可变的，否则您可以使用该[`System.Collections.Immutable`](https://www.nuget.org/packages/System.Collections.Immutable/)包，将您的字段类型更改为不可变集合，然后直接公开它 -`Foo`当然，假设它本身是不可变的。

**更新答案以更直接地解决问题**

> 如果调用代码仅迭代集合，是否有任何理由将内部集合公开为 ReadOnlyCollection 而不是 IEnumerable？

这取决于您对调用代码的信任程度。如果您完全控制将调用此成员的所有内容，并且您*保证*不会使用任何代码：

```
ICollection<Foo> evil = (ICollection<Foo>) bar.Foos;
evil.Add(...); 
```

那么可以肯定的是，如果您直接退回收藏品，不会造成任何伤害。不过，我通常会尝试变得更加偏执。

同样，正如您所说：如果您只*需要* `IEnumerable<T>`，那么为什么要将自己绑在更强大的东西上？

**原始答案**

如果您使用的是 .NET 3.5，则可以通过使用对 Skip 的简单调用来避免制作副本*并避免简单转换：*

```
public IEnumerable<Foo> Foos {
    get { return foos.Skip(0); }
} 
```

（还有很多其他选项可以简单地包装 - 关于`Skip`Select/Where 的好处是没有代表可以为每次迭代毫无意义地执行。）

如果您不使用 .NET 3.5，您可以编写一个非常简单的包装器来做同样的事情：

```
public static IEnumerable<T> Wrapper<T>(IEnumerable<T> source)
{
    foreach (T element in source)
    {
        yield return element;
    }
} 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-01-29T12:32:53.947

如果您只需要遍历集合：

```
foreach (Foo f in bar.Foos) 
```

然后返回**IEnumerable**就足够了。

如果您需要随机访问项目：

```
Foo f = bar.Foos[17]; 
```

然后将其包装在**ReadOnlyCollection**中。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-01-29T12:28:06.313

如果你这样做，那么没有什么能阻止你的调用者将 IEnumerable 转换回 ICollection 然后对其进行修改。ReadOnlyCollection 消除了这种可能性，尽管仍然可以通过反射访问底层的可写集合。如果集合很小，那么解决此问题的一种安全且简单的方法是返回一个副本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-10T05:38:21.973

我尽可能避免使用 ReadOnlyCollection，它实际上比仅使用普通列表要慢得多。看这个例子：

```
List<int> intList = new List<int>();
        //Use a ReadOnlyCollection around the List
        System.Collections.ObjectModel.ReadOnlyCollection<int> mValue = new System.Collections.ObjectModel.ReadOnlyCollection<int>(intList);

        for (int i = 0; i < 100000000; i++)
        {
            intList.Add(i);
        }
        long result = 0;

        //Use normal foreach on the ReadOnlyCollection
        TimeSpan lStart = new TimeSpan(System.DateTime.Now.Ticks);
        foreach (int i in mValue)
            result += i;
        TimeSpan lEnd = new TimeSpan(System.DateTime.Now.Ticks);
        MessageBox.Show("Speed(ms): " + (lEnd.TotalMilliseconds - lStart.TotalMilliseconds).ToString());
        MessageBox.Show("Result: " + result.ToString());

        //use <list>.ForEach
        lStart = new TimeSpan(System.DateTime.Now.Ticks);
        result = 0;
        intList.ForEach(delegate(int i) { result += i; });
        lEnd = new TimeSpan(System.DateTime.Now.Ticks);
        MessageBox.Show("Speed(ms): " + (lEnd.TotalMilliseconds - lStart.TotalMilliseconds).ToString());
        MessageBox.Show("Result: " + result.ToString()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T15:25:37.987

有时您可能想要使用接口，可能是因为您想在单元测试期间模拟集合。请参阅我的[博客条目](http://nicksdotnet.blogspot.com/2009/01/interfacing-readonlycollection.html)，了解如何使用适配器将您自己的接口添加到 ReadonlyCollection。

# c# - 为什么 .NET/C# 不针对尾调用递归进行优化？

> ID：491376
> 
> 赞同：120
> 
> 时间：2009-01-29T12:20:21.227
> 
> 标签：c#, .net, optimization, tail-recursion

我发现[了这个](https://stackoverflow.com/questions/340762/which-languages-support-tail-recursion-optimization)关于哪些语言优化尾递归的问题。为什么 C# 尽可能不优化尾递归？

对于一个具体案例，为什么不将此方法优化为循环（[Visual Studio 2008](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2008) 32 位，如果重要的话）？：

```
private static void Foo(int i)
{
    if (i == 1000000)
        return;

    if (i % 100 == 0)
        Console.WriteLine(i);

    Foo(i+1);
} 
```

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-01-29T12:42:15.690

JIT 编译是在不花费太多时间进行编译阶段（从而显着减慢短期应用程序）与没有进行足够的分析以通过标准提前编译保持应用程序长期竞争力之间的一种棘手的平衡行为.

有趣的是，[NGen](https://en.wikipedia.org/wiki/Native_Image_Generator)编译步骤的目标不是更积极地进行优化。我怀疑这是因为他们根本不希望出现行为取决于 JIT 或 NGen 是否负责机器代码的错误。

[CLR](https://en.wikipedia.org/wiki/Common_Language_Runtime)本身确实支持尾调用优化，但特定于语言的编译器必须知道如何生成相关[操作码](https://docs.microsoft.com/en-us/previous-versions/windows/silverlight/dotnet-windows-silverlight/56c08k0k(v=vs.95)?redirectedfrom=MSDN)，并且 JIT 必须愿意尊重它。 [F# 的](https://en.wikipedia.org/wiki/F_Sharp_(programming_language))fsc 将生成相关的操作码（尽管对于简单的递归，它可能只是将整个事物`while`直接转换为循环）。C# 的 csc 没有。

有关详细信息，请参阅[此博客文章](https://docs.microsoft.com/en-us/archive/blogs/davbr/)（鉴于最近的 JIT 更改，现在很可能已过时）。请注意，4.0 的 CLR 更改[x86、x64 和 ia64 将尊重它](https://docs.microsoft.com/en-us/archive/blogs/clrcodegeneration/tail-call-improvements-in-net-framework-4)。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2009-01-29T12:34:11.213

此[Microsoft Connect 反馈提交](https://web.archive.org/web/20140724090729/http://connect.microsoft.com/VisualStudio/feedback/details/166013/c-compiler-should-optimize-tail-calls)应回答您的问题。它包含微软的官方回应，所以我建议你这样做。

> 谢谢你的建议。在 C# 编译器的开发过程中，我们考虑过在多个点发出尾调用指令。然而，到目前为止，有一些微妙的问题促使我们避免这种情况：1) 在 CLR 中使用 .tail 指令实际上存在不小的开销成本（它不仅仅是一条跳转指令，因为尾调用最终会变成在许多不太严格的环境中，例如对尾调用进行了高度优化的函数式语言运行时环境）。2) 很少有真正的 C# 方法发出尾调用是合法的（其他语言鼓励具有更多尾递归的编码模式，许多严重依赖尾调用优化的人实际上会进行全局重写（例如继续传递转换）以增加尾递归的数量）。3) 部分由于 2)，C# 方法由于本应成功的深度递归而堆栈溢出的情况相当罕见。
> 
> 综上所述，我们继续关注这一点，我们可能会在编译器的未来版本中找到一些发出 .tail 指令有意义的模式。

顺便说一句，正如已经指出的那样，值得注意的是尾递归在 x64 上进行了优化*。*

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2014-04-28T19:05:42.397

C# 没有针对尾调用递归进行优化，因为这就是 F# 的用途！

有关阻止 C# 编译器执行尾调用优化的条件的详细信息，请参阅这篇文章：[JIT CLR 尾调用条件](http://blogs.msdn.com/b/davbr/archive/2007/06/20/tail-call-jit-conditions.aspx)。

**C# 和 F# 之间的互操作性**

C# 和 F# 的互操作性非常好，并且由于 .NET 公共语言运行时 (CLR) 的设计考虑到了这种互操作性，因此每种语言都针对其意图和目的进行了优化。有关显示从 C# 代码调用 F# 代码是多么容易的示例，请参阅从 C# 代码[调用 F# 代码](https://stackoverflow.com/questions/478531/call-f-code-from-c-sharp)；有关从 F# 代码调用 C# 函数的示例，请参阅从 F#[调用 C# 函数](https://stackoverflow.com/questions/6524242/calling-c-sharp-functions-from-f)。

有关委托互操作性，请参阅这篇文章：[F#、C# 和 Visual Basic 之间的委托互操作性](http://support.microsoft.com/kb/2843733)。

**C# 和 F# 之间的理论和实践差异**

这里有一篇文章涵盖了一些差异并解释了 C# 和 F# 之间尾调用递归的设计差异：[Generating Tail-Call Opcode in C# and F#](https://stackoverflow.com/questions/15864670/generate-tail-call-opcode)。

这是一篇文章，其中包含 C#、F# 和 C++\CLI 中的一些示例：C#、F# 和 C++\CLI[中的尾递归冒险](http://blogs.msdn.com/b/jomo_fisher/archive/2007/09/19/adventures-in-f-tail-recursion-in-three-languages.aspx)

主要的理论区别在于 C# 是用循环设计的，而 F# 是根据 Lambda 演算原理设计的。有关 Lambda 演算原理的非常好的书籍，请参阅这本免费书籍：[Abelson、Sussman 和 Sussman 的计算机程序的结构和解释](http://mitpress.mit.edu/sicp/)。

有关 F# 中尾调用的非常好的介绍性文章，请参阅这篇文章：[F# 中尾调用的详细介绍](http://blogs.msdn.com/b/fsharpteam/archive/2011/07/08/tail-calls-in-fsharp.aspx)。最后，这里有一篇文章介绍了非尾递归和尾调用递归之间的区别（在 F# 中）：[Tail-recursion vs. non-tail recursion in F sharp](https://stackoverflow.com/questions/3248091/f-tail-recursive-function-example)。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-29T12:34:47.203

最近有人告诉我，64 位的 C# 编译器确实优化了尾递归。

C# 也实现了这一点。之所以不总是应用它，是因为用于应用尾递归的规则非常严格。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-23T11:52:11.863

您可以将[蹦床技术](https://en.wikipedia.org/wiki/Trampoline_(computing)#High-level_programming)用于 C#（或 Java）中的尾递归函数。但是，更好的解决方案（如果您只关心堆栈利用率）是使用[这个小帮助](http://qualityofdata.com/2012/02/03/how-to-run-most-of-the-recursive-functions-iteratively/)方法来包装相同递归函数的部分并使其迭代，同时保持函数可读。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-12-21T10:39:24.177

正如其他答案所提到的，CLR 确实支持尾调用优化，而且它似乎在历史上处于逐步改进之中。但是在 C# 中支持它在`Proposal`git 存储库中有一个未解决的问题，用于设计 C# 编程语言[Support tail recursion #2544](https://github.com/dotnet/csharplang/issues/2544)。

你可以在那里找到一些有用的细节和信息。例如@jaykrell 提到

> 让我给出我所知道的。
> 
> 有时尾声是一种双赢的表现。它可以节省CPU。jmp 比 call/ret 便宜它可以节省堆栈。接触更少的堆栈有助于更好的局部性。
> 
> 有时尾调用是性能损失，堆栈获胜。CLR 有一个复杂的机制，其中向被调用者传递的参数多于调用者接收到的参数。我的意思是更多的参数堆栈空间。这很慢。但它节省了堆栈。它只会用尾巴做到这一点。字首。
> 
> 如果调用者参数的堆栈比被调用者参数大，这通常是一个非常简单的双赢转换。可能存在诸如参数位置从托管变为整数/浮点数以及生成精确的 StackMaps 等因素。
> 
> 现在，还有另一个角度，即需要消除尾调用的算法，以便能够处理具有固定/小堆栈的任意大数据。这与性能无关，而与运行能力有关。

另外让我提一下（作为额外信息），当我们使用命名空间中的表达式类生成编译的 lambda 时`System.Linq.Expressions`，有一个名为“tailCall”的参数，正如其评论中所解释的那样

> 一个布尔值，指示在编译创建的表达式时是否应用尾调用优化。

我还没有尝试过，我不确定它对您的问题有何帮助，但可能有人可以尝试它并且在某些情况下可能有用：

```
 var myFuncExpression = System.Linq.Expressions.Expression.Lambda<Func< … >>(body: … , tailCall: true, parameters: … );

var myFunc =  myFuncExpression.Compile(); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-11-11T21:03:05.033

今天我有一个惊喜:-)

我正在为即将到来的 C# 递归课程复习我的教材。似乎最终尾调用优化已进入 C#。

我正在使用带有 LINQPad 6 的 NET5（已激活优化）。

这是我使用的尾部调用可优化阶乘函数：

```
long Factorial(int n, long acc = 1)
{
    if (n <= 1)
        return acc;
    return Factorial(n - 1, n * acc);
} 
```

这是为此函数生成的 X64 汇编代码：

[![汇编代码](https://i.stack.imgur.com/BVsjz.png)](https://i.stack.imgur.com/BVsjz.png)

看，没有`call`，只有一个`jmp`。该功能也进行了积极优化（无堆栈框架设置/拆卸）。哦是的！

# python - 我应该使用 Perl 还是 Python 进行网络监控？

> ID：491380
> 
> 赞同：3
> 
> 时间：2009-01-29T12:22:23.580
> 
> 标签：python, perl, networking, scripting-language

我想在网络前端完成一些工作，ping 局域网上的许多计算机并检索有关响应时间的数据。使用哪个最有用和最有效率：Perl 还是 Python？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-29T12:44:42.147

我同意您使用哪种编程语言是非常主观的 - 基本上我宁愿尽可能快速有效地完成工作，使其可支持 - 所以这取决于您的基础架构......

我可以建议你看看[Nagios](http://www.nagios.org/)而不是自己重新发明轮子吗？

虽然 Nagios 在配置方面可能需要更大的学习曲线，但从长远来看这是值得的，如果您找不到适合您要求的插件，那么编写自己的插件很容易。[Joel Spolsky](http://www.joelonsoftware.com/items/2008/01/22.html)就此写了一篇有趣的文章。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-29T18:16:14.050

好吧，我同时使用 Perl 和 Python，我的日常工作是支持网络监控软件。大多数导入点已经涵盖，但我将在这里巩固/重申：

1.  不要重新发明轮子 - 您可以使用数十种网络监控解决方案来执行 ping 测试和分析收集的数据。参见例如

    *   [**纳吉奥斯**](http://www.nagios.org/)
    *   [**泽诺斯**](http://www.zenoss.com/)
    *   [**开放式网络管理系统**](http://www.opennms.org/index.php/Main_Page)
    *   [**PyNMS**](http://keith.dart.googlepages.com/pynmshome)
2.  如果你坚持自己做，这可以在 Perl 或 Python 中完成——使用你最了解的那个。如果您打算解析大量文本，那么在 Perl 中执行此“快速而肮脏”的操作会比在 Python 中更容易。两者都可以，但 Python 需要 OOP 方法，而且它不像 Perl 的内联正则表达式语法那么简单。

3.  使用库——很多很多人在你之前已经完成了这项任务，所以四处寻找合适的库，比如 Perl 中的 Net::Ping 或 Python 中的[icmplib](http://code.activestate.com/recipes/409689/)或[这个 ping.py](http://svn.pylucid.net/pylucid/CodeSnippets/ping.py)代码。

4.  使用线程或异步 ping - 否则 ping 将永远持续，例如查看这个使用线程同时运行 ping 的[配方。](http://www.wellho.net/solutions/python-python-threads-a-first-example.html)这在 Python 中使用任何一种方法都特别容易做到，因此这是 Python 与 IMO 一起使用比使用 Perl 更容易的地方。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-29T12:29:37.247

使用 Perl。

您将可以访问一个漂亮的 Ping 对象[Net::Ping](http://search.cpan.org/perldoc?Net::Ping)并将结果存储在数据库中非常容易。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-29T12:27:35.660

任何一个都应该工作得很好。如果您没有任何经验，请掷硬币。没有一种语言天生就具有生产力。语言让人们变得富有成效。不同的人会从不同的语言中获得不同的好处。

不过，一般来说，当您知道自己的特定任务并需要选择工具时，请寻找可以让您的生活更轻松的库。对于 Perl，请查看[综合 Perl 存档网络](http://search.cpan.org)。您可能需要的每个网络事物都有模块。

Python 可能有非常相似的工具和库；我只是不知道它们是什么。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-29T12:28:09.450

我比 Python 更了解 Perl，所以我会选择 Perl。也就是说，我认为在低级任务（例如在网络上 ping 计算机等）它们是相当等价的。Python 可能有更好的面向对象的支持，但是对于脚本（这恰好是你需要的），Perl 的力量是非常明显的。[您在CPAN](http://www.cpan.org)上找到的大量测试模块（其中一些甚至是面向对象的）通常可以满足您的所有需求，如果您适当地使用它们，它们甚至可以很好地扩展。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-30T23:07:12.480

我不了解 Python，所以我无法评论它提供了什么，我同意那些建议 Nagios 或其他现有系统的人。

但是，如果您决定使用 Perl 推出自己的系统，请考虑使用[POE](http://search.cpan.org/~rcaputo/POE-1.003/lib/POE.pm)。POE 是一种协作式多任务处理和网络框架。

POE 有一个陡峭的学习曲线。但是你的付出很快就会得到回报。POE 将为构建提供坚实的基础。您需要的大部分[客户端代码已经在 CPAN 上可用。](http://search.cpan.org/search?query=POE+Component&mode=all)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T18:01:17.810

无论您更了解或更舒适地使用哪个。他们都可以完成这项工作并且做得很好，所以这是您的偏好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-25T09:47:35.723

现在我已经尝试了使用各种 TAP 库（主要是 bash+netcat+curl 和 perl）为网络服务创建一些简单单元测试的方法。优点是您编写了一个可用于单元测试和网络测试的脚本。通过 TAP::Harness::HTML 显示鸽子。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-29T13:41:07.943

我会说，如果您需要一些快速而肮脏的东西，并且在今天下午之前可以启动并运行，那么 perl 可能是更好的语言。

但是，对于开发易于维护和扩展并且可以随着时间的推移构建的可靠应用程序，我会使用 python。

这当然是假设您或多或少地了解两种语言。

# iphone - iPhone应用程序在后台

> ID：491381
> 
> 赞同：3
> 
> 时间：2009-01-29T12:22:49.863
> 
> 标签：iphone, objective-c

有什么方法可以从关闭的 iPhone 应用程序中启动声音或弹出消息。就像“接收短信”一样

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T12:28:38.823

我不相信。Apple 已声明任何第三方应用程序都不能在后台运行（即使他们的一些应用程序会这样做）。这就是为什么去年夏天有很多关于“推送通知”的事情（不幸的是，此后一直没有发生）——这将允许应用程序从服务器发送一些数据，然后适当地响应它。

如果您为越狱的 iPhone 编写应用程序，您可能能够完成此操作，但只有那些已越狱手机的用户才能安装和使用您的应用程序。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-09-01T11:33:47.967

是的，在最初回答问题后，这实际上已经改变了。

目前至少有两种方法可以让关闭的应用程序播放声音或弹出窗口。

1.  应用程序可以在运行时注册本地通知，即使应用程序关闭，将来也会调用该通知。通知将显示一个弹出窗口，并可选择播放声音或在应用程序图标上设置徽章。实现这一点很容易：

    ```
     id localNotif = [[NSClassFromString(@"UILocalNotification") alloc] init];
        if (!localNotif) {
            return;
        }

        [localNotif setTimeZone:[NSTimeZone defaultTimeZone]];
        [localNotif setAlertBody:NSLocalizedString(@"Hello!",nil)];
        [localNotif setAlertAction:NSLocalizedString(@"Hello", nil)];
        [localNotif setSoundName:UILocalNotificationDefaultSoundName];
        [localNotif setFireDate:[[NSDate date] addTimeInterval:(60*60)]];           
        [localNotif setFireDate:[[NSDate date] addTimeInterval:(24*60*60)]];
        [[UIApplication sharedApplication] scheduleLocalNotification:localNotif];
        [localNotif release]; 
    ```

2.  应用程序（在用户许可的情况下）可以向远程服务器（您的或服务提供商）注册自己，以接收您（通过 Apple 的系统）发送给它的推送通知。收到后，应用程序将选择性地显示弹出窗口、播放声音和/或更改应用程序图标上的徽章。Apple 文档中有用于实现 iPhone 端的示例代码，还有一些用于服务器端的开源项目。您可以通过使用 Urban Airship 之类的服务来绕过必须实现自己的服务器端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T13:53:11.710

Andy 是对的，但 Apple 承诺也会为第 3 方启用他们的推送系统。所以，我认为你可以等到他们发布它......虽然不知道什么时候。

# sql - Reporting Services 在哪里存储其日志文件

> ID：491389
> 
> 赞同：23
> 
> 时间：2009-01-29T12:24:06.710
> 
> 标签：sql, sql-server, reporting-services

最相关的 google 结果似乎表明，为了访问日志，我们必须将我们自己的日志表分解到数据库并让[Reporting Services 写入它](http://technet.microsoft.com/en-us/library/ms157403.aspx)。

简单地说：Reporting Services 肯定必须有纯文本日志文件吗？如果是，这些文件存储在哪里？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-29T12:35:50.027

假设您将 SQL 2008 安装到默认位置：C:\Program Files\Microsoft SQL Server\MSRS10.MSSQLSERVER\Reporting Services\LogFiles

# c# - 在.NET（Winforms）中的表单中居中控件？

> ID：491399
> 
> 赞同：147
> 
> 时间：2009-01-29T12:27:01.917
> 
> 标签：c#, .net, winforms, center-align

我正在尝试在表单中居中固定大小的控件。

出于兴趣，有没有一种不愚蠢的方式来做到这一点？我真正想要的是类似于 text-align css 属性的东西。

目前，我正在将周围窗体的填充属性设置为合适的大小，并将控件的 Dock 属性设置为填充。

* * *

## 回答 #1

> 赞同：268
> 
> 时间：2009-01-29T12:34:16.020

您可以使用**anchors**来实现这一点。或者更准确地说，**不使用它们**。

控件默认锚定在表单的左上角，这意味着当表单大小发生变化时，它们与表单左上角的距离将保持不变。如果将控件锚点更改为左下角，则在调整窗体大小时，控件将与窗体的底部和左侧保持相同的距离。

如果控件已经居中，则在调整大小时关闭某个方向的锚点将使控件保持居中。通常，*未锚定的控件保持其与对话框成比例的位置。例如，如果您将控件放置在对话框宽度的 X=75% 处并关闭左/右锚点，则控件将保持其中心在对话框宽度的 X=75% 处。*

**注意：** 通过 VS2015 中的属性窗口关闭锚定可能需要输入 None（而不是默认的 Top,Left）

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2009-01-29T12:36:55.750

```
myControl.Left = (this.ClientSize.Width - myControl.Width) / 2 ;
myControl.Top = (this.ClientSize.Height - myControl.Height) / 2; 
```

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2009-01-29T13:12:16.787

由于您没有说明表单是否可以调整大小，因此如果您不关心调整大小，则有一种简单的方法（如果您确实关心，请使用 Mitch Wheats 解决方案）：

选择控件 -> 格式（菜单选项） -> 在窗口中居中 -> 水平或垂直

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-07-13T18:06:13.500

我找到了一个很好的方法来做到这一点，它可以与多个控件一起使用。添加一个包含 3 列的 TableLayout。使中心列具有绝对大小（无论您需要多少空间）。将两个外部列设置为 100%。将面板添加到中心列并添加您需要的任何控件并将它们放置在您想要的位置。该中心面板现在将在您的表单中保持居中。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-09-23T07:52:57.877

要在其他容器中的面板 o 中居中按钮，请按照以下步骤操作：

1.  在设计时设置位置
2.  转到按钮的属性**锚**并将此值设置为下图

[![在此处输入图像描述](https://i.stack.imgur.com/nVlOm.jpg)](https://i.stack.imgur.com/nVlOm.jpg)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-18T16:05:40.997

您可以将想要居中的控件放在 Panel 中，并将左右填充值设置为大于默认值。只要它们相等并且您的控件固定在面板的两侧，那么它将显示在该面板的中心。然后，您可以根据需要将容器面板锚定到其父级。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-02-05T19:50:25.880

**此外，如果要将其对齐到另一个控件的中心：**

```
//The "ctrlParent" is the one on which you want to align "ctrlToCenter".
//"ctrlParent" can be your "form name" or any other control such as "grid name" and etc.
ctrlToCenter.Parent = ctrlParent;

ctrlToCenter.Left = (ctrlToCenter.Parent.Width - ctrlToCenter.Width) / 2;
ctrlToCenter.Top = (ctrlToCenter.Parent.Height - ctrlToCenter.Height) / 2; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T12:37:05.703

它涉及目视它（我想你可以拿出一个计算器并计算），但只需在表单上插入所述控件，然后删除任何锚定（锚点 = 无）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-12-27T20:49:26.803

您可以将所有控件放在面板上，然后编写代码将面板移动到表单的中心。

```
panelMain.Location = 
    new Point(ClientSize.Width / 2 - panelMain.Size.Width / 2, 
              ClientSize.Height / 2 - panelMain.Size.Height / 2);

panelMain.Anchor = AnchorStyles.None; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-07-08T14:31:28.420

为了使控件居中，即使窗体或父控件被调整大小。

1.  设置父元素的以下属性*（可以通过属性窗口设置*）：

```
 parentControl.AutoSize = true;
    parentControl.AutoSizeMode = System.Windows.Forms.AutoSizeMode.GrowAndShrink; 
```

2.  将此代码放在窗体或父控件的 Resize 事件中*（如果该控件位于另一个控件内）*。

```
 controlToCenter.Left = (parentControl.Width- controlToCenter.Width) / 2;
    controlToCenter.Top = (parentControl.Height - controlToCenter.Height) / 2; 
```

3.  如果父控件停靠在窗体上，则添加这行代码。

```
 //adjust this based on the layout of your form
       parentControl.Height = this.ClientSize.Height; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-01T10:51:07.100

所以，我目前正在研究分页控件，我想出了以下方法来实现以下结果。

[![例子](https://i.stack.imgur.com/R4F8k.png)](https://i.stack.imgur.com/R4F8k.png)

*   将 PanelLayout 添加到您的容器（例如表单或用户控件）
*   设置 PanelLayout 属性：
    *   码头：底部（或顶部）
    *   自动尺寸：假

这将使 PanelLayout 水平居中。现在，在您的代码隐藏中，执行以下操作：

```
 public MyConstructor()
    {
        InitializeComponent();

        for (var i = 0; i<10; i++)
        {
            AddButton(i);
        }
    }

    void AddButton(int i)
    {
        var btn = new Button();
        btn.Width = 30;
        btn.Height = 26;
        btn.Text = i.ToString();
        this.flowLayoutPanel1.Controls.Add(btn);
        btn.Anchor = AnchorStyles.None;
    } 
```

然而，有一个ceveat。如果我的表单太小（水平），按钮将“消失”在视口之外。就我而言，这不是问题，但您可以通过编写侦听 Resize 事件的代码并根据视口宽度删除元素（按钮）来解决这个问题。

# python - 你能推荐一个可以接受 WS-Attachments 的 Python SOAP 客户端吗？

> ID：491404
> 
> 赞同：3
> 
> 时间：2009-01-29T12:27:47.750
> 
> 标签：python, soap

我读过关于[Suds](https://fedorahosted.org/suds/)和[ZSI](http://pywebsvcs.sourceforge.net/)的混合评论——这两个 Python SOAP 库。但是，我不清楚它们中的任何一个是否可以支持 WS-Attachments。我更喜欢使用 Suds（看起来更简单），但我会选择适合我需要的任何库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T14:33:38.967

对于您的要求，我不得不推荐 ZSI。从其文档中，

> 它还可用于使用带有附件的 SOAP 消息构建应用程序。

他们的网站不如 Suds 漂亮，但该软件包包含有前途的文档。

SOAPpy 支持其 TODO 列表中的附件。Suds 没有在任何地方提到“附件”这个词。如果您需要附件并且不想自己实现它们，那么 ZSI 是您的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T14:49:03.563

我相信[soaplib](http://trac.optio.webfactional.com/)可以处理附件。我只是不确定它与 WS-Attachments 的兼容性到底如何，因为它们不会大肆宣传它。

这是一个示例客户端，用他们的话来说，它允许“多部分 mime 有效负载”：

[helloworld_attach.py](http://trac.optio.webfactional.com/browser/soaplib/trunk/examples/helloworld_attach.py)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T22:50:52.130

根据我的经验，Suds 是唯一真正有效的 Python 包。我没有使用附件。

# f# - 是否有任何支持工具，如 F# 的 coderush 或 resharper？

> ID：491415
> 
> 赞同：28
> 
> 时间：2009-01-29T12:32:07.927
> 
> 标签：f#

是否有任何支持工具，如 F# 的 coderush 或 resharper？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-05-08T19:54:23.007

在 Visual Studio 库中发布的 FSharpRefactor 预览版。

[http://visualstudiogallery.msdn.microsoft.com/339cbae9-911d-4f99-9033-3c3564676f45](http://visualstudiogallery.msdn.microsoft.com/339cbae9-911d-4f99-9033-3c3564676f45)

[http://www.youtube.com/watch?v=T6-YjUULNCA/](http://www.youtube.com/watch?v=T6-YjUULNCA/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-01-11T10:48:19.687

[F#](http://fsharprefactor.codeplex.com/)在 CodePlex 上重构开源项目（Apache 许可）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-08-03T10:21:28.330

查看开源[Visual F# Power Tools](http://fsprojects.github.io/VisualFSharpPowerTools/)项目。他们进行了重命名重构、一些代码生成内容（例如记录存根生成）、未使用的声明变灰以及其他一些内容。他们目前的发展速度非常快，并且一直在添加许多新功能。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-01-01T21:06:36.307

努力通过外部插件（本身用 F# 编写）在 ReSharper 中支持 F#。[您可以在此处](http://activemesa.com/fsharper)找到初步信息。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-05-09T23:55:13.677

FSharpRefactor 0.1（预览版）在 Visual Studio Gallery 上发布。

[http://visualstudiogallery.msdn.microsoft.com/339cbae9-911d-4f99-9033-3c3564676f45?SRC=Home](http://visualstudiogallery.msdn.microsoft.com/339cbae9-911d-4f99-9033-3c3564676f45?SRC=Home)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T12:35:32.367

还没有，据我所知。我也在寻找类似没有成功的东西。我怀疑一旦 F# 成为 VS2010 的组成部分，或者更早一点，这样的工具最终会出现。

就 ReSharper 而言，您可能想给 JetBrains 发一封简短的电子邮件，了解这些人是否有任何有关 F# 的计划会很有趣。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T12:53:01.020

由于在 f# 中的推动是朝向轻模式，因此可能的重新格式化可能是有限的，并且难以实施。

通常重新格式化会获取结构信息并使用它来创建文本位置。在#light 的情况下，文本位置（至少缩进）*是*结构。因此，任何重新格式化充其量只能对符号间的间距进行排序，自己做起来几乎没有繁重的工作。

因此，至少在与 IDE 进行“适当”集成之前，我不会期待它的商业产品（我不认为当前的 CTP 在这方面是合适的，因为它存在几个突出的错误，这些错误将在 2008 年修复）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-05T07:33:55.347

CodeRush 在 F# 编辑器中工作。至少有一些代码帮助和代码模板。但是代码模板尚未定义（您必须创建自己的）。

# asp.net - 如何通过 Javascript 选择 TreeNode？

> ID：491417
> 
> 赞同：0
> 
> 时间：2009-01-29T12:32:18.973
> 
> 标签：asp.net, javascript, ajax

我有一个显示分层数据的 TreeView，当我选择一个 TreeNode 时，我生成了一系列链接，这些链接映射了从选定节点到根节点的路径

说：根节点 --> ChildNode --> SelectedNode

我需要的是，在单击这些链接中的任何一个时，在 TreeView 中选择所需的节点？

我知道选择 TreeNode 是通过 ClientSide 使用以下代码完成的：

```
javascript:__doPostBack(TreeView.ClientID,TreeNodeValuePath) 
```

和

```
TreeView_SelectNode(TreeView.ClientID_Data, this,TreeNode.ClientID) 
```

前任：

```
 <a style="border-style: none; font-size: 1em;" id="tvMenut1" title="Created On: 1/28/2009 9:50:06 AM" onclick="TreeView_SelectNode(tvMenu_Data, this,'tvMenut1');" href="javascript:__doPostBack('tvMenu','s1\\720,63')" class="tvMenu_0 treenodeParent tvMenu_3">
Etravel2000 
```

我的问题是获取 TreeNode.ClientID？

有什么建议吗？仅供参考：此页面是启用 AJAX 的页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T02:12:01.687

TreeNode.ClientID 作为 int 的 ASP.Net 控件 ClientID？

如果是这样，请将其放在您尝试传递它的任何位置：<%= TreeNode.ClientID %>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T12:20:38.277

TreeNode 对象没有 TreeNode.ClinetID 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T14:59:14.367

您可以使用以下方法获取 TreeNode 的 ClientID。您可以更改将用于获取基于它的节点的参数。

```
 function GetTreeNodeID(nodeTooltip)
    {
        var tree = document.getElementById(TreeView.ClientID); // Change TreeView ClientID.
        var treeLink =  tree.getElementsByTagName('A');    

        for(var element in treeLink)
            if((nodeTooltip == treeLink[element].title) && (treeLink[element].title != ""))                      
                return treeLink[element].id;
    } 
```

然后对 TreeView 中的每个 TreeNode 使用此代码。

```
spanPath.InnerHtml += "<a href=\"javascript:__doPostBack('tvMenu','" + targetNode.ValuePath + "')\" onclick=\"TreeView_SelectNode(tvMenu_Data, this, GetTreeNodeID('" + targetNode.ToolTip + "'));\">" + targetNode.Text + "</a>&nbsp;&nbsp;-->&nbsp;&nbsp;"; 
```

当您从 spanPath 中选择一个节点时，它将在 TreeView 中被选中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-26T07:26:31.557

它有助于从客户端获取节点 ID。

[http://pushpontech.wordpress.com/2007/06/14/getting-treenode-values-on-the-client-side-with-javascript](http://pushpontech.wordpress.com/2007/06/14/getting-treenode-values-on-the-client-side-with-javascript)

# visual-studio - 如何在用户注销时阻止 cl.exe 终止？

> ID：491420
> 
> 赞同：1
> 
> 时间：2009-01-29T12:32:55.850
> 
> 标签：visual-studio, build-automation, cruisecontrol.net

[我们有一个自动构建服务器，它使用 Visual Studio 2005 和CruiseControl.NET](http://ccnet.thoughtworks.com/)（在 Windows XP x64 上）生成构建。通常没有人登录系统，但有时我们必须通过远程桌面登录才能执行维护。

我们注意到，如果`cl.exe`在我们从远程桌面注销的那一刻正在运行（Microsoft 的 C++ 编译器），那么`cl.exe`将终止并显示错误结果 4：

> 项目：错误 PRJ0002：从“C:\Program Files (x86)\Microsoft Visual Studio 8\VC\bin\cl.exe”返回错误结果 4。

这显然会导致当前构建失败并显示一条非常神秘的消息。**有谁知道如何防止这种情况发生？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T13:05:51.713

您是否尝试在其他一些非管理员帐户下运行 ccnet 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-15T08:48:17.477

注意：在搜索`error PRJ0002 : Error result 4 returned from ... cl.exe`实际含义时，我偶然发现了这个问题。

我可以提供以下信息：

这发生在我的自动构建的 Windows XP（32 位）测试盒上，并且构建运行肯定是在与我注销的用户*不同的用户帐户下运行的。*

但是，我*知道*我们的生产构建服务器在注销时没有问题，但是这些服务器分别运行 Win 2003 Server 和 Win 2008R2 Server *。**（在那里，如果用于运行构建的同一*用户注销，我只会遇到问题，但我们可以轻松避免这种情况。）

**所以我*怀疑*这个问题不会出现在*Windows Server*操作系统上，而只会出现在 Win XP 上。**（不能对Win7发表任何意见。）

# java - eclipse.ini 文件中 -vm 值的默认值

> ID：491421
> 
> 赞同：2
> 
> 时间：2009-01-29T12:32:59.110
> 
> 标签：java, eclipse

eclipse.ini 文件中 -vm 的默认值是多少？如果我不设置这个值，系统会在哪里寻找这个值。谢谢！。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T12:36:35.500

引用[http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/misc/launcher.html](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/misc/launcher.html)

> 未指定 -vm
> 
> 当没有指定-vm 时，启动器首先在eclipse 根目录的jre 目录中查找虚拟机，然后在搜索路径中查找。如果在任一位置找到 java，则启动器会查找相对于该 java 可执行文件的 jvm 共享库（Windows 上的 jvm.dll，*nix 平台上的 libjvm.so）。
> 
> *   如果找到 jvm 共享库，则启动器会加载它并使用 JNI 调用 API 来启动 vm。
> *   如果没有找到 jvm 共享库，则启动器执行 java 启动器以在新进程中启动 vm。

# c# - 如何获取特定属性的 PropertyInfo？

> ID：491429
> 
> 赞同：88
> 
> 时间：2009-01-29T12:34:57.080
> 
> 标签：c#, reflection

我想获取特定属性的 PropertyInfo。我可以使用：

```
foreach(PropertyInfo p in typeof(MyObject).GetProperties())
{
    if ( p.Name == "MyProperty") { return p }
} 
```

但是必须有一种方法可以做类似的事情

```
typeof(MyProperty) as PropertyInfo 
```

有没有？还是我坚持进行类型不安全的字符串比较？

干杯。

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2009-01-29T12:50:47.267

有一种 .NET 3.5 方式与 lambdas/`Expression`不使用字符串...

```
using System;
using System.Linq.Expressions;
using System.Reflection;

class Foo
{
    public string Bar { get; set; }
}
static class Program
{
    static void Main()
    {
        PropertyInfo prop = PropertyHelper<Foo>.GetProperty(x => x.Bar);
    }
}
public static class PropertyHelper<T>
{
    public static PropertyInfo GetProperty<TValue>(
        Expression<Func<T, TValue>> selector)
    {
        Expression body = selector;
        if (body is LambdaExpression)
        {
            body = ((LambdaExpression)body).Body;
        }
        switch (body.NodeType)
        {
            case ExpressionType.MemberAccess:
                return (PropertyInfo)((MemberExpression)body).Member;
            default:
                throw new InvalidOperationException();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2015-12-17T16:37:51.540

您可以使用新的`nameof()`运算符，它是 C# 6 的一部分，在 Visual Studio 2015 中可用。更多信息[在这里](https://msdn.microsoft.com/en-us/library/dn986596.aspx)。

对于您的示例，您将使用：

```
PropertyInfo result = typeof(MyObject).GetProperty(nameof(MyObject.MyProperty)); 
```

编译器将转换`nameof(MyObject.MyProperty)`为字符串“MyProperty”，但您可以获得能够重构属性名称而无需记住更改字符串的好处，因为 Visual Studio、ReSharper 等知道如何重构`nameof()`值。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-29T12:40:19.597

你可以这样做：

```
typeof(MyObject).GetProperty("MyProperty") 
```

但是，由于 C# 没有“符号”类型，因此没有什么可以帮助您避免使用字符串。顺便说一句，你为什么称这种类型为不安全类型？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T12:40:41.920

反射用于运行时类型评估。因此，您的字符串常量无法在编译时进行验证。

# ruby-on-rails - Ruby/Rails 中 PHP 的 print_r 是否有等价物？

> ID：491435
> 
> 赞同：22
> 
> 时间：2009-01-29T12:36:09.137
> 
> 标签：ruby-on-rails, ruby

在 PHP 中，您可以执行以下操作：

`print_r($var)`或者`vardump($var)`

它打印有关变量的“人类可读”信息。

Ruby/Rails 中是否有等效的功能/助手？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-29T13:04:30.747

在 Rails 模板中，您可以执行

```
<%= debug an_object %> 
```

它会做很好的 HTML PRE 输出。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-29T12:47:57.117

尝试使用 pp。您需要在脚本中使用它（如果您的 .irbc 还没有这样做，则需要在 irb 中）：

```
require 'pp' 
```

然后你可以'PrettyPrint'一个对象：

```
pp object 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-29T12:53:55.573

而不是要求'pp'和使用pp，你可以简单地做

```
p object 
```

测试示例

```
require 'pp'

class A
  def initialize
    @a = 'somevar'
    @b = [1,2,3]
    @c = {'var' => 'val'}
  end
end

a = A.new
pp a # Gives -> #<A:0x2c6d048 @a="somevar", @b=[1, 2, 3], @c={"var"=>"val"}>
p a # Gives -> #<A:0x2c6d048 @a="somevar", @b=[1, 2, 3], @c={"var"=>"val"}>. No need to require 'pp' 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-29T12:53:16.370

有`inspect`帮助的方法。有时`to_s`在对象上调用方法会有所帮助（to_s 返回对象的字符串表示形式）。您还可以查询`methods`、`local_variables`、`class_variables`、`instance_variables`和。`constants``global_variables`

```
p ['Hello',"G'day",'Bonjour','Hola'].inspect
# >> "[\"Hello\", \"G'day\", \"Bonjour\", \"Hola\"]"

p ['Hello',"G'day",'Bonjour','Hola'].to_s
# >> "HelloG'dayBonjourHola"

p Array.new.methods
# >> ["select", "[]=", "inspect", "compact"...]

monkey = 'baboon'
p local_variables
# >> ["monkey"]

class Something
  def initialize
    @x, @y = 'foo', 'bar'
    @@class_variable = 'gorilla'
  end
end

p Something.class_variables
# >> ["@@class_variable"]

s = Something.new
p s.instance_variables
# >> ["@x", "@y"]

p IO.constants
# >> ["TRUNC", "SEEK_END", "LOCK_SH"...]

p global_variables
# >> ["$-d", "$\"", "$$", "$<", "$_", "$-K"...] 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-01-18T04:48:11.357

我知道这是一篇旧文章，但它是 Google 在搜索“Ruby 等效于 PHP print_r”时弹出的第一件事。我在命令行模式下使用 Ruby，实际上并没有一个很好的等价物。“pp”对于相当简单的结构是可以的，但是一旦您开始将数组中的哈希嵌套在更多数组中的哈希中，它就会很快变成混乱。由于我还没有找到一个很好的 print_r 仿真，所以我自己写了一个。这对我的目的来说已经足够了，不会太复杂，我想我会分享它来避免其他人头疼。将输出与[真正的 PHP print_r进行比较](http://us3.php.net/manual/en/function.print-r.php)

```
def print_r(inHash, *indent)
    @indent = indent.join
    if (inHash.class.to_s == "Hash") then
        print "Hash\n#{@indent}(\n"
        inHash.each { |key, value|
            if (value.class.to_s =~ /Hash/) || (value.class.to_s =~ /Array/) then
                print "#{@indent}    [#{key}] => "
                self.print_r(value, "#{@indent}        ")
            else
                puts "#{@indent}    [#{key}] => #{value}"
            end
        }
        puts "#{@indent})\n"
    elsif (inHash.class.to_s == "Array") then
        print "Array\n#{@indent}(\n"
        inHash.each_with_index { |value,index|
            if (value.class.to_s == "Hash") || (value.class.to_s == "Array") then
                print "#{@indent}    [#{index}] => "
                self.print_r(value, "#{@indent}        ")
            else
                puts "#{@indent}    [#{index}] => #{value}"
            end
        }
        puts "#{@indent})\n"
    end
    #   Pop last indent off
    8.times {@indent.chop!}
end 
```

这是一个示例（故意弄乱以显示 PHP print_r 为何如此出色）：

```
 carTools =  [ "Socket Set", "Combination Wrenches", "Oil Filter puller", "Brake Compressor" ]
    houseTools =[ "Circular Saw", "Miter Saw", "Drill" ]
    garageItems = Hash["Car1" => "Ford Mustang", "Car2" => "Honda Civic", "Bike1" => "IronHorse"]
    garageItems["Tools"] = Hash["Car Tools" => carTools, "House Tools" => houseTools]
    constructionSupplies = Hash["Plywood" => ["3/4\" T&G Plywood Sheets", "1/2\" Plywood Sheets"],
                                "Boards" => ["2x4s", "2x6s", "Engineered I-Joists"],
                                "Drywall" => ["4x8 1/2\" Sheetrock", "Mesh tape", "Paper tape", "Joint compount"]]
    carParts = Hash["Mustang" => ["Clutch", "Transmission", "3.55 Ring & Pinion Gears", "Differential", "30# Injectors", "Pro-M 77mm MAF"]]
    garageItems["Supplies"] = ["Oil", "WD40", constructionSupplies, carParts, "Brake Fluid"]
    print_r(garageItems) 
```

print_r 的输出（实际上是人类可以理解的）：

```
 Hash
    (
        [Car1] => Ford Mustang
        [Car2] => Honda Civic
        [Bike1] => IronHorse
        [Tools] => Hash
            (
                [Car Tools] => Array
                    (
                        [0] => Socket Set
                        [1] => Combination Wrenches
                        [2] => Oil Filter puller
                        [3] => Brake Compressor
                    )
                [House Tools] => Array
                    (
                        [0] => Circular Saw
                        [1] => Miter Saw
                        [2] => Drill
                    )
            )
        [Supplies] => Array
            (
                [0] => Oil
                [1] => WD40
                [2] => Hash
                    (
                        [Plywood] => Array
                            (
                                [0] => 3/4" T&G Plywood Sheets
                                [1] => 1/2" Plywood Sheets
                            )
                        [Boards] => Array
                            (
                                [0] => 2x4s
                                [1] => 2x6s
                                [2] => Engineered I-Joists
                            )
                        [Drywall] => Array
                            (
                                [0] => 4x8 1/2" Sheetrock
                                [1] => Mesh tape
                                [2] => Paper tape
                                [3] => Joint compount
                            )
                    )
                [3] => Hash
                    (
                        [Mustang] => Array
                            (
                                [0] => Clutch
                                [1] => Transmission
                                [2] => 3.55 Ring & Pinion Gears
                                [3] => Differential
                                [4] => 30# Injectors
                                [5] => Pro-M 77mm MAF
                            )
                    )
                [4] => Brake Fluid
            )
    ) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-29T23:50:59.943

查看调试 Rails 的指南：http: [//guides.rubyonrails.com/debugging_rails_applications.html](http://guides.rubyonrails.com/debugging_rails_applications.html)

提示：脚本/控制台非常适合在您的应用程序脚本/服务器的上下文中尝试一些东西 --debugger 在打开调试器的情况下启动服务器，然后您可以在代码中使用“调试”来闯入交互式外壳

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-04T14:01:19.243

我非常依赖的一种方法是：

```
logger.debug "OBJECT: #{an_object.to_yaml}" 
```

易于阅读，尽管对于大型对象可能会有些笨拙。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-04T05:38:32.707

我想我有点晚了，但是 logger.info [debug|warning] 呢？从控制器和模型中使用它。它将显示在您的日志文件中（处于开发模式时的 development.log）；和上面提到`<%= debug("str: " + str) %>`的意见。

这些不是您问题的确切答案，但您也可以使用脚本/控制台将您的 Rails 应用程序加载到交互式会话中。

最后，您可以将调试器放置在 Rails 应用程序的一行中，当您的应用程序执行此行时，浏览器将“挂起”，您将能够从您在源代码中放置调试器的确切行进入调试会话.

# asp.net - 集成 Windows 身份验证

> ID：491444
> 
> 赞同：6
> 
> 时间：2009-01-29T12:38:30.677
> 
> 标签：asp.net, iis, authentication, active-directory, dns

我们在使用 IIS 集成 Windows 身份验证时遇到了一些非常奇怪的问题，我不确定我是否能看到某种模式。

我们有一个名为 Fred 的 DNS-Cname 记录。我们有一个将 Fred 设置为主机头的 IIS 网站。当我连接到该站点时，我会收到凭据挑战提示。我希望我的凭据已经通过。如果我输入我的凭据，我将被授予访问权限。

然后，我创建一个名为 Betty 的本地主机条目，并将主机文件指向与 Fred 相同的 IP 地址，并将主机标头更改为 Betty。任何地方都没有关联的 CName 记录。当我访问 Betty 时，我会自动进行身份验证，一切都很好。

如果我试图绕过 CName 记录并在本地主机文件中创建一个名为 Fred 的条目并将主机头改回 Fred。我仍然收到身份验证质询。

正如我所看到的，它有两个问题。此 CName 记录如何影响此处的分辨率，或者它是一个红鲱鱼。其次，这个挑战发生了什么？我们在其他地方也有类似的症状，我们担心我们的身份验证令牌在某处被泄露。有人可以通过身份验证来演练顺序，即哪些数据包被发送到哪些机器。有没有办法可以追踪这个？（我在想 WireShark 或类似的东西）。如何证明我的身份验证令牌已通过并且有效？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T12:59:49.760

验证框的原因很简单：Internet Explorer 仅在它认为主机位于“本地 Intranet”区域（假定默认配置）时才会发送您的凭据。如果 IE 认为是“本地”的主机之外的主机要求提供 NTLM 凭据，则会出现一个身份验证框，您必须手动进行身份验证。

如果您希望自动发送您的凭据，请确保 IE 认为它在“本地 Intranet”中。检查状态栏最右侧的区域信息以查看当前活动区域。

IE 考虑了多种因素来决定是否将主机视为“本地 Intranet”：

1.  是否是本地子网中的 IP 地址 -> YES
2.  它是一个简单的主机名（即“无点”）-> 是
3.  在 IE 选项中：是否在“本地 Intranet”的“站点...”列表中 -> 是
4.  在 IE 选项中：是否在代理排除列表中 -> 是
5.  是 UNC 路径 -> 是
6.  否则：否
7.  有时，该主机名的个人密码列表中存在旧密码（可通过控制面板 -> 用户帐户访问）。如果错误，可能会出现类似的问题。

我的怀疑是您的主机“fred”不满足条件＃2 到＃4，但您的测试用例“Betty”以某种方式满足。

名称解析的方式（CName 记录、A 记录、hosts 文件、其他）没有区别，因为名称解析的方法对调用应用程序是不透明的。IE 只要求输入名称“XYZ”并返回 IP 地址。

不过，最近的配置更改可能需要您清除本地 DNS 缓存。偶尔`ipconfig /flushdns`会有所帮助，或者您可以暂时停止 DNS 客户端服务。

所描述的内部逻辑应用于主机名，安全设置会根据结果进行更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T13:03:57.443

CName 将是一个红鲱鱼。对 Windows Auth 没有影响。追踪它的最简单方法是使用提琴手。您应该会看到您的请求，然后是 401 响应（它包含服务器支持的身份验证），然后您的请求再次与身份验证详细信息一起发送（或者您收到提示，然后发送）

# sql-server - 您如何修复在缓存之前运行缓慢的查询

> ID：491447
> 
> 赞同：10
> 
> 时间：2009-01-29T12:38:54.513
> 
> 标签：sql-server, sql-server-2005, optimization, query-optimization

我有一些查询导致我们的实时环境超时。（>30 秒）

如果我运行分析器并获取正在运行的确切 SQL 并从 Management Studio 运行它，那么它们第一次运行需要很长时间，然后每次运行下降到几百毫秒。

这显然是 SQL 缓存数据并将其全部存储在内存中。

我确信可以对 SQL 进行优化，使其运行得更快。

我的问题是，当我第二次运行这些查询时，数据已经被缓存并且速度很快，我该​​如何“修复”这些查询？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-30T13:51:01.200

我是否可以建议您检查导致性能不佳问题的查询的执行计划。

您需要在执行计划中确定哪些步骤成本最高以及原因。例如，可能是您的查询正在执行表扫描，或者正在使用不适当的索引。

RedGate 网站上有一本非常详细的免费电子书，专门用于了解执行计划的内容。

[https://www.red-gate.com/Dynamic/Downloads/DownloadForm.aspx?download=ebook1](https://www.red-gate.com/Dynamic/Downloads/DownloadForm.aspx?download=ebook1)

您可能会发现有一个特定的执行计划希望用于您的查询。您可以使用查询提示强制 SQL Server 中的查询使用哪个执行计划。然而，这是一个相当先进的概念，应谨慎使用。有关详细信息，请参阅以下 Microsoft 白皮书。

[http://www.microsoft.com/technet/prodtechnol/sql/2005/frcqupln.mspx](http://www.microsoft.com/technet/prodtechnol/sql/2005/frcqupln.mspx)

我也不建议您清除生产环境中的过程缓存，因为这将不利于平台上当前未遇到性能问题的所有其他查询的性能。

例如，如果您正在执行一个存储过程，您可以使用 WITH RECOMPILE 命令确保为每次执行该过程计算一个新的执行计划。

对于整体性能调优信息，Brent Ozar 的博客上有一些优秀的资源。

[http://www.brentozar.com/sql-server-performance-tuning/](http://www.brentozar.com/sql-server-performance-tuning/)

希望这可以帮助。干杯。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-29T12:44:33.130

根据[http://morten.lyhr.dk/2007/10/how-to-clear-sql-server-query-cache.html](http://morten.lyhr.dk/2007/10/how-to-clear-sql-server-query-cache.html)，您可以运行以下命令来清除缓存：

```
DBCC DROPCLEANBUFFERS   
DBCC FREEPROCCACHE 
```

编辑：我检查了我拥有的 SQL Server 文档，这对于 SQL Server 2000 来说至少是正确的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-29T12:47:52.793

使用可以使用

```
DBCC DROPCLEANBUFFERS   
DBCC FREEPROCCACHE 
```

但仅在您的开发环境中使用它，同时调整查询以部署到实时服务器。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-30T17:36:44.193

我认为人们正朝着错误的方向逃跑。如果我明白了，您希望性能一直都很好吗？他们在第二次（以及随后的执行）中运行速度不快并且第一次运行速度很慢吗？

上面的 DBCC 命令会清除缓存，导致性能更差。

我认为，您想要的是启动泵并缓存数据。您可以通过一些执行查询并将数据加载到内存中的启动过程来做到这一点。

内存是一种有限资源，因此您可能无法将所有数据加载到内存中，但您可以找到平衡点。布伦特在上面有一些很好的参考资料，可以帮助您了解您可以在这里做什么。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T12:45:36.933

查询优化是一个很大的主题，您的问题没有单一的答案。做什么的线索都在查询计划中，无论结果是否被缓存，查询计划都应该是相同的。

寻找常见的东西，例如表扫描、在您期望它们被使用时未使用的索引等。最终您可能不得不重新审视您的数据模型，并可能实施非规范化策略。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T12:47:05.043

来自 MSDN：
“使用[DBCC DROPCLEANBUFFERS](http://msdn.microsoft.com/en-us/library/ms187762.aspx)使用冷缓冲区缓存测试查询，而无需关闭并重新启动服务器。”

# sql - Random numbers from database

> ID：491454
> 
> 赞同：3
> 
> 时间：2009-01-29T12:40:06.897
> 
> 标签：sql, random

**EDIT**: Duplicate of [How do I return random numbers as a column in SQL Server 2005?](https://stackoverflow.com/questions/94906/how-do-i-return-random-numbers-as-a-column-in-sql-server-2005)

Hello How can I generate random numbers in mssql server 2005.

for example: when I select 500rows from table, each row must have one generated random number, numbers must be generated at runtime

UPDATE: I need the fastest method, generate numbers from large tables, datepart, same magic computations is realatively slow with big amount of rows

UPDATE thanks for answers, but o finally used this solution

```
SELECT ABS(CHECKSUM(NewId())) % 10 - 5 AS Random 
```

for random numbers from -5 to 5 and bonus is approximately the same number of occurances for each number

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T12:48:15.617

```
SELECT TOP 500
    CONVERT(INT, CONVERT(VARBINARY(16), NEWID()))
FROM
    dbo.MyTable 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T12:48:52.620

I love this trick, its awesome ...

```
-- 500 random numbers from 0 to 499 
select top 500 ABS(CAST(CAST(NEWID() AS VARBINARY) AS int)) % 500 from sysobjects 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T12:42:30.637

[easy google](http://www.google.com/search?q=mssql+2005+generate+random): [1](http://weblogs.sqlteam.com/jeffs/archive/2004/11/22/2927.aspx) [2](http://blog.sqlauthority.com/2007/04/29/sql-server-random-number-generator-script-sql-query/) ...

* * *

> Returning Random Numbers in a SELECT statement

As it is implemented, **the RAND() function in SQL Server doesn't let you return a different random number per row** in your SELECT statement. For example, if you execute this:

```
SELECT Rand() as RandomNumber, *
FROM Northwind..Customers 
```

You will see the same number over and over. However, sometimes, you may want to return a randomly generated number per line in your SELECT. Here's one way to do that, in SQL Server 2000, using a UDF.

First, we need to create a View that returns a single random number:

```
CREATE VIEW vRandNumber
AS
SELECT RAND() as RandNumber 
```

The view is necessary because normally in a UDF we cannot use the rand() function, because that would make the function non-determistic. We can trick the UDF to accepting a random number by using a View.

Once that is set up, we can then create our function:

```
CREATE FUNCTION RandNumber()
RETURNS float
AS
  BEGIN
  RETURN (SELECT RandNumber FROM vRandNumber)
  END 
```

Finally, you can use this function in any SELECT to now return a random number between 0 and 1 per row:

```
SELECT dbo.RandNumber(), *
FROM Northwind..Customers 
```

You can get even fancier in your RandNumber function by accepting a seed if you like, or allowing for range parameters like this:

```
CREATE FUNCTION RandNumber2(@Min int, @Max int)
RETURNS float
AS
 BEGIN
 RETURN @Min + (select RandNumber from RetRandNumber) * (@Max-@Min)
 END 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T12:54:44.277

It might be helpful to know why you want the random number. For example if you just want to sort the results randomly you can do ORDER BY NEWID() and not worry about generating the random number at all. If you really need the random number later, use @Tim quoted solution.

# ms-project - 如何强制 Microsoft Project 中的任务根据优先级和资源分配进行“计划”？

> ID：491455
> 
> 赞同：15
> 
> 时间：2009-01-29T12:40:19.423
> 
> 标签：ms-project

我需要做一些不真正适合我们日常任务管理工具（FogBugz 和白板）工作流程的更高级别的项目规划，所以我想我会给 MS Project 一个旋转（它是免费的通过 MSDN）。

不过，我已经碰到了一堵相当坚固的墙。我有大约 120 个任务，一组人（将它们称为“资源”对我来说非常苛刻，但我离题了），以及这些任务的粗略优先级。有些任务有一个人分配给他们，有些则没有（仅仅是因为我们还不知道谁会做什么）。

到目前为止还好。问题是，除了那些相对罕见的任务链接的情况（大部分工作可以按任何顺序完成），所有任务都计划同时运行。我想做的是让项目根据以下情况找出一些调度方案：

*   定义的任务
*   他们的相对优先级
*   任何链接/依赖项（如果已定义）
*   我定义的人员的可用性，同时尊重我已经做出的明确的“资源”分配

这可能吗？我已经摆弄了资源平衡对话框并阅读了比我愿意承认的更多的 MS Project 文档，因此欢迎提出任何建议。

FWIW，我[在 Yahoo Answers 上的搜索中注意到了这个问题](http://answers.yahoo.com/question/index?qid=20090128165320AAbtaHs)；那里的人似乎在追求大致相同的东西，但我想在这里问可能更有成效。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-29T13:59:49.437

经过一些进一步的实验，我为自己的问题找到了部分解决方案。如果你：

*   为每个任务分配一个人
*   在任务信息面板的高级选项卡中指定*所有*任务应该（选择所有任务并单击任务信息按钮以更新所有任务的这些属性）：
    1.  使用日历（在我的项目文件中称为“标准”）
    2.  *安排时不要*忽略资源日历
    3.  有尽快的约束（这是默认的，我相信）
*   从工具菜单中选择关卡资源，并指定：
    1.  逐小时查找过度分配
    2.  “优先级，标准”的分级顺序（在设置计划时为您定义的每个任务滚动相对优先级值）

单击该调平资源对话框中的“立即调平”，所有任务都应重新安排，以便它们不会同时运行，并且没有人被“过度安排”。

表面上您可以让 Project 在添加、编辑任务等时自动重新安排事情，但我怀疑这会导致混乱，因为资源调配过程没有任何东西让我认为它是“稳定的”（例如，两次调平执行回来-to-back 不会产生相同的时间表）。

如果 Project 能够“完全分配”您配置的任何人员，那就太好了，这样您就不必将人员分配给任务，只是为了以一致（如果不正确）的方式安排这些任务。任何关于这方面的想法都将受到欢迎。

这似乎（并且感觉！）工作量很大，但我认为结果相对不错——一个项目的超高级视图，允许高度的日常灵活性，但仍然提供一个围绕“跨学科”活动合理制定计划的方法（例如，一旦完成，我们需要购买这四台服务器，确保我们的法律事务得到妥善处理，并在一周后触发营销推动等）。

# cocoa-touch - “NSRangeException”问题

> ID：491460
> 
> 赞同：0
> 
> 时间：2009-01-29T12:41:00.030
> 
> 标签：cocoa-touch, sqlite

我正在尝试构建一个 iPhone 应用程序。但是在编译时有一条消息显示

```
[Session started at 2009-01-29 18:25:40 +0600.]
2009-01-29 18:25:44.238 SimpleGame[3691:20b] *** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[NSCFArray objectAtIndex:]: index (1) beyond bounds (0)'
2009-01-29 18:25:44.247 SimpleGame[3691:20b] Stack: ( ......... 
```

实际上，当我激活这些代码时，会显示此消息，代码是：

```
NSMutableArray *todoArray = [[NSMutableArray alloc] init];
self.todos = todoArray;
[todoArray release]; 
```

我该如何克服这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T14:57:19.943

似乎您正在尝试访问空数组的范围之外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T15:01:41.090

在 objc_exception_throw 和 [NSException raise] 上放置断点。这应该在实际抛出错误之前显示错误，并希望能告诉您足够的信息来找到问题。

托尼

# msbuild - 构建后将文件从一个项目复制到另一个项目

> ID：491468
> 
> 赞同：5
> 
> 时间：2009-01-29T12:44:39.463
> 
> 标签：msbuild

我有一个用于我所有 javascripts 的项目（我为三个项目制定了共同点）。

在构建期间，我想将这些脚本移动到三个项目中，我该如何通过编辑来做到这一点`.csproj`？如何？

**更新：**

我有相同的解决方案`webapplication1`，`webapplication2`我正在`.csproj`为 webapplication1 进行编辑，我想复制测试文件夹中的所有文件

```
 <Target Name="AfterBuild">
    <Copy SourceFiles="$(WDTargetDir)test\" 
          DestinationFolder="$(SolutionRoot)WebApplication2">
    </Copy>
  </Target> 
```

然而什么都没有发生。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T13:07:10.650

有两种方法可以做到这一点：

_ 编辑 .csproject，在文件末尾您应该找到一个名为 AfterBuild 的目标（取消注释目标）。

```
<ItemGroup>
    <JavascriptFiles Include="*.js"/>
</ItemGroup>

<Target Name="AfterBuild">
    <Copy
        SourceFiles="@(JavascriptFiles)"
        DestinationFolder="PathWhereYouWantToCopyYourJavascriptFiles"
    />
</Target> 
```

_ 在 Visual Studio 中发布构建事件（在项目属性中）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T19:50:08.853

我找到了我的解决方案：

```
 <Target Name="AfterBuild">
    <Copy SourceFiles="test\CodeFile1.cs" 
          DestinationFolder="..\WebApplication2\scripts">
    </Copy>
  </Target> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-29T12:53:13.453

如果您可以使用 Visual Studio 进行构建，则在 Visual Studio 中使用[构建后事件](http://visualstudiohacks.com/articles/general/customize-your-project-build-process/)。失败，如果您可以访问命令行，只需发出[复制](http://www.google.co.uk/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.computerhope.com%2Fcopyhlp.htm&ei=YaeBSYiAG8-X-gbAhYk2&usg=AFQjCNHX3seykl-9uufBf_oG1xM31IlfrQ&sig2=Rvx_NoaOOB0hPcVibtAQ5A)命令

# git - Emacs 可以忽略 git stashed 文件时间戳的变化吗？

> ID：491476
> 
> 赞同：2
> 
> 时间：2009-01-29T12:46:54.060
> 
> 标签：git, emacs

我在 Emacs 中编写了一个小函数

```
git stash
git stash apply 
```

在我访问的文件的 Git 存储库中，我已经添加了这个函数，`after-save-hook`所以每次我保存文件时它都会运行。问题是当我保存文件时，上面的 git 命令运行并更改了时间戳，因此 Emacs 认为该文件已在 Emacs 本身之外进行了修改。自然，当我尝试再次编辑文件（不关闭和重新打开）时，Emacs 会询问我是否真的要编辑缓冲区，这很烦人。

关于如何使 Emacs 不认为文件已因上述 git 命令而更改的任何想法？

编辑：谢谢jvasak。`(revert-buffer nil t t)`在我的函数末尾添加就可以了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T13:01:21.877

我不确定这是否可行，但您可以添加`revert-buffer`到`after-save-hook`应该从磁盘重新加载文件的哪个文件。结合[GNU Emacs Manual](http://www.delorie.com/gnu/docs/emacs/emacs_121.html "GNU Emacs Manual")`revert-without-query`中的技巧，这可能会提供所需的行为。

# .net - ASP.NET、MySQL 与 SQL Server 中的数据库连接

> ID：491484
> 
> 赞同：4
> 
> 时间：2009-01-29T12:50:22.273
> 
> 标签：.net, asp.net, mysql, sql-server, connection-pooling

我在我目前正在处理的 ASP.NET 项目中使用 MySQL，我做了一些测试来测试 MySQL .NET 提供程序的性能，但不幸的是我对结果不太满意。

一个仅打开连接的非常简单的循环在 SQL Server 中速度提高了 10 倍：

```
// MySQL

const string CONNECTION_STRING = 
"server=localhost;database=testdb;user id=root;password=mypassword;max pool size=250;";
for (int i = 0; i < 5000; i++)
{
  using (MySqlConnection con = new MySqlConnection(CONNECTION_STRING))
  {
    con.Open();
  }
}

// SQL Server

const string CONNECTION_STRING = "Data Source=localhost;Initial Catalog=testdb;Integrated Security=True;max pool size=250;";
for (int i = 0; i < 5000; i++)
{
  using (SqlConnection con = new SqlConnection(CONNECTION_STRING))
  {
    con.Open();
  }
} 
```

SQL Server 在其他方面也快得多（选择、更新、插入等）。我做错什么了吗？我应该更改任何服务器变量吗？

更多信息：
- 我在 Windows (5.0.51a-community-nt) 上运行 MySQL
- 测试中使用了 SQL Server 2005
- 规格：Windows XP SP2，CPU Intel 1.6GHz 双核，1024 MB RAM

这是MySQL的配置：

```
[client]
port        = 3306
socket      = /tmp/mysql.sock

[mysqld]
port        = 3306
socket      = /tmp/mysql.sock
skip-locking
key_buffer = 384M
max_allowed_packet = 1M
table_cache = 512
sort_buffer_size = 2M
read_buffer_size = 2M
read_rnd_buffer_size = 8M
myisam_sort_buffer_size = 64M
thread_cache_size = 8
query_cache_size = 32M
thread_concurrency = 8

server-id   = 1

[mysqldump]
quick
max_allowed_packet = 16M

[mysql]
no-auto-rehash

[isamchk]
key_buffer = 256M
sort_buffer_size = 256M
read_buffer = 2M
write_buffer = 2M

[myisamchk]
key_buffer = 256M
sort_buffer_size = 256M
read_buffer = 2M
write_buffer = 2M

[mysqlhotcopy]
interactive-timeout 
```

感谢您的任何建议...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T12:57:17.127

SQL 服务器默认使用连接池：每个使用完全相同的连接字符串打开的连接在关闭时都会返回到池中。从池中返回连接比从头开始创建连接要高效得多。*我假设 MySql默认*不提供连接池

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-28T22:41:32.800

需要考虑的是 mySQL 是如何安装的，你告诉它服务器是专用的 DB 服务器还是工作站？MySQL 可以配置为限制自身，使其不与其他服务冲突，或者采用任何可用的服务。SQL Server 将使用它认为需要的任何资源。我会研究你的mysql服务器是如何配置的，你很有可能在那里得到一些性能改进。

最后，windows 不是 mysql 的首选平台，它是受支持的，但如果您真的希望它执行，请将其放在 linux 系统上，您可以在其中调整文件系统等以获得最佳性能，这是 SQL Server 可以做到的不要做

这里是一些文章、博客、书籍等的链接，用于性能调整 mysql
[http://forums.mysql.com/read.php?24,92131,92131](http://forums.mysql.com/read.php?24,92131,92131)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T13:09:39.490

它可能是连接池，但您还必须考虑这样一个事实，即当 .NET 代码与 Sql Server 通信时，它使用最有效的通道进行通信，因为代码全部由 Microsoft 拥有和控制。如果 .NET 代码正在与第 3 方服务器通信，或者如果某些第 3 方代码正在与 Sql Server 通信，则通信必须更加基于标准和通用，因此速度要慢得多。

这就是为什么在“宠物店”战争期间，ASP.NET 解决方案的运行速度总是比替代解决方案快得多。当您被迫与平台无关时，您可能无法跟上 100% 本机代码。

# c++ - 不使用 GDI 的 DirectX 字体教程

> ID：491487
> 
> 赞同：0
> 
> 时间：2009-01-29T12:51:02.367
> 
> 标签：c++, fonts, directx

有没有人有任何教程/信息用于在不使用 GDI 的本机 directx 9 中创建和渲染字体？（例如不使用 ID3DXFont）。
我读到这不是最好的解决方案（由于访问 GDI），但是在 dx 中呈现字体的“正确”方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T14:16:59.667

为什么这不是一个好的解决方案？

将 GDI 渲染和 D3D 渲染混合到同一个窗口中是一个坏主意。

但是，ID3DXFont 不使用它。它使用 GDI 将字形光栅化为纹理。并使用该纹理来渲染实际文本。

唯一的选择是使用另一个库（例如 FreeType）将字形光栅化为纹理，但我不确定这是否会带来任何实质性的好处。

当然，对于简单（例如非亚洲）字体，您可以预先将所有字形光栅化为纹理，然后使用该纹理在运行时绘制文本。这种方式运行时不需要使用任何字体渲染库，它只是使用纹理绘制四边形。这种方法不适用于大字体或具有大量字符的字体。也不能很好地处理复杂的排版（例如必须加入字母等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-02T20:31:49.053

ID3DXFont 是一款易于使用、早期调试输出的好东西。但是，它确实使用 GDI 进行字体光栅化（不是硬件加速）并且对性能有很大影响（尝试一下，它实际上非常明显）。不过，从 DirectX 11 开始，字体将使用 Direct2D 呈现并进行硬件加速。

呈现文本的最快方法是使用所谓的“位图字体”。我将解释如何做到这一点，除了有很多不同的方法可以实现这种技术，每种方法的复杂性和功能都不同。它可以像加载预先创建的纹理并从中绘制字母的系统一样简单，也可以像在 Windows 中静默注册字体并在加载时在内存中创建纹理的系统一样简单（我与朋友开发的引擎这样做，它非常光滑）。无论哪种方式，您都应该看到位图字体的性能显着提高。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-21T13:04:00.380

使用 DirectX，渲染标准字体的正确方法是使用 GDI。

然而，如果

*   你想支持跨平台字体渲染
*   适当支持国际化 - 包括远东语言，其中为字体中的每个字符维护字形是不切实际的
*   和/或您想分发自己的字体并在不“安装”它们的情况下渲染它们......

那么[libfreetype](http://freetype.sourceforge.net/index2.html)可能就是您正在寻找的东西。我并不认为这很容易：它比使用原生字体 api 复杂得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-23T01:34:48.573

我个人认为 ID3DXFont 是要走的路。如果你真的想制作自己的字体例程，我建议你看看： [http ://creators.xna.com/en-us/utilities/bitmapfontmaker](http://creators.xna.com/en-us/utilities/bitmapfontmaker)

您可以使用它来创建一个位图，上面印有所有字符。然后它只是一个问题或加载纹理并将相关字符blitting到屏幕上的正确位置。（这是 XNA 用于其字体绘制的内容）

它的工作量要大得多，但您不需要在目标 PC 上安装字体，并且您可以进入 Photoshop 并在那里编辑字体外观。

# javascript - 如何在 Firefox 扩展中使用 jQuery

> ID：491490
> 
> 赞同：58
> 
> 时间：2009-01-29T12:52:45.203
> 
> 标签：javascript, jquery, firefox, firefox-addon

我想在 firefox 扩展中使用 jQuery，我在 xul 文件中导入了库，如下所示：

```
<script type="application/x-javascript" src="chrome://myExtension/content/jquery.js"> </script> 
```

但是在 xul 文件中无法识别 $() 函数，jQuery() 也无法识别。

我搜索了这个问题并找到了一些解决方案，但没有人与我合作：http: [//gluei.com/blog/view/using-jquery-inside-your-firefox-extension](http://gluei.com/blog/view/using-jquery-inside-your-firefox-extension) [http://forums.mozillazine.org/ viewtopic.php?f=19&t=989465](http://forums.mozillazine.org/viewtopic.php?f=19&t=989465)

我还尝试将'content.document'对象（引用'document'对象）作为上下文参数传递给jQuery函数，如下所示：

```
$('img',content.document); 
```

但仍然无法正常工作，以前有人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-30T19:53:29.580

我使用以下内容`example.xul`：

```
<?xml version="1.0"?>
<overlay id="example" xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
<head></head>
<script type="application/x-javascript" src="jquery.js"></script>
<script type="application/x-javascript" src="example.js"></script>
</overlay> 
```

这是一个`example.js`

```
(function() {
    jQuery.noConflict();
    $ = function(selector,context) { 
        return new jQuery.fn.init(selector,context||example.doc); 
    };
    $.fn = $.prototype = jQuery.fn;

    example = new function(){};
    example.log = function() { 
        Firebug.Console.logFormatted(arguments,null,"log"); 
    };
    example.run = function(doc,aEvent) {
        // Check for website
        if (!doc.location.href.match(/^http:\/\/(.*\.)?stackoverflow\.com(\/.*)?$/i))  
            return;

        // Check if already loaded
        if (doc.getElementById("plugin-example")) return;

        // Setup
        this.win = aEvent.target.defaultView.wrappedJSObject;
        this.doc = doc;

        // Hello World
        this.main = main = $('<div id="plugin-example">').appendTo(doc.body).html('Example Loaded!');
        main.css({ 
            background:'#FFF',color:'#000',position:'absolute',top:0,left:0,padding:8
        });
        main.html(main.html() + ' - jQuery <b>' + $.fn.jquery + '</b>');
    };

    // Bind Plugin
    var delay = function(aEvent) { 
        var doc = aEvent.originalTarget; setTimeout(function() { 
            example.run(doc,aEvent); 
        }, 1); 
     };
    var load = function() { 
        gBrowser.addEventListener("DOMContentLoaded", delay, true); 
    };
    window.addEventListener("pageshow", load, false);

})(); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-03-08T20:56:42.870

以下解决方案使在 contentScriptFile 中使用 jQuery 成为可能（目标 1.5 Addon-sdk）

在你的 main.js 中：

```
exports.main = function() {
    var pageMod = require("page-mod");

    pageMod.PageMod({
          include: "*",
          contentScriptWhen: 'end',
          contentScriptFile: [data.url("jquery-1.7.1-min.js") , data.url("notifier.js") ,   data.url("message.js")],
          onAttach: function onAttach(worker) {
             //show the message
             worker.postMessage("Hello World");
          }
    });

}; 
```

在你的 message.js 中：

```
self.on("message", function(message){
    if(message !== "undefined"){
       Notifier.info(message); 
    }
}); 
```

***您需要注意的一些陷阱：***

*   contentScriptFile 数组的顺序。如果将 message.js 放在第一位：jQuery 将不会被重新配置。
*   不要在[data.url](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/packages/addon-kit/docs/self.html#data)中放置 http:// url （这不起作用）！
*   您所有的 javascript 文件都应该在数据文件夹中。（只有 main.js 应该在 lib 文件夹中）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-03-08T05:51:14.180

mozillaZine 论坛中有一篇出色的文章逐步描述了这一点：[http ://forums.mozillazine.org/viewtopic.php?f=19&t=2105087](http://forums.mozillazine.org/viewtopic.php?f=19&t=2105087)

我还没有尝试过，所以我犹豫在这里复制信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-05-21T07:34:01.257

事实证明，@sunsean 当前的最佳答案[在处理多个负载时无法按预期工作](https://stackoverflow.com/q/23771042/484441)。该函数应正确关闭文档并避免全局状态。

此外，您必须调用`jQuery.noConflict(true)`才能真正避免与其他附加组件发生冲突！

这就是我要写它的人（再说一遍，我会避免像瘟疫一样的 jquery（在附加组件中）......）。首先覆盖 XUL

```
<?xml version="1.0"?>
<overlay id="test-addon-overlay" xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
  <script type="text/javascript" src="jquery.js"/>
  <script type="text/javascript" src="overlay.js"/>
</overlay> 
```

然后覆盖脚本：

```
// Use strict mode in particular to avoid implicitly var declarations
(function() {
  "use strict";

  // Main runner function for each content window.
  // Similar to SDK page-mod, but without the security boundaries.
  function run(window, document) {
    // jquery setup. per https://stackoverflow.com/a/496970/484441
    $ = function(selector,context) {
      return new jq.fn.init(selector,context || document); 
    };
    $.fn = $.prototype = jq.fn;

    if (document.getElementById("my-example-addon-container"))  {
      return;
    }
    let main = $('<div id="my-example-addon-container">');
    main.appendTo(document.body).text('Example Loaded!');
    main.click(function() { //<--- added this function
      main.text(document.location.href);
    });
    main.css({
      background:'#FFF',color:'#000',position:'absolute',top:0,left:0,padding:8
    });
  };

  const log = Components.utils.reportError.bind(Components.utils);

  // Do not conflict with other add-ons using jquery.
  const jq = jQuery.noConflict(true);

  gBrowser.addEventListener("DOMContentLoaded", function load(evt) {
    try {
      // Call run with this == window ;)
      let doc = evt.target.ownerDocument || evt.target;
      if (!doc.location.href.startsWith("http")) {
        // Do not even attempt to interact with non-http(s)? sites.
        return;
      }
      run.call(doc.defaultView, doc.defaultView, doc);
    }
    catch (ex) {
      log(ex);
    }
  }, true);
})(); 
```

这是[一个完整的附加组件作为要点](https://gist.github.com/nmaier/d1a259435af47f6a159d)。只需放入 jquery 的副本，就可以了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-30T10:15:11.183

我认为这就是 Eric 所说的，但您可以直接从 URL 加载 Javascript。

```
javascript:var%20s=document.createElement('script');s.setAttribute('src','http://YOURJAVASCRIPTFILE.js');document.getElementsByTagName('body')[0].appendChild(s);void(s); 
```

我假设您希望您的扩展程序加载 JQuery，以便您可以轻松地操作页面元素？我公司的实验室在此处直接使用 Javascript 执行此操作：http: [//parkerfox.co.uk/labs/pixelperfect](http://parkerfox.co.uk/labs/pixelperfect)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T17:04:05.943

这可能是不好的做法，但是您是否考虑过将其包含在内？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-07-14T08:46:32.137

代替

```
$('img',content.document); 
```

你可以试试

```
$('img',window.content.document); 
```

就我而言，它有效。

# java - 如何使用 Struts 执行 Junit 测试 - Ibatis

> ID：491503
> 
> 赞同：0
> 
> 时间：2009-01-29T12:56:56.287
> 
> 标签：java, jakarta-ee, junit, struts, ibatis

我使用 Struts 1.2.x 和 Ibatis 2.x 版本进行开发，所以我昨天完成了，现在我想执行测试这是我第一次尝试使用 JUnit，我已经进行了测试，但是在 JavaApp 中没有在服务器上运行，所以如何模拟或生成具有服务器行为的模拟，以及为 Struts 和 Ibatis 内置环境推荐哪些模拟？

例如，如何为登录屏幕设置访问权限？

我知道 StrutsTestCase 我正在使用它，关于 Cactus 用于容器和模拟非容器场景，我想查看使用 struts 和 ibatis 的演示，因为我不知道如何从映射中检索数据。谢谢

对不起我的英语

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T14:20:00.457

你看过 HttpUnit 吗？我尝试将它用于 Servlet 测试，与 Struts Actions 等完全不同 - 我知道，但它有一些不错的教程。

您可能还想查看[JUnit 的 StrutsTestCase](http://strutstestcase.sourceforge.net/)。该项目应该是单元测试 struts 的充分开始。它还提到了[Cactus](http://jakarta.apache.org/cactus/)，它是一个用于在服务器端测试 Web 应用程序的框架。

实际上，这完全取决于您想要进行测试的程度。您可能应该首先开始编写测试，您知道的测试驱动设计；）它确实有效。并不是说我一直这样做...

# linux - 如何从用户空间应用程序（Linux、C）中获取 CPU 内核编号？

> ID：491520
> 
> 赞同：18
> 
> 时间：2009-01-29T13:04:33.477
> 
> 标签：linux, multicore, smp

大概有一个库或简单的 asm blob 可以让我知道我正在执行的当前 CPU 的数量。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-29T13:23:28.790

用于`sched_getcpu`确定正在运行调用线程的 CPU。请参阅`man getcpu`（系统调用）和`man sched_getcpu`（库包装器）。但是，请注意它所说的：

> 放置在 cpu 中的信息仅保证在调用时是最新的：除非使用 sched_setaffinity(2) 修复了 CPU 亲和性，否则内核可能随时更改 CPU。（通常这不会发生，因为调度程序会尽量减少 CPU 之间的移动以保持高速缓存热，但这是可能的。）调用者必须准备好处理当 cpu 和节点不再是当前 CPU 和节点的情况。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T13:26:26.897

您需要执行以下操作：

*   调用 sched_getaffinity 并识别 CPU 位
*   迭代 CPU，对每个 CPU 执行 sched_setaffinity （我不确定在 sched_setaffinity 之后你是否保证在 CPU 上，或者需要显式让步？）
*   执行 CPUID（asm 指令）...有一种方法可以从其中一个输出中获取唯一的每核 ID（请参阅[Intel 文档](http://download.intel.com/design/processor/applnots/24161832.pdf)）。我隐约记得它是“APIC ID”。
*   从 APIC ID 到 CPU 编号或关联掩码或其他东西构建一个表（一个 std::map ？）。
*   如果您在主线程上执行此操作，请不要忘记将 sched_setaffinity 设置回所有 CPU！

现在，您可以在需要时再次使用 CPUID 并查找您所在的内核。

但我想问你为什么需要这样做；通常你想通过 sched_setaffinity 来控制而不是找出你在哪个核心上（即使这是一个非常罕见的东西想要/需要）。（这就是为什么我不知道从 CPUID 中准确提取什么的关键细节，抱歉！）

更新：刚刚从 litb 的回复中了解了 sched_getcpu。好多了！（不过我的 Debian/etch libc 太旧了，无法使用）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T13:17:41.907

我不知道有什么可以获取您当前的核心 ID。使用内核级任务/进程迁移，除非您以某种形式的实时模式运行，否则无法保证它会在任何时间长度内保持不变。

如果你想在一个特定的核心上，你可以使用那个`sched_setaffinity()`函数或`taskset`命令来启动你的程序。不过，我相信这些需要提升的权限才能工作。然后，在您的程序中，您可以运行`sched_getaffinity()`以查看之前设置的掩码，并将其用作您正在执行的核心的最佳猜测。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-06T13:33:15.927

```
sysconf(_SC_NPROCESSORS_ONLN); 
```

# c# - 解除绑定 wpf listview 的最佳方法

> ID：491523
> 
> 赞同：2
> 
> 时间：2009-01-29T13:05:44.990
> 
> 标签：c#, .net, wpf, data-binding, listview

我将 WPF listview 绑定到对象集合。对象不断地从远程服务器添加到集合中，同样反映到列表视图中。现在我们要求我们应该能够冻结列表视图一段时间，即对象仍应添加到集合中但不应该出现在列表视图中，直到我们解冻它（我们有按钮来冻结和解冻）。当 listview 绑定到 collection 时，最好的方法是什么？如何取消绑定集合并重新绑定它？当集合与 listview 解除绑定时，我仍然能够过滤和排序吗？等待回复请回复

问候桑迪普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T15:58:04.470

你可以打破绑定。在您的冻结按钮处理程序中说：

```
listView = _list 
```

届时将冻结它。然后在您的解冻处理程序中设置绑定备份：

```
listView.SetBinding(ListView.ItemsSourceProperty, New Binding("_list")) 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T13:20:06.443

您应该在列表被冻结时停止更新集合，如果即使列表被冻结也必须继续添加到集合中（如果相同的集合在其他不应该被冻结的地方使用）然后考虑有两个集合，一个总是更新，另一个绑定到列表视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T13:21:14.130

您用作数据源的列表类型是什么？你能用`BindingList<T>`吗？如果是这样，它有一个可设置的`RaiseListChangedEvents`属性，允许您关闭通知。不过，这可能会让您的最后一点变得非常混乱（排序/过滤）。

就个人而言，我会使用 2 个列表 - 绑定的列表和服务器正在更新的列表。暂停时，只需停止在两者之间传输数据。这应该让暂停的视图自由进行排序/过滤等。

# javascript - Javascript 事件处理程序总是会增加浏览器内存使用量

> ID：491527
> 
> 赞同：2
> 
> 时间：2009-01-29T13:06:53.753
> 
> 标签：javascript, memory-leaks, event-handling

编辑：在进一步检查中，Firefox 似乎没有这样做，但 Chrome 肯定会这样做。我猜这只是新浏览器的一个错误 - 对于每个事件，I/O 读取也会发生在 Chrome 中，但不会发生在 FF 中。

当我在浏览器中加载以下页面时（我在 Vista 下的 Chrome 和 Firefox 3 中进行了测试）并在周围移动鼠标时，内存总是增加并且似乎永远不会减少。

这是：

1.  浏览器的预期行为
2.  浏览器中的内存泄漏或
3.  提供的代码中的内存泄漏？

.

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>test</title>
</head>
<body>
   <script>
      var createEl = function (i) {
          var el = document.createElement("div");
          var t = document.createTextNode(i.toString());
          el.appendChild(t);
          t=null;
          el.id=i.toString();

          var fn = function (e) {};
          el.addEventListener("mouseover", fn, false);
          //el.onmouseover = fn;
          fn = null;

          try{
            return el;
          }
          finally{
            el=null;
          }
          //return (el = [el]).pop();
        };

        var i,x;
        for (i= 0; i < 100; i++){
          x = createEl(i)
          document.body.appendChild(x);
          x = null;
        }
   </script>
</body>
</html> 
```

和想法都来自[这里](http://ajaxian.com/archives/is-finally-the-answer-to-all-ie6-memory-leak-issues)`(el = [el].pop())`，尽管它们似乎都没有帮助 - 可以理解，因为它们只是用于 ie6 修复。`try/finally`

我还尝试过使用 addEventListener 和 onmouseover 方法来添加事件。我发现防止内存增加的唯一方法是注释掉这两行代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-17T12:24:40.000

fn 是一个闭包，即使其中没​​有代码。例如，尝试使用 Firebug 进行调试并在该函数内设置断点。闭包中定义的所有变量（fn 代码 + 挂起的变量 = 闭包）理论上都是可访问的（尽管我不知道如何在实践中访问它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T13:26:08.113

好吧，这根本不是我处理这个问题*的*方式，而且我无法复制这种行为，所以我只能告诉你，你在记忆方面遇到的问题很可能是因为`fn`函数中的任何内容，除非它是您应该`fn`在函数外部定义闭包，`createEl`并仅在函数内部引用它，因此内存中只存在一个实例。

不过，您需要更好地处理事件绑定（这不是 xbrowser 安全的 - 在这一点上我犹豫是否建议使用 jQuery），而且整个`(el =[el]).pop()`巫毒教的恶臭对我来说都很糟糕，尽管如果有人能准确地解释什么，我很高兴得到纠正它实现了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T15:52:44.730

与事件处理程序相关的内存泄漏通常与外壳有关。换句话说，将函数附加到指向其元素的事件处理程序可以防止浏览器进行垃圾收集。（谢天谢地，大多数较新的浏览器已经“学会了诀窍”并且在这种情况下不再泄漏内存，但是有很多旧浏览器漂浮在那里！）

这样的外壳可能如下所示：

```
var el = document.createElement("div");
var fnOver = function(e) {
    el.innerHTML = "Mouse over!";
};
var fnOut = function(e) {
    el.innerHTML = "Mouse out.";
};

el.addEventListener("mouseover", fnOver, false);
el.addEventListener("mouseout", fnOut, false);

document.getElementsByTagName("body")[0].appendChild(el); 
```

事实上，`fnOver`并`fnOut`触及它们的封闭范围以引用`el`是创建一个封闭（实际上是两个 - 每个功能一个）并可能导致浏览器泄漏的原因。您的代码不会做这样的事情，因此不会创建任何外壳，因此不应导致（行为良好的）浏览器泄漏。

我猜这只是测试版软件的一大败笔。:-)

# asp.net - 如何在 ASP.NET AJAX Toolkit 的 TextBoxExtender 中过滤掉逗号？

> ID：491528
> 
> 赞同：1
> 
> 时间：2009-01-29T13:07:02.943
> 
> 标签：asp.net, ajax, toolkit, textboxextender

我希望我的 TextBoxExtender 不允许逗号和斜杠。我该如何设置？使用转义序列？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T13:11:03.560

我认为您正在寻找*InvalidChars*元素。FilteredTextBoxExtender 可以设置为过滤有效或无效字符。

```
 <ajaxToolkit:FilteredTextBoxExtender ID="MyId" runat="server"
        TargetControlID="TextBoxName"         
        FilterType="Custom"
        FilterMode="InvalidChars"
        InvalidChars="Your Charcters" /> 
```

[参考](http://www.asp.net/ajax/ajaxcontroltoolkit/Samples/FilteredTextBox/FilteredTextBox.aspx)

编辑不，您可以添加所有要排除的字符

```
InvalidChars="`~!@#$%^&*()_-+=[]{}:;',.<>/? " 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T11:49:04.660

是的，但我也想知道如何在集合中包含逗号——它需要一个转义序列，对吗？像 Invalidchars="H,\,"。

# wpf - 如何推迟对 WPF 中的绑定的更新

> ID：491535
> 
> 赞同：9
> 
> 时间：2009-01-29T13:12:00.530
> 
> 标签：wpf, data-binding

有没有一种简单的方法可以告诉双向 WPF 数据绑定在最后一次更改之后等待几毫秒，然后再使用新的属性值更新 Source？

我正在为有一个文本框的 ListBox 实现过滤器功能，我想根据我输入的内容过滤 ListBox 的内容。我正在使用数据绑定将各个部分连接在一起。过滤列表可能非常耗时，所以我不想在输入每个字符后都这样做：因此我的请求。

我一直在使用 Paul Stovell 的 DelayBinding Extension（他的网站目前已关闭，所以我无法链接到它）。但是，我怀疑这是我的应用程序中内存泄漏的原因（由于它没有删除事件处理程序）。

还有其他人有其他想法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-13T16:14:29.617

我也迟到了几年，但是如果您使用的是 WPF 4.5+ [，那么现在有一个](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingbase.delay.aspx)专门用于此目的的属性，它被称为`Delay`.

描述

> 在更新绑定源之前等待的时间量（以毫秒为单位）。

示例用法

```
<TextBlock Text="{Binding Name, Delay=500}"/> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-02T23:44:11.267

这里的问题有点晚了（仅仅几年:)，但对于任何感兴趣的人，我在一个项目中有类似的要求，所以我创建了两个标记扩展名为`DelayBindingExtension`and `DelayMultiBindingExtension`。

它们可以正常工作`Bindings`，除了您可以指定`UpdateSourceDelay`和/或之外`UpdateTargetDelay`，它们都是`TimeSpan`属性。此外，我已经验证它是无泄漏的*（它通过继承上下文而不是使用依赖属性绑定的 propertychanged 回调`DependencyPropertyDescriptor`）*。

a 的示例用法`DelayBinding`

```
<TextBox Text="{db:DelayBinding Path=TextProperty,
                                UpdateSourceTrigger=PropertyChanged,
                                UpdateSourceDelay='00:00:01'}"/> 
```

而对于一个`DelayMultiBinding`

```
<cs:ColorSelector.SelectedColor>
    <db:DelayMultiBinding Mode="TwoWay"
                          Converter="{StaticResource ColorConverter}"
                          UpdateSourceDelay="00:00:02"
                          UpdateTargetDelay="00:00:01">
        <Binding Path="Red" />
        <Binding Path="Green" />
        <Binding Path="Blue" />
    </db:DelayMultiBinding>
</cs:ColorSelector.SelectedColor> 
```

和 的源代码和示例用法`DelayBinding`可以`DelayMultiBinding`在[此处](https://www.dropbox.com/s/qb88bg4jjibbnru/DelayBindingDemo.zip?dl=0)下载。
如果您对实现细节感兴趣，可以在这里查看我的博客文章：[DelayBinding and DelayMultiBinding with Source and Target delay](http://meleak.wordpress.com/2012/05/02/delaybinding-and-delaymultibinding-with-source-and-target-delay/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T15:32:51.027

首先，为了回答您的问题，我将添加[UpdateSourceTrigger](http://msdn.microsoft.com/en-us/library/system.windows.data.updatesourcetrigger.aspx)绑定扩展，它可以让您控制绑定何时更新。首先尝试 LostFocus，但听起来您可能想选择 Explicit。

其次，如果您的过滤需要很长时间，我会考虑在您的 ListBox 上使用 CollectionViewSource。Bea Stollnitz 在[这里](http://www.beacosta.com/blog/?p=17)有一个很好的入门知识，我用[这篇博](http://sandyvalley.spaces.live.com/Blog/cns!AB1484B25F28E501!461.entry)文向我展示了如何过滤。当我改变时，我注意到与我的其他实现相比存在巨大的速度差异，即使它们使用相同的过滤功能。如果您绑定到的列表发生更改，即使在项目级别上，如果您绑定到 ObservableCollection，CollectionViewSource 也会自动处理更新过滤的项目（这是我更改为 CollectionViewSource 的原始原因）。

高温高压

# asp.net - 嵌套中继器和 SqlDataSource 参数

> ID：491537
> 
> 赞同：6
> 
> 时间：2009-01-29T13:12:52.057
> 
> 标签：asp.net, sql, sql-server, repeater

我正在使用嵌套转发器来构建一个表，原因我不会在这里讨论，但我想做的是有两个数据源，一个用于与行对应的顶级转发器，一个用于第二级将返回一行中的单元格的中继器。

然而，我想知道的是，我是否可以以某种方式在嵌套中继器的数据源中指定一个参数，该参数在第一个数据源的结果中设置一个字段？

我可以将参数设置为数据绑定表达式的值吗？

我想这样做的原因是我有两个存储过程。加载页面时，我有一个会话参数，可用于运行第一个存储过程，但是，对于第二个存储过程，我需要将顶级转发器的每个实例的值与对第二个存储过程的调用相关联具有不同的参数值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-28T11:06:30.017

我通过使用 HiddenField 来存储稍后用作参数的值来做到这一点。完成工作。

```
<asp:SqlDataSource ... />
<asp:Repeater ...>
    <ItemTemplate>

        <asp:HiddenField ID="txtOuterID" runat="server" Value='<%# Eval("ID") %>' Visible="false" />

        <asp:SqlDataSource ...>
            <SelectParameters>
                <asp:ControlParameter Name="OuterID" Type="Int32" ControlID="txtOuterID" PropertyName="Value" />
            </SelectParameters>
        </asp:SqlDataSource>

        <asp:Repeater ...>

    </ItemTemplate>
</asp:Repeater> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T13:23:36.827

我认为最好的方法是处理 Outer Repeater 的 ItemDataBound 事件，**找到**内部 DataSource 控件并为其设置 SelectParameter。

```
 void MyOuterRepeater_ItemDataBound(Object sender, RepeaterItemEventArgs e) 
    {
    // Find the Inner DataSource control in this Row.
    SqlDataSource s = (SqlDataSource)e.Item.FindControl("InnerDataSource");

    // Set the SelectParameter for this DataSource control
    // by re-evaluating the field that is to be passed.
    s.SelectParameters["MyParam"].DefaultValue = DataBinder.Eval(e.Item.DataItem, "MyFieldValueToPass").ToString();
    } 
```

有关使用 DataList 的示例，请查看[此处的 ASP.NET 快速入门](http://quickstarts.asp.net/QuickStartv20/util/srcview.aspx?path=~/aspnet/samples/data/NestedMasterDetailsList.src&file=NestedMasterDetailsList_cs.aspx&lang=C%23+Source)

PS：*请参阅下面托尼的回复，以获取对上述片段的重要更正。值得注意的是，必须检查当前RepeaterItem 的ItemType。或者，始终检查每个对象上的空值是一种极好的做法。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T13:47:10.180

您可能想研究一种可以减少 sproc 调用量的技术。可以从同一个存储过程返回多个结果集。.net 数据集能够定义多个数据表之间的关系，从而可以轻松地在一个表中获取数据行并在另一个数据表中获取所有子节点。前任：

```
exampleData.Relations.Add(New DataRelation("FOO_RELATION", exampleData.Tables["TABLE_A"].Columns["ID"], exampleData.Tables["TABLE_B"].Columns["PARENT_ID"])); 
```

然后从 TABLE_A 中的任何数据行，您可以像这样访问所有子项：

```
DataRow[] childRows = row.GetChildRows("FOO_RELATION"); 
```

这更有效，恕我直言也更容易。这样您就不需要将 sproc 调用烘焙到转发器的事件处理程序中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-29T14:30:53.710

Cerebrus 的答案有效，但有一个问题。除非您遵循我认为的这个问题的规则，否则您将获得空异常：

[在ItemDataBound期间如何访问被数据绑定的项目？](https://stackoverflow.com/questions/344047/asp-net-how-to-access-the-item-being-data-bound-during-itemdatabound)

本质上，我必须检查以确保有问题的项目是一个项目或交替项目，否则页眉和页脚会造成麻烦。

编辑：我在尝试使用 FindControl 获取数据源时也遇到了错误。FindControl 返回了一个空值，所以当我访问数据源时，我遇到了第二个空异常。所以我最终只是直接访问该对象。无论如何，数据源都在设计器文件中声明。所以有了这个，我终于让嵌套的中继器工作了。

```
// Find the Inner DataSource control in this Row.

if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == 
    ListItemType.AlternatingItem || e.Item.ItemType == ListItemType.EditItem)
{
    CellsDataSource.SelectParameters["testRunID"].DefaultValue = 
        DataBinder.Eval(e.Item.DataItem, "TestRunID").ToString();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T15:42:31.723

我认为对 FindControl 的调用返回 null，因为您必须首先在嵌套中继器上调用 FindControl，*然后*在返回的中继器上调用 FindControl。

```
Repeater rpt  = (Repeater)e.Item.FindControl("rptNested");
SqlDataSource s = (SqlDataSource)rpt.FindControl("InnerDataSource"); 
```

# php - 如何检测和调试过时的缓存条目？

> ID：491538
> 
> 赞同：5
> 
> 时间：2009-01-29T13:13:21.697
> 
> 标签：php, debugging, caching, memcached

我正在将 memcached 与 PHP 一起使用，以尝试进行大量缓存以避免数据库读取。我在更新时使缓存无效（应用程序无效）。但是，过时的缓存数据正在成为一个大问题。大多数情况下，这是由于失效中的错误（使错误的密钥失效或忘记使更新上的缓存条目失效）。

在开发/生产过程中是否有任何好的方法来检测/调试这些类型的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T21:15:45.040

最好的办法是在 mysql_query 周围放置一个包装函数。在其中，只需检查查询是对缓存表的更新还是删除，并解析出正在更改的键。这不会花费很长时间来编写，易于测试，并且可以防止您再次忘记缓存失效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T13:20:03.197

您可以使用乐观并发控制，这涉及向表中添加一列（时间戳或等效项，或者只是一个普通的 int）并在进行更新时使用它。以下是您可以如何使用它（如果普通 int 是“版本标签”）：

```
update BlogPost set PublishedOn = :publishedOn, VersionTag = VersionTag + 1
where ID = :id and VersionTag = :versionTag 
```

并且假设时间戳由您的 DBMS 自动更新，这就是使用时间戳完成的方式：

```
update BlogPost set PublishedOn = :publishedOn
where ID = :id and Timestamp = :timestamp 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T10:24:26.143

您可以在应用程序中添加调试代码（在生产期间禁用），该代码执行两次提取 - 一次来自 memcached，一次来自数据库，比较它们并抛出异常/如果它们不同则将错误写入日志文件。这样（会损失一些性能）您可以快速观察旧数据。

当然，这可以进一步细化：

*   添加时间戳字段，如果时间戳比定义的值更接近，则不要抛出错误（可能进程没有时间更新缓存）
*   在指定更新源（脚本/行号）的数据库中添加一个字段。这可以帮助追踪错过缓存失效部分的部分

# java - 如何从 ASP .NET 网站检测客户端上安装的 Java 运行时？

> ID：491541
> 
> 赞同：3
> 
> 时间：2009-01-29T13:14:57.607
> 
> 标签：java, asp.net, applet, version-detection

我有一个托管 Java 小程序的 ASP .NET 网站。Java 小程序需要 Java 运行时版本 1.6 Update 11。

如何检测客户端是否安装了适当的运行时，以便在没有安装的情况下显示信息性消息？

谢谢，

卡尔。

**编辑：**解决方案必须独立于平台。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-29T13:22:57.670

此页面描述了如何并列出了一些允许您使用 JavaScript 检测 Java 的插件：[http ://www.pinlady.net/PluginDetect/JavaDetect.htm](http://www.pinlady.net/PluginDetect/JavaDetect.htm)

除此之外，也试试这个片段：

```
if (navigator.javaEnabled()) {
    //Java is enabled
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-11T19:42:32.673

下面的链接详细介绍了 java 应用程序的部署技巧。

[http://java.sun.com/javase/6/docs/technotes/guides/jweb/deployment_advice.html](http://java.sun.com/javase/6/docs/technotes/guides/jweb/deployment_advice.html)

从链接引用

> Deployment Toolkit 为避免浏览器兼容性问题，Deployment Toolkit ( [deployJava.js](http://java.com/js/deployJava.js) ) 提供了 JavaScript 函数，可自动生成部署 applet 和 Java Web Start 应用程序所需的 HTML。开发人员应该调用这些函数以在各种浏览器中以一致的方式部署他们的解决方案。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-09T19:57:54.080

我的方法是使用 JavaScript`navigator.javaEnabled()`检查是否有可用**的**Java 版本。

然后，您可以`System.getProperty("java.version")`在 Java 小程序本身中使用。这应该足以让您获得版本信息，例如`1.6.0_03`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-16T04:22:49.303

尽管到目前为止大多数答案都是围绕用户代理（浏览器）本身的检测，但从您提到的 ASP.NET 中听起来您希望在服务器端进行这种检测。如果是这样，您有几个选择。

首先，您可以嗅探来自用户代理的 HTTP 请求标头。安装了 Java 的计算机和浏览器通常会包含一个标头，该标头向您可以获取的服务器提供此提示。以下是有关此方法的一些有用链接：http: [//www.developershome.com/wap/detection/](http://www.developershome.com/wap/detection/) [https://metacpan.org/pod/HTTP::Browscap](https://metacpan.org/pod/HTTP::Browscap)

您拥有的另一个选择是将javascript发送到用户代理以使用此问题中其他答案中的一种技术执行检测，然后使用ajax回调告诉服务器您发现了什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T20:00:16.003

如果您不介意使用需要运行更旧版本的基本 Java 小程序，您可以使用[本文](http://www.javatester.org/version.html)并根据该结果继续。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T16:21:16.267

也许这个脚本会有所帮助。不过，这仅适用于 Windows。

```
<script language='javascript' type='text/javascript'>
var javaVersion;
var shell;
try 
{
    // Create WSH(WindowsScriptHost) shell, available on Windows only
    shell = new ActiveXObject("WScript.Shell");

    if (shell != null) 
    {
        // Read JRE version from Window Registry
        try 
        {
            javaVersion = shell.regRead("HKEY_LOCAL_MACHINE\\Software\\JavaSoft\\Java Runtime Environment\\");
        } 
        catch(e) 
        {
            // handle exceptions raised by 'shell.regRead(...)' here
            // so that the outer try-catch block would receive only
            // exceptions raised by 'shell = new ActiveXObject(...)'
            alert('error reading registry');
        }
    } 
} 
catch(e) 
{
    // Creating ActiveX controls thru script is disabled 
    // in InternetExplorer security options 

    // To enable it: 
    // a. Go to the 'Tools --> Internet Options' menu
    // b. Select the 'Security' tab
    // c. Select zone (Internet/Intranet)
    // d. Click the 'Custom Level..' button which will display the
    // 'Security Settings' window.
    // e. Enable the option 'Initialize and script ActiveX controls
    // not marked as safe'

    activeXDisabled = true;
} 

// Check whether we got required (1.6) Java Plugin
if ( javaVersion != null && javaVersion.indexOf("1.6")) 
{
    pluginDetected = true;
    alert('it is installed!')
}

if (pluginDetected) 
{
    // show applet page
} 
else if (confirm("Java Plugin 1.6 not found")) 
{
    // show install page
    alert('not found')
} 
else 
{
    // show error page
    alet('error')
}
</script> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T12:45:46.717

如果解决方案必须独立于平台。我将排除 javascript 提供的所有解决方案。

您可以编写一个非常简单的 Applet，它由老式的 Classic VM 支持。让小程序检测 JRE 版本，并显示消息。

如果您接受 Javascript，您可能还会对[这篇](http://java.sun.com/developer/technicalArticles/JavaLP/javawebstart/AutoInstall.html.)关于 WebStart 应用程序的自动安装程序的文章感兴趣。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-13T06:00:44.953

1.  使用[deployJava.js](http://java.com/js/deployJava.js)函数 getJREs() 根据用户的 Java 版本构建动态页面。

2.  使用[http://cowwoc.blogspot.com/2008/12/tracking-java-versions-using-google.html](http://cowwoc.blogspot.com/2008/12/tracking-java-versions-using-google.html)通过 Google Analytics 跟踪您的网络访问者使用的 Java 版本。

3.  奖励步骤：使用[步骤 2](http://code.google.com/p/jre-analytics/source/browse/trunk/jre-analytics.js)中的源代码作为如何实施步骤 1 的示例。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-14T20:28:34.733

只需复制并粘贴此代码到您的浏览器地址栏中！检查它是否对您有用。

```
javascript: for(i = 0; i < navigator.plugins.length; i++) alert(navigator.plugins[i].name); 
```

您需要获取 Java 在 plugins 数组中的位置，也许您可​​以使用正则表达式或其他方式检查版本。您可以查看插件 javascript 对象。

问候！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-03-13T09:22:37.697

检查这个

[http://simple-java-detection-script.blogspot.com/2010/03/simple-browser-java-installed-or.html](http://simple-java-detection-script.blogspot.com/2010/03/simple-browser-java-installed-or.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-22T17:42:59.090

下面的链接是我让它工作的方式。它有一个你可以获得的 JS，它是为 Java 部署而制作的。上面提到了该链接，但我认为有一个示例会很好。

这些是我最终需要解决我的问题的示例。

[http://download.oracle.com/docs/cd/E17409_01/javase/6/docs/technotes/guides/jweb/deployment_advice.html#deplToolkit](http://download.oracle.com/docs/cd/E17409_01/javase/6/docs/technotes/guides/jweb/deployment_advice.html#deplToolkit)

一旦你下载了 deployJava.js 文件，你可以放一些东西来确保安装了 java： `if (deployJava.getJREs().length > 0) { //Your code to start java }`

确保安装了特定版本： `if (deployJava.versionCheck(version)) { //Your version specific code }`

启动最新 Java 的安装程序： `deployJava.installLatestJava();`

或者如果您愿意，可以选择特定版本： `deployJava.installJRE(version);`

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-02-09T16:38:46.553

复制并粘贴到您的浏览器地址栏中以检查：

javascript:alert(navigator.javaEnabled())

适用于 Mozilla (FF3) 和 IE7。(x64)

# sharepoint - Sharepoint 是大型 ERP 应用程序的正确平台吗？

> ID：491542
> 
> 赞同：8
> 
> 时间：2009-01-29T13:15:08.510
> 
> 标签：sharepoint, erp

我的任务是在 Sharepoint 中开发一些大型 ERP 应用程序（一些遗留应用程序正在重写和一些新应用程序）。随着我在 Sharepoint 中的快速发展，我看到了创建团队网站的价值和便利性，我在网上和书中找到的示例都是针对 Intranet 部门门户或简单的业务线应用程序量身定制的没有大型遗留 ERP 系统的公司。我已经开始相信，如果要创建一个大型应用程序来连接多个不同的遗留系统并跨越多个部门，那么在 Sharepoint 中构建自定义 Web 部件并不是可行的方法。

**Sharepoint 是用于创建和托管大型 ERP 应用程序的可行应用程序框架吗？**

如果是这样，任何人都可以请我参考描述这种系统架构的参考资料吗？

如果没有，谁能指出我可以引用作为不使用它的论据的参考资料？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-25T23:54:34.807

作为过去 15 年一直在编写 ERP 应用程序的人，我会说 Sharepoint 将是构建 ERP 产品的一个非常糟糕的选择。

*   Sharepoint 表结构对于生成报告非常无效。
*   验证数据的能力非常有限。
*   我知道没有原生支持来维护文档之间关系的完整性。

Sharepoint 可以很好地作为现有 LOB 应用程序的门户，而不是作为在其上构建数据丰富的应用程序的平台。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T13:34:57.130

我目前正在为客户部署一个用 Sharepoint 编写的 ERP 系统。我已经为此工作了大约一年，据我所见，Sharepoint 引入了尽可能多的障碍，因为它使事情变得更加复杂。

事情变得更简单：

*   凭据自动同步到 AD。
*   开箱即用的文档处理和版本控制。
*   出色的 Office 集成。

糟糕的事情：

*   你需要学习 Sharepoint 的做事方式。
*   您的 ERP 中有另一个依赖项。
*   它很笨重。

我建议在做出决定之前阅读[Real World SharePoint 2007：来自 16 个 MOSS 和 WSS MVP 的不可或缺的经验](https://rads.stackoverflow.com/amzn/click/com/0470168358)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T14:03:13.733

我在工作中使用 SharePoint 2007 (MOSS) 作为大型 ERP 安装的一部分。我们大量使用业务数据目录与外部系统交互，并使其数据在我们的 MOSS 门户中可见和可搜索。

在我们的架构中，对 ERP 数据的 CRUD 操作在我们的 ERP 业务线系统中处理。然后，MOSS 和 BDC 将数据从 ERP 数据库中提取出来，并将其显示为嵌入在各种门户页面中的数据网格。例如，HR 站点有一个 MOSS 页面，用于跟踪待处理绩效报告的当前状态。

MOSS 和 BDC 的另一个引人注目的特性是能够将 BDC 数据源公开给 MOSS 搜索服务。例如，当用户使用 MOSS 搜索搜索 John Smith 时，John Smith 的公共 ERP 记录与搜索结果内联。单击搜索结果中的链接会将用户重定向到我们 ERP 系统中的正确页面，而不是将他们带到 MOSS 页面。

我们不将 MOSS 专门用作 ERP 系统，但我们确实将其用作 ERP 系统之上的表示和报告层。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T21:14:49.353

在 SharePoint 中构建自定义 Web 部件不是复杂遗留系统的方法。

如果您为主导航创建了一个自定义导航提供程序（例如，基于 xml 文件），SharePoint*仍然会给您带来很多好处。*这将允许自定义 asp.net 页面显示“喜欢”它们仍然是 SharePoint 的一部分，给人一种无所不包的应用程序的错觉。

我认为人们想要一个巨大的应用程序的唯一原因更多地与信息架构、外观和可查找性有关，而不是任何技术架构的原因。

一个解决方案可以为适当的应用程序创建单独的网站，这些应用程序仍然被蒙皮并链接到 SharePoint 信息体系结构中，并且仍然可以从主界面搜索，这可以解决 ERP 的“企业”部分的“需求”，同时仍然为哪些内容创建适当的解决方案。真正独立的应用程序。

我使用的心智模型不是在“在”SharePoint 中构建应用程序，而是在 SharePoint 中创建一个“窗口”来公开应用程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T13:29:46.127

MS Dynamics AX 系统广泛使用 Sharepoint，事实上，有一些工具包允许用户构建 Web 部件等，直接从基本 AX 对象中提取数据。这是一个关于 Sharepoint 集成[AX+SP](http://www.microsoft.com/dynamics/ax/product/sharepointintegration.mspx)的链接。目前仍有很大一部分 AX 不在 Sharepoint 中，但它们的方向似乎是 Sharepoint 启用了应用程序的很大一部分。我不认为整个 ERP 系统可以驻留在 Sharepoint 基础架构中，但从 MVC 的角度来看，它肯定可以成为您的 View 基础架构。在我看来，这正是 MS 前进的方向，但我只是对他们的未来计划做出假设。

# architecture - 是否有任何编程语言的变量类型大小取决于平台（32 位与 64 位）？

> ID：491548
> 
> 赞同：4
> 
> 时间：2009-01-29T13:18:53.230
> 
> 标签：architecture, programming-languages, platform

我是 C# 开发人员，我几乎可以肯定，在这种语言中，“int”始终为 32 位，无论平台如何（32 位与 64 位），“long”始终为 64 位，float 为 32，double 为 64，并且很快。

有什么语言不是这样的吗？int 大小取决于处理器？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-29T13:23:23.190

C/C++ 中 int 等的大小没有正式定义——它们是特定于编译器的；[请参阅此处](http://home.att.net/~jackklein/c/inttypes.html#int)了解更多详细信息。

谢天谢地，C# 设计人员在规范中正式规定：int = System.Int32、long = System.Int64 等 - 因此您不必担心它会发生变化。x64 上唯一明显的区别是`IntPtr.Size`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T13:27:06.303

例如，在 C++ 中，*int*被定义为处理器的“自然”字长。如果您查看*limits.h*（或*climits*，它们都是标准库的一部分），您将看到 INT_MIN 和 INT_MAX 常量，它们定义了*int*类型的有效范围。INT_MIN 要求为 -32767 或更小，INT_MAX 要求至少为 32767。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T13:29:02.120

正如[这个问题](https://stackoverflow.com/questions/477750#477769)中提到的：

[整数常数折叠的分类和形式化验证](http://www.jblech.de/Glesner-Blech-COCV-2003.pdf)

> Java 语言规范准确定义了**整数如何表示以及如何计算整数算术表达式**。这是 Java 的一个重要属性，因为这种编程语言被设计用于 Internet 上的分布式应用程序。**Java 程序需要独立于执行它的目标机器来产生相同的结果**。
> 
> 相比之下，C（以及大多数广泛使用的命令式和面向对象的编程语言）更加草率，并且留下了许多重要特征。这种不准确的语言规范背后的意图很明确。通过使用内置在目标处理器中的算术运算实例化源程序的整数算术，相同的 C 程序应该在 16 位、32 位甚至 64 位架构上运行。这导致代码效率更高，因为它可以直接使用可用的机器操作。只要整数计算只处理“足够小”的数字，就不会出现不一致。
> 
> 从这个意义上说，C 整数算术是一个占位符，它没有完全由编程语言规范定义，而只是通过确定目标机器来完全实例化。
> 
> Java 精确地定义了如何表示整数以及如何计算整数算术。

```
 Java Integers
--------------------------
Signed         |  Unsigned
--------------------------
long  (64-bit) |
int   (32-bit) |
short (16-bit) |  char (16-bit)
byte  (8-bit)  | 
```

> Char 是唯一的无符号整数类型。它的值表示 Unicode 字符，从`\u0000`到`\uffff`，即从 0 到 2 ^(16) -1。
> 
> **如果整数运算符具有 long 类型的操作数，则另一个操作数也将转换为 long 类型。否则，对 int 类型的操作数执行操作，如有必要，较短的操作数将转换为 int**。转换规则是精确指定的。

[摘自《理论计算机科学电子笔记》 82 No. 2 (2003)
Blesner-Blech-COCV 2003：[Sabine GLESNER](http://pes.cs.tu-berlin.de/pes/index.php.html) , Jan Olaf BLECH,
Fakultät für Informatik,
Universität Karlsruhe
Karlsruhe, Germany]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T13:27:23.573

允许 C 和 C++ 具有可变大小的 int……据我所知，唯一的要求是 small <= int <= long。因此，编译器当然可以在 32 位机器上生成 32 位整数，在 64 位机器上生成 64 位整数。

顺便说一句，C# 中浮点数和双精度数的大小仅用于存储 - 变量允许使用额外的精度。所以以下条件：

```
class Foo
{
  private float _v = ...; // Definitely 32-bit.

  void Test()
  {
    var v = _v; // Could be 32-, 64-, or 96-bit.

    if(v == _v) {
      ...
    }
  }
} 
```

可以执行也可以不执行。（在撰写本文时，如果可以，CLR 通常会在释放模式下使用 96 位 FP 寄存器）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T13:28:45.300

正如 Marc Gravell 在 C++ 中所说，唯一为所有平台定义了官方几乎固定大小的类型是**char** >= **8 bits**。

其他类型比 char 大，但它们的大小与平台/编译器实现有关。该标准仅指定女巫应大于其他女巫。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T13:32:01.957

c# 确实提供了一种类型，其大小取决于可执行文件[IntPtr的处理器、操作系统和位数标志](http://msdn.microsoft.com/en-us/library/system.intptr.aspx)

此外，任何本身拥有引用类型的类型在 32/64 位上的大小都会有所不同，因为相应的引用本身是 32/64 位的。

CLR 提供了以下类型，这些类型都是可变大小的，具体取决于位数：

*   本机 int
*   本机无符号整数
*   本机引用（即指针）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T13:32:35.560

所有 C/C++ 标准都规定了不同数据类型大小之间的序数关系。根据实现的不同，大小可能会有所不同，并且很可能会随着您正在构建的 CPU 架构而有所不同；事实上，在 GCC 下，long 总是字长的（Linux 内核代码依赖于这个保证）。

良好的编程习惯意味着使用 sizeof() 而不是硬编码的大小。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T14:20:49.517

float 和 double 的大小是 IEEE 标准，而不是计算机标准。这就是为什么 C#、Java、C、C++ 和所有其他实现 float 和 double 的语言都有完全相同的舍入问题，并且不能真正用于货币计算或任何需要精度的计算。

short、int 和 long 的大小由语言规范定义。但是，您不希望它们完全任意，因为在使用这些数字进行计算时可能会导致任意行为。它们也可能是 IEEE 标准，但我不确定。

# java - 速度并忽略 java 方法返回

> ID：491549
> 
> 赞同：0
> 
> 时间：2009-01-29T13:19:04.807
> 
> 标签：java, return-value, velocity

我想在 Velocity 宏的列表中添加一个元素。这是避免“真实”文本出现在 Velocity 输出中的唯一方法吗？

```
#set($path = [])
#set($swallow = "a")

#set ($swallow = $path.add("blaablaa")) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-02T22:33:41.970

是的，如果你想闭嘴，那么#set 就是你的朋友。许多人使用这样的宏来简化它：

```
#macro( call $this )#set( $stfu = $this )#end 
```

然后你可以缩写为

```
#call( $path.add('blaablaa') ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T14:02:02.537

我必须同意 Terence Parr（[StringTemplate之父）的观点，他在](http://www.stringtemplate.org/)[Artima 采访](http://www.artima.com/lejava/articles/stringtemplate.html)中发表了相关评论，并发表[了一篇关于模型视图分离的好论文](http://www.cs.usfca.edu/~parrt/papers/mvc.templates.pdf)。

模板应仅限于纯粹的展示。正如我们不应该将表示层的细节放在模型中一样，我们也不应该将数据操作放在我们的模板中。做任何一个通常都会使维护变得更加困难，甚至更难知道*在哪里*进行维护。

根据我自己对 Velocity 和 StringTemplate 的经验，我强烈建议您将问题中的问题（数据操作的工件使模板更复杂）作为提示，并将所有数据结构的操作移至 Java 层。

# git - 如何将 git 存储库转换为 mercurial？

> ID：491554
> 
> 赞同：106
> 
> 时间：2009-01-29T13:21:33.537
> 
> 标签：git, version-control, mercurial, tortoisehg

我一直在使用 git 作为源代码存储库开发一个 java 应用程序。我想与其他 java 开发人员共享该项目，而 hg 似乎是他们最常用的。

我的问题是如何将 git 存储库转换为 hg？

如果我尝试使用谷歌搜索“将 git 转换为 hg”，并且每次搜索命中都是关于从 hg 转换为 git。我也在使用[TortoiseHg](http://tortoisehg.sourceforge.net/)。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-01-29T14:53:04.850

该[`hg convert`](https://www.mercurial-scm.org/wiki/ConvertExtension)实用程序在安装后默认情况下未打开。为了将其设置为这样，请将以下内容添加到您的`.hgrc`文件中。

```
[extensions]
hgext.convert= 
```

如果您在 Windows 上使用[TortoiseHg](https://tortoisehg.bitbucket.io/)，则此文件位于您的主目录中，为`mercurial.ini`. 更改此设置后，您将能够使用该`hg convert`实用程序。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-01-29T13:36:43.367

通过使用[Mercurial Convert 扩展](https://www.mercurial-scm.org/wiki/ConvertExtension)

> 将以下行添加到您的`.hgrc`or 以启用扩展：

```
[extensions]
hgext.convert= 
```

并输入

```
cd src
hg convert --datesort . dst 
```

（即使它可能[导致一些问题](https://www.mercurial-scm.org/pipermail/mercurial/2007-December/016061.html)......）

注意：：[metrix](https://stackoverflow.com/users/969879/metrix)报告这可能不起作用：

```
 hg convert --datesort src dst 
```

> **注意：**`hg convert`如果您从源目录以外的目录执行此命令，则会出现错误。
> 您将收到以下错误：

```
abort: cannot read tags from git-repo4/.git 
```

> 在 Windows XP 上使用 git 1.7.9 和 Mercurial 2.6.2 确认

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2010-06-11T05:51:15.907

您可能想查看[http://hg-git.github.com/](http://hg-git.github.com/)实用程序：Mercurial 的 Git 插件

该插件最初由 GitHub 开发，允许从 git<->mercurial 无损转换。理论上，您甚至可以克隆 hg 存储库。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-29T13:33:04.857

[Mercurial](http://hgbook.red-bean.com/hgbookch1.html)状态的分布式修订控制：

> convert 支持的版本控制工具如下：
> 
> *   颠覆
> *   CVS
> *   吉特
> *   达克斯

所以也许你不需要任何额外的工具？

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-26T01:36:28.217

convert 扩展可能对您有用，但如果不适用，您可能需要查看[定制](http://progetti.arstecnica.it/tailor)工具，它是用于在各种分布式 SCM 之间进行转换的通用工具。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-04-27T03:51:31.803

你根本无法转换它。只需使用[Hg-Git](http://hg-git.github.com/)插件！没有人会知道其中的区别。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-11-13T02:41:47.150

镇上的新玩家：[git-remote-hg](http://felipec.wordpress.com/2012/11/13/git-remote-hg-bzr/)。它在 git 中提供本机桥接支持。

只是：

```
hg init ../hgrepo
git push hg::$PWD/../hgrepo 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-06-07T16:32:10.380

在`Git`包含所有 Git 存储库的文件夹中，我创建了`Git2Hg.cmd`包含以下内容的文件：

```
set PATH=%PATH%;C:\Program Files\TortoiseHg
set PATH=%PATH%;C:\Program Files\Git\bin
hg convert %1 
```

现在我可以通过在 CMD 中输入以下内容将 Git 存储库转换为 Hg：

```
Git2Hg "Folder Name" 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-03-11T09:48:03.440

Hg-Git 插件或者如果你用于 Windows 或从一个迁移到另一个访问这里[2](http://www.appveyor.com/blog/2014/02/23/converting-mercurial-repository-to-git-on-windows) [Windows GIT]

# c# - 如何在即时窗口中轻松查看数据表或数据视图的内容

> ID：491555
> 
> 赞同：90
> 
> 时间：2009-01-29T13:21:39.917
> 
> 标签：c#, .net, asp.net, visual-studio

有时我会在代码中的断点处查看`DataTable`变量（或 a`DataTable`中的 a `DataSet`）的内容。快速观看并不能让您非常清楚地查看内容。如何轻松查看它们？

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2009-01-29T13:40:02.440

Visual Studio 调试器附带四个标准可视化工具。这些是文本、HTML 和 XML 可视化工具，它们都适用于字符串对象，以及数据集可视化工具，适用于 DataSet、DataView 和 DataTable 对象。

要使用它，请进入您的代码，将鼠标悬停在您的数据集上，展开快速查看，查看表格，展开它，然后查看 Table[0]（例如）。您会在快速查看中看到类似 {Table1} 的内容，但请注意还有一个**放大镜图标**。单击该图标，您的 DataTable 将在网格视图中打开。

[![在此处输入图像描述](https://i.stack.imgur.com/rJnyo.png)](https://i.stack.imgur.com/rJnyo.png)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-08-21T09:25:29.437

为了美化 adinas 的调试器输出，我做了一些简单的格式化：

```
 public void DebugTable(DataTable table)
    {
        Debug.WriteLine("--- DebugTable(" + table.TableName + ") ---");
        int zeilen = table.Rows.Count;
        int spalten = table.Columns.Count;

        // Header
        for (int i = 0; i < table.Columns.Count; i++)
        {
            string s = table.Columns[i].ToString();
            Debug.Write(String.Format("{0,-20} | ", s));
        }
        Debug.Write(Environment.NewLine);
        for (int i = 0; i < table.Columns.Count; i++)
        {
            Debug.Write("---------------------|-");
        }
        Debug.Write(Environment.NewLine);

        // Data
        for (int i = 0; i < zeilen; i++)
        {
            DataRow row = table.Rows[i];
            //Debug.WriteLine("{0} {1} ", row[0], row[1]);
            for (int j = 0; j < spalten; j++)
            {
                string s = row[j].ToString();
                if (s.Length > 20) s = s.Substring(0, 17) + "...";
                Debug.Write(String.Format("{0,-20} | ", s));
            }
            Debug.Write(Environment.NewLine);
        }
        for (int i = 0; i < table.Columns.Count; i++)
        {
            Debug.Write("---------------------|-");
        }
        Debug.Write(Environment.NewLine);
    } 
```

最佳解决方案：**您不需要 Visual Studio**！这是我的示例输出：

```
从 verpackungen 中选择 PackKurz、PackName、PackGewicht

包库兹 | 包装名称 | PackGewicht |
----------|----------------------|------ ------|-
BB205 | 大袋 205 公斤 | 205 |
BB300 | 大袋 300 公斤 | 300 |
BB365 | 大袋 365 公斤 | 365 |
一氧化碳 | 容器，Alteru... | |
EP | 调色板 | |
中型散货箱 | Chemikaliengefäß ... | |
输| nicht verpackungs... | 0 |
----------|----------------------|------ ------|-

```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T13:25:43.543

我所做的是在我的项目中有一个包含以下代码的静态类：

```
 #region Dataset -> Immediate Window
public static void printTbl(DataSet myDataset)
{
    printTbl(myDataset.Tables[0]);
}
public static void printTbl(DataTable mytable)
{
    for (int i = 0; i < mytable.Columns.Count; i++)
    {
        Debug.Write(mytable.Columns[i].ToString() + " | ");
    }
    Debug.Write(Environment.NewLine + "=======" + Environment.NewLine);
    for (int rrr = 0; rrr < mytable.Rows.Count; rrr++)
    {
        for (int ccc = 0; ccc < mytable.Columns.Count; ccc++)
        {
            Debug.Write(mytable.Rows[rrr][ccc] + " | ");
        }
        Debug.Write(Environment.NewLine);
    }
}
public static void ResponsePrintTbl(DataTable mytable)
{
    for (int i = 0; i < mytable.Columns.Count; i++)
    {
        HttpContext.Current.Response.Write(mytable.Columns[i].ToString() + " | ");
    }
    HttpContext.Current.Response.Write("<BR>" + "=======" + "<BR>");
    for (int rrr = 0; rrr < mytable.Rows.Count; rrr++)
    {
        for (int ccc = 0; ccc < mytable.Columns.Count; ccc++)
        {
            HttpContext.Current.Response.Write(mytable.Rows[rrr][ccc] + " | ");
        }
        HttpContext.Current.Response.Write("<BR>");
    }
}

public static void printTblRow(DataSet myDataset, int RowNum)
{
    printTblRow(myDataset.Tables[0], RowNum);
}
public static void printTblRow(DataTable mytable, int RowNum)
{
    for (int ccc = 0; ccc < mytable.Columns.Count; ccc++)
    {
        Debug.Write(mytable.Columns[ccc].ToString() + " : ");
        Debug.Write(mytable.Rows[RowNum][ccc]);
        Debug.Write(Environment.NewLine);
    }
}
#endregion 
```

然后我将在即时窗口中调用上述函数之一，结果也会出现在那里。例如，如果我想查看变量“myDataset”的内容，我将调用 printTbl(myDataset)。点击回车后，结果将打印到即时窗口

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-05-19T14:14:41.207

如果您想在任何地方使用它...成为 DataTable 上的助手，这假设您想要将输出捕获到 Log4Net，但我所处理的出色的起始示例只是转储到控制台...这个也有可编辑的列宽变量**nMaxColWidth** - 最终我会从任何情况下传递它......

```
public static class Helpers
    {
        private static ILog Log = Global.Log ?? LogManager.GetLogger("MyLogger");
        /// <summary>
        /// Dump contents of a DataTable to the log
        /// </summary>
        /// <param name="table"></param>
        public static void DebugTable(this DataTable table)
        {
            Log?.Debug("--- DebugTable(" + table.TableName + ") ---");
            var nRows = table.Rows.Count;
            var nCols = table.Columns.Count;
            var nMaxColWidth = 32;

            // Column Headers

            var sColFormat = @"{0,-" + nMaxColWidth + @"} | ";
            var sLogMessage = string.Empty;
            for (var i = 0; i < table.Columns.Count; i++)
            {
                sLogMessage = string.Concat(sLogMessage, string.Format(sColFormat, table.Columns[i].ToString()));
            }
            //Debug.Write(Environment.NewLine);
            Log?.Debug(sLogMessage);

            var sUnderScore = string.Empty;
            var sDashes = string.Empty;
            for (var j = 0; j <= nMaxColWidth; j++)
            {
                sDashes = sDashes + "-";
            }

            for (var i = 0; i < table.Columns.Count; i++)
            {
                sUnderScore = string.Concat(sUnderScore, sDashes + "|-");
            }

            sUnderScore = sUnderScore.TrimEnd('-');

            //Debug.Write(Environment.NewLine);
            Log?.Debug(sUnderScore);

            // Data
            for (var i = 0; i < nRows; i++)
            {
                DataRow row = table.Rows[i];
                //Debug.WriteLine("{0} {1} ", row[0], row[1]);
                sLogMessage = string.Empty;

                for (var j = 0; j < nCols; j++)
                {
                    string s = row[j].ToString();
                    if (s.Length > nMaxColWidth) s = s.Substring(0, nMaxColWidth - 3) + "...";
                    sLogMessage = string.Concat(sLogMessage, string.Format(sColFormat, s));
                }

                Log?.Debug(sLogMessage);
                //Debug.Write(Environment.NewLine);
            }           
            Log?.Debug(sUnderScore);
        }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T13:34:01.577

试试Xml [Visualizer 。](http://www.codeplex.com/XmlVisualizer)还没有尝试过最新版本，但如果没有 Visual Studio 2003 中的前一个版本，我将无法工作。

除了分层显示 DataSet 之外，还有许多其他方便的功能，例如过滤和选择要查看的 RowState。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-12T20:46:32.290

```
public static void DebugDataSet ( string msg, ref System.Data.DataSet ds )
{
    WriteIf ( "===================================================" + msg + " START " );
    if (ds != null)
    {
        WriteIf ( msg );
        foreach (System.Data.DataTable dt in ds.Tables)
        {
            WriteIf ( "================= My TableName is  " +
            dt.TableName + " ========================= START" );
            int colNumberInRow = 0;
            foreach (System.Data.DataColumn dc in dt.Columns)
            {
                System.Diagnostics.Debug.Write ( " | " );
                System.Diagnostics.Debug.Write ( " |" + colNumberInRow + "| " );
                System.Diagnostics.Debug.Write ( dc.ColumnName + " | " );
                colNumberInRow++;
            } //eof foreach (DataColumn dc in dt.Columns)
            int rowNum = 0;
            foreach (System.Data.DataRow dr in dt.Rows)
            {
                System.Diagnostics.Debug.Write ( "\n row " + rowNum + " --- " );
                int colNumber = 0;
                foreach (System.Data.DataColumn dc in dt.Columns)
                {
                    System.Diagnostics.Debug.Write ( " |" + colNumber + "| " );
                    System.Diagnostics.Debug.Write ( dr[dc].ToString () + " " );
                    colNumber++;
                } //eof foreach (DataColumn dc in dt.Columns)
                rowNum++;
            }   //eof foreach (DataRow dr in dt.Rows)
            System.Diagnostics.Debug.Write ( " \n" );
            WriteIf ( "================= Table " + dt.TableName + " ========================= END" );
            WriteIf ( "===================================================" + msg + " END " );
        }   //eof foreach (DataTable dt in ds.Tables)
    } //eof if ds !=null 
    else
    {
        WriteIf ( "NULL DataSet object passed for debugging !!!" );
    }
} //eof method 

public static void WriteIf ( string msg )
{
    //TODO: FIND OUT ABOUT e.Message + e.StackTrace from Bromberg eggcafe
int output = System.Convert.ToInt16(System.Configuration.ConfigurationSettings.AppSettings["DebugOutput"] );
    //0 - do not debug anything just run the code 
switch (output)
{
    //do not debug anything 
    case 0:
        msg = String.Empty;
    break;
        //1 - output to debug window in Visual Studio       
        case 1:
            System.Diagnostics.Debug.WriteIf ( System.Convert.ToBoolean( System.Configuration.ConfigurationSettings.AppSettings["Debugging"] ), DateTime.Now.ToString ( "yyyy:MM:dd -- hh:mm:ss.fff --- " ) + msg + "\n" );
            break;
        //2 -- output to the error label in the master 
        case 2:
            string previousMsg = System.Convert.ToString (System.Web.HttpContext.Current.Session["global.DebugMsg"]);
            System.Web.HttpContext.Current.Session["global.DebugMsg"] = previousMsg +
            DateTime.Now.ToString ( "yyyy:MM:dd -- hh:mm:ss.fff --- " ) + msg + "\n </br>";
            break;
        //output both to debug window and error label 
        case 3:
            string previousMsg1 = System.Convert.ToString (System.Web.HttpContext.Current.Session["global.DebugMsg"] );
            System.Web.HttpContext.Current.Session["global.DebugMsg"] = previousMsg1 + DateTime.Now.ToString ( "yyyy:MM:dd -- hh:mm:ss.fff --- " ) + msg + "\n";
            System.Diagnostics.Debug.WriteIf ( System.Convert.ToBoolean( System.Configuration.ConfigurationSettings.AppSettings["Debugging"] ), DateTime.Now.ToString ( "yyyy:MM:dd -- hh:mm:ss.fff --- " ) + msg + "\n </br>" );
            break;
        //TODO: implement case when debugging goes to database 
    } //eof switch 

} //eof method WriteIf 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-08-28T10:15:58.007

我为它编写了一个小方法..它是一个泛化函数..

```
 public static void printDataTable(DataTable tbl)
    {
        string line = "";
        foreach (DataColumn item in tbl.Columns)
        {
            line += item.ColumnName +"   ";
        }
        line += "\n";
        foreach (DataRow row in tbl.Rows)
        {
            for (int i = 0; i < tbl.Columns.Count; i++)
            {
                line += row[i].ToString() + "   ";
            }
            line += "\n";
        }
        Console.WriteLine(line) ;
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T13:33:31.767

我自己没有尝试过，但 Visual Studio 2005（及更高版本）支持调试器可视化工具的概念。这允许您自定义对象在 IDE 中的显示方式。查看这篇文章了解更多详情。

[http://davidhayden.com/blog/dave/archive/2005/12/26/2645.aspx](http://davidhayden.com/blog/dave/archive/2005/12/26/2645.aspx)

# c# - 为 ASP.NET MVC (C#) 和 LINQ-to-SQL 中的视图上显示的 SQL 表实现过滤器？

> ID：491563
> 
> 赞同：0
> 
> 时间：2009-01-29T13:24:24.093
> 
> 标签：c#, asp.net-mvc, database, linq-to-sql, filtering

[这个问题](https://stackoverflow.com/questions/488061/passing-multiple-parameters-to-controller-in-asp-net-mvc-also-generating-on-the/488127#488127)的后续，我已经改变了我的控制器和路由，所以现在排序值由 ?sort= 分配，但是我还想实现用户根据一组选择的值过滤表的能力：

技术员：Tech1、Tech2、Tech3 等 类别：Category1、Category2、Category3 等 优先级：Priority1、Priority2、Priority3 等

我目前只使用一个表，因此获取要过滤的可用类别列表的最简单方法是从表中选择不同的类别值。它们都是通过 HTML 输入的，因此我可以控制放入的内容。我还不想将它们全部拆分到不同的表中，我现在正在尝试尽可能多地使用一张表，但是如果这是打破单表模型的情况，然后很好，我可以调整。

为了阐明用例，最好显示相关视图的快速屏幕截图：

[http://images.robburke.ie/stackoverflow/491563.png
点击查看全尺寸。](http://images.robburke.ie/stackoverflow/491563.png)

我想实现一个系统，例如，用户可以过滤“优先级”以仅显示优先级为“调查”的问题。

我正在寻找有关如何在前端和后端实现此功能的建议。我试图找到一个与数据表做类似事情的网站，但我想不出一个我的头顶，尽管我确信这是一个以前已经实现过一百次的功能！

谁能推荐一个好方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T15:00:16.660

## 服务器层

让我们从一些伪代码开始。

```
public ActionResult Open(string sort, string technician, 
    string category, string priority)
{
    // generate query
    // filter stuff
    // order/sort stuff
} 
```

在这里得到正确的操作顺序很重要。某些 IQueryable 提供者（*我在看你，实体框架*）如果在过滤之前出现排序，则会默默地忽略排序。因此，首先生成一个无序、未过滤的查询，就像上一个问题一样，然后附加过滤，最后附加排序。

请注意，对于每个可能的过滤情况，我都为您的操作添加了一个参数。这是一种方法。查看其他方法是允许过滤几乎所有内容，方法是迭代查询字符串参数（在请求内部），将任何不称为“排序”的内容视为潜在过滤器。您应该选择最适合您的应用程序的。

现在，您如何实际实现过滤？马克展示的是一种方式。如果您只打算过滤某些情况，那将非常有效。显然，我会把它放在一个辅助方法中，而不是放在动作本身中。您很有可能需要重用此帮助程序和其他操作。但是，如果您打算在一个方法中提供的行数多于您想在单个方法中说明的行数，则另一种方法是使用 Microsoft Dynamic LINQ 库，您可以从 CodePlex 获得该库。这允许您使用字符串而不是 lambda 表达式来构建 LINQ .Where。

## 浏览器层

现在您的应用程序可以处理此问题，您需要一种创建链接的方法，如下所示：

[http://example.com/Issue/Open?sort=ID&priority=Investigative](http://example.com/Issue/Open?sort=ID&priority=Investigative)

例如，如果您有一个过滤器选项菜单，则每个菜单项将对应一个具有不同查询字符串参数的链接。

这有点棘手，因为您可能希望在添加新的查询字符串参数时保留现有的查询字符串参数。例如，如果用户已按 ID 对未决问题进行排序，并选择仅过滤调查优先级问题，您仍希望保留排序。所以菜单中的所有链接都需要包含当前显示页面的查询字符串参数以及菜单项本身的查询字符串参数。

因此，我们在执行此操作时采用的一般方法是，对于“过滤菜单”（或您的建筑物的任何链接）中的每个项目：

1.  创建查询字符串参数的 RouteValueDictionary
2.  将传递给当前视图的所有查询字符串参数添加到字典中。
3.  为当前菜单项添加额外的查询字符串参数。
4.  使用 Html.RouteLink 和我们构建的字典生成最终 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T13:30:44.907

我不完全理解用例 - 但您可以通过以下方式轻松添加过滤器`IQueryable<T>`：

```
var query = /* your primary query */

if(!string.IsNullOrEmpty(name)) {
    query = query.Where(row => row.Name == name);
}

if(activeOnly) {
    query = query.Where(row => row.IsActive);
} 
```

等等

您可以通过`Expression`手动构建来做更复杂的事情，但以上具有易于调试和编译器检查的优点（编译器将确保有合适的`IsActive`属性等）

# sql - 如何获取 GROUP_BY 子句中的值列表？

> ID：491566
> 
> 赞同：49
> 
> 时间：2009-01-29T13:25:31.127
> 
> 标签：sql, group-by, sybase

如果我在表格中有这样的数据

```
id   data
--   ----
1    1
1    2
1    3
2    4
2    5
3    6
3    4 
```

如何在查询中（在 sybase 服务器上）获得这样的结果？

```
id   data
--   ----
1    1, 2, 3
2    4, 5
3    6, 4 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-30T03:37:09.443

我知道在 MySQL 中有[GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)而在 Sybase 我认为它是[LIST](http://www.eggheadcafe.com/software/aspnet/28523243/-concatenate-string-us.aspx)，如另一个答案中所述：

```
SELECT id, LIST(data||', ')
FROM yourtable
GROUP BY id 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2019-01-10T09:19:29.697

在 mysql 中，使用

```
SELECT id, GROUP_CONCAT(data)
 FROM yourtable
 GROUP BY id 
```

或使用您的自定义分隔符：

```
SELECT id, GROUP_CONCAT(data SEPARATOR ', ')
 FROM yourtable
 GROUP BY id 
```

见[GROUP_CONCAT](https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_group-concat)。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-02-27T01:26:56.870

对于 PostgreSQL，使用类似的函数[string_agg](http://www.postgresql.org/docs/9.1/static/functions-aggregate.html)。

```
SELECT id, string_agg(data, ',')
FROM yourtable
GROUP BY id 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-29T13:56:10.597

在 MsSQL 中你可以使用一个函数（不知道 SyBase 中是否有类似的东西）

```
CREATE FUNCTION [dbo].[GetDataForID]
(
    @ID int
)
RETURNS varchar(max)
AS
BEGIN
    declare @output varchar(max)
    select @output = COALESCE(@output + ', ', '') + data
    from table
    where ID = @ID

    return @output
END
GO 
```

接着：

```
SELECT ID, dbo.GetDataForID(ID) as Data
FROM Table
GROUP BY ID 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-09-18T10:02:44.833

在 PL/SQL 中，您可以通过以下方式完成：

```
SELECT id, LISTAGG(data, ',') WITHIN GROUP(ORDER BY 0) "data"
  FROM yourtable
 GROUP BY id 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-29T13:40:08.257

您不能在普通 SQL 中的直接 GROUP BY 中执行此操作。您必须使用游标（或类似结构）手动连接每个组中的值。

*   Oracle 允许您定义一个自定义聚合器，该聚合器将在 PL/SQL 中执行此连接。
*   SQL Server 允许您在 .NET 中定义一个自定义聚合器，它也可以执行此操作。
*   不过，我不确定 Sybase 有哪些用于定义自定义聚合器的选项。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-04-08T11:46:27.210

对于 SQL 服务器：

```
SELECT id, STRING_AGG(data, ',')
FROM your_table
GROUP BY id; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-26T18:37:23.180

试试这个：

```
SELECT id,
       GROUP_CONCAT(data)
FROM   table
GROUP BY id 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-29T13:40:55.463

我认为您将不得不使用光标（[http://manuals.sybase.com/onlinebooks/group-as/asg1250e/sqlug/@Generic__BookTextView/50501;pt=50305](http://manuals.sybase.com/onlinebooks/group-as/asg1250e/sqlug/@Generic__BookTextView/50501;pt=50305)）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-11-19T21:36:52.647

对于 Presto，使用[array_agg](https://prestodb.io/docs/current/functions/aggregate.html)

```
SELECT id, array_agg(data)
FROM yourtable
GROUP BY id 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-02-11T15:10:54.510

在 SQL Server 中：

```
select distinct b.id, data=STUFF((select ',' +convert(varchar,id)
from yourtable a
where a.id=b.id
for xml path ('')),1,1,'')
from yourtable b 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-29T13:52:20.200

自从我尝试使用该语法已经有几年了，我不再可以访问 iAnywhere 实例，但是有一个聚合函数（列表）可以完成这样的任务。我无法确认 LIST() 是否仍受支持。

```
SELECT id,
       LIST(data)
FROM   table
GROUP BY id 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-05-30T13:03:31.400

对于 SparkSQL（例如查询 AWS Athena 时）：

```
SELECT id, ARRAY_JOIN(ARRAY_AGG(data), ',')
FROM your_table
GROUP BY id; 
```

# audio - 如何将语音转换为文本？

> ID：491578
> 
> 赞同：44
> 
> 时间：2009-01-29T13:29:02.197
> 
> 标签：audio, speech-to-text

如何获取 MP3 并将语音转换为文本？

我有一些会议记录和会议记录（录音中只有一个声音，这是我的声音）。我认为使用语音转文本工具而不是简单地手动转录会更容易且在智力上很有趣。我知道有一些技术，特别是对于使用 Asterisk 和 Podcast 的 VoIP 应用程序，但它们是什么以及如何使用它们？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-29T14:02:11.817

开源：[CMU Sphinx](http://sourceforge.net/projects/cmusphinx)

共享软件： [http](http://www.e-speaking.com/) ://www.e-speaking.com/ (Windows)

广告： [Dragon NaturallySpeaking](http://www.nuance.com/naturallyspeaking/products/audiomining.asp) (Windows)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-03-23T20:24:33.713

.NET 可以使用它的 System.Speech 命名空间来做到这一点。

您必须先转换为 .wav 或从麦克风实时捕获音频。

可以在此处找到有关实施的详细信息： [使用 .NET 转录音频](http://ellismis.com/2012/03/17/converting-or-transcribing-audio-to-text-using-c-and-net-system-speech/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-29T13:56:52.217

[Dragon NaturallySpeaking](http://www.nuance.com/naturallyspeaking/products/audiomining.asp)似乎支持 MP3 输入。

如果你想要一个[开源版本](http://www.speech.cs.cmu.edu/)（我认为有一些基于这个的 Asterisk 集成项目）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-11-30T13:16:12.047

聚会迟到了，所以回答更多以备将来参考。

该领域的进步 + Mozilla 的思维方式和议程导致了这两个项目的实现：

*   [深度演讲](https://github.com/mozilla/DeepSpeech)
*   [共同的声音](https://voice.mozilla.org/data)

后者有一个 12GB 的数据集供下载。据我了解，前者允许使用您自己的音频文件训练模型

# iphone - iPhone 向 Google Apps 发送数据和从 Google Apps 检索数据？

> ID：491584
> 
> 赞同：2
> 
> 时间：2009-01-29T13:31:33.360
> 
> 标签：iphone, google-apps

我见过几个 iPhone 应用程序具有将数据导出到 Google Apps 文档或电子表格的功能。我想在我的 iPhone 应用程序中添加类似的功能。有那个API吗？另一个方向怎么样 - 有没有办法从 Google Apps 电子表格中获取数据（比如 CSV 文件）？

如果没有这些，有没有办法直接在 iTunes 中导入 SQLite 转储文件？

背景：我正在编写的应用程序处理大量记录，可能有数千条记录，而不是期望人们在那个小小的键盘上输入它们，我希望能够获取在真实计算机上输入的数据。另外，这个 iPhone 应用程序正在替换我已经使用的 Palm 应用程序，我已经输入了数百条记录，但它能够生成 CSV 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T13:48:20.893

查看 Google 的 Doc List API 关于[上传文档](http://code.google.com/apis/documents/docs/2.0/developers_guide_protocol.html#UploadingDocs)。相同的 API 参考包含有关检索文档的信息。

这是从 Google[上传的文档示例。](http://googledataapis.blogspot.com/2008/01/easily-upload-your-documents-to-google.html)

# .net - 扩展 LDAP 成员资格以将前缀/后缀附加到用户名

> ID：491587
> 
> 赞同：0
> 
> 时间：2009-01-29T13:32:04.780
> 
> 标签：.net, asp.net, active-directory, membership

我们的 Web 应用程序使用**LDAP Membership Provider**在 Active Directory 中验证和注册用户。为了允许用户提供其他应用程序中存在的用户名，我们需要在其用户名中添加一个前缀，并且它应该尽可能透明和无痛。

我需要一种扩展 LDAP 成员资格提供程序的方法，以便能够在成员身份验证或注册之前向用户名添加（连接）前缀。例如，如果应用程序 1 中的用户输入是“ *JohnS* ”......我想验证：“ **App1_JohnS** ”。

**我怎样才能扩展会员资格来实现这一目标？知道在身份验证和注册（创建用户）之前触发了什么吗？**

更新：每个 Web 应用程序在 AD 中都有一个“OU”，用于创建用户并从中进行身份验证。但由于它只是一个 Active Directory 控制器，因此用户名必须是唯一的。我们需要使用会员服务提供商来解决这个问题，而不是添加更多的广告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T13:39:49.117

当您构建搜索查询字符串时，为什么不将前缀附加到您正在搜索的 DN（或 Uid）？

如果您遇到无法修改的应用程序，那么我建议您使用 AD 组来实现该功能 - 您使用单个用户帐户对 AD 进行身份验证。然后，您可以检索它的所有属性，如果用户设置了组，则授予对相应应用程序的访问权限。

修改用户所在的组对于您的 AD 管理员来说是一件小事，或者如果您对目录具有写入权限，您也可以自己完成。

# c# - 在 C# 中解析命令行参数的最佳方法是什么？

> ID：491595
> 
> 赞同：731
> 
> 时间：2009-01-29T13:33:28.240
> 
> 标签：c#, .net, command-line-arguments

在构建带参数的控制台应用程序时，您可以使用传递给`Main(string[] args)`.

在过去，我只是简单地索引/循环该数组并执行了一些正则表达式来提取值。但是，当命令变得更复杂时，解析会变得非常难看。

所以我感兴趣：

*   您使用的库
*   您使用的模式

假设命令始终遵守通用标准，例如在[此处回答](https://stackoverflow.com/questions/108728/suggestions-for-implemetation-of-a-commnd-line-application-interface)。

* * *

## 回答 #1

> 赞同：324
> 
> 时间：2010-01-14T22:06:25.820

我强烈建议使用[NDesk.Options](http://www.ndesk.org/Options)（[文档](http://www.ndesk.org/doc/ndesk-options/)）和/或[Mono.Options](https://github.com/mono/mono/blob/master/mcs/class/Mono.Options/Mono.Options/Options.cs)（相同的 API，不同的命名空间）。文档中的一个[示例](http://www.ndesk.org/doc/ndesk-options/NDesk.Options/OptionSet.html#T:NDesk.Options.OptionSet:Docs:Example:1)：

```
bool show_help = false;
List<string> names = new List<string> ();
int repeat = 1;

var p = new OptionSet () {
    { "n|name=", "the {NAME} of someone to greet.",
       v => names.Add (v) },
    { "r|repeat=", 
       "the number of {TIMES} to repeat the greeting.\n" + 
          "this must be an integer.",
        (int v) => repeat = v },
    { "v", "increase debug message verbosity",
       v => { if (v != null) ++verbosity; } },
    { "h|help",  "show this message and exit", 
       v => show_help = v != null },
};

List<string> extra;
try {
    extra = p.Parse (args);
}
catch (OptionException e) {
    Console.Write ("greet: ");
    Console.WriteLine (e.Message);
    Console.WriteLine ("Try `greet --help' for more information.");
    return;
} 
```

* * *

## 回答 #2

> 赞同：197
> 
> 时间：2011-09-07T07:29:53.247

我真的很喜欢命令行解析器库（[http://commandline.codeplex.com/](http://commandline.codeplex.com/)）。它有一种非常简单优雅的通过属性设置参数的方式：

```
class Options
{
    [Option("i", "input", Required = true, HelpText = "Input file to read.")]
    public string InputFile { get; set; }

    [Option(null, "length", HelpText = "The maximum number of bytes to process.")]
    public int MaximumLenght { get; set; }

    [Option("v", null, HelpText = "Print details during execution.")]
    public bool Verbose { get; set; }

    [HelpOption(HelpText = "Display this help screen.")]
    public string GetUsage()
    {
        var usage = new StringBuilder();
        usage.AppendLine("Quickstart Application 1.0");
        usage.AppendLine("Read user manual for usage instructions...");
        return usage.ToString();
    }
} 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2009-01-29T14:12:55.900

[WPF TestApi 库](http://www.codeplex.com/TestApi)带有用于 C# 开发的最佳命令行解析器之一。我强烈建议从[Ivo Manolov 的 API 博客中查看](http://blogs.msdn.com/ivo_manolov/archive/2008/12/17/9230331.aspx)它：

```
// EXAMPLE #2:
// Sample for parsing the following command-line:
// Test.exe /verbose /runId=10
// This sample declares a class in which the strongly-
// typed arguments are populated
public class CommandLineArguments
{
   bool? Verbose { get; set; }
   int? RunId { get; set; }
}

CommandLineArguments a = new CommandLineArguments();
CommandLineParser.ParseArguments(args, a); 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-01-29T13:40:58.537

看看[http://github.com/mono/mono/tree/master/mcs/class/Mono.Options/](http://github.com/mono/mono/tree/master/mcs/class/Mono.Options/)

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2010-07-01T01:03:02.100

看起来每个人都有自己的宠物命令行解析器，我最好也添加我的:)。

[http://bizark.codeplex.com/](http://bizark.codeplex.com/)

这个库包含一个[命令行解析器](http://bizark.codeplex.com/wikipage?title=Command-line%20Parsing&referringTitle=Home)，它将使用命令行中的值初始化一个类。它有很多功能（我多年来一直在构建它）。

从[文档](http://bizark.codeplex.com/wikipage?title=Command-line%20Parsing&referringTitle=Home)...

BizArk 框架中的命令行解析具有以下关键特性：

*   **自动初始化：**根据命令行参数自动设置类属性。
*   **默认属性：**在不指定属性名称的情况下发送值。
*   **值转换：**使用 BizArk 中也包含的强大的 ConvertEx 类将值转换为正确的类型。
*   **布尔标志：**可以通过简单地使用参数（例如，/b 表示真，/b- 表示假）或添加值 true/false、yes/no 等来指定标志。
*   **参数数组：**只需在命令行名称后添加多个值即可设置定义为数组的属性。例如，/x 1 2 3 将使用数组 { 1, 2, 3 } 填充 x（假设 x 被定义为整数数组）。
*   **命令行别名：**一个属性可以支持多个命令行别名。例如，帮助使用别名 ?。
*   **部分名称识别：**您不需要拼出全名或别名，只需拼写足以让解析器区分属性/别名与其他名称。
*   **支持 ClickOnce：**即使在 ClickOnce 部署的应用程序的 URL 中将属性指定为查询字符串，也可以初始化属性。命令行初始化方法将检测它是否作为 ClickOnce 运行，因此您的代码在使用时无需更改。
*   **自动创建 /? help:**这包括考虑到控制台宽度的漂亮格式。
*   **将命令行参数加载/保存到文件：**如果您有多个要运行多次的大型复杂命令行参数集，这将特别有用。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-12-15T07:07:43.817

不久前我写了一个 C# 命令行参数解析器。它位于： http: [//www.codeplex.com/CommandLineArguments](http://www.codeplex.com/CommandLineArguments)

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2012-03-15T15:11:25.787

[CLAP](http://adrianaisemberg.github.com/CLAP/)（命令行参数解析器）有一个可用的 API，并且有很好的文档记录。您创建一个方法，注释参数。 [https://github.com/adrianaisemberg/CLAP](https://github.com/adrianaisemberg/CLAP)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-05-11T18:25:59.837

这个问题有很多解决方案。为了完整性并提供替代方案，如果有人希望我在我的[谷歌代码库](http://code.google.com/p/csharptest-net/)中为两个有用的类添加这个答案。

第一个是ArgumentList，它只负责解析命令行参数。它收集由开关“/x:y”或“-x=y”定义的名称-值对，还收集“未命名”条目的列表。它的基本[用法在这里讨论](http://csharptest.net/?p=87)，在这里[查看课程](http://csharptest.net/browse/trunk/src/Shared/ArgumentList.cs)。

第二部分是[CommandInterpreter](http://csharptest.net/?p=299)，它从您的 .Net 类中创建一个功能齐全的命令行应用程序。举个例子：

```
using CSharpTest.Net.Commands;
static class Program
{
    static void Main(string[] args)
    {
        new CommandInterpreter(new Commands()).Run(args);
    }
    //example ‘Commands’ class:
    class Commands
    {
        public int SomeValue { get; set; }
        public void DoSomething(string svalue, int ivalue)
        { ... } 
```

使用上面的示例代码，您可以运行以下命令：

> Program.exe DoSomething“字符串值”5

- 或者 -

> Program.exe dosomething /ivalue=5 -svalue:"字符串值"

它就像那样简单，也可以像您需要的那样复杂。您可以[查看源代码](http://csharptest.net/browse/src/Library/Commands)、[查看帮助](http://help.csharptest.net/?CSharpTest.Net.Library~CSharpTest.Net.Commands_namespace.html)或[下载二进制文件](http://code.google.com/p/csharptest-net/downloads/list)。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-29T13:43:09.610

我喜欢[那个](http://www.codeproject.com/KB/recipes/plossum_commandline.aspx)，因为您可以为参数“定义规则”，无论是否需要，...

或者，如果您是 Unix 人，那么您可能会喜欢[GNU Getopt .NET](http://www.codeplex.com/getopt)端口。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-01-23T16:55:08.007

你可能喜欢我的一个[Rug.Cmd](http://cmd.codeplex.com)

易于使用和可扩展的命令行参数解析器。句柄：布尔、加/减、字符串、字符串列表、CSV、枚举。

内置“/？” 帮助模式。

内置'/??' 和 '/?D' 文档生成器模式。

```
static void Main(string[] args) 
{            
    // create the argument parser
    ArgumentParser parser = new ArgumentParser("ArgumentExample", "Example of argument parsing");

    // create the argument for a string
    StringArgument StringArg = new StringArgument("String", "Example string argument", "This argument demonstrates string arguments");

    // add the argument to the parser 
    parser.Add("/", "String", StringArg);

    // parse arguemnts
    parser.Parse(args);

    // did the parser detect a /? argument 
    if (parser.HelpMode == false) 
    {
        // was the string argument defined 
        if (StringArg.Defined == true)
        {
            // write its value
            RC.WriteLine("String argument was defined");
            RC.WriteLine(StringArg.Value);
        }
    }
} 
```

编辑：这是我的项目，因此不应将这个答案视为第三方的认可。也就是说，我确实将它用于我编写的每个基于命令行的程序，它是开源的，我希望其他人可以从中受益。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-04-17T21:28:20.723

[在http://www.codeplex.com/commonlibrarynet](http://www.codeplex.com/commonlibrarynet)有一个命令行参数解析器

它可以使用1\. 属性
2\. 显式调用
3\. 单行多参数或字符串数​​组来解析参数

它可以处理以下事情：

-**配置**：Qa -**开始日期**：${*今天*} -**地区**：'New York' Settings01

它非常易于使用。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-08-21T07:27:24.743

这是我基于 Novell`Options`类编写的处理程序。

这个针对执行`while (input !="exit")`样式循环的控制台应用程序，例如 FTP 控制台等交互式控制台。

示例用法：

```
static void Main(string[] args)
{
    // Setup
    CommandHandler handler = new CommandHandler();
    CommandOptions options = new CommandOptions();

    // Add some commands. Use the v syntax for passing arguments
    options.Add("show", handler.Show)
        .Add("connect", v => handler.Connect(v))
        .Add("dir", handler.Dir);

    // Read lines
    System.Console.Write(">");
    string input = System.Console.ReadLine();

    while (input != "quit" && input != "exit")
    {
        if (input == "cls" || input == "clear")
        {
            System.Console.Clear();
        }
        else
        {
            if (!string.IsNullOrEmpty(input))
            {
                if (options.Parse(input))
                {
                    System.Console.WriteLine(handler.OutputMessage);
                }
                else
                {
                    System.Console.WriteLine("I didn't understand that command");
                }

            }

        }

        System.Console.Write(">");
        input = System.Console.ReadLine();
    }
} 
```

来源：

```
/// <summary>
/// A class for parsing commands inside a tool. Based on Novell Options class (http://www.ndesk.org/Options).
/// </summary>
public class CommandOptions
{
    private Dictionary<string, Action<string[]>> _actions;
    private Dictionary<string, Action> _actionsNoParams;

    /// <summary>
    /// Initializes a new instance of the <see cref="CommandOptions"/> class.
    /// </summary>
    public CommandOptions()
    {
        _actions = new Dictionary<string, Action<string[]>>();
        _actionsNoParams = new Dictionary<string, Action>();
    }

    /// <summary>
    /// Adds a command option and an action to perform when the command is found.
    /// </summary>
    /// <param name="name">The name of the command.</param>
    /// <param name="action">An action delegate</param>
    /// <returns>The current CommandOptions instance.</returns>
    public CommandOptions Add(string name, Action action)
    {
        _actionsNoParams.Add(name, action);
        return this;
    }

    /// <summary>
    /// Adds a command option and an action (with parameter) to perform when the command is found.
    /// </summary>
    /// <param name="name">The name of the command.</param>
    /// <param name="action">An action delegate that has one parameter - string[] args.</param>
    /// <returns>The current CommandOptions instance.</returns>
    public CommandOptions Add(string name, Action<string[]> action)
    {
        _actions.Add(name, action);
        return this;
    }

    /// <summary>
    /// Parses the text command and calls any actions associated with the command.
    /// </summary>
    /// <param name="command">The text command, e.g "show databases"</param>
    public bool Parse(string command)
    {
        if (command.IndexOf(" ") == -1)
        {
            // No params
            foreach (string key in _actionsNoParams.Keys)
            {
                if (command == key)
                {
                    _actionsNoParams[key].Invoke();
                    return true;
                }
            }
        }
        else
        {
            // Params
            foreach (string key in _actions.Keys)
            {
                if (command.StartsWith(key) && command.Length > key.Length)
                {

                    string options = command.Substring(key.Length);
                    options = options.Trim();
                    string[] parts = options.Split(' ');
                    _actions[key].Invoke(parts);
                    return true;
                }
            }
        }

        return false;
    }
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-05-12T06:08:45.837

我个人最喜欢的是Peter Palotas 的[http://www.codeproject.com/KB/recipes/plossum_commandline.aspx](http://www.codeproject.com/KB/recipes/plossum_commandline.aspx)：

```
[CommandLineManager(ApplicationName="Hello World",
    Copyright="Copyright (c) Peter Palotas")]
class Options
{
   [CommandLineOption(Description="Displays this help text")]
   public bool Help = false;

   [CommandLineOption(Description = "Specifies the input file", MinOccurs=1)]
   public string Name
   {
      get { return mName; }
      set
      {
         if (String.IsNullOrEmpty(value))
            throw new InvalidOptionValueException(
                "The name must not be empty", false);
         mName = value;
      }
   }

   private string mName;
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-06-11T06:50:37.453

我最近遇到了我非常喜欢的 FubuCore 命令行解析实现，原因是：

*   它很容易使用——虽然我找不到它的文档，但 FubuCore 解决方案还提供了一个包含一组很好的单元测试的项目，这些单元测试比任何文档都更能说明功能
*   它有一个很好的面向对象设计，没有代码重复或我以前在命令行解析应用程序中使用的其他类似东西
*   它是声明性的：您基本上为命令和参数集编写类，并用属性装饰它们以设置各种选项（例如名称、描述、强制/可选）
*   该库甚至根据这些定义打印出一个很好的使用图

下面是一个关于如何使用它的简单示例。为了说明用法，我编写了一个简单的实用程序，它有两个命令： - add（将对象添加到列表 - 对象由名称（字符串）、值（int）和布尔标志组成） - list（列表所有当前添加的对象）

首先，我为“添加”命令编写了一个命令类：

```
[Usage("add", "Adds an object to the list")]
[CommandDescription("Add object", Name = "add")]
public class AddCommand : FubuCommand<CommandInput>
{
    public override bool Execute(CommandInput input)
    {
        State.Objects.Add(input); // add the new object to an in-memory collection

        return true;
    }
} 
```

此命令将 CommandInput 实例作为参数，因此我接下来定义：

```
public class CommandInput
{
    [RequiredUsage("add"), Description("The name of the object to add")]
    public string ObjectName { get; set; }

    [ValidUsage("add")]
    [Description("The value of the object to add")]
    public int ObjectValue { get; set; }

    [Description("Multiply the value by -1")]
    [ValidUsage("add")]
    [FlagAlias("nv")]
    public bool NegateValueFlag { get; set; }
} 
```

下一个命令是'list'，实现如下：

```
[Usage("list", "List the objects we have so far")]
[CommandDescription("List objects", Name = "list")]
public class ListCommand : FubuCommand<NullInput>
{
    public override bool Execute(NullInput input)
    {
        State.Objects.ForEach(Console.WriteLine);

        return false;
    }
} 
```

'list' 命令不带参数，所以我为此定义了一个 NullInput 类：

```
public class NullInput { } 
```

现在剩下的就是将其连接到 Main() 方法中，如下所示：

```
 static void Main(string[] args)
    {
        var factory = new CommandFactory();
        factory.RegisterCommands(typeof(Program).Assembly);

        var executor = new CommandExecutor(factory);

        executor.Execute(args);
    } 
```

该程序按预期工作，打印有关正确用法的提示，以防任何命令无效：

```
 ------------------------
    Available commands:
  ------------------------
     add -> Add object
    list -> List objects
  ------------------------ 
```

以及“添加”命令的示例用法：

```
Usages for 'add' (Add object)
  add <objectname> [-nv]

  -------------------------------------------------
    Arguments
  -------------------------------------------------
     objectname -> The name of the object to add
    objectvalue -> The value of the object to add
  -------------------------------------------------

  -------------------------------------
    Flags
  -------------------------------------
    [-nv] -> Multiply the value by -1
  ------------------------------------- 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-07-07T05:07:43.860

Powershell 命令行开关。

Powershell 基于命令行开关上指定的属性完成解析，支持验证、参数集、流水线、错误报告、帮助，以及最好的返回 .NET 对象以在其他命令行开关中使用。

我发现几个链接对入门很有帮助：

*   [快速入门教程](http://blogs.msdn.com/b/saveenr/archive/2010/03/08/how-to-create-a-powershell-2-0-module-and-cmdlet-with-visual-studio-2010-screencast-included.aspx)
*   [MSDN 上的编程指南](http://msdn.microsoft.com/en-us/library/ms569889%28v=vs.85%29)
*   [MSDN 上的命名空间参考](http://msdn.microsoft.com/en-us/library/dd878268%28v=vs.85%29)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2012-08-11T15:02:34.917

[C# CLI](http://sourceforge.net/projects/ccli)是我编写的一个非常简单的命令行参数解析库。它有据可查且开源。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-08-21T11:07:24.190

[Genghis Command Line Parser](http://www.sellsbrothers.com/tools/genghis/) 可能有点过时了，但它的功能非常完整，对我来说效果很好。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2010-07-23T14:09:11.607

我建议使用开源库[CSharpOptParse](http://sourceforge.net/projects/csharpoptparse/)。它解析命令行并使用命令行输入来水合用户定义的 .NET 对象。在编写 C# 控制台应用程序时，我总是求助于这个库。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-06-28T09:04:55.870

请使用 apache commons cli API 的 .net 端口。这很好用。

[http://sourceforge.net/projects/dotnetcli/](http://sourceforge.net/projects/dotnetcli/)

以及用于概念和介绍的原始 API

[http://commons.apache.org/cli/](http://commons.apache.org/cli/)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2011-06-29T12:43:58.510

一个非常简单易用的临时类，用于命令行解析，支持默认参数。

```
class CommandLineArgs
{
    public static CommandLineArgs I
    {
        get
        {
            return m_instance;
        }
    }

    public  string argAsString( string argName )
    {
        if (m_args.ContainsKey(argName)) {
            return m_args[argName];
        }
        else return "";
    }

    public long argAsLong(string argName)
    {
        if (m_args.ContainsKey(argName))
        {
            return Convert.ToInt64(m_args[argName]);
        }
        else return 0;
    }

    public double argAsDouble(string argName)
    {
        if (m_args.ContainsKey(argName))
        {
            return Convert.ToDouble(m_args[argName]);
        }
        else return 0;
    }

    public void parseArgs(string[] args, string defaultArgs )
    {
        m_args = new Dictionary<string, string>();
        parseDefaults(defaultArgs );

        foreach (string arg in args)
        {
            string[] words = arg.Split('=');
            m_args[words[0]] = words[1];
        }
    }

    private void parseDefaults(string defaultArgs )
    {
        if ( defaultArgs == "" ) return;
        string[] args = defaultArgs.Split(';');

        foreach (string arg in args)
        {
            string[] words = arg.Split('=');
            m_args[words[0]] = words[1];
        }
    }

    private Dictionary<string, string> m_args = null;
    static readonly CommandLineArgs m_instance = new CommandLineArgs();
}

class Program
{
    static void Main(string[] args)
    {
        CommandLineArgs.I.parseArgs(args, "myStringArg=defaultVal;someLong=12");
        Console.WriteLine("Arg myStringArg  : '{0}' ", CommandLineArgs.I.argAsString("myStringArg"));
        Console.WriteLine("Arg someLong     : '{0}' ", CommandLineArgs.I.argAsLong("someLong"));
    }
} 
```

# c# - 为什么要在 ASP.NET 中加密查询字符串？

> ID：491603
> 
> 赞同：7
> 
> 时间：2009-01-29T13:36:40.450
> 
> 标签：c#, .net, asp.net

我在一个用 C#/ASP.NET 编写的 Web 应用程序上工作。此应用程序的原始框架选择使用加密查询字符串并`Viewstate`控制应用程序的“安全性”和“状态”。

在此之前来自 GET/POST 世界，我没有很好的基础来理解为什么人们会遇到加密查询字符串的麻烦，当使用 POST 处理敏感数据（连同 SSL）会达到类似的水平安全。

我的问题是：在 ASP.NET 中使用加密查询字符串有哪些优点和缺点？是否有记录在案的“最佳实践”？

* * *

**编辑**：人们倾向于关注`Viewstate`这个问题。 **不要**。提到 Viewstate 只是为了让您更好地了解“状态”是如何管理的，因为这与 URL 是切线相关的。我从来没有说过`Viewstate`是加密的。确实有两个问题：1) 的使用`Viewstate`，以及 2) 加密查询字符串的使用。这个问题主要针对后者。我希望这有助于澄清问题的重点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T13:51:36.270

您可能会这样做的一个原因是防止篡改 URL 以访问您自己以外的数据。例如，如果您有以下网址：

```
http://foo.com/user.aspx?user_id=123 
```

我（或任何人）将其更改为：

```
http://foo.com/user.aspx?user_id=124 
```

如果您的数据访问策略完全依赖于查询字符串中的内容，则可能允许未经授权访问数据。

这种方法确实可以正确地达到这个目的，但是更强大的实现方法是主动检查应用程序中的授权，并且永远不要完全依赖 URL 进行身份验证和/或授权目的。

请注意，这与 SSL 无关——它确保了浏览器和服务器之间的隐私，但您可以在完全安全的连接下并且仍然篡改 URL。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T13:42:00.890

好吧，可以说它允许您分发页面的 url，但这里更好的方法可能是涉及 guid 作为永久链接的不透明标识符......也许它对脚本目的有用？

如果它在同一个应用程序的页面之间，那么通过 SSL 的 POST 确实似乎更有意义。可以问问原设计师吗？阅读设计文件？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T13:48:33.217

它们在用户激活等事情中可能很有用，您可以直接从浏览器传递纯文本帐户凭据（尽管这很容易通过查找令牌解决）。它在 SSL 不适用于 POST 请求的情况下很有用，而且这是我唯一能想到的老实说。它通常可以作为客户的强制要求来阻止意外的数据泄漏，但我想这取决于您的应用程序的偏执狂。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T20:16:46.070

查询字符串被加密的原因是它提供了虚假的安全性。当它真正提供的只是没有安全性的障碍时，它让业务人员觉得它提供了安全性。

在我之前的工作中，我们被迫使用它们，我明确表示这绝对没有意义，尤其是当我们有一个静态键和静态初始化向量但人们仍然认为它提供了一些东西时。

使用加密查询字符串非常糟糕的原因是它让人们无法实现真正​​的安全性。在其他用户指出您有 www.mysite.com/page?userid=25 的情况下，他们可以轻松地将 25 更改为 100 或 1 等。

在我看来这是一件好事，用户应该能够做到这一点。网站负责确保他们不会更改 ID 并访问未经授权的材料。*当您似乎*受到保护时，不实施真正的安全性太容易了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-06-17T15:11:20.497

除了给出的所有答案之外，您可能还想从服务器日志中隐藏 URL 数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T13:43:07.723

IMO 你对这种做法感到困惑是对的，因为这不是一个好主意。您可以（取决于浏览器）和应该放入 QueryString 的数据量是有限制的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-29T13:44:16.487

如果加密是在应用程序的较低级别完成的，或者它是一个框架。可能是为了确保内容受到保护，无论实施如何。即使开发人员决定不使用 SSL POST，它仍然受到保护。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-29T13:45:15.707

关于加密请求字符串，我确实可以想到一些加密它的原因。典型的案例可能是您创建了一个填充了唯一索引的人员记录的网格。在每一行中，您可能希望有一个指向允许您编辑记录的页面的链接。您可以简单地为每个链接提供一个参数，例如“ID=X”，以便加载适当的记录。

```
John |  Sample  | <a href="EditPage.aspx?ID=1">Edit Me!</a>
Jane |  Sample  | <a href="EditPage.aspx?ID=2">Edit Me!</a> 
```

现在，如果所有员工都可以访问所有人员并且对您的页面的访问由身份验证过程控制并且您正在使用 SSL（SSL 已协商并且所有通信在发送任何 URL 参数*之前都已加密），则这不是问题。*但是，请考虑您对哪些用户可以查看哪些记录有限制的情况。因此，芝加哥的员工只能看到分配到芝加哥位置的人员，纽约的员工只能看到纽约的人员，等等。

现在您遇到了一个问题：有人可能会通过使用不同的用户 ID 重新键入 URL 来破坏您的位置限制。解决此问题的一种方法是加密请求参数。不过，也有一些曲折。首先，简单的加密是行不通的，因为用户只能尝试另一个加密值。您需要密钥对或算法，从而导致 ID 和 URL 参数之间的映射非常稀疏。密钥对解决方案（我已经使用并推荐）很简单：只需传递两个加密的复杂值，它们一起工作以产生有效值。

请注意，您*无法*通过会话存储解决此问题，因为您不知道用户将提前选择什么值。类似地，一个 Post 在处理这样一个简单的接口设备时会非常笨拙。

关于您的情况，上面显示了一个有用的特定情况。这是否适用于您的情况由您决定。但是，您*应该*考虑他们实施的加密是否只是将一个可猜测的值替换为另一个。

* * *

另一个注意事项：默认情况下视图状态*未*加密。它只是[通过 Base64 编码](http://msdn.microsoft.com/en-us/library/ms178199(VS.80).aspx)。添加了一个哈希，以便您可以查看它是否已被篡改。

就您的 Web 应用程序的安全性而言，确保您接收的数据来自您的用户并且数据在传输过程中没有受到损害的唯一可靠方法是通过 SSL。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-29T14:10:38.040

我可以看到加密查询字符串很有用...假设您想阻止用户将 ?recordID=1 更改为 ?recordID=2

我知道这应该在页面加载时得到保护，但我们都知道不是每个人都这样做

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-29T16:20:05.643

听起来像是一种廉价而愉快的方式来阻止用户摆弄 GET 参数。我知道*我*摆弄 GET 参数来获得我想要的东西。

不过，奇怪的是，从 Javascript 发送的 GET 请求也必须对 URL 进行编码。这将使站点难以以 AJAX-y 方式进行交互。那时，建立该系统似乎是有害的。

如果我有投票权，我会投票给；

1.  重写 URL 解析机制，使它们同时接受加密和非加密字符串，
2.  将 URL 加密函数标记为`[Obsolete]`
3.  逐步删除加密系统。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-29T13:41:12.967

就 ViewState 而言，它已经被 ASP.NET 运行时以几乎所有可能的方式加密和验证。

说到请求 URL（或查询字符串）——我个人认为加密它们没有意义，因为这样做没有合理的借口。

# assembly - 在从中断处理程序返回之前，我是否必须弹出某些异常推送到堆栈的错误代码？

> ID：491613
> 
> 赞同：6
> 
> 时间：2009-01-29T13:38:23.457
> 
> 标签：assembly, operating-system, x86, interrupt, osdev

我已经加载了一个包含 256 个条目的 idt 表，所有条目都指向类似的处理程序：

*   对于异常 8 和 10-14，推送异常编号（这些异常会自动推送错误代码）
*   对于其他人，推送“虚拟”错误代码和异常编号；
*   然后跳转到一个通用处理程序

因此，当公共处理程序进入时，堆栈已正确对齐并包含异常/中断号、错误代码（可能只是一个伪代码）、eflags、cs 和 eip。

我的问题是关于从中断处理程序返回的。我使用`iret`从堆栈中取出异常编号和错误代码后返回，但这不适用于异常 nr 8；如果我将错误代码留在堆栈上，则返回正常！

问题：

*   对于将错误代码放在那里的异常，我是否必须将错误代码留在堆栈上？如果是这样，如何`iret`确定它是否必须弹出错误代码？
*   一旦我启用中断，我总是会得到异常 8（双重故障），但随后一切正常（我正在开发一个爱好操作系统）。这是正常行为还是我在某处有错误？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-29T13:50:57.160

如果 CPU 自动推送错误代码，则处理程序***必须***在`iret`. 该`iret`指令不知道你来自哪里，如果它是一个错误，一个陷阱或一个外部中断。它总是做同样的事情，并且假设堆栈上没有错误代码。

引用 SDM（软件开发人员手册）第 3 卷第 5 章第 5.13 节标题为错误代码：

> 错误代码作为双字或字压入堆栈（取决于默认中断、陷阱或任务门大小）。为了使双字推送的堆栈保持对齐，保留错误代码的上半部分。请注意，执行 IRET 指令以从异常处理程序返回时不会弹出错误代码，因此处理程序必须在执行返回之前删除错误代码。

您可以在此处找到[IA](http://www.intel.com/products/processor/manuals/) [-32 软件开发人员手册](http://www.intel.com/products/processor/manuals/) ：http : [//www.intel.com/products/processor/manuals/](http://www.intel.com/products/processor/manuals/)

第 3 卷第 1 部分第 5 章描述了异常和中断处理。第 2 卷第 1 部分有说明的规范`iret`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T14:02:10.773

I wrote a [small x86 OS](http://sourceforge.net/projects/osamos) a while back. Take a look at the file [isr.asm](http://osamos.cvs.sourceforge.net/viewvc/osamos/AMOS/src/kernel/isr.asm?view=markup) in the cvs repository.

Notice how we set up the handlers, most push a dummy dword onto the stack to account for the few handlers that automatically get an error code pushed. Then when we return via an iret we can always assume 2 dwords on the stack irrespective of the interrupt and perform an add esp, 8 before the iret to clean things up nicely.

That should answer your first question.

As for your second question: A double fault when you enable interrupts, ...hmmm could be a problem with paging if you haven't set it up correctly. Could be a million other thing too :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-25T19:53:26.313

I had a similar problem with "double faults" as soon as I enabled interrupts. Well, they *looked* like double faults, but they really were timer interrupts!

Double faults are interrupt number `8`.

Unfortunately, a default PIC configuration signals timer interrupts as interrupt number `(DEFAULT_PIC_BASE + TIMER_OFFSET)` = `(8 + 0)` = `8`.

Masking out all my PIC interrupts (until I was ready to properly configure the PIC) silenced these double-fault-lookalike timer interrupts.

(PICs require the CPU to acknowledge interrupts before they produce the next one. Since your code wasn't acknowledging the initial timer interrupt, the PIC never gave you any more! That's why you only got one, rather than the zillion one might have expected.)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-28T18:08:08.033

> Do I have to leave the error code on the stack for exceptions that put the error code there?

As others mentioned, you have to do either:

```
pop %eax
/* Do something with %eax */
iret 
```

Or if you want to ignore the error code:

```
add $4, %esp
iret 
```

If you don't, `iret` will interpret the error code as the new CS, and you are likely to get a general protection fault as mentioned at: [Why does iret from a page fault handler generate interrupt 13 (general protection fault) and error code 0x18?](https://stackoverflow.com/questions/10581224/why-does-iret-from-a-page-fault-handler-generate-interrupt-13-general-protectio)

[Minimal Working this page handler](https://github.com/cirosantilli/x86-bare-metal-examples/blob/1f6af9021283dc01f2247efbb6aa9217363fbf07/page_fault.S#L47) that I've created to illustrate this. Try commenting out the `pop` and see it blow up.

Compare the above with a [Division error exception](https://github.com/cirosantilli/x86-bare-metal-examples/blob/1f6af9021283dc01f2247efbb6aa9217363fbf07/idt_zero_divide.S#L33) which does not to pop the stack.

Note that if you do simply `int $14`, no extra byte gets pushed: this only happens on the actual exception.

[Intel Manual Volume 3 System Programming Guide - 325384-056US September 2015](https://web.archive.org/web/20151025081259/http://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developer-system-programming-manual-325384.pdf) Table 6-1\. "Protected-Mode Exceptions and Interrupts" column "Error Code" contains the list of interrupts that push the error code or not.

38.9.2.2 "Page Fault Error Codes" explains what the error means.

A neat way to deal with this is to push a dummy error code `0` on the stack for the interrupts that don't do this to make things uniform. James Molloy's tutorial [does exactly that](https://github.com/cirosantilli/jamesmolloy-kernel-development-tutorials/blob/631106c09e02bae9b2da21999224bb2e2d5c4411/6_paging/interrupt.asm#L38).

The Linux kernel 4.2 seems to do something similar. Under [arch/x86/entry/entry64.S](https://github.com/torvalds/linux/blob/v4.2/arch/x86/entry/entry_64.S#L1078) it models interrupts with `has_error_code`:

```
trace_idtentry page_fault do_page_fault has_error_code=1 
```

and then uses it on the same file as:

```
.ifeq \has_error_code
pushq $-1 /* ORIG_RAX: no syscall to restart */
.endif 
```

which does the push when `has_error_code=0`.

# c# - 创建模拟时如何组合两个接口？

> ID：491628
> 
> 赞同：18
> 
> 时间：2009-01-29T13:41:32.140
> 
> 标签：c#, .net, rhino-mocks

我们正在使用 Rhino Mocks 执行一些单元测试，并且需要模拟两个接口。在对象上只实现了一个接口，而另一个接口是使用面向方面的方法动态实现的。有没有一种简单的方法可以动态组合这两个接口，以便可以创建一个模拟并为两个接口存根方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-14T21:48:37.593

使用 Rhino 模拟

```
var mock = MockRepository.GenerateMock<IFirst, ISecond>();
mock.Stub(m => m.FirstProperty).PropertyBehavior();
((ISecond)mock).Stub(k=> k.SecondProperty).PropertyBehavior(); 
```

找到并使用了来自[http://www.richard-banks.org/2010/08/mocking-comparison-part-11-multiple.html的信息](http://www.richard-banks.org/2010/08/mocking-comparison-part-11-multiple.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-29T14:50:29.007

它不是动态的，但肯定很容易：在您的测试程序集中创建一个接口，除了实现其他两个接口之外什么都不做：

```
internal interface ICombined : IFirstInterface, ISecondInterface {} 
```

然后模拟`ICombined`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-06-04T12:58:08.273

使用 Rhino Mocks 可以生成具有多个接口的模拟，如下所示：

```
var mocker = new MockRepository();
var mock = mocker.CreateMultiMock<IPrimaryInterface>(typeof(IFoo), typeof(IBar));
mocker.ReplayAll(); 
```

# dll - 如何删除自安装的 DLL？

> ID：491630
> 
> 赞同：0
> 
> 时间：2009-01-29T13:42:04.510
> 
> 标签：dll

我在服务器上有一个 DLL，它以某种方式注册为自行安装，而不是组件服务，它位于 Microsoft/COM3/SelfReg/CLSID 下，该 DLL 的 ID 和信息存储在那里 - 此组件需要更换或删除更新如何删除它 regsvr32 将不起作用，并且除了在注册表中之外没有可见的条目。如何取消注册这是所需的全部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T14:23:06.253

人们声称自我注册是邪恶的原因之一是不能保证回滚会起作用。如果 regsvr32 拒绝注销它并且添加/删除程序中没有任何内容（如果有人手动将注册表项添加为组件的一部分，则可能存在这种情况），那么手动删除注册表项可能是您能做的最好的事情。一些制作 dll 的人只是假设一旦安装，就永远不应该删除它们。

# c# - auto-generated Code

> ID：491646
> 
> 赞同：13
> 
> 时间：2009-01-29T13:50:36.367
> 
> 标签：c#, visual-studio

I am working on debugging some code and noticed a bunch of auto generated methods and objects.

At the top of the code for these I find the following comment:

```
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:2.0.50727.42
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------ 
```

**How** do you figure out what generated the code? My curiosity has gotten the better of me on this so that is why I ask. I have looked for parts of the comment in Google and found nothing concrete.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T17:19:54.197

```
 //------------------------------------------------------------------------------ 
    // <auto-generated> 
    // This code was generated by a tool. 
    // Runtime Version:2.0.50727.42 
    // 
    // Changes to this file may cause incorrect behavior and will be lost if 
    // the code is regenerated. 
    // </auto-generated> 
    //------------------------------------------------------------------------------

namespace FirstWeb 
{ 
    public partial class _Default 
    { 

        /// <summary> 
        /// form1 control. 
        /// </summary> 
        /// <remarks> 
        /// Auto-generated field. 
        /// To modify move field declaration from designer file to code-behind file. 
        /// </remarks> 
        protected global::System.Web.UI.HtmlControls.HtmlForm form1; 
    } 
} 
```

You will not change this auto-generated C# file. As you keep adding ASP.NET controls to the page, this file grows with the additional declarations. In the older versions of C# (before version 2.0) and Visual Studio (before Version 2005), this code would be in the regular Default.aspx.cs file as well.

With the introduction of partial classes in C#, the code belonging to the same class can be split across multiple files. Here you see the “public partial class _Default’, which is used to hold the **code generated by the Visual Studio designer**. You will see the same class signature in the Default.aspx.cs file as well (you use this to write your own custom code).

So, the developer (you) and the designer (Visual Studio) can work independently without stepping over each other.

This is taken from [First Web Program (Web Project) in C# Explained](http://www.infinitezest.com/articles/first-web-program-web-project-in-csharp-explained.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T13:53:11.057

It will entirely depend on what the code is.

Presumably you know the class you're debugging - whether it's part of an ORM, part of a web service generated proxy etc. That's the crucial bit of information.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T13:55:35.107

Looks like Visual Studio to me. [Try Googling only part of the message](http://www.google.com/search?q=%22Changes+to+this+file+may+cause+incorrect+behavior+and+will+be+lost%22&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T13:58:47.673

This can also be a .Designer.cs file generated by ResXFileCodeGenerator, which generates strongly-typed wrappers for .resx files.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T13:53:45.627

Well, what code is it? Most of the MS tools include this header. `xsd.exe` does, `sqlmetal` (LINQ-to-SQL) does, etc. Try looking down a few lines... for example, a quick xsd test for me shows a second comment block:

```
// 
// This source code was auto-generated by xsd, Version=2.0.50727.3038.
// 
```

But this doesn't exist in the LINQ-to-SQL code... ;-(

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T14:01:48.853

These comments exactly match those found in some of my service reference files. These are generated proxy files for WCF services, so perhaps your code is also in this area.

If you can't see those files in Solution Explorer, click 'Show All Files' and they will appear as .cs files in the Service references node.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-31T12:44:10.650

The SVCUTIL tool from Microsoft ([http://msdn.microsoft.com/en-us/library/aa347733.aspx](http://msdn.microsoft.com/en-us/library/aa347733.aspx)) will generate source code files with this comment at the top of each file without identifying itself as the tool that generated the file.

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-29T13:56:06.620

I think this code was generated by the Linq to SQL engine.

you can modify it if you understand how to code with Sql Enities

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-02-28T14:16:04.907

This is the exact comment that is generated by System.CodeDom when generating a file from an entire code compile unit.

# wpf - WPF StackPanel 如何从下到上垂直填充？

> ID：491647
> 
> 赞同：39
> 
> 时间：2009-01-29T13:50:42.947
> 
> 标签：wpf, stackpanel

我需要能够填充 a`stackpanel`但`buttons`按钮**必须首先出现在堆栈面板的底部并向上填充**。这些按钮是动态创建的，并且数量不详，因此视觉黑客无法正常工作。我尝试过垂直对齐但无济于事。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-29T14:01:38.293

像这样：

```
<StackPanel VerticalAlignment="Bottom">
    ...
</StackPanel> 
```

并且要向上填充按钮，您必须在位置 0 插入按钮，而不是添加它们。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-12-17T12:17:56.620

或者您可以将 StackPanel 旋转 180 度以使按钮从底部堆叠到顶部，然后再将按钮旋转 180 度以使它们再次正面朝上：

```
<StackPanel>
    <!-- rotate all buttons inside this panel -->
    <StackPanel.Resources>
        <Style TargetType="Button">
            <Setter Property="LayoutTransform">
                <Setter.Value>
                    <RotateTransform Angle="180"/>
                </Setter.Value>
            </Setter>
        </Style>
    </StackPanel.Resources>

    <!-- rotate the stack panel -->
    <StackPanel.LayoutTransform>
       <RotateTransform Angle="180"/>
    </StackPanel.LayoutTransform>

    <!-- content -->
    <Button>1</Button>
    <Button>2</Button>

</StackPanel> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-29T19:35:28.790

另一种选择是使用 DockPanel 代替。

只需在 DockPanel 上将 LastChildFill 设置为 false。

然后在添加到 DockPanel 之前将附加的 Dock 属性设置到要添加到底部的每个按钮。

例子 ：

```
 var button = new Button();
            DockPanel.SetDock(button, Dock.Bottom); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-29T14:00:45.923

解决问题的最佳方法是实现从 stackpanel 派生的自定义容器，但如果在运行时添加元素，则快速而肮脏的解决方案是

```
 public Window1()
    {
        InitializeComponent();
        for (int i = 0; i < 10; i++)
        {
            Button btn = new Button();
            btn.Content = "Button " + i;
            MyStack.Children.Insert(0, btn);
        }
    } 
```

只需在 0 位置插入项目而不是添加它们。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T14:01:29.667

尝试将 StackPanel 放入另一个容器（不是 StackPanel；可能是 DockPanel）并使其底部对齐。然后，当您填充按钮时，将每个新按钮放在第一个位置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-17T05:14:52.217

我发现使用 Column=1 的 UniformGrid 可以提供整洁的填充堆栈，或者设置 Rows=1 可以提供整洁的水平填充堆栈。从索引 0 添加将自下而上进行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-24T21:39:56.020

喜欢 Nir ​​的转换解决方案。我想知道是否可以使用转换来完成。

但是有一点需要注意：不要在基于 ScrollView 的控件（例如 ListBox）上使用转换技巧，因为滚动条操作将与内容相反。只要您不是最终用户，就很有趣。;>

# apache-flex - 如何为 Flex UIComponent 启用自动调整大小？

> ID：491649
> 
> 赞同：1
> 
> 时间：2009-01-29T13:51:11.903
> 
> 标签：apache-flex, actionscript

我有一个扩展 UIComponent 并直接绘制到其中包含的 Sprite 的类。目前我（可能不正确）正在监听 Event.RESIZE 事件并在宽度和高度非零时绘制内容。问题是，即使我已将百分比宽度传递给实例标记，它似乎并没有与页面上的其他 Flex 组件一起调整大小，当然 resize 事件根本没有被触发。

我暂时通过将宽度和高度绑定到一个可以调整大小的容器来破解它，但是我应该如何处理呢？

**更新**：原来我在重绘方法的某个地方设置了宽度和高度（我不记得我为什么这样做了！）。我现在要羞愧地低下头了……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T14:16:52.070

我认为您需要提供更多信息。我正在做同样的事情，它对我来说很顺利。也许答案就在其他地方：例如，您到底使用什么类型的容器？调整大小时获得/丢失的空间是否有可能分配给硬币容器中的其他组件？尝试用带有一些彩色背景的 mx:Box 替换您自己的组件，看看它是否*会*随着容器调整大小。

# c++ - 缩进级别

> ID：491668
> 
> 赞同：8
> 
> 时间：2009-01-29T13:56:44.200
> 
> 标签：c++

你认为多少级的缩进是合理的？

我觉得拥有 4/5+ 级缩进的 C++ 函数通常是一件坏事。这意味着您必须始终在精神上跟踪 4/5+ 的事情。

我的意见合理吗？

（是的，我可以通过完全不缩进来避免多级缩进：）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T14:02:25.857

我同意你的看法。如果一个函数有超过 4 或 5 个嵌套的 if/switch/loop/try 语句，它的一部分应该被提取到它们自己的函数中。

这将使代码更具可读性，因为提取的函数名称通常比代码本身更具描述性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T14:07:06.190

这完全取决于您的代码试图解决的问题。有时你别无选择，只能有相当深的缩进，尽管这肯定是一种[代码味道](http://en.wikipedia.org/wiki/Code_smell)。

我认为您在 4 或 5 级左右是合理的，更多并且您可能应该寻求重构该方法。

还值得注意的是，人们多年来一直在尝试量化代码质量和设计指标。更常见的指标之一是[圈复杂度](http://en.wikipedia.org/wiki/Cyclomatic_complexity)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T14:02:44.623

实际上，导致代码不可读的不是缩进级别的数量，而是您正在查看的模块/函数/方法的长度。

当然，长部分通常具有更多级别的缩进，因为代码块是内联使用的，而不是分解的，因此它们之间存在关系。就我个人而言，我认为如果一个方法有超过几个屏幕的代码和超过 6 级的缩进，就会有异味。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T14:25:06.280

只要您可以在编辑器中同时看到所有的左括号和右括号，多级缩进就可以了。

在实践中，这往往会将您限制在最多 4 个级别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T14:26:33.953

但是要注意的一件事是，一些嵌套级别是必要的，不应该被抽象出来。

如果您对 4D 数组进行了某种蛮力迭代，那么您将自动获得四级嵌套，如果有 IF 语句，那么您就有五级，而没有特别复杂的代码部分。

所以嵌套的级别不一定是问题，而是每个嵌套级别的复杂性。如果您正在混合 WHILE、FOREACH、IF 和 SWITCH，那么也许您应该将它们归结为。

基本点是嵌套级别并不总是复杂性的指标。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T17:00:17.667

IIRC，Linus Torvalds 会同意你的看法。我相信他坚持 linux 内核代码的缩进为 8 个空格，行长为 80 个字符。当您在该方案下达到 4 或 5 级缩进时，您的代码看起来会非常糟糕。您被迫尝试重构代码只是为了保持可读性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T14:02:35.437

我认为这取决于具体情况，但通常你会想要更少的嵌套。

嵌套循环会降低性能，嵌套 if 语句通常可以减少到更少的级别。

问题是您经常在开发过程中过早地尝试优化。我认为在进行 3 层以上的嵌套之前，您应该总是花一点时间考虑可能性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-29T14:03:18.337

我对缩进的唯一不满是使用了两个关键字并且一个依赖于另一个。例如：

```
switch (c) {
    case 'x':
       foo = bar; 
```

这很糟糕，你不能在交换机之外有一个案例，所以：

```
switch (c) {
case 'x':
    foo = bar; 
```

..会好很多。在使用 if / else if / else 的开关中，缩进往往会变得疯狂。我还强烈建议在缩进时保持 80（最多 110 列限制）。没有人喜欢向右滚动 30 列来查看您在做什么，而向后滚动 30 列来查看您如何处理结果 :) 别介意那个必须在服务器上以愚蠢的 80x25 控制台模式编辑代码的可怜人。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-29T14:03:56.103

虽然我要说的内容来自一个普通的 C 观点，但它也可能适用于 C++。我喜欢 Linux 内核编码风格，即：8 个字符宽的制表符缩进（自然制表符）和在 80x25 终端上可以容纳的尽可能多的缩进级别（即不超过 80 个字符的宽度）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-29T14:08:15.033

太多的缩进可能是你应该重构的一个标志：创建更多具有好名字的小方法。这样你就可以将逻辑分解成更容易被吞噬的小块。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-29T14:13:17.927

这涉及到函数应该有多长的问题。如果您将函数体保持在十行或更少，那么很难获得太多的缩进级别。

我认为4或5个级别太多了。您几乎可以肯定地将其中一些内部循环或条件分解到它们自己的函数中。

我自己对三个级别的缩进感到不安。即使是两个层次也让我重新考虑我在做什么。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-12-21T06:51:59.763

当他说不超过 3 个级别时，我曾经认为 Linus 在这方面有点硬，否则你的代码就会被破坏，即，但是遵循这个原则对我推理我的控制流有很大帮助。也就是说，我不得不以不同的方式解释它。直观的解释是你应该创建越来越多的函数。我不建议将这个想法发挥到极致，因为这会使你的控制流和副作用变得难以推理，因为当所有副作用都被函数调用所掩盖时，会导致你到处乱跑。

对我帮助极大的是支持延迟处理和更简单的循环。以此为例：

```
// Remove vertices from mesh.
for each vertex in vertices.to_remove:
{
    for each edge in vertex.edges:
    {
        for each face in edge.faces:
        {
             face.remove_edge(edge);
             if (face.size() < 3)
                   face.remove();
        }
        edge.remove();
    }
    vertex.remove();
} 
```

上面有 4 级缩进的那个怪异的东西很尴尬（当它不是伪代码形式时，它可能必须更新纹理贴图等等，需要更多的缩进级别）。我们可以这样做：

```
for each vertex in vertices.to_remove:
{
    for each edge in vertex.edges:
        edges_to_remove.insert(edge);
}

for each edge in edges_to_remove:
{
    for each face in edge.faces:
        faces_to_rebuild.insert(face, edge);
}

for each face,edge in faces_to_rebuild:
{
    face.remove_edge(edge);
    if (face.size() < 3)
         face.remove();
}

for each edge in edges_to_remove:
    edge.remove();

for each vertex in vertices_to_remove:
    vertex.remove(); 
```

虽然这涉及更多的数据传递和一些额外的状态，但它使每个循环更加简单。当我们拥有这些更简单的循环时，它们变得更容易并行化，并且内存访问模式可以开始呈现出对缓存友好的性质，并具有适当的数据结构。

我发现支持这种类型的延迟处理不仅减少了这些缩进，而且还简化了我理解代码在做什么的能力，因为控制流非常简单，而且它们都只会导致一种统一的副作用。它使查看每个循环在做什么并一目了然地理解它是否在做正确的事情变得容易得多，因为每个循环都致力于引起一种类型的副作用，而不是许多不同类型的副作用。令人惊讶的是，尽管有额外的工作，但它通常会提高缓存的一致性，并为多线程和 SIMD 打开新的大门，最终我得到的结果比我开始时还要高效。

# asp.net - 在asp.net web.sitemap中隐藏授权菜单项

> ID：491670
> 
> 赞同：2
> 
> 时间：2009-01-29T13:57:18.253
> 
> 标签：asp.net, asp.net-membership, asp.net-2.0, membership, sitemap

我有一个启用了安全修剪的 web.sitemap，但是我需要将基于角色的菜单项隐藏到在 web.config 中没有访问规则的页面。

即我有一个用于查看现有活动以及添加新活动的活动页面，但我希望对匿名用户隐藏“新活动”菜单项。我尝试将角色名称添加到 web.sitemap 中的角色属性，但这没有效果。

我确信必须有一种快速的方法来做到这一点，而无需修改站点地图提供程序，这是我的下一个停靠港。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T19:47:04.803

如果这只是匿名用户的特殊情况，您可以创建第二个 SiteMap。

创建一个新文件 WebAnon.sitemap。
在 web.config 中创建一个新的站点地图提供程序

```
<add name="anonProvider" type="System.Web.XmlSiteMapProvider" siteMapFile="WebAnon.sitemap" securityTrimmingEnabled="true"/> 
```

如果是匿名用户，则在后面的代码中将 SiteMapDataSource 的[SiteMapProvider属性设置为“anonProvider”。](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.sitemappath.sitemapprovider.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T14:21:11.373

a 中的`roles`属性`<siteMapNode />`是“允许”列表，而不是拒绝。在 web.config 中创建/修改相应的`<location />`元素以允许经过身份验证的用户并拒绝匿名；例如

```
<location path="campaigns.aspx">
 <system.web>
  <authorization>
   <allow users="*" />
   <deny users="?" />
  </authorization>
 </system.web>
</location> 
```

顺便说一句，如果您使用的是 Windows 主体和角色，则对组成员身份的任何更改在您注销然后重新登录之前都不会生效。

# php - 你能把php函数quoted_printable_decode()翻译成一个基于NSString的objective-C函数/类别方法吗？

> ID：491678
> 
> 赞同：0
> 
> 时间：2009-01-29T14:00:37.513
> 
> 标签：php, objective-c, cocoa, string, content-encoding

在[http://php.net/quoted_printable_decode](http://php.net/quoted_printable_decode)中，我找到了使用 preg_replace 的方法。谁知道任何可以将普通 NSString 转换为 RFC 2045 第 6.7 节的代码的人？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T01:58:18.143

Cocoa 上没有解码带引号的可打印字符串的方法，但是您可以轻松地自己编写一些东西，例如：

```
@interface NSString (QuotedPrintableStrings)
+(NSString*)stringWithQuotedPrintableString:(const char *)qpString;
@end

@implementation NSString (QuotedPrintableStrings)

+(NSString*)stringWithQuotedPrintableString:(const char *)qpString
{
    const char *p = qpString;
    char *ep, *utf8_string = malloc(strlen(qpString) * sizeof(char));
    NSParameterAssert( utf8_string );
    ep = utf8_string;

    while( *p ) {
        switch( *p ) {
            case '=':
                NSAssert1( *(p + 1) != 0 && *(p + 2) != 0, @"Malformed QP String: %s", qpString);
                if( *(p + 1) != '\r' ) {
                    int i, byte[2];
                    for( i = 0; i < 2; i++ ) {
                        byte[i] = *(p + i + 1);
                        if( isdigit(byte[i]) )
                            byte[i] -= 0x30;
                        else
                            byte[i] -= 0x37;
                        NSAssert( byte[i] >= 0 && byte[i] < 16, @"bad encoded character");
                    }
                    *(ep++) = (char) (byte[0] << 4) | byte[1];
                }
                p += 3;
                continue;
            default:
                *(ep++) = *(p++);
                continue;
        }
    }
    return [[[NSString alloc] initWithBytesNoCopy:utf8_string length:strlen(utf8_string) encoding:NSUTF8StringEncoding freeWhenDone:YES] autorelease];
}

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-15T17:02:02.333

对于寻求此功能的其他人，[Jason Coco 的](https://stackoverflow.com/questions/491678/can-you-translate-php-function-quoted-printable-decode-to-an-nsstring-based-ob/494243#494243)答案非常有效，但有一个重要错误。在返回之前，您需要在 utf8_string 的末尾添加一个空字符。因此，就在 return 语句之前，添加该行`*ep = '\0';`应该可以解决问题。另外，我修改它以返回 NSData 对象而不是 NSString，因为解码后的字符串可能使用与 UTF-8 不同的字符编码。类似的东西`return [NSData dataWithBytes:(char *)utf8_string length:strlen(utf8_string)];`效果很好。然后调用方法可以使用适当的编码将返回的数据填充回 NSString 中。

# mysql - 在 Mysql 中搜索相似的字符串

> ID：491682
> 
> 赞同：2
> 
> 时间：2009-01-29T14:01:09.713
> 
> 标签：mysql, search

人们对如何搜索同一个词有不同的想法。

例如 Tri-Valley、Trivalley、Tri Valley（甚至可能拼写不正确）

目前，搜索是这样完成的

```
SELECT * FROM `table` WHERE `SchoolDistrict` LIKE '%tri valley%'; 
```

有没有一种简单的方法来说“空格破折号或没有空格”而不写出三个类似的语句？

似乎很容易做到：

```
SELECT * FROM `table` WHERE `SchoolDistrict` LIKE '%tri%valley%'; 
```

但这仅在初始输入为“tri-valley”或“tri valley”时才有效查看大约十几个不同的学区，但我正在寻找解决更大的问题）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T14:06:06.240

如果您有很多不正确的拼写，您可以考虑使用[SOUNDEX](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html)或[SOUNDS LIKE 。](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html)如果你有很多行（或者即使你没有），将输出存储`SOUNDEX`在一个额外的列中可能是明智的。

为了准确起见，我还建议引入一个单独的表，其中包含权威的学区列表，并运行查询以查找不在该列表中的那些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T14:06:18.113

MySQL 有一个名为 Sounds like 的函数。

[链接文本](http://www.pythian.com/blogs/735/mysql-sounds-like-vs-full-text-search)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T14:28:27.007

如果可能的话，这里的一种替代方法是将问题从搜索重新转换为选择。如果您有一组学区，则不要让您的用户输入自由格式的文本来选择学区，而是生成一个下拉列表（如果列表很大，则生成一组级联下拉列表，例如按县，然后按学区）并允许用户选择合适的。将其用于“搜索”和数据输入以消除非规范条目。显然，这仅在您可以枚举所有条目时才有效。

或者，您可以允许用户选择一个开始或包含类型搜索，并根据所选搜索类型简单地生成适当的 SQL（'tri%' 或 '%tri%'）。如果用户知道搜索类型是开头或包含，他们可能会调整他们的搜索字符串，直到它产生他们需要的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T14:12:43.917

您发布的第二条语句应该可以解决问题：

```
SELECT * FROM 'table' WHERE 'SchoolDistrict' LIKE '%tri%valley%'; 
```

在将搜索词传递到 select 语句之前，您应该做的是将所有字符和空格替换为 % 符号。例如，

```
SearchTerm = SearchTerm.Replace(" ","%"); 
```

# .net - 更改文件的只读属性

> ID：491685
> 
> 赞同：1
> 
> 时间：2009-01-29T14:01:44.080
> 
> 标签：.net, readonly, fileinfo

我似乎无法更改文件上的只读标志。我已经在 Vista 和 XP 上尝试过，结果相同，所以我认为这不是 UAC 相关问题。

不过，我所做的一切似乎都不起作用。请参阅下面的示例。有人可以告诉我我做错了什么吗？

```
public bool UpdateResFile(string fileName, string language, string objectName, string NewValue)
{
    FileInfo fi = new FileInfo(fileName); 
    try
    {
        //Do Stuff                
        xDoc.Save(fileToUpdate);
    }
    catch (UnauthorizedAccessException)
    {
        //fi.IsReadOnly = false;
        File.SetAttributes(fileName, FileAttributes.Normal);
        //fi.Attributes -= FileAttributes.ReadOnly;
        return UpdateResFile(fileName, language, objectName, NewValue);
    }
    catch (System.Exception ex)
    {
        Console.WriteLine(ex.Message);
        return false;
    }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T14:44:31.403

无法在 UnauthorizedAccessException 处更改文件的只读属性，因为应用程序正在使用您在计算机中拥有的权限执行。

如果您没有权限将此文件正常更改为只读，您的应用程序也不会更改此属性。

亲切的问候。何塞马。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T14:10:49.303

当您收到 UnauthorisedAccessException 时，您正尝试更改文件上的只读标志。你不能那样做。您可以（并且应该）做的就是通知用户他/她没有将文件保存在那里的访问权限，并提出将文件保存在其他地方。

# ajax - 富 Internet 应用程序中的客户端缓存

> ID：491702
> 
> 赞同：0
> 
> 时间：2009-01-29T14:03:34.793
> 
> 标签：ajax, gwt, caching, rich-internet-application

关于性能改进和我们使用 GWT 构建的 RIA（富 Internet 应用程序），我开始涉足陌生领域。对于那些不熟悉 GWT 的人，基本上在部署时它只是纯 JavaScript。我们通过 XMLHttpRequest 使用 REST 样式的 XML Web 服务与服务器端交互。

我们的 XML 未编组为 JavaScript 对象，并在应用程序中用于表示接口背后的数据模型。发生更改时，模型会更新并编组回 XML 并发送回服务器。

我了解到性能的第一条规则（就用户体验而言）是尽可能少地发出请求。显然这带来了缓存的可能性。缓存非常适合静态数据，但在服务器上的数据可能会发生变化的多用户系统中，事情会变得很棘手。此外，使用“Last-Modified”和“If-Modified-Since”请求还不够，因为我们希望完全避免不必要的请求。

在研究这些方法之前，我试图弄清楚在浏览器中缓存数据是否适合我们。我希望有人曾经走过这条路。我正在寻找类似的方法、经验教训、要避免的事情等。

如果需要，我很乐意提供更具体的信息......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T16:05:51.693

对于 GWT，如果性能对您很重要，您可以通过在单个请求中发送您需要的所有数据来获得更好的性能，而不是查询多个小数据。我建议不要使用客户端数据缓存，因为存在很多问题，例如保持数据与数据库同步。

此外，与传统的 html 应用程序相比，GWT 已经有了很好的优势。除非您正在处理特殊数据（例如：不会太快变得陈旧 - 意味着主要是读取查询），否则我发现没有特别需要缓存。你最好做一个服务层缓存，因为大部分时间应该来自服务器端处理。

如果您可以提供有关应用程序性质的更多详细信息，也许可以得出一些不同的结论。

# asp.net-mvc - ASP.Net MVC 路由问题

> ID：491704
> 
> 赞同：0
> 
> 时间：2009-01-29T14:04:49.427
> 
> 标签：asp.net-mvc

我遇到了 MVC 路由问题（或者至少我认为它是 w/routing :)）...

刚刚升级到 MVC RC1，但我不确定它是否相关，因为这是我第一次尝试设置 MapRoute 和相应的 RouteLink。

这是路线：

```
routes.MapRoute("Test1",
                "Forecast/CurrentLineItems/{propertyID}/{forecastYear}/{forecastMonth}",
                 new { controller = "Forecast", action =   "CurrentLineItems", propertyID = "", forecastYear = "", forecastMonth = "" }
); 
```

这是 RouteLink ...在视图中，它包含在表格单元格中：

```
Html.RouteLink(Html.Encode(myProperty.Description),"Test1", new { controller = "Forecast", action = "CurrentLineItems", propertyID = myProperty.PropertyID.ToString(), forecastYear = "2008", forecastMonth = "10" }) 
```

这是控制器的一个片段：

```
namespace AnApplication.Controllers  
{
[HandleError]
[Authorize]
public class ForecastController : Controller
{        
    [AcceptVerbs(HttpVerbs.Get)]        
    public ActionResult CurrentLineItems(string propertyID, string forecastYear, string forecastMonth)
    {
       //Some code
    } 
```

现在对于奇怪的行为，当我单击 RouteLink 指定的链接时，应用程序进入 CurrentLineItems 方法并且所有方法参数都正确......然后它再次进入 CurrentLineItems 方法！
例如，这些论点：

```
propertyID = "scripts"    
forecastYear = "jquery-1.2.6.js"  
forecastMonth = "" 
```

然后它重复了几次，因为它似乎运行了这个视图和 Site.Master 上的所有脚本，最后一个是这个页面的 .css 文件！
到底是怎么回事！
调用堆栈没有帮助，因为它列出了上面提到的 CurrentLineItems 方法，然后下面是可怕的 [外部代码]

当我在 FireFox/FireBug 中分析页面/视图时，我看到的只是 jQuery 调用

这是来自 Site.Master re 脚本的 html

```
<head runat="server">
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title><%= Html.Encode(ViewData["Title"]) %></title>
    <script type="text/javascript" src="../../scripts/jquery-1.2.6.js"></script>  
    <script type="text/javascript" src="../../scripts/calculations.js"></script>  
    <script type="text/javascript" src="../../scripts/common.js"></script>    
    <style media="all" type="text/css">@import "../../Content/all.css";</style>
    <!--[if IE]><link rel="stylesheet" type="text/css" href="../../Content/ie.css"media="screen"/><![endif]-->      
    <!--<link href="../../Content/Site.css" rel="stylesheet" type="text/css" />-->
</head> 
```

这是脚本视图中的一个片段

```
<%@ Page Language="C#" MasterPageFile="~/Views/Shared/Site.Master"AutoEventWireup="true" CodeBehind="CurrentLineItems.aspx.cs" Inherits="AnApplication.Views.Forecast.CurrentLineItems" %>

<asp:Content ID="lineItemsContent" ContentPlaceHolderID="MainContent" runat="server">
<!--<script type="text/javascript" src="../../scripts/MicrosoftAjax.debug.js"></script>-->
<script type="text/javascript" src="../../scripts/lineItems.js"></script>
<script type="text/javascript" src="../../Scripts/jquery.formatCurrency.js"></script>
<!--<script type="text/javascript" src="../../scripts/jquery-1.2.6.min.js"></script>--> 
```

请注意，此 ActionLink 工作正常（它基本上只是一个用于测试的菜单项，三个参数在控制器内部的代码中设置......）：

```
<%= Html.ActionLink("Line Items", "CurrentLineItems", "Forecast")%> 
```

非常感谢解决此问题的任何帮助。

谢谢，
格雷格

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T02:12:16.757

事实上，最近发布的 ASP.NET MVC 候选版本中有两个微妙但令人讨厌的错误。这是两个错误：

1.  我们更改了所有 URL 呈现方法以呈现相对 URL 而不是绝对 URL。虽然我们认为这可能是总体上正确的决定，但我们发现它打破了很多场景。AJAX 场景尤其受到影响，因为用于异步检索数据的 URL 通常与浏览器地址栏中的原始 URL 不同。

2.  Html.RouteLink 特别是（而*不是*Html.ActionLink）有一个错误（所以它实际上不是一个红鲱鱼 - 至少不一定）。Html.RouteLink 将错误地采用“当前”控制器和操作并将这些值传递到路由系统。只有 Html.ActionLink 应该这样做。Html.RouteLink 根本不应该做任何处理。它应该只获取您给它的值并将其传递给 ASP.NET 路由系统。

由于这两个错误都很糟糕，我们决定回滚导致 #1 的更改并修复导致 #2 的问题并发布更新的 ASP.NET MVC Release Candidate *Refresh*。

您将在 ScottGu 的博客、Phil Haack 的博客和 ASP.NET MVC 论坛上看到一些详细介绍刷新的帖子。

谢谢，艾隆

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T16:24:57.537

这可能是由于使用了包含脚本的相对路径造成的。

当您单击链接时，新页面的 URL 将类似于[http://[server]/Forecast/CurrentLineItems/xxx/2009/1](http://[server]/Forecast/CurrentLineItems/xxx/2009/1)

现在检查浏览器中的 html 代码：如果 URL 是 '../../scripts/jquery-1.2.6.js' 的形式，这将导致浏览器从[http://[server加载它]/Forecast/CurrentLineItems/scripts/jquery-1.2.6.js](http://[server]/Forecast/CurrentLineItems/scripts/jquery-1.2.6.js) - 所以你的控制器被再次调用。

如果是这种情况，您可以使用绝对路径（'/scripts/jquery-1.2.6.js'）或使用相对于应用程序根目录的路径（'~/scripts/jquery-1.2.6.js'）和使用 Page.ResolveClientUrl() 在服务器端解决它。

也许从 Beta 到 RC1 已经发生了变化，因此头部中的 URL，即使使用 runat="server"，也不会被重新映射。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T14:42:10.067

RouteLink 与 ActionLink 是一个红鲱鱼。唯一重要的是呈现的 href="[something]"。如果您手动编写 a href 而不是通过 RouteLink 生成它，您将获得完全相同的结果。

所以，是的，现在我们要开始路由了。在您的控制器操作中，在调试器中检查 RouteData，并查看匹配的路由名称。很有可能它是错误的，这会导致其他事情行为不端。要么更改代表的顺序，要么添加约束以防止匹配错误。

RouteLink 可以很好地防止在生成 URL 时找到错误的路线。但是当您的应用程序使用 URL 时，您仍然需要在 global.asax 中按顺序排列路由。

# python - Python：本地模块覆盖全局模块的问题

> ID：491705
> 
> 赞同：17
> 
> 时间：2009-01-29T14:04:51.547
> 
> 标签：python

我有一个像这样设置的包：

```
packagename/
    __init__.py
    numbers.py
    tools.py
    ...other stuff 
```

现在在里面`tools.py`，我正在尝试导入标准库模块`fractions`。但是，`fractions`模块本身会导入该`numbers`模块，该模块应该是标准库中的模块。

问题是它尝试`numbers`从*我的*包中导入模块（即我`numbers.py`正在隐藏 stdlib`numbers`模块），然后抱怨它，而不是导入 stdlib 模块。

我的问题是，是否有一种解决方法，以便我可以保留我的包的当前结构，或者是重命名我自己的违规模块（`numbers.py`）的唯一解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-29T14:33:14.267

从 python2.5（带导入）开始可以使用[绝对和相对](http://www.python.org/dev/peps/pep-0328/)`__future__`导入，并且似乎是您正在寻找的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-29T15:25:15.520

我尽量避免遮蔽标准库。将你的模块重命名为 "_numbers.py" 怎么样？

当然，你仍然可以这样做：

```
import _numbers as numbers 
```

# javascript - 取消 jQuery 事件处理

> ID：491707
> 
> 赞同：11
> 
> 时间：2009-01-29T14:05:06.787
> 
> 标签：javascript, jquery, events

我通过以下方式设置了 onclick 事件处理程序：

```
element.onclick = function() { /*code */ } 
```

想象一下使用 jQuery 方法 bind() 或类似的处理程序设置事件处理程序。

```
$('element').bind('click', function(){/*another function*/}) 
```

如何防止从我在开头描述的处理程序中调用使用 jQuery 定义的处理程序？

注意 stopPropagation() 等。jQuery 的方法不适用于该函数，因为它是通过本机事件对象传递的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T14:35:50.940

我不是 100% 确定你在问什么，但也许这会有所帮助：

您可以通过 jQuery 公开的 Event 构造函数创建一个新的事件对象（符合 W3C DOM）：

例如：

```
element.onclick = function(e) {
    var aBetterEventObject = jQuery.Event(e);
    // Now you can do what you want: (Cross-browser)
    aBetterEventObject.preventDefault()
    aBetterEventObject.isDefaultPrevented()
    aBetterEventObject.stopPropagation()
    aBetterEventObject.isPropagationStopped()
    aBetterEventObject.stopImmediatePropagation()
    aBetterEventObject.isImmediatePropagationStopped()
} 
```

* * *

编辑：再次阅读您的问题，我认为传播不是问题 - 您似乎想取消在事件处理程序中运行的事件处理程序 - 我不确定这是可能的。您可以取消绑定所有处理程序（*jQuery(elem).unbind('click')*），但我认为这不是您所追求的......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T14:50:43.077

继 JimmyP 的回答之后。我试过这个

```
$('#x').click( function(e){
    alert('hello');
});
document.getElementById('x').onclick = function(){
    $('#x').unbind('click');
    alert("goodbye");
} 
```

jQuery 事件在此示例中运行一次。我不认为你可以依赖被调用的处理程序的顺序，但是你定义它们，所以我想你必须接受 jQuery 事件可能会触发一次。首先添加 onclick 确实会阻止 jQuery 事件触发，但正如我所说，我认为这不可靠。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-29T14:36:31.250

尝试在 jQuery 事件处理程序中添加以下行：

```
return false; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-29T20:16:37.100

Jquery 有一个命名空间事件的方法。[http://docs.jquery.com/Namespaced_Events](http://docs.jquery.com/Namespaced_Events)

您可以通过命名空间添加、触发和删除绑定到同一事件的单独函数：

```
$("a").bind("click.custom1",function(){ ... });
$("a").bind("click.custom2",function(){ ... });
$("a").trigger("click.custom2");
$("a").unbind("click.custom2"); 
```

只要您取消绑定命名空间事件，您的正常 onclick 应该不受影响。如果这不起作用，您可能必须将两个单独的命名空间绑定到上面的 click 事件。

# java - 我可以在 Eclipse 上构建 Swing 应用程序吗？

> ID：491726
> 
> 赞同：5
> 
> 时间：2009-01-29T14:11:50.393
> 
> 标签：java, eclipse, swing

我曾经在 netbeans 上工作以构建 Java 应用程序，但现在：我正在使用 eclipse。我想知道是否有一个免费的好插件来帮助我摆动窗户。??

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T14:17:03.940

[Jigloo - CloudGarden](http://www.cloudgarden.com/jigloo/index.html)（免费非商业）

[可视化编辑器项目](http://www.eclipse.org/vep/WebContent/main.php)

AND [JForm](http://www.formdev.com/buy/)（付费）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T14:17:22.303

我假设你想要一个 GUI 设计器。最好的插件是优秀的[Swing Designer](http://www.instantiations.com/windowbuilder/swingdesigner/index.html)。绝对值得一看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T14:19:03.360

[Jigloo](http://www.cloudgarden.com/jigloo/)可免费用于非商业用途。[Eclipse Plugin Central的](http://www.eclipseplugincentral.com/)[UI 类别](http://www.eclipseplugincentral.com/Web_Links-index-req-viewcatlink-cid-18.html)中还有其他内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T16:28:21.540

[JForm](http://www.formdev.com/)设计器是一个很好的摇摆设计器，但它不是免费的。

# java - log4j 配置中子类别的覆盖级别

> ID：491729
> 
> 赞同：0
> 
> 时间：2009-01-29T14:12:45.260
> 
> 标签：java, log4j, auditing

我的申请中有一些审核。每个审计事件都有自己的 log4j 类别，其名称以相同的字符串为前缀。

EG：一般审计类别名称：com.company.audit

网络登录类别名称：com.company.audit.web.login
创建一些东西：com.company.audit.api.create 等。

默认情况下应该记录一些类别，但有些不是=>

```
<category name="com.compamy.audit" additivity="true">
    <priority value="INFO"/>
</category>

<category name="com.company.audit.web.login" additivity="true">
  <priority value="DEBUG">
</category> 
```

默认情况下，不应记录 INFO 第二类。至少我是这么想的，但它不起作用。任何帮助如何覆盖“子类别”上的日志记录级别。

注意：我不太可能更改整个命名方案

添加：

这是附加程序的配置：

```
<appender class="org.apache.log4j.RollingFileAppender" name="Company_AUDIT">

<param name="File" value="${jboss.server.log.dir}/company_audit.log"/>

<param value="10000KB" name="MaxFileSize"/>

<param value="10" name="MaxBackupIndex"/>

<layout class="org.apache.log4j.PatternLayout">
    <param name="ConversionPattern" value="foo"/>
</layout>

</appender> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T10:11:29.427

您的配置意味着：对于 category `com.company.audit`，记录所有级别`INFO`或更高级别的消息。对于`com.company.audit.web.login`，记录所有级别`DEBUG`或更高级别的消息。所以第二类的所有消息都被记录下来，这就是你所要求的。

您真正想要的是选择是否显示第二个类别。我可以想到两种方法来做到这一点：

1.  在您的代码中，使用所有消息都将记录在 level 中的约定`com.company.audit`，`INFO`并且所有消息`com.company.audit.web.login`都将记录在 level`DEBUG`中。在你的配置中，你只需要设置主类的级别：

    *   `DEBUG`: 显示所有消息
    *   `INFO`：不显示“可选”消息（即子类别的消息）
2.  在配置中，当您想要禁用其消息时，将其设置`com.company.audit.web.login`为水平。`OFF`当您想激活它时，只需注释该行（它将继承主类别的配置）。

我更喜欢第二个选项，因为您可以继续使用级别来表示消息重力（它最初的用途）。

# c# - 如何使用 C# 找到 Windows 服务的安装目录？

> ID：491735
> 
> 赞同：19
> 
> 时间：2009-01-29T14:14:07.660
> 
> 标签：c#, windows, windows-services

我很确定 Windows 服务在使用 InstallUtil.exe 安装时会将 C:\winnt（或类似的）作为其工作目录。有什么方法可以访问或捕获（在安装时）最初安装服务的目录？目前我手动将其输入到 app.exe.config 文件中，但这是非常手动的，感觉就像一个黑客。

在运行时或安装时是否有一种编程方式来确定服务的安装位置？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-29T14:24:30.883

您可以使用反射来获取正在执行的程序集的位置。这是一个简单的例程，它使用反射将工作目录设置为执行程序集的位置：

```
String path = System.Reflection.Assembly.GetExecutingAssembly().Location;
path = System.IO.Path.GetDirectoryName(path);
Directory.SetCurrentDirectory(path); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-29T14:18:36.060

你的意思是你想要包含程序集的目录吗？如果是这样，那很容易：使用[`Assembly.Location`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.location.aspx).

不过，我不会尝试*更改*该过程的工作目录-如果确实允许您这样做，如果这会产生令人讨厌的副作用，我不会感到惊讶。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-05-10T13:50:12.477

我不知道`Directory.SetCurrentDirectory`方法。通常我会这样做：

```
Environment.CurrentDirectory = System.AppDomain.CurrentDomain.BaseDirectory; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-24T01:19:44.633

虽然很晚，但它可能会对某人有所帮助。我通过使用 AppDomain.CurrentDomain.BaseDirectory 解决了这个问题

```
string someFilePath = AppDomain.CurrentDomain.BaseDirectory + @"\Resources\SomeResource.xml"; 
```

AppDomain.CurrentDomain.BaseDirectory 给出了实际安装 Windows 服务的目录，而不是 C:\Windows\system32\ 路径。

后来我看到@Ramon 已经发布了相同的解决方案。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-29T14:19:27.943

`InstallUtil.exe``ServiceInstaller.Install()`在安装时调用您的应用程序。

覆盖它，将其添加到您的项目列表中`Installers`并获取您需要的任何信息。

# algorithm - 如何计算一组循环数据的平均值？

> ID：491738
> 
> 赞同：160
> 
> 时间：2009-01-29T14:15:18.843
> 
> 标签：algorithm, math, geometry

我想计算一组循环数据的平均值。例如，我可能有几个指南针读数的样本。问题当然是如何处理环绕。相同的算法可能对表盘有用。

实际问题更复杂 - 统计在球体或“环绕”的代数空间中意味着什么，例如加法组 mod n。答案可能不是唯一的，例如 359 度和 1 度的平均值可能是 0 度或 180 度，但统计上 0 看起来更好。

这对我来说是一个真正的编程问题，我试图让它看起来不仅仅是一个数学问题。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-01-29T14:22:47.783

从角度计算单位向量并取其平均值的角度。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-01-29T14:58:05.323

这个问题在书中进行了详细研究：“球体统计”，Geoffrey S. Watson，阿肯色大学数学科学讲义，1983 年 John Wiley & Sons, Inc.，如[http://catless.ncl 所述。 ac.uk/Risks/7.44.html#subj4](http://catless.ncl.ac.uk/Risks/7.44.html#subj4)，作者 Bruce Karsh。

从一组角度测量值 a[i] 0<=i 估计平均角度 A 的好方法

```
 sum_i_from_1_to_N sin(a[i])
a = arctangent ---------------------------
                   sum_i_from_1_to_N cos(a[i]) 
```

starblue 给出的方法在计算上是等价的，但他的理由更清楚，可能在编程上更有效，并且在零情况下也能很好地工作，所以对他表示敬意。

该主题现在[在 Wikipedia 上](http://en.wikipedia.org/wiki/Circular_mean)进行了更详细的探索，并具有其他用途，例如分数部分。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2009-01-29T14:26:18.803

我看到了问题 - 例如，如果您有 45' 角和 315' 角，“自然”平均值将为 180'，但您想要的值实际上是 0'。

我认为 Starblue 是在做某事。只需计算每个角度的 (x, y) 笛卡尔坐标，然后将这些结果向量相加。最终向量的角度偏移应该是您需要的结果。

```
x = y = 0
foreach angle {
    x += cos(angle)
    y += sin(angle)
}
average_angle = atan2(y, x) 
```

我现在忽略指南针航向从北开始，顺时针方向移动，而“正常”笛卡尔坐标沿 X 轴从零开始，然后逆时针方向移动。无论如何，数学应该以相同的方式进行。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-07-21T13:52:01.627

**对于两个角度的特殊情况：**

答案*( (a + b) mod 360 ) / 2*是**错误**的。对于角度 350 和 2，最近点是 356，而不是 176。

单位向量和三角解可能过于昂贵。

我从小修修补补中得到的是：

```
diff = ( ( a - b + 180 + 360 ) mod 360 ) - 180
angle = (360 + b + ( diff / 2 ) ) mod 360 
```

*   0, 180 -> 90（有两个答案：这个方程从 a 中取顺时针答案）
*   180, 0 -> 270（见上文）
*   180, 1 -> 90.5
*   1, 180 -> 90.5
*   20, 350 -> 5
*   350, 20 -> 5（以下所有示例也正确反转）
*   10, 20 -> 15
*   350, 2 -> 356
*   359, 0 -> 359.5
*   180, 180 -> 180

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-09-06T13:44:55.293

ackb 是正确的，这些基于向量的解决方案不能被视为角度的真实平均值，它们只是单位向量对应物的平均值。但是，ackb 建议的解决方案在数学上似乎并不合理。

以下是从最小化 (angle[i] - avgAngle)^2 的目标（必要时校正差异）的数学方法得出的解决方案，这使其成为角度的真正算术平均值。

首先，我们需要准确地查看哪些情况下角度之间的差异与其正常数对应物之间的差异不同。考虑角度 x 和 y，如果 y >= x - 180 并且 y <= x + 180，那么我们可以直接使用差 (xy)。否则，如果第一个条件不满足，那么我们必须在计算中使用 (y+360) 而不是 y。相应地，如果不满足第二个条件，那么我们必须使用 (y-360) 代替 y。由于我们最小化的曲线方程仅在这些不等式从真变为假或反之亦然的点处发生变化，因此我们可以将整个 [0,360) 范围分成一组段，由这些点分隔。然后，我们只需要找到这些段的最小值，然后每个段的最小值中的最小值，也就是平均值。

这是一张图片，展示了计算角度差时出现问题的地方。如果 x 位于灰色区域，那么就会有问题。

[![角度比较](https://i.stack.imgur.com/Gcdf9.png)](https://i.stack.imgur.com/Gcdf9.png)

为了最小化一个变量，根据曲线，我们可以取我们想要最小化的导数，然后我们找到转折点（导数 = 0）。

在这里，我们将应用最小化平方差的思想来推导常见的算术平均公式：sum(a[i])/n。曲线 y = sum((a[i]-x)^2) 可以通过这种方式最小化：

```
y = sum((a[i]-x)^2)
= sum(a[i]^2 - 2*a[i]*x + x^2)
= sum(a[i]^2) - 2*x*sum(a[i]) + n*x^2

dy\dx = -2*sum(a[i]) + 2*n*x

for dy/dx = 0:
-2*sum(a[i]) + 2*n*x = 0
-> n*x = sum(a[i])
-> x = sum(a[i])/n 
```

现在将其应用于具有我们调整的差异的曲线：

b = a 的子集，其中正确的（角度）差异 a[i]-x c = a 的子集，其中正确的（角度）差异 (a[i]-360)-x cn = c 的大小 d = a 的子集，其中正确（角度）差异 (a[i]+360)-x dn = d 的大小

```
y = sum((b[i]-x)^2) + sum(((c[i]-360)-b)^2) + sum(((d[i]+360)-c)^2)
= sum(b[i]^2 - 2*b[i]*x + x^2)
  + sum((c[i]-360)^2 - 2*(c[i]-360)*x + x^2)
  + sum((d[i]+360)^2 - 2*(d[i]+360)*x + x^2)
= sum(b[i]^2) - 2*x*sum(b[i])
  + sum((c[i]-360)^2) - 2*x*(sum(c[i]) - 360*cn)
  + sum((d[i]+360)^2) - 2*x*(sum(d[i]) + 360*dn)
  + n*x^2
= sum(b[i]^2) + sum((c[i]-360)^2) + sum((d[i]+360)^2)
  - 2*x*(sum(b[i]) + sum(c[i]) + sum(d[i]))
  - 2*x*(360*dn - 360*cn)
  + n*x^2
= sum(b[i]^2) + sum((c[i]-360)^2) + sum((d[i]+360)^2)
  - 2*x*sum(x[i])
  - 2*x*360*(dn - cn)
  + n*x^2

dy/dx = 2*n*x - 2*sum(x[i]) - 2*360*(dn - cn)

for dy/dx = 0:
2*n*x - 2*sum(x[i]) - 2*360*(dn - cn) = 0
n*x = sum(x[i]) + 360*(dn - cn)
x = (sum(x[i]) + 360*(dn - cn))/n 
```

仅此一项不足以获得最小值，而它适用于具有无限集合的正常值，因此结果肯定会在集合的范围内，因此是有效的。我们需要一个范围内的最小值（由段定义）。如果最小值小于我们分段的下限，则该分段的最小值必须在下限（因为二次曲线只有 1 个转折点），如果最小值大于我们分段的上限，则该分段的最小值在上限。在我们得到每个段的最小值之后，我们只需找到我们要最小化的值最低的那个 (sum((b[i]-x)^2) + sum(((c[i]-360 )-b)^2) + sum(((d[i]+360)-c)^2))。

这是曲线的图像，显​​示了它在 x=(a[i]+180)%360 的点处的变化。有问题的数据集是 {65,92,230,320,250}。

[![曲线](https://i.stack.imgur.com/bN15O.png)](https://i.stack.imgur.com/bN15O.png)

这是该算法在 Java 中的实现，包括一些优化，其复杂度为 O(nlogn)。如果将基于比较的排序替换为非基于比较的排序，例如基数排序，则它可以减少到 O(n)。

```
static double varnc(double _mean, int _n, double _sumX, double _sumSqrX)
{
    return _mean*(_n*_mean - 2*_sumX) + _sumSqrX;
}
//with lower correction
static double varlc(double _mean, int _n, double _sumX, double _sumSqrX, int _nc, double _sumC)
{
    return _mean*(_n*_mean - 2*_sumX) + _sumSqrX
            + 2*360*_sumC + _nc*(-2*360*_mean + 360*360);
}
//with upper correction
static double varuc(double _mean, int _n, double _sumX, double _sumSqrX, int _nc, double _sumC)
{
    return _mean*(_n*_mean - 2*_sumX) + _sumSqrX
            - 2*360*_sumC + _nc*(2*360*_mean + 360*360);
}

static double[] averageAngles(double[] _angles)
{
    double sumAngles;
    double sumSqrAngles;

    double[] lowerAngles;
    double[] upperAngles;

    {
        List<Double> lowerAngles_ = new LinkedList<Double>();
        List<Double> upperAngles_ = new LinkedList<Double>();

        sumAngles = 0;
        sumSqrAngles = 0;
        for(double angle : _angles)
        {
            sumAngles += angle;
            sumSqrAngles += angle*angle;
            if(angle < 180)
                lowerAngles_.add(angle);
            else if(angle > 180)
                upperAngles_.add(angle);
        }

        Collections.sort(lowerAngles_);
        Collections.sort(upperAngles_,Collections.reverseOrder());

        lowerAngles = new double[lowerAngles_.size()];
        Iterator<Double> lowerAnglesIter = lowerAngles_.iterator();
        for(int i = 0; i < lowerAngles_.size(); i++)
            lowerAngles[i] = lowerAnglesIter.next();

        upperAngles = new double[upperAngles_.size()];
        Iterator<Double> upperAnglesIter = upperAngles_.iterator();
        for(int i = 0; i < upperAngles_.size(); i++)
            upperAngles[i] = upperAnglesIter.next();
    }

    List<Double> averageAngles = new LinkedList<Double>();
    averageAngles.add(180d);
    double variance = varnc(180,_angles.length,sumAngles,sumSqrAngles);

    double lowerBound = 180;
    double sumLC = 0;
    for(int i = 0; i < lowerAngles.length; i++)
    {
        //get average for a segment based on minimum
        double testAverageAngle = (sumAngles + 360*i)/_angles.length;
        //minimum is outside segment range (therefore not directly relevant)
        //since it is greater than lowerAngles[i], the minimum for the segment
        //must lie on the boundary lowerAngles[i]
        if(testAverageAngle > lowerAngles[i]+180)
            testAverageAngle = lowerAngles[i];

        if(testAverageAngle > lowerBound)
        {
            double testVariance = varlc(testAverageAngle,_angles.length,sumAngles,sumSqrAngles,i,sumLC);

            if(testVariance < variance)
            {
                averageAngles.clear();
                averageAngles.add(testAverageAngle);
                variance = testVariance;
            }
            else if(testVariance == variance)
                averageAngles.add(testAverageAngle);
        }

        lowerBound = lowerAngles[i];
        sumLC += lowerAngles[i];
    }
    //Test last segment
    {
        //get average for a segment based on minimum
        double testAverageAngle = (sumAngles + 360*lowerAngles.length)/_angles.length;
        //minimum is inside segment range
        //we will test average 0 (360) later
        if(testAverageAngle < 360 && testAverageAngle > lowerBound)
        {
            double testVariance = varlc(testAverageAngle,_angles.length,sumAngles,sumSqrAngles,lowerAngles.length,sumLC);

            if(testVariance < variance)
            {
                averageAngles.clear();
                averageAngles.add(testAverageAngle);
                variance = testVariance;
            }
            else if(testVariance == variance)
                averageAngles.add(testAverageAngle);
        }
    }

    double upperBound = 180;
    double sumUC = 0;
    for(int i = 0; i < upperAngles.length; i++)
    {
        //get average for a segment based on minimum
        double testAverageAngle = (sumAngles - 360*i)/_angles.length;
        //minimum is outside segment range (therefore not directly relevant)
        //since it is greater than lowerAngles[i], the minimum for the segment
        //must lie on the boundary lowerAngles[i]
        if(testAverageAngle < upperAngles[i]-180)
            testAverageAngle = upperAngles[i];

        if(testAverageAngle < upperBound)
        {
            double testVariance = varuc(testAverageAngle,_angles.length,sumAngles,sumSqrAngles,i,sumUC);

            if(testVariance < variance)
            {
                averageAngles.clear();
                averageAngles.add(testAverageAngle);
                variance = testVariance;
            }
            else if(testVariance == variance)
                averageAngles.add(testAverageAngle);
        }

        upperBound = upperAngles[i];
        sumUC += upperBound;
    }
    //Test last segment
    {
        //get average for a segment based on minimum
        double testAverageAngle = (sumAngles - 360*upperAngles.length)/_angles.length;
        //minimum is inside segment range
        //we test average 0 (360) now           
        if(testAverageAngle < 0)
            testAverageAngle = 0;

        if(testAverageAngle < upperBound)
        {
            double testVariance = varuc(testAverageAngle,_angles.length,sumAngles,sumSqrAngles,upperAngles.length,sumUC);

            if(testVariance < variance)
            {
                averageAngles.clear();
                averageAngles.add(testAverageAngle);
                variance = testVariance;
            }
            else if(testVariance == variance)
                averageAngles.add(testAverageAngle);
        }
    }

    double[] averageAngles_ = new double[averageAngles.size()];
    Iterator<Double> averageAnglesIter = averageAngles.iterator();
    for(int i = 0; i < averageAngles_.length; i++)
        averageAngles_[i] = averageAnglesIter.next();

    return averageAngles_;
} 
```

一组角度的算术平均值可能与您对平均值应该是什么的直观想法不一致。例如，集合 {179,179,0,181,181} 的算术平均值为 216（和 144）。您立即想到的答案可能是 180，但是众所周知，算术平均值受边缘值的影响很大。您还应该记住，角度不是矢量，有时在处理角度时可能看起来很吸引人。

该算法当然也适用于所有服从模运算（调整最少）的量，例如一天中的时间。

我还要强调的是，尽管这是角度的真实平均值，但与矢量解决方案不同，这并不一定意味着它是您应该使用的解决方案，相应单位矢量的平均值很可能是您实际的值应该使用。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-29T14:25:32.817

您必须更准确地定义*平均值。*对于两个角度的具体情况，我可以想到两种不同的场景：

1.  “真实”平均值，即 (a + b) / 2 % 360。
2.  在同一半圆中指向其他两个“之间”的角度，例如对于 355 和 5，这将是 0，而不是 180。为此，您需要检查两个角度之间的差异是否大于 180或不。如果是这样，请在使用上述公式之前将较小的角度增加 360。

不过，我看不出如何将第二种选择推广到两个以上角度的情况。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-07-22T23:55:23.567

我想分享一个我在没有浮点或三角函数功能的微控制器上使用的方法。我仍然需要“平均”10 个原始轴承读数以消除变化。

1.  检查第一个方位是否在270-360或0-90度范围内（北二象限）
2.  如果是，则将此读数和所有后续读数旋转 180 度，将所有值保持在 0 <= 轴承 < 360 的范围内。否则，读取读数。
3.  一旦取得 10 个读数，计算数值平均值，假设没有回绕
4.  如果 180 度旋转已生效，则将计算出的平均值旋转 180 度以返回“真实”方位。

这并不理想；它可以打破。在这种情况下，我侥幸逃脱，因为设备的旋转速度非常慢。我会把它放在那里，以防其他人发现自己在类似的限制下工作。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-12-12T00:20:43.340

在 python 中，角度在 [-180, 180) 之间

```
def add_angles(a, b):
  return (a + b + 180) % 360 - 180

def average_angles(a, b):
  return add_angles(a, add_angles(-a, b)/2) 
```

细节：

对于**两个角度**的平均值，有两个相隔 180° 的平均值，但我们可能想要更接近的平均值。

**从视觉上看，蓝色 ( b** ) 和绿色 ( **a** )的平均值产生蓝绿色点：

[![原来的](https://i.stack.imgur.com/S4fRC.png)](https://i.stack.imgur.com/S4fRC.png)

角度“环绕”（例如 355 + 10 = 5），但标准算术将忽略此分支点。但是，如果角度**b**与分支点相反，则 ( **b** + **g** )/2 给出最接近的平均值：蓝绿色点。

对于任意两个角度，我们可以旋转问题，使其中一个角度与分支点相反，执行标准平均，然后旋转回去。

[![旋转](https://i.stack.imgur.com/PbcM1.png)](https://i.stack.imgur.com/PbcM1.png)[![回来](https://i.stack.imgur.com/42Idm.png)](https://i.stack.imgur.com/42Idm.png)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-04-04T18:12:32.107

像所有平均值一样，答案取决于指标的选择。对于给定的度量 M，对于 [1,N] 中的 k，[-pi,pi] 中的某些角度 a_k 的平均值是使距离平方和 d^2_M(a_M,a_k) 最小化的角度 a_M。对于加权平均值，只需将权重 w_k 包含在总和中（使得 sum_k w_k = 1）。那是，

a_M = arg min_x sum_k w_k d^2_M(x,a_k)

两种常见的度量选择是 Frobenius 和 Riemann 度量。对于 Frobenius 度量，存在一个直接公式，对应于循环统计中的平均方位角的通常概念。有关详细信息，请参见“旋转组中的均值和平均”，Maher Moakher，SIAM 矩阵分析和应用杂志，第 24 卷，第 1 期，2002 年。
[http://link.aip.org/link/?SJMAEL/24/1/1](http://link.aip.org/link/?SJMAEL/24/1/1)

这是 GNU Octave 3.2.4 的一个函数，它进行计算：

```
function ma=meanangleoct(a,w,hp,ntype)
%   ma=meanangleoct(a,w,hp,ntype) returns the average of angles a
%   given weights w and half-period hp using norm type ntype
%   Ref: "Means and Averaging in the Group of Rotations",
%   Maher Moakher, SIAM Journal on Matrix Analysis and Applications,
%   Volume 24, Issue 1, 2002.

if (nargin<1) | (nargin>4), help meanangleoct, return, end 
if isempty(a), error('no measurement angles'), end
la=length(a); sa=size(a); 
if prod(sa)~=la, error('a must be a vector'); end
if (nargin<4) || isempty(ntype), ntype='F'; end
if ~sum(ntype==['F' 'R']), error('ntype must be F or R'), end
if (nargin<3) || isempty(hp), hp=pi; end
if (nargin<2) || isempty(w), w=1/la+0*a; end
lw=length(w); sw=size(w); 
if prod(sw)~=lw, error('w must be a vector'); end
if lw~=la, error('length of w must equal length of a'), end
if sum(w)~=1, warning('resumming weights to unity'), w=w/sum(w); end

a=a(:);     % make column vector
w=w(:);     % make column vector
a=mod(a+hp,2*hp)-hp;    % reduce to central period
a=a/hp*pi;              % scale to half period pi
z=exp(i*a); % U(1) elements

% % NOTA BENE:
% % fminbnd can get hung up near the boundaries.
% % If that happens, shift the input angles a
% % forward by one half period, then shift the
% % resulting mean ma back by one half period.
% X=fminbnd(@meritfcn,-pi,pi,[],z,w,ntype);

% % seems to work better
x0=imag(log(sum(w.*z)));
X=fminbnd(@meritfcn,x0-pi,x0+pi,[],z,w,ntype);

% X=real(X);              % truncate some roundoff
X=mod(X+pi,2*pi)-pi;    % reduce to central period
ma=X*hp/pi;             % scale to half period hp

return
%%%%%%

function d2=meritfcn(x,z,w,ntype)
x=exp(i*x);
if ntype=='F'
    y=x-z;
else % ntype=='R'
    y=log(x'*z);
end
d2=y'*diag(w)*y;
return
%%%%%%

% %   test script
% % 
% % NOTA BENE: meanangleoct(a,[],[],'R') will equal mean(a) 
% % when all abs(a-b) < pi/2 for some value b
% % 
% na=3, a=sort(mod(randn(1,na)+1,2)-1)*pi;
% da=diff([a a(1)+2*pi]); [mda,ndx]=min(da);
% a=circshift(a,[0 2-ndx])    % so that diff(a(2:3)) is smallest
% A=exp(i*a), B1=expm(a(1)*[0 -1; 1 0]), 
% B2=expm(a(2)*[0 -1; 1 0]), B3=expm(a(3)*[0 -1; 1 0]),
% masimpl=[angle(mean(exp(i*a))) mean(a)]
% Bsum=B1+B2+B3; BmeanF=Bsum/sqrt(det(Bsum)); 
% % this expression for BmeanR should be correct for ordering of a above
% BmeanR=B1*(B1'*B2*(B2'*B3)^(1/2))^(2/3);
% mamtrx=real([[0 1]*logm(BmeanF)*[1 0]' [0 1]*logm(BmeanR)*[1 0]'])
% manorm=[meanangleoct(a,[],[],'F') meanangleoct(a,[],[],'R')]
% polar(a,1+0*a,'b*'), axis square, hold on
% polar(manorm(1),1,'rs'), polar(manorm(2),1,'gd'), hold off

%     Meanangleoct Version 1.0
%     Copyright (C) 2011 Alphawave Research, robjohnson@alphawaveresearch.com
%     Released under GNU GPLv3 -- see file COPYING for more info.
%
%     Meanangle is free software: you can redistribute it and/or modify
%     it under the terms of the GNU General Public License as published by
%     the Free Software Foundation, either version 3 of the License, or (at
%     your option) any later version.
%
%     Meanangle is distributed in the hope that it will be useful, but
%     WITHOUT ANY WARRANTY; without even the implied warranty of
%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
%     General Public License for more details.
%
%     You should have received a copy of the GNU General Public License
%     along with this program.  If not, see `http://www.gnu.org/licenses/'. 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-08-30T04:30:11.127

这是完整的解决方案：（输入是以度为单位的方位数组（0-360）

```
public static int getAvarageBearing(int[] arr)
{
    double sunSin = 0;
    double sunCos = 0;
    int counter = 0;

    for (double bearing : arr)
    {
        bearing *= Math.PI/180;

        sunSin += Math.sin(bearing);
        sunCos += Math.cos(bearing);
        counter++; 
    }

    int avBearing = INVALID_ANGLE_VALUE;
    if (counter > 0)
    {
        double bearingInRad = Math.atan2(sunSin/counter, sunCos/counter);
        avBearing = (int) (bearingInRad*180f/Math.PI);
        if (avBearing<0)
            avBearing += 360;
    }

    return avBearing;
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-08-26T00:32:53.817

用英语：

1.  制作第二个数据集，所有角度偏移 180。
2.  取两个数据集的方差。
3.  取方差最小的数据集的平均值。
4.  如果此平均值来自移位集，则将答案再次移位 180。

在蟒蛇中：

#numpy NX1 角度数组

```
if np.var(A) < np.var((A-180)%360):
    average = np.average(A)

else:
    average = (np.average((A-180)%360)+180)%360 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-08-27T08:33:35.507

我会使用复数采用矢量方式。我的示例是在 Python 中，它具有内置的复数：

```
import cmath # complex math

def average_angle(list_of_angles):

    # make a new list of vectors
    vectors= [cmath.rect(1, angle) # length 1 for each vector
        for angle in list_of_angles]

    vector_sum= sum(vectors)

    # no need to average, we don't care for the modulus
    return cmath.phase(vector_sum) 
```

请注意，Python*不需要*构建一个临时的新向量列表，以上所有操作都可以一步完成；我只是选择这种方式来近似适用于其他语言的伪代码。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-01-11T14:44:41.530

这是一个完整的 C++ 解决方案：

```
#include <vector>
#include <cmath>

double dAngleAvg(const vector<double>& angles) {
    auto avgSin = double{ 0.0 };
    auto avgCos = double{ 0.0 };
    static const auto conv      = double{ 0.01745329251994 }; // PI / 180
    static const auto i_conv    = double{ 57.2957795130823 }; // 180 / PI
    for (const auto& theta : angles) {
        avgSin += sin(theta*conv);
        avgCos += cos(theta*conv);
    }
    avgSin /= (double)angles.size();
    avgCos /= (double)angles.size();
    auto ret = double{ 90.0 - atan2(avgCos, avgSin) * i_conv };
    if (ret<0.0) ret += 360.0;
    return fmod(ret, 360.0);
} 
```

它采用双精度向量形式的角度，并将平均值简单地作为双精度返回。角度必须以度为单位，当然平均值也以度为单位。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-04-27T01:40:25.667

基于[Alnitak 的回答](https://stackoverflow.com/questions/491738/how-do-you-calculate-the-average-of-a-set-of-circular-data/491784#491784)，我编写了一个 Java 方法来计算多个角度的平均值：

**如果你的角度是弧度：**

```
public static double averageAngleRadians(double... angles) {
    double x = 0;
    double y = 0;
    for (double a : angles) {
        x += Math.cos(a);
        y += Math.sin(a);
    }

    return Math.atan2(y, x);
} 
```

**如果您的角度以度为单位：**

```
public static double averageAngleDegrees(double... angles) {
    double x = 0;
    double y = 0;
    for (double a : angles) {
        x += Math.cos(Math.toRadians(a));
        y += Math.sin(Math.toRadians(a));
    }

    return Math.toDegrees(Math.atan2(y, x));
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-09-02T17:31:08.973

如果有人正在寻找**JavaScript**解决方案，我已经在[mathjs 库的帮助下将维基百科页面](https://mathjs.org/)[Mean of circular quantity（在](https://en.wikipedia.org/wiki/Mean_of_circular_quantities#Example)[Nick 的回答](https://stackoverflow.com/a/491907/13210784)中也提到过）中给出的示例翻译成 JavaScript/NodeJS 代码。

如果您的角度以**度**为单位：

```
const maths = require('mathjs');

getAverageDegrees = (array) => {
    let arrayLength = array.length;

    let sinTotal = 0;
    let cosTotal = 0;

    for (let i = 0; i < arrayLength; i++) {
        sinTotal += maths.sin(array[i] * (maths.pi / 180));
        cosTotal += maths.cos(array[i] * (maths.pi / 180));
    }

    let averageDirection = maths.atan(sinTotal / cosTotal) * (180 / maths.pi);

    if (cosTotal < 0) {
        averageDirection += 180;
    } else if (sinTotal < 0) {
        averageDirection += 360;
    }

    return averageDirection;
} 
```

**这个解决方案对我来说非常有效，可以从一组罗盘方向**中找到平均方向。我已经在大范围的方向数据（0-360 度）上对此进行了测试，它看起来非常健壮。

或者，如果您的角度是**弧度**：

```
const maths = require('mathjs');
getAverageRadians = (array) => {
    let arrayLength = array.length;

    let sinTotal = 0;
    let cosTotal = 0;

    for (let i = 0; i < arrayLength; i++) {
        sinTotal += maths.sin(array[i]);
        cosTotal += maths.cos(array[i]);
    }

    let averageDirection = maths.atan(sinTotal / cosTotal);

    if (cosTotal < 0) {
        averageDirection += 180;
    } else if (sinTotal < 0) {
        averageDirection += 360;
    }

    return averageDirection;
} 
```

希望这些解决方案对面临与我类似的编程挑战的人有所帮助。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-29T14:41:35.357

这是一个想法：通过始终计算最接近的角度的平均值来迭代地构建平均值，并保持权重。

另一个想法：找到给定角度之间的最大间隙。找到平分它的点，然后选择圆上的相对点作为参考零来计算平均值。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-29T14:50:14.577

让我们用圆圆周上的点来表示这些角度。

我们可以假设所有这些点都落在圆的同一半边吗？（否则，没有明显的方法来定义“平均角度”。想想直径上的两个点，例如 0 度和 180 度 --- 是平均 90 度还是 270 度？当我们有 3 个或更多时会发生什么均匀分布点？）

有了这个假设，我们选择该半圆上的任意点作为“原点”，并测量相对于该原点的给定角度集（称为“相对角度”）。请注意，相对角度的绝对值严格小于 180 度。最后，取这些相对角度的平均值以获得所需的平均角度（当然相对于我们的原点）。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2011-07-10T14:12:07.053

没有单一的“正确答案”。我推荐阅读 KV Mardia 和 PE Jupp，“Directional Statistics”一书（Wiley，1999 年），以进行全面分析。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2013-03-29T04:26:33.037

（只是想从估计理论或统计推断中分享我的观点）

Nimble 的试验是获得一组角度的 MMSE^ 估计，但它是找到“平均”方向的一种选择；人们还可以找到一个 MMAE^ 估计，或其他一些估计作为“平均”方向，这取决于您的度量量化方向误差；或更一般地，在估计理论中，成本函数的定义。

^ MMSE/MMAE 对应于最小均方/绝对误差。

ackb 说“平均角度 phi_avg 应该具有 sum_i|phi_avg-phi_i|^2 变得最小的属性......他们平均一些东西，但不是角度”

----您以均方的方式量化误差，这是最常见的方法之一，但不是唯一的方法。这里大多数人喜欢的答案（即单位向量之和并得到结果的角度）实际上是合理的解决方案之一。如果向量的方向被建模为 von Mises 分布，则（可以证明）ML 估计器充当我们想要的“平均”方向。这种分布并不花哨，只是从 2D 高斯分布中定期采样的分布。见方程式。(2.179) 在 Bishop 的《模式识别与机器学习》一书中。同样，它绝不是唯一代表“平均”方向的最佳方法，但是，它是一种非常合理的方法，具有良好的理论依据和简单的实现。

Nimble 说“ackb 是对的，这些基于矢量的解决方案不能被视为角度的真实平均值，它们只是单位矢量对应物的平均值”

- - 这不是真的。“单位向量对应物”揭示了向量的方向信息。角度是一个不考虑向量长度的量，单位向量是带有长度为 1 的附加信息的东西。您可以将“单位”向量定义为长度为 2，这并不重要。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2017-04-26T12:12:17.037

这是一个使用移动平均线并注意标准化值的完全算术解决方案。如果所有角度都在圆的一侧（彼此在 180° 以内），它会很快并提供正确的答案。

它在数学上等同于添加将值移动到范围 (0, 180) 的偏移量，计算平均值，然后减去偏移量。

注释描述了特定值在任何给定时间可以采用的范围

```
// angles have to be in the range [0, 360) and within 180° of each other.
// n >= 1
// returns the circular average of the angles int the range [0, 360).
double meanAngle(double* angles, int n)
{
    double average = angles[0];
    for (int i = 1; i<n; i++)
    {
        // average: (0, 360)
        double diff = angles[i]-average;
        // diff: (-540, 540)

        if (diff < -180)
            diff += 360;
        else if (diff >= 180)
            diff -= 360;
        // diff: (-180, 180)

        average += diff/(i+1);
        // average: (-180, 540)

        if (average < 0)
            average += 360;
        else if (average >= 360)
            average -= 360;
        // average: (0, 360)
    }
    return average;
} 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2018-10-22T02:05:54.520

好吧，我参加聚会已经很晚了，但我想我会加上我的 2 美分，因为我真的找不到任何明确的答案。最后，我实现了以下 Java 版本的 Mitsuta 方法，我希望它能提供一个简单而健壮的解决方案。特别是因为标准偏差提供了测量分散，并且如果 sd == 90，则表明输入角度导致不明确的平均值。

**编辑：**实际上我意识到我的原始实现可以进一步简化，考虑到其他答案中正在进行的所有对话和三角函数，实际上非常简单。

```
/**
 * The Mitsuta method
 *
 * @param angles Angles from 0 - 360
 * @return double array containing
 * 0 - mean
 * 1 - sd: a measure of angular dispersion, in the range [0..360], similar to standard deviation.
 * Note if sd == 90 then the mean can also be its inverse, i.e. 360 == 0, 300 == 60.
 */
public static double[] getAngleStatsMitsuta(double... angles) {
    double sum = 0;
    double sumsq = 0;
    for (double angle : angles) {
        if (angle >= 180) {
            angle -= 360;
        }
        sum += angle;
        sumsq += angle * angle;
    }

    double mean = sum / angles.length;
    return new double[]{mean <= 0 ? 360 + mean: mean, Math.sqrt(sumsq / angles.length - (mean * mean))};
} 
```

...对于所有 (Java) 极客，您可以使用上述方法在一行中获得平均角度。

```
Arrays.stream(angles).map(angle -> angle<180 ? angle: (angle-360)).sum() / angles.length; 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-01-31T05:51:12.743

Alnitak 有正确的解决方案。Nick Fortescue 的解决方案在功能上是相同的。

对于 where 的特殊情况

( sum(x_component) = 0.0 && sum(y_component) = 0.0 ) // 例如 10\. 和 190\. 度的 2 个角度 ea。

使用 0.0 度作为总和

在计算上，您必须测试这种情况，因为 atan2(0\. , 0.) 是未定义的并且会产生错误。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-02T19:16:30.230

平均角度 phi_avg 应该具有 sum_i|phi_avg-phi_i|^2 变得最小的属性，其中差异必须在 [-Pi, Pi) 中（因为反过来可能会更短！）。这很容易通过将所有输入值归一化为 [0, 2Pi)、保持运行平均 phi_run 并选择归一化 |phi_i-phi_run| 来实现。到 [-Pi,Pi) （通过添加或减去 2Pi）。上面的大多数建议都做了一些*没有* 最小属性的事情，即它们平均*一些东西*，但不是角度。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-04-18T19:49:06.600

我在@David_Hanak 的回答的帮助下解决了这个问题。正如他所说：

> 在同一半圆中指向其他两个“之间”的角度，例如对于 355 和 5，这将是 0，而不是 180。为此，您需要检查两个角度之间的差异是否大于 180或不。如果是这样，请在使用上述公式之前将较小的角度增加 360。

所以我所做的是计算所有角度的平均值。然后所有小于这个的角度，将它们增加 360。然后通过将它们全部相加并除以它们的长度来重新计算平均值。

```
 float angleY = 0f;
        int count = eulerAngles.Count;

        for (byte i = 0; i < count; i++)
            angleY += eulerAngles[i].y;

        float averageAngle = angleY / count;

        angleY = 0f;
        for (byte i = 0; i < count; i++)
        {
            float angle = eulerAngles[i].y;
            if (angle < averageAngle)
                angle += 360f;
            angleY += angle;
        }

        angleY = angleY / count; 
```

完美运行。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2015-09-10T09:24:42.607

Python函数：

```
from math import sin,cos,atan2,pi
import numpy as np
def meanangle(angles,weights=0,setting='degrees'):
    '''computes the mean angle'''
    if weights==0:
         weights=np.ones(len(angles))
    sumsin=0
    sumcos=0
    if setting=='degrees':
        angles=np.array(angles)*pi/180
    for i in range(len(angles)):
        sumsin+=weights[i]/sum(weights)*sin(angles[i])
        sumcos+=weights[i]/sum(weights)*cos(angles[i])
    average=atan2(sumsin,sumcos)
    if setting=='degrees':
        average=average*180/pi
    return average 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2016-03-09T08:48:20.743

您可以在 Matlab 中使用此函数：

```
function retVal=DegreeAngleMean(x) 

len=length(x);

sum1=0; 
sum2=0; 

count1=0;
count2=0; 

for i=1:len 
   if x(i)<180 
       sum1=sum1+x(i); 
       count1=count1+1; 
   else 
       sum2=sum2+x(i); 
       count2=count2+1; 
   end 
end 

if (count1>0) 
     k1=sum1/count1; 
end 

if (count2>0) 
     k2=sum2/count2; 
end 

if count1>0 && count2>0 
   if(k2-k1 >= 180) 
       retVal = ((sum1+sum2)-count2*360)/len; 
   else 
       retVal = (sum1+sum2)/len; 
   end 
elseif count1>0 
    retVal = k1; 
else 
    retVal = k2; 
end 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2016-08-30T18:25:40.410

对于任何编程语言，您都可以在以下链接中看到解决方案和一些解释： [https ://rosettacode.org/wiki/Averages/Mean_angle](https://rosettacode.org/wiki/Averages/Mean_angle)

例如，**C++ 解决方案**：

```
#include<math.h>
#include<stdio.h>

double
meanAngle (double *angles, int size)
{
  double y_part = 0, x_part = 0;
  int i;

  for (i = 0; i < size; i++)
    {
      x_part += cos (angles[i] * M_PI / 180);
      y_part += sin (angles[i] * M_PI / 180);
    }

  return atan2 (y_part / size, x_part / size) * 180 / M_PI;
}

int
main ()
{
  double angleSet1[] = { 350, 10 };
  double angleSet2[] = { 90, 180, 270, 360};
  double angleSet3[] = { 10, 20, 30};

  printf ("\nMean Angle for 1st set : %lf degrees", meanAngle (angleSet1, 2));
  printf ("\nMean Angle for 2nd set : %lf degrees", meanAngle (angleSet2, 4));
  printf ("\nMean Angle for 3rd set : %lf degrees\n", meanAngle (angleSet3, 3));
  return 0;
} 
```

输出：

```
Mean Angle for 1st set : -0.000000 degrees
Mean Angle for 2nd set : -90.000000 degrees
Mean Angle for 3rd set : 20.000000 degrees 
```

或**Matlab 解决方案**：

```
function u = mean_angle(phi)
    u = angle(mean(exp(i*pi*phi/180)))*180/pi;
end

 mean_angle([350, 10])
ans = -2.7452e-14
 mean_angle([90, 180, 270, 360])
ans = -90
 mean_angle([10, 20, 30])
ans =  20.000 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2016-12-12T22:19:10.043

虽然 starblue 的答案给出了平均单位向量的角度，但如果您接受在 0 到 2*pi（或 0° 到360°）。例如，0° 和 180° 的平均值可以是 90° 或 270°。

算术平均值具有作为与输入值的距离平方和最小的单个值的特性。两个单位向量之间沿单位圆的距离可以很容易地计算为它们的点积的反余弦。如果我们通过最小化我们的向量和每个输入单位向量的点积的平方反余弦之和来选择一个单位向量，那么我们就有一个等效的平均值。同样，请记住，在特殊情况下可能有两个或多个最小值。

这个概念可以扩展到任意数量的维度，因为沿单位球面的距离可以以与沿单位圆的距离完全相同的方式计算——两个单位向量的点积的反余弦。

对于圆，我们可以通过多种方式求解这个平均值，但我提出了以下 O(n^2) 算法（角度以弧度为单位，我避免计算单位向量）：

```
var bestAverage = -1
double minimumSquareDistance
for each a1 in input
    var sumA = 0;
    for each a2 in input
        var a = (a2 - a1) mod (2*pi) + a1
        sumA += a
    end for
    var averageHere = sumA / input.count
    var sumSqDistHere = 0
    for each a2 in input
        var dist = (a2 - averageHere + pi) mod (2*pi) - pi // keep within range of -pi to pi
        sumSqDistHere += dist * dist
    end for
    if (bestAverage < 0 OR sumSqDistHere < minimumSquareDistance) // for exceptional cases, sumSqDistHere may be equal to minimumSquareDistance at least once. In these cases we will only find one of the averages
        minimumSquareDistance = sumSqDistHere
        bestAverage = averageHere
    end if
end for
return bestAverage 
```

如果所有的角度都在 180° 以内，那么我们可以使用更简单的 O(n)+O(sort) 算法（再次使用弧度并避免使用单位向量）：

```
sort(input)
var largestGapEnd = input[0]
var largestGapSize = (input[0] - input[input.count-1]) mod (2*pi)
for (int i = 1; i < input.count; ++i)
    var gapSize = (input[i] - input[i - 1]) mod (2*pi)
    if (largestGapEnd < 0 OR gapSize > largestGapSize)
        largestGapSize = gapSize
        largestGapEnd = input[i]
    end if
end for
double sum = 0
for each angle in input
    var a2 = (angle - largestGapEnd) mod (2*pi) + largestGapEnd
    sum += a2
end for
return sum / input.count 
```

要使用度数，只需将 pi 替换为 180。如果您打算使用更多维度，那么您很可能必须使用迭代方法来求解平均值。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2017-09-27T14:26:29.810

问题非常简单。1\. 确保所有角度都在 -180 到 180 度之间。2\. a 将所有非负角相加，取它们的平均值，并计算有多少 2\. b. 将所有负角相加，取它们的平均值并计算有多少。3\. 取 pos_average 减去 neg_average 的差值 如果差值大于 180，则将差值更改为 360 减去差值。否则，只需更改差异的符号。请注意，差异始终是非负的。Average_Angle 等于 pos_average 加上差异乘以“权重”，负数除以负数和正数之和

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2018-02-24T07:23:50.423

这是一些平均角度的java代码，我认为它相当健壮。

```
public static double getAverageAngle(List<Double> angles)
{
    // r = right (0 to 180 degrees)

    // l = left (180 to 360 degrees)

    double rTotal = 0;
    double lTotal = 0;
    double rCtr = 0;
    double lCtr = 0;

    for (Double angle : angles)
    {
        double norm = normalize(angle);
        if (norm >= 180)
        {
            lTotal += norm;
            lCtr++;
        } else
        {
            rTotal += norm;
            rCtr++;
        }
    }

    double rAvg = rTotal / Math.max(rCtr, 1.0);
    double lAvg = lTotal / Math.max(lCtr, 1.0);

    if (rAvg > lAvg + 180)
    {
        lAvg += 360;
    }
    if (lAvg > rAvg + 180)
    {
        rAvg += 360;
    }

    double rPortion = rAvg * (rCtr / (rCtr + lCtr));
    double lPortion = lAvg * (lCtr / (lCtr + rCtr));
    return normalize(rPortion + lPortion);
}

public static double normalize(double angle)
{
    double result = angle;
    if (angle >= 360)
    {
        result = angle % 360;
    }
    if (angle < 0)
    {
        result = 360 + (angle % 360);
    }
    return result;
} 
```

* * *

## 回答 #31

> 赞同：-3
> 
> 时间：2011-04-10T18:06:04.570

我有一种与@Starblue 不同的方法，可以对上面给出的某些角度给出“正确”的答案。例如：

*   angle_avg([350,10])=0
*   angle_avg([-90,90,40])=13.333
*   角度平均值（[350,2]）=356

它使用对连续角度之间差异的总和。代码（在 Matlab 中）：

```
function [avg] = angle_avg(angles)
last = angles(1);
sum = angles(1);
for i=2:length(angles)
    diff = mod(angles(i)-angles(i-1)+ 180,360)-180
    last = last + diff;
    sum = sum + last;
end
avg = mod(sum/length(angles), 360);
end 
```

# c# - 我如何知道是使用样式还是覆盖控件模板？

> ID：491739
> 
> 赞同：2
> 
> 时间：2009-01-29T14:16:03.473
> 
> 标签：c#, wpf

这个问题的灵感来自[这个最近的问题](https://stackoverflow.com/questions/491293/why-cant-i-set-the-background-color-of-a-selecfted-listboxitem-in-wpf)和我在 WPF 开发中遇到的其他情况。我如何知道在控件上设置样式以覆盖某些默认行为与创建新控件模板是否足够？

更具体地说，在上面的问题中，作者想改变一个 ListBoxItem 被选中时的外观。（见下面重印的代码）。一切正常，除了背景属性。应该如何知道他们应该为此覆盖控制模板？

```
<Style TargetType="{x:Type ListBoxItem}">
        <Setter Property="Content" Value="{Binding Path=Name}"/>
        <Setter Property="Margin" Value="2"/>
        <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="Background" Value="Yellow"/>
                <Setter Property="Foreground" Value="Red"/>
            </Trigger>
        </Style.Triggers>

    </Style> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T19:58:06.670

至于是使用样式还是模板，Ray 提供了很好的回应。

至于如何在不创建模板的情况下解决您的问题，也许我可以提供帮助。

背景颜色由 SystemColors 设置。使用 Blend 并创建一个模板，您可以看到确切的 xaml。

所以如果没有模板！是一项要求，您始终可以更改该资源是什么。

例子 ：

```
 <ListBox>  
        <ListBox.Resources>
            <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}"
                             Color="Yellow" />

            <Style TargetType="{x:Type ListBoxItem}">
                <Setter Property="Content" Value="{Binding Path=Name}"/>
                <Setter Property="Margin" Value="2"/>
                <Style.Triggers>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="FontWeight" Value="Bold"/>
                        <Setter Property="FontSize" Value="18"/>                            
                        <Setter Property="Foreground" Value="Red"/>
                    </Trigger>
                </Style.Triggers>

            </Style>

        </ListBox.Resources>

        <ListBoxItem>Test 1</ListBoxItem>
        <ListBoxItem>Test 2</ListBoxItem>
        <ListBoxItem>Test 3</ListBoxItem>
    </ListBox> 
```

这将为您提供给定 ListBox 的背景颜色，并且不会破坏应用程序中的任何其他内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T15:42:59.790

样式可以被认为与 HTML 中的 CSS 样式非常接近。如果您只想更改控件的基本属性，例如背景、前景或它公开的任何属性，那么样式正是您所需要的。样式还允许您应用触发器，因此对于动画，样式也足够了。

如果您发现要更改控件的内在行为/内部工作原理，那么控件模板就是您想要的。例如，如果您想通过添加某种网格行为来更改按钮的布局方式，那么使用控件模板是前进的方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T18:13:45.133

不幸的是，对于您的具体示例，除非您尝试一下，否则您不知道。基本上，您首先尝试使用 Style....如果由于某种原因这不起作用，那么您编写一个 ControlTemplate。由于 Ray 提到的原因，您通常只会最终编写 ControlTemplates。

我的猜测是，您尝试设置的触发器也已在 ControlTemplate 中进行了硬编码......这在 imo 中是糟糕的设计，因为它会阻止 Style 覆盖它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T19:52:26.057

“背景”是指当 ListBoxItem 被选中时围绕它的“蓝色”矩形？

这实际上是**FocusVisualStyle**属性，它是一种样式，用于描述项目在获得焦点时的外观。控件显式设置此属性（[在此处](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/141c8bfa-f152-4f8a-aca0-3c3b5440d183/)描述），因此为了覆盖它，您必须重新定义控件模板，确保使用默认样式设置器将其设置为 {x:Null}。

# visual-studio - 用于将解决方案文件夹映射到真实文件夹的 Visual Studio 扩展

> ID：491751
> 
> 赞同：14
> 
> 时间：2009-01-29T14:18:39.397
> 
> 标签：visual-studio, visual-studio-2008, visual-studio-2005, vsx

在[较早的问题](https://stackoverflow.com/questions/267200/)中，我发现可悲的是解决方案文件夹不是目录中的真实文件夹。

我想知道是否有添加此功能的插件或宏？即当我创建一个解决方案文件夹时，它创建了一个真正的文件夹。当我创建一个新项目（右键单击 => 添加 => 新项目）时，它会自动将它们移动到该文件夹​​中，删除会导致它从磁盘中删除它（询问后）等。

这是针对 Visual Studio 2005 的，尽管我们可能会在几个月后升级到 2008。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-01-01T23:13:33.953

到目前为止，这在 VS 2005、2008 和 2010 中似乎都不可能，并且没有插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-29T18:59:44.120

我也觉得这是一个奇怪的想法。然而，它可以是一个有用的工具，可以在解决方案中对项目进行逻辑分组，而不必在文件系统中的文件夹中移动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T22:32:59.190

我怀疑你需要这个作为版本控制工具。在这种情况下，看看 AnkhSVN。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-24T22:04:09.073

也许您想要的是将文件作为“链接”添加到解决方案文件夹中，即，将文件保留在它们所在的位置，但在解决方案中为它们提供不同的组织。（当您将现有文件添加到解决方案文件夹或普通项目文件夹时，如果它位于不同的相应物理文件夹中，则会复制该文件）。它通常不会被注意到，这是«添加>现有项目...»对话框中的一个选项，您可以在其中选择“添加为链接”，而不是“添加”。这允许在项目之间共享文件，或者简单地以不同的方式组织它们。我经常怀念的是为了组织目的在项目中添加“虚拟”文件夹的可能性，而不会破坏命名空间/文件夹的最佳实践。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T22:48:52.080

无法真正理解您要添加此功能的目的。

有时您想知道它是否可以做到这一点，但是，答案可能是否定的。但这不是必要的，意味着您无法实现最初的目标，如果没有这个，仍然有几种方法可以解决它。

此外，VS 解决方案应该是您项目设置的快捷方式，不应包含在任何硬代码中，解决方案可能因 PC 和 IDE 环境而异。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-08T13:57:19.160

我并没有真正使用VS2005，但过去一年一直在使用VS2008。

当您创建新的解决方案/项目时，它有一个用于创建解决方案文件夹的复选框。

如果您随后使用“解决方案资源管理器”窗口，您可以在其中创建和操作文件夹和类文件。这实际上将创建匹配的新目录。

从解决方案资源管理器中删除文件也会从磁盘中删除实际文件。

# java - iText 页面换行 - 更改元素的顺序

> ID：491752
> 
> 赞同：2
> 
> 时间：2009-01-29T14:18:50.550
> 
> 标签：java, pdf, itext, word-wrap

当我遇到这个问题时，我正在使用 iText 生成 PDF 报告，并编写了一个简单的示例来说明它。

我正在结合简单的段落和图像。

图像的高度使得 PDF 页面可以容纳 3 个图像，但是如果页面上有文本，则只能容纳 2 个图像。

我使用以下代码创建我的 PDF：

```
 Document document = new Document(PageSize.LETTER, 0, 0, 0, 0);
    PdfWriter writer = PdfWriter.getInstance(document, fileOutput);
    document.open();
    document.add(new Paragraph("hello world1"));
    addImage(document);
    addImage(document);
    addImage(document);
    document.add(new Paragraph("hello world2"));
    document.close(); 
```

我希望输出看起来像这样

```
hello world1
image
image
<page break>
image
hello world2 
```

相反，我得到的是，

```
Hello world 1
image
image
hello world 2
<page break>
image 
```

我没有使用 iText 设置任何奇怪的包装参数，这个例子真的只是一个简单的例子。

关于为什么它似乎错误地自动包装的任何想法？

在实际情况下，仅添加分页符不是可接受的解决方案。

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T14:52:44.353

自己想办法；）

```
writer.setStrictImageSequence(true); 
```

iText 的设计决定不将图像一分为二，而是先添加其他内容。

设置此布尔值会导致 iText 尊重排序。

# vb.net - VB.NET 中带有 VLC ActiveX 的工具栏

> ID：491770
> 
> 赞同：2
> 
> 时间：2009-01-29T14:22:59.687
> 
> 标签：vb.net, api, activex, toolbar, vlc

我在我的 VB.NET 应用程序中使用了**VideoLAN [VLC ActiveX](http://wiki.videolan.org/ActiveX)插件 2**（在[VLC 0.9.4 安装中可用）。](http://www.videolan.org/vlc/download-windows.html)

我注意到：

*   控制器工具栏（搜索栏、控制按钮、音量）根本不出现
*   即使在播放文件之后
*   并且**“工具栏”属性**不能设置为TRUE，只读？

所以我的问题是：

1.  “**工具栏”属性**是无用的，还是有特殊的方法可以使它变为 TRUE？
2.  **工具栏会**完全出现还是我必须自己实现？
3.  如果我必须使用控制按钮制作自定义搜索滑块，我可以使用哪些**API 调用**来控制媒体播放和搜索帧？VB.NET？
4.  有没有**其他方法可以在我的应用程序中获取****带有工具栏**的 VLC 播放器？[Libvlc？](http://wiki.videolan.org/Libvlc)

![替代文字](https://wiki.videolan.org/images/Vlc-en.png)

^ 这是我希望在我的 VB.NET 应用程序中拥有[的工具栏。](https://wiki.videolan.org/images/Vlc-en.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-04T03:10:22.860

工具栏未在 Windows VLC ActiveX 控件上实现

# java - web.xml 中 servlet 映射的 URL 模式

> ID：491773
> 
> 赞同：10
> 
> 时间：2009-01-29T14:23:32.257
> 
> 标签：java, jsp, servlets, jakarta-ee, web.xml

我需要在 web.xml 中使用此 URL 映射的解决方法来创建带有字母的 URL，后跟“_”，后跟字母数字字符的任意组合。

我想将一个 servlet 映射到这样的东西：

```
/something_* 
```

代替：

```
/something/* 
```

对不同的 JSP 使用不同的“东西”。例子：

```
/search_Something-I-searched-for 
```

我尝试使用：

```
 <servlet-mapping>
    <servlet-name>MyServlet</servlet-name>
    <url-pattern>/something_*</url-pattern>
  </servlet-mapping> 
```

但这似乎不起作用。 [这个答案](https://stackoverflow.com/questions/26732/invalid-url-pattern-servlet-mapping-in-tomcat-6-0)告诉我我不能在 web.xml 中这样做，所以也许有一些解决方法。

我不知道这些信息是否重要，但我在我的项目中使用了 JBoss 和 Struts2。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T14:38:36.860

将 servlet 映射到包含目录。在该 servlet 中，拆分 URL 路径并[转发](http://download.oracle.com/javaee/6/api/javax/servlet/RequestDispatcher.html#forward%28javax.servlet.ServletRequest,%20javax.servlet.ServletResponse%29)到适当的[命名 servlet](http://download.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getNamedDispatcher%28java.lang.String%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-08T03:36:51.600

为什么不试试 Spring MVC 框架。Spring 可以提供你想要的 url 映射。

```
@RequestMapping(value="/something_{name}", method=RequestMethod.GET)
public String demo(@PathVariable(value="name") String name, ModelMap map) {

String something = name;

// Do manipulation

return "something"; // Forward to something.jsp
} 
```

观看此[Spring MVC 框架教程](http://youtu.be/Q6hZQ5SzGyM)

# sql - 自动递增 ID 值

> ID：491777
> 
> 赞同：5
> 
> 时间：2009-01-29T14:24:44.423
> 
> 标签：sql, primary-key, identity, hsqldb

我有一个带有生成 ID 的 HSQLDB 数据库，我希望自动递增值始终高于 100,000。这对 HSQLDB 可行吗？任何数据库都可以做到这一点吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-29T14:28:49.173

根据[HSQL 文档](http://hsqldb.sourceforge.net/doc/guide/ch02.html)：

> 从 1.7.2 开始，默认使用 SQL 标准语法，允许指定初始值。支持的形式是（ INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH n, [INCREMENT BY m])PRIMARY KEY, ...）。还添加了对 BIGINT 标识列的支持。因此，IDENTITY 列只是一个 INTEGER 或 BIGINT 列，其默认值由序列生成器生成。

...

> 下一个要使用的 IDENTITY 值可以用
> 
> ```
> ALTER TABLE <table name> ALTER COLUMN <column name> RESTART WITH <new value>; 
> ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T14:27:37.460

[以下是如何在 HSQLDB 中执行此操作](http://hsqldb.org/doc/2.0/guide/databaseobjects-chapt.html#dbc_number_sequence)：

> 可以使用以下语句更改要使用的下一个 IDENTITY 值。请注意，此语句在正常操作中不使用，仅用于特殊目的，例如重置身份生成器：
> 
> ```
> ALTER TABLE ALTER COLUMN <column name> RESTART WITH <new value>; 
> ```

据我所知，所有 SQL 数据库都允许您为自增字段设置种子值。

**更新：**这是[主要 SQL 数据库中的身份/自动增量实现](http://troels.arvin.dk/db/rdbms/#mix-identity)列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-29T14:27:18.867

使用 SQL Server 是可能的。定义自动编号列时，您可以定义起始编号和增量：

```
IDENTITY(100000, 1) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T14:27:42.857

我知道 SQL Server 可以做到这一点，我想其他人也可以做到。

使用 SQL Server，您可以设置 ID 列种子（起始编号）和增量值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T14:28:08.257

您可以使用使用序列的数据库来做到这一点，例如 Oracle 和 PostgreSQL。创建序列时指定起始值。

[这](http://hsqldb.org/doc/guide/ch02.html#N104AE)表明您也可以使用 HSQL 来完成。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T14:28:25.493

不确定 HSQL，但在 MS SQL 中是的，这是可能的。将 ID 设置为自动递增，并将种子值设置为 100,000。

# c# - 在 C# 中连接 Lambda 函数

> ID：491780
> 
> 赞同：27
> 
> 时间：2009-01-29T14:25:19.463
> 
> 标签：c#, lambda

使用 C# 3.5，我想构建一个谓词以逐个发送到 where 子句。我创建了一个非常简单的控制台应用程序来说明我得出的解决方案。这完美地工作。绝对完美。但我不知道如何或为什么。

```
 public static Func<Tran, bool> GetPredicate()
    {
        Func<Tran, bool> predicate = null;
        predicate += t => t.Response == "00";
        predicate += t => t.Amount < 100;
        return predicate;
    } 
```

当我说“谓词 +=”时，这是什么意思？谓词 -= 似乎什么都不做，并且编译器不喜欢 ^=、&=、*=、/=。

编译器也不喜欢'predicate = predicate + t => t.Response....'。

我偶然发现了什么？我知道它的作用，但它是如何做到的呢？

如果有人想深入研究更复杂的 lambda，请这样做。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-29T14:46:18.437

“delegate += method”是多播委托的运算符，用于组合方法来委托。另一方面，“委托-=方法”是从委托中删除方法的运算符。它对动作很有用。

```
Action action = Method1;
action += Method2;
action += Method3;
action -= Method2;
action(); 
```

在这种情况下，只有 Method1 和 Method3 会运行，Method2 不会运行，因为您在调用委托之前删除了该方法。

如果您将多播委托与 Func 一起使用，则结果将是最后一个方法。

```
Func<int> func = () => 1;
func += () => 2;
func += () => 3;
int result = func(); 
```

在这种情况下，结果将为 3，因为方法 "() => 3" 是添加到委托的最后一个方法。无论如何，所有方法都会被调用。

在您的情况下，方法“t => t.Amount < 100”将是有效的。

如果要组合谓词，我建议使用这些扩展方法。

```
public static Func<T, bool> AndAlso<T>(
    this Func<T, bool> predicate1, 
    Func<T, bool> predicate2) 
{
    return arg => predicate1(arg) && predicate2(arg);
}

public static Func<T, bool> OrElse<T>(
    this Func<T, bool> predicate1, 
    Func<T, bool> predicate2) 
{
    return arg => predicate1(arg) || predicate2(arg);
} 
```

用法

```
public static Func<Tran, bool> GetPredicate() {
    Func<Tran, bool> predicate = null;
    predicate = t => t.Response == "00";
    predicate = predicate.AndAlso(t => t.Amount < 100);
    return predicate;
} 
```

编辑：更正基思建议的扩展方法的名称。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-29T14:42:40.877

当您在委托类型时使用 += 或 -= 时，只会调用`Delegate.Combine`and `Delegate.Remove`。

关于多播委托的重要一点是，*除了最后执行的委托之外，所有*委托的返回值都将被忽略。它们都被执行（除非抛出异常），但只使用最后一个返回值。

对于谓词，您可能想要执行以下操作：

```
public static Func<T, bool> And<T>(params Func<T, bool>[] predicates)
{
    return t => predicates.All(predicate => predicate(t));
}

public static Func<T, bool> Or<T>(params Func<T, bool>[] predicates)
{
    return t => predicates.Any(predicate => predicate(t));
} 
```

然后你会这样做：

```
Func<string, bool> predicate = And<string>(
    t => t.Length > 10,
    t => t.Length < 20); 
```

编辑：这是一个更通用的解决方案，如果有点奇怪的话，它很有趣......

```
public static Func<TInput, TOuput> Combine<TInput, TOutput>
    (Func<TOutput, TOutput, TOutput> aggregator,
     params Func<TInput, TOuput>[] delegates) {

    // delegates[0] provides the initial value
    return t => delegates.Skip(1).Aggregate(delegates[0](t), aggregator);
} 
```

因此，您*可以*将 And 实现为：

```
public static Func<T, bool> And<T>(params Func<T, bool>[] predicates) {
    return Combine<T, bool>((x, y) => x && y, predicates);
} 
```

（我个人更喜欢这个 using `GetInvocationList()`，因为你最终会得到一个谓词，你可以将它传递给 LINQ 的其他位等）

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-29T14:33:26.793

实际上，这是行不通的。尝试在第一个条件失败但第二个条件通过的情况下对其进行测试。你会发现它会返回 true。原因是，因为在处理返回值的多播委托时，只返回最后一个值。例如：

```
 Func<string, bool> predicate = null;
        predicate += t => t.Length > 10;
        predicate += t => t.Length < 20;

        bool b = predicate("12345"); 
```

这将返回 TRUE，因为最后一个函数调用返回 true（小于 20）。为了真正使它工作，您需要调用：

```
predicate.GetInvocationList(); 
```

它返回一个委托数组。然后，您需要确保它们都返回 true，以使最终结果为 true。有道理？

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-29T14:43:26.743

扩展 BFree 的答案（+1）

如果您想获得您正在寻找的行为，您需要将谓词显式链接在一起。这是一个例子

```
public static Func<Tran, bool> GetPredicate()
{
    Func<Tran, bool> predicate1 = t => t.Response == "00";
    Func<Tran, bool> predicate2 = t => t.Amount < 100;
    return t => predicate1(t) && predicate2(t);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T15:39:29.047

如果你想组合谓词，试试这个；

```
public static Predicate<T> Combine<T>(params Predicate<T>[] predicates)
{
return t => predicates.All(pr => pr(t));
} 
```

你这样称呼它；

```
Predicate<string> shortAndSweet = Combine<string>
(
    s => s.Length < 10,  // short,
    s => s == "sweet"    // and sweet
); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T14:31:02.947

+= 是专门为支持向事件添加处理程序而实现的语法糖。由于事件只是委托的一个特例，而 Func 也是一个委托，因此语法*似乎*在这里工作。

但是你确定它按预期工作吗？我的意思是，您期望 AND 或 OR 评估吗？如果你想要它，你将如何实现相反的？你确定它不只是返回第一个的结果吗？还是最后一个？

# javascript - 在 IE 中使用 contentEditable 的风险

> ID：491790
> 
> 赞同：23
> 
> 时间：2009-01-29T14:27:41.377
> 
> 标签：javascript, html, internet-explorer, contenteditable

我们必须为我们的产品添加一个基本的 HTML 编辑器。由于我们目前只支持 IE（大多数客户仍在使用 IE 6），我被告知要使用 Internet Explorer 内置的 XHTML 编辑功能——例如`<div contentEditable="true">`，如“[编辑网页](http://www.maconstateit.net/tutorials/JSDHTML/JSDHTML12/jsdhtml12-02.htm)”中所述。

**除了**不能在其他浏览器中工作。（管理层不认为有问题。我们的客户会忍受我们的软件只在IE下工作。我们的软件只在IE下工作，我们从来没有亏过钱；大多数客户目前只会让他们的员工使用IE6 )

使用 contentEditable 我们可能会遇到什么**其他问题？**

* * *

**更新**

我用“contentEditable”编写的 HTML 编辑器被证明很难获得可靠，有很多[问题](https://stackoverflow.com/questions/527866/why-is-contenteditable-removing-id-from-div)。如果我必须再次这样做，我会**非常努力**地使用众多开源解决方案之一（例如 TinyMCE），或者购买支持的 HTML 编辑器。

毫无疑问，只要有足够的时间，一个非常熟练的 jscript 程序员可以让“contentEditable”正常工作。只是网络上的所有示例看起来都很简单，直到您测试常见操作，例如从单词中剪切/粘贴并尝试编辑生成的 HTML。（只是客户会做的事情）

（只需在 stackoverflow 上搜索“contentEditable”即可了解其他人遇到的问题）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-30T01:17:40.643

contentEditable 属性适用于 Safari、Firefox 3 和 Opera 9。

由于毫无疑问将通过选择进行操作，因此您最大的问题将是让选择/范围跨浏览器工作（[请参见此处）](https://stackoverflow.com/questions/361130/get-selected-text-and-selected-nodes-on-a-page/364476#364476)。

跨浏览器也有许多[小错误](https://bugzilla.mozilla.org/show_bug.cgi?id=454191)可能会或可能不会咬你。这些包括不兼容的区分大小写、不兼容的再次关闭方法（removeAttribute 与设置为 false）。

尽管存在这些缺陷，但我发现它运作良好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-29T14:32:22.660

使用一些适用于所有主流浏览器的开源解决方案怎么样？

[TinyMCE](http://tinymce.moxiecode.com/)

还有其他项目，但这就是我要使用的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-29T15:30:30.750

[HTML 5](http://www.w3.org/TR/html5/editing.html)包含 contenteditable 属性，所以看起来它会在 IE 中很长一段时间。

刚刚收到来自 IE 团队成员的电子邮件

> 虽然基本上不可能以高度的信心评论未来，但可以公平地说，我不知道有任何删除 contentEditable 的计划，如果它被删除，它将破坏很多网站。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-29T15:56:53.193

一个快速的谷歌搜索产生了[一篇](http://annevankesteren.nl/2005/07/more-contenteditable)关于 contentEditable 的一些（尽管是次要的）问题的博客文章。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-29T14:30:31.993

contentEditable 在 Firefox 3 下工作。我不知道 contentEditable 有任何问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-29T14:33:59.290

如果没有对添加的 HTML 内容进行验证，我会确保检查您返回的内容，因为在 IE 中插入 XSS 攻击非常容易。

# iphone - 手机上的语义内容（RDF、OWL）——这可能吗？

> ID：491792
> 
> 赞同：6
> 
> 时间：2009-01-29T14:27:56.757
> 
> 标签：iphone, android, java-me, rdf, owl

我正在考虑在移动设备上的应用程序中使用 RDF 和 OWL 等语义（网络）技术。目前我的目标是 android，但我也对 iPhone 和 J2ME 上的可能性感兴趣。

我想使用库而不是从头开始实现所有内容。

我知道有一些库/框架，例如 Jena、Redland、Protégé，但它们没有说明它们可以在哪些平台上工作。

拥有一个动态对象模型并从 XML 解析到 XML 对我来说是必须的。

我也想使用推理，但有人告诉我它是计算密集型的，所以这只是一个不错的选择。

对于提到的所有平台，问题可以解释为

*   理论上可以吗？（尤其是对于 J2ME 我不确定）
*   是否有已知可以在这些平台上运行的库？
*   移动平台上的性能是否足以满足现实世界的使用需求？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-01T10:56:25.153

您写了想要 J2ME，但其他读者可能对 C# 感兴趣。

[Mono 使 C# 在 iPhone 和 Android 上可用](http://arstechnica.com/open-source/news/2009/01/open-source-mono-framework-brings-c-to-iphone-and-wii.ars)。完成后，您可以使用[ROWLEX](http://rowlex.nc3a.nato.int)处理 RDF 和 OWL。您可以考虑阅读[这个 Stackoverflow 问题](https://stackoverflow.com/questions/240903/what-is-a-good-rdf-library-for-net)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T16:12:24.410

也许看看[IYOUIT](http://www.iyouit.eu)。它是一个

> 用 Python 开发的移动应用程序，在诺基亚 60 系列手机上运行。

它使用 OWL 和推理。您可以阅读[本文](https://www.iyouit.eu/portal/help/Introducing-IYOUIT.pdf)中的详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-22T22:22:22.473

这里有到 Android 平台的 Jena 端口。 [http://code.google.com/p/androjena/](http://code.google.com/p/androjena/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T18:26:18.057

如果这是一个客户端-服务器类型的应用程序，并且您对服务器有一定的控制权，我会在服务器端执行语义 Web 内容，并将相关信息交给您在移动设备上的查看客户端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T18:38:30.653

您的问题标题的一个更一般的答案是[Mosembro](http://lexandera.com/mosembro/)，这是一个使用微格式获取语义数据的 Android 浏览器。但是，它不会对数据进行任何重要的计算。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-13T12:44:27.483

如果您对使用某个框架没有限制，您可以使用 REST api 来处理服务器-客户端交互。 [更多信息在这里。](https://android.jlelse.eu/rest-api-on-android-made-simple-or-how-i-learned-to-stop-worrying-and-love-the-rxjava-b3c2c949cad4?gi=fe3b538f2a99)

# c# - C# Web reportviewer 创建带有 id 的页面的链接

> ID：491801
> 
> 赞同：0
> 
> 时间：2009-01-29T14:29:52.293
> 
> 标签：c#, hyperlink, reportviewer

我有一个reportviewer，我想要一个字段作为超链接。超链接必须如下所示： page.aspx?id=1 但是我该如何实现呢？

我已在属性窗口、导航选项卡、单选“跳转到 URL”中输入：page.aspx?id=sum(Field!field.value)

这不起作用:(

我该怎么做才能完成这项工作？

提前谢谢

*   马汀

PS：我也将 EnableHyperlinks 设置为 true；

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T10:14:26.670

您在“跳转到 URL”下的表达式应该是：

```
="page.aspx?id=" & sum(Fields!field.value) 
```

虽然我看到了两个潜在的问题。首先，如果我没记错的话，URL 必须是绝对路径（例如[http://www.test.com/page.aspx](http://www.test.com/page.aspx)）。其次，我不确定你为什么要在一个领域求和。如果您的意思是只获取某个字段的“当前”值，则不需要聚合函数，但您必须确保您位于一个为数据集的每一行重复数据的控件中，例如一张桌子。

# visual-studio-2005 - 是否可以在 VS 2005 中修改宏的输出？

> ID：491803
> 
> 赞同：0
> 
> 时间：2009-01-29T14:30:08.970
> 
> 标签：visual-studio-2005, build, macros

我正在使用 Visual Studio 2005 中的[自定义构建规则](http://msdn.microsoft.com/en-us/library/aa730877(VS.80).aspx)功能，它允许使用诸如`$(ConfigurationName)`XML .rules 文件中的宏。

我只需要将 的子集`$(ConfigurationName)`作为参数传递给我的命令行工具：

如果我的目标名为`DebugBuild`，我希望命令以`tool.exe -Debug`.

有没有办法做到这一点？我想过创建一个[用户定义的宏](http://msdn.microsoft.com/en-us/library/f2t8ztwy(VS.80).aspx)，但我不知道它们是否可以包含比纯文本更多的内容。我的想法是在我的自定义属性页面中得到这样的结果：

任何一个

```
Tool Parameter: $(MyMacroWhichExtractsPartOfTheConfigurationName) 
```

或者

```
Tool Parameter: ExtractorMethod( $(ConfigurationName) ) 
```

抱歉，如果这不是很清楚，如果需要，我可以提供更多详细信息:)

谢谢！

纪尧姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T16:04:25.597

问题是有几个地方我希望这个功能可用（输出名称、编译/链接步骤的参数、构建后步骤的参数......），所以脚本解决方案会让事情变得有点复杂。如果可能的话，我想保持简单。谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T15:07:22.700

通常我会创建一个您运行的脚本（例如 minsys bash 或 windows bat），并将参数转换为您想要的，而不是尝试在 VS 中执行此操作。

# objective-c - 使用 Objective-C 复制或移动文件的最佳方法？

> ID：491809
> 
> 赞同：32
> 
> 时间：2009-01-29T14:31:38.827
> 
> 标签：objective-c, macos, file-io

我想知道，编写一个将文件从一个地方复制或移动到另一个地方的 OSX 程序是否有最佳实践？

*   我可以调用一些 NSSomething 方法吗？
*   我必须使用输入/输出流吗？
*   或者最好的方法可能是仅仅依靠将命令传递给查找器？

额外问题：如何使用其中一种方法获得“复制完成 12%”的百分比？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-01-29T14:41:45.450

NSFileManager 和 NSWorkspace 都有移动、复制和删除文件的方法。通常你会使用 NSFileManager 因为它更容易使用：

```
if ( [[NSFileManager defaultManager] isReadableFileAtPath:source] )
    [[NSFileManager defaultManager] copyItemAtURL:source toURL:destination error:nil]; 
```

但是，NSWorkspace 可以轻松地将文件移动到 Trash，这是 NSFileManager 无法做到的。

```
[[NSWorkspace sharedWorkspace] performFileOperation:NSWorkspaceRecycleOperation source:foldername destination:@"" files:filenamesArray tag:&tag]; 
```

查看文档以获取对这两个类的更完整描述。（[NSFileManager](https://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/nsfilemanager_Class/Reference/Reference.html)，[NSWorkspace](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSWorkspace_Class/Reference/Reference.html)）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-29T14:42:10.427

`[[NSFileManager defaultManager] copyItemAtPath:srcPath toPath:dstPath error:&error]`

这是类参考的链接：

[http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSFileManager_Class/Reference/Reference.html#//apple_ref/occ/instm/NSFileManager/copyItemAtPath:toPath:error:](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSFileManager_Class/Reference/Reference.html#//apple_ref/occ/instm/NSFileManager/copyItemAtPath:toPath:error:)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-04T10:14:26.540

您还可以使用[FSCopyObjectAsync](https://developer.apple.com/library/mac/#documentation/Carbon/Reference/File_Manager/Reference/reference.html)函数。您可以显示文件复制进度，也可以使用 FSCopyObjectAsync() 取消文件复制。
看看这个[帖子](https://stackoverflow.com/a/9470360/944634)。

**FSCopyObjectAsync 在 OS X v10.8 中已弃用**

[copyfile(3)](https://developer.apple.com/library/mac/#documentation/Carbon/Reference/File_Manager/Reference/reference.html)是 FSCopyObjectAsync 的替代方法。[这](https://stackoverflow.com/a/9470360/944634)是带有进度回调的 copyfile(3) 示例。

# sql-server - 同一个分区方案应该放置多少个表？

> ID：491810
> 
> 赞同：1
> 
> 时间：2009-01-29T14:32:22.600
> 
> 标签：sql-server, database, database-design

我的公司刚刚为我提供了 SQL Server 2005 企业版，我想对一些包含大量数据的表进行分区。我有大约 5 或 6 个表，非常适合按日期时间进行分区。

在同一个查询过程中，会有一些查询需要其中的 2 个表。

我想知道是否应该对所有这些表使用相同的分区方案，或者是否应该复制分区方案并在每个表上放置不同的表。

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T14:41:48.773

您应该根据对您的域有意义的方式来定义您的分区。即，如果您主要在年度季度进行交易，则创建 5 个分区（4 个季度 + 1 个溢出）。

您还应该考虑物理文件放置。来自 MSDN 文章：

> 对表和索引进行分区的第一步是定义分区作为键的数据。分区键必须作为表中的单个列存在，并且必须满足某些条件。分区函数定义了键（也称为数据的逻辑分离）所基于的数据类型。该函数定义此键，但不定义数据在磁盘上的物理位置。数据的放置由分区方案决定。换句话说，该方案将数据映射到一个或多个文件组，这些文件组将数据映射到特定文件，因此也映射到磁盘。该方案总是使用一个函数来执行此操作：如果该函数定义了五个分区，那么该方案必须使用五个文件组。文件组不需要不同；然而，当您拥有多个磁盘并且最好是多个 CPU 时，您将获得更好的性能。当该方案与表一起使用时，您将定义用作分区函数参数的列。

这两篇文章可能有用：

[SQL Server 2005 中的分区表](http://www.simple-talk.com/sql/sql-server-2005/partitioned-tables-in-sql-server-2005/)

[SQL Server 2005 中的分区表和索引](http://msdn.microsoft.com/en-us/library/ms345146.aspx)

# java - Java中的制表符

> ID：491812
> 
> 赞同：6
> 
> 时间：2009-01-29T14:33:02.473
> 
> 标签：java, swing, menu

尝试将制表符放入`JMenuItem`using`\t`但未打印。

我敢打赌这是我所缺少的非常基本的东西。这是代码

```
menuItem = new JMenuItem("New\tCtrl + N"); 
```

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-29T14:38:00.030

试试这个：

```
menuItem = new JMenuItem("New");
menuItem.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_N, ActionEvent.CTRL_MASK)); 
```

您还应该添加助记符以提高可用性：

```
menuItem.setMnemonic(KeyEvent.VK_N); 
```

请参阅[Java 外观指南](http://java.sun.com/products/jlf/)以获得更多说明，尤其是[第 1 卷](http://java.sun.com/products/jlf/ed2/book/index.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T14:36:45.663

您不应该手动添加键盘快捷键，它有一个 API，可以将它们放在适当的位置。例如，[看这里，或者在 Swing 文档中搜索“加速器”。](http://docstore.mik.ua/orelly/java-ent/jfc/ch03_08.htm)

# php - AJAX/JQUERY/PHP 问题

> ID：491820
> 
> 赞同：1
> 
> 时间：2009-01-29T14:35:47.740
> 
> 标签：php, jquery, ajax

我正在尝试通过 jquery $.ajax 函数使用 ajax 'POST' 调用将数据发送到 php 文件。由于某种原因，回调成功，但数据没有进入 php 文件。以下是代码示例：

```
 In JS file:
$.ajax({ type: "POST",
        url: "setData.php",
        data: "myPOSTvar=myData"
        success: function(){ alert("Data Saved"); } 
       });

In php file:

$var = $_POST['myPOSTvar']

... 
```

$var 以默认值结束，而不是发送的数据。

有任何想法吗？

对语法错误感到抱歉...现在正在工作并且没有我的代码在我面前...语法在实际脚本中都是正确的，只是在此处发布时快速键入...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T14:38:50.667

试试这个，看看你是否得到任何信息。

```
$.post("setData.php", { myPOSTvar: "myData" },
    function(data){
        alert("Data saved");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T14:38:56.127

我怀疑它是否成功，url 应该是一个字符串 : url: `"setData.php"`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T14:41:12.457

我真的怀疑那段 JS 代码是否正常工作。POST 和 setData.php 应该用引号括起来。现在你应该得到一些错误，因为“POST”变量没有定义，然后因为你正在访问一个不存在的对象“setData”的“php”属性。

# javascript - 事件“加载”不适用于 JavaScript

> ID：491828
> 
> 赞同：1
> 
> 时间：2009-01-29T14:38:04.913
> 
> 标签：javascript, events

我尝试在文档加载时设置一个事件但不起作用...我会设置一个警告框，但从未见过它...

```
document.addEventListener ("load",initEventHandlers,false);

function initEventHandlers ()
{
document.getElementbyId ('croixzoom').addEventListener ('click',fermezoom,false);
alert ("Hello, i\'m a eventHAndlers")   
}
function fermezoom (){
document.getElementbyId ('zoom').style.visibility = 'hidden';
document.getElementbyId ('fondzoom').style.visibility = 'hidden';
} 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T14:40:58.307

该文档没有 onload / load 事件，请尝试将其附加到“窗口”：

```
window.addEventListener ("load",initEventHandlers,false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T14:43:45.510

关于什么：

```
window.onload = initEventHandlers; 
```

这对你有用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-29T14:46:07.877

**更新** 作为建议，而不是直接解决您的问题：如果您还没有，您可能需要考虑使用框架。也许看看[jQuery](http://jquery.com)，它应该会为您尝试做的事情带来很多痛苦。

然后你可以把它包装成这样的语法：

```
 $(document).ready(function() {
   // put all your jQuery goodness in here.
 }); 
```

不过，您可能不希望在 Javascript 之上添加额外的层。

我希望这会有所帮助！

# javascript - 在 JavaScript 中添加到对象

> ID：491833
> 
> 赞同：1
> 
> 时间：2009-01-29T14:39:23.693
> 
> 标签：javascript, json

我有一个已转换为对象的 JSON 字符串：

```
data=eval("(" + jsonString + ")"); 
```

我可以访问所有位并毫无问题地显示它们。问题是我如何添加到对象。

例如：

```
data.car[0].name = "civic";<BR>
data.car[1].name = "s2000"; 
```

那么，如果我有一个输入框来添加一辆新车，我该如何将它添加到汽车数组中。？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T14:48:10.960

这将在阵列中添加一辆新车：-

```
data.car.push({name: "Zafira"}); 
```

顺便说一句，您在使用 eval 解析 JSON 时要小心，它可能会导致您的代码容易受到注入攻击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T14:49:25.980

在 javascript 中，有两种方法可以将属性添加到对象。

1.  与直接

    ```
    data.car[0].name = 'jose'; 
    ```

2.  像数组一样访问：

    ```
    data.car[0]['name'] = 'jose'; 
    ```

因此，如果您有一个名称字段和一个字段作为您可以创建的值，那么就像：

```
<input type="text" id="name" />
<input type="text" id="value" />
<script type="text/javascript">
    var d = function(id) {
        return document.getElementById(id);
    }
    data.car[0][d("name").value] = d("value").value
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T14:43:47.350

使用上面的示例，例如：

```
data.car[0] = { name: "civic" };
data.car[1] = { name: "s2000" }; 
```

这将为数组元素分配一个新对象，具有一个属性“名称”。Alertnatively，为了更多的代码重用：

```
function car( name) {
    this.name = name
}
data.car[0] = new car("civic");
data.car[1] = new car("s2000"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T14:49:02.003

假设你有一个输入框，你可以附加一个模糊事件（或者当你想要添加汽车时）

```
function addCar(carname){
    data.car.push({name:carname})
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T14:41:09.943

您应该能够使用您发布的语法。Javascript 允许您通过赋值向对象添加属性。由于 JSON 字符串只是被解析为普通对象，因此您只需指定一个新属性并分配您想要的值。

# c# - 如何确定调用了哪些终结器？

> ID：491834
> 
> 赞同：1
> 
> 时间：2009-01-29T14:39:28.607
> 
> 标签：c#, garbage-collection

由于调用终结器通常表示缺少 Dispose() 调用，因此我想确定正在调用哪些终结器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T17:12:27.847

我不确定什么是正确的答案。但是分析器/性能计数器可以在这方面提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T14:44:55.630

怎么样：-

```
System.Diagnostics.Debug.WriteLine(this.GetType()); 
```

# python - 在 Python 中使用从 raw_input 收集的输入

> ID：491837
> 
> 赞同：0
> 
> 时间：2009-01-29T14:39:54.377
> 
> 标签：python, raw-input

如果我在 python 中执行以下操作，

```
string = raw_input('Enter the value') 
```

它会回来

> 输入值

并等到我在提示中输入一些内容。

有没有办法检索/收集我在变量中输入的输入`string`？

我想通过以下方式使用输入的值：

```
if dict.has_key('string'):
          print dict[string] 
```

[注意：*我之前犯了使用错误，`raw_string`但我的意思是说`raw_input`*]

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T14:47:52.367

python的stdlib中没有`raw_string`函数。你的意思是raw_input吗？

```
string = raw_input("Enter the value")     # or just input in python3.0
print(string) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T14:46:31.090

这非常令人困惑......我不熟悉 Python 中的 raw_string 函数，但也许它是特定于应用程序的？

在 Python 中读取一行输入可以这样完成：

```
import sys
line = sys.stdin.readline() 
```

然后你有那行，终止换行和所有，在变量行中，所以你可以使用它，例如使用它有一个哈希键：

```
line = line.strip()
if line in dict: print dict[line] 
```

第一行去掉了尾随的换行符，因为您的哈希键可能没有它们。

我希望这会有所帮助，否则请尝试在您的问题中更清楚一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-29T14:49:30.600

这是你想做的吗？

```
string = raw_input('Enter a value: ')
string = string.strip()
if string in dict: print dict[string] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-19T21:32:50.230

`import readline`为函数提供完整的终端提示`raw_input`。您可以通过这种方式获得控制键和历史记录。否则，它并不比`sys.stdin.readline()`选项更好。

```
import readline

while True:
    value = raw_input('Enter a value: ')
    value = value.strip()
    if value.lower() == 'quit': break 
```

# xml - 将 Oracle 行序列化为 XML

> ID：491838
> 
> 赞同：7
> 
> 时间：2009-01-29T14:40:11.023
> 
> 标签：xml, oracle, serialization

我想创建一个存储过程，它采用表名和 row_id 并将其序列化为 xml 字符串。

该表可能包含 clob 和 blob。

我可以在 PL/SQL 中执行此操作，还是必须使用 Java？

这样做的主要目标是在某些表上创建一个包含所有更新和删除的表，保留 X 个最新版本或 X 天的数据（该表将包含类似`chg_date(default:sysdate)`, `chg_type(U or D)`, 的`chg_xml`内容，并且可能包含一些关于用户的元数据）。

可能的用途： - 它还可以保留所有数据并用作日志 - 将行返回到任何先前值的能力。- 以特定格式进行 EDI 的能力。

我不想使用 Oracle 的闪回查询来到达那里，因为无法保证数据的可用性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T15:31:45.787

Oracle 具有以 xml 格式返回查询的功能。

在此示例中，将 &table 替换为您的表名，并将 &rowid 替换为 rowid。我对其进行了测试，它似乎适用于 clobs 和 blobs。对于 blob，它以十六进制返回数据。

```
SELECT DBMS_XMLGEN.getxmltype ('select * from &table_name where rowid = ''&rowid''' )
  FROM DUAL 
```

# c++ - 是否有解决未定义参考/未解决符号问题的一般准则？

> ID：491859
> 
> 赞同：7
> 
> 时间：2009-01-29T14:45:00.157
> 
> 标签：c++, reference, undefined, symbols

我在工作的地方遇到了几个“未定义的引用”（链接期间）和“未解析的符号”（dlopen 之后的运行时）问题。这是一个相当大的makefile系统。

是否有链接库和使用编译器标志/选项来规避这些类型的错误的一般规则和指南？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-29T15:05:44.233

## 如果您使用的是 MSVC：

**您不能通过设置标志来规避此类错误**：这意味着某些单元 (.cpp) 没有声明标识符的定义。这肯定是由于某处缺少包含或缺少对象定义（通常是静态对象）引起的。

在开发过程中，您可以遵循这些指南（来自[那些文章](http://gamesfromwithin.com/?p=7)），以确保您的所有 cpp 都包含他们需要的所有标题，但仅此而已：

> *   每个 cpp 文件首先包含自己的头文件。这是最重要的准则；其他一切都从这里开始。此规则的唯一例外是 Visual Studio 中包含的预编译头文件；那些总是必须是文件中的第一个包含。本文第二部分中有关预编译头文件的更多信息。
> *   头文件必须包含解析它所需的所有头文件。这与第一条准则密切相关。我知道有些人试图从不将头文件包含在声称效率或类似内容的头文件中。但是，如果在解析头文件之前必须包含文件，则必须将其包含在某处。将它直接包含在头文件中的好处是我们总是可以决定拉入我们感兴趣的头文件，并且我们保证它会按原样工作。我们不必玩“猜猜你还需要什么其他标题”的游戏。
> *   头文件应该具有解析它所需的最少数量的头文件。前面的规则说你应该在头文件中包含你需要的所有内容。这条规则说你不应该比你必须拥有的更多。显然，首先删除（或首先不添加）无用的包含语句。然后，尽可能多地使用前向声明而不是包含。如果你只有一个类的引用或指针，你不需要包含那个类的头文件；前向参考会做得更好，效率更高。

但正如评论者所建议的那样，您似乎正在使用 g++ ...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-29T15:05:17.853

建立一个 X 依赖于 Y 的构建系统，而 Y 依赖于 Z 会有所帮助。当你进入圈子（Z 取决于 X）时，事情就会变得丑陋。

通常是链接库的顺序（“-lZ -lY -lX”与“-lX -lY -lZ”）导致悲伤。更罕见的是，您在搜索路径的多个位置具有相同的库名称，或者链接到尚未重新编译的过时版本。

***“nm --demangle”***可以让您查看定义/使用事物的位置。

***“ldd”***可以用来查看你依赖的动态库。

gcc/g++ 标志***-print-file-name=LIBRARY***可以帮助准确跟踪正在使用的库。

* * *

事后思考：（因为您询问规则/指南。）

可以设置一个 makefile 系统，这样：

*   如果 module=D 取决于模块 A、B 和 C。
*   然后尝试制作 module=D 将首先制作模块 A、B 和 C。
*   而且，更重要的是，module=D 将自动从模块 A、B 和 C 的生成文件中确定其库（-lA 等）、库路径（-LA）和包含路径（-IA）。

设置起来可能有点麻烦。上次我这样做时，我倾向于只缓存信息而不是分叉过多的 make 子进程。再加上 makefile-importing 和一个小的 perl 脚本来删除重复项。克鲁奇，我知道。（那些不想花时间在基础设施上的权力。）但这是可以做到的。

再说一次，我使用的是 GNU-make，它有一些扩展。

# gmail - 如何让GMail继续对话？

> ID：491863
> 
> 赞同：0
> 
> 时间：2009-01-29T14:45:54.430
> 
> 标签：gmail

当提供**相同的主题行**不起作用时？

我想发送 2 封电子邮件并让它们出现在一个对话中。可悲的是，第二个总是开始新的对话。如何避免这种情况？

两封邮件都直接发送到`my.address@gmail.com`

两者都有几乎相同的标题和相同的 UTF-8 编码主题：

```
Delivered-To: my.account@gmail.com
Received: by ...
Return-Path: ...
Received: ...
Received-SPF: pass ...
Authentication-Results: mx.google.com; spf=pass ...
Received: from mm_www by ...
To: my.account@gmail.com
Subject: =?UTF-8?...=?=
From: notification@my.domain
Content-Type: text/plain; charset=UTF-8; format=flowed
MIME-Version: 1.0
Content-Transfer-Encoding: 8bit
X-Mailer: PHP
Message-Id: ... (Different for both messages. Should I add my own id?)
Date: ... 
```

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T14:49:30.037

是的，消息 ID 在这里很重要。客户端使用它来确定流量。

# .net - .Net WebBrowser 控件封装了除 IE 之外的任何东西？

> ID：491867
> 
> 赞同：1
> 
> 时间：2009-01-29T14:46:25.003
> 
> 标签：.net, webbrowser-control

我们使用 SHDocVw.dll 为我们的一些用户提供 Web 浏览器控件，这些用户通过他们安装在计算机上的小工具访问我们的系统。现在，该控件封装了 IE。有谁知道让用户选择封装什么浏览器的方法？

编辑 - 澄清：我有兴趣能够封装另一个浏览器。不一定要用 SHDocVw 来做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T14:51:24.637

您无法更改 SHDocVw 封装的浏览器。对不起。SHDocVw 是 IE 的一部分，它不托管 IE。[有关 IE 体系结构，请参阅此 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa741313(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T15:16:19.750

一种可能性是完全跳过 Web 浏览器控件，只需启动一个运行您想要的浏览器的新进程。下面是一个关于如何启动 Firefox 浏览器的基本且简单的示例：

```
Dim p As New Process()
p.StartInfo.FileName = "firefox.exe" 
p.StartInfo.Arguments = "http://stackoverflow.com" 
p.Start() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T15:18:58.543

FireFox 有一个活动的 x 控件，因此您也可以封装它。目前尚不清楚 XULRunners active x 控件对 IWebBrowser2 接口的支持程度（请注意，xul runners 表示 active x 不完整。）

看：

[https://developer.mozilla.org/en/XULRunner/What_XULRunner_Provides](https://developer.mozilla.org/en/XULRunner/What_XULRunner_Provides) [https://developer.mozilla.org/En/XULRunner](https://developer.mozilla.org/En/XULRunner) [http://nick.typepad.com/blog/2008/03/can-mozilla-be。 html](http://nick.typepad.com/blog/2008/03/can-mozilla-be.html) [http://www.iol.ie/~locka/mozilla/control.htm](http://www.iol.ie/~locka/mozilla/control.htm)

简而言之，这将是很多工作。

# asp.net - 通过 .aspx 页面创建默认数据库设置的最佳方式？

> ID：491873
> 
> 赞同：0
> 
> 时间：2009-01-29T14:47:47.873
> 
> 标签：asp.net, sql-server, database, stored-procedures

我们将出售一项由我们托管的服务，我们托管的每个客户都将拥有自己的数据库，但会有一个集中式网站。我目前有一个空白数据库，其中包含新客户需要的一些东西。复制此数据库以便我可以设置另一个客户端的最佳方法是什么？我希望能够从 .aspx 页面执行此操作。提前致谢！

更新：通过 .aspx 页面，我只是意味着我需要能够从 .aspx 页面启动该过程。

更新 2：我们正在运行 SQL Server 2008。

更新 3：参考 Cade Roux 的回答...感谢您的出色回答，但是...将所有数据库合并为一个，然后根据每个表中的标识符区分客户端的原因是什么？这不会极大地复杂化整个产品的架构吗？我需要将这些客户端 ID 列添加到几乎每个表中，并且 DAL 需要知道它在寻找哪些客户端数据。使用我当前的设置，我只需根据访问站点的用户切换 DAL 中的连接字符串。这样，在设置连接字符串后，我再也不用担心查找客户端特定的数据了！这些方法如何比较（我应该将其添加为一个单独的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T16:25:06.677

你有几个不同的选择：

您可以分离您的空数据库，然后当用户注册时，复制该数据库并以他们的唯一名称安装它，并将其映射到他们在您的主数据库中的帐户，例如。

您可以使用脚本从头开始创建数据库，并从在线模板数据库或编写基本数据脚本填充任何基本数据，并将其映射到他们在主数据库中的帐户。

如果您要拥有几十个客户，您应该认真考虑采用所有用户都在同一个数据库中的多租户架构（大多数表都有 CustomerID 列来隔离数据）。

关于您关于选项 3 的注释 - 这取决于您的应用程序。多租户可能难以改造。另一方面，从长远来看，管理和升级数百个单独的客户数据库可能很困难。

以前有关于此的 Stack Overflow 问题：

[为每个客户使用单一数据库有什么优势？](https://stackoverflow.com/questions/13348)

[一个数据库还是多个？](https://stackoverflow.com/questions/20321)

我想我会看到用 multi-tenant-db 或其他东西重新标记它们。无论如何，我认为这是您对特定策略的回答的次要考虑，这确实表明了在 StackOverflow 上的每个问题中包含有关您的总体战略目标的详细信息的重要性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T15:02:39.183

根据您使用的数据库，有几种方法。最简单的方法是让您的数据库软件生成用于创建数据库的 SQL 代码并将其包含在您的软件中。另一种方法是在 C#/VB 中编写重新创建空数据库所需的步骤。

为什么需要.aspx 页面？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T15:05:59.600

您没有说您使用的是什么数据库版本，但在 SQL2005-2008 中，您可以“将数据库脚本编写为”，然后“创建到”并将 sql 移植到查询窗口。然后，您可以使用它来创建可以从 .aspx 页面调用的存储过程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-29T16:54:29.333

SQL Server 有一个称为“模型”的系统数据库。模型中存在的任何数据库对象（表、视图、存储过程）都将添加到创建的任何新数据库中。

您可以将“客户端数据库”模式创建为模型，并且任何新数据库都将具有所有相同的表...

但是，如果您以后需要更改数据库架构，最好的选择是编写作为代码隐藏文件一部分的更改脚本。由于对“模型”数据库的更改不会传播到现有数据库，因此应用程序需要根据需要**检测**和**升级**数据库模式。

这种方法的缺点：如果您想要一个不是“客户端数据库”的数据库，那么您需要创建数据库，然后删除“客户端数据库”表。

# oracle - 为什么 ODP.NET 11 xcopy 部署不能在安装了 Oracle DB 10 的机器上工作？

> ID：491876
> 
> 赞同：5
> 
> 时间：2009-01-29T14:48:21.273
> 
> 标签：oracle, odp.net

我有一个应用程序在 .exe 文件所在的目录下使用本地版本的 ODAC 11。我们希望我们的应用程序使用本地 ODAC 11，而不管用户在她的机器上安装了什么。

Oracle.DataAccess.dll 与 .exe 位于同一目录中。

当客户端机器没有安装 Oracle 客户端时它工作正常，但是在安装了 Oracle Database 10.2.0.something 的机器上启动它时出现错误：

```
The type initializer for 'Oracle.DataAccess.Client.OracleConnection' threw an exception.

[Stack Trace]

The provider is not compatible with the version of Oracle client
OracleException
   at Oracle.DataAccess.Client.OracleInit.Initialize()
   at Oracle.DataAccess.Client.OracleConnection..cctor() 
```

我猜这与运行时绑定策略有关，但在 Google 上搜索“Oracle/ODAC/ODP.NET 运行时绑定策略”并没有发现任何有用的信息。

有谁知道如何解决这个问题？

如果不是这个特定问题，有人可以向我指出如何做我想做的事情的概述：确保我的应用程序无论如何都使用 ODAC 11？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-02T19:36:52.357

所以据我了解，问题在于，虽然 Oracle.DataAccess.dll 与应用程序位于同一目录中，但它找不到其较低级别的伙伴（oci 等），因此出现兼容性错误。

事实证明，如果您希望应用程序与 ODAC 11 xcopy 部署一起使用，而不管用户可能在她的机器上安装了什么其他东西，您需要做 2 件事：

1.  为进程设置 PATH 环境变量。（我已经这样做了。）
2.  为进程设置 ORACLE_HOME 环境变量。（我没有这样做。）

    ```
    Environment.SetEnvironmentVariable("PATH", Environment.CurrentDirectory + "\\oracle\\11.1\\odac;" + Environment.CurrentDirectory + "\\oracle\\11.1\\odac\\bin;", EnvironmentVariableTarget.Process);
    Environment.SetEnvironmentVariable("ORACLE_HOME", Environment.CurrentDirectory + "\\oracle\\11.1\\odac", EnvironmentVariableTarget.Process); 
    ```

**编辑：**同样重要的是要注意，Oracle 不仅会因为环境问题引发此错误，而且如果目标机器上缺少其中一个文件，也会引发此错误。尽管有环境设置，但我在其他机器上也遇到了同样的错误，因为我将 Subversion 设置为忽略名为“bin”的目录，因此没有将 OraOps DLL 复制到客户端。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-02-09T16:01:42.590

[http://alderprogs.blogspot.com/2009/04/deploying-odpnet-with-oracle-instant.html](http://alderprogs.blogspot.com/2009/04/deploying-odpnet-with-oracle-instant.html)上的一篇题为“使用 Oracle Instant Client 部署 ODP.NET”的文章给出了对我来说最好的解释如何为您的应用程序提供精简的 xcopy 类型部署。支持只需要 5 个 Oracle DLL。

也就是说，ObiWanKenobi 和 Josh Kodroff 的回答提供了与我的经验相匹配的重要附加信息。

补充一点：[http ://www.brothersincode.com/post/Oracle-ODPnet-xcopy-deployment-for-aspnet.aspx](http://www.brothersincode.com/post/Oracle-ODPnet-xcopy-deployment-for-aspnet.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-01T07:03:02.980

您想强制 ODP.NET 驱动程序使用本地文件夹中的 oci.dll 副本，而不是已经安装的。

您可以通过以下任一方式强制执行此操作

*   设置 PATH 变量，以便系统首先找到您的 oci.dll 副本（如 Josh Kodroff 的回答）

或者

*   您可以使用 app.config（或 web.config）中的 ODP.NET 配置部分来显式设置“DllPath”的值。

有关详细信息，请参阅[http://ora-00001.blogspot.com/2010/01/odpnet-minimal-non-intrusive-install.html](http://ora-00001.blogspot.com/2010/01/odpnet-minimal-non-intrusive-install.html)和[http://database.in2p3.fr/doc/oracle/Oracle_Database_11_Release_1_(11.1) _Documentation/win.111/e10927/featConfig.htm](http://database.in2p3.fr/doc/oracle/Oracle_Database_11_Release_1_(11.1)_Documentation/win.111/e10927/featConfig.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-01T21:35:13.710

如果您使用的是 oracle 客户端 10.2.0.1 或 10.2.0.2，Oracle 说明 215255.1 指出，如果您应用补丁集 10.2.0.3，它可以解决问题。获取 10.2.0.3 数据库补丁 (852MB) 并修补客户端主页。是的，它是完整的数据库服务器补丁集，但它也适用于客户端。

# java - 如何在 linux 或 unix 上找到用户的主目录？

> ID：491877
> 
> 赞同：48
> 
> 时间：2009-01-29T14:48:42.193
> 
> 标签：java, linux, unix, grails

如何从 Grails 中找到任意用户的主目录？在 Linux 上，它通常是 /home/user。但是，在某些操作系统上，例如 OpenSolaris，路径是 /export/home/user。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-01-30T07:04:25.700

通常你使用语句

```
String userHome = System.getProperty( "user.home" ); 
```

在任何平台上获取用户的主目录。[请参阅getProperty](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#getProperty(java.lang.String))的方法文档以了解您还能获得什么。

[使用此](https://stackoverflow.com/questions/277100/accesscontrolexception-when-attempting-to-delete-a-file/277287#277287)解决方法可能会出现访问问题（使用安全策略文件）

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-01-29T17:46:41.973

对于类 UNIX 系统，您可能希望`echo ~username`使用 shell 执行“”（因此使用`Runtime.exec()`to run `{"/bin/sh", "-c", "echo ~username"}`）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-02-20T13:37:49.160

在 Java 上试试这个：

```
System.out.println("OS: " + System.getProperty("os.name") + ", USER DIRECTORY: " + System.getProperty("user.home")); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-10-19T18:14:10.350

对于任意用户，作为网络服务器：

```
private String getUserHome(String userName) throws IOException{
    return new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(new String[]{"sh", "-c", "echo ~" + userName}).getInputStream())).readLine();
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-29T14:50:32.483

您可以为此使用环境变量`$HOME`。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-29T14:58:49.550

如果你想找到特定用户的主目录，我不相信你可以直接做到。

当我以前需要从 Java 中执行此操作时，我不得不编写一些 JNI 本机代码来包装 UNIX`getpwXXX()`系列调用。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-05-25T16:28:10.377

我假设您想找到不同用户的主目录。显然，获取“user.home”属性将是获取当前用户主目录的最简单方法。

要获取任意用户主目录，需要使用命令行技巧：

```
String[] command = {"/bin/sh", "-c", "echo ~root"}; //substitute desired username
Process outsideProcess = rt.exec(command);
outsideProcess.waitFor();
String tempResult;
StringBuilder sb = new StringBuilder();
while((tempResult = br.readLine()) != null) sb.append(tempResult);
br.close();
return sb.toString().trim(); 
```

现在从技术上讲，我们应该有一个线程在 stdout 和 stderr 上等待，这样缓冲区就不会填满并锁定进程，但我肯定希望缓冲区至少可以保存一个用户名。此外，您可能需要检查结果以查看它是否以 ~root （或您使用的任何用户名）开头，以确保用户确实存在并且它被正确评估。

希望有帮助。如果确实如此，请投票给这个答案，因为我是为 SO 做出贡献的新手并且可以使用这些积分。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-02-18T08:02:21.653

如果您尝试为无法硬编码的用户名执行此操作，则可能具有挑战性。当然`echo ~rbronosky`会告诉你我的 home dir 的路径`/home/rbronosky`，但是如果 rbronosky 在一个变量中呢？如果你这样做`name=rbronosky; echo ~$name`，你会得到`~rbronosky`

这是一个真实的案例和解决方案：

您有一个用户必须通过**sudo**运行的脚本。该脚本必须访问用户的主文件夹。您不能引用`~/.ssh`，否则它将扩展为`/root/.ssh`. 相反，你这样做：

```
# Up near the top of your script add
export HOME=$(bash <<< "echo ~${SUDO_USER:-}")
# Then you can use $HOME like you would expect
cat rsa_key.pub >> $HOME/.ssh/authorized_keys 
```

它的美妙之处在于，如果脚本不作为**sudo**运行，那么 $SUDO_USER 为空，所以它基本上与执行“echo ~”相同。它仍然可以按您的预期工作。

如果您使用**[应该使用](https://gist.githubusercontent.com/RichardBronosky/5222338/raw/seteu.sh)**`set -o nounset`的，则变量引用将默认为空白，如果不通过.`${SUDO_USER:-}``$SUDO_USER``${SUDO_USER}``sudo`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-10-29T10:48:33.313

评估回声 ~$SUDO_USER

可能会奏效。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-29T14:58:31.453

要在 UNIX 系统上查找用户 FOO 的主目录，请使用`~FOO`. 对于当前用户，使用`~`.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-29T15:02:32.740

你能解析 /etc/passwd 吗？

例如：

```
 cat /etc/passwd | awk -F: '{printf "User %s Home %s\n",  $1, $6}' 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-29T15:09:42.897

查找函数的 Java 包装器`getpwuid/getpwnam(3)`，它们通过 uid 或登录名向系统询问用户信息，然后您将返回所有信息，包括默认主目录。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-29T17:58:50.263

userdir 前缀（例如，'/home' 或'/export/home'）可以是一个配置项。然后应用程序可以将任意用户名附加到该路径。

警告：这不会与操作系统进行智能交互，所以如果它是一个 Windows 系统，用户目录位于不同的驱动器上，或者是 Unix 上的主目录布局，如 /home/f/foo、/home /b/酒吧。

# c++ - 如何按照 RFC 3339 格式化 boost::date_time-object

> ID：491883
> 
> 赞同：4
> 
> 时间：2009-01-29T14:49:34.950
> 
> 标签：c++, boost-date-time, rfc3339

我想`date_time`在 boost 中使用该库来表示我的应用程序中的时间。[此应用程序将生成 Atom 提要，进而要求使用RFC 3339](https://www.rfc-editor.org/rfc/rfc3339)中指定格式的时间戳，例如“1990-12-31T23:59:60Z”或“1990-12-31T15:59:60-08:00” ”。

那么，如何根据这个 RFC 格式化时间？

我整天都在阅读[日期时间输入/输出文档](http://www.boost.org/doc/libs/1_37_0/doc/html/date_time/date_time_io.html)，但我似乎无法找到如何在需要时将 Z 放在末尾。此外，RFC 支持可选的小数秒，但只有一位数（例如“1990-12-31T23:59:60.5Z”）（*）。我似乎也无法找到如何做到这一点。

我总是可以编写自己的格式化例程来读出不同的所需字段，但在我看来，这与`date_time`图书馆的宗旨背道而驰。

有为这个库编写格式化程序的经验吗？还是我做错了？

(*)：在我看来，RFC 中给出的 ABNF 只允许一位小数秒，但同一 RFC 中的示例有两位小数秒。那应该是什么意思？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T12:16:31.313

1.  来自 RFC 的 ABNF 表示点后必须至少有一位数字，没有定义的最大值。

2.  没有真正需要 Z，您可以使用 00:00 代替，这可以通过构面实现

3.  在极少数情况下，date_time 会生成一个“Z”。请参阅 boost (local_date_time.hpp) 的代码快照，这表明如下：

```
 std::string zone_name(bool as_offset=false) const
    {
      if(zone_ == boost::shared_ptr()) {
        if(as_offset) {
          return std::string("Z");
        }
        else {
          return std::string("Coordinated Universal Time");
        }
    ... 
```

如果在 zone_abbrev 函数中有类似的...

以及这个的示例用法

 `````
slimak@daradei:~/store/kodowanie/moje/test$ cat boost_date_time.cpp
#include "boost/date_time.hpp"
#include "boost/date_time/local_time/local_time.hpp"

using namespace boost::posix_time;
using namespace boost::local_time;

int main()
{
        local_date_time t = local_sec_clock::local_time(time_zone_ptr());
        local_time_facet* lf(new local_time_facet("%Y-%m-%dT%H:%M:%S%F%Q"));
        std::cout.imbue(std::locale(std::cout.getloc(), lf));
        std::cout << t << std::endl;
        return 0;
}
slimak@daradei:~/store/kodowanie/moje/test$ g++ boost_date_time.cpp && ./a.out
2009-01-30T12:15:56Z
slimak@daradei:~/store/kodowanie/moje/test$ 
````  `# vb.net - 如何使用 VB.NET 或 VB6 编辑注册表项？

> ID：491890
> 
> 赞同：3
> 
> 时间：2009-01-29T14:51:57.020
> 
> 标签：vb.net, vb6, registry

我需要编辑注册表项并将数据值设置为“4”

我知道如何通过命令提示符执行此操作，但我试图找到一些 Visual Basic 代码来执行此操作。

如果有帮助，这是关键：

> HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\USBSTOR\Start

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T15:02:16.783

这是您在 Visual Basic .NET 中的操作方法

```
 Dim key As RegistryKey = Registry.LocalMachine
    Dim subkey As RegistryKey

    subkey = key.OpenSubKey("SYSTEM\CurrentControlSet\Services\USBSTOR", True)

    subkey.SetValue("Start", 4) 
```

您需要确保添加

```
Imports System
Imports Microsoft.Win32 
```

在代码的顶部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T15:18:09.747

以下是在 Visual Basic 6（或 VBA）中的操作方法

下载此[注册表编辑代码](http://refactormycode.com/codes/726-vb6-registry-editing-class)并将其放入一个类中。

然后您可以使用如下代码来实际修改该值：

```
Dim reg As New RegistryClass

With reg
    .SetKeyValue .HKEY_LOCAL_MACHINE, "SYSTEM\CurrentControlSet\Services\USBSTOR", .RegDWORD, "Start", 4
End With 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T14:56:49.447

您需要使用[Microsoft.Win32命名空间中的](http://msdn.microsoft.com/en-us/library/microsoft.win32.aspx)[Registry](http://msdn.microsoft.com/en-us/library/microsoft.win32.registry.aspx)类。检查文档，它非常易于使用。

# asp.net - 我应该考虑使用 VPS 来托管我的 Web 应用程序吗？

> ID：491896
> 
> 赞同：1
> 
> 时间：2009-01-29T14:54:52.507
> 
> 标签：asp.net, hosting, web-applications, vps

使用虚拟专用服务器而不是专用服务器来托管我的 Web 应用程序有哪些缺点（如果有）？

我在几个月内启动了我的第一个 Web 应用程序，我想知道以可承受的价格托管它的最佳方式是什么。它内置于 ASP.Net 并使用 SQL Server Express。

我的观点是，由于它是一个基于订阅的网络应用程序，我预计前几个月不会有大量流量，VPS 会处理流量吗？

我一直在环顾四周，我可以以 50 美元的价格找到一个带有 2Gb 内存的 VPS，而且这比租用一台私人服务器的方式低得多，我确信在最初的几个月里它会被充分利用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T14:57:54.873

VPS 的主要缺点之一是尽管他们吹捧“专用处理器”，但您仍然拥有共享资源。虽然这可能是真的，但您仍然与其他 VPS 客户端共享服务器。

从那里开始并没有错，特别是如果该服务有直接升级到专用的路径，如果您的 Web 应用程序允许的话。让我们希望它做到了！我很想遇到这些问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T14:59:38.847

我的直觉是，VPS 对你来说会很好用。但是我认为，如果您在[WebHostingTalk](http://www.webhostingtalk.com/)上提出问题，您在此类问题上获得良好指导的机会就会增加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T15:06:28.723

为什么不自己试试呢？下载 Virtual PC（[免费下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=04d26402-3199-48a3-afa2-2dc0b40a73b6&displaylang=en)），构建一个与您的目标 VPS 类似的虚拟机，安装您的应用程序并进行一些负载测试！

这将为您提供最准确的结果，因为这正是 VPS 供应商正在做的事情。

# windows - 当正文包含回车和换行时，如何使用 blat 从命令行发送电子邮件？

> ID：491898
> 
> 赞同：4
> 
> 时间：2009-01-29T14:56:01.880
> 
> 标签：windows, email, smtp, blat

我有一个 Windows 服务器，它通过 BASIC 程序向我发送电子邮件。如果邮件正文包含回车/换行，则电子邮件永远不会结束。只有第一行发送给我。我尝试用 \n 替换它们，但这并没有帮助，因为电子邮件中带有 \n 。有任何想法吗？

这是我正在使用的命令：

```
blat -to mike.roosa@toltsg.com -subject "[DEV] PO Detail Report" -body "Attached file
is ready for import.
From 01/01/09 to 01/29/09 
PO Status not egual to 'C'" -attach "C:\TXT\PODetail_26879.csv" -log
C:\EMAIL.LOG\20090129.TXT -timestamp'. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-29T15:01:11.980

您可以将正文放在文本文件中并让 blat 发送：

```
blat [text file here] -to mike.roosa@toltsg.com -subject "[DEV] PO Detail Report" -attach "C:\TXT\PODetail_26879.csv" -log
C:\EMAIL.LOG\20090129.TXT -timestamp' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T22:48:02.707

如果你想内联使用'|' 特点

```
-body 1st line|second line|third line 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-29T18:03:06.700

只需使用 Mail Alert Simple Mailer： [https ://sourceforge.net/projects/mail-alert/](https://sourceforge.net/projects/mail-alert/)

MailAlert.exe -r 地址@example.com -b "@Your_Directory\File_with_Mail_Body.txt"

您还可以将 HTML 文件作为电子邮件正文附加（请记住在这种情况下更改 PlaintextOnly=no）。

# c# - 使用 linq 更新 XmlDocument（可能）

> ID：491899
> 
> 赞同：1
> 
> 时间：2009-01-29T14:56:14.580
> 
> 标签：c#, xml, linq

我在内存中有一个 XmlDocument 对象，这是数据示例：

```
<terms>
<letter name="F">
<term>
  <name>fascículo</name>
  <translation language="en">fascicle</translation>
  <definition>pequeño paquete de fibras nerviosas o musculares</definition>
</term> 
```

（实际文档中有很多术语）

我希望能够通过其名称节点找到一个术语，然后添加一个元素作为该术语的子项

```
<terms>
<letter name="F">
<term>
  <name>fascículo</name>
  <translation language="en">fascicle</translation>
  <definition>pequeño paquete de fibras nerviosas o musculares</definition>
<image>hi there</image>
</term> 
```

现在我可以使用 Xpath 实现这一点，找到节点，然后使用新值创建一个新节点，等等。

但这在 linq 的世界里似乎有点啰嗦。

这是我到目前为止所拥有的：

```
 private static XmlDocument AddImages(XmlDocument termDoc)
    {
        XDocument xDoc = XDocument.Load(new XmlNodeReader(termDoc));

        using (CsvReader csv = new CsvReader(new StreamReader("spa2engimages.csv"), false))
        {
            csv.ReadNextRecord();
            csv.ReadNextRecord();
            XElement selectedTerm;

            string name, imageref;

            while (csv.ReadNextRecord())
            {
                imageref = csv[0].ToString();
                name = csv[3].ToString();
                selectedTerm = xDoc.Descendants("term").Single(t => t.Descendants("name").Single().Value == name);

                //now want to add a new node and save it back in to the termDoc somehow
            }
        }

        return termDoc;
    } 
```

但我从那里有点迷路了。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T15:14:32.030

以下将为您添加元素

`xDoc.Descendants("term").Single(t => t.Descendants("name").Single().Value == name).Add(new XElement("image", "hi there"));`

我看到的最大问题是您需要在 XmlDocument 和 XDocument 之间来回切换。我的建议是，如果要使用 XmlDocument，则使用 XPath；如果要使用 LINQ，则使用 XDocument。这种不断的切换会破坏性能和可维护性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T15:59:34.013

这是使用 xPath 的方法，只是为了清楚起见

```
termDoc.SelectSingleNode("//term[name='" + name + "']").AppendChild(imageNode); 
```

# .net - T4 vs CodeDom vs 奥斯陆

> ID：491900
> 
> 赞同：4
> 
> 时间：2009-01-29T14:56:23.893
> 
> 标签：.net, code-generation, t4, codedom, oslo

在我正在处理的应用程序脚手架项目中，我试图决定是否使用[Oslo](http://msdn.microsoft.com/en-us/oslo/default.aspx)、[T4](http://www.olegsych.com/2007/12/text-template-transformation-toolkit/)或[CodeDom](http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx)来生成代码。我们的目标是将依赖关系保持在最低限度，并根据用户故事为领域驱动设计驱动代码生成。第一步是从用户故事创建测试，但我们希望领域专家能够在各种不同的媒体（例如自定义应用程序、Word 等）中编写他们的故事，并且仍然从用户故事生成测试故事。

到目前为止我所知道的：

1.  CodeDom 需要 .NET 但只能输出 .NET 类文件（例如 .cs、.vb）。难度级别相当高。
2.  T4 需要 CodeDom 和 VS Standard+。难度级别相当合理，尤其是使用[T4 Toolbox](http://www.codeplex.com/t4toolbox)时。
3.  奥斯陆很新。我不知道依赖关系，但我想你必须至少在 .NET 3.5 上。我也不确定代码生成能力或添加新语法的复杂性。但是，领域专家可能很容易在 Intellipad 中编写用户故事。也不确定将 Word 中的故事转换为 MGrammar 的难易程度。

您对上述任何工具有什么想法、经验等。我们希望坚持使用 Microsoft 或开源工具。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-29T16:26:04.117

选择 T4 - 轻松决定。

*   奥斯陆太新了，工具太原始了，只能是评估技术
*   CodeDOM 功能强大，如果您需要在运行时生成 CLR 类，并且愿意牺牲对生成的输出的简单修改。
*   T4（带有 T4 工具包）是一个易于使用的通用代码生成工具。到目前为止，我遇到的唯一困难是构建时集成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T16:18:18.250

一般来说，我将代码生成视为完整建模/编码故事的一部分。它应该伴随着一个通用框架，大部分管道都在其中完成。在我看来，生成巨大的类是没有用的，而具有良好定义的扩展点或钩子的体面框架将更好地维护和扩展。

您将需要为用户故事定义一些形式化的语言，无论是 XML 还是 Oslo 域语言。Oslo 需要您的领域专家学习 Oslo 工具。您可以使用 Word + XML。然后，您在 Word 中定义一个漂亮的模板，其中嵌入了 XML 模式，在编写完故事后，您可以从 Word 中以形式化的 XML 语法获取它。当然，该 XML 可以通过 XSLT 或 Linq 用于驱动生成器。

CodeDOM 功能强大，但相当麻烦。恕我直言，它不是一个易于使用的解决方案，并且它没有真正的模板支持。

我没有使用 T4 的经验，但它的模板功能是预先准备好的。

Oslo 产品确实很新，需要.Net 4.0，一个运行时环境。它仍然只是一个 CTP。这是一个非常强大的环境，虽然我对数据库生成的故事有些怀疑。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T07:27:50.263

好吧，奥斯陆不适合这份名单。到目前为止，它还没有代码生成故事。所以坚持T4。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T13:20:36.587

Oslo 无意为您生成代码。您将必须创建一个运行时（例如 C# 程序）来根据数据更改其行为。您可以将其视为 Internet 浏览器。

我不相信奥斯陆需要 .Net 4.0，就像 Rine 提到的那样。在 Avanade Netherland 实习期间，我正在创建 Oslo MSchema 和 Mgrammars 以及 C#3.5 运行时。根据给定的数据，它将创建（不生成）WCF 服务并运行这些服务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-27T21:11:56.710

奥斯陆有一些有趣的应用

*   “新 LDAP”System.Identity，更多内容在 PDC 会话视频 [http://microsoftpdc.com/Sessions/SVC28](http://microsoftpdc.com/Sessions/SVC28)
*   System.Modelling（我认为）Microsoft.UML2，您可以在其中推送有关存储库中的方法、类、模块等的信息，对其进行分析并创建报告。例如，在 2 个构建之间添加/删除方法创建报告[http://microsoftpdc.com/Sessions/SVR19](http://microsoftpdc.com/Sessions/SVR19)
*   当然还有建模

# latex - 如何删除附录中两章之间的空白页？

> ID：491904
> 
> 赞同：106
> 
> 时间：2009-01-29T14:57:35.653
> 
> 标签：latex

有没有办法删除出现在附录中两章之间的空白页？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-01-29T15:44:42.360

您的问题是，当您处于双面布局模式时，所有章节，无论是否在附录中，都默认从奇数页开始。一些可能的解决方案：

最简单的解决方案是使用`openany`文档类的选项，使章节从下一页开始，无论它是奇数页还是偶数页。这在标准书籍文档类中得到支持，例如`\documentclass[openany]{book}`. （[`memoir`](http://www.ctan.org/tex-archive/macros/latex/contrib/memoir/)还支持将其用作声明`\openany`，可在文档中间使用以更改后续页面的行为。）

另一种选择是在附录之前尝试该`\let\cleardoublepage\clearpage`命令以避免该行为。

或者，如果您不关心使用双面布局，则使用`oneside`您的`documentclass`(例如`\documentclass[oneside]{book}`) 选项将切换到使用单面布局。

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2011-12-03T22:17:19.460

这很容易：

添加`\documentclass[oneside]{book}` ，你很好;）

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2014-03-03T19:49:06.960

我尝试了 Noah 的建议，这导致了迄今为止最好的解决方案。

只需`\let\cleardoublepage\clearpage`在所有带有空白页的部分之前插入 特别是当您使用`\documentclass[12pt,a4paper]{book}`

frederic snyers 的建议`\documentclass[oneside]{book}`也很好，解决了问题，但如果我们只想使用 book.cls 或 article.cls，那么呈现您的粒子会产生很大的不同。

`\let\cleardoublepage\clearpage`因此，对将来会问同样问题的人给予大力支持。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-01-29T17:41:41.220

如果您在 \documentclass 声明中指定选项“openany”，则本书中的每一章（我猜您正在使用 book 类，因为在报告的下一页打开的章节和文章没有章节）将打开一个新页面，不一定是下一个奇数页面。

当然，这不是你想要的。我想你想为附录中的章节设置 openany。'害怕我不知道该怎么做，我怀疑你需要卷起袖子和 TeX 本身搏斗

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-11-24T09:40:28.380

我把`\let\cleardoublepage\clearpage`之前的`\makeindex`. 否则，您的内容页面将根据您清除空白页面之前的页码显示页码。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-08-29T01:05:55.723

One thing I discovered is that using the \include command will often insert and extra blank page. Riffing on the previous trick with the \let command, I inserted \let\include\input near the beginning of the document, and that got rid of most of the excessive blank pages.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-07-17T15:42:57.680

In my case, I still wanted the open on odd pages option but this would produce a blank page with the chapter name in the header. I didn't want the header. And so to avoid this I used this at the end of the chapter:

```
\clearpage

\thispagestyle{plain} 
```

This let's you keep the blank page on the last even page of the chapter but without the header.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-09-22T04:51:39.993

You can also use `\openany`, `\openright` and `\openleft` commands:

```
\documentclass{memoir}
\begin{document}

\openany
\appendix

\openright
\appendixpage
This is the appendix.

\end{document} 
```

# database - 将大列作为实体的一部分时，LINQ 或实体框架是否有任何开销？

> ID：491906
> 
> 赞同：0
> 
> 时间：2009-01-29T14:57:56.090
> 
> 标签：database, linq, performance, entity-framework

假设您有一个包含文章的表格，并且您想要显示它们的列表，不包括实际的文章文本。当您使用 LINQ 或实体框架获取文章对象列表时，是否也有与获取该文本列相关的大量开销？我假设当您开始枚举列表时，文章文本将存储在内存中，直到对象被处理掉。

那么创建一个不包含文本列的中间对象是否有意义？如果是这样，你会怎么做？在 DAL 中创建一个类，允许 ORM 通过设置存储过程或其他过程自动创建一个类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T15:27:46.997

开销并不大（只是通过线路发送数据的成本），但如果您确实不需要数据，请不要返回它。我发现最简单的方法是使用匿名类型：

```
from a in Context.Articles
select new {Name = a.Name, Author = a.Author}; 
```

由于您实际上并没有具体化任何 Article 实例，因此实体框架不需要填写实例的所有属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T15:47:48.733

如果您不需要数据，则绝对应该创建不同的类型。按照惯例，我通常将这种类命名为“nnnInfo”或“nnnListItem”。要在 L2S 中创建 ArticleListItem，只需将表再次拖到 DataContext 设计器中即可。然后将其从“Article1”重命名为“ArticleListItem”并删除不需要的属性（rt 单击、删除）。在 EF 中，该过程将是相似的。正如 Craig 所说，您可以使用匿名类型，但通过创建具体类型，您可以在整个应用程序中重用、通过服务公开等。

第二种方法是手动创建类并编写扩展方法以返回 ArticleListItem：

```
public static IQueryable<ArticleListItem> ToListItems(this IQueryable<Article> articles)
{
 return from a in articles select new ArticleListItem{ Title = a.Title, ...}
} 
```

这将允许您将针对 Article 的任何查询“投射”为 ArticleListItem...

# javascript - 用于 HTTP 基本身份验证的纯 JavaScript 代码？

> ID：491914
> 
> 赞同：59
> 
> 时间：2009-01-29T14:59:20.050
> 
> 标签：javascript, ajax, http, basic-authentication

我在哪里可以找到在纯 JavaScript 中实现 HTTP 基本身份验证客户端的参考代码，适用于 AJAX？

代码的额外点，或指向代码的指针，可以独立于 JS 工具包（如 YUI）使用。Java、Flash/Flex、PHP 框架等不加分。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-29T15:18:33.443

该`XMLHttpRequest.open`方法的五参数版本允许您指定用户名和密码。（[WHATWG 规范](https://xhr.spec.whatwg.org/#the-open()-method)）

```
xhr.open(method, url, async, username, password) 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-01-29T15:10:11.477

[Paul James](http://www.peej.co.uk/)有一篇很好的文章/教程。我前段时间用过它，它对我有用。

[使用 HTML 表单进行 HTTP 身份验证](http://www.peej.co.uk/articles/http-auth-with-html-forms.html)

> [...] XMLHTTPRequest，它可以为我们提交正确的 HTTP 身份验证标头。除了调整表单提交的 URL，我们可以使用 XMLHTTPRequest 在表单提交之前执行请求，提供输入的用户名和密码。
> 
> 这将使用 HTTP 身份验证凭据设置浏览器，因此它还将使用我们实际的表单提交登录请求发送它们。

# python - Unicode (UTF-8) 在 Python 中读取和写入文件

> ID：491921
> 
> 赞同：372
> 
> 时间：2009-01-29T15:01:15.770
> 
> 标签：python, unicode, utf-8, io

我在理解读取文本和将文本写入文件（Python 2.4）方面有些脑残。

```
# The string, which has an a-acute in it.
ss = u'Capit\xe1n'
ss8 = ss.encode('utf8')
repr(ss), repr(ss8) 
```

> ("u'Capit\xe1n'", "'Capit\xc3\xa1n'")

```
print ss, ss8
print >> open('f1','w'), ss8

>>> file('f1').read()
'Capit\xc3\xa1n\n' 
```

所以我在`Capit\xc3\xa1n`我最喜欢的编辑器中输入文件 f2.

然后：

```
>>> open('f1').read()
'Capit\xc3\xa1n\n'
>>> open('f2').read()
'Capit\\xc3\\xa1n\n'
>>> open('f1').read().decode('utf8')
u'Capit\xe1n\n'
>>> open('f2').read().decode('utf8')
u'Capit\\xc3\\xa1n\n' 
```

我在这里不明白什么？显然，我缺少一些重要的魔法（或良好的感觉）。一种输入文本文件以进行正确转换的方法是什么？

我在这里真正无法理解的是 UTF-8 表示的意义是什么，如果你不能真正让 Python 识别它，当它来自外部时。也许我应该只是 JSON 转储字符串，并改用它，因为它有一个 asciiable 表示！更重要的是，当从文件进入时，Python 会识别和解码这个 Unicode 对象的 ASCII 表示吗？如果是这样，我该如何得到它？

```
>>> print simplejson.dumps(ss)
'"Capit\u00e1n"'
>>> print >> file('f3','w'), simplejson.dumps(ss)
>>> simplejson.load(open('f3'))
u'Capit\xe1n' 
```

* * *

## 回答 #1

> 赞同：818
> 
> 时间：2009-05-10T00:45:58.417

我发现在打开文件时指定编码更容易，而不是弄乱编码和解码方法。该[`io`模块](https://docs.python.org/2/library/io.html?highlight=io#io.open)（在 Python 2.6 中添加）提供了一个`io.open`函数，该函数具有一个编码参数。

使用`io`模块中的 open 方法。

```
>>>import io
>>>f = io.open("test", mode="r", encoding="utf-8") 
```

然后在调用 f 的 read() 函数后，返回一个编码的 Unicode 对象。

```
>>>f.read()
u'Capit\xe1l\n\n' 
```

请注意，在 Python 3 中，该`io.open`函数是内置函数的别名`open`。内置的 open 函数仅支持 Python 3 中的 encoding 参数，不支持 Python 2。

**编辑：以前这个答案推荐了[编解码器](https://docs.python.org/3/library/codecs.html)模块。[codecs 模块在混合 和 时可能会导致问题`read()``readline()`](https://stackoverflow.com/a/46438434/101923)，[因此](https://stackoverflow.com/a/46438434/101923)这个答案现在推荐使用[io](https://docs.python.org/3/library/io.html)模块。**

使用编解码器模块中的 open 方法。

```
>>>import codecs
>>>f = codecs.open("test", "r", "utf-8") 
```

然后在调用 f 的 read() 函数后，返回一个编码的 Unicode 对象。

```
>>>f.read()
u'Capit\xe1l\n\n' 
```

如果您知道文件的编码，那么使用 codecs 包就不会那么混乱了。

请参阅[http://docs.python.org/library/codecs.html#codecs.open](http://docs.python.org/library/codecs.html#codecs.open)

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2009-01-29T15:11:59.337

在符号

```
u'Capit\xe1n\n' 
```

"\xe1" 只代表一个字节。"\x" 告诉你 "e1" 是十六进制的。当你写

```
Capit\xc3\xa1n 
```

在你的文件中你有“\xc3”。这些是 4 个字节，在您的代码中您可以全部阅读它们。显示它们时可以看到：

```
>>> open('f2').read()
'Capit\\xc3\\xa1n\n' 
```

您可以看到反斜杠被反斜杠转义。所以你的字符串中有四个字节：“\”、“x”、“c”和“3”。

编辑：

正如其他人在他们的回答中指出的那样，您应该只在编辑器中输入字符，然后您的编辑器应该处理转换为 UTF-8 并保存它。

如果您确实有这种格式的字符串，则可以使用`string_escape`编解码器将其解码为普通字符串：

```
In [15]: print 'Capit\\xc3\\xa1n\n'.decode('string_escape')
Capitán 
```

结果是一个以 UTF-8 编码的字符串，其中重音字符由写入`\\xc3\\xa1`原始字符串的两个字节表示。如果你想要一个 unicode 字符串，你必须用 UTF-8 再次解码。

对您的编辑：您的文件中没有 UTF-8。要实际查看它的外观：

```
s = u'Capit\xe1n\n'
sutf8 = s.encode('UTF-8')
open('utf-8.out', 'w').write(sutf8) 
```

将文件`utf-8.out`内容与您使用编辑器保存的文件内容进行比较。

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2016-02-10T16:03:00.400

现在你在 Python3 中需要的只是`open(Filename, 'r', encoding='utf-8')`

*[在 2016-02-10 上编辑要求澄清]*

Python3 在其 open 函数中添加了**encoding**参数。以下关于 open 函数的信息是从这里收集的：[https ://docs.python.org/3/library/functions.html#open](https://docs.python.org/3/library/functions.html#open)

```
open(file, mode='r', buffering=-1, 
      encoding=None, errors=None, newline=None, 
      closefd=True, opener=None) 
```

> Encoding 是用于对文件进行解码或编码的编码名称。这应该只在文本模式下使用。默认编码取决于平台（无论[locale.getpreferredencoding()](https://docs.python.org/3/library/locale.html#locale.getpreferredencoding) 返回什么），但可以使用 Python 支持的任何[文本编码。](https://docs.python.org/3/glossary.html#term-text-encoding)有关支持的编码列表，请参阅[编解码器模块。](https://docs.python.org/3/library/codecs.html#module-codecs)

因此，通过将`encoding='utf-8'`作为参数添加到 open 函数，文件的读取和写入都以 utf8 的形式完成（这也是现在 Python 中所做的一切的默认编码。）

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2014-08-19T08:09:28.090

实际上，这对我在 Python 3.2 中读取具有 UTF-8 编码的文件很有用：

```
import codecs
f = codecs.open('file_name.txt', 'r', 'UTF-8')
for line in f:
    print(line) 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-01-29T20:01:27.303

所以，我找到了我正在寻找的解决方案，即：

```
print open('f2').read().decode('string-escape').decode("utf-8") 
```

有一些不寻常的编解码器在这里很有用。这种特殊的读取允许人们从 Python 中获取 UTF-8 表示，将它们复制到 ASCII 文件中，然后将它们读入 Unicode。在“字符串转义”解码下，斜线不会加倍。

这允许我想象中的那种往返旅行。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-02-08T20:24:46.897

```
# -*- encoding: utf-8 -*-

# converting a unknown formatting file in utf-8

import codecs
import commands

file_location = "jumper.sub"
file_encoding = commands.getoutput('file -b --mime-encoding %s' % file_location)

file_stream = codecs.open(file_location, 'r', file_encoding)
file_output = codecs.open(file_location+"b", 'w', 'utf-8')

for l in file_stream:
    file_output.write(l)

file_stream.close()
file_output.close() 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2017-06-21T09:37:44.937

除了`codecs.open()`, 可以 使用`io.open()`Python2 或 Python3 来 读 / 写 unicode 文件

**例子**

```
import io

text = u'á'
encoding = 'utf8'

with io.open('data.txt', 'w', encoding=encoding, newline='\n') as fout:
    fout.write(text)

with io.open('data.txt', 'r', encoding=encoding, newline='\n') as fin:
    text2 = fin.read()

assert text == text2 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-01-29T15:13:11.050

好吧，您最喜欢的文本编辑器并没有意识到`\xc3\xa1`应该是字符文字，但它会将它们解释为文本。这就是为什么你在最后一行得到双反斜杠的原因——它现在是`xc3`你文件中真正的反斜杠 + 等等。

如果你想在 Python 中读写编码文件，最好使用[codecs](http://docs.python.org/library/codecs.html#module-codecs)模块。

在终端和应用程序之间粘贴文本很困难，因为您不知道哪个程序会使用哪种编码来解释您的文本。您可以尝试以下方法：

```
>>> s = file("f1").read()
>>> print unicode(s, "Latin-1")
CapitÃ¡n 
```

然后将此字符串粘贴到您的编辑器中，并确保它使用 Latin-1 存储它。在剪贴板不会乱码字符串的假设下，往返应该可以工作。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-01-29T16:54:42.173

您偶然发现了编码的一般问题：如何判断文件是哪种编码？

*答：除非*文件格式提供了这一点，否则您不能这样做。例如，XML 以：

```
<?xml encoding="utf-8"?> 
```

此标头经过精心选择，以便无论编码如何都可以读取。在您的情况下，没有这样的提示，因此您的编辑器和 Python 都不知道发生了什么。因此，您必须使用`codecs`模块并使用`codecs.open(path,mode,encoding)`它提供 Python 中缺少的位。

至于您的编辑器，您必须检查它是否提供了一些设置文件编码的方法。

UTF-8 的重点是能够将 21 位字符 (Unicode) 编码为 8 位数据流（因为这是世界上所有计算机都可以处理的唯一内容）。但由于大多数操作系统早于 Unicode 时代，它们没有合适的工具将编码信息附加到硬盘上的文件中。

下一个问题是 Python 中的表示。[heikogerlach](https://stackoverflow.com/questions/491921/unicode-utf8-reading-and-writing-to-files-in-python/491967#491967)的评论完美地解释了这一点。您必须了解您的控制台只能显示 ASCII。为了显示 Unicode 或任何 >= charcode 128，它必须使用某种转义方法。在您的编辑器中，您不能输入转义的显示字符串，而是输入字符串的含义（在这种情况下，您必须输入变音符号并保存文件）。

也就是说，您可以使用 Python 函数 eval() 将转义字符串转换为字符串：

```
>>> x = eval("'Capit\\xc3\\xa1n\\n'")
>>> x
'Capit\xc3\xa1n\n'
>>> x[5]
'\xc3'
>>> len(x[5])
1 
```

如您所见，字符串“\xc3”已变成单个字符。现在这是一个 8 位字符串，采用 UTF-8 编码。要获取 Unicode：

```
>>> x.decode('utf-8')
u'Capit\xe1n\n' 
```

[Gregg Lind](https://stackoverflow.com/users/15842/gregg-lind)问：我认为这里缺少一些部分：文件 f2 包含：十六进制：

```
0000000: 4361 7069 745c 7863 335c 7861 316e  Capit\xc3\xa1n 
```

`codecs.open('f2','rb', 'utf-8')`，例如，以单独的字符读取它们（预期） 有什么方法可以用 ASCII 写入文件吗？

答：这取决于你的意思。ASCII 不能表示大于 127 的字符。所以你需要某种方式来表示“接下来的几个字符意味着一些特殊的东西”，这就是序列“\x”所做的。它说：接下来的两个字符是单个字符的代码。"\u" 使用四个字符将 Unicode 编码为 0xFFFF (65535) 也是如此。

所以你不能直接将 Unicode 写入 ASCII（因为 ASCII 根本不包含相同的字符）。您可以将其写为字符串转义符（如 f2 中）；在这种情况下，文件可以表示为 ASCII。或者您可以将其编写为 UTF-8，在这种情况下，您需要一个 8 位安全流。

您的解决方案 using`decode('string-escape')`确实有效，但您必须知道您使用了多少内存：使用量的三倍`codecs.open()`。

请记住，文件只是一个 8 位的字节序列。位和字节都没有意义。是你说“65 意味着 'A'”。由于`\xc3\xa1`应该变成“à”但计算机无法知道，因此您必须通过指定写入文件时使用的编码来告诉它。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2014-09-18T14:38:14.433

要读取 Unicode 字符串然后发送到 HTML，我这样做了：

```
fileline.decode("utf-8").encode('ascii', 'xmlcharrefreplace') 
```

对于 python 驱动的 http 服务器很有用。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-29T15:10:26.733

\x.. 序列是 Python 特有的。它不是通用的字节转义序列。

您实际输入 UTF-8 编码的非 ASCII 的方式取决于您的操作系统和/或您的编辑器。[这是您在 Windows 中执行此操作的方法](http://tlt.its.psu.edu/suggestions/international/accents/codealt.html)。要让 OS X 输入带有重音符号的 a，您只需点击*+*`option`，`E`然后`A`，几乎所有 OS X 中的文本编辑器都支持 UTF-8。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-12-08T03:22:48.147

您还可以`open()`通过使用该功能将其替换到位来改进原始功能以处理 Unicode 文件`partial`。这个解决方案的美妙之处在于您不需要更改任何旧代码。它是透明的。

```
import codecs
import functools
open = functools.partial(codecs.open, encoding='utf-8') 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-05-10T12:49:41.953

我试图使用 Python 2.7.9解析[iCal ：](http://en.wikipedia.org/wiki/Calendar_%28application%29)

> 从 icalendar 导入日历

但我得到：

```
 Traceback (most recent call last):
 File "ical.py", line 92, in parse
    print "{}".format(e[attr])
UnicodeEncodeError: 'ascii' codec can't encode character u'\xe1' in position 7: ordinal not in range(128) 
```

它被修复了：

```
print "{}".format(e[attr].encode("utf-8")) 
```

（现在它可以像 böss 一样打印了。）

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2019-12-17T14:49:38.913

通过将整个脚本的默认编码更改为“UTF-8”，我找到了最简单的方法：

```
import sys
reload(sys)
sys.setdefaultencoding('utf8') 
```

any`open`或`print`其他语句将只使用`utf8`.

至少适用于`Python 2.7.9`.

Thx 转到[https://markhneedham.com/blog/2015/05/21/python-unicodeencodeerror-ascii-codec-cant-encode-character-uxfc-in-position-11-ordinal-not-in-range128/](https://markhneedham.com/blog/2015/05/21/python-unicodeencodeerror-ascii-codec-cant-encode-character-uxfc-in-position-11-ordinal-not-in-range128/)（看最后）。

# php - 从 PHP/apache 服务器代码自动收集错误

> ID：491927
> 
> 赞同：1
> 
> 时间：2009-01-29T15:03:14.423
> 
> 标签：php, apache, bug-tracking

从 apache error_log 中捞出东西是很痛苦的。有没有人指出一些更好的错误收集机制。类似于“[使用 FogBUGZ 从用户获取崩溃报告 - 自动！](http://www.fogcreek.com/FogBugz/docs/30/UsingFogBugztoGetCrashRep.html) ”中描述的内容，但对于 PHP/apache webapp

更具体地说，一些机制将 PHP 抛出的错误与某些错误跟踪软件挂钩。也许指向一些库/代码，这些库/代码捕获错误/警告并收集可以输入到错误跟踪软件的数据。具有以下奖励功能：

*   识别重复的错误。
*   如果错误导致多条错误消息，则应将其捕获为一个错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-06T03:15:04.567

您可以指定自己的自定义 PHP 错误处理程序。这是一个简单的例子：

```
function log_error_handler($errno, $str, $file, $line)
{
    switch($errno) {
        case E_USER_ERROR:
            add_log("PHP Error", "Error $errno on line $line in $file: $str", "fatal");
            exit(1);
            break;

        case E_USER_WARNING:
            add_log("PHP Warning", "Warning $errno on line $line in $file: $str", "warning");
            break;

        case E_USER_NOTICE:
            add_log("PHP Notice", "Notice $errno on line $line in $file: $str", "note");
            break;

        default:
//uncomment this next line to catch
//            add_log("PHP", "Unknown error $errno on line $line in $file: $str", "note");
            break;
    }
}
function add_log($code, $message, $type = 'message', $program = null ){
     //do something like email the admin or enter in the data in to the bug tracking software db
}

// ### function to log php errors ####
set_error_handler("log_error_handler"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T18:54:54.457

忽略错误发生的时间，获取错误信息的 md5 哈希。检查该 MD5 哈希是否已在您的错误数据库中。如果没有，请添加它。如果是，也许您想附加这次发生的日期。

> *   如果错误导致多条错误消息，则应将其捕获为一个错误

这很棘手，除非您非常擅长使用该`error_log()`功能。您可以就约定达成一致，例如：

```
error_log('ename:'.$error_name.' emessage:'.$e->toString()); 
```

这样您就可以解析出任何错误并将其分组为相同的`ename`.MD5 和`emessage`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T01:39:27.447

We're using Zend Platform on our servers. It's not free but works very well and does most of what you ask.

It allow your to define events and set triggers. When triggered the entire state of the application is logged. You can browse and filter graphs or lists of event types, mark events as duplicates, view source, etc.

The nicest thing is this: since the entire event is captures you can debug the event with a single click. The state of the application (code, session, variables, cookies, and even uploaded files) is sent to Eclipse and paused. You can then step through the code to see the exact state of the application when the bug occurred. Very useful for root cause analysis. If you want, you can replay the error on a development server, so you don't interfere with production.

# apache-flex - 更改视图状态的最佳做法是什么？

> ID：491929
> 
> 赞同：0
> 
> 时间：2009-01-29T15:03:45.470
> 
> 标签：apache-flex, actionscript, viewstate

我有一个带有两个饼图的组件，它们显示两个特定日期的百分比（想想开始值和结束值）。但是，我有三个视图：仅开始值、仅结束值或显示两者。我正在使用 ToggleButtonBar 来控制显示。改变这种视图状态的最佳实践是什么？现在（因为此代码被继承），视图状态在 ActionScript 函数中更改，该函数根据 ToggleButtonBar 的 selectedIndex 在每个饼图上设置可见和 includeInLayout 属性，但是，这似乎不是最好的方法要做到这一点 - 不是很动态。我希望能够根据 selectedItem 的名称更改状态，以防 ToggleButtons 的顺序发生变化，并且因为我正在存储 selectedItem 的名称以供将来参考。

使用States会更好吗？如果是这样，实现这一点的最佳方法是什么？

谢谢。

当前逻辑：

```
private function pieTypeToggleButtonBar_itemClickHandler():void
{
    // Show/Hide the appropriate Pie Charts based on the user's selection
    switch (pieTypeToggleButtonBar.selectedIndex)
    {
        // "Start Value" is selected
        case 0:
        {
            // Hide the End Value Pie Chart
            endValuePieChartVBox.visible = false;
            endValuePieChartVBox.includeInLayout = false;

            // Show the Start Value Pie Chart
            startValuePieChartVBox.includeInLayout = true;
            startValuePieChartVBox.visible = true;

            break;
        }
        // "End Value" is selected
        case 1:
        {
            // Hide the Start Value Pie Chart
            startValuePieChartVBox.visible = false;
            startValuePieChartVBox.includeInLayout = false;

            // Show the End Value Pie Chart
            endValuePieChartVBox.includeInLayout = true;
            endValuePieChartVBox.visible = true;

            break;
        }
        // "Both" is selected
        case 2:
        {
            // Show the Start Value Pie Chart
            startValuePieChartVBox.includeInLayout = true;
            startValuePieChartVBox.visible = true;

            // Show the End Value Pie Chart
            endValuePieChartVBox.includeInLayout = true;
            endValuePieChartVBox.visible = true;

            break;
        } 
    }
}

<mx:ToggleButtonBar id="pieTypeToggleButtonBar" selectedIndex="1" 
    itemClick="pieTypeToggleButtonBar_itemClickHandler()">
    <mx:Array>
        <mx:Object name="startValue" label="Start Value" />

        <mx:Object name="endValue" label="End Value" />

        <mx:Object name="both" label="Both" />
    </mx:Array>
</mx:ToggleButtonBar> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-29T15:44:11.613

由于 currentState 属性采用一个字符串，该字符串映射到一个状态的 name 属性，因此听起来 using`<mx:states>`在您的情况下会很好用。事实上，我经常使用状态来以您描述的方式在视图之间切换——使用 SetProperty 设置组件（通常是 Canvas 组件或其他类型的容器）的可见和 includeInLayout 属性：

```
<mx:states>
    <mx:State name="View State 1">
        <mx:SetProperty target="{component1}" name="visible" value="true" />
        <mx:SetProperty target="{component2}" name="visible" value="false" />
        <mx:SetProperty target="{component3}" name="visible" value="false" />
        <mx:SetProperty target="{component1}" name="includeInLayout" value="true" />
        <mx:SetProperty target="{component2}" name="includeInLayout" value="false" />
        <mx:SetProperty target="{component3}" name="includeInLayout" value="false" />
    </mx:State>
    <mx:State name="View State 2">
        <mx:SetProperty target="{component1}" name="visible" value="false" />
        <mx:SetProperty target="{component2}" name="visible" value="true" />
        <mx:SetProperty target="{component3}" name="visible" value="false" />
        <mx:SetProperty target="{component1}" name="includeInLayout" value="false" />
        <mx:SetProperty target="{component2}" name="includeInLayout" value="true" />
        <mx:SetProperty target="{component3}" name="includeInLayout" value="false" />
    </mx:State>
    <mx:State name="View State 3">
        <mx:SetProperty target="{component1}" name="visible" value="false" />
        <mx:SetProperty target="{component2}" name="visible" value="false" />
        <mx:SetProperty target="{component3}" name="visible" value="true" />
        <mx:SetProperty target="{component1}" name="includeInLayout" value="false" />
        <mx:SetProperty target="{component2}" name="includeInLayout" value="false" />
        <mx:SetProperty target="{component3}" name="includeInLayout" value="true" />
    </mx:State>
</mx:states>

<mx:Script>
    <![CDATA[

        import mx.binding.utils.BindingUtils;
        import mx.binding.utils.ChangeWatcher;

        private function this_creationComplete(event:Event):void
        {
                // Use BindingUtils.bindSetter to hook into selectedIndex-change events
            var cw:ChangeWatcher = BindingUtils.bindSetter(setState, myBar, "selectedIndex");
        }

        private function setState(index:int):void
        {
            currentState = myBar.getChildren()[index].label;
        }

    ]]>
</mx:Script>

<mx:ToggleButtonBar id="myBar">
    <mx:dataProvider>
        <mx:Array>
            <mx:String>View State 1</mx:String>
            <mx:String>View State 2</mx:String>
            <mx:String>View State 3</mx:String>
        </mx:Array>
    </mx:dataProvider>
</mx:ToggleButtonBar>

<mx:Canvas id="component1">
    <mx:Text text="Component 1" />
</mx:Canvas>

<mx:Canvas id="component2">
    <mx:Text text="Component 2" />
</mx:Canvas>

<mx:Canvas id="component3">
    <mx:Text text="Component 3" />
</mx:Canvas> 
```

...遵循这种一般模式。希望能帮助到你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T15:27:44.453

最简单的方法是使用 ViewStack 组件。这样您只需选择 selectedIndex 并且所有其他面板都将隐藏（注意 ViewStacks 的初始化问题）。

由于过去我在使用 ViewStacks 时遇到的问题，我可能会倾向于使用视图状态作为替代方案。各州都有自己的问题，但对于这个特定问题，它们绝对是可行的。

如果我是你，我会考虑将这些选项中的任何一个作为解决方案，因为创建的功能已经使用标准 api 创建......如果它们符合您的特定需求，请尝试坚持使用 mx 组件，而不是重新发明轮子每时每刻

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T20:46:47.950

在第一个组件中使用状态完全没有抓住重点。您不应该设置可见和 includeInLayout，您应该使用 AddChild 和 RemoveChild 添加和删除组件。使用 visible 和 includeInLayout 来控制屏幕上对​​象的状态是他们意图的混蛋。不幸的是，由于 Flex 没有任何类型的条件逻辑标签，甚至没有用于添加/删除元素的条件属性，人们经常依赖这两个标签。有时这是唯一可行的做法，但在您的情况下或在任何有“switch”语句的情况下，您肯定想要使用状态。

# .net - 分发使用 Entrerprise 库对配置设置进行加密的应用程序

> ID：491930
> 
> 赞同：0
> 
> 时间：2009-01-29T15:04:24.453
> 
> 标签：.net, winforms, deployment, encryption, app-config

我对此有一个想法，但无法找到一个好的解决方案。

我有一个 Windows 应用程序。我使用企业库（3.1）数据访问应用程序块。现在我使用 DataProtectionConfigurationProvider 来加密连接字符串。此应用程序必须部署在多台机器上。我不希望最终用户打开 EntLibConfig.exe 并配置连接字符串。我该怎么做？

谢谢，拉姆吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T15:11:02.567

您应该使用 RsaProtectedConfigurationProvider，因为这允许导出您的密钥容器以安装在另一台机器上。这在 DataProtectionConfigurationProvider 中不受支持。

有关详细信息，请参阅此链接：

[http://msdn.microsoft.com/en-us/library/yxw286t2%28VS.80%29.aspx](http://msdn.microsoft.com/en-us/library/yxw286t2%28VS.80%29.aspx)

# design-patterns - DAO 和 Data Mapper 有什么区别

> ID：491938
> 
> 赞同：4
> 
> 时间：2009-01-29T15:06:00.520
> 
> 标签：design-patterns, data-access-layer, dao, data-mapping

DAO 模式和 Data Mapper 模式有区别吗？DAO 只是做 Data Mapper 的一种吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-29T15:44:23.000

我实际上不会将 DAO 称为“模式”。在我看来，DAO 几乎就是它的本质——“数据访问对象”，它封装了访问持久数据存储的细节，一般来说与数据库无关：

```
interface IBlogDaoService
{
    Blog GetBlog(long id);
    void SaveBlog(Blog blog);
} 
```

很明显，实现可以使用 DB（在这种情况下使用 Data Mapper 非常合乎逻辑）或简单的 XML 文件存储机制。

另一方面，Data Mapper 更像是一种模式，它定义了一个层，负责将内存中的对象图转换为关系结构。

# mysql - 使用 Grails 和 MySQL 时上传的文件 - 数据库 vs 文件系统

> ID：491944
> 
> 赞同：3
> 
> 时间：2009-01-29T15:08:20.110
> 
> 标签：mysql, grails

我知道这是一个“经典问题”，但是 mysql/grails（部署在 Tomcat 上）是否在考虑如何处理用户上传文件的存储方面产生了新的变化。

我喜欢将数据库用于一切（更简单的架构，扩展只是扩展数据库）。但是使用文件系统意味着我们不会用二进制文件来处理 mysql。有些人可能还争辩说 apache (httpd) 在提供二进制文件方面比 Tomcat 更快，尽管我看到的数字实际上表明将 Tomcat 放在您的网站前面可能比使用 apache (httpd) 代理更快。

我应该如何选择放置用户上传文件的位置？

感谢您的考虑、时间和思考。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-29T16:00:55.137

我不知道是否可以对这种决定进行一般性观察，因为这实际上取决于您要做什么以及优先级列表 NFR（例如性能和响应时间）对您的应用程序的影响。

如果您有很多用户，上传大量二进制文件，并且系统为大量上传的二进制文件提供服务，那么您会遇到在数据库中存储文件的成本包括：

*   大尺寸二进制文件
*   昂贵的查询

好处是

*   原子提交
*   扩展随数据库一起提供（尽管使用 MySQL，但使用多节点等存在一些问题）
*   管理文件系统等的繁琐和复杂的代码

鉴于您存储到文件系统的相同用户情况，您需要解决

*   缩放
*   文件名管理（用户上传同名文件两次等）
*   在数据库中创建相应的记录以映射到磁盘上的文件（以及围绕所有这些的代码）
*   照顾您的 apache 配置，以便它们从文件系统提供服务

对于我们的 Grails 站点，我们有一个类似的问题需要解决，其中内容编辑器每天要上传数百张图片。我们知道，当应用程序可以更好地用于其他处理时，通过应用程序驱动所有需求是浪费的（考虑到对页面的预期需求将达到每周数百万，我们绝对不希望图像削弱我们）。

我们最终创建了上传 -> 文件系统解决方案。对于每个上传的文件，都会创建一个 DB 元数据记录并与上传过程一起管理（相反，在生成图像的 GSP 内容链接时读取该记录）。我们根据浏览器请求的链接直接通过 Apache 提供磁盘请求。但是，总是有一个但是，请记住，对于文件系统之类的东西，每台机器只有内容。

我们为确保图像重新同步到每台服务器上而感到头疼，因为与位于集群后面并支持集群行为一致的数据库不同，文件绑定到服务器上的物理位置。

文件系统可能遇到的另一个问题是文件夹内容大小。当您开始拥有包含数以万计文件的文件夹时，操作系统级别的文件夹扫描开始真正拖累。为了避免这个问题，我们必须编写代码来管理图像上传到 yyyy/MM/dd/image.name.jpg 文件夹结构中，这样没有一个文件夹会累积数十万张图像。

我的意思是，虽然我们通过不将数据库用于 BLOB 存储而获得了我们想要的性能，但这是以开发开销和系统管理为代价的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-29T16:24:25.557

就像一个额外的建议：JCR（例如[Jackrabbit](http://jackrabbit.apache.org/)） - Java 内容存储库。当您处理大量二进制内容时，它有几个好处。Grails 插件还不稳定，但您可以将 Jackrabbit 与普通 API 一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T13:46:35.667

要记住的另一件事是，如果您的站点超出了一个应用程序服务器，您需要从所有应用程序服务器访问相同的文件。现在所有应用服务器都可以访问数据库，因为那是单个服务器，或者因为您有一个集群。现在，如果您将内容存储在文件系统中，您也必须共享它——也许是 NFS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-01T02:22:13.077

即使您在文件系统中上传文件，所有文件都获得相同的权限，因此任何登录用户只需输入 url 即可访问任何其他人的文件（因为他们都获得相同的权限）。但是，如果您计划为每个用户提供一个目录，那么将授予他们 apache 的用户权限（即服务器具有的权限）。您应该 su 到 root，创建​​一个用户并将文件上传到这些目录。再次访问这些文件可能最终会将用户组添加到服务器组。如果我选择使用文件系统来存储二进制文件，有没有比这更简单的解决方案，你如何管理对这些文件的访问，对应每个用户，并维护权限？Spring 的 ACL 有帮助吗？还是我们必须为每个用户创建权限组？我对文件系统 url 非常满意。我唯一关心的是启动一个单独的进程（chmod 和其他东西），使用 ProcessBuilder 之类的东西来运行操作系统命令（或者有更好的解决方案吗？）。那么权限呢？

# visual-studio-2008 - 如何在 Visual Studio 2008 中删除项目配置？

> ID：491957
> 
> 赞同：106
> 
> 时间：2009-01-29T15:10:34.143
> 
> 标签：visual-studio-2008

我有一个 Visual Studio 2008 解决方案，其中导入了许多预先存在的项目。这些项目是混合语言示例代码（C#、VB、C++/CLI）。他们目前有多种配置，但我希望每个项目只有一个“调试”配置。

在配置管理器中，我删除了其他配置（例如“Release”），但是当我这样做时，有一条警告消息告诉我它们不会从各个项目中删除。

实际上，当我导航到单个项目时，它仍然具有“发布”和其他配置，即使在解决方案级别只有“调试”。

我怎样才能最好地从每个项目中删除这些额外的配置？我是否忽略了在 GUI 中执行此操作的某种方法，还是应该直接编辑项目文件？

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2009-01-29T15:14:31.390

在配置管理器中，为每个具有您要删除的配置的**项目**（不是通过名为活动解决方案配置的下拉菜单）选择“配置”列中的“编辑...” 。

在弹出的对话框中，标记每个不需要的配置并选择“删除”。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2019-07-24T12:31:38.477

从解决方案的所有项目中自动删除配置的最佳方法是使用 Nuget 控制台命令访问 Visual Studio API。

转到***工具***、***Nuget 包管理器***、***包管理器控制台***。

从那里使用：

```
Get-Project -All | Foreach { $_.ConfigurationManager.DeleteConfigurationRow("Release") } 
```

通过这种方式，您已经从所有名为`"Release"`. 我强烈建议您始终检查源代码版本控制系统的差异，您只会看到受影响的文件`csproj`，在某些情况下`sln`，如果您使用配置转换（如 Web.Release.config），它们仍然会存在。

更多信息可在[此处的 Visual Studio 版本特定 api 文档](https://docs.microsoft.com/en-us/dotnet/api/envdte.configurationmanager.deleteconfigurationrow?view=visualstudiosdk-2017)中获得，这至少适用于 C++、C#、F#、VB 语言的 VS 2015。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-01-18T20:38:56.433

为了帮助说明 timbo 的答案，这就是他所说的。像一些评论者一样，我花了一段时间才找到这个。

[![在此处输入图像描述](https://i.stack.imgur.com/5g9ZE.jpg)](https://i.stack.imgur.com/5g9ZE.jpg)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-10-20T22:03:05.147

不回答我知道的这个特定问题，但是使用 VS2013，您可以打开 Property Manager 选项卡，展开所有项目配置，使用 CTRL 或 SHIFT 键进行多项选择，并一次从多个项目中删除配置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-14T20:05:16.760

在 VS2017/VS2019 中，如果您下拉“活动解决方案配置”，那里有一个 <edit> 可以让您从所有项目中删除配置。

[显示 <edit> 的屏幕截图](https://i.stack.imgur.com/pLhRA.png)

# wpf - 从网格中拖动窗口

> ID：491970
> 
> 赞同：0
> 
> 时间：2009-01-29T15:12:23.220
> 
> 标签：wpf, drag

我创建了一个自定义窗口，设置为 windowStyle="none"，（无标题或最大化 - 最小化按钮），当用户在网格上单击并拖动时，我试图实现 DragMove 操作。（这是通过在 MouseLeftButtonDown 处理程序上调用 DragMove 来连接的）

如果网格没有背景，则此事件永远不会被触发的第一个奇怪问题。添加一些背景颜色确实会使事件被触发，但在第一次拖动后我得到这个错误：

“只能在鼠标主按钮按下时调用 DragMove”

代码片段：

```
Private Sub Grid1_MouseLeftButtonDown(ByVal sender As System.Object, ByVal e As System.Windows.Input.MouseButtonEventArgs) Handles Grid1.MouseLeftButtonDown
    DragMove()
End Sub 
```

我知道这适用于标签，但没有办法让它适用于网格吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T13:42:38.720

好的，我找到了答案。。

我使用边框包裹网格，然后捕获 Border1_MouseLeftButtonDown 事件。

我还必须将边框背景设置为“透明”，现在一切都像魅力一样。

```
Private Sub Border1_MouseLeftButtonDown(ByVal sender As System.Object, ByVal e As System.Windows.Input.MouseButtonEventArgs) Handles Border1.MouseLeftButtonDown
    DragMove()
End Sub 
```

# programming-languages - 哪种编程语言最像自然语言？

> ID：491971
> 
> 赞同：60
> 
> 时间：2009-01-29T15:12:39.117
> 
> 标签：programming-languages, nlp

我从许多我不明白这个人在说什么以及其他人不理解我的情况下得到了这个问题的想法。

所以，一个“聪明”的解决方案是说一种计算机语言。:)

我很感兴趣编程语言可以走多远接近（英语）自然语言。当我说近时，我的意思不仅仅是使用单词和句子，而是能够“做”自然语言可以“做”的事情，“做”是指它可以被使用（以非常有限的方式）作为自然语言的替代品。

我知道这是不可能的（是吗？），但我认为这可能很有趣。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-01-29T16:35:32.350

有一种称为 Inform 的编程语言，在其最新版本 Inform 7 中，看起来*很像*自然语言……尤其是书面语言。

Inform 非常专门用于创建文本冒险游戏，但没有内在的原因不能将这些概念扩展到其他领域。

这是一小段 Inform 7 代码，取自 Emily Short 的 Glass 游戏。

```
Stage is a room. 

The old lady is a woman in the Stage. Understand "mother" or 
"stepmother" as the old lady. The old lady is active. The description 
of the lady is "She looks plucked: thin neck with folds of skin
exposed, nose beaky, lips white. Perhaps when her fortunes are mended
her cosmetics too will improve." 

The Prince is a man in the Stage. The description of the prince is
"He's tolerably attractive, in his flightless way. It's hard not to
pity him a little." The prince carries a glass slipper. The glass
slipper is wearable. Understand "shoe" or "heel" or "toe" or "foot"
as the slipper. The description of the slipper is "It is very small
for an adult woman's foot." 
```

完整的代码可以在[这里](http://www.inform-fiction.org/I7Downloads/Examples/glass/source.html)找到。

这是一个简单的小例子……它实际上可以处理一组令人惊讶的强大想法。

应该指出的是，代码实际上并不是一个奇怪的密码，其中结构具有隐藏的含义……这段代码或多或少地做了你所期望的。例如：

```
The old lady is a woman in the Stage. Understand "mother" or 
"stepmother" as the old lady. 
```

创建一个碰巧是女性的对象，将该对象命名为“老妇人”，并将该对象放置在称为“舞台”的房间对象中。然后创建了两个别名（“mother”和“stepmother”），它们都引用了“old lady”对象。

当然，随着示例变得越来越复杂，跳过的必要环节也变得更加复杂。就其本质而言，英语是模棱两可的，而计算机代码则绝对不是。所以我们永远不会得到“完美的婚姻”。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-01-29T15:14:55.150

取决于你在什么圈子里滚，但[LOLCODE](http://lolcode.com/)可以被认为是自然语言；）

示例循环：

```
HAI
    CAN HAS STDIO?
    I HAS A VAR
    IM IN YR LOOP
        UP VAR!!1
        VISIBLE VAR
        IZ VAR BIGGER THAN 10? KTHXBYE
    IM OUTTA YR LOOP
KTHXBYE 
```

严肃地说，VB 是一种非常自然的语言。非程序员类型很容易学习，因此语法必须非常容易理解。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-01-29T15:18:39.853

Richard Pryor 在《超人 III》中用来转移数百万美元的语言非常接近：

```
> TRANSFER $1,000,000 DOLLARS TO WEBSTER'S ACCOUNT.... NOW 
```

;-)

编辑：字符更正;-)

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-01-29T15:17:17.797

COBOL 读起来很像英语

```
000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.     HELLOWORLD.
000300
000400*
000500 ENVIRONMENT DIVISION.
000600 CONFIGURATION SECTION.
000700 SOURCE-COMPUTER. RM-COBOL.
000800 OBJECT-COMPUTER. RM-COBOL.
000900
001000 DATA DIVISION.
001100 FILE SECTION.
001200
100000 PROCEDURE DIVISION.
100100
100200 MAIN-LOGIC SECTION.
100300 BEGIN.
100400     DISPLAY " " LINE 1 POSITION 1 ERASE EOS.
100500     DISPLAY "Hello world!" LINE 15 POSITION 10.
100600     STOP RUN.
100700 MAIN-LOGIC-EXIT.
100800     EXIT. 
```

[来源](http://www.engin.umd.umich.edu/CIS/course.des/cis400/cobol/hworld.html)

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2009-01-29T16:50:39.403

Lisp（当然（如果你知道我的意思（LOL）））

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2009-01-29T15:19:23.580

Good 'ol [AppleScript](http://en.wikipedia.org/wiki/AppleScript)将其与英语的相似性吹捧为它的优势之一。但是，使用它并不是很有趣。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2009-01-29T15:23:34.150

如果您是鉴赏家，[莎士比亚编程语言](http://shakespearelang.sourceforge.net/report/shakespeare/shakespeare.html)是相当自然的；）

但是，您在编程中的“自然”程度是有限度的。人类语言对解释过于开放 - 编程语言需要具体和精确，我认为这与拥有“自然”编程语言不太吻合。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2009-01-29T15:36:59.660

HyperTalk - Apple HyperCard 背后的语言。

```
 on mouseUp
   put "100,100" into pos
   repeat with x = 1 to the number of card buttons
     set the location of card button x to pos
     add 15 to item 1 of pos
   end repeat
 end mouseUp 
```

[维基百科上的 HyperTalk](http://en.wikipedia.org/wiki/HyperTalk)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-01-29T15:38:37.473

我不知道我会说 VB.NET 接近英语，但我认为它与你*真正*得到的差不多。当然，一旦你对它进行了一段时间的编程，它看起来就像是英语——对于经验丰富的 VB 程序员来说，它*确实*读起来就像一本书，但是如果你停下来想想现实世界的英语：

```
For i As Integer = 1 To 10
  Console.WriteLine("Hello World")
Next 
```

距离：

> 编写“Hello World”并移动到控制台的下一行 10 次。

当然，英语是模棱两可的——它是想让你把整个事情做 10 次，还是只写一次“Hello World”然后移动到下一行 10 次？

我想我们需要学会用不那么模棱两可的方式说话：

> 这样做 10 次：在控制台中，编写“Hello World”并移至下一行。

但我非常怀疑是否存在一种*真正*读起来像英语的编程语言。即使是那些说它就像自然语言的 Cobol 狂热者——如果你停下来思考一下你如何以*真实的*方式而不是按照编程语言定义的方式思考事物，那真的不是。

即使在 VB 中，您也仅限于框架决定您做事方式的方式......

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-01-29T16:47:15.010

好吧，当然是[简单的英语](https://www.osmosian.com/)！

```
To sing the beer song:
  Put 99 into a number.
  Loop.
  If the number is 0, break.
  Format a string given the number and "bottle" and "bottles".
  Write the string then " of beer on the wall, " then the string then " of beer.".
  Format another string given the number minus 1 and "bottle" and "bottles".
  Write "Take one down and pass it around, " then the other string then " of beer on the wall.".
  Skip a line.
  Subtract 1 from the number.
  Repeat.
  Write "No more bottles of beer on the wall, no more bottles of beer.".
  Write "Go to the store and buy some more, 99 bottles of beer on the wall.".

To format a string given a number and a singular string and a plural string:
  If the number is 0, put "no more " then the plural into the string; exit.
  If the number is 1, put "1 " then the singular into the string; exit.
  Put the number then " " then the plural into the string. 
```

我实际上并没有使用过这个 - 我在[这里](http://99-bottles-of-beer.net/language-plain-english-1056.html)找到了它。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2009-01-29T17:10:52.997

Perl 有一些基于人类如何处理自然语言的设计原则（参见[http://www.wall.org/~larry/natural.html](http://www.wall.org/~larry/natural.html)）。

这与使用句法技巧使代码读起来像英语或其他语言的句子是不同的。我不完全相信这些是有用的。打个比方，我也可以用我的代码制作 ASCII 艺术，但这并不意味着我的语言是基于视觉合成原则的。

举一个它可能没有用的例子，假设它在某些 ruby​​ish/smalltalky 语言中看起来像它所做的那样：

```
3.times say "hello!" 
```

这很好，它使我的代码更具可读性，并且它的乐趣与拥有一只会说话的鹦鹉相似，但只有在我了解计算机语言的基本规则时才有用。它恰好看起来像英语这一事实并没有给我额外的影响力或洞察力。我无法使用大脑中的英语语法处理引擎来生成如下句子：

```
// The dot looks like misplaced punctuation 
// in the "English" above, but it's essential in 
// the computer language
3 times say "hello!" // syntax error

// In a natural language, a reordering might make
// sense, but it's impossible here because the word
// order was essential to carrying the parameters
// to the method invocation in the right order.
say "hello" 3 times // syntax error 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2011-01-19T10:51:49.587

**[gherkin](https://github.com/cucumber/cucumber/wiki/Gherkin)**是一种领域特定语言，用于描述可执行[的 bdd](http://dannorth.net/whats-in-a-story/)规范。它被[黄瓜](https://github.com/cucumber/cucumber/wiki/)（ruby）和[specflow](http://specflow.org/specflow/getting-started.aspx)（dotnet）使用。

例子

```
 Feature: Browsing
        In order to see who's been on the site
        As a user
        I want to be able to view the list of posts

    Scenario: Navigation to homepage
        When I navigate to /Guestbook
        Then I should be on the guestbook page

    Scenario: Viewing existing entries
        Given I am on the guestbook page
        Then I should see a list of guestbook entries
            And guestbook entries have an author
            And guestbook entries have a posted date
            And guestbook entries have a comment

    Scenario: Most recent entries are displayed first
        Given we have the following existing entries
            | Name      | Comment      | Posted date       |
            | Mr. A     | I like A     | 2008-10-01 09:20  |
            | Mrs. B    | I like B     | 2010-03-05 02:15  |
            | Dr. C     | I like C     | 2010-02-20 12:21  |
          And I am on the guestbook page
        Then the guestbook entries includes the following, in this order
            | Name      | Comment      | Posted date       |
            | Mrs. B    | I like B     | 2010-03-05 02:15  |
            | Dr. C     | I like C     | 2010-02-20 12:21  |
            | Mr. A     | I like A     | 2008-10-01 09:20  | 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-01-29T15:16:33.307

好吧，Ruby 和 Python 应该是相当接近的。Ruby 甚至会添加模拟现实生活的特殊关键字。如除非关键字等。

当然，如果你用这两种语言中的任何一种输入真正的代码，它并不像自然语言，但又是什么？

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2009-01-29T15:18:22.443

我会说 SQL 或 COBOL。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2009-01-29T15:17:31.400

VB.NET 的语法非常接近英语

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2009-01-29T18:29:03.777

Forth 是基于反向波兰语的，并且对某些人自然有效。

“我会尽快学习”——尤达。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-01-29T15:15:29.253

嗯，自然语言是模棱两可的，需要比文字线性阅读更多的东西来理解。但这是理所当然的，VB.NET 在某些结构上已经接近了。我见过的最近的。

VB.NET 中的 For 循环

```
For i = 0 To 2
  'loop time!
Next i 
```

它就像我所看到的那样“自然”，而且不太冗长。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2009-01-29T15:20:30.427

这就是所谓的“伪代码”。您使用任何必要的方式来传达代码的意图（您已经编写或稍后将编写）。

任何编程语言都有一些外人无法理解的特性。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2010-01-14T05:41:24.657

虽然不完全符合您的要求，但有些语言可以完成您想要*的，但从另一个方向。* [例如， Lojban](http://en.wikipedia.org/wiki/Lojban)是一种用作自然语言的语言，但没有歧义。

> Lojban（发音为 [ˈloʒban]）是一种基于谓词逻辑的结构化、句法明确的人类语言。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-01-29T15:19:10.727

Applescript 看起来像自然语言。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-01-29T16:51:19.823

我相信威廉莎士比亚是世界上最好的程序员......

[莎士比亚编程语言](http://shakespearelang.sourceforge.net/report/shakespeare/shakespeare.html)

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2010-01-14T06:35:45.880

我相信你的问题是基于一个谬误。编程主要不是关于从人类语言到计算机语言的翻译。理解技术问题和设计程序很困难，输入代码只是一小部分。学习编程语言不会使某人成为程序员，就像学习乐谱不会使他们成为作曲家一样。

也就是说，如果你用几乎任何语言编写足够高的水平并花几分钟解释语法，你就可以将一段代码的要点传达给专门的非程序员。相反，足够精确的自然语言规范有时可以翻译成高级函数（尽管人们很少愿意付出努力来编写这样的规范。）

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-01-29T15:17:18.513

COBOL 的创建具有类似于自然语言（在本例中为英语）的特定意图

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-01-29T15:39:50.513

使用 Ruby 和 Oslo（可能还有 F#），您可以构建对语言非常友好的 DSL。这至少是奥斯陆的承诺。[您可以在此处](http://www.claudioperrone.com/blog/articles/2008/11/09/misbehave-01-oslos-mgrammar-for-bdd-executable-specifications/)找到 BDD 的 Oslo 语法示例。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-03-08T17:13:30.720

梵文接近你所描述的。它没有冗余，它是第一种遵循 BNF 的语言，这是所有现代 prog 的基础。语言语法，它与英语有共同的印欧血统

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-01-29T15:18:52.333

Cobol 与英语很接近

我相信Logo离英文也不会太远

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-01-29T15:22:37.723

我希望有一种**面向**商业的面向商业的**语言，****读起来**像**英语**，这样每个人，即使是非程序员也能理解它……也许我们应该创造一个！（[从这里偷来的](http://thedailywtf.com/Articles/Soft_Coding.aspx)）

 ******* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-01-29T16:05:30.337

我们通常所说的“伪代码”非常非常接近[Pascal](http://en.wikipedia.org/wiki/Pascal_(programming_language))。这可能不会使它特别接近自然英语，但如果它不比大多数语言简单，我们根本不会编写伪代码（我们只会编写代码）。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2010-01-23T11:20:02.067

我想到了埃菲尔。[从这里](http://www.eiffel.com/executives/case_studies/xontech/study1.html)引用：

> Eiffel Software 的首席软件工程师 Raphael Simon 表示，这种语言的设计目的是让人们可以使用自然语言来编写程序。

例如，参见[99 瓶啤酒](http://www.99-bottles-of-beer.net/language-eiffel-2259.html)计划。

我不会说这是“最”自然的，但我觉得它很自然。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2010-08-05T17:34:14.583

对我来说，它是 Python。

YMMV

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2009-08-29T03:12:46.667

我建议[Lua](http://lua.org)。示例代码：

```
function modulus(num, mod)
    return num % mod
end
for i = 1, 1000 do
    local done = false
    if modulus(i, 3) == 0 then
        print("Fizz")
    else if modulus(i, 5) == 0 then
        done = true
        print("Buzz")
    end
    if modulus(i, 5) == 0 and not done then
        print("Buzz")
    end
    print(" ")
end 
```

不是最像英语的，但即使我自己这么说也非常可读！

* * *

## 回答 #32

> 赞同：-2
> 
> 时间：2011-01-19T10:08:36.373

当然，它还必须具有生成概念然后“命名”这些概念的能力，因此这些可以用来表达更复杂的构造，即基本上必须对世界的本体有某种支持，它是应该被使用。我认为如果像之前的帖子中描述的“通知”语言，再加上一些后端概念网络或本体数据库，将是一个很好的开始方式。

* * *

## 回答 #33

> 赞同：-3
> 
> 时间：2010-02-09T10:17:02.320

自然语言因其不一致的语法而臭名昭著。任何自然语言中最一致的语法是梵语。事实上，这种语言的结构是如此稳固，以至于有可能拥有一个基于发音的突出搜索引擎。唉，这种语言或多或少已经死了。

# c++ - 通过引用让孩子访问父母的成员 - 可以吗？

> ID：491972
> 
> 赞同：0
> 
> 时间：2009-01-29T15:12:41.177
> 
> 标签：c++, class, class-design, pass-by-reference

C++ 新手问题。请确认我做对了。

我有一个全球应用程序类产生它的小孩，我需要让孩子们访问一些应用程序设施。所以我决定通过参考将它们传递给孩子们。

我测试了这个想法，如下所示。它似乎工作正常。我只是想确保我没有做危险的事情。可能有什么我忽略的陷阱吗？

*爸爸创造了孩子并给了他们他的车钥匙：*

```
#include <iostream>
using namespace std;

class CCarKeys
{
    public:
        CCarKeys(const string& Name) : _Name(Name) {}
        string _Name;
};

class CChild
{
    public:
        CChild(CCarKeys& CarKeys) : _Name("Child"), _CarKeys(CarKeys) {}
        string _Name;
        CCarKeys& _CarKeys;
        void TestHasKeys() {cout << "I got " << _CarKeys._Name << endl;}
};

class CDad
{
    public:
        CDad() : _Name("Dad"), _HondaCarKeys("Honda keys"), _ChevyCarKeys("Chevy keys") {}
        string _Name;
        CCarKeys _HondaCarKeys;
        CCarKeys _ChevyCarKeys;
        CChild *_Boy;
        CChild *_Girl;
        void MakeBoy() {_Boy= new CChild(_HondaCarKeys);}
        void MakeGirl() {_Girl= new CChild(_ChevyCarKeys);}
};

int main ()
{
    CDad Dad;

    Dad.MakeBoy();
    Dad.MakeGirl();
    Dad._Boy->TestHasKeys();
    Dad._Girl->TestHasKeys();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T15:18:45.190

对我来说看起来不错（如果他们只需要钥匙的话）。他们可能需要爸爸提供的一些其他服务，这些服务稍后会要求 - 例如：

```
Wallet += MyDad.GasMoney(REQUEST_MAX_AND_PROMISE_TO_BE_HOME_BY_10PM) ; 
```

但是他们没有提到爸爸，所以他们不能这样做。所以我也会让 CChild 构造函数`this`引用。

```
class ICashProvider {
public:
  virtual money Request(IPerson,CashRequestFlags) ;
};

class IChaffeur {
public:
  virtual void Drive(IPerson[]) ;
}; 
```

等等

然后`CChild`构造函数需要采用`ICashProvider`and `IChaffeur`，就像`CWife`and `CGirlfriend`(and `CBoyfriend`，也许)一样。在这一点上，我想你可能会意识到，面对`Dad`'s 的职责，这种粒度级别毫无意义，你只是通过强制调用者在某些方法上发送他们自己的方法来给每个人`this`并验证请求，所以你没有执行乱伦或换尿布。`Dad``this``Dad``CWife`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-29T15:23:28.190

通过引用传递与通过指针传递完全一样，除了语义和如果通过引用传递的话，你不能对指针本身做任何事情。

你的代码没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T15:30:03.823

在您的特定情况下，车钥匙不太可能永久授予，而是根据需要请求并根据请求授予。所以更多的是

```
class Dad
{
   /** may return NULL if no keys granted */
   CarKeys *requestKeys(CChild forChild);
} 
```

在主应用程序类和子应用程序的更一般情况下，如何在 main() 中创建应用程序和子应用程序共享的数据对象，并将引用传递给每个人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T15:41:00.323

这是可能的，并且在您的代码中它不会造成伤害。但这很危险，因为如果您复制 CDad，则键和指针将被复制。但是，指针将指向的对象以及这些对象中的引用将保持不变。如果原始 CDad 对象超出范围，则指针引用的对象中的引用悬空，不再引用有效对象。

也许您可以反转生命周期：在堆上创建键，并将孩子作为班级中的普通成员。因此，如果您复制爸爸，则复制孩子，但不会复制钥匙。我认为密钥是不可变的，因此您可以在多个孩子之间共享同一个密钥。

这带来了另一点：如果您的密钥相当小（阅读：不是很大）并且不可变（因此，如果您更改一个密钥而不是其他密钥，则不会出现更新异常），请考虑*不要*在堆上创建它 -所以它们也会被自动复制，并在孩子需要钥匙时传递给他们。您可以让它们成为孩子们的正常指针，但我认为这很丑陋，因为孩子不*包含*密钥 - 但使用它。所以指针/引用或函数参数很适合，但不是“真实”数据成员。

*如果*你要使用共享密钥和堆上的密钥，你应该使用智能指针——因为你必须跟踪所有的孩子和爸爸。如果最后一个孩子/爸爸超出范围，您必须再次删除密钥。您`boost::shared_ptr`为此使用：

```
class CCarKeys
{
    public:
        CCarKeys(const string& Name) : _Name(Name) {}
        string _Name;
};

class CChild
{
    public:
        CChild(boost::shared_ptr<CCarKeys> const& CarKeys) 
            : _Name("Child"), _CarKeys(CarKeys) {}
        string _Name;
        boost::shared_ptr<CCarKeys> _CarKeys;
        void TestHasKeys() {cout << "I got " << _CarKeys._Name << endl;}
};

class CDad
{
    public:
        // NOTE: null the kid pointers *if* you use raw pointers, so you can check whether
        // a boy or girl is present. Without nulling them explicitly, they have 
        // indeterminate values. Beware. shared_ptr's however will automatically
        // initialized to default "null" values
        CDad() : 
            _Name("Dad"), 
            _HondaCarKeys(new CCarKeys("Honda keys")), 
            _ChevyCarKeys(new CCarKeys("Chevy keys")) {}
        string _Name;

        boost::shared_ptr<CCarKeys> _HondaCarKeys;
        boost::shared_ptr<CCarKeys> _ChevyCarKeys;

        // also use shared_ptr for the kids. try to avoid raw pointers. 
        boost::shared_ptr<CChild> _Boy;
        boost::shared_otr<CChild> _Girl;

        void MakeBoy() {_Boy.reset(new CChild(_HondaCarKeys));}
        void MakeGirl() {_Girl.reset(new CChild(_ChevyCarKeys));}
};

// main can be used unchanged 
```

当然，您可以通过使 CDad 类不可复制来避免所有这些复杂性。然后你可以使用你原来的解决方案，只是让孩子们使用 shared_ptr 并使孩子们也不可复制。理想情况下，应该使用非共享指针，例如`auto_ptr`，但是 auto_ptr 也有一些陷阱，shared_ptr 都避免了：

```
class CCarKeys
{
    public:
        CCarKeys(const string& Name) : _Name(Name) {}
        string _Name;
};

class CChild
{
    public:
        CChild (CCarKeys& CarKeys) 
            : _Name("Child"), _CarKeys(CarKeys) {}
        string _Name;
        CCarKeys &_CarKeys;
        void TestHasKeys() {cout << "I got " << _CarKeys._Name << endl;}
    private:
        CChild(CChild const&); // non-copyable
        CChild & operator=(CChild const&); // non-assignable
};

class CDad
{
    public:
        CDad() : 
            _Name("Dad"), 
            _HondaCarKeys("Honda keys"), 
            _ChevyCarKeys("Chevy keys") {}
        string _Name;

        CCarKeys _HondaCarKeys;
        CCarKeys _ChevyCarKeys;

        // also use shared_ptr for the kids. try to avoid raw pointers. 
        boost::shared_ptr<CChild> _Boy;
        boost::shared_otr<CChild> _Girl;

        void MakeBoy() {_Boy.reset(new CChild(_HondaCarKeys));}
        void MakeGirl() {_Girl.reset(new CChild(_ChevyCarKeys));}
private:
    CDad(CDad const&); // non-copyable
    CDad & operator=(CDad const&); // non-assignable
}; 
```

如果我必须实现这样的类层次结构，我会采用该解决方案，或者只是将键作为成员删除，并在需要时将它们传递/创建给孩子。关于您的代码的其他一些说明：

*   最好从成员中删除“_”或将它们放在末尾或使用其他符号。以下划线开头后跟大写字母的名称由 C++ 实现（编译器、C++ 标准库 ...）保留。
*   我个人觉得让成员名称和变量以大写字母开头令人困惑。我只是很少看到它。但这没什么好在意的，这只是个人风格。
*   有一条著名的规则（[零一无穷](http://en.wikipedia.org/wiki/Zero_One_Infinity)）规定，当你得到两件东西时，你通常应该能够拥有任意多件东西。所以如果你可以生两个孩子——为什么不生很多呢？两个似乎是一个任意的选择。但在你的情况下它可能有一个很好的理由 - 所以在你的情况下它是有意义的，请忽略这一点。

# command-line - 如何通过 BCB5 的命令行将类型库安装到 activex 调色板？

> ID：491973
> 
> 赞同：0
> 
> 时间：2009-01-29T15:13:08.960
> 
> 标签：command-line, c++builder

我可以通过 tlibimp.exe 导入类型库，但是当我打开 IDE 时，这些库不在 activex 托盘中。我似乎也不知道如何让它安装到特定的包中。在 IDE 中，“导入类型库”对话框中有一个安装按钮。如何在命令行中执行此操作？

当我在 CBuilder5\Imports 文件夹中查看由 tlibimp 生成的 OCX.cpp 文件时，我看到“错误：创建 (TTVBH3D) 的调色板位图时出错：没有为此 CoClass 注册服务器”。这与问题有关吗？

* * *

### 编辑：

我希望能够在不通过 IDE 的情况下将组件安装到 activex 调色板，以便在构建期间可以自动化该过程。任何解决方案都必须能够完全自动化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-29T15:33:43.317

根据 tlibimp.exe 的参数选项，有一个 -Ha+ 参数将“为控件生成 IDE 组件包装器”。

还有一个 -Hr+ 为组件包装器生成 IDE 注册。

提供这些参数中的任何一个有什么不同吗？

由此不确定您是否必须使用生成的注册码安装组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T20:15:23.080

首先，使用您要安装的 ocx\dll 运行 tlibimp.exe（位于 Program Files\Borland\C++Builder\Bin 下）。

其次，找到tlibimp生成的cpp文件（可以用tlibimp指定输出路径），在文件底部找到字符串“Servers”，将其替换为“ActiveX”。此字符串确定要安装到的调色板。我不确定这是否可以用 tlibimp 指定，但它看起来不像。

接下来，编译包含类型 library\activex 组件的包。

最后，向注册表添加一个键。密钥位于 HKCU\Software\Borland\C++Builder\5.0\Knownpackages 下。键的名称应该是您刚刚编译的包的路径（例如，$(BCB)\Bin\applet50.bpl）。

打开 BCB 后，您将看到 activex 调色板下的组件。

这是我能找到的唯一可以自动化的方法。

# sql - 休眠和 ID

> ID：491990
> 
> 赞同：1
> 
> 时间：2009-01-29T15:16:14.803
> 
> 标签：sql, hibernate, jpa

在hibernate中是否有可能拥有一个分配了一些ID并生成一些ID的实体？

例如：

有些对象的 ID 介于 1-10000 之间，是在数据库之外生成的；而有些实体没有 ID，需要数据库生成的 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T15:24:35.053

我会避免这种情况，而只是为有关对象来源的信息提供一个辅助列，并为外部标识符提供一个列（假设外部标识符是您想要跟踪的重要值）。

将列用于混合目的通常是一个坏主意 - 在这种情况下，从代理键的性质推断对象的来源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T15:31:52.387

您可以使用“已分配”作为 ID 生成策略，但在将实体保存到数据库之前，您必须为其提供 ID。或者，您可以构建自己的 org.hibernate.id.IdentifierGenerator 实现，以按照您建议的方式提供 Id。

不过，我必须同意 Cade Roux，这样做似乎比使用内置增量、uuid 或其他形式的 id 生成要困难得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-29T16:44:55.000

使用任何你喜欢的生成器，确保它可以从一个偏移量开始（当你使用一个序列时，你可以相应地初始化它）。

对于所有其他实体，请在插入之前调用 setId()。如果 id 属性为 0，Hibernate 只会生成一个 id。请注意，您应该首先将具有 id 的对象插入到数据库中，然后再使用它们。Hibernate 中有很多代码在 id != 0 时期望对象在数据库中。

另一种解决方案是对带有 id 的实体使用负 id。这也将确保在您插入新对象时不会发生冲突。

# c++ - 是否可以将模板实例视为命名空间？

> ID：491994
> 
> 赞同：1
> 
> 时间：2009-01-29T15:17:10.810
> 
> 标签：c++, templates, namespaces, using

假设我有

```
 template< unsigned int num >
 class SomeFunctionality
 {
     static unsigned int DoSomething()
     {
         //...
     }

     static void DoSomethingElse()
     {
     }
 };

 typedef SomeFunctionality<6> SomeFunctionalityFor6; 
```

从语义上讲，“SomeFunctionalityFor6”本质上是一个特定于模板参数的命名空间，6。所以在代码中使用模板的这个实例而不是做

```
 int main()
 {
       SomeFunctionalityFor6::DoSomething();
 } 
```

我宁愿能够使用“使用”语句，也就是真正的命名空间

```
 int main()
 {
       using SomeFunctionalityFor6;
       DoSomething();
 } 
```

正如我所怀疑的那样，这不起作用。Visual Studio 抱怨它想要一个由“命名空间”关键字定义的命名空间，跟在任何 using 语句之后。

反正有什么我想做的吗？主要是我不想每次调用静态方法时都完全限定命名空间。我知道它主要只是语法糖，但在我看来，它可以使代码更具可读性。我想知道是否有办法直接对命名空间进行模板化，而不必使用“class”关键字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T15:34:44.377

你不能那样做。既不模板化命名空间，也不使用 class_name。

代码中唯一可以在没有限定的情况下使用类中的静态函数的地方是派生类。

在您的情况下，我会使用 typedef 作为一些短名称，例如

```
int main()
{
       typedef SomeFunctionalityFor6 SF6;
       SF6::DoSomething();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T15:43:11.333

或者你可以只创建一个本地对象......

```
int main()
{
  SomeFunctionalityFor6  SF6;
  SF6.DoSomething();
} 
```

您可以随意替换/更改*SF6*对象。

# instruments - 分析仪器读数

> ID：491997
> 
> 赞同：1
> 
> 时间：2009-01-29T15:17:27.657
> 
> 标签：instruments

**`Leaks:`**

```
None 
```

**`ObjectAlloc:`**

```
Net Bytes: 4,332,512
# Net: 26,696
Overall Bytes: 103,769,552
# Overall: 738,987 
```

**`Activity Monitor (MyApp):`**

```
# Thread: 6
Real Memory: 63.65 MB
Virtual Memory: 209.45 MB 
```

内存监视器显示与活动监视器相同的读数。我不知道这些读数是好是坏。活动监视器显示的内存令人恐惧。我应该担心吗？一旦应用程序移动到设备，我可以以某种方式估计应用程序使用的内存吗？真正的运行时内存？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-29T15:22:45.633

至少根据我的经验，Object Allocation 报告的内存使用情况并不是非常具有权威性。真正的交易是内存监视器报告的实际内存消耗，请参阅[我关于 iPhone 内存消耗的问题](https://stackoverflow.com/questions/363493/understanding-the-memory-consumption-on-iphone)。您的数字似乎是在模拟器中测量的，这样的测量毫无价值。您必须在设备上进行测量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T04:43:40.073

Object Alloc 报告运行的整个生命周期内使用的总内存。这意味着如果对象被分配和释放（通常是这样），您会看到所有内存消耗的总和。

更有用的是选择“创建并仍然存在”选项，然后突出显示图形中内存增加但如果您期望它不会下降的区域。然后您可以看到当时分配了多少内存以及分配它的内容。这适用于模拟器和设备。******``***********