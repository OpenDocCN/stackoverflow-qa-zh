# StackOverflow 问答 10365000-10365999

# multithreading - Vala：创建线程会导致属性丢失

> ID：10365004
> 
> 赞同：2
> 
> 时间：2012-04-28T15:39:00.153
> 
> 标签：multithreading, properties, vala

我目前正在尝试学习一些 vala。阅读教程后，我想将一些用 java 编写的应用程序移植到 vala。

因此，我尝试编写一个监视文件夹更改的应用程序。此监视器应作为单独的线程生成，以便应用程序可以执行其他监视操作。在java中轻松工作。

在对如何监控进行了一些研究之后（顺便说一句，stackoverflow 受到了影响），我最终得到了以下代码：

亚军：

```
public class App : Object 
    {
    private const string FOLDER_TO_WATCH = "/home/chr/Work/vala-monitor-test/tmp/";

    public App() {

        GLib.MainLoop loop = new GLib.MainLoop();

        stdout.printf("Folder: %s\n", FOLDER_TO_WATCH);

        try {
            var daemon = new MonitorDaemon( File.new_for_path( FOLDER_TO_WATCH ) );
            unowned Thread<void*> t = Thread.create<void*>( daemon.watch, true );
        }
        catch (ThreadError err) {
            stderr.printf("Error occured: %s", err.message);
        }
        catch (MonitorError err) {
            stderr.printf("Error occured: %s", err.message);
        }

        stdout.printf("waiting..\n");

        loop.run();

    }

    static int main( string[] args ) 
    {           

        if (!Thread.supported ()) {
            stderr.printf ("Cannot run without thread support.\n");
            return 1;
        }

        new App();
        return 0;

    }

} 
```

监控类：

```
errordomain MonitorError {
    NOT_A_DIRECTORY
}

public class MonitorDaemon : Object {

    // properties
    public File watched_folder { get; construct set; }

    // internal
    private bool _stop = false;

    public MonitorDaemon ( File folder_to_watch ) throws MonitorError {

        if ( folder_to_watch.query_file_type ( FileQueryInfoFlags.NONE ) != FileType.DIRECTORY ) {
            stderr.printf("Unable to watch: Not a directory\n");
            throw new MonitorError.NOT_A_DIRECTORY("Not a directory");
        }

        this.watched_folder = folder_to_watch;

        stdout.printf("Ready to watch %s\n", this.watched_folder.get_path() );

    }

    public void* watch() {

        try {
            FileMonitor monitor = this.watched_folder.monitor_directory ( FileMonitorFlags.NONE );
            monitor.changed.connect( event_happened );
        }
        catch (IOError err) {
            stderr.printf("Error occured: %s", err.message);
        }

        stdout.printf( "Started watching folder: %s\n", this.watched_folder.get_path() );

        while (!this._stop) { }

        stdout.printf( "Stopped watching folder: %s\n", this.watched_folder.get_path() );

        return null;

    }

    public void stop() {
        // cleanup..            
        this._stop = true;
    }           

    private void event_happened ( File file, File? other_file, FileMonitorEvent event_type ) {
        stdout.printf( "File '%s': %s\n", file.get_path(), event_type.to_string() );
    }

} 
```

当为 MonitorDaemon.watch 方法创建线程时，构造函数中设置的属性再次为 null，从而在命令行上产生以下输出：

```
Folder: /home/chr/Work/vala-monitor-test/tmp/
Ready to watch /home/chr/Work/vala-monitor-test/tmp/
waiting..

(process:7159): GLib-GIO-CRITICAL **: g_file_monitor_directory: assertion `G_IS_FILE (file)' failed

(process:7159): GLib-GObject-WARNING **: invalid (NULL) pointer instance

(process:7159): GLib-GObject-CRITICAL **: g_signal_connect_object: assertion `G_TYPE_CHECK_INSTANCE (instance)' failed

(process:7159): GLib-GIO-CRITICAL **: g_file_get_path: assertion `G_IS_FILE (file)' failed
Started watching folder: (null) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T21:37:00.270

Vala 是引用计数的。退出 try{} 块时，它会被取消引用，然后被释放。您必须让 MonitorDaemon 在某个地方保持活动状态。

# java - 如何将textview的BackgroundColor设置为Paint而不是Color？

> ID：10365005
> 
> 赞同：0
> 
> 时间：2012-04-28T15:39:00.410
> 
> 标签：java, android, colors, paint

好的，我知道我可以设置 textview 的背景颜色`textview.setBackgroundColor(R.color.darkgrey)`或其他颜色，但我的情况略有不同。我有一个具有三个属性的对象：名称、值和油漆。我用这个对象绘制了一个饼图，并制作了一堆文本视图作为图表的图例。我现在要做的就是将背景颜色设置为我用于图形的 Paint。我使用 android.graphics.Paint 的 setARGB 方法设置 Paint。我浏览了 android notes 试图找到一种转换方法来将 Paint 更改为颜色但没有运气。

任何想法如何使用 Paint 为 textview 设置背景颜色（）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T15:48:16.167

如果你想用画布绘制你的文本，你应该这样做：

```
public Bitmap myDrawText(Context context, String text, Typeface typeface, int  textSize, int width, int height) {
    Bitmap myBitmap = Bitmap.createBitmap(width, height,      Bitmap.Config.ARGB_8888);
    Canvas myCanvas = new Canvas(myBitmap);
    Paint paint = new Paint();
    paint.setAntiAlias(true);
    paint.setSubpixelText(true);
    paint.setTypeface(typeface);
    paint.setStyle(Paint.Style.FILL);
    paint.setColor(Color.WHITE);
    paint.setTextSize(textSize);
    paint.setTextAlign(Align.CENTER);
    myCanvas.drawText(text, (width / 2), 40, paint);
    return myBitmap;
} 
```

现在您有了文本的位图！

```
 ImageView iv = findViewById(R.id.some_image);
    iv.setImageBitmap(myBitmap); 
```

# c++ - 检查内存泄漏

> ID：10365008
> 
> 赞同：2
> 
> 时间：2012-04-28T15:39:15.127
> 
> 标签：c++, memory-leaks

> **可能重复：**
> [在 C++ 中检查内存泄漏的最佳方法是什么？](https://stackoverflow.com/questions/396100/what-is-the-best-way-to-check-for-memory-leaks-in-c)

有一种方法可以在程序结束后检查内存泄漏，还有一种方法可以检查是否有分配的内存区域尚未释放？

例如：

```
int main()
{
   int *iPtr = new int;

   // Was allocated memory that is not released yet?
   return 0;
   // Memory leaks?
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T15:43:39.993

在 linux 上，您可以使用[valgrind](http://valgrind.org/)。在 Windows 上，您必须搜索分配分析器（有[Purify](http://www-01.ibm.com/software/awdtools/purify/)和[AQTime 7](http://smartbear.com/products/free-tools/aqtime-standard/)），使用[_CrtDumpMemoryLeaks](http://msdn.microsoft.com/en-us/library/d41t22sb%28v=vs.80%29.aspx)（特定于 msvc，可能会产生误报）或编写自定义内存管理器来覆盖全局运算符 new/delete 并报告内存使用情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T16:28:36.067

检查所有分配的内存是否已被释放只是对抗内存泄漏的一部分。

假设一个程序在程序运行的每一秒内分配一兆字节的内存，并且所有这些分配的内存在程序终止之前被释放。由于所有分配的内存最终都会被释放，严格来说，这不是泄漏。在实践中，如果预计程序运行时间延长，这会产生巨大的泄漏。

假设可以重写程序，以便在运行中释放除极小部分之外的所有剩余分配内存，在程序终止时再次释放这些微小的剩余分配内存。严格来说仍然不是泄漏，但这个程序肯定比原始版本表现得更好。它仍然存在微小的运行时泄漏，因此如果程序运行数周仍可能会产生问题。

现在假设程序可以被重写，所以它的内存消耗永远受到一些合理的限制。这种运行时有界性可能比在终止时间释放所有分配的内存更重要。证明这种运行时有界性很困难。测试程序终止时是否释放了所有分配的内存是一项容易得多的任务。商业工具倾向于关注后者进行泄漏检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T15:43:11.117

您应该尝试使用[Valgrind](http://valgrind.org/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T19:10:48.783

对于 Visual C++，Visual Link Detector 可能是一个不错的选择。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-04-28T15:46:32.000

据我所知，当您在*用户空间*工作并且您的进程终止时，该进程分配的所有内存都会被释放并返回给操作系统。（运行该进程的是操作系统本身，将内存收回到他的池中；））
所以没有什么需要检查的。如果您在内核空间中运行某些任务，情况会有所不同，但我猜根据您使用的操作系统，场景可能会有所不同

# coding-style - 有哪些通用的“干净编码”约定？

> ID：10365009
> 
> 赞同：0
> 
> 时间：2012-04-28T15:39:18.777
> 
> 标签：coding-style, naming-conventions

除了特定于语言的结构之外，对于使用 PHP、javascript、java 和 python 编程的人来说，前 10 项干净编码必须做的事情是什么？我想保持我的代码尽可能干净和可读。例如，将函数体左括号与函数声明放在同一行与换行有何不同？此外，例如 (x==10) 与 (x == 10) 之间的间距是什么？任何有关干净编码的有用提示将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T15:45:00.940

这里有一些可能会有所帮助：

1.  给变量和方法起直观的名字
2.  使用您**特定的语言**编码风格（例如，在 Java 与 C++ 中，您在括号中使用不同的风格；根据特定的语言约定进行选择）
3.  总是对发生什么/为什么发生事情发表评论。
4.  但是不要用注释污染代码。
5.  如果可以，请尝试集成设计模式。它有助于可重用性和可维护性
6.  不要把所有东西都放在一种方法中。每个方法都应该做**一**件事并且做得**非常好**（这也使方法更容易阅读/理解/测试/调试）
7.  不要在代码中放入硬编码字符串
8.  分离应用程序数据和应用程序代码。即尽量不要对您的代码进行硬编码配置。
9.  不要试图比编译器更聪明。编写其他人也能理解的代码，并让编译器进行任何优化
10.  以显示您的意图的方式编写代码。编写代码保留在您的脑海中，在 7 个月内您可能需要对其进行调试，或者其他人可能需要修复/增强它。7 个月后，你不可能记住你为什么做了某事（评论很好，但有时还不够好）。更不用说那个试图修复你的代码的可怜人了

我相信还有很多，但我相信这些对任何语言都有用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T15:46:18.520

参考：

[http://misko.hevery.com/code-reviewers-guide/](http://misko.hevery.com/code-reviewers-guide/)

[http://misko.hevery.com/attachments/Guide-Writing%20Testable%20Code.pdf](http://misko.hevery.com/attachments/Guide-Writing%20Testable%20Code.pdf)

并检查此响应中的链接：

[https://stackoverflow.com/a/10359288/1268570](https://stackoverflow.com/a/10359288/1268570)

观看 Misko Hevery 的简洁代码演讲（提供给 Google 人员）

[http://www.youtube.com/watch?v=wEhu57pih5w&feature=player_embedded](http://www.youtube.com/watch?v=wEhu57pih5w&feature=player_embedded)

[http://www.youtube.com/watch?v=RlfLCWKxHJ0&feature=player_embedded](http://www.youtube.com/watch?v=RlfLCWKxHJ0&feature=player_embedded)

[http://www.youtube.com/watch?v=-FRm3VPhseI&feature=player_embedded](http://www.youtube.com/watch?v=-FRm3VPhseI&feature=player_embedded)

[http://www.youtube.com/watch?v=4F72VULWFvc&feature=player_embedded](http://www.youtube.com/watch?v=4F72VULWFvc&feature=player_embedded)

这些是你应该避免的警告信号：（来自 Misko Hevery）

*   构造函数或字段声明中的新关键字
*   在构造函数或字段声明中调用静态方法
*   除了构造函数中的字段赋值之外的任何东西
*   构造函数完成后对象未完全初始化（注意初始化方法）
*   构造函数中的控制流（条件或循环逻辑）
*   代码在构造函数中执行复杂的对象图构造，而不是使用工厂或构建器
*   添加或使用初始化块
*   违反得墨忒耳定律：方法调用链遍历具有多个点 (.) 的对象图
*   添加或使用单例
*   添加或使用静态字段或静态方法
*   添加或使用静态初始化块
*   添加或使用服务定位器

这是一本关于编写干净代码的好书：

[http://books.google.com.mx/books/about/Clean_Code.html?id=dwSfGQAACAAJ&redir_esc=y](http://books.google.com.mx/books/about/Clean_Code.html?id=dwSfGQAACAAJ&redir_esc=y)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T15:48:24.043

在我看来，答案是没有真正的答案。一个好的规则是遵守约定，这通常是社区已经熟悉的合理约定。我宁愿建议你几本书有一个想法。

对于 Java/C++/C#/VisualBasic，您应该阅读

[Code Complete：软件构建的实用手册](https://rads.stackoverflow.com/amzn/click/com/0735619670)

在重 Java 方面，您将从

[清洁代码：敏捷软件工艺手册](https://rads.stackoverflow.com/amzn/click/com/0132350882)

考虑到这两本书中的概念具有普遍的有效性，不应局限于特定的语言。

# javascript - OnClick Javascript 似乎无法正常工作

> ID：10365012
> 
> 赞同：0
> 
> 时间：2012-04-28T15:39:36.040
> 
> 标签：javascript, onclick

我正在做一个涉及类似控制台的面板的项目。我在谷歌上环顾四周，但我无法解决这个问题！我让 load() 工作，但 click() 没有。

```
<html>

<head>
<script type="text/JavaScript">
function load()
{
  document.getElementById("display").innerHTML="Hello!";
}

function click()
{
  alert("Clicked");
}
</script>
</head>

<body style="background-color:red;" onload="load()">
<div id="display" style="position:absolute; right:0px; left:0px; bottom:0px; width:100%; height:87%; background-color:white;"></div>
<div style="position:absolute; left:0px; width:10%;">
<b>Input:</b>
<input id="text" maxlength=50 />
<input type="button" onclick="click()" value="OK" />
</div>

</body>
</html> 
```

如果可以的话，请帮忙！谢谢。:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T15:42:51.610

只需将您的`click`函数重命名为其他名称，例如`myclick`，它将起作用:)

发生这种情况是因为调用`click()`您再次触发点击事件而不是您的函数。

**在这里检查**：http : [//jsfiddle.net/rHyZ7/](http://jsfiddle.net/rHyZ7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-27T03:11:24.940

我在命名函数 clear() 时遇到了同样的问题

更改函数名称解决了问题

# c# - 当没有提供种子时，随机种子类是什么？

> ID：10365014
> 
> 赞同：4
> 
> 时间：2012-04-28T15:40:11.920
> 
> 标签：c#, .net, random

[可以使用不带参数](http://msdn.microsoft.com/en-us/library/h343ddh9.aspx)`Random`的构造函数来实例化类，并且 MSDN 说在这种情况下，它会以一些与时间相关的值作为种子。

导出该时间相关值的方法是否记录在任何地方？我可以复制它吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T15:45:49.720

它没有记录在案，我认为这是故意的。我看不出有什么好的理由为什么应该记录这样的事情并且框架实现者应该能够选择如何准确地做到这一点。

但如果你想知道它目前是如何工作的，只需使用 ildasm 或 Reflector。Reflector 会给你这个（.Net 4.5 beta）：

```
public Random() : this(Environment.TickCount)
{
} 
```

如果您查看[mono 的源代码](https://github.com/mono/mono/blob/master/mcs/class/corlib/System/Random.cs#L48)，您会发现自 2003 年以来，它的功能完全相同。

# c# - 对于给定的输入值，如何找到数据库中存在的行数？

> ID：10365016
> 
> 赞同：-1
> 
> 时间：2012-04-28T15:40:16.280
> 
> 标签：c#, sql, database, counter

我有一个`Setup`使用下表调用的工作数据库。

```
tblPeople
-----------------
people  nchar(50)
occur   int 
```

我已经让我的 Windows 窗体应用程序从文本框中加载用户输入的数据（人），但我不知道如何设置它，以便如果（人）数据已全部输入，而不是添加它再次进入数据库，我希望它计入发生列。例如，如果 Fred 被输入两次，它应该会显示出来。

```
people occur
------ -----
Fred     2 
```

*代码*：

```
SqlConnection connection = new SqlConnection();
connection.ConnectionString = (@"Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\John\Desktop\database practise\db1\db1\Setup.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True");
SqlCommand command = new SqlCommand();
command.Connection = connection;

connection.Open();
command.CommandText = "INSERT INTO tblPeople  (people) VALUES (@people)";

try
{
    string[] splittext = textbox1.Text.Split(' '); 
    foreach (string ppl in splittext)
    {
        if (ppl.StartsWith("*")) 
        {
            command.Parameters.AddWithValue("@people", ppl);
            int rowsAffected = command.ExecuteNonQuery();
            MessageBox.Show("Inserted: " + rowsAffected.ToString());
        }
    }
}
finally
{
    connection.Close();
} 
```

忽略字符串拆分位。这一切正常，它只是为发生列添加一个计数器，我不知道该怎么做。

有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T15:47:08.473

在插入之前，您必须检查是否已经插入了带有名称的记录，如果是，只需更新计数，否则，插入新记录。我会将其转换为存储过程

```
CREATE PROCEDURE SavePeople(@peopleName varchar(50))
AS
 BEGIN
   IF EXISTS(SELECT PEOPLE FROM tbl_PEOPLE WHERE PEOPLE=@peopleName)
    BEGIN
      UPDATE tbl_People Set Occur=OCcur+1 WHERE PEOPLE=@peopleName
    END
   ELSE
    BEGIN
      INSERT INTO (PEOPLE,OCCUR) VALUES (@peopleNAme,1)
    END

 END 
```

我会将您的代码包装在 using 语句中。我会从 save 方法中取出循环语句，并将其转换为更通用的方法，该方法接受单个人名并保存到 db。这样您就可以从任何场景中调用它（循环一次或 n 次）

```
string con=@"Data Source=.\SQLEXPRESS;AttachDbFilename=C:\Users\John\Desktop\database practise\db1\db1\Setup.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True"

public bool SavePeople(string peopleName)
{
   try
   {
      using (SqlConnection objConnection = new SqlConnection(con))
      {
        SqlCommand objCommand = new SqlCommand("SavePeople", objConnection);
        objCommand.CommandType = CommandType.StoredProcedure;
        objCommand.Parameters.AddWithValue("@peopleName", peopleName);       
        objConnection.Open();
        objCommand.ExecuteNonQuery();       
      }
      return true;
   }
   catch(Exception ex)
   {
      //You want to log the ex
   }
   return false; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T16:03:03.057

有。如果您熟悉 Linq，它为您提供了一种非常轻松地进行此检查的方法。我正在使用您已经知道如何操作的代码采取一些捷径。

```
string checkname = "Fred";
var x = tblPeople.Where(w => w.people == checkname);
if (x.Count > 0) 
{
  x.occur++;
  [databaseconnectionstring].SubmitChanges();
}
else 
{
  [insert your new record here]
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T16:04:06.113

当然，首先你必须读取当前值（使用 SELECT 查询），然后创建一个 UPDATE sql 语句，它将更新数据库中的字段。每次加一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T16:36:03.543

以下是如何通过代码更新 db`s 字段：

```
 using (SqlConnection conn = new SqlConnection("connString"))
        {
            int counter = 0;
            using (SqlCommand cmd = new SqlCommand("SELECT people FROM tblPeople", conn))
            {
                conn.Open();
                using (SqlDataReader reader = cmd.ExecuteReader())
                {
                    if (reader.GetValue(0) != DBNull.Value)
                    {
                        counter = (int)reader[0];
                    }
                }
            }
            using (SqlCommand cmd = new SqlCommand("UPDATE tblPeople SET people = @myCounter", conn))
            {
                cmd.Parameters.Add("@myCounter", System.Data.SqlDbType.Int).Value = ++counter;
                cmd.ExecuteNonQuery();
            }
        } 
```

第一次：读取当前值（如果存在）第二次将其加一并更新字段

希望能帮助到你。再见

# c++ - c ++ PPL并行工作-归约类“可组合”中的函数max（）

> ID：10365017
> 
> 赞同：1
> 
> 时间：2012-04-28T15:40:19.347
> 
> 标签：c++, multithreading, parallel-processing, ppl

我正在使用并行模式库。类combinable 在openMP 中扮演reduction 子句的角色，可以合并并行计算的结果。

.combine(max()) 是否存在（顺便说一句，您能否指出一些允许使用 combine 操作的 ref，但没有找到）？

谢谢并恭祝安康。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:30:24.727

是的，您可以传递`std::max`给`combineable::combine`，在将模板函数作为谓词传递时必须考虑的一件事是您必须显式命名类型：

```
combineable<T> max;

// .. do processing

max.combine(std::max<T>); 
```

[您可以在此处](http://msdn.microsoft.com/en-us/library/dd492446.aspx)找到所有有关`combine`（以及所有其他 PPL 内容）的官方 MSDN 文档。

# c++ - 使用 Xcode 嵌入 Lua

> ID：10365020
> 
> 赞同：1
> 
> 时间：2012-04-28T15:40:37.980
> 
> 标签：c++, macos, xcode4, lua

我无法让 Lua 5.2.0 在 Xcode 4 中工作。我使用`make`liblua.a 中的链接构建它，添加了头文件路径，并将其包含在`Extern "C"`. 我没有得到链接器错误。但是，当我运行此代码时：

```
#include <iostream>

extern "C" {
#include "lua.h"
#include "lauxlib.h"
#include "lualib.h"
}

int main (int argc, char *argv[])
{
    lua_State *ls = lua_newstate(0, 0);

    lua_close(ls);
    return 0;
} 
```

我`Thread 1: EXC_BAD_ACCESS (code 1, address=0x0)`上了 11 号线。我想这告诉我，我实际上是在尝试调用不存在的东西。任何帮助将不胜感激！

谢谢，马克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T15:45:37.007

您将 NULL 内存分配函数传递给`lua_newstate`. 难怪它会崩溃。也许你想用`luaL_newstate`？

# regex - 试图与正则表达式匹配

> ID：10365021
> 
> 赞同：-1
> 
> 时间：2012-04-28T15:41:10.593
> 
> 标签：regex

我在开头有以下带有可变空格的文本：

```
 Total Saving: 84% 
```

我很难找到比赛。从我到目前为止所学到的（正则表达式的新手）。这应该接近工作（我只需要匹配文本的任一侧）：

`[\s]* Total Saving: [0-9%]*`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T15:46:51.713

您尚未指定捕获组来保存结果，并且百分号`%`不应在字符串中出现多次。

`\s*Total Saving:\s*([0-9]+)%`（中间的空格更灵活一些） - 第一组将包含实际百分比。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T15:51:33.920

尝试：

```
 /^\s+Total\sSaving:\s+([0-9]{1,3})%$/ 
```

只得到数字（我假设它的范围是 0..100）。适用于多行。

# css - 语法帮助 - 背景图像精灵 css

> ID：10365022
> 
> 赞同：1
> 
> 时间：2012-04-28T15:41:21.930
> 
> 标签：css, coordinates, background-image, css-sprites

我知道我很接近但有人帮助我：

```
body {
background-attachment: fixed;
background: url("images/background.jpg"), url("images/background.jpg");
background-repeat: no-repeat;
line-height: 1;
min-width: 1150px;
background-position: top left, bottom right;
} 
```

用作精灵的图像“background.jpg”为 1720px 宽 x 1100px 高。我需要在第一个实例中显示图像的右上部分，在第二个实例中显示图像的左下部分。在每种情况下，需要从 jpg 中获取的矩形大小为 600 像素宽和 400 像素高。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T16:21:03.827

这可能会有所帮助

```
body {
    background-attachment: fixed;
    background: url("images/background.jpg") 100% 0px no-repeat, url("images/background.jpg") 0% 600px no-repeat;
    line-height: 1;
    min-width: 1150px;
    } 
```

使用图像后的值。100% 和 0% 指的是 x 轴（这些也可以是 px），而 0px 600px 指的是 y 轴。我可以告诉你，没有一个实时页面可以玩这个。

# java - 在线程中保持与服务器的连接？

> ID：10365023
> 
> 赞同：1
> 
> 时间：2012-04-28T15:41:23.783
> 
> 标签：java, multithreading

我不确定如何更好地将我的程序设计为多线程。基本上我有一个队列服务器，我连接到它并发送它工作，但是当我启动更多线程以更快地发送更多工作时，我注意到我的线程正在阻塞。

这是我正在做的一个例子（在我的程序中，我正在发送一些数据和一个从共享连接派生的通道）。

```
class Send_to_Queue implements Runnable{

    protected String queue_name = null;
    protected Channel channel = null;
    protected byte[] message = 0

   public Send_to_Queue(String queue_name, byte[] message, Channel channel) {
        // TODO Auto-generated constructor stub
        this.queue_name = queue_name;
        this.message   = message;
        this.channel = channel;         
    } 
```

该通道并不是线程所独有的，它由所有正在启动的线程共享，我认为这是阻塞的来源。我对执行此操作的最佳方法有点困惑，因为我不确定如何在 `ThreadPoolExecutor`其生命周期内创建一个新频道，而不是为每个任务创建一个新频道（有点贵）。如果没有工作，我不介意关闭它，但如果我有 4 个线程和 100 个工作单元，我希望它只建立一个新通道 4 次而不是 100 个。

我知道为我的服务器创建新通道/连接的语法似乎不明白如何以一种并非在每个实例上都建立的方式来做到这一点。将连接传递给线程并让它启动一个新通道（`this.channel`每次都在创建一个新通道）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:04:06.160

我认为您想在构建`Channel`时创建一个新的`Thread`，以便它可以使用此通道并并行完成工作。有几种不同的方法可以做到这一点。通常在服务器场景中，服务器接受一个连接，该连接会`Channel`为该连接生成一个新连接。然后它把它`Channel`交给处理程序`Thread`。套接字也是如此，但你明白了：

```
ServerSocket socket = ...
...
while (true) {
    Socket clientSocket = socket.accept();
    new Thread(new MyRunnable(clientSocket)).start();
}
...
public class MyRunnable implements Runnable {
    private Socket clientSocket;
    public MyRunnable(Socket clientSocket) {
        this.clientSocket = clientSocket;
    }
    public void run() {
        while (!done) {
            // use the socket associated with this thread
        }
    }
} 
```

如果您只是创建一堆线程来建立与远程服务器的连接并完成工作，您可以在循环中或使用其中一个`ExecutorService`池来执行此操作：

```
ExecutorService threadPool = Executors.newFixedThreadPool(100); 
for (int i = 0; i < 100; i++) {
    threadPool.submit(new Runnable() {
        public void run() {
            Channel threadChannel = // create channel here;
            while (!done) {
                // use the per-thread channel
            }
        }
    });
} 
```

另一种流行的模式是让线程使用`Socket`或`Channel`处理一系列单元。你可以使用 a`BlockingQueue`来达到这个目的：

```
BlockingQueue<WorkUnit> workQueue = new LinkedBlockingQueue<WorkUnit>();
...
// add work units to the work queue
for (int i = 0; i < 1000; i++) {
    // add work to the queue
    workQueue.put(new WorkUnit(i));
}

// the MyRunnable above can then be modified like this:
    ...
    public void run() {
        while (!done) {
            WorkUnit workUnit = workQueue.take();
            // use MyRunnable socket or channel and do the WorkUnit
        }
    } 
```

# .net - ios 文件从 mac/pc 共享/同步到设备

> ID：10365026
> 
> 赞同：1
> 
> 时间：2012-04-28T15:41:32.720
> 
> 标签：.net, ios, ipad, bonjour, file-sharing

我开发了 ipad 应用程序，它显示来自 sqlite db 的图像和其他产品详细信息。我还开发了驻留在 Windows xp pc 上的基于 .net 的 Windows 应用程序。此应用程序在 sqlite db 中生成数据，并将每条记录映射到相关图像。到目前为止，此流程在启用 iTunes 文件共享功能的情况下运行良好。因此，用户通过 iTunes 文件共享将 sqlite db 和图像（大约 2-3 gb）复制到 iPad。

最近我遇到了用于在本地网络中进行通信的 Bonjour 服务。

我想知道我的基于 .net 的应用程序是否有可能创建 Bonjour 服务器并将 sqlite db 和图像文件保存在某个文件夹中，而 ios 设备可以通过 wifi 直接读取并在请求时获取文件？

请建议使用 Bonjour 服务是否是一个好方法以及任何示例教程。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T08:31:30.627

Bonjour 可以帮助您在本地网络上查找设备。

然后您必须开发自己的传输协议或使用例如[CocoaAsyncSocket](https://github.com/robbiehanson/CocoaAsyncSocket)启动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:42:45.233

经过非常艰苦的搜索......找到了一些值得使用或需要处理的东西...... [http://syncdocs.sourceforge.net/index.php](http://syncdocs.sourceforge.net/index.php)。

它使用 Bonjour 服务来发现和进一步发送/接收文件。

# c++ - 运算符+重载

> ID：10365031
> 
> 赞同：0
> 
> 时间：2012-04-28T15:42:03.967
> 
> 标签：c++, operator-overloading, concatenation, add

好的，我对运算符重载很陌生，我必须在面向对象的程序中执行这个函数，但我肯定需要帮助。以下是说明：

> MyString 对象应包含打印字符串的 Print() 方法
> 
> MyString 对象应包含一个报告字符串长度的 Length() 方法
> 
> MyString 对象应该包含一个默认构造函数，它将初始字符串设置为“Hello World”的值。
> 
> MyString 对象应包含允许设置字符串初始值的备用构造函数。
> 
> MyString 对象应重载以下运算符：
> 
> *   括号运算符应该被重载以替换之前赋值的 Set 和 Get 函数。请注意，两个实例都应在违反字符串数组边界时发出 exit(1) 。
>     
>     
> *   赋值运算符 (=) 将源字符串复制到目标字符串中。请注意，目标的大小需要调整为与源的大小相同。
>     
>     
> *   如果两个字符串的大小和内容相同，则返回 true 的逻辑比较运算符 (==)。
>     
>     
> *   否定逻辑比较运算符 (!=)，返回布尔否定 2。
>     
>     
> *   **连接两个字符串的加法运算符 (+)**
>     
>     
> *   加法/赋值运算符 (+=) 以下列方式使用： String1 += String2 操作为 String1 = String1 + String2
>     
>     
> *   **加法 (+) 和赋值 (=) 运算符都需要能够进行级联操作。这意味着 String3 = String1 + String2 或 String1 = String2 = String3 应该可以工作。**

这是我在 .cpp 文件中的代码：

```
MyString::MyString()
{
       char temp[] = "Hello World";

       int counter(0);
        while(temp[counter] != '\0') {
              counter++;
       }
       Size = counter;
        String = new char [Size];
        for(int i=0; i < Size; i++)
            String[i] = temp[i];

}

MyString::MyString(char *message)

{
      int counter(0);
       while(message[counter] != '\0') {
            counter++;
        }
       Size = counter;
      String = new char [Size];
      for(int i=0; i < Size; i++)
             String[i] = message[i];
 }

 MyString::~MyString()
 {
      delete [] String;
 }

 int MyString::Length()
 {
       int counter(0);

       while(String[counter] != '\0')
       {
             counter ++;
        }

       return (counter);
  }

**const MyString operator +(const MyString& one, const MyString& two)
{
       MyString String1;
       return String1;
 }**

MyString& MyString::operator()(const int index, const char b)
{
       if(String[index] == '\0')
       {
               exit(1);
       }
       else
       {
         String[index] = b;
       }

 }

MyString& MyString::operator=(const MyString& rhs)
{

        Size = rhs.Size;
        counter = rhs.counter;

        delete [] String;
        String = new char[Size];

        for(int i = 0; i < counter+1 ; i++)
       {
               String[i] = rhs.String[i];
       }
       return *this;

 }

 bool MyString::operator==(const MyString& one)
 {
       if(one.Length() == two.Length())
       {
              for(int i = 0; i < one.Length()+1; i++)
              {
                      if(one[i] == two[i])
                            return true;
              }
       }
       else
             return false;
 }

 MyString& MyString::operator()(const int i)
 {

        if( String[i] == '\0')
        {
              exit(1);
        }
        else
       {

            return String[i];

       }
 }

void MyString::Print()
{
       for(int i=0; i < Size; i++)
               cout << String[i];
       cout << endl;

} 
```

这是我在主文件中的代码：

```
int main (int argc, char **argv)
{

 MyString String1;             //Test of default constructor. Use "Hello world"
 MyString String2 ("Two strings are not equal");       //Test of alternate constructor
 MyString String3 ("Two strings are equal");
 MyString String4 (String1);

 cout << "*************Test of values*************" << endl;
 String1.Print ();
 String2.Print ();
 String3.Print ();

 cout << "*************Test of Length*************" << endl;
 cout << String1.Length () << " ";
 cout << String2.Length () << " ";
 cout << String3.Length () << endl;

 cout << "*************Test of Set*************" << endl;
 String1 (0, 'J');
 String1.Print ();

 cout << "*************Test of Copy*************" << endl;
 String1.Print ();
 cout << endl;
 String3.Print ();
 cout << endl;
 String3.Copy (String1);       //String1 should be copied into String3
 String1.Print ();
 cout << endl;
 String3.Print ();
 cout << endl;

 cout << "*************Test of Get*************" << endl;
 for (int i = 0; i < String1.Length (); i++)   //The last character should exit the    program
   {
      cout << String1 (i) << " ";
   }
  }
   cout << endl;

   if (String1 == String4)
   {
      String3.Print ();
   }
   else
   {
     String4.Print ();
   }

   if (String1 != String4)
   {
      String3.Print ();
   }
   else
   {
      String4.Print ();
    }

   String1 = String2 = String3;
   String1.Print ();
   String2.Print ();
   String3.Print ();

   String1 = String2 + String3 + String4;
   String1.Print ();

   String2 += String3;
   String2.Print ();

   return 0;

 } 
```

main.cpp 文件不能更改，但其他 .cpp 文件必须与该文件一起编译和运行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T15:43:48.337

您需要将运算符的声明放在标头中，但您遇到的问题是您在`operator+`for 您的字符串中使用`operator+`您的字符串

```
const MyString operator +(const MyString& one, const MyString& two) {
        MyString String1 = one + two; // this calls operator+, which calls operator+, which calls...
        return String1;
} 
```

另外，由于您要按`MyString`值返回，因此不应按以下方式返回`const`：

```
MyString operator +(const MyString& one, const MyString& two) {
        MyString String1;
        // do something with the data of one and two and put it in String1
        return String1;
} 
```

最后，如果您的操作员需要访问 的非公开数据`MyString`，您应该将其声明为您`MyString`班级的朋友。

```
class MyString {

// as before

friend MyString operator+(const Mytring& rhs, const MyString& lhs);

}; 
```

# c++ - 使用非托管 C/C++ 库构建 WCF 服务

> ID：10365035
> 
> 赞同：0
> 
> 时间：2012-04-28T15:42:07.567
> 
> 标签：c++, .net, wcf

我想利用我已经编码和测试过的非托管 C/C++ 库的性能优势来构建 WCF 服务。但我还没有找到任何信息如何最好地解决这个问题。我有一个用 C/C++ 编写的应用程序，但我想将其作为服务提供，并且由于我熟悉 WCF，所以我想知道有哪些方法，如果有的话，我可以在不丢失 WCF 的情况下执行此操作优惠。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T00:35:07.263

WCF 是一个托管库，但您可以查看 Windows Web 服务 API (WWSAPI)，这是一个包含 WCF 提供的子集的本机代码库。[您可以在http://msdn.microsoft.com/en-us/library/windows/desktop/dd430435(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd430435(v=vs.85).aspx)或[http://archive.msdn.microsoft.com](http://archive.msdn.microsoft.com/wwsapi)找到更多信息[/wwsapi](http://archive.msdn.microsoft.com/wwsapi)。

# jquery-ui - 已选择单选按钮

> ID：10365040
> 
> 赞同：0
> 
> 时间：2012-04-28T15:43:01.177
> 
> 标签：jquery-ui, jquery

当我单击每个单选按钮时，我喜欢提醒单选按钮的名称。但只有一个单选按钮符合条件。请帮忙。我是 jquery 的新手

```
<html>
<head>
    <style type="text/css">
        #container{
            width:500px;
            height:300px;
            background-color:#F9F9F9;;
        }

    </style>
    <script type="text/javascript" src="jquery-1.6.1.js"> </script>
    <script type="text/javascript">

        $(document).ready(function(){ 

            $("input[@name=testGroup]:checked").click(function(){

                if($(this).val() == "pizza"){

                    alert("pizza");

                }

                else if($(this).val()== "cake"){
                    alert("cake");
                }

            });

        });
    </script>
</head>

<body>

    <input type="radio" class="rad_but" name="food" value="pizza">Pizza</input>
    <input type="radio" class="rad_but" name="food" value="cake">Cake</input>
<input type="radio" class="rad_but" name="food" value="others">Others</input>

    <div id="container">
    </div>
</body>
</html> 
```

每次单击它们中的每一个时，只有一个单选按钮会提醒该值。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T15:49:04.653

这是你需要的吗？[**演示**](http://jsfiddle.net/YWHM5/)

```
 $("input[name='food']").change(function () {

        if($(this).val() == "pizza"){
         alert("pizza");
         }
         else if($(this).val()== "cake"){
         alert("cake");
         }
         else if($(this).val()== "others"){
         alert("others");
         }
   }); 
```

# jquery - jQuery，获取外部函数选择器

> ID：10365046
> 
> 赞同：0
> 
> 时间：2012-04-28T15:43:41.903
> 
> 标签：jquery, function

`$(this)`在下面的情况下，我怎样才能`setTimeout`获得悬停功能的选择器`img`。

```
$("img").hover(function(){
window.setTimeout(function() {  
    $(this).addClass("hovering"); // add class .hovering to the exact img being hovered
}, 500);  
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T15:45:09.057

放入`this`其他变量。

```
$("img").hover(function() {
    var $this = $(this);

    window.setTimeout(function() {  
        $this.addClass("hovering"); // add class .hovering to the exact img being hovered
    }, 500);  
}); 
```

# character-encoding - UIWebView 错误地解释 UTF-8 拉丁字符

> ID：10365049
> 
> 赞同：1
> 
> 时间：2012-04-28T15:44:06.927
> 
> 标签：character-encoding, uiwebview

我查看了从那里服务器返回的 JSON。当我在浏览器中查看它时，我假设我看到的是原始编码，其中包含如下所示的字符串：

> del mecenazgo para la conservaci\u00c3\u00b3n y divulgaci\u00c3\u00b3n del arte cl\u00c3\u00a1sico
> 
> Entrada general y gu\u00c3\u00ada del Museo

然后我假设我对这些字符串的显示不正确，因为传入的 JSON 没有正确编码。

我查看了原始源数据（抓取的网页），编码看起来更像这样，以及我在 UIWebView 中看到的内容：

> Jerónimo (正确) = Jer\u00c3\u00b3nimo (不正确) = JerÃ³nimo (显示不正确) doméstica (正确) = dom\u00c3\u00a9stica (不正确) = doméstica (显示不正确)

我查看了这些拉丁字符的一些 UTF-8 代码。0xc3,0xb3 是 oacute (ó)，0xc3,0xa9 是 eacute (é)。但是 UIWebView 不能正确转换这些。（头部包含一个带有 charset=UTF-8 的元标记。）我能做些什么呢？

# linq - 通用实体框架更新程序

> ID：10365053
> 
> 赞同：0
> 
> 时间：2012-04-28T15:44:46.227
> 
> 标签：linq, entity-framework

我正在尝试编写一些可以传入类的东西（其中将包括新数据，包括主键值）并使用实体框架，使用主键检索实体。所以，我有一个类，包括主键值，但我不一定知道主键（但 Entity Framework 知道）。

（我稍后还需要通用更新实体，但这是一个单独的问题）

在 LINQ 中是否有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T02:29:54.383

据我了解，您有一个未被上下文跟踪的对象，并且您想使用 EF 查询数据库中的等效实体。（然后您想使用对象中的值更新数据库，但这将是一个单独的问题。）

如果您知道实体的主键值，则可以使用 Find 方法从数据库中获取实体。棘手的一点是以通用方式获取主键值。这是我们希望在未来版本的 EF 中更容易做到的事情，但现在我已经准备了一些扩展方法来提供帮助。

首先，让我们获取给定类型的主键名称。这是棘手的一点。它需要下拉到 ObjectContext 并使用 MetadataWorkspace：

```
 public static IEnumerable<string> PrimayKeysFor(
        this DbContext context,
        object entity)
    {
        Contract.Requires(context != null);
        Contract.Requires(entity != null);

        return context.PrimayKeysFor(entity.GetType());
    }

    public static IEnumerable<string> PrimayKeysFor(
        this DbContext context,
        Type entityType)
    {
        Contract.Requires(context != null);
        Contract.Requires(entityType != null);

        var metadataWorkspace =
            ((IObjectContextAdapter)context).ObjectContext.MetadataWorkspace;
        var objectItemCollection =
            (ObjectItemCollection)metadataWorkspace.GetItemCollection(DataSpace.OSpace);
        var ospaceTypes = metadataWorkspace.GetItems<EntityType>(DataSpace.OSpace);

        var ospaceType = ospaceTypes
            .FirstOrDefault(t => objectItemCollection.GetClrType(t) == entityType);

        if (ospaceType == null)
        {
            throw new ArgumentException(
                string.Format(
                    "The type '{0}' is not mapped as an entity type.",
                    entityType.Name),
                "entityType");
        }

        return ospaceType.KeyMembers.Select(k => k.Name);
    }
} 
```

现在我们可以添加一个扩展方法，利用它来获取给定实体的键值（不必跟踪）：

```
 public static object[] PrimayKeyValuesFor(this DbContext context, object entity)
    {
        Contract.Requires(context != null);
        Contract.Requires(entity != null);

        var entry = context.Entry(entity);
        return context.PrimayKeysFor(entity)
            .Select(k => entry.Property(k).CurrentValue)
            .ToArray();
    } 
```

一旦我们有了这个，就很容易使用 Find 来获取数据库中与给定对象对应的实体，而无需了解该对象的任何信息。例如：

```
var databaseOrderLine =
    context.Set<OrderLine>().Find(context.PrimayKeyValuesFor(orderLine)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-21T09:30:26.853

您可以使用通用的 ContextHelper：

```
public class ContextHelper<T>  : IContextHelper<T>
{
    //Instantiate your own EntityFrameWork DB context here,
    //Ive called the my EntityFramework Namespace 'EF' and the context is      named 'Reporting'
    private EF.DataContext DbContext = new EF.DataContext(); 
    public bool Insert<T>(T row) where T : class
    {
        try
        {
            DbContext.Set<T>().Add(row);
            DbContext.SaveChanges();
            return true;
        }
        catch(Exception ex)
        {
            return false;
        }
    }
    public bool Update<T>(T row) where T : class
    {
        try
        {
            DbContext.Set<T>().AddOrUpdate(row);
            DbContext.SaveChanges();
            return true;
        }
        catch (Exception ex)
        {
            return false;
        }
    }
    public bool Delete<T>(T row) where T : class
    {
       return Update(row); //Pass an entity with IsActive = false and call update method
    }
    public bool AddRows<T>(T[] rows) where T : class
    {
        try
        {
            DbContext.Set<T>().AddOrUpdate(rows);
            return true;
        }
        catch (Exception ex)
        {
            return false;
        }
    }
} 
```

并使用它来调用它：

```
 public void NewEmailRecipient(EF.EmailRecipient recipient)
        {
            // logic operation here

            EntityToDB(recipient);
        }
        public void NewReportRecipient(EF.ReportRecipient recipient)
        {
            // logic operation here

            EntityToDB(recipient);
        }
        public void UpdateEmailRecipient(EF.EmailRecipient recipient)
        {
            // logic operation here

            UpdateEntity(recipient);
        }

        public void UpdateReportRecipient(EF.ReportRecipient recipient)
        {
            // logic operation here

            UpdateEntity(recipient);
        }
        // call generic methods to update DB
        private void EntityToDB<T>(T entity) where T : class
        {
            var context = new ContextHelper<T>();
            context.Insert(entity);
        }

        private void UpdateEntity<T>(T entity) where T : class
        {
            var context = new ContextHelper<T>();
            context.Update(entity);
        } 
```

我在这里发布了一个演示解决方案

[https://github.com/andyf1ynn/EntityFramwork-Generic-Type-DAL](https://github.com/andyf1ynn/EntityFramwork-Generic-Type-DAL)

# jquery - jQuery - 动画不是css值，而是JS中的全局变量

> ID：10365054
> 
> 赞同：0
> 
> 时间：2012-04-28T15:44:51.270
> 
> 标签：jquery, flash, jquery-animate

有没有办法使用 jQuery.animate 为 JS 中的全局变量设置动画？我的意思是这样的：

var FlashPlayerVolume = 0.0;

$jQuery.Animate( {FlashPlayerVolume: 1.0}, 200 );

可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T16:21:24.823

听起来不是一个好主意，但要回答这个问题，是的，您可以使用内置的 $.fx.step 方法为任何东西制作动画。

最简单的方法是在隐藏元素或其他东西上为任意值设置动画，然后执行以下操作：

```
var FlashPlayerVolume = 0.0;

$('div').css('font-size', 0.0).animate({ fontSize: 1.0 }, {
    duration: 3000,
    step: function(now, fx) { 
        FlashPlayerVolume = now;
        console.log(FlashPlayerVolume);
    }
}); 
```

[小提琴](http://jsfiddle.net/adeneo/MhysR/) ​</p>

# objective-c - 窗口 setContentView 崩溃？

> ID：10365056
> 
> 赞同：0
> 
> 时间：2012-04-28T15:45:06.993
> 
> 标签：objective-c, cocoa

我不知道为什么，但每当我做一个简单的事情时：

```
[_window setContentView:newView]; 
```

我遇到“gdb”崩溃。

我有两种方法，'enterFullscreen'，'exitFullscreen'，其中 _window 是我的主要 NSWindow。

```
NSView *oldView;

- (void)enterFullScreen:(NSView*)newView
{
    oldView = [[_window contentView] view];
    [_window setContentView:newView];
}

- (void)exitFullscreen:(NSView*)newView
{
    [_window setContentView:oldView];
} 
```

这 2 个方法通过 IBAction 链接到 2 个按钮。每当我按下按钮时，视图都会交换，但随后会立即崩溃。

有谁知道为什么？

感谢大家

**编辑：这是我现在拥有的代码：**

```
-(void)enterFullscreen(NSView*)newView
{
    oldView = [[NSView alloc] init];
    oldView = [_window contentView];
    [newView removeFromSuperview];
    [_window setContentView:newView];
}

- (void)exitFullscreen:(NSView*)newView
{
    [_window setContentView:oldView];
} 
```

进入全屏工作正常，但是当我调用 exitFullscreen 时，窗口变为空白，然后导致以下崩溃：

![崩溃图像](../Images/47ee767777a2ceda49541482dabdaf95.png)

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T16:05:35.623

发布的代码不会编译。缺少冒号，或者我不以其他方式理解方法签名。

其次，`[window contentView]`返回一个`NSView`. 然后调用`-view`它的方法。那是什么？ `NSView`没有这样的方法。从上下文来看，您的意思是将实际的旧内容视图保存在 中`oldView`，那么您为什么要调用其他内容`[window contentView]`呢？

无论如何，窗口保留其内容视图。但是，当您换入新的内容视图时，它会释放旧的并保留新的。如果您正在使用 ARC 而`oldView`不是`__strong`，或者如果您没有使用 ARC，那么旧的内容视图不会被任何东西保留并被释放。

如果这不能解释它，您需要发布确切的异常、崩溃或错误消息并显示它发生的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T16:07:18.777

设置内容视图；发送自动释放消息。该方法导致旧的内容视图被释放；如果您打算重用它，请务必在发送此消息之前保留它，并在将其添加到另一个 NSWindow 对象或 NSView 时酌情释放它。尝试类似以下的操作。

```
 [newView retain];
  [oldView removeFromSuperview];
  [_window setContentView:newView];
  [newView release]; 
```

# testing - 测试系统的生产数据

> ID：10365058
> 
> 赞同：1
> 
> 时间：2012-04-28T15:45:11.593
> 
> 标签：testing, masking, gui-testing, test-data, test-environments

我需要一些关于如何在手动 UI 测试中处理测试数据的建议。我们的应用程序需要来自数据库的数据才能工作和手动测试。由于我们正在处理敏感数据，因此我们不允许转储生产数据以在我们的测试系统（或开发机器）上使用它。

你如何处理这个问题？我正在考虑屏蔽生产数据以在测试中使用它的可能性，是否有任何免费或开源工具可以做到这一点？我更喜欢这种解决方案，因为可以产生大量数据。我希望您有一个想法，手动创建测试数据将非常耗时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:19:38.993

RedGate Sql Data Masker [http://www.red-gate.com/labs/sql-data-masker/](http://www.red-gate.com/labs/sql-data-masker/)是针对这个问题设计的，但它不是免费的，也不是开源的。您可以循环进入一些随机化函数以生成大量垃圾，尽管听起来您正在寻找“购买”而不是“构建”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T11:28:56.993

There are various points to consider when masking. For example:

*   do you know where ALL the sensitive data resides within the database;
*   how important is referential integrity;
*   is consistency over time and across databases required;
*   to what extent are you hoping to de-identify each data;
*   do you really need to mask the entire database?

If you are able to manually satisfy these items, then it's great! However, if you are looking to get this done in a timely manner while keeping the cost down (not to mention protecting the company and its database from exposure), I suggest you take a look at the Best Practices to Data Masking on www.datamasking.com

Hope this helps!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T16:00:01.123

如果您通过 DAO（数据访问对象）访问数据，您可以创建该对象的模拟来测试您的代码，我在项目中使用了 Mockito。如果您正在测试的代码直接访问数据库，您必须将其指向某种“测试数据库”......

模拟的一个额外功能是所谓的 spy-objects，它是一个围绕底层真实对象的模拟，您可以在其中使用测试代码覆盖一些方法，即禁用删除、创建掩码等，而所有非模拟- 覆盖的方法直接传递给底层的真实对象...查看：[http ://docs.mockito.googlecode.com/hg/latest/org/mockito/Mockito.html](http://docs.mockito.googlecode.com/hg/latest/org/mockito/Mockito.html)

# forms - 在 Ajax 事件上呈现表单内容

> ID：10365059
> 
> 赞同：2
> 
> 时间：2012-04-28T15:45:13.790
> 
> 标签：forms, jsf, layout, jsf-2, primefaces

您如何解决这个常见问题？假设您需要根据某些 Ajax 事件（但不是整个表单）呈现几个表单元素，并且您不想破坏表单布局。这是示例代码

```
<h:form>
    <h:panelGrid columns="2">
        text1
        <h:inputText value="asasd" />
        text2
        <h:inputText value="asdasd" />
        <p:selectBooleanCheckbox value="#{bean.myBoolean}">
            <p:ajax update="someId" listener="{bean.changeValueOfMyBoolean"} />
        </p:selectBooleanCheckbox>
        <h:outputText value="asdas"rendered="#{bean.myBoolean}" />
        <h:inputText value="bean value" rendered="#{bean.myBoolean"} />
        ...few more some elements 
```

所以我只看到两个选项，把它们放进去`<h:panelGroup>`，给它们一个 id 并`<h:panelGrid>`在里面创建另一个（这会破坏表单布局，因为新渲染的元素会有不同的缩进）或者给每个元素它自己的具有不同 id 的 paneGroup 然后在`<p:ajax>`使用这样的东西，`update=id1, id2, ...`但在我看来这也不是一个好的解决方案。

那么你的方法是什么，有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:00:31.260

您要么在更新中提供要更新的所有 ID，要么

您可以为所有具有共同点的相关组件提供 ID，例如

inputText1、inputText2、inputText3 等

然后在您的托管 bean 中有一个变量，它将返回所有这些元素的 id。

在 ajax 事件中，设置值（您可以使用正则表达式来获取视图中的所有 id）。

但我认为这是一种迂回的方式，因为这需要访问服务器，而不是我会将 id 放在更新中。

# xamarin.ios - MonoTouch 和 MonoDroid 中的崩溃报告

> ID：10365061
> 
> 赞同：3
> 
> 时间：2012-04-28T15:45:18.193
> 
> 标签：xamarin.ios, xamarin.android, mvvmcross

我正在使用 Mvvmcross、Mono for Android 和 MonoTouch 编写一个跨平台应用程序。在我正在移植的 Java Android 应用程序中，我使用 ACRA 来提供崩溃报告和临时报告。这些报告通过 HTTP Post 发送到我们的服务器。

Mvvmcross 是否有任何崩溃报告插件？Mono* 社区能否推荐任何崩溃报告库？

如果似乎什么都没有，其他开发人员是如何处理这个问题的？他们如何捕获未捕获的应用程序异常和 Android ANR 以便触发报告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T18:51:49.427

以前我在 MonoDroid 应用程序上工作，并将[Crasher](https://github.com/soundnRg/Crasher)构建为 ACRA 的端口。但是由于 Mono 的某些特性，特别是 .NET，ACRA 的某些功能无法在 MonoDroid 中实现。如果它对你有帮助，我会很高兴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-29T12:31:22.877

我在这方面的唯一经验是使用 Flurry - 我们仅将其用于分析，而不用于崩溃报告。

基本上我们所做的是使用 IAnalytics 接口记录 ViewModel 中的所有重要事件，然后每个平台都提供了 IAnalytics 的实现，例如：

WP7：

```
public class FlurryAnalytics : IAnalytics
{
    public const string ApiKeyValue = "--- your key ---";

    public void StartSession()
    {
        FlurryWP7SDK.Api.StartSession(ApiKeyValue);
    }

    public void LogEvent(string eventName)
    {
        FlurryWP7SDK.Api.LogEvent(eventName);
    }
} 
```

触摸（与[https://github.com/kevinmcmahon/monotouch-libs/blob/master/FlurryAnalytics/flurry.cs](https://github.com/kevinmcmahon/monotouch-libs/blob/master/FlurryAnalytics/flurry.cs)等绑定一起使用）：

```
public class FlurryAnalytics : IAnalytics
{
    public const string ApiKeyValue = "37SHD8L8VATPBS88AMHU";

    public void StartSession()
    {
        FlurryAPI.StartSession (ApiKeyValue);
    }

    public void LogEvent(string eventName)
    {
        FlurryAPI.LogEvent(eventName);
    }
} 
```

Android（有点复杂——它需要一个活动的每次开始/停止的钩子）：

```
public class FlurryAnalytics : IAnalytics, IAndroidActivityTracker
{
    public const string ApiKeyValue = "--- your key ---";

    private readonly IntPtr _flurryClass;
    private readonly IntPtr _flurryOnStartSession;
    private readonly IntPtr _flurryOnEndSession;
    private readonly IntPtr _flurryLogEvent;

    public FlurryAnalytics()
    {
        _flurryClass = JNIEnv.FindClass("com/flurry/android/FlurryAgent");
        _flurryOnStartSession = JNIEnv.GetStaticMethodID(_flurryClass, "onStartSession",
                                                         "(Landroid/content/Context;Ljava/lang/String;)V");
        _flurryOnEndSession = JNIEnv.GetStaticMethodID(_flurryClass, "onEndSession", "(Landroid/content/Context;)V");
        _flurryLogEvent = JNIEnv.GetStaticMethodID(_flurryClass, "logEvent", "(Ljava/lang/String;)V");
    }

    public void StartSession()
    {
        // not used in Android - Android relies on Activity tracking instead
    }

    public void LogEvent(string eventName)
    {
        ExceptionSafe(() => JNIEnv.CallStaticVoidMethod(_flurryClass, _flurryLogEvent, new JValue(new Java.Lang.String(eventName))));
    }

    private static void ExceptionSafe(Action action)
    {
        try
        {
            action();
        }
        catch (ThreadAbortException)
        {
            throw;
        }
        catch (Exception exception)
        {
            UITrace.Trace("Exception seen in calling Flurry through JNI " + exception.ToLongString());
        }
    }

    public void OnStartActivity(Activity activity)
    {
        ExceptionSafe(() => JNIEnv.CallStaticVoidMethod(_flurryClass, _flurryOnStartSession, new JValue(activity), new JValue(new Java.Lang.String(ApiKeyValue))));
    }

    public void OnStopActivity(Activity activity)
    {
        ExceptionSafe(() => JNIEnv.CallStaticVoidMethod(_flurryClass, _flurryOnEndSession, new JValue(activity)));
    }
} 
```

* * *

从 Flurry 文档和一些博客中，我相信这可以扩展到包括崩溃报告：

*   [http://www.thomashajcak.com/solutions-for-crash-reporting-flurry/](http://www.thomashajcak.com/solutions-for-crash-reporting-flurry/)
*   [适用于 Android 的 Flurry 错误报告](https://stackoverflow.com/questions/2118946/flurry-error-reporting-for-android)

但如果不尝试，我不知道它在 MonoDroid 和 MonoTouch 中的效果如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T10:42:12.807

我们正在使用[HockeyApp](http://hockeyapp.net) iOS SDK（我相信他们也有适用于 Android 的 SDK）。
我们还采用[了此修复程序](https://stackoverflow.com/a/14499336/458193)，因为它对在 MonoTouch 中工作的记者崩溃至关重要。

# java - java 类与自身的关联

> ID：10365062
> 
> 赞同：0
> 
> 时间：2012-04-28T15:45:20.833
> 
> 标签：java, associations

我是 Java 新手，并且正在与关联作斗争。我有一堂课

```
public class A{
  private string name;

  public string get_name() {
    return name;
  }

  public void set_name(string name) {
    name = name;
  }
} 
```

我与另一个 B 类有关联`association A -> B`。这是一对一的关联。现在我想做的是创建另一个`C`类型的类`class A`。换句话说，C 与 A 是同一个类，但名称不同。但是 A 和 C 之间存在一对多的关联。我将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T15:50:39.397

如果`C` **是** `A`不同的名称，为什么不初始化一个实例`A`并命名它`C`？

```
A c = new A();
c.set_name("Bob"); 
```

或者，如果`C`会随着时间的推移而改变，但依赖于`A`make `C`extend`A`

```
public class C extends A{

} 
```

但是，我会警惕使用上述内容，因为将超类具体化通常是一个坏主意（如果 A 发生更改而您不希望 C 继承这些更改怎么办？）。因此，创建`A`一个接口/抽象类并同时创建`C`并`Aconcrete`实现它。

像下面这样的东西会很好......

```
abstract class A{
  protected String name; //Protected so that subclasses can call it

  public String get_name() {
     return name;
  }

  public void set_name(String name) {
    this.name = name;
  }

}

class C extends A{

}

class Aconcrete extends A{

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T15:51:20.950

如果我理解你的问题是正确的，这就是你想要的：

```
public class A{
  private Collection<A> myCs;
  private string name;

  public string get_name() {
    return name;
  }

  public void set_name(string name) {
    this.name = name;
  }
} 
```

`myCs`在课堂上拥有 Collection`A`是您的一对多关联。如果`C`它具有与`A`.

*顺便说一句：您代码中的设置器有一个错误。我已经在上面修复了。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T15:56:12.763

您不需要第二类 - 您可能需要第二个（以及 100 多个）对象。一个典型的例子是像树一样的递归数据结构，它由节点组成：

```
public class Node {
  private List<Node> childs = new ArrayList <Node> ();

  public boolean isLeaf () {
    return childs.isEmpty ();
  }

  public void add (Child c) {
    childs.add (c);
  }
} 
```

（简化）

编译器在构造这样一个类时没有问题，它使用了当时还没有准备好的定义。

也许编译器的开发者有。:)

# facebook - 用于将帖子发送到我自己的墙上的 PHP 代码

> ID：10365063
> 
> 赞同：-1
> 
> 时间：2012-04-28T15:45:21.390
> 
> 标签：facebook, facebook-php-sdk

场景如下：

*   我已登录 Facebook
*   我有自己的网页，带有输入框和提交按钮
*   当我单击提交按钮时，我希望将输入框的内容发布在我的 OWN 墙上。

我不想在 facebook 上创建一个应用程序来做到这一点。我的目标是，任何使用我的网页并且当前使用自己的凭据登录 Facebook 的用户都能够在自己的墙上发帖。

我非常感谢实现此功能的任何帮助或指导（步骤）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T15:51:00.123

您需要将您的用户重定向到 Facebook（或打开一个新窗口），以便让他们分享墙帖。

```
https://www.facebook.com/sharer.php?u=<url to share> 
```

没有他们批准您的申请/没有申请，就无法仅发布消息/状态

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T15:56:57.347

没有简单的方法可以做到这一点，因为如果任何网站可以发布到访问该网站的访问者的墙上，那么 Facebook 用户最终会在他们的墙上收到大量垃圾邮件。

你应该看的是这个
[http://www.barattalo.it/2010/01/17/posting-to-facebook-from-website-with-facebook-connect/](http://www.barattalo.it/2010/01/17/posting-to-facebook-from-website-with-facebook-connect/)

在那里你会找到你需要使用的代码，并解释要做什么，以及为什么必须这样。

希望这对您有所帮助。

# c# - System.dll 中的 System.ServiceModel.FaultException

> ID：10365064
> 
> 赞同：1
> 
> 时间：2012-04-28T15:45:24.470
> 
> 标签：c#, windows-phone-7, faultexception

我正在尝试使用 Windows Phone SDK 7.1 使用远程 ASP.NET WebMethod 我有以下 C# 代码：

```
public static PublicServices.RegisteredServicesSoapClient taarafClient;

App.taarafClient.FetchStreamCompleted +=
  new EventHandler<PublicServices.FetchStreamCompletedEventArgs>(
  taarafClient_FetchStreamCompleted); 
```

运行此代码时，我在标题中遇到异常。

我正在使用服务参考：例外情况在这里：

```
public Taaraf.PublicServices.FetchStreamResponse EndFetchStream(
  System.IAsyncResult result)
{
    object[] _args = new object[0];
    Taaraf.PublicServices.FetchStreamResponse _result =
      (Taaraf.PublicServices.FetchStreamResponse)
      base.EndInvoke("FetchStream", _args, result);
    return _result;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-01T02:11:43.000

根据`InnerException`您提供的详细信息，服务器正在抛出`NullReferenceException`. 这是您控制的服务吗？要确认它是服务——而不是 WP7 的服务客户端——尝试创建一个简单的控制台应用程序，传入相同的值，并查看它是否会产生相同的错误。

但对我来说，它肯定看起来像错误在**服务器**端。通过创建一个简单的控制台应用程序，您有望消除它成为 WP7 特定问题和需要在服务中修复的更普遍问题。

# javascript - 页面内的Javascript重定向方法

> ID：10365066
> 
> 赞同：0
> 
> 时间：2012-04-28T15:45:40.830
> 
> 标签：javascript, jquery, ajax

在 Ajax 请求之后，我正在寻找一种在我的页面中重定向的好方法

如果成功，我想转换当前的 uri (location.href)

```
http://my.domain.com/jm/app.html?application=test&keyword=pp&data=&enum=&end= 
```

进入

```
http://my.domain.com/jm/app.html#Results?application=test&keyword=pp&data=&enum=&end= 
```

所以在uri路径之后添加#Results，但我想保留查询字符串，找到一个正则表达式可能很难看，并将其应用于location.href

是否有 jquery 方法来浏览内部页面？
像

```
$.redirectTo("Results") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T15:53:44.523

你看过[location.hash](https://developer.mozilla.org/En/DOM/Window.location)属性吗？

附带说明一下，这个插件对于检测散列的变化非常有用，然后对其做出反应。[jQuery hashchange](https://github.com/cowboy/jquery-hashchange)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:02:23.360

我建议使用[History.js](https://github.com/balupton/History.js/)或[jQuery BBQ](http://benalman.com/projects/jquery-bbq-plugin/)。它们都为 HTML5 pushState 提供了良好的支持，并为 HTML4 浏览器提供了回退（使用类似于您的示例的哈希）。jQuery BBQ 也有一些[很好的函数](http://benalman.com/code/projects/jquery-bbq/docs/files/jquery-ba-bbq-js.html)来处理查询字符串。

这是基本思想（使用 History.js）。成功后，您可以像这样更新位置：

```
var newUrl = "/app.htmlapplication=test&keyword=pp&data=&enum=&end=";

// Make AJAX request ...

// On success
History.pushState({}, null, newUrl); 
```

您还需要为状态/哈希更改事件实现侦听器。使用 History.js，它看起来像这样：

```
History.Adapter.bind(window, 'statechange', function() {
    // The user probably hit the back button, do something...
}); 
```

我的示例非常简短，因此请快速查看每个插件的文档，看看哪个最适合您的项目。

# ruby-on-rails - Rails 中的模型结构

> ID：10365070
> 
> 赞同：0
> 
> 时间：2012-04-28T15:46:03.320
> 
> 标签：ruby-on-rails

我对 Rails 比较陌生，我正在尝试为我的应用程序找出理想的模型结构，这是一个简单的家庭维护提醒服务。应用程序的中心模型是 Home。

每个家庭都有许多电器（即洗碗机、洗衣房、热水器等）。

每个电器都有一组与之相关的提醒（即，如果你有热水器，你必须每 3 个月做一次 XYZ，每 6 个月做一次 ABC）。

定期（每月/每周）会向房主发送一封邮件，其中包含所有提醒的列表。

我正在尝试为此找出最佳模型结构。

现在，这些是我拥有的模型，但我不知道这是否矫枉过正？

*   家（地址、邮政编码等）
*   电器（名称、制造商）
*   提醒（Appliance_ID、提醒、频率）
*   家用电器（Home_ID、Appliance_ID）
*   HomeReminders (Home_ID, Reminder_ID)

协会：

*   首页 has_many HomeAppliances
*   设备 has_many 提醒
*   首页 has_many HomeReminders

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:02:53.597

我会选择不那么复杂的东西。你需要三个模型：

```
class Home < ActiveRecord::Base
  has_many :appliances
  has_many :reminders, :through => :appliances
end

class Appliance < ActiveRecord::Base
  belongs_to :home
  has_many :reminders
end

class Reminder < ActiveRecord::Base
  belongs_to :appliance
end 
```

请注意，我们使用`has_many :through`关系来允许我们`home.reminders`直接调用。

有关更多信息，请参见此处的文档示例：http `has_many :through`: [//guides.rubyonrails.org/association_basics.html#the-has_many-through-association](http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association)

在您的原始示例中，您似乎希望将各种预定义的设备存储在数据库中以供参考。我会做不同的事情。拥有一个包含各种品牌和型号的配置文件，您可以使用这些配置文件来填充用户在设置其设备详细信息时使用的表单上的下拉菜单。然后您可以跳过额外的模型并如上所述简化事情。

# xcode - xCode 4.3 无法读取快照

> ID：10365075
> 
> 赞同：4
> 
> 时间：2012-04-28T15:46:21.297
> 
> 标签：xcode

尝试恢复快照时，我从 xCode“无法读取快照”中收到此错误。这发生在恢复之前的快照之后。此外，当我恢复该快照时，它与当前项目混淆了，把所有东西都搞砸了。现在我坐在一个破碎的项目上。

我在哪里可以找到快照文件或者有什么方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T23:11:24.570

我没有尝试过任何这些，但这个答案指出了如何恢复快照： [Xcode snapshots](https://stackoverflow.com/questions/2359097/xcode-snapshots)

# ios - 创建 iOS 药丸提醒：如何处理 UILocalNotification 的特价重复间隔？

> ID：10365076
> 
> 赞同：1
> 
> 时间：2012-04-28T15:46:29.597
> 
> 标签：ios, uilocalnotification

我必须创建一个药丸提醒，通过本地通知向用户发出警告。用户可以使用不同的参数设置药丸时间：

*   开始日期
*   结束日期
*   小时
*   特定的工作日

我对如何使用本地通知管理这些参数有一些疑问：

**开始日期：**

好的，开始日期将是`firedate`属性

**结束日期：**

如何在特定日期停止重复？我认为独特的方法是在开始-结束日期范围内创建每个通知而不重复。

**特定工作日**

如果用户想设置星期一和星期五，我是否可以使用 2 个不同的通知来管理这 2 天，每周重复一次，并且解雇时间等于第一个可用的“星期一”/“星期五”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T16:45:24.720

**开始日期**

是的，`fireDate`会成功的。

**结束日期**

如您所说，您可以在该范围内创建通知。由于您可能正在使用该`repeatInterval`属性，因此您需要另一种方法来设置“结束日期”。

**特定工作日**

是的，这就是这样做的方法。您无法设置自己的重复间隔，因此为星期一设置一个通知，在星期五设置另一个通知就可以了。

**我的推荐**

看来您将在通知中使用非常特定的间隔。该`repeatInterval`属性有一个巨大的限制，因此您必须找到一种方法来处理所有通知，而不会达到**预定通知的 64 个限制**（请参阅 Apple 文档）。

**这些是选项：**

1.如果您认为您的用户不会同时安排超过 64 个通知，请安排范围内的所有通知。虽然，这很危险，因为大多数时候我们不知道用户需要多少通知。

2.另一种选择是使用通知队列，检查剩余的通知数量，并在需要时安排更多通知。这种方式比较好，因为真的很难达到极限。我在这里解释如何做到这[一点。](https://stackoverflow.com/questions/10341476/fire-local-notification-every-day-on-different-times/10343323#10343323)

# c# - 如何创建一个每次返回不同值的随机函数？

> ID：10365082
> 
> 赞同：-3
> 
> 时间：2012-04-28T15:46:54.017
> 
> 标签：c#, random, while-loop

我正在尝试编写一个返回随机数的随机函数，该随机数不同于它返回的最后 5 个不同的数字。

我在 excel VBA 中使用的一个非常相似的代码：

```
 Function Rand(ByVal Low As Long, ByVal High As Long) As Long
Randomize
    Num3 = Num2
    Num2 = Num1
  Rand = Int((High - Low + 1) * Rnd) + Low
  Num1 = Rand

 Do While Num1 = Num2 Or Num1 = Num3 Or Sheets(Csheet).Cells(Num1, 3) > 20

      Rand = Int((High - Low + 1) * Rnd) + Low
     Num1 = Rand
  Loop
End Function 
```

该数字还需要检查 heb[i].Known 处的单词是否为假。我试过这个：

```
private int Rand(int Min, int Max)
        {
            int i;
            int x = 0;
            Random rnd = new Random();
            oldNum[3] = oldNum[2];
            oldNum[2] = oldNum[1];
            oldNum[1] = oldNum[0];
            do
            {

                i = rnd.Next(Min, Max);
                x++;
            }
            while (Heb[i].Known==false && x<10000 && oldNum.Contains(i));
            oldNum[0] = i;
            return i;

        } 
```

尽管如此，它似乎并没有很好地配合......它每次都返回0。

Min 和 Max 是它随机化的列表中的范围（应该在 1 -30 之间） Heb 是列表中的项目数（大约 500 - 1000 个项目）我初始化 oldNum 为：

```
 int[] oldNum = new int[3]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T15:57:07.583

听起来你需要一个`Queue`！

```
Random rng = new Random();
Queue<int> queue = new Queue<int>();

private int Rand(int min, int max)
{
    int r;

    while(queue.Contains(r = rng.Next(min, max)));

    queue.Enqueue(r);

    if(queue.Count > 5) queue.Dequeue();

    return r;
} 
```

# c - glibc 函数检索当前的可执行文件名？

> ID：10365086
> 
> 赞同：14
> 
> 时间：2012-04-28T15:47:14.593
> 
> 标签：c, gcc, glibc, addr2line

我想知道是否有一个可以从 gcc/g++ 中使用的 glibc 函数来检索当前的可执行文件。

这样做的目的是提供 -e 参数， `addr2line`如[本答案所示](https://stackoverflow.com/questions/3151779/how-its-better-to-invoke-gdb-from-program-to-print-its-stacktrace/4611112#4611112)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-28T16:15:31.963

在标准 C 和 glibc 中，您有 argv[0]：

```
int main (int argc, char *argv[]) 
```

数组的第一个元素`argv`是程序名称。

然而，仅靠它自己来确定可执行文件的确切位置并不一定足够。该参数实际上是由运行您的程序的程序设置的——无论是外壳程序还是窗口管理器——它们并不是很有帮助。如果您的程序在路径中并且您只需使用

你的程序

在 bash shell 中，您将在 argv[0] 中获得“your_program”。

对于完整的可执行路径，linux 有[`/proc`filesystem](http://www.google.com/url?sa=t&rct=j&q=proc%20file%20system&source=web&cd=1&ved=0CDAQFjAA&url=http://en.wikipedia.org/wiki/Procfs&ei=lxWcT_TuLYuhiQf3r8i2Dg&usg=AFQjCNH-500OsbXNXjVZWX1AnVXUHvm62A&cad=rja)。在`/proc`每个正在运行的进程下都有自己的“目录”，由它的进程 ID 命名。正在运行的进程也可以在`/proc/self`. 每个进程获得的文件之一是`/proc/[pid]/exe`，它是指向进程正在运行的实际可执行文件的符号链接。

因此，您可以像这样获得实际的完整可执行路径：

```
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <unistd.h>

int main(void) {
    char exe[1024];
    int ret;

    ret = readlink("/proc/self/exe",exe,sizeof(exe)-1);
    if(ret ==-1) {
        fprintf(stderr,"ERRORRRRR\n");
        exit(1);
    }
    exe[ret] = 0;
    printf("I am %s\n",exe);
} 
```

您也可以`/proc/[pid]/exe`直接传递给`addr2line()`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-21T19:15:23.997

您可以在不引用实际变量的情况下访问 argv[0]，方法是使用 glibc 中保存的指针：[https ://sourceware.org/git/?p=glibc.git;a=blob;f=misc/init- misc.c;h=2a1b82710ec8b42b4dac6edb359d8920f902cd21;hb=HEAD](https://sourceware.org/git/?p=glibc.git;a=blob;f=misc/init-misc.c;h=2a1b82710ec8b42b4dac6edb359d8920f902cd21;hb=HEAD)

示例用法：

```
extern const char *__progname;

int print_progname()
{
    return puts(__progname);
} 
```

argv[0] 不一定反映用于调用程序的名称。有关详细信息，请参阅*man 2 execve*和*man 7 environ*。

# image-processing - 从眼睛的图像进行凝视估计

> ID：10365087
> 
> 赞同：9
> 
> 时间：2012-04-28T15:47:22.060
> 
> 标签：image-processing, opencv, computer-vision, human-computer-interface, eye-tracking

到目前为止，我已经能够准确地检测到瞳孔和眼角。您可以在这里看到我在回答我自己的问题时上传的一些快照：

[执行稳定的眼角检测](https://stackoverflow.com/questions/9645871/how-to-perform-stable-eye-corner-detection)

这是我到目前为止所做的。我通过查看 TLCP、TRCP 和 BLCP 来校准用户的视线，其中

```
CP = calibration point; a screen point used for calibration
B = bottom
T = top
L= left
R = right
gaze_width = TRCP.x - TLCP.x

gaze_height = BLCP.y- TLCP.y 
```

而我通过看那些CP得到的对应凝视点被称为GP

凝视点GP的计算：

我从当前瞳孔中心的位置减去 TLGP 的纵坐标值，因为注视点必须落在我希望你理解的假设矩形中，它真的很简单。

我使用基本缩放系统将从瞳孔中心位置计算的凝视点线性映射到屏幕点，其中比例计算如下：

```
scaleX = screen_width/gaze_width
scaleY = screen_height/gaze_height 
```

对于任何注视点 P(x,y)，我将相应的屏幕点 Q(m,n) 计算为：

```
m = scaleX*x
n = scaleY*y 
```

但问题是，即使在几乎完美的瞳孔检测之后（几乎是因为在光线不足的情况下它会产生误报。但我打算将其置于限制之下，因为我无法处理它，我没有足够的时间），我' m 的视线宽度和视线高度仍然很差。

这是一个测试运行日志：

```
DO_CAL= True

Gaze Parameters:

TLGP = (38, 26) | TRGP = (20, 22) | BLGP = (39, 33)
screen height = 768 screen width = 1366

gaze height = 7 gaze width = 18

scales: X = 75.8888888889 | Y = 109.714285714
Thing on = True

Gaze point = (5, 3)
Screen point: (987, 329)

Gaze point = (5, 3)
Screen point: (987, 329)

Gaze point = (7, 5)
Screen point: (835, 549)

Thing on = False

TLGP = (37, 24) | TRGP = (22, 22) | BLGP = (35, 29)
screen height = 768 screen width = 1366

gaze height = 5 gaze width = 15
scales: X = 91.0666666667 | Y = 153.6
Thing on = True

Gaze point = (12, 3)
Screen point: (1093, 461)

Gaze point = (12, 3)
Screen point: (1093, 461)

ESC pressed 
```

只需查看注视点及其对应的注视检测屏幕点（在它们下方）。x,y 坐标值的巨大差异让我抓狂。星期一是最后的演讲。

在这种方法之后，我理论化了另一种方法：

校准与第一种方法相同。我会检测凝视的运动及其方向。假设给定瞳孔中心位置的任意两个点 P 和 Q，其中 P 是第一个注视点，Q 是第二个注视点，然后我们计算线 PQ 的方向和长度。 ![用于注视估计的推式方法](../Images/7f865f25c18a1c91ec2321e4fceca36d.png)

假设这条线段的长度是 L。然后我们将 L 缩放到屏幕比例，假设 L 是屏幕比例中的 D，并且给定注视移动的方向，我们将屏幕上的光标从其最后一个静止点移动，说R，D距离，到一个新的点S，该点将被计算为长度为D的线段的终点，和起点S。形象化的表示如图所示。因此，基本上，我不会将任何凝视数据映射到屏幕点，我基本上是跟踪凝视，并将其转换为“推送”以应用于屏幕上的光标。但我还没有实现它。因为它实际上并没有将视线映射到屏幕坐标，因此可能是错误的。这个理论的动机来自于 sourceforge 上的 eViacam 项目——它们基本上跟踪你的脸，并相应地移动鼠标。在校准中，他们只是计算你的脸沿着轴移动了多少。

**底线**：因此，如果你们中的任何人对如何从完美处理的眼睛图像中检测用户的注视有任何想法 -**一个检测到瞳孔中心和眼角的**图像，请告诉！我只有大约一天的时间，我知道已经很晚了，但我只需要任何可以帮助我的神奇想法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T22:20:19.197

这不是答案，但不可能作为评论发表。你回答后我会删除它。

你确定你有所有必要的参数吗？

考虑下图：

![在此处输入图像描述](../Images/25db8e0f9dc2575f113d42fb67745e0c.png)

如果您的相机检测到 {K, J, Q} 处的角和瞳孔，您如何区分另一个三元组 {F, E, O}？请注意，测量值是相同的，但由黑色箭头表示的注视方向完全不同。

注意：两条黑线和红线是从单个相机点绘制的，位于可见区域之外。

# java - 等待/通知和条件如何管理线程

> ID：10365094
> 
> 赞同：0
> 
> 时间：2012-04-28T15:48:31.817
> 
> 标签：java, multithreading, concurrency

我了解`wait()`and`notify()/notifyAll()`方法的目的是替换其他语言中使用的传统循环/轮询结构：

```
while(true) {
    if(pollSomethingForAnEvent())
        break;
} 
```

我进一步了解，`Condition`API 是在 Java 5 中引入的，以便将此模型包装在更“OO”的实现中。

我**不明白**`Object.notify()`的是Java如何知道在何时或被`Condition.signal()`调用时通知哪些线程，或者Java如何知道向哪些线程发出信号`Object.wait()`或被`Condition.await()`调用？

由于这些方法不接受任何参数，JVM 怎么知道将这些通知传递给哪些线程？！？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T15:52:49.367

对于每个`Condition`或同步对象，JVM 维护一个等待它们的对象队列。它还具有运行队列和其他维护和管理`Thread`运行状态的数据结构。

当`Object.notify()`被调用时，它只是在与对象关联的队列中查找第一个`Thread`并将其移动到运行队列。如果队列为空，则不通知线程。如果`notifyAll()`被调用，那么所有等待该对象的线程都会收到信号。

不要让事情复杂化，但需要意识到的重要一件事是，当通知`Thread`调用的 a 时`lockObject.wait()`，它会从等待状态移动到运行队列的*末尾*，等待访问 lock on `lockObject`。它不会立即开始运行。

# r - 意想不到的结果：微基准

> ID：10365108
> 
> 赞同：9
> 
> 时间：2012-04-28T15:50:45.143
> 
> 标签：r, microbenchmark

我总是被我看到基准标记和`system.time`和`rbenchmark`（因为时间的精度可能缺乏）缺乏准确性而有点困扰，并且`microbenchmark`最近看到哈德利参考了这个包。所以我决定试一试，如下所示。我`mean`反对`f <- function(x) {sum(x)/length(x)}`并期望`mean`做得更好，`f`但据我了解，结果并不表明这是真的。

1.  我误解了结果吗？
2.  f 实际上比平均值快吗？
3.  微基准测试是否仍处于测试阶段，是否需要解决？

我在 win 7 机器上运行 R2.15（因为 microbenchmark 的计时取决于您的操作系统）。

**结果**

```
Unit: microseconds
     expr    min     lq median     uq    max
1    f(x) 19.130 20.529 20.529 20.996 286.00
2 mean(x) 28.927 29.860 30.327 30.327 672.31 
```

**编码**

```
library(microbenchmark)

x <- 1:10000
f <- function(x) {sum(x)/length(x)}
mean(x)

res <- microbenchmark(
    mean(x), 
    f(x), 
times=1000L)

print(res)
boxplot(res) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-28T16:07:55.363

我可能是错的，但这对我来说似乎并不那么令人惊讶。在`mean.default`可以调用`.Internal(mean(x))`它之前必须检查 3 个`if`语句，计算 的长度`x`，然后检查另一个`if`语句。而且时间上的差异相当小。

直接调用`.Internal(mean(x)`还是稍微快一些：

```
library(microbenchmark)

x <- 1:10000
f1 <- function(x) {sum(x)/length(x)}
f2 <- function(x) {.Internal(mean(x))}

res <- microbenchmark(
    mean(x), 
    f1(x),
    f2(x), 
times=1000L)

print(res)

Unit: microseconds
     expr    min      lq  median      uq     max
1   f1(x) 32.195 32.4605 32.8850 33.4645 106.997
2   f2(x) 21.840 22.0580 22.2015 22.6270  55.316
3 mean(x) 35.393 35.9840 36.1860 36.4420  91.203 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T16:15:05.533

我想你会发现，如果你将 X 的大小增加 10 倍，你会看到更一致的结果。老实说，如果您真的可以在具有多任务操作系统的计算机上获得微秒计时精度，我会感到惊讶。

您还可以考虑：

*   您是在笔记本电脑上运行还是在具有自动 CPU 频率缩放功能的机器上运行？
*   暖身？
*   将您的流程固定在一个核心上。

# gcc - nm 输出中@12 的含义

> ID：10365112
> 
> 赞同：1
> 
> 时间：2012-04-28T15:51:17.023
> 
> 标签：gcc, linker

在 Linux 环境中，使用 gcc 编译，我无法链接到库，因为我的函数（我们称之为`test()`）没有被链接。此函数的“nm”输出如下：

```
0x00000000 T _test@12 
```

我认为这`@12`是我所有问题的原因。

有谁知道是什么`@12`意思以及它是如何到达那里的？我会期待一个“ `_test`”而不是“ `_test@12`”。

# algorithm - 一个非常大的数据集的平均值和标准差

> ID：10365119
> 
> 赞同：23
> 
> 时间：2012-04-28T15:51:59.100
> 
> 标签：algorithm, statistics, mean, numerics, large-data

我想知道是否有一种算法可以计算未绑定数据集的平均值和标准差。

例如，我正在监控一个测量值，比如电流。我想获得所有历史数据的平均值。每当有新值出现时，更新均值和标准差？因为数据太大而无法存储，我希望它可以在不存储数据的情况下即时更新均值和标准差。

即使存储数据，标准方式（d1 + ... + dn）/n也不起作用，总和会破坏数据表示。

我通过大约 sum(d1/n + d2/n + ... d3/n)，如果 n 是休，则误差太大并累积。此外，在这种情况下，n 是未绑定的。

数据的数量肯定是无限制的，无论什么时候来，都需要更新值。

有人知道是否有算法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-28T15:56:31.837

【问题变了吗？也许我只看了开头。我已更新/编辑以提供更好的答复：]

我知道没有完美的解决方案（在不断的记忆中），但我可以提供各种方法。

首先，对于基本计算，您只需要所有值`sum_x`的总和 ( )、它们的平方和 ( `sum_x2`) 和总计数 ( `n`)。然后：

```
mean = sum_x / n
stdev = sqrt( sum_x2/n - mean^2 ) 
```

并且所有这些值 ( `sum_x`, `sum_x2`, `n`) 都可以从流中更新。

问题（如您所说）是处理溢出和/或有限的精度。如果您考虑浮点何时`sum_x2`如此之大以至于内部表示不包括单个平方值的大小值，您可以看到这一点。

避免该问题的一种简单方法是使用*精确算术*，但这会越来越慢（并且还使用 O(log(n)) 内存）。

另一种可以提供帮助的方法是规范化值 - 如果您知道值通常是`X`那么您可以进行计算`x - X`，使总和更小（显然您然后添加`X`到平均值！）。这有助于推迟精度损失点（并且可以/应该与此处的任何其他方法结合使用 - 例如，在分箱时，您可以使用前一个箱的平均值）。[有关如何逐步执行此操作，](http://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Online_algorithm)请参阅此算法（knuth 的方法） 。

如果您不介意（小常数因子）O（n）内存成本，您可以*重新启动*每个`N`值（例如百万 - 更聪明的方法仍然是通过检测精度何时过低来适应此值），*存储先前的平均值和标准差和然后结合最终结果*（因此您的平均值是最近运行总数和旧分箱值的适当加权值）。

分箱方法可能可以推广到*多个级别*（您开始分箱）并且会减少到 O(log(n)) 内存使用，但我还没有制定出细节。

最后，一个更实际的解决方案可能是对 1000 个值执行初始方法，然后并行开始新的求和。您可以显示两者的加权平均值，然后在另外 1000 个值之后，删除旧的总和（在逐渐减少它们的权重之后）并开始一个新的集合。所以你总是有两组总和，并显示它们之间的加权平均值，这给出了反映最后 1000 个值的连续数据（仅）。在某些情况下，这已经足够好了，我想（这不是一个精确的值，因为它仅适用于“最近的”数据，但它是平滑且具有代表性的，并且使用了固定数量的内存）。

ps，后来我发生了一些事情-实际上，无论如何“永远”这样做并没有多大意义，因为您将到达一个值绝对由旧数据主导的地步。最好使用“运行均值”来减轻旧值的权重。参见例如[https://en.wikipedia.org/wiki/Moving_average](https://en.wikipedia.org/wiki/Moving_average) - 但是，我不知道标准开发的常见等价物。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-28T16:07:24.487

有趣的问题。

让我们先讨论平均值，如果只是因为它更简单一点。

您对运行总计的舍入误差是正确的。对于足够大的数据集，它会降低您的准确性。您想*对*数据进行预排序，先汇总小数据；但在你的情况下，这当然是不可能的。*但是，您可以通过保持多个运行总计*来获得排序数据的大部分好处。

 *C 或 C++ 风格的概念示例：

```
const double max_small  =    0.001;
const double max_medium = 1000.0;

double total_small;
double total_medium;
double total_large;

while(true) {
    const double datum = get_datum(); // (Use here whatever function you use to get a datum.)
    if (!is_datum_valid()) break;
    if (abs(datum) <= max_small) total_small += datum;
    else if (abs(datum) <= max_medium) total_medium += datum;
    else total_large += datum;
}

double total = 0.0;
total += total_small;
total += total_medium;
total += total_large; 
```

在实际代码中，您可能会保留三个以上的运行总计——当然，您还将保持数据平方的运行总计——但上面的示例传达了这个想法。您可以填写详细信息。

此外，采用@andrewcooke 的想法，您可以通过以下方式扩展循环：

```
while(true) {
    const double datum = get_datum();
    if (!is_datum_valid()) break;
    if (abs(datum) <= max_small) {
        total_small += datum;
        if (abs(total_small) > max_medium) {
            total_large += total_small;
            total_small = 0.0;
        }
    }
    else if (abs(datum) <= max_medium) total_medium += datum;
    else total_large += datum;
} 
```

同样，您可以填写详细信息。祝你好运。

**附录：标准差的实际计算**

此处的各种评论线程中提出了一个很好的问题，即如何在不事先了解平均值的情况下计算标准偏差。幸运的是，已知有一个技巧可以计算标准差。我准备了两页的笔记来解释[这里](http://www.derivations.org/stdev.pdf)的技巧（PDF）。

无论如何，在运行统计数据中包含标准差所需要做的就是不仅对数据求和，还对数据的平方求和；当然，正方形可以按照与数据本身类似的方式求和，遵循与上面代码中相同的模式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-28T16:14:35.330

### ~~不。~~

（我想：不，但我被证明是错误的）。

你可以携带总和和计数，这样

```
sum(i)=500, count(i)=50, => avg:=10
next value = 20
sum=520, count=51 => avg:= 10.19 
```

~~但是 stddev 不能那样构建。您必须为每个值生成新平均值的增量，并将它们平方，然后除以 N。~~ 但是：问题是，这些值是什么类型的值（从数学的角度来看 - 远离物理学！ :) )。在正常情况下，我不希望值在 2000 个元素之后发生变化。否则，首先构建 mean 和 stddev 可能会有问题。

而对于 2000 个元素，应该可以快速计算该值。

也许您可以使用缓冲区，并始终为每 2000 个值计算最后 2000 个值的 avg 和 stddev。这是否是有意义的数据是你必须决定的。

* * *

### 我们不能在聊天中继续我们的讨论，...

因为它没有详细说明降价。所以我用我的帖子来澄清我的立场，主要是用 thb 发表评论，但安德鲁似乎也相信 stddev 的滑动计算。

这是一个宽表，可以使计算变得明显且易于理解。这些列是：

*   i：运行指数。我们首先计算值 1-3，然后计算值 1-5。
*   x(i) 是我任意选择的数据。3,4,5 和 4,6
*   sum 就是他们总结的结果。有趣的是组的最后一个：12 和 22。注意：我们不取 3 个值和 2 个值的总和，而是取前 3 个值和前 5 个值的总和。
*   平均值仅为 12/3 或 22/5。如果您知道 i 和 sum，则可以滑动计算 avg。`sum(i+1) = (sum (i)+x(i))/i+1`目前没有争议。
*   为了计算标准差，我们必须将每个值的差值与平均值相乘，并将其平方（从而失去符号，否则会使差值无效 - 它始终为 0）。第二个影响是，与许多小距离相比，很少的大距离会导致更大的 stddev。距离`(1,1,-1,-1)=> 4*1² = 4.`对比：`(2,-2)=> 2² + -2² = 4+4 = 8`。第一列是 3 个值，第二列是 5 个值（按照计算）。
*   下一列（最后一个）² 进行平方。
*   总结一下
*   除以 n-1
*   取平方根

![带计算的电子表格（oocalc 屏幕截图）](../Images/4566d6920028c1534180d7cf9593e039.png)

也许我们可以同意，这是计算标准差的有效方法。现在的问题是，如果您知道完整的第 3 行（x(3)=5 除外）如何计算它，现在您得到两个单独的值 (4, 6)，如工作表所示，但不知道 (x( i) 对于 i = 1、2、3。

## 我的主张失败了：你可以。

好的 - 尝试使用您的公式。

ð² = 1/(N-1) (总和 (x [i] ²) - 1/N (总和 (x [i] ))²)

所以对于我得到的 4 个值

*   N=5
*   总和(x [i] ) = 22
*   总和(x [i] ²) = 102

插入您的公式：

```
ð² = 1/(N-1) (Sum (x<sub>i</sub>²) - 1/N (Sum (x<sub>i</sub>))²)
ð² = 1/4 (102 - 1/5 (22²))
ð² = 1/4 (102 - 1/5 (484))
ð² = 1/4 (102 - 96.8)
ð² = 1/4 (5.2)
ð² = 1.3
ð  = 1.140 
```

**我的结果是 1.14，你的结果是 1.14**所以有一个捷径。非常有趣 - 我仍然感到惊讶。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-01T11:59:33.710

事实上，即使在计算标准差时较小的数据集上，也不应该**计算平方和**。这个问题被称为**[灾难性取消](https://en.wikipedia.org/wiki/Loss_of_significance)**（链接是维基百科）。

维基百科也有两篇文章可以帮助你摆脱这个问题：

*   [Kahan 求和算法](https://en.wikipedia.org/wiki/Kahan_summation_algorithm)，在对大量非常小的值求和时（例如，在对所有 x/n 值求和时）避免系统误差
*   [计算方差的算法](https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Online_algorithm)，特别是“在线”版本应该适用于大型数据集。它将**逐步更新**每个观察值的平均值，因此值保持在数据的范围内！您可能需要对方差使用高阶版本，因为第一个在线算法仍然计算平方和偏差之和，因此对于较大的 n，这可能会破坏您的值范围。高阶版本中的 M2 应该包含平均平方偏差，它在您的输出范围内。

这可能是简单统计计算最常见的问题之一。

请注意，当均值保持在 0 左右时，问题不会发生，远小于方差。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-29T20:21:57.257

所以，我不确定这是否是以前使用过的算法，但无论如何我都会提供它。我的想法是用错误的平均值计算标准偏差，然后根据实际平均值进行校正。这是我写的关于它的图片[![](../Images/a20ab3de621e114396b736d801ebf6f3.png)](https://i.stack.imgur.com/MJcdA.png)*

# php - 识别选中了哪个单选按钮并使用 php

> ID：10365120
> 
> 赞同：0
> 
> 时间：2012-04-28T15:52:00.897
> 
> 标签：php, mysql, html

这是我最新的问题。我已经完成了布局并且一切正常，但现在我正试图找出这部分的 php 方面。我想要做的是如何具体说明使用 php 检查了哪个单选按钮？我尝试使用 $_POST['ins'] （其中 'ins' 是插入按钮的 ID），但这不起作用。我希望它在检查插入按钮时起作用，做任何步骤，但我不知道如何得到它，所以说插入按钮正在被选择/检查。

这是我的代码

```
<html>
<head><title></title>
<script type="text/javascript">

function show()
{
if (document.getElementById('ins').checked){
document.getElementById("p1").style.display = "block"
document.getElementById("zn").style.display = "block";
document.getElementById("p2").style.display = "block"
document.getElementById("gpa").style.display = "block";
document.getElementById("p3").style.display = "none"
document.getElementById("ngpa").style.display = "none";
}
else if (document.getElementById('upd').checked){
document.getElementById("p1").style.display = "block"
document.getElementById("zn").style.display = "block";
document.getElementById("p2").style.display = "none"
document.getElementById("gpa").style.display = "none";
document.getElementById("p3").style.display = "block"
document.getElementById("ngpa").style.display = "block";
}
else {
document.getElementById("p1").style.display = "block"
document.getElementById("zn").style.display = "block";
document.getElementById("p2").style.display = "none"
document.getElementById("gpa").style.display = "none";
document.getElementById("p3").style.display = "none"
document.getElementById("ngpa").style.display = "none";
}
}

function check()
{
    if((document.getElementById("zn").value == "") ||   (document.getElementById("gpa").value == "") ||
    (isNaN(parseFloat(document.getElementById("gpa").value))))
    {
        alert("Please complete both fields and check to see if the GPA entered is a number!");
        return false;
    }
    return true;

}
</script>

</head>
<body>
<form action = "index.php" onsubmit="return check();">
<input type="radio" name="group" id = "ins" onclick ="show()"/> Insert Student <br />
<input type="radio" name="group" id = "upd" onclick ="show()"/> Update Student <br />
<input type="radio" name="group" id = "del" onclick ="show()"/> Delete Student <br />
<p id="p1" style="display:none">Enter Z-number: <br /></p>
<input type='text' name = 'z' id ="zn" maxlength='9' style="display:none"/>
<p id="p2" style="display:none"><br />Enter GPA: <br /></p>
<input type='text' name='gpa' id ="gpa" style="display:none"/>
<p id="p3" style="display:none"><br /> Enter new GPA: <br /></p>
<input type="text" name ="ngpa" id ="ngpa" style="display:none"/>
<br /><input type='submit' value='Submit request' name='submit'/>
</form>
<?php
if (isset($_POST['z'])) {
$con = mysql_connect('localhost', '*****', '***********');
if ($con) {
mysql_select_db('ghamzal', $con);

$a = $_POST['z'];
$b = $_POST['gpa'];
$sql = "INSERT INTO Students VALUES (' $a ' ,  '$b')";

if (mysql_query($sql, $con)) echo 'Operation succeeded';
else echo 'Not succeeded ' .mysql_error();

if (isset($_POST['ins'])) {
$sql = "SELECT * FROM Students";
$res = mysql_query($sql, $con);

echo "<table border ='1'>";
echo "<tr><th>Znum</th><th>GPA</th></tr>";
while ($r = mysql_fetch_array($res)) {
echo "<tr><td>".$r['Znum']."</td><td>".$r['gpa']. "</td></tr>";
}
echo "</table>";
}
mysql_close($con);
}
else {
echo 'Insertion failed'. 'Could not connect to DB.';}

}

?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T16:13:54.657

至于您的问题（如果我没听错的话）-您应该将每个无线电的**value**属性设置为您计划在服务器端代码中识别它时使用的属性，例如：

```
<input type="radio" name="group" value="ins" id = "ins" onclick ="show()"/> Insert Student <br />
<input type="radio" name="group" value="upd" id = "upd" onclick ="show()"/> Update Student <br />
<input type="radio" name="group" value="del" id = "del" onclick ="show()"/> Delete Student <br /> 
```

在服务器端，选择的收音机的值可以通过组名作为 POST 参数访问，在您的情况下：

```
$_POST['group'] 
```

而且..我非常同意eggyal 的评论，并建议您查看准备好的语句（以及一般的SQL 注入）。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T16:12:26.043

这里有几个不同的问题。第一个是您的表单正在使用 GET 方法提交，但您试图在 PHP 中检索您的值，就好像它是使用 POST 方法提交的一样。由于您要更新数据库中的值，因此最好使用 POST 方法，因此您的表单开始标记应更改为：

```
<form method="post" action="index.php" onsubmit="return check();"> 
```

输入的“名称”字段最终出现在您的`$_POST`变量中，该变量的值是所选输入的值。

因此，您应该将输入更改为如下所示：

```
<input type="radio" name="selection" value="ins" id="ins" onclick="show()"/><label for="ins">Insert Student</label><br />
<input type="radio" name="selection" value="upd" id="upd" onclick="show()"/><label for="upd">Update Student</label><br />
<input type="radio" name="selection" value="del" id="del" onclick="show()"/><label for="del">Delete Student</label><br /> 
```

（我添加了`<label>`标记，因为包含它是一种很好的做法。它有​​助于可访问性，如果人们单击单选按钮的标签，它会将其视为单击单选按钮本身。）

现在在您的 PHP 代码中：

```
$selection = $_POST['selection']; 
```

现在`$selection`将包含表示选择了哪个单选按钮的值，您可以执行适当的逻辑：

```
if ($selection == "ins") {
     // do work here
} elseif ($selection == "upd") {
     // do work here
}
// etc. 
```

# objective-c - 是否有使用 Objective-C 将 SVG 图层加载到 Mac OS X 应用程序的库？

> ID：10365121
> 
> 赞同：0
> 
> 时间：2012-04-28T15:52:26.363
> 
> 标签：objective-c, macos, user-interface, interface

我想使用 SVG 格式使用 Objective-C 为我的游戏 ui 设置主题。问题是现有框架可以完成我需要的一切（按名称加载特定的 SVG 图层，非常准确）由于某种原因无法构建，并出现以下错误：

> # 警告
> 
> 函数“NSStringFromCGRect”的隐式声明在 C99 中无效
> 
> # 错误
> 
> _NSStringFromCGRect”，引用自：-[SVGDocument parseAttributes:] in SVGDocument.o Symbol(s) not found for architecture x86_64 Clang: error: linker command failed with exit code 1 (use -v to see invocation)

我不知道其中任何一个是什么意思，但可以肯定地说它使它无法使用。

[我在gottcode](http://gottcode.org/cutemaze/ "http://gottcode.org/cutemaze/")上找到了另一种游戏形式的解决方案；您可能会看到，唯一的问题是它使用的是 QT 框架，而不是 Objective-C。

*   是否可以修复`SVGKit`以使框架编译？
*   可以移植 Qsvg 吗？

如果任何一个问题的答案都是肯定的，那么请指出我正确的方向。

我设法在其中一条评论的帮助下找到了一个有效的，但输出带有绿色色调。有谁知道这可能是什么原因？以及如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T21:43:52.200

`NSStringFromCGRect`是 Core Graphics 的 UIKit 新增功能之一，因此您可能已经尝试构建一个面向 iOS 的库。该特定方法并不难重写，但听起来您可能只是在某处犯了某种选择错误，因为SVGKit[的 Git 存储库](https://github.com/mattrajca/SVGKit)似乎显示了 Mac 目标。我从那里获取了一份副本（使用[下载为 .tar.gz 链接](https://github.com/mattrajca/SVGKit/tarball/master)），在 Xcode 中打开它并点击“我的 Mac 64 位”的构建并收到四个警告，但编译完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T14:33:58.177

SVGKit*几乎*支持 OS X - 但重点是让核心库完全符合 SVG 规范，几乎所有从事它工作的人都只使用 iOS。

所以......有一些地方人们不小心使用了仅限 iOS 的库（尽管我们已经在这里的新分支上熨平了大部分这些库：[https](https://github.com/adamgit/SVGKit/tree/transforms) ://github.com/adamgit/SVGKit/tree/transforms -但该分支目前正在“开发中”）。

如果您在当前 SVGKit 版本中遇到构建错误，这通常意味着您只需在每个错误周围为 IOS 放置一个 #if 构建开关，并将其替换为相同的仅 OS-X 方法（通常相同的名称，但使用 " NS”而不是“UI”）

# ubuntu - Ubuntu 12 上的书店princexml 安装缺少libjpeg 库

> ID：10365124
> 
> 赞同：4
> 
> 时间：2012-04-28T15:52:39.737
> 
> 标签：ubuntu, princexml

我在我的 Ubuntu 12 安装上安装了 bookshop，并按照安装 PrinceXML 的说明进行操作。执行prince时出现以下错误：

> /usr/lib/prince/bin/prince：加载共享库时出错：libjpeg.so.62：无法打开共享对象文件：没有这样的文件或目录

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-29T13:57:53.977

libjpeg 是 libjpeg62 包的一部分，所以先试试这个：

```
@ubuntu~$ sudo apt-get install libjpeg62 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T07:51:37.640

我有同样的问题，只是在使用相同库的不同应用程序中。我的 U12.04 是 64 位的，因此可以安装 32 位的 lib 版本。

```
$ sudo apt-get install libjpeg:32 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-11T15:50:39.337

我的 ubuntu 12.10 和 png2swf 实用程序也有同样的问题。其实，`libjpeg.so.62`不存在的。但这很可能是指向硬文件的链接。

`'locate libjpeg'`除其他外列出

```
/usr/lib/i386-linux-gnu/libjpeg.so.8

/usr/lib/i386-linux-gnu/libjpeg.so.8.0.2 
```

我快速而肮脏的解决方法是在超级用户模式下**创建指向 libjpeg.so.8.0.2 的符号链接**

> ln -s /usr/lib/i386-linux-gnu/libjpeg.so.8.0.2 /usr/lib/i386-linux-gnu/libjpeg.so.62

请记住，某些库在不同版本之间的差异并不大。好吧，我很幸运，但有时简单的修复可能会解决小问题，但并非总是如此。

您可能还希望阅读有关 ldd 命令的信息，并验证缺少的共享库不存在。

# cocoa - NSMenuItem 选择器的放置位置

> ID：10365127
> 
> 赞同：2
> 
> 时间：2012-04-28T15:53:08.477
> 
> 标签：cocoa, user-interface, menu

我试图理解 Cocoa 中的一些东西，但我被困在一件事上。我正在关注[Minimalistic Cocoa Programming](http://cocoawithlove.com/2010/09/minimalist-cocoa-programming.html)，它`NSMenuItem`负责终止应用程序。现在，我想创建另一个`NSMenuItem`带有快捷方式的 ，当按下它时，它`NSLog`是什么东西。但我不知道我应该把所说的选择器的实现放在哪里？我应该将整个子类化`NSApplication`吗？我应该`setDelegate`在某些`NSObject`情况下充当控制器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:13:35.027

您需要创建一个可以用作菜单项目标的类。像这样的东西：

```
@interface Tester : NSObject
@end
@implementation Tester
- (void)logTest:(id)sender
{
    NSLog(@"Test");
}
@end 
```

然后将其设置为目标：

```
id testMenuItem = [[[NSMenuItem alloc] initWithTitle:@"Log Test" action:@selector(logTest:) keyEquivalent:@"l"] autorelease];
id tester = [[[Tester alloc] init] autorelease];
[testMenuItem setTarget:tester]; 
```

# ruby-on-rails-3 - 如何在 jQuery 中对 $.ajax 的 url 参数使用 Rails 3 url_for 方法？

> ID：10365128
> 
> 赞同：0
> 
> 时间：2012-04-28T15:53:12.557
> 
> 标签：ruby-on-rails-3, jquery

我正在使用这个 javascript 代替 remote_action：

```
$(document).ready(function() {
    $('#asset_category_id').change(function() {
        $.ajax({
            url : '<%= escape_javascript(url_for :controller => :categories, :action => :update_subcategories) %>',
    data : 'category_id=' + this.value,
    success : function(data) {
        $('#subcategories_div').html(data);
        $('#subcategories_div').show();
            }
        })
    });
}); 
```

以下行中的 url 格式不正确：

```
url : '<%= escape_javascript(url_for :controller => :categories, :action => :update_subcategories) %>' 
```

它按字面意思使用：

[http://localhost:3000/assets/%3C%=%20escape_javascript(url_for%20:controller%20=%3E%20:categories,%20:action%20=%3E%20:updates_subcategories)%20%% 3E?category_id=156](http://localhost:3000/assets/%3C%=%20escape_javascript(url_for%20:controller%20=%3E%20:categories,%20:action%20=%3E%20:updates_subcategories)%20%%3E?category_id=156)

如何在 jQuery 中使用 url_for？是否可以？

如果我使用

```
url : '/categories/update_subcategories' 
```

一切都按预期运行。

**编辑：** 我没有运气尝试过以下事情。

似乎我应该使用@Matzi 和@Baldrick 所指出的预处理（[guides.rubyonrails.org/asset_pipeline.html#preprocessing](http://guides.rubyonrails.org/asset_pipeline.html#preprocessing)），所以我的文件应该是main.js.erb。我在 app/assets/javascripts 中重命名了这个文件。当我转到资产/新视图（需要文件的位置）时，我收到此错误：

```
undefined method 'url_for' for #<#<Class:0x9853e4c>:0xab00c48> 
```

我尝试将这两行添加到 assets_controller：

```
include ActionView::Helpers::UrlHelper
include ActionView::Helpers::TagHelper 
```

然后我得到：

```
undefined local variable or method `controller' for #<AssetsController:0xa40aaec> 
```

在这行视图中：

```
<%= form_for(@asset) do |f| %> 
```

我还尝试将这些行添加到 new.html.erb 文件中：

```
<%= include ActionView::Helpers::UrlHelper %>
<%= include ActionView::Helpers::TagHelper %> 
```

然后我得到：

```
undefined method `include' for #<#<Class:0xab164d0>:0xab0183c> 
```

正如[Rails 3 所推荐的：如何在 rake 任务中渲染 ERb 模板？](https://stackoverflow.com/questions/4262044/rails-3-how-to-render-erb-template-in-rake-task)在类似的情况下。我在视图和控制器中尝试了以下包含，结果相同：

```
include Rails.application.routes.url_helpers # brings ActionDispatch::Routing::UrlFor
include ActionView::Helpers::TagHelper 
```

@Matzi 推荐的我尝试过的另一件事是将 main.js.erb 从 app/assets/javascripts/ 移动到 app/views/assets。但在这种情况下，main.js.erb 中的 Javascript 似乎不会与视图 new.html.erb 同时加载。我试图将 main.js.erb 重命名为 new.js.erb 但文件中的 JS 似乎也没有加载。

我虽然使用 JS 附加处理程序和 js.erb 来返回结果，但我需要第一个 JS 中的 url_for 以便知道在哪里调用。

所以问题仍然存在，如何在 js.erb 中使用 url_for 来尝试将更改处理程序附加到视图中的字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:59:22.713

我认为问题在于它位于 .js 文件中，而 ruby​​ 不会解释该文件。尝试将此代码放在 .js.erb 文件中，它会为您工作。

更新：

Asset 不适用于这种动态行为，因此您最好将其移动到某个视图中，并在需要时进行渲染。如果要在资产中使用它，则需要在 .js.erb 中包含帮助程序：

```
<% environment.context_class.instance_eval { include ActionView::Helpers::UrlHelper } %>
<% environment.context_class.instance_eval { include ActionView::Helpers::TagHelper } %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-11T07:20:01.953

当您向 js.erb 添加两行时：

```
<% environment.context_class.instance_eval { include ActionView::Helpers::UrlHelper } %>
<% environment.context_class.instance_eval { include ActionView::Helpers::TagHelper } %> 
```

并得到另一个`error: undefined local variable or method '_routes' for #<#<Class:0x9078290>:0xa1bee8c>`。请将以上两行替换为：

```
<% environment.context_class.instance_eval { include Rails.application.routes.url_helpers} %> 
```

# ruby-on-rails - Rails 迁移：self.up 和 self.down 与更改

> ID：10365129
> 
> 赞同：90
> 
> 时间：2012-04-28T15:53:21.813
> 
> 标签：ruby-on-rails, migration, rails-activerecord, rails-migrations

看起来新的 rails 版本与 self.up 和 self.down 方法相比有“变化”。

那么当一个人必须回滚迁移时会发生什么，它如何知道要执行哪些操作。我有以下方法需要根据在线教程实现：

```
class AddImageToUsers < ActiveRecord::Migration
  def self.up
    add_column :users, :image_file_name, :string
    add_column :users, :image_content_type, :string
    add_column :users, :image_file_size, :integer
    add_column :users, :image_updated_at, :datetime
  end

  def self.down
    remove_column :users, :image_file_name, :string
    remove_column :users, :image_content_type, :string
    remove_column :users, :image_file_size, :integer
    remove_column :users, :image_updated_at, :datetime
  end    
end 
```

如何使用新的更改方法做同样的事情？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-04-28T16:54:46.180

对于许多操作**，rails 可以猜测逆操作是什么**（没有问题）。例如，在您的情况下，`add_column`回滚时调用的反向操作是什么？当然是`remove_column`。的倒数是`create_table`什么？是`drop_table`。因此，在这些情况下，rails 知道如何回滚和定义`down`方法是多余的（您可以在文档中看到[change 方法当前支持的方法](http://guides.rubyonrails.org/migrations.html#using-the-change-method)）。

但要注意，因为*对于某些操作，您仍然需要定义`down`方法*，例如，如果您更改小数列的精度，如何猜测回滚时的原始精度？这是不可能的，所以你需要定义`down`方法。

如前所述，我建议您阅读[Rails 迁移指南](http://guides.rubyonrails.org/migrations.html)。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2015-09-28T10:24:23.477

**更好地使用向上，向下，更改：**

**On Rails 3 (Reversible)：**它应该在 up 上添加新列并仅在 up 时填写 table 中的所有记录，并且只在 down 时删除此列

```
def up
  add_column :users, :location, :string
  User.update_all(location: 'Minsk')
end

def down
  remove_column :users, :location
end 
```

**但：**

您必须避免使用可以节省一些时间的更改方法。例如，如果您不需要在添加后立即更新列值，您可以将此代码缩减为如下所示：

```
def change
  add_column :users, :location, :string
end 
```

向上它会将列添加到表中并在向下删除它。代码少得多，这是一种利润。

**在 Rails 4 上：**在一个地方编写我们需要的东西的另一种有用的方法：

```
def change
  add_column :users, :location, :string
  reversible do |direction|
    direction.up { User.update_all(location: 'Minsk') }
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T15:58:32.767

```
class AddImageToUsers < ActiveRecord::Migration
  def change
    add_column :users, :image_file_name, :string
    add_column :users, :image_content_type, :string
    add_column :users, :image_file_size, :integer
    add_column :users, :image_updated_at, :datetime
  end
end 
```

# java - Java：嵌套同步块

> ID：10365132
> 
> 赞同：25
> 
> 时间：2012-04-28T15:53:39.410
> 
> 标签：java, multithreading, concurrency

*我在 Heinz Kabutz 的Java 专家*时事通讯版本之一中看到了这一点，尽管 Kabutz 博士的其余（实际上是所有）文章解释得很好且详细，但他似乎掩盖了这段代码的作用，或者更重要的是，它的意义在于：

```
public class SomeObject {
    private Object lock1;
    private Object lock2;

    public void doSomething() {
        synchronized(lock1) {
            synchronized(lock2) {
                // ...
            }
        }
    }
} 
```

嵌套`synchronized`块的含义是什么？这对尝试的不同线程有何影响`doSomething()`？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-28T16:10:53.377

有两个可能需要注意的问题

1.  如果使用等待/通知，嵌套锁很容易导致死锁。以下是原因的解释。[http://tutorials.jenkov.com/java-concurrency/nested-monitor-lockout.html](http://tutorials.jenkov.com/java-concurrency/nested-monitor-lockout.html)

2.  应该注意的是，如果另一种方法希望锁定相同的两个对象，它们必须始终以相同的顺序执行，否则可能会出现另一种死锁情况，如本文所述：[如何避免嵌套同步和由此产生的死锁](https://stackoverflow.com/questions/5151266/how-to-avoid-nested-synchronization-and-the-resulting-deadlock)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-07T17:55:10.247

就其本身而言，此代码段不会引起任何问题。但是如果有这样的代码，问题可能会以死锁的形式出现；我们有两种同步块的方法，以相反的顺序锁定对象-

```
public void doSomething() {
    synchronized(lock1) {
        synchronized(lock2) {
            // ...
        }
    }
}

public void doOtherthing() {
    synchronized(lock2) {
        synchronized(lock1) {
            // ...
        }
    } 
} 
```

现在，如果有多个线程试图访问这些方法，那么由于嵌套的同步块可能会出现死锁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-30T09:39:30.607

根据[嵌套监视器锁定教程](http://tutorials.jenkov.com/java-concurrency/nested-monitor-lockout.html)

> 在嵌套监视器锁定中​​，线程 1 持有锁 A，并等待来自线程 2 的信号。线程 2 需要锁 A 将信号发送给线程 1。在死锁中，两个线程正在等待对方释放锁.

僵局可能类似于两个人被关在两个房间里，他们想切换到对方的房间，但他们都只有对方的钥匙。而嵌套监视器锁定就像老板被安排睡在一个房间里，并假设只有当有人进入房间时他才会被唤醒。而秘书负责叫醒他的老板。但是老板睡觉的时候还拿着房间的钥匙，所以秘书不能进来叫醒他。

# asp.net-web-api - ASP.NET WebApi 测试 - 断言请求返回 404 响应

> ID：10365137
> 
> 赞同：7
> 
> 时间：2012-04-28T15:54:08.897
> 
> 标签：asp.net-web-api

我使用以下方法创建了一个 ApiController：

```
public User Get(int id)
{
    var user = DocumentSession.Load<User>(id);
    if(user!=null)
    {
        return Mapper.Map<User>(user); 
    }
    throw new HttpResponseException(HttpStatusCode.NotFound);
} 
```

我正在尝试为此方法编写一个测试，该测试断言当将无效 id 传递给函数时，它会返回适当的 404 响应。

目前我有：

```
[Test]
public void get_invalid_user_returns_404()
{
    Assert.Throws<HttpResponseException>(()=>_usersController.Get(1001));
} 
```

这有效并通过了，但是它并没有断言它是 404 响应，只是抛出了正确类型的异常。我应该在这里做什么来断言结果是 404？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-29T22:36:12.600

假设您使用的是 NUnit，您可以这样做：

```
[Test]
public void get_invalid_user_returns_404()
{
    HttpResponseException ex = Assert.Throws<HttpResponseException>(()=>_usersController.Get(1001));
    Assert.That(ex.Response.StatusCode, Is.EqualTo(HttpStatusCode.NotFound));
} 
```

应该做的伎俩。

# javascript - 使用 HTML5 和没有图像的 javascript 的 Windows 8 预加载器（加载图标）

> ID：10365138
> 
> 赞同：18
> 
> 时间：2012-04-28T15:54:15.350
> 
> 标签：javascript, css, html

在查看 Windows 8 加载屏幕的屏幕时，我注意到一个简单的事情，有一个非常有趣的预加载器（或加载图标），它有一点重力/摇摆效果。我想使用 javascript 和 css 复制相同的内容，但我对 javascript 动画了解不多，因此想知道您是否可以给我一个方向，在那里我可以找到类似的示例。您还可以通过提供具有类似动画类型的代码片段来提供帮助。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-10-25T17:37:01.753

检查网站[CSSload](http://cssload.net/)。在这里，您可以在几秒钟内制作您的 CSS 加载器。我已经制作了 Windows 8 加载器，所以你可以[在这里](http://jsfiddle.net/vule/nPQNH/)看到它。

```
@keyframes orbit {
   0% {
      opacity: 1;
      z-index:99;
      transform: rotate(180deg);
      animation-timing-function: ease-out;
   }

   7% {
      opacity: 1;
      transform: rotate(300deg);
      animation-timing-function: linear;
      origin:0%;
   }

   30% {
      opacity: 1;
      transform:rotate(410deg);
      animation-timing-function: ease-in-out;
      origin:7%;
   }

   39% {
      opacity: 1;
      transform: rotate(645deg);
      animation-timing-function: linear;
      origin:30%;
   }

   70% {
      opacity: 1;
      transform: rotate(770deg);
      animation-timing-function: ease-out;
      origin:39%;
   }

   75% {
      opacity: 1;
      transform: rotate(900deg);
      animation-timing-function: ease-out;
      origin:70%;
   }

   76% {
      opacity: 0;
      transform:rotate(900deg);
   }

   100% {
      opacity: 0;
      transform: rotate(900deg);
   }
} 
```

或者，试试[这个代码示例](http://codepen.io/janrubio/pen/DusIE)......

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-05-23T23:41:37.857

这是我没有 Javascript 的纯 CSS3 实现，其中我结合[了 CSSload](http://cssload.net/)和[Jan Rubio 的 codepen](http://codepen.io/janrubio/pen/DusIE)技术，以实现最少的标记和没有 id 选择器：

***HTML：***

```
<div class="loader">
   <div class="circle"></div>
   <div class="circle"></div>
   <div class="circle"></div>
   <div class="circle"></div>
   <div class="circle"></div>
</div> 
```

***CSS：***

```
.loader { position: relative; width: 64px; height: 64px; }
.loader .circle { position: absolute; width: 61px; height: 61px; opacity: 0; -moz-transform: rotate(225deg); -moz-animation: orbit 7.15s infinite; -webkit-transform: rotate(225deg); -webkit-animation: orbit 7.15s infinite; -ms-transform: rotate(225deg); -ms-animation: orbit 7.15s infinite; -o-transform: rotate(225deg); -o-animation: orbit 7.15s infinite; transform: rotate(225deg); animation: orbit 7.15s infinite; }
.loader .circle:after { content:''; position: absolute; width: 8px; height: 8px; background: #04C5DE; left: 0px; top: 0px; -moz-border-radius: 8px; -webkit-border-radius: 8px; -ms-border-radius: 8px; -o-border-radius: 8px; border-radius: 8px; }
.loader .circle:nth-child(1) { -moz-animation-delay: 1.56s; -webkit-animation-delay: 1.56s; -ms-animation-delay: 1.56s; -o-animation-delay: 1.56s; animation-delay: 1.56s; }
.loader .circle:nth-child(2) { -moz-animation-delay: 0.31s; -webkit-animation-delay: 0.31s; -ms-animation-delay: 0.31s; -o-animation-delay: 0.31s; animation-delay: 0.31s; }
.loader .circle:nth-child(3) { -moz-animation-delay: 0.62s; -webkit-animation-delay: 0.62s; -ms-animation-delay: 0.62s; -o-animation-delay: 0.62s; animation-delay: 0.62s; }
.loader .circle:nth-child(4) { -moz-animation-delay: 0.94s; -webkit-animation-delay: 0.94s; -ms-animation-delay: 0.94s; -o-animation-delay: 0.94s; animation-delay: 0.94s; }
.loader .circle:nth-child(5) { -moz-animation-delay: 1.25s; -webkit-animation-delay: 1.25s; -ms-animation-delay: 1.25s; -o-animation-delay: 1.25s; animation-delay: 1.25s; }

@-moz-keyframes orbit {
    0% { opacity: 1; z-index: 99; -moz-transform: rotate(180deg); -moz-animation-timing-function: ease-out; }
    7% { opacity: 1; -moz-transform: rotate(300deg); -moz-animation-timing-function: linear; -moz-origin: 0%; }
    30% { opacity: 1; -moz-transform: rotate(410deg); -moz-animation-timing-function: ease-in-out; -moz-origin: 7%; }
    39% { opacity: 1; -moz-transform: rotate(645deg); -moz-animation-timing-function: linear; -moz-origin: 30%; }
    70% { opacity: 1; -moz-transform: rotate(770deg); -moz-animation-timing-function: ease-out; -moz-origin: 39%; }
    75% { opacity: 1; -moz-transform: rotate(900deg); -moz-animation-timing-function: ease-out; -moz-origin: 70%; }
    76% { opacity: 0; -moz-transform: rotate(900deg); }
    100% { opacity: 0; -moz-transform: rotate(900deg); }
}

@-webkit-keyframes orbit {
    0% { opacity: 1; z-index: 99; -webkit-transform: rotate(180deg); -webkit-animation-timing-function: ease-out; }
    7% { opacity: 1; -webkit-transform: rotate(300deg); -webkit-animation-timing-function: linear; -webkit-origin: 0%; }
    30% { opacity: 1; -webkit-transform: rotate(410deg); -webkit-animation-timing-function: ease-in-out; -webkit-origin: 7%; }
    39% { opacity: 1; -webkit-transform: rotate(645deg); -webkit-animation-timing-function: linear; -webkit-origin: 30%; }
    70% { opacity: 1; -webkit-transform: rotate(770deg); -webkit-animation-timing-function: ease-out; -webkit-origin: 39%; }
    75% { opacity: 1; -webkit-transform: rotate(900deg); -webkit-animation-timing-function: ease-out; -webkit-origin: 70%; }
    76% { opacity: 0; -webkit-transform: rotate(900deg); }
    100% { opacity: 0; -webkit-transform: rotate(900deg); }
}

@-ms-keyframes orbit {
    0% { opacity: 1; z-index: 99; -ms-transform: rotate(180deg); -ms-animation-timing-function: ease-out; }
    7% { opacity: 1; -ms-transform: rotate(300deg); -ms-animation-timing-function: linear; -ms-origin: 0%; }
    30% { opacity: 1; -ms-transform: rotate(410deg); -ms-animation-timing-function: ease-in-out; -ms-origin: 7%; }
    39% { opacity: 1; -ms-transform: rotate(645deg); -ms-animation-timing-function: linear; -ms-origin: 30%; }
    70% { opacity: 1; -ms-transform: rotate(770deg); -ms-animation-timing-function: ease-out; -ms-origin: 39%; }
    75% { opacity: 1; -ms-transform: rotate(900deg); -ms-animation-timing-function: ease-out; -ms-origin: 70%; }
    76% { opacity: 0; -ms-transform: rotate(900deg); }
    100% { opacity: 0; -ms-transform: rotate(900deg); }
}

@-o-keyframes orbit {
    0% { opacity: 1; z-index: 99; -o-transform: rotate(180deg); -o-animation-timing-function: ease-out; }
    7% { opacity: 1; -o-transform: rotate(300deg); -o-animation-timing-function: linear; -o-origin: 0%; }
    30% { opacity: 1; -o-transform: rotate(410deg); -o-animation-timing-function: ease-in-out; -o-origin: 7%; }
    39% { opacity: 1; -o-transform: rotate(645deg); -o-animation-timing-function: linear; -o-origin: 30%; }
    70% { opacity: 1; -o-transform: rotate(770deg); -o-animation-timing-function: ease-out; -o-origin: 39%; }
    75% { opacity: 1; -o-transform: rotate(900deg); -o-animation-timing-function: ease-out; -o-origin: 70%; }
    76% { opacity: 0; -o-transform: rotate(900deg); }
    100% { opacity: 0; -o-transform: rotate(900deg); }
}

@keyframes orbit {
    0% { opacity: 1; z-index: 99; transform: rotate(180deg); animation-timing-function: ease-out; }
    7% { opacity: 1; transform: rotate(300deg); animation-timing-function: linear; origin: 0%; }
    30% { opacity: 1; transform: rotate(410deg); animation-timing-function: ease-in-out; origin: 7%; }
    39% { opacity: 1; transform: rotate(645deg); animation-timing-function: linear; origin: 30%; }
    70% { opacity: 1; transform: rotate(770deg); animation-timing-function: ease-out; origin: 39%; }
    75% { opacity: 1; transform: rotate(900deg); animation-timing-function: ease-out; origin: 70%; }
    76% { opacity: 0; transform: rotate(900deg); }
    100% { opacity: 0; transform: rotate(900deg); }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-13T17:53:25.487

我不确定，但也许这就是你想要的：

```
<progress style="color: white;" class="win-medium win-ring"></progress> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-12-04T09:42:58.903

这是对 CSS3 中 Modern UI ProgressRing 动画的另一种看法。它基于已经提到的 Jan Rubio 的[解决方案](http://codepen.io/janrubio/details/DusIE)，并进行了一些调整（但仍需要调整）。

如果 codepen 不可用，请观看[现场示例或使用以下代码：](http://codepen.io/Chudesnov/pen/gDhGw)

***HTML***

```
<div class='progress-ring'>
  <div class='progress-ring__wrap'>
    <div class='progress-ring__circle'></div>
  </div>
  <div class='progress-ring__wrap'>
    <div class='progress-ring__circle'></div>
  </div>
  <div class='progress-ring__wrap'>
    <div class='progress-ring__circle'></div>
  </div>
  <div class='progress-ring__wrap'>
    <div class='progress-ring__circle'></div>
  </div>
  <div class='progress-ring__wrap'>
    <div class='progress-ring__circle'></div>
  </div>
</div> 
```

***CSS（少，无前缀）***

```
body {background:#111}
@t:4000ms;
@d:40px;
@color:#ffffff;
.progress-ring {
  position: relative;
  padding-top: @d/5;
  width: @d;
  height: @d;
  margin: auto;

  .progress-ring__wrap {
    position: absolute;
      width: @d - 2;
      height: @d - 2;

    .progress-ring__circle {
      transform: rotate(225deg);
      animation-iteration-count: infinite;
      animation-name: orbit;
      animation-duration: @t;
      width: @d - 2;
      height: @d - 2;

      opacity: 0;

      &:after {
      content: '';
        position: absolute;
        width: @d/8;
        height: @d/8;
        border-radius: @d/8;
        box-shadow: 0px 0px 5% @color;
        background: @color; /* Pick a color */
      }
    }

    @r:-14deg;
    @m:30;
    &:nth-child(2) {
      transform:rotate(@r);
      .progress-ring__circle {  animation-delay: @t/@m; }
    }
    &:nth-child(3) {
      transform:rotate(@r*2);
      .progress-ring__circle {  animation-delay: @t/@m*2; }
    }
    &:nth-child(4) {
      transform:rotate(@r*3);
      .progress-ring__circle {  animation-delay: @t/@m*3; }
    }
    &:nth-child(5) {
      transform:rotate(@r*4);
      .progress-ring__circle {  animation-delay: @t/@m*4; }
    }
  }
}

@keyframes orbit { 
  0%   { transform:rotate(225deg); opacity: 1;
         animation-timing-function: ease-out; } 

  7%   { transform:rotate(345deg);
         animation-timing-function: linear; }

  35%   { transform:rotate(495deg);
          animation-timing-function: ease-in-out; }

  42%   { transform:rotate(690deg);
          animation-timing-function: linear; }

  70%   { transform:rotate(835deg); opacity: 1; 
         animation-timing-function: linear; }

  76% {opacity: 1;}

  77%   { transform:rotate(955deg);
         animation-timing-function: ease-in; }

  78% { transform:rotate(955deg); opacity: 0; }
  100% { transform:rotate(955deg); opacity: 0; } 
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-07T14:15:04.507

不确定 javascript，但您可以从[http://preloaders.net/en/search/windows8下载](http://preloaders.net/en/search/windows8)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-26T22:54:38.390

我发现你可以在 and 上找到一个类似的脚本`C:\Windows\WinStore\WinStore.css`，`WinStore.htm`只要打开`Winstore.htm`，你就会发现一个类似的环形加载动画，由 提供`IE10`，如果有人可以从 Windows Shell 转储动画信息...如果你用记事本看到，`WinStore.css`你会看到一些东西像这样：

```
splashProgress::-ms-fill
{
    animation-name: **-ms-ring**;
} 
```

该变量是存储在 Windows Shell 中某处的动画信息吗？？？

我测试了在 Chrome 和 Firefox 中加载 HTML 页面，什么都没有，只是一个正常的加载栏。

对不起，我的英语不好。我来自阿根廷。

# javascript - jQuery：水平居中绝对位置对象

> ID：10365146
> 
> 赞同：0
> 
> 时间：2012-04-28T15:55:30.050
> 
> 标签：javascript, jquery, css

我正在尝试使用 CSS 和 jQuery 的组合将一系列对象水平居中。jQuery 部分是我遇到的麻烦。这是我的代码：

```
$('.tooltip').each(function() {
        $(this).css('margin-left', 0 - ($(this).width / 2) );
} 
```

上面的代码应该应用一个负边距，它正好是对象宽度的一半。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T16:00:18.470

```
$('.tooltip').each(function() {
        $(this).css('margin-left', '-'+($(this).width() / 2)+'px');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T15:58:09.920

```
.tooltip {
   position: absolute; 
   width: 300px; // suppose
   left: 50%;
   margin-left: -150px; // half of the width
} 
```

使用 jQuery：

```
$('.tooltip').each(function() {
        $(this).css('margin-left', '-' + $(this).width / 2 + 'px');
} 
```

# php - 插入后尝试查看图像上传 - php mySQL

> ID：10365147
> 
> 赞同：0
> 
> 时间：2012-04-28T15:55:36.193
> 
> 标签：php, mysql, image, upload, insert

我正在学习如何上传带有插入的照片。到目前为止，我已将图像上传到“照片”文件夹。这样可行。我创建了一个名为“image”的 blob 字段。

我应该看到 blob 字段中的路径还是实际照片？使困惑。

[http://jsfiddle.net/zEZD7/](http://jsfiddle.net/zEZD7/)

```
<?
$order = "INSERT INTO reg_add (connect_date, 
   reg, 
   first_name, 
   last_name,
   image)

VALUES

('$_POST[connect_date]', 
     '{$_POST[reg]}nv', 
     '$_POST[first_name]', 
     '$_POST[last_name]',
     '$_POST[image]')";

$new_image = 'photos/'.basename( $_FILES['image']['name']);
    if(move_uploaded_file($_FILES['image']['tmp_name'], $new_image)) {
        // The images was uploaded
  } else{
header("location: reg_add_fail_IMAGE.php"); 
}

$sql = "INSERT INTO image (path) VALUES ('" . mysql_real_escape_string($path) . "')";

$result = mysql_query($order);
?> 
```

形式：

```
<form id="form_register" method="POST" action="reg_add.php">

   <input class="req-string bx short" type="text" name="connect_date" id="connect_date">
   <input type="hidden" name="MAX_FILE_SIZE" value="100000">
   <input class="req-string bx long caps" type="text" name="reg" id="reg">
   <input class="req-string bx long" type="text" name="first_name">
   <input class="bx long" type="text" name="last_name">

   Choose a image to upload: <input name="image" type="file">
   <input id="rbSubmit" class="rb2 rbSubmit" type="submit" value="submit">
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T16:23:16.410

我认为您想要一个表格并让用户填写一些详细信息并上传图片，然后将其显示回来？

如果是这样，我不会将图像存储在 MySQl 中。我会将图像上传到服务器的文件系统，位于 WWW 根（浏览器可访问的目录）之外的某个**位置，并将图像文件的路径**存储在 char 列中。

当您想要显示它时，只需打印一个标签，其中包含从您的数据库查询中获取的图像来源。

此外，您的代码似乎建议您接受用户输入并将其直接添加到数据库中，从安全角度来看，这非常糟糕。您需要先进行输入验证（google that and SQL injection attack）

# php - 每次for循环在php中计数时更新一个mysql记录

> ID：10365148
> 
> 赞同：0
> 
> 时间：2012-04-28T15:55:36.900
> 
> 标签：php, mysql

我绑定`update`了一定数量的记录，在我的代码中`$tickets`= 10，这意味着我只需要根据 mysql 标准更新数据库中的 10 条记录，我的`for loop`这里更新所有记录（一次 100 条记录！）为我的标准，这是我的代码

```
for ($counter = 1; $counter <= $tickets; $counter++) {

    $bookTicket = mysql_query("UPDATE units SET 
    ticketSold = 'No',
    userIdFK = '$chooseUser' 
    WHERE BusinessreservationIdFk = '$eventId' 
          AND classIDfk ='$chooseClass' ")
    or die(mysql_error());

    if ($bookTicket) 
    {
         echo "<br/>ticket " . $counter . "  done !";
    } 
    else 
    {
         echo "no<br/>";
    }                                                            
} 
```

每次`for`计数时如何更新一条记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:31:55.617

如果我理解正确，您想使用给定的 businessreservationIdFk 和 classIDfk 更新 10 个条目，并且这样做是为了如果没有足够的免费条目，您最终不会得到 0 个保留，而是有可用的保留（例如10 个请求中的 6 个）。

你可以这样做：

```
$bookTicket = mysql_query("UPDATE units SET 
    ticketSold = 'No',
    userIdFK = '" . $chooseUser . "' 
WHERE BusinessreservationIdFk = '" . $eventId . "' AND
    classIDfk ='" . $chooseClass . "'
LIMIT 
    10
") or die(mysql_error());

if ($bookTicket){
     $num = mysql_query("SELECT COUNT(1) FROM units WHERE userIdFK = '".$chooseUser."'");
     $num = mysql_fetch_array($num)[0];
     echo $num . " tickets booked.";
}else{
     echo "Not a single ticket available!";
} 
```

假设您的检查参数（WHERE 之后的参数）标识了所有未预订的票，但我认为您在这里还有另一个错误，并且仅检查票是否来自预期的类型和预期的业务，而不是是否已经预订或不。也许您还应该检查 f ticketSold 是否处于“未预订”之类的状态。

编辑：请注意，不需要循环

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T16:17:17.293

你可以在你的代码中使用 LIMIT 所以你的代码是

```
for ($counter = 1; $counter <= $tickets; $counter++) {

    $bookTicket = mysql_query("UPDATE units SET 
    ticketSold = 'No',
    userIdFK = '$chooseUser' 
    WHERE BusinessreservationIdFk = '$eventId' 
          AND classIDfk ='$chooseClass' LIMIT 1") //ADD LIMIT TO THIS LINE
    or die(mysql_error());

    if ($bookTicket) 
    {
         echo "<br/>ticket " . $counter . "  done !";
    } 
    else 
    {
         echo "no<br/>";
    }                                                            
} 
```

但我认为你应该改用它，这样你一次只使用 1 个查询。

```
$bookTicket = mysql_query("UPDATE units SET 
ticketSold = 'No',
userIdFK = '$chooseUser' 
WHERE BusinessreservationIdFk = '$eventId' 
      AND classIDfk ='$chooseClass' LIMIT 10") 
```

PS。我认为您的代码会存在 SQL 注入安全问题的风险。请也看一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T16:13:35.450

在没有看到更多 PHP 代码和数据库内容的上下文的情况下，看起来这段代码基本上会运行相同的 SQL 10 次。我看不到每次循环执行时 $eventId 或 $chooseClass 在哪里发生变化。并且，如果您的数据集中有超过 1 个（而不是 100 个）匹配记录（对于 $eventId 和 $chooseClass 的组合），则上述代码将在每个循环中更新多个记录。

您需要首先从 SQL 的角度来看待它，询问您要更新什么，看看 SQL 会做什么，然后形成一个一次更新一条记录的循环。

或者，您是否只想将可能的门票中的 10 张标记为已售出或未售出？

然后像 update table set sold =no limit 10 这样的 SQL 语句应该这样做。（未经测试的伪代码）

# pdf - PDF Google 文档查看器

> ID：10365152
> 
> 赞同：0
> 
> 时间：2012-04-28T15:56:09.127
> 
> 标签：pdf, seo, indexing

我使用 google doc 在我的网站上显示嵌入的 PDF。它像这样使用 iframe：

```
<iframe src="http://docs.google.com/viewer?url=http%3A%2F%2Fwww.emathhelp.net%2Fpdf%2F1%2F1331155133.pdf&embedded=true" width="800" height="500" style="border: none;"></iframe> 
```

我想知道谷歌将如何索引 PDF 的内容？在 Google 搜索中会出现嵌入 PDF 或直接 PDF 链接的网站吗？这将如何影响我的排名？

我希望页面而不是直接 PDF 链接出现在搜索结果中。如果上述方法不起作用，是否有一些转机？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T14:01:03.667

您正在尝试利用您的 pdf 文件中某些特定文本（关键字）的排名，并且您希望防止它被索引并使其不可见，答案很明确：您不能或 Google 不允许您做这个。

作为一种解决方案，我建议您将 pdf 文件放在一个路径中，并在您的 robots.txt 文件中将该路径标记为不允许。然后，您应该使用数据库之类的东西并编写一些代码（基于您使用的平台）以在上传 pdf 文件时获取 pdf 文本。然后使用类似这样的查看器：http: [//mozilla.github.com/pdf.js/web/viewer.html](http://mozilla.github.com/pdf.js/web/viewer.html) 当加载特定 pdf 的页面时，您的应用程序将从数据库中抓取文本并将其放入 noscript 标记中。请记住根据您的 pdf 文件优化页面的元标记

# c++ - 编译器会优化 malloc/free 或 new/delete 对到 alloca

> ID：10365157
> 
> 赞同：14
> 
> 时间：2012-04-28T15:56:56.693
> 
> 标签：c++, optimization, gcc, compiler-construction, llvm

是否有任何成熟的 C/C++ 编译器，能够优化`malloc`/ `free`（或`new`/ `delete`）对信息`alloca`？换句话说，从基于堆的内存转换为基于堆栈的内存（仅适用于一些有限的情况）。

只有当两个函数在同一个函数中（甚至在同一个块中`{}`）时，才允许对 malloc/free 进行这种优化，并且每次调用 malloc 时都会调用 free。另外，让我们考虑指向分配内存的指针没有保存在某个全局变量中。

那么，GCC/LLVM+clang/Intel 编译器是否会转换这样的代码块：

```
{
   char *carray;
   carray = malloc(100);          // or malloc(N)
   // some string-like work with carray
   free(carray);
} 
```

进入

```
{
    char*carray;
    carray = alloca(100);  // or if(N<const1) carray=alloca(N);else carray=malloc(N)
    // the same work
    // nothing                       // or if(N>=const1) free(carray)
} 
```

这种转换可能对每个程序都不是很有用，但我认为，可能会有一些特殊的编译器选项。

PS (update1) 我们可以将讨论仅限于编译器知道 malloc 和 free 来自 libc (stdlib) 的情况

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-11T22:06:08.950

有一个名为 poolalloc 的 LLVM 分支可以进行这种优化。它作为[SAFECode](http://safecode.cs.illinois.edu/)的一部分进行维护，并且不在主线 LLVM 发行版中。

它在[Chris Lattner](http://en.wikipedia.org/wiki/Chris_Lattner)的博士[论文](http://llvm.org/pubs/2005-05-04-LattnerPHDThesis.html)和[这篇](http://llvm.org/pubs/2005-05-21-PLDI-PoolAlloc.html)PLDI 论文中有所描述。代码在[这里](http://llvm.org/svn/llvm-project/poolalloc/trunk/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T15:59:11.590

从技术上讲，编译器可以优化任何东西，只要它们遵循**As-If 规则**。
因此，将堆分配优化为堆栈分配是可能的，但编译器需要足够智能以探测使用情况并确定将分配更改为堆栈不会影响程序的可观察行为。

我不知道有任何编译器这样做。

# php - preg_match unicode 解析

> ID：10365160
> 
> 赞同：1
> 
> 时间：2012-04-28T15:57:19.427
> 
> 标签：php, unicode, preg-match

我想匹配一组 unicode/UTF-8 字符，（在[http://solomon.ie/unicode/](http://solomon.ie/unicode/)此处标记为黄色），从我的研究中我想出了这个：

```
// ensure it's valid unicode / get rid of invalid UTF8 chars
$text = iconv("UTF-8","UTF-8//IGNORE",$text);

// and just allow a basic english...ish.. chars through - no controls, chinese etc
$match_list = "\x{09}\x{0a}\x{0d}\x{20}-\x{7e}"; // basic ascii chars plus CR,LF and TAB 
$match_list .= "\x{a1}-\x{ff}"; // extended latin 1 chars excluding control chars
$match_list .= "\x{20ac}"; // euro symbol

if (preg_match("/[^$match_list]/u", $text) )
    $error_text_array[] = "<b>INVALID UNICODE characters</b>"; 
```

测试似乎表明它按预期工作，但作为 uniocde 的新手，如果这里有人能发现我忽略的任何漏洞，我将不胜感激。

我可以确认十六进制范围匹配 unicode 代码点而不是实际的十六进制值（即欧元符号的 x20ac 而不是 xe282ac 是正确的）？

我可以混合文字字符和十六进制值，如 preg_match("/[^0-9\x{20ac}]/u", $text)？

谢谢，凯文

请注意，我之前尝试过这个问题，但它被关闭了 - “更适合 codereview.stackexchange.com”，但那里没有回应，所以希望可以以更简洁的格式再试一次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:13:37.423

我创建了一个包装器来测试您的代码，我认为它在过滤您期望的字符时是安全的，但是当您的代码发现无效的 UTF-8 字符时，它会导致 E_NOTICE。所以我认为你应该在 iconv 行的开头添加 @ 来禁止通知。

对于第二个问题，可以混合文字字符和十六进制值。你也可以自己试试。:)

```
<?php
function generatechar($char)
{
    $char = str_pad(dechex($char), 4, '0', STR_PAD_LEFT);
    $unicodeChar = '\u'.$char;
    return json_decode('"'.$unicodeChar.'"');
}
function test($text)
{   
    // ensure it's valid unicode / get rid of invalid UTF8 chars
    @$text = iconv("UTF-8","UTF-8//IGNORE",$text); //Add @ to surpress warning
    // and just allow a basic english...ish.. chars through - no controls, chinese etc
    $match_list = "\x{09}\x{0a}\x{0d}\x{20}-\x{7e}"; // basic ascii chars plus CR,LF and TAB
    $match_list .= "\x{a1}-\x{ff}"; // extended latin 1 chars excluding control chars
    $match_list .= "\x{20ac}"; // euro symbol

    if (preg_match("/[^$match_list]+/u", $text)  )
        return false;

    if(strlen($text) == 0)
        return false; //For testing purpose!
    return true;
}

for($n=0;$n<65536;$n++)
{
    $c = generatechar($n);
    if(test($c))
        echo $n.':'.$c."\n";
} 
```

# r - 指定 ylim 时 geom_bar 条不显示

> ID：10365167
> 
> 赞同：36
> 
> 时间：2012-04-28T15:57:55.973
> 
> 标签：r, ggplot2

我遇到了 geom_bars 的问题，其中当我在 y 轴上指定限制时，没有呈现条形。我相信以下应该重现该问题：

```
data <- structure(list(RoleCond = structure(c(1L, 1L, 2L, 2L), .Label = c("Buyer", "Seller"), class = "factor"), 
                   ArgCond = structure(c(1L, 2L, 1L, 2L), .Label = c("No Argument", "Argument"), class = "factor"), 
                   mean = c(2210.71428571429, 2142.70833333333, 2282.40740740741, 2346.2962962963), 
                   se = c(20.1231042081511, 16.7408757749718, 20.1471554637891, 15.708092540868)), 
                   .Names = c("RoleCond", "ArgCond", "mean", "se"), row.names = c(NA, -4L), class = "data.frame")

library(ggplot2)    
ggplot(data=data, aes(fill=RoleCond, y=mean, x=ArgCond)) + 
      geom_bar(position="dodge", stat="identity") + 
      geom_errorbar(limits, position=dodge, width=0.1, size=.75) + 
      scale_y_continuous(limits=c(2000,2500)) 
```

这给了我这个

![没有酒吧](../Images/849f27252076a7fa46eb74794982d5ac.png)

没有指定限制的相同代码可以正常工作。geom_errorbar() 似乎与问题无关，但它确实说明了应该在哪里显示条。

我试过使用`coord_cartesian(ylim=c(2000,2500))`which 来限制 yaxis 并让条形图显示，但是轴标签搞砸了，我不明白我在用它做什么。

感谢您的任何建议！（我正在使用 R 2.15.0 和 ggplot2 0.9.0）

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-04-28T16:03:43.213

您可以尝试使用`library(scales)`：

```
+ scale_y_continuous(limits=c(2000,2500),oob = rescale_none) 
```

相反，如此[处](https://groups.google.com/forum/?fromgroups#!topic/ggplot2-dev/JGal_9nRzsg)所述。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-07-15T17:23:36.307

为我的案例添加一个稍微不同的答案，以防有人遇到这个问题：

使用`position="dodge"`时，条形会自动水平调整大小以填充通常远远超出数据本身限制的空间。因此，即使 your`x-axis`和`y-axis`limits 都是`limits=c(min-1, max+1`，对于某些数据集，`position="dodge"`可能会将其大小调整到超出该限制范围，从而导致条形不出现。与上述情况不同，如果您的限制下限为 0，甚至可能发生这种情况。

`oob=rescale_none`在两者中使用`scale_y_continous()`AND`scale_x_continuous()`通过简单地切断由`position="dodge"`.

根据之前的评论，它需要先`package:scales`运行`library(scales)`。

希望这可以帮助其他人，上面的答案只能让你分道扬镳。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-11-14T23:26:13.433

根据之前共享的链接，这对我有用。

```
p + coord_cartesian(ylim=c(5,15)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2022-02-16T18:00:16.700

这是一个社区 wiki，本质上是复制[用户 teunbrand 对该主题的规范答案](https://stackoverflow.com/a/58956068/7941188)- 以便为这个更大的线程添加更多可见性。

考虑下图（`geom_col()`等价于`geom_bar(stat = "identity")`）：

```
df <- data.frame(x = letters[1:7],
                 y = 1:7)

g <- ggplot(df, aes(x, y)) +
  geom_col()
g 
```

[![在此处输入图像描述](../Images/68426d0ebb23aa8ec0e9ec8ed45980c2.png)](https://i.stack.imgur.com/fMlUt.png)

您可以清楚地看到条形图看起来像矩形。检查基础绘图数据，确认条形图已参数化为具有 xmin/xmax/ymin/ymax 参数化的矩形：

```
> layer_data(g)
  x y PANEL group ymin ymax xmin xmax colour   fill size linetype alpha
1 1 1     1     1    0    1 0.55 1.45     NA grey35  0.5        1    NA
2 2 2     1     2    0    2 1.55 2.45     NA grey35  0.5        1    NA
3 3 3     1     3    0    3 2.55 3.45     NA grey35  0.5        1    NA
4 4 4     1     4    0    4 3.55 4.45     NA grey35  0.5        1    NA
5 5 5     1     5    0    5 4.55 5.45     NA grey35  0.5        1    NA
6 6 6     1     6    0    6 5.55 6.45     NA grey35  0.5        1    NA
7 7 7     1     7    0    7 6.55 7.45     NA grey35  0.5        1    NA 
```

现在考虑以下情节：

```
g2 <- ggplot(df, aes(x, y)) +
  geom_col() +
  scale_y_continuous(limits = c(1, 7)) 
```

[![在此处输入图像描述](../Images/298db39fff072cbee1023f8df2ca202d.png)](https://i.stack.imgur.com/moePx.png)

这个是空的，反映了你发布的案例。检查基础数据会产生以下结果：

```
> layer_data(g2)
  y x PANEL group ymin ymax xmin xmax colour   fill size linetype alpha
1 1 1     1     1   NA    1 0.55 1.45     NA grey35  0.5        1    NA
2 2 2     1     2   NA    2 1.55 2.45     NA grey35  0.5        1    NA
3 3 3     1     3   NA    3 2.55 3.45     NA grey35  0.5        1    NA
4 4 4     1     4   NA    4 3.55 4.45     NA grey35  0.5        1    NA
5 5 5     1     5   NA    5 4.55 5.45     NA grey35  0.5        1    NA
6 6 6     1     6   NA    6 5.55 6.45     NA grey35  0.5        1    NA
7 7 7     1     7   NA    7 6.55 7.45     NA grey35  0.5        1    NA 
```

可以看到该`ymin`列被替换为`NA`s。此行为取决于 的`oob`（越界）参数`scale_y_continuous()`，该参数默认为`scales::censor()`函数。这会检查（替换为`NA`）超出轴限制的任何值，其中包括应该是`ymin`列的 0。因此，无法绘制矩形。

有两种方法可以解决这个问题。正如 Magnus 建议的那样，一位候选人确实`ylim`在函数中使用了参数`coord_cartesian()`：

```
ggplot(df, aes(x, y)) +
  geom_col() +
  coord_cartesian(ylim = c(1, 7)) 
```

[![在此处输入图像描述](../Images/322b477361db362edfc90f947d65b318.png)](https://i.stack.imgur.com/nG7Nb.png)

在函数内指定限制`coord_*`会导致图形对象被剪裁。当您关闭剪辑时，您可以看到这一点：

```
ggplot(df, aes(x, y)) +
  geom_col() +
  coord_cartesian(ylim = c(1, 7), clip = "off") 
```

[![在此处输入图像描述](../Images/85b0859d03386d4f9e197e637705a4dd.png)](https://i.stack.imgur.com/H3pRv.png)

另一种选择是在 中使用替代`oob`参数`scale_y_continuous`，例如`scales::squish`：

```
g3 <- ggplot(df, aes(x, y)) +
  geom_col() +
  scale_y_continuous(limits = c(1, 7), 
                     oob = scales::squish)
g3 
```

[![在此处输入图像描述](../Images/28e9ac06affed526aaa66f099bc81138.png)](https://i.stack.imgur.com/uAGBF.png)

它的作用是用最近的限制替换限制之外的任何值，例如`ymin`0 变为 1：

```
> layer_data(g3)
  y x PANEL group ymin ymax xmin xmax colour   fill size linetype alpha
1 1 1     1     1    1    1 0.55 1.45     NA grey35  0.5        1    NA
2 2 2     1     2    1    2 1.55 2.45     NA grey35  0.5        1    NA
3 3 3     1     3    1    3 2.55 3.45     NA grey35  0.5        1    NA
4 4 4     1     4    1    4 3.55 4.45     NA grey35  0.5        1    NA
5 5 5     1     5    1    5 4.55 5.45     NA grey35  0.5        1    NA
6 6 6     1     6    1    6 5.55 6.45     NA grey35  0.5        1    NA
7 7 7     1     7    1    7 6.55 7.45     NA grey35  0.5        1    NA 
```

你可以做的另一件事是为参数提供一个自定义函数`oob`，它只是返回它的输入。由于默认情况下，裁剪是打开的，这反映了这种`coord_cartesian(ylim = c(1,7))`情况：

```
ggplot(df, aes(x, y)) +
  geom_col() +
  scale_y_continuous(limits = c(1, 7), 
                     oob = function(x, ...){x}) 
```

# asp.net - 在 asp.net 中提交表单

> ID：10365173
> 
> 赞同：5
> 
> 时间：2012-04-28T15:58:56.150
> 
> 标签：asp.net, webforms

我有两个按钮，它们都在 asp.net 中提交表单。

我需要在下面的函数中知道..单击了什么按钮..登录或注册按钮。通过这些信息，我想触发加载事件中的功能之一。

```
 protected void Page_Load(object sender, EventArgs e)
{
    AddCountries();
    AddAge();

      if (IsPostBack)
      {
          string pwd = LoginPassword.Text;
          string saltAsBase64 = "z3llWdYSA2DY3M4uNSpOQw==";
          string hash = HashPass.GenerateHash(pwd, saltAsBase64);

          if (Page.IsValid)
          {
              LoginUser(hash);
         /// Depending on what the user pressed..I need to trigger the function 
        // above or below
              RegisterUser(hash);
          }

      }
} 
```

如果我在按钮事件中有这个怎么办：

FormsAuthentication.RedirectFromLoginPage(currentUser.UserName, false);

重定向会在按钮事件之后立即发生吗？还是会再次触发页面加载事件，忽略该重定向？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T16:10:48.743

如果按钮是服务器端控件`<asp:button/>`，那么您可以处理（特定）按钮的事件：

```
protected void Button1_Click(object sender, EventArgs e) {....} 
```

对比

```
protected void Button2_Click(object sender, EventArgs e) {......} 
```

**见后** 提出哪些`Page_Load`：[ASP.Net Page Life Cycle](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

如果您使用标准 HTML`<input type=submit />`并回发到同一页面，则可以检查`Request.Form`集合（*您也可以使用服务器端控件进行操作*）。

更新：

*   `Page_Load`总是**在**回发时提出
*   客户端验证将阻止回发
*   如果您正在使用服务器验证控件，请`Page.IsValid`在执行某些操作之前检查处理程序
*   根据您的需要，您还可以检查控件/值`Page_Load`（检查`Page.IsPostBack`- 关键是您有选择...

因此，如果您（相反）想要检查`Page_Load`：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (Page.IsPostBack)
    {
        if ((UserEmail.Text == "jchen@contoso.com") &&
         (UserPass.Text == "37Yj*99Ps"))
          {
            FormsAuthentication.RedirectFromLoginPage
               (UserEmail.Text, Persist.Checked);
          }
        else
          {
            ......
          }
    }
} 
```

*以上代码取自[MSDN并稍作修改](http://msdn.microsoft.com/en-us/library/xdt4thhy.aspx)*

更新2：

如果您正在使用服务器验证控件，请不要使用`Page_Load`. 使用按钮处理程序并检查`Page.IsValid`.

# java - Java 在 Windows 上读取文件非常慢

> ID：10365174
> 
> 赞同：3
> 
> 时间：2012-04-28T15:58:59.940
> 
> 标签：java, io, bufferedimage, random-access

有没有人对不同平台上文件 IO 的差异有任何经验？我编写了一个 LWJGL 程序，它可以传输 100+ MB TIFF 文件。流式传输在多台 Mac 和 Linux 计算机上发生得相当快，但在我的 64 位 Windows 7 桌面上，加载地图的每个图块似乎需要几秒钟。

基本上，我创建了一个 Tile 类实例的二维数组。每个 tile 是 TIFF 文件的 512x512 MB 区域，render 方法检查内存中的 tile 区域是否已加载，如果没有，加载将在 ThreadPoolExecutor 中排队，如果已排队则没有任何反应，如果已加载，则画。对 TIFF 的访问由 TIFF 类处理，该类使用 RandomAccessFile 实例读取文件。这是我用来从 TIFF 读取图块的功能

```
public BufferedImage getRasterTile(Rectangle area) {
    BufferedImage image = new BufferedImage(area.width, area.height,
            BufferedImage.TYPE_INT_RGB);
    try {
        long[] bytesPerSample = new long[bitsPerSample.length];
        for (int i = 0; i < bytesPerSample.length; i++) {
            bytesPerSample[i] += bitsPerSample[i] / 8 + bitsPerSample[i]
                    % 8 == 0 ? 0 : 1;
        }
        long bytesPerPixel = 0;
        for (long bits : bitsPerSample) {
            bytesPerPixel += bits / 8 + bits % 8 == 0 ? 0 : 1;
        }
        long bytesPerRow = bytesPerPixel * imageWidth;
        int strip, color;
        byte red, green, blue;
        for (int i = area.x; i < area.x + area.width; i++) {
            for (int u = area.y; u < area.y + area.height; u++) {
                if (i > 0 && u > 0 && i < imageWidth && u < imageLength) {
                    switch (planarConfiguration) {
                    case Chunky:
                        strip = (int) (u / rowsPerStrip);
                        seek(stripOffsets[strip]
                                + (u - strip * rowsPerStrip)
                                * bytesPerRow + i * bytesPerPixel);
                        red = readByte();
                        green = readByte();
                        blue = readByte();

                        color = (red & 0x0ff) << 16 | (green & 0x0ff) << 8
                                | (blue & 0x0ff);
                        image.setRGB(i - area.x, u - area.y, color);
                        break;
                    case Planar:
                        strip = (u / (int) rowsPerStrip);
                        seek(stripOffsets[strip] + i);
                        red = readByte();
                        seek(stripOffsets[strip + (int) imageLength] + i);
                        green = readByte();
                        seek(stripOffsets[strip + 2 * (int) imageLength]
                                + i);
                        blue = readByte();
                        color = (red & 0x0ff) << 16 | (green & 0x0ff) << 8
                                | (blue & 0x0ff);
                        image.setRGB(i - area.x, u - area.y, color);
                        break;
                    }
                } else {
                    image.setRGB(i - area.x, u - area.y, 0);
                }
            }
        }
    } catch (IOException e) {
        e.printStackTrace();
        return null;
    }
    return image;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T16:24:23.213

我怀疑这与您阅读文件的方式有关。我注意到您反复调用名为`readByte()`and的方法`seek`。如果这些方法在无缓冲流（或`RandomAccessFile`实例）上进行调用，那么您可能会进行大量系统调用，这会使您的方法非常慢。

如果这是原因，那么您可能应该将整个图像文件读入 a `byte[]`，并使用数组索引来找出您需要的字节。如果图像文件太大而无法执行此操作，则您需要重新构建代码以减少查找并一次读取多个字节。

# wpf - 键不适用于 DataGrid 上的绑定 SelectedItem

> ID：10365180
> 
> 赞同：0
> 
> 时间：2012-04-28T15:59:30.497
> 
> 标签：wpf, mvvm, wpfdatagrid

最初显示我的 DataGrid 时，我在使用箭头键进行 DataGrid 导航时遇到问题。向上/向下键不会更改当前行。只有在我单击一行后，键才开始工作。与焦点有关，但我不知道如何以编程方式设置焦点。

```
`<DataGrid ItemsSource="{Binding Tasks}"
              AutoGenerateColumns="False"
              SelectedItem="{Binding SelectedTask, Mode=TwoWay}"
              SelectionMode="Single">
      <DataGrid.Columns>
        <DataGridTextColumn Header="Title"
                            Binding="{Binding Title}" />
      </DataGrid.Columns>
</DataGrid>`
```

```
`class MainViewModel : ModelBase
{
    private readonly ObservableCollection<TaskModel> tasks = new ObservableCollection<TaskModel>();
    public MainViewModel()
        : base()
    {
        this.Tasks.Add(new TaskModel("task0"));
        this.Tasks.Add(new TaskModel("task1"));
        this.Tasks.Add(new TaskModel("task2"));
        this.SelectedTask = this.Tasks[0];
    }<br>
    public TaskModel SelectedTask { get; set; }
    public ObservableCollection<TaskModel> Tasks
    {
        get { return this.tasks; }
    }
}` 
```

 `* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T16:30:30.700

你也可以这样做：

```
<DataGrid PreviewKeyDown="DataGrid_PreviewKeyDown" 
```

.

```
private void DataGrid_PreviewKeyDown(object sender, KeyEventArgs e)
{
    DataGrid grid = sender as DataGrid;
    ICollectionView view = CollectionViewSource.GetDefaultView(grid.ItemsSource);

    switch (e.Key)
    {
        case Key.Up:
            view.MoveCurrentToPrevious();
            e.Handled = true;
            break;
        case Key.Down:
            view.MoveCurrentToNext();
            e.Handled = true;
            break;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T16:32:44.083

回答我自己关于如何设置初始焦点的问题：http: [//msdn.microsoft.com/en-us/library/system.windows.input.focusmanager.focusedelement.aspx](http://msdn.microsoft.com/en-us/library/system.windows.input.focusmanager.focusedelement.aspx)`

# java - Android 初学者：布局按钮和文本

> ID：10365183
> 
> 赞同：0
> 
> 时间：2012-04-28T15:59:45.067
> 
> 标签：java, android, xml, eclipse, android-layout

我正在尝试创建一个应用程序，其中有一排按钮，然后在按钮中心正下方显示文本。到目前为止，这就是我所拥有的：

```
<FrameLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/blue"/>

    <Button
        android:id="@+id/button2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/red" android:layout_gravity="center"/>

    <Button
        android:id="@+id/button3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="@drawable/green" android:layout_gravity="right"/>

</FrameLayout>

<RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginTop="2.5dip"                       
        android:layout_marginLeft="7.5dip"
        android:text="@string/button1"
        android:gravity="center" />
    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="2.5dip"
        android:text="@string/button2" />

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true" 
        android:layout_marginTop="2.5dip"           
        android:layout_marginRight="5dip"
        android:text="@string/button3" />

</RelativeLayout> 
```

但文本没有在按钮的中心下方排列。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:12:46.617

Drew, you should be able to center align them with 2 properties: Gravity and Layout Gravity. Using just one gravity center property does not work everytime, but by using these two, it should work like a charm for you just like it did for me.

```
android:gravity="center" android:layout_gravity="center" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T16:12:01.447

首先，在 FrameLayout 中使用多个子元素从来都不是一件好事。如果可以的话，你应该使用 LinearLayout。如果您希望按钮填充屏幕宽度的三分之一，您可以使用

```
<LinearLayout 
   android:layout_width="fill_parent"
   android:layout_height="fill_parent"
   android:weightsum="3" >

     <Button
       android:id="@+id/button1"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"
       android:background="@drawable/blue"
       android:weight="1"/>

     <Button
       android:id="@+id/button2"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"
       android:background="@drawable/red"
       android:weight="1"/>

     <Button
       android:id="@+id/button3"
       android:layout_width="wrap_content"
       android:layout_height="wrap_content"
       android:background="@drawable/green"
       android:weight="1"/>
</LinearLayout> 
```

然后对于TextViews，你可以再次使用LinearLayout，但是改变方向；

```
<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" 
    android:orientation="vertical" >

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginTop="2.5dip"                       
    android:layout_marginLeft="7.5dip"
    android:text="@string/button1"
    android:layout_gravity="center" />

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_marginTop="2.5dip"
    android:text="@string/button2"
    android:layout_gravity="center" />

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true" 
    android:layout_marginTop="2.5dip"           
    android:layout_marginRight="5dip"
    android:text="@string/button3"
    android:layout_gravity="center" />

</LinearLayout> 
```

如果我没记错的话，这可能会解决你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T16:51:35.590

如果您使用的是 Eclipse，您可以转到布局 .xml 的图形视图，右键单击要居中的视图，转到垂直或水平布局，然后单击重力 -> 居中。

# c# - 将 OData 过滤器与 C# MVC 4 Web Api 和 Backbone 结合使用

> ID：10365189
> 
> 赞同：4
> 
> 时间：2012-04-28T16:00:24.380
> 
> 标签：c#, backbone.js, asp.net-mvc-4, asp.net-web-api

这是我第一次尝试很棒的 Web Api 和 Backbone。到目前为止，一切似乎都是天作之合。但是，我似乎无法使用 OData 过滤器返回相关数据。例如，我有以下作为操作方法：

```
 //GET /api/posts/
    public IQueryable<KiaFamilyPost> Get()
    {
        return _db.Posts
            .Include("Badge")
            .Include("Entry")
            .AsQueryable();
    } 
```

现在我想过滤上面的帖子，并按降序返回。据我了解，我可以执行以下操作**"http://[MySite]/api/posts?$filter=id eq 2&$orderby=DatePost desc"**。我试图做以下无济于事：

```
 APP.posts_collection.fetch({data: {
            entryId: APP.entry.get('Id'),
            $order: 'Id desc'
        }}); 
```

Backbone 对控制器**"http://[MySite]/api/posts?entryId=1&%24order=Id+desc"**进行以下调用。任何人都能让它正常工作吗？

谢谢

泰隆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T07:52:49.277

我尝试了 Addy Osmani 的一个名为[backbone.paginator](https://github.com/addyosmani/backbone.paginator)的插件。如果您正在使用像 MVC 4 这样的 Web Api，我相信这将非常适合。您所做的就是使用 Paginator 提供的一些参数来扩展您的集合。例如。

```
 perPageAttribute: '$top',

    skipAttribute: '$skip',

    orderAttribute: 'orderBy',

    customAttribute1: '$inlinecount',

    queryAttribute: '$filter',

    formatAttribute: '$format',

    customAttribute2: '$callback',` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T07:35:20.073

您能否检查此代码是否有效：（我假设 APP.entry 是您的模型，所以为了获取它的 url，我调用了 APP.entry.url ）

```
 var entryId = APP.entry.get('Id');
   var queryUrl = APP.entry.url() + '?$filter=id eq ' + entryId +'&$orderby=DatePost desc';
   APP.posts_collection.fetch({ url : queryUrl }); 
```

我没有测试过这样的代码，但我希望它可以工作，或者至少给你一个线索。

# python - 这段代码真的是私人的吗？（Python）

> ID：10365193
> 
> 赞同：2
> 
> 时间：2012-04-28T16:00:57.547
> 
> 标签：python, private

我试图让python允许私有变量，所以我制作了这个装饰器，你把它放在一个类的乞讨中，这样每个函数都会得到一个额外的私有参数，他们可以修改为他们想要的。据我所知，不可能从课堂外获取变量，但我不是专业人士。

谁能找到破解私有对象并从中获取值的方法？还有比这更好的方法吗？

蟒蛇2.7

```
#this is a decorator that decorates another decorator. it makes the decorator
#not loose things like names and documentation when it creates a new function
def niceDecorator(decorator):
    def new_decorator(f):
        g = decorator(f)
        g.__name__ = f.__name__
        g.__doc__ = f.__doc__
        g.__dict__.update(f.__dict__)
        return g
    new_decorator.__name__ = decorator.__name__
    new_decorator.__doc__ = decorator.__doc__
    new_decorator.__dict__.update(decorator.__dict__)
    return new_decorator

@niceDecorator
#this is my private decorator
def usePrivate(cls):

    prv=type('blank', (object,), {})
    #creates a blank object in the local scope
    #this object will be passed into every function in
    #the class along with self which has been renamed
    #as pbl (public).

    @niceDecorator
    #this is the decorator that gets applied to every function
    #in the class. in makes it also accept the private argument
    def decorate(func):
        def run(pub, *args, **kwargs):
            return func(pub,prv, *args, **kwargs)
        return run

    #this loops through every function in the class and applies the decorator
    for func in cls.__dict__.values():
        if callable(func):
            setattr(cls, func.__name__, decorate(getattr(cls, func.__name__)))

    return cls

#this is the class we are testing the private decorator with.
#this is what the user would program
@usePrivate
class test():

    #sets the value of the private variable
    def setValue(pbl,prv,arg):
        #pbl (public) is another name for self
        #prv (private) acts just like self except its private
        prv.test=arg

    #gets the value of the private variable
    def getValue(pbl,prv):
        return prv.test
a=test()
a.setValue(3)
print a.getValue() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-28T16:02:22.540

简而言之：不要这样做。

[没有必要在 Python 中使事情真正私有化](http://docs.python.org/tutorial/classes.html#tut-private)。使用您的软件的人可以看到某些东西是否被标记为私有（变量名称以 开头`_`），所以他们知道。如果他们仍然想访问它，为什么要阻止他们？

我相信还有一种方法可以绕过你的代码——Python 有大量的内省代码，而且修改类很容易。如果有人真的想得到它，几乎不可能锁定任何东西。

还值得注意的是，在 Python 中，setter/getter 是没有意义的。目的是允许您在设置/获取属性时添加代码，python 允许您使用[内置](http://docs.python.org/library/functions.html#property)[的`property()`](http://docs.python.org/library/functions.html#property).

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-28T16:20:35.153

这是一个有趣的想法，但是您用于装饰器的包装函数将在其`func_closure`属性中引用“私有”对象。因此，您的“私有”变量可以作为`a.getValue.func_closure[0].cell_contents.test`. （您可以使用任何包装函数来获取您的“私有”对象，而不仅仅是`getValue`.）

一般来说，这种技术只会惹恼其他正在使用您的代码的程序员。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-28T16:34:52.757

在 Python 中总有一种方法可以解决问题，尤其是如果您有原始源可以阅读。使用 kindall 的示例，将这些行添加到文件的末尾：

```
print a.getValue.im_func.func_closure[0].cell_contents.test
a.getValue.im_func.func_closure[0].cell_contents.test = 17
print a.getValue() 
```

真的，不要这样做。Python 人们说“不要为私有变量烦恼”是有原因的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-28T04:03:11.160

正如其他人所说，仍然有一种方法可以访问私有变量。但是，您仍然可以在 c++ 中访问私有变量。考虑这个 C++ 示例：

```
class PrivateEye
{
    private:
    int a;
    double b;
    char c;

    public:
    // ... public functions ...
};

PrivateEye detective;

double privateB = *((double *) ((void *) &detective + sizeof(detective.a))); 
```

如您所见，要访问私有变量需要做很多工作，因此执行此操作的人需要足够了解以了解风险。因此，如果您有程序员使用您的`_attribute`私有属性，您发布的解决方案将有效地让他们在弄乱私有属性之前考虑它。使用`__attribute`(双下划线) 会导致一些名称修改，这也具有相同的效果，即导致人们在决定访问“私有”属性之前做更多的思考。

编辑：根据[Accessing private members](https://stackoverflow.com/questions/726096/accessing-private-members/726304)中的第二个答案，C++ 标准不保证类中成员变量的顺序，因此您可能需要进行一些试验才能访问 C++ 示例中所需的私有变量以上。

# android - 如何从 SQLITE db 中获取特定列中元素最少的行

> ID：10365199
> 
> 赞同：0
> 
> 时间：2012-04-28T16:01:34.437
> 
> 标签：android, sqlite

我正在尝试获取一个包含一行的游标，并且与其他行中的相应条目相比，该行的特定列中的条目应该最少。

我正在使用的查询是：

```
 mDb.query(true, DATABASE_TABLE_2, new String[] { "min (" +KEY_TIMEOUT+ ")", KEY_ROWID, KEY_NAME, KEY_UNIV }, null, null, null, null); 
```

这没有返回任何东西。有没有更好的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T16:27:59.103

> 我正在尝试获取包含一行的游标

然后设置行数限制：`LIMIT 1`

> 并且与其他行中的相应条目相比，该行特定列中的条目应该最少。

您可以按该列排序，以便该列中的最小值在前：`ORDER BY column`

这应该导致

```
mDb.query(true, DATABASE_TABLE_2, new String[] { KEY_ROWID, KEY_NAME, KEY_UNIV },
        null, null, null, null, KEY_TIMEOUT, "1"); 
```

# android - Andengine中的动画背景

> ID：10365202
> 
> 赞同：2
> 
> 时间：2012-04-28T16:01:46.067
> 
> 标签：android, andengine, animated

我正在通过 android andengine 开发游戏。我想为菜单场景创建动画背景。我该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-30T11:56:09.137

您可以将`AutoParallaxBackgroundExample.java`from andengine 用于动画背景。只需将一些按钮附加到它，您将拥有带有动画背景的菜单场景。

![自动视差背景示例](../Images/4629317a7470ecbbc44540ec5ce3cf31.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T11:02:36.273

以任何您喜欢的方式创建带有动画的场景，并使用 HUD（一种特殊的子场景）将菜单项放在顶部。看到这个线程： [http ://www.andengine.org/forums/tutorials/hud-t2355.html](http://www.andengine.org/forums/tutorials/hud-t2355.html)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-28T18:09:32.530

这里给出的答案应该是您正在寻找的： [如何在画布内使用动画框架？](https://stackoverflow.com/questions/4938822/how-can-i-use-the-animation-framework-inside-the-canvas/)

> Android 动画类适用于视图和布局等对象。画布只是一个用于绘图的表面，它要么是视图的一部分，要么链接到位图。在自定义视图的 onDraw 中，只有一帧被绘制，直到调用下一次无效，这意味着您必须逐帧绘制动画。这是一个旋转的弹跳球的示例，您可能会发现它很有用。

# scala - 对 foldLeft 错误感到困惑（在 Eclipse 和 REPL 中）

> ID：10365213
> 
> 赞同：8
> 
> 时间：2012-04-28T16:02:55.583
> 
> 标签：scala

上下文非常简单。我的假设基于 Odersky 的书“Scala 编程，第 2 版”，第 8.5 节描述了“占位符语法”。

我有一个 List[List[Boolean]] （即一个矩形位图），我试图在其中计算值“true”的总出现次数。这是定义执行良好的数据的 REPL 行：

```
val rowsByColumns =
    List(   List(false, true, false)
          , List(true, true, true)
          , List(false, true, false)
        ) 
```

接下来，我尝试使用以下行来计算“true”的出现次数。而不是执行，我收到一个错误：

```
val marks = (for(row <- rowsByColumns)
    yield {row.foldLeft[Int](0)(_ + (if (_) 1 else 0))}).sum

<console>:8: error: wrong number of parameters; expected = 2
       val marks = (for(row <- rowsByColumns) yield {row.foldLeft[Int](0)(_ + (i
f (_) 1 else 0))}).sum
                                                                        ^ 
```

我不明白这个错误，因为我有两个下划线代表函数的参数。因此，我通过编写执行得很好的代码使函数更加明确：

```
val marks = (for(row <- rowsByColumns)
      yield {row.foldLeft[Int](0)((sum, marked) => sum + (if (marked) 1 else 0))}
    ).sum 
```

我的问题是：为什么我会收到不太明确的情况并出错，但是当我通过减少“简化”来绘制函数时，它会正确执行？

感谢您对此提供的任何见解。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-28T16:41:54.170

Scala 对匿名函数的占位符语法的限制可能非常令人困惑（至少对我而言）。一个经验法则是下划线绑定到它们最近的圆括号，但这是一个近似值——有关详细信息，请参见[Scala 规范](http://www.scala-lang.org/docu/files/ScalaReference.pdf)的第 6.23 节：

> 如果满足以下两个条件，则句法类别的表达式*e*`Expr` *绑定*下划线部分*u*：（1）*e*正确包含*u*，并且（2）没有其他句法类别表达式`Expr`正确包含在*e*中并且其本身正确包含*你*。

在这种情况下，编译器不会将第二个下划线视为第二个参数。这可能看起来很奇怪，因为`_ + _`它被正确地视为具有两个参数，并且`if (_) x else y`等效于`z => if (z) x else y`（其中`z`是一个新的标识符），但是将两者嵌套是行不通的。

确实，编译器理论上*可以确定*两个下划线应该是您的 中同一个匿名函数的参数`foldLeft`，但不是，例如，在下面，第二个下划线确实需要单独绑定：

```
rowsByColumns.map(_.map(!_)) 
```

但是，这需要编译器方面有很多额外的聪明才智，而且 Scala 语言设计者认为这是不值得的——只需要为一些没有嵌套表达式的相当简单的情况提供占位符语法。

* * *

幸运的是，在这种情况下，您可以改写`rowsByColumns.flatten.count(identity)`。`flatten`这里连接子列表以给出单个`List[Boolean]`. 然后我们想知道该列表中有多少个值`true`。`count`接受一个谓词并告诉您集合中有多少值满足该谓词。例如，这是计算 1 到 10（含）之间的偶数的一种方法：

```
val isEven: Int => Boolean = _ % 2 == 0    
(1 to 10) count isEven 
```

但是，在您的情况下，我们已经有了布尔值，因此谓词不需要做任何工作——它可以是恒等函数`x => x`。正如 dhg 在评论中指出的那样，Scala 的[`Predef`对象](http://www.scala-lang.org/api/current/scala/Predef%24.html)将其作为名为 的方法提供`identity`，我在这里使用它。`rowsByColumns.flatten.count(x => x)`但是，如果您发现它更清晰，您也可以轻松编写。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T16:33:10.637

我们可以通过查看一个更简单的案例来检查您的问题：

```
(0 to 1).map(x => if(x > 1) 1 else 0)  // fine
(0 to 1).map(if(_ > 1) 1 else 0)       // error 
```

我们看到的错误是

```
<console>:8: error: missing parameter type for expanded function ((x$1) => x$1.$greater(1))
              (0 to 1).map(if(_ > 1) 1 else 0)
                              ^ 
```

所以发生的事情是 Scala 正在`_`向`(x$1) => x$1`尽可能窄的范围扩展。换句话说，它试图做：

```
(0 to 1).map(if((x) => x > 1) 1 else 0) 
```

但这是错误的。

你的情况类似。两者`_`不被视为都在同一范围内，这就是为什么它认为只有一个参数。第二个`_`在 的范围内展开`if`，这是错误的。它认为你正在这样做：

```
row.foldLeft[Int](0)((x) => x + (if ((y) => y) 1 else 0)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-21T12:54:54.127

> 考虑到这一点，Odersky 的提议（[在 SIP 12 中](http://docs.scala-lang.org/sips/pending/uncluttering-control.html?_ga=1.215761823.948393304.1470074846)）是否有可能改变 Scala 的语法以取消 if 评估表达式中所需的括号，从而纠正他的“缺陷”，以便通过删除if 中的括号将使其正常工作

注（216 年 8 月，4 年后）：决定是

> ## 推迟到未来版本
> 
> 此 SIP 当前处于推迟状态，当前操作为 2.10。
> 
> *   (1) 弃用`then`标识符中的“”以保留将来的关键字状态。
> *   (2) 弃用有问题的“ `while() do`”语法。（`do`while 循环中的 " " 循环需要大括号）。
> 
> 该提案最初于 2011 年提出，建议对`if`'s`for`和`while`loops 进行语法更改，将 Scala 的语法从 Java 和类 C 语言中移开。
> 尽管这样的变化可以说是更美好，但委员会同意这会带来更多的问题而不是好处。

见[问题 555](https://github.com/scala/scala.github.com/issues/555)

# database - 使用 JPA 更改数据库设计

> ID：10365216
> 
> 赞同：1
> 
> 时间：2012-04-28T16:03:08.000
> 
> 标签：database, jpa

这不是一个真正的问题，但在我的开发过程中它有时是一件烦人的事情。假设我有一些实体（数据库是根据这些实体创建的，不是其他的），我决定添加一列，删除一列或其他东西，现在我需要将这些更改提交到我的数据库。

最好的方法是什么？我有时必须重新启动 Glassfish；有时部署它就足够了；有时我需要手动删除表，因为重新启动无济于事。我的策略`persistence.xml`设置为，`Create`但其他选项并没有真正帮助我。

是否有任何标准方法可以将更改从实体提交到数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:23:06.873

据我所知，JPA 中没有标准方法可以在开发过程中自动更改表并仍将数据保留在表中。在某些情况下，切换到 CREATE-DROP 可以解决问题 - 但随后您将丢失表中的数据，并且很快需要编写脚本来填充所述表。正如您所说，这对您来说不是什么大问题，从 CREATE-DROP 转到适用于多人项目的方法可能是一个好习惯。我/我们的方法是在 repo 中有一个 sql 脚本文件，当我更改我的实体时，我（手动）更改该脚本或添加一个新脚本（后者如果表已经在生产中或表中的数据是多于几行插入或通过使用创建且不易重现）。通过这种方式，我们可以处理不断合并和可运行的代码。

# ios - 深度可变序列化 iOS 字典/数组

> ID：10365217
> 
> 赞同：4
> 
> 时间：2012-04-28T16:03:39.603
> 
> 标签：ios, json, ios5, nsmutablearray

一些 JSON 来自我的应用程序分解的本地文件：`{"1":{"name":"My List","list":[]}}`.

由于使用了以下选项，我使用此 iOS 5.1 代码将整个内容转换为我认为是*深度*可变字典的内容：

```
NSData *data = [[NSFileManager defaultManager] contentsAtPath:jSONFile];
NSMutableDictionary *mydict = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableContainers|NSJSONReadingMutableLeaves error:&error]; 
```

给定选项`NSJSONReadingMutableContainers`，我会假设子数组`list`属于此类：“NSJSONReadingMutableContainers - 指定数组和字典被创建为可变对象。” 来自[NSJSONSerialization Class Reference](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)，但是当我尝试执行以下代码时：

```
NSMutableArray *myarray = [mydict objectForKey:@"1"] objectForKey:@"list"];
[myarray addObject:@"test"]; 
```

执行在第二行（addObject）爆炸，但有以下例外：

-[__NSArrayI addObject:]: 无法识别的选择器发送到实例 0x887e840

** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[__NSArrayI addObject:]：无法识别的选择器已发送到实例 0x887e840”

根据我的 SO 研究（[1](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CCYQFjAA&url=https://stackoverflow.com/questions/3220120/nsmutablearray-addobject-nsarrayi-addobject-unrecognized-selector-sent-t&ei=pBOcT_n2GOaoiAK8utVj&usg=AFQjCNFg1tWqTv4Zg3qbGsqUzLsyynZkAQ&sig2=n0pQUAdm_LKTxhdw1-7Izw)、[2](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&ved=0CDIQFjAB&url=https://stackoverflow.com/questions/4893043/iphone-crash-using-addobject-on-a-nsmutablearray&ei=pBOcT_n2GOaoiAK8utVj&usg=AFQjCNGB5QHihwvWYP5QewVr536GnjnhrA&sig2=WiiXstpq7qw49Yx8sXHCiA)、[3](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=4&ved=0CEwQFjAD&url=https://stackoverflow.com/questions/1676789/nsmutablearray-addobject-unrecognized-selector&ei=pBOcT_n2GOaoiAK8utVj&usg=AFQjCNEDfwZIZTHcD7MPCPVycAlDknaBww&sig2=ZzR23-1e-S61VcRxSQhuyw)），似乎上述错误通常是在尝试添加对象的元素（字典/数组）*不可*变时引起的。此外，根据我的 SO 研究（[1](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CCkQFjAA&url=https://stackoverflow.com/questions/1788690/objective-c-how-to-check-if-variable-is-nsarray-or-nsmutablearray&ei=KBScT4P0D4SQiQLsoqhF&usg=AFQjCNFniTUmeKYR6lb49oQmMl3Xg_lvEg&sig2=qoVBRVV3Rd6gMqXXniSq-Q)、[2](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&ved=0CDUQFjAB&url=https://stackoverflow.com/questions/9235965/ios-distinguish-an-nsdictionary-from-an-nsmutabledictionary&ei=KBScT4P0D4SQiQLsoqhF&usg=AFQjCNHuZ-2Ia5swv98C7XbfLYOHu2-1iA&sig2=zw2wro0u61b5gag5btGVMQ)），似乎没有办法测试对象在 obj-c 中是否确实是可变的，这是设计使然。

所以我想我的问题是，如何确保我的 JSON 结构在序列化时（或之后立即）确实是“深度”可变的？我知道我不能使用`mutableCopy`on`mydict`因为那个功能很浅。任何方向/解决方案将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:15:10.523

我使用了这个实现，它使用 nsdictionary 上的一个类别来做一个可变的深拷贝并且效果很好：

[NSMutableDictionary 的深层可变副本](https://stackoverflow.com/questions/1950361/deep-mutable-copy-of-a-nsmutabledictionary)

所以在你反序列化 json 之后，你可以在它上面调用 mutableDeepCopy。

这就是我所拥有的：

```
@interface NSDictionary(Category)
- (NSMutableDictionary *)mutableDeepCopy;
@end

@implementation NSDictionary(Category)
- (NSMutableDictionary *)mutableDeepCopy{
    NSMutableDictionary * ret = [[NSMutableDictionary alloc]
                             initWithCapacity:[self count]];

   NSMutableArray * array;

   for (NSString* key in [self allKeys]){

       if([[self objectForKey:key] respondsToSelector:@selector(mutableCopyWithZone:)]){
            array = [(NSArray *)[self objectForKey:key] mutableCopy];
           [ret setValue:array forKey:key];
       }
       else{
            [ret setValue:[self objectForKey:key] forKey:key];

       }
    }

    return ret;
}

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-08T05:27:00.213

苹果对此有一个解决方案：

[https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/PropertyLists/ReadWritePlistData/ReadWritePlistData.html](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/PropertyLists/ReadWritePlistData/ReadWritePlistData.html)

“这个调用产生一个可变数组，每个元素中都有可变字典。每个字典中的每个键和每个值本身也是可变的。”

# c++ - 堆栈对象的动态转换失败

> ID：10365219
> 
> 赞同：3
> 
> 时间：2012-04-28T16:03:43.540
> 
> 标签：c++, reference, dynamic-cast, object-slicing

前几天我遇到了一个实例，其中我有一个函数获取一个指向基类型的指针，然后我需要将其向上转换为派生类型以访问一些附加功能。但是，`dynamic_cast`失败了，这很奇怪，因为我的类型肯定继承了基本类型。

为了深入了解发生了什么，我创建了以下测试程序，我认为它复制了我所看到的：

```
void cast(TestClass *baseType)
{
    if (dynamic_cast<Derived *>(baseType))
        TRACE("cast was sucessful");
    else
        TRACE("cast failed");
}

int main(int argc, char *argv[])
{
    Derived *test1 = new Derived();
    TestClass *test2 = new TestClass();
    TestClass test3;

    test1->identify(); // prints: this is a Derived class
    test2->identify(); // prints: this is a TestClass

    cast(test1); // succesful
    cast(test2); // fail - expected

    // reassign test2 to test1
    test2 = test1;
    test2->identify(); // prints: this is a Derived class

    cast(test2); // succesful

    // the interesting part, the test3 object (created on stack), does not cast
    // despite that it would seem possible from the cast method.
    test3 = *test1;
    test3.identify(); // prints: this is a TestClass
    cast(&test3); // fails?

    return a.exec();
} 
```

这很有趣，因为如果您只看到我调用的方法`cast()`，您会期望可以转换传入的对象。我已经证明不是这种情况；这取决于最初创建对象的方式。令人困惑的是，为什么可以强制转换一个通过引用而不是值重新分配的对象。此外，`static_cast`只要我们保证类型兼容，使用会起作用吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T16:13:22.703

`test3`是类型`TestClass`（我假设它是 Derived 的父级），因此动态转换失败。

即使您分配`*test1`给它，分配也只会复制`TestClass`部分（又名[slicing](https://stackoverflow.com/questions/274626/what-is-the-slicing-problem-in-c)）。当您将指针分配给指针时，不会发生切片。

您可以将派生对象视为具有其基础的一部分：

```
*test1:
|--------------|
|TestClass part|
|--------------|
|Derived part  |
|--------------|

test3:
|--------------|
|TestClass part|
|--------------| 
```

当您分配指针 ( `test2=test1`) 时，对象本身不会改变，您只是通过不同的玻璃（通过指向 的指针`TestClass`）查看它，因此可以进行投射。

当您分配对象本身 ( `test3=*test1`) 时，目标 ( `test3`) 仅具有放置`TestClass`对象的空间，因此副本会带走多余的`Derived`部分。

# pydev - 你如何记录实例变量以便 PyDev 可以显示文档？

> ID：10365220
> 
> 赞同：1
> 
> 时间：2012-04-28T16:04:06.067
> 
> 标签：pydev

最近安装了 Eclipse/PyDev 来帮助开发一个已经发展到可以在单个文件中开发的 Python 项目。我一直在使用它在悬停时显示文档字符串的能力，并希望将其扩展到文档字符串，例如下面的实例变量。但是，我无法让它工作，似乎找不到任何说明它是否应该工作的东西。可能吗？

```
class Foo(object):
    """ Shows up as docstring """
    def __init__(self):
       """ Does not show up when hovering over x """
       self.x = None
       """ Also doesn't show up when hovering over x """ 
```

（PyDev 联系页面说要询问关于 SO 的一般问题并用 pydev 标记，这就是我正在做的事情。）

# objective-c - 协议不起作用

> ID：10365224
> 
> 赞同：1
> 
> 时间：2012-04-28T16:04:33.087
> 
> 标签：objective-c, protocols

这是一个非常愚蠢的错误，我敢肯定，但我找不到它。
我发现的主要是一个人忘记了`#import`一行。
我没有。我对objective-c很陌生，并且尝试过协议，但我现在有8个错误......
我很确定这是协议，因为我的协议中有2个错误，所有其他错误都说“可以” t find protocol definition' 我认为是由协议中的错误引起的。
这是代码：

```
#import <UIKit/UIKit.h>
#import "CongTile.h"

@protocol TileDelegate

- (UIColor *)colorForTile:(CongTile *)tile; // Expected ')' before 'CongTile'
- (BOOL) drawArmyOnTile:(CongTile *)tile; // same error

@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T16:07:06.763

尝试失去`#import "CongTile.h"`支持`@class CongTile;`

如果您使用`#import` 并且两个文件最终相互导入，您将创建一个导入循环。

* * *

## 边注

假设任何实现的类都是您`TileDelegate`的后代，`NSObject`可能希望将您的协议声明为

```
@protocol TileDelegate <NSObject> 
```

这样编译器就知道你`id<TileDelegate> delegate`在代码中使用的任何时候对象都会响应`<NSObject>`

# python - 从python字符串中以简单的方式提取数字

> ID：10365225
> 
> 赞同：31
> 
> 时间：2012-04-28T16:04:35.333
> 
> 标签：python

例如，我有一个存储数字和单位的字符串

```
x= '$120'
y = ' 90 Degrees F'
banana = '200 kgm'
orange = '300 gm'
total_weight = banana + orange/1000 
```

例如我想添加权重

```
total_weight  = 200 + 300/1000 
```

谢谢！

我试图提取数字只是为了对这些进行一些操作......知道最简单的方法是什么吗？我只处理这两种格式，即数字位于字符串的开头或结尾...

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2012-04-28T16:09:42.287

从字符串中提取数字的最简单方法是使用正则表达式和`findall`.

```
>>> import re
>>> s = '300 gm'
>>> re.findall('\d+', s)
['300']
>>> s = '300 gm 200 kgm some more stuff a number: 439843'
>>> re.findall('\d+', s)
['300', '200', '439843'] 
```

您可能需要更复杂的东西，但这是一个很好的第一步。

请注意，您仍然需要调用`int`结果才能获得正确的数字类型（而不是另一个字符串）：

```
>>> map(int, re.findall('\d+', s))
[300, 200, 439843] 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-04-28T16:37:56.103

不使用`regex`，你可以这样做：

```
def get_num(x):
    return int(''.join(ele for ele in x if ele.isdigit())) 
```

结果：

```
>>> get_num(x)
120
>>> get_num(y)
90
>>> get_num(banana)
200
>>> get_num(orange)
300 
```

**编辑 ：**

回答后续问题。

如果我们知道给定字符串中唯一的句点是小数点，那么提取浮点数就很容易了：

```
def get_num(x):
    return float(''.join(ele for ele in x if ele.isdigit() or ele == '.')) 
```

结果：

```
>>> get_num('dfgd 45.678fjfjf')
45.678 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-28T16:12:53.630

这个正则表达式也处理浮点数

```
import re
re_float = re.compile(r'\d*\.?\d+') 
```

您还可以将一个组添加到捕获您的体重单位的表达式中。

```
re_banana = re.compile(r'(?P<number>\d*\.?\d+)\s?(?P<uni>[a-zA-Z]+)') 
```

您可以像这样访问命名组`re_banana.match("200 kgm").group('number')`。

我认为这应该可以帮助您入门。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-28T16:10:04.017

```
>>> x='$120'
>>> import string
>>> a=string.maketrans('','')
>>> ch=a.translate(a, string.digits)
>>> int(x.translate(a, ch))
120 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T16:32:01.437

如果您正在对数字进行某种数学运算，您可能还想知道单位。鉴于您的输入限制（输入字符串仅包含单位和值），这应该正确返回两者（您只需要弄清楚如何将单位转换为数学的常用单位）。

```
def unit_value(str):
    m = re.match(r'([^\d]*)(\d*\.?\d+)([^\d]*)', str)
    if m:
        g = m.groups()
        return ' '.join((g[0], g[2])).strip(), float(g[1])
    else:
        return int(str) 
```

# ios - ipad中纵向和横向的滚动视图

> ID：10365228
> 
> 赞同：0
> 
> 时间：2012-04-28T16:05:01.100
> 
> 标签：ios, ipad, uiscrollview, landscape-portrait

在我当前的应用程序中，我正在使用滚动视图，但在以纵向模式查看横向模式或 vsv 时遇到了一些问题。我为滚动视图分配的框架是（10,10,1024,550）和（10,10,1024,820）。我正在使用以下方法设置框架。

```
- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation duration:(NSTimeInterval)duration {

    if (UIInterfaceOrientationIsLandscape(interfaceOrientation))
         {

                 [self LandscpeFrame];
        }
    else 
    {
                [self PotraitFrame];
        }
} 
```

但是当改变模式时它不能正常工作。如何设置滚动视图的框架以支持横向和纵向模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T13:06:44.113

没有看到你的`LandscapeFrame`和`PortraitFrame`方法我不能确定，但​​是`contentSize`当你改变框架时你是否设置了这两种方法？

# c# - Linq 查询返回复杂类型

> ID：10365231
> 
> 赞同：4
> 
> 时间：2012-04-28T16:05:27.810
> 
> 标签：c#, asp.net-mvc, linq, entity-framework

我有一个非常标准的用户和角色模型：

```
+-------+   +-----------+   +-------+
| Users |   | UserRoles |   | Roles |
+-------+   +-----------+   +-------+
| ID (P)| < | UserID (P)|   | ID (P)|
| ...   |   | RoleID (P)| > | ...   |
+-------+   +-----------+   +-------+ 
```

我正在使用 Entitiy 框架作为我的 ORM，并且我正在尝试在单个 Linq 查询中构建我的 ViewModel，定义如下：

```
public class RoleDetail {
  public class RoleUser {
    public int ID { get; set; }
    public string Username { get; set; }
  }
  public int ID { get; set; }
  public string Rolename { get; set; }
  public bool Active { get; set; }
  public IEnumerable<RoleUser> Users { get; set; }
} 
```

我认为以下查询应该有效：

```
var query = Context.Roles
                   .Include("Users")
                   .Where(r => r.ID == id)
                   .Select(r => new RoleDetail() {
                      ID = r.ID,
                      Rolename = r.Rolename,
                      Active = r.Active,
                      Users = r.Users
                               .Select(u => new RoleDetail.RoleUser() {
                                  ID = u.ID,
                                  Username = u.Username
                                })
                                .ToList()
                    })
                   .FirstOrDefault(); 
```

但是，这会引发以下错误：

> LINQ to Entities 无法识别方法 'System.Collections.Generic.List [RolesRepository+RoleDetail+RoleUser] ToList[RoleUser] (System.Collections.Generic.IEnumerable[RolesRepository+RoleDetail+RoleUser])' 方法，并且此方法不能被翻译成商店表达式。

我没有经常使用 Linq，所以我很确定我的查询在某种程度上是错误的。有人可以告诉我我的查询哪里出错了，是否有更好的方法来完成我想要实现的目标？

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T16:15:48.117

对 linq-to-entities 的经验很少，所以这是在黑暗中拍摄的：

为什么需要 .ToList()？

.Select() 已经返回一个 IEnumerable，所以它应该可以在没有的情况下工作。

ToList() 返回一个 List，不是 IList 或类似接口，而是一个具体的 c# 类。所以我想 Linq to Entities 无法将其转换为自己的幕后语法

这行得通吗？

```
 var query = Context.Roles
               .Include("Users")
               .Where(r => r.ID == id)
               .Select(r => new RoleDetail() {
                  ID = r.ID,
                  Rolename = r.Rolename,
                  Active = r.Active,
                  Users = r.Users
                           .Select(u => new RoleDetail.RoleUser() {
                              ID = u.ID,
                              Username = u.Username
                            })
                            // .ToList()
                })
               .FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T16:34:38.253

发送到 EF LINQ 提供程序的 LINQ 查询中的所有内容都需要是 L2E 可以直接转换为 SQL 的表达式。您可以手动将 EF 可以翻译的部分与必须在 LINQ 2 对象中完成的部分分开。

执行发生在必须实际枚举查询的位置，在您的情况下就是`FirstOrDefault`调用。您可以通过调用强制查询提前执行`IQueryable.AsEnumerable()`；之后的任何内容都由 LINQ 2 Objects 处理，并且几乎可以做任何你想做的事情。

在您的情况下，您的 lambda 表达式唯一不可翻译的方面是对 的调用`ToList`，它没有等效的数据库，因此您不能简单地调用它；这样做的缺点是您的`Users`属性将被设置一些任意的内部类，这恰好是`IQueryable.Select`EF 实现的结果。这对您来说可能是也可能不是问题，这取决于您定义`RoleDetail.Users`的内容以及您对它的处理方式。

当您必须处理 EF 不喜欢的表达式时，替代方案和更普遍适用的解决方案是提前插入`AsEnumerable`调用：

```
var query = Context.Roles
           .Include("Users")
           .Where(r => r.ID == id)
           .AsEnumerable()
           .Select(r => new RoleDetail() {
              ID = r.ID,
              Rolename = r.Rolename,
              Active = r.Active,
              Users = r.Users
                       .Select(u => new RoleDetail.RoleUser() {
                          ID = u.ID,
                          Username = u.Username
                        })
                        // .ToList()
            })
           .FirstOrDefault(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T16:18:41.533

看起来它正在尝试在数据库中执行**ToList**并且不知道如何。我会尝试将其更改为**ToArray**，或者失败，将其保留为 IEnumerable。

# jquery - 我正在寻找隐藏不是所选节点父节点的节点的 jquery 树菜单

> ID：10365234
> 
> 赞同：0
> 
> 时间：2012-04-28T16:07:15.797
> 
> 标签：jquery, menu

我在这个网站上需要类似的东西：http: [//msdn.microsoft.com/en-us/library/dd251056.aspx](http://msdn.microsoft.com/en-us/library/dd251056.aspx) 左边的菜单是我想要的 - 当用户选择项目时，它会显示这个项目的孩子，但也会隐藏不是所选节点的直接父节点的所有父节点。这对于大树形菜单很有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:50:55.497

你可以这样做：

```
<ul>
    <li>
        <span>Parent</span>
        <ul>
            <li><span>Children</span></li>
            <li><span>Children</span></li>
            <li><span>Children</span></li>
        </ul>
    </li>
    <li>
        <span>Parent</span>
        <ul>
            <li><span>Children</span></li>
            <li><span>Children</span></li>
            <li><span>Children</span></li>
        </ul>
    </li>
    <li>
        <span>Parent</span>
        <ul>
            <li><span>Children</span></li>
            <li><span>Children</span></li>
            <li><span>Children</span></li>
        </ul>
    </li>
    <li>
        <ul>
            <li><span>Children</span></li>
            <li><span>Children</span></li>
            <li><span>Children</span></li>
        </ul>
    </li>
</ul>

<script>
   $('li').on('click',function(){
      $(this)
        .children()  //Selecting children for the clicked li
             .slideDown(200) //Then we show them
                .parent() //slideDown returns children again, so we'll get the parent li again
                  .siblings('li') //and then we'll call his siblings
                      .children()
                           .slideUp(200); //and finally we'll hide their children
   });
</script> 
```

显然这将需要一些 css 和更多的 javascript，但这样你可以获得一些想法。（我在这里用 SO 写了这个，我还没有测试过，所以它可能有一些错误）

# emacs - emacs伤了我的手腕，怎么把'变成Meta？

> ID：10365235
> 
> 赞同：0
> 
> 时间：2012-04-28T16:07:18.123
> 
> 标签：emacs

我在系统键盘配置中将大写锁定绑定到 Crtl，但是在将普通键重新绑定到较少使用的键之后，如何将普通键重新绑定到修饰键？

即正确地绑定`\`到`'`和（例如is并且一切都像were一样工作）。`'``Meta``Shift ' .``Meta >``'``Meta`

使用这种对称的 Crtl/Meta 键盘布局，我的手感觉不像柔术师，因此更快乐。

我试过vim，但它是模态的，所以我更喜欢emacs。

编辑：如果不可能，为什么 emacs 不让你这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T16:40:38.980

```
(global-set-key (kbd "'") esc-map)
(global-set-key (kbd "'") esc-map)
(global-set-key (kbd "\\") (lambda () (interactive) (insert-char ?' 1))) 
```

唯一的问题是不能同时按住 Shift-'->。你必须点击 ' 然后 Shift-> 来获得你想要的行为。

# php - PHP 方法/函数如何在类对象中工作

> ID：10365241
> 
> 赞同：1
> 
> 时间：2012-04-28T16:08:02.070
> 
> 标签：php, oop, class

我有这个我在 Wordpress 环境中的主题上创建的课程。

```
class Theme {
    function __construct()
    {
       add_action('after_setup_theme', array(&$this, 'do_this'));
    }

    function do_this()
    {
       require_once('helper_functions.php');
    }
}
$theme = new Theme(); 
```

在 helper_functions.php 我有：

```
function get_image()
{
    return 'working';
} 
```

但现在我很困惑，因为当我执行这个

```
echo $theme->get_image(); 
```

它不起作用....但是如果我直接调用它，它的工作原理是这样的：

```
echo get_image(); 
```

但是我想既然用的是类方法，就需要用类对象来获取类方法……为什么可以直接调用呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T16:13:20.853

很明显，你理解错了。`get_image()`在这种情况下，它不是一种方法。它只是另一个可以在脚本执行期间调用的普通函数。

要使其成为方法，您必须在类声明中声明它。

```
class Theme 
{
    function __construct()
    {
       add_action('after_setup_theme', array(&$this, 'do_this'));
    }

    function do_this()
    {
       require_once('helper_functions.php');
    }

    function get_image()
    {
        return 'working';
    }
} 
```

[在此处](http://php.net/manual/en/language.oop5.php)阅读有关对象和类的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:17:02.647

您不能拆分类定义。所有这些都需要一口气完成。如果你的班级太大，也许它有太多的责任。

*   将业务逻辑与工厂逻辑分开（工厂逻辑是实例化新对象的逻辑，业务逻辑**是**那些对象）。
*   按功能分隔类。
*   使用继承和多态。

* * *

当您在函数中包含文件时，它只存在于该函数的范围内。这意味着您所做的相当于：

```
public function do_this() {
    function get_image() { ... }
} 
```

这并没有真正做任何事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T16:20:34.280

include 和 require 通常被称为“就像将文件内容复制/粘贴”到父脚本中，这似乎是您所期待的。但是，它并不真正正确，这就是为什么你正在做的事情不起作用。

某些语言具有编译器宏，可以在解释代码之前进行文本替换，这样就可以了。但是，php 没有，并且所有包含语句都在运行时进行评估。在您的情况下，该类在执行该 require 语句之前已完全定义。结果，您只是在执行代码，它定义了一个全局函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T16:18:07.633

该函数`get_image()`不是类中设置的函数`Theme`，它设置在单独的文件中，该文件包含在类中。

如果你想让它成为类的函数，那么你需要将它写在类文件中，将代码移动到类中。

替代你可以利用类扩展

```
class Helper_functions  {

    public function get_image() {
        return "working!";
    }
} 
```

并将主题类文件更改为

```
class Theme extends Helper_functions {

    function __construct()
    {
       add_action('after_setup_theme', array(&$this, 'get_image'));
    }

}

$theme = new Theme(); 
```

**替代方案**
由于您说它是多个文件中的多个函数，您可以在主题类文件或扩展类文件中执行此操作。

```
class Theme {

    ...

    function get_image() { include('theme_file_get_image.php'); }
    function another_function { include('theme_file_another_function.php'); }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T16:18:23.730

[这个问题](https://stackoverflow.com/questions/2755500/php-require-class-call-from-inside-method)的答案总结了您在此处看到的结果：

> “包含文件中的代码与函数在同一范围内执行（定义的函数和类是全局的），而不是插入其中，替换那里的其他代码。”

所以包含文件中的函数是在全局范围内定义的，这就是调用的原因`get_image()`。

这应该等同于：

```
//Include the helper functions
require_once('helper_functions.php');

class Theme 
{
    function __construct()
    {
       add_action('after_setup_theme', array(&$this, 'do_this'));
    }

    function do_this()
    {
       get_image();
    }
}

$test = new Theme();
echo $test->do_this(); //'working'; 
```

请注意，get_image() 位于全局分数中，而**不是**Theme 类的成员函数。

# c++ - 在自定义命名空间下包含标题？

> ID：10365248
> 
> 赞同：1
> 
> 时间：2012-04-28T16:08:40.510
> 
> 标签：c++, namespaces

我在我当前的一个项目中使用第三方 C++ 库。不过，他们的 lib 没有定义自定义命名空间。所以，他们所有的功能都在那里。这没什么大不了的，但理想情况下他们会使用命名空间。

是否可以将`#include`它们的头文件放在某种自定义的伪命名空间下？这样，它们的所有功能都可以包含在名称空间中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:23:45.607

只要这会更改函数的名称（对于 C++ ），您就不能这样做。链接器会将命名空间的名称附加到函数中，因此链接将由于缺少函数而失败。

对于以下代码的实例

```
namespace MyName
{
    class MyNestedOne
    {
    public:
        void doNothing( );
    };
}; 
```

函数 doNothing 将具有以下名称 doNothing@MyNestedOne@MyName@@

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:06:35.107

正如您所说，如果它们在名称空间中会更好。然而，这并不是什么大问题。

或者，如果您能够使用 .dll 而不是 .lib，则可以动态绑定、使用它，然后放手。这样您就不会在整个运行时使用浮动函数。

# javascript - 用 jQuery 操作 DOM 时代码不同步？

> ID：10365249
> 
> 赞同：2
> 
> 时间：2012-04-28T16:09:39.040
> 
> 标签：javascript, jquery, dom, css-transitions

我有这个功能：

```
var decreaseBar = function (barElement) {
   insertCSSTransitions(barElement);
   $(barElement).find('.bar').width(0);
} 
```

函数，这样`insertCSSTransitions(barElement)`做：

```
var insertCSSTransitions = function (barElement) {
      var timeBar = settings.timeBar;
      $(barElement).find('.bar').attr('style', 'transition:width ' + timeBar + 's; -moz-transition:width ' + timeBar + 's; -webkit-transition:width ' + timeBar + 's; -o-transition:width ' + timeBar + 's');
} 
```

发生的情况是：在cssTransitions 的样式起作用之前将`$(barElement).find('.bar').width(0);`行设置为 0。`width`

因为，如果我修改`decreaseBar`函数，它可以工作：

```
var decreaseBar = function (barElement) {
   insertCSSTransitions(barElement);

   // set a delay of 1 second before set to 0
   setTimeout(function() {
      $(barElement).find('.bar').width(0);
   }, 1000)
} 
```

用 jQuery 操作 DOM 时代码不同步？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T16:25:17.210

这里可能发生的情况是`insertCSSTransitions()`，在您重新绘制浏览器的释放控制之前，所做的样式更改无效。

您真的只需要使用`setTimeout(..., 1)`来确保在浏览器处理完`transition`样式后完成对元素宽度的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T16:30:54.490

使用回调？

```
var decreaseBar = function (barElement) {
   insertCSSTransitions(barElement, function() {
       $(barElement).find('.bar').width(0);
   });
}

var insertCSSTransitions = function (barElement, callback) {
    var timeBar = settings.timeBar;
    $(barElement).find('.bar').attr('style', 'transition:width ' + timeBar + 's; -moz-transition:width ' + timeBar + 's; -webkit-transition:width ' + timeBar + 's; -o-transition:width ' + timeBar + 's');

    setTimeout(function() {callback.call();}, timebar*1000);
} 
```

这只是一个简单的回调示例，它不会等待 CSS 转换发生，并且应该有一个简单的 typeof 检查来查看回调是否是一个函数，如果它也用于其他用途。

编辑：

正如 Pointy 指出的那样，回调并没有做太多事情，除了显示它是如何完成的等等。将回调绑定到转换结束可能是要走的路，但是该属性有一堆前缀，在这里用一些简单的浏览器解决检测，但有一些库可以检查浏览器中的实际支持。

```
var insertCSSTransitions = function (barElement, callback) {
    var timeBar = settings.timeBar,
        transitionEnd = "TransitionEnd";
    if ($.browser.webkit) {transitionEnd = "webkitTransitionEnd";}
    else if ($.browser.mozilla) {transitionEnd = "transitionend";}
    else if ($.browser.opera) {transitionEnd = "oTransitionEnd"; }

    $(barElement).find('.bar')
                 .attr('style', 'transition:width ' + timeBar + 's; -moz-transition:width ' + timeBar + 's; -webkit-transition:width ' + timeBar + 's; -o-transition:width ' + timeBar + 's');
                 .on(transitionEnd, function() {
                     callback.call();
    });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-10T21:55:10.970

JavaScript is always synchronous unless an AJAX call is being made: [When is JavaScript synchronous?](https://stackoverflow.com/questions/2035645/when-is-javascript-synchronous).

Your code is not working because you are using a CSS transition which would not be synchronous with JavaScript. JavaScript is "adding" the style transitions to the DOM and once complete, moving on.

I'm not quite sure of the purpose of your functions, so its difficult to come up with a better solution. All-in-all, it is usually bad practice to have JavaScript add hard coded styles like you are doing.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T16:35:17.507

人们谈论异步行为就像它是圣杯一样，但是当你想要它时让 JS 同步通常是更困难的任务。[Frame.js](https://github.com/bishopZ/Frame.js)（与其他流控制库如 asnyc 和 flow.js 一样）旨在解决这个问题。在 Frame 中，您将执行以下操作：

```
var decreaseBar = function (barElement) {
    Frame(function(next)){
        insertCSSTransitions(barElement);
        next();
    });
    Frame(function(next)){
        $(barElement).find('.bar').width(0);
        next();
    });
    Frame.init();
} 
```

# collections - 什么决定了何时创建集合？

> ID：10365253
> 
> 赞同：1
> 
> 时间：2012-04-28T16:09:57.937
> 
> 标签：collections, clojure, side-effects

如果我理解正确，Clojure 可以返回列表（就像在其他 Lisps 中一样），也可以返回向量和集合。

我真正不明白的是为什么并不**总是**有一个集合被返回。

例如，如果我采用以下代码：

```
(loop [x 128]
  (when (> x 1)
    (println x)
    (recur (/ x 2)))) 
```

它确实打印了 128 64 32 16 8 4 2。但这只是因为*println*被调用并且*println*具有打印某些东西的副作用（？）。

所以我尝试用这个替换它（删除println）：

```
(loop [x 128]
  (when (> x 1)
    x
    (recur (/ x 2)))) 
```

我期待得到一些收集（据说是一个列表），像这样：

```
(128 64 32 16 8 4 2) 
```

但相反，我得到了*nil*。

我不明白哪个决定了什么创建一个集合，什么没有，以及你如何从一个切换到另一个。此外，看到 Clojure 以某种方式鼓励了“函数式”编程方式，您不应该几乎总是返回集合吗？

为什么有这么多显然不返回任何集合的函数？制作这些退货系列的惯用方式是什么？

例如，我将如何通过首先构造一个集合然后以一种惯用的方式迭代（？）而不是生成的列表/向量来解决上述问题？

首先，我不知道如何转换*循环*以使其产生除*nil*以外的其他内容，然后我尝试了以下操作：

```
(reduce println '(1 2 3)) 
```

但它打印*“1 2nil 3nil”*而不是我期待的*“1 2 3nil” 。*

我意识到这是基本的东西，但我才刚刚开始，我显然在这里缺少基本的东西。

*（PS：适当地重新标记，我不知道我应该在这里使用哪些术语）*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T18:53:44.087

其他一些评论指出，when 不像 if 那样真正起作用 - 但我不认为这真的是你的问题。

loop 和 recur 形式创建了一个迭代 - 就像其他语言中的 for 循环一样。在这种情况下，当您打印时，确实只是为了副作用。如果你想返回一个序列，那么你需要构建一个：

```
(loop [x 128                                                                                                        
       acc []]                                                                                                      
  (if (< x 1)                                                                                                       
    acc                                                                                                             
    (recur (/ x 2)                                                                                                  
           (cons x acc))))                                                                                          

=> (1 2 4 8 16 32 64 128) 
```

在这种情况下，我将调用 printf 的位置替换为 recur*和*将 x 添加到该累加器前面的表单。在 x 小于 1 的情况下，代码返回累加器 - 因此是一个序列。如果要添加到向量的末尾而不是前面，请将其更改为 conj：

```
(loop [x 128                                                                                                    
       acc []]                                                                                                  
  (if (< x 1)                                                                                                   
    acc                                                                                                         
    (recur (/ x 2)                                                                                              
           (conj acc x))))                                                                                      

=> [128 64 32 16 8 4 2 1] 
```

你得到 nil 因为那是你的表达式的结果——最终 println 返回的结果。

这一切有意义吗？

reduce 并不完全相同——它用于通过重复将二进制函数（一个接受 2 个参数的函数）应用于初始值和序列的第一个元素，或序列的前两个元素来减少列表第一次迭代的序列，然后后续迭代传递上一次迭代的结果和序列中的下一个值。一些示例可能会有所帮助：

```
(reduce + [1 2 3 4])                                                                                            

10 
```

这将执行以下操作：

```
(+ 1 2) => 3
(+ 3 3) => 6
(+ 6 4) => 10 
```

归约将导致最终结果来自正在执行的二进制函数——在这种情况下，我们将序列中的数字归约为所有元素的总和。

您还可以提供初始值：

```
(reduce + 5 [1 2 3 4])                                                                                            

15 
```

它执行以下操作：

```
(+ 5 1)  => 6
(+ 6 2)  => 8
(+ 8 3)  => 11
(+ 11 4) => 15 
```

高温下，

凯尔

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-29T05:40:39.410

对集合的广义抽象在 Clojure 中称为序列，许多数据结构都实现了这种抽象，因此您可以在这些数据结构上使用所有与序列相关的操作，而无需考虑将哪个数据结构传递给您的函数。

就示例代码而言——循环，recur 用于递归——所以基本上任何你想用递归解决的问题都可以用它来解决，经典的例子是阶乘。虽然您可以使用循环创建向量/列表 - 通过将累加器用作向量并继续向其附加项目并在递归返回累积向量的存在条件下 - 但您可以使用`reductions`和`take-while`函数来执行此操作，如下所示。这将返回一个惰性序列。

前任：

```
(take-while #(> % 1) (reductions (fn [s _] (/ s 2)) 128 (range))) 
```

# ruby-on-rails - 错误：在任何存储库中都找不到有效的 gem 'digest' (>= 0) - 为什么我不能安装/找到 Digest gem？

> ID：10365258
> 
> 赞同：2
> 
> 时间：2012-04-28T16:10:28.090
> 
> 标签：ruby-on-rails, ruby, rubygems

我目前正在学习 Michael Hardtl 的 Rails 教程，在第 7 章中有一段代码以`require 'digest'`. 我运行`sudo gem install digest`并收到无法找到摘要 gem 的错误。

我用谷歌搜索了一下，似乎没有任何线索表明这个宝石变成了什么。关于如何进行的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T16:15:58.163

它不是宝石，而是 ruby​​ 标准库的一部分

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-28T16:26:59.877

根据您正在运行的 ruby​​ 版本，您不需要这样做。

例如，如果您正在运行 ruby​​ 1.9.3~。

您可以在控制台尝试：

```
Loading development environment (Rails 3.2.3)
1.9.3-p125 :001 > Digest::SHA2.hexdigest("test")
 => "9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08" //result
1.9.3-p125 :002 > 
```

# php - 邮件问题到数据库

> ID：10365259
> 
> 赞同：0
> 
> 时间：2012-04-28T16:10:41.570
> 
> 标签：php, database, mysqli

我刚刚开始构建，以便您收到一封电子邮件给他，所以这意味着在您进入页面之前批准用户电子邮件。

```
if( !isset( $user_found)) {
     //sende email til brugere
     $code = rand(111111111, 999999999);
     //sendere info til brugere.
     $to = $email;
     $subject = "Activate din brugere - .....dk";
     $headers = "From: support@...dk";
     //indhold til email
     $body = "Hej";

     if(empty($errors))
     {
         if ($stmt = $mysqli->prepare('INSERT INTO `brugere` (`email`, `password`) VALUES (?, ?)')) {
             /* Bind parametre */
             $stmt->bind_param('ss', $email, $password);

             /* SÃ¦t vÃ¦rdier pÃ¥ parametrene */
                $email = $_POST["email"];
             $password = sha1($_POST["password"]);

             $stmt->execute();
             /* Luk statement */
             $stmt->close();

             echo "<div id=\"box\"><ul><li>Godkendt brugere</li></ul></div>";

         } else {
             /* Der er opstÃ¥et en fejl */
             echo 'Der opstod en fejl i erklÃ¦ringen: ' . $mysqli->error;
         }
     }
 } 
```

正是这样，$ 代码必须制作一个边缘代码，以便用户在之后对链接执行某些操作。

```
<?php

if(!empty($_POST))
{              
    if ($stmt = $mysqli->prepare('SELECT * FROM `brugere` WHERE `email` = ?')) {  
        $stmt->bind_param('s', $email);
        $email = $_POST['email'];
        $stmt->execute();
        $stmt->store_result();
        $count = $stmt->num_rows;
        $stmt->close();
         if ($count > 0)
        {
            $user_found = 1;
        }
    }
    else {
        /* Der er opstÃ¥et en fejl */
        echo 'Der opstod en fejl i erklÃ¦ringen: ' . $mysqli->error;
    }
    if(!isset($user_found)) {

        //sendere info til brugere.
        $to = $email;
        $subject = "Activate din brugere - .....dk";
        $headers = "From: support@...dk";
        //indhold til email
        $body = "test";

        if(empty($errors))
        {
            if ($stmt = $mysqli->prepare('INSERT INTO `brugere` (`email`, `password`, `code`) VALUES (?, ?, ?)')) {
                /* Bind parametre */
                $stmt->bind_param('ss', $email, $password, $code);

                /* SÃ¦t vÃ¦rdier pÃ¥ parametrene */
                $email = $_POST["email"];
                $password = sha1($_POST["password"]);
                $code;

                $stmt->execute();
                /* Luk statement */
                $stmt->close();

                echo "<div id=\"box\"><ul><li>Godkendt brugere</li></ul></div>";

            } else {
                /* Der er opstÃ¥et en fejl */
                echo 'Der opstod en fejl i erklÃ¦ringen: ' . $mysqli->error;
            }
        }
    }
    else {
        echo "<div id=\"box\"><ul><li>Der findes allerede en bruger med denne mail</li></ul></div>";
    }
}

?> 
```

这就是我的代码的样子，

我想要的是 $ 代码就在其数据库中，并将通过电子邮件发送给用户......

**在这里询问是否有更多需要了解的信息。**

毕竟问问题；

```
 <?php
// multiple recipients
$to  = 'aidan@example.com' . ', '; // note the comma
$to .= 'wez@example.com';

// subject
$subject = 'Birthday Reminders for August';

// message
$message = '
<html>
<head>
  <title>Birthday Reminders for August</title>
</head>
<body>
  <p>Here are the birthdays upcoming in August!</p>
  <table>
    <tr>
      <th>Person</th><th>Day</th><th>Month</th><th>Year</th>
    </tr>
    <tr>
      <td>Joe</td><td>3rd</td><td>August</td><td>1970</td>
    </tr>
    <tr>
      <td>Sally</td><td>17th</td><td>August</td><td>1973</td>
    </tr>
  </table>
</body>
</html>
';

// To send HTML mail, the Content-type header must be set
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

// Additional headers
$headers .= 'To: Mary <mary@example.com>, Kelly <kelly@example.com>' . "\r\n";
$headers .= 'From: Birthday Reminder <birthday@example.com>' . "\r\n";
$headers .= 'Cc: birthdayarchive@example.com' . "\r\n";
$headers .= 'Bcc: birthdaycheck@example.com' . "\r\n";

// Mail it
mail($to, $subject, $message, $headers);
?> 
```

我该怎么做才能使用电子邮件进入**$to = 'aidan@example.com'**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T16:27:33.083

首先，如果你能用英文写输出会更好。

在邮件中发送查询字符串，例如

yourpage.php?user=someuserid&code=randomcode

只需在页面中检查用户是否通过您提供的查询字符串。如果他来直接将他发送到错误页面。如果他正在检查您使用 rand 函数创建的代码。如果存在，请在页面中显示内容。

代码可能如下所示。

```
<?php
if(empty($error))
{
show_content();
}
?> 
```

或者您可以将用户重定向到您想要的任何页面。

检查查询字符串的代码。

```
<?php
if(!isset($_GET['qstring'])) // qstring for query string name
{
// redirect to error page
}
else
{
$qstring = $_GET['qstring'];

//$res_code= mysql_query ()........... (result of )
//check for availability of your random code and the userid in your database table\
if(mysql_num_rows($res_code) > 0)
{
show_content();
}
else
{
//again redirect to error page or index page.
}
}
?> 
```

如果代码可用，则显示内容。您可以使用 switch case 而不是 if。这取决于你。

希望这对你有帮助，哥们。

# ios - 在 for 循环中使用 UIAlertViews 对 Xcode 中的数字求和

> ID：10365262
> 
> 赞同：1
> 
> 时间：2012-04-28T16:11:09.917
> 
> 标签：ios, xcode, uialertview

我正在尝试在 for 循环中使用 UIAlertViews 来汇总应在警报视图的文本框中输入的数字，但问题是警报显示的次数与 for 循环运行的次数一样多，我不知道如何制作循环等待警报视图上的按钮按下，然后再次循环。在下面的示例中，我希望警报视图出现 3 次，以便我可以输入三个数字，然后找到这些数字的总和。有人可以帮我吗？下面是我的代码。谢谢

```
int noOfInductorsSelected=3;

for (int i=1; i<=noOfInductorsSelected; i++) {
    NSString *counter = [NSString stringWithFormat:@"Enter Value for Inductor no %d :",i];
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Inductance Value" message:counter delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"Enter", nil];
    alert.alertViewStyle = UIAlertViewStylePlainTextInput;
    [alert show];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T16:31:05.167

这是一个相当有问题的界面，您可能需要考虑考虑您需要什么以及是否有更好的方法来收集该信息。

但是，如果您必须这样做，而不是在 for 循环中运行警报，您需要一个实例变量来存储迭代次数和到目前为止输入的值的总和。那么，在

```
-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex 
```

在您获得用户输入的值的地方，您将增加您的计数器并调用该方法以再次显示警报。我不确定您是否应该直接从 alertView:clickedButtonAtIndex: 显示警报，但您最好使用 performSelecter:wihtObject:afterDelay: 以便应用程序可以通过运行循环正常继续。

# java - 使用冒号 (":") 的 Java 字符串拆分未按预期工作

> ID：10365263
> 
> 赞同：1
> 
> 时间：2012-04-28T16:11:14.547
> 
> 标签：java, split, colon

我正在尝试删除此字符串的秒数：

```
10/31/2009 9:46:16 AM 
```

我正在尝试使用以下功能来做到这一点：

```
public static String correctValue4(String str) {
    String parts[] = str.split(":");
    String fixedStr = parts[0] + ":" + parts[1];
    return fixedStr;
} 
```

我想它会解析它并获得 10/31/2009 9，然后在末尾添加 46。但是，我在运行时收到“java.lang.ArrayIndexOutOfBoundsException: 1”错误。显然，它没有拿起零件[1]。

有任何想法吗？

对于额外的业力：我需要将 AM/PM 附加到字符串的末尾。所以，最后它应该是这样的：

```
10/31/2009 9:46 AM 
```

谢谢，非常感谢您的帮助=）

编辑：

对不起，我应该更具体地说明日期。我正在做的是将制表符分隔的文本文件接受到应用程序中，然后对其进行格式化并将其输出到新文件中。我需要做的就是根据请求从日期中删除秒数并输出它；我想我只是把它复杂化了。

蒂姆的回答在这种情况下有效！

谢谢大家提供建议！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T16:15:57.217

我会建议一种完全不同的方法：将值解析为适当的特定于域的类型（我会`LocalDateTime`从[Joda Time](http://joda-time.sf.net)使用），然后将其重新格式化为您想要的格式。这将同时执行验证，因此您不会仅仅因为它恰好有一个冒号就通过您的系统传播不良数据。

Joda Time 提供解析和格式化工具（请参阅[`DateTimeFormat`](http://joda-time.sourceforge.net/api-release/org/joda/time/format/DateTimeFormat.html)和[`DateTimeFormatter`](http://joda-time.sourceforge.net/api-release/org/joda/time/format/DateTimeFormatter.html)），所以它应该非常简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T16:18:13.720

你为什么不使用[SimpleDateFormat](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)？

首先解析日期：

`Date d = new SimpleDateFormat("MM/dd/yyyy h:mm:ss a").format(str);`

然后格式化日期：

`new SimpleDateFormat("MM/dd/yyyy h:mm a").format(d);`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T16:14:09.707

如果空格是紧随其后的下一个字符，您就不能删除后跟两位数字的冒号吗？

```
String resultString = subjectString.replaceAll(":\\d{2}(?= )", ""); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T16:19:44.780

如果字符串始终具有相同的格式（以 2 位数字结尾，一个空格，它们是 AM 或 PM），您可以`substring`使用每个`String`实例上可用的方法提取相关部分

```
String original = "10/31/2009 9:46:16 AM";
//-6 since we want to remove the : as well
String firstPart = original.substring( 0, original.length() - 6 );
String secondPart = original.substring( original.length() - 3, original.length() );
String result = firstPart + secondPart; 
```

# objective-c - 在 dealloc 中释放 ivars 给出“指针被释放未分配”错误

> ID：10365267
> 
> 赞同：0
> 
> 时间：2012-04-28T16:12:11.740
> 
> 标签：objective-c, cocoa-touch, memory-management, properties

我定义了以下属性：

```
@property (nonatomic, retain) NSString *name_;
@property (nonatomic, retain) NSString *profilePicture_;
@property (nonatomic, retain) NSString *username_;
@property (nonatomic, retain) NSString *id_; 
```

我`init...`像这样设置它们：

```
-(id)initWithData:(NSDictionary *)data
{
    self = [super init];
    if (!self) {
        return nil;
    }

    name_ = [data valueForKey:@"full_name"];
    profilePicture_ = [data valueForKey:@"profile_picture"];
    username_ = [data valueForKey:@"username"];
    id_ = [data valueForKey:@"id"];

    return self;
} 
```

具有以下内容`dealloc`：

```
-(void)dealloc
{
    [name_ release];
    [username_ release];
    [profilePicture_ release];
    [id_ release];
    [super dealloc];
} 
```

但是这`dealloc`给了我一个错误：

> 被释放的指针未被分配

为什么是这样？我必须做吗`[[NSString alloc] init...]`？`[NSString stringWithString:]`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T16:15:59.643

`valueForKey:`将返回一个自动释放的对象，因此您没有所有权。因为它们都是字符串，你可以`copy`像这样调用

```
name_           = [[data valueForKey:@"full_name"] copy];
profilePicture_ = [[data valueForKey:@"profile_picture"] copy];
username_       = [[data valueForKey:@"username"] copy];
id_             = [[data valueForKey:@"id"] copy]; 
```

您还应该更改`@property`要使用的声明，`copy`因为这通常建议用于字符串。

另一种选择是通过综合访问器，但我通常避免这样`init`做`dealloc`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T16:15:08.140

这是因为您要分配*给*`initWithData`. 你应该使用重写你的代码如下：

```
self.name_ = [data valueForKey:@"full_name"];
self.profilePicture_ = [data valueForKey:@"profile_picture"];
self.username_ = [data valueForKey:@"username"];
self.id_ = [data valueForKey:@"id"]; 
```

这将通过需要`[retain]`您的属性分配值。您现在编写代码的方式，只是将指针复制到 ivars 而不调用`[retain]`，这最终导致了您描述的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-07T11:40:38.673

由于您使用的是字典中的数据，因此您应该使用 self 关键字通过属性设置值。

如果它没有解决，那么问题可能不在你的类中，而可能在你创建它的实例的地方。尝试检查您分配和释放此类实例的代码。

您还应该使用 Simulator & NSZombies 分析您的应用程序 n 确定您过度释放对象的位置。

# html - 页面底部大约 12 像素的空白不属于任何元素？

> ID：10365268
> 
> 赞同：1
> 
> 时间：2012-04-28T16:12:14.020
> 
> 标签：html, css, drupal

我的页面底部有 12 像素的空白区域。在检查 CSS 时，它不会归因于任何元素。根据 CSS 检查员的说法，body 和 html 元素的高度都不包括这个空间......这让我很生气。

如果您想看一下，该页面就在这里：[Page](http://funjable.com/rarediseaseproject/)

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T16:37:50.167

将您的内容`.clearfix`从 a更改`.`为`\0020`（这是一个空格）。这可以解决问题：

```
.clearfix:after {
    clear: both;
    content: "\0020"; /* change to this */
    display: block;
    height: 0;
    visibility: hidden;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T16:34:18.987

如果您将 #footer-wrapper 更改为此它将解决您的问题

```
#footer-wrapper {
    background-image: url('../images/green.jpg');
    height: auto;
    overflow: hidden;
    } 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T16:30:16.070

其中一部分与您的`.clearfix::after`. 我添加了一个`line-height:0`，大部分都消失了。我认为您通常在页面上的行高与布局有点搞砸了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T16:44:21.753

如果您不想更改 line-height 或其他内容，您可以像这样在页脚中添加填充：

```
#footer-wrapper {
    margin-top: 35px;
    padding-bottom: 20px;
} 
```

# java - 忽略右键单击并改为移动单击

> ID：10365272
> 
> 赞同：0
> 
> 时间：2012-04-28T16:12:36.580
> 
> 标签：java, sikuli

是否有可能（在 sikuli/java 中）使右键单击事件形成一个移位单击，而忽略右键单击通常会发生什么？

谢谢，

奥丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:34:25.900

您可以尝试创建一个将“覆盖”右键单击方法的 Sikuli 包装器。如果您随后使用包装器，那么您的所有脚本都将执行移位单击而不是右键单击。

sikuliwrapper.py

```
...
from sikuli.Sikuli import Region as SikuliRegion
...

class Region(SikuliRegion, BaseLogger):

    def rightClick(self, target, modifiers=0):
        try:
            keyDown(Key.SHIFT)
            SikuliRegion.click(self, target, modifiers)
            KeyUp(Key.SHIFT)
        except FindFailed, e:   
            raise e 
```

所以每当你有例如

```
myreg = Region(0,0,300,300)
myreg.rightClick("pattern.png") 
```

您实际上将在图像上执行 Shift 单击。

希望我能正确理解你想要什么。有关如何在此处为 sikuli 编写包装器的更多信息：http: [//blog.mykhailo.com/2011/02/how-to-sikuli-and-robot-framework.html#step3](http://blog.mykhailo.com/2011/02/how-to-sikuli-and-robot-framework.html#step3)

# java - servlet-context error

> ID：10365278
> 
> 赞同：1
> 
> 时间：2012-04-28T16:13:22.803
> 
> 标签：java, spring, hibernate

I have the following servlet-context, basically, I'm using springmvc and I'm trying to configure it to use @autowire on my session bean.

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <!-- DispatcherServlet Context: defines this servlet's request-processing 
        infrastructure -->

    <!-- Enables the Spring MVC @Controller programming model -->
    <annotation-driven />

    <!-- Handles HTTP GET requests for /resources/ ** by efficiently serving 
        up static resources in the ${webappRoot}/resources directory -->
    <resources mapping="/resources/**" location="/resources/" />

    <!-- Resolves views selected for rendering by @Controllers to .jsp resources 
        in the /WEB-INF/views directory -->
    <beans:bean
        class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <beans:property name="prefix" value="/WEB-INF/views/" />
        <beans:property name="suffix" value=".jsp" />
    </beans:bean>

     <beans:bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <beans:property name="annotatedClasses">
        <beans:list>
            <beans:value>org.assessme.com.entity.User</beans:value>
        </beans:list>
    </beans:property>
        <beans:property name="dataSource" ref="dataSource" />
        <beans:property name="packagesToScan" value="data" />
        <beans:property name="hibernateProperties">
            <beans:props>
                <beans:prop key="hibernate.dialect">org.hibernate.dialect.H2Dialect</beans:prop>
                <beans:prop key="hibernate.current_session_context_class">thread</beans:prop>
                <beans:prop key="hibernate.transaction.factory_class">org.hibernate.transaction.JDBCTransactionFactory</beans:prop>
                <beans:prop key="hibernate.show_sql">true</beans:prop>
                <beans:prop key="hibernate.hbm2ddl.auto">update</beans:prop>
            </beans:props>
        </beans:property>
    </beans:bean>

    <context:component-scan base-package="org.assessme.com" />

    <beans:bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
        <beans:property name="mediaTypes">
            <beans:map>
                <beans:entry key="html" value="text/html" />
                <beans:entry key="json" value="application/json" />
            </beans:map>
        </beans:property>
        <beans:property name="defaultViews">
            <beans:list>
                <beans:bean
                    class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
                    <beans:property name="prefixJson" value="true" />
                </beans:bean>
            </beans:list>
        </beans:property>
    </beans:bean>

</beans:beans> 
```

The error is...

```
Multiple annotations found at this line:
- Class 'org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean' not found
- Class 'org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean' not found [config set: assessment/web-context] 
```

The line it refers to is

```
<beans:bean id="sessionFactory" class="org.springframework.orm.hibernate3...." 
```

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:25:46.650

It looks like you are missing spring-orm.jar.

Make sure that this is in Project lib folder.

If you are using maven than you need to add the following

```
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-orm</artifactId>
    <version>${spring.version}</version>
</dependency> 
```

# java - CharBuffer 上的 Java NIO 问题

> ID：10365280
> 
> 赞同：5
> 
> 时间：2012-04-28T16:13:33.143
> 
> 标签：java, nio

我正在使用以下代码从文件中读取子序列。

```
FileChannel channel = new RandomAccessFile("abc.txt", "r").getChannel();
ByteBuffer buffer = channel.map(FileChannel.MapMode.READ_ONLY, 0, channel.size());
CharBuffer cbuf = buffer.asCharBuffer();

String str = cbuf.subSequence(0, 1).toString();
System.out.println("str = " + str); 
```

但是，这会给出输出“str = ?” 任何人都可以帮助我为什么会发生这种情况以及如何解决这个问题？抱歉，我是 NIO 的新手。

附加的东西，当我添加 System.out.println(buffer); 它给出输出“java.nio.DirectByteBufferR[pos=0 lim=16 cap=16]”。

System.out.println((char)buffer.get(0)) 给出正确的输出意味着第一个字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T16:35:15.617

试试这个方法，你有一个编码问题：

```
 FileChannel channel = new RandomAccessFile("/home/alain/Bureau/clair.txt", "r").getChannel();
    ByteBuffer buffer = channel.map(FileChannel.MapMode.READ_ONLY, 0, channel.size());
    Charset chars = Charset.forName("ISO-8859-1");
    CharBuffer cbuf = chars.decode(buffer);
    String str = cbuf.subSequence(0, 10).toString();
    System.out.println("str = " + str); 
```

# facebook - Facebook 给了我一个“请求 HTTP 重定向的 URL，但无法遵循”。但是浏览器没有问题，我该如何解决？

> ID：10365283
> 
> 赞同：3
> 
> 时间：2012-04-28T16:13:49.460
> 
> 标签：facebook

我的 URL 是[http://citynomads.com](http://citynomads.com)，它重定向到[http://www.citnomads.com](http://www.citnomads.com)并且浏览器很好地遵循了重定向，但 Facebook 的 linter 告诉我它不能跟随链接。我不明白为什么它有这个问题：

```
$ curl -i citynomads.com
HTTP/1.1 302 Moved Temporarily
Server: nginx/1.0.8
Date: Sat, 28 Apr 2012 16:12:38 GMT
Content-Type: text/html
Content-Length: 160
Connection: keep-alive
Location: http://www.citynomads.com/

<html>
<head><title>302 Found</title></head>
<body bgcolor="white">
<center><h1>302 Found</h1></center>
<hr><center>nginx/1.0.8</center>
</body>
</html> 
```

Linter：[https ://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fcitynomads.com](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fcitynomads.com)

我该如何纠正？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-08T22:08:54.587

我认为这是一个 FB linter 错误。您给定的 linter 链接现在可以工作（有一些其他奇怪的警告，但不是重定向失败......）
这也发生在我身上，但是将相同的 url 发布到 facebook 确实会生成正确的预览，所以我在这里猜测......

不会是他们的第一个错误，也不会是最后一个...

高温高压

# directx - 为什么对平坦地形使用三角测量？

> ID：10365284
> 
> 赞同：3
> 
> 时间：2012-04-28T16:13:51.237
> 
> 标签：directx, mesh, triangulation, tesselation

我见过很多线模式的地形，所有地形都使用三角形。如果您将它用于不同的高度，我就明白了，但是为什么人们在地形中的平坦区域使用这么多三角形？如果有一个大的平坦区域，创建一个大正方形或至少一个大三角形（尽可能大）而不是使用这么多小三角形不是明智的吗？

所以我的问题是，是否有理由这样做（也许是纹理）？我知道镶嵌做了类似的事情，但从我的角度来看仍然留下了太多的三角形。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T16:18:11.503

可能的原因：

1.  他们没有地形优化程序。
2.  他们使用顶点照明。除非地形是密集的三角形，否则它看起来会很糟糕。
3.  着色器不适用于大三角形。在三角形上插入巨大的值（如灯光方向等）可能会导致精度问题。
4.  物理引擎不适用于巨大的三角形。
5.  巨大的三角形会导致伪影（我认为纹理重复数量存在硬件相关限制）。
6.  跨地形的多种材料（超过 8 种）。这将超出某些卡的多重纹理限制，因此有必要分割地形。
7.  跨地形、流域的多种不同材料或区域。不同的材质可能需要不同的纹理坐标等，如果地形顶部有某种第二组坐标（优化的展开光照贴图），您将无法使用一个大的平面三角形。
8.  具有多个来源的每像素照明。如果您有多个光源，并且想同时使用它们，您可能必须使用加法 alpha 混合。使用三角地形，您可以挑选出受此特定资源影响的小区域，并使用来自该光源的附加镜面反射重新绘制它。如果你只是用剪切平面切割大三角形，你会看到 z-fighting。如果您不选择地形光影响的小区域，则必须重新绘制整个地形，这很可能导致性能下降（填充率/着色器性能，因为许多像素被重新绘制）。

# javascript - click() 的 jQuery 回调不起作用

> ID：10365285
> 
> 赞同：0
> 
> 时间：2012-04-28T16:13:53.903
> 
> 标签：javascript, jquery, html, jsp, tomcat

我想做一个简单的动画点击这个链接

```
<a id="C" href="http://www.google.com">Make me disappear</a> 
```

回调是

```
$("#C").click(function(event) {
    event.preventDefault();
    $(this).hide("slow");
}); 
```

在[jfiddle](http://jsfiddle.net/qh4ua/1/)上我的代码有效时，我无法在 jsp 页面上运行此回调。我在另一个导入的文件中编写了 js 代码

```
<script type="text/javascript" src="scripts/lib.js"></script> 
```

我很确定 jQuery 和 lib.js 被包含在内，因为从开发者工具控制台（在 Chromium 上）我可以让它做动画；此外，它们都在开发人员工具的脚本选项卡中。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T16:20:05.260

请注意，在 jfiddle 上，它在页面`onload`函数中包含了您的 jQuery 点击处理程序；你在你的 lib.js 文件中这样做吗？

```
$(function() {
    $("#C").click(function(event) {
        event.preventDefault();
        $(this).hide("slow");
    });
}); 
```

（Using`$(function() {});`是在 DOM 准备好时运行该代码的简写 - 请参阅[jQuery .ready() 文档](http://api.jquery.com/ready/)。）

甚至更好：

```
(function($) {
  // do your stuff here
})(jQuery); 
```

能够处理未来可能发生的冲突。

# objective-c - Uilabel 和一个表格单元

> ID：10365290
> 
> 赞同：0
> 
> 时间：2012-04-28T16:14:18.357
> 
> 标签：objective-c, xcode, ios5, uitableview

一个小问题我创建了一个自定义 UITablecell 但在单元格中它需要解析数据所以我连接`IBOutlet UILabel *One;`到 UILabel 但是当我在做

One.text = @"Lorem..."; 出现错误显示我在 mijn viewController 中导入了 UITablecell.h。

```
**Use of undeclared identifier 'One'** 
```

/

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        static NSString *CellIdentifier = @"Cell";

       ViewControllerCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
        if (cell == nil) {

            NSArray* views = [[NSBundle mainBundle] loadNibNamed:@"ViewControllerCell" owner:nil options:nil];

            for (UIView *view in views) {
                if([view isKindOfClass:[UITableViewCell class]])
                {
                    cell = (ViewControllerCell*)view;
                }

            }

        }
One.text = @"Lorem...";
            return cell;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:25:56.333

在这种情况下，您的自定义`UITableViewCell`类的实例将是`cell`，因此您需要像这样访问它

```
cell.One.text = @"Lorem.."; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T12:58:44.497

首先，您必须将 tableViewCell 类型转换为您的自定义单元格。

```
{
  YourCustomCell *objCustomCell=(YourCustomCell *)[tableView cellForRowAtIndexPath:indexPathForThatRow];
  objCustomCell.One.text=@"YourDesiredstringvalue";
} 
```

# c# - Windows Phone 使用 Listbbx 绑定列表框

> ID：10365291
> 
> 赞同：0
> 
> 时间：2012-04-28T16:14:26.120
> 
> 标签：c#, wpf, windows-phone-7

我有一堂课，里面有一张图片列表。

```
 public class RSSClass
{
public string Title { get; set; }
public string Summary { get; set; }
public string PubDate { get; set; }
public List<ImageData> ImagePath { get; set; }

public class ImageData
{
    public Uri ImageLocation
    {
        get;
        set;
    }
}
} 
```

她的 XAML

```
 <ListBox Name="lstRSS">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel>
                            <StackPanel.Resources>
                            </StackPanel.Resources>
                            <TextBlock Text="{Binding Path=Title}"> </TextBlock>
                            <TextBlock Text="{Binding Path=PubDate}"></TextBlock>
                            <TextBlock Text="{Binding Path=Summary}"></TextBlock>
                            <ListBox x:Name="ImageListBox" ItemsSource="{Binding ImagePath}">
                                    <DataTemplate>
                                        <Image x:Name="image1" Source="{Binding}" MaxHeight="80" MaxWidth="120" Margin="0"></Image>
                                    </DataTemplate>
                            </ListBox>
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox> 
```

内部列表框 ImageListBox 绑定并显示 Uri 的字符串值。我只是不确定将内部列表框 image1 中的图像绑定到什么？

非常感谢任何帮助。

问候罗斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:42:59.133

`<ListBox.ItemTemplate>`你在你的周围失踪了`<DataTemplate>`。这使 ListBox 感到困惑，因此它认为它实际上是一个项目，而不是模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T03:08:27.983

实现@Euphoric 的分辨率后，将image1 的源绑定到ImageLocation。例子：

```
<Image x:Name="image1" Source="{Binding ImageLocation}" MaxHeight="80" MaxWidth="120" Margin="0"></Image> 
```

# css - 百分比高度与父元素的边距

> ID：10365295
> 
> 赞同：1
> 
> 时间：2012-04-28T16:14:49.210
> 
> 标签：css, layout, positioning

这是小提琴：http: [//jsfiddle.net/pehrlich/dNLLa/](http://jsfiddle.net/pehrlich/dNLLa/)

子 div 的高度是其父级的 50%。这证实了父级百分比工作正常。（按[百分比高度 HTML 5/CSS](https://stackoverflow.com/questions/1622027/percentage-height-html-5-css)）

同一个 div 有一个边距顶部。如果将其更改为 -50%；在小提琴中，您会看到它完全移出视线。边距的百分比是相对于其他东西读取的——也许是 . 不应该！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T23:50:27.140

“百分比是根据生成框的包含块的宽度计算的。请注意，'margin-top' 和 'margin-bottom' 也是如此。如果包含块的宽度取决于此元素，则结果CSS 2.1 中未定义布局。”

[http://www.w3.org/TR/CSS21/box.html#margin-properties](http://www.w3.org/TR/CSS21/box.html#margin-properties)

[div margin-bottom 占自己高度的一个比例？](https://stackoverflow.com/questions/4909724/div-margin-bottom-of-a-percent-of-the-height-of-itself#4909777)

JS 是。

# iphone - iPhone：.ipa PNG 文件

> ID：10365296
> 
> 赞同：7
> 
> 时间：2012-04-28T16:14:53.643
> 
> 标签：iphone, png, ipa

如何从 iPhone 应用程序 (.ipa) 打开 PNG 文件？

一个例子：我在iTunes App Store下载一个App，点击“Show in finder”找到XXX.ipa文件，我把它重命名为XXX.zip，解压文件，打开目录，但是我打不开PNG文件。我怎样才能打开它们？

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-28T16:17:01.500

我会推荐[http://www.pragmaticcode.com/crunch/](http://www.pragmaticcode.com/crunch/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T16:21:05.240

PNG 在放入 .ipa 文件时会被压碎。你需要解开它们。

这里有两个工具可以做到这一点：

QuickLook 插件 PngUncrush.qlgenerator 位于：[http ://castelliweb.com/blog/2010/05/24/quicklook-plugins-for-mac/](http://castelliweb.com/blog/2010/05/24/quicklook-plugins-for-mac/)

或在以下位置找到的命令行工具 iPhonePNG：http: [//www.newsfirex.com/blog/? p=176](http://www.newsfirex.com/blog/?p=176)

# android - 我如何接收第三方意图，然后采取行动？

> ID：10365305
> 
> 赞同：0
> 
> 时间：2012-04-28T16:15:59.653
> 
> 标签：android, android-intent, broadcastreceiver

我的应用程序依赖于`ACTION_USER_PRESENT`被触发的意图，因此我在清单中设置了一个接收器，并且我有一个在接收到意图时启动服务的类。

但是，当用户使用像 WidgetLocker 这样的锁屏替换应用程序时，`ACTION_USER_PRESENT`intent 可能永远不会发送，或者可能会发送很多次。（一旦发送了 5 次......） WidgetLocker 的网站解释说，该应用程序*确实*发送了自己的解锁意图，`com.teslacoilsw.widgetlocker.intent.UNLOCKED`. 在 WidgetLocker 的某些配置中，`ACTION_USER_PRESENT`可能会在用户解锁屏幕之前被触发，所以我被告知最好设置一个检查`com.teslacoilsw.widgetlocker.intent.LOCKED`，然后等待接收`UNLOCKED`意图并完成我的工作。

我的问题是我不确定如何为第三方意图设置接收器。我已经在清单中将动作添加到我的接收器中，我知道我的广播接收器会接收它们，但我需要将它们过滤掉。主要是，如果我拿起`LOCKED`意图，我想忽略任何`ACTION_USER_PRESENT`意图，而是等待`UNLOCKED`意图，但我不知道如何在收到不同的意图时等待。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:31:09.470

> 主要是，如果我选择 LOCKED 意图，我想忽略任何 ACTION_USER_PRESENT 意图，而是等待 UNLOCKED 意图，但我不知道如何在收到不同意图时等待一个意图。

第 1 步：`BroadcastReceivers`为 WidgetLocker 操作与`ACTION_USER_PRESENT`.

步骤#2：收到后`LOCKED`，使用`PackageManager`和`setComponentEnabledSetting()`禁用您的`ACTION_USER_PRESENT`接收器。

步骤#3：收到后`UNLOCKED`，使用`PackageManager`并`setComponentEnabledSetting()`重新启用您的`ACTION_USER_PRESENT`接收器。

这在极端情况下可能会有点冒险（例如，用户在 时弹出电池`LOCKED`），但这是一个起点。

# ruby-on-rails - ruby on rails - 将 id 转换为名称

> ID：10365312
> 
> 赞同：0
> 
> 时间：2012-04-28T16:17:22.967
> 
> 标签：ruby-on-rails, ruby

我有两个对象成分和来源。
每种成分都有一个来源，所以在我有 origin_id
的成分中，视图显示

```
<p>
  <b>Name:</b>
  <%= @ingredient.name %>
</p>

<p>
  <b>Origin:</b>
  <%= @ingredient.origin_id %>
</p> 
```

我想显示来源名称而不是 ID。
如何将名称带到显示器上？

编辑：类成分声明如下

```
class Ingredient < ActiveRecord::Base
  has_and_belongs_to_many :recipes
  belongs_to :origin

  attr_accessible :name, :origin_id
end 
```

阶级起源

```
class Origin < ActiveRecord::Base
  attr_accessible :name
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T16:25:11.237

你必须在`Ingredient`课堂上声明：

```
belongs_to :origin 
```

之后，您可以使用

```
<%= @ingredient.origin.name %> 
```

请参阅[铁路关系指南](http://guides.rubyonrails.org/association_basics.html)（`belongs_to`以及`has_one`您的情况下的关联）

# xcode - 如何重新打开 xCode 存档

> ID：10365314
> 
> 赞同：2
> 
> 时间：2012-04-28T16:17:39.487
> 
> 标签：xcode

XCode 搞砸了我当前的项目，但我确实将该项目的存档保存为 XArchive 文件。有没有办法将这个文件作为 Xcode 项目重新打开？

# c# - “用”有什么好处

> ID：10365324
> 
> 赞同：5
> 
> 时间：2012-04-28T16:19:32.330
> 
> 标签：c#, using

我想了解两者之间的区别

```
public DataTable ExectNonActQuery(string spname, SqlCommand command)
{
    using (DataTable dt = new DataTable())
    {
        cmd = command;
        cmd.Connection = GetConnection();
        cmd.CommandText = spname;
        cmd.CommandType = CommandType.StoredProcedure;
        da.SelectCommand = cmd;
        da.Fill(dt);
        return (dt);
    }
} 
```

和

```
public DataTable ExectNonActQuery(string spname, SqlCommand command)
{
    DataTable dt = new DataTable();
    cmd = command;
    cmd.Connection = GetConnection();
    cmd.CommandText = spname;
    cmd.CommandType = CommandType.StoredProcedure;
    da.SelectCommand = cmd;
    da.Fill(dt);
    return (dt);
    }
} 
```

我实际上想了解使用“使用”创建新对象而不是像这样直接创建它有什么好处

```
DataTable dt = new DataTable(); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-28T16:22:59.873

您的第一个示例不正确：`using(var ...)`确保在退出时`IDisposable.Dispose`在内部声明的变量上调用。`using`因此，您的第一个示例返回一个已*处置*的对象，这几乎肯定是错误的。

一般来说，这个`using`块大致相当于这个：

```
var x = new MyDisposable();
try {
    // Do something with x
} finally {
    x.Dispose();
} 
```

由于这是 C# 中非常常见的模式，因此提供了一种特殊语法以方便您使用。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-28T16:20:44.773

`using`保证对象在 using 语句的末尾被释放

您可以改为手动调用 .Dispose() ，但是使用 .Dispose()`using`即使您抛出异常，它也会被释放

并且您可以避免自己的错误，例如忘记调用 .Dispose，或者在调用 Dispose 之前重新分配变量。

这一切都在文档中：

[http://msdn.microsoft.com/en-us/library/yh598w02.aspx](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)

编辑：另外，正如 dasblinkenlight 在另一个答案中解释的那样，在从函数返回对象时处理它是一个坏主意

但是，在 DataTable、DataSet 和 DataView 的特殊情况下，您实际上并不需要处理这些对象，因此在这个特定示例中，可以安全地忽略 DataTable 是 IDisposable。此外，由于 DataTable 的 .Dispose() 方法明确地什么都不做（最终化被抑制），尽管返回了已处置的对象，您的第一个示例实际上应该可以工作。

请参阅[我应该 Dispose() 数据集和数据表吗？](https://stackoverflow.com/q/913228/145999)

因此，在您的特定示例中，实际差异可能为零。

在可行的情况下，使用 Using 语句包装 IDisposables 通常仍然是一种很好的做法。（如果一个对象必须在函数内部构造，然后在该函数外部访问，这是不可能的。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-28T16:25:05.413

```
using (DataTable dt = new DataTable()) 
```

等于

```
DataTable dt = new DataTable();
try
{
}
finally 
{
    if(dt != null)
        dt.Dispose()
} 
```

因此，在这种情况下，如果抛出任何异常，您的数据表对象将被释放。在您的情况下，如果为 DataTable 类定义了终结器，则只有在垃圾收集器将收集它时才会处理它

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T16:24:07.143

来自msdn，

> 定义一个范围，一个或多个对象将被释放到该范围之外。

您无需担心处置您使用的对象的内存/资源。using 语句将解决这个问题。`using`一旦控件退出语句外部块（范围），在 using 块内定义的变量将自动释放。

典型示例是 SQL 连接。通常，您必须在事务后通过调用 Close 方法显式关闭连接。但是通过使用 statmenet，您不必担心。它会得到照顾。

CLR 通常会在 CLR 决定执行垃圾回收时释放内存。通过使用该`using`语句，我们手动释放自己使用的内存/资源。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-28T16:27:25.787

`using`使用语句时，您不会以不同的方式创建对象。

using 语句只是包装了一个继承 IDisposable 的对象。当您键入

`using (DataTable dt = new DataTable()) { }`

from 的返回值`DataTable dt = new DataTable()`是对 dt 的引用，它进入 using 语句。

所以这也可以写成

```
DataTable dt = new DataTable();
using (dt) { } 
```

正如其他答案所述，使用语句的原因是变量持有的资源可以在垃圾收集器通常释放它们之前被释放。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-28T18:34:45.017

在 using 中声明一个类型需要一个类型来实现 IDisposable，这样一旦对象的定义范围结束，对象就会在 Type 中定义的释放方法的帮助下被清理。

这确实很有趣，因为编译器本身将 using 转换为 try..Finally 语句，就像它将常量转换为它们的值一样。所以 using & try..finally 的行为在运行时是相同的:)。

Use the following link to understand more in depth: [http://www.codeproject.com/Articles/6564/Understanding-the-using-statement-in-C](http://www.codeproject.com/Articles/6564/Understanding-the-using-statement-in-C)

I hope it helps.

# delphi - 为什么 Delphi-XE2 64 位 windows 程序不能在集成环境中运行？

> ID：10365326
> 
> 赞同：3
> 
> 时间：2012-04-28T16:19:40.277
> 
> 标签：delphi, debugging, 64-bit, delphi-xe2

尝试在 Delphi XE2 中调试一个小而简单的 64 位 Windows 应用程序会给出以下运行时错误消息：无法创建进程，...

尝试使用构建配置调试和发布运行程序时会发生此错误。在项目管理器中使用“运行而不调试”启动时不会发生这种情况。

这种情况只有在尝试从 Delphi 的集成环境中运行程序时才会发生。

这是在 64 位桌面上，带有 Windows 7 Professional 和 Delphi XE2 Update 4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:09:50.313

我经历过的正是这一点。就我而言，问题是我的防病毒软件（当时的 Sophos）。我必须完全卸载 AV 程序才能解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:54:09.643

当我通过 wi-fi 适配器共享 Internet 连接时，我遇到了这个问题。解决方案是关闭共享

# c - 如何手动设置等于 NaN 的浮点数的位值？

> ID：10365328
> 
> 赞同：4
> 
> 时间：2012-04-28T16:19:44.797
> 
> 标签：c, floating-point, nan

我正在尝试通过将浮点数转换和转换为其他类型来运行一些测试，并且我想将我的浮点变量设置为不同的 nan 值。

“IEEE 浮点标准单精度（32 位）NaN 的逐位示例将是：s111 1111 1axx xxxx xxxx xxxx xxxx xxxx 其中 s 是符号（在应用程序中最常被忽略），a 确定类型NaN，并且 x 是一个额外的有效载荷（在应用程序中通常被忽略）。如果 a = 1，它是一个安静的 NaN；如果 a 为零且有效载荷非零，那么它是一个信令 NaN"

基本上我想找到一种方法来设置表示的有效负载或xxxx。有没有办法在c中做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T16:27:12.257

您可以通过将适当的字符串传递给 C99 [`nan`, `nanf`,`nanl`](http://linux.die.net/man/3/nan)函数来控制“有效负载”位，但这些只会生成*安静*的 NaN，并且未指定字符串的解释（大多数实现将其视为十六进制数）。

或者，使用联合：

```
#ifndef __STDC_IEC_559__
#error "This program requires IEEE floating point arithmetic"
#endif

#include <stdint.h>
#include <assert.h>

static_assert(sizeof(float) == sizeof(uint32_t),
    "This program requires float to be 32 bits exactly");

float nanf_with_payload_bits(uint32_t payload)
{
   if (payload & 0x7FA00000) abort();

   union ieee_single {
       float f;
       uint32_t i;
   } nan;

   nan.i = 0x7FA00000 | payload;
   return nan.f;
} 
```

当两种类型的大小完全相同时，写入联合的一个成员然后从另一个成员读取，不会在 C99+勘误表中引发未定义的行为。（这在 C89 中*是*未定义的行为，但大多数编译器将其定义为执行您期望的操作。在 C++ 中它可能仍然是未定义的行为，我不确定；但是，同样，大多数编译器将其定义为执行您期望的操作。 )

如果您使用此函数创建*信令*NaN，请注意它们的行为在 C99/C11 附录 F 中明确未定义。

不要试图将`i`联合的组件分解为具有位域的结构。结构中位域的内存布局部分是实现定义的，部分是未指定的，特别是位域序列*不一定*按照与 CPU 字节序相同的顺序打包到一个字中（或者，实际上，正确打包完全）。

* * *

标准引用（所有 C99）：

*   这种联合的使用只是*未指定*的行为：6.2.6.1p7；J.1
*   结构中位域的布局是不可预测的：6.2.6.1p1,2；6.7.2.1p10、11、13；J.3.9
*   信号 NaN 的行为未定义：F.2.1

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T16:53:13.077

使用`memcpy`：

```
int32_t i = 0x7FC00000;
float f;
memcpy(&f, &i, sizeof(f)); 
```

您也可以断言`sizeof(f) == sizeof(i)`，但如果您知道浮点数是 IEEE，那么大概您也知道基本类型的大小。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-01T16:06:50.340

有一种支持的方法可以在 C 中编写安静 NaN 的有效负载。

nan、nanf 和 nanl 函数（位于 math.h 头文件中，1999 C 规范的第 7.12.11.2 节）接受字符串作为参数。strtof、strtod 和 strtold 函数（stdlib.h 头文件，第 7.20.1.3 节）接受“NAN（字符序列）”形式的字符串。fscanf 和 sscanf 函数遵循 strtod。但是，字符序列以实现定义的方式进行解释。（这意味着您的编译器应该为您提供指定解释的文档。一些编译器将不遵守标准的这一要求。）

fprintf 函数（stdio.h，第 7.19.6.1 节）可以输出具有浮点格式（a、e、f、g）的“NAN（字符序列）”形式的字符串，printf 和 sprintf 也是如此。该标准允许输出没有字符序列的“NAN”，因此这不适用于许多编译器。

因为解释是实现定义的，所以你不应该期望它们是可移植的。它们通常用于特殊目的，例如调试。

# python - 使用 Tkinter 实现滚动条时画布大小的问题

> ID：10365332
> 
> 赞同：3
> 
> 时间：2012-04-28T16:20:13.063
> 
> 标签：python, canvas, scrollbar, tkinter, sizing

我一直无法保持画布/窗口仅扩展到我放入小部件中的信息的大小。我想添加滚动条并限制画布的大小。这是用于较大程序中的弹出窗口。这是我的代码

```
from Tkinter import *
import os
import tkMessageBox

class ClusterDialog(Toplevel):
    def __init__(self, parent, displayClass, clusterInfo, title = None):        
        Toplevel.__init__(self, parent)
        self.transient(parent)
        #top = self.top = Toplevel(parent)
        if title:
            self.title(title)
        #set parent
        self.parent = parent
        #set class
        self.dClass = displayClass
        #dictionary to store the header data in 
        self.clusterInfo    = clusterInfo        

        #stores checkbox variables
        self.varList = None
        self.boxList = None
        self.name = None

        self.frameTopLevel  = Frame(self,bd=2, width = 200,height=300)
        self.frameTopLevel.pack()

        self.buttonbox(self.frameTopLevel)
        self.frame = Frame(self.frameTopLevel, width = 200,height=300)

        #frame=Frame(root,width=300,height=300)
        self.frame.grid(row=0,column=0)
        self.frame.pack()

        self.canvas=Canvas(self.frame,bg='#FFFFFF',width=300,height=300,scrollregion=(0,0,500,1000))

        hbar = Scrollbar(self.frame,orient=HORIZONTAL)
        hbar.pack(side=BOTTOM,fill=X)
        hbar.config(command=self.canvas.xview)
        vbar=Scrollbar(self.frame,orient=VERTICAL)
        vbar.pack(side=RIGHT,fill=Y)
        vbar.config(command=self.canvas.yview)
        self.canvas.config(width=300,height=300)
        self.canvas.config(xscrollcommand=hbar.set, yscrollcommand=vbar.set)
        self.canvas.pack(side=LEFT,expand=True,fill=BOTH)
        self.frame.config(height = 100)
        self.body(self.canvas)
        self.canvas.config(width=300,height=300)
        self.grab_set() 
```

基本上我正在尝试创建一个顶层框架，其中包含一个包含滚动条和画布的框架。self.buttonbox(self.frameTopLevel) 添加了一些按钮，self.body(self.canvas) 添加了一堆复选框供用户操作。

当我运行此代码时，我的窗口总是扩展到屏幕的大小并且我无法滚动，尽管存在滚动条但它们没有做任何事情。任何帮助，将不胜感激？我一直在寻找有类似问题的其他线程，但找不到可行的修复程序。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T16:47:21.160

我刚刚让你的代码工作，但是我已经注释了几件事，所以它没有用按钮填充画布。但是窗口并没有占据整个屏幕......

**窗口大小：**也许尝试设置顶层的几何形状？

```
self.geometry("300x300+10+10") # numbers corresponding to [width]x[height]+[x offset]+[y offset] 
```

**画布：问题在于***在*画布中放置小部件。你可能想看看这个例子：[effbot](http://effbot.org/zone/tkinter-autoscrollbar.htm)

# twitter - 从 Twitter 获取所有屏幕名称而不达到速率限制

> ID：10365333
> 
> 赞同：2
> 
> 时间：2012-04-28T16:20:13.920
> 
> 标签：twitter

[我已经使用 Twitter API 资源“ GET Friends/ids](https://dev.twitter.com/docs/api/1/get/friends/ids) ”成功获得了一堆 Twitter user_ids 。

我需要能够在不达到速率限制的情况下从 Twitter 获取所有屏幕名称。我知道我可以使用“ [GET Friendships/show](https://dev.twitter.com/docs/api/1/get/friendships/show) ”来获取“screen_name”，但要做到这一点，我必须遍历所有的 user_id，每个都是一个请求，因此可能会达到速率限制。

有谁知道在一个请求中发送一组 user_ids 的方法？或者......任何其他想法或方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T16:27:13.620

您可以使用[用户/查找](https://dev.twitter.com/docs/api/1/get/users/lookup)API 吗？我相信你可以在一个请求中发送最多 100 个用户 ID 的列表，它会发回关于每个用户 ID 的相当多的信息，包括他们的最后一条推文。正如它在文档中所说

> 它也非常适合与朋友/ID 和追随者/ID 一起使用。

我认为这将解决您的问题。

# d - 为什么我不能在类方法中链接关联数组？

> ID：10365334
> 
> 赞同：1
> 
> 时间：2012-04-28T16:20:16.113
> 
> 标签：d

我似乎无法举一个小例子，但也许以前有人遇到过。

我有一个`Path`带有方法的类，`void find()`当我尝试`int[string]`在方法内实例化类型的关联数组时，出现如下所示的链接器错误：

```
/tmp/ccTF0A0c.o: In function `_D6object28__T16AssociativeArrayTAyaTiZ16AssociativeArray6rehashMFNdZHAyai':
game.d:(.text._D6object28__T16AssociativeArrayTAyaTiZ16AssociativeArray6rehashMFNdZHAyai[_D6object28__T16AssociativeArrayTAyaTiZ16AssociativeArray6rehashMFNdZHAyai]+0x44): undefined reference to `_D14TypeInfo_HAyai6__initZ'
collect2: ld returned 1 exit status 
```

如果我将关联数组粘贴到班级成员中，一切看起来都很好。

代码看起来像这样：

```
class Path
{
    int[string] bar; // Here it works.
    void find()
    {
        int[string] foo; // Here it fails.
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-22T06:41:32.167

我自己也遇到了一个非常相似的问题，即存储对象值和字符串键的关联数组的类。即使上面问题中的这个例子*确实*编译了 (Line:3 int[string] bar; // Here it works.) 对我来说它没有，我的编译会失败并显示以下消息：

```
/tmp/cc8XXyP6.o: In function `_D6object64__T16AssociativeArrayTAyaTC2px5pizza8graphics8textures8MaterialZ16AssociativeArray6rehashMFNdZHAyaC2px5pizza8graphics8textures8Material':
/usr/include/d2/4.6/object.di:366: undefined reference to `_D50TypeInfo_HAyaC2px5pizza8graphics8textures8Material6__initZ'
collect2: ld returned 1 exit status 
```

原来我自己解决了这个问题，只是通过使用包含单个键/值对的 AA 文字 [key:value] 初始化类的构造函数中的数组，它工作正常。

示例：（不编译）

```
class Cache {
    Material[string] dict;        
    ...
    Material load(string filename) {
        ... (File I/O and such)
        dict[filename] = loadedMaterial; //Compiler Error?
    }
} 
```

示例：（执行编译）

```
class Cache {
    Material[string] dict;        
    ...
    this() {
        dict = ["notexture" : new Material()]; //Somehow makes all the difference
    }
    ...
    Material load(string filename) {
        ... (File I/O and such)
        dict[filename] = loadedMaterial; //Works fine
    }
} 
```

我认为不是完全相同的问题，但对于遇到相同错误消息的人可能仍然有用，这是我在谷歌搜索一个小时后发现的第一个有意义的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-01T20:07:51.953

你在做增量编译吗？D 编译器不支持这一点。[观点：D语言永远不会因为这个问题而成为主流]

# javascript - decodeAudioData 返回一个空错误

> ID：10365335
> 
> 赞同：18
> 
> 时间：2012-04-28T16:20:21.250
> 
> 标签：javascript, html, google-chrome, webkit, web-audio-api

我来到这里希望你们可爱的人在这里可以帮助我解决我遇到的一些问题。

具体来说，每次我尝试使用 webkitAudioContext 的 decodeAudioData 方法时，它总是会触发带有 null 错误的错误处理程序。这是我目前正在使用的代码：

```
var soundArray;
var context = new webkitAudioContext();
function loadSound(soundName) {
    var request = new XMLHttpRequest();
    request.open('GET',soundName);
    request.responseType = 'arraybuffer';
    request.onload = function() {
            context.decodeAudioData(this.response, function(buf) {
                sounds[soundName] = buf;
            },function(err) { console.log("err(decodeAudioData): "+err); });
    }
    request.send();
} 
```

在这一点上，它不断地向控制台记录错误消息说`err(decodeAudioData) = null`，主要是因为这正是我决定记录它的方式。无论如何，知道为什么会这样吗？

我正在使用 Chrome Canary v20.0.1121.0 来尝试让某些东西正常工作。但是，显然，它不起作用！那么，知道我能做什么吗？如果需要任何新信息，请告诉我，我会根据需要进行更新。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-11T11:19:36.987

真正的原因是 createBuffer 和 decodeAudioData 现在都有一个错误，并为它们通常应该播放的文件抛出奇怪的模糊 DOM 异常 12。但我们应该意识到，这是一种新的、不断发展的技术，即使是网络音频 api，也应该感谢它，因为它发生在我们身上的小奇迹。

他们缺少任何合理的流音频格式解码器都应该开始的标头边界上的流同步。mp3 或许多 aac/adts 文件是流文件格式。流媒体意味着您可以在任何地方剪切它们或插入附加任何东西（各种标签甚至图像艺术品）解码器不应该关心未知数据。解码器应该一直寻找，直到找到他知道并且可以解码的标头。

我将这个临时解决方案放在一起，它寻求最近的帧头开始并仅从这个偏移量传递数据。

mp3 或 mp2 都是每个音频帧（每 200 字节左右）的开头标头，oxFFF 同步字上的 0XFFE 和 aac(adts) 正是出于这个原因。因此两者都将在 0xFFE 上同步。这是我目前用来播放以前未播放过的文件的代码。

我讨厌的是 arrayBuffer 没有 subarray() 像它的类型化的孩子一样从不同的偏移量返回不同的视图，而不是 slice() 返回的全新数组副本。如果只有 webaudio api 接受 typedarrays 作为输入，但不幸的是，创建 arraybuffer 的唯一方法似乎是巨大的 slice() 副本。谢天谢地，通常只需要一两次搜索。

## 强制 Web Audio Api 对文件不挑剔

```
node={};
node.url='usual_mp3_with_tags_or_album_artwork.mp3';

function syncStream(node){ // should be done by api itself. and hopefully will.
    var buf8 = new Uint8Array(node.buf); 
    buf8.indexOf = Array.prototype.indexOf;
    var i=node.sync, b=buf8;
    while(1) {
        node.retry++;
        i=b.indexOf(0xFF,i); if(i==-1 || (b[i+1] & 0xE0 == 0xE0 )) break;
        i++;
    }
    if(i!=-1) {
        var tmp=node.buf.slice(i); //carefull there it returns copy
        delete(node.buf); node.buf=null;
        node.buf=tmp;
        node.sync=i;
        return true;
    }
    return false;
}

function decode(node) {
    try{
        context.decodeAudioData(node.buf,
        function(decoded){
            node.source  = context.createBufferSource();
            node.source.connect(context.destination);
            node.source.buffer=decoded; 
            node.source.noteOn(0);
        },
        function(){ // only on error attempt to sync on frame boundary
            if(syncStream(node)) decode(node);
        });
    } catch(e) {
        log('decode exception',e.message);
    }
}

function playSound(node) { 
    node.xhr = new XMLHttpRequest();
    node.xhr.onload=function(){  
        node.buf=node.xhr.response;
        node.sync=0;
        node.retry=0;
        decode(node);
    }
    node.xhr.open("GET", node.url, true); 
    node.xhr.responseType = "arraybuffer"; 
    node.xhr.send();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-27T15:51:39.483

我使用`webkitAudioContext`的是 Chrome 19。今天我升级到了 Chrome 20，我遇到了和你一样的问题。

我已经获取了另一个 MP3 文件，它又可以工作了。两个文件之间的唯一区别是嵌入了错误 MP3 文件的封面。

我取下了盖子，它又可以工作了。

# prolog - Prolog中的命令行参数向量？

> ID：10365340
> 
> 赞同：2
> 
> 时间：2012-04-28T16:20:37.713
> 
> 标签：prolog

它们存在吗？我编写了一个解决数独难题的程序，运行需要 3 个步骤。

```
> prolog
> consult(sudoku).
> solve(puzzle). 
```

我正在寻找一种方法来做类似的事情

```
> prolog puzzle 
```

并完成它。有没有办法在 Prolog 中做到这一点？或者我是否必须用 C 或其他语言编写一些帮助程序才能使用

```
> ./solve puzzle 
```

任何帮助，将不胜感激。Prolog 还是新手，很难找到好的文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:27:26.470

这取决于您使用的 Prolog 系统。大多数 Prolog 系统都有一个命令行启动，可以在其中提供要查阅的初始 Prolog 文本和要运行的初始 Prolog 目标。

以下是一些示例，我结合了咨询并达成了一个联合目标：

[SWI-序言](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%272.4%27,swi%28%27/doc/Manual/cmdline.html%27%29%29)：

```
> swipl -t ['sudoku.p'],puzzle 
```

[GNU 序言](http://www.gprolog.org/manual/gprolog.html#htoc7)：

```
> gprolog --entry-goal ['sudoku.p'],puzzle,halt 
```

[Jekejeke序言](http://www.jekejeke.ch/idatab/doclet/prod/en/docs/05_run/10_docu/03_interface/08_headless/01_library.html)：

```
> java -jar interpreter.jar -t ['sudoku.p'],puzzle 
```

此致

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T19:15:32.813

使用该`-g`标志，您可以使 Prolog 在进入顶层之前执行您选择的目标。默认是打印欢迎消息的谓词。此外，您可能希望使用`-t`默​​认目标 prolog/0 替换为您选择的一个作为交互式顶层的标志。

另请参阅[手册](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%272.4%27,swi%28%27/doc/Manual/cmdline.html%27%29%29)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-05T00:54:24.637

使用[optparse](https://www.swi-prolog.org/pldoc/man?section=optparse)

例如，如果您的程序是：

```
main :-
    opt_arguments([], _, Args),
    write(Args). 
```

你运行它就像`./program 1 foo` 程序会写 [1,foo]

# git - capistrano 挂在 git clone

> ID：10365347
> 
> 赞同：0
> 
> 时间：2012-04-28T16:21:12.983
> 
> 标签：git, ssh, capistrano

使用此配置`cap deploy`总是挂起：

```
set :application, "myapp"
set :scm, :git
set :repository,  "https://myuser@bitbucket.org/myuser/myapp.git"
set :branch, "mybranch"
role :web, "myvserver.stratoserver.net"
role :app, "myvserver.stratoserver.net"
set :deploy_to, "/var/www-test"
set :user, "philip"
set :group, "www-data" 
```

需要输入密码3次：

1.  对于比特桶
2.  对于 myvserver.stratoserver.net。而且这似乎总是会产生错误，让我第三次输入它......
3.  我进入它，一切都挂起

在服务器端`ps ax`给出：

```
 3116 ?        Ss     0:00 sh -c git clone -q https://myuser@bitbucket.org/myuser/myapp.git /var/www-test/releases/201204281610
 3117 ?        S      0:00 git clone -q https://myuser@bitbucket.org/myuser/myapp.git /var/www-test/releases/20120428161055
 3118 ?        S      0:00 git-remote-https https://myuser@bitbucket.org/myuser/myapp.git https://myuser@bitbucket.org/myus 
```

完整的 capistrano 输出在这里： http: [//pastebin.com/Ffqpqq7y](http://pastebin.com/Ffqpqq7y)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T15:56:41.537

我遇到了同样的问题，我的问题与 ssh-keys 有关。我已经重新生成了 ssh-keys 并让它工作。希望它有帮助..

# ruby - NoHandlerError Paperclip on ruby on rails 3.2.1

> ID：10365348
> 
> 赞同：1
> 
> 时间：2012-04-28T16:21:14.163
> 
> 标签：ruby, ruby-on-rails-3, paperclip

我正在尝试使用回形针上传多张图片。我正在关注本教程：[http ://www.emersonlackey.com/article/paperclip-with-rails-3](http://www.emersonlackey.com/article/paperclip-with-rails-3)

不幸的是我有错误：

```
No handler found for "apple_mac-1280x800.jpg" 
```

**资产.rb**

```
class Asset < ActiveRecord::Base
  belongs_to :post
  has_attached_file :asset, :styles => { :small => "100x100", :original => '800x600>'}
end 
```

**Post.rb**

```
class Post < ActiveRecord::Base
  has_many :assets
  accepts_nested_attributes_for :assets, :allow_destroy => true
end 
```

Posts_controller.rb

```
def new
    @post = Post.new
    5.times { @post.assets.build }

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @post }
    end
end

def edit
  @post = Post.find(params[:id])
  5.times { @post.assets.build }
end 
```

**@Post 表单**

```
<% create_url = {:url=>{:action=>"create"}} if @post.new_record? %>
    <% form_for @post, :html => {:multipart => true}  do |t| %>
      <p>
        <%= t.label :title, 'Virsraksts:' %>
        <%= t.text_field :title %>
      </p>
      <p>
        <%= t.label :content, 'Teksts:' %>
        <%= t.text_area :content, :class => "mceEditor"%>
      </p>

      <%= t.fields_for :assets do |asset_fields| %>
         <% if asset_fields.object.new_record? %>
            <p>
                <%= asset_fields.file_field :asset %>
            </p>
         <% end %>
      <% end %>

      <%= t.submit %>
    <% end %>
<%end%> 
```

**问题**通过改变解决

```
<%= t.fields_for :assets do |asset_fields| %> 
```

至

```
<%= f.fields_for :assets do |asset_fields| %> 
```

但是有人可以解释为什么吗？

# android - 检测到返回键但活动未结束

> ID：10365349
> 
> 赞同：1
> 
> 时间：2012-04-28T16:21:13.993
> 
> 标签：android

这让我有点疯狂。

我有以下应用程序：

活动 A -> 活动 B -> 活动 C

A 在清单中定义为 android:launchMode="singleTask"

B 启动 C 如下：

```
 Intent startActivity = new Intent();
        startActivity.setClass(this,C.class);
        startActivity.setFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
        startActivity(startActivity); 
```

C 通过套接字与远程系统来回交谈。

当 C 正在通信时，Back 键被禁用。这是 C 的 onKeyDown()：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {

    if (sessionActive() && (keyCode == KeyEvent.KEYCODE_BACK)) {

        return false;
    }
    else if (!sessionActive() && (keyCode == KeyEvent.KEYCODE_BACK)){

            Log.d("C","done talking to socket, got Back key, exit Activity");
        /* delete data from an internal static object */
    }

    return super.onKeyDown(keyCode, event);
} 
```

如果我们仍在通过套接字对话并且我们希望禁用 Back 键，则 sessionActive() 返回 true。

当 sessionActive() 为假时，我们说完了，我们希望返回键退出活动 C。

问题是，它不起作用。我已经通过日志消息和第一次 sessionActivity() == false 跟踪了这一点，我确实收到了“与套接字对话完成”的消息，所以我知道我来对地方了。但是，我必须第二次按下 Back 才能让活动 C 消失。

有任何想法吗？

更新更新：

我已经尝试了这两个答案，并得到了同样令人困惑的结果。

这是我的一些 logcat，显示了不同生命周期方法的执行。我有许多问题穿插在 logcat 文本中。

```
C.onCreate() 
C.onStart() 
C.onResume() 
C.onKeyDown() sessionActive()==false, keyCode = BACK              
                          this should get us out but doesn't

C.finish() sessionActive is FALSE                                
                          shouldn't this go to onStop()?

C.onPause() sessionActive is FALSE
C.onRestart() sessionActive is FALSE                              <-  ???????? onRestart?
C.onStart() sessionActive is FALSE                                <-  ???????? onStart?
C.onResume() sessionActive is FALSE
C.onStop() sessionActive is FALSE                                 <- this makes sense
C.onDestroy() sessionActive is FALSE                           <- so does this
C.onPause() sessionActive is FALSE                             <- ????????
C.onResume() sessionActive is FALSE

C.onKeyDown() sessionActive is FALSE, keyCode = BACK
                        this is 2nd back press that does exit
C.finish() sessionActive is FALSE
C.onPause() sessionActive is FALSE                there is no onRestart here!!!!!!!!!
C.onStop() sessionActive is FALSE
C.onDestroy() sessionActive is FALSE 
```

我不明白控制流程。我会认为 finish() 将控制权发送给 onDestroy() ，我们就完成了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T16:48:12.360

你可以试试：

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)
{
    if ( keyCode == KeyEvent.KEYCODE_BACK )
    {
        if ( sessionActive() )
            return false;

        Log.d("C","done talking to socket, got Back key, exit Activity");
        /* delete data from an internal static object */
        finish();
        return true;
    }
    return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:59:43.040

你可以有

```
@Override
public void onBackPressed() {
    /* delete data from an internal static object */
    finish();
} 
```

在你的活动中

# c++ - 在 C++ 中实现一个基本的 MD5 算法

> ID：10365351
> 
> 赞同：2
> 
> 时间：2012-04-28T16:21:32.090
> 
> 标签：c++, md5, hash

我正在尝试在 C++ 中实现一个基本的 MD5 算法。我主要关注[维基页面的](http://en.wikipedia.org/wiki/MD5)算法，这看起来很简单。然而，我真的已经战斗了一段时间了。我没有得到空字符串所需的哈希值。我什至去看看 64 轮中的每一轮都发生了什么，但无济于事。这是我到目前为止所做的。代码没有优化或写得特别好，但我只是把它拼凑在一起，所以看看我是否走在正确的轨道上。

```
#include "md5.h"
#include <iostream>
#include <iomanip>
#include <windows.h>

using namespace std;

unsigned int rotateL(unsigned int x, int n)
{
    return ((x) << n) | ((x) >> (32 - n));

}

int main()
{
//The required hash value using existing md5 algorithm

MD5 md5 ;
cout << "empty str is:" << endl;
puts( md5.digestString( "" ) ) ;

//Initialize Vars
unsigned int a = 0x67452301;
unsigned int b = 0xefcdab89;
unsigned int c = 0x98badcfe;
unsigned int d = 0x10325476;

//Make a copy of above
unsigned int A = a;
unsigned int B = b;
unsigned int C = c;
unsigned int D = d;

//Assuming an empty string ""
//The message would be appended with 1 and then padded with 0's
//so m = 10000....until 512 bits
//is this true?
unsigned int m[16] = {0x80000000, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    , 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};

int r[64] =  {7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22, 7, 12, 17, 22
    ,5,  9, 14, 20, 5,  9, 14, 20, 5,  9, 14, 20, 5,  9, 14, 20
        ,4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23, 4, 11, 16, 23
        ,6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21, 6, 10, 15, 21};

unsigned int k[64] = { 0xd76aa478, 0xe8c7b756, 0x242070db, 0xc1bdceee
    ,0xf57c0faf, 0x4787c62a, 0xa8304613, 0xfd469501
        ,0x698098d8, 0x8b44f7af, 0xffff5bb1, 0x895cd7be
        ,0x6b901122, 0xfd987193, 0xa679438e, 0x49b40821
        ,0xf61e2562, 0xc040b340, 0x265e5a51, 0xe9b6c7aa
        ,0xd62f105d, 0x02441453, 0xd8a1e681, 0xe7d3fbc8
        ,0x21e1cde6, 0xc33707d6, 0xf4d50d87, 0x455a14ed
        ,0xa9e3e905, 0xfcefa3f8, 0x676f02d9, 0x8d2a4c8a
        ,0xfffa3942, 0x8771f681, 0x6d9d6122, 0xfde5380c
        ,0xa4beea44, 0x4bdecfa9, 0xf6bb4b60, 0xbebfbc70
        ,0x289b7ec6, 0xeaa127fa, 0xd4ef3085, 0x04881d05
        ,0xd9d4d039, 0xe6db99e5, 0x1fa27cf8, 0xc4ac5665
        ,0xf4292244, 0x432aff97, 0xab9423a7, 0xfc93a039
        ,0x655b59c3, 0x8f0ccc92, 0xffeff47d, 0x85845dd1
        ,0x6fa87e4f, 0xfe2ce6e0, 0xa3014314, 0x4e0811a1
        ,0xf7537e82, 0xbd3af235, 0x2ad7d2bb, 0xeb86d391 };

// Do an ititial Round just for testing...
unsigned int f = 0;
cout << "Doing round " << dec << 1 << endl;
f = (b & c) | ((~b) & d);   //round 1
cout << "f is " << hex << f << endl;
unsigned int temp = d;
d = c;
c = b;
int i = 0;
int g = 0;
cout << "k is " << hex << k[0] << endl;
cout << "r is " << dec << r[0] << endl;
b = b^(rotateL( a ^ f ^ k[0] ^ m[0] ,r[0]));
a = temp;

cout << "a is " << hex << a << endl;
cout << "b is " << hex << b << endl;
cout << "c is " << hex << c << endl;
cout << "d is " << hex << d << endl;

for (int i=1;i<16;i++){
    cout << "Doing round " << dec << i+1 << endl;
    f = (b & c) | ((~b) & d);   //round 1
    g = i;
    cout << "f is " << hex << f << endl;
    //res = d & b | ~d & c; //round 2

    unsigned int temp = d;
    d = c;
    c = b;
    cout << "k is " << hex << k[i] << endl;
    cout << "r is " << dec << r[i] << endl;
    b = b^(rotateL( a ^ f ^ k[i] ^ m[g] ,r[i]));
    a = temp;

    cout << "a is " << hex << a << endl;
    cout << "b is " << hex << b << endl;
    cout << "c is " << hex << c << endl;
    cout << "d is " << hex << d << endl;
    system("PAUSE");
}

for (int i=16;i<32;i++){
    cout << "Doing round " << dec << i+1 << endl;
    f = d & b | ~d & c; //round 2
    cout << "f is " << hex << f << endl;

    g = ((5*i)+1)%16;

    unsigned int temp = d;
    d = c;
    c = b;
    cout << "k is " << hex << k[i] << endl;
    cout << "r is " << dec << r[i] << endl;
    b = b^(rotateL( a ^ f ^ k[i] ^ m[g] ,r[i]));
    a = temp;

    cout << "a is " << hex << a << endl;
    cout << "b is " << hex << b << endl;
    cout << "c is " << hex << c << endl;
    cout << "d is " << hex << d << endl;
    system("PAUSE");
}

for (int i=32;i<48;i++){
    cout << "Doing round " << dec << i+1 << endl;
    f = b ^ c ^ d;
    cout << "f is " << hex << f << endl;

    g = ((3*i)+5)%16;

    unsigned int temp = d;
    d = c;
    c = b;
    cout << "k is " << hex << k[i] << endl;
    cout << "r is " << dec << r[i] << endl;
    b = b^(rotateL( a ^ f ^ k[i] ^ m[g] ,r[i]));
    a = temp;

    cout << "a is " << hex << a << endl;
    cout << "b is " << hex << b << endl;
    cout << "c is " << hex << c << endl;
    cout << "d is " << hex << d << endl;
    system("PAUSE");
}

for (int i=48;i<64;i++){
    cout << "Doing round " << dec << i+1 << endl;
    f = c ^ (b | ~ d);
    cout << "f is " << hex << f << endl;

    g = ((7*i))%16;

    unsigned int temp = d;
    d = c;
    c = b;
    cout << "k is " << hex << k[i] << endl;
    cout << "r is " << dec << r[i] << endl;
    b = b^(rotateL( a ^ f ^ k[i] ^ m[g] ,r[i]));
    a = temp;

    cout << "a is " << hex << a << endl;
    cout << "b is " << hex << b << endl;
    cout << "c is " << hex << c << endl;
    cout << "d is " << hex << d << endl;
    system("PAUSE");
}

A = A ^ a;
B = B ^ b;
C = C ^ c;
D = D ^ d;

cout << "Finally: " << endl;
cout << "A is " << hex << A << endl;
cout << "B is " << hex << B << endl;
cout << "D is " << hex << C << endl;
cout << "D is " << hex << D << endl;

//The above would now be appended but they 
//do not equal to the required hash! 
//So clearly it is wrong??

return 0; 
```

}

我有一种感觉，也许我在填充阶段做错了什么，但我无法弄清楚。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T16:55:54.697

这可能是您的问题之一：

```
for (int i=1;i<16;i++){ 
```

我认为“i”需要初始化为0，而不是1。因为维基百科代码显示它是这样的：

```
//Main loop:
    for i from 0 to 63
        if 0 ≤ i ≤ 15 then
            f := (b and c) or ((not b) and d)
            g := i 
```

此外，当您在每一轮更新“b”时，您可以按如下方式实现它：

```
b = b^(rotateL( a ^ f ^ k[i] ^ m[g] ,r[i])); 
```

但是维基百科页面上的参考代码是这样实现的：

```
b := b + leftrotate((a + f + k[i] + w[g]) , r[i]) 
```

请注意，参考代码只是将所有这些值相加，您使用的是 xor (^) 运算符。

我怀疑还有其他问题，因此您可能需要使用参考代码仔细检查您的实现。

# image - UINT16 单色图像到 8bit 单色 Qimage 使用 freeImage

> ID：10365353
> 
> 赞同：0
> 
> 时间：2012-04-28T16:22:28.397
> 
> 标签：image, image-processing, qt4, freeimage

我想用 C++ 将**UINT16 单色图像**转换为**8 位图像**。

我有那个图像

```
char *buffer; 
```

我想将新转换的缓冲区提供给 QImage (Qt)。

我正在尝试使用**freeImagePlus**

```
fipImage fimage;
if (fimage.loadfromMemory(...) == false)
    //error 
```

loadfromMemory 需要一个 fipMemoryIO 地址：

> loadfromMemory(fipMemoryIO &memIO, int flag = 0)

所以我愿意

```
fipImage fimage;
BYTE *buf = (BYTE*)malloc(gimage.GetBufferLength() * sizeof(BYTE));
// 'buf' is empty, I have to fill it with 'buffer' content
// how can I do it?
fipMemoryIO memIO(buf, gimage.GetBufferLength());

fimage.loadFromMemory(memIO);
if (fimage.convertTo8Bits() == true)
    cout << "Good"; 
```

然后我会做类似的事情

```
fimage.saveToMemory(... 
```

或者

```
fimage.saveToHandle(... 
```

我不明白什么是 FREE_IMAGE_FORMAT，它是这两个函数中任何一个的第一个参数。我在 freeImage 文档中找不到这些类型的信息。

然后我会结束

```
imageQt = new QImage(destiny, dimX, dimY, QImage::Format_Indexed8); 
```

如何用初始缓冲区的内容填充“buf”？

并从 fipImage 获取数据到 QImage 的 uchar* 数据？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T01:37:53.967

在普通的旧 C++ 中进行转换很简单，不需要外部库，除非它们明显更快*并且*您关心这样的加速。以下是我将如何进行转换，至少作为第一次切割。数据在输入缓冲区内转换，因为输出小于输入。

```
QImage from16Bit(void * buffer, int width, int height) {
   int size = width*height*2; // length of data in buffer, in bytes
   quint8 * output = reinterpret_cast<quint8*>(buffer);
   const quint16 * input = reinterpret_cast<const quint16*>(buffer);
   if (!size) return QImage;
   do {
      *output++ = *input++ >> 8;
   } while (size -= 2);
   return QImage(output, width, height, QImage::Format_Indexed8);
} 
```

# ruby-on-rails - 使用 mongomapper 在列表中获取不同的用户

> ID：10365356
> 
> 赞同：0
> 
> 时间：2012-04-28T16:22:36.660
> 
> 标签：ruby-on-rails, mongodb, mongomapper

我正在创建一个用户可以在某些地方签到的应用程序，因此一个地方可能包含许多签到，并且用户可以根据需要随时签到

有了一个地方和签到列表，我可以看到用户，但如果用户多次签到，则用户列表将包含重复的用户。

我如何获得在特定地点签到的用户的不同列表，我正在使用 mongomapper

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T21:45:47.777

如果签入是嵌入的，您将不得不使用 Ruby 的`uniq`.

如果您的签入是简单的 Mongo 文档，如下所示：

```
{
  _id:      ObjectId("123abc"),
  place_id: ObjectId("123abc"),
  user_id:  ObjectId("123abc")
} 
```

...那你就可以了`CheckIns.where(:place_id => my_place.id).distinct(:user_id)`。然后将它们映射到用户。

从您提供的有关架构的非常少的信息来看，听起来您的数据具有很强的相关性。使用关系数据库*可能*会更好。

# php - 将项目插入数据库

> ID：10365359
> 
> 赞同：1
> 
> 时间：2012-04-28T16:23:17.550
> 
> 标签：php, mysql, sql

当我尝试将我的 prdocutPrice 字符串或股票字符串转换为十进制和整数值时，我在将其插入我的数据库时遇到问题。我很确定我正在做其余的事情，有人可以为我确认吗？

```
<?php 

    if (isset($_POST['addSubmitted'])) {

        $errors = array();
        require_once ('mysql_connect.php');

            //This gets all the other information from the form 
            $name=$_POST['productName']; 
            $description=$_POST['productDescription']; 
            $price= floatval($_POST['productPrice']); 
            $stock= intval($_POST['productStock']);

        if (empty($errors)) {
            //Writes the information to the database 
            mysql_query("INSERT INTO products (name, description, price, stock) VALUES ($name, $description, $price, $stock)"); 
            $result = mysql_query($query);

            if (mysql_affected_rows() == 1) {
                // Show thank you message
                echo '<span style="color:green;">Your product has been added.</span>';
            } else {
                echo '<font color="red">We were unable to add your product to the database.</font>';
            }

        } else {
            echo '<font color="red"><h3>Error!</h3>
            The following error(s) occured:<br /></font>';

            foreach ($errors as $msg) {
                echo " - <font color=\"red\">$msg</font><br />\n";
            }
        }
    }

?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T16:25:24.733

`INSERT`语句中没有正确引用您的字符串值。用单引号将它们括起来。

此外，首先要确保调用`mysql_real_escape_string()`所有字符串输入值，因为它们目前容易受到 SQL 注入攻击。

```
$name = mysql_real_escape_string($_POST['productName']); 
$description= mysql_real_escape_string($_POST['productDescription']); 
$price= floatval($_POST['productPrice']); 
$stock= intval($_POST['productStock']); 
```

此外，您调用`mysql_query()`了两次，而不是将 SQL 字符串存储到您的变量`$query`中。

```
// Quote the string values,
// store the SQL as a variable then pass it to mysql_query()
$query = "INSERT INTO products (name, description, price, stock) VALUES ('$name', '$description', $price, $stock)"; 
$result = mysql_query($query); 
```

调用 to`echo mysql_error();`将有助于调试您的 SQL 语句的问题。

最后，我还要补充一点——除了调用`intval()`或`floatval()`传递的字符串之外`$_POST`，验证数字实际上是*数字*通常是一个好主意。否则，如果它们是非数值，它们将被强制转换为 0，并且当您可能根本不应该插入它时，您将在数据库中得到零（因为它是无效数据）。

```
if (is_numeric($_POST['productPrice'])) {
   $price = floatval($_POST['productPrice']);
}
else // non numeric value, don't do the insert with bad data 
```

对于正整数或零整数，我喜欢使用[`ctype_digit()`](http://us3.php.net/manual/en/function.ctype-digit.php)：

```
if (ctype_digit($_POST['productStock'])) {
  $stock = intval($_POST['productStock']);
}
else // bad input value, don't do insert 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T16:26:52.920

要回答您的问题，我相信您需要在值周围加上引号（尤其是字符串）：

```
mysql_query("INSERT INTO products (name, description, price, stock) VALUES ('$name', '$description', '$price', '$stock')"); 
```

但是您还需要使用 mysqli 或 PDO 来转义变量`mysql_real_escape_string`或切换到类似[mysqli](http://php.net/manual/en/book.mysqli.php)或[PDO](http://php.net/manual/en/book.pdo.php)的东西以使用参数化查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T16:27:15.330

1) 你容易受到 SQL 注入的攻击。在继续使用任何代码之前，请通读[http://bobby-tables.com](http://bobby-tables.com)
2) 您在查询中忽略了引号，从而导致语法错误。您也没有任何错误处理，并假设您的查询成功：

```
mysql_query("INSERT INTO products (name, description, price, stock) VALUES ('$name', '$description', etc....) 
                                                                            ^     ^ 
```

注意额外的引号。至于错误处理，您应该始终使用的绝对最低限度是

```
 $result = mysql_query(...) or die(mysql_error()); 
```

即使您的查询字符串绝对完全有效（而您的绝对不是），也有太多其他原因导致查询失败而不**检查**成功/失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T16:30:24.250

if (empty($errors)) { //将信息写入数据库 mysql_query("INSERT INTO products (name, description, price, stock) VALUES ($name, $description, $price, $stock)"); $result = mysql_query($query);

这不应该是：

if (empty($errors)) { //将信息写入数据库 **$query= "INSERT INTO products (name, description, price, stock) VALUES ($name, $description, $price, $stock";** $result = mysql_query($查询);

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T16:31:05.680

> mysql_query("INSERT INTO products (name, description, price, stock) VALUES ($name, $description, $price, $stock)");

您没有为 mysql_query 声明变量。此外，Michael 对转义字符串值有一些好处。尝试使用**$query**变量和值周围的单引号。

```
$query = mysql_query("INSERT INTO products (name, description, price, stock) VALUES ('$name', '$description', '$price', '$stock')"); 
```

# java - Java正则表达式替换由非字母数字字符包围的字符串

> ID：10365360
> 
> 赞同：1
> 
> 时间：2012-04-28T16:23:24.570
> 
> 标签：java, regex, string, replace

我需要一种方法来替换句子中的单词，例如“嗨，某事”。我需要将其替换为`"hello, something"`. `str.replaceAll("hi", "hello")`给我`"hello, somethellong"`。

我也尝试过`str.replaceAll(".*\\W.*" + "hi" + ".*\\W.*", "hello")`，我在这里看到了另一个解决方案，但是这似乎也不起作用。

实现这一目标的最佳方法是什么，所以我只替换没有被其他字母数字字符包围的单词？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T16:30:55.107

在这种情况下，单词边界应该可以很好地为您服务（IMO 是更好的解决方案）。更通用的方法是使用负前瞻和后瞻：

```
 String input = "ab, abc, cab";
 String output = input.replaceAll("(?<!\\w)ab(?!\\w)", "xx");
 System.out.println(output); //xx, abc, cab 
```

这将搜索出现在其他单词字符之前或之后的“ab”。您可以将“\w”换成*任何*正则表达式（好吧，由于正则表达式引擎不允许无界环顾，因此存在实际限制）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T16:28:28.470

用于`\\b`单词边界：

```
String regex = "\\bhi\\b"; 
```

例如，

```
 String text = "hi, something";
  String regex = "\\bhi\\b";
  String newString = text.replaceAll(regex, "hello");

  System.out.println(newString); 
```

如果你打算做任何数量的正则表达式，让这个[正则表达式教程](http://www.regular-expressions.info/tutorial.html)成为你最好的朋友。我不能太推荐它！

# maven - 构建 WSO2 Carbon 标签的合适方法是什么？

> ID：10365363
> 
> 赞同：1
> 
> 时间：2012-04-28T16:23:43.837
> 
> 标签：maven, build, wso2, soa, wso2carbon

我正在尝试并排构建 WSO2 Carbon 的多个标签以进行比较，但我担心我可能会遗漏有关目录布局以及如何进行构建的内容。请问我可以帮忙吗？

目前，我已经检查了我认为的相关标签来自：

*   https://svn.wso2.org/repos/wso2/tags/carbon/3.0.0/
*   https://svn.wso2.org/repos/wso2/tags/carbon/3.1.0_core/
*   https://svn.wso2.org/repos/wso2/tags/carbon/3.2.0/
*   https://svn.wso2.org/repos/wso2/tags/carbon/3.2.2/
*   https://svn.wso2.org/repos/wso2/tags/carbon/3.2.3/

然后，我尝试从每个结帐的顶级目录运行 Maven 构建（以各种方式，一些涉及跳过测试，而另一些不涉及），结果各不相同（几乎所有这些都以一种或另一种方式不成功，无论由于缺少工件、测试失败或其他原因）。我还尝试从 .../carbon/3.2.2/patch-releases/3.2.2 目录和 .../carbon/3.2.3/patch-releases/3.2.3 构建 3.2.2 和 3.2.3目录，根据@ThiliniIshaka 在这里给出的答案：

[身份服务器的 WSO2 源代码 (wso2is-3.2.3-src.zip) 总是构建错误](https://stackoverflow.com/questions/10164438/wso2-sourcecode-of-identity-server-wso2is-3-2-3-src-zip-is-always-built-with-e)

这似乎对 3.2.2 有效（经过一些摆弄），但是 3.2.3 的一些测试失败了，这会拉低构建（我可以使用 Maven 的 -fn 标志使其工作，但这只会导致看起来像一个不完整的构建）。此外，较早的标签似乎没有相应的补丁发布目录，因此即使我让它适用于 3.2.3，同样的技术也不适用于它们。

顺便说一句，我也对诸如包含补丁发布下的 3.2.3 目录的 3.2.2 标签等内容深感困惑。

所有这一切让我认为我可能以某种基本方式错过了这一点:)

因此，我的问题是：

1.  我是否首先检查了正确的事情？
2.  请问从哪个目录以及我应该如何构建每个标签？
3.  我是否需要为所有标签使用相同版本的 Maven？
4.  是否有各种不同版本的良好构建文档来解释其中的一些？我找到了各种技术博客，但似乎没有什么万无一失和全面的（我可能找错地方了）。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-02T12:23:13.133

回答上述问题；

1.  是的，这些标签是为碳的相关分支和点版本创建的。
2.  正如上一个帖子所建议的[[1]](https://stackoverflow.com/questions/10164438/wso2-sourcecode-of-identity-server-wso2is-3-2-3-src-zip-is-always-built-with-e)您可以构建源代码，您能否向我们提供您在构建源代码时遇到的问题？
3.  是的，您需要使用 maven2 构建上述标签。只有主干[[2]](https://svn.wso2.org/repos/wso2/carbon/)（正常开发的地方）需要 maven 3。
4.  [此博客文章](http://amilamanoj.blogspot.com/2011/03/building-wso2-carbon-from-source.html)中提供了一些提示。从根级别开始`mvn install`（要跳过正在运行的测试，请使用 构建`mvn install -Dmaven.test.skip=true`）。如果要构建与点发布相关的标签，请从`patch-releases`目录构建。

希望这可以帮助。

谢谢

# xilinx - 如何禁用 XST FF/Latch 修剪或隐藏有关它的警告

> ID：10365372
> 
> 赞同：0
> 
> 时间：2012-04-28T16:24:42.483
> 
> 标签：xilinx

谁能向我解释如何禁用 XST FF/Latch 微调？在这个特定的示例中，我知道为什么会发生修剪（我不想详细说明），但它们发生在非常大的 std_logic_vector（两个 128 位的向量）上。

也就是说，我收到了很多警告，看不出是否还有其他问题（我会关心）。所以我想隐藏警告或禁用 FF/Latch 修剪。那可能吗 ？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T10:22:28.123

在 ISE 中，您可以隐藏消息窗口 IIRC 中的特定警告。我认为右键单击该消息可能是一种方式。

就个人而言，我倾向于使用纯命令行流程 - 包括一个脚本，该脚本通过辅助文件中的一组正则表达式“编辑”我定义为“无趣”或“应该发生”的消息。当然，然后我必须验证正则表达式:)

# java - 如何使用 JCIP 编码（Java 并发实践）

> ID：10365378
> 
> 赞同：11
> 
> 时间：2012-04-28T16:25:28.617
> 
> 标签：java, concurrency

最近阅读了 JCIP 注释，它们看起来很酷。去官网看了下源码。唯一的问题是 src jar 只包含注释......我没有看到在哪里可以找到实际*执行*任何操作的注释处理器！我只是找错地方了，还是这些不是真正的 Java 注释（意思是，`@Immutable`当它被用来标记一个类时，没有办法强制执行）？

*   `@Immutable`
*   `@GuardedBy`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-28T16:41:54.270

[FindBugs](http://findbugs.sourceforge.net/)支持这些注释。[本文档页面](http://findbugs.sourceforge.net/manual/annotations.html)中描述了对这些注释和其他注释的支持。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-23T11:36:43.013

IntelliJ IDE 将使用这些注释来查找代码中的错误。如果您将变量注释为@GuardedBy(some_lock)，IDE 将标记您在没有正确同步的情况下访问它的情况。这非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T12:02:57.287

JCIP 注释是记录并发契约的正式方式，例如此成员是“@GuardedBy”这个字段。

他们不会在您的代码中执行任何功能性操作。

# ruby-on-rails - ActionView::Template::Error（db_name 必须是字符串或符号）：

> ID：10365379
> 
> 赞同：0
> 
> 时间：2012-04-28T16:25:30.120
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, mongoid, unicorn

好的，所以我在 ec2 上的 ubuntu 11.10 上有一个新的 rails 应用程序，它有 mongoid 作为数据库，我一直收到这个错误

```
ActionView::Template::Error (db_name must be a string or symbol): 
```

这是我的 config/mongoid.yml

```
development:
  host: localhost
  database: mm_development

test:
  host: localhost
  database: mm_test

# set these environment variables on your prod server
production:
  host: <%= ENV['MONGOID_HOST'] %>
  port: <%= ENV['MONGOID_PORT'] %>
  username: <%= ENV['MONGOID_USERNAME'] %>
  password: <%= ENV['MONGOID_PASSWORD'] %>
  database: <%= ENV['MONGOID_DATABASE'] %>
  # slaves:
  #   - host: slave1.local
  #     port: 27018
  #   - host: slave2.local
  #     port: 27019 
```

我的 database.yml 是空白的，因为我不知道如果有什么需要去那里。这是我的 mongoid 的 gemfile

```
gem 'rails', '3.2.3'
gem 'jquery-rails'
gem 'haml'
gem 'unicorn'
gem 'mongoid' 
```

首先我想知道是否有人知道我需要对 database.yml 做什么，然后我该如何解决这个问题....mongo 已启动并正在运行，但这个错误令人困惑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-01T16:44:42.573

如果要使用空白 config/database.yml 运行或删除它，则必须删除对 Active Record 的所有引用。以下对我有用，检查它的 config/application.rb 以及我必须做些什么才能让一个新的 Rails 项目通过您提供的 Gemfile 和 config/mongoid.yml 的初始测试。请注意，您还应该在 test/test_helper.rb 中注释掉“fixtures :all”。我建议您重新创建以下等效项作为开始的干净基础。希望这会有所帮助。

```
$ ruby -v
ruby 1.9.3p125 (2012-02-16 revision 34643) [x86_64-darwin11.3.0]
$ rails _3.2.3_ new free-11137-db_name
$ cd free-11137-db_name

Gemfile as per user

$ bundle install
$ gem install unicorn
$ bundle install
Using mongo (1.6.2)
Using mongoid (2.4.8)

$ rails g mongoid:config

config/mongoid.yml as per user
config/database.yml blank as per user
config/application.rb
    #require 'rails/all'
    require "action_controller/railtie"
    require "action_mailer/railtie"
    require "active_resource/railtie"
    require "rails/test_unit/railtie"
    # require "sprockets/railtie" # Uncomment this line for Rails 3.1+

remove all references to Active Record as follows
    config/application.rb
        #config.active_record.whitelist_attributes = true

    config/environments/development.rb
        #config.active_record.mass_assignment_sanitizer = :strict
        #config.active_record.auto_explain_threshold_in_seconds = 0.5

    config/environments/test.rb
      #config.active_record.mass_assignment_sanitizer = :strict

    test/test_helper.rb
        #fixtures :all

$ rails g model person
$ cat app/models/person.rb
class Person
  include Mongoid::Document
end
$ rm test/fixtures/people.yml
$ bundle exec rake test # succeeds
$ rm config/database.yml
$ bundle exec rake test # succeeds 
```

# powershell - 在 PowerShell 中更改“Windows 字体大小 (DPI)”？

> ID：10365394
> 
> 赞同：12
> 
> 时间：2012-04-28T16:27:36.943
> 
> 标签：powershell, windows-7, automation

我在办公室（Windows 7）使用带有工作站和双屏的笔记本电脑，而在家里则没有工作站。

关键是每次从工作站切换到独立笔记本电脑时，我都必须更改文本大小，因为文本大小在我的双屏上太大了，但在我的笔记本电脑屏幕上太小了。

要继续：我右键单击桌面屏幕，选择更改分辨率，然后“让文本和其他元素变大或变小”以选择 100%、125% 等...我需要重新启动会话以应用设置。（注意：我使用的是法语系统，我想我们版本的文本并不完全相同）。

这不是很方便，所以我想自动化它，也许使用 PowerShell 脚本。

理想情况下，脚本可以检测我是单独使用笔记本电脑还是使用带有两个屏幕的工作站）。另外，无需重新启动会话（我怀疑最后一点是否可行）。

我该如何开始？如果这是可能的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-12-31T12:00:00.057

正如其他答案中所假设的那样，HKLM 下的设置不是正确的位置，因为 dpi 缩放是用户定义的设置。正确的注册表键值`HKCU:\Control Panel\Desktop`是`LogPixels`.

有关所有 DPI 相关注册表设置的更多信息，请参阅*[DPI 相关 API 和注册表设置](http://technet.microsoft.com/en-us/library/dn528846.aspx#system)*。

我编写了一个小型 PowerShell 脚本，它根据当前缩放更改 DPI 缩放并执行用户注销，因此当我将设备放到不同的监视器上时，我只需执行脚本。

```
cd 'HKCU:\Control Panel\Desktop'
$val = Get-ItemProperty -Path . -Name "LogPixels"
if($val.LogPixels -ne 96)
{
    Write-Host 'Change to 100% / 96 dpi'
    Set-ItemProperty -Path . -Name LogPixels -Value 96
} else {
    Write-Host 'Change to 150% / 144 dpi'
    Set-ItemProperty -Path . -Name LogPixels -Value 144
}

logoff;exit 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-01T08:06:38.070

显然你可以设置的`LogPixels`属性

```
HKLM:/Software/Microsoft/Windows NT/CurrentVersion/FontDPI 
```

这在网络周围的很多地方都得到了重申。但是，我的印象是 dpi 是一种用户设置，在 HKLM 下没有任何意义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-01T07:44:07.137

对不起，我误读了这个问题。我以为你想控制 PowerShell 窗口。

如前所述，您可以在注册表中设置 LogPixels 设置，以查看当前设置是什么，试试这个：

```
Get-Item -Path Registry::'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\FontDPI' | Select-Object -ExpandProperty Property 
```

如果 LogPixels 键存在，它将显示，如果它不存在，您可以创建它：

```
Set-Item -Path 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\FontDPI\LogPixels' 
```

注意：您必须使用允许您操作注册表的权限运行它。

在 TechNet 上有一个很好的[介绍。](http://technet.microsoft.com/en-us/library/ee156814.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-10-01T11:43:37.807

很长一段时间后，我在谷歌上找不到任何东西。好吧，我制作了自己的脚本：

```
$perfis = (Get-ChildItem Registry::HKEY_USERS\ | Where-Object {$_.Name -match "S-1"} | ForEach-Object {Get-ItemProperty "Registry::$_\Control Panel\Desktop" -Name "Win8DpiScaling" -ErrorAction SilentlyContinue}).PSPath
foreach ($_ in $perfis) {Set-ItemProperty -Path "Registry::$_" -Name "Win8DpiScaling" -Value 0}

$monitores = (Get-ChildItem Registry::HKEY_USERS\ | Where-Object {$_.Name -match "S-1"} | ForEach-Object {Get-ChildItem "Registry::$_\Control Panel\Desktop\PerMonitorSettings" -ErrorAction SilentlyContinue}).PSPath
foreach ($_ in $monitores) {Set-ItemProperty -Path "Registry::$_" -Name "DpiValue" -Value 0} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-04-02T16:31:38.160

@Torben Schramme 我发现我必须为这项工作再添加一个 ItemProperty Win8DpiScaling。但是，我没有发现“注销；退出”功能起作用——我仍然需要手动操作。

```
cd 'HKCU:\Control Panel\Desktop'
$val = Get-ItemProperty -Path . -Name "LogPixels"
if($val.LogPixels -ne 96)
{
     Write-Host 'Change to 100% / 96 dpi'
     Set-ItemProperty -Path . -Name LogPixels -Value 96
     Set-ItemProperty -Path . -Name Win8DpiScaling 0
} else {
     Write-Host 'Change to 150% / 144 dpi'
     Set-ItemProperty -Path . -Name LogPixels -Value 144
     Set-ItemProperty -Path . -Name Win8DpiScaling 1
}
logoff;exit 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-21T15:59:28.333

通过比较`Get-ItemProperty -Path 'HKCU:\Control Panel\Desktop'`使用 Windows GUI 设置缩放级别之前和之后的输出，我发现需要设置以下属性；为我工作：

```
cd 'HKCU:\Control Panel\Desktop'
Set-ItemProperty -Path . -Name LogPixels -Value 144
Set-ItemProperty -Path . -Name Win8DpiScaling -Value 1
Set-ItemProperty -Path . -Name FocusBorderHeight -Value 2
Set-ItemProperty -Path . -Name FocusBorderWidth -Value 2
Write-Host 'Sign out and sign back in again to see changes.' 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-01T18:33:24.343

这是我发现的最直接的方法。我稍微修改了提供的功能，因此它很容易复制/粘贴。它不需要任何注册表调用或任何东西。简单而且非常有效。

你可以这样称呼它

```
Set-Scaling -scaling 0

function Set-Scaling {
    # Posted by IanXue-MSFT on
    # https://docs.microsoft.com/en-us/answers/questions/197944/batch-file-or-tool-like-powertoy-to-change-the-res.html
    # $scaling = 0 : 100% (default)
    # $scaling = 1 : 125% 
    # $scaling = 2 : 150% 
    # $scaling = 3 : 175% 
    param($scaling)
    $source = @’
    [DllImport("user32.dll", EntryPoint = "SystemParametersInfo")]
    public static extern bool SystemParametersInfo(
                      uint uiAction,
                      uint uiParam,
                      uint pvParam,
                      uint fWinIni);
    ‘@
    $apicall = Add-Type -MemberDefinition $source -Name WinAPICall -Namespace SystemParamInfo –PassThru
    $apicall::SystemParametersInfo(0x009F, $scaling, $null, 1) | Out-Null
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-12T15:26:11.727

喜欢这个答案，有人知道如何设置单个显示器而不是同时设置所有显示器吗？我有 3 台显示器，这是一个普遍的变化。

设置缩放-缩放 0

```
function Set-Scaling {
    # Posted by IanXue-MSFT on
    # https://docs.microsoft.com/en-us/answers/questions/197944/batch-file-or-tool-like-powertoy-to-change-the-res.html
    # $scaling = 0 : 100% (default)
    # $scaling = 1 : 125% 
    # $scaling = 2 : 150% 
    # $scaling = 3 : 175% 
    param($scaling)
$source = @’
    [DllImport("user32.dll", EntryPoint = "SystemParametersInfo")]
    public static extern bool SystemParametersInfo(
                      uint uiAction,
                      uint uiParam,
                      uint pvParam,
                      uint fWinIni);
‘@
    $apicall = Add-Type -MemberDefinition $source -Name WinAPICall -Namespace SystemParamInfo –PassThru
    $apicall::SystemParametersInfo(0x009F, $scaling, $null, 1) | Out-Null
    } 
```

* * *

## 回答 #9

> 赞同：-7
> 
> 时间：2018-06-04T18:36:17.177

这些简单的步骤对我有用：

1.  [从https://docs.microsoft.com/en-us/powershell/wmf/5.1/install-configure](https://docs.microsoft.com/en-us/powershell/wmf/5.1/install-configure)下载 Win7AndW2K8R2-KB3191566-x64.ZIP

2.  解压tmp文件夹中的文件

3.  以管理员身份打开 Powershell 命令窗口，进入文件已解压缩的 tmp 文件夹并执行以下命令：

    设置执行策略 remotesigned .\Install-WMF5.1.ps1

# java - ProcessBuilder 调用的 Java 进程永远休眠

> ID：10365402
> 
> 赞同：2
> 
> 时间：2012-04-28T16:29:17.080
> 
> 标签：java, object, concurrency, process

我正在开发一个完全用 Java 编写的大型系统。但在某些时候，我也会通过将 C 程序作为进程运行来与 C 程序通信，通过文件系统将一些输入传递给它，然后等待它完成从中读取结果。目前，除了这个，我什么都做不了。我没有时间通过​​ API 或类似的方式链接它们。

这工作得很好，直到我需要调用这个过程两次才能得到结果。我进行了第一次调用，它工作得很好。但是，对于第二次调用，该过程只是挂起！如果它正在睡觉并等待信号，我不知道，但我不明白为什么它应该这样做。

这是执行调用的方法：

```
public synchronized boolean processCommand(List command) {
    try { 
        ProcessBuilder pb = new ProcessBuilder(command);
        Process p = pb.start();
        p.waitFor();
        p.destroy();
    } catch(Exception ex) { return false; } 
    return true; 
} 
```

我真的不需要与标准输出或标准输入通信。我只需要该过程运行并完成其工作。但是当调用进程仅在我第二次调用它时等待它时它就会挂起！我的调用代码只是简单地制作命令列表并从另一个 java 对象调用此方法。

当 C 程序的输入较小时，对方法 processCommand(List command) 的两次调用都可以正常工作。标准输入或标准输出会有问题吗？

简直快把我逼疯了！有人对此有见识吗？我很感激你的赞扬:)

**更新：**

这是基于@Gray提到的解决方案：

我只需要排空 InputStream 和可能的 ErrorStream：

```
public synchronized boolean processCommand(List command) {
try { 
    ProcessBuilder pb = new ProcessBuilder(command);
    Process p = pb.start();
    handleStream(p.getInputStream);
    handleStream(p.getErrorStream);
    p.waitFor();
    p.destroy();
} catch(Exception ex) { return false; } 
return true; 
```

}

```
public void handleStream(InputStream input) { 
    try { 
        int c; 
        while( (c=input.read())!= -1) { //Anything }
    } catch(Exception ex) { }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:29:44.603

尝试按照[此处](http://kylecartmell.com/?p=9)建议的解决方案进行操作（原始链接似乎不可用；可以在[此处](https://www.cnblogs.com/abnercai/archive/2012/12/27/2836008.html)找到存档版本，尽管示例代码的引用链接仍指向原始站点...）

> 处理这种情况的最佳策略是在调用 waitFor 之前启动一个线程，这将在适当的时间段后中断当前线程。TimerTask 正是为这种情况而设计的，而 waitFor 在大多数情况下对中断非常敏感。[以原始链接为例]。
> 
> [...]
> 
> Java 6 API 明确指出，未能及时“读取子进程的输出流可能导致子进程阻塞，甚至死锁”。</p>
> 
> [...]
> 
> The safe bet for handling this problem today is to explicitly clean up every instance of Process by calling close on each stream made available through Process.getOutputSteam, Process.getInputStream, and Process.getErrorStream, and then call Process.destroy even if the process is already terminated.

# php - PHP，从mysql排列的数据中找到确切的值

> ID：10365403
> 
> 赞同：0
> 
> 时间：2012-04-28T16:29:21.577
> 
> 标签：php

我在 My-Sql 列中有这样的数据

```
T_interest
1,14,49,145,203,302 
```

它代表个人兴趣关键字的每个值。

我试图提取值并区分它是否具有复选框的值。

```
if(strstr($u_interest['u_interest'], ','.$row['i_idx'])):
$selected = 'checked'; 
```

这是我现在使用的 php 命令。

但它不会从数据库中提取确切的值。

假设我想检查数据是否有 14 个数字或来自此用户表

```
T_interest
1,14,49,145,203,302 
```

如果我使用上面的命令，它会告诉我用户有两个值。

```
14,145 
```

看起来 PHP strstr 命令告诉我两个值，因为这两个有 14 个数字。

那么，你能帮我解释一下为什么会这样吗？

如果您想要更多 php 行，我可以发布它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:31:58.987

将其分解成一个数组，这样您就可以获得各个值。

```
explode(",",$t_interest["u_interest"]); 
```

然后你可以更容易地测试相等性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T16:33:38.100

你真的需要阅读[数据库规范化](http://en.wikipedia.org/wiki/Database_normalization)。适当规范化的设计将使这个问题变得毫无意义。

至于您的问题，由于您被迫使用字符串操作，因此您必须检查多种不同的情况：

1) 你想要的数字在字符串的开头
2) 你想要的数字在字符串的结尾
3) 你想要的数字是字符串中唯一的数字
4) 你想要的数字在中间你的字符串：

```
SELECT ...
WHERE
    (T_Interest = 14) OR   // only number
    (T_Interest LIKE '14,%') OR /// at the begnning
    (T_Interest LIKE '%,14') OR // at the end
    (T_Insertest LIKE '%,14,%') // in the middle 
```

# java - 从可运行文件更新 GUI

> ID：10365404
> 
> 赞同：2
> 
> 时间：2012-04-28T16:29:23.063
> 
> 标签：java, swing, user-interface, concurrency, event-dispatch-thread

我正在构建一个 Swing 应用程序，其中一部分功能应该是处理和输出一些视觉和听觉的文本（使用 Mary TTS）。我需要一些关于 GUI 和文本处理类进行通信的最佳方式的建议。

GUI 类是 JPanel 的子类。其中我有一个实现 Runnable 的类，称为 LineProcesser，它准备发送到音频播放器的文本。我正在使用一个线程执行器来阻止这个 EDT（这可能不是最好的方法，但它似乎达到了我想要的结果）。

我的意图是让 LineProcessor 遍历所有文本并在每行的末尾更新一个 JTextArea。此外，它需要在某些点停止并等待用户输入。用户输入完成后，GUI 类应该告诉它继续处理。

以下代码说明了我目前拥有的内容：

```
public class MyPanel extends JPanel {
    ExecutorService lineExecutor = Executors.newSingleThreadExecutor();
    Runnable lineProcessor = new LineProcessor();

    public class LineProcessor implements Runnable {

        private int currentLineNo = 0;

            public LineProcessor() {
            //  ...
            }

            @Override
            public void run() {
                // call getText();  
                // call playAudio();
                currentLineNo++;
            }
        }
    }

    private JButton statusLbl = new JLabel();       
    private JButton mainControlBtn = new JButton();

    private void mainControlBtnActionPerformed(ActionEvent evt) {

        if (mainControlBtn.getText().equals("Start")) {
                          lineExecutor.submit(lineProcessor);
                          mainControlBtn.setText("Running");
        }
    }
} 
```

LineProcessor 如何通知 GUI 组件它们需要更改以及如何从 GUI 中暂停和重新启动它？我对是否需要 Swing Worker、属性/事件侦听器或其他东西感到困惑？我读过的例子有点道理，但我看不出如何将它们应用到我这里的代码中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T16:38:08.723

您需要做的就是将任何 Swing 调用包装在 Runnable 中，并通过`SwingUtilities.invokeLater(myRunnable);`. 就是这样。不需要 SwingWorker。

例如，

```
public class LineProcessor implements Runnable {
  private int currentLineNo = 0;
  Runnable LineProcessor = new LineProcessor();  // won't this cause infinite recursion?

  public LineProcessor() {
     // ...
  }

  @Override
  public void run() {
     // call getText();
     // call playAudio();
     currentLineNo++;

     SwingUtilities.invokeLater(new Runnable() {
        public void run() {
           // *** Swing code can go here ***
        }
     });
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T16:38:43.033

您必须同时使用 SwingWorker 和 Event 方法。

1.  将长时间运行的代码放在 Swing Worker 中。
2.  创建新的属性更改事件、监听器、管理器
3.  在您的 SwingWorker 中，当更改事件发生时，调用 PropertyChangeManager 来通知所有的 lisener。
4.  所有希望收到事件通知的 GUI 组件都应向 PropertyChangeManager 注册。
5.  您的 PropertyChangeManager 将调用 PropertyChangeListener 的 customProperyChange 方法并将传递 propertyChangeEvent

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-28T16:40:51.247

您正在寻找的是一个`SwingWorker`. 此类允许在工作线程上执行工作，定期更新 EDT，并最终更新 EDT。

SO 和 Swing 教程中提供了几个示例。只是几个链接

*   “[如何使用进度条教程”](http://docs.oracle.com/javase/tutorial/uiswing/components/progress.html)，恰好也更新了文本区域
*   ['Concurrency in Swing'](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)教程，如果你开始的话，必读`SwingWorker`
*   [`SwingWorker`](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html)文档_

可以使用`publish`方法报告进度，这些结果将传递给`process`可以更新 UI 的方法。最后，`done`调用该方法允许您执行一些最终的 UI 更新。

对于暂停/重启功能......您可以`invokeAndWait`在`doInBackground`方法中使用带有阻塞方法调用的方法（例如显示`JOptionPane`询问用户输入）。但是，如果您开始使用`invokeAndWait`in ，`doInBackground`使用 the 可能有点过头了`SwingWorker`，您可以简单地选择@Hovercraft Full Of Eels 建议的方法

# sdk - Corona SDK 3d 引擎

> ID：10365405
> 
> 赞同：2
> 
> 时间：2012-04-28T16:29:24.790
> 
> 标签：sdk, 3d, coronasdk

我已经使用 Corona SDK 快一年了，并且开发了几个简单的游戏。我现在正在寻找的是在 Corona SDK 中创建 3D 幻觉的某种方法。如果有人对 Corona 的 3D 有任何经验，我将不胜感激。我尝试了几种游戏引擎，但它们要么不能与 Corona 一起使用，要么成本太高。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T00:19:37.970

[您可以在Sketchup](http://sketchup.google.com)中创建 3D 模型，导出图像并将其添加到您的 Corona 应用程序。

如果你想要动画，你也可以从 Sketchup 中导出一堆精灵（有点），然后使用[影片剪辑](http://blog.anscamobile.com/2010/06/improved-movieclip-library/)库来播放动画。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T14:58:49.523

查看 Corona sdk 的 LIME 库，您可以使用视差或正交视图模拟 3D 效果。在 corona 的代码共享部分有一些代码，但我不知道这是否有用：

[http://developer.anscamobile.com/code/texturemapped-raycasting-engine](http://developer.anscamobile.com/code/texturemapped-raycasting-engine)

[http://developer.anscamobile.com/code/raycasting-engine](http://developer.anscamobile.com/code/raycasting-engine)

# ruby-on-rails - 使用 jQuery Mobile 收集数据的正确方法

> ID：10365407
> 
> 赞同：0
> 
> 时间：2012-04-28T16:29:44.463
> 
> 标签：ruby-on-rails, jquery-mobile

我需要调整 Ruby on Rails (v2.3.12) 应用程序以通过移动 Web 界面收集数据。我们宁愿不必使用PhoneGap、Appcelerator 等构建客户端应用程序。我查看了移动Web 工具包，jQuery Mobile 似乎是一种相对简单的方式来做我们想做的事情。

我们已经完成了一个基本的工作流程/设计，作为一系列单页。目标用户要求这非常简单。我需要通过以下方式收集主从数据：

*   步骤 1 - 2 数据元素（母版页）
*   第 2 步 - 输入 2 个数据元素以及一个 NEXT 和一个 DONE 按钮（详细信息页面）
*   第 3 步 - 在 1-3 个数据元素和 NEXT 按钮中输入数据（详细信息页面）

在第 3 步单击下一步后，我们将返回第 2 步并重复。如果完成，单击 DONE 并返回第 1 步。单击 DONE 后，我希望能够将所有数据发布回 Rails 应用程序。

这是我的第一个移动应用程序，所以我不确定在完成收集数据之前在这些详细信息页面上保存数据的最佳方法。对于此类应用程序，这也可能不是合适的方法。无论哪种方式，我都希望得到一些指导。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:48:37.540

我会通过使用动态生成的输入以单一形式处理整个事情来让事情变得超级简单。

每次按下 Next/Done 按钮时，您都会隐藏当前输入集并创建一些适当命名的新输入集（使用 js）。我会使用数组来保持一切井井有条。

输入所有数据后，可以像往常一样提交表单，并且所有内容都会在一个 POST 中发送到您的 Rails 应用程序。

# caching - 用于缓存列表页面的创造性解决方案

> ID：10365416
> 
> 赞同：0
> 
> 时间：2012-04-28T16:30:35.103
> 
> 标签：caching

我的网站上有典型的“列表”页面，例如显示 20 张照片的列表，并使用寻呼机转到 2、3、...“下一个”和“最后一个”。页面的 URL 是 photos?page= ...

然后最新的照片显示在第一页。当我使用缓存时，它将缓存所有列表页面。问题是，当添加一张或多张照片时，不仅要为第一页重建缓存，还要为所有其他页面重建缓存。

是否有不需要不断重建所有缓存列表页面的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:34:21.480

并不真地。每当页面内容更改时，都必须重置页面级缓存。

但是，您可以只缓存页面的*一部分*，并利用这些缓存来构建最终页面。您也可以只懒惰地破坏缓存，并且仅在实际查看页面时重建页面。

# javascript - 如何使用 twitter API 检索多个用户状态

> ID：10365424
> 
> 赞同：1
> 
> 时间：2012-04-28T16:31:46.130
> 
> 标签：javascript, jquery, twitter

假设我有一个包含 5 个推特句柄的列表，我想从每个推特中选择前 15 条推文。并且只在一个返回为 jsonp 的查询中执行此操作。（这将有助于克服 150 的“GET”速率限制并更好地与骨干网一起工作）

目前我正在以这种方式使用搜索 API：[https ://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name=codinghorror&count=15](https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name=codinghorror&count=15)

有什么办法可以在其中添加一个额外的网名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:55:20.297

这个 PHP 问题可能会对您有所帮助：

[PHP Twitter API - 如何拉入多个用户的推文？](https://stackoverflow.com/questions/2692434/php-twitter-api-how-to-pull-in-multiple-users-tweets)

不幸的是，twitter API 的设计目的不是为您提供那么多结果。对于上述问题的搜索 URL，限制为 15，因此，如果其中一个用户比您正在搜索的其他用户最近有 15 条推文，那么其他用户的推文将被“隐藏”。

所以如果你查询这个： [http ://search.twitter.com/search.json?q=from%3acnnbrk+OR+from%3anpratc](http://search.twitter.com/search.json?q=from%3acnnbrk+OR+from%3anpratc)

在我写这篇文章的时候，@ccnbrk 的推文似乎比@npratc 多，而@npratc 在结果中只显示一次。

API 通常旨在返回小型数据集以保持响应时间，进而鼓励用户获得更高的费率计划。

# opengl-es-2.0 - 关于初始化纹理，我应该如何管理 glActiveTexture？

> ID：10365430
> 
> 赞同：2
> 
> 时间：2012-04-28T16:32:20.343
> 
> 标签：opengl-es-2.0, webgl

我正在使用 WebGL (≈ OpenGL ES 2.0)。目前，我的应用程序使用纹理单元 0 作为每个模型的纹理，并将 1 和 2 作为着色器使用的常量纹理。

为了加载和设置纹理，我做

```
var texture = gl.createTexture();
gl.bindTexture(gl.TEXTURE_2D, texture);
gl.texImage2D(...);
gl.texParameteri(...); 
```

但是，这会影响纹理绑定到当前纹理单元的状态。为了避免这个程序，我添加了

```
gl.activeTexture(gl.TEXTURE0); 
```

到上述代码的开头，因此它只影响纹理单元 0 的绑定，该绑定在绘制任何几何图形之前被重置。

有没有更好的方法，即不涉及碰巧有可用的“临时”纹理单元？是否有针对此状态管理问题的既定最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:18:44.133

对我来说，这个问题与其他一些问题属于同一类别：您可以假设程序中某些点的 GL 状态是什么？

AFAICT你基本上有两种选择：

1.  什么都不做，按照你需要的方式设置状态。即`glActiveTextrure()`像你现在正在做的那样打电话
2.  为 GL 在程序中的某些点应该处于什么状态设置规则。例如，对于您的情况，在完成后调用绘图部分`glActiveTexture(gl.TEXTURE0)`，因此预绘图部分可以假设它是这样设置的。

但真的，不要想太多。在 OpenGL 中，您可以通过最大化（在某些实际限制内）多边形与函数调用的比率来优化程序，您也可以通过传递大量多边形来进行`glDrawArrays()`调用等来做到这一点。

# c# - OLE DB vs OPEN XML SDK vs Excel.interop

> ID：10365434
> 
> 赞同：11
> 
> 时间：2012-04-28T16:33:00.640
> 
> 标签：c#, oledb, openxml

我需要读取 XLSX 文件并从中提取最大数量的内容。我应该使用哪个 API？

OLE DB、开放 XML SDK 还是 Excel 互操作？

*   哪个最容易使用？
*   您可以使用其中一种方法检索所有信息吗？即日期、时间、合并单元格、表格、数据透视表等。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-28T18:42:33.530

您可以尝试所有这些并选择最适合您的...

根据您要阅读的数据，我建议您使用 Open XML over Interop 或 Ole DB。
我不知道一个开放的 XML SDK，虽然我有一些使用[EPPlus](http://epplus.codeplex.com/)库的经验，我经常使用它并且只能说好话 - 它快速，易于学习，有很好的例子。该库基于 Open Office XML 格式，所以我想它与您提到的 SDK 几乎相同，并且能够轻松读写 Excel 2007 和 2010 文件。
在链接的网络上，您会找到一个库本身、文档和一些示例“Hello World”项目供下载。

为什么首先要建立那个图书馆？因为有了它，您不仅可以读取单元格的值，还可以读取它们的颜色、字体、宽度和高度、合并以及所有详细的内容，您不仅可以读取，还可以进行修改。更重要的是，您不需要安装 Excel 来执行此操作。

其次——以防万一你需要从工作表中提取**表格数据**——你可以使用 OLE DB。恐怕您将无法提取有关格式、颜色等的任何信息，并且数据必须在表格组织的工作表中，因此您可以将其视为数据库的表。

最后一个是 Interop，因为：
- 它是一个 COM 库，因此在通过 .NET 使用它时需要非常小心，因为它很容易导致一些丑陋且难以发现的内存泄漏（我自己的糟糕经历证实了） -如果您没有正确处理它们的对象，它将打开 Excel.exe 进程，
-它比以前的方法慢得多，
-基本上，它几乎没有以前的方法之一（EPPlus 或 OleDB）的附加值，并且需要Excel要安装在客户的机器上，为什么要使用它？

那么祝你好运吧。

# android - 在 Android 设备中使用来自 google maps 链接/url/ 的地理坐标

> ID：10365439
> 
> 赞同：0
> 
> 时间：2012-04-28T16:33:34.587
> 
> 标签：android, maps, geo

我有意图过滤器来拦截来自谷歌地图的网址。我的问题是：缩短的链接。如果我不知道坐标 - 链接是无用的。不幸的是，在谷歌地图中，​​Android 链接被缩短了。在网络用户可以选择谷歌地图链接的类型 - 是否短。在这种情况下，我有机会使用坐标。

简而言之：如果有这样的链接

```
http://maps.google.com/maps?q=45.089036,+-106.347656&num=1&t=h&vpsrc=0&ie=UTF8&z=4&iwloc=A 
```

读取坐标没有问题。但如果链接是：

```
http://m.google.com/u/m/zIOcsV 
```

哎呀...谷歌有内部方法来解决这个链接。

有人找到从第二个链接获取坐标的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T15:37:42.143

您可以使用谷歌地图地理坐标的 jquery 移动应用程序示例：

* * *

[jsfiddle-google-maps-地理坐标](http://jsfiddle.net/yakirmanor/wzcAZ/)

或在此处使用自定义图像：[jsfiddle-google-map-with-images](http://jsfiddle.net/yakirmanor/CzkfG/)

头是：

```
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
<!--link rel="stylesheet" href="/Content/jquery-mobile-responsive.css" /-->
<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
<script src="http://maps.google.com/maps/api/js?sensor=true&language=en"></script>
<script>
    $(document).bind("mobileinit", function () {
        $.mobile.ajaxEnabled = false;
    });

    $(Start);

    function Start() {
        $("#google_map .ui-collapsible-heading").click(function () {
            var locations = [
              ['<br/>Main Office', 31.590496, 34.561981, 4],
              ['Sensor 16<br/>User Name: 16_DE-1R', 31.590595, 34.562980, 5],
              ['Sensor 17<br/>User Name: 17_TEN-2MP', 31.590694, 34.563979, 3],
              ['Sensor 18<br/>User Name: 18_TEN-2MP', 31.590793, 34.564978, 2],
            ];

            var map = new google.maps.Map(document.getElementById('googleMap'), {
                zoom: 17,
                center: new google.maps.LatLng(31.590892, 34.561977),
                mapTypeId: google.maps.MapTypeId.ROADMAP
            });

            var infowindow = new google.maps.InfoWindow();

            var marker, i;

            for (i = 0; i < locations.length; i++) {
                marker = new google.maps.Marker({
                    position: new google.maps.LatLng(locations[i][3], locations[i][2]),
                    map: map
                });

                google.maps.event.addListener(marker, 'click', (function (marker, i) {
                    return function () {
                        infowindow.setContent(locations[i][0]);
                        infowindow.open(map, marker);
                    }
                })(marker, i));
            }
        });
    }
</script> 
```

与身体：

```
<div data-role="page" class="type-interior">
<div data-role="header" data-theme="a">
    <a data-icon="back" href="#" rel="external">Back</a>
    <h1>Sensor</h1>
</div>
<div data-role="content">
    <div class="content-primary">
        <h2>Sensor: 16</h2>
            <div data-role="collapsible-set">
                <div id="google_map" data-role='collapsible' data-collapsed=true data-theme="b" data-content-theme="d">
                    <h1>Sensor Map</h1>
                    <div id="googleMap" style="width:100%; height:300px;"></div>
                </div>
            </div>    
        <ul data-role="listview" data-inset="true" data-theme="b">
            <li data-role="list-divider"></li>                
            <li><a href="#" rel="external">Configure Comm</a></li>
            <li><a href="#" rel="external">Measurements</a></li>
            <li><a href="#" rel="external">Users</a></li>
        </ul>
    </div>
    <div class="content-secondary">
        <div data-role="collapsible" data-collapsed="true" data-theme="b" data-content-theme="d">
                <h3>More Options</h3>
                <ul data-role="listview" data-theme="c" data-dividertheme="d">
                    <li data-role="list-divider">Actions</li>
                    <li><a href="/Home/UserList?back=Index" rel="external">Add User</a></li>
                    <li><a href="#" rel="external">Edit Sensor</a></li>
                    <li><a href="#" rel="external">Delete Sensor</a></li>
                </ul>
        </div>
    </div>
</div>
<div data-role="footer" data-theme="a">
    <h4>Mobile</h4>
</div> 
```

# ios - 在 viewcontroller 的启动时执行 segue

> ID：10365440
> 
> 赞同：1
> 
> 时间：2012-04-28T16:33:34.803
> 
> 标签：ios, storyboard, segue, uistoryboard, uistoryboardsegue

我有一个登录屏幕，我想做的是检测用户是否已经登录并最终弹出一个模式。

我创建了一个自定义 segue，显示没有动画的模态。

```
@implementation NonAnimatedSegue

-(void) perform {

    [self.sourceViewController presentModalViewController:self.destinationViewController animated:NO];

} 
```

问题是从 viewDidLoad 或 viewWillAppear 调用这个 segue 无效。如果我从 viewDidAppear 调用它，登录屏幕会在模式打开之前闪烁一段时间。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T22:08:03.630

我解决这个问题的方法是检查应用程序完成启动并根据需要设置根视图控制器。像这样：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    /*stuff*/
    /*get the view controller from storyboard/nib*/
    [self.window setRootViewController:CorrectViewController];
} 
```

它不会显示模式视图，而只会显示启动时的登录信息。

# android - 警报对话框不适用于列表的所有项目

> ID：10365444
> 
> 赞同：0
> 
> 时间：2012-04-28T16:34:06.993
> 
> 标签：android, listview, android-alertdialog

我有一个从数据库中获取的位置的列表视图，我在项目上创建了一个 OnItemLongClickListener，在长按后，在消息正文中激活了带有一些信息的警报对话框，这些信息是我从数据库中获取的有关项目的信息点击。该对话框有 3 个工作正常的按钮（呼叫、映射它和查看照片）。该对话框适用于前 8 个项目，然后对话框不打开，应用程序强制关闭其余项目，我不知道为什么！

你能帮我么？

这是显示所有酒店列表的代码：

```
List<Hotel> values = datasource.getAllHotels();
            if (values.isEmpty())
            {
                Toast.makeText(this, "No results found!", Toast.LENGTH_LONG).show();
                Intent i1 = new Intent(hotelSearchList.this, hotelSearch.class);
                startActivity(i1);
            }
            ArrayAdapter<Hotel> adapter = new ArrayAdapter<Hotel>(this,
                    android.R.layout.simple_list_item_1, values);
            setListAdapter(adapter);
            ListView lv = getListView();
            lv.setOnItemLongClickListener(this); 
```

这是 onItemLongClickListener 的代码：

```
public boolean onItemLongClick(final AdapterView<?> parent, final View view, int position,
        long id) {
    // TODO Auto-generated method stub
    String hotelName = (String) ((TextView)parent.getChildAt(position)).getText();
    final List<Hotel> location = datasource.getHotelLocation(hotelName);
    String loc = "Location: " + TextUtils.join(", ", location);
    List<Hotel> address = datasource.getHotelAddress(hotelName);
    String add = "Address: " + TextUtils.join(", ", address);
    List<Hotel> rating = datasource.getHotelRating(hotelName);
    String rat = "Rating: " + TextUtils.join(", ", rating);
    List<Hotel> phone = datasource.getHotelPhone(hotelName);
    final String phoneN = "Phone: " + TextUtils.join(", ", phone);
    List<Hotel> latitude = datasource.getHotelLat(hotelName);
    final String lat = latitude.get(0).toString();
    List<Hotel> longitude = datasource.getHotelLon(hotelName);
    final String lon = longitude.get(0).toString();
    List<Hotel> photo = datasource.getHotelPhoto(hotelName);
    final String pho = photo.get(0).toString();
    //Toast.makeText(hotelSearchList.this, "The hotel clicked is " + hotelName, Toast.LENGTH_LONG).show();
    AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setTitle("Information About " + hotelName);
    builder.setMessage(loc + "\n" + add + "\n" + rat + "\n" + phoneN + "\n");

    builder.setPositiveButton("Call", new DialogInterface.OnClickListener() {

        public void onClick(DialogInterface dialog, int which) {
            // TODO Auto-generated method stub
            Intent i = new Intent(Intent.ACTION_DIAL, Uri.parse("tel:" + phoneN));
            startActivity(i);
        }
    });
    builder.setNegativeButton("View Photo", new DialogInterface.OnClickListener() {

        public void onClick(DialogInterface dialog, int which) {
            // TODO Auto-generated method stub
            Intent i = new Intent(hotelSearchList.this, imageV.class);
            i.putExtra("photo", pho);
            startActivity(i);
        }
    });
    builder.setNeutralButton("Map it", new DialogInterface.OnClickListener() {

        public void onClick(DialogInterface arg0, int arg1) {
            // TODO Auto-generated method stub
            Intent i = new Intent(hotelSearchList.this, mapActivity.class);
            i.putExtra("latitude", lat);
            i.putExtra("longitude", lon);
            startActivity(i);
        }
    });

    builder.setCancelable(true);
    builder.show();
    return false;
} 
```

这是日志猫：

```
04-28 19:47:15.159: E/AndroidRuntime(384): FATAL EXCEPTION: main
04-28 19:47:15.159: E/AndroidRuntime(384): java.lang.NullPointerException
04-28 19:47:15.159: E/AndroidRuntime(384):  at egypt.interfaceAct.touristicASearchList.onItemLongClick(touristicASearchList.java:134)
04-28 19:47:15.159: E/AndroidRuntime(384):  at android.widget.AbsListView.performLongPress(AbsListView.java:1753)
04-28 19:47:15.159: E/AndroidRuntime(384):  at android.widget.AbsListView.access$600(AbsListView.java:72)
04-28 19:47:15.159: E/AndroidRuntime(384):  at android.widget.AbsListView$CheckForLongPress.run(AbsListView.java:1711)
04-28 19:47:15.159: E/AndroidRuntime(384):  at android.os.Handler.handleCallback(Handler.java:587)
04-28 19:47:15.159: E/AndroidRuntime(384):  at android.os.Handler.dispatchMessage(Handler.java:92)
04-28 19:47:15.159: E/AndroidRuntime(384):  at android.os.Looper.loop(Looper.java:123)
04-28 19:47:15.159: E/AndroidRuntime(384):  at android.app.ActivityThread.main(ActivityThread.java:4627)
04-28 19:47:15.159: E/AndroidRuntime(384):  at java.lang.reflect.Method.invokeNative(Native Method)
04-28 19:47:15.159: E/AndroidRuntime(384):  at java.lang.reflect.Method.invoke(Method.java:521)
04-28 19:47:15.159: E/AndroidRuntime(384):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
04-28 19:47:15.159: E/AndroidRuntime(384):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
04-28 19:47:15.159: E/AndroidRuntime(384):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T16:40:44.940

前 8 次您可能是指无需滚动即可显示在屏幕上的项目，对吧？

您需要发布一些代码以便我们为您提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:11:37.860

`onItemLongClick()`这是设置一些断点和使用调试器的绝佳时机。它将帮助您找到空值或至少找到它崩溃的行。

我愿意猜测对话框打开的次数无关紧要，我假设您的第 8 个条目是无效的。如果您先单击第 8 个条目，它仍然会崩溃吗？如果是这样，您检查您的数据库，第 8 行是否`hotelName`包含您请求的*所有*字段，或者一个（或多个）列是否具有*空*值？

**添加**

当列表滚动并使用此行时：

```
String hotelName = (String) ((TextView)parent.getChildAt(position)).getText(); 
```

该位置超出范围，返回*null*导致您的 NullPointerException 因为父级的唯一子级是可见的，而是尝试更快、更简单的方法：

```
String hotelname = ((TextView) view).getText().toString(); 
```

# macos - MacOS X：删除应用程序时删除 plist 文件

> ID：10365445
> 
> 赞同：0
> 
> 时间：2012-04-28T16:34:15.550
> 
> 标签：macos

我在应用程序启动时显示许可证表格，但它应该只在应用程序首次启动时显示。不总是。所以，我试图在 plist 或用户默认值中存储一个标志，但是在应用程序删除（移动到垃圾箱）时，plist 或 userdefaults 没有从系统中删除，因此我无法完成我的任务。

这是我在下面一直在尝试的，

我在 plist 文件中存储一个标志并在应用程序启动期间保存文件（在 Documents 目录中），所以下次，我可以从那里读取并确定应用程序是否第一次运行。我在这里失败了，因为即使应用程序已从系统中删除（移动到垃圾箱），我也无法删除此 plist 文件。

我也尝试在 NSUserDefaults 中设置一个标志，但是在删除应用程序并再次构建并启动应用程序后，它仍然保留了我存储的先前值。我想知道，从系统中删除应用程序时，NSUserDefaults 不会被删除吗？

```
NSUserDefaults *ud = [NSUserDefaults standardUserDefaults];        
    [ud setObject:@"1" forKey:@"APPLAUNCHED"]; // store user default
    [ud synchronize]; 
```

有人可以建议吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:01:47.873

删除应用程序时，用户默认设置和应用程序沙箱都不会自动删除。我认为没有办法做到这一点。

# ios - 如何以编程方式选择故事板？

> ID：10365450
> 
> 赞同：0
> 
> 时间：2012-04-28T16:34:25.893
> 
> 标签：ios, localization, storyboard

我有一个支持 3 种不同语言的 iOS 5 应用程序。本地化情节提要会创建每种语言的副本，并且必须翻译每种语言。

语言选择取决于系统设置，所以如果我的 iPhone 将“英语”作为系统语言，我的应用程序中选择的故事板将是英语。如果我更改为加泰罗尼亚语，我的应用程序将显示加泰罗尼亚语单词。

在我看来，这种方法有几个缺点：

*   应用程序无法翻译成 Apple 不支持的语言。这对于单一语言可能很重要（直到 iOS 5 才支持加泰罗尼亚语）。

*   如果用户希望我的应用程序使用加泰罗尼亚语，但系统的其余部分使用英语？

所以我的问题是如何在应用程序启动时选择故事板语言？有可能吗？它也适用于使用 NSLocalizedString 本地化的字符串吗？

问候，琼巴

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T10:52:17.233

在阅读了 Jacob 的答案并进行了一些测试之后，这是对我有用的代码：

```
 int main(int argc, char *argv[])
{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    // Reset system defaults to get the complete language list.
    [defaults removeObjectForKey:@"AppleLanguages"];
    // Default language choosen by user.
    NSString *defLanguage = [defaults objectForKey:@"Language"];
    NSArray *sysLangugages = [defaults arrayForKey:@"AppleLanguages"];
    // System default language: first element of array.
    NSString *sysLanguage = [sysLangugages objectAtIndex:0];
    NSArray *array = [NSArray arrayWithObjects:defLanguage, sysLanguage, nil];
    [defaults setObject:array forKey:@"AppleLanguages"];

    @autoreleasepool {
        return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));
    }
} 
```

更改默认语言后只需重新启动应用程序，所有本地化资源都会更改：字符串和情节提要。

还在 AppDelegate.m 中尝试了这段代码，方法是：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 
```

但它不起作用。只有在 main.m 中才能正常工作。我不知道为什么。

请注意，使用此代码，您可以拥有 iOS 不支持的语言的应用程序。

问候，

琼巴

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:45:15.350

似乎您可以将故事板拆分为本地化版本，就像localized.strings 一样，如何做到这一点？

[这个问题](https://stackoverflow.com/questions/1669645/how-to-force-nslocalizedstring-to-use-a-specific-language)之前已经回答过了，虽然我没有从经验中尝试过。

# c++ - 为什么未初始化的变量会打印一个奇怪的负值？

> ID：10365453
> 
> 赞同：-6
> 
> 时间：2012-04-28T16:34:52.373
> 
> 标签：c++, variables, cout

为什么未初始化的变量会打印一个奇怪的负值？

```
int x;
cout << x << endl; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-28T16:36:19.547

你在做什么（读取未初始化变量的值）是[未定义的行为](http://loungecpp.wikidot.com/faq#toc12)；任何事情都可能发生，从看起来可以工作，到打印随机值，到崩溃，再到用信用卡购买披萨。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-28T17:04:00.300

未[初始化变量](http://en.wikipedia.org/wiki/Uninitialized_variable)是已声明但在使用前未设置为明确的已知值的变量。它会有一些价值，但不是可预测的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T17:47:31.220

当变量未初始化时，它会显示“垃圾值”。这意味着它可以是来自任何地方的任意数字，可能来自另一个正在运行的应用程序或来自大内存池的随机数。

# c# - 写变量快捷方式

> ID：10365458
> 
> 赞同：0
> 
> 时间：2012-04-28T16:35:25.880
> 
> 标签：c#, asp.net, text, render

我有以下代码：

```
<link rel="stylesheet" type="text/css" href="<%= GlobalVar.BasePath %>/css/style.css" /> 
```

c# 代码呈现为文本，但以下工作：

```
<link rel="stylesheet" type="text/css" href=<%= "\"" + GlobalVar.BasePath %>/css/style.css" /> 
```

只是好奇，像我在第一个示例中所做的那样正常渲染它的解决方案是什么？

我只想知道为什么它呈现为文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:20:15.667

不知道为什么会出现问题，但您可以通过以编程方式添加 css 链接来解决使用 GlobalVar 的问题：

```
protected void Page_Init(object sender, EventArgs e)
{ 
    HtmlLink css = new HtmlLink();
    css.Href = String.Format("{0}/css/style.css", GlobalVar.BasePath);
    css.Attributes["rel"] = "stylesheet";
    css.Attributes["type"] = "text/css";
    css.Attributes["media"] = "all";
    Page.Header.Controls.Add(css); 
} 
```

# windows - 如何在 MFC 中获取子菜单？

> ID：10365459
> 
> 赞同：5
> 
> 时间：2012-04-28T16:35:51.577
> 
> 标签：windows, winapi, mfc

我正在尝试获取一个子菜单，以便在显示之前对其进行更改。

所以我`OnInitMenu()`为我的窗口创建了一个处理程序。而我本来打算用来`pMenu->GetMenuItemInfo()`获取子菜单的。

但是，这似乎不会奏效。为了找到我想要的菜单，我必须提供菜单命令 ID（我不认为硬编码项目位置令人满意）。但是打开子菜单的菜单项没有命令 ID。我可以获得该子菜单中存在的菜单命令，但是我仍然没有菜单本身。

如何找到嵌套在主菜单中的子菜单，而不依赖`MF_BYPOSITION`?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-02-18T14:23:39.770

我对同样问题的解决方案是创建一个辅助函数来搜索菜单并根据菜单名称返回位置。

```
int CEnviroView::FindMenuItem(CMenu* Menu, LPCTSTR MenuName) {
    int count = Menu->GetMenuItemCount();
    for (int i = 0; i < count; i++) {
        CString str;
        if (Menu->GetMenuString(i, str, MF_BYPOSITION) &&
            str.Compare(MenuName) == 0)
            return i;
    }
    return -1;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-29T01:28:55.350

答案似乎是你不能。使用命令 ID 定位菜单命令非常有意义，因为这样的代码将在您重新排列菜单项时继续工作。但是，作为子菜单的菜单项根本没有命令 ID。

一种方法是使用已知的菜单命令，您可以按 ID 搜索该命令，然后在该命令旁边插入新项目。但是，您仍然需要包含菜单。

我最终使用的方法是研究 MFC 用来填充“文件”菜单中*最近使用*的文件列表的代码。[通用技术在Microsoft Systems Journal 的 Paul DiLascia 的 Q & A 专栏](http://www.microsoft.com/msj/0899/c/c0899.aspx)中有所描述。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-29T16:57:07.120

使用允许您更新菜单项的 MFC 命令路由会更简单吗？如果这是 MDI/SDI 应用程序，您可以免费获得它，否则您将不得不实施更新机制。

不要处理`WM_INITMENU`。你应该处理`WM_INITMENUPOPUP`。`WM_INITMENUPOPUP`提供指向即将弹出的菜单的指针。

在处理程序中，您可以编写一个代码，允许对话框使用所有菜单的 UI 更新机制更新特定菜单项，或者您可以只处理您必须在处理程序中更改的特定菜单项的更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T16:39:38.933

您可以使用`GetSubMenu`类中的方法`CMenu`。

[http://msdn.microsoft.com/en-us/library/dtfc356x(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/dtfc356x(v=vs.80).aspx)

# ajax - 通过 AJAX 提交关于选择更改的表单

> ID：10365464
> 
> 赞同：8
> 
> 时间：2012-04-28T16:36:34.027
> 
> 标签：ajax, forms, submit

假设我有这个表格：

```
<form action="Change-status.php" method="post">
        <select class="changeStatus" name="changeStatus">
                <option value="0">Starting</option>
                <option value="1">Ongoing</option>
                <option value="2">Over</option>
        </select>
        <input class="projectId" type="hidden" name="projectId" value="<?php echo $data['id'];?>"/>
</form> 
```

我目前正在使用此脚本提交表单，但这意味着刷新：

```
$('select').change(function ()
{
    $(this).closest('form').submit();
}); 
```

我想要做的是在**不刷新页面的情况下**发送选择更改的表单。我知道我必须使用 AJAX 来做到这一点，但我无法完全弄清楚如何实现它。

你能指导我如何做到这一点吗？

谢谢你的帮助。

**编辑 ：**

考虑到评论后，我最终得到了以下代码：

网页：

```
<form action="" method="post">
        <select class="changeStatus" name="changeStatus">
                <option value="0">Starting</option>
                <option value="1">Ongoing</option>
                <option value="2">Over</option>
        </select>
        <input class="projectId" type="hidden" name="projectId" value="<?php echo $data['id'];?>"/>
</form> 
```

JS：

```
$(document).ready(function() {
    $('select.changeStatus').change(function(){
        $.ajax({
                type: 'POST',
                url: 'Change-status.php',
                data: {selectFieldValue: $('select.changeStatus').val(), projectId: $('input[name$="projectId"]').val()},
                dataType: 'html'
         });
    });
}); 
```

PHP：

```
<?php
    include('../Include/Connect.php');

    $changeStatus=$_POST['selectFieldValue'];
    $id=$_POST['projectId'];

    $sql='UPDATE project SET progress="'.$changeStatus.'" WHERE id="'.$id.'"';

    mysql_query($sql) or die("Erreur: ".mysql_error());
?> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T17:03:36.960

让跨浏览器`onchange`事件和 AJAX 请求正常工作并非易事。我建议您使用某种 javascript 框架，它可以抽象出所有跨浏览器问题，因此您不必担心它们。

**尝试一个js框架**

[Jquery](http://www.jquery.com)就是这样一个框架，它具有诸如[`.change()`](http://api.jquery.com/change/)将处理程序附加到元素的更改事件`<select>`以及[`.get()`](http://api.jquery.com/jQuery.get/)执行 GET 请求等方法。

这里有一些代码可以帮助您入门：-

```
// The $ is the shorthand for a jquery function, you can then use jquery 
// selectors which are essentially the same as css selectors, so here
// we select your select field and then bind a function to 
// it's change event handler
$('select.changeStatus').change(function(){

    // You can access the value of your select field using the .val() method
    alert('Select field value has changed to' + $('select.changeStatus').val());

   // You can perform an ajax request using the .ajax() method
   $.ajax({
       type: 'GET',
      url: 'changeStatus.php', // This is the url that will be requested

      // This is an object of values that will be passed as GET variables and 
      // available inside changeStatus.php as $_GET['selectFieldValue'] etc...
      data: {selectFieldValue: $('select.changeStatus').val()},

      // This is what to do once a successful request has been completed - if 
      // you want to do nothing then simply don't include it. But I suggest you 
      // add something so that your use knows the db has been updated
      success: function(html){ Do something with the response },
      dataType: 'html'
    });

}); 
```

**一些比我的解释更好的参考资料**

请注意，要使此代码正常工作，您需要在页面上包含带有`<script>`标签的 jquery 库。

[有关使用 jquery 的快速入门指南，](http://docs.jquery.com/Tutorials%3aGetting_Started_with_jQuery)请参见此处

[这里有一个关于如何使用jquery`ajax()`方法的初学者教程](http://kyleschaeffer.com/best-practices/the-perfect-jquery-ajax-request/)

# ruby - 启动 AppScale 实例时出错：/usr/bin/ruby: bad interpreter: No such file or directory

> ID：10365465
> 
> 赞同：0
> 
> 时间：2012-04-28T16:36:40.267
> 
> 标签：ruby, virtualization

我正在尝试启动一些 AppScale 实例。当我尝试执行

```
/bin/appscale-run-instances 
```

我收到这样的错误：

```
 -bash: bin/appscale-run-instances: /usr/bin/ruby: bad interpreter: No such file or directory 
```

我正在尝试运行的映像是 KVM 映像（我正在尝试创建一个虚拟集群）。这个错误是什么意思？我的 Ruby 安装有问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T16:42:00.520

这意味着其中一件事情正在发生：

您有一个损坏的 Ruby 安装 您有多个 Ruby 安装 您的安装没有正确配置。要确定这是否是第一种情况，您可以运行`ruby`并查看是否得到任何响应。

否则，您的安装已损坏，您需要重新安装。如果你这样做了，那么你就运行 which ruby​​。这应该为您提供 Ruby 可执行文件的绝对路径。如果这不是`/usr/bin/ruby`自制软件（以及一堆其他程序）将无法找到它。

如果您从未篡改过您的 Ruby 安装，您可以检查是否`/usr/bin/ruby`已经存在：`cat /usr/bin/ruby`. 如果你得到 No such file or directory，那么你可以很容易地创建一个符号链接到你的 Ruby 安装。假设 which ruby​​ to by 的输出`/usr/local/bin/ruby`，您以这种方式创建符号链接：`sudo ln -s /usr/local/bin/ruby /usr/bin/ruby`一切都应该很好。

如果该位置有文件，您可以运行 file`/usr/bin/ruby`以查看它是真实文件、符号链接还是修改文件。如果它是一个符号链接，那么您的安装应该可以正常工作，因为它不是，它可能是一个损坏的符号链接或者它是一个伪造的文件。

您可以通过首先删除它`(sudo rm /usr/bin/ruby)`然后创建一个指向正确位置的新符号链接来解决这个问题`(sudo ln -s /usr/local/bin/ruby /usr/bin/ruby)`。

如果上述方法都不起作用，您应该在全新安装 Xcode 并删除系统上的任何 Ruby 安装痕迹后咨询自制软件团队。

# javascript - JSON 格式的 Jquery.ajax API 请求导致 Chrome 中出现“Uncaught SyntaxError: Unexpected token :”

> ID：10365469
> 
> 赞同：2
> 
> 时间：2012-04-28T16:37:18.807
> 
> 标签：javascript, jquery, ajax, json, jsonp

我正在尝试使用 jquery.ajax查询[http://developer.pintlabs.com/brewerydb/api-documentation 。](http://developer.pintlabs.com/brewerydb/api-documentation)

这是我尝试过的两个 Jquery 请求（注意“O3tmVI”是一个虚拟 ID）：

```
 $.ajax({
            url:"http://api.playground.brewerydb.com/beer/" + "O3tmVI" + "?key=A1029384756B&format=json",
            dataType: "jsonp",
            jsonpCallback: "callbackfunctie",
            success:function(oData){
                    var returnData = oData;
                    console.log(returnData);     
            }
    }); 
```

和：

```
$.getJSON("http://api.playground.brewerydb.com/beer/" + "O3tmVI" + "?key=A1029384756B&format=json&jsoncallback=?",
                function(data){
                    console.log(data);
                }); 
```

两者都会导致此错误：

> Uncaught SyntaxError: Unexpected token :

现在，返回的 json 对象如下所示：

```
{"message":"Request Successful","data":{"id":"O3tmVI","name":"The Public","description":"The Public\u2122 is a delicious easy drinking pale ale made from a simple recipe of quality grain and top notch American hops. Tawny hues of caramel and amber are a trademark of the Public ale as well as a delicious spruce crispness resulting from a beautiful abundance of hops! This beer will be produced throughout the year and serves as the foundation of our product line.","abv":"6","glasswareId":8,"availableId":1,"styleId":33,"isOrganic":"N","labels":{"icon":"http:\/\/s3.amazonaws.com\/brewerydbapi\/beer\/O3tmVI\/upload_3sdJcU-icon.png","medium":"http:\/\/s3.amazonaws.com\/brewerydbapi\/beer\/O3tmVI\/upload_3sdJcU-medium.png","large":"http:\/\/s3.amazonaws.com\/brewerydbapi\/beer\/O3tmVI\/upload_3sdJcU-large.png"},"status":"verified","statusDisplay":"Verified","servingTemperature":"cool","servingTemperatureDisplay":"Cool - (8-12C\/45-54F)","createDate":"2012-04-05 04:02:36","updateDate":"2012-04-05 04:34:17","glass":{"id":8,"name":"Tulip","createDate":"2012-04-05 04:00:04"},"available":{"id":"1","name":"Year Round","description":"Available year round as a staple beer."},"style":{"id":33,"categoryId":10,"category":{"id":10,"name":"American Ale","bjcpCategory":"10","createDate":"2012-04-05 04:00:04"},"bjcpSubcategory":"A","name":"American Pale Ale","simpleUrl":"american-pale-ale","ibuMin":"30","ibuMax":"45","abvMin":"4.5","abvMax":"6.2","srmMin":"5","srmMax":"14","ogMin":"1.045","ogMax":"1.06","fgMin":"1.01","fgMax":"1.015","createDate":"2012-04-05 04:00:04"}},"status":"success"} 
```

我已成功将其验证为有效的 JSON

现在，问题是我需要一个 JSONP 对象才能请求它（跨域）。所以它必须被包装在一个容器函数中。使用请求中的参数应该可以做到这一点，但是到目前为止，我几乎尝试了任何方法，但都没有成功...

我发现这篇文章有一个关于这个错误的简短条目：[http ://www.jquery4u.com/json/ajaxjquery-getjson-simple/](http://www.jquery4u.com/json/ajaxjquery-getjson-simple/)

> Uncaught SyntaxError: Unexpected token :(in crome) Invalid Lable(in firefox) “invalid label” 错误可以通过将 JSON 数据传递给 js 回调来修复

但我真的不明白他在说什么

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T23:07:51.827

我的猜测是[http://api.playground.brewerydb.com/beer/](http://api.playground.brewerydb.com/beer/)上的服务正在返回 json 但**不是**jsonp。在 jsonp 标签中搜索“Unexpected token”，你会发现很多解释，比如[这个](https://stackoverflow.com/a/10093781/1211981)。json 必须包装在一个javascript 函数中，即回调，但它取决于跨域Web 服务是否支持jsonp。这是由浏览器强制执行的，jQuery 无法克服它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-11T06:54:18.717

API 在设计上不支持 JSONP

> 不，我们不 [支持 JSONP]，因为您必须公开您的 API 密钥。最好的办法是在您身边设置一个中间代理。

见[推特](https://twitter.com/brewerydb/status/404677533712793600)。

请注意，[Open Beer Database上的人](http://openbeerdatabase.com/documentation/examples-jsonp) **确实**支持 JSONP。

# common-lisp - 修改作为参数传递的列表会在 SBCL 和 CLISP 中产生不同的结果

> ID：10365470
> 
> 赞同：1
> 
> 时间：2012-04-28T16:37:36.863
> 
> 标签：common-lisp

有人可以解释为什么我使用 sbcl 和 clisp 为以下简单程序得到不同的结果吗？我在做什么是语言未定义的，还是两个 lisp 解释器之一是错误的？

```
; Modify the car of the passed-in list
(defun modify (a) (setf (car a) 123))

; Create a list and print car before and after calling modify
(defun testit () (let ((a '(0)))
                   (print (car a))
                   (modify a)
                   (print (car a))))
(testit) 
```

SBCL（版本 1.0.51）产生：

```
0 
0 
```

CLISP（2.49 版）产生（我所期望的）：

```
0 
123 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T20:29:22.910

我同意 Seth 和 Vsevolod 的评论，因为这种行为是由于您修改了文字数据。尝试使用`(list 0)`而不是`'(0)`. 与此相关的问题比较频繁，因此我将在此处引用[HyperSpec](http://www.lispworks.com/documentation/HyperSpec/Front/index.htm)。

[3.7.1 文字对象的修改](http://www.lispworks.com/documentation/lw51/CLHS/Body/03_ga.htm)：

> 如果文字对象被破坏性修改，后果是不确定的。

[“字面”](http://www.lispworks.com/documentation/lw51/CLHS/Body/26_glo_l.htm#literal)的定义：

> 字面上的形容词。（对象的）在程序中直接引用而不是由程序计算；也就是说，以引用形式显示为数据，或者，如果对象是自评估对象，则显示为未引用的数据。``在 (cons "one" '("two")) 形式中，表达式 "one"、("two") 和 "two" 是文字对象。''

请注意，通常（在许多实现中），如果您修改文字值，您将真正在代码本身中修改它们——编写*自修改代码*。您的示例代码将无法按预期工作。

您在 CCL 中的示例代码：

```
CL-USER> (defun modify (a) (setf (car a) 123))
MODIFY
CL-USER> (defun testit ()
           (let ((a '(0)))
             (print (car a))
             (modify a)
             (print (car a))))
TESTIT
CL-USER> (testit)

0 
123 
123
CL-USER> (testit)

123 
123 
123 
```

看一下 的第二个评估`testit`，它`let`本身确实已经包含修改后的值，因此第一个`print`也产生`123`。

另请参阅：[Lisp, cons and (number . number) difference](https://stackoverflow.com/questions/6865142/lisp-cons-and-number-number-difference/6866155#6866155)，我在其中更详细地解释了这一点，或者上面 Vsevolod 评论中链接的问题。

# html -

> ID：10365476
> 
> 赞同：4
> 
> 时间：2012-04-28T16:38:21.187
> 
> 标签：html, css, header, tags, dreamweaver

我正在使用内联 CSS 在 Dreamweaver 中设计一封电子邮件，但是我在 Firefox 和 Chrome 中使用 Hotmail 进行的每次测试总是将标题标签呈现为绿色字体颜色。我希望字体正常。什么都不会改变它。为什么`<h1>`-`<h6>`呈现为字体颜色？

```
<div class="blockheader">
    <h2>New event starting today!</h2>
</div>

<style>
#block .blockheader {
    background-color: #000;
    color: #FFF;
    font-family: "Arial Black";
    display: block;
    text-align: left;
    padding: 2px 0px 2px 0px;
}
</style> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T16:50:25.843

在为电子邮件编写 HTML/CSS 时，您往往不得不假装自己回到了过去。意思是，编写非常基本的标记，并使用内联样式：

```
<h1 style="color: #FFF; background: #000">Foo Email</h1> 
```

此外，请查看[HTML Email Boilerplate](http://htmlemailboilerplate.com/)。您可能还会发现[Inline Styler](http://inlinestyler.torchboxapps.com/)也有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:37:58.737

在做一些研究时，Hotmail 将 h 标签呈现为绿色，我没有看到任何充分的理由。我发现的修复是在您的内联样式中使用 !important 。所以像这样：

`<h4 style="color: #660000 !important;">Awesome Red Header in Hotmail</h4>`

希望这可以帮助。

# javascript - 如何让我的脚本只影响它自己在 jquery 中的图像？

> ID：10365477
> 
> 赞同：1
> 
> 时间：2012-04-28T16:38:27.347
> 
> 标签：javascript, jquery

我正在尝试实现 SpaceGallery 脚本。万维网：[http](http://www.eyecon.ro/spacegallery/) ://www.eyecon.ro/spacegallery/ 。它从#div 获取图像并制作幻灯片，就像在线演示一样。我的 HTML 文件的一部分：

```
 <div id="myGallery0" class="spacegallery">      
<img class="imaz" src="ADDITIONAL.jpg" alt="" atr1="lupa" />    
<img class="aaa" src=images/bw1.jpg alt="" atr1="bw1" />
<img class="aaa" src=images/bw2.jpg alt="" atr1="bw2" />
<img class="aaa" src=images/bw3.jpg alt="" atr1="bw3" />
            </div>

        <div id="myGallery1" class="spacegallery">      
<img class="imaz" src="ADDITIONAL.jpg" alt="" atr1="lupa" />
<img class="aaa" src=images3/bw1.jpg alt="" atr1="bw1" />
<img class="aaa" src=images3/bw2.jpg alt="" atr1="bw2" />
<img class="aaa" src=images3/lights2.jpg alt="" atr1="bw3" />
            </div>

            <script>
    var initLayout = function() {
        $('#myGallery0').spacegallery({loadingClass: 'loading'});
        $('#myGallery1').spacegallery({loadingClass: 'loading'});
                };  
        EYE.register(initLayout, 'init');
            </script> 
```

现在，当我调用 $('img.aaa') 时，脚本运行良好！该脚本仅从它自己的 ID（mygallery0 或 mygallery1）中滑动图像。假设我的主 .js 文件中有以下 .onclick 内容。

```
 $('img.imaz').fadeOut(); 
```

当我在我的一个画廊（mygaller0 或 mygallery1）中滑动图像时，我所有的画廊中的 img“ADDITIONAL.jpg”（它的类 = imaz）都会淡出！这是为什么？如何解决？

空间画廊.js

```
(function($){
    EYE.extend({

        spacegallery: {

            //default options (many options are controled via CSS)
            defaults: {
                border: 6, // border arround the image
                perspective: 100, // perpective height
                minScale: 0.1, // minimum scale for the image in the back
                duration: 800, // aimation duration
                loadingClass: null, // CSS class applied to the element while looading images
                before: function(){
                    $('img.imaz').fadeOut();
                    return false
                    },
                after: function(el){    
                    $('img.imaz').fadeIn();                 
                    return false
                    }
            },

            animated: false,

            //position images 
            positionImages: function(el) {

                var top = 0;

                EYE.spacegallery.animated = false;
                $(el)
                    .find('a')
                        .removeClass(el.spacegalleryCfg.loadingClass)
                        .end()
                        .find('img.aaa')
                        .each(function(nr){

                            console.log('WYSOKOSC ' + $(this).attr('height'));

                            var newWidth = this.spacegallery.origWidth - (this.spacegallery.origWidth - this.spacegallery.origWidth * el.spacegalleryCfg.minScale) * el.spacegalleryCfg.asins[nr];

                            $(this)
                                .css({
                                    top: el.spacegalleryCfg.tops[nr] + 'px',
                                    marginLeft: - parseInt((newWidth + el.spacegalleryCfg.border)/2, 10) + 'px',
                                    opacity: 1 - el.spacegalleryCfg.asins[nr]
                                }) 
                                .attr('width', parseInt(newWidth));
                            this.spacegallery.next = el.spacegalleryCfg.asins[nr+1];
                            this.spacegallery.nextTop = el.spacegalleryCfg.tops[nr+1] - el.spacegalleryCfg.tops[nr];
                            this.spacegallery.origTop = el.spacegalleryCfg.tops[nr];
                            this.spacegallery.opacity = 1 - el.spacegalleryCfg.asins[nr];
                            this.spacegallery.increment = el.spacegalleryCfg.asins[nr] - this.spacegallery.next;
                            this.spacegallery.current = el.spacegalleryCfg.asins[nr];
                            this.spacegallery.width = newWidth;
                        })

            },

            //animate to nex image
            next: function(e) {
                if (EYE.spacegallery.animated === false) {
                    EYE.spacegallery.animated = true;

                    var el = this.parentNode;

                    el.spacegalleryCfg.before.apply(el);
                    $(el)
                        .css('spacegallery', 0)
                        .animate({
                            spacegallery: 100
                        },{
                            easing: 'easeOut',
                            duration: el.spacegalleryCfg.duration,
                            complete: function() {

                                $(el)
                                    .find('img.aaa:last')
                                    .prependTo(el);

                                EYE.spacegallery.positionImages(el);
                                el.spacegalleryCfg.after.apply(el);
                            }, 

                            step: function(now) {

                                $('img.aaa', this)
                                    .each(function(nr){

                                        console.log('step: ' + $(this).attr('atr1'));

                                        var newWidth, top, next;
                                        if (nr + 1 == el.spacegalleryCfg.images) {
                                            top = this.spacegallery.origTop + this.spacegallery.nextTop * 4 * now /100;
                                            newWidth = this.spacegallery.width * top / this.spacegallery.origTop;
                                            $(this)
                                                .css({
                                                    top: top + 'px',
                                                    opacity: 0.7 - now/100,
                                                    marginLeft: - parseInt((newWidth + el.spacegalleryCfg.border)/2, 10) + 'px'
                                                })
                                                .attr('width', newWidth);
                                        } 

                                        else {
                                            next = this.spacegallery.current - this.spacegallery.increment * now /100;
                                            newWidth = this.spacegallery.origWidth - (this.spacegallery.origWidth - this.spacegallery.origWidth * el.spacegalleryCfg.minScale) * next;
                                            $(this).css({
                                                top: this.spacegallery.origTop + this.spacegallery.nextTop * now /100 + 'px',
                                                opacity: 1 - next,
                                                marginLeft: - parseInt((newWidth + el.spacegalleryCfg.border)/2, 10) + 'px'
                                            })
                                            .attr('width', newWidth);
                                        }
                                    });
                            }
                        });
                }

                this.blur();
                return false;
            },

            //constructor
            init: function(opt) {
                opt = $.extend({}, EYE.spacegallery.defaults, opt||{});
                return this.each(function(){
                    var el = this;
                    if ($(el).is('.spacegallery')) {
                        $('<a href="#"></a>')
                            .appendTo(this)
                            .addClass(opt.loadingClass)
                            .bind('click', EYE.spacegallery.next);

                        el.spacegalleryCfg = opt;
                        el.spacegalleryCfg.images = 3;                              
                        el.spacegalleryCfg.loaded = 0;
                        el.spacegalleryCfg.asin = Math.asin(1);
                        el.spacegalleryCfg.asins = {};
                        el.spacegalleryCfg.tops = {};
                        el.spacegalleryCfg.increment = parseInt(el.spacegalleryCfg.perspective/el.spacegalleryCfg.images, 10);
                        var top = 0;

                        $('img.aaa', el)
                            .each(function(nr){
                                var imgEl = new Image();
                                var elImg = this;

                                el.spacegalleryCfg.asins[nr] = 1 - Math.asin((nr+1)/el.spacegalleryCfg.images)/el.spacegalleryCfg.asin;
                                top += el.spacegalleryCfg.increment - el.spacegalleryCfg.increment * el.spacegalleryCfg.asins[nr];
                                el.spacegalleryCfg.tops[nr] = top;
                                elImg.spacegallery = {};
                                imgEl.src = this.src;
                                if (imgEl.complete) {

                                    el.spacegalleryCfg.loaded ++;
                                    elImg.spacegallery.origWidth = imgEl.width;
                                    elImg.spacegallery.origHeight = imgEl.height
                                } else {
                                    imgEl.onload = function() {
                                        el.spacegalleryCfg.loaded ++;
                                        elImg.spacegallery.origWidth = imgEl.width;
                                        elImg.spacegallery.origHeight = imgEl.height
                                        if (el.spacegalleryCfg.loaded == el.spacegalleryCfg.images) {

                                            EYE.spacegallery.positionImages(el);
                                        }
                                    };
                                }
                            });

                        el.spacegalleryCfg.asins[el.spacegalleryCfg.images] = el.spacegalleryCfg.asins[el.spacegalleryCfg.images - 1] * 1.3;
                        el.spacegalleryCfg.tops[el.spacegalleryCfg.images] = el.spacegalleryCfg.tops[el.spacegalleryCfg.images - 1] * 1.3;
                        if (el.spacegalleryCfg.loaded == el.spacegalleryCfg.images) {
                            EYE.spacegallery.positionImages(el);
                        }
                    }
                });
            }
        }
    });

    $.fn.extend({

        /**
         * Create a space gallery
         * @name spacegallery
         * @description create a space gallery
         * @option  int         border          Images' border. Default: 6
         * @option  int         perspective     Perpective height. Default: 140
         * @option  float       minScale        Minimum scale for the image in the back. Default: 0.2
         * @option  int         duration        Animation duration. Default: 800
         * @option  string      loadingClass    CSS class applied to the element while looading images. Default: null
         * @option  function    before          Callback function triggered before going to the next image
         * @option  function    after           Callback function triggered after going to the next image
         */
        spacegallery: EYE.spacegallery.init
    });
    $.extend($.easing,{
        easeOut:function (x, t, b, c, d) {
            return -c *(t/=d)*(t-2) + b;
        }
    });
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:01:43.247

您可以尝试将匹配的图像限制为当前元素的上下文，方法是`this`作为第二个参数传入选择器。

```
defaults: {
    /* options */
    before: function(){
        $('img.imaz', this).fadeOut();
    },
    after: function(el){    
        $('img.imaz', this).fadeIn();
    }
} 
```

当我们传入`this`, 作为选择器中的第二个参数时，我们告诉 jQuery 为 target `"img.imaz"`，但只有当它在 中找到时`this`，这意味着当前正在处理的元素。在您的项目中，这将是`#myGallery0`或`#myGallery1`。

[您可以在http://api.jquery.com/jQuery/](http://api.jquery.com/jQuery/)在线了解有关上下文参数的更多信息

# jquery - 模态中的Jquery导航

> ID：10365478
> 
> 赞同：0
> 
> 时间：2012-04-28T16:38:36.567
> 
> 标签：jquery

我正在使用模态显示图像。

```
 function showPhoto(pictureinfo){ 
 var photo = $('<div id="piccontent"></div>');
 var split = (pictureinfo).split("_");
 var title = split[0];
 var albumid = split[1];
 var attachmentid = split[2];
 var wWidth = $(window).width();
 var wheight = $(window).height();
 var dWidth = wWidth * 0.8;
 var datastring = 'albumid='+ albumid +'&attachmentid='+ attachmentid;
 $.ajax({
 url: 'album.php',
 data: datastring,

 success: function(data) {
 photo.html(data).dialog({title: title, width: 'auto', height:'auto',
 close: function(ev, ui) {  
$('.body_wrapper').css({
opacity: 1.0
});
 } ,
        buttons: [{
            text: "Close",
            className: 'cancelButtonClass',
            click: function() {
                photo.dialog('close');
                $('.body_wrapper').css({
                    opacity: 1.0
                });
            }
        }]}) .dialog('open');
  $('.body_wrapper').fadeTo("slow", 0.1);

  $('textarea').autosize();
  $(".comment").watermark('Write a comment');
  }
  });
  }; 
```

* * *

当您单击拇指时，它会返回上述功能。在结果中我有下一个和上一个链接。单击时，它会返回模态中的下一个/上一个图像。

```
$('.albumnav').live('click', function(){ 
var picdata = this.id;  
$.ajax({
url: 'album.php',
data: picdata,
success: function(data) {
$('#piccontent').html(data);
}});
}); 
```

* * *

一切都很完美。但是如果我关闭模式并尝试再次打开它，当我再次单击下一个/上一个链接时，萤火虫会向我显示正确的响应但 div piccontent 没有更新

```
$('#piccontent').html(data); 
```

什么可以阻止该部门更新？响应是直截了当的，并且 div 存在。

谢谢你。

# android - Android：我如何告诉一个活动从服务中做某事？

> ID：10365486
> 
> 赞同：0
> 
> 时间：2012-04-28T16:39:47.297
> 
> 标签：android, sockets, service, android-activity, extras

我有一个启动的主要活动： 1.- 写入套接字的网络易发线程。2.-应该从套接字读取的网络易发服务。到目前为止，我已经完成了 1。但我希望从套接字读取的信息显示在主要活动中。我知道我可以使用 extras 在活动和服务之间传递信息，但我如何告诉活动更新并获取新数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:11:11.230

我想你可以在你的主要活动中使用广播意图和广播接收器来实现后台通信。

这是一个可以实现这一点的片段。

（活动中的代码）：

```
class MyActivity extends Activity{
    CustomEventReceiver mReceiver=new CustomEventReceiver();

    @Override
    public void onCreate(Bundle savedInstanceState){
        super.onCreate(savedInstanceState);
        /*YOUR ONCREATE CODE HERE*/

        /*Set up filters for broadcast receiver so that your reciver
        can only receive what you want it to receive*/
        IntentFilter filter = new IntentFilter();
        filter.addAction(CustomEventReceiver.ACTION_MSG_CUSTOM1);
        filter.addCategory(Intent.CATEGORY_DEFAULT);
        registerReceiver(mReceiver, filter);

    }

    @Override
    public void onDestroy(){
        super.onDestroy();
        /*YOUR DESTROY CODE HERE*/
        unregisterReceiver(mReceiver);
    }

    /*YOUR CURRENT ACTIVITY OTHER CODE HERE, WHATEVER IT IS*/

    public class CustomEventReceiver extends BroadcastReceiver{
        public static final String ACTION_MSG_CUSTOM1 = "yourproject.action.MSG_CUSTOM1";
        @Override
        public void onReceive(Context context, Intent intent){
            if(intent.getAction().equals(ACTION_MSG_CUSTOM1)){
                /*Fetch your extras here from the intent
                and update your activity here.
                Everything will be done in the UI thread*/

            }
        }
    }
} 
```

然后，在您的服务中，您只需广播一个意图（以及您需要的任何额外内容）......用这样的话说：

```
Intent tmpIntent = new Intent();
tmpIntent.setAction(CustomEventReceiver.ACTION_MSG_CUSTOM1);
tmpIntent.setCategory(Intent.CATEGORY_DEFAULT);
/*put your extras here, with tmpIntent.putExtra(..., ...)*/
sendBroadcast(tmpIntent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:47:40.103

One option could be to write the output of the socket reader to a stream - a file stored in the app's internal storage for example, and then periodically poll that file in the activity thread.

# objective-c - 分段错误 11 | CGEventTap 应用程序在任意时间后停止处理鼠标事件。

> ID：10365487
> 
> 赞同：2
> 
> 时间：2012-04-28T16:39:56.660
> 
> 标签：objective-c, macos, cocoa, core-graphics, cgeventtap

此应用程序的目的是 24/7 全天候在后台运行并将鼠标锁定在屏幕中央。它适用于一系列 Flash 程序来模拟鼠标的操纵杆式移动。我已经尝试使用 Cocoa/Quartz 中内置的其他方法来实现这一点，但它们都没有达到我的目的，所以这就是我必须这样做的方式。

我一直试图弄清楚为什么在看似随机的时间之后，这个程序只是停止限制鼠标。该程序没有给出错误或类似的东西，它只是停止工作。强制退出屏幕确实显示“不响应”，但是，我的许多鼠标修改脚本，包括这个脚本，*总是*读为“不响应”并且它们继续运行。

这是代码：

```
code removed, check below for updated code. 
```

* * *

## 最终更新

Ken Thomases 给了我正确的答案，我已经根据他的建议更新了我的代码。这是我完美运行的最终代码（在我手动停止之前，它运行了 12 多个小时，没有出现任何故障）：

```
#import <Cocoa/Cocoa.h>
#import <CoreMedia/CoreMedia.h>

int screen_width, screen_height;

struct event_tap_data_struct {
    CFMachPortRef event_tap;
    float speed_modifier;    
};

CGEventRef 
mouse_filter(CGEventTapProxy proxy, CGEventType type, CGEventRef event, struct event_tap_data_struct *);

int
screen_res(int);

int
main(int argc, char *argv[]) {

    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    screen_width = screen_res(0);
    screen_height = screen_res(1);
    CFRunLoopSourceRef runLoopSource;
    CGEventMask event_mask = kCGEventMaskForAllEvents;

    CGSetLocalEventsSuppressionInterval(0);
    CFMachPortRef eventTap;
    struct event_tap_data_struct event_tap_data = {eventTap,0.2};

    eventTap = CGEventTapCreate(kCGHIDEventTap, kCGHeadInsertEventTap, 0, event_mask, mouse_filter, &event_tap_data);
    event_tap_data.event_tap = eventTap;
    if (!eventTap) {
        NSLog(@"Couldn't create event tap!");
        exit(1); 
    }

    runLoopSource = CFMachPortCreateRunLoopSource(kCFAllocatorDefault, event_tap_data.event_tap, 0);

    CFRunLoopAddSource(CFRunLoopGetCurrent(), runLoopSource, kCFRunLoopCommonModes);

    CGEventTapEnable(event_tap_data.event_tap, true);

    CFRunLoopRun();

    CFRelease(eventTap);
    CFRelease(runLoopSource);
    [pool release];

    exit(0);
}

int
screen_res(int width_or_height) {

    NSRect screenRect;
    NSArray *screenArray = [NSScreen screens];
    unsigned screenCount = (unsigned)[screenArray count];

    for (unsigned index  = 0; index < screenCount; index++)
    {
        NSScreen *screen = [screenArray objectAtIndex: index];
        screenRect = [screen visibleFrame];
    }
    int resolution_array[] = {(int)CGDisplayPixelsWide(CGMainDisplayID()),(int)CGDisplayPixelsHigh(CGMainDisplayID())};

    if(width_or_height==0){
        return resolution_array[0];
    }else {
        return resolution_array[1];

    }

}

CGEventRef 
mouse_filter(CGEventTapProxy proxy, CGEventType type, CGEventRef event, struct event_tap_data_struct *event_tap_data) {

    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    if (type == kCGEventTapDisabledByTimeout || type == kCGEventTapDisabledByUserInput) {

        CGEventTapEnable(event_tap_data->event_tap,true);
        return event;

    } else if (type == kCGEventMouseMoved || type == kCGEventLeftMouseDragged || type == kCGEventRightMouseDragged || type == kCGEventOtherMouseDragged){

    CGPoint point = CGEventGetLocation(event);
    NSPoint old_point;

    CGPoint target; 
    int tX = point.x; 
    int tY = point.y; 
    float oX = screen_width/2;
    float oY = screen_height/2;
    float dX = tX-oX;
    float dY = tY-oY;

    old_point.x = floor(oX); old_point.y = floor(oY);

    dX*=2, dY*=2;

    tX = round(oX + dX);
    tY = round(oY + dY);

    target = CGPointMake(tX, tY);

    CGWarpMouseCursorPosition(old_point);
    CGEventSetLocation(event,target);

    }

    [pool release];

    return event;
} 
```

* * *

## （第一）更新：

该程序仍在崩溃，但我现在已将其作为可执行文件运行并收到错误代码。

当它终止时，控制台会记录“Segmentation Fault：11”。

我一直试图找出这意味着什么，但它似乎是一个令人印象深刻的广泛术语，而且我还没有磨练出一些有用的东西。

这是我正在使用的新代码：

```
#import <Cocoa/Cocoa.h>
#import <CoreMedia/CoreMedia.h>

int screen_width, screen_height;

struct event_tap_data_struct {
    CFMachPortRef event_tap;
    float speed_modifier;    
};

CGEventRef 
mouse_filter(CGEventTapProxy proxy, CGEventType type, CGEventRef event, struct event_tap_data_struct *);

int
screen_res(int);

int
main(int argc, char *argv[]) {

    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    screen_width = screen_res(0);
    screen_height = screen_res(1);
    CFRunLoopSourceRef runLoopSource;
    CGEventMask event_mask;
    event_mask = CGEventMaskBit(kCGEventMouseMoved) | CGEventMaskBit(kCGEventLeftMouseDragged) | CGEventMaskBit(kCGEventRightMouseDragged) | CGEventMaskBit(kCGEventOtherMouseDragged);

    CGSetLocalEventsSuppressionInterval(0);
    CFMachPortRef eventTap;
    CFMachPortRef *eventTapPtr = &eventTap;
    struct event_tap_data_struct event_tap_data = {*eventTapPtr,0.2};

    eventTap = CGEventTapCreate(kCGHIDEventTap, kCGHeadInsertEventTap, 0, event_mask, mouse_filter, &event_tap_data);

    if (!eventTap) {
        NSLog(@"Couldn't create event tap!");
        exit(1);
    }

    runLoopSource = CFMachPortCreateRunLoopSource(kCFAllocatorDefault, eventTap, 0);

    CFRunLoopAddSource(CFRunLoopGetCurrent(), runLoopSource, kCFRunLoopCommonModes);

    CGEventTapEnable(eventTap, true);

    CFRunLoopRun();

    CFRelease(eventTap);
    CFRelease(runLoopSource);
    [pool release];

    exit(0);
}

int
screen_res(int width_or_height) {

    NSRect screenRect;
    NSArray *screenArray = [NSScreen screens];
    unsigned screenCount = (unsigned)[screenArray count];

    for (unsigned index  = 0; index < screenCount; index++)
    {
        NSScreen *screen = [screenArray objectAtIndex: index];
        screenRect = [screen visibleFrame];
    }
    int resolution_array[] = {(int)CGDisplayPixelsWide(CGMainDisplayID()),(int)CGDisplayPixelsHigh(CGMainDisplayID())};

    if(width_or_height==0){
        return resolution_array[0];
    }else {
        return resolution_array[1];

    }

}

CGEventRef 
mouse_filter(CGEventTapProxy proxy, CGEventType type, CGEventRef event, struct event_tap_data_struct *event_tap_data) {

    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];

    if (type == kCGEventTapDisabledByTimeout || type == kCGEventTapDisabledByUserInput) {

        CGEventTapEnable(event_tap_data->event_tap,true);

    }

    CGPoint point = CGEventGetLocation(event);
    NSPoint old_point;

    CGPoint target; 
    int tX = point.x; 
    int tY = point.y; 
    float oX = screen_width/2;
    float oY = screen_height/2;
    float dX = tX-oX;
    float dY = tY-oY;

    old_point.x = floor(oX); old_point.y = floor(oY);

    dX*=2, dY*=2;

    tX = round(oX + dX);
    tY = round(oY + dY);

    target = CGPointMake(tX, tY);

    CGWarpMouseCursorPosition(old_point);
    CGEventSetLocation(event,target);

    [pool release];

    return event;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:14:49.837

`kCGEventTapDisabledByTimeout`您需要在收到或时重新启用您的事件点击`kCGEventTapDisabledByUserInput`。

* * *

更新：这是你的台词以及它们是如何（未能）工作的：

```
CFMachPortRef eventTap; // uninitialized value
CFMachPortRef *eventTapPtr = &eventTap; // pointer to eventTap
struct event_tap_data_struct event_tap_data = {*eventTapPtr,0.2}; // dereferences pointer, copying uninitialized value into struct

eventTap = CGEventTapCreate(kCGHIDEventTap, kCGHeadInsertEventTap, 0, event_mask, mouse_filter, &event_tap_data); // sets eventTap but has no effect on event_tap_data 
```

# php - CakePHP 2.0 搜索数据库错误

> ID：10365489
> 
> 赞同：0
> 
> 时间：2012-04-28T16:40:05.487
> 
> 标签：php, mysql, search, cakephp-2.1

您好我正在尝试创建一个函数来搜索我的 Uploads 模型并显示该表中的信息。

```
 Notice (8): Undefined variable: uploads [APP/View/Uploads/search.ctp, line 28]
 Warning (2): Invalid argument supplied for foreach() [APP/View/Uploads/search.ctp, line 28] 
```

在我什至被允许搜索之前，我得到了这个错误，

这是我的 search.ctp

```
 <?php $uploads = $this->requestAction('uploads/search'); 
       ?>

     <div id="search">
  <?php echo $this->Form->create('Upload',array('action'=>'search'));?>
   <fieldset>
    <legend><?php __('Upload Search');?></legend>
    <?php
    echo $this->Form->input('searchupload', array('label' => false, 'class'=>'searchinput')); 

    $options = array(
                     'label' => '',
                     'value' => 'Search',
                     'class' => 'searchbutton'
                            );
    echo $this->Form->end($options);

?>
</fieldset>

    </div>
    <div id="contentbox">
<table>
    <?php foreach($uploads as $upload) : ?>  
        <tr>
            <td><?php echo $upload['Upload']['name'] ?></td>
            <td><?php echo $upload['Upload']['eventname'] ?></td>
        </tr>
    <?php endforeach; ?>
</table>
    </div> 
```

这是上传控制器中的功能：

```
 function search() {

        if (!empty($this->data)) {
    $searchstr = $this->data['Upload']['search'];
    $this->set('searchstring', $this->data['Upload']['search']);
    $conditions = array(
        'conditions' => array(
        'or' => array(
            "Upload.name LIKE" => "%$searchstr%",
            "Upload.eventname LIKE" => "%$searchstr%"
        )
        )
    );
   $this->set('uploads', $this->Upload->find('all', $conditions));
     }
        } 
```

任何帮助将不胜感激！

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T10:50:04.330

```
 <?php if(!empty($uploads)) : ?>
    <?php foreach($uploads as $upload) : ?>  
        <tr>
            <td><?php echo $upload['Upload']['name'] ?></td>
            <td><?php echo $upload['Upload']['eventname'] ?></td>
        </tr>
    <?php endforeach; ?>
    <?php else : ?>

 <div>
   No search matches found
   </div>

     <?php endif; ?> 
```

这确保如果找到一个空集，则将未找到的搜索匹配项扔到网页中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T20:30:55.313

为什么要从同一个视图运行两次上传/搜索？

尝试从您的视图中删除它：

```
<?php $uploads = $this->requestAction('uploads/search'); ?> 
```

它调用您使用 search.ctp 呈现的相同操作。

**更新：**

如果您收到未定义变量通知（顺便说一下，在生产和调试设置为 0 时您不会看到），您需要做的就是在控制器（而不是视图）中将上传变量设置为 null。在运行搜索之前，请执行以下操作：`$this->set('uploads', array());`在控制器中，以便在视图中定义变量。你不想让逻辑混乱视图。

# android - 为Android编写应用程序的简单语言？

> ID：10365490
> 
> 赞同：2
> 
> 时间：2012-04-28T16:40:14.517
> 
> 标签：android, basic

根据[这个问题](https://stackoverflow.com/questions/7878865/is-visual-basic-compatible-with-android)，似乎为 Android 编写应用程序的唯一方法是 Java。

真的没有更简单的语言，最好是更接近 BASIC 或 Python 的语言吗？[Basic4PPC](http://en.wikipedia.org/wiki/Basic4ppc)怎么样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T16:42:25.937

[您可以使用http://www.appcelerator.com/platform/titanium-sdk](http://www.appcelerator.com/platform/titanium-sdk)用 Ja​​vaScript编写它，更重要的是您的应用程序也适用于 iOS

**创建一个窗口**

```
var win = Titanium.UI.createWindow({
  title:'My Window',
  backgroundColor:'#cccccc'
});
win.open();  // open window 
```

**创建标签**

```
var label = Titanium.UI.createLabel({
  color:'#999',
  text:'Hello World',
  font:{fontSize:20},
  textAlign:'center'
});
win.add(label); // add label to window
win.open();     // open window 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:02:15.813

请只编写本机应用程序。只有原生应用看起来不错。Android SDK 非常简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T16:49:32.517

~~Android 使用[Java 虚拟机](http://en.wikipedia.org/wiki/Java_virtual_machine)来运行他们的应用程序，并且没有用于 Basic 或 Python 的编译器。您将需要一些其他系统来将您的其他语言代码转换为 Java。~~

我建议找到一个好的 Java 教程，并将[Android Development Guide](http://developer.android.com/reference/android/package-summary.html)和[Java API](http://docs.oracle.com/javase/6/docs/api/)加入书签，因为 Java 是一种很棒的编程语言，几乎可以在所有机器上运行。

你知道 VB.net，因为 C#.net 不会太难，而且 C#.net 与 Java 非常相似。

**更新 ：**

我在使用 Java 虚拟机的 Android 上是不正确的，它使用了[Dalvik 虚拟机](http://en.wikipedia.org/wiki/Dalvik_%28software%29)，它采用编译后的 java 字节码，并将其转换为 Dalvik 可执行文件（.dex），而 .dex 文件是 Dalvik 虚拟机用来运行应用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T16:58:23.890

由于您专门询问了它们，因此网络搜索似乎表明存在一些第三方（即，不是来自 Google）的产品，用于在 android 设备上运行 Basic 和 Python 编写的代码。

# database - Meteor 如何执行数据库迁移？

> ID：10365496
> 
> 赞同：25
> 
> 时间：2012-04-28T16:41:01.953
> 
> 标签：database, upgrade, migrate, meteor, downgrade

您如何使用 Meteor 执行数据库迁移？有了 Ruby on Rails，就有了 ActiveRecord::Migration。Meteor 中是否有等效机制？

例如，我用一些用户数据制作了一个应用程序。我使用 JSON 格式将数据存储在 Mongo 中。应用程序发生更改，JSON 数据库架构也需要更改。我可以编写一个迁移方法来更改架构，但是，我只希望它在服务器数据库过时时运行。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-28T19:34:20.290

没有为此内置任何内容。我自己现在所做的与 Rails 的工作方式类似，但作为启动的一部分而不是单独的任务。首先创建一个`Meteor.Collection`名为 Migrations，然后为每个离散的迁移，`server`在启动时运行的子目录下创建一个函数。它应该只在之前没有运行过的情况下运行迁移，并且一旦完成，它应该在 Migrations 集合中标记迁移。

```
// database migrations
Migrations = new Meteor.Collection('migrations');

Meteor.startup(function () {
  if (!Migrations.findOne({name: "addFullName"})) {
    Users.find().forEach(function (user) {
      Users.update(user._id, {$set: {fullname: users.firstname + ' ' + users.lastname}});
    });
    Migrations.insert({name: "addFullName"});
  }
}); 
```

您可以扩展此技术以支持向下迁移（查找给定迁移的存在并将其反转），对迁移强制执行排序顺序，并根据需要将每个迁移拆分为单独的文件。

考虑一个自动化的智能包会很有趣。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-12-09T08:12:25.887

正如 Aram 在评论中已经指出的那样， p [ercolate:migrations](https://github.com/percolatestudio/meteor-migrations)包可以满足您的需求。样本

```
Migrations.add({
    version: 1,
    name: 'Adds pants to some people in the db.',
    up: function() {//code to migrate up to version 1}
    down: function() {//code to migrate down to version 0}
});

Migrations.add({
    version: 2,
    name: 'Adds a hat to all people in the db who are wearing pants.',
    up: function() {//code to migrate up to version 2}
    down: function() {//code to migrate down to version 1}
}); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-19T22:18:41.460

我为这个用例创建了一个智能包。
见[https://atmosphere.meteor.com/package/migrations](https://atmosphere.meteor.com/package/migrations)

# c# - 尝试调用方法时出错

> ID：10365502
> 
> 赞同：2
> 
> 时间：2012-04-28T16:42:07.937
> 
> 标签：c#, methods, call, reflection.emit, system.reflection

我有这个代码：

```
var work = new DynamicMethod("work", null, Type.EmptyTypes);
            var il = work.GetILGenerator();
            il.Emit(OpCodes.Ldstr, "a");
            il.Emit(OpCodes.Call, typeof(Console).GetMethod("WriteLine", new Type[]{typeof(string)}));
            var d = (Action)work.CreateDelegate(typeof(Action));
            d(); 
```

我只是想通过 System.Reflection.Emit 创建新方法。但这给我带来了这个错误：

```
Common Language Runtime detected an invalid program. 
```

有谁知道我必须如何修复它才能正常工作或错误在哪里？请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T16:45:32.610

我认为你错过了一个发出返回的调用：

```
il.Emit(OpCodes.Ldstr, "a");
il.Emit(OpCodes.Call, typeof(Console).GetMethod("WriteLine", new Type[]{typeof(string)}));
il.Emit(OpCodes.Ret); 
```

# php - 这个正则表达式有什么问题，试图匹配模式 name1.name2？

> ID：10365507
> 
> 赞同：0
> 
> 时间：2012-04-28T16:42:49.590
> 
> 标签：php, regex

我正在尝试`"john.doe"`使用此正则表达式匹配模式 , ：

```
 ^(([a-zA-Z0-9_\.-]+)\.([a-zA-Z0-9_\.-]))/?$ 
```

我无法让它匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:07:36.487

正则表达式只是过大

```
list($name1, $name2) = explode('.', $name, 2); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:22:50.293

正则表达式`/^([\w\-]+)\.([\w\-]+)$/`应该适用于您正在尝试做的事情。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-28T17:37:04.667

就像 Dmitri Chubarov 所说（归功于他），您只需`+`在第二组添加一个标志：

 ~~~~```
^(([a-zA-Z0-9_\.-]+)\.([a-zA-Z0-9_\.-]+))/?$ 
```~~  ~~```
^((([a-zA-Z0-9_-]+\.)*[a-zA-Z0-9_-]+)\.(([a-zA-Z0-9_-]+\.)*[a-zA-Z0-9_-]+))/?$ 
```

这将适用于：

```
jhon.doe
this.also.work
this.will.also.work 
```

但不是：

```
x..
..x
..
...
....
..... 
```

[http://regexpal.com/?flags=gm®ex=%5E(((%3F%3A%5Ba-zA-Z0-9_-%5D%2B%5C](http://regexpal.com/?flags=gm&regex=%5E(((%3F%3A%5Ba-zA-Z0-9_-%5D%2B%5C) .)*%5Ba-zA-Z0-9_-% 5D%2B)%5C.((%3F%3A%5Ba-zA-Z0-9_-%5D%2B%5C.)*%5Ba-zA-Z0-9_-%5D%2B))%2F%3F %24&input=john.doe%0Afirst.second%0Aand.this.works%0Aand.this.also.works%0Ax.x%0Ax..%0A..x%0A..%0A...%0A.. ..%0A.....~~~~

# c# - 在所有其他条件相同的情况下，哪个 Windows 7 平台将创建最轻、最小的 Windows 应用程序？

> ID：10365509
> 
> 赞同：-1
> 
> 时间：2012-04-28T16:43:03.130
> 
> 标签：c#, windows

我正在编写一个旨在在 Windows 7 32 位上运行的小型应用程序。该应用程序有一个或两个屏幕，允许从 SQL 数据源进行简单的数据输入和检索。该应用程序将读取数据、解析和操作，然后输出到文件或剪贴板。

在所有其他条件相同的情况下，在这种简单的情况下，哪种语言或平台将生成开销最小的程序（运行时的 CPU 和内存使用）？

例如，我想 C++ 会创建一个比 Adob​​e Air 更快、更小的应用程序，因为 Air 应用程序在 Air 环境中运行，并且每次运行都会产生 Air 的开销。

我正在考虑 C# 和 WinForms，但我想知道 .NET 框架的开销（速度 + 内存使用）是否会比在 Windows 7 上以不同语言/平台开发的解决方案增加内存占用和 cpu 使用率。

我考虑过的一些事情：

1.  Autohotkey - 我将它用于简单的 GUI，但随着 GUI 变得越来越复杂，我很难维护
2.  C++ - 我不知道如何使用它，所以它不是我的选择

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T16:46:55.217

使用你认为最容易开发的任何东西。C# 和 WinForms 将是一个非常合理的选择。确实，本机解决方案将比托管代码更轻巧。但是，对于您所描述的应用程序类型，除非您计划在 15 年的机器上运行，否则无论您选择使用哪种语言/工具，您都不会遇到性能问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T16:47:02.347

C++ 以速度取胜，因为它没有托管内存或背后的 .net 框架。也就是说，因为它没有那个，所以开发起来会更加困难。在现代 CPU 上，如果它是一个简单的 GUI，它不会有太大的不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T16:55:54.110

虽然对 .NET 应用程序的内存影响不是最佳的，但程序集的大小通常很小，因为大部分使用的代码已经安装在框架本身的库中。

在简单的场景中，可以使用 XCopy 安装 .NET 应用程序，这意味着不需要安装例程。只需将您的 EXE 和 DLL 复制到一个文件夹中并启动应用程序。

# php - php file_get_contents 给出错误

> ID：10365510
> 
> 赞同：1
> 
> 时间：2012-04-28T16:43:06.300
> 
> 标签：php, json, http

当我在浏览器上运行以下查询时：

```
http://127.0.0.1:8096/solr/select/?q=june 17&amp;start=0&amp;rows=8&amp;indent=on&amp;hl=on&amp;hl.fl=Data&amp;wt=json 
```

我得到结果。没问题。请注意，在 6 月和 17 日之间有一个空格

但是，当我在我的 PHP 中收到该查询时，即 $q=June 17 我使用

```
$url="http://127.0.0.1:8096/solr/select/?q=$q&start=0&rows=8&indent=on&hl=on&hl.fl=Data&wt=json";
$json_O=json_decode(file_get_contents($url),true); 
```

在此之后，我在我的萤火虫上看到以下内容：

```
<b>Warning</b>:  file_get_contents(http://127.0.0.1:8096/solr/select/?q=june 17&amp;start=0&amp;rows=8&amp;indent=on&amp;hl=on&amp;hl.fl=Data&amp;wt=json) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: HTTP request failed! HTTP/1.1 505 HTTP Version Not Supported 
```

但是请注意，如果我的查询词之间没有空格（我的意思是如果它是一个词），那么一切都是完美的。

为什么当我在浏览器上发出与 file_get_contents() 完全相同的查询时它可以正常工作。任何解决方案将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T16:49:19.537

`q`参数值中有一个空格。可能是这样。尝试`urlencode()`输入参数。

```
$url="http://127.0.0.1:8096/solr/select/?q=".urlencode($q)."&start=0&rows=8&indent=on&hl=on&hl.fl=Data&wt=json";

$json_O=json_decode(file_get_contents($url),true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T16:51:39.910

这是因为该`file_get_contents`函数通过 HTTP 向 Web 服务器发送请求，如下所示

```
GET /solr/select/?q=bla HTTP/1.0
Host: 127.0.0.1
...[more headers here]... 
```

`HTTP/1.0`请注意，在请求 ( )中指定了 HTTP 版本

现在，如果您的请求字符串中有空格，您可以发送类似

```
GET /solr/select/?q=bla foo HTTP/1.0
Host: 127.0.0.1
...[more headers here]... 
```

您的服务器似乎解析`foo`为版本并返回`505 HTTP Version Not Supported`。如果您对字符串中的空格进行编码（例如，将其替换为`%20`，则不会发生这种情况）。

# haskell - 为什么编译器不解析函数内的隐式约束类型变量？

> ID：10365513
> 
> 赞同：1
> 
> 时间：2012-04-28T16:43:28.530
> 
> 标签：haskell

这是代码：

```
class Problem p where
    readProblem :: String -> p
    solveProblem :: p -> String

readAndSolve = solveProblem . readProblem 
```

这是 GHC 产生的错误消息：

```
Ambiguous type variable `b0' in the constraint:
  (Problem b0) arising from a use of `readProblem'
Probable fix: add a type signature that fixes these type variable(s)
In the second argument of `(.)', namely `readProblem'
In the expression: solveProblem . readProblem
In an equation for `readAndSolve':
    readAndSolve = solveProblem . readProblem 
```

据我了解，我必须以某种方式告诉编译器and`Problem`使用的实例是同一类型，但我看不出有什么方法可以声明它。为什么它不能自己弄清楚呢？`solveProblem``readProblem`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T16:49:17.087

你不需要告诉编译器它必须是相同的类型，编译器会自己计算出来。但是，它无法确定使用*哪种*类型。该问题的典型著名示例是

```
foo = show . read 
```

如果`foo`有一个合法的类型，那将是

```
foo :: (Read a, Show a) => String -> String 
```

现在，编译器如何确定一个？

你`readAndSolve`会有那种类型

```
readAndSolve :: Problem p => String -> String 
```

# struts2 - Struts 2 List 访问列表

> ID：10365516
> 
> 赞同：1
> 
> 时间：2012-04-28T16:43:57.747
> 
> 标签：struts2, struts, struts-html

我想知道是否有人可以提供帮助。

背景架构：

我有一个应用程序，其中包含许多具有许多特定问题的领域，这些问题不断发展

因此，在高级视图中可以有许多应用程序。一个用户可能与许多应用程序相关联。

所以我有一个应用程序列表，我可以很容易地遍历并获取其相关详细信息。但是，当涉及到访问每个特定区域以获取问题进度时，出于某种原因，这对我来说并不奏效。

所以这是我想要的逻辑：

> 对于应用程序
> 
> > 显示其详细信息
> > 
> > > 每个区域（applicaitonId）
> > > 
> > > > 显示每个完成进度

所以要翻译成struts我有这个

```
<s:iterator id="app" value="appList" status="row">
<s:iterator id="qsp" value="questionProgessList[%{#row.index}]" status="status"> 
```

`applist`所有具有自己的 getter/setter && 的应用程序的列表也是如此，其`questionSetProgress`定义如下：

```
List<ApplicationQuestionSetProgress> getQuestionProgressList(final int index) 
```

或列表> getQuestionProgressList()

因此，尝试以多种方式访问​​该列表已被证明是徒劳的，我尝试过：

```
<s:iterator id="qsp" value="questionProgessList">
    <s:property />
</s:iterator> 
```

有了这个：

```
List<List<ApplicationQuestionSetProgress>> getQuestionProgressList() 
```

但没有快乐

我也尝试过使用迭代器索引来调用该方法，但它不起作用。

```
List<ApplicationQuestionSetProgress> getQuestionProgressList(final int index) 
```

IE

`<s:iterator id="qsp" value="questionProgessList[%{#row.index}]" status="status"> or <s:iterator id="qsp" value="questionProgessList(%{#row.index})" status="status">`

任何提示或提示？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T20:44:18.643

您提到了以下方法：

```
List<List<ApplicationQuestionSetProgress>> getQuestionProgressList() 
```

但是您提到该操作需要获取“应用程序”列表，其中每个“应用程序”在其属性中包含一个“区域”列表。

因此，我将命名该方法：

```
List Applications getApplications(){
  return this.applications;
} 
```

提取所有属性的 JSP 形式为：

```
<s:iterator value="applications">
   <s:property value=applicationsProperty1"/>
   <s:property value="applicationsProperty2"/>
   ...
   <s:iterator value="areas">
      <s:property value="areasProperty1"/>
      <s:property value="areasProperty2"/>
      ...
      <s:iterator value="progress">
         <s:property value="progressProperty1"/>
         <s:property value="progressProperty2"/>
         ...
      </s:iterator>
   </s:iterator>
</s:iterator> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:36:05.713

考虑到你有类似的东西

```
List<ApplicationQuestionSetProgress> getQuestionProgressList(final int index) 
```

用这个

```
<s:iterator var="qsp" value="questionProgessList[#row.index]" status="status"> 
```

# java - Determining the point of OutOfMemory Error

> ID：10365518
> 
> 赞同：1
> 
> 时间：2012-04-28T16:44:20.183
> 
> 标签：java, memory-management

In Java, is it possible to accurately find the point at which `java.lang.OutOfMemoryError` occurred?

I am looking to better understand exactly how much memory did my application took a claim to before failing

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T16:54:26.443

you could catch the OutOfMemoryError and ask the runtime as shown below.

```
try {
    //...
} catch (OutOfMemoryError er) {
    // this will tell you how much you have used
    long heapSize = Runtime.getRuntime().totalMemory();
    System.err.println("memory used "+heapSize);
} 
```

(an OutOfMemoryError should occur when the heap runs out of memory)

if you have no idea where in your code it will fail, you could try register a shutdown hook and output the heapSize there.

# php - 错误 - 选项指令禁止的目录索引？

> ID：10365520
> 
> 赞同：9
> 
> 时间：2012-04-28T16:44:45.500
> 
> 标签：php, apache, webserver, http-status-code-403

我整个学期都在这台服务器上工作并且没有更改任何配置选项 - 我几周前创建的目录/文件仍然可以访问，但是任何新目录，甚至是旧工作目录的完全相同的副本都不允许我访问它们 - 得到错误“选项指令禁止的目录索引”。这是什么原因造成的？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-28T16:53:13.640

看起来有人在 Apache 中禁用了目录列表。如果允许您使用 .htaccess 覆盖它，只需在您的 Web 根目录中放置一个 .htaccess 文件，其中包含以下信息：

```
Options +Indexes 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T15:40:09.583

对我来说，这是一个问题，不仅仅是在文件夹中有 index.html 或 index.php（取决于 .htaccess 文件中的内容）文件并试图提取其内容。然后我再次使用 php 来读取内容，而不是像我假设的那样通过命令行。如果您仍然没有找到解决方案，请尝试在您无法从中提取内容的目录中创建一个 index.(php,html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-10T19:23:17.947

对我来说，帮助的是，通过 httpd.conf 文件中的解释并确保我符合要求。以下评论有帮助：

```
 # The path to the end user account 'public_html' directory must be
 # accessible to the webserver userid.  This usually means that ~userid
 # must have permissions of 711, ~userid/public_html must have permissions
 # of 755, and documents contained therein must be world-readable.
 # Otherwise, the client will only receive a "403 Forbidden" message. 
```

我试图移动文档根目录，但我没有设置正确的权限..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T12:33:17.390

对我来说，在 Wordpress 工作。错误是禁止访问 wp-admin。我用 Options +Indexes 内容创建了 .htaccess。

谢谢你。

# r - 如何从聚合结果中查找字段名称

> ID：10365521
> 
> 赞同：0
> 
> 时间：2012-04-28T16:44:51.723
> 
> 标签：r, dataframe

我正在尝试根据该数据框的最大聚合值来查找该数据框的索引或名称，例如：

```
df <- data.frame(
        id = 1:6, 
        v1 = c(3, 20, 34, 23, 23, 56),
        v2 = c(1, 3, 4, 10, 30, 40),
        v3 = c(20, 35, 60, 60, 70, 80))

  id v1 v2 v3  
1  1  3  1 20  
2  2 20  3 35  
3  3 34  4 60  
4  4 23 10 60  
5  5 23 30 70  
6  6 56 40 80  

> colSums(as.data.frame(df[[1]]))  
df[[1]]  
     21   

> colSums(as.data.frame(df[[2]]))  
df[[2]]   
    159   

> colSums(as.data.frame(df[[3]]))  
df[[3]]   
     88 
```

因此，例如使用的最大结果`colSums`是 159，我试图弄清楚如何返回“ `df[[2]]`”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T16:58:57.503

首先，您可以`colSums`直接在您的`data.frame`

```
> colSums(df)
 id  v1  v2  v3 
 21 159  88 325 
```

子集也很容易

```
> df[which.max(colSums(df))]
  v3
1 20
2 35
3 60
4 60
5 70
6 80 
```

或者，如果您只想要索引，如第一行所示：

```
> which.max(colSums(df))
v3 
 4 
```

另请注意，如果您预计可能有多个列具有相同的最大总和，并且您想返回所有列，则可以使用`which(colSums(df) == max(colSums(df)))`而不是`which.max`，它只返回第一次出现。

# jquery - 使用 jQuery 添加页面加载器

> ID：10365523
> 
> 赞同：4
> 
> 时间：2012-04-28T16:45:09.497
> 
> 标签：jquery, pageload, page-loading-message

我需要一点帮助。我不知道从哪里开始。我需要在我的网站上添加一个页面加载器。我首先提交了一个表单，然后它使用 SimpleXML 调用带有 expedia 的外部 XML 表...加载需要一分钟，所以我想将图像加载器添加到此页面。但是我该怎么做呢？我在谷歌上看过，找不到任何有用的信息。

我需要它来显示加载器，直到加载完成页面。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-28T17:24:53.090

这有很多解决方案，但一个简单的解决方案是：

1-使用您的加载程序创建一个覆盖 DIV 并添加到 BODY；2-为隐藏此 DIV
的事件添加事件侦听器`window.load`。`document.ready`

```
// On the first line inside BODY tag
<script type="text/javascript">
    jQuery("body").prepend('<div id="preloader">Loading...</div>');
    jQuery(document).ready(function() {
        jQuery("#preloader").remove();
    });
</script> 
```

*（代码错别字已修复）*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T20:04:45.113

查看 spin.js [http://fgnass.github.com/spin.js/](http://fgnass.github.com/spin.js/)

```
var opts = {
lines: 13, // The number of lines to draw
length: 7, // The length of each line
width: 4, // The line thickness
radius: 10, // The radius of the inner circle
// Even more options available.... 
};
var target = document.getElementById('loading');
var spinner = new Spinner(opts).spin(target); 
```

一旦你的表格完成：

```
$("#loading").data('spinner').stop(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-10-11T10:46:37.090

此加载器 div 将在页面加载时显示加载图像。

```
$(window).load(function() {
  $(".pageloader").fadeOut("slow");
});
```

```
body {
  background: black;/* for this demo */
}

.pageloader {
  position: fixed;
  left: 0px;
  top: 0px;
  width: 100%;
  height: 100%;
  z-index: 9999;
  background: url('images/yourLoaderImage.gif') 50% 50% no-repeat rgb(249, 249, 249);
  opacity: .8;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<div class="pageloader"></div>
```

它完全适合我。

# jquery - JQuery 克隆图像从服务器重新加载

> ID：10365527
> 
> 赞同：1
> 
> 时间：2012-04-28T16:46:01.833
> 
> 标签：jquery

当我使用以下代码从页面克隆图像并附加到 div 时，它们会从服务器重新加载。这是预期的行为吗？我正在使用 FF 9。谢谢

```
var  modal = $('<div id="modal"></div>');
$('img').each(function(){
    $(this).clone().appendTo(modal);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T16:47:01.880

克隆图像时，您会创建一个新`<img>`标签，该标签的呈现方式与任何新`<img>`标签一样。`<img>`如果服务器没有为标签指向的图像指定任何缓存行为，大多数浏览器会在看到新标签时发出请求。

# java - NIO 约束级别究竟做了什么，它如何影响性能？

> ID：10365530
> 
> 赞同：4
> 
> 时间：2012-04-28T16:46:32.843
> 
> 标签：java, constraints, nio, netty

当我使用 Netty NIO 代码启动服务器时，我注意到来自 WebSphere (IBM) JDK 的以下输出。我将 Netty 3.4.0 FINAL 与 IBM JDK 一起用于 WebSphere 6.1。

> 使用自动检测的 NIO 约束级别：1（使用更好的 NIO 提供程序以获得更好的性能）

所以首先我很好奇约束级别到底是做什么的，我似乎找不到任何关于它的信息。其次，我认为我可以使用以下语句覆盖它：

```
-Djava.nio.channels.spi.constraintLevel=0 
```

什么是“更好的 NIO 提供者”是什么意思——是说我需要一个更好的 JVM——而不是我必须用于 WebSphere 的 IBM 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:17:12.833

Netty 基于 JVM 和操作系统，使用自己的算法构造了一个“约束级别”的参数。[您可以在 grepcode.com 上](http://grepcode.com/file/repo1.maven.org/maven2/io.netty/netty/3.4.0.Alpha1/org/jboss/netty/channel/socket/nio/NioProviderMetadata.java#NioProviderMetadata.detectConstraintLevelFromSystemProperties%28%29)找到该算法的源代码。根据该值，它决定如何启用某些功能。

如果算法返回一个非零值，那么您会收到该消息。

您*可以*使用您提到的系统属性覆盖它，但是您告诉 Netty，您最了解系统可以做什么，并且您最终可能会得到比您不理会它更差的性能。

# c# - 由于缺少命名空间，无法使用 Google Translate API

> ID：10365534
> 
> 赞同：0
> 
> 时间：2012-04-28T16:47:05.967
> 
> 标签：c#, google-translate

以下是我使用谷歌翻译的代码。我添加了一个 dll 作为参考：Google.Apis.Translate.V2
我还购买了 Google Translate API 密钥。

我有 5 个错误，因为我不知道我需要更多的 dll：这些对象不存在缺少命名空间：DataContractJsonSerializer、TranslationRootObject、TranslationRootObject

这些命名空间需要什么 dll 引用？

这是我的代码，没有我的 API 密钥：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net;
using System.IO;
using System.Web;

namespace Google_Translate
{
    public partial class Form1 : Form
    {
        static string apiKey = "";

        static string texttotranslate = "hello world";
        string text;
        static String apiUrl = "https://www.googleapis.com/language/translate/v2?key={0}&source={1}&target={2}&q={3}";
            static String url = String.Format(apiUrl, apiKey, "en", "ge", texttotranslate);
            Stream outputStream = null;

        byte[] bytes = Encoding.ASCII.GetBytes(url);

        // create the http web request
        HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create(url);

        public Form1()
        {
            InitializeComponent();

            webRequest.KeepAlive = true;
            webRequest.Method = "POST";
            // Overrride the GET method as documented on Google's docu.
            webRequest.Headers.Add("X-HTTP-Method-Override: GET");
            webRequest.ContentType = "application/x-www-form-urlencoded";
            // send POST
            try
            {
                webRequest.ContentLength = bytes.Length;
                outputStream = webRequest.GetRequestStream();
                outputStream.Write(bytes, 0, bytes.Length);
                outputStream.Close();
            }
            catch (HttpListenerException e)
            {
                /*...*/
            }

            translate();
        }

        private void Form1_Load(object sender, EventArgs e)
        {

        }

        private string translate()
        {
             try
        {
            // get the response
            HttpWebResponse webResponse = (HttpWebResponse)webRequest.GetResponse();
            if (webResponse.StatusCode == HttpStatusCode.OK && webRequest != null)
            {
                // read response stream 
                using (StreamReader sr = new StreamReader(webResponse.GetResponseStream(), Encoding.UTF8))
                {
                    string lista = sr.ReadToEnd();

                    DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(TranslationRootObject));
                    MemoryStream stream = new MemoryStream(Encoding.UTF8.GetBytes(lista));
                    TranslationRootObject tRootObject = (TranslationRootObject)serializer.ReadObject(stream);
                    string previousTranslation = string.Empty;

                    //deserialize
                    for (int i = 0; i < tRootObject.Data.Detections.Count; i++)
                    {
                        string translatedText = tRootObject.Data.Detections[i].TranslatedText.ToString();
                        if (i == 0)
                        {
                            text = translatedText;
                        }
                        else
                        {
                            if (!text.Contains(translatedText))
                            {
                                text = text + " " + translatedText;
                            }
                        }
                    }
                    return text;
                }
            }
        }
        catch (HttpListenerException e)
        {
            /*...*/
        }

        return text;

        }
    }
} 
```

有人可以修复我的代码或告诉我有什么问题吗？

我需要的是翻译 29-33kb 的文本文件大小，我想知道在使用谷歌翻译网站时是否可以像在线翻译一样快。

我还发现这个链接[Google Translate V2 cannot hanlde large text translations from C#](https://stackoverflow.com/questions/9432422/google-translate-v2-cannot-hanlde-large-text-translations-from-c-sharp)有人说翻译不能翻译大文件，所以我想知道 29-33kb 的文件是否算大？如果是这样，也许有人可以查看链接并根据链接中的答案修复我的代码，我现在尝试了很多但并没有真正理解它。但首先我需要找出为什么我的原始代码在这里不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:21:46.623

在您的项目中，添加对此程序集的引用：

[http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx)

可能还有其他你需要的，我刚查了这个。

# visual-c++ - 图像处理中的并行计算？

> ID：10365535
> 
> 赞同：2
> 
> 时间：2012-04-28T16:47:06.277
> 
> 标签：visual-c++, image-processing, parallel-processing, gpu

谁能给我一些关于图像处理中并行计算的例子和简要说明（可以在 Nvdia GPU 上使用 CUDA 内核）？例如，关于像素，到目前为止，我的看法是图像可以分成更小的部分，并且可以将相同的过程应用于这些部分以构建整体目标，但除此之外还有更多吗？另外，在编程方面将如何实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T15:41:16.177

检查这个：[http ://supercomputingblog.com/cuda/intro-to-image-processing-with-cuda/](http://supercomputingblog.com/cuda/intro-to-image-processing-with-cuda/)

链接页面包含对您的问题的直接回答，以及用于快速入门的示例代码。

# wordpress - 如何在加载时强制浏览器显示

> ID：10365537
> 
> 赞同：0
> 
> 时间：2012-04-28T16:47:24.080
> 
> 标签：wordpress, progress, browser-refresh

我在 WordPress 中工作。我有几个站点以完全相同的方式设置（据我所知）。大多数行为都符合预期。但是，其中一些浏览器（所有类型）在页面完全加载之前不会显示首次加载或刷新的进度。它看起来是空闲的，然后是“BLINK”，它就是——满载。

表演很好，但直到最后都没有动静令人不安。标题非常干净，没有“onLoad”语句等，而且我在插件中没有看到任何会导致这种情况发生的脚本。

不确定“强迫”是否是解决方案，但我没有想法。我会在这一点上采取任何措施。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:09:56.147

如果您使用 PHP，请使用`flush()`，如果 ASP.NET 使用`Response.Flush()`. 但不能保证它们能正常工作，这[取决于浏览器](https://stackoverflow.com/questions/1810649/response-flush-only-works-with-firefox)是否会满足您的刷新请求。尝试改用 jQuery 和 ajax，它可以让你的应用看起来很活泼。

我在 2001 年尝试在 PHP 上刷新，我注意到 Mozilla 尊重我在长时间运行循环中放置的刷新请求，那时没有过多的浏览器，不像今天。并非所有浏览器都支持刷新请求

**更新**

我在 Chrome、Firefox 和 Safari 上试过，它们都支持刷新请求。如果它也能识别刷新，只需尝试 IE：

```
<table border="1">
   <th>Message</th>
   <% for(int i = 0; i < 1000; ++i) { %>
        <tr>
        <td>
        <%=i %> Hello<br>
        <% System.Threading.Thread.Sleep(500); %>
        <% Response.Flush(); %>
        </td>
        </tr>
    <% } %>
</table> 
```

# sql-server - sql 触发器在 8 个月后停止工作（未显示在分析器中）

> ID：10365539
> 
> 赞同：1
> 
> 时间：2012-04-28T16:47:32.970
> 
> 标签：sql-server, tsql, triggers

我有一个简单的插入触发器，上周停止工作。据我了解，权限没有改变。它目前已启用。我已经删除它并再次创建它，但它仍然不起作用。

**PROFILER**：触发器根本没有出现。好像从不火。过去 8 个月工作正常。

**值得**信赖的设置为真

**权限**：以所有者身份执行。

**变量**：无。

**触发代码：**

```
....
FOR INSERT 

INSERT INTO  maintable (cars,boats, price) 
SELECT  DISTINCT cars,boats,price from ledgertable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T15:39:57.107

如前所述，缺少应该触发此操作的代码使其变得困难。也许您`INSTEAD OF`的桌面上也有一个触发器，它阻碍了这个触发器的触发？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T15:48:55.527

触发器可以被禁用。尝试启用触发器，看看是否可以解决问题。

# matrix - 使用 DirectX 中的第一人称相机，物体看起来很奇怪

> ID：10365540
> 
> 赞同：0
> 
> 时间：2012-04-28T16:47:38.887
> 
> 标签：matrix, camera, directx

我在 DirectX 11 中创建 3D 第一人称相机时遇到问题。

我在 (0, 0, -2) 有一个摄像头，正在观察 (0, 0, 100)。(0, 0, 0) 处有一个框，并且该框被正确渲染。请看下面这张图片：

![在此处输入图像描述](../Images/0a0fc3b4c63fd78ed2206d609e565f43.png)

当盒子（不是相机）的位置发生变化时，它会被正确渲染。例如，下一张图片显示了 (1, 0, 0) 处的盒子，而相机仍然位于 (0, 0, -2) 处：

![在此处输入图像描述](../Images/fecfed364ca6af9f423bd7222353cd47.png)

但是，只要相机向左或向右移动，盒子就会向相反的方向移动，但它看起来却是扭曲的。这是一个示例，当相机位于 (1, 0, -2) 并注视 (1, 0, 100) 时。盒子仍然在 (0, 0, 0)：

![在此处输入图像描述](../Images/1dce5092c3fe13a99cd2034dee0e36e4.png)

这是我设置相机的方法：

```
// Set the world transformation matrix.

D3DXMATRIX rotationMatrix;          // A matrix to store the rotation information
D3DXMATRIX scalingMatrix;           // A matrix to store the scaling information
D3DXMATRIX translationMatrix;       // A matrix to store the translation information

D3DXMatrixIdentity(&translationMatrix);

// Make the scene being centered on the camera position.
D3DXMatrixTranslation(&translationMatrix, -camera.GetX(), -camera.GetY(), -camera.GetZ());

m_worldTransformationMatrix = translationMatrix;

// Set the view transformation matrix.

D3DXMatrixIdentity(&m_viewTransformationMatrix);

D3DXVECTOR3 cameraPosition(camera.GetX(), camera.GetY(), camera.GetZ());

// ------------------------
// Compute the lookAt position
// ------------------------

const FLOAT lookAtDistance = 100;

FLOAT lookAtXPosition = camera.GetX() + lookAtDistance * cos((FLOAT)D3DXToRadian(camera.GetXZAngle()));
FLOAT lookAtYPosition = camera.GetY() + lookAtDistance * sin((FLOAT)D3DXToRadian(camera.GetYZAngle()));
FLOAT lookAtZPosition = camera.GetZ() + lookAtDistance * (sin((FLOAT)D3DXToRadian(camera.GetXZAngle())) * cos((FLOAT)D3DXToRadian(camera.GetYZAngle())));

D3DXVECTOR3 lookAtPosition(lookAtXPosition, lookAtYPosition, lookAtZPosition);

D3DXVECTOR3 upDirection(0, 1, 0);

D3DXMatrixLookAtLH(&m_viewTransformationMatrix,
                   &cameraPosition,
                   &lookAtPosition,
                   &upDirection);

RECT windowDimensions = GetWindowDimensions();
FLOAT width = (FLOAT)(windowDimensions.right - windowDimensions.left);
FLOAT height = (FLOAT)(windowDimensions.bottom - windowDimensions.top);

// Set the projection matrix.

D3DXMatrixIdentity(&m_projectionMatrix);
D3DXMatrixPerspectiveFovLH(&m_projectionMatrix,
                           (FLOAT)(D3DXToRadian(45)),  // Horizontal field of view
                           width / height,    // Aspect ratio
                           1.0f,              // Near view-plane
                           100.0f);           // Far view-plane 
```

以下是最终矩阵的设置方式：

```
D3DXMATRIX finalMatrix = m_worldTransformationMatrix * m_viewTransformationMatrix * m_projectionMatrix;

// Set the new values for the constant buffer
mp_deviceContext->UpdateSubresource(mp_constantBuffer, 0, 0, &finalMatrix, 0, 0); 
```

最后，这是使用常量缓冲区的顶点着色器：

```
VOut VShader(float4 position : POSITION, float4 color : COLOR, float2 texcoord : TEXCOORD)
{
    VOut output;

    output.color = color;
output.texcoord = texcoord;
output.position = mul(position, finalMatrix);  // Transform the vertex from 3D to 2D

    return output;
} 
```

你看到我做错了吗？如果您需要有关我的代码的更多信息，请随时提出：我真的希望它能够正常工作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T08:42:18.377

The problem is you are setting *finalMatrix* with a row major matrix, but HLSL expects a column major matrix. The solution is to use D3DXMatrixTranspose before updating the constants, or declare row_major in the HLSL file like this:

```
cbuffer ConstantBuffer
{
    row_major float4x4 finalMatrix;
} 
```

# java - 在调试工具 Netbeans 中单击“停止”按钮时，多线程 Java 应用程序输出一个奇怪的结果

> ID：10365543
> 
> 赞同：2
> 
> 时间：2012-04-28T16:47:50.820
> 
> 标签：java, multithreading

我已经使用 wait() 和 notify() 机制了解了 java 中的多线程。但我对一个简单的多线程 java 应用程序的输出非常好奇。 *下面的代码：*

```
class Q {

    int n;
    boolean valueSet = false;

    synchronized int get() {
        if (!valueSet) {
            try {
                wait();
            } catch (InterruptedException e) {
                System.out.println("InterruptedException caught");
            }
        }
        System.out.println("Got: " + n);
        valueSet = false;
        notify();
        return n;
    }

    synchronized void put(int n) {
        if (valueSet) {
            try {
                wait();
            } catch (InterruptedException e) {
                System.out.println("InterruptedException caught");
            }
        }
        this.n = n;
        valueSet = true;
        System.out.println("Put: " + n);
        notify();
    }
}

class Producer implements Runnable {

    Q q;

    Producer(Q q) {
        this.q = q;
        new Thread(this, "Producer").start();
    }

    public void run() {
        int i = 0;
        while (true) {
            q.put(i++);
        }
    }
}

class Consumer implements Runnable {

    Q q;

    Consumer(Q q) {
        this.q = q;
        new Thread(this, "Consumer").start();
    }

    public void run() {
        while (true) {
            q.get();
        }
    }
}

class PCFixed {

    public static void main(String args[]) {
        Q q = new Q();
        new Producer(q);
        new Consumer(q);
        System.out.println("Press Control-C to stop.");
    }
} 
```

拳头，我运行该应用程序，然后单击调试工具中的“停止”按钮停止应用程序。这会产生两个“奇怪的输出”：这是第一次运行应用程序的输出：

![为什么我们有两个重复的输出行：***](../Images/d946899e82a0a4c6db48f04106eca02a.png)

![为什么我们有两个重复的输出行：***](../Images/83de1eaa2216f53bc31bfcffa86262f4.png) 这是应用程序第二次运行的输出：

为什么我们有两个***重复的输出行***：***“put：13177”***

为什么我们在另一个时间有两个***重复的输出行***：***“got: 2713” 。***

这个结果让我很困惑！！一些机构可以帮助我理解这个问题！感谢先进。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T23:03:14.717

该方法`Q.put(13177)`被调用两次。

# string - 使用 J2me 从 WML 页面获取数据

> ID：10365548
> 
> 赞同：2
> 
> 时间：2012-04-28T16:48:36.857
> 
> 标签：string, java-me, midp, lcdui

我在 j2me 中有一个从 wml/asp 页面获取字符串和数据的程序。
使用此代码：

```
HttpConnection con = (HttpConnection) Connector.open(
    "http://localhost:"+port+"/MobileWebWIthConnection/ShowCourseinsemester.aspx?StudentId="+ID+"&Year="+Year+"&Semester="+Semester);
DataInputStream in = new DataInputStrea(con.openInputStream());
int len = (int) con.getLength();
byte[] info = new byte[len];
in.readFully(info);
result = new String(info);

switchDisplayable(null, getStudentCourses());
stringItem2.setText(result); 
```

当我的 j2me 应用程序尝试从此页面读取和存储数据时：

```
"http://localhost:"+port+"/MobileWebWIthConnection/ShowCourseinsemester.aspx?StudentId="+ID+"&Year="+Year+"&Semester="+Semester 
```

放置在名为 (result) 的字符串中的文本与下面的预期图完全不同：

> ![页面调用](../Images/15ee3faeedd0c7f0b431b2fc9dccb2b5.png)

它采用不带格式的内容，如下所示：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

 <wml>
 <card>
 <p><b>Student Name :</b> Arin                 Rizk                </p>
 <p><b>Student ID</b> : 20111</p>
 <p>first Semester ,2011</p>
 1 - Course Name : DDD        | Credits Number : 3          | Mark : 70         </br>  2 - Course Name : EEE        | Credits Number : 3          | Mark : 65         </br>  3 - Course Name : EEE        | Credits Number : 3          | Mark : 65         </br>  4 - Course Name : EEE        | Credits Number : 3          | Mark : 90         </br>  
 </card>
 </wml> 
```

因此，当我将此文本分配给 StringItem 时，它在图中显示如下。

```
stringItem2.setText(result); 
```

![在此处输入图像描述](../Images/0a250d4303dbe1ff2d24c46f7f536e21.png)

如何让我的 j2me 将字符串视为原始格式化页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:18:13.870

我解决了，特别是在j2me中没有（拆分方法）有点棘手。

所以我创建了一个。

我清除了它

```
String[] split (String x){
        int num=0;
        for(int i=0; i<x.length(); i++)  // count the number of ','
            if(x.charAt(i)==',')
                num++;

        String[] r=new String[num];
        for(int i=0; i<num; i++)
        {
            int loc=x.indexOf(",");  //loc is the location of each ','
            r[i]=x.substring(0,loc);
            x=x.substring(loc+1);
        }
            return r;
        } 
```

然后我应用它并在列表中显示结果

```
HttpConnection con = (HttpConnection) Connector.open("http://localhost:"+port+"/MobileWebWIthConnection/ShowCourseinsemester.aspx?StudentId="+ID+"&Year="+Year+"&Semester="+Semester);
                            DataInputStream in = new DataInputStream(con.openInputStream());
                            int len = (int) con.getLength();
                            byte[] info = new byte[len];
                            in.read(info);
                            result = new String(info);                          
                            String[] a=split(result);
                    getList().deleteAll();
                    for(int i=1; i<a.length; i++)
                        getList().append(a[i], null);

                    switchDisplayable(null,getList()); 
```

在没有来自 wml 页面的完整源代码的情况下，结果与想要的一样（在行中）。

![在此处输入图像描述](../Images/fa8c6c88f18f5f21ce0c517d5478c087.png)

# performance - Apache 后面的 node.js 是否比 node.js HTTP-server 慢得多？

> ID：10365550
> 
> 赞同：3
> 
> 时间：2012-04-28T16:48:58.930
> 
> 标签：performance, apache, http, node.js

这比直接访问慢得多吗？

```
RewriteEngine On
RewriteRule (.*) http://localhost:23232/$1 [P] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T20:06:36.720

它不会慢很多。Apache 代理您的请求所需的时间与 Node.js 处理您的请求所需的时间相比，它的差异只有很小的一部分，这很可能甚至难以衡量。

但是，您可能希望使用[`ProxyPass`](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)and[`ProxyPassReverse`](http://httpd.apache.org/docs/2.2/mod/mod_proxy.html)而不是重写，以便 Apache 充当真正的代理。

# mysql - 子查询以收集具有限制的分组子集

> ID：10365553
> 
> 赞同：2
> 
> 时间：2012-04-28T16:49:19.083
> 
> 标签：mysql, subquery, limit

我试图找出一种无需循环 700,000 个 mysql 查询即可收集数据集的方法。

我有两张桌子

`users`和

```
id autoincrement, 
time timestamp, 
username varchar(200), 
email varchar(100), 
ip varchar(20) 
```

并`uniq_ip`与

```
ip unique varchar(20), 
most_recent datetime, 
count (int) 
```

`users`有 2500 万行并记录用户在网站上工作时的活动。`uniq_ip`有一个所有 IP 号码的列表以及它在用户中列出的次数（在触发器更新时）。

目前，在进行白日梦编码时，我会从中获取所有 IP 的列表`uniq_ip`并循环它们以获取每个 IP 的最新 2000 条记录。由于`uniq_ip`有 700,000 行，这个循环真的很讨厌，总共产生 700,000 个查询，使用

```
select * from users where ip = '$outerloopip' order by `time` desc limit 2000; 
```

我正在尝试获取一个查询，该查询将获取每个 IP 的最新 2000 个列表。如果 1.2.3.4 被列出 10,000 次，我只想要最近的 2000，基于时间字段。

任何想法如何在一个查询中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T01:06:19.130

对于以前的答案，我很抱歉，并重新阅读并应用了更新的查询。我错过了，并以为您只想要最近的 2000 个 IP 地址。无论如何，这会处理所有 IP 地址，并将每个 IP 的总记录限制为 2,000 个条目，最近的条目位于顶部。我会确保你有一个索引

(IP,时间 DESC)

然后，试试这个查询。我错过了澄清的关键事情。HAVING 子句在任何 group-by 或 order-by 子句之后应用。因此，数据按 IP 地址和日期/时间降序的正确顺序预先返回，然后应用 @sql 变量。一旦记录符合条件并准备好添加到最终结果集中，就会应用 HAVING 子句。在那一刻，它看着序列计数器并说……如果它大于 2000，就把它扔掉并继续下一条记录。

根据我最初的查询，它正在保存所有内容，然后第二次循环并踢出那些大于 2000 的内容，这可能就是它耗尽您的磁盘空间的原因。

```
select
      U.*,
      @LastSeq := IF( @LastIP = U.IP, @LastSeq +1, 1 ) as IPSequence,
      @LastIP := U.IP as carryForNextRecord
   from 
      ( select @LastIP := '', @LastSeq := 0 ) sqlvars,
      Users U
   order by
      U.IP,
      U.time DESC
   having 
      IPSequence <= 2000 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T13:20:25.920

```
SELECT ip as IP ,
     (SELECT GROUP_CONCAT(time)     FROM users WHERE ip = IP ORDER BY time DESC LIMIT 2000) as Time,
     (SELECT GROUP_CONCAT(username) FROM users WHERE ip = IP ORDER BY time DESC LIMIT 2000) as UserName,
     (SELECT GROUP_CONCAT(email)    FROM users WHERE ip = IP ORDER BY time DESC LIMIT 2000) as Email
FROM uniq_id 
```

# java - 在片段中开始活动

> ID：10365559
> 
> 赞同：0
> 
> 时间：2012-04-28T16:50:15.403
> 
> 标签：java, android, android-fragments, android-activity

我决定通过使用新的 Fragments API 创建双窗格布局，为我的应用程序添加更多对平板电脑友好的 UI。但问题是我的应用程序中的许多屏幕都是 Activity 子类。手动将它们全部转换为片段不是一种选择，因为：
- 有近 50 个活动。
- 我希望我的应用程序与从 1.6 开始的所有 Android 版本兼容
- 而且我希望它尽可能小，因此使用兼容性库不是一个选项，因为它太大了

尽管我发现[一些](https://stackoverflow.com/questions/6249031/start-activity-in-a-fragment) [问题](https://stackoverflow.com/questions/8510165/loading-activity-in-fragment-code)的答案是不可能的，但我几乎成功地做到了。这是我的自定义片段的代码：

```
public static class ActivityFragment extends Fragment{
    Intent intent;
    View view;
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        if(intent==null){
            Bundle a=getArguments();
            intent=a.getParcelable("intent");
        }
        LocalActivityManager am=((ActivityGroup)getActivity()).getLocalActivityManager();
        Window wnd=am.startActivity("intent"+intent.hashCode(), intent);
        if(view==null){
            view=wnd.getDecorView();
            view.setLayoutParams(new FrameLayout.LayoutParams(LinearLayout.LayoutParams.FILL_PARENT, LinearLayout.LayoutParams.FILL_PARENT));
        }
        return view;
    }

    public void onDestroy(){
        super.onDestroy();
        if(!((TabletMainActivity)getActivity()).tabs.containsValue(this)){
            ((ActivityGroup)getActivity()).getLocalActivityManager().destroyActivity("intent"+intent.hashCode(), true);
        }
    }
} 
```

为了工作，它只能在 ActivityGroup 中使用。唯一的问题是，在某些具有 ListView 方法的活动中，onItemClick() 在活动恢复后不会被调用，即我单击一个项目，另一个活动从当前开始，但是当我返回时，项目不再可单击。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T13:50:31.000

通过比较 onResume 前后所有 ListView 的字段值，我终于找到了解决方案。而解决这个问题的方法是调用`notifyDataSetInvalidated()`列表适配器上的方法。

# java - 是否可以在 Spring 中注入带有参数的方法？

> ID：10365560
> 
> 赞同：4
> 
> 时间：2012-04-28T16:50:25.357
> 
> 标签：java, spring, methods, arguments, inject

来自文档：

> 在包含要注入的方法的客户端类（本例中为 CommandManager）中，要“注入”的方法必须具有以下形式的签名：

```
<public|protected> [abstract] <return-type> theMethodName(no-arguments); 
```

是否存在解决此限制的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:02:30.243

是的你可以。这是来自 spring 文档的示例，[http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html)

```
 @Autowired
 public void prepare(MovieCatalog movieCatalog,
                   CustomerPreferenceDao customerPreferenceDao) {
   this.movieCatalog = movieCatalog;
   this.customerPreferenceDao = customerPreferenceDao;
 } 
```

# qt - 是否可以使用模型/视图/委托设计模式在 Qt 中搭建整个 UI？

> ID：10365563
> 
> 赞同：0
> 
> 时间：2012-04-28T16:50:32.797
> 
> 标签：qt, qt4, qt-creator, qt-designer

我正在阅读最新版本的 Qt，似乎模型/视图/（委托）模式正在被推动。应该可以想象在不编写单个模型的情况下完全连接视图，至少为了指定它的外观。这是建议的方法吗？

另外，事件接线应该放在哪里？我假设信号是由 MainWindow 代码协调的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T23:13:21.527

当然，您将需要使用现有 Qt 模型类制作的虚拟模型。查看空视图有些无益，因为您无法检查底层模型的主要代表。在没有任何数据的情况下，您可以签出的唯一代表是标题 IIRC 中使用的代表。

除了提供与视图交互的编程方式外，在事物的视图方面没有事件“连线”。模型可能需要大量交互，具体取决于建模的内容

从概念上讲，您可能只有一个模型来表示应用程序中的数据，但是将该模型的各个方面公开给专门的视图会是很多意大利面。然后，您可以将视图模型用作适配器：它们会采用大模型并公开它的目标部分，从而更容易被视图使用。这是 .net WPF 中广泛使用的模式。

# jquery - 使用 jQuery 搜索表或搜索 Backbone.js 集合并创建一个新表

> ID：10365564
> 
> 赞同：2
> 
> 时间：2012-04-28T16:50:35.840
> 
> 标签：jquery, backbone.js, full-text-search

我有一个使用backbone.js 创建表的页面。每个表行都是一个主干视图。这些视图都有一个模型，这些模型都在主干集合中。基本的东西。

假设我想通过这个大约有 800 行的表进行搜索。我在这里有两个选择。

1.  我可以使用其中一个 jQuery 插件来搜索完整的表格，并隐藏与我的搜索条件不匹配的行。这很好用，非常基本。

但由于我使用主干创建页面，我正在考虑一种新方法。

1.  我现在可以破坏页面上的表格。`find`集合中的元素，并创建这些视图。

方法 1 更改 DOM 元素，并通过 DOM 进行搜索。

方法 2 销毁并创建 DOM 元素（和主干视图），并通过 JS 对象（主干模型）进行搜索。

--

**问题**：你更喜欢哪一个，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T05:31:56.573

一般来说，我会说通过 Backbone 集合进行搜索。如果您使用 Backbone，您可以免费获得 Underscore 的所有功能，因此请使用它而不是 jQuery 来对您的数据执行搜索。到目前为止，您还不清楚您所说的内容，确切地说是您要做什么，因此如果您想要一个更具体的示例来说明该做什么，则需要更具体地说明这一点。

# ruby-on-rails - 这种导轨模型的最佳选择是什么？

> ID：10365565
> 
> 赞同：0
> 
> 时间：2012-04-28T16:50:52.767
> 
> 标签：ruby-on-rails, model, controller

我有一个模型叫`User`，另一个叫`Run`。每个用户都有很多次运行。持续时间和距离是跑步的属性。

我想在用户页面上显示他跑步的距离和持续时间的总和。

我不确定这个总和，即总距离和总持续时间是否应该是用户的属性，或者是否应该计算`ViewProfileController`它以便在他的个人资料上显示它。

正确的做法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T16:53:20.363

用户运行的总和应该是用户模型中的一个方法，因为它特定于每个用户。

此外，最佳实践是拥有瘦控制器和胖模型。

# ios - 如何显示一个窗口？

> ID：10365568
> 
> 赞同：0
> 
> 时间：2012-04-28T16:50:56.993
> 
> 标签：ios

我正在学习 iPhone 开发，在我的应用程序中我有一些视图，但我应该使用一个窗口，所以我想在 IBaction 中调用一个窗口我如何调用一个窗口？我尝试将示例与 AppDelegate 一起使用，您可以看到我的代码：

```
- (IBAction)start:(id)sender {
self.window = [[[Game1ViewController alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];
[self.window makeKeyAndVisible];
} 
```

Game1ViewController 是 UIWindow 类型。

此致

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:08:41.430

我相信你的应用程序只有一个窗口。在此之上，您放置不同的视图。这些可以是 UIView 的子类。这些可以由 UIViewController 控制。通常在 UINavigationController、UITabController、Master/detail 之间有某种设计风格决定了应用程序的结构。

如果您打开 Xcode 并从他们的模板之一开始，例如 master/detail，您可以看到视图之间的转换以及如何使一个出现/消失以及视图和视图控制器之间的交互。

# php - 从 IMDB 获取电影费率表

> ID：10365569
> 
> 赞同：0
> 
> 时间：2012-04-28T16:50:57.633
> 
> 标签：php, regex

我需要从 IMDB form image alt 获取电影评分表

```
<img width="44" height="15" title="PG_13" class="absmiddle" src="http://i.media-imdb.com/images/SF9c87441dc1ac3081c7de5a78d8864764/certificates/us/pg_13.png" **alt="PG_13"**> 
```

**我的代码（错误）：**

```
$arr['rate'] = $this->match('/<img class=\"absmiddle\" src=\"\(.*?)\" alt=\"\(.*?)">/ms', $html, 1); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T16:56:31.263

```
$text = '<img width="44" height="15" title="PG_13" class="absmiddle" src="http://i.media-imdb.com/images/SF9c87441dc1ac3081c7de5a78d8864764/certificates/us/pg_13.png" alt="PG_13">';
preg_match('<img[^<]+class="absmiddle" src="([^"]+)" alt="([^"]+)"/i', $text, $a);
$src = $a[1];
$alt = $a[2]; 
```

# winforms - Windows 窗体应用程序 (visual studio 2010) 兼容性问题

> ID：10365570
> 
> 赞同：0
> 
> 时间：2012-04-28T16:51:01.317
> 
> 标签：winforms, visual-studio-2010, c++-cli, clr

我的任务是制作一个连接到互联网（使用 Wininet）并下载文本文件的简单应用程序。然后它在 listBox 小部件中显示数据。要求是制作基于 GUI 的应用程序，因此我在 Visual Studio Express 2010 中使用了 Windows 窗体。

该应用程序在我的 PC 上运行良好，但我意识到它只能在我的 PC 上运行。我在另一台 PC 上安装了 .Net 4 和 Visual Studio 2010 可再发行组件，它在那里运行良好。现在，我为之做这个的人希望在 Windows PC 上具有最大的兼容性。我完全被困在这里..我应该切换到旧版本的 VSE 吗？

从我可以搜索的内容来看，使用 /MT 而不是 /MD 会导致应用程序静态链接，但是我的应用程序也使用 /CLR 并且这些是不兼容的。

有任何想法吗？

注意：我之前用控制台输出制作了一个类似的应用程序（下载和显示），它在任何地方都可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:03:31.070

**我遇到过你的情况。**

我可以给你我的免费 .NET-application-runner (RunNetApp.exe)，它会在第一次运行你的应用程序之前自动安装 .NET Framework 4。如果框架已经安装在目标机器上，它只会运行你的应用程序。

我还建议将应用程序的框架更改为“.NET Framework 4 Client Profile”。它的设置大约是 40MB（与 200MB 的完整“.NET 框架 4”相比）。

有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T16:57:18.377

取决于“Windows PC 上的最大兼容性”的含义。如果您可以捆绑所需的可再发行组件，您的程序应该运行（正如您在第二台 PC 上找到的那样），只要 PC 上的 Windows 能够执行二进制文件（例如，不是 32 位 PC 试图执行 64 位二进制文​​件）

# java - NoSuchBeanDefinitionException：没有定义名为 ...DriverManagerDataSource 的 bean

> ID：10365572
> 
> 赞同：1
> 
> 时间：2012-04-28T16:51:14.127
> 
> 标签：java, spring

启动 SpringMVC 时收到以下异常...

```
Apr 28, 2012 5:47:26 PM org.apache.catalina.core.ApplicationContext log
SEVERE: StandardWrapper.Throwable
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/spring/appServlet/servlet-context.xml]: Cannot resolve reference to bean 'org.springframework.jdbc.datasource.DriverManagerDataSource' while setting bean property 'dataSource'; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'org.springframework.jdbc.datasource.DriverManagerDataSource' is defined
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1360)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1118)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:567)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)
    at javax.servlet.GenericServlet.init(GenericServlet.java:160)
    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1185)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1080)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5015)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1566)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722)
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'org.springframework.jdbc.datasource.DriverManagerDataSource' is defined
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:529)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1095)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:277)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:197)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:269)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322)
    ... 32 more 
```

我已将以下内容添加到我的 pom.xml 中...

```
<dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jdbc</artifactId>
            <version>${org.springframework-version}</version>
        </dependency>

<org.springframework-version>3.1.0.RELEASE</org.springframework-version> 
```

servlet-context xml文件如下...

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <!-- DispatcherServlet Context: defines this servlet's request-processing 
        infrastructure -->

    <!-- Enables the Spring MVC @Controller programming model -->
    <annotation-driven />

    <!-- Handles HTTP GET requests for /resources/** by efficiently serving 
        up static resources in the ${webappRoot}/resources directory -->
    <resources mapping="/resources/**" location="/resources/" />

    <!-- Resolves views selected for rendering by @Controllers to .jsp resources 
        in the /WEB-INF/views directory -->
    <beans:bean
        class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <beans:property name="prefix" value="/WEB-INF/views/" />
        <beans:property name="suffix" value=".jsp" />
    </beans:bean>

     <beans:bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <beans:property name="annotatedClasses">
        <beans:list>
            <beans:value>org.assessme.com.entity.User</beans:value>
        </beans:list>
    </beans:property>
        <beans:property name="dataSource" ref="org.springframework.jdbc.datasource.DriverManagerDataSource" />
        <beans:property name="packagesToScan" value="data" />
        <beans:property name="hibernateProperties">
            <beans:props>
                <beans:prop key="hibernate.dialect">org.hibernate.dialect.H2Dialect</beans:prop>
                <beans:prop key="hibernate.current_session_context_class">thread</beans:prop>
                <beans:prop key="hibernate.transaction.factory_class">org.hibernate.transaction.JDBCTransactionFactory</beans:prop>
                <beans:prop key="hibernate.show_sql">true</beans:prop>
                <beans:prop key="hibernate.hbm2ddl.auto">update</beans:prop>
            </beans:props>
        </beans:property>
    </beans:bean>

    <context:component-scan base-package="org.assessme.com" />

    <beans:bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
        <beans:property name="mediaTypes">
            <beans:map>
                <beans:entry key="html" value="text/html" />
                <beans:entry key="json" value="application/json" />
            </beans:map>
        </beans:property>
        <beans:property name="defaultViews">
            <beans:list>
                <beans:bean
                    class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
                    <beans:property name="prefixJson" value="true" />
                </beans:bean>
            </beans:list>
        </beans:property>
    </beans:bean>

</beans:beans> 
```

有没有人有任何想法？

谢谢，

大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T16:57:13.420

您缺少对 DataSoure 的引用。

您的整个 xml 文件应如下所示：

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
  <property name="driverClassName" value="com.mysql.jdbc.Driver" />
  <property name="url" value="jdbc:mysql://localhost:3306/xxx" />
  <property name="username" value="xxx" />
  <property name="password" value="xxx" />
</bean>

<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="dataSource" ref="dataSource"/>
    <property name="hibernateProperties">
 <props>
    <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop> 
    <prop key="hibernate.show_sql">true</prop> 
    <prop key="hibernate.hbm2ddl.auto">update</prop> 
    <prop key="hibernate.show_sql">true</prop> 
  </props>
     </property>
        <property name="annotatedClasses">
      <list>
        <value>x.y.z.Student</value>        
         </list>
    </property>
  </bean>

<bean id="transactionManager" 
            class="org.springframework.orm.hibernate3.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory"/>
  </bean> 
```

# javascript - 谷歌扩展 - 页面加载后调用 SendRequest

> ID：10365573
> 
> 赞同：0
> 
> 时间：2012-04-28T16:51:18.273
> 
> 标签：javascript, google-chrome-extension

我目前正在开发一个谷歌扩展程序，它假设在加载页面时执行多个任务，并在客户端按下更新按钮时调用后台脚本方法。

我必须使用后台脚本的原因是我需要将信息发送到不同的服务器并实际上绕过跨源策略。

此外，我正在使用“chrome.extension.sendRequest”进行各种操作 - 第一个实例在页面加载时启动并且工作正常。当我在页面加载后第二次尝试调用“sendRequest”时，我被卡住了。它说：未捕获的类型错误：无法调用未定义的方法'sendRequest'

有谁知道我如何调用后台脚本并在页面加载后使用它？

ps，我没有使用任何 GUI 和 html 页面 - 只有 js。

# backbone.js - 在 Backbone.js 应用程序中设置全局 REST 根 URL

> ID：10365574
> 
> 赞同：8
> 
> 时间：2012-04-28T16:51:30.477
> 
> 标签：backbone.js

在backbone.js 中，您必须手动设置每个模型的rooturl。有没有办法我们可以将它设置在一个位置一次并且所有模型都会使用它？

例如。`api.site.com`将是 REST 服务，但出于测试目的，`localhost:1000`我可能需要能够轻松更改服务的根 url，而不是在应用程序中存在的许多模型中到处都有它们。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-20T16:05:52.827

在将 Backbone 与 AMD (require.js) 一起使用时，我一直在尝试最优雅的方式来做到这一点。这就是我想出的，并且最喜欢[到目前为止]。

首先，将数据引导到其中，如此[处](https://stackoverflow.com/questions/9916073/how-to-load-bootstrapped-models-in-backbone-js-while-using-amd-require-js/10288587#10288587)所述。

**index.htm（应用程序入口点）**

```
<!DOCTYPE html>
<head>
  <meta charset="utf-8">

  <script>
    var require = {
      config: {
        // key name is module, value is data to give module
        'models/Base': {
          apiUrl: '/some/path/to/api',
        }
      }
    }
  </script>
<script data-main="js/main" src="vendor/require/require-jquery.js"></script>
</head>
<body></body>
</html> 
```

接下来，为 Backbone 模型定义一个基类，如下所示：

**js/models/Base.js （注意这个模块名称与上面配置中的模块名称匹配）**

```
define(['module', 'backbone'],
  function(module, Backbone){

    return Backbone.Model.extend({
      getApiUrl: function(){
        return module.config().apiUrl;
      }
    });

  }
); 
```

最后，从该基础扩展所有 Backbone 模型，如下所示：

**js/models/User.js**

```
define(['models/Base'],
  function(BaseModel){

    return BaseModel.extend({
      urlRoot: function(){
        return this.getApiUrl() + '/user';
      }
      // ... more cool stuff here
    });

  }
); 
```

这与[我之前提出的](https://stackoverflow.com/questions/14882836/best-practice-for-shared-objects-in-backbone-require-application)关于 Backbone 和 Require.JS 的问题有密切关系。

相关阅读：[http ://requirejs.org/docs/api.html#config-moduleconfig](http://requirejs.org/docs/api.html#config-moduleconfig)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-14T11:19:37.413

我的理解是：

您有几个模型：model1 和 model2

根 URL 可以是`http://api.site.com`或`http://localhost:8080`取决于您是在本地工作还是在外部工作。有一天它可能是`http://api.anothersite.com`

那么我会做这样的事情：

```
// Global var before any other JS code, you comment line depending on which one applies
var ROOT = 'http://api.site.com'
// var ROOT = 'http://localhost:8080'

var Model1 = Backbone.Model.extend({
urlRoot: ROOT+'/model1',
...
});

var Model2 = Backbone.Model.extend({
urlRoot: ROOT+'/model2',
...
}); 
```

但是请注意这一点，您可能会在提交时忘记从一个 url 切换到另一个。如果它们适用，更好的是处理相对路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-22T11:39:37.543

在我看来，实现这一目标的最佳方法是覆盖该`Backbone.sync`方法，并在其中添加您的根 url。这是因为模型不负责了解 API 域。

```
// Cache Backbone.sync for later use
var sync = Backbone.sync;
Backbone.sync = function(method, model, options){
  options.beforeSend = function(){
    this.url = API_ROOT_URL + this.url;
  };
  return sync.call(this, method, model, options);
}; 
```

然后您可以像往常一样创建模型：

```
var Resource = Backbone.Model.extend({
  urlRoot: '/resources',
}); 
```

我使用相同的方法将扩展附加`.json`到所有 URL，以防止 JSON 通过浏览器缓存闪烁。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-01-26T21:18:16.253

改编自[https://coderwall.com/p/8ldaqw/add-a-root-url-to-all-backbone-api-request](https://coderwall.com/p/8ldaqw/add-a-root-url-to-all-backbone-api-request)

```
var backboneSync = Backbone.sync;

Backbone.sync = function (method, model, options) {
    /*
     * Change the `url` property of options to begin
     * with the URL from settings
     * This works because the options object gets sent as
     * the jQuery ajax options, which includes the `url` property
     */
    options = _.extend(options, {
        url: API_ROOT + _.result(model, 'url')
    });

    /*
     *  Call the stored original Backbone.sync
     * method with the new url property
     */
    backboneSync(method, model, options);
}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-28T21:42:28.843

不确定`urlRoot`手动为每个模型设置的确切含义。大概你会

```
var MyModel = Backbone.Model.extend({

  urlRoot: '/mymodel',
  ...

}); 
```

正确的？那么每个模型实例自然都有相同`urlRoot`的。说的任何其他模型实例`MyOtherModel`都会有一些不同`urlRoot`。

如果由于某种原因您需要使用相同的`urlRoot`，我猜这是因为模型共享属性。这应该暗示继承或扩展，所以你可以这样做：

```
var BaseModel = Backbone.Model.extend({
  urlRoot: '/mymodel'
});

var MyModel = BaseModel.extend({
  ...
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-05T21:08:05.187

只需从**'/'**开始您的网址。因此，您将不依赖于本地主机或真实域。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-08T16:17:38.583

这是一个很老的帖子，但我认为我的版本可能对某人有用。我将骨干网与 require.js 一起使用，并且我的服务器端和客户端完全分开。当我声明 requirejs 脚本时，我会同时告知客户端应用程序的 API 根在哪里：

```
<script 
     data-main="js/main" 
     data-api-url="https://api/v1/" 
     src="js/require.js">
</script> 
```

然后我进入我的主干模块：

```
var $scriptEl = $('script[data-main]'),
      base = $scriptEl.attr('data-api-url');

var BaseModel = Backbone.Model.extend({
    urlRoot: base
});

var model = BaseModel.extend({}); 
```

这是我能找到的最优雅的方式..

# git - 防止 git submodule update 删除子模块提交的更改

> ID：10365579
> 
> 赞同：1
> 
> 时间：2012-04-28T16:52:06.573
> 
> 标签：git, git-submodules

这似乎是一个常见问题，但我找不到合理的解决方案：
恕我直言，[git 子模块](http://schacon.github.com/git/user-manual.html#submodules)更糟糕的问题是子模块提交但未推送的更改很容易被包含的存储库使用删除`git submodule update`。报价：

> 如果您在子模块中进行并提交更改而没有先检查分支，则运行 git submodule update 是不安全的。它们将被静默覆盖：

（...后面是一个例子）。

因此，对于这个问题 -
让我们`super`成为存储库根文件夹并`submod`成为包含子模块的子文件夹：

```
-super   
     -submod 
```

当我在子模块中提交但不推送，然后运行时，我在子模块中`git submodule update`提交*的*更改**被删除**（哦，恐怖）。
执行此操作时如何添加确认`are you sure`问题？钩子、脚本或任何其他适用的想法更受欢迎。

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T16:55:46.870

pre-submodule-update 没有挂钩，因此您可能需要做的是编写一个您使用的脚本而*不是*`git submodule update`.

查看是否有任何修改的子模块的简单方法是：

```
if git submodule status | grep -q '^+'; then
    # at least one submodule has changes
fi 
```

另请注意，如果意外更新破坏了您的更改，您仍然可以通过子模块签出的 reflog 来挽救它们（因为子模块签出本身就是完整的 Git 存储库）。

# http - 第三方 cookie 如何知道用户访问了哪些站点？

> ID：10365581
> 
> 赞同：0
> 
> 时间：2012-04-28T16:52:31.053
> 
> 标签：http, cookies

我对“第三方cookies”进行了快速搜索。据我所知，cookie 只能由浏览器通过 HTTP 请求发送回它自己的域（和路径）。

例如，我正在访问包含来自广告网站 B 的图像的网站 A。我的浏览器看到图像的 url 并向网站 B 发出对该图像的 HTTP 请求。网站 B 获取该 HTTP 请求并设置HTTP 响应“Set-Cookie: user=arandomstring”中的 cookie。我的浏览器现在包含来自网站 A 的 cookie 和来自网站 B 的名为“用户”的 cookie。下次当我去另一个网站 C 时，该网站也包含来自同一广告网站 B 的图像，网站 B 只会得到自己设置的“用户”cookie。我对吗？网站 B 如何知道我访问了哪些网站（网站 A）以显示他的定制广告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:48:21.663

最简单和最常见的方法是将有关请求所针对的站点的信息作为参数传递，例如`<img src="http://server-b.com/img.jpg?server=A">`

另一种解决方案是从“Referer”标头中获取此信息。但是，此方法不适用于每个访问者，因为在大多数浏览器中都可以禁用此标头。

# c# - 如何在 WPF 中实现使用祖先方法的命令？

> ID：10365582
> 
> 赞同：7
> 
> 时间：2012-04-28T16:52:51.847
> 
> 标签：c#, wpf, xaml

我有这个上下文菜单资源：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <ContextMenu x:Key="FooContextMenu">
        <ContextMenu.CommandBindings>
            <CommandBinding Command="Help" Executed="{Binding ElementName=MainTabs, Path=HelpExecuted}" />
        </ContextMenu.CommandBindings>

        <MenuItem Command="Help">
            <MenuItem.Icon>
                <Image Source="../Resources/Icons/Help.png" Stretch="None" />
            </MenuItem.Icon>
        </MenuItem>
    </ContextMenu>
</ResourceDictionary> 
```

我想在两个地方重复使用它。首先，我试图把它放在一个`DataGrid`：

```
<DataGrid ContextMenu="{DynamicResource FooContextMenu}">... 
```

`ContextMenu`本身工作正常，但`Executed="..."`我现在有打破应用程序并抛出：

> PresentationFramework.dll 中出现“System.InvalidCastException”类型的第一次机会异常
> 
> 附加信息：无法将“System.Reflection.RuntimeEventInfo”类型的对象转换为“System.Reflection.MethodInfo”类型。

如果我删除整个`Executed="..."`定义，那么代码就可以工作（并且命令什么都不做/变灰）。只要我右键单击网格/打开上下文菜单，就会引发异常。

被`DataGrid`放置在几个元素下，但最终它们都位于已设置为 s 集合的`TabControl`(称为) 之下，并且我有一个我想要被调用的方法。`MainTabs``ItemsSource``FooViewModel``FooViewModel``HelpExecuted`

让我们形象化：

*   选项卡控件 ( `ItemsSource=ObservableCollection<FooViewModel>`, `x:Name=MainTabs`)
    *   网格
        *   更多用户界面
            *   DataGrid（带有上下文菜单集）

为什么会出现此错误，如何使上下文菜单命令“定位” `FooViewModel`'s`HelpExecuted`方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-30T20:49:53.720

不幸的是，您不能`Executed`为 a绑定，`ContextMenu`因为它是一个事件。另一个问题是，在您的应用程序的其余部分`ContextMenu`不存在。`VisualTree`这两个问题都有解决方案。

首先，您可以使用`Tag`父控件的属性`ContextMenu`来传递`DataContext`您的应用程序。然后你可以使用`DelegateCommand`你的，然后就`CommandBinding`可以了。这是一个显示 的小示例`View`，`ViewModel`以及`DelegateCommand`您必须添加到项目中的实现。

**委托命令.cs**

```
public class DelegateCommand : ICommand
{
    private readonly Action<object> execute;
    private readonly Predicate<object> canExecute;

    public DelegateCommand(Action<object> execute)
        : this(execute, null)
    { }

    public DelegateCommand(Action<object> execute, Predicate<object> canExecute)
    {
        if (execute == null)
            throw new ArgumentNullException("execute");

        this.execute = execute;
        this.canExecute = canExecute;
    }

    #region ICommand Members

    [DebuggerStepThrough]
    public bool CanExecute(object parameter)
    {
        return canExecute == null ? true : canExecute(parameter);
    }

    public event EventHandler CanExecuteChanged
    {
        add { CommandManager.RequerySuggested += value; }
        remove { CommandManager.RequerySuggested -= value; }
    }

    public void Execute(object parameter)
    {
        execute(parameter);
    }

    #endregion
} 
```

**MainWindowView.xaml**

```
<Window x:Class="Application.MainWindowView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindowView" Height="300" Width="300"
        x:Name="MainWindow">
    <Window.Resources>
        <ResourceDictionary>
            <ContextMenu x:Key="FooContextMenu">
                <MenuItem Header="Help" Command="{Binding PlacementTarget.Tag.HelpExecuted, RelativeSource={RelativeSource AncestorType=ContextMenu}}" />
            </ContextMenu>
        </ResourceDictionary>
    </Window.Resources>
    <Grid>
        <TabControl ItemsSource="{Binding FooViewModels}" x:Name="MainTabs">
            <TabControl.ContentTemplate>
                <DataTemplate>
                    <DataGrid ContextMenu="{DynamicResource FooContextMenu}" Tag="{Binding}" />
                </DataTemplate>
            </TabControl.ContentTemplate>
        </TabControl>
    </Grid>
</Window> 
```

**MainWindowView.xaml.cs**

```
public partial class MainWindowView : Window
{
    public MainWindowView()
    {
        InitializeComponent();
        DataContext = new MainWindowViewModel();
    }
} 
```

**MainWindowViewModel.cs**

```
public class MainWindowViewModel
{
    public ObservableCollection<FooViewModel> FooViewModels { get; set; }

    public MainWindowViewModel()
    {
        FooViewModels = new ObservableCollection<FooViewModel>();
    }
} 
```

**FooViewModel.cs**

```
public class FooViewModel
{
    public ICommand HelpExecuted { get; set; }

    public FooViewModel()
    {
        HelpExecuted = new DelegateCommand(ShowHelp);
    }

    private void ShowHelp(object obj)
    {
        // Yay!
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-30T20:17:31.297

这有帮助吗？

```
<ContextMenu>
    <ContextMenu.ItemContainerStyle>
       <Style TargetType="MenuItem">
          <Setter Property="Command" Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type TabItem}}, Path=HelpExecuted}" />
       </Style>
    </ContextMenu.ItemContainerStyle>
    <MenuItem Header="Help" />
</ContextMenu> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-30T21:05:38.570

恐怕MatthiasG 打败了我。我的解决方案类似：

此处的帮助命令由选项卡项的视图模型处理。如果需要，将 TestViewModel 的引用传递给每个 TestItemViewModel 并让 ShowHelp 回调到 TestViewModel 会很简单。

```
public class TestViewModel
{
    public TestViewModel()
    {
        Items = new List<TestItemViewModel>{ 
                    new TestItemViewModel(), new TestItemViewModel() };
    }

    public ICommand HelpCommand { get; private set; }

    public IList<TestItemViewModel> Items { get; private set; }
}

public class TestItemViewModel
{
    public TestItemViewModel()
    {
        // Expression Blend ActionCommand
        HelpCommand = new ActionCommand(ShowHelp);
        Header = "header";
    }

    public ICommand HelpCommand { get; private set; }

    public string Header { get; private set; }

    private void ShowHelp()
    {
        Debug.WriteLine("Help item");
    }
} 
```

xml

```
<Window.Resources>
    <ContextMenu x:Key="FooMenu">
        <MenuItem Header="Help" Command="{Binding HelpCommand}"/>
    </ContextMenu>
    <DataTemplate x:Key="ItemTemplate">
        <!-- context menu on header -->
        <TextBlock Text="{Binding Header}" ContextMenu="{StaticResource FooMenu}"/>
    </DataTemplate>
    <DataTemplate x:Key="ContentTemplate">
        <Grid Background="#FFE5E5E5">
            <!-- context menu on data grid -->
            <DataGrid ContextMenu="{StaticResource FooMenu}"/>
        </Grid>
    </DataTemplate>
</Window.Resources>

<Window.DataContext>
    <WpfApplication2:TestViewModel/>
</Window.DataContext>

<Grid>
    <TabControl 
        ItemsSource="{Binding Items}" 
        ItemTemplate="{StaticResource ItemTemplate}" 
        ContentTemplate="{StaticResource ContentTemplate}" />
</Grid> 
```

替代视图模型，以便将帮助命令定向到根视图模型

```
public class TestViewModel
{
    public TestViewModel()
    {
        var command = new ActionCommand(ShowHelp);

        Items = new List<TestItemViewModel>
                    {
                        new TestItemViewModel(command), 
                        new TestItemViewModel(command)
                    };
    }

    public IList<TestItemViewModel> Items { get; private set; }

    private void ShowHelp()
    {
        Debug.WriteLine("Help root");
    }
}

public class TestItemViewModel
{
    public TestItemViewModel(ICommand helpCommand)
    {
        HelpCommand = helpCommand;
        Header = "header";
    }

    public ICommand HelpCommand { get; private set; }

    public string Header { get; private set; }
} 
```

ActionCommand 的一个非常简单的实现

```
public class ActionCommand : ICommand
{
    private readonly Action _action;

    public ActionCommand(Action action)
    {
        if (action == null)
        {
            throw new ArgumentNullException("action");
        }

        _action = action;
    }

    public bool CanExecute(object parameter)
    {
        return true;
    }

    public void Execute(object parameter)
    {
        _action();
    }

    // not used
    public event EventHandler CanExecuteChanged;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-30T20:49:49.310

您收到此错误是因为 CommandBinding.Executed 不是依赖属性，因此您无法绑定到它。

相反，使用后面的 ResourceDictionary 代码为 CommandBinding.Executed 事件指定事件处理程序，并在事件处理程序代码中调用 FooViewModel.HelpExecuted() 方法，如下所示：

**MainWindowResourceDictionary.xaml**

```
<ResourceDictionary x:Class="WpfApplication.MainWindowResourceDictionary" 
                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:WpfApplication">

    <DataTemplate DataType="{x:Type local:FooViewModel}">
        <Grid>
            <DataGrid ContextMenu="{DynamicResource FooContextMenu}"/>
        </Grid>
    </DataTemplate>

    <ContextMenu x:Key="FooContextMenu">
        <ContextMenu.CommandBindings>
            <CommandBinding Command="Help" Executed="HelpExecuted"/>
        </ContextMenu.CommandBindings>
        <MenuItem Command="Help"/>
    </ContextMenu>

</ResourceDictionary> 
```

**MainWindowResourceDictionary.xaml.cs**

```
public partial class MainWindowResourceDictionary : ResourceDictionary
{
    public MainWindowResourceDictionary()
    {
        InitializeComponent();
    }

    private void HelpExecuted(object sender, ExecutedRoutedEventArgs e)
    {
        var fooViewModel = (FooViewModel)((FrameworkElement)e.Source).DataContext;
        fooViewModel.HelpExecuted();
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-07T20:38:09.817

可以创建一个适配器类，它可以配置为 XAML 中的资源，可以附加到控件以便在那里创建 CommandBindings，并且在另一端可以绑定到 ViewModel 中的方法，当命令由 Button 或 MenuItem 触发。在这种情况下，命令将是 RoutedCommand，无论您是选择预定义的 WPF 命令之一还是在应用程序中创建自定义 RoutedCommand，都没有关系。

绑定到方法的技巧是

*   使适配器成为 Freezable，因此可以使用当前 DataContext 作为绑定源，
*   给它一个 Delegate 类型或其子类型之一的 DependencyProperty，并且
*   使用一个转换器，它接受方法名称作为 ConverterParameter 并检查绑定源类型，以便为应该由命令调用的方法创建一个委托。

虽然这听起来很复杂，但好处是一旦您将框架的各个部分组合在一起，您就可以只在 XAML 中简单地重用它们，并且在 ViewModel 或后面的代码中根本不会有任何胶水代码。

你可以想象，这需要一些基础设施，而且代码比我想在这里发布的要多。不过，我刚刚在我的博客上发表了一篇关于这个主题的文章，[http://wpfglue.wordpress.com/2012/05/07/commanding-binding-controls-to-methods/](http://wpfglue.wordpress.com/2012/05/07/commanding-binding-controls-to-methods/)，通过博客你可以下载框架的完整源代码和 VB.Net 中的示例。

应用于您的问题，XAML 将如下所示：

在 ContextMenu 的定义中：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<ContextMenu x:Key="FooContextMenu">
    <!-- No CommandBindings needed here -->
    <MenuItem Command="Help">
        <MenuItem.Icon>
            <Image Source="../Resources/Icons/Help.png" Stretch="None" />
        </MenuItem.Icon>
    </MenuItem>
</ContextMenu>
</ResourceDictionary> 
```

并且在DataGrid的定义中

```
<DataGrid c:Commanding.CommandSet="{DynamicResource helpCommand}">
    <DataGrid.Resources>
        <f:ActionConverter x:Key="actionConverter"/>
        <c:ActionCommand x:Key="helpCommand" Command="Help" ExecutedAction="{Binding Converter={StaticResource actionConverter}, ConverterParameter=HelpExecuted}"/>
<!-- DataGrid definition continued... --> 
```

# c# - 唯一标识符策略

> ID：10365589
> 
> 赞同：0
> 
> 时间：2012-04-28T16:53:45.387
> 
> 标签：c#, nhibernate, int, guid

我将使用带有 nhibernate orm 层的 c# 和 mssql 数据库，并且我试图找出在生产中使用哪种方法更快。

据我所知，Guids 占用的空间是 ints 占用 16 对 4 个字节的空间的 4 倍。

数据同步会很频繁。这是一个敏感的话题，因为糟糕的方法会导致大量内存消耗。使用整数可以导致更快的响应，但每次数据插入都必须命中数据库才能从序列中获取值。

那么，我应该在 mssql 内部使用带有标识的整数方法，还是在 nhibernate 映射中使用 HiLo 生成器作为标识列？

我是否会遇到使用指南的性能问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:50:15.303

比较 32 位数据类型（4 字节 int）与比较 128 位数据类型（guid）之间的性能可能非常小。我没有任何数字，最大的因素是 128 位数据类型将占用多个寄存器，而不是较小的数据类型。由于我们正在转向 64 位架构，因此在比较时，guid 将采用两个寄存器而不是一个。

尽管如此，我更愿意根据问题的要求使用可维护的策略，而不是尝试优化 32 位或 128 位标识符。

由于您声明其中一个要求是同步数据库，因此首选 guid 而不是递增的 int。如果您使用增量 int，您基本上需要确保在插入之前增量 int 没有在另一个数据库中“采用”。

当然，您可以为此制定一些策略，例如每个客户端仅在范围的特定子集中生成，但这已经通过使用 guid 覆盖。由于它的大小和创建方式，每个客户端都可以创建一个 guid，并且它被其他人复制的可能性很小。

所以，换个说法，我建议**使用 Guid**

# php - 如何从数组中获取特定元素

> ID：10365590
> 
> 赞同：-4
> 
> 时间：2012-04-28T16:54:21.500
> 
> 标签：php

我从运行 php 代码中得到以下输出，现在我想从下面的数组中获取“url”字段，我怎样才能得到这个？

```
Array (
    [data] => Array (
        [0] => Array (
            [id] => xxxxx
            [from] => Array (
                [id] => xxxxxx
                [name] => abc
            )
            [start_time] => 2012-04-28T07:49:17+0000
            [end_time] => 2012-04-28T07:49:17+0000
            [publish_time] => 2012-04-28T07:49:17+0000
            [application] => Array (
                [id] => 389407107765872
                [name] => Ki News Social Reader
            )
            [data] => Array (
                [article] => Array (
                    [id] => 10150703062718596
                    [url] => http://example.com
                    [type] => kinewssocialreader:article
                    [title] => story
                )
            ) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T16:59:51.173

像任何其他数组一样索引它。查看其实际来源`print_r`可能比将其全部串在一行中更有帮助。

```
$arr['data'][0]['data']['article']['url'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:02:22.400

```
$url=$myArray['data'][0]['data']['article']['url']; //assuming $myArray is array 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:01:36.303

假设我正在正确读取数据结构，它将是：

```
$variableName['data'][0]['data']['article']['url'] 
```

其中*$variableName*是顶级数组的名称。括号不平衡，所以我不能 100% 确定结构。

我已经画出结构看起来像这样。如果这与您的结构匹配，则上面的命名将起作用。

```
Array ( 
  [data] => Array ( 
    [0] => Array ( 
      [id] => xxxxx 
      [from] => Array ( 
        [id] => xxxxxx 
        [name] => abc 
      ) 
      [start_time] => 2012-04-28T07:49:17+0000 
      [end_time] => 2012-04-28T07:49:17+0000 
      [publish_time] => 2012-04-28T07:49:17+0000 
      [application] => Array ( 
        [id] => 389407107765872 
        [name] => Ki News Social Reader 
      ) 
      [data] => Array ( 
        [article] => Array ( 
          [id] => 10150703062718596 
          [url] => http://example.com 
          [type] => kinewssocialreader:article [title] => story
        ) 
      )
    )
  )
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T16:59:21.250

用这个

```
$array['data'][0]['data']['article']['url'] 
```

如果您的数组变量称为 $array.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T17:01:34.620

如果要使用其键访问数组：

```
$array["key_name"] , $array[$key_name] 
```

如果要使用元素顺序访问数组：

```
$array[0], $array[1] 
```

如果选择的结果是数组，可以继续使用 [] 深入：

假设 $array["key"] 包含一个数组，并且该数组具有“another_key”键值；

```
$array["key"]["another_key"] 
```

也会起作用。

# ruby - Mac OSX上的Ruby执行两个目录之间巨大而奇怪的时间差异

> ID：10365594
> 
> 赞同：0
> 
> 时间：2012-04-28T16:54:45.577
> 
> 标签：ruby, macos

我在 Mac OS X 上遇到了一个非常奇怪的情况。这已经在两台 Mac（Macbook 和 Mac Mini Server）上复制了。

本质上，我在两个不同的目录中运行相同的、相同的 ruby​​ 代码。在第一个目录中，我的执行时间为 7 秒，在第二个目录中为 0.191。两者绝对没有区别。

```
gspider@b1-3 ~£ time ruby  sb2.rb 
#<struct recno=2001, name="Amazon", ticker="MPS", tradeprice=185.5, tradedate="2012-04-        28", quantity=45, totalposition=8347.5> 
```

# 

```
real    0m7.775s
user    0m7.160s
sys 0m0.612s

 gspider@b1-3 ~/Sites£ time ruby sb2.rb
 #<struct recno=2001, name="Amazon", ticker="MPS", tradeprice=185.5, tradedate="2012-04-       28", quantity=45, totalposition=8347.5> 
```

# 

```
real    0m0.191s
user    0m0.164s
 sys    0m0.023s 
```

但还有更多。即使是获取不存在文件的简单 ruby​​ 脚本在两个目录中的行为也不同：请注意，它使用的是相同的 ruby​​ 版本

```
gspider@b1-3 ~£ time ruby sb3.rb
/Users/spider/.rvm/gems/ruby-1.9.3-p125/gems/KirbyBase-2.6.1/lib/kirbybase.rb:520:in      `get_table': Table not found! (RuntimeError)
from sb3.rb:8:in `<main>'

real    0m7.885s
user    0m7.240s
sys 0m0.642s

gspider@b1-3 ~/Sites£ time ruby  sb3.rb
/Users/spider/.rvm/gems/ruby-1.9.3-p125/gems/KirbyBase-2.6.1/lib/kirbybase.rb:520:in    `get_table': Table not found! (RuntimeError)
from sb3.rb:8:in `<main>'

real    0m0.183s
user    0m0.156s
sys 0m0.023s 
```

这种高度不稳定的行为可能是什么原因？这又是同一台机器，您可以从 bash 标记中看到只有 2 个不同的目录。我已经能够在另一台 Mac 上复制相同的错误，但是“受感染的”路径/目录不同，所以看起来有些目录/路径随机地得到了这个红宝石缓慢延迟执行诅咒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T22:52:12.620

KirkyBase 打开文件夹中的所有表（.tbl 文件）。

如果您在某个文件夹中有更多更大的文件，而在另一个文件夹中有更少或更小的文件，这可能会解释时间上的差异。

# java - 编写并发代码，非阻塞代码

> ID：10365597
> 
> 赞同：2
> 
> 时间：2012-04-28T16:54:56.760
> 
> 标签：java, concurrency

无论 SO 和其他网站上的其他问题问“*我如何编写并发代码？* ”，答案总是涉及非常模糊的解释，例如“*检查数据依赖关系*”或代码内部的“*相互依赖关系”。*我想知道这些神秘的依赖项实际上是什么样的 Java 代码！？！

*   一段代码的具体示例可以很容易地并行化，因为它的一部分不依赖于另一部分？
*   由于存在这些依赖关系，一段代码*必须是串行的具体示例是什么？*
*   这些依赖关系的存在如何影响是否使用线程池的决定？

我想我只是没有在这里看到“树林中的森林”。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:00:45.603

下面是一些简单的例子：

1.无依赖，易于并行化：

```
 int[] array = new int[size];
 for(int i = 0; i < size; i++) {
     array[i] = array[i] * array[i];
 } 
```

每个项目都是独立计算的。

2.对上一次迭代的依赖：

```
 int[] array = new int[size];
 for(int i = 1; i < size; i++) {
     array[i] = array[i - 1] * 2 + array[i];
 } 
```

`array[3]`除非你有，否则你无法计算`array[2]`（也许在某些情况下，你可以推导出一个允许重组的公式，但你明白了）。

线程池的使用与依赖关系的存在或不存在真正相关。这些概念是正交的。线程池只是回收线程的一种有效方式，线程通常是系统中昂贵的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:01:38.013

假设您想编写一个银行账户对象并且您想维护一个不变量——货币永远不会由于对银行账户的操作而神奇地创建或销毁。

你可能会写

```
int balance;

void deposit(int amount) {
  if (amount < 0) { throw ... }
  long after = balance + amount;
  if (after > Integer.MAX_VALUE) { throw ... }
  // DANGER 1
  balance = (int) after;
}

void withdraw(int amount) {
  if (amount < 0 || amount > balance) { throw ... }
  // DANGER 2
  balance -= amount;
} 
```

考虑当一个线程在任一 DANGER 评论处暂停并同时发生另一次存款或取款时会发生什么。

如果一笔存款开始并在危险 1 处暂停，然后发生另一笔存款，然后第一笔存款结束，则存款可能会丢失，从而破坏价值。

如果一次提款开始，在 DANGER 2 处暂停，然后发生存款，然后提款结束，则提款可能会使余额变为负数。

如果存款开始，在 DANGER 1 处暂停，然后发生提款，然后存款结束，则可以创建货币。

* * *

解决这个问题的标准方法是说，计算`after`值和分配的代码`balance = (int) after`是一个关键部分，并且必须在没有对其任何依赖项进行任何干预更改的情况下发生：`balance`.

类似地，安全检查`withdrawal`和`-=`操作形成一个关键部分——`-=`如果检查仍然不正确，则操作不应发生。

为了获得额外的乐趣，请考虑可能发生的事情，因为`a -= b`实际上有几个声明：

```
int x = b;
int y = a;
a = y - x; 
```

这些都必须一起发生才能有意义，因此`a -= b`具有标准含义取决于它的依赖关系`a`，而`b`不是在操作中间发生变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T18:06:39.857

> 一段代码的具体示例可以很容易地并行化，因为它的一部分不依赖于另一部分？

并发应用程序建立在`tasks`. 您可以将 a 标识`task`为任何*离散的工作单元*。如果您可以识别出作为离散工作单元并具有明确*任务边界*`Runnable`的代码部分，您可以为每个任务创建s 并以单独的方式运行它以`Thread`实现并行性。实际上 a`Runnable`代表`Task`抽象。
一个示例是需要加载多个文件进行处理的进程。文件的加载是一个独立的工作单元，可以由线程在后台完成，不会阻塞代码流

> 由于存在这些依赖关系，一段代码必须是串行的具体示例是什么？

如果`Task 2`依赖于`Task 1`then的计算/处理`Task 2`必须*等待*完成`Task 1`，从而序列化序列。
一个例子是在后台加载一个文件，**然后**在文件中搜索一个键

> 这些依赖关系的存在如何影响是否使用线程池的决定？

他们没有。创建 a`Thread`是一项昂贵的操作，并且`Thread Pools`是重用线程的构造设计，以避免创建新线程的开销。在 中，您`Thread Pool`只需传递s 并负责将 分配给线程或在需要时创建新线程。您还可以通过线程池等定义策略。但它们是并发程序的工具。您应该已经确定了要提交到线程池执行的任务。`Tasks``Runnable``Thread Pool``Task`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T17:01:57.190

一个没有依赖关系的简单示例是遍历集合的任何循环，对每个项目执行相同的工作（*映射*操作，在 FP 中）。确实存在依赖关系的一个典型示例是具有大量 db 提取的业务逻辑，基于它们的决策，然后进一步提取，所有这些都在嵌套的 ifs 中——大量数据处理，但每一步都取决于上一步的结果。

# java - 如何在android服务中获取url/网站的响应时间？

> ID：10365605
> 
> 赞同：0
> 
> 时间：2012-04-28T16:55:57.597
> 
> 标签：java, android, http, service

我正在开发一个应用程序来检查网站是否响应。我也想知道特定网址的响应时间。

我使用 webviewclient 来获取响应代码。

但我想在服务中实现它，webviewclient 不能在服务中使用。我希望这仅在 services 而不是在 activity 中完成。请帮忙。

任何使用 http 来了解响应代码的 java 代码、url 的响应时间都会有所帮助。提前致谢：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:19:43.763

您可以使用[HttpClient](http://hc.apache.org/httpclient-3.x/tutorial.html)，这是一个随 Android 库一起提供的 Apache Commons 类。此类可用于发送和接收异步请求。您可以将其与服务或异步任务一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:25:14.923

看看谷歌代码上的项目“httpmon”，

> [http://code.google.com/p/httpmon/](http://code.google.com/p/httpmon/)

它有点粗糙，但它是您正在寻找的完整版本。也在play store上，

> [https://play.google.com/store/apps/details?id=org.jtb.httpmon&hl=en](https://play.google.com/store/apps/details?id=org.jtb.httpmon&hl=en)

披露：这是我的应用程序，但它是免费和开源的。

# module - 使用其他类型的变量列表定义类型

> ID：10365606
> 
> 赞同：1
> 
> 时间：2012-04-28T16:56:01.863
> 
> 标签：module, functional-programming, ocaml, functor

我想编写一个模块（在 Ocaml 3.12 中）能够将 Variant 类型定义为现有不同类型的聚合

它可以是 0 到 N 种类型，所以是一个变量列表或集合

它可能看起来像这样：

```
type newtype = Type0 of type0 | Type1 of type1 | ... | TypeN of typeN 
```

当然我想分解它的创造

首先，我尝试创建一个由仿函数参数化的模块“复合”：

```
module Composite ( T0 : sig type t end ) ( T1 : sig type t end ) = 
struct
  type t = T0.t | T1.t
end 
```

第一个困难：如何将一个可变的函子列表传递给“复合”模块？

这是进行的好方法吗？

**edit1** : Variant 允许定义 XOR 类型定义（它是 T0 或 T1 但不是两者）；如何定义 OR 类型定义（可以是 T0 或 T1 或两者）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T08:12:35.327

If want a "flat" composite type and get the union of constructors, the only way is to use polymorphic variants (as stated by @lukstafi in the comments), but in this case t1 and t2 cannot be abstract:

```
type t1 = [ `A of int | `B of string | `C of float ]
type t2 = [ `B of string | `C of float | `D of char ]
type t3 = [ t1 | t2 ] 
```

If you really want to use modules you have to loose your flat representation and thus you will have a disjoint union:

```
module Composite ( T0 : sig type t end ) ( T1 : sig type t end ) = 
struct
  type t = T0 of T0.t | T1 of T1.t
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T08:55:40.583

我认为静态类型系统不允许你想要什么。静态类型系统试图帮助您避免因在某些函数中使用不正确类型而导致的错误。但是在这里，您试图定义一种具有*未知**number* 变体的类型。这在 OCAML 中不受支持。

出于同样的原因，不支持异构列表和元素数量未知的元组。

对于您的第二个问题：对象不能属于“T1 和 T2”类型，其中 T1 和 T2 是未知类型......这个概念与类型检查不兼容。如果 T1 和 T2 是兼容类型，即 T2 是从 T1 继承的对象类型，或者 T2 是作为 T1 扩展的多态变体类型，那么你可以拥有 T1 类型的对象，也可以将 T2 强制转换为 T1 . 但是仍然没有“T1和T2”的概念。如果你有一个只接受 T1 的函数，如果给定一个类型为“T1 和 T2”但不仅仅是“T1”的对象，这个函数应该怎么做？我认为没有答案。

尽管 OCAML 不支持这些东西，但您可能可以以不同的方式设计您的类型，以便 OCAML 的类型系统接受您的代码。OCAML 的类型系统非常灵活，它可以帮助您避免代码中的错误！

# c# - 在 C# 中同时使用图形对象时出错？

> ID：10365609
> 
> 赞同：2
> 
> 时间：2012-04-28T16:56:36.583
> 
> 标签：c#, windows, gdi+, system.drawing

我正在创建一个具有相同形式的两个对象的游戏，需要每隔几秒单独重绘一次（用于动画）。我在一个单独的线程上有一个。他们时不时地产生一个错误，说明图形对象已在使用中。由于我在同一个表单上构造了 2 个图形对象，因此该错误出现的频率较低：

```
Graphics sprite1 = this.CreateGraphics();
Graphics sprite2 = this.CreateGraphics(); 
```

然后我将这些对象传递给适当的方法。我害怕这可能是一个非常糟糕的做法。任何解决此问题的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T18:00:02.730

是的，你有问题。您看到的实际错误来自 GDI+ 中的代码，该代码确保不能在多个线程中使用相同的 Graphics 对象。然而，这是一个更深层次的问题，您正在创建一个直接引用窗口的 Graphics 对象。底层的 Windows 对象是一个 HDC，一个设备上下文的句柄。设备上下文不是线程安全的。事故是偶尔的绘画伪影、死锁和访问冲突。

您*可以*使 FromImage() 图像创建的 Graphics 对象工作，只要它们是从不同的位图创建的，或者您确保两个线程不会尝试同时使用相同的 Graphics 对象。这在游戏编程中不会非常有用。

您可以通过创建具有 32bppPArgb 像素格式的位图来制作快速绘制的精灵。在大多数机器上，它们的绘图速度比任何其他格式快十倍。就您可以使用普通 GDI+ 推动它而言，下一步是使用图形库，该图形库使用驻留在视频内存中的位图并使用 GPU 硬件。此类库的流行托管包装器是 XNA、SlimDX 和 SharpDX。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T17:11:12.480

通常游戏不是多线程的，而是有一个游戏循环。每次迭代时，所有对象的位置都会根据当前时间重新计算。然后重新绘制它们。

您可以考虑以多线程方式进行计算；然而，所有的绘图都应该发生在游戏循环内的主线程（所谓的 UI 线程）中。

* * *

请参阅Wikipedia 上的[游戏编程](http://en.wikipedia.org/wiki/Game_programming)中的“游戏结构”一章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T18:35:15.540

如上所述，`this.CreateGraphics()`实际上是创建对同一个图形对象的引用，也就是整个表单本身。除了线程问题，您“可以”在代码中（理论上）通过确保您的绘图不会超出预定义的绘图区域来代表您的不同屏幕来处理这个问题。这将涉及一些硬编码，这不是我的风格或偏好。

恕我直言，更好的方法是在内存中创建两个 Image 对象......

```
 Image screen1 = new Bitmap(100, 100); // (width, height)
    Image screen2 = new Bitmap(100, 100); // (width, height) 
```

然后你可以分别在每个图像表面上绘制，并使用像图像查看器这样简单的东西来保存每个“视图”......

```
 private void DrawGame()
    {
        DrawSprite1(Graphics.FromImage(screen1));
        DrawSprite2(Graphics.FromImage(screen2));
    }
    public void DrawSprite1(Graphics g)
    {
        g.FillEllipse(Pens.Blue, screen1.GetBounds());
    }
    public void DrawSprite2(Graphics g)
    {
        g.FillRect(Brushes.Red, screen2.GetBounds());
    } 
```

显然，这不是解决这个问题的唯一方法，但应该作为指导来激励你找到自己的解决方案。:)

# objective-c - 在视图控制器之间切换

> ID：10365610
> 
> 赞同：0
> 
> 时间：2012-04-28T16:56:50.430
> 
> 标签：objective-c, ios, cocoa-touch, uiviewcontroller

我想以编程方式从一个视图控制器切换到另一个。我使用以下代码：

```
SenderPlayerViewController *myViewController = [[SenderPlayerViewController alloc] init];
[self.navigationController pushViewController:myViewController animated:YES]; 
```

但我得到一个黑屏，而我已经在`SenderPlayerViewController`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:02:53.163

您是否尝试使用 nib 文件进行实例化？如果是这样，您必须使用[`initWithNibName:bundle:`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)

```
SenderPlayerViewController *myViewController = [[SenderPlayerViewController alloc] initWithNibName:@"SenderPlayerViewController" bundle:nil]; 
```

同样对于故事板，在控制器类上调用 alloc init 是不够的。

它应该是这样的

```
UIViewController *viewController = [[UIStoryboard storyboardWithName:@"MainStoryboard" bundle:NULL] instantiateViewControllerWithIdentifier:@"SenderPlayerViewController"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:31:12.840

如果您使用情节提要中的视图控制器，则应使用

```
SenderPlayerViewController *myViewController=[storyboard instantiateViewControllerWithIdentifier:@"TheNameOfYourController"] 
```

而不是分配初始化。

# mysql - MySQL INSERT IGNORE 或 ON DUPLICATE KEY DO_NOTHING

> ID：10365613
> 
> 赞同：5
> 
> 时间：2012-04-28T16:57:31.670
> 
> 标签：mysql

已经搜索过此类主题并找到了 2 个不同的解决方案，但没有一个有效。

我的表有结构 | ID (auto_increment primary_key) | UID（整数）| FAV_ID (int) |

如果 UID 和 FAV_ID（两者）已经存在，我需要向这个 FAV_TABLE 插入新记录。

我的查询示例：

```
INSERT INTO FAV_TABLE (uid, fav_id) VALUES ($u_id,$s_id) ON DUPLICATE KEY UPDATE  uid = uid 
```

或者这个

```
INSERT IGNORE FAV_TABLE (uid, fav_id) VALUES ($u_id,$s_id); 
```

正如 mysql 手册所说，只有当 PRIMARY_KEY 相同时，此查询才会添加记录。如果对 uid+fav_id 是唯一的，我需要查询不添加记录。有什么解决办法吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T17:02:39.907

您需要`UNIQUE KEY`在这些列上添加一个：

```
ALTER TABLE FAV_TABLE ADD UNIQUE KEY(uid, fav_id); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T17:02:39.187

`INSERT IGNORE`或`ON DUPLICATE KEY`仅在重复唯一键时才有效。

您需要`UNIQUE`在两个字段`uid`和`fav_id`. 这样，当您插入重复的对时，它将被忽略。

# c# - 如何在 C# 中表示从数据库中提取的树结构然后显示在网页上

> ID：10365615
> 
> 赞同：0
> 
> 时间：2012-04-28T16:57:57.167
> 
> 标签：c#, asp.net-mvc, linq

我正在从事需要获得产品谱系的项目。例如，假设产品 A 生产了 B1 和 B2，而 B1 又生产了 C1、C2、C3，而 B2 又生产了 C4、C5、C6。现在，如果用户输入 B1 或 C2 或任何产品，它应该返回整个系列。

目前在数据库中我有下面的表结构 -entryproudct exitproduct -A B1 -A B2 -B1 C1 -B1 C2 -B1 C3 -B2 C4 -B2 C5 -B2 C6

并且在 C# 中有一个产品类，其实例用于表示 A、B1、B2 .....等，即表示产品.....

1.  现在，当给出一种产品时，我如何在 C# 中构建它的家谱或家谱？
2.  我需要更改表结构还是构建树就足够了？
3.  使用asp.net mvc或ajax在网页上显示视觉树结构有多难

我将使用 asp.net mvc、linq、sql server 2008。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:06:13.397

展示一棵树不应该太难。这是使用递归的人： [http ://weblogs.asp.net/raduenuca/archive/2011/04/24/asp-net-mvc-displaying-a-tree-view-using-a-recursive-declarative-助手和 jquery.aspx](http://weblogs.asp.net/raduenuca/archive/2011/04/24/asp-net-mvc-displaying-a-tree-view-using-a-recursive-declarative-helper-and-jquery.aspx)

这是 JQuery 中的一个： [http ://weblogs.asp.net/mikebosch/archive/2008/11/25/hierarchical-treeview-with-asp-net-mvc-jquery.aspx](http://weblogs.asp.net/mikebosch/archive/2008/11/25/hierarchical-treeview-with-asp-net-mvc-jquery.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T23:11:53.383

如果你想显示像 Windows Explorer 这样的树形视图，你可以使用： http: [//www.dotnetperls.com/treeview](http://www.dotnetperls.com/treeview)

如果这是一棵二叉树，那么你可能会考虑用 jQuery 构建一棵树：http: [//frank-mich.com/jQuery/](http://frank-mich.com/jQuery/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-06T21:44:03.317

您可以使用递归查询编写存储过程，并将数据存储在列表中，其中产品对象具有列表的成员。

# matlab - 集群质量度量

> ID：10365616
> 
> 赞同：6
> 
> 时间：2012-04-28T16:58:00.987
> 
> 标签：matlab, cluster-analysis, data-mining, evaluation

Matlab 是否提供任何工具来评估聚类方法？（集群紧凑性和集群分离......）或者是否有任何工具箱？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-10T12:00:30.450

Matlab提供Silhouette index，还有一个工具箱[CVAP: Cluster Validity Analysis Platform](http://www.mathworks.com/matlabcentral/fileexchange/14620) for Matlab。其中包括以下有效性指标：

*   戴维斯-博尔丁
*   卡林斯基-哈拉巴斯
*   邓恩指数
*   R平方指数
*   休伯特-莱文 (C-index)
*   Krzanowski-Lai 指数
*   哈蒂根指数
*   均方根标准差 (RMSSTD) 指数
*   半偏 R 平方 (SPR) 指数
*   两个簇之间的距离 (CD) 索引
*   加权内部指数
*   同质指数
*   分离指数

请注意，您可能需要为您的平台预编译的[LIBRA 二进制文件。](http://wis.kuleuven.be/stat/robust/LIBRA)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T19:57:22.253

您可以尝试统计工具箱中的[剪影图](http://www.mathworks.com/help/toolbox/stats/silhouette.html)。

有关示例，请参阅[此文档](http://www.mathworks.com/help/toolbox/stats/bq_679x-18.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-28T21:21:45.950

不是在 Matlab 中，但[ELKI](http://elki.dbs.ifi.lmu.de/) (Java) 提供了十几个用于评估的集群质量度量。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-26T19:04:21.023

请注意，Matlab 中的剪影对于单例集群有一些奇怪的行为。它为单身人士分配 1 分，而对我来说，更合理的方法是为这些集群分配 0 分。在 Matlab 实现中，如果您将簇数作为对象数，Silhouette 会给您 1 分。

# c - 如何在信号处理程序中获取执行上下文？

> ID：10365619
> 
> 赞同：3
> 
> 时间：2012-04-28T16:58:28.823
> 
> 标签：c, linux, signals, x86-64

`illegal operand`运行程序时出现错误。发生崩溃的程序是用汇编编写的，并作为目标文件链接，所以我不确定如何使用`gdb`它。我通过捕获信号注意到了错误。我`SIGILL`想获取违规指令的地址。我想到的一种方法是在信号处理程序中获取最后一个执行上下文，并从中记下`rip`寄存器的值。我知道上下文被传递给信号处理程序，但不知道如何。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T17:48:48.327

如果您确实想遵循信号处理程序路线，那么获取导致信号处理程序运行的指令的地址并不难。当您创建信号处理程序时，请`SA_SIGINFO`在标志设置中设置该位。然后，当您编写处理程序时，它将可以访问一个`siginfo_t`结构，该结构包含`si_addr`触发异常的内存位置的地址字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T19:23:24.660

> 用汇编编写并链接为目标文件，所以我不确定如何使用 gdb

GDB 非常适合调试汇编代码。你会想要`info registers`，`x/i $pc`。

> 我想到的一种方法是在信号处理程序中获取最后一个执行上下文，并从中记下 rip 寄存器的值。

没关系（请参阅加布里埃尔关于如何获取上下文的答案）。

请注意，与您在崩溃点在 GDB 中获得的信息相比，这*不会*为您提供任何额外的信息。如果您一开始不知道如何使用 GDB，那么我看不到通过在信号处理程序中获取上下文会获得什么。

# python - "sys.getsizeof(int)" 返回一个不合理的大值？

> ID：10365624
> 
> 赞同：58
> 
> 时间：2012-04-28T16:59:15.863
> 
> 标签：python

我想检查 python 中 int 数据类型的大小：

```
import sys
sys.getsizeof(int) 
```

结果是“436”，这对我来说没有意义。无论如何，我想知道我的机器上有多少字节（2,4，..？） int 。

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2012-04-28T17:00:54.380

### 简短的回答

您得到的是*类*的大小，而不是类的实例。调用`int`以获取实例的大小：

```
>>> sys.getsizeof(int())
24 
```

如果那个尺寸看起来还是有点大，请记住 Python与in（例如）c`int`非常不同。`int`在 Python 中，an`int`是一个成熟的对象。这意味着有额外的开销。

除了其他存储之外，每个 Python 对象都至少包含一个引用计数和对该对象类型的引用；在 64 位机器上，占用 16 个字节！内部`int`结构（由标准 CPython 实现决定）也随着时间而改变，因此占用的额外存储量取决于您的版本。

### `int`关于Python 2 和 3 中对象的一些细节

这是 Python 2 中的情况。（其中一些改编自[Laurent Luce](http://www.laurentluce.com/posts/python-integer-objects-implementation/)的博客文章）。整数对象表示为具有以下结构的内存块：

```
typedef struct {
    PyObject_HEAD
    long ob_ival;
} PyIntObject; 
```

`PyObject_HEAD`是定义引用计数和对象类型的存储的宏。[文档](https://docs.python.org/c-api/structures.html)中对其进行了一些详细的描述，并且可以在[此](https://stackoverflow.com/questions/11736762/why-pyobject-can-point-to-any-object-in-python)答案中看到代码。

内存分配在大块中，因此每个新整数都没有分配瓶颈。该块的结构如下所示：

```
struct _intblock {
    struct _intblock *next;
    PyIntObject objects[N_INTOBJECTS];
};
typedef struct _intblock PyIntBlock; 
```

这些一开始都是空的。然后，每次创建一个新整数时，Python 都会使用 所指向的内存`next`并递增`next`以指向块中的下一个空闲整数对象。

我不完全确定一旦超过普通整数的存储容量，这种情况会如何变化，但是一旦这样做，a 的大小`int`就会变大。在我的机器上，在 Python 2 中：

```
>>> sys.getsizeof(0)
24
>>> sys.getsizeof(1)
24
>>> sys.getsizeof(2 ** 62)
24
>>> sys.getsizeof(2 ** 63)
36 
```

在 Python 3 中，我认为总体情况是一样的，但整数的大小以更零碎的方式增加：

```
>>> sys.getsizeof(0)
24
>>> sys.getsizeof(1)
28
>>> sys.getsizeof(2 ** 30 - 1)
28
>>> sys.getsizeof(2 ** 30)
32
>>> sys.getsizeof(2 ** 60 - 1)
32
>>> sys.getsizeof(2 ** 60)
36 
```

当然，这些结果都取决于硬件！YMMV。

Python 3 中整数大小的可变性暗示它们可能更像可变长度类型（如列表）。事实上，事实证明这是真的。这是Python 3中对象的[C定义：`struct`](https://github.com/python/cpython/blob/ba85d69a3e3610bdd05f0dd372cf4ebca178c7fb/Include/longintrepr.h#L85)`int`

```
struct _longobject {
    PyObject_VAR_HEAD
    digit ob_digit[1];
}; 
```

该定义附带的[注释总结了 Python 3 的整数表示。](https://github.com/python/cpython/blob/ba85d69a3e3610bdd05f0dd372cf4ebca178c7fb/Include/longintrepr.h#L70)零不是由存储的值表示，而是由大小为零的对象表示（这就是为什么`sys.getsizeof(0)`is `24`bytes 而`sys.getsizeof(1)`is `28`）。负数由具有负大小属性的对象表示！太奇怪了。

# jquery - 我的博客内容后面的 jQuery 对话框弹出窗口。怎么修

> ID：10365625
> 
> 赞同：1
> 
> 时间：2012-04-28T16:59:16.780
> 
> 标签：jquery, css, user-interface, dialog

我有这个问题我已经处理了一段时间了。我的对话框似乎在我的博客内容后面弹出。这是一个屏幕截图。 [http://wsoplugins.com/wp-content/uploads/2012/04/Capture.png](http://wsoplugins.com/wp-content/uploads/2012/04/Capture.png) 有人可以帮我解决这个问题吗？它会在标题内容后面弹出以进行具体说明。下面的其他内容似乎很好。太感谢了。

```
.ui-dialog{

position: fixed;
z-index: 99999;

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T17:02:49.013

尝试更改您的`z-index`.

例如：

```
#myPopup{
    z-index: 9999;
} 
```

**编辑**
有你的问题：

```
position: fixed; 
```

您的位置必须是`relative`或`absolute`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:16:19.650

有时将`z-index`属性放在相邻的元素包装器上是明智的。唯一需要`z-index`工作的是元素应该通过`position`属性相对、绝对或固定定位。

例如 HTML：

```
<div class="nav">
Multiple div's here with some text or whatever elements, some of them with z-index
</div>
<div class="main_content">
Multiple div's here with some text or whatever elements, some of them with z-index
</div> 
```

CSS：

```
.nav{
    position: relative; //fixed, or absolute, otherwise z-index doesn't work
    z-index: 40;
}
.main_content{
    position: relative; //fixed, or absolute, otherwise z-index doesn't work
    z-index: 30; // setting it lower than the previous block
} 
```

您可以添加这样的 css 以确保 div 中之后的任何内容都`nav`将以`main_content`较低的`z-index`值定位。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T17:03:34.113

您可以在创建对话框时设置 zIndex 选项；

```
zIndex: 12000 //you can set much more 
```

# mysql - 如何在 MySQL 中存储“事件”的“位置”

> ID：10365626
> 
> 赞同：1
> 
> 时间：2012-04-28T16:59:18.280
> 
> 标签：mysql, entity-relationship

我有两个实体：**Event**和**Location**。关系是：

**1 个事件**可以有**1 个位置**。 **1 位置**可以有**许多事件**。

基本上我想存储事件。每个活动都在特定位置举办。当我说具体位置时，我的意思是：

```
Street, Number, City, Zip Code, State, Country 
```

我基本上有一个设计问题，我需要一些帮助：

1 - 现在我正在考虑做以下事情：

事件表将有一个`location_id`指向位置表中特定位置行的。这会发生什么：我将在每一行中有许多重复的值。例如，如果一个事件正在旧金山的**356** Matilda Street 发生，而另一个事件正在旧金山的**890** Matilda Street 发生。值 Matilda Street 和 San Francisco 将在位置表中**重复**多次。我该如何重新设计以使其正常化？

所以，基本上我很想听听一个用关系数据库（如 MySQL）来解决这个问题的好方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:05:26.413

表中的每个位置`locations`都应由其唯一标识`PRIMARY KEY`。然后，表中的记录通过`events`包含 that 的值的列引用它们的关联位置`PRIMARY KEY`。

例如，您的位置表可能包含：

```
location_id | 街道 | 号码 | 城市 | 邮政编码 | 状态 | 国家
------------+----------------+--------+------------ ----+----------+--------+----------
          1 | 玛蒂尔达街 | 356 | 旧金山 | 12345 | 加利福尼亚州 | 美国
          2 | 玛蒂尔达街 | 890 | 旧金山 | 12345 | 加利福尼亚州 | 美国

```

那么您的`events`表可能包含：

```
event_id | location_id | 日期 | 描述
---------+-------------+------------+------------- ---
       1 | 1 | 2012-04-28 | 生日聚会
       2 | 1 | 2012-04-29 | 宿醉派对
       3 | 2 | 2012-04-29 | 葬礼
       4 | 1 | 2012-05-01 | 劳动节！

```

在此示例中，`location_id`是表`PRIMARY KEY`中的和表中的 a。`locations``FOREIGN KEY``events`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:06:10.310

如果您想要一个严格规范化的数据库，您可以有一个用于街道名称的表，另一个用于城市，另一个用于州，等等。您甚至可能有一个额外的`location`表格，其中包含街道、城市和州的独特组合；每次在以前未知的位置发生事件时，您都会在此表中添加行。然后，您的每个事件都会引用表中的相应行`location`。

但在实践中，有时最好将位置数据直接存储在`events`表中并容忍额外的内存使用；在速度和内存使用之间总是存在权衡。

另一个考虑：如果一条街道被重命名会发生什么？您希望旧事件与旧名称还是新名称相关联？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:07:11.227

您的 Locations 表应该有一个唯一的 ID，例如 1=Matilda Street, 2=Market Street - 每个可能的位置都有一条记录 没有重复，那么您的 Events 表应该有一个使用这些 ID 之一的位置 ID - 同样，每个都有一个事件，没有重复。

然后你可以像这样加入他们；

```
SELECT events.event_name, locations.location_name
FROM events
JOIN locations on locations.location_id = events.location_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T17:09:24.757

重复是非常正常的，因为它们中的每一个都是唯一的位置。除此之外，当您尝试过滤旧金山的地点时，您认为该设计非常有用。

# google-app-engine - 如何将 GAE 应用程序设置应用于非默认版本

> ID：10365634
> 
> 赞同：2
> 
> 时间：2012-04-28T17:00:10.077
> 
> 标签：google-app-engine, application-settings

有没有办法将**待处理延迟**和**空闲实例**应用程序设置应用于应用程序的**非默认版本**？

我们有必须共享数据存储/内存缓存的 Java 和 Python 版本，因此我们非常希望控制这两个版本的应用程序的这些设置。

如果不能立即实现，您知道 GAE 团队何时可以为非默认版本添加应用程序设置支持吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:09:36.520

这些设置对您的应用程序是全局的，并且不能针对默认版本以外的其他版本进行不同的设置。无法真正回答您的第二个问题。您是否尝试查看问题跟踪器？ [http://code.google.com/p/googleappengine/issues/list](http://code.google.com/p/googleappengine/issues/list)

你可以提交一个功能请求，看看会发生什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T15:16:11.003

非默认版本旨在用于分阶段部署，而不是实际用于生产应用程序。因此，Google 不太可能接受任何此类请求。此外，尚不清楚您为什么拥有此应用程序的 Python 和 Java 版本。从技术上讲，您的用户不会知道其中的区别，因此最终最好选择一个平台，Java 或 Python，并坚持使用它。

但是，我想您没有告诉我们一些事情，因此如果您出于某种原因确实需要维护这两个应用程序，您可以使用 REST 从一个完全独立的应用程序访问您的数据存储。使用 memcache，您可以通过缓存经常访问的数据来减少任何延迟。

这将允许两个应用程序访问相同的数据存储，同时使两个应用程序都具有自己的设置的生产应用程序。

# asp.net - 使用会员 api 查询会员数据库

> ID：10365635
> 
> 赞同：0
> 
> 时间：2012-04-28T17:00:15.510
> 
> 标签：asp.net, membership-provider

我正在使用会员 api 来获取用户密码和电子邮件。

我有这个代码：

```
 MembershipUser currentUser = Membership.GetUser();
        UserPasssword.Text = currentUser.GetPassword(); //Null exception 
```

我需要在登录时检查用户。问题是用户没有登录。所以我想找到一种方法来获取用户密码或使用会员 api 的电子邮件，而不是通过数据库查询。有没有办法做到这一点？还是我必须求助于数据库查询？

请记住，用户没有登录.. .. 所以每次在 currentUser 对象上结果都会是空点异常..

如何使用会员 api 检查他的电子邮件，然后使用重定向：

```
 if (currentUser.Email == LoginEmail.Text && currentUser.GetPassword() == hash)
        {
            FormsAuthentication.RedirectFromLoginPage(currentUser.UserName, false);
        }
        else
        {
            LoginFail.Text = "Email or Password havent been incorrect.";
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:03:11.693

如果您只是想让用户登录，最好让会员通过[Validate User](http://msdn.microsoft.com/en-us/library/system.web.security.membership.validateuser.aspx)方法来处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T21:01:29.190

要获取用户的电子邮件和密码，您可以使用 Membership.GetUser(username)。此方法返回一个 MembershipUser 对象，您可以查询 Email 和 GetPassword()。

# python - 未在多级继承中调用父初始化程序？

> ID：10365636
> 
> 赞同：2
> 
> 时间：2012-04-28T17:00:35.883
> 
> 标签：python, inheritance, initialization

我有一个具有 2 级继承的类方案。我的期望是每个类构造函数都会运行——但中级类构造函数似乎永远不会受到影响。这里缺少什么？

```
class Base(object):
    def __init__(self):
        print "BASE"

class Next(Base):
    def __init__(self):
        super(Base, self).__init__()
        print "NEXT"

class Final(Next):
    def __init__(self):
        super(Next, self).__init__()    
        print "FINAL"

f = Final() 
```

**输出：**

> 基础
> 决赛

为什么“NEXT”不打印？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-28T17:02:54.137

您应该`super()`使用*当前*类而不是父类调用。

```
class Base(object):
    def __init__(self):
        super(Base, self).__init__()
        print "BASE"

class Next(Base):
    def __init__(self):
        super(Next, self).__init__()
        print "NEXT"

class Final(Next):
    def __init__(self):
        super(Final, self).__init__()    
        print "FINAL"

f = Final() 
```

乍一看，这似乎是多余的（“为什么不能只从 获取类`self`？”） - 但请记住，在创建时将相同`self`的内容传递给所有这三个`__init__`方法`f`，并且`self`始终属于 class `Final`。因此，您必须传递`super()`您希望它找到其父级的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T11:27:40.483

```
class Base(object):
    def __init__(self):
        print "BASE"

class Next(Base):
    def __init__(self):
        super(Next, self).__init__()
        print "NEXT"

class Final(Next):
    def __init__(self):
        super(Final, self).__init__()    
        print "FINAL"

f = Final() 
```

# meteor - Meteor Oauth 访问其他网站 (500px instagr.am)

> ID：10365640
> 
> 赞同：1
> 
> 时间：2012-04-28T17:00:57.437
> 
> 标签：meteor, instagram

我的流星网络应用[http://meteor.app](http://meteor.app)基本上是许多其他网站的代理：即[http://500px.com](http://500px.com)，[http://instagr.am](http://instagr.am)

[当用户在我的http://meteor.app](http://meteor.app)上搜索关键字时，我希望我的流星服务器代码搜索[http://500px.com](http://500px.com)或[http://instagr.am](http://instagr.am)
（实际上我的前端调用我的服务器端-point [http://meteor.app/search](http://meteor.app/search)，它将对 500px 和 instrag.am 进行 Oauth 调用）（目前我对 oauth 没有问题，使用 connect-auth atm）

我不确定如何在流星上创建[http://meteor.app/search](http://meteor.app/search)端点，因为一切都围绕 ORM/Collection 进行，在这个阶段我不使用持久性。

那么我应该使用和自定义 Meteor.Collection 类来查询 instragr.am 端点还是？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:29:53.667

我认为您的客户端代码应该使用：Meteor.call，它将调用 Meteor.method。 [http://docs.meteor.com/#meteor_methods](http://docs.meteor.com/#meteor_methods)

此方法可以更新 n 行 instagram 的集合并删除所有集合行并在调用 Meteor.method 时重新填充集合。

有一个模糊的问题，虽然答案会很模糊:)。

Madewith 应用是一个很好的起点： [https](https://github.com/meteor/madewith) ://github.com/meteor/madewith 这使用 API 调用等等。

# c# - 更新 TableA.FK 值 TableB.PK WHERE TableA.Column = TableB.Column

> ID：10365641
> 
> 赞同：1
> 
> 时间：2012-04-28T17:01:07.240
> 
> 标签：c#, tsql, ms-access

我正在尝试合并来自不同数据库、ServerDB 和 ClientDB 的表并保存到 ClientDB，其中客户端的表包含主表记录以及用户可能添加的任何记录。另一方面，服务器表也可以更新（插入新记录）。

数据库有关系。TableA 中我要插入值的列是一个 ForeignKey，它链接到 TableB 的 PrimaryKey，它是一个自动增量列。

我将两个数据库中的所有记录保存在合并数据集中，并且由于数据库设计限制，我需要在从数据集中插入合并表之前清除客户端上的两个表。

我首先更新TableB（具有PrimaryKey自动增量列的那个），但是现在该列的值与TableA上的ForeignKey无关，所以我更新TableA并在ForeignKey列中临时插入第一条记录的值TableB的PK。现在我需要使用 TableA PK 列中的正确值更新 TableA foreignKey 列。每个表上还有第三列具有相同的值。

sql语句的语法应该是什么？如果我没有多大意义，请告诉我，我会发布更好的描述。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T20:11:34.910

这是一个令人困惑的问题，但我认为您正在谈论将表 1 中的值插入到表 2 中，其中表 1 的值等于表 2 的值，此操作的 sql 查询是

```
INSERT INTO emp (empno,ename)
SELECT t2.deptno, 
       t2.dname 
FROM   dept t2 
       LEFT JOIN emp t1 
         ON t2.deptno = t1.deptno 
```

在此查询中，表 1 (emp) 将在表 2 (dept) 的列 (empno 和 ename) 中插入 2 个值，并且连接在 (deptno) 上，这两个表中都存在。

您可以进一步询问这是否没有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T20:32:01.523

谢谢大家的帮助。在“OledbException Operation must use an updateable query”挣扎了一段时间后，我在类似主题中找到了一个解决方案：[MS Access 中的 SQL Update woes - Operation must use an updateable query](https://stackoverflow.com/questions/537161/sql-update-woes-in-ms-access-operation-must-use-an-updateable-query)

那就是成功的查询：

```
UPDATE DISTINCTROW PlaylistsSongs
    INNER JOIN PlaylistsNames ON PlaylistNames.PlaylistName = PlaylistsSongs.PlaylistName
SET PlaylistID = PlaylistNames.ID 
```

# php - 按时间戳排序数组

> ID：10365642
> 
> 赞同：-1
> 
> 时间：2012-04-28T17:01:08.343
> 
> 标签：php, arrays, sorting, timestamp

我有以下格式的数组：

```
array
  0 => 
    array
      1335541286 => 
        array
          'event' => string 'track' (length=5)
          'title' => string 'Plastic Humans' (length=14)
          'album' => string 'Cities of hunger' (length=16)
          'artist' => string 'The Maple Room' (length=14)
  1 => 
    array
      1335540999 => 
        array
          'event' => string 'track' (length=5)
          'title' => string 'Atlantis' (length=8)
          'album' => string 'Cities of hunger' (length=16)
          'artist' => string 'The Maple Room' (length=14)
  2 => 
    array
      1335540064 => 
        array
          'event' => string 'track' (length=5)
          'title' => string 'Doradus Stars' (length=13)
          'album' => string 'A Glimpse of the Inside' (length=23)
          'artist' => string 'The Maple Room' (length=14)
  3 => 
    array
      1335539855 => 
        array
          'event' => string 'track' (length=5)
          'title' => string 'In Twenty Five' (length=14)
          'album' => string 'A Glimpse of the Inside' (length=23)
          'artist' => string 'The Maple Room' (length=14)
  4 => 
    array
      1334016000 => 
        array
          'event' => string 'purchase' (length=8)
          'title' => string 'Donald Trump - Single' (length=21)
          'artist' => string 'Mac Miller' (length=10)
          'format' => string '10"' (length=3) 
```

我很想根据键（即时间戳）对数组进行排序。我已经阅读了很多关于 PHP 排序方法的内容，但我不知道最好的解决方案是什么。

任何帮助表示赞赏，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:04:31.153

使用缩小数据：

```
$data = array(
  array('1335541286' => array('1')),
  array('1335540999' => array('1')),
  array('1335540064' => array('1')),
);

usort($data, function ($a, $b) {
  return key($a) - key($b);
});

print_r($data); 
```

此外，您输入数据的结构似乎有点奇怪。额外的级别并不是真正需要的，并且不必要地使事情复杂化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:08:15.840

```
uasort($array, 'cmp');

function cmp($a, $b)
{
    if (key($a) == key($b)) {
        return 0;
    }
    return (key($a) < key($b)) ? -1 : 1;
} 
```

# f# - 如何在 F# 中定义等效的 printfn

> ID：10365644
> 
> 赞同：7
> 
> 时间：2012-04-28T17:01:12.563
> 
> 标签：f#, f#-interactive

由于我使用 F# 进行研究（特别是使用 F# 交互），我希望有可切换的“调试时打印”功能。

我可以

```
let dprintfn = printfn 
```

F# 互动 说

```
val dprintfn : (Printf.TextWriterFormat<'a> -> 'a) 
```

我可以使用

```
dprintfn "myval1 = %d, other val = %A" a b 
```

每当我想在我的脚本中。

现在我想定义`dprintfn`不同的，这样它会*忽略*它的所有参数，但语法兼容`printfn`. 如何？

* * *

我想到的最接近（但不起作用）的变体是：

```
let dprintfn (arg: (Printf.TextWriterFormat<'a> -> 'a)) = () 
```

但是它下面的内容没有编译`dprintfn "%A" "Hello"`，导致`error FS0003: This value is not a function and cannot be applied`.

**PS**我目前使用别名`Debug.WriteLine(...)`作为解决方法，但是对于理解 F# 的类型系统，这个问题仍然很有趣。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-28T17:26:55.507

您可以使用该`kprintf`函数，它使用标准语法格式化字符串，然后调用您指定的 (lambda) 函数来打印格式化的字符串。

例如，以下内容打印字符串 if`debug`已设置，否则不执行任何操作：

```
let myprintf fmt = Printf.kprintf (fun str -> 
  // Output the formatted string if 'debug', otherwise do nothing
  if debug then printfn "%s" str) fmt 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T21:49:47.707

我一直在分析我的应用程序，发现调试格式会导致严重的**性能问题**。由于应用程序的性质，调试格式几乎出现在代码的每个字符串上。
显然，这是由`kprintf`无条件格式化然后将 a 传递`string`给谓词造成的。
最后，我想出了以下可能对您有用的解决方案：

```
let myprintf (format: Printf.StringFormat<_>) arg =
    #if DEBUG 
        sprintf format arg
    #else
        String.Empty
    #endif

let myprintfn (format: Printf.TextWriterFormat<_>) arg =
    #if DEBUG
        printfn format arg
    #else
        ()
    #endif 
```

用法很简单，格式检查也很好：

```
let foo1 = myprintf "foo %d bar" 5
let foo2 = myprintf "foo %f bar" 5.0

// can't accept int
let doesNotCompile1 = myprintf "foo %f bar" 5
// can't accept two arguments
let doesNotCompile2 = myprintf "foo %f bar" 5.0 10

// compiles; result type is int -> string
let bar = myprintf "foo %f %d bar" 5.0 
```

# gcc - 如何在 Mac 上构建 Firesheep？'sys/types.h' 文件未找到

> ID：10365645
> 
> 赞同：2
> 
> 时间：2012-04-28T17:01:22.063
> 
> 标签：gcc, build

我在构建这个时遇到了问题；有没有人知道在哪里可以找到这个文件/安装哪个库？

**制作**

```
Making all in backend
/bin/sh ../libtool  --tag=CC   --mode=compile clang -DPACKAGE_NAME=\"Firesheep\" -DPACKAGE_TARNAME=\"firesheep\" -DPACKAGE_VERSION=\"0.1\" -DPACKAGE_STRING=\"Firesheep\ 0.1\" -DPACKAGE_BUGREPORT=\"eric@codebutler.com\" -DPACKAGE_URL=\"http://codebutler.github.com/firesheep\" -DPACKAGE=\"firesheep\" -DVERSION=\"0.1\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\".libs/\" -DHAVE_BOOST=1 -DHAVE_BOOST_FORMAT_HPP=1 -DHAVE_BOOST_ALGORITHM_STRING_HPP=1 -I. -I deps/ -I deps/http-parser -I deps/json_spirit    -isysroot /Developer/SDKs/MacOSX10.6.sdk -mmacosx-version-min=10.6 -Wall -g -O0 -DPLATFORM_OSX -arch i386 -arch x86_64   -MT libfiresheep_la-http_parser.lo -MD -MP -MF .deps/libfiresheep_la-http_parser.Tpo -c -o libfiresheep_la-http_parser.lo `test -f 'deps/http-parser/http_parser.c' || echo './'`deps/http-parser/http_parser.c
libtool: compile:  clang -DPACKAGE_NAME=\"Firesheep\" -DPACKAGE_TARNAME=\"firesheep\" -DPACKAGE_VERSION=\"0.1\" "-DPACKAGE_STRING=\"Firesheep 0.1\"" -DPACKAGE_BUGREPORT=\"eric@codebutler.com\" -DPACKAGE_URL=\"http://codebutler.github.com/firesheep\" -DPACKAGE=\"firesheep\" -DVERSION=\"0.1\" -DSTDC_HEADERS=1 -DHAVE_SYS_TYPES_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_STDLIB_H=1 -DHAVE_STRING_H=1 -DHAVE_MEMORY_H=1 -DHAVE_STRINGS_H=1 -DHAVE_INTTYPES_H=1 -DHAVE_STDINT_H=1 -DHAVE_UNISTD_H=1 -DHAVE_DLFCN_H=1 -DLT_OBJDIR=\".libs/\" -DHAVE_BOOST=1 -DHAVE_BOOST_FORMAT_HPP=1 -DHAVE_BOOST_ALGORITHM_STRING_HPP=1 -I. -I deps/ -I deps/http-parser -I deps/json_spirit -isysroot /Developer/SDKs/MacOSX10.6.sdk -mmacosx-version-min=10.6 -Wall -g -O0 -DPLATFORM_OSX -arch i386 -arch x86_64 -MT libfiresheep_la-http_parser.lo -MD -MP -MF .deps/libfiresheep_la-http_parser.Tpo -c deps/http-parser/http_parser.c  -fno-common -DPIC -o .libs/libfiresheep_la-http_parser.o
In file included from deps/http-parser/http_parser.c:21:
deps/http-parser/http_parser.h:28:10: fatal error: 'sys/types.h' file not found
#include <sys/types.h>
         ^
1 error generated.
make[1]: *** [libfiresheep_la-http_parser.lo] Error 1
make: *** [all-recursive] Error 1 
```

**gcc --version**产生：

```
i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.9.00) 
```

**/usr/bin/sw_vers**

产品名称：Mac OS X

产品版本：10.7.3

构建版本：11D2001

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T11:29:08.477

问题已由[github](https://github.com/codebutler/firesheep/issues/169#issuecomment-6985466)上的**giblfiz**解决：

> 更改 configure.ac 中的 CFLAGS def

```
CFLAGS = -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.7.sdk -mmacosx-version-min=10.7 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:48:42.933

当我尝试在我的 Mac (OSX 10.8) 上安装 Perl 的数据库接口 (DBI) 模块时，我遇到了同样的错误。XCode 4.4 版将头文件放在`/Developer-3.2.6/SDKs/MacOSX10.6.sdk/usr/include`而不是`/usr/local/include`. perl 脚本生成的 makefile 正在查找`/usr/local/include`头文件。在我用新位置更新makefile后，安装成功。

这是makefile的更新摘录：

`CCFLAGS = -arch i386 -arch x86_64 -g -pipe -fno-common -DPERL_DARWIN -fno-strict-aliasing -fstack-protector -I/Developer-3.2.6/SDKs/MacOSX10.6.sdk/usr/include`

这是安装过程中的实际命令。

> clang -c -arch i386 -arch x86_64 -g -pipe -fno-common -DPERL_DARWIN -fno-strict-aliasing -fstack-protector **-I/Developer-3.2.6/SDKs/MacOSX10.6.sdk/usr/include** - os -DVERSION=\"1.622\" -DXS_VERSION=\"1.622\" "-I/System/Library/Perl/5.12/darwin-thread-multi-2level/CORE" -W -Wall -Wpointer-arith -Wbad- function-cast -Wno-comment -Wno-sign-compare -Wno-cast-qual -Wmissing-noreturn -Wno-unused-parameter DBI.c

# css - 是否有任何用于显示的 polyfill：表格、表格行、表格单元等

> ID：10365646
> 
> 赞同：5
> 
> 时间：2012-04-28T17:01:32.523
> 
> 标签：css, tablerow, css-tables, polyfills

我意识到，出于很多目的， display: table 以及类似的 table-row、table-cell 等具有非常有用的定位属性，并且可以用于很多目的而不是 floats，例如用于制作无浮动菜单和更好的对齐页脚。然而，缺乏支持是一种真正的威慑。

我想知道 polyfill 有哪些选项可以模拟显示：表格、表格单元格、表格行等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T17:15:05.083

`table-row`例如，对的支持实际上非常好。它从第 8 版开始就在 IE 中：[http://caniuse.com/#search=table-row](http://caniuse.com/#search=table-row)。

如果您正在寻找在 IE6 和 7 中修补它的 shim，您可能会在专门为 IE6/7 设计的[display-table.htc中找到您想要的东西。](http://tanalin.com/en/projects/display-table-htc/)

# android - 从 HttpRequest (Android) 获取 POST 数据

> ID：10365649
> 
> 赞同：2
> 
> 时间：2012-04-28T17:01:37.030
> 
> 标签：android, http, post, httprequest

在我的 Android 应用程序中，我需要运行一个 HTTP Web 服务器。初始启动似乎没问题 - 当我使用浏览器导航到该服务器上的页面时，我可以接收请求并处理 URI 字符串（我看到带有所有参数的完整 URI 的 GET 请求）。但是，如果我使用向服务器提交请求的表单：

```
<FORM action="http://192.168.1.107:8080/testaction" method="post">
    <INPUT type="text" name="textfield" /><BR>
    <INPUT type="submit" value="Send"/>
 </FORM> 
```

我只得到 URI 中的操作（如“/testaction”）。我无法弄清楚如何获取 POST 请求的实际数据。

这是处理java代码中请求的部分：

```
public class HomePageHandler implements HttpRequestHandler {
...
        @Override
        public void handle(HttpRequest request, HttpResponse response, HttpContext httpContext) throws HttpException, IOException {

                String uriString = request.getRequestLine().getUri();
                Uri uri = Uri.parse(uriString);
...
} 
```

我意识到我可能在 java 和/或 HTML 表单本身中做错了什么。请就这两个方面提出建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-29T10:07:18.087

要获取 POST 正文，您可以执行以下操作：

```
if (request instanceof HttpEntityEnclosingRequest) { //test if request is a POST
    HttpEntity entity = ((HttpEntityEnclosingRequest) request).getEntity();
    String body = EntityUtils.toString(entity); //here you have the POST body
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:54:19.853

请参阅[此处](http://www.androidsnippets.com/executing-a-http-post-request-with-httpclient)以在 android 中实现 POST 请求。

要使用浏览器进行交叉检查..我可以建议您在 Firebug（在 firefox 上，其他类似）控制台中查看 ajax 发布请求。或在线工具，如[http://web-sniffer.net/](http://web-sniffer.net/)或[http://hurl.it](http://hurl.it)

# c++ - 为什么动态内存分配在 600MB 之后会失败？

> ID：10365653
> 
> 赞同：1
> 
> 时间：2012-04-28T17:01:57.110
> 
> 标签：c++, dynamic-arrays, bitarray, bad-alloc

我使用三维 char 数组实现了一个布隆过滤器（位表），它运行良好，直到它无法再分配内存并给出**bad_alloc**消息。它在分配 600MB 后的下一个扩展请求中给了我这个错误。

布隆过滤器（数组）预计会增长到 8 到 10GB。

这是我用来分配（扩展）位表的代码。

```
unsigned char ***bit_table_=0;
unsigned int ROWS_old=5;
unsigned int EXPND_SIZE=5;

void expand_bit_table()
     {
         FILE *temp;
         temp=fopen("chunk_temp","w+b");
         //copy old content
         for(int i=0;i<ROWS_old;++i)
             for(int j=0;j<ROWS;++j)
                 fwrite(bit_table_[i][j],COLUMNS,1,temp);
         fclose(temp);
         //delete old table
         chunk_delete_bit_table();
         //create expanded bit table ==> add EXP_SIZE more rows
         bit_table_=new unsigned char**[ROWS_old+EXPND_SIZE];
         for(int i=0;i<ROWS_old+EXPND_SIZE;++i)
            {
                bit_table_[i]=new unsigned char*[ROWS];
                for(int k=0;k<ROWS;++k)
                    bit_table_[i][k]=new unsigned char[COLUMNS];
            }
         //copy back old content

          temp=fopen("chunk_temp","r+b");
         for(int i=0;i<ROWS_old;++i)
         {
            fread(bit_table_[i],COLUMNS*ROWS,1,temp);
         }
          fclose(temp);
         //set remaining content of bit_table_to 0
         for(int i=ROWS_old;i<ROWS_old+EXPND_SIZE;++i)
             for(int j=0;j<ROWS;++j)
                 for(int k=0;k<COLUMNS;++k)
                     bit_table_[i][j][k]=0;

         ROWS_old+=EXPND_SIZE;
     } 
```

数组的最大允许大小是多少，如果这不是问题，我该怎么办。

编辑：它是使用 32 位平台开发的。

它在具有 8GB RAM 的 64 位平台（服务器）上运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T17:16:50.637

32 位程序必须从虚拟内存地址空间分配内存。它存储代码和数据块，内存是从它们之间的孔中分配的。是的，您可以期望的最大值约为 650 兆字节，这是最大的可用漏洞。从那里迅速下降。你可以通过让你的数据结构更智能来解决这个问题，比如一棵树或列表，而不是一个巨大的数组。

您可以使用 SysInternals 的 VMMap 实用程序更深入地了解进程的虚拟内存映射。您可能能够更改 DLL 的基地址，使其不会位于地址空间的其他空白区域的中间。但是，您获得超过 650 MB 的可能性很小。

64 位操作系统有更多的喘息空间，32 位进程有 4 GB 的地址空间，因为操作系统组件以 64 位模式运行。您必须使用 /LARGEADDRESSAWARE 链接器选项以允许进程使用它。尽管如此，这只适用于 64 位操作系统，您的程序仍然可能会在 32 位操作系统上崩溃。当你真的需要这么多虚拟机时，最简单的方法就是让 64 位操作系统成为先决条件，然后构建面向 x64 的程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T17:15:16.800

32 位机器为您提供 4GB 的地址空间。

操作系统保留了其中的一部分（Windows 上默认有一半，给你自己 2GB。我不确定 Linux，但我相信它会保留 1GB）

这意味着您有 2-3 GB 的空间用于您自己的进程。

在这个空间中，需要满足以下几点：

*   您的可执行文件（以及所有动态链接库）被内存映射到其中
*   每个线程都需要一个栈
*   堆

还有很多其他的细节。

*关键是你最终实际使用*了多少内存并不重要。但是很多不同的部分必须适合这个内存空间。而且由于它们没有紧紧地塞在它的一端，它们会*碎裂*内存空间。想象一下，为简单起见，您的可执行文件被映射到此内存空间的中间。这会将您的 3GB 分成两个 1.5GB 的块。现在假设您加载了两个动态库，它们将这两个块细分为四个 750MB 的块。然后你有几个线程，每个线程都需要更多的内存块，进一步分割剩余的区域。当然，实际上它们中的每一个都不会被放置在每个连续块的确切中心（这将是一个非常愚蠢的分配策略），但是，所有这些内存块都细分了可用内存空间，将其切割分成许多小块。

您可能有 600MB 可用内存，但很可能没有 600MB 可用的*连续*内存。因此，在单个 600MB 分配几乎肯定会失败的情况下，六个 100MB 分配可能会成功。

您可以分配多大的内存没有固定限制。答案是“视情况而定”。这取决于您的进程内存空间的精确布局。但在 32 位机器上，您不可能在一次分配中分配 500MB 或更多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T17:08:26.577

理论上，32 位进程可以访问的最大内存数据为 4GB（实际上它会小一些）。所以你不能一次在内存中拥有 10GB 的数据（即使操作系统支持更多）。此外，即使您动态分配内存，可用的可用存储空间也受到堆栈大小的进一步限制。

进程可用的实际内存取决于生成可执行文件的编译器设置。

如果您确实需要那么多，请考虑将（部分）数据保存在文件系统中。

# ajax - 带有帖子的 COLDFUSION CFGRID Datapass

> ID：10365665
> 
> 赞同：0
> 
> 时间：2012-04-28T17:03:17.953
> 
> 标签：ajax, post, coldfusion, cfgrid

今天我有一个独特的挑战。我有一个客户希望能够根据插入到 cfgrid 中来搜索多个项目。假设我们有以下 Web 表单：

*   国家选择下拉菜单

*   依赖于状态选择的 AJAX 下拉列表

*   一个城市选择依赖的 AJAX 下拉菜单

*   添加按钮
    ------------------------------------------------------------ -----

*   当用户单击添加按钮时，将使用选择填充一行的 CFGRID
    ---------------------------------- ------------------

*   最后是 CLEAR 按钮和底部的 GO 按钮。

然后生成的页面将查询数据库并获取有关所选城市的一些统计信息。因此，假设个人选择美国 > 亚利桑那 > 斯科茨代尔和美国 > 亚利桑那 > 弗拉格斯塔夫。选项下方的网格将“保存”每个选择并重置为其默认选项，等待用户选择其他选项或单击“开始”。

然后，生成的页面将生成列，列出有关社区的一些统计数据，并突出显示每个选定社区之间的“最佳”。

每次用户选择添加按钮时（假设选择了三个条件），我希望将信息添加到显示所选选项的 CFGRID 中。然后，在用户选择至少一个国家/城市/州选项后，将 CFGRID 中的所有数据传递到另一个页面，该页面对所选数据进行查询。理论上，用户可以根据需要选择尽可能多的社区，假设他们愿意让数据库通过足够多的数据来获取他们想要的数据并等待通过“加载”屏幕来获取它。

我遇到了这些挑战，没有特定的顺序： - 我有一个 HTML 网格，我必须按照客户端规范使用（没有 Java 或 Flash，必须是 HTML） - 我不知道如何将选定的选项放入 CFGRID。我假设我可以编写一些 JavaScript，它使用某种 AddRow 函数通过添加按钮将数据添加到网格中，但似乎无法在互联网上找到如何使用它 - 在我们克服了上述挑战之后，我该如何通过从网格中的数据到结果页面？我考虑过传递一个大字符串或一个结构，但我不确定如何通过 URL 或发布来做到这一点，也不知道如何从网格中获取数据。我想知道我是否最好使用 get 方法对从选项页面传递到结果页面的某种字符串进行编码，而不是处理 CFGRID 中的内容并将 CFGRID 仅用作“虚拟”显示容器。- 最后，在 pass 完成后，我需要遍历结构并对每一行数据执行 CFQUERY 或 CFSTOREDPROC，然后获取我需要在结果页面上显示的统计信息。我认为这取决于我如何将数据从选项选择页面获取到结果页面。

谢谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:13:24.693

CFGRID 是一个很好的开始，但它可以是 b*tch 自定义和扩展......你试过可编辑的 CFGRID 绑定吗？看看它离你想要的有多远。如果结果很远，那么您可能想要使用 jqGrid 并编写一些 jQuery。

首先，阅读**使用 HTML 网格**并使 cfgrid 可编辑。 [http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec22c24-7a01.html#WSc3ff6d0ea77859461172e0811cbec22c24-72e0](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec22c24-7a01.html#WSc3ff6d0ea77859461172e0811cbec22c24-72e0)

一旦你开始工作，看看这些提供的 JS 函数，你可以与 CFGRID 一起使用

*   [http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WS0ef8c004658c1089-6262c847120f1a3b244-8000.html](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WS0ef8c004658c1089-6262c847120f1a3b244-8000.html)

*   [http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSd160b5fdf5100e8f-4439fdac128193edfd6-7f5f.html](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSd160b5fdf5100e8f-4439fdac128193edfd6-7f5f.html)

如果您仍然要求更多，您可能需要深入研究底层的 ExtJS 组件。那时我宁愿使用 jqGrid

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T19:42:31.043

我发现处理这个问题的最佳方法是来回使用 SerializeJSON 调用和 Deserialize JSON 调用。通过使用 JavaScript 表示法，我们能够在一个页面和另一个页面之间传递一个复杂的 JavaScript 对象（数组）。这具有不必担心会话超时并使 URL 可从一个解决方案点击到下一个解决方案的附加值。

# pdf - 使用专有字体减小软件生成的 pdf 的大小

> ID：10365670
> 
> 赞同：2
> 
> 时间：2012-04-28T17:03:37.817
> 
> 标签：pdf, pdf-generation, flash, hindi

我正在尝试将印度杂志带到网上。`Devenagari`本杂志使用专有字体 ( [http://www.modular-infotech.com/html/shreelipi.html](http://www.modular-infotech.com/html/shreelipi.html) )在 CorelDraw 中键入。所以这些人提供了一个 USB 加密狗，当你想要访问字体时，你必须将它连接到机器上，而且这个软件已经使用了 10 年。

为了将杂志放到网上，我们尝试将其转换为 pdf（通过打印）。生成的 pdf 大小约为 30-50MB，即使 pdf 甚至没有单个图像。我猜它会将整个文本转换为图像

考虑到它的大小，用户阅读这本杂志真的很困难。虽然当我将其转换为 .swf 格式（以添加翻书类型的功能）时 - 大小减少到 5-6MB。但也有人喜欢下载杂志然后阅读。我没有运气减少 pdf 的大小。

我在网络上做了很多研究。后记，primo pdf 没有多大帮助。我能得到的最好结果是使用 DocuCom pdf 打印机减少 30%。但它仍然是 20MB。我尝试过使用分辨率、压缩和质量，但我能得到的最好的是 18MB。

理想情况下，我想将其减少到 2MB 以下。

如果您能帮助我减小 pdf 的大小，我将不胜感激！考虑到它没有图像，我希望我能得到一些非常好的压缩。

(35MB) 杂志可从以下网址下载：http: [//merajhola.in/jin-march.pdf](http://merajhola.in/jin-march.pdf)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T02:02:38.063

我看不到任何减小此 PDF 大小的简单方法。没有嵌入字体，所有文本都是使用矢量图形基元绘制的。再多的调整分辨率、压缩和质量都不会有显着的改善。

一种可能的选择是将字体作为子集嵌入，而不是使用矢量图形。这几乎肯定会产生很大的不同，但我怀疑专有字体许可证是否允许这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T08:43:15.703

我很抱歉，但这个 Shree-Lipi 的事情在 2012 年听起来是*错误*的。在现代（比如 InDesign）或免费（比如 LuaTeX）软件中使用正确的 OpenType 字体会更好。

# c# - 在 2 个 VM 之间共享属性

> ID：10365673
> 
> 赞同：0
> 
> 时间：2012-04-28T17:04:04.570
> 
> 标签：c#, mvvm, caliburn.micro

我正在使用 Caliburn.Micro，并且在内容控件中设置了带有子 VM 的 MainWindowViewModel。在主虚拟机中，我有一个子虚拟机属性，它允许我在虚拟机之间共享属性。我在两个虚拟机上都有一个 UserName 属性。

在主视图中，我在用户名的末尾添加了一个字符串以对其进行个性化，而在子视图中，我只是按原样显示用户名。username 属性只能在子 VM 中编辑，而不能在主 VM 中编辑。当我在孩子中编辑它时，它不会更新父母。我不确定如何绑定这些属性以使父 VM 与子 VM 同步。

主虚拟机：

```
public string UserName
        {
            get { return string.Format("{0}'s Diary Log", DiaryViewModel.UserName); }
        }

private DiaryViewModel _diaryViewModel;
        public DiaryViewModel DiaryViewModel
        {
            get { return _diaryViewModel; }
            set
            {
                _diaryViewModel = value;
                NotifyOfPropertyChange(() => DiaryViewModel);
            }
        } 
```

子虚拟机：

```
private string _userName = "John";
        public string UserName
        {
            get { return _userName; }
            set
            {
                _userName = value;
                NotifyOfPropertyChange(() => UserName);
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:33:53.033

您可以将 MainView 中的控件绑定到 DiaryViewModel.UserName 并在 .xaml 中进行字符串格式化。不要忘记用斜杠转义字符串格式中的撇号。

```
<TextBlock Text="{Binding Source=DiaryViewModel.UserName, StringFormat='\{0}\'s Diary Log'}" /> 
```

# c# - 如何在 asp.net 中使用过程（包）中的多个光标输出值

> ID：10365680
> 
> 赞同：-1
> 
> 时间：2012-04-28T17:05:35.460
> 
> 标签：c#, asp.net, oracle, plsql

```
Procedure GetDetails( ID as Varchar2,
                       Cursor1 OUT Cursor_Type,
                        Cursor1 OUT Cursor_Type ) AS

BEGIN

       OPEN CURSOR1 FOR 
              Select Name from User where UserID=ID;

       OPEN CURSOR2 FOR 
               Select Place from Dept where DeptID=ID;

END GetDetails; 
```

如何使用 2 个光标的名称和位置值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T10:58:03.497

尝试使用`DataReader.NextResult`移动到下一个光标。例如：

```
while (dr.Read())
{
  //first cursor goes here
}
if (dr.NextResult() == true)
{
  while (dr.Read())
  {
    //Second cursor goes here
  }
} 
```

# java - 背包式算法

> ID：10365682
> 
> 赞同：0
> 
> 时间：2012-04-28T17:05:40.043
> 
> 标签：java, algorithm, stack, division

这是我发现的一个非常有趣的 java 问题：

在发现书籍印刷之前，书籍是由某些称为“作家”的人复制的。簿记员有一叠 N 本书需要复制。为此，他有 K 个作家。每本书可以有不同的页数，每个作者只能从堆栈顶部取书（如果他取书 1，那么他可以取书 2，但不能取书 4 或书 5）。簿记员知道每本书的页数，他需要在作者之间共享书籍，以使作者必须复制的最大页数尽可能少。例如，当然不能拆分页面你不能把一本 30 页的书分成 15 页和 15 页。

例如，如果我们有 7 本书，有 3 位作者，并且相应的书籍页数为：30 50 5 60 90 5 80，那么最佳解决方案是第一个作者拿前 4 本书，第二位作者拿下本书，第三位拿下本书。最后两本书，所以我们会有：

第 1 = 145 页
第 2 = 90 页
第 3 = 85 页

所以程序是编写一个算法来找到在作者之间共享页面的最佳解决方案。因此，在程序结束时，您必须显示每个人获得了多少页。

这是几年前的一次编程比赛，我想试一试，到目前为止我发现如果你把所有书籍的总页数除以你在例如 106.66 页，然后您尝试将堆栈中最接近该数字的连续书籍提供给每个作者，但这对于大页码根本不起作用，特别是如果一本书的页数超过总页数页数除以作者数

因此，如果您愿意，请分享您的意见并提供提示和提示，数学或其他，这是一个非常有趣的算法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:06:47.603

让我们假设您有书 1...n，页面为 b1,b2,...,bn。假设你有 K 个作家。

初始化一个矩阵 F[1...n,1...K]=infinity。

令 F[i,1]= sum_j=1..i (bj)

现在，对于每 k=2..K

F[i,k] = min_j=1..i( max(F[j,k-1], sum_r=j+1..i (br) )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T20:08:39.287

我想出了一个直截了当的解决方案，可能效率不高，但逻辑有效。基本上你从作家的数量开始与书籍的数量相同，然后减少直到你有你的作家数量。

举个例子。假设你从你的七个值开始，30 50 5 60 90 5 80。对于每一步，你通过总结“最低对”来减少一个。粗体的值是进行到下一次迭代的对。

7
30 **50 5** 60 90 5 80
6
30 55 60 90 **5 80**
5
**30 55** 60 90 85
4
**85 60** 90 85
3
145 90 85

通过一些伪编程，这个例子展示了它是如何实现的

```
main(books: { 30 50 5 60 90 5 80 }, K: 3)

define main(books, K)
  writers = books
  while writers.length > K do
    reduceMinimalPair(writers)
  endwhile
end

define reduceMinimalPair(items)
  index = 0
  minvalue = items[0] + items[1]
  for i in 1..items.length-1 do
    if items[i] + items[i + 1] < minvalue then
      index = i
      minvalue = items[i] + items[i + 1]
    endif
  endfor
  items.removeat(index)
  items.removeat(index + 1)
  items.insertat(index, minvalue)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:56:47.167

我认为您认为的方式是正确的，但是如果您说它不适用于大数字，那么也许您应该检查是否存在比平均值更大的数字并在这种情况下做其他事情。也许删除数字并从一开始就将其提供给作家或类似的东西

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T18:54:10.777

除了使用动态编程解决它之外，您还可以二进制搜索每个人都不会复制超过此页数的页数上限。当这个数字收敛时，这就是答案。

# c - 架构 x86_64“_min”的未定义符号

> ID：10365683
> 
> 赞同：0
> 
> 时间：2012-04-28T17:05:41.700
> 
> 标签：c, macos, 64-bit, osx-lion, math.h

我在 C 项目中使用 min() 和 max() 函数时遇到问题。我已经导入了 math.h，但是当我编译文件时，我不断收到以下错误（即使使用 gcc 而不是 llvm，也会显示类似的错误）：

```
 Undefined symbols for architecture x86_64:
  "_min", referenced from:
      _main in main.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我认为问题在于没有 64 位的 math.h 库……或者编译器找不到它。我正在使用 Mac OS X 10.7。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:27:26.930

尽管我可以看到 libSystem.dylib 中定义的“min”，但我认为没有导出的标头。就包含文件而言，我无法弄清楚“_min”的来源。

通常使用宏或您*自己的*函数来引用“min”。[查看其他人不久前提出的这个非常相关的问题。](https://stackoverflow.com/questions/3437404/min-and-max-in-c)

如果你查看 math.h，那里有一些“min”类型的函数，但它们用于浮点数和双精度数。如果您只是使用整数或自定义类型，请滚动您自己的函数。

# php - 将上传图片的路径更新到数据库中

> ID：10365688
> 
> 赞同：0
> 
> 时间：2012-04-28T17:06:21.743
> 
> 标签：php, mysql, sql

这是编辑插入的行、具有图像路径名称的字段的正确方法吗？

```
$query = "UPDATE products SET image = $_FILES["file"]["name"] WHERE name = $name"; 
```

我更关心 sql 语法，然后是 php。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:12:42.427

您需要在字符串周围加上引号，并且您应该确保清理输入（或者更好的是，使用参数化 - 请参阅[Bobby Tables](http://bobby-tables.com/)）。

```
$filename = mysql_real_escape_string($_FILES['file']['name']);
$name = mysql_real_escape_string($name);

$query = "UPDATE products SET image = '{$filename}' WHERE name = '{$name}'"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:11:23.987

您需要单引号，并且可能需要 mysql_real_escape_string

```
$query = "UPDATE products SET image = '".mysql_real_escape_string($_FILES["file"]["name"])."' WHERE name = '$name'"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:12:15.720

注意报价

```
$query = "UPDATE products SET image ='". mysql_real_escape_string($_FILES["file"]["name"]) ."' WHERE name ='". $name."'"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T17:13:07.223

```
$query = sprintf('UPDATE products SET image="%s" WHERE name="%s"',
    mysql_escape_string($_FILES["file"]["name"]),
    mysql_escape_string($name)
); 
```

# asp.net-mvc-4 - 在 ASP.NET MVC4 WebAPI 中实现 ETag 支持

> ID：10365689
> 
> 赞同：17
> 
> 时间：2012-04-28T17:06:31.347
> 
> 标签：asp.net-mvc-4, asp.net-web-api

在最新的 ASP.NET MVC4 测试版中，您将如何通过 ETags 支持条件 GET 支持？ActionFilter 需要能够完成为返回的资源生成 ETag 的请求，以便与请求中的 If-None-Match 标头进行比较。然后，不管 If-None-Match 头中传入的 ETag 是否与生成的 ETag 相同，都将生成的 ETag 添加到 ETag 响应头中。但是对于 ASP.NET MVC4，我不知道从哪里开始。有什么建议么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-04T15:27:37.797

就个人而言，我不喜欢“框架魔法”，更喜欢 web 方法中的普通旧代码，否则我们最终会得到更类似于 WCF 的东西，yuk。

因此，在您的 Get web 方法中，手动创建响应，如下所示：

```
var response = this.Request.CreateResponse(HttpStatusCode.OK, obj);
string hash = obj.ModifiedDate.GetHashCode().ToString();

response.Headers.ETag =
    new EntityTagHeaderValue(String.Concat("\"", hash, "\""), true);

return response; 
```

请注意，由时间戳的哈希码生成的 ETag 纯粹是一个弱实体标记系统的说明。它还显示了所需的附加报价。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-04T13:21:02.133

~~WebApiContrib 中有一个 ETagMessageHandler[可以满足](https://github.com/WebApiContrib/WebAPIContrib/blob/master/src/WebApiContrib/MessageHandlers/ETagHandler.cs)您的需要。~~

* * *

# 更新

我已经在 WebApiContrib 中实现了 RFC 2616 的服务器端缓存。寻找 CachingHandler。更多信息[在这里](http://byterot.blogspot.co.uk/2012/06/aspnet-web-api-caching-handler.html)。

* * *

# 更多更新

这将在**[CacheCow](https://github.com/aliostad/CacheCow)**下积极开发和扩展。这将包括客户端和服务器组件。~~即将发布的~~[NuGet 包](http://nuget.org/packages?q=cachecow) 现已发布。

 ~~*WebApiContrib 的 CachingHandler 仍将得到维护，因此如有任何错误或问题，请告诉我。*

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-12-14T22:25:55.120

Luke Puplett 的回答让我走上了正轨（+1），但请注意，您还必须阅读服务器端的 ETag 以避免在每个请求中发送所有数据：

```
string hash = obj.ModifiedDate.GetHashCode().ToString();
var etag = new EntityTagHeaderValue(String.Concat("\"", hash, "\""), true);

if (Request.Headers.IfNoneMatch.Any(h => h.Equals(etag)))
{
    return new HttpResponseMessage(HttpStatusCode.NotModified);
}

var response = this.Request.CreateResponse(HttpStatusCode.OK, obj);
response.Headers.ETag = etag;
return response; 
```

`If-Modified-Since`尊重标题也是一个好主意。请参阅[RFC 2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.26)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-27T18:14:16.380

看来这就是您要寻找的内容（请参阅“支持 ETags”部分）：

[http://blogs.msdn.com/b/webdev/archive/2014/03/13/getting-started-with-asp-net-web-api-2-2-for-odata-v4-0.aspx](http://blogs.msdn.com/b/webdev/archive/2014/03/13/getting-started-with-asp-net-web-api-2-2-for-odata-v4-0.aspx)

如果您的模型存储在更深的域中并且您无法应用 [ConcurrencyCheck] 属性，则可以使用 ODataModelBuilder 执行此操作：

```
ODataModelBuilder builder = new ODataConventionModelBuilder();
var myEntity = builder.EntitySet<MyEntity>("MyEntities"); 
myEntity.EntityType.Property(l => l.Version).ConcurrencyToken = true; 
```

这将使其将“@odata.etag”属性添加到响应正文中。~~

# c++ - 在这种情况下，来自 VS2010 的 MS C++ 与其他编译器的行为有何不同？

> ID：10365691
> 
> 赞同：1
> 
> 时间：2012-04-28T17:06:36.333
> 
> 标签：c++, visual-studio-2010

我已经在这里解决了我的问题，但我不明白它为什么会起作用，或者 MS 是否在这里。我没有编写此代码，但我维护它。它是 DSP 应用程序的一部分，将数据作为位向量处理，并且有时必须将它们从字节中打包和解包。

这些是打包和拆包的方法

```
template<class TData> void CVector<TData>::Enqueue(uint32_t iInformation, const int iNumOfBits)
{
    /* Enqueue bits in bit array */
    for (int i = 0; i < iNumOfBits; i++)
    {
        /* We want to put the bits on the array with the MSB first */
        /* Shift one bit to mask next bit at LSB-position */
        operator[](iBitArrayCounter + iNumOfBits - i - 1) = _BINARY(iInformation & 1);
        iInformation >>= 1;
    }
    iBitArrayCounter += iNumOfBits;
}

template<class TData> uint32_t CVector<TData>::Separate(const int iNumOfBits)
{
    uint32_t iInformation;
    if (iBitArrayCounter + iNumOfBits > iVectorSize)
        return 0;
    /* Separate out bits from bit-array */
    iInformation = 0;
    for (int i = 0; i < iNumOfBits; i++)
    {
        /* MSB comes first, therefore shift left */
        iInformation <<= 1;
        iInformation |= pData[iBitArrayCounter + i] & 1;
    }
    iBitArrayCounter += iNumOfBits;
    return iInformation;
} 
```

在哪里

```
typedef unsigned char _BINARY; 
```

现在，这已经在 Windows、Mac 和 linux 上的连续 MS 编译器和 gcc 上工作了很多年。它仍然适用于调试模式下的所有编译器。在发布模式下的 MSVC9（我认为这是 Visual Studio 2010 的版本）中，我必须将 Enqueue 方法中的行从：

```
 operator[](iBitArrayCounter + iNumOfBits - i - 1) = _BINARY(iInformation & 1); 
```

至：

```
 if(iInformation & 1)
            operator[](iBitArrayCounter + iNumOfBits - i - 1) = 1;
        else
            operator[](iBitArrayCounter + iNumOfBits - i - 1) = 0; 
```

该类是用 TData = _BINARY 实例化的。问题似乎是符号扩展，但入队和分离不是对称的。例如 65 被编码，然后分离为 193。

这是实际代码[http://drm.cvs.sourceforge.net/viewvc/drm/drm/common/util/Vector.h?view=log](http://drm.cvs.sourceforge.net/viewvc/drm/drm/common/util/Vector.h?view=log)的链接。1.8是修复。

我刚刚意识到应该用 TData 替换 _BINARY 宏，但在这种情况下，这无关紧要，因为无论如何都要用 _BINARY 实例化该类。

# php - 在html中获取php值

> ID：10365698
> 
> 赞同：-2
> 
> 时间：2012-04-28T17:07:13.860
> 
> 标签：php, html, forms, htmlfill

我试图在 html 文件中显示从数据库中检索到的名称。参考了几个博客，我仍然无法显示价值

```
<?php
$result=mysql_query("SELECT * from `Data`  where Emp_Id = $EmpID")
$info = mysql_fetch_array( $result );
$Emp_ID=$info['Emp_ID'];
<html><head>
<body>
<input  name="emp_number" value=<?php echo $Emp_ID?>/>
<input name='emp_name' value="<?php echo (isset($Emp_ID) ? htmlspecialchars($Emp_ID) : ''); ?>" />
<input name='emp_name'<?php echo (isset($Emp_Name)) ? ('value = "'.$Emp_Name.'"') : "value = \"\""; ?>/>

</body></head></html>
?> 
```

尝试了三种方法，但都没有奏效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:12:30.713

您应该使用模板系统。除此之外，试试这个：

```
<?php
$result=mysql_query("SELECT * from `Data`  where Emp_Id = $EmpID")
$info = mysql_fetch_array( $result );
$Emp_ID=$info['Emp_ID'];
?>

<html>
<body>

<input  name="emp_number" value=<?php echo $Emp_ID; ?>/>
<input name='emp_name' value="<?php echo (isset($Emp_ID) ? htmlspecialchars($Emp_ID) : ''); ?>" />
<input name='emp_name'<?php echo (isset($Emp_ID)) ? ('value = "'.$Emp_ID.'"') : "value = \"\""; ?>/>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:12:38.853

这是本周我第三次看到与此类似的问题。

*   请搜索 SO 并查找相关问题
*   $EmpID 从未被设置
*   您的代码易受 SQL 注入攻击，您的网站可能很快就会被黑客入侵
*   您的查询在 Emp_ID 和返回的结果 Emp_Id 之间存在差异
*   您有两个具有相同名称的输入字段，因此在 Post/Get 上只会返回一个
*   $Emp_Name 从未在任何地方设置（猜测它应该来自信息？）
*   同样在第三个输入中，您应该在回显“value =”字段之前留一个空格

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:09:52.553

看起来`Emp_ID`第三行应该是`Emp_Id`或第一`Emp_Id`行应该是`Emp_ID`。

# unit-testing - 如何在 xunit.net 中测试两个对象是否相等？

> ID：10365699
> 
> 赞同：8
> 
> 时间：2012-04-28T17:07:27.017
> 
> 标签：unit-testing, xunit.net

我正在阅读[测试驱动开发：示例](http://www.amazon.com/Test-Driven-Development-By-Example/dp/product-description/0321146530)。所有示例都使用 Java 和 Junit（我在第 10 章）。有一种测试方法可以测试两个对象是否相等。我已经覆盖了该类的 Equals 但是在运行我的测试时它失败了。

这是示例代码

```
public class BaseX
{
    public string Test { get; set; }

    public override bool Equals(object obj)
    {
        return this.Test == ((BaseX)obj).Test;
    }

    public override string ToString()
    {
        return string.Format("Tyep: {0}, Test: {1}", this.GetType().Name, this.Test);
    }
}

public class A : BaseX
{

} 
```

这是我的测试代码

```
[Fact]
public void FunTest2()
{
    var b1 = new BaseX();
    var a1 = new A();

    b1.Test = "a";
    a1.Test = "a";

    Assert.Equal(a1, b1);
} 
```

当我运行测试时，它将失败并显示此消息。

```
TDD1.UnitTest.UnitTest1.FunTest2 : Assert.Equal() Failure
Expected: Tyep: A, Test: a
Actual:   Tyep: BaseX, Test: a 
```

我认为`Assert.Equal`比较对象的值和类型。所以，我查看了 xunit 代码并找到了那个`Assert.Equal`call `IEqualityComparer.Equals`。如果我想用覆盖方法比较两个对象，我应该使用什么方法？

**更新**
我在**Windows 7**、**Visual Studio 11 Beta**、**xunit.net 1.9.0.1566**上测试（从 nuget 获取文件）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-29T15:49:19.803

Before comparing both objects using T's Equals method, xunit compares types:

```
// Same type?
if (!skipTypeCheck && x.GetType() != y.GetType())
    return false; 
```

As I see it, you have two choices:

**The simple choice**

```
Assert.True(b1.Equals(a1)); 
```

It might be less expected than an Equal overload, but KISS...

**The less simple choice**

```
public class BaseXComparer : IEqualityComparer<BaseX>
{
    public bool Equals(BaseX x, BaseX y)
    {
        return x.Test.Equals(y.Test);
    }

    public int GetHashCode(BaseX obj)
    {
        return obj.Test.GetHashCode();
    }
} 
```

And then:

```
Assert.Equal(a1, b1, new BaseXComparer()); 
```

In this case, consider [this](https://stackoverflow.com/questions/74032/whats-the-recommended-best-practice-for-using-iequalitycomparert).

Until someone will add a new overload (shouldn't be tricky, as the inner implementation has a bool parameter for this) or an extension, I'd recommend using the simple method above.

# c++ - 链接源文件

> ID：10365704
> 
> 赞同：2
> 
> 时间：2012-04-28T17:08:15.270
> 
> 标签：c++

我正在尝试将我编写的程序分解为两个源文件，但是在链接它们时遇到了问题，并且错误消息对我来说没有任何意义。

我将提供包含相关信息的文件的缩短版本：

```
//grandiose.cpp:

#include "thingy.h"

int main() {}

//thingy.h:
#include<string>
int add (int x, int y);
char * parse_input_fragment(const string & ,const string & , size_t &, size_t &);

//thingy.cpp:
#include "thingy.h"

int add (int x, int y)
{
    return x+y;
}

char * parse_input_fragment(const string & objective,const string & input, size_t & first_finder, size_t & second_finder) {
    char * string_to_int_buffer = new char[64];
    first_finder = input.find(objective, first_finder);
    first_finder = (input.find('=', first_finder))+1;
    second_finder = input.find(';', first_finder);
    int y = 0;
    for(unsigned int x = first_finder; x < second_finder; x++) {
        if (  (input[x] != ' ') && (input[x] != '\n') ) {
            string_to_int_buffer[y] = input[x];
            y++;
        }
    }
    string_to_int_buffer[y] = '\0';
    first_finder = second_finder;
    return string_to_int_buffer;
} 
```

如果我将 parse_input_fragment 函数放在 grandiose.cpp 中，它编译得很好，但是当我按照描述拆分它时会收到错误消息。我包括了“添加”功能用于测试目的，并且编译得很好。

我收到的错误消息是关于thingy.h 中的原型：错误C4430：缺少类型说明符-假定为int。注意：C++ 不支持默认整数

它被清楚地标记为字​​符指针返回类型，并且在没有从 grandiose.cpp 中拆分出来时可以工作，所以我对这里的问题感到很困惑。

**编辑：**

好的，在移动 using namespace std 之后；到适当的位置并按照建议包含标头保护，这些错误消息消失了，但我得到了新的消息，我对此感到更加困惑。我将包括完整的文件和错误消息。

错误消息：province.obj : error LNK2005: "public: __thiscall Province::province(void)" (??0province@@QAE@XZ) 已在 grandiose.obj 中定义

Province.obj : 错误 LNK2005: "public: __thiscall Province::province(class std::basic_string,class std::allocator >,int * const)" (??0province@@QAE@V?$basic_string@DU?$ char_traits@D@std@@V?$allocator@D@2@@std@@QAH@Z) 已经在 grandiose.obj 中定义

```
 // grandiose.cpp : Defines the entry point for the console application.
    //

    #include "stdafx.h"
    #include <vector>
    #include <ctime>
    #include <iostream>
    #include <fstream>
    #include <string>
    #include "market.h"

    int _tmain(int argc, _TCHAR* argv[])
    {
        market England;
        ifstream reader;
        reader.open ("provinces.txt", ios::in);
        if (reader.is_open()) {  //check if txt file successfully opened
            cout << "\n\nprovinces.txt was successfully opened.\n\n";
        }
        else {
            cout << "\n\nfile was not successfully opened.\n\n";
            return (1);
        }
        string reader_buffer;
        while ( reader.good() ) { // while not end of file
            getline (reader, reader_buffer, '}'); // get one province's worth of data from txt file
            if (!reader_buffer.empty()) {
                parse_provinces (reader_buffer); // send data to be parsed
            }
        }
        add(1,2);
        return 0;
    }

    //market.h

    #include <iostream>
    #include <list>
    #include "province.h"
    using namespace std;

    class market
    {
        public:
        list<province> provinces;
    };

    //province.h

    #ifndef PROVINCE_H
    #define PROVINCE_H
    #include <iostream>
    #include <string>

    using namespace std;

    int add (int x, int y);
    char * parse_input_fragment(const string & ,const string & , size_t &, size_t &);

    class province
    {
    public:
        province::province();
        province::province(string, int[]);
        unsigned int * rural_poor;
        unsigned int * urban_poor;
        unsigned int * max_mine_jobs;
        unsigned int * max_farm_jobs;
        unsigned int * employed_mine;
        unsigned int * employed_farm;
        unsigned int * employed_factory;
        string name;
    };
    province::province () {
        rural_poor = new unsigned int(0);
        urban_poor = new unsigned int(0);
        max_mine_jobs = new unsigned int(0);
        max_farm_jobs = new unsigned int(0);
        employed_mine = new unsigned int(0);
        employed_farm = new unsigned int(0);
        employed_factory = new unsigned int(0);
        name = "";
    }
    province::province (string name, int numbers[]) {
        province::name = name;
        cout << "This province is named " << province::name << endl;
        rural_poor = new unsigned int(numbers[0]);
        cout << "Rural poor = " << *rural_poor << endl;
        urban_poor = new unsigned int(numbers[1]);
        cout << "Urban poor = " << *urban_poor << endl;
        max_mine_jobs = new unsigned int(numbers[2]);
        cout << "Max mine jobs = " << *max_mine_jobs << endl;
        max_farm_jobs = new unsigned int(numbers[3]);
        cout << "Max farm jobs = " << *max_farm_jobs << endl;
    }

    province * parse_provinces(string);

    #endif

    //province.cpp

    #include "stdafx.h"
    #include "province.h"

    int add (int x, int y)
    {
        return x+y;
    }

    char * parse_input_fragment(const string & objective,const string & input, size_t & first_finder, size_t & second_finder) {
        char * string_to_int_buffer = new char[64];
        first_finder = input.find(objective, first_finder);
        first_finder = (input.find('=', first_finder))+1;
        second_finder = input.find(';', first_finder);
        int y = 0;
        for(unsigned int x = first_finder; x < second_finder; x++) {
            if (  (input[x] != ' ') && (input[x] != '\n') ) {
                string_to_int_buffer[y] = input[x];
                y++;
            }
        }
        string_to_int_buffer[y] = '\0';
        first_finder = second_finder;
        return string_to_int_buffer;
    }

    province * parse_provinces(string input) {
        size_t first_finder;
        size_t second_finder;
        char * string_to_int_buffer;
        int population_info[4];

        // find the name
        first_finder = input.find('=');
        string name;
        for(unsigned int x = 0; x < first_finder; x++) {
            if ((input[x] != ' ') && (input[x] != '\n')) {
                name.push_back(input[x]);
            }
        }

        // find the rural poor
        string_to_int_buffer = parse_input_fragment("rural_poor", input, first_finder, second_finder);
        population_info[0] = atoi(string_to_int_buffer);

        // find the urban poor
        string_to_int_buffer = parse_input_fragment("urban_poor", input, first_finder, second_finder);
        population_info[1] = atoi(string_to_int_buffer);

        // find max mine jobs
        string_to_int_buffer = parse_input_fragment("max_mine_jobs", input, first_finder, second_finder);
        population_info[2] = atoi(string_to_int_buffer);

        // find max farm jobs
        string_to_int_buffer = parse_input_fragment("max_farm_jobs", input, first_finder, second_finder);
        population_info[3] = atoi(string_to_int_buffer);

        delete[] string_to_int_buffer;
        string_to_int_buffer = NULL;
        province * current_province = new province(name, population_info);
        return current_province;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:18:17.417

即使您包含`<string>`，您也需要使用`std`命名空间来访问`string`类型：

```
#include<string>
using namespace std; 
```

该类型`string`位于 std 命名空间中，因此仅键入`string`不会命名已知类型。

或者，您可以在标头中替换所有出现的`string`with`std::string`并使用`using`.cpp 中的语句（实际上这是所需的做事方式，因为它避免了所有`std`函数和类型的全局命名空间。

Jason 的回答也是一个很好的建议：使用包含保护来保护您的标头，因此如果您两次（例如间接）包含相同的标头，您将不会因多个定义而出现编译器错误（C++ 有一个单一定义规则：所有类只能定义一次）。在您的特定情况下，这不是问题，但是养成避免后面问题的习惯是一件好事

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:15:11.697

正如您开始包含多个文件时的风格问题一样，您应该在头文件的顶部放置一个预处理器保护，以防止它们被包含两次并导致解析错误。例如，您应该在所有标题中放置以下内容：

```
//first thing at the top of the header
#ifndef THINGY_H
#define THINGY_H

//...the actual header code

//the very last line of the header
#endif //THINGY_H 
```

这样，如果在代码模块的编译过程中，你最终得到了一个包含两次的头文件，那么预处理器将已经定义了 header-guard 标记，因此，不会包含来自第二个头文件副本的代码.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:52:39.133

将您的实现移动到 cpp 文件或在标头中内联实现的构造函数/方法以解决链接器错误。

# asp.net-mvc - ASP.NET MVC 文件夹约定

> ID：10365710
> 
> 赞同：3
> 
> 时间：2012-04-28T17:08:48.337
> 
> 标签：asp.net-mvc, directory

ASP.NET MVC 项目遵循模型、视图和控制器的命名和文件夹约定。对于其他代码（例如：Action Filters、Delegating Handlers 等），是否有关于在项目文件夹结构中的何处定位这些代码的最佳实践？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:13:32.930

找出答案的一个好方法是查看实际的最佳实践是查看开源项目。IIRC NuGet Gallery 是由 Asp.Net MVC 人员编写的，因此它可以作为他们视为最佳实践的一个很好的例子，同时仍然是一个实际的产品：

[https://github.com/NuGet/NuGetGallery](https://github.com/NuGet/NuGetGallery)

看起来他们将他们的 FilterAttributes、HtmlHelpers 等添加到项目的根目录：[https ://github.com/NuGet/NuGetGallery/blob/master/Website/RequireRemoteHttpsAttribute.cs](https://github.com/NuGet/NuGetGallery/blob/master/Website/RequireRemoteHttpsAttribute.cs)

此外，[Phil Haack](https://github.com/haacked)和[David Ebbo](https://github.com/davidebbo/)在 Asp.Net MVC 团队工作，您可以查看他们的 GitHub 存储库，了解他们喜欢做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:46:23.270

没有这样的标准方法。不同的从业者提出了各种方法，但都各有利弊。但是，根据适用的设计约束，这里有一些提示：

1.  **可重用性**

    如果您希望您的操作过滤器、委托处理程序等可重用，那么将它们放在 asp.net mvc webroot 中的专用文件夹中就可以完成这项工作。这样，所有此类过滤器都将具有全局范围，并且可以根据需要使用。

2.  **可插拔性**

    如果想从过滤器等中创建一个可插入模块。将它们完全放在一个单独的 DLL 中可能是值得的。该库可以被认为是一个黑匣子，它将所有上下文信息作为函数输入，并且可以根据需要重用。我喜欢 Orchard CMS 的可插拔架构[http://www.orchardproject.net/](http://www.orchardproject.net/)

我曾经问过一个类似的问题，关于如何在 asp.net mvc 项目中组织模型。可惜没有得到太多回应。 [asp.net mvc 3 领域中的模型](https://stackoverflow.com/questions/9071342/models-in-asp-net-mvc-3-areas)

# visual-studio-2010 - 如何知道 ListView 中的哪一行被选中？

> ID：10365711
> 
> 赞同：0
> 
> 时间：2012-04-28T17:09:13.817
> 
> 标签：visual-studio-2010, c++-cli

我正在开发一个简单的窗口窗体程序。该程序有一个 ListView。我需要知道 ListView 中的哪一行被选中。我怎么能这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:11:02.260

查看[ListView 类的文档](http://msdn.microsoft.com/en-us/library/system.windows.controls.listview.aspx)，有各种以 开头的属性`Selected`。

# php - 仅用于帖子的模板

> ID：10365720
> 
> 赞同：0
> 
> 时间：2012-04-28T17:11:01.647
> 
> 标签：php, css, wordpress, templates, wordpress-theming

我有一个 catefory 模板，它通过“博客”类别循环浏览我的帖子，并将它们设置为仅带有摘录的缩略图类型列表。然后我使用永久链接让某人去完整地阅读这篇文章。但是现在我不知道如何根据模板文件来处理这个问题。

这是我的类别博客模板页面... [http://louiseguchi.co.uk/?category_name=blog](http://louiseguchi.co.uk/?category_name=blog)

目前，永久链接转到这种 url 结构... [http://louiseguchi.co.uk/?p=202](http://louiseguchi.co.uk/?p=202)

如您所见，我的 vimeo showreel 的正常标题是默认标题。我不知道这里使用的是什么模板，也不知道如何制作正确的模板，它会被称为什么？

非常感谢您的时间和帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:39:36.803

我想我可能会误解你，但如果你不确定是什么模板生成了这个或那个页面，你可以安装一个插件来告诉你。例如插件[我正在查看什么模板](http://wordpress.org/extend/plugins/what-template-file-am-i-viewing/)。

如果您不确定其他模板可能对您有帮助 - 您可以查阅[wordpress codex 上的模板层次结构部分](http://codex.wordpress.org/Template_Hierarchy)。它提供了 wordpress 在创建页面时可能使用的所有模板的图片。希望对您有所帮助。

# php - 如何将一个数组平均拆分为 3 个数组

> ID：10365723
> 
> 赞同：0
> 
> 时间：2012-04-28T17:11:06.810
> 
> 标签：php, arrays, split

我有一个如下的一维数组。（它可以动态延伸到任何长度）

```
Array
(
[0] => Array
    (
        [city] => Trivandrum
        [citykey] => ab5416c6
    )

[1] => Array
    (
        [city] => Kochi
        [citykey] => 85cb7d9c
    )

[2] => Array
    (
        [city] => Alappuzha
        [citykey] => 4d5f200e
    )

[3] => Array
    (
        [city] => Mumbai
        [citykey] => 47d98024
    )

) 
```

现在我想把它分成 3 个数组。我的意思是我想将一个数组拆分为 3 个数组，如下所示。

```
 Array
(
[0] => Array
    (
        [city] => Trivandrum
        [citykey] => ab5416c6
    )
[1] => Array
    (
        [city] => Mumbai
        [citykey] => 47d98024
    )

)

Array
(
[0] => Array
    (
        [city] => Kochi
        [citykey] => 85cb7d9c
    )

)

Array
(
[0] => Array
    (
        [city] => Alappuzha
        [citykey] => 4d5f200e
    )

) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:14:35.117

```
$a = range(1,4); // example input array of 4 items
$n = 3; // number of pieces you want in the output array $b

$b = array_fill(0, $n, array());
for($i=0; $i<count($a); $i++) {
    $b[$i % $n][] = $a[$i];
}

print_r($b);

// if you need to split them out
list($a1,$a2,$a3) = $b; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:39:41.177

试试这个代码：

```
<?
$i=0;
$array=Array(0=> Array("city" => 'Trivandrum',
        "citykey" => 'ab5416c6'
    ),
1 => Array
    (
        "city" => 'Kochi',
        "citykey" => '85cb7d9c'
    ),
2 => Array
    (
        "city" => 'Alappuzha',
        "citykey" => '4d5f200e'
    ),
3 => Array
    (
        "city" => 'Mumbai',
        "citykey" => '47d98024'
    )
);
$array_0=array();
$array_1=array();
$array_2=array();
foreach ($array as $value)
  {
  $name='array_'.$i%3;
  $temp[0]=$value;
  $$name=array_merge_recursive($$name, $temp);
  $i++;
  }
echo '<pre>';
print_r($array_0);
print_r($array_1);
print_r($array_2);
echo '</pre>';
?> 
```

你的原始数组应该在变量**$array**

# google-chrome - 谷歌浏览器在正文标签中编写自己的内联样式

> ID：10365734
> 
> 赞同：2
> 
> 时间：2012-04-28T17:12:48.743
> 
> 标签：google-chrome

这是网站：www.luckybabynames.in

该站点背景完美地出现在 Firefox 和 Internet Explorer 中。但是现在问题出在谷歌浏览器上。

这是身体背景的CSS

```
body {
background: url("images/img01.gif") repeat-x scroll 0 0 #FFFFFF;
color: #333333;
font-family: Georgia,"Times New Roman",Times,serif;
font-size: 12px;
text-align: justify;   } 
```

正文标签中没有内联样式

但是在页面完全加载后的谷歌浏览器中，它在正文标签中编写了一些内联样式。

```
<body style="postion: absolute; width: 1583px; height: 449px; background-position-x: 0px; background-position-y: 34px !important; " class="backgroundPositionTuned"> 
```

但实际上没有样式，甚至没有class="backgroundPostionTuned"！

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:23:13.880

这个先前的问题表明这种行为可能是由 uTorrentControl 扩展引起的：

[Chrome更改背景图像位置](https://stackoverflow.com/questions/9889776/chrome-changing-background-image-position)

# iphone - iOS iPhone 是否可以克隆 UIView 并将其自身绘制到两个 UIView 上？

> ID：10365735
> 
> 赞同：14
> 
> 时间：2012-04-28T17:12:56.673
> 
> 标签：iphone, ios, uiview, quartz-graphics

我正在考虑一种将 UIView 呈现到另一个 UIView 以及第一个 UIView 的方法。所以我有我的主 UIView 的边界，并且 UIView 也在其他一些 UIView 中呈现自己。

这可能吗 ？它是否需要广泛的图层操作？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-28T19:54:03.497

不知道您的真正意图是什么，但这将绘制两次视图，用户交互等将不适用于第二个视图。此外，此解决方案不考虑不同的帧大小。

要克隆的视图的标题

```
@interface SrcView : UIView
@property(nonatomic, readonly, strong) UIView *cloneView;
@end

@interface CloneView : UIView
@property(nonatomic, weak) UIView *srcView;
- (id)initWithView:(UIView *)src;
@end 
```

要克隆的视图的实现

```
#import "SrcView.h"
#import "CloneView.h"

@implementation SrcView
@synthesize cloneView;

- (void)drawLayer:(CALayer *)layer inContext:(CGContextRef)ctx{
    [cloneView setNeedsDisplay];
}

- (UIView *)cloneView {
    if (!cloneView) {
        cloneView = [[CloneView alloc] initWithView:self];
    }
    return cloneView;
}

@end

@implementation CloneView
@synthesize srcView;

- (id)initWithView:(UIView *)src {
    self = [super initWithFrame:src.frame];
    if (self) {
        srcView = src;
    }
    return self;
}

- (void)drawRect:(CGRect)rect
{
    [srcView.layer renderInContext:UIGraphicsGetCurrentContext()];
}

@end 
```

现在您可以调用 cloneView 并将其添加到您想要的位置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-28T17:19:12.243

这似乎是 StackOverflow 上经常被问到的问题。例如：

[iphone, ipad 重复 UIView - 克隆视图](https://stackoverflow.com/questions/4790225/iphone-ipad-duplicate-uiview-cloned-view)

[将一个 UIView 的绘制内容复制到另一个](https://stackoverflow.com/questions/4034860/copying-the-drawn-contents-of-one-uiview-to-another)

[UIView 重复](https://stackoverflow.com/questions/2131351/uiview-duplicate)

[复制、克隆或复制 UIView](https://stackoverflow.com/questions/5004055/duplicate-clone-or-copy-uiview)

但如果是我这样做，我的第一种方法是获取`UIView`我想要复制的句柄，然后递归地迭代所有`subviews`它，然后将它们作为子视图*复制*`UIView`并添加到我想要将主 UIView 复制到的子视图中。

我无法想象有太多的层操作正在进行，但您可能需要弄清楚如何以编程方式重新建立出口和/或操作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-09T06:14:22.973

没有简单的方法可以克隆一个视图，然后通过一行代码更新两个视图。因为它们底层的 CALayers 是不同的。但是对于复制 UIView，您可以使用以下新方法：使用 UIView 的方法：

```
- (UIView *)snapshotViewAfterScreenUpdates:(BOOL)afterUpdates 
```

这是绘制视图的最快方法。在 iOS 7 中可用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-28T17:25:49.643

创建您希望“克隆”的 UIView 的另一个实例，并将其作为子视图添加到另一个视图。您并没有真正克隆 UIView*对象*，您只需创建它的另一个实例。

# javascript - 将矩阵单元显示为图块

> ID：10365737
> 
> 赞同：1
> 
> 时间：2012-04-28T17:13:05.250
> 
> 标签：javascript, jquery-ui, jquery-plugins, user-interface

我想以瓷砖的形式显示矩阵单元。当其中一个图块悬停时，插件应突出显示位于左侧和上方的带有图块的矩形。所有其他瓷砖都应该变暗。请建议任何 JQuery 插件将完成这项工作或它的一部分。尤其是动画好看的。
[突出显示的瓷砖](http://i.stack.imgur.com/bf2eY.gif)

# c++ - 视觉 6.0 并找到 mac 地址

> ID：10365739
> 
> 赞同：0
> 
> 时间：2012-04-28T17:13:10.967
> 
> 标签：c++, visual-c++

我如何在 c++ 中找到当前正在运行应用程序的计算机的 mac 地址，然后将该 mac 地址与某个 mac 地址进行比较？

所以假设我们要比较的某个mac地址是`AB-12-CD-34-EF-56`，如何找到运行应用程序的mac地址，然后将该mac地址与`AB-12-CD-34-EF-56`mac地址进行比较？

我已经在[http://www.codeguru.com/cpp/in/network/networkinformation/article.php/c5451/Three-ways-to-get-your-MAC-address.htm上尝试过方法 3](http://www.codeguru.com/cpp/i-n/network/networkinformation/article.php/c5451/Three-ways-to-get-your-MAC-address.htm)

但这在visual 6.0上不起作用，有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T17:06:33.057

这不是最简单的方法，而是跨不同版本的 Windows 操作系统最可靠的方法。您将不得不处理 COM。

查询有问题的 MACAddress 的 WMI Win32_NetworkAdapter 类。如果您要检查的 MAC 地址不存在，WMI 将返回空查询。

# c# - 点击控制

> ID：10365740
> 
> 赞同：1
> 
> 时间：2012-04-28T17:13:18.610
> 
> 标签：c#, windows-phone-7, xaml, object, controls

我使用一个位于其他控件上方的矩形来使它们变暗。现在，我仍然希望能够与矩形后面的控件进行交互，这个矩形永远不会有比他的视觉方面的另一种感觉。问题是，它会捕获所有点击等等，所以它是 ATM 的一个障碍。

xml

```
 <Rectangle Canvas.ZIndex="1"  Opacity="0" Name="shadow" Fill="Black"/> 
```

C＃

```
shadow.Opacity = Math.Round(1-(double)(App.Current as App).dimfactor / 255,2); 
```

(App.Current as App).dimfactor 是一个介于 150 和 255 之间的值。

如何处理？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:23:26.297

我不完全确定它在 WP7 中是否与 silverlight 相同，但你不能将 IsHitTestVisible 布尔设置为 false 吗？

`<Rectangle Canvas.ZIndex="1" IsHitTestVisible="false" Opacity="0" Name="shadow" Fill="Black"/>`

# php - Mod 重写在 SSL 上不起作用

> ID：10365746
> 
> 赞同：0
> 
> 时间：2012-04-28T17:13:42.567
> 
> 标签：php, apache, mod-rewrite

这是我的重写代码：

```
## File Security
<FilesMatch "\.(htaccess)$">
 Order Allow,Deny
 Deny from all
</FilesMatch>

#### Apache directory listing rules ####
DirectoryIndex index.php index.htm index.html
IndexIgnore *

#### Rewrite rules for SEO functionality ####

<IfModule mod_rewrite.c>
RewriteEngine On

#RewriteCond %{SERVER_PORT} 80
#RewriteRule ^(.*)$ https://www.genyx.co.uk/$1 [R,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !=/favicon.ico
RewriteRule ^(.*)\.html?$ index.php?seo_path=$1 [L,QSA]

</IfModule> 
```

但它不适用于 SSL 页面，例如：

[http://www.genyx.co.uk/terms-and-conditions.html](http://www.genyx.co.uk/terms-and-conditions.html)

和

[https://www.genyx.co.uk/terms-and-conditions.html](https://www.genyx.co.uk/terms-and-conditions.html)

有人可以帮我让它工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:31:44.777

编辑：

[http://www.genyx.co.uk/](http://www.genyx.co.uk/) -> 显示一些内容

[https://www.genyx.co.uk/](https://www.genyx.co.uk/) -> 显示默认的 Apache 站点“它可以工作！”

所以 SSL 服务器有不同的 DocumentRoot。如果您更改它，它应该可以按预期工作。

顺便说一下，请检查您的 SSL 证书。我假设您必须添加中间证书，否则您的一些访问者会收到警告，指出该站点未由受信任的实例签名。

编辑：您可以[自行检查](https://www.ssllabs.com/ssltest/analyze.html?d=https%3A%2F%2Fwww.genyx.co.uk%2F)您的 SSL 服务器是否一切正常，或者证书链是否不完整。

编辑2：

[您的证书提供者对中间证书](http://www.globalsign.com/support/intermediate/about-intermediates.php)有很好的描述。这里是下载它的地方[。](http://www.globalsign.com/support/intermediate/domainssl_intermediate2011.php)请参阅下面如何根据已安装的证书文件安装它。

```
# Apache configuration for specific virtual host ...
# start SSL/TLS
SSLEngine on
# set signed certificate file
SSLCertificateFile /etc/apache2/ssl/domain_certificate.crt
# set private key file
SSLCertificateKeyFile /etc/apache2/ssl/domain_certifikate.key
# set intermediate certificate / to complete the chain to the root certificate
SSLCertificateChainFile /etc/apache2/ssl/chain_certificate.crt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:17:55.783

我会审查这些规则的放置位置。我怀疑您可能将它们放在虚拟主机部分或您的 SSL vHost 不匹配的其他地方。

# android - 滚动时 ListView 中的进度条问题

> ID：10365747
> 
> 赞同：0
> 
> 时间：2012-04-28T17:13:48.127
> 
> 标签：android, listview, scroll, progress-bar

我正在实施一个列表视图来显示按团队分隔的成员。有进度条显示每个成员的工作权重以及到目前为止他们完成了多少。该列表似乎正确显示，但是当我上下滚动时，进度条意外更改。这是代码。

```
public class MyCursorAdapter extends CursorAdapter{

private static final int STATE_UNKNOWN = 0;

private int requiredJob;
private static final int STATE_SECTIONED_CELL = 1;
private static final int STATE_REGULAR_CELL = 2;
private int[] mCellStates;

public MyCursorAdapter(Context context, Cursor cursor, int requiredJob) {
    super(context, cursor);
    mCellStates = cursor == null ? null : new int[cursor.getCount()];
    this.requiredJob=requiredJob;
}

@Override
public void changeCursor(Cursor cursor) {
    super.changeCursor(cursor);
    mCellStates = cursor == null ? null : new int[cursor.getCount()];
}

@Override
public void bindView(View view, Context context, Cursor cursor) {

    int memJob, memDone;
    final  ViewHolder holder= (ViewHolder)view.getTag();

    boolean needSeparator = false;
    final int position = cursor.getPosition();

    String team= cursor.getString(cursor.getColumnIndex(DBAdapter.COL_TEAM));

    switch (mCellStates[position]) {
        case STATE_SECTIONED_CELL:
            needSeparator = true;
            break;

        case STATE_REGULAR_CELL:
            needSeparator = false;
            break;

        case STATE_UNKNOWN:
        default:
            if (position == 0) {
                needSeparator = true;
            } else {

                cursor.moveToPosition(position-1);
                String str=cursor.getString(cursor.getColumnIndex(DBAdapter.COL_TEAM));
                if(!str.equalsIgnoreCase(String.valueOf(team))) {
                    needSeparator=true;
                }

                cursor.moveToPosition(position);
            }

            mCellStates[position] = needSeparator ? STATE_SECTIONED_CELL : STATE_REGULAR_CELL;
            break;
    }

    if (needSeparator) {
        holder.separator.setText(team);
        holder.separator.setVisibility(View.VISIBLE);
    } else{
        holder.separator.setVisibility(View.GONE);
    }

    holder.member.setText(cursor.getString(cursor.getColumnIndex(DBAdapter.COL_MEMBER)));

    memJob=cursor.getInt(cursor.getColumnIndex(DBAdapter.COL_MEMBER_JOB));
    memDone=(int)cursor.getInt(cursor.getColumnIndex(DBAdapter.COL_MEMBER_JOB_DONE));
    holder.pBar.getLayoutParams().width=(int)(400*memJob/requiredJob);
    holder.pBar.setMax(memJob);
    holder.pBar.setProgress(memDone);
}

@Override
public View newView(Context context, Cursor cursor, ViewGroup parent) {
    View v=LayoutInflater.from(context).inflate(R.layout.row, parent, false);
    ViewHolder holder= new ViewHolder();
    holder.separator=(TextView)v.findViewById(R.id.sep_team);
    holder.member=(TextView)v.findViewById(R.id.member);
    holder.pBar=(MyProgressBar)v.findViewById(R.id.pBar);

    v.setTag(holder);
    return v;
}
} 
```

希望你们能帮我修复代码。对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T19:11:06.433

尝试改变：

```
memJob=cursor.getInt(cursor.getColumnIndex(DBAdapter.COL_MEMBER_JOB));
memDone=(int)cursor.getInt(cursor.getColumnIndex(DBAdapter.COL_MEMBER_JOB_DONE));
holder.pBar.getLayoutParams().width=(int)(400*memJob/requiredJob);
holder.pBar.setMax(memJob);
holder.pBar.setProgress(memDone); 
```

至：

```
memJob=cursor.getInt(cursor.getColumnIndex(DBAdapter.COL_MEMBER_JOB));
memDone=(int)cursor.getInt(cursor.getColumnIndex(DBAdapter.COL_MEMBER_JOB_DONE));
ProgressBar progressBar = (ProgressBar) view.findViewById(R.id.pBar);
progressBar.getLayoutParams().width=(int)(400*memJob/requiredJob);
progressBar.setMax(memJob);
progressBar.setProgress(memDone); 
```

这将直接从 bindView 内部获得实际的进度条，并有望解决您的问题。你可以删除`holder.pBar=(MyProgressBar)v.findViewById(R.id.pBar); from newView.`

# css - 使用css位置定位一个动态加载的搜索结果框

> ID：10365748
> 
> 赞同：1
> 
> 时间：2012-04-28T17:14:12.447
> 
> 标签：css, position

这是它在我的机器中的样子：

![在此处输入图像描述](../Images/f45fe363232cb366964eb115d5e6bca0.png)

如果您[访问该站点](http://oracleoflegends.com/Tome/Champions)并搜索某些内容，我相信您会看到此框未对齐，因为您的显示器/分辨率可能与我的不同。

我的问题是，如何定位它，使其始终位于搜索框下方，而不管显示器的宽度如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:21:52.137

添加`position: relative`到`#mini-search-wrapper`. 然后，您可以根据`#mini-search-wrapper`-element 的位置对齐搜索结果。

`position: absolute`绑定到具有`position: relative`定义的下一个父元素。在这种情况下，您没有在元素上定义相对位置，因此它绑定到文档根目录，即 html 元素。

`position: fixed`始终绑定到文档根目录。

`position`浏览器中的默认值是`static`.

我希望这可以帮助您了解`position`-property 在 CSS 中的工作原理。

# java - 春季休眠异常

> ID：10365753
> 
> 赞同：9
> 
> 时间：2012-04-28T17:14:38.200
> 
> 标签：java, spring, hibernate

当我启动 SpringMVC 时，出现以下异常...

```
 Apr 28, 2012 6:08:23 PM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: /usr/bin/jdk1.7.0_03/jre/lib/amd64/server:/usr/bin/jdk1.7.0_03/jre/lib/amd64:/usr/bin/jdk1.7.0_03/jre/../lib/amd64:/usr/lib/jvm/java-6-openjdk/jre/lib/amd64/server:/usr/lib/jvm/java-6-openjdk/jre/lib/amd64:/usr/lib/jvm/java-6-openjdk/jre/../lib/amd64:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib
Apr 28, 2012 6:08:23 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.j2ee.server:spring-security-integration' did not find a matching property.
Apr 28, 2012 6:08:23 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:Spring3Hibernate' did not find a matching property.
Apr 28, 2012 6:08:23 PM org.apache.tomcat.util.digester.SetPropertiesRule begin
WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property 'source' to 'org.eclipse.jst.jee.server:assessment' did not find a matching property.
Apr 28, 2012 6:08:24 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
Apr 28, 2012 6:08:24 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["ajp-bio-8009"]
Apr 28, 2012 6:08:24 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 601 ms
Apr 28, 2012 6:08:24 PM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
Apr 28, 2012 6:08:24 PM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.26
Apr 28, 2012 6:08:24 PM org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring root WebApplicationContext
INFO : org.springframework.web.context.ContextLoader - Root WebApplicationContext: initialization started
INFO : org.springframework.web.context.support.XmlWebApplicationContext - Refreshing Root WebApplicationContext: startup date [Sat Apr 28 18:08:24 BST 2012]; root of context hierarchy
INFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from ServletContext resource [/WEB-INF/spring/root-context.xml]
INFO : org.springframework.beans.factory.support.DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@1c56295f: defining beans []; root of factory hierarchy
INFO : org.springframework.web.context.ContextLoader - Root WebApplicationContext: initialization completed in 234 ms
Apr 28, 2012 6:08:24 PM org.apache.catalina.core.ApplicationContext log
INFO: Initializing Spring FrameworkServlet 'appServlet'
INFO : org.springframework.web.servlet.DispatcherServlet - FrameworkServlet 'appServlet': initialization started
INFO : org.springframework.web.context.support.XmlWebApplicationContext - Refreshing WebApplicationContext for namespace 'appServlet-servlet': startup date [Sat Apr 28 18:08:24 BST 2012]; parent: Root WebApplicationContext
INFO : org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from ServletContext resource [/WEB-INF/spring/appServlet/servlet-context.xml]
INFO : org.springframework.context.annotation.ClassPathBeanDefinitionScanner - JSR-330 'javax.inject.Named' annotation found and supported for component scanning
INFO : org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor - JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
INFO : org.springframework.beans.factory.support.DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@768404fd: defining beans [org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping#0,org.springframework.format.support.FormattingConversionServiceFactoryBean#0,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter#0,org.springframework.web.servlet.handler.MappedInterceptor#0,org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver#0,org.springframework.web.servlet.mvc.annotation.ResponseStatusExceptionResolver#0,org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver#0,org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping,org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter,org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter,org.springframework.web.servlet.resource.ResourceHttpRequestHandler#0,org.springframework.web.servlet.handler.SimpleUrlHandlerMapping#0,org.springframework.web.servlet.view.InternalResourceViewResolver#0,dataSource,sessionFactory,homeController,userManagementController,userDao,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,org.springframework.web.servlet.view.ContentNegotiatingViewResolver#0,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; parent: org.springframework.beans.factory.support.DefaultListableBeanFactory@1c56295f
INFO : org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping - Mapped "{[/],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public java.lang.String org.assessme.com.HomeController.home(java.util.Locale,org.springframework.ui.Model)
INFO : org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping - Mapped "{[/userManagement/],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public java.lang.Object org.assessme.com.UserManagementController.home(java.util.Locale,org.springframework.ui.Model)
INFO : org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping - Mapped "{[/userManagement/getUser],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public org.assessme.com.entity.User org.assessme.com.UserManagementController.data(java.util.Locale,org.springframework.ui.Model)
INFO : org.springframework.web.servlet.handler.SimpleUrlHandlerMapping - Mapped URL path [/resources/**] onto handler 'org.springframework.web.servlet.resource.ResourceHttpRequestHandler#0'
ERROR: org.hibernate.tool.hbm2ddl.SchemaUpdate - could not get database metadata
com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown table 'sequences' in information_schema
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.Util.getInstance(Util.java:386)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3609)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2618)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2568)
    at com.mysql.jdbc.StatementImpl.executeQuery(StatementImpl.java:1557)
    at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:208)
    at org.apache.commons.dbcp.DelegatingStatement.executeQuery(DelegatingStatement.java:208)
    at org.hibernate.tool.hbm2ddl.DatabaseMetadata.initSequences(DatabaseMetadata.java:151)
    at org.hibernate.tool.hbm2ddl.DatabaseMetadata.<init>(DatabaseMetadata.java:69)
    at org.hibernate.tool.hbm2ddl.DatabaseMetadata.<init>(DatabaseMetadata.java:62)
    at org.hibernate.tool.hbm2ddl.SchemaUpdate.execute(SchemaUpdate.java:170)
    at org.hibernate.impl.SessionFactoryImpl.<init>(SessionFactoryImpl.java:386)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1385)
    at org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:954)
    at org.springframework.orm.hibernate3.LocalSessionFactoryBean.newSessionFactory(LocalSessionFactoryBean.java:860)
    at org.springframework.orm.hibernate3.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:779)
    at org.springframework.orm.hibernate3.AbstractSessionFactoryBean.afterPropertiesSet(AbstractSessionFactoryBean.java:211)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:567)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:631)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:588)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:645)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:508)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:449)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:133)
    at javax.servlet.GenericServlet.init(GenericServlet.java:160)
    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1266)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1185)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1080)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5015)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5302)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1566)
    at org.apache.catalina.core.ContainerBase$StartChild.call(ContainerBase.java:1556)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

重要的细节似乎在 ERROR: org.hibernate.tool.hbm2ddl.SchemaUpdate - could not get database metadata

我的 servlet-context.xml 如下...

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/mvc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <!-- DispatcherServlet Context: defines this servlet's request-processing 
        infrastructure -->

    <!-- Enables the Spring MVC @Controller programming model -->
    <annotation-driven />

    <!-- Handles HTTP GET requests for /resources/** by efficiently serving 
        up static resources in the ${webappRoot}/resources directory -->
    <resources mapping="/resources/**" location="/resources/" />

    <!-- Resolves views selected for rendering by @Controllers to .jsp resources 
        in the /WEB-INF/views directory -->
    <beans:bean
        class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <beans:property name="prefix" value="/WEB-INF/views/" />
        <beans:property name="suffix" value=".jsp" />
    </beans:bean>

    <beans:bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"
        destroy-method="close">
        <beans:property name="driverClassName" value="com.mysql.jdbc.Driver" />
        <beans:property name="url" value="jdbc:mysql://localhost/assessme" />
        <beans:property name="username" value="root" />
        <beans:property name="password" value="toor" />
    </beans:bean>

     <beans:bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <beans:property name="annotatedClasses">
        <beans:list>
            <beans:value>org.assessme.com.entity.User</beans:value>
        </beans:list>
    </beans:property>
        <beans:property name="dataSource" ref="dataSource" />
        <beans:property name="packagesToScan" value="data" />
        <beans:property name="hibernateProperties">
            <beans:props>
                <beans:prop key="hibernate.dialect">org.hibernate.dialect.H2Dialect</beans:prop>
                <beans:prop key="hibernate.current_session_context_class">thread</beans:prop>
                <beans:prop key="hibernate.transaction.factory_class">org.hibernate.transaction.JDBCTransactionFactory</beans:prop>
                <beans:prop key="hibernate.show_sql">true</beans:prop>
                <beans:prop key="hibernate.hbm2ddl.auto">update</beans:prop>
            </beans:props>
        </beans:property>
    </beans:bean>

    <context:component-scan base-package="org.assessme.com" />

    <beans:bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
        <beans:property name="mediaTypes">
            <beans:map>
                <beans:entry key="html" value="text/html" />
                <beans:entry key="json" value="application/json" />
            </beans:map>
        </beans:property>
        <beans:property name="defaultViews">
            <beans:list>
                <beans:bean
                    class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
                    <beans:property name="prefixJson" value="true" />
                </beans:bean>
            </beans:list>
        </beans:property>
    </beans:bean>

</beans:beans> 
```

我确定数据库的 url 详细信息和凭据是正确的，任何人都可以想到任何其他原因吗？

看起来它正在尝试访问 information_schema 数据库，但是在我的 XML 中，我设置了它应该查看的数据库......

```
<beans:bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"
        destroy-method="close">
        <beans:property name="driverClassName" value="com.mysql.jdbc.Driver" />
        <beans:property name="url" value="jdbc:mysql://localhost/assessme" />
        <beans:property name="username" value="root" />
        <beans:property name="password" value="toor" />
    </beans:bean> 
```

谢谢，

大卫

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-04-05T14:50:11.940

*我正在从不同答案的评论中提取这个问题的正确答案。*

抛出此异常是因为您使用的方言与数据库不匹配。

在您的配置中，您使用

```
<beans:prop key="hibernate.dialect">org.hibernate.dialect.H2Dialect</beans:prop> 
```

尽管您正在访问`MySQL`数据库。您应该改用`MySQL`方言。例如

```
<beans:prop key="hibernate.dialect">org.hibernate.dialect.MySQL5InnoDBDialect</beans:prop> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-28T17:24:03.050

看看你的错误：

```
ERROR: org.hibernate.tool.hbm2ddl.SchemaUpdate - could not get database metadata
com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown table 'sequences' in information_schema 
```

您将 MySQL 映射到 information_schema，它是 MySQL 中的系统数据库，并且该数据库不包含 sequances 表，

顺便说一句，您需要考虑到 MySQL 没有“CREATE Sequance”命令。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-02-24T03:46:11.783

让您将其添加到 application.properties 文件中

spring.jpa.database-platform=org.hibernate.dialect.MySQL5InnoDBDialect

错误将消失。

# actionscript-3 - FlashDevelop - 当 FD 连接到 Flash 11 调试器时浏览器崩溃

> ID：10365756
> 
> 赞同：1
> 
> 时间：2012-04-28T17:14:52.120
> 
> 标签：actionscript-3, flash, flash-cs5, flashdevelop

我刚刚升级为将我的 SWF 文件发布为 Flash 11。我想将 FlashDevelop 附加到 Firefox（或 IE）。我可以先附加它，但是在我第一次调用 PHP 文件后播放器崩溃（不确定它是否相关）并且调试器停止了。如果我只运行程序而不进行调试，它不会崩溃。

我怎样才能找出导致问题的原因？

这是我的设置：

*   Windows 7（32 位）上的 FlashDevelop 4.0.1 RTM

*   [已安装 - 来自http://www.adobe.com/support/flashplayer/downloads.html](http://www.adobe.com/support/flashplayer/downloads.html)的 Windows Flash Player 11.2 插件内容调试器（适用于与 Netscape 兼容的浏览器）（EXE，3.89MB）

*   在 FlashDevelop 中，我指向`Program->Settings->FlashViewer`flashplayer_11_plugin_debug_32bit.exe（我不确定这是否正确）。

我附加的方式是转到`Debug->Start Remote Session`. 然后启动加载我的 SWF 的 HTML 页面。

**更新：**我没有升级到 11.2 版本，而是升级到了 11.1 。现在我在输出窗口中得到了一些反馈。 `[Fault] exception, information=TypeError: Error #1009: Cannot access a property or method of a null object reference.`但是 FlashDevelop 并没有中断该异常，我没有看到文件名或行号可以帮助我找出错误发生的确切位置。

**更新：**我终于回滚到原来的 10.1.102.64 版本，现在 FlashDeveloper 在调试时没有崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T04:40:41.650

在浏览器中禁用 Flash 调试器插件。您是否从正在调试的浏览器访问相同的 SWF？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T21:23:09.123

当您调试 Flash 应用程序时，您会冻结线程，您的浏览器会认为应用程序已锁定或死机。然后它将尝试通过强制关闭导致问题的插件（在本例中为 Flash）来保存您的浏览会话。

要阻止 Firefox 这样做，请在地址栏中输入“about:config”（减引号）并按 Enter，然后在出现警告时单击“我会小心”。

通过在配置搜索栏中键入“dom.ipc.plugins.timeoutSecs”并将其值设置为 -1 来查找它。这将阻止浏览器关闭滞后的插件。

# css - 简单的 css：覆盖 div 移动了一个像素

> ID：10365764
> 
> 赞同：2
> 
> 时间：2012-04-28T17:15:52.447
> 
> 标签：css, html

我希望 text2 出现重叠但将 1 个像素移到 text1 的右侧（阴影效果，有点）。

我把每个都放在一个嵌套的div中，位置：相对；我设置了 z-index 1 和 2

但是，这两个文本仍然显示在另一个之下。解决方法是让 text2 中的顶部*减去*28，但是关于相对和 z-index 的概念我缺少什么？

HTML：

> ```
> <body>
> <div id='titles'>
>   <div id='text1'>Text For Testing This</div>     <div id='text2'>Text For Testing This</div>
> </div>
> </body> 
> ```

CSS：

> ```
> body {
>   font-family:Arial, Helvetica, sans-serif;
>   font-size:62.5%;
>   background-color:#666666;
> }
> #titles {
>   color:#FFFFFF;
>   width:800px;
>   font-size:2rem;
>   margin-left:auto;
>   margin-right:auto;
> }
> #text1 {
>   position:relative;
>   width:98%;
>   top:8px;
>   left:8px;
>   z-index:1;
>   }
> #text2  {
>   position:relative;
>   width:98%;
>   top:8px;
>   left:9px;
>   color:#000000;
>   z-index:2;
>   } 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:20:56.607

您将希望位置是绝对的而不是相对的。因为 relative 将其相对于前一个元素，而 absolute 将其相对于其父元素。[请参阅此处的示例](http://jsfiddle.net/Luey2/1/)。

```
#titles {
  position:relative;
  color:#FFFFFF;
  width:800px;
  font-size:2rem;
  margin-left:auto;
  margin-right:auto;
}
#text1 {
  position:absolute;
  width:98%;
  top:8px;
  left:8px;
  z-index:2;
  }
#text2  {
  position:absolute;
  width:98%;
  top:10px;
  left:10px;
  color:#000000;
  z-index:1;
  }​​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:21:21.347

```
#text1 {
   position:absolute; // it's relative in your css
   width:98%;
   top:8px;
  left:8px;
  z-index:1;
}
#text2  {
  position:absolute; // it's relative in your css
  width:98%;
  top:8px;
  left:9px;
  color:#000000;
  z-index:2;
} 
```

[**演示。**](http://jsfiddle.net/heera/mrLg8/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:21:57.857

您需要将`text1, text2`位置设置为绝对位置并将`titles`位置设置为相对位置，然后文本 div 将相对于标题进行定位。

```
#titles {
  position:relative;
  color:#FFFFFF;
  width:800px;
  font-size:2rem;
  margin-left:auto;
  margin-right:auto;
}
#text1 {
  position:absolute;
  width:98%;
  top:8px;
  left:8px;
  z-index:1;
}
#text2  {
  position:absolute;
  width:98%;
  top:8px;
  left:9px;
  color:#000000;
  z-index:2;
} 
```

# regex - Sed 和正则表达式

> ID：10365766
> 
> 赞同：1
> 
> 时间：2012-04-28T17:16:17.340
> 
> 标签：regex, linux, sed

我有这个问题：我有一个 CSV 文件，其中包含一些这种格式的数据：

```
100,30,1.704,,7
101,,suka,,5 
```

我应该在 mysql 表中导入这个 CSV

如您所见，此 csv 有空字段，用双逗号 ',,' 表示。我想使用 sed 和正则表达式，定义模式**，**如果匹配，用我的 csv 文件中的数字**58替换它。**任何人都可以帮助我，我不太了解正则表达式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T18:08:07.323

这可能对您有用：

```
sed ':a;s/,,/,58,/g;ta' file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:24:14.027

像这样的东西应该可以解决问题：

```
sed -e 's/,,/,58,/g' 
```

它将搜索 ('s') 或 ',,' 并将其替换为 ',58,' 以查找所有出现 ('g'; 而不是仅第一次出现))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-30T12:23:44.457

在 Vi 编辑器中，进入命令模式并输入以下内容：

```
:%s/,,/,58,/g 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-28T17:26:50.813

如果您需要正则表达式选项，您可以尝试使用 notepad++。打开搜索和替换将搜索模式设置为“正则表达式”替换`,,`为`,58`。`,,,,,,,,`我刚刚尝试过，它的工作原理......`,58,58,58,58`

# php - PHP排序包含双精度的多维数组

> ID：10365769
> 
> 赞同：2
> 
> 时间：2012-04-28T17:16:35.020
> 
> 标签：php, multidimensional-array, sorting

我正在尝试按评级对这个多维数组进行排序。

```
Array
(
    [0] => Array
        (
            [id] => 4
            [image] => test-image.gif
            [name] => Mia Panton
            [description] => From Falkirk
Wearing: River Island
            [month] => 04-2012
            [rating] => 0.0000
            [votes] => 0
        )

    [1] => Array
        (
            [id] => 3
            [image] => test-image.gif
            [name] => Sam Jane Raggett
            [description] => From: Falkirk
Fav Shop: Republic
            [month] => 04-2012
            [rating] => 1.0000
            [votes] => 1
        )

    [2] => Array
        (
            [id] => 2
            [image] => test-image.gif
            [name] => Sasha Westbrooke
            [description] => From Falkirk
Wearing: River Island
            [month] => 04-2012
            [rating] => 4.0000
            [votes] => 2
        )

    [3] => Array
        (
            [id] => 1
            [image] => test-image.gif
            [name] => Max Rose-Collins
            [description] => From: London
Fav Shop: blah
            [month] => 04-2012
            [rating] => 3.3333
            [votes] => 6
        )

) 
```

我正在使用它来这样做

```
function orderByRating($a, $b) {
    return $a['rating'] - $b['rating'];
}
usort($array, 'orderByRating'); 
```

但是正如您所看到的，它似乎不起作用，因为 0 在顶部，然后是 1，然后是 4，然后是 3。我不确定这是否与数字是双倍的事实有关？！

任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T17:21:56.203

使用谷歌[http://www.php.net/manual/en/function.uasort.php#100325](http://www.php.net/manual/en/function.uasort.php#100325)（并略有修正）

```
function sorting($a, $b)
{
    $d = $a['rating'] - $b['rating'];
    return $d < 0 ? -1 : ($d > 0 ? 1 : 0);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:49:08.637

另一种方法：
由 Lohoris 发布 (http://stackoverflow.com/a/2699110/1363184)

```
function aasort (&$array, $key) {
    $sorter=array();
    $ret=array();
    reset($array);
    foreach ($array as $ii => $va) {
        $sorter[$ii]=$va[$key];
    }
    asort($sorter);
    foreach ($sorter as $ii => $va) {
        $ret[$ii]=$array[$ii];
    }
    $array=$ret;
}

aasort($test,"rating"); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-28T17:22:40.883

您不应该返回 ab，因为当 ab 小于 0 时，它会平等对待。

例如，请查看此代码。

```
<?php
$array = array(1.0,2.9,3.5,4.3);
function orderByRating($a, $b) {
    return $a - $b;
}
function orderByRating2($a, $b) {
    if($a>$b)
        return 1;
    if($a<$b)
        return -0;
    return 0;
}
usort($array, 'orderByRating'); // 1,3.5,2.9,4.3
usort($array, 'orderByRating2'); //1,2.9,3.5,4.3

print_r($array); 
```

# ruby - ruby - 填充组合框

> ID：10365770
> 
> 赞同：0
> 
> 时间：2012-04-28T17:16:45.613
> 
> 标签：ruby, ruby-on-rails-3

我有两个对象成分和来源。
每种成分都有一个来源，所以在我有 origin_id
的成分中，视图显示

```
<p>
  <b>Name:</b>
  <%= @ingredient.name %>
</p>

<p>
  <b>Origin:</b>
  <%= @ingredient.origin_id %>
</p> 
```

类成分声明如下

```
class Ingredient < ActiveRecord::Base
  has_and_belongs_to_many :recipes
  belongs_to :origin

  attr_accessible :name, :origin_id
end 
```

阶级起源

```
class Origin < ActiveRecord::Base
  attr_accessible :name
end 
```

在我写的编辑表格中，它有效

```
<% originsArray = Origin.all.map { |origin| [origin.name, origin.id] } %>
  <div class="field">
    <%= f.label :origin_id %><br/>
    <%= f.select(:origin_id, originsArray) %><br/>
</div> 
```

但如果我改为写（如在所有教程中）

```
 <%= collection_select(:origin, :id, @origins, :id, :name, options ={:prompt => "-Select a payment"}, :class =>"origin") %> 
```

我明白了

```
undefined method `map' for nil:NilClass 
```

我应该解决什么问题？

编辑添加：

def edit @ingredient = Ingredient.find(params[:id]) @origins = Origin.all end

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:23:49.227

我在这里看不到 @origins 的声明位置。似乎您的 @origins 只是 nil 而不是集合。

# c++ - 字符串c ++中的分隔符

> ID：10365772
> 
> 赞同：0
> 
> 时间：2012-04-28T17:16:59.870
> 
> 标签：c++

这是要求：读取一个字符串并循环它，每当遇到一个新单词时将它插入到 std::list 中。如果 . 字符在左边有一个空格、制表符、换行符或数字，在右边有一个数字，那么它被视为小数点，因此是单词的一部分。否则，它将被视为句号和单词分隔符。

这是我从模板程序运行的结果：

```
foo.bar -> 2 words (foo, bar)
f5.5f -> 1 word
.4.5.6.5 -> 1 word
d.4.5f -> 3 words (d, 4, 5f)
.5.6..6.... -> 2 words (.5.6, 6) 
```

第一次处理字符串 c++ 对我来说似乎很复杂。我真的坚持实现代码。谁能给我一个提示？谢谢

我只是做了一些临时的想法

```
bool isDecimal(std::string &word) {
    bool ok = false;
    for (unsigned int i = 0; i < word.size(); i++) {
        if (word[i] == '.') {
            if ((std::isdigit(word[(int)i - 1]) || 
                 std::isspace(word[(int)i -1]) || 
                 (int)(i - 1) == (int)(word.size() - 1)) && std::isdigit(word[i + 1]))
                ok = true;
            else {
                ok = false;
                break;
            }
        }
    }
    return ok;
}
    void checkDecimal(std::string &word) {
    if (!isDecimal(word)) {
        std::string temp = word;
        word.clear();
        for (unsigned int i = 0; i < temp.size(); i++) {
            if (temp[i] != '.')
                word += temp[i];
            else {
                if (std::isalpha(temp[i + 1]) || std::isdigit(temp[i + 1]))
                    word += ' ';
            }
        }
    }
    trimLeft(word);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:10:18.147

我认为您可能是从错误的方向解决问题。如果您将条件颠倒过来，似乎会容易得多。在伪代码骨架中为您提供一些指示：

```
bool isSeparator(const std::string& string, size_t position)
{
    // Determine whether the character at <position> in <string> is a word separator
}

void tokenizeString(const std::string& string, std::list& wordList)
{
    // for every character in string
        // if(isSeparator(character) || end of string)
            // list.push_back(substring from last separator to this one)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:33:55.023

我建议使用 flex 和 bison 和 c++ 实现来实现它

# objective-c - 表格视图单元格在修饰时不会失去突出显示

> ID：10365775
> 
> 赞同：3
> 
> 时间：2012-04-28T17:17:18.780
> 
> 标签：objective-c, cocoa-touch, uitableview

当我单击一个单元格时，它会选择它，但它在修饰时保持蓝色。我希望蓝色突出显示在修饰时留下（但重要的是它首先突出显示）。

[这篇文章](https://stackoverflow.com/questions/190908/how-can-i-disable-the-uitableview-selection-highlighting)中的最后一个答案提到了一些关于的内容`willSelectRowAtIndexPath:`，但我不知道如何使用它来做我想做的事情。另外，我确实需要`didSelectRowAtIndexPath:`被调用，我只是希望单元格在修饰时不突出显示。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T17:20:56.467

在适当的地方使用以下内容：

```
[tableView deselectRowAtIndexPath:indexPath animated:YES]; 
```

例如在`didSelectRowAtIndexPath`：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
      [tableView deselectRowAtIndexPath:indexPath animated:YES];
} 
```

这将取消选择指定索引路径处的行。

您也可能`clearsSelectionOnViewWillAppear`对`UITableViewController`. 如果此属性设置为 yes，则控制器会在表格出现时清除选择。默认情况下，它设置为 YES。

[参考](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableViewController_Class/Reference/Reference.html#//apple_ref/occ/instp/UITableViewController/clearsSelectionOnViewWillAppear)。

# scons - 在构建器调用时将值附加到环境变量

> ID：10365776
> 
> 赞同：2
> 
> 时间：2012-04-28T17:17:40.617
> 
> 标签：scons

问题如下：我有一个环境，其中一些变量定义如下：

```
env = Environment(CPPPATH=['#/include']) 
```

在某些情况下，我需要调用具有一些额外值的构建器，这些值不应永久添加到环境中，以免不必要地污染环境。

一种方法是通过将额外值与环境值合并来将额外值附加到构建器调用。

```
env.Object('test.c', CPPPATH=['#/some_other_include_path']+env['CPPPATH']) 
```

有没有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T18:32:19.470

我通过克隆 env 并附加到它来做到这一点，如下所示：

```
clonedEnv = env.Clone()
clonedEnv.Append(CPPPATH=['#anotherPath'])
clonedEnv.Object('test.c') 
```

一种更 Pythonic（和有效）的方式来做你正在做的事情是使用 python list.extend() 函数：

```
cpppath = ['path1', 'path2']
cpppath.extend(env['CPPPATH'])
env.Object('test.c', CPPPATH = cpppath) 
```

# ios - 将 iPhone 应用程序分发给测试人员？

> ID：10365781
> 
> 赞同：6
> 
> 时间：2012-04-28T17:18:14.093
> 
> 标签：ios, iphone, xcode, app-store-connect

我正在开发我的 iphone 应用程序，现在我想将我的应用程序发送给我的测试人员。但是我应该如何发送给他们？另外，他们没有 Xcode。有必要吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-28T17:21:21.923

看看试飞。我们目前正在使用它，它提供了很多很棒的工具，而且很容易设置。

[testflightapp.com](http://www.testflightapp.com)

它临时分发它，然后您可以将其直接推送给测试人员并允许您查看安装状态。花费的时间和其他分析工具。

回答您的其他问题。不需要 Xcode。他们只需要在你的苹果账户上注册他们的 UDID。他们将收到一封电子邮件，要求下载最新版本。然后该应用程序通过无线方式安装。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-28T17:24:19.970

自 iOS 4.0 以来，用户已经能够通过无线方式安装 Ad-Hoc 应用程序。请注意，您需要获取测试人员的设备 UDID，并将它们添加到 developer.apple.com 上的设备列表和应用程序的配置文件中。

您可以自己托管 IPA，但我建议使用[TestFlightApp.com](http://testflightapp.com/)。

[Macworld 写了一篇](http://www.macworld.com/article/1157311/testflight.html)关于它的要点的不错的文章，TestFlight 使用起来相当简单，特别是因为它允许您向测试人员发送电子邮件或链接并从他们那里收集所需的 UDID。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-28T18:06:09.837

试试[迪亚维](http://diawi.com)。我发现它使用起来非常简单且非常友好。*队列类型注册*的东西也没有等待。当您打开它时，只需拖放 .ipa 文件和配置文件。要验证您的应用程序是否已安装，只需在提及的字段中添加您的电子邮件 ID，您将收到一封有关您的应用程序安装的确认电子邮件。对于在测试人员端的安装，他们只需要 Safari 来安装应用程序和配置文件。

**以下是创建 .ipa 文件的步骤（xcode 4.2）**

选择 iOS 设备>转到产品>存档>共享>选择 iOS App Store 包 (.ipa)>提供保存路径。

轻松搞定！！！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-18T11:47:30.773

从 15 年 2 月 26 日起，Testflight 将关闭他们的服务...

我已使用新链接创建 ipa 的安装链接并将链接分发给您的客户端、测试人员等。

1.  打开这个链接

    [http://www.diawi.com/index.php](http://www.diawi.com/index.php)

2.  将配置文件（拖放）上传到他们的仪表板。

3.  将 ipa（拖放）上传到他们的仪表板。
4.  点击发送按钮。之后复制生成的链接并分享给您的客户和测试人员。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-12T07:12:56.123

使用 iOS 8、Xcode 6、iTunes Connect 和 TestFlight，您不再需要 UDID 和 Ad Hocs。您只需要您的 beta 测试人员提供的 Apple ID。目前您只能使用 25 名内部测试人员对您的应用进行 Beta 测试，但很快就会有 1000 名外部测试人员可用。这篇博文向您展示了如何与内部测试人员一起设置 beta 测试，

[http://blog.thebetafamily.com/2014/09/10/testflight-beta-testing-ios-8/](http://blog.thebetafamily.com/2014/09/10/testflight-beta-testing-ios-8/)

# c# - 如何使用“user32.dll”函数读取消息框内容文本

> ID：10365784
> 
> 赞同：2
> 
> 时间：2012-04-28T17:19:07.270
> 
> 标签：c#, .net, vb.net, winapi, messagebox

我需要在 c#/vb.net 中使用一个简单的 win api，从消息框中读取文本。我有一个阅读消息框标题的功能，但我不知道如何获取内容文本。消息框标题功能是：

```
' Function to retrieve the popup window associated with the form, as well as to
' find the child windows of the popup...
Private Declare Auto Function GetWindow Lib "user32.dll" ( _
    ByVal hWnd As IntPtr, ByVal uCmd As Long) As IntPtr

' Sendmessage overload that is used to send messages to the button on the
' dialog window...
Private Declare Auto Function SendMessage Lib "user32.dll" Alias "SendMessage" _
    (ByVal hWnd As IntPtr, ByVal Msg As Integer, ByVal wParam As Integer, _
     ByRef lParam As IntPtr) As IntPtr

' Sendmessage overloads used to retrieve the window text...
Private Declare Auto Function SendMessageA Lib "user32.dll" _
    Alias "SendMessageA" (ByVal hWnd As IntPtr, ByVal Msg As Integer, _
        ByVal wParam As IntPtr, ByRef lParam As IntPtr) As IntPtr 
```

...

```
' This function returns the text of the window, used so that we can confirm that
' we have the right dialog window...
Private Function GetWindowText(ByVal WindowHandle As IntPtr) As String
    Dim ptrRet As IntPtr
    Dim ptrLength As IntPtr

    ' Get length for buffer...
    ptrLength = SendMessageA( _
        WindowHandle, WM_GETTEXTLENGTH, IntPtr.Zero, IntPtr.Zero)

    ' Create buffer for return value...
    Dim sb As New System.Text.StringBuilder(ptrLength.ToInt32 + 1)

    ' Get window text...
    ptrRet = SendMessageString( _
        WindowHandle, WM_GETTEXT, ptrLength.ToInt32 + 1, sb)

    ' Get return value...
    Return sb.ToString
End If 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:26:10.133

您可能使用了错误的窗口句柄。文本由消息框内的客户端窗口显示。您可以通过 pinvoke GetDlgItem() 获取其句柄，传递 ID 65535。使用 Spy++ 深入了解组成消息框窗口的部分。

# php - 无法通过子类访问抽象类中的属性

> ID：10365786
> 
> 赞同：0
> 
> 时间：2012-04-28T17:19:17.013
> 
> 标签：php, model-view-controller, inheritance, abstract-class

我正在尝试构建一个抽象的基本控制器，它将扩展所有其他控制器。到目前为止，我有类似的东西：

```
 abstract class BaseController {

     protected $view;
     protected $user;

     public function __construct() {
       $this->view = new View; //So a view is accessible to subclasses via $this->view->set();
       $this->user = new User; //So I can check $this->user->hasPermission('is_admin');
     }
     abstract function index();

    }

class UserController extends BaseController {

  public function index() {}

  public function login() {

  if($this->user->isLoggedin()) {
   redirect to my account
  }
  else {
      $this->view->set('page_title', "User Login");
      $this->view->set('sidebar', $sidebar); //contains sidebar HTML
      $this->view->set('content', $content); //build main page HTML
      $this->view->render();

}
}
} 
```

我得到的问题是我得到这样的错误：

```
Call to a member function set() on a non-object in C:\xampp\htdocs\program\core\controllers\admin.controller.php on line 44 
```

如果我将 $user 和 $views 属性放在主控制器（即 UserController）中，一切正常。但我只想设置这些对象一次（在基本控制器中），而不必添加`$this->view = new View;`我所有的控制器。

**修复：**我覆盖了我的构造函数，我认为你不能在抽象类上调用 parent::__construct()。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:22:38.947

您正在尝试做的事情应该有效。确保您没有在`UserController`. （即，如果它有构造函数，则需要调用其父构造函数。）

否则，请进行一些调试以查看`$this->view`正在重置的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:29:03.610

你的代码对我有用。您要么在 中覆盖您的`__construct()`方法，要么用对象以外的东西`UserController`覆盖该字段。`view``View`

您在此表格中拥有的内容将起作用。

# javascript - 下拉输入字段

> ID：10365787
> 
> 赞同：0
> 
> 时间：2012-04-28T17:19:33.807
> 
> 标签：javascript, html, css

我想在我的网站上添加一个类似的下拉输入字段（下图）。我希望它在单击链接/图像/按钮时出现。这可以用 JavaScript 完成吗？另外，我不希望它影响页面的流程。

![在此处输入图像描述](../Images/cfe63cccba9f6f99bf11b90e4e6701a4.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:22:28.887

> 这可以用 JavaScript 完成吗？

是的。JavaScript/CSS 等价物将是一个按钮，它（单击时）显示带有`position: fixed`或的元素`position: absolute`。

这是一个使用 jQuery 的简单示例：http: [//jsfiddle.net/Byujd/1/](http://jsfiddle.net/Byujd/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:33:13.460

这有点复杂。

## HTML 和默认样式

您需要一个显示在内容上方的元素：

```
<div class="modal">
  <!-- Some content like textarea and stuff -->
</div> 
```

`position`现在您可以使用-property 和其他东西来设置此框的样式：

```
.modal {
  position: absolute;
  z-index: 999;
} 
```

这现在显示在其余内容的上方。

## 一些 jQuery-Goodness

该按钮只需要一个监听器。使用 jQuery，这看起来像这样：

```
$('.the-buttons-class').click( function (e) {
  e.preventDefault();
  $('.modal').toggle();
}); 
```

## 更好的方法

您可以在其上切换一个类并相应地操作状态，而不是使用 jQuery 的`toggle()`-function 切换模式的状态：

CSS：

```
.modal {
  ...
  display: none;
}

.modal.shown {
  display: block;
} 
```

JS：

```
$('.the-buttons-class').click( function (e) {
  e.preventDefault();
  $('.modal').toggleClass('shown');
}); 
```

## 摩尔

我在[我的页面](http://drublic.de/blog/)上做了一些非常相似的事情。确保选中搜索框。它的代码[在 GitHub 上](https://github.com/drublic/drublic-blog)。

# sql-server-2008 - 使用顺序整数更新表

> ID：10365790
> 
> 赞同：2
> 
> 时间：2012-04-28T17:19:49.130
> 
> 标签：sql-server-2008, tsql, sql-update

我继承了一个公司数据库，该数据库将订单号作为 GUID。当您想引用您的订单号时，不完全是用户友好的！所以我想要做的是添加一个新的 int 列，并为每个现有订单（已按日期时间排序）添加一个唯一的顺序订单号。

这是一个好主意，但我一直坚持如何将其作为更新查询来执行！任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T17:24:12.250

在您的表中添加一个[标识列](http://msdn.microsoft.com/en-us/library/ms186775.aspx)，编号将为您处理。

```
alter table YourTable add YourTableID int identity 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-28T17:26:53.673

单程。

```
alter table t add order_id int identity 
```

这将添加一个自动递增的 int 标识列。无法保证将 id 分配给现有行的顺序，但将为每个现有行分配一个唯一的 id。在此更改之后插入的每个新行都将获得一个新的唯一 ID。

在将其应用于实际应用程序之前，请考虑现有代码是否可以与标识列一起使用。通常这种方法是一种真正无害的升级。尝试插入标识列的代码会失败，除非它使用 set identity_insert。如果不删除列，则无法删除标识属性。

为了解决这个问题，可能需要对新 id 进行唯一约束，以提高检索速度和在 id 列被更新时强制唯一性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T17:45:50.133

不幸的是，如果您只是在表中添加一个 IDENTITY 列，现有订单不一定会获得按 OrderDate 顺序分配的 IDENTITY 值，因此如果您想根据订单日期分配订单 ID 值，它们将“乱序” （这似乎合乎逻辑）。快速示例：

```
CREATE TABLE dbo.Orders
(
    OrderGUID UNIQUEIDENTIFIER DEFAULT NEWID() PRIMARY KEY,
    OrderDate DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
);

INSERT dbo.Orders(OrderDate) VALUES
('20120101'), ('20120102'), ('20120103');
GO

ALTER TABLE dbo.Orders ADD OrderID INT IDENTITY(1,1);
GO
SELECT OrderID, OrderGUID, OrderDate = CONVERT(DATE, OrderDate) 
FROM dbo.Orders 
ORDER BY OrderDate; 
```

结果（显然你的会有所不同）：

```
OrderID OrderGUID                            OrderDate
------- ------------------------------------ ----------
2       C5CE909E-0469-45AE-A828-647C7F54AA14 2012-01-01
1       70D8EEB1-FDA8-4E56-874F-771999C6DB84 2012-01-02
3       8E7B42C3-6C4D-4860-8A82-AFADDBA96A4A 2012-01-03 
```

如果这是不可接受的，您可能应该创建一个新表并将所有旧订单插入其中（此时您也可以删除 GUID 列，正如我在评论中提到的那样）。

```
CREATE TABLE dbo.OrdersCopy
(
  OrderID INT IDENTITY(1,1) PRIMARY KEY,
  ... other columns ...
);

INSERT dbo.OrdersCopy (OrderDate, ... other columns ...)
SELECT OrderDate, ... other columns ...
FROM dbo.Orders 
ORDER BY OrderDate
OPTION (MAXDOP 1); -- single-threaded is important!

EXEC sp_rename 'dbo.Orders', 'OrdersOld', 'OBJECT';
EXEC sp_rename 'dbo.OrdersCopy', 'Orders', 'OBJECT'; 
```

（如果您想在清理其他表时暂时保留旧的 GUID 以供参考，那可能没问题，但您不应该再让它自动填充，并且您应该计划删除它，因为它很宽且冗余。 )

# ruby - 无法运行 Jenkins Build - 捆绑包：“找不到命令”

> ID：10365792
> 
> 赞同：17
> 
> 时间：2012-04-28T17:20:35.167
> 
> 标签：ruby, cucumber, jenkins, bundler

我目前正在尝试为我的一些黄瓜任务运行 jenkins 构建。我所有的 gem 都是使用 Bundler 安装的。宝石存储在供应商文件夹中。

但是，当我尝试`bundle install --deployment`在执行 shell 构建步骤中运行时，出现以下错误：

```
Started by user anonymous
Building in workspace /Users/Shared/Jenkins/Home/jobs/cukes/workspace
[workspace] $ /bin/sh -xe/var/folders/zz/zyxvpxvq6csfxvn_n0000004000001/T/hudson4461284045505361460.sh
+ bundle install --deployment
/var/folders/zz/zyxvpxvq6csfxvn_n0000004000001/T/hudson4461284045505361460.sh: line 2: bundle: command not found
Build step 'Execute shell' marked build as failure
Finished: FAILURE 
```

这真让我抓狂！它在我的本地机器上运行没有问题。为什么詹金斯看不到我的宝石？

任何帮助都会很棒！

干杯，乔恩

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2019-05-08T06:20:51.123

就我而言，我将此行添加到脚本的第一行：

```
#!/bin/bash -l 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-01T18:05:11.983

根据您安装 Jenkins 的方式，它可能会以单独的用户身份运行，通常以 user 身份运行`jenkins`。如果您已安装`bundle`到不在默认 PATH 中的非标准目录，例如`/usr/local/bin`，您需要：

*   添加`/usr/local/bin`到 jenkins 用户的 PATH（检查 ~jenkins/.bashrc）或
*   在 Jenkins 全局配置中配置 PATH 环境变量（或从属配置，如果在从属上构建）或
*   修改构建脚本以引用`bundle`使用完整路径名。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-08-25T13:59:57.010

如果 bundle 安装在`/usr/local/bin/bundle`（用 确定`which bundle`）你可以像这样添加一个符号链接到 bundle in `/usr/bin`：

`ln -s /usr/local/bin/bundle /usr/bin/bundle`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-28T19:18:00.373

首先要验证的内容：

*   确保`bundle`安装在运行 Jenkins 的机器上。
*   如果已安装，请确保它位于运行 Jenkins 的用户的路径上

（验证路径/环境：插入运行的 shell 构建步骤`env`）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-11-11T06:36:24.010

对我来说，我最初是通过 war 文件安装它，因为这是[Getting Started Guide](https://jenkins.io/doc/pipeline/tour/getting-started/)中推荐的方式。但是，用户手册更清楚地表明，[安装 Jenkins](https://jenkins.io/doc/book/installing/)可能有更好的方法。

我最终通过以下方式在 macOS 上卸载了 Jenkins 的 WAR 文件：

1.  删除 .war 文件。
2.  删除 ~/.jenkins 目录。

然后我[通过 home-brew 重新安装](https://jenkins.io/doc/book/installing/#macos)，并`bundle`开始工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-26T02:43:17.540

您可以`bundle`通过运行`which bundle`并`bundle`从那里运行命令来查看安装位置

# php - PHP mysql、pdo 和查询：为什么多个“查询”不起作用（在这种情况下）？

> ID：10365793
> 
> 赞同：7
> 
> 时间：2012-04-28T17:20:40.110
> 
> 标签：php, mysql, pdo

这是我的 sql 请求：

```
$sql
    = 'CREATE TEMPORARY TABLE tmp '
    . 'SELECT * FROM '.$table.' '
    . 'WHERE id=:id; '
    . 'ALTER TABLE tmp drop ID; '
    . 'INSERT INTO '.$table.' '
    . 'SELECT 0,tmp.* FROM tmp; '
    . 'SET @last=LAST_INSERT_ID(); '
    . 'DROP TABLE tmp;'
    . 'SELECT @last; ';
    $stmt = $this->bd->execQuery($sql, array(':id'=>101));
    echo "1 -> = "; var_export($stmt); echo "\n";
    $stmt = $stmt->fetch(PDO::FETCH_OBJ);
    echo "2 -> = "; var_export($stmt); echo "\n"; 
```

转储本身：查询有效（我已经检查过）。

```
sql =
'CREATE TEMPORARY TABLE tmp SELECT * FROM categorie WHERE id=:id; ALTER TABLE tmp drop ID; INSERT INTO categorie SELECT 0,tmp.* FROM tmp; SET @last=LAST_INSERT_ID(); DROP TABLE tmp;SELECT @last; '
params = array (
  ':id' => 101,
)
1 -> = PDOStatement::__set_state(array(
   'queryString' => 'CREATE TEMPORARY TABLE tmp SELECT * FROM categorie WHERE id=:id; ALTER TABLE tmp drop ID; INSERT INTO categorie SELECT 0,tmp.* FROM tmp; SET @last=LAST_INSERT_ID(); DROP TABLE tmp;SELECT @last; ',
))
2 -> = false 
```

如果我在控制台线上“手动”执行它，它也可以工作（对不起，looong 代码行）：

```
mysql> CREATE TEMPORARY TABLE tmp SELECT * FROM categorie WHERE id=101; ALTER TABLE tmp drop ID; INSERT INTO categorie SELECT 0,tmp.* FROM tmp; SET @last=LAST_INSERT_ID(); DROP TABLE tmp;SELECT @last; 
Query OK, 1 row affected (0.00 sec)
Records: 1  Duplicates: 0  Warnings: 0

Query OK, 1 row affected (0.00 sec)
Records: 1  Duplicates: 0  Warnings: 0

Query OK, 1 row affected (0.07 sec)
Records: 1  Duplicates: 0  Warnings: 0

Query OK, 0 rows affected (0.00 sec)

Query OK, 0 rows affected (0.00 sec)

+-------+
| @last |
+-------+
|   141 |
+-------+
1 row in set (0.00 sec)

mysql> 
```

这是我正在执行的代码。

```
public function execQuery($sql, $tab=array())
{
    $stmt = self::$_pdo->prepare($sql);
    if ($stmt===false) {
        throw new Exception(
            'Erreur prepare '.$sql.
            ' = '.var_export(self::$_pdo->errorInfo(), true)
        );
    }
    foreach ($tab as $key=>$valeur) {
        $stmt->bindValue($key, $valeur);
    }
    if ($stmt->execute()===false) {
        throw new Exception(
            "Erreur execution de la requete :\n\"".$sql."\"\n".
            "Paramètres de la requete :\n\"".var_export($tab, true)."\"\n".
            "Details de l'erreur : \n".var_export(self::$_pdo->errorInfo(), true)
        );
    }
    return $stmt;
} 
```

我怎样才能一次获得最后插入的值（= 使我所做的工作）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:49:47.717

正如我在上面的评论中提到的，虽然它没有回答您如何在一个 PHP 查询中发出多个 SQL 命令的问题，但一种解决方法是使用准备好的语句将您的 SQL 放入存储过程中：

```
DELIMITER ;;

CREATE PROCEDURE copyRecord(TableName VARCHAR(20), id INT) BEGIN
  -- prevent SQL injection
  SET TableName = CONCAT('`', REPLACE(TableName, '`', '``'), '`');
  SET @id = id;

  SET @sql = CONCAT('
    CREATE TEMPORARY TABLE tmp SELECT * FROM ', TableName, ' WHERE id = ?
  ');
  PREPARE stmt FROM @sql;
  EXECUTE stmt USING @id;
  DEALLOCATE PREPARE stmt;

  ALTER TABLE tmp drop ID;

  SET @sql = CONCAT('
    INSERT INTO ', TableName, ' SELECT 0,tmp.* FROM tmp
  ');
  PREPARE stmt FROM @sql;
  EXECUTE stmt;
  DEALLOCATE PREPARE stmt;

  DROP TABLE tmp;

  SET @sql = NULL;
  SET @id  = NULL;
  SELECT LAST_INSERT_ID();
END;;

DELIMITER ; 
```

然后，您只需从 PHP 调用 SQL 命令`CALL copyRecord('categorie', 101)`。

# c++ - 模板类中的 int 模板成员函数

> ID：10365796
> 
> 赞同：3
> 
> 时间：2012-04-28T17:21:06.287
> 
> 标签：c++, templates, boost, member, boost-test

重复[这个](https://stackoverflow.com/questions/1840253/c-template-member-function-of-template-class-called-from-template-function)问题。

我有这样的课：

```
template <class T>
class foo {
public:        

    foo(){}

    template <int S>
    void bar (){}

} 
```

如果这个类被调用：

```
int main(){
    foo<float> m;
    m.bar<1>();
} 
```

它给出了错误：

> 错误：“）”标记之前的预期主表达式

再次弃用：

我的代码是：

```
#define BOOST_TEST_DYN_LINK
#define BOOST_TEST_MAIN

#include <boost/mpl/list.hpp>
#include <boost/test/unit_test.hpp>
#include <boost/test/test_case_template.hpp>
using namespace boost::unit_test;

#include "foo.hpp"

BOOST_AUTO_TEST_SUITE();

typedef boost::mpl::list<char, int> test_types;

BOOST_AUTO_TEST_CASE_TEMPLATE(test_Mat_constructor_hwd, T, test_types){

    foo<T> m;
    m.bar<1>();
}

BOOST_AUTO_TEST_SUITE_END() 
```

然而，这不会编译，因为 BOOST_AUTO_TEST_CASE_TEMPLATE 正在做一些奇怪的事情......

不推荐使用以下文本：

但是，当我使用以下方法调用该函数时：

```
foo f;
f.bar<1>(); 
```

我收到错误消息：

> 绑定的成员函数只能被调用

但是，如果我将 bar 函数包装成类似 void bar1(){return bar<1>();} 的东西，它会起作用。我知道如果在编译期间不知道 T，它将无法编译。但我不知道为什么编译器不够聪明，无法确定 f.bar<1> 中的 1 是静态的？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T19:00:27.823

因为在解析测试函数时 T 参数是未知的，编译器无法确定`m.bar`表达式是什么，因此假定它是一个非模板变量。`m.bar<1>()`因此被解析为`(m.bar<1)>()`，最后一位是非法的。解决方法是明确声明这`bar`是一个模板：

```
foo<T> m;
m.template bar<1>(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:24:15.653

如果您希望在外部调用它们，则需要将成员函数公开，这在我的编译器上运行良好

```
class foo {
public:
    foo(){}

    template <int T>
    void bar (){}
 };

int main(){
    foo f;
    f.bar<1>();
} 
```

# netty - 在使用持久连接时测量请求延迟

> ID：10365810
> 
> 赞同：0
> 
> 时间：2012-04-28T17:22:06.200
> 
> 标签：netty

我想测量单个请求延迟。我创建了一个覆盖 channelOpen 和 channelClosed 的处理程序。这似乎工作正常，但在负载均衡器后面，我开始看到许多多秒的延迟。我怀疑这是由于持久连接，我正在测量总套接字时间。

再次阅读频道文档后，我认为我应该改写 channelConnected/Disconnected。我无法在本地重现长延迟，所以我在这里要求澄清一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T17:44:05.113

是的... messageReceived 和 writeComplete 是 g 的方式

# image - 显示来自 bean 的图像

> ID：10365812
> 
> 赞同：1
> 
> 时间：2012-04-28T17:22:15.080
> 
> 标签：image, jsp

我有一个 bean 可以在 getImage 方法中以字节 [] 的形式访问图像我将 awt 图像转换为字节数组

```
public byte[] getImage() {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    byte[] imageInByte = null;
    try {
        ImageIO.write( (BufferedImage)image, "jpg", baos );
        baos.flush();
        imageInByte = baos.toByteArray();
        baos.close();
        return imageInByte;
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return imageInByte;
} 
```

我需要在表格中使用 jsp 显示图像

像：

```
<table>
<c:forEach items="${beans}" var="bean">
    <tr>
    <td>${bean.name}</td>
    <td>${bean.origin}</td>
    <td>${bean.year}</td>
    <td>${bean.number}</td>
    <td>${bean.image}</td>
</tr>
</c:forEach> 
```

它与内容类型有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:10:36.200

在您的 jsp 文件中创建一个 img 标记，其中 src 指向一个 servlet，它将图像字节数组作为 jpg 图像返回。您必须为 servlet 输出流设置正确的 mime 类型。这种方法的一个问题是您必须将图像数组保存在会话中，以便 servlet 获取它。

# ruby - 宝石安装。找不到gem的命令

> ID：10365816
> 
> 赞同：2
> 
> 时间：2012-04-28T17:22:50.710
> 
> 标签：ruby, rubygems

我使用以下方法安装了`ruby-processing`gem：

```
$ sudo gem install ruby-processing 
```

当我尝试运行`ruby-processing`'s`rp5`命令时，这是我得到的输出：

```
rp5 run twitter_emotion_graphs.rb 
No command 'rp5' found, did you mean:
Command 'rpm' from package 'rpm' (main)
Command 'rpl' from package 'rpl' (universe)
rp5: command not found 
```

以下是更多信息的上下文（查看自述文件）： [https ://github.com/vishrut/Twitter-Emotion-Graphs](https://github.com/vishrut/Twitter-Emotion-Graphs)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:32:42.160

确保可执行文件在您的路径上。您可能必须重新启动终端才能刷新所有内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:02:08.813

在某些系统（例如，Debian）上，gem 可执行文件的安装路径不在`$PATH`. 根据您的发行版，该路径位于不同的位置，在带有系统 Ruby 的 Debian 上，它位于`/var/lib/gems/1.8/bin`. 要将其添加到系统中`$PATH`，请将类似这样的内容放入一个新文件中`/etc/profile.d/rubygems.sh`

```
export PATH="$PATH:/var/lib/gems/1.8/bin" 
```

# php - 检测 PHP 项目中的所有大写变量（并替换为其他内容）

> ID：10365817
> 
> 赞同：0
> 
> 时间：2012-04-28T17:23:01.173
> 
> 标签：php, search, variables, text, uppercase

首先 - 一些背景。我们有一个 config.php 文件，它以这种格式列出了几个变量和设置：

```
$MY_EMAIL_ADDRESS    = 'test@test.com';
$MY_WEBSITE          = 'www.test.com';
$SOMETHING_ELSE      = 'foobar'; 
```

我想在整个 PHP 项目中用更合理（和安全）的名称替换它们作为数组的一部分。大多数情况下，我们可以更安全地执行此操作：[通过 Ajax 以变量名作为参数获取 PHP 变量值](https://stackoverflow.com/questions/10364940/get-php-variable-value-via-ajax-with-variable-name-as-parameter/10364987#10364987)

我们还忘记了其中一些变量名称，因此它们在整个项目中都使用，但可能没有记录 - 因此逐个搜索将证明是困难的。

有没有一种方法可以在 php 文件中搜索以美元符号 ($) 开头的任何值，然后仅由大写字母和可能的下划线组成？

```
$MY_SETTING_NAME 
```

然后我们可以构建一个列表并手动更新，或者构建某种脚本以更明智的工作方式替换事物：

```
$CONFIG['MY_SETTING_NAME'] 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:27:42.690

您可以使用 get_defined_vars 函数，它将所有变量作为数组返回。

请以[php.net](http://php.net/manual/en/function.get-defined-vars.php)网站为例

# asp.net - 用户控件和 JavaScript 和母版页

> ID：10365822
> 
> 赞同：5
> 
> 时间：2012-04-28T17:23:32.567
> 
> 标签：asp.net

考虑以下情况：

有一个包含所有 javascript 的 contentPlaceHolder 的母版页...

对于速度问题，此部分位于页面底部。

我的用户控件生成一些 javascript，这些 javascript 使用母版页 javascript（Jquery 库）中的一些引用

因此，如果我的用户控件在母版页 javascript 之前呈现，它将不起作用。

这是我的问题：

如何在我的 .ascx 文件中制作一些 javascript 代码块以呈现到 .aspx 页面中的 asp:Content JavaScript

或者也许我的所有想法都已磨损？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T18:10:41.823

看看这是否适合你：

母版页的“底部”在哪里？如果您将它移动**到关闭的服务器端表单控件**中并`ClientScript.RegisterStartupScript`在您的用户控件中使用，它将在“结束`<form/>`标记之前”注入您的控件脚本（这将***在***您的静态脚本调用之后）。

母版页 - 就在关闭服务器端 ASP.Net 的正**上方**`</form>`：

```
....
<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js "></script>
</form> 
```

内容页面（没什么特别的）：

```
<%@ Register src= ....

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" Runat="Server">
    <uc1:jscript_inject ID="jscript_inject1" runat="server" />
</asp:Content> 
```

用户控制：

```
protected void Page_Load(object sender, EventArgs e)
{
    Page.ClientScript.RegisterStartupScript(this.GetType(), "foo", @"alert('foo');", true);

} 
```

这是它的呈现方式（浏览器中的 HTML 视图源）：

```
<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js "></script>

<script type="text/javascript">
    //<![CDATA[
    alert('foo');//]]>
</script>
....
</form> 
```

正如所宣传的那样，`alert('foo');`低于“预定义” jq cdn 调用....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T17:23:22.140

干杯有用。有趣的是，这适用于`Page.ClientScript.RegisterStartupScript`但不适用`Page.ClientScript.RegisterClientScriptInclude`，而是将“包含”添加到表单的顶部。

# ruby-on-rails - 在 Ctrl+C 中断的情况下，如何在 Rake 任务中使用 ActiveRecord 事务进行回滚

> ID：10365825
> 
> 赞同：4
> 
> 时间：2012-04-28T17:23:56.427
> 
> 标签：ruby-on-rails, activerecord, transactions, rake, interrupt

我正在编写一个 rake 任务，它在我的数据库中创建记录并且可以无限期地运行。该任务的一个方面是在模型之间创建多对多关联。如果我在将条目添加到连接表时退出任务，它将无法完成与该模型的关联。这是任务中的一些代码：

```
(1..100).each do |page|

    related = Nokogiri::HTML(open(url + "item/#{item.id}/related/#{page}"))

    related.css('.box').each do |box|
      id = box.css('a').first.attr(:href).scan(/\/(\d+)\//)[0][0].to_i
      title = box.css('p.title a').text
      related_item = Item.create :title => title, :foreign_id => id
      ItemRelation.create :item => item, :related_item => related_item
    end

end

item.update_attributes :stage => ItemStage::RELATED 
```

在这里，我正在遍历相关项目的所有页面并在当前项目之间创建一个 ItemRelation（这个循环在另一个循环遍历项目的循环内，这是“项目”变量的来源）。以及我从这些页面中获得的所有相关项目。

如果我在遍历这些页面时退出程序，则当前项目将不会完成相关，并且最后阶段也不会更新。

那么如何将所有这些包装在一个事务中，当我执行 Ctrl+C 时将回滚，或者它将完成循环，更新阶段，然后退出而不是转到下一个要关联的项目

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-28T23:23:24.590

您可以使用`transaction`块将事物包装在事务中。举个例子：

```
ActiveRecord::Base.transaction do
    # create relation 1
    # create relation 2
    # Ctrl+C
    # create relation 3
end 
```

如果`end`未达到，则`COMMIT`不会应用 SQL，这意味着不会创建任何上述关系。

值得注意的是，您也可以使用类似的东西`ItemRelation.transaction`，但事务不是特定于模型的，所以它的工作原理是一样的。

更多信息可以在[Active Record 交易](http://api.rubyonrails.org/classes/ActiveRecord/Transactions/ClassMethods.html)页面上找到。

收到 Ctrl+C 后，没有办法等待和完成某些事情；基于事务的方法是要走的路。

# c++ - c++指针引用方法调用

> ID：10365828
> 
> 赞同：0
> 
> 时间：2012-04-28T17:24:12.237
> 
> 标签：c++, pointers, methods, reference, call

我正在编写一个程序来管理二叉树，但这里有一个问题：

```
void Arbol :: insertar(Nodo*& p, float clave)
{
    if(p == NULL){
        p = new Nodo(clave);
    }else if(clave < p->getclave()){
        insertar(p->getsubarbol_izq(), clave);
    }else{
        insertar(p->getsubarbol_der(), clave);
    }
} 
```

Nodo*& 是树 (Arbol) 中每个节点 (nodo) 中指针的引用。

p->getsubarbol_der() 返回一个指向 nodo (nodo*) 的指针。

但是在调用 Arbol 类的 insertar 方法时出现此错误：错误：没有匹配函数调用 'Arbol::insertar(Nodo*, float&)'|

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:26:24.633

我认为基本问题是`p->getsubarbol_der()`返回一个临时文件，而您正试图通过非`const`引用将该临时文件传递给`insertar()`.

# php - 使用 php 模块构建网页

> ID：10365837
> 
> 赞同：1
> 
> 时间：2012-04-28T17:25:32.783
> 
> 标签：php, layout, heredoc

我希望通过将布局与内容生成分开来构建一个 HTML 页面。我打算说一个带有 div 元素矩阵结构的 layout.php 页面（比如 3*3）。对于位置（1,3 - 第一行，第三列）的 div，我希望调用一个广告模块，该模块将返回一个旅游广告。对于 location(2,3) 处的 div，将调用相同的模块，但这次将返回电子产品的 HTML。

这里的目的是将布局与内容生成分开。所以我可以很容易地改变布局。例如，对于位置 (2,3) 而不是静态广告，我可以调用一个天气模块，它返回显示天气数据的 HTML。

我能想到的一种方法是拥有一个 adv_module.php，它具有类和成员函数来返回适当的广告 HTML，php 代码如下，即

```
include_once(adv_module.php);adv1 = new ADV_MODULE(); echo adv1->getAd(category=travel)
:
:
include_once(adv_module.php);adv2 = new ADV_MODULE(); echo adv2->getAd(category=electronics 
```

)

但是 HTML 必须在成员函数中构建。这导致了很多丑陋的 php 代码散布在 HEREDOC 元素中以帮助构建 HTML。HEREDOC 不允许条件、循环等

有一个更好的方法吗？如果可能的话，我希望避免使用模板（Smarty like packages）。

# perl - Perl 中的绑定是什么？

> ID：10365838
> 
> 赞同：0
> 
> 时间：2012-04-28T17:25:48.207
> 
> 标签：perl, binding, terminology

我一直在努力学习 Perl，在[CPAN](http://search.cpan.org/)上，我遇到了

> [libsvm 支持向量机库的 Perl 绑定](http://search.cpan.org/perldoc/Algorithm%3a%3aSVM)

*在这种情况下，绑定*意味着什么？

我以前从未在计算机科学中找到过这个词...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:03:16.460

这种绑定允许您在另一种语言（在本例中为 Perl）中使用来自一种语言（通常是 C，包括在本例中）的库/API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:30:53.100

一个接口，一个可让您访问 C 库的模块。

例如，我最喜欢的 XML 解析器是 XML::LibXML，但它不做任何解析。它实际上是一个粘合层，将 C++ libxml2 库的对象和方法绑定到 Perl 对象和方法。

# php - 如何在 URL 中指定 Bing 上的位置

> ID：10365847
> 
> 赞同：2
> 
> 时间：2012-04-28T17:26:54.993
> 
> 标签：php, curl, bing

我正在做一些小的 cURL 工作，与 Google 不同，Bing 将搜索结果默认为服务器的位置。我试图找到一个允许我指定位置的参数，例如英国/美国，但我运气不佳。

有谁知道或有链接到解释这个的文章？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:41:53.540

我实际上找到了它，在搜索了 30 分钟并将其发布后，我偶然发现了它。您可以使用“setmkt=fr-fr”之类的内容进行设置

第一个是语言，第二个是位置。我不确定它会接受什么，但我认为玩它会得到预期的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:36:54.800

我相信您可以使用以下`Location Data`参数：

[http://msdn.microsoft.com/en-us/library/ff701726.aspx](http://msdn.microsoft.com/en-us/library/ff701726.aspx)

您可以指定`countryRegion`将结果限制在某个国家/地区：

> 一个字符串，指定地址的国家或地区名称。
> 
> 示例：美国

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:30:39.600

冰！可能是基于连接客户端的IP。

由于您无法更改它（除了通过代理连接，这是一个完全不同的故事），您无法手动设置搜索结果的位置（当然，Bing! 有一个选项或允许它的 API） .

# ruby-on-rails - 如何在生产中命名我的 mongodb 表？

> ID：10365855
> 
> 赞同：0
> 
> 时间：2012-04-28T17:27:46.587
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, mongoid, unicorn

好的，所以我有一个使用 mongoid 的 rails 应用程序，并且我的 mongoid 文件中有这些设置用于生产数据库

```
# set these environment variables on your prod server
production:
  host: <%= ENV['MONGOID_HOST'] %>
  port: <%= ENV['MONGOID_PORT'] %>
  username: <%= ENV['MONGOID_USERNAME'] %>
  password: <%= ENV['MONGOID_PASSWORD'] %>
  database: <%= ENV['MONGOID_DATABASE'] %> 
```

这是如何工作的以及如何在我的 rails 3.2.3 应用程序中将数据库命名为特定的名称

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:05:02.783

以上是使用环境变量

您可以删除 <%= ENV 部分并仅替换为 'myDatabaseName' 如果您希望它是相当静态的

用户名/密码等也是如此

但是，我建议阅读有关使用环境变量运行您的应用程序的内容，因为它会提供更多的灵活性

# c - " 预期标识符或 '(' 在 '[' token" 和 " error: expected ')' before 'A'"

> ID：10365859
> 
> 赞同：2
> 
> 时间：2012-04-28T17:28:57.053
> 
> 标签：c

这是 C (adjacency.c) 中的 prog，它检查是否存在从节点 a 到节点 b 的有向图方式

```
# include <stdio.h>
# include <stdlib.h>

#define N 11
#define FALSE 0
#define TRUE 1

typedef  int[N][N] adj_mat;

int path (adj_mat A, int u, int v)

void main()
    {
        adj_mat Matrix; 
        int dadnode, sonnode; 

        printf("bla-bla-bla enter nodes.\n");            
             printf("Press Ctrl+Z after finishing  of bla-bla-bla all the nodes\n");

        do {    
            printf("Enter the  number of first node\n"); 
            scanf("%d", &dadnode);
            printf("Enter the  number of second node\n");
            scanf("%d", &sonnode;);

            if ((dadnode < sonnode) && (sonnode <= N) && (dadnode > 0)) 
                Matrix[dadnode][sonnode] = 1; 
            } while ( (dadnode != EOF ) && (sonnode != EOF)); 

        printf("Now enter u and v nodes to check if exists way from u node to we node\n")

            printf("Enter the  number of u node\n"); 
            scanf("%d", &dadnode);
            printf("Enter the  number of v node\n");
            scanf("%d", &sonnode;);

            if ((dadnode < sonnode) && (sonnode <= N) && (dadnode > 0)) 
             {
                if(path(Matrix,dadnode,sonnode) == TRUE ) 
                    printf ("Exists way from node u to node v ");   
             }

                else printf printf ("Not exists way from node u to node v ");   

    }

int path (adj_mat A, int u, int v) 
    {
        if (v >= u)  
        return FALSE; 

        int nodenum; 

        for(nodenum = v - 1; nodenum > 0; nodenum-- ) 

            {
                if (A[nodenum][v] == TRUE) 
                {
                    if (nodenum == u) /
                        return TRUE;

                    else if (path (adj_mat A, int u, int nodenum)) 

                        return TRUE;
                }
            }   

        return FALSE; 
    } 
```

当我输入命令时

> gcc -o 邻接 -ansi adjacency.c

我明白了

> adjacency.c:8：错误：预期标识符或 '(' 在 '[' 标记之前
> 
> adjacency.c:10: 错误：在 'A' 之前需要 ')'</p>
> 
> adjacency.c:58: 错误: 'A' 之前的预期')'</p>

怎么修 ？

更新：感谢大家的帮助。编译。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-28T17:31:19.533

您应该将该`[N][N]`部分移动到声明的末尾，并在 . 的前向声明之后添加一个分号`path`。

```
typedef  int adj_mat[N][N];
int path (adj_mat A, int u, int v); 
```

您的代码的其余部分也存在不准确之处：

*   `scanf("%d", &sonnode;);`有多余的分号，应该是`scanf("%d", &sonnode);`
*   `else printf printf`应该`else printf`
*   有几个地方缺少分号
*   a`/`在不应该存在的一行的末尾
*   `main`需要返回一个`int`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T17:32:19.873

该类型`int[N][N]`不是有效的 C++。尝试：

```
typedef  int adj_mat[N][N]; 
```

反而。

还：

您需要`;`在行尾使用分号 (' ')：

```
int path (adj_mat A, int u, int v) 
printf("Now enter u and v nodes to check if exists way from u node to we node\n") 
```

您不需要第一个分号

```
scanf("%d", &sonnode;); 
```

你有一个额外的（多余的） printf 在

```
else printf printf ("Not exists way from node u to node v "); 
```

您的线路无效

```
if (nodenum == u) / 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T17:31:56.240

您在第 10 行的函数定义后缺少分号：

```
int path (adj_mat A, int u, int v); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T17:32:56.620

下面一行的末尾缺少一个分号。

```
int path (adj_mat A, int u, int v); 
```

# ios5 - 使用 Xcode 4.3.2 故事板创建下拉菜单

> ID：10365863
> 
> 赞同：0
> 
> 时间：2012-04-28T17:30:04.243
> 
> 标签：ios5, user-interface, uiviewcontroller, uistoryboard

我是 Obj-C 的菜鸟，尤其是故事板的概念。故事板似乎非常棒，但它根本不直观。

我正在努力做到这一点，因此当按下此按钮时，用户将看到一个下拉菜单，让他们从全部、已读或未读中进行选择：

![在此处输入图像描述](../Images/820845b83b17fff5c2932c7893801860.png)

我是否要拖出一个新的视图控制器并在其中放入一个下拉选择器，然后从按钮转到该视图？

PS 我应该使用什么系统图标来表示已读/未读过滤器？我刚才的那个是不对的。=]

PPS 这个项目是开源的：[https ://github.com/kirkouimet/enzyme](https://github.com/kirkouimet/enzyme)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T23:01:26.997

好吧，我想最本机的控件是[范围栏](http://developer.apple.com/library/ios/documentation/userexperience/conceptual/mobilehig/UIElementGuidelines/UIElementGuidelines.html#//apple_ref/doc/uid/TP40006556-CH13-SW50)，但这必须附加到[搜索栏](http://developer.apple.com/library/ios/documentation/userexperience/conceptual/mobilehig/UIElementGuidelines/UIElementGuidelines.html#//apple_ref/doc/uid/TP40006556-CH13-SW28)，这可能不是你要找的。范围栏基本上只会在搜索栏是第一响应者时出现（即，当它具有键盘的焦点时）。

如果您正在为 iPad 开发，您可以使用[popover 控制器](http://developer.apple.com/library/ios/documentation/userexperience/conceptual/mobilehig/UIElementGuidelines/UIElementGuidelines.html#//apple_ref/doc/uid/TP40006556-CH13-SW40)。只需创建一个视图控制器来管理过滤器的按钮并使用 a`UIStoryboardPopoverSegue`转换到它们。

这两个涉及 popover segues 的问题可能会有所帮助： - [iOS - 使用 StoryBoard 创建一个 Popover 视图](https://stackoverflow.com/questions/8225589/ios-create-an-popover-view-using-storyboard) - [UIStoryboardPopoverSegue 在按钮触摸时打开多个窗口](https://stackoverflow.com/questions/7758837/uistoryboardpopoversegue-opening-multiple-windows-on-button-touch)

您可能还需要考虑在[工具栏内使用](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/UIElementGuidelines/UIElementGuidelines.html#//apple_ref/doc/uid/TP40006556-CH13-SW50)[分段控件](http://developer.apple.com/library/ios/documentation/userexperience/conceptual/mobilehig/UIElementGuidelines/UIElementGuidelines.html#//apple_ref/doc/uid/TP40006556-CH13-SW27)（使用样式）并将其放置在您已有的搜索栏上方。然后，您只需创建一个响应控制事件的方法（可能在您的根主视图控制器中）。您可以使用它来确定选择哪个段来进行过滤。`UISegmentedControlStyleBar``IBAction``UIControlEventValueChanged`

像这样的东西...

![在此处输入图像描述](../Images/b87ce146c4aab870c768c11b58393a64.png)

从上到下：

*   导航栏
*   工具栏
    *   灵活的空间
    *   分段控制
    *   灵活的空间
*   搜索栏
*   表视图

# java - 如何在 rabbitmq 中合并频道？

> ID：10365867
> 
> 赞同：13
> 
> 时间：2012-04-28T17:30:56.667
> 
> 标签：java, multithreading, rabbitmq

我一直在尝试共享线程之间的连接，并且仅在创建线程时才打开通道，但经过更多研究后，我想我也想尝试`connection pooling`. 我怎样才能在rabbitmq上做到这一点？或者这是我可以普遍应用的一般想法？我的目标是生成 X 线程，然后让它们不必打开新通道（这需要在客户端和服务器之间建立循环）。

由于线程是它们自己的类，我不确定是否需要将池放在产生线程的类本身或它们去哪里？我也有多种类型的线程我想在它们之间共享这些连接（不是只有一个）。那可能吗？

只是给你一个大致的想法，这里是连接/通道是如何在 rabbitmq 中建立的：

```
ConnectionFactory factory = new ConnectionFactory();
    factory.setHost("localhost");
    Connection connection = factory.newConnection();
    Channel channel = connection.createChannel();  //I want to share several of these between threads 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T17:36:56.600

`Channel`您所需要的只是一个线程可以从中提取的对象池。

Apache commons 实际上已经有一个`ObjectPool`可以使用的泛型。

该接口的 javadoc 可以在这里找到：[http ://commons.apache.org/pool/api-1.6/org/apache/commons/pool/ObjectPool.html](http://commons.apache.org/pool/api-1.6/org/apache/commons/pool/ObjectPool.html)

可以在此处找到其预构建实现之一的 javadoc：http: [//commons.apache.org/pool/api-1.6/org/apache/commons/pool/impl/GenericObjectPool.html](http://commons.apache.org/pool/api-1.6/org/apache/commons/pool/impl/GenericObjectPool.html)

可以在这里找到使用它的教程：http: [//commons.apache.org/pool/examples.html](http://commons.apache.org/pool/examples.html)

如果这对于您的简单需求来说过于复杂，那么您真正需要做的就是编写一个管理一组`Channel`对象的类，允许线程检出它们并将它们返回到池中，并使用适当的同步来防止两个线程掌握相同的`Channel`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-11-04T10:47:29.510

如果您使用通道，您还可以使用[ThreadLocal](http://docs.oracle.com/javase/6/docs/api/java/lang/ThreadLocal.html)对象。

RabbitMQ 建议您在每个线程中使用通道，这将是一个完美的匹配。

示例代码：

```
private final ThreadLocal<Channel> channels = new ThreadLocal<>();
...
Channel channel = channels.get();
 if (channel == null){
        channel = connection.createChannel();
        channels.set(channel);
    } 
```

无需关闭通道，因为当连接关闭时它们将被您的应用程序关闭。

但是，如果您大量创建新线程，则此解决方案可能不适合您，因为这将分配许多永远不会关闭的新通道。但如果你这样做，你可能做错了什么。

# php - 这个 PHP 代码是否容易受到 SQL 注入的影响？

> ID：10365869
> 
> 赞同：-2
> 
> 时间：2012-04-28T17:31:03.717
> 
> 标签：php, mysql

我有一个网站，我在服务器端使用 PHP 和 mysql 作为数据库。我使用以下脚本从数据库中检索数据。谁能让我知道这段代码是否容易受到注入攻击？如果是这样，你能给出一个解决方案吗？

```
<?php
// PHP script 

$usrname=$_POST['usrname'];
$_SESSION['usremail']=$usrname;
$usrpassword=$_POST['passwd']; 
$db=mysql_select_db('mydb',$connection);
$result=mysql_query("select usrfname,usrlname from userinformation where usremail='$usrname' and usrpassword='$usrpassword'") or die('failed to login'); 
```

任何帮助是极大的赞赏。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-28T17:33:44.490

是的，它很脆弱。您直接从用户输入中谈论值并将其放入您的查询中。

您应该查看`mysql_real_escape_string`或（最好）使用提供参数化查询的 MySQLi。SQL 注入是由作为 SQL 代码而不是数据注入的用户数据引起的。确保查询安全的唯一真正方法是使用参数化查询，它在协议级别分离数据和查询文本。

此外，您的密码以明文形式存储。您应该使用盐渍散列函数作为绝对最小值。

你还应该看看这些很棒的问题：

*   [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/best-way-to-stop-sql-injection-in-php)
*   [PHP 密码的安全哈希和盐](https://stackoverflow.com/questions/401656/secure-hash-and-salt-for-php-passwords)
*   [基于表单的网站身份验证权威指南](https://stackoverflow.com/questions/549/the-definitive-guide-to-forms-based-website-authentication)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-28T17:33:09.737

当然是脆弱的。你永远不会清理你的输入。尽管不推荐使用 mysql_* 函数，但您仍然会发现该`mysql_real_escape_string`函数的用途。只需将其应用于您的变量。

```
$usrname = mysql_real_escape_string($_POST['usrname']);
$usrpassword = mysql_real_escape_string($_POST['passwd']); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T17:33:46.410

是的，它是..

改为这样做：

```
$usrname=$_POST['usrname'];
$_SESSION['usremail']=$usrname;
$usrname=mysql_real_escape_string($usrname);
$usrpassword=mysql_real_escape_string($_POST['passwd']); 
$db=mysql_select_db('mydb',$connection);
$result=mysql_query("select usrfname,usrlname from userinformation where usremail='$usrname' and usrpassword='$usrpassword'") or die('failed to login');` 
```

您还应该查看Prepared Statements。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T17:38:47.073

`mysql_real_escape_string()`用于您想在查询中使用的用户生成的字符串。

```
$usrname     = mysql_real_escape_string($_POST['usrname']);
$usrpassword = mysql_real_escape_string($_POST['passwd']); 

$db=mysql_select_db('mydb',$connection);
$result = mysql_query("SELECT usrfname, usrlname FROM userinformation WHERE usremail='$usrname' AND usrpassword='$usrpassword'") or die('failed to login');

// Set session data only if login is successful 
$_SESSION['usremail']=$usrname; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-28T17:41:58.603

是的，您永远不应该接受用户输入（来自表单（POST 数据），作为 url（GET 数据）的一部分，甚至是 cookie，而不首先检查它是您所期望的。例如，您的用户名可能包含一个 to z 可能允许使用点。因此，在将输入文本放在数据库附近之前，您会检查它是否包含所有内容。Google preg_match。

而且您需要在服务器端执行此操作，仅在浏览器中使用 javascript 是不够的。

我还将密码存储为用户在注册时输入的 md5 哈希，因此您在注册时获得 $password，检查它的字符范围有限，执行 $hass_pw=md5($password) 并存储$hash_pw 在 d/b. 然后，当用户登录时，您再次对其进行哈希处理并在查询中使用它。（为了清楚起见，我在这里省略了 $_POST ）。

例如：

```
if preg_match(/"[^a-z]/i", $_POST['usrname'])
    print "bad username format)
else    
    {
    // good format username, safe to use in query
    } 
```

# python - 将字符串从 CSV 导入 App Engine 中的 DateProperty

> ID：10365872
> 
> 赞同：0
> 
> 时间：2012-04-28T17:31:20.843
> 
> 标签：python, google-app-engine, datetime

我正在尝试将日期格式为“06/01/05”（月/日/年）的 CSV 文件读入 App Engine（Python）中的**DateProperty**（不是 DateTimeProperty）。这是我目前拥有的：

```
for row in mycsvfiledata:
    obj = MyObject()
    datetemp = row[1]
    cohorttemp = datetime.datetime.strptime(datetemp, "%m/%d/%y")
    obj.cohort_date.month = cohorttemp.month
    obj.cohort_date.day = cohorttemp.day
    obj.cohort_date.year = cohorttemp.year 
```

我得到了错误：[...省略...] obj.cohort_date.month=cohorttemp.month AttributeError：'NoneType'对象没有属性'month'

我也试过：

```
obj.cohort_date = datetime.date.strptime(datetemp, "%m/%d/%y") 
```

（但 strptime 似乎只生成一个日期时间对象，而不是一个日期对象）

```
obj.cohort_date = datetime.datetime.strptime(datetemp, "%m/%d/%y") 
```

（但“cohort_date”是 App Engine 中的 DateProperty，当我尝试这样做时，我得到“BadValueError：Property crowd_date must be a date, not a datetime”）

如果我只是将“cohort_date”设置为 DateTimeProperty，这一切都很好，但我不希望这样（出于各种原因）。我很感激这方面的任何指导！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:42:09.680

`datetime`实例有一个`date()`返回相应`date`实例的方法，所以：

```
obj.cohort_date = datetime.strptime(datetemp, "%m/%d/%y").date() 
```

# binding - 更新 applicationHost.config 中的站点绑定

> ID：10365875
> 
> 赞同：2
> 
> 时间：2012-04-28T17:31:47.830
> 
> 标签：binding, iis-7.5

我正在尝试将站点绑定列表添加到 applicationHost.config 文件，而不是通过 IIS 7.5 手动添加每个站点绑定。

```
<site name="new_site" id="6">
    <application path="/" applicationPool="new_site">
        <virtualDirectory path="/" physicalPath="D:\HTTP\wwwroot\newsite" />
    </application>
    <bindings>
        <binding protocol="http" bindingInformation="*:80:example.com" />
        <binding protocol="http" bindingInformation="*:80:www.example.com" />
        <binding protocol="http" bindingInformation="*:80:example2.com" />
        <binding protocol="http" bindingInformation="*:80:www.example2.com" />
    </bindings>
</site> 
```

这样做的原因是我有 2000 个绑定要添加，如果我可以直接编辑配置文件，这将容易得多。

但是，在编辑配置文件时，绑定不起作用或显示在 IIS 中。

这实际上是可能的还是我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:47:12.463

您应该使用`Microsoft.Web.Administration`程序集并通过该 API 创建站点。这是创建站点的示例

[http://learn.iis.net/page.aspx/226/microsoftwebadministration/](http://learn.iis.net/page.aspx/226/microsoftwebadministration/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T03:20:58.960

您可以在 PowerShell 中编写脚本：

```
[Reflection.Assembly]::Load(
"Microsoft.Web.Administration, Version=7.0.0.0, 
Culture=Neutral, PublicKeyToken=31bf3856ad364e35") > $null

$siteId = 6
$serverManager = New-Object Microsoft.Web.Administration.ServerManager
$site = $serverManager.Sites | where { $_.Id -eq $siteID }

# Read your list of hostnames

$reader = [System.IO.File]::OpenText("c:\\hostnames.txt")
for(;;) 
{
    $domainName = $reader.ReadLine()
    if($domainName -eq $null) { break }
    $binding1 = "*:80:www." + $domainName
    $binding2 = "*:80:" + $domainName
    $site.Bindings.Add($binding1, "http")
    $site.Bindings.Add($binding2, "http")
}
$serverManager.CommitChanges() 
```

该文件`c:\\hostnames.txt`将包含所有域名的列表，例如：

```
域名1.com
域名2.com
域名3.com

```

如果您需要绑定到特定的 IP 地址，请替换`*`为 IP 地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-08T00:00:09.150

您是否在 64 位机器上使用 32 位编辑器？如果是这样，Windows 会将您的编辑保存到 C:\Windows\SysWOW64\inetsrv\Config\applicationHost.config。

请参阅[https://serverfault.com/questions/315904/cannot-open-iis-7-applicationhost-config-in-64-bit-windows-with-32-bit-text-edit](https://serverfault.com/questions/315904/cannot-open-iis-7-applicationhost-config-in-64-bit-windows-with-32-bit-text-edit)

# objective-c - 如何在 XCode 4.3 中连接 AppDelegate？

> ID：10365879
> 
> 赞同：0
> 
> 时间：2012-04-28T17:32:03.277
> 
> 标签：objective-c, ios

我刚刚得知我`applicationDidFinishLaunching`没有被触发。在这里进行搜索，似乎我需要将我`AppDelegate`的设置为`delegate`我的主窗口。

这里的答案解释了如何在 IB 中使用 main.xib 进行操作。我在使用情节提要的 Xcode 4.3.2 上。我如何在情节提要中做同样的事情？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:35:05.957

不。您没有将应用程序委托设置为主窗口的委托，而是共享 UIApplication 实例（在另一种情况下，它将被称为窗口委托）。你最好改变你的`main()`功能；称呼

```
int retVal = UIApplicationMain(argc, argv, nil, @"MyAppDelegateClass"); 
```

而不是默认的

```
int retVal = UIApplicationMain(argc, argv, nil, nil); 
```

称呼。

另请注意，`applicationDidFinishLaunching`已弃用。您可能需要过渡到新的

```
application:didFinishWithLaunching: 
```

委托方法。

# django - 正确使用查询集

> ID：10365880
> 
> 赞同：0
> 
> 时间：2012-04-28T17:32:19.087
> 
> 标签：django, satchmo

我很确定使用查询集可以更有效地完成以下代码。我只是不知道怎么做。有什么建议么？这是我的代码：

```
orders = Order.objects.filter(contact=contact)
for order in orders:
    for item in order.orderitem_set.all():
        if cartitem.product_id == item.product_id:
            return True
return False 
```

非常感谢，托马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:36:19.717

检查[`exists()`](https://docs.djangoproject.com/en/1.4/ref/models/querysets/#django.db.models.query.QuerySet.exists)和[查找跨越关系](https://docs.djangoproject.com/en/1.4/topics/db/queries/#lookups-that-span-relationships)

```
Order.objects.filter(contact=contact, 
                     order_item__product=cartitem.product_id).exists() 
```

# c# - Collection.Add() 的工作流程

> ID：10365886
> 
> 赞同：3
> 
> 时间：2012-04-28T17:32:59.927
> 
> 标签：c#, arrays, list, collections, datatable

DataTable.Rows.Add() 向数据表中添加一行。但是，它如何处理底层数组？

一次添加一行时，是否会在添加每一行的情况下重建整个数组？

或者它是否能够简单地修改现有阵列而不会影响性能？

我想知道在用数据填充数组之前确定数组的大小是否更好，或者数据表是否能够以某种方式修改集合而无需（在幕后）复制和移动内容。

我的理解是，要调整数组，您必须重新定义它并将以前存在的数据移动到新结构中。

我的问题是 Collection.Add() 方法的工作流程是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:44:23.880

使用[DotPeek 之](http://www.jetbrains.com/decompiler/)类的软件看一下：

```
DataTable.Rows.Add(DataRow row)
{
    this.table.AddRow(row, -1);
} 
```

调用：

```
DataTable.AddRow(DataRow row, int proposedID)
{
    this.InsertRow(row, proposedID, -1);
} 
```

调用：

```
DataTable.InsertRow(DataRow row, int proposedID, int pos)
{
    this.InsertRow(row, (long) proposedID, pos, true);
} 
```

调用：

```
DataTable.InsertRow(DataRow row, long proposedID, int pos, bool fireEvent)
{
    Exception deferredException = (Exception) null;
    if (row == null)
        throw ExceptionBuilder.ArgumentNull("row");
    if (row.Table != this)
        throw ExceptionBuilder.RowAlreadyInOtherCollection();
    if (row.rowID != -1L)
        throw ExceptionBuilder.RowAlreadyInTheCollection();
    row.BeginEdit();
    int proposedRecord = row.tempRecord;
    row.tempRecord = -1;
    if (proposedID == -1L)
        proposedID = this.nextRowID;
    bool flag;
    if (flag = this.nextRowID <= proposedID)
        this.nextRowID = checked (proposedID + 1L);
    try
    {
        try
        {
            row.rowID = proposedID;
            this.SetNewRecordWorker(row, proposedRecord, DataRowAction.Add, false, false, pos, fireEvent, out deferredException);
        }
        catch
        {
            if (flag && this.nextRowID == proposedID + 1L)
                this.nextRowID = proposedID;
            row.rowID = -1L;
            row.tempRecord = proposedRecord;
            throw;
        }
        if (deferredException != null)
            throw deferredException;
        if (!this.EnforceConstraints || this.inLoad)
            return;
        int count = this.columnCollection.Count;
        for (int index = 0; index < count; ++index)
        {
            DataColumn dataColumn = this.columnCollection[index];
            if (dataColumn.Computed)
                dataColumn.CheckColumnConstraint(row, DataRowAction.Add);
        }
    }
    finally
    {
        row.ResetLastChangedColumn();
    }
} 
```

调用：

```
DataTable.SetNewRecordWorker(DataRow row, int proposedRecord, DataRowAction action, bool isInMerge, bool suppressEnsurePropertyChanged, int position, bool fireEvent, out Exception deferredException)
{
    deferredException = (Exception) null;
    if (row.tempRecord != proposedRecord)
    {
    if (!this.inDataLoad)
    {
        row.CheckInTable();
        this.CheckNotModifying(row);
    }
    if (proposedRecord == row.newRecord)
    {
        if (!isInMerge)
        return;
        this.RaiseRowChanged((DataRowChangeEventArgs) null, row, action);
        return;
    }
    else
        row.tempRecord = proposedRecord;
    }
    DataRowChangeEventArgs args = (DataRowChangeEventArgs) null;
    try
    {
    row._action = action;
    args = this.RaiseRowChanging((DataRowChangeEventArgs) null, row, action, fireEvent);
    }
    catch
    {
    row.tempRecord = -1;
    throw;
    }
    finally
    {
    row._action = DataRowAction.Nothing;
    }
    row.tempRecord = -1;
    int record = row.newRecord;
    int num = proposedRecord != -1 ? proposedRecord : (row.RowState != DataRowState.Unchanged ? row.oldRecord : -1);
    if (action == DataRowAction.Add)
    {
    if (position == -1)
        this.Rows.ArrayAdd(row);
    else
        this.Rows.ArrayInsert(row, position);
    }
    List<DataRow> cachedRows = (List<DataRow>) null;
    if ((action == DataRowAction.Delete || action == DataRowAction.Change) && (this.dependentColumns != null && this.dependentColumns.Count > 0))
    {
    cachedRows = new List<DataRow>();
    for (int index = 0; index < this.ParentRelations.Count; ++index)
    {
        DataRelation relation = this.ParentRelations[index];
        if (relation.ChildTable == row.Table)
        cachedRows.InsertRange(cachedRows.Count, (IEnumerable<DataRow>) row.GetParentRows(relation));
    }
    for (int index = 0; index < this.ChildRelations.Count; ++index)
    {
        DataRelation relation = this.ChildRelations[index];
        if (relation.ParentTable == row.Table)
        cachedRows.InsertRange(cachedRows.Count, (IEnumerable<DataRow>) row.GetChildRows(relation));
    }
    }
    if (!suppressEnsurePropertyChanged && !row.HasPropertyChanged && (row.newRecord != proposedRecord && -1 != proposedRecord) && -1 != row.newRecord)
    {
    row.LastChangedColumn = (DataColumn) null;
    row.LastChangedColumn = (DataColumn) null;
    }
    if (this.LiveIndexes.Count != 0)
    {
    if (-1 == record && -1 != proposedRecord && (-1 != row.oldRecord && proposedRecord != row.oldRecord))
        record = row.oldRecord;
    DataViewRowState recordState1 = row.GetRecordState(record);
    DataViewRowState recordState2 = row.GetRecordState(num);
    row.newRecord = proposedRecord;
    if (proposedRecord != -1)
        this.recordManager[proposedRecord] = row;
    DataViewRowState recordState3 = row.GetRecordState(record);
    DataViewRowState recordState4 = row.GetRecordState(num);
    this.RecordStateChanged(record, recordState1, recordState3, num, recordState2, recordState4);
    }
    else
    {
    row.newRecord = proposedRecord;
    if (proposedRecord != -1)
        this.recordManager[proposedRecord] = row;
    }
    row.ResetLastChangedColumn();
    if (-1 != record && record != row.oldRecord && (record != row.tempRecord && record != row.newRecord) && row == this.recordManager[record])
    this.FreeRecord(ref record);
    if (row.RowState == DataRowState.Detached && row.rowID != -1L)
    this.RemoveRow(row, false);
    if (this.dependentColumns != null)
    {
    if (this.dependentColumns.Count > 0)
    {
        try
        {
        this.EvaluateExpressions(row, action, cachedRows);
        }
        catch (Exception ex)
        {
        if (action != DataRowAction.Add)
            throw ex;
        deferredException = ex;
        }
    }
    }
    try
    {
    if (!fireEvent)
        return;
    this.RaiseRowChanged(args, row, action);
    }
    catch (Exception ex)
    {
    if (!ADP.IsCatchableExceptionType(ex))
        throw;
    else
        ExceptionBuilder.TraceExceptionWithoutRethrow(ex);
    }
} 
```

它调用其中之一：

```
DataRowCollection.ArrayAdd(DataRow row)
{
  row.RBTreeNodeId = this.list.Add(row);
}

DataRowCollection.ArrayInsert(DataRow row, int pos)
{
  row.RBTreeNodeId = this.list.Insert(pos, row);
} 
```

`this.list`是 类型`DataRowCollection.DataRowTree`，派生自`RBTree<DataRow>`。

```
private sealed class DataRowTree : RBTree<DataRow> 
```

`RBTree<DataRow>`并`RBTreeNodeId`让我们得出结论，**正在使用****[红黑树！](http://en.wikipedia.org/wiki/Red%E2%80%93black_tree)**

# php - 使用 PHP 生成 JSON 文件

> ID：10365893
> 
> 赞同：0
> 
> 时间：2012-04-28T17:33:45.590
> 
> 标签：php, json

我有 PHP 生成 JSON 数据，但我在`example.json`从中创建文件时遇到问题。我究竟做错了什么？我只是得到一个空白屏幕。

```
<?php 
require('wp-load.php');

$EM_Events = EM_Events::get( array(
'scope'=>'future', 
'orderby'=>'event_start_date,event_start_time', 
'limit'=>1, 
'owner'=>false, 
'category'=>'6,7,8,10,11,12,13,14')
);

foreach ($EM_Events as $event) {
        //Event Detail
        $event_id = esc_html($event->event_id);
        $event_name = esc_html($event->name);

$events[] = array(
'event_id'=> $event_id,
'event_name'=> $event_name,
);

} 

$response['events'] = $events;

$fp = fopen('example.json', 'w');
fwrite($fp, json_encode($response));
fclose($fp);

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:36:33.020

尝试使用 Fiddler [http://www.fiddler2.com/](http://www.fiddler2.com/)之类的响应嗅探工具或使用 Firebug 之类的浏览器开发工具的网络选项 卡[http://getfirebug.com/](http://getfirebug.com/)浏览器不知道如何渲染它。

# android - 在启动之前创建/渲染 Activity

> ID：10365895
> 
> 赞同：0
> 
> 时间：2012-04-28T17:33:48.663
> 
> 标签：android, android-intent, android-activity

我们使用不同的活动来浏览我们的应用程序。其中一个非常复杂，包含很多嵌套的视图/图像等，所以当我`startActivity(intent1)`在它之前的活动中使用时，会有短暂的延迟，感觉/看起来很迟钝。创建内容视图所需的所有信息都是预先知道的。

所以我的问题是：有没有一种聪明的方法来预渲染/预加载活动或其内容视图？

正如我所想的那样，意图只保存有关下一个活动的信息，但没有活动本身的实例，所以我假设在我调用 startMethod 之前没有办法告诉打算创建活动。

我的一个想法是在开始活动之前创建一个静态视图，并在`onCreate()`方法中将此视图设置为 contentView。但这对我来说似乎是一个糟糕的黑客行为。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:54:55.580

最好的解决方案不是开始一个全新的活动，而是使用[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)或[ViewFlipper](http://developer.android.com/reference/android/widget/ViewFlipper.html)。视图之间的切换应该几乎是瞬时的，您也有机会轻松应用动画。

如果这是不可能的，你可以开始一个新的活动，但在那里放一个 ViewSwitcher。第一个视图将是一个进度条。第二个视图被膨胀并添加到后台线程中的切换器。

# ios - iS 旋转视图 CGAffineTransformMakeRotation

> ID：10365898
> 
> 赞同：1
> 
> 时间：2012-04-28T17:33:55.807
> 
> 标签：ios, rotation

如何使用 CGAffineTransformMakeRotation 手动将视图旋转 180 度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:37:27.063

```
UIView *myView = [[UIView alloc] init];
[myView setTransform:CGAffineTransformMakeRotation(M_PI)]; 
```

# php - 如果下拉时一直出现空消息

> ID：10365899
> 
> 赞同：0
> 
> 时间：2012-04-28T17:33:58.150
> 
> 标签：php, mysql

在我的下拉框中，这是一个必填字段，但即使选择了某些内容，也会出现验证消息，

```
 if(empty($data['department']) || strlen($data['department']) )
    {
    $err[] = "ERROR - Please enter the department you are applying for.";
    } 
```

这是从

```
$insert = "INSERT into users
`department`,  VALUES ( '$data[department] )"; 
```

HTML：

```
<td>Department<span class="required">*</span> </td>
        <td><select name="department"  id="department">

            <option value="" selected></option>

            <option <? if($department == '1') { ?> selected <? } ?>   
 value="1">1</option>

            <option <? if($department== '2') { ?> selected <? } ?> value="2">2   
  </option>

            <option <? if($department == '3') { ?> selected <? } ?> 
 value="3">3</option>

            </select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:41:15.450

试试这个：

```
if (empty($data['department']))
{
    $err[] = "ERROR - Please enter the department you are applying for.";
} 
```

如果变量为空，则不需要检查 strlen

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:41:24.503

这条线是矛盾的，并且总是会返回 true。

```
empty($data['department']) || strlen($data['department']) 
```

只需使用前半部分，你会没事的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:38:20.673

您可能想从中删除`selected`并`<option value="" selected>`尝试，因为如果是，`$department==1`那么您有两个`selected`可能导致错误的选项。

# c++ - 开关头中的变量声明？

> ID：10365901
> 
> 赞同：1
> 
> 时间：2012-04-28T17:34:23.703
> 
> 标签：c++

在浏览我朋友的代码时，我注意到了这一点：

```
switch(State &state = getState()) {
case Begin: state = Search; break;
// other stuff similar
} 
```

开关头中的变量是什么？他正在使用 GCC，所以我认为这可能是 GCC 扩展。任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-28T17:36:31.820

这不是秘密或 GCC 扩展。`if`允许在s、`while`s 和`switch`es之类的条件下声明变量。例如：

```
while (char c = cin.get()) { ... } 
```

或者

```
if (int* something = (int*)malloc(4)) { // but don't use malloc in C++
    // ...
} 
```

在它们被声明为初始化后，它们被转换为一个`bool`值，如果它们评估为`true`块，则执行该块，否则跳过该块。它们的范围是在其条件中声明它们的构造的范围（在 的情况下`if`，范围也在所有`else if`and`else`块上）。

在 C++03 标准的 §6.4.1 中，它说

> 选择语句选择几个控制流之一。
> 
> ```
> selection-statement:
> 
>     if ( condition ) statement
>     if ( condition ) statement else statement
>     switch ( condition ) statement
> 
> condition:
> 
>     expression
>     type-specifier-seq declarator = assignment-expression 
> ```

如您所见，它允许`type-specifier-seq declarator = assignment-expression`在`if`or的条件下`switch`。你会在“重复结构”部分找到类似的东西。

此外，`switch`es 适用于可以隐式转换为整数或类型的类的整数或`enum`类型*或*`enum`实例（第 6.4.4 节）：

> 在 switch 语句中作为初始化声明的条件的值是声明变量的值，如果它具有整数或枚举类型，或者是该变量隐式转换为整数或枚举类型的值。

实际上，我是从您在“C++ 的隐藏功能”问题上发布的[**答案中了解到的。**](https://stackoverflow.com/a/312449/726361)所以我很高兴我能提醒你：）

# php - 以可扩展的方式计算文字、图像、视频和音频文件的数量？

> ID：10365902
> 
> 赞同：5
> 
> 时间：2012-04-28T17:34:31.280
> 
> 标签：php, jquery, mysql, metadata, expressionengine

我正在尝试收集尽可能多的有趣元数据，以向我正在开发的表达式引擎站点的读者显示，并正在寻找有关以可扩展方式计算此元数据的特定位的方法（或实际上是可行性）的指导。

表达式引擎允许在本地收集和显示相当多的数据，例如帖子总数和日期、评论总数和日期、标签总数等。***但是我特别感兴趣的是找到一种方法来计算和显示总数诸如单词、图像、视频或音频文件的数量之类的数据，不仅在单个帖子中，而且在一个频道中，以及整个网站范围内。***

这些总数将根据访问的位置在上下文中显示。例如，搜索结果将显示单个帖子中包含的单词/图像/等的数量，频道的“关于”页面将显示整个频道的总数，而网站的“关于”页面将显示整个网站的总数。我不清楚最好的方法，或者这是否真的可行。

我不是专业的网页设计师，所以我对 html5/css3/ee 以外的任何东西的了解都有些有限，但我思考过：

*   在每个帖子的基础上，在自定义字段中输入这些数字，但不清楚它们是否可以一起添加到渠道和站点范围的总数中。
*   使用 PHP 的“计数”方法，但对 PHP 不是很熟悉，所以不确定它是否合适。
*   使用一些mySql方法查询数据库，再次不确定。
*   利用表达式引擎“查询模块”。！？
*   使用一些Jquery插件单独进行计数，然后在事后添加。

可能是单词、图像、视频和音频文件的计数以及可扩展性是不同的问题，但事实是我对探索什么途径感到非常困惑。因此，我们将不胜感激任何和所有建议或指导。

**更新：**我正在研究收集和添加结果的数据库方法，但我仍然对确定实际执行单词/图像/视频/音频文件计数的最佳方法感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:27:35.970

有很多解决方案，但我想到了一些可以帮助你的方法。我将只展示我非常喜欢的，甚至用于我自己的网站的那个。

一种解决方案是在您感兴趣的表中创建一个计数列，当有人发布或做某事时自动更新。您还可以创建一个名为 globalcount 的新表或任何计算站点范围内所有内容的表。这可以稍后显示。如果您想要该信息，您首先需要有一种计算单词的方法/功能等。当有人发帖时，只需从上一个上数一个。

以上是我用的。我使用了一个 misc 表（它有一行包含所有数据。您可以改为让每一行包含您的信息，例如“名称”“值”），它看起来像：

```
(`views`, `totalusers`, `totalgroups`, `totalthreads`, `totalposts`, `totalarticles`, `totalcomments`, `totalpms`, `activeusercount`) 
```

在我的“新闻”表中，我使用“总评论”来计算该文章中发布的本地评论。所以我有本地和全球评论。

就我而言，如果我想在新用户注册后更新“misc”表中的“totalusers”，我只需调用我的 $misc 数组并执行：$newtotalusers = intval($misc['totalusers'] + 1 );

```
mysql_query("UPDATE `misc` SET `totalusers`='$newtotalusers'"); 
```

或者您也可以只使用“ `totalusers`+1”。

您想做的任何其他事情也可以这样做，例如任何文件计数，反之亦然。希望这可以帮助 ：）

最后一件事，您还可以编写一个脚本，以防数据因错误而关闭，该错误会更新和修复任何表的计数值。

# objective-c - 我的 iOS Google OAuth 响应应该使用哪个重定向 URI？

> ID：10365906
> 
> 赞同：3
> 
> 时间：2012-04-28T17:35:11.420
> 
> 标签：objective-c, ios, oauth, uri, gdata

我正在使用 webview 来显示 Google 登录 URL，并且根据此页面（[https://developers.google.com/accounts/docs/OAuth2InstalledApp#choosingredirecturi](https://developers.google.com/accounts/docs/OAuth2InstalledApp#choosingredirecturi)），重定向回调有两种选择。我应该选择哪个？iOS 是否监听对 localhost 的响应？如果是这样，我如何检索它们？

# android - 谷歌地图应用程序加载到模拟器，但不会在模拟器上打开

> ID：10365908
> 
> 赞同：0
> 
> 时间：2012-04-28T17:35:25.987
> 
> 标签：android, maps

我按照谷歌地图教程创建了一个新的谷歌地图项目，获得了一个 api 密钥，在清单文件中包含 和 INTERNET 权限。包括

在 main.xml 文件中，并按照步骤修改 main.java 文件。该应用程序将安装到模拟器中，但是当我单击该应用程序时，会显示一条通知：应用程序已意外停止。

我已经用尽了所有资源，所以希望有人可以提供帮助。提前感谢所有帮助。此外，在 logcat 中，我在模拟器中“单击”应用程序后出现许多错误。我读过但没有找到解决办法的一个特别错误是：

引起：java.lang.ClassNotFoundException: com.hutzley.TestMap.MyApplication in loader dalvik.system.PathClassLoader

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T18:10:24.840

确保您使用的是支持 Google API 的特殊模拟器图像之一，否则您将尝试在缺少地图工作所需的库的环境中运行您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:51:29.040

您的应用程序中的某些内容试图引用`com.hutzley.TestMap.MyApplication`，而您的项目中不存在此类。由于来自 Java 的引用通常会产生编译错误，因此我建议您检查清单，找到引用的位置，并将其更改为应有的内容。

# file - SVN 将文件重命名为目录

> ID：10365909
> 
> 赞同：1
> 
> 时间：2012-04-28T17:35:30.953
> 
> 标签：file, svn, repository, rename

我需要使用特定文件的名称作为目录名称，并将该文件移动到全新的目录中。

我的回购现在看起来像这样：

```
file1
file2
dir1/
  dir1file1
search
source_code2 
```

我需要得到这个：

```
file1
file2
dir1/
  dir1file1
search/
  search_contents
source_code2 
```

我需要做的操作是：

```
 mv search search_contents
 rm search
 mkdir search
 mv search_contents search/ 
```

我想我可以这样做：

```
 svn move search search_contents
 svn del search
 mkdir search
 svn add search
 svn move search_contents search/ 
```

是否有意义？

svn 如何处理单个文件名上的多个命令？（不做提交）或者我应该做中间提交？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:09:05.273

如果您尝试在中间不提交和更新的情况下执行此操作，您将收到如下消息：

> svn：不能用不同类型的节点替换“搜索”；在添加“搜索”之前，必须提交删除并更新父级

只需将您的 svn 命令列表更改为：

```
svn move search search_contents 
svn commit -m "Renamed file"
svn up
mkdir search
svn add search
svn mv search_contents search
svn commit -m "done" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-30T21:16:43.477

事实证明，这些步骤可以在一次[提交](http://paste.opensuse.org/29937545)中完成：

```
# variant 1
svn move search search-newname
mkdir search
svn add search
svn move search-newname search/search
svn commit -m "magic"

# variant 2
svn delete search
mkdir search
svn add search
svn copy "^/search@3" search/
svn commit -m "more magic" 
```

事情是我不确定，我不想搞砸回购，这个答案的功劳在 irc.freenode.net 上的#svn 频道上是默认的

另外，我要感谢 danilsh 和 wayita 提到 svnmucc。[svnmucc](http://svn.apache.org/repos/asf/subversion/trunk/tools/client-side/svnmucc/)是一个可以将多个命令组合在一个列表中的工具（cp、mv、rm 等）

# c++ - McCabe 的圈复杂度

> ID：10365912
> 
> 赞同：2
> 
> 时间：2012-04-28T17:36:11.760
> 
> 标签：c++, complexity-theory

为了计算代码的圈复杂度，我绘制了一个由节点和边组成的控制流程图，它帮助我计算了 V (G) = E - N + 2 在我的例子中 E = 15 和 N = 11。产生一个圈6.复杂度

现在为了确认我的答案，我想在寻找代码爆炸的线性独立路径方面得到一些帮助：

```
int maxValue = m[0][0];         
for (int i = 0; i < N; i++)         
{                       
   for (int j = 0; j < N; j++)          
   {                        
      if ( m[i][j] > maxValue )         
      {                     
         maxValue = m[i][j];            
      }                     
   }                        
}                   
cout << maxValue << endl;           
int sum = 0;                    
for (int i = 0; i < N; i++)         
{                       
   for (int j = 0; j < N; j++)          
   {                        
      sum = sum + m[i][j];          
   }                        
}                           
cout << sum << endl; 
```

这应该等于我的 V (G) 的结果，否则我的计算是错误的。感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:56:32.740

McCabe 的圈复杂度给出了一个上限。考虑以下：

```
void func (const bool do_special) {
    if (do_special) {
        do_something_special_at_the_start();
    }

    always_do_this_stuff_in_the_middle();

    if (do_special) {
        do_something_special_at_the_end();
} 
```

从图论的角度来看，这具有三的圈复杂度。但是，由于`do_special`是常量，因此代码中只有两条独立的路径。图论模型不知道有些路径是不可能的。*通过图的可能*路径的数量有时小于圈复杂度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T06:28:20.487

Hammen，一个很好的例子，说明这个指标给出了上限。但是不知何故，你可能在给出这个例子的复杂性时忽略了一点。由于您已经展示了 do_something_...()，它们是函数调用。因此，在这种情况下 P = 3，因此循环复杂度将由 V(G) = E - N - 2*P 给出，E 和 N 也应该包括被调用函数的边和节点。我认为相反，这个例子可以写成：

```
void func (const bool do_special) {

   if (do_special) {
      /* do something at start */
   }
   :
   /* do something at middle */
   :
   if (do_speical) {
      /* do something at end */
   }
} 
```

希望你同意！

# iphone - iPhone - 带有双引号转义字符的 Localizable.strings

> ID：10365913
> 
> 赞同：8
> 
> 时间：2012-04-28T17:36:15.910
> 
> 标签：iphone, objective-c, ios, xcode

在 Localizable.strings 文件中，如果我添加转义字符“，则文件将无法构建过程。

例如：

```
"Now open ""Phone"" application" = "Maintenant ouvert ""Téléphone"" application"; 
```

由于这条线，我得到一个错误。如果注释掉，它工作得很好。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-28T17:41:03.800

您必须使用反斜杠转义引号：

```
"Now open \"Phone\" application" = "Maintenant ouvert \"Téléphone\" application"; 
```

# ios - MonoTouch 在设备上随机崩溃，而不是在模拟器上

> ID：10365919
> 
> 赞同：5
> 
> 时间：2012-04-28T17:36:48.153
> 
> 标签：ios, xamarin.ios, crash-reports, aot

我认为这与记忆有关，但我已经做了我能想到的一切。我已经确保类是处置财产。在类级别而不是函数范围内维护硬引用，用于在我使用它们时可能会被 GC 处理的东西等。

基本上，该应用程序在模拟器中运行良好，但在真实设备上的同一位置崩溃。似乎我得到了几个不同的堆栈，但它们都在同一个地方。

我在我的应用程序中使用了大量的事件。线程太多？

> 堆栈跟踪：
> 
> 在 Newtonsoft.Json.JsonWriter.WriteValue (object) 在 Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue (Newtonsoft.Json.JsonWriter,object,Newtonsoft.Json.Serialization.JsonContract,Newtonsoft.Json.Serialization.JsonProperty,Newtonsoft.Json。 Serialization.JsonContract) 在 Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.WriteMemberInfoProperty (Newtonsoft.Json.JsonWriter,object,Newtonsoft.Json.Serialization.JsonProperty,Newtonsoft.Json.Serialization.JsonContract) 在 Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject ( Newtonsoft.Json.JsonWriter,object,Newtonsoft.Json.Serialization.JsonObjectContract,Newtonsoft.Json.Serialization.JsonProperty,Newtonsoft.Json.Serialization.JsonContract) 在 Newtonsoft.Json.Serialization.JsonSerializerInternalWriter。在 Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeList (Newtonsoft.Json.JsonWriter.SerializeList (Newtonsoft.Json.JsonWriter) ,Newtonsoft.Json.Utilities.IWrappedCollection,Newtonsoft.Json.Serialization.JsonArrayContract,Newtonsoft.Json.Serialization.JsonProperty,Newtonsoft.Json.Serialization.JsonContract) 在 Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue (Newtonsoft.Json.JsonWriter,对象,Newtonsoft.Json.Serialization.JsonContract,Newtonsoft.Json.Serialization.JsonProperty,Newtonsoft.Json.Serialization.JsonContract) 在 Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.WriteMemberInfoProperty (Newtonsoft.Json.JsonWriter,object,Newtonsoft.Json.Serialization.JsonProperty,Newtonsoft.Json.Serialization.JsonContract) 在 Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeObject (Newtonsoft.Json.JsonWriter,object,Newtonsoft.Json.Serialization.JsonObjectContract,Newtonsoft.Json.Serialization.JsonProperty ,Newtonsoft.Json.Serialization.JsonContract) 在 Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.SerializeValue (Newtonsoft.Json.JsonWriter,object,Newtonsoft.Json.Serialization.JsonContract,Newtonsoft.Json.Serialization.JsonProperty,Newtonsoft.Json.Serialization. JsonContract) 在 Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize (Newtonsoft.Json.JsonWriter,object) 在 Newtonsoft.Json.JsonSerializer.SerializeInternal (Newtonsoft.Json.JsonWriter,object) 在 Newtonsoft.Json.JsonSerializer。在 RestSharp 的 /Users/sonmez56/Projects/TrackAbout.Mono/RestSharp/RestSharp/Serializers/JsonSerializer.cs:64 中的 RestSharp.Serializers.JsonSerializer.Serialize (object) [0x0001c] 序列化 (Newtonsoft.Json.JsonWriter,object)。 RestRequest.AddBody (object,string) [0x00019] in /Users/sonmez56/Projects/TrackAbout.Mono/RestSharp/RestSharp/RestRequest.cs:203 at RestSharp.RestRequest.AddBody (object) [0x00000] in /Users/sonmez56/ Projects/TrackAbout.Mono/RestSharp/RestSharp/RestRequest.cs:232 在 TrackAboutMonoCore.Services.TrackAboutAPIRequestBuilder/TARESTRequest.WithBody (T) <0x00097> 在 TrackAboutMonoCore.Services.ActionsService.CustomerSetVolume (int,System.Collections.Generic.List在 /Users/sonmez56/Projects/TrackAbout.Mono/RestSharp/RestSharp/Serializers/JsonSerializer.cs:64 在 /Users/sonmez56/ 中的 RestSharp.RestRequest.AddBody (object,string) [0x00019] 中序列化（对象）[0x0001c] Projects/TrackAbout.Mono/RestSharp/RestSharp/RestRequest.cs:203 at RestSharp.RestRequest.AddBody (object) [0x00000] in /Users/sonmez56/Projects/TrackAbout.Mono/RestSharp/RestSharp/RestRequest.cs:232 at TrackAboutMonoCore .Services.TrackAboutAPIRequestBuilder/TARESTRequest.WithBody (T) <0x00097> 在 TrackAboutMonoCore.Services.ActionsService.CustomerSetVolume (int,System.Collections.Generic.List在 /Users/sonmez56/Projects/TrackAbout.Mono/RestSharp/RestSharp/Serializers/JsonSerializer.cs:64 在 /Users/sonmez56/ 中的 RestSharp.RestRequest.AddBody (object,string) [0x00019] 中序列化（对象）[0x0001c] Projects/TrackAbout.Mono/RestSharp/RestSharp/RestRequest.cs:203 at RestSharp.RestRequest.AddBody (object) [0x00000] in /Users/sonmez56/Projects/TrackAbout.Mono/RestSharp/RestSharp/RestRequest.cs:232 at TrackAboutMonoCore .Services.TrackAboutAPIRequestBuilder/TARESTRequest.WithBody (T) <0x00097> 在 TrackAboutMonoCore.Services.ActionsService.CustomerSetVolume (int,System.Collections.Generic.ListRestRequest.AddBody (object) [0x00000] in /Users/sonmez56/Projects/TrackAbout.Mono/RestSharp/RestSharp/RestRequest.cs:232 at TrackAboutMonoCore.Services.TrackAboutAPIRequestBuilder/TARestRequest.WithBody (T) <0x00097> at TrackAboutMonoCore.Services .ActionsService.CustomerSetVolume (int,System.Collections.Generic.ListRestRequest.AddBody (object) [0x00000] in /Users/sonmez56/Projects/TrackAbout.Mono/RestSharp/RestSharp/RestRequest.cs:232 at TrackAboutMonoCore.Services.TrackAboutAPIRequestBuilder/TARestRequest.WithBody (T) <0x00097> at TrackAboutMonoCore.Services .ActionsService.CustomerSetVolume (int,System.Collections.Generic.List`1<TrackAboutMonoCore.Models.Asset>,System.Action`1>) [0x00000] 在 /Users/sonmez56/Projects/TrackAbout.Mono/TrackAboutMonoCore/Services/ActionsService.cs:24 在 TrackAboutMonoCore.Controllers.LocateController.Save (object,System.EventArgs) [0x00055] 在 /Users/sonmez56 /Projects/TrackAbout.Mono/TrackAboutMonoCore/Controllers/LocateController.cs:64 在 MonoTouch.UIKit.UIBarButtonItem/Callback.Call (MonoTouch.Foundation.NSObject) [0x00010] 在 /Developer/MonoTouch/Source/monotouch/src/UIKit/ UIBarButtonItem.cs:23 at (wrapper runtime-invoke) object.runtime_invoke_dynamic (intptr,intptr,intptr,intptr) <0xffffffff> 在 MonoTouch.UIKit.UIApplication.Main (string[],string,string) [0x0004c] in /Developer /MonoTouch/Source/monotouch/src/UIKit/UIApplication.cs:38 在 /Users/sonmez56/Projects/TrackAbout 中的 TrackAboutIOS.Application.Main (string[]) [0x00000]。Mono/TrackAboutIOS/TrackAboutIOS/Main.cs:16 at (wrapper runtime-invoke) object.runtime_invoke_dynamic (intptr,intptr,intptr,intptr) <0xffffffff>
> 
> 本机堆栈跟踪：
> 
> 0 TrackAboutIOS 0x01d20618 mono_handle_native_sigsegv + 280 1 TrackAboutIOS
> 0x01d45bd4 sigabrt_signal_handler + 180 2 libsystem_c.dylib
> 0x376647ed _sigtramp + 48 3 libsystem_c.dylib
> 0x3765a20f pthread_kill + 54 4 libsystem_c.dylib
> 0x3765329f abort + 94 5 TrackAboutIOS
> 0x01e394ac monoeg_g_log + 208 6 TrackAboutIOS
> 0x01d11664 get_numerous_trampoline + 160 7 TrackAboutIOS
> 0x01d11aac mono_aot_get_imt_thunk + 56 8 TrackAboutIOS
> 0x01dbdc50 initialize_imt_slot + 112 9 TrackAboutIOS
> 0x01dbf1c4 build_imt_slots + 1124 10 TrackAboutIOS
> 0x01dbf32c mono_vtable_build_imt_slot IOS + 120 1
> 0x01d236fc mono_convert_imt_slot_to_vtable_slot + 292 12 TrackAboutIOS 0x01d23974 common_call_trampoline + 284 13 TrackAboutIOS 0x01d21c60 mono_vcall_trampoline + 228 14 TrackAboutIOS
> 0x00934198 generic_trampoline
> 0x00b9fec4 Newtonsoft_Json_Serialization_JsonSerializerInternalWriter_SerializeValue_Newtonsoft_Json_JsonWriter_object_Newtonsoft_Json_Serialization_JsonContract_Newtonsoft_Json_Serialization_JsonProperty_Newtonsoft_Json_Serialization_JsonContract + 1116 16 TrackAboutIOS 0x00ba13bc Newtonsoft_Json_Serialization_JsonSerializerInternalWriter_WriteMemberInfoProperty_Newtonsoft_Json_JsonWriter_object_Newtonsoft_Json_Serialization_JsonProperty_Newtonsoft_Json_Serialization_JsonContract + 1712 17 TrackAboutIOS 0x00ba2a70 Newtonsoft_Json_Serialization_JsonSerializerInternalWriter_SerializeObject_Newtonsoft_Json_JsonWriter_object_Newtonsoft_Json_Serialization_JsonObjectContract_Newtonsoft_Json_Serialization_JsonProperty_Newtonsoft_Json_Serialization_JsonContract + 1784 18 TrackAboutIOS0x00ba0124 Newtonsoft_Json_Serialization_JsonSerializerInternalWriter_SerializeValue_Newtonsoft_Json_JsonWriter_object_Newtonsoft_Json_Serialization_JsonContract_Newtonsoft_Json_Serialization_JsonProperty_Newtonsoft_Json_Serialization_JsonContract + 1724 19 TrackAboutIOS 0x00ba3ec0 Newtonsoft_Json_Serialization_JsonSerializerInternalWriter_SerializeList_Newtonsoft_Json_JsonWriter_Newtonsoft_Json_Utilities_IWrappedCollection_Newtonsoft_Json_Serialization_JsonArrayContract_Newtonsoft_Json_Serialization_JsonProperty_Newtonsoft_Json_Serialization_JsonContract + 2520 20 TrackAboutIOS 0x00ba041cNewtonsoft_Json_Serialization_JsonSerializerInternalWriter_SerializeValue_Newtonsoft_Json_JsonWriter_object_Newtonsoft_Json_Serialization_JsonContract_Newtonsoft_Json_Serialization_JsonProperty_Newtonsoft_Json_Serialization_JsonContract + 2484 21 TrackAboutIOS 0x00ba13bc Newtonsoft_Json_Serialization_JsonSerializerInternalWriter_WriteMemberInfoProperty_Newtonsoft_Json_JsonWriter_object_Newtonsoft_Json_Serialization_JsonProperty_Newtonsoft_Json_Serialization_JsonContract + 1712 22 TrackAboutIOS 0x00ba2a70 Newtonsoft_Json_Serialization_JsonSerializerInternalWriter_SerializeObject_Newtonsoft_Json_JsonWriter_object_Newtonsoft_Json_Serialization_JsonObjectContract_Newtonsoft_Json_Serialization_JsonProperty_Newtonsoft_Json_Serialization_JsonContract + 1784 23 TrackAboutIOS0x00ba0124 Newtonsoft_Json_Serialization_JsonSerializerInternalWriter_SerializeValue_Newtonsoft_Json_JsonWriter_object_Newtonsoft_Json_Serialization_JsonContract_Newtonsoft_Json_Serialization_JsonProperty_Newtonsoft_Json_Serialization_JsonContract + 1724 24 TrackAboutIOS 0x00b9f70c Newtonsoft_Json_Serialization_JsonSerializerInternalWriter_Serialize_Newtonsoft_Json_JsonWriter_object + 356 25 TrackAboutIOS 0x00b2c52c Newtonsoft_Json_JsonSerializer_SerializeInternal_Newtonsoft_Json_JsonWriter_object + 300 26 TrackAboutIOS 0x00b2c3b4 Newtonsoft_Json_JsonSerializer_Serialize_Newtonsoft_Json_JsonWriter_object + 156 27 TrackAboutIOS 0x012010c0 RestSharp_Serializers_JsonSerializer_Serialize_object + 452 28 TrackAboutIOS0x011f8ad0 RestSharp_RestRequest_AddBody_object_string + 396 29 TrackAboutIOS
> 0x011f8e4c RestSharp_RestRequest_AddBody_object + 152 30 TrackAboutIOS 0x011d3c64 TrackAboutMonoCore_Services_TrackAboutAPIRequestBuilder_TARestRequest_WithBody_T_T + 152 31 TrackAboutIOS 0x011d22d4 TrackAboutMonoCore_Services_ActionsService_CustomerSetVolume_int_System_Collections_Generic_List_1_TrackAboutMonoCore_Models_Asset_System_Action_1_RestSharp_RestResponse_1_TrackAbout_Rest_Models_TARestResponse + 328 32 TrackAboutIOS 0x011ce3bc TrackAboutMonoCore_Controllers_LocateController_Save_object_System_EventArgs + 960 33 TrackAboutIOS 0x0139003c MonoTouch_UIKit_UIBarButtonItem_Callback_Call_MonoTouch_Foundation_NSObject + 96 34 TrackAboutIOS 0x008b0450wrapper_runtime_invoke_object_runtime_invoke_dynamic_intptr_intptr_intptr_intptr + 200 35 TrackAboutIOS 0x01d05834 mono_jit_runtime_invoke + 1644 36 TrackAboutIOS
> 0x01dbd09c mono_runtime_invoke + 128 37 TrackAboutIOS
> 0x01e4c054 monotouch_trampoline + 3436 38 CoreFoundation
> 0x30c7f3fd -[NSObject performSelector:withObject:withObject:] + 52 39 UIKit 0x3353efaf -[UIApplication sendAction:to:from:forEvent:] + 62 40 UIKit
> 0x3360476b -[UIBarButtonItem(UIInternal ) _sendAction:withEvent:] + 118 41 CoreFoundation 0x30c7f3fd -[NSObject performSelector:withObject:withObject:] + 52 42 UIKit
> 0x3353efaf -[UIApplication sendAction:to:from:forEvent:] + 62 43 UIKit 0x3353ef6b -[UIApplication sendAction:toTarget: fromSender:forEvent:] + 30 44 UIKit
> 0x3353ef49 -[UIControl sendAction:to:forEvent:] + 44 45 UIKit
> 0x3353ecb9 -[UIControl(内部) _sendActionsForEvents:withEvent:] + 492 46 UIKit 0x3353f5f1 -[UIControl touchesEnded:withEvent:] + 476 47 UIKit
> 0x3353dad3 -[UIWindow _sendTouchesForEvent:] + 318 48 UIKit
> 0x3353d4c1 -[49UI 窗口发送事件UIKit
> 0x3352383d -[UIApplication sendEvent:] + 356 50 UIKit
> 0x335230e3 _UIApplicationHandleEvent + 5826 51 GraphicsServices
> 0x33e1322b PurpleEventCallback + 882 52 CoreFoundation
> 0x30cf9523 **CFRUNLOOP_IS_CALLING_OUT_TO_A3_SOURCE1_PERFORM_UNCTION** + 5826 51 CoreFoundation 0x30cf9523 CFRUNLOOP_IS_CALLING_OUT_TO_A3_SOURCE1_PERFORM_UNCTION**CFRunLoopDoSource1 + 140 54 CoreFoundation 0x30cf8313 __CFRunLoopRun + 1370 55 CoreFoundation
> 0x30c7b4a5 CFRunLoopRunSpecific + 300 56 CoreFoundation
> 0x30c7b36d CFRunLoopRunInMode + 104 57 GraphicsServices
> 0x33e12439 GSEventRunModal + 136 58 UIKit
> 0x33551e7d UIApplicationMain + 1080 59 TrackAboutIOS
> 0x01696c74 wrapper_managed_to_native_MonoTouch_UIKit_UIApplication_UIApplicationMain_int_string** _intptr_intptr + 240 60 TrackAboutIOS 0x00098420 TrackAboutIOS_Application_Main_string__ + 152 61 TrackAboutIOS
> 0x008b0450 wrapper_runtime_invoke_object_runtime_invoke_dynamic_intptr_intptr_intptr_intptr + 200 62 TrackAboutIOS 0x01d05834 mono_jit_runtime_invoke + 1644 63 TrackAboutIOS
> 0x01dbd09c mono_runtime_invoke + 128 64 TrackAboutIOS
> 0x01dc16b4 mono_runtime_exec_main + 436 65 TrackAboutIOS
> 0x01dc1a74 mono_runtime_run_main + 756 66 TrackAboutIOS
> 0x01d0c744 mono_jit_exec + 140 67 TrackAboutIOS
> 0x01e41110 main + 2288 68 TrackAboutIOS
> 0x0009826c start + 52

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-28T20:33:10.437

通常在该行之前有一个异常**类型**和**消息：**

> 堆栈跟踪：

它通常可以很好地提示问题。现在本机堆栈跟踪也在这里提供了一个线索：

> 0x01e394ac monoeg_g_log + 208 6 TrackAboutIOS
> 
> 0x01d11664 get_numerous_trampoline + 160 7 TrackAboutIOS

第一行告诉我们在你的日志中打印了一些东西（或者至少它试图打印）。如果您检查设备的日志（例如使用 Xcode 或`mtouch --logdev`），您应该会看到该消息。

下一行让我觉得你的蹦床用完了（错误信息会告诉你哪种类型）。以下是有关如何增加可用于您的应用程序的蹦床数量的[说明。](http://docs.xamarin.com/ios/troubleshooting#Ran_out_of_trampolines_of_type_0)

注意：如果这与蹦床无关，请编辑您的问题以添加异常类型/消息和设备日志的内容。

# java - spring-hibernate3 与 hibernate-core-4.1.2

> ID：10365920
> 
> 赞同：1
> 
> 时间：2012-04-28T17:36:51.297
> 
> 标签：java, spring, hibernate, maven

我想在 Spring 控制的视图模式中设置打开会话。我正在使用休眠 4.1.2。现在，如果我在 pom.xml 中添加 spring-hibernate3，最终它会添加其依赖项 hibernate-3.2.5.ga。我想我不能同时拥有这两个休眠状态。

如果我想使用 spring-hibernate3 我应该删除 hibernate-core-4.1.2.jar 吗？

这是我的pom：

```
<dependencies>
    <dependency>
        <groupId>org.apache.wicket</groupId>
        <artifactId>wicket-core</artifactId>
        <version>1.5.3</version>
    </dependency>
    <dependency>
        <groupId>org.apache.wicket</groupId>
        <artifactId>wicket-spring</artifactId>
        <version>1.5.3</version>
    </dependency>
    <dependency>
        <groupId>org.apache.wicket</groupId>
        <artifactId>wicket-extensions</artifactId>
        <version>1.5.3</version>
    </dependency>
    <dependency>
        <groupId>org.apache.wicket</groupId>
        <artifactId>wicket-datetime</artifactId>
        <version>1.5.3</version>
    </dependency>
    <dependency>
        <groupId>com.google.code.jqwicket</groupId>
        <artifactId>jqwicket</artifactId>
        <version>0.8</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-core</artifactId>
        <version>3.1.1.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-web</artifactId>
        <version>3.1.1.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>3.1.1.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-beans</artifactId>
        <version>3.1.1.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>4.1.2</version>
    </dependency>
    <dependency>
        <groupId>hsqldb</groupId>
        <artifactId>hsqldb</artifactId>
        <version>1.8.0.10</version>
    </dependency>
    <dependency>
        <groupId>commons-dbcp</groupId>
        <artifactId>commons-dbcp</artifactId>
        <version>1.2.2</version>
    </dependency>       
    <dependency> 
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
    </dependency>   
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>1.4.2</version>
    </dependency>
    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.14</version>
    </dependency>
</dependencies> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:20:35.827

是的，如果您从 pom.xml 文件中删除 hibernate-core 4.1.2 依赖项，您的类路径中将只有 hibernate3 jar。

但是由于spring-hibernate似乎很老了（从Spring的角度来看，最新的是[2.0.8版本](http://search.maven.org/#search%7Cgav%7C1%7Cg%3a%22org.springframework%22%20AND%20a%3a%22spring-hibernate3%22)，最新的Spring Core是3.1.1）

但是我认为您可以在当前设置中使用视图模式中的打开会话，因为 spring-orm-3.1.1 支持 Hibernate4；看看[http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/orm/hibernate4/support/package-summary.html](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/orm/hibernate4/support/package-summary.html)。

# iphone - 获取带有文本的文本字段数

> ID：10365921
> 
> 赞同：0
> 
> 时间：2012-04-28T17:36:54.223
> 
> 标签：iphone, objective-c, xcode, ipad, uitextfield

我有大约 20 个文本字段的视图，我想检查有文本的字段数，而不是空的数字。最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:48:04.727

假设文本字段在里面`theView`：

```
NSUInteger count = 0;
for (UITextField *textField in theView.subviews) {
    if ([textField isKindOfClass: [UITextField class]]) {
        if ([textField.text length])
            count++;
    }
} 
```

# c# - 如何使用for循环将元素加载到数组中？C＃

> ID：10365925
> 
> 赞同：-1
> 
> 时间：2012-04-28T17:37:09.590
> 
> 标签：c#, arrays, windows-phone-7, for-loop

我是新手，从 iOS 转到 WP7。

我正在生成一个随机数系列，我想将其存储到一个数组中。在 iOS 中是这样的

```
for(int i=0; i < num; i++) {

        int rand = arc4random_uniform(70);

        if([rand_array containsObject:[NSNumber numberWithInt:rand]]) {

            i--;

        } 
```

我搜索过，用谷歌搜索过，但认为这是我可以提问的地方。请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:47:56.643

```
int min = 1;
int max = 4;
int num = 3;
Random r = new Random();
Int[] ar ;
ar = new Int[num]; // Creates array with 3 palces {ar[0],ar[1],ar[2])
for(i = 0;i =< num - 1;i++) {
ar[i] = r.Next(min,max); // generate random number between 1-4 (include 1 & 4)
} 
```

我认为这应该有效（或者我不理解你）。祝你好运=]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T18:19:44.687

`Enumerable.Range(1, 70)`生成从 1 到 70 的数字。然后我们将它们像一副纸牌一样洗牌。

```
int[] randomNumbers = Enumerable.Range(1, 70).Shuffle(new Random()).ToArray(); 
```

这需要在同一文件夹中的单独类中。

```
public static IEnumerable<T> Shuffle<T>(this IEnumerable<T> source, Random random)
{
    T[] list = source.ToArray();
    int count = list.Length;

    while (count > 1)
    {
        int index = random.Next(count--);
        yield return list[index];
        list[index] = list[count];
    }
    yield return list[0];
} 
```

这是你想要的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T17:44:35.100

我看不出你的代码有什么意义。我会使用一个列表。

```
for(int i=0; i < num; i++) 
   {
    int rand = arc4random_uniform(70);//hope you know what you did here, I don't

    if(yourList.Contains(rand))
        i--;
    else
        yourList.Add(rand);
    } 
```

如果列表不包含随机数，它将添加它，否则它将重复。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-28T17:44:49.060

在 C# 中做这样的事情：

```
List<int> numbers = new List<int>();

for ( int i = 0; i < num, i++ ) {

    int rand = GetARandomNumber();
    if ( !numbers.Contains( rand ) ) {
        numbers.Add( rand );
    } else {
        i--;
    }

} 
```

您也可能会很好地将其转换为 while 循环：

```
List<int> numbers = new List<int>();

while ( numbers.Count < num ) {

    int rand = GetARandomNumber();
    if ( !numbers.Contains( rand ) ) {
        numbers.Add( rand );
    }

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-28T17:44:51.353

很简单，真的！您的代码的直接端口如下所示：

```
List<int> rand_array = new List<int>();

for(int i = 0; i < num; i++)
{
    int rand = RandomHelper.GetInt(0, 70);
    if(rand_array.Contains(rand))
    {
        i--; 
        continue;
    }

    rand_array.Add(rand);
} 
```

为了在 C# 中生成随机数，有一个恰当地称为“Random”的类。你只需要使用 Random 类的一个实例来生成数字，所以如果你想要这样的东西：

```
static class RandomHelper
{
    static Random rng = new Random(); // Seed it if you need the same sequence of random numbers

    public static int GetInt(int min, int max)
    {
        return rng.Next(min, max);
    }
} 
```

# ipad - 使用 Xcode 4.3.2 故事板进行选择时隐藏主视图控制器

> ID：10365929
> 
> 赞同：2
> 
> 时间：2012-04-28T17:38:16.297
> 
> 标签：ipad, ios5, uiviewcontroller, uisplitviewcontroller, uistoryboard

仅当 iPad 处于纵向视图时选择单元格时，我想隐藏主视图控制器。因此用户将单击单元格，然后主视图控制器将消失（就像在邮件中一样）。我将在哪里以及如何做到这一点？

![在此处输入图像描述](../Images/af5111fb83203afa318333e8775c3143.png)

本项目开源：[https ://github.com/kirkuimet/enzyme](https://github.com/kirkouimet/enzyme)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T15:37:23.260

配置详细视图控制器后，您需要关闭弹出框控制器。

```
if (self.popoverController) {
    [self.popoverController dismissPopoverAnimated:YES];
} 
```

如果您的详细视图控制器还没有一个属性来保存`UIPopoverController`，您可以通过实现这些委托方法来捕获它`UISplitViewControllerDelegate`

```
- (void)splitViewController:(UISplitViewController *)iSplitViewController
     willHideViewController:(UIViewController *)iViewController
          withBarButtonItem:(UIBarButtonItem *)iBarButtonItem
       forPopoverController:(UIPopoverController *)iPopoverController {

    self.popoverController = iPopoverController;
}

- (void)splitViewController:(UISplitViewController *)iSplitViewController
     willShowViewController:(UIViewController *)iViewController
  invalidatingBarButtonItem:(UIBarButtonItem *)iBarButtonItem {

    self.popoverController = nil;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T14:55:10.060

获取注册以获取有关您详细视图的通知。

1）在您的详细视图上注册以获取通知。

```
- (void) viewDidLoad

 {

        //for showing loginview
        [[NSNotificationCenter defaultCenter] addObserver:self  
        selector:@selector(dismissPop) name:@"MASTERROWSELECTED" object:nil];

  } 
```

2）在您对 didSelectRowAtIndexPath 的主视图中执行此操作；

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

         //do normal things you usually do

        //post notification that row is selected and you need to dismiss popover.

        [[NSNotificationCenter defaultCenter] postNotificationName:@"MASTERROWSELECTED" 
         object:nil];

  } 
```

3）将此方法写在您的详细视图上。

```
- (void)dismissPop
{

      if(self.interfaceOrientation == UIInterfaceOrientationPortrait)
      {

             //self.popover is your reference to master view pop 
             if([self.popover isPopoverVisible])
             {
                 [self.popover dismissPopoverAnimated:YES];
             }
      }

} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-28T17:54:56.673

您可以通过使用自定义的 SplitViewController 来实现这一点，例如 Matt Gemmell 的[MGSplitViewController](http://mattgemmell.com/2010/07/31/mgsplitviewcontroller-for-ipad/)。特别是，此实现`toggleMasterView:`向控制器添加了一个方法，您可以从内部调用该方法`didSelectRowAtIndexPath:`。

# java - 以独立模式运行骆驼

> ID：10365930
> 
> 赞同：2
> 
> 时间：2012-04-28T17:38:17.207
> 
> 标签：java, architecture, messaging, apache-camel

我有一个系统，它由多个相互通信的胖客户端应用程序组成。这些应用程序目前通过 rmi 直接相互通信，但我正在探索使用消息传递框架的选项，特别是骆驼。

我知道骆驼可以独立运行（通常在我们进行测试时），但通常部署在容器或 esb 中。如果唯一与之通信的应用程序是桌面（摇摆）应用程序，那么在独立模式下运行骆驼是否合适？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:52:05.020

好吧，是的，不是的。Camel 是一个消息路由器，它可以帮助您定义呼叫路由。但是它不会帮助您选择通信协议。它只是使集成变得越来越快（例如，使用 JMS 与 App1 <-> App2 进行通信，使用 RMI 与 App2 <-> App3 以及其他一些协议用于 App2 <-> App3）。

是的，Camel 可能会部署在独立版本中。[这是如何做到这一点的链接](http://camel.apache.org/running-camel-standalone-and-have-it-keep-running.html)。我建议创建单独的应用程序（我也会在这里使用 Shade Maven 插件来嵌入所有依赖项）。

您也可以考虑使用一些 ESB，例如 Servicemix 或 Fuse。但是，这是相当大的环境......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T20:44:43.767

实际上，ActiveMQ（例如 5.5.1）的普通安装（即解压缩）将与 Camel 捆绑在一起。只需编辑 conf/activemq.xml 并插入*某处。在 conf/camel.xml 中配置骆驼。ActiveMQ 并不附带所有的 Camel 组件，因此只需将任何额外的 Camel jar 文件放到 /lib 中。您可以轻松地删除任何您自己的 .jar 文件，例如在 /lib 中定义一个 RouteBuilder 等。*

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T06:47:39.930

为了在应用程序之间进行通信，我将使用一个独立的 ActiveMQ 代理（通常是两个用于故障转移的实例）并将骆驼嵌入到胖客户端应用程序中。然后，您可以使用骆驼中的 pojo 消息传递功能来实现几乎透明的通信。

请参阅我的博客以获取示例[http://www.liquid-reality.de/x/NoBe](http://www.liquid-reality.de/x/NoBe)*

# html - 如何读取 ASP.Net MVC4 api GET 请求中的基本授权

> ID：10365932
> 
> 赞同：0
> 
> 时间：2012-04-28T17:38:29.980
> 
> 标签：html, asp.net-mvc

我有一个电话应用程序尝试使用 RestSharp 从我的网络 api 获取数据

```
 private void ButtonTestTap(object sender, EventArgs e)
    {
        var client = new RestClient
        {
            CookieContainer = new CookieContainer(),
            BaseUrl = "http://localhost:21688/api/game",
            Authenticator = new HttpBasicAuthenticator("muhcow", "123456")
        };

        RestRequest request = new RestRequest(Method.GET);
        request.AddParameter("id", 5);

        //request.AddBody(5);
        client.GetAsync<LoginResult>(request, (response, ds) =>
        {
            System.Diagnostics.Debug.WriteLine(response.StatusDescription);
            System.Diagnostics.Debug.WriteLine(response.Data);
            System.Diagnostics.Debug.WriteLine(response.Content);
        });
    } 
```

然后想在我的 api 服务器收到此 GET 请求时读取 Authenticator = new HttpBasicAuthenticator("muhcow", "123456") 以便我可以验证用户，但我不确定如何读取数据。

我有这个

```
public class GameController : ApiController
    {
        // GET /api/game/5
    public string Get(int id)
    {
        var sdf2 = ControllerContext.Request.Headers.Authorization.Parameter; 

        //return LoginManager.VerifyLogin(loginData);
        return "Some data";
    } 
```

但是 sdf2 只是有一个奇怪的值 "bXVoY293OjEyMzQ1Ng=="

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T17:47:35.200

该标头是 base64 编码的。将 Convert.FromBase64String() 应用于它，您将看到内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:49:48.567

Authorization.Parameter 是 base64 编码的。您可以在此处查看如何解码的示例[http://arcanecode.com/2007/03/21/encoding-strings-to-base64-in-c/](http://arcanecode.com/2007/03/21/encoding-strings-to-base64-in-c/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T09:54:24.733

```
System.Text.Encoding.UTF8.GetString (Convert.FromBase64String (this.ControllerContext 

.Request .Headers.Authorization.Parameter )) 
```

结果是“muhcow”、“123456”

# objective-c - 无法返回 firstResponder 状态

> ID：10365943
> 
> 赞同：0
> 
> 时间：2012-04-28T17:40:07.903
> 
> 标签：objective-c, first-responder

已将我的 appDelegate 设置为返回 firstResponder 状态，但是当我编译（编译正常）时，控制台返回“无法成为第一响应者”但没有说明原因。

我附上了代码。你能告诉我有什么问题吗？提前致谢。

HypnosisterAppDelegate.m

```
#import "HypnosisterAppDelegate.h"
#import "HypnosisView.h"

@implementation HypnosisterAppDelegate

@synthesize window = _window;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.

  HypnosisView *view = [[HypnosisView alloc] initWithFrame:[[self window]bounds]];
  [[self window]addSubview:view];

  BOOL success = [view becomeFirstResponder];
  if (success) {
    NSLog(@"HypnosisView became the first responder");
    } else {
    NSLog(@"Could not become the first responder");
  }

  self.window.backgroundColor = [UIColor whiteColor];
    [self.window makeKeyAndVisible];
    return YES;
}

-(BOOL)canBecomeFirstResponder
{
  return YES;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:51:44.830

您已经在 HypnosisterAppDelegate 上实现了 canBecomeFirstResponder，它不是 UIResponder 子类。然后您将 becomeFirstResponder 发送到您的自定义视图 (HypnosisView)。

HypnosisView（不是 HypnosisterAppDelegate）需要这样做：

```
-(BOOL)canBecomeFirstResponder
{
  return YES;
} 
```

# c++ - 如何将字符串的所有单词写入不同的变量？

> ID：10365945
> 
> 赞同：1
> 
> 时间：2012-04-28T17:41:02.530
> 
> 标签：c++, string, cin

我想得到一行字符串并将每个单词写入它自己的变量中，这样我就可以在 if 子句中使用它们。

我试过了：

```
cin >> var1;  
cin >> var2;
cin >> var3;
cin >> var4; 
```

但这仅在输入 4 个单词时才有效。我需要一种计算单词的方法，因为我不知道用户输入的单词是 1、2、3、4 还是更多。

也许有一种方法可以获取整个字符串：

```
getline(cin, string1); 
```

然后把它切成文字。对不起，我搜索了很多，但我找不到方法。

我还尝试将 cinbuffer 写入变量，但我能做到这一点的唯一方法是

```
cin >> varx; 
```

仅当 cinbuffer 中有某些内容时才有用。如果不是，则再次要求用户输入。

编辑：刚刚发现这个，对我有用。不管怎么说，还是要谢谢你！ [C++ cin 空格问题](https://stackoverflow.com/questions/2735315/c-cin-whitespace-question)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:59:47.387

你在正确的轨道上。您可以读取一行，`getline()`然后使用 an`istringstream`将该行视为它自己的流。`T`为您碰巧使用的任何类型更改此设置。

```
#include <algorithm>
#include <iostream>
#include <iterator>
#include <sstream>
#include <vector>

int main(int argc, char** argv) {

    using namespace std;

    vector<T> values;

    {
        string line;
        getline(cin, line);
        istringstream stream(line);

        // Read values into vector.
        copy(istream_iterator<T>(stream), istream_iterator<T>(),
            back_inserter(values));
    }

    cout << "Received " << values.size() << " values:\n";

    // Copy values to output.
    copy(values.begin(), values.end(),
        ostream_iterator<T>(cout, "\n"));

    return 0;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:50:41.040

像这样将内容写入不同的变量通常是错误的答案。似乎您想要类似[数组](http://www.cplusplus.com/doc/tutorial/arrays/)的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-28T17:51:47.300

听起来你使用 getline

[http://www.cplusplus.com/reference/string/getline/](http://www.cplusplus.com/reference/string/getline/)

然后使用诸如 boost split 之类的东西将每个项目转储到一个数组中

[http://www.cplusplus.com/faq/sequences/strings/split/](http://www.cplusplus.com/faq/sequences/strings/split/)

# hadoop - MapReduce 中的叉积

> ID：10365948
> 
> 赞同：9
> 
> 时间：2012-04-28T17:41:07.303
> 
> 标签：hadoop, mapreduce

我想使用 Java MapReduce 在 Hadoop 中的两个数据集上执行代价高昂的叉积运算。

例如，我有来自数据集 A 和数据集 B 的记录，我希望数据集 A 中的每条记录与输出中数据集 B 中的每条记录相匹配。我意识到它的输出大小是`|A| * |B|`，但无论如何都想这样做。

我看到 Pig 有[`CROSS`](http://pig.apache.org/docs/r0.10.0/basic.html#cross)但我不知道它是如何在高层实现的。也许我会去看看源代码。

不寻找任何代码，只是想从高层次上了解我应该如何解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T19:52:19.017

在查看文档相似度（将文档与其他所有文档进行比较）时，我做了类似的事情，最终得到了一种自定义输入格式，该格式将两个数据集拆分，然后确保每个数据子集都有一个“拆分”。

所以你的拆分看起来像（每个合并两组 10 条记录，输出 100 条记录）

```
A(1-10) x B(1-10)
A(11-20) x B(1-10)
A(21-30) x B(1-10)
A(1-10) x B(11-20)
A(11-20) x B(11-20)
A(21-30) x B(11-20)
A(1-10) x B(21-30)
A(11-20) x B(21-30)
A(21-30) x B(21-30) 
```

我不记得它的性能如何，但是有一个大小为数千的文档集以相互比较（在 8 节点开发集群上），计算了数百万个交叉产品。

我还可以对算法进行改进，因为某些文档永远不会与其他文档相比得分很高（例如，如果它们之间的时间时间过长），并因此产生更好的分割。

# javascript - 带有下一个和上一个显示的无限轮播

> ID：10365953
> 
> 赞同：0
> 
> 时间：2012-04-28T17:41:48.030
> 
> 标签：javascript, jquery, html, carousel

谁能帮我在无限轮播中显示下一组图像

[http://jqueryfordesigners.com/demo/infinite-carousel.html](http://jqueryfordesigners.com/demo/infinite-carousel.html)

理想情况下，我希望显示下一组图像。我已经成功为 2 个面板制作了一些蹩脚的代码（我假设 3 个图像作为 1 个面板）......有人可以帮助我使其动态化（一个适用于任意数量的面板）并且与我在以下 URL 中摆弄的我不同

[http://jsfiddle.net/adriancoopersfiddle/5yQ4y/](http://jsfiddle.net/adriancoopersfiddle/5yQ4y/)

对不起，我开始学习 Javascript 和 HTML 的方法很糟糕

感谢任何帮助提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T15:20:29.057

看看这个。
[http://www.paulwelsh.info/jquery-plugins/hero-carousel/](http://www.paulwelsh.info/jquery-plugins/hero-carousel/)

它符合你的描述。
您可以将其修改为您的确切要求。 如果它对您有帮助，
这可能也有帮助
[http://jsfiddle.net/JCQ6Q/15/投票。](http://jsfiddle.net/JCQ6Q/15/)
：） 一切顺利

# eclipse - 在 Eclipse 中使用 EGit 推送到远程 Git 存储库时，我应该选择什么？

> ID：10365958
> 
> 赞同：19
> 
> 时间：2012-04-28T17:41:58.750
> 
> 标签：eclipse, git, egit

![EGit 弹出窗口](../Images/37be804817f08455c22f070dbd13e543.png)

是什么

```
HEAD
master [branch] 
```

?

我应该分别为“Source ref”和“Destination ref”选择什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-28T20:12:43.110

[您在Egit Push URI 文档](http://wiki.eclipse.org/EGit/User_Guide#Push_URI)中看到此屏幕：

![推送参考规范](../Images/bb6eb115e42a0d9cc714fae9a99142e0.png)

那是您定义**[refspecs](http://wiki.eclipse.org/EGit/User_Guide#Refspecs)**的地方：

> fetch 和 push 操作使用“refspec”来**描述远程 Ref 和本地 Ref 之间的映射**。
> 从语义上讲，它们定义了本地分支或标签如何映射到远程存储库中的分支或标签。
> 在本机 git 中，它们与格式中的冒号组合`<src>:<dst>`，前面是可选的加号，`+`表示强制更新。
> **在 EGit 中，它们可以在 Push Ref Specification 和 Fetch Ref Specification 和其他对话框中以表格形式显示和编辑**。
> 
> RefSpec 的“左侧”称为源，“右侧”称为目标。
> 根据 RefSpec 是用于 fetch 还是 push，source 和 destination 的语义不同：
> 对于 Push RefSpec，source 表示源 Repository 中的 Ref，destination 表示目标 Repository 中的 Ref。
> 
> ### 推送参考规范
> 
> Push RefSpec 的典型示例可能是

```
HEAD:refs/heads/master 
```

> 这意味着当前签出的分支（由`HEAD`参考表示，请参阅**[Git 参考](http://wiki.eclipse.org/EGit/User_Guide#Git_References)**）将被推送到远程存储库的主分支中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-28T18:17:29.330

我认为您可能应该查看学习指南以了解 git 的术语。也许看看这个网站： http: [//gitready.com/](http://gitready.com/)

`master`是 repo 的默认分支。通常你认为这是你“一直在工作”的生产分支。其他工作可以在其他分支中完成，然后合并到master中。无论如何，“HEAD”只是最近的变化。在您的情况下，您可能会推送到 master （直到您弄清楚分支）。

简而言之，当你在学习 git 时，留在 master 分支上，并跟踪远程 master 分支，并从 master 分支推拉。随着您的使用，您很快就会发现 git 的更多惊人功能。

# c# - 在超类 c# 列表中使用子属性

> ID：10365961
> 
> 赞同：2
> 
> 时间：2012-04-28T17:42:09.760
> 
> 标签：c#

我的场景是这样的：我有一个抽象超类，让我们称这个超类和这个超类的一些子类，SubClass1,2,3.. 我有一个超类列表，最后我添加了一些子类。

我希望找到具有特定于给定子类的某些属性的对象。

例如：

```
public abstract class SuperClass{
public string name;
public int value}
public class SubClass1: SuperClass{
public double speed;}

list<SuperClass> list = new list<SuperClass>(); 
```

所以从这里我想添加子类（具有不同的属性）并动态选择这些不同的属性（例如，如果可能的话，一些客户端谓词）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:54:33.293

尝试使用 linq：

```
var items = list.OfType<TheSubClassTypeWithTheProperty>()
                .Where(x => x.Property == value); 
```

# jquery - 循环对角线动画

> ID：10365963
> 
> 赞同：0
> 
> 时间：2012-04-28T17:42:38.870
> 
> 标签：jquery, animation, loops, diagonal

我正试图让我的宇宙飞船沿对角线向左和向下飞行，但我无法让它重新设置以再次执行相同的循环，任何帮助都会很酷。

```
 $(document).ready(function() {
    setTimeout("spaceship1()",400);
  });

 function spaceship1(){
     $("#spaceship1").animate({
           left:"-=800px", 
           top:"+=800px"
     },2000).animate({
           top:"-800px"
     },0);
     setTimeout("spaceship1()",2000); 
     }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:55:42.380

您可以使用动画中的完成函数来安排/开始下一轮动画，请不要使用带有 的字符串`setTimeout()`，使用实际的函数引用。

您的动画也不会循环回到它开始的地方，因此您必须修复它以使其成为一个完整的循环。如果没有，它不会回到原来的位置。我不确定这是否是有意的。

```
$(document).ready(function() {

     function spaceship1() {
         $("#spaceship1").animate({
               left:"-=800px", 
               top:"+=800px"
         },2000).animate({top:"-800px"}, 2000, function() {
             setTimeout(spaceship1, 2000);
         });
     }

     setTimeout(spaceship1, 400);
}); 
```

# java - 使用jsp将javascript变量添加到会话属性

> ID：10365964
> 
> 赞同：0
> 
> 时间：2012-04-28T17:42:39.290
> 
> 标签：java, javascript, jsp, variables

我必须将 java 脚本变量 time(var time=date.getTime()) 添加到会话中？是否可以将java脚本变量转换为java变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:19:27.423

您不能直接这样做，因为 JS 是客户端，而 Java servlet（JSP 页面）在服务器端运行。您必须将 JS 变量发送到服务器（例如使用 AJAX 请求），然后在 java servlet 中处理发送的值。

# php - 文件上传空字符串

> ID：10365965
> 
> 赞同：0
> 
> 时间：2012-04-28T17:43:17.507
> 
> 标签：php, mysql, file-upload

将图像上传到目录中，似乎总是尝试上传“”，这没什么。而不是真实的图像。我在下面做什么。我知道值是“”，因为它插入到数据库中。

```
<li class="formProductImage">
<span>Image:</span>
<input type="file" name="productImage" /> 
</li> 
```

和PHP：

```
if ($_FILES["productImage"]["error"] > 0)
    {
        echo "Return Code: " . $_FILES["productImage"]["error"] . "<br />";
    }
else
    {
    echo "Upload: " . $_FILES["productImage"]["name"] . "<br />";
    echo "Type: " . $_FILES["productImage"]["type"] . "<br />";
    echo "Size: " . ($_FILES["productImage"]["size"] / 1024) . " Kb<br />";
    echo "Temp file: " . $_FILES["productImage"]["tmp_name"] . "<br />";
    $filename = mysql_real_escape_string($_FILES['productImage']['name']);

      $query = "UPDATE products SET image = '$filename' WHERE name = '$name'";
      $result = mysql_query($query);

        if (mysql_affected_rows() == 1) {
            // Show thank you message
            echo '<span style="color:green;">Your image was added to database correctly.</span>';

            if (file_exists("uploaded/" . $_FILES["productImage"]["name"]))
            {
                echo $_FILES["productImage"]["name"] . " already exists. ";
            }
            else
            {
                move_uploaded_file($_FILES["productImage"]["tmp_name"],
                "uploaded/" . $_FILES["productImage"]["name"]);
                echo "Stored in: " . "uploaded/" . $_FILES["productImage"]["name"];
            }

        } else {
            echo '<font color="red">Image note inserted into database.</font>';
            echo mysql_error();
        }

    }
                    }

                        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T17:54:43.737

确保你有`enctype="multipart/form-data"`标签`<form>`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T17:45:56.043

改变这一行：

```
$filename = mysql_real_escape_string($_FILES['file']['name']); 
```

到 ：

```
$filename = mysql_real_escape_string($_FILES['productImage']['name']); 
```

# sharepoint - 如何在 SharePoint 列表中定义 IP 地址字段

> ID：10365967
> 
> 赞同：0
> 
> 时间：2012-04-28T17:43:18.977
> 
> 标签：sharepoint

我正在使用 Visual Studio 2010 创建一个列表，我希望该列表包含 IP-Address 字段，我发现该字段不可用，所以我想我需要定义该字段。

我如何以编程方式定义该字段类型？

[编辑：我按照这里](http://weblogs.asp.net/sreejukg/archive/2012/02/05/developing-custom-field-type-for-sharepoint-2010.aspx)的教程创建自定义字段，但是当我从 Visual Studio 添加列表时，我尝试将类型更改为 Ip 地址，但我找不到它！

![此处的图像显示我无法在 Type 中找到它](../Images/79e3597dfffed844609dfa3f4724fd89.png)

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T17:48:44.147

我认为这不是您使用的 Visual Studio 2010。像您展示的列表向导不是 VS2010 的一部分，而是新 Visual Studio 即将推出的功能之一 - 或者您可能正在使用某些插件。在任何情况下，您很可能都无法在这样的下拉框中看到您的自定义字段类型。您可以使用常规 declerative 方式使用您的字段类型（或以编程方式）创建列表。

简而言之：使用 declerative 方式（或程序化方式）来声明您的列表。VS 11 将无法显示您的自定义字段类型 - 这将非常神奇，因为您的字段类型几乎可以做任何事情（自定义字段渲染器、验证等） - 您无法在向导中“显示”它.

# css - 检查页面上未使用的 CSS 类

> ID：10365971
> 
> 赞同：3
> 
> 时间：2012-04-28T17:44:07.717
> 
> 标签：css

我正在尝试简化我的页面。目前我包含了几个 CSS 文件。我想通过从一个大的 CSS 文件中获取一些使用的样式来消除一些 CSS 包含。

找出特定 CSS 文件中使用了哪些样式的最佳方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-28T17:47:02.027

在 Chrome 中，您可以审核您的页面，这将显示未使用的规则，包括它们来自哪个文件。只需按 F12 加载开发者工具，点击“审核”，然后点击“运行”。

![在此处输入图像描述](../Images/e7eed1bc2ef0ef24a4fdcc2bd55389c6.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T17:52:03.317

所有现代浏览器都提供了开发者工具。它们中的大多数允许您通过右键菜单检查元素。在那里，您将看到为这个或那个 html 元素提供样式的样式表（即使样式表中有行号）。我知道 Opera 有一个扩展（[https://addons.opera.com/en/extensions/details/dust-me-selectors-for-opera/](https://addons.opera.com/en/extensions/details/dust-me-selectors-for-opera/)）可以检查您的 CSS 是否有空（未使用）选择器，我'确定还有其他浏览器的其他插件或扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-06T11:47:24.430

只需按下`F12`加载开发者工具，然后点击左上角的“元素”。现在单击它下方的任意位置并按`Ctrl`+ `F`，它将打开查找对话框。输入`class`它。它将`class`在黄色背景的页面中显示单词用于定义类的位置。单击该黄色单词会在左侧显示课程详细信息。将所有课程复制到记事本。

# c - 字符计数程序不输出任何内容？

> ID：10365973
> 
> 赞同：1
> 
> 时间：2012-04-28T17:44:17.007
> 
> 标签：c, linux, unix

很抱歉问了这么简单的问题，我还在学习 C 并先了解基础知识。

我正在创建一个字符计数程序，但是当我执行程序并尝试输入“h”例如然后按 Enter 时出现一个新行并且没有输出到该行？

代码：

```
#include <stdio.h>

/* Copy input and count characters 2nd version */

main() {
    double cc;
    for(cc = 0; getchar() != EOF; ++cc);
    printf("%.0f\n", cc);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-28T17:46:20.807

输入完字符后，您必须按 表示输入流结束`Ctrl-D`。否则您的程序将继续等待更多输入。

PS你为什么要为计数器使用`double`变量？整数类型会更合适。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-28T18:07:24.307

也许（我不确定你到底想要什么）你在`;`之后有一个额外的`for()`，这意味着一个空语句。所以你的程序将运行空语句（换句话说，什么都不做）直到输入结束（如果输入是终端，你可能需要 a `CTRL+D`），然后打印（一次）字符数。

如果您希望您的程序在输入中的每个字符后打印计数器，请将其删除`;`，这样`printf`就会进入循环。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-04-09T16:56:17.933

在最后包含这一行，您将获得输出：

```
return 0; 
```

# css - 图像精灵 - 如何选择正确的区域然后放置在所需的位置

> ID：10365974
> 
> 赞同：1
> 
> 时间：2012-04-28T17:44:17.460
> 
> 标签：css, positioning, background-image, css-sprites

我一直在摆弄要在背景中使用的图像精灵。

我需要选择图像的两个部分，然后将它们放置在主体背景中的不同位置，一个在左下角，一个在右上角。

假设我有一个矩形图像 - 1700px 宽和 1100px 高。这是我的图像精灵。

我需要从图像精灵中选择一个矩形区域，该区域距离精灵的右上角为 600 像素宽和 400 像素高。我需要把这部分放在body元素的右上角作为背景。

然后我需要选择图像精灵的最左下部分，它也是 600 像素宽和 400 像素高。我需要把这部分放在身体的右下角作为背景图片。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T14:33:19.730

AFAIK 每个元素只能设置一个背景图像，因此您必须添加伪元素（：after/：before）

```
#area {
    position: relative; /*by relatively positioning the element it acts as the reference point when absolutely positioning the pseudo-elements*/
    z-index:1; /*positive z-index will allow for the correct z-axis positioning of the pseudo-elements*/
    /*you could set any background you want, your 2 background images will be in :before and :after*/
}
#area:before,#area:after {
    position: absolute; /*we want to position them*/
    z-index: -1; /*_back_ground-images... so they are behind #area*/
}
#area:before {
    /*set width, height, the 1st background-image, ... here*/
}
#area:after {
    /*set width, height, the 2nd background-image, ... here*/
} 
```

您可能必须添加 display:block 和 content:" " 到您的伪元素，所以它们不会被省略

编辑：我假设你知道 CSS 背景精灵的基础知识，现在几乎所有其他事情都已经为你完成了；）

# php - 如何创建一个随内容增长的两列 div？

> ID：10365975
> 
> 赞同：0
> 
> 时间：2012-04-28T17:44:23.210
> 
> 标签：php, jquery, css

我的目标是创建两个自动增长的列。问题是我想将第 1 列与第 2 列进行比较。
（即）如果 col1 内容 > col2 内容将内容添加到 col2 否则如果 col1==col2 将下一个内容添加到 col1 直到所有未知内容量都布置好。
如何跟踪列中的内容以便比较两列？

它看起来像这样，而不是数字，而是字符

![图片来帮助解释我的目标](../Images/d187fc90b50aad211182fae516287259.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T17:15:14.977

如果您的内容是纯文本，请使用 jquery 使用两个类（col1 和 col2）：

```
 var co1=$('.col1').val();
    var co2=$('.col2').val();
    if(co1.length > co2.length)
    {
       $('.col1').append('some html');
    }else if(co1.length <= co2.length){
       $('.col2').append('some html'); 
    } 
```

在其他情况下，您也可以执行此方法。

# c# - 使用套接字测试服务器

> ID：10365977
> 
> 赞同：1
> 
> 时间：2012-04-28T17:44:24.833
> 
> 标签：c#, sockets, client

我想测试我的服务器，所以我在我的电脑上执行 N 个客户端。问题是第一个客户端工作，但其他的连接丢失，他们的套接字立即关闭！！！！！！知道如何解决这个问题吗？？？

这是我的代码：

服务器：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Xml;
using System.Net.Sockets;
using System.Net;
using System.Threading;
using System.IO;
using System.Diagnostics;
namespace server
{
    public partial class server : Form
    {
        public static byte[] data;
        public static byte[] data1;
        public static Socket sock;
        public delegate void operation(string s);
        public delegate void operation2();
        public delegate bool verifier();
        public server()
        {InitializeComponent();
          this.Show();
            sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
            IPAddress adress = IPAddress.Parse("127.0.0.1");
            IPEndPoint iep = new IPEndPoint(adress, 4000);
            EndPoint ep = (EndPoint)iep;
            sock.Bind(iep);
            sock.Listen(1000);
            sock = sock.Accept();
            Thread lis = new Thread(listenning);
            lis.Start();
          }
        public void listenning()
        {
            data1 = new byte[1024];
            data = new byte[1024];
        repeter: 
            while (sock.Receive(data) > 0)
            {
                 String s = ASCIIEncoding.ASCII.GetString(data);
                if (this.InvokeRequired) Invoke((operation)effectuer4, s);
                else effectuer4(s);
                goto repeter;
              }
        }
        private void effectuer(String s)
        {
            textBox1.Text += "serveur:  " + s + "\r\n";
              message.Text  = "";
        }
        private void effectuer4(String s)
        {
            textBox1.Text += "Client:  " + s + "\r\n"; message.Text = "";
        }
      private void buttonDisconnect_Click(object sender, EventArgs e)
        {
            sock.Close();
            Application.Exit();
             }
    private void buttonSend_Click(object sender, EventArgs e)
        {
           String s = message.Text ;
            data1 = System.Text.Encoding.ASCII.GetBytes(s);
              sock.Send(data1);Invoke((operation)effectuer, s);
           }
        }
     } 
```

客户：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net.Sockets;
using System.IO;
using System.Diagnostics;
using System.Threading;
using System.Net;
using System.Xml;
namespace client
{
    public partial class Form1 : Form
    {
        public static TcpClient SocketPourClient = null;
        public static string ClientMessage;
        public static string ServerMessage;
        Socket sock;
        public static byte[] data;
        public static byte[] data1;
        public delegate void operation(String s);
        public delegate void lancer();
        public delegate bool verifier();
        public IPEndPoint ipEnd = null;
        public int Num = 1;
        public Form1(string ip, int port)
        {
            InitializeComponent();
                   IPAddress adress = IPAddress.Parse("127.0.0.1");
                     ipEnd = new IPEndPoint(adress, 4000);
                  sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
                  sock.Connect(ipEnd);
                  Thread th = new Thread(listenning);
                  th.Start();
        }
        public void listenning()
        {
            try
            {

                data = new byte[1024];

             repeter: 
            if (sock.Receive(data) > 0)
            {

                String s = ASCIIEncoding.ASCII.GetString(data);
                if (this.InvokeRequired) Invoke((operation)effectuer4, s);
                else effectuer4(s);
                goto repeter;

            }
            }
            catch (SocketException e)
            {
                MessageBox.Show(e.ToString());
                sock.Close();
            }

        }

  private void effectuer(String s)
    {
        textBox1.Text += "client:  " + s + "\r\n";
      message.Text = "";
    }
   private void effectuer4(String s)
     {
         textBox1.Text += "Server:  " + s + "\r\n";
         message.Text = "";
       }
 private void buttonDisconnect_Click(object sender, EventArgs e)
    {
        sock.Close();
        Application.Exit();
    }
private void buttonSend_Click_1(object sender, EventArgs e)
    {
        String s = message.Text ;
        data1 = System.Text.Encoding.ASCII.GetBytes(s);
        sock.Send(data1);
        Invoke((operation)effectuer, s);
      }
    }
} 
```

知道如何使用相同的套接字在同一台机器上执行 N 个客户端吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T18:11:41.883

在服务器代码中，您`sock = sock.Accept();`只调用一次。将此代码移动到一个线程并用`while(true)`. 您可能还想在其他线程中处理客户端的请求。

# d - 如何在 D 程序中链接到 D 库

> ID：10365987
> 
> 赞同：9
> 
> 时间：2012-04-28T17:45:49.007
> 
> 标签：d, static-linking

我是 D 编程语言的新手，有一个非常简单的问题。

我想编译一次 D 脚本库，然后在我的其他 D 项目中使用它。

在 CI 中链接到 .lib 文件并为它们创建标头，但在 DI 中找不到类似的东西（D 中甚至有某种标头吗？）

我使用 D-IDE 作为我的 IDE，使用 DMD2 作为我的编译器。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-28T18:22:27.090

创建 StaticLib.d：

```
module StaticLib;

int func(int x)
{
    return x+1;
} 
```

编译它：

```
dmd -lib StaticLib.d -ofStaticLib.lib 
```

创建 App.d：

```
module App;
import std.stdio;
import StaticLib;

void main(string[] args)
{
    writeln("func(3) = ", StaticLib.func(3));
} 
```

创建 StaticLib.di（d 标头）：

```
int func(int x); 
```

编译它：

```
dmd App.d StaticLib.di StaticLib.lib -ofApp.exe 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-28T18:24:23.863

有 .di（D 接口）文件可用作头文件，这些文件可以使用 -H 编译器开关从您的源代码生成

但是我见过的库只有要导入的源文件

您可以使用 -I 开关指定编译器将在何处查找导入

并且 -L 开关将被传递给链接器

# jquery - 改进我的 jquery 图像轮播

> ID：10365992
> 
> 赞同：4
> 
> 时间：2012-04-28T17:46:08.010
> 
> 标签：jquery

我已经建立了自己的 jquery 图像轮播（在你们大多数人的帮助下），可以在这里看到：http: [//jsfiddle.net/2C8fy/33/](http://jsfiddle.net/2C8fy/33/)

我想改进它。我现在面临的问题是，当您单击按钮太快时，图像开始堆积。防止这种情况的最佳方法是什么？我应该使用某种计时器还是有一个可以轻松插入某处的 JQuery 函数？我还在学习 JQuery，我只想知道该往哪个方向走。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T18:05:40.783

在制作动画之前使用 stop() ：

```
.stop(true,true).animate() 
```

# entity-framework-4 - Facebook 喜欢实体框架的通知数据库逻辑吗？

> ID：10365993
> 
> 赞同：2
> 
> 时间：2012-04-28T17:46:09.603
> 
> 标签：entity-framework-4

任何人都可以向我展示 Facebook 中通知逻辑的指南吗？

例如，如果我有

```
public Class Profile
{
public string UserName {get; set;}
public virtual Team TeamId {get; set;}
public virtual ICollection<MessageBoard> Notify {get; set;}
} 
```

另一个存储通知消息的类是 MessageBoard。

```
 public Class MessageBoard
    {
    public string Notification {get; set;}
    public string NotifyType {get; set;}
    public virtual ICollection<Profile> Profiles {get; set;}
    public virtual Profile Sender {get; set;}
    } 
```

我需要 DbmodelBuilder 代码来建立上面给出的这两个实体之间的关系。谢谢阅读。甚至这两个类的变化也是受欢迎的。请给出一个想法。

# python - 导入模块，AttributeError

> ID：10365996
> 
> 赞同：3
> 
> 时间：2012-04-28T17:46:24.237
> 
> 标签：python, import, attributeerror

我正在尝试导入一个模块以使用它具有的几种方法，并且由于某种原因突然出现错误：

```
AttributeError: 'module' object has no attribute 'getFoobar' 
```

当然，我在导入的模块中有一个方法 getFoobar 。我在其他文件中使用它没有问题。这以前从未发生过。

我已经尝试删除所有 .pyc 文件，我检查了我`__init__.py`在同一个文件夹中有一个，并且没有相互导入。

我搜索了 SO 和 Google，但没有解决方案为我解决问题。关于可能发生的事情有什么想法吗？我还能尝试什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-28T17:59:01.090

您是否尝试访问免费的模块级函数或方法？它有很大的不同。如果你有这样的事情：

```
class foo:
    def bar1():
        pass
def bar2():
    pass 
```

保存在文件“foo.py”中，然后你需要做不同的事情来调用每一个，像这样：

```
import foo
f = foo.foo()
f.bar1()
foo.bar2() 
```

如您所见，您可以直接从 foo 模块访问 bar2，因为它在类 foo 之外，但是您需要声明类 foo 的实例才能调用 bar1。我假设您只是尝试从 foo 模块调用 bar1，因为这是初学者常见的错误，尤其是如果您从 Java 切换过来。

# c - 使用函数指针在 C 中制作固件补丁？

> ID：10365997
> 
> 赞同：3
> 
> 时间：2012-04-28T17:46:28.217
> 
> 标签：c, function-pointers, patch, firmware

几年前，我阅读了一篇博客（现在链接已被遗忘），甚至看到了在我以前的组织中为固件开发补丁时大量使用函数指针的示例。

但由于安全原因/签署了 NDA，我无法获取代码副本（我为不这样做并遵循最佳实践而感到自豪）。

我已经看到这些函数是用一些命名约定编码的，比如：

```
filename_func_<version>_<minor_string>(arguments,other arguments) 
```

和类似的文件被编码（补丁的一部分）并在 ROM 中刷新，当函数被调用时，它从补丁位置获取函数的新定义的地址。

对此有任何想法/细节吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T20:57:17.383

必须设计该系统以使这项工作发挥作用。

有多个方面必须协调：

*   必须有一种方法来更改函数指针。
*   代码必须通过指针调用函数。

有多种方法可以详细地做到这一点，但它们最终会成为主题的变体。

```
/* Declaration of function pointer used to invoke the function */
extern int (*filename_func_ptr)(int arg1, char const *arg2);

/* Two versions of the function */
extern int filename_func_1_1(int arg1, char const *arg2);
extern int filename_func_1_2(int arg1, char const *arg2);

/* Definition of function pointer - pointing to version 1.1 of the function */
int (*filename_func_ptr)(int arg1, char const *arg2) = filename_func_1_1;

/* Use of function pointer */
static void some_function(void)
{
    printf("%d\n", (*filename_func_ptr)(1, "pi"));
} 
```

请注意，您可能永远不会在同一个文件中同时拥有`filename_func_1_1()`和`filename_func_1_2()`声明。我描述的效果是“好像”。

修补后，无论您选择何种方式，结果就像您这样写：

```
int (*filename_func_ptr)(int arg1, char const *arg2) = filename_func_1_2; 
```

您可能会遇到动态加载（`dlsym()`、加号`dlopen()`等）的问题以获取新符号。这将需要一个文件名供库动态加载，以及一种将函数名转换为指向正确函数的指针的方法。

每个可修补函数都需要通过指针统一调用。这就是允许您替换该功能的原因。考虑一个动态（共享）库是否足够（因为它可能会更简单）。如果您使用固件，则可能没有那么奢侈。

您需要考虑如何处理具有不同接口的多个功能；您会使用此处所示的单个全局变量，还是必须在每次调用时适当转换的通用函数指针类型，或者联合类型，或者持有指针的结构，或者......有很多组织事物的方法.

# ios5 - 使用 Xcode 4.3.2 故事板使详细视图“主”按钮标题始终成为活动主视图的标题

> ID：10365998
> 
> 赞同：0
> 
> 时间：2012-04-28T17:46:32.430
> 
> 标签：ios5, user-interface, uiviewcontroller, uisplitviewcontroller

在纵向布局中，我的 iPad 应用程序显示一个标题为“主”的按钮，单击该按钮将显示主细节控制器。我希望此按钮的标题始终是活动主视图的标题。我该如何做到这一点？

[https://github.com/kirkouimet/enzyme/blob/master/Enzyme/KODetailViewController.m#L86](https://github.com/kirkouimet/enzyme/blob/master/Enzyme/KODetailViewController.m#L86)

还有一些有趣的漂亮屏幕：

![](../Images/6ffce5ede2b56a2fa19f3c63f789f8a2.png)

在您浏览到所需的提要后，在这种情况下，按钮标题应更改为“全部”：

![在此处输入图像描述](../Images/05c9304d435ec3c50d6ef55c96d8120d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T20:14:22.130

我假设您的主视图控制器是`UINavigationController`. 如果是这样，那么您可以执行以下操作以从导航项中获取可见视图控制器的标题：

```
- (void)splitViewController:(UISplitViewController *)splitViewController willHideViewController:(UIViewController *)viewController
    withBarButtonItem:(UIBarButtonItem *)barButtonItem forPopoverController:(UIPopoverController *)popoverController
{
    UINavigationController *navigationController = (UINavigationController *)popoverController.contentViewController;
    barButtonItem.title = navigationController.visibleViewController.navigationItem.title;

    [self.navigationItem setLeftBarButtonItem:barButtonItem animated:YES];
    self.masterPopoverController = popoverController;
} 
```

# objective-c - 如何从 NSString 中省略某个子字符串？

> ID：10365999
> 
> 赞同：0
> 
> 时间：2012-04-28T17:46:35.890
> 
> 标签：objective-c, ios, xcode, nsstring

我想知道如何在 NSString 中省略特定的子字符串，假设 NSString 确实包含该子字符串。

**例如：**

原始字符串：“这是一个字符串*，但这些单词应该省略*。”

要省略的子字符串：“*但这些词应该省略*”。

结果字符串：“这是一个字符串。”

谢谢你，iLyrical。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-28T17:51:38.890

```
NSString *originalString = @"This is a string but these words should be omitted.";
NSString *substringToOmit = @" but these words should be omitted";
NSString *resultString = [originalString stringByReplacingOccurencesOfString:substringToOmit
                                                                  withString:@""]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T17:51:31.883

见`NSString`的`stringByReplacingOccurrencesOfString:withString:`。您可能还想用`stringByTrimmingCharactersInSet:`.