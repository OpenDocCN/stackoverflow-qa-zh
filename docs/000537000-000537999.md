# StackOverflow 问答 000537000-000537999

# .net - 用于 WPF 富客户端应用程序的图像编辑器组件

> ID：537007
> 
> 赞同：2
> 
> 时间：2009-02-11T14:26:06.413
> 
> 标签：.net, wpf, image, editor, components

你知道一个简单的 .NET 组件，它可以在具有以下功能的 WPF 客户端应用程序中使用：

*   将文件或剪贴板中的图像加载到画布中，
*   缩放和移动，
*   定义画布背景颜色，
*   将画布导出为新图像。

提前谢谢，普伦森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-13T16:40:22.843

这些呢？

[http://xdraw.codeplex.com/](http://xdraw.codeplex.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-13T16:43:53.350

[http://www.codeproject.com/KB/WPF/WPF_DrawTools.aspx](http://www.codeproject.com/KB/WPF/WPF_DrawTools.aspx)

# multithreading - 使用 TDD 驱动线程安全代码

> ID：537014
> 
> 赞同：12
> 
> 时间：2009-02-11T14:27:39.077
> 
> 标签：multithreading, tdd

什么是利用 TDD 驱动线程安全代码的好方法？例如，假设我有一个工厂方法，它利用延迟初始化只创建一个类的一个实例，然后返回它：

```
private TextLineEncoder textLineEncoder;
...
public ProtocolEncoder getEncoder() throws Exception {
    if(textLineEncoder == null)
        textLineEncoder = new TextLineEncoder();
    return textLineEncoder;
} 
```

现在，我想以良好的 TDD 方式编写一个测试，迫使我使这段代码成为线程安全的。具体来说，当两个线程同时调用此方法时，我不想创建两个实例并丢弃一个。这很容易完成，但是我怎样才能编写一个让我这样做的测试呢？

我在 Java 中问这个问题，但答案应该更广泛适用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T14:38:55.757

您可以注入只负责这一行的“提供者”（一个非常简单的工厂）：

```
 textLineEncoder = new TextLineEncoder(); 
```

然后你的测试会注入一个非常慢的提供者实现。这样测试中的两个线程就更容易发生冲突。您可以让第一个线程等待第二个线程释放的信号量。然后测试成功将确保等待线程超时。通过让第一个线程领先，您可以确保它在第二个线程发布之前等待。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T14:32:00.097

这很难，尽管可能——可能比它的价值更难。已知的解决方案包括检测被测代码。这里的讨论[，“极限编程挑战十四”](http://c2.com/cgi-bin/wiki?ExtremeProgrammingChallengeFourteen)值得一试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T17:00:20.207

在[Clean Code](https://rads.stackoverflow.com/amzn/click/com/0132350882)一书中，有一些关于如何测试并发代码的技巧。帮助我找到并发错误的一个技巧是同时运行比 CPU 内核更多的测试。

在[我的项目](http://dimdwarf.sourceforge.net/)中，在我的四核机器上运行测试大约需要 2 秒。当我想测试并发部分（有一些测试）时，我在 IntelliJ IDEA 中按住运行所有测试的热键，直到我在状态栏中看到 20、50 或 100 个测试运行正在执行。我在 Windows 任务管理器中跟踪 CPU 和内存使用情况，以了解所有测试运行何时完成执行（当它们全部运行时内存使用量上升 1-2 GB，然后慢慢下降）。

然后我一一关闭所有的测试运行输出对话框，并检查没有失败。有时会有失败的测试或陷入僵局的测试，然后我会对其进行调查，直到找到错误并修复它。这帮助我找到了几个讨厌的并发错误。最重要的是，当遇到不该发生的异常/死锁时，始终假设代码被破坏，并狠狠地调查原因并修复它。没有宇宙射线会导致程序随机崩溃——代码中的错误会导致程序崩溃。

还有一些框架，例如[http://www.alphaworks.ibm.com/tech/contest](http://www.alphaworks.ibm.com/tech/contest)，它们使用字节码操作来强制代码进行更多的线程切换，从而增加了使并发错误可见的可能性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-17T04:52:04.530

当我最近测试驱动一个需要线程安全的实现时，我想出了我提供的解决方案作为[这个问题](https://stackoverflow.com/questions/1715822/unit-test-for-thread-safe-ness/1746652)的答案。希望即使那里没有测试也能有所帮助。希望链接可以，而不是复制答案...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T14:37:58.083

[Java Concurrency in Practice](http://jcip.net/)第 12 章称为“测试并发程序”。它记录了安全性和活性的测试，但表示这是一个很难的主题。我不确定这个问题是否可以通过该章的工具来解决。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T14:33:39.203

就在我的脑海中，您能否比较返回的实例以查看它们是否确实是相同的实例，或者它们是否不同？那可能是我从 C# 开始的地方，我想你可以在 java 中做同样的事情

# c++ - 在 C++ 中使用 COM 属性或 COM 设置器和获取器是最佳实践吗？

> ID：537027
> 
> 赞同：1
> 
> 时间：2009-02-11T14:30:12.160
> 
> 标签：c++, com, activex

我对 COM 中的开发相对较新，我想知道访问 COM 对象属性的社区标准是什么。我在代码中看到了以下两种约定：

```
comObjectPtr->PutValue(value); 
```

和

```
comObjectPtr->Value = value; 
```

两者似乎都有效，但我想知道这两种方法是否存在固有的优势或劣势以及原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T14:43:42.157

如果我没记错的话，如果出现问题，使用属性分配将引发异常，而不是设置器中返回的 HRESULT。

getter 方法调用与属性也是如此。

使用该属性的一个“好处”是您可以直接使用 prop-get 值，而不必在使用之前声明一个变量并获取它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T14:36:38.680

您说的是使用#import 创建的智能包装类，对吗？

PutValue() 更明确地说明您在做什么；`put`“Value =” 更易于使用，但如果函数执行的操作不是直接赋值，它可能会产生“隐藏”的副作用。据我了解，两者是等价的，只是语法不同。

# c# - 为什么 Linq 的连接方式不同

> ID：537037
> 
> 赞同：5
> 
> 时间：2009-02-11T14:32:18.550
> 
> 标签：c#, linq

好的，这有点抱怨，但这也是一个问题。在 Linq 中，我可以像这样进行连接：

```
from c in dc.Customers join o in dc.Orders on c.custid equals o.custid ... 
```

一切都很好，完全可以记住，而不必回去用谷歌搜索。然而，由于某种原因，左连接要复杂得多：

```
from c in dc.Customers 
join o in dc.Orders on c.custid equals o.custid 
into temp from x in temp.DefaultIfEmpty() ... 
```

所以我的问题是为什么 Linq 的设计者不能用这样的东西让事情变得简单（更像 sql）：

from c in dc.Customers left join o in dc.Orders on c.custid 等于 o.custid ...

干杯李

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T17:06:54.030

> 为什么 Linq 的设计者不能让事情变得简单（更像 sql）

他们本来可以的。但是你对simple的定义（作为一个sql程序员）和OO程序员对simple的定义是不一样的。Linq（在 C# 中）首先是面向 OO 程序员的查询技术。一个例子就是*为什么 select 排在最后*。这是为了满足 C# 中的范围规则和编辑器中的智能感知支持。

这些程序员可能不明白`LEFT JOIN`（如果你说，他们会感到非常困惑`LEFT OUTER JOIN`——认为存在一些差异，就像一个继承自另一个）。

他们所理解的是`GROUP JOIN`，它的行为方式类似。

```
List<int> myInts = new List<int>() { 1, 2, 3, 4, 5, 6, 7, 8, 9 };
List<int> myOtherInts = new List<int>() { 1, 3, 5, 7, 9, 11, 13 };
//
var query = from i in myInts
    join j in myOtherInts on i equals j into g
    select new {key = i, myGroup = g};
//
foreach (var grouping in query)
{
  Console.WriteLine("--{0}", grouping.key);
  foreach (var x in grouping.myGroup)
    Console.WriteLine(x);
} 
```

所有这些`DefaultIfEmpty`东西所做的就是将组解包——将结果扁平化为**行/列形式**——远离 OO 程序员的**自然层级形式**。 `DefaultIfEmpty`在语义上不是获得结果所必需的。

这是方法形式的相同查询 - 编译器从上面生成并且我更喜欢它：

```
var query = myInts.GroupJoin(
    myOtherInts,
    i => i,
    j => j,
    (i, g) => new { key = i, myGroup = g }
); 
```

* * *

> 你能用他的例子来说明这一点吗？

此查询为您提供客户，他们的订单作为附加集合。订单集合可能为空。如果您有 50 个客户和 1000 个订单，那么结果中将有 50 个客户。

```
from c in dc.Customers
join o in dc.Orders on c.custid equals o.custid into someOrders
select new CustomerWithOrders()
  {theCustomer = c, theOrders = someOrders}; 
```

此查询为您提供 CustomerOrder 行。如果一个客户有 5 个订单，该客户将出现 5 次，每次匹配一个不同的订单。如果客户有0个订单，客户将出现一次匹配到一个空订单。如果您有 50 个客户和 1000 个订单，则连接后将有 50-1049 行，结果中元素的含义很难定义。

```
from c in dc.Customers
join o in dc.Orders on c.custid equals o.custid into temp
from x in temp.DefaultIfEmpty()
select new CustomerOrderHybrid() {theCustomer = c, theOrder = x} 
```

如果他们实施`left join`，则需要第二个示例的结果形状。一旦我使用了`group join`更好的 ，我也不会`left join`一步实现。查询结果的层次结构非常棒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T14:41:55.873

可能是因为 Linq 表达式只是编译器中的[语法糖](http://en.wikipedia.org/wiki/Syntactic_sugar)，它会将它们转换为方法调用。所以查询语法是面向对象系统的泄漏抽象。

由于您实际上并未编写 SQL，因此在某些情况下，底层技术的行为肯定会有所不同。添加类似 SQL 的“左连接”可能比您想象的要困难得多。

* * *

有些人显然不知道 Linq 表达式是如何工作的，所以这里有一个进一步的解释。

如果我参加这个测试课程：

```
public class Class1
{
    public List<string> list = new List<string>() { "test", "test1", "test2" };

    public void test_lambda()
    {
        var test = list.Where(l => l == "test1");
    }

    public void test_linq()
    {
        var test = from l in list
                   where l == "test2"
                   select l;
    }
} 
```

`list.Where(l => l == "test2")`被编译为与`from l in list where l == "test2" select l`. 在这两种情况下，编译器都会生成匿名方法委托：

```
.method public hidebysig instance void test_lambda() cil managed
{
    .maxstack 8
    L_0000: ldarg.0 
    L_0001: ldfld class [mscorlib]System.Collections.Generic.List`1<string> Class1::list
    L_0006: ldsfld class [System.Core]System.Func`2<string, bool> Class1::CS$<>9__CachedAnonymousMethodDelegate1
    L_000b: brtrue.s L_001e
    L_000d: ldnull 
    L_000e: ldftn bool Class1::<test_lambda>b__0(string)
    L_0014: newobj instance void [System.Core]System.Func`2<string, bool>::.ctor(object, native int)
    L_0019: stsfld class [System.Core]System.Func`2<string, bool> Class1::CS$<>9__CachedAnonymousMethodDelegate1
    L_001e: ldsfld class [System.Core]System.Func`2<string, bool> Class1::CS$<>9__CachedAnonymousMethodDelegate1
    L_0023: call class [mscorlib]System.Collections.Generic.IEnumerable`1<!!0> [System.Core]System.Linq.Enumerable::Where<string>(class [mscorlib]System.Collections.Generic.IEnumerable`1<!!0>, class [System.Core]System.Func`2<!!0, bool>)
    L_0028: pop 
    L_0029: ret 
}

.method public hidebysig instance void test_linq() cil managed
{
    .maxstack 8
    L_0000: ldarg.0 
    L_0001: ldfld class [mscorlib]System.Collections.Generic.List`1<string> Class1::list
    L_0006: ldsfld class [System.Core]System.Func`2<string, bool> Class1::CS$<>9__CachedAnonymousMethodDelegate3
    L_000b: brtrue.s L_001e
    L_000d: ldnull 
    L_000e: ldftn bool Class1::<test_linq>b__2(string)
    L_0014: newobj instance void [System.Core]System.Func`2<string, bool>::.ctor(object, native int)
    L_0019: stsfld class [System.Core]System.Func`2<string, bool> Class1::CS$<>9__CachedAnonymousMethodDelegate3
    L_001e: ldsfld class [System.Core]System.Func`2<string, bool> Class1::CS$<>9__CachedAnonymousMethodDelegate3
    L_0023: call class [mscorlib]System.Collections.Generic.IEnumerable`1<!!0> [System.Core]System.Linq.Enumerable::Where<string>(class [mscorlib]System.Collections.Generic.IEnumerable`1<!!0>, class [System.Core]System.Func`2<!!0, bool>)
    L_0028: pop 
    L_0029: ret 
} 
```

这就是我所说的语法糖。查询表达式不会为语言添加任何新内容，它们只是提供使用现有语言功能的更简单方法。

# java - 如何通过 pkcs12 文件在 Java 中使用 SSL 连接到安全网站？

> ID：537040
> 
> 赞同：19
> 
> 时间：2009-02-11T14:32:29.690
> 
> 标签：java, ssl

我有一个 pkcs12 文件。我需要使用它来使用 https 协议连接到网页。我遇到了一些代码，为了连接到安全网页，我需要设置以下系统属性：

```
System.setProperty("javax.net.ssl.trustStore", "myTrustStore");
System.setProperty("javax.net.ssl.trustStorePassword", "changeit");
System.setProperty("javax.net.ssl.keyStoreType", "pkcs12");
System.setProperty("javax.net.ssl.keyStore", "new_cert.p12");
System.setProperty("javax.net.ssl.keyStorePassword", "newpass"); 
```

我有 p12(pkcs12) 文件。我只需要一个信任库文件。

我使用以下方法提取了证书：

```
openssl.exe pkcs12 -in c:/mykey.p12 -out c:/cert.txt -nokeys -clcerts 
```

现在将 cert PEM 文件转换为 der

```
openssl.exe x509 -in c:/cert.txt -outform DER -out c:/CAcert.der 
```

现在将 der 文件添加到密钥库

```
keytool -import -file C:/Cacert.der -keystore mytruststore 
```

现在我有了信任库，但是当我使用它时，出现以下错误

```
Exception in thread "main" java.net.SocketException: java.security.NoSuchAlgorithmException: Error constructing implementation (algorithm: Default, provider: SunJSSE, class: com.sun.net.ssl.internal.ssl.DefaultSSLContextImpl) 
```

更新：删除某些属性并仅设置“trustStore”、“trustStorePassword”和“trustStoreType”属性后，出现以下异常

```
java.security.InvalidAlgorithmParameterException: the trustAnchors parameter must be non-empty 
```

请帮忙。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-21T18:00:36.707

对于遇到类似情况的任何人，我都能够解决上述问题，如下所示：

1.  重新生成您的 pkcs12 文件，如下所示：

    ```
    openssl pkcs12 -in oldpkcs.p12 -out keys -passout pass:tmp
    openssl pkcs12 -in keys -export -out new.p12 -passin pass:tmp -passout pass:newpasswd 
    ```

2.  将 CA 证书从服务器导入到 TrustStore（您自己的，或`$JAVA_HOME/jre/lib/security/cacerts`密码中的 java 密钥库：） `changeit`。

3.  设置以下系统属性：

    ```
    System.setProperty("javax.net.ssl.trustStore", "myTrustStore");
    System.setProperty("javax.net.ssl.trustStorePassword", "changeit");
    System.setProperty("javax.net.ssl.keyStoreType", "pkcs12");
    System.setProperty("javax.net.ssl.keyStore", "new.p12");
    System.setProperty("javax.net.ssl.keyStorePassword", "newpasswd"); 
    ```

4.  测试你的网址。

礼貌@ [http://forums.sun.com/thread.jspa?threadID=5296333](http://forums.sun.com/thread.jspa?threadID=5296333)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-30T13:47:29.083

由于 50pts 阈值，我无法发表评论，但我认为[https://stackoverflow.com/a/537344/1341220](https://stackoverflow.com/a/537344/1341220)中提供的答案不正确。您实际描述的是如何将服务器证书插入系统默认信任库：

```
$JAVA_HOME/jre/lib/security/cacerts, password: changeit) 
```

这确实有效，但这意味着您并没有真正指定项目本地的信任库，而是在您的系统中普遍接受了证书。

您实际上从不使用您在此处定义的自己的信任库：

```
System.setProperty("javax.net.ssl.trustStore", "myTrustStore");
System.setProperty("javax.net.ssl.trustStorePassword", "changeit"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-11T15:33:48.807

您似乎正在从 PKCS #12 密钥库中提取证书并创建一个新的 Java 密钥库（类型为“JKS”）。您不必严格提供信任库密码（尽管使用一个可以让您测试根证书的完整性）。

因此，请尝试*仅*设置以下 SSL 属性的程序。您的问题中显示的列表过度指定，可能会导致问题。

```
System.setProperty("javax.net.ssl.trustStore", "myTrustStore");
System.setProperty("javax.net.ssl.trustStorePassword", "changeit"); 
```

此外，只要将 CA 证书检测为“受信任”条目，直接使用 PKCS #12 文件作为信任存储应该可以工作。但在这种情况下，您也必须指定`javax.net.ssl.trustStoreType`属性`"PKCS12"`。

仅尝试使用这些属性。如果您遇到相同的错误，我怀疑您的问题不是密钥库。如果仍然发生，请在您的问题中发布更多堆栈跟踪以缩小问题范围。

* * *

新错误“trustAnchors 参数必须为非空”可能是由于将`javax.net.ssl.trustStore`属性设置为不存在的文件；如果文件无法打开，则会创建一个空的密钥库，这将导致此错误。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-14T08:16:38.090

这是一个仅使用 p12 文件的示例，它未优化但可以工作。我由 OpenSSL 生成的 pkcs12 文件。示例如何加载 p12 文件并从中构建信任区域...它从 p12 文件输出证书并将好的证书添加到 TrustStore

```
KeyStore ks=KeyStore.getInstance("pkcs12");
ks.load(new FileInputStream("client_t_c1.p12"),"c1".toCharArray());

KeyStore jks=KeyStore.getInstance("JKS");
jks.load(null);

for (Enumeration<String>t=ks.aliases();t.hasMoreElements();)
{
    String alias = t.nextElement();
    System.out.println("@:" + alias);
    if (ks.isKeyEntry(alias)){
        Certificate[] a = ks.getCertificateChain(alias);
        for (int i=0;i<a.length;i++)
        {
            X509Certificate x509 = (X509Certificate)a[i];
            System.out.println(x509.getSubjectDN().toString());
            if (i>0)
                jks.setCertificateEntry(x509.getSubjectDN().toString(), x509);
            System.out.println(ks.getCertificateAlias(x509));
            System.out.println("ok");
        }
    }
}

System.out.println("init Stores...");

KeyManagerFactory kmf=KeyManagerFactory.getInstance("SunX509");
kmf.init(ks, "c1".toCharArray());

TrustManagerFactory tmf=TrustManagerFactory.getInstance("SunX509");
tmf.init(jks);

SSLContext ctx = SSLContext.getInstance("TLS");
ctx.init(kmf.getKeyManagers(), tmf.getTrustManagers(), null); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-03T08:37:36.573

```
URL url = new URL("https://test.domain:443");   
String  keyStore = "server.p12"
String   keyStorePassword = "changeit";    
String  keyPassword = "changeit";    
String   KeyStoreType= "PKCS12";    
String   KeyManagerAlgorithm = "SunX509";    
String   SSLVersion = "SSLv3";    
public HttpURLConnection getHttpsURLConnection(URL url, String  keystore,
    String   keyStorePass,String  keyPassword, String  KeyStoreType
    ,String KeyManagerAlgorithm, String  SSLVersion)
    throws NoSuchAlgorithmException, KeyStoreException,
        CertificateException, FileNotFoundException, IOException,
        UnrecoverableKeyException, KeyManagementException {
    System.setProperty("javax.net.debug","ssl,handshake,record");

    SSLContext sslcontext = SSLContext.getInstance(SSLVersion);
    KeyManagerFactory kmf =  KeyManagerFactory.getInstance(KeyManagerAlgorithm);
    KeyStore ks = KeyStore.getInstance(KeyStoreType);
    ks.load(new FileInputStream(keystore), keyStorePass.toCharArray());
    kmf.init(ks, keyPassword.toCharArray());

     TrustManagerFactory tmf = TrustManagerFactory
            .getInstance(TrustManagerFactory.getDefaultAlgorithm());
    tmf.init(ks);
    TrustManager[] tm = tmf.getTrustManagers();

    sslcontext.init(kmf.getKeyManagers(), tm, null);
    SSLSocketFactory sslSocketFactory = sslcontext.getSocketFactory();
    HttpsURLConnection.setDefaultSSLSocketFactory(sslSocketFactory);
    HttpsURLConnection httpsURLConnection = ( HttpsURLConnection)uRL.openConnection();

    return httpsURLConnection;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-19T07:19:43.033

此示例显示如何在现有套接字之上分层 SSL，从 PKCS#12 文件获取客户端证书。当您需要通过代理连接到上游服务器，并且您想自己处理完整的协议时，它是合适的。

然而，本质上，一旦你有了 SSL 上下文，你就可以将它应用到 HttpsURLConnection 等。

```
KeyStore ks = KeyStore.getInstance("PKCS12");
InputStream is = ...;
char[] ksp = storePassword.toCharArray();
ks.load(is, ksp);
KeyManagerFactory kmf = KeyManagerFactory.getInstance("SunX509");
char[] kp = keyPassword.toCharArray();
kmf.init(ks, kp);
sslContext = SSLContext.getInstance("SSLv3");
sslContext.init(kmf.getKeyManagers(), null, null);
SSLSocketFactory factory = sslContext.getSocketFactory();
SSLSocket sslsocket = (SSLSocket) factory.createSocket(socket, socket
    .getInetAddress().getHostName(), socket.getPort(), true);
sslsocket.setUseClientMode(true);
sslsocket.setSoTimeout(soTimeout);
sslsocket.startHandshake(); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-08T11:37:42.640

以下步骤将帮助您解决问题。

步骤：developer_identity.cer <= 从 Apple 下载 mykey.p12 <= 您的私钥

要遵循的命令：

```
 openssl x509 -in developer_identity.cer -inform DER -out developer_identity.pem -outform PEM

    openssl pkcs12 -nocerts -in mykey.p12 -out mykey.pem

    openssl pkcs12 -export -inkey mykey.pem -in developer_identity.pem -out iphone_dev.p12 
```

**我们需要的最终 p12 是 iphone_dev.p12 文件和密码。**

将此文件用作您的 p12，然后尝试。这确实是解决方案。:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-18T20:58:49.420

我意识到这篇文章可能已经过时了，但我还是想请 smithsv 更正他的源代码，它包含很多错误，我设法更正了大部分但仍然不知道 x509 可能是什么类型的对象。这里是我认为的源代码应该是：

```
import java.io.FileInputStream;
import java.security.KeyStore;
import java.security.cert.Certificate;
import java.util.Enumeration;

import javax.net.ssl.KeyManagerFactory;
import javax.net.ssl.SSLContext;
import javax.net.ssl.TrustManagerFactory;

public class Connection2 {
    public void connect() {
        /*
         * This is an example to use ONLY p12 file it's not optimazed but it
         * work. The pkcs12 file where generated by OpenSSL by me. Example how
         * to load p12 file and build Trust zone from it... It outputs
         * certificates from p12 file and add good certs to TrustStore
         */
        KeyStore ks = KeyStore.getInstance( "pkcs12" );
        ks.load( new FileInputStream( cert.pfx ), "passwrd".toCharArray() );

        KeyStore jks = KeyStore.getInstance( "JKS" );
        jks.load( null );

        for( Enumeration t = ks.aliases(); t.hasMoreElements(); ) {
            String alias = (String )t.nextElement();
            System.out.println( "@:" + alias );
            if( ks.isKeyEntry( alias ) ) {
                Certificate[] a = ks.getCertificateChain( alias );
                for( int i = 0; i == 0; )
                    jks.setCertificateEntry( x509Cert.getSubjectDN().toString(), x509 );

                System.out.println( ks.getCertificateAlias( x509 ) );
                System.out.println( "ok" );
            }
        }

        System.out.println( "init Stores..." );

        KeyManagerFactory kmf = KeyManagerFactory.getInstance( "SunX509" );
        kmf.init( ks, "c1".toCharArray() );

        TrustManagerFactory tmf = TrustManagerFactory.getInstance( "SunX509" );
        tmf.init( jks );

        SSLContext ctx = SSLContext.getInstance( "TLS" );
        ctx.init( kmf.getKeyManagers(), tmf.getTrustManagers(), null );
    }
} 
```

# doxygen - 使用 Doxygen 的自定义标签

> ID：537043
> 
> 赞同：43
> 
> 时间：2009-02-11T14:32:37.317
> 
> 标签：doxygen

我想弄清楚是否有一种方法可以使用 Doxygen 创建自定义标签。我确实找到了 ALIAS 配置文件选项，但这并不完全符合我的需要。基本上在我的代码中，我希望能够编写类似的东西

```
/// \req Requirement #322 - blah blah 
```

然后让 Doxygen 像它一样为具有此自定义标记的行创建一个列表`\bug`和`\todo`命令。Doxygen 可以吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-02-11T15:21:14.220

`\bug`和的推广`\todo`是`\xrefitem`。

我建议的解决方案是：

*   在 Doxyfile 中：

    ```
    ALIASES += "req=\xrefitem req \"Requirement\" \"Requirements\" " 
    ```

*   在记录的代码中：

    ```
    /// \req #42 - The system shall work in any situation 
    ```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-09-30T16:12:33.740

谢谢莫维希尔！我已采用您的解决方案并为我的目的对其进行了扩展。

下面的文本进入我的 Doxyfile：

```
ALIASES += req{1}="\ref SRTX_\1 \"SRTX-\1\" "
ALIASES += satisfy{1}="\xrefitem satisfy \"Satisfies requirement\" \"Requirement Implementation\" \1"
ALIASES += verify{1}="\xrefitem verify \"Verifies requirement\" \"Requirement Verification\" \1" 
```

其中 SRTX 是我的项目的名称，用作需求的前缀。

然后，我创建了一个名为 Requirements.dox 的文件，该文件在我的需求管理工具（在我的例子中是问题跟踪器）中提供了需求 ID 和需求 URL 之间的链接。

```
/**
@page Requirements

@section Build1

@anchor SRTX_1113
<a href="https://foo.bar.com/mantis/view.php?id=1113">SRTX-1113</a>

@anchor SRTX_1114
<a href="https://foo.bar.com/mantis/view.php?id=1114">SRTX-1114</a>

*/ 
```

如果您不需要链接到外部源，也可以将需求文本放在锚标记中。

在我的代码中，我有：

```
/**
 * This is the basic executive that schedules processes.
 * @satisfy{@req{1114}}
 */
class Scheduler: public Process
{
    ...
} 
```

在我的测试中，我提出：

```
/**
 * Provide a number of tests for process scheduling.
 * @verify{@req{1114}}
 */
class Scheduler_ut : public CppUnit::TestFixture
{
    ...
} 
```

这为我提供了需求、需求实施和需求验证的相关页面。它还在类描述（或功能——无论您放置标签的位置）中提供满足需求和验证需求部分。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-06-12T23:10:58.630

***结合上面的两个答案***，您可以拥有一个干净的需求标签，该标签将构建一个交叉引用表，并且还可以在您的文档中提供到需求 repo 的直接链接：

**Doxygen 配置文件：**

别名 =`"requirement{1}=@xrefitem requirement \"Requirements\" \"Requirements Traceability\" <a href=\"http://your.requirementtool.com/browse/\1\">\1</a>"`

**源代码：**

`@requirement{REQ-123}` *Brief textual summary of this requirement item*

*This will render in the documentation as:*

**Requirements:**

*   [REQ-123](http://your.requirementtool.com/browse/REQ-123 "REQ-123") Brief textual summary of this requirement item

# cocoa-touch - 在 NSUserDefaults 的 NSMutableArray 中存储自定义对象

> ID：537044
> 
> 赞同：101
> 
> 时间：2009-02-11T14:32:38.363
> 
> 标签：cocoa-touch

我最近一直在尝试将我的 iPhone 应用程序的搜索结果存储在 NSUserDefaults 集合中。我也使用它来成功保存用户注册信息，但由于某种原因试图存储我的自定义 Location 类的 NSMutableArray 总是返回空。

从这篇文章开始，我尝试将 NSMutableArray 转换为 NSData 元素，但我得到了相同的结果（[可能在 iPhone 上使用 NSUserDefaults 保存整数数组？](https://stackoverflow.com/questions/350848/possible-to-save-an-integer-array-using-nsuserdefaults-on-iphone)）

我尝试过的代码示例是：

**节省：**

```
[prefs setObject:results forKey:@"lastResults"];
[prefs synchronize]; 
```

或者

```
NSData *data = [NSData dataWithBytes:&results length:sizeof(results)];
[prefs setObject:data forKey:@"lastResults"]; 
```

或者

```
NSData *data = [NSKeyedArchiver archivedDataWithRootObject:results];
[prefs setObject:data forKey:@"lastResults"]; 
```

**加载：**

```
lastResults = (NSMutableArray *)[prefs objectForKey:@"lastResults"]; 
```

或者

```
NSData *data = [prefs objectForKey:@"lastResults"];
memcpy(&lastResults, data.bytes, data.length); 
```

或者

```
NSData *data = [prefs objectForKey:@"lastResults"];
lastResults = [NSKeyedUnarchiver unarchiveObjectWithData:data]; 
```

遵循以下建议后，我还在我的对象中实现了 NSCoder （忽略 NSString 的过度使用它的临时）：

```
#import "Location.h"

@implementation Location

@synthesize locationId;
@synthesize companyName;
@synthesize addressLine1;
@synthesize addressLine2;
@synthesize city;
@synthesize postcode;
@synthesize telephoneNumber;
@synthesize description;
@synthesize rating;
@synthesize priceGuide;
@synthesize latitude;
@synthesize longitude;
@synthesize userLatitude;
@synthesize userLongitude;
@synthesize searchType;
@synthesize searchId;
@synthesize distance;
@synthesize applicationProviderId;
@synthesize contentProviderId;

- (id) initWithCoder: (NSCoder *)coder
{
    if (self = [super init])
    {
        self.locationId = [coder decodeObjectForKey:@"locationId"];
        self.companyName = [coder decodeObjectForKey:@"companyName"];
        self.addressLine1 = [coder decodeObjectForKey:@"addressLine1"];
        self.addressLine2 = [coder decodeObjectForKey:@"addressLine2"];
        self.city = [coder decodeObjectForKey:@"city"];
        self.postcode = [coder decodeObjectForKey:@"postcode"];
        self.telephoneNumber = [coder decodeObjectForKey:@"telephoneNumber"];
        self.description = [coder decodeObjectForKey:@"description"];
        self.rating = [coder decodeObjectForKey:@"rating"];
        self.priceGuide = [coder decodeObjectForKey:@"priceGuide"];
        self.latitude = [coder decodeObjectForKey:@"latitude"];
        self.longitude = [coder decodeObjectForKey:@"longitude"];
        self.userLatitude = [coder decodeObjectForKey:@"userLatitude"];
        self.userLongitude = [coder decodeObjectForKey:@"userLongitude"];
        self.searchType = [coder decodeObjectForKey:@"searchType"];
        self.searchId = [coder decodeObjectForKey:@"searchId"];
        self.distance = [coder decodeObjectForKey:@"distance"];
        self.applicationProviderId = [coder decodeObjectForKey:@"applicationProviderId"];
        self.contentProviderId = [coder decodeObjectForKey:@"contentProviderId"];
    }
}

- (void) encodeWithCoder: (NSCoder *)coder
{
    [coder encodeObject:locationId forKey:@"locationId"];
    [coder encodeObject:companyName forKey:@"companyName"];
    [coder encodeObject:addressLine1 forKey:@"addressLine1"];
    [coder encodeObject:addressLine2 forKey:@"addressLine2"];
    [coder encodeObject:city forKey:@"city"];
    [coder encodeObject:postcode forKey:@"postcode"];
    [coder encodeObject:telephoneNumber forKey:@"telephoneNumber"];
    [coder encodeObject:description forKey:@"description"];
    [coder encodeObject:rating forKey:@"rating"];
    [coder encodeObject:priceGuide forKey:@"priceGuide"];
    [coder encodeObject:latitude forKey:@"latitude"];
    [coder encodeObject:longitude forKey:@"longitude"];
    [coder encodeObject:userLatitude forKey:@"userLatitude"];
    [coder encodeObject:userLongitude forKey:@"userLongitude"];
    [coder encodeObject:searchType forKey:@"searchType"];
    [coder encodeObject:searchId forKey:@"searchId"];
    [coder encodeObject:distance forKey:@"distance"];
    [coder encodeObject:applicationProviderId forKey:@"applicationProviderId"];
    [coder encodeObject:contentProviderId forKey:@"contentProviderId"];

} 
```

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2009-02-11T17:20:35.230

为了在数组中加载自定义对象，这是我用来抓取数组的：

```
NSUserDefaults *currentDefaults = [NSUserDefaults standardUserDefaults];
NSData *dataRepresentingSavedArray = [currentDefaults objectForKey:@"savedArray"];
if (dataRepresentingSavedArray != nil)
{
    NSArray *oldSavedArray = [NSKeyedUnarchiver unarchiveObjectWithData:dataRepresentingSavedArray];
    if (oldSavedArray != nil)
        objectArray = [[NSMutableArray alloc] initWithArray:oldSavedArray];
    else
        objectArray = [[NSMutableArray alloc] init];
} 
```

您应该检查从用户默认值返回的数据不是 nil，因为我相信从 nil 取消归档会导致崩溃。

归档很简单，使用以下代码：

```
[[NSUserDefaults standardUserDefaults] setObject:[NSKeyedArchiver archivedDataWithRootObject:objectArray] forKey:@"savedArray"]; 
```

正如 f3lix 指出的那样，您需要使您的自定义对象符合 NSCoding 协议。添加如下方法应该可以解决问题：

```
- (void)encodeWithCoder:(NSCoder *)coder;
{
    [coder encodeObject:label forKey:@"label"];
    [coder encodeInteger:numberID forKey:@"numberID"];
}

- (id)initWithCoder:(NSCoder *)coder;
{
    self = [super init];
    if (self != nil)
    {
        label = [[coder decodeObjectForKey:@"label"] retain];
        numberID = [[coder decodeIntegerForKey:@"numberID"] retain];
    }   
    return self;
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-15T13:43:24.277

我认为您的 initWithCoder 方法出现错误，至少在提供的代码中您没有返回“self”对象。

```
- (id) initWithCoder: (NSCoder *)coder
{
    if (self = [super init])
    {
        self.locationId = [coder decodeObjectForKey:@"locationId"];
        self.companyName = [coder decodeObjectForKey:@"companyName"];
        self.addressLine1 = [coder decodeObjectForKey:@"addressLine1"];
        self.addressLine2 = [coder decodeObjectForKey:@"addressLine2"];
        self.city = [coder decodeObjectForKey:@"city"];
        self.postcode = [coder decodeObjectForKey:@"postcode"];
        self.telephoneNumber = [coder decodeObjectForKey:@"telephoneNumber"];
        self.description = [coder decodeObjectForKey:@"description"];
        self.rating = [coder decodeObjectForKey:@"rating"];
        self.priceGuide = [coder decodeObjectForKey:@"priceGuide"];
        self.latitude = [coder decodeObjectForKey:@"latitude"];
        self.longitude = [coder decodeObjectForKey:@"longitude"];
        self.userLatitude = [coder decodeObjectForKey:@"userLatitude"];
        self.userLongitude = [coder decodeObjectForKey:@"userLongitude"];
        self.searchType = [coder decodeObjectForKey:@"searchType"];
        self.searchId = [coder decodeObjectForKey:@"searchId"];
        self.distance = [coder decodeObjectForKey:@"distance"];
        self.applicationProviderId = [coder decodeObjectForKey:@"applicationProviderId"];
        self.contentProviderId = [coder decodeObjectForKey:@"contentProviderId"];
    }

    return self; // this is missing in the example above

} 
```

我用

```
NSData *data = [NSKeyedArchiver archivedDataWithRootObject:results];
[prefs setObject:data forKey:@"lastResults"]; 
```

和

```
NSUserDefaults *currentDefaults = [NSUserDefaults standardUserDefaults];
NSData *dataRepresentingSavedArray = [currentDefaults objectForKey:@"lastResults"];
if (dataRepresentingSavedArray != nil)
{
        NSArray *oldSavedArray = [NSKeyedUnarchiver unarchiveObjectWithData:dataRepresentingSavedArray];
        if (oldSavedArray != nil)
                objectArray = [[NSMutableArray alloc] initWithArray:oldSavedArray];
        else
                objectArray = [[NSMutableArray alloc] init];
} 
```

它非常适合我。

带着敬意，

斯特凡

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T14:43:21.410

请参阅“为什么 NSUserDefaults 无法在 iPhone SDK 中保存 NSMutableDictionary？”（[为什么 NSUserDefaults 无法在 iPhone SDK 中保存 NSMutableDictionary？](https://stackoverflow.com/questions/471830/why-nsuserdefaults-failed-to-save-nsmutabledictionary-in-iphone-sdk)）

* * *

如果你想（反）序列化自定义对象，你必须提供函数来（反）序列化数据（NSCoding 协议）。您引用的解决方案适用于 int 数组，因为该数组不是对象，而是一块连续的内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T14:49:02.690

我认为您的代码的问题似乎是没有保存结果数组。它加载数据尝试使用

```
lastResults = [prefs arrayForKey:@"lastResults"]; 
```

这将返回键指定的数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T14:51:50.920

我建议不要尝试将此类内容存储在默认数据库中。

SQLite 相当容易上手和使用。[我在我的一个截屏视频（ http://pragprog.com/screencasts/v-bdiphone](http://pragprog.com/screencasts/v-bdiphone)）中有一个关于我编写的简单包装器的插曲（您可以在不购买 SC 的情况下获得代码）。

将应用程序数据存储在应用程序空间中要干净得多。

所有这一切都说明了如果将这些数据放入默认数据库仍然有意义，那么请参阅 f3lix 发布的帖子。

# database-design - 网站上的多语言内容

> ID：537051
> 
> 赞同：1
> 
> 时间：2009-02-11T14:34:23.600
> 
> 标签：database-design

我正在写一个调查网站，向用户询问多项选择题。

在单一语言的情况下，设计数据库模式非常简单，但是一旦有多种语言，模式就会变得更加模糊。

我的直觉告诉我，我将拥有以下表格（删除了所有讨厌的部分）：

> 问题（id）
> 
> 选择（id，questionid）
> 
> questiontranslations (questionid, languagecode, content)
> 
> 选择翻译（选择ID，语言代码，内容）
> 
> 答案（用户 ID、问题 ID、选择 ID）

现在，我知道这会起作用，但我不禁认为表的数量不必要地膨胀。

有没有人对不同的方法或改进方法有建议？

**注意：**语言的数量在发布时是固定的，但可能会随着时间的推移而增长。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T14:45:28.190

架构看起来不错。您还可以为每个问题和选择使用唯一键，然后只使用一个包含键、值、区域设置（语言 - 国家标识符）的表。这会将您的翻译表减少一个。它还将制作一个通用翻译系统，以便问题的模式与翻译的模式分开。

我们为我们的应用程序的通用翻译服务采用了类似的模式，它有一个额外的表来监控翻译未命中，这样如果服务不能在请求的语言环境中提供翻译，则记录键和语言环境。

# javascript - 使用 Javascript 分配 ColdFusion 客户端变量

> ID：537057
> 
> 赞同：3
> 
> 时间：2009-02-11T14:35:50.570
> 
> 标签：javascript, ajax, coldfusion

是否可以使用 JavaScript 将变量分配给客户端范围？更具体地说，我试图在从 AJAX 调用返回后分配一个值。

我知道 ColdFusion 在服务器端运行，JavaScript 在客户端运行，但是随着 AJAX 的普及，我很好奇这样的事情是否可能。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T23:20:28.050

Peter Boughton 在他的概念上几乎死心塌地，但你问如何编写客户端变量，他没有测试他的代码。此外，您尝试执行的操作将称为 ClientFacade，因此我编写（并测试了）ClientFacade CFC 和配套 JavaScript。请注意，我使用的是 jQuery，因为没有它我永远不会去任何地方。;)

**ClientFacade.cfc：**

```
<cfcomponent output="false"
  hint="acts as a remote facade for the client scope">

    <cffunction name="set" output="false" access="remote"
      returntype="boolean" hint="sets a value into the client scope">
        <cfargument name="name" type="string" required="true"/>
        <cfargument name="val" type="any" required="true"/>

        <!--- you should sanitize input here to prevent code injection --->

        <cfscript>
            try {
                client[arguments.name] = arguments.val;
                return(true);
            }catch (any e){
                return(false);
            }
        </cfscript>
    </cffunction>

    <cffunction name="get" output="false" access="remote" returntype="any"
      hint="gets a value from the client scope">
        <cfargument name="name" type="string" required="true"/>
        <cfargument name="defaultVal" type="any" required="false"
            default=""/>

        <!--- you should sanitize input here to prevent code injection --->

        <cfscript>
            if (structKeyExists(client, arguments.name)){
                return(client[arguments.name]);
            }else{
                if (len(trim(arguments.defaultVal)) eq 0){
                    return('');
                }else{
                    return(arguments.defaultVal);
                }
            }
        </cfscript>

    </cffunction>

</cfcomponent> 
```

**测试.cfm：**

```
<script type="text/javascript"
  src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js">
  </script>
foo:<input type="text" name="foo" id="foo"/>
<button id="setValue">Set Value</button>
<button id="alertValue">Alert Value</button>

<script type="text/javascript">
    $(document).ready(function(){

        //attach functionality to our alert button
        $("#alertValue").click(function(e){
            var clientVal = 'initialdata';
            $.getJSON(
                'clientFacade.cfc',
                {method:"get", returnFormat:"json", name:"foo"},
                function(d){
                    clientVal = d;
                    alert(clientVal);
                }
            );
            e.preventDefault();//prevent the button from doing anything else
        });

        //attach functionality to our set button
        $("#setValue").click(function(e){
            var success = false;
            var valu = $("#foo").val();
            $.getJSON(
                'clientFacade.cfc',
                {
                  method:"set",
                  returnFormat:"json",
                  name:"foo",
                  "val":valu
                },
                function(d){
                    success = eval(d);
                    if (!success){
                        alert('Was not able to set the client var :(');
                    }
                }
            );
            e.preventDefault();//prevent the button from doing anything else
        });
    });
</script> 
```

我想这就是你想要的一切。如果我错过了什么，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T14:41:42.333

我对CF一无所知，但通常这是通过将名称/值对发布到服务器来完成的，服务器从中获取该值并将其粘贴到变量中。如果您愿意，您也可以使用 GET，并且您可以使用 AJAX 完成这两件事。另一个愚蠢的 hack 是在 javascript 中做这样的事情：

var img = new Image(); img.src = " [http://myserver.com/something.cfm?name=value&anothername=anothervalue](http://myserver.com/something.cfm?name=value&anothername=anothervalue) ";

之后，服务器将执行 GET 并将这两个值传递给服务器。没有图像将显示给客户端，因为：a）您没有将其添加到 DOM b）它不是真正的图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T18:59:19.923

使用 CFAJAXPROXY（CF8 中的新功能），并在 CFC 上调用一个方法，在客户端范围内设置 var。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-13T18:03:01.783

Ray Camden 也提供了一个很好的答案： http: [//www.coldfusionjedi.com/index.cfm/2009/2/12/Ask-a-Jedi-Using-ColdFusion-Ajax-to-set-Session-Variables](http://www.coldfusionjedi.com/index.cfm/2009/2/12/Ask-a-Jedi-Using-ColdFusion-Ajax-to-set-Session-Variables)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T08:14:13.347

使用jQuery，则可以使用该`getJSON()`方法将数据发送回CF Web 服务（即带有 的函数`access="remote"`），然后再次将结果返回给JS。

使用 CF8 的`returnformat="json"`on 功能，这很简单。

（对于早期版本，您需要使用[cfjson](http://cfjson.riaforge.org)（或类似的）来转换数据。）

* * *

作为一个快速（且完全未经测试）的示例......

```
<cffunction name="MyRemoteFunc" returntype="Struct" access="remote" returnformat="json">
    <cfargument name="Name"      type="String"/>
    <cfargument name="Birthday"  type="Date"/>

    <cfset Session.UserDetails.Name = Arguments.Name />
    <cfset Session.UserDetails.Age  = DateDiff('yyyy',Now(),Arguments.Birthday) />
    <cfset Session.UserDetails.Id   = RandRange(1,100) />

    <cfreturn Session.UserDetails />
</cffunction> 
```

```
<script type="text/javascript">

    function setUserDetails(name,birthday)
    { 
        $j.getJSON
            ( 'http://mydomain/stuff/remote.cfc?method=MyRemoteFunc'
            , { name:arguments.name , birthday:arguments.birthday }
            , setUserDetailsResponse
            );
    }

    function setUserDetailsResponse( result )
    {
        alert( 'Hello '+result.name+', you are '+result.age' years old and your Id is '+result.id+'.' );
    }

</script> 
```

# c# - WPF 如何动态创建文本框并在单击按钮时找到文本框？

> ID：537073
> 
> 赞同：18
> 
> 时间：2009-02-11T14:37:53.653
> 
> 标签：c#, .net, wpf, textbox, mouseevent

我正在使用以下代码动态创建 a`TextBox`和 a ：`Button`

```
Button btnClickMe = new Button();
btnClickMe.Content = "Click Me";
btnClickMe.Name = "btnClickMe";
btnClickMe.Click += new RoutedEventHandler(this.CallMeClick);

someStackPanel.Childern.Add(btnClickMe);

TextBox txtNumber = new TextBox();
txtNumber.Name = "txtNumber";
txtNumber.Text = "1776";

someStackPanel.Childern.Add(txtNumber); 
```

我连接到`Click Me`按钮的单击事件。点击我按钮甚至被正确触发。但是我找不到`TextBox`我动态输入的。

这是我的点击我事件：

```
protected void ClickMeClick(object sender, RoutedEventArgs e)
{
    // Find the phone number
    TextBox txtNumber = this.someStackPanel.FindName("txtNumber") as TextBox;

    if (txtNumber != null)
    {
        string message = string.Format("The number is {0}", txtNumber.Text);

        MessageBox.Show(message);    
    }
    else
    {
        MessageBox.Show("Textbox is null");
    }
} 
```

我怎样才能找到`TextBox` `txtNumber`？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-11T15:29:55.603

Josh G 找到了修复此代码的线索：使用 RegisterName()。

这里有三个好处：

1.  不使用成员变量来保存对动态创建的 TextBox 的引用。
2.  编译。
3.  完整的代码。

    ```
    using System;
    using System.Windows;
    using System.Windows.Controls;

    namespace AddControlsDynamically
    {
        public partial class Window1 : Window
        {
            public void Window_Loaded(object sender, RoutedEventArgs e)
            {
                GenerateControls();
            }
            public void GenerateControls()
            {
                Button btnClickMe = new Button();
                btnClickMe.Content = "Click Me";
                btnClickMe.Name = "btnClickMe";
                btnClickMe.Click += new RoutedEventHandler(this.CallMeClick);
                someStackPanel.Children.Add(btnClickMe);
                TextBox txtNumber = new TextBox();
                txtNumber.Name = "txtNumber";
                txtNumber.Text = "1776";
                someStackPanel.Children.Add(txtNumber);
                someStackPanel.RegisterName(txtNumber.Name, txtNumber);
            }
            protected void CallMeClick(object sender, RoutedEventArgs e)
            {
                TextBox txtNumber = (TextBox) this.someStackPanel.FindName("txtNumber");
                string message = string.Format("The number is {0}", txtNumber.Text);
                MessageBox.Show(message);
            }
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-11T14:48:52.490

另一种方法是将关联设置`TextBox`为`Button Tag`实例化它们时。

```
btnClickMe.Tag = txtNumber; 
```

这样您就可以在事件处理程序中检索它。

```
protected void ClickMeClick(object sender, RoutedEventArgs e)
{
    Button btnClickMe = sender as Button;
    if (btnClickMe != null)
    {
        TextBox txtNumber = btnClickMe.Tag as TextBox;
        // ...
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T15:38:54.927

您可以通过注册文本框的名称来使您的原始点击处理程序工作：

```
someStackPanel.RegisterName(txtNumber.Name, txtNumber); 
```

这将允许您在 StackPanel 上调用 FindName 并找到 TextBox。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T15:03:09.427

如果要通过控件的可视化树进行全面搜索，可以使用 VisualTreeHelper 类。

使用以下代码遍历控件的所有可视子项：

```
for (int i = 0; i < VisualTreeHelper.GetChildrenCount(parentObj); i++)
{
    DependencyObject child = VisualTreeHelper.GetChild(parent, i);

    if (child is TextBox)
        // Do something
} 
```

如果要向下搜索树，则需要递归执行此循环，如下所示：

```
public delegate void TextBoxOperation(TextBox box);

public bool SearchChildren(DependencyObject parent, TextBoxOperation op)
{
    for (int i = 0; i < VisualTreeHelper.GetChildrenCount(parent); i++)
    {
        DependencyObject child = VisualTreeHelper.GetChild(parent, i);

        TextBox box = child as TextBox;

        if (box != null)
        {
            op.Invoke(box);
            return true;
        }

        bool found = SearchChildren(child, op);

        if (found)
            return true;
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-11T14:45:10.767

有什么方法可以使 TextBox 控制类中的字段而不是生成器方法中的变量

```
public class MyWindow : Window
{
    private TextBox txtNumber;

    public void Window_Loaded()
    {
        GenerateControls();
    }

    public void GenerateControls()
    {
        Button btnClickMe = new Button();
        btnClickMe.Content = "Click Me";
        btnClickMe.Name = "btnClickMe";
        btnClickMe.Click += new RoutedEventHandler(this.CallMeClick);
        someStackPanel.Childern.Add(btnClickMe);
        txtNumber = new TextBox();
        txtNumber.Name = "txtNumber";
        txtNumber.Text = "1776";
        someStackPanel.Childern.Add(txtNumber);
    }

    protected void ClickMeClick(object sender, RoutedEventArgs e)
    {    
        // Find the phone number    
        string message = string.Format("The number is {0}", txtNumber.Text);        
        MessageBox.Show(message);
    }
} 
```

# python - Python，Sqlite3 - 如何将列表转换为 BLOB 单元格

> ID：537077
> 
> 赞同：9
> 
> 时间：2009-02-11T14:38:06.163
> 
> 标签：python, sqlite

将python中的列表作为二进制数据（即BLOB单元）转储到sqlite3 DB中的最优雅的方法是什么？

```
data = [ 0, 1, 2, 3, 4, 5 ]
# now write this to db as binary data
# 0000 0000
# 0000 0001
# ...
# 0000 0101 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-12T01:27:31.857

Brian 的解决方案似乎符合您的需求，但请记住，使用该方法您只需将数据存储为字符串。

如果要将原始二进制数据存储到数据库中（这样它不会占用太多空间），请将数据转换为**Binary** sqlite 对象，然后将其添加到数据库中。

```
query = u'''insert into testtable VALUES(?)'''
b = sqlite3.Binary(some_binarydata)
cur.execute(query,(b,))
con.commit() 
```

（由于某种原因，这似乎没有记录在 python 文档中）

以下是有关 sqlite BLOB 数据限制的一些说明：

[http://effbot.org/zone/sqlite-blob.htm](http://effbot.org/zone/sqlite-blob.htm)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-11T15:01:45.530

假设您希望将其视为 8 位无符号值序列，请使用该`array`模块。

```
a = array.array('B', data)
>>> a.tostring()
'\x00\x01\x02\x03\x04\x05' 
```

使用不同的类型代码，而不是`'B'`将数据视为不同的类型。例如。'b' 表示有符号字节序列或`'i'`有符号整数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-12-16T19:36:03.713

我有同样的问题，我正在考虑用另一种方式解决这个问题。

我认为[泡菜](http://docs.python.org/library/pickle.html)模块正是为这样的事情完成的（python对象的序列化）

示例（这个用于转储到文件......但我认为它很容易用于数据库存储）

保存：

```
# Save a dictionary into a pickle file.
import pickle
favorite_color = { "lion": "yellow", "kitty": "red" }
pickle.dump( favorite_color, open( "save.p", "w" ) ) 
```

加载：

```
# Load the dictionary back from the pickle file.
import pickle
favorite_color = pickle.load( open( "save.p" ) ) 
```

恕我直言，我认为这种方式更优雅、更安全（它适用于任何 python 对象）。

那是我的 2 美分

更新： [在对我的想法进行了一些搜索之后](https://stackoverflow.com/questions/198692/can-i-pickle-a-python-dictionary-into-a-sqlite3-text-field)，他们在我的解决方案中显示了一些问题（我无法在该字段上进行 sql 搜索）。但我仍然认为这是一个不错的解决方案（如果您不需要搜索该字段。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-13T04:57:40.693

请参阅 SourceForge 上的这个通用解决方案，它涵盖了任意 Python 对象（包括列表、元组、字典等）：

y_serial.py 模块 :: 使用 SQLite 存储 Python 对象

“序列化 + 持久性 :: 在几行代码中，将 Python 对象压缩和注释为 SQLite；然后在没有任何 SQL 的情况下通过关键字按时间顺序检索它们。数据库存储无模式数据的最有用的“标准”模块。”

[http://yserial.sourceforge.net](http://yserial.sourceforge.net)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-13T17:57:28.217

可以将对象数据存储为 pickle dump、jason 等，但也可以对它们进行索引、限制它们并运行使用这些索引的选择查询。这是元组的示例，可以轻松应用于任何其他 python 类。所有需要的都在 python sqlite3 文档中进行了解释（有人已经发布了链接）。无论如何，这里的所有内容都放在以下示例中：

```
import sqlite3
import pickle

def adapt_tuple(tuple):
    return pickle.dumps(tuple)    

sqlite3.register_adapter(tuple, adapt_tuple)    #cannot use pickle.dumps directly because of inadequate argument signature 
sqlite3.register_converter("tuple", pickle.loads)

def collate_tuple(string1, string2):
    return cmp(pickle.loads(string1), pickle.loads(string2))

#########################
# 1) Using declared types
con = sqlite3.connect(":memory:", detect_types=sqlite3.PARSE_DECLTYPES)

con.create_collation("cmptuple", collate_tuple)

cur = con.cursor()
cur.execute("create table test(p tuple unique collate cmptuple) ")
cur.execute("create index tuple_collated_index on test(p collate cmptuple)")

cur.execute("select name, type  from sqlite_master") # where type = 'table'")
print(cur.fetchall())

p = (1,2,3)
p1 = (1,2)

cur.execute("insert into test(p) values (?)", (p,))
cur.execute("insert into test(p) values (?)", (p1,))
cur.execute("insert into test(p) values (?)", ((10, 1),))
cur.execute("insert into test(p) values (?)", (tuple((9, 33)) ,))
cur.execute("insert into test(p) values (?)", (((9, 5), 33) ,))

try:
    cur.execute("insert into test(p) values (?)", (tuple((9, 33)) ,))
except Exception as e:
    print e

cur.execute("select p from test order by p")
print "\nwith declared types and default collate on column:"
for raw in cur:
    print raw

cur.execute("select p from test order by p collate cmptuple")
print "\nwith declared types collate:"
for raw in cur:
    print raw

con.create_function('pycmp', 2, cmp)

print "\nselect grater than using cmp function:"
cur.execute("select p from test where pycmp(p,?) >= 0", ((10, ),) )
for raw in cur:
    print raw

cur.execute("select p from test where pycmp(p,?) >= 0", ((3,)))
for raw in cur:
    print raw 

print "\nselect grater than using collate:"
cur.execute("select p from test where p > ?", ((10,),) )
for raw in cur:
    print raw  

cur.execute("explain query plan select p from test where p > ?", ((3,)))
for raw in cur:
    print raw

cur.close()
con.close() 
```

# perl - IntelliJ 有 Perl 插件吗？

> ID：537078
> 
> 赞同：35
> 
> 时间：2009-02-11T14:38:10.643
> 
> 标签：perl, intellij-idea

人们想在[IntelliJ](http://www.jetbrains.com/idea/)中编写 Perl 时会做什么？我还没有看到任何添加语言支持的插件。有没有人有为 IntelliJ 编写语言插件的经验？难吗？我可以使用现有的插件并对其进行更改以使其支持 Perl 吗？有什么建议么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-18T04:35:30.110

目前我相信 IntelliJ 没有 Perl 插件。

IntelliJ 网站上有[几个](http://www.jetbrains.com/idea/plugins/plugin_developers.html)关于如何编写插件的教程。他们还有专门用于[开发语言插件](http://www.jetbrains.com/idea/plugins/developing_custom_language_plugins.html)的特殊部分。

我不知道这会有多难，但你肯定会学到很多东西。

我猜想修改现有插件可能只会造成混乱，但这只是猜测。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-10T00:55:57.710

根据我上面的评论，我认为如果有一个适用于 Perl 5 的 IntelliJ 插件会很棒。

请在此处投票支持此功能请求：http://plugins.jetbrains.com/wishlist/show?pr=&wid=368 和此处：[http](http://plugins.jetbrains.com/wishlist/show?pr=&wid=368) : [//youtrack.jetbrains.com/issue/IDEA-109346](http://youtrack.jetbrains.com/issue/IDEA-109346)，我们可能会得到一个.

# python - 为Python中的列表保留内存？

> ID：537086
> 
> 赞同：61
> 
> 时间：2009-02-11T14:41:14.923
> 
> 标签：python, performance, arrays, memory-management, list

在 Python 中编程时，是否可以为将填充已知数量的项目的列表保留内存，以便在构建时不会多次重新分配列表？我查看了 Python 列表类型的文档，但没有找到任何似乎可以做到这一点的东西。但是，这种类型的列表构建出现在我的代码的一些热点中，所以我想让它尽可能高效。

编辑：另外，用 Python 这样的语言做这样的事情是否有意义？我是一个相当有经验的程序员，但对 Python 很陌生，并且仍然对它的做事方式有所了解。Python 是否在内部将**所有**对象分配在单独的堆空间中，从而违背了尝试最小化分配的目的，还是将 int、float 等原语直接存储在列表中？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-02-11T15:47:29.947

这里有四种变体：

*   增量列表创建
*   “预分配”列表
*   数组.array()
*   numpy.zeros()

```
python -mtimeit -s"N=10**6" "a = []; app = a.append;"\
    "for i in xrange(N):  app(i);"
10 loops, best of 3: 390 msec per loop

python -mtimeit -s"N=10**6" "a = [None]*N; app = a.append;"\
    "for i in xrange(N):  a[i] = i"
10 loops, best of 3: 245 msec per loop

python -mtimeit -s"from array import array; N=10**6" "a = array('i', [0]*N)"\
    "for i in xrange(N):" "  a[i] = i"
10 loops, best of 3: 541 msec per loop

python -mtimeit -s"from numpy import zeros; N=10**6" "a = zeros(N,dtype='i')"\
    "for i in xrange(N):" "  a[i] = i"
10 loops, best of 3: 353 msec per loop 
```

它表明这`[None]*N`是最快的，`array.array`在这种情况下是最慢的。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-11T14:49:25.640

您可以像这样创建已知长度的列表：

```
>>> [None] * known_number 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-12-13T17:52:13.927

看看这个：

```
In [7]: %timeit array.array('f', [0.0]*4000*1000)
1 loops, best of 3: 306 ms per loop

In [8]: %timeit array.array('f', [0.0])*4000*1000
100 loops, best of 3: 5.96 ms per loop

In [11]: %timeit np.zeros(4000*1000, dtype='f')
100 loops, best of 3: 6.04 ms per loop

In [9]: %timeit [0.0]*4000*1000
10 loops, best of 3: 32.4 ms per loop 
```

所以永远不要使用`array.array('f', [0.0]*N)`，使用`array.array('f', [0.0])*N`或`numpy.zeros`。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T15:00:53.503

在大多数日常代码中，您不需要这种优化。

但是，当列表效率成为问题时，您应该做的第一件事是将通用列表替换为[`array`模块](http://docs.python.org/library/array.html)中的类型列表，这样效率更高。

以下是如何创建 400 万个浮点数的列表：

```
import array
lst = array.array('f', [0.0]*4000*1000) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-11T15:35:34.577

如果您想在 Python 中有效地处理数字，请查看 NumPy ( [http://numpy.scipy.org/](http://numpy.scipy.org/) )。它可以让您在仍然使用 Python 的同时以极快的速度做事。

要完成您在 NumPy 中的要求，您需要执行类似的操作

```
import numpy as np
myarray = np.zeros(4000) 
```

这将为您提供一个初始化为零的浮点数数组。然后你可以做一些非常酷的事情，比如将整个数组乘以一个因子或其他数组和其他东西（有点像在 Matlab 中，如果你曾经使用过），这非常快（大部分实际工作都发生在NumPy 库的高度优化的 C 部分）。

如果它不是你之后的数字数组，那么你可能不会找到在 Python 中做你想做的事情的方法。Python 对象列表是内部对象的点列表（无论如何我认为是这样，我不是 Python 内部的专家），因此它仍然会在您创建它们时分配每个成员。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-11T15:19:39.483

在 Python 中，所有对象都分配在堆上。
但是 Python 使用特殊的内存分配器，因此`malloc`不会在每次需要新对象时调用。
对于缓存的小整数（等）也有一些优化；但是，哪些类型以及如何使用取决于实现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-12T05:33:53.037

对于 Python3：

```
import timeit
from numpy import zeros
from array import array

def func1():
    N=10**6
    a = []
    app = a.append
    for i in range(N):
        app(i)

def func2():
    N=10**6
    a = [None]*N
    app = a.append
    for i in range(N):
        a[i] = i

def func3():
    N=10**6
    a = array('i', [0]*N)
    for i in range(N):
        a[i] = i

def func4():
    N=10**6
    a = zeros(N,dtype='i')
    for i in range(N):
        a[i] = i

start_time = timeit.default_timer()
func1()
print(timeit.default_timer() - start_time)

start_time = timeit.default_timer()
func2()
print(timeit.default_timer() - start_time)

start_time = timeit.default_timer()
func3()
print(timeit.default_timer() - start_time)

start_time = timeit.default_timer()
func4()
print(timeit.default_timer() - start_time) 
```

结果：

```
0.1655518
0.10920069999999998
0.1935983
0.15213890000000002 
```

1.  附加（）
2.  [无]*N
3.  使用模块数组
4.  使用模块 numpy

# sql-server - SQL Server SP - 为“IN”数组列表传递参数？

> ID：537087
> 
> 赞同：8
> 
> 时间：2009-02-11T14:41:27.343
> 
> 标签：sql-server

有没有办法将值数组作为 SQL Server 2005 的单个参数传递给 SP 的 IN 部分？

例如：选择 * from MyTable where ID IN(@MyValueArray)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-03-28T19:25:20.053

在 2005 年及更早的版本中，您不能将数组作为参数传递给存储过程，但要模拟此功能，请将逗号分隔的 ID 列表作为 VARCHAR 参数传递。然后，您需要解析这个列表，将每个 id 添加到变量表中。然后在表的结果上使用 IN。这不是一个优雅的解决方案，但它是你能做的最好的。

```
DECLARE @List TABLE (ID INT)

INSERT @List VALUES ('123')
INSERT @List VALUES ('12')

SELECT *
FROM
    MyTable
WHERE
    MyTableID IN (SELECT ID FROM @List) 
```

这最好通过创建一个函数来实现，该函数将 id 列表作为字符串接收，并将 ID 列表作为表返回。

```
IF EXISTS(
    SELECT *
    FROM sysobjects
    WHERE name = 'ParseIDArray')
BEGIN
    DROP FUNCTION ParseIDArray
END
GO

CREATE FUNCTION [dbo].[ParseIDArray] (@IDList VARCHAR(8000))
RETURNS
    @IDListTable TABLE (ID INT)
AS
BEGIN

    DECLARE
        --@IDList VARCHAR(100),
        @LastCommaPosition INT,
        @NextCommaPosition INT,
        @EndOfStringPosition INT,
        @StartOfStringPosition INT,
        @LengthOfString INT,
        @IDString VARCHAR(100),
        @IDValue INT

    --SET @IDList = '11,12,113'

    SET @LastCommaPosition = 0
    SET @NextCommaPosition = -1

    IF LTRIM(RTRIM(@IDList)) <> ''
    BEGIN

        WHILE(@NextCommaPosition <> 0)
        BEGIN

            SET @NextCommaPosition = CHARINDEX(',',@IDList,@LastCommaPosition + 1)

            IF @NextCommaPosition = 0
                SET @EndOfStringPosition = LEN(@IDList)
            ELSE
                SET @EndOfStringPosition = @NextCommaPosition - 1

            SET @StartOfStringPosition  = @LastCommaPosition + 1
            SET @LengthOfString = (@EndOfStringPosition + 1) - @StartOfStringPosition

            SET @IDString =  SUBSTRING(@IDList,@StartOfStringPosition,@LengthOfString)                  

            IF @IDString <> ''
                INSERT @IDListTable VALUES(@IDString)

            SET @LastCommaPosition = @NextCommaPosition

        END --WHILE(@NextCommaPosition <> 0)

    END --IF LTRIM(RTRIM(@IDList)) <> ''

    RETURN

ErrorBlock:

    RETURN

END --FUNCTION 
```

这是一个使用此函数创建一个存储过程的示例，该存储过程接收一个 ID 列表

```
IF EXISTS (SELECT * FROM sysobjects WHERE name = 'TestArrayParameter')
BEGIN
    DROP PROCEDURE TestArrayParameter
END
GO

CREATE PROCEDURE TestArrayParameter
    @ArrayParameter VARCHAR(8000)
AS
BEGIN

    SELECT *
    FROM TestTable123
    WHERE TestTblID IN (SELECT ID FROM [dbo].[ParseIDArray](@ArrayParameter))

    -- OR BETTER

    SELECT *
    FROM
        TestTable123 test
        INNER JOIN [dbo].[ParseIDArray](@ArrayParameter) list
         ON list.ID = test.TestTblID

END
GO

CREATE TABLE TestTable123  (TestTblID INT, TestTblVal VARCHAR(50))

INSERT TestTable123 VALUES (3,'Three')
INSERT TestTable123 VALUES (25,'Twenty Five')
INSERT TestTable123 VALUES (100,'One Hundred')

DECLARE @IDList VARCHAR(8000)

SET @IDList = '25,100'

EXEC TestArrayParameter @IDList

DROP TABLE TestTable123 
```

# web-applications - jboss 的 jmx-console 有什么好玩的？

> ID：537096
> 
> 赞同：3
> 
> 时间：2009-02-11T14:42:36.217
> 
> 标签：web-applications, jakarta-ee, jboss, jmx

我喜欢显示所有 JNDI 的 JNDIView，除了 jmx-console 中还有什么有用的吗？

PS 我知道我可以制作自己的 MBean，但我想知道有哪些默认的酷操作可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T20:18:53.247

很多东西 ：-）。

[http://jboss.org/community/docs/DOC-10941](http://jboss.org/community/docs/DOC-10941)

我最喜欢的绝对是“[生成线程转储](http://www.jboss.org/community/docs/DOC-9804)”和“[显示内存池使用情况](http://www.jboss.org/community/docs/DOC-9882)”。

编辑：几乎忘记了“[列出线程 CPU 利用率](http://www.jboss.org/community/docs/DOC-9883)”。

# sql-injection - 如何通知某人他们的网站易受 SQL 注入攻击？

> ID：537103
> 
> 赞同：12
> 
> 时间：2009-02-11T14:44:13.280
> 
> 标签：sql-injection

**原始问题：**
我们的一个附属合作伙伴有一个容易受到 SQL 注入攻击的网站。

我们偶然注意到了这一点（URL 中的错字触发了一个信息量巨大的错误页面）。

现在我们不太了解这个附属合作伙伴。一周前，我们开始与他们开展业务。他们自己的技术技能很少；他们的网站是由“做网站”的第三家公司为他们开发的。

现在很明显，我们应该警告他们这个问题。但是我们有点担心，如果我们将问题告知他们，他们会害怕并且不再信任我们（射击信使以使问题消失）。

你们中有人遇到过这种情况吗？你做了什么？

*另外一件事是：*
因为开发网站的公司似乎根本没有进行输入验证/清理，所以我们对这家公司没有很大的信心。虽然这不是我们关心的问题，但我们认为我们应该警告我们的附属合作伙伴，因为他们系统的其余部分可能缺乏安全性和质量。这将使我们与他们的开发人员正面交锋，我们不想卷入他们与我们的情况。

我们应该通知他们我们的其他担忧吗？还是您建议顺其自然？

**更新：**
那么，事情进展如何？

我们通知了他们存在的问题，包括背景信息、详细的错误报告，并试图用简单的人类语言解释问题是什么以及为什么它很严重。

他们感谢我们，将信息传递给他们的网站开发人员，他们已经修复了它。
我们不太确定修复的质量，但我们对此无能为力，这不是我们的责任。（虽然这确实是我们的责任，但自从我们报告了它之后更是如此）。

然而，关系发生了变化。它们不那么开放，而且反应比以前更加保留。我们希望这种情况在未来会变得更好，但确实感觉报告问题会损害对这种关系的信任。

因此，如果您发现自己处于相同的位置，请小心，花时间解释问题并为不太理想的反应做好准备。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-11T14:47:41.493

你告诉他们。时期。

他们会射杀信使吗？也许。但如果他们这样做了，那么你真的想和他们做生意吗？

更务实的是，如果他们的网站出现问题，导致他们因此类攻击而损失大量资金，并且如果结果表明您知道它并且什么也没做，那么您可能会遇到一些责任问题。

这样做（告诉他们）不仅是正确的事情，而且您有这样做的职业责任。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-11T14:46:12.277

提出来。如果它破坏了这种关系，现在比你们的公司建立更密切的关系要好，这样当他们下周日被黑时，你也会受到伤害。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-11T14:47:47.920

从道德上讲，我会说你不能任其发展。您的选择应该是亲自通知他们，或匿名通知他们。我一直发送电子邮件，从安全漏洞到损坏的链接或图像。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T14:47:42.053

尽快告诉他们。如果他们不喜欢它，他们可能不应该是你的合作伙伴。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-11T14:47:51.260

我想联系他们并解释什么是 SQL 注入攻击以及如何克服它。并让他们与开发其网站的公司打交道。这将向他们表明您正在寻找他们的最大利益，老实说，我看不到他们冒犯。

祝你好运

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-11T14:54:45.843

这与“如果有人被车撞了，你是停下来帮助并冒着被起诉的风险还是站在那里看着”的道德问题非常相似。

我会告诉他们，但不是说“我在你的代码中发现了一个严重的安全漏洞”，而是说：

“嘿 - 我们在您的网站上收到一条错误消息，我认为其中可能包含一些敏感信息。我们可以看看这个吗？” 然后轻轻而小心地引导他们穿过它。

你确实需要告诉他们，但不是以枪炮轰轰烈烈的方式。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-11T16:25:54.720

向他们发送经过认证的邮件（可跟踪，表明问题很重要并需要立即关注，如果他们决定通过律师提出问题，书面记录可能会很有用）：

> 尊敬的先生，
> 
> 最近，我们发现您的网站存在漏洞，该漏洞可能导致我们的服务中断，并可能导致数据丢失或更严重。由于我们依赖（在此处插入产品名称）提供部分服务，因此我们有兴趣快速解决此问题。因此，我们推荐以下我们已在我们自己的项目中成功使用的安全服务，以验证对最常见问题的免疫力：
> 
> （此处列出 2-3 家优秀的安全审计公司）
> 
> 我们会定期要求所有供应商在正常的业务过程中提交第三方安全测试，但是这个特定问题的紧迫性使得我们认为立即提醒您很重要。
> 
> 感谢您对此事的及时关注。
> 
> 此致
> (IT 经理, xyz corp)

不要指定漏洞。这将使他们有理由进行全面的安全审计，而不是仅仅将您的担忧发送给开发人员，修复一件事，然后要求一份干净的健康单。如果他们问，

> 很抱歉，为了我们自己和您的法律保护，我们不允许向任何人泄露任何安全问题的特定细节，除非根据 NDA 和相互责任豁免。它具有足够简单的性质，有能力的安全公司将解决它。

如果您使用的产品具有财务性质，那么您可以简单地要求他们提交来自主要审计公司（例如威瑞信）的“批准印章”类型的程序，并在没有安全审计印章的情况下停止服务。

-亚当

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-11T14:50:10.473

您可以这样表述，即您的公司要求所有供应商和合作伙伴提供已执行安全审计的证据。审计要求可能包括对 SQL 注入的检查，并且您可以在“安全要求文档”中包含一个链接到多个信息站点的部分。如果他们没有回应或承认，那么你已经尽了你的职责，让他们意识到这种可能性，并且通过忽略问题，他们已经失去了你的生意。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-11T15:29:16.370

合法地将您的名字更改为“Bobby”；Drop Table Users；”

然后在他们的网站上注册一个帐户。这应该引起他们的注意。

**警告：以上文字纯属玩笑，请勿在家尝试。**

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-11T14:48:15.330

我一直处于这种情况......我会说要小心并且非常委婉。

以我自己的经验，这是一个与我没有任何隶属关系的公共网站，他们对我让他们知道他们的网站易受攻击的意图产生了怀疑（在某种程度上，信用卡信息可能有被曝光）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-11T14:49:02.533

立即通知他们，最好先咨询您的公司律师。惊慌失措的反应可能是诉讼反应。

如果您以信息丰富、友好且乐于助人的方式执行此操作，他们实际上可能会希望您帮助他们解决问题，因此也要准备好对此做出回应。（可能是好是坏，这取决于您是否想要工作，或者不想要凌乱的负担）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-11T15:18:35.083

我会与客户代表您组织的任何人分享这个问题。他们应该决定如何接近和处理他们最了解的客户。

# html - HTML Tidy，不要移动那些评论！

> ID：537112
> 
> 赞同：1
> 
> 时间：2009-02-11T14:46:05.693
> 
> 标签：html, comments, htmltidy

我正在使用 html-tidy，我的一些评论从文档的头部移到了根目录。有没有办法避免这种行为？

（我正在尝试将一些非常非常糟糕的标记转换为 xhtml 投诉代码）哦，另外它使用内部开发的半服务器端脚本语言，该语言使用注释在 html 中放置数据，非常非常非标准......我很想彻底改变它......但你知道雇主是如何......

这是问题所在：

整理前：

```
 <head>
    ...
        <!-- BODY_ON_LOAD_SECTION -->
           <script type="text/javascript" language="Javascript">
                function init() {
                openWin('BODY_ON_LOAD_SECTION_REFERENCE','','resizable=yes,width=400,height=400,left=50,top=50');
            }
           </script>
        <!-- END_BODY_ON_LOAD_SECTION -->
    </head> 
```

整理后：

```
 <script type="text/javascript" language="Javascript"> 
        function init() {   
            openWin('BODY_ON_LOAD_SECTION_REFERENCE','','resizable=yes,width=400,height=400,left=50,top=50'); 
} 
    </script> 
</head><!-- BODY_ON_LOAD_SECTION --> <!-- END_BODY_ON_LOAD_SECTION --> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T14:51:06.757

他们是评论。你真的需要整洁的版本吗？

我在 tidy 中看到的与评论相关的唯一两个[选项是隐藏它们并修复不良评论，因此您可能会不走运。](http://tidy.sourceforge.net/docs/quickref.html)

# java - 从内部匿名类访问外部匿名类的字段

> ID：537119
> 
> 赞同：5
> 
> 时间：2009-02-11T14:47:23.490
> 
> 标签：java, anonymous-inner-class

要从内部类 B 访问外部类 A 的字段 x，我意识到您可以使用“A.this.x”。但是如果外部类也是匿名的呢？例如，

```
public class Main1 {
    public static void main(String[] args) {
        Comparable c1 = new Comparable(){
            int x = 3;
            public int compareTo(Object o) {
                Comparable c2 = new Comparable(){
                    int x = 4;
                    public int compareTo(Object o) {
                        return x;  // <-- THIS LINE
                    }
                };
                return c2.compareTo(o);
            }
        };
        System.out.println(c1.compareTo(null));
    }
} 
```

运行此代码时，将打印 4 的值，因为这是 c2 的字段 x 的值。但是，我想更改标记为“THIS LINE”的行，使其返回外部类的 x（即 c1 的字段 x，值为 3）。如果外部类（即 c1 的类）是命名类 A，那么我可以替换

```
return x; 
```

和

```
return A.this.x; 
```

但是由于外部类也是匿名的，所以我没有名称可以使用。

问题：有没有办法修改标记为“THIS LINE”的行，使其引用 c1 的字段 x 而不是 c2 的，而不将匿名类更改为命名类？

我意识到这段代码真的很难看，这样使用匿名类也不是很好的编程风格，但是代码是由另一个程序生成的，这是实现生成器的最简单方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T14:55:10.633

我会通过选择 x 以外的名称来避免隐藏其他变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T14:59:42.633

简单的答案是不要隐藏变量：

```
public static void main(String[] args) {
    Comparable c1 = new Comparable() {
        int x = 3;
        public int compareTo(Object o) {
            Comparable c2 = new Comparable() {
                //changed this name
                int y = 4;
                public int compareTo(Object o) {
                    return x;
                }
            };
            return c2.compareTo(o);
        }
    };
    System.out.println(c1.compareTo(null));
} 
```

输出：

> 3

鉴于您正在使用生成的代码，这是否适合您？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T15:00:28.623

AFAIK 没有办法实现你想要的。如果您可以更改代码（您似乎可以）但不想将它们更改为命名类，您可以只更改变量的名称，这样您就不会遇到范围问题吗？为了清楚起见，您应该重命名它们

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T15:00:54.050

类是匿名的——无名的。无法使用名称引用访问他们的字段。没有名字。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T14:57:13.623

~~我相信您将不得不将这些字段声明为 final - 您那里的代码编译只是因为您抱怨的阴影~~。不对。

这看起来像是一个经典案例，Lisp 的[gensym](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Body/fun_gensym.html)之类的东西会让事情变得更容易。换句话说，让代码生成器为这些变量使用不同的标识符——例如x1 和x2。

# wpf - JPG 作为使用 XAML 的窗口图标？

> ID：537125
> 
> 赞同：1
> 
> 时间：2009-02-11T14:47:51.663
> 
> 标签：wpf, xaml

是否可以严格使用 XAML 将 JPG 文件用作窗口图标？我找到了一些示例，您可以在 C# 中使用 BitmapFrame 动态生成 ImageSource（然后可分配给 Icon 属性），但我想做类似的事情：

<Window.Icon>
<SomeXAMLThatLetsMeUseJpg Source="MyJpg.jpg" />
</Window.Icon>

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T15:03:45.760

您可以直接使用 jpg 作为图标。

将您的图标作为资源添加到项目中，然后将其用作图标：

```
<Window x:Class="WpfApplication1.Window1"
     <!--some more properties are set here...-->
     Icon="myicon.jpg">
</Window> 
```

jpg 会自动调整大小。

# cocoa-touch - 更改特定 UIViewController 子类的设备方向

> ID：537136
> 
> 赞同：2
> 
> 时间：2009-02-11T14:50:10.037
> 
> 标签：cocoa-touch

我想在出现特定视图时更改设备方向。我得到了很多关于方向改变时要采取的行动的信息，但我不知道如何以编程方式改变设备方向本身。请注意，我的其他视图必须保持默认方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T15:46:13.707

```
 [[UIDevice currentDevice] setOrientation:UIDeviceOrientationPortrait]; 
```

请注意，这不是 API 文档中 UIDevice 框架的一部分，因此 Apple 可能会拒绝使用它的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-20T16:43:01.507

`CGAffineTransforms`您可以使用而不是私有 API来更改视图的方向。您必须更改`UIStatusBarOrientation`方向以匹配新方向并找到旋转视图的角度：

例如，如果您的视图是横向的，并且您希望它恢复为纵向。

```
CGAffineTransform transform = CGAffineTransformIdentity;

switch ([[UIApplication sharedApplication] statusBarOrientation]) {

    case UIInterfaceOrientationLandscapeLeft:
        transform = CGAffineTransformMakeRotation(M_PI_2);
        break;

    case UIInterfaceOrientationLandscapeRight:
        transform = CGAffineTransformMakeRotation(-M_PI_2);
        break;

    default:
        break;
}

[[UIApplication sharedApplication] setStatusBarOrientation:UIInterfaceOrientationPortrait];

[UIView animateWithDuration:0.2f animations:^ {

    [view setTransform:transform];
}];

[view setFrame:CGRectMake(0, 0, 320, 480)];
[view setNeedsLayout]; 
```

# javascript - jQuery：CSS 选择器

> ID：537140
> 
> 赞同：2
> 
> 时间：2009-02-11T14:51:21.080
> 
> 标签：javascript, jquery, css-selectors

例如，我将如何使用 jQuery CSS 选择器来查找：

css 类名：“Text”，它是 dom 对象“包装器”内部的一个 div？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T14:53:05.363

$('#wrapper div.Text') 或 $('#wrapper .Text')，具体取决于您想要的具体程度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T14:55:08.963

添加到nezroy的答案： $('#wrapper > div.Text') 如果您只希望元素直接位于包装器内，而不是所有可能嵌套在其中的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:15:34.250

任何一个

```
$('#wraper .text') 
```

或者

```
$('.text', $('#wraper')) 
```

将在相同的结果下很好地工作（即使如此，我想第二个选项更快）

# wpf - 管理拼写检查字典 WPF

> ID：537142
> 
> 赞同：2
> 
> 时间：2009-02-11T14:51:57.083
> 
> 标签：wpf, richtextbox, spell-checking

可以通过启用拼写检查来管理 RichTextBox/TextBox 中的单词，我发现这是必要的，因为一些医疗技术人员被突出显示（在 .net 字典资源中找不到）

如果此功能已启用，请告知，谢谢！

• C# - Fx3.5

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T20:43:50.813

我知道这篇文章很旧，但我想让您知道，4.0 框架现在允许 WPF TextBoxes 和 RichTextBoxes 的自定义字典。只要您避免一些问题区域，这很容易实现。如果您对如何执行此操作有任何疑问，请告诉我。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T15:41:20.460

不，您无法控制拼写检查字典。

一个快速的谷歌搜索会告诉你他们正在“考虑在未来的版本中使用它”。

# jquery - 动态创建 DOM 元素，但将其淡入

> ID：537143
> 
> 赞同：2
> 
> 时间：2009-02-11T14:52:00.623
> 
> 标签：jquery, dom, fade

我在创建 DOM 元素、将其附加到另一个元素并使其淡入到位时遇到问题。

这似乎不起作用：

```
$('<div/>').html('hello').appendTo('#parentDiv').fadeIn(); 
```

谁能让我走上正轨

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T14:57:08.257

尝试：

```
$("<div>hello</div>").hide().appendTo("#parentDiv").fadeIn(); 
```

或者设置显示无而不是隐藏（）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T14:54:34.020

你有没有尝试过

```
$('<div/>').html('hello').appendTo('#parentDiv').hide().fadeIn(); 
```

# sql - 在 MS SQL 中使用 GUID 作为主键是不是一个坏主意？

> ID：537145
> 
> 赞同：24
> 
> 时间：2009-02-11T14:52:24.040
> 
> 标签：sql, sql-server, database, primary-key

我们有一个使用 UniqueIdentifier 作为每个表的主键的系统。我们已经注意到这是一个坏主意。我看过关于这个主题的类似帖子，但我对任何 MS SQL 性能和由于这个决定可能遇到的其他潜在问题感兴趣。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-11T15:03:15.370

有优点也有缺点：

[这篇文章](http://blog.codinghorror.com/primary-keys-ids-versus-guids/)涵盖了所有内容。

GUID 优点

*   每个表、每个数据库、每个服务器都是唯一的
*   允许轻松合并来自不同数据库的记录
*   允许跨多个服务器轻松分布数据库
*   您可以在任何地方生成 ID，而不必往返于数据库
*   大多数复制方案无论如何都需要 GUID 列

GUID 缺点

*   它比传统的 4 字节索引值大 4 倍；如果您不小心，这可能会对性能和存储产生严重影响
*   调试麻烦（其中 userid='{BAE7DF4-DDF-3RG-5TY3E3RF456AS10}'）
*   生成的 GUID 应该是部分顺序的，以获得最佳性能（例如，SQL 2005 上的 newsequentialid()）并启用聚集索引

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-11T14:54:26.983

上周我写了一篇关于这个的帖子，其中包含一些代码来告诉你会发生什么：[一些简单的代码来显示 Newid 和 Newsequentialid 之间的区别](http://sqlblog.com/blogs/denis_gobo/archive/2009/02/05/11743.aspx)

基本上，如果您使用 newid() 而不是 Newsequentialid() 如果您的 PK 是聚集索引（默认情况下将是），则会出现可怕的页面拆分

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-11T14:56:41.673

就个人而言，我会为 PK 使用 int 或 bigint，但对于那些需要为该记录提供不可猜测的“键”的情况，只需放入另一个“Guid”列，并在插入行时生成 Guid。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-11T15:01:05.907

如果您需要对大型集合（比如说 100,000 个）进行连接，那将会很糟糕。去过那里，受苦了。

后来编辑：我还遇到了一个更糟糕的问题（不能称之为“方法”）：将 GUID 存储在 char(36) 列中！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-11T15:04:14.403

GUID 是一种用于识别行的强大数据类型，因为它几乎可以保证是唯一的，这允许很多灵活性，例如您可以在应用程序层生成 Guid，这可以大大简化保存您的关系。

如前所述，最大的缺点是如果您的 PK 是聚集索引，则会发生页面拆分；但是，您可以通过两种方式解决此问题。您可以使用 NewSequentialId() 或者您可以将 PK 设置为非集群。我建议您根据数据要求构建数据库，如果您需要 GUID，请使用它，然后围绕它进行优化。并在您的环境中验证其性能。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-11T17:05:02.163

Jimmy Nilsson[写了一篇关于 GUID 与 INT 和组合 GUID 的精彩文章](http://www.informit.com/articles/printerfriendly.aspx?p=25862)。结论...不要害怕 GUID...无论如何，复合指南。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-11T14:54:48.137

如果您想快速写入数据库，那就不好了。如果您要进行大量插入，那么最好使用不同的数据类型。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-11T15:01:57.980

这是一个“坏”的想法。它可能很慢。您也不是很适合使用索引进行快速搜索。我们使用 GUID 或 UniqueIDs 的唯一实时是当我们必须保持跨数据库的数据项连接时，通常是当我们有一个服务器数据库和一个应用程序的本地数据库（对于断开连接的系统）时。除了指导之外，您真的没有其他方法可以将事物保持在一起。对于索引和主键，您希望使用整数值并尝试将事物与关联表链接起来，而不是到处使用 guid。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-11T16:04:59.700

我发现使用它们的最佳理由是在复制数据库时。即使这样，也可以有更好的方法来处理这些问题，比如包括 ID 和位置的多部分主键。如果您不需要该功能，我建议坚持使用某种形式的整数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-11T15:03:46.663

它还可以真正减慢您的数据库读取速度，因为除非另有说明，否则主键是使用聚集索引创建的。guid 是最差的聚集索引类型，而 int 或 bigint 将用作更好的主键或聚集索引

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-11T15:42:38.333

我不会说它本身是**坏**的。我和很多发誓的人谈过，虽然我觉得它有点冗长。我同意`routeNpingme`并说您应该使用常规整数作为 ID，但还包括 GUID（无论如何您都需要复制）“以防万一”

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-02-11T16:59:11.303

如果您正在进行任何类型的数据库复制，GUID 是您最好的朋友！

# sql - MS Access 中的 SQL 更新问题 - 操作必须使用可更新查询

> ID：537161
> 
> 赞同：15
> 
> 时间：2009-02-11T14:55:00.337
> 
> 标签：sql, ms-access, sql-update

我有一个选择查询，它执行一些文本操作以基本上重新格式化一个字段，以便我可以在另一个表中查找它：

如果我的第一个表有一个像“J1/2”这样的字段，它会在不同的表中查找记录的 ID，其中 J1 和 J2 在相应的字段中。

这一切都很好。

现在我想更新原始表，因此我不必再使用此字符串操作进行查找，但我对更新查询的尝试以“操作必须使用可更新查询”结尾

有任何想法吗？

我的 SELECT 语句：

```
SELECT DISTINCT
t1.DD,
t1.TN,
t1.DD & " J" & MID(t1.TN,2,1) AS CalculatedStart,
t1.DD & " J" & MID(t1.TN,4,1) AS CalculatedEnd,
t2.ID
FROM t1 INNER JOIN t2
ON (t1.DD & " J" & MID(t1.TN,2,1)=t2.StartLink)
AND (t1.DD & " J" & MID(t1.TN,4,1)=t2.EndLink)
WHERE t1.TN Like "J?/?"
AND t1.DD Like "M*"; 
```

回想一下——这很好用，我从另一端得到了必要的 t2.ID。

所以我想做类似的事情：

```
UPDATE t1 SET t2ID = (
    SELECT Query1.ID
    FROM Query1
    WHERE t1.DD=Query1.DD
    AND t1.TN=Query1.TN
    )
WHERE t1.TN Like "J?/?"
AND t1.DD Like "M*"; 
```

只有这个失败。这是在 MS Access 本身内，所以我无法想象像大多数“操作必须使用可更新查询”问题那样的实际权限问题。

编辑：试图简化不起作用的情况。

这个 UPDATE 查询很好：

```
UPDATE t1
SET t2ID="Unknown"
WHERE TN LIKE "J?/?"
AND DD LIKE "M*"; 
```

这个失败了（感谢 Goedke——这个例子显然失败了，因为子查询返回了 1 个以上的结果。我过于简单地试图找到我的问题）

```
UPDATE t1
SET t2ID=(SELECT ID FROM t2)
WHERE TN LIKE "J?/?"
AND DD LIKE "M*"; 
```

那么我只是在某种程度上让我的子查询语法错误吗？

编辑：这个 SELECT 语句也很好：

```
SELECT t1.OA, t1.DD, t1.TN, t1.HATRIS,
    query1.DD, query1.TN, query1.ID
FROM t1 INNER JOIN query1
ON t1.DD=query1.DD
AND t1.TN=query1.TN 
```

此外，在上面的 select 语句中使用 count 表明每个 (DD,TN) 组合恰好返回 1 个 ID

编辑：

我现在要做的最简单的情况——使用各种 SELECT 语句，我现在有一个只有 2 列的表——t1 的主键和我想要插入到 t1 中的值。

好像还是写不出来

```
UPDATE t1 SET t1.f2 = (SELECT t2.f2 FROM t2 WHERE t2.f1 = t1.f1) 
```

其中 t1 的主键是 f1。即使添加 WHERE t1.f1 IN (SELECT f1 FROM t2) 也无济于事。（添加以消除子查询返回0结果的可能性）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-11-11T06:57:40.813

我必须权衡 David W. Fenton 对 OP 的评论。

这是 Jet/ACE 非常烦人的问题。但请尝试：

1.  转到查询属性（单击显示表格的窗格的背景）并将“唯一记录”设置为“是”
2.  选项 1 相当于 在子句中添加看起来有些奇怪的`DISTINCTROW`关键字 ，例如`SELECT`

：

```
UPDATE DISTINCTROW tblClient 
       INNER JOIN qryICMSClientCMFinite 
          ON tblClient.ClientID = qryICMSClientCMFinite.ClientID
   SET tblClient.ClientCMType = "F"; 
```

这解决了许多涉及此错误消息的问题，这几乎是荒谬的。

简而言之，这就是 MS Access - 如果您不知道问题 x 的商业秘密解决方法，您可能需要几天时间才能找到答案。了解 10,000 种解决方法是对 Access 进行编程。这对初学者来说足够警告吗？

本

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-11T15:18:34.150

(SELECT ID FROM t2) 的子查询不能工作，除非 t2 中只有一条记录。您希望使用哪个 ID？

报告的错误消息通常发生在您有联接并且不包括更新回数据绑定表单中的表所需的所有主键时（例如，您的原始 DISTINCT 会破坏有关键的信息，所以如果它被绑定到表格，表格将无法保存回来）。

您在那里使用 DISTINCT 的事实会让我怀疑子查询在您更复杂的示例中返回的行不止一行。这可能是分配子查询结果最常见的问题：约束 where 子句。

我在分配子查询时看到的另一个问题是内部查询的*语法*是否不正确。至少对于 SQL 2000 和 2005 后端，查询处理器在这种情况下会*静默*失败并返回 NULL。（据我所知，这是一个错误：我看不出为什么在子查询中会默默地允许在顶层返回错误的东西......但它确实存在。）

编辑：为了确保 Paul 和我都不会发疯，我创建了以下表格：

```
t1 | ID, FK, Data
t2 | ID2, Data2 
```

除了 ID 和 ID2 上的主键外，我没有*设置*任何约束。所有字段都是文本，这与我通常用于 ID 的不同，但应该是无关紧要的。

t1：

```
ID  FK  Data
Key1        Data1
Key2        Data2
Key3        Data3 
```

t2：

```
ID2 Data2
Key1    DataA
Key2    DataB
Key3    DataC 
```

表单查询：

```
UPDATE t1 SET t1.FK = (select ID2 from t2 where t2.ID2 = t1.ID); 
```

失败了，保罗得到了同样的信息。

```
select *, (select ID2 from t2 where t2.ID2 = t1.ID) as foreign from t1, 
```

按预期工作，所以我们知道子查询语法不是罪魁祸首。

```
UPDATE t1 SET t1.FK = 'Key1' 
```

也可以按预期工作，因此我们没有损坏或不可更新的目的地。

注意：如果我将数据库后端从本机更改为 SQL 2005，则更新有效！谷歌搜索了一下，我发现 Access MVPs 建议 DLOOKUP 替换子查询：

[http://www.eggheadcafe.com/software/aspnet/31849054/update-with-subquerycomp.aspx](http://www.eggheadcafe.com/software/aspnet/31849054/update-with-subquerycomp.aspx)

显然这是 Access SQL 中的一个错误，在使用 SQL Express 2000 或更高版本的后端时可以避免该错误。（“访问更新子查询”的谷歌结果支持这一理论）。

请参阅此处了解如何使用此解决方法：[http ://www.techonthenet.com/access/functions/domain/dlookup.php](http://www.techonthenet.com/access/functions/domain/dlookup.php)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-12-10T09:07:51.570

这对我有用（Access 2000）

```
UPDATE DISTINCTROW T1 inner join T2 on T2.f1 = T1.f1  SET f2 = f2; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-11-04T00:04:16.400

我还没有阅读整个线程，但这是我正在使用的解决方案：

```
update (select * from t1 inner join t2 on t1.key = t2.key) set t1.field1 = t2.field2 
```

这对我来说在 MS Access 中运行良好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-04T10:14:08.253

我的解决方案是以这种方式更改我的 sql。

```
 update (select o.pricein, g.pricein from operations o left join goods g on g.id = o.goodid where o.opertype = 4 and o.acct = 1) 
  set o.pricein = g.pricein 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-25T13:55:12.150

我在使用 Access 2010 时遇到了同样的错误（“操作必须使用可更新查询”），并且我正在使用内部连接执行简单的更新查询。我所做的只是向我要加入的表添加一个主键（当然，在我正在更新的表上已经有一个主键）并且一切正常。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T22:20:13.883

对于这个： UPDATE t1 SET t1.f2 = (SELECT t2.f2 FROM t2 WHERE t2.f1 = t1.f1)

```
UPDATE t1 INNER JOIN t2 ON t1.f1 = t2.f1 SET t1.f2 = [t2].[f2]; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-11T16:45:21.427

the solution to that is to give the permissions to the folder that contains the acces database that is inside the disk c

# windows - 默认 Windows 语言？

> ID：537170
> 
> 赞同：1
> 
> 时间：2009-02-11T14:57:10.237
> 
> 标签：windows, default

XP 和 Vista 上是否预装了一些默认的 Windows 脚本语言（类似于 OS X 附带 Python 和/或 Linux 附带 Perl）？

我知道批处理脚本，但我希望有一些更强大的东西。谢谢

**注意 -**我在一个 Linux 机器上，所以如果你们能在 Windows 脚本语言上给你 2 美分，那将不胜感激，谢谢。

**part deux -**尽管 ebgreen 讨厌我，我还是接受了他的回答，因为他给了我 2 美分。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T14:59:57.580

Windows XP 和 Vista 默认安装了 VBScript 和 jscript 引擎。Windows 7 也将安装 Powershell。

至于我的 2 美分，VBScript 和 jscript 都是非常成熟的技术，有大量可用资源。如果您正在寻找它们，它们都不会给您一个控制台。

Powershell 更新且功能强大得多。它还具有控制台的优点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T15:01:23.333

[通过Cscript.exe](http://technet.microsoft.com/en-us/library/bb490887.aspx)调用的 Windows 脚本宿主支持 VBScript 和 JScript。[Windows PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)是另一种脚本工具，但需要单独下载。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T15:02:34.890

XP 和 Vista 开箱即用，支持 VBScript 和 JScript。有一个入门可用：http: [//msdn.microsoft.com/en-us/library/hbxc2t98.aspx](http://msdn.microsoft.com/en-us/library/hbxc2t98.aspx)。Vista 可以选择安装 PowerShell，它也将默认随 Windows 7 一起提供。可以在以下位置找到 powershell 入门：[http ://technet.microsoft.com/en-us/library/cc196356.aspx](http://technet.microsoft.com/en-us/library/cc196356.aspx)

# windows - 我应该在 netsh.exe 中使用什么 appid？

> ID：537173
> 
> 赞同：92
> 
> 时间：2009-02-11T14:57:39.877
> 
> 标签：windows, wcf, ssl, netsh

netsh 命令需要一个 appid（[请参见此处](http://msdn.microsoft.com/en-us/library/ms733791.aspx)）：

```
netsh http add sslcert ipport=0.0.0.0:8000 certhash=0000000000003ed9cd0c315bbb6dc1c08da5e6 appid={00112233-4455-6677-8899-AABBCCDDEEFF} 
```

到目前为止，我还无法理解我应该如何知道 netsh 希望我提供的 GUID。有什么提示吗？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-02-11T15:07:33.473

您可以使用任何有效的 GUID。它仅用于允许您稍后识别绑定。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2010-09-20T21:05:28.873

我为我的 WCF 服务使用了 Application GUID，该服务位于我的托管应用程序（Windows 服务）的 AsseblyInfo.vb (VB.NET) 或 AssemblyInfo.cs (C#) 文件中，如下所示：

```
<Assembly: Guid("8fbacae2-bd4e-8ef5-b202-1561845dd04f")> 
```

我将其用作 netsh.exe 工具的 appid 参数，如下所示：

```
appid={8fbacae2-bd4e-8ef5-b202-1561845dd04f} 
```

它运行良好，我的 WCF 服务通过该 SSL 证书使用 Https。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-12-24T00:28:12.230

如果您使用 IIS GUI (inetmgr.exe) 绑定证书，然后执行“netsh http show sslcert”，您将看到 AppID 为 {4dc3e181-e14b-4a21-b022-59fc669b0914}，这是 IIS 使用的 AppID，所以它也是我使用的appid。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-04-25T06:29:42.570

“它总是说无效的参数......”

尝试`appid="{7E46BD40-39C6-4813-B414-019AD1122333}"`

带引号。

（对不起，不是直接回答这个问题，但这通常是谷歌第一次点击，很多人似乎有这个问题。更多：[“参数不正确。”错误使用netsh http add sslcert](https://stackoverflow.com/questions/779228/the-parameter-is-incorrect-error-using-netsh-http-add-sslcert)）

# java - 将每 N 个字符的 char 放入一个 java 字符串中

> ID：537174
> 
> 赞同：31
> 
> 时间：2009-02-11T14:57:41.967
> 
> 标签：java, string, char

我有一个 java 字符串，它的长度是可变的。

我需要将片段`"<br>"`放入字符串中，例如每 10 个字符。

例如这是我的字符串：

```
`this is my string which I need to modify...I love stackoverlow:)` 
```

我怎样才能获得这个字符串？：

```
`this is my<br> string wh<br>ich I nee<br>d to modif<br>y...I love<br> stackover<br>flow:)` 
```

谢谢

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-02-11T15:01:03.660

尝试：

```
String s = // long string
s.replaceAll("(.{10})", "$1<br>"); 
```

**编辑：**以上工作......大部分时间。我一直在玩它并遇到了一个问题：因为它在内部构造了一个默认模式，所以它在换行符处停止。要解决这个问题，您必须以不同的方式编写它。

```
public static String insert(String text, String insert, int period) {
    Pattern p = Pattern.compile("(.{" + period + "})", Pattern.DOTALL);
    Matcher m = p.matcher(text);
    return m.replaceAll("$1" + insert);
} 
```

精明的读者会发现另一个问题：您必须在替换文本中转义正则表达式特殊字符（如“$1”），否则您将得到不可预测的结果。

我也很好奇，并将这个版本与 Jon 的上述版本进行了基准测试。这个慢了一个数量级（60k 文件上的 1000 次替换用这个用了 4.5 秒，用他用了 400ms）。在 4.5 秒中，实际上只有大约 0.7 秒是在构建模式。其中大部分是在匹配/替换上，所以它甚至没有导致自己进行那种优化。

我通常更喜欢不那么冗长的解决方案。毕竟，更多代码 = 更多潜在错误。但在这种情况下，我必须承认 Jon 的版本——实际上是天真的实现（我的意思是一种**很好的方式**）——明显更好。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-02-11T15:01:37.480

就像是：

```
public static String insertPeriodically(
    String text, String insert, int period)
{
    StringBuilder builder = new StringBuilder(
         text.length() + insert.length() * (text.length()/period)+1);

    int index = 0;
    String prefix = "";
    while (index < text.length())
    {
        // Don't put the insert in the very first iteration.
        // This is easier than appending it *after* each substring
        builder.append(prefix);
        prefix = insert;
        builder.append(text.substring(index, 
            Math.min(index + period, text.length())));
        index += period;
    }
    return builder.toString();
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2020-04-23T08:49:01.670

我从[String Manipulation 来到这里，每 4 个字符插入一个字符](https://stackoverflow.com/questions/4169699/string-manipulation-insert-a-character-every-4th-character)，并正在使用 Kotlin 在 Android 上寻找解决方案。

只需添加一种使用 Kotlin 的方法（您必须喜欢它的简单性）

```
val original = "123498761234"
val dashed = original.chunked(4).joinToString("-") // 1234-9876-1234 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2018-03-01T21:18:20.070

您可以使用正则表达式 '..' 来匹配每两个字符并将其替换为 "$0" 以添加空格：

s = s.replaceAll("..", "$0"); 您可能还想修剪结果以删除最后的额外空间。

或者，您可以添加一个否定的前瞻断言以避免在字符串末尾添加空格：

s = s.replaceAll("..(?!$)", "$0");

例如：

`String s = "23423412342134"; s = s.replaceAll("....", "$0<br>"); System.out.println(s);`

输出：`2342<br>3412<br>3421<br>34`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-11T03:28:07.597

为了避免断字...

尝试：

```
 int wrapLength = 10;
    String wrapString = new String();

    String remainString = "The quick brown fox jumps over the lazy dog The quick brown fox jumps over the lazy dog";

    while(remainString.length()>wrapLength){
        int lastIndex = remainString.lastIndexOf(" ", wrapLength);
        wrapString = wrapString.concat(remainString.substring(0, lastIndex));
        wrapString = wrapString.concat("\n");

        remainString = remainString.substring(lastIndex+1, remainString.length());
    }

    System.out.println(wrapString); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-06-22T20:22:35.713

如果您不介意对[第三方库](http://google.github.io/guava/releases/16.0/api/docs/com/google/common/base/Joiner.html)的依赖并且不介意正则[表达式](https://stackoverflow.com/a/12295805/59087)：

```
import com.google.common.base.Joiner;

/**
 * Splits a string into N pieces separated by a delimiter.
 *
 * @param text The text to split.
 * @param delim The string to inject every N pieces.
 * @param period The number of pieces (N) to split the text.
 * @return The string split into pieces delimited by delim.
 */
public static String split( final String text, final String delim, final int period ) {
    final String[] split = text.split("(?<=\\G.{"+period+"})");
    return Joiner.on(delim).join(split);
} 
```

然后：

```
split( "This is my string", "<br/>", 5 ); 
```

这不会在空格处拆分单词，但如前所述，问题不要求自动换行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-11T15:04:03.293

```
StringBuilder buf = new StringBuilder();

for (int i = 0; i < myString.length(); i += 10) {
    buf.append(myString.substring(i, i + 10);
    buf.append("\n");
} 
```

您可以获得比这更高的效率，但我将把它作为练习留给读者。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-12-07T23:22:44.603

我已经针对边界条件对该解决方案进行了单元测试：

```
public String padded(String original, int interval, String separator) {
    String formatted = "";

    for(int i = 0; i < original.length(); i++) {
        if (i % interval == 0 && i > 0) {
            formatted += separator;
        }
        formatted += original.substring(i, i+1);
    }

    return formatted;
} 
```

致电：

```
padded("this is my string which I need to modify...I love stackoverflow:)", 10, "<br>"); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-11T15:04:06.993

一种方法如何每隔 N 个字符拆分一次字符串：

```
public static String[] split(String source, int n)
{
    List<String> results = new ArrayList<String>();

    int start = 0;
    int end = 10;

    while(end < source.length)
    {
        results.add(source.substring(start, end);
        start = end;
        end += 10;
    }

    return results.toArray(new String[results.size()]);
} 
```

然后是另一种在每件作品之后插入一些东西的方法：

```
public static String insertAfterN(String source, int n, String toInsert)
{
    StringBuilder result = new StringBuilder();

    for(String piece : split(source, n))
    {
        result.append(piece);
        if(piece.length == n)
            result.append(toInsert);
    }

    return result.toString();
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-02-23T15:31:03.437

以下方法采用三个参数。第一个是您要修改的文本。第二个参数是您要每 n 个字符插入的文本。第三个是您要在其中插入文本的间隔。

```
private String insertEveryNCharacters(String originalText, String textToInsert, int breakInterval) {
    String withBreaks = "";
    int textLength = originalText.length(); //initialize this here or in the start of the for in order to evaluate this once, not every loop
    for (int i = breakInterval , current = 0; i <= textLength || current < textLength; current = i, i += breakInterval ) {
        if(current != 0) {  //do not insert the text on the first loop
            withBreaks += textToInsert;
        }
        if(i <= textLength) { //double check that text is at least long enough to go to index i without out of bounds exception
            withBreaks += originalText.substring(current, i);
        } else { //text left is not longer than the break interval, so go simply from current to end.
            withBreaks += originalText.substring(current); //current to end (if text is not perfectly divisible by interval, it will still get included)
        }
    }
    return withBreaks;
} 
```

你会像这样调用这个方法：

```
String splitText = insertEveryNCharacters("this is my string which I need to modify...I love stackoverlow:)", "<br>", 10); 
```

结果是：

```
this is my<br> string wh<br>ich I need<br> to modify<br>...I love <br>stackoverl<br>ow:) 
```

^这与您的示例结果不同，因为由于人为错误，您有一个包含 9 个字符而不是 10 个字符的集合；）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-05-20T16:37:20.677

Kotlin 正则表达式版本：

```
fun main(args: Array<String>) {    
    var original = "this is my string which I need to modify...I love stackoverlow:)"
    println(original)
    val regex = Regex("(.{10})")
    original = regex.replace(original, "$1<br>")
    println(original)
} 
```

[科特林游乐场](https://pl.kotl.in/GFTm5kNWk)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-14T11:04:08.007

```
String s = // long string
String newString = String.join("<br>", s.split("(?<=\\G.{10})")); 
```

`<br>`如果`s`length 是 的倍数，则不添加final `10`。

感谢[@cletus](https://stackoverflow.com/users/18393/cletus)和这个灵感的[答案](https://stackoverflow.com/a/54346446/12711179)

# regex - 正则表达式将换行符插入到特定位置的大块文本中

> ID：537187
> 
> 赞同：5
> 
> 时间：2009-02-11T15:01:08.043
> 
> 标签：regex

我有一个相当大的文本文件，其中缺少一堆换行符，这意味着它一团糟。我需要把它分成适当的行。

文本现在看起来像这样：

```
12345 This is a chunk 23456 This is another chunk 34567 This is yet another chunk 45678 This is yet more chunk 56789 Yet another piece of text 
```

我需要一个正则表达式，它将在每组五位数字之前插入一个换行符（CR/LF 对），结果如下：

```
12345 This is a chunk 
23456 This is another chunk 
34567 This is yet another chunk 
45678 This is yet more chunk 
56789 Yet another piece of text 
```

可以在第一组数字前插入一个，也可以不插入；我可以处理。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-11T15:04:59.500

非常简单（但不是尽可能“华丽”，因为我懒得使用前瞻）：

```
s/(\d{5})/\r\n\1/gs 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-11T15:12:54.273

```
s/(?<=\D)(\d{5})(?=\D|$)/\n\1/g 
```

### 关于“\n”与“\r\n”

这可能取决于手头的编程语言，但 Perl 和 Python 在 Windows 上替换`\n`为`\r\n`，因此在这种情况下，在上述正则表达式中替换为是错误`\n`的`\r\n`。

# linux - sort -R 命令不会在 Linux 中随机对行进行排序

> ID：537191
> 
> 赞同：14
> 
> 时间：2009-02-11T15:01:41.037
> 
> 标签：linux, bash, sorting

我无法让 --random-sort 在 Fedora Linux 系统上使用 sort 命令。

一些上下文信息：

```
$ cat /etc/fedora-release
Fedora release 7 (Moonshine)
$ which sort
/bin/sort
$ man sort | grep -A 2 '\-R'
       -R, --random-sort
              sort by random hash of keys

$ man sort | grep -A 3 '\-R'
       -R, --random-sort
              sort by random hash of keys

       --random-source=FILE 
```

和测试：

```
$ echo -e "2\n1\n3\n5\n4"
2
1
3
5
4
$ echo -e "2\n1\n3\n5\n4" | sort -r # Sort in reverse order
5
4
3
2
1
$ echo -e "2\n1\n3\n5\n4" | sort -R # Sort in random order
1
2
3
4
5
$ # Fail! That's not random (I've tried it multiple times.) 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-11T15:06:37.110

它适用于我的 Ubuntu 8.04 机器。也许问题是随机数的来源。从手册：

> --随机源=文件
> 
> ```
>  get random bytes from FILE (default /dev/urandom) 
> ```

```
# this should give always the same result:
echo -e '2\n1\n3\n5\n4' | sort -R --random-source=/dev/zero

# this should be random:
echo -e '2\n1\n3\n5\n4' | sort -R --random-source=/dev/urandom 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-29T05:08:33.180

来自 GNU coreutils 手册：

> 通过散列输入键然后对散列值进行排序来排序。随机选择散列函数，确保它没有冲突，以便不同的键具有不同的散列值。这就像输入的随机排列（请参阅 shuf 调用），**除了具有相同值的键排序在一起**。
> 
> 如果指定了多个随机排序字段，则对所有字段使用相同的随机散列函数。要对不同的字段使用不同的随机散列函数，您可以多次调用 sort。

GNU sort -R 接受相同的输入并将其组合在一起；该线程可能会提供一些替代方案：[如何使用 Red Hat Linux 上的标准工具随机化文件中的行？](https://stackoverflow.com/questions/886237/how-can-i-randomize-the-lines-in-a-file-using-a-standard-tools-on-redhat-linux)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T16:02:57.130

我不知道 bash 是否以这种方式工作，但是在 ksh 中有一个“whence”命令，它可以准确地告诉你如果你将参数作为命令输入会执行什么，而“which”只是告诉你第一个实例$PATH 中的命令。例如：

```
wembley 0 /home/jj33 > which ls
/bin/ls
wembley 0 /home/jj33 > whence ls
'/bin/ls -FC' 
```

我怀疑这是您的问题，但下一个故障排除步骤是在执行时为“排序”指定确切的路径（或使用反斜杠转义可能的别名）：

```
$ echo -e "2\n1\n3\n5\n4" | /bin/sort -R 
```

在那之后，我可能会怀疑是环境或语言环境设置让它变得不稳定。不一定重要，但 LC_* 变量通常会产生意想不到的副作用（我在新盒子上做的第一件事是设置 LC_ALL=C 将其全部关闭 =)）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-02T21:14:46.873

我知道这是一篇旧帖子，但这个解决方案效果很好......以防万一有人在寻找

```
dir='/home/path-to-folder'
cd $dir
file=`ls |sort -R |tail --lines=1` 
echo $file 
```

# python - python，线程和 IDE 的有趣业务？

> ID：537196
> 
> 赞同：0
> 
> 时间：2009-02-11T15:02:29.337
> 
> 标签：python, multithreading, ide

也许我不能做我想做的事？我想让 1 个线程执行它想要的操作，并让第 2 个线程接收用户输入以设置退出标志。使用此代码我想随时输入 q 以退出或在打印 6 次后让它超时

```
import sys
import threading
import time

class MyThread ( threading.Thread ):
    def run (s):
        try:
            s.wantQuit = 0
            while(not s.wantQuit):
                print "want input"
                button = raw_input()
                if button == "q":
                    s.wantQuit=1
        except KeyboardInterrupt:
            s.wantQuit = 1
            print "abort with KeyboardInterrupt"
        print "done mythread"

myThread = MyThread ()
myThread.start()

a=5
while not myThread.wantQuit:
    print "hey"
    if (a == 0):
        break;
    a = a-1;
    time.sleep(1)
myThread.wantQuit=1
print "main thread done" 
```

发生的事情不是两个线程，而是我让主线程打印 4/6 次，然后弹出一个对话框询问我的输入，并且应用程序被锁定，直到我输入它。怎么回事？！

```
want input
hey
hey
hey
hey
abort with KeyboardInterrupt
done mythread
main thread done 
```

我正在使用 PyScripter（它具有调试功能），我还尝试了 pydle，它似乎不允许我输入输入并在运行一次后最终锁定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T16:02:40.377

这里的问题是 raw_input 等待输入来刷新输入流；查看它的[文档](http://docs.python.org/library/functions.html#raw_input)。PyScripter 可能看到程序正在等待输入并为您提供输入框（不确定，从未使用过。）

该程序完全按照我在命令行中的预期工作；辅助线程在 raw_input 上阻塞，直到我点击“q[enter]”，此时程序结束。

在阻塞读取调用之前，AFAICS 不容易检查输入流中的字符是否可用。您可能应该查看[这个线程](http://mail.python.org/pipermail/python-list/2005-January/303883.html)，了解如何在不需要 [enter] 的情况下以阻塞方式读取字符，然后查看[这篇](http://mail.python.org/pipermail/python-list/2005-January/302469.html)关于完全不阻塞读取字符的挑战的帖子。

您可以在 Windows 上使用 msvcrt.kbhit 和python FAQ 中的[这个配方](http://www.python.org/doc/faq/library/#how-do-i-get-a-single-keypress-at-a-time)的组合来获取 q 字符而无需按键，但我将把它作为练习留给读者。

附录：您可以做的一件事是使用选择库设置从键盘读取的超时，这将使您的程序更像您期望的那样：

```
import sys
import threading
import time
import select

def timeout_read(n_chars):
  r, _, _ = select.select([sys.stdin], [], [], 1)
  return r[0].read(n_chars) if r else ""

class MyThread (threading.Thread):
    def run (self):
        try:
            self.wantQuit = 0
            while not self.wantQuit:
                print "want input"
                button = timeout_read(1)
                if button == "q":
                    self.wantQuit=1
        except KeyboardInterrupt:
            self.wantQuit = 1
            print "abort with KeyboardInterrupt"
        print "done mythread"

myThread = MyThread ()
myThread.start()

a=5
while not myThread.wantQuit:
    print "hey"
    if (a == 0):
        break;
    a = a-1;
    time.sleep(1)
myThread.wantQuit=1
print "main thread done" 
```

请注意，您仍然需要使用此解决方案按“q[enter]”。

# javascript - javascript调用函数内部的另一个谜团

> ID：537198
> 
> 赞同：2
> 
> 时间：2009-02-11T15:02:52.970
> 
> 标签：javascript

函数 Obj1(param) { this.test1 = 参数 || 1个；}

```
function Obj2(param, par)
{
    this.test2 = param;
    this.ob = Obj1;
    this.ob(par);
} 
```

现在为什么如果我这样做：

```
alert(new Obj2(44,55).test1); 
```

输出是 55？如果我没有通过原型链链接两者，如何“查看”test1 和 Obj2 实例？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T15:11:12.497

好吧，目前尚不清楚您*想要*什么，但发生这种情况的原因是因为这里：

```
this.ob = Obj1; 
```

您将 Obj1 方法添加到 Obj2 的对象实例中，当您在此处使用它时：

```
this.ob(par); 
```

方法 Obj1 中“this”的上下文是*Obj2 实例*。所以该实例现在有一个 test1 成员。

与继承无关，但它有点像混合。请记住，在 JS 中，函数是第一类对象。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T17:25:43.110

让我们将 Obj1 视为一个**函数**。所以，当你这样做

```
function Obj2(param, par)
{
    this.test2 = param;
    this.ob = Obj1;
    this.ob(par);
} 
```

您的代码与以下代码相同：

```
function Obj2(param, par)
{
    this.test2 = param;
    this.ob = function (param) { this.test1 = param || 1; }
    this.ob(par);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T17:05:53.953

> 如果我没有通过原型链链接两者，如何“查看”test1 和 Obj2 实例？

JavaScript 中没有绑定方法。当您编写以下内容之一时：

```
o.method(x);
o['method'](x); 
```

'o' 的值被分配给方法内的 'this'。但！如果您将函数与其对象分离并直接调用它：

```
m= o.method;
m(x); 
```

对“o”的引用丢失了，并且该方法被调用，就好像它是一个普通的旧函数一样，全局对象为“this”。同样，如果您将函数移动到另一个对象并在那里调用它：

```
o2.method= o.method;
o2.method(x); 
```

那么“this”将是“o2”，而不是“o”。对于具有一流函数且高度违反直觉的语言来说，这是一种极其奇怪的行为，但这就是 JavaScript。

如果您希望能够使用绑定方法，则需要创建自己的方法，通常使用闭包。请参阅 ECMAScript 3.1 提出的“Function.bind”方法或许多框架中的类似实现。

所以无论如何：

```
this.ob = Obj1;
this.ob(par); 
```

这将 Obj1 作为一个函数，并变成了 'this' 上的一个方法，它是一个 Obj2 实例。因此，当调用 Obj1 时，它自己的“this”也是一个 Obj2，这就是它写入其参数的“this”。同样可以更简单、更清楚地写成：

```
Obj1.call(this, par); 
```

你是故意这样做的吗？它可以作为一种继承，在自己的类上调用另一个类的构造函数，这种方法在一些JS面向对象的教程中有讲授。但是，这确实不是一个很好的方法，因为您最终会得到同一属性的多个副本；使用原型将为您节省这一点，并按预期对超类过滤器的属性更新到子类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T15:13:46.563

函数内部指的是什么`this`取决于你如何调用函数。如果您将其称为`sender.fn()`，那么`this`就是`sender`（您的情况）。如果你这样做`fn()`，那么`this`就是全局对象。

# c# - LINQ to SQL 中数据库数据的本地化/I18n

> ID：537204
> 
> 赞同：1
> 
> 时间：2009-02-11T15:03:42.517
> 
> 标签：c#, .net, linq, linq-to-sql, internationalization

我的数据库中有状态表，以及包含这些状态的特定语言版本的“本地化”表。主状态表的要点是定义状态 ID 值，以及有关状态的其他元数据。“本地化”表是根据用户的首选语言在 UI 中显示文本表示。这是一个示例架构：

```
create table [Language]
(
    ID smallint primary key,
    ISOName varchar(12)
)

create table EmployeeStatus
(
    ID smallint primary key,
    Code varchar(50)
)

create table EmployeeStatusLocalised
(
    EmployeeStatusID smallint,
    LanguageID smallint,
    Description varchar(50),
    constraint PK_EmployeeStatusLocalised primary key
        (EmployeeStatusID, LanguageID),
    constraint FK_EmployeeStatusLocalised_EmployeeStatus foreign key 
        (EmployeeStatusID) references EmployeeStatus (ID),
    constraint FK_EmployeeStatusLocalised_Language foreign key
        (LanguageID) references [Language] (ID)
)

create table Employee
(
    ID int identity(1,1) primary key,
    EmployeeName varchar(50) not null,
    EmployeeStatusID smallint not null,
    constraint FK_Employee_EmployeeStatus foreign key
        (EmployeeStatusID) references EmployeeStatus (ID)
) 
```

这就是我通常访问该数据的方式：

```
select e.EmployeeName, esl.Description as EmployeeStatus
from Employee e
inner join EmployeeStatusLocalised esl on
    e.EmployeeStatusID = esl.EmployeeStatusID and esl.LanguageID = 1 
```

不过，我并不很高兴我的 LINQ to SQL 以最有效的方式做事。这是一个例子：

```
using (var context = new MyDbDataContext())
{
    var item = (from record in context.Employees
                select record).Take(1).SingleOrDefault();

    Console.WriteLine("{0}: {1}", item.EmployeeName,
        item.EmployeeStatus.EmployeeStatusLocaliseds.
            Where(esl => esl.LanguageID == 1).Single().Description);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T12:26:23.633

就个人而言，我可能会将 EmployeeStatus 代码留在数据库中，并将所有本地化逻辑移至客户端。如果这是一个 Web 应用程序（ASP.NET 或 ASP.NET MVC），那么您将使用 EmployeeStatus 代码作为资源文件的键，然后使用 UICulture="Auto" 和 Culture="Auto" 告诉 ASP .NET 根据“Accept-Language”HTTP 标头获取正确的资源。

您将提供嵌入在您的应用程序中的默认（文化不敏感）资源，并允许 satalite 程序集在需要的地方覆盖默认值。

对我来说，将本地化添加到数据库中的问题在于，您首先会遇到更复杂的查询，您必须不断将语言环境注入每个查询，并且您不能如此广泛地缓存查询的输出. 其次，您混合了包含实体的表和包含本地化的表。最后，需要一个 DBA 来进行本地化。

理想情况下，您希望有人了解如何翻译文本来进行本地化，并让他们使用一些他们熟悉的工具。有很多 .resx 工具，以及允许语言专家“做他们的事”的应用程序。

如果您因为“就是这样”而坚持使用数据库表进行本地化，那么也许您应该将查找单独查询到真实数据，并在 UI 中将两者连接起来。这至少会在将来为您提供一个“升级路径”到 .RESX。

如果你对这个领域感兴趣，你应该看看 Guy Smith-Ferrier 关于 i18n 的书：

[http://www.amazon.co.uk/NET-Internationalization-Developers-Guide-Building/dp/0321341384/ref=sr_1_1?ie=UTF8&s=books&qid=1239106912&sr=8-1](http://www.amazon.co.uk/NET-Internationalization-Developers-Guide-Building/dp/0321341384/ref=sr_1_1?ie=UTF8&s=books&qid=1239106912&sr=8-1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T21:14:09.923

一种选择是维护本地化数据的缓存，使用缓存应用程序块或 ASP.NET 缓存之类的东西，然后只在视图中引用该缓存。

这将限制数据库调用的数量，因为 LINQ 可能不需要加载状态记录来获取本地化描述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T04:20:24.880

您可以在 DataContext 中使用 LoadOptions，因此它会在初始查询中加载数据。线条周围的东西：

```
var options = new DataLoadOptions();
options.AssociateWith<Employee>(e=>
    e.EmployeeStatus.EmployeeStatusLocaliseds
    .Where(esl => esl.LanguageID == 1)
    );
options.LoadWith<Employee>(e=>e.EmployeeStatus.EmployeeStatusLocaliseds);

    using (var context = new MyDbDataContext())
    {
        context.LoadOptions = options;
        var item = (from record in context.Employees
                    select record).Take(1).SingleOrDefault();

        Console.WriteLine("{0}: {1}", item.EmployeeName,
            item.EmployeeStatus.EmployeeStatusLocaliseds
            .Single().Description
        );
    } 
```

另一方面，状态可能几乎是静态数据，因此缓存它们会非常有效。如果您坚持使用生成的实体，您可以在使用缓存的部分 Employee 类上定义一个属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T06:17:13.680

另外：在这种情况下，我会考虑将状态*码*（而不是 id）视为主键，并`Code`在`Employee`; 这保留了外键，但减少了所需的连接和导航次数。它还允许您将代码映射到`enum`您的 .NET 代码中。

我可能会使用 i18n 文本值的惰性（按需）缓存；这：

*   最小化查询复杂度
*   最小化数据吞吐量/IO
*   最大限度地减少对象身份/更改跟踪开销
*   最小化不断发生的“物化”的数量
*   允许您仅针对对象模型中的枚举进行编程，但显示 i18n 文本
*   抽象 i18n 实现（因此如果需要，您可以切换到 resx 或类似的，或者自动翻译服务）
*   允许您获取 i18n 值而不绑定到现有数据查询 - 即填充搜索屏幕的下拉框（与个别员工无关，因此示例查询无济于事）

我猜 i18n 数据变化缓慢，所以缓存方法是理想的。

我会一次加载所有**相关**的字符串一种语言 - 所以第一次在威尔士语中需要状态时（例如），我会加载威尔士语的*所有*状态字符串，并针对标准代码（cy）缓存语言。

为了使视图代码更简单，请考虑在员工（在 UI 级别）上使用扩展方法：

```
public static class EmployeeExtensions {
    public static string GetStatusText(this Employee emp) {
         /* do your funky thing, presumably using the HttpContext or
         some other thread-static value to resolve the current culture */
    }
} 
```

那么在您看来，您可以使用：

```
<%=emp.GetStatusText()%> 
```

等等。不幸的是，没有扩展属性，但是使用方法，您还可以选择将语言代码传递给方法（在添加参数之后）：

```
<%=emp.GetStatusText(lang)%> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T07:00:03.827

我为我们的场景找到了一个很好的解决方案。

“设计”是这样的：

1.  使用 PK ID 创建一个名为“GlobalizedString”的表。
2.  创建一个名为“LocalizedString”的表，并引用上面和以下字段：
    *   CultureId（参考一些文化查找表）
    *   内容（将采用上述语言的字符串）

在 GlobalizedString 上，添加一个名为“Content”的属性（请注意，这不能通过 LINQ2SQL 查询，但可以在 LINQ2Objects 中使用），如下所示：

```
public string Content
{
  get { return LocalizedStrings.Single( 
           x => x.Culture.CultureCode == 'my current CultureInfo's code'); }
  set { /* exercise for reader */ }
} 
```

因此，您不再使用 nvarchar 列，而是指向 GlobalizedString 表。

现在，您可以使用普通的“逻辑”（例如绑定），只需引用 GlobalizedString 的 Content 属性即可获取当前语言的 Content :)

如前所述，此 Content 属性不适用于 Linq2SQL，我仍在寻找一种简单的方法来实现这一点（欢迎提出建议）。

否则，系统会很好地为我们服务 :)

# c# - 使用 C# 搜索 Web 内容

> ID：537214
> 
> 赞同：4
> 
> 时间：2009-02-11T15:04:25.010
> 
> 标签：c#

如何使用 C# 搜索网站源代码？很难解释，这是在 python 中做的源代码

```
import urllib2, re
word = "How to ask"
source = urllib2.urlopen("http://stackoverflow.com").read()
if re.search(word,source):
     print "Found it "+word 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T15:15:03.563

如果您想从网页访问原始 HTML，您需要执行以下操作：

1.  使用 HttpWebRequest 连接到文件
2.  打开连接，将响应流读入字符串
3.  在响应中搜索您的内容

所以编写如下代码：

```
string pageContent = null;
HttpWebRequest myReq = (HttpWebRequest)WebRequest.Create("http://example.com/page.html");
HttpWebResponse myres = (HttpWebResponse)myReq.GetResponse();

using (StreamReader sr = new StreamReader(myres.GetResponseStream()))
{
    pageContent = sr.ReadToEnd();
}

if (pageContent.Contains("YourSearchWord"))
{
    //Found It
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T15:32:19.747

我想这与您在 C# 中与您的 python 代码一样接近。

```
using System;
using System.Net;

class Program
{
    static void Main()
    {
        string word = "How to ask";
        string source = (new WebClient()).DownloadString("http://stackoverflow.com/");
        if(source.Contains(word))
            Console.WriteLine("Found it " + word);
    }
} 
```

我不确定 re.search(#, #) 是否区分大小写。如果不是，您可以使用...

```
if(source.IndexOf(word, StringComparison.InvariantCultureIgnoreCase) > -1) 
```

反而。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:14:13.160

这是获取页面HTML代码的来源，您可以稍后添加您的搜索方法：

```
string url = "http://someurl.com/default.aspx";
WebRequest webRequest=WebRequest.Create(url);
WebResponse response=webRequest.GetResponse();

Stream str=response.GetResponseStream();
StreamReader reader=new StreamReader(str);
string source=reader.ReadToEnd(); 
```

希望这可以帮助。

# xml - xsd 架构验证

> ID：537215
> 
> 赞同：0
> 
> 时间：2009-02-11T15:04:33.777
> 
> 标签：xml, validation, xsd, schema

我遇到了 xsd 架构的问题。我定义了以下架构：

```
<xs:element name="nodes" type="nodesRootType" />

<xs:complexType name="nodesRootType">
    <xs:sequence minOccurs="1" maxOccurs="unbounded">
        <xs:element name="node" type="nodeType" />
    </xs:sequence>
</xs:complexType>

<xs:complexType name="nodeType">
    <xs:sequence minOccurs="0" maxOccurs="unbounded">
        <xs:element name="node" type="nodeType" />
    </xs:sequence>
    <xs:attribute name="name" type="xs:string" use="required" />
</xs:complexType> 
```

我正在以下 xml 上对其进行测试：

```
<label name="Label_6" >
    <label name="Label_7" />
</label>
<label name="Label_8" /> 
```

我得到的错误是：

```
cvc-complex-type.2.4.a: Invalid content 
    was found starting with element 'node'. One of '{node}' is expected. 
```

我在这里错过了什么。非常感谢任何帮助。

最好的，约瑟夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T15:49:11.203

您正在验证的单个 XML 文档不能有多个根。它必须有一个根。你的 XML：

```
<label name="Label_6">
    <label name="Label_7"/>
</label>
<label name="Label_8"/> 
```

有两个根，因为`label`在根级别都有两个 " " 元素。此外，您的架构没有定义任何名为“ `label`”的元素，所以我很困惑。您可能需要一个模式来验证类似于以下 XML 的内容：

```
<labels>
    <label name="Label_6">
        <label name="Label_7"/>
    </label>
    <label name="Label_8"/>
</labels> 
```

在这里你有一个单一的根“ `labels`”。请注意，您`label`在层次结构中的不同级别有具有相同名称的元素“”。这不是禁止的（例如，请参阅 xhtml，您可以在其中拥有`div`inside a `div`inside ...），但它可能会令人困惑。对于上面显示的示例 XML，请尝试以下模式：

```
<xs:element name="labels">
  <xs:complexType>
    <xs:sequence>
      <xs:element ref="label" minOccurs="1" maxOccurs="unbounded"/>
    </xs:sequence>
  </xs:complexType>
</xs:element>

<xs:complexType name="labelType">
  <xs:sequence>
    <xs:element ref="label" minOccurs="0" maxOccurs="unbounded"/>
  </xs:sequence>
  <xs:attribute name="name" type="xs:string" use="required"/>
</xs:complexType>

<xs:element name="label" type="labelType"/> 
```

# c# - 如何在页面加载时强制下拉列表选择？

> ID：537217
> 
> 赞同：0
> 
> 时间：2009-02-11T15:04:59.157
> 
> 标签：c#, .net, asp.net

我有一个重定向到 Page1.aspx 的 Default.aspx。我的 ddl 是从数据库加载和订购的。如何根据用户在默认页面上选择的内容使 ddl 选择显示在页面加载中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T15:08:37.183

您需要将某种数据从 Default.aspx 传递到 Page1.aspx。我建议使用查询字符串。因此，例如在 Default.aspx 上，您将重定向到：

`Response.Redirect("~/Page1.aspx?selectValue=5");`

然后在 Page_Load 中的 Page1.aspx 上，你会做类似的事情

`myDropDownList.SelectedValue = Request.QueryString("selectValue");`

显然，您需要对 Page1.aspx 进行更多检查以确保 Request.QueryString("selectValue") 存在等，但您明白了。

编辑-这是 C#，所以添加了分号 ;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T15:06:44.583

你能做的最好的就是 dropdownelement.focus();

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:07:54.533

在进行重定向之前，您需要以某种方式将选择传递给 Page1.aspx，可能使用查询字符串或会话状态。然后在加载时在 Page1 上的 ddl 上设置 SelectedValue。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T15:09:05.467

您需要通过 QueryString 将默认页面 ddl 选择传递给 page1 页面，或者将其存储在会话变量中。

# mysql - MySQL - 控制组返回哪一行

> ID：537223
> 
> 赞同：61
> 
> 时间：2009-02-11T15:06:39.887
> 
> 标签：mysql, sql-order-by, group-by

我有一个这样的数据库表：

```
id    version_id    field1    field2
1     1             texta      text1
1     2             textb      text2
2     1             textc      text3
2     2             textd      text4
2     3             texte      text5 
```

如果你没有解决它，它包含一行的多个版本，然后是一些文本数据。

我想查询它并返回每个 id 编号最大的版本。（因此仅在上面的第二行和最后一行）。

我在按 version_id DESC 排序时尝试使用 group by - 但它似乎在分组后排序，所以这不起作用。

有人有什么想法吗？我就不信做不到！

更新：

想出这个，它有效，但使用子查询：

```
SELECT *
FROM (SELECT * FROM table ORDER BY version_id DESC) t1
GROUP BY t1.id 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-02-11T15:09:42.627

这称为选择列的分组最大值。[以下是mysql的几种不同方法。](http://kristiannielsen.livejournal.com/6745.html)

这是我的做法：

```
SELECT *
FROM (SELECT id, max(version_id) as version_id FROM table GROUP BY id) t1
INNER JOIN table t2 on t2.id=t1.id and t1.version_id=t2.version_id 
```

这将是相对有效的，尽管 mysql 会在内存中为子查询创建一个临时表。我假设您已经为该表创建了 (id, version_id) 索引。

SQL 的一个不足之处在于，您或多或少必须对此类问题使用子查询（[半连接](http://en.wikipedia.org/wiki/Relational_algebra#Semijoin)是另一个示例）。

子查询在 mysql 中没有得到很好的优化，但不相关的子查询并没有那么糟糕，只要它们不是太大以至于它们将被写入磁盘而不是内存。鉴于在此查询中只有两个整数，子查询可能在此之前很久就有数百万行，但您的第一个查询中的 select * 子查询可能会更快地遇到这个问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T15:09:54.607

我认为这会做到这一点，但不确定它是最好的还是最快的。

```
SELECT * FROM table 
WHERE (id, version_id) IN 
  (SELECT id, MAX(version_id) FROM table GROUP BY id) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T15:29:28.693

```
SELECT id, version_id, field1, field2
FROM (
    SELECT @prev = id AS st, (@prev := id), m.*
    FROM (
           (SELECT @prev := NULL) p,
           (
            SELECT *
            FROM   mytable
            ORDER BY
                   id DESC, version_id DESC
           ) m
     ) m2
WHERE NOT IFNULL(st, FALSE); 
```

`UNIQUE INDEX ON MYTABLE (id, version_id)`没有子查询，如果你有一个就传递一个（我认为你应该这样做）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-23T08:48:06.147

此查询将通过以下方式在没有组的情况下完成工作：

```
SELECT * FROM table AS t
LEFT JOIN table AS t2 
    ON t.id=t2.id 
    AND t.version_id < t2.version_id
WHERE t2.id IS NULL 
```

它不需要任何临时表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T15:10:15.183

这是伪代码，但这样的东西应该可以正常工作

```
select *
from table
inner join
(
    select id , max(version_id) maxVersion
    from table 
) dvtbl ON id = dvtbl.id && versionid = dvtbl.maxVersion 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T15:10:52.343

我通常使用子查询来做到这一点：

select id, version_id, field1, field2 from datatable as dt where id = (select id from datatable where id = dt.id order by version_id desc limit 1)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-30T13:31:22.747

也可以随时使用分析功能，这将为您提供更多控制权

`select tmp.* from ( select id,version_id,field1,field2, rank() over(partition by id order by version_id desc ) as rnk from table) tmp where tmp.rnk=1`

如果您根据数据类型遇到 rank() 函数的问题，那么也可以从 row_number() 或 dense_rank() 中进行选择。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-11T15:18:30.530

我想这就是你想要的。

```
select id, max(v_id), field1, field2 from table group by id 
```

我从中得到的结果是

> 1、2、文本b、文本2
> 
> 2, 3, texte, text5

**编辑：** 我重新创建了表并插入了相同的数据，其中 id 和 version_id 是复合主键。这给出了我之前提供的答案。它也在 MySQL 中。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-05-08T23:13:06.233

没有测试过，但这样的事情可能会起作用：

SELECT * FROM table GROUP BY id ORDER BY MAX(version_id) DESC

# filemaker - 在 Filemaker Pro 中检索新插入行的 ID

> ID：537225
> 
> 赞同：2
> 
> 时间：2009-02-11T15:07:14.067
> 
> 标签：filemaker

有一个服务正在运行，它监视服务器上文件夹中的文件。每当将文件复制到此文件夹时，都会移动文件，并通过 ODBC 连接将记录写入 filemaker pro 数据库。在同一个过程中，我需要新创建行的 ID 来在另一个表中创建相关记录（具有外键约束）。在 Microsoft SQL Server 中，我将使用 @@identity 来执行此操作，在 Oracle 中，我将使用 sequence.CURRVAL。如何在 Filemaker 中获取新创建行的标识字段？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T17:49:43.947

我不是 FileMaker 的 ODBC 接口的经验丰富的用户，但我可以建议一个可行的解决方案。

我假设您正在使用 INSERT 语句将数据导入 FileMaker，您要在其中创建记录的表中有一个“ID”号字段，并且 ID 字段设置为自动输入序列号数字。如果是这种情况，根据 FileMaker 的 ODBC 文档支持 MAX 函数。

```
SELECT MAX (Table.ID) FROM Table 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T14:14:49.797

不幸的是，FileMaker ODBC 没有执行此操作的内置函数。这是一个真正的问题。

问题源于 FileMaker 没有内置对主键的支持。当然，几乎每个表都有一个唯一 ID，但 FileMaker 没有任何内部方法可以“知道”开发人员打算将哪个字段作为主键。这使得 ODBC 引擎无法知道要回馈给您什么价值。

我认为大多数人在这种情况下最终会做的是将某种 UUID 插入到数据库中的新列中，作为他们 CREATE 的一部分。然后立即使用 where 子句中带有 UUID 的另一个查询来选择 ID。所以你必须做两个查询。第一个插入，第二个取回 ID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-15T20:25:13.130

您能否通过在插入新行之前生成唯一 ID 并将此 ID 添加到每条记录中来解决此问题？这将使您能够在创建两个记录后识别它们。

我也会问你为什么需要这个功能。将文件复制到文件夹时，您将记录添加到 2 个不同的表中。显然，我不知道解决方案是什么，所以我不能建议一种或另一种方式。

不过，此时我的建议是重新考虑将组织 FileMaker 数据的逻辑放入 ODBC 流程中。听起来原始记录应该充当标记或触发器。可以将 ODBC 进程仅作为创建记录的一种机制，而将如何使用该记录的逻辑留给另一个进程，比如 FM 脚本吗？

# flash - Flash 对象对它所在的页面有什么了解？

> ID：537230
> 
> 赞同：1
> 
> 时间：2009-02-11T15:08:27.683
> 
> 标签：flash, actionscript, flashvars

我工作的组织创建了一个小型 Flash 小部件，我们鼓励支持者将其放置在他们的网站上。我正在尝试确定是否有办法改进我们从这些嵌入式小部件中获得的统计数据。

大多数情况下，我想获取加载小部件的站点的域。现在我可以在服务器日志中看到引荐来源网址，但这包括完整的 URL，我不想为了提取域而编写自己的日志处理系统。

我对 ActionScript 知之甚少，但我查看了 ActionScript 文档，看看是否能找到明显的解决方案。我还没有找到任何允许对象向浏览器询问页面 URL 的东西。System.Capabilities 类似乎提供了很多关于玩家环境的信息，但没有提供玩家被调用的位置（据我所知，但也许我遗漏了一些东西）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T15:13:21.603

```
Steps:
   1\. Import external interface into your file: import flash.external.ExternalInterface;
   2\. Initialize a variable to store the url path: var urlPath;
   3\. Create a function to call external interface and assign the html page path to your variable: urlPath = ExternalInterface.call(”window.location.href.toString”);
   4\. Call the function when/if needed. 
```

例子：

使用 javascript：window.location.href 或 window.location.href.toString(); 使用动作脚本：ExternalInterface.call(”window.location.href.toString”); 外部接口 html 示例

来源： http: [//blog.circlecube.com/2008/01/02/get-current-url-to-flash-swf-using-an-external-interface-call/](http://blog.circlecube.com/2008/01/02/get-current-url-to-flash-swf-using-an-external-interface-call/)

要获取查询字符串，请参阅这篇文章： http: [//blog.circlecube.com/2008/03/20/get-current-url-and-query-string-parameters-to-flash-tutorial/](http://blog.circlecube.com/2008/03/20/get-current-url-and-query-string-parameters-to-flash-tutorial/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:50:23.587

是的，您可以获取引荐来源网址（或 DOM 中的任何其他内容）。编写小的 javascript 片段来获取这些信息，并使用 ExternalInterface 将这些片段注入到 javascript 页面中。然后您可以执行 ExternalInterface.call("eval", "myfunction") 并让这些 javascript 方法将数据返回到闪存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:17:38.957

[MochiBot](http://www.mochibot.com/my/dashboard.html)是一项可以做到这一点的服务，您可以使用他们的服务（它是免费的），也可以查看他们使用的代码（这是一个大约 40 行的类）。这一切都可以从他们的网站上获得。

快速浏览一下他们的代码就会发现，他们发送的大部分内容是这两个：

```
Security.sandboxType;
Capabilities.version; 
```

# sql - 你如何处理 char(1) 代替布尔和三态字段？

> ID：537231
> 
> 赞同：2
> 
> 时间：2009-02-11T15:08:34.470
> 
> 标签：sql, sql-server, database-design, types

与我关于整数而不是小数的问题有些相关；我的供应商以 char(1) 格式（即 Y/N）提供了很多“布尔”字段。其中一些字段合法地不能是布尔值，因为它们可以有多个值，但大多数可以被视为布尔值。在我之前的问题中，建议是做“正确”的事情，而不是供应商提供的事情；我应该仍然应用此逻辑并使用这些列的位字段创建我的数据库模式，还是将其保留为 char(1) 并在我的代码中进行转换？

同样在这个主题上，就代码而言，我应该如何处理三态字段？从逻辑上讲，该字段是一个布尔值（从某种意义上说，我只对 Y/N 值感兴趣，而第三个值实际上是是或否），但这些值可以不仅仅是真/假（例如，有一个`UpsShippable`可以是`Y`,`N`或`G`) 的字段；该字段有多个状态，那么我将如何最好地封装它？像枚举（或静态常量，因为枚举不能与 char 数据类型一起使用）之类的东西？在多值情况下，数据更像是类型指示符而不是标志。

总结一下（我有点啰嗦）：1）在处理`char(1)`数据中的值时，您会将它们保留为字符还是转换为位（或任何您的数据库的布尔类型）以及为什么，以及 2）您将如何处理代码中的三态 char 字段，假设您将其保留`char(1)`在数据模式中？

**编辑：**澄清一下，这些字段都没有用于“真实”逻辑，它基本上只是一个指标。例如，如果该物品不能通过 UPS 运送（即价值为 N/G），那么在面向客户的页面上，它会说该物品不能通过 UPS 运送，并且在后端逻辑不会调用 UPS 的网络服务来计算运费。其他 Y/N 字段只是作为有关项目的额外详细信息存在并且没有逻辑，尽管它们需要是可更改的（例如，有一个复选框来指示它是否在后端的数据输入表单上被回收）；我可能会显示图像或按它们过滤项目（例如，您可以搜索所有回收产品，我会检查以确保它们的回收指标是真实的）但没有别的，至少目前不是。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T15:15:14.780

我最常处理的 Oracle 并没有真正的位类型，所以它从来都不是问题。

话虽如此，一个字符代码字段很常见且很好。不管你做什么，不要给他们一个误导性的名字，暗示它是一个布尔类型，如果它有 3 个状态。那只会让人们感到困惑。

错误名称：SHIP_FLAG（'flag' 不明确，但许多人会将其解释为 Y/N 或 T/F）
错误名称：HAS_BOOKED（再次表示布尔值）
错误名称：IS_SENT（同上）
正确名称：SHIP_CODE（这可能意味着任何东西你想要它的意思）

此外，一个字符字段允许您稍后扩展含义。位域没有（真的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T15:14:02.880

我建议在双态字段中，您始终进行布尔转换。

三态领域是不同的......有很多解决方案，没有一个绝对“正确”。您可以为选项集创建表，并按索引链接......但是除了“正确”之外，您会失去人类的可读性而几乎没有收获。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T15:15:56.200

1 :) 取决于 char(1) 是否只是 Y/NT/F 类型字段，那么是的，我会将其转换为位，因为它是布尔值，我将在边缘转换为供应商特定格式系统（假设您有多个供应商，例如 FedEx 和 UPS，您可能能够概括您的后端系统来处理两个托运人，然后插入特定组件以与您的模型和他们的模型进行通信）。

2 :) 如果有多个状态，那么这不再是布尔值，我会将其存储为有意义的格式，一些选项是将其存储为 char 字段，或者您可以创建一个查找表，以便为 UpsShippable有是、否或接地。好吧，查找表允许您存储有关 G 含义的更具描述性的信息。如果我会在代码中使用枚举，很大程度上取决于该字段的用途和您的项目是什么。如果您要针对该字段运行逻辑，那么我可能会考虑使用与查找表完美搭配的枚举，如果您只是存储和传递数据，那么也许我不会。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T21:13:14.853

我决定继续将简单的 Y/N 字段实现为真正的位字段，但我仍然不确定应该如何处理多状态字符字段。

我需要将它们用作标志来指示是否应采取其他行动；例如，除非`ShippingStatusCode`是，否则该`Y`项目被视为**不可**UPS 运送，并且应用与可运送不同的一组逻辑。逻辑的范围可以从不显示某些选项到用完全不同的项目实际替换已输入表单的项目，或者如果查找表明没有等效项目则将其完全删除。

一个问题下来..一个去。处理多态领域的想法？我必须将它们保留为 char 字段，尽管我认为我会谨慎行事并使用 char(3) 而不是 char(1) 以防万一需求在某个时候发生变化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T21:34:01.450

不久前我遇到了类似的情况。我正在针对我无法控制的数据库构建一个应用程序，该数据库使用 char(1) Y/N 字段作为布尔值。我还使用 SubSonic ORM 框架来构建我的数据访问层。我所做的是在类上创建另一个属性，以便表格与 char(1) 字段相互转换。

```
 public string SomeYNField { ... } // property generated by ORM tool

    // property added manually (in a partial class, so 
    // it doesnt get blown away by the ORM tool)
    public bool SomeYNFieldBool
    {

        get 
        { 
            // Anything other than a "Y" is false.
            return SomeYNField.Equals("Y", StringComparison.InvariantCultureIgnoreCase); 
        }
        set 
        {
            SomeYNField = value ? "Y" : "N"; 
        }
    } 
```

现在您可以使用该布尔字段绑定到复选框和其他需要布尔值的控件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-14T09:20:11.160

您可以创建一个视图，将三态布尔字段转换为 NULLable 位字段。

例如：

```
CASE UpsShippable WHEN 'Y' THEN 1 WHEN 'N' THEN 0 ELSE NULL END 
```

如果将此视图创建为索引视图，则从数据中进行 SELECT 时不会产生任何开销。

# svn - SVN：仅签出/导出目录结构

> ID：537234
> 
> 赞同：35
> 
> 时间：2009-02-11T15:09:22.610
> 
> 标签：svn, directory-structure

有没有办法执行 SVN 检出（或导出），它只会获取**目录结构**；也就是说，没有文件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-11T15:29:48.583

```
svn ls -R {svnrepo} | grep "/$" | xargs -n 1 mkdir -p 
```

出口，而不是结帐。

[更新]

结帐：

```
env REPO={repo} sh -c 'svn ls -R $REPO | grep "/\$" | xargs -n 1 svn co --depth=empty $REPO' 
```

对于任何太大的东西，这将非常缓慢。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-07-23T10:34:12.757

您可以为 checkout 命令指定**--non-recursive**，可能会帮助您获得所需的内容。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T15:24:34.713

[subversion 的 contrib 工具中](http://svn.apache.org/repos/asf/subversion/trunk/contrib/client-side/svn_export_empty_files.py)有一个python 脚本，它使用空文件创建目录结构。有了一点 Python 知识，跳过创建文件应该不难。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T15:16:34.293

SVN 本身无法做到这一点，但如果您只想导出目录结构，请尝试`svn ls -R --xml`获取目录结构的 XML 列表，然后手动重新创建它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-08-08T19:34:17.573

仅签出目录结构的用途是无法排除一个或多个目录被签出的部分解决方法。假设与检出完整源代码相比，检出目录树的成本可以忽略不计。签出版本化目录结构后，我可以使用 Subversion 的更新和[稀疏目录](http://svnbook.red-bean.com/en/1.5/svn.advanced.sparsedirs.html)有选择地选择哪些目录树应该包含文件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-06-24T03:15:24.660

这完美地工作

```
svn ls | xargs svn up -N 
```

然后，如果您想完全检出其中的几个目录，请进入它们并使用

```
svn ls | xargs svn up 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-05-11T08:21:35.020

`svn ls`只是想补充一下，如果您需要在服务器端执行此操作（即不先签出存储库），则相当于`svnlook tree --full-paths`. 我必须创建一个 50GB 存储库的文件夹结构的副本，并使用我在此处找到的提示来执行此操作，而无需创建整个内容的工作副本。

我的代码是：

`svnlook tree /path/to/repo --full-paths | grep "/$" | grep -v "^/$" | xargs -I {} mkdir -p "{}"`

因为`grep -v "^/$"`输出包含一个 / （即文件系统根文件夹），我不想弄乱它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-10-17T15:54:56.247

我的 DotNet (LINQ) 方法：

首先，运行 svn list 命令。并将输出推送到 .xml 文件。

```
"svn.exe" list "https://myserver.com:8443/svn/DotNet/src/v40Base/v40/" --recursive --username %USERNAME% --xml >>myfile.xml 
```

然后针对 .xml 文件运行一些 LINQ 代码。

```
 private static void FindSVNDirectories()
    {

        string fileName = @"C:\temp\myfile.xml";

        XDocument xDoc = XDocument.Load(fileName);

        //XNamespace ns = XNamespace.Get("http://schemas.microsoft.com/developer/msbuild/2003");
        string ns = string.Empty;

        //List of directories
        var list1 = from list in xDoc.Descendants(ns + "list")
                    from item in list.Elements(ns + "entry")
                    where item.Attribute("kind").Value=="dir"
                    select new
                       {
                           mykind = item.Attribute("kind").Value,
                           myname = (item.Element(ns + "name").Value)
                       };

        StringBuilder sb = new StringBuilder();
        foreach (var v in list1)
        {
            sb.Append(v.ToString() + System.Environment.NewLine );
        }

        Console.WriteLine(sb.ToString());

    } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-08-19T14:17:14.887

在 windows 和 TortoiseSVN 上你可以做 Checkout -> checkout depth: only this item。这样您就可以获得单个文件夹/文件。您可以通过这种方式重建您的结构（使用 repobrowser）。有点麻烦，但如果您的目录结构不太复杂，则可行。我更喜欢通过慢速网络检查数千个小文件（几千兆字节）...

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-11-30T15:50:00.820

你可以使用这个脚本来列出 repos 并在目录中创建结构。

**用法：** `perl checkout-structure.pl repos destdir`

repos 不能是你的 repos 的根目录，它也可以是一个目录。

无法创建包含重音字符 (àéîùç...) 的目录，但可以很好地处理空格。对于那些有时间的人，我认为这是一个编码问题。

**结帐结构.pl：**

```
#!perl

my @dirs;
my $repos = shift;
my $dest = shift;

@dirs = grep { /\/$/ && /^[^\.]/ } `svn list -R $repos`;

foreach(@dirs) {
    s/\/$//;
    chomp;
    mkdir("$dest/$_") or warn $!." trying to create $dest/$_";
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-11T15:15:45.107

我看不出有一种方法可以通过简单的查看来做到这一点`svn help co`。我之前从下载的库（即供应商分支）的新版本更新存储库所做的事情是删除不是 .svn 文件夹的所有内容：

```
#!/bin/sh
find ./ -type f | grep -v .svn | xargs rm -f 
```

如果您试图避免首先检查这些文件，这并不是特别有效，但它应该具有相同的结果。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-02-11T15:17:56.227

没有办法做到这一点，实际上想要做这件事有点奇怪，所以现在我很好奇！

这可能不相关，但您可以通过在相关目录上添加 svn:ignore[属性来](http://svnbook.red-bean.com/en/1.1/ch07s02.html)*防止文件被提交。*这对于防止生成的工件（例如文档或缓存文件）被提交特别有用。

# visual-studio - 如何在visual web developer 2008中创建和运行.asp扩展文件

> ID：537238
> 
> 赞同：0
> 
> 时间：2009-02-11T15:10:31.267
> 
> 标签：visual-studio, asp-classic

我想知道是否可以在 Microsoft Visual Web Developer 2008 中创建和运行 .asp 文件？

问题是在visual web developer 2008中没有提供内置的.asp扩展文件。

如果有人知道如何创建和运行它，请帮助我。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T15:24:43.650

你应该能够创建它们——它们只是文本文件——但我不知道 Intelisense 是否会工作。我不认为内置开发服务器将处理经典 ASP - 您需要在 IIS 下运行页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T15:30:04.310

您必须使用 IIS，并且根据您使用的 IIS 版本，您需要在 IIS 中创建新的 Web 应用程序，并指定一个单独的应用程序池以使其在 .net 或 Classic ASP 中运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T16:03:45.040

.asp 是经典的 ASP 文件扩展名。ASP.NET 使用 .aspx 作为网页的文件扩展名。

它还有一些其他的，例如用于 Web 服务的 .asmx。

# c - C中的默认构造函数

> ID：537244
> 
> 赞同：30
> 
> 时间：2009-02-11T15:11:20.953
> 
> 标签：c, constructor

有没有办法为使用结构定义的 C 用户类型提供某种默认构造函数（如 C++ 构造函数）？

我已经有一个宏，它的工作原理类似于快速初始化程序（例如 for `pthread_mutex`），但我想知道您是否可以在声明时填充结构的某些（或全部）字段。

例如，在这个`pthread_mutex`例子中，我想

```
pthread_mutex_t my_mutex; 
```

具有相同的效果

```
pthread_mutex_t my_mutex = PTHREAD_MUTEX_INITIALIZER; 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-02-11T15:15:43.237

您可以创建带有指向结构的指针的初始化函数。这是常见的做法。

还有创建结构并初始化它的函数（如工厂） - 因此在“客户端”代码中永远不会出现结构“未初始化”的情况。当然 - 假设人们遵循约定并使用“构造函数”/工厂......

在 malloc 或 free 上没有错误检查的可怕伪代码

```
somestruct* somestruct_factory(/* per haps some initializer agrs? */)
{
  malloc some stuff
  fill in some stuff
  return pointer to malloced stuff
}

void somestruct_destructor(somestruct*)
{
  do cleanup stuff and also free pointer
  free(somestruct);
} 
```

有人可能会过来解释一些早期的 C++ 预处理器/编译器是如何在 C 中完成这一切的。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-11T15:36:18.567

在这种情况下，C++ 与 C 的不同之处在于它没有“类”。但是，C（与许多其他语言一样）仍然可以用于面向对象的编程。在这种情况下，您的构造函数可以是初始化结构的函数。这与构造函数相同（只是语法不同）。另一个区别是您必须使用 malloc() （或某些变体）分配对象。在 C++ 中，您可以简单地使用“新”运算符。

例如 C++ 代码：

```
class A {
  public:
    A() { a = 0; }
    int a;
};

int main() 
{
  A b;
  A *c = new A;
  return 0;
} 
```

等效的 C 代码：

```
struct A {
  int a;
};

void init_A_types(struct A* t)
{
   t->a = 0;
}

int main()
{
   struct A b;
   struct A *c = malloc(sizeof(struct A));
   init_A_types(&b);
   init_A_types(c);
   return 0;
} 
```

函数“init_A_types”在 C++ 中作为构造函数起作用。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-11T15:45:32.227

让我们谈谈过去被认为是最佳实践的完整工程解决方案。

结构的问题在于一切都是公开的，因此没有数据隐藏。

我们可以解决这个问题。

您创建两个头文件。一个是代码的客户端使用的“公共”头文件。它包含如下定义：

```
typedef struct t_ProcessStruct *t_ProcessHandle;

extern t_ProcessHandle NewProcess();
extern void DisposeProcess(t_ProcessHandle handle);

typedef struct t_PermissionsStruct *t_PermissionsHandle;

extern t_PermissionsHandle NewPermissions();
extern void DisposePermissions(t_PermissionsHandle handle);

extern void SetProcessPermissions(t_ProcessHandle proc, t_PermissionsHandle perm); 
```

然后创建一个包含如下定义的私有头文件：

```
typedef void (*fDisposeFunction)(void *memoryBlock);

typedef struct {
    fDisposeFunction _dispose;
} t_DisposableStruct;

typedef struct {
    t_DisposableStruct_disposer; /* must be first */
    PID _pid;
    /* etc */
} t_ProcessStruct;

typedef struct {
    t_DisposableStruct_disposer; /* must be first */
    PERM_FLAGS _flags;
    /* etc */
} t_PermissionsStruct; 
```

然后在您的实现中，您可以执行以下操作：

```
static void DisposeMallocBlock(void *process) { if (process) free(process); }

static void *NewMallocedDisposer(size_t size)
{
    assert(size > sizeof(t_DisposableStruct);
    t_DisposableStruct *disp = (t_DisposableStruct *)malloc(size);
    if (disp) {
       disp->_dispose = DisposeMallocBlock;
    }
    return disp;
}

static void DisposeUsingDisposer(t_DisposableStruct *ds)
{
    assert(ds);
    ds->_dispose(ds);
}

t_ProcessHandle NewProcess()
{
    t_ProcessHandle proc =  (t_ProcessHandle)NewMallocedDisposer(sizeof(t_ProcessStruct));
    if (proc) {
        proc->PID = NextPID(); /* etc */
    }
    return proc;
}

void DisposeProcess(t_ProcessHandle proc)
{
    DisposeUsingDisposer(&(proc->_disposer));
} 
```

发生的情况是您在公共头文件中为您的结构进行了前向声明。现在您的结构是不透明的，这意味着客户无法使用它们。然后，在完整的声明中，您可以在每个可以通用调用的结构的开头包含一个析构函数。您可以为每个人使用相同的 malloc 分配器，使用相同的 dispose 函数等等。您为要公开的元素创建公共 set/get 函数。

突然间，您的代码更加清晰。您只能从分配器或调用分配器的函数中获取结构，这意味着您可能会遇到初始化瓶颈。您构建析构函数以便可以销毁对象。随你去。顺便说一句，比 t_DisposableStruct 更好的名称可能是 t_vTableStruct，因为它就是这样。您现在可以通过拥有一个全是函数指针的 vTableStruct 来构建虚拟继承。您还可以执行纯 oo 语言（通常）无法执行的操作，例如动态更改 vtable 的选择元素。

重要的一点是，有*一种*使结构安全和可初始化的工程模式。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-11T15:14:37.327

不，不是直接的。您可以做的最接近的方法是编写一个分配实例并填充一些字段的函数。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-11T15:15:20.693

您可以编写一个返回 C 结构的函数：

```
struct file create_file(int i, float f) {
    struct file obj = { i, f };
    // other code here...
    return obj;
} 
```

如果你想知道你是否可以在 C 中拥有“正常”的成员函数。好吧，在某种程度上你可以。我更喜欢 object-as-first-argument 风格。您将指向结构的指针作为第一个参数传递。这样，您可以拥有多个函数，定义对象的接口：

```
int file_get_integer(struct file *self) { return self->i; }
float file_get_float(struct file *self) { return self->f; } 
```

如果您以这种风格编写，那么您最终拥有的是抽象数据类型。我已经看到有人通过将函数指针放入他们的结构然后执行以下操作来模拟 C++ 中使用的成员函数调用语法：

```
obj.get_integer(&obj); 
```

linux内核使用它来定义文件系统驱动程序的接口。这是一种人们可能喜欢或不喜欢的写作风格。我不太喜欢它，因为我一直将结构成员用于数据，而不是模拟成员函数调用，使其看起来像流行的面向对象语言。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-11T15:31:41.700

基本上，C++ 创建包含方法地址的指针列表。这个列表称为类定义（类定义中还有一些数据，但我们暂时忽略它）。

在纯 C 中拥有“类”的常见模式是定义一个“结构类”。结构的字段之一是返回类的“实例”的工厂函数。我建议使用宏来隐藏演员表：

```
typedef struct __class * class;
typedef void (*ctor_ptr)(class);
struct class {
    char * name;
    ctor_ptr ctor;
    ... destructor and other stuff ...
}

#define NEW(clz) ((struct something *)(((struct class *)clz)->ctor(clz))) 
```

现在，您可以通过为您拥有的每个类创建类型为“struct class”的结构来定义您拥有的类，然后调用存储在其中的构造函数。析构函数等也是如此。

如果您想要实例的方法，必须将它们放入类结构中并在实例结构中保留指向该类的指针：

```
#define NEW_SOMETHING() ((struct something *)NEW(&something_definition))
#define METHOD(inst, arg) ((struct something_class *)(((struct something *)inst)->clz)->method(inst, arg)) 
```

`NEW_SOMETHING`将使用存储在结构中的类定义创建“某物”的新实例`something_definition`。METHOD 将在此实例上调用“方法”。请注意，对于实际代码，您将需要检查它`inst`实际上是一个实例`something`（比较类指针，类似的东西）。

继承有点棘手，留给读者作为练习。

请注意，您可以在纯 C 中执行 C++ 中可以执行的所有操作。C++ 编译器不会神奇地用其他东西替换您的 CPU。只需要更多的代码来完成它。

如果您想查看示例，请查看[glib](http://www.gtk.org/)（Gtk+ 项目的一部分）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-11T15:19:51.073

假设您想在 C 中执行此操作，那么您的问题与 C++ 中的结构无关：

我通常做的是创建一个函数 init_whatever，它接受一个指向结构（或其他变量）的指针，并将其设置为我想要的值。

如果它是一个全局变量（初始化为零），您*可以*通过在其中添加一个“已初始化”标志来模拟一个无参数的构造函数，然后让您的其他函数检查该标志，并在标志的情况下初始化结构为零。不过，我完全不确定这是一个好主意。

而且，正如其他人所说，你也可以用宏做一些可怕的事情......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-11T15:56:21.047

这里有一些宏魔术`malloc()`，`memcpy()`以及 C99 复合文字：

```
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

#define new(TYPE, ...) memdup(&(TYPE){ __VA_ARGS__ }, sizeof(TYPE))

void * memdup(const void * obj, size_t size)
{
    void * copy = malloc(size);
    return copy ? memcpy(copy, obj, size) : NULL;
}

struct point
{
    int x;
    int y;
};

int main()
{
    int * i = new(int, 1);
    struct point * p = new(struct point, 2, 3);

    printf("%i %i %i", *i, p->x, p->y);

    return 0;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-11T15:58:30.887

已经提到使用函数来创建和处置结构。但是在评论中你提到你想要一个“默认构造函数” - 我认为你的意思是你想将一些（全部？）结构字段初始化为默认值。

这是在 C 中使用一些编码约定完成的——函数、宏或混合。我通常会这样做 -

```
struct some_struct {
    int a;
    float b;
};
#define some_struct_DEFAULT { 0, 0.0f}
struct some_struct *some_struct_create(void) {
    struct some_struct *ptr = malloc(sizeof some_struct);
    if(!ptr)
        return ptr;

    *ptr = some_struct_DEFAULT;
    return ptr;
}
// (...)
struct some_struct on_stack = some_struct_DEFAULT;
struct some_struct *on_heap = some_struct_create(); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-02-17T07:31:45.723

以下是一个使用构造函数的简单程序。函数“default_constructor”在 main 内部被调用，没有任何显式的函数调用。

```
#include        <stdio.h> 

void __attribute__ ((constructor)) default_constructor() 
{ 
    printf("%s\n", __FUNCTION__); 
} 

int main() 
{ 
    printf("%s\n",__FUNCTION__);
    return 0; 
} 
```

输出：default_constructor main

在构造函数中，您可以包含一些初始化语句并使用析构函数释放内存，如下所示，

```
#include    <stdio.h> 
#include    <stdlib.h>

struct somestruct
{
    int     empid;
    char *  name;
};

struct somestruct * str1;

void __attribute__ ((constructor)) a_constructor() 
{ 
    str1 = (struct somestruct *) malloc (sizeof(struct somestruct));
    str1 -> empid = 30228;
    str1 -> name = "Nandan";
} 

void __attribute__ ((destructor)) a_destructor()
{
    free(str1);
}

int main() 
{ 
    printf("ID = %d\nName = %s\n", str1 -> empid, str1 -> name);
    return 0;
} 
```

希望这会帮助你。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-11T15:18:25.257

并不真地。如果我没记错的话，你最接近类的是结构。您分配内存并填充字段。我不明白您将如何为此制作通用构造函数类型的东西。从理论上讲，您可以编写一个宏来执行其中的一些操作。不确定这是否真的值得。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-11T15:43:17.723

您可能想看看 C++ 编译器。它以一种更优雅和标准的方式为您提供了比您在具有类 C 语法的语言中记住的更多的面向对象功能，而不是尝试将构造函数等与库和宏连接到 C 上。

如果这对您不起作用，请查看 GObject。[http://en.wikipedia.org/wiki/GObject](http://en.wikipedia.org/wiki/GObject)。它是用于 GTK 和 Gnome 的 C 对象系统，几乎可以将“C 中的对象”提升到 11。

来自维基百科：

> GLib 对象系统或 GObject 是一个免费软件库（由 LGPL 涵盖），它提供可移植的对象系统和透明的跨语言互操作性。

系统支持构造函数、析构函数、单继承、接口、虚拟公私方法等。它也比在 C++ 中做同样的事情更加乏味和困难。玩得开心！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-11T15:17:09.347

不，结构只是一堆数据。您不能在结构中声明函数，因此无法为其创建构造函数。

# build-process - Makefile 生成器：premake vs bakefile？

> ID：537247
> 
> 赞同：11
> 
> 时间：2009-02-11T15:12:47.063
> 
> 标签：build-process, makefile, bakefile, premake

对于我的 C++ 构建过程，我正在使用[Bakefile](http://www.bakefile.org/index.html)，这是一个不错的小 Makefile 生成器，它允许您在 XML 中指定构建目标，并且可以从中生成各种 Makefile 或项目文件。它工作正常，我用它来生成 GNU autotools 脚本。

现在我听说了[Premake](http://premake.sourceforge.net/)，它似乎具有类似的功能。您在[Lua](http://www.lua.org/)中指定目标，它会相应地生成 Makefile。

有谁知道 Bakefile 和 Premake 之间的区别？有没有人有这两种经验？Premake 似乎更新更近，发展更积极？

XML 解析器[ticpp](http://code.google.com/p/ticpp/source/browse/trunk/build_instructions.txt)使用 Premake，但它要求您在构建 ticpp 之前下载 premake。难道他们不能为各种系统预先生成 Makefile，这样您就不必先下载和安装 premake？

**注意：**我知道关于什么是最好的构建工具有各种 SO 线程，通常答案是[CMake](http://www.cmake.org/)、[SCons](http://www.scons.org/)或[Jam](http://www.perforce.com/jam/jam.html)。但是，我对我的用户在构建我的项目之前不必下载的东西感兴趣。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-01-08T06:28:50.290

不完全是答案，但我全心全意地推荐[premake4](http://industriousone.com/premake)，这太棒了。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-23T20:52:29.940

是的，Premake 确实允许您生成一个 Makefile（或 Visual Studio 解决方案，或...），然后您可以根据需要进行分发。Premake 本身在其源包中包含预先生成的 makefile。

在目标机器上下载和运行 Premake 允许自定义生成文件，或者通过系统的自动分析，或者通过命令行标志手动进行。对于一些值得权衡的项目，但这不是必需的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-02-11T19:46:37.200

在使用 Premake 4 和[新版本的](http://bakefile.org/)Bakefile 之后，它们似乎针对不同的用例。

*   Bakefile 面向您的需求：在本地生成构建文件，然后与它们一起分发您的项目。我对这个工具有很好的经验。
*   Premake 更像 CMake：本地 makefile 生成。有时，你有很多花哨的配置需要在目标机器上运行。Bakefile 允许您使用插件来完成此操作，但它会很快变得混乱。但是，您*可以*预先生成文件。

对于您的使用，我推荐 Bakefile。听起来你不需要任何花哨的东西。

# .htaccess - htaccess 重定向除文件/目录以外的所有内容

> ID：537248
> 
> 赞同：1
> 
> 时间：2009-02-11T15:12:49.920
> 
> 标签：.htaccess, mod-rewrite, redirect, litespeed

我正在尝试创建一个完成两件事的重写规则：

1.  重定向`(www.)?domain.com`到`log.domain.com`
2.  让 domain.com 上的任何其他目录或文件请求通过而无需重定向

这不是 Apache 服务器（它是 LiteSpeed），但据说它`.htaccess`完全支持文件。

这是我对规则的看法：

```
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{HTTP_HOST} ^(www\.)?domain\.com$
RewriteRule .* http://log.domain.com/ 
```

发生的情况是，如果我请求特定文件（如 dir/index.php），它会被允许通过，但目录请求仍会重定向到 log.domain.com。我认为`$`第二个 RewriteCond 会阻止这种情况发生，但事实并非如此。

编辑：仅出于存档目的，我的意图不是将任何不存在的目录/文件重定向到 log.domain.com，因为用户永远不必这样做。这使得规则的标准变得更加简单，混乱和秋葵都在下面给出了他们的第一条规则。再次感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T15:17:50.423

```
RewriteCond %{HTTP_HOST} ^(www\.)?domain\.com$
RewriteRule ^$ http://log.domain.com/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T16:06:43.673

试试这个：

```
# skip the next rule if host is not example.com or www.example.com
RewriteCond %{HTTP_HOST} !^(www\.)?example\.com$
RewriteRule ^ - [S]

# redirect if requested URI does not match a regular file or directory
# or if the requested URI path is just "/"
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d [OR]
RewriteCond %{REQUEST_URI} =/
RewriteRule ^ http://log.example.com/ 
```

# sql - SQL 选择约定

> ID：537258
> 
> 赞同：1
> 
> 时间：2009-02-11T15:14:25.610
> 
> 标签：sql

我们遇到了以下“问题”。我喜欢使用以下文字：

```
SELECT  Id, Name
FROM    Table1
JOIN    Table2 ON Table1.FK1 = Table2.FK1 
```

但我的一位同事使用：

```
SELECT  Id, Name
FROM    Table1 JOIN Table2 
ON      Table1.FK1 = Table2.FK1 
```

对此有最佳做法吗？我认为如果所有使用过的表都对齐会更方便。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-11T15:16:16.930

我更喜欢第一个

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-11T15:18:41.527

我们实际上会这样做：

```
SELECT Id, Name
    FROM Table1
    JOIN Table2 
        ON Table2.FK1 = Table2.FK1 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T15:27:13.427

我工作的公司有一个使用对象模型生成 sql 的应用程序。它在大多数情况下使用第二种语法生成它。如此多的连接，然后是 on 条件。当您有很多桌子时，尝试破译哪个条件适用于哪个桌子是非常令人沮丧的。

所以我更喜欢将 ON 子句与我要加入的表放在一起。它使您可以更轻松地判断您对表使用了哪些连接子句以及哪些条件子句是连接语句的一部分。让你的加入正确是成功的一半。我也更喜欢括号。

```
SELECT primarytable.whatever
FROM primarytable
     INNER JOIN secondarytable ON (primarytable.primarykey = secondarytable.foreignkey)
     INNER JOIN othertable ON (primarytable.foreignkey = othertable.primarykey AND othertable.somefield = 1)
     LEFT OUTER JOIN outertable ON (secondarytable.foreignkey = outertable.primarykey)
WHERE primarytable.somefield IS NOT NULL 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T15:45:34.693

我使用类似于[John Price](https://stackoverflow.com/questions/537258/sql-select-convention/537284#537284)风格的东西：

```
with Foo as (
    select Id, Name
        from Table1
           join Table2 on 
               Table2.FK = Table1.PK and
               Table2.Foo = Table1.Bar
           join Table3 on 
               Table3.FK = Table1.PK and
               Table3.Foo = Table1.Bar
        where
            Table1.Foo > 1 and
            Table1.Bar < 100
),
Bar as (
    ...
)
select * from Bar; 
```

一些评论：

*   逻辑块的正确缩进：*join*在*from*内部， the *from*在*select内部**   ***on*挂在行尾以获得正确的 K&R 样式。*带*括号的也是如此。

    并且** *   **给定代码着色，我更喜欢小写关键字而不是 UPPER CASE EVERYWHERE。** *** * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T15:33:17.187

```
SELECT  Id, Name
FROM Table1
    JOIN Table2 ON Table2.FK1 = Table2.FK1 
```

我更喜欢这个。还有啤酒。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T15:41:13.237

我的风格：

```
select c.Id, c.Name
from Parent p
join Child c on c.ParentID = p.Id
where p.Id = 123 
```

*   如果有一个很长的选择列表，我倾向于将选择的每一列写在自己的行上，或者我会将一个表中的所有列写在一行上，将另一个表中的所有列写在另一行上。

*   如果`on`or中有很长的条件列表`where`，我倾向于将每个条件写在自己的行上。

真正的WTF：

*   你没有给你的表起别名。
*   您正在全部大写 SQL。我无法阅读它。
*   您没有使用带有基本语法突出显示的编辑器，因此迫使您依靠对齐来判断哪些单词是什么意思。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T15:19:48.670

我喜欢这两个中的第一个。然而，我们的格式有更多的空格，我们确保使用括号。

```
SELECT
  x.Id
, MAX(y.Sales)
FROM
  [dbo].[Table1] x
INNER JOIN
  [dbo].[Table2] y ON Table1.Id = Table2.Id
WHERE
  x.Id = 100
AND
  x.Name = 'Foo'
GROUP BY
  x.Id
HAVING
  COUNT(*) > 1 
```

开发人员一开始通常很难使用它（请不要投反对票！:)），但格式往往会在大多数人身上增长，并且可见性有很大帮助。每个重要的条款都清晰可见。

编辑：根据Justice的回答，给表起别名。我这样做是为了，只是忘记了这个答案。至于所有大写字母，这是我没有很好的 SQL 突出显示的日子以来的习惯。这是可选的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T15:20:39.027

我更喜欢第一个，但我发现很多代码格式化程序会自动格式化为第二个。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-11T15:22:06.980

我更喜欢第一个版本，但在 JOIN 子句上有一些缩进，以表明它是 FROM 子句的一部分。

我发现这篇[文章](http://www.devguru.com/technologies/sqlsyntax/quickref/sql_syntax_intro.html)提供了一些非常好的指导方针。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-11T15:28:27.823

我更喜欢第一个 - 它让我可以在必要时轻松注释掉连接的表。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-11T17:33:20.613

我总是这样做：

```
 SELECT t1.ID, t1.Name
       FROM Table1 t1
 INNER JOIN Table1 t2 ON t1.FK1 = t2.FK1
      WHERE t1.Name = 'Bob' 
```

我发现 SQL 命令的右对齐使其更易于阅读。当然，如果您不在代码编辑器中使用等宽字体，那么这将根本无法正常工作。

不过，我不能说我知道任何“最佳实践”。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-13T00:38:30.890

```
select
  Dept.COL1 as "Deptment Name"
, Emp.COL1 as "Employee Name"

from
Table1 Dept
inner join Table2 Emp on Emp.FK1 = Dept.Id

where
    Dept.COL2 = "something"
and Emp.COL2 = "another" 
```

这是我在开发查询以提取数据时使用的样式。您可以删除 select 和 where 子句中的任何项目，只需将它们注释掉（第一个项目除外）。这对于调试非常方便。

如果您希望它们看起来漂亮且易于识别，那么将 select 中的“as”和 where 子句中的“=”对齐肯定会有所帮助。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-13T00:47:37.123

```
select
    a.Id,
    b.field2,
    b.field3
from
    table1 a
join
    table2 b
        on a.Id = b.a_id
where
    a.field1 = 'hello'
and b.field2 = 'there' 
```

使用四个空格作为制表符，允许“和”在 where 子句中排列。

# asp.net - 请推荐一个好的 ASP.NET 调试日志框架和一个好的查看器

> ID：537274
> 
> 赞同：0
> 
> 时间：2009-02-11T15:16:44.573
> 
> 标签：asp.net, logging, frameworks, stress-testing

首先 - 我见过[这个问题](https://stackoverflow.com/questions/98080/what-is-the-best-logging-solution-for-a-c-net-3-5-project)，但我的有点不同。

我需要的是一些记录调试信息的框架。此信息不会出现在生产环境中。它将用于跟踪性能问题和其他一般错误。尤其是对于性能问题，所以会和负载测试一起大量使用。

因此，我希望日志将包含大量消息，并且手动通过它们来查找慢速消息不是一种选择。

起初我想使用 ASP.NET 的内置 Trace 工具。他们甚至有这个很棒的[工具](http://msdn.microsoft.com/en-us/library/aa751795.aspx)，非常适合我的需求。不幸的是，似乎 ASP.NET 跟踪存在[根本缺陷](https://stackoverflow.com/questions/536596/asp-net-and-system-diagnostics-tracing-have-i-missed-something-or-is-this-a-ba)，无法依赖，尤其是在重负载下。:(

所以现在我需要别的东西，它应该带有一个好的分析工具。你有什么可以推荐的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T18:01:42.773

我也推荐 Log4net。您可以将其配置为将消息输出到日志文件、数据库等。如果您正在寻找一个好的查看器，您可以设置 UdpAppender，然后使用像[Chainsaw](http://logging.apache.org/chainsaw/index.html)这样的工具来读取日志消息。虽然它是基于 Java 的，所以如果你真的想避免它，你也可以试试[Log4net Viewer](http://www.devintelligence.com/Log4NetViewer/)。

有关如何设置的更多信息和详细信息，请查看[Using Chainsaw with Log4net](http://geekswithblogs.net/kobush/archive/2005/07/15/46627.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T15:47:52.643

Log4Net 是 FOSS 项目中使用的常用日志框架。

其他好的工具正在使用企业库日志记录和全局异常处理（即使在生产环境中也很有用。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T15:33:50.493

Visual Studio 测试版附带了很多您正在谈论的内容。您还可以考虑使用 RedGate 的 ANTS 来分析性能瓶颈。

如果价格是一个障碍，您可能会想要使用[log4net](http://logging.apache.org/log4net/)。

log4net 有几个[解析器](http://log4net-dashboard.faktnet-as.qarchive.org/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T15:49:55.197

我也推荐 log4Net，您可以将其配置为使用多种输出类型，因此您可以准确配置您希望如何创建日志。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T19:26:36.767

You might want to take a look at our logging tool [SmartInspect](http://www.gurock.com/products/smartinspect/), as it comes with a quite powerful log viewer with filtering capabilities among other things. It also includes example projects for ASP.NET.

# sas - SAS：从另一个调用一个宏...宏定义的顺序

> ID：537283
> 
> 赞同：6
> 
> 时间：2009-02-11T15:18:36.567
> 
> 标签：sas, sas-macro

在我的代码中，我有几个宏。宏 A 是主宏。然后宏 A 调用宏 B，宏 B 又调用宏 C。

在 SAS 中，我是否必须按倒序定义它们？换句话说，我是否必须先定义宏 C，然后定义宏 B，最后定义宏 A？还是因为 SAS 在实际执行运行宏的命令之前读取了所有代码，这是否重要？就此而言，我可以发出命令将宏作为代码中的第一条语句运行，然后在命令下方定义宏吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T17:48:46.550

首先，您必须在调用它之前定义一个宏。

其次，只要您事先加载了宏，调用宏的位置并不重要。

详细说明您的问题：自动调用库是您的朋友。如果您的 SAS 管理员不允许您将宏放入自动调用库中，您可以像这样附加自动调用：

```
filename mymacros 'c:\mysas'; 
/*this defines the directory you have stored your macros*/

options sasautos=(sasautos mymacros) mautosource; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T17:48:20.330

宏必须在调用之前定义。出于性能原因，最好不要在另一个宏中定义一个宏——如果这样做，那么每次调用外部宏时都会重新定义它。以下工作正常：

```
%macro a;
  %put a;
  %b
%mend a;

%macro b;
  %put b;
  %c
%mend b;

%macro c;
  %put c;
%mend c;

%*-- %a is main --*;
%a
/* on log
a
b
c
*/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T16:16:17.707

您必须在调用之前定义一个宏，因此带有“%A”的行需要遵循宏 A 的定义。其他宏定义的顺序无关紧要，只要它们在调用之前定义即可。通常，在我的程序中，我会像您描述的那样设置一个主宏，然后程序的最后一行调用这个宏。

另一个需要考虑的选项是设置一个宏自动调用库，其中包含许多宏的定义。这对可重用宏最有效，因此您不必在每个程序中重新定义它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-26T13:21:47.100

SAS中的宏代码有两个方面需要定义：被编译的宏代码和宏参数：

**宏代码：**

宏代码本身非常简单，当`%macro`遇到令牌时，SAS 系统开始编译 SAS 宏并继续编译，直到遇到`%mend`令牌。您可能遇到的唯一真正问题是，如果您更新了宏代码并且在执行之前没有重新编译它——在这些情况下，它仍然会运行它在宏库中的旧版本。通过扩展，如果您尝试编译一个调用另一个尚未定义的宏的宏，那么您将收到一个错误。由于这些原因，它们需要按照调用顺序进行编程（如下例所示：%level3 在 %level2 之前，在 %level1 之前）

**宏变量：** 定义宏*变量*时有两个作用域：全局和局部。定义后，可以随时随地访问全局变量。但是，局部变量仅在执行定义它的宏期间本地存在。通过扩展，如果定义了局部变量的宏调用了任何其他宏，则仍然可以访问局部宏变量：

**工作示例：**

在以下示例中，宏**以相反的顺序定义，**以防止 SAS 返回*明显调用宏*警告。

下图说明了以下示例中以下宏的结构：

```
|-----------------------------|
|GLOBAL                       |
|  |------------------------| |
|  |LEVEL1                  | |
|  |  |-------------------| | |
|  |  |LEVEL2             | | |
|  |  |  |--------------| | | |
|  |  |  |  LEVEL3      | | | |
|  |  |  |--------------| | | |
|  |  |-------------------| | |
|  |------------------------| |
|-----------------------------| 
```

编译嵌套宏：

```
 %macro level3 ;
  %put **** START LEVEL3 **** ;
  %local G1;
  %let G1=Local ;

  %do i=1 %to 2 ;
    %put In the macro do loop I=&i ;
  %end ;

  %put The value of I at level3 is: &I ;
  %put Are we accessing global or local G1 variable here: &G1 ;

  %put **** END LEVEL3 ****;
%mend level3 ;

 %macro level2 ;
  %put **** START LEVEL2 **** ;
  %*global L1 ; *<-- this would produce an error because the variable name has already been added to the local scope in %level1 ;

  %put Are we accessing global or local G1 variable here: &G1 ;
  %put Can we access local variables here: &L1 ;

  %level3 ;

  %put The value of I in level2 is: &I ;
  %put **** END LEVEL2 ****;
%mend level2 ; 
```

编译顶层宏（依次调用上述两个宏）并运行它：

```
%let G1=Global;
%macro level1 ;
  %put **** START LEVEL1 **** ;
  %let L1=Yes;

  %put Are we accessing global or local G1 variable here: &G1 ;
  %put Can we access local variables here: &L1 ;

  %level2 ;

  %put The value of I outside of the local macro is: &I ;
  %put Are we accessing global or local G1 variable here: &G1 ;

  %put **** END LEVEL1 ****;
%mend level1 ;
%level1 ; 
```

查看日志时需要注意的几点：

*   在 %level3 之外，&I 返回宏变量不存在的警告
*   在%level3内，调用&G1时，返回%level3本地范围内存储的值。一旦在%level3之外，则返回全局存储的值

# xslt - Xslt 为特定的导入文件应用导入？

> ID：537285
> 
> 赞同：2
> 
> 时间：2009-02-11T15:18:48.203
> 
> 标签：xslt

有没有办法为特定的导入文件而不是所有导入的文件应用导入？

基本上只想根据评估的某些值对某个导入进行应用导入。

例如在伪中，

**如果 value = "Medical" 然后执行 Medical Imported File 应用 Imports 否则 If value = "Transport" Then Do Transport Imported File apply Imports**

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T17:29:56.877

**对于 XSLT 1.0，答案是否定的**。但是*，您可以使用模式来模拟类似的行为*。

**在[XSLT 2.0](http://www.w3.org/TR/xslt20)[`xsl:use-when`](http://www.w3.org/TR/xslt20/#import)**中，任何 XSLT 指令都可能存在**该****属性**`<xsl:import>`，包括，**但是可以在其中测试的条件受到严格限制**。引用规范：

“XPath 表达式上没有可以用作 use-when 属性值的语法约束。但是，对其评估上下文中提供的信息有严格的约束。这些约束旨在确保表达式可以在样式表处理的尽可能早阶段进行评估，而不依赖于样式表本身或任何源文档中包含的信息”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T18:16:21.163

我认为也许使用 a `mode`on apply-imports 会帮助你吗？但是，如果您想指示来自特定来源的模板，您可以使用模式来执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T13:27:08.913

已解决 - 使用包含和调用模板而不是应用导入，并允许包含文件决定是否处理。

# c# - 父导航属性的 C# 表达式树参数

> ID：537292
> 
> 赞同：1
> 
> 时间：2009-02-11T15:20:40.463
> 
> 标签：c#, entity-framework, lambda, expression-trees

如何为 1 到 * 导航属性的父端创建 ParameterExpression？

以下适用于子实体：

```
var parameter = Expression.Parameter(
    typeof(T), // where T is the entity type
    GetParameterName()); // helper method to get alias 
```

在 TParent 上尝试类似的操作会产生源自上下文的查询，而不是作为子属性的查询。

等效的 lambda 是这样的：

```
var q = from f in context.Foo 
        where f.Bar.BarId == 1...
         // where bar is the Navigation Property to the parent 
```

**为清楚起见进行编辑：**

我使用以下内容从属性创建成员表达式：

```
Expression exp = Expression.Equal(
    Expression.Property(parameter, "SomeColumn"),
    Expression.Constant("SomeValue")); 
```

所以看起来我应该在这种情况下使用 MemberExpression 而不是 ParameterExpression 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T15:27:08.590

我有点困惑......“.Bar”**不是**`ParameterExpression`- 它是`MemberExpression`. `f`是参数。你到底想做什么？

请注意，一种选择是将示例代码加载到反射器中，打开 .NET 3.5 提示，然后阅读它是如何做到的——它看起来像[这里](http://marcgravell.blogspot.com/2008/10/express-yourself.html)的代码，但通常很容易理解。

# java - 内存映射文件的性能/稳定性 - Native 或 MappedByteBuffer - 与普通 ol' FileOutputStream

> ID：537295
> 
> 赞同：11
> 
> 时间：2009-02-11T15:21:08.917
> 
> 标签：java, performance, file-io, java-native-interface, production

我支持使用平面文件（纯文本）进行持久性的遗留 Java 应用程序。由于应用程序的性质，这些文件的大小可以达到每天 100s MB，而应用程序性能的限制因素通常是文件 IO。目前，应用程序使用普通的 java.io.FileOutputStream 将数据写入磁盘。

最近，我们有几位开发人员断言，使用内存映射文件、以本机代码 (C/C++) 实现并通过 JNI 访问，将提供更高的性能。但是，FileOutputStream 已经将本机方法用于其核心方法（即 write(byte[])），因此在没有硬数据或至少没有轶事证据的情况下，这似乎是一个脆弱的假设。

我对此有几个问题：

1.  这个说法真的是真的吗？ 与 Java 的 FileOutputStream 相比，内存映射文件是否**总是提供更快的 IO？**

2.  从 FileChannel 访问的 MappedByteBuffer 类是否提供与通过 JNI 访问的本机内存映射文件库相同的功能？MappedByteBuffer 缺少什么可能导致您使用 JNI 解决方案？

3.  在生产应用程序中使用内存映射文件进行磁盘 IO 有哪些风险？也就是说，具有持续正常运行时间且重启次数最少的应用程序（最多每月一次）。来自生产应用程序（Java 或其他）的真实轶事优先。

问题 #3 很重要——我可以通过编写一个“玩具”应用程序来*部分*回答这个问题，该应用程序使用上述各种选项对 IO 进行性能测试，但是通过发布到 SO，我希望能够了解真实世界的轶事/数据.

[编辑] 澄清 - 每天运行，应用程序创建多个文件，大小范围从 100MB 到 1 gig。总的来说，该应用程序可能每天要写出多个演出数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T16:10:49.717

内存映射 I/O 不会使您的磁盘运行得更快（！）。对于线性访问，它似乎有点毫无意义。

NIO 映射缓冲区是真实的（任何合理实现的通常警告）。

与其他 NIO 直接分配的缓冲区一样，缓冲区不是普通内存，不会被有效地 GC。如果您创建其中许多，您可能会发现内存/地址空间已用完，而 Java 堆却没有用完。对于长时间运行的进程，这显然是一个问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T17:52:20.520

您可以通过检查数据在写入期间的缓冲方式来加快速度。这往往是特定于应用程序的，因为您需要了解预期的数据写入模式。如果数据一致性很重要，那么这里会有权衡。

如果您只是从应用程序将新数据写入磁盘，内存映射 I/O 可能不会有太大帮助。我看不出您有任何理由愿意在一些自定义编码的本机解决方案上投入时间。从您迄今为止提供的内容来看，您的应用程序似乎太复杂了。

如果您确定确实需要更好的 I/O 性能 - 或者在您的情况下只需要 O 性能，我会研究一种硬件解决方案，例如调整磁盘阵列。从业务角度来看，投入更多硬件解决问题通常比花时间优化软件更具成本效益。它通常也更快实施并且更可靠。

一般来说，软件的过度优化存在很多陷阱。您将为您的应用程序引入新类型的问题。您可能会遇到内存问题/GC 抖动，这将导致更多的维护/调整。最糟糕的是，其中许多问题在投入生产之前很难测试。

如果它是我的应用程序，我可能会坚持使用 FileOutputStream 和一些可能调整的缓冲。之后，我会使用久负盛名的解决方案，即投入更多硬件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T15:52:49.153

根据我的经验，内存映射文件在实时和持久性用例中的性能都比普通文件访问好得多。我主要在 Windows 上使用 C++，但 Linux 性能相似，而且您仍然打算使用 JNI，所以我认为它适用于您的问题。

有关基于内存映射文件构建的持久性引擎的示例，请参阅[Metakit](http://www.equi4.com/metakit/)。我在一个应用程序中使用了它，其中对象是内存映射数据的简单视图，引擎负责幕后的所有映射内容。这既快速又节省内存（至少与以前版本使用的传统方法相比），而且我们免费获得了提交/回滚事务。

在另一个项目中，我不得不编写多播网络应用程序。数据以随机顺序发送，以尽量减少连续丢包的影响（结合 FEC 和阻塞方案）。此外，数据很可能超出地址空间（视频文件大于 2Gb），因此内存分配是不可能的。在服务器端，文件部分按需进行内存映射，网络层直接从这些视图中提取数据；因此，内存使用率非常低。在接收端，无法预测接收数据包的顺序，因此它必须在目标文件上维护有限数量的活动视图，并将数据直接复制到这些视图中。当必须将数据包放入未映射的区域时，最旧的视图被取消映射（并最终被系统刷新到文件中）并被目标区域上的新视图替换。性能非常出色，特别是因为系统在将数据作为后台任务提交方面做得很好，并且很容易满足实时约束。

从那时起，我确信即使是最好的精心设计的软件方案也无法击败系统默认的内存映射文件 I/O 策略，因为系统比用户空间应用程序更了解何时以及如何写入数据。另外，重要的是要知道在处理大数据时内存映射是必须的，因为数据永远不会被分配（因此会消耗内存）而是动态映射到地址空间，并由系统的虚拟内存管理器管理，即总是比堆快。因此，系统始终以最佳方式使用内存，并在需要时提交数据，在应用程序的背后而不影响它。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T15:52:01.790

至于第 3 点 - 如果机器崩溃并且有任何页面没有刷新到磁盘，那么它们就会丢失。另一件事是地址空间的浪费——将文件映射到内存会消耗地址空间（并且需要连续的区域），而且在 32 位机器上它有点受限。但是您已经说过大约 100MB - 所以这应该不是问题。还有一件事 - 扩展 mmaped 文件的大小需要一些工作。

顺便说一下，[这个 SO 讨论](https://stackoverflow.com/questions/192527/what-are-the-advantages-of-memory-mapped-files)也可以给你一些见解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T14:38:17.837

如果你写更少的字节，它会更快。如果您通过 gzipoutputstream 过滤它会怎样，或者如果您将数据写入 ZipFiles 或 JarFiles 会怎样？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-21T01:59:13.993

如上所述，使用 NIO（又名新 IO）。还有一个新的、新的 IO 出来了。

正确使用 RAID 硬盘驱动器解决方案会对您有所帮助，但这会很痛苦。

我真的很喜欢压缩数据的想法。去找 gzipoutputstream 老兄！如果 CPU 可以跟上，那将使您的吞吐量翻倍。您很可能可以利用现在标准的双核机器，嗯？

-斯托什

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-02T20:12:34.437

我做了[一项研究](http://mentablog.soliveirajr.com/2012/12/asynchronous-logging-versus-memory-mapped-files/)，将写入性能与原始`ByteBuffer`数据与写入性能与`MappedByteBuffer`. 操作系统支持内存映射文件，并且它们的写入延迟非常好，正如您在我的基准测试数据中看到的那样。通过 FileChannel 执行同步写入大约慢 20 倍，这就是人们一直在做异步日志记录的原因。在我的研究中，我还给出了一个示例，说明如何通过无锁和无垃圾队列实现异步日志记录，以获得非常接近原始`ByteBuffer`.

# java - Java 2D 图形中的“屏幕”效果

> ID：537297
> 
> 赞同：3
> 
> 时间：2009-02-11T15:22:02.440
> 
> 标签：java, graphics, screen, composite, alpha

这是一个困扰我一段时间的问题：

在 Photoshop/GIMP 中，有一个“屏幕”图层合成模式。此模式具有明亮的颜色具有强 alpha，而深色则具有弱的 alpha。黑色是完全透明的，白色是完全不透明的。

我非常希望能够使用 Java 2D 图形复制这种复合材料，但是我反复尝试将 AlphaComposite 引入其中的尝试都失败了——事实上，我认为这超出了 AlphaComposite 的能力范围。

可以在[这里](http://www.zarkonnen.com/screen.jpg)看到一个视觉示例。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T16:36:48.050

看起来这里有一些参考代码：

[http://www.curious-creature.org/2006/09/20/new-blendings-modes-for-java2d/](http://www.curious-creature.org/2006/09/20/new-blendings-modes-for-java2d/)

# linq - 从 IEnumerable 中提取文本

> ID：537300
> 
> 赞同：0
> 
> 时间：2009-02-11T15:22:54.873
> 
> 标签：linq

我有一个`IEnumerable<T>`包含名称、全名和地址的集合。

地址如下所示：

```
Street1=54, Street2=redfer street, Pin=324234
Street1=54, Street2=fdgdgdfg street, Pin=45654
Street1=55, Street2=tryry street, Pin=65464 
```

我想遍历这个集合并只打印那些 Street1=54 的 Names，FullNames

我怎样才能在 LINQ 中做到这一点？

好的，我能够这样做以提取地址的 Street1

```
coll.Address.Split(",".ToCharArray())[0]returns me Street1=54 . 
```

现在我如何将其添加到条件中并仅打印那些 Street1=54 的 Name、FullName

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T15:53:30.430

根据您的更新，您可以通过这种方式调整 Jared Par 的代码：

```
var result = collection.Where(x => x.Address.Contains("Street1=54"));
foreach ( var cur in result ) {
  Console.WriteLine(string.Format("{0}, {1}", cur.Name, cur.FullName));
} 
```

如果您希望能够使用变量插入 Street1 值，请执行以下操作：

```
var street1 = "54";
var result = collection.Where(x => x.Address.Contains("Street1=" + street1 ));
foreach ( var cur in result ) {
  Console.WriteLine(string.Format("{0}, {1}", cur.Name, cur.FullName));
} 
```

顺便说一句，您确实应该更新您的问题或对特定答案添加评论，而不是添加不是的新答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T15:24:17.600

试试这个

```
var result = collection.Where(x => x.Address.Street1==54);
foreach ( var cur in result ) {
  Console.WriteLine(var.Name);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:29:54.060

选择正确的列表：

```
IList<T> matches = myListOfEnumerables.Where(m => m.Street1 == 54).ToList(); 
```

然后循环打印。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T15:40:19.370

实际上记录是这样的：

```
{Name="Jan" FullName="Kathy Jan" Address="Street1=54, Street2=redfer street, Pin=324234"} 
```

我必须遍历这个集合并只打印那些 Street1=54 的 Names、FullNames

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T15:45:02.947

如果更新的信息准确无误，您应该更改存储数据的方式。

看起来您已将地址信息打包成一个字符串。为什么不将其存储为对象。事实上，为什么不在同一个对象中与 Name 和 FullName 一样多的字段呢？（为什么要重复名字信息？）

```
public class Person
{
    public string FirstName, LastName, Street1, Street2, Pin;
}

IEnumerable<Person> persons = GetAllPersonsSomehow();

foreach (Person person in persons.Where(p => p.Street1 == "54"))
    Console.WriteLine(person.LastName + ", " + person.FirstName); 
```

假设您必须将地址信息保存在字符串中，则需要一个解析器。

```
public static IDictionary<string, string> GetAddressFields(string address)
{
    return address.Split(',').ToDictionary(
                s => s.Substring(0, s.IndexOf('=')).Trim(),
                s => s.Substring(s.IndexOf('=') + 1).Trim());
}

foreach (Person person in persons.Where(p => 
                GetAddressFields(p.Address)["Street1"] == "54")) 
    Console.WriteLine(person.LastName + ", " + person.FirstName); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T15:54:27.480

所以，你可以做的是你可以编写一个生成器来解析地址字段，然后枚举它的属性。这在函数式编程世界中是相当普遍的事情。

公平地说，你会希望这段代码是惰性的，因为它只会计算一个最小的集合。我将建议一些来自 BCL 的代码，但您可以（并且可能应该）使用生成器重写相同的辅助方法。

```
public static IEnumerable<KeyValuePair<string,string>> NameValueSplit( this string s )
{
    foreach (var x in s.Split(','))
    {
        var y = x.Split(new char[] { '=' }, 2, StringSplitOptions.None);
        yield return new KeyValuePair<string, string>(y[0].TrimStart(), y[1].TrimEnd());
    }
} 
```

使用该辅助函数，您可以编写这样的代码

```
var result = collection.Where(x => x.Address
    .NameValueSplit().Any(x => x.Key == "Street1" && x.Value == "54"));
foreach ( var item in result ) 
{
    Console.WriteLine(item.Name);
} 
```

现在，如果您正在考虑，此代码将不会在您的 SQL Server 上运行，但您可以编写一个 WHERE 子句，在其中搜索地址字段以查找子字符串 %Street1=54%。我喜欢对字符串操作进行惰性求值，并认为这是 BCL 中缺少的功能。这就是我提出这种解决方案的原因。

# tfs - TFS 分支是物理快照还是逻辑快照？

> ID：537301
> 
> 赞同：13
> 
> 时间：2009-02-11T15:23:09.007
> 
> 标签：tfs, branch

当使用分支方法在 TFS 中对代码进行分支时，代码是物理分支还是逻辑分支？从逻辑上讲，我的意思是它只是一个变更集（更改的增量）还是所有文件都被复制了？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-11T15:32:07.597

分支文件不会在 TFS 数据库中复制。在修改分支版本之前，不会创建文件的新版本。这就是为什么在一个大型项目上创建一个分支不会永远持续下去的原因。

**来源：**

[http://www.codeplex.com/BranchingGuidance/Wiki/View.aspx?title=Isolation%20for%20Collaboration&referringTitle=Home](http://www.codeplex.com/BranchingGuidance/Wiki/View.aspx?title=Isolation%20for%20Collaboration&referringTitle=Home)

分支下的第四段解释说它不会创建相同文件的单独副本：

> 创建分支使用的额外存储空间非常少。无论文件夹中包含多少不同的文件，服务器都只保留一份相同内容的副本，从而最大限度地减少所需的存储空间。因此，如果您有 100 个 1 MB 文件的副本并且所有文件都相同，则服务器将仅存储 1 MB，而不是 100 MB。当您创建新分支并提交时，新分支中与源分支中的文件相同的所有文件都指向相同的内容。结果是分支消耗的额外存储空间非常少，并且仅当分支文件与源文件不同时，存储空间才会扩展。即使文件发生更改，Team Foundation Server 也会使用差异引擎来分析文件之间的更改并再次优化存储空间。

Microsoft 分支指南 PDF：

[http://geeks.netindonesia.net/downloads/etc/TFS-Branching.pdf](http://geeks.netindonesia.net/downloads/etc/TFS-Branching.pdf)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-19T18:10:03.693

简短的回答：分支是逻辑存储的，不是父级的直接副本。

长答案：VS ALM Ranger 的 Bill Heys 写了一篇详细的博客文章，描述了分支和文件历史记录如何存储在 TFS 中。

[http://blogs.msdn.com/b/billheys/archive/2011/05/05/how-tfs-stores-files-and-calculated-deltas-on-versioned-files.aspx](http://blogs.msdn.com/b/billheys/archive/2011/05/05/how-tfs-stores-files-and-calculated-deltas-on-versioned-files.aspx)

# c++ - 二进制字面量？

> ID：537303
> 
> 赞同：60
> 
> 时间：2009-02-11T15:23:44.887
> 
> 标签：c++

在代码中，我有时会看到人们以十六进制格式指定常量，如下所示：

```
const int has_nukes        = 0x0001;
const int has_bio_weapons  = 0x0002;
const int has_chem_weapons = 0x0004;
// ...
int arsenal = has_nukes | has_bio_weapons | has_chem_weapons; // all of them
if(arsenal &= has_bio_weapons){
  std::cout << "BIO!!"
} 
```

但是在这里使用十六进制格式对我来说没有意义。有没有办法直接在二进制中做到这一点？像这样的东西：

```
const int has_nukes        = 0b00000000000000000000000000000001;
const int has_bio_weapons  = 0b00000000000000000000000000000010;
const int has_chem_weapons = 0b00000000000000000000000000000100;
// ... 
```

我知道 C/C++ 编译器不会编译它，但必须有解决方法吗？是否可以使用其他语言（如 Java）？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2013-09-09T14:34:32.590

在 C++14 中，您将能够使用具有以下语法的二进制文字：

```
0b010101010 /* more zeros and ones */ 
```

此功能已在最新`clang`和`gcc`. 如果您使用`-std=c++1y`选项运行这些编译器，您可以尝试一下。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-02-11T15:32:00.280

我会使用位移运算符：

```
const int has_nukes        = 1<<0;
const int has_bio_weapons  = 1<<1;
const int has_chem_weapons = 1<<2;
// ...
int dangerous_mask = has_nukes | has_bio_weapons | has_chem_weapons;
bool is_dangerous = (country->flags & dangerous_mask) == dangerous_mask; 
```

它甚至比 0 的洪水还要好。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-02-11T18:20:54.100

顺便说一句，下一个 C++ 版本将支持用户定义的文字。它们已经包含在工作草案中。这允许那种东西（希望我没有太多错误）：

```
template<char... digits>
constexpr int operator "" _b() {
    return conv2bin<digits...>::value;
}

int main() {
    int const v = 110110110_b;
} 
```

`conv2bin`将是这样的模板：

```
template<char... digits>
struct conv2bin;

template<char high, char... digits>
struct conv2bin<high, digits...> {
    static_assert(high == '0' || high == '1', "no bin num!");
    static int const value = (high - '0') * (1 << sizeof...(digits)) + 
                             conv2bin<digits...>::value;
};

template<char high>
struct conv2bin<high> {
    static_assert(high == '0' || high == '1', "no bin num!");
    static int const value = (high - '0');
}; 
```

好吧，由于上面的“constexpr”，我们得到的是已经在编译时完全评估的二进制文字。以上使用硬编码的 int 返回类型。我认为甚至可以使它取决于二进制字符串的长度。对于任何感兴趣的人，它使用以下功能：

*   [广义常数表达式。](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2235.pdf)
*   [可变参数模板](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2080.pdf)。简要介绍可以在[这里找到](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2087.pdf)
*   [静态断言 (static_assert)](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2004/n1720.html)
*   [用户定义的文字](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2378.pdf)

实际上，当前的 GCC 主干[已经](http://gcc.gnu.org/projects/cxx0x.html)实现了可变参数模板和静态断言。让我们希望它能尽快支持其他两个。我认为 C++1x 会震撼人心。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-02-11T15:34:17.870

C++ 标准库是您的朋友：

```
#include <bitset>

const std::bitset <32> has_nukes( "00000000000000000000000000000001" ); 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-02-11T19:21:43.270

GCC 从 4.3 开始支持二进制常量作为扩展。请参阅[公告](http://gcc.gnu.org/gcc-4.3/changes.html)（查看“新语言和语言特定改进”部分）。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-02-11T15:28:18.667

如果您愿意，可以使用 <<。

```
int hasNukes = 1;
int hasBioWeapons = 1 << 1;
int hasChemWeapons = 1 << 2; 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-02-11T15:32:52.430

~~[这个讨论](http://archives.free.net.ph/message/20090115.031436.7fdfe7c5.ca.html)可能很有趣~~......可能是，因为不幸的是链接已经死了。它描述了一种基于模板的方法，类似于此处的其他答案。

还有一个叫做[BOOST_BINARY](http://www.boost.org/doc/libs/1_58_0/libs/utility/utility.htm)的东西。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-02-11T15:37:12.093

您想要的术语是*二进制文字*

[Ruby](http://wordaligned.org/articles/binary-literals)使用您提供的语法来提供它们。

一种替代方法是定义帮助宏来为您转换。[我在http://bytes.com/groups/c/219656-literal-binary](http://bytes.com/groups/c/219656-literal-binary)找到了以下代码

```
/* Binary constant generator macro
 * By Tom Torfs - donated to the public domain
 */

/* All macro's evaluate to compile-time constants */

/* *** helper macros *** */

/* turn a numeric literal into a hex constant
 * (avoids problems with leading zeroes)
 * 8-bit constants max value 0x11111111, always fits in unsigned long
 */
#define HEX_(n) 0x##n##LU

/* 8-bit conversion function */
#define B8_(x) ((x & 0x0000000FLU) ?   1:0) \
             | ((x & 0x000000F0LU) ?   2:0) \
             | ((x & 0x00000F00LU) ?   4:0) \
             | ((x & 0x0000F000LU) ?   8:0) \
             | ((x & 0x000F0000LU) ?  16:0) \
             | ((x & 0x00F00000LU) ?  32:0) \
             | ((x & 0x0F000000LU) ?  64:0) \
             | ((x & 0xF0000000LU) ? 128:0)

/* *** user macros *** /

/* for upto 8-bit binary constants */
#define B8(d) ((unsigned char) B8_(HEX_(d)))

/* for upto 16-bit binary constants, MSB first */
#define B16(dmsb, dlsb) (((unsigned short) B8(dmsb) << 8) \
                                         | B8(dlsb))

/* for upto 32-bit binary constants, MSB first */
#define B32(dmsb, db2, db3, dlsb) (((unsigned long) B8(dmsb) << 24) \
                                 | ((unsigned long) B8( db2) << 16) \
                                 | ((unsigned long) B8( db3) <<  8) \
                                 |                  B8(dlsb))

/* Sample usage:
 * B8(01010101) = 85
 * B16(10101010,01010101) = 43605
 * B32(10000000,11111111,10101010,01010101) = 2164238933
 */ 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-11T15:48:37.900

C++ 的下一个版本 C++0x 将引入[用户定义的文字](http://en.wikipedia.org/wiki/C%2B%2B0x#User-defined_literals)。我不确定二进制数是否会成为标准的一部分，但最坏的情况是您可以自己启用它：

```
int operator "" _B(int i);

assert( 1010_B == 10); 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-02-11T18:27:59.153

我这样写二进制文字：

```
const int has_nukes        = 0x0001;
const int has_bio_weapons  = 0x0002;
const int has_chem_weapons = 0x0004; 
```

它比您建议的符号更紧凑，更易于阅读。例如：

```
const int upper_bit = 0b0001000000000000000; 
```

相对：

```
const int upper_bit = 0x04000; 
```

您是否注意到二进制版本不是 4 位的偶数倍？你以为是 0x10000 吗？

通过一点练习，十六进制或八进制对人类来说比二进制更容易。而且，在我看来，使用移位运算符更容易阅读。但我承认，我多年的汇编语言工作可能会在这一点上对我产生偏见。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-10-26T19:05:40.103

如果你想使用 bitset、auto、variadic 模板、用户定义的文字、static_assert、constexpr*和*noexcept，试试这个：

```
template<char... Bits>
  struct __checkbits
  {
    static const bool valid = false;
  };

template<char High, char... Bits>
  struct __checkbits<High, Bits...>
  {
    static const bool valid = (High == '0' || High == '1')
                   && __checkbits<Bits...>::valid;
  };

template<char High>
  struct __checkbits<High>
  {
    static const bool valid = (High == '0' || High == '1');
  };

template<char... Bits>
  inline constexpr std::bitset<sizeof...(Bits)>
  operator"" bits() noexcept
  {
    static_assert(__checkbits<Bits...>::valid, "invalid digit in binary string");
    return std::bitset<sizeof...(Bits)>((char []){Bits..., '\0'});
  } 
```

像这样使用它：

```
int
main()
{
  auto bits = 0101010101010101010101010101010101010101010101010101010101010101bits;
  std::cout << bits << std::endl;
  std::cout << "size = " << bits.size() << std::endl;
  std::cout << "count = " << bits.count() << std::endl;
  std::cout << "value = " << bits.to_ullong() << std::endl;
  //  This triggers the static_assert at compile-time.
  auto badbits = 2101010101010101010101010101010101010101010101010101010101010101bits;
  //  This throws at run-time.
  std::bitset<64> badbits2("2101010101010101010101010101010101010101010101010101010101010101bits");
} 
```

感谢@johannes-schaub-litb

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-11T15:31:02.870

不幸的是，Java 也不支持二进制文字。但是，它具有**[可](http://java.sun.com/docs/books/tutorial/java/javaOO/enum.html)**与[`EnumSet`](http://java.sun.com/javase/6/docs/api/java/util/EnumSet.html). An 在`EnumSet`内部用位字段表示枚举值，并提供[`Set`](http://java.sun.com/javase/6/docs/api/java/util/Set.html)用于操作这些标志的接口。

或者，您可以在定义值时使用**位偏移**（十进制）：

```
const int HAS_NUKES        = 0x1 << 0;
const int HAS_BIO_WEAPONS  = 0x1 << 1;
const int HAS_CHEM_WEAPONS = 0x1 << 2; 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-11T17:38:30.723

C++ 中的文字二进制常量没有十六进制和八进制的语法。看起来你正在尝试做的最接近的事情可能是学习和使用[bitset](http://www.cplusplus.com/reference/stl/bitset/)。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-11T15:37:34.040

一种有点可怕的方法是生成一个包含大量#defines的.h文件......

```
#define b00000000 0
#define b00000001 1
#define b00000010 2
#define b00000011 3
#define b00000100 4 
```

等等。这可能对 8 位数字有意义，但可能不适用于 16 位或更大的数字。

或者，这样做（类似于 Zach Scrivena 的回答）：

```
#define bit(x) (1<<x)
int HAS_NUKES       = bit(HAS_NUKES_OFFSET);
int HAS_BIO_WEAPONS = bit(HAS_BIO_WEAPONS_OFFSET); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-12T05:09:16.770

作为旁白：

特别是如果您正在处理一个大集合，而不是通过 [minor] 脑力劳动来编写一系列移位量，您可以使每个常量依赖于先前定义的常量：

```
const int has_nukes        = 1;
const int has_bio_weapons  = has_nukes        << 1;
const int has_chem_weapons = has_bio_weapons  << 1;
const int has_nunchuks     = has_chem_weapons << 1;
// ... 
```

看起来有点多余，但它不太容易出错。此外，您可以简单地在中间插入一个新常量，而无需触及除紧随其后的任何其他行：

```
const int has_nukes        = 1;
const int has_gravity_gun  = has_nukes        << 1; // added
const int has_bio_weapons  = has_gravity_gun  << 1; // changed
const int has_chem_weapons = has_bio_weapons  << 1; // unaffected from here on
const int has_nunchuks     = has_chem_weapons << 1;
// ... 
```

相比于：

```
const int has_nukes        = 1 << 0;
const int has_bio_weapons  = 1 << 1;
const int has_chem_weapons = 1 << 2;
const int has_nunchuks     = 1 << 3;
// ...
const int has_scimatar     = 1 << 28;
const int has_rapier       = 1 << 28; // good luck spotting this typo!
const int has_katana       = 1 << 30; 
```

和：

```
const int has_nukes        = 1 << 0;
const int has_gravity_gun  = 1 << 1;  // added
const int has_bio_weapons  = 1 << 2;  // changed
const int has_chem_weapons = 1 << 3;  // changed
const int has_nunchuks     = 1 << 4;  // changed
// ...                                // changed all the way
const int has_scimatar     = 1 << 29; // changed *sigh*
const int has_rapier       = 1 << 30; // changed *sigh* 
const int has_katana       = 1 << 31; // changed *sigh* 
```

顺便说一句，可能同样难以发现这样的错字：

```
const int has_nukes        = 1;
const int has_gravity_gun  = has_nukes        << 1;
const int has_bio_weapons  = has_gravity_gun  << 1;
const int has_chem_weapons = has_gravity_gun  << 1; // oops!
const int has_nunchuks     = has_chem_weapons << 1; 
```

所以，我认为这种级联语法的主要优点是在处理常量的插入和删除时。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-02-14T12:41:47.033

另一种方法：

```
template<unsigned int N>
class b
{
public:
    static unsigned int const x = N;

    typedef b_<0>  _0000;
    typedef b_<1>  _0001;
    typedef b_<2>  _0010;
    typedef b_<3>  _0011;
    typedef b_<4>  _0100;
    typedef b_<5>  _0101;
    typedef b_<6>  _0110;
    typedef b_<7>  _0111;
    typedef b_<8>  _1000;
    typedef b_<9>  _1001;
    typedef b_<10> _1010;
    typedef b_<11> _1011;
    typedef b_<12> _1100;
    typedef b_<13> _1101;
    typedef b_<14> _1110;
    typedef b_<15> _1111;

private:
    template<unsigned int N2>
    struct b_: public b<N << 4 | N2> {};
};

typedef b<0>  _0000;
typedef b<1>  _0001;
typedef b<2>  _0010;
typedef b<3>  _0011;
typedef b<4>  _0100;
typedef b<5>  _0101;
typedef b<6>  _0110;
typedef b<7>  _0111;
typedef b<8>  _1000;
typedef b<9>  _1001;
typedef b<10> _1010;
typedef b<11> _1011;
typedef b<12> _1100;
typedef b<13> _1101;
typedef b<14> _1110;
typedef b<15> _1111; 
```

用法：

```
std::cout << _1101::_1001::_1101::_1101::x; 
```

在[CityLizard++ (citylizard/binary/b.hpp)](http://citylizardpp.codeplex.com/)中实现。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-04-08T15:14:54.510

我同意为二进制文字提供一个选项很有用，并且它们存在于许多编程语言中。在 C 中，我决定使用这样的宏：

```
#define bitseq(a00,a01,a02,a03,a04,a05,a06,a07,a08,a09,a10,a11,a12,a13,a14,a15, \
           a16,a17,a18,a19,a20,a21,a22,a23,a24,a25,a26,a27,a28,a29,a30,a31) \
   (a31|a30<< 1|a29<< 2|a28<< 3|a27<< 4|a26<< 5|a25<< 6|a24<< 7| \
a23<< 8|a22<< 9|a21<<10|a20<<11|a19<<12|a18<<13|a17<<14|a16<<15| \
a15<<16|a14<<17|a13<<18|a12<<19|a11<<20|a10<<21|a09<<22|a08<<23| \
a07<<24|a06<<25|a05<<26|a04<<27|a03<<28|a02<<29|a01<<30|(unsigned)a00<<31) 
```

用法非常简单=）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-11-18T19:39:24.753

可能与二进制文字不太相关，但这看起来好像可以通过位域更好地解决。

```
struct DangerCollection : uint32_t {
  bool has_nukes : 1;
  bool has_bio_weapons : 1;
  bool has_chem_weapons : 1;
  // .....
};
DangerCollection arsenal{
  .has_nukes = true,
  .has_bio_weapons = true,
  .has_chem_weapons = true,
// ...
};
if(arsenal.has_bio_weapons){
  std::cout << "BIO!!"
} 
```

你仍然可以用二进制数据填充它，因为它的二进制足迹只是一个 uint32。这通常与 union 结合使用，用于紧凑的二进制序列化：

```
union DangerCollectionUnion {
  DangerCollection collection;
  uint8_t data[sizeof(DangerCollection)];
};
DangerCollectionUnion dc;
std::memcpy(dc.data, bitsIGotFromSomewhere, sizeof(DangerCollection));
if (dc.collection.has_bio_weapons) {
  // .... 
```

以我的经验，不易出错且易于理解正在发生的事情。

# asp.net-mvc - 如何使用 jQuery Ajax 和 ASP.NET MVC 更新页面内容？

> ID：537306
> 
> 赞同：2
> 
> 时间：2009-02-11T15:24:01.703
> 
> 标签：asp.net-mvc, jquery

我有一个名为“ **MyPeriods(string dateSelected)** ”的 ActionResult，最后，我有一个**ViewData["periods"] = listOfPeriods**（之后，我有返回 View()，完成我的方法）。当没有传递“日期”时，“日期”是今天，否则，“日期”是作为参数传递的日期。这个“日期”对于选择与之相关的所有时期和事件很重要。

所以，我的 ActionResult 正在向我的视图发送一个周期列表。在我看来，我有：

```
<div id="divEventsPeriods">
   <% foreach(UserPeriod period in in (IEnumerable)ViewData["periods"])
       Response.Write("<div>PERIOD: " + period.hourBeg + " - " + period.hourEnd + "</div>");

      foreach(UserEvents event in period.UserPeriod) {
         Response.Write("<div>EVENT: " + event.date + "<br />");
         Response.Write("DESCRIPTION: " + event.description + "</div>");
      }
   %>
 </div> 
```

因此，当我在 jQuery DatePicker 中选择一个日期时，这个选定的日期将作为参数传递给我的 ActionResult 并且所有过程都会发生。最后，我的页面**刷新**呈现所选日期的所有期间和事件。一个时期可能有许多事件。

所以，问题是：如何将这个选定的日期传递给我的 ActionResult，使所有过程发生并且页面在**不刷新**的情况下更新？

**我在 DatePicker onSelect**选项上试过这个：

```
$.ajax({
     type: 'GET',
     url: '/Admin/Schedule/MyPeriods/?dateSelected=' + dateSelected,
     data: dateSelected
}); 
```

当我选择一个日期时，会调用 $.ajax 并进行调试，我可以看到所选日期已正确传递给我的 ActionResult 并进行了处理，但页面未更新。

我究竟做错了什么？？

提前致谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T15:39:03.007

您需要向 ajax 调用添加一个成功回调，它将接受返回的数据并通过 DOM 操作更新您的页面，例如，将 DIV 的内容替换为您的操作返回的 HTML（可能）。我在这里假设您的操作返回一个 ContentResult。如果您要返回 JsonResult，则需要使用结果并执行更新 DOM 所需的操作。

查看 jQuery AJAX[选项页面](http://docs.jquery.com/Ajax/jQuery.ajax#options)了解更多信息。

**编辑** 我决定用一种方法做到这一点，但使用 IsAjaxRequest()。您的客户端代码可能根本不需要更改，除了使用如下所述的部分。

```
 public ActionResult ViewPage(DateTime dateSelected)
 {
      ....do some stuff...
      ViewData["dateSelected"] = GetPeriods( dateSelected );
      if (Request.IsAjaxRequest()) {
          return PartialView("PeriodDisplay", ViewData["dateSelected"]);
      }
      else {
          return View();
 }

 // common code to populate enumerable
 public IEnumerable<Period> GetPeriods( DateTime selected )
 {
      return ...data based on date...
 } 
```

PeriodDisplay.ascx ：这应该是一个使用 IEnumerable 模型的强类型 ViewUserControl。

```
 <%@ Page ... %> /// page definition...

   <% foreach(UserPeriod period in Model) { %>
      <div>PERIOD: <%= period.hourBeg + " - " + period.hourend %> </div>

   <% foreach(UserEvents event in period.UserPeriod) { %>
      <div>
           EVENT: <%= event.date %><br/>
           DESCRIPTION: <%= event.description %>
      </div>
   <% } %> 
```

视图页面.aspx

```
 ...
   <div id="divEventsPeriods">
      <% Html.RenderPartial( "PeriodDisplay", ViewData["periods"], null ); %>
   </div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T08:55:17.833

您的操作需要返回 html 或文本或您想要显示的任何内容，或者您​​随后在 javascript 中处理的 JSON 对象。从[jQuery.ajax 文档](http://docs.jquery.com/Ajax/jQuery.ajax)：

```
 $.ajax({
   type: "POST",
   url: "some.php",
   data: "name=John&location=Boston",
   success: function(msg){
     alert( "Data Saved: " + msg );
   }
 }); 
```

在这种情况下， **msg**变量是您从操作中返回的 html / 文本。您的操作可以返回部分视图或类似`<p>Date Selected feb 12th 2009</p>`. 您还可以使用 ("#message").html(msg) 将 html 插入您的网页。

# c# - 如何验证在 Moq 中没有调用该方法？

> ID：537308
> 
> 赞同：516
> 
> 时间：2009-02-11T15:24:21.093
> 
> 标签：c#, .net, moq

如何验证未在[Moq](http://code.google.com/p/moq/)中调用该方法？

它有类似 AssertWasNotCalled 的东西吗？

更新：从 3.0 版开始，可以使用新语法：

```
mock.Verify(foo => foo.Execute("ping"), Times.Never()); 
```

* * *

## 回答 #1

> 赞同：608
> 
> 时间：2010-08-05T10:14:34.763

使用该`Times.Never()`选项在测试后运行验证。

```
_mock.Object.DoSomething()
_mock.Verify(service => service.ShouldntBeCalled(), Times.Never()); 
```

* * *

## 回答 #2

> 赞同：168
> 
> 时间：2009-02-11T16:13:32.893

**更新**：从第 3 版开始，请检查上述问题的更新或以下 Dann 的回答。

要么，让你的模拟严格，这样如果你调用一个你没有期望的方法，它就会失败

```
new Mock<IMoq>(MockBehavior.Strict) 
```

或者，如果您希望您的模拟是松散的，请使用 .Throws( Exception )

```
var m = new Mock<IMoq>(MockBehavior.Loose);
m.Expect(a => a.moo()).Throws(new Exception("Shouldn't be called.")); 
```

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2010-03-16T20:14:49.277

盗自：[John Foster 对问题的回答，“需要帮助以更好地理解 Moq”](https://stackoverflow.com/questions/1073846/need-help-understand-moq-better/1080774#1080774)

> 您可能要测试的一件事是，当将 65 岁以上的人传递给方法时，不会调用 pay 方法
> 
> ```
> [Test]
> public void Someone_over_65_does_not_pay_a_pension_contribution() {
> 
>     var mockPensionService = new Mock<IPensionService>();
> 
>     var person = new Person("test", 66);
> 
>     var calc = new PensionCalculator(mockPensionService.Object);
> 
>     calc.PayPensionContribution(person);
> 
>     mockPensionService.Verify(ps => ps.Pay(It.IsAny<decimal>()), Times.Never);
> } 
> ```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-19T09:34:48.807

> **这在 Moq 的最新版本中不起作用**（至少从 3.1 开始），它应该`Verify`在答案中提到的方法中指定。

实际上，最好`.AtMost(0)`在 Returns 语句之后指定。

```
var m = new Mock<ISomething>();
m.Expect(x => x.Forbidden()).Returns("foo").AtMost(0); 
```

虽然“投掷”也有效，`AtMost(0)`但恕我直言更具表现力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-06T13:32:10.053

假设你有这个方法并且你想测试它没有被调用

```
//Setup    
var databaseSessionMock = new Mock<IDatabaseSession>();
databaseSessionMock.Setup(m => m.Commit()).Returns(true).Verifiable();
RepositoryFactory.Configure<IDatabaseSession>(databaseSessionMock.Object); 
```

你可以像这样测试

```
databaseSessionMock.Verify(m => m.Commit(It.IsAny()), Times.Never(), "Database Session mock object was not used"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-03T20:44:05.090

我意识到这是一个非常古老的问题，但它刚刚出现在我的侧边栏中，我想添加我的解决方案。

作为设置的一部分，许多单元测试似乎模拟了几个功能，但在测试期间并未使用。

当然最好启用严格模拟（这意味着任何未明确设置的内容都会引发异常），然后不要设置任何您不希望调用的函数。或者换一种说法，只设置一个测试期望调用的函数，其他任何东西都会抛出异常。

```
var thingBeingTested = new Mock<IThink>(MockBehaviour.Strict);

thingBeingTested.ThisWillThrowAnExceptionBecauseItHasNotBeenMocked(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-07T02:29:21.463

## 使用`VerifyNoOtherCalls`（需要最小起订量 4.8 或更高版本）

这个答案是一种间接的方法。不是检查一个特定的方法没有被调用，而是检查一般情况下没有发生意外的调用。

考虑到对模拟的彻底测试做了两件事：

1.  验证是否进行了所有预期的调用
2.  确认没有进行意外调用

如果您已经在执行第 1 步，则添加第 2 步很简单：

```
// Step 1 (if relevant - see note below)
mock.Verify(..., Times.Exactly(2));
mock.Verify(..., Times.Once());
// ...

// Step 2
mock.VerifyNoOtherCalls(); 
```

笔记

*   如果您省略第 1 步，第 2 步将简单地确保根本没有对模拟进行调用。
*   这不需要严格的模拟。
*   来源：[起订量快速入门](https://github.com/Moq/moq4/wiki/Quickstart#verification)

* * *

## 回答 #8

> 赞同：-6
> 
> 时间：2009-02-11T15:59:01.510

使用 .AtMostOnce();

真实测试后，再次调用该方法。如果它抛出异常，它就会被调用。

# wcf - 如何将 basicHttpBinding 转换为 customBinding

> ID：537312
> 
> 赞同：8
> 
> 时间：2009-02-11T15:24:52.497
> 
> 标签：wcf

我一直在努力将 basicHttpBinding 转换为 customBinding 以让我的客户在网络场上工作。我一直在摸索翻译以下安全部分。

```
<基本的HttpBinding ...>
   <安全模式="传输">
      <transport clientCredentialType="Certificate">
   </安全>
</basicHttpBinding>
<行为>
   <行为>
      <clientCredentials>
         <客户证书
            x509FindType="FindBySerialNumber"
            查找值=“...”
         />
      </clientCredentials>
   <行为>
</行为>

```

我会向你展示我的翻译，但我所能理解的实际上是未受教育的猜测。我还将继续通过网络进行更多独立研究。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-08T14:36:56.130

此工具会自动将您的绑定转换为 customBinding。

[http://webservices20.cloudapp.net/default.aspx](http://webservices20.cloudapp.net/default.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T20:08:06.073

好的，我想通了，甚至不需要在自定义绑定中使用安全部分，我需要设置的所有内容都在 <httpsTransport/> 元素本身上。我已经删除了所有不重要的部分。

```
<自定义绑定>
    <绑定名称="viaLoadBalancers">

        <textMessageEncoding
            messageVersion="Soap11"
            writeEncoding="utf-8"
        />

        <https传输
            authenticationScheme="匿名"
            requireClientCertificate="true"
        />
    </绑定>
</customBinding>

```

# eclipse - 为 OA 框架配置 Eclipse？

> ID：537319
> 
> 赞同：3
> 
> 时间：2009-02-11T15:27:43.317
> 
> 标签：eclipse, oracle

任何人都知道配置 Eclipse 以使用 Oracle 应用程序框架的步骤吗？

或者，有没有人知道这样做的资源？

如果可能，我想避免使用 JDeveloper。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-13T19:21:51.443

要开发 OA 框架页面，需要 OA 扩展。OA 扩展可用于 Jdeveloper。除非有 Eclipse 的 OA 扩展，否则可能无法使用它运行 OA 页面。

# project-management - 多项目管理

> ID：537320
> 
> 赞同：2
> 
> 时间：2009-02-11T15:27:56.343
> 
> 标签：project-management

假设您有 2 个项目，这些项目总共将为 6 个开发人员提供一个月的工作量，比例为 2:1。

将开发人员分配给每个项目，然后他们在该项目上工作一整个月更好，还是整个团队轮流工作每个项目更好？

你有什么理由支持你的观点？

**编辑** 澄清一下，它们是完全独立的系统。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T15:34:27.667

这在很大程度上取决于这两个项目的相关性。如果它们有很多相似之处，我会说将它们作为一个大组中的两个项目来处理。

如果从代码和架构的角度来看，它们大多不相关，那么在两个项目期间分成两个团队会更有意义，也许尽可能交叉培训一些开发人员。

如果您是敏捷商店，只需运行两个并发迭代。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T15:49:41.750

如果项目在不同的系统中，我认为将从事项目的开发人员分开是明智的，因为[人类并不完全擅长多任务处理](http://headrush.typepad.com/creating_passionate_users/2006/03/multitasking_ma.html)，因为我们的[上下文切换技能很慢](http://www.codinghorror.com/blog/archives/000691.html)。因此，他们要么一个接一个地工作，要么将团队分成每个项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T15:36:08.333

这个问题的答案真的取决于很多因素。如果您 100% 确定您不会失去一名开发人员，并且没有人会放长假，那么将其分成特定的团队会有一些优势。OTOH，如果您不确定，最好让整个团队参与每个项目。

接下来，您必须考虑截止日期——按顺序运行项目会增加您错过任何一个截止日期的风险，如果确实如此，这种风险是否可以接受？

当然，开发人员总是有可能互相踩脚。2 个人月（是的，我知道这是一个神话）在 6 个开发人员之间分配的工作量是每人一周多一点的工作量——如果这对于项目的规模来说是合理的，那就没问题了。但是，您可以将工作拆分成的大小是有限制的，并且仍然有意义。

为您的项目回答这些问题，这应该会给您一个不错的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T15:38:40.903

我认为，对于不相关的项目，如果您将开发人员分散到各个项目中，您将获得更好的效率。这是因为沟通存在开销，如果您将项目中的开发人员数量增加一倍，您不会花费一半的时间。

但是，如果您的开发人员最终需要学习这两个系统，那么这种开销需要在某个时候发生。时间限制应规定是在项目期间还是之后发生。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T19:44:47.660

假设有足够的开发人员来覆盖每个项目，我会将他们分成 2 个团队（每个项目有 3 个开发人员，每个项目有 3 个开发人员就足够了）。我不认为在一个项目中增加不必要的开发人员是有效的。

编辑：这没有考虑到此类决策的所有其他因素（开发人员的生产力、技能、可用性）

# content-management-system - DotNetNuke 的优缺点？

> ID：537333
> 
> 赞同：9
> 
> 时间：2009-02-11T15:31:03.713
> 
> 标签：content-management-system, dotnetnuke

如果您使用过 DotNetNuke，您遇到过哪些优点和缺点？您发现哪些是您使用过的替代内容管理系统更好或更差。我试图了解人们正在使用什么内容管理系统框架以及它们的优缺点。

谢谢， XaiSoft

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T15:36:14.013

[这篇文章](https://stackoverflow.com/questions/532099/should-we-build-our-next-generation-web-application-on-the-dotnetnuke-platform)可能会有所帮助，因为它涵盖了其中的一些信息！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T15:34:32.877

DotNetNuke 运行良好，并且有各种各样的插件可以从不同的供应商处购买。它也是开源的，这很好，因为它允许您对问题进行更深层次的故障排除，如果它是闭源的。

我们没有花很多时间研究 CMS 系统，但在去年夏天，我们找不到任何具有针对 .net 框架的 DotNetNuke 功能的东西。如果您没有绑定到 .net，那么有很多可用的选项。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-07-03T05:47:13.030

DNN 在功能、特性和安全性方面非常动态。没有什么比得上的。但是，我在使用它时有一些缺点。

我认为最大的缺点是使用站点的 DNN 的响应时间。代码本身非常过时，在使用 DNN 之前，您需要锁定自己并仔细研究每一个编码细节。还有一个是 URL 依赖性，如果您需要将您的域名更改为另一个，您的旧数据库将毫无用处。

Dot NET 市场中有很多新的有前途的 CMS 扩展，在我看来，Sageframe 是其中最好的。我已经使用这个扩展很长一段时间了，虽然仍处于测试阶段，但我对它的功能非常着迷。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-11T17:25:58.507

DotNetNuke 非常强大。在我看来，它最大的优势是网站内容的内联编辑。它最大的缺点是与其他 CMS 系统相比，它占用大量资源。

这是我上个月写的比较：

[http://www.logicalvue.com/blog/2009/01/cms-shootout-dotnetnuke-vs-joomla-vs-wordpress/](http://www.logicalvue.com/blog/2009/01/cms-shootout-dotnetnuke-vs-joomla-vs-wordpress/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-06T16:56:15.957

最大的缺点是缺少对多种语言的支持。是的，您可以安装多种语言，但不能为每种已安装的语言编写单独的内容...

自己编写这样的模块并不难，但另一个问题是 URL。您可以使用“人性化”选项，但同样不支持多种语言。

例如*/Products/tabid/57/language/en-US/Default.aspx*变成*products.aspx*但不可能包含这样的语言*/en-US/products.aspx*

我知道有像[UrlMaster](http://ifinity.com.au/)这样的第 3 方工具可以解决这个问题，但我仍然认为这应该在这样的框架中可用。

最大的优势是可以轻松开发自己的模块！如果某个功能不可用，您可以编写自己的模块而不会出现任何问题！

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2014-02-20T08:56:54.687

.Net Nuke 不适合开发项目。微软正在发布很多版本，包括很多语言。

那么开发人员将如何学习所有的东西......

这对开发人员来说是非常糟糕的......

# tfs - 如何在 TFS 2008 中对某些用户隐藏工作项字段？

> ID：537341
> 
> 赞同：1
> 
> 时间：2009-02-11T15:32:52.337
> 
> 标签：tfs, bug-tracking, tfs-workitem

我正在通过 PowerTools 在 TFS 2008 中自定义工作项模板，我想知道是否可以为某些用户隐藏字段（或它的值）？

例如，假设我向我的客户开放 TFS，以便他们可以提交功能请求。我希望他们查看创建的工作项、查看历史记录、更改等，但我希望将某些字段保密并供我们内部使用。

是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T15:35:58.990

嗯，似乎还不可能。

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=254161](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=254161)

“这是一个很好的建议。我们已将其添加为未来版本的候选版本。如果您能为此请求提供商业案例，这将对我们有所帮助。谢谢。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T15:42:17.010

另一种选择是为工作项创建一个自定义界面，该界面只公开您想要的字段，而隐藏其他字段。虽然这意味着一些定制开发，但它会解决问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-01-08T15:33:18.117

您可以将其设为只读 - 这很接近吗？祝你好运。您可以使用该规则。

# tsql - 从 TSQL Proc 返回错误的最佳方法是什么？

> ID：537349
> 
> 赞同：2
> 
> 时间：2009-02-11T15:35:18.197
> 
> 标签：tsql, error-handling

这是场景：

1.  您加载一个页面，该页面基于数据库中的数据呈现（将这些称为“假设”）
2.  有人改变假设
3.  你提交你的页面
4.  错误！

解决这个问题的一般模式是这样的（对吗？）：

在您的保存过程中，在开始和提交事务中，您首先验证您的假设。如果其中任何一个发生更改，您应该返回一个优雅的错误消息，类似于您遇到问题的 ID 的 XML 列表，您可以在*页面*中处理它，而不是让它由默认的错误处理基础结构处理。

所以我的问题是最好的方法是什么？

*   返回未设置的 xml 列表和 out 参数中的错误标志，如果正确完成则返回 0？
*   使用out参数返回错误状态，proc的结果是错误列表还是proc的有效结果？
*   还有什么？（我应该注意 raiseerror 会导致 proc 出错，并被默认的错误处理代码拾取）

***更新***：我想返回一个可操作的失败 ID 列表（我计划在应用程序中突出显示这些单元格）。我可以在 RAISEERROR 中以 CSV 格式返回它们，但这似乎很脏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T15:53:11.367

我同意 - 我喜欢 RAISEERROR：

```
--  Validate @whatever 
IF @whatever >= '5'
BEGIN
    RAISERROR ('Invalid value for @whatever - expected a value less than 5, but received %s.', 10, 1, @whatever)
    RETURN 50000
END; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T15:44:22.183

使用`RAISERROR`具有适当严重性和/或等待级别的函数。如果您使用低严重性，这不一定会导致异常，正如您所争辩的那样，并且至少使用 .Net 检索这些消息非常简单。唯一的缺点是 .Net 中的 StoredProcedure 命令类型只能以 50 条为一组发送消息。

存储过程可以返回多个结果集。根据您的更新，您还可以将错误的 id 插入临时表中，然后在过程结束时从该表中选择记录作为您可以查看的附加结果集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:44:37.363

我会用一条消息做一个输出参数，如果有错误，返回将已经有一些不是 0 的东西

还要小心注定的事务并检查 xact_error，请参阅[使用 XACT_ABORT 回滚不可捕获的错误事务](http://wiki.lessthandot.com/index.php/Use_XACT_ABORT_to_roll_back_non_trapable_error_transactions)

# email - 通过电子邮件前端防止垃圾邮件

> ID：537353
> 
> 赞同：0
> 
> 时间：2009-02-11T15:35:50.940
> 
> 标签：email, spam

我为我的游戏编写了一个错误报告器，在它启动后，用户可以查看数据并通过 HTTP 将报告提交到我的网络服务器。如果提交失败，用户可以选择保存报告并稍后重试，使用错误报告器本身，使用网络表单上传文件，或将报告附加到电子邮件中。我知道我可以通过分析源 IP 来防止 HTTP 上的垃圾邮件，但我不确定在通过电子邮件接收报告时如何处理这个问题。有任何想法吗？

谢谢，罗伯

编辑：

附件将始终为 JSON 格式；任何其他都将被拒绝。我只是担心有人会这样做：

```
for i = 1, 10000 do
  json = generate_valid_json()
  send_email(json)
end 
```

并用噪音淹没我的错误跟踪器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T15:43:56.007

除了常规的垃圾邮件过滤器等，我确实对此有建议。

如果在您的应用程序或页面中，您可以使用 Mailto: 链接指定 Subject=，请在您希望收到的邮件主题中放置一个唯一 ID。

这样您就实现了 2 个目标 - 识别主题中的 ID，您将知道它不是垃圾邮件，并且如果该 ID 与您的错误报告相关联，那么当它到达时您已经知道将它放在哪里。

编辑：这不一定必须在主题中，或者 - 可以在正文中，或者如果你可以支持一个包罗万象的话，你可以简单地给他们一个唯一的 ID 电子邮件地址发送给他们......比如 bug- 394291@bugs.whatever.com。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T15:55:51.377

第一次尝试上传失败时如何保存报告。当用户启动游戏时，启动一个后台线程，尝试再次发送报告。最终，它应该可以工作，用户将不得不做任何事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:42:19.223

听起来您正试图区分来自您以前从未与之交谈过的随机人的电子邮件、向您发送附件的电子邮件和垃圾邮件之间的区别。

祝你好运！

*   你能经常更改电子邮件地址吗？
*   需要特定的主题行？
*   需要纯文本电子邮件？

# math - 如何将凸多边形分解为在 X 轴和 Y 轴上对齐的直角三角形？

> ID：537360
> 
> 赞同：3
> 
> 时间：2009-02-11T15:36:37.443
> 
> 标签：math, graphics, geometry, polygons

给定一个由一组顶点表示的凸多边形（我们可以假设它们按逆时针顺序排列），如何将这个多边形分解为一组直角三角形，其腿与 X 轴和 Y 轴对齐？

因为我可能缺少一些数学术语，所以“腿”就是我所说的那两条*不是*斜边的线（如果我在脸上刺伤了数学术语，请提前道歉——简短的更正是额外的功劳）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T16:17:15.863

我不确定是否要编写一个算法来做到这一点，但对于一张纸上的任何凸多边形似乎完全有可能做到这一点。对于每个顶点，从该顶点垂直或水平投影一条线，直到它遇到这些垂直或水平线中的另一条。对于角度变化很小的顶点，其中相邻边在 x 和 y 方面都沿相同方向行进，您需要从顶点添加两条线，一条水平线和一条垂直线。完成此操作后，您应该在原始多边形的中心留下一个多边形，但边是垂直的或水平的，因为边是由从原始多边形的顶点绘制的线形成的。因为这些边要么是垂直的，要么是水平的，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T17:24:43.627

我假设您已经按照上面的描述对顶点进行了排序，并且它们确实定义了一个凸多边形。

每个顶点定义一条水平线。那么，对于 V 顶点，您将有一组 V 线。丢弃符合以下条件之一的任何行：

*   定义该线的一个或多个顶点具有/具有最高或最低 Y 分量（如果一个顶点，该线仅在该点与多边形相交；如果两个，该线与多边形边缘重合）
*   如果两个顶点的 Y 坐标相等，则只保留其中一条线（它是重复的）。

结果将类似于多边形的“条带”。

每条水平线在两个点与多边形相交。一个是它的定义顶点。另一个要么是另一个顶点，要么是由两个顶点定义的线段上的一个点。您可以很容易地确定哪种情况 - 只需简单比较 Y 坐标即可。与线段相交的坐标也很容易计算，我留给你。

每个交叉点定义一个垂直段。该段包含在多边形内（如果它与一条边重合，您可以将其丢弃），并且另一端与另一条水平线相交，或者如果该边本身是水平的，则与多边形的边相交。确定案件再次只是坐标比较的问题。最后，可能有 0-2 个附加垂直段，由具有最高和/或最低 Y 坐标的顶点定义，如果其中只有一个。

生成的图表现在显示每个带，如果可能，每个带都修剪掉了一个直角三角形。每个三角形都应符合您的标准。剩余区域是矩形；绘制任意对角线，将每个对角线分成两个符合您标准的直角三角形。

你完成了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T18:14:53.663

我认为尼尔 N 是对的。不幸的是，他没有提供任何具体的链接。

如果你有一个梯形，它的顶部和底部平行于 X 轴，你可以很容易地用 4 个直角三角形来渲染它。将该形状称为水平梯形。

如果您有一个一侧平行于 X 轴的三角形，则可以使用 2 个直角三角形来渲染它——或者您可以考虑梯形的退化情况，其底部的顶部长度为零。

从凸包的顶部或底部开始（即搜索具有 min 或 max y 的坐标）并将其拆分为水平梯形。

编写代码并不难，因此它与非凸多边形一样好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T15:39:11.603

我不确定这是否可能。考虑一个已经与 X 和 Y 轴的边对齐的正方形。如何使用也与 X、Y 轴对齐的顶点绘制三角形？

或者多边形的实际边是否允许沿着 x,y 轴。这意味着你可以在正方形的对角线上画一条线。如果是这样，可能很难处理更复杂的多边形，其中一些边与轴对齐，而另一些则不对齐。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T15:59:01.617

我不相信提出的问题有一个通用的解决方案。问题在于与 X 轴和 Y 轴位对齐。这意味着每个顶点都需要在 X 和 Y 方向上投影到多边形的另一侧，并在这些交点处创建新顶点。但是对于以这种方式添加的每个新顶点，该过程必须继续进行。您可能会很幸运并终止此过程（因为已经有一个顶点适当地放置在对面），但在一般情况下它只会继续下去。

如果您放弃该限制，那么 Neil N 的建议对我来说似乎很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-23T18:10:09.610

我认为这在一般情况下是不可能的。

考虑多边形 {(0, 1), (1, 0), (2, 0)}

```
.
 .. 
```

正如您所描述的，这个三角形不能分成有限数量的三角形。

# java - Java 热插拔的限制

> ID：537363
> 
> 赞同：6
> 
> 时间：2009-02-11T15:38:00.157
> 
> 标签：java, debugging, hotswap

java [hotswap](http://en.wikipedia.org/wiki/Hot_swapping)功能为我节省了很多时间。但是，它有很多限制（例如不支持架构更改）。知道限制是否会尽快得到解决吗？根据这个[论坛条目](http://forums.sun.com/thread.jspa?messageID=3949087)，它似乎被忽略了。

我知道像 JRebel 这样的产品会有所帮助。但是有人知道这方面的任何开源工具吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T13:51:46.227

您可以查看[Dynamic Code Evolution VM](http://ssw.jku.at/dcevm/)（也在[http://java.net/projects/dcevm](http://java.net/projects/dcevm)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-24T04:59:28.813

JavaRebel 是一个很好的工具，但它需要你购买。

我想建议您使用 hotswaping ant 工具：

[http://www.asjava.com/core-java/how-to-hotswap-java-code-into-jvm-redefinition-example/](http://www.asjava.com/core-java/how-to-hotswap-java-code-into-jvm-redefinition-example/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:46:55.220

OSGI 应该已经解决了这个问题。你可能想看看[apache felix](http://felix.apache.org/site/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-04T17:12:00.573

您还可以查看[Eclipse Equinox](http://www.eclipse.org/equinox/)。

# java - 如何在自定义 docletpath 中包含多个路径？

> ID：537366
> 
> 赞同：2
> 
> 时间：2009-02-11T15:38:27.533
> 
> 标签：java, javadoc

我有一个 javadoc doclet，它需要一个额外的 jar 文件位于 doclet 的类路径中。要从命令行运行 doclet，我执行以下操作：

```
java com.sun.tools.javadoc.Main -doclet myPackage.myDoclet -docletpath /path/to/doclet/classes 
```

当我运行它时，它会在路径上找到 doclet 并执行它，但是 doclet 使用了一个需要在类路径上的附加 jar，所以最终，我得到了 ClassNotFoundException。

当我将命令行更改为：

```
java com.sun.tools.javadoc.Main -doclet myPackage.myDoclet -docletpath /path/to/doclet/classes:/path/to/some.jar 
```

它不再找到 doclet ( `javadoc: error - Cannot find doclet class com.adventact.si.workflow.javadoc.ListClass`)。因此，似乎 doclet 参数不接受路径列表，而只接受一个路径。

（请注意，这些命令行并不完整——我没有展示我如何设置类路径，因为它与 docletpath 问题无关，而且确实是垃圾邮件。）

你如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T17:10:35.050

[Javadoc](http://docs.oracle.com/javase/6/docs/technotes/tools/windows/javadoc.html#docletpath)的文档说允许使用路径列表。确保您使用了正确的路径分隔符，“;” 或 ':' 取决于您使用的是 Windows 还是 UNIX（分别）。

注意：如果您真正使用`java`而不是`javadoc`执行您的 doclet，请检查您的类的实现。 `-docletpath`不是`java`可执行文件的标准选项，因此必须由您的 doclet 实现解释。但是，如果您正在使用，`javadoc`那么我在上面指出的文档说：

> 如果*classpathlist*包含多个路径或 jar 文件，它们应该`:`在 Solaris 上用冒号 ( )分隔，`;`在 Windows 上用分号 ( ) 分隔。

# sharepoint - 用于共享点日历 的 xsl

> ID：537369
> 
> 赞同：1
> 
> 时间：2009-02-11T15:38:40.153
> 
> 标签：sharepoint, xslt, calendar

我需要创建一个日历，它将来自多个单独的共享点团队日历的数据连接在一起（这样我组织中的新闻办公室就可以在同一页面上并排查看每个部门发生的事情 - 他们想要什么类似于共享谷歌日历的用户界面）。

我发现我可以在 Sharepoint 中创建一个链接源，它结合了各种日历，并将提供我需要的数据的 xml 输出。所以我现在想要的是一个如何使用一些 xml 并在只读日历中为我的用户创建标准日/周/月视图的示例。

我发现如下：

您不能附加 listviewwebpart - 他们使用 caml 而不是 xslt - 他们不能使用 xml 数据。他们使用对象模型来使用它所属的列表。

该 Web 部件没有源代码。它被锁定在一个dll中。

dataformwebpart 可以使用任何 xml 数据源。

某些 listviewwebparts 可以更改为 dataformwebparts，但不能更改为日历。

是否有一个 xslt 日历的示例，它可以使用一些 xml 并创建标准的日/周/月视图来让我继续前进？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T17:05:12.503

这是一个常见的请求，对于标准 Web 部件来说并不容易。您可以尝试 Ton Stegeman 的[Content by Type Web 部件](http://www.tonstegeman.com/cbt/features/default.aspx)，我认为它允许您将列表项汇总到日历中，或者查看[Bamboo Solutions](http://bamboosolutions.com/)的（商业）列表汇总和 calendar+ webparts 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-04T15:52:09.307

[http://www.ideseg.com/SharePointXSLToRenderCalendarsWithCsegRollUp.aspx](http://www.ideseg.com/SharePointXSLToRenderCalendarsWithCsegRollUp.aspx) 来自 Carlos Segura 博客，是进行日历加入的绝佳方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-03T13:16:26.037

现在很常见的是，您可以将另一个日历与现有日历一起添加为“图层”。例如，这就是我们在 Google 日历、Outlook、Android 中所做的事情。我相信这就是它的意图，它结束了对同步工具、查询问题、数据 webpart 的追求。同样的事情可以在 OOTB Sharepoint 中完成；请参阅下面的链接，他们似乎已经找到了正确的答案。创建日历视图后，很容易加载额外的日历。 [http://weblogs.asp.net/sharadkumar/archive/2010/03/12/aggregate-sharepoint-event-items-into-your-calendar-view-using-calendar-overlay.aspx](http://weblogs.asp.net/sharadkumar/archive/2010/03/12/aggregate-sharepoint-event-items-into-your-calendar-view-using-calendar-overlay.aspx)

# warnings - SunStudio C++ 编译器编译指示禁用警告？

> ID：537374
> 
> 赞同：3
> 
> 时间：2009-02-11T15:39:15.473
> 
> 标签：warnings, suppress-warnings, sunstudio

SunStudio11 捆绑的 STLport 会产生很多警告。我相信大多数编译器都有办法禁用某些源文件的警告，如下所示：

孙丙

```
#pragma error_messages off

#include <header.h>
// ...

#pragma error_messages on 
```

海合会

```
#pragma warning(push, 0)        

#include <header.h>
// ...

#pragma warning(pop) 
```

您如何在 SunStudio C++ 编译器中执行此操作？（顺便说一句，sunstudio C 编译指示在 sunstudio C++ 中不起作用）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-22T10:55:18.627

在 SunStudio 12 中，#pragma error_messages 按照 C 用户手册中的说明工作。

您可以使用 -errtags=yes 选项查看标签，并像这样使用它：

```
// Disable badargtypel2w:
//     String literal converted to char* in formal argument
#pragma error_messages (off, badargtypel2w ) 
```

然后用 CC（C++ 编译器）编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T23:08:41.417

如果您宁愿使用命令行选项而不是#pragmas，一个简单的答案是您可以使用 `-erroff=%all on your compile line.`

您可以使用 -erroff=%tag 抑制特定的警告消息

您可以通过将 -errtags 添加到编译行来打印出警告消息的标签。然后，您可以为 -erroff 定义一组逗号分隔的值，以抑制这些标签。

有关详细信息，请参阅[http://docs.oracle.com/cd/E19205-01/820-7599/bkapa/index.html](http://docs.oracle.com/cd/E19205-01/820-7599/bkapa/index.html)。

请注意，Sun Studio 12 更新 1 现在可用，我在这里引用 SS12u1 文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-16T19:39:50.943

将 -w 添加到您的 $CC 或您使用的任何变量中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T15:56:05.947

无法关闭警告，但是当我上次查看 SunStudio 时，它附带了两个 STL——一个较旧的 STL，用于向后兼容早期编译器版本和 STLport。在尝试关闭警告之前，可能值得检查您是否正在使用 STLport。

# javascript - 我在使用 jQuery 切换侧边栏时遇到问题

> ID：537381
> 
> 赞同：1
> 
> 时间：2009-02-11T15:41:38.337
> 
> 标签：javascript, jquery, toggle, sidebar

我正在尝试使用 jquery 创建一个简单的切换侧边栏，当按下按钮时它会展开和收缩。该按钮在按下时也会更改为另一种类型的按钮。侧边栏会展开，但由于某种原因，它不会移回原来的位置。[您可以在http://www.jqueryhelp.com/viewtopic.php?p=4241#4241](http://www.jqueryhelp.com/viewtopic.php?p=4241#4241)看到 javascript 和 html 的副本

这是工作代码，谢谢Bendeway！:D

```
$(".btn-slide").live('click', function(e){ 
   e.preventDefault();

   $("#sidebar").animate({opacity: "show", left: 250}, "slow"); 
   $(this).toggleClass("btn-slide").toggleClass("active");
}); 

$(".active").live('click', function(e){ 
   e.preventDefault();

   $("#sidebar").animate({opacity: "hide", left: 100}, "slow"); 
   $(this).toggleClass("btn-slide").toggleClass("active");
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T15:51:53.150

尝试用负数代替右使用左。此外，我建议使用 preventDefault 而不是返回 false。

```
$(".active").click(function(e){ 
   e.preventDefault();

   $("#sidebar").animate({opacity: "hide", left: -250}, "slow"); 
   $(this).toggleClass("btn-slide");
}); 
```

## 更新

我刚刚注意到的另一件事是，当文档准备好时，您将单击事件附加到 .active 按钮，但是当文档准备就绪时，在您更改文档后没有 .active 按钮。这里有几个选项。

首先是使用jquery 1.3新的[live特性](http://docs.jquery.com/Events/live)

```
$(".btn-slide").live('click', function(e){ 
   e.preventDefault();

   $("#sidebar").animate({opacity: "hide", left: 250}, "slow"); 
   $(this).toggleClass("btn-slide").toggleClass("active");
}); 

$(".active").live('click', function(e){ 
   e.preventDefault();

   $("#sidebar").animate({opacity: "hide", left: -250}, "slow"); 
   $(this).toggleClass("btn-slide").toggleClass("active");
}); 
```

另一种选择是将点击事件设置在不同的修饰符上（例如，在 id 上，也许）。

```
<span>News  <img src="img/overlay.png" id="sliderButton" class="btn-slide" alt="" /></span> 
```

然后用它来处理点击

```
$("#sliderButton").click(function(e){ 
  e.preventDefault();

  $(this).is('.btn-slide').each(function() {
   $("#sidebar").animate({opacity: "show", left: 250}, "slow"); 
  });

  $(this).is('.active').each(function() {
   $("#sidebar").animate({opacity: "hide", left: -250}, "slow"); 
  });
  $(this).toggleClass("active").toggleClass('btn-slide');  
}); 
```

甚至更简洁

```
$("#sliderButton").click(function(e){ 
  e.preventDefault();

  var animationSettings = {opacity: "show", left: 250};
  if ($(this).hasClass('active') )
  {
    animationSettings = {opacity: "hide", left: -250};
  } 

  $("#sidebar").animate(animationSettings , "slow"); 
  $(this).toggleClass("active").toggleClass('btn-slide');  
}); 
```

我能想到的最后一个选项是在更改点击事件后设置它们，但我不会这样做，所以我不会提供示例。

最后，我会在您的活动回调中添加警报，并确保您的活动按钮事件实际上正在触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T15:59:18.123

您的逻辑编写方式，我认为您需要在单击处理程序内的两个类上执行“toggleClass”，这将添加一个并删除另一个。例如，当您单击“活动”项目时，您切换（添加）btn-slide 类，但这也会保留“活动”类。

当然，除了使用“toggleClass”，您还可以使用“addClass”和“removeClass”来更明确。

我建议使用像 Firebug 这样的工具来观察 DOM 内部发生的事情。

```
$(document).ready(function(){

   $(".btn-slide").click(function(){
   $("#sidebar").animate({opacity: "show", left: "250"}, "slow");
   $(this).toggleClass("active");  // add class
   $(this).toggleClass("btn-slide"); // remove class
   return false;
   });   

});

$(document).ready(function(){

   $(".active").click(function(){
   $("#sidebar").animate({opacity: "hide", right: "250"}, "slow");
   $(this).toggleClass("active");  // remove class
   $(this).toggleClass("btn-slide");  // add class
   return false;
   });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T07:52:14.133

这行得通。

```
$(document).ready(function(){
    $(".btn-slide").click(function(){
        $("#sidebar").slideToggle("slow");
        $(this).toggleClass("active"); return false;
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T11:23:27.257

```
$(function() {
  var ecswitch = 1;
  /* prevent the annoying scroll back up thing */
  $("#ec").click(function(e) {
    e.preventDefault();
    var x = $("#main").width(); // get element width
    var y = $("#main").height(); // get element height 
    if (ecswitch == 1) {
      $("#main").animate({
        opacity: 0,
        hieght: "0",
        width: "0"
      }, 1300);
      ecswitch = 0;
    } else {
      $("#main").animate({
        opacity: 1,
        hieght: y,
        width: x
      }, 1300);
      ecswitch = 1;
    }
  });
});
```

```
#main {
  height: 200px;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div id="content">
  <a href="#" id="ec">Expand / Contract</a>
  <div id="main">
    Watch Me Shrink Or Grow
  </div>
</div>
```

我选择做这件事有点不同。这初始化为我们实验的高度为 200 像素，宽度是自动的。当您单击超链接时，实验会在 1.3 秒内隐藏，并且开关设置为 0。当您再次单击时，它会在 1.3 秒内返回，并且开关会回到 1。就像电灯开关一样。我在这里使用了动画，因为简单的淡入淡出或隐藏让我感到无聊......

我在将元素归零之前获得元素的宽度和高度的原因是，如果在我的动画中说 width:100%" 和 height:"100%" 它会将其设置为页面宽度和高度的 100%.. .我们不希望那样。

**注意**：我也在一段时间内使用不透明度。褪色也很好:)

# asp.net-mvc - 从 Web 表单转换为 MVC

> ID：537391
> 
> 赞同：7
> 
> 时间：2009-02-11T15:44:19.953
> 
> 标签：asp.net-mvc, webforms

有没有人经历过将现实世界的业务应用程序从 ASP.NET Web 表单转换为 MVC 的过程？转型有多痛苦？总的来说，你会说它值得吗？

我试图弄清楚是否值得花时间将应用程序转换为 MVC 以提高性能。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T15:49:46.337

这只是一个意见，但我会说不要这样做。我已经对此进行了研究，并决定我们将 MVC 用于新应用程序和完全重写，因为涉及的巨大差异。

但是，我想这实际上取决于您的 asp.net 页面最初的样子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T15:55:24.717

我目前正在将几个 Web 表单项目转换为 MVC。一开始更多是为了熟悉 MVC，但现在我真的很喜欢它提供的模型和分离方式。

在某些领域，过渡有点困难，因为除了一些博客、stackoverflow 和几个视频投射之外，真的没有很多材料。有两本书是半可用的，但其中一本已经有点用处了，因为框架已经发生了一些变化，有更好的方法来处理某些事情。

我也认为如果你还不熟悉 jQuery，你将不得不真正开始学习 jQuery。所以对我来说——我觉得我真的在学习两件事，因为我一直在这样做。

但总的来说值得，我会说是的。而且我认为转换一个小项目也是一个很好的开始方式。

# python - 您将如何设置具有多个虚拟主机的 Python Web 服务器？

> ID：537399
> 
> 赞同：1
> 
> 时间：2009-02-11T15:46:06.703
> 
> 标签：python, webserver, environment, wsgi

我被告知 wsgi 是要走的路，而不是 mod_python。但更具体地说，您将如何设置您的多网站服务器环境？选择网络服务器等？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T16:11:33.773

Apache+mod_wsgi 是常见的选择。

这是一个简单的示例 vhost，设置为将 /wsgi/something 的任何请求映射到应用程序（然后可以查看 PATH_INFO 以选择一个操作，或者您正在执行调度）。根 URL '/' 也被路由到 WSGI 应用程序。

```
LoadModule wsgi_module /usr/local/lib/mod_wsgi.so
...

<VirtualHost *:80>
    ServerName                  www.example.com
    DocumentRoot                /www/example/htdocs
    WSGIScriptAliasMatch ^/$    /www/example/application.py
    WSGIScriptAlias      /wsgi  /www/example/application.py
</VirtualHost> 
```

如果您愿意，可以使用 WSGIProcessGroup 指令来分隔不同虚拟主机的处理程序。如果您需要在不同用户下运行 vhost 脚本，则需要使用 WSGIDaemonProcess 而不是嵌入式 Python 解释器。

application.py 会在运行时将您的 WSGI 可调用留在全局“应用程序”变量中。您还可以添加一个作为主运行的页脚以与老式 CGI 兼容：

```
#!/usr/bin/env python
from mymodule import MyApplication

application= MyApplication()

if __name__=='main':
    import wsgiref.handlers
    wsgiref.handlers.CGIHandler().run(application) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:08:12.360

我建议将 Nginx 用于 Web 服务器。快速且易于设置。

您可能希望每个 vhost 拥有一个 unix 用户——因此每个主目录都拥有自己的应用程序、python 环境和服务器配置。这使您可以安全地重新启动特定应用程序，只需杀死您的虚拟主机拥有的工作进程即可。

只是一个小窍门，希望对你有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T16:11:15.020

您可以使用 Apache 和[mod_wsgi](http://www.modwsgi.org/)。这样，您仍然可以使用 Apache 对虚拟主机的内置支持。

# sql-server - SQL相当于模式的“使用”？

> ID：537401
> 
> 赞同：0
> 
> 时间：2009-02-11T15:46:15.923
> 
> 标签：sql-server, schema

我正在使用一个 SQL Server DB，它的表分布在多个模式中（不是我的想法），所以查询最终看起来像这样：

```
select col1, col2
from some_ridiculously_long_schema_name.table1 t1
inner join
    another_really_long_schema_location.table2 t2
    on... 
```

...你明白了。

当我将查询放入存储过程等时，这是一个小小的不便，但是当我进行临时查询时，这真的很痛苦。

有什么方法可以“包含”我感兴趣的所有模式，并让它们自动寻址？（LINQPad 这样做）。

我希望能够指出这样的事情：

```
using some_ridiculously_long_schema_name, another_really_long_schema_location 
```

...然后使用我的地址空间中包含的那些模式进行查询。

如果不存在这样的东西，我会研究同义词，但我更愿意这样做而不必将工件添加到数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T16:08:20.923

Red-Gate 销售一种 SQL 工具，可将智能感知添加到服务器管理工​​作室。从未尝试过，但它可能有助于减少击键：[http ://www.red-gate.com/products/SQL_Prompt/index.htm](http://www.red-gate.com/products/SQL_Prompt/index.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T20:43:57.657

我知道您的感受，如果您需要保留模式（例如，如果您在每个模式中都有相同的表名）并且您一直在编写跨模式连接的查询，我可以提供的最佳建议是缩短您的模式名称。

我敢肯定，技术含量低，不是您想听到的。

上面建议的同义词仅适用于对象级别（据我所知，您不能拥有整个架构的同义词），因此您必须为您想要使用的每个表、视图、存储过程、函数等提供同义词从您的默认架构之外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:49:33.933

不，它没有。同义词是唯一的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T15:49:50.750

那是行不通的，因为如果你在两个模式中都有 Table1 那么你怎么知道你想要什么模式呢？

# database - 有关构建 RDBMS 的资源

> ID：537402
> 
> 赞同：7
> 
> 时间：2009-02-11T15:46:32.723
> 
> 标签：database, algorithm, rdbms

我正在考虑实施 RDBMS。关于数据库如何在内部工作，以及在开始构建自己的数据库时我需要了解哪些方面的信息，是否有任何好的资源？（请不要评论这是否是一个实用的想法 - 只是想象它是为了一个爱好项目或其他东西）。

再次 - 对 RDBMS 设计感兴趣，而不是数据库设计。效率非常重要（如果我不关心速度，设计某种关系数据库之类的结构似乎相当容易）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T15:54:36.480

那里有一些关于这类东西的教科书，当我在大学时，我们为一个班级项目做了这个。这本书应该对你的[数据库系统：全书有所帮助](http://infolab.stanford.edu/~ullman/dscb.html "数据库系统：全书")

我忘了提，但我的代码在 googlecode 上：[cs4420-dbase](http://code.google.com/p/cs4420-dbase/)

请原谅它是用 java 编写的，但我的队友在这个决定上投票超过了我。但是基本的想法都还在。它处理文件创建和处理以及简单的 SQL 解析器和优化器。它处理基本索引（b-tree）和“内存”管理。请原谅一些缺乏评论和奇怪的评论，许多深夜都花在了那个项目上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T15:52:31.883

我建议从[Introduction to Database Systems](https://rads.stackoverflow.com/amzn/click/com/0321197844) and [Transactional Information Systems](https://rads.stackoverflow.com/amzn/click/com/1558605088)开始。他们都应该有参考书目来带你走得更远。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T15:55:50.393

构建 RDMS 并非易事，您需要将多个领域的经典 CS 知识与有关硬盘驱动器、操作系统细节、文件系统、内存、cpu、缓存的深入知识相结合，以提高效率。

我们需要阅读的一篇关于架构的好文章是：

[http://www.nowpublishers.com/product.aspx?product=DBS&doi=1900000002](http://www.nowpublishers.com/product.aspx?product=DBS&doi=1900000002)

关于数据库的理论知识我建议买一本关于这个主题的书，我只能谈谈我为此使用的书，即 Kifer、Bernstein 和 Lewis 的 Database Systems an Application-Oriented Approach。

您可能想查看一些开源数据库以获取想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-25T16:58:08.727

我最近遇到了同样的问题，和其他人一样，我很难找到一本有助于从头开始构建实际 RDBMS 的书（当然是最小的）。与其他 CS 领域（操作系统、编译器等）发生的情况相反；数据库领域在这方面的资源似乎较少。可能是因为 RDBMS 是最难掌握和实施的；-|

尽管如此，我终于找到了一个令人满意的答案。Sciore 的书《数据库设计与实现》：

[http://www.wiley.com/WileyCDA/WileyTitle/productCd-EHEP000711.html](http://www.wiley.com/WileyCDA/WileyTitle/productCd-EHEP000711.html)

前两部分专门用于学习使用您可能已经知道的 RDBMS。但最后两部分涵盖了实现细节；有趣的是，一个最小的RDBMS（SimpleDB）用于说明概念，也可以作为进行编程练习的平台。Wiley 网站有一句名言说得更好：

“附带 SimpleDB，这是一个免费下载、功能齐全的简化数据库系统，它（与商业数据库系统不同）体积小、易于阅读且易于修改。SimpleDB 可用作学生完成作业项目和实施概念的平台书中记载。”

不要为示例 RDBMS 是用 Java 编写的事实而烦恼；这具有隐藏在 C/Unix 中实现的低级细节的优势（恕我直言）。如果您像我一样来自应用程序世界，那么您可能对系统编程的东西不熟悉；但是学习像 Java 这样的高级语言中的 RDBMS 实现概念，可以作为过渡的良好桥梁。

Wiley 网站允许购买该书的电子版，但无论您购买，源代码都可用。我不能发布两个以上的链接，但只需 google 这个词（包括双引号），你会很容易找到 SimpleDB 主页（在那里你可以下载它）：

“SimpleDB 数据库系统”

如果您不确定是否要购买这本书（与其他核心 CS 书籍一样，对学生来说并不便宜）；也许您可以开始阅读代码和这篇介绍性文章：

[http://www.cs.bc.edu/~sciore/papers/SIGCSE07.pdf](http://www.cs.bc.edu/~sciore/papers/SIGCSE07.pdf)

如果您觉得它很有吸引力，那么购买这本书可能是一项不错的投资。

希望有帮助，干杯。

# windows - 分配 win XP 命令行输出到变量

> ID：537404
> 
> 赞同：5
> 
> 时间：2009-02-11T15:47:22.333
> 
> 标签：windows, linux, shell, awk, translation

我想将以下脚本从 linux shell 翻译成 Windows XP shell

```
GPSID=$(awk '/GPSID/ {print $3}' gora.RTK ) 
awk -v variable=${GPSID} 'BEGIN {printf "Numer seryjny : " variable,$1}' >>out.txt 
```

第二行已翻译；问题在于在 Windows 中定义一个包含 shell 输出的变量:-(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T16:20:41.287

好的问题已解决

```
for /f "tokens=*" %%a in ('awk "/GPSID/ {print $3}" gora.RTK ') do set var=%%a
awk "BEGIN {printf \"GPSID : \" }" >out.txt
echo %var% >>out.txt 
```

这段代码基本上做了我想做的事。

你太棒了谢谢！！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:06:25.173

如果需要通过命令的输出进行递归，可以使用`for /f`. 就像是：

```
for /f "usebackq" %%L in (`awk '/GPSID/ {print $3}' gora.RTK`) do (
    awk 'BEGIN {printf "Numer seryjny : " %%L,$1}' >> out.txt
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:56:22.357

怎么样 ...

for /f "tokens=*" %%a in ('echo Hello World') do set var=%%a

注意：在命令行上尝试时使用 %a 而不是 %%a ，如果在批处理文件中使用，则将其保留为 %%a。

其中“echo Hello World”是您要捕获其输出的命令，“var”是存储输出的变量的名称。

# c# - 枚举类型的接口时，如何仅获取直接继承的接口？

> ID：537408
> 
> 赞同：2
> 
> 时间：2009-02-11T15:48:38.413
> 
> 标签：c#, .net, reflection

我不确定这里的确切术语。基本上，如果我有这样的模型：

```
class Student : IDoSchool {}
class Freshman : Student {}
interface IDoSchool {} 
```

什么代码会告诉我 Freshman 不直接实现任何接口而 Student 直接实现 IDoSchool？

换句话说（忽略不好的术语）我想要这样的东西：

```
typeof(Freshman).GetInterfaces(BindingFlags.DeclaredOnly); // nothing
typeof(Student).GetInterfaces(BindingFlags.DeclaredOnly); // IDoSchool 
```

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T16:29:53.213

我怀疑接口的语义与您尝试做的不一致。

一个接口只是说一个类必须实现一个成员列表。该类继承了接口，但子类仍然有责任实现它从父类继承的接口。大多数情况下，父级已经提供了实现，因此我们倾向于将接口实现视为与继承相同，但实际上它们是完全不同的概念。

在您的情况下，您能做的最好的事情是使用 GetInterfaceMap() 检索接口映射，并确保接口的每个成员的所有实现都来自父级，而不是来自子级。这是您可以做的最好的事情，但仍然不能完全按照您的要求做。

另外，在您的情况下是否可以使用完全抽象的类而不是接口？你不能做多重继承，但也许你所有的规则都暗示着一个非常线性的继承？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T16:17:09.890

很抱歉将其发布为答案，实际上更多的是一种想法和建议，但它不适合评论...

如果你有以下情况怎么办：

```
interface IA{
    void foo();
}
class CA : IA{
    public void foo(){
        Console.Writeline("Class A");
    }
}
class CB : CA, IA{
    public new void foo(){
        Console.Writeline("Class B");
    }
} 
```

我猜 CB 应该在“直接实现的接口”中返回 IA，但是如果您将 CB 与 CA 进行比较，您会发现它们实现了相同的接口，因此查找差异的方法不起作用。
在疯狂寻找解决方案之前，您是否尝试过查看 MSIL 或从 Reflector 反编译的代码，看看这是否可行？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T18:34:45.737

```
 typeof("the object").GetInterfaces().Count==0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T16:00:30.477

只是一个想法...

您可以获取类的接口和基类的接口。然后得到差异。

**编辑：**

我已经检查了这个想法，有效：

```
public static Type[] GetDirectInterfaces(Type type)
{
    if (type.BaseType == null)
        return type.GetInterfaces();
    Type[] BaseInterfaces = type.BaseType.GetInterfaces();
    Type[] ThisInferfaces = type.GetInterfaces();
    return ThisInferfaces.Except(BaseInterfaces).ToArray();
} 
```

如果接口的数量很大并且执行时间很关键，您可以创建一个单独的带有字典的静态类来缓存结果。

# iphone - 具有触摸功能的 NSTimer？任何其他选项

> ID：537424
> 
> 赞同：0
> 
> 时间：2009-02-11T15:52:33.757
> 
> 标签：iphone, nstimer

我正在创建我的第一个 iphone 应用程序，在这里需要帮助。我的编程背景不是 C，我有点迷茫。

基本上我希望我的应用程序做的是显示随机位图并让用户触摸单个位图并验证它们。我用来显示位图的方法是 NSTimer 和 UIImage 用于实际位图。到目前为止，它在显示位图时工作正常。但我被困在下一步，即注册触摸的位图。我尝试在位图上使用标记，然后使用 touchesBegan 函数。每次触摸屏幕时都会出现运行时错误（我认为。）

我的问题是： 1\. 鉴于我的要求，我使用的方法是一种好方法，甚至在技术上可行吗？2\. 如果 q#1 的答案是否定的，您有替代解决方案吗？

谢谢，感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T16:10:32.590

如果您在`touchesBegan:`函数中遇到异常，那么您的代码中就有错误。如果您使用调试器运行您的应用程序，它应该会准确地告诉您问题发生在哪一行代码上。如果我不得不猜测，我会说您正在尝试向不处理该消息的对象发送消息，这会引发异常。

确保您的代码在没有任何警告的情况下进行编译——您可能在某处的函数名中有拼写错误。如果您拼错了消息名称，它仍然可以正确编译，但是当您尝试发送该消息时，它会在运行时抛出异常。

# iphone - Halting In Progress CAKeyframeAnimation

> ID：537425
> 
> 赞同：10
> 
> 时间：2009-02-11T15:52:41.120
> 
> 标签：iphone, cocoa, core-animation

I'm animating a UIView's frame property using a CAKeyframeAnimation on the view's CALayer and animating the "position" property. I'd like to be able to halt the animation at it's current state when the user taps the screen, but I'm unable to do so.

I can halt the animation easily enough by calling

```
[view.layer removeAnimationForKey:kFrameAnimationKey]; 
```

The problem is that neither the view's frame not it's layer's position are updated directly by the animation. If I look at the position property at the time the animation starts and when it ends in

```
- (void)animationDidStop:(CAAnimation *)animation finished:(BOOL)finished 
```

it has not changed.

It seems that you need to do that explicitly when the animation stops. But if the animation stops at some arbitrary point, you don't know how far it's gone. So the question is either how to make the animation update the layer's position property as it goes, or how to know how far the animation has gone when it's been stopped.

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-11T17:49:57.593

You can achieve this halting of the animation by grabbing the presentationLayer of your animating UIView's layer, then applying its frame to your UIView before removing the animation. For example:

```
movingView.frame = [[movingView.layer presentationLayer] frame];
[movingView.layer removeAnimationForKey:@"movementAnimation"]; 
```

This seems to provide the freezing of the UIView at the current animated position you're looking for.

# .net - 我应该如何为项目选择合适的技术和平台？

> ID：537427
> 
> 赞同：-2
> 
> 时间：2009-02-11T15:53:00.400
> 
> 标签：.net, php, mysql, sql-server, asp.net-mvc

以下是我正在开始的一个新项目的一些（当然可能还有更多）指导原则。

*   可寻址的 URL
*   非常快
*   移动 - 迎合 iPhone 和其他智能设备
*   使用现有的社交网络
    *   居住
    *   Facebook
    *   领英
    *   推特
    *   克雷格列表
    *   等等。
*   使用现有的 ID 服务
    *   现场身份证
    *   打开身份证
    *   等等。
*   客户端和在线管理应用程序
*   定位许多设备
*   强大而灵活的报告
*   强大而灵活的过滤条件和搜索
*   自我维护；不需要大量管理
*   基于服务
*   API，以便其他人可以利用我们的服务（需要付费）
*   轻松导入和导出数据

我很好奇 - 鉴于这些原则，您将如何确定用于构建此项目的适当技术？.NET 还是 PHP？SQL Server 还是 mySQL？Silverlight 还是 Flash？我肯定有自己的个人喜好，但我不希望这影响我的判断。我想为项目使用正确的工具和技术。

有什么想法和/或建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T15:57:10.577

看起来你正在寻找一把金锤。没有一个。由您决定哪个最适合该项目。.net / php 能够处理所有这些。

如果你想要一个真正的 iPhone 应用程序，自然这些都不行。但是，当您谈论 Web 平台时，输出到设备只是检测设备并相应地渲染视图的问题。

如果您计划发布到多个域，您可能需要查看[XML 和 XSLT 。](http://www.w3.org/TR/xslt)它可以简化获取您的应用程序数据和呈现视图以及将它们分开用于各个设备等的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:38:54.783

好的，这是基本答案：您可以在 .NET、PHP、Java 或 Python 中破解它。在其中，您会发现任意数量的框架。这些框架中的大多数都已准备好生产。

因此，您和您的团队知道或喜欢什么成为一个大问题。学习一个完全不同的框架需要时间。通常，个人偏好将被证明是决定性因素。

但是，有一个主要因素需要考虑：成本。虽然 .NET 可能拥有所有环境中最好的工具，但它与 Windows 紧密相关。如果您计划在服务器场中使用 100 台机器，则需要计算运行最终解决方案的年同比成本。

最后，阅读[Release It](http://www.amazon.co.uk/gp/product/0978739213?ie=UTF8&tag=colocodi-21&linkCode=as2&camp=1634&creative=19450&creativeASIN=0978739213)。如何监控和检测代码的问题可能比您提到的任何功能都更重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T15:58:20.310

不懂 PHP（也不喜欢它），所以只能对 ASP.NET 说：

*   可寻址的 URL - ASP.NET MVC（和 System.Web.Routing）可以做到这一点
*   非常快 - 取决于您（Stack Overflow 非常快，请自行查看）
*   移动 - 再次由您决定
*   使用现有的社交网络 - ASP.NET 可以做到这一点
*   使用现有的 ID 服务 - 也可以这样做
*   客户端和在线管理应用程序 - ?
*   定位许多设备 - 可以做到这一点
*   强大而灵活的报告 - 可以做到
*   强大而灵活的过滤条件和搜索 - Lucene.NET Rocks
*   自我维护；不需要大量管理 - ？
*   基于服务 - 取决于您对“基于服务”的定义
*   API 以便其他人可以利用我们的服务（需要付费） - ASP.NET 可以做到这一点
*   轻松导入和导出数据 - 取决于它是什么数据

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T16:05:30.883

这是那些经典的“取决于”问题之一。您当然希望消除对您的项目明显错误的技术——您知道，例如 ActiveX 用于您希望 Mac 用户能够使用的网站 :-)

但是消除不匹配非常容易。之后的事情是相当主观的。缩小范围的唯一方法是做出一些选择。例如：支持广泛的移动设备。究竟是哪些？如果您想针对多个平台，您几乎可以肯定是在谈论一个网络应用程序——也许您已经决定了。

除了你的要求的细节，这应该有助于缩小范围，对我来说，问题是，谁来实际编写代码？尽最大努力利用那些人已经知道的东西是有意义的。

简而言之，很难在真空中回答“最佳”问题。将有十几种工具和技术的组合可以满足您的需求。要在其中进行选择，您需要使用您的特定要求和资源来减少列表。

# vim - 重定向到 Vim 中的搜索文件

> ID：537431
> 
> 赞同：5
> 
> 时间：2009-02-11T15:53:31.803
> 
> 标签：vim

我的问题很简单。我在文件中搜索特定模式（比如说 Tex 文件中的标签）

```
:g/label/# 
```

但是有很多情况。所以我想将此输出重定向到另一个文件以便能够轻松使用它。

你有我不知道的技巧或命令吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-13T08:58:07.787

从原始帖子中不清楚您所说的“轻松使用它”是什么意思，但在不将匹配“提取”到单独的缓冲区的情况下，查看并在缓冲区中的所有匹配之间快速跳转通常很有用。

vim 内置了一个内部 grep。您的示例将是这样的（在 vim 中，`%`表示当前文件）

```
:vimgrep /label/ % 
```

这将带您到第一个匹配项并报告有多少匹配项。很酷的是，您可以通过使用打开快速修复错误列表来查看列出的所有匹配项

```
:cope 
```

现在，您只需滚动并按下`enter`一行即可跳转到匹配的确切位置。

如果您从 vim 内部运行 make 并且您的编译器抛出错误，则 quickfix 错误列表与您使用的缓冲区完全相同：它会为您提供错误的内容和位置的列表。

跳转到 quickfix 指向的位置后，您可以通过`:cn`和 在列表中前进和后退`:cp`。`:ccl`关闭错误列表。

您还可以通过`:vimgrepa /newpattern/ %`或扩展您的“错误”列表`:vimgrepadd`

（记录在案的）警告是 vim 的内部 grep 比大多数本机 grep 实现慢（但你确实在 Windows 中“免费”获得它，例如）。如果您确实安装了 grep，则可以使用 :grep 而不是 :vimgrep 来获得类似的结果。

引用`:help grep`

> Vim 有两种方法来查找模式的匹配项：内部和外部。内部 grep 的优点是它适用于所有系统并使用强大的 Vim 搜索模式。当 Vim grep 不能满足您的要求时，可以使用外部 grep 程序。
> 
> 内部方法会更慢，因为文件被读入内存。优点是： - 自动识别行分隔符和编码，就像正在编辑文件一样。- 使用 Vim 搜索模式。可以使用多线模式。- 启用插件时：可以搜索压缩文件和远程文件。

如果您已经在使用错误列表来处理编译错误，您也可以使用位置列表。只需将`l`(for `location`) 添加到 grep 命令 ( `:lvimgrep`, `:lvimgrepa` `:lgrep`, `:lgrepa`) 的开头并使用`:lopen` `:ln` `:lp` `:lcl`而不是`:c*`那些。

更多命令请咨询

```
:help grep
:help quickfix-window 
:help quickfix
:help quickfix-error-lists 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T23:48:49.677

```
:redir > matches.txt|execute 'g/foo/#'|redir END 
```

看`:h :redir`，你还可以重定向到寄存器、变量、剪贴板等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T15:57:53.820

您所做的实际上是命令行中的“grep -n label *file* ”。因此，您可以轻松地运行该命令并将其 > 放入文件中。

'grep'的派生甚至来自基本相同的来源。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T16:09:36.973

我在某个时候得到了这个网络：

```
function GoToLine(mainbuffer)
   let linenumber = expand("<cword>")
   silent bd!
   silent execute "buffer" a:mainbuffer
   silent execute ":"linenumber
   silent nunmap <Enter>
endfunction
command -nargs=1 GoToLine :call GoToLine(<f-args>)

function GrepToBuffer(pattern)
   let mainbuffer = bufnr("%")
   silent %yank g

   enew
   silent put! g
   execute "%!egrep -n" a:pattern "| cut -b1-80 | sed 's/:/ /'"
   silent 1s/^/\="# Press Enter on a line to view it\n"/
   silent :2

   silent execute "nmap <Enter> 0:silent GoToLine" mainbuffer "<Enter>"
   " silent nmap <C-G> <C-O>:bd!<Enter>
endfunction
command -nargs=+ Grep :call GrepToBuffer(<q-args>) 
```

把它放在你的 .vimrc 中，然后 :Grep Foo

需要外部 grep 程序才能正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T17:12:06.887

（只是一个想法——未经测试。）

您可以删除其中包含您的模式的所有行，写入另一个文件，然后撤消删除。

```
:g/label/d
:w matches
u 
```

# linux - Linux 中的 /tmp 可以填满吗？

> ID：537437
> 
> 赞同：8
> 
> 时间：2009-02-11T15:54:37.417
> 
> 标签：linux

我将一些文件放在 Web 服务器上的 /tmp 中，Web 应用程序在有限的时间内使用这些文件。如果在用户退出使用应用程序后文件留在服务器的 /tmp 中并且这种情况反复发生，我是否应该担心目录已满？我在网上读到重新启动会清除 /tmp 目录，但是这个框并没有重新启动很多。

汤姆

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-11T15:58:45.380

是的，它会填满。考虑实施一个将在一段时间后删除旧文件的 cron 作业。

这样的事情应该可以解决问题：

```
/usr/bin/find /tmp/mydata -type f -atime +1 -exec rm -f {} \; 
```

这将删除修改时间超过一天的文件。

或作为 crontab 条目：

```
 # run five minutes after midnight, every day
   5 0 * * *       /usr/bin/find /tmp/mydata -type f -atime +1 -exec rm -f {} \; 
```

其中 /tmp/mydata 是您的应用程序存储其临时文件的子目录。（正如其他人在此处指出的那样，仅删除 /tmp 下的旧文件将是一个非常糟糕的主意。）

查看 crontab 并查找手册页以了解详细信息。不要在不了解所有细节的情况下运行删除文件系统上文件的脚本——这就是好的服务器发生的坏事。:)

当然，如果您可以修改您的应用程序以在完成临时文件后删除它们，那通常是一个更好的解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T16:00:00.727

您唯一可以写入而不用担心它会填满的是*/dev/null*。如果你继续往里面倾倒东西，其他所有东西最终都会用完空间。

一种简单的方法是让 cron 作业清理所有比几天旧**的** */tmp文件。*

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T17:32:59.053

您不能盲目地删除一段时间内未修改的所有内容。许多程序在那里存储套接字，这些套接字永远不会被修改，但仍然是程序工作的一个组成部分。以我的一台服务器上的 mysql 为例：

```
srwxrwxrwx    1 mysql    mysql           0 Sep 11 04:01 mysql.sock= 
```

这是 /tmp 中有效的工作“文件”。它只是看起来很旧，因为 mysql 有一段时间没有重新启动。要么使用“-type f”或“-atime”限制您的查找，要么使用其他人提到的发行版提供的工具之一。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T15:56:14.120

是的，它将链接到您的磁盘/分区之一，并且可以填满。它在重新启动时被删除。

当用户退出应用程序时，您应该在它们之后清理文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T16:10:28.127

您的网络应用程序使用哪种语言？许多语言提出临时文件：

*   [C](http://www.cplusplus.com/reference/clibrary/cstdio/tmpfile.html)
*   [Python](http://docs.python.org/library/tempfile.html)
*   [php](http://fr2.php.net/manual/en/function.tmpfile.php)
*   ...

如果有这样的功能，请用您的语言搜索。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T18:54:16.470

只是一个警告：并非所有 Linux 安装在每次重新启动后都会清理 /tmp 目录

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T16:07:17.403

一些 linux 发行版有一个包，可以为你清理 /tmp 中的旧文件。如上所述，实现自己的并不难。需要注意的一件事是长时间运行的进程，尤其是“僵尸”，它们已经死亡但自己还没有完成清理。如果一个进程打开了一个文件，仅仅从 /tmp 中删除它并不会真正回收它的空间 - 你必须终止该进程或以某种方式强制它关闭文件。许多写入日志或临时文件的程序旨在捕获信号（通常是 SIGUSR1）并因此关闭并重新打开任何日志或临时文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T16:08:58.740

许多 Linux 发行版包含名为“tmpwatch”的东西，或类似的东西，它通过 cron 运行并删除预定义梯度上的东西。有些足够聪明，可以被文件的所有者所拥有.. 守护程序用户拥有的东西比普通用户拥有的东西被清理得更快。检查邮件列表以查找您选择的发行版。

不过，您应该有 SNMP 或其他类型的监视器来监视有多少可用空间，如果它填满了像 Apache 这样的服务不会很高兴。例如，PHP 的 e-accelerator 需要足够的空间，一些邮件扫描仪无法正确清理，等等。

# c# - 在 c# 中使用隐式类型的可空变量？

> ID：537438
> 
> 赞同：8
> 
> 时间：2009-02-11T15:54:44.187
> 
> 标签：c#, .net-3.5, nullable, var

反正有 var 是可以为空的类型吗？

这将 i 隐式类型为 int，但是如果我想要一个可为空的 int 怎么办？

`var i = 0;`

为什么不支持这个：

`var? i = 0;`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T16:00:31.897

`var`由赋值右侧的表达式或常量隐式键入。 `var`本身不是一种类型，因此`Nullable<var>`是不可能的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T15:58:09.157

为什么要支持？如果这就是你的意思，你应该说`var i = (int?)0;`。

（好吧，您可能应该只说`int? i = 0`，但对于更复杂的类型等）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T16:02:39.533

该问题涉及可空类型。

例如，您不能创建可为空的字符串，这反过来又会阻止您创建可为空的 var，因为 var 可能是字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T16:09:52.450

我的回答是这样的。“var”是隐式类型的。它通过赋值右侧提供的值确定它是什么类型。如果你告诉它它是可空的，它就不知道是什么类型。请记住，一旦分配，这就是它将永远存在的类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T16:24:33.973

试试这个 - 这就是你在说的吗？

```
 static void Main(string[] args)
    {
        for (int i=0; i < 10; i++)
        {
            var j = testMethod();
            if (j == null)
            {
                System.Diagnostics.Debug.WriteLine("j is null");
            }
            else
            {
                System.Diagnostics.Debug.WriteLine(j.GetType().ToString());
            }
        }
    }

    static int? testMethod()
    {
        int rem;
        Math.DivRem(Convert.ToInt32(DateTime.Now.Millisecond), 2, out rem);
        if (rem > 0)
        {
            return rem;
        }
        else
        {
            return null;
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-01T20:57:07.177

VAR 是编译器在编译时确定的隐式类型。它是在首次使用时分配的。IE 当您设置 var I = 1 时，var 是一个 int，因为这就是数字 1 的含义。如果你有 var I = SomeFunction() ，其中某个函数返回一个可为空的 int ，而不是 I 将被设置为 int?。现在，在您想要控制变量类型的情况下，不应使用上述 var 。

所以底线，根据你的例子，使用 var 是错误的，应该明确设置为 int？从头开始。

*   达罗尔

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-24T15:19:42.240

在这种情况下，我什至不会使用 var 。如果它是复杂类型或简单类型（例如 int），我将使用类型“对象”。

例子：

```
//Define all global class variables
List<int> m_lInts = New List<int>();
List<string> m_lStrs = New List<string>();

public static object FindMyObject(string sSearchCritera)
{
  //Initialize the variable
  object result = null;

  if (result == null)
  {
    //Search the ints list
    foreach(int i in m_lInts)
    {
      if (i.ToString() == sSearchCritera)
      {
        //Give it a value
        result = (int)i;
      }
    }
  }

  if (result == null)
  {
    //Search the ints list
    foreach(string s in m_lStrs)
    {
      if (s == sSearchCritera)
      {
        //Give it a value
        result = (string)s;
      }
    }
  }

  //Return the results
  return result;
} 
```

# c# - 在 ac# 表单上捕获关闭事件

> ID：537453
> 
> 赞同：3
> 
> 时间：2009-02-11T15:57:02.153
> 
> 标签：c#, forms

嘿！我不是想在这里碰运气，但我还有另一个 c# 问题。我已经尝试了使用 google 找到的所有可能的事件。这是代码：

```
 private void Form1_OnClose()
        {
            MessageBox.Show("I was closed -2");
        }

        private void Form1_Exit(object sender, EventArgs evArgs)
        {
            MessageBox.Show("I was closed -1");         
        }
        private void Form1_Closing(object sender, System.ComponentModel.CancelEventArgs e)
        {
            MessageBox.Show("I was closed 0");
        }     

        private void Form1_Closed(object sender, EventArgs e)
        {
            MessageBox.Show("I was closed 1");
        }
        private void Form1_FormClosed(Object sender, FormClosedEventArgs e)
        {

            MessageBox.Show("I was closed 2");
        } 
```

当我执行 Alt+f4 或单击 X 按钮时，这些都不会触发任何东西。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-11T16:00:22.940

您可能缺少实际的订阅代码，大致如下：

```
this.Closing += Form1_Closing; 
```

相反，尝试覆盖*OnXXX*方法 - 这是做事的首选方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T16:03:49.750

该错误很可能是您没有在正确的时间连接事件。检查您的 program.cs 文件。它应该看起来像这样：

```
using System;
using System.ComponentModel;
using System.Threading;
using System.Windows.Forms;
namespace Test
{
    internal class Program
    {
        private static void Main(string[] args)
        {
            Form form = new Form2();
            form.Closing += form_Closing;
            Application.Run(form);
        }
        private static void form_Closing(object sender, CancelEventArgs e)
        {
            MessageBox.Show("Closing");
        }
    }
} 
```

我刚刚运行了这个，事件就被触发了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T16:01:32.877

这些方法实际上是否被分配为事件处理程序？进入设计模式，选择表单，然后单击属性窗口上方的小闪电。然后找到您想要的事件（可能正在关闭）并双击它。

# tdd - 如何对付那些破坏TDD的人？

> ID：537464
> 
> 赞同：5
> 
> 时间：2009-02-11T15:59:36.327
> 
> 标签：tdd

就我个人而言，我真的更喜欢单元测试并将它们编写为“良好”的覆盖范围。（假设我尽可能努力编写好的测试；）

像往常一样，一段时间后有人需要向代码中添加一些功能（向类添加方法等）。他没有破坏那些书面单元测试，但拒绝编写额外的（这将涵盖他编写的代码的那些额外功能）。这会导致 tdd 过程中出现一个大漏洞（更糟糕的是可能会出现破窗效应）

我能做些什么让他写那些测试？你怎么对付那些人？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-11T16:46:53.767

请记住，TDD 主要不是为了生成良好的单元测试覆盖率。首先是激励**良好的设计**，其次是确保您编写的代码符合您的期望，其次是提供高质量的测试。

当另一个程序员扩展一个类而不编写测试时，他们会错过这些好处，你应该同情他们。但是当你工作时，你会继续以你知道的最好的方式工作（首先测试），因为你知道你得到的解耦代码对消费者来说很容易，而且你的代码可以满足你的期望。

对你来说最大的痛苦是你必须小心你重构的东西：如果你正在重构正在测试的代码，你可以快速进行，并且设计将快速安全地改进。如果您正在重构未经测试的代码，您应该非常谨慎地重构它（也许只使用可靠的自动化工具来这样做）或添加测试。

最后，您将继续从使用 TDD 中受益，因为您可以更快地生成更清晰、正确的代码，而您的受 TDD 缺陷的同事将受到影响。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-17T04:24:33.097

不要将其视为对抗！你问的是如何强迫同事做一些他/她显然没有看到任何好处的事情。你不能让别人使用 TDD - 正如你自己已经看到的那样。开发人员接受 TDD 的唯一方式是当其他人帮助他们达到“啊哈！” 片刻。作为一个同事对另一个同事要尊重，并通过你的行动向他/她展示，并积极地希望帮助他/她克服精神障碍。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T16:39:15.577

**结对编程**。有两个人在做某事，程序员不太可能走这样的捷径。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T16:05:34.660

如果您有构建过程，则可以使用[NCover](http://www.ncover.com/)或[PartCover](http://sourceforge.net/projects/partcover/)之类的工具，如果覆盖范围不足，则构建失败。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-11T16:04:18.970

除了公司政策和他们经理的反响之外，你无能为力。也许您的源代码控制工具中有某种方式要求任何公开的东西都有一个标记为这样的单元测试。

您甚至可以编写一个宏，它是您构建过程的一部分，用于查找任何标记为 PUBLIC（我是 VB 人员）的内容，然后检查以确保在解决方案中的某处有一个带有代码注释的单元测试，该代码注释可以充分链接它。未能进行相关的单元测试会破坏构建并向整个开发组发送一封电子邮件，这足以让非测试人员感到羞耻。

也许我会在这里设置它，现在我考虑一下......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T16:07:44.000

使用一些工具跟踪代码覆盖率，例如对于 Java，有 Emma，并为每个版本生成管理报告。当数字太低或下降时，管理层应调查原因。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-06T18:47:44.580

以身作则。您的同事可能根本不了解如何正确使用 TDD。下次发生这种情况时，为他们编写一个单元测试。一定要向他们指出这一点：“嘿，我注意到你在没有单元测试的情况下向程序添加了*x*特性，所以我为你写了一个并将它放在这里。” 这样他们就有了一个例子，并且不会因为不得不询问如何进行单元测试而感到尴尬。

只做一次或两次。之后，请务必提及任何未来发生的事情。你会惊讶于礼貌的“嘿，你没有为函数*y*编写单元测试，如果你为我编写一个单元测试真的会帮助我”会产生的差异。请记住，您的目标不是*让*他们编写测试。这是为了让编写测试比不编写测试更容易。

如果上述方法不起作用，是时候与管理层讨论了。你已经尝试友好地解决这种情况，所以是时候考虑一​​种不太友好的方法了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-06T18:33:12.823

教你的同事如何做 TDD，这样他们就可以颠倒他们的大脑（我第一次尝试 TDD 时就有这种感觉），并首先开始编写测试。

有一次我和一个不懂 TDD 的程序员朋友做了一个实验。我来到他家，我们开始使用 TDD 编写俄罗斯方块（那天我们花了大约 6 个小时，进展顺利）。首先我写了一个测试方法，然后他写了代码通过测试。一开始他有点反对写“最简单的可能工作的东西”（例如在第一个琐碎的测试中硬编码返回值）并且没有提前计划太多，但无论如何他都接受了它并按照我的指示进行。随着我们的进步，他似乎慢慢地开始理解这一切的意义所在。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-02-17T03:48:53.010

播放“别惹我兄弟！”的视频。作为警告的家伙

# javascript - 处理提交事件 - jquery

> ID：537475
> 
> 赞同：0
> 
> 时间：2009-02-11T16:01:57.383
> 
> 标签：javascript, jquery

我有一些 javascript，我正在尝试使用 jQuery 重新工具以更好地学习该库，并且我遇到了似乎是一个非常基本的问题。

html:

```
<form id="theForm">
What would you like to do?<br /><br />
<input type="text" id="doThis" /><br /><br />
</form> 
```

js：

```
$(document).ready(function() {
$("#theForm").submit(function(){
    var doThis = $("#doThis").value.toLowerCase();      
    alert(doThis);
});
}); 
```

任何人都可以就为什么这种非常简单的交互似乎无法正常工作提供一些建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T16:05:02.167

您需要使用[`val()`](http://docs.jquery.com/Attributes/val)jQuery 来获取值

```
$("#doThis").val().toLowerCase(); 
```

DOM 对象不容易从 中访问`$()`，它`[0]`由 jQuery 存储，因此如果您想以传统方式访问该值，您可以这样做：

```
$("#doThis")[0].value.toLowerCase(); 
```

此外，我认为在您的情况下表单不会因为 而立即提交`alert()`，但如果您不打算提交，您应该`return false;`停止提交。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-11T16:03:58.283

```
$("#theForm").submit(function(){
        var doThis = $("#doThis").value.toLowerCase();          
        alert(doThis);
return false
}); 
```

?

# crystal-reports - 合并 Crystal 中的字段以生成图表

> ID：537476
> 
> 赞同：0
> 
> 时间：2009-02-11T16:01:58.867
> 
> 标签：crystal-reports

任何人都知道是否有一种方法可以在 Crystal 中合并多个字段（它们具有相同的可能值），以便它们可以在图表中一起使用？

例如：Field1、Field2 和 Field3 的值都只有 1 或 2。我想将这 3 个字段中的所有值合并在一起，以显示总共有多少个 1 与 2 的组合。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T16:48:46.053

使用公式和图表。您可以在公式中执行任何您想要的操作。

# wpf - WPF中组合框的属性

> ID：537502
> 
> 赞同：0
> 
> 时间：2009-02-11T16:07:35.780
> 
> 标签：wpf, combobox

为什么我不能以编程方式设置 selecteditem 属性？

我从另一个 XAML 窗口调用它，该窗口具有一定的控制，其中一个是我正在尝试的 ComboBox：

```
 string tm = (from ea in db.EXAMENXATENCIONs where ea.codigo == Convert.ToInt32(numeroinforme) select ea.turnomedico).FirstOrDefault();
            demo.cboTurnoMed.SelectedItem  = tm;
            demo.cboTurnoMed.Text =  tm; 
```

C# 3.5

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T16:11:25.707

我不确定您的 ComboBox 中有什么类型的对象，但您可以尝试设置 SelectedValue 而不是 SelectedItem。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:17:39.467

您尝试设置的项目是否在`ComboBox`数据源中也被选中？
该`SelectedItem`属性会查找您在数据源中提供的值，然后在找到时选择它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T16:23:08.113

您可以设置 SelectedItem。但对象必须匹配。它们不能只是拥有相同的数据，它们实际上必须是同一个对象。

当您设置 SelectItem 属性时，您正在执行的操作是：“您（组合框）有一组对象，我希望您列表中的这个特定对象成为选定对象”。如果可以清除它，您实际上并没有给组合框一个新项目。

# sql-server-2005 - 如何让 SQL 2008 报告服务安全地用于多个应用程序？

> ID：537511
> 
> 赞同：0
> 
> 时间：2009-02-11T16:09:59.813
> 
> 标签：sql-server-2005, sql-server-2008, reporting-services

我们有一个设置，我们有一个应用程序的多个实例——每个客户一个实例。

我们通过 URL 调用很多报告，在查询字符串中传递参数。

早些时候，当我们在 2005 年时，我们发现了一个问题：我可以稍微更改我的查询字符串并获取其他人的数据。

我们通过欺骗用户解决了这个问题。

现在，由于我们的 2005 报告服务安装中存在一些间歇性不稳定，我们正趁机升级到 2008。但是，欺骗情况似乎不再起作用。

看起来相关的 technet 文章似乎说我们需要创建一个非常大的安全扩展（[文章](http://technet.microsoft.com/en-us/library/ms160724.aspx)）。这似乎有点矫枉过正。当然，有一种更简单的方法可以调用基于 URL 的报告。

您是如何在您的应用程序中实现这一点的？

**注意：**这是我同事问题的转贴（转述）。他没有得到任何答案，而且由于他没有任何声誉，他无法尝试赏金系统。我重新措辞并决定试一试。请宽容——我们真的需要一个答案。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-13T05:12:07.893

我很好奇，你在 2005 年为用户欺骗做了什么而在 2008 年不起作用？

但对于真正的问题，在我看来您可能应该使用自定义身份验证。您链接到的示例实际上很好地解释了正在发生的事情并指导您完成基础知识。我遇到了与您类似的问题，我们有许多客户访问报告，并且一个客户无法访问另一个客户的数据*非常重要。*

我最终编写了一个自定义身份验证扩展，它创建客户端特定的文件夹和权限，只有客户端特定的用户（我通过自定义身份验证设置）浏览器访问该文件夹中的所有报告。

如果您正在编写一个位于 /Reports/ 区域之外的应用程序，我还建议您查看[http://www.gotreportviewer.com/ 。](http://www.gotreportviewer.com/)不幸的是，我在自定义身份验证方案上投入了太多时间后才知道这存在。

祝你好运！

# loadrunner - Loadrunner 脚本的多项操作？

> ID：537520
> 
> 赞同：-3
> 
> 时间：2009-02-11T16:11:26.923
> 
> 标签：loadrunner

有 init、action 和 end 函数。是否可以有多种操作方法？我希望它在单独的执行线程上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-10T10:22:22.040

在 VuGen 中添加操作很容易，但它不允许您在同一个 vuser 中并行执行它们。如果你想并行执行，你需要在控制器上为脚本运行多个 vuser。

在 vuser 中实例化新线程非常困难，并且需要您使用 Win API 来创建线程 - 绝对不推荐。

如果您希望并行执行 2 个不同的操作，请改用多个脚本。您将无法在 vuser 之间共享变量或数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:31:25.410

是的，您可以有多个操作。录制时，您可以从 VUGen 工具栏指定新操作。您也可以将所有内容记录到“动作”中，然后编辑脚本并创建自己的动作并将代码粘贴到那里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-18T11:59:32.083

至于其他操作，您可以编辑 LR 配置，即 default.usp 和您的 [project].usr 文件。我可以从一开始就说，尽管弄乱配置文件可能是***有风险***的，如果这样做，请先备份文件或项目并谨慎行事。

也就是说，这似乎确实克服了未启用“创建新操作”的问题（尽管我很想知道导致该问题的一系列情况 - @TheBlastOne 表明它与使用的协议有关）。

无论如何，编辑您的 default.usp 为您的新操作（例如 Action2）添加一个 RulLogicRunRoot 条目，并在 LR 执行生命周期中对其进行配置，如下所示：

**默认.usp**

```
[RunLogicRunRoot:Action2]
MercIniTreeSectionName="Action2"
RunLogicObjectKind="Action"           <-- "Action" in this case means LR object type
Name="Action2"
MercIniTreeFather="RunLogicRunRoot"
RunLogicActionType="VuserRun"
...
Profile Actions name=vuser_init,Action,Action2,vuser_end
...
RunLogicActionOrder="Action,Action2"
...
MercIniTreeSons="Action,Action2" 
```

不确定您需要编辑多少 [project].usr 文件，但无论如何您都应该为新操作定义操作和解释器：

**[项目].usr**

```
[Actions]
vuser_init=vuser_init.c
Action=Action.c
Action2=Action2.c
vuser_end=vuser_end.c
...
[Interpreters]
vuser_init=cci
Action=cci
Action2=cci
vuser_end=cci
... 
```

我不确定需要多少以下内容，但为每个条目创建一个条目（根据操作脚本）可能是明智的：

```
[Recorded Actions]
...
[Replayed Actions]
...
[Modified Actions] 
```

最后，不要忘记在您的项目目录中创建一个 Action2.c（具有适当命名的函数以避免与 Action.c 冲突）。在 LR 中重新打开您的项目，它应该在您的脚本视图中包含 Action2。

NB 抱歉，但我无法回答您关于线程的问题……还没有那么先进。

# python - 标准python解释器有vi命令模式？

> ID：537522
> 
> 赞同：31
> 
> 时间：2009-02-11T16:11:44.397
> 
> 标签：python, vi

我在 python 解释器（RHEL 5.3 上的 python 2.4）中工作了一下，突然发现自己处于“vi 命令模式”中。也就是说，我可以用典型的 vi 键绑定编辑以前的命令，用 h 向左，用 x 删除......

我喜欢它——唯一的是，我不知道我是怎么到这里的（也许是通过我导入的模块之一：pylab/matplotlib？）。

谁能阐明如何在解释器中启用此模式？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-11T20:18:07.360

[Ctrl-Alt-J 在readline 程序](http://tiswww.case.edu/php/chet/readline/rluserman.html#SEC22)中从 Emacs 模式切换到 Vi 模式。

或者将“设置编辑模式 vi”添加到您的 ~/.inputrc

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-02-11T16:32:38.887

这一切都取决于一些事情。

首先，python shell 使用 readline，因此，你`~/.inputrc`在这里很重要。这与 PostgreSQL 命令行解释器 psql 和 MySQL shell 相同。所有这些都可以配置为使用 vi 风格的命令绑定，以及历史记录等。

`<ESC>`将编辑模式设置为 vi 后，将在 python shell 中将您置于 vi 模式

您可能需要在您的`~/.inputrc`

```
set editing-mode vi 
```

**OSX 信息**

OSX 使用 libedit，它使用 ~/.editrc。您可以*man editrc*了解更多信息。

例如，要模仿在您的历史记录中搜索的流行组合键，您可以将以下内容添加到您的 .editrc

```
bind "^R" em-inc-search-prev 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-04-22T21:01:20.573

对于 Mac OS X 10.10.3、python2.7，可以`vi`通过将`bind -v`. `~/.editrc`手册页的最后几段暗示了这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-04-01T19:22:22.307

使用[readline.parse_and_bind](https://docs.python.org/3/library/readline.html#readline.parse_and_bind)方法。例如，在 python 交互式控制台上尝试：

```
import readline
readline.parse_and_bind("set editing-mode vi") 
```

似乎您可以在 .inputrc 中设置的任何命令也可以通过此方法设置。我在 Python 2.7 和 3.5.1 中尝试过。

也可以看看`man readline`

* * *

**编辑** *（2019 年 12 月 21 日）*：或者，要拥有真正的 vim，您可以设法用[Athame](https://github.com/ardagnir/athame)修补 python 的 readline 。我用 bash 完成了它，它非常酷。

# c# - C# 中事件处理的首选方法是什么？

> ID：537524
> 
> 赞同：3
> 
> 时间：2009-02-11T16:13:00.163
> 
> 标签：c#, winforms, event-handling

这是在 .NET 中处理事件的首选/推荐方式：

```
this.Load += new EventHandler(Form1_Load);
private void Form1_Load(object sender, EventArgs e)
{ } 
```

**或者**

```
protected override void OnLoad(EventArgs e)
{
    base.OnLoad(e);
} 
```

每种方法的优缺点是什么？多年来我一直使用这两种方法，并且通常更倾向于第一种方法，因为这是 Visual Studio 自动创建的用于处理事件的方法。我缺少的第二种方法有什么好处吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T16:21:40.627

第一种方法是微软建议的。模式是：

1.  一些代码想要引发一个事件，调用 OnXxx
2.  OnXxx 调用代理
3.  调用有线事件处理程序

如果您执行第二个模型，您可能会忘记 base.OnXxx 调用并破坏所有内容。选项 2 的优点是您可以决定是在所有其他事件处理程序之前还是之后调用您。如果您将代码放在 base.OnXxx 之前，您会在事件发生之前被执行。当然，第一个模型总是可以使用的，第二个模型只有在你继承引发事件的类时才可以使用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T16:20:04.220

这完全取决于您想在哪里捕捉事件以及为什么。

第一种方法（连线）用于当您希望*其他类*处理事件时。出于多种原因，您可能需要这样做；另一个类可能有权访问执行某些复杂逻辑或其他什么的服务。关键是当您希望单独的观察者响应事件时使用第一种方法。

第二种方法（覆盖）用于当您希望表单响应时，因为它可以；因为它的责任是本地的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T16:31:48.683

虽然不是最初的问题，但我想指出：

```
this.Load += new EventHandler(Form1_Load); 
```

可以写成：

```
this.Load += Form1_Load; 
```

推断委托构造。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T16:46:26.637

没有硬性规定，但两种方法都有陷阱。你选择一个你可以轻松避免的。

**代表们**

许多开发人员将 += 代码放在可以重复调用的地方。至少很多新手都会这样做。因此，所有者控件维护的委托列表中将有“n”个条目，并且所有条目都被调用。避免的简单方法是将 += 调用放在构造函数类型的地方，它只被调用一次。

**OnXXXX**

风险在于忘记调用 base.XXX 方法。这是错误的常见来源，如果您错过调用基类版本，大多数 Windows 程序员都会意识到这些问题 - 这对于 Windows 消息（绘制等）的情况尤其如此。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-11T16:17:19.390

重写的方法是可取的，因为它将被调用~~多态的~~几乎由CLR。

[编辑] 这就是为什么我认为重写方法更可取的原因：

这是一个简单的例子：

```
class Foo
{
    public event EventHandler Changed = delegate { };

    protected virtual void OnChanged()
    {
        this.Changed(this, EventArgs.Empty);
    }
}

class Bar : Foo
{
    public Bar()
    {
        this.Changed += new EventHandler(this.Bar_Changed);
    }

    void Bar_Changed(Object sender, EventArgs e) { }
}

class Baz : Foo
{
    protected override void OnChanged() 
    { 
        base.OnChanged();
    }
} 
```

现在我相信这`Baz`是更好的实现，这就是原因。 `Bar`必须执行以下 IL 指令来连接事件：

```
 L_000a: ldftn instance void Bar::Bar_Changed(object, class [mscorlib]System.EventArgs)
    L_0010: newobj instance void [mscorlib]System.EventHandler::.ctor(object, native int)
    L_0015: call instance void Foo::add_Changed(class [mscorlib]System.EventHandler) 
```

我们必须创建一个委托来处理方法，一个实例`EventHandler`然后`add_Changed`在基类中调用事件上的方法。虽然这些不是性能杀手，但之前的代码都不需要`Baz`工作。由于任何调用`OnChanged`都是虚拟的，唯一的性能损失将是 CLR 在继承链中找到正确的实例方法来调用。

# project-management - 您是否夸大了您预计的项目完成日期？

> ID：537526
> 
> 赞同：71
> 
> 时间：2009-02-11T16:13:51.833
> 
> 标签：project-management, project-planning, estimation

如果是，为什么？多少？

我倾向于夸大我的一点，因为我可能过于乐观。

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2009-02-11T16:16:57.270

**Hofstadter 定律**：任何计算项目所花费的时间都是您认为的两倍——即使您考虑了 Hofstadter 定律。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-02-11T16:17:29.123

如果您根据过去的经验夸大您的估计以试图弥补您固有的乐观情绪，那么您并没有夸大。您正在尝试提供准确的估计。但是，如果您充气以使您始终有绒毛时间，那可不太好。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2009-02-11T16:15:54.153

哦，是的，我学会了总是将我的初始估计乘以 2。这就是为什么[FogBUGZ 的基于证据的调度](http://www.fogcreek.com/FogBUGZ/LearnMore.html?section=PredictShipDates)工具非常有用的原因。

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2009-02-17T04:37:48.227

任何要求其程序员为粗粒度特性估计时间的组织从根本上被破坏了。

破解步骤：

1.  聘请技术项目经理。如果需要，开发人员可以兼任这些人。
2.  任何功能请求、更改请求或错误进入数据库时​​立即将其放入数据库。（我的组织使用 Trac，它并不完全糟糕。）
3.  让您的 PM 将这些请求分解为每个需要一周或更短时间的步骤。
4.  在每周一次的会议上，您的 PM 决定他们希望在这周完成哪些工单（可能来自市场营销等的投入）。他们将这些票分配给开发人员。
5.  开发人员尽可能多地完成分配的工单。和/或，他们与 PM 争论他们认为持续时间超过一周的任务。根据需要调整、拆分、重新分配票证等。
6.  每周都会编写和检查代码。QA 总是有事可做。优先级最高的更改首先完成。营销人员确切地知道即将发生的事情以及时间。最终：
7.  您的公司处于软件项目 20% 成功率的右侧。

这不是火箭科学。关键是第 3 步。如果营销想要一些看起来很复杂的东西，你的 PM（有开发人员的输入）会弄清楚第一步需要不到一周的时间。如果 PM 不是技术性的，那么一切都会丢失。

这种方法的缺点：

1.  当营销人员询问“获得 [X] 需要多长时间？”时，他们没有得到估计。但我们都知道，他们也知道，他们之前得到的估计纯属虚构。至少现在他们每周都可以看到证据表明 [X] 正在开发中。
2.  作为开发人员，我们每周工作的选择更少。这无疑是真的。不过有两点：首先，优秀的团队让开发人员参与决定分配哪些票证。其次，IMO，这实际上让我的生活变得更好。

没有什么比在 1 个月的时候意识到我给出的 2 个月的估计是完全不合适的，但不能改变，因为它已经在官方营销文献中更令人沮丧。要么我通过改变我的估计、冒着差评和/或错过奖金的风险来惹恼上级，要么我做了很多无薪加班。我已经意识到，大量的加班并不是一个糟糕的开发人员的标志，也不是一个“热情”的人的标志——它是一种有毒文化的产物。

是的，很多这些东西都包含在（各种）XP、“敏捷”、SCRUM 等之下，但实际上并没有那么复杂。你不需要一本书或顾问来做这件事。你只需要公司的意愿。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2009-02-11T19:30:34.387

斯科蒂法则：

*   做出最好的猜测
*   四舍五入到最接近的整数
*   ~~两倍的~~四倍（感谢亚当！）
*   增加到下一个更高的计量单位

例子：

*   你认为这需要 3.5 小时
*   四舍五入到 4 小时
*   四倍至 16 小时
*   将其延长至 16 天

达达！当你在不到 8 天的时间内完成它时，你就是一个奇迹创造者。

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2009-02-11T16:19:24.253

通常是的，但我有两种策略：

1.  始终将估计值提供为一个范围（即 1d-2d）而不是单个数字。数字之间的差异告诉项目经理您的信心，并允许他们更好地计划。
2.  使用[FogBugz 的 Evidence Based-Scheduling](http://www.fogcreek.com/FogBUGZ/LearnMore.html?section=PredictShipDates)或个人电子表格之类的东西，将您的历史估计与您实际花费的时间进行比较。这会给你一个比总是加倍更好的主意。尤其是因为加倍可能还不够！

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2009-02-11T18:51:13.310

我将能够在 3-6 周内回答这个问题。

* * *

## 回答 #8

> 赞同：23
> 
> 时间：2009-02-11T16:25:54.410

它不被称为“膨胀”——它被称为“使它们遥不可及”。

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2009-02-11T16:15:20.907

采取任何你认为合适的估计。然后加倍。

* * *

## 回答 #10

> 赞同：17
> 
> 时间：2009-03-14T00:08:07.987

不要忘记您（工程师）实际估计理想时间（scrum 术语）。

而管理层在实时工作。

不同之处在于理想的时间是没有中断的时间（每次中断后有 30 分钟的热身时间）。理想时间不包括开会时间、午餐时间或正常闲聊时间等。

考虑到所有这些，理想的时间将倾向于实际时间。

示例：预计时间 40 小时（理想） 管理层将假设这是 1 周的实时时间。

如果将 40 小时转换为实时时间：

*   假设每天开一次会（时长 1 小时）
*   每天午餐休息一次（1 小时）
*   加上 20% 的闲聊浴室休息时间获得咖啡等的开销。

一天 8 小时现在是 5 小时工作时间（8 - 会议 - 午餐 - 热身）。
乘以 80% 的效率 = 每天 4 小时的理想时间。

您的 40 小时理想需要 80 小时才能完成。

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2009-03-11T20:20:18.123

**柯克**：斯科特先生，您是否总是将您的维修估算值乘以四倍？

**斯科蒂**：当然可以，先生。我还能如何保持我作为奇迹创造者的声誉？

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2009-02-11T16:25:46.890

一个好的经验法则是估计需要多长时间，然后再增加 1/2 的时间来解决以下问题：

1.  要求会改变
2.  您将被拉到另一个项目以进行快速修复
3.  隔壁办公桌的新人需要帮助
4.  重构部分项目所需的时间，因为您找到了更好的做事方式

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2009-02-11T18:38:38.990

**<sneaky>**
不要夸大项目的估计，而是单独夸大每个任务。你的上级很难以这种方式挑战你的估计，因为谁会在几分钟内与你争论。
**</偷偷摸摸>**

但说真的，通过使用 EBS，我发现人们通常比大型任务更擅长估计小任务。如果你估计你的项目需要 4 个月，那么很可能需要 7 个月才能完成；或者它可能不会。另一方面，如果您对一项任务的估计是 35 分钟，那通常是正确的。

FogBugz 的 EBS 系统向您显示了您的估计历史图表，根据我的经验（也查看其他人的图表），人们确实更擅长估计短期任务。所以我的建议是不要将你的项目作为总数进行伏都教乘法，而是开始将它们预先分解为许多你更擅长估计的非常小的任务。

**然后**将整个事物乘以 3.14。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2009-02-11T17:47:35.257

很大程度上取决于您想要获得的详细程度 - 但额外的“缓冲”时间应基于风险评估 - 在任务级别，您为以下各项设置不同的缓冲时间： 高风险：50% 到 100% 中等风险： 25% 到 50% 低风险：10% 到 25%（全部取决于之前的项目经验）。

风险领域包括：

*   需求覆盖率的估计（#1 风险区域在设计和需求级别缺少组件）
*   所使用的技术知识
*   对您的资源的知识/信心
*   外部因素，例如影响您的其他项目、资源变化等。

因此，对于涵盖组件 A 的给定任务（或任务组），初始估计为 5 天，根据需求覆盖率，它被认为是高风险 - 您可以增加 50% 到 100%

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2009-02-11T18:40:39.593

六个星期。

行业标准：每个请求都需要六周时间。有些会更长，有些会更短，最后一切都会平均化。

此外，如果您等待足够长的时间，它不再成为问题。我无法告诉你我经历了多少次火钻只是为了削减项目/功能。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2009-02-11T16:17:10.687

我不会说我夸大了它们，而是我试图根据过去的经验设定更现实的期望。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2009-02-11T16:58:29.620

您可以通过两种方式计算项目持续时间 - 一种是计算所有涉及的任务并计算出每项任务需要多长时间，将延迟、会议、问题等因素考虑在内。这个数字看起来总是很短，这就是人们总是说的原因比如“加倍”。在交付项目的一些经验之后，您将能够非常快速地判断出，只需简要查看规范需要多长时间，而且总是会是第一种方法得出的数字的两倍......

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2009-02-11T17:24:55.623

为诸如调试和测试之类的事情添加特定的缓冲时间比仅仅增加总时间更好。此外，通过花时间真正计划工作的各个部分，您将使估算本身变得更加容易（可能还有编码）。

如果有的话，请记录下您的所有估算并将它们与实际完成时间进行比较，以了解您倾向于低估多少以及在什么条件下。这样您就可以更准确地“充气”。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2009-02-11T16:29:02.763

我不会说我夸大了它们，但我确实喜欢为项目中可能涉及的所有可能任务使用模板。

您会发现并非列表中的所有任务都适用于所有项目，但是拥有列表意味着我不会让任何任务漏掉，因为我忘记了为它们留出一些时间。

当您发现需要新任务时，请将它们添加到您的列表中。

这样，您将有一个现实的估计。

我倾向于对可实现的目标持乐观态度，因此我倾向于偏低估计。但我知道我自己的这一点，所以我倾向于额外增加 15-20%。

我还跟踪我的实际值与我的估计值。并确保所涉及的时间不包括其他中断，请参阅我的 SO question on [how to get back in the flow](https://stackoverflow.com/questions/259932/any-aids-to-help-you-get-back-in-the-flow)的已接受答案。

高温高压

干杯

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2009-02-11T16:34:43.543

我不会将项目的额外估计时间称为“膨胀”，除非您确实在最初的估计之前完成了您的项目。如果你养成了总是在最初预计的时间之前完成项目的习惯，那么项目负责人就会变得明智并更早地期待它。

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2009-02-11T17:37:53.987

你的估计是基于什么的？

如果它们只是基于对需要多少代码以及编写该代码需要多长时间的模糊直觉，那么您最好将它们填充很多以考虑您没有想到的子任务，通信和同步开销和意想不到的问题。当然，无论如何，这种估计几乎毫无价值。

OTOH，如果您的估计是基于上一次使用给定的技术和开发人员数量完成该范围内的任务需要多长时间的具体知识，那么通货膨胀应该是不必要的，因为上述通货膨胀因素应该已经包含在过去的经历。当然，可能会有一些新因素对当前项目的影响是你无法预见的——这些风险证明一定数量的额外填充是合理的。

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2009-02-11T17:41:26.613

这就是为什么敏捷团队以[故事点](http://agilefaq.net/2007/11/13/what-is-a-story-point/)（任意和相对的度量单位）来估计任务，然后随着项目的进展跟踪团队的速度（每天完成的故事点）的部分原因。有了这些数据，您理论上就可以准确地计算完成日期。

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2009-02-11T21:36:07.233

我采取最坏的情况，加倍，但仍然不够。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2009-09-10T02:50:39.603

承诺不足，交付过多。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2009-02-11T16:16:01.937

哦，是的，长期艰苦经验的一般规则是给项目你最好的时间估计，加倍，这就是*实际*需要多长时间！

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2009-02-11T18:06:55.057

我们必须这样做，因为我们的白痴经理总是在没有任何理由的情况下减少它们。当然，一旦他意识到我们这样做了，我们就陷入了军备竞赛……

我完全希望成为第一个提交两年估计以更改对话措辞的人。

*叹息*。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2009-02-11T20:09:50.000

正如很多人所说，这是经验和风险之间的微妙平衡。

1.  始终从将项目分解为可管理的部分开始，事实上，您可以轻松地想象自己在同一天开始和完成的部分

2.  当您不知道如何做某事时（例如第一次），风险就会增加

3.  当您的风险上升时，您会从最佳猜测开始，然后将其加倍以覆盖一些意外情况，但请记住，您是在项目的一小部分而不是整个项目本身上这样做

4.  当存在您无法控制的因素时，风险也会增加，例如输入的质量或似乎可以完成您想要的任何事情但您从未测试过的库

5.  当然，当您获得特定任务（例如将模型连接到数据库）的经验时，风险就会降低

6.  总结一切以获得小计......

7.  然后，在整个项目中，总是为您将等待的所有答案/文件/好的，我们总是忘记的会议，在项目等等……这就是我们所说的人/政治因素

8.  再次添加另外 30-40% 的测试和修正，这些测试和修正超出了您通常自己进行的测试......例如当您第一次将其展示给您的老板或客户时

当然，如果你看这一切，最终你可以用神奇的“双倍”公式来简化它，但不同的是，你将能够知道在紧迫的期限内你能挤出什么，你能承诺，什么是危险的任务，如何根据重要的里程碑制定你的日程安排等等。

我很确定，如果您注意到每个纯“编码”任务所花费的时间，并将其与您对风险的估计进行比较，您就不会差太多。问题是，要考虑前面的所有小问题并在没有任何障碍的情况下对你能做的事情保持现实（而不是乐观）并不容易。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2009-02-11T22:24:36.603

我说什么时候能搞定。我确保对变更请求进行后续评估，而不是“是的，我可以做到”。不用说，这将需要更多时间。请求更改的人不会认为需要更长时间。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2009-02-17T13:15:57.267

当然，如果你不加 25-50%，那你就是个白痴

问题是当你旁边的白痴不断提出比你的低 25-50% 的估计值时，PM 认为你是愚蠢的/慢的/摇摆不定的。

（有没有其他人注意到项目经理似乎从不将估计值与实际值进行比较？）

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2009-03-11T20:28:34.047

我的一般估计是`guess * 2.5 + 1 week`。

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2009-03-20T10:34:57.113

我总是把我的估计加倍，原因如下：

1) 墨菲定律的缓冲。有些事情总是会在你无法解释的地方出错。

2）低估。程序员总是认为事情很容易做到。“哦，对了，几天就好了。”

3) 议价空间。高层管理人员总是认为可以缩短日程。“只要让开发者更加努力！” 这使您可以给他们想要的东西。当然，过度使用这个（不止一次）会训练他们假设你总是高估。

注意：最好将缓冲区放在项目计划的末尾，而不是针对每个任务。并且永远不要告诉开发人员缓冲区存在，否则帕金森定律（工作扩展以填补其完成的可用时间）将生效。有时我会告诉高层管理人员缓冲区存在，但显然我没有给他们理由#3 作为理由。当然，这取决于你的老板对你诚实的信任程度。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2009-02-11T17:35:53.243

这里的许多人都在说进行估算并将其翻倍（有时再翻倍）。其他人说使用基于证据的调度（al la Joel）。

当我估算一个项目时，每个任务有四个组成部分：

1.  我最好的猜测是需要多长时间。
2.  不确定性（风险）——比如规范中没有的东西（已知/未知的未知）会使时间加倍。
3.  Bug修复
4.  应急时间

对于#1，我使用了最现实的估计。
对于#2，我决定风险的可能性，然后将#1 乘以得到调整后的估计值，
对于#3 和#4，我将调整后的估计值乘以 20%，然后成为每个值的值。

所以对于任何任务，最终的总数是原始估计的 140% 或更多。

对于整个项目，意外事件和错误修复被收集到两个单独的任务中，并随着项目的进展而被消化。

当然，这不包括我通常使每个任务的总价值相等的测试。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2009-02-11T17:42:48.157

我的一个朋友曾经告诉我他使用这个算法：

1.  做个估计
2.  用最大的时间单位表示，不要低于 0.5
3.  我们称它为 x（单位）
4.  结果是**2*x+2（单位）**

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2009-02-11T17:54:02.683

我不会夸大我的估计，我会填充它们！

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2009-02-11T17:58:37.197

两周。

行业标准：每个请求都需要两周时间。有些会更长，有些会更短，最后一切都会平均化。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2009-02-12T02:09:02.007

我不会“膨胀”，而是想出最可能的最坏情况。根据项目的复杂性，我可能会填充更多内容以应对不可预见的情况。

由于我的项目通常不会达到“最坏情况”状态，因此我通常在估计时间之前完成，但足够接近估计目的。考虑到做得太早或太晚之间的选择，我每次都会早点去。

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2009-03-13T15:12:05.107

[死亡行军](http://books.google.com/books?id=FdAZUX9H_gAC&dq=death+march&printsec=frontcover&source=bn&hl=en&ei=rna6SY-2DI6-M4Wk7JII&sa=X&oi=book_result&resnum=4&ct=result)对此有一些很棒的文章。

我最喜欢的是当他说我们在公司玩的游戏之一是工程师将估算值翻倍，然后管理和市场营销将其减半——不幸的是工程师没有被告知他应该加倍他的估算值。<**咧嘴**/>

他提到的另一种游戏是当经理让你不断修改你的估计，直到你到达他们一直想要的日期。我实际上对这个没有问题，只要允许工程师摆弄范围，实施细节，他们使用哪些 3rd 方包，甚至可能是预算......只要营销 / 管理 /工程最终都在同一页上，并且工程师没有被迫**人为**地引入估算值。

[编辑] 哦，我差点忘了——还有另一种经典方法：*2,+1。首先，将您的估计值乘以 2，然后将您的度量单位增加 1。如果您的诚实估计是 3 周，则改为 6 个月。<**邪恶的笑容**/>

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2009-03-15T21:47:53.103

在评估项目的前十分钟内，我通常会占用我想到的初始时间跨度的 250%。前 100% 是我知道可以快速完成的事情，接下来的 100% 是由于不可预见的事件而额外增加的，最后额外的 50% 是“与他人交流”。

似乎对我来说工作得很好。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2009-03-15T21:56:33.240

1.  计算您认为尽可能准确的估计值。
2.  加倍。
3.  引用结果，但要加上“正负 25%”。

例如，如果您认为需要 6 个工作日，请预测“12 个工作日，正负 3 个工作日”。

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2009-03-15T21:59:22.343

我记得在这个当前项目开始时，当时的项目经理直接给出了 6 周的估计！

我的眼睛刚从眼眶里凸出来！知道仍然有很多我们甚至不知道如何解决的领域。这家伙是资深的，因为他有更多的“经验”

不用说，6 周后，规范仍在编写中，几乎没有考虑任何代码。

最终，我们缩小了团队规模（仅限于我！），最终取得了实际进展。我很早以前在做合同制图员的时候就学会了如何准确估算。

涉及两个主要技能。

**首先** 练习估算。没有什么比实际估计各种项目更好的了——即使你不是项目经理，你是否做错也没关系——但对你所做的每个项目进行内部估计（如果你这样做应该很重要）是项目经理）

**其次，**大多数项目井喷是由于项目依赖性造成的，提前识别这些对于了解哪些因素能够在滑倒时使项目脱轨至关重要。

* * *

## 回答 #41

> 赞同：1
> 
> 时间：2009-03-16T23:10:42.443

我加了50%。但是，如果我以前曾与客户合作过，并且我知道他们喜欢在最后做出改变，那么这可能会增加一倍或更多。我试图尽可能地预测未知……有时我成功，有时失败。

* * *

## 回答 #42

> 赞同：1
> 
> 时间：2009-03-17T01:38:01.093

我的估计通常非常准确（来自 20 年的经验），但我通常还是会夸大一点；在奖金时间方面，承诺不足和过度交付总是更好:-)

尽管如此，如果您的项目经理值得任何东西（有些人不值得他们消耗的氧气，但我相信他们是少数），那么您对估算所做的工作应该不会有什么不同。

他们将根据您的实际情况跟踪您的估算，并使用该信息来调整您的下一组估算，然后再将其输入项目计划。这将使他们能够准确地了解您对某些任务的估计程度（我总是根据 UI、DBMS、中间件等类型和大小/复杂性来确定它们）。

然后，如果他们看到您不断低估 UI 任务，他们就会知道在下一次迭代中提高它们。如果他们能看到你在做一些任务，他们就会知道减少你的估计。这具有随时间自动调整的优点。

说真的，有些人认为 PM 整天无所事事地坐在他们的 ars 上*（或者*在美国联邦航空局的屁股上），但这项工作背后至少有一点工程和科学知识。我知道，在我重拾对代码切割的热情之前，我曾经是其中的一员。

* * *

## 回答 #43

> 赞同：1
> 
> 时间：2009-07-08T19:09:16.503

是的，我给它们充气。但还不够。

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2009-07-08T19:48:11.027

我从不认为估计是不准确的，因为程序员无法估计编写代码需要多长时间，而是因为他们只估计编写代码需要多长时间。根本无法估计会议、客户响应时间、测试、客户变更、业务规则修订等。

当这些项目一开始就被考虑在内，并且项目是在任务级别估计的，而不是“哦，我认为这需要...... 7 周！” 那么估计通常是准确的。

所以如果我填充，那是因为我碰巧知道这些项目没有被计算在内，或者这些项目没有被适当地计算。

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2009-02-11T17:55:05.490

我喜欢“双倍”的政策。但是，至少将其提高 30%。我在上一个 IBank 的一位高级经理曾经告诉过我们这一点。

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2009-02-11T19:21:09.760

如果你必须加倍或夸大你的估计以使它们接近现实，那么你最初的估计显然是错误的或不完整的。估计需要包括任务可能遇到的所有因素。无故加额外的时间只是覆盖了你的a**，全额的背后应该有原因，而不是为了安全才加X。如果您知道会有重新设计和调整，那么将这些因素考虑在内，同样适用于会议、测试、错误修复等。

正确的估计应该与实际值匹配或接近，否则估计是不正确的。

我们的目标是让实际值尽可能接近估计值，在恕我直言的估计游戏中，低于预期与超过预期一样糟糕。

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2009-03-14T00:56:48.743

我不惜一切代价避免对项目进行时间估算。相反，我更喜欢预测第一个里程碑的时间并绘制完成的里程碑，并定期回顾未决的里程碑。

例外情况：当代码基本完成并且只需要针对里程碑进行修改时。当项目与之前的项目无关紧要或基本相同时。当有完整准确的规范时（例如在应用平台转换的情况下）。

如果客户或经理坚持一个确定的目标日期，那么我会坚持一个完整的规范。或者我找到另一个经理或客户。如果这些都不是一个选项，我会从空气中提取一个日期，让他们知道它非常不准确，可能会被错过，但会随着里程碑的完成而改进。

时间估计技巧和方法的类型因项目类型而异，这就是为什么估计仍然是一门模糊的艺术。

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2009-03-14T13:49:13.357

我对似乎最常见的态度采取了相反的方法，我尽量使我的估计尽可能准确，然后确保项目经理知道我没有虚报我的估计。然后由他们决定应用任何 2 的随机因子或任何他们觉得舒服的值。

当我给出估计时，我也想给出某种指示，表明估计是如何通过的。某种价值，从“我刚刚从我的屁股中取出这个数字”到“我在上周详细列出并列出了所有任务，对任何复杂或未知的集成进行原型设计，并且估计是事实陈述” （不是一个常见的:)

这主要来自几个项目，似乎管理链中的每个人都在估算中添加了自己的小因素，因此初始项目计划比应有的时间长约 3 倍。随之而来的似乎是一轮随机的马交易，它缩短了项目时间，除了办公室政治之外没有任何真正的参考。

我想这是一个你有多信任你给出估计的人的例子，我真诚地相信你必须能够信任并且对你的项目/产品经理 100% 诚实，并且能够给他们估计你诚实地相信是真实的。与此相反的是，它们必须是合理的，当您超出估算值时，请谈论它并尝试改进您的估算值，而不仅仅是咀嚼新的估算值。

* * *

## 回答 #49

> 赞同：0
> 
> 时间：2009-03-17T04:24:17.807

我从不把它翻倍。通常，设计/想法/更改会出现在便笺上，我通常从大约一年的估计开始，并且便笺得到的越精致，我的估计就越好。

即使这样，我也知道当我完成实施时，我只完成了一半。这通常在最初的年度估计范围内，因此帖子作者有足够的时间来解决任何设计问题。

* * *

## 回答 #50

> 赞同：0
> 
> 时间：2009-03-20T10:24:25.670

如果你是一家咨询公司，你真的需要考虑过多地填充你的估计。你需要赚钱，对吧？如果您不让您的资源尽快承担下一个任务，您就无法做到这一点。另外，考虑一下你将要进行什么样的项目。你能和客户一起做 T&M 吗？如果没有，并且您被迫提供固定出价，还包括固定期限并与客户分担风险。我无法告诉你我看到有多少同事在这次讨论中搞砸了这些话题。作为 PM，您必须站出来，a) 提供一个小的、合理的填充以确保可以满足交付日期，b) 通过在 SOW 中获得良好的语言来协商和分担固定投标项目所涉及的风险保护你，和 c) 你' 重新努力赢得工作，对吗？？？表现得像，并确保您的 A 团队在规划阶段获得估算，以保持竞争力。

WPF 和 Silverlight 是相当新的，但我们很快就会让竞争对手低于我们的出价。

稍微偏离主题，但帮助客户在与销售人员谈判项目时意识到您团队的强度。一个好的产品经理可以帮助赢得新客户的尊重和信任。

谈论内部资助的项目时，差别真的很小。由于野兽的性质以及许多此类项目的生命周期和需求，它们需要比一些高风险、短期外部项目更强大的项目管理。

最后，您必须从将要执行工作的资源中获得支持。团队负责人应该祝福估算，并能够判断它们是高还是低。您必须能够在每个项目上获得投资回报，因此有时您可能需要超出预期的估算值。但确实，如果工作量很小，并且您在项目中投入了 B 或 C 资源团队，如果出价太高，则将机会留在桌面上。除非它具有重要的商业意义，否则如果您确实没有资源来完成它，请避免参加演出。在这个经济体中，这并不总是一种选择。

* * *

## 回答 #51

> 赞同：0
> 
> 时间：2009-05-10T04:13:05.423

请记住，大多数开发人员不会考虑太多的测试时间、错误修复时间和管理开销（电子邮件、咖啡、会议等），一些小组每周只安排 20 小时和/或乘以至少 2.5

# .net - 方法会影响我的对象的大小吗？

> ID：537535
> 
> 赞同：5
> 
> 时间：2009-02-11T16:16:31.280
> 
> 标签：.net, methods, memory-management

在 .NET 中，对象内方法的数量或方法的大小（即代码量）是否会影响对象在实例化时使用的内存量？

示例：具有 3 个 int 属性和 1 个方法的对象是否会比具有 3 个 int 属性和 20 个方法的对象占用更多内存？

如果“是”，静态方法是否占用更少的内存？

请注意：我意识到实际调用一个方法可能会实例化其他将使用内存的对象或变量——我的问题只是与调用构造函数后它们使用了多少内存有关。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-11T16:20:19.837

不，方法会占用内存，但这*很少*。方法表以及为方法生成的代码由对象的每个实例共享。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T16:23:21.233

> 具有 3 个 int 属性和 1 个方法的对象会比具有 3 个 int 属性和 20 个方法的对象占用更多内存吗？

答案是不。方法不是任何特定实例的一部分。它们*属于*该类型。

# python - 如何仅使用一次通过创建文件的多个哈希？

> ID：537542
> 
> 赞同：6
> 
> 时间：2009-02-11T16:17:38.517
> 
> 标签：python, hash

如何从文件中获取 MD5、SHA 和其他哈希值但只执行一次？我有 100MB 的文件，所以我不想多次处理这些 100MB 的文件。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-11T16:25:24.877

大概是这样的？

```
>>> import hashlib
>>> hashes = (hashlib.md5(), hashlib.sha1())
>>> f = open('some_file', 'r')
>>> for line in f:
...     for hash in hashes:
...         hash.update(line)
... 
>>> for hash in hashes:
...     print hash.name, hash.hexdigest() 
```

或循环 f.read(1024) 或类似的东西以获得固定长度的块

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-11T17:38:04.750

这是使用[' 建议修改后](https://stackoverflow.com/questions/537542/how-can-i-create-multiple-hashes-of-a-file-using-only-one-pass/537597#537597)[`@ʞɔıu`的答案](https://stackoverflow.com/questions/537542/how-can-i-create-multiple-hashes-of-a-file-using-only-one-pass/537585#537585)。[`@Jason S`](https://stackoverflow.com/questions/537542/how-can-i-create-multiple-hashes-of-a-file-using-only-one-pass/537597#537597)

```
from __future__ import with_statement
from hashlib import md5, sha1

filename = 'hash_one-pass.py'

hashes = md5(), sha1()
chunksize = max(4096, max(h.block_size for h in hashes))
with open(filename, 'rb') as f:
    while True:
        chunk = f.read(chunksize)
        if not chunk:
            break
        for h in hashes:
            h.update(chunk)

for h in hashes:
    print h.name, h.hexdigest() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T16:26:27.357

我不了解 Python，但我熟悉哈希计算。

如果您手动处理文件的读取，只需一次读取一个块（256 字节或 4096 字节或其他），然后传递每个数据块以更新每个算法的哈希值。（您必须在开始时初始化状态并在最后确定状态。）

# c# - Assembly.GetExportedTypes 与 GetTypes

> ID：537548
> 
> 赞同：23
> 
> 时间：2009-02-11T16:19:29.383
> 
> 标签：c#, .net

Assembly.GetExportedTypes() 有什么作用？它与 Assembly.GetTypes() 有何不同

你能举例说明吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-11T16:44:57.577

GetExportedTypes() 不包括受保护/私有/内部类型。根据下面亚历山大问题中链接的问题，即使通过 InternalsVisibleToAttribute 对程序集可见，内部类型也不包括在内。

GetTypes() 包括所有类型。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-11T16:25:16.720

`GetExportedTypes()`仅返回在相关程序集之外可见的类型。“可见”是指公共类型和嵌套在其他公共类型中的公共类型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-18T12:40:10.690

`InternalsVisibleToAttribute`关于和[这个问题](https://stackoverflow.com/questions/5384975/are-internal-types-visible-from-assembly-getexportedtypes)的一点评论。

即使调用是由具有`InternalsVisibleTo`属性的程序集进行的，`GetExportedTypes()`也不会返回`internal`类型。

所以，`GetExportedTypes()`只返回`public`类型。

# installation - 开发环境设置提示

> ID：537553
> 
> 赞同：2
> 
> 时间：2009-02-11T16:20:28.837
> 
> 标签：installation, environment

任何人都可以提供有关如何设置理想的 Windows 开发环境的提示吗？考虑转移到 vmware 或虚拟机设置进行开发，并让开发工具远离我的主系统，但如果我只想快速尝试一些东西，那会让人头疼。

只是寻找其他开发人员关于他们如何设置开发环境以实现最大生产力的建议。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T16:30:59.980

我推荐 VMWare 或类似的虚拟化产品。它节省了很多时间。

我用干净的 Windows 设置了一个 VMWare 映像，安装了我需要的所有开发工具，然后我做了一个副本。现在，只要我需要一个“干净”的开发环境，我就可以简单地复制 VM 映像，然后就可以走了！

这也意味着我所有的非开发文件都是独立的并且没有危害。

如果我选择，我可以将 VM 文件带到另一台 PC 上，并拥有相同的开发环境。

使用虚拟机还可以让您尝试一些东西而不会造成任何伤害。您可以创建“快照” - 运行/执行一些操作，然后轻松恢复到快照。非常适合轻松地反复测试某些东西。

# javascript - 使用 jQuery，如何更改元素的 html 值？（分区）

> ID：537554
> 
> 赞同：12
> 
> 时间：2009-02-11T16:20:36.870
> 
> 标签：javascript, jquery

使用 ajax 请求我想更改我的 div 的内容。

```
<div id="d1">202</div> 
```

所以我想将内容更改为不同的数字。

```
$('d1').InnerText??? 
```

另外，假设我想增加数字，我该怎么做？我必须转换为int吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-11T16:21:38.460

```
$("#di").html('My New Text'); 
```

查看[jQuery 文档](http://docs.jquery.com/Attributes/html#val)。

如果你想增加数字，你会做

```
var theint = parseInt($("#di").html(),10)
theint++;
$("#di").html(theint); 
```

PS不确定这是否是一个错字，但你需要`#`在你的选择器中包含 让jQuery知道你正在寻找一个ID为 的元素`di`。也许如果您来自原型，您不会期望这一点，只是让您知道。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T16:24:31.417

这会改变 HTML 元素的内部文本。

```
$('#d1').text(parseInt(requestResponse)++); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-11T17:00:49.987

除非您像`<b>blah</b>`我建议`$("#di").text()`的那样嵌入 html，否则它会自动转义 <、> 和 & 等内容，而`.html()`不会。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-03T03:31:37.213

使用[文本](http://docs.jquery.com/Attributes/text)功能：

```
$("#d1").text($("#d1").text() + 1); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T16:22:10.923

```
$('#d1').html("Html here"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T16:33:50.613

```
jQuery('#d1').html("Hello World"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-25T07:29:03.183

如果您的值是纯文本（如“测试”），您也可以使用 text() 方法。像这样：

```
$('#d1').text('test'); Or $('#d1').html('test'); 
```

无论如何，关于您共享的问题，我认为您可能在将 DIV 的 HTML 代码发送到浏览器之前调用了 JavaScript 代码。确保在 <div> 之后的 <script> 标记中调用 jQuery 行，或者在如下语句中调用：

```
$(document).ready(
    function() {
        $('#d1').text('test');
    }
); 
```

这样，在浏览器解析了 div 的 HTML 之后，脚本就会执行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-25T11:00:29.750

```
$("#div1").innerHTML="your text goes here.."; 
```

# jquery - 响应 jQuery Ajax 请求的 MVC 操作，我是否在标头中设置文档类型？

> ID：537565
> 
> 赞同：0
> 
> 时间：2009-02-11T16:22:19.113
> 
> 标签：jquery, asp.net-mvc

我的 .net MVC 操作将响应 ajax 请求（jquery）。

我是否（或应该）设置标题的文档类型？

我将仅使用 html/纯文本甚至 JSON 进行响应。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T16:25:10.137

如果它使用 html/纯文本响应，请使用：

```
Content-Type: text/html; 
```

如果它使用 JSON 响应：

```
Content-type: application/json 
```

这样做是一种很好的做法，尽管这实际上取决于您对响应数据的处理方式。

有时 JavaScript 框架会根据 Header自动*处理响应。*例如，如果 PrototypeJs 具有“”标头，则它会自动`sanitizes`生成`eval`响应`application/json`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:52:25.267

如果你像往常一样返回 View() 或 Json()，那么这已经为你完成了。您无需采取任何行动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T16:33:03.143

我对 MVC 操作了解不多，但在 .NET 3.5 中，您通常会使用 WPF 服务 (.svc) 来响应请求，并且默认使用 JSON 响应。

它还可以使用`WebInvoke`注释的`RequestFormat`属性接受 JSON 输入。

# java - Sourceforge 每日构建

> ID：537566
> 
> 赞同：2
> 
> 时间：2009-02-11T16:22:27.130
> 
> 标签：java, ant, build, sourceforge, dailybuilds

我目前维护一个托管在 SourceForge 中的开源项目。我的项目是使用 ANT 构建脚本用 Java 编写的。（Ant 安装了一些扩展，但我们暂时忽略它。）

不幸的是，似乎没有简单的方法来自动生成每日构建。有什么我可以使用的解决方法。这是我想要的：

1.  它应该*始终*使用最新的 SVN 版本。
2.  它应该建立它。
3.  它应该在线发布。如果失败，它应该发布错误报告。
4.  这些任务应该**自动**完成。

我怎样才能做到这一点？如何模拟 SourceForge 中托管的项目的自动每日构建？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T16:55:01.327

据我了解您的问题，您需要的是一个持续集成工具。它将为您汇集 SCM，开始构建并发布/存储错误报告以防失败。

我最喜欢的是哈德逊：

[https://hudson.dev.java.net/](https://hudson.dev.java.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:48:05.540

我认为 SF 对提交的电子邮件有一个钩子。

[http://apps.sourceforge.net/trac/sitedocs/wiki/Subversion](http://apps.sourceforge.net/trac/sitedocs/wiki/Subversion) [http://apps.sourceforge.net/trac/sitedocs/wiki/Subversion%20hook%20scripts#svnnotify](http://apps.sourceforge.net/trac/sitedocs/wiki/Subversion%20hook%20scripts#svnnotify)

我想你可以触发它。

或者，使用 (svn up) 每小时（或您想要的任何时间）检查最新版本的过程是否足以触发构建？（记录最后一个已知的构建版本，如果当前版本不同，则触发构建）

我不熟悉它们，但我怀疑用于构建的第三方工具（CI/持续集成）有一种方法可以确定来自 SVN 的构建触发事件。

# c# - 如何在 C# 中从 byte[] 获取 IntPtr

> ID：537573
> 
> 赞同：144
> 
> 时间：2009-02-11T16:23:38.440
> 
> 标签：c#, .net

我想在 C# 中将`byte[]`一个方法传递给一个带`IntPtr`参数的方法，这可能吗？如何？

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2009-02-11T16:48:13.263

其他方式，

```
GCHandle pinnedArray = GCHandle.Alloc(byteArray, GCHandleType.Pinned);
IntPtr pointer = pinnedArray.AddrOfPinnedObject();
// Do your stuff...
pinnedArray.Free(); 
```

* * *

## 回答 #2

> 赞同：143
> 
> 时间：2009-02-11T16:36:15.053

这应该有效，但必须在不安全的上下文中使用：

```
byte[] buffer = new byte[255];
fixed (byte* p = buffer)
{
    IntPtr ptr = (IntPtr)p;
    // do you stuff here
} 
```

请注意，您必须使用固定块中的指针！一旦您不再处于固定块中，gc 就可以移动对象。

* * *

## 回答 #3

> 赞同：101
> 
> 时间：2009-02-11T16:35:28.987

不确定是否将 IntPtr 获取到数组，但您可以使用 Mashal.Copy 复制数据以供非托管代码使用：

```
IntPtr unmanagedPointer = Marshal.AllocHGlobal(bytes.Length);
Marshal.Copy(bytes, 0, unmanagedPointer, bytes.Length);
// Call unmanaged code
Marshal.FreeHGlobal(unmanagedPointer); 
```

或者，您可以声明一个具有一个属性的结构，然后使用 Marshal.PtrToStructure，但这仍然需要分配非托管内存。

**编辑：**另外，正如 Tyalis 指出的那样，如果不安全代码是您的选择，您也可以使用*fixed*

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2011-05-19T13:22:14.073

您可以使用[`Marshal.UnsafeAddrOfPinnedArrayElement`](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.marshal.unsafeaddrofpinnedarrayelement)来获取指向数组（或数组中的特定元素）的内存指针。请记住，必须首先根据 API 文档固定数组：

> 在将数组传递给此方法之前，必须使用[GCHandle固定该数组。](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.gchandle)为了获得最佳性能，此方法不会验证传递给它的数组；这可能会导致意外行为。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2014-05-23T21:35:38.513

这是@user65157的答案的一个转折点（+1，顺便说一句）：

我为固定对象创建了一个 IDisposable 包装器：

```
class AutoPinner : IDisposable
{
   GCHandle _pinnedArray;
   public AutoPinner(Object obj)
   {
      _pinnedArray = GCHandle.Alloc(obj, GCHandleType.Pinned);
   }
   public static implicit operator IntPtr(AutoPinner ap)
   {
      return ap._pinnedArray.AddrOfPinnedObject(); 
   }
   public void Dispose()
   {
      _pinnedArray.Free();
   }
} 
```

然后像这样使用它：

```
using (AutoPinner ap = new AutoPinner(MyManagedObject))
{
   UnmanagedIntPtr = ap;  // Use the operator to retrieve the IntPtr
   //do your stuff
} 
```

我发现这是不要忘记调用 Free() 的好方法 :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-19T22:02:34.880

Marshal.Copy 有效，但速度相当慢。更快的是在 for 循环中复制字节。更快的是将字节数组转换为 ulong 数组，复制尽可能多的 ulong 以适合字节数组，然后复制可能剩余的 7 个字节（未对齐 8 个字节的轨迹）。最快的是将字节数组固定在一个固定的语句中，如上面 Tyalis 的回答中所建议的那样。

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2009-02-11T17:01:07.723

在某些情况下，您可以在 IntPtr 的情况下使用 Int32 类型（或 Int64）。如果可以，另一个有用的类是 BitConverter。例如，对于您想要的内容，您可以使用 BitConverter.ToInt32。

# sql - 当它们在表格中重复出现时如何选择不同的元素？(T-SQL)

> ID：537574
> 
> 赞同：0
> 
> 时间：2009-02-11T16:23:44.553
> 
> 标签：sql, tsql, stored-procedures

考虑下表：

```
create table temp
(                  
    name int,
    a int,
    b int
)

insert into temp (name, a, b)
values (1, 2, 3)

insert into temp (name, a, b)
values (1, 4, 5)

insert into temp (name, a, b)
values (2, 6, 7) 
```

我想选择具有不同 [名称] 的 *（所有字段）。在两行或多行具有相同 [name] 的情况下，选择是显示第一行 (1, 2, 3) 还是显示第二行 (1, 4, 5)，规则可以选择具有更大的[乙]。

你能指出我必须如何编写这个存储过程吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T16:28:59.563

```
SELECT t.*
FROM temp t
INNER JOIN (
  SELECT name, max(b) as b
  FROM temp
  GROUP BY name
) m
ON t.name = m.name
AND t.b = m.b 
```

在大表上不是很快，除非你有一个关于名字的索引，b。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T16:29:13.137

在 MSSQL 2005 及更高版本中：

```
SELECT name, a, b
FROM (
    SELECT temp.*, ROW_NUMBER() OVER (PARTITION BY name ORDER BY b DESC) AS rn
    FROM   temp
) t
WHERE rn = 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T16:28:12.000

这是执行此 sql 2000 及更高版本的一种方法

```
select t1.* from(
select name,max(B) as MaxB
from temp
group by name) t2 
join temp t1 on t1.a = t2.MaxB
and t1.name = t2.name 
```

SQL 2005 及更高版本

```
select name, a, b
from (
select m.*,
row_number() over (
partition by name
order by B desc) as rn
from temp m
) m2
where m2.rn = 1; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T16:35:40.110

```
CREATE VIEW Max_B_From_Temp AS
SELECT name,Max(b) as b
FROM temp
GROUP BY name

SELECT temp.* 
FROM temp INNER JOIN Max_B_From_Temp 
ON 
    temp.name=Max_B_From_Temp.name and 
    temp.b=Max_B_From_Temp.b 
```

它不是存储过程，但您可以从其中调用查询。

# vb6 - 如何在VB6中使用进度条下载多个文件？

> ID：537580
> 
> 赞同：6
> 
> 时间：2009-02-11T16:25:04.207
> 
> 标签：vb6, download

我想从 VB6 应用程序下载多个文件（主要是图像）。目前我正在使用 URLDownloadToFile 但它一次只允许一个文件并且没有进度条。我想下载多个文件并带有进度条。请帮忙。提前致谢。

我现在的代码：

```
Dim lngRetVal As Long
lngRetVal = URLDownloadToFile(0, URL, LocalFilename, 0, 0)
If lngRetVal = 0 Then DownloadFile = True 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T19:31:11.780

You want to download the file asynchronously, so that your VB code continues executing while the download happens. There **is** a little-known way to do this with native VB6, using the [AsyncRead](http://msdn2.microsoft.com/en-us/library/aa277589.aspx) method of UserControl and UserDocument objects - no need for API calls.

Here's an excellent [explanation and VB6 code for multiple simultaneous downloads](http://visualstudiomagazine.com/articles/2008/03/27/simple-asynchronous-downloads.aspx), from the renowned VB6 guru [Karl Peterson](http://vb.mvps.org/). The AsyncReadProgress event gives you the BytesRead and BytesMax, which will allow you to display a progress bar.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T16:55:11.467

你希望得到一个 VB 的答案，但这不是微不足道的。

以下大部分来自[http://www.experts-exchange.com/Programming/Languages/Visual_Basic/Q_20571958.html](http://www.experts-exchange.com/Programming/Languages/Visual_Basic/Q_20571958.html)

> IBindStatusCallback 接口不能直接从 VB 访问。它必须被引入兼容的类型库。
> 
> 类型库 olelib.tlb 位于： [http](http://www.domaindlx.com/e_morcillo/scripts/type/default.asp) ://www.domaindlx.com/e_morcillo/scripts/type/default.asp 下载的 zip 文件名为：tl_ole.zip
> 
> 您还将找到有关如何使用它的示例。不确定您是否会在 IBindStatusCallback 上找到特定示例，但值得一试。

您可以编写自己的函数将数据转换为字符串，这样您就可以完全控制所有内容：

```
Option Explicit

Public Const INTERNET_OPEN_TYPE_PRECONFIG = 0
Public Const INTERNET_DEFAULT_HTTP_PORT = 80
Public Const INTERNET_SERVICE_HTTP = 3
Public Const INTERNET_FLAG_RELOAD = &H80000000
Public Const HTTP_QUERY_STATUS_CODE = 19
Public Const HTTP_ADDREQ_FLAG_ADD = &H20000000

Public Declare Function InternetOpen Lib "wininet.dll" Alias "InternetOpenA" (ByVal sAgent As String, ByVal lAccessType As Long, ByVal sProxyName As String, ByVal sProxyBypass As String, ByVal lFlags As Long) As Long
Public Declare Function InternetConnect Lib "wininet.dll" Alias "InternetConnectA" (ByVal hInternetSession As Long, ByVal sServerName As String, ByVal nServerPort As Integer, ByVal sUsername As String, ByVal sPassword As String, ByVal lService As Long, ByVal lFlags As Long, ByVal lContext As Long) As Long
Public Declare Function HttpOpenRequest Lib "wininet.dll" Alias "HttpOpenRequestA" (ByVal hHttpSession As Long, ByVal sVerb As String, ByVal sObjectName As String, ByVal sVersion As String, ByVal sReferer As String, ByVal something As Long, ByVal lFlags As Long, ByVal lContext As Long) As Long
Public Declare Function HttpSendRequest Lib "wininet.dll" Alias "HttpSendRequestA" (ByVal hHttpRequest As Long, ByVal sHeaders As String, ByVal lHeadersLength As Long, ByVal sOptional As String, ByVal lOptionalLength As Long) As Long
Public Declare Function HttpQueryInfo Lib "wininet.dll" Alias "HttpQueryInfoA" (ByVal hHttpRequest As Long, ByVal lInfoLevel As Long, ByRef sBuffer As Any, ByRef lBufferLength As Long, ByRef lIndex As Long) As Long
Public Declare Function InternetCloseHandle Lib "wininet.dll" (ByVal hInet As Long) As Integer
Public Declare Function HttpAddRequestHeaders Lib "wininet.dll" Alias "HttpAddRequestHeadersA" (ByVal hHttpRequest As Long, ByVal sHeaders As String, ByVal lHeadersLength As Long, ByVal lModifiers As Long) As Integer
Public Declare Function InternetReadFile Lib "wininet.dll" (ByVal hFile As Long, ByVal sBuffer As String, ByVal lNumberOfBytesToRead As Long, lNumberOfBytesRead As Long) As Integer
Public Declare Function InternetOpenUrl Lib "wininet.dll" Alias "InternetOpenUrlA" (ByVal hInternet&, ByVal lpszUrl As String, ByVal lpszHeaders As String, ByVal dwHeadersLength&, ByVal dwFlags&, ByVal dwContext&) As Long
Public Declare Function InternetQueryDataAvailable Lib "wininet.dll" (ByVal hFile As Long, lpdwNumberOfBytesAvailable As Long, ByVal dwFlags As Long, ByVal dwContext As Long) As Long

Public Function GetHTML(strURL As String) As String
Const BufferSize = 16384
Dim hSession&, hURL&, lRet&, lBytesAvail&
Dim Buffer As String * BufferSize
Dim BufferLen&, sResult$
    hSession = InternetOpen(vbNullString, INTERNET_OPEN_TYPE_PRECONFIG, vbNullString, vbNullString, 0)
    hURL = InternetOpenUrl(hSession, strURL, vbNullString, ByVal 0&, INTERNET_FLAG_RELOAD, ByVal 0&)
    sResult = ""
    Do
        InternetReadFile hURL, Buffer, Len(Buffer), BufferLen
        If BufferLen > 0 Then sResult = sResult & Left(Buffer, BufferLen)
    Loop Until BufferLen = 0
    GetHTML = sResult
    InternetCloseHandle hURL
    InternetCloseHandle hSession
End Function 
```

您将在此处找到用于执行回调方法的其他资源（向下滚动到底部）：

[http://www.experts-exchange.com/Programming/Languages/.NET/Visual_Basic.NET/Q_21763861.html](http://www.experts-exchange.com/Programming/Languages/.NET/Visual_Basic.NET/Q_21763861.html)

[http://www.experts-exchange.com/Programming/Languages/.NET/Visual_Basic.NET/Q_21746456.html](http://www.experts-exchange.com/Programming/Languages/.NET/Visual_Basic.NET/Q_21746456.html)

但老实说，如果你想更好地控制它，你最好制作自己的下载功能。VB 中的 TCP/IP 内容实际上非常简单。

-亚当

# installation - 如何仅在安装（而不是卸载）中执行自定义操作

> ID：537584
> 
> 赞同：73
> 
> 时间：2009-02-11T16:25:23.193
> 
> 标签：installation, windows-installer, installshield

我敢肯定这很容易，但我很难做到这一点。我有一个自定义操作，可以在安装时执行不同的（非 msi）安装程序。不幸的是，我注意到它还在卸载时执行安装程序！

我已经浏览了这些选项，但我似乎无法找到阻止这种情况的方法。如果有人可以帮助我，我将非常感激。

另外，如何设置自定义操作以仅在卸载期间关闭？非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2009-02-11T21:25:14.170

在操作上添加条件，使其仅在安装期间触发，而不是在卸载期间触发。

仅在安装期间运行的操作

```
NOT Installed AND NOT PATCH 
```

操作在安装和修复期间运行

```
NOT REMOVE 
```

仅在初始安装时运行：

```
NOT Installed 
```

在初始安装或选择修复时运行。

```
NOT Installed OR MaintenanceMode="Modify" 
```

要仅在卸载期间运行操作，请使用以下条件：

```
REMOVE~="ALL" 
```

仅在升级期间运行操作：

```
Installed AND NOT REMOVE 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-04-06T19:29:29.130

一点修正：

最后，要仅在卸载期间运行操作，请使用以下条件： `REMOVE="ALL"`

这似乎更合适，因为该属性`REMOVE`包含要卸载的功能。
因此，如果我进行修改以删除一项功能，`REMOVE`则为 true，并且仅在卸载时执行的操作在修改时执行。
[MSDN 上的更多详细信息](http://msdn.microsoft.com/en-us/library/aa371194(v=VS.85).aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-02-24T11:45:04.377

一个例子：

```
<InstallExecuteSequence>
..
    <Custom Action="QtExecIdOfCA" Before="InstallFinalize">NOT Installed</Custom>
..
</InstallExecuteSequence>

..
..
<CustomAction Id="QtExecIdOfCA" BinaryKey="WixCA" DllEntry="CAQuietExec" Execute="deferred" Return="ignore" Impersonate="no"/> 
```

**注意！**条件被添加到`<Custom>`标签中，而**不是**让`<CustomAction>`我感到困惑，因为自定义后面是动作属性

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-01-02T16:32:48.047

请小心`REMOVE=ALL`。它在 installvalidate 序列之前不可用。
并查看以下链接以获取更多详细信息：http:
[//msdn.microsoft.com/en-us/library/aa371194 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/aa371194(v=vs.85).aspx)
[http://msdn.microsoft.com/en-us/library/ aa368013(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/aa368013(v=vs.85).aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T21:41:57.017

自定义操作的条件，可能带有匹配的自定义操作来执行卸载。不确定您使用的是什么工具，但假设二次安装与组件相关联，我将使用该组件状态。= 3 的状态表示已安装的目标状态。状态 = 2 表示目标状态不存在。请注意，如果没有更改，则不会设置状态。

# django - 每个模型多个图像

> ID：537593
> 
> 赞同：72
> 
> 时间：2009-02-11T16:26:07.403
> 
> 标签：django, django-models

我正在用 Django 编写一个简单的房地产列表应用程序。每个属性都需要有可变数量的图像。图片需要有可编辑的顺序。我需要让管理员用户证明。

也就是说，我有什么选择？

1.  是否有我不知道的 ImageList 字段？

2.  有没有这样的应用程序`django.contrib.comments`可以为我完成这项工作？

3.  如果我必须自己编写它，我将如何使管理员端体面？我正在想象一些比 ImageField 提供的更漂亮的东西，并带有一些用于重新排序的拖放操作。但我在编写管理页面时完全是个笨蛋=（

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2009-02-11T17:52:25.107

1.  变量列表，也称为多对一关系，通常通过为多个创建单独的模型来处理，并且在该模型中，使用“一”的 ForeignKey。

2.  在 django.contrib 中没有这样的应用程序，但是您可以使用几个外部项目，例如[django-photologue](https://github.com/jdriscoll/django-photologue)，它甚至支持在管理员中查看图像。

3.  管理站点不能成为“用户证明”，它只能由受信任的用户使用。鉴于此，使您的管理站点体面的方法是为您的属性定义一个 ModelAdmin，然后内联照片（[内联文档](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#inlinemodeladmin-objects)）。

所以，给你一些快速草稿，一切看起来像这样：

```
# models.py
class Property(models.Model):
    address = models.TextField()
    ...

class PropertyImage(models.Model):
    property = models.ForeignKey(Property, related_name='images')
    image = models.ImageField() 
```

和：

```
# admin.py
class PropertyImageInline(admin.TabularInline):
    model = PropertyImage
    extra = 3

class PropertyAdmin(admin.ModelAdmin):
    inlines = [ PropertyImageInline, ]

admin.site.register(Property, PropertyAdmin) 
```

在 ForeignKey 上使用 related_name 参数的原因是您的查询将更具可读性，例如在这种情况下，您可以在视图中执行以下操作：

```
property = Property.objects.get(pk=1)
image_list = property.images.all() 
```

[编辑：忘了提一下，然后您可以使用 Simon Willison 的片段Orderable inlines 使用 jQuery UI 拖放](http://www.djangosnippets.org/snippets/1053/)在管理员中实现拖放排序

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-11T16:57:54.957

将具有 ForeignKey 的 Image 模型写入您的 Property 模型。很可能，您将拥有一些属于图像而不属于属性的其他字段。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-24T19:51:16.417

我目前正在做同样的事情，我面临同样的问题。

经过一段时间的研究，我决定使用[django-imaging](https://github.com/pielgrzym/django-imaging)。它有一个很好的[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)功能，图像可以上传到模型插入页面的同一页面上，并且可以编辑。它唯一缺少的是对非 JPEG 扩展的支持。我希望我能在几天内找到解决方法。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-19T13:16:21.127

有一个名为[django-galleryfield](https://github.com/dzhuang/django-galleryfield)的包。我想它会满足你的需求。

# java - 软件行业的哪个部门使用 C++？

> ID：537595
> 
> 赞同：10
> 
> 时间：2009-02-11T16:26:18.917
> 
> 标签：java, c++, jobs

像大多数人一样，我在 C 之后学习了 C++。我学习 C++ 是因为它是那些能找到工作的语言之一。我还在学习（做硕士）。我的一个表兄弟从事开发人员工作了大约 12 年。

他建议我学习 Java，这样我才能找到一份好工作。他说只有少数行业，如电信通信使用 C++，几乎所有的企业软件都是用 Java 开发的。我在我的大学担任学生技术员。该工作涉及使用 C++ 进行 Windows 编程。我学习了核心 Java。我不知道那些[Struts](http://en.wikipedia.org/wiki/Apache_Struts)、[Hibernate](http://en.wikipedia.org/wiki/Hibernate_%28Java%29)或其他任何东西。

为了安全起见，我打算同时掌握两者。但我认为 Java 是一片海洋，尽管用 Java 编程比 C++ 更容易（这是我的观点。C++ 爱好者不会杀了我）。

你们那里的极客和专业人士有什么建议。你觉得我应该两个都学。软件行业的哪些部门使用 C++？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-02-11T16:32:44.487

我本科时得到的最好建议来自我的语言教授，他告诉我（在这里转述）：“不要记住语言；不要将自己嫁给一种语言。它们只是工具。它们都做同样的基本操作“不要学习特定的语言，而是学习良好软件开发的基础。然后你就可以学习任何语言并成功地使用它。”

在他告诉我之前，我害怕学习新的语言。之后，我把他的建议铭记在心，这一切都变得不同了。语言只是您工具箱中的工具。如果你能用一种语言编程和编写好的软件，你就可以用另一种语言来做。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-11T16:33:08.370

C++ 仍然广泛用于性能密集型任务。例如，我在视频压缩和解压缩方面做了很多工作——都是 C++。部分是因为我们需要性能，部分是因为需要使用的所有 3rd 方库都是 C++，所以如果我们使用相同的语言，则更容易与它们集成。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-11T16:33:56.713

使用 C++ 的项目的简要清单：

*   设备驱动开发
*   游戏
*   高级引擎（音频、图像处理等）
*   电信
*   嵌入式软件（设备等）

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-02-11T16:32:56.047

C++ 甚至还没有接近死亡。

我的经验：

彭博、路透社及其所有需要低延迟市场数据馈送的银行/交易客户都使用 C++。（富达、摩根大通、法国巴黎银行、花旗银行等）

国防工业使用 C++。（在其他语言中 - Java 也很流行）

这些行业也使用 java 和其他语言，但 C++ 很难被击败。另请注意，现有的大量 C++ 代码库需要很长时间才能消失（如果有的话）

了解和使用它们并不难。不要太担心特定的语言。这不是开发软件的真正症结所在。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-02-11T16:37:03.523

一些自称为 Google 的网站认为它广泛使用 C++。感谢上帝，他们不需要性能来索引那里的少数网站。

如果这个 Interweb 东西起飞了，他们会遇到真正的麻烦。（-：

不过说真的，除了当前的频道更改（回归？）到 C 和 Perl 之外，之前的四个项目都是 C++。

1.  用于世界几家主要航空公司的大型离港控制系统（每天 30,000 个 10MB 日志文件）
2.  一种新型军用飞机的飞行训练模拟器和地面软件验证平台
3.  现有空中交通管制模拟器的大型框架，用于整合新的航空电信网络 (ATN)
4.  用于空中交通管制中心的先进雷达处理和显示系统

一切真的很有趣。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-02-11T16:30:46.597

视频游戏仍然使用 C++。想到的一个例子是可用于 iphone 和 xbox 游戏开发的 Torque 引擎。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-11T19:52:48.327

C++ 并没有接近死亡，正如其他人所建议的那样，不要将自己嫁给一门语言。如果您在工作前景方面学习 C++，我宁愿建议您选择编程范式的代表。

*   C - 命令式编程
*   C++/Java/Obj-C - OOP
*   Lisp/Haskell/Scheme - 函数式编程

适应范式通常比学习语言本身更难。希望其他人能提出其他建议。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-11T16:33:22.550

许多国防承包商，特别是在处理硬件时，使用 C++

许多先进医疗设备（例如 MRI）的制造商使用 C++。

我说如果可以的话，两个都学。即使您最终使用像 C++/C# 这样的沙盒语言，拥有 C++ 基础也很好。太多人不了解基础知识。

请注意，不同城市的大部分工作都使用特定语言。前往您认为最终会进入的城市的 craigslist 工作委员会，看看他们寻求什么。例如，匹兹堡是一个 C# 城镇，而纽约则更加平衡。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-02-11T17:06:56.760

C++ 仍然广泛用于工程应用，例如高端 CAD/CAM 系统。

*我认为本机代码*的消亡被夸大了。甚至微软也放弃了在 Visual Studio 2008 中将 C++ 全部用于 .NET。它似乎再次积极改进其原生 C++ 开发工具，并使与托管世界的互操作更加容易。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-02-12T01:01:00.487

我的建议，学习 C#。这些天来，几乎 50% 的工作列表是 Java，几乎其他 50% 是 C#，只有少数列出 C++。

也就是说，使用 C++ 的人知道他们为什么要使用它，并且可能有很好的用例……这意味着您将真正学习如何在最高级别使用该语言……同时公司在 Java 中推出业务逻辑应用程序/C# 可能不会很快教你太多关于编程的知识。

如果您决定从事 C++ 工作，请确保该商店有效地使用 STL 并且他们正在使用 Boost。不是考虑使用 Boost/STL，而是实际使用它。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-11T16:32:12.863

关键词：银行（金融机构）、游戏

哦，还有粒子物理学家和其他使用著名的[ROOT](http://root.cern.ch/)框架的科学家。

并查看[这个](http://www.research.att.com/~bs/applications.html)基于 C++ 的应用程序列表。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-02-12T14:37:30.727

Bjarne Stroustrup 有一份用 C++ 编写的[公司/应用程序列表。](http://www.research.att.com/~bs/applications.html)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-11T16:34:35.370

您的大学没有任何基于 Java 的课程？这很奇怪！

您不仅应该学习 C++ 和 Java，还应该接触多种语言和范式

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-11T17:31:26.327

我倾向于同意你表弟的观点。Java 肯定用于更多的企业应用程序（想想银行或保险公司需要的东西），而 C++ 用于更多“利基”市场。我也同意你的观点，Java 比 C++ 更容易学习和掌握。承认这一点没有羞耻或冒犯。

我们在我工作的地方都使用，用 C++ 编写嵌入式软件，但通过用 Java 编写的 GUI 应用程序与之通信。对于这两种（以及更多）语言，软件行业肯定有足够的空间。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-12T01:03:27.627

大多数打包软件仍然是用 C++ 编写的。这意味着游戏、办公应用程序、图形和视频编辑器以及操作系统。事实上，如果您想到您每天使用的不在线软件，它很可能是用 C++（或 C 或 Objective-C）编写的。它不是用 Java、Python、Ruby、Perl 等编写的。虽然打包软件变得不那么流行了，但它仍然被大量使用并且不会很快消失。

操作系统，无论是嵌入式操作系统还是桌面操作系统，几乎都是用某种 C 语言编写的。已经尝试用 Java 或 C# 编写它们，但都没有成功。您所有的驱动程序也是用一些 C 变体编写的。我认为这种情况不会很快改变。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-11T16:50:20.013

Java 非常棒，除非您必须开始关心它抽象出来的细节。大多数人不需要这样做。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-11T17:27:22.840

我的建议是掌握你更喜欢的任何一种语言。我非常了解 C++ 和 Java，并且都专业地使用过。但是，我永远不会接受另一份 C++ 工作，因为我发现 C++ 乏味且令人麻木。我宁愿花时间掌握更有趣的语言。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-11T19:16:46.213

很长一段时间以来，我一直在使用 C++ 编写主要用于制造和电信公司的内部和外部桌面应用程序，并且在 16 年中只全职使用 Java 大约 1 年。

Java 似乎从来没有像他们在 90 年代中期刚问世时所预测的那样接管桌面，现在 C++ 似乎有来自 .net 和 AJAX/web 应用程序的更多竞争。

我真的不能说它在后端系统中的使用，但我在那里看到的比我看到的 C++ 更多，所以这取决于你在谈论什么样的编程（例如面向用户与内部系统） .

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-12T01:24:31.117

好吧，我建议学习多于几种语言。我在通信行业工作，是的，我们使用 C++，但是我们正在进行的很多项目也是用 Java 编写的。

我建议你学习：

1) C++ / C 2) Java 3) Erlang 或 Haskel 4) Ruby

这将帮助您理解存在于一种语言中但不存在于另一种语言中的概念。也有助于适销性。

看看[tiobe 编程索引](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)，你就会对正在兴起的语言有所了解。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-11T17:06:06.107

C++ 在嵌入式系统中大量使用。它被用于 UI 开发。例如。著名的 QT 框架是用 C++ 编写的。

最终这取决于你想做什么。如果你想在嵌入式系统中工作，最好学习 C/C++。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-11T18:58:00.160

我在从事嵌入式设备工作的工作中经常使用 C 和 C++。我们在这里也不是在谈论超低级的东西。我做中级和 UI 工作。想想 Qt、Gtk+、Windows Mobile SDK 等。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-11T19:40:39.167

ISV 大量使用 C++。想想微软、Adobe、甲骨文、Sun、赛门铁克……

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-12T01:09:25.350

我不得不一直滚动到底部才能看到一篇提到电子游戏的帖子。C 和 C++ 在该行业中是巨大的。

至于“我应该学习什么问题”。这是非常开放的，你想尽可能多地学习。所以是的，你应该同时学习它们。正如一些人所说，C# 也是一个不错的选择。您还应该学习 Python、Ruby 或 PHP 以及一些 Web 框架（Rails、Symfony、Django、ASP.Net）。如今，Web 应用程序非常庞大。

如果您的泡沫仅由 C++ 组成，那么您将不会很有市场。

**编辑：**哎呀，我想游戏被提及的次数比我最初在这里看到的要多得多。我的错。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-02-12T01:14:58.597

游戏行业似乎永远都在使用**C++ 。**

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-10-16T20:41:11.487

在我的职业生涯中，我开发了 C++ 用于：

*   服务器应用（证券行业）
*   嵌入式软件（无线电信）
*   桌面应用软件（无线电信）

我还看到了很多针对国防工业中 C++ 开发人员的广告。C++ 开发人员有很多工作要做，虽然没有过去那么多，但仍然有很多工作要做。

虽然我说学习 Java 并没有什么坏处，但掌握它是一项很好的技能。

# java - 如何创建加密的 Jar 文件？

> ID：537596
> 
> 赞同：18
> 
> 时间：2009-02-11T16:26:19.337
> 
> 标签：java, sqlite, encryption, jar

我正在研究必须保护数据（显示代码不是主要问题）文件的项目。我们正在使用 Java + Netbeans。是否有任何工具可以创建加密格式的 jar？我们也将 sqlite 用于数据库 - 因此将文本文件以加密格式放置对我们来说也是不合适的选择。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-11T16:36:44.197

创建加密的 JAR 是不可能的，因为正在执行的 JavaVM 必须能够以某种方式读取它想要执行的数据。与虚拟机类似，任何拥有适当工具和专业知识的人都可以从 JAR 中提取所有数据。

如果可以加密 JAR，您还必须向想要执行 JAR 的客户端提供一些解密密钥或工具，这完全违背了加密的目的。

你能得到的最好的就是混淆，但这对于野心勃勃的攻击者来说并不是真正的安全或障碍。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-11T20:38:03.147

Kosi2801 几乎是正确的。我能想到你唯一能做的就是以下，但这很丑陋。

1.  运送一个小的标准 JAR 和一个加密的数据文件。
2.  当 JAR 运行时，它将（一些）加密数据文件解密到内存中（就像 JAR 中数据所在的目录，基本上是一个简单的指针/长度对的内存文件系统）
3.  设置你自己的类加载器，当被调用时，从 JAR 中获取正确的加密字节（使用 #2 中描述的伪 FS 表），解密它，然后从那里加载类数据

这将让您加载类。你可以做同样的事情（没有类加载器）来加载其他资源。

虽然实现起来很有趣（对于那些喜欢挑战的人来说），但有一些问题：

1.  您需要能够解密这些内容，因此用户必须每次都输入密码或类似的东西。如果 JAR 知道足以解密它自己，那么任何人都可以查看它并弄清楚如何解密。这可以通过通过 Internet 联系已知良好的服务器以请求解密密钥来缓解（只要您使该过程安全）。当然，任何时候有人想要运行程序都需要一个有效的网络连接。
2.  **一切都在记忆中结束**。如果没有处理微小位加密字节码的自定义 JVM（正如 Cameron McKay 所提到的），这些类最终会在某个时刻被解密并存放在主内存中。除非您依靠操作系统来阻止其他人读取该内存，否则您已经输给了任何有一点时间的人。您尝试从某些加密存储中读取的资源（例如图像/字体/等）的相同问题。

所以你可以给人们绕路，让事情变得更难，但在你已经给予的情况下，你所能做的就是试图让其他人不得不投入的时间变得不值得。

软件保护很困难，尤其是像 Java 这样的东西，它可以很容易地被反编译，并且不能像 C/Assembly 那样改变它自己的代码。有一些最昂贵的软件需要硬件加密狗或锁定到某个 CPU 或其他硬件是有原因的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-10T11:58:47.467

我同意 Kosi2801。类文件加密只是对安全性的模仿（参见[http://www.excelsior-usa.com/articles/java-obfuscators.html](http://www.excelsior-usa.com/articles/java-obfuscators.html)） 使用自定义类加载器可能会破坏应用程序，例如在应用程序服务器中。

有更好的方法：在类文件中使用字符串常量的加密。大多数商业混淆器都有这个功能，例如[Allatori](http://www.allatori.com/)、[Stringer Java Obfuscation Toolkit](https://jfxstore.com/stringer)、[Zelix KlassMaster](http://www.zelix.com/klassmaster/index.html)、[Smokescreen](http://www.leesw.com/smokescreen/)、[DashO](http://www.preemptive.com/)（超级昂贵）。Stringer Java Obfuscator 具有*调用上下文检查和完整性控制功能*，这使得保护非常难以破解。

最安全的方法是在 JavaCard 等外部​​设备上存储和执行部分字节码。

注意，我是 Licel LLC 的首席执行官。Stringer Java 混淆器的开发者。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-15T09:57:41.797

一般来说，如果您希望应用程序及其数据是独立的，则无法以安全的方式执行此操作。但是，您当然可以加密文件并使用隐藏在代码中的密钥对其进行解密。一个坚定的黑客可以得到它，但如果这不是你所担心的，那很好。如果您这样做，请记住加密数据无法压缩，因此请先压缩，然后再加密。

如果您确实需要确保数据安全（例如机密数据），您将需要使用密钥加密数据并通过某些外部方式将该密钥提供给应用程序，例如将其放在拇指驱动器上并将其发送到用户通过安全的快递。

另一种可能性是通过 SSL 使数据（或密钥）可用，并使用良好的身份验证方法来验证您的用户是谁。

一般来说 - 任何系统都不可能完全安全，但也不是必需的。系统只需要足够安全以阻止您认为会试图破解它的攻击者。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-11T16:53:14.093

另一种选择是制作一个自定义 JVM，它可以即时解密 JAR。但同样的问题仍然存在：在某些时候，JAR Java 类必须被解密才能由 JVM 运行，并且此时它们可以被捕获和反编译。

更不用说拥有自定义 JVM 将要求所有用户也下载该 JVM。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-11T17:17:21.523

您可以使用 CipherOutputStream 和 CipherInputStream 以加密格式将 Java 对象序列化到磁盘。这可能是一个用于保存数据的选项。

# eclipse - Eclipse：如何将 JavaDoc 附加到多个 JAR 文件？

> ID：537600
> 
> 赞同：4
> 
> 时间：2009-02-11T16:27:18.960
> 
> 标签：eclipse, javadoc

我正在使用 Eclipse 3.4.1。

我有一个由一堆 JAR 文件和一些 HTML JavaDoc 组成的外部库。我知道我可以将 HTML JavaDoc 附加到各个 JAR，方法是转到它们的 Properties 页面、JavaDoc 位置并将其设置在那里。

但是为每个单独的 JAR 执行此操作会很痛苦。是否有可能以某种方式一次完成它们？JavaDoc 的位置对它们都是一样的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T16:38:52.753

不是真正推荐的解决方案，但您可以为其中一个进行设置，然后手动编辑项目`.classpath`文件，复制相关部分并将其粘贴到其他元素中。不过，这并不比为每个单独设置要容易得多。

此外，如果您有权访问源文件，则可以使用这些文件而不是 Jar 文件，后者将提供 Javadocs。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-15T20:12:48.430

我有一个相关的问题，关于如何有效地为来自 Maven 存储库中的内部项目的数十个 JAR 文件附加 JavaDocs。解决方案是使用 Maven JavaDoc 插件为每个项目自动[构建和安装 JavaDoc 和 Source 工件](http://maven.apache.org/plugin-developers/cookbook/attach-source-javadoc-artifacts.html)。然后在 Eclipse 中，我可以通过右键单击项目->Maven->Download JavaDoc 一步导入所有这些资源。然后 Shift-F2 发挥它的魔力。

该过程仅适用于不在我的 Eclipse 工作区中的依赖项。对于我的每个 Eclipse 项目，我仍然必须手动配置其 JavaDoc 位置，但至少这些位置更少。

这是一个相关主题： [当 javadoc 未附加到依赖项时，如何在 Maven 的 eclipse 插件中将 javadoc 引用到依赖项](https://stackoverflow.com/questions/44396/how-to-reference-javadocs-to-dependencies-in-mavens-eclipse-plugin-when-javadoc)

# unit-testing - 单元测试第三方 ORM

> ID：537606
> 
> 赞同：6
> 
> 时间：2009-02-11T16:28:45.447
> 
> 标签：unit-testing

我已经阅读了一些关于对各种应用程序进行单元测试的有用性的主题。意见的范围可以从“始终测试所有内容”到“单元测试无用”，以及介于两者之间的所有内容（“测试有意义的地方”）。我倾向于向中间倾斜。

这引出了我的问题。我正在尝试决定是否有一些基本的单元测试来测试此 SO 帖子中建议的 3rd 方 ORM： [link text](https://stackoverflow.com/questions/520830/type-of-projects-where-unit-testing-is-useless/520931#520931)

> 根据您使用该工具的方式，一些基线测试可能有助于防范未来的重大变化。例如，不要模拟整个 n 层链（我不喜欢在没有必要时进行模拟），只需使用 ORM 工具来创建、读取、更新和删除一个典型的对象/记录，并且使用（测试）数据库上的直接 SQL 语句验证操作。这样，如果第 3 方供应商后来更新了一些破坏了您将了解的基本功能的东西，并且您项目的新开发人员可以轻松地从单元测试示例中了解如何使用 ORM 工具。

我对这个建议的主要保留意见是，它需要太多的设置，维护起来很麻烦，而且总的来说它在我们的环境中不实用。以下是一些需要考虑的要点的摘要：

1.  我们使用的 ORM 需要创建静态数据源对象并将其注册到其数据访问层并与经过身份验证的用户相关联。这将需要大量的测试设置，并且在没有用户登录的构建服务器上可能会出现问题。
2.  ORM 供应商在发布新更新和不破坏基本功能方面有着良好的记录。此外，每当需要将 ORM 更新到最新版本时，我会想象该应用程序不会直接投入生产，但无论如何都会进行彻底的回归测试。
3.  在这种环境下，为单元测试维护测试数据库有点问题。每次主要版本发布后，测试数据库都会被清除，并被敏感数据混淆后的 db 备份所取代。我想为了有一个用于 ORM 单元测试的测试数据库，我们需要运行一些脚本/代码，将数据库设置为“测试”状态。再次设置和维护过多。
4.  最后是针对新开发人员的 ORM 文档/帮助。我可以看到类似的东西是如何有用的。但是 ORM 供应商为演示应用程序提供了非常好的文档/帮助。因此，在此基础上编写单元测试似乎并不值得付出所有努力。

那么，是否值得为了确保 ORM 完成它应该做的事情（即 CRUD）而经历所有这些麻烦？无论如何，这不应该是供应商的责任吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T16:36:26.753

你自己说的。测试有意义的地方。如果测试 3rd 方 ORM 会让你“感觉”更好，那就去做吧。但是，最终，您信任他们的工具。如果 ORM 突然停止工作，你会怎么做？您是否针对它编写了足够多的代码，以至于无法轻易将其撕掉？你可能会等待他们修复它。

基本上，您必须将 3rd 方工具视为众所周知的黑匣子，让他们做您买来做的事情。这就是你付钱的原因，对吧？为了避免不得不自己写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T16:36:04.713

在这种特殊情况下，我不会打扰。我认为你在这里假设一个糟糕的投资回报率是正确的。

是的，我认为这是供应商的责任。我期望（并假设）他们的东西有效。我就是这样对待我的供应商的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T16:37:12.197

供应商有责任确保 ORM 做它应该做的事情，但你有责任确保你的应用程序做它应该做的事情，如果它因任何原因失败，你的客户会不高兴，甚至如果它“只是”因为 ORM 失败了。

您的测试可以确保 ORM 以您期望的方式工作，并按照您调用它的方式进行。ORM 可能会以一种不会“损坏”的方式发生变化，但它不能很好地与您的应用程序配合使用。

话虽如此，如果您对 ORM 有信心，并且觉得设置和维护任何类型的 ORM 自动化测试不值得付出努力，那可能是不值得的，特别是如果您有其他级别的测试如果出现问题，可能会揭示问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T16:38:17.607

我个人认为真正的单元测试应该只测试应用程序本身，所有需要单独部署和配置的东西都应该模拟出来。

您所说的是编写一些集成/功能测试，以端到端地测试整个系统。这些永远不会是轻量级的，但在某些情况下可能仍然有用（例如，如果您的系统没有太大变化并且同时对您的公司至关重要）。我也见过这样的测试自动化，使用虚拟服务器（VMWare 或 microsoft 等价物），以及在每次测试运行之前从文件中恢复的示例数据库。您也可以只设置一次 ORM，并接受测试将失败主要是因为配置会中断。显然你可以测试更多，但要知道成本更高。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-31T09:17:42.627

测试 3rd 方 ORM 库完成其工作根本不是单元测试。但是，这不是你问题的重点。

正如在 Michael Feathers 的“有效地使用遗留代码”或 Eric Evans 的“领域驱动设计”或 Robert Martin 的“清洁代码”等书籍中多次说过的那样，您的第 3 方 ORM 库是一个技术细节，应该是从您的代码库中抽象出来，正是因为您无法根据定义控制第三方库。如果他们改变，你适应。

因此，您的解决方案是围绕这个 ORM 库创建一个包装器，将理想的与域相关的接口发布到您的应用程序的其余部分，但通用接口也可能会这样做。您需要使用全栈自动化测试来测试这个包装器，这不可避免地应该设置您的应用程序以及数据库以及它所需的所有配置和准备。此测试不是单元级别的，预计会非常慢。

您可以在 Paul M. Duvall 所著的“持续集成”一书的第 6 章中了解不同级别的测试以及如何设置它们。

在为您的应用程序级别编写真正的单元级测试时，您可以在 ORM 库之上模拟包装器，因为您控制包装器的代码，所以您可以这样做。

这是一种标准做法。它的明显好处是，当您决定更新 ORM 库或（很有可能）当您的客户/老板决定切换到该 ORM 不兼容的另一个 ORM 或数据库时，您将获得有关的即时反馈来自包装器测试的回归错误，您需要做的就是适应包装器内部的变化。

顺便说一句，“过多的维护负担”是缺乏自动化造成的谬误。

# editor - 管理语义网的工具

> ID：537610
> 
> 赞同：0
> 
> 时间：2009-02-11T16:29:08.677
> 
> 标签：editor, semantic-web

我见过很多框架来创建语义网（或者更确切地说是它下面的模型）。有哪些工具可以在桌面上创建小型语义网络或存储库，例如用于个人信息管理。

请包括信息对于临时用户来说这些是多么容易使用（与在该领域工作多年的人相比）。所以我想听听哪些工具可以创建没有很多类型的存储库，以及当您了解您的问题域时，您可以稍后在哪里键入节点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T12:56:12.323

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T19:28:06.327

Extensive list of [semantic web tools](http://esw.w3.org/topic/SemanticWebTools)

Also check out [Protege](http://protege.stanford.edu/overview/po-screenshots.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-26T16:58:40.923

If you need to create a small model, then I suggest that you use [topbraid](http://www.topquadrant.com/products/TB_Composer.html). I have used for creating much larger models and I know people who have used to create humongous models. It comes packaged with a set of reasoners and provides ability to plug-in custom reasoner and in case if you decide to make your model larger, you can even integrate Topbraid with a triple store like Allegrograph.

And since its based on eclipse, to get started with it is relatively easier.

For developers who are spoiled working in more matured programming languages like Java (IDEA ? anyone), topbraid is the closest tool to an actual IDE.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-11T16:30:24.803

[Chandler](http://chandlerproject.org/)是一个“可以组织、备份和共享的笔记本！” 使用起来似乎很简单。

操作系统：Windows、Mac、Linux

# sql-server - SQL Server SMO 抱怨缺少 DLL

> ID：537613
> 
> 赞同：13
> 
> 时间：2009-02-11T16:29:45.693
> 
> 标签：sql-server, dll, smo

好的，我已经搜索了网络，BOL，各种论坛，但我离答案还很近……希望你们这些好人可以伸出援助之手……

我们在网络上有十几个 SQL Server（一些 2k，一些 2005）。我在 .NET 应用程序中使用 SMO 对象来获取一些标准信息。我的问题似乎归结为缺少 DLL - Microsoft.SqlServer.BatchParser.dll。但是，此 DLL 不附带其他 SQL DLL（Microsoft.SqlServer.ConnectionInfo.dll、Microsoft.SqlServer.Smo.dll、Microsoft.SqlServer.SmoEnum.dll、Microsoft.SqlServer.SqlEnum.dll 等...） . 我还从 Microsoft 的站点下载了包含 SMO 对象的 SS2005 功能包，但仍然没有运气。

以下代码有效，除非我取消注释当前注释的行，在这种情况下，我会收到以下错误：

```
protected void btnArchive_Click(object sender, EventArgs e)
{
    ServerConnection conn = new ServerConnection("my_server");

    conn.LoginSecure = false;
    conn.Login = "my_login";
    conn.Password = "my_password";

    Server s = new Server(conn);
    Database d = s.Databases["my_database"];
    //Table tbl = d.Tables["my_table"];

    Response.Write(s.Name + " " + s.Information.RootDirectory + " " + d.CreateDate.ToShortDateString());
    conn.Disconnect();
} 
```

错误：无法加载文件或程序集“Microsoft.SqlServer.BatchParser，Version=9.0.242.0，Culture=neutral，PublicKeyToken=89845dcd8080cc91”或其依赖项之一。该系统找不到指定的文件。

请注意，我也使用 VB.NET 从 SSIS 尝试过这个，同样的行为。

任何想法将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-15T18:58:53.293

我能够使用程序集“Microsoft.SqlServer.ConnectionInfo”、“Microsoft.SqlServer.Management.Sdk.Sfc”和“Microsoft.SqlServer.Smo”的 10.* 版本成功运行您的代码。尝试下载[2008 版本的 SMO 组件](http://go.microsoft.com/fwlink/?LinkId=123708&clcid=0x409)，也许这是他们现在修复的错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-12T06:41:42.943

您是否在您的机器上运行 x64 操作系统？BatchParser.dll 在 64 位环境中似乎存在问题 - 通常建议从 Microsoft 下载[SMO x64 包](http://download.microsoft.com/download/4/4/D/44DBDE61-B385-4FC2-A67D-48053B8F9FAD/SQLServer2005_XMO_x64.msi)(SQLServer2005_XMO_x64.msi)。

[在此处](http://www.microsoft.com/downloads/details.aspx?familyid=D09C1D60-A13C-4479-9B91-9E8B9D835CDC&displaylang=en)查看有关此信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-15T15:11:51.893

我知道我在这里聚会很晚了，但这仍然是您在谷歌搜索“smo batchparser”时的第一个结果。

安装 SMO 2014 (12.0.x) 时，某些 DLL 仅安装到 GAC。要使您的应用程序无需在目标服务器中手动安装 SMO 即可运行，您必须将这些 DLL 与您的应用程序一起复制。这是我从中获得它们的路径。

> C:\Program Files\Microsoft SQL Server\120\SDK\Assemblies\Microsoft.SqlServer.ConnectionInfo.dll
> 
> C:\Program Files\Microsoft SQL Server\120\SDK\Assemblies\Microsoft.SqlServer.Management.Sdk.Sfc.dll
> 
> C:\Program Files\Microsoft SQL Server\120\SDK\Assemblies\Microsoft.SqlServer.Smo.dll
> 
> C:\Program Files\Microsoft SQL Server\120\SDK\Assemblies\Microsoft.SqlServer.SmoExtended.dll
> 
> C:\Program Files\Microsoft SQL Server\120\SDK\Assemblies\Microsoft.SqlServer.SqlEnum.dll
> 
> C:\Windows\assembly\GAC_64\Microsoft.SqlServer.BatchParser\12.0.0.0__89845dcd8080cc91\Microsoft.SqlServer.BatchParser.dll
> 
> C:\Windows\assembly\GAC_MSIL\Microsoft.SqlServer.BatchParserClient\12.0.0.0__89845dcd8080cc91\Microsoft.SqlServer.BatchParserClient.dll
> 
> C:\Windows\assembly\GAC_MSIL\Microsoft.SqlServer.SqlClrProvider\12.0.0.0__89845dcd8080cc91\Microsoft.SqlServer.SqlClrProvider.dll

[要访问 GAC 文件，您需要使用本文](http://blogs.msdn.com/b/johnwpowell/archive/2009/01/14/how-to-copy-an-assembly-from-the-gac.aspx)提供的说明禁用 Windows 内置查看器。

为方便起见，摘录文章：

> 打开注册表编辑器并添加/设置 HKLM\Software\Microsoft\Fusion\DisableCacheViewer DWORD 值：1

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-21T05:42:16.137

您需要安装以下包来解决问题，我已经用这个包解决了这个问题两次希望它也适用于每个人......

Microsoft SQL Server 2005 管理对象集合 管理对象集合包包括 SQL Server 2005 管理 API 的几个关键元素，包括分析管理对象 (AMO)、复制管理对象 (RMO) 和 SQL Server 管理对象 (SMO)。开发人员和 DBA 可以使用这些组件以编程方式管理 SQL Server 2005。

您可以从 Microsoft 站点的 Microsoft SQL Server 2005 - 2008 年 12 月的功能包中获取

> [http://www.microsoft.com/en-us/download/details.aspx?id=11988](http://www.microsoft.com/en-us/download/details.aspx?id=11988)

但是下载页面的链接位置每次都会改变，如果你没有找到资源，你也可以从我的博客下载它。

[如果您想要http://rndp-android.blogspot.com/p/missing-microsoftsqlservermanagementsdk.html](http://rndp-android.blogspot.com/p/missing-microsoftsqlservermanagementsdk.html)，我还在我的博客中提供了一些提示和资源

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T18:41:53.473

只是为了让我们正确理解问题，Microsoft.SqlServer.BatchParser.dll 没有安装在您开发机器上的全局程序集缓存中？如果是这样，您可能需要从重新安装 .NET Framework（您所针对的 Framework 版本）开始，看看是否能解决问题。

您还可以尝试使用 .NET Framework 配置工具来查看程序集是否确实存在于全局程序集缓存 (GAC) 中。这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/2bc0cxhc(VS.80).aspx)描述了如何使用这个工具。

（搜索我的硬盘驱动器并没有返回 Microsoft.SqlServer.BatchParser.dll 程序集，即使我可以使用 .NET Framework 配置工具看到它）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-06-24T10:54:12.800

它是 2005 或 2008 升级顾问的一部分。

# eclipse - Eclipse：一个 JAR 可以附加多个 JavaDoc 位置吗？

> ID：537614
> 
> 赞同：3
> 
> 时间：2009-02-11T16:29:45.740
> 
> 标签：eclipse, javadoc

我正在使用 Eclipse 3.4.1。

虽然这听起来很奇怪，但我希望能够将多个 JavaDoc 位置附加到 Eclipse 项目中的同一个 JAR。这个特定的 JAR 具有来自两组 JavaDoc 的类。这样做的原因是它是一个 OSGi 包，它包含一个第三方 JAR，以及该 JAR 之上的一些其他第三方代码，以使其在 OSGi 中工作。

如果我拥有这两个包的源代码，并且在 Eclipse 项目中拥有该源代码，它就可以正常工作。但我希望能够在我只有 JAR 和 JavaDoc 的情况下让它工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T16:43:41.793

并非易事，因为有关 javadocs 的信息存储在项目`classpathentry`的`.classpath`文件中，并且它由一个值（目录或存档）组成

解决方案是构建一个包含当前 javadoc 的单个 javadoc，并将该存档附加到 jar 中。

* * *

另一种解决方案（eclipse 可能无法正确解释：待测试）是**指向外部文档的链接**

[使用指向外部文档的相对链接的](http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/javadoc.html#linkrelativeexample)示例：

> 假设您有两个包，它们的文档是在 Javadoc 工具的不同运行中生成的，并且这些文档由相对路径分隔。
> 在此示例中，包是`com.apipackage`、一个 API 和`com.spipackage`、一个 SPI（服务提供接口）。
> 您希望文档驻留在`docs/api/com/apipackage`和`docs/spi/com/spipackage`.
> 假设 API 包文档已经生成，并且 docs 是当前目录，您可以通过运行以下命令记录 SPI 包以及指向 API 文档的链接：

```
C:> javadoc -d ./spi -link ../api com.spipackage 
```

请注意 -link 参数是相对于目标目录 (docs/spi) 的。

因此，如果您仅将第二个 javadoc 附加到 jar 中，它*可能*会选择第一个 javadoc 中记录的类……但我对此表示怀疑。 [http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/javadoc.html#linkrelativeexample](http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/javadoc.html#linkrelativeexample)

# .net - WPF Frame 和 WebBrowser 控件的区别

> ID：537620
> 
> 赞同：10
> 
> 时间：2009-02-11T16:30:39.997
> 
> 标签：.net, wpf, wpf-controls

我正在开发一个支持网络的媒体中心，它将能够将视频源加载到画廊样式视图中。（像库里里斯）

我计划加载实际视频，而不是加载每个视频的缩略图，以便它可以就地播放和/或弹出到全屏。

这意味着我需要在我的 WPF 页面“内部”托管一堆 Flash 播放器实例。

使用 Frame 控件而不是 SP1 WebBrowser 控件有什么优势吗？我知道，虽然 WebBrowser 在技术上是一个包装的 Windows 窗体控件，而 Frame 控件是“本机”wpf，但即使是 Frame 控件也使用 win32 MS.Internal.Controls.WebBrowser 来显示内容。

鉴于这一事实，这两个控件是否大致相同，尤其是在性能方面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T19:40:09.687

最大的不同是 Frame 可以托管 WPF 或 HTML 内容。它是如何通过管道将内容传送到 WPF 或 IE 的，因此它本身不进行任何呈现，并且 WPF 永远不会原生呈现 HTML。因此，如果您需要（或将来可能需要）在同一控件中无缝托管 WPF 或 HTML 内容，那么 Frame 绝对是您想要的。也就是说，我不知道使用 Frame 有什么缺点，所以即使它专门用于 HTML，我也使用它。

# javascript - 我应该在 JavaScript 中使用分号吗？

> ID：537632
> 
> 赞同：43
> 
> 时间：2009-02-11T16:32:27.450
> 
> 标签：javascript

我只编写了少量嵌入在 Java 应用程序中的 JavaScript，但它使用[QUnit](http://docs.jquery.com/QUnit)进行了测试，已经混合使用，我还没有注意到任何问题。

在 JavaScript 中是否使用分号是否有一些传统观念？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-02-11T16:36:57.783

**使用它们。经常使用它们。**

由于您忽略了分号并且它丢失了之前在压缩/生成/评估解析中保存它的空格，因此稍后出现中断太容易了。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-11T16:34:17.587

我会说一直使用它们；您将遇到的大多数代码都使用它们，而一致性是您的朋友。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-11T16:38:26.500

在编写 JavaScript 时，我总是提倡使用分号。通常，口译员能够为您推断出它们；但我还没有看到一个原因（除了懒惰;-)）为什么你会故意以一种不太精确的方式编写你的代码。

在我看来，如果代码的结构很明显，分号的位置就会非常清楚，这样你在习惯之后甚至都不必考虑它（即在每一行的末尾）；另一方面，如果您不能立即清楚分号的位置，那么结构可能不是最明显的，并且在那里比在其他地方*更需要明确的分号。*

它还使您养成在头脑中理解和界定语句的习惯，因此您（不可否认地）更好地理解您的代码如何解析为[AST](http://en.wikipedia.org/wiki/Abstract_syntax_tree)或类似的。在调试语法错误时，这一定是件好事。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-11T16:39:51.443

它们是[ECMAscript 标准](http://www.mozilla.org/js/language/E262-3.pdf)所要求的，见第 7.9 节——只是标准定义了一些规则，允许在解析脚本时自动插入它们。

所以总是使用它们！

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-11T16:38:02.773

使用它们。有几个原因，最值得注意的是

1.  JavaScript 压缩器/压缩器
2.  新行是新表达式的规则的例外情况（例如，以变量终止一行并以括号开始下一行，`)`.）

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-11T16:37:53.147

如果您不使用它们然后[缩小](http://www.jslab.dk/tools.minify.php)代码，您可能会遇到所有代码都在一行中的问题，并且浏览器无法完全掌握哪个命令在哪里结束。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-11T16:35:58.737

分号的基本思想是告诉浏览器你刚刚完成了一个命令。你应该使用它们。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-11T16:40:56.760

分号在我的编辑器中触发自动缩进。我有足够的理由一直使用它。

是的，一致性也是如此。

# direct3d - Direct3D9ex 和 Direct3D10 资源共享

> ID：537650
> 
> 赞同：2
> 
> 时间：2009-02-11T16:35:10.923
> 
> 标签：direct3d, direct3d10

使用 Direct3D9ex，可以在设备之间共享资源。是否也可以将这些共享资源与 Direct3D10 设备一起使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T18:20:51.000

是的，您可以使用此处描述的技术在 D3D9Ex 和 D3D10 设备之间共享资源：

[功能总结（Direct3D 9 for Windows Vista）- 资源共享](http://msdn.microsoft.com/en-us/library/bb219800%28VS.85%29.aspx#Sharing%5FResources)

请注意，GPU 对共享表面的访问是不同步的——例如，如果您同时在两台设备上渲染到相同的渲染表面，则预计会出现各种损坏和竞争。

要解决此问题，请确保一台设备在另一台设备使用它之前完成对共享表面的渲染。一种选择是事件查询（IDirect3DQuery9），另一种是对一个小表面做一个 StretchRect 并锁定它（如果锁定成功，GPU 完成了之前的所有工作）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T17:54:09.923

您可以在设备或进程之间共享 Direct3D9 资源。

[功能总结（Direct3D 9 for Windows Vista）- 资源共享](http://msdn.microsoft.com/en-us/library/bb219800(VS.85).aspx#Sharing_Resources)

类似的技术适用于 Direct3D10 资源（您还可以指定共享句柄）。

这个[GameDev.net 主题](http://www.gamedev.net/community/forums/topic.asp?topic_id=533082)详细讨论了 D3D9Ex 和 D3D10 之间的共享。该主题的结论似乎是，虽然基于文档它应该是可能的（有一些限制），但在实践中它根本不起作用（也许限制非常严重，它们阻止了任何实际使用场景？）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-11T16:48:04.760

如果我错了，请有人纠正我，但是，不，不。

你有什么打算？在两个设备上都有静态纹理？如果是这样，通过将相同的纹理两次加载到两个不同的默认池中很容易实现。请注意，修改一个不一定会修改另一个。

如果您尝试在两个设备上共享托管纹理，我认为这无法通过任何形式的控制来实现。SLI 可能会在幕后进行，但您无法控制它。

如果您想在另一个设备上显式使用从一个设备生成的纹理，则必须从源设备下载它并在每一帧将其上传到目标设备。这会很慢，但如果绝对必要，可以这样做。

# classpath - 当我调用 Jython *而不*将它们添加到 $CLASSPATH 时，如何将 jars 添加到类路径中？

> ID：537682
> 
> 赞同：40
> 
> 时间：2009-02-11T16:39:40.803
> 
> 标签：classpath, jython, jar

我想做类似的事情`jython -cp FOO:BAR:BAZ argle.py`。

如果我添加`FOO`, ,`BAR`和这个作品。我试图在运行时将它们添加到，但这似乎不适用于罐子。如果我在运行时添加扩展 jar 的路径，它*确实有效。*有没有一个简单的替代方法来爆炸 jar 文件？对每个运行此脚本的用户进行增强不是可接受的替代方案。`BAZ``$CLASSPATH``sys.path`*`sys.path``$CLASSPATH`*

 *谢谢。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-02-25T14:58:12.603

您可以使用该`-D`选项进行设置`python.path`：

```
jython -Dpython.path=FOO:BAR:BAZ argyle.py 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-11-19T01:37:05.263

`jython`命令支持将参数传递给`java`命令...所以：

```
jython -J-cp JAR1:JAR2 
```

您可以通过添加`--print`开关来验证生成的命令：

```
jython -J-cp JAR1:JAR2 --print 
```

以上将打印出实际的 java 命令，而不是执行它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-03T22:55:05.090

`java -cp JAR1:JAR2:jython.jar org.python.util.jython pythonScript.py`在 Linux 和 Macintosh 上都可以在这里工作。在 Windows 上，将类路径中的冒号换成分号，您应该会很成功。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-11T16:56:25.413

您可以创建一个包含所有相关类的大 JAR。下面的 ant 片段展示了这个想法：

```
<target name="jar">
    <mkdir dir="build/jar"/>
    <unjar src="lib/jython.jar" dest="${classes.dir}" />
    <unjar src="lib/FOO.jar" dest="${classes.dir}" />
    <unjar src="lib/BAR.jar" dest="${classes.dir}" />
    <unjar src="lib/BAZ.jar" dest="${classes.dir}" />

    <jar destfile="build/jar/bigjython.jar" basedir="${classes.dir}">
        <manifest>
            <attribute name="Main-Class" value="${main-class}"/>
        </manifest>
    </jar>
</target> 
```

# django-models - django - 数据库设计 - 多个表需要 1+ phone_number(s)

> ID：537685
> 
> 赞同：1
> 
> 时间：2009-02-11T16:40:33.080
> 
> 标签：django-models

关于如何设置数据库关系的问题（新手，这可能是微不足道的）

遵循 django 教程（投票，选择）；理解 1 Poll 有很多 Choice(s)，因此许多 Choice(s) 指向一个 Poll。

```
 class Poll(models.Model):
      question = models.CharField(max_length=200)
      ...

   class Choice(models.Model):
      poll = models.ForeignKey(Poll)
      ... 
```

问题：我有一个包含地点、人员等的数据库（多表）。我的表的一个子集有一个类似的字段。我想要一个有 1 个以上电话号码的地方。我希望一个人拥有 1 个以上的电话号码。我可能希望其他表有 1+ 个电话号码。

如果我遵循 Poll/Choice 方法，那么我的问题由下面 PhoneNumber 下显示的问号指示。

```
 class Person(models.Model):
      firstname = models.CharField(max_length=20)
      ...

   class Place(models.Model):
      description = models.CharField(max_length=200)
      ...

   class PhoneNumber(models.Model):
      ??? = models.ForeignKey(???)
      ... 
```

我考虑过使用继承，以便 Person 和 Place 都继承自同一个基类。但除了 phone_number 之外，我可能还有其他字段，我有类似的情况，并且跨越不同的表子集。例如

```
 phone_number(s)     comments
               ---------------     --------
Person         yes                 no
Place          yes                 yes
Contract       no                  yes
... 
```

任何关于如何正确设计这些类型的关系的建议将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T16:50:45.083

我认为您正在寻找[Generic Relations](http://www.djangoproject.com/documentation/models/generic_relations/)。[也在这里](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T16:52:18.027

检查[ContenType](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#ref-contrib-contenttypes)应用程序，特别是[Generic Relations](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#id1)。基本上，您将 person/place 对象的类型和 id 都存储在 PhoneNumber 对象上。

# python - Visual Studio 2008 中内置的 Python IDE？

> ID：537689
> 
> 赞同：16
> 
> 时间：2009-02-11T16:42:09.173
> 
> 标签：python, visual-studio-2008, ide

嗨，我在 Visual Studio 2008 中进行了很多开发，并希望找到一个像 vsphp 这样的插件，它可以在 Visual Studio 中启用智能感知和调试。IronStudio 是我要找的吗？据我了解 IronStudio 是 .NET 的插件。

如果没有适用于 Visual Studio 2008 的插件，那么对于喜欢 Visual Studio 的 python 新手来说，这是一个很棒的 IDE（讨厌 netbeans 和 eclipse，对不起，只是感觉不到爱）

另外，如果 IronPython Studio 是一个 IDE，我需要隔离版还是集成版？好像没看懂名字

我安装了集成并得到了这个：[http](http://dl.getdropbox.com/u/5910/Jing/2009-02-11_1750.png) ://dl.getdropbox.com/u/5910/Jing/2009-02-11_1750.png :(这里没有控制台：http: [//www.codeplex.com/IronPythonStudio](http://www.codeplex.com/IronPythonStudio)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T16:55:48.643

看看[PyScripter](http://code.google.com/p/pyscripter/)，我没有广泛尝试过，但听说过它的好消息。

它不是 Visual Studio 的插件，它是一个独立的 IDE。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-11T16:48:18.113

当我第一次开始用 Python 编写代码时，我也遇到了类似的困境。我找不到 VS 的任何插件，所以我尝试了一些替代方案：

*   IDLE - 与 Python 一起打包并且可以工作，但对我来说感觉很笨拙
*   [Wingware Python IDE](http://www.wingware.com/) - 不是免费的，但似乎有相当不错的调试能力
*   [e-texteditor](http://www.e-texteditor.com/) - 有很好的语法突出显示，但从它运行 Python 脚本经常会导致问题。
*   带有[PyDev的](http://pydev.sourceforge.net/)[Eclipse](http://www.eclipse.org/) - 是我现在使用的 - 语法突出显示、自动完成、调试功能等等等。

有几个可能对您有用的选项的评论：

*   [Jonathan Ellis 的编程博客](http://spyced.blogspot.com/2005/09/review-of-6-python-ides.html)
*   [维基百科](http://en.wikipedia.org/wiki/Comparison_of_integrated_development_environments)

就个人而言，我推荐 Eclipse + PyDev :-)

**[编辑]** Iron Python 看起来很酷 - 可能需要检查一下！

**[更新 25/04/2013]**这些天我只使用[PyCharm 。](http://www.jetbrains.com/pycharm/)绝对出色的 IDE，它甚至可以理解 DJango

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T16:54:35.963

如果您有 Visual Studio 2008 和 VS 2k8 Shell Integrated Redistributable 包，IronPython Studio Integrated 将插入 VS 2k8 IDE。

[Visual Studio 2008 Shell（集成）](http://www.microsoft.com/downloads/details.aspx?FamilyID=40646580-97FA-4698-B65F-620D4B4B1ED7&displaylang=en)

[Visual Studio 2010 beta 2 Shell（集成）](http://www.microsoft.com/downloads/details.aspx?FamilyID=c6a64e02-6fd6-41e3-a3fd-399d174a84b7&displaylang=en)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-07-20T07:13:11.747

基于 Java 的 IDE 并不好，它们往往很胖、很慢而且很粗糙。Eclipse 的编程范式很差，这会造成不必要的混乱。许多 IDE 供应商犯了一个错误，他们放弃了他们的原生产品，转而基于 Eclipse。他们无法区分自己，体验很糟糕。其实真的很丢脸。VS需要竞争，但他们都翻身而死。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-06-15T03:46:43.187

[用于 Visual Studio 2010 的 IronPython 工具集成](http://www.ironpython.net)得相当好。我知道你要的是 2008 年，但现在 2010 年已经过去了；）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-03-10T11:00:21.353

适用于 Visual Studio 2010 的 Python 工具现已推出[http://ironpython.codeplex.com/releases/view/41236](http://ironpython.codeplex.com/releases/view/41236)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-11T17:33:52.840

我将支持 Jon 的建议之一：PyDev 和 Eclipse。如果您已经在使用 Eclipse 进行其他开发，那就太好了。

您可以从这里获取它（以及指向 Eclipse 平台的链接）：http: [//pydev.sourceforge.net/download.html](http://pydev.sourceforge.net/download.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-04T21:33:23.470

IronPython 和 Visual Studio 的 Python 工具 (PTVS) 是不同的东西。

PTVS [http://pytools.codeplex.com/](http://pytools.codeplex.com/)是 Microsoft 开发部门的 Visual Studio 2010 的免费开源插件。它允许您使用 Visual Studio 编写 Python 代码，从而获得使用 Visual Studio 的所有主要生产力功能的好处。

PTVS 与 IronPython 和 CPython 兼容，它们是运行代码的 Python 发行版。

CPython 是传统的 Python 发行版，而 IronPython [http://ironpython.net](http://ironpython.net) 是一个替代品，它允许您在 .Net 上运行 python 并允许您在应用程序上使用其他 .Net 库。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-24T02:43:28.427

你为什么不试试 Aptana 工作室。它类似于 Eclipse 和 PyDev。但是是一个基于python和web开发的独立IDE。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-01-23T14:38:25.557

三种不同的东西 - Visual Studio 的 Python 工具 - IronPython - IronPython Studio

只有最后一个（我认为）允许视觉 Gui 设计。但它已经死了

# javascript - 按键事件后获取表单字段的值

> ID：537690
> 
> 赞同：15
> 
> 时间：2009-02-11T16:42:10.873
> 
> 标签：javascript, forms, dom-events

`myInput.value`当我在`keyPress`事件处理程序中检查它时，是一个击键。因此，如果用户键入“a”，`myInput.value`则给我“”。然后当用户键入“b”时，`myInput.value`给我“a”，依此类推。该值似乎不会随着触发事件的击键输入的字符而更新。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-11T16:48:44.853

使用 keyUp 事件，它肯定会给你你正在寻找的价值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-05T17:34:54.000

当我遇到这个问题时，我真正想要的是[`oninput`](https://www.w3schools.com/jsref/event_oninput.asp)事件处理程序。

这与 keyUp 解决方案之间的一个显着区别是，如果您按住一个键重复它，则每次重复该键时都会调用 oninput，但只有在释放键时才会调用 keyUp。

# c# - ASP.Net 自动生成的管理工具

> ID：537695
> 
> 赞同：1
> 
> 时间：2009-02-11T16:43:40.123
> 
> 标签：c#, asp.net

我需要创建一个管理站点来管理我的网站的数据库。我不想自己构建它，我只是想要框架到位，以便在它到位后我可以自己添加自定义。

Django 有一个很棒的自动生成管理员。什么是在 asp.net 下构建的等效自动生成的管理站点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T16:45:51.630

[http://www.asp.net/dynamicdata/](http://www.asp.net/dynamicdata/)

所有表的脚手架 (CRUD)，或者可选地只选择您选择的表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:46:06.153

您可以使用[ASP.NET 动态数据](http://www.asp.net/dynamicdata/)来做类似的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T16:45:46.717

看看 IronSpeed Designer (www.ironspeed.com)。

# asp.net - ASP.NET 应用程序 MSI 安装程序多个实例

> ID：537698
> 
> 赞同：6
> 
> 时间：2009-02-11T16:44:17.640
> 
> 标签：asp.net, visual-studio-2008, installation, windows-installer

我希望能够从 VS08 生成单个 MSI，该 MSI 可用于在同一 IIS 中的同一网站上安装同一应用程序的演示、登台和生产版本。换句话说，用户需要控制他们想要多少个实例——我无法通过改变产品代码来预先生成它们（尽管实际上会有一个现实的上限为 10 ）。 `<EDIT>`转换路线需要类似的先验知识 AFAICT（[bott 建议了这条路线](https://stackoverflow.com/questions/537698/asp-net-app-msi-installer-multiple-instances/577050#577050)，虽然它会起作用，但不会带来很好的客户体验）`</EDIT`>。

[我的问题](http://www.google.com/search?q=msi%20asp.net%20multiple%20instances)的其他实例存在，但没有答案：

*   [对 Scott Hanselman 博客的评论](http://www.hanselman.com/blog/WebPlatformInstallerNowSupportsXPAndTheMasterPlanContinues.aspx#975ba864-4efd-4e90-aa34-918342ab4b0b)
*   [http://forums.asp.net/p/565248/565248.aspx](http://forums.asp.net/p/565248/565248.aspx)

理想的答案是带有 VS08 的 OOTB，但如果这是另一个死胡同，我不会感到惊讶。（顺便说一句，我见过的关于 MSI ASP.NET 安装程序的最佳信息是[这个 scottgu 帖子](http://weblogs.asp.net/scottgu/archive/2007/06/15/tip-trick-creating-packaged-asp-net-setup-programs-with-vs-2005.aspx)）。

MSDEPLOY 似乎在我的小巷里，所以我正在寻找一些包装它的东西，只是我希望能够支持非服务器操作系统，如 XP 和 Vista。

我看到了即将推出的 InstallShield 产品的迹象，它似乎就是这样做的，基于 10 年前的痛苦，我很想避免，但并不完全反对切换到不那么痛苦的东西。一个附带的好处是我的 [TeamCity] CI 服务器不需要无缘无故地被 VS 的副本污染（不，我绝对不需要将它保留在那里运行 MSTEST :D）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T09:46:53.100

你读过这个吗？ [安装产品和补丁的多个实例](http://msdn.microsoft.com/en-us/library/aa369523(VS.85).aspx)

我的建议是使用[wix](http://wix.sourceforge.net/)。您可以使用当前的 msi 并使用“dark”对其进行反编译。dark 从您的 msi 创建您需要的所有 xml 文件。然后您可以使用 wix 进行更改，然后您可以将这些步骤集成到您的 msbuild 过程中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T17:41:36.147

我有一个 Windows 项目，我们使用 WIX 创建 MSI 文件。我们为每个不同的环境都有一个 WIX 文件。一旦我们的持续集成服务器完成构建，我们会得到一个“Setup”文件夹，其中包含用于开发、测试、模型和生产的单独 MSI 文件。它们中的每一个都被安装到具有单独 app.configs 的单独文件夹中。

它并没有像您想要的那样全部集成到一个 MSI 中，但它完成了类似的事情。

# javascript - 我可以防止在进行 AJAX 调用时调用 window.onbeforeunload

> ID：537702
> 
> 赞同：22
> 
> 时间：2009-02-11T16:45:11.210
> 
> 标签：javascript, ajax, onbeforeunload

我有一个基于 AJAX 的网格控件。

我们连接到 window.onbeforeunload 事件以检查他们是否有未保存的数据，如果有，则向他们显示一条消息“您确定要离开...您有未保存的数据...”。

这一切都很好。

但是 AJAX 调用也会触发 window.onbeforeunload ，所以如果网格有未保存的数据并且我们进行 AJAX 调用（例如删除另一个网格中的一行），用户会得到“你确定要导航离开......你有未保存的数据...”消息不好。

是否可以抑制 AJAX 调用的 onbeforeunload 事件？或者是否有可能检测到一个调用*是*一个 AJAX 调用？否则我们将不得不进行黑客攻击！

谢谢

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-03-24T13:52:45.240

如果您想通过超链接触发回发，有一个简单的解决方法：

`<a href="javascript:submitFunction();">Submit</a>`

或者

`<a href="javascript:;" onclick="submitFunction();">Submit</a>`

只需使用此代码：

`<a href="#" onclick="submitFunction();">Submit</a>`

如果超链接的 href 属性的内容不是当前页面（尖锐字符表示），IE 似乎会触发 onbeforeunload 事件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-11-14T13:27:14.650

我做了这样的事情：

体内标签：

```
 var allowConfirm = true;

  window.onbeforeunload = confirmExit;
  function confirmExit()
  {
    if(allowConfirm)
        return "Are you sure you want to navigate away from this page?";
    else
        allowConfirm = true;
  } 
```

当我注销时，我调用这个脚本：

允许确认=假；返回 window.location.href;

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T16:51:59.480

这真的很奇怪，您确定您的 Ajax 调用没有加载新链接吗？

请务必阅读此相关规范：[onbeforeunload spec](http://msdn.microsoft.com/en-us/library/ms536907(VS.85).aspx)

查看 Ajax 调用是否会触发**To invoke**表中列出的任何操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-09T21:41:45.533

在 IE6 或 href 的情况下，您可以挂钩回发功能。即：如果回发功能是`WebForm_DoPostBackWithOptions`并使用 Jquery ，则将此代码添加到上面的代码中

```
var DoPostBackWithOptionsHook = null;

$(document).ready(function(){
  DoPostBackWithOptionsHook = WebForm_DoPostBackWithOptions;
  WebForm_DoPostBackWithOptions = WebForm_DoPostBackWithOptionsHook;
}

function WebForm_DoPostBackWithOptionsHook(options) {
    var navigateAwayFlag = $("input[id*='navigateAwayValue']");
       if (navigateAwayFlag.length > 0) {
           navigateAwayFlag[0].value = "false"; }

    return DoPostBackWithOptionsHook(options)
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-09T05:55:52.440

解决此问题的一种方法是使用 jquery 在超链接标记的单击事件上调用 submitFunction() 并从超链接中删除 href 属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-21T18:14:09.220

如果您谈论的是 ASP.NET AJAX 部分回发，那么我今天也遇到了这种行为，做同样的事情。（如果不是，请完全忽略我的帖子。）

以我目前的经验来看，如果你的部分回发是由一个***input***触发的，它不会在部分回发期间触发 onbeforeunload ，但如果部分回发是由一个***hyperlink***触发的，它会。如果您单击锚标记中的任何内容（仅在 IE 和 FireFox 中测试过，但是是的），浏览器似乎会假定您正在导航。

页面是否具有某个隐藏字段已经是我用来确定客户端何时适合显示导航离开警告的方法，因此我可以通过添加对隐藏字段值的检查来非常简单地解决此问题我的 onbeforeunload 的 if 条件，并连接到 PageRequestManager 的 BeginRequest 和 EndRequest 处理程序以设置值。这有效地禁用了部分回发期间的警告。如果您想要检查更具体的事情，您可以在此处添加更复杂的逻辑。

这是一个非常简化的代码示例。（对不起，如果我削减和审查到它不起作用的地步，但它应该给你一个想法。）

```
window.onbeforeunload = checkNavigateAway;

Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(onBeginRequest);
Sys.WebForms.PageRequestManager.getInstance().add_endRequest(onEndRequest);

function onBeginRequest(sender, args) {
    var navigateAwayFlag = $("input[id*='navigateAwayValue']");
    if (navigateAwayFlag.length > 0) {
        navigateAwayFlag[0].value = "false";
    }
}

function onEndRequest(sender, args) {
    var navigateAwayFlag = $("input[id*='navigateAwayValue']");
    if (navigateAwayFlag.length > 0) {
        navigateAwayFlag[0].value = "true";
    }
}

function checkNavigateAway() {
    var navigateAwayFlag = $("input[id*='navigateAwayValue']");
    if (navigateAwayFlag.length > 0 && navigateAwayFlag[0].value == "true")
    {
        return "Warning Text";
    }
} 
```

**编辑**：坏消息。以上似乎不适用于IE6。似乎它以与 Firefox 不同的顺序触发事件，因此 onbeforeunload 在 AJAX beginRequest 之前触发......可能必须找到一种方法来通过在 onbeforeunload 触发之前单击超链接来更改标志的值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-24T04:07:06.387

这是不可能的，没有办法知道是否按下了浏览器的刷新按钮。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-25T17:46:51.037

这实际上有效：

```
 OnClientClick="eval(this.href);return false" 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-01-20T22:29:10.983

不使用 AJAX，但仍想防止留下未保存更改的页面。我尝试了大多数先前的建议，包括navigationAway。他们都没有使用 IE 8。NavigateAway 总是返回 0 的长度。

我确实找到了一个博客，上面有关于在标签中使用类作为 ID 的解决方案，然后基于此设置布尔值。我试过了，但它不起作用，因为 .NET 在输出 HTML 时将输入标记包装在 span 标记中，其中声明了类。我的最终解决方案是在标签的 ID 名称中加上 Ignore 一词。此外，为了防止在单击之前调用 onbeforeunload 被设置布尔值的代码捕获，必须使用 ，例如 asp:Button 或 asp:Input。最后，asp 强制（VS IDE 的）起始名称为控件类型；ID="Button_Save"。使用 asp: 标签还可以防止 onbeforeunload 被调用两次。

```
<script type="text/javascript" language="javascript">
 var stuffchanged = false
 var ignorenavigate = false

  $(document).ready(function () {

    //Detect whether the event source has "nonavigate" class specified
    $("a,input,img,checkbox,button").click(function () {
        var str = $(this).attr("ID");
        ignorenavigate = str.search("Ignore") > 0;
    });

});

window.onbeforeunload = confirmExit;
function confirmExit() {
    if (stuffchanged && !ignorenavigate) {
        return "You have attempted to leave this page with unsaved changes.  If you have made any changes to the fields without " +
    "clicking the Save button, your changes will be lost.  Are you sure you want to exit this page?";
    }  

}

  function textchanged() {
     stuffchanged = true;
  } 
```

# wpf - 如何在 WPF 的设置文件中存储自定义类型对象的集合？

> ID：537711
> 
> 赞同：2
> 
> 时间：2009-02-11T16:46:16.793
> 
> 标签：wpf

我想在 WPF 应用程序的设置文件中序列化一组自定义对象。我可以通过从 ApplicationSettingsBase 派生来序列化单个自定义对象，但是我无法序列化这些对象的集合。能否请你帮忙？

提前致谢！

```
public class TestSetting: ApplicationSettingsBase
{
    [UserScopedSetting]
    public string Name
    {
        get { return (string) this["name"]; }
        set { this["name"] = value; } 
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T00:41:38.457

您可以创建一个派生自 ApplicationSettingsBase 的类，您可以在其中将您的集合作为一个属性，并且集合中的每个类都可以只是 [Serializable()]。

# iphone - 关于 viewDidAppear 每次创建表然后崩溃的问题

> ID：537718
> 
> 赞同：0
> 
> 时间：2009-02-11T16:47:28.570
> 
> 标签：iphone

我有两个视图，两个选项卡意味着每个选项卡每个视图，我正在从服务器获取数据。所以我必须使用 viewDidAppear:(BOOL)animated。

在这种方法中，我添加了表格、进度视图和标签，并且我使用了“[self performSelectorInBackground:@selector(getDataFromServer:) withObject:string];” .

所以当我选择这个视图时，它开始在后台加载数据，当我移动到另一个视图并返回到第一个视图时，它会覆盖另一个表、标签和进度视图。从服务器加载时我选择此视图多少次，它将添加该时间表、标签和进度视图，然后崩溃。

我应该在这个视图中使用什么确实出现了防止这种错误的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T14:33:03.787

Maybe it's problem on thread deallocation. What do you do when view disapear ? Do you free the view ?

Why not to load data using a thread in your AppDelegate and then provide these data to the current view.

In you current you have to know data are loading and then display a progress indicator. Data will be loaded only 1 time when view will be load from nib.

# php - PHP支付解决方案？

> ID：537719
> 
> 赞同：5
> 
> 时间：2009-02-11T16:47:40.580
> 
> 标签：php, paypal

我正在为一个大学项目创建一个 php/mysql 应用程序，并且我正在寻找任何可能的解决方案以允许用户从我的网站购买。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T16:49:29.673

[PayPal](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/home_US)为您提供多种解决方案，包括 Payflow Pro 服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:49:48.937

[电子商务](http://www.oscommerce.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T16:52:43.987

我们通过命令行实用程序使用[Saferpay 。](http://www.saferpay.com)很乐意关注这篇文章以获得更好的选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T19:28:35.997

您是否也打算编写购物车？

我们一直在评估 Magento 电子商务平台，我们的初步测试表明它非常强大。它支持一堆支付网关选项。

看看... [http://www.magentocommerce.com/](http://www.magentocommerce.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-17T14:11:32.440

PHP 中的非官方实现：[https ://github.com/payment/saferpay](https://github.com/payment/saferpay)

协议在[https://www.six-payment-services.com/dam/saferpay/Saferpay_Payment_Page_EN.pdf](https://www.six-payment-services.com/dam/saferpay/Saferpay_Payment_Page_EN.pdf)第 4 章中进行了描述。

# .net - 从 SharePoint 列表中获取真实标题

> ID：537734
> 
> 赞同：2
> 
> 时间：2009-02-11T16:50:42.087
> 
> 标签：.net, sharepoint, list

嗨，我正在使用 .net 中的 Sharepoint 库查询 Sharepoint 列表。我注意到有不止一个标题字段。如何获取用户定义的标题字段？

```
 SPListItem item = myItemCollection[i];
 item["Title"] <- provides me the wrong title field 
```

这是一个已知问题，有什么解决方法吗？谢谢

但是，如果我进入我的列表设置并将列从标题重命名为文章。并执行以下操作：

```
 SPListItem item = myItemCollection[i];
 item["Article"] <- provides me the wrong title field 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T17:59:49.813

在控制台应用程序中运行它。如上所述，您的问题很可能与显示和内部名称的差异有关。需要注意的是：即使您创建自定义列表并重命名默认的“标题”字段，内部名称也不会从“标题”更改。

```
using (SPSite siteCollection = new SPSite("~~~~ Your site URL here ~~~~"))
{
    using (SPWeb site = siteCollection.RootWeb)
    {
        foreach (SPField f in site.Lists["~~~~ Your list name here ~~~~"].Fields)
        {
            Console.WriteLine(f.InternalName + " | " + f.Title);
        }
    }
}

Console.ReadLine(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T16:54:22.593

您正在寻找`["LinkTitle"]`或`["Name"]`- 很可能是前者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T17:33:47.507

如果您有两个具有相同显示名称但内部名称不同的项目，则 SharePoint 很可能会添加元素来区分字段。我会在列表项上放置一个断点并查看该项的 xml 代码（将其复制粘贴到 VS 中）。然后您可能会看到这些字段有何不同。

如果这不起作用，则存储 GUID 并改用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T20:13:46.993

你试过`item.Title`吗？

# html - IE6布局问题——绝对定位

> ID：537737
> 
> 赞同：4
> 
> 时间：2009-02-11T16:52:02.553
> 
> 标签：html, css, web, internet-explorer-6

以下 HTML 在 Firefox 2 & 3 和 IE7 中看起来符合要求。按钮在`Left`左边，`Right`按钮在右边，中间的文字是……在中间！

但是在 IE6 上，该`Left`按钮未对齐 - 它显示为居中对齐。

谁能建议为什么？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Layout problem!</title>
    <style type="text/css">
        DIV#Footer
        {
            padding: 10px;
            color: #fff;
            background-color: #484848;
            position: relative;
            text-align: center;
        }
        DIV#Footer INPUT
        {
            margin: 5px 15px;
            position: absolute;
            top: 0px;
        }
        DIV#Footer INPUT.right
        {
            right: 0px;
        }
        DIV#Footer INPUT.left
        {
            left: 0px;
        }
    </style>
</head>
<body>
    <div id="Footer">
        <input class="left" type="button" value="Left" />
        Some text in the middle
        <input class="right" type="button" value="Right" />
    </div>
</body>
</html> 
```

（我一直在使用 IE Developer 工具尝试分析和修复这个问题，但无济于事......）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-11T17:24:35.093

您必须触发`hasLayout`. `#footer`宽度和高度触发它，如果您不想设置宽度或高度，可以使用`zoom`CSS 中的 IE-only 属性。

```
<!DOCTYPE html>
<html>
<head>
    <title>Layout problem!</title>
    <style type="text/css">
        div#footer
        {
            padding: 10px;
            color: #fff;
            background-color: #484848;
            position: relative;
            text-align: center;
            zoom: 1;
        }
        div#footer input
        {
            margin: 5px 15px;
            position: absolute;
            top: 0;
        }
        div#footer input.right
        {
            right: 0;
        }
        div#footer input.left
        {
            left: 0;
        }
    </style>
</head>
<body>
    <div id="footer">
        <input class="left" type="button" value="Left">
        Some text in the middle
        <input class="right" type="button" value="Right">
    </div>
</body>
</html> 
```

IIRC，在 IE 中，元素有两种不同的布局行为，一种 if `hasLayout`is `true`，另一种 if it's `false`。确保将其设置为`true`可以解决许多像这样的奇怪布局问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T17:14:36.117

试试这个（原谅内联样式！）

```
<div id="Footer">
    <div style="width:100%">
    <input class="left" type="button" value="Left" />
    Some text in the middle
    <input class="right" type="button" value="Right" />
    </div>
  </div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-12T23:19:51.547

正如乔纳斯所说。

如有疑问，我建议明确指定宽度，即使不是必需的，我更喜欢使用它而不是“缩放”，因为缩放不是为了解决布局问题而设计的。然而，明确设置宽度并不总是可能的，因此“缩放”可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T17:13:00.910

您的浮动/定位元素应该在正常对齐的文本之前按顺序排列。不要按照它们出现的顺序放置它们。

此外，您可能想要添加一个 !important 以增加优先级并使用 Microsoft 的 IE Developer 工具栏查看哪些规则正在生效。父元素的宽度是多少？

它看起来确实应该可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T01:26:53.140

我将为您的方法提供一些机会，看看您是否对此有任何运气：

```
<style type="text/css">
    DIV#Footer
    {
        padding: 10px;
        color: #fff;
        background-color: #484848;
        position: relative;
        text-align: center;
    }
    DIV#Footer INPUT
    {
        margin: 5px 15px;
        position: absolute;
        top: 0px;
    }
    DIV#Footer INPUT.right
    {
        float: right;
    }
    DIV#Footer INPUT.left
    {
        float: left;
    }
    #Footer .center {
        float: left;
    }

</style> 
```

然后在 HTML

```
<div id="Footer">
    <input class="right" type="button" value="Right" />
    <input class="left" type="button" value="Left" />
    <div class="center">Some text in the middle</div>
</div> 
```

然后，您将不得不通过并给他们一些边距，以按照您想要的方式排列它们。这不适用于流畅的布局，除非您为这些项目的页脚或页脚内的容器提供固定宽度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-09T20:54:53.880

我发现在 ie6 中处理绝对定位的 div 标签对我有用的另一个选项是在 CSS 中添加 left 和 right 值。

如果您知道您正在使用的 div 的宽度，这就是简单的数学运算。

似乎将 div 框“装订”到位。

我已经尝试了我读过的所有其他建议（包括强制 ie6 表现得像 ie7 或 ie8 的 javascript），但它们没有奏效。

上面的解决方案做到了。

祝你好运！

# javascript - Javascript错误重新连接可排序列表上的变量（jquery）

> ID：537739
> 
> 赞同：0
> 
> 时间：2009-02-11T16:52:05.517
> 
> 标签：javascript, jquery, jquery-ui-sortable

已尝试一切以使其正常工作。基本上在每个 portlet 中有 2 个部分，用户应该能够将项目从一个部分拖到另一个部分（在同一个 portlet 中）。由于可排序是动态生成的，因此尝试通过为 connectWith 创建一个变量来做类似的事情，但是当我包含 connectWith 行时，不断收到 javascript 错误。

见：[http ://www.nimr.mrc.ac.uk/ttest/090209/nimri_c.html](http://www.nimr.mrc.ac.uk/ttest/090209/nimri_c.html)

任何指针都非常感谢。:)

* * *

糟糕，我想我没有提供足够的信息。那两个注释掉的代码块应该被删除（对不起）。（已使用但与 .each 中的 cookie 代码冲突）

此外，我不希望用户能够将列表项从 list1 移动到 list2 等。 list1 项应该能够转到 list1-hide（反之亦然，等等）。

问题所在的代码行在 .each 函数中 -

```
// here, we allow the user to sort the items
$(setSelector).sortable({

    //connectWith:['?'], // connect with connectMe 
    update: function() {            
        $.cookie(setCookieName, $(setSelector).sortable("toArray"), { expires: 7, path: "/" });         
    }

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T17:01:17.180

而不是分别做 $("#list1, #list1-hide").sortable 和 $("#list2, #list2-hide").sortable 并尝试将两者联系起来，为什么不尝试这样做：

```
$("#list1, #list1-hide, #list2, #list2-hide").sortable 
```

# c# - 在 Visual Studio 2008 中将项目更改为 Web 应用程序

> ID：537753
> 
> 赞同：1
> 
> 时间：2009-02-11T16:53:58.943
> 
> 标签：c#, .net, visual-studio-2008

在我刚刚继承的 VS 2008 解决方案中，有一个普通的类库项目，它实际上应该是一个 Web 应用程序项目（因为它确实是一个 Web 服务）。转换它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T16:55:14.493

创建一个新的 Web 服务（或 Web 应用程序）项目并将类库文件添加到其中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-12T11:48:01.197

我还发现这可以通过添加手动完成：

```
<ProjectTypeGuids>{349c5851-65df-11da-9384-00065b846f21};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids> 
```

到项目文件 (*.proj) 下`<ProjectGuid>...</ProjectGuid>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T17:59:47.677

你真的不需要这样做。

有大量关于将类库项目用于 Web 应用程序的信息 -[请参见此处](http://msdn.microsoft.com/en-us/library/cc668164.aspx)的一个示例。

# django - django 表单变量

> ID：537762
> 
> 赞同：1
> 
> 时间：2009-02-11T16:55:59.313
> 
> 标签：django, drop-down-menu, django-forms

我在这个问题上花了太多时间，并且开始认为它不能在 Django 中完成。我正在从 postgres 数据库中将病原体名称列表拉到下拉框中。用户选择病原体，需要通过 django 将 id 传回数据库，以便进一步检索更多数据。请参见

[http://dpaste.com/119358/](http://dpaste.com/119358/) 用于下拉代码。

问题是 select id = 语句位于表单检索病理 id 的位置之上。django 语句必须放在此处，否则下拉菜单不起作用。有没有人写过类似的东西并找到了解决方案？

最大限度

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T17:27:16.320

您的 HTML 中的 select 标签的 id 不需要对您的病理记录有任何了解。您的代码是正确的，除了缺少关闭选择标记。

映射到 /pathology/ 操作 URL 的 Django 视图需要处理 POST 方法并将病理 id 从请求中拉出，如下所示：

```
pathology_id = request.POST['pathology'] 
```

现在，您可以通过其 id 在数据库中查找该对象并生成新页面/表单或您需要对其执行的任何业务逻辑。

您需要在 request.POST['...'] 调用中使用的字典键基于您为选择元素指定的名称，在本例中为“病理学”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T10:10:20.620

Django 的[表单处理库](http://docs.djangoproject.com/en/dev/topics/forms/)是管理 HTML 表单的好工具。它将从数据库中提取选项，为下拉框生成 HTML 代码，并使用最少的代码为您将选择保存到数据库中。

# c# - 为什么我的隐藏进程仍然可见？

> ID：537766
> 
> 赞同：1
> 
> 时间：2009-02-11T16:56:27.987
> 
> 标签：c#, process, printing, hidden, visible

我通过创建一个`System.Diagnostics.Process`对象然后将`StartInfo`动词设置为“打印”来打印文档，然后调用 process`Start()`方法。

我希望隐藏这个打印过程，所以我正在设置`CreateNoWindow = true`和`WindowStyle = ProcessWindowStyle.Hidden`. 但在打印过程中仍会出现应用程序（Word 或 Acrobat）。

我知道如果为进程设置了用户名或密码并且我已经调试并验证它们是空的，那么隐藏的进程设置将被忽略。我什至尝试将它们明确设置为 NULL 无济于事。

我想知道打印操作是否使应用程序表现得好像它需要用户干预（Word 显示“打印文档..”对话框），这否定了隐藏它的设置。

我正在使用 .Net 2.0、C#、Word 2007 和 Windows Vista。

我的实际代码如下：

```
System.Diagnostics.Process shellProcess = new System.Diagnostics.Process();
shellProcess.StartInfo.FileName = fullFileName;                   
shellProcess.StartInfo.CreateNoWindow = true;
shellProcess.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
shellProcess.StartInfo.Verb = "print";
shellProcess.Start(); 
```

非常感谢您的帮助...

*请注意，我知道我可以使用 Word 或 Acrobat API 来实现相同的目标，但这个问题专门针对 shell 进程的可见性。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T19:12:39.343

StartInfo.WindowStyle 被传递给应用程序，应用程序可以用它做任何事情（它可以使用它或忽略它）。

而且我不确定，但我认为 CreateNoWindow 仅适用于控制台应用程序。

一旦进程启动，您将无法控制它，并且该进程可以显示它想要的任何 UI，您最好使用特定的程序选项（对于像 Dave 建议的 Office 使用自动化，我不了解 Acrobat） .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T17:19:35.560

如果要打印 Word 文档而不实际出现在窗口中，则需要改用 Office 自动化。Microsoft 提供了 Office 自动化程序集（我认为它们默认与 Office 一起安装。） [这](http://www.codeproject.com/KB/printing/WordPrinting.aspx)是一篇关于如何做到这一点的文章。我实际上并没有尝试过代码，但我做了一些自动化操作，快速阅读它看起来不错。

[这](http://support.microsoft.com/kb/302902)是 Microsoft 关于 Office 自动化的文章。

# css - 填充制作链接不起作用？

> ID：537771
> 
> 赞同：1
> 
> 时间：2009-02-11T16:57:46.127
> 
> 标签：css, lightbox, hyperlink, padding

该链接仅在我单击实际文本而不是其周围区域时才有效，即使悬停效果有效，所以我知道按钮是目标？

这也发生在我正在使用左填充并将图像放在那里的站点内的列表中，如果我单击填充的位置它不起作用？

.js 脚本会影响这个吗，这一切都是为了我正在使用的灯箱

有任何想法吗？？

> ```
> ul#navigation { 
>   list-style-type: none;
>   margin: 0;
>   padding: 0;
>   padding: 0;
>   }
> 
> ul#navigation li a {
>   position: absolute;
>   bottom: 10px; 
>   display: block;
>   width: 5em;
>   padding: .5em 0;
>   color: #FFF;
>   background: #92da3a;
>   text-align: center;
>   text-decoration: none;
>   font-size: 11px; 
>   }
> 
> ul#navigation li a:hover {
>   color: #05554f;
>   }
> 
> ul#navigation .back {
>   float: left;
>   width: 4em;
>   padding: 10px;
>   }
> 
> ul#navigation .close {
>   float: right;
>   width: 4em;
>   padding: 10px;
>   }
> 
> ul#navigation li.mt {
>   border-bottom: 2px solid #92da3a; 
>   width: 480px; 
>   position: absolute; bottom: 30px; left: 20px;
>   } 
> ```

非常感谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T14:37:00.133

There is nothing wrong with the CSS for `ul#navigation li a`. I have copied your CSS to a [working example](http://webignition.net/examples/csslinkpadding/) and this appears to function correctly in FF3, IE7 and Chrome.

I wouldn't expect a (well written) piece of JavaScript to be interfering with your links in any way. Although, in general, a given piece of unknown JavaScript could be doing *anything*.

You have too many factors influencing the final rendering and behaviour to determine what may be the cause. You will need to start with a bare minimum and re-add all relevant factors until it breaks, or until everything is re-added and working correctly.

*   start with a (validating) plain (X)HTML document
*   add the relevant CSS to get the link styling you desire
*   add back the rest of the CSS, possibly piece-by-piece if some other CSS rules are interfering
*   add back your JavaScript, again piece-by-piece where relevant

After this process you should have a more clear idea of what factor is causing the undesired behaviour.

I'd recommend using the FireFox web developer toolbar to examine what CSS rules are being applied to your navigation links. You may find some other loosely-specified rules are interfering in otherwise unexpected ways.

You should also confirm your markup and CSS are valid - you can't accurately determine the correct output when dealing with invalid input.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T23:15:18.423

让我猜猜，IE6？

您确实需要在此处指定问题所在的浏览器，因为不同的渲染引擎之间可能存在巨大差异。通常 IE6 与其他所有人相比，Safari 和 Opera 添加了他们的盐。

要回答您的问题，在 IE6 中，有时光标不会显示“手”图标，但单击该区域会触发链接。在这种情况下，添加“cursor:hand”（或其他任何内容，查找 css 属性）将为 IE6 修复该问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T08:15:01.510

我尝试将 UL 或 LI 设置为相对位置，考虑到您将 A 设置为 position: absolute;

拥有这套*可能*会引起一些奇怪。

如果您还可以提供您正在使用的 HTML，那将有助于确定问题。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-11T17:58:53.453

在我的脑海中，我正在考虑将每个元素渲染为一个元素，然后将跨度的 onclick 事件设置为跟随链接并将所需的任何空格和文本放入跨度 () 中。

```
window.location = "URL!" 
```

# regex - UNIX 文件路径最正确的正则表达式是什么？

> ID：537772
> 
> 赞同：19
> 
> 时间：2009-02-11T16:57:53.910
> 
> 标签：regex, path

UNIX 文件路径最正确的正则表达式 (regex) 是什么？

例如，要检测这样的事情：

```
/usr/lib/libgccpp.so.1.0.2 
```

制作一个匹配大多数文件的正则表达式非常容易，但是最好的一个是什么，包括一个可以检测转义的空白序列和在 UNIX 上的文件路径中通常找不到的不寻常字符的正则表达式。

此外，是否有几种不同的编程语言提供文件路径正则表达式的库函数？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-11T17:13:04.793

如果您不介意识别路径的误报，那么您真的只需要确保路径不包含`NUL`字符；其他所有内容都是允许的（特别`/`是名称分隔符）。更好的方法是使用适当的文件 IO 函数（例如[`File.exists()`](http://java.sun.com/javase/6/docs/api/java/io/File.html#exists())，[`File.getCanonicalFile()`](http://java.sun.com/javase/6/docs/api/java/io/File.html#getCanonicalFile())在 Java 中）解析给定的路径。

**长答案：**

这取决于**[操作系统](http://en.wikipedia.org/wiki/Operating_system)**和**[文件系统。](http://en.wikipedia.org/wiki/File_system)**例如，文件系统的[维基百科比较](http://en.wikipedia.org/wiki/Comparison_of_file_systems#cite_note-note-25-3)指出，除了文件系统施加的限制之外，

> MS-DOS、Microsoft Windows 和 OS/2 不允许字符`\ / : ? * " > < |`以及*跨所有文件系统*`NUL` 的文件和目录名称。Unices 和 Linux 不允许*在所有文件系统*中使用字符 以及文件名和目录名 。*`/``NUL`*

 **在 Windows 中，以下[保留的设备名称](http://msdn.microsoft.com/en-us/library/aa365247.aspx)也不允许作为文件名：

```
CON, PRN, AUX, NUL, COM1, COM2, COM3, COM4, COM5,
COM6, COM7, COM8, COM9, LPT1, LPT2, LPT3, LPT4, 
LPT5, LPT6, LPT7, LPT8, LPT9 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-11T17:29:23.180

匹配所有 UNIX 路径的正确正则表达式是：[^\0]+

也就是说，一个或多个不是 NUL 的字符。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-04-06T18:18:38.457

对于已回答此问题的其他人，请务必注意，某些应用程序需要稍有不同的正则表达式，具体取决于您正在编写的程序中转义字符的工作方式。例如，如果您正在编写一个 shell，并且希望命令由空格和其他特殊字符分隔，则您必须修改您的正则表达式，以仅包含带有特殊字符的单词（如果这些字符被转义）。

因此，例如，一个有效的路径将是

```
  /usr/bin/program\ with\空格
```

与

```
  /usr/bin/program 有空格
```

这将引用带有参数“with”和“space”的“/usr/bin/program”

上述示例的正则表达式可以是 "([^\0 ]\|\\ )*"

我一直在研究的正则表达式是（为“可读性”而分隔的换行符）：

```
  “\（ ＃ 任何一个
       [^\0 !$`&*()+] # 一个普通（非特殊）字符
     \| ＃ 或者
       \\\(\ |\!|\$|\`|\&|\*|\(|\)|\+\) # 转义的特殊字符
   \)\+" # 重复 >= 1 次

```

这转化为

```
  "\([^\0 !$`&*()+]\|\\\(\ |\!|\$|\`|\&|\*|\(|\)|\+\)\ )\+"

```

创建自己的特定正则表达式也应该相对简单。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-07T12:07:58.247

```
^(/)?([^/\0]+(/)?)+$ 
```

这将接受文件系统中合法的每条路径，例如*extX*、*reiserfs*。

它仅丢弃包含 NUL 或双（或更多）斜杠的路径名。根据 Unix 规范，其他一切都应该是合法的（我也对这个结果感到惊讶）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-11T17:19:03.203

我不确定跨系统的正则表达式检查有多普遍，但大多数编程语言（尤其是跨平台语言）都提供“文件存在”检查，这将考虑到这种情况

出于好奇，这些路径在哪里输入？您能否将其控制到更大程度，以至于您不必检查路径的各个部分？例如使用文件选择器对话框？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-04T03:04:49.460

问题已经在这里回答：[https ://stackoverflow.com/a/42036026/1951947](https://stackoverflow.com/a/42036026/1951947)

# wxpython - 是否将一个 xrc 文件中的元素包含在另一个 xrc 文件中

> ID：537774
> 
> 赞同：0
> 
> 时间：2009-02-11T16:58:11.303
> 
> 标签：wxpython, wxwidgets, xrc

我有一个 wx 应用程序，它的 UI 在 XRC 文件中定义。每个表单都在其自己的 xrc 文件中。许多表单都有一个面板。有没有办法让一个文件中定义的对象在另一个文件中包含和引用？

我知道有一个 object_ref 机制，但我看不出它如何引用外部 xrc 文件。

我想要一些类似于在一个文件中定义 xsd 元素并在另一个 xsd 文件中包含和引用它们的方式的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-28T15:40:36.313

XRC 没有我所知道的包含机制，但您可以拥有自定义小部件。

因此，将您的公共面板实现为它自己的 XRC，并将其设置为您可以在其他 xrc 文件中通过类名引用的东西。

您将创建一个 XmlResourceHandler 来处理 XRC 中的自定义面板，并实例化您的面板类。看的地方是demo/wxXmlResourceHandler.py

您甚至可以扩展 XRCed 以识别您自己的资源，并将其轻松插入到未来的对话框中。

# database-design - 棘手的关系数据库设计问题

> ID：537782
> 
> 赞同：2
> 
> 时间：2009-02-11T16:59:12.550
> 
> 标签：database-design, relational

我有一个棘手的问题，我已经搞砸了几天，找不到最佳解决方案。

这些是我的表：

*   地点
*   站点节点
*   页

站点节点表包含代表层次结构的节点列表（使用嵌套集）。每个节点必须有一个或多个关联页面。每个站点必须有一个关联的错误页面和一个未找到的页面。

因此，一个页面必须要么属于一个节点，要么属于一个站点作为错误或未找到页面。我目前正在玩弄的解决方案是：

1.  页表上的 parentType 和 parentId 字段，其中 type 可以是“node”、“site_error”或“site_notFound”，id 可以是站点或节点 id（以与类型相关的为准）。
2.  页表上的nodeId 字段可以为空，然后是站点表上的errorPageId 和notFoundPageId 字段。

选项 #1 确保每个页面属于一个且仅属于一个其他实体，尽管实际上不能强制执行关系，因为 parentId 字段可以指向多个位置。

选项#2 更简洁，但它基本上是说该站点“属于”两个错误和未找到的页面，这可能是不好的做法。

有什么想法或建议吗？
谢谢，
杰克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T17:02:56.630

为错误或未找到页面制作虚拟站点节点。您可以根据您的第一个选项将它们标记为特定类型的节点。这将使创建通用处理程序机制变得更加容易。它还将使连接更简单，这将有助于提高数据库查询性能。此外，它允许您添加更多类型的“特殊”页面（可能是登录屏幕）或使其可配置，而无需修改数据库模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T17:27:46.880

> 选项 #1 确保每个页面属于一个且仅属于一个其他实体，尽管实际上不能强制执行关系，因为 parentId 字段可以指向多个位置。

对。就关系理论而言，问题在于您的 " `parentId`" 列违反了[第三范式](http://en.wikipedia.org/wiki/Third_normal_form)，因为它的含义每行都会有所不同，具体取决于`parentType`（非键列）中的值。

如果单列可以包含某人的电话号码*或*他们的生日，每行取决于其他一些标志，那么您将不会拥有一个设计正确的数据库。这是关于这个人的两个不同的事实，他们每个人都应该有自己的专栏。同样，将 site_id 或 node_id 存储在单个列中也会有同样的问题。

这是一个有缺陷的设计的另一个线索是您不能声明一个外键约束来指向两个引用表中的*任何一个。*

> 选项#2 更简洁，但它基本上是说该站点“属于”两个错误和未找到的页面，这可能是不好的做法。

我明白你为什么这么说，因为*属于*类 Rails 框架中的约定。但这些都是惯例；它们不一定是外键可以建模的唯一关系。*您可以使一个实体在一个有一个*关系中完全引用另一个实体。在这种情况下，外键反转方向。

我会说错误页面和未找到页面*属于*该站点在逻辑上是正确的，而不是相反。使它们成为强制性的方法是让另一个实体引用这些页面，并将`NOT NULL`约束应用于这些引用。这就是你所描述的。

```
CREATE TABLE site (
  . . .
  error_page_id     INT NOT NULL,
  notfound_page_id  INT NOT NULL,
  FOREIGN KEY (error_page_id)    REFERENCES pages (page_id),
  FOREIGN KEY (notfound_page_id) REFERENCES pages (page_id)
); 
```

这满足了您的迫切需要，它是可执行的，并且是正常形式的。

* * *

@NXC[建议](https://stackoverflow.com/questions/537782/tricky-relational-db-design-question/537801#537801)为错误和未找到页面制作虚拟节点。尽管这允许将这些节点存储在节点层次结构中，但它无法强制站点必须具有这些页面。也就是说，可以在*不*引用这些节点的情况下存储站点。

@Tony Andrews[建议](https://stackoverflow.com/questions/537782/tricky-relational-db-design-question/537837#537837)在每个页面中存储两列，`site_id`和`site_node_id`，并添加一个 CHECK 约束以确保其中一个是非空的。这似乎比`parent_id`/`parent_type`选项更好，但它仍然没有强制要求每个站点都必须有一个错误和一个未找到页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T17:16:30.073

另一种选择是有 2 列 site_id 和 site_node_id 像这样：

```
create table pages
 ( page_id ... primary key
 , site_id references sites
 , site_node_id references site_nodes
 , ...
 , constraint site_or_node check (  site_id is null and site_node_id is not null
                                 or site_id is not null and site_node_id is null
                                 )
 ); 
```

现在，您可以使用参照完整性来确保每个页面都属于站点或节点，而不是两者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T17:37:48.043

选项 2 更有意义，并且在出现更多并发症时可以节省您的大脑。站点与错误/未找到页面的一对一关系使其非常适合外键约束。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T18:22:06.547

选项 1 的修改。

包括两个单独的列，ParentNodeID 和 ParentSiteID。根据具体情况，将这两列之一保留为 NULL。现在您仍然可以为每个外键声明一个外键（引用）约束。

我不太了解 SiteNotFound 案例。在这种情况下，您可以将两个外键都保留为 NULL 吗？

您的加入和搜索会更简单。您还将遵守 1NF。这不是巧合。

您的选项 1 将来自不同域的值组合在一个字段中。这是糟糕的现场设计，IIRC 违反了 1NF。

# c# - 如果输入相同的种子，Delphi 的随机生成器是否与 C# 的计算相同？

> ID：537785
> 
> 赞同：8
> 
> 时间：2009-02-11T16:59:41.660
> 
> 标签：c#, delphi, random

当我遇到这个时，我正在将一些 Delphi 代码翻译成 c# 代码。我没有 Delphi 的环境设置，所以我无法自己测试。

德尔福：

```
RandSeed := var1;
Result := Random($FF); 
```

C＃：

```
Random RandSeed = new Random(var1);
Result = RandSeed.Next(255); 
```

这些会将相同的值放在 Result 中吗？如果没有，关于这样做的任何想法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-12T13:45:42.643

Delphi PRNG 是一个确定性[线性同余生成器](http://en.wikipedia.org/wiki/Linear_congruential_generator)，具有 134775813 as**`a`**和 1 as **`c`**，并返回范围受限数字的高 32 位。这是 C# 中的一个实现，它返回与 Delphi 相同的值：

```
using System;

class DelphiRandom
{
    int _seed;

    public DelphiRandom(int seed)
    {
        _seed = seed;
    }

    int GetNext() // note: returns negative numbers too
    {
        _seed = _seed * 0x08088405 + 1;
        return _seed;
    }

    public int Next(int maxValue)
    {
        ulong result = (ulong) (uint) GetNext() * (ulong) (uint) maxValue;
        return (int) (result >> 32);
    }
}

class App
{
    static void Main()
    {
        DelphiRandom r = new DelphiRandom(42);
        for (int i = 0; i < 10; ++i)
            Console.WriteLine(r.Next(100));
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-11T17:02:38.300

当然不是，因为他们使用不同的 RNG。您也许可以使用 Windows API 中的 RNG，创建自己的 RNG 或使用一些 RNG 库来实现此目的。

另一种确保 RNG 为给定种子创建相同数字的方法是编写一个 DLL 并将其用于 Delphi 和 C#。

顺便说一句，如果你想自己编写一个 RNG，[维基百科](http://en.wikipedia.org/wiki/List_of_random_number_generators)是获取一些常用生成器名称的一个很好的起点。完成后，您应该通过一些[统计测试](http://en.wikipedia.org/wiki/Diehard_tests)运行它，以确保它对您来说足够“随机”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T17:06:06.607

只是使用 Delphi 2009 和每个种子的前 10 个结果的一些结果：

```
Seed:   0, result:   0,   8, 219,  51,  69, 171,  81,  41,  94, 108
Seed:   1, result:   8, 219,  51,  69, 171,  81,  41,  94, 108,  20
Seed:   2, result:  16, 176, 138,  87,  17, 246,   1, 148, 122, 188
Seed:   3, result:  24, 132, 225, 105, 119, 156, 216, 202, 135, 100
Seed:   4, result:  32,  89,  57, 123, 221,  66, 176,   0, 149,  13
Seed:   5, result:  40,  45, 145, 141,  67, 231, 136,  54, 163, 180
Seed:   6, result:  48,   2, 232, 159, 169, 141,  96, 108, 176,  92
Seed:   7, result:  56, 213,  64, 177,  16,  51,  56, 161, 190,   5
Seed:   8, result:  64, 170, 151, 195, 118, 216,  16, 215, 203, 172
Seed:   9, result:  72, 127, 238, 213, 219, 126, 231,  14, 217,  84
Seed:  10, result:  80,  83,  70, 231,  66,  36, 191,  67, 231, 252
Seed:  11, result:  88,  40, 157, 248, 168, 201, 151, 121, 244, 164
Seed:  12, result:  96, 251, 244,  11,  14, 111, 111, 175,   3,  76
Seed:  13, result: 104, 208,  76,  29, 116,  21,  71, 228,  17, 244
Seed:  14, result: 112, 164, 163,  47, 218, 186,  31,  27,  30, 156
Seed:  15, result: 120, 121, 250,  65,  64,  96, 246,  81,  44,  69
Seed:  16, result: 128,  78,  83,  83, 166,   6, 206, 134,  57, 236
Seed:  17, result: 136,  34, 170, 101,  13, 171, 166, 188,  71, 148
Seed:  18, result: 144, 246,   2, 119, 114,  81, 126, 242,  85,  61
Seed:  19, result: 152, 202,  89, 137, 216, 246,  86,  40,  98, 228
Seed:  20, result: 160, 159, 176, 155,  63, 156,  46,  94, 112, 140
Seed:  21, result: 168, 115,   8, 173, 164,  66,   6, 148, 126,  53
Seed:  22, result: 176,  72,  95, 191,  11, 231, 221, 201, 139, 220
Seed:  23, result: 184,  29, 182, 209, 113, 141, 181,   0, 153, 132
Seed:  24, result: 192, 240,  14, 227, 214,  51, 141,  54, 166,  45
Seed:  25, result: 200, 197, 101, 245,  61, 216, 101, 107, 180, 212 
```

我看到了一个模式;-)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-18T15:20:00.357

对于 Java 开发人员

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package org.delphi;

/**
 *
 * @author ulmum
 * Using Code for C# from Barry Kelly http://stackoverflow.com/users/3712/barry-kelly
 */
class DelphiRandom {

    int _seed;

    public DelphiRandom(int seed) {
        _seed = seed;
    }

    int GetNext() // note: returns negative numbers too
    {
        _seed = _seed * 0x08088405 + 1;
        return _seed;
    }

    public int Next(int maxValue) {
        long result = (long) (int) GetNext() * (long) (int) maxValue;
        return ((int) (result >> 32) & 0xff); //Here Prevent Negative Numbers
    }
}

class App {

    public static void main(String[] args) {
        DelphiRandom r = new DelphiRandom(0);
        for (int i = 0; i < 10; ++i) {
            System.out.println(r.Next(256));
        }
    }
} 
```

# wcf - 在循环中异步调用 WCF 服务

> ID：537786
> 
> 赞同：1
> 
> 时间：2009-02-11T16:59:51.097
> 
> 标签：wcf, multithreading

在我的 WPF 客户端中，我有一个循环调用 WCF 服务来更新一些记录。循环完成后，我会显示一条消息“更新完成”。

我现在将我的 WCF 调用更改为异步调用。

```
 ServiceClient client = new ServiceClient();
    client.UpdateRecordsCompleted +=new System.EventHandler<System.ComponentModel.AsyncCompletedEventArgs>(client_UpdateRecordsCompleted);

    foreach (MyItem item in someCollection)
    {
         client.UpdateRecordsAsync(item);
    } 

    MessageBox.Show("Update complete"); 
```

我不需要在每个操作的竞争事件中做任何事情。*我只需要在最后*一条消息的末尾显示一条消息。

有任何想法吗？

编辑：我可能会将其移植到 Silverlight，这就是为什么我需要异步调用该服务的原因。我不认为我可以使用后台工作人员。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T17:18:49.367

我会在您的 WPF 窗口中添加一个线程安全字段，以跟踪用户已排队的客户端更新数量：

```
private int recordsQueued = 0; 
```

在调度各个异步操作之前，将 recordsQueued 设置为 someCollection.Count。

```
recordsQueued = someCollection.Count; 
```

最后，在client_UpdateRecordsCompleted中，递减recordsQueued；如果为零，则显示“更新完成”消息：

```
private void client_UpdateRecordsCompleted(AsyncCompletedEventArgs args) {
  if (Interlocked.Decrement(ref recordsQueued) == 0)
    MessageBox.Show("Update complete.");      
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T17:32:37.977

如果您不想用请求压倒您的服务器，另一种方法是使用后台工作程序，使用同步请求在正常循环中完成所有工作。后台工作人员已经拥有报告进度和完成的方法，这些方法可以方便地在正确的线程上向您的主应用程序报告。假设你想用你的 GUI 做一些事情，而不是仅仅显示完整的对话框。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T17:33:51.750

或许是这样的：

```
ServiceClient client = new ServiceClient();
var count = someCollection.Count;
client.UpdateRecordsCompleted += (_,__) => {
    if (Interlocked.Decrement(ref count) == 0) {
        MessageBox.Show("Update complete.");   
    }
}

foreach (MyItem item in someCollection)
{
     client.UpdateRecordsAsync(item);
} 
```

# silverlight - 您将如何在 Silverlight 中证明文本的合理性？

> ID：537796
> 
> 赞同：5
> 
> 时间：2009-02-11T17:01:26.180
> 
> 标签：silverlight, text, layout

有人对如何**证明**`TextBlock`Silverlight 2 中的只读文本（呈现为 a ）有任何建议吗？WPF 通过`TextAlignment`枚举支持文本对齐：

```
public enum TextAlignment
{
    Left,
    Right,
    Center,
    Justify // <--- Missing from Silverlight :(
} 
```

但是，Silverlight 2 仅支持以下内容：

```
public enum TextAlignment
{
    Center,
    Left,
    Right
} 
```

任何想法或建议都非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T17:32:01.567

在我的脑海中，我可以想到两种不太容易的方法来做到这一点。一个比较蹩脚；在单词之间添加空格。另一种是以某种方式解析文本，以便每个单词都是它自己的文本块，然后您可以使用 Grid 左对齐一行的第一个单词并右对齐一行的最后一个单词，然后将其他块隔开使用堆叠面板或类似设备的中心单元。

确定哪些单词是一行的开头和结尾将涉及测量每个块的渲染大小并确定它是否适合。这并不简单，但它应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-01T17:47:15.847

显然，唯一的解决方案是将文本行拆分为单词并跨列布局单词（正如 Jeff Yates 上面所建议的那样）。首先是使用 Grid 容器验证这个想法：

```
<Grid Name="grid1">
<Grid.ColumnDefinitions>
    <ColumnDefinition Width="Auto"/>
    <ColumnDefinition Width="*"/>
    <ColumnDefinition Width="Auto"/>
    <ColumnDefinition Width="*"/>
    <ColumnDefinition Width="Auto"/>
    <ColumnDefinition Width="*"/>
    <ColumnDefinition Width="Auto"/>
</Grid.ColumnDefinitions>
<TextBlock HorizontalAlignment="Left" Text="This" Grid.Column="0" />
<TextBlock HorizontalAlignment="Center" Text="is" Grid.Column="2" />
<TextBlock HorizontalAlignment="Center" Text="someprettylongpiece" Grid.Column="4" />
<TextBlock HorizontalAlignment="Right" Text="text" Grid.Column="6" />
</Grid> 
```

下一步是创建自定义面板，在不处理网格的情况下执行文本块布局：

```
<JustifiedPanel>
    <TextBlock Text="This"/>
    <TextBlock Text="is"/>
    <TextBlock Text="a"/>
    <TextBlock Text="justified"/>
    <TextBlock Text="line"/>
    <TextBlock Text="of"/>
    <TextBlock Text="text"/>
    <TextBlock Text="that"/>
    <TextBlock Text="demonstrates"/>
    <TextBlock Text="feasibility"/>
</JustifiedPanel> 
```

（示例源代码可在[我的博客上](http://net-dostupa.blogspot.com/2010/06/silverlight-textalignmentjustify.html)找到） 最后，我将创建 JustifiedTextBlock 控件，它将文本拆分为单词并对其进行布局。这里重要的事情是适当的 RTL 支持和正确的行拆分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T17:47:19.097

我发现了一篇关于此的博客文章 - [http://math-geek-rock-chick.blogspot.com/2008/08/silverlight-and-text-alignjustify.html](http://math-geek-rock-chick.blogspot.com/2008/08/silverlight-and-text-alignjustify.html)。这个想法是将文本分成单独的行，然后将 ScaleTransform 应用于从左 (RenderTransformOrigin=0,0) 到右 (Scale.X = 1.02) 缩放文本的每一行。但该方法仅适用于小段文本，如果您的 TextBox 大小发生变化，可能会停止运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T19:20:16.357

现在你可以使用 a 了`<RichTextBox>`，它会很棒。

让我们看看如何在 Windows Phone 上对齐文本。

# 文本块？

TextBlock 元素确实具有 TextAlignment 属性，但只允许三个值：Left（左）、Center（居中）、Right（右）。

[![](https://www.rudyhuyn.com/blog/wp-content/uploads/2011/11/Sans-titre-3.jpg "无题-3")](https://www-rudyhuyn-com.translate.goog/blog/wp-content/uploads/2011/11/Sans-titre-3.jpg?_x_tr_sl=fr&_x_tr_tl=en&_x_tr_hl=fr&_x_tr_pto=ajax,elem)

从视觉上看，这给出了：

[![](https://www.rudyhuyn.com/blog/wp-content/uploads/2011/11/Sans-titre-2-1024x178.jpg "无题-2")](https://www-rudyhuyn-com.translate.goog/blog/wp-content/uploads/2011/11/Sans-titre-2.jpg?_x_tr_sl=fr&_x_tr_tl=en&_x_tr_hl=fr&_x_tr_pto=ajax,elem)

文本对齐：左、中、右

但是，我们希望通过调整空格的宽度来同时将文本左右对齐，这对于我们使用 TextBlock 控件是不可能的。

# 解决方案：富文本块

由于 Mango 和切换到 Silverlight 4，我们现在可以使用一个名为 RichTextBlock 的新元素。这个元素允许像 TextBlock 一样显示文本，但是这个元素有更多的格式化可能性，如果我们必须比较，RichTextBlock 对 TextBlock 就像 Word 对记事本一样。

如果我们查看 RichTextBlock 的 TextAlignment 属性，我们可以看到它具有两端对齐（Justify）

[![](https://www.rudyhuyn.com/blog/wp-content/uploads/2011/11/Sans-titre-41.jpg "无题-4")](https://www-rudyhuyn-com.translate.goog/blog/wp-content/uploads/2011/11/Sans-titre-41.jpg?_x_tr_sl=fr&_x_tr_tl=en&_x_tr_hl=fr&_x_tr_pto=ajax,elem)

多亏了这个元素，我们现在可以显示对齐的文本。

```
<RichTextBox TextAlignment="Justify">

<Paragraph>

<Run Text="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec non lectus urna, id commodo metus. Integer id metus augue, non facilisis lectus. Fusce massa purus, varius ut auctor ac, sagittis a massa. Sed sed justo velit, at molestie orci. Nullam malesuada nibh et massa hendrerit mattis. Nunc id laoreet nisl. Sed vulputate lobortis mi nec mollis."/>

</Paragraph>
</RichTextBox> 
```

这是渲染：

[![](https://www.rudyhuyn.com/blog/wp-content/uploads/2011/11/Sans-titre-5.jpg "无题-5")](https://www-rudyhuyn-com.translate.goog/blog/wp-content/uploads/2011/11/Sans-titre-5.jpg?_x_tr_sl=fr&_x_tr_tl=en&_x_tr_hl=fr&_x_tr_pto=ajax,elem)

# 混合提示

与 TextBlock 不同，要修改 RichTextBlock 的文本，您必须右键单击元素并选择“编辑文本”</p>

[![](https://www.rudyhuyn.com/blog/wp-content/uploads/2011/11/Sans-titre-4.jpg "无题-4")](https://www-rudyhuyn-com.translate.goog/blog/wp-content/uploads/2011/11/Sans-titre-4.jpg?_x_tr_sl=fr&_x_tr_tl=en&_x_tr_hl=fr&_x_tr_pto=ajax,elem)

为了更快，您可以使用 F2 键，它允许您编辑任何文本类型控件的文本！

[资源](http://www.rudyhuyn.com/blog/2011/11/08/comment-justifier-du-texte-sous-windows-phone/)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-02-11T17:08:08.817

如果这些不能满足您的需求，您应该编写一个扩展器或转换器并绑定到它，而不是使用其中一个枚举。

# linq - 使用 Linq 插入新记录时如何获取 SQL 命令文本？

> ID：537797
> 
> 赞同：5
> 
> 时间：2009-02-11T17:01:53.370
> 
> 标签：linq, insert

```
var newUser = new tblUser() { 
    Email = strEmail,
    Password = strPassword,
    DateBirth = DateTime.Parse(strDateBirth),
};
db.tblUsers.InsertOnSubmit(newUser);
db.SubmitChanges(); 
```

我想获取 linq 生成的实际 SQL 查询。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T17:21:19.487

您需要将 DataContext.Log 属性设置为编写器，您可以将编写器包装在 stringbuilder 周围，然后在插入 response.write your stringbuilder.tostring ...

```
 StringBuilder sb = new StringBuilder();
                StringWriter writer = new StringWriter(sb);
                Context.Log = writer;
                ...
                    DOINSERT & SUBMITCHANGES
                ...
                Response.Write(sb.ToString()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T17:08:06.850

db.Log 是一个 TextWriter，您可以使用它来获取查询的文本。

```
db.Log = Console.Out
var newUser = new tblUser()
{ 
    Email = strEmail,
    Password = strPassword,
    DateBirth = DateTime.Parse(strDateBirth),
};
db.tblUsers.InsertOnSubmit(newUser);
db.SubmitChanges(); 
```

它会将查询文本写入标准输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T17:10:30.947

检查这篇[msdn 文章](http://msdn.microsoft.com/en-us/library/bb386961.aspx)。你可以使用`DataContext.Log`属性。

# text - 如何确定 .NET 中文件的内容类型？

> ID：537800
> 
> 赞同：3
> 
> 时间：2009-02-11T17:02:46.723
> 
> 标签：text, encoding, file-io, binary, streamreader

我得到了一个文件名，我必须能够从磁盘读取它并通过网络发送它的内容。我需要能够确定文件是文本文件还是二进制文件，以便知道是使用 StreamReader 还是 BinaryReader。我需要知道内容类型的另一个原因是，如果它是二进制的，我必须在通过网络发送数据之前对数据进行 MIME 编码。我还希望能够告诉消费者内容类型是什么（如果是文本，包括编码）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T17:08:53.260

[文件扩展名](http://en.wikipedia.org/wiki/Filename_extension)提供了文件内容类型的最佳提示。

它并不完美，但我已经成功使用了以下内容：

```
private static string GetContentTypeFromRegistry(string file)
{
    RegistryKey contentTypeKey = Registry.ClassesRoot.OpenSubKey(@"MIME\Database\Content Type");

    foreach (string keyName in contentTypeKey.GetSubKeyNames())
    {
        if (System.IO.Path.GetExtension(file).ToLower().CompareTo((string)contentTypeKey.OpenSubKey(keyName).GetValue("Extension")) == 0)
        {
            return keyName;
        }
    }

    return "unknown";
}

private static string GetFileExtensionFromRegistry(string contentType)
{
    RegistryKey contentTypeKey = Registry.ClassesRoot.OpenSubKey(@"MIME\Database\Content Type\" + contentType);

    if (contentTypeKey != null)
    {
        string extension = (string)contentTypeKey.GetValue("Extension");

        if (extension != null)
        {
            return extension;
        }
    }

    return String.Empty;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T17:08:44.320

您要么需要提前知道文件的类型，要么被告知文件的类型。如果您所做的只是通过网络发送文件，为什么不直接使用 Stream.Write 和 Stream.Read 方法呢？让服务的消费者确定文件类型。您不需要使用 *Reader 类，因为您没有解释服务器上的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T17:34:33.917

你可以试试这个免费的 mime 检测器库。 [http://www.netomatix.com/Products/DocumentManagement/MimeDetector.aspx](http://www.netomatix.com/Products/DocumentManagement/MimeDetector.aspx)

# .net - 在 .NET 中管理依赖关系树的最佳方法是什么？

> ID：537810
> 
> 赞同：13
> 
> 时间：2009-02-11T17:06:30.113
> 
> 标签：.net, msbuild, dependency-injection, dependency-management, refix

在我的上一个项目中，我们使用 MSBuild 作为脚本语言。（是的，真的！）我们还为在 C# 中更有意义的部分编写了数百个自定义 MSBuild 任务。（我什至编写了一个 MSBuild 任务来生成 MSBuild 任务的样板代码。是的，它消耗了自己。）

虽然我不建议其他人采用同样的方法，但我发现非常有用的一件事是内置的依赖管理。如您所料，表达依赖关系并让 MSBuild 负责满足它们很容易。例如，我们软件中的几乎每个步骤都需要将一组特定文件复制到特定位置。你可以很容易地写：

```
Step1: CopyFiles
Step2: CopyFiles, Step1 
```

当你执行时`Step2`，它只会复制一次文件。

**构建和满足依赖关系树在软件中很常见**。我希望 MSBuild 团队能够使用他们的依赖管理代码，将其与 MSBuild 分离，并将其移至任何人都可以使用的 .NET Framework。除此之外，**您认为以这种方式管理依赖关系的最佳选择是**什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T18:14:44.740

我认为您可以使用像 Spring 这样的 IOC 容器来获得这种行为。

实例化任何只能作为单例运行一次的任务，并让任务对象的构造函数运行该任务。然后，以后出现的任何依赖于该任务的对象都将获得对已经运行的任务的引用，并能够获得该任务的结果或能够推断该任务已经成功运行。

在 spring 配置中，您最终会得到许多链接在一起的任务，每个任务都在其构造函数配置中引用其他任务。这种方法是最灵活的，你不限于“任务”或任何太重的事情。

我猜任何工作流库也有类似的概念。但我对这些并不是很熟悉。

我认为对于任何更小的东西，人们必须使用访问者模式和可能的字典来滚动他们自己的对象图和界面来保持状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-25T16:30:59.847

查看 CodePlex 上的[Refix](http://refix.codeplex.com/)项目。它代表 REference FIX，它工作得非常好。

# flash - 以编程方式在 Textfield 中嵌入汉字

> ID：537811
> 
> 赞同：0
> 
> 时间：2009-02-11T17:06:40.537
> 
> 标签：flash, embedded-fonts

在 Flash 环境的“嵌入...字符嵌入”窗口中，您可以选择嵌入日文汉字。有谁知道使用`TextField`Actionscript 创建的嵌入相同内容的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T18:17:56.807

您需要在库中创建一个字体符号并分配一个链接类（在本例中为“Font1”）：

```
var myFont:Font = new Font1();
var myFormat:TextFormat = new TextFormat();
myFormat.font = myFont.fontName;

var myTextField:TextField = new TextField();
myTextField.defaultTextFormat = myFormat;
myTextField.embedFonts = true;
myTextField.text = "Hello World!";
addChild(myTextField); 
```

请参阅有关[嵌入字体的文章](http://www.adobe.com/devnet/flash/quickstart/embedding_fonts/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-12T10:13:53.637

我通常成功地使用它：

```
 package
{

        import flash.display.Sprite;
        import flash.display.TextField;
        import flash.display.TextFieldAutoSize;

        import flash.text.TextFormat;
        import flash.text.AntiAliasType;

        public class EmbedFontTest extends Sprite
        {

                [Embed(source="C:\WINDOWS\Fonts\ARIAL.TTF", fontFamily="Arial")]
                private var _arial_str:String;

                private var _arial_fmt:TextFormat;
                private var _text_txt:TextField;

                public function EmbedFontTest()
                {
                        super();

                        this.initEmbedFontTest();
                }

                private function initEmbedFontTest():Void
                {
                        this._arial_fmt = new TextFormat();
                        this._arial_fmt.font = "Arial";
                        this._arial_fmt.size = 40;

                        this._text_txt = new TextField();
                        this._text_txt.embedFonts = true;
                        this._text_txt.autoSize = TextFieldAutoSize.LEFT;
                        this._text_txt.defaultTextFormat = this._arial_fmt;
                        this._text_txt.text = "Test Arial Format";

                        this.addChild(this._text_txt);
                }
        }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T02:38:08.810

实际上，我最终发现支持 Kanji（在我的情况下）的最佳方法是*根本不*嵌入字体，而只是在 TextField 中使用 _sans 选项。

# c++ - 什么是 C++ 的好的 HTML 模板引擎？

> ID：537820
> 
> 赞同：18
> 
> 时间：2009-02-11T17:08:56.287
> 
> 标签：c++, templates, template-engine

> **可能重复：**
> [C++ HTML 模板框架、模板化库、HTML 生成器库](https://stackoverflow.com/questions/355650/c-html-template-framework-templatizing-library-html-generator-library)

计划用 C++ 编写一个网站。想使用像 Clearsilver 这样的模板系统，但也许有更好的选择？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-11T17:21:14.977

[Wt](http://www.webtoolkit.eu/wt)（读作“witty”）是一个用于开发和部署 Web 应用程序的 C++ 库和应用程序服务器。它不是一个强制编程方式的“框架”，而是一个库。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-11T17:30:15.127

要添加到上一个问题：

[模板](http://code.google.com/p/google-ctemplate/)

[CTPP](http://ctpp.havoc.ru/en/)

您还可以使用 C++ 与 ClearSilver（用 C 编写）进行交互。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-03-03T14:00:26.190

查看[Grantlee](https://github.com/steveire/grantlee)：基于 Django 的模板系统，但使用 C++ 和 Qt。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-11T17:23:37.047

您可以查看[cgicc](http://www.gnu.org/software/cgicc/)，它有助于处理发布的数据，但它实际上不适用于 html 生成部分。否则我认为[Clearsilver](http://www.clearsilver.net/)是一个非常好的模板引擎，已经被[专业使用](http://www.clearsilver.net/examples.hdf)

# c - 无法使用 ODBC 连接到 Oracle 10g Express Edition

> ID：537845
> 
> 赞同：2
> 
> 时间：2009-02-11T17:19:33.577
> 
> 标签：c, oracle, odbc, oracle-xe

我正在使用 C 编写一个 DLL，它使用 ODBC 为几个不同的应用程序提供基本的数据库连接功能。当我使用此 DLL 连接到 Oracle 数据库（特别是 Oracle 10g Express Edition）时，我收到以下错误消息：

*由于系统错误 1114（XE 中的 Oracle），无法加载指定的驱动程序。*

重新启动计算机后，使用此 DLL 的应用程序之一可以连接到数据库，但另一个（更重要的）仍然收到此消息。

有谁知道可能导致此错误的原因以及我该如何解决？我以前从未使用过 Oracle，所以我真的不知道从哪里开始解决这个问题。提前感谢任何人可以提供的任何想法。

编辑：我检查了 PATH 环境变量。它以：*C:\oracle\app\oracle\product\10.2.0\server\bin*开头。这是我计算机上通往 Oracle 的正确路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T17:35:17.363

1.  设置 windows PATH 以首先搜索与您尝试使用的 Oracle ODBC 驱动程序相关的 ORACLE_HOME\bin，或者在与 ODBC 驱动程序相关的 ORACLE_HOME\bin 目录中启动您的应用程序。
2.  确保 ODBC 驱动程序的版本与您安装的 SQL*Net 的版本相匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T18:06:11.453

*   检查是否`tnsping`可以访问您的数据库
*   尝试连接到 Oracle`sqlplus`
*   检查 ODBC 参数。是微软驱动还是甲骨文驱动？
*   通过创建 ODBC DSN`Control panel -> Administrative Tools -> Data Sources`并尝试连接到 Oracle

# javascript - 网页上帮助文本的简单 javascript 和图像

> ID：537848
> 
> 赞同：-1
> 
> 时间：2009-02-11T17:20:26.103
> 
> 标签：javascript

我真的想在我的一些输入字段旁边放一个小问号图像，以便用户可以单击并获取一个小框并提供一些帮助文本。工具提示也可能适用于此。这是我想要的：

1.  当用户单击图像时弹出一个小文本区域的脚本（不是新窗口，只是当用户单击其他地方时消失的文本和链接区域）
2.  问号的漂亮小方形图像。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T17:27:30.890

我使用[BeautyTips](http://plugins.jquery.com/project/bt)，一个用于显示信息工具提示/气球的 jQuery 插件，查看[演示](http://www.lullabot.com/files/bt/bt-latest/DEMO/index.html)。

[![](https://i.stack.imgur.com/W0OXz.jpg "美容小贴士在行动")](https://i.stack.imgur.com/W0OXz.jpg "美容小贴士在行动")
[（来源：[lullabot.com](https://www.lullabot.com/files/u2/diwd-schedule-2.jpg)）]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T19:35:34.407

如果您不介意它出现在悬停而不是单击时，它可以纯粹在 CSS 中完成。试试这个：

```
<html>
  <head>
    <style type='text/css'>
      a.helpAnchor {
        position:relative;
        text-decoration:none;
      }
      a.helpAnchor .helpIcon {
        position:absolute;
        text-align:center;
        font-size:24px;
        font-weight:bold;
        width:30px;
        height:30px;
        color:#ff0;
        background-color:#88f;
      }
      a.helpAnchor .helpText { 
        display:none; 
      }
      a.helpAnchor:hover .helpText {
        display:block;
        position:absolute;
        width:150px;
        top:10px;
        left:20px;
        background-color:#eff;
        color:black;
        border:1px solid black;
      }
    </style>
  </head>
  <body>
    <a href="#" class="helpAnchor">
      <div class="helpIcon">?</div>
      <div class="helpText">
        <h1>Help Text</h1>
        <p>This text is very helpful!</p>
        <p>And so is this!</p>
      </div>
    </a>
  </body>
</html> 
```

如果问号图标是图像，它会看起来更好 - 并简化 CSS。帮助文本的 CSS 也需要根据口味进行调整。

# objective-c - 如何在Objective C中向superview发送消息

> ID：537853
> 
> 赞同：10
> 
> 时间：2009-02-11T17:21:23.510
> 
> 标签：objective-c, cocoa-touch

我是 Objective C 和 Cocoa 的新手。我只是不明白如何向 UIView 的超级视图发送消息。我无法让它工作。这是我到目前为止所尝试的：

在我的 MainView 中，我有一个名为 resetDrawType 的方法：

```
- (void) resetDrawType {
   self.drawType = foo;
} 
```

同样在 MainView 中，我创建了一个子视图并将其添加到 MainView：

```
mySubView *mySubView = [[mySubView alloc] initWithFrame:CGRectMake(foo, foo, foo, foo)];
[self addSubview:mySubView];
[mySubView release]; 
```

然后，当子视图完成绘图时，我想将消息 resetDrawType 发送到它的超级视图，即 MainView。

我试过这个

```
 [(MainView*)[self superview] resetDrawType]; 
```

和

```
 [(MainView*)self.superview resetDrawType]; 
```

......什么不起作用。我了解了非正式协议，所以我将此代码添加到 MainView.h

```
 @interface NSObject ( resetters )
    - (void) resetDrawType;
 @end 
```

但还是一无所获。接下来我发现了这个选择器，并在子视图中尝试了这个：

```
 if ([self.superview respondsToSelector:@selector(resetDrawType:)])
    [self.superview performSelector:@selector(resetDrawType) withObject:nil]; 
```

它也没有工作。我究竟做错了什么？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-11T17:44:29.977

你不应该让子视图告诉它的父视图很多东西。您应该使超级视图成为您的视图类的代表。

```
// MainView
MyView *myView = [[MyView alloc] initWithFrame:CGRectMake(...) delegate:self]; 
```

然后将委托保存到由`id delegate`. 当你完成绘图时：

```
// MyView
- (void)doDrawing {
  drawStuff();
  [delegate didFinishDrawingView:(MyView *)self]
} 
```

现在回到你的 MainView，实现这个方法

```
- (void)didFinishDrawingView:(MyView *)aView; 
```

做你想做的事。

所有这一切的重点是，应用程序边缘的小类（如小子视图）不需要知道它们上面的大类是如何工作的。此设置允许视图在链上进行通信，但使用传达其自身状态的消息而不是指示其他对象执行特定操作的消息。这是 Cocoa 的结构方式，因此类可以很容易地重用，并且它们的事件可以根据您的需要重新调整用途。

你的 superview 应该知道当它的 subview 完成时该做什么。子视图应该让人们知道它的完成。

* * *

在子视图类的标题中声明一个实例变量，如下所示：

```
id delegate; 
```

为您的子视图类编写一个初始化程序，如下所示：

```
- (id)initWithFrame:(CGRect)frame delegate:(id)aDelegate {
  [super initWithFrame:frame];
  delegate = aDelegate;
  return self;
} 
```

现在你有一个初始化器，它将接受一个委托，保存该委托，然后允许你调用它的方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-11T17:30:24.567

首先，在 Objective-C 中，不需要强制转换为特定的类来发送消息。例如，您可以这样做；

```
[self.superview resetDrawType]; 
```

提供父视图具有以下功能；

```
- (void) resetDrawType {

} 
```

那么这应该可以正常工作。无需使用非正式协议。

此外，您的选择器测试是错误的，因为它与“resetDrawType”函数的定义不匹配。@selector(resetDrawType:) 测试一个名为“resetDrawType”的函数，该函数接受参数，而你的函数没有。

这就是您测试上述功能的方式；

```
if ([self.superview respondsToSelector:@selector(resetDrawType)])
    [self.superview performSelector:@selector(resetDrawType)]; 
```

（您也可以直接发送消息，而不是 performSelector）。

# javascript - JQuery event.target 错误

> ID：537860
> 
> 赞同：3
> 
> 时间：2009-02-11T17:25:36.760
> 
> 标签：javascript, jquery, event-handling, jquery-1.3

我有一个来自 div（price_item）的盒子，里面有几个子 div（日期、价格等）。我用它作为显示价格的旋转木马。如果单击任何孩子，则必须将父母的背景颜色更改为红色。我这样写：

```
$(...selectquery...).click(function() {
    var $tgt = $(event.target);
    $tgt.parent().css("backgroundColor", "red");
}); 
```

在 Chrome 上，event.target 按预期工作，在 Firefox 3.0.1 上显示“未定义事件”。我该如何解决这个问题？

我尝试了以下方法：

```
$(this).parent().css() 
```

它说`'object is not a function'`

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T17:53:21.733

该`event`对象通过 jQuery 传递到您的点击处理程序，因此您需要将其指定为参数。

您还可以将点击处理程序添加到父对象并使用“$(this)”而不是 event.target：

```
$(...select the parent...).click(function() {
    $(this).css("backgroundColor", "red");
}); 
```

如果用户单击父级或其任何子级，它将调用您的单击处理程序。如果您只需要在他们实际点击其中一个孩子（例如，不在他们之间）时更改背景，这将不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T22:48:49.913

如果您想对事件做任何事情，请确保将事件作为参数传递给处理函数：

```
$('#foo').click(function(event) {
  // ...
}); 
```

但是同上之前的海报所说的，你应该能够只使用 $(this) 来获得你想要的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T17:44:35.093

```
$(...selectquery...). .click(function(event) { var $tgt = $(event.target); 

$(this).parent().css("...") should work as well 
```

# c# - 如何获得具有 RepeatColumns = 2 和备用行样式的 .net DataItem？

> ID：537864
> 
> 赞同：1
> 
> 时间：2009-02-11T17:26:28.600
> 
> 标签：c#, .net, asp.net

我有一个对象列表，每行需要输出 2 个项目，并且每个备用行都有不同的背景（使用不同的 CSS 类）。

目前，我正在使用 DataList，将列表绑定到它，RepeatColumns=2，RepeatDirection="horizo​​ntal"。ItemStyle 和 AlternatingItemStyle 用于设置两列的样式。这会产生正确的布局，但我不知道如何为每行应用不同的样式。

我愿意使用任何其他控件来完成工作。必须有一种方法可以在不手动写出 HTML 的情况下实现这一点：

[替代文字 http://abunchofletters.co.uk/uploads/Downloads.png](http://abunchofletters.co.uk/uploads/Downloads.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T18:14:27.330

一种选择是中继器控制。更加灵活，但代价是您必须自己构建模板。

请参阅[http://msdn.microsoft.com/en-us/magazine/cc163780.aspx](http://msdn.microsoft.com/en-us/magazine/cc163780.aspx)

# ssl - 将已发布的 .pem 合并到 Websphere 6 密钥库中

> ID：537889
> 
> 赞同：2
> 
> 时间：2009-02-11T17:32:07.417
> 
> 标签：ssl, websphere

我有一个在 IBM Websphere 6.1 上运行的应用程序。此应用程序必须使用 SSL 与其他（外部）实体使用的其他类似应用程序进行通信。我相信我是这个小组中唯一使用 Websphere 的成员。我组中其他人信任的证书颁发者向我颁发了一个“.pem”文件。如何将其合并到 Websphere 中？

我尝试使用 ikeyman 打开 Websphere 用于此应用程序的密钥库和信任库，但我不知道如何导入 .pem 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-07T20:00:17.223

您需要将 pem 封装为 pkcs#12 格式（使用 openssl），然后将 p12 容器添加到 WS 配置中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-06T11:43:22.583

正确的方法是遵循此技术说明中的说明：[How to transform PEM and PFX keystore in Public Key Cryptography Standard #12 (PKCS12) keystore](https://www-304.ibm.com/support/docview.wss?uid=swg21280977)。

# c# - 编写具有太多数据收集过程的程序的最佳实践 C#

> ID：537890
> 
> 赞同：0
> 
> 时间：2009-02-11T17:32:15.293
> 
> 标签：c#, authentication, data-collection

我必须登录到各种元素来检索一些数据，问题是每个元素都有自己的登录凭据，我想将所有这些数据收集过程写入一个程序，这样我就没有 10 个不同的计划进程要查看。

你们有没有人遇到过这样的挑战，如果有，你是怎么做的？我现在正在以自上而下的方式进行操作，因此在第一个数据收集过程实施后，程序将进行下一个...

我知道这不是正确的方法，我有线程和进程，但作为一个初学者我现在有点迷路了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T17:36:49.713

如果收集不同来源的数据的过程需要更长的时间，如果你使用多线程和回调来完成，你可以获得更快的结果，但如果在正常情况下不需要很长时间，为什么不让它尽可能简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T18:14:55.583

这将取决于您需要如何登录每个元素，以及“收集”数据的含义。如果您可以提供一些特定类型的元素（SQL、Oracle、AS/400 等）以及您试图从中获得什么，那么我们可以帮助您开始自动化流程。

# asp.net - HttpContext 和自动完成扩展器

> ID：537897
> 
> 赞同：1
> 
> 时间：2009-02-11T17:33:10.877
> 
> 标签：asp.net, ajax, ajaxcontroltoolkit

我正在使用 Ajax 控制工具包中的 AutoComplete Extender。我有一个这个扩展器使用的网络服务。在 web 方法中，我需要访问`empid`ASPX 页面中存在的值。我将此值放在`HttpContext's`我的 ASPX 页面的 Items 集合中。

```
HttpContext.Items["empid"]=<value>; 
```

在网络方法中，我尝试使用

```
string s=Context.Items["empid"]; 
```

但是 Items 集合那里没有任何项目。这是由于自动完成扩展器控件正在执行的部分回发。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T17:45:03.890

AutoComplete Extender 在 Web 服务上使用具有特定签名（在文档中解释）的 Web 方法。这将使用 JavaScript（在幕后）从浏览器调用。

Web 服务及其 Web 方法对您的页面一无所知——它们只知道在 Web 方法的参数中传递给它们的信息。

# multithreading - 正确使用 Scheme (Bigloo) 中的线程

> ID：537899
> 
> 赞同：2
> 
> 时间：2009-02-11T17:33:35.557
> 
> 标签：multithreading, scheme, bigloo

我正在尝试使用 Bigloo 实现在 Scheme 中编写应用程序服务器。编码：

```
(module server
    (library fthread)
    (main main))

(define *port-num* 8080)

(define (main argv)
    (let* ((socket0 (make-server-socket *port-num*))
           (ts (thread-start! (make-thread (lambda () (start-server socket0))))))
         (scheduler-start!)
         (fprint (current-error-port) "Shutting down...")))

(define (start-server socket0)
        (lambda ()
        (print "Starting server...")
             (let loop ()
            (let ((s (socket-accept socket0)))
                 (print "New connection: " s)
                 (thread-start! (make-thread (lambda () (handle-request s))))
                 (thread-yield!)
                 (loop)))))

(define (handle-request s)
        (print "new request")
    (socket-shutdown s #f)) 
```

它编译正常，但程序在启动后立即终止：

```
$ bigloo -o server server.scm
$ ./server 
Shutting down... 
```

我哪里错了？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T19:47:37.903

我不知道 Bigloo 的 fthread 库，但可能是您立即返回 lambda`start-server`而不是工作？

就像我说的，我不知道 fthread，所以也许这就是你应该使用它的方式。除了`handle-request`你没有这个 lambda 包装器，你调用`make-thread`的方式完全相同：

```
(make-thread (lambda () (start-server socket0)))
; vs
(make-thread (lambda () (handle-request s))) 
```

如果这是问题所在，您可以通过摆脱内部的 lambda`start-server`或将第一次`make-thread`调用更改为

```
(make-thread (start-server socket0)) 
```

# signal-processing - 从另一个来源提供时钟的流驱动 DAC？

> ID：537915
> 
> 赞同：2
> 
> 时间：2009-02-11T17:38:01.083
> 
> 标签：signal-processing, acoustics, digital-analog-converter, clockrates

我的 DAC 内部时钟为 48khz，我需要从一个同样为 48khz 但时钟来自不同来源的流中提供它。

这两个源会随着时间的推移而漂移，并且两者之间的任何缓冲都将不可避免地上溢或下溢。

不幸的是，没有可用于源的速率控制机制。

如何最好地处理这个问题？

复制或扔掉偶尔的样品来补偿是否可以接受？我估计每约 70k 个样本 1 个样本，差异为 30ppm。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T17:57:10.117

由于您的时钟基本上以两种不同的速度运行，您别无选择，只能复制或丢弃样本。

记录已经读/写了多少样本，并根据当前时间计算您期望读/写的样本数量。然后可以通过复制/丢弃样本来调整差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-22T01:58:25.217

如果您担心保真度，请使用采样率转换器，而不是删除或复制样本。首先，使用时间戳来测量源采样率和 DAC 采样率之间的相对频率比。使用该比率来控制采样率转换器。一个质量不错的采样率转换器可以为您提供 95 分贝的信噪比。计算成本更高的算法可以为您提供 > 120 db 的信噪比。

看：

*   [WIkiPedia 的采样率转换](http://en.wikipedia.org/wiki/Sample_rate_conversion)文章
*   [库采样率](http://www.mega-nerd.com/SRC/)
*   [ADI](http://www.analog.com/)公司有关于高质量采样率转换算法的论文

--jdkoftinoff

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T19:37:18.303

This may sould like a stupid question, but hear me out: Does the output rate really matter?

Consider this scenario - you have an audio input device. You are sampling an analog waveform input at 48Khz. That waveform could be generated by anything at any rate- from the continuous pressure level measurement of a microphone to an 8Khz voice codec, or lower. The fact that you happen to know that this particular output is also at 48Khz has no bearing on what you are doing.

If there were perfect transmission between the output device and your input, when you compare the original digital waveform to what you read, you will occassionally see that you have duplicated a sample (if your clock is faster) or missed one (if you are slower). But this will happen automatically, without any compensation by you needed. This will easily be as accurate as any attempt by you to figure out when to "duplicate or toss the occasional sample".

In practice, you probably won't get an exact duplicate anyway, between filtering effects and noise in both the DAC and ADC. Unless you are talking about some encoded digital audio format - in which case, ignore everything I've said.

EDIT - Ok, so it is digital audio - S/PDIF?
The signal should carry enough information to implement a phase lock. Ideally in hardware - the rising edges of the signal define the clock rate - you may be able to use PLL hardware to lock your A/D clock to the input. Or oversample for a while and count the rising edges to determine the rate. Or at the software level, measure the rate of framing errors in the 1st four time slots, and adjust your clock to compensate.

# java - 有效地遍历哈希图中的所有 MATCHING 键？

> ID：537921
> 
> 赞同：4
> 
> 时间：2009-02-11T17:40:25.960
> 
> 标签：java, search, performance, iterator, hashmap

我`HashMap`有数百万个条目。

需要检索其键与一组特定条件匹配的所有条目（在这种情况下，每个键都是具有两个整数属性的对象；我需要检索其中每个整数都在指定范围内的所有键）。

迭代所有这些键的最快、最有效的方法是什么？

**更新：** 在这种特殊情况下，虽然我没有预先指定它，但键中的第一个整数自然优先于第二个整数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T17:50:33.847

HashMap 不是用于查找位于特定范围内的键的有效数据结构。通常，您可以在散列映射中有效找到的唯一键是与您拥有的具有相同散列的键（即相等键）。

要查找位于某个范围内的键，最好使用某种类型的[SortedMap](http://java.sun.com/javase/6/docs/api/java/util/SortedMap.java)，例如 TreeMap，然后可以使用 SortedMap.subMap(low, high) 视图方法查看。

至于根据*两把*钥匙找一把钥匙，那就更难了。您最好的选择可能是遍历第一个整数范围的 subMap，然后检查每个整数是否在指定范围内。这至少将扫描限制在范围内具有整数之一的键。尝试根据整数对地图进行排序，该整数在您可能必须搜索的可能范围内具有更自然的值分布。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T18:49:13.067

这是使用[TreeMap的](http://java.sun.com/javase/6/docs/api/java/util/TreeMap.html)**解决方案**：

```
public static void main(String[] args) {
    Comparator<Foo> fooComparator = new Comparator<Foo>() {
        @Override
        public int compare(Foo o1, Foo o2) {
            return o1.compareTo(o2);
        }
    };

    TreeMap<Foo, String> map = new TreeMap<Foo, String>(fooComparator);

    map.put(new Foo(1, 4), "");
    map.put(new Foo(1, 3), "");
    map.put(new Foo(2, 4), "");
    map.put(new Foo(3, 4), "");
    map.put(new Foo(8, 10), "");
    map.put(new Foo(8, 17), "");
    map.put(new Foo(10, 10), "");

    int a = 2;
    int b = 5;

    for (Foo f : getKeysInRange(map, a, b)) {
        System.out.println(f);
    }
}

public static List<Foo> getKeysInRange(TreeMap<Foo, String> map, int low, int high) {
    Foo key1 = new Foo(low, low);
    Foo key2 = new Foo(high, high);

    Foo fromKey = map.ceilingKey(key1);
    Foo toKey = map.floorKey(key2);

    if (fromKey != null && toKey != null && fromKey.compareTo(toKey) < 0)
        return new ArrayList<Foo>(map.subMap(fromKey, true, toKey, true).keySet());
    return new ArrayList<Foo>();
}

public static class Foo implements Comparable<Foo> {
    private int i;
    private int j;

    private Foo(int i, int j) {
        super();
        this.i = i;
        this.j = j;
    }

    public int min() {
        if (i < j)
            return i;
        else
            return j;
    }

    public int max() {
        if (i > j)
            return i;
        else
            return j;
    }

    @Override
    public String toString() {
        return "I=" + i + "J=" + j;
    }

    @Override
    public int compareTo(Foo o) {
        if (this.min() > o.min()) {
            return 1;
        } else if (this.min() < o.min())
            return -1;
        else {
            if (this.max() > o.max())
                return 1;
            else if (this.max() < o.max())
                return -1;
            else
                return 0;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T17:50:30.010

如果不遍历整个 keySet，您将无法做到这一点。

如果您确定不会有其他条目具有与这些整数属性相同的值，则可以使用带有排序条件的 TreeMap，该条件将按两个整数属性的某种组合进行排序，然后您可以找到第一个直接匹配，然后从那里迭代到第一个不匹配。但您似乎不太可能达到这些条件。

因为集合的开销非常低（所有内容都通过引用存储），我会考虑制作两个排序集合，可能是 TreeSet，一个按第一个属性排序，一个按第二个属性排序，然后从两个集合并将它们结合在一起。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T20:24:32.210

bruno conde 提供的解决方案是一个好的开始。但是，我阅读原始问题的方式是 key Object 包含两个整数，问题是关于检索与第一个整数的一个范围匹配并与第二个整数匹配第二个范围的所有键/值对的最快方法整数。布鲁诺解决方案假设键具有自然顺序，其中第一个整数始终优先于第二个整数。它还假设只有一个范围。

对于这种更一般的情况，我会： 使用有利于 integer1 的比较器将键/值插入到 TreeMap 使用有利于 integer2 的比较器将相同的键/值插入到第二个 TreeMap

然后，您可以使用范围在每个 TreeMap 上使用 subMap() 来获取底层 TreeMap 的有序视图。然后，您可以根据这些 subMap 的 keySet() 的交集 (retainAll()) 创建一个新的结果 TreeSet。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T17:49:35.363

可能不会有比以下更快的解决方案：

```
for (final KeyObj key : map.keySet()) {
    // do work
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T17:49:55.190

如果[`TreeSet`](http://java.sun.com/javase/6/docs/api/index.html?java/util/TreeMap.html)由于某种原因 a 不起作用，则迭代的标准方法是使用条目集。

```
for (Map.Entry<MyKeyType, MyValueType> entry : myMap.entrySet()) {
    MyKeyType key = entry.getKey();
    if (isValid(key)) {
        // do whatever
        validList.add(entry.getValue());
    }
} 
```

这样，您不必额外`myMap.get(key)`调用有效密钥。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T18:12:05.403

您可能需要考虑某种 SQL DB，可能是像[Derby](http://db.apache.org/derby/)或[H2](http://www.h2database.com/)这样的内存数据库。这在很大程度上取决于它的重要性以及它的速度有多重要。然后您可以在 SQL 中执行此操作，并让引擎完成所有优化工作。

# user-interface - 测试自动化中的 GUI 映射策略

> ID：537929
> 
> 赞同：4
> 
> 时间：2009-02-11T17:43:26.110
> 
> 标签：user-interface, testing, automated-tests

在我的测试自动化实践中，我总是使用减少维护工作的 gui 映射策略。

例如，如果我需要识别“ *Google 搜索*”按钮 (www.google.com)，它的 XPAth 将是

```
//input[@name='q']
```

而不是

```
/html/body/center/form/table/tbody/tr/td[2]/input[3]
```

很明显，在第二种情况下，页面结构的一点变化可能会破坏我的测试。

但也许我错过了什么？也许如果文档结构发生变化，我应该知道这一点并且我的一些测试应该失败？

你怎么看？你会推荐什么最佳实践？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T17:50:53.003

如果元素具有脚本/css 使用的 id，我们在测试中使用该 ID。否则，我们会主动检测我们的 HTML 以进行测试。我的意思是我们可以添加一个 id*仅用于测试*以避免任何歧义。我们通常给它一个前缀来表示这一点，即。id="ftGoogleButton"。这样一来，只使用 HTML 的人就会明白存在与元素相关的自动化测试。这种约定是实用的，因为它们通常只会在 css/js 中查找对给定 id 的引用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T17:54:59.530

我也会这样做，选择第一个配方而不是第二个......对于大多数测试。

您希望您的测试在与这些测试涵盖的功能*相关*的更改时中断，并且您希望相同的测试*忽略*对应用程序的大多数其他更改。

因此，如果您正在检查搜索“foo”是否应该返回超过零个文档，这与页面结构无关，应该忽略此类更改。

但是，在为确保搜索表单配备提交按钮而编写的测试中，您希望在用于从表单导航到按钮的 XPath 中体现这些假设。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-13T02:04:29.560

正如 krosenvold 所说，让开发人员标准化 html`name`和/或`id`属性并使用它们是最好的策略之一。我的论文[Test Automation as a Development Requirement](http://www.odin.co.uk/downloads/TestAutomationAsDevelopmentRequirement.pdf)讨论了这个主题以及开发人员可以做的其他事情，以使应用程序对自动化更加友好。

您还应该确保所有对象标识属性都存储在一个中央存储库中，以使后续维护更容易。大多数商业工具都内置了此功能，但使用开源工具，您可能需要推出自己的机制。

# asp.net - App_Data - Web 应用程序的数据目录。它有多安全？

> ID：537930
> 
> 赞同：7
> 
> 时间：2009-02-11T17:43:44.237
> 
> 标签：asp.net, security

在 msdn 文档的许多地方，您都可以找到对 App_Data 目录的引用。例如，我们可以[在这里](http://msdn.microsoft.com/en-us/library/system.web.security.authorizationstoreroleprovider.aspx)阅读：

> 为了提高在 ASP.NET 应用程序中使用本地数据文件时的安全性，您应该将数据文件存储在 App_Data 目录中。

和

> 存储在 App_Data 目录中的文件将不会提供给 Web。

我找不到直接参考来说明如何保证安全性。是否有任何 IIS 设置等我应该注意以确保我们放在 App_Data 目录中的文件突然不会对所有人可用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-11T17:59:01.843

这些文件受到禁止文件处理程序的保护。只要一切正常，这是安全的。有可能 ASP.NET 处理程序可能会停止运行，只留下 IIS 运行。在这些情况下，您的 web.config 文件和 aspx 文件将作为纯文本文件提供。

如果您的数据不是很敏感，那么它是存储数据的好地方。如果您有高度敏感的数据，请将其存储在另一台机器上。

编辑：更多信息您可以在此处阅读有关禁止文件处理程序的更多信息[http://msdn.microsoft.com/en-us/library/bya7fh0a.aspx](http://msdn.microsoft.com/en-us/library/bya7fh0a.aspx)。向下滚动您会注意到“root web.config”文件中有一个用于 mdfs 的条目。您通常可以在计算机上的 C:\Windows\Microsoft.NET\Framework\v2.0.50727\CONFIG 找到此文件

我找不到太多关于在保持 iis 运行的同时关闭 asp.net 的信息，但如果你在谷歌上搜索“要求下载 aspx”或类似的术语，你可以找到有关人们遇到问题的报告（通常是 asp.net）。 net 未正确配置），这将允许发生漏洞。我没有看到它发生太多，但这是可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T17:51:27.293

在我的脑海中，我想它们会以与 .config 文件相同的方式受到保护。这基本上意味着，这些项目的 ASP.NET 处理程序返回“不提供此类页面”消息。它可能会返回 404 错误。确保最安全的方法是不要将数据库存储在那里。

# windows - 如何为 Windows 设计一个轻量级的 GUI？

> ID：537935
> 
> 赞同：0
> 
> 时间：2009-02-11T17:45:25.090
> 
> 标签：windows, user-interface

我希望在 Windows 中创建一个非常轻量级的 GUI 前端。它应该做一个简单的任务 - 当按下热键组合时，它会打开一个文本框。可以粘贴任何文本，然后使用简单的文本框保存。我希望完全避免使用任何菜单栏或工具栏。

创建这样的东西的理想 GUI 库是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T18:01:04.633

你所说的“轻量级”究竟是什么意思？如果系统资源的绝对最小数量很重要，您应该使用“C”和原始 Win32 API 对其进行 Petzold 风格的编码。这将需要你几天，给予或接受。

如果“轻量级”的意思是“我想在一个小时内完成它并完成它”（可能比在 SO 上等待答案更快），你应该使用像 Windows Forms 这样的 RAD 工具对其进行编码。它肯定会比“C”版本使用更多的资源*。*但是，您不太可能注意到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T17:46:53.123

假设您有 Visual Studio，.NET 将是最容易在最短的时间内启动和运行的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T17:59:21.500

我会使用 WTL 解决一些问题 - 占用空间会很小 -*可能*是用 C 编写的原始 Win32 应用程序的下一个最好的东西。例如，不会有太多需要担心的依赖关系，这可能很重要.

WTL 可从 Source Forge 获得：

[http://sourceforge.net/projects/wtl](http://sourceforge.net/projects/wtl)

Code Project 上有一些优秀的文章可以帮助您入门。WTL 下载可以为 Visual Studio 安装 WTL 应用程序向导，只需单击几下鼠标即可为您提供一个简单的应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T18:43:23.377

这个问题非常广泛，但我偏爱基于标记的 UI。这是 WPF 中带有文本框的窗口：

```
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
    <Grid>
      <TextBox x:Name="InputBox"/>
    </Grid>
</Window> 
```

现在我什至不会声称 WPF 具有最短的学习曲线，但它*是*Windows 上最强大的，并且使用正确的工具很容易上手。（即表达混合）。Blend 并不便宜，但有些人已经免费拥有它并且不知道它（学生、MSDN 订阅者、一些初创公司）。Visual Studio 2010 在这方面也有很大改进，因此可能不需要 Blend。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T17:56:05.690

轻量级框架长期以来一直是 ATL/COM 的领域。

对于如此简单的主要目标是轻量级的事情，我会说根本不使用 GUI 库。所有 UI 元素都可以通过直接 API 调用获得。我建议您阅读 Charles Petzold 的*Programming Windows*的副本，其中详细介绍了如何执行此操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T17:56:59.883

MFC、Win32、WinForms、.NET 表单...

对于这样简单的应用程序，您应该使用您最了解的（语言和框架）。

如果你什么都不知道（它发生了，不用担心），并且你想学习，C# 可能比安装 3rd 方工具包和框架（wxPython、tk/tcl、 QT，...）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T18:05:31.953

我在这方面做的不多，但我会在第二次使用 Visual Studio 和 C# 来提升你的前端。用于制作其他 GUI 的 GUI 工具非常好，因此您可能很快就可以完成。

如果您可以完全控制要使用的内容，我实际上建议您使用 Java Swing。它有一堆类可以完成大部分你想要的东西，它们可以很容易地相互插入。作为一个好处，如果您需要，它基本上可以免费移植到其他平台。但是，您肯定会希望查看教程，因为它的操作方式与大多数其他库不同，但您会希望对任何框架都这样做。

如果您需要使用 C++，那么您可能会想要考虑使用 MFC，但是对于其他语言有更好的框架。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T19:45:10.967

使用 VBS 脚本文件和标准 COM 库执行此操作可能仍然可行。[使用PowerShell](http://msdn.microsoft.com/en-us/magazine/cc163301.aspx)可能更容易。

# java - 为什么 JRuby 不能识别 BigNums 而 Ruby 可以？

> ID：537939
> 
> 赞同：3
> 
> 时间：2009-02-11T17:46:52.950
> 
> 标签：java, ruby-on-rails, ruby, jruby, bignum

如果我输入这个大整数：

```
puts 9997836544.class.to_s 
```

并用 ruby​​ 1.86 编译，它预期会报告：

```
BigNum 
```

而 JRuby（Netbeans 中的 1.1.4）令人惊讶地报告：

```
Fixnum 
```

我认为 Java 有一个 BigInteger 类来对应 Ruby 中的 BigNum 类。如果是这样，我会期望 JRuby 和 ruby​​ 产生相同的输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T20:25:42.643

发现这个[JRuby 错误报告](http://jira.codehaus.org/browse/JRUBY-1587)：

> 似乎 JRuby 和 MRI 对区分 Fixnum 和 Bignum 有不同的限制。
> ...
> 所以，MRI 使用 0x3fffffff 作为 32 位环境下的最大 FixNum。
> 而 JRuby**总是**使用 64 位值：`jruby -e 'p (0x7fffffffffffffff + 1).class'`---> Bignum。

所以尝试一个更大的数字，你应该得到一个如你所愿的 BigNum。

# linux - 如何列出正在运行的屏幕会话？

> ID：537942
> 
> 赞同：268
> 
> 时间：2009-02-11T17:47:34.417
> 
> 标签：linux, bash, command-line, gnu-screen

我有一堆服务器，我使用`screen`. 程序如下：

1.  `ssh`到服务器 XXX
2.  发射`screen`
3.  在几个标签中开始实验
4.  分离`screen`
5.  断开与服务器的连接

在运行实验时，我可以`ssh`通过访问所有服务器并列出我正在运行的进程（使用`top`或`ps`）轻松找到它们在哪些服务器上。

但是，一旦实验完成，我如何才能找到在哪些服务器上打开了屏幕会话（以便我可以查看输出、重新启动它们等）？

PS：我的实验也将它们的输出打印到文件中......但这不是我问题的重点。

* * *

## 回答 #1

> 赞同：479
> 
> 时间：2009-02-11T17:56:04.973

要列出用户的所有屏幕会话，请以该用户身份运行以下命令：

```
screen -ls 
```

要查看特定机器上的所有屏幕会话，您可以执行以下操作：

```
ls -laR /var/run/screen/ 
```

我在我的机器上得到这个：

```
gentle ~ # ls -laR /var/run/screen/

/var/run/screen/:
total 1
drwxrwxr-x  4 root utmp   96 Mar  1  2005 .
drwxr-xr-x 10 root root  840 Feb  1 03:10 ..
drwx------  2 josh users  88 Jan 13 11:33 S-josh
drwx------  2 root root   48 Feb 11 10:50 S-root

/var/run/screen/S-josh:
total 0
drwx------ 2 josh users 88 Jan 13 11:33 .
drwxrwxr-x 4 root utmp  96 Mar  1  2005 ..
prwx------ 1 josh users  0 Feb 11 10:41 12931.pts-0.gentle

/var/run/screen/S-root:
total 0
drwx------ 2 root root 48 Feb 11 10:50 .
drwxrwxr-x 4 root utmp 96 Mar  1  2005 .. 
```

这是一个相当出色的 Unixy 使用 Unix 套接字包装在文件系统权限中来处理安全、状态和流。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-11T17:55:04.287

命令**screen -list**可能是您想要的。

见[人](http://linux.die.net/man/1/screen)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-08-25T08:48:55.433

虽然 joshperry 的回答是正确的，但我发现它没有告诉您屏幕名称（您使用 -t 选项设置的名称）非常烦人，这实际上是您用来识别会话的名称。（当然不是他的错，那是屏幕的缺陷）

这就是为什么我改为使用这样的脚本：`ps auxw|grep -i screen|grep -v grep`

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-11T17:55:55.283

我不太确定您的问题，但如果您真正想要的是列出当前打开的屏幕会话，请尝试：

```
screen -ls 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-11-22T10:51:38.177

```
 For windows system

 Open putty 
 then login in server 
```

如果要在控制台中查看屏幕，则必须编写命令

```
 Screen -ls 
```

如果您必须访问屏幕，那么您必须使用以下命令

```
 screen -x screen id 
```

在命令行中写入`PWD`以检查您当前所在的文件夹

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2021-09-27T16:43:15.723

**简单的指南要记住...**

`screen`- 创建屏幕

`screen -list`- 列出所有分离（运行）的屏幕及其屏幕 ID。

[![在此处输入图像描述](https://i.stack.imgur.com/O5sTx.png)](https://i.stack.imgur.com/O5sTx.png) 在这幅图片中 -

> 6764.pts-1.v1091330

是屏幕 ID。

`screen -x [screen id]`- 连接/附加到特定的运行屏幕。

`Ctrl + D`- 在屏幕中终止/停止屏幕运行。

`Ctrl + A, Then press D`- 在屏幕中从屏幕上分离而不会打扰它。

`killall screen`- 分离或终止所有屏幕。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-03-02T17:40:09.703

在大多数情况下，一个`screen -RRx $username/`就足够了:)

如果您仍想列出所有屏幕，请将以下脚本放在您的路径中，并将其命名为屏幕或任何您喜欢的名称：

```
#!/bin/bash
if [[ "$1" != "-ls-all" ]]; then
    exec /usr/bin/screen "$@"
else
    shopt -s nullglob
    screens=(/var/run/screen/S-*/*)
    if (( ${#screens[@]} == 0 )); then
        echo "no screen session found in /var/run/screen"
    else
        echo "${screens[@]#*S-}"
    fi
fi 
```

将选项 -ls-all 作为第一个参数时，除了显示所有屏幕会话外，它的行为与屏幕完全相同。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-11T23:01:59.570

很多人已经指出

```
$ screen -ls 
```

将列出屏幕会话。

这是另一个可能对您有用的技巧。

**如果您在服务器 xxx 上的.bashrc**文件中添加以下命令作为最后一行 ，那么它将在登录时自动重新连接到您的屏幕会话。

```
screen -d -r 
```

希望你觉得它有用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-08-02T15:26:55.490

您可以使用以下命令。

```
screen -list 
```

（或者）

```
screen -R 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-04-22T22:12:31.820

> ps x | grep 屏幕

如果您使用该命令，请查看该屏幕正在运行什么

> 屏幕 -A -m -d php make_something.php

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2009-02-11T17:58:23.437

所以你使用屏幕来保持实验在后台运行，还是什么？如果是这样，为什么不直接在后台启动它呢？

```
./experiment & 
```

如果您要问如何通知我完成的工作，如何将实验与邮件命令串在一起？

```
./experiment && echo "the deed is done" | mail youruser@yourlocalworkstation -s "job on server $HOSTNAME is done" 
```

# sql - 复制数据并保持新 ID 的引用完整性

> ID：537949
> 
> 赞同：1
> 
> 时间：2009-02-11T17:49:42.913
> 
> 标签：sql, sql-server, insert, foreign-keys

我需要一种工具或方法来允许传输数据并自动更新目标表中的外键。

SET IDENTITY_INSERT ON/OFF 不是我想要的。

例子：

```
table master (id int identity, name char)
table slave (id int identity, master_id int, name char) 
```

我想创建一个这样的脚本：

```
insert into master(name) values ('master a')
insert into master(name) values ('master b')

insert into slave(master_id,name) values ( ?, 'slave aa')
insert into slave(master_id,name) values ( ?, 'slave bb')
insert into slave(master_id,name) values ( ?, 'slave cc')
insert into slave(master_id,name) values ( ?, 'slave dd') 
```

插入*slaves*时，我想知道 master_id 的新值是什么，以保持与原始表中相同的关系。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T17:53:55.460

如果您在表中使用标识列，则函数 SCOPE_IDENTITY() 将返回最后插入记录的 ID。然后，您可以将其用作辅助表的外键。

[http://msdn.microsoft.com/en-us/library/ms190315.aspx](http://msdn.microsoft.com/en-us/library/ms190315.aspx)

有道理？

干杯，约翰

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T18:09:32.380

@John Sansom：钱就对了

@pv2008：

```
create proc InsertAndUpdate
@parentName varchar(255),
@childName varchar(255)

as
declare @newParentId int
insert into PARENT values (@parentName)
select @newParentId = SCOPE_IDENTITY()

insert into CHILD values (@newParentId, @childName) 
```

每次插入时调用这个 sproc

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T17:54:05.600

如果使用 UniqueIdentifier (Guid) 而不是 int，则在将 ID 值从一个数据库移动到另一个数据库时不需要更改它们。

# c# - 为什么在 WPF 自定义 2D 绘图中使用带有破折号图案的笔会导致巨大的（！）性能下降？

> ID：537950
> 
> 赞同：4
> 
> 时间：2009-02-11T17:49:43.753
> 
> 标签：c#, .net, wpf, 2d, pen

希望任何人都可以阐明这一点，以便我可以使用带有破折号图案的笔？

我正在使用 WPF 中的*X*编写一个可滚动的图表（实现的`Panel`内部） 。我有几千个s 可以通过在托管它们的 s 上使用来滚动。我通过在其顶部放置一个网格并使用//（注意：这些线始终是静态的，它们从不移动）从一个边缘到另一个边缘绘制简单的水平线来实现一个网格。`ScrollViewer``IScrollInfo``DrawingVisual``DataContext.Draw`*`DrawingVisual``TranslateTransform``Panel``Panel``DataContext.DrawLine(pen, new Point(0, y), new Point(widthOfPanel, y));`*

 *滚动性能绝对是疯狂的（即 DrawingVisual 是即时绘制的，滚动是即时的）。但是如果我使用一个`Pen`使用破折号模式（例如见下文）来绘制网格线，那么滚动非常不稳定，并且性能似乎已经降低了 100 倍（估计值）。谁能解释为什么会发生这种情况以及我如何解决这个问题？

带有破折号图案的笔示例：

```
<Pen x:Key="PenUsingDashPatterns" Brush="Black" Thickness="1">
   <Pen.DashStyle >
      <DashStyle Dashes="3, 3" />
   </Pen.DashStyle>
</Pen> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T16:48:22.727

这是一个可能的解决方法 - 如果您只绘制水平线和/或垂直线，您可以尝试`Pen`使用棋盘格图案创建您的，`DrawingBrush`例如：

```
 <Pen x:Key="PenUsingDashPatterns" Thickness="1">
        <Pen.Brush>
            <DrawingBrush TileMode="Tile" 
                          Viewport="0 0 6 6" ViewportUnits="Absolute">
                <DrawingBrush.Drawing>
                    <GeometryDrawing Brush="Black">
                        <GeometryDrawing.Geometry>
                            <GeometryGroup>
                                <RectangleGeometry  Rect="0 0 3 3"/>
                                <RectangleGeometry  Rect="3 3 3 3"/>
                            </GeometryGroup>
                        </GeometryDrawing.Geometry>
                    </GeometryDrawing>
                </DrawingBrush.Drawing>
            </DrawingBrush>
        </Pen.Brush>
    </Pen> 
```

或者，您可以对垂直和水平线使用不同的画笔，或者可能使用`ImageBrush`更好的性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T18:58:24.620

钢笔结冰了吗？冻结绘图对象对性能有很大帮助。

您可以设置一个 Loaded 处理程序并调试以查看您的笔是否被冻结。如果没有，请在它们上手动调用 Pen.Freeze() 按钮。

请注意，冻结也会使笔成为只读...冻结后您将无法修改它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-13T15:31:26.780

您应该使用 Perforator 来深入研究性能问题。这是 MSDN 站点的链接，其中讨论了各种[WPF 性能工具](http://msdn.microsoft.com/en-us/library/aa969767.aspx)。Perforator 可能是最能帮助您的工具，特别是在确定是否使用软件渲染器绘制线条时（这将是导致性能如此糟糕的最大因素）。

如果问题是它们是在软件中绘制的，您可能必须编写自己的[ShaderEffect](http://msdn.microsoft.com/en-us/library/system.windows.media.effects.shadereffect.aspx)，但这可能会很快变得棘手，除非您熟悉 HLSL。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T14:58:49.157

这很可能是因为这个特定的绘制操作不能委托给视频卡，这将强制在内存中进行合成并将 blitting 到视频卡。

# wcf - 如何提高我的中间件开发技能？

> ID：537962
> 
> 赞同：2
> 
> 时间：2009-02-11T17:51:38.400
> 
> 标签：wcf, web-services, workflow-foundation

我需要建议（书籍/链接）来提高我在以下方面的技能 -

1.  Web 服务（基于 SOAP 和 REST）
2.  Windows Communication Foundation（开箱即用且基于 REST）
3.  Windows 工作流基础

我认为自己在 Web 服务方面处于中等水平，在 WCF 和 WF 方面几乎处于中等水平。我想知道一些适合中高级读者的书籍/链接。任何其他平台无关的资源也会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T18:08:50.060

我想说 O'Reilly 和 Wrox 的常见嫌疑人很棒：

[奥莱利](https://rads.stackoverflow.com/amzn/click/com/0596521308)

[沃克斯](https://rads.stackoverflow.com/amzn/click/com/0470089849)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T21:45:19.550

推荐两本学习WCF的优秀书籍。

首先，您需要 WCF 圣经 - Juval Lowy 的“ [Programming WCF Services](http://oreilly.com/catalog/9780596521301/index.html) ”。这是 WCF 的书 - Lowy 以非常详尽的细节涵盖了几乎所有内容。这是一本非常有深度的技术书籍。至少一开始你会想慢慢来。一定要获得第二版——它涵盖了 VS2008 SP1。

Lowy 还围绕 WCF 建立了一个出色的库，与他的书相得益彰。[它被称为 ServiceModelEx - 你可以在这里](http://examples.oreilly.com/9780596521301/)找到它的来源。不过，拥有这本书真的很有帮助！

其次，我建议看看 Michele Bustamante 的“ [Learning WCF](http://oreilly.com/catalog/9780596101626/index.html) ”，也是 O'Reilly 的。这本书还没有针对 VS2008 和 .NET 3.5 进行更新，但是这里仍然有很多很好的信息。这本书更像是一个循序渐进的教程。它确实帮助我了解了 WCF 是什么以及它可以做什么。

除此之外，已经给出了最好的建议。编码你的屁股。我怎么强调都不过分。在我开始编码之前，WCF 对我来说几乎毫无意义。浏览教程。挑选一些有趣的东西变成一个组件，看看有多少种不同的方式可以通过 WCF 访问它。

祝好运并玩得开心点！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T18:36:44.033

你最好的选择是继续编码。自己创建其他项目的克隆，并让它引导你。

# xslt - 保留 xsl:sort'd 节点之间的空白

> ID：537963
> 
> 赞同：2
> 
> 时间：2009-02-11T17:51:38.650
> 
> 标签：xslt, sorting

我试图弄清楚如何在我正在排序的节点之间保留空白节点。这是一个例子。

输入：

```
<a>
    <b>
        <c>
            <d>world</d>
        </c>
        <c>
            <d>hello</d>
        </c>
    </b>
    <e>some other stuff</e>
</a> 
```

期望的输出：

```
<a>
    <b>
        <c>
            <d>hello</d>
        </c>
        <c>
            <d>world</d>
        </c>
    </b>
    <e>some other stuff</e>
</a> 
```

这是我的xslt：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="a/b">
        <xsl:copy>
            <xsl:apply-templates select="c">
                <xsl:sort select="d"/>
            </xsl:apply-templates>
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

当我通过 xsltproc 运行它时，我得到了这个：

```
<a>
    <b><c>
            <d>hello</d>
        </c><c>
            <d>world</d>
        </c></b>
    <e>some other stuff</e>
</a> 
```

之后我宁愿不把它整理好。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T18:05:36.790

您需要将这两行添加到样式表的顶部：

```
<xsl:strip-space elements="*"/>
<xsl:output indent="yes"/> 
```

第一行去除文档中的所有空白，第二行缩进输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T18:11:57.010

您的第二个模板与所有 b 匹配，但仅在 c 元素上应用模板。包含的文本节点被丢弃。这就是为什么您在输出中看不到 b 和 c 元素之间的空白。

您必须重新格式化树，因为重新排序后文本节点看起来不漂亮（即使您设法包含它们）。安德鲁斯解决方案将做到这一点。

# svn - SVN 和 EMC 文档

> ID：537964
> 
> 赞同：0
> 
> 时间：2009-02-11T17:51:56.323
> 
> 标签：svn, documentum

有没有人听说过 Documentum 被用来为 Subversion 提供后端存储？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T18:09:39.387

没听说过这个。

我也觉得可能性不大。subversion 后端需要比它本身更通用的数据存储，并且 documentum 面向文档的专门存储和管理。

肯定有人会硬塞它，但冒着把话塞进嘴里的风险，你似乎在问类似桥梁之类的东西，在其中可以将文档存储库呈现为颠覆存储库。

不太了解 documentum，我会说这不太可能，因为 svn 是基于基于目录的变更集分组和存储库范围的版本的想法。

更好的匹配可能是 CVS，它几乎是底层修订管理系统 (RCS) 的聚合接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-14T07:26:40.257

一些 EMC 人员编写了将 Composer 与 SVN 集成的非官方文章：http: [//paulcwarren.wordpress.com/2010/11/30/documentum-composer-and-eclipse-team/](http://paulcwarren.wordpress.com/2010/11/30/documentum-composer-and-eclipse-team/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-10T03:11:13.830

虽然可能 - 没有意义。原因 Documentum 已经提供了一些版本管理功能（类似于 subversion）。所以这就像有两个版本管理系统端到端堆叠。

我认为任何有这个想法的人都会将 Documentum 与存储解决方案（如 EMC Centera）混淆。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-30T06:26:04.177

我相信，您所能做的就是将 SVN 与您的作曲家集成，以从作曲家界面本身签出签入代码和其他工件。SVN 不能用作 Documentum 内容存储。

# delphi - 如何知道 Quantum Grid 5 中是否有需要滚动的数据？

> ID：537967
> 
> 赞同：0
> 
> 时间：2009-02-11T17:52:25.853
> 
> 标签：delphi, scroll, grid, devexpress, delphi-7

我正在使用来自 DevExpress 的 Express Quantum Grid 5 的 Delphi 7 中的遗留项目工作。

我的网格无法显示滚动条，所以我有一个外部导航器来控制滚动。

我可以使用该`GridView.Site.ScrollContent(ADirection)`方法滚动，但我不知道如何识别是否有一些数据要在四个方向（上、下、左和右）中的任何一个方向上滚动。

我需要知道这一点才能在不需要导航时禁用导航按钮。

有人知道这个问题的任何解决方案或解决方法吗？我在网格或其部分中找不到任何可以为我提供此信息的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T13:43:30.560

我找到了解决方案...

由于我们购买了组件的源代码，因此我们会在必要时对其进行一些更改。

在这种情况下，我发现了一个在 gridview`CanScrollData(ADirection)`中使用的受保护方法。`controller`我需要做的就是将这个方法公开，然后使用它。

```
Boolean canScrollLeft := Grid.ActiveView.Controller.CanScrollData(dirLeft)
```

# project-management - 任务生命周期

> ID：537969
> 
> 赞同：6
> 
> 时间：2009-02-11T17:53:00.720
> 
> 标签：project-management

您遵循什么任务生命周期？您是否在使用的工具中将任务和错误混合在一起？一个典型的任务生命周期是：

*   未开始 - 已输入但尚未开始
*   进行中 - 正在处理中
*   完成 - 任务以下列异常状态完成：
*   等待 - 等待某事
*   已取消 - 不再需要该任务，可能是由于需求发生了变化。

典型的错误生命周期可能是：

*   新 - 新进入
*   进行中 - 正在处理中
*   QA - 通过测试
*   客户审查 - 修复由客户审查
*   Ready for Promotion - 为下一个版本做好准备
*   完成 - 发布到生产中，但有以下异常状态：
*   等候接听
*   重复不可重现
*   按设计工作

你的生命周期是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T17:58:35.090

我喜欢保持简单：

*   待办的
*   有风险
*   生产中
*   完全的

当我在系统或 Excel 电子表格中列出这些任务时，我还为这些任务提供了非常具体的视觉辅助颜色，如上所示：

[![任务颜色](https://i.stack.imgur.com/arrAw.png)](https://i.stack.imgur.com/arrAw.png)

每一个的详细视图：

**Pending**是针对我还没有完成的任务，主要是因为它*需要*一些外部事件来启动它，比如一些批准，或者只是因为我不确定我是否会完成它。

**In Risk**是针对我确实开始但它们已接近截止日期的任务，而我离完成它还很遥远。如果我有太多的风险任务，我会开始优先处理它们，以便及时完成它们。

**在生产**中是我正在处理的一项常规任务。它可能没有截止日期，因此它永远不会处于风险中，或者如果我延迟太多，我设置了截止日期并且该任务可以更改为处于风险中。

**Complete**几乎是不言自明的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T18:19:22.887

实际上，我们设法为不同类型的任务拥有一个生命周期

*   **打开**
*   **在职的**
*   **被拒绝**
*   **待测试**
*   **解决**
*   **关**

这适用于我们基于[ITIL](http://en.wikipedia.org/wiki/Information_Technology_Infrastructure_Library)（管理信息技术 (IT) 基础设施、开发和运营的概念和政策集）的任务：

*   **案子**
*   **改变**
*   **依赖**（重新组合几个更改）
*   **发布**（重新组合几个依赖项）

不要忘记：

*   某些任务可能需要**辅助任务生命周期**：例如，在打开、处理等之前，必须先**提交**REL（Release） 。
*   **批准**生命周期可能伴随某些任务：没有批准列表就不能提交 REL（发布）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T18:41:24.287

我们正在使用一种工具来混合错误和功能请求（但我们会相应地标记每个条目，以便我们可以查看它是错误还是请求）。

由于我们有几个部门在处理这些任务，所以我们有更多的状态......我们不同的生命周期状态是：

*   **指定**（用于产品管理）
*   **重现**（用于测试，例如检查某事是软件问题还是客户的错误配置）
*   **开发**（针对开发人员）
*   **测试/验证**（用于测试部门）
*   **记录**（用于记录，例如将其包含在用户手册中）
*   **实施和验证**（这是我们关闭任务的时间）
*   **限制/拒绝/不可重现**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T19:02:26.950

On-hold 部分是我注意到的重要部分——我认为等待外部依赖项*完成任务*或设置某些内容对于管理层来说是一个重要的任务状态，以便他们可以轻松地看到他们可以继续前进并推动行动。 .. ^^

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T19:08:44.610

比简单更简单

```
打开
错误/变更分析
质量保证审查
关闭/拒绝
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T20:00:20.697

我认为唯一的两个必要项目是“打开”和“关闭”，其余的都是渐变。

我用：

*   打开
*   待办的
*   解决
*   等候接听
*   关闭

有时我会补充：

*   进行中
*   计费
*   测试中
*   审查
*   取消

这取决于团队的工作流程。

# c# - .NET 中 CIL 知识的优势

> ID：537986
> 
> 赞同：7
> 
> 时间：2009-02-11T17:57:07.573
> 
> 标签：c#, .net, cil

了解 CIL 有什么好处？

您必须了解汇编才能理解它吗？这些文件中的代码看起来很相似。

我如何进一步了解它？任何关于它的书，比如 Jon Skeet 的 C# 书？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T19:48:38.273

**了解 CIL 可以让您在某些边缘情况下更充分地利用 .NET 框架**。

请注意，您不必能够读取原始操作码即可从这些知识中受益。IL和程序集的通用知识，再加上[Mono.Cecil.dll](http://www.mono-project.com/Cecil)可以创造奇迹：

*   [如何使用 NotImplementedException 计算方法？](http://abdullin.com/journal/2009/1/9/how-to-count-methods-with-notimplementedexception.html)
*   [如何确保标有 ImmutableAttribute 的类确实是不可变的？](http://abdullin.com/journal/2008/10/14/writing-net-code-analysis-rules-as-unit-tests.html)
*   [如何找到针对对象的扩展方法？](http://abdullin.com/journal/2009/1/10/how-to-find-extension-methods-targeting-object.html)
*   [如何更改 .NET 程序集的命名空间？](http://abdullin.com/journal/2009/1/30/how-to-change-namespace-of-net-assembly.html)

PS：对我来说，获得一些实用的 IL 知识的最佳来源方法是阅读一些[宪兵](http://www.mono-project.com/Gendarme)规则的 C# 代码（它类似于 FxCop，使用 Mono.Cecil 进行代码自省）。此外，这篇文章是一个好的开始：[Parsing the IL of a Method Body](http://www.codeproject.com/KB/cs/sdilreader.aspx)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-11T18:11:01.643

我发现这些书在学习 IL 和 CLR 时很有用：

*   [在 IL 汇编器内部](https://rads.stackoverflow.com/amzn/click/com/1590596463), Serge Lidin

*   [为 .NET 公共语言运行时编译](https://rads.stackoverflow.com/amzn/click/com/0130622966)，John Gough

*   当然，您还需要[ECMA 规范](http://www.ecma-international.org/publications/standards/Ecma-335.htm)。

只是阅读它们会给你很多信息。

（我也听说[CLR via C#](https://rads.stackoverflow.com/amzn/click/com/0735621632)非常好，但我自己没有读过。）

当您遇到问题时，了解 IL 和 CLR 将为您提供帮助。（一个泄漏的抽象？）虽然，现在有了像 Reflector 这样的很好的反编译器，我发现自己使用 ildasm 的次数并不多。

不一定需要了解组装，但它会有所帮助。在大多数情况下，IL 实际上非常简单。

IL 派上用场的一个例子是确定 F# 究竟如何编译某些结构。另一个是能够使用 DynamicMethod 和 System.Reflection.Emit，这可以在某些情况下打开一些很好的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T20:00:34.470

CIL 比常规汇编程序 imo 简单得多。这在很大程度上是由于虚拟机是基于堆栈的，所以所有内容都进入堆栈并且没有要跟踪的寄存器。

也没有偏移计算，没有直接的内存操作，方法调用使用它们的 .NET 名称列出等等。我猜如果你对任何其他类型的汇编语言有一点经验，你可能会很快掌握 CIL 代码的要点。

就我个人而言，我发现能够启动 ILDasm 或 Reflector 以查看 C# 编译器实际为某些代码生成的 IL 非常有用。对于许多较新的功能，例如匿名委托/lambda、捕获的变量、迭代器等，检查 IL 可能非常有帮助。

其他人提到了好书，我将投票给Serge Lidin的**Expert .NET 2.0 IL 汇编程序。**它有所有血腥的细节。如果您想要更接近 C# Jeffrey Ricther**通过 C# 的 CLR**的东西，那就太好了。Jon Skeet 的书很棒，但它并没有真正涵盖 CIL。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T18:04:59.817

您不必了解汇编即可学习它 - 它与本机汇编完全分开。虽然在运行时，CLR 基本上会将其转为原生程序集。

几个可能的优点：

1）您可以查看编译器输出的 CIL，并具体查看您的代码在做什么

2）为了解决某些类型的问题，您可能在某些时候想要动态生成代码......例如，由于 Microsoft 的策略注入器框架还不够成熟，而且我们需要这种类型的行为，所以我们编写了一些低级的框架类型管道。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T18:03:59.650

您可能可以使用 CIL 做一些事情，但我想不出一个实际的例子。无论如何，这里有一个教程：

[http://weblogs.asp.net/kennykerr/archive/2004/09/07/introduction-to-msil-part-1-hello-world.aspx](http://weblogs.asp.net/kennykerr/archive/2004/09/07/introduction-to-msil-part-1-hello-world.aspx)

# xml - 如何使用 Nant 的 xmlpoke 目标来删除节点

> ID：537988
> 
> 赞同：15
> 
> 时间：2009-02-11T17:57:31.723
> 
> 标签：xml, nant, xmlpoke

给定以下xml：

```
<rootnode>
   <childnode arg="a">Content A</childnode>
   <childnode arg="b">Content A</childnode>
</rootnode> 
```

将[XMLPoke](http://nant.sourceforge.net/release/0.86-beta1/help/tasks/xmlpoke.html)与以下 XPath 一起使用：

```
rootnode/childnode[arg='b'] 
```

结果（如果替换字符串为空）是：

```
<rootnode>
   <childnode arg="a">Content A</childnode>
   <childnode arg="b"></childnode>
</rootnode> 
```

当我们真正想要删除子节点本身时，子节点的内容已被删除。期望的结果是：

```
<rootnode>
   <childnode arg="a">Content A</childnode>
</rootnode> 
```

必须根据 childnode 参数选择子节点。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-11T23:36:31.063

我举手！这是一个问错问题的经典案例。

问题是您不能使用*xmlpoke*删除单个节点。*Xmlpoke*只能用于编辑特定节点或属性的内容。根据仅使用标准*Nant*目标的问题，没有一种优雅的方法可以删除子节点。可以使用 Nant 中的属性使用一些不雅的字符串操作来完成，但是**为什么****要这样做**呢？

最好的方法是编写一个简单的 Nant 目标。这是我之前准备的一个：

```
using System;
using System.IO;
using System.Xml;
using NAnt.Core;
using NAnt.Core.Attributes;

namespace XmlStrip
{
    [TaskName("xmlstrip")]
    public class XmlStrip : Task
    {
        [TaskAttribute("xpath", Required = true), StringValidator(AllowEmpty = false)]
        public string XPath { get; set; }

        [TaskAttribute("file", Required = true)]
        public FileInfo XmlFile { get; set; }

        protected override void ExecuteTask()
        {
            string filename = XmlFile.FullName;
            Log(Level.Info, "Attempting to load XML document in file '{0}'.", filename );
            XmlDocument document = new XmlDocument();
            document.Load(filename);
            Log(Level.Info, "XML document in file '{0}' loaded successfully.", filename );

            XmlNode node = document.SelectSingleNode(XPath);
            if(null == node)
            {
                throw new BuildException(String.Format("Node not found by XPath '{0}'", XPath));
            }

            node.ParentNode.RemoveChild(node);

            Log(Level.Info, "Attempting to save XML document to '{0}'.", filename );
            document.Save(filename);
            Log(Level.Info, "XML document successfully saved to '{0}'.", filename );
        }
    }
} 
```

将上述内容与对*NAnt.exe.config文件的修改相结合，以在**构建*文件中加载自定义目标和以下脚本：

```
<xmlstrip xpath="//rootnode/childnode[@arg = 'b']" file="target.xml" /> 
```

这将从 target.xml 中删除带有*参数*arg*且*值为*b的**子节点*。这是我最初真正想要的！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-08-13T15:00:46.093

`xmlpeek`只读取值。 `xmlpoke`只设置值。不幸的是，nant 没有*xmldelete*任务。

我通过在一个 nant 文件中创建一个 nant 解决了这个问题，`<target />`我可以轻松地在项目之间重用。

我选择利用 nant的内置`<regex />`、`<echo />`和任务。`<include />``<call />`

### 好处：

*   适用于正则表达式（参见缺点）。
*   可以匹配任何文本，包括 XML！

### 缺点：

*   你曾经用正则表达式解决过问题吗？如果是，那么你现在有另一个问题！
*   **必须**转义nant 文件中的正则表达式值！（使用在线 xml 转义器工具）。

```
<!-- This file should be included before being called -->
<project name="YourProject">

    <target name="RemoveLineFromFile">

        <loadfile 
            file="${delete.from.file.path}" 
            property="xml.file.content" />
        <property 
            name="delete.from.file.regex" 
            value="(?'BEFORE'[\w\s\W]*)\&lt;add.*key=\&quot;AWSProfileName\&quot;.*value=\&quot;comsec\&quot;.*\/\&gt;(?'AFTER'[\w\s\W]*)" />
        <regex 
          input="${xml.file.content}" 
          pattern="${delete.from.file.regex}" />
        <echo 
          file="${delete.from.file.path}"
          message="${BEFORE}${AFTER}"
          append="false" />

    </target>

</project> 
```

下面是如何包含和调用这个目标。请记住，所有参数都是全局的，必须在调用目标*之前定义。*

*   `delete.from.file.path`：要修改的文件的路径。
*   `delete.from.file.regex`：匹配要删除的内容的正则表达式（并定义 BEFORE 和 AFTER 组）。

```
<project name="YourProject">

    <include buildfile="path\to\nant\target\RemoveLineFromFile.build"/>

    <target name="OtherWork">

        <property name="delete.from.file.path" value="path\to\xml\file.xml" />
        <property name="delete.from.file.regex" value="(?&apos;BEFORE&apos;[\w\s\W]*)\&lt;childnode.*arg=&quot;b&quot;&gt;(.*?)\&lt;\/childnode\&gt;(?&apos;AFTER&apos;[\w\s\W]*)" />
        <call target="RemoveLineFromFile" />

    </target>

</project> 
```

# hash - 使用 2 个不同的哈希函数是检查文件完整性的好方法吗？

> ID：537989
> 
> 赞同：5
> 
> 时间：2009-02-11T17:58:00.817
> 
> 标签：hash, cryptography, verification

我有一个网站，用户可以上传他们的文件；这些存储在服务器上，它们的元数据记录在数据库中。我正在实施一些简单的完整性检查，即“这个文件的内容现在是否与上传时的字节内容相同？”

一个例子：对于 的内容`userfile.jpg`，MD5 哈希是`39f9031a154dc7ba105eb4f76f1a0fd4`SHA-1 哈希是`878d8d667721e356bf6646bd2ec21fff50cdd4a9`。**如果这个文件的内容发生了变化，但前后的 MD5 哈希值相同，那么 SHA-1 哈希值是否也可能保持不变？**（使用散列，有时您可能会遇到散列冲突 - 这会同时使用两种不同的散列算法吗？）

或者是为一个文件计算两个不同的哈希值（我应该尝试一些其他机制来验证完整性）？

* * *

编辑：我并不真正担心意外损坏，但我应该防止用户更改文件而不引起注意（[生日攻击](http://en.wikipedia.org/wiki/Birthday_attack)和朋友）。

我可能会选择一个哈希，SHA-512——检查不会经常成为性能瓶颈，无论如何，“正如 Bruce Schneier 所说，已经有足够快、不安全的系统了。-@MichaelGG 在评论”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T18:01:24.227

MD5 对于您正在做的事情可能是安全的，但没有理由继续使用具有已知缺陷的散列。事实上，你没有理由不使用 SHA256 或 SHA512，除非你有一些已知的主要性能瓶颈。

编辑：澄清一下，没有理由使用两种算法；只需使用适合您需要的一种。如果您担心有人对您进行 MD5 冲突（例如，这是一种安全威胁吗？），那么请使用不那么弱的算法，例如 SHA256。

编辑 2：为了解决一个显然仍然很常见的误解：在哈希上发现随机冲突不是 1/2^n 的概率。它更接近 1/2^(n/2)。因此 128 位哈希可能会与 2^64 次尝试发生冲突。有关详细信息，请参阅[生日攻击](http://en.wikipedia.org/wiki/Birthday_attack)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T17:59:49.613

在大多数情况下，单独检查 MD5 哈希就足够了。尽管如果必须的话，另外检查 SHA1 也没有什么坏处。请记住，仅通过 MD5 检查来捕获您会错过的东西的可能性非常小。

请注意，就可伸缩性而言，额外的检查会在您的服务器上增加不必要的负载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T18:15:36.313

对于文件完整性（例如意外/随机损坏），一个哈希就足够了。128 位 = 2 ^(-128)未检测到错误的概率，这对于所有实际目的来说都足够小。

对于文件加密完整性（例如，确保有人没有恶意替换备用文件），我认为您正在谈论一种带吊带的方法。

MD5 被认为是“弱”的，因为它可以构造具有相同哈希的两个文档，所需的 CPU 时间比暴力搜索所需的 CPU 时间少得多（MD5 的“抗碰撞性”已被破坏）。

但它不是（据我所知）“弱”，如果你有一个任意文档 X，其他人可以创建一个具有相同哈希的文档 Y，比蛮力搜索（MD5仍然具有“原像抗性”）。（区别就像去参加聚会并找到两个生日相同的人与找到另一个与你生日相同的人之间的区别。）

即使 MD5 在这方面被破坏，也不太可能有人能够提出一种算法来创建文档以匹配任意 MD5 散列**和**任意 SHA1 散列。

这听起来有点像“不要把所有的鸡蛋放在一个篮子里”与“把所有的鸡蛋放在一个篮子里，看着篮子”这两条格言之间的张力。或者就像花钱买两个锁舌锁和一个锁舌锁，后者好一倍，成本也高一倍。理想情况下，最好花 CPU 时间计算*一个*安全的 256 位哈希，而不是使用不同算法的*两个*不太安全的 128 位哈希。（是的，我知道 SHA1 是 160 位，这只是一个说明）您更有可能通过这种方式获得更好的性能以获得所需的安全级别——也就是说，**如果**256 位哈希没有被破坏。如果它被打破，你可能会更好地使用两种算法方法来对冲你的赌注。

但是，如果这只是防止错误的完整性，那么一个 MD5 哈希就可以了。

编辑：引用一些有用的资源： [1](http://www.vpnc.org/hash.html) [2](http://www.cryptography.com/cnews/hash.html) [3](http://www.unixwiz.net/techtips/iguide-crypto-hashes.html)，[“MD5 认为今天有害”](http://www.win.tue.nl/hashclash/rogue-ca/)，[RFC4270](https://www.rfc-editor.org/rfc/rfc4270)，[NIST 对 SHA-3 竞赛的最新更新](http://csrc.nist.gov/groups/ST/hash/sha-3/Round1/submissions_rnd1.html)，以及[“SHA-3 动物园”](http://ehash.iaik.tugraz.at/wiki/The_SHA-3_Zoo)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T18:01:59.373

一般来说，如果 MD5 散列不匹配，则 SHA1（或任何其他类似的散列）也不会匹配。我不会说不可能发生这种情况（因为我们都知道两种算法都存在冲突），但我会说在你的情况下它可能永远不会发生。

我的想法是提供一个哈希可能就足够了。~~多个哈希变得难以验证（必须验证一个是否足够糟糕，具体取决于平台的可用实用程序）~~，而且我严重怀疑您是否会看到文件如此惊人的损坏以导致完美冲突。

**注意：**忽略验证是痛苦的东西；重新阅读问题后，我对此进行了修改-我将原始含义视为用户下载文件的哈希验证。如果，当然，这*就是*意思，那么我说的仍然适用，我想。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T18:07:05.383

粗略估计，MD5 误报的几率是 1/(2^128)，SHA-1 误报的几率是 1/(2^160)，因此两种算法的误报几率都在 1 之间/(2^128) 和 1/(2^288)，但您可以确定它接近 1/(2^288)，因为这两种算法都经过了全面的统计测试。

至少，当使用两种不同的哈希值时，可以很好地保护您免受其中一种算法的故意攻击。

编辑：经过一些研究，我偶然发现了这个[Wikipedia 注意](http://en.wikipedia.org/wiki/MD5#cite_note-8)，MD5 生日攻击可以在 1 分钟内完成，所以在这里使用不同的算法作为 MD5 和 SHA-1 似乎更好。SHA-1 的生日攻击目前需要[2^69 次操作](http://en.wikipedia.org/wiki/Sha-1#SHA-1)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T18:08:23.867

因为这两个散列的计算方式不同，所以具有相同 MD5 散列的两个文件与两个随机文件相比，具有相同 SHA-1 散列的可能性不大。如果您与任一散列发生随机冲突的机会是 (ballpark) 2^128，那么您在两者中发生随机冲突的机会将是 2^256。

实际上，你从极低到极、极低。

这相当于从 128 位加密到 256 位加密，以避免有人随机猜测您的 128 位密钥。

# sharepoint - 我的应用程序通过 Web 客户端/WebDAV（WebDAV 重定向器）在 SharePoint 中编辑文件。我怎样才能退房/入住？

> ID：537990
> 
> 赞同：4
> 
> 时间：2009-02-11T17:58:02.533
> 
> 标签：sharepoint, webclient

我正在集成我的应用程序，以便它可以编辑存储在 SharePoint 中的文件。我正在使用 Web 客户端服务 AKA WebDAV Redirector(webclnt.dll)，它可以很好地将正常的 CreateFile/读/写 Windows api 调用从其正常的驱动器 I/O 路径通过 WebDAV 重定向到网络。但是，如果文件已签入，我只能获得对该文件的只读访问权限。

使用 Web 客户端服务，如何在编辑文件时将其签出，然后在完成编辑时将其签入？

编辑：我尝试使用 GetFileAttributes 和 SetFileAttributes 来测试 FILE_ATTRIBUTE_READONLY，希望我可以使用该标志来确定文件何时未被签出，然后将其签出（通过取消设置该标志以签出，然后将其设置为检查它）。那里没有运气；该文件始终显示为非只读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T03:23:48.130

要执行签入/签出文件，您需要使用以下代码：

```
SPSite oSite = new SPSite ("http://<sitename>/");
SPWeb oWeb = oSite.OpenWeb(); 
SPList oList = oWeb.Lists["Shared Documents"];
SPListItem oListItem = oList.Items[0]; //taking the first list item
oListItem.File.CheckOut();
oListItem["Name"] = "xyz";           
oListItem.Update();
oListItem.File.CheckIn("file name has been changed"); 
```

如果您需要通过 SharePoint WebService 进行签入/签出，那么您应该查看 Brad McCable 的[Windows Sharepoint Services Web Service Example](http://blogs.msdn.com/brad_mccabe/archive/2005/03/01/382432.aspx)博客上的代码。

# c# - 以编程方式在 IIS 中注册 Silverlight MIME 类型

> ID：537998
> 
> 赞同：1
> 
> 时间：2009-02-11T17:59:08.240
> 
> 标签：c#, silverlight, mime

我正在为 silverlight 应用程序创建安装程序，并希望能够自动为 IIS 注册 .xap 扩展名。有没有办法在不编辑注册表的情况下完成此操作？如果没有，我需要制作哪些注册表项？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T18:23:08.323

1.  开始->运行 inetmgr（启动 IIS 管理控制台）
2.  单击 MIME 类型
3.  单击添加..xap application/x-silverlight-app
4.  按确定

或者您可以将此代码保存到文本文件并在服务器上执行：

**添加MimeType.vbs**

```
Dim VPath
'This changes setting at machine level, you may change it to a different path
VPath = "IIS://localhost/MimeMap"

'Add/Update the type for DLR language extension
UpdateMime ".xap", "application/x-silverlight-app"

'Search for the given extension and update its type
'when not found, add it into the collection
Sub UpdateMime(Extension, NewType)
    Dim LocalMimeMap, MimeMap, MMItem, aMimeMapNew()
    Dim i 
    i = 0
    Const ADS_PROPERTY_CLEAR = 1
    Const ADS_PROPERTY_UPDATE = 2
    Set LocalMimeMap = GetObject(VPath)
    MimeMap = LocalMimeMap.GetEx("MimeMap")
    Dim found
    found = False
    For Each MMItem In MimeMap
      ReDim Preserve aMimeMapNew(i)
      Set aMimeMapNew(i) = CreateObject("MimeMap")
      aMimeMapNew(i).Extension = MMItem.Extension
      If MMItem.Extension = Extension Then
          found = True
          MsgBox("Update type of extension " + MMItem.Extension + " from " +     MMItem.MimeType + " to " + NewType)
          aMimeMapNew(i).MimeType = NewType
      Else
          aMimeMapNew(i).MimeType = MMItem.MimeType
      End If
      i = i + 1
    Next
    If found Then
        LocalMimeMap.PutEx ADS_PROPERTY_UPDATE, "MimeMap", aMimeMapNew
        LocalMimeMap.SetInfo
    Else
        MsgBox("Add new extension " + Extension + " with type " + NewType)
        AddMime Extension, NewType
    End If
End Sub

Sub AddMime(ExtensionToAdd, MimeTypeToAdd)
    Dim LocalMimeMap, MimeMap
    Dim i
    Const ADS_PROPERTY_UPDATE = 2
    Set LocalMimeMap = GetObject(VPath)
    MimeMap = LocalMimeMap.GetEx("MimeMap")
    i = UBound(MimeMap)+1
    Redim Preserve MimeMap(i) 
    Set MimeMap(i) = CreateObject("MimeMap") 
    MimeMap(i).Extension = ExtensionToAdd
    MimeMap(i).MimeType = MimeTypeToAdd
    LocalMimeMap.PutEx ADS_PROPERTY_UPDATE,"MimeMap",MimeMap 
    LocalMimeMap.SetInfo
End Sub 
```******