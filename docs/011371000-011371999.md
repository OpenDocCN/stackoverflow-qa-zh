# StackOverflow 问答 11371000-11371999

# yii - Yii::app()->getModule('user') 没有返回正确的值 view/layout/main.php

> ID：11371004
> 
> 赞同：0
> 
> 时间：2012-07-06T23:45:13.627
> 
> 标签：yii, yii-components, yii-extensions

Yii::app()->getModule('user') 在 vi​​ew/layouts/main.php 中没有返回正确的值

我正在使用 Yii-User [YII-User](http://code.google.com/p/yii-user/loginUrl,) Extension 来管理用户相关的功能。当我 Yii::app()->getModule('user')->loginUrl,

我明白了

> 试图获取非对象的属性

在

> array('url'=>Yii::app()->getModule('user')->loginUrl, 'label'=>Yii::app()->getModule('user')->t("登录"), '可见'=>Yii::app()->user->isGuest),

请告诉我出了什么问题，是已知问题还是类似问题。

这是 config/main.php

```
// autoloading model and component classes
'import'=>array(
        'application.models.*',
        'application.components.*',
        'application.modules.user.models.*',
        'application.modules.user.components.*',

),
   'modules' => array(

         'user'=>array(

                # enable debuging 
                'debug' => true,

                # encrypting method (php hash function)
                'hash' => 'md5',

                # send activation email
                'sendActivationMail' => true,

                # allow access for non-activated users
                'loginNotActiv' => false,

                # activate user on registration (only sendActivationMail = false)
                'activeAfterRegister' => false,

                # automatically login from registration
                'autoLogin' => true,

                # registration path
                'registrationUrl' => array('/user/registration'),

                # recovery password path
                'recoveryUrl' => array('/user/recovery'),

                # login form path
                'loginUrl' => array('/user/login'),

                # page after login
                'returnUrl' => array('/user/profile'),

                # page after logout
                'returnLogoutUrl' => array('/user/login'),

                # Adding Table refrences 
                'tableUsers' => 'tbl_users',
                'tableProfiles' => 'tbl_profiles',
                'tableProfileFields' => 'tbl_profiles_fields',
                ),
        ), 
```

# python - IPython中带有多个参数的并行映射函数

> ID：11371009
> 
> 赞同：36
> 
> 时间：2012-07-06T23:46:01.093
> 
> 标签：python, parallel-processing, ipython

我正在尝试使用 IPython 的并行环境，到目前为止，它看起来很棒，但我遇到了问题。假设我有一个函数，在库中定义

```
def func(a,b):
   ... 
```

当我想评估 a 的一个值和 b 的一堆值时，我会使用它。

```
[func(myA, b) for b in myLongList] 
```

显然，真正的函数更复杂，但问题的本质是它需要多个参数，我只想映射其中一个。问题是 map、@dview.parallel 等映射所有参数。

所以假设我想得到 func(myA, myLongList) 的答案。这样做的明显方法是使用 functools.partial 或就像

```
dview.map_sync(lambda b: func(myA, b),   myLongList) 
```

但是，这在远程计算机上无法正常工作。原因是当 lambda 表达式被腌制时，不包括 myA 的值，而是使用远程机器上本地范围的 myA 的值。当闭包被腌制时，它们关闭的变量不会。

我能想到的两种实际可行的方法是为每个参数手动构造列表，并对所有参数进行映射，

```
dview.map_sync(func, [myA]*len(myLongList), myLongList) 
```

或者可怕地使用数据作为函数的默认参数，迫使它被腌制：

```
# Can't use a lambda here b/c lambdas don't use default arguments :(
def parallelFunc(b, myA = myA):
    return func(myA, b)

dview.map_sync(parallelFunc, myLongList) 
```

真的，当真正的函数需要很多参数并且更复杂时，这一切似乎都被扭曲了。有一些惯用的方法吗？就像是

```
@parallel(mapOver='b')
def  bigLongFn(a, b):
   ... 
```

但据我所知，不存在像“mapOver”这样的东西。我可能对如何实现它有一个想法......这只是一个非常基本的操作，应该存在支持，所以我想检查我是否遗漏了一些东西。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-07-24T23:45:25.123

我可以对 batu 的答案进行一些改进（我认为这是一个很好的答案，但可能没有详细记录你为什么使用这些选项）。ipython 文档目前在这一点上也严重不足。所以你的功能是这样的：

```
def myfxn(a,b,c,d):
  ....
  return z 
```

并存储在名为*mylib*的文件中。假设 b、c 和 d 在您的运行过程中是相同的，因此您编写了一个 lambda 函数以将其简化为 1 参数函数。

```
import mylib
mylamfxn=lambda a:mylib.myfxn(a,b,c,d) 
```

你想运行：

```
z=dview.map_sync(mylamfxn, iterable_of_a) 
```

在梦境中，一切都会如此神奇地运作。但是，首先您会收到“未找到 mylib”的错误，因为 ipcluster 进程尚未加载 mylib。如有必要，请确保 ipcluster 进程在其 python 路径中具有“mylib”并且位于 myfxn 的正确工作目录中。然后你需要添加到你的python代码：

```
dview.execute('import mylib') 
```

`import mylib`它在每个进程上运行命令。如果你再试一次，你会得到一个“全局变量 b 未定义”的错误，因为当变量在你的 python 会话中时，它们不在 ipcluster 进程中。但是，python 提供了一种将一组变量复制到子进程的方法。继续上面的例子：

```
mydict=dict(b=b, c=c, d=d)
dview.push(mydict) 
```

现在所有子进程都可以访问 b、c 和 d。然后你可以运行：

```
z=dview.map_sync(mylamfxn, iterable_of_a) 
```

它现在应该像宣传的那样工作。无论如何，我是使用 python 进行并行计算的新手，发现这个线程很有用，所以我想我会尝试帮助解释一些让我有点困惑的点......

最终代码将是：

```
import mylib

#set up parallel processes, start ipcluster from command line prior!
from IPython.parallel import Client
rc=Client()
dview=rc[:]

#...do stuff to get iterable_of_a and b,c,d....

mylamfxn=lambda a:mylib.myfxn(a,b,c,d)

dview.execute('import mylib')
mydict=dict(b=b, c=c, d=d)
dview.push(mydict)
z=dview.map_sync(mylamfxn, iterable_of_a) 
```

这可能是让几乎所有令人尴尬的并行代码在 python 中并行运行的最快和最简单的方法......

**更新**您还可以使用 dview 推送所有数据而无需循环，然后使用 lview （即`lview=rc.load_balanced_view(); lview.map(...)`以负载平衡方式进行实际计算。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-09T19:47:36.733

这是我给 StackOverflow 的第一条消息，所以请保持温和；）我试图做同样的事情，并想出了以下内容。我很确定这不是最有效的方法，但似乎有点工作。~~现在需要注意的一个问题是，出于某种原因，我只看到两台发动机以 100% 的速度工作，其他的几乎处于闲置状态......~~

为了在 map 中调用多 arg 函数，我首先在我的个人 parallel.py 模块中编写了这个例程：

```
def map(r,func, args=None, modules=None):
"""
Before you run parallel.map, start your cluster (e.g. ipcluster start -n 4)

map(r,func, args=None, modules=None):
args=dict(arg0=arg0,...)
modules='numpy, scipy'    

examples:
func= lambda x: numpy.random.rand()**2.
z=parallel.map(r_[0:1000], func, modules='numpy, numpy.random')
plot(z)

A=ones((1000,1000));
l=range(0,1000)
func=lambda x : A[x,l]**2.
z=parallel.map(r_[0:1000], func, dict(A=A, l=l))
z=array(z)

"""
from IPython.parallel import Client
mec = Client()
mec.clear()
lview=mec.load_balanced_view()
for k in mec.ids:
  mec[k].activate()
  if args is not None:
    mec[k].push(args)
  if modules is not None:
    mec[k].execute('import '+modules)
z=lview.map(func, r)
out=z.get()
return out 
```

如您所见，该函数采用 args 参数，该参数是头节点工作区中的参数字典。然后将这些参数推送到引擎。那时它们成为本地对象，可以直接在函数中使用。例如，在上面注释中给出的最后一个示例中，使用 l 引擎局部变量对 A 矩阵进行切片。

我必须说，即使上述功能有效，我目前也不是 100% 满意。如果我能想出更好的东西，我会在这里发布。

更新：2013/04/11 我对代码做了一些小改动： - 激活语句缺少括号。导致它无法运行。- 将 mec.clear() 移到函数的顶部，而不是末尾。我还注意到如果我在 ipython 中运行它效果最好。例如，如果我使用上述函数作为“python ./myparallelrun.py”运行脚本，但如果我在 ipython 中使用“%run ./myparallelrun.py”运行它，则可能会出错。不知道为什么...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T19:21:16.397

一种优雅的方法是使用偏函数。

如果你知道你希望 foo 的第一个参数是 myArg，你可以创建一个新的函数 bar

```
from functools import partial
bar = partial(foo, myARg) 
```

`bar(otherArg)`然后将返回`foo(myArg,otherArg)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T04:33:53.777

让我们以此为基础：

```
dview.map_sync(func, [myA]*len(myLongList), myLongList) 
```

也许以下会起作用：

```
from itertools import izip_longest
dview.map_sync(func, izip_longest(myLongList, [], fillvalue=myA)) 
```

例子：

```
>>> # notice that a is a tuple
... concat = lambda a: '%s %s' % a
>>> mylonglist = range(10)
>>> from itertools import izip_longest
>>> map(concat, izip_longest(mylonglist, [], fillvalue='mississippi'))
['0 mississippi', '1 mississippi', '2 mississippi', '3 mississippi',
'4 mississippi', '5 mississippi', '6 mississippi', '7 mississippi',
'8 mississippi', '9 mississippi'] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-11T18:58:28.413

我正在发布 Alex S. 评论作为答案。这可能是解决这个问题的正确方法：

只需使用 lambda 进行部分应用。我知道这看起来很奇怪，但是使用 my_f = lambda a,my=other,arguments=go,right=here ： f(a,my,arguments,right) 是最简单的方法，不会陷入酸洗和推挤问题.

# entity-framework - 收听 EDMX 转换？

> ID：11371010
> 
> 赞同：4
> 
> 时间：2012-07-06T23:46:08.550
> 
> 标签：entity-framework, visual-studio-2012, .net-4.5

在 VS2012 中将项目从 .NET 4.0 重新定位到 .NET 4.5 时，项目中的任何 EDMX 都会自动转换为 EF 5，即更新命名空间以匹配目标框架。

有没有办法，也许通过扩展 EDM 工具，来“监听”这种转换？我们在 EDMX 中使用自定义注解，升级时也需要转换/更新我们的注解。

我们目前实现了 IModelTransformExtension 来在模型加载和保存时执行自定义逻辑，理论上我们也可以使用 OnAfterModelLoaded 来进行注解的转换，但是由于只需要一次转换，并且总是特别在 .NET框架被重新定位，如果有另一种选择，那就太好了。

有任何想法吗？

# java - 在 Spring 框架内的 ehcache.xml 文件中外部化 terracottaconfig 属性

> ID：11371017
> 
> 赞同：2
> 
> 时间：2012-07-06T23:47:00.673
> 
> 标签：java, spring, ehcache, terracotta

Spring Web 应用程序内的 ehcache.xml 文件中有此标记`<terracottaConfig url="host1:9510,host2:9510,host3:9510"/>`。我想将此标签的 url 属性外部化。URL 的值应替换为来自外部文件的属性。如果您对此问题提出任何解决方案，这将非常有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T03:30:47.787

你可以放这样的东西—— `<terracottaConfig url="${terracotta.config.location}" />`但最大的问题是它只能[从系统属性](http://forums.terracotta.org/forums/posts/list/5141.page)中加载。它不是从 PropertyPlaceHolder 解析的，因为它不是 Spring 配置文件。

因此，如果您想使用外部配置文件，您基本上必须在 Spring 应用程序开始加载 ehcache.xml 文件之前以编程方式设置此系统属性 - 一种方法是编写您的自定义[ServletContextListener](http://docs.oracle.com/javaee/6/api/index.html?javax/servlet/ServletContextListener.html)来加载您的属性文件并在此基础上设置系统属性，这样当加载 ehcache.xml 时，它将能够正确解析占位符。

* * *

您的回答帮助我解决了我的问题。我只想添加，而不是通过程序设置系统属性，我使用 util:properties 如下

```
<bean id="sysProperties" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
       <property name="targetObject" value="#{@systemProperties}"/>
       <property name="targetMethod" value="putAll"/>
       <property name="arguments">
           <util:properties>
               <prop key="propertyname_used_in_ecache_xml">#{proerties_defined_using_property_factory['propertyname_defined_in_external_properties_file']}</prop>
           </util:properties>
       </property>
    </bean>

    <bean id="cacheManager"
        class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean" depends-on="sysProperties">
        <property name="configLocation">
            <value>classpath:ehcache.xml</value>
        </property>
    </bean> 
```

# r-tree - 如何在 C# 中批量加载 r-tree？

> ID：11371018
> 
> 赞同：0
> 
> 时间：2012-07-06T23:47:04.870
> 
> 标签：r-tree

我正在寻找 C# 代码来构建一个 r-tree。我有增量构建 r-tree 的代码，即项目被一个接一个地添加到树中，但我想如果所有项目一次全部提供给树创建算法，则可以构建更好的 r-tree。如果有人知道如何以这种方式批量加载 r-tree，请告诉我。我尝试进行一些搜索，但找不到任何非常有用的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T19:33:59.593

Achakeev 等人的一篇论文，**基于排序的 R-trees 并行加载**可能会有所帮助。您还可以在他们的参考资料中找到其他方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T08:39:25.030

低维点数据最常用的方法是排序切片递归（STR）。它正是这样做的：对数据进行排序，将其平铺到最佳数量的切片中，然后在必要时进行递归。

带有点数据的 STR 加载树的叶级不会有重叠，所以非常好。更高级别可能有重叠，因为 STR 不考虑对象的扩展。

经过验证的良好批量加载也是 Priority-R-Tree 的关键组成部分。

即使不是批量加载，*插入策略*也会产生很大的不同。使用 Guttmans 或 Ang-Tan 等线性拆分构建的 R-Tree 通常比使用 R*-Tree 拆分启发式构建的 R-Tree 更差。特别是 Ang-Tan 倾向于产生“切片”页面，它们的空间扩展非常不平衡。这是一种快速拆分策略，可能是最简单的，但结果并不好。

# c++ - 在 QWidget 的子类中调用 width()、height()、size() 或 rect() 以 segfault 结尾

> ID：11371020
> 
> 赞同：2
> 
> 时间：2012-07-06T23:47:10.540
> 
> 标签：c++, qt, size, segmentation-fault, qwidget

我对`QWidget`'s `width()`、`height()`或函数有`size()`疑问；`rect()`当它被调用时，它会出现段错误。它是 Qt 4.7。

这是有问题的类的标题：

```
class PlotCanvas : public QWidget
{ 
    void paintEvent(QPaintEvent * e);
    uint64_t smallestDiv();
    uint64_t longestLength();
    void drawGrid(QPainter * painter);
    QVector<Plot*> plots;
    int calculateHeight() const;
    int calculateWidth() const;
    uint32_t cursorPosition;
public:
    PlotCanvas(QWidget * parent = 0) : QWidget(parent) 
    {
        setStyleSheet("background-color: black");
        setAutoFillBackground(true);
        setSizePolicy(QSizePolicy::MinimumExpanding, QSizePolicy::MinimumExpanding);
        setFocusPolicy(Qt::StrongFocus);
        update();
    }
    void addPlot(Plot * plot);
    int getDivCount();
}; 
```

和实际的段错误代码：

```
int PlotCanvas::getDivCount()
{
   QRect bounds = rect(); //segfaults
   qDebug() << bounds.size().width();
   qDebug() << bounds.size().height();
   return 10;
} 
```

追溯到Qt的`qrect.h`：

```
inline int QRect::width() const
{ return  x2 - x1 + 1; } //this line finally kills it 
```

似乎里面有些东西没有正确初始化`QWidget`，但我不知道是什么，因为正如你所看到的，我并没有真正改变`QWidget`那么多的初始化。

`PlotCanvas`小部件位于`QAbstractScrollArea`( 尚未实现的子类中，因此它很简单`QAbstractScrollArea`：

```
class PlotCanvasScrollArea : public QAbstractScrollArea
{
public:
    PlotCanvasScrollArea(QWidget * parent = 0) : QAbstractScrollArea(parent) 
    {

    }
}; 
```

我只需要确定`QWidget`绘画区域的大小，因为我在转换图中进行绘图，并且我需要知道有多少时间分割适合当前的小部件大小，因为显然应用程序窗口是可调整大小的。

编辑：

代码在哪里`PlotCanvas`构造：

```
Board(QString & name) : name(name)
{
    hbox = new QHBoxLayout();
    commonKnobGroup = new QGroupBox("Common settings:");
    commonKnobGroup->setMinimumWidth(190);
    commonKnobGroup->setSizePolicy(QSizePolicy(QSizePolicy::Minimum, QSizePolicy::Minimum));
    commonKnobs = new CommonKnobs(commonKnobGroup);
    hsplitter = new QSplitter();
    plotGroupBox = new QGroupBox("Measurement plots:", hsplitter);
    settingsGroupBox = new QGroupBox("Plot settings:", hsplitter);
    plotSplitter = new QSplitter();
    plotHbox = new QHBoxLayout();
    plotHbox->addWidget(plotSplitter);
    plotGroupBox->setLayout(plotHbox);
    settingsVLayout = new QVBoxLayout();
    plotNamesColumn = new QListWidget(plotSplitter);
    scrollArea = new PlotCanvasScrollArea(plotSplitter);
    //scrollArea->setWidgetResizable(true);
    plotsCanvas = new PlotCanvas();
    scrollArea->setViewport(plotsCanvas);
    scrollArea->setBackgroundRole(QPalette::Dark);
    specializedKnobGroup = new QGroupBox("Probe settings:");
    plotSettings = new QStackedWidget(specializedKnobGroup);
    settingsVLayout->addWidget(commonKnobGroup);
    settingsVLayout->addWidget(specializedKnobGroup);
    settingsGroupBox->setLayout(settingsVLayout);
    hbox->addWidget(hsplitter);
    setLayout(hbox);
    connect(plotNamesColumn, SIGNAL(currentItemChanged(QListWidgetItem *, QListWidgetItem *)), this,
            SLOT(changePageNames(QListWidgetItem*, QListWidgetItem*)));
    connect(commonKnobs, SIGNAL(scaleUpdated()), plotsCanvas, SLOT(update()));

}; 
```

EDIT2：
完整的堆栈跟踪：

```
#0  0x000000010000b9ac in QWidget::rect() const at /Volumes/Data/shinji/QtSDK/Desktop/Qt/474/gcc/include/QtGui/qwidget.h:1007
#1  0x000000010000b454 in PlotCanvas::getDivCount() ()
#2  0x000000010000ab39 in Board::getDivCount() ()
#3  0x0000000100009fbc in CommonKnobs::updateScaleByBeginEnd() ()
#4  0x00000001000015b4 in CommonKnobs::qt_metacall(QMetaObject::Call, int, void**) ()
#5  0x0000000100d09b66 in QMetaObject::activate(QObject*, QMetaObject const*, int, void**) ()
#6  0x000000010070df9d in QSpinBox::valueChanged(int) ()
#7  0x00000001004d9684 in QSpinBoxPrivate::emitSignals(EmitPolicy, QVariant const&) ()
#8  0x000000010043b321 in QAbstractSpinBoxPrivate::setValue(QVariant const&, EmitPolicy, bool) ()
#9  0x000000010043c11a in QAbstractSpinBoxPrivate::_q_editorTextChanged(QString const&) ()
#10 0x000000010043cca7 in QAbstractSpinBox::qt_metacall(QMetaObject::Call, int, void**) ()
#11 0x000000010070e435 in QSpinBox::qt_metacall(QMetaObject::Call, int, void**) ()
#12 0x0000000100d09b66 in QMetaObject::activate(QObject*, QMetaObject const*, int, void**) ()
#13 0x000000010048a1e6 in QLineEdit::textChanged(QString const&) ()
#14 0x000000010048d23a in QLineEdit::qt_metacall(QMetaObject::Call, int, void**) ()
#15 0x0000000100d09b66 in QMetaObject::activate(QObject*, QMetaObject const*, int, void**) ()
#16 0x000000010070c9f9 in QLineControl::textChanged(QString const&) ()
#17 0x0000000100494337 in QLineControl::finishChange(int, bool, bool) ()
#18 0x0000000100496664 in QLineControl::processKeyEvent(QKeyEvent*) ()
#19 0x000000010048b8eb in QLineEdit::keyPressEvent(QKeyEvent*) ()
#20 0x00000001001056bd in QWidget::event(QEvent*) ()
#21 0x000000010048c18b in QLineEdit::event(QEvent*) ()
#22 0x000000010043d9f0 in QAbstractSpinBox::keyPressEvent(QKeyEvent*) ()
#23 0x00000001001056bd in QWidget::event(QEvent*) ()
#24 0x000000010043bb1b in QAbstractSpinBox::event(QEvent*) ()
#25 0x00000001004d7be5 in QSpinBox::event(QEvent*) ()
#26 0x00000001000a9e8d in QApplicationPrivate::notify_helper(QObject*, QEvent*) ()
#27 0x00000001000b198b in QApplication::notify(QObject*, QEvent*) ()
#28 0x0000000100d0321c in QCoreApplication::notifyInternal(QObject*, QEvent*) ()
#29 0x00000001000a9f2c in qt_sendSpontaneousEvent(QObject*, QEvent*) ()
#30 0x0000000100125cc1 in QKeyMapper::sendKeyEvent(QWidget*, bool, QEvent::Type, int, QFlags<Qt::KeyboardModifier>, QString const&, bool, int, unsigned int, unsigned int, unsigned int, bool*) ()
#31 0x0000000100126b43 in QKeyMapperPrivate::translateKeyEvent(QWidget*, OpaqueEventHandlerCallRef*, OpaqueEventRef*, void*, bool) ()
#32 0x000000010006072e in qt_dispatchKeyEvent(void*, QWidget*) ()
#33 0x000000010005478b in -[QCocoaView keyDown:] ()
#34 0x00007fff815a90c7 in -[NSWindow sendEvent:] ()
#35 0x0000000100059891 in -[QCocoaWindow sendEvent:] ()
#36 0x00007fff814ddafa in -[NSApplication sendEvent:] ()
#37 0x000000010005cf0a in -[QNSApplication sendEvent:] ()
#38 0x00007fff814746de in -[NSApplication run] ()
#39 0x0000000100066c04 in QEventDispatcherMac::processEvents(QFlags<QEventLoop::ProcessEventsFlag>) ()
#40 0x0000000100def774 in QEventLoop::processEvents(QFlags<QEventLoop::ProcessEventsFlag>) ()
#41 0x0000000100defa94 in QEventLoop::exec(QFlags<QEventLoop::ProcessEventsFlag>) ()
#42 0x0000000100df10bc in QCoreApplication::exec() ()
#43 0x0000000100001cf6 in main () 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T00:20:37.807

查看崩溃堆栈跟踪 - 它是否会导致某个地方的构造函数？我的第一个想法是，我不确定您是否应该在构造函数中调用 update ——我可能偏离了基础，但这对我来说似乎是错误的。如果 update 应该在 QWidget 构造函数中调用，那么基本构造函数将调用它（使您的调用变得多余），如果不应该，那么我根本不清楚会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:46:12.477

您的 scrollArea 是作为 plotSplitter 的子级创建的，但它永远不会使用 addWidget() 添加到拆分器中，此外 plotSplitter 没有父级，这意味着它将是自己的窗口。我想问题可能出在您将scrollArea的视口设置为plotsCanvas时，这是另一个没有父级的QWidget，因此也没有自己的窗口。

尝试这样的事情并从那里开始工作：

```
Board(QString & name) : name(name)
{
    hbox = new QHBoxLayout();
    commonKnobGroup = new QGroupBox("Common settings:");
    commonKnobGroup->setMinimumWidth(190);
    commonKnobGroup->setSizePolicy(QSizePolicy(QSizePolicy::Minimum, QSizePolicy::Minimum));
    commonKnobs = new CommonKnobs(commonKnobGroup);
    hsplitter = new QSplitter();
    plotGroupBox = new QGroupBox("Measurement plots:", hsplitter);
    settingsGroupBox = new QGroupBox("Plot settings:", hsplitter);
    plotSplitter = new QSplitter(this);
    plotHbox = new QHBoxLayout();
    plotHbox->addWidget(plotSplitter);
    plotGroupBox->setLayout(plotHbox);
    settingsVLayout = new QVBoxLayout();
    plotNamesColumn = new QListWidget(plotSplitter);
    scrollArea = new PlotCanvasScrollArea(plotSplitter);
    plotSplitter->addWidget(plotNamesColumn);
    plotSplitter->addWidget(scrollArea);
    //scrollArea->setWidgetResizable(true);
    plotsCanvas = new PlotCanvas(this);
    scrollArea->setViewport(plotsCanvas);
    scrollArea->setBackgroundRole(QPalette::Dark);
    specializedKnobGroup = new QGroupBox("Probe settings:");
    plotSettings = new QStackedWidget(specializedKnobGroup);
    settingsVLayout->addWidget(commonKnobGroup);
    settingsVLayout->addWidget(specializedKnobGroup);
    settingsGroupBox->setLayout(settingsVLayout);
    hbox->addWidget(hsplitter);
    setLayout(hbox);
    connect(plotNamesColumn, SIGNAL(currentItemChanged(QListWidgetItem *, QListWidgetItem *)), this,
            SLOT(changePageNames(QListWidgetItem*, QListWidgetItem*)));
    connect(commonKnobs, SIGNAL(scaleUpdated()), plotsCanvas, SLOT(update()));

}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T01:17:19.737

尝试使用小部件`geometry`而不是`rect`. 还要小心复制构造函数。如果您使用成员变量，则需要使用 setGeometry 或 setRect 而不是复制构造函数。

请参阅[Qt 窗口几何](http://doc.qt.nokia.com/4.7-snapshot/application-windows.html#window-geometry)文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T11:48:54.377

当实际上 parent() 在 PlotCanvas 和 QGroupBox 的情况下引用到 PlotCanvasScrollArea 在其他类的情况下。
奇怪的是，调试器显示我实际上跳入了 Board 的代码，即使认为被调用对象的地址完全错误，更奇怪的是它在 PlotCanvas 代码中崩溃，而不是在原始代码（Board 的代码）中。
但现在没事了。谢谢你们 ：）

# android - 在 Jelly Bean 设备上读取 ActivityManager 日志？

> ID：11371021
> 
> 赞同：6
> 
> 时间：2012-07-06T23:47:14.593
> 
> 标签：android, security, android-activity, android-logcat

Jelly Bean 移除了读取其他应用程序日志的能力（根据[这个](http://www.youtube.com/watch?v=RPJENzweI-A)I/O 谈话），这是一个明智的安全改进。但是，我需要阅读`ActivityManager`-logs 才能让我的应用程序正常工作（查看当前正在启动的应用程序）。为此，我正在使用

```
private static final String clearLogcat = "logcat -c";
private static final String logcatCommand = "logcat ActivityManager:I *:S";
//... 
```

这不再有效，因为我只能在 Jelly Bean 中读取我自己的应用程序日志。是否有替代解决方案来找出另一个应用程序何时启动（除了根）？我理解为什么我们不应该能够读取其他应用程序的日志（有点 - 应该是其他开发人员的责任，以确保没有记录任何个人信息，而不是我的被阻止读取日志），但我不明白为什么`ActivityManager`框架类包含在该策略中...

谢谢，
尼克

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-09T13:31:20.750

有一个关于这个问题的广泛讨论在[这里](https://groups.google.com/forum/?fromgroups#!topic/android-developers/6U4A5irWang)。不幸的是，这是“预期行为”，因此无法修复。当前唯一的解决方案（用于从 JB 及更高版本的应用程序中读取日志）是通过 adb 手动授予应用程序权限：

`adb shell pm grant <pkg> android.permission.READ_LOGS`

如此授予的权限：

*   在重新启动后幸存下来
*   在应用程序更新中存活（即“adb install -r”）
*   如果应用程序被卸载然后再次安装，则无法生存

很明显，这不是普通用户可以做的事情。Android 团队承诺提供 GUI 解决方案（用户可以从其设备的菜单授予此权限`Settings`），但不幸的是，在实施“修复”之前，该功能已被删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:16:16.187

首先，`ActivityManager`它不是应用程序……它是构成 Android 应用程序框架一部分的类。

其次，如果 Android 团队故意不让这个功能发挥作用，那么我怀疑它周围存在安全漏洞。事实上，第三方应用程序不应该依赖 logcat 日志才能正常工作。如果您详细说明您需要阅读这些日志的原因，也许我们可以帮助您找到更好的解决方案。

# c++ - (Qt) 如何在视图中实现 editorOpened(index) 和 editorClosed(index) 信号

> ID：11371026
> 
> 赞同：0
> 
> 时间：2012-07-06T23:47:44.697
> 
> 标签：c++, qt, model, qtableview

我已经使用我的数据抽象方案将自己编码到一个角落，这导致我需要在我的视图中使用 editorOpened(QModelIndex) 和 editorClosed(QmodelIndex) 信号（几乎完全是 QTableView）。

原因是我的数据类具有自动行为，需要在编辑期间阻止/禁用，然后再重新启用。

起初我想尝试用自定义委托来做，但由于几个原因遇到了问题：一个是使用为每个项目提供相同行为的自定义委托似乎有点过分，换句话说，它看起来像它应该由视图本身为所有项目完成。第二个问题是委托似乎`const`阻止了我为委托中的数据对象设置内部句柄。

查看视图方法，我发现 QAbstractItemView::edit 和 QAbstractItemView::closeEditor 非常适合使用 opens() 和 closed() 信号重新实现，但是我需要正在编辑的特定项目的索引/句柄，我认为我无法从这些方法中获得...

在这一点上，我不知道我还能做什么。我将不胜感激任何正确方向的提示或指示！谢谢阅读

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T15:42:45.503

我自己解决了...

我发现 QAbstractItemDelegate::editorEvent 是非常量的（我之前阅读文档时一定没有像我想的那样仔细查看）。

我能够在此方法中的自定义委托中设置一个内部句柄，这使我可以简单地创建一个插槽来执行关闭时所需的操作，并将 closeEditor(QWidget*,QAbstractItemDelegate::EndEditHint) 信号连接到它。

# java - 遍历键集时更新条目

> ID：11371029
> 
> 赞同：0
> 
> 时间：2012-07-06T23:48:03.683
> 
> 标签：java, map, iterator

在遍历键时如何完成更新条目

```
Map<String,List<SObject>> Map1=new HashMap<String,List<SObject>>();
Map<String,List<SObject>> Map2=new HashMap<String,List<SObject>>();

for(String name: Map1.keyset()){
//do something

   for(SObject obj1: Map1.get(name)){
    //iterate through the list of SObjects returned for the key 

        for(SObject obj2 : Map2.get(name)){
        //iterate through the list of SObject values for the keys and update or remove the values related to the key
        }
   }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:20:33.807

您可以在地图的 entrySet 上使用 Iterator - map.entrySet().iterator()

确保在您迭代地图时没有其他任何东西在修改地图，但只要您执行以下操作，您自己的修改将是安全的：

```
- only remove items using the iterator's remove() method, and
- only modify a value by using the Map.Entry setValue() method 
```

请参阅[http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#entrySet()](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#entrySet%28%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:03:28.013

要在迭代期间修改集合，您需要使用`ListIteration`接口：

[http://docs.oracle.com/javase/6/docs/api/java/util/ListIterator.html](http://docs.oracle.com/javase/6/docs/api/java/util/ListIterator.html)

# javascript - 如何使 jquery modal 始终以页面为中心？

> ID：11371032
> 
> 赞同：2
> 
> 时间：2012-07-06T23:48:14.563
> 
> 标签：javascript, jquery

我发现这是大多数 jquery 模式弹出框的问题。所以我想知道，是否有任何 jquery 代码可以使 jquery 模态始终位于页面中心？我知道这可以用纯 javascript 代码来实现，但是 jquery 呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:19:57.227

如果您使用的是自定义模式，一些可能对您有帮助的样式是：

```
<div id="modal"></div>

#modal {
    position: fixed;
    height: 80px;
    width: 200px;
    left: 50%;
    top: 50%;
    margin-left: -40px;
    margin-right: -100px;
} 
```

“位置：固定”将模式保持在基于窗口的某个位置。高度和宽度显然提供了大小，而 left/margin-left 和 top/margin-top 实际上是居中的。margin-left 和 margin-top 必须分别是宽度/高度的负一半。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T00:28:29.963

如果你想用 jQuery 使元素居中，试试这个；

```
var browserW = $(window).width();
var centerEle = (browserW - 960) / 2; //if ur website design's width 960

$('.centeredEle').css({'left':centerEle + 'px'});//or margin-left, ur choise 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T05:01:33.553

如果您对 jquery 感到满意..您可以使用以下 jquery 函数

```
jQuery.fn.center = function () {
    this.css("position","absolute");
    this.css("top", (($(window).height() - this.outerHeight()) / 2) + $(window).scrollTop() + "px");
    this.css("left", (($(window).width() - this.outerWidth()) / 2) + $(window).scrollLeft() + "px");
    return this;
} 
```

# php - 在 PHP 中使用 mysql_query 显示用户名不起作用

> ID：11371036
> 
> 赞同：0
> 
> 时间：2012-07-06T23:48:55.617
> 
> 标签：php, mysql

我目前正在尝试创建一个注册表单，并且我的表单本身可以工作，人们可以在我的数据库中创建用户，但是当他们注册时，它会将他们重定向到`admin.php`.

他们用于创建帐户的名称不显示，按行用户名向下显示。它应该说“欢迎，`user_name`您现在已登录！”

我只是无法显示名称，但其他一切正常！

> 警告：mysql_fetch_array() 期望参数 1 是资源，布尔值在第 25 行的 C:\path\to\admin.php 中给出
> 警告：mysql_fetch_array() 期望参数 1 是资源，布尔值在 C:\path\to\ 中给出第 36 行的 login.php

**行政：**

```
<?php
require('db_config.php');
require_once('functions.php');

//if the cookie is still valid, recreate the session
if( $_COOKIE['logged_in'] == true ){
    $_SESSION['logged_in'] = true;
    $_SESSION['user_id'] = $_COOKIE['user_id'];
    $_SESSION['is_admin'] = $_COOKIE['is_admin'];

}
if( $_SESSION['logged_in'] != true ){
    //not logged in! send them back to the form]
    header('location:login.php');   
}

//extract the data for the logged in user, so we can use it on all page
$user_id = $_SESSION['name'];
$query_user = "SELECT * FROM users
                WHERE name = $user_id
                LIMIT 1";

$result_user = mysql_query($query_user);
$row_user = mysql_fetch_array($result_user);
//this going to be a handy variable to have throughout all pages
$user_id = $row_user['user_id'];

?>
<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> 
<html>
<head>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="css/reset.css" />
<link rel="stylesheet" type="text/css" href="css/format.css" />
<title>Schell Shock Design's Portfolio</title>
</head>

<body>
 <div id="login">
 <?php
    include('login.php');
    ?>
  </div>
  <div id="utilities">
   <?php include('utilities.php'); ?>
  </div>

<div id="container">
  <header>
   <?php include('header.php'); ?>
   </header>
       <div id="slider">
       <?php include('slider.php'); ?>
          </div>
        <div id="content">
      <?php include('content.php'); ?>

  </div>
  <div id="bottomcontent">
      <?php include('bottomcontent.php'); ?>
  </div>
  <div id="footer">
      <?php include('footer.php'); ?>
</div>
</body>
</html> 
```

**登录：**

```
<?php
 //show an error if there is a problem with the login
if($error == true){ ?>

    <div class="error">
        Sorry, Your username and password are incorrect. Try again. 
    </div>  

<?php } //end if error ?>

<?php //show the form only if NOT logged in
if( !$_SESSION['logged_in'] ){

?>
  <div class="form1">
  <form action="?action=" method="post">
    <label for="username">Username:</label>
    <input type="text" name="username" id="username" />
    <label for="password">Password</label>
    <input type="password" name="password" id="password" />
    <input type="submit" value="Log in" />
    <input type="hidden" name="did_login" value="1" />
</form>
<?php } //end if not logged in 

else{ 
//get info of logged in person
     $user_id = $_SESSION['user_id'];
    $query_user = "SELECT name
                    FROM users
                    WHERE user_id = $user_id";

$result_user = mysql_query( $query_user );
$row_user = mysql_fetch_array( $result_user );
?>
    <div id="loggedin">
    <a href="?action=logout">Log Out</a>

    <?php //show a welcome message if they logged in successfully
    echo 'Welcome '.$row_user['name'].', You are now logged in!';
 ?> 

<?php } ?>
</div> 
```

**登记**

```
<?php
//register parse. all this logic MUST go before the doctype or any other text output.
require('db_config.php');
require_once('functions.php');

//if they submitted the form, parse it
if( $_POST['did_register'] == 1 ){
    //extract amd sanitize all fields
    $username = clean_input($_POST['username']);
    $email = clean_input($_POST['email']);
    $password = clean_input($_POST['password']);
    $repassword = clean_input($_POST['repassword']);
    $policy = clean_input($_POST['policy']);

    //encrypted version of the password, for storing in the database
    $sha_password = sha1($password);

    //begin validation
    $valid = true;

    //did they forget to check the box?
    if( $policy != 1 ){
        $valid = false;
        $msg = 'You must agree to the TOS and PP before signing up. <br />';
    }

    //repeated password does not match
    if( $password != $repassword ){
        $valid = false;
        $msg .= 'The passwords provided do not match. <br />';
    }

    //make sure the username and password are at least 5 characters long, than check the database
    if( strlen($username) >= 5 AND strlen($password) >= 5 ){
        //check to see if username is already taken
        $query_username = "SELECT name
                            FROM users
                            WHERE name = '$username'
                            LIMIT 1";

        $result_username = mysql_query($query_username);
        //if one result is found, username is taken.
        if( mysql_num_rows($result_username) == 1 ){
            $valid= false;
            $msg .= 'That username is already taken. Try another. <br />';  
        }
    }else{
        $valid = false;
        $msg .= 'Username and Password must be at least 5 characters long. <br />'; 
    }

    //check for valid email, than check for match in database
    if( check_email_address($email) == true ){
        //look for match in database
        $query_email = "SELECT email
                        FROM users
                        WHERE email = '$email'
                        LIMIT  1";
        $result_email = mysql_query($query_email);
        //if 1 result is found, email is taken.
        if( mysql_num_rows($result_email) == 1 ){
            $valid = false;
            $msg .= 'Looks like an account with that email already exists. Do you want to login? <br />';

        }
    }else{
        //invalid email
        $valid = false;
        $msg .= 'Please provide a valid email address. <br />'; 
    }

    //if the data passed ALL tests, add the user to the database
    if( $valid == true ){
        $query_insert = "INSERT INTO users
                        (name, password, email, join_date, is_admin)
                        VALUES
                        ('$username', '$sha_password', '$email', now(), 0)";

        $result_insert = mysql_query($query_insert);
        //check to see if it worked
        if( mysql_affected_rows() == 1 ){
            //SUCCESS! Log the user in and send them to their profile.
            $_SESSION['logged_in'] = true;
            setcookie( 'logged_in', 'true', time() + 60*60*24*7 );
            header( 'location:index.php' );

        }else{
            $msg .= 'There was a problem adding the user to the Database';
        }
    }
} //end if submitted form
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Sign up for an account</title>

</head>

<body>
    <?php
    if( isset($msg) ){
        echo $msg;
    }
    ?>
    <form action="registration.php" method="post">
        <label for="username">Choose a Username:</label>
        <input type="text" name="username" id="username" />
        <span class="hint">Minimum of five characters</span>

        <label for="email">Your Email Address:</label>
        <input type="text" name="email" id="email" />      

        <label for="password">Choose a Password:</label>
        <input type="password" name="password" id="password" />
        <span class="hint">Minimum of 5 characters</span> 

        <label for="repassword">Repeat Password:</label>
        <input type="password" name="repassword" id="repassword" />

        <input type="checkbox" name="policy" id="policy" value="1" />
        <label for="policy">Yes, I have read the Terms of Service and Privacy Policy.</label>

        <input type="submit" value="Sign up" />
        <input type="hidden" name="did_register" value="1" />
    </form>

</body>
</html> 
```

我需要解决什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T21:07:30.020

1.  您应该检查错误是什么：

    ```
    if (!$result_user) {
       die('MySQL Error: '.mysql_error());
    } 
    ```

2.  `session_start()`在每个页面的顶部调用。

3.  并确保正确返回会话的值：

    ```
    print_r($_SESSION); 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T21:06:07.833

在`admin.php`中，此查询失败：

```
$query_user = "SELECT * FROM users WHERE name = $user_id LIMIT 1"; 
```

也许`$user_id`是空的，或者它需要被引用 ( `'$user_id'`)。

在任何情况下，您都应该检查查询结果以确保它成功：

```
$user_id = $_SESSION['name'];
$query_user = "SELECT * FROM users
                WHERE name = $user_id
                LIMIT 1";

$result_user = mysql_query($query_user);
if (!$result_user) {
    die('Query failed: ' . mysql_error());
} 
```

[mysql_query()](http://php.net/mysql_query)仅在成功时返回资源结果。失败时，它返回`(bool)FALSE`不能传递给任何`mysql_fetch_*`函数的值。

login.php 中的错误也是如此。

您似乎没有显示登录时运行的代码，我猜您没有为会话分配正确的变量。

# jquery - 谷歌地图 api v3 在 fancybox 2.0.6

> ID：11371046
> 
> 赞同：2
> 
> 时间：2012-07-06T23:50:01.990
> 
> 标签：jquery, html, google-maps-api-3, fancybox, fancybox-2

嗨，我在隐藏的幻想框中加载谷歌地图时遇到问题

![在此处输入图像描述](../Images/0d16dd9c0da0faaacb6cacdd9d3fbc03.png)

我的例子：[gidzior.net/fancyMap](http://gidzior.net/fancyMap)是基于这个线程[stackoverflow.com/questions/10890948/jquery-fancybox-with-google-maps编写的](https://stackoverflow.com/questions/10890948/jquery-fancybox-with-google-maps)

我该怎么做才能解决这个问题？

这是我的代码：

```
<body style="padding: 20px;">
    <!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <header>
        <a id="inline" href="#inline1" >show map</a>
    </header>
    <div role="main">
        <div id="inline1" style="width:800px; height: 350px; display: none;">
            <div id="map_canvas" style="width: 100%; height: 100%"></div>
        </div>
    </div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/libs/jquery-1.7.1.min.js"><\/script>')</script>

    <script src="js/plugins.js"></script>
    <script src="js/libs/jquery.fancybox.pack.js"></script>
    <script src="js/libs/jquery.mousewheel-3.0.6.pack.js"></script>
    <script src="js/script.js"></script>

    <script type="text/javascript">
    var map="";
    $(document).ready(function(){
     $("a#inline").fancybox({
      'hideOnContentClick': false, // so you can handle the map
      'overlayColor'      : '#ccffee',
      'overlayOpacity'    : 0.2,
      'autoDimensions': true, // the selector #mapcontainer HAS css width and height
      'onComplete': function(){
        google.maps.event.trigger(map, "resize");
      },
      'onCleanup': function() {
       var myContent = this.href;
       $(myContent).unwrap();
      } // fixes inline bug
     });
     // map
     map = new google.maps.Map(
      document.getElementById("map_canvas"), {
      zoom: 9,
      center: new google.maps.LatLng(49.261226,-123.113928),
      mapTypeId: google.maps.MapTypeId.TERRAIN
      }   
     );
    }); // ready
</script>
</body> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T01:17:14.110

fancyBox V2 中已经没有**`onComplete`**了，现在调用**`afterLoad`**了。

但你最好使用**`afterShow`**，它会稍后触发。

[http://fancyapps.com/fancybox/#docs](http://fancyapps.com/fancybox/#docs)

# html - 仅使用 CSS 的输入字段中的占位符文本（无 JavaScript）

> ID：11371047
> 
> 赞同：10
> 
> 时间：2012-07-06T23:50:06.517
> 
> 标签：html, css, placeholder

有时最好（从设计的角度）在每个字段中包含占位符文本，而不是在表单中标记每个字段。例如，而不是这样：

```
 ----------------------------------
Full Name:  |                                  |
             ---------------------------------- 
```

你有这个：

```
 ----------------------------------
| Full Name                        |
 ---------------------------------- 
```

当您单击该字段时，文本会消失，您可以编写任何您想要的内容。如果您跳过该字段而不输入任何文本，则占位符会重新出现。

我见过很多方法，但所有方法都涉及 JavaScript。[例如，Twitter 在他们的注册页面](https://twitter.com/signup)上做得不错，但是如果禁用了 Javascript，你最终会在“全名”这个词上输入你的名字。

我正在寻找一种即使禁用 JavaScript 也能工作的纯 CSS 方法。我想出的唯一可能的解决方案是将`<input>`标签的背景设置为所需文本的图像，然后`input:focus`在有人单击文本框时使用伪类清除背景图像。这似乎可行，但不必使用图像会很好。

有谁知道如何做到这一点的好资源？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-01T15:01:17.870

这是首选方法，适用于所有当前浏览器：

```
<input type="text" name="" placeholder="Full Name"/> 
```

此版本适用于 IE9 及之前版本：

```
<input type="text" name="" value="Full Name" onfocus="value=''" onblur="value='Full Name'"/> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-07T00:08:22.277

您可以使用`<label>`放置在索引后面`z-index`并`background-color`在`<input>`. 用于`:focus`更改为白色背景。

`:first-line`有一些 Firefox 问题。

演示：http: [//jsfiddle.net/ThinkingStiff/bvJ43/](http://jsfiddle.net/ThinkingStiff/bvJ43/)

**注意：**有关模糊问题，请参阅下面的 code-sushi 评论：[Placeholder text in an input field with CSS only (no JavaScript)](https://stackoverflow.com/questions/11371047/placeholder-text-in-an-input-field-with-css-only-no-javascript/11371158#comment42028245_11371158)

输出：

![在此处输入图像描述](../Images/3dabf323e6783427579932748fca6965.png)

HTML：

```
<label class="input">enter name<input /><label>​ 
```

CSS：

```
.input {
    color: gray;
    display: block;
    font-size: small;
    padding-top: 3px;
    position: relative;
    text-indent: 5px;
}

input {
    background-color: transparent;
    left: 0;
    position: absolute; 
    top: 0;   
    z-index: 1;
}

input:focus, input:first-line {
    background-color: white;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-11T05:34:48.360

试试这个：

**HTML**

```
<div>
    <input type="text" id="text"></input>
    <label for="text">required</label>
</div> 
```

**CSS**

```
.text-wrapper {
    position: relative;
}
.text-input-label {
    position: absolute;
    /* left and right properties are based on margin, border, outline and padding of the input text field */
    left: 5px;
    top: 3px;
    color: #D1D1D1;
}
#text:focus + label {
    display: none;
} 
```

[**工作小提琴**](http://jsfiddle.net/ukWrf/3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T00:24:54.337

试试[这个](http://jsbin.com/regihemoku/1/)：它解决了溢出的占位符和多输入的情况。诀窍是将标签移动到输入后面并在视觉上重新排序。

你不需要额外的 div 来实现你想要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-31T19:07:25.190

上面所有可能仅限 CSS 的答案都忽略了一个关键组件，一旦用户不再关注该特定字段，该组件是防止充当伪占位符的标签“渗出”所必需的。

暗示：

```
input:valid { background-color:white; } 
```

`:valid`只要字段具有除 以外的任何值，伪类就会获得`''`。因此，当您的用户在他或她自己的字段中输入任何内容时，那里显示的标签将停止显示。

请注意`<input type="email" />`字段，伪类`:valid`确实并且实际上需要输入有效的电子邮件格式（例如“xxxx@xxx.com” - 或.net或.org等）。

如何在此处执行此操作的完整说明：http: [//css-tricks.com/float-labels-css/](http://css-tricks.com/float-labels-css/)

# php - 为什么我不能使用 fpdfi 在页面底部覆盖文本？

> ID：11371049
> 
> 赞同：6
> 
> 时间：2012-07-06T23:50:14.977
> 
> 标签：php, overlay, tcpdf, fpdf

背景：我正在开发一个应用程序，该应用程序涉及采用现有的 pdf 表单并在其上覆盖文本。pdf 是 1.3 版。我正在使用可以在这里找到的 fpdfi 类（用 php 编写）：

[http://www.setasign.de/support/manuals/fpdi/](http://www.setasign.de/support/manuals/fpdi/)

我使用 fpdfi 作为此处找到的 tcpdf 类的扩展：

[http://www.tcpdf.org/index.php](http://www.tcpdf.org/index.php)

我使用一行（php）代码，如下所示：

$this->SetXY(25, 250);$this->Cell(0, 8.6, $data['my_data_to_overlay']);

其中 $this 指的是 fpdfi 类的实例，SetXY 函数告诉它我希望放置文本的坐标 (x,y)，而 Cell 函数告诉它我想要显示的文本以及大小等。页面高度为 279.4（此处所有单位均以 mm 为单位）

问题：

如果我将 y 坐标设置为高于 250（即使是 251），文本将被放置在下一页上，而不是按预期放置在当前页面底部附近。该线上方 250 处的所有其他坐标都将正确显示，即使在页面的顶部边缘也是如此。

为什么我不能在页面底部附近覆盖文本？我究竟做错了什么？

还要注意：页面的所有边距都设置为 0，并且页眉和页脚被禁用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-07T01:27:15.930

通过调用[FPDF::SetAutoPageBreak](http://www.fpdf.org/en/doc/setautopagebreak.htm)禁用自动分页符，使用 false 或 true 但使用 0 边距。

**编辑**：使用`FPDF::SetMargins`您只能设置左边距、上边距和右边距，但不能设置下边距。这是指定下边距的正确方法。

# java - JLayeredPane 中的透明 JPanel

> ID：11371052
> 
> 赞同：3
> 
> 时间：2012-07-06T23:50:36.117
> 
> 标签：java, swing, transparency, jpanel, jlayeredpane

我见过几个类似的问题，但不幸的是其中包含的建议并没有完全为我完成。

总体目标：我有一个滑块，我想在一个主要显示可视化的窗口的左上角显示（这里是“显示”）。滑块应覆盖在没有任何背景的可视化顶部。

到目前为止，我有一个 JPanel，在 JLayeredPane 的可视化上方的图层上包含我的滑块。问题是，尽管调用了 setOpaque 和/或 setBackground(new Color(0,0,0,0))，但 JPanel 的背景（包括滑块）显示为灰色。我正在使用 Nimbus LAF。

最初，我使用了 Absolute Layout，它以非常优雅的方式完成了几乎所有事情，并且代码最少。那里的问题是可视化没有随窗口自动调整大小（但如果有一种干净的方法可以使可视化随窗口调整大小，我愿意接受这种方法）。

```
JPanel sliderPane = new JPanel();
sliderPane.setLayout(new BoxLayout(sliderPane, BoxLayout.X_AXIS));
sliderPane.add(zoomSlider);
zoomSlider.setMaximumSize(new Dimension (60, 150));
sliderPane.add(Box.createHorizontalGlue());
sliderPane.setBackground(new Color(0,0,0,0));

JLayeredPane graphPane = new JLayeredPane();
graphPane.setPreferredSize(new Dimension(1000, 800));
graphPane.setLayout(new BoxLayout(graphPane, BoxLayout.Y_AXIS));
graphPane.add(sliderPane, new Integer(1));
graphPane.add(display, new Integer(0));
graphPane.setOpaque(false); 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T01:50:34.793

渲染滑块是组件的 UI 委托的职责，通常是`BasicSliderUI`. [如果需要，您可以替换您自己的实现，如此处](https://stackoverflow.com/a/6996263/230513)所示。

![图片](../Images/9e2a01a5cb4abfd6e28d43d6f2eb1a72.png)

# velocity - 升级 VelocityTools 2.0 新 tools.xml 不加载

> ID：11371053
> 
> 赞同：4
> 
> 时间：2012-07-06T23:51:15.440
> 
> 标签：velocity

我正在切换到 VelocityTools 2.0，但新的 tools.xml 没有加载。我替换了 toolbox.xml，现在我使用 tools.xml 但是当我运行服务器时，我得到：

> “XMLToolboxManager：100：XMLToolboxManager 已被弃用。请改用 org.apache.velocity.tools.ToolboxFactory。
> 
> ServletToolboxManager:131: ServletToolboxManager 已被弃用。请改用 org.apache.velocity.tools.ToolboxFactory。”

如何使用 ToolboxFactory？XMLToolboxManager 或 ServletToolboxManager 在我的代码中的任何地方都没有被引用，所以我不能简单地替换这些类。

当我将 toolbox.xml 与 VelocityTools 2.0 一起使用时，它工作得很好，但我需要在 tools.xml 中使用新的 xml 语法

我在 velocity.xml 中的 bean 定义如下所示：

```
<bean id="viewResolver" class="org.springframework.web.servlet.view.velocity.VelocityLayoutViewResolver">
    <property name="viewClass">
         <value>org.springframework.web.servlet.view.velocity.VelocityLayoutView</value>
    </property>
    <property name="contentType">
        <value>text/html;charset=UTF-8</value>
    </property> 
    <property name="cache"><value>true</value></property>
    <property name="prefix"><value></value></property>
    <property name="suffix"><value>.vm</value></property> 
    <property name="toolboxConfigLocation"><value>/WEB-INF/tools.xml</value></property> 
</bean> 
```

我尝试从 bean 中删除“toolboxConfigLocation”的属性，并希望默认的 tools.xml 可用，但是当我尝试使用时，即 $math 不起作用。我究竟做错了什么？

有人可以帮忙吗？

# c++ - C++ 基本数组赋值不起作用

> ID：11371056
> 
> 赞同：-4
> 
> 时间：2012-07-06T23:51:43.773
> 
> 标签：c++

所以我有一个功能

```
f(int D[],int A[],int len){ 
   for(int k = 0; k < len; k++)
      D[k] = A[k]; 
```

如果我输出`D`的数字都是错误的。该函数以函数中的初始化`f`方式调用，一切都很好，因为我在函数中输出了它，它看起来没问题。所以......无法理解问题出在哪里......我也尝试过，但它不起作用。`D``int* D = new int[100000];``main``A``memcpy(D+k,A+k,sizeof(int));`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:13:21.240

您的循环完美运行。问题必须在您的代码中的其他地方。

这是一个示例程序，它以三种不同的方式复制数据：`for`循环`memcpy`、 和`std::copy`：

```
#include <algorithm>
#include <cstring>
#include <iostream>
#include <iterator>

void copy1(int D[], int A[], int len) {
  for(int k = 0; k < len; k++)
    D[k] = A[k];
}

void copy2(int D[], int A[], int len) {
  std::memcpy(D, A, len*sizeof(int));
}

void copy3(int D[], int A[], int len) {
  std::copy(A, A+len, D);
}

int main () {
  int a[10] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };
  int *d = new int[10];

  std::ostream_iterator<int> out(std::cout, ",");

  // First, print the initial values
  std::copy(d, d+10, out);
  std::cout << "\n";

  // Next do the copies and print the values again
  copy1(d, a, 10);
  std::copy(d, d+10, out);
  std::cout << "\n";

  copy2(d, a, 10);
  std::copy(d, d+10, out);
  std::cout << "\n";

  copy3(d, a, 10);
  std::copy(d, d+10, out);
  std::cout << "\n";
} 
```

我得到的输出是：

```
0,0,0,0,0,0,0,0,0,0,
1,2,3,4,5,6,7,8,9,10,
1,2,3,4,5,6,7,8,9,10,
1,2,3,4,5,6,7,8,9,10, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:04:53.283

在调试器中运行您的代码，看看您是否首先没有垃圾`A[]`（函数调用后可能会出错）。另外我建议您传递参考（例如`int & D[]`和`const int & A[]`-`const`以防止更改`A`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T00:09:41.053

从如下所示的最小工作示例开始，然后将您的其他代码集成到其中，直到出现问题。那将是您错误的根源。没有更多信息，我能告诉你的几乎就是这些了；当您在 C++ 程序中遇到错误值时，您可能正在读取未初始化的变量。我建议您尝试在 GDB 等调试器中单步执行您的程序。

```
#include <algorithm>
#include <iostream>
#include <iterator>

void f(int D[], const int A[], int len){ 
   for(int k = 0; k < len; k++)
      D[k] = A[k];
}

int main(int argc, char** argv) {
  int A[] = { 1, 2, 3, 4, 5 };
  int D[5];
  f(D, A, 5);
  std::copy(A, A + 5, std::ostream_iterator<int>(std::cout, " "));
  std::cout << '\n';
  std::copy(D, D + 5, std::ostream_iterator<int>(std::cout, " "));
  return 0;
} 
```

除非您有充分的理由这样做，否则请优先使用`std::vector`原始`std::array`数组。不过，了解数组和指针的工作原理是使用它们的一个很好的理由。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T00:14:00.043

我认为问题在于您正在传递一个指向数组 int* D = new int[100000]; 的指针。

但是，您的函数需要两个整数数组，这与指向数组的指针不同。

这是一个片段的 SSCCE，其行为与您想要的一样：

```
#include <iostream>
using namespace std;

void f(int * d, int * a, int length){
    for(int k = 0; k < length; k++){
            d[k] = a[k];
    }
}

int main() {
    int* a = new int[9];
    for(int i = 0; i < 9; i++){a[i] = i;}
    int* d = new int[9];
    f(d, a, 9);

    for(int i = 0; i < 9; i++){
            cout << d[i] << " ";
    }
} 
```

# python - 通过 C-api 分析 Python（如何？）

> ID：11371057
> 
> 赞同：1
> 
> 时间：2012-07-06T23:51:52.470
> 
> 标签：python, profiling

我已经使用 Python 的 C-API 在我的 c 代码中调用了一些 Python 代码，现在我想分析我的 Python 代码是否存在瓶颈。我遇到了 PyEval_SetProfile API，但不知道如何使用它。我需要编写自己的分析函数吗？

如果您能提供一个例子或指出一个例子，我将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T23:58:34.097

如果您只需要知道在 Python 代码中花费的时间量，而不是（例如）在 Python 代码中花费最多时间的地方，那么 Python 分析工具不是您想要的。我会编写一些简单的 C 代码，对 Python 解释器调用前后的时间进行采样，并使用它。或者，C 级分析工具将 Python 解释器测量为 C 函数调用。

如果您需要在 Python 代码中进行分析，我不建议您编写自己的分析函数。它所做的只是为您提供原始数据，您仍然需要汇总和分析它。相反，围绕您的 Python 代码编写一个 Python 包装器，该包装器调用 cProfile 模块来捕获您可以检查的数据。

# birt - 在子表单元格中使用网格元素会导致在 PDF 导出中添加分页符

> ID：11371059
> 
> 赞同：3
> 
> 时间：2012-07-06T23:52:30.293
> 
> 标签：birt

目前，我的报告设置有一个放置在父表行中的子表。子表的每一行都有一个 Grid 元素，可以让我更好地控制报表的格式。子报表中有多个字段长度不同，因此报表的每列字段不起作用。请注意，我只设置表格的数据源，而不是网格元素的数据源。

这在呈现为 HTML 时有效，但是，当呈现为 PDF 文件时，分页符出现在包含子页面的行之前。

我试图通过以下方式解决问题的事情：

*   将分页符设置为“避免”
*   将分页间隔设置为高
*   用 2.6.2 和 3.7.2 测试。4.2 目前不会在我的机器上运行。

当您为表中的每个字段使用一列而不是单个单元格中的 Grid 元素时，问题就会消失，但这是不可取的，因为存在多个字段长度不同的字段。合并多个单元格为不同长度腾出空间确实有效，但是当您需要更改报告格式时，它可能会变得不守规矩。

网格/表格的大小无关紧要——即使我只使用数据集中的几个字段也会发生这种情况。

经过更多的实验，我发现如果我删除父表中所有在子表行之前的详细信息行，则可以正确创建报告。不幸的是，我需要在子表之前有几行信息，所以这不能解决问题。

有没有人有办法解决吗？

# php - 在php中编码url以防止直接访问

> ID：11371061
> 
> 赞同：1
> 
> 时间：2012-07-06T23:53:02.227
> 
> 标签：php

在我的网站上注册用户有三个步骤，现在的网址类似于：

```
http://www.example.com/register.php

http://www.example.com/registerstep2.php

http://www.example.com/registerstep3.php 
```

我想知道将其编码为以下内容的简单方法是什么：

```
http://www.example.com/w^3434SD343f232gihmsdsdwre232 
```

我试图这样做的原因是，我试图确保用户遵循步骤，而不是试图通过直接访问注册链接 3 来“欺骗”系统。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T23:55:20.950

**这是一个坏坏坏主意**。与其尝试通过简单的混淆来隐藏 url，不如在脚本顶部检查它们是否可以继续。

换句话说，每次他们去一个页面，**检查他们是否提交了前一页的信息。如果他们没有，把他们送回去**。例子：

```
if ( !functionThatChecksAndReturnsBool() )
{
    header("Location http://www.example.com/register.php");
    exit;
} 
```

# html - html流分块文件未知大小

> ID：11371062
> 
> 赞同：0
> 
> 时间：2012-07-06T23:53:09.053
> 
> 标签：html, http, audio, stream, http-headers

嗨，我想从我的网络服务器流式传输数据。这是问题所在。我的服务器上不存在数据我将其作为来自另一台服务器的实时内容检索。所以我没有文件的大小。我如何流式传输这些数据。？

我以块（不同大小）读取 PCM 将其转换为 OGG。将 OGG HEADER 和 OGG CONTENT 发送到 html5 音频标签或者至少这是我想要做的。

回顾：我是服务器“A”，

还有另一个服务器“B”，它提供 PCM 数据。

客户端请求来自 HTML5 的 AUDIO 标签到服务器 A 以获取服务器 B 中的数据（此数据没有大小，恒定流）。

A 从 B 接收 PCM 转换为 OGG。将它作为二进制数据沿着 http 响应对象发送。

有任何想法吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T06:49:21.697

HTTP/1.1完全支持这种用例的[分块编码。](http://greenbytes.de/tech/webdav/rfc2616.html#rfc.section.3.6.1)

# java - 获取 int 的字节表示，仅使用 3 个字节

> ID：11371063
> 
> 赞同：0
> 
> 时间：2012-07-06T23:53:13.350
> 
> 标签：java, hadoop, bytearray, hbase, binary-data

什么是获取 an 的字节表示（即 a `byte[]`）`int`但仅使用 3 个字节（而不是 4 个）的好、易读的方法？我正在使用 Hadoop/Hbase，它们的`Bytes`实用程序类有一个`toBytes`函数，但总是使用 4 个字节。

理想情况下，我还想要一种好的、可读的编码方式，尽可能少地编码，即如果数字适合一个字节，则只使用一个。

请注意，我将它存储在 a 中`byte[]`，因此我知道数组的长度，因此不需要可变长度编码。这是关于找到一种优雅的方式来进行演员阵容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T23:56:05.737

对此的通用解决方案是不可能的。

如果可能的话，您可以迭代地应用该函数来获得无限的数据压缩。

您的域可能对允许将它们压缩为 24 位的整数有一些限制。如果有这样的限制，请在问题中解释。

一种常见的可变大小编码是使用每个字节的 7 位作为数据，高位作为标志来指示当前字节何时是最后一个字节。

* * *

`int`您可以使用[以下实用程序方法](http://docs.oracle.com/javase/6/docs/api/java/lang/Integer.html#numberOfLeadingZeros%28int%29)预测编码所需的字节数`Integer`：

```
int n = 4 - Integer.numberOfLeadingZeros(x) / 8;
byte[] enc = new byte[n];
while (n-- > 0) 
  enc[n] = (byte) ((x >>> (n * 8)) & 0xFF); 
```

请注意，这会将 0 编码为空数组，并将其他值编码为*little-endian*格式。这些方面很容易通过更多的操作进行修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T00:43:17.107

尝试使用字节缓冲区。如果需要，您甚至可以设置小端模式：

```
int exampleInt = 0x11FFFFFF;
ByteBuffer buf = ByteBuffer.allocate(Integer.SIZE / Byte.SIZE);
final byte[] threeByteBuffer = new byte[3];
buf.putInt(exampleInt);
buf.position(1);
buf.get(threeByteBuffer); 
```

或者最短的签名，Big Endian：

```
BigInteger bi = BigInteger.valueOf(exampleInt);
final byte[] shortestSigned = bi.toByteArray(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T23:56:46.023

如果您需要表示整个 2^32 个现有的 4 字节整数，则需要在以下选项中进行选择：

*   固定大小的表示，总是使用 4 个字节；或者
*   可变大小表示，对于某些数字至少使用 5 个字节。

看看 UTF-8 如何对 Unicode 字符进行编码，您可能会有所了解。（您使用一些短前缀来描述必须为该 unicode 字符读取多少字节，然后您读取那么多字节并解释它们）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T12:40:21.263

如果我理解正确，你真的非常想节省空间，即使以奥术位改组为代价：任何数组类型都是不必要的奢侈品，因为你不能使用少于一个完整字节的长度 = 寻址空间 256，而你知道在大多数将需要 4 个。所以我会为长度和符号标志保留 4 位，并将其余的与该字节数对齐。如果您的 MSB 小于 128，您甚至可以再节省一个字节。我认为符号标志对于用小于 4 个字节表示负数的能力也很有用。最好每次都有这个位（即使是正数）而不是 4 个字节的开销来表示 -1。

无论如何，在您对数据集进行一些统计、实际可压缩的整数数量以及压缩开销是否值得付出努力之前，这一切都是虚无缥缈的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-06T23:58:11.333

将您转换`int`为 4 `byte`s 数组，并对其进行迭代，如果每个高位字节都为零，则将其从数组中删除。

就像是：

```
byte[] bytes = toBytes(myInt);
int neededBytes = 4;
for (;neededBytes > 1; i--) {
    if (bytes[neededBytes - 1] != 0) {
       break;
    }
}

byte[] result = new byte[neededBytes];
// then just use array copy to copy first neededBytes to result. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-07T00:25:32.323

你可以从这样的事情开始：

```
byte[] Convert(int i)
{  // warning: untested
  if (i == 0)
    return new byte[0];
  if (i > 0 && i < 256)
    return new byte[]{(byte)i};
  if (i > 0 && i < 256 * 256)
    return new byte[]{(byte)i, (byte)(i >> 8)};
  if (i > 0 && i < 256 * 256 * 256)
    return new byte[]{(byte)i, (byte)(i >> 8), (byte)(i >> 16)};
  return new byte[]{(byte)i, (byte)(i >> 8), (byte)(i >> 16), (byte)(i >> 24)};
} 
```

您需要决定是小端还是大端。请注意，负数以 4 个字节编码。

# php - 使用 mySQL 进程 ID 定位发出查询的 PHP 脚本

> ID：11371072
> 
> 赞同：2
> 
> 时间：2012-07-06T23:55:10.493
> 
> 标签：php, mysql

我们正在尝试找到一个 PHP 脚本，该脚本正在组装一个查询并造成严重破坏。到目前为止，我们还没有成功使用 grep 来定位脚本。

是否可以使用 mySQL pid`show processlist`来定位发出查询的 PHP 脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:03:34.183

不要这么想。很大程度上取决于实际的架构和拓扑。

也许——这也可能具有极大的破坏性，具体取决于上下文——您可以尝试覆盖 mysql_query 函数（或各种脚本中使用的任何包装器），以便识别行为不端/恶意查询并记录所有相关信息.

见： http: [//no2.php.net/runkit_function_redefine](http://no2.php.net/runkit_function_redefine)

由于日志记录将在破坏性脚本的“内部”进行，因此可以获得更多信息。

另一种可能性是过滤 MySQL 查询并在脚本中引发一些可识别的行为，例如等待很长时间或抛出错误。这可以通过 MySQL 代理实现：[https ://launchpad.net/mysql-proxy](https://launchpad.net/mysql-proxy)

假设脚本是恶意的，无法定位它可能指向某种加密 - 通常此类脚本大量使用 eval()、base64_decode 和有时 gzuncompress()。寻找这些函数可能比搜索查询片段更有效率。

一个有用的技巧，现在不是很有用，可能是用暴露的注释“装饰”查询，例如，“SELECT ... WHERE ...; -- 012345”：“-- 012345”部分将被 MySQL 忽略, 但可以很容易地记录下来，并且 grepping "-- 012345" 会很快找到目标。

# c# - 什么时候应该使用 params Object[] 与 Dictionary ?

> ID：11371074
> 
> 赞同：5
> 
> 时间：2012-07-06T23:55:35.417
> 
> 标签：c#, .net, params

我将 API 定义为我们将调用的接口，`IFoo`并且我想定义一个方法`Bar()`

此方法`Bar()`将采用一个必需的参数，然后采用任意数量的其他参数。这些其他论点的解释将取决于实现者`IFoo`

`params`对于这种情况，使用或使用`Dictionary<String, Object>`例如定义我的界面是否更合适

```
public interface IFoo
{
   bool Bar(String id, params Object[] params);
} 
```

或者

```
public interface IFoo
{
   bool Bar(String id, Dictionary<String, Object> params);
} 
```

似乎前者对用户来说更容易调用，但后者的意图更明确，因为对于前者，您必须以特定顺序指定参数，以便实现正确解释它们，而对于后者，您本质上是做命名参数。

所以问题：

*   我应该使用哪种形式（以及为什么？） - 其中一种被认为是最佳实践而不是另一种？
*   一种风格与另一种风格相比是否有我应该注意的特定优势？其中之一是否被认为是代码异味？
*   是否有另一种模式可以以不同/更好的方式实现相同的目标？

作为记录，我知道 .Net 4.0 中的[命名参数](http://msdn.microsoft.com/en-us/library/dd264739.aspx)，但此代码需要在 .Net 3.5 上编译，因此不能使用任何 .Net 4.0+ 功能

### 编辑

只是为了添加更多关于我`IFoo`和`Bar()`方法实际代表的细节，因为有人问过。

`IFoo`代表一些存储子系统，`Bar()`实际上是一个创建操作。取决于存储子系统`Bar()`，可能不需要除 ID 以外的参数，也可能需要许多参数。

### 编辑 2

因此，为了回应@Kirk Woll 的评论和@Fernando 的回答，这里有更多信息。

我可能永远不会调用`IFoo.Bar()`自己，这个接口是开源框架的一部分。3rd 方开发人员将实施`IFoo`，最终用户将调用它的特定实例，这样做的`IFoo`目的是让用户更容易在存储子系统之间迁移他们的应用程序，因为他们可以编码到接口而不是特定实现，只要人为可能。

在最简单的情况下，底层存储子系统只有一种形式的存储，因此除了 ID 之外不需要其他参数。在复杂的情况下，存储子系统可以允许多种类型的存储，并且每种类型的存储可以允许任意复杂的配置参数集，例如索引大小、持久性、事务行为、索引策略、安全性和 ACL 考虑等。

我同意@Fernando 的观点，也许更多的多态性可能是有意义的，也许多态性与泛型和类型限制相结合可能是最好的，例如

```
public interface IFoo
{
  bool Bar<T>(T parameters) where T : IBarConfig;
}

public interface IBarConfig
{
  String ID { get; set; }
} 
```

然后使用这样的实现：

```
public class MyFoo
{
  bool Bar<T>(T config) where T : MyBarConfig
  {
    //Implementation
  }
}

public class MyBarConfig : IBarConfig
{
  public String ID { get; set; }

  public long IndexSegmentSize { get; set; }

  //Etc...
} 
```

这不是我的想法，所以不确定用不同的类型限制定义是否真的合法，`Bar()`然后`MyFoo`是它实现的接口？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T00:05:34.113

您需要决定是否需要搜索或能够从参数集合/数组中检索对象。

使用时 `Object[] params`，对象上没有索引。您需要迭代整个集合以找到一个项目（通过它的键）。

使用 a 时`Dictionary<String, Object>`，您的对象由它们的键索引，并且它总是很容易通过键搜索/查询。

根据您的需要，您需要决定您的方法。

**字典的搜索速度更快，但创建索引会产生开销。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T00:19:44.103

与 Dictionary 相比，如果您需要内联编写它们，params 提供了更容易编写/读取的代码。即，为每次调用 String.Format 构建字典 - 代码将不可读。另一方面，如果您已经有参数字典 - 可以使用它。

我建议重新考虑 API，看看你是否可以接受`IEnumerable`，甚至更好地`IEnumerable<T>`作为参数。不幸的是，使用这种通用的 IFoo 示例名称，无法查看这种方法是否有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T01:39:17.110

字典方法还有另一个问题：错别字。您可能需要定义很多常量作为键来避免这个问题。

为什么不采用多态解决方案？

```
public interface IFoo {
    void Bar(FooData data);
}

public abstract class FooData {
     public int Id {get;set;}
}

public class MyFooData1 : FooData {
    public string SomeProperty {get;set;} 
    //...
}

public class MyFoo : IFoo {
    public void Bar(FooData data) {
        var myData = (MyFooData1)data;
        //...
    }
}

public class MyFooData2 : FooData {
    public int SomeOtherProperty {get;set;}
    //...
}

public class MyFoo2 : IFoo {
    public void Bar(FooData data) {
        var myData = (MyFooData2)data;
        //...
    }
} 
```

您最终会得到更多更小的类，但它们很容易测试和扩展。

**更新**

@RobV如果你正在实现一个接口，你不能改变类型限制，但是，如果你把你的类型参数放在接口声明中，你可以完成你想要做的事情：

```
public interface IFoo<T> where T : IBarConfig {
    void Bar(T parameters);
}

public class MyBarConfig: IBarConfig {
    public String ID { get; set; }
    public long IndexSegmentSize { get; set; } 
}

public class MyFoo : IFoo<MyBarConfig> {
  public void Bar(MyBarConfig config) {
    //Implementation
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T00:19:23.547

我应该使用哪种形式（以及为什么？） - 其中一种被认为是最佳实践而不是另一种？---> 你应该使用第二个，因为它比第二个更不容易出错。

关于替代模式，肯定有一种方法可以更好地实现这一点。你能告诉我们你的问题实际上是什么吗？而不是使用 IFoo 和 Bar？除非我确切地知道您要做什么，以及为什么...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T01:22:10.340

您提到可选参数的事实使我认为该`IDictionary<string,object>`方法会更好-这是在.Net 3.5中提供这种接口的最佳方法。您*可以*只请求对象并执行类似于 MVC 对 htmlAttributes 所做的事情（使用反射将匿名对象转换为`IDictionary<string,object>`）。

我更喜欢这种`params object[]`方法的情况是，在每种情况下都试图给他们起名字会很奇怪/不可能，比如 for `string.format`.

# html - 如何保存 HTML5 或 trigger.io 应用程序的地理位置数据以供以后进行路径映射？

> ID：11371076
> 
> 赞同：0
> 
> 时间：2012-07-06T23:55:42.850
> 
> 标签：html, geolocation, trigger.io

我正在创建一个需要跟踪用户位置的应用程序（根据他们的知识，就像一个正在运行的应用程序），以便我以后可以向他们展示他们的路线。我是否应该使用具有一定超时间隔的 HTML5 每 N 秒保存一次坐标，如果是，我应该多久保存一次数据以及我应该如何保存（本地使用本地存储或将其发布到服务器？）

另外，显示用户后来去过的地图的最简单方法是什么？

有没有人做过这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T11:40:49.063

超时间隔`forge.geolocation`取决于您和应用程序响应能力的平衡。此外，网络流量很昂贵。所以也许你可以缓冲......说最后10个地理位置......然后批量发送Http post（或其他......见下面的Parse）？既然地理数据听起来像临时设备数据，为什么需要坚持使用`forge.prefs`？除非您可能需要应用程序“离线”工作？

对于永久存储，我会通过他们的 Javascript 或 REST Api将[Parse](https://parse.com/docs/)（慷慨的免费计划）及其类视为一种可能的解决方案。`Parse.GeoPoint`他们有一些漂亮的方法，比如 (kilometersTo, milesTo, radiansTo) - [https://parse.com/docs/js/symbols/Parse.GeoPoint.html](https://parse.com/docs/js/symbols/Parse.GeoPoint.html)

# java - 编写 IntelliJ Scala 插件插件？

> ID：11371085
> 
> 赞同：1
> 
> 时间：2012-07-06T23:56:52.407
> 
> 标签：java, scala, plugins, intellij-idea

鉴于 Scala 支持本身就是 intellij 中的一个插件，有没有办法利用现有的 Scala 功能编写 intellij 插件？

支持解析 Scala、获取 AST、遍历类/特征层次结构等应该已经是 scala 插件的一部分，我想知道我是否可以从一开始就利用所有这些细节而无需自己重做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-22T15:57:07.317

这是可能的，因为 Intellij 插件可以相互依赖

参见例如[http://plugins.intellij.net/plugin/?idea&pluginId=7080](http://plugins.intellij.net/plugin/?idea&pluginId=7080)和[http://plugins.intellij.net/plugin/?idea&pluginId=5007](http://plugins.intellij.net/plugin/?idea&pluginId=5007)

# php - 如何动态添加表格行并使用 jQuery 加载动态组合框

> ID：11371087
> 
> 赞同：1
> 
> 时间：2012-07-06T23:57:09.590
> 
> 标签：php, jquery, mysql

我正在构建一个需要多个可选条目的表单，例如动态组合框。我所拥有的基本上是这样的：

图片： [http ://twitpic.com/a4ph8x](http://twitpic.com/a4ph8x)

每次用户按下“新行”按钮时，应将带有动态组合框和其他输入的新表单输入行添加到表单中，我该如何在 jQuery 中执行此操作？

我很抱歉问了这么一个基本的问题，但我对 jQuery 仍然很熟悉，我可以用 PHP 做到这一点，但我确信 Javascript / jQuery 在这里扮演更合适的角色。

谢谢！

代码： [http ://www.4shared.com/file/BCaFsfC9/code.html](http://www.4shared.com/file/BCaFsfC9/code.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T08:10:23.643

当然，Jquery 可以很好地做到这一点。

只需在单击时传递一个函数说：单击该按钮时的 addNewRow() 并将新行附加到 html 中。

例如

```
function addNewRow()
{
$('.form').append('<input type="text" />');
} 
```

# ant - Ant：如何使用具有相同源文件和目标文件的应用任务

> ID：11371104
> 
> 赞同：0
> 
> 时间：2012-07-06T23:59:52.330
> 
> 标签：ant

我正在尝试使用以下命令运行应用任务：

```
 jpegtran.exe -copy none -optimize -perfect ./images/file.jpg ./images/file.jpg 
```

我想将它递归地应用于所有图像。我尝试了以下 ant 代码，但 jpegtran 说参数无效。

```
<target name="optimize.images.jpg">
    <apply executable="jpegtran.exe" dir="${SRC_DIR}/public/assets/" parallel="false" verbose="true" resolveexecutable="true" force="true" vmlauncher="true">
        <arg value="-copy none"/>
        <arg value="-optimize"/>
        <arg value="-perfect"/>
        <srcfile/>
        <targetfile/>
        <fileset dir="${SRC_DIR}/public/assets/images" casesensitive="yes">
            <include name="**/*.jpg"/>
        </fileset>
        <mapper type="identity"/>
    </apply>
</target> 
```

我的 ant 代码有什么问题？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-07T00:12:29.607

需要更改的一项`<arg>`是`-copy none`. 由于参数中有空格，因此请使用`line`属性而不是`value`. 请参阅 Apache Ant[命令行参数](http://ant.apache.org/manual/using.html#arg)。

```
<target name="optimize.images.jpg">
  <apply executable="jpegtran.exe" dir="${SRC_DIR}/public/assets/" 
    parallel="false" verbose="true" resolveexecutable="true" force="true" 
    vmlauncher="true">

    <arg line="-copy none"/>
    <arg value="-optimize"/>
    <arg value="-perfect"/>
    <srcfile/>
    <targetfile/>
    <fileset dir="${SRC_DIR}/public/assets/images" casesensitive="yes">
      <include name="**/*.jpg"/>
    </fileset>
    <mapper type="identity"/>
  </apply>
</target> 
```

# objective-c - 如何指定 Restkit 对象管理器来执行 POST

> ID：11371105
> 
> 赞同：1
> 
> 时间：2012-07-06T23:59:59.787
> 
> 标签：objective-c, ios, restkit

我正在尝试使用 ios Restkit 发送 POST 请求。我可以执行 GET，但找不到如何发送 POST。

我当前的代码如下所示：

```
RKURL *URL = [RKURL URLWithBaseURL:[objectManager baseURL] resourcePath:@"/users/sign_in.json" queryParameters:params];

[objectManager loadObjectsAtResourcePath:[NSString stringWithFormat:@"%@?%@", [URL resourcePath], [URL query]]  delegate:self]; 
```

显然，这执行了一个 GET。知道我应该添加什么使其成为 POST 吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T16:02:47.110

您可以使用以下方式配置您的 RKRequest：

```
[request setMethod:RKRequestMethodPOST]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T06:49:11.923

要回答您的问题（无论上述讨论如何），您可以执行以下操作：

```
[objectManager loadObjectsAtResourcePath: @"path" usingBlock: ^(RKObjectLoader *loader) {
    loader.HTTPMethod = RKRequestMethodPOST;
}]; 
```

# php - action="" 在 WordPress 中不起作用

> ID：11371107
> 
> 赞同：2
> 
> 时间：2012-07-07T00:00:29.333
> 
> 标签：php, forms, wordpress, action

我正在尝试使用 WordPress 中的自定义页面模板制作自定义联系表单。当我使用

```
<?php echo $_SERVER['PHP_SELF']; ?> 
```

它从联系页面到索引页面。当我让动作空着时

动作=""

它给了我一个错误。谁能给我一些见解？如果你愿意，我可以发布整个页面。我阅读了类似的帖子，但没有找到可靠的答案。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T10:57:44.987

使用`$_SERVER['REQUEST_URI']`而不是 PHP_SELF。WordPress 将所有内容重写为 index.php，因此您需要发布到当前 url 而不是 index.php。

# php - 将 where 子句添加到数据表过滤

> ID：11371116
> 
> 赞同：1
> 
> 时间：2012-07-07T00:01:10.413
> 
> 标签：php, jquery, mysql, datatables

您好我正在尝试在我的数据表服务器端处理文件中添加自定义 WHERE 子句。我设法让它在页面加载时工作，但在过滤后它会忽略 where 子句并返回所有结果。

代码：

```
$sWhere = "WHERE customers_id= ".$customersId;
if ( isset($_GET['sSearch']) && $_GET['sSearch'] != "" )
{
    $sWhere = "WHERE (";
    for ( $i=0 ; $i<count($aColumns) ; $i++ )
    {
        if ( isset($_GET['bSearchable_'.$i]) && $_GET['bSearchable_'.$i] == "true" )
        {
            $sWhere .= "`".$aColumns[$i]."` LIKE '%".mysql_real_escape_string( $_GET['sSearch'] )."%' OR ";
        }
    }
    $sWhere = substr_replace( $sWhere, "", -3 );
    $sWhere .= ')';
}

/* Individual column filtering */
for ( $i=0 ; $i<count($aColumns) ; $i++ )
{
    if ( isset($_GET['bSearchable_'.$i]) && $_GET['bSearchable_'.$i] == "true" && $_GET['sSearch_'.$i] != '' )
    {
        if ( $sWhere == "" )
        {
            $sWhere = "WHERE ";
        }
        else
        {
            $sWhere .= " AND ";
        }
        $sWhere .= "`".$aColumns[$i]."` LIKE '%".mysql_real_escape_string($_GET['sSearch_'.$i])."%' ";
    }
} 
```

我不知道在哪里添加其他 WHERE 子句，以便它在被过滤时也能工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:12:00.053

删除第一行并将其添加到末尾（在`if`and之后`for`）：

```
$sWhere .= ($sWhere ? ' AND ' : ' WHERE ') . 'customers_id = ' . $customersId; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T05:47:28.590

最终解决它是解决方案：

```
$sWhere = "WHERE customers_id=".$customersId;
if ( isset($_GET['sSearch']) && $_GET['sSearch'] != "" )
{
    $sWhere = "WHERE (";
    for ( $i=0 ; $i<count($aColumns) ; $i++ )
    {
        if ( isset($_GET['bSearchable_'.$i]) && $_GET['bSearchable_'.$i] == "true" )
        {
            $sWhere .= "`".$aColumns[$i]."` LIKE '%".mysql_real_escape_string( $_GET['sSearch'] )."%' OR ";
        }
    }
    $sWhere = substr_replace( $sWhere, "", -3 );
    $sWhere .= ') AND customers_id='.$customersId;
    //var_dump($sWhere);
} 
```

仅在这两个位置需要该代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-15T11:40:46.877

试试这个

```
/* LINE 86
    $sWhere = "";
        if ( isset($_GET['sSearch']) && $_GET['sSearch'] != "" )
        {
                $sWhere = "WHERE (";
                for ( $i=0 ; $i<count($aColumns) ; $i++ )
                {
                        $sWhere .= $aColumns[$i]." LIKE '%".mysql_real_escape_string( $_GET['sSearch'] )."%' OR ";
                }
                $sWhere = substr_replace( $sWhere, "", -3 );
                $sWhere .= " AND customer_id='".$_GET['customer_id']."'";
                $sWhere .= ')';
        }else{
                $sWhere = "WHERE customer_id='".$_GET['customer_id']."'";
        } 
```

我希望这能解决你的目的。

# java - 从 Java Servlet 接收 Actionscript 3 中的 ByteArray

> ID：11371117
> 
> 赞同：0
> 
> 时间：2012-07-07T00:01:35.967
> 
> 标签：java, actionscript-3, servlets, request, bytearray

我正在输入一个问题，但最后我解决了问题并且不想折腾它（并受到[https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your -own-questions/](https://blog.stackoverflow.com/2011/07/its-ok-to-ask-and-answer-your-own-questions/)），并决定分享我的问题解决方案。

问题是我想从 Java 应用程序服务器中检索一些字节，这意味着，通过 Servlet 加载到 Flash 游戏中以获得重播功能。

有一些问题试图解决其他方式的问题，即从 as3 到服务器（php、java 等）：[如何通过 Java 将二进制数据从 AS3 发送到文件系统？](https://stackoverflow.com/questions/10096774/how-to-send-binary-data-from-as3-through-java-to-a-filesystem),[我怎样才能发送一个 ByteArray（从 Flash）和一些表单数据到 php？](https://stackoverflow.com/questions/597947/how-can-i-send-a-bytearray-from-flash-and-some-form-data-to-php),[通过 URLRequest 上传 bytearray](https://stackoverflow.com/questions/7298842/uploading-bytearray-via-urlrequest)并将[ByteArray 推送到 POST](https://stackoverflow.com/questions/9236808/pushing-bytearray-to-post)。我没有找到类似我正在分享的内容（如果我错了，请纠正我）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T09:39:42.320

好吧，正如我在问题中所说，StackOverflow 鼓励我回答，这里是：

提供字节数组的 Servlet doGet 方法：

```
protected void doGet(HttpServletRequest req, HttpServletResponse resp)
        throws ServletException, IOException {

   MouseInput oneInput = getMouseInput(); //abstracted (I'm using google appengine)
   byte[] inputInBytes = oneInput.getInBytes();
   OutputStream o = resp.getOutputStream();
   o.write(inputInBytes);
   o.flush();
   o.close();
} 
```

MouseInput.getInBytes 方法体：

```
 ByteArrayOutputStream baos = new ByteArrayOutputStream();
   DataOutputStream dos = new DataOutputStream(baos);

   dos.writeInt(this.type);
   dos.writeDouble(this.localX);
   dos.writeDouble(this.localY);
   dos.writeBoolean(this.buttonDown);

   return baos.toByteArray(); 
```

我的 Actionscript 代码接收字节数组数据：

```
var url:String = "http://localhost:8888/input"; //servlet url
var request:URLRequest = new URLRequest(url);

//get rid of the cache issue:
var urlVariables:URLVariables = new URLVariables();
urlVariables.nocache = new Date().getTime();
request.data = urlVariables;
request.method = URLRequestMethod.GET;

var loader:URLLoader = new URLLoader();
loader.dataFormat = URLLoaderDataFormat.BINARY;

loader.addEventListener(Event.COMPLETE, function (evt:Event) {
    var loader:URLLoader = URLLoader(evt.target);

    var bytes:ByteArray = loader.data as ByteArray;
    trace(bytes); //yeah, you'll get nothing!

    //the bytes obtained from the request (see Servlet and 
    //MouseInput.getInBytes method body code above) were written in 
    //the sequence like is read here:           
    trace(bytes.readInt());
    trace(bytes.readDouble());
    trace(bytes.readDouble());
    trace(bytes.readBoolean());
}
loader.addEventListener(IOErrorEvent.IO_ERROR, function (evt:Event) {
    trace("error");
});

loader.load(request); 
```

好吧，它有效！显然你可以做一些调整，比如不使用匿名功能更好地阅读，但说明它是可以的！现在，我可以使用 ByteArray 而不是我尝试的繁重的 XML，为游戏重播功能（用于调试目的）节省一些内存。

希望它有所帮助，任何批评者都会受到赞赏！

干杯

# php - 数据库中的转义值 ('\s)

> ID：11371118
> 
> 赞同：0
> 
> 时间：2012-07-07T00:02:09.420
> 
> 标签：php, security, codeigniter

我正在使用codeigniter，我所做的基本上是：

```
$val = $this->db->call_function('real_escape_string', $this->input->post('name')); 
```

这就是我在放入数据库之前对数据所做的一切。当有人像 O'hara 这样输入值时，在数据库中它会像 O\'hara

所以，我想我可以在输出上加上斜杠，但这是在数据库中转义和存储数据的常用方法吗？

**已解决** Active Records 转义查询，所以我使用 'real_escape_string' 函数进行双重转义

所以我想我根本不需要使用 real_escape_string，活动记录就是这样做的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:08:24.947

'\' 称为转义字符，必须使用它之后的下一个字符（在您的情况下为 '）不会干扰 SQL 语句。但是，如果您使用 CI，它应该会为您处理所有这些。我相信您可以使用“HTML 助手”来格式化或删除输出文本上的斜线。即使那样，但我可能是错的，当从 CI 中的数据库输出值时，斜杠将自动被剥离。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:05:49.977

转义引号和特殊字符是记录存储的常规做法和预期，因为它有助于确保您的代码可以准确存储和提取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T00:08:14.530

转义 SQL 查询的字符串以便您可以将实际值输入数据库。

SQL 查询中的值看起来像`O\'hara`，但最终在数据库中的值是`O'hara`.

因此，当您显示该值时，您根本不需要做任何事情。当然，除了为您显示它的环境转义它。如果它显示在 HTML 文档中，您将对其进行 HTML 编码。这不会更改撇号 ( `'`)，但会更改其他字符，例如`<`and `>`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T00:08:50.933

直接使用

```
$val = real_escape_string($this->input->post('name')); 
```

# java - 在 Android 中签署数据并在 python 中验证它

> ID：11371120
> 
> 赞同：2
> 
> 时间：2012-07-07T00:02:23.130
> 
> 标签：java, android, python, digital-signature

我已经编写了以下代码来在 android 中签署数据：

```
import java.security.KeyFactory;
import java.security.KeyPair;
import java.security.KeyPairGenerator;
import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.Signature;
import java.security.spec.RSAPublicKeySpec;

import android.app.Activity;
import android.os.Bundle;

public class TestActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
            setContentView(R.layout.main);

        try{
        String m ="This is my message";
        System.out.println(m);

        KeyPairGenerator keyPairGen = KeyPairGenerator.getInstance("RSA");
        keyPairGen.initialize(1024);
        KeyPair kp = keyPairGen.generateKeyPair();
        PrivateKey priKey = kp.getPrivate();
        PublicKey pubKey = kp.getPublic();

        KeyFactory keyFactory = KeyFactory.getInstance("RSA");
        RSAPublicKeySpec publicKeySpec = keyFactory.getKeySpec(pubKey, RSAPublicKeySpec.class);

        System.out.println("WITH toString: ");
        System.out.println("Mod :" + publicKeySpec.getModulus().toString());
        System.out.println("Exp :" + publicKeySpec.getPublicExponent().toString());
        System.out.println("PublicKey:" + pubKey.toString());

        System.out.println("PublicKey:" + pubKey);
        System.out.println("PublicKey Base64:" +MyBase64.encode(pubKey.getEncoded()));

        Signature instance = Signature.getInstance("SHA1withRSA");
        instance.initSign(priKey);
        instance.update(m.getBytes());
        byte[] signature = instance.sign();
        System.out.println("Signature: " + MyBase64.encode(signature));
        }catch(Exception e){
            e.printStackTrace();
        }

    }
} 
```

我将 adb logcat 中的粘贴值复制到 python 中，并使用以下命令在 python 中验证它：

```
mod=#I paste mod here
exp=#I paste exp here
signature=#I paste signature here

message="This is my message"

publicKey = RSA.construct((mod,exp))
print 'PublicKey Base64: ' + publicKey.exportKey()
print str(publicKey)
test = SHA.new(message)
verifier = PKCS1_v1_5.new(publicKey)
signature_base = base64.b64decode(signature)
print "Verification: " + str(verifier.verify(test, signature_base)) 
```

我发现 MyBase64.encode(pubKey.getEncoded()) （在 java 中）与 publicKey.exportKey() （在 python 中）相同

但是，验证结果总是错误的。

如果我使用 javac 运行 java 代码，它似乎工作正常。

任何帮助，可能出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:26:23.033

通常，此类错误与潜入数据字符串中的额外空格有关。在计算哈希之前尝试剥离它。

# java - JMX“仪表板”应用程序

> ID：11371121
> 
> 赞同：2
> 
> 时间：2012-07-07T00:02:58.357
> 
> 标签：java, web-applications, jmx

过去几天我一直在玩 JMX，虽然我不*介意*JConsole 或标准的 JMX Web 管理工具，但创建我自己的 Web 应用程序以某种方式查询已注册的 JMX MBean 并呈现一个不错的、带有图表和图形的丰富 UI 风格的“仪表板”；JMX 控制台或 JConsole 根本没有的东西。

这可能吗？我听说过一种叫做 JMX“代理”的东西，但不确定这是否与仪表板式应用程序如何查询和管理 JMX 有关。提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-09T18:51:05.487

[Jolokia](http://www.jolokia.org)是一种基于代理的 JMX 方法，它将 JMX 本地调用转换为 JSON-over-HTTP。它带有一个非常适合在浏览器中使用的[Javascript库。](http://www.jolokia.org/client/javascript.html)有关网页中的示例用法，请查看[Jolokia-Cubism 集成](http://www.jolokia.org/client/javascript-cubism.html)的演示，或者更好地查看 Tomasz Nurkiewicz 的[博客文章](http://nurkiewicz.blogspot.de/2011/03/jolokia-highcharts-jmx-for-human-beings.html)，该文章提供了一个非常好的使用 Jolokia 和 Highcharts 图形库的示例。

说了这么多，还有更多： Jolokia 的漂亮妹妹[Ají](https://github.com/rhuss/aji)已经作为一个项目启动，它将提供一个与 Jolokia 客户端捆绑在一起的 JMX 控制台。我还在整理东西（嗯，它移动得很慢......），但我认为在夏天会有更多的东西。人们已经可以玩弄它了，我们仍在寻找志愿者（提示 ;-) ....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T04:13:52.733

除非你真的想自己做，否则你想做的事情可能已经建成。你以前看过 VisualVM 吗？我真的很喜欢[http://visualvm.java.net/mbeans_tab.html/](http://visualvm.java.net/mbeans_tab.html/)

要编写自己的远程管理 MBean 的应用程序，我认为您可以从本教程开始。似乎是一个很好的起点。

[http://docs.oracle.com/javase/tutorial/jmx/remote/custom.html](http://docs.oracle.com/javase/tutorial/jmx/remote/custom.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-05T14:44:25.647

这里的评论之一是 VisualVM 是一个分析器。VisualVM 不是分析器，它是构建在 NetBeans 平台之上的平台。该平台支持以多种方式连接到正在运行的 VM，包括使用 JMXConnector 连接到 MBeanPlatformServer、可服务性代理 (SA)、按需附加等。

VisualVM 确实包含 2 个不同的分析器，但还有一个 MBean 插件允许您查看和操作已向 MBeansPlatformServer 注册的 MBean。

VisualVM 中的许多视图从注册到 MBeansPlatformServer 的 java.lang.management 包中的 MXBean 中抓取数据。其中许多 MXBean 是 SA 的包装器，SA 是 HotSpot 的一个组件，它维护一组性能计数器。例如，计数器可以为您提供有关 JIT 编译器活动、GC 活动甚至主机平台 CPU 利用率等的一些信息。

您可以轻松构建自己的插件来查看或操作 MBean。此处帖子中提到的教程是有关如何完成它的信息来源之一。我编写了一个演示 VisualVM 插件，它查看来自 MemoryPool MXBeans 的数据。该插件已被其他人扩充以执行许多其他操作。所有代码都可以在 java.net 项目 MemoryPoolView 中找到。它涵盖了读取数据。然而，执行功能实际上只是使用您正在与之交互的 MBean 所需的参数针对 JMXConnector 执行一个方法。IOWs，这是插件的一个相当简单的扩展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-15T23:01:54.267

[HawtIO](https://github.com/hawtio)是关于最好的即插即用的，开箱即用的解决方案，用于在网页上获取 JMX 内容。您可以将多个 mbeans 放在同一页面上并一次查看它们，它可以在浏览器中运行，您不必自己编写一堆前端代码，并且可以在不打开您的奇怪端口的情况下完成IT部门会感到紧张。与简单拖放界面一起使用的数据可视化选项非常少，但有用于编写更高级插件的文档。

后端使用 Jolokia 在 JMX 上放置一个 HTTP REST 接口，这对于您可能看到的任何解决方案都可能是正确的。

# java - Java如何能够从方法中传递参数

> ID：11371126
> 
> 赞同：0
> 
> 时间：2012-07-07T00:04:02.390
> 
> 标签：java, android

我遇到了一些我无法理解并且从未意识到可以做到的事情。

我在 Android 中玩过这段代码，让我感兴趣的是：

```
public boolean onTouch(View v, MotionEvent event){
    Rect outRect = new Rect();
    _btn.getHitRect(outRect);
    // ... rest of code cut
    // outRect fields of that Rect object is 'filled' in.
} 
```

Android的Java如何可以直接修改传递给方法的`Rect`对象`outRect`以获得`Rect`按钮小部件的。

这让我感到惊讶，因为我认为在 Java 中没有“*按引用传递*”之类的东西，用 Java 的说法，使用“*按引用调用*”，而是使用“*按值传递*”或“按值*调用*” ?

是的，我之前读过这个[问题](https://stackoverflow.com/questions/40480/is-java-pass-by-reference)，但我很困惑，或者那是 Android 的问题？

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T00:06:22.870

在对象的情况下，地址是一个值，该值被复制，类似于原始值。但它是一个指向对象的值，并且该对象不会被复制。它在内存中只存在一次并且可以被操作。![在此处输入图像描述](../Images/8a77bbd84608f6ee298f554de0fc7650.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T00:08:15.607

`outRect`引用被传递给该`getHitRect`方法，然后该方法修改由 引用的对象`outRect`。引用是按值传递的。

有关这方面的详细说明，请阅读这篇文章：http: [//javadude.com/articles/passbyvalue.htm](http://javadude.com/articles/passbyvalue.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T00:10:50.160

对 Rect 对象的引用是按值传递的，但 Rect 对象本身是在堆上分配的，因此可以对其进行更新。实际上，这为您提供了按引用传递的语义。但是，您不能更改参考；换句话说，这样的事情是行不通的：

```
public void someFunction(Rect r) {
  r = new Rect(); // will not be seen by the calling function
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T00:14:32.583

您链接到的问题的评分最高的答案非常清楚地解释了这一点：

> Java 始终是按值传递的。很难理解 Java 将对象作为按值传递的引用来传递。

然后它继续展示两个例子，这些例子在你所询问的行为中没有留下任何谜团，除非我误解了让你感到惊讶的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-07T00:21:44.820

Java 中方法的所有参数都是按值传递的，包括原语和对象。但是，Java 中引用对象的方式更接近于 C++ 指针而不是值。例如，考虑 Java 中的任何对象值都可以取值`null`，但在 C++ 中只有指针取值`null`（而对象和引用*始终是有效的初始化值）。

但是对象值的按值传递实际上意味着什么？这意味着创建一个对象的副本并将其压入堆栈以供调用的方法使用。而对于指针，它意味着将指针值压入堆栈。这样，调用和被调用的方法都可以访问存储对象值的相同内存位置。因此，在被调用方法中执行的任何更改都将反映在调用方法中。

* 在某些情况下，引用可能包含损坏的数据。

# javascript - 通过 ID 获取元素，为 Sencha 控制器返回 null

> ID：11371133
> 
> 赞同：0
> 
> 时间：2012-07-07T00:05:13.550
> 
> 标签：javascript, controller, sencha-touch-2, document, getelementbyid

这是我想要的控制器

```
 Ext.define('GS.controller.PickStorageController', {
  extend: 'Ext.app.Controller',
  id: 'pickStorageControl', 
```

在启动功能中，我让它打印了它的 id

```
 launch: function() 
  {
    console.log(this.id);
  }, 
```

这是输出：pickStorageControl

在我的代码中，（在控制器的所有启动功能完成后）我有这个： `document.getElementById('pickStorageControl');` 这显然是空的。

我该如何解决？？

在你说我应该使用 refs 和控件之前，我需要它以这种特殊的方式工作，以便稍后执行我的计划......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T03:27:05.167

控制器不会有 id，只有 DOM 元素会有。我不确定您要完成什么，但您仅将 getElementById 用于 DOM 元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T07:49:43.720

获取控制器对象使用此代码

```
GS.app.getcontroller('PickStorageController'); 
```

它会给你控制器对象

# authentication - 从远程机器将文件放在 HDFS 上时如何指定用户名？

> ID：11371134
> 
> 赞同：33
> 
> 时间：2012-07-07T00:05:15.923
> 
> 标签：authentication, hadoop, authorization, hdfs

我有一个 Hadoop 集群设置并在一个常见的默认用户名“user1”下工作。我想从不属于 hadoop 集群的远程机器将文件放入 hadoop。我在远程机器上配置了 hadoop 文件，当

```
hadoop dfs -put file1 ... 
```

从远程机器调用，它将file1放在Hadoop集群上。

唯一的问题是我在远程机器上以“user2”身份登录，这并没有给我预期的结果。其实上面的代码只能在远程机器上执行为：

```
hadoop dfs -put file1 /user/user2/testFolder 
```

但是，我真正想要的是能够将文件存储为：

```
hadoop dfs -put file1 /user/user1/testFolder 
```

如果我尝试运行最后一个代码，hadoop 会因为访问权限而引发错误。无论如何我可以在 hadoop dfs 命令中指定用户名吗？

我正在寻找类似的东西：

```
hadoop dfs -username user1 file1 /user/user1/testFolder 
```

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2013-10-01T20:06:29.877

如果您使用 HADOOP_USER_NAME 环境变量，您可以告诉 HDFS 使用哪个用户名进行操作。请注意，这仅在您的集群未使用安全功能（例如 Kerberos）时才有效。例如：

```
HADOOP_USER_NAME=hdfs hadoop dfs -put ... 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-01-27T16:17:57.677

这对任何人都可能无关紧要，但我为此使用了一个小技巧。

我在 .bash_profile 中导出 HADOOP_USER_NAME，这样每次登录时，都会设置用户。

只需将以下代码行添加到 .bash_profile：

```
export HADOOP_USER_NAME=<your hdfs user> 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-07-07T01:30:54.730

默认情况下，Hadoop 中的身份验证和授权是关闭的。根据[Hadoop - The Definitive Guide](https://rads.stackoverflow.com/amzn/click/com/1449311520)（顺便说一句，好书 - 建议购买）

> Hadoop 在 HDFS 中用于权限的用户身份是通过在客户端系统上运行 whoami 命令来确定的。类似地，组名来自运行组的输出。

因此，您可以创建一个`whoami`返回所需用户名的新命令并将其适当地放入 PATH 中，以便在找到 Linux 附带的实际 whoami 之前找到创建的 whoami。同样，您也可以使用该`groups`命令。

这是一个 hack，一旦打开身份验证和授权，它将无法工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-08-14T03:21:09.737

**外壳/命令方式：**

设置`HADOOP_USER_NAME`变量，执行hdfs命令

```
 export HADOOP_USER_NAME=manjunath
  hdfs dfs -put <source>  <destination> 
```

**Pythonic方式：**

```
 import os 
  os.environ["HADOOP_USER_NAME"] = "manjunath" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T16:42:22.803

还有另一篇与此类似的帖子，可以为您使用通过 ssh 进行流式传输提供解决方法：

```
cat file.txt | ssh user1@clusternode "hadoop fs -put - /path/in/hdfs/file.txt" 
```

有关详细信息，请参阅[将远程文件放入 hadoop 而不将其复制到本地磁盘](https://stackoverflow.com/questions/11270509/putting-a-remote-file-into-hadoop-without-copying-it-to-local-disk)

# javascript - Knockout JS - 数据绑定多个值

> ID：11371138
> 
> 赞同：6
> 
> 时间：2012-07-07T00:05:47.817
> 
> 标签：javascript, knockout.js

关于 JS Knockout 库的问题 - 我有三个输入，所有数据都绑定到同一个变量。两个的布尔值为 false，一个的布尔值为 true。（不幸的是，我不能将它们更改为整数，这会使这个问题更容易）。尽管两个假值输入共享行为，但我需要以某种方式区分它们以触发稍微不同的行为。

是否可以将每个数据绑定到另一个具有不同值的变量？所以不是每个存在

```
 <input data-Bind="checked:test" value="false"> 
```

我会有类似的东西

```
 <input data-Bind="test, test2" value="false, 1"> 
```

和

```
 <input data-Bind="test, test2" value="false, 2">? 
```

我直接试过了，没用，不知道有没有可能。非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T20:10:27.507

您不能直接绑定多个变量，但创建自定义绑定函数可以为您解决问题。

> 示例： http: [//jsfiddle.net/gurkavcu/ePW8Y/](http://jsfiddle.net/gurkavcu/ePW8Y/)
> **更改输入值（true，false）以触发更新功能

HTML

```
<input data-bind="customData: test , v1 : test2"/>
<div>
    <span data-bind ="text : test"/>
</div>
<div>
    <span data-bind ="text : test2"/>
</div> 
```

JS

```
ko.bindingHandlers.customData = {
      init: function(element, valueAccessor, allBindingsAccessor, viewModel) {  
           $(element).change(function () {
                valueAccessor()(element.value);
            });       
      },
       update: function(element, valueAccessor, allBindingsAccessor, viewModel) {
          var value =ko.utils.unwrapObservable(valueAccessor());
          var v1 = allBindingsAccessor().v1;

          if(value === "true") {
             v1("1"); 
             console.log(v1());
          }
          else  if(value === "false") {
             v1("2"); 
             console.log(v1());
          }
     }
};  

function ViewModel() {

    this.test =  ko.observable(false);
    this.test2 =  ko.observable("2");

};

$(function() {  

    var viewModel = new ViewModel();
    ko.applyBindings(viewModel); 

})​ 
```

根据您的需要修改更新功能。您可以使用 v1 : ... 、 v2 : ... 、 v3 : ... 将任意数量的变量添加到绑定中，并通过 allBindingsAccessor().v1 、 allBindingsAccessor().v2 、 allBindingsAccessor().v3 访问它

# javascript - 输入1上的onblur后自动完成/ sql填充输入字段2

> ID：11371148
> 
> 赞同：0
> 
> 时间：2012-07-07T00:06:29.967
> 
> 标签：javascript, jquery, autocomplete

好的，就到这里。基本上我有两个输入字段。第一个像魅力一样工作，我从一个巨大的数据库中自动完成一个名称，选择它后onblur应该通过一个php脚本自动填充输入字段2，在我的数据库中搜索选定的字符串并用尽可能多的命中填充输入字段当它得到。我怎样才能做到这一点？

所以：如果第一个输入的自动完成找到了字符串，因为它已经存储了（同名有多个 id），它应该得到那些 id。如果在第一次输入时在 db 中没有找到字符串，我已经编写了一个自动完成功能，用于在第二个框中手动选择 id，然后提交它们。但现在这并不重要。再说一次，我怎样才能用从第一个输入中找到的数据库中的给定字符串填充第二个输入？到目前为止，我将其作为准系统：

```
<input type="text" size="20" onBlur"" id="firstinput" name="firstinput">
<input type="text" size="40" value="" id="manualorautogroup" name="manualorautogroup"> 
```

json_encodes 结果的 php：

```
$lolz = array();

while( $row = mysql_fetch_assoc($resultset) ) {

$lolz[] = array(
'value' => $row['gameid'],
echo json_encode($lolz);
);
} 
```

我的客户端代码如何调用它并获取要填充到输入 2 的数据？

数据库样本：

游戏ID组名

122 字符串类型输入输入1foundy自动完成

第314章

第513章

第533章

非常感谢 ：）

# php - 声明会话变量php

> ID：11371149
> 
> 赞同：1
> 
> 时间：2012-07-07T00:06:37.183
> 
> 标签：php

在 PHP 中使用任何会话变量之前是否必须使用 session_start()？我在开头没有声明 session_start() 的情况下尝试了以下代码，它工作正常。

所以，现在我很困惑。请帮忙 ！！！！

另外，我没有使用任何 $_POST 或 $_GET 将 $uname 传递给 home.php，但它仍然是如何工作的？如果我们使用 include 'home.php' 那么它会将 login.php 和 home.php 视为同一页面吗？

```
// code login.php//
<?
require_once 'db_connect.php';

if (isset($_SESSION ['user_id']) && !empty($_SESSION ['user_id']))
{

    $u_name = $_SESSION['user_name'];
    include 'home.php';
}
else
{
//some stmt
}
?>

/*******home.php file ****/

<?php
require_once 'dbconnect.php';
$_SESSION['username'] = $u_name;
//echo $_SESSION['username'];
//blah blah
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:08:41.853

如果 php.ini 中没有设置 session.autostart，你肯定需要它。但那时你可能会知道。

你不是在 db_connect.php 中调用它吗？另外，我很确定您不会收到任何错误，会话将是空的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T00:14:01.223

如果您通过 php 包含文件，则 Session 将保持活动状态（也设置任何其他变量）。如果您将作为新请求访问此文件，则需要设置 session_start()。这种行为是因为 include 和 require 的行为就像将包含文件的代码移动到当前文件中一样，就像您将代码键入到一个文件中一样。

另外：您不需要两次要求 dbconnect.php。

编辑：您询问了用作同一页面的两个文件 - 该页面是整个 php 代码完成后给出的输出。页面本身并不关心内部使用了多少文件来生成它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-21T04:04:57.140

php 中的每个会话都必须使用 session_start()。传递一个变量值不需要使 POST 或 GET 相同，因为已经存在值递增的情况。如果在同一个会话中没有ouver值是null或空白，如果你以同样的方式打开页面，则条件错误。

`(!Isset($_SESSION ['user_id']) &&!​Is_Null($_SESSION['user_id']))`

isset 检查是否为空这个需要！之前，`IF(!isset($_SESSION['user_id'])`在第二种情况下，将检查它是否不是无效的，因为会话存在或不存在，以及是否设置了一个值 inesistente 为空。所以正确的看法是这样的：`is_null($_SESSION ['user_id'])`

重要的是，在登录页面中不包括但重定向到该页面。在带有`header`.

或者可以在一个页面中完成所有操作，但在称为登录页面的页面上显示是不合法的。默认是索引，即如果登录位于文件夹中，则将其放置在索引页面和文件夹地址中。

会话仍然可以打开的原因是有时网络服务器没有意识到从系统缓存中删除了部分代码并加载了它。

# matlab - 在 MATLAB 中读取科学计数法制表符分隔的文本文件

> ID：11371152
> 
> 赞同：1
> 
> 时间：2012-07-07T00:07:21.393
> 
> 标签：matlab, file-io, tsv, csv

是否有内置函数可以从 MATLAB 中的制表符分隔的文本文件中读取科学记数法？

一行数据如下所示：

```
-1.52E-01   -1.32E-01   7.20E-02    -6.78E-04   1.97E-04    -1.89E-03   0.00E+00 
```

我试过`tdfread(filename, delimiter)`没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T00:17:44.530

您要查找的命令是`dlmread`.

这是来自 GNU Octave 的帮助条目，它的行为应该类似：

```
DATA = dlmread (FILE)
DATA = dlmread (FILE, SEP)
DATA = dlmread (FILE, SEP, R0, C0)
DATA = dlmread (FILE, SEP, RANGE)
DATA = dlmread (..., "emptyvalue", EMPTYVAL)

  Read numeric data from the text file FILE which uses the delimiter
  SEP between data values.

  If SEP is not defined the separator between fields is determined
  from the file itself.

  The optional scalar arguments R0 and C0 define the starting row and
  column of the data to be read.  These values are indexed from zero,
  i.e., the first data row corresponds to an index of zero.

  The RANGE parameter specifies exactly which data elements are read.
  The first form of the parameter is a 4-element vector containing
  the upper left and lower right corners '[R0,C0,R1,C1]' where the
  indices are zero-based.  Alternatively, a spreadsheet style form
  such as "A2..Q15" or "T1:AA5" can be used.  The lowest alphabetical
  index 'A' refers to the first column.  The lowest row index is 1.

  FILE should be a filename or a file id given by 'fopen'.  In the
  latter case, the file is read until end of file is reached.

  The "emptyvalue" option may be used to specify the value used to
  fill empty fields.  The default is zero.  Note that any non-numeric
  values, such as text, are also replaced by the "emptyvalue".

  See also: csvread, textscan, textread, dlmwrite. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-29T08:53:06.410

你也可以试试：

```
 fid = fopen('yourfile.dat','rt');
    a = fscanf(fid,'%e');
    fclose(fid); 
```

# java - OutputStreamWriter 与 FileWriter

> ID：11371154
> 
> 赞同：30
> 
> 时间：2012-07-07T00:07:56.107
> 
> 标签：java

我不明白这两个类之间的区别。你什么时候用一个而不是一个？我知道 FileWriter 可以将字符输出到文件，但据我所知，OutputStreamWriter 也可以。这是我测试过的一些代码，它们似乎工作相同，我没有添加异常处理的东西，但让我们假设它在那里。

```
FileWriter writer = new FileWriter("C:\\Users\\owner\\Desktop\\demo.txt");
writer.write("hello");
writer.close(); 
```

我也试过这段代码：

```
File file = new File("C:\\Users\\owner\\Desktop\\demo.txt");
os = new OutputStreamWriter(new FileOutputStream(file));
os.write("hello");
os.close(); 
```

这两个对我来说似乎都一样。唯一发生奇怪的事情是当我尝试在 write() 方法中放入一个 int 值。对于 FileWriter 示例，我的 demo.txt 完全是空的。对于 OutputStreamWriter 示例，我的文本文件中有一些奇怪的符号。我正在阅读一本 java 书，我对 OutputStreamWriter 的唯一解释是它“将字符流转换为字节流”，所以我不应该在第二个示例中看到我的文本文件中的一些字节吗？

一些澄清将不胜感激。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-07-07T00:33:46.627

XXXInputStream 和 XXXOutputStream（其中 XXX 不同，有很多选项）处理 8 位字节。例如，`OutputStream.write(byte[] c);`

XXXWriter 或 XXXReader 处理 16 位字符。例如，`Reader.read(char[] cbuf)`。

OutputStreamWriter 将 OutputStream 转换为 Writer。您可能已经猜到了，InputStreamReader 从 InputStream 转换为 Reader。我不知道有任何相反的类，即将 Reader 转换为 InputStream。

FileWriter 是一个与文件对话的 Writer。由于 Java 字符串在内部使用字符（16 位，因此它们可以处理 Unicode），因此 FileWriter 是与 Unicode 字符串一起使用的自然类。

FileOutputStream 是用于将字节写入文件的 OutputStream。OutputStreams 不接受字符（或字符串）。通过将它包装在一个 OutputStreamWriter 中，您现在有了一个接受字符串的 Writer。

现在，真正的问题是，您何时使用 Reader/Writer 以及何时使用 Stream？我已经使用 Java 多年，有时我也会感到困惑。我相信以下是正确的：

**便捷指南 - 如何决定使用哪个：**

1.  如果您正在处理二进制数据（例如图像），请使用 Streams。
2.  如果您使用非 ASCII Unicode 字符，例如中文，请使用 Readers/Writers。
3.  如果您使用普通的 ASCII 文本（传统的 0-127 字符），您可以（通常）使用其中任何一个。

其他一些链接：

[Java IO 中的输入流和阅读器](https://stackoverflow.com/questions/5764065/inputstream-and-reader-in-java-io)

[InputStream 与 InputStreamReader](https://stackoverflow.com/questions/3194918/inputstream-vs-inputstreamreader)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-07T00:17:33.253

实际上本身没有区别，`FileWriter`只是一个便利类。它扩展`OutputStreamWriter`并创建了自己需要的`FileOutputStream`东西。

关于`write(int)`：该方法将具有指定代码点的单个字符写入流，它不会**写入**数值的文本表示。

至于空文件，请注意，当您希望将写入的内容刷新到底层存储（无论是文件还是网络流或您能想到的任何东西）时，您应该始终刷新缓冲区。只需`os.flush()`在写完后调用，就可以了。
编辑：正如 Thilo 正确提到的，关闭流应该已经刷新它（以及所有底层流）。

最后但并非最不重要的一点是，您几乎总是应该明确指定您希望写入器写入的字符集/编码。写入器写入字符，而 OutputStreams 写入字节，因此您必须指定如何将这些字符编码为字节。如果您不指定编码，则使用系统默认值，这可能不是您想要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-07T00:21:16.527

这是从[这里](http://www.velocityreviews.com/forums/t753243-diff-between-filewriter-f-txt-and-outputstreamwriter-new-fileoutputstream-f-txt.html)

> 在 java.io 中，您可以执行字节 IO 或字符 IO。字节 IO 可用于任何形式的数据，而无需对该数据表示的任何解释。字符 IO 用于表示为字符序列的信息。
> 
> 对于字节 IO，我们有各种类型的 InputStream/OutputStream 类，例如示例 1) 中的 FileOutputStream。对于具有各种形式的 Reader/Writer 类的字符数据，例如您的示例中的 FileWriter。在这两种情况下都可以进行缓冲，因此有 BufferedWriter 和 BufferedOutputStream 类。
> 
> 要执行字符 IO 字符，有时必须使用某种形式的编码将其转换为字节数据。FileWriter 会为您执行此操作，这就是为什么它有一个构造函数，该构造函数将编码与文件名一起使用。常见的编码包括 UTF-8、UTF-16 和 US-ASCII。
> 
> OutputStreamWriter 是一个只对字符进行编码的类。这就是为什么它是一个 Writer 并且它的构造函数将一个 OutputStream 作为参数和一个可选的编码参数。
> 
> 如果您省略显式编码规范，FileWriter 和 ByteArrayOutputStream 都将使用您平台的默认编码。这是需要非常小心的事情，因为它在不同的 JVM 之间会有所不同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-06T13:27:53.997

如果要更改编码，请使用 OutputStreamWriter 而不是 FileOutputStream。FileOutputStream 是用于编写字符文件的**方便类。**它使用默认编码。

强制编码为 UTF-8，如下所示：

```
OutputStreamWriter osw = new OutputStreamWriter(
    new FileOutputStream(exportPath),
    Charset.forName("UTF-8").newEncoder() 
); 
```

# javascript - 使 Jquery 库工作的不同选择

> ID：11371163
> 
> 赞同：3
> 
> 时间：2012-07-07T00:09:19.697
> 
> 标签：javascript, jquery, html, jquery-ui

我想知道如何使 Jquery 库工作。在提出这个问题之前，我当然对此进行了研究，并且我有一本书建议执行以下操作：

```
<script src="scripts/jquery-1.6.2.min.js"><script> 
```

但是，出于某种原因，即使这样，我页面上的内容也不会响应我的代码。所以我很困惑。我尝试的是，将我正在处理的文件移动到与 jquery-1.6.2.min.js 相同的目录，因为 jquery 是一个 js 库，但没有工作。我想知道它可能是什么？我已经像疯了一样搜索语法错误，所以我真的怀疑这就是问题所在。我想知道我做错了什么？我能想到的唯一其他选择是使用网站标签（我还没有尝试过）：

```
<head>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
</head> 
```

或者

```
<head>
  <script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery/jquery- 1.6.2.min.js"></script>
</head> 
```

我想避免这种情况，因为我在工作时不想依赖网络，我们永远不知道...谢谢！

顺便说一句，这是完整的代码：

```
<!DOCTYPE html>
<html>
  <head>
    <title>jQuery goes to DOM-ville</title>
    <style>
      #change_me {
        position: absolute;
        top: 100px;
        left: 400px;
        font: 24px arial;
      }
      #move_up #move_down #color #disappear { padding: 5px; }
    </style>
    <script src="scripts/jquery-1.6.2.min.js"></script>
  </head>
  <body>
    <button id="move_up">Move Up</button>
    <button id="move_down">Move Down</button>
    <button id="color">Change Color</button>
    <button id="disappear">Disappear/Re-appear</button>
    <div id="change_me">Make Me Do Stuff!</div>
    <script>
      $(document).ready(function() {
        $("#move_up").click( function() {
          $("#change_me").animate({top:30},200);
        });//end move_up
        $("#move_down").click( function() {
          $("#chage_me").animate({top:500},2000);
        });//end move_down
        $("#color").click( function() {
          $("#change_me").css("color", "purple");
        });//end color
        $("disappear").click( function(){
          $("#change_me").toggle("slow");
        });//end disappear
      });//end doc ready
    </script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T00:22:45.540

问题很可能是路径...您只是使用 HTML 页面吗？如果是这样，有几点需要注意：

1.) 当路径以 a 开头时`/`，表示它从根文件夹开始。

2.）当路径不以 a 开头时，`/`这意味着它将相对于它所在的当前文件夹开始。

修理：

在包含您的 html 的文件夹中，创建一个 javascripts 文件夹（您可以将其命名为任何名称，例如“js”），然后将您的 jquery javascript 文件放入其中。

然后将其用于 jquery 的路径：

```
 <script type="text/javascript" src="/javascripts/jquery.min.js" 
```

这将引用绝对路径，因此如果稍后您在嵌套文件夹中有 html 文件，它不会查看相对路径，而是查看绝对路径。

同样，如果您想在有互联网时使用谷歌版本，而在没有互联网时使用本地版本，您可以使用以下代码段：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.js"></script>  
<script type="text/javascript">
    window.jQuery || document.write("<script src='/PATH/TO/jquery.js'><\/script>")
</script> 
```

附录：

修复了帖子以反映 Fabrício Matté 的更正。

如果您没有在网络服务器（例如 apache）后面运行，绝对路径可能会变得有点奇怪。这就是为什么它可以在服务器上运行，而不是在您的计算机上运行。

如果你在本地运行它，没有网络服务器（不要这样做，安装 MAMP 或 XAMP、Apache、nginx、IIS，任何东西......），你需要指定完整路径：

Mac：/Users/yourusername/Sites/website/index.html

PC: C:/somethign/something/else/index.html

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T00:19:26.837

您的页面（您复制所有代码并向我们展示的页面）是否与名为“scripts”的目录位于同一目录中？在那个“脚本”目录中，你有一个名为“jquery-1.6.2.min.js”的文件吗？

我的猜测是正在发生的三件事之一：

1.  您的 jquery 文件位于不同的目录中
2.  您从未包含过 jquery 文件
3.  jquery文件名不*完全相同*

如果你签入 FireBug，我敢打赌这个文件不见了

# c# - 一致取消 Async CancellationTokenSource 的最佳实践

> ID：11371170
> 
> 赞同：4
> 
> 时间：2012-07-07T00:10:09.727
> 
> 标签：c#, asynchronous, async-await, cancellationtokensource

所以我的 UI 上有一个组合框，它在 SelectionChanged 上异步转到 Web 服务，以拉回一些要在 UI 上显示的信息（使用新的 C#5 async/await 关键字）。我要做的是在发送新请求之前取消当前的异步请求；例如，如果用户使用键盘快速循环浏览所有组合框项目，则 SelectionChanged 事件可能会在第一个异步请求返回之前触发多次（生成多个异步请求）。

所以我从组合框的 SelectionChanged 事件中调用的异步函数如下所示：

```
public async Task<Connections> ConnectionsAsync()
{
    return await Task.Factory.StartNew(() => Connections, _cancellationTokenSource.Token);
} 
```

Connections 是一个会触发并访问 Web 服务的属性。所以因为 CancellationTokenSource 一旦取消就不能重用，我正在考虑这样做：

```
public async Task<Connections> ConnectionsAsync()
{
    _cancellationTokenSource.Cancel();
    _cancellationTokenSource = new CancellationTokenSource();
    return await Task.Factory.StartNew(() => Connections, _cancellationTokenSource.Token);
} 
```

但问题是，有时我会在没有运行异步命令时调用 Cancel()（例如，第一次调用此函数时）；因此，如果我连接任何取消事件处理程序，即使在我发出异步请求之前，它们也会被调用。

无论如何要检查异步请求是否已经在运行？除了我做类似的事情：

```
public async Task<Connections> ConnectionsAsync()
{
    if (_runningAsyncCommand)
        _cancellationTokenSource.Cancel();
    _cancellationTokenSource = new CancellationTokenSource();
    _runningAsyncCommand = true;
    return await Task.Factory.StartNew(() => Connections, _cancellationTokenSource.Token);
    _runningAsyncCommand = false;
} 
```

我有几个异步函数都使用相同的 CancellationTokenSource，所以我必须在所有这些函数中实现这个“管道”。这是最好的方法吗？或者，还有更好的方法？

此外，如果我公开 _cancellationTokenSource 以便其他类可以注册取消委托，那么将这些委托“转移”到新的 CancellationTokenSource 的最佳方法是什么，因为我每次都创建一个新委托？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:57:54.783

看起来就像是天作之合的反应式扩展。在创建任务之前从 Combobox 观察事件时定义必须经过的节流时间（比如 300 毫秒）

订阅 TextBox 更改事件的代码片段，但您会明白：

```
var input (from evt in Observable.FromEvent<EventArgs>(txt, "TextChanged")
select ((TextBox)evt.Sender).Text)
.Throttle(TimeSpan.FromSeconds(1))
.DistinctUntilChanged();

using (input.Subscribe(inp => Console.WriteLine("You wrote: " + inp)))
{
  // Do stuff
} 
```

# php - 出错时加载 500.shtml 页面

> ID：11371172
> 
> 赞同：0
> 
> 时间：2012-07-07T00:10:28.993
> 
> 标签：php, error-handling

文件.php

```
<?php

ini_set('display_errors', 0);

if(){
echo 'test';

?> 
```

我想隐藏错误并显示 500.shtml 页面，但我看到了 google chrome 错误页面。

// 500.shtml

```
 <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
    <HTML><HEAD>
    <TITLE>500 Internal Server Error</TITLE>
    </HEAD><BODY>
    <H1>Internal Server Error</H1>
    The server encountered an internal error or misconfiguration and was unable 
to complete your request.<P> Please contact the server administrator and 
inform them of the time the error occurred, and anything you might have 
done that may have caused the error.<P> More information about this 
error may be available in the server error log.<P>
    </BODY></HTML> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:15:54.527

Chrome 总是显示它自己的 5xx 错误页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T00:21:57.597

[Internet Explorer 和 Chrome在收到错误页面](http://en.wikipedia.org/wiki/HTTP_404#Custom_error_pages)[小于 512 字节](http://code.google.com/p/chromium/issues/detail?id=1695)的 HTTP 错误代码（例如 500）时会显示自己的错误页面。

增加错误页面的大小，它应该开始出现在 Chrome 中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-07T00:14:18.137

如果什么？！

```
if() 
```

这应该是这样的：

```
if(isset($_POST)) 
```

并且缺少条件钩子的结尾，所以最终代码：

```
<?php

ini_set('display_errors', 0);

if(isset($_POST)){
echo 'test';
}

?> 
```

# python - 如果直接引用，则返回第一个对象的对象元组

> ID：11371175
> 
> 赞同：0
> 
> 时间：2012-07-07T00:10:55.393
> 
> 标签：python, tuples

我想修改返回对象的 API 方法之一。我认为它应该返回一个对象元组。我不想改变人们调用这个 API 方法的方式。有没有办法返回可以直接为第一个对象引用的对象元组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T00:24:19.837

如果您将返回对象的函数更改为返回元组，则必须更改函数的调用者。没有办法解决这个问题。要么更改调用者以仅提取第一个对象，要么未更改的代码将有一个元组，它曾经有一个对象。

# python - 比这更好的去除统计异常值的方法？

> ID：11371177
> 
> 赞同：1
> 
> 时间：2012-07-07T00:11:17.963
> 
> 标签：python, statistics

此代码有效。但我不禁觉得这是一个 hack，尤其是“偏移”部分。我必须把它放在那里，否则每次我执行 del 操作时，删除中的所有索引值都会移动一个。

```
 # remove outliers > devs # of std deviations
    devs = 1
    deletes = []
    for num, duration in enumerate(durations):
        if (duration > (mean_duration + (devs * std_dev_one_test))) or \
            (duration < (mean_duration - (devs * std_dev_one_test))):
            deletes.append(num)
    offset = 0
    for delete in deletes:
        del durations[delete - offset]
        del dates[delete - offset]
        offset += 1 
```

关于如何使它变得更好的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T00:58:22.470

在迭代列表时构建一个 Keepers 列表：

```
def isKeeper( duration ):
    if (duration > (mean_duration + (devs * std_dev_one_test))) or \
            (duration < (mean_duration - (devs * std_dev_one_test))):
        return False
    return True

durations = [duration for duration in durations if isKeeper(duration)] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T00:52:08.790

也许是这样的：

```
import numpy as np        

myList = [1,2,3,4,5,6,7,3,4,5,3,5,99] 

mean_duration  = np.mean(myList)
std_dev_one_test = np.std(myList)     

def drop_outliers(x):
    if abs(x - mean_duration) <= std_dev_one_test:
        return x

myList = filter(drop_outliers, myList) 
```

结果：

```
>>> myList
[1, 2, 3, 4, 5, 6, 7, 3, 4, 5, 3, 5] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T00:13:18.400

问题是您从列表中删除项目并导致索引移动并且您正在补偿偏移量吗？

如果是这种情况，那么只需从后到前删除，这样当您删除项目时，它不会影响列表的其余部分。

所以开始从最后一项迭代到列表的前面。

这些 SO 问题可能很有趣[Delete many elements of list (python)](https://stackoverflow.com/questions/1450111/delete-many-elements-of-list-python) and [Python: Removing list element while iterate over list](https://stackoverflow.com/questions/6022764/python-removing-list-element-while-iterating-over-list?lq=1)

可以在这里找到另一个很好的 SO 讨论：[Remove items from a list while](https://stackoverflow.com/questions/1207406/remove-items-from-a-list-while-iterating-in-python) iterator（感谢@PaulMcGuire 通过评论提出的建议）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T00:19:22.810

如果您的数据集很小，您可以反转您的逻辑，并保留值而不是删除它们：

```
# keep value outliers < devs # of std deviations
devs = 1
keeps = []
for duration in durations:
    if (duration <= (mean_duration + (devs * std_dev_one_test))) and \
        (duration >= (mean_duration - (devs * std_dev_one_test))):
        keeps.append(duration) 
```

# android - 基本的 Android 代码流程

> ID：11371180
> 
> 赞同：1
> 
> 时间：2012-07-07T00:12:06.963
> 
> 标签：android, android-activity

假设您有一个名为“main”的主要活动，以及其他完成一些工作然后返回一些数据的子活动。每次调用 main 时，它都会一次启动一个子活动。

主要的：

```
onCreate...{

Intent i1 = new Intent("com.bla.bla.activity1");
startActivity(i1);

//Get bundles from activity1 and save some variables..

Intent i2 = new Intent("com.bla.bla.activity2");
startActivity(i2);

//Get bundles from activity2 and save some variables..

Intent i3 = new Intent("com.bla.bla.activity3");
startActivity(i2);

//Get bundles from activity1 and save some variables..
} 
```

如果我理解正确，activity1 将首先被创建，然后被销毁。代码会恢复并启动activity2，还是会再次启动activity1，因为主要活动被暂停然后恢复（假设我们不添加onResume/onPause等）？

编辑：

假设这些子活动每个都返回一个字符串，并且每个字符串应该保存在主活动末尾的 SQL 条目的一个单独的列中。主要活动应该收集三个字符串，将其保存为 en entry 并自行销毁。为此，主要活动必须在意图“i1”完成一些工作并返回字符串之后在意图“i2”处恢复。如何最好地实现这一结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T00:38:59.790

就像亚历克斯说的，你不想那样做。您想使用不同的 Intent 调用不同的活动来为您的程序创建流程。Main 可能会导致 Activity 1，Activity 1 会导致 2、3 或 4。如果您有多个 Activity，则可以使用 switch 语句根据满足或不满足的条件来确定要启动的 Activity .

希望这可以帮助。

编辑答案：

如果要保存来自不同活动的变量，则需要从第一个活动、第三个活动、第二个活动开始，依此类推。要为数据库创建数据，您可以简单地创建一个对象，然后使用`Parcelable`接口将该对象从 Activity 传递给 Activity。在您认为合适的每个活动中，您都希望使用方法将返回的数据保存到数据库中。

# javascript - 试图显示最新的推文

> ID：11371185
> 
> 赞同：0
> 
> 时间：2012-07-07T00:13:05.747
> 
> 标签：javascript, twitter

我一直在使用一些教程来帮助我显示我的最新推文，但自从它在大约一周前突然停止工作以来，我没有取得任何成功。

这是我的 JS：

```
<script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script>
<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/username.json?callback=twitterCallback2&count=1"></script> 
```

还有我的 HTML：

```
<div id="twitter_div"><ul id="twitter_update_list"><li>&nbsp;</li></ul></div> 
```

但它在 JS fiddle 中是空的。

[http://jsfiddle.net/BVDVH/149/](http://jsfiddle.net/BVDVH/149/)

我不知道为什么，但它以前工作过，大约一周前才停止在我的网站上工作。

## 编辑：

在评论中回答。没有看到最后一条推文，因为它是一条转发推文。必须将其设置为true。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:21:22.077

您缺少处理从 twitter 加载的数据的脚本。twitter API 需要一个 twitterCallback 回调。

编辑：没有意识到 blogger.js 提供了回调。答案小提琴在评论中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T02:00:54.597

[首先，这是在此](https://stackoverflow.com/questions/3863252/how-can-i-get-tweets-using-jquery)之前回答的

但是该示例需要一个插件

[这里](http://midnightprogrammer.net/post/Using-jQuery-To-Get-Your-Tweets.aspx)描述了一种更清洁的方法

# php - 复制数组元素并追加到同一个数组

> ID：11371190
> 
> 赞同：0
> 
> 时间：2012-07-07T00:13:55.423
> 
> 标签：php

有没有一种好方法可以复制数组中的现有值并将它们附加到同一个数组中？这是我能想到的 pf

**PHP**

```
$names = array('Tom', 'Dick', 'Hairy');
$names_new = $names;
$duplication = 3;
for($i = 0; i < $duplication; $i++) {
    for($j = 0; $j < count($names); $j++) {
        $names_new[] = $names[$j];
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T00:17:11.223

```
$names = array('Tom', 'Dick', 'Hairy');
$names2 = array_merge($names, $names); 
```

$names2 将包含您想要的数组。
文档：[array_merge](http://php.net/array_merge)

# c# - 比较来自数据库和 C# 的字符串

> ID：11371193
> 
> 赞同：0
> 
> 时间：2012-07-07T00:14:03.800
> 
> 标签：c#, sql-server, linq, datagrid

如果我有疑问

```
var query = from c in ds.Prices
            select c;
dataGridControl1.AutoCreateColumns = true;
dataGridControl1.ItemsSource = query; 
```

datagrid 显示表中的所有数据(`ds = new DataSet())。但是当我添加条件时

```
var query = from c in ds.Prices
            where c.idsticker.Equals("GOOG")
            select c;
dataGridControl1.AutoCreateColumns = true;
dataGridControl1.ItemsSource = query; 
```

数据网格为空。但是值 GOOG 存在于表中（`idsticker varchar(10)`在 sql server 中）。当我比较 int 值（例如条件为`where c.prices > 660`）时，它工作正常。

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:18:08.400

我能想到的只是对其应用 Trim() ，并可能应用 ToUpper() 来查看其中一个或两个是否有任何区别。

```
var query = from c in ds.Prices 
            where c.idsticker.Trim().ToUpper().Equals("GOOG") 
            select c; 
dataGridControl1.AutoCreateColumns = true; 
dataGridControl1.ItemsSource = query; 
```

除此之外，尝试使用 SQL 对您的数据库执行相同的查询。

```
select * from prices where idsticker = 'GOOG' 
```

# synchronization - 通过 Web 应用程序中的 API 进行多用户 Dropbox 同步

> ID：11371195
> 
> 赞同：1
> 
> 时间：2012-07-07T00:14:28.177
> 
> 标签：synchronization, dropbox, cloud-hosting, dropbox-api

我有一个 Web 应用程序，我想让用户能够授权他们的 Dropbox 帐户进行文件共享和同步。

基本上，如果有 3 个用户：用户 A、用户 B 和用户 C，那么他们应该能够将他们的 Dropbox 帐户（使用 OAuth 很简单）连接到我的应用程序，之后会有一个新的共享文件夹（比如说MyApp）在他们的 Dropbox 文件夹下创建。我的 Web 应用程序应该能够列出 3 个用户之间共享的所有文件（在共享的 MyApp 文件夹下）。如果 3 位用户中的任何一个在共享的 MyApp 文件夹中添加、编辑或删除文件，则更改应反映在我的 Web 应用程序中以供所有 3 位用户使用。

只是想找出在我的应用程序中执行此操作的最佳和简单方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T20:16:03.063

Dropbox API 并不是为了像这样自动启用跨账户同步，而是为了让用户能够访问他们自己的账户/文件。但是，有一个有用的调用“/copy_ref”，您可以使用它轻松地在帐户之间复制文件：

[/copy_ref 文档](https://www.dropbox.com/developers/reference/api#copy_ref)

除此之外，您还需要自己处理其余的逻辑。

# iphone - youtube 视频嵌入在 iphone 应用程序中，但给了我白色的空框

> ID：11371198
> 
> 赞同：1
> 
> 时间：2012-07-07T00:14:55.480
> 
> 标签：iphone, objective-c, ios, youtube

我正在尝试在我的应用程序中嵌入 youtube 视频，并且我正在使用此功能

```
- (void)embedYouTube:(NSString *)urlString frame:(CGRect)frame {
NSString *embedHTML = @"\
<html><head>\
<style type=\"text/css\">\
body {\
background-color: transparent;\
color: white;\
}\
</style>\
</head><body style=\"margin:0\">\
<embed id=\"yt\" src=\"%@\" type=\"application/x-shockwave-flash\" \
width=\"%0.0f\" height=\"%0.0f\"></embed>\
</body></html>";
NSString *html = [NSString stringWithFormat:embedHTML, urlString, frame.size.width, frame.size.height];
UIWebView *videoView = [[UIWebView alloc] initWithFrame:frame];
[videoView loadHTMLString:html baseURL:nil];
[self.view addSubview:videoView]; } 
```

我也是这样打电话的：

```
[self embedYouTube:@"http://www.youtube.com/watch?v=5ABkqmqiYEI" frame:CGRectMake(30, 200, 260, 200)]; 
```

但是当我运行该应用程序时，它给了我白色的空框。

这是我的问题：如何确保嵌入工作可能？

# ubuntu - 如何在 ubuntu 上安装 go 和 goisntall 以进行 doozer 安装

> ID：11371199
> 
> 赞同：0
> 
> 时间：2012-07-07T00:14:56.357
> 
> 标签：ubuntu, go

我正在使用 ubuntu 10.04 和 12.04。

我正在尝试安装 doozer 和 doozed，但我很难处理 go isntall。我需要为安装制作一个厨师食谱。

推土机安装说明如下：

```
goinstall github.com/ha/doozer 
```

如何获得 goinstall？

编辑：使用 Go 1.0.2 和`go install`，我得到以下输出：

```
github.com/ha/doozer
# github.com/ha/doozer
/usr/local/go/src/pkg/github.com/ha/doozer/conn.go:184: cannot use &t.req (type *request) as type proto.Message in function argument:
    *request does not implement proto.Message (missing ProtoMessage method)
/usr/local/go/src/pkg/github.com/ha/doozer/conn.go:198: cannot use &r (type *response) as type proto.Message in function argument:
    *response does not implement proto.Message (missing ProtoMessage method)
/usr/local/go/src/pkg/github.com/ha/doozer/conn.go:294: undefined: proto.GetInt64
/usr/local/go/src/pkg/github.com/ha/doozer/conn.go:326: undefined: proto.GetInt64
/usr/local/go/src/pkg/github.com/ha/doozer/conn.go:412: undefined: proto.GetInt32
/usr/local/go/src/pkg/github.com/ha/doozer/conn.go:412: undefined: proto.GetInt64
/usr/local/go/src/pkg/github.com/ha/doozer/err.go:33: cannot call non-function proto.GetString (type struct {})
/usr/local/go/src/pkg/github.com/ha/doozer/msg.pb.go:127: cannot use this (type *request) as type proto.Message in function argument:
    *request does not implement proto.Message (missing ProtoMessage method)
/usr/local/go/src/pkg/github.com/ha/doozer/msg.pb.go:142: cannot use this (type *response) as type proto.Message in function argument:
    *response does not implement proto.Message (missing ProtoMessage method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T01:44:16.437

`doozer`和`doozerd`包使用旧的、过时的 Go 版本。对于当前版本，Go 1，获取源代码：

```
go get -v github.com/ha/doozer

go get -v github.com/ha/doozerd 
```

将源代码升级到 Go 1，然后使用`go install`：

```
go install -v github.com/ha/doozer

go install -v github.com/ha/doozerd 
```

此外，`pretty.go`已重命名为[`pretty`](https://github.com/kr/pretty)：

请参阅[命令 go](http://golang.org/cmd/go/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T10:30:29.583

仅供参考（去准备）

```
$ cd /var/tmp
$ wget http://go.googlecode.com/files/go1.0.2.linux-386.tar.gz
$ tar xvfz go1...tar.gz
$ export GOROOT=/var/tmp/go
$ export PATH=$PATH:$GOROOT/bin
$ go
Go is a tool for managing Go source code.

Usage:

    go command [arguments]

The commands are:

    build       compile packages and dependencies
    clean       remove object files
    doc         run godoc on package sources
    env         print Go environment information
    fix         run go tool fix on packages
    fmt         run gofmt on package sources
    get         download and install packages and dependencies
    install     compile and install packages and dependencies
    list        list packages
    run         compile and run Go program
    test        test packages
    tool        run specified go tool
    version     print Go version
    vet         run go tool vet on packages

Use "go help [command]" for more information about a command.

Additional help topics:

    gopath      GOPATH environment variable
    packages    description of package lists
    remote      remote import path syntax
    testflag    description of testing flags
    testfunc    description of testing functions

Use "go help [topic]" for more information about that topic. 
```

# c# - Linq XML 后代在枚举中丢失

> ID：11371200
> 
> 赞同：0
> 
> 时间：2012-07-07T00:14:57.870
> 
> 标签：c#, xml, linq, xml-parsing

我有一个这样的 XML 文档

```
<root>
  <item id="1" creator="me">
    <childA>1</childA>
    <childB>2</childB>
  </item>
  <item id="2" creator="me">
    <childA>1</childA>
    <childB>3</childB>
    <childB>4</childB>
  </item>
</root> 
```

我正在尝试查找重复项，然后再次使用这样的逻辑为重复项重复子项

```
XDocument XmlRoot //whatever...you get the point

// Get item nodes
var items = XmlRoot.Descendants("item");

// Find duplicate items keys using creator attribute
var duplicateItemKeys = items.GroupBy(x => x.Attribute("creator").Value)
.Where(g => g.Count() > 1)
.Select(g => g.Key);

foreach(var duplicateItemKey in duplicateItemKeys)
{
  // Get the duplicate item XML elements using the duplicate keys
  var duplicateItems = items.Where(x => x.Attribute("creator").Value == duplicateToucheKey)
      .OrderBy(xelement => xelement.Attribute("CreatedOn").Value);
} 
```

这可行，但是稍后当我尝试使用重复项时出现问题。任何时候它枚举（如在 foreach duplicateItems 中）第一个项目都会失去其子项的上下文。第二个刚刚好。

因此，例如，稍后在代码中我说

```
var allItemB = new List<XElement>();
foreach (duplicateItem in duplicateItems) 
{
  allItemB.AddRange(duplicateItem.Descendants("childB"));
} 
```

我希望“allItemB”在第一遍包含 2，然后在第二遍包含 234。最终发生的是它只包含 34，因为一旦枚举了 duplicateItems 数组，第一个 XElement 就会失去它的孩子。

有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T03:20:40.133

如果我正确理解您的问题，您希望 allItemB 有 3 个元素 - allItemB[0] 是 XElement childB，值为 2，[1] 为 3，[2] 为 4？

如果是这样，问题出在您声明重复项的位置。您的代码甚至无法编译，因为变量的范围仅限于第一个 foreach 循环，因此在第二个循环中不可用。

我的代码得到上述结果：

```
XDocument XmlRoot = XDocument.Load( "C:\\somefile.xml" );

// Get item nodes
var items = XmlRoot.Descendants("item");

// Find duplicate items keys using creator attribute
var duplicateItemKeys = items.GroupBy(x => x.Attribute("creator").Value)
     .Where(g => g.Count() > 1)
     .Select(g => g.Key);

IEnumerable<XElement> duplicateItems = new List<XElement>();
foreach(var duplicateItemKey in duplicateItemKeys)
{
     // Get the duplicate item XML elements using the duplicate keys
     duplicateItems = items.Where(x => x.Attribute("creator").Value == duplicateItemKey)
          .OrderBy(xelement => xelement.Attribute("id").Value);
 }

 var allItemB = new List<XElement>();
 foreach (var duplicateItem in duplicateItems) 
 {
      allItemB.AddRange(duplicateItem.Descendants("childB"));
 } 
```

编辑：忘了提到我在第一个 foreach 循环中更改了 OrderBy，因为示例 xml 文件没有 CreatedOn 属性。

如果你愿意，你可以使用更多的 Linq 并完全放弃 foreach 循环，如下所示：

```
XDocument XmlRoot = XDocument.Load( "C:\\somefile.xml" );

// Get item nodes
var items = XmlRoot.Descendants("item");

// Find duplicate items keys using creator attribute
var duplicateItemKeys = items.GroupBy(x => x.Attribute("creator").Value)
     .Where(g => g.Count() > 1)
     .Select(g => g.Key);

// Get the duplicate item XML elements using the duplicate keys
var duplicateItems = items.Where(i => duplicateItemKeys.Contains(i.Attribute("creator").Value))
     .OrderBy( xelement => xelement.Attribute("id").Value );

// Get the child nodes named childB
var allItemB = new List<XElement>();
allItemB.AddRange( duplicateItems.Descendants("childB") ); 
```

# objective-c - 定位多个 UIImage 的 - Objective C

> ID：11371203
> 
> 赞同：0
> 
> 时间：2012-07-07T00:15:29.523
> 
> 标签：objective-c, ios, xcode, uiimage

在我正在构建的应用程序中，导入了一个方形图像，它被分成 16 个图块，这些图块被放置在屏幕上的一个正方形中，从顶部开始。但是，我在磁贴上方的顶部添加了一个额外的信息栏，因此我需要将这组磁贴移到屏幕下方。我玩过 for 循环和代码生成的坐标，但没有什么能给我想要的尊重。

```
-(void) initPuzzle:(NSString *) imagePath{
UIImage *orgImage = [UIImage imageNamed:imagePath];

if( orgImage == nil ){
    return; 
}

[self.tiles removeAllObjects];

tileWidth = orgImage.size.width/NUM_HORIZONTAL_PIECES;
tileHeight = orgImage.size.height/NUM_VERTICAL_PIECES;

blankPosition = CGPointMake( NUM_HORIZONTAL_PIECES-1, NUM_VERTICAL_PIECES-1 );

for( int x=0; x<NUM_HORIZONTAL_PIECES; x++ ){
    for( int y=0; y<NUM_VERTICAL_PIECES; y++ ){

        // *** The coordinates need to be altered - ?
        CGPoint orgPosition = CGPointMake(x,y); 

        if( blankPosition.x == orgPosition.x && blankPosition.y == orgPosition.y ){
            continue; 
        }

        CGRect frame = CGRectMake(tileWidth*x, tileHeight*y, 
                                  tileWidth, tileHeight );
        CGImageRef tileImageRef = CGImageCreateWithImageInRect( orgImage.CGImage, frame );
        UIImage *tileImage = [UIImage imageWithCGImage:tileImageRef];

        CGRect tileFrame =  CGRectMake((tileWidth+TILE_SPACING)*x, (tileHeight+TILE_SPACING)*y, 
                                       tileWidth, tileHeight );

        tileImageView = [[Tile alloc] initWithImage:tileImage];
        tileImageView.frame = tileFrame;
        tileImageView.originalPosition = orgPosition;
        tileImageView.currentPosition = orgPosition;

        CGImageRelease( tileImageRef );

        [tiles addObject:tileImageView];

        // now add to view
        [self.view insertSubview:tileImageView atIndex:0];
    }
}

[self shuffle]; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T00:33:31.050

另一种选择是为您的图块创建一个子视图，然后重新定位它。如果您想为所有上下移动的图块设置动画，您只需为图块视图设置动画，而不是重新计算所有图像的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:18:41.550

```
int topBarWidth = 100;     //100 based on the example in your comment 
```

然后在代码中设置每个图块的框架的位置，添加`topBarWidth`到您之前设置的任何 y 值。

# python - 解压列表/元组中的前两个元素

> ID：11371204
> 
> 赞同：60
> 
> 时间：2012-07-07T00:15:35.280
> 
> 标签：python, unpack

Python中有没有办法这样做：

```
a, b, = 1, 3, 4, 5 
```

进而：

```
>>> a
1
>>> b
3 
```

上面的代码不起作用，因为它会抛出

> `ValueError: too many values to unpack`

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-07-07T00:19:53.153

只是为了添加到 Nolen 的答案，在 Python 3 中，您还可以解压缩其余部分，如下所示：

```
>>> a, b, *rest = 1, 2, 3, 4, 5, 6, 7
>>> a
1
>>> rest
[3, 4, 5, 6, 7] 
```

不幸的是，这在 Python 2 中不起作用。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2012-07-07T00:22:03.407

没有办法使用您显示的文字来做到这一点。但是你可以切片得到你想要的效果：

```
a, b = [1, 3, 4, 5, 6][:2] 
```

要获取列表的**前两个**值：

```
a, b = my_list[:2] 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-07-07T00:20:48.877

在 Python 3 上，您可以执行以下操作：

```
>>> a, b, *_ = 1, 3, 4, 5
>>> a
1
>>> b
3 
```

`_`只是您不需要的值的占位符

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-07T00:17:16.480

你可以用它`_`来表示你想“扔掉”的变量

```
>>> a, b, _ = 1, 3, 4
>>> a
1
>>> b
3 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-07T00:19:55.530

或者在 Python 3.x 中你可以这样做：

```
 a, *b = 1, 3, 4 
```

给你：

```
In [15]: a
Out[15]: 1

In [16]: b
Out[16]: [3, 4] 
```

尽管您必须解析`b`. 这假设您只想在 的左侧有两个变量`=`，否则您可以使用

```
a, b, *ignore = .... 
```

使用 v3.x

# java - CXF、XMLStreamWriter 和编码

> ID：11371206
> 
> 赞同：4
> 
> 时间：2012-07-07T00:15:51.860
> 
> 标签：java, xml, spring, spring-mvc, cxf

我有一个 spring web 项目，现在应该使用 cxf 和 web 服务来实现。

一个功能是输出一个 xml 文件。我正在使用 XMLStreamWriter 来完成这项任务。一切正常。

但是当我将一些 cxf 依赖项添加到我的 POM 文件中时，输出 xml 文件会获得“IBM1252”编码。之后无法读取 xml 文件。异常：抛出“无效的编码名称 IBM1252”。

我添加了以下依赖项：

```
 <dependency>
        <groupId>org.apache.cxf</groupId>
        <artifactId>cxf-rt-core</artifactId>
        <version>${cxf.version}</version>
    </dependency>
    <dependency>
        <groupId>org.apache.cxf</groupId>
        <artifactId>cxf-rt-frontend-jaxws</artifactId>
        <version>${cxf.version}</version>
    </dependency>
    <dependency>
        <groupId>org.apache.cxf</groupId>
        <artifactId>cxf-rt-transports-http</artifactId>
        <version>${cxf.version}</version>
    </dependency> 
```

我没有更改代码中的任何内容。我什至试过这个：

```
 XMLStreamWriter writer = facOut.createXMLStreamWriter(fileWriter);
    writer.writeStartDocument("UTF-8", "1.0"); 
```

我仍然得到“IBM1252”编码。

有谁知道这可能是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T05:21:44.620

不要使用始终使用系统默认编码的 FileWriter，而是使用 OutputStreamWriter。

像这样

```
 OutputStream os=null;
    Writer fileWriter = null;
    File f=new File("myfile");

try {
    os =new FileOutputStream(f);
    fileWriter =new OutputStreamWriter(os,"UTF-8");
} finally {
 // close writer, then outputstream if they are not null
} 
```

……

# objective-c - 简单的 Facebook 集成演示应用程序

> ID：11371210
> 
> 赞同：0
> 
> 时间：2012-07-07T00:16:42.673
> 
> 标签：objective-c, ios, facebook

所以我刚开始考虑将 FB 集成到我的应用程序中，并制作了这个小测试应用程序。我想要一个没有 Hackbook 演示应用程序中所有 bs 的简单应用程序。基本上，这对于我想要的东西来说过于复杂了。

问题是我正在做的事情不起作用。我的应用程序尝试使用 FB 进行身份验证，但不返回身份验证令牌。我注意到的另一件事是……

1.  如果我安装了 facebook 应用程序......它会切换到它，显示白色加载屏幕一秒钟，然后将其关闭并弹回我的应用程序。

2.  如果未安装 facebook 应用程序...它将在 safari 中打开并实际显示应用程序批准窗口，让我登录，然后它会弹回我的应用程序。

然而，两种方式都无法获取和存储身份验证令牌。

我到底做错了什么？有人介意看看这段代码是否适用于他们吗？

完整来源：已删除。

感谢您的关注。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T00:24:52.167

听起来您肯定没有在 Facebook 开发人员门户中注册您的应用程序。

[https://developers.facebook.com/apps](https://developers.facebook.com/apps)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T20:21:54.857

看起来 Facebook 刚刚更新了他们的 SDK，现在包括一些简化的示例应用程序。比黑客书要好得多。

# c++ - 错误：从“const int”类型的表达式中对“int&”类型的引用进行无效初始化

> ID：11371216
> 
> 赞同：14
> 
> 时间：2012-07-07T00:17:38.107
> 
> 标签：c++, compiler-errors

这是一个与[此问题中的代码无关的问题](https://stackoverflow.com/questions/11370340/how-do-i-get-the-template-type-of-a-given-element-at-runtime-in-c)，关于以下模板函数。

```
template <class T>
class Object : public Container {
public:
    T& object;

    Object(const T& obj) : object(obj) {}
}; 
```

这是调用构造函数的代码：

```
template <class T>
void Array::add_element(const T& element)
{
    vec.push_back(new Object<T>(element));
} 
```

这段代码编译得很好，但是只要我在其中添加一行`main`调用它：

```
Array array;
int i = 3;
array.add_element(i); 
```

我收到编译器警告：`error: invalid initialization of reference of type 'int&' from expression of type 'const int'`.

那是关于什么的？我通过了`int`。它不应该自动变成我的`const int&`吗？为什么编译器会抱怨？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-07T00:26:35.217

`obj`是一个常量引用。`object`是一个非常量引用。

您不能从 const 引用初始化非 const 引用，因为这样做会破坏首先拥有 const 引用的目的。

如果你希望你的实例`Object`能够修改`int`传递给它的构造函数，那么构造函数应该采用非常量引用。如果你不这样做，那么数据成员应该是一个 const 引用。

在任何情况下，如果您使用`new`分配具有引用作为数据成员的对象，您将给自己带来麻烦。确保您删除before超出范围是*您的*问题（或者无论如何，确保在超出范围后不使用其成员。`Object``i``Object``object``i`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-07T00:28:07.423

您正在尝试将 const 引用分配给非 const 引用。这意味着您的 Object 类可以修改对象的内容。

```
const int myConstNumber = 4;
Object<int> intObj(myConstNumber);

intObj.object = 3; // you have indirectly modified the value of myConstNumber 
```

C++ 不允许你这样做。您可以制作对象的副本或将 const 添加到您的属性中。

```
template <class T>
class Object : public Container {
public:
    T object; // valid 
```

或者

```
template <class T>
class Object : public Container {
public:
    const T& object; // valid 
```

在这种情况下，您将无法修改对象

# wordpress - 反转 Wordpress 主题日期顺序

> ID：11371221
> 
> 赞同：1
> 
> 时间：2012-07-07T00:18:48.870
> 
> 标签：wordpress

所以我仍然无法弄清楚这一点： 颠倒此页面顶部和缩略图的日期顺序：[http://www.kimsquaglia.com/work/](http://www.kimsquaglia.com/work/)它应该像主页一样。

这是代码： http: [//pastie.org/4212608](http://pastie.org/4212608)

提前谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:26:08.017

您需要修改您的[get_terms()](http://codex.wordpress.org/Function_Reference/get_terms)。 `get_terms()`可以接受订单参数。

在第 48 行，尝试替换

```
$skills = get_terms('skill'); 
```

和

```
$skills = get_terms('skill', 'order=DESC'); 
```

# php - PHP MYSQLI 行数不起作用没有错误

> ID：11371222
> 
> 赞同：2
> 
> 时间：2012-07-07T00:18:55.600
> 
> 标签：php, mysqli

当用户单击登录时，我有一个登录表单 checklogin.php 被调用，它应该检查用户名和密码是否匹配数据库上的任何记录，如果为真，则执行其他操作打印错误的密码或用户名

到目前为止，我得到了错误的密码用户名，即使它是正确的用户名&&密码。我做了一些更改，但现在没有 echo、printf 或错误

我该如何解决这个问题？

形式

```
<table width="300" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#CCCCCC">
<tr>
<form name="form1" method="post" action="checklogin.php">
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<tr>
<td colspan="3"><strong>Member Login </strong></td>
</tr>
<tr>
<td width="78">Username</td>
<td width="6">:</td>
<td width="294"><input name="myusername" type="text" id="myusername"></td>
</tr>
<tr>
<td>Password</td>
<td>:</td>
<td><input name="mypassword" type="text" id="mypassword"></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><input type="submit" name="Submit" value="Login"></td>
</tr>
</table>
</td>
</form>
</tr>
</table> 
```

检查登录.php

```
<?php

    $mysqli = new mysqli('localhost', 'root', 'password', 'aiesec');

    /* check connection */
    if (mysqli_connect_errno()) {
        printf("Connect failed: %s\n", mysqli_connect_error());
        exit();
    }

    // username and password sent from form
    $myusername=$_POST['myusername'];
    $mypassword=$_POST['mypassword'];

    // To protect MySQL injection (more detail about MySQL injection)
    $myusername = stripslashes($myusername);
    $mypassword = stripslashes($mypassword);
    $myusername = mysqli_real_escape_string($myusername);
    $mypassword = mysqli_real_escape_string($mypassword);

    // If result matched $myusername and $mypassword, table row must be 1 row

    $sql = "SELECT * FROM members WHERE username='$myusername' and password='$mypassword"; 
    if($result = mysqli->query($sql, MYSQLI_USE_RESULT)) 
    { 
        printf("Errormessage: %s\n", $mysqli->error);
        echo $result->num_rows; //zero 
        while($row = $result->fetch_row()) 
        { 
            printf("Errormessage: %s\n", $mysqli->error);
            echo $result->num_rows; //incrementing by one each time 
        } 
        echo $result->num_rows; // Finally the total count 
    }

    if($row==1){

        echo "correct username and pass";
        // Register $myusername, $mypassword and redirect to file "login_success.php"
       // session_register("myusername");
        //session_register("mypassword");
        //header("location:login_success.php");
    }
    else {
        echo "Wrong Username or Password";
    }

           mysqli_close();     

    ?> 
```

我也试过

```
$sql="SELECT * FROM $tbl_name WHERE username='$myusername' and password='$mypassword'";
$result=mysqli_query($sql);

// Mysql_num_row is counting table row
$count=mysqli_num_rows($result); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T00:30:34.363

为确保您看到所有 PHP 错误，请在脚本顶部添加以下代码：

```
error_reporting(E_ALL);
ini_set('display_errors', 1); 
```

您必须更正对 的调用`mysqli_real_escape_string`。根据[文档](http://php.net/mysqli_real_escape_string)，必须有两个参数，第一个参数必须是 MySQL 链接。在您的情况下，该链接将是 $mysqli。

另外，更换：

```
if($row==1){ 
```

和：

```
if($result->num_row==1){ 
```

您误解了 $result->num_rows 是什么：它包含查询返回的总行数，其结果存储在 $result 中。因此，在您检索查询返回的所有记录的循环中检查 $result->num_rows 的值是没有用的。

我`MYSQLI_USE_RESULT`从您的常量中删除了该常量，`query()`因为[mysqli_query 的文档](http://php.net/manual/en/mysqli.query.php)说：
如果您使用 MYSQLI_USE_RESULT，所有后续调用都将返回错误命令不同步，除非您调用 mysqli_free_result()。

新代码：

```
<?php
    $mysqli = new mysqli('localhost', 'root', 'password', 'aiesec');

    /* check connection */
    if (mysqli_connect_errno()) {
        printf("Connect failed: %s\n", mysqli_connect_error());
        exit();
    }

    // cleanup POST variables
    $myusername = mysqli_real_escape_string($mysqli, stripslashes(trim($_POST['myusername'])));
    $mypassword = mysqli_real_escape_string($mysqli, stripslashes(trim($_POST['mypassword'])));

    // If result matched $myusername and $mypassword, table row must be 1 row
    $sql = "SELECT * FROM members WHERE username='$myusername' and password='$mypassword'"; 
    $result = mysqli->query($sql);
     if($mysqli->errno<>0)
        die("Errormessage: %s\n", $mysqli->error);
    echo $result->num_rows;
    if($result->num_rows==1){
        echo "correct username and pass";
        // Register $myusername, $mypassword and redirect to file "login_success.php"
       // session_register("myusername");
        //session_register("mypassword");
        //header("location:login_success.php");
    }
    else {
        echo "Wrong Username or Password";
    }
    mysqli_close();     
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:34:18.400

第一个错误，您没有在 $mypassword 之后关闭报价：

```
$sql = "SELECT * FROM members WHERE username='$myusername' and password='$mypassword"; 
```

然后，如果这个 if 没有被输入，$row 将不会被定义，并且会在以后造成麻烦：你应该至少添加 "$row = 0"

```
$row = 0;

if($result = mysqli->query($sql, MYSQLI_USE_RESULT)) 
{ 
    printf("Errormessage: %s\n", $mysqli->error);
    echo $result->num_rows; //zero 
    while($row = $result->fetch_row()) 
    { 
        printf("Errormessage: %s\n", $mysqli->error);
        echo $result->num_rows; //incrementing by one each time 
    } 
    echo $result->num_rows; // Finally the total count 
} 
```

最后，你确定这里的 $row 是 1 吗？你试过了吗

```
echo "Row is: ";

var_dump($row);

if($row==1){ 
```

编辑： $row 似乎实际上是最后一行；你会想要 $result->num_rows 。

从架构的角度来看，像这样将密码存储在数据库中并不是一个好主意，最好（至少）存储“盐渍哈希”或使用更好的算法，请参阅：

[如何在 PHP 中使用 bcrypt 对密码进行哈希处理？](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T00:30:52.163

`$mypassword`您的`$sql`变量后面缺少一个单引号。

这一行：

```
$sql = "SELECT * FROM members WHERE username='$myusername' and password='$mypassword"; 
```

**将其更新为：**

```
$sql = "SELECT * FROM members WHERE username='$myusername' and password='$mypassword'"; 
```

# android - 什么样的物理特性适合安卓操作系统流畅运行？

> ID：11371228
> 
> 赞同：-3
> 
> 时间：2012-07-07T00:19:37.367
> 
> 标签：android

你认为具有这种特性的智能手机能够支持安卓操作系统吗？- 100 MB 存储空间 - -64 MB RAM - 处理器 PNX-4910

////编辑 - _

旧版/稳定版？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:28:59.797

充其量只是勉强和不愉快，如果没有别的，基于有限的内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:39:05.637

Android 2.1+ 需要至少 92MB 的 RAM。

请参阅：[http ://static.googleusercontent.com/external_content/untrusted_dlcp/source.android.com/en/us/compatibility/2.1/android-2.1-cdd.pdf](http://static.googleusercontent.com/external_content/untrusted_dlcp/source.android.com/en/us/compatibility/2.1/android-2.1-cdd.pdf)

所以你唯一的希望是 2.1 之前的版本。

从理论上讲，您可能可以使用 1.6 或更早版本来处理它，但 PNX-4910 内部的 arm926 芯片无法承受很大的负载。

# android - 在 Event.COMPLETE 之后调整 Flash 加载器的大小不起作用

> ID：11371239
> 
> 赞同：1
> 
> 时间：2012-07-07T00:20:53.550
> 
> 标签：android, flash, loader, flash-builder

Google 建议以下问题并不少见：使用 Loader 将某些内容加载到 Flash 阶段后，我想调整它的大小。但是，如果您在加载内容之前执行此操作，则调整图像大小会导致它消失。

建议的解决方案通常是为 Event.COMPLETE 使用事件侦听器。这是我的代码：

```
public function FlixelTest()
    {
        super();

        // support autoOrients
        stage.align = StageAlign.TOP_LEFT;
        stage.scaleMode = StageScaleMode.NO_SCALE;

        myLoader = new Loader();                     
        myLoader.x = (stage.fullScreenWidth-640)/2;
        myLoader.y = (stage.fullScreenHeight-480)/2;
        addChild(myLoader);                                     

        var url:URLRequest = new URLRequest("stuff.swf");
        myLoader.load(url);    
        myLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, loadProdComplete);

    }

    function loadProdComplete(e:Event):void{
        myLoader.height = 480;
        myLoader.width = 640;
    } 
```

根据到目前为止我在网上找到的每一篇文章，这个解决方案应该可以工作。当事件触发时，加载器完成，并且可以调整大小。然而，事实并非如此。注释掉修改 .height 和 .width 的行会导致 SWF 出现，取消注释它们并再次运行，SWF 永远不会加载。

会不会有其他东西在干扰这里？这是使用 FlashBuilder 构建一个 Actionscript3 -> Android 项目。

编辑 - 这里的解决方案似乎也不起作用：[加载 swf 后调整加载程序大小问题](https://stackoverflow.com/questions/2780445/problem-resizing-loader-after-loading-swf?rq=1)

更新 - 我有一个有效且可怕的解决方案，如下所示：

```
function loadProdComplete(e:Event):void{
        if(myLoader.width != 0){
            myLoader.width = 640;
            myLoader.content.width = 640;
        }
        else{
            timer = new Timer(500);
            timer.addEventListener(TimerEvent.TIMER, timertick); // there should be a comma here but yahoo replaces it with ... 
            timer.start();
        }
    }

    function timertick(e:TimerEvent){
        timer.stop();
        stage.dispatchEvent(new Event(Event.COMPLETE));
    } 
```

它基本上使用内容的宽度来查看它是否已完成加载。如果没有，它会等待半秒并重新触发 COMPLETE 事件。这实际上有助于显示它（虽然宽度尚未调整，我认为这是一个单独的问题） - 我不敢相信这是让它工作的唯一方法......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T12:48:05.537

虽然不是严格意义上的解决方案，但我绕过它的方法是根本不调整它的大小 - 我在窗口上裁剪了一个区域，所以看到的只是我想要显示的部分。

```
function loadProdComplete(e:Event):void{
        var gameMask : Shape = new Shape;
        gameMask.graphics.beginFill(0xffcc00);
        gameMask.graphics.drawRect(myLoader.x,myLoader.y,640,480);  
        gameMask.graphics.endFill();
        myLoader.content.mask = gameMask;
    } 
```

因为无论如何我都需要面具来隐藏舞台外的杂乱，这一次解决了两个问题。

I won't accept this as the answer in case anyone has any alternative insights, but if anyone comes across this question, this is a posisble solution.

# hudson - 同一 hudson/jenkins 作业的同时实例

> ID：11371241
> 
> 赞同：4
> 
> 时间：2012-07-07T00:20:59.190
> 
> 标签：hudson, jenkins

我想要一种方法让个人用户将 repo 路径发送到 hudson 服务器并让服务器启动该 repo 的构建。我不想留下动态创建的作业配置的痕迹。我想启动同一作业的多个同时实例。显然，这要求不同实例的工作空间不同。我相信使用任何当前的扩展都是不可能的。我对我想要完成的事情的不同方法持开放态度。

我只希望 hudson 服务器能够接收来自外部资源的构建请求，并在有免费执行程序的情况下启动它们。我希望所有构建的构建配置都相同，除了 repo 的位置。我不希望有几十个相同的工作坐在那里自动生成名称。

有没有人使用 Hudson 或 Jenkins 来做这样的事情？你如何设置它？我想有了足够的脚本，我可以通过脚本中的 CLI API 动态创建必要的作业配置，然后在完成后将其销毁。但我想保留工件，因此在运行完成时破坏工作是一个问题。我真的不想编写和维护自己的扩展。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T12:41:59.817

使用 Jenkins 应该非常简单，不需要任何插件，尽管这取决于您使用的 SCM 类型。无论如何，
值得从 Hudson[升级；](https://stackoverflow.com/a/4974032/234938)自从成为 Jenkins 以来，在许多版本中支持您的用例所需的功能肯定都得到了改进。

您想将 repo 路径作为参数传递给您的构建，因此您应该在构建配置中选择“[此构建已参数化](https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Build)”选项。在那里您可以添加一个名为`REPO_PATH`或类似的字符串参数。

接下来，在您指定从何处签出代码的地方，将路径替换为`${REPO_PATH}`.
如果您要从脚本中签出代码（或者需要访问 repo 路径），该变量将自动添加到您的环境中，因此您可以`${REPO_PATH}`从 shell 脚本或 Ant 文件中引用。

此时，当按下 时`Build Now`，会提示您输入一个 repo 路径，然后再开始构建。如上面的 wiki 页面所述，您可以调用`buildWithParameters`URL 以直接使用所需参数开始构建，例如`http://server/job/myjob/buildWithParameters?REPO_PATH=foo`

最后，如果您希望构建同时执行，Jenkins 可以通过为并发构建创建临时工作区来为您管理。只需在您的作业配置中启用“必要时执行并发构建”选项。

工件将可用，与任何其他 Jenkins 构建相同。尽管您可能想管理保留了多少最近的工件；这可以通过选中“Discard Old Builds”来完成，然后在 下`Advanced…`，您可以选择为“Max # of builds to keep with artifacts”输入一个值。

# cmake - 用于调试的 Cmake 标志在 valgrind 中似乎没有用？

> ID：11371244
> 
> 赞同：0
> 
> 时间：2012-07-07T00:21:23.010
> 
> 标签：cmake, valgrind, debug-build

好的，所以我有这个我正在尝试调试的 Qt 应用程序；在其上运行 valgrind 并将输出重定向到文件后，我看到许多“肯定丢失”的块看起来像这样，这让我很难过：

```
==24357== 24 bytes in 1 blocks are definitely lost in loss record 150 of 508
==24357==    at 0x4C2C56F: malloc (vg_replace_malloc.c:267)
==24357==    by 0x76ED3CA: FcPatternCreate (in /usr/lib/x86_64-linux-gnu/libfontconfig.so.1.4.4)
==24357==    by 0x76EB3CD: FcFontRenderPrepare (in /usr/lib/x86_64-linux-gnu/libfontconfig.so.1.4.4)
==24357==    by 0x76EB66C: FcFontMatch (in /usr/lib/x86_64-linux-gnu/libfontconfig.so.1.4.4)
==24357==    by 0x57163D7: QFontDatabase::load(QFontPrivate const*, int) (in /usr/lib/x86_64-linux-gnu/libQtGui.so.4.8.1)
==24357==    by 0x56F3586: QFontPrivate::engineForScript(int) const (in /usr/lib/x86_64-linux-gnu/libQtGui.so.4.8.1)
==24357==    by 0x5728482: ??? (in /usr/lib/x86_64-linux-gnu/libQtGui.so.4.8.1)
==24357==    by 0x573B73D: QTextLine::layout_helper(int) (in /usr/lib/x86_64-linux-gnu/libQtGui.so.4.8.1)
==24357==    by 0x573D5A4: QTextLayout::endLayout() (in /usr/lib/x86_64-linux-gnu/libQtGui.so.4.8.1)
==24357==    by 0x58F33CE: QLineControl::updateDisplayText(bool) (in /usr/lib/x86_64-linux-gnu/libQtGui.so.4.8.1)
==24357==    by 0x58F36C6: QLineControl::init(QString const&) (in /usr/lib/x86_64-linux-gnu/libQtGui.so.4.8.1)
==24357==    by 0x58EC720: ??? (in /usr/lib/x86_64-linux-gnu/libQtGui.so.4.8.1) 
```

我对 valgrind 不是很好，但据我所知，这个跟踪不会回到我的源文件，对吧？事实上，在完整的 valgrind 报告（使用 -v 开关）中没有出现我的源文件，除了在我声明 QApplication 的 main() 中。

那么我可以假设我没有用 CMake 正确编译我的项目吗？希望这就是问题所在，因为 valgrind 报告现在似乎对我没有太大帮助..

现在，在我的 CmakeLists.txt 中，我（尝试）使用调试标志编译项目，如下所示：

```
 set(CMAKE_CXX_FLAGS_DEBUG "-g3 -ggdb -O0") 
```

这是这样做的正确方法吗？

我在这里做错了吗？

谢谢，抱歉这么长的问题！：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:29:41.210

通常的过程是在配置阶段将`CMAKE_BUILD_TYPE`变量设置为`Debug`、或等。`Release`这可以通过使用`-D`命令行`cmake`工具的标志或通过修改 GUI 中的适当字段来实现。

如果您希望将额外的标志传递给编译器，只需设置与设置`CMAKE_CXX_FLAGS`相同的方式`CMAKE_BUILD_TYPE`。

如您所见，这不涉及修改任何`CMakeLists.txt`文件，而是`CMakeCache.txt`在您的构建目录中。

# iphone - 异步纹理加载 iPhone OpenGL ES 2

> ID：11371247
> 
> 赞同：3
> 
> 时间：2012-07-07T00:22:02.090
> 
> 标签：iphone, opengl-es, asynchronous, textures, nsthread

我正在创建和加载很多纹理（由字符串组成）。为了保持动画流畅运行，我将工作卸载到一个单独的工作线程。它似乎或多或少完全按照我想要的方式工作，但在旧设备（iPhone 3GS）上，我有时会注意到很长（1 秒）的延迟。它只是有时会发生。现在我想知道我是否正确执行此操作，或者是否存在任何概念问题。我将源代码粘贴在下面。

我还应该提到我不想使用 GLKit TextureLoader，因为我还想将纹理生成工作卸载到另一个线程，而不仅仅是加载部分。

如果您想知道我需要这些纹理做什么，请观看此视频：http: [//youtu.be/U03p4ZhLjvY ?hd=1](http://youtu.be/U03p4ZhLjvY?hd=1)

```
NSLock*                     _textureLock;
NSMutableDictionary*        _texturesWithString;
NSMutableArray*             _texturesWithStringLoading;

// This is called when I request a new texture from the drawing routine. 
// If this function returns 0, it means the texture is not ready and Im not displaying it.

-(unsigned int)getTextureWithString:(NSString*)string {
    Texture2D* _texture = [_texturesWithString objectForKey:string];
    if (_texture==nil){
        if (![_texturesWithStringLoading containsObject:string]){
            [_texturesWithStringLoading addObject:string];
            NSDictionary* dic = [[NSDictionary alloc] initWithObjectsAndKeys:string,@"string", nil];
            NSThread* thread = [[NSThread alloc] initWithTarget:self selector:@selector(loadTextureWithDictionary:)object:dic];
            thread.threadPriority = 0.01;
            [thread start];
            [thread release];
        }
        return 0;
    }
    return _texture.name;
}

// This is executed on a separate worker thread.
// The lock makes sure that there are not hundreds of separate threads all creating a texture at the same time and therefore slowing everything down. 
// There must be a smarter way of doing that. Please let me know if you know how! ;-)
-(void)loadTextureWithOptions:(NSDictionary*)_dic{
    [_textureLock lock];
    EAGLContext* context = [[SharegroupManager defaultSharegroup] getNewContext];
    [EAGLContext setCurrentContext: context];

    NSString* string = [_dic objectForKey:@"string"];
    Texture2D* _texture = [[Texture2D alloc] initWithStringModified:string];

    if (_texture!=nil) {
        NSDictionary* _newdic = [[NSDictionary alloc] initWithObjectsAndKeys:_texture,@"texture",string,@"string", nil];
        [self performSelectorOnMainThread:@selector(doneLoadingTexture:) withObject:_newdic waitUntilDone:NO];
        [_newdic release];
        [_texture release];
    }
    [EAGLContext setCurrentContext: nil];
    [context release];
    [_textureLock unlock];
}

// This callback is executed on the main thread and marks adds the texture to the texture cache. 
-(void)doneLoadingTextureWithDictionary:(NSDictionary*)_dic{
    [_texturesWithString setValue:[_dic objectForKey:@"texture"] forKey:[_dic objectForKey:@"string"]];
    [_texturesWithStringLoading removeObject:[_dic objectForKey:@"string"]];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T01:17:51.090

The problem was that too many threads were started at the same time. Now I am using a `NSOperationQueue` rather than `NSThreads`. That allows me to set `maxConcurrentOperationCount` and only run one extra background thread that does the texture loading.

# objective-c - 设置键盘类型不会影响键盘。怎么了？

> ID：11371249
> 
> 赞同：1
> 
> 时间：2012-07-07T00:22:09.953
> 
> 标签：objective-c, ios, types, keyboard, uitextfield

更改我的 uitextfield 的键盘类型不会影响 ipad 模拟器上显示的键。我不知道为什么它不起作用。

属性

![](../Images/eb2a2b7e806d93d57a870a7eb6fd0de4.png)

键盘

![](../Images/ade65929718eb73226e1545ef2de84d5.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T00:29:40.573

这工作正常，iPad 上没有等效的 iPhone。看到这个帖子：

[iPad 数字键盘](https://stackoverflow.com/questions/2625709/ipad-numeric-keyboard)

# php - 如何回显消息并将代码从 PHP 返回到 AJAX

> ID：11371250
> 
> 赞同：0
> 
> 时间：2012-07-07T00:22:15.930
> 
> 标签：php, jquery, ajax

全部，

我有一个 AJAX 函数，它通过 html 数据类型调用 PHP URL。由于服务器限制，我不能为我的 AJAX 请求使用其他数据类型。我正在尝试打印一条消息并根据返回码处理场景。以下代码似乎不起作用。你能建议吗？

这是一个简单的 AJAX 调用：

```
 $.ajax({
       type: "POST",
       url: "validateUser.php",
       dataType: html,
       success: function(msg, errorCode){
         if(errorCode == 10)
         {
           callAFunction();
         }
         else if(errorCode == 20)
         {
           callSomething();
         }
         else
         {
           doSomethingElse();
         }
       }
     });

PHP CODE:
---------
 <?php
       function validateUser()
        {
          $username = 'xyz';
          if (!empty($username) && strlen($username)>5)
           {
             echo 'User Validated';
             return 10;
           }
           else if (empty($username))
           {
             echo 'Improper Username';
             return 20;
           }
           else if (strlen($username)<5)
           {
             echo 'Username length should be atleast 5 characters';
             return 30;
           } 
          exit;
         }
?> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:28:19.483

你的 PHP 只是一个函数。它没有被调用。

此外，您不会将任何数据发送到您的 PHP 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:58:19.877

`exit;`在 validateUser() 结束时删除。它会导致整个脚本的执行立即停止。
由于这是 validateUser() 的最后一行，因此无需添加`return`.

文档：[退出](http://php.net/exit)，[返回](http://php.net/return)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T00:27:50.723

你可以做的是在 div 中打印它们，就像这样。

```
<div class="errorcode">30</div><div class="errormessage">Username length should be atleast 5 characters</div> 
```

然后在 ajax 中的成功函数中，您可以使用 jquery 来解析响应文本并使用选择器`$(".errorcode").html() and $(".errormessage").html()`来获取响应。这让事情变得容易

看起来你也没有发布任何东西

# java - Scala REPL 仅以 root 用户身份运行，以非 root 用户身份运行时出错

> ID：11371252
> 
> 赞同：1
> 
> 时间：2012-07-07T00:22:53.560
> 
> 标签：java, scala

我正在运行 64 位 OpenSUSE 12.1，今天我从官网下载了最新的 Scala 2.9.2，解压 tgz 并进入 scala-2.9.2/bin 目录后，我执行“scala”并收到此错误消息：

```
[init] error: error while loading <root>, error in opening zip file

Failed to initialize compiler: object scala not found.
** Note that as of 2.8 scala does not assume use of the java classpath.
** For the old behavior pass -usejavacp to scala, or if using a Settings
** object programatically, settings.usejavacp.value = true. 
```

我试图运行 scala -usejavacp 但它没有帮助。我在许多其他发行版中经常使用 Scala，以前从未遇到过这个错误。

我的 OpenSUSE 安装已安装 OpenJDK 6。

请提出您的意见，谢谢！

我做了以下尝试来解决这个问题：

1.  安装Oracle JDK 1.7 并运行scala，确认scala REPL 报告在热点JVM 1.7 中运行，出现同样的错误。
2.  安装 sbt 并从 sbt 运行“控制台”，同样的错误发生。
3.  strace 和 diff 作为普通用户的 sudo scala 和 scala 之间的输出，除了上面的错误消息之外没有任何区别。
4.  scala -Ylog-classpath 作为 su 和普通用户，然后比较输出，同上。
5.  禁用 AppArmor 并再次尝试，同样的错误消息。
6.  下载其他 scala 版本（所有 2.9x 和 2.10 里程碑 4），它们的所有 REPL 都给出相同的错误消息。
7.  确保在 scala REPL 运行之前 fsc 没有运行
8.  确保主机名是可解析的

嗯，这是一个非常有趣的问题，如果我能幸运地找到它，我肯定会发布一个解决方案。

非常感谢你的帮助！

最后编辑：感谢这里和 reddit 上的所有人 (http://www.reddit.com/r/scala/comments/w5s0m/please_help_scala_only_runs_as_root_user_gives/)，他们提供了非常有价值的建议来帮助我解决这个非常奇怪的问题。请参阅下面的答案以获取解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T01:45:08.637

不要将 sbt-launch.jar 放在 $SCALA_HOME/lib 目录、项目的 lib 目录或将放在类路径中的任何位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-10T12:12:28.660

我刚刚发现了原因：

作为普通用户仔细检查“strace -f scala”的输出会产生一个有趣的输出：

```
[pid 11919] open("/usr/lib64/jvm/java-1.6.0-openjdk-1.6.0/jre/lib/ext/gnome-java-bridge.jar", O_RDONLY) = -1 EACCES (Permission denied) 
```

紧随其后的是通知用户 scala REPL 初始化失败的系统调用：

```
[pid 11919] write(1, "\nFailed to initialize compiler: "..., 260 
```

gnome-java-bridge.jar的权限是400，我改成444，问题就解决了！

权限问题似乎已被列为 OpenSUSE 错误： http: [//lists.opensuse.org/opensuse-bugs/2012-07/msg00920.html](http://lists.opensuse.org/opensuse-bugs/2012-07/msg00920.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T01:59:09.937

看起来它无法打开“scala-library.jar”或 REPL 所需的其他 jar 文件之一。

您没有说 scalac 是否有效。这可能会提供线索。

无论如何，我会确保所有 jar 文件都是 a+r，并且它们所在的目录以及所有其他父目录都是 a+rx。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-26T06:28:38.973

这很可能是由 jdk-xxx/jre/lib/ext 包含不可读的 jar 引起的。请查找以“.”开头的文件 *jar 和 "* ._jar" 并删除它们。

# python - 更新 matplotlib 中的行

> ID：11371255
> 
> 赞同：5
> 
> 时间：2012-07-07T00:23:15.850
> 
> 标签：python, matplotlib, refresh, graphing

我有一个图表，上面有多个数据集。随着数据的更新，我需要不断地重新绘制这些线，每条线都分开。如何重复删除和重新建立它，最好不必每次都删除整个图形并重新绘制所有线条？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T01:59:32.900

```
#!/usr/bin/env python

import time
from pylab import *

ion() # turn interactive mode on

# initial data
x = arange(-8, 8, 0.1);
y1 = sin(x)
y2 = cos(x)

# initial plot
line1, line2, = plot(x, y1, 'r', x, y2, 'b')
line1.axes.set_xlim(-10, 10)
line1.axes.set_ylim(-2, 2)
line1.set_label("line1")
line2.set_label("line2")
legend()
grid()
draw()

# update line 1
for i in xrange(50):
    time.sleep(0.1)

    # update data
    y1 = sin(x + float(i) / 10)

    # update plot
    line1.set_ydata(y1)
    draw()

# update line 2
for i in xrange(50):
    time.sleep(0.1)

    # update data
    y2 = cos(x + float(i) / 10)

    # update plot
    line2.set_ydata(y2)
    draw() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T02:19:29.590

寻找 Matplotlib 的[动画 API](http://matplotlib.sourceforge.net/api/animation_api.html)。也有[一些例子](http://matplotlib.sourceforge.net/examples/animation/index.html)...

# google-analytics - Google Analytics 中的自定义变量。一种有效，一种无效

> ID：11371259
> 
> 赞同：2
> 
> 时间：2012-07-07T00:23:41.887
> 
> 标签：google-analytics

我一直在尝试实现自定义变量来跟踪一个会话级事件、子域（也就是哪些客户最活跃）......和一个页面级事件（我想......我想看看有多少客户正在采用我们推出的新功能）

以下 GA 代码包含在网站的每个页面上。在大多数页面上，'Showcase' 的值只是一个空白字符串。在新功能的登录页面上，我将其设置为我们用来识别客户组的编码字符串。

我已经能够获得“子域”自定义变量一段时间了，但是对于我的生活，我似乎无法获得“展示”自定义变量来收集数据......我已经附上了我的 GA代码，以及 Chrome GA 调试器的输出...

任何帮助，将不胜感激！谢谢！

```
 var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31929869-1']);
  _gaq.push(['_setDomainName', 'domainname.com']);
  _gaq.push(['_addIgnoredRef', 'domainname.com']);
  _gaq.push(['_setCustomVar', 1, 'Subdomain', 'customer_subdomain',2]); 
  _gaq.push(['_setCustomVar', 2, 'Showcase', 'customer_subdomain__ChadGGGG',3]);

  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })(); 
```

这是调试器的输出

```
_gaq.push processing "_setAccount" for args: "[UA-31929869-1]":  ga_debug.js:18
_gaq.push processing "_setDomainName" for args: "[domainname.com]":  ga_debug.js:18
_gaq.push processing "_addIgnoredRef" for args: "[domainname.com]":  ga_debug.js:18
_gaq.push processing "_setCustomVar" for args: "[1,Subdomain,customer_subdomain,2]":  ga_debug.js:18
_gaq.push processing "_setCustomVar" for args: "[2,Showcase,customer_subdomain__ChadGGGG,3]":  ga_debug.js:18
_gaq.push processing "_trackPageview" for args: "[]":  ga_debug.js:18
Track Pageview ga_debug.js:18
Tracking beacon sent!
utmwv=5.3.3d&utms=14&utmn=1052170115&utmhn=customer_subdomain.domainname.com&utme=8(Subdomain*Showcase)9(customer_subdomain*customer_subdomain__ChadGGGG)11(2)&utmcs=UTF-8&utmsr=1440x900&utmvp=1425x260&utmsc=24-bit&utmul=en-us&utmje=1&utmfl=11.3%20r300&utmdt=Ad%20Showcase%20%7C%20Impact%20Engine&utmhid=1698418735&utmr=-&utmp=%2Fspecsheets%2Fview%2F1872&utmac=UA-31929869-1&utmcc=__utma%3D161848100.1709535606.1337723076.1341352920.1341618347.44%3B%2B__utmz%3D161848100.1340241537.36.2.utmcsr%3Dpublisher.flashadstore.net%7Cutmccn%3D(referral)%7Cutmcmd%3Dreferral%7Cutmcct%3D%2Fsellsheets%3B&utmu=qRAAAC~ ga_debug.js:18
Account ID               : UA-31929869-1
Page Title               : Ad Showcase 
Host Name                : customer_subdomain.domainname.com
Page                     : /specsheets/view/1872
Referring URL            : -
Hit ID                   : 1698418735
Visitor ID               : 1709535606
Session Count            : 44
Session Time - First     : Tue May 22 2012 14:44:36 GMT-0700 (PDT)
Session Time - Last      : Tue Jul 03 2012 15:02:00 GMT-0700 (PDT)
Session Time - Current   : Fri Jul 06 2012 16:45:47 GMT-0700 (PDT)
Campaign Time            : Wed Jun 20 2012 18:18:57 GMT-0700 (PDT)
Campaign Session         : 36
Campaign Count           : 2
Campaign Source          : publisher
Custom Var 1             : label:'Subdomain' value:'customer_subdomain' scope:'2'
Custom Var 2             : label:'Showcase' value:'customer_subdomain__ChadGGGG' scope:'Page'
Language                 : en-us
Encoding                 : UTF-8
Flash Version            : 11.3 r300
Java Enabled             : true
Screen Resolution        : 1440x900
Browser Size             : 1425x260
Color Depth              : 24-bit
Ga.js Version            : 5.3.3d
Cachebuster              : 1052170115 ga_debug.js:18
_gaq.push processing "_setAccount" for args: "[UA-5137365-60]":  ga_debug.js:18
_gaq.push processing "_setDomainName" for args: "[domainname.com]":  ga_debug.js:18
_gaq.push processing "_trackPageview" for args: "[]":  ga_debug.js:18
Track Pageview ga_debug.js:18
Tracking beacon sent!
utmwv=5.3.3d&utms=15&utmn=510447593&utmhn=customer_subdomain.domainname.com&utme=8(Subdomain*Showcase)9(customer_subdomain*customer_subdomain__ChadGGGG)11(2)&utmcs=UTF-8&utmsr=1440x900&utmvp=1425x260&utmsc=24-bit&utmul=en-us&utmje=1&utmfl=11.3%20r300&utmdt=Ad%20Showcase%20%7C&utmhid=1698418735&utmr=-&utmp=%2Fspecsheets%2Fview%2F1872&utmac=UA-5137365-60&utmcc=__utma%3D161848100.1709535606.1337723076.1341352920.1341618347.44%3B%2B__utmz%3D161848100.1340241537.36.2.utmcsr%3Dpublisher.flashadstore.net%7Cutmccn%3D(referral)%7Cutmcmd%3Dreferral%7Cutmcct%3D%2Fsellsheets%3B&utmu=qRAAAC~ ga_debug.js:18
Account ID               : UA-5137365-60
Page Title               : Ad Showcase
Host Name                : customer_subdomain.domainname.com
Page                     : /specsheets/view/1872
Referring URL            : -
Hit ID                   : 1698418735
Visitor ID               : 1709535606
Session Count            : 44
Session Time - First     : Tue May 22 2012 14:44:36 GMT-0700 (PDT)
Session Time - Last      : Tue Jul 03 2012 15:02:00 GMT-0700 (PDT)
Session Time - Current   : Fri Jul 06 2012 16:45:47 GMT-0700 (PDT)
Campaign Time            : Wed Jun 20 2012 18:18:57 GMT-0700 (PDT)
Campaign Session         : 36
Campaign Count           : 2
Campaign Source          : publisher
Custom Var 1             : label:'Subdomain' value:'customer_subdomain' scope:'2'
Custom Var 2             : label:'Showcase' value:'customer_subdomain__ChadGGGG' scope:'Page'
Language                 : en-us
Encoding                 : UTF-8
Flash Version            : 11.3 r300
Java Enabled             : true
Screen Resolution        : 1440x900
Browser Size             : 1425x260
Color Depth              : 24-bit
Ga.js Version            : 5.3.3d
Cachebuster              : 510447593 ga_debug.js:18 
```

# javascript - 为什么使用 AttributeRouting 时在 JavaScript 中使用 @Url.Action 生成的链接不是小写的？

> ID：11371261
> 
> 赞同：0
> 
> 时间：2012-07-07T00:23:56.970
> 
> 标签：javascript, asp.net-mvc-4, asp.net-mvc-areas, attributerouting, url-action

我在 JavaScript 函数中有这段代码：

```
var url = '@Url.Action(MVC.Membership.User.ActionNames.Update, MVC.Membership.User.Name)';

url += "?userName=" + userName;

ul.append("<li><a href=" + url + "\>" + userName + "</a></li>"); 
```

`Membership`是一个[`Area`](https://github.com/mccalltd/AttributeRouting/wiki/Areas)。我[`T4MVC`](http://t4mvc.codeplex.com/)用来引用控制器和动作名称以避免魔术字符串... :)

此`JavaScript`代码是`View`该`Membership`区域的一部分。

`UserController`是这样装饰的：

```
[RouteArea("Membership")]
public partial class UserController : BaseController 
```

`Action`方法是这样的：

```
[GET("Users/Update/{userName}")]
public virtual ActionResult Update(string userName) 
```

我在链接中获得的路线是这样的：

```
http://localhost:8087/membership/User/Update?userName=leniel 
```

我期望它是：

```
http://localhost:8087/membership/users/update?userName=leniel 
```

所以我的问题是：为什么链接不是小写的，因为应用程序中的所有其他链接都是用小写字母生成的？这不支持还是我忘记了一些与[AttributeRouting](https://github.com/mccalltd/AttributeRouting)或区域设置相关的配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T20:57:33.993

在 AttributeRouting 创建者的[反馈](https://github.com/mccalltd/AttributeRouting/issues/89#issuecomment-7385470)之后......原来这是我的错。

现在我明白了这个问题......

如果我这样做：

```
var url = '@Url.Action(MVC.Membership.Permission.ActionNames.GrantRevoke, MVC.Membership.Permission.Name, new { area = "Membership", roleName= "Teste" }, null)'; 
```

URL 生成正确：

```
var url = '/membership/permissions/grantrevoke/teste'; 
```

但如果我这样做：

```
var url = '@Url.Action(MVC.Membership.Permission.ActionNames.GrantRevoke, MVC.Membership.Permission.Name, new { area = "Membership" }, null)'; 
```

我明白了：

```
var url = '/Membership/Permission/GrantRevoke'; 
```

很明显，我需要传递 roleName 参数。

# javascript - jQuery 绑定/更改为下拉表单

> ID：11371268
> 
> 赞同：0
> 
> 时间：2012-07-07T00:25:30.950
> 
> 标签：javascript, jquery, datatables, zurb-foundation

我有一篇较长的帖子描述了我正在尝试做的事情，但我认为这没有必要，所以我把这个简单化了。我正在努力让 Zurb Foundation 使用 Datatables。除了下拉菜单之外，这很容易。作为一个 js 新手，我很难让它工作。这是 Foundation 下拉菜单的一般语法。

```
<label for="customDropdown">Dropdown Label</label>
<select style="display:none;" id="customDropdown">
  <option select="selected">This is a dropdown</option>
  <option>This is another option</option>
  <option>Look, a third option</option>
</select>
<div class="custom dropdown">
  <a href="#" class="current">This is a dropdown</a>
  <a href="#" class="selector"></a>
  <ul>
    <li class="selected">This is a dropdown</li>
    <li>This is another option</li>
    <li>Look, a third option</li>
  </ul>
</div> 
```

我遇到问题的地方是我的事件侦听器更新表格长度会在单击 UL 时触发，因此表格长度会使用先前选择的长度进行更新。因为 Foundation JS 是更新 UL LI 的那个，所以每次检测更改的尝试都不起作用，因为我的代码在 Foundation 将类应用于 LI 之前触发。

因此，要更新表格，我必须检测选项值的变化似乎很清楚

```
$('div#example_length form select').val() 
```

或在李

```
$('div.custom ul li.selected').text() 
```

我尝试将 .change() 函数链接到上面以检测值的变化，但它给了我一个错误。我很迷失在这里。我花了很多时间试图解决这个问题。

编辑：为了清楚起见，我要做的是在选择下拉列表时获取正确的值。我现在得到一个值，但它是以前选择的，而不是刚刚选择的。由于 Foundation 的工作方式，我很难用我的绿带 jQuery 技能来做这件事。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:14:48.143

没有更快地弄清楚这一点，我觉得有点愚蠢。这就是学习过程。

```
$('div.custom ul', nLength).on('click', 'li', function(event) {
foo = $(this).text();
console.log(foo);
}); 
```

我在此发现的是，出于某种原因，“绑定”仅检测到第一个事件，而“开启”检测到了每个事件动作。

# javascript - ColdFusion 的 listFindNoCase 函数在 Javascript 中的最快实现是什么？

> ID：11371274
> 
> 赞同：5
> 
> 时间：2012-07-07T00:27:03.367
> 
> 标签：javascript, algorithm, coldfusion

我已经被 ColdFusion 的列表宠坏了，并且遇到过一两种情况，即在 Javascript 中出现逗号分隔的列表。是否有等效的`listFindNoCase('string','list')`或高性能的方式在 Javascript 中实现它？

哦，它应该能够处理带有逗号的列表项，例如：( "Smith, John" , "Doe, Jane" , "etc..." )

这才是真正让我绊倒的地方。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T01:46:44.313

仅供参考：jList 的实现：[https ://github.com/davidwaterston/jList](https://github.com/davidwaterston/jList)

虽然，这将无法满足您“它应该能够处理带有逗号的列表项”的要求

```
listFind : function (list, value, delimiter) {
    delimiter = (typeof delimiter === "undefined") ? "," : delimiter;

    var i,
        arr = list.split(delimiter);

    if (arr.indexOf !== undefined) {
        return arr.indexOf(value) + 1;
    }

    for (i = 0; i < list.length; i += 1) {
        if (arr[i] === value) {
            return i + 1;
        }
    }

    return 0;
},

listFindNoCase : function (list, value, delimiter) {
    delimiter = (typeof delimiter === "undefined") ? "," : delimiter;

    list = list.toUpperCase();
    value = String(value).toUpperCase();

    return this.listFind(list, value, delimiter);
}, 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T07:25:48.153

这里的一个相关观察是 CF 列表本身不支持分隔符 char 也是数据的一部分。'"Smith, John", "Doe, Jane"' 的示例“列表”是 '"Smith', 'John"', '"Doe', 'Jane"' 的*四*元素逗号分隔列表。为了在这里满足您的要求，您*不需要*CF 的 JS 等价物`listFindNoCase()`，因为`listFindNoCase()`从 CF 的角度来看实际上并不能满足您的要求，而 CF 的原生功能也没有。要处理嵌入逗号的元素，您需要使用不同的字符作为分隔符。

TBH、CF 列表有点垃圾（出于上述原因），因为它们仅在非常平凡的情况下才真正有用，a) 不经常出现；b) 无论如何都不能通过数组更好地服务。在这里要进行的一个观察是您在这里询问一个高性能的解决方案：*不使用基于字符串的列表*将是高性能的第一步（这同样适用于 CF 和 JS：CF 的基于字符串的列表根本不是高性能）。

所以我在这里的第一个答案是：我认为你应该修改你的要求，不再使用列表，而是改用数组。

考虑到这一点，数据是如何到达 JS 的？您是否对使用基于字符串的列表感到困惑？如果不是：干脆不要。如果您的源数据是基于字符串的列表，您是否可以先将其转换为数组？正如我之前提到的，您的示例列表的“模式”遇到了麻烦：从 CF 的角度来看，您不能将逗号既作为分隔符又作为数据。在编写代码之前，您确实需要做一些工作来识别带引号的逗号是数据，而未带引号的逗号是分隔符。你应该看看 CSV 解析算法来处理这类事情。

但是，如果您可以更改分隔符（例如管道或分号或不会出现在数据中的其他内容），那么将其转换为数组（CF 中的 listToArray() 或 split() 就很容易了）在 JS 中）。然后你可以像其他人所说的那样使用 indexOf() 。

为了嘘！

1.  用于`indexOf()`查找字符串中子字符串的第一个匹配项的位置，您将需要使用正则表达式来匹配由分隔符字符分隔的子字符串，或者从字符串的开头到分隔符字符，或者从分隔符字符到字符串的末尾，没有中间分隔符字符。如果需要，我可以为此提出正则表达式。这还不是列表感知的，但我们知道它在字符串中的位置。
2.  取原始字符串的一个子字符串从开始到`indexOf()`返回的位置。
3.  使用`split()`它，在分隔符上拆分
4.  随后的数组的长度将是`list`匹配在原始数组中的位置。

但是我强调你不应该*那样*做。从一开始就使用数组而不是字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T00:32:48.447

您可以`indexOf`结合使用`.toLowerCase()`

```
var list = '"Smith, John" , "Doe, Jane" , "etc..."';
if(list.toLowerCase().indexOf('"Smith, John"')) 
```

如果您需要完全匹配，例如存在“Smithson”时的“Smith”，只需使用分隔符填充字符串。例如，假设您的分隔符是分号（因为您的字符串中有逗号），请像这样填充字符串的左侧和右侧：

```
";Smith, John;Doe, Jane;" 
```

还要填充搜索值，因此如果您正在寻找史密斯，该值将变为：

```
";Smith;" 
```

`.toLowerCase().indexOf()`将返回 -1（未找到）。但`";Smith, John;"`会返回 0

# php - 检索和格式化 MySQL 结果列中的所有 hasMany 记录

> ID：11371276
> 
> 赞同：0
> 
> 时间：2012-07-07T00:27:10.653
> 
> 标签：php, mysql, sql, join, has-many

我不确定这是否可能直接来自 MySQL 查询（之后不操作数据），但我一直在思考一些事情......

假设我们有一张桌子、作者和另一本书。作者可以有很多书，这由 books 表中的 author_id 列指示。

有没有办法执行以下查询：

1) 检索单个作者记录，列名为“books”，其中包含属于作者的书籍记录数组。

2) 相同的结果，但针对数据库中的所有作者。

任何关于这是否可能的输入，任何方法都将不胜感激！

**更新**

这是第一个查询的所需输出的示例：

```
stdClass Object
(
[id] => 1
[name] => Test Author
[age] => 28
[books] => Array
    (
        [0] => stdClass Object
            (
                [title] => Book 1
                [id] => 1
            )

        [1] => stdClass Object
            (
                [title] => Book 2
                [id] => 2
            )

    )

) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:29:02.033

1）是的，[`GROUP_CONCAT()`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)可以这样做（尽管我不认为这是最好的方法）。

2) 是的，`GROUP BY`作者

# r - 索引一行，然后在指定的时间范围内从不同的列中查找其后面的所有值

> ID：11371277
> 
> 赞同：1
> 
> 时间：2012-07-07T00:27:17.550
> 
> 标签：r

我想使用一列来指示每个样本的起点，然后标记起点之后的点（行），直到达到最大时间。

例如 - 我的数据 (d) 看起来像：

```
> head(d)
  Sample Seconds Value FLAG
1      A     356     1    1
2      A     357     1   NA
3      A     358     9   NA
4      A     359     4   NA
5      A     400     1   NA
6      A     401     3   NA 
```

可复制的副本在这里：

```
d <- structure(list(Sample = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L
), .Label = c("A", "B", "C"), class = "factor"), Seconds = c(356L, 
357L, 358L, 359L, 400L, 401L, 402L, 403L, 2955L, 2957L, 2959L, 
3001L, 3002L, 3004L, 2548L, 2549L, 2552L, 2553L, 2554L, 2555L, 
2556L, 2557L, 2558L), Value = c(1L, 1L, 9L, 4L, 1L, 3L, 7L, 2L, 
25L, 17L, 23L, 47L, 34L, 15L, 30L, 16L, 17L, 12L, 6L, 8L, 6L, 
6L, 5L), FLAG = c(1L, NA, NA, NA, NA, NA, NA, NA, 1L, NA, NA, 
NA, NA, NA, 1L, NA, NA, NA, NA, NA, NA, NA, NA)), .Names = c("Sample", 
"Seconds", "Value", "FLAG"), class = "data.frame", row.names = c(NA, 
-23L)) 
```

我只想要每个样本的前五秒数据。该标志表示样本的第一行（请记住，这是一个简化版本 - 我的真实数据要求我设置一个标志句柄来查找起点）。我想用起始点（标志=1）抓取行，然后`d$Seconds`在起始点的 5 秒窗口内的每一行中放置一个 1 值。我不能只添加五个，因为有些样本的点在 4 秒，然后从开始 6 秒开始。我正在处理一个大型数据集，所以我也试图避免 for 循环。有任何想法吗？（对不起数据格式 - 我以前没有发布过，它不会让我放图片）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T02:59:29.507

这是base R中的一种方法，使用`by`：

```
d$within5 <- unlist(
                by(
                    d,
                    d$Sample,
                    function (x) x$Seconds <= (x$Seconds[!is.na(x$FLAG)]+5)
                  )
                   ) 
```

结果：

```
> head(d)
  Sample Seconds Value FLAG within5
1      A     356     1    1    TRUE
2      A     357     1   NA    TRUE
3      A     358     9   NA    TRUE
4      A     359     4   NA    TRUE
5      A     400     1   NA   FALSE
6      A     401     3   NA   FALSE 
```

# ruby-on-rails - Ruby on Rails 控制器操作是私有方法

> ID：11371278
> 
> 赞同：1
> 
> 时间：2012-07-07T00:27:20.793
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我正进入（状态

```
private method `new' called for Reminder:Class 
```

应用程序跟踪是

```
app/controllers/reminders_controller.rb:27:in `new' 
```

新动作如下

```
 def new
    @reminder = @current_user.reminders.build()
    @title = "New Reminder"
    respond_to  do |format|
      format.html # new.html.erb
      format.json { render json: @reminder }
    end
  end 
```

提醒模型如下

```
class Reminder < ActiveRecord::Base
belongs_to :user
belongs_to :assignment
attr_accessible :datetime, :sent_at, :status, :send_time

STATUSES = ["Not Sent", "Sending", "Sent", "Canceled"]

validates_presence_of :sent_at, :status, :user_id, :assignment_id 

before_save :round_tine

def round_time
  self.send_time = Time.at(t.to_i/(15*60)*(15*60))
end
end 
```

我不知道该方法如何是私有的。我在这里先向您的帮助表示感谢！

**更新：**向模型添加了一个方法。错误仍然出现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T03:23:38.200

将邮件类名称作为 ReminderMailer 而不仅仅是 Reminder。这就是问题 rails 无法区分两个类，它正在识别具有名称 Reminder 的邮件程序类的新方法并显示错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T00:54:00.723

您可能在定义`private`上方的某处有声明。`new`发布您的全部内容`reminders_controller`或删除该违规行。

# c# - Windows phone 文本字段中的小数点

> ID：11371280
> 
> 赞同：2
> 
> 时间：2012-07-07T00:27:29.500
> 
> 标签：c#, xaml, windows-phone-7.1

您好 C# 和 Windows 手机开发人员，

对于我的 windows phone 应用程序，我有一个文本字段要求用户输入他们的年龄。在调试模式下，我输入了数字 0.8。并单击继续，应用程序意外关闭。我需要添加什么代码，以便我可以发布一个消息框，通知用户超过 1 个小数点的数字是不可接受的。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:40:20.093

假设输入是一个字符串，请尝试：

```
if (input.IndexOf('.') == -1 || input.LastIndexOf('.') == input.IndexOf('.'))
{
    //good
}
else
    MessageBox.Show("More than one decimal point"); 
```

更好的方法是使用 TryParse 它将检查数字以进行格式化

```
float age;
if (float.TryParse(input, out age))
{
    //good
}
else
    MessageBox.Show("Invalid age."); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T06:20:14.977

一种方法是在用户输入输入时将输入的小数位数限制为小数点后一位。

这会更好，因为它是实时的，而不是最后检查它。

```
 private void tbx_KeyDown(object sender, KeyEventArgs e)
    {
        //mark the sneder as a textbox control so we can access its properties
        TextBox textBoxControl = (TextBox)sender;

        //if there is already a decimals, do not allow another
        if (textBoxControl.Text.Contains(".") && e.PlatformKeyCode == 190)
        {
            e.Handled = true;
        }
    } 
```

# c - 原始套接字。ip header 何时使用 hton

> ID：11371281
> 
> 赞同：1
> 
> 时间：2012-07-07T00:27:30.920
> 
> 标签：c, network-programming, raw-sockets

我是原始套接字的新手，我正在玩 ip header。`ip->ip_hl = sizeof(struct ip) >> 2 //works fine;` 但是 我注意到 `ip->ip_hl = hton(sizeof(struct ip) >> 2) //will not work;`

我不明白的是，在这种情况下，为什么不将所有数字转换为网络顺序而不是主机顺序？判断何时使用网络顺序/主机顺序的一般规则是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:35:21.807

`htons`适用于 16 位值。`htonl`适用于 32 位值。至于`hton`（无后缀），我什至不确定是否存在。

报头长度只占用一个字节（实际上是一个字节的*一部分*）。您无需翻转任何字节即可将其转换为正确的形式。因此，没有类似`htons`或`htonl`用于 8 位值的宏。

# php - 检查我的mysql数据库中是否存在文件夹中的文件的最快方法是什么？

> ID：11371289
> 
> 赞同：0
> 
> 时间：2012-07-07T00:28:22.057
> 
> 标签：php, mysql, scandir

我想扫描一个效果文件夹并检查每个文件是否在我的 MySQL 效果数据库中列为一行，如果不是，我会将其显示为未跟踪的文件。有谁知道用 PHP 实现这一目标的有效方法？非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:42:07.743

我认为只有一种方法：[`glob`](http://php.net/manual/en/function.glob.php)目录，使用 PDO 或 mysqli 准备两个语句（检查和更新）并遍历文件。

如果您需要定期执行此操作，则应在跟踪/检查它们后立即将跟踪的文件移动到不同的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:50:38.980

我能想到的最好的方法是`registration_date`与表一起存储`filename`。

*   从数据库中选择最新更新/添加的文件，获取该文件的时间戳
*   创建用于将文件名添加到表的准备好的语句
*   遍历目录中的文件列表，查找比时间戳[更新的文件](http://www.php.net/manual/en/splfileinfo.getmtime.php)
*   将符合条件的每个文件名和当前时间戳插入表中
*   如果违反`UNIQUE`约束，则表示文件已更新，未添加。

恕我直言，这将是最有效的方法。

# apache-flex - 在 Flex MVC 框架中的视图和模型之间传递数据

> ID：11371292
> 
> 赞同：0
> 
> 时间：2012-07-07T00:28:38.873
> 
> 标签：apache-flex, model-view-controller, actionscript, mxml

我以前从未使用过 Flex/Actionscript，所以如果我问任何明显的问题，请原谅我，但在写这篇文章之前，我已经为此工作了 3 天（包括搜索 google 和 stackoverflow）。

我被要求修改使用基于 mini-IoC 的 MVC 框架制作的 Flex 4 游戏。我被要求制作的两个模组是一个游戏结束屏幕，它在介绍屏幕上显示最终得分和难度选择。我已经制作了游戏结束屏幕，并成功地设法让控制器在游戏计时器用完时将其调出。

所以现在，游戏结构如下：

```
Intro View -> Game View -> Game Over View

    ^                            |
    |__________ (retry?) ________| 
```

第一个问题是将分数从 mainGame ActionScript 文件传递​​到游戏结束屏幕。

我尝试过的事情：

*   在 gameOverViewBase 中导入 mainGame 并调用 gameOverView mxml 文件中的 mainGame.score 变量。

-编辑！！！= 如果我将 mainGame 中的 score 变量更改为常量，则上述方法有效，但如果它仍然是变量，控制器将不会加载 gameOverView 并且游戏位于空的 mainGame 视图中。

*   每当玩家在游戏中得分时，制作一个函数，在 gameOverViewBase 中添加一个新的得分变量。
*   MainGame 结束时将分数作为参数传递给 GameOverView

`controller.loadGameOver(score);`

这似乎是最合乎逻辑的方式。因此，我通过游戏的其他组件设置了 loadGameOver 以将整数作为参数来跟踪该函数，直到我到达主游戏动作脚本文件：

```
public function loadGameOver(score:int) : void
    {
        loadView(GameOverView);
    } 
```

loadView 函数（如下所示）是我卡住的地方，因为我看不到在哪里传递 'score' 参数。它看起来像这样：

```
private function loadView(viewClass:Class, modelClass:Class = null) : void
    {

        var view:View = new viewClass();
        if(!view) throw new Error("Could not load view");

        viewContainer.removeAllElements();
        viewContainer.addElement(view);         

        view.controller = this;

    } 
```

第二个问题是介绍屏幕上的难度选择。我使用 mxml 文件中的 3 个按钮（简单、普通、硬）和 ActionScript 中的每个按钮完成了此操作：

```
protected function onEasyButtonClick() : void
    {
        set = "easy"
        controller.loadMainGame(set);
    } 
```

再一次，我结束了上面的 loadView 函数。

总结一下：我需要知道如何在视图和模型之间传递数据。如果这不是理想的方法，我愿意接受您认为更好的任何其他方法。

谢谢你！

本

PS我可以将我的源代码发送给任何愿意帮助的人:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:42:20.583

您没有指定使用哪个 MVC 框架会有所帮助。但是，分数绝对应该是模型的属性，并且模型数据应该可以直接访问视图，可能通过绑定（感谢 weltraumpirat），或者通过一些中间类。

我建议您查看一些现有的视图类，并尝试弄清楚它们是如何提供模型数据的。您可以使用这种方法来获取视图所需的数据。

**[编辑]：**

该`mainGame`属性未在您的`GameOverView`实例上设置，因此您无法`score`通过绑定或跟踪访问其属性。控制器类的`loadView`方法接受一个`Model`类引用，它用于构造一个新`Model`实例以供 new 使用`View`。不幸的是，这对您没有用处，因为您需要为其创建`GameOverView`的实例（并且包含当前分数）。`MainGame``MainGameView`

我不知道以下内容是否符合您正在使用的框架的理念。但是，我会更改`loadView`方法以接受 a 的实例`Model`而不是类引用，并创建和缓存对实例`MainGame`化控制器时的实例的引用。这样，您可以将相同的`Model`引用传递给创建它们的时间`MainGameView`和`GameOverView`时间。

```
 public class WhackAMoleBase extends Application implements IGameController
    {
        public var viewContainer:Group;
        private var mainGame:MainGame

        public function WhackAMoleBase() : void
        {
            super();

            // Create and cache an instance of the main game Model
            mainGame = new MainGame();

            addEventListener(FlexEvent.CREATION_COMPLETE, onCreationComplete);
        }

        public function loadIntroduction() : void
        {
            loadView(IntroductionView);
        }

        public function loadMainGame() : void
        {
            loadView(MainGameView, mainGame);
        }

        public function loadGameOver() : void
        {
            // Use the same instance of MainGame which the MainGameView 
            // has been using as the Model for the GameOverView
            loadView(GameOverView, mainGame);
        }

        // Accept a Model instance rather than a class Reference
        private function loadView(viewClass:Class, model:Model = null) : void
        {
            //Create a new instance of the supplied view
            var view:View = new viewClass();
            if(!view) throw new Error("Could not load view");

            //Clear any previous views in the container and add
            viewContainer.removeAllElements();
            viewContainer.addElement(view);

            //Property based dependency injection 
            view.controller = this;

            //There may or may not be a model required for the
            //requested view; check and instantiate appropriately
            if(model)
            {               
                //Give model reference to the controller
                //and link the view up to the model
                model.controller = this;
                view.model = model;
            }
        }

        private function onCreationComplete(event:FlexEvent) : void
        {
            //When the application is first created, we want to show the introductory view 
            loadView(IntroductionView);
        }

    } 
```

# wordpress - 创建一个 wordpress 开发环境并上传到生产环境

> ID：11371308
> 
> 赞同：2
> 
> 时间：2012-07-07T00:30:59.807
> 
> 标签：wordpress, production, environments

我是一位正在考虑使用 wordpress 的老派 Java 开发人员。我习惯于在我的 PC 上进行本地开发（是的，甚至不是 mac），然后将我的文件上传到远程服务器上的生产环境。我对 wordpress 的高级评论给我的印象是，通常没有低级环境的概念，所有更新都直接发生在生产环境中。是这样吗？如果没有，有人可以解释如何将文件上传到网站吗？

谢谢，

杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T02:26:46.277

WordPress 是数据库驱动的，因此它不依赖于为每次添加或修订构建新 HTML 页面的累积过程，就像您在 Dreaweaver 或类似的东西中所做的那样。WP 部署中的核心文件只是将数据库中的内容“挂钩”到其中以供显示的外壳。

但是，您可以使用 WAMP 或 MAMP (Mac) 为开发目的设置本地环境。将站点转移到生产环境的过程是对整个 shebang 进行 FTP 处理，然后修改本地数据库，以便将其中的任何“http://localhost/testsite”更改为“http://foamfrogs” .com”或其他什么。然后将其上传到您的托管服务的数据库服务器。这有点棘手，但是一旦你做了几次，它就会变成例行公事。

有一些产品可以自动化这个过程：

备份好友：[http://pluginbuddy.com/](http://pluginbuddy.com/) ServerPress： [http ://serverpress.com/](http://serverpress.com/)

我没有使用其中的以太，因为我很便宜，有时喜欢以愚蠢的方式做事，但如果你有大量工作并且需要简化的工作流程，这可能是值得的。- 史蒂夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T15:57:56.473

只是我的一个快速提示 - 当将 Wordpress 数据库从本地开发环境移动到另一台服务器时，最大的痛苦是 Wordpress 本身（以及许多插件/主题开发人员）使用序列化数组来存储数据。因此，如果您在数据库上进行查找和替换以将旧网址替换为新网址，您将禁用很多东西，例如配置设置和小部件（特别是文本小部件，但您最终不得不使用大量的东西重新创建）。

我的建议是这里的这段很棒的代码；

[http://interconnectit.com/124/search-and-replace-for-wordpress-databases/](http://interconnectit.com/124/search-and-replace-for-wordpress-databases/)

多么节省时间，您只需上传您的 Wordpress 数据库，将此脚本上传到服务器的根目录并运行快速表单。宾果游戏，所有网址都已更改，序列化数据丢失没有问题。

部署站点时速度大幅提升。

关于你关于文件的问题 - 你只是 FTP 很多，你唯一需要改变的是 .htaccess （很可能你的网站不会在开发中的根目录，但它会在生产中）和 wp- config.php 文件，提供数据库连接详细信息。而已。

祝你好运！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T15:12:18.817

Wordpress 是一个伪装成博客平台的 CMS。

它高度灵活、功能强大且高度可扩展。它在 PHO + MySQL 上运行。

如果您以前从未使用过任何 CMS - 我建议您执行以下操作：

*   [下载 WordPress](http://wordpress.org/download/)。

*   FTP 到您的服务器。

*   准备一个数据库[（如说明）](http://codex.wordpress.org/Installing_WordPress)

*   [安装。](http://codex.wordpress.org/Installing_WordPress)

**开始玩！**

（如果您需要文档 - 看看[这里和你最好的新朋友：](http://codex.wordpress.org/Main_Page)[这里](http://codex.wordpress.org/Main_Page)的 CODEX

在你这样做之后——许多事情会开始变得更加清晰。

然后您可以开始使用[主题](http://wordpress.org/extend/themes/)和[插件](http://wordpress.org/extend/plugins/)扩展它。

现在——关于*“发展”*这个词——

这真的取决于“开发”是指使用 wordpress 创建网站，还是为 wordpress 创建*工具*以创建网站。

我所说的工具是指开发[主题](http://wordpress.org/extend/themes/)和[插件](http://wordpress.org/extend/plugins/)（前面提到过） 这将很快到来——但首先，相信我——开始玩以了解术语和过程。

要使用 wordpress 制作一个简单的网站 - 你实际上不需要成为程序员，就像我妈妈不需要成为软件工程师就可以使用 wordpad 一样。一切都带有直观的用户界面，过去我需要 20 分钟来教计算机文盲客户如何使用它。

wordpress 最伟大的事情之一（也是它飞速发展和成功的最大秘密之一）是社区、博客、网站等形式的美妙而巨大的支持基础。

现在-真正回答您的直接问题-

关于什么是**wordpress 的“Über”开发环境**的意见将与开发人员本身一样多，每个人都有自己的偏好和工具。

我只能推荐我的（这也很常见，但最重要的是，EASY 和 SIMPLE）

如果您在 PC 上（如您所说）-

*   下载[XAMPP](http://www.apachefriends.org/en/xampp.html) - 它是 PHP + MySQL 的一键安装。它甚至有一个内置的 FTP 服务器。它甚至可以是便携式的（！！）

我已经使用[XAMPP](http://www.apachefriends.org/en/xampp.html)进行 wordpress 开发已有 6 年多了，它从来没有让我失望过。配置开箱即用。（MAC 等价物是 WAMP 或 MAMP - 但因为我从来没有 MAC，希望永远不会 - 我无法作证..）

其他一些工具：

*   [Tortoius](http://tortoisesvn.tigris.org/) SVN，好吧.. SVN
*   [FireFTP](http://fireftp.mozdev.org/)总是很好。
*   [Firebug](https://addons.mozilla.org/en-US/firefox/addon/firebug/)也是如此
*   ..如果你也喜欢主题设计 -[网络开发者](https://addons.mozilla.org/en-US/firefox/addon/web-developer/) 是必须的

奖金 ：

*   我不使用 IDE - 但对于 wordpress，我强烈推荐 NOTEPAD [++](http://notepad-plus-plus.org/) 这是因为当您开始使用 wordpress 时，您将需要处理 CSS、jQuery、Javascript，当然还有 PHP。而 NOTEPAD 实际上是最好的一起处理。实际上，使用 PLUGINS - Notepad++ 可以将以上所有功能集成在一起（是的，PHP 执行、数据库连接、FTP、SVN 集成等。）

就个人而言，我必须说我所有的编程技能都归功于 wordpress。当我开始时 - wordpress 正处于起步阶段，我的编程技能为零。现在wordpress已经很庞大了，即使我仍然认为自己是一个新手——已经为酒店管理集成做了一个专门的工业规模系统——都是基于wordpress的。

最后一部分不是为了我自己的技能，而是我在开始时所说的：

wordpress 高度灵活、功能强大且高度可扩展。这就是你需要知道的。

**现在去玩吧！**

# python - 方法重载装饰器

> ID：11371309
> 
> 赞同：8
> 
> 时间：2012-07-07T00:31:34.143
> 
> 标签：python, decorator

我正在尝试编写一个装饰器，为 python 提供方法重载功能，类似于[PEP 3124](http://www.python.org/dev/peps/pep-3124/)中提到的那个。

我编写的装饰器非常适合常规函数，但我无法让它用于类中的方法。

这是装饰器：

```
class Overload(object):
    def __init__(self, default):
        self.default_function = default
        self.type_map = {}
        self.pos = None

    def __call__(self, *args, **kwargs):
        print self
        try:
            if self.pos is None:
                pos = kwargs.get("pos", 0)
            else:
                pos = self.pos
            print args, kwargs
            return self.type_map[type(args[pos])](*args, **kwargs)
        except KeyError:
            return self.default_function(*args, **kwargs)
        except IndexError:
            return self.default_function(*args, **kwargs)

    def overload(self, *d_type):
        def wrapper(f):
            for dt in d_type:
                self.type_map[dt] = f
            return self
        return wrapper 
```

当我尝试像这样实现它时：

```
class MyClass(object):
    def __init__(self):
        self.some_instance_var = 1

    @Overload
    def print_first_item(self, x):
        return x[0], self.some_instance_var

    @print_first_item.overload(str)
    def print_first_item(self, x):
        return x.split()[0], self.some_instance_var 
```

`TypeError`当我运行它时我得到一个：

```
>>> m = MyClass()
>>> m.print_first_item(1) 
<__main__.Overload object at 0x2> (1,) {} 
Traceback (most recent call last):   
  File "<stdin>", line 1, in <module>   
  File "overload.py", line 17, in __call__
    return self.default_function(*args, **kwargs) 
  TypeError: print_first_item() takes exactly 2 arguments (1 given)
>>> 
```

我的问题是：*如何从装饰方法中访问`MyClass`(ie ) 的实例？`self`*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T22:29:02.257

本质上，你的`Overload`类需要一个`__get__`方法：

```
def __get__(self, obj, cls):
    # Called on access of MyClass.print_first_item.
    # We return a wrapper which calls our 
    print "get", self, obj, cls
    if obj is None:
        # a function would do some checks here, but we leave that.
        return self
    else:
        return lambda *a, **k: self(obj, *a, **k) 
```

为什么？

好吧，您将`Overload`对象用作一种功能替换。您希望它像函数一样在具有不同签名的方法上下文中表示自己。

方法访问如何工作的简短说明：

```
object.meth(1, 2) 
```

被翻译成

```
object.__dict__['meth'].__get__(object, type(object))(1, 2) 
```

函数`__get__()`返回一个方法对象，该方法对象通过将对象添加到参数列表（其结果为`self`）来包装函数：

```
realmethod = object.__dict__['meth'].__get__(object, type(object))
realmethod(1, 2) 
```

where`realmethod`是一个方法对象，它知道要调用的函数和`self`要赋予它的函数，并通过将调用转换为适当地调用“真实”函数

```
meth(object, 1, 2) 
```

.

我们在这个新`__get__`方法中模仿了这种行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T20:03:22.110

正如 abarnert 所说，当您使用类作为装饰器时，“self”是 Overload 的一个实例，而不是您希望/期望的 MyClass。

我找不到简单的解决方案。我能想到的最好的事情是不使用类作为装饰器，而是使用函数，但使用带有默认字典的第二个参数。由于这是一个可变类型，因此每次调用该函数时它都是同一个字典。我用它来存储我的“类变量”。其余的遵循与您的解决方案类似的模式。

例子：

```
import inspect

def overload(funcOrType, map={}, type=None):
    if not inspect.isclass(funcOrType):
        # We have a function so we are dealing with "@overload"
        if(type):
            map[type] = funcOrType
        else:
            map['default_function'] = funcOrType
    else:
        def overloadWithType(func):
            return overload(func, map, funcOrType)
        return  overloadWithType

    def doOverload(*args, **kwargs):
        for type in [t for t in map.keys() if t != 'default_function'] :
            if isinstance(args[1], type): # Note args[0] is 'self' i.e. MyClass instance.
                return map[type](*args, **kwargs)
        return map['default_function'](*args, **kwargs)

    return doOverload 
```

然后：

```
from overload import *

class MyClass(object):
    def __init__(self):
        self.some_instance_var = 1

    @overload
    def print_first_item(self, x):
        return x[0], self.some_instance_var

    @overload(str)
    def print_first_item(self, x):
        return x.split()[0], self.some_instance_var

m = MyClass()
print (m.print_first_item(['a','b','c']))
print (m.print_first_item("One Two Three")) 
```

产量：

```
('a', 1)
('One', 1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-08T00:16:01.010

作为参考，这里是工作实现，感谢glglgl的详细解释：

```
argtype_tuple = lambda args: tuple(type(a) for a in args)

class Overload(object):    
    def __init__(self, func):
        self.default = func
        self.map = {}

    def __call__(self, *args, **kwargs):
        key_tuple = argtype_tuple(args)
        c_inst = kwargs.pop("c_inst", None)
        if c_inst:
            args = (c_inst,) + args
        try:
            return self.map[key_tuple](*args, **kwargs)
        except KeyError:
            return self.default(*args, **kwargs)

    def __get__(self, obj, cls):
        if obj:
            return lambda *args, **kwargs: self(c_inst=obj, *args, **kwargs)
        else:
            return self

    def overload(self, *types):
        def wrapper(f):
            for type_seq in types:
                if type(type_seq) == tuple:
                    type_seq = tuple(type_seq)
                else:
                    type_seq = (type_seq,)
                self.map[type_seq] = f
            return self
        return wrapper

#Some tests/usage examples
class A(object):
    @Overload
    def print_first(self, x):
        return x[0]

    @print_first.overload(str)
    def p_first(self, x):
        return x.split()[0]

    def __repr__(self):
        return "class A Instance"

a = A()
assert a.print_first([1,2,3]) == 1
assert a.print_first("one two three") == "one"

@Overload
def flatten(seq):
    return [seq]

@flatten.overload(list, tuple)
def flat(seq):
    return sum((flatten(item) for item in seq), [])

assert flatten([1,2,[3,4]]) == [1,2,3,4]
assert flat([1,2,[3,4]]) == [1,2,3,4] 
```

# node.js - Node.js 保存 GET 请求的 HTML 响应

> ID：11371310
> 
> 赞同：6
> 
> 时间：2012-07-07T00:31:49.030
> 
> 标签：node.js, request

显然，我对 Javascript 的了解比我愿意承认的要新一些。我正在尝试使用 Node.js 拉网页并将内容保存为变量，因此我可以按照自己的意愿对其进行解析。

在 Python 中，我会这样做：

```
from bs4 import BeautifulSoup # for parsing
import urllib

text = urllib.urlopen("http://www.myawesomepage.com/").read()

parse_my_awesome_html(text) 
```

我将如何在 Node 中执行此操作？我已经做到了：

```
var request = require("request");
request("http://www.myawesomepage.com/", function (error, response, body) {
    /*
     Something here that lets me access the text
     outside of the closure

     This doesn't work:
     this.text = body;
    */ 
}) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-07T00:46:16.247

```
var request = require("request");

var parseMyAwesomeHtml = function(html) {
    //Have at it
};

request("http://www.myawesomepage.com/", function (error, response, body) {
    if (!error) {
        parseMyAwesomeHtml(body);
    } else {
        console.log(error);
    }
}); 
```

编辑：正如 Kishore 所指出的，有很好的解析选项可用。如果您在 Windows 上遇到 jsdom 的 python/gyp 问题，也请参阅 Cheerio。[github 上的 Cheerio](https://github.com/MatthewMueller/cheerio)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T01:36:48.267

该`request()`调用是*异步*的，因此响应仅在回调内部可用。您必须从中调用 parse 函数：

```
function parse_my_awesome_html(text){
    ...
}

request("http://www.myawesomepage.com/", function (error, response, body) {
    parse_my_awesome_html(body)
}) 
```

习惯于链接回调，这本质上就是任何 I/O 将在 javascript 中发生的方式:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T00:42:17.167

[如果你想解析响应， JsDom](https://github.com/tmpvar/jsdom)可以很好地实现这样的事情。

```
 var request = require('request'),
    jsdom = require('jsdom');

request({ uri:'http://www.myawesomepage.com/' }, function (error, response, body) {
  if (error && response.statusCode !== 200) {
    console.log('Error when contacting myawesomepage.com')
  }

  jsdom.env({
    html: body,
    scripts: [
      'http://code.jquery.com/jquery-1.5.min.js'
    ]
  }, function (err, window) {
    var $ = window.jQuery;

    // jQuery is now loaded on the jsdom window created from 'agent.body'
    console.log($('body').html());
  });
}); 
```

此外，如果您的页面有很多正在加载的 javascript/ajax 内容，您可能需要考虑使用[phantomjs](http://phantomjs.org/) 源[http://blog.nodejitsu.com/jsdom-jquery-in-5-lines-on-nodejs/](http://blog.nodejitsu.com/jsdom-jquery-in-5-lines-on-nodejs/)

# jquery - 使用 jQuery 的空 JSON POST 响应，但适用于 Curl

> ID：11371312
> 
> 赞同：0
> 
> 时间：2012-07-07T00:32:07.343
> 
> 标签：jquery, ruby-on-rails, curl

我正在为我的 Ruby on Rails 网站开发 API，当我尝试使用 jQuery 捕获响应的令牌时遇到问题。使用 Curl 可以正常工作，但在 jQuery 中没有得到任何响应。

Rails 控制器的一部分

```
render :status => 200, :json => { :token => @user.authentication_token } 
```

使用卷曲：

```
jorge@george:~/$ curl -F 'email=jorge@hola.com' -F 'password=12345' http://localhost:3000/api/v1/tokens.json

Response with:

{"token":"azScPXjgppqR1Q3cH82S"} 
```

使用 jQuery

```
function login() {

    $.ajax({
        url: "http://localhost:3000/en/api/v1/tokens.json",
        type: "POST",
        dataType: "json",
        data: "email=jorge@hola.com&password=12345",
        crossDomain: "true",
        beforeSend: function () {
        // loading
        },
        success: function(data) {
        // finish load
            alert(data.message);
        },
        error: function(request, type, errorThrown) {
            alert(request.status + " " + request.statusText);
        }
    });

} 
```

使用 jQuery 我收到警报“0 错误”，并且萤火虫显示一个空响应。（32b 大小）。

任何的想法 ？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T19:27:34.913

JSONP 请求只允许 GET 方法，所以我将我的 api 控制器上的路由从 POST 更改为 GET，它的工作原理很完美。

# blackberry - 如何重新启动黑莓应用程序？

> ID：11371314
> 
> 赞同：0
> 
> 时间：2012-07-07T00:32:25.237
> 
> 标签：blackberry, application-restart, rim-5.0

我正在使用黑莓 SDK5.0，我想以编程方式重新启动应用程序。这个怎么做 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T15:40:46.817

是的，可以以编程方式重新启动应用程序。这是一篇关于它的文章。

[http://supportforums.blackberry.com/t5/Java-Development/Allow-an-application-to-restart-itself/ta-p/445223](http://supportforums.blackberry.com/t5/Java-Development/Allow-an-application-to-restart-itself/ta-p/445223)

谢谢

纳文 M

# algorithm - 如何确定地图上某个点的纬度和经度？

> ID：11371318
> 
> 赞同：0
> 
> 时间：2012-07-07T00:33:08.747
> 
> 标签：algorithm, maps, latitude-longitude

我想制作一个映射室内场所（例如商场）的地图应用程序。我需要能够计算特定地图上任何点的纬度和经度（即知道特定商店的纬度和经度）。我知道地图可能已旋转并且未与真北对齐，因此我首先需要提供有关几个点的信息以进行“校准”，以便知道地图的方向，如果您明白我的意思的话.

我的地图将被格式化为网格/坐标系。我将提供地图上三个特定点的纬度和经度。提供此信息后，如何计算地图上任何其他点的纬度和经度？例如，我有一张地图，我告诉我的程序（0, 0）、（5, 5）和（10, 12）的经纬度数据。然后我输入 (3, 5)，程序应该告诉我该点的纬度和经度。

这可能吗？我将如何为此编写算法？此外，是否可以通过用户仅向程序提供两个点的位置来做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:43:23.900

假设您的商场足够小，您可以认为 Lat 和 Long 是线性的，即与 X 和 Y 相同，那么只需应用缩放和旋转[变换矩阵](http://en.wikipedia.org/wiki/Transformation_matrix)即可。

如果你的数学有点弱，你可能想试试这个[简单的介绍](http://mathforum.org/mathimages/index.php/Transformations_and_Matrices)

您还需要能够在纬度/经度和米（或英尺或像素）之间进行转换。纬度（北/南多远）很容易 - 因为通过两极绘制的圆圈长度相同，所以纬度始终是相同的米数（您的准确度）。经度比较棘手，因为随着您向北走，围绕地球绘制的圆圈会变小 - 请参阅[Expressing_latitude_and_longitude_as_linear_units](http://en.wikipedia.org/wiki/Geographic_coordinate_system#Expressing_latitude_and_longitude_as_linear_units)

或者，如果您知道已知点（例如角）的纬度/经度，您可以直接从度数缩放到米/英尺/像素。请记住，NS 量表与 EW 量表不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:57:17.287

这是可能的，你只需要两点的位置。如果面积足够小，您不必担心平面倾斜或地球是圆的。

假设您在地图坐标中有两个点 X1,Y1 和 X2,Y2（如果您有扫描的地图，像素就可以。或毫米。或其他）。

在这两个点中，您还知道 UTM 中的坐标，并将它们设为 x1,y1 和 x2,y2。

从这些信息中，您可以得出从 UTM 更改为地图所需的旋转和缩放，反之亦然。

此时，如果您知道地图坐标 X3、Y3 的任何其他点，则可以计算其 UTM 坐标。

假设 X 和 Y 轴具有相同的 UTM 参考方向（为此，您需要管理旋转，这更复杂 - 涉及一点三角函数），

```
 x2-x1 = Zx * (X2-X1)
 x3-x1 = Zx * (X3-X1) 
```

因此

```
 Zx = (X2-X1)/(x2-x1)

 x3 = x1 + Zx * (X3-X1) 
```

最后

```
 x3 = x1 + (X3-X1)*[  (X2-X1)/(x2-x1)   ] 
```

（在您确定两个点的位置后，方括号中的部分不会改变 - 这将是一种校准常数）。

y3 和 Y3 也是如此。请注意，Y 轴可能与 y 具有相反的符号。

对于非常小的区域，您可以将纬度和经度转换为任意单位，考虑 1 度等于 60 分钟，1 分钟等于 60 秒，1 秒等于 1000 毫秒。然后从纬度（或经度）转换为毫秒。你得到的数字意义不大——你不知道“毫秒”是什么——但是一旦你计算出，比如以毫秒为单位的 x3，你就可以把它恢复为经度而忘记毫秒；并且该经度将是可用的并且*大致*正确。如果你离你的两点不远；如果你不把它们拉得太远。一个大商场还可以，一个城市……不太好。

该算法非常基本，我预计很快就会被一群愤怒的制图师和数学家私刑处死（这是*我应得*的），但对于允许将地球视为局部平坦的小区域，它可能会起作用。

# matlab - 找出加盖矩形对象的方向、长度和半径

> ID：11371328
> 
> 赞同：8
> 
> 时间：2012-07-07T00:34:16.747
> 
> 标签：matlab, image-processing

我有一个如图 1 所示的图像。![在此处输入图像描述](../Images/b47b3e16c3cc38cf3f98d4b844f20f16.png)我试图用一个带顶盖的矩形（图 2）来拟合这个二进制图像![在此处输入图像描述](../Images/ddf038ab373af9165d44c502e0fefcad.png) 来弄清楚：

1.  方向（长轴和水平轴之间的角度）
2.  物体的长度 (l) 和半径 (R)。最好的方法是什么？谢谢您的帮助。

我非常天真的想法是使用最小二乘拟合来找出这些信息，但是我发现没有带盖矩形的方程。在 matlab 中有一个名为 rectangle 的函数可以完美地创建有盖的矩形，但它似乎只是为了绘图目的。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-11-27T01:23:55.657

我解决了这两种不同的方法，并对下面的每种方法都有注释。每种方法的复杂性各不相同，因此您需要为您的应用程序确定最佳交易方式。

**第一种方法：最小二乘优化：** 这里我通过 Matlab 的 fminunc() 函数使用无约束优化。查看 Matlab 的帮助，了解您可以在优化之前设置的选项。我做了一些相当简单的选择，只是为了让这种方法适合你。

总之，我根据参数 L、W 和 theta 设置了一个带盖矩形的模型。如果您愿意，您可以包含 R，但我个人认为您不需要它；通过检查每个边缘的半圆的连续性，我认为通过检查模型几何形状让 R = W 可能就足够了。这也将优化参数的数量减少了一个。

我使用布尔图层制作了一个带帽矩形的模型，请参见下面的 cappedRectangle() 函数。因此，我需要一个函数来计算模型关于 L、W 和 theta 的有限差分梯度。如果您不向 fminunc() 提供这些梯度，它将尝试估计这些，但我发现 Matlab 的估计不适用于此应用程序，因此我提供了自己的估计作为 fminunc 调用的错误函数的一部分（） （见下文）。

我最初没有你的数据，所以我只是右键单击上面的图像并下载：'aRIhm.png'

为了读取您的数据，我这样做了（创建变量`cdata`）：

```
image = importdata('aRIhm.png');
vars = fieldnames(image);
for i = 1:length(vars)
    assignin('base', vars{i}, image.(vars{i}));
end 
```

然后我转换为双精度类型并通过规范化“清理”数据。注意：此预处理对于使优化正常工作很重要，并且可能需要，因为我没有您的原始数据（如前所述，我从网页下载了您的图像以解决此问题）：

```
data = im2double(cdata); 
data = data / max(data(:));
figure(1); imshow(data); % looks the same as your image above 
```

现在获取图像尺寸：

```
nY = size(data,1);
nX = size(data,2); 
```

**注意 #1：**您可能会考虑添加有盖矩形的中心 (xc,yc) 作为优化参数。这些额外的自由度将对整体拟合结果产生影响（请参阅下面对最终误差函数值的评论）。我没有在这里设置，但您可以按照我用于 L、W 和 theta 的方法来添加具有有限差分梯度的功能。您还需要将封顶矩形模型设置为 (xc,yc) 的函数。

**编辑：出于好奇，我在有盖矩形中心添加了优化，请参阅底部的结果。**

**注意 #2：**对于有盖矩形末端的“连续性”，令 R = W。如果您愿意，您可以稍后将 R 作为显式优化参数包含在 L、W、theta 的示例之后。您甚至可能希望将每个端点的 R1 和 R2 作为变量？

下面是我用来简单说明示例优化的任意起始值。*我不知道你的申请中有多少信息，但总的来说，你应该尽量提供最好的初步估计*。

```
L = 25;
W = L;
theta = 90;
params0 = [L W theta]; 
```

请注意，根据您的初始估计，您将获得不同的结果。

接下来显示起始估计值（cappedRectangle() 函数稍后定义）：

```
capRect0 = reshape(cappedRectangle(params0,nX,nY),nX,nY);
figure(2); imshow(capRect0); 
```

为错误度量定义一个匿名函数（errorFunc() 如下所示）：

```
f = @(x)errorFunc(x,data);

% Define several optimization parameters for fminunc():
options = optimoptions(@fminunc,'GradObj','on','TolX',1e-3, 'Display','iter');

% Call the optimizer:
tic
[x,fval,exitflag,output] = fminunc(f,params0,options);
time = toc;
disp(['convergence time (sec) = ',num2str(time)]);

% Results:
disp(['L0 = ',num2str(L),'; ', 'L estimate = ', num2str(x(1))]);
disp(['W0 = ',num2str(W),'; ', 'W estimate = ', num2str(x(2))]);
disp(['theta0 = ',num2str(theta),'; ', 'theta estimate = ', num2str(x(3))]);
capRectEstimate = reshape(cappedRectangle(x,nX,nY),nX,nY);

figure(3); imshow(capRectEstimate); 
```

以下是 fminunc 的输出（有关每列的更多详细信息，请参阅 Matlab 的帮助）：

```
 Iteration        f(x)          step          optimality   CG-iterations
     0           0.911579                       0.00465                
     1           0.860624             10        0.00457           1
     2           0.767783             20        0.00408           1
     3           0.614608             40        0.00185           1

     .... and so on ...

    15           0.532118     0.00488281       0.000962           0
    16           0.532118      0.0012207       0.000962           0
    17           0.532118    0.000305176       0.000962           0 
```

您可以看到最终的误差度量值相对于起始值没有减少太多，这表明模型函数可能没有足够的自由度来真正“拟合”数据，所以考虑添加如前所述，额外的优化参数，例如图像中心。

**编辑：在有盖矩形中心上添加了优化，请参阅底部的结果。**

现在打印结果（使用 2011 Macbook Pro）：

```
Convergence time (sec) = 16.1053
    L0 = 25;      L estimate = 58.5773
    W0 = 25;      W estimate = 104.0663
theta0 = 90;  theta estimate = 36.9024 
```

并显示结果：

![在此处输入图像描述](../Images/f6eb0484011b813c3eae3e74d2e8280d.png)

**编辑：上面拟合结果的夸大“厚度”是因为模型试图拟合数据，同时保持其中心固定，导致 W 值更大。请参阅底部的更新结果。**

通过将数据与最终估计值进行比较，您可以看到，即使是相对简单的模型也开始与数据非常相似。

您可以通过设置您自己的 Monte-Carlo 模拟来检查精度作为噪声和其他退化因素的函数（使用您可以生成以生成模拟数据的已知输入）来进一步计算估计的误差线。

下面是我用于加盖矩形的模型函数（注意：我进行图像旋转的方式在数值上有点粗略，对于有限差分来说不是很健壮，但它又快又脏，可以让你继续前进）：

```
function result = cappedRectangle(params, nX, nY)
[x,y] = meshgrid(-(nX-1)/2:(nX-1)/2,-(nY-1)/2:(nY-1)/2);
L = params(1);
W = params(2);
theta = params(3); % units are degrees
R = W; 

% Define r1 and r2 for the displaced rounded edges:
x1 = x - L;
x2 = x + L;
r1 = sqrt(x1.^2+y.^2);
r2 = sqrt(x2.^2+y.^2);

% Capped Rectangle prior to rotation (theta = 0):
temp = double( (abs(x) <= L) & (abs(y) <= W) | (r1 <= R) | (r2 <= R) );
cappedRectangleRotated = im2double(imrotate(mat2gray(temp), theta, 'bilinear', 'crop'));

result = cappedRectangleRotated(:);

return 
```

然后你还需要 fminunc 调用的错误函数：

```
function [error, df_dx] = errorFunc(params,data)
nY = size(data,1);
nX = size(data,2);

% Anonymous function for the model:
model = @(params)cappedRectangle(params,nX,nY);

% Least-squares error (analogous to chi^2 in the literature):
f = @(x)sum( (data(:) - model(x) ).^2  ) / sum(data(:).^2);

% Scalar error:
error = f(params);
[df_dx] = finiteDiffGrad(f,params);

return 
```

以及计算有限差分梯度的函数：

```
function [df_dx] = finiteDiffGrad(fun,x)
N = length(x);
x = reshape(x,N,1);

% Pick a small delta, dx should be experimented with:
dx = norm(x(:))/10;

% define an array of dx values;
h_array = dx*eye(N); 
df_dx = zeros(size(x));

f = @(x) feval(fun,x); 

% Finite Diff Approx (use "centered difference" error is O(h^2);)
for j = 1:N
    hj = h_array(j,:)';
    df_dx(j) = ( f(x+hj) - f(x-hj) )/(2*dx);
end  

return 
```

* * *

**第二种方法：使用 regionprops()**

正如其他人指出的那样，您也可以使用 Matlab 的 regionprops()。总的来说，我认为这可以通过一些调整和检查来确保它达到你的预期效果。所以方法是这样称呼它（它肯定比第一种方法简单得多！）：

```
data = im2double(cdata); 
data = round(data / max(data(:)));

s = regionprops(data, 'Orientation', 'MajorAxisLength', ...
    'MinorAxisLength', 'Eccentricity', 'Centroid'); 
```

然后是结构结果s：

```
>> s
s = 
           Centroid: [345.5309 389.6189]
    MajorAxisLength: 365.1276
    MinorAxisLength: 174.0136
       Eccentricity: 0.8791
        Orientation: 30.9354 
```

这提供了足够的信息来输入有盖矩形的模型。乍一看，这似乎是要走的路，但似乎您已经决定采用另一种方法（可能是上面的第一种方法）。

无论如何，下面是覆盖在您的数据之上的结果图像（红色），您可以看到它看起来相当不错：

![在此处输入图像描述](../Images/58d6710b458d6b5780128dbf46ec0e78.png)

* * *

**编辑：** 我忍不住，我怀疑通过将图像中心作为优化参数，可以获得更好的结果，所以我继续做只是为了检查。果然，使用前面最小二乘估计中使用的相同起始估计，结果如下：

```
Iteration        f(x)          step          optimality   CG-iterations
     0           0.911579                       0.00465                
     1           0.859323             10        0.00471           2
     2           0.742788             20        0.00502           2
     3           0.530433             40        0.00541           2
     ... and so on ...
    28          0.0858947      0.0195312       0.000279           0
    29          0.0858947      0.0390625       0.000279           1
    30          0.0858947     0.00976562       0.000279           0
    31          0.0858947     0.00244141       0.000279           0
    32          0.0858947    0.000610352       0.000279           0 
```

通过与之前的值相比，我们可以看到新的最小二乘误差值在包括图像中心时要小得多，这证实了我们之前的猜测（所以没什么大惊小怪的）。

因此，带盖矩形参数的更新估计值为：

```
Convergence time (sec) = 96.0418
    L0 = 25;     L estimate = 89.0784
    W0 = 25;     W estimate = 80.4379
theta0 = 90; theta estimate = 31.614 
```

并且相对于我们得到的图像数组中心：

```
xc = -22.9107 
yc = 35.9257 
```

优化需要更长的时间，但通过目测可以看出结果得到了改善：

![在此处输入图像描述](../Images/b46bdeb12abf0953e620c0990d8cd470.png)

如果性能是一个问题，您可能需要考虑编写自己的优化器或首先尝试调整 Matlab 的优化参数，也可能使用不同的算法选项；请参阅上面的优化选项。

这是更新模型的代码：

```
function result = cappedRectangle(params, nX, nY)
[X,Y] = meshgrid(-(nX-1)/2:(nX-1)/2,-(nY-1)/2:(nY-1)/2);

% Extract params to make code more readable:
L = params(1);
W = params(2);
theta = params(3); % units are degrees
xc = params(4); % new param: image center in x
yc = params(5); % new param: image center in y

% Shift coordinates to the image center:
x = X-xc;
y = Y-yc;

% Define R = W as a constraint:
R = W;

% Define r1 and r2 for the rounded edges:
x1 = x - L;
x2 = x + L;
r1 = sqrt(x1.^2+y.^2);
r2 = sqrt(x2.^2+y.^2);

temp = double( (abs(x) <= L) & (abs(y) <= W) | (r1 <= R) | (r2 <= R) );
cappedRectangleRotated = im2double(imrotate(mat2gray(temp), theta, 'bilinear', 'crop'));

result = cappedRectangleRotated(:); 
```

然后在调用 fminunc() 之前我调整了参数列表：

```
L = 25;
W = L;
theta = 90;
% set image center to zero as intial guess:
xc = 0; 
yc = 0;
params0 = [L W theta xc yc]; 
```

享受。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-22T22:45:40.137

首先，我不得不说，我没有你所有问题的答案，但我可以帮助你进行定向。

我建议使用二值图像的主成分分析。[Jon Shlens](http://www.cs.princeton.edu/picasso/mats/PCA-Tutorial-Intuition_jp.pdf)给出了关于 PCA 的一个很好的教程。在他的教程的图 2 中有一个示例，它可以用于什么。在他论文的第 5 节中，您可以看到一些关于如何计算主成分的说明。如第 6.1 节所示，使用奇异值分解要容易得多。

要使用 PCA，您必须获得要计算主成分的测量值。在您的情况下，每个白色像素都是由像素位置表示的测量值`(x, y)'`。您将有`N`二维向量来提供您的测量值。因此，您的测量`2xN`矩阵`X`由级联向量表示。

当你建立了这个矩阵后，按照第 6.1 节中的说明进行操作。奇异值代表不同组件的“强度”。因此，最大的奇异值代表椭圆的长轴。第二大奇异值（它应该只有两个）代表另一个（垂直）轴。

请记住，如果椭圆是圆形，则您的奇异值应该相等，但是使用离散图像表示，您将不会得到完美的圆形。

# validation - 视图模型组件上的 KnockoutJS 验证插件

> ID：11371331
> 
> 赞同：1
> 
> 时间：2012-07-07T00:34:46.420
> 
> 标签：validation, knockout.js

我的视图模型有一个`ko.observable`存储对话状态对象的成员。每个对话框对象都有与对话框中的输入字段相对应的各种成员。我想使用 KnockoutJS 验证插件向对话框添加验证。

但是，我不想将验证添加到我的整个视图模型中，而只是添加到我的对话框中。当我尝试像这样扩展对话框时：

```
 this.dialog = ko.observable(new RegistrationDialog(self)).extend({validatable: true}); 
```

事情不正常： isValid() 和 errors() 方法没有定义，验证工作不正常。我创建了一个[jsfiddle](http://jsfiddle.net/gene/t9zLH/6/)来说明这一点。当我按开始按钮时，对话框打开（请原谅缺少 CSS），但按 Enter 不会生成任何错误消息。电子邮件验证也无法正常工作，显示消息“真实不是正确的电子邮件地址”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T01:34:01.653

我会使用[文档](https://github.com/ericmbarnard/Knockout-Validation)：

```
this.dialog = ko.validatedObservable(new RegistrationDialog(this)); 
```

然后修复小提琴中的一些错误：

*   数据盲
*   点击表单上的处理程序（而不是提交，我假设）
*   `enable: isValid`在您应该拥有的注册按钮上`enable: isValid()`（由于修复了表单提交绑定，我还删除了点击绑定）

我想就是这样。[在这里更新小提琴](http://jsfiddle.net/antishok/t9zLH/14/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T01:09:33.427

这是一个工作版本：

[http://jsfiddle.net/t9zLH/8/](http://jsfiddle.net/t9zLH/8/)

我在里面添加了一个错误组并在允许您的注册方法成功之前检查它，否则我会显示错误。

# objective-c - 检查我的应用程序的首次启动

> ID：11371332
> 
> 赞同：6
> 
> 时间：2012-07-07T00:34:48.180
> 
> 标签：objective-c, macos, nsuserdefaults

我将如何检查它是否是我的应用程序第一次启动，在我的应用程序`NSUserDefaults`第一次打开时使用并运行一些代码？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-07T00:42:39.033

这应该为您指明正确的方向：

```
static NSString* const hasRunAppOnceKey = @"hasRunAppOnceKey";
NSUserDefaults* defaults = [NSUserDefaults standardUserDefaults];
if ([defaults boolForKey:hasRunAppOnceKey] == NO)
{
    // Some code you want to run on first use...
    [defaults setBool:YES forKey:hasRunAppOnceKey];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T00:52:58.913

NSUserDefaults 的答案是我脑海中浮现的第一件事，但经过反思，我会提出另一个建议。更多的工作，但值得考虑。动机是：有时在对应用程序进行故障排除时，Apple 建议删除该应用程序的 plist 文件。这是一种相当普遍的故障排除技术。我建议将您的布尔值存储在您的 plist 文件中，而不是 NSUserDefaults 中。

免责声明：我只做 iOS 开发，所以我不确定 NSUserDefaults 和 plists 在 Mac 上是如何交互的，而且我不知道让你的 plist 存在于 ~/Library/Application\ Support/Preferences/ 中所涉及的一切com.mycompany.MyAppName.plist

无论如何，我想这需要一些代码，这些代码实际上可以创建一个“新鲜”的 plist（可能是你的包中模板文件的副本），如果它启动并且没有看到 plist，你的应用程序就会这样做。默认 plist 不应包含允许您的用户跳过“第一次”代码的标志，但如果他们之前打开过应用程序，然后删除 plist，他们应该恢复默认行为。

这是一个重要的行为，在可能的情况下支持，如果我们的应用给他们带来麻烦，可以帮助我们的用户。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-26T21:43:18.270

```
if (![[NSUserDefaults standardUserDefaults] boolForKey:@"hasBeenLaunched"]) {
    // Run code on the first launch only ...
    [defaults setBool:YES forKey:@"hasBeenLaunched"];
} 
```

您可以使用 NSUserDefaults 将布尔值、整数、对象保存到程序中，并在您打开程序时让它们可用。您可以使用“boolForKey”设置一个名为“hasBeenLaunched”的标志。默认情况下，该值在未设置时为 NO。一旦将其更改为 YES，则 if 条件中的代码将永远不会再次执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T01:30:49.410

在您的主控制器类中，实现如下内容：

```
static NSString * const MDFirstRunKey  = @"MDFirstRun";

@implementation MDAppController

+ (void)initialize {
   NSMutableDictionary *defaults = [NSMutableDictionary dictionary];
   [defaults setObject:[NSNumber numberWithBool:YES] forKey:MDFirstRunKey];
   [[NSUserDefaults standardUserDefaults] registerDefaults:defaults];
   // the following if on Mac and is necessary:
   [[NSUserDefaultsController sharedUserDefaultsController] setInitialValues:defaults];
}

- (void)applicationDidFinishLaunching:(NSNotification *)notification {

  BOOL firstRun = [[[NSUserDefaults standardUserDefaults]
                      objectForKey:MDFirstRunKey] boolValue];

  if (firstRun) {
     // do something

     [[NSUserDefaults standardUserDefaults] setObject:
                [NSNumber numberWithBool:NO] forKey:MDFirstRunKey];

  } else {
     // do something else

  }
}

@end 
```

在创建它所在的`+initialize`类的实例之前调用类方法；换句话说，它很早就被调用，是设置默认值的好地方。

有关详细信息，请参阅[首选项和设置编程指南：注册您的应用程序的默认首选项](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/UserDefaults/AccessingPreferenceValues/AccessingPreferenceValues.html#//apple_ref/doc/uid/10000059i-CH3-97292)。

# performance - 使用 clear 和 cursor up 命令的 bash 和 awk 性能

> ID：11371335
> 
> 赞同：2
> 
> 时间：2012-07-07T00:35:27.383
> 
> 标签：performance, bash, awk

我正在测试有关`clear`vs`tput clear`和`tput cuu1`（光标向上）命令的 Bash 和 AWK 脚本性能。我在 Bash 和 AWK 中实现了类似的脚本。

重击： http: [//pastebin.com/0DSc0a71](http://pastebin.com/0DSc0a71)

AWK： http: [//pastebin.com/WAJ9inRx](http://pastebin.com/WAJ9inRx)

承认以类似的方式编写它们，我分析了不同的执行时间。

在 Bash 脚本中：

*   `clear``tput clear`bash 命令与命令一样快
*   而且`tput cuu1`很贵

在 AWK 脚本中：

*   `tput cuu1`不贵

@与`system( "clear" );`@

*   并且`clear`bash 命令比`tput clear`命令慢

@与`"clear" | getline Clear`（[http://pastebin.com/Afh3WFGR）@](http://pastebin.com/Afh3WFGR)

*   并且bash 命令与命令`clear`一样快`tput clear`

因此，似乎 AWK 执行`tput cuu1`的命令比 Bash 更好，并且进入 AWK 脚本，`system()`功能比其他直接调用要慢。

@添加cpu信息@

AWK 脚本使用的 CPU 比 bash 脚本少。Bash 脚本使用的 CPU 是 AWK 脚本的 4 倍。是否可以执行 Bash 脚本？

为什么`tput cuu1`在 Bash 脚本中非常昂贵？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T01:11:21.707

AWK 和 Bash 都调用相同的外部`clear`和`tput`实用程序。我怀疑其中一些差异可能在于一个与另一个的执行开销以及两个脚本实现方式的差异。在我的系统上`clear`输出与文档相同的序列，`tput clear`文档说是这样。请注意，`clear`and`tput`是外部实用程序，而不是 Bash 或 AWK 命令。

你为什么要这样做？使用其他原因所需的语言。在脚本启动时将序列保存在变量中，这样您就不必重复调用`tput`. 仅`clear`用于方便，因为这就是它的全部功能 -`tput`显然更加通用。

# .net - 如何正确处理频繁更改的 .Net Windows 服务

> ID：11371336
> 
> 赞同：2
> 
> 时间：2012-07-07T00:35:36.980
> 
> 标签：.net, windows-services

我有一个 Windows 服务，它将每两周更新一次

我已经在 DLL 中获得了所有有用的代码，该服务只是几个简单的`Start`方法`Stop`，它们映射到 DLL 中的相同方法。

我使用控制台应用程序来开发/调试 DLL，所以我想知道；而不是服务直接引用 DLL 并且每次我进行更新时都需要卸载/重新安装，使用该服务来包装控制台应用程序有什么缺点吗？

也就是说，而不是...

```
Private MyService as IMyService
Sub Start()
    MyService = New MyService()
    MyService.StartAsync()
End Start 
```

做类似...

```
Const ServiceExecutablePath As String = "C:\Blah\MyService.exe"
Private MyService as Process
Sub Start()
    MyService = Process.Start(ServiceExecutablePath)
End Start 
```

这样，如果我想发布，我需要做的就是停止服务，替换可执行文件（和相关的 DLL），然后重新启动它。

我还没有完全弄清楚如何优雅地关机。控制台应用程序侦听`CTRL` `C`中断和调用`MyService.Shutdown(Graceful:=True)`（阻塞调用）。我应该尝试从服务中模拟相同的内容还是有更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T00:41:23.903

我不会包装控制台应用程序，而是在服务中启动一个新的 AppDomain，并将 dll（插件样式）加载到新的 AppDomain 中并在那里调用您的方法。这样一来，您就可以拆除 AppDomain，它会释放 dll 以供您更换享受。

加载 dll 插件样式使您不必持有程序集引用。并且额外的 AppDomain 允许您卸载 dll 程序集而无需拆除服务 AppDomain（通常是一种不愉快的使用体验）。

我会避免包装控制台应用程序，因为服务通常不能很好地与 UI 应用程序配合使用。您的控制台窗口仍将生成一个 UI（控制台窗口）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T00:42:35.077

为此，您不需要可执行文件。您可以在启动服务时动态加载 DLL。要么手动执行（请参阅此[链接](http://msdn.microsoft.com/en-us/library/dd153782.aspx)），要么使用[MEF](http://msdn.microsoft.com/en-us/library/dd460648.aspx)之类的东西为您加载它。

另一种简单的方法是使用[TopShelf](http://topshelf-project.com/)来托管您的服务。使用 TopShelf，您可以将服务作为控制台应用程序开发和运行。当您将参数 install 传递给控制台应用程序时，它将作为服务安装。由于您不需要安装程序，因此易于更换。

# java - 递归如何在计算数字排列的代码中工作

> ID：11371337
> 
> 赞同：-1
> 
> 时间：2012-07-07T00:36:32.333
> 
> 标签：java, algorithm, recursion, permutation

我在互联网上找到了这段代码，可以计算给定向量的所有可能排列。

```
import java.util.Vector;

class Permute {
    static int count = 0;

    public static void permute(Vector unvisited, Vector visited) {
    if ( unvisited.isEmpty() ) {
        System.out.println("Permutation: "+visited);
        count++;
    }
    else { 
        //System.out.println("Trace: "+visited+" "+unvisited);
        int l = unvisited.size();
        for(int i = 0; i<l; i++) {
        String next = String.valueOf(unvisited.remove(i));
        visited.add(next);
        permute(unvisited,visited);
        unvisited.add(i,next);
        visited.remove(next);
        }
    }
    }

    public static void main(String[] args) {    
    Vector objects = new Vector();

    objects.add(1);
    objects.add(5);
    objects.add(8);

    permute(objects, new Vector() );
        System.out.println(count+" Permutationen gefunden");
    }
} 
```

但是我在理解代码和指令流程方面有一个小问题。我想念的是当这两条线被调用时

```
 unvisited.add(i,next);
    visited.remove(next); 
```

`permute(..)`正如我所见，在到达它们之前有一个递归函数！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:55:24.887

首先尝试了解**permute** () 函数的作用。它处理两个向量：*unvisited*和*visited*。在**permute** () 的执行中，该函数将从*unvisited*中获取一个元素并将其移动到*visited*。将其视为“构建”一个排列。

例如：

```
Unvisited: 1, 5, 8
visited: 
```

我们将元素从未*访问*移动到已*访问*

```
Unvisited:  5, 8
visited: 1 
```

现在要构建以 1 开头的其余排列，我们需要找到*unvisited*或 {5,8} 的排列。所以我们*递归*调用**permute()**来找到其余的。

那么做什么

```
unvisited.add(i,next);
visited.remove(next); 
```

做 ？

在构建每个排列时，该函数正在修改**统一/通用/共享**的数据源：**向量**。随着元素从*unvisited*转移到*visited* ，它们会不断被修改。但是，我们需要**重置**这些向量以找到其余的排列。在上面的示例中，我们需要*将**1**放回**unvisited* find以**5**或**8**开头的排列。所以我们：

```
unvisited.add(i,next); //add it back to unvisited in its original position 
```

和

```
visited.remove(next); //remove it from visited. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T01:16:42.940

关于递归要记住的是，当再次调用该方法时，在满足该调用之前不会执行以下行。

在这种情况下**permute()**首先由 main 调用，它检查我们是否完成（未访问为空）并最终到达**permute(unvisited,visited);** 线。

此时**permute()**的第一次运行被暂停，第二次运行接管，直到第 n 次运行，它发现 unvisited 是空的并且运行完成。

当第 n 次运行结束时，第 n-1 次运行开始执行，然后执行您询问的两行（applepie 解释过），然后完成，将控制权返回给第 n-2 次，依此类推，直到所有运行完成.

# objective-c - 从不同的 .m 文件更改按钮标题

> ID：11371339
> 
> 赞同：0
> 
> 时间：2012-07-07T00:37:07.870
> 
> 标签：objective-c, ios

我正在编写一些适用于多种语言的代码。当用户更改语言时，我需要更改所有屏幕提示和按钮文本。当我在该屏幕的 .m 中时，我只需键入：

```
 [[self.tabBarController.viewControllers objectAtIndex:1] setTitle:@"Setup"]; 
```

但是如何更改其他屏幕中的提示，而无需转到每个 .m 并进行更改。我假设可以替换“自我”以允许我这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T01:09:01.567

听起来您正在尝试使用本地化字符串。这样的事情可能会帮助您找到正确的路径： http: [//www.icanlocalize.com/site/tutorials/iphone-applications-localization-guide/](http://www.icanlocalize.com/site/tutorials/iphone-applications-localization-guide/)

基本上，而不是使用像你这样的字符串，`@"Setup"`你会使用这样的东西

```
[[self.tabBarController.viewControllers objectAtIndex:1] setTitle:
           NSLocalizedString("setup_button_title", "Title for the setup button")]; 
```

# hadoop - 如何将 Hadoop MapReduce 与 HDFS 分离？

> ID：11371341
> 
> 赞同：1
> 
> 时间：2012-07-07T00:37:26.573
> 
> 标签：hadoop, hdfs

我很好奇您是否可以从本质上将 HDFS 文件系统与 MapReduce 框架分开。我知道 Hadoop 的主要目的是在有问题的数据的机器上运行映射和减少，但我想知道你是否可以只更改 *.xml 文件来更改 jobtracker、namenode 和机器的配置数据节点正在运行。

目前，我的配置是 2 个 VM 设置：一个（主）带有 Namenode、Datanode、JobTracker、Tasktracker（和 SecondaryNameNode），另一个（从）带有 DataNode、Tasktraker。本质上，我想要改变的是让主节点具有 NameNode 数据节点、JobTracker，并让从节点只有 TaskTracker 来执行计算（稍后，有更多的从节点上只有 TaskTracker；每个都有一个） . 瓶颈将是两个 VM 之间用于计算 map 和 reduce 的数据传输，但由于这个阶段的数据非常小，我主要不关心它。我只想知道这种配置是否可行，以及如何进行。有小费吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T01:06:06.220

您没有在配置文件中指定此类选项。你需要做的是照顾你在每台机器上启动什么样的守护进程（你称它们为 VM，但我认为你的意思是机器）。

我想您通常使用 start-all.sh 脚本启动所有内容，您可以在 hadoop 安装目录下的 bin 目录中找到该脚本。

如果你看一下这个脚本，你会发现它的作用是调用一些与启动 datanodes、tasktrackers 和 namenode、jobtracker 相对应的子脚本。

为了实现你所说的，我会这样做：

1.  修改 masters 和 slaves 文件如下： Master 文件应该包含 machine1 的名字 Slaves 应该包含 machine2 的名字

2.  运行 start-mapred.sh

3.  修改 masters 和 slaves 文件如下： Master 文件应该包含 machine1 Slaves 文件应该包含 machine1

4.  运行 start-dfs.sh

我必须告诉你，我从未尝试过这样的配置，所以我不确定这是否可行，但你可以试一试。无论如何，解决方案是朝着这个方向！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T03:22:12.780

> 本质上，我想要改变的是让主节点带有 NameNode DataNode(s)、JobTracker，并让从节点只有 TaskTracker 来执行计算（稍后，有更多的从节点上只有 TaskTracker；每个都有一个） .

首先，我不确定为什么要将计算与存储分开。MR locality 的全部目的都丢失了，以为您可能能够成功运行该作业。

使用`dfs.hosts`,`dfs.hosts.exclude`参数来控制哪些数据节点可以连接到 namenode 和`mapreduce.jobtracker.hosts.filename`,`mapreduce.jobtracker.hosts.exclude.filename`参数来控制哪些 tasktracker 可以连接到 jobtracker。这种方法的一个缺点是数据节点和任务跟踪器在被排除且不属于 Hadoop 集群的节点上启动。

另一种方法是修改代码，让 tasktracker 和 datanode 有一个单独的从属文件。目前，这在 Hadoop 中不受支持，需要更改代码。

# php - Facebook PHP 发布手表动作

> ID：11371342
> 
> 赞同：2
> 
> 时间：2012-07-07T00:37:29.077
> 
> 标签：php, facebook, facebook-php-sdk

我想将 Facebook 开放图形功能添加到我的网站。我已经创建了一个动作`(watch) a (video)`。我也设置了我的元标签，如下所示：

```
<meta property="og:title" content="title"/>
<meta property="og:type" content="namespace:video"/>
<meta property="og:url" content="http://www.zzz.com/images.php?i=something"/>
<meta property="og:image" content="http://www.zzz.com/thumbnails/images.png"/>
<meta property="og:site_name" content="site name"/>
<meta property="fb:app_id" content="xxxxxxxxxxx"/>
<meta property="fb:admins" content="xxxxxxxxxxxx"/>
<meta property="og:description" content="desc"/> 
```

我正在使用 PHP SDK 对用户进行身份验证，现在我想在视频页面上发布用户操作，如下所示：

```
require_once('scripts/facebook.php');
        $config = array('appId' => 'xxxxxx','secret' => 'xxxxxxx');
        $facebook = new Facebook($config);
        $facebook_user = $facebook->getUser();
        $facebook_message = array('message'=>$image_caption, 'link'=>'www.zzz.com/videos.php?i='.$video_name.'');
        if($facebook->getUser()){
            try{
                $access_token = $facebook->getAccessToken();
                $params = array('video'=>'http://www.zzz.com/','access_token'=>$access_token);
                $publish = $facebook->api('/me/namespace:watch','post',$params);
                }catch(FacebookApiException $e) {
                        error_log($e->getType());
                        error_log($e->getMessage());
                    } 

            } 
```

无论如何，当我运行此代码时，什么都没有发生？请告诉我我是否在某个地方错了，或者我是否遗漏了什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T08:31:28.823

您不能再有*自定义*监视操作，您必须使用内置操作。

[https://developers.facebook.com/docs/opengraph/actions/builtin/#watch](https://developers.facebook.com/docs/opengraph/actions/builtin/#watch)

# php - 如何使用 PHP 导入 eHarmony 配置文件？

> ID：11371349
> 
> 赞同：1
> 
> 时间：2012-07-07T00:39:53.670
> 
> 标签：php, html, facebook-graph-api

如果您有用户名和密码，那么使用 PHP 从 eHarmony 导入配置文件信息的好方法是什么。我已经使用他们的开放图形系统制作了将 Facebook 信息导入网站的应用程序，但我不知道您将如何为 eHarmony 执行此操作，因为它们没有 Facebook 等开发人员功能。

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:42:18.277

他们的服务条款不允许这样做

# c# - 单个 LINQ 表达式来计算数据集中的几列

> ID：11371360
> 
> 赞同：1
> 
> 时间：2012-07-07T00:42:21.283
> 
> 标签：c#, .net, linq

我有一个`DataSet`有几行和几列的（因为数据集往往有）。我需要在底部创建一个计数行，其中包含每列的总和。我想用一个 LINQ 表达式来做这件事，因为它会简化我的一堆代码。我可以像这样得到一列的总数：

```
var a = (from m in month
         where <some long expression>
         select m["BGCO_MINUTES"] as Decimal?).Sum(); 
```

但是，我也想要其他列的总计。我不想使用多个 LINQ 表达式，因为那里还有一个复杂的*where*子句，而且我正在用各种表达式做几个计数行，并且只想循环遍历这个集合一次。我也不想自己手动循环遍历数据集并将总数相加，因为我正在创建许多这些计数行并且认为它会更混乱。

我想要的是一个匿名类型，它总共包含`BGCO_MINUTES`,`800IB_MINUTES`和`TSDATA_MINUTES`.

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:49:37.880

使用[Aggregate](http://msdn.microsoft.com/en-us/library/bb549218)而不是 Sum，因为它更灵活 - 在遍历每一行时，您将能够拥有对象（或简单的字典）来保存各个列的总和。

（前面的非编译代码）

```
class SumObject { 
  public float First; 
  public float Second; 
}

var filtered = (from m in month
     where <some long expression>
     select m;

filtered.Aggregate(new SumObject(), (currentSum, item)=> { 
  currentSum.First += item.First;  
  currentSum.Second += item.Second;
  return currentSum;
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T01:02:48.253

你可以这样做：

```
// run the filters once and get List<DataRow> with the matching rows
var list = (from m in month
            where <some long expression>
            select m).ToList();

// build the summary object
var result = new {
    BGCO_MINUTES = list.Sum(m => m["BGCO_MINUTES"] as Decimal?),
    _800IB_MINUTES= list.Sum(m => m["800IB_MINUTES"] as Decimal?),
} 
```

这是假设您的 where 子句不仅输入时间长，而且计算成本高。这*将*每列遍历列表一次。

如果您真的只想迭代列表一次，您可以使用[Enumerable.Aggregate](http://msdn.microsoft.com/en-us/library/bb549218)来完成，但代码不太优雅（在我看来）：

```
// run the filters once and get List<DataRow> with the matching rows
var a = (from m in month
         where <some long expression>
         select m)
        .Aggregate(           new { BGCO_MINUTES  = (decimal?)0m,
                                   _800IB_MINUTES = (decimal?)0m },
                    (ac,v) => new { BGCO_MINUTES  = ac.BGCO_MINUTES + (decimal?)v["BGCO_MINUTES"],
                                  _800IB_MINUTES = ac._800IB_MINUTES + (decimal?)v["800IB_MINUTES"] }); 
```

就像我说的，我认为它没有第一个版本那么优雅，但它应该可以工作。即使第一个需要与 where 子句（内存成本）匹配的值的临时副本，并且 1 通过每个字段的列表（CPU 成本），我认为它比后一个版本更具可读性 - 确保在使用不太容易理解的版本之前，性能差异是值得的。

# python - raw_input 时间有限？

> ID：11371363
> 
> 赞同：3
> 
> 时间：2012-07-07T00:42:50.723
> 
> 标签：python, time, input

有没有办法给用户一个 raw_input，但`""`如果在 x 时间内没有输入任何内容，则给出一个空响应（）？我想在脚本启动时给用户 10 秒的时间来输入选项，但是如果时间到期（或者他们按 Enter），只需继续脚本即可。如果你知道 AppleScript，我想`display dialog "Enter options" giving up after 10`用 python

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:46:52.533

如果您在 unix-land 中，您可以使用 python 的信号库并使用[警报](http://docs.python.org/library/signal.html#signal.alarm)。否则，我认为`raw_input`完全是线程阻塞。

请参阅[此答案](https://stackoverflow.com/questions/7875008/how-to-implement-rediss-pubsub-timeout-feature#answer-10049595)以获取实施帮助。

# java - 有效地查找正则表达式的所有重叠匹配

> ID：11371365
> 
> 赞同：0
> 
> 时间：2012-07-07T00:43:09.647
> 
> 标签：java, regex, optimization

这是[所有与 java regex 匹配的重叠子字符串](https://stackoverflow.com/q/11303309/244526)的后续。

有没有办法让这段代码更快？

```
public static void allMatches(String text, String regex)
  {
    for (int i = 0; i < text.length(); ++i) {
      for (int j = i + 1; j <= text.length(); ++j) {
        String positionSpecificPattern = "((?<=^.{"+i+"})("+regex+")(?=.{"+(text.length() - j)+"}$))";
        Matcher m = Pattern.compile(positionSpecificPattern).matcher(text);

        if (m.find()) 
        {   
          System.out.println("Match found: \"" + (m.group()) + "\" at position [" + i + ", " + j + ")");
        }   
      }   
    }   
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T05:54:34.940

在另一个问题中，您提到了 Matcher 的`region()`方法，但您没有充分利用它。使它如此有价值的是锚点将在区域边界匹配，就好像它们是独立字符串的边界一样。这是假设您已经`useAnchoringBounds()`设置了选项，但这是默认设置。

```
public static void allMatches(String text, String regex)
{
  Matcher m = Pattern.compile(regex).matcher(text);
  int end = text.length();
  for (int i = 0; i < end; ++i)
  {
    for (int j = i + 1; j <= end; ++j) 
    {
      m.region(i, j);

      if (m.find()) 
      {   
        System.out.printf("Match found: \"%s\" at position [%d, %d)%n",
                          m.group(), i, j);
      }   
    }   
  }   
} 
```

给定您的示例字符串和正则表达式：

```
allMatches("String t = 04/31 412-555-1235;", "^\\d\\d+$"); 
```

...我得到这个输出：

```
Match found: "04" at position [11, 13)
Match found: "31" at position [14, 16)
Match found: "41" at position [17, 19)
Match found: "412" at position [17, 20)
Match found: "12" at position [18, 20)
Match found: "55" at position [21, 23)
Match found: "555" at position [21, 24)
Match found: "55" at position [22, 24)
Match found: "12" at position [25, 27)
Match found: "123" at position [25, 28)
Match found: "1235" at position [25, 29)
Match found: "23" at position [26, 28)
Match found: "235" at position [26, 29)
Match found: "35" at position [27, 29) 
```

# ruby-on-rails - 在Passenger下将Rails应用程序部署到Dreamhost时“检测到意外的文件结尾”

> ID：11371372
> 
> 赞同：3
> 
> 时间：2012-07-07T00:44:52.260
> 
> 标签：ruby-on-rails, capistrano, passenger, dreamhost

我对 Rails 应用程序比较陌生，但我有一个在本地工作的 Rails 应用程序，我正试图将其部署到 DreamHost 上的共享托管服务器。我已经关注了所有 wiki 和 stackoverflow 的问题，但我仍然没有找到答案。

我正在使用 Capistrano 进行部署，并且我已经解决了所有问题以使部署成功。但是，当我访问站点上非静态资源的任何内容时，我会收到“内部服务器错误”以及来自乘客的此错误：

```
Internal server error
Passenger encountered the following error:
The application spawner server exited unexpectedly: Unexpected end-of-file detected.

Exception class:
PhusionPassenger::Rack::ApplicationSpawner::Error
Backtrace:
#   File    Line    Location
0   /dh/passenger/lib/phusion_passenger/rack/application_spawner.rb 134 in `start'
1   /dh/passenger/lib/phusion_passenger/spawn_manager.rb    253 in `spawn_rack_application'
2   /dh/passenger/lib/phusion_passenger/abstract_server_collection.rb   132 in `lookup_or_add'
3   /dh/passenger/lib/phusion_passenger/spawn_manager.rb    246 in `spawn_rack_application'
4   /dh/passenger/lib/phusion_passenger/abstract_server_collection.rb   82  in `synchronize'
5   /dh/passenger/lib/phusion_passenger/abstract_server_collection.rb   79  in `synchronize'
6   /dh/passenger/lib/phusion_passenger/spawn_manager.rb    244 in `spawn_rack_application'
7   /dh/passenger/lib/phusion_passenger/spawn_manager.rb    137 in `spawn_application'
8   /dh/passenger/lib/phusion_passenger/spawn_manager.rb    275 in `handle_spawn_application'
9   /dh/passenger/lib/phusion_passenger/abstract_server.rb  357 in `__send__'
10  /dh/passenger/lib/phusion_passenger/abstract_server.rb  357 in `server_main_loop'
11  /dh/passenger/lib/phusion_passenger/abstract_server.rb  206 in `start_synchronously'
12  /dh/passenger/helper-scripts/passenger-spawn-server 99 
```

我可以通过 SSH 连接到服务器并手动运行“rails s”以使服务器在 3000 端口上运行，并且一切正常。

这是我的环境.rb：

```
# Load the rails application
require File.expand_path('../application', __FILE__)

# Initialize the rails application
LoLItemDb::Application.initialize!

# potential fix for Dreamhost shared resources
# from: http://stackoverflow.com/a/3214748/189292
require 'rubygems'
require 'rubygems/gem_runner'
ENV['GEM_PATH'] = '/home/gravitydev/ruby/gems:/usr/lib/ruby/gems/1.8'
Gem.clear_paths 
```

部署.rb：

```
user = "XXXXXXXXX"
domain = "XXXXXXXXX.com"
database = "mysql.XXXXXXXXX.com"

set :application, "XXXXXXXXX"
set :rails_env, "production"
set :use_sudo, false

# set rake to be verbose for capistrano
# http://stackoverflow.com/questions/7071126/how-can-i-run-rake-with-trace-within-capistrano
set :rake, "#{rake} --trace"

# here we set a custom paths to commands since on Dreamhost
# servers the user path is a bit different
set :bundle_cmd, "/home/#{user}/.gems/bin/bundle"
require 'bundler/capistrano'

# redirect path for whenever, and use bundler to execute it
set :whenever_command, "/home/#{user}/.gems/bin/bundle exec whenever"
require 'whenever/capistrano'

# configure credentials
set :user, user
set :password, "XXXXXXXXX"

# configure git
default_run_options[:pty] = true                          # Must be set for the password prompt
                                                          # from git to work
set :repository, "git@github.com:XXXXXXXXX/XXXXXXXXX.git"  # Your clone URL
set :deploy_to, "/home/#{user}/#{domain}"
set :scm, "git"
set :scm_passphrase, "XXXXXXXXX"                    # The deploy user's password
set :scm_verbose, true
set :git_shallow_clone, 1

# configure deploy location
set :deploy_to, "/home/#{user}/#{domain}"

# setup web server
server domain, :app, :web, :db, :primary => true
#server domain, :app, :web
#role :db, database, :primary => true

# for SSH
# see: http://wiki.dreamhost.com/Capistrano
set :chmod755, "app config db lib public vendor script script/* public/disp*"

# if you want to clean up old releases on each deploy uncomment this:
after "deploy:restart", "deploy:cleanup"

# run the all "LoL" tasks to refresh the database
#after "deploy:restart", "lol:all"

# if you're still using the script/reaper helper you will need
# these http://github.com/rails/irs_process_scripts

# for Passenger
namespace :deploy do
  task :restart do
    run "touch #{current_path}/tmp/restart.txt"
  end
end 
```

和 GEMFILE：来源 'https://rubygems.org'

```
gem 'rails', '3.2.6'
gem 'bundler'
gem 'rake'
gem 'sqlite3'
gem 'haml'
gem 'nokogiri'
gem 'json'
gem 'whenever'
gem 'execjs'
gem 'therubyracer', :platforms => :ruby
gem 'mysql2'
gem 'rack'
gem 'RedCloth', '4.2.9'
gem 'jquery-rails'
gem 'capistrano'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end 
```

大多数帖子似乎表明 gems 的路径不正确，但我已经通过搜索 Google 和 Dreamhost 的文档找到了所有配置更改。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T19:22:25.347

在搞砸了很长一段时间后，有几件事让我找到了解决方案。首先，在部署到 Dreamhost 时，您需要像这样覆盖 config.ru 中的 GEM_HOME 路径：

```
# taken from https://discussion.dreamhost.com/thread-128599.html
ENV['GEM_HOME'] = '/home/USERNAME/.gems'
require 'rubygems'
Gem.clear_paths 
```

此外，我阅读了 abhas 的评论，这让我认为我`Gemfile`需要我不需要指定的宝石。基本上，我之前添加了它们来尝试模仿我的本地 gem 安装，但发现我并不需要它们。我的最终`Gemfile`看起来像这样：

```
source 'https://rubygems.org'

gem 'rails', '3.2.6'
gem 'bundler'
gem 'rake'
gem 'sqlite3'
gem 'haml'
gem 'nokogiri'
gem 'whenever'
gem 'mysql'
gem 'mysql2'
gem 'jquery-rails'
gem 'capistrano'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end 
```

进行这些更改后，Passenger 很高兴并找到了所有需要的宝石！感谢 abhas 让我考虑在正确的领域做出改变。

编辑：当 StackOverflow 允许我时，我会接受这个答案:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T12:45:00.733

在你的 gemfile 中改变这个

```
gem 'RedCloth', :require => 'redcloth' 
```

它可能会起作用

# javascript - 调整大小的图表呈现问题 容器

> ID：11371374
> 
> 赞同：5
> 
> 时间：2012-07-07T00:45:08.010
> 
> 标签：javascript, jquery, css, jquery-ui, highcharts

调整容器大小时，我有**两个**关于图表渲染的问题。

**首先**是，如何在调整其容器大小时正确呈现图表..

即最大化/恢复问题，在第一次渲染时它工作得很好，但是当我恢复窗口的大小时，图表开始覆盖它以前的大小。从以下图片可以看出： ![在此处输入图像描述](../Images/2bd27c905e313c3dc6a689eb65653f6f.png)![在此处输入图像描述](../Images/b0d41c62189da73b810f9f6392bfe07b.png)

我知道如果您设置一个调整大小处理程序（并等待一小段时间）以在调整窗口大小时刷新图表，问题就可以解决。我在想是否有其他方法可以让图表流动到正确的大小，而无需每次都刷新图表。

第二件事是：如果图表区域在一个**容器**`<div>`中，并且容器的大小将随着调整大小条而变化。我使用以下代码使其与窗口大小调整一起使用。但它**不适**用于移动的调整大小栏。

```
$(window).resize(function () {
        setTimeout(function () {
            createChart(chartData);
        }, 300);
    }); 
```

**注意**：网格组件在任何情况下都可以正常工作，而我总是遇到麻烦的图表。我正在使用 HighCharts、kendoUI 网格，它们都在 jQueryUI portlet 中呈现。

任何意见表示赞赏！这个问题花了我很长时间..

**更新：**由于我认为我对这个问题的解释不够清楚，我添加了[**JSFiddle 示例**](http://jsfiddle.net/jxTUw/)以便更好地理解。基本上我想要两件事：1。当窗口调整大小时，重新排列图表的大小以适应其容器；2.当调整大小条移动时，重新排列图表的大小以适合其容器。

在本例中，我使用插件[highcharts](http://www.highcharts.com/)进行图表绘制，使用[jQuery UI Layout](http://layout.jquery-dev.net/)进行布局管理。对于我正在使用的其他一些插件，请参考[**这里**](https://stackoverflow.com/questions/11378324/is-it-recommended-to-use-a-lot-of-jquery-plugins-in-your-project)，我不确定它们是否有冲突。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T13:58:40.437

我不相信如果不挂钩调整大小事件并重新绘制图表就可以完成您想要的事情。

要解决您的“div”调整大小问题，请查看类似[这样](http://benalman.com/projects/jquery-resize-plugin/)的内容，它允许您将调整大小事件绑定到窗口以外的事物（您的情况是您的“容器”div）。

这是它在行动中的一个[小技巧。](http://jsfiddle.net/jxTUw/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-25T14:31:37.237

有类似的问题并通过以下方式解决了它：

在定义将包含 higcharts 图表的可调整大小的 div 时：

```
 $("#container").resizable({
            resize: function (event, ui) {
                var delay = 1000;
                setTimeout(function () {
                    $(window).resize();
                }, delay);
            }
        }); 
```

在图表的定义中：

```
 var chart = new Highcharts.Chart({
           .........
            $(window).resize(function() {
                chart.reflow();
           ..........
            }); 
```

所以基本上，你正在延迟调整窗口的大小。不是很优雅，但对我来说很好。

# fastcgi - fastcgi 对于高性能网站有什么缺点？

> ID：11371376
> 
> 赞同：4
> 
> 时间：2012-07-07T00:45:22.080
> 
> 标签：fastcgi

我读过一些评论说 fastcgi 不是高性能网站的好选择：

[nginx、fastcgi 和开放式套接字](https://stackoverflow.com/questions/7616601/nginx-fastcgi-and-open-sockets)

具体是什么使它成为一个糟糕的选择？还有哪些其他解决方案（上面的线程建议共享内存或直接在应用程序中构建 HTTP 支持）可能更好，为什么？

# logging - 在上游作业中显示下游作业的控制台输出

> ID：11371383
> 
> 赞同：4
> 
> 时间：2012-07-07T00:46:44.920
> 
> 标签：logging, jenkins, console

我正在使用詹金斯。

Jenkins 有一份上游工作：A
Jenkins 有一份下游工作：B

A 的控制台日志输出为：

```
1
2
3 
```

B 的控制台日志输出为：

```
A
B
C 
```

我想要得到的是：

有什么办法，我可以在作业 A 的控制台日志中获取作业 B 的控制台输出，然后决定作业“A”是否成功（使用日志解析/grep 关键字来表示失败/错误等）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-08T08:33:08.597

不知道你想达到什么，但它看起来相当做作。看看以下方法是否符合您的需求：作为构建步骤，通过[参数化触发器插件](https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Trigger+Plugin)从*Job A启动**Job B。**A*可以选择等待*B*，然后根据*B调整**A 的*构建结果。

 **** * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-03T02:17:55.737

一种快速简便的方法是只使用 curl

IE

```
curl http://myJenkinsServer:9090/job/ProjectNamel/$childJobLastBuildNumber/consoleFull  | sed "s#<span class="timestamp"><b>##g;s#</b> </span># #g" 
```

... 其中 $childJobLastBuildNumber 是子/下游作业的最新/最后构建#。

使用 curl 和 sed - 现在我可以在父作业中显示子/下游作业的输出，如果我运行上面的*curl | sed ..***执行 Shell**中的命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-18T21:55:26.317

**获取作业 B 的控制台输出。**

我没有找到比使用`cat`. 您必须将“作业 B 触发器”步骤设置为`block`. 因此，在工作 B 完成之前，工作 A 不会完成。然后在“job B trigger”步骤之后，添加一个执行shell脚本的步骤。

```
cat "$JENKINS_HOME/jobs/<PATH_TO_YOUR_JOB>/builds/$TRIGGERED_BUILD_NUMBER_<FOLDER_AND_JOB_NAME>/log" 
```

请注意，这`$TRIGGERED_BUILD_NUMBER_<FOLDER_AND_JOB_NAME>`是 Jenkins 动态注入的环境变量。

**根据作业 B 判断作业 A 是否失败。**

您不必解析下游作业的控制台输出。在上游作业的配置中，当触发作业 B 时，您可以选择。喜欢：

> *   如果触发的构建更差或等于，则此构建步骤失败
> *   如果触发的构建更差或等于，则将此构建标记为失败
> *   如果触发的构建更差或等于，则将此构建标记为不稳定***

# javascript - 在 HTML 页面中嵌入动画 SVG，暂停（不启动动画）

> ID：11371385
> 
> 赞同：2
> 
> 时间：2012-07-07T00:47:14.167
> 
> 标签：javascript, html, animation, svg

您可以将 SVG 文件嵌入到 (X)HTML 5 文档中：

```
<object data="anim.svg" id="svganim"/> 
```

或者

```
<img src="anim.svg" alt="embedded SVG"/> 
```

但如果`anim.svg`是动画，则动画将在页面加载后立即开始播放。

**如何嵌入动画 SVG 文件以使动画开始时暂停？**然后用户可以通过按下按钮来播放动画（`unpauseAnimations()`在 Javascript 中使用）

### 不优雅的方式

```
window.onload = function() {
    var svg_anim = document.getElementById('svganim').contentDocument.rootElement;
    svg_anim.pauseAnimations();
}; 
```

缺点：如果嵌入的 SVG 与父文档处于不同的安全上下文中，这将不起作用。有没有更好的办法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T08:50:14.667

解决此问题的一种方法是通过更改 svg 文件来使动画不会自动启动（将 begin="indefinite" 添加到任何自动启动的动画中）。然后可以通过调用要触发`beginElement()`的动画元素来触发这些动画。如果你有很多这样的元素，它可能更容易使用`pauseAnimations()`。

但是，对于 <img> 元素，您无法启动动画，因为不会将任何事件输入到 svg 本身中，因此这不会在那里工作。在这种情况下，脚本也被禁用，因此您也不能以这种方式触发或阻止动画。

使用 <object>、<embed> 或 <iframe>，您可以编写脚本，例如您的建议。您可以添加一个脚本标记作为 svg 文件的 svg 根元素的第一个子元素之一，并在该 <script> 元素调用`pauseAnimations`中。但是您也可以按照您的建议从主文档中执行此操作。

# php - 如何使用表扫描优化查询？

> ID：11371388
> 
> 赞同：1
> 
> 时间：2012-07-07T00:48:03.340
> 
> 标签：php, mysql, sql, query-optimization, innodb

这是迄今为止我的 Web 应用程序中最慢的查询。

```
SELECT prof.user_id                      AS userId,
       prof.first_name                   AS first,
       prof.last_name                    AS last,
       prof.birthdate,
       prof.class_string                 AS classes,
       prof.city,
       prof.country,
       prof.state,
       prof.images,
       prof.videos,
       u.username,
       u.avatar,
       (SELECT Count(*)
        FROM   company_member_sponsorship
        WHERE  member_id = prof.user_id
               AND status = 'sponsored') AS sponsor_count,
       (SELECT Count(*)
        FROM   member_schedules
        WHERE  user_id = prof.user_id)   AS sched_count
FROM   member_profiles prof
       LEFT JOIN users u
              ON u.id = prof.user_id
ORDER  BY ( prof.images + prof.videos * 5 + (
            CASE
              WHEN prof.expire_date > :time THEN 50
              ELSE 0
            end ) + sponsor_count * 20 + sched_count * 4
          ) DESC,
          prof.last_name ASC
LIMIT  :start, :records 
```

即使在各个级别发生大量查询，站点上的所有其他内容也只需不到一秒的时间即可加载。这大约需要 3-4 秒。

显然是表扫描导致了减速。我能理解为什么；第一个表有 50,000+ 行，第二个表有 160,000+ 行。

有什么方法可以优化此查询以使其运行得更快吗？

如果情况变得更糟，我总是可以通过我的代码并在个人资料表中维护赞助和事件的记录，就像我对图像和视频所做的那样，尽管我想避免它。

编辑：我在查询中添加了 EXPLAIN 的结果。

```
id  select_type         table                       type    possible_keys   key         key_len ref                         rows    Extra
1   PRIMARY             prof                        ALL     NULL            NULL        NULL    NULL                        44377   Using temporary; Using filesort
1   PRIMARY             u                           eq_ref  PRIMARY         PRIMARY     3       mxsponsor.prof.user_id      1   
3   DEPENDENT SUBQUERY  member_schedules            ref     user_id         user_id     3       mxsponsor.prof.user_id      6       Using index
2   DEPENDENT SUBQUERY  company_member_sponsorship  ref     member_id       member_id   3       mxsponsor.prof.user_id      2       Using where; Using index 
```

编辑2：

我最终通过在会员资料中维护计数来解决这个问题。无论在哪里添加/删除赞助/活动，我只需调用一个扫描赞助/活动表并更新该成员计数的函数。可能还有一种方法可以优化这样的查询，但是我们很快就会发布这个网站，所以我现在要使用快速而肮脏的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T01:46:24.220

不保证有效，但尝试使用`join`and`group by`而不是内部选择：

```
SELECT prof.user_id      AS userId,
       prof.first_name   AS first,
       prof.last_name    AS last,
       prof.birthdate,
       prof.class_string AS classes,
       prof.city,
       prof.country,
       prof.state,
       prof.images,
       prof.videos,
       u.username,
       u.avatar,
       Count(cms.id)     AS sponsor_count,
       Count(ms.id)      AS sched_count
FROM   member_profiles prof
       LEFT JOIN users u
              ON u.id = prof.user_id
       LEFT JOIN company_member_sponsorship cms
              ON cms.member_id = prof.user_id
                 AND cms.status = 'sponsored'
       LEFT JOIN member_schedules ms
              ON ms.user_id = prof.user_id
GROUP  BY u.id
ORDER  BY ( prof.images + prof.videos * 5 + (
            CASE
              WHEN prof.expire_date > :time THEN 50
              ELSE 0
            end ) + sponsor_count * 20 + sched_count * 4
          ) DESC,
          prof.last_name ASC
LIMIT  :start, :records 
```

如果那不是更好，那么`explain`该查询会有所帮助。

# android - Android Base Activity：Base的全局变量，无法从某些活动中获取

> ID：11371389
> 
> 赞同：0
> 
> 时间：2012-07-07T00:48:36.953
> 
> 标签：android, global-variables

我现在正在上一个 android 课程，所以我对 android 应用程序开发有点陌生。

我对基本活动的第一个假设是它是全局变量，并且它的值可用于所有活动。我发现它可用于我的主要活动，但之后没有任何活动。

在基本活动中，我存储了一个对象的 ArrayList。我还从那里的 xml 加载数据，将对象添加到 arrayList。一旦进入主活动，我仍然可以访问该 arrayList 及其值。我用它来填写清单。但是当我进入下一个活动时，它知道 arrayList 但认为它是空的。

我是否需要在基本活动中创建方法来检索 arrayList 并将对象添加到数组列表中？

任何帮助，将不胜感激。

谢谢，

米歇尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T09:19:31.993

全局变量需要声明`static`。然后他们可以从任何班级访问。例子：

```
public class Globals {
    public static String myString;
} 
```

任何类都可以像这样读/写 myString：

```
Globals.myString = "foo"; 
```

或者

```
String bar = Globals.myString; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T01:45:43.753

根据经验，我相信一个活动的变量仅在活动处于活动状态时对另一个活动可用，这意味着在 onCreate 和 onDestroy 之间，除此之外你可能会得到一个空指针异常，你真正应该做的是发送数据或数组，以及其他活动的意图。

我认为您不应该调用其他活动变量，尽管如上所述是可能的。我相信当活动拥有它的 onDestroy 方法时，活动中的对象被销毁并从内存中删除。摧毁他们持有的任何东西。

这是什么基础活动？它只是扩展活动吗？然后 MainActivity 也在扩展 Activity 吗？任何时候只有一个活动可用，如果你在做我认为你在做的事情，你应该有一项服务可以在应用程序的整个周期内为你提供一切，只要记住在完成后停止它。

# php - 如何获取第一级 dom 图像 src

> ID：11371391
> 
> 赞同：0
> 
> 时间：2012-07-07T00:49:21.657
> 
> 标签：php, dom

是一种无需 foreach 即可获得图像 src 的第一个值的方法？

```
$doc->loadHTML($description);

foreach ($doc->getElementsByTagName('img') as $image) {
    echo $image->getAttribute('src');
} 
```

这是行不通的`$doc->getElementsByTagName('img')->item(0)->nodeValue);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:52:37.900

这应该有效：

```
echo $doc->getElementsByTagName('img')->item(0)->getAttribute('src'); 
```

# eclipse - Tomcat 未通过 Eclipse 启动（超时）

> ID：11371393
> 
> 赞同：31
> 
> 时间：2012-07-07T00:49:33.520
> 
> 标签：eclipse, tomcat

我正在尝试通过 Eclipse 运行 Tomcat。这是我过去几年所做的事情。昨天还在工作，现在不行了。我得到的错误是

```
Server Tomcat v7.0 Server at localhost was unable to start within 45 seconds. If the server requires more time, try increasing the timeout in the server editor. 
```

输出是

```
Jul 06, 2012 8:32:26 PM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: D:\Program Files\Java\jdk1.7.0_05\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:\Program Files (x86)\NVIDIA Corporation\PhysX\Common;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Program Files (x86)\QuickTime\QTSystem\;D:\Launch;D:\Program Files\Java\jdk1.7.0_05\bin;%PROGRAMFILES%\Internet Explorer;C:\Program Files (x86)\SMLNJ\bin\;D:\Program Files\TortoiseSVN\bin;C:\ghc\ghc-6.6\bin;D:\Program Files\MySQL\MySQL Server 5.5\bin;%ANT_HOME%/bin;D:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\;D:\Program Files\Microsoft SQL Server\100\Tools\Binn\;D:\Program Files\Microsoft SQL Server\100\DTS\Binn\;D:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\;C:\Program Files (x86)\Microsoft Visual Studio 9.0\Common7\IDE\PrivateAssemblies\;D:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\;D:\Program Files (86x)\;.
Jul 06, 2012 8:32:26 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
Jul 06, 2012 8:32:26 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["ajp-bio-8009"]
Jul 06, 2012 8:32:26 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 468 ms
Jul 06, 2012 8:32:26 PM org.apache.catalina.core.StandardService startInternal
INFO: Starting service Catalina
Jul 06, 2012 8:32:26 PM org.apache.catalina.core.StandardEngine startInternal
INFO: Starting Servlet Engine: Apache Tomcat/7.0.28
Jul 06, 2012 8:32:26 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory D:\Program Files\Java\apache-tomcat-7.0.28\webapps\docs
Jul 06, 2012 8:32:26 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory D:\Program Files\Java\apache-tomcat-7.0.28\webapps\examples
Jul 06, 2012 8:32:26 PM org.apache.catalina.core.ApplicationContext log
INFO: ContextListener: contextInitialized()
Jul 06, 2012 8:32:26 PM org.apache.catalina.core.ApplicationContext log
INFO: SessionListener: contextInitialized()
Jul 06, 2012 8:32:26 PM org.apache.catalina.core.ApplicationContext log
INFO: ContextListener: attributeAdded('org.apache.jasper.compiler.TldLocationsCache', 'org.apache.jasper.compiler.TldLocationsCache@5710ddf9')
Jul 06, 2012 8:32:26 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory D:\Program Files\Java\apache-tomcat-7.0.28\webapps\host-manager
Jul 06, 2012 8:32:26 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory D:\Program Files\Java\apache-tomcat-7.0.28\webapps\manager
Jul 06, 2012 8:32:26 PM org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory D:\Program Files\Java\apache-tomcat-7.0.28\webapps\ROOT
Jul 06, 2012 8:32:26 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-8080"]
Jul 06, 2012 8:32:26 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["ajp-bio-8009"]
Jul 06, 2012 8:32:26 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 504 ms 
```

我已经四处寻找解决方案几个小时了。但我没有取得任何成功，这可能很简单。我尝试了以下方法：

1.  删除Serve并在eclipse中重新制作
2.  重启电脑，eclipse
3.  重新安装eclipse、tomcat
4.  使用 -clean 启动 Eclipse
5.  启动没有 Web 应用程序的服务器
6.  增加超时

我能够从命令行启动tomcat就好了。但是，我需要通过 eclipse 运行它来调试。我知道[这个 SO 帖子](https://stackoverflow.com/questions/8960350/tomcat-7-when-a-servlet-project-is-included-is-not-staring-within-45-seconds.)，并且已经通过它和许多其他的无济于事。

想法？

更新：我刚刚意识到服务器确实启动了。但是，eclipse 执行的最终功能之一失败了。我观察到这一点的方法是将超时设置为 10 分钟。在那段时间我能够访问服务器，但不能访问 Eclipse 的调试功能。所以 Eclipse 启动它，尝试做一些事情，但事情永远不会完成，Eclipse 在超时时间之后关闭了 Tomcat。

更新：回顾出现此问题时发生的情况，计算机显然安装了 Java 更新。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-10-05T11:45:09.143

Java 更新给我带来了同样的问题（等等）。该更新导致 Eclipse 在 ping Tomcat 时使用 ipv6，并且由于某种原因不适用于我的设置。

我通过添加来修复它

```
-Djava.net.preferIPv4Stack=true 
```

到`eclipse.ini`.

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-06-16T21:33:45.247

我发现这可能是由于无效/损坏/？？？在“调试”中开始时代码中的断点。它通常伴随着缓慢的启动时间。

“删除所有断点”为我清除了这一点。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-05-01T08:40:26.863

我的系统**（Windows 7 pro 64 位）**也有类似的问题，Tomcat 没有从任何 Eclipse 版本开始。事实证明，默认情况下**Eclipse 使用系统网络配置**，如果您配置了不能解析 localhost 的代理，**Tomcat 启动将在 Eclipse 中挂起**！

要查看您是否有此问题，请转到`Window -> Preferences -> General -> Network Connections`并查看是否选中了其中一​​个框。**我可以通过将Active Provider**设置为`Direct`（它取消选中所有框）来覆盖我的代理配置。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-01-27T21:50:38.173

在我的例子中，我禁用了端口 8080 上的 HTTP/1.1 连接器，而使用了端口 8443 上的 SSLEnabled (https) HTTP/1.1 连接器。

我不确定 Eclipse/Tomcat 通信是否由于错误的端口或错误的协议而失败，但是当我将端口 8080 上的 HTTP/1.1 连接器添加回我的 server.xml 时（除了端口上的安全连接器8443），Eclipse 能够正确检测到 Tomcat 的成功启动。

看来，要让 Eclipse 识别 Tomcat 已成功启动，必须​​将 Tomcat 配置为在端口 8080 上具有非 SSL 连接器。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-11-21T22:14:18.930

我能够通过执行以下操作来解决此问题：

*   右键单击 Tomcat 服务器（在 Eclipse Servers 透视图下）
*   选择打开 - 它应该打开 xml 编辑器
*   查找 Timeouts 部分并将值增加到 > 45s

这适用于 Eclipse Helios / Tomcat 7

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-10-20T18:47:19.847

好吧，我尝试了所有这些选项，但我无法让我最近版本的 STS（Spring Tool Suite 3.7.1.201510041213-RELEASE）确定 Tomcat 已经启动。

我试过 Tomcat 7.0.64、8.0.26、8.0.28。所有结果都相同。我确实让 vanilla Tomcat 安装工作，所以我认为它一定是我的 server.xml（或其他文件）有问题。

所以我逐行遍历，直到服务器视图停止获取启动状态。长话短说，在连接器上设置`secure`属性（设置为任何值，例如`false`）会导致 STS 假定它是另一个 SSL 处理程序。

例如：

```
<Connector secure="false" executor="conPool" port="8080" redirectPort="8443" protocol="HTTP/1.1" /> 
```

会导致 STS 崩溃，同时：

```
<Connector executor="conPool" port="8080" redirectPort="8443" protocol="HTTP/1.1" /> 
```

按预期工作。

看起来 STS 假设仅具有安全属性，而不管值如何，它都是一个 SSL 处理程序。旧版本的 STS 似乎没有这个问题。有人已经提交[了一个非常类似的错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=446387)。

另请注意，服务器配置窗格显示：

[![在此处输入图像描述](../Images/a7bf684611d8445b2755792974470aad.png)](https://i.stack.imgur.com/O68Jk.png)

当 server.xml 具有`secure`非 SSL 连接器上的属性时（并且行为有些不稳定），并且：

[![在此处输入图像描述](../Images/bcc8e46d20492e6b9a6bbb2d0baa642a.png)](https://i.stack.imgur.com/HIyAS.png)

删除时列出的正常端口。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-05-28T16:40:23.850

在这里遇到同样的问题。尝试了其他人提出的所有这些解决方案，但没有一个对我有用。

1.  将 http 1.1 端口更改为 8090。
2.  将 -Djava.net.preferIPv4Stack=true 添加到 eclipse.ini （在我的例子中是 STS.ini）。
3.  在 Window -> Preferences -> General -> Network Connections 中，将 Active Provider 设置为 Direct 或 Manual。
4.  将 127.0.0.1 localhost 添加到 hosts localdns 文件 (C:\Windows\System32\drivers\etc\hosts)

最后，我意识到这一切都是因为我将 tomcat 原生库放入其中。我删除了它并恢复了上面的所有更改，它现在可以工作了。无论如何，感谢您的所有帮助，帮助我将问题与本机库联系起来。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-06-08T07:08:57.947

我弄乱了我的 /etc/hosts 文件并删除了我在 Eclipse 中设置的别名。所以

1.  转到窗口 > 显示视图 > 服务器
2.  双击Tomcat v7.0（这是我得到的版本）
3.  在“主机名：”字段中检查您是否有有效的别名 - 如果不确定，请使用 localhost 或检查 /etc/hosts 或 %systemroot%\system32\drivers\etc\hosts

延长超时只会延迟不可避免的事情，它会解决症状而不是原因。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-08-11T08:18:28.893

当主机名设置为 localhost 时，请确保 Tomcat 实际上正在侦听 127.0.0.1。

在 Eclipse 中启动 Tomcat 服务器时，日志会显示如下内容：

```
10:07:23 INFO  main o.a.c.h.Http11NioProtocol Initializing ProtocolHandler ["http-nio-192.168.2.63-8080"] 
```

您的 Tomcat 服务器配置“主机名”和 HTTP/1.1 端口必须解析为显示的 IP 地址和 HTTP 端口（在给定示例中为 IP 192.168.2.63 端口 8080）

这用 Eclipse 4.5 (Mars) & Tomcat 8 修复了它

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-03-29T08:48:53.080

在尝试了上述所有解决方案后仍然面临同样的问题。我通过将 http 连接器添加到 server.xml 解决了这个问题。事实上，在解决问题之前，我只有 https 连接器。似乎eclipse通过请求http url来寻找tomcat启动，一旦删除eclipse无法确定tomcat是否成功启动。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-03-24T07:36:05.293

我遇到了同样的问题。我做了所有这些事情。

1.  在系统属性中添加了所有环境变量。
2.  `Window -> Preferences -> General -> Network Connections`将**Active Provider**转为**Manual**。
3.  `-Djava.net.preferIPv4Stack=true`在**eclipse.ini**文件`-vmargs`中添加。
***   超时时间从 45 秒增加。*   更新了 Eclipse。**

 **希望这可以帮助.. ！！！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-05-28T17:39:48.507

这是一篇非常古老的帖子，但这些解决方案中没有*一个*对我有用。我必须在这篇文章和其他文章中结合使用答案才能使其正常工作。这就是我所做的；

*   添加`127.0.0.1 localhost`到主机文件
*   添加`-Djava.net.preferIPv4Stack=true`到 eclipse.ini 文件
*   将**Active Provider**设置为**Manual** in`Window > Preferences > General > Network Connections`
*   **将主机名**更改为`Servers (view) > Overview (pane)`计算机的网络 IP。
*   禁用**自动重新**加载`Server (view) > Module (pane) > Module (list item) > Edit (action button)`

**参考**

> *   [Eclipse 无法检测到服务器已启动](https://stackoverflow.com/a/5301053/1799502)
> *   [Tomcat 未通过 Eclipse 启动（超时）](https://stackoverflow.com/a/42993881/1799502)
> *   [Tomcat 未通过 Eclipse 启动（超时）](https://stackoverflow.com/a/23917342/1799502)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-07-13T18:42:43.157

我只是在这里注意到了同样的错误。Eclipse Juno + Apache 7（7.0.27 和 7.0.29）。

服务器启动，我可以使用应用程序，但仍然引发超时错误。

使用 Eclipse Indigo SR2 它可以正常运行。我还注意到我的 JAVA_HOME 和 JRE_HOME 变量被删除了（可能是由于一些 Java 更新），所以我再次设置了变量。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-10-11T07:11:12.537

转到 Windows --> Preferences --> NetworkConnections --> 有一个包含三个值的下拉列表：

1.  直接的
2.  手动的
3.  本国的

默认情况下它是本机的，因此选择手册并单击`Apply`。

它适用于带有 Tomcat 7 的 Eclipse Juno EE。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-05-06T07:20:42.817

我解决了这个麻烦添加

```
127.0.0.1 localhost 
```

到主机 localdns 文件（C:\Windows\System32\drivers\etc\hosts），似乎这个问题是由于 localhost 名称上的 ipv6 造成的。

要了解这是否是问题，请尝试*ping localhost*并查看是否已解决 ad ipv4 或 ipv6。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-03-27T16:09:44.873

Eclipse 和 tomcat 适配器与 nio 协议损坏。将 server.xml 中端口标记中的协议更改为`protocol="HTTP/1.1"`.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-11-03T06:45:28.720

从左侧面板双击您的服务器并增加时间限制

[![在此处输入图像描述](../Images/d34652ca9fb1df12eb2cf19174855c5e.png)](https://i.stack.imgur.com/15yri.png)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-09-19T21:13:12.503

您还必须验证您没有运行最新版本的 java jdk（例如 1.8），如果是这种情况，请将您的 eclipse 配置为使用旧版本（例如 1.7）。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-07-19T05:19:55.383

看起来 Eclipse 正在验证 Tomcat 在 :8080 上的运行状态。

当我禁用所有连接器但一个用于 SSL 连接 (:8443) 时，我在 Eclipse+Tomcat 上遇到了类似的问题。

为了避免这个问题，我在 server.xml 中留下了**:8080和 :8443 连接器。**

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-11-20T05:58:02.753

我今天遇到了这个问题，我按照上面的说明进行操作，但没有任何效果。最后我在服务器选项卡上删除了我的 tomcat 配置并更新了一个，在服务器位置，我选择“使用工作区元数据（不修改 Tomcat 安装）”，如果这些选项是灰色的，无法更改，尝试更改下面的服务器选项，它将起作用。

* * *

PS：这个问题似乎与代理设置无关，因为我在网络连接中选择了本机选项并使用了代理。当我更改服务器位置时，Tomcat 不再卡住，尽管正在准备启动委托选项卡再次出现。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-10-09T01:20:05.053

双击本地主机上的 Tomcat v7.0 服务器，将“主机名”更改为您的 IP（IPv4）。它曾经是“本地主机”

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-05-31T10:45:17.943

我遇到了同样的问题并遵循了提供的大多数解决方案，但它们对我不起作用。

我的一位前辈告诉我问题的原因。以前，我使用**mvn clean install -Pstaging**创建了一个用于登台环境的构建，它在目标文件夹中为登台环境创建了一个 WAR 文件。现在，每当我启动 tomcat 时，它都会使用目标中的设置连接到登台数据库服务器并且无法连接（卡在*准备启动委托*）。

**修复：**首先在工作区目录中运行**mvn clean install**，然后在 Eclipse 中右键单击项目 -> Maven -> 更新项目。现在运行tomcat。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-12-13T06:09:40.977

对于那些试图启动重负载应用程序的人，将大量信息级别记录到控制台。请注意，Eclipse 控制台打印机可能会被打印的数据量混淆并长时间挂起 Eclipse，而服务器实际上将启动并可以通过浏览器访问。

这个问题发生在我身上，我花了很长时间才弄清楚发生了什么。我正在运行 Eclipse Mars 和 Tomcat 7。在我的案例中，应用程序试图将所有单例 bean 名称打印到控制台，大约有几千个 bean 名称，因此 Eclipse 快疯了。

```
org.springframework.beans.factory.support.DefaultListableBeanFactory#preInstantiateSingletons

    if (this.logger.isInfoEnabled()) {
       this.logger.info("Pre-instantiating singletons in " + this);
    } 
```

试一试，将应用程序日志记录级别设置为错误。希望这会对某人有所帮助。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-07-12T12:52:15.240

转到控制面板/程序/程序和功能/已安装的更新，然后卸载上次的Microsoft windows更新，重新启动计算机，它就可以工作了。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2016-05-26T16:39:13.297

当您将服务器设置中的主机名设置为无效值时，也会发生这种情况。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2016-09-22T15:35:29.287

编辑：

> 确保您的主机名是“localhost”，或者如果您使用的是特定 IP 地址，请确保它是您计算机的正确 IP 地址。

我将主机名从“localhost”更改为我的特定 IP 地址（当时）。这是为了解决我在做移动应用程序开发时遇到的一个问题。

我的问题是我的IP地址改变了。所以将我的主机名更新为我的新 IP 地址。（完成移动测试后，我会将其恢复为 localhost）。

只是一个提示，有时它是一个简单的修复。

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2013-04-08T17:51:31.337

我的问题原来我已经在 8443 上编辑了 ssl 的 tomcat install server.xml 文件，而不再在 8080 上...eclipse 将其拉入并会在启动时挂起...复制原始 server.xml 并再次创建服务器等等好...我有很好的目标射击自己的脚...

* * *

## 回答 #28

> 赞同：-2
> 
> 时间：2014-03-18T11:05:11.737

问题肯定出在您的 JDK 版本上。如果您运行的是 Windows 7，我会考虑更改您的 JDK 版本和您的 tomcat 版本。**

# android - ActionBarSherlock 背景的图像大小

> ID：11371395
> 
> 赞同：1
> 
> 时间：2012-07-07T00:49:50.907
> 
> 标签：android, image, png, android-actionbar, actionbarsherlock

如果我要获得旨在用作 ActionBar 的背景的艺术资源，我应该要求什么尺寸（以像素为单位）？我发现引用 ActionBar 大小的所有内容都在 dp 中，所以我不确定实际 .png 文件的最佳绝对大小是多少。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T01:04:31.040

操作栏的高度可以是 40、48 或 56 dp，具体取决于配置。这意味着由于 Android 如何按密度缩放事物，因此存在 9 种不同的绝对像素高度。当然，宽度因设备而异。

您最好的选择是使用[9-patch 可绘制](http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch)对象或使用[形状 XML](http://developer.android.com/guide/topics/resources/drawable-resource.html#Shape)创建可绘制对象，以便它可以适应几乎无限数量的设备配置。

# php - PHP - 在页面加载时执行 PHP 脚本？

> ID：11371396
> 
> 赞同：-6
> 
> 时间：2012-07-07T00:50:03.643
> 
> 标签：php, sql, count, counter

我想要一个 PHP 脚本，它计算一个项目被购买了多少次，每次执行 PHP 脚本（购买的）时将计数器增加一，并将其​​显示在页面数据库中。

比方说，当用户通过 Paypal 被重定向回站点时，他们加载页面thankyou.php，在加载时，将表中的数据库值（计数器）增加一。

我找不到任何例子，所以我希望你们这里的好心人可以帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T00:54:00.363

php 是在页面加载之前在服务器端执行的服务器端语言。在您的情况下，您必须进行 ajax 调用才能触发 php 代码。

```
Update: mysql_query("UPDATE table_name SET id = id + 1 WHERE id = '$id'"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T01:00:35.227

您不需要在 PHP 中增加值，您可以在查询中直接在查询中执行它：

```
UPDATE hits_log SET hits = hits+1 WHERE page = *somthing* 
```

这可以使用 php 的[MySQLi](http://www.php.net/manual/en/book.mysqli.php)库或类似库来执行。

# php - 长时间输入文本的 MySQL 语法错误

> ID：11371397
> 
> 赞同：0
> 
> 时间：2012-07-07T00:50:35.977
> 
> 标签：php, mysql, syntax-error

我正在尝试使用 MySQL 构建 PHP 表单。问题是，如果我尝试在字段中添加一些长文本，每次都会出错。

错误

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行附近使用正确的语法

生成查询的 PHP 代码是这样的：

```
<?php

if ( $_GET['aktion'] == "speichern" )
{
    $title          = $_GET['title'];
    $description    = $_GET['description'];
    $applepart      = $_GET['applepart'];
    $partnumber     = $_GET['partnumber'];
    $productcode    = $_GET['productcode'];
    $compatibility  = $_GET['compatibility'];
    $url_bild       = $_GET['url_bild'];
    $price          = $_GET['price'];

    $sql  = "INSERT INTO adressbuch ";
    $sql .= " SET ";
    $sql .= " title         = '$title', ";
    $sql .= " description   = '$description', ";
    $sql .= " applepart     = '$applepart', ";
    $sql .= " partnumber    = '$partnumber', ";
    $sql .= " productcode   = '$productcode', ";
    $sql .= " compatibility = '$compatibility', ";
    $sql .= " url_bild      = '$url_bild', ";
    $sql .= " price         = '$price' ";

    require_once ('konfiguration.php');
    $db_erg = mysql_query($sql)
        or die("Anfrage fehlgeschlagen: " . mysql_error());

    echo '<h1>Adresse wurde speichert</h1>';
    echo '<a href="auflistung.php">Auflistung anzeigen</a>';
    exit;
}
?>

<form name="" action="" method="GET" enctype="text/html">
<p>Title:<br />
<input type="text" name="title" value="" size="60" />
</p>
<p>description:<br />
<input type="text" name="description" value="" size="60" />
</p>
<p>applepart:<br />
<input type="text" name="applepart" value="" size="60" />
</p>
<p>partnumber:<br />
<input type="text" name="partnumber" value="" size="60" />
</p>
<p>productcode:<br />
<input type="text" name="productcode" value="" size="60" />
</p>
<p>compatibility:<br />
<input type="text" name="compatibility" value="" size="60" />
</p>
<p>Bild:<br />
<input type="text" name="url_bild" value="" size="60" />
</p>
<p>price:<br />
<input type="text" name="price" value="" size="60" />
</p>

<input type="hidden" name="aktion" value="speichern" />

<input type="Submit" name="" value="speichern" />
</form> 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T00:56:57.180

您的代码容易受到 SQL 注入的影响，您的问题只是原因的提示。

我们一直使用的规则是：“永远不要相信来自用户代理的数据”（即认为 $_GET 或 $_POST 中的任何内容都可能存在问题或更糟）。至少，我们应该始终使用[mysqli_real_escape_string](http://www.php.net/manual/en/mysqli.real-escape-string.php)或更强大的数据库框架来转义这些值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:55:46.867

您的问题是，当您有足够长的输入时，它在某处有一个单引号或换行符。您不能像这样简单地连接用户输入并期望它起作用。更糟糕的是，您对 SQL 注入攻击持开放态度。找到使用框架构建 SQL 查询的正确方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T13:15:08.163

```
<?php
      require_once ('konfiguration.php');

      if(isset($_POST['title']))
      {
        $title = mysql_real_escape_string(htmlspecialchars($_POST['title']));
        $description = mysql_real_escape_string(htmlspecialchars($_POST['description']));
        $applepart = mysql_real_escape_string(htmlspecialchars($_POST['applepart']));
        $partnumber = mysql_real_escape_string(htmlspecialchars($_POST['partnumber']));
        $productcode = mysql_real_escape_string(htmlspecialchars($_POST['productcode']));
        $compatibility = mysql_real_escape_string(htmlspecialchars($_POST['compatibility']));
        $url_bild = mysql_real_escape_string(htmlspecialchars($_POST['url_bild']));
        $price = mysql_real_escape_string(htmlspecialchars($_POST['price']));
        $insert = mysql_query("INSERT INTO `adressbuch` (`title`,`description`,`applepart`,`partnumber`,`productcode`,`compatibility`,`url_bild`,`price`) VALUES ('$title','$description','$applepart','$partnumber','$productcode','$compatibility','$url_bild','$price')");
        if (!$insert)
        {
          die('Eintrag konnte nicht gespeichert werden: ' . mysql_error());
        }
      }

    ?>

    <form method="POST" action="?page= ">
      <span>Neuer G&auml;stebucheintrag verfassen:</span> <br />
      <span>Title</span><input type="text" name="title" /> <br />
      <span>Description</span><textarea cols="16" rows="5"  name="description"></textarea> <br />
      <span>Apple Part</span><input type="text" name="applepart" /> <br />
      <span>Part Number</span><input type="text" name="partnumber" /> <br />
      <span>Product Code</span><input type="text" name="productcode" /> <br />
      <span>Compatibility</span><input type="text" name="compatibility" /> <br />
      <span>Image</span><input type="text" name="url_bild" /> <br />
      <span>Price</span><input type="text" name="price" /> <br />
      <input type="submit" value="Speichern"/> <br />
    </form> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T03:31:49.183

不管 SQL 注入漏洞如何，您发送的查询似乎对 MySQL 来说太长而无法处理。

您可以尝试通过更改一些配置来克服这个问题：尝试在 MySQL 的配置文件中提高参数“max_allowed_pa​​cket”。例如：

```
[mysqld]
max_allowed_packet = 64M 
```

这会将其设置为 64MB，这意味着您将被允许发出的最长单个查询是 64MB，并且您能够从查询中检索到的最长单行大小是 64MB。

# objective-c - 每次循环时，如何将常数值与不断更新的加速度计值进行比较？

> ID：11371399
> 
> 赞同：0
> 
> 时间：2012-07-07T00:50:57.507
> 
> 标签：objective-c, ios, accelerometer

正如我在上[一篇文章](https://stackoverflow.com/questions/11369189/cmaccelerometerdata-class-vs-deprecated-uiaccelerometer-class)中向我建议的那样，以下代码将来自加速度计的数据作为分配的“分钟”：**CMAccelerometerData* data = [manager accelerometerData];** 执行，*然后*从该数据中提取在 x 轴上执行的加速度并将其值*存储*在 double (double x) 中：

```
 CMMotionManager* manager = [[CMMotionManager alloc] init];

 CMAccelerometerData* data = [manager accelerometerData];

 double x = [data acceleration].x; 
```

假设存储的值为 0.03 并假设我想在 while 循环中使用它，如下所示：

```
while (x > 0)
{
    // do something
} 
```

上面的循环显然会永远运行

*但是*，如果我改用以下代码会怎样：

```
CMMotionManager* manager = [[CMMotionManager alloc] init];

while([[manager accelerometerData] acceleration].x > 0) 
{
    // do something
} 
```

我现在不会在每次循环时都将零与不同的值进行比较吗？（无论如何，这就是我在我的项目中要做的事情..）

有什么想法吗？

我问这个的原因如下：

我想在一段时间内检查来自 x 轴的值，而不是定期检查它们，所以我基本上想编写一个看起来像这样的循环：

```
if ([[manager accelerometerData] acceleration].x > 0 ) 
{
    // initialiseTimer
}

while ([[manager accelerometerData] acceleration].x > 0 ) 
{
    if( checkTimer >=250ms )
    {
        stopTimer;

        printOut("X-Axis acceleration  was greater than zero for at least 250ms");

        breakFromLoop;
     }
} 
```

我知道我的第二个 if 块中的代码不是有效的 Objective-C ..这只是为了让您了解我的目标..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T01:12:17.557

这有一个简单的解决方案。

1）声明一个实例变量 x ，每次加速度计告诉你时你都会更新它。

2）将此 x 与循环中所需的任何值进行比较。

希望这可以帮助。

问候，

乔治

# .htaccess - mod_reweite htaccess 不适用于 var 中的点

> ID：11371411
> 
> 赞同：0
> 
> 时间：2012-07-07T00:53:35.810
> 
> 标签：.htaccess, mod-rewrite

我创建一个这样的 mod_rewrite 规则

```
RewriteCond %{SCRIPT_FILENAME} !-d 
RewriteCond %{SCRIPT_FILENAME}\.php !-f 
RewriteRule ^(.*)$ ./page.php?key=$1 
```

有用！但我想这样做：

```
www.site.com/var1.var2.var3 
```

（变量用点隔开）用-或_隔开没问题，但如果我把点隔开，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:58:13.780

我假设您正在尝试这样的规则

```
RewriteRule ^(.*).(.*).(.*)$ ./page.php?key=$1&key2=$2&key3=$3 
```

但是您应该记住要转义要解释为句点的点。有很多方法可以解决这个问题，但如果您是`.htaccess`文件新手，这里有一个简单的方法：

```
RewriteEngine  On
RewriteBase    /

# Skip existing files or directories
RewriteCond %{SCRIPT_FILENAME}     -d [OR] 
RewriteCond %{SCRIPT_FILENAME}     -f
RewriteRule ^                      -  [L]

# Add default PHP extension when appropriate
RewriteCond %{SCRIPT_FILENAME}.php -f
RewriteRule ^.*                    $0.php  [L]

# Pick up 1,2 and 3 parameter versions 
RewriteRule ^(.*?)\.^(.*?)\.(.*)$ page.php?key=$1&key2=$2&key3=$3 [QSA,L]
RewriteRule ^(.*?)\.(.*?)$        page.php?key=$11&key2=$2        [QSA,L]
RewriteRule ^(.*?)\.$             page.php?key=$1                 [QSA,L] 
```

笔记：

*   第一条规则使用“^”作为始终匹配的模式，“-”表示不替换它。
*   第二个使用 $0 表示整个匹配模式
*   规则 3-5 匹配 3,2,1 参数选项
*   [L]（最后一个）标志表示跳过其余规则
*   如果您使用其他参数，您将需要 QSA 标志。

将存在检查拆分为的原因是您需要处理诸如 CSS 和图像 (PNG/GIF/PNG) 文件之类的文件以及您的应用程序语法。

# java - Axis2 客户端的国际化

> ID：11371412
> 
> 赞同：0
> 
> 时间：2012-07-07T00:53:44.367
> 
> 标签：java, web-services, soap, axis2, webservice-client

我的网络服务中有以下代码

```
package com.manumehrotra.hs.samples.internationalization;

import java.util.MissingResourceException;

import javax.servlet.http.HttpServletRequest;

import org.apache.axis2.context.MessageContext;
import org.apache.axis2.i18n.Messages;
import org.apache.axis2.transport.http.HTTPConstants;

public class SampleInternationalizationHS {
    public String getInternationalizedMessage(){
        System.out.println("in getInternationalizedMessage");
        String retVal = null;
        String language = null;

        // Get the current MessageContext  
        MessageContext msgContext = MessageContext.getCurrentMessageContext();
        // Get HttpServletRequest from Message Context  
        Object requestProperty = msgContext.getProperty(HTTPConstants.MC_HTTP_SERVLETREQUEST);
        if (requestProperty != null  && requestProperty instanceof HttpServletRequest) {      
            HttpServletRequest request = (HttpServletRequest) requestProperty;  
            language = request.getLocale().getLanguage();  
            // language codes are available at - http://www.loc.gov/standards/iso639-2/php/code_list.php
        }

        System.out.println(language);

        String msg_key = "samplemsg_en";
        try {
            msg_key = "samplemsg_"+language;
        } catch (Exception e) {
            msg_key = "samplemsg_en";
        }

        System.out.println(msg_key);

        try {
            retVal = Messages.getMessage(msg_key, "Jack");
        } catch (MissingResourceException mre) {
            // do nothing...
            System.out.println("resource not found");
        }
        System.out.println("returning "+retVal);
        return retVal;
    }
} 
```

我想知道如何在我的 java 客户端中设置不同的语言环境值，以便上面提到的 web 服务代码能够识别它。

目前只有“en”被识别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T19:54:00.080

以下代码可用于在客户端的 SOAP 标头中设置区域设置

```
ServiceClient client = stub._getServiceClient();
OMFactory omFactory = OMAbstractFactory.getOMFactory();
OMElement omElement = omFactory.createOMElement(new QName("http://www.w3.org/2005/09/ws-i18n","locale", "i18n"));
omElement.setText("en");
client.addHeader(omElement); 
```

并且为了在服务器端检索语言环境，使用以下代码

```
SOAPHeader header = MessageContext.getCurrentMessageContext().getEnvelope().getHeader();
OMElement firstChildWithName = header.getFirstChildWithName(new QName("http://www.w3.org/2005/09/ws-i18n","locale","i18n"));
if (firstChildWithName != null) {
    String locale = firstChildWithName.getText();
    System.out.println(locale);
    if(locale!=null)
        language = locale.trim();
    else
        language="en";
} 
```

我已经对示例 web 服务和 web 服务客户端进行了同样的尝试，并且它可以工作。

# python - 查找 plist 是否包含具有特定字符串的键

> ID：11371415
> 
> 赞同：1
> 
> 时间：2012-07-07T00:54:28.783
> 
> 标签：python, plist

下面我有一个 xml/plist 文件（您可能会将其识别为 .tmTheme）：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>settings</key>
<array>
    <dict>
        <key>name</key>
        <string>Comment</string>
        <key>scope</key>
        <string>comment</string>
        <key>settings</key>
        <dict>
            <key>foreground</key>
            <string>#75715E</string>
        </dict>
    </dict>
    <dict>
        <key>name</key>
        <string>String</string>
        <key>scope</key>
        <string>string</string>
        <key>settings</key>
        <dict>
            <key>foreground</key>
            <string>#E6DB74</string>
        </dict>
    </dict>
</array>
</dict>
</plist> 
```

我正在尝试查找每个字典是否包含一个字符串`scope`，以及是否`scope`有一个特定的字符串，比如`comment`. 然后我需要去内部字典并检索 key `foreground`。在这种情况下，我需要检索`#75715E`.

我已经开始使用`a = plistlib.readPlist()`then `b = a["settings"]`。然后我不知道我应该如何处理它，记住我需要稍后找到根字典，以便我可以在其中获取*另一个*字典。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:58:40.813

```
my_plist = plistlib.readPlist()
settings = my_plist["settings"]
for d in settings:
    if "scope" in d:
        if "comment" not in d["scope"]:
            print "A scope with no comment!"
    else:
        print "A dict with no scope!" 
```

# php - 通过每个子数组中的元素对嵌套数组进行排序

> ID：11371421
> 
> 赞同：0
> 
> 时间：2012-07-07T00:56:51.887
> 
> 标签：php, sorting, multidimensional-array

假设我有一些从 JSON 请求返回的东西，基本上看起来像这样——

```
$data = array('0'=> array('name' => 'Dr. Smith',
                          'address' => '3002 Fake Ave.',
                          'lat' => '34.711158',
                          'lng' => '-137.803578',
                          'phone' => '714.939.1324'),
              '1' => array('name' => 'Dr. Paul',
                           'address' => '801 Fake St.',
                           'lat' => '31.749917',
                           'lng' => '-137.834388')); 
```

如何按元素之一对其进行排序？假设我想按元素对整个数组进行排序`Lat`？并将它放回`$data`元素中，这样我就可以继续使用它。

我已经阅读了关于 PHP[`usort`](http://php.net/manual/en/function.usort.php)并按子数组元素排序的内容，但是当我尝试使用他们的代码示例时，它们不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T01:03:25.300

usort 的回调函数将接收您的两个数组条目（它们本身就是数组）并且必须回答 $a 是在 $b 之前还是之后。

例如该函数将接收

```
 $a = array('Lat' => 45, 'Name' => 'Mickey Mouse', ...)
  $b = array('Lat' => 47, ...) 
```

所以如果你想按 Lat 元素排序，你会使用，

```
 function sort_by_lat($a, $b)
  {
      return $a['Lat'] - $b['Lat']; // or b - a to sort the other way
  }

  usort($array, "sort_by_lat"); 
```

您可能遇到的一个问题是，如果按经度排序，您可能会认为 -1 小于 +1，而 -179 小于 +180。这可能是也可能不是您所期望的。在这种情况下，您需要使用 if()，和/或引入一些转换。

要按名称排序，您可以执行

```
 if ($a['field'] > $b['field']) return 1;
 if ($a['field'] == $b['field']) return 0;
 return -1; 
```

（再次反转 +1 和 -1 以另一种方式排序）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T01:10:47.247

不要忘记您的所有数据都是以字符串形式输入的，因此您需要将数值转换为浮点数以进行适当的比较。

[http://codepad.org/p2EMfTDR](http://codepad.org/p2EMfTDR)

```
$data = array('0'=> array('name' => 'Dr. Smith', 'address' => '3002 Fake Ave.', 'lat' => '20.711158', 'lng' => '10.803578', 'phone' => '714.939.1324'), '1' => array('name' => 'Dr. Paul', 'address' => '801 Fake St.', 'lat' => '10.749917', 'lng' => '20.834388'));

function cmpLat($a, $b)
{
    if(floatval($a['lat']) > floatval($b['lat'])) {
        return 1;
    } elseif(floatval($a['lat']) < floatval($b['lat'])) {
        return -1;
    } else {
        return 0;
    }
}

function cmpLng($a, $b)
{
    if(floatval($a['lng']) > floatval($b['lng'])) {
        return 1;
    } elseif(floatval($a['lng']) < floatval($b['lng'])) {
        return -1;
    } else {
        return 0;
    }
}

usort($data, "cmpLat");

print_r($data);

usort($data, "cmpLng");

print_r($data); 
```

# asp.net-mvc-3 - 停用行而不是删除

> ID：11371423
> 
> 赞同：-2
> 
> 时间：2012-07-07T00:57:04.853
> 
> 标签：asp.net-mvc-3, linq-to-entities

我想停用行而不是删除它们。

我当前的代码删除了该字符。相反，我想将列 IsActive 设置为 0（假）

```
 [HttpPost, ActionName("Delete")]
        public ActionResult DeleteConfirmed(int id)
        {            
            Character character = db.Characters.Find(id);
            db.Characters.Remove(character);
            db.SaveChanges();
            return RedirectToAction("Index");
        } 
```

表定义：

```
CharacterID int 
isActive    bit 
UserId  uniqueidentifier 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T01:14:12.220

```
 public ActionResult DeleteConfirmed(int id)
    {            
        Character character = db.Characters.Find(id);
        character.isActive = false;
        db.SaveChanges();
        return RedirectToAction("Index");
    } 
```

如果您使用生成的 .edmx，则 isActive 应设置为布尔值。

# android - 在Android中单击按钮时播放声音

> ID：11371426
> 
> 赞同：5
> 
> 时间：2012-07-07T00:57:18.257
> 
> 标签：android, eclipse, eclipse-adt

我是 Android 新手，我正在尝试做一些简单的事情，比如在单击按钮时播放自定义 MP3。这似乎是一个[相当](https://stackoverflow.com/questions/2618182/how-to-play-ringtone-alarm-sound-in-android) [普遍的](https://stackoverflow.com/questions/3663847/how-to-add-a-file-to-an-android-project-deploy-it-to-the-device-and-then-open) [问题](https://stackoverflow.com/questions/4861859/implement-sound-in-android-application)，但即使我的代码遵循示例，并且我没有收到任何错误，我在模拟器或真实手机中都听不到任何声音。

我的 MainActivity.java：

```
public class MainActivity extends Activity {

    private static final String TAG = "MyActivity";

    public void MyActivity(Bundle onSavedStateInstance) {
        Log.v(TAG, "Initializing sounds...");

        final MediaPlayer mp = MediaPlayer.create(this, R.raw.alarma_67560);

        Button play_button = (Button)this.findViewById(R.id.play_button);
        play_button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Log.v(TAG, "Playing sound...");
                mp.start();
            }
        });
        Log.v(TAG, "Sounds initialized.");
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

还有我的activity_main.xml：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:padding="@dimen/padding_medium"
        android:text="@string/hello_world"
        tools:context=".MainActivity" />

    <Button
        android:id="@+id/play_button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/play_button" />

</RelativeLayout> 
```

我正在使用 Eclipse 插件进行开发，该插件没有显示任何错误，并且似乎可以在模拟器或真机中正确运行应用程序，但是当我单击播放按钮时，没有任何反应。我不确定模拟器是否支持声音（但我假设它支持）并且我已确认我的手机上的声音已取消静音。

我究竟做错了什么？

此外，无论是在 Eclipse 的控制台还是在 LogCat 面板中，我都没有看到我的日志记录语句。我应该在某处看到那些打印的吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-07T01:08:27.730

这不起作用的原因很简单：从未调用 MyActivity()。

Android 将调用您的 Activity 的 onCreate()，但任何其他方法调用都必须由您完成。由于您从不调用 MyActivity() 方法，因此永远不会为按钮提供 onClickListener()，并且永远不会播放声音。尝试改用以下代码：

```
public class MainActivity extends Activity {

    private static final String TAG = "MyActivity";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Log.v(TAG, "Initializing sounds...");

        final MediaPlayer mp = MediaPlayer.create(this, R.raw.alarma_67560);

        Button play_button = (Button)this.findViewById(R.id.play_button);
        play_button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Log.v(TAG, "Playing sound...");
                mp.start();
            }
        });
        Log.v(TAG, "Sounds initialized.");
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T01:10:50.650

你应该把你的代码放在 onCreate 和 setContentView() 之后，因为你的方法/构造函数 public void MyActivity(Bundle onSavedStateInstance) 永远不会被调用，因此你的代码永远不会被执行。像这样的东西：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Log.v(TAG, "Initializing sounds...");
    final MediaPlayer mp = MediaPlayer.create(this, R.raw.alarma_67560);
    Button play_button = (Button)this.findViewById(R.id.play_button);
    play_button.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            Log.v(TAG, "Playing sound...");
            mp.start();
        }
    });
    Log.v(TAG, "Sounds initialized.");
} 
```

# ruby-on-rails-3 - Rails 3 - 使用 has_many 和 has_many 拥有和“跟踪”相同的对象类型：可跟踪（多态）

> ID：11371427
> 
> 赞同：0
> 
> 时间：2012-07-07T00:57:37.850
> 
> 标签：ruby-on-rails-3, activerecord, polymorphism

在我的项目中，我需要`User`能够“创建/拥有”自己的对象和“跟踪”（或“跟随”）其他用户创建的对象。这是我的方法：

```
class User < ActiveRecord::Base
  has_many :widgets
  has_many :gadgets
  has_many :nuggets

  has_many :tracks

  has_many :tracked_widgets, :as => :trackable, :trackable_type => "Widget"
  has_many :tracked_gadgets, :as => :trackable, :trackable_type => "Gadget"
  has_many :tracked_nuggets, :as => :trackable, :trackable_type => "Nugget"
end

class Track < ActiveRecord::Base
  belongs_to :trackable, polymorphic: true
  belongs_to :user
end

class Widget < ActiveRecord::Base  # Gadget and Nugget classes are the same
  has_many :tracks, :as => :trackable
end 
```

表的架构`tracks`：

```
 create_table "tracks", :force => true do |t|
    t.integer  "user_id"
    t.integer  "trackable_id"
    t.string   "trackable_type"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  add_index "tracks", ["trackable_id", "user_id"], :name => "index_tracks_on_trackable_id_and_user_id" 
```

使用此实现，我收到以下错误：

```
Unknown key: trackable_type (ArgumentError) 
```

查看架构，很明显我没有`:trackable_type`设置为索引，因此错误消息是有道理的。但是，在我看到的演示多态关系的示例中，我从未见过将`______able_type`字段设置为索引。这让我想知道我是否在这里遗漏了一些基本的东西。我有这些问题：

1.  我是否以某种方式错误地设置了`has_many`和`:as => :trackable`关系？
2.  如果没有，使用`string`字段作为有什么问题`index`吗？
3.  如果答案只是将`:trackable_type`字段添加为索引，那么事后最好的方法是什么？添加一个新的迁移来创建`:trackable_type` `index`?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T19:33:34.437

我终于想出了如何使多态关联适用于这种情况。不知道我明白为什么，但在某些多态情况下不使用`:as`选项。`has_many`相反，您必须使用标准`:through`选项，然后使用`:source`and`:source_type`选项重新建立多态性。

在我上面的示例`has_many`中，模型中的语句`User`需要格式化如下：

```
has_many :tracked_widgets, :through => :tracks, :source => :trackable, :source_type => "Widget"
has_many :tracked_gadgets, :through => :tracks, :source => :trackable, :source_type => "Gadget"
has_many :tracked_nuggets, :through => :tracks, :source => :trackable, :source_type => "Nugget" 
```

希望这可以帮助任何试图解决类似情况的人。

# security - DNS 答案的安全性

> ID：11371433
> 
> 赞同：2
> 
> 时间：2012-07-07T00:58:27.020
> 
> 标签：security, networking, ssl, udp, dns

我一直在搜索有关此主题的信息，但没有找到直接答案。是否有可能发生以下情况：

PC 1： - 在端口 X 中打开 UDP 套接字 - 向 DNS 服务器发送请求以解析名称

同时

黑客在互联网上捕获了数据包，他自己以错误的答案回答了请求

这会发生吗？如果不是，是什么阻止了这种情况？DNS 使用 SSL 还是其他安全机制？我们的操作系统是否使用与 DNS 服务器的安全通信？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T01:02:08.487

你提出的场景是完全可能的。这是发明[DNSSEC](http://en.wikipedia.org/wiki/Domain_Name_System_Security_Extensions)的原因之一。

DNSSEC 允许解析器客户端检查从任何 DNS 记录一直到树的信任锚（通常是 DNS 根）的加密签名链。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-05T20:28:29.320

You could also use an HTTP web service that utilizes SSL to make sure that the answer hasn't been tampered with: `curl https://api.openresolve.com/a/stackoverflow.com`. Docs at [https://www.openresolve.com](https://www.openresolve.com)

# c# - 慢性不适当的 System.OutOfMemoryException 事件

> ID：11371437
> 
> 赞同：1
> 
> 时间：2012-07-07T00:58:58.397
> 
> 标签：c#, out-of-memory

这是一个应该是连续运行的无人值守控制台应用程序的问题：我看到过于频繁的应用程序退出`System.OutOfMemoryException`是从调用堆栈深处的各种方法中抛出的——经常`System.String.ToCharArray()`，或`System.String.CtorCharArrayStartLength()`，或`System.Xml.XmlTextReaderImpl.InitTextReaderInput()`，但有时向下在调用堆栈中的`System.String.Concat()`调用中`MongoCollection.Save()`，以及其他不太可能的地方。

值得一提的是，我们正在使用并行任务，但这基本上是服务器上运行的唯一应用程序，并且应用程序的*总*线程数永远不会超过 60。在其中一些情况下，我知道*其他*一些异常的原因被抛出，但 OutOfMemoryException 在这些上下文中没有意义，并且会产生问题：

*   根据 TaskManager 和 Perfmon 日志，发生这种情况时，系统*至少*有 8GB 可用内存中的 65%，并且
*   虽然异常处理程序有时会触发并记录异常，但它们并不能防止应用程序崩溃，并且
*   如果没有用户交互，则不会继续此异常（除非您禁止 Windows 错误报告，这不是我们想要的系统范围内的，或者将应用程序作为服务运行，这对于我们的用例来说是可能的但次优）

所以我知道上面提到的解决方法，但我真正想要的是一些解释——最好是基于代码的处理程序——用于意外的 OOM 异常，以便我们可以使用适当的延续逻辑。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T01:04:14.560

使用低于 3GB 的内存时出现该异常表明您正在运行 32 位应用程序。将其构建为 64 位应用程序，它将能够使用尽可能多的内存（接近 8GB）。

至于为什么它首先失败了……您使用的数据有多大？如果它不是很大，您是否寻找对数据的引用比它们需要的时间长得多（即内存泄漏），从而阻止了正确的 GC？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T01:07:13.503

您需要分析应用程序，但这些异常的最常见原因是过多的字符串创建。此外，过度的序列化可能会导致这种和过度的 Xslt 转换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T09:36:26.703

您是否有很多大于或等于 85000 字节的对象？每个这样的对象都将进入[未压缩](http://msdn.microsoft.com/en-us/magazine/cc534993.aspx)的大对象堆。即与Small Object Heap 不同，GC**不会**移动对象来填充内存空洞，这会导致碎片，这对于长期存在的应用程序来说是一个潜在的问题。

从 .NET 4 开始，情况仍然如此，但似乎他们[在 .NET 4.5 中做了一些改进](http://blogs.msdn.com/b/dotnet/archive/2011/10/04/large-object-heap-improvements-in-net-4-5.aspx)。

一个快速而简单的解决方法是确保应用程序可以通过将其构建为“x64”或“任何 CPU”来使用所有可用内存，但真正的解决方案是最大限度地减少大型对象的重复分配/释放周期（即如果可能，使用对象池或完全避免大对象）。

您可能还想看看[这个](https://stackoverflow.com/questions/686950/large-object-heap-fragmentation)。

# javascript - 一次迭代一个网格行

> ID：11371439
> 
> 赞同：0
> 
> 时间：2012-07-07T01:00:18.767
> 
> 标签：javascript, grid, loops

我需要遍历一个网格，并将更改应用于每一行的子级。例如，如果我有一个 3 行的网格，我怎样才能使它每行的孩子可以是不同的颜色？这是一些用于创建网格的基本 HTML + CSS 的 JSFiddle。我想做这样每一行都是不同的颜色。

[http://jsfiddle.net/onestepcreative/24Ljw/6/](http://jsfiddle.net/onestepcreative/24Ljw/6/)

想法？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T01:13:42.207

这是一个带有简单 javascript 的版本。您也可以使用 nth-child 选择器仅使用 CSS 执行此操作

[http://jsfiddle.net/24Ljw/8/](http://jsfiddle.net/24Ljw/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T01:33:10.207

你听说过 createTreeWalker 吗？[https://developer.mozilla.org/en/DOM/document.createTreeWalker](https://developer.mozilla.org/en/DOM/document.createTreeWalker)

此方法允许您迭代 DOM 中的节点而无需递归。

不过，您正在寻找的可能是一个循环。这里是原生 js。

```
//Get the elements
var grids = document.querySelectorAll(".grid_row > div"); 

// Make up the colors
var colors = [
    "#fff", "#000", "#666", "#555", 
    "#f4f4f4", "#111", "#222", "#333", 
    "#f0f0f0", "#f2f2f2", "#f8f8f8", "#010101"
];

// Turn it into an array and not a nodeList
grids = Array.prototype.slice.apply(grids);

// Loop over the array
grids.forEach(function(grid, i) {
    grid.style.backgroundColor = colors[i];                
}); 
```

​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T01:17:50.957

这是一个将类“灰色”附加到奇数行的小提琴

[http://jsfiddle.net/24Ljw/9/](http://jsfiddle.net/24Ljw/9/)

# ios - 防止在 UIWebView 中出现烦人的 HTML5 地理位置警报

> ID：11371441
> 
> 赞同：13
> 
> 时间：2012-07-07T01:00:48.440
> 
> 标签：ios, html, uiwebview, permissions, geolocation

每当脚本使用`HTML5`的地理定位 API 请求地理定位时，都会`UIWebView`请求使用 iOS 定位服务的权限。

这很烦人，特别是当您加载静态`HTML`文件时，它会不断询问每个文件的权限，即使用户已经为应用程序本身授予了此权限。

有没有办法防止它？

我知道在 safari 上，地理定位的权限是基于域的，我同意在为不同的域完成请求时请求权限，但 UIWebView 在加载静态 HTML 时不应该与应用程序具有相同的地理定位权限或本地文件？

难道我做错了什么？

![UIAlertView 请求域的权限](../Images/7f7a9cc5f2284e61bef091cc871f30ac.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T12:34:31.967

您始终可以将地理定位从您的应用程序传递到加载到 WebUIView 中的 javascript。在 WebUIView 中寻找“stringByEvaluatingJavaScriptFromString”？

# ruby - Google 共享联系人 API

> ID：11371442
> 
> 赞同：2
> 
> 时间：2012-07-07T01:01:05.990
> 
> 标签：ruby, google-api, google-shared-contacts

我正在寻找 Googoe Shared conatact API ruby​​ gem。Google Shared Contacts API 有什么好的 ruby​​ gem 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T09:32:40.713

[这](https://github.com/mislav/contacts)是我找到的唯一一个，但它已经有一段时间没有维护了。它可能需要一些工作。

如果您有兴趣，这篇[博客文章](http://natashatherobot.com/2012/02/03/google-contacts-api-ruby-example/)讨论了如何自己做（而且是最近的）。

# c# - 进程间 C# python 实时

> ID：11371448
> 
> 赞同：6
> 
> 时间：2012-07-07T01:02:21.247
> 
> 标签：c#, python, real-time, communication

我正在做一个项目，我将有一个 C# 应用程序和另一个 Python 应用程序。C# 应用程序将持续分析数据流并在每次检测到有趣的东西时引发一个标志。因此，每次发生事件时，我的 Python 应用程序都必须读取它并继续它自己的进程，而其他标志将继续发送。正如您所了解的，C# 应用程序不会等待 Python 应用程序在发送另一个标志之前完成其计算。

所以我想知道是否可以创建一个 sub/pub（C# 是发布者，Python 是订阅者），如果可以，我该怎么做，你认为这是个好主意吗？我在这个领域很新，所以你能告诉我是否还有其他可能性吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T01:13:19.273

[Redis pub/sub](http://redis.io/topics/pubsub/)很棒……或者[ZeroMQ](http://www.zeromq.org/intro%3aread-the-manual)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T09:27:40.093

最简单的方法是`PIPE`沟通。另一种不建议的简单方法是`SOCKET`编程。*管道*和*命名管道*是在不同进程之间（通过不同的编程语言）进行通信的良好解决方案。`SOCKET`编程是这样的，但可能需要更多的访问级别并且可能安全性较低。

其他类型的[IPC](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365574%28v=vs.85%29.aspx)似乎无法使用。

查看更多信息：

*   [C# - 管道](https://stackoverflow.com/questions/tagged/pipe+c#)

*   [python - 管道](https://stackoverflow.com/questions/tagged/pipe+python)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-14T11:08:43.580

您可以使用我们的[aktos-dcs](https://github.com/ceremcem/aktos-dcs)和[aktos-dcs-cs](https://github.com/ceremcem/aktos-dcs-cs)库。我已经成功地在生产中使用了这些库，以使 RFID 阅读器（来自 Impinj）与我们的遥测系统进行通信（实际上，集成在其中）。RFID 阅读器有一个 C# API，我们在遥测系统中大量使用 Python。

最简单的测试用例是一个 pinger-ponger 应用程序，下面是这些库的样子：

pinger.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using aktos_dcs_cs;

namespace pinger
{
    class Pinger : Actor
    {
        public void handle_PingMessage(Dictionary<string, object> msg)
        {
            Console.WriteLine("Pinger handled PingMessage: {0} ", msg["text"]);

            string msg_ser = @"
                    {""PongMessage"": 
                        {""text"": ""this is proper message from csharp implementation""}
                    }
                ";
            System.Threading.Thread.Sleep(2000);
            send(msg_ser);
        }

    }

    class Program
    {
        static void Main(string[] args)
        {
            Pinger x = new Pinger(); 
            Actor.wait_all(); 
        }
    }
} 
```

ponger.py：

```
from aktos_dcs import *

class Pinger(Actor):
    def handle_PingMessage(self, msg_raw):
        msg = get_msg_body(msg_raw)
        print "Pinger got ping message: ", msg['text'], (time.time() - msg_raw['timestamp'])
        sleep(2)
        self.send({'PongMessage': {'text': "Hello ponger, this is pinger 1!"}})

if __name__ == "__main__":
    ProxyActor()
    pinger = Pinger()
    pinger.send({'PongMessage': {'text': "Hello ponger, this is STARTUP MESSAGE!"}})

    wait_all() 
```

# c++ - C++ 中的基本 GUI 功能

> ID：11371450
> 
> 赞同：2
> 
> 时间：2012-07-07T01:02:57.440
> 
> 标签：c++, user-interface, cross-platform

### 有一些基本的方法可以在 C++ 中绘制一些东西吗？

我知道有很多引擎、库等。但是这些库必须使用一些最基本的绘图功能或其他任何东西。我的意思是通常没有任何非标准的 c++ 库，您只能制作控制台应用程序。但是可以绘制某些东西的新库，或者至少显示与标准命令行不同的东西，必须使用一些基本功能，允许在没有命令行的情况下做出不同的东西。

我听说过 WIN32 API（我不只是针对 Windows 平台，但我使用的是 Windows，还有 Ubuntu（Wubi））。我简直不敢相信唯一的方法是使用 WIN32 API。

所以我想我的问题如下：

*   是否所有使用 WIN32 API 的 GUI（或非控制台）库作为基本库？
*   linux 开发人员是否需要使用一些用于 GUI 的 linux API？

^(（对不起我的英语，这不是我的母语）)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T01:09:57.450

操作系统（在现代计算机上）负责屏幕，因此您必须使用它的功能在屏幕上绘图。

有各种各样的库，从非常高级的库（显示视频是一行代码）到低级的库，您可以确定每个像素的细节。

除了在屏幕上绘图之外，GUI 库或工具包还负责处理键盘和鼠标、处理窗口上方的其他窗口以及绘制所有标准控件，例如文件打开框等 - 这就是为什么它是有点复杂。

看到[最小的跨平台 gui 库吗？](https://stackoverflow.com/questions/1006364/minimal-cross-platform-gui-lib)从一些例子

# html - 如何阻止导航栏与我的博客的滑块和文章标题重叠？

> ID：11371454
> 
> 赞同：0
> 
> 时间：2012-07-07T01:03:40.307
> 
> 标签：html, blogs

博客链接：[http ://confabtest.blogspot.co.uk/](http://confabtest.blogspot.co.uk/)

我博客上的导航栏与其他元素重叠，例如特色文章滑块，当您打开文章时，标题顶部和侧面的社交共享小部件部分重叠。

[http://imm.io/voXw](http://imm.io/voXw)

有谁知道我该如何解决这个问题？

这是导航栏的代码：

```
.menu-secondary-container{position:relative;height:40px;z-index:300;background:#000;padding-left:5px}
.menu-secondary{}
.menu-secondary ul{min-width:160px}
.menu-secondary li a{color:#fff;padding:12px 15px 11px 15px;text-decoration:none;font:12px &#39;Oswald&#39;,sans-serif;text-transform:uppercase}
.menu-secondary li a:hover,.menu-secondary li a:active,.menu-secondary li a:focus,.menu-secondary li:hover &gt; a,.menu-secondary li.current-cat &gt; a,.menu-secondary li.current_page_item &gt; a,.menu-secondary li.current-menu-item &gt; a{color:#000;background:url(http://www.colorhexa.com/ff0033.png) repeat-x;outline:0}
.menu-secondary li li a{color:#fff;background:#51ABEE;padding:10px 15px;text-transform:none;margin:0;font-weight:normal}
.menu-secondary li li a:hover,.menu-secondary li li a:active,.menu-secondary li li a:focus,.menu-secondary li li:hover &gt; a,.menu-secondary li li.current-cat &gt; a,.menu-secondary li li.current_page_item &gt; a,.menu-secondary li li.current-menu-item &gt; a{color:#51ABEE;background:#000;outline:0}
.menu-secondary a.sf-with-ul{padding-right:26px;min-width:1px}
.menu-secondary .sf-sub-indicator{position:absolute;display:block;overflow:hidden;right:0;top:0;padding:13px 13px 0 0}
.menu-secondary li li .sf-sub-indicator{padding:9px 13px 0 0}
.wrap-menu-secondary .sf-shadow ul{background:url(&#39;http://1.bp.blogspot.com/-DuEC7hcoyA4/Tuh_aeS2pzI/AAAAAAAABUY/pKXmvzomJkw/s1600/menu-secondary-shadow.png&#39;) no-repeat bottom right} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T01:12:08.333

在您的 html 中查看 div header-wrapper 旁边的这个 div

```
<div class="span-24" style="height: 0pt;"> 
```

删除此 div 上的样式属性。这应该可以解决问题。

# jquery - 可以在coffeescript中循环遍历每个？

> ID：11371458
> 
> 赞同：15
> 
> 时间：2012-07-07T01:04:18.387
> 
> 标签：jquery, loops, coffeescript

我正在尝试以编程方式创建一些 javascript 按钮来切换页面上的可见性（用于快速标记过滤）。这适用于一个标签：

```
trigger = ".sales-focus-btn"
target = ".sales-focus"

jQuery ->   
  $(trigger).toggle ->
    $("#primary-content").find('.container').hide()
    $("#primary-content").find(target).show()
  , ->
    $("#primary-content").find('.container').show() 
```

是否可以在咖啡脚本中做类似的事情，但是使用数组，例如

```
trigger = [
  ".sales-focus-btn"
  ".service-focus-btn"
  ".other-focus-btn"
  ...
]
target = [
  ...
] 
```

是否可以循环并为每种类型的标签创建一个切换？

**更新**

是的，这是可能的。使用表格：

```
myFunction = (el) -> console.log el
myFunction elem for elem in array 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-07T01:21:40.257

当然有可能：

```
content = $('#primary-content')
container = content.find('.container')

tags = [
    '.sales-focus'
    '.service-focus'
    '.other-focus'
]

$.each tags, (tag) ->
    target = content.find(tag)
    $(tag + "-btn").toggle ->
        container.hide()
        target.show()
    , ->
        container.show() 
```

记得缓存你的 DOM 元素。或者使用`for tag in tags`代替`jQuery.each tags, (tag) -> ...`：

```
for tag in tags
    do ->
      target = content.find(tag)
      $(tag + "-btn").toggle ->
        container.hide()
        target.show()
      , ->
        container.show() 
```

（正如@epidemian 指出的那样， `do ->`IIFE 是必要的，以使每个都保持在范围内）`target`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T02:37:38.107

你可以`toggle`循环调用，但你必须注意奇怪的 JS 范围规则。基本上，如果您在循环中生成一个函数，如下所示：

```
for n in [1, 2, 3]
  $(".btn-#{n}").click -> alert "you clicked #{n}" 
```

您会注意到[所有按钮在按下时都会打印“you clicked 3”](http://jsfiddle.net/qNS2d/)。这是因为`n`变量的作用域不仅限于循环体，还包括包含该循环的所有函数。因此，当循环运行时，它的值`n`被改变，它的最终值是 3。由于循环内创建的所有函数都引用了同一个变量`n`，所以在循环完成后执行时它们都将打印 3。在 CoffeeScript 中，你可以使用 a 来规避这个问题[`do statement`](http://coffeescript.org/#loops)，它基本上会引入新的块作用域变量：

```
for n in [1, 2, 3]
  do (n) ->
    $(".btn-#{n}").click -> alert "you clicked #{n}" 
```

或使用辅助功能：

```
setupClick = (n) -> 
  $(".btn-#{n}").click -> alert "you clicked #{n}"

setupClick n for n in [1, 2, 3] 
```

考虑到这一点，您可以像这样实现循环（这是对[Ricardo 答案](https://stackoverflow.com/a/11371528/581845)的改编）：

```
$content = $('#primary-content')
$container = $content.find('.container')

targetsByTrigger =
  '.sales-focus-btn': '.sales-focus'
  '.service-focus-btn': '.service-focus'
  '.other-focus-btn': '.other-focus'

setupTrigger = (trigger, target) ->
  $(trigger).toggle ->
    $container.hide()
    $content.find(target).show()
    console.log 'showing', target
  , ->
    $container.show()

setupTrigger trigger, target for trigger, target of targetsByTrigger 
```

请注意，我将触发器和目标类名都放在一个对象中，因此触发器类名可以来自`<target class name>-btn`；如果不是这种情况，那么坚持一个数组`['.sales-focus', '.service-focus', '.other-docus']`，然后添加`-btn`可能会更好。此外，我喜欢使用`$`“jQuerized”值作为前缀的约定，但这只是个人喜好:)

# git - git：查找哪个合并提交到当前分支

> ID：11371460
> 
> 赞同：2
> 
> 时间：2012-07-07T01:04:46.347
> 
> 标签：git, git-merge

我有许多分支，它们定期合并，即我们可以有 A，它被合并到 B，然后 B 到 C，然后 A 到 D 和 D 到 C，等等。假设我有一个提交 X，我知道最初是在 A 中引入的，然后以某种方式合并到 C 中（我在执行 git log C 时可以看到）。有没有办法找出哪个合并（哪个合并提交）将提交 X 带入分支 C？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T16:42:28.527

通常我会执行以下操作：

```
git log --oneline --ancestry-path --merges <commit-of-interest>..C 
```

参数是这里的关键：它导致 git 只显示`--ancestry-path`既是. 该选项进一步过滤结果列表以仅显示合并提交。`<commit-of-interest>``C``--merges`

每个打印的合并都属于以下类别之一：

*   合并`<commit-of-interest>`到一个分支
*   合并将一个不同的分支带入了一个已经有的分支`<commit-of-interest>`
*   两个父分支都已经有了`<commit-of-interest>`

第一个类别是您感兴趣的类别。您通常可以通过查看提交主题行来判断合并属于哪个类别。从列表底部开始；最早的合并最有可能属于第一类。

从技术上讲，可以编写一个脚本来过滤第二类和第三类中的合并（只需测试以查看`<commit-of-interest>`合并的第一个父级是否可以访问），但我从未发现它是必要的。

如果您需要对提交历史进行更深入的研究，那么我建议您查看历史图表：

```
git log --oneline --graph --color --decorate \
    --ancestry-path <commit-of-interest>..C 
```

您可能也想折腾`--boundary`，尽管有时会增加太多噪音。您可以使用`gitk`，但不幸的是，它绘制的图表没有以正确的顺序显示父级（`gitk`可能会在左侧绘制合并与其第二个父级之间的边缘；`git log --graph`总是在右侧绘制第二个父级边缘）。

# javascript - 我怎样才能使这个以前的脚本答案适应我的目标页面？

> ID：11371466
> 
> 赞同：-1
> 
> 时间：2012-07-07T01:07:05.953
> 
> 标签：javascript, html, greasemonkey

我希望浏览器能够以绿色突出显示问题的正确答案。
我找到[**了一个似乎是正确想法的答案**（如何使用 Greasemonkey 自动选择特定的单选按钮？）](https://stackoverflow.com/questions/11025270/)但我不知道足够的 javascript 来使用它。

我的 HTML 代码显示在[**这个小提琴**](http://jsfiddle.net/kDThC/6/)中。

所需的输出示例应如下所示：

> ![在此处输入图像描述](../Images/a5d46dfa52a837e60fd7b5d5b0186ebb.png)

我如何使其他答案适应我的情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T02:05:06.050

和`var questionTxt =`行`var ansForThisQ =`必须适应目标页面的特定 HTML。

同样，`ansForThisQ.each (...`循环内的代码也必须进行裁剪。

鉴于您的示例 HTML 具有以下结构：

```
<div class="soru-content">
    <div class="point" style="margin-right:0px">
        <span><img src="IMG_URL"/></span>
    </div>
    <div class="soru">
        <p>How many countries will participate in the games?</p>
        <ul>
            <li><a href="ANS_URL1"><span>12</span></a></li>
            <li><a href="ANS_URL2"><span>204</span></a></li>
            <li><a href="ANS_URL3"><span>552</span></a></li>
            <li><a href="ANS_URL4"><span>715</span></a></li>
        </ul>
    </div>
</div> 
```

那么改编后的脚本代码将是：

```
var answerKey   = [
      { q: "How many countries will participate in the games?", a: "204" }
    , { q: "when do olympics start in london", a: "July 27" }
    // etc.
];

//--- Loop through the question(s) on the page and answer then if possible.
var questionTxt = $("div.soru-content div.soru p");

questionTxt.each ( function () {
    var bFoundAnswer    = false;
    var answerTxt       = getAnswer (this.textContent);
    if (answerTxt) {
        //--- We have the answer text, now find the matching radio button and select it.
        var ansForThisQ     = $(this).parent ().find ("ul a span");

        ansForThisQ.each ( function () {
            var zRegExp     = new RegExp (answerTxt, 'i');
            if (zRegExp.test (this.textContent) ) {
                bFoundAnswer    = true;
                $(this).css     ("background", "lime");
                return false;   // End loop
            }
        } );
    }
    else {
        alert ("I don't know how to answer: '" + this.textContent + "'");
        $(this).css ("background", "pink");
    }
    if ( answerTxt  &&  ! bFoundAnswer) {
        alert ("The page does not have the specified answer for the question: '" + this.textContent + "'");
        $(this).css ("background", "pink");
    }
} );

function getAnswer (questionText) {
    for (var J = answerKey.length - 1;  J >= 0;  --J) {
        var zRegExp = new RegExp (answerKey[J].q, 'i');

        if (zRegExp.test (questionText) )
            return answerKey[J].a;
    }
    return null;
} 
```

**请参阅[更新的 Fiddle](http://jsfiddle.net/WBwwn/)。**

更多关于 jQuery 选择器的信息可以在[这部分文档](http://api.jquery.com/category/selectors/)中找到。

# ios - 在 iPad 界面的 UITabController 中使用 UISplitViewController 的错误

> ID：11371468
> 
> 赞同：0
> 
> 时间：2012-07-07T01:07:53.257
> 
> 标签：ios, uisplitviewcontroller, master-detail, uitabcontroller

我是一名新的 IOS 开发人员，正在开发我的第一个应用程序。我很喜欢它，并且已经设法让几乎所有东西都按我想要的方式工作，但我正在追逐一个奇怪的错误。

这是基本的应用程序设计（是的，我知道它可能不符合 Apple UI 指南），我可以描述它：

这是一个使用故事板完全使用最新 X Code 编写的通用应用程序。我有一个工作正常的 iPhone 和 iPad 界面，但它在我的问题存在的 iPad 界面中。根控制器是一个 UITabView。在其中一个选项卡上，我有一个拆分视图控制器，它实现了典型的主细节模式。在纵向模式下，主表被隐藏并呈现内容。导航栏按钮带来主表视图。您选择一个项目，主表视图消失，右侧通过 segue 更新内容。到现在为止还挺好。您旋转设备，一切正常。拆分视图主表保留在左侧，内容呈现在右侧。即使在选项卡控制器中，这一切也很有效。

以下是两个用例，按顺序演示了错误没有发生和发生

1- 错误不会发生 a) 以纵向启动应用程序。b）选择导航按钮以调出主表 c）从表中选择项目（项目渲染，主表消失） d）将设备旋转到横向（主/细节正确旋转） e）从选项卡控制器中选择不同的视图 f）选择原始包含拆分视图的视图 g) 一切都很好

2- 此用例中发生错误 a) 以纵向启动应用程序 b) 选择导航按钮以调出主表 c) 从表中选择项目（项目呈现，主表消失） d) 从选项卡控制器中选择不同的视图 e)在另一个选项卡视图中将设备旋转到横向 f) 从选项卡栏中使用拆分控制器选择原始视图 g) 视图返回，渲染细节，主视图/视图完全丢失。

因此，似乎如果在选择其他选项卡视图之前以横向呈现主/细节，一切都很好。但是，如果在您在选项卡中选择另一个视图之前，主/详细视图至少没有以横向呈现一次，它就不能正常工作。

在我的主/表控制器的 viewWillAppear 方法中，我检查了 self.masterPopoverController.isPopoverVisible 并确定它返回 false。

我想知道这是否是一个错误，或者可能是 Apple 不建议将拆分视图放在另一个控制器中的原因之一？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T02:11:04.973

最终自己找到了答案。

[https://github.com/grgcombs/IntelligentSplitViewController](https://github.com/grgcombs/IntelligentSplitViewController)

这是处理旋转的 UISplitViewController 的子类。

# eclipse - 自动增量变量名 eclipse

> ID：11371473
> 
> 赞同：1
> 
> 时间：2012-07-07T01:09:15.000
> 
> 标签：eclipse

eclipse中有没有办法自动增加每个变量名？

例如

```
int mInt;
int mInt2;
int mInt3;
int mInt4; 
```

等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T01:12:01.483

如果您需要许多类似名称的变量，那么使用不同的数据结构（例如数组）会更好。

# themes - 响应式主题 2 列布局 - 将文本包装在右列中的小部件下

> ID：11371474
> 
> 赞同：0
> 
> 时间：2012-07-07T01:05:35.180
> 
> 标签：themes, css

我已经为此工作了一段时间，但不够精明，不知道如何正确实现它（这样它仍然是一个响应式设计）。

我在测试站点上运行 ThemeID 的免费“响应式”wordpress 主题，需要将单篇文章页面的主体内容文本包裹在右侧边栏下方，并随着侧边栏随时间变化高度而“动态”调整。我计划在此右侧边栏中添加“存档”小部件，因此随着时间的推移，它的高度会增加……因此正文不应延伸到边栏下方，直到它到达边栏的底部。看一下我快速制作的模型，以证明我的意思。

之前：[http ://www.heliossolutions.net/responsive.jpg](http://www.heliossolutions.net/responsive.jpg)

2后：[http ://www.heliossolutions.net/responsive3.jpg](http://www.heliossolutions.net/responsive3.jpg)

如您所见，文本当前在侧边栏下方留下了巨大的空白区域，但我希望它能够在下方流动并适应侧边栏的高度。它还需要保持主题的响应特性并在移动设备上正常工作（即，在手机上查看时，侧边栏小部件应正确显示在所有内容下方，就像开箱即用一样）。

这有意义吗？

当前页面代码如下所示：

```
 <!doctype html>
    <!--[if lt IE 7 ]> <html class="no-js ie6" dir="ltr" lang="en-US"> <![endif]-->
    <!--[if IE 7 ]>    <html class="no-js ie7" dir="ltr" lang="en-US"> <![endif]-->
    <!--[if IE 8 ]>    <html class="no-js ie8" dir="ltr" lang="en-US"> <![endif]-->
    <!--[if (gte IE 9)|!(IE)]><!--> <html class="no-js" dir="ltr" lang="en-US"> <!--<![endif]-->
    <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Title</title>
    <meta name="template" content="Responsive 1.6.9" />
    </head>
    <body class="single single-post postid-36 single-format-standard">
    <div id="container" class="hfeed">
            <div id="header">
            <div id="logo">
            </div><!-- end of #logo -->  
                    <ul class="menu"><li >Home</li></ul>
        </div><!-- end of #header -->
            <div id="wrapper" class="clearfix">
            <div id="content" class="grid col-620">
                <div id="post-36" class="post-36 post type-post status-publish format-standard hentry category-web-development">
                    <div class="post-meta">
                    <span class="meta-prep meta-prep-author">Posted on </span> July 2, 2012</span>                                          
                    </div><!-- end of .post-meta -->
                         <div class="post-entry">
                             <p>Post content here.Post content here.Post content here.Post content here.Post content here.Post content here.Post content here.Post content here.</p>                    
                         </div><!-- end of .post-entry -->
                    <div class="post-data">
                    </div><!-- end of .post-data -->             
                <div class="post-edit"></div>             
                </div><!-- end of #post-36 -->
            <div id="respond">
                <h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/blog/parallax-slider/#respond" style="display:none;">Cancel reply</a></small></h3>
                        <p class="must-log-in">You must be logged in to post a comment.</p>
</div><!-- #respond -->
               </div><!-- end of #content -->
               <div id="widgets" class="grid col-300 fit">
                    <div class="widget-wrapper">
                    <div class="widget-title">In Archive</div>
                        <ul>
                        </ul>
                </div><!-- end of .widget-wrapper -->
                    </div><!-- end of #widgets -->    </div><!-- end of #wrapper -->
        </div><!-- end of #container -->
    <div id="footer" class="clearfix">
        <div id="footer-wrapper">
            <div class="grid col-940">
            <div class="grid col-540">
                     </div><!-- end of col-540 -->
             <div class="grid col-380 fit">
             <ul class="social-icons"></ul><!-- end of .social-icons -->         </div><!-- end of col-380 fit -->
             </div><!-- end of col-940 -->
            <div class="grid col-300 copyright">
                &copy; 2012
            </div><!-- end of .copyright -->
            <div class="grid col-300 scroll-top"><a href="#scroll-top" title="scroll to top">&uarr;</a></div>
            <div class="grid col-300 fit powered">

            </div><!-- end .powered -->
        </div><!-- end #footer-wrapper -->
    </div><!-- end #footer -->
    </body>
    </html> 
```

以及相应的 CSS（试图给你足够多的东西，因为我无法确定确切的问题）：

```
#content {
    margin-bottom:20px;
}

.grid {
    float:left;
    margin-bottom:2.127659574468%;
    padding-top:0;
}

.col-60, 
.col-140, 
.col-220, 
.col-300, 
.col-380, 
.col-460, 
.col-540, 
.col-620, 
.col-700, 
.col-780, 
.col-860 {
    display:inline;
    margin-right:2.127659574468%;
}

.col-620 {
    width:65.957446808511%;
}

.post-meta {
    clear:both;
    color:#9f9f9f;
    font-size:13px;
    margin-bottom:10px;
}

.post-entry {
    clear:both;
}

.post-data {
    clear:both;
    font-size:11px;
    font-weight:700;
    margin-top:20px;
}

.post-edit {
    clear:both;
    display:block;
    font-size:12px;
    margin:1.5em 0;
}

#widgets {
    margin-top:40px;
}

.col-300 {
    width:31.914893617021%;
}

.fit {
    margin-left:0!important;
    margin-right:0!important;
}

.widget-wrapper {
    -webkit-border-radius:6px;
    -moz-border-radius:6px;
    background-color:#f9f9f9;
    border:1px solid #d6d6d6;
    border-radius:6px;
    font-size:13px;
    margin:0 0 20px;
    padding:20px;
}

.clearfix:after, 
#container:after, 
.widget-wrapper:after {
    clear:both;
    content:"\0020";
    display:block;
    height:0;
    max-height:0;
    overflow:hidden;
    visibility:hidden;
}

.clearfix, 
#container, 
.widget-wrapper {
    display:inline-block;
}

.clearfix, 
#container, 
.widget-wrapper {
    display:block;
} 
```

关于如何做到这一点的任何想法？我知道这是可能的，而且可能是一个简单的改变，我只是不够擅长响应式 CSS 来看到它！

感谢：D

[4/9/12 - 更新了 HTML 代码以显示整个页面，删除了额外的 Head 信息（javascript 和样式表）]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T23:56:15.717

很难说，因为您的 HTML 不完整（例如，大多数 div 都没有关闭）。但是， .widget-wrapper 和 .col-300 都有底部边距，如果删除可能会起作用。

# nlp - 输入句子没有标点符号时使用的句子分割工具（已标准化）

> ID：11371476
> 
> 赞同：5
> 
> 时间：2012-07-07T01:09:47.973
> 
> 标签：nlp, text-segmentation

假设有一个像“给我找点爵士音乐然后播放”这样的句子，其中所有文本都被规范化并且没有标点符号（语音识别库的输出）。

除了在连词上拆分的幼稚方法之外，还可以使用哪些在线/离线工具来进行“句子分割”？

输入：

> 给我找些爵士乐然后播放

输出：

> 找我一些爵士音乐
> 播放它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T14:18:53.857

[依赖解析器](http://nlp.stanford.edu/software/lex-parser.shtml)应该会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T11:46:30.870

您可以为此使用语义角色标记器，例如 mate tools 等。它将以道具银行样式提取谓词和相关参数。

# mysql - 如何将 PostgreSQL“merge_db”（又名 upsert）函数翻译成 MySQL

> ID：11371479
> 
> 赞同：1
> 
> 时间：2012-07-07T01:10:37.883
> 
> 标签：mysql, sql, postgresql, upsert

直接来自手册，这是[PostgreSQL 中 merge_db 的规范示例](http://www.postgresql.org/docs/current/static/plpgsql-control-structures.html#PLPGSQL-UPSERT-EXAMPLE)：

```
CREATE TABLE db (a INT PRIMARY KEY, b TEXT);

CREATE FUNCTION merge_db(key INT, data TEXT) RETURNS VOID AS
$$
BEGIN
    LOOP
        -- first try to update the key
        UPDATE db SET b = data WHERE a = key;
        IF found THEN
            RETURN;
        END IF;
        -- not there, so try to insert the key
        -- if someone else inserts the same key concurrently,
        -- we could get a unique-key failure
        BEGIN
            INSERT INTO db(a,b) VALUES (key, data);
            RETURN;
        EXCEPTION WHEN unique_violation THEN
            -- Do nothing, and loop to try the UPDATE again.
        END;
    END LOOP;
END;
$$
LANGUAGE plpgsql;

SELECT merge_db(1, 'david');
SELECT merge_db(1, 'dennis'); 
```

这可以表示为 MySQL 中的用户定义函数，如果可以，如何表示？与 MySQL 的标准相比有什么优势`INSERT...ON DUPLICATE KEY UPDATE`吗？

注意：我专门寻找用户定义的函数，而不是`INSERT...ON DUPLICATE KEY UPDATE`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T04:15:29.360

在 MySQL 5.5.14 上测试。

```
CREATE TABLE db (a INT PRIMARY KEY, b TEXT);

DELIMITER //
CREATE PROCEDURE merge_db(k INT, data TEXT) 
BEGIN
    DECLARE done BOOLEAN;
    REPEAT
        BEGIN
            -- If there is a unique key constraint error then 
            -- someone made a concurrent insert. Reset the sentinel
            -- and try again.
            DECLARE ER_DUP_UNIQUE CONDITION FOR 23000;
            DECLARE CONTINUE HANDLER FOR ER_DUP_UNIQUE BEGIN
                SET done = FALSE;
            END;

            SET done = TRUE;
            SELECT COUNT(*) INTO @count FROM db WHERE a = k;
            -- Race condition here. If a concurrent INSERT is made after
            -- the SELECT but before the INSERT below we'll get a duplicate
            -- key error. But the handler above will take care of that.
            IF @count > 0 THEN 
                UPDATE db SET b = data WHERE a = k;
            ELSE 
                INSERT INTO db (a, b) VALUES (k, data);
            END IF;
        END;
    UNTIL done END REPEAT;
END//

DELIMITER ;

CALL merge_db(1, 'david');
CALL merge_db(1, 'dennis'); 
```

一些想法：

*   您不能先进行更新然后检查[`@ROW_COUNT()`](http://dev.mysql.com/doc/refman/5.5/en/information-functions.html#function_row-count)，因为它返回实际更改的行数。如果该行已经具有您尝试更新的值，则该值可能为 0。
*   此外，`@ROW_COUNT()`复制不是安全的。
*   你可以使用`REPLACE...INTO`.
*   如果使用 InnoDB 或具有事务支持的表，您可能可以使用`SELECT...FOR UPDATE`（未​​经测试）。

我认为此解决方案与仅使用`INSERT...ON DUPLICATE KEY UPDATE`.

# facebook - Facebook 努力抓取一个域名

> ID：11371481
> 
> 赞同：0
> 
> 时间：2012-07-07T01:10:41.890
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph

我已经检查了这个[问题](https://stackoverflow.com/questions/8855361/fb-opengraph-ogimage-not-pulling-images-possibly-https)，听起来他描述的问题和我一样，除了几件事：

1.  我没有在 https 上运行
2.  80% 的时间我尝试调试，我收到这条消息“解析输入 URL 时出错，没有数据被抓取。”
3.  刮板在不同的域上完美地工作，但相同的服务器，相同的主题，几乎相同的内容。每次我尝试一个域时，它都会完美地抓取它，包括图像

在它实际抓取我的页面的 20% 期间，我在上面的链接中遇到了同样的问题。它正在阅读我的缩略图，但显示的是空白图像。该链接将我带到工作图像，但它不想显示任何内容。

奇怪的是，大约 10 个月前，当我每天更新这个博客时，它运行得非常好。唯一的区别是我最近切换了服务器。虽然这可以解释一种可能性，但另一个域也切换了并且没有这个问题。

我不知道为什么我的链接要么在 facebook 中根本没有显示图像，要么给我：

域链接域（无图像，无描述）

非常令人沮丧的情况。有没有人有什么建议？

**更新：**

我有6个域名...

最近我搬了服务器，发现新的服务器并没有准备好压缩页面，所以我的博客文章看起来很疯狂。这迫使我在我的主博客上关闭 WP Super Cache 的压缩。我也在我的第二高流量博客上做了这件事，我想稍后再去其他 4 个。

好吧，现在前两个博客在 facebook 调试器中似乎工作正常，但剩下的 4 个有问题。棘手的部分是，我从一个站点完全删除了 WP Super Cache，但仍然无法获取数据。

因此，虽然从逻辑上看它应该是一个 WP Super Cache 问题，但尽管删除它仍然有错误让我现在相信？我还是很迷茫。

**更新：** 好的，我加载了 Chrome 和 IE，两者都能够轻松提取数据。谷歌片段工具也很好用。我将尝试通过 chrome 发布我的 facebook 粉丝页面的链接，看看它是否正常工作。

我确实清除了我的 FF 缓存并且它没有改变，但我仍然很困惑为什么一个域可以正常工作而另一个域不能正常工作。无论哪种方式，如果添加 Chrome 有效，我现在会坚持下去。

还有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:56:56.900

1.  缓存不应该有任何问题。如果浏览器可以看到您的页面，那么 facebook 调试器也可以。

2.  看看是否有一些 500 错误。尝试从不同的浏览器，清除浏览器缓存等。尝试[谷歌丰富的代码片段](http://www.google.com/webmasters/tools/richsnippets)，看看自定义搜索引擎是否可以正常删除它。

PS：如果你发布网址会更好。

# unix - 从 Unix 'join' 获取唯一行

> ID：11371488
> 
> 赞同：1
> 
> 时间：2012-07-07T01:13:06.453
> 
> 标签：unix, join

鉴于这两个文件

```
file1.txt
------
foo 
bar

file2.txt
------
foo 1
foo 2
bar 31 
```

如何获取file2.txt中成功加入的第一行？加入后的预期结果是：

```
foo 1 
bar 31 
```

我试过这个但没有奏效：

```
join file1.txt file2.txt 
```

什么是正确的加入命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T01:52:12.877

您尝试的连接将打印`foo`from的两个实例`file2`。如果您只想选择一个，则可以`sort`在执行实际连接之前确保两个文件中都有唯一的条目：

```
join <(sort file1) <(sort -k1,1 -u file2) 
```

# delphi - 我可以继承一个具有相同名称的类并在没有单位前缀的其他单位中自由使用它吗？

> ID：11371496
> 
> 赞同：1
> 
> 时间：2012-07-07T01:13:43.193
> 
> 标签：delphi, class, inheritance, overriding, delphi-xe2

假设我想覆盖某个已经在某处定义的类，例如，假设`System.Classes.TOriginalClass`我想保留原来的类名。我知道我必须像这样定义它：

```
type
  TOriginalClass = class(System.Classes.TOriginalClass)
  ...
  end; 
```

如果我想在声明它的同一个单元中实现这个自定义覆盖类，我没有任何问题，只要我希望它使用的每个地方都在我声明这个类的下面。

但是假设我想在另一个单元中使用这个替换类。`System.Classes`是一个非常常见的单元，几乎用于我的所有其他单元。我希望能够同时使用该`System.Classes`单元以及我创建此覆盖版本的单元，我们称之为`MyClasses`.

我知道在任何其他单元中，我可以通过在声明中包含完整的单元/类来实现这一点，如下所示：

```
type
  TMyClass = class(MyClasses.TOriginalClass)
  ...
  end; 
```

但是，这几乎会破坏整个目的，因为我将被迫`MyClasses.`在`TOriginalClass`. 我想做的是不必担心`TOriginalClass`最初声明的地方，并像这样声明......

```
type
  TMyClass = class(TOriginalClass)
  ...
  end; 
```

...同时确保`TMyClass`将继承自`MyClasses.TOriginalClass`而不是`System.Classes.TOriginalClass`.

我很确定这将包括我在 uses 子句中声明这两个单元中的每一个的顺序，例如，在 using`System.Classes`之前使用`MyClasses`。但这应该是可能的吗？这样做时我应该注意什么？

PS -我知道这不是一个真正*的*`TOriginalClass`类，我用它来演示最初在. 这同样适用于任何单位的任何原始班级。*`System.Classes`*

 ** * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T02:46:15.960

你已经给出了答案。

`MyClasses.TOriginalClass`是的，您可以通过仅指定来派生`TOriginalClass`，但它要求`MyClasses`在`uses`列表中比 晚`System.Classes`，或者从列表中完全`System.Classes`省略。`uses`没有别的办法，抱歉。

如果您不符合条件`TOriginalClass`，编译器将使用它遇到的“最后一个”声明。它不会自动使用最衍生的那个。

对不起。*

# ruby-on-rails - Rails：使用 Devise 进行多种布局

> ID：11371498
> 
> 赞同：0
> 
> 时间：2012-07-07T01:14:15.090
> 
> 标签：ruby-on-rails, layout, devise, views

根据用户是否登录，我怎样才能拥有完全不同的布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T01:22:49.097

按照
[https://github.com/plataformatec/devise/wiki/How-To%3a-Create-custom-layouts](https://github.com/plataformatec/devise/wiki/How-To%3a-Create-custom-layouts)
上的说明 进行检查，如果用户已登录，这对于设计意味着检查
`user_signed_in?`，这是设计助手。

具体来说：

```
class ApplicationController < ActionController::Base
  layout :layout_by_resource

  protected

  def layout_by_resource
    if user_signed_in?
      "special_layout_name_for_logged_in"
    else
      "application"
    end
  end
end 
```

并将`special_layout_for_logged_in.html.erb`视图文件放在布局目录中。

# javascript - 跟踪我网站上的 facebooklike 按钮

> ID：11371500
> 
> 赞同：-3
> 
> 时间：2012-07-07T01:14:59.787
> 
> 标签：javascript, facebook-like

我的网站上有一个视频，但在播放视频之前，访问者必须喜欢我的 Facebook 页面。问题是当他回到网站时，由于点赞按钮处于非活动状态，他无法再次看到视频。我正在使用 JavaScript。感谢您的理解，我正在等待您的帮助

```
function setCookie(c_name, value, expiredays) {
    var exdate = new Date();
    exdate.setDate(exdate.getDate() + expiredays);
    document.cookie = c_name + "=" + escape(value) + ((expiredays == null) ? "" : ";expires=" + exdate.toGMTString());
}

function getCookie(c_name) {
    if(document.cookie.length > 0) {
        c_start = document.cookie.indexOf(c_name + "=");
        if(c_start != -1) {
            c_start = c_start + c_name.length + 1;
            c_end = document.cookie.indexOf(";", c_start);
            if(c_end == -1) c_end = document.cookie.length;
            return unescape(document.cookie.substring(c_start, c_end));
        }
    }
    return "";
}

function lecture_vid() {
    var cc = '<iframe class="youtube-player" type="text/html" width="640" height="400" src="http://www.youtube.com/embed/IAsjjSkaWVc?autoplay=1" frameborder="0"></iframe>';
    $("#vid_real").html(cc);
}
FB.Event.subscribe('edge.create', function(href, widget) {
    setCookie('edgeTV', '1', 350);
    faceclick();
});

function faceclick() {
    lecture_vid();
    $('#confirme_jaime').empty().hide();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T11:15:23.447

如果您想知道用户在 Facebook 之外（即不在画布/页面选项卡应用程序中）是否喜欢您的页面，那么您必须让用户连接到您的应用程序，并获得阅读他喜欢的权限。

对于您想要实现的目标，这可能有点过头了（我不会为了观看视频而连接到任何应用程序）。

因此，您唯一的其他选择是将用户单击页面上的“赞”按钮的信息保存到某种数据库中。

但这仍然没有为之前已经喜欢过您的页面的用户提供任何信息 - 那些必须不喜欢您的页面并再次喜欢它的用户。对他们来说糟糕的用户体验，对你的页面也很糟糕，因为 Facebook 可能会在确定你的页面排名时考虑到这种不喜欢/喜欢，尤其是如果它对一个用户发生多次时……</p>

# java - 从文本文件的一行中读取每个整数

> ID：11371502
> 
> 赞同：1
> 
> 时间：2012-07-07T01:15:30.503
> 
> 标签：java, text-processing

我是 Java 新手。我如何从文本文件的一行中读取每个整数。我知道 reader 类有 read 和 readline 函数。但就我而言，我不仅想读取文件中的整数，还想知道行何时更改。因为每一行的第一个元素表示一个数组索引，所有对应的元素都是附加到该索引的链表值。

例如，请参见下面的第 4 行。在这种情况下，我不仅要读取每个整数，而且每行的第一个整数将是数组索引，因此我将有一个 4 元素数组，每个数组元素对应于 A[1]-> 4, A 的列表[2]-> 1,3,4 等等。

1 4

2 1 3 4

3 2 5

4 2

正确检索整数后，我计划通过

```
ArrayList<Integer>[] aList =  (ArrayList<Integer>[]) new ArrayList[numLines]; 
```

已编辑：有人问我到目前为止我的想法以及我被困在哪里的评论，所以下面是我的想法（就原始代码和伪代码混合而言）..

```
 while (lr.readLine() != null) {

        while ( // loop through each character)
                if ( first charcter)
                    aList[index] = first character;
                else 
                    aList[index]->add(second char.... last char of the line);
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T10:04:56.927

感谢扫描仪提示，Andrew Thompson。

这就是我实现它的方式

```
 Scanner sc =new Scanner(new File("FileName.txt"));

    ArrayList<Integer>[] aList = (ArrayList<Integer>[]) new ArrayList[200];
    String line;
    sc.useDelimiter("\\n");
    int vertex = 0;
    while (sc.hasNextLine()) {
        int edge = 0;
        line = sc.nextLine();
        Scanner lineSc = new Scanner(line);
        lineSc.useDelimiter("\\s");
        vertex = lineSc.nextInt() - 1;
        aList[vertex] = new ArrayList<Integer>();
        int tmp = 0;
        System.out.println(vertex);

        while (lineSc.hasNextInt()) {
            edge = lineSc.nextInt();
            aList[vertex].add(edge);
            System.out.print(aList[vertex].get(tmp) +  "  ");
            ++tmp;
        }
        System.out.println ();
    } 
```

# python - django完整性错误，多对多关系

> ID：11371504
> 
> 赞同：0
> 
> 时间：2012-07-07T01:16:25.840
> 
> 标签：python, django, referential-integrity, integrity, database-integrity

那是我的models.py：

```
class User(models.Model):
    email = models.EmailField()

    def __unicode__(self):
        return str(self.email)

class Link(models.Model):
    link = models.URLField()
    users = models.ManyToManyField(User, through='ShortURL')

class ShortURL(models.Model):
    link = models.ForeignKey(Link)
    user = models.ForeignKey(User)
    short_end = models.CharField(max_length=20)
    counter = models.IntegerField() 
```

添加用户工作得很好：

```
>>> user = User.objects.create("john_doe@planetearth.com") 
```

尝试添加链接时出现完整性错误：

```
>>> link = Link.objects.create("stackoverflow.com")
IntegrityError: shortener_link.short_end may not be NULL 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T01:19:37.833

您需要创建这样的链接：

```
Link.objects.create(link="stackoverflow.com", user = request.user, short_end = 'stack', counter = 0) 
```

因为所有这些字段都是必需的。

# ruby - 哪些语言支持“动态”元编程？

> ID：11371505
> 
> 赞同：2
> 
> 时间：2012-07-07T01:16:35.090
> 
> 标签：ruby, programming-languages, metaprogramming

在[Metaprogramming Ruby](http://pragprog.com/book/ppmetr/metaprogramming-ruby)中，作者指出只有少数语言，包括 Ruby，可以在运行时自行操作。除了 Ruby 之外，还有哪些其他语言可以支持这种类型的元编程？

我所指的具体报价在第 xix 页的介绍中：

> 在本书中，我将坚持元编程的不同含义，重点关注在运行时自行操作的代码。只有少数几种语言可以有效地做到这一点，Ruby 就是其中之一。您可以将其视为动态元编程，以区别于代码生成器和编译器的静态元编程。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T01:30:52.020

现在大多数语言都在朝着提供这种功能的方向发展，但它通常不像 ruby​​ 那样“干净”。所有这些语言都有很多这些功能（[参考](http://en.wikipedia.org/wiki/Dynamic_programming_language)）：

*   动作脚本
*   基本的
*   豆壳[3]
*   Clojure
*   冷融合
*   Common Lisp 和大多数其他 Lisp
*   时髦的[4]
*   E 编程语言
*   JavaScript
*   VBScript
*   MATLAB / 八度
*   卢阿
*   Objective-C
*   Perl
*   PHP
*   电源外壳
*   Python
*   红宝石
*   短暂聊天
*   Tcl

其他语言，如 Java 和 C#（[参考](http://blogs.msdn.com/b/meek/archive/2008/04/25/using-linq-expressions-to-generate-dynamic-methods.aspx)）有在运行时检查和创建代码的方法，但它不像那些语言那样“自然”，感觉很像一个 hack。

# bash - 用 awk 计算接口类型

> ID：11371507
> 
> 赞同：2
> 
> 时间：2012-07-07T01:17:11.737
> 
> 标签：bash, awk

我有以下输入：

```
03:00.0 Ethernet controller: Broadcom Corporation NetBooty BCM5111 Gigabit Ethernet (rev 59)
03:00.1 Ethernet controller: Broadcom Corporation NetBooty BCM5111 Gigabit Ethernet (rev 59)
03:00.2 Ethernet controller: Broadcom Corporation NetBooty BCM5111 Gigabit Ethernet (rev 59)
03:00.3 Ethernet controller: Broadcom Corporation NetBooty BCM5111 Gigabit Ethernet (rev 59)
04:00.0 Ethernet controller: Broadcom Corporation NetXtreme II BCM5709 Gigabit Ethernet (rev 20)
04:00.1 Ethernet controller: Broadcom Corporation NetXtreme II BCM5709 Gigabit Ethernet (rev 20)
05:00.0 Ethernet controller: Broadcom Corporation NetXtreme II BCM5709 Gigabit Ethernet (rev 20)
05:00.1 Ethernet controller: Broadcom Corporation NetXtreme II BCM5709 Gigabit Ethernet (rev 20)
06:00.0 Network controller: Intel Corporation Centrino Ultimate-N 6300 (rev 3e) 
```

这是来自`lspci`linux 的，它显然显示了以太网/无线设备及其相应的 pci id。在这种情况下，输出显示系统有 1 个四端口 BCM690 网卡（我编的）、2 个双端口 BCM5709 和一个 Intel 6300 wifi 控制器。

我正在尝试编写可以处理该问题的 awk 逻辑（以及在更多接口系统上更详细的输出），并打印一个简洁的摘要。建议的输出格式，给定上述输入：

```
4 Broadcom Corporation NetBooty BCM5111 Gigabit Ethernet (rev 59) {1x4-port}
4 Broadcom Corporation NetXtreme II BCM5709 Gigabit Ethernet (rev 20) {2x2-port}  
1 Intel Corporation Centrino Ultimate-N 6300 (rev 3e) 
```

以我有限的 awk 知识，到目前为止，我只取得了轻微的成功。这就是我所拥有的，但请注意，我经常查看包含`lspci -v`其他系统输出的文件，因此需要额外的`'/Eth|Net/{if ($2 ~ /^Eth|^Net/) print}'`逻辑来确保我得到正确的东西。

```
awk '/Eth|Net/{if ($2 ~ /^Eth|^Net/) print}' lspci.txt |
awk -F: '{if ($2 ~ /^...0/) pci[$1$2]=$3; count[$3]++} END {for (i in pci) printf "%s %s\n", count[pci[i]], pci[i]}' |
uniq -c |
awk '{nic=""; for (i=3; i <=NF; i++) nic = nic $i " "; if ($1 == 1) printf "%s %s\n", $2, nic; if ($1 != 1) printf "%s %s {%dx%d-port}\n", $2, nic, $1, $2/$1}' 
```

这主要会产生所需的输出，但是呃......我很想把它归结为一个 awk 命令。任何反馈表示赞赏。例子更好。我不需要说明答案；我只需要指出一些类似事情的例子。（如果您有比 awk 更好的工具来完成这项工作，请也向我指出。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T01:24:04.177

```
awk '{$1 = ""; sub(" ", ""); arr[$0]++} END {for (i in arr) {print arr[i], i}}' 
```

丢弃第一个字段和第一个字段分隔符。使用该行的其余部分作为计数器数组的索引。最后打印计数和索引。

这是一个打印端口数的版本（分成多行）：

```
awk '
    {
        split($1, slot, ":");
        $1 = "";
        sub(" ", ""); 
        split($0, type, ":");
        iface[type[2]]++;
        if (!(slot[1] SUBSEP type[2] in slots)) {
            slots[slot[1], type[2]];
            slotcount[type[2]]++
        }
    }
    END {
        for (ifacetype in iface) {
            slotc = slotcount[ifacetype];
            typec = iface[ifacetype]
            ports = "";
            if (typec > 1) {
                ports = " {" slotc "x" typec/slotc "-port}"
            };
            print typec, ifacetype, ports
        }
    }' 
```

将槽信息保存在数组中。丢弃第一个字段和第一个分隔符。计算接口。如果我们以前没有见过这个槽，记住它（简单地指一个数组元素创建它）。计算该接口类型的插槽数。

对于每种接口类型，获取插槽计数和该类型的计数。打印信息。每个接口的端口数是一种类型的计数除以该类型接口占用的插槽数。

顺便说一下，这个双重测试：

```
'/Eth|Net/{if ($2 ~ /^Eth|^Net/) print}' 
```

可以简化为：

```
'$2 ~ /^Eth|^Net/ {print}' 
```

# c++ - 这是否过于具体而无法使用循环进行重构？

> ID：11371512
> 
> 赞同：2
> 
> 时间：2012-07-07T01:18:10.377
> 
> 标签：c++, refactoring, allegro

此函数中的代码是否过于具体而无法使用循环进行重构？没有我能想到的算法可以准确地重现所需的结果。

```
bool Mouse::CreateDefaultImage() {
    if(_defaultImage != nullptr) return false;

    const int DEPTH = 32;
    const int WIDTH = 11;
    const int HEIGHT = 19;
    _defaultImage = create_bitmap_ex(DEPTH, WIDTH, HEIGHT);
    if(_defaultImage == nullptr) return false;

    const int BLACK = 0x000000;
    const int WHITE = 0xFFFFFF;
    const int PINK = 0xFF00FF;

    //Color bitmap to transparent
    clear_to_color(_defaultImage, PINK);

    //Only color areas that are NOT transparent.
    //Each block is a row of pixels.

    /************************************************************************
     * SHOULD PRODUCE THIS RESULT   * = BLACK; 0 = WHITE; - = PINK          *
     * *----------                                                          *
     * **---------                                                          *
     * *0*--------                                                          *
     * *00*-------                                                          *
     * *000*------                                                          *
     * *0000*-----                                                          *
     * *00000*----                                                          *
     * *000000*---                                                          *
     * *0000000*--                                                          *
     * *00000000*-                                                          *
     * *00000*****                                                          *
     * *00*00*----                                                          *
     * *0*-*00*---                                                          *
     * **--*00*---                                                          *
     * *----*00*--                                                          *
     * -----*00*--                                                          *
     * ------*00*-                                                          *
     * ------*00*-                                                          *
     * -------**--                                                          *
     ************************************************************************/

    ((long *)_defaultImage->line[0])[0] = BLACK;
    //((long *)_defaultImage->line[0])[1] = PINK;
    //((long *)_defaultImage->line[0])[2] = PINK;
    //((long *)_defaultImage->line[0])[3] = PINK;
    //((long *)_defaultImage->line[0])[4] = PINK;
    //((long *)_defaultImage->line[0])[5] = PINK;
    //((long *)_defaultImage->line[0])[6] = PINK;
    //((long *)_defaultImage->line[0])[7] = PINK;
    //((long *)_defaultImage->line[0])[8] = PINK;
    //((long *)_defaultImage->line[0])[9] = PINK;
    //((long *)_defaultImage->line[0])[10] = PINK;

    ((long *)_defaultImage->line[1])[0] = BLACK;
    ((long *)_defaultImage->line[1])[1] = BLACK;
    //((long *)_defaultImage->line[1])[2] = PINK;
    //((long *)_defaultImage->line[1])[3] = PINK;
    //((long *)_defaultImage->line[1])[4] = PINK;
    //((long *)_defaultImage->line[1])[5] = PINK;
    //((long *)_defaultImage->line[1])[6] = PINK;
    //((long *)_defaultImage->line[1])[7] = PINK;
    //((long *)_defaultImage->line[1])[8] = PINK;
    //((long *)_defaultImage->line[1])[9] = PINK;
    //((long *)_defaultImage->line[1])[10] = PINK;

    ((long *)_defaultImage->line[2])[0] = BLACK;
    ((long *)_defaultImage->line[2])[1] = WHITE;
    ((long *)_defaultImage->line[2])[2] = BLACK;
    //((long *)_defaultImage->line[2])[3] = PINK;
    //((long *)_defaultImage->line[2])[4] = PINK;
    //((long *)_defaultImage->line[2])[5] = PINK;
    //((long *)_defaultImage->line[2])[6] = PINK;
    //((long *)_defaultImage->line[2])[7] = PINK;
    //((long *)_defaultImage->line[2])[8] = PINK;
    //((long *)_defaultImage->line[2])[9] = PINK;
    //((long *)_defaultImage->line[2])[10] = PINK;

    ((long *)_defaultImage->line[3])[0] = BLACK;
    ((long *)_defaultImage->line[3])[1] = WHITE;
    ((long *)_defaultImage->line[3])[2] = WHITE;
    ((long *)_defaultImage->line[3])[3] = BLACK;
    //((long *)_defaultImage->line[3])[4] = PINK;
    //((long *)_defaultImage->line[3])[5] = PINK;
    //((long *)_defaultImage->line[3])[6] = PINK;
    //((long *)_defaultImage->line[3])[7] = PINK;
    //((long *)_defaultImage->line[3])[8] = PINK;
    //((long *)_defaultImage->line[3])[9] = PINK;
    //((long *)_defaultImage->line[3])[10] = PINK;

    ((long *)_defaultImage->line[4])[0] = BLACK;
    ((long *)_defaultImage->line[4])[1] = WHITE;
    ((long *)_defaultImage->line[4])[2] = WHITE;
    ((long *)_defaultImage->line[4])[3] = WHITE;
    ((long *)_defaultImage->line[4])[4] = BLACK;
    //((long *)_defaultImage->line[4])[5] = PINK;
    //((long *)_defaultImage->line[4])[6] = PINK;
    //((long *)_defaultImage->line[4])[7] = PINK;
    //((long *)_defaultImage->line[4])[8] = PINK;
    //((long *)_defaultImage->line[4])[9] = PINK;
    //((long *)_defaultImage->line[4])[10] = PINK;

    ((long *)_defaultImage->line[5])[0] = BLACK;
    ((long *)_defaultImage->line[5])[1] = WHITE;
    ((long *)_defaultImage->line[5])[2] = WHITE;
    ((long *)_defaultImage->line[5])[3] = WHITE;
    ((long *)_defaultImage->line[5])[4] = WHITE;
    ((long *)_defaultImage->line[5])[5] = BLACK;
    //((long *)_defaultImage->line[5])[6] = PINK;
    //((long *)_defaultImage->line[5])[7] = PINK;
    //((long *)_defaultImage->line[5])[8] = PINK;
    //((long *)_defaultImage->line[5])[9] = PINK;
    //((long *)_defaultImage->line[5])[10] = PINK;

    ((long *)_defaultImage->line[6])[0] = BLACK;
    ((long *)_defaultImage->line[6])[1] = WHITE;
    ((long *)_defaultImage->line[6])[2] = WHITE;
    ((long *)_defaultImage->line[6])[3] = WHITE;
    ((long *)_defaultImage->line[6])[4] = WHITE;
    ((long *)_defaultImage->line[6])[5] = WHITE;
    ((long *)_defaultImage->line[6])[6] = BLACK;
    //((long *)_defaultImage->line[6])[7] = PINK;
    //((long *)_defaultImage->line[6])[8] = PINK;
    //((long *)_defaultImage->line[6])[9] = PINK;
    //((long *)_defaultImage->line[6])[10] = PINK;

    ((long *)_defaultImage->line[7])[0] = BLACK;
    ((long *)_defaultImage->line[7])[1] = WHITE;
    ((long *)_defaultImage->line[7])[2] = WHITE;
    ((long *)_defaultImage->line[7])[3] = WHITE;
    ((long *)_defaultImage->line[7])[4] = WHITE;
    ((long *)_defaultImage->line[7])[5] = WHITE;
    ((long *)_defaultImage->line[7])[6] = WHITE;
    ((long *)_defaultImage->line[7])[7] = BLACK;
    //((long *)_defaultImage->line[7])[8] = PINK;
    //((long *)_defaultImage->line[7])[9] = PINK;
    //((long *)_defaultImage->line[7])[10] = PINK;

    ((long *)_defaultImage->line[8])[0] = BLACK;
    ((long *)_defaultImage->line[8])[1] = WHITE;
    ((long *)_defaultImage->line[8])[2] = WHITE;
    ((long *)_defaultImage->line[8])[3] = WHITE;
    ((long *)_defaultImage->line[8])[4] = WHITE;
    ((long *)_defaultImage->line[8])[5] = WHITE;
    ((long *)_defaultImage->line[8])[6] = WHITE;
    ((long *)_defaultImage->line[8])[7] = WHITE;
    ((long *)_defaultImage->line[8])[8] = BLACK;
    //((long *)_defaultImage->line[8])[9] = PINK;
    //((long *)_defaultImage->line[8])[10] = PINK;

    ((long *)_defaultImage->line[9])[0] = BLACK;
    ((long *)_defaultImage->line[9])[1] = WHITE;
    ((long *)_defaultImage->line[9])[2] = WHITE;
    ((long *)_defaultImage->line[9])[3] = WHITE;
    ((long *)_defaultImage->line[9])[4] = WHITE;
    ((long *)_defaultImage->line[9])[5] = WHITE;
    ((long *)_defaultImage->line[9])[6] = WHITE;
    ((long *)_defaultImage->line[9])[7] = WHITE;
    ((long *)_defaultImage->line[9])[8] = WHITE;
    ((long *)_defaultImage->line[9])[9] = BLACK;
    //((long *)_defaultImage->line[9])[10] = PINK;

    ((long *)_defaultImage->line[10])[0] = BLACK;
    ((long *)_defaultImage->line[10])[1] = WHITE;
    ((long *)_defaultImage->line[10])[2] = WHITE;
    ((long *)_defaultImage->line[10])[3] = WHITE;
    ((long *)_defaultImage->line[10])[4] = WHITE;
    ((long *)_defaultImage->line[10])[5] = WHITE;
    ((long *)_defaultImage->line[10])[6] = BLACK;
    ((long *)_defaultImage->line[10])[7] = BLACK;
    ((long *)_defaultImage->line[10])[8] = BLACK;
    ((long *)_defaultImage->line[10])[9] = BLACK;
    ((long *)_defaultImage->line[10])[10] = BLACK;

    ((long *)_defaultImage->line[11])[0] = BLACK;
    ((long *)_defaultImage->line[11])[1] = WHITE;
    ((long *)_defaultImage->line[11])[2] = WHITE;
    ((long *)_defaultImage->line[11])[3] = BLACK;
    ((long *)_defaultImage->line[11])[4] = WHITE;
    ((long *)_defaultImage->line[11])[5] = WHITE;
    ((long *)_defaultImage->line[11])[6] = BLACK;
    //((long *)_defaultImage->line[11])[7] = PINK;
    //((long *)_defaultImage->line[11])[8] = PINK;
    //((long *)_defaultImage->line[11])[9] = PINK;
    //((long *)_defaultImage->line[11])[10] = PINK;

    ((long *)_defaultImage->line[12])[0] = BLACK;
    ((long *)_defaultImage->line[12])[1] = WHITE;
    ((long *)_defaultImage->line[12])[2] = BLACK;
    //((long *)_defaultImage->line[12])[3] = PINK;
    ((long *)_defaultImage->line[12])[4] = BLACK;
    ((long *)_defaultImage->line[12])[5] = WHITE;
    ((long *)_defaultImage->line[12])[6] = WHITE;
    ((long *)_defaultImage->line[12])[7] = BLACK;
    //((long *)_defaultImage->line[12])[8] = PINK;
    //((long *)_defaultImage->line[12])[9] = PINK;
    //((long *)_defaultImage->line[12])[10] = PINK;

    ((long *)_defaultImage->line[13])[0] = BLACK;
    ((long *)_defaultImage->line[13])[1] = BLACK;
    //((long *)_defaultImage->line[13])[2] = PINK;
    //((long *)_defaultImage->line[13])[3] = PINK;
    ((long *)_defaultImage->line[13])[4] = BLACK;
    ((long *)_defaultImage->line[13])[5] = WHITE;
    ((long *)_defaultImage->line[13])[6] = WHITE;
    ((long *)_defaultImage->line[13])[7] = BLACK;
    //((long *)_defaultImage->line[13])[8] = PINK;
    //((long *)_defaultImage->line[13])[9] = PINK;
    //((long *)_defaultImage->line[13])[10] = PINK;

    ((long *)_defaultImage->line[14])[0] = BLACK;
    //((long *)_defaultImage->line[14])[1] = PINK;
    //((long *)_defaultImage->line[14])[2] = PINK;
    //((long *)_defaultImage->line[14])[3] = PINK;
    //((long *)_defaultImage->line[14])[4] = PINK;
    ((long *)_defaultImage->line[14])[5] = BLACK;
    ((long *)_defaultImage->line[14])[6] = WHITE;
    ((long *)_defaultImage->line[14])[7] = WHITE;
    ((long *)_defaultImage->line[14])[8] = BLACK;
    //((long *)_defaultImage->line[14])[9] = PINK;
    //((long *)_defaultImage->line[14])[10] = PINK;

    //((long *)_defaultImage->line[15])[0] = PINK;
    //((long *)_defaultImage->line[15])[1] = PINK;
    //((long *)_defaultImage->line[15])[2] = PINK;
    //((long *)_defaultImage->line[15])[3] = PINK;
    //((long *)_defaultImage->line[15])[4] = PINK;
    ((long *)_defaultImage->line[15])[5] = BLACK;
    ((long *)_defaultImage->line[15])[6] = WHITE;
    ((long *)_defaultImage->line[15])[7] = WHITE;
    ((long *)_defaultImage->line[15])[8] = BLACK;
    //((long *)_defaultImage->line[15])[9] = PINK;
    //((long *)_defaultImage->line[15])[10] = PINK;

    //((long *)_defaultImage->line[16])[0] = PINK;
    //((long *)_defaultImage->line[16])[1] = PINK;
    //((long *)_defaultImage->line[16])[2] = PINK;
    //((long *)_defaultImage->line[16])[3] = PINK;
    //((long *)_defaultImage->line[16])[4] = PINK;
    //((long *)_defaultImage->line[16])[5] = PINK;
    ((long *)_defaultImage->line[16])[6] = BLACK;
    ((long *)_defaultImage->line[16])[7] = WHITE;
    ((long *)_defaultImage->line[16])[8] = WHITE;
    ((long *)_defaultImage->line[16])[9] = BLACK;
    //((long *)_defaultImage->line[16])[10] = PINK;

    //((long *)_defaultImage->line[17])[0] = PINK;
    //((long *)_defaultImage->line[17])[1] = PINK;
    //((long *)_defaultImage->line[17])[2] = PINK;
    //((long *)_defaultImage->line[17])[3] = PINK;
    //((long *)_defaultImage->line[17])[4] = PINK;
    //((long *)_defaultImage->line[17])[5] = PINK;
    ((long *)_defaultImage->line[17])[6] = BLACK;
    ((long *)_defaultImage->line[17])[7] = WHITE;
    ((long *)_defaultImage->line[17])[8] = WHITE;
    ((long *)_defaultImage->line[17])[9] = BLACK;
    //((long *)_defaultImage->line[17])[10] = PINK;

    //((long *)_defaultImage->line[18])[0] = PINK;
    //((long *)_defaultImage->line[18])[1] = PINK;
    //((long *)_defaultImage->line[18])[2] = PINK;
    //((long *)_defaultImage->line[18])[3] = PINK;
    //((long *)_defaultImage->line[18])[4] = PINK;
    //((long *)_defaultImage->line[18])[5] = PINK;
    //((long *)_defaultImage->line[18])[6] = PINK;
    ((long *)_defaultImage->line[18])[7] = BLACK;
    ((long *)_defaultImage->line[18])[8] = BLACK;
    //((long *)_defaultImage->line[18])[9] = PINK;
    //((long *)_defaultImage->line[18])[10] = PINK;

    return true;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T01:35:23.883

什么 templatetypedef 说：

```
const char *up_left = 
  "*----------"
  "**---------"
  "*0*--------"
  "*00*-------"
  "*000*------"
  // etc
;

for (int r = 0; i < HEIGHT; ++r) {
  for (int c = 0; c < WIDTH; ++c) {
    switch(up_left[r * WIDTH + c]) {
      case '*':
        ((long *)_defaultImage->line[r])[c] = BLACK;
        break;
      case '0'):
        ((long *)_defaultImage->line[r])[c] = WHITE;
        break;
    }
  }
} 
```

唯一需要担心的是，如果你的内存很紧，一个大部分是粉红色的图像最终是否会比字符串中每个像素 1 个字节的代码“压缩”更少。如果是这样，您可以发明非常简单的字节码来压缩图像（可能只是运行长度编码），以及将正确像素写入图像的解释器。

# json - MVC3 DropDownList + JSON + 选定问题

> ID：11371515
> 
> 赞同：3
> 
> 时间：2012-07-07T01:19:16.817
> 
> 标签：json, asp.net-mvc-3, drop-down-menu, selected

我的网站（MVC3 + JQuery）和它的移动版本（MVC3 + JQuery mobile）之间有一个非常奇怪的行为，它们分为两个不同的解决方案。

我正在使用以下代码根据另一个（SearchBy）更改下拉列表（SearchValue）的浓度。

剃刀：

```
@Html.DropDownListFor(x => x.SelectedSearch, new SelectList(Model.SearchBy, "key", "value"), new { onchange = "GetValues($(this).val());" })
@Html.DropDownListFor(m => m.SelectedSearchValue, new SelectList(Model.SearchValue, "key", "value")) 
```

JSON：

```
$.ajax({
                    type: "POST",
                    url: '@Url.Action("GetValues", "Search")',
                    data: "{searchId:" + searchId + "}",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        var options = $('#SelectedSearchValue');
                        $('option', options).remove(); // Remove previous

                        $.each(data, function () {
                            options.append($('<option/>').val(this.Id).text(this.Display));
                        });
                    }
                }); 
```

此代码在我的网站（JQuery）上运行良好，但在我的移动网站（JQuery mobile）上却不是这样，它适用于 Opera Mobile 但不适用于 FF 或 IE 或 Safari ...（我尝试使用用户代理模拟移动设备）

SearchValue 下拉列表的值已正确设置，但在 JSON 调用结束时，所选值是先前选择的值（不在下拉列表的可能值中）。我不确定，所以我给你一个小例子：

我对 SearchBy 有以下可能性： - 名称 - 车

当我选择名称时，我想在 SearchValue 中显示“Name1”、“Name2”等内容 当我选择 Car 时，我想在 SearchValue 中显示“Car1”、“Car2”等内容

但是使用我的移动网站上的先前代码，当我将值“名称”更改为汽车时，下拉列表正确地重新填充了正确的值（“汽车 1”、“汽车 2”等），但选择的值是前一个（例如“Name1”）即使它不在下拉列表的可能值中。我也尝试手动选择第一个值但没有任何反应：

```
$('option[value=' + myBeautifulValue + ']').attr('selected', 'selected'); 
```

你有想法解决我的问题吗？我做错了吗？

提前感谢您的帮助，尼科

PS：对不起我的英语不好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T04:22:50.480

好的，我找到了解决方案。我必须刷新下拉列表，奇怪！像那样 ：

```
var myselect = $("#SelectedSearchValue"); 
myselect[0].selectedIndex = 0; 
myselect.selectmenu('refresh'); 
```

[资源](http://www.andymatthews.net/read/2011/12/14/Refreshing-jQuery-Mobile-listviews,-buttons,-select-dropdowns,-and-input-fields)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T01:20:22.547

尝试使用 jQuery 的`prop`：

```
$('option[value=' + myBeautifulValue + ']').prop('selected', true); 
```

* * *

请参阅[jQuery 升级博客注释](http://blog.jquery.com/2011/05/10/jquery-1-6-1-rc-1-released/)— 设置`selected`元素上的属性时`.prop`用于获取/设置值。

# android - android 库项目中使用的 jar 在使用该库的项目中不可见

> ID：11371516
> 
> 赞同：0
> 
> 时间：2012-07-07T01:19:29.467
> 
> 标签：android

我有三个这样的android项目，

图书馆项目A 项目B

我在Library中使用了admob的jar文件，

ProjectA 和 B 使用 Library 项目作为参考，Library.jar

admob jar 不是直接添加到项目 A 或 B 中。我希望由于 A 和 B 引用库项目并且库引用 admob jar，我可以访问我的项目 A 和 B 中的 admob jar 类，而无需显式使用A/B 中的 admob jar。

项目 A/B 没有与 admob jar 相关的类的特定代码。相关代码仅在库中，并且该代码旨在在编译我的项目时运行。

所以会发生什么是我得到运行时崩溃说找不到类。如果我将 admob jar 添加到我的项目中，它们就没有运行时问题。

请告诉我正确的做法是什么..

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T01:44:19.027

在项目属性 -> Java 构建路径 -> 订购和导入中找到了答案，检查了 admob jar 文件并且它有效:)

# xcode4.3 - XCode 定制

> ID：11371520
> 
> 赞同：1
> 
> 时间：2012-07-07T01:20:38.847
> 
> 标签：xcode4.3

我在哪里可以找到 Xcode 4.3 配置/自定义特性和功能的文档？例如，我在哪里/如何安装模板、编辑器配色方案、库文件等。虽然我正在寻找这些具体的答案，但我更喜欢书籍/网站参考。浏览 Apple 的开发者网站和内置帮助远没有让我感到惊讶……

# ios5 - 如何将连接插座从单独的类文件 (.m) 对象添加到 ViewController 的 MainStoryboard

> ID：11371521
> 
> 赞同：1
> 
> 时间：2012-07-07T01:20:44.023
> 
> 标签：ios5, xcode4.2

我想维护数据封装，并`NSObject`从我的`ViewController.m`.

我的 Objective-C 工作正常，我的类在`ViewController`'s中实例化`viewDidLoad`，我可以通过 my 的方法设置、获取和`NSLog`私有值`NSObject`。

我不能做的是`MainStoryboard`分配连接插座和收到的操作。我的`IBOutlets`(a`UILabel`和`UIButton`) 没有显示在连接检查器中。但是，我`ViewController`的 .[hm] 文件中有很多对象，我可以设置插座连接。这只是我无法在情节提要工具中查看的这个新文件的对象。

我究竟做错了什么？

```
//  GameTimer.h
#import <Foundation/Foundation.h>
@interface GameTimer : NSObject {
    UILabel *gameTimerLabel;
    NSTimer *gameTimer;
    unsigned int gameTimerTicks;  
}
@property unsigned int gameTimerTicks;
@property (nonatomic, retain) IBOutlet UILabel *gameTimerLabel;
@property (nonatomic, retain) IBOutlet UIButton *startButton;
// instantiate the timer
- (IBAction)onStartPressed:(id)sender;
// Update the gameTimerLabel, show new value to user
- (void)gameTimerShow;
// selector func for our timer, manages the tick count for all our timers
- (void)gameTimerEvent;
@end

//  FirstViewController.m
#import "FirstViewController.h"
#import "GameTimer.h"
@interface FirstViewController ()
@end
@implementation FirstViewController
GameTimer *myGameClock;
- (void)viewDidLoad
{
    [super viewDidLoad];
    myGameClock = [[GameTimer alloc] init];
    [myGameClock setGameTimerTicks:33*10];  
    [myGameClock gameTimerShow];
    unsigned long myticks = myGameClock.gameTimerTicks;
    NSLog(@"Ticks=%lu", myticks);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T13:48:04.757

我想你可能对封装控制器的角色感到困惑。由于 Cocoa Touch 框架是一个模型-视图-控制器，控制器是位于视图的用户解释和模型的数据和业务规则之间的“管理器”。因此，您必须将 IBOutlets 和 IBActions 放在 UIViewController 子类中。

将您的计时器构建到一个单独的类中。然后，计时器将被视为模型的一部分，其他控制器或模型的其他对象可以根据需要进行实例化。让你的控制器实例化一个“定时器”。然后使用控制器来管理“定时器”操作。如果需要显示经过的时间，那么 Controller 应该从“Timer”对象中获取经过的时间，并将其放入相应的控件中。如果你需要在“Timer”中设置时间长度，那么Controller将从View的控件中获取值并将其放入“Timer”中。

希望这可以帮助

# python - 如何将一个索引与同一列表中的前一个索引进行比较？

> ID：11371522
> 
> 赞同：1
> 
> 时间：2012-07-07T01:20:46.800
> 
> 标签：python

我试图让这个程序查看列表中的每个先前的数字，并确定该数字是否大于它。如果是，它应该记录大多少倍，并在最后返回。即计数（我使用 num 作为变量）从 0 开始。但是 10 大于 7，因此 num 变为 1。现在 7 不大于 20，因此计数保持不变。但 20 大于 15，所以计数（num）为 2。而 15 大于 4（计数为 3）。现在 4 不大于 6（计数不变）并且 6 不大于下一个数字，因为没有下一个数字。这就是我现在所拥有的。我在想 lst[i] 和 lst[i+1] 可能需要用来引用索引吗？谁能帮我完成这个？谢谢。

```
def count(lst):
num = 0 
some sort of division here? then add to num variable?

#main prog
( count([10, 7, 20, 15, 4, 6]) ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T01:29:15.027

```
import numpy as np
def count(lst):
    return sum(np.diff(lst)>0) 
```

`diff`给出连续元素之间的差异，总和返回正差异的数量.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T01:27:37.690

尝试这个：

```
def count(lst):
    answer = 0
    for i,num in enumerate(lst[1:], 1):
        answer += num < lst[i-1]
    return answer 
```

事实证明，将布尔值添加到整数会强制将`bool`s 也视为`int`s（`True`is`1`和`False`is `0`）。因此，您可以使用它来制作更具可读性的代码。

希望这可以帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T01:22:53.747

```
def count(lst):
    return sum(i > j for i,j in zip(lst[:-1], lst[1:])) 
```

在这里，我们将列表压缩在一起，偏移一个，以获得连续的对。然后我们比较每一对。布尔值是整数，因此我们可以将它们相加以产生最终计数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T02:49:15.047

从 itertools 食谱：

```
from itertools import tee, izip

def pairwise(iterable):
    "s -> (s0,s1), (s1,s2), (s2, s3), ..."
    a, b = tee(iterable)
    next(b, None)
    return izip(a, b)

def count(lst):
    return sum(a>b for a,b in pairwise(lst)) 
```

然后

```
count([10, 7, 20, 15, 4, 6])  # => 3 
```

# java - 是否可以将小部件存储在列表/数组中？

> ID：11371523
> 
> 赞同：2
> 
> 时间：2012-07-07T01:21:03.620
> 
> 标签：java, android, arrays, list

全部 - 我有大量的 Spinner，我想将它们存储在列表/数组中，这样我就不必重写大量代码。我有大约 30 个微调器，它们通过相同的确切代码。我试图找出一种方法将 30 个微调器放入数组列表中，然后通过我的代码运行数组/列表。例子：

```
Spinner spinner1 = (Spinner) findViewById(R.id.spinner);
Spinner spinner2 = (Spinner) findViewById(R.id.spinner2);
List<String> listOfSpinners= new ArrayList(); // This is the part I am not sure about                       
    listOfSpinners.add(spinner1);
    listOfSpinners.add(spinner2); 

    ArrayAdapter<String> adapterSpinner = new ArrayAdapter<String>(this,
                R.layout.spinnerlayout, infoInSpinner);

    adapterSpinner.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);  
    listOfSpinners.setAdapter(adapterSpinner); //I want to use the list here (listOfSpinners) 
```

我什至不知道这是否可能，但我虽然问否则这将是一个漫长的夜晚编写重复代码:)。谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T01:27:49.423

将 ID 存储在数组中，如`int`s。然后遍历它们以设置适配器。

```
ArrayList<Integer> listOfSpinners = new ArrayList<Integer>();
listOfSpinners.add(R.id.spinner);
listOfSpinners.add(R.id.spinner2); 

ArrayAdapter<String> adapterSpinner = new ArrayAdapter<String>(this,
            R.layout.spinnerlayout, infoInSpinner);

adapterSpinner.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
for (Integer spinner : listOfSpinners) {
    // If you want multiple adapters, move the adapter code in here and alter it accordingly.
    ((Spinner) findViewById(spinner)).setAdapter(adapterSpinner);
} 
```

我还没有测试过这段代码，但它应该可以正常工作！请记住，这会将所有`Spinner`s 设置为具有相同的适配器。

# arrays - 如何在不同的数据上使用 NSPredicate 和 NSPredicateEditor（多个谓词？）

> ID：11371525
> 
> 赞同：3
> 
> 时间：2012-07-07T01:21:17.453
> 
> 标签：arrays, macos, nspredicate, nspredicateeditor

我有一个文件**路径数组，**并且我的 UI 中有一个**NSPredicateEditor**设置，用户可以在其中**组合一个 NSPredicate 来查找文件**。他应该能够**按名称、类型、大小和日期进行过滤**。

我现在有几个问题：

*   我只能从编辑器中**获得一个谓词对象。**当我使用 **“predicateForRow:”时，它返回 (null)**
*   如果用户想按名称和大小或日期过滤文件，我不能再在我的数组上使用这个谓词，因为这些信息不包含在其中

**我可以将谓词拆分为不同的谓词而不将其转换为 NSString 对象，然后搜索每个 @" OR " | @" AND " 并将组件分隔成一个数组，然后将每个 NSString 转换为一个新的谓词？**

* * *

在 NSPredicateEditor 设置中，我有一些“左表达式”选项： *Keypaths、Constant Values、Strings、Integer Numbers、Floating Point Numbers*和*Dates*。我想用“名称”、“类型”、“日期”、“大小”向用户显示一个下拉菜单。但是生成的谓词自动看起来像这样：

```
"name" MATCHES[c] "nameTest" OR "type" MATCHES[c] "jpg" OR size == 100 
```

**因为数组中填充了字符串，所以搜索“name”、“type”等并且这些字符串不响应 @"myString"*.name*m 过滤器总是返回 0 个对象。有没有办法在菜单中显示名称、类型、大小和日期，但不手动将“self”写入谓词？**

我已经在 Apple 官方教程、Stackoverflow、Google 甚至 Youtube 上搜索过，以找到线索。这个问题困扰了我将近一个星期。谢谢你的时间！如果您需要更多信息，请告诉我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T16:49:07.750

你来对地方了！:)

> 我只能从编辑器中获得一个谓词对象。

正确的。它是一个`NSPredicateEditor`，不是一个`NSPredicatesEditor`。;)

> 当我使用“predicateForRow：”它返回`(null)`

我不确定我会使用那种方法。我的一般经验法则是在很大程度上忽略它`NSPredicateEditor`的子类`NSRuleEditor`，主要是因为它是一个高度专业化的子类，以至于许多超类方法在谓词编辑器上没有那么大的意义（就像所有关于标准、行选择的东西一样） ， ETC）。它们可能以某种方式相关，但如果它们是相关的，我还没有弄清楚*如何*。

要从编辑器获取谓词，您可以：

```
NSPredicate *predicate = [myPredicateEditor objectValue]; 
```

> 如果用户想按名称和大小或日期过滤文件

你的意思是`(name = [something]) AND (size = [something] OR date = [something])`？

如果是这样`NSPredicateEditor`，如果您已将嵌套模式设置为“复合”，则可以这样做。

> 我不能再在我的数组上使用这个谓词，因为这些信息不包含在其中

你需要什么信息？

> 我可以将谓词拆分为不同的谓词而不将其转换为 NSString 对象，然后搜索每个 @" OR " | @" AND " 并将组件分隔成一个数组，然后将每个 NSString 转换为一个新的谓词？

是的，但这是个*坏*主意。这很糟糕，因为`NSPredicate`已经包含了您需要的所有信息，并且没有必要将其转换为不同的格式并进行*字符串*操作，并且可能会导致并发症（例如，如果有人可以输入“名称”的值，如果他们输入“或”？）。

I'm having a hard time trying to figure out what it is you're trying to do. It sounds like you have an array of `NSString` objects that you want to filter based on a predicate that the user creates? If so, then what do these `name`, `date`, and `size` key paths mean? What are you trying to do?

# php - 从两个或多个数组中获取不常见的值

> ID：11371527
> 
> 赞同：-3
> 
> 时间：2012-07-07T01:21:38.597
> 
> 标签：php, arrays

PHP中是否有任何函数可以提供来自两个或多个数组的不常见值数组？

例如：

```
$array1 = array( "green", "red", "blue");
$array2 = array( "green", "yellow", "red");
....
$result = Function_Needed($array1, $array2,...);
print_r($result); 
```

应该给出输出：

```
array("blue", "yellow", ...); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T01:26:29.390

使用[`array_diff`](http://php.net/array_diff)和[`array_merge`](http://php.net/array_merge)：

```
$result = array_merge(array_diff($array1, $array2), array_diff($array2, $array1)); 
```

[这是一个演示。](http://codepad.org/1Cos2HiZ)

对于多个数组，将其与回调结合起来[`array_reduce`](http://php.net/array_reduce)：

```
function unique(&$a, $b) {
    return $a ? array_merge(array_diff($a, $b), array_diff($b, $a)) : $b;
}

$arrays = array(
    array('green', 'red', 'blue'),
    array('green', 'yellow', 'red')
);

$result = array_reduce($arrays, 'unique'); 
```

[这是一个演示。](http://codepad.org/07yGJqT8)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T01:26:39.207

```
$result = array_diff($array1, $array2) + array_diff($array2, $array1); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T01:23:28.443

试试吧[`array_diff`](http://php.net/manual/en/function.array-diff.php)。​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​</p>

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T01:34:29.640

这应该这样做。它可以扩展为使用两个以上的数组。它基本上计算公共键的出现并返回计数为 1 的那些：

```
$a = array('yellow', 'blue', 'red', 'green');
$b = array('blue', 'purple', 'green');

function unintersect($a, $b)
{
  $x = array_fill_keys($a, 1);
  foreach ($b as $v) {
    $x[$v]++; // this might trigger warning
  }
  return array_keys(array_filter($x, function($v) {
    return $v === 1;
  }));
}

print_r(unintersect($a, $b)); 
```

回报：

```
Array
(
    [0] => yellow
    [1] => red
    [2] => purple
) 
```

# android - 切换时标签活动被破坏

> ID：11371536
> 
> 赞同：1
> 
> 时间：2012-07-07T01:23:57.410
> 
> 标签：android

我在这个 fasion 中创建了 3 个标签

```
intent = new Intent(this, TestListActivity.class);
View tabview = createTabView(mTabHost.getContext(), tag);
TabSpec setContent = mTabHost.newTabSpec(tag).setIndicator(tabview).setContent(intent);
mTabHost.addTab(setContent); 
```

在其中一个中，我从网络加载了图像。但问题是，如果我切换标签并返回，我将重新加载图像。在我的图像加载一次之前停留在那里，但现在每次我切换标签时，活动都会被破坏。知道我可能会改变什么来导致这种情况吗？

# netbeans - 无法写入 netbeans 中的 .txt 文件

> ID：11371538
> 
> 赞同：3
> 
> 时间：2012-07-07T01:24:34.090
> 
> 标签：netbeans

我有一个名为`SAVE.txt`. 它与类在同一个包中`k`。问题是我无法`.txt`使用以下代码在文件中写入任何内容`k`：

```
File saveButton = new File ("SAVE.txt");
BufferedWriter output = new BufferedWriter (new FileWriter (saveButton));
output.write("something");
output.close(); 
```

谁能帮我这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T04:03:37.187

当你写的时候`new File ("SAVE.txt")`，由于你指定了一个相对路径，它指的是*当前工作目录*`SAVE.txt`中的一个文件。**当前目录通常与您的 Java 包对应的目录完全分开。**

 ***在 Netbeans 中运行代码时，应该可以指定工作目录（查看项目设置）。将其设置到某个明确定义的位置，例如项目的根目录。现在指定相对于该工作目录的路径。例如，您可以使用`new File ("out/SAVE.txt")`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T01:47:30.943

```
bw = new BufferedWriter(new FileWriter("filepath",true));  
bw.write("Hello World!");  
bw.write("\n");  
bw.write("Hello World 2 !\n");  
bw.write("Hello World 3 !" + "\n");  
bw.close(); 
```

尝试这个？

你有没有尝试过这样简单的事情：

```
FileWriter f = new FileWriter("test.txt"); 
f.write("hello"); 
f.close(); 
```***

# c++ - 将 IplImage IPL_DEPTH_32S 转换为 QImage Format_RGB32 的最快方法

> ID：11371540
> 
> 赞同：0
> 
> 时间：2012-07-07T01:24:49.060
> 
> 标签：c++, qt, opencv, qimage, iplimage

将 IplImage IPL_DEPTH_32S 转换为 QImage Format_RGB32 的最快方法是什么？

我需要从 cam 中捕捉图片并以每秒 30 帧的频率在表单上显示。我尝试使用 QImage 构造函数：

```
QImage qImage((uchar *) image->imageData, image->width, image->height, QImage::Format_RGB32); 
```

但在此之后图像已损坏。那么，我怎样才能快速做到这一点（我认为将逐个像素放入 QImage 不是一个好的决定）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T02:01:58.707

在我开始之前，OpenCV**默认使用 BGR 格式**。不是RGB！因此，在创建之前，`QImage`您需要使用以下命令将您的转换`IplImage`为 RGB：

```
cvtColor(image, image, CV_BGR2RGB); 
```

那么你也能：

```
QImage qImage((uchar*) image->imageData, image->width, image->height, QImage::Format_RGB32); 
```

请注意，[上面的构造函数](http://doc.qt.nokia.com/4.7-snapshot/qimage.html#QImage-5)不会像您想的那样复制数据，正如文档所述：

> 缓冲区必须在 QImage 的整个生命周期内保持有效

所以如果你有**性能问题不是因为转换过程**。这很可能是由您使用的绘图方法引起的（问题中没有共享）。总结一下很多废话，您应该[将其渲染`QImage`到 OpenGL 纹理](https://stackoverflow.com/questions/9011108/image-scaling-keepaspectratiobyexpanding-through-opengl)并让视频卡为您完成所有绘图。

您的问题有点误导，因为您的主要目标不是找到最快的转换方法，而是找到一种真正有效的方法，因为您的方法没有。

另一件重要的事情要记住，当你说：

> 在此之后图像已损坏

你必须知道这完全是模糊的，它对我们一点帮助也没有，因为造成这种影响的原因有很多，没有源代码是不可能确定你做错了什么的。共享原始图像和损坏的图像可能会为问题所在提供一些线索。

现在就是这样。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T04:42:12.523

`IPL_DEPTH_32S`是具有 32 位像素的灰度 - 通常用于深度数据而不是实际的“图像”，如果您将彩色图像打包以检查像素排序是什么。

`QImage::Format_ARGB32_Premultiplied`是最快的 QImage 格式，因为它是显卡使用的格式 - 请注意，数据顺序实际上是 BGRA，并且 A 通道必须至少与像素一样大，即如果您不想使用 alpha，则为 255。

cv::cvtColor() 中有一个 RGB2BGRA 和 BGR2RGBA

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T15:10:13.847

前段时间我在互联网上找到了一些如何做到这一点的例子。我对示例进行了一些改进，以便以更简单的方式复制图像。Qt 仅适用于 char 像素（其他图像格式通常称为 HDR 图像）。我想知道如何在 opencv 中获得 32 位 rgb 的视频缓冲区...我从未见过！

如果你在 opencv 中有彩色图像，你可以使用这个函数来分配内存：

```
QImage* allocateqtimagefromcv(IplImage* cvimg)
    {
        //if (cvimg->nChannels==1)
        //  {
        //  return new QImage(cvimg->width,cvimg->height,QImage::Format_Indexed8);
        //  }
        if (cvimg)
            {
            return new QImage(cvimg->width,cvimg->height,QImage::Format_ARGB32);
            }
    } 
```

只需将 IplImage 复制到 qt 图像，您可以使用简单的方法并使用此功能：

```
void  IplImage2QImage(IplImage *iplImg,QImage* qimg)
{

char *data = iplImg->imageData;
    int channels = iplImg->nChannels;
int h = iplImg->height;
int w = iplImg->width;
for (int y = 0; y < h; y++, data += iplImg->widthStep)
{
for (int x = 0; x < w; x++)
{
char r, g, b, a = 0;
if (channels == 1)
{
r = data[x * channels];
g = data[x * channels];
b = data[x * channels];
}
else if (channels == 3)
{
r = data[x * channels + 2];
g = data[x * channels + 1];
b = data[x * channels];
}

if (channels == 4)
{
a = data[x * channels + 3];
qimg->setPixel(x, y, qRgba(r, g, b, a));
}

}
}

} 
```

以下功能可能是更快的解决方案：

```
static QImage IplImage2QImage(const IplImage *iplImage)
{
  int height = iplImage->height;
  int width = iplImage->width;
  if (iplImage->depth == IPL_DEPTH_8U && iplImage->nChannels == 3)
  {
      const uchar *qImageBuffer =(const uchar*)iplImage->imageData;
      QImage img(qImageBuffer, width, height, QImage::Format_RGB888);
      return img.rgbSwapped();
  }else{
    //qWarning() << "Image cannot be converted.";
   return QImage();
  }
} 
```

希望我的功能有所帮助。也许有人知道更好的方法:)

# clojure - Clojure（或 JCE、JVM 或...？）是否会自动引入并行性？

> ID：11371541
> 
> 赞同：5
> 
> 时间：2012-07-07T01:24:57.490
> 
> 标签：clojure, parallel-processing, jvm, jce

我正在 Intellij Idea 中运行一些 CPU 密集型 Clojure 代码（我认为这并不重要——它似乎只是产生了一个进程）。根据 htop 和 top 的说法，它在我的笔记本电脑上使用了所有 4 个内核（嗯，2 + 超线程）。尽管我在代码中没有任何明确的并行性。

更详细一点：top 显示了一个 CPU 使用率约为 380% 的单个进程，而 htop 显示了一个“父”进程，然后是 4 个“子”进程，每个进程有 1/4 的时间和 100% 的 CPU。

这是正常的吗？或者这是否意味着我在某个地方遇到了一些非常错误的事情？该代码涉及许多惰性序列，但其核心修改了可变数据结构（可变的 - 不是 Clojure 数据结构 - 累积结果的哈希）。 **我没有使用任何明确的并行性。**

在 JCA/JCE（加密库）中可能花费了大量时间（我没有分析过） - 我在 CTR 模式下使用多个 AES 密码，每个密码都作为安全随机字节流（[此处的代码](https://github.com/andrewcooke/particl/blob/master/src/cl/parti/random.clj)），实现为惰性序列。也许这是并行化的？

更多随机想法：这可能与 IO 有关吗？我在一个加密的 SSD 上运行，这个程序正在处理来自磁盘的数据，所以进行了大量的读取。但是 htop 将系统时间显示为红色，而这些是绿色的。

抱歉问了这么模糊的问题。如果需要，我可以发布更多信息。这是 64 位 Linux (JDK 1.7.0_05) 上的 Clojure 1.4。正在执行的代码在[这里，](https://github.com/andrewcooke/particl/blob/master/test/cl/parti/paper.clj)但它非常混乱（更抱歉）并且分布在各种文件中（大部分 CPU 时间都花在了`nearest-in-dump`那里的代码中）。注意 - 请不要浪费时间尝试运行代码来重现，因为它期望预先存在的数据转储在磁盘上（不在 git 中）。

**调试器**在调试器中运行（谢谢，AM）显示四个线程（如果我正确理解调试器），但只有一个正在执行程序。它们被标记为终结器、主（程序）、引用处理程序和信号调度程序。Finalizer + ref handler 处于等待状态；信号调度程序没有可用的帧。我暂时认为这意味着并行性处于较低水平，也许在加密实现中？

**啊哈**，我认为它是并行 GC（Java 现在有一个并发收集器）。开始时，当实际进程暂停时，CPU 使用率会大幅上升（它会打印出一个常规的滴答声）。而且由于它正在处理大量数据，因此会生成许多短期对象（通过使用 -XX:+UseSerialGC 确认，这将 CPU 使用率降低到 100%）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T02:32:34.913

好的，我觉得发布这个有点愚蠢，因为它现在看起来很明显，但它似乎是并行 GC。我正在处理*大量*数据（从 SSD 中吸入）并生成大量短期对象。看来 JVM 有并行 GC。见[http://blog.ragozin.info/2011/12/garbage-collection-in-hotspot-jvm.html](http://blog.ragozin.info/2011/12/garbage-collection-in-hotspot-jvm.html)

这也可能是问题的征兆 - [java GC 发生了什么？PermGen 空间已满？](https://stackoverflow.com/questions/8851484/what-is-going-on-with-java-gc-permgen-space-is-filling-up)- 我明天会调查（我没有提到它 - 尽管回想起来我应该有 - 但这是内存不足的临界点）。

**更新**：使用 -XX:+UseSerialGC 运行可将总 CPU 使用率降低到 100%（即 1 个核心）。但我并不是说上面的两种解释是排他性的，只是通过更好的配置和/或代码我可以减少 GC 的数量。

# python - 将属性重命名为 _property 的原因

> ID：11371544
> 
> 赞同：9
> 
> 时间：2012-07-07T01:25:25.750
> 
> 标签：python, coding-style

我正在阅读`collections.py`昨天的源代码。

在`namedtuple`函数中，`template`会生成一个字符串，然后`exec`在临时命名空间中进行编辑。

在命名空间字典中，被重`property`命名为`_property`和。`tuple``_tuple`

我想知道这背后的原因是什么。这种重命名有助于避免哪些问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-07T01:53:27.180

通常，标准库中有时会使用下划线名称来保持命名空间的整洁。

在 _tuple 的情况下，这是必要的，因为您可以使用“tuple”作为字段名称：

```
>>> Example = namedtuple('Example', ['list', 'tuple', 'property'])
>>> e.list
[10, 20, 30]
>>> e.tuple
(40, 50, 60)
>>> e.property
'Boardwalk' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T01:53:37.877

它避免了关键字名称冲突。

假设我们有一个假想的清单`['when', 'who', 'why', 'where', 'with']`

IE。没有翻译员就不能打字`my_name_tuple.with`。

仔细阅读 namedtuple 上的文档，你应该会明白的。

# php - Joomla URL 重定向

> ID：11371549
> 
> 赞同：0
> 
> 时间：2012-07-07T01:26:46.933
> 
> 标签：php, joomla, metadata, joomla1.5, meta

我在这里有一个关于 joomla 重定向的问题。. 我有一个有错误的 Joomla 网站。每次我访问该站点时，它都会重定向到其他站点。. 但是当我放的时候`www.site.com/index.php`，没关系。我已经查看了 >ndex.html## 有一个元数据：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="refresh" content="0;url=http://redirectto.com/"> 
```

但如果我删除或更改元数据，网站就会出错。.

任何人都可以帮助解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T16:05:48.347

Joomla 通常不会*在任何地方*使用 index.html - 尽管几乎每个文件夹中都有这样的文件，但出于安全原因，它应该是空的。我不能确定您是否出于某种原因安装了将此代码放在 index.html 中的东西，但我以前从未见过这样的东西。

重新阅读，看起来你的 apache 配置默认为 index.html，而它应该默认为 index.php。检查您的 apache 配置，或在您的 joomla 文件夹中放置一个 htaccess 文件来执行此操作，否则 joomla 无论如何都不太可能正常工作 - 它需要默认为 index.php

# javascript - 使用 JavaScript 更改 :hover CSS 属性

> ID：11371550
> 
> 赞同：131
> 
> 时间：2012-07-07T01:27:00.110
> 
> 标签：javascript, html, css, dhtml

JavaScript 如何改变 CSS`:hover`属性？

例如：

**HTML**

```
<table>
  <tr>
    <td>Hover 1</td>
    <td>Hover 2</td>
  </tr>
</table> 
```

**CSS**

```
table td:hover {
background:#ff0000;
} 
```

例如，如何使用 JavaScript将`td :hover`属性修改为？`background:#00ff00`我知道我可以使用 JavaScript 访问样式背景属性：

```
document.getElementsByTagName("td").style.background="#00ff00"; 
```

但我不`.style`知道`:hover`.

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2012-07-07T01:37:49.173

像这样的伪类`:hover`从不引用元素，而是引用满足样式表规则条件的任何元素。您需要*编辑样式表规则*、*附加新规则*或添加包含新`:hover`规则的新样式表。

```
var css = 'table td:hover{ background-color: #00ff00 }';
var style = document.createElement('style');

if (style.styleSheet) {
    style.styleSheet.cssText = css;
} else {
    style.appendChild(document.createTextNode(css));
}

document.getElementsByTagName('head')[0].appendChild(style); 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2012-07-07T01:30:15.540

您[不能通过](https://stackoverflow.com/questions/2754546/can-i-disable-a-css-hover-effect-via-javascript)`:hover`Javascript更改或更改实际的选择器。但是，您可以使用[`mouseenter`](https://developer.mozilla.org/en/DOM/DOM_event_reference/mouseenter)来更改样式并恢复[`mouseleave`](https://developer.mozilla.org/en/DOM/DOM_event_reference/mouseleave)（感谢@Bryan）。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-05-18T15:42:54.597

您可以做的是更改对象的类并定义具有不同悬停属性的两个类。例如：

```
.stategood_enabled:hover  { background-color:green}
.stategood_enabled        { background-color:black}
.stategood_disabled:hover { background-color:red}
.stategood_disabled       { background-color:black} 
```

我在上面找到了这个： [Change an element's class with JavaScript](https://stackoverflow.com/questions/195951/change-an-elements-css-class-with-javascript)

```
function changeClass(object,oldClass,newClass)
{
    // remove:
    //object.className = object.className.replace( /(?:^|\s)oldClass(?!\S)/g , '' );
    // replace:
    var regExp = new RegExp('(?:^|\\s)' + oldClass + '(?!\\S)', 'g');
    object.className = object.className.replace( regExp , newClass );
    // add
    //object.className += " "+newClass;
}

changeClass(myInput.submit,"stategood_disabled"," stategood_enabled"); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2020-02-22T23:08:04.280

很老的问题，所以我想我会添加一个更现代的答案。现在 CSS 变量得到了广泛支持，它们可以用来实现这一点，而无需 JS 事件或`!important`.

以OP为例：

```
<table>
  <tr>
    <td>Hover 1</td>
    <td>Hover 2</td>
  </tr>
</table> 
```

我们现在可以在 CSS 中执行此操作：

```
table td:hover {
  // fallback in case we need to support older/non-supported browsers (IE, Opera mini)
  background: #ff0000;
  background: var(--td-background-color);
} 
```

并使用 javascript 添加悬停状态，如下所示：

```
const tds = document.querySelectorAll('td');
tds.forEach((td) => {
  td.style.setProperty('--td-background-color', '#00ff00');
}); 
```

这是一个工作示例[https://codepen.io/ybentz/pen/RwPoeqb](https://codepen.io/ybentz/pen/RwPoeqb)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2019-08-18T12:58:25.653

很抱歉找到这个页面 7 年太晚了，但这里有一个更简单的方法来解决这个问题（任意改变悬停样式）：

HTML：

```
<button id=Button>Button Title</button> 
```

CSS：

```
.HoverClass1:hover {color: blue !important; background-color: green !important;}
.HoverClass2:hover {color: red !important; background-color: yellow !important;} 
```

JavaScript：

```
var Button=document.getElementById('Button');
/* Clear all previous hover classes */
Button.classList.remove('HoverClass1','HoverClass2');
/* Set the desired hover class */
Button.classList.add('HoverClass1'); 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-05-21T17:49:50.733

如果它符合您的目的，您可以在不使用 css 和`onmouseover`在 javascript 中使用事件的情况下添加悬停功能

这是一个代码片段

```
<div id="mydiv">foo</div>

<script>
document.getElementById("mydiv").onmouseover = function() 
{
    this.style.backgroundColor = "blue";
}
</script> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-06-05T19:57:58.540

这实际上并不是将 CSS 添加到单元格中，但会产生相同的效果。虽然提供与上述其他版本相同的结果，但这个版本对我来说更直观一点，但我是新手，所以值得一试：

```
$(".hoverCell").bind('mouseover', function() {
    var old_color = $(this).css("background-color");
    $(this)[0].style.backgroundColor = '#ffff00';

    $(".hoverCell").bind('mouseout', function () {
        $(this)[0].style.backgroundColor = old_color;
    });
}); 
```

这需要将要突出显示的每个单元格的类设置为“hoverCell”。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-07-04T12:06:28.097

当您检测到该设备支持触摸时，我建议您将所有`:hover`属性替换为。`:active`这样做时只需调用此函数`touch()`

```
 function touch() {
      if ('ontouchstart' in document.documentElement) {
        for (var sheetI = document.styleSheets.length - 1; sheetI >= 0; sheetI--) {
          var sheet = document.styleSheets[sheetI];
          if (sheet.cssRules) {
            for (var ruleI = sheet.cssRules.length - 1; ruleI >= 0; ruleI--) {
              var rule = sheet.cssRules[ruleI];

              if (rule.selectorText) {
                rule.selectorText = rule.selectorText.replace(':hover', ':active');
              }
            }
          }
        }
      }
    } 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-10-19T14:08:20.043

您可以使用鼠标事件进行控制，例如悬停。例如，以下代码在您悬停该元素时可见。

```
var foo = document.getElementById("foo");
foo.addEventListener('mouseover',function(){
   foo.style.display="block";
})
foo.addEventListener('mouseleave',function(){
   foo.style.display="none";
}) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-09-03T10:52:05.753

我曾经有过这种需求，并为此创建了一个小型库，用于维护 CSS 文档

[https://github.com/terotests/css](https://github.com/terotests/css)

有了这个你可以说

```
css().bind("TD:hover", {
        "background" : "00ff00"
    }); 
```

它使用上面提到的技术，并尝试处理跨浏览器问题。如果由于某种原因存在像 IE9 这样的旧浏览器，它将限制 STYLE 标签的数量，因为旧的 IE 浏览器对页面上可用的 STYLE 标签数量有这个奇怪的限制。

此外，它通过仅定期更新标签来限制标签​​的流量。对创建动画类的支持也有限。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-10-23T21:45:43.187

声明一个全局变量：

```
var td 
```

然后选择你的豚鼠`<td>`得到它`id`，如果你想改变它们，那么

```
window.onload = function () {
  td = document.getElementsByTagName("td"); 
} 
```

制作一个要触发的功能和一个循环来更改所有您想要`td`的

```
function trigger() {
    for(var x = 0; x < td.length; x++) { 
      td[x].className = "yournewclass"; 
    }
} 
```

转到您的 CSS 表：

```
.yournewclass:hover { background-color: #00ff00; } 
```

就是这样，有了这个，您可以通过直接更改其 css 属性（在 css 类之间切换）使所有`<td>`标签在悬停时获得 a 。`background-color: #00ff00;`

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2022-02-20T21:56:22.283

我正在研究悬停，以便能够在按钮标签中实现它们并制作悬停效果，我希望它对你有用

```
 <button
                type="submit"
                style=" background-color:cornflowerblue; padding:7px; border-radius:6px"
                onmouseover="this.style.cssText ='background-color:#a8ff78; padding:7px; border-radius:6px;'"
                onmouseout="this.style.cssText='background-color:cornflowerblue; padding:7px; border-radius:6px'"
                @click="form1()"
            >Login</button>
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-05-21T23:28:20.050

您可以制作一个 CSS 变量，然后在 JS 中更改它。

```
:root {
  --variableName: (variableValue);
} 
```

为了在 JS 中改变它，我做了这些方便的小功能：

```
var cssVarGet = function(name) {
  return getComputedStyle(document.documentElement).getPropertyValue(name);
}; 
```

和

```
var cssVarSet = function(name, val) {
  document.documentElement.style.setProperty(name, val);
}; 
```

您可以根据需要创建任意数量的 CSS 变量，并且我没有发现函数中的任何错误；之后，您所要做的就是将它嵌入到您的 CSS 中：

```
table td:hover {
  background: var(--variableName);
} 
```

然后是 bam，一个只需要一些 CSS 和 2 个 JS 函数的解决方案！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-02-20T21:21:47.633

有一些相同的问题，使用 addEventListener 事件“mouseenter”，“mouseleave”：

```
let DOMelement = document.querySelector('CSS selector for your HTML element');

// if you want to change e.g color: 
let origColorStyle = DOMelement.style.color;

DOMelement.addEventListener("mouseenter", (event) => { event.target.style.color = "red" });

DOMelement.addEventListener("mouseleave", (event) => { event.target.style.color = origColorStyle }) 
```

或者当光标位于 DOM 元素上方时的其他样式。可以通过多种方式选择 DOMElement。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2022-02-23T10:00:20.557

你可以在css中创建一个类

```
.hover:hover {
    background: #ff0000;
} 
```

然后动态添加

```
const columns = document.querySelectorAll('table td');

for (let i = 0; i < columns.length; i++) {
   columns[i].classList.add('hover');
} 
```

但是你的 css 和 js 文件应该在 index.html 中连接

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2020-07-09T14:27:50.030

如果您使用轻量级 html ux lang，[请在此处查看示例](http://katecode.herokuapp.com/)，请编写：

```
div root
 .onmouseover = ev => {root.style.backgroundColor='red'}
 .onmouseleave = ev => {root.style.backgroundColor='initial'} 
```

上面的代码执行 css :hover 元标记。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2021-12-28T04:55:13.940

这个对我有用

```
 const useStyles = makeStyles({
        mystyle:{
            color: "red",
            FontFace: "oblique"
        },
        yourStyle:{
            backgroundColor:"green",
            border:0,
            color: 'white',
            "&:hover":{
                backgroundColor:"skyblue",
                border:0,
            }    
        },

         }) 
```

# ubuntu - 试图在 ubuntu 下的 code::blocks 中运行 ogre 项目

> ID：11371561
> 
> 赞同：0
> 
> 时间：2012-07-07T01:29:24.930
> 
> 标签：ubuntu, codeblocks, ogre

我试图让食人魔在 QT Creator 中工作，但遇到了问题。所以我决定尝试 code::blocks 模板项目，但我不断收到这些错误：

> > ||=== 食人魔，调试 ===|
> > 
> > ld|| 找不到 -lOgreMain_d|
> > 
> > ld||找不到 -lOIS_d|
> > 
> > ||=== 构建完成：2 个错误，0 个警告 ===|

似乎很明显它找不到 ogre 库，所以我在库搜索路径中添加了“/lib/x86_64-linux-gnu”，因为这是 ogre 主 .so 文件所在的位置。但是，它仍然无法找到它。我知道我只是愚蠢，但请可怜我。另外，在您问我是否安装了库之前。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T01:50:41.330

找到了一个完美的教程：[http ://www.rdeeson.com/weblog/105/getting-set-up-with-ogre-3d-on-ubuntu.html](http://www.rdeeson.com/weblog/105/getting-set-up-with-ogre-3d-on-ubuntu.html)

# php - 带有减号的 PHP 变量

> ID：11371568
> 
> 赞同：0
> 
> 时间：2012-07-07T01:32:46.100
> 
> 标签：php

我正在修改一个脚本，我想在其中获取一些服务器统计信息，我将我的服务器密钥作为变量之一。我担心变量中不能有减号。真的吗？

见第 3 行。

```
// Convert lists to JSON
$postdata=array();
$postdata['id']="534f7035-cef8-48aa-b233-8d44a0956e68";

// Run POST Request via CURL
$c2=curl_init('http://api.bf3stats.com/'.$platform.'/server/');
curl_setopt($c2,CURLOPT_HEADER,false);
curl_setopt($c2,CURLOPT_POST,true);
curl_setopt($c2,CURLOPT_USERAGENT,'BF3StatsAPI/0.1');
curl_setopt($c2,CURLOPT_HTTPHEADER,array('Expect:'));
curl_setopt($c2,CURLOPT_RETURNTRANSFER,true);
curl_setopt($c2,CURLOPT_POSTFIELDS,$postdata);
$id=curl_exec($c2);
$statuscode=curl_getinfo($c2,CURLINFO_HTTP_CODE);
curl_close($c2);

if($statuscode==200) {
    // Decode JSON Data
    $id=json_decode($id,true);
} else {
    echo "BF3 Stats API error status: ".$statuscode;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T01:40:27.437

不，您的代码完全没问题，因为引号和变量不是以它开头的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T01:37:07.140

由于您定义的变量是用引号引起来的，PHP 会将其视为字符串。所以它可以有任何字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T02:19:36.060

但是，您的代码可以正常工作；由于您没有解析字符串中的任何变量，因此您不妨使用单引号 ( `'`) 而不是双引号 ( `"`)。它的微优化因子几乎没有什么区别，但它会确保你在修改字符串后不会有任何意外结果。

# mongodb - 仅复制 MongoDB 中 {'public':true} 的文档

> ID：11371571
> 
> 赞同：4
> 
> 时间：2012-07-07T01:33:02.507
> 
> 标签：mongodb

我有以下网络/mongodb 设置：

*   1 个主要的 mongodb 数据库（`10.0.0.1`无法从 Internet 访问）- 包含集合 A 和集合 B 中的私人信息，其中包含由受信任用户创建的文档。在任何时候，用户都可以将集合 B 中的任何文档标记为“公共”，这会将其属性从 更改`{'public':false}`为`{'public':true}`。

*   1 个公共 mongodb 数据库（`10.0.0.2`运行一个可通过反向代理从 Internet 访问的网络服务器）- 不包含集合 A，但应包含集合 B 中标记为“公共”的所有文档。这台机器将向外部用户提供这些公共文档网络。

我将如何设置 mongodb，以便当主数据库 ( `10.0.0.1`) 中的文档更新为 时`{'public':true}`，它会被复制到公共 mongodb 数据库 ( `10.0.0.2`)？

**其他详情：**

*   我正在使用 PHP 驱动程序
*   文档很小，最大 2KB
*   这些服务器上的负载可能永远不会超过 10 个并发用户
*   最终的一致性是可以的，最多几分钟，但我想知道我的选择是什么。

* * *

所以，重申一下，这里有一个用例：

> John VPN 进入我们的专用网络，打开`http://10.0.0.1/`，创建一个文档（称之为`D2`），将其标记为私有。然后，约翰查看了一个较旧的文档，`D1`并决定通过单击“公开”按钮将其公开。服务器自动使文档在公共服务器上可用`example.com`（公共 IP `x.y.z.w`，内部 IP `10.0.0.2`）。
> 
> 约翰给莎拉发了一封电子邮件，要求她阅读文档 D1（公开的那个）。莎拉去`http://example.com`并且能够阅读`D1`，但从未见过`D2`。

我的目标是实现这一点，而无需手动编写脚本来同步这两个数据库。我怀疑这应该是可能的，但我无法从我读过的关于 MongoDB 复制的内容中弄清楚。

我欢迎任何建议。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T05:02:24.430

MongoDB (as at 2.0.6) does not have support for filtered replication.

However ... it may be possible for you to implement your own scheme to update records based on a [tailable cursor](http://www.mongodb.org/display/DOCS/Tailable+Cursors) of MongoDB's [oplog](http://docs.mongodb.org/manual/core/replication/#oplog). The local `oplog.rs` capped collection is the same mechanism used to relay changes to members of a replica set and includes details for inserts, deletes, and updates.

For an example of this technique, see this blog post: [Creating Triggers for MongoDB](http://danielweberonline.wordpress.com/2012/05/14/creating-triggers-for-mongodb/).

In your case the actions would be something like:

*   copy record from collection A to B if it is inserted or updated with `public:true`
*   remove record from collection B if it is deleted or updated in collection A with `public:false`

# java - JSF2.0 @EJB 注入 @ViewScoped 导致 MyFaces 到 CFNE

> ID：11371573
> 
> 赞同：2
> 
> 时间：2012-07-07T01:33:13.823
> 
> 标签：java, jsf-2, java-ee-6, myfaces, apache-tomee

我在 TomEE 中运行一个 JSF 项目。我将它升级到 MyFace 2.1.8。我正在使用 Oracle JVM 1.7.04 在 OSX 上运行一切

所以我有这个 ViewScoped 的 ManagedBean：

```
@ManagedBean
@ViewScoped
public class BlogMB implements Serializable {
    private static final long serialVersionUID = 1L;
    @EJB
    private CategoryService categoryService;
} 
```

这是视图代码：

```
<h:commandLink value="#{category.name}">
    <f:setPropertyActionListener
        target="#{blogMB.selectedCategory}"
        value="#{category}" />
    <f:ajax
        listener="#{blogMB.filterPostsByCategory()}"
        execute="@this"
        render=":blogPosts" />
</h:commandLink> 
```

导致此堆栈跟踪。到底他妈发生了什么？我知道它需要反序列化句柄，但为什么在类路径上找不到我的服务类？

```
Jul 06, 2012 8:25:51 PM org.apache.myfaces.renderkit.ServerSideStateCacheImpl deserializeView
SEVERE: Exiting deserializeView - Could not deserialize state: com.xxx.blog.service.CategoryService
java.lang.ClassNotFoundException: com.xxx.blog.service.CategoryService
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:264)
    at java.io.ObjectInputStream.resolveProxyClass(ObjectInputStream.java:694)
    at java.io.ObjectInputStream.readProxyDesc(ObjectInputStream.java:1549)
    at java.io.ObjectInputStream.readClassDesc(ObjectInputStream.java:1511)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1750)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1347)
    at java.io.ObjectInputStream.defaultReadFields(ObjectInputStream.java:1964)
    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1888)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1771)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1347)
    at java.io.ObjectInputStream.readObject(ObjectInputStream.java:369)
    at java.util.HashMap.readObject(HashMap.java:1043)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1004)
    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1866)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1771)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1347)
    at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1685)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1341)
    at java.io.ObjectInputStream.readObject(ObjectInputStream.java:369)
    at java.util.HashMap.readObject(HashMap.java:1043)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at java.io.ObjectStreamClass.invokeReadObject(ObjectStreamClass.java:1004)
    at java.io.ObjectInputStream.readSerialData(ObjectInputStream.java:1866)
    at java.io.ObjectInputStream.readOrdinaryObject(ObjectInputStream.java:1771)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1347)
    at java.io.ObjectInputStream.readArray(ObjectInputStream.java:1685)
    at java.io.ObjectInputStream.readObject0(ObjectInputStream.java:1341)
    at java.io.ObjectInputStream.readObject(ObjectInputStream.java:369)
    at org.apache.myfaces.renderkit.ServerSideStateCacheImpl.deserializeView(ServerSideStateCacheImpl.java:497)
    at org.apache.myfaces.renderkit.ServerSideStateCacheImpl.getSerializedViewFromServletSession(ServerSideStateCacheImpl.java:289)
    at org.apache.myfaces.renderkit.ServerSideStateCacheImpl.restoreSerializedView(ServerSideStateCacheImpl.java:891)
    at org.apache.myfaces.renderkit.html.HtmlResponseStateManager.getState(HtmlResponseStateManager.java:205)
    at org.apache.myfaces.view.facelets.DefaultFaceletsStateManagementStrategy.restoreView(DefaultFaceletsStateManagementStrategy.java:207)
    at org.apache.myfaces.application.StateManagerImpl.restoreView(StateManagerImpl.java:130)
    at org.apache.myfaces.shared.view.ViewDeclarationLanguageBase.restoreView(ViewDeclarationLanguageBase.java:106)
    at org.apache.myfaces.view.facelets.FaceletViewDeclarationLanguage.restoreView(FaceletViewDeclarationLanguage.java:2109)
    at org.apache.myfaces.application.ViewHandlerImpl.restoreView(ViewHandlerImpl.java:300)
    at com.ocpsoft.pretty.faces.application.PrettyViewHandler.restoreView(PrettyViewHandler.java:109)
    at javax.faces.application.ViewHandlerWrapper.restoreView(ViewHandlerWrapper.java:83)
    at org.apache.myfaces.lifecycle.RestoreViewExecutor.execute(RestoreViewExecutor.java:127)
    at org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:170)
    at org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:117)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:197)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at com.ocpsoft.pretty.PrettyFilter.doFilter(PrettyFilter.java:145)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.omnifaces.filter.GzipResponseFilter.doFilter(GzipResponseFilter.java:147)
    at org.omnifaces.filter.HttpFilter.doFilter(HttpFilter.java:75)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.tomee.catalina.OpenEJBValve.invoke(OpenEJBValve.java:44)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

编辑更新：

记录票[https://issues.apache.org/jira/browse/MYFACES-3581](https://issues.apache.org/jira/browse/MYFACES-3581)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T02:39:51.350

看起来我们需要修补`deserializeView`MyFaces 中的方法。长话短说 ObjectInputStream 不使用线程上下文 ClassLoader ( `Thread.currentThread().getClassLoader()`)。所以这种“使用正确的类加载器，该死！” 修复在应用服务器中非常普遍。如果 MyFaces 在里面，`WEB-INF/lib/`那么这会神奇地消失，因为 MyFaces 和被反序列化的类将在同一个类加载器中。不过，移动 MyFaces 并不是正确的解决方法。修补它更好。

当进行反序列化的类在父类加载器中，因此无法看到来自众多子类加载器（每个 webapp 一个）的类时，您通常必须这样做：

```
import java.io.*;
import java.lang.reflect.Proxy;

public class SmarterObjectInputStream extends ObjectInputStream {

    public SmarterObjectInputStream(InputStream in) throws IOException {
        super(in);
    }

    protected Class resolveClass(ObjectStreamClass classDesc) throws IOException, ClassNotFoundException {
        try {
            return Class.forName(classDesc.getName(), false, getClassloader());
        } catch (ClassNotFoundException e) {
            String n = classDesc.getName();
            if (n.equals("boolean")) return boolean.class;
            if (n.equals("byte")) return byte.class;
            if (n.equals("char")) return char.class;
            if (n.equals("short")) return short.class;
            if (n.equals("int")) return int.class;
            if (n.equals("long")) return long.class;
            if (n.equals("float")) return float.class;
            if (n.equals("double")) return double.class;

            throw e;
        }
    }

    protected Class resolveProxyClass(String[] interfaces) throws IOException, ClassNotFoundException {
        Class[] cinterfaces = new Class[interfaces.length];
        for (int i = 0; i < interfaces.length; i++)
            cinterfaces[i] = getClassloader().loadClass(interfaces[i]);

        try {
            return Proxy.getProxyClass(getClassloader(), cinterfaces);
        } catch (IllegalArgumentException e) {
            throw new ClassNotFoundException(null, e);
        }
    }

    private ClassLoader getClassloader() {
        return Thread.currentThread().getContextClassLoader();
    }
} 
```

我们需要给 MyFaces 这个`SmarterObjectInputStream`并确保他们在`deserializeView`方法中使用它。

如果您希望获得修补的荣誉，那就太好了，我相信 MyFaces 会非常高兴看到 TomEE 用户贡献修复。到目前为止，您已经做出了一些伟大的贡献！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:14:34.333

可能的解决方法可以在您的 web.xml 中设置以下内容：

```
<context-param>
    <param-name>org.apache.myfaces.SERIALIZE_STATE_IN_SESSION</param-name>
    <param-value>false</param-value>
</context-param> 
```

虽然这是相当不标准的，我还没有测试过。

# java - Python - 与子进程通信

> ID：11371574
> 
> 赞同：3
> 
> 时间：2012-07-07T01:33:21.590
> 
> 标签：java, python, ipc, pipe, block

我在 Win32 操作系统上运行 Python 2.7，但我希望编写独立于平台的代码。我正在尝试使用 Python 与我编写的 Java 程序进行实时交互，并且计算管道将是执行此操作的最佳方式。我的 Python 脚本将 Java 作为子进程调用。本质上，Java 是 GUI，Python 是后端。（我不想使用 Jython 或 wxPython，因为我只想依赖每种语言提供的标准库。）试图在两者之间建立通信是很糟糕的。我可以使用（父）Python 脚本向（子）Java 类发送一条消息

```
process.stdin.write(msg)
process.stdin.flush() 
```

但读取 Java 的输出并没有奏效。我用

```
process.stdout.read() 
```

但显然，如果没有什么可读的，这将永远阻塞。并且`process.communicate()`是不受限制的，因为在子进程终止之前它不会做任何事情。根据我的研究，人们用来解决这个问题的常用方法是“使用线程”（尽管有人建议在编写时添加换行符——没有用），但是对于 Python 和线程来说，我没有想法会是什么样子。我试过查看标准库的`subprocess.py`源代码，但没有帮助。至少有没有办法查看标准输出是否为空？如果没有，我该如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T02:35:08.623

> process.stdout.read()
> 但如果没有什么可读的，显然这会永远阻塞。

不完全是，它基本上会在它读取/等待直到`EOF`文件关闭时设置的命中时阻塞，避免这种情况的一种方法是说明您要读取多少字节， `process.stdout.read(1)`这将读取 1 个字节，如果没有则返回byte 然后它会等到至少有一个 byte 或`EOF`.

您也可以使用 python`select`模块，它有一个可选的超时时间，其中 select 等待这么长时间，或者只是返回空值[http://docs.python.org/library/select.html](http://docs.python.org/library/select.html)
**虽然它可能不完全支持 Windows。**

> （尽管有人建议在写作时添加换行符——没用）

我实际上已经从/到 python 完成了此操作，再加上`process.stdout.readline().rstrip()`数据是一组行，尽管您仍然必须剥离它们，但请注意，**您可能必须刷新**才能使两个进程都注册数据。

我确实找到了这个[java: how to read and write to & from process thru pipe (stdin/stdout)](https://stackoverflow.com/questions/4112470/java-how-to-both-read-and-write-to-from-process-thru-pipe-stdin-stdout)这可能会对你有所帮助。

祝你好运。

# ruby - 如何使用 Ruby 遍历特定类的所有已创建但未保存的对象？

> ID：11371578
> 
> 赞同：0
> 
> 时间：2012-07-07T01:34:03.960
> 
> 标签：ruby

我想创建一个类的多个实例而不将它们保存到数据库中。然后我想遍历我创建的所有对象。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T02:43:31.580

听起来您正在寻找[`ObjectSpace.each_object`](https://ruby-doc.org/core/ObjectSpace.html#method-c-each_object)：

```
ObjectSpace.each_object(YourClass) do |o|
  # Do something interesting with object 'o' here
end 
```

如果您可以手动跟踪您的对象，那么我认为这会更好，我倾向于将其`ObjectSpace`视为最后的手段。

# sip - WebRTC 调用 PTSN

> ID：11371582
> 
> 赞同：1
> 
> 时间：2012-07-07T01:34:45.957
> 
> 标签：sip, voip, webrtc

我正在查看 WebRTC，我想知道如何实现客户端通过 SIP 连接到 PTSN 的解决方案。这似乎是一项相当新的技术，所以我认为这不适用于 IE 浏览器；它是否正确？

基本上，我在页面上有一个拨号盘 UI 和拥有 SIP 帐户的用户。WebRTC 能否使最终用户能够调用 PTSN 以及实施这种解决方案需要什么？

我正在研究它作为基于 Java 或 Flash 的网络电话的替代方案。

感谢您的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T10:08:15.850

WebRTC 确实是新的，在 IE 或 Safari 上不可用。它在其他浏览器上以 beta/alpha 版本提供。IE 将来可能会支持它，而 Safari 可能会在一段时间内不支持。

WebRTC 只做协商的媒体部分，因此这意味着它不做自己的信号。SIP 可以很好地与 WebRTC 一起工作，但是您需要 SIP 的 JS 实现（通过 WebSockets），然后您需要在服务器端解开 SIP 信号并将其“迁移”到 UDP 或 TCP。Asterisk 正在开发这样一个服务器端平台：http: [//blogs.digium.com/2012/05/23/asterisk-11-webrtc/](http://blogs.digium.com/2012/05/23/asterisk-11-webrtc/)

有关与 WebRTC 结合使用 SIP 的更多信息，请参见：http: [//bloggeek.me/html-sip/](http://bloggeek.me/html-sip/)

# css - 绝对定位一个元素*在*另一个元素中

> ID：11371584
> 
> 赞同：0
> 
> 时间：2012-07-07T01:35:14.240
> 
> 标签：css, positioning

这个问题去css向导。我用谷歌搜索了这个，找不到答案。在这一点上，我不确定这是否可能：

如何指定一个元素在另一个元素中的位置，可以说是半绝对的？

我想说“将元素*内部*x 像素放在*outer*左边框的右侧，无论此时*outer*碰巧在哪里。”

这可能用 javascript 实现，但不应该用 css 实现吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T01:41:27.877

```
#inner {
    position: absolute;
    left: 10px;
} 
```

这个 CSS 实际所做的是将`#inner`元素定位在距离其“最近”父级的左边框 10px 处，该父级的位置值为`absolute`、`relative`或`fixed`。如果没有找到这样的元素，它相对于该`body`元素是绝对定位的，但是如果您确保内部元素的父元素的位置由 CSS 定义，它将绝对定​​位在该父元素中。

**[看看这个 JSFiddle。](http://jsfiddle.net/eRekx/2/)**首先，查看 html 和 CSS 以了解它是如何构造的，然后继续使用鼠标拖动其中一个元素（这就是他们的 javascript 所做的，纯粹是为了演示目的）。请注意，当您拖动外部元素时，内部元素如何随之移动？当你拖动元素时，你所做的只是改变它们`top`和`left`属性的值，并且由于它的父元素是绝对定位的，所以无论你在屏幕上移动它的哪个位置，子元素都将保持在它的同一个位置。:D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T01:38:56.373

绝对，这很容易！您所要做的就是指定父级具有一个位置（相对或绝对），然后绝对定位的子级将被定位为与最近定位的父级“相对”。

使困惑？

# c++ - 无法从挂起进程的单独线程中读取管道

> ID：11371585
> 
> 赞同：0
> 
> 时间：2012-07-07T01:35:17.257
> 
> 标签：c++, windows, multithreading, winapi, pipe

我正在尝试使用处于挂起状态的 CreateProcess 创建进程并从它的标准输出中读取。对于基础，我采用了 MSDN 代码。创建进程后，我将在进程上设置作业限制（尚未实现），然后我开始在来自 STDOUT 管道的单独线程中读取。在启动线程之前，我恢复挂起的进程。结果我从 ReadFile 调用中什么也得不到，即使进程完成，它也会停止并等待数据到达。这是代码

```
#include <windows.h> 
#include <tchar.h>
#include <stdio.h> 
#include <strsafe.h>

#define BUFSIZE 4096 

HANDLE g_hChildStd_IN_Rd = NULL;
HANDLE g_hChildStd_IN_Wr = NULL;
HANDLE g_hChildStd_OUT_Rd = NULL;
HANDLE g_hChildStd_OUT_RdDup = NULL;
HANDLE g_hChildStd_OUT_Wr = NULL;
HANDLE g_hSavedStd_OUT_Wr = NULL;

HANDLE g_hInputFile = NULL;

DWORD WINAPI CreateChildProcess(LPVOID param);
void WriteToPipe(void); 
DWORD WINAPI ReadFromPipe(LPVOID param);
void ErrorExit(PTSTR); 
    PROCESS_INFORMATION piProcInfo; 

int _tmain(int argc, TCHAR *argv[]) 
{ 
    SECURITY_ATTRIBUTES saAttr; 

    printf("\n->Start of parent execution.\n");

    // Set the bInheritHandle flag so pipe handles are inherited. 

    saAttr.nLength = sizeof(SECURITY_ATTRIBUTES); 
    saAttr.bInheritHandle = TRUE; 
    saAttr.lpSecurityDescriptor = NULL; 

    // Create a pipe for the child process's STDOUT. 

    if ( ! CreatePipe(&g_hChildStd_OUT_Rd, &g_hChildStd_OUT_Wr, &saAttr, 0) ) 
        ErrorExit(TEXT("StdoutRd CreatePipe")); 

    // Ensure the read handle to the pipe for STDOUT is not inherited.

    if ( ! SetHandleInformation(g_hChildStd_OUT_Rd, HANDLE_FLAG_INHERIT, 0) )
        ErrorExit(TEXT("Stdout SetHandleInformation")); 

    // Create a pipe for the child process's STDIN. 

    if (! CreatePipe(&g_hChildStd_IN_Rd, &g_hChildStd_IN_Wr, &saAttr, 0)) 
        ErrorExit(TEXT("Stdin CreatePipe")); 

    // Ensure the write handle to the pipe for STDIN is not inherited. 

    if ( ! SetHandleInformation(g_hChildStd_IN_Wr, HANDLE_FLAG_INHERIT, 0) )
        ErrorExit(TEXT("Stdin SetHandleInformation")); 

    STARTUPINFO siStartInfo;
    ZeroMemory( &siStartInfo, sizeof(STARTUPINFO) );
    siStartInfo.cb = sizeof(STARTUPINFO); 
    siStartInfo.hStdError = g_hChildStd_OUT_Wr;
    siStartInfo.hStdOutput = g_hChildStd_OUT_Wr;
    siStartInfo.hStdInput = g_hChildStd_IN_Rd;
    siStartInfo.dwFlags |= STARTF_USESTDHANDLES;
    //CreateThread(&saAttr,0, CreateChildProcess, &siStartInfo, 0, NULL);
    CreateChildProcess(&siStartInfo);
    ResumeThread(piProcInfo.hThread);

    printf( "\n->Contents of child process STDOUT:\n\n", argv[1]);
    //ReadFromPipe(NULL); 
    HANDLE thread = CreateThread(&saAttr,0, ReadFromPipe, &siStartInfo, 0, NULL);
    WaitForSingleObject(thread, INFINITE);

    printf("\n->End of parent execution.\n");

    // The remaining open handles are cleaned up when this process terminates. 
    // To avoid resource leaks in a larger application, close handles explicitly. 

    return 0; 
} 

DWORD WINAPI CreateChildProcess(LPVOID param)
    // Create a child process that uses the previously created pipes for STDIN and STDOUT.
{ 
    TCHAR szCmdline[]=TEXT("C:\\GnuWin32\\bin\\ls.exe");

    STARTUPINFO *siStartInfo = (STARTUPINFO*)param;

    BOOL bSuccess = FALSE; 

    // Set up members of the PROCESS_INFORMATION structure. 

    ZeroMemory( &piProcInfo, sizeof(PROCESS_INFORMATION) );

    // Set up members of the STARTUPINFO structure. 
    // This structure specifies the STDIN and STDOUT handles for redirection.

    // Create the child process. 

    bSuccess = CreateProcess(NULL, 
        szCmdline,     // command line 
        NULL,          // process security attributes 
        NULL,          // primary thread security attributes 
        TRUE,          // handles are inherited 
        CREATE_SUSPENDED | CREATE_SEPARATE_WOW_VDM | CREATE_NO_WINDOW,             // creation flags 
        NULL,          // use parent's environment 
        NULL,          // use parent's current directory 
        siStartInfo,  // STARTUPINFO pointer 
        &piProcInfo);  // receives PROCESS_INFORMATION 
    //If resumethread is here - it works well

   // If an error occurs, exit the application. 
    if ( ! bSuccess ) 
        ErrorExit(TEXT("CreateProcess"));
    else 
    {
        // Close handles to the child process and its primary thread.
        // Some applications might keep these handles to monitor the status
        // of the child process, for example. 

        CloseHandle(piProcInfo.hProcess);
        CloseHandle(piProcInfo.hThread);
    }
    return 0;
}

void WriteToPipe(void) 

    // Read from a file and write its contents to the pipe for the child's STDIN.
    // Stop when there is no more data. 
{ 
    DWORD dwRead, dwWritten; 
    CHAR chBuf[BUFSIZE];
    BOOL bSuccess = FALSE;

    for (;;) 
    { 
        bSuccess = ReadFile(g_hInputFile, chBuf, BUFSIZE, &dwRead, NULL);
        if ( ! bSuccess || dwRead == 0 ) break; 

        bSuccess = WriteFile(g_hChildStd_IN_Wr, chBuf, dwRead, &dwWritten, NULL);
        if ( ! bSuccess ) break; 
    } 

    // Close the pipe handle so the child process stops reading. 

    if ( ! CloseHandle(g_hChildStd_IN_Wr) ) 
        ErrorExit(TEXT("StdInWr CloseHandle")); 
} 

DWORD WINAPI ReadFromPipe(LPVOID param) 

    // Read output from the child process's pipe for STDOUT
    // and write to the parent process's pipe for STDOUT. 
    // Stop when there is no more data. 
{ 
    DWORD dwRead, dwWritten; 
    CHAR chBuf[BUFSIZE]; 
    BOOL bSuccess = FALSE;
    HANDLE hParentStdOut = GetStdHandle(STD_OUTPUT_HANDLE);

    for (;;) 
    { 
        bSuccess = ReadFile( g_hChildStd_OUT_Rd, chBuf, BUFSIZE, &dwRead, NULL);
        if( ! bSuccess || dwRead == 0 ) break; 

        bSuccess = WriteFile(hParentStdOut, chBuf, 
            dwRead, &dwWritten, NULL);
        if (! bSuccess ) break; 
    } 
    return 0;
} 

void ErrorExit(PTSTR lpszFunction) 

    // Format a readable error message, display a message box, 
    // and exit from the application.
{ 
    LPVOID lpMsgBuf;
    LPVOID lpDisplayBuf;
    DWORD dw = GetLastError(); 

    FormatMessage(
        FORMAT_MESSAGE_ALLOCATE_BUFFER | 
        FORMAT_MESSAGE_FROM_SYSTEM |
        FORMAT_MESSAGE_IGNORE_INSERTS,
        NULL,
        dw,
        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
        (LPTSTR) &lpMsgBuf,
        0, NULL );

    lpDisplayBuf = (LPVOID)LocalAlloc(LMEM_ZEROINIT, 
        (lstrlen((LPCTSTR)lpMsgBuf)+lstrlen((LPCTSTR)lpszFunction)+40)*sizeof(TCHAR)); 
    StringCchPrintf((LPTSTR)lpDisplayBuf, 
        LocalSize(lpDisplayBuf) / sizeof(TCHAR),
        TEXT("%s failed with error %d: %s"), 
        lpszFunction, dw, lpMsgBuf); 
    MessageBox(NULL, (LPCTSTR)lpDisplayBuf, TEXT("Error"), MB_OK); 

    LocalFree(lpMsgBuf);
    LocalFree(lpDisplayBuf);
    ExitProcess(1);
} 
```

如果我调用 ResumeThread(piProcInfo.hThread); 就在 CreateProcess 函数之后 - 它运行良好。但是我无论如何都需要在单独的函数中创建并在之后调用 ResumeThread 几个函数。所以，我想怎么做才能让程序在单独的线程中获得暂停进程的输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T05:22:22.067

始终检查返回值。

您正在尝试调用`ResumeThread`已关闭的句柄。如果你检查了返回值，你会注意到这个函数没有成功，这会告诉你问题出在哪里。

删除`CloseHandle(piProcInfo.hThread)`并`CreateChildProcess`调用`ResumeThread`将起作用。

您可能还应该在创建子进程之后关闭`g_hChildStd_OUT_Wr`，`g_hChildStd_IN_Rd`以便您可以知道子进程何时退出。

# asp.net-mvc-3 - 如何在视图中显示布尔值并将值保存到数据库

> ID：11371590
> 
> 赞同：3
> 
> 时间：2012-07-07T01:35:43.633
> 
> 标签：asp.net-mvc-3

我有一个包含位值的表（真/假）

表定义：

```
CharacterID int 
isActive    bit 
UserId  uniqueidentifier 
```

我有两个问题：

1.  如何在下拉列表的编辑视图中显示现有的选定选项
2.  我需要在数据库中将值（是/否）保存为真假。

这是我到目前为止所尝试的：

```
<div class="editor-label">
    @Html.LabelFor(model => model.IsActive)
</div>
<div class="editor-field">
        @Html.DropDownList("", new SelectListItem[] { new SelectListItem() { Text = "Yes", Value = "true", Selected = Model.IsActive }, new SelectListItem() { Text = "No", Value = "false", Selected = !Model.IsActive }})
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T02:21:55.673

假设 model.IsActive 被声明为`bool`：

使用 CheckBox 对用户来说不是更直观并且需要更少的点击吗？在这种情况下，您可以使用：

```
@Html.EditorFor(model => model.IsActive) 
```

如果你真的想要下拉菜单，那么这个 SO 可能会提供一个有效的实现：[https ://stackoverflow.com/a/4036922/1373170](https://stackoverflow.com/a/4036922/1373170)

应用到您的上下文中，我相信它会是：

```
 @Html.DropDownListFor(model => model.IsActive, new SelectList(new SelectListItem[] { new SelectListItem() { Text = "Yes", Value = "True" }, new SelectListItem() { Text = "No", Value = "False"}}, model.IsActive.ToString()) 
```

现在，为了将其保存到数据库中，我必须知道您是否使用 EF、L2S 等。但我想您已经在控制器中设置了用于保存的操作。在这种情况下，它可能已经接收到您的模型实例作为参数。使用 DropDownListFor 而不是 DropDownList，您的模型应该由 MVC 的 default 自动绑定`ModelBinder`，并且您应该能够将其映射到您的数据库实体并存储它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T02:55:08.763

您需要为下拉和 viewmodel 属性设置一些东西才能使其工作。

1）您的视图模型：

```
public class MyModel
    {
        public MyModel()
        {            
            BoolSelectList = new List<SelectListItem>(); 
        }

        public int CharacterID { get; set; }
        public bool isActive   { get; set; }
        public Guid UserId  { get; set; }
        public IList<SelectListItem> BoolSelectList { get; set; }
    } 
```

2）在控制器中，您需要将值分配给 bool Value 和 List

```
public MyModel viewmodel = new MyModel();
// Set other properties of viewmodel
// ....
// Set Drop-down List values
 viewModel.BoolSelectList = new SelectList(new SelectListItem[] { new SelectListItem()                   { Text = "Yes", Value = "True" }, new SelectListItem() { Text = "No", Value = "False"}}; 
```

3) 在您看来：

```
@Html.LabelFor(model => model.isActive, "Is Active ")
@Html.DropDownListFor(model => model.isActive, Model.BoolSelectList, model.IsActive.ToString()) 
```

在您的 Post 操作中，IsActive 的值应为 True/False，具体取决于您的选择。

# iphone - 在 xcode 中读取文本文件

> ID：11371592
> 
> 赞同：1
> 
> 时间：2012-07-07T01:35:50.357
> 
> 标签：iphone, xcode, memory, inheritance, text

首先，我是一个完整的初学者。

这可能是一个愚蠢的问题，但在这里：

我目前正在开发一个应用程序，它包含用户可以查看和阅读的拉丁文本。我将 Xcode 4 与 storybord 功能一起使用。应用程序的构建方式：用户选择作者 - 然后是书 - 然后应用程序显示文本。

我有点困惑，因为我需要有各种文本文件，这取决于用户的选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T09:11:52.797

正如我所做或所做的那样，通常只是将文件作为资源嵌入，并使用下面的代码读出文件

在 .h 文件中

```
-(NSString *)readFile:(NSString *)fileName; 
```

在 .m 文件中

```
-(NSString *)readFile:(NSString *)fileName

{
    NSLog(@"readFile");

    NSString *appFile = fileName;    
    NSFileManager *fileManager=[NSFileManager defaultManager];
    if ([fileManager fileExistsAtPath:appFile])        
    {
        NSError *error= NULL;
        NSString *resultData = [NSString stringWithContentsOfFile: appFile encoding: NSUTF8StringEncoding error: &error]; 
        if (error == NULL)            
            return resultData;
    }
    return NULL;
} 
```

愿这对你有帮助

享受编码:)

**编辑**

我所做的是根据一键单击的日期更改以及在`viewWillApper`我调用下面的函数时

```
-(void)dateAndContentReload
{
    NSLog(@"dateAndContentReload");

    NSLog(@"Appdelegate Date: %@",appDelegate.dateSelected);
    self.currentDate = appDelegate.dateSelected;
    NSDateFormatter* dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateFormat:@"dd MMMM yyyy"];
    NSString *dateString = [dateFormatter stringFromDate: appDelegate.dateSelected];

    self.navigationItem.title = dateString; 
    [dateFormatter setDateFormat: @"Myyyy"];
    NSString *dateComp = [dateFormatter stringFromDate: appDelegate.dateSelected];
    //NSLog(@"date : %@",dateString);
    NSString *data;
    NSString *path;

    if(![dateComp isEqualToString: @"12012"])
    {
        NSString *size = [NSString stringWithFormat: @"%f",appDelegate.size]  ; 
        NSLog(@"dateAndContentReload size: %f",appDelegate.size);

        data = @"<html><body><font size='";
        data = [data stringByAppendingString: size];
        data = [data stringByAppendingString: @"'><P>"];

        data = @"Data not Available for Current Date.";

        data = [data stringByReplacingOccurrencesOfString: @"\n" withString:@"<br>"];

        data = [data stringByAppendingString:@"</P></font></body></html>"];
    }
    else
    {
        [dateFormatter setDateFormat:@"MMMMd"];
        dateString = [dateFormatter stringFromDate: appDelegate.dateSelected];
        [dateFormatter release];
        NSLog(@"new Format: %@",dateString);

        path = [[NSBundle mainBundle] pathForResource: dateString ofType: @"txt"];
        data = nil;
        NSString *size = [NSString stringWithFormat: @"%f",appDelegate.size]  ; 
        NSLog(@"dateAndContentReload size: %f",appDelegate.size);

        data = @"<html><body><font size='";
        data = [data stringByAppendingString: size];
        data = [data stringByAppendingString: @"'><P>"];

        data = [data stringByAppendingString: [self readFile: path]];

        data = [data stringByReplacingOccurrencesOfString: @"\n" withString:@"<br>"];

        data = [data stringByAppendingString:@"</P></font></body></html>"];
    }

    [self.currentView loadHTMLString: data baseURL: nil];
} 
```

基本上我读取文件并`UIWebView`根据客户请求显示。

# eclipse - 在 Visual Studio 中添加新项目

> ID：11371596
> 
> 赞同：1
> 
> 时间：2012-07-07T01:37:34.977
> 
> 标签：eclipse, visual-studio, wizard

在 Eclipse 中，添加新类向导允许您指定各种选项，例如类具有哪些修饰符、它实现了哪些接口、它的父类是什么、它所在的包等。

相比之下，Visual Studio 中默认的添加新项目向导在提供大量模板时不提供此类选项。

有没有办法通过一些设置或扩展在 Visual Studio 中获得类似 Eclipse 的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T01:43:53.003

Visual Studio 应该从一开始就拥有这些功能，我建议通过不同的菜单，如视图、项目等。看看这个 [http://msdn.microsoft.com/en-us/vstudio/cc136611.aspx](http://msdn.microsoft.com/en-us/vstudio/cc136611.aspx)如果你是新的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T07:40:58.983

Visual Studio 有不同的处理方式。您添加类，然后使用重构菜单添加任何接口等。右键单击类名称 -> 重构，或者您可以使用重构菜单。

# django - Django：与 Heroku 同步时，Haystack 重置，找不到结果

> ID：11371597
> 
> 赞同：1
> 
> 时间：2012-07-07T01:37:47.887
> 
> 标签：django, heroku, django-haystack

我刚刚将我的第一个 Django 项目上传到 Heroku，到目前为止，它正在运行，但有一个例外。

每次我将项目的更新版本推送到 Heroku...

```
git push heroku master 
```

... Haystack 不再识别数据库中的任何项目，导致搜索结果为空。这甚至不是迁移。只是定期推送任何更新的代码。添加新项目时，这些项目会出现在搜索中。但是当另一个同步发生时，结果变成空的。我正在将 Haystack 与 Woosh 一起使用。

我不确定如何纠正此问题或可能导致此问题的原因。如果有人有任何可能有帮助的经验或知识，将受到欢迎。

# c# - 将 ASHX 部署到 Azure 时出现 GDI+ 错误

> ID：11371598
> 
> 赞同：0
> 
> 时间：2012-07-07T01:37:48.113
> 
> 标签：c#, .net, azure, drawing

我有以下代码组成托管在 Azure 上的 ASHX 文件：

```
public void ProcessRequest(HttpContext context)
        {
            int number;
            try
            {
                number = int.Parse(context.Request.QueryString["number"]);
            }
            catch
            {
                number = -1;
            }

            var bitmap = new Bitmap(173, 173);
            DrawImage(bitmap, number);
            context.Response.ContentType = "image/png";
            bitmap.Save(context.Response.OutputStream, ImageFormat.Png);
            context.Response.Flush();
        }

        private void DrawImage(Bitmap bitmap, int number)
        {
            using (var graphics = Graphics.FromImage(bitmap))
            {
                graphics.FillRectangle(GetBrush(number), 0, 0, 173, 173);

                Font font = new Font("Segoe UI", 40f, FontStyle.Bold);
                StringFormat textFormat = new StringFormat
                                              {
                                                  Alignment = StringAlignment.Far,
                                                  LineAlignment = StringAlignment.Center
                                              };
                Rectangle rectangle = new Rectangle(0, 0, 160, 173);
                graphics.DrawString("76", font, Brushes.Black, rectangle, textFormat);

                font = new Font("Arial", 16, FontStyle.Bold);
                textFormat = new StringFormat
                                 {
                                     Alignment = StringAlignment.Near,
                                     LineAlignment = StringAlignment.Near
                                 };
                rectangle = new Rectangle(10, 10, 163, 163);
                graphics.DrawString("YOUR NUMBER", font, Brushes.Black, rectangle, textFormat);
            }
        } 
```

在本地运行时，此代码运行良好并生成正确的结果。部署到 Azure 时，我得到以下信息：

> GDI+ 中出现一般错误。
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.Runtime.InteropServices.ExternalException：GDI+ 中发生一般错误。

有人有想法么？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T13:44:14.723

所以，我找到了这个问题的答案，或者至少找到了这个问题的答案之一。

感谢[Rick Strahls 的博客条目](http://www.west-wind.com/weblog/posts/2006/Oct/19/Common-Problems-with-rendering-Bitmaps-into-ASPNET-OutputStream)。虽然位图克隆技术是朝着正确方向迈出的一步（为什么是微软？）显然，当您尝试从 ashx 输出 PNG 时，您必须特别考虑。

这种考虑基本上是在将位图保存到实际位置之前将其保存到 MemoryStream 中。

# ios - 将浮点数转换为 NSNumber

> ID：11371603
> 
> 赞同：23
> 
> 时间：2012-07-07T01:39:12.260
> 
> 标签：ios

我在这里缺少一些基本的东西。应该是忘记了吧。但基本上，我有以下代码，目的是获取一个 NSNumber，将其转换为浮点数，将其乘以 2 并将结果返回给 NSNumber。我在最后一步遇到错误，我很难过。我应该在那里做什么。

```
NSNumber *testNSNumber = [[[NSNumber alloc] initWithFloat:200.0f] autorelease];
float myfloatvalue = [testNSNumber  floatValue] * -2;
NSLog(@" Test float value %1.2f \n\n",myfloatvalue);
[testNSNumber floatValue:myfloatvalue];  // error here is floatValue is not found 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-07-07T01:44:22.147

`floatValue`的方法`NSNumber`不带参数。如果你想设置一个新的浮点数，你需要重新分配`testNSNumber`，因为`NSNumber`没有可变的对应物：

```
testNSNumber = @(myfloatvalue); // The new syntax 
```

或者

```
testNSNumber = [NSNumber numberWithFloat: myfloatvalue]; // The old syntax 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-09-18T14:25:18.470

斯威夫特 3.0：

```
let testNSNumber: NSNumber = NSNumber(value: myfloatvalue) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-23T21:58:34.517

斯威夫特 2.0 版本：

```
let testNSNumber: NSNumber = NSNumber(float: myfloatvalue) 
```

# coq - 在 Coq 中用假假设完成证明

> ID：11371604
> 
> 赞同：3
> 
> 时间：2012-07-07T01:39:15.423
> 
> 标签：coq, theorem-proving

所以我在子目标中有一个错误的假设。这是不同构造函数之间的相等性。如何完成子目标？

```
H: List.Not_Empty Bit.Bit Bit.Zero (List.Empty Bit.Bit) = List.Empty Bit.Bit 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T07:09:50.627

这看起来不像我习惯的标准库中的 Coq 列表，因此如果不知道 List.Not_Empty 和 List.Empty 的定义，将很难为您提供帮助。如果我猜对了那`List.Empty`代表`nil`和`List.Not_empty`代表`cons`，那么这只是表明两个构造函数不相等的问题。例如，您可以这样做：

```
congruence. 
```

或者简单地说：

```
inversion H. 
```

但是，如果涉及更多内容，则这两个可能会失败。所以你想要：

```
SearchAbout List.Not_Empty. 
```

看看是否存在关于它的引理，或者：

```
unfold List.Not_Empty, List.Empty in H. 
```

展开定义并计算出细节（如果它不存在，可能会将这个子证明保存为引理，因为它看起来很有用）。

# vb.net - 如何在 windows vista 下编译运行在 windows 7 / VB 2010 上的程序

> ID：11371606
> 
> 赞同：1
> 
> 时间：2012-07-07T01:40:01.713
> 
> 标签：vb.net

我用 VB 2010 创建了一个应用程序。我的计算机在 Windows Vista 下运行。我也创建了 .EXE 文件；模拟安装，一切正常。但是当我尝试在运行 Windows 7 的计算机上安装该应用程序时，我收到一条错误消息并且该应用程序无法安装。如何让应用程序在 Win7 下运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T05:37:31.947

您需要确保`.NET`在 PC 上安装了 Framework，因为 VB.NET（和 C# 等）使用 .NET Framework 与 CLR 进行交互，而 CLR 默认情况下不包含在 Windows 中。

您可以将安装程序设置为[自行安装 .NET Framework，](https://stackoverflow.com/q/8073399/451590)也[可以单独下载该框架](http://www.microsoft.com/en-us/download/details.aspx?id=17718)。

# jquery - Jquery幻灯片切换中断

> ID：11371608
> 
> 赞同：1
> 
> 时间：2012-07-07T01:40:33.940
> 
> 标签：jquery, html, css, menu, html-lists

我已经从使用 css 显示/隐藏切换到 javascript/jquery 而不是使用 css 来使用幻灯片功能。我的菜单都是水平的，没有垂直的。幻灯片在技术上是有效的，但如果我从子链接的子链接到对角线的子链接，它会完全中断。也许我的逻辑是错误的？Animate 很酷，但它实际上并没有从左侧滑入（我猜是因为列表从上到下然后向上，然后从左侧滑动），所以除非有办法让它工作，我需要幻灯片才能工作。

[小提琴](http://jsfiddle.net/7Tp3N/)

我再次建议去我的测试站点看看实际发生了什么。让它下降到“uhoh”的孩子，然后在悬停在其中一个孩子上时，斜向“bam”，然后向左，然后回到项目。如果这没有搞砸，只是随机让它悬停，当你出去并将鼠标悬停在父级的“项目”上时它会搞砸。

[我的测试站点](http://imengine.gofreeserve.com/fileshare/fileshare2/index2.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T02:42:55.377

对于多次进行此类导航的人来说，您的类名和标记中不需要如此复杂。看看这个小提琴的简化版本：

[http://jsfiddle.net/fQsr9/](http://jsfiddle.net/fQsr9/)

这看起来不那么令人难以抗拒，并且应该更容易使用 jQuery 进行跟踪和操作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T00:55:42.877

问题是我在 jquery 中调用了一个类，该类是多个子 ul 的名称。

```
// Add the 'hover' event listener to our drop down class 
$("#navbar li.has_children").hover(function() {
    // When the event is triggered, grab the current element 'this' and 
    // find it's children '.sub_navigation' and display/hide them
    //$(this).find("ul.sub_menu").first().animate({ width: "toggle" }, 100);
    $(this).find("ul.sub_menu").first().toggle("slide", {
        direction: "left"
    }, 200);
}); 
```

这需要调用另一个悬停函数并将第二个更改为#navbar li ul li.has_children 以确保它切换到正确的。这仍然给我带来了问题，所以我切换到了带有悬停而不是切换的显示/隐藏，他们现在拉动了正确的。

现在，如果他们停止闪烁......

ps 切换到 jquery 中的 :has() 来调用每个结构而不是类。谢谢奥斯汀！

# xcode4.3 - 科学计算器

> ID：11371616
> 
> 赞同：0
> 
> 时间：2012-07-07T01:43:54.037
> 
> 标签：xcode4.3

我使用下面的方法在我的应用程序中实现了一个计算器，但它似乎出现了错误

```
- (IBAction)calculate {
    float x = ([textField1.text floatValue]);
    if (x>=)
    {
        (x<=14000,x*0.0125); 
        (x<=30000,175+x-14000*0.015);
        (x<=80000,415+x-30000*0.0175);
        (x<=300000.1290+x-80000*0.035);
        (x<=1000000,8990+x-300000*0.045);
        (x<=3000000,40490+x-1000000*0.055);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T17:26:39.613

我在这里猜测（因为您发布的不是 C/C++/ObjC 语法）：

```
- (IBAction)calculate {
    float x = ([textField1.text floatValue]);
    if (x <= 14000) {
        x *= 0.0125;
    } else if (x < 30000) {
        x = ((x - 14000) * 0.015) + 175;
    } else if (x < 80000) {
        x = ((x - 30000) * 0.0175) + 415;
    } else if (x < 300000) {
        x = ((x - 80000) * 0.035) + 1290;
    } else if (x < 1000000) {
        x = ((x - 300000) * 0.045) + 8990;
    } else if (x < 3000000) {
        x = ((x - 1000000) * 0.055) + 40490;
    }
} 
```

# css - 将 Div 设置为正文的 100%

> ID：11371625
> 
> 赞同：1
> 
> 时间：2012-07-07T01:44:46.967
> 
> 标签：css, html, height

我有一个名为“主容器”的 div，我想成为我内容的高度。目前，该 div 仅与我的浏览器窗口一样高。我试图像这样纠正这个：

```
html, body{
  height: 100%;
  background-color: $main-background-color;
}

#main-container {
  width: 1024px;
  height: 100%;
  background-color: darken($main-background-color, 5%);
} 
```

不幸的是，这不起作用。我也试过：

```
#main-container {
  width: 1024px;
  min-height: 100%;
  height:auto !important;
  background-color: darken($main-background-color, 5%);
} 
```

这也没有效果。我还重新设计了我的布局，不使用浮动，但这并没有解决问题。在网上搜索后，我没有找到任何其他有效的解决方案。还有其他人有想法吗？

另外，我不知道这是否会影响事情，但我正在使用 Rails 3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T01:50:47.743

在`#main-container`div 的底部，插入以下代码：

```
<div id="push"></div> 
```

然后在您的 CSS 中，添加以下内容：

```
#push {
    clear:both;
} 
```

然后，这应该将整个容器推到内容的高度，而不考虑浮动 div。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T08:51:32.800

我可能误解了您要完成的工作。但是如果你想要的只是让你的 div 成为内容的高度，那么就不要声明高度......

```
html, body{
  background-color: $main-background-color;
}

#main-container {
  width: 1024px;
  background-color: darken($main-background-color, 5%);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T07:43:58.083

尝试设置`min-height:100%`而不是`height`在 html/body 上设置，因为这`height:100%`会将其大小限制为视口。`main-container`然后，当高于视口时，您应该能够拉伸它。

```
html, body{
  min-height: 100%;
  background-color: $main-background-color;
}

#main-container {
  width: 1024px;
  background-color: darken($main-background-color, 5%);
} 
```

# ios - 在您的个人 iPhone 上开发应用程序 - 安全吗？

> ID：11371626
> 
> 赞同：2
> 
> 时间：2012-07-07T01:44:48.170
> 
> 标签：ios, iphone, ipad

我已经在我的 iPad 上开发 iPhone 应用程序很长时间了，我即将为我的 iPhone 开发，但我只是想知道它是安全的，我的意思是......

1.  它可能会伤害我的 iPhone
2.  它会导致 iPhone 出现故障或做一些有趣的事情吗？
3.  任何可能的*缺点*？
4.  我可能错过的任何*优点？*

是否推荐在您自己的个人 iPhone/iOS 设备上进行开发？

感谢您提前提供所有答案...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T01:46:48.277

1.  是的。
2.  是的。
3.  见 1 和 2
4.  真实世界的可用性测试。

我的建议，还是去做吧。你是一个开发者，一个聪明人，一个修补匠。如果出现问题，只需恢复备份即可。

# jquery - 视口上的不透明菜单

> ID：11371628
> 
> 赞同：1
> 
> 时间：2012-07-07T01:44:53.897
> 
> 标签：jquery, viewport

我只想做一件事。当页面顶部的某些内容超出视口时，我想将#topnav 不透明度更改为 0.6。我在这里找到了一些链接，包括：

[https://stackoverflow.com/questions/10402232/jquery-animated-show-hide-of-menu-when-another-div-is-visible-invisible-in-the-v](https://stackoverflow.com/questions/10402232/jquery-animated-show-hide-of-menu-when-another-div-is-visible-invisible-in-the-v)

我试图修改自己，但它似乎不起作用。这是我为了让它发挥作用而做的。

```
 <script>

        $('#brand_logo').bind('inview', function(event, visible) {
            if (visible == true) {
                // element is now visible in the viewport
                console.log("visible");
                $("#topnav").css({
                    opacity: '1.0'
                });
                // $(".head-wrap-left").hide();
            } else {
                // element has gone out of viewport
                console.log("invisible");
                $("#topnav").css({
                    opacity: '0.6'
                });
                // $(".head-wrap-left").show();
            }
        }); 

        </script>​ 
```

你能帮帮我吗？

当我向下滚动时，菜单不会变得不透明。它也没有记录到控制台。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T01:53:00.253

您需要包含 inview 插件，默认情况下它不是 jQuery 的一部分：

[https://github.com/protonet/jquery.inview](https://github.com/protonet/jquery.inview)

# javascript - 带标签的 Javascript/HTML5 图像查看器

> ID：11371632
> 
> 赞同：1
> 
> 时间：2012-07-07T01:46:14.133
> 
> 标签：javascript, image, html, annotations

我正在重建大量在 Flash 中创建的医疗模块。所有模块都经过重新设计，以享受跨平台的乐趣（*js 和 HTML5*）。我一直在寻找一个库或插件，当用户单击按钮时，它将在图像上方添加箭头（具有翻转功能）和文本。我运气不好。

我找到的最接近的包是[Zoomify](http://www.zoomify.com)，但它仍然不是我想要的。他们要求太多的钱来获得最大的开发能力。我真的很希望找到一个 JQuery 插件或 javascript 库来让我完全自定义界面。这是一个**OLD FLASH**模块的截图：

![旧模块](../Images/a9976da56c05c1de26d598e5ce64454c.png)

红色箭头对应于左侧选择的链接。新设计更吸引人，但基本思想是相同的，点击按钮指向对象。

如果没有这样的库或插件，我应该创建一个简单的 javascript 图像查看器并将覆盖坐标存储在数据库中吗？还是那是矫枉过正？我有成百上千的这些事情要做......也许成千上万:(任何帮助/指导将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T02:57:57.573

您所要求的由 CSS 提供，它使您可以将文本直接放在图像或其他呈现的 HTML 之上。要研究的关键 CSS 属性是：

*   [位置](http://www.w3.org/wiki/CSS/Properties/position)设置为“绝对”

*   [top](http://www.w3.org/wiki/CSS/Properties/top)、[right](http://www.w3.org/wiki/CSS/Properties/right)、[bottom](http://www.w3.org/wiki/CSS/Properties/bottom)或[left](http://www.w3.org/wiki/CSS/Properties/left)中至少两个的值

*   使用[z-index](http://www.w3.org/wiki/CSS/Properties/z-index)指定分层/顺序

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T01:54:20.797

[Lightbox](http://lokeshdhakar.com/projects/lightbox2/)是一个不错的选择 “Lightbox 是一个简单、不显眼的脚本，用于在当前页面上叠加图像。它的设置非常简单，适用于所有现代浏览器。”

# android - 为什么Android忽略通知的创建？

> ID：11371635
> 
> 赞同：5
> 
> 时间：2012-07-07T01:46:33.703
> 
> 标签：android, broadcastreceiver, android-notifications, android-alarms

我有代码，但它不起作用，所以我请任何人帮助我。关于这个具体问题的信息很少。

**主要活动**

* * *

```
public class MainActivity extends Activity {
public final int PENDING_INTENT_ID = 8;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button clickity = (Button)findViewById(R.id.alarm_button);
    clickity.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Calendar now = Calendar.getInstance();
            now.add(Calendar.SECOND, 20);

            //Create a new PendingIntent used by the Alarm when it activates
            Intent intent = new Intent(v.getContext(), AlarmReciever.class);
            intent.setAction("SOME_AWESOME_TRIGGER_WORD");
            intent.putExtra("info", "This String shows that the info is actually sent correctly");
            PendingIntent pendingIntent = PendingIntent.getBroadcast(v.getContext(), PENDING_INTENT_ID, intent, PendingIntent.FLAG_UPDATE_CURRENT|Intent.FILL_IN_DATA);

            //Then Create the alarm manager to send this pending intent and set the date to go off
            AlarmManager am = (AlarmManager)getSystemService(Activity.ALARM_SERVICE);
            am.set(AlarmManager.RTC_WAKEUP, now.getTimeInMillis(), pendingIntent);

        }
    });

} 
```

* * *

**AlarmReciever**（知道我拼错了，但既然是这样，我就用它）

* * *

```
public class AlarmReciever extends BroadcastReceiver{

@Override
public void onReceive(Context c, Intent arg1) {

    //get a reference to NotificationManager
    String ns = Context.NOTIFICATION_SERVICE;
    NotificationManager mNotificationManager = (NotificationManager) c.getSystemService(ns);

    //Instantiate the notification

    CharSequence tickerText = "Hello";
    long when = System.currentTimeMillis();
    Notification.Builder builder = new Notification.Builder(c)
                                .setTicker(tickerText)
                                .setWhen(when)
                                .setContentTitle(arg1.getStringExtra("info"))
                                .setContentText("Success!!")
                                .setAutoCancel(true);
    Notification notification = builder.getNotification();
    mNotificationManager.notify(0, notification);//note the first argument, the ID should be unique

}
} 
```

* * *

**显现**

* * *

```
<uses-sdk
    android:minSdkVersion="14"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <receiver 
        android:name="com.testproject.AlarmReciever"
        android:enabled="true"
        android:exported="false" >
        <intent-filter>
    </receiver>

</application> 
```

* * *

那应该就是一切。我正在尝试按原样运行它，但它没有向我显示任何内容。我在模拟器上运行它实际上很重要。

编辑：当我说它不起作用时，我的意思是什么都没有弹出。它运行良好，但通知永远不会弹出。

问题： ![在此处输入图像描述](../Images/87a372de88a919f8cb2ebece956f363f.png)

所以问题被缩小到Android，只是忽略了我的通知。问题是它没有告诉我为什么 -_- 所以我无法修复它。任何有关此事的专家都认为我的代码有问题来调用通知？它在模拟器上是否重要？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-03T17:28:17.720

我遇到了同样的问题。如果创建“new Notification()”时不指定图标，则不会出现通知。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-07T03:31:24.520

好吧，关于通知的教训。我收到错误的原因是必须添加一个 img，如果没有，它不会显示！除了弗拉基米尔慷慨地指出的以外，我所拥有的其他一切基本上都是正确的。在此处发布此内容，以防其他人在测试通知时遇到类似问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T02:01:55.260

```
Intent intent = new Intent(v.getContext(), AlarmReciever.class);
// intent.setAction("SOME_AWESOME_TRIGGER_WORD"); replace to:
intent.setAction("com.testproject.SOME_AWESOME_TRIGGER_WORD"); 
```

至少是第一眼

**升级版：**

```
long firstTime = SystemClock.elapsedRealtime();

AlarmManager alarmManager = (AlarmManager) mContext.getSystemService(Context.ALARM_SERVICE);
alarmManager.setRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP, firstTime, /* INTERVAL IN MS */ 20 * 1000, /* PendingIntent */ intent); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-17T06:24:16.567

这是因为，您没有设置通知图标。如果您设置通知图标，它应该可以工作。日志本身说你不能在没有图像的情况下发送通知。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-08T14:05:03.637

好像你忘了设置图标..你需要至少设置一个默认图标..

尝试这个..

```
Notification.Builder builder = new Notification.Builder(c)
                         .setTicker(tickerText)
                         .setWhen(when)
                         .setContentTitle(arg1.getStringExtra("info"))
                         .setContentText("Success!!")
                         .setAutoCancel(true)
                         .setSmallIcon(R.drawable.ic_launcher); //<--- this one 
```

# t4 - 关于 T4 模板的学术疑问

> ID：11371641
> 
> 赞同：1
> 
> 时间：2012-07-07T01:47:25.117
> 
> 标签：t4

好的，我在我目前的项目中想得有点早，所以我为这个问题的含糊程度深表歉意。是否有可能在解决方案的一个项目中拥有一个 T4 模板，该模板引用解决方案中的其他程序集之一并检查其他程序集的导出类型并使用它们的元数据来构建其他代码？我不需要引用该程序集目录中的类型，我只需要能够获取从特定基类派生的所有类型的列表以及有关它们的一些元数据。我正在考虑专门针对从公共基类构建并由 NHibernate 转储到数据库的某些对象执行此操作，作为一种从它们生成 DTO 类以便在 AJAX 调用期间向客户端抛出的简单方法。我不是在寻找一个绝对完美的解决方案，

同样，我真的没有具体的例子。我距离正面遇到这个问题还有几天的时间，但我突然想到这个选项可能涵盖了我可能遇到的很多情况。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T07:26:47.047

是的，这应该没问题 - 您可以使用 <#@ assembly #> 指令，也可以使用 $(SolutionDir) 和其他 VS 宏来获取导航到其他项目输出的起点。然后你可以使用反射来读取你感兴趣的元数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T13:07:08.400

我试图实现类似的东西，它工作正常。在下面的示例`.tt`文件中，我所指的同一解决方案中我自己的程序集的名称是`SomeLibrary`. 我正在反思的类是一个名为`SomeLibrary.SomeInterface`. 有一些方法可以使它更通用，但我不想让示例过于复杂。另外，请不要关注此模板的整体效果，这只是为了让您对它的工作方式有一个印象：

```
<#@ template language="C#" #>
<#@ output extension=".cs" #>
<#@ assembly name="$(SolutionDir)$(SolutionName)\bin\$(ConfigurationName)\$(SolutionName).dll" #>
<#@ import namespace="System.Reflection" #>
<#
    Type someIType = typeof(SomeLibrary.SomeInterface);
#>
namespace SomeLibrary
{
    class <#=someIType.Name#>Impl: <#=someIType.Name#>
    {
        <#=someIType.Name#> encapsulatedIntf;
        public <#=someIType.Name#>Impl(<#=someIType.Name#> anIntf)
        {
            encapsulatedIntf = anIntf;
        }

        // Methods to be implemented:
<#
    MethodInfo[] methods = someIType.GetMethods();
    foreach (MethodInfo m in methods)
    {
#>
        // <#=m#>;
<#
    }
#>
    }
} 
```

就我而言，这会导致

```
namespace SomeLibrary
{
    class SomeInterfaceImpl: SomeInterface
    {
        SomeInterface encapsulatedIntf;
        public SomeInterfaceImpl(SomeInterface anIntf)
        {
            encapsulatedIntf = anIntf;
        }

        // Methods to be implemented:
        // Int32 someMethod(Int32);
        // System.String someOtherMethod();
    }
} 
```

# sql - 带有两组括号而不是一组括号的默认值

> ID：11371645
> 
> 赞同：8
> 
> 时间：2012-07-07T01:47:58.710
> 
> 标签：sql, sql-server, tsql

假设我有一个`int`字段，我将默认值设置为`(0)`，这是可行的，但我见过有人这样做`((0))`，为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T03:24:59.933

`((0))`是它在目录视图中的显示方式，或者如果您在 SSMS 中生成脚本。所以我认为当你看到它很可能是一个生成的脚本而不是从头开始手写的时候。

也就是说，之间没有什么不同`(0)`，`((0))`甚至`(((((((((((((0)))))))))))))`......假设我数对了，额外的括号不会改变意思，只是可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-01T03:41:36.660

您也可以简单地使用

```
0 
```

即，根据 SQL 服务器文档，根本没有括号。见 [https://stackoverflow.com/a/56823899/661584](https://stackoverflow.com/a/56823899/661584)

# magento - Magento - Mage::getModel 在 Linux 服务器上不起作用

> ID：11371646
> 
> 赞同：4
> 
> 时间：2012-07-07T01:49:21.750
> 
> 标签：magento, module

我正在努力解决一个我找不到解释的问题。我有两个用于我的项目的开发环境。我为 Magento 创建了一个简单的模块，并在一个环境中对其进行了测试。在克服了 Magento 的所有复杂问题后，该模块按预期工作。这是在 XAMPP 上。

然后，我将该模块复制到托管服务器上的开发 Linux 环境中，它惨遭崩溃。我做了一些调试，发现调用 Mage::getModel() 返回*bool(false)*而不是我请求的模型实例。

我仔细检查了所有文件和目录，它们匹配。不涉及数据库（至少从我这边，我不需要表）并且两个环境都只有我作为用户，具有管理员权限。

欢迎任何关于我应该从哪里开始寻找的建议，谢谢。

**添加于 2012/07/09**
模型包含一个名为 的类`Diego_ClientCustomModule_Model_ExternalUserData`，使用`$model = Mage::getModel('clientcustommodule/externaluserdata');`. 模型文件位于`Diego_ClientCustomModule\code\local\Diego\ClientCustomModule\Model\`. 奇怪的是：

*   如果模型文件命名为`Externaluserdata.php`，它可以工作。
*   如果模型文件被命名`ExternalUserData.php`（即它与类名匹配），它就不起作用。

我知道区分大小写的东西等，但是，如果别名都是小写的，它怎么能加载第一个字母大写的文件？

**配置文件** 0.1.0 Diego_ClientCustomModule_Helper Diego_ClientCustomModule_Model Diego_ClientCustomModule_Block 标准 Diego_ClientCustomModule ClientCustomModule

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T02:48:16.577

对你寻求帮助的框架嗤之以鼻可能不是获得帮助的最佳策略。

您的问题可能是缓存之一（删除 var/cache 文件夹以检查）或不正确的大小写之一。请注意每个目录的首字母和自动加载器加载的文件（块、模型和帮助程序）的文件名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T10:24:10.250

似乎我找到了问题的根本原因，尽管我无法弄清楚实现了什么样的逻辑来实现它。

模型的文件名为***UserCustomModule.php***，它反映了类名***UserCustomModule***。这是有道理的，并且在 XAMPP 中工作得非常好。一旦我在 Linux 机器上安装了相同的模块，Magento 就会默默地忽略该文件，并且如前所述，没有办法追踪 Magento 的行为。

根据 benmark 的建议，我再次检查了所有文件以检查外壳，一切似乎都匹配。然后，在我看来，我做了一些完全愚蠢的事情，并将模型文件重命名为***Usercustommodule.php***，保持类名不变（毕竟，与文件系统不同，PHP 在两个平台上的行为应该相同）。神奇的是，该模块现在可以工作了！文件名看起来 cr*p，但它可以工作。

这解决了问题，但它提出了更多问题：

*   由于什么原因 Magento 无法加载带有 CamelCase 名称的文件？如果是自动加载，它应该简单地找到一个文件并加载它。毕竟，它加载了Controller、Block和其他所有东西，而且它们都**在**CamelCase中。
*   它是否写在一个或多个文件必须只有第一个字母大写的地方？我已经得到了足够多的惊喜，如果可能的话，我想避免新的惊喜。

再次感谢您的帮助。

# python - 一个简单的 webkit 窗口，仅限于一个 URL

> ID：11371651
> 
> 赞同：0
> 
> 时间：2012-07-07T01:50:35.480
> 
> 标签：python, webkit, gtk

我想创建一个 python 脚本来运行一个 Gtk 窗口，其中一个 WebKit 会话仅限于一个 URL。即像[Fluid](http://fluidapp.com/)或旧的 Mozilla Prism 之类的东西。另外，我需要对 cookie 和 https 的支持。

像[这个答案](https://stackoverflow.com/a/647121/860789)这样的东西是完美的，但我需要阻止对与原始 URL 不同的其他 URL 的访问。

我在问一个 python 示例，但其他语言的示例也很有用，或者与 Gtk 不同的其他工具包的示例。

PD：我不知道标题是否适合我的问题，所以请随意增强这个:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T21:21:58.720

如果 URL 不是您希望允许的，则连接到`WebView`'[`navigation-policy-decision-requested`](http://webkitgtk.org/reference/webkitgtk/stable/webkitgtk-webkitwebview.html#WebKitWebView-navigation-policy-decision-requested)信号并调用。`policy_decision.ignore()`

# jquery - jQuery：动画 backgroundPosition 在 IE < 9 中表现异常

> ID：11371654
> 
> 赞同：0
> 
> 时间：2012-07-07T01:50:52.253
> 
> 标签：jquery, internet-explorer, jquery-animate

尝试将鼠标悬停在 Internet Explorer 8 中的“取消”按钮上：

[http://jsfiddle.net/HYDKa/](http://jsfiddle.net/HYDKa/)

您会注意到，当您第一次将鼠标悬停在它上面时，它会跳跃并且您可以看到“确定”按钮，但随后它会自行纠正。不过，随后的悬停功能正常。

请注意，“确定”按钮也会出现此错误；“取消”按钮更明显。此外，这个错误存在于 IE 6 和 7 中，但我提供的演示无法工作，因为图像是 Base64 编码的。

当然，该代码在非 IE 浏览器中运行良好。

这是一个 jQuery 错误吗？除了拆分图像之外，我还能做些什么来解决它？我可以包含一个 IE < 9 的样式表，但如果我不需要的话，我宁愿不要。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T16:22:46.427

阅读完[这篇](https://stackoverflow.com/questions/7719214/jquery-animate-background-position/8026020#8026020)文章后，我最终通过将“backgroundPosition”更改为“background-position-x”来解决我的问题。此外，由于某些浏览器不支持“background-position-x”，我创建了 CSS3 转换来做同样的事情，然后将 JavaScript 代码包装在 if 语句中，以便它仅在浏览器不支持 CSS3 转换时运行. 我没有在我的网站上的其他任何地方使用特征检测，也不想为这么简单的事情打扰 Modernizr，所以我使用了[这里](http://tobint.com/blog/detecting-css3-transition-support/)显示的功能。我应该注意的另一件事是，我根本不需要打扰“sliding_link_original_background_position”变量。

我感谢 barlasapaydin 的时间以及其他阅读本文的人的时间。谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T02:22:16.773

旧的 Internet Explorer 版本不接受没有 'px' 的 CSS 值。示例=宽度：10px；

所以你需要在动画值的末尾添加 + 'px' 。

[这是工作的jsfiddle](http://jsfiddle.net/HYDKa/2/)

```
 $(this).find('.sliding_link_image').animate({
        'backgroundPosition': (sliding_link_original_background_position + 10) + 'px'//<--here
    }, 150);
}, function() {
    $(this).find('.sliding_link_image').animate({
        'backgroundPosition': sliding_link_original_background_position + 'px'//<--and here
    }, 150); 
```

# sql - 限制 SQL Server 2008 中的查询返回数

> ID：11371655
> 
> 赞同：0
> 
> 时间：2012-07-07T01:51:31.223
> 
> 标签：sql, sql-server-2008

这是我的查询

```
SELECT Fullname, rank, id_no, TIN, birthdate, 
hair, eyes, Blood, height, weight, marks, name, address
FROM  [******_DOMAIN\****_*****].*******view 
```

问题是，源表有太多重复，我如何限制查询到数据库上的最新行？

我正在使用 SQL Server 2008。

提前致谢

我的下一个问题是视图向我显示了一个`birthdate`字符串格式`yyyymmdd`，我需要将其更改为`mm/dd/yyyy`可以请提供我一个函数吗？使用上面相同的字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T01:57:19.280

对于重复项，您可以使用 限制记录`SELECT DISTINCT`，并且要仅检索一定数量的记录，您可以使用`SELECT TOP #`其中 # 是记录数量。至于最新记录 - 我不确定它是否可以完成，除非您在插入时间的记录上有一个日期字段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T02:11:44.993

用于`TOP`限制记录并`ORDER BY`根据所需列对记录进行排序。

例子。

```
SELECT    TOP 5 Fullname, rank, id_no, 
          TIN, birthdate, hair, eyes, 
          Blood, height, weight, marks, name, address 
FROM      viewName
ORDER BY  yourDesiredClumn desc 
```

这将只显示 5 条记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T01:57:32.713

用这个：

选择 TOP(#) Fullname, rank, id_no, TIN,birthdate, hair, eyes, ....

# sql - 按连接列排序，但在另一个上使用 distinct

> ID：11371656
> 
> 赞同：1
> 
> 时间：2012-07-07T01:51:42.847
> 
> 标签：sql, postgresql, join

我正在构建一个系统，其中有以下表格：

*   歌曲
*   播送
*   车站
*   跟随
*   用户

用户关注电台，这些电台通过广播播放歌曲。

我正在根据用户关注的电台为用户构建歌曲“提要”。

这是查询：

```
SELECT DISTINCT ON ("broadcasts"."created_at", "songs"."id") songs.*
FROM "songs"
INNER JOIN "broadcasts" ON "songs"."shared_id" = "broadcasts"."song_id"
INNER JOIN "stations" ON "broadcasts"."station_id" = "stations"."id"
INNER JOIN "follows" ON "stations"."id" = "follows"."station_id"
WHERE "follows"."user_id" = 2
ORDER BY broadcasts.created_at desc
LIMIT 18 
```

![sql在加入时无法正常工作](../Images/1dcea01eb9a2f3c4693cd7620060e728.png)

注意：shared_id 与 id 相同。

如您所见，我得到了重复的结果，这是我不想要的。我从[上一个问题](https://stackoverflow.com/questions/11370422/postgres-selecting-distinct-on-a-column-is-not-returning-distinct-results-with)中发现，这是由于在 broadcasts.created_at 上选择了 distinct。

我的问题是：如何修改此查询，使其仅根据其 id 返回唯一歌曲，**但仍按 broadcasts.created_at 排序**？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T02:57:04.683

如果您想要更清晰的查询（嵌套查询使事情更难阅读），您可以使用[公用表表达式 (CTE )](http://www.postgresql.org/docs/9.1/static/queries-with.html)

我看起来像这样：

```
WITH a as (
        SELECT bb.song_id, MAX(bb.created_at) AS maxcreated
        FROM follows aa
        INNER JOIN broadcasts bb ON aa.station_id = bb.station_id
        INNER JOIN songs cc ON bb.song_id = cc.shared_id
        WHERE aa.user_id = 2
        GROUP BY bb.song_id
    )
SELECT
    a.maxcreated,
    b.*
FROM a INNER JOIN
    songs b ON a.song_id = b.id
ORDER BY
    a.maxcreated DESC
LIMIT 18 
```

使用 CTE 具有提高可读性和易于维护复杂查询的优点。查询可以分为单独的、简单的、逻辑的构建块。然后可以使用这些简单的块来构建更复杂的临时 CTE，直到生成最终结果集。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T02:35:41.803

试试这个解决方案：

```
SELECT a.maxcreated, b.*
FROM
    (
        SELECT bb.song_id, MAX(bb.created_at) AS maxcreated
        FROM follows aa
        INNER JOIN broadcasts bb ON aa.station_id = bb.station_id
        WHERE aa.user_id = 2
        GROUP BY bb.song_id
    ) a
INNER JOIN songs b ON a.song_id = b.id
ORDER BY a.maxcreated DESC
LIMIT 18 
```

`FROM`子选择检索`song_id`用户关注的所有电台广播的不同 s ；它还获取与每首歌曲相关的最新广播日期。我们必须将它封装在子查询中，因为我们必须`GROUP BY`在我们从中选择的列上，并且我们只想要唯一`song_id`和 maxdate 而不管站。

然后，我们将外部查询中的结果连接到`songs`表中，以获取与每个唯一相关联的歌曲信息`song_id`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T02:01:27.783

尝试添加`GROUP BY Songs.id`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-06T11:17:00.097

我在 之间有一个非常相似的查询`listens`，我花了很长时间才弄清楚（几个小时）。`tracks``albums`

如果您使用 a `GROUP_BY songs.id`，您可以通过 order by 使其工作`MAX(broadcasts.created_at) DESC`。

完整的 SQL 如下所示：

```
SELECT songs.* FROM "songs"
INNER JOIN "broadcasts" ON "songs"."shared_id" = "broadcasts"."song_id"
INNER JOIN "stations" ON "broadcasts"."station_id" = "stations"."id"
INNER JOIN "follows" ON "stations"."id" = "follows"."station_id"
WHERE "follows"."user_id" = 2
GROUP BY songs.id
ORDER BY MAX(broadcasts.created_at) desc
LIMIT 18; 
```

# android - Android 中的 MobFox - MobFoxView 无法实例化

> ID：11371657
> 
> 赞同：0
> 
> 时间：2012-07-07T01:51:43.393
> 
> 标签：android

我在 Android 上使用 MobFox。我的一个布局中有一个 MobFoxView。当我为 4.0.3 编译 Android 时运行良好。但是，我想尝试为 2.0.1 构建它，但现在它不起作用。

在可视化编辑器上，我收到以下错误：

```
The following classes could not be instantiated:
-  (Open Class, Show Error Log)
See the Error Log (Window > Show View) for more details.
Tip: Use View.isInEditMode() in your custom views to skip code when shown in Eclipse 
```

在错误日志中，我看到：

```
com.mobfox.sdk.MobFoxView failed to instantiate.

java.lang.NullPointerException
at com.mobfox.sdk.MobFoxView.<init>(MobFoxView.java:189)
at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27) 
```

我的 MobFox 视图代码是：

```
<com.mobfox.sdk.MobFoxView
            android:id="@+id/mobFoxView"
            android:layout_width="fill_parent"
            android:layout_height="50dp"
            mode="live"
            publisherId="..." /> 
```

我正在通过 .jar 文件导入 MobFox 库。为 Android 4.0.3 编译时运行良好。

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T09:28:40.913

结果是完全不相关的：在布局中，我在“match_parent”中有两个属性，Android 4 支持但不支持 2。将它们更改为“fill_parent”允许 gen 文件夹中的文件再次正常生成，一切在职的。

毕竟不是 MobFox 的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T03:20:37.390

您的最低构建版本应该是用于构建 MobFox 的版本，但如果没有注册，我无法在他们的网站上看到它。将目标版本（通过 project>properties 或`project.properties`）设置为`android-15`（或其他），但`Android-Manifest.xml`将 min sdk 指定为 6（或其他）并将目标 sdk 指定为 15（再次，无论如何）。您需要小心地将自己限制在最低版本的 Android 功能中。

假设这可行并且 MobFox 可以在您的较低版本的 Android 中使用，您可以降低构建 API 级别并重新测试直到它失败，但实际上（IMO）如果您想成为未来的证明，您应该保持较高的构建 API 级别并进行测试反对最低限度。

请注意，`API 6`（2.0.1）已被标记为过时，您最好定位到`API 4`（android 1.6）或`API 7`（2.2）

# sql - SQL查询打印镜像标签

> ID：11371658
> 
> 赞同：0
> 
> 时间：2012-07-07T01:51:43.953
> 
> 标签：sql, ms-access

我想用 SQL 查询返回的单词打印标签，例如如下。

```
1 2 3
4 5 6 
```

当我想打印这些标签的反面时，我必须按如下方式打印它们

```
3 2 1
6 5 4 
```

在我的真实案例中，我有 2 行 5 列，我如何制定我的查询，以便我的记录像第二个一样排序。正常的排序是由单词处理的，所以我的查询就像

`SELECT * FROM Products ORDER BY Products.id`

我正在使用 MS Access =(

编辑 ：

只是为了说清楚

我希望订购我的记录，例如

```
3 2 1 6 5 4 9 8 7 12 11 10 
```

编辑2：

我的桌子看起来像这样

```
ID    ProductName
1     Product1
2     Product2
3     Product3
n     Product[n] 
```

如上所述，我希望返回 ID

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T02:39:23.777

```
SELECT * FROM Products ORDER BY Products.id desc 
```

或者，如果您目前的查询确实给了您以下信息：

```
select col1, col2, col3 from products order by products.id; 
```

为什么不使用

```
select col3, col2, col1 from products order by products.id; 
```

# vim - 为什么vim在文件加载和保存时同步？

> ID：11371659
> 
> 赞同：2
> 
> 时间：2012-07-07T01:52:12.140
> 
> 标签：vim, sshfs

我正在通过具有非常高延迟的 sshfs 挂载文件系统使用 vim。打开和保存文件大约需要 9 秒才能阻止编辑器。

有没有一种方法可以让我在保存和加载文件时只能阻止我所在的选项卡并仍然使用其他选项卡？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T06:10:58.633

写入是一个阻塞操作，因为 Vim 是单线程的：你不能同时做两件事。

AFAIK 当 Vim 在本地写入文件时，SSHFS 在“通知”Vim 完成之前将其上传到远程服务器。整个过程显然可以而且确实需要相当长的时间。

有更好的方法：例如 VCS（Git、SVN、Mercurial...）或具有文件夹监控功能的 FTP 客户端（Transmit、Yummy FTP、Fetch...）。

# css - 基于 SMACSS 的 CSS 框架

> ID：11371661
> 
> 赞同：10
> 
> 时间：2012-07-07T01:52:24.017
> 
> 标签：css, frameworks

SMACSS 框架引入了一种一致的方式来管理您的 CSS 代码，以便它可重用和可维护，但它更多的是如何组织您的 CSS 的指南，而不是一个实际的框架。如果有任何其他基于其哲学的框架会很好，但我还没有遇到过。

有谁知道任何基于 SMACSS 组织 CSS 代码方法的 CSS 框架？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-28T15:30:09.933

[Pure](http://purecss.io)是基于 SMACSS 的较新的 CSS 框架。它似乎与 YUI 项目有关。

从他们的[扩展页面](http://purecss.io/extend/)...

> **基于 SMACSS**
> 
> Pure 被分解为一组响应式模块。从一开始，我们就采用 SMACSS 作为编写 CSS 的约定。对于那些刚接触 SMACSS 的人，你应该快速阅读它，尤其是关于模块规则的部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T05:42:06.220

由于没有答案从媒体上飞下来，我很好奇并环顾四周。

事实证明有[很多](https://www.google.com/#hl=en&rlz=1C2ASUT_enUS444US460&sclient=psy-ab&q=organize+css&oq=organize+css&gs_l=serp.3..0l4.4821.8867.0.8988.21.12.0.0.0.0.371.371.3-1.1.0...0.0.6zmK-_Cv2FU&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.,cf.osb&fp=b4c92a2d29177826&biw=1366&bih=635)，[我看你已经有一段时间了](https://stackoverflow.com/questions/10038080/structured-way-to-organize-css-code)。

[我看到其他人推荐 LESS 或 SASS](http://railslove.com/blog/2012/03/28/smacss-and-sass-the-future-of-stylesheets/)，我会补充一下 Compass 和 Susy 之类的解决方案。这些只是需要研究的东西，因为它们每个都有固有的组织模式。

但这是我的实际答案。

我在寻找 CSS 框架方面也有类似的努力，这些框架将响应式 Web 设计的最终解决方案组织成最佳实践、命名约定和其他模式。[所以这就是我所看到的](http://speckyboy.com/2011/11/17/15-responsive-css-frameworks-worth-considering/)，一个等效的开放式问题，处于死胡同。

我认为问题可能在于 CSS 组织高度依赖于环境和上下文。[所以，也许设计模式是一个好方法](https://www.google.com/#hl=en&rlz=1C2ASUT_enUS444US460&sclient=psy-ab&q=css+design+patterns&oq=css+design+patterns&gs_l=serp.3...20726.21741.1.22019.7.6.0.0.0.0.0.0..0.0...0.0.oMJTZFPDsvc&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.,cf.osb&fp=b4c92a2d29177826&biw=1366&bih=635)。

所以这是我的解决方案，我会在这里提出建议 -> 我真的很喜欢你关于将 css 分为：基础、布局、字体、元素的评论。在某些情况下，这可以使其他人受益。

*如果您找不到适合您环境的组织方法，请尝试和设计您需要的东西，然后命名并与世界分享。*

这对您是多方面的好处，因为：您学习如何解决您的问题，这对您作为高级开发人员来说很好。

一种方法是在 wordpress 博客、网站示例页面或 github 存储库中共享解决方案。

如果它是真实且有益的，请命名、构建并分享它。只有好事才会发生。

祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-14T10:51:45.570

我不知道 Bootstrap 是*基于*SMACSS 的，但是 Jonathan Snook（SMACSS 创始人）有以下说法：

> “如果您想知道 SMACSS 的示例实现可能是什么样子？Bootstrap 就是一个完美的示例。”

[引导程序中的前缀类](http://snook.ca/archives/html_and_css/prefixed-classes-bootstrap)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-14T01:48:29.333

如果您使用术语 SMACSS 作为[**OOCSS**](https://www.smashingmagazine.com/2011/12/an-introduction-to-object-oriented-css-oocss/)或[**Atomic design**](http://bradfrost.com/blog/post/atomic-web-design/)的同义词，请考虑以下框架：

*   [**级联框架**](http://jslegers.github.io/cascadeframework/)
*   [**鳞片**](https://github.com/chris-pearce/scally)
*   [**因纽特人CSS**](https://github.com/inuitcss)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-04T08:13:43.580

SMACSS 是编写 CSS 的约定。所以框架本身是否遵循这个约定并不重要。在使用任何框架时，您都是应该遵循 SMACSS 的人。

例如，有人为愿意将 LESS 与 SMACSS 一起使用的任何人制作了一些带有注释的 .LESS 文件：[https ://github.com/growdigital/LESS-SMACSS](https://github.com/growdigital/LESS-SMACSS)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-19T13:53:35.347

你应该试试**Helpers CSS**：[http ://helpers.araujo.cc/](http://helpers.araujo.cc/)

非常容易学习和理解。

```
<p text="gray-80 normal center">
 <span text="bold big line-1 red">
    Can you
  </span> feel the
  <span text="underline italic blue semi-bold">
    future
  </span>? HTML6
  <span text="pre white-80 line-1.5" layout="navy few-rounded inline-block">  advantages  </span>
   are expecting for
   <span text="bolder">you</span>!
</p> 
```

# arrays - 将范围添加到下拉菜单数组中的每个选项而不是单个值？

> ID：11371663
> 
> 赞同：2
> 
> 时间：2012-07-07T01:52:52.670
> 
> 标签：arrays, drupal, range

编辑：

我的原始帖子包含在问题的底部，但非常模糊，因此我正在尝试对其进行更新以使自己更加清楚。我的网站有一个部分，用户可以在其中提交对企业的评论。在一个这样的字段中，他们选择是否有条形标签。他们可以选择无、饮料、食物和两者。当他们提交他们的选项时，它作为浮点值存储在数据库中，无存储为 0，饮料存储为 1，食物存储为 2，两者都存储为 3。然后我将所有这些值平均到一个字段中以显示商家的页面。因此，如果一家企业的酒吧选项卡的平均值为 0.5，则它显示为“无”，值为 1.2 的“饮料”等。

然后我有一个显示所有业务页面的预告片的视图，用户可以通过业务页面上的字段结果过滤结果。我想要一个下拉菜单来显示过滤器的选项，但我不确定如何为数组中的每个值而不是单个值分配范围。这是我目前拥有的：

```
$options = array(
    '' => 'Any',
    '0' => 'None',
    '1' => 'Drinks',
    '2' => 'Food',
    '3' => 'Both',
    ); 
```

如您所见，如果用户在过滤器中选择“饮品”作为选项，则只会显示浮动字段中值为 1 的页面。但是，就用户而言，他们对“饮品”的选择应该过滤所有具有“饮品”值或浮点值的页面 `>.75 && <=1.5`。我需要数组中的选项来反映这一点。所以，虽然下面的代码不正确，但我想要一些效果：

```
$options = array(
    '' => 'Any',
    '>=0 && <=0.75' => 'None',
    '>0.75 && <=1.5' => 'Drinks',
    '>1.5 && <=2.25' => 'Food',
    '>2.25 && <=3' => 'Both',
    ); 
```

有人知道该怎么做吗？我希望这比我原来的帖子更清楚。

原来的：

我前段时间在drupal论坛上问过这个问题，但我没有得到任何回复，所以我希望这里有人可以帮助我。我在选择数组的模块中有以下代码。

```
$options = array(
    '' => 'Any',
    '0' => 'None',
    '1' => 'Drinks',
    '2' => 'Food',
    '3' => 'Both',
    ); 
```

但是，问题在于每个选项仅与单个值相关。有没有办法为每个选项分配一个范围？结果将是 0 和 1 之间的任何值都分配给 None，1 和 2 之间的任何值都分配给 Drinks 等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T05:19:18.300

根据我们上面的对话，如果数组键确实被编码为表单字段的 value="" 并因此传递到后续页面，我的建议是：

将您的实现移至处理请求，而不是生成表单。我不熟悉 Drupal 开发（无论如何不是在过去 2 年），但我想您在后续请求中有挂钩，您可以在其中修改提交的值，然后再被选择查询的框架拾取。

需要注意的一点：另一方面，您可能无法简单地使用这样的字符串，因为 Drupal 很可能会转义这些值，将它们放在引号中，并使用 = 比较运算符。您可能需要查看 Drupal 文档，了解如何在选择时指定表达式。

# javascript - 将附加参数传递给 Javascript 回调函数

> ID：11371673
> 
> 赞同：11
> 
> 时间：2012-07-07T01:57:02.933
> 
> 标签：javascript, node.js, callback

我需要查看 Node.JS 应用程序中的少量目录：

```
function updated(event, filename){
    log("CHANGED\t/share/channels/" + filename);
}
for(i in channels)
    fs.watch('share/channels/' + channels[i], {persistent: false}, updated); 
```

问题是 fs.watch 只将文件名传递给回调函数，而不包括它所在的目录。有没有办法我可以以某种方式将一个额外的参数传递给 updated() 函数，以便它知道文件在哪里？

我想我正在寻找类似于 Python 的东西`functools.partial`，如果有帮助的话。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-01-24T00:04:44.947

# 使用 JS 绑定的示例

文档：[https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind)

提示，绑定参数出现在调用时参数之前。

```
my_hello = 'Hello!'
my_world = {
    'antartica': 'cold',
}

anonymous_callback = function (injected1, injected2, param1, param2) {
    param1 = param1 ? param1 : 'One';
    param2 = param2 ? param2 : 'Two';

    console.log('param1: (' + typeof(param1) + ') ' + param1)
    console.log('param2: (' + typeof(param2) + ') ' + param2)

    console.log('injected1: (' + typeof(injected1) + ') ' + injected1)
    console.log('injected2: (' + typeof(injected2) + ') ' + injected2)
    console.log(injected2)
}.bind(this, my_hello, my_world)

anonymous_callback('Param 1', 'Param 2') 
```

输出：

```
param1: (string) Param 1
param2: (string) Param 2
injected1: (string) Hello!
injected2: (object) [object Object]
{ antartica: 'cold' } 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-07T02:21:58.510

您可以为每次迭代传递不同的函数：

```
var getUpdatedFunction = function(folderName) {
    return function(event, filename) {
        log("CHANGED\t" + folderName + "/" + filename);
    };
};

for(i in channels) {
    foldername = 'share/channels/' + channels[i];
    fs.watch(foldername, {persistent: false}, getUpdatedFunction(foldername));
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-07T02:11:25.533

您可以使用[`Function.bind`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind)：

```
function updated(extraInformation, event, filename) {
    log("CHANGED\t/share/channels/" + extraInformation + filename);
}

for(i in channels)
    fs.watch('share/channels/' + channels[i], {persistent: false},
              updated.bind(null, 'wherever/it/is/')); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-19T12:52:03.233

您可以就地传递额外的回调

```
function updated(channel, filename) {
  log('CHANGED\t ' + channel + '/' + filename);
}

for(i in channels) {
  channel = '/share/channels/' + channels[i];
  fs.watch(channel, {persistent: false}, function (extra, event, filename) {
    updated(channel, filename);
  });
} 
```

# javascript - 对 chrome 和 firefox 使用相同的代码，但得到不同的结果

> ID：11371674
> 
> 赞同：0
> 
> 时间：2012-07-07T01:57:07.333
> 
> 标签：javascript

我有一个简单的倒计时脚本。该代码适用于chrome，但不适用于firefox。在 Firefox 中它显示 NaN 但 chrome 显示倒计时任何想法为什么会发生这种情况？

```
function CountDownTimer(time, name) {
  var counter = setInterval(function(){
    var today = new Date();
    var expire = new Date(time);
    var timeRemains = expire - today;

    var days  = Math.floor(timeRemains / (1000 * 60 * 60 * 24));
    var hours = Math.floor(timeRemains / (1000 * 60 * 60));
    var mins  = Math.floor(timeRemains / (1000 * 60));
    var secs  = Math.floor(timeRemains / 1000);

    var dd = days;
    var hh = hours - days  * 24;
    var mm = mins  - hours * 60;
    var ss = secs  - mins  * 60;

    if (expire < today) {
      clearInterval(counter);
      document.getElementById(name).innerHTML = '<span class="expire">expire!</span>';
      return;
    } else {
         if (dd < 10) {
             dd = "0" + dd;
         }
         if (hh < 10) {
             hh = "0" + hh;
         }
         if (mm < 10) {
             mm = "0" + mm;
         }
         if (ss < 10) {
             ss = "0" + ss;
         }
         document.getElementById(name).innerHTML = dd + ' : ' + hh + ' : ' + mm + ' : ' + ss;
    }
  }, 1000 );
}

CountDownTimer("2012-07-06 19:00:00", "Time1");​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T02:06:51.027

更改日期格式，如下所示：

```
CountDownTimer("June 7, 2012 19:00:00", "Time1");​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T02:09:43.647

Date() 函数似乎不适用于所有浏览器。尝试在其上使用 setUTC 函数，如下所示：

```
today.setUTCFullYear(2012);
today.setUTCHours(19, 0, 0, 0); 
```

更新： Date() 构造函数在所有浏览器上都很好，只是在使用“不正确”字符串时不行。试试这个：

```
var today = new Date(2012,6,7,19,0,0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T02:10:36.603

`NaN`代表不是一个数字。

如果 Leo 的建议没有帮助，可能值得添加一些零星`console.log()`的 ' 来找出问题所在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T02:30:45.193

问题在于新的 Date() 格式，该格式在浏览器中不一致。

[Problem with date formats in JavaScript with different browsers](https://stackoverflow.com/questions/3566125/problem-with-date-formats-in-javascript-with-different-browsers).

You can likely make it work by converting the - chars to /. Cameron's answer should provide good cross-browser behaviour, otherwise consider using a 3rd party library such as moment.js

[https://stackoverflow.com/questions/802861/javascript-date-manipulation-library](https://stackoverflow.com/questions/802861/javascript-date-manipulation-library)

# vba - VBA 宏——超链接

> ID：11371679
> 
> 赞同：1
> 
> 时间：2012-07-07T01:58:18.843
> 
> 标签：vba, excel

我想创建一个 VBA 宏，它允许我编辑列中所有选定的超链接，并将“要显示的文本”更改为所有的同一个词。例如，如果这是列：

```
www.google.com/search=cars
www.google.com/search=houses
www.google.com/search=cities 
```

我想突出显示该列的这三个元素并将要显示的文本更改为“Google 搜索”，以便结果如下：

```
Google Search
Google Search
Google Search 
```

[编辑：所以我在微软支持网站](http://support.microsoft.com/kb/247507)上找到了一个类似于我想要做的宏，但我的问题是这个宏针对工作表中的所有超链接，而我想选择一个特定的列来编辑超链接。

```
Sub HyperLinkChange()
   Dim oldtext As String
   Dim newtext As String
   Dim h As Hyperlink `oldtext = "http://www.microsoft.com/" 
 newtext = "http://www.msn.com/" 

   For Each h In ActiveSheet.Hyperlinks
   x = InStr(1, h.Address, oldtext)
   If x > 0 Then
       If h.TextToDisplay = h.Address Then
            h.TextToDisplay = newtext
       End If
       h.Address = Application.WorksheetFunction. _
       Substitute(h.Address, oldtext, newtext)
   End If
   Next End Sub` 

            回答 #1

赞同：1

时间：2012-07-07T02:47:37.047

这适用于当前选择：

```
Sub SetLinkText()

Dim LinkText As String
Dim h As Hyperlink

    LinkText = InputBox("Enter link text")

    If LinkText = "" Then Exit Sub

    For Each h In Selection.Hyperlinks
        h.TextToDisplay = LinkText
    Next

End Sub 
```

```

# google-apps-script - 删除站点中的项目

> ID：11371681
> 
> 赞同：0
> 
> 时间：2012-07-07T01:58:54.383
> 
> 标签：google-apps-script

有谁知道如何删除站点中的项目（脚本）？

我制作了一个新脚本并从另一个项目复制了一个代码以更改脚本的所有者，但无法删除我不再使用的项目。文件菜单中没有删除。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T07:08:54.927

转到您的站点，转到“管理站点”，打开要删除的脚本项目![在此处输入图像描述](../Images/f204ce1c7ca7b39f206958a4153c2e72.png)

在**脚本内的文件菜单中**选择“删除”

![在此处输入图像描述](../Images/b15b907984e464da6f676ef46d6e4bc2.png)

# html - 如何转义 HTML 序列，以便它可以进入标签标题属性？

> ID：11371682
> 
> 赞同：0
> 
> 时间：2012-07-07T01:59:17.237
> 
> 标签：html, escaping, tooltip

我已经为此工作太久了。我正在尝试将 HTML 放入`title`标签的属性中。这是一个工具提示。当然，如果这是可能的，那么我必须转义所有必要的字符，这样它就不会搞砸包含它的标签。具体来说，如何在标签的 title 属性中放置以下内容：

```
<a href="test">test</a> 
```

也就是说，我想要这个：

```
<div title="<a href="test">test</a>">my div</div> 
```

我觉得我什么都试过了。这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T02:02:43.010

如果您使用的是 jquery，您可以这样做

```
$('div').attr('title','<a href="test">test</a>'); 
```

如果你想转义 html 标签，那么你可以这样做

如果您的测试在这样的 div 中

```
<div id="tag"><a href="test">test</a></div> 
```

那么你可以做`$('div').attr('title', $("#tag").text());`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T02:03:28.830

我用谷歌搜索了 HTML Escape Characters 并找到了一个工具：[http](http://accessify.com/tools-and-wizards/developer-tools/quick-escape/default.php) ://accessify.com/tools-and-wizards/developer-tools/quick-escape/default.php 它产生了这个字符串，你可以使用它：

```
&lt;a href=&quot;test&quot;&gt;test&lt;/a&gt; 
```

# php - 使用 PHP move_uploaded_file 函数权限被拒绝

> ID：11371685
> 
> 赞同：0
> 
> 时间：2012-07-07T01:59:45.193
> 
> 标签：php, permissions, chmod

当我将文件上传到服务器时遇到此错误时，我已经被此代码困住了好几天。它是在 Apache 上运行的 Windows 服务器

尝试了各种解决方案，但仍然收到错误。我尝试将完全权限更改为该服务器上的每个人。

我将默认的 PHP 上传 tmp 文件更改为我的应用程序内部，但我仍然遇到此错误。

警告：move_uploaded_file(C:\My_Workspace\ojs2002) [function.move-uploaded-file]：未能打开流：C:\My_Workspace\ojs\admin\include\fileupload.php 中的权限被拒绝，第 78 行

警告：move_uploaded_file() [function.move-uploaded-file]：无法将 'C:\My_Workspace\ojs\tmp\phpCB78.tmp' 移动到 C:\My_Workspace\ojs\admin 中的 'C:\My_Workspace\ojs2002' \include\fileupload.php 在第 78 行

```
 // copy the file, making the destination directory if necessary
 $filedir = 'C:/My_Workspace/ojs2002/'.basename($_FILES['articlefile']['name']);

 chmod($_FILES["articlefile"]["tmp_name"], 0777);
 chmod($filedir, 0777 );        

 move_uploaded_file($_FILES["articlefile"]["tmp_name"],$filedir); 
```

该代码在 Linux 服务器上可以正常工作，但在 Windows 上不行。

任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-26T12:10:02.470

我决定从：

```
move_uploaded_file($uploaded_file, $file_path); 
```

至

```
file_put_contents($file_path, file_get_contents($uploaded_file));
@unlink($uploaded_file); 
```

可能会失败，`unlink`但我不太担心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T02:16:37.030

`chmod`不适用于 Windows，因为它使用不同类型的权限系统。确保用户 Apache 运行为对您尝试将文件移动到的文件夹具有完全写入权限（右键单击并单击共享或权限，具体取决于 Windows 版本）

# android - Android .apk 在内存中加载

> ID：11371686
> 
> 赞同：0
> 
> 时间：2012-07-07T01:59:58.223
> 
> 标签：android, android-intent

我需要知道，当我们在 android 中单击一个应用程序时，它是如何加载到内存中的，以及如何为该应用程序创建进程，以及在 android 源（拨号器应用程序）中哪里可以看到此代码流。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T02:36:49.637

与传统执行相比，一个名为 zygote 的预运行进程已经包含 dalvik vm 和许多其他系统库，它被告知派生一个子进程，该子进程成为您的应用程序进程，然后从您的 apk 中加载您的 dex 类。zygote 和 dalvik aosp 来源可能很有趣。

请注意，启动可能并不意味着新进程，因为它可能会在属于应用程序用户 ID 的现有进程中启动活动。相反，在用户看来，将后台活动最小化实际上可能涉及创建一个新进程来获取已处理的前任暂停的位置。

# iphone - 枚举期间弹出 ALAssetslibrary 时内存使用量攀升

> ID：11371687
> 
> 赞同：1
> 
> 时间：2012-07-07T02:00:19.690
> 
> 标签：iphone, alassetslibrary

我有一个问题，我在我的应用程序中看到内存使用量攀升（但 Instruments 中没有明显的泄漏）。

我有一个包含两个视图控制器的测试项目：MainViewController 和 PhotoViewController。MainViewController 包含一个按钮，它通过 uinavigationcontroller pushViewController 方法简单地推送 PhotoViewController。

在 PhotoViewController 中，我使用 ALAssetsLibrary 用图像填充 UITableView。我基本上分两部分来做这件事。首先，我查看可用的资产组，因为我需要显示来自相机胶卷和照片库的图像。完成后，我调用另一个方法来枚举实际资产。

这是奇怪的行为：如果我推送 PhotoViewController 并让它完成整个枚举并填充 UITableView，然后弹出回 MainViewController，一切都很好。

但是，如果我反复快速地推出并弹出 PhotoViewCONtroller（虽然它还没有完成枚举和填充 UITableiew），那么我会看到我的内存使用量逐渐攀升，直到应用程序最终死掉。我在 Instruments 中没有看到任何明显的泄漏。

我不知道相关代码，但这里有两种用于枚举的方法。当然，在dealloc中，我正在发布相关的ivars。

有没有办法在弹出时取消枚举？

就像一个注释，我的测试代码基于这个项目（https://github.com/elc/ELCImagePickerController），虽然高度定制。但是，我刚刚使用该代码进行了测试，并且发生了同样的问题。请注意，如果您有足够的 ALAsset 进行枚举，您只会看到内存使用量攀升。如果数量太少，那么它会在你弹出之前完成枚举。

谢谢！

```
- (void)getAssetGroups
{

    // Load Albums into assetGroups
    dispatch_async(dispatch_get_main_queue(), ^
       {
           NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

           // Group enumerator Block
           void (^assetGroupEnumerator)(ALAssetsGroup *, BOOL *) = ^(ALAssetsGroup *group, BOOL *stop) 
           {
               if (group == nil) 
               {
                   // check what data is available

                   if([savedPhotosGroup numberOfAssets] > 0 && [libraryGroup numberOfAssets] > 0)
                   {
                       // User has both Camera Roll and Photo Library albums
                       self.tableData = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                         savedPhotoAssets, NSLocalizedString(@"PHOTOPICKER_CAMERAROLL", nil),
                                         libraryPhotosAssets, NSLocalizedString(@"PHOTOPICKER_PHOTOLIBRARY", nil),
                                         nil];

                       self.sectionKeys = [NSArray arrayWithObjects:NSLocalizedString(@"PHOTOPICKER_CAMERAROLL", nil), NSLocalizedString(@"PHOTOPICKER_PHOTOLIBRARY", nil), nil];
                   }
                   else if([libraryGroup numberOfAssets] == 0)
                   {
                       // User only has Camera Roll
                       self.tableData = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                         savedPhotoAssets, NSLocalizedString(@"PHOTOPICKER_CAMERAROLL", nil),
                                         nil];

                       self.sectionKeys = [NSArray arrayWithObjects:NSLocalizedString(@"PHOTOPICKER_CAMERAROLL", nil), nil];
                   }
                   else 
                   { 
                       //User only has Photo Library
                       self.tableData = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                         libraryPhotosAssets, NSLocalizedString(@"PHOTOPICKER_PHOTOLIBRARY", nil),
                                         nil];

                       self.sectionKeys = [NSArray arrayWithObjects:NSLocalizedString(@"PHOTOPICKER_PHOTOLIBRARY", nil), nil];
                   }

                   NSLog(@"Done enumerating groups");
                   [self performSelectorInBackground:@selector(enumeratePhotos) withObject:nil];
                   [self.tview performSelector:@selector(reloadData) withObject:nil afterDelay:1];
                   return;
               }

               ALAssetsGroupType groupType = [[group valueForProperty:ALAssetsGroupPropertyType] unsignedIntValue];
               if(groupType == ALAssetsGroupSavedPhotos)
               {
                   self.savedPhotosGroup = group;
               }
               else if(groupType == ALAssetsGroupLibrary)
               {
                   self.libraryGroup = group;
               }
           };

           // Group Enumerator Failure Block
           void (^assetGroupEnumberatorFailure)(NSError *) = ^(NSError *error) {

               NSLog(@"A problem occured %@", [error description]);                                  
           };   

           // Enumerate Albums

           [library enumerateGroupsWithTypes: ALAssetsGroupSavedPhotos | ALAssetsGroupLibrary
                                  usingBlock:assetGroupEnumerator 
                                failureBlock:assetGroupEnumberatorFailure];

           NSLog(@"Draining pool");
           [pool drain];
       }); 
} 
```

> -(void)enumeratePhotos { NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
> 
> ```
> NSLog(@"enumerating photos");
> [savedPhotosGroup enumerateAssetsUsingBlock:^(ALAsset *result, NSUInteger index, BOOL *stop) 
>  {         
>      if(result == nil) 
>      {
>          return;
>      }
> 
>      CustomAsset *customAsset = [[[CustomAsset alloc] initWithAsset:result] autorelease];
>      [customAsset setParent:self];
> 
>      [savedPhotoAssets addObject:customAsset];
>  }]; 
> 
> [libraryGroup enumerateAssetsUsingBlock:^(ALAsset *result, NSUInteger index, BOOL *stop) 
>  {         
>      if(result == nil) 
>      {
>          return;
>      }         
>      CustomAsset *customAsset = [[[CustomAsset alloc] initWithAsset:result] autorelease];
>      [customAsset setParent:self];
> 
>      [libraryPhotosAssets addObject:customAsset];
>  }]; 
> 
> NSLog(@"done enumerating photos");
> [tview performSelectorOnMainThread:@selector(reloadData) withObject:nil waitUntilDone:NO];
> 
> // only do this if I want to re-select some assets
> if(assetsToRestore)
> {
>     for(NSDictionary *dict in assetsToRestore)
>     {
>         NSIndexPath *indexPathToRestore = [dict objectForKey:@"selectedAssetIndexPath"];
>         int tagToRestore = [[dict objectForKey:@"selectedAssetTag"] intValue];
>         [self selectAssetWithIndexPath:indexPathToRestore andIndex:tagToRestore];
>     }
> }
> 
> [pool drain]; } 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T15:16:13.743

如果我错了，请纠正我，我认为现在应该像这样使用自动释放池：

```
@autoreleasepool {
    (statements)
} 
```

这对我有用。

# java - 如何从 Mule 入站端点中的一组 URI 中过滤单个 URI？

> ID：11371690
> 
> 赞同：0
> 
> 时间：2012-07-07T02:00:58.033
> 
> 标签：java, spring, jersey, mule

我有以下代码在“http://localhost:8080/alpha”配置 Jersey 服务：

```
*** my mule config ***

<flow name="flow1">
    <inbound-endpoint address="http://localhost:8080/" exchange-pattern="request-response"    />
<jersey:resources>
    <component>
        <singleton-object class="com.address.Flow1Resource"/>
    </component>
</jersey:resources>
</flow>

*** Flow1Resource.java ***

@Path("/alpha")
public class Flow1Resource {...} 
```

我想添加一个新的入站端点来处理“http://localhost:8080”下的所有地址，除了“http://localhost:8080/alpha”（例如“http://localhost:8080/beta”） . 这些新地址需要一个球衣资源。例如：

```
*** my mule config ***

<flow name="flow1">
    <inbound-endpoint address="http://localhost:8080/" exchange-pattern="request-response"    />
<jersey:resources>
    <component>
        <singleton-object class="com.address.Flow1Resource"/>
    </component>
</jersey:resources>
</flow>

<flow name="flow2">
    <inbound-endpoint address="http://localhost:8080/*" exchange-pattern="request-response"    />
<jersey:resources>
    <component>
        <singleton-object class="com.address.Flow2Resource"/>
    </component>
</jersey:resources>
</flow>

*** Flow1Resource.java ***

@Path("/alpha")
public class Flow1Resource {...}

*** Flow2Resource.java ***

@Path("/")
public class Flow2Resource {
    @Path("beta")
    public void beta() {...}
    @Path("gamma")
    public void gamma() {...}
    ...
} 
```

我如何设置 mule 入站端点以捕获所有地址（即 beta 和 gamma），除了特定的 url（即 alpha）。

我知道我可以对 mule 配置中的路径进行硬编码，但这会导致重复，因为每个地址（即 beta 和 gamma）都需要自己的流和资源代码，它们是相似的。

请注意，我在上面的代码中使用了“http://localhost:8080/*”作为概念示例。这没用。

- - 更新 - -

我忘了提到 beta 和 gamma uri 也具有与它们相关的安全性，使用：

```
<http:inbound-endpoint ...>
    <spring-security:http-security-filter realm="mule-realm"/>
</http:inbound-endpoint> 
```

我尝试向端点添加“选择”元素，但它抱怨 spring-security 在选择决策结构中无效。

解决方案还需要适应此功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T07:46:19.813

实现目标的一种简单方法是将流合并为一个并使用选择路由器。在此配置中，您的流程将如下所示：

```
<flow name="stackoverflowFlow1" doc:name="stackoverflowFlow1">
    <http:inbound-endpoint exchange-pattern="request-response"
        host="localhost" port="8081" doc:name="HTTP" />
    <logger level="ERROR" />
    <choice doc:name="Choice">
        <when expression="#[message.inboundProperties['http.request'] == '/']">
            <processor-chain>
                <logger message="/ invoked " level="ERROR" />
                <jersey:resources doc:name="REST">
                    <component class="Resource" />
                </jersey:resources>
            </processor-chain>
        </when>
        <otherwise>
            <processor-chain>
                <logger message="otherwise invoked " level="ERROR" />

                <jersey:resources doc:name="REST">
                    <component class="ApplicationsResource" />
                </jersey:resources>
            </processor-chain>
        </otherwise>
    </choice>
</flow> 
```

正如您可以想象的那样，您可以在路径或任何其他 http 标头之上做出决定。

[您可以在此处](http://www.mulesoft.org/documentation/display/MULE3USER/Routing+Message+Processors#RoutingMessageProcessors-Choice)找到此路由器文档以及可用于[在此处](http://www.mulesoft.org/documentation/display/MULE3USER/HTTP+Transport+Reference#HTTPTransportReference-HTTPProperties)进行选择的最常见 http 属性列表

# python - 在python中向嵌套字典添加新键

> ID：11371691
> 
> 赞同：4
> 
> 时间：2012-07-07T02:01:01.027
> 
> 标签：python, dictionary

我需要为嵌套字典中的每个项目添加一个值增加一的键。我一直在尝试使用该`dict['key']='value'`语法，但无法使其适用于嵌套字典。我敢肯定这是一个非常简单的。

我的字典：

```
mydict={'a':{'result':[{'key1':'value1','key2':'value2'},
                        {'key1':'value3','key2':'value4'}]}} 
```

这是将键添加到字典主要部分的代码：

```
for x in range(len(mydict)):
        number = 1+x
        str(number)
        mydict[d'index']=number

print mydict
  #out: {d'index':d'1',d'a'{d'result':[...]}} 
```

我想将新的键和值添加到方括号内的小字典中：

```
{'a':{'result':[{'key1':'value1',...,'index':'number'}]}} 
```

如果我尝试在最后一行添加更多层，`for loop`则会出现回溯错误：

```
Traceback (most recent call last):
  File "C:\Python27\program.py", line 34, in <module>
    main()
  File "C:\Python27\program.py", line 23, in main
    mydict['a']['result']['index']=number
TypeError: list indices must be integers, not unicode 
```

我尝试了各种不同的方式来列出嵌套项目，但没有任何乐趣。有谁可以帮我离开这里吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-07T02:25:55.247

问题在于这`mydict`不仅仅是嵌套字典的集合。它还包含一个列表。分解定义有助于澄清内部结构：

```
dictlist = [{'key1':'value1','key2':'value2'},
            {'key1':'value3','key2':'value4'}]
resultdict = {'result':dictlist}
mydict = {'a':resultdict} 
```

所以要访问最里面的值，我们必须这样做。向后工作：

```
mydict['a'] 
```

返回`resultdict`。然后这个：

```
mydict['a']['result'] 
```

返回`dictlist`。然后这个：

```
mydict['a']['result'][0] 
```

返回 中的第一项`dictlist`。最后，这个：

```
mydict['a']['result'][0]['key1'] 
```

返回`'value1'`

所以现在你只需要修改你的`for`循环来正确地迭代`mydict`. 可能有更好的方法，但这是第一种方法：

```
for inner_dict in mydict['a']['result']: # remember that this returns `dictlist`
    for key in inner_dict:
        do_something(inner_dict, key) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T02:12:27.433

我不完全确定您要做什么，但我认为`itertools.count`可以在这里提供帮助。

```
>>> c = itertools.count()
>>> c.next()
0
>>> c.next()
1
>>> c.next()
2
>>> c.next()
3 
```

... 等等。

使用它，您可以不断增加要在`dict`s中使用的值

希望这可以帮助

# css - 自定义字体在本地工作但不在服务器上？

> ID：11371694
> 
> 赞同：2
> 
> 时间：2012-07-07T02:01:34.533
> 
> 标签：css, asp.net-mvc, iis, font-face, truetype

[`@font-face`](http://www.css3.info/preview/web-fonts-with-font-face/)我在我的网站的级联样式表中有一个定义。当我在本地浏览站点（由 IIS Express 提供服务）时，此字体加载正常。但是，当从我的远程服务器 (IIS 7.5) 加载我的应用程序时，对该字体的引用会导致[内部服务器 500 错误](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#5xx_Server_Error)。为什么下面的样式在本地工作，而不是在服务器上？

```
@font-face {
    font-family: DejaVu Sans Mono;
    src: url('../fonts/DejaVuSansMono.ttf');
}

header h1
{
    font-family: 'DejaVu Sans Mono';
    font-size: 3em;
    padding: 0;
    margin: 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T02:01:36.530

如果您检查，您会发现该`DejaVuSansMono.ttf`文件没有被复制到您的服务器。由于它没有被复制，因此 IIS 7.5 无法提供字体文件。它可以在本地工作，因为 IIS Express 能够在本地目录中找到该文件。

Visual Studio 无法识别的文件类型默认将其[BuildAction 属性](http://msdn.microsoft.com/en-us/library/0c6xyb66)设置为**None**；字体文件就是这样一种无法识别的类型。BuildAction 为 none 意味着 Visual Studio 在构建应用程序时将忽略此文件。BuildAction 属性有几个开箱即用的选项：

> *   **无**- 文件不包含在项目输出组中，并且不在构建过程中编译。一个示例是包含文档的文本文件，例如自述文件。
> *   **编译**- 文件被编译到构建输出中。此设置用于代码文件。
> *   **内容**- 文件未编译，但包含在内容输出组中。例如，此设置是 .htm 或其他类型的 Web 文件的默认值。
> *   **嵌入式资源**- 此文件作为 DLL 或可执行文件嵌入到主项目构建输出中。它通常用于资源文件。

最合适的 BuildAction 属性设置`DejaVuSansMono.ttf`是**Content**。通过以这种方式设置 BuildAction，文件将被复制到您的远程服务器。不幸的是，对于每个文件类型无法识别的文件，必须重复此手动过程，这会使开发人员陷入乏味且容易出错的过程。值得庆幸的是，Andre Loker 有一篇很棒的博客文章，介绍[了在 Visual Studio 中为非默认文件类型设置默认构建操作](http://blog.andreloker.de/post/2010/07/02/Visual-Studio-default-build-action-for-non-default-file-types.aspx)。

# ruby - Ruby 异步网络::HTTP?

> ID：11371699
> 
> 赞同：4
> 
> 时间：2012-07-07T02:01:45.800
> 
> 标签：ruby, asynchronous, block, net-http

是否`Net::HTTP`支持异步语法？

我正在寻找类似下面代码的东西。

`Net::HTTP`在收到来自服务器的响应（在这种情况下`error`是`nil`）或遇到连接到服务器的错误（在这种情况下`response`是）之后，该块将在主线程上调用`nil`。

```
Net::HTTP.get('http://stackoverflow.com') do |response, error|
  if error
    puts "Connection error: #{error.message}"
  elsif response.status_code != HTTPOK
    puts "Unexpected status code: #{response.status_code}"
    puts response.body
  else
    puts "Success!"
    puts response.body
  end
end 
```

以下问题提供了答案，但我正在寻找基于块的解决方案。

*   [ruby 中的异步 http 请求](https://stackoverflow.com/questions/6643964/asynchronous-http-request-in-ruby)
*   [使用 ruby​​ 的异步 HTTP 请求](https://stackoverflow.com/questions/9344282/asynchronous-http-requests-with-ruby)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T08:24:31.833

看看`eventmachine`和`em-http-request`宝石。相当于您上面的代码将是

```
require 'rubygems'
require 'eventmachine'
require 'em-http'

HTTP_OK = 200

EM.run do
  http = EM::HttpRequest.new('http://example.com').get

  http.errback do
    puts "Connection error: #{http.error}"
    EM.stop
  end

  http.callback do
    if http.response_header.status == HTTP_OK
      puts "Success!"
      puts http.response
    else
      puts "Unexpected status code: #{http.response_header.status}"
    end
    EM.stop
  end
end 
```

[`em-http-request`Github 页面](https://github.com/igrigorik/em-http-request/blob/master/examples/fibered-http.rb)上有一个非常好的使用纤维的例子。

**编辑：**我还建议阅读[http://www.igvita.com/2009/05/13/fibers-cooperative-scheduling-in-ruby/](http://www.igvita.com/2009/05/13/fibers-cooperative-scheduling-in-ruby/)

# jquery - json jqmodal填充下拉列表

> ID：11371707
> 
> 赞同：1
> 
> 时间：2012-07-07T02:03:14.957
> 
> 标签：jquery, json, drop-down-menu

我正在尝试在 jqmodal 中填充具有不同产品尺寸的下拉列表。我真的无法让它工作。任何帮助表示赞赏。

我的 JSON

```
{
    "product": {
        "variants": {
            "3394248": {
                "id": 3394248,
                "code": "19",
                "ean": "19",
                "sku": "19",
                "price": {
                    "price": 19.95,
                    "price_incl": 23.7405,
                    "price_excl": 19.95,
                    "price_old": 0,
                    "price_old_incl": 0,
                    "price_old_excl": 0
                },
                "title": "Maat 95",
                "active": false
            },
            "3376388": {
                "id": 3376388,
                "code": "19",
                "ean": "19",
                "sku": "19",
                "price": {
                    "price": 19.95,
                    "price_incl": 23.7405,
                    "price_excl": 19.95,
                    "price_old": 0,
                    "price_old_incl": 0,
                    "price_old_excl": 0
                },
                "title": "Maat 100",
                "active": true
            }
        },
    }
} 
```

我的剧本

```
<script type="text/javascript">
$('#productVariations').jqm({
  trigger: 'a.ex2trigger'
});

function loadProductVariations(){

var productId = '{{ product.fulltitle }}';
var url = 'http://shop.com/'+productId+'/?format=json';

  $.getJSON(url,function(data){

    var variantHtml = '';

    $.each(data.product.variants, function(index, variants){   
      variantHtml = variantHtml + '<option value="' +variants.id+'</option>';
    });

    $('#productoptions').html(variantHtml);
});
} 
```

我的html

```
<div class="jqmWindow" id="productVariations">
Even geduld aub... <img src="https://shop.com/com/ajax-loader.gif?1" alt="loading" />
<span id="close">
  <button class="jqmClose">Close</button>
</span>
<br/><br/>
<form class="formProduct" id="product_configure_form" method="post" action="{{ ('cart/add/' ~ product.vid) | url }}" enctype="application/x-www-form-urlencoded">
  <div id="productoptions">
    <select onchange="document.getElementById('product_configure_form').action = 'http://shop.com/product/variants/2140679/'; document.getElementById('product_configure_form').submit();" id="product_configure_variants" name="variant">

    </select>
  </div>
  <a id="submit" class="button gray" href="#" onclick="$('#product_configure_form').submit(); return false;" title="{{ 'Add to cart' | t }}">{{ 'Add to cart' | t }}</a>
</form>
<span id="message"></span> 
```

这是一个概念，所以请原谅我当前代码中的错误！我唯一需要知道的是如何填充下拉框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T02:08:53.117

一方面，您的 json 格式不正确。缺少 2 个右括号，我已在您的原始帖子中对其进行了编辑。

其次，尝试像这样更改循环：

```
$.each(data.product.variants, function(index, variants){   
variantHtml = variantHtml + '<option value="' +variants.id+'</option>';
}); 
```

到

```
for (var i in data.product.variants) {
     var v = data.product.variants[i];
     var $opt = $("<option>").text(v.title);
     $("#productoptions select").append($opt);
} 
```

# php - MySQL 在一个表中查找包含另一个表中的信息的行

> ID：11371708
> 
> 赞同：-5
> 
> 时间：2012-07-07T02:03:20.637
> 
> 标签：php, mysql

目前，我有两个 MySQL 表。

第一个表存储朋友和他的图片之间的关系。

表格1

```
 id  |  pic_id  |  friend_id
----------------------------
 0   |  123     |  84589
 1   |  290     |  11390
 2   |  884     |  84589 
```

表 2

第二个表存储有关图片的更多信息...

```
id   |  pic_id  |  title   |  color  |  detail
----------------------------------------------
0    |  123     | hello    |  black  |  brush
1    |  124     | world    |   red   |  paint
2    |  884     | sample   |  green  |  star 
```

我有我的朋友 ID，需要从表 1 中获取所有 pic_id，然后使用 pic_id 从表 2 中获取列（标题、颜色、详细信息）...

我将如何在 MySQL 中执行此操作？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T02:07:32.483

只需连接两个表。

```
SELECT b.title, b.color, b.detail
FROM table1 a INNER JOIN table2 b
        on a.pic_id = b.pic_id
WHERE friend_id = 84589 
```

# unit-testing - 是否可以在 MVC4 中对 BundleConfig 进行单元测试？

> ID：11371710
> 
> 赞同：10
> 
> 时间：2012-07-07T02:03:49.960
> 
> 标签：unit-testing, asp.net-mvc-4, asp.net-optimization, bundling-and-minification

据我所知，答案是否定的。我看到的问题来自课堂上的`Include(params string[])`方法`System.Web.Optimization.Bundle`。这在内部调用`System.Web.Optimization.IncludeDirectory(string, string, bool)`，而后者又使用以下代码：

```
DirectoryInfo directoryInfo = new DirectoryInfo(
    HttpContext.Current.Server.MapPath(directoryVirtualPath)); 
```

虽然可以`HttpContext.Current`在单元测试期间进行设置，但我不知道如何使其`.Server.MapPath(string directoryVirtualPath)`返回非空字符串。由于`DirectoryInfo(string)`构造函数在传递空参数时会抛出异常，因此这样的测试总是会失败。

.NET 团队对此有何建议？作为集成测试或用户验收测试的一部分，我们是否必须对捆绑配置进行单元测试？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T20:32:37.393

我有一些好消息要告诉你，对于 RTM，我们添加了一个新的静态属性`BundleTable`来启用更多的单元测试：

```
public static Func<string, string> MapPathMethod; 
```

**编辑**使用测试虚拟路径提供程序更新：

所以你可以做这样的事情：

```
public class TestVirtualPathProvider : VirtualPathProvider {

    private string NormalizeVirtualPath(string virtualPath, bool isDirectory = false) {
        if (!virtualPath.StartsWith("~")) {
            virtualPath = "~" + virtualPath;
        }
        virtualPath = virtualPath.Replace('\\', '/');
        // Normalize directories to always have an ending "/"
        if (isDirectory && !virtualPath.EndsWith("/")) {
            return virtualPath + "/";
        }
        return virtualPath;
    }

    // Files on disk (virtualPath -> file)
    private Dictionary<string, VirtualFile> _fileMap = new Dictionary<string, VirtualFile>();
    private Dictionary<string, VirtualFile> FileMap {
        get { return _fileMap; }
    }

    public void AddFile(VirtualFile file) {
        FileMap[NormalizeVirtualPath(file.VirtualPath)] = file;
    }

    private Dictionary<string, VirtualDirectory> _directoryMap = new Dictionary<string, VirtualDirectory>();
    private Dictionary<string, VirtualDirectory> DirectoryMap {
        get { return _directoryMap; }
    }

    public void AddDirectory(VirtualDirectory dir) {
        DirectoryMap[NormalizeVirtualPath(dir.VirtualPath, isDirectory: true)] = dir;
    }

    public override bool FileExists(string virtualPath) {
        return FileMap.ContainsKey(NormalizeVirtualPath(virtualPath));
    }

    public override bool DirectoryExists(string virtualDir) {
        return DirectoryMap.ContainsKey(NormalizeVirtualPath(virtualDir, isDirectory: true));
    }

    public override VirtualFile GetFile(string virtualPath) {
        return FileMap[NormalizeVirtualPath(virtualPath)];
    }

    public override VirtualDirectory GetDirectory(string virtualDir) {
        return DirectoryMap[NormalizeVirtualPath(virtualDir, isDirectory: true)];
    }

    internal class TestVirtualFile : VirtualFile {
        public TestVirtualFile(string virtualPath, string contents)
            : base(virtualPath) {
            Contents = contents;
        }

        public string Contents { get; set; }

        public override Stream Open() {
            return new MemoryStream(UTF8Encoding.Default.GetBytes(Contents));
        }
    }

    internal class TestVirtualDirectory : VirtualDirectory {
        public TestVirtualDirectory(string virtualPath)
            : base(virtualPath) {
        }

        public List<VirtualFile> _directoryFiles = new List<VirtualFile>();
        public List<VirtualFile> DirectoryFiles {
            get {
                return _directoryFiles;
            }
        }

        public List<VirtualDirectory> _subDirs = new List<VirtualDirectory>();
        public List<VirtualDirectory> SubDirectories {
            get {
                return _subDirs;
            }
        }

        public override IEnumerable Files {
            get {
                return DirectoryFiles;
            }
        }

        public override IEnumerable Children {
            get { throw new NotImplementedException(); }
        }

        public override IEnumerable Directories {
            get { 
                return SubDirectories;
            }
        }
    } 
```

然后像这样使用它编写一个单元测试：

```
 [TestMethod]
    public void StyleBundleCustomVPPIncludeVersionSelectsTest() {
        //Setup the vpp to contain the files/directories
        TestVirtualPathProvider vpp = new TestVirtualPathProvider();
        var directory = new TestVirtualPathProvider.TestVirtualDirectory("/dir/");
        directory.DirectoryFiles.Add(new TestVirtualPathProvider.TestVirtualFile("/dir/style1.0.css", "correct"));
        directory.DirectoryFiles.Add(new TestVirtualPathProvider.TestVirtualFile("/dir/style.css", "wrong"));
        vpp.AddDirectory(directory);

        // Setup the bundle
        ScriptBundle bundle = new ScriptBundle("~/bundles/test");
        bundle.Items.VirtualPathProvider = vpp;
        bundle.Include("~/dir/style{version}.css");

        // Verify the bundle repsonse
        BundleContext context = SetupContext(bundle, vpp);
        BundleResponse response = bundle.GetBundleResponse(context);
        Assert.AreEqual(@"correct", response.Content);
    } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-01T17:06:41.967

在 .Net 4.5 中，情况略有变化。这是已更新以适应这些更改的已批准答案的工作版本（我正在使用 Autofac）。注意“GenerateBundleResponse”而不是“GetBundleResponse”：

```
 [Fact]
    public void StyleBundleIncludesVersion()
    {
        //Setup the vpp to contain the files/directories
        var vpp = new TestVirtualPathProvider();
        var directory = new TestVirtualPathProvider.TestVirtualDirectory("/dir/");
        directory.DirectoryFiles.Add(new TestVirtualPathProvider.TestVirtualFile("/dir/style1.0.css", "correct"));
        directory.DirectoryFiles.Add(new TestVirtualPathProvider.TestVirtualFile("/dir/style.css", "wrong"));
        vpp.AddDirectory(directory);

        // Setup the bundle
        var bundleCollection = new BundleCollection();
        var bundle = new ScriptBundle("~/bundles/test");
        BundleTable.VirtualPathProvider = vpp;
        bundle.Include("~/dir/style{version}.css");
        bundleCollection.Add(bundle);
        var mockHttpContext = new Mock<HttpContextBase>();

        // Verify the bundle repsonse
        var context = new BundleContext(mockHttpContext.Object, bundleCollection, vpp.ToString());
        var response = bundle.GenerateBundleResponse(context);
        Assert.Equal(@"correct", response.Content);
    } 
```

# css - 导航栏的最小 css 是什么

> ID：11371713
> 
> 赞同：0
> 
> 时间：2012-07-07T02:04:23.567
> 
> 标签：css, navigationbar

随着“导航”标签的出现，我正在重新审视导航栏的创建。有很多教程，但他们采用不同的方法，并且用太多的 css 解决了这个问题。

具体来说，我有一个 960 宽的内容区域，我想将导航按钮居中。

1.  'nav' 元素是否有任何固有的 css 行为，或者它纯粹是一个语义容器？
2.  如果我将按钮居中，那么我肯定不需要“浮动”它们吗？文本对齐，ul 的中心应该可以解决问题。
3.  如果我希望按钮比导航栏本身短，我应该给栏一个高度（使用按钮的行高使它们居中）还是为按钮添加边距以向外（垂直）推动栏？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T03:22:00.693

这里有几个例子：http: [//jsfiddle.net/joplomacedo/ejSby/](http://jsfiddle.net/joplomacedo/ejSby/)

**'nav' 元素是否有任何固有的 css 行为，或者它纯粹是一个语义容器？**

`nav`元素是一个纯粹的语义容器。就 css 而言，它的行为只不过是一个简单的块级元素，如`div`.

**如果我将按钮居中，那么我肯定不需要“浮动”它们吗？文本对齐，ul 的中心应该可以解决问题。**

如果您正在使用`ul`，就像您说的那样，那么您也将需要`li`'。问题是`li`' 显示块（实际上，不是块 - `list-item`。在我们感兴趣的方式中，它们的行为类似于块） - 当你想并排放置块级元素时，你会总是需要`float`它们，或者将它们的显示更改为`inline`( `inline-block`)。

“浮动”或“内联阻塞”。出于多种原因，我倾向于使用“inline-block 技术”——其中之一是，如您所愿，将块居中只是将 text-align 设置为在父元素上居中的问题。

**如果我希望按钮比导航栏本身短，我应该给栏一个高度（使用按钮的行高使它们居中）还是为按钮添加边距以向外（垂直）推动栏？**

`padding-top`将&添加到导航块似乎更简单`bottom`，不是吗？

再说一次，这是小提琴：http: [//jsfiddle.net/joplomacedo/ejSby/](http://jsfiddle.net/joplomacedo/ejSby/)

# asp.net-mvc - ASP.NET MVC - 类型化 ViewData 提议

> ID：11371714
> 
> 赞同：1
> 
> 时间：2012-07-07T02:04:27.470
> 
> 标签：asp.net-mvc

`<form>`在我正在做的一个项目中，我有很多没有s的“只读”页面；我还有很多表单页面，其中也有很多从控制器中提取的只读数据。

通常你会使用 ViewModel 并且每个视图有一个 ViewModel，而 ViewModel 包含该视图的所有数据。这似乎很公平，除了有一个问题：

在我的脑海中，我认为 ViewModel 是从视图发送回控制器的整个数据的表示和封装，但 ViewModel 可能包含由控制器填充的数据（例如 SelectListItem[] Html.DropDownListFor() 数据) 不能由视图填充并发送回控制器。

当然，可以将这些数据作为 ViewModel 的一部分并在控制器的 HttpPost 处理方法中返回视图之前手动重新填充它，但我觉得它不必要地使控制器的代码复杂化（你必须使用 UpdateModel () 而不是在将模型指定为操作方法的参数时发生的自动更新）。

我对此的解决方案是一个类型化的 ViewData 对象。我派生于`ViewPage<TModel>`提供`ViewPage2<TModel,TData> where TData : ViewDataDictionary<TModel>`并覆盖（或隐藏）该`.ViewData`属性以返回 TData 的实例。

我的问题是双重的：

*   子类化 ViewPage 似乎很容易，但是我在哪里放置逻辑来处理我的`ViewPage2<TModel,TData>`类的初始化？
*   我的方法有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:29:35.493

我找到了一种方法来实现我的 ViewData / ViewModel 方法，而不会过多地使用 ASP.NET MVC。

我是这样做的：

这是我的`ViewPage2`类，它将强类型的 ViewData 对象公开给视图。不幸的是，您确实需要使用反射来避免 ViewPage 创建全新 ViewDataDictionary 的行为，但是对于静态缓存的 FieldInfo 对象，它并不比 MVC 在路由中的动态控制器/动作查找更昂贵。

```
public class ViewPage2<TModel,TData> : ViewPage<TModel> where TData : ViewDataDictionary<TModel> {

    public ViewPage2() : base() {
    }

    private Boolean _dataPresent;
    private TData   _data;

    public new TData ViewData {
        get {
            if( _dataPresent && _data == null ) {
                _data = (TData)base.ViewData;
            }
            return _data;
        }
    }

    // Cached in static class state for performance.
    private static readonly FieldInfo _viewPage1ViewData;
    private static readonly FieldInfo _viewPage2ViewData;

    static ViewPage2() {

        Type viewPage1     = typeof(ViewPage<TModel>);
        _viewPage1ViewData = viewPage1.GetField("_viewData", BindingFlags.Instance | BindingFlags.NonPublic );

        Type viewPage2     = typeof(ViewPage);
        _viewPage2ViewData = viewPage2.GetField("_viewData", BindingFlags.Instance | BindingFlags.NonPublic );
    }

    protected override void SetViewData(ViewDataDictionary viewData) {

        // ViewPage<TModel> creates a new ViewDataDictionary<TModel> when this method is called, even if viewData is of the correct type.

        // The trick is to reimplement SetViewData and set base._viewData and basebase._viewData

        if( viewData is TData ) {

            _viewPage1ViewData.SetValue( this, viewData );
            _viewPage2ViewData.SetValue( this, viewData );

            _dataPresent = true;

        } else {

            base.SetViewData( viewData );
        }

    }
} 
```

然后对于每个 *.aspx 文件（我使用 WebFormViewEngine），我只需更改`@Page`指令：

```
<%@ Page Language="C#" MasterPageFile="~/Site.Master" Inherits="Me.ViewPage2<Me.FormModel,Me.FormData>" %> 
```

我承认这两个泛型类型说明符使它有点繁琐，但你只需要设置一次。

然后在每个控制器中，只需这样做：

```
public ActionResult Edit() {
    FormData data = new FormData();
    data.SomeStronglyTypedField = "foo";
    this.ViewData = data;
} 
```

在每个视图中，您现在都可以从强类型视图数据中受益：

```
<p><%= ViewData.SomeStronglyTypedField %></p> 
```

由于 ViewData 不是模型的一部分，因此在处理 POST 提交的数据时关注点分离以及自动绑定的好处：

```
 [HttpPost]
 public ActionResult Edit(EditModel model) {
     if( !ModelState.IsValid ) {

        // See how I can return the model object without modifying it. All I need to do is re-create the View data.

        FormData data = new FormData();
        data.SomeStronglyTypedField = "foo";
        this.ViewData = data;

        return View( model );
     }
     // persist to DB here
     return RedirectToAction("View");
 } 
```

在实践中，我使用一个通用的 BaseController 类来处理 ViewData 对象的自动创建和设置，因此我不需要`FormData data...`在每个操作中使用这三行（等）。

# javascript - 地理位置代码不适用于 iPhone / iPod Touch / iPad

> ID：11371719
> 
> 赞同：1
> 
> 时间：2012-07-07T02:05:22.197
> 
> 标签：javascript, geolocation, mobile-safari

我们在 Apple Store 进行了一些测试，发现我们的地理定位代码（获取纬度和经度）不适用于 iPhone、iPod Touch 或 iPad。我确实必须添加额外的代码才能让它在 MacBook / iMac 上工作。

**任何人都知道代码来获得在 iPod Touch / iPhone / iPad 设备上肯定有效的纬度/经度？**

代码：

```
// needed for iPhone / iPad / iTouch
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDrORw0RI-1v-5BixC4T_zLEhcBBwGzyuQ&amp;sensor=true"></script>

// needed for iMac / MacBook
<script src="http://code.google.com/apis/gears/gears_init.js" type="text/javascript"></script>
<script src="http://gaychat.me/js/geo.js" type="text/javascript" ></script>

<script type="text/javascript"><!--
        var ua = navigator.userAgent.toLowerCase();
        var isAndroid = ua.indexOf("android") > -1;
        var isIPhone = ua.indexOf("iphone") > -1;
        var isIPod = ua.indexOf("ipod") > -1;
        var isBlackberry = ua.indexOf("blackberry") > -1;
        var isIPad = ua.indexOf("ipad") > -1;

        if (isIPhone || isIPod || isIPad) {
                function doGeo() {
                        var geolocator = new google.maps.Geocoder();

                        geolocator.geocode({},
                                function(results, status){
                                        var geocoding_url = "geocoding.php?lat=" + results[0].geometry.location.lat() + "&long=" + results[0].geometry.location.lng() + "&email=<?=$brosforbros_email;?>&key=<?=$session_key;?>";

                                        $.ajax({
                                                url: geocoding_url,
                                                success: function(data) {}
                                        });
                                }
                        )

                        /*function geo_success(position) {
                                prev_lat = position.coords.latitude;
                                prev_long = position.coords.longitude;

                                var geocoding_url = "geocoding.php?lat=" + position.coords.latitude + "&long=" + position.coords.longitude + "&email=<?=$brosforbros_email;?>&key=<?=$session_key;?>";

                                $.ajax({
                                        url: geocoding_url,
                                        success: function(data) {}
                                });
                        }

                        function geo_error() {

                        }

                        if (!!navigator.geolocation) {
                                wpid = navigator.geolocation.watchPosition(geo_success, geo_error, {enableHighAccuracy:true, maximumAge:30000, timeout:27000}); 
                        }*/
                }
        } else if (geo_position_js.init()) { // needed for MacBook's / iMac with Safari
                function doGeo() {
                        geo_position_js.getCurrentPosition(success_callback,error_callback,{enableHighAccuracy:true});

                        function success_callback(p) {
                                geo_lat = p.coords.latitude.toFixed(3);
                                geo_long = p.coords.longitude.toFixed(3);

                                var url = 'geolocation.php?geo_user_id=<?=$user_id;?>&geo_email=<?=$user_email;?>&geo_lat=' + geo_lat + '&geo_long=' + geo_long;

                                $.ajax({
                                        url: url,
                                        context: document.body,
                                        success: function(data) {
                                        // UPDATE GEOLOCATION
                                        }
                                });
                        }

                        function error_callback(p) {
                                alert('error='+p.code);
                        }
                }
        } else {
                var gl;

                function getCookie(name) {
                        var start = document.cookie.indexOf(name + "=");
                        var len = start + name.length + 1;

                        if ((!start) && (name != document.cookie.substring(0, name.length))) {
                                return null;
                        }

                        if (start == -1) return null;

                        var end = document.cookie.indexOf(";", len);

                        if (end == -1) end = document.cookie.length;

                        return unescape(document.cookie.substring(len, end));
                }

                function displayPosition(position) {
                        geo_lat = position.coords.latitude;
                        geo_long = position.coords.longitude;

                        var url = 'geolocation.php?geo_user_id=<?=$user_id;?>&geo_email=<?=$user_email;?>&geo_lat=' + geo_lat + '&geo_long=' + geo_long;

                        $.ajax({
                                url: url,
                                context: document.body,
                                success: function(data) {
                                        // UPDATE GEOLOCATION
                                }
                        }); 
                }

                function displayError(positionError) {
                        //alert("error");
                }

                function doGeo() {
                        try {
                                if (typeof navigator.geolocation === 'undefined'){
                                gl = google.gears.factory.create('beta.geolocation');
                                } else {
                                gl = navigator.geolocation;
                                }
                        } catch(e) {}

                        if (gl) {
                                gl.getCurrentPosition(displayPosition, displayError);
                        } else {
                                //alert("Geolocation services are not supported by your web browser.");
                        }
                }
        }

        doGeo();
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T02:58:52.473

我写了那个库。如果您真的只部署到 iOS，那么您可以简单地使用基本的 javascript 并完全绕过库：

```
navigator.geolocation.getCurrentPosition(foundLocation, noLocation);

function foundLocation(position)
{
 var lat = position.coords.latitude;
 var long = position.coords.longitude;
 alert('Found location: ' + lat + ', ' + long);
}
function noLocation() 
{
 alert('Could not find location');
 } 
```

该库有助于其他平台的一些时髦行为。

# java - getView 永远不会因为我以外的原因而被调用

> ID：11371720
> 
> 赞同：0
> 
> 时间：2012-07-07T02:05:29.820
> 
> 标签：java, android, listview, adapter

我有一个通过异步任务填充的自定义列表视图适配器，我在 onprogress 函数中调用 notifydatasetchanged，getCount() 返回 10，但我的列表从未显示，我设置了一个断点并确定 getView() 根本不会被调用。有任何想法吗？我已经尝试了几个小时，我只是难住了。我在另一个活动中做了完全相同的事情，除了一个使用了视图，这个只保存基于文本的数据，所以我没有打扰。

适配器：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
  View row = convertView;
  if(row == null) {
    row = inflater.inflate(R.layout.podcastepisode, null);
  }
  PodcastItem item = items.get(position);
  TextView episodeTitle = (TextView)row.findViewById(R.id.episodeTitle);
  TextView episodeDate = (TextView)row.findViewById(R.id.episodeDate);
  episodeTitle.setText(item.title);
  episodeDate.setText(API.FormatPodcastDate(item.date));
  return row;
} 
```

我的任务：

```
protected void onProgressUpdate(PodcastItem... progress) {
  AddPodcastActivity.episodes.add(progress[0]);
  AddPodcastActivity.adapter.notifyDataSetChanged();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T02:20:39.183

我建议将您的列表适配器从 Activity 文件中移动到它自己的文件中，并使用如下内容：

```
import java.util.ArrayList;

import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;

public class EpisodeArrayAdapter extends BaseAdapter {

    public EpisodeArrayAdapter(Context context) {
        mContext = context;
        items = new ArrayList<PodcastItem>();
    }

    private Context mContext;
    private ArrayList<PodcastItem> items;

    public void add(PodcastItem item) {
        items.add(item);
        notifyDataSetChanged();
    }

    public void remove(int index) {
        items.remove(index);
        notifyDataSetChanged();
    }

    public void clear() {
        items.clear();
        notifyDataSetChanged();
    }

    @Override
    public int getCount() { return items.size(); }

    @Override
    public Object getItem(int position) { return items.get(position); }

    @Override
    public long getItemId(int position) { return position; }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View row = convertView;
        if(row == null) row = LayoutInflater.from(mContext).inflate(R.layout.podcastepisode, null);
        PodcastItem item = items.get(position);
        TextView episodeTitle = (TextView)row.findViewById(R.id.episodeTitle);
        TextView episodeDate = (TextView)row.findViewById(R.id.episodeDate);
        episodeTitle.setText(item.title);
        episodeDate.setText(API.FormatPodcastDate(item.date));
        return row;
    }
} 
```

这是我们用于 Boid 中所有列表适配器的代码类型 :) 另外，请注意添加/删除/清除函数调用 notifyDataSetChanged()，这样您就不必在添加项目时自己调用它。

初始化它时，您只需使用：

```
EpisodeArrayAdapter adapter = new EpisodeArrayAdapter(this);
listView.setAdapter(adapter); 
```

使用 add() 函数添加项目将导致列表立即更新。确保为使用适配器的列表视图调用 setAdapter，否则将不会有任何连接，并且列表中不会显示任何内容（在您的代码中没有看到对此的调用）。

# java - 字节数组到java中的字符串

> ID：11371721
> 
> 赞同：0
> 
> 时间：2012-07-07T02:05:45.560
> 
> 标签：java, bytearray

```
SecureRandom random = SecureRandom.getInstance("SHA1PRNG");
byte[] salt = new byte[16];
random.nextBytes(salt); 
```

我想将盐转换为要存储/读取的字符串。我似乎无法让它发挥作用。我读过我需要使用正确的编码，但我不确定要使用什么编码。我已经尝试了以下但得到垃圾：

```
String s = new String(salt, "UTF-8");
String s = new String(salt, "UTF-16");
String s = new String(salt); 
```

编辑：对于上下文，我正在尝试通过并理解[此](http://www.javacodegeeks.com/2012/05/secure-password-storage-donts-dos-and.html)代码。我正在尝试查看盐和密码，以便我可以使用代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T02:16:28.310

您需要使用[Base64](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html) (Apache Commons) 类或`sun.misc.BASE64Encoder/BASE64Decode`对字节数组进行编码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T03:53:30.940

就像 AVD 所说，解决方案是使用 Base64 编码或其他一些二进制文本编码。（例如，十六进制编码。）

为什么？因为二进制数据不是文本！

您当前所做的是告诉 String 构造函数字节是已正确编码为 UTF-8 或 UTF-16 或（在最后一种情况下）平台的默认编码的文本。这显然是错误的。如果您尝试将随机二进制内容解码为文本，您将看到的“垃圾”。

更糟糕的是，当您将解码过程应用于随机二进制数据时，它**可能是有损的。**例如，如果您尝试将某些字节序列视为 UTF-8，则它们根本无效。`'?'`（UTF-8 的规范是这么说的！）当 UTF-8 解码器看到这些无效序列之一时，它会将其替换为表示“无效字符”的字符（例如 a ）。如果您随后将字符串中的字符转换回字节，您将获得与开始时不同的字节序列。这对您的用例来说可能是一场灾难。

# c++ - 为什么 JSON 对象不是数组？

> ID：11371724
> 
> 赞同：0
> 
> 时间：2012-07-07T02:07:02.417
> 
> 标签：c++, json, arrays

我的 JSON 文件如下所示：

```
{
"strings": {
    "keyone": "abc",
    "keytwo": "def",
    }
} 
```

使用 C++，

```
const Json::Value strings = root["strings"];
for (int index = 0; index < strings.size(); index++) 
{
    std::cout << strings.isArray() << std::endl;
    std::cout << strings.get(index, "ERROR") << std::endl;
} 
```

`strings.IsArray()`返回 0，表示它不是数组。而第二行`strings.get(index, "ERROR)"`，只是在执行时崩溃，可能是因为我不是像数组一样使用它。

所以我假设字符串只是一个字符串而不是数组。我怎样才能使它成为一个数组对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T02:11:50.090

> "strings.IsArray()" 返回 0，表示它不是数组

当然，它`"strings":{ ... }`是 JSON 术语中的“对象”。

# ruby-on-rails - 修改 find_by_sql 的返回值

> ID：11371728
> 
> 赞同：0
> 
> 时间：2012-07-07T02:07:52.587
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-2, ruby-1.8

所以我在这个问题/问题上拉扯我的头发。基本上我使用 find_by_sql 从我的数据库中获取数据。我这样做是因为查询有很多列和表连接，我认为使用 ActiveRecord 和关联会减慢它的速度。

我设法提取数据，现在我想修改返回值。例如，我通过循环遍历结果来做到这一点。

```
a = Project.find_by_sql("SELECT mycolumn, mycolumn2 FROM my_table").each do |project|
  project['mycolumn'] = project['mycolumn'].split('_').first
end 
```

我发现`project['mycolumn']`根本没有改变。

所以我的问题：

是否`find_by_sql`返回数组哈希？是否可以如上所述修改哈希的属性之一的值？

这是代码： http: [//pastie.org/4213454](http://pastie.org/4213454) 。如果你可以看看`summarize_roles2()`那是行动发生的地方。

谢谢你。我使用 Rails 2.1.1 和 Ruby 1.8。由于遗留代码，我无法真正升级。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T04:05:59.020

只需更改上面的方法来访问值，打印项目的值，您就可以清楚地检查对象属性。

> ```
> The results will be returned as an array with columns requested encapsulated as attributes of the model you call this method from.If you call Product.find_by_sql then the results will be returned in a Product object with the attributes you specified in the SQL query.
> If you call a complicated SQL query which spans multiple tables the columns specified by the SELECT will be attributes of the model, whether or not they are columns of the corresponding table. 
> ```

```
Post.find_by_sql "SELECT p.title, c.author FROM posts p, comments c WHERE p.id = c.post_id"
> [#<Post:0x36bff9c @attributes={"title"=>"Ruby Meetup", "first_name"=>"Quentin"}>, ...] 
```

来源：[http ://api.rubyonrails.org/v2.3.8/](http://api.rubyonrails.org/v2.3.8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T13:29:26.457

你有没有尝试过

```
a = Project.find_by_sql("SELECT mycolumn, mycolumn2 FROM my_table").each do |project|
  project['mycolumn'] = project['mycolumn'].split('_').first
  project.save
end 
```

# java - 如何将此代码转换为javacv？

> ID：11371729
> 
> 赞同：2
> 
> 时间：2012-07-07T02:07:53.117
> 
> 标签：java, image-processing, opencv, javacv

我已经阅读了许多教程和指南，并且能够转换其中的一部分。但我不知道如何将最后一行转换为 javacv。那么请有人帮我把这段代码转换成javacv吗？

```
img = cv2.imread('sofud.jpg')

gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)

ret,thresh = cv2.threshold(gray,127,255,1)

contours,hierarchy = cv2.findContours(thresh,cv2.RETR_LIST,cv2.CHAIN_APPROX_SIMPLE)

  for cnt in contours:
    x,y,w,h = cv2.boundingRect(cnt)
    if 10 < w/float(h) or w/float(h) < 0.1:
    cv2.rectangle(img,(x,y),(x+w,y+h),(0,0,255),2) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T05:07:31.957

您可以在 Java CV 中使用最后一行：

```
opencv_core.cvRectangle(image, opencv_core.cvPoint(m,n), opencv_core.cvPoint(i,j), opencv_core.cvScalar(0,0,255,0), thickness, 8, 0); 
```

其中参数的含义：

```
opencv_core.cvRectangle(CvArr* img, CvPoint , CvPoint, CvScalar color, int thickness=1, int lineType=8, int shift=0) 
```

并查看此[链接](http://ganeshtiwaridotcomdotnp.blogspot.in/2012/04/colored-object-tracking-in-java-javacv.html#more)以获取更多信息。

**编辑：**

这是一个寻找轮廓的例子：

```
cvFindContours(grayImage, memory, contours, sizeof(CvContour.class) , CV_RETR_CCOMP, CV_CHAIN_APPROX_SIMPLE, cvPoint(0,0)); 
```

其中参数的意思是：

```
cvFindContours(CvArr* image, CvMemStorage* storage, CvSeq** first_contour, int header_size=sizeof(CvContour), int mode=CV_RETR_LIST, int method=CV_CHAIN_APPROX_SIMPLE, CvPoint offset=cvPoint(0,0) ) 
```

有关参数的更多信息，请查看此链接[部分](http://opencv.itseez.com/modules/imgproc/doc/structural_analysis_and_shape_descriptors.html?highlight=findcontours#findcontours)`FindContours`。

您也可以使用该`cvDrawContours`函数，以与我们使用`cvFindContours`函数相同的方式绘制轮廓。

看看这个[链接](https://stackoverflow.com/questions/9129037/javacv-blob-detection)。这是该网站上的另一篇文章，他们在其中解释了在斑点检测中寻找轮廓的用途。

希望这可以帮助。

# android - OpenGL ES 2.0 (Android) 中的 2D 渲染（特别是矩阵）

> ID：11371734
> 
> 赞同：1
> 
> 时间：2012-07-07T02:09:41.003
> 
> 标签：android, opengl-es-2.0, orthographic

所以我试图渲染两个移动的四边形，每个在不同的位置。我的着色器尽可能简单（顶点仅由模型视图投影矩阵转换，只有一种颜色）。

每当我尝试渲染某些东西时，我只会得到一些颜色！我之前只在 OpenGL 中完成了 3D 渲染的工作，所以我遇到了 2D 的问题。

这是我的基本渲染循环，稍微简化了一点（我正在使用由提供的矩阵操作方法，`android.opengl.Matrix`并且`program`是我创建的一个自定义类，它只是调用`GLES20.glUniformMatrix4fv()`）：

```
Matrix.orthoM(projection, 0, 0, windowWidth, 0, windowHeight, -1, 1);
program.setUniformMatrix4f("Projection", projection); 
```

此时，我渲染四边形（对每个四边形重复此操作）：

```
Matrix.setIdentityM(modelview, 0);
Matrix.translateM(modelview, 0, quadX, quadY, 0);
program.setUniformMatrix4f("ModelView", modelview);
quad.render(); // calls glDrawArrays 
```

我所看到的只是每个四边形的一小部分颜色！我在这里束手无策，我已经尝试了我能想到的一切，我正处于我对着我的电脑尖叫并在房间里扔手机的地步。有人有任何指示吗？我使用 Ortho 错误吗？我 100% 确定我以 Z 值为 0 渲染所有内容。我尝试使用`frustumM`而不是`orthoM`，这样我就可以看到四边形，但只要它们移动它们就会完全倾斜，如果我这样做是有道理的正确理解截锥体的工作方式（无论如何，它更适用于 3D 渲染）。

如果有什么不同，我定义了我的视口

```
 GLES20.glViewport(0, 0, windowWidth, windowHeight); 
```

传递给 orthoM 的值在哪里`windowWidth`和是相同的`windowHeight`

*编辑：*可能值得注意的是，这些`android.opengl.Matrix`方法将偏移量作为第二个参数，以便可以将多个矩阵推入一个数组中，这就是第一个`0`的用途

*另一个编辑：*作为参考，这是我的顶点着色器代码：

```
uniform mat4 ModelView;
uniform mat4 Projection;

attribute vec4 vPosition;

void main() {
    mat4 mvp = Projection * ModelView; 
    gl_Position = vPosition * mvp;
} 
```

*另一个编辑：*我尝试交换`Projection * ModelView`，`ModelView * Projection`但现在我得到了一些非常时髦的形状......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:04:12.460

I posted this over on gamedev.stackexchange.com and figured it out, [here s a link](https://gamedev.stackexchange.com/questions/31821/2d-rendering-with-opengl-es-2-0-on-android-matrices-not-working)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T05:31:02.887

mvp 应该是 Proj*ModelView 你有它。

gl_Position 应该是 mvp * vPosition，而不是您在代码中显示的其他方式。

如果这不能解决问题，您能否更好地描述问题（图片可能会有所帮助）？还可以考虑发布更多您的 opengl 代码，以防出现错误。您发布的所有其余代码对我来说都很好。

# javascript - 当正则表达式匹配空字符串时，是否可以使用 regexp.exec 循环模拟 string.match ？

> ID：11371735
> 
> 赞同：3
> 
> 时间：2012-07-07T02:09:42.650
> 
> 标签：javascript, regex, string, match

众所周知，RegExps 中的 exec 方法可以用来查找字符串中的所有匹配项。但是，我刚刚发现，如果正则表达式与空字符串匹配，则此循环可能会永远卡住

```
var s = '1234'
var r = /()/g;
var m;
var i = 0;
while( (m = r.exec(s)) ){
   console.log(i, m[0]);
   if(++i >= 50){ console.log("infinite loop!"); break }
} 
```

真正奇怪的是普通的 string.match 方法不会卡住：

```
'1234'.match(/()/g) // Gives ["", "", "", "", "", ""] 
```

我想知道如何将 match 方法定义为与 exec 循环不同的工作方式。到目前为止，我发现避免像 match 方法那样卡住的唯一方法是在一个可怕的 hack 中滥用 string.replace 方法：

```
var matches = [];
'1234'.replace(/()/g, function(m){ matches.push(m) }); 
```

**所以我的问题是：**

当正则表达式匹配空字符串时，匹配和替换如何返回有限结果？我可以使用相同的技术来避免陷入 exec 循环吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T02:18:07.463

一个（棘手的）解决方案是确保它与上次不在同一个地方：

```
var s = '1234'
var r = /()/g;
var m;
var i = 0;
var lastPosition = -1;

while(m = r.exec(s)) {
    if(m.index === lastPosition) {
        r.lastIndex++;
        continue;
    }

    lastPosition = m.index;

    console.log(i, m[0]);
} 
```

# opencv - 如何在 OpenCV 2.4.2 中使用 CV::EM 类？

> ID：11371737
> 
> 赞同：2
> 
> 时间：2012-07-07T02:09:49.340
> 
> 标签：opencv

有一个关于如何在最新的 OpenCV 2.4.2 中使用 EM 算法的问题。我曾经使用 C 版本，它工作得非常好，但自从系统升级以来，似乎 C API 已在 OpenCV 2.4.2 中删除。

这是 EM 的一个简单案例：假设我有一个被认为来自两种球的半径列表，并且我想估计这两种类型的均值/方差。换句话说，这是一个一维问题。

我尝试使用新的 API 编写 EM 的 C++ 版本，但还没有工作。

```
int nsamples = radius_list.size();
int ncluster = 2;                 //we assume a bimodal model
Mat samples = Mat::zeros(nsamples, 1, CV_32FC1);

// init data
for (int i = 0; i < radius_list.size(); ++i) {
    int value = radius_list[i];
    samples.at<float>(i, 0) = value;
}
EM em_model = EM(ncluster, EM::COV_MAT_SPHERICAL);

if (!em_model.train(samples)) {
    cerr << "error training the EM model" << endl;
    exit(-1);
}

const Mat& means = em_model.get<Mat>("means");
int mean1 = means.at<float>(0, 0);
int mean2 = means.at<float>(1, 0);
cout << "mean1 = " << mean1 << ", mean2 = " << mean2 << endl;

const vector<Mat>& covs  = em_model.get<vector<Mat> >("covs");
int scale1 = covs[0].at<float>(0, 0);
int scale2 = covs[1].at<float>(0, 0);
cout << "scale1 = " << scale1 << ", scale2 = " << scale2 << endl; 
```

问题是：虽然 if() 没有抱怨，但检索到的平均值和比例值是垃圾值，在我的机器上是 -2147483648。

请告知如何修改代码以使其工作。我仍在学习 OpenCV 中的各种 C++ API。

谢谢你们！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T11:51:30.930

您进行隐式类型转换会分散编译器的注意力。均值、权重和协方差矩阵不是整数，而是双精度数（您可以通过将 Mat.depth() 结果打印到屏幕上来检查），因此将所有行从：

```
int mean1 = means.at<float>(0, 0); 
```

喜欢代码：

```
double mean1 = means.at<double>(0, 0); 
```

问候， 拉法尔

# wso2 - 如何在 WSO2 ESB 4.0.3 中访问 HTTPServletRequest 对象

> ID：11371744
> 
> 赞同：0
> 
> 时间：2012-07-07T02:12:13.070
> 
> 标签：wso2, wso2esb

我正在查看[http://wso2.org/forum/thread/10508](http://wso2.org/forum/thread/10508)，它解释了如何获取 HTTPServletRequest。它解释说，如果您有“org.wso2.carbon.core.transports.http.*”请求，那么只有您可以获得 HTTPServletRequest 对象。如前所述，我确实更改了axis2.xml 以更改传输并且它起作用了。但后来因为“org.apache.synapse.transport.nhttp”。(NIO) trnasport 非常快，如果我这样做，我将失去性能。

有没有办法保留 NIO 传输处理程序（“org.apache.synapse.transport.nhttp.”）并获取 HTTPServletRequest 对象？

如果我能得到答案，我将不胜感激。所有身份验证都是通过现有数据服务中的 cookie 完成的，公司不想改变它。

谢谢阿比吉特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T06:23:58.603

这是不可能的。NIO 传输不是 servlet，它不支持 http 会话等。但是对于新的 wso2 服务器版本，我们已经升级了 tomcat 版本，因此即使是普通的 http 传输也使用 NIO 下划线。

我认为您需要进行性能比较并查看最新版本。

# cryptography - 强制门户认证理论

> ID：11371747
> 
> 赞同：3
> 
> 时间：2012-07-07T02:12:27.520
> 
> 标签：cryptography

我对强制门户身份验证的工作方式有点困惑。在一些实现中，在用户通过登录页面进行身份验证后，他们的 IP 和 MAC 地址被列入白名单并允许通过网关进行连接。显然，这存在人们欺骗 MAC 地址以获得访问权限的问题。如果门户在自己和客户端之间建立了会话，这是否意味着客户端从互联网请求的每一条流量都必须通过门户的服务器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T02:35:36.613

通常，强制门户中的安全性并不被认为特别重要。但是，有些解决方案会将 MAC 锁定到第一个端口以使用它，并禁止在任何其他端口上使用该 MAC。可以无线使用类似的技术，其中 AP 将拒绝与使用与现有客户端相同的 MAC 地址的其他客户端配对。这需要企业身份验证，其中为每个连接的设备协商一个唯一密钥。

我不清楚您所说的“门户服务器”是什么意思。但是一般来说，一旦MAC地址被授权并且有线端口被配置或者无线连接被建立，门户网站就不需要再做任何事情了。经过身份验证的连接的流量只是正常路由/NATted。

# java - 尝试使用抽象数据类型 - 如何通过继承调用方法

> ID：11371748
> 
> 赞同：0
> 
> 时间：2012-07-07T02:12:38.603
> 
> 标签：java, abstract-data-type, rational-numbers

我正在尝试测试我的抽象类，但是当我从测试类调用方法时遇到了问题。自从我使用 Java 以来已经有一段时间了，我以前没有使用过抽象类。任何关于我哪里出错的指示将不胜感激。谢谢。

抽象类

```
public abstract class RationalNumbers {

    public int numerator, denominator, temp;

    public void setNumerator(int n) {
        numerator = n;
    }

    public void setDenominator(int d) {
        denominator = d;
    }

    public int getNumerator() {
        return numerator;
    }

    public int getDenominator() {
        return denominator;
    }

    public int add() {
        temp = numerator + denominator;
        return temp;
    }

    public int subtract() {
        temp = numerator - denominator;
        return temp;
    }

    public int multiply() {
        temp = numerator * denominator;
        return temp;
    }

    public int divide() {
        temp = numerator / denominator;
        return temp;
    }

   public boolean isEqual() {
        boolean isEqual;
        if (numerator == denominator) {
            isEqual = true;
        } else {
            isEqual = false;
        }
        return isEqual;
    }
} 
```

测试类

```
public class testClass extends RationalNumbers {

    public static void main(String[] args) {
        setNumerator(5);
        setDenominator(10);
        System.out.println("Equal: " + isEqual());
        System.out.println("Numerator: " + getNumerator());
        // etc...
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T02:18:52.440

很抱歉告诉您这一点，但是您为有理数创建抽象的尝试在各方面都是错误的。*这根本*不正确。这些方法都不是正确的：加法、减法、乘法、除法、isEqual - 都是完全不正确的。

你不想覆盖`equals()` -*和* `hashCode()`吗？是什么让你认为这`isEqual()`是个好主意？

查看[此](http://introcs.cs.princeton.edu/java/92symbolic/Rational.java.html)示例以了解如何正确执行此操作。

# ruby-on-rails - Sinatra on Rails '/' 映射

> ID：11371753
> 
> 赞同：1
> 
> 时间：2012-07-07T02:13:26.147
> 
> 标签：ruby-on-rails, routes, sinatra

我可能遗漏了一些东西，但是如何在 Rails 中映射“/”来执行 Sinatra 应用程序？我有：

```
class Core < Sinatra::Base

 get '/' do
  "This is root but it is caput."
 end

 get '/test' do
  "This is test and it works"
 end

end 
```

所以如果我这样做路由：

```
match '/test' => Core
match '/'=>Core 
```

只有 '/test' 触发 Sinatra 应用程序 '/' 运行 Rails。实际上我希望每条路线都由 Sinatra 应用程序处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T11:20:08.650

您只需`index.html`要从`public`文件夹中删除。

您可以安装整个应用程序，`mount Core, :at => '/'`以便让 Sinatra 完成所有路由。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T04:00:02.560

鉴于 Sinatra 创建了一个用于定义路由的 DSL（不能作为方法直接访问），您可能需要添加一个辅助方法，以便您可以专门调用该路由：即

```
 def launch_sinatra_app
    status, headers, body = call env.merge("PATH_INFO" => '/')
    [status, headers, body.map(&:upcase)] # proper rack response
  end 
```

然后在 config/routes.rb 中用于 rails：

```
match :root => 'Core#launch_sinatra_app' 
```

# java - ClickJacking 过滤器添加 X-FRAME-OPTIONS 作为响应

> ID：11371755
> 
> 赞同：8
> 
> 时间：2012-07-07T02:15:33.197
> 
> 标签：java, jakarta-ee, servlet-filters

为了解决 clickJacking 和阻止我的网站被 iframe 打开的问题，我创建了一个 servlet 过滤器，我在其中添加以下行以添加“X-FRAME-OPTIONS”响应标头。但是当我运行页面并查看该页面的响应标头时，我永远不会在其中获得该标头。任何想法为什么？

```
public void doFilter(
        ServletRequest request, ServletResponse response, FilterChain chain
        ) throws IOException, ServletException
    {

        HttpServletResponse res = (HttpServletResponse)response;
        chain.doFilter(request, response);

        //Specify the mode
        res.addHeader("X-FRAME-OPTIONS", "DENY");
    } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-07T02:56:23.160

您需要在调用之前添加标题`doFilter`。到时间控制从`doFilter`标题和正文返回时已经发送，所以你的`addHeader`被忽略了。

# html - 将图像放在 div 后面

> ID：11371760
> 
> 赞同：0
> 
> 时间：2012-07-07T02:16:24.537
> 
> 标签：html, css

我正在尝试使用“z-index”将图像（竹子）放在 div（联系表）后面。

但是，图像正在将 div 推开。

页面可以在这里看到：[http ://www.abijahchristos.com/sample/springspa](http://www.abijahchristos.com/sample/springspa)

JsFiddle在这里：http: [//jsfiddle.net/Abijah/4n9LZ/](http://jsfiddle.net/Abijah/4n9LZ/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T02:20:31.837

你可以使用背景属性来做到这一点。

试试这个你不需要z-index

```
.copy_right {
    background: url("../images/bamboo1.png") repeat scroll 0 0 transparent;
    border: 2px solid #CCCCCC;
    border-radius: 4px 4px 4px 4px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    float: left;
    height: 310px;
    margin: 0 25px 0 30px;
    padding: 5px 0 0;
    width: 310px;
    z-index: 2;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T02:23:03.613

在 CSS 中使用背景图像是有效的解决方案，但只是以防万一您不希望使用以下背景。

在绝对位置的情况下，您需要一个具有相对位置的容器，否则它将基于主体左上角定位。

```
.copy_right {
position:absolute;
top:0;
width: 310px;
height: 310px;
border: 2px solid #CCC;
margin: 0 25px 0 30px;
padding: 5px 0 0 0;
border-radius: 4px;
-moz-border-radius: 4px;
-webkit-border-radius: 4px;
-webkit-box-shadow: rgba(0, 0, 0, 0.3) 0 3px 10px;
-moz-box-shadow: rgba(0,0,0,0.3) 0 3px 10px;
box-shadow: rgba(0, 0, 0, 0.3) 0 3px 10px;
z-index: 2;
}

#bamboo {
position: absolute;
z-index: 1;
right: -17px;
top: 0;
} 
```

# jquery - 即使哈希没有改变，jQuery地址哈希更改也会触发

> ID：11371765
> 
> 赞同：4
> 
> 时间：2012-07-07T02:17:40.323
> 
> 标签：jquery, hash, hashchange

我正在使用这个插件[http://www.asual.com/jquery/address/](http://www.asual.com/jquery/address/)来检测我的网站的哈希变化等，它只使用它来导航，所以它是用户体验的重要组成部分。现在，这非常适合我用它做的所有事情，除了如果哈希没有更改/与单击的最后一个哈希 url 没有什么不同，它不会触发事件，例如，如果我在示例中。 com/home 并再次单击主页图标，它不会再次重新加载页面，就像您只是使用常规链接一样。我无法弄清楚如何为作为 url 一部分的所有链接实现这一点。（不仅仅是所有标签，因为我使用标签而不是导航部分。所以任何帮助都会很棒，谢谢。

```
$.address.change(function(event){  
 ///events to be triggered on hash change
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T02:24:18.243

onhashchange 事件被恰当地命名，它仅在哈希更改时触发。

对于这个问题，我知道的唯一解决方案是将相同的函数绑定到主页图标的单击事件。

此外，jQuery 为哈希更改提供了自己的事件：

```
$(window).on("onhashchange", function (e) {
     route();
})
$(".icon").on("click", function(e) {
     location.hash == "#/" ? route(): null;
}) 
```

此外，如果这些是标签，例如，在#nav div 中：

```
$("#nav").delegate("a", "click", function () {
     location.hash == this.href ? route() : null;
}) 
```

或者这可以只应用于所有标签：

```
$("a").on("click", function () {
     location.hash == this.href ? route() : null;
}) 
```

# multithreading - 并行收集处理的应用程序设计

> ID：11371766
> 
> 赞同：2
> 
> 时间：2012-07-07T02:17:40.887
> 
> 标签：multithreading, c#-4.0, concurrency

我正在试验 System.Collections.Concurrent 命名空间，但我在实现我的设计时遇到了问题。

1.  我的输入队列（ConcurrentQueue）正在从一个线程很好地填充，该线程在启动时执行一些 I/O 以读取和解析。
2.  接下来，我在输入队列上启动 Parallel.ForEach()。我正在对每个项目进行一些 I/O 绑定工作。
3.  为 ForEach() 中处理的每个项目创建一个日志项目，并将其放入结果队列中。

我想做的是开始记录我开始阅读输入，因为我可能无法将所有日志项都放在内存中。等待项目进入结果队列的最佳方式是什么？是否有我应该查看的设计模式或示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T05:47:06.713

我认为您正在寻找的模式是[生产者/消费者模式](http://en.wikipedia.org/wiki/Producer-consumer_problem)。更具体地说，您可以[围绕 TPL 和 BlockingCollection 构建生产者/消费者实现](http://blogs.msdn.com/b/csharpfaq/archive/2010/08/12/blocking-collection-and-the-producer-consumer-problem.aspx)。

您要阅读的主要概念是：

1.  [任务](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.aspx)，
2.  [阻塞集合](http://msdn.microsoft.com/en-us/library/dd997371.aspx)，
3.  [TaskFactory.ContinueWhenAll](http://msdn.microsoft.com/en-us/library/dd321473.aspx)（将允许您在一组任务/线程完成运行时执行一些操作）。
4.  BlockingCollection 中的边界和[阻塞](http://msdn.microsoft.com/en-us/library/dd997371.aspx)。这允许您为输出集合设置最大大小（出于内存原因），如果达到您指定的最大大小，生产者线程将等待消费者拾取元素。
5.  [BlockingCollection.CompleteAdding](http://msdn.microsoft.com/en-us/library/dd287086.aspx)和[BlockingCollection.IsCompleted](http://msdn.microsoft.com/en-us/library/dd267315.aspx)可用于同步生产者和消费者（生产者可以说何时完成，消费者可以检查并继续运行，直到生产者完成）。

我链接的第二篇文章中有一个更完整的示例。

在您的情况下，我认为您希望消费者从结果队列中取出东西并尽快处理它们（将它们写入日志存储或类似存储）。

因此，您转储日志项的最终集合应该是 a `BlockingCollection`，而不是 a `ConcurrentQueue`。

# android - Android：根视图的快照（使用 ActionBar）

> ID：11371777
> 
> 赞同：2
> 
> 时间：2012-07-07T02:20:02.943
> 
> 标签：android, android-activity

我曾经通过`content`查看并绘制活动来捕捉活动的位图：

```
View view = activity.findViewById(android.R.id.content)

Bitmap bitmap = Bitmap.createBitmap(
    view.getWidth(), view.getHeight(), Config.ARGB_8888
);

view.draw(new Canvas(bitmap)); 
```

现在我正在使用一个 ActionBar，它没有嵌套在`content`视图下，所以它被忽略了。如何获得**真正的**根视图？或者以其他方式使用操作栏拍摄照片，如果这是不可能的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T02:30:53.057

要获取包括 ActionBar 在内的整个窗口的位图，您可以使用 DecorView。

1.  首先您需要启用绘图缓存

    ```
    getWindow().getDecorView().setDrawingCacheEnabled(true); 
    ```

2.  获取位图

    ```
    Bitmap bmp = getWindow().getDecorView().getDrawingCache(); 
    ```

3.  在其他地方使用位图，我用 ImageView 试试这个，效果很好。

4.  禁用绘图缓存

    ```
    getWindow().getDecorView().setDrawingCacheEnabled(false); 
    ```

# windows-phone-7 - 阻止来电者名单

> ID：11371779
> 
> 赞同：-1
> 
> 时间：2012-07-07T02:20:25.280
> 
> 标签：windows-phone-7

是否有可能创建一个程序，让我阻止来自我可以保存在列表中的号码的呼叫如果在当前版本中不可能，是否有任何消息是否可能在今年晚些时候发布的下一个版本中得到支持任何要阅读的信息的链接将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T07:15:39.207

不，Windows Phone 不允许第三方应用程序在后台运行（允许限制性多任务处理），也不允许应用程序干扰手机本身。

如果没有适用于 WP8 的 SDK，就无法告诉您这种情况是否已经改变。

# javascript - jquery appendTo 多个项目到一个容器

> ID：11371782
> 
> 赞同：0
> 
> 时间：2012-07-07T02:21:03.037
> 
> 标签：javascript, jquery

我在让它工作时遇到问题。当我在 firebug 中查看 HTML 时，它显示我的容器中有 2 个对象，但只有 1 个 img 显示！

我有一些非常简单的代码：

```
var img1 = $("<img />", {src : "myimg.png" });
var img2 = $("<img />", {src : "myimg2.png" });
img1.appendTo("#div");
img2.appendTo("#div");

<div id="div"></div> 
```

但只有第一张图片会显示，如果我注释掉第一`appendTo`张图片，那么第二张图片就会显示，或者如果我颠倒顺序，第二张图片会显示，而不是第一张。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T04:13:29.790

我可以向您展示如何使用本机 javascript 附加元素吗？它更快且语法非常相似。另外，它会让你成为一个更好的程序员。

首先，如果您还没有，请检查 javascript 模板。我个人使用[http://handlebarsjs.com/](http://handlebarsjs.com/)。

无论如何，这里是如何用 javascript 做你想做的事。

```
var parentElement = document.getElementById("div");
var fragment = document.createDocumentFragment(); 

["myimg.png", "myimg2.png"].forEach(function(src) {
 var element = document.createElement("img");
 element.src = src;
 fragment.appendChild(element);
}); 

parentElement.appendChild(fragment); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T02:39:59.480

这实际上与 appendTo 无关，而是与我的`#div`和图像大小有关。奇怪的。

# eclipse - 如何在带有 Mingw 的 Goclipse 中使用 cgo？

> ID：11371783
> 
> 赞同：4
> 
> 时间：2012-07-07T02:21:20.067
> 
> 标签：eclipse, eclipse-plugin, mingw, go, cgo

当我尝试使用 cgo 时出现错误

exec gcc: exec: "gcc": 在 %PATH% 中找不到可执行文件

我已经安装了Mingw。我如何告诉 Goclipse gcc 在哪里？我无法在首选项或属性中找到设置它的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T04:20:34.150

将 MinGW gcc 的路径添加到您的 Windows PATH 环境变量中。

[Windows下设置环境变量](http://golang.org/doc/install#windows_env)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-08T09:34:40.957

我遇到了同样的问题，只是想补充一点，您特别需要将MinGW的**bin 目录的路径添加到您的 PATH 环境变量中。**就像是：

`C:\Program Files\mingw-w64\x86_64-7.1.0-posix-seh-rt_v5-rev0\mingw64\bin`

没有足够的声誉来发表评论，所以这是一个答案。

# ruby-on-rails - 模型单复数名称相同（例如设备、物种）时，rails 链接路径和路由错误

> ID：11371792
> 
> 赞同：4
> 
> 时间：2012-07-07T02:23:12.987
> 
> 标签：ruby-on-rails, ruby-on-rails-3

```
<%= link_to t('.new', :default => t("helpers.links.new")), new_equipment_path, :class => 'btn btn-primary' %> 
```

我在视图中有上面的代码，但是在单击链接时出现以下错误：`No route matches {:action=>"show", :controller=>"equipment"}`

我的路线文件包含：

```
resources :equipment

resources :workouts

match ':controller(/:action(/:id))(.:format)' 
```

为什么要尝试访问 show 操作？

以下是我的路线中的条目：

```
 equipment_index GET        /equipment(.:format)                   equipment#index
                   POST       /equipment(.:format)                   equipment#create
     new_equipment GET        /equipment/new(.:format)               equipment#new
    edit_equipment GET        /equipment/:id/edit(.:format)          equipment#edit
         equipment GET        /equipment/:id(.:format)               equipment#show
                   PUT        /equipment/:id(.:format)               equipment#update
                   DELETE     /equipment/:id(.:format)               equipment#destroy 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T09:14:03.327

**这个问题之前已经[出现过，](http://comments.gmane.org/gmane.comp.lang.ruby.rails/237541)**并且与 rails 脚手架如何为具有单复数名称的模型生成 new.html.erb 文件有关。

如果您检查`form_for`new.html.erb 文件中的 ，您将`equipment_path`在底部的 link_to 中看到。对于这些具有单数==复数名称的模型，它指的是实际用于`show`操作的路线，因此您的错误消息。

建议通常是“尽可能避免使用这样的模型名称”，或者它涉及到 config/initializers/inflections.rb 文件的一些混乱，以强制使用复数版本的模型名称。当然，你最终会得到一个听起来很奇怪的模型引用的应用程序：“设备”不是很好用（以后有人会“修复”它，又把事情搞砸了）。

为了保持模型名称语法正确，您需要修复 form_for 即：

`<% form_for(@equipment, :url=> {:action=>'create'}) do |f| %>`

和link_to：

`<%= link_to 'Back', equipment_index_path %>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T13:24:51.030

您是否尝试`equiment`在您的**routes.rb**中添加“s” ？

```
resources :equipments 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-04T19:50:35.287

由于设备被认为是不可数名词，您应该能够使用变形来解决这个问题。

关于变形的 Rails[文档](http://api.rubyonrails.org/classes/ActiveSupport/Inflector/Inflections.html)实际上使用设备作为其示例的一部分。

将以下内容添加到您的`config/initializers/inflections.rb`.

```
ActiveSupport::Inflector.inflections do |inflect|
  inflect.uncountable 'equipment'
end 
```

附加信息：[Rails 3 资源路由中的不可数名词](http://markembling.info/2011/06/uncountable-nouns-rails-3-resource-routing)

# iphone - 在视图之间传递数据时出错

> ID：11371793
> 
> 赞同：-1
> 
> 时间：2012-07-07T02:23:31.023
> 
> 标签：iphone, xcode, uitableview, segue

> **可能重复：**
> [在表格视图中选择后如何将数据传递到详细视图？](https://stackoverflow.com/questions/7562258/how-to-pass-data-to-detail-view-after-being-selected-in-a-table-view)

我正在使用 plist（字典数组）来填充表格视图。现在，当我按下一个单元格时，我想通过 segue 将 reprecented 字典传递给详细视图。填充表格视图可以正常工作，但是如何将相同的值发送到详细视图？这是我的尝试：

```
#import "WinesViewController.h"
#import "WineObject.h"
#import "WineCell.h"
#import "WinesDetailViewController.h"

@interface WinesViewController ()

@end

@implementation WinesViewController

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

}

- (void)viewDidUnload
{
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (void)viewWillAppear:(BOOL)animated {
    wine = [[WineObject alloc] initWithLibraryName:@"Wine"];
    self.title = @"Vinene";
    [self.tableView deselectRowAtIndexPath:[self.tableView indexPathForSelectedRow] animated:YES];
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    return [wine libraryCount];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"wineCell";

    WineCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Configure the cell...

    cell.nameLabel.text = [[wine libraryItemAtIndex:indexPath.row] valueForKey:@"Name"];
    cell.districtLabel.text = [[wine libraryItemAtIndex:indexPath.row] valueForKey:@"District"];
    cell.countryLabel.text = [[wine libraryItemAtIndex:indexPath.row] valueForKey:@"Country"];
    cell.bottleImageView.image = [UIImage imageNamed:[[wine libraryItemAtIndex:indexPath.row] valueForKey:@"Image"]];
    cell.flagImageView.image = [UIImage imageNamed:[[wine libraryItemAtIndex:indexPath.row] valueForKey:@"Flag"]];
    cell.fyldeImageView.image = [UIImage imageNamed:[[wine libraryItemAtIndex:indexPath.row] valueForKey:@"Fylde"]];
    cell.friskhetImageView.image = [UIImage imageNamed:[[wine libraryItemAtIndex:indexPath.row] valueForKey:@"Friskhet"]];
    cell.garvesyreImageView.image = [UIImage imageNamed:[[wine libraryItemAtIndex:indexPath.row] valueForKey:@"Garvesyre"]];

    return cell;
}

#pragma mark - Table view delegate

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    if ([[segue identifier] isEqualToString:@"DetailSegue"]) {

        NSIndexPath *selectedRowIndex = [self.tableView indexPathForSelectedRow];
        WinesDetailViewController *winesdetailViewController = [segue destinationViewController];
        //Here comes the error line:
        winesdetailViewController.winedetailName = [wine objectAtIndex:indexPath.row] valueForKey:@"Name"];
    }
} 
```

我收到一个错误：

```
winesdetailViewController.winedetailName = [wine objectAtIndex:indexPath.row] valueForKey:@"Name"]; 
```

使用未声明的标识符：indexPath。你是说 NSIndexPath 吗？我想我在这里错过了一些重要的事情..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T03:06:14.367

而不是`indexPath.row`（它在这个函数中不存在，就像它在`tableView:cellForRowAtIndexPath:`作为参数传递的函数中一样）使用`selectedRowIndex`如下：

```
 winesdetailViewController.winedetailName = [wine objectAtIndex:selectedRowIndex.row] valueForKey:@"Name"]; 
```

或者，更好的是，将您的详细视图控制器更改为只接受整个字典，传递字典，并让它设置自己的值：

```
 winesdetailViewController.winedetail = [wine objectAtIndex:selectedRowIndex.row]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T03:07:01.890

错误是正确的，那里没有`indexPath`定义变量。但是，仅在您定义的那条线上方几行`selectedRowIndex`可能具有您所追求的值。

# javascript - if else on javascript 具有选择框的值（纯 javascript）

> ID：11371796
> 
> 赞同：1
> 
> 时间：2012-07-07T02:23:53.033
> 
> 标签：javascript, onchange, selectedindex

我正在处理一个包含图像而不是文本的选择框（在背景上使用 css）。

```
<script type="text/javascript">
function onChange(element) {
element.style.backgroundColor = "Yellow";
element.className = "on_change";
}
</script>

<select onchange="onChange(this);">
<option value="1" style="background: url(/one.png) no-repeat scroll 0 0 transparent; width:32px; height:32px;"></option>
<option value="2" style="background: url(/two.png) no-repeat scroll 0 0 transparent; width:32px; height:32px;"></option>
<option value="3" style="background: url(/three.png) no-repeat scroll 0 0 transparent; width:32px; height:32px;"></option>
</select> 
```

问题是如何获取所选选项的值，如果是 1 设置一个图像，如果是两个，则使用纯 JavaScript（无 jQuery）将另一图像设置为背景？

我知道这`selectedIndex`是我的问题的关键，但我不知道如何使用它或如何在`if else`声明中使用它。

上面的脚本只是我的试验之一，我实际上使用上面的脚本来执行相同的任务。

```
<select onchange="this.style.backgroundColor=this.options[this.selectedIndex].style.backgroundColor; this.style.color=this.options[this.selectedIndex].style.color"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T03:09:18.020

这是工作示例。[http://codebins.com/codes/home/4ldqpb9](http://codebins.com/codes/home/4ldqpb9)

您不需要 if else，只需根据 selectedIndex 更改背景图像。

```
function onChange(obj) {
    obj.style.backgroundImage = obj.options[obj.selectedIndex].style.backgroundImage
} 
```

# php - 在 PHP 中获取和删除数组的第一个元素

> ID：11371797
> 
> 赞同：7
> 
> 时间：2012-07-07T02:24:01.890
> 
> 标签：php, arrays, get

您好我正在编写一个系统，我需要一个函数来获取和删除数组的第一个元素。这个数组有数字，即

0,1,2,3,4,5

我怎样才能遍历这个数组，每次通过获取值，然后从数组中删除它，所以在 5 轮结束时，数组将为空。

提前致谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-07T02:25:42.773

您可以[`array_shift`](http://php.net/array_shift)为此使用：

```
while (($num = array_shift($arr)) !== NULL) {
  // use $num
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-07T09:01:44.833

您可以尝试使用 foreach/unset，而不是 array_shift。

```
$array = array(0, 1, 2, 3, 4, 5);

foreach($array as $value)
{
    // with each pass get the value
    // use method to doSomethingWithValue($value);
    echo $value;
    // and then remove that from the array 
    unset($array[$value]);
}
//so at the end of 6 rounds the array will be empty
assert('empty($array) /* Array must be empty. */');
?> 
```

# jquery - 将鼠标悬停在不透明菜单上

> ID：11371803
> 
> 赞同：1
> 
> 时间：2012-07-07T02:26:04.967
> 
> 标签：jquery, html, css, jquery-animate, viewport

这是我的精美菜单。

```
 <script type="text/javascript">

        $('#brand_logo').bind('inview', function(event, visible) {
            if (visible == true) {
                // console.log("visible");
                $("#topnav").animate({
                    opacity: 1.0
                });
                // $(".head-wrap-left").hide();
            } else {
                // console.log("invisible");

                $("#topnav").animate({
                    opacity: 0.6
                });
                // $(".head-wrap-left").show();
            }
        }); 

        </script>​ 
```

只有一个问题。如果用户重新加载页面并且元素不在视口中，则默认为 1.0 不透明度。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T03:03:37.300

你试过绑定inview和mouseenter吗？像这样：

```
 $('#brand_logo').bind('inview mouseenter', function(event, visible) {..} 
```

您不需要使用 .find 如果它在刷新或加载时位于视口中，则应该触发您的 inview 事件。

# javascript - 这段代码查找 heightInInches 有什么问题？

> ID：11371804
> 
> 赞同：0
> 
> 时间：2012-07-07T02:26:06.637
> 
> 标签：javascript, ios, titanium

点击后，计算出来的BMI显示为0.3；预期答案是 22.8

有问题的代码片段：

```
calculateButton.addEventListener('click', function() {
    var feet = feetField.value;
    var inches = inchesField.value;
    var heightInInches = (feet * 12) + inches;
    bmiDisplay.text = ((weightField.value / (heightInInches * heightInInches)) * 703).toFixed(1);
}); 
```

heightInInches 应该等于 68，**而不是 608**。似乎以某种方式将英尺 (5) 乘以**120**而不是 12，然后在最后加上英寸 (8)，但我不太明白为什么会发生这种情况，以及为什么当我通过代码？

调试器在公式中显示正确的**英尺**(5) 和**英寸**(8) 值，但在计算后分配给**heightInInches**的值不正确。

[链接到 BMI 公式](http://www.bmi-calculator.net/bmi-formula.php/ "链接到 BMI 公式")

我想我正确地格式化了问题；长时间的听众，第一次来电。我只是盯着它太久了......我有我的 UI 和调试器的屏幕截图，但我不得不从帖子中删除这些图像。好的，感谢您查看。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T02:29:01.500

`inches`是一个字符串，所以当您使用 + 运算符时，它会将其连接起来。你可以简单地做

```
var heightInInches = (feet * 12) + inches*1; 
```

它会将其视为一个数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T02:28:29.403

尝试添加：

```
var feet = parseFloat(feetField.value);
var inches = parseFloat(inchesField.value); 
```

# python - Python Tkinter：删除字符串的最后一个字符

> ID：11371805
> 
> 赞同：5
> 
> 时间：2012-07-07T02:26:08.013
> 
> 标签：python, tkinter, tkinter-entry

我正在制作一个只允许输入数字的条目。如果该字符不是整数，我目前坚持删除刚刚输入的字符。如果有人将“空白”替换为需要进入的内容，那将有很大帮助。

```
import Tkinter as tk

class Test(tk.Tk):

    def __init__(self):

        tk.Tk.__init__(self)

        self.e = tk.Entry(self)
        self.e.pack()
        self.e.bind("<KeyRelease>", self.on_KeyRelease)

        tk.mainloop()

    def on_KeyRelease(self, event):

        #Check to see if string consists of only integers
        if self.e.get().isdigit() == False:

            self.e.delete("BLANK", 'end')#I need to replace 0 with the last character of the string

        else:
            #print the string of integers
            print self.e.get()

test = Test() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T02:28:18.210

您也可以将上面的行更改为：

```
 if not self.e.get().isdigit():
        #take the string currently in the widget, all the way up to the last character
        txt = self.e.get()[:-1]
        #clear the widget of text
        self.e.delete(0, tk.END)
        #insert the new string, sans the last character
        self.e.insert(0, txt) 
```

或者：

```
if not self.e.get().isdigit():
     #get the length of the string in the widget, and subtract one, and delete everything up to the end
     self.e.delete(len(self.e.get)-1, tk.END) 
```

为我们提供了一个工作示例供我们使用，这有助于加快这一进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T13:02:45.720

如果您正在执行数据验证，您应该使用条目小部件的内置功能，特别是`validatecommand`和`validate`属性。

有关如何使用这些属性的描述，请参见此[答案](https://stackoverflow.com/a/4140988/7432)。

# windows - VB.NET No 这样的主机是已知的 IP Grabber

> ID：11371810
> 
> 赞同：0
> 
> 时间：2012-07-07T02:27:12.593
> 
> 标签：windows, vb.net

我的程序抓取主机特定子域的 IP。如果其中一个不存在，则会给出错误提示：No such Host Is Known。我怎样才能让它将 lblDirect 中的文本替换为“未找到”而不是给出错误。

```
Dim dHostname As IPHostEntry = Dns.GetHostEntry("direct." + TextBox1.Text)
Dim dip As IPAddress() = dHostname.AddressList
lblDirect.Text = dip(0).ToString 
```

是我用来获取 IP 的代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T05:42:52.383

使用[Try...Catch](http://msdn.microsoft.com/en-us/library/fk6t46tz%28v=VS.80%29.aspx)处理错误并在**catch**部分设置标签值。

# javascript - 使用 JavaScript 从外部站点解析 json

> ID：11371812
> 
> 赞同：2
> 
> 时间：2012-07-07T02:27:49.563
> 
> 标签：javascript, jquery, ajax, json, google-chrome-extension

我正在尝试在外部站点上解析一些 json，但我遇到了麻烦。它必须与 JavaScript 或 JQuery 一起使用，因为它适用于 chrome 扩展。言归正传：我需要使用 json {"_visitor_alertsUnread":"0"} 从外部 URL 获取数字并将返回的数字设置为变量。我该怎么做呢？

我已经尝试了几件事，例如 JSON.parse 但它不起作用:(

简而言之：如何从外部站点上的这个 json 中获取数字，并将其设置为变量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T07:41:31.193

除非站点支持 JSONP 或跨域资源共享，否则您无法从 Javascript 中的外部 URL（在不同域中）获取数据。如果是，则用于`XMLHttpRequest`获取数据并`JSON.parse()`读取它。

脚本：

```
var xhr = new XMLHttpRequest();
xhr.open( 'GET', 'example.com/json', true );

xhr.onload = function () {
    var unread = window.JSON.parse( xhr.responseText )._visitor_alertsUnread;
};

xhr.onerror = function () {
    //process error
};

xhr.send(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T07:11:48.377

试试这个[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

```
$.getJSON('your_url', function (jsonobj) {
    var unread;
    unread = jsonobj._visitor_alertsUnread;
}); 
```

# xcode - 如何在 Xcode 中使用 Q_OBJECT 宏编译头文件？

> ID：11371813
> 
> 赞同：2
> 
> 时间：2012-07-07T02:28:08.710
> 
> 标签：xcode, qt, qobject, moc

我在 Xcode 中创建了与 Qt 框架链接的 C++ 项目。hello world 程序运行良好。当我添加从 QObject 派生的类并添加 Q_OBJCET 宏时，出现链接错误。

班级是

我的对象.h

```
#ifndef MyObject_h
#define MyObject_h

#include <QtCore/QObject>

class MyOBject : public QObject
{
  Q_OBJECT

public:
    MyOBject();

};

#endif 
```

我的对象.cpp

```
#include "MyObject.h"

MyOBject::MyOBject()
{
} 
```

我知道我**应该**先使用 moc 编译 MyObject.h 并将生成的 moc_MyObject.cpp 添加到 Xcode 项目中。

在 Microsoft Visual Studio 中，我可以将此头文件配置为使用 moc 自定义工具进行编译。并将生成的 cpp 文件添加到 VS 项目中。

但这是 Xcode。我的问题是：在 Xcode 中是否有等效的方法来编译包含 Q_OBJECT 宏的头文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-12-30T06:05:36.520

以下是您在 Xcode 6 中的操作方式：

选择您的目标并在构建规则中创建一个新的自定义规则。将“进程”下拉菜单设置为“名称匹配的源文件”，然后在`*.h`旁边输入。将“使用”下拉菜单设置为“自定义脚本：”，然后在脚本中键入与此类似的内容：

```
/path/to/your/Qt/bin/moc ${INPUT_FILE_PATH} -o ${DERIVED_FILE_DIR}/${INPUT_FILE_BASE}_moc.cpp 
```

您必须将路径更改为 moc 可执行文件所在的位置。现在将“输出文件”设置为：

```
${DERIVED_FILE_DIR}/${INPUT_FILE_BASE}_moc.cpp 
```

这就是自定义规则。

现在获取要使用此规则编译的标头。当您的目标仍被选中时，请转到“构建阶段”。展开“编译源”部分，点击底部的“+”按钮。查找并添加包含 Q_OBJECT 类的头文件。如果在其中找不到这些标题，请先将它们添加到您的项目中。

就是这样，Xcode 将在这些头文件上运行 moc，它会理解 moc 的输出是一个 .cpp，需要编译并链接到您的应用程序中并为您执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-09T10:40:24.230

I didn't find how to set the custom tool for a specific header file in Xcode. I found a workaround via the build phase script (Build Phases -> Add Build Phase -> Add Run Script). I added the moc command line as script, and included the generated moc_MyObject.cpp file to MyObject.cpp. It works now.

# asp.net - 使用 DDL 在 gridview VB.NET 中选择记录

> ID：11371816
> 
> 赞同：0
> 
> 时间：2012-07-07T02:28:47.007
> 
> 标签：asp.net, vb.net, gridview, drop-down-menu

我有一个简单的 DDL，其值为 1、2、3。

我有一个带有 BoundField DataField="Cycle" 的 Gridview

我想从下拉列表中选择一个值，并且我想更新我的 Gridview 以仅显示 Cycle = 选择值的记录。

我这样做而不是使用带有提交按钮的文本框。

当我设置连接字符串时，我可以测试查询并且它可以工作，我只是无法获取下拉列表的选择/更新值来更改网格视图。

谢谢，比尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T05:36:42.277

您需要处理 DDL aka ComboBox [SelectedIndexChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectedindexchanged.aspx)事件。在那种情况下，查询您的数据库，根据 SelectedItem 值获取数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T23:14:07.850

我发现我在 DDL 之前创建了 gridview，因为数据源已经设置好，这让我很失望。我最终重新定义了gridview连接，并将DDL作为它的控制参数。当我选择一个新值时，GridView 会刷新查询。

```
<asp:AccessDataSource ID="AccessDataSource1" runat="server" 
        DataFile="~/FromHost06192012_11/FromHost.mdb" 
        SelectCommand="SELECT * FROM [Table] WHERE ([Cycle] = ?) ORDER BY [Route]">
        <SelectParameters>
           <asp:ControlParameter ControlID="**DropDownList1**" DefaultValue="%" Name="Cycle2" PropertyName="SelectedValue" Type="String" />
        </SelectParameters>
</asp:AccessDataSource> 
```

# android - 使用 Runnable 填充 ListView - 返回太多

> ID：11371820
> 
> 赞同：2
> 
> 时间：2012-07-07T02:29:53.153
> 
> 标签：android, arrays, listview

我正在组合一个应用程序，该应用程序在 relativeLayout 中有一个列表视图，其中有几个 LinearLayouts。所以我有我的适配器和一个将项目放入列表的功能。该函数只在apps主进程的OnCreate函数中调用，在线程的runnable中调用。你们都明白为什么这个东西可能会这么多次调用添加到我的数组中吗？（当我只向数组中添加一件事时，for 循环被调用了数千次。在主进程的 OnCreate 方法中：

```
 array = new ArrayList<Item>(); //The misbehaving array
      ListView lv = (ListView)findViewById(R.id.ItemList);
      this.m_adapter = new ItemAdapter(this, R.layout.Itemlist_item, array);
      lv.setAdapter(this.m_adapter);
      viewItems = new Runnable(){
          @Override
          public void run() {
             getItems();
          }
      };
      Thread thread =  new Thread(null, viewItems, "ListThread");
      thread.start(); 
```

getItems 函数和第二个 Runnable：

```
private void getItems(){
  try{
     //Try Some Stuff
  } 
  catch (Exception e) {
     Log.e("BACKGROUND_PROC", e.getMessage());
  }
  runOnUiThread(returnRes);
}
private Runnable returnRes = new Runnable() {
  @Override 
  public void run() {
    if(array != null && array.size() > 0){
        listAdapter.notifyDataSetChanged();
        //This loop is where I'm seeing the problem
        for(int i=0;i<array.size();i++) {
            listAdapter.add(array.get(i));
        }
    }
  }
}; 
```

和列表适配器：

```
 public class ItemAdapter extends ArrayAdapter<Item> {

        public ArrayList<Item> items;
        public ItemAdapter(Context context, int textViewResourceId, ArrayList<Item> items) {
            super(context, textViewResourceId, items);
            this.items = items;
        }
        @Override
        public View getView(int position, View conView, ViewGroup parent) {
            View v = conView; //The content view

            if (v == null){
                LayoutInflater vi = (LayoutInflater)getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                v = vi.inflate(R.layout.itemlist_item, null);
            }

            Item o = items.get(position);
            if (o != null){
                TextView name = (TextView)v.findViewById(R.id.item_name);
                if(name != null){
                    name.setText("name:"+o.getItemName());
                }
            }

            return v;

        }

    } 
```

任何帮助深表感谢。谢谢，-克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T14:59:27.400

问题是`ListView`与适配器一起使用的其他此类 UI 小部件不允许适配器的内容在它们上发生意外更改。在下次尝试与适配器交互之前，您需要告知`ListView`您所做的更改。如果您允许另一个线程修改适配器，或者在主线程上修改它，但在允许其他任何事情发生之前不告知`ListView`更改，您将随机（由于竞争）收到`ListView`有关适配器意外更改的异常。

相反，这样的事情应该可以工作（来自 HackBod 的帖子[）](https://stackoverflow.com/a/6244952/844882)：

```
public class MyAdapter extends BaseAdapter<Item> {
    private ArrayList<Item> mItems;

    public int getCount() {
        return mItems != null ? mItems.size() : 0;
    }

    public MyItem getItem(int position) {
        return mItems.get(i);
    }

    /* ... */
} 
```

然后填充`ListView`，

```
private Handler mHandler = new Handler();

private void setDataFromThread(ArrayList<Item> data) {
    // Enqueue work on mHandler to change the data on
    // the main thread.
    mHandler.post(new Runnable() {
        @Override
        public void run() {
            mItems = newData;
            notifyDataSetChanged();
        }
    });
} 
```

# c# - Html Agility Pack - 按 ID 或类删除标签

> ID：11371821
> 
> 赞同：4
> 
> 时间：2012-07-07T02:30:07.267
> 
> 标签：c#, html-agility-pack

这是我的简化 HTML：

```
<html>
  <body>
    <div id="mainDiv">
       <div id="divToRemove"></div>
       <div id="divToKeep"></div>
       <div class="divToRemove"></div>
       <div class="divToRemove"></div>
    </div>
  </body>
</html> 
```

我想删除 ID 或名为“divToRemove”的类的 div，然后我只想选择名为“mainDiv”的 div（在 HtmlNode 中）。

结果应该是：

```
 <div id="mainDiv">
       <div id="divToKeep"></div>
   </div> 
```

我如何使用 Html Agility Pack 做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T03:05:17.977

以下代码改编[自此 Html Agility Pack 论坛页面](http://htmlagilitypack.codeplex.com/discussions/248692)，以满足您的需求。本质上，我们将抓取所有 div，然后遍历它们并检查它们的类或它们的 id 是否匹配。如果它在那里删除它。

```
var divs = htmldoc.DocumentNode.SelectNodes("//div");
if (divs != null)
{
    foreach (var tag in divs)
    {
        if (tag.Attributes["class"] != null && string.Compare(tag.Attributes["class"].Value, "divToRemove", StringComparison.InvariantCultureIgnoreCase) == 0)
        {
            tag.Remove();
        } else if(tag.Attributes["id"] != null && string.Compare(tag.Attributes["id"].Value, "divToRemove", StringComparison.InvariantCultureIgnoreCase) == 0) {
            tag.Remove();
        }
    }
} 
```

您也可以将这些 if 语句组合成一个大的 if 语句，但我认为这更适合答案。

最后，选择您要查找的节点...

```
var mainDiv = htmldoc.DocumentNode.SelectSingleNode("//div[@id='mainDiv']"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T04:02:49.553

就个人而言，我更喜欢使用 HtmlAgilityPack 的 Linq 方法。选择会很长，但相对简单——只需选择具有正确 id 和/或类的节点，然后`Remove()`在其上调用方法。

```
foreach (var node in doc.DocumentNode.Descendants("div")
    .Where(n => n.Id.Equals("divToRemove", StringComparison.InvariantCultureIgnoreCase) 
        || n.GetAttributeValue("class", string.Empty).Equals("divToRemove", StringComparison.InvariantCultureIgnoreCase)))
    node.Remove();
HtmlNode mainNode = doc.DocumentNode.Descendants("div").Where(n => n.Id.Equals("mainDiv", StringComparison.InvariantCultureIgnoreCase).First(); 
```

# google-analytics - 分析：列出从登陆页面到资金页面的所有路线

> ID：11371824
> 
> 赞同：0
> 
> 时间：2012-07-07T02:30:47.617
> 
> 标签：google-analytics, analytics

我希望能够创建一个报告，列出从登录页面到金钱页面的所有路线，包括访问者数量、跳出率和流量来源。

示例：“我的关键字”-> 页面 A（90 个访问者，20% 跳出率）-> 页面 X（72v，45% br）-> 金钱页面

我愿意使用任何分析解决方案（免费或付费）。谷歌分析会更简单，但我找不到如何使用它。

我知道分析解决方案具有允许此类报告的原始数据，但如果工具已经存在，我宁愿使用它。

我正在接受任何见解，任何想法。谢谢你的帮助。

# delphi - 有没有办法找到谁触发了 TADOConnection 的 OnExecuteComplete 事件？

> ID：11371828
> 
> 赞同：1
> 
> 时间：2012-07-07T02:32:27.927
> 
> 标签：delphi, profiler, tadoquery

我正在尝试在 Delphi 7 中编写 ADO 数据库分析器。它是 Delphi 项目的一部分。

我正在使用`OnExecuteComplete`事件，但在某些 PC 上我收到“MSADO15.DLL”访问冲突错误。

我研究并理解了一些win版本不兼容或损坏或有不同的版本..

当我使用“命令”的属性时发生了 AV 错误`parameters[i].value`。然后我决定编写不同的类型，现在我需要一个对`OnExecuteComplete`在 ADOConnection 中调用事件的对象的引用。如果我能达到它，问题就会得到解决。

我使用“命令”和“记录集”引用来比较通过此 ADOConnection 链接的所有 ADO 对象，但某些 ADO 对象没有记录集。有没有办法找到触发该事件的人？像发件人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T19:55:55.117

只有 WindowsXP、Windows 2003 在读取 Parameters[i].Value 并显示记录集后出现“MSADO15.DLL”访问冲突错误的问题。Windows7没有这个问题。使用 WillExecute 事件 - 它在任何地方都可以正常工作。在 ExecuteComplete 中，您可能会从记录集中获得 recordsAffected（RecordsAffected 变体工作错误）。如果将参数保存到 Variant 变量并在可视组件显示记录集后读取它，您可以稍后获取 Parameters[i].Value - 例如使用 OnButtonClick 或 Timer 事件。这个 BUG 在所有 Delphi 版本中都没有修复 - 在 DelphiXE2 中也是如此..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:09:51.047

我无法确定您是否在 .Net 中，但在 .Net 中很容易。使用[System.Diagnostics.StackTrace](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.aspx)查看导致您的事件的整个调用堆栈。

对于本机代码，如果您在调试模式下编译，可能还有一种获取堆栈跟踪的方法。自从我编写 Delphi（或 Pascal）代码以来已经有一段时间了。您还可以尝试使用免费的[AQTime 标准](http://smartbear.com/products/free-tools/aqtime-standard/)进行分析，该标准适用于 Delphi（本机和 .Net），它还具有[调用图](http://support.smartbear.com/screencasts/aqtime/tracing-function-calls-with-aqtime/)功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T22:17:25.607

我解决它！我写了 2 个派生类，来自 ADOQuery 和 ADOStoredProc。然后我发布它们的 Command 属性。通过强制将 StoredProcedure 转换为新类，我到达命令道具并通过事件的命令对象进行比较！问题解决了！谢谢你们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T03:30:21.680

Sender 应该给你一个线索，如果它不是 nil 的话。将其转换为 TComponent 并使用其 Name 属性找出哪个组件触发了它：

```
ShowMessage((Sender as TComponent).Name); 
```

如果 Sender 为 nil，则堆栈跟踪可能会有所帮助。

## 更新

显然没有 Sender 参数。在这种情况下，Connection 必须是触发它的类，因此获取它的名称和其他数据。你得到足够的参数来找出正在发生的事情。

# visual-studio-lightswitch - 显示来自数据绑定路径的图像

> ID：11371830
> 
> 赞同：0
> 
> 时间：2012-07-07T02:33:56.547
> 
> 标签：visual-studio-lightswitch

我试图在 LightSwitch 应用程序的数据网格的每一行中显示一个唯一的图像。要显示的图像的路径位于数据网格源的列中。目的是创建一个显示每个产品图像的“产品浏览器”。我有一个包含以下字符串字段的表“产品”：

*   型号
*   型号说明
*   模型图像路径

该表用作搜索屏幕的数据源。我需要为每个数据行显示由 modelImagePath 中的路径指向的图像。modelImagePath 中的数据类似于“C:\Images\model00123.jpg”。

旁注：我宁愿避免将这些图像作为嵌入资源添加到项目中，而是能够从任意路径加载外部图像，但如果没有其他方法，我会承认这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T05:03:40.977

查看 LightSwitch 论坛中的这篇文章，该文章建议使用 RIA 服务来实现您想要实现的目标......

[http://social.msdn.microsoft.com/Forums/en-US/lightswitch/thread/d0ab8d85-faa5-4ca3-8d22-3d84737cb11e/](http://social.msdn.microsoft.com/Forums/en-US/lightswitch/thread/d0ab8d85-faa5-4ca3-8d22-3d84737cb11e/)

干杯，

保罗

# java - 动态配置和生成 BIRT 报告

> ID：11371834
> 
> 赞同：12
> 
> 时间：2012-07-07T02:34:55.097
> 
> 标签：java, eclipse, reporting, birt

通过观看 2 部分的 YouTube 视频和阅读 BIRT 手册，我对它的理解是工作流程是这样的：

*   在 Eclipse 中创建新报告
*   使用 BIRT Report Designer（Eclipse 插件）设计报告
*   使用数据源（JDBC 驱动程序和数据库）和数据集（特定表）填充报告
*   生成/导出/打印报告

尽管这个工具看起来很酷，但我找不到*任何*文档让我相信这是一个**Java**工具而不是一个**仅限 Eclipse 的**工具（意思是，它有一个 Java API 并且可以与 Java 应用程序交互，而不是一个纯 Ecipe 插件，需要来自 Eclipse IDE 的手动/人工交互。

具体来说，我想确认 BIRT 可以或不能执行以下操作：

*   以编程方式配置报告（布局、UI 小部件放置、数据源/集等）；即，与 JasperReport API 具有生成 JRXML 的 iReport 设计器的方式相同，BIRT 是否也是如此？
*   通过 Java API 启动报告“生成”，从而实时读取数据并填充报告，报告可以发送出去或存储在文件系统中
*   创建同一报告的 HTML 和 PDF 版本

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-11T23:11:00.010

回答您的问题：

1.  是的。BIRT 可能没有 JasperReports 强大，但它可以实现大部分常见的需求。BIRT 设计器在 JasperReports 中生成一个类似于 JRXML 的 .rptdesign 文件。

    关于您的问题：几乎所有事情都可以在 BIRT 中以编程方式实现。[BIRT 报告引擎 API](http://www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php)是您开始使用您提到的所有功能的最佳来源。它为每个功能提供了很好的示例。

2.  没有把握。BIRT 通常从 DB 中获取预先保存的数据并生成报告。您可以在一些外部库的帮助下看到实时数据表示（可能是闪存图表的形式）（看看[这个](http://www.eclipse.org/forums/index.php/m/164060/)线程和[这个](http://www.birt-exchange.org/org/devshare/designing-birt-reports/1141-simple-real-time-report/)例子是否有帮助）。但我不知道将实时数据转换为 PDF/HTML 报告的直接方法。您将不得不找到一些技巧。

3.  是的当然。请参阅 API。具体来说，[irendertask](http://www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php#irendertask)。

获取更多信息/答案的来源：

1.  网站上有几个[示例报告](http://www.eclipse.org/birt/phoenix/examples/)。快速浏览它们可能会给您更多的见解。

2.  有关讨论和故障排除，请参阅[eclipse 社区论坛](http://www.eclipse.org/forums/index.php?t=thread&frm_id=2)和[BIRTExchange](http://www.birt-exchange.org/org/forum/)（BIRT 用户大量使用）。

3.  [BIRT: A Field Guide to Reporting](https://rads.stackoverflow.com/amzn/click/com/0321442598)是一本极好的书。我自己不时使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T19:51:06.120

我可以确认您有兴趣使用的两个 BIRT 组件（BIRT 设计引擎和报告引擎）将在纯 Java 上下文中工作，并且可以在没有 Eclipse 的情况下进行部署。我已经部署了 BIRT 报告以用完独立的 Tomcat 服务器以及 Pentaho BI 服务器，并使用 shell 脚本在命令行中执行报告定义（不涉及 Eclipse）。

回答您的问题：

1.  以编程方式配置报告：使用[Design Engine API](http://www.eclipse.org/birt/phoenix/deploy/designEngineAPI.php)。我不熟悉 Jasper Reports API，因此无法评论 BIRT 方法是否相似，但[示例代码](http://www.eclipse.org/birt/phoenix/deploy/DeDemo.java)提供了很好的说明。特别要注意`lines 120-133`在报表中添加和操作哪些小部件，以及如何`line 136`调用`saveAs`以保存报表设计文件。

2.  实时生成报告：使用[报告引擎](http://www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php)。[IRunAndRenderTask](http://www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php#irunandrendertask)的示例代码一开始可能对您最有用，但引擎具有将报表的数据处理（提取和聚合）与呈现和分页分开的能力。我相信这些示例侧重于从 Servlet 运行报告，但很容易从 servlet 容器逻辑中提取该逻辑。

3.  创建 HTML 和 PDF 版本：通过[IRenderTask](http://www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php#irendertask)在报表引擎中轻松处理。一旦您完成了所有其他设置工作，更改输出格式以生成 PDF 与 HTML 是一件令人愉快的事情。以我的经验，它只是工作。

我发现从一个非常简单的 Java 类（改编自[这里的非常旧的代码](http://wiki.eclipse.org/Java_-_Simple_Design_Engine_API_%28BIRT%29)）开始运行从命令行调用的测试报告很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T03:58:18.700

您可以使用报告引擎 API 来配置报告： http: [//www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php#ireportrunnable](http://www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php#ireportrunnable)

您可以通过在 url 中设置变量来生成报告，或者以编程方式使用报告引擎来创建报告的 HTML 或 PDF 版本：

[http://www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php#irendertask](http://www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php#irendertask)

我们使用 Eclipse 来构建和设计报告。报表引擎被部署为reports_war 的一部分，war 有自己的数据库连接。我们基于 Java 的 Web 应用程序使用 url 与报告模板进行交互（变量在 url 中设置）。

[BIRT Exchange](http://www.birt-exchange.org/org/forum/)是获取更多信息的好地方

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-08T12:00:47.293

除了 birt 有 eclipse 插件外，Birt 和 jasper 在设计上没有太大区别。

1）是的，您可以通过java程序或方法配置它。

2）是的，这是可能的。

3）是的，再次以不同格式导出您的报告很容易通过 java birt 报告

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-10T08:40:59.390

BIRT 是一个简单易用的报告生成工具。

*   您可以在 BIRT 中设计您的页面。-
*   创建数据集，并可以使用 jsp 标签库将网页中的值传递给 BIRT 设计。BIRT 满足您的所有要求。它很容易使用。首先我使用 jasper，然后尝试使用水晶 atlast Birt 输出。 [标签库](http://www.eclipse.org/birt/phoenix/deploy/viewerUsageMain.php)

我参考此链接以在我的网页中查看 BIRTVIEWVER。PDF 创建在 BIRT 中非常完美。您也可以生成 PDF、DOC、HTML。

您可以将值传递给您的 birt 。在创建数据集时，可以选择传递参数。

[要做到这一切，你必须在你的 Eclipse BIRT 报告设计](http://download.eclipse.org/birt/downloads/)器中安装 BIRTREPORT

# php - 在 cakephp 中向模型添加自定义函数

> ID：11371841
> 
> 赞同：3
> 
> 时间：2012-07-07T02:37:58.047
> 
> 标签：php, cakephp

我有一个包含位置属性的用户表，并且想创建一个模型函数来检索附近的用户（在给定的半径内）。这是我的模型：

```
    类用户扩展 AppModel {
        公共函数 getNearbyUsers($id,$dist=10) {
            返回 $this->query(...);
        }
    }

```

这是我试图调用该函数的控制器：

```
    类用户控制器扩展 AppController {
        公共函数 getNearbyUsers($id) {
            ...
            $this->User->getNearbyUsers($id)
            ...
        }
    }

```

然而，这样做会导致：`PHP Fatal error: Call to a member function getNearbyUsers() on a non-object`

我究竟做错了什么？

编辑：没关系，它不再抱怨了。但它抛出了一个 SQL 错误，我的模型函数实际上从未被调用过。在进一步检查 mysql 查询日志后，我看到：

```
    查询 SHOW TABLES FROM `xxx`
    查询 getNearbyUsers
    退出

```

似乎 CakePHP 将 $this->User->getNearbyUsers 解释为文字查询。所以我的问题仍然存在：如何在 Cake 中为模型添加自定义函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T04:12:33.827

请参阅[http://book.cakephp.org/2.0/en/models/additional-methods-and-properties.html](http://book.cakephp.org/2.0/en/models/additional-methods-and-properties.html)：

> 虽然 CakePHP 的模型函数应该可以让您到达您需要去的地方，但不要忘记模型类就是这样：允许您编写自己的方法或定义自己的属性的类。
> 
> 任何处理数据保存和获取的操作都最好放在模型类中。这个概念通常被称为胖模型。

模型

```
class Example extends AppModel {
    function getRecent() {
        $conditions = array(
            'created BETWEEN (curdate() - interval 7 day) and (curdate() - interval 0 day)'
        );

        return $this->find('all', compact('conditions'));
    }
} 
```

> 这个**getRecent()**方法现在可以在控制器中使用。

控制器

```
$recent = $this->Example->getRecent(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-31T04:36:54.220

代码中需要添加一些附加项，否则您将收到非对象错误。

在应用模型中：

```
<?php

class Get extends AppModel {
    public function getRecent() {
        // $conditions = array(
            // 'created BETWEEN (curdate() - interval 7 day)' .
            // ' and (curdate() - interval 0 day))'
        // );
        // return $this->find('all', compact('conditions'));
    }
} 
```

在应用程序控制器中，

```
?php

class GetsController extends AppController {

    public $uses = array('Get');  // Needed, or the error will appear.

    public function Example () {
       $this->Get->getRecent();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-08T14:58:01.593

Cake 1.3 有同样的问题，使用插件（模块），即使我们的模型名称在整个应用程序中是唯一的*（一些模型名称用于多个插件中）*，它只有在我在控制器中请求模型时才起作用`$uses`带有它的插件的数组，如下所示：`'Module1.A'`

应用程序/插件/插件1/控制器/a_controller.php：

```
class AController extends AppController {

    // using simple array('A') worked fine for cake methods (find, query ...)
    // but did not recognized the custom method
    public $uses = array('Plugin1.A');

    public function Example () {
       $this->A->customMethod();
    }
} 
```

应用程序/插件/plugin1/models/a.php：

```
<?php

class A extends AppModel {
    public function customMethod() {
        // ...
    }
} 
```

# javascript - 使用 JavaScript 包含动态菜单

> ID：11371842
> 
> 赞同：0
> 
> 时间：2012-07-07T02:38:00.310
> 
> 标签：javascript, dynamic, menu, include

我想为我网站上的每个 html 页面包含一个基于页面名称或另一个使用 Javascript 的唯一元素的文件。

该脚本需要识别元素然后加载正确的文件。

我的网站页面以扩展名 .html 结尾——如果我可以将它们更改为 .php 我会并且我会设置，但我无法更改结构。

例如，一个脚本会检查beads.html 中的唯一元素，然后它会加载与该元素关联的beads-nav.html 文件。珠宝.html 将加载珠宝导航.html 文件等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T05:48:36.853

您可以通过 ajax 加载外部页面。

使用 jquery 可以像这样简单：`$('#result').load('ajax/test.html');`

取自[这里](http://api.jquery.com/load/)。

# php - 'php://input' 是否包含客户端的设备 ID 信息？

> ID：11371848
> 
> 赞同：0
> 
> 时间：2012-07-07T02:40:04.767
> 
> 标签：php, android, webserver

当我打印`$data = file_get_contents('php://input')`时，它打印了很多乱七八糟的代码。我想从 php 服务器知道哪个 android 设备已将某个文件上传到服务器。太感谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T04:10:42.333

这不是杂乱的代码，而是关于您不理解的请求的详细信息。

去了解 HTTP 协议是如何工作的，如果你不了解你在使用什么，你就无法解决这个问题。

您只能找出用户代理提供的内容。如果他们没有通过 HTTP 发送带有设备版本号的请求标头，那么不，你不会得到那个。

通常操作系统包含在用户代理字符串中。这可能是您唯一能找到与您正在寻找的东西相近的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T04:30:11.600

如果您想识别特定用户，您能做的最好的事情（通过您和设备之间的许多系统的设计）就是使用[HTTP cookie](http://www.ietf.org/rfc/rfc2109.txt)实现“会话” 。如果请求来自浏览器，则一旦设置了 cookie，来自该个人用户的每个后续请求都将具有相同的 cookie。

我们使用的一般模式是查找现有的 cookie，如果没有（即新用户）：创建一个唯一的随机字符串，将其存储在与此“用户”关联的服务器上的某个位置，然后将其发送到用户作为 cookie。

[PHP 会话功能](http://php.net/manual/en/features.sessions.php)可以在这方面为您提供极大的帮助。

***请记住，***您只能以这种匿名方式跟踪用户。除非您还在发送请求的设备上编写了应用程序，否则您无法从设备获取实际的设备 ID。***这很好***。

# python - 使用 assertRaise 测试异常消息

> ID：11371849
> 
> 赞同：4
> 
> 时间：2012-07-07T02:40:09.780
> 
> 标签：python, unit-testing

我试图在一个条件引发自定义异常消息的函数中断言异常。

功能：

```
if not Cart.objects.filter(member=member).count():
    raise CartDoesNotExist("Cart Does Not Exist for Member: %s ( %id )." % (member.email,member.id)) 
```

现在，我能够成功地产生到达 raise 语句所需的条件。

所以，我的测试用例看起来像这样：

```
def Order_CartDoesNotExist(self):        
  self.assertRaises(CartDoesNotExist,Order.objects.create_order(member=self.member2,member_slot=self.memslot,order_type="Normal")) 
```

当我运行测试时，输出是错误。它给出了相同的错误 CartDoesNotExist .....

所以我的问题是，如何提出这些例外？如何在我们的单元测试中涵盖这些情况？我不想逃避这些条件，因为它们很重要并增加代码覆盖率？

谢谢你们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T02:56:29.057

您的代码直接调用 create_order ，这会引发异常。您需要更改它的调用方式。在 Python 2.7 中，您可以使用：

```
with self.assertRaises(CartDoesNotExist):
    Order.objects.create_order(member=self.member2, member_slot=self.memslot, order_type="Normal")) 
```

这里上下文管理器允许你直接调用你的代码，上下文管理器会为你处理异常。

如果您使用 2.6 或以下版本运行：

```
self.assertRaises(CartDoesNotExist, Order.objects.create_order, member=self.member2, member_slot=self.memslot, order_type="Normal") 
```

在这里，您没有调用您的函数，而是将它连同它需要的参数一起传递给 assertRaises，assertRaises 将调用代码并正确处理异常。

# r - R中的类外键合并

> ID：11371850
> 
> 赞同：0
> 
> 时间：2012-07-07T02:41:36.853
> 
> 标签：r

我正在合并一堆，`csv`每个 id/pk/seqn 有 1 行。

```
> full = merge(demo, lab13am, by="seqn", all=TRUE)
> full = merge(full, cdq, by="seqn", all=TRUE)
> full = merge(full, mcq, by="seqn", all=TRUE)
> full = merge(full, cfq, by="seqn", all=TRUE)
> full = merge(full, diq, by="seqn", all=TRUE)
> print(length(full$ridageyr))
[1] 9965
> print(summary(full$ridageyr))
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   11.00   19.00   29.73   48.00   85.00 
```

一切都很好。但是，我有另一个文件，每个 id 有多个行，例如：

```
"seqn","rxd030","rxd240b","nhcode","rxq250"
56,2,"","",NA,NA,""
57,1,"ACETAMINOPHEN","01200",2
57,1,"BUDESONIDE","08800",1
58,1,"99999","",NA 
```

`57`有两行。所以，如果我天真地尝试合并这个文件，我会有更多的行，我的数据就会全部歪斜。

```
> full = merge(full, rxq, by="seqn", all=TRUE)
> print(length(full$ridageyr))
[1] 15643
> print(summary(full$ridageyr))
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   14.00   41.00   40.28   66.00   85.00 
```

有没有一种正常的惯用方式来处理这样的数据？例如，假设我想创建一个列，`full`其中包含参与者在过去 30 天内是否接受了 RX。我可以通过以下方式获取键列表：

```
has_taken <- unique(rxq[rxq$rxd030 == "1",]$seqn)
hasnt_tak <- unique(rxq[rxq$rxd030 == "2",]$seqn)
full$takenRX <- ifelse(full$seqn %in% has_taken, TRUE, ifelse(full$seqn %in% hasnt_tak, FALSE, NA)) 
```

现在我有一`takenRX`列我认为正确地为我的`full`数据框中的每一行给出了 TRUE/FALSE/NA。我是否需要为每一位数据手动执行类似的操作，或者是否有更自动化的方式可以将每个键的多行数据带入我的数据框中？有没有更优雅的建议？更惯用的方法？

对于其他列，我想我想组合这些行以便有〜元组。

```
key, a, b, c
2, 0, 0, 0 
```

加

```
key, baz
2, foo
2, bar 
```

给了我类似的东西：

```
key, a, b, c, baz
2, 0, 0, 0, [foo, bar] 
```

但是，我不确定要使用什么数据结构，`[foo, bar]`所以我可以在以后轻松地使用“has foo in baz”作为逻辑。

在家玩，这里有/有一些[代码](https://github.com/skyl/NHANES-opensource/blob/ea77815dbc5c14082a76b9fe075a540d0411015e/1999-2000/ldl.R#L60)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T03:11:30.387

对于您更新的示例：

```
demog <- data.frame(key=c(2, 3), a=c(1,0), b=letters[1:2], c=LETTERS[1:2])
meds <- data.frame(key=c(2,2), baz=c('foo', 'baz'), stringsAsFactors=FALSE)
aggregate(baz~key, data=meds, FUN=list)
#  key      baz
#1   2 foo, baz

merge(demog, mermed)
#  key a b c      baz
#1   2 1 a A foo, baz 
```

如果您不想在没有药物的情况下松动案例，则需要将 all.x=TRUE 添加到真实案例中，我对您的问题的部分批评是缺乏足够大的测试案例来暴露其他此类编码缺陷.

```
> merge(demog, mermed, all.x=T)
  key a b c      baz
1   2 1 a A foo, baz
2   3 0 b B       NA 
```

（我仍然认为以下内容适用。）您可能需要对感兴趣的药物进行合理的分类，并为每个人级别的记录创建一个单独的记录，说明他们是否从您的研究感兴趣的类别中选择了一个。我想知道那些“rxd030”或“rxq250”代码是否可能是压缩降脂剂的临床分组？（事实证明并非如此。）这表明提问者需要提供含义和代码才能获得明智的建议。

一些搜索表明这可能已经完成。这是 NHANES 1999-2000 药物网页的一小部分：

```
Codebook

    SEQN - Respondent sequence number
    RXD030 - Taken prescription medicine/past month
    RXD240B - Standard generic ingredient name
    NHCODE - Standard generic ingredient code
    RXQ250 - Medicine container seen by interviewer
    RXD260 - Number of days taken medicine
    FDACODE1 - FDA/NDC drug class code 1 
    FDACODE2 - FDA/NDC drug class code 2
    FDACODE3 - FDA/NDC drug class code 3
    FDACODE4 - FDA/NDC drug class code 4
    FDACODE5 - FDA/NDC drug class code 5
    FDACODE6 - FDA/NDC drug class code 6 
```

还有一个附录有一些计数：

```
Code or Value   Value Description   Count   Cumulative  Skip to Item
Generic drug code   Value was recorded  9138     9138   
        < blank >   Missing             6505    15643 
```

其中一个医学代码是：912 HYPERLIPIDEMIA

所以看起来你不需要重新发明轮子，而是可以使用已经完成的分类。

您首先需要根据“RXD030：您在过去一个月内服用或使用过任何处方药吗？”创建一个变量。每个类别的“否”案例都将为 0。

我将数据导入 R 并查看了“高脂血症药物”。事实证明，只有 FDACODE1 和 FDACODE2 用于“0912”类别。这是匹配的两个代码的前十个 SEQN。我提供这个是为了帮助您构建一个正确的问题：

```
> subset( medrecs,  FDACODE2 %in% "0912" )[1:10,"SEQN"]
 [1]   46   86   90  191  434 1029 1273 1634 1980 2105
> subset( medrecs,  FDACODE1 %in% "0912" )[1:10,"SEQN"]
 [1]  29  55  86 130 148 179 187 211 239 274 
```

一个适当的问题将提供对部分或全部这些的所有医学记录的访问，以及一些没有它们的样本医学记录，并且将有“demog”记录匹配。

# php - Build Image on server From Canvas RGB Data

> ID：11371854
> 
> 赞同：0
> 
> 时间：2012-07-07T02:43:20.333
> 
> 标签：php, javascript, canvas

*Note: .toDataURL() and "todataurl-png-js" are NOT usable*

Say I wanted to construct an image in PHP from a canvas element's RGB data that is sent from JavaScript (getImageData), how would I accomplish this? More specifically, how would I first get the RGB data and put in the proper format (for use in PHP) and how would I assemble it properly into an image?

*Edit: It is preferred that this simply (if possible) be done from the data in getImageData().data

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T02:58:30.227

You can convert canvas data to javascript.

More about canvas Info: [http://code.google.com/p/canvg/](http://code.google.com/p/canvg/)

How to convert canvas to Image. [http://www.nihilogic.dk/labs/canvas2image/](http://www.nihilogic.dk/labs/canvas2image/)

If you want to store that image on server side, pass base64 string to php page and save it there.

# c++ - 构建后 ncurses 无法正常工作

> ID：11371856
> 
> 赞同：1
> 
> 时间：2012-07-07T02:43:31.750
> 
> 标签：c++, linux, terminal, ncurses

我在 linux 中使用以下代码构建了一段代码：

`g++ -o main main.cpp -lncurses`

但由于某种原因，它无法正常工作。文件应如下所示：

```
_+____+____________________________________________________+
-_ ___+_++++++++++++++++++++++++++++++++++++++++++++++++++_+
 ++++_+_+____________________________-_- - - - - - - - - -_+
______+_+_                                                  
-    -+_+_                                                  
       _+-_ _______________________________________________+
_______-+                                              ____+
+++++++_+____________-________--__________________________-+
_______ + ___ _---_           __----- - -- -- -   - - - - -+
_ _ _  _+__- - ----- - - --- ------------ - - -- -- - - -- +
+++++++_+++________________________________________________+
_________ ______        _ _ _ _ - -_ _ --  - -_ _ - - - - _+
-----------------------------------------------------------+
                                                           +
____________+____________+_______________+_________________+
- - - - - ----------- -  -------------------- --------- -- +
  _ _   _ _     _ _ -___ _ -__ - -_ -- -__- - -- ----------+
-----------------------------------------------------------+
____________-----____   ______________ ______ _____________+
_________ ________   _________  _________ ___________    _ +
-------------              --------- -          -----------+
___________________________________________________________+
___________________________________________________________+
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++_+
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++__ 
```

但它最终看起来更像这样： ![在此处输入图像描述](../Images/9e2e522043964fe63b5741c8a5cc50e8.png)

然后，此外，在我最终退出程序后，终端的行为很奇怪，所以它似乎`endwin()`不起作用。

这是完整代码的副本：

```
// Imports
#include <ncurses.h>
#include <fstream>
#include <cstring>

// Set Namespace
using namespace std;

// Set Contants
const int BOARD_HEIGHT = 25;
const int BOARD_WIDTH = 60;

// Global Varibles
char gameBoard [BOARD_WIDTH][BOARD_HEIGHT];

// Declare Functions
void createBoard(string);
void displayBoard();
void initCurses();
string getBoard(string);

// CHARACTER CLASS - All operations for the 'o'
class chr{
public:
    int coor [2];
    chr();
    ~chr();
    void moveCenter(int, int);
    char characterOn;
    void win();
    void loose();
    void die();
    int lives;
    void displayLives();
private:
//  char characterOn;
    void spawn(int, int);
};
void getKeyMoveChar(chr*);

// Character Constructor
chr::chr(){
    lives = 4;
    chr::spawn(0,0);
}

// Destructor
chr::~chr(){
    printw("\n"); 
    refresh();
}

// Die - Move the character to 0,0 and then loose a life
void chr::die(){
    if(lives > 0){
        gameBoard[coor[0]][coor[1]] = characterOn;
        lives -= 1;
        spawn(0,0);
    }
    else{
        moveCenter(BOARD_WIDTH - 1, BOARD_HEIGHT -1);
    }

}

// Win - Display "You win!" and close the program.
void chr::win(){
    clear();
    int row, col;
    getmaxyx(stdscr,row,col);
    char mesg[9] = "You win!";
    mvprintw(row/2,(col-strlen(mesg))/2,"%s",mesg);
    refresh();
}

// Loose - Display "You loose!" and close the program.
void chr::loose(){
    clear();
    int row, col;
    getmaxyx(stdscr,row,col);
    char mesg[11] = "You lose!";
    mvprintw(row/2,(col-strlen(mesg))/2,"%s",mesg);
    refresh();
}

// Spawn the character on the board
void chr::spawn(int x, int y){
    coor[0] = x;
    coor[1] = y;
    characterOn = gameBoard[x][y];
    gameBoard[x][y] = 'o';
}

// Move the character to another spot
void chr::moveCenter(int x, int y){
    if(x > -1 && y > -1 && y <= BOARD_HEIGHT - 1 && x <= BOARD_WIDTH - 1 && gameBoard[x][y] != '+'){
        if(characterOn == '-'){
            int ox = x;
            int oy = y;
            if(x > coor[0]){x++;}
            else if(x < coor[0]){x--;}
            else if(y > coor[1]){y++;}
            else if(y < coor[1]){y--;}
            if(gameBoard[x][y] == '+'){
                x = ox;
                y = oy;
            }
        }
        gameBoard[coor[0]][coor[1]] = characterOn;
        coor[0] = x;
        coor[1] = y;
        characterOn = gameBoard[x][y];
        gameBoard[coor[0]][coor[1]] = 'o';
    }
}

// Display the live count at the bottom of the game.
void chr::displayLives(){
    int row, col;
    getmaxyx(stdscr,row,col);
    mvprintw(row -1 ,0,"Lives: %d", lives - 1);
    refresh();
}

// Main stuff
int main()
{
    string BOARD_INPUT = getBoard("map3.txt");
    createBoard(BOARD_INPUT);
    chr player;
    initCurses();
    displayBoard();
    while ((player.coor[0] != BOARD_WIDTH - 1 || player.coor[1] != BOARD_HEIGHT - 1) && player.lives != 0){
        getKeyMoveChar(&player);
        displayBoard();
        if(player.characterOn == ' '){
            player.die();
        }
        player.displayLives();
    }
    if(player.lives != 0){
        player.win();
    }
    else{
        player.loose();
    }
    getch();
    endwin();
    return 0;
}

void getKeyMoveChar(chr* player){
    int ch;
    ch = getch();
    if(ch == KEY_LEFT){
        player->moveCenter(player->coor[0] - 1, player->coor[1]);
    }
    else if(ch == KEY_RIGHT){
        player->moveCenter(player->coor[0] + 1, player->coor[1]);
    }
    else if(ch == KEY_DOWN){
        player->moveCenter(player->coor[0], player->coor[1] + 1);
    }
    else if(ch == KEY_UP){
        player->moveCenter(player->coor[0], player->coor[1] - 1);
    }
}
void initCurses(){
    initscr();
    raw();
    noecho();
    keypad(stdscr, TRUE);
    resize_term(BOARD_HEIGHT + 3, BOARD_WIDTH + 3);
}

/*
+ Wall
- Ice
_ Ground
  Hole
*/

// Read the map
string getBoard(string filename){
    string board;
    string line;
    ifstream myfile (filename.c_str());
    if(myfile.is_open()){
        while(myfile.good()){
            getline (myfile,line);
            board += line;
        }
        myfile.close();
    }
    else{
        printw("Error opening map.txt.");
    }
    return board;
}

// Create map from string
void createBoard(string inputString){
    for(int i=0;i<BOARD_HEIGHT;i++){
        for(int j=0;j<BOARD_WIDTH;j++){
            gameBoard[j][i] = inputString[i*BOARD_WIDTH + j];
        }
    }
}

void displayBoard(){
    move(0,0);
    for(int i=0;i<BOARD_HEIGHT;i++){
        for(int j=0;j<BOARD_WIDTH;j++){
            addch(gameBoard[j][i]);
        }
        printw("\n");
    }
    refresh();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T13:49:50.497

对于第一个问题：

显示可能是错误的，因为您的地图数据文件中有 DOS 行结尾。（如果我在将地图数据`map3.txt`粘贴`getline()`到名为. )`\n``\r`

对于第二个问题：

`endwin()`本身工作正常；这里的问题是它不是最后一个被调用的东西：`printw()`当`refresh()`析`~chr()`构函数`player`在`main()`.

# php - PHP XPath Table 元素消失

> ID：11371858
> 
> 赞同：0
> 
> 时间：2012-07-07T02:44:02.610
> 
> 标签：php, parsing, xpath, html-parsing

我刚刚了解了 XPath，我只想从表中的某些列中读取数据。

我当前的代码如下所示：

```
<?php

$file_contents = file_get_contents('test.html');

$dom_document = new DOMDocument();

$dom_document->loadHTML($file_contents);

//use DOMXpath to navigate the html with the DOM
$dom_xpath = new DOMXpath($dom_document);

$elements = $dom_xpath->query("//tr[@class='rowstyle']");

if (!is_null($elements)) {
    foreach ($elements as $element) 
    {
        echo $element->nodeValue . '<br />';
    }
}
else
{
    echo 'none';
}

?> 
```

查询也是一个变体，因为通过我的研究，我发现嵌套表元素存在很多问题，但它产生了相同的结果：

```
$elements = $dom_xpath->query("//table[@class='tablestyle']/tbody/tr[@class='rowstyle']"); 
```

它确实抓取了一行数据，但它变成了一个字符串，将所有单元格组合成一个字符串并使标签消失。

我真正想做的是将这些单元格分开并获取特定的行号。

我也很好奇如何找出我拥有的 XPath 版本……我的 PHP 版本是 5.3.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T02:57:26.510

它没有组合这些单元格......`nodeValue`在这种情况下，你输出的行为就像`innerHTML`. 如果您想处理单元格本身，则`childNodes`使用行作为上下文的使用或 xpah 查询，然后循环遍历单元格。

例子：

```
$dom_xpath = new DOMXpath($dom_document);

$elements = $dom_xpath->query("//tr[@class='rowstyle']");
foreach ($elements as $element) 
{
  foreach($element->childNodes as $cell) {
     echo $cell->nodeValue . '<br />';
  }

} 
```

# python - 如何在 Django 中定义 3 个以上模型之间的多对多关系？

> ID：11371859
> 
> 赞同：1
> 
> 时间：2012-07-07T02:44:18.927
> 
> 标签：python, django

现在我有这些模型：电影、电影格式（例如，dvd、蓝光等）、区域，我想在这些模型之间建立关系以存储（电影、电影格式、区域、日期）元组（电影发行）

我可以通过另一个具有格式和日期字段的模型在电影引用区域上放置一个多对多字段，但这似乎不是这样做的“正确”方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T03:42:16.843

我不完全理解您要做什么，但我认为您以错误的方式看待这一点。

有了我关于什么是电影的想法（我试图在这里考虑面向对象），你应该使用的是这样的：

```
class Movie(models.Model):
    format = models.ForeignKey(MovieFormat)
    region = models.ForeignKey(Region)
    date = models.Datefield()
    ... other fields you want, like title for instance 
```

使用这样的模型，您可以在数据库中存储不同格式的电影（现在停止思考对象）（格式存储在其他表中，以便您的数据库标准化），每部电影的不同区域和日期（与区域相同）与此处的格式一样）。

这是你想要的吗？如果不是，请尝试更具体地回答您的问题...添加一些电影及其与地区和格式的关系的示例...

**编辑 ：**

现在我明白你想要什么了。我不知道如何命名我要添加的模型，但我相信你会找到一个合适的名称：

```
class Movie(models.Model):
    ... fields that you want for a movie, like foreing key to a producer for instance

class MovieEdition(models.Model):
    movie = models.ForeignKey(Movie)
    format = models.ForeignKey(MovieFormat)
    region = models.ForeignKey(Region)
    date = models.Datefield()
    ... other fields, like movie title for that region (the related region) 
```

希望能帮助到你！干杯!

# php - codeigniter 中的动态页面控制

> ID：11371863
> 
> 赞同：4
> 
> 时间：2012-07-07T02:45:30.433
> 
> 标签：php, codeigniter

在我的 CI 项目中，我想使用一个完整的动态页面控件。所以，我有两个控制器方法，它们加载 php 文件。模型控件的查询基于 url 段。根据 url 和数据库结果，在视图 php 文件中自动生成所有页面输出，index.php 文件除外。

这是正确的方法吗？

**控制器**

```
public function index()
 {
  $data['title'] = "Index";
  $data['nav'] = $this->content_model->get_index_nav(); //TODO

  $this->load->view('templates/header', $data);
  $this->load->view('templates/nav', $data);
  $this->load->view('templates/nav_pict', $data);
  $this->load->view('pages/aktualis', $data);
  $this->load->view('templates/footer', $data);
 }
 public function view($page)
 {
  $page = 'content';

  $this->load->helper('text');
  $this->load->helper('url'); 

  $page = lcfirst(convert_accented_characters(urldecode($page)));

  if ( ! file_exists('application/views/pages/'.$page.'.php'))
  {
   show_404();
  }

  $data['title'] = ucfirst($page); // Capitalize the first letter
  $data['nav'] = $this->content_model->get_nav();
  $data['content'] = $this->content_model->get_content();

  if(empty($data['content']))
  {
   show_404();
  }

  $this->load->view('templates/header', $data);
  $this->load->view('templates/nav', $data);
  $this->load->view('pages/'.$page, $data);
  $this->load->view('templates/footer', $data);
 } 
```

**模型（每个菜单在数据库中都有一个内容。创建新子菜单时，您必须添加内容）**

```
public function get_content()
 {
   $this->db->select('content.*, mainmenu.label');
   $this->db->from('content');
   $this->db->join('mainmenu', 'mainmenu.id = content.katId', 'left');
   $this->db->where('mainmenu.label', mysql_escape_string(urldecode(end($this->uri->segments))));

   $query = $this->db->get();

   return $query->result_array();

 } 
```

**路由**

```
$route['404_override'] = '';
$route['/:any/(:any)'] = 'pages/view/$1';
$route['(:any)'] = 'pages/view/$1';
$route['Index'] = 'pages/index';
$route['default_controller'] = 'pages/index'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T15:44:33.343

您使用 CodeIgniter 就好了，不需要任何结构修改。

# git - 试图找到一个完整的 git 变量列表

> ID：11371865
> 
> 赞同：3
> 
> 时间：2012-07-07T02:46:00.463
> 
> 标签：git

我在其他问题中看到了对各种 git 变量的引用，例如：

*   GIT_CURL_VERBOSE
*   GIT_SHELL

如何获得配置变量的完整列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T16:16:24.933

git config --help 和 git config -l 也可以用于相关原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T02:52:35.377

git 手册页（`man git`和搜索`^ENVIRONMENT`）有一个环境变量列表。

从版本 1.7.9.5 开始，共有 24 个。（`GIT_SHELL`不在该列表中，并且在 git 源代码中没有对它的引用。）它们都以`"GIT_"`except开头`EMAIL`。

我会在这里列出它们，但自己运行可能更有用`man git`，以确保您拥有适合您正在使用的版本的列表。

# entity-framework - 实体框架、MVVM 和计算类

> ID：11371868
> 
> 赞同：1
> 
> 时间：2012-07-07T02:46:32.813
> 
> 标签：entity-framework, design-patterns, mvvm, ef-code-first

我正在开发一个数据库应用程序，该应用程序管理特定于行业的输入，然后通过一些复杂的计算、查找等运行该信息，以返回一系列其他值和一个通过/不通过的结论。

我决定使用实体框架（代码优先用于提供程序独立性）和 WPF（MVVM 模式）。我使用 POCO 实体作为我的数据模型，而视图模型正在处理诸如基本数据/业务规则验证之类的常规操作。

似乎 EF + WPF/MVVM 非常擅长显示和验证输入并将其输入数据库以查询您的典型业务应用程序，例如产品、客户、订单设置。但根本不清楚在哪里插入“计算层”。在视图模型和数据模型（我的 POCO）之间，事情已经有点臃肿了，现在我正面临着添加另一个层，就像其他两个层一样。

也许解决这个问题的最好方法是使计算层成为一种元视图模型，并将尽可能多的验证、更改通知等推送到它们中，并使用更轻的实际视图模型运行。

有人遇到过这样的情况吗？

**编辑**

事实证明，我真正需要的是精简视图模型并增强实体。所以我减轻了视图模型，将属性更改通知和基本验证移至实体以允许直接绑定，并使计算类直接使用实体以及向实体添加一些基本例程。感谢思想 ADM 文章 @Peter Porfy 的链接。

为了使验证更接近实体，使用了[Fluent Validation](http://fluentvalidation.codeplex.com/)（极好的建议@Gloopy！）。为了更容易在实体上实现属性更改通知，采用[了这种技术](https://stackoverflow.com/a/1316566/856595)。为了避免在视图模型中创建无穷无尽的属性包装器（设置 HasChanges 属性），我使用了[Josh Smith 的 PropertyObserver](http://joshsmithonwpf.wordpress.com/2009/07/11/one-way-to-avoid-messy-propertychanged-event-handling/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T12:08:05.833

MVVM 代表`Model-View-ViewModel`，其中模型层包含对您的实际领域问题*建模的所有内容。*

所以这取决于你的意思是“计算层”。

把它放在它所属的地方。

如果实际操作属于域实体，那么您应该将该逻辑放入实体中。不要制作贫血的域模型：

[Martin Fowler](http://martinfowler.com/bliki/AnemicDomainModel.html)关于 ADM 的文章。

[DDD](http://en.wikipedia.org/wiki/Domain-driven_design)与 EF 代码优先完美配合。

如果某些东西不属于任何实体，那么您可能应该将其作为服务公开。然后通过`interface`.

[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)容器可以让你的生活更轻松，但你可以没有它。

您没有插入另一层，因为它是模型层。您的视图模型应尽可能保持精简，只需对视图的状态进行建模并将实际业务操作转发给实体/服务类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T08:04:09.513

我可能会创建一个接口/对象来处理计算（或几个，如果它们可以在逻辑上拆分）并将该对象传递到您想要使用它的任何地方。您可能会从使用依赖注入框架中受益，也许[这篇文章](https://stackoverflow.com/questions/9160450/ninject-constructor-injection-in-wpf)可以帮助您，这样您就不必在需要它们的地方显式实例化您的对象。

[这篇文章](https://stackoverflow.com/a/8923129)还提到[了 FluentValidation.NET](http://fluentvalidation.codeplex.com/)，它可能并不完全适用，但也可能有一些好的模式可以从中学习/使用。

# java - 如何显示基于外键groovy grails的列表

> ID：11371869
> 
> 赞同：2
> 
> 时间：2012-07-07T02:46:49.253
> 
> 标签：java, grails, groovy

我有两张桌子：`Region`和`District`。入表`region_id`也是如此（一个有一个或多个）。因此，当我在我的上选择 a 时，我只想显示与该特定. 我的正确代码显示所有独立于：`foreign key``District``region``districts``region``list``districts``region``districts``region`

```
def list = {
        params.max = Math.min(params.max? params.int('max') : 20, 100)
        [districtInstanceList : District.list(params),
        districtInstanceTotal: District.count()]
    } 
```

有人知道如何仅根据外键约束显示吗？我知道我可以`SQL`在我的闭包中写一个查询`list`，但我想 grails 可能有办法做到这一点。我的数据库是`MySQL`，`grails`版本是`2.0.1`。我的`District`域名是：

```
class District {

def scaffold = true

String name
String description
String logo
String homepage
// defines the 1:n constrain with the Region table
static belongsTo = [region : Region]
// defines the 1: constraint with the Stream table
static hasMany = [streams : Stream]

static constraints ={
    name(blank:false, minSize:6, maxSize:30)
    description(blank: false, maxSize:100)
}

public String toString(){
    name
}
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T03:59:32.670

您可以使用 GORM：

```
def list = {
    params.max = Math.min(params.max? params.int('max') : 20, 100)
    Region region = Region.get(params.id) // or what parameter you're using
    List districts = District.findAllByRegion(region)
    [districtInstanceList : districts,
    districtInstanceTotal: District.count()]
} 
```

您可以在此处阅读有关 Grails GORM 的信息：http: [//grails.org/doc/latest/guide/GORM.html](http://grails.org/doc/latest/guide/GORM.html)

# php - MySQL 如何通过 JOIN 获取更多信息？

> ID：11371871
> 
> 赞同：0
> 
> 时间：2012-07-07T02:48:01.647
> 
> 标签：php, mysql

目前，我有两个 MySQL 表。

第一个表存储朋友和他的图片之间的关系。

表格1

```
 id  |  pic_id  |  friend_id
----------------------------
 0   |  123     |  84589
 1   |  290     |  11390
 2   |  884     |  84589
 3   |  456     |  84589
 4   |  123     |  11111
 5   |  456     |  22222 
```

表 2

第二个表存储有关图片的更多信息...

```
id   |  pic_id  |  title   |  color  |  detail
----------------------------------------------
0    |  123     | hello    |  black  |  brush
1    |  124     | world    |   red   |  paint
2    |  884     | sample   |  green  |  star 
```

我使用 JOIN 来获取我需要的信息...

但是，如果我想使用上述 SQL 匹配的 pic_id 并找到具有相同 pic_id 的其他朋友 ID 怎么办？

例如，上面的 SQL 命令将给我行 0、2 和 3，pic_id 为 123、884、456。我应该使用什么 SQL 命令来循环这些 pic_id 并获取关联的friend_id？我想以 11111 为 pic_id 123 和 22222 为 pic_id 456 结束。

我已经使用以下代码来完成上述操作。它看起来效率不高，而且速度很慢。

```
$sql = "SELECT b.title, b.color, b.detail
FROM table1 a INNER JOIN table2 b
on a.pic_id = b.pic_id
WHERE friend_id = 84589";

$res = mysqli_query($link,$sql);
    if($res){
        while ($rec = mysqli_fetch_assoc($res)){
            $pic_id.=$rec['pic_id'].",";
            $arr[] = $rec;
        }
    } 

$each_id = explode(',',$pic_id);
    foreach($each_id as $key => $value){
        if ($value){
            $next_sql = "SELECT friend_id FROM table1 WHERE pic_id=".$value;
            $next_res = mysqli_query($link,$next_sql);

            if ($next_res){
                while($next_rec = mysqli_fetch_assoc($next_res)){
                    //do things
                }
            }
        }
    } 
```

对不起，如果这不清楚。请让我知道，我会澄清。

非常感谢所有帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T02:55:48.600

试试这个（更新）：

```
SELECT a.friend_id, a.pic_id
 FROM table1 a 
  WHERE EXISTS (SELECT 1 FROM table1 t 
          WHERE t.pic_id = a.pic_id AND t.friend_id = 84589) 
```

检查这个 - [http://sqlfiddle.com/#!3/91cdf/3](http://sqlfiddle.com/#!3/91cdf/3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T03:02:03.890

我认为您可以在现有加入之前通过自我加入获得想要的东西。此查询将返回一个以逗号分隔的共享图片的朋友 ID 列表。

```
SELECT 
  pic_detail.title, 
  pic_detail.color, 
  pic_detail.detail,
  GROUP_CONCAT(friend_pics.friend_id) as friend_ids
FROM table1 as root_pics
JOIN table1 as freind_pics 
  USING(pic_id)
JOIN table2 as pic_details
  ON root_pics.pic_id = pic_details.pic_id OR friend_pics.pic_id = pic_details.pic_id
WHERE friend_id = 84589
GROUP BY pic_detail.pic_id 
```

# button - 从窗口菜单获取按钮列表 - AppleScript

> ID：11371873
> 
> 赞同：2
> 
> 时间：2012-07-07T02:48:14.530
> 
> 标签：button, menu, applescript, itunes, automator

我可以获得一个主菜单项，并且我已经能够使用系统事件来选择并单击窗口中的特定按钮。我遇到了一个问题，我想获取属于弹出“工作表”的按钮的“句柄”。例如，iTunes 中的“airplay”按钮：

![在这种情况下，有 2 个项目](../Images/eed18fc460bde61da849b5a3c2f38f59.png)

我可以使用类似于以下内容的按钮来单击以打开工作表：

```
click button 10 of window "iTunes" of application process "iTunes" of application "System Events" 
```

我可以`key code`用来手动上下滚动，尽管我正在寻找一种最有效和最优雅的选择我想要的特定按钮的解决方案（在这种情况下，名称为“计算机”）

我正在使用辅助功能检查器，并且可以获得有关菜单的一些信息：

```
<AXApplication: “iTunes”&gt;
 <AXWindow: “iTunes”&gt;
  <AXMenu>
   <AXMenuItem: “AirPort Express”&gt;

Attributes:
   AXRole:  “AXMenuItem”
   AXRoleDescription:  “menu item”
   AXParent:  “&lt;AXMenu>”
   AXEnabled:  “1”
   AXPosition:  “x=1070 y=798”
   AXSize:  “w=146 h=22”
   AXTitle:  “AirPort Express”
   AXHelp:  “(null)”
   AXSelected (W):  “1”
   AXMenuItemCmdChar:  “(null)”
   AXMenuItemCmdVirtualKey:  “(null)”
   AXMenuItemCmdGlyph:  “(null)”
   AXMenuItemCmdModifiers:  “0”
   AXMenuItemMarkChar:  “(null)”
   AXMenuItemPrimaryUIElement:  “(null)”

Actions:
   AXCancel - cancel
   AXPress - press 
```

那么这些弹出窗口有特定的标题吗？喜欢`select button 1 of sheet 1 of...`

我认为这可能很容易，我在考虑这个问题。

干杯！博

我尝试了什么：

```
 --click menu item "Computer" of menu 1 of window "iTunes" of application process "iTunes"
    --tell application "System Events" to tell process "iTunes"
    --  tell menu 1 of menu bar item 1 of menu bar 2
    --      click menu item "Copy"
    --  end tell
    --end tell
    --click (every button whose value of attribute "AXTitle" is "Computer") of window "iTunes" of application process "iTunes"
    --tell window 1
    --click button "Computer" of tool bar 1 of window "iTunes" of application process "iTunes"
    --  click button 1 of group 1 of group 1 of window "iTunes" of application process "iTunes"
    --end tell
    click (menu item 2 of every menu item whose attribute "AXRoleDescription" is "menu item") of window "iTunes" of application process "iTunes"
    --click (button whose description is "menu item") of window "iTunes" of application process "iTunes" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T22:45:18.203

在自定义菜单上是不可能的：`<Window "iTunes"> --> <Menu>`

可以在弹出按钮上。`<Window "iTunes"> --> <popup button> --> <Menu>`

您必须继续使用`key code`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T04:25:50.320

**Accessibility Inspector**中显示的层次结构是您需要使用的。菜单在弹出之前不可用，因此您可能需要稍等一下 - 我没有任何外部扬声器要测试，但您可以执行以下操作：

```
tell application "System Events"
    click button 10 of window "iTunes" of application process "iTunes"
    delay 1 -- give menu time to pop up
    click menu item "Computer" of menu 1 of window "iTunes" of application process "iTunes"
end tell 
```

您可能还可以`click menu item "Computer" of front menu`在弹出菜单后使用。如果索引不正确，通常可以通过弹出菜单回溯层次结构，然后获取菜单找到正确的索引，然后获取菜单的菜单项等。

# php - Codeigniter 替换上传的图片

> ID：11371882
> 
> 赞同：6
> 
> 时间：2012-07-07T02:51:20.357
> 
> 标签：php, codeigniter, upload, avatar

我正在使用 Codeigniter 的[文件上传类](http://codeigniter.com/user_guide/libraries/file_uploading.html)来上传用户头像。每当他/她上传新的图像文件时，有没有办法替换用户的图像文件？我想用上传的最新头像替换现有头像。

我的图片上传控制器

```
function upload_avatar()
    {
        $config['upload_path'] = './uploads/avatars/';
        $config['allowed_types'] = 'jpg|png';
        $config['overwrite'] = FALSE; //overwrite user avatar
        $config['encrypt_name'] = TRUE;
        $config['max_size'] = '200'; //in KB

        $this->load->library('upload', $config);

        if ( ! $this->upload->do_upload())
        {
            $error = $this->upload->display_errors(); 

            $this->session->set_flashdata('error', $error);

            redirect('/settings/avatar');
        }
        else
        {                
            $config['image_library'] = 'gd2';
            $config['source_image'] = $this->upload->upload_path.$this->upload->file_name;
            $config['create_thumb'] = FALSE;
            $config['maintain_ratio'] = FALSE;
            $config['width'] = 120;
            $config['height'] = 120;

            $this->load->library('image_lib', $config); 

            $this->image_lib->crop();

            //Add image path to database
            $avatar_path = 'uploads/avatars/' . $this->upload->file_name;
            $user_id = $this->tank_auth->get_user_id();
            $this->Settings_model->update_avatar($avatar_path, $user_id);

            $this->session->set_flashdata('success', 'Avatar updated!');

            redirect('/settings/avatar');
        }
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-07T04:24:56.053

有一个公共属性`overwrite`指示覆盖原始文件的决定。默认情况下，会根据原始文件名创建一个新文件名。这是 CI 中 Upload.php 的源代码：

```
/*
 * Validate the file name
 * This function appends an number onto the end of
 * the file if one with the same name already exists.
 * If it returns false there was a problem.
 */
$this->orig_name = $this->file_name;

if ($this->overwrite == FALSE)
{
    $this->file_name = $this->set_filename($this->upload_path, $this->file_name);

    if ($this->file_name === FALSE)
    {
        return FALSE;
    }
} 
```

所以你需要做的就是让覆盖工作：

```
$this->load->library('upload', $config);
$this->upload->overwrite = true; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-27T03:42:17.060

简单设置“覆盖”在您的配置中为真。

```
$this->upload->initialize(array(
            "upload_path"=>$path,
            "allowed_types"=>"jpg|png|jpeg",
            "overwrite"=>true
        )); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-10-20T09:14:40.367

你有没有尝试改变

```
$config['overwrite'] = FALSE; 
```

到

```
$config['overwrite'] = TRUE; 
```

# android - android，在onCreate（）中创建线程时出错

> ID：11371886
> 
> 赞同：0
> 
> 时间：2012-07-07T02:53:16.627
> 
> 标签：android, multithreading

创建应用程序时，我想做一些长时间的操作（如复制/加载文件）。我为此创建了一个线程，该线程不会更新 UI。我收到一条错误消息，说如果不调用 Looper.prepare() 就无法在线程中创建处理程序。我的代码有什么问题？

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    threadFileManager = new Thread (
        new Runnable() {
            public void run() {
                FileManager fM = new FileManager();
                fM.copyFileFromAssetToStorage();                
        }
    }); 
    threadFileManager.start();
} 
```

编辑：错误在于我的 FileManager 类，当它是 Activity 的子类时。更改为服务工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T02:56:09.973

`Application`班级是做这件事的错误地方。如果需要，可以使用`Application`'`onCreate()`方法启动`Service`. 您应该在 a 中实现此后台线程`Service`，因为 的目的`Service`是在后台执行操作。该类`Application`应很少使用。这是维持最少量全局状态的最后手段。

一旦您将此代码移入`Service`, `Looper.prepare()`Android 就已经为您调用了。

编辑：

当他调用他的 FileManager 类的构造函数时，OP 实际上是试图在 Thread 内创建一个 Handler 。虽然我上面的评论仍然正确，但它与 OP 的问题无关，因为他是 Activity 而不是 Application 的子类。

需要明确的是，实际问题是他在尚未调用 Looper.prepare()（通过 new FileManager()）的线程内创建了一个处理程序。正确的解决方法是在主线程上创建处理程序，即在活动或服务回调之一中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T03:29:43.023

您可以使用 UI 线程从您的 Thread..like 更新 UI

```
 yourActivityName.this.runOnUiThread(new Runnable() {
    public void run() {
      //make UI modification here
  }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T04:44:11.663

试试这个：

```
protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Thread thread=new Thread(this);
        thread.start();
        }
    public void run() {
            FileManager fM = new FileManager();
            fM.copyFileFromAssetToStorage(); 
            handler.sendEmptyMessage(0);
        }
    private Handler handler = new Handler() {
            @Override
            public void handleMessage(Message msg) {

            }
        }; 
```

这将要求您对 Activity 实施 Runnable。希望这会对您有所帮助。

# c# - 命名空间“Microsoft.SqlServer.Management”中不存在类型或命名空间名称“Nmo”

> ID：11371888
> 
> 赞同：0
> 
> 时间：2012-07-07T02:53:42.163
> 
> 标签：c#, sql-server, dll, namespaces

我试图加载一个项目，但它说：

```
The type or namespace name 'Nmo' does not exist in the namespace 'Microsoft.SqlServer.Management' 
```

我只知道 Smo dll 但 Nmo？在哪里可以找到那个？

**更新：** 我添加了 2008 版本的 smo dll ......但它仍然给出错误......也许，我应该得到 sql 2005 版本的 smo dll？因为我得到这个项目的机器正在使用 sql 2005

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T03:36:56.447

引用标题为*“ [Microsoft SQL Server 2005 Notification Services](http://flylib.com/books/en/4.214.1.123/1/) ”*的文章：

> **NMO API 程序集和命名空间**
> 
> 要使用 NMO API，应用程序必须引用包含所需类的程序集。通常需要以下两个组件：
> 
> *   Microsoft.SqlServer.Smo.dll
>     
>     
> *   Microsoft.SqlServer.ConnectionInfo.dll
>     
>     
> 
> 第一个程序集 Microsoft.SqlServer.Smo.dll 包含 SMO 框架中的大部分类，包括 NMO 类（没有单独的 NMO 程序集）。Microsoft.SqlServer.ConnectionInfo.dll 包含用于建立数据库连接的实用程序类。使用 NMO API 的程序通常需要来自这两个程序集的类。
> 
> 您在使用 NMO 时会遇到的大多数类都定义在以下三个命名空间之一中：
> 
> *   Microsoft.SqlServer.Management.Nmo
>     
>     
> *   Microsoft.SqlServer.Management.Smo
>     
>     
> *   Microsoft.SqlServer.Management.Common
>     
>     
> 
> 第一个有时称为 NMO 命名空间。它包含所有 NMO 特定的类。第二个命名空间包含许多 SMO 类，其中一些是 NMO 编程所需要的。第三个命名空间包含常见的实用程序类，例如用于建立数据库连接的那些。

**编辑：**

[看这里](http://www.microsoft.com/en-us/download/details.aspx?id=15748)，搜索*“Microsoft SQL Server 2005 Management”*并下载相应的DLL。我解压缩它，它似乎包含一个 Microsoft.SqlServer.Smo 文件。当我尝试安装它时，我收到一条消息，指示我[下载一个先决条件](http://go.microsoft.com/fwlink/?LinkId=54583)（SQL Server Native Client），它引导我访问的页面似乎是 2005 DLL 的更新版本，因此您可能只想使用该页面中的 DLL。

另外，附带说明一下，如果您实际连接到 2008 SQL Server，您应该能够使用 2005 DLL 来管理它，但是使用旧 DLL 时将无法使用较新的“2008 特定”功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T03:32:24.080

Microsoft.SqlServer.Management.Nmo 命名空间包含用于开发和管理 Notification Services 实例和应用程序的类。这是更多信息的链接 [http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.nmo%28v=sql.90%29.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.nmo%28v=sql.90%29.aspx)

您需要添加“microsoft.sqlserver.smo.dll”程序集引用

# sql - 表达式或谓词的顺序对标准 SQL 中的外连接和 ANSI 连接的连接条件有什么不同吗？

> ID：11371890
> 
> 赞同：3
> 
> 时间：2012-07-07T02:54:39.967
> 
> 标签：sql

以典型的左外连接场景为例。我们都知道表格的顺序非常重要，例如，**Q1**和**Q2**是不等价的：

```
SELECT A.x, B.y FROM A LEFT OUTER JOIN B ON A.id = B.id -- (Q1)
SELECT A.x, B.y FROM B LEFT OUTER JOIN A ON B.id = A.id -- (Q2) 
```

当我从概念上考虑多重连接时，我通常会很自然地想象将新表作为感兴趣的对象，然后描述其行与之前的行之间的关系。保持条款并行对我没有任何好处，根据我自己的习惯，我通常这样编写连接条件：

```
SELECT A.x, B.y FROM A LEFT OUTER JOIN B ON B.id = A.id -- (Q3) 
```

我与一位误解了语法如何工作的前同事进行了交谈。对这位同事来说，**Q3**是错的，**Q1**是对的。而且我确实认识到，对于旧式外连接语法，这很重要，这很可能是造成这种混乱的根源。我从未听说过或见过其他人使用 ANSI 联接提出这种情况。请回答这个问题并挽回我的声誉，指出我忽略的一些事情，或者对错误的观点提供更深入的见解。

*表达式或谓词的顺序对标准 SQL 中的外连接和 ANSI 连接的连接条件有什么不同吗？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T03:21:16.653

不，没有区别。

我个人更喜欢你在Q3的风格，我的一些同事更喜欢Q1的风格。我不知道有谁会认为他们中的任何一个是*错误*的。

查询优化器将查询从里到外变成完全不同的东西，因此谓词在完成后甚至不再作为简单的比较存在。通常它是在索引或表中查找，并且由于只能在一个方向上完成，因此谓词的编写方式没有区别。

我检查了（在 SQL Server 2005 中）两个查询的执行计划，其中谓词操作数的顺序不同，并且正如预期的那样，它们是相同的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T03:48:47.227

我也更喜欢 Q3 的 JOIN 条件顺​​序：

```
... ON B.id = A.id -- (Q3) 
```

由于它直接反映 B.id 是变化更大的一个，因此您可以将 A.id 视为要测试的常数，例如

```
B.id = 1984 
```

同样，我不想在代码中看到这个......

```
1984 = B.id 
```

...，像你一样，我不想在查询中看到这个：

```
A.id = B.id 
```

然而，就像生活中的大多数事情一样，有人喜欢小端，也有人喜欢大端。无论他们选择哪种心智模式，他们都应该至少能够向你解释他们想要的理由`A.id = B.id`

我想，我必须改变我的偏好，但我的（和你的）首选条件顺序在某些 ORM 中不起作用，特别是在 Linq 中。我还没有理解为什么他们强加条件应该按照 Q1 的顺序：

```
from x in A
join y in B on x.id equals y.id 
```

并且反转条件（与 Q3 相同，尽管在 SQL 查询中它不是错误）命令导致语法错误，这不会被 Linq 接受：

```
from x in A
join y in B on y.id equals x.id 
```

现在，我必须找出 Microsoft Linq 设计人员偏爱 Q1 条件顺序的原因。如果它有意义，请尝试欣赏它，即使它（还）没有意义也要接受。

* * *

关于：

> 表达式或谓词的顺序对标准 SQL 中的外连接的连接条件有什么影响吗？

结果方面，**没有**。在性能方面，我还没有看到联接的条件顺序使查询更快的查询。即使在论坛中，我也没有看到有人支持反转条件以加快查询速度。

如果他们无法向您解释他们首选条件的订单服务的基本原理或心理模型，也许他们只是在做[Cargo Cult Programming](http://en.wikipedia.org/wiki/Cargo_cult_programming)或更糟的是，[Bikeshedding](http://en.wikipedia.org/wiki/Parkinson%27s_Law_of_Triviality)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-07T03:04:58.663

相等比较的顺序对连接的结果没有影响。但它可能会因为难以理解的原因影响计算结果的效率。SQL 优化器因受此类看似不重要的细节影响而臭名昭著。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-29T21:14:38.763

我更喜欢您的 Q1，但是它对性能*绝对*没有影响，并且对查询优化器绝对没有影响。

对我来说，在我的扫描过程中，把前面的表格放在第一位可以让我更快地获得相关信息。我可以阅读`join table B on A ...`并且已经知道哪两个表正在连接在一起。当我阅读时`join table B on B.blasdjasdid = ...`，我不得不扫描得更远，但仍然不知道最重要的信息，即正在加入哪个表（这是一种命名空间，一个可以理解列名的域）。此外，如果两个表中的列名称相同（在我设计的任何数据库中都是惯用的），我可以避免完全扫描到最后，只读`join table B on A.SomethingId ...`并且已经知道它是`= B.SomethingId`.

[再深入一点，我鼓励您在workplace.stackexchange.com](http://workplace.stackexchange.com)上询问此事件，因为我怀疑您的服务中断的原因与他们告诉您的不符；对此进行一些调查可能会有所帮助。我并不是说这是你的错，但给出的原因可能是一个借口。

# plugins - Symfony getUser 并保存到表单

> ID：11371902
> 
> 赞同：0
> 
> 时间：2012-07-07T02:57:17.903
> 
> 标签：plugins, symfony1, sfguard

我有一个 symfony 表单，其中包含一些用户无法编辑但在提交表单时自动设置的隐藏字段。我似乎无法设置的一个字段是用户 ID。表单是安全的，因此需要验证才能显示（sfDoctrineGuardPlugin）。

我正在寻找的是将“user_id”字段设置为当前登录用户名的表单。我在类文件中试过这个。

```
 if ($this->isNew() && ! $this->getSeller_Id())
    {
        $this->setSeller_Id($this->getUser()->getGuardUser()->getUsername());

    } 
```

但它总是返回一个错误，指出当前表中没有用户字段。我希望我解释得对。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T07:42:11.777

您可以将用户名作为选项传递给表单。在您的控制器中：

```
 $myform = new myObjectForm(NULL, array('username' => $this->getUser()->getGuardUser()->getUsername()); 
```

然后在`doSave`表单的功能中：

```
 public function doSave($con = null)
 {
    if ($this->getObject()->isNew() && !$this->getObject()->getSeller_Id())
    {
        $this->getObject()->setSeller_Id($this->options['username']);
    }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T11:35:33.827

不要在隐藏字段中设置 user_id。有人可以通过萤火虫改变它。我更喜欢在 proccessForm() 中使用此代码

试试这个（编辑）：

```
 $form = new YourForm();
    $this->user = $this->getUser()->getObject();

    $form->getObject()->setSellerId($this->user->getId());

    $form->bind($request->getParameter($form->getName())); 
```

# macos - 在 OSX Lion 上安装 JRE 7u5 后，JavaFX 不会导入

> ID：11371913
> 
> 赞同：2
> 
> 时间：2012-07-07T02:59:15.027
> 
> 标签：macos, java

我在运行 Lion 的 OSX 机器上安装了 JDK 7u5 以获取 Javafx，因此我可以使用 mp3 播放代码。

但是，当我这样做时：

```
import javafx.scene.media.Media; 
```

它说“无法解析导入 javafx”。我已在 Applications/Utilities/Java Preferences 中将 JDK 7 设置为我的首选 JDK 我还将 JDK 添加到 eclipse，并将其设置为该项目的 JDK。

我已经安装和卸载了几次 JDK。

# hive - 如何附加到 Hive 数组？

> ID：11371916
> 
> 赞同：0
> 
> 时间：2012-07-07T02:59:49.600
> 
> 标签：hive

我有一个 Hive 表，其中对于用户 ID，我有一个 ts 列，它是一个时间序列，存储为数组。我想将时间序列保持为最近的窗口。

(a) 如何将一个新数字附加到另一个由 ID 连接的表的每一列的末尾？(b) 如何删除前导数字？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T16:02:03.883

Hive 中的数据通常存储在 HDFS 中。HDFS 的附加功能有限。如果不断修改数据是分析系统的核心，那么也许您应该考虑使用 HBase 或 Cassandra 等替代方案。

但是，如果数据更新只是您工作流程的一小部分，我会鼓励您继续使用 Hive（以便利用它的类似 SQL 的功能），但重新考虑您的存储这些更新的设计。

对上述问题的快速解决方案是在表中为每个用户 ID 设置多个记录。每条记录都有对应于用户 ID 的时间序列。当您想对时间序列进行最后一次 N 分析时，您应该通过在 User ID 列上使用 by [Distribute By从表中进行选择。](https://cwiki.apache.org/Hive/languagemanual-transform.html)您的自定义 reducer 将简单地挑选最后 N 个（或更少，如果时间序列的大小小于 N）时间戳并返回它们。

Harish Butani 还对 Hive 中的 Windowing 函数做了一些工作。您还可以查看[他的工作](https://github.com/hbutani/SQLWindowing)和[相关文档](https://github.com/hbutani/SQLWindowing/blob/master/docs/Windowing.pdf)以获得更多见解。祝你好运，亚历克西！

# oracle - 如何在 Oracle 中杀死用户会话静默或重现错误 17410？

> ID：11371917
> 
> 赞同：1
> 
> 时间：2012-07-07T03:00:07.333
> 
> 标签：oracle, session, jdbc, kill, silent

我需要测试我的应用程序是否存在网络问题的稳健性。但我无法物理访问网络。我只能以 SYS 身份访问 Oracle。是否有可能静默杀死用户会话，因此当应用程序尝试从连接 jdbc 驱动程序获取数据时会生成错误 17410？

```
oracle: No more data to read from socket 
```

当我尝试通过 sid 终止会话时 - oracle 发送有关终止会话的警报，这不是 17410 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T21:01:46.453

您可以使用 PRAGMA EXCEPTION_INIT 引发任何错误代码。

```
DECLARE
  e_no_more_data EXCEPTION
  pragma exception_init( e_no_more_data , -17410  );
BEGIN
  RAISE e_no_more_data;
END;
/ 
```

不知道是不是真的模拟了错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T03:27:37.580

如果您只能访问数据库并且您知道要终止的会话的 SID 和序列号，则可以发出

```
ALTER SYSTEM KILL SESSION 'sid,serial#'; 
```

检查此链接以获取更多选项。

[http://www.oracle-base.com/articles/misc/killing-oracle-sessions.php](http://www.oracle-base.com/articles/misc/killing-oracle-sessions.php)

# c - 如何使用“x = x++”之类的内容获得 VS 或 Xcode 警告？

> ID：11371920
> 
> 赞同：5
> 
> 时间：2012-07-07T03:01:10.580
> 
> 标签：c, visual-studio-2010, xcode4.3, undefined-behavior, sequence-points

本着与诸如[“x = ++x”之类的序列点相关的未定义行为的精神，它真的是未定义的吗？](https://stackoverflow.com/questions/3619323/x-x-is-it-really-undefined)，如何让编译器抱怨这样的代码？

具体来说，我正在使用 Visual Studio 2010 和 Xcode 4.3.1，后者用于 OSX 应用程序，但都没有警告我这一点。我什至将 VS2010 上的警告调高为“全部”，它愉快地编译了这个。（作为记录，VS2010 的版本在变量中添加了 1，而 Xcode 的版本保持变量不变。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T03:06:58.693

AFAIK，Visual Studio 不会检测到这种情况。而且我个人不相信这样做有什么意义。我会说，对于这样一个相当明显的案例的警告将主要具有教育价值，但没有太大的实际价值。在一般情况下，所讨论的问题发生在诸如`*p = ++*q`何时`p`并且`q`恰好指向同一个对象的情况下。不用说，编译器无法检测到它们。

# python - 如何生成跨模型的 TabularInline

> ID：11371921
> 
> 赞同：1
> 
> 时间：2012-07-07T03:01:37.847
> 
> 标签：python, django, django-admin

我有一个带有 OneToOneField（线程）的模型（预订），该模型随后具有外键关系（消息）。我想在 Booking 管理员上显示消息列表，但是在中间的 Thread 模型中，这似乎很难/不可能？

```
Class Booking(Model):
    ...
    thread = models.OneToOneField('user_messages.Thread', verbose_name='thread')

class Thread(Model):
    ...

class Message(Model):
    thread = models.ForeignKey(Thread, related_name="messages") 
```

有没有办法可以使用可以显示消息的内联设置我的 BookingAdmin（跨越线程关系）？就像是：

```
class MessageInline(TabularInline):
    model = Message
    fk_name = '???'

class BookingAdmin(ModelAdmin):
    inlines = [MessageInline, ] 
```

如果这是最好的方式，我很乐意覆盖内联的工作方式，但我不确定在哪里解决这个问题。看起来覆盖 *get_formset* 可以解决问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T04:15:31.803

这还没有完全测试，但似乎工作。解决方案是有一个带有钩子的内联和表单集，以用附加的线程替换预订......

```
class BookingMessageFormset(BaseInlineFormSet):
    '''Given a Booking instance, divert to its Thread'''
    def __init__(self, *args, **kwargs):
        if 'instance' in kwargs:
            kwargs['instance'] = kwargs['instance'].thread
        else:
            raise Exception()  # TODO Not sure if/when this happens
        BaseInlineFormSet.__init__(self, *args, **kwargs)

class MessageInline(admin.TabularInline):
    model = Message
    formset = BookingMessageFormset

    def __init__(self, parent_model, admin_site):
        '''Override parent_model'''
        super(MessageInline, self).__init__(Thread, admin_site) 
```

# ios - 从 NSMutable 字典中获取最后添加的键值对

> ID：11371926
> 
> 赞同：0
> 
> 时间：2012-07-07T03:02:52.043
> 
> 标签：ios, xcode, nsmutabledictionary

我有一个存储用户配置文件集合的 NSMutableDictionary，我将如何获取最后添加的配置文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T03:09:36.940

NSDictionary 不提供开箱即用的此类服务。随意从中派生另一个类，并将最后添加的对象的键存储在 ivar 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T03:07:01.380

`NSDictionary`对象是无序的（通常在任何语言中，字典都是无序的）哈希表。我建议使用 an`NSArray`代替。您可以使用 NSDate 时间戳作为键，但是您必须遍历每个键才能找到最新的键，这可能会很慢。

# r - 查看内置 R 包的源代码

> ID：11371928
> 
> 赞同：1
> 
> 时间：2012-07-07T03:03:14.280
> 
> 标签：r

> **可能重复：**
> [查看 R 包的源代码](https://stackoverflow.com/questions/1788779/view-the-source-of-an-r-package)

我想看看 stats::reorder 的源代码。

[这个答案](https://stackoverflow.com/questions/1788779/view-the-source-of-an-r-package)似乎不适用于编译为字节码的内置包：

```
> 统计::重新排序
函数 (x, ...)
使用方法（“重新排序”）
>字节码：0x103321718<
>环境：命名空间：统计数据<

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-07T03:24:47.030

这与将重新排序编译为字节码以及与它作为通用函数有关的一切无关。

[我在这里](https://stackoverflow.com/questions/11173683/how-can-i-read-the-code-for-summary-for-a-data-frame/11173734#11173734)的回答详细说明了这一点。

但是专门针对这种情况，如果您想查看可以使用的代码

```
# Find what methods are available for reorder
methods(reorder)
# Attempt to check out the code for reorder.default
reorder.default
# Use getAnywhere to view code regardless of if it is exported
getAnywhere(reorder.default) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T03:30:08.250

正如其他人所说，你想要`methods(reorder)`. 但是对于您的模式一般问题，最好的方法是下载 R 的源代码，并使用`grep`. 您也可以[在线](http://svn.r-project.org/R/trunk/src/library/stats)浏览代码，但特定函数可能存在于哪个文件中并不总是很明显。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T03:23:35.093

这不是编译的问题，您所看到的是`reorder`根据您要重新排序的类别而编写的执行不同操作的事实的结果。对于不同的可能选项，有单独的重新排序函数，您可以通过调用列出它们`methods(reorder)`。然后，您可以检查任何一个合适的来源。

# ios - iOS - 纵向锁定选项卡控制器应用程序不允许横向电影播放器

> ID：11371930
> 
> 赞同：2
> 
> 时间：2012-07-07T03:03:20.967
> 
> 标签：ios, uitabbarcontroller, mpmovieplayercontroller, landscape-portrait

我有一个应用程序，它纯粹是一个带有 5 个选项卡（视图）的选项卡栏控制器。我希望这些视图只是纵向的。但是，该应用程序确实允许播放视频剪辑，并使用 MPMoviePlayerViewController 来播放。但我无法让玩家旋转到横向！

我尝试了以下（以及许多其他事情）：子类化 MPMoviePlayerViewController 并覆盖该类的 shouldAutorotateToInterfaceOrientation 方法。

允许应用程序具有横向方向，然后尝试将选项卡视图锁定为纵向（不锁定它们，允许它们进入我不想要的横向）。

我已经搜索 StackOverflow 和 Google 好几天了！任何熟悉这个问题以及如何让电影播放器​​旋转的人？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T03:50:48.547

尝试实现 UIViewController[遏制](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW81)。将要在其中显示影片的选项卡的 viewController 指定为父（或容器）viewController。

您将希望在子类中覆盖 shouldAutorotateToInterfaceOrientation 以仅允许横向，这听起来像是您已经完成的。在您的父视图控制器和 tabBarController 中，您需要确保它们将自动旋转方法转发给您的子类。您可以通过在 shouldAutorotateToInterfaceOrientation 的子类实现中放置 NSLog 来检查这一点。

然后，当您要显示视频时，将 MPMoviePlayerViewController 的子类添加到它。

当您加载电影播放器​​的子类时，请尝试在父视图控制器中执行此操作：

```
[self addChildViewController:self.subclassedMoviePlayerViewController];
[self.view addSubview:self.currentViewController.view];
[self.subclassedMoviePlayerViewController didMoveToParentViewController:self]; 
```

或者，如果您想为更改设置动画，您可以执行以下操作：

```
CGRect viewFrame=self.subclassedMoviePlayerViewController.view.frame;
CGFloat viewHeight=inputViewFrame.size.height;

CGRect newFrame=CGRectMake(0, self.view.frame.size.height, viewFrame.size.width, viewFrame.size.height);

self.subclassedMoviePlayerViewController.view.frame=newFrame;
[self addChildViewController:self.subclassedMoviePlayerViewController];

CGRect offSetRect=CGRectOffset(newFrame, 0, -inputViewHeight);

[self.view addSubview:self.subclassedMoviePlayerViewController.view];
[UIView animateWithDuration:0.2
                 animations:^{
                      self.subclassedMoviePlayerViewController.view.frame=offSetRect;
                 }
                 completion:^(BOOL finished){
                     [self.subclassedMoviePlayerViewController didMoveToParentViewController:self];
                 }]; 
```

当然，在添加之前，您必须为电影播放器​​视图控制器的子类设置视图框架。

那么当你想删除它时：

```
[self.subclassedMoviePlayerViewController willMoveToParentViewController:nil];
[self.subclassedMoviePlayerViewController.view removeFromSuperView];
[self.subclassedMoviePlayerViewController removeFromParentViewController]; 
```

祝你好运

吨

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T21:42:10.610

终于解决了这个问题！

好的，所以必须在父视图控制器（在我的情况下，选项卡视图的控制器）中覆盖一个重要的方法：

```
-(BOOL)automaticallyForwardAppearanceAndRotationMethodsToChildViewControllers {
    return NO;//This must be NO to allow any child views to use their own orientation
} 
```

然后在我子类化的 MPMoviePlayerViewController 中，将其设置为方向：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;//This allows all orientations, set it to whatever you want
} 
```

然后我从选项卡视图控制器中呈现这样的 MPMoviePlayerViewController：

```
- (IBAction)buttonVideo:(id)sender {
    MovieViewController *vc = [[MovieViewController alloc] initWithContentURL:@"http://www.MY-VIDEO-URL.com"];
    [self presentMoviePlayerViewControllerAnimated:vc];  
} 
```

还有哇啦！一个电影播放器​​，允许在纵向锁定的标签栏应用程序中的所有方向！

# c - 在循环中收集字符串并打印输出循环外的所有字符串

> ID：11371931
> 
> 赞同：1
> 
> 时间：2012-07-07T03:03:34.903
> 
> 标签：c, string, pointers, loops, char

我是这里的新手，有一些问题想从你们那里得到一些教训。例如：

```
#include <stdio.h>
#include<stdlib.h>
#include<ctype.h>

void main()
{
    char name[51],selection;

    do
    {

    printf("Enter name: ");
    fflush(stdin);
    fgets(name,51,stdin);
    printf("Enter another name?(Y/N)");
    scanf("%c",&selection);
    selection=toupper(selection);
    }while (selection=='Y');
                     //I want to printout the entered name here but dunno the coding
printf("END\n");
system("pause");
} 
```

据我所知，循环何时执行会覆盖变量，那么我如何执行编码以打印出用户输入的所有名称？我已经问过我的导师，他要求我使用指针，在这种情况下有人可以指导我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T05:31:31.463

您基本上有两个选项，创建所有名称的列表，在最后循环遍历每个名​​称，或者在读取它们时将所有名称连接成一个字符串，并在最后打印整个缓冲区。第一个大致是这样的：

```
 char ch[2]="Y", names[100][52]; //store up to 100 50-char names (leaving space for \n and \0)
 int x, nnames=0;
 while(nnames<100 && *ch=='Y'){
     fgets(names[nnames++], sizeof names[0], stdin); //since names is a 2d array, look
     //only at the length of a row, (in this case, names[0])
     fgets(ch, 2, stdin);
     *ch = toupper(*ch);
 }
 for(x=0; x<nnames; x++)
     //print names[x]. 
```

第二个大致是这样的：

```
 char names[100*52], *np=names, *ep=names+sizeof names; //an array, the position, and the end
 char ch[2]="Y";
 while(np<ep && *ch=='Y'){
      fgets(np, ep-np, stdin); //read a name, and a newline into the buffer
      //note how I use the difference between the end and the position to tell
      //fgets the most it can possibly read
      np+=strlen(np); //advance the position to the end of what we read.
      //same deal with the y/n stuff...
 }
 printf("%s", names); 
```

注意最后没有循环，因为整个字符串都存储在名称中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T03:07:03.280

您可以使用链接列表来存储所有输入的名称。所有的数据结构书籍都大量谈论链表。

```
#include <stdio.h>
#include <stdlib.h>

struct name_node
{
    char name[100];
    struct name_node *next;
};

struct name_node* add_name(struct name_node *first, const char *name)
{
    struct name_node *p;

    /* create our node */
    p = (struct name_node*)malloc(sizeof(struct name_node));
    strcpy(p->name, name);
    p->next = NULL;

    /* link our node to the tail */
    if (first) {
        for (; first->next; first = first->next);
        first->next = p;
    }

    return p;
}

void print_names(struct name_node *first)
{
    /* print names stored in the list */
    for (; first; first = first->next) {
        printf("%s\n", first->name);
    }
}

/* free the memory we used */
void destroy_list(struct name_node *first)
{
    if (first) {
        if (first->next)
            destroy_list(first->next);

        free(first);
    }
}

int main(void)
{
    struct name_node *head = NULL;
    struct name_node *node;
    char name[100];
    char selection;

    do {
        printf("Enter name: ");
        fflush(stdin);
        fgets(name, 51, stdin);

        /* save the user input to a linked list */
        /* save head if we don't have head */
        node = add_name(head, name);
        if (!head)
            head = node;

        printf("Enter another name?(Y/N)");
        scanf("%c", &selection);
        selection = toupper(selection);
    }
    while (selection == 'Y');

    /* print the list if we have any data */
    if (head)
        print_names(head);

    /* free the memory we used */
    destroy_list(head);

    printf("END\n");
    system("pause");

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T04:40:17.150

使用单个字符串获取所有名称：

```
char allnames[1000] = "";

do {
    //get name in fgets
    selection = toupper(selection);
    strcat(allnames, selection);

    //Check for repetion

} while (/*there is repetion*/);

printf("%s", allnames); 
```

您必须适当地选择所有名称的大小以存储所有名称。

# python - 除了内置的，还有其他方法可以遍历自定义类的属性吗？

> ID：11371933
> 
> 赞同：11
> 
> 时间：2012-07-07T03:04:03.380
> 
> 标签：python, class, attributes, python-3.x

是否有另一种方法可以仅遍历未内置的自定义类的属性（例如`__dict__`，`__module__`等）？例如，在这段代码中：

```
class Terrain:
    WATER = -1
    GRASS = 0
    HILL = 1
    MOUNTAIN = 2 
```

我可以像这样遍历所有这些属性：

```
for key, value in Terrain.__dict__.items():
    print("{: <11}".format(key), " --> ", value) 
```

输出：

```
MOUNTAIN     -->  2
__module__   -->  __main__
WATER        -->  -1
HILL         -->  1
__dict__     -->  <attribute '__dict__' of 'Terrain' objects>
GRASS        -->  0
__weakref__  -->  <attribute '__weakref__' of 'Terrain' objects>
__doc__      -->  None 
```

如果我只想要整数参数（枚举类型的[基本版本](https://stackoverflow.com/a/36937/869912)），我可以使用它：

```
for key, value in Terrain.__dict__.items():
    if type(value) is int: # type(value) == int
        print("{: <11}".format(key), " --> ", value) 
```

这给出了预期的结果：

```
MOUNTAIN    -->  2
WATER       -->  -1
HILL        -->  1
GRASS       -->  0 
```

是否可以仅遍历与类型无关的自定义类的非内置属性，例如，如果属性不都是完整的。大概我可以扩展条件以包含更多类型，但我想知道是否还有其他我遗漏的方法。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-07T03:09:35.043

我会使用：

```
for key, value in Terrain.__dict__.items():
    if not key.startswith("__"):
        print(...) 
```

或者我会创建一个实际的枚举类型来满足我的需求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T03:24:16.617

你可以尝试这样的事情：

```
class GenericClass(object): pass
class_builtins = set(dir(GenericClass))

terrain_attributes = {attr: getattr(Terrain, attr) for attr in dir(Terrain) if attr not in class_builtins} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-07T04:50:02.470

内置属性应该以 '__' 开头和结尾，所以：

```
[(k,v) for k,v in Terrain.__dict__.items() if not (k.startswith('__')
    and k.endswith('__'))] 
```

有些人喜欢创建自己的`__attributes__`代码，因此这些代码无法正常工作。*嘿，这个命名空间被保留*是有原因的

 *您还必须检查`__slots__`*

# android - Android SDK r20 中的 bootclasspathref

> ID：11371937
> 
> 赞同：1
> 
> 时间：2012-07-07T03:05:18.813
> 
> 标签：android, ant, sdk

我刚刚从 Andriod SDK r19 升级到 r20。当我尝试使用 r20 构建项目时，出现错误：

找不到引用 android.target.classpath。

build.xml 片段是：

```
`<javac source="${java.source}" target="${java.target}"
debug="true" extdirs=""
destdir="${native.classes.dir}"
bootclasspathref="android.target.classpath"
verbose="${verbose}">
<src path="${src.dir}" />
<include name="DifferentTouchInput.java"/>
<include name="NativeView.java"/>
<include name="EventBridge.java"/>
<include name="Timer.java"/>
<include name="InternalGPS.java"/>
<include name="NonGPSSensors.java"/>
<include name="KalmanFilter.java"/>
<include name="Settings.java"/>
<include name="SafeDestruct.java"/>
<include name="InputListener.java"/>
<include name="NativeInputListener.java"/>
<include name="DownloadUtil.java"/>
</javac>` 
```

bootclasspathref 和 android.target.classpath 应该在其他地方定义什么？我是 Adndroid 和 ant 的新手，所以这可能是我缺乏知识造成的问题。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T15:24:50.460

有人给我的答案是 SDK 的 API 发生了变化。片段现在应该是：

```
- <target name="compile-jni-classes" depends="-setup">
+ <target name="compile-jni-classes" depends="-build-setup">
<mkdir dir="${native.classes.dir}"/>
<javac source="${java.source}" target="${java.target}"
debug="true" extdirs=""
destdir="${native.classes.dir}"
- bootclasspathref="android.target.classpath"
+ bootclasspathref="project.target.class.path"
verbose="${verbose}">
<src path="${src.dir}" /> 
```

# php - 我如何将 FQL 与 php api 一起使用？和访问令牌

> ID：11371938
> 
> 赞同：-2
> 
> 时间：2012-07-07T03:05:39.050
> 
> 标签：php, facebook-graph-api, facebook-fql, access-token

Grr ...我似乎无法让 fql 工作。有一件事，我认为文档很旧，因为我不认为 api() 只喜欢一个数组。反正：

```
$user_id = $facebook->getUser();//works
$access_token = $facebook->getAccessToken();//works
$fql = 'SELECT name from user where uid = ' . $user_id;
    $ret_obj = $facebook->api(array(
                                   'method' => 'fql.query',
                            'access_token' => $access_token,
                                  'query' => $fql,
                                 ));
print_r($ret_obj);// dont work. actually I get exceptions 
```

我已经尝试了 api() 的各种参数组合，但无济于事。

```
$user = curl('https://graph.facebook.com/'.$user_id.'?access_token='.$access_token); 
```

不过，确实有效。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-07T04:05:41.990

我用这个：

```
function fql($q, $access_token) {
    // Run fql query
    $fql_query_url = 'https://graph.facebook.com'
    . '/fql?q='. urlencode($q)
    . '&access_token=' . urlencode($access_token);
    $fql_query_result = file_get_contents($fql_query_url);

    $length = strlen(PHP_INT_MAX);
    $fql_query_result = preg_replace('/"(user_id)":(\d{' . $length . ',})/', '"\1":"\2"', $fql_query_result);

    return json_decode($fql_query_result, true);
} 
```

# python - 使用 Python 在新进程中执行函数

> ID：11371944
> 
> 赞同：0
> 
> 时间：2012-07-07T03:07:05.773
> 
> 标签：python, multithreading, subprocess, multiprocessing

有没有办法做到这一点？我在想也许使用子进程或多进程，但我不知道该怎么做？

我没有任何示例代码，因为这只是一个一般性问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T03:08:53.950

[http://docs.python.org/library/subprocess.html](http://docs.python.org/library/subprocess.html)

编辑：可能，我错过了，你想要什么。好吧，我能想象你的问题。

```
subprocess.call(["ls","-lAd"]) # executes external program. Like system()
# Capture output. Like popen, as I remember.
subprocess.check_output(["echo", "Hello World!"]) 
os.fork() # Binding to fork()

class MyThread(threading.thread):
    def run():
        print("Hello from thread")

MyThread().start() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-05T19:40:04.490

是的，
python 提供了 2 种不同的方法来执行此线程和多处理，您应该使用哪种方法取决于您执行的操作。
主要区别在于线程在同一个解释器中执行函数，而多处理启动一个新的解释器并在该解释器中运行函数。这意味着当您执行 cpu 绑定操作（例如添加大量数字）和线程用于 iobound 操作（例如输入或等待某事发生）时，通常会使用多处理。
线程示例：

```
from threading import Thread
import time

def fun(a):
    global myVar
    myVar = "post start" # as you can see myVar is updated and can be read by the main Thread
    time.sleep(1)
    f = input(a)
    print(f"inputed {f}")

myVar = "preThread"
t = Thread(target=fun,
           args=("plz input your message ",))
t.start() # start the thread 

print("this whil run after the thread started", myVar)
t.join() # wait for thread to finisch executing
print("this whil run after the thread ended", myVar) 
```

输出

```
this whil run after the thread started post start
plz input your message k
inputed k
this whil run after the thread ended post start 
```

如果您使用多处理库，它会启动一个新的 python 解释器并将所有值复制到其中，并且打印和输入将不起作用

```
from multiprocessing import Process
import time

def fun(a):
    global myVar
    myVar = "post start" # as you can see myVar is updated and can be read by the main Thread
    time.sleep(1)
    f = input(a)
    print(f"inputed {f}")

myVar = "preThread"
t = Process(target=fun,
            args=("plz input your message ",))
t.start() # start the thread 

print("this whill run after the thread started", myVar)
t.join() # wait for thread to finisch executing
print("this whill run after the thread ended", myVar) 
```

输出：

```
this whill run after the thread started preThread
this whill run after the thread ended preThread 
```

如果您想了解更多信息，请阅读
[https://docs.python.org/3/library/threading.html](https://docs.python.org/3/library/threading.html)了解线程
[https://docs.python.org/3/library/multiprocessing.html](https://docs.python.org/3/library/multiprocessing.html)了解多处理\

# django-celery - 在 django settings.py 中导入 CELERY* 环境变量会导致 celeryd 无法启动

> ID：11371946
> 
> 赞同：0
> 
> 时间：2012-07-07T03:07:42.340
> 
> 标签：django-celery

我只花了 2 个小时试图弄清楚为什么 django celery 停止工作。

Celery 将启动，但不会打印出配置项，这意味着它启动不正确。日志将仅包含

`The `celery.decorators` module along with the magic keyword arguments, are deprecated, and will be removed in version 3.0.`

 `Please use the `celery.task` module instead of `celery.decorators`, and the `task.request` should be used instead of the magic keyword arguments:

```
from celery.task import task 
```

See [http://bit.ly/celery22major](http://bit.ly/celery22major) for more information.` 

`"""))`

事实证明，我正在导入一些 celery env 变量以尝试解决不同的问题，导致 celery 无法正确启动：

```
from celery.tests.config import CELERY_QUEUES, CELERY_DEFAULT_QUEUE, CELERY_DEFAULT_ROUTING_KEY 
```

即使我没有在任何地方使用它们。

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T08:07:30.037

我要导入的常量实际上是为 celery*测试*(celery.tests.config) 定义的常量。导入时，它们对应的值进入 settings.py 的范围，因此当 celeryd 运行时，而不是默认为它们（正确的）各自的值，celery 最终使用 celery.tests.config 中定义的测试 CELERY_QUEUES。

# ftp - 421 抱歉，此服务器不接受明文会话。

> ID：11371947
> 
> 赞同：56
> 
> 时间：2012-07-07T03:07:44.870
> 
> 标签：ftp

我正在尝试从我的网络浏览器访问 ftp，但我收到以下错误：421 抱歉，此服务器不接受明文会话。有任何想法吗？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-07-07T03:12:35.470

“421 抱歉，此服务器不接受明文会话”表示服务器正在使用“FTP Over Explicit TLS/SSL”。这是一件好事。

您*可以*通过提供协议“ftpes:”而不是“ftp:”来修复它：

*   `ftpes://ftp.somesite.com/some_folder`

    ... 或者 ...

*   `ftps://ftp.somesite.com/some_folder`

除了默认浏览器之外，您可能还需要使用另一个 FTP 客户端。

我不知道较新版本的 IE 是否支持基于 SSL 的 FTP。

Filezilla 可能是一个不错的选择：

*   [https://filezilla-project.org/](https://filezilla-project.org/)

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2013-03-29T04:08:02.233

在 Filezilla 中.. 在“文件”下单击图标以打开“站点管理器”.. 然后右键单击默认情况下可能已经打开的“常规”选项卡。

在第三行显示“加密”..选择“要求通过 TLS 显式 FTP”

那个对我来说很好用。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-01-18T03:28:41.007

解决方法：
在域名前加个ftpes://

**例如 Old One**，
主机：domain.com
用户名：xxx
通行证：yyy
端口：21

**现在新的。**
主机：ftpes://domain.com
用户名：xxx
密码：yyy
端口：21

**高级选项**，

登录到 Web 主机管理器
转到：服务配置
转到：FTP 服务器配置
检查：
TLS 加密支持：设置为“可选”<br/>

试试看，它会起作用的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-07-20T04:53:20.440

我也面临同样的问题，并在做了以下事情后解决了。如果你使用 filezilla 作为 ftp 客户端，那么试试这个。

主持人：**`ftpes://mydomain.com`**

用户名：`yourUsername`

密码：`yourPassword`

您只需修改`Host URL`. `ftpes://`在域名前添加 。

基本上这个问题只有在你试图从你的 linux(Ubuntu) 机器上访问你的 web 服务器时才会出现。从Windows系统它工作正常。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-11-15T06:57:57.003

`ftpes://`在域名前加a

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-12T09:14:30.937

如果这不适用于此更改，请执行以下更改。在 Filezilla 中转到

```
 Edit=>Settings=>Connection=>FTP
  Here Change transfer mode from Active to Passive and press OK and try connecting again. 
```

# c++ - 由于多个抽象基类，实现两个具有相同名称但不同的非协变返回类型的函数

> ID：11371953
> 
> 赞同：6
> 
> 时间：2012-07-07T03:09:46.850
> 
> 标签：c++, multiple-inheritance, virtual-functions, overriding, abstract-base-class

如果我有两个抽象类定义了一个具有相同名称但不同的非协变返回类型的纯虚函数，我如何从这些类派生并为它们的两个函数定义一个实现？

```
#include <iostream>

class ITestA {
    public:
        virtual ~ITestA() {};
        virtual float test() =0;
};

class ITestB {
    public:
        virtual ~ITestB() {};
        virtual bool test() =0;
};

class C : public ITestA, public ITestB {
    public:
    /* Somehow implement ITestA::test and ITestB::test */
};

int main() {
    ITestA *a = new C();
    std::cout << a->test() << std::endl; // should print a float, like "3.14"
    ITestB *b = dynamic_cast<ITestB *>(a);
    if (b) {
        std::cout << b->test() << std::endl; // should print "1" or "0"
    }
    delete(a);
    return 0;
} 
```

只要我不直接调用 C::test() 就没有任何歧义，所以我认为它应该以某种方式工作，我想我只是还没有找到正确的符号。或者这是不可能的，如果是这样：为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T07:28:22.360

好吧，有可能，而且方式也不算太难看。我必须添加一个额外的继承级别：

```
 ITestA       ITestB     <-- These are the interfaces C has to fulfill, both with test()
    |           |
ITestA_X     ITestB_X    <-- These classes implement the interface by calling a
    |           |             function with a different name, like ITestA_test
    \__________/              which is in turn pure virtual again.
         |
         C               <--  C implements the new interfaces 
```

现在 C 没有 function `test()`，但是当将 a`C*`转换为 an时，将使用in`ITestA*`的实现。当将其转换为 时，即使是从 中的 dynamic_cast ，也将使用的实现。以下程序打印：3.14 0`test()``ITestA_test``ITestB*``ITestA*``ITestB_test`

```
#include <iostream>

class ITestA {
    public:
        virtual ~ITestA() {};
        virtual float test() =0;
};

class ITestB {
    public:
        virtual ~ITestB() {};
        virtual bool test() =0;
};

class ITestA_X : public ITestA {
    protected:
        virtual float ITestA_test() =0;
        virtual float test() {
            return ITestA_test();
        }
};

class ITestB_X : public ITestB {
    protected:
        virtual bool ITestB_test() =0;
        virtual bool test() {
            return ITestB_test();
        }
};

class C : public ITestA_X, public ITestB_X {
    private:
        virtual float ITestA_test() {
            return 3.14;
        }
        virtual bool ITestB_test() {
            return false;
        }
};

int main() {
    ITestA *a = new C();
    std::cout << a->test() << std::endl;
    ITestB *b = dynamic_cast<ITestB *>(a);
    if (b) {
        std::cout << b->test() << std::endl;
    }
    delete(a);
    return 0;
} 
```

这有什么你能想到的缺点吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T03:15:54.150

当您声明时`ITestA *a = new C()`，您已经创建了一个`C`对象。如果你用 调用`test`它`a->test()`，它必须使用`C`虚拟表来查找要执行的代码。但是`C`试图对同一个签名有两个不同的实现`test()`，这是不允许的。您将其声明为 an 的`ITestA *`事实不会影响方法解析。您声明了方法`virtual`，因此可以通过对象的实际类型找到它们，而不管您用来访问它的指针的类型。

您不能有两个具有相同名称和参数类型的方法。您需要找到另一种方法来构建此代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T03:16:36.203

我不认为这是可能的。函数按名称（和签名）重载。

# java - jtable更新数据不可见

> ID：11371955
> 
> 赞同：0
> 
> 时间：2012-07-07T03:11:38.797
> 
> 标签：java, swing, concurrency, jtable, event-dispatch-thread

我遇到了一个类似于我在这里读到的关于插入数据和添加的数据未显示在 jtable 上的问题。我尝试过 repaint() 和 revalidate()，但无济于事。

基本上，我有两个类 A 和 B。A 调用 B 类中的一个函数来向表中添加一行数据。这是代码。（顺便说一下，我使用 Netbeans 7.1.2 添加一个表，然后添加一些代码来处理更新。）

```
public void callUpdateTable(){
    DefaultTableModel myModel = (DefaultTableModel)jTable1.getModel();
    DateFormat dateFormate = new SimpleDateFormat("MM/dd/yyyy HH:mm:ss");
    Object[] str = new Object[3];
    Date date = new Date();  

    str[0] = dateFormate.format(date);
    str[1] = "Robot";
    str[2] = "hello"; 
    // myModel.addRow(str);
    myModel.insertRow(1, str);
    myModel.setValueAt("Hello", 1, 2);
    System.out.println("count = " + myModel.getValueAt(1, 2));
    jTable1.repaint();
} 
```

有趣的是在系统打印上它打印出我设置值的单元格（1,2）的值，但没有显示在表格上。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T03:28:28.743

最好能编写一个演示问题的[SSCCE](http://sscce.org/)。

没有必要打电话`repaint()/revalidate()`。由于`insertRow()`模型会通过执行来触发表刷新`fireTableRowsInserted()`。

`DefaultTableModel`使用`vector`从零开始的索引。`insertRow()`调用[Vector.insertElementAt()](http://docs.oracle.com/javase/6/docs/api/java/util/Vector.html#insertElementAt%28E,%20int%29)`ArrayIndexOutOfBoundsException`如果索引超出范围则抛出。

假设你的模型是空的，试试这个：

```
myModel.insertRow(0, str); 
```

此外，请确保您与[EDT](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)上的表格进行交互。

# php - 服务器未发送自定义标头值

> ID：11371957
> 
> 赞同：2
> 
> 时间：2012-07-07T03:12:10.027
> 
> 标签：php, http-headers

我正在使用 PHP 5.2.17 获取远程页面，HTTP 请求包含一些 cookie 值，但 cookie 未传递到目标页面。

```
$url = 'http://somesite.com/';
$opts = array(
    'http' => array
        (
        'header' => array("Cookie: field1=value1; field2=value2\r\n")
    )
);
$context = stream_context_create($opts);
echo file_get_contents($url, false, $context); 
```

你能帮我找出问题吗？注意：我不能使用 curl。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T05:03:35.360

```
$url = 'http://somesite.com/';
$opts = array(
    'http' => array
    (
        'header' => "Cookie: field1=value1; field2=value2\r\n"
    )
);
$context = stream_context_create($opts);
file_get_contents($url, false, $context); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T03:31:05.573

也许`allow_url_fopen`未启用，检查值 w/ ini_get: `ini_get('allow_url_fopen')`;

您还可以通过在您知道可公开访问的任何旧页面上调用 file_get_contents() 来进行完整性检查。

除此之外，您的示例代码看起来还不错。

**第二种选择，套接字连接：**

```
<?php
$fp = fsockopen("somesite.com", 80, $errno, $errstr, 30);
if (!$fp) {
    echo "$errstr ($errno)<br />\n";
} else {
    $out = "GET / HTTP/1.1\r\n";
    $out .= "Host: somesite.com\r\n";
    $out .= "Cookie: field1=value1; field2=value2; path=/; domain=somesite.com;\r\n";
    $out .= "Connection: Close\r\n\r\n";
    fwrite($fp, $out);
    while (!feof($fp)) {
        echo fgets($fp, 128);
    }
    fclose($fp);
}
echo PHP_EOL; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T03:32:05.510

您确定接收代码正常工作吗？

我可以让您的示例与接收页面一起简单地回显：

```
<?php
echo $_COOKIE['field1'] . '::' . $_COOKIE['field2']; // returns value1::value2
?> 
```

或者，该站点可能需要用户代理（任何东西）。我在访问 Wikipedia 之前遇到了这个问题（不受所有 Mediawiki 软件的限制；显然仅适用于 Wikimedia 网站）。将“http”数组中的 user_agent 属性设置为您想要的任何值。（但是，如果您碰巧尝试访问 Wikipedia，则可以尝试使用他们的 api.php：[http](http://en.wikipedia.org/w/api.php) ://en.wikipedia.org/w/api.php ；如果是另一个 Mediawiki 站点，请使用相同的相对路径）

# javascript - 如何通过javascript确定相对于内部每个字符的页面的位置（x，y）？

> ID：11371960
> 
> 赞同：0
> 
> 时间：2012-07-07T03:12:41.550
> 
> 标签：javascript, jquery, html, css, jquery-plugins

这就像我能得到的一样简单。

我将通过以下方式在屏幕上随机定位几个跨度：

```
 $(".hidden:first").css('-webkit-transform','rotate('+((0.5-Math.random())*40)+'deg)'); 
 $(".hidden:first").animate({
    left: '+=' + (((screen.width-800-224)/2) + Math.random()*800),
    top: '+=' + (50+Math.random()*600)
  } [...] 
```

后来我想遍历每个元素的每个字符（随机位置和随机旋转），我需要发现屏幕上每个字符的 (x,y) 位置，这样我就可以着色它，根据一定的功能形成一定的画法。

这很容易实现吗？请记住，我想要跨度的每个字符的 (x,y) 位置，而不是跨度本身的 (x,y) 位置。我对javascript真的很缺乏经验。

编辑：回答我自己的问题：我目前设法通过将每个字母包装在 a 中，然后通过 jquery`<span>`访问它来完成我需要做的事情。有那么糟糕吗？:P`.offset().left``.offset().top`

谢谢。费尔南多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T04:57:25.223

这样的事情可能会让你开始[http://jsfiddle.net/QgRWk/](http://jsfiddle.net/QgRWk/)

# c - 使用resolv.h

> ID：11371965
> 
> 赞同：0
> 
> 时间：2012-07-07T03:13:58.857
> 
> 标签：c, dns, resolver

我试图通过从 resolv.h 的 _res 结构中读取它来找出我的 DNS 服务器地址。根据 man 3 resolver 设置代码应该是。

```
#include <netinet/in.h>
#include <arpa/nameser.h>
#include <resolv.h>

extern struct state _res; 
```

然后我就读出我需要的任何东西。我的问题是试图编译这个我得到

```
resolver.c:5:21: error: conflicting types for '__res_state'
extern struct state _res;
                    ^
/usr/include/resolv.h:251:16: note: expanded from macro '_res'
#define _res (*__res_state())
               ^
/usr/include/resolv.h:249:28: note: previous declaration is here
extern struct __res_state *__res_state(void) __attribute__ ((__const__));
                           ^
1 error generated. 
```

铿锵声。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T03:33:24.150

您不应该声明`_res`自己 -`resolv.h`包括正确的声明（尽管手册页暗示了什么）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T04:16:24.887

```
#include <netinet/in.h>
#include <arpa/nameser.h>
#include <resolv.h>

int main() {

    // call this first
    res_init();

    // do something with this list it contains list of dns servers
    _res.nsaddr_list[0];

} 
```

# javascript - tinyMCE jQuery 表单验证

> ID：11371966
> 
> 赞同：3
> 
> 时间：2012-07-07T03:14:16.833
> 
> 标签：javascript, jquery, tinymce

我正在尝试使用 tinymce`getContent()`制定自定义验证规则，如何使用 jquery 验证来做到这一点？我需要将规则应用于使用 tinymce 格式化的文本区域。

验证：[http ://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

```
$("#element").click( function(e) {

    console.log(tinyMCE.activeEditor.getContent());

    $("#someForm").validate({
        rules: {        
            title: {
                required: true
            }
        }
    });

}); 
```

我正在考虑只在 getContent() 中使用一点 javascript，因为看起来创建一种解决方法来让 jquery 验证与 tinymce 一起工作同样需要付出很多努力。对可能的解决方案的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T07:50:50.300

以下 stackoverflow 问题应该可以帮助您解决该问题：

*   [验证多个 TinyMCE 编辑器](https://stackoverflow.com/questions/10309732/validating-multiple-tinymce-editor)

*   [带有 TinyMCE 字段的 Jquery 验证表单，空值没有给出错误](https://stackoverflow.com/questions/10131526/jquery-validation-form-with-tinymce-field-who-gives-no-error-by-empty-value)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-04T10:58:26.107

嗨，如果您在使用 tinymce 时没有在表单提交时间上获得客户端验证，请尝试使用此代码假设您有两个 html 编辑器 1 是 txtAboutCompany，2 是 txtProductinfo

**这是客户端代码**

```
<div class="divclass">
   @Html.LabelFor(model => model.txtAboutCompany, new { @class = "required" })
   @Html.EditorFor(model => model.txtAboutCompany)
  <span class="field-validation-error" id="AC" style="margin:9px 0 0 157px;"></span>
</div> 
```

**这是jQuery**

```
$("#BusinessProfile").click(function () {
        var aboutC = $("#txtAboutCompany").val()
        var pinfo = $("#txtProductinfo").val();
        if (aboutC == "" && pinfo == "") {
            $("#AC").append("").val("").html("Please enter about company")
            $("#PI").append("").val("").html("Please enter product information")
            $("#bpform").valid();

            return false;
        } else if (aboutC == "") {
            $("#PI").append("").val("").html("")
            $("#AC").append("").val("").html("Please enter about company")
            $("#txtAboutCompany").focus();

            $("#bpform").valid();
            return false;
        } else if (pinfo == "") {
            $("#AC").append("").val("").html("")
            $("#PI").append("").val("").html("Please enter product information")
            $("#txtProductinfo").focus();
            $("#bpform").valid();

            return false;
        }
        else {
            $("#AC").append("").val("").html("");
            $("#PI").append("").val("").html("");
            //return true;
            $("#bpform").validate();
        }
    }); 
```

您可以在表单提交时间获得所有必需的验证

我知道这不是正确的方法，但你可以做到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-03T10:59:46.443

```
function tinymceValidation() {
    var content = tinyMCE.activeEditor.getContent();
    if (content === "" || content === null) {
        $("#questionValid").html("<span>Please enter question statement</span>");
    } else {
        $("#questionValid").html("");
    }
}

tinymce.activeEditor.on('keyup', function (e) {
    debugger;
    tinymceValidation();
});

$(form).submit(function (e) {
    tinymceValidation();
}); 
```

# jquery - 我有这个 jQuery 验证功能问题。验证只有效一次

> ID：11371967
> 
> 赞同：1
> 
> 时间：2012-07-07T03:14:24.673
> 
> 标签：jquery

下面的功能可以正常工作。这是为了验证表格。简而言之，我有几个输入字段。如果我点击提交并且在任一输入中都没有输入任何文本，则会出现验证错误。如果我填写一个字段，则只有一个字段会更新。但是，如果我再次点击“提交”，即使没有填写第二个表单输入，else{} 也会被触发，而不是 if{} 应该确保它被填写，等等。

不熟悉，但是否返回false；问题？

```
if ($('input[type="text"]:visible').val().length == 0) {
    $('.submitModal').click(function () {
        $('.modal').modal('show'); 
    });
}
else {
    $('.submitModal').click(function () {
        $('.modal').modal('hide'); 
    });
} 
```

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T04:08:55.790

这是倒退的想法。绑定点击，句号。不是有条件的。在点击时，决定你想要发生什么（即使这只是意味着忽略点击）。

如果您确实绑定了单击，则以不同方式填写表单不会取消绑定。即使您实际上可以解除绑定，也没有充分的理由这样做。

if`.submitModal`实际上是一个提交输入元素（而不是具有该类的锚点或按钮），而不是绑定单击侦听器，而是绑定提交侦听器。

基于迈克自己的代码起点，这里有一个例子（稍微超出了真实的上下文，因为如果`modal`没有不必要的努力，我没有可用的功能！）

```
$('.submitModal').click(function (e) {
    e.preventDefault();
    $('input[type="text"]:visible').each(function() {
        if ($(this).val().length == 0) {                        
            $('.modal').show();                        
        }
        else {
            $('.modal').hide();
        }
    });
});​ 
```

不同的第一件事是我将事件传递给单击处理程序，然后传递给`preventDefault`它。这可以防止锚点导致页面刷新。

但我唯一做的另一件事就是将实际`.modal()`调用换成通用 jQuery `.show()`，`.hide()`只是为了验证逻辑的概念。

Mike，您编写的示例代码非常棒（除了 preventDefault 假设您确实想要阻止默认锚行为）。这是证明：

jsfiddle.net/gnaXn/2

填写所有可见文本字段后，“模式”将隐藏。当它们再次被清空时，“模态”再次出现。

# linux - 在 Linux 中的内核和用户代码之间来回跳转

> ID：11371968
> 
> 赞同：0
> 
> 时间：2012-07-07T03:14:28.013
> 
> 标签：linux, linux-kernel, mmu

我正在为一个研究项目在运行 x86-64 的 Linux 上进行一些内核黑客攻击。我需要从内核例程跳转到用户模式代码页并立即返回内核代码。换句话说，我需要在内核中执行时对用户代码做一个蹦床。

我想知道这是否可能。如果可能的话，有人可以给出一些想法如何实现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T09:46:27.337

这不太可能“容易”。

在不了解您的应用程序并且不建议您重新考虑您的内核<->应用程序接口的情况下，您可能会这样工作：让应用程序通过仅传递该代码的地址向您的内核组件注册一段蹦床代码. 蹦床代码将执行您的“真实”用户模式函数，然后发出另一个系统调用或异常以返回内核。

虽然这不完全是一个用户模式子程序，但它相当接近：当您的应用程序调用任何需要执行回调的内核函数时，内核函数可以保存真正的返回地址，将其更改为注册的蹦床地址并返回用户模式。蹦床将调用该函数，它后面的系统调用/异常会将您踢回内核，您可以继续您在那里所做的任何事情。

无论如何，您可能不需要担心安全性，但是如果您这样做，您可能必须确保“从蹦床返回”系统调用仅从您仍然有开放蹦床黑客的进程中接受。

你也可以看看信号是如何工作的；它们是关于让内核中断应用程序并让应用程序调用信号处理程序；类似信号的实现甚至可以在您的应用程序没有进行活动系统调用的情况下工作（但它也将具有信号处理程序的所有限制）。

事实上，也许你可以只使用一个信号？再一次，看看信号在内核中是如何工作的，并且只是给你的用户代码发信号。在您的应用程序中安装适当的信号处理程序，并让信号处理程序调用“从用户空间蹦床返回”系统调用。

无论哪种方式，这听起来有点...... hackish。在没有做过任何内核工作的情况下，我会假设通过设备节点、套接字或类似机制与您的应用程序交互可能是一种更好的方式……或者只是让您的系统调用返回一个“待办事项”结果项应用程序告诉它调用 siome 用户空间代码并用另一个系统调用报告回来。

# jquery-ui - jQuery组合框样式问题

> ID：11371970
> 
> 赞同：1
> 
> 时间：2012-07-07T03:15:14.303
> 
> 标签：jquery-ui, combobox

我正在渲染一个 jQuery 组合框，但输入元素的高度与切换按钮的高度不匹配，如下面的屏幕截图所示。这发生在 IE 9 和 FireFox 13 中。 ![在此处输入图像描述](../Images/d76148eb43f02dfd9b3066178575857d.png)

用于 jQuery 组合框的样式如下。

```
<style>
.ui-combobox {
    position: relative;
    display: inline-block;
}
.ui-combobox-toggle {
    position: absolute;
    top: 0;
    bottom: 0;
    margin-left: -1px;
    padding: 0;
    /* adjust styles for IE 6/7 */
    *height: 1.7em;
    *top: 0.1em;
}
.ui-combobox-input {
    margin: 0;
    padding: 0.3em;
}
          .ui-autocomplete { height: 200px; overflow-y: auto; }
</style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T13:08:14.367

您应该从 jqueryui[页面](http://jqueryui.com/demos/autocomplete/#combobox)更新您的组合框小部件。并确保您使用最新的 jquery-ui（此问题最近已修复）。

这对我有帮助...

# objective-c - 在情节提要场景中更改单个 UIView 的正确方法是什么

> ID：11371972
> 
> 赞同：1
> 
> 时间：2012-07-07T03:15:45.020
> 
> 标签：objective-c, ios, uiview, uiviewcontroller, uistoryboard

假设我有一个场景，其中包括屏幕上半部分的 UIView 容器，屏幕下半部分的 UIView 容器和屏幕底部的几个按钮。

基本上，底部容器将始终显示静态文本，而底部的按钮将更改顶部容器的内容，其中可能包括图像、更多按钮或更多文本，具体取决于底部按下的按钮。此外，每次按下底部按钮时，顶部容器都会从底部过渡翻转到新视图。

我纯粹以编程方式实现了这一点，但决定将我的应用程序转换为故事板文件，因为它可以更快、更简单地生成应用程序的其余部分，并且使代码看起来不像是一团糟。

我对故事板的有限理解似乎推断出我需要为每个 UIView 更改单独的故事板场景，而 Apple 的故事板编码约定似乎暗示我们应该在每次创建新场景时使用新的 ViewController。所有这些加起来比我现在所拥有的更加混乱。

有没有更好的方法来做到这一点？我是不是误会了什么？如果我不感到困惑，有没有办法让所有这些场景和视图控制器重复更干净？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T15:34:30.437

一定有办法！

我不小心打开了一天（见附图）。尽管我不知道我是如何做到的，并且真的很想知道，但我无法复制它，也无法关闭它。当我将表头视图的连接从 Connections Inspector 拖动到屏幕左侧的控件列表（而不是实际的 UIViewController）时，UIView 打开。

我也在用故事板重新设计一个项目，并且每个 UIViewController 有多个视图也有类似的问题。

在这种情况下，它是一个表头。我在项目中有其他 UIViewControllers 具有相同的配置，但我也无法让它们弹出。

![在此处输入图像描述](../Images/037831d9bd7a7f128fe8b1fc5d59ba28.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T03:27:35.597

故事板编辑器使您难以完成您所描述的事情，因为它不允许您编辑与场景相关联的独立视图。

我建议您为每个上半部分视图创建一个单独的笔尖（不是故事板）。这些可以与您的故事板分开存在。然后，您的视图控制器（从情节提要中实例化）可以在按下按钮时加载它需要的任何 nib，并将视图从 nib 放入其（视图控制器的）顶级视图中。

# c++ - C++ 对象列表只是副本

> ID：11371973
> 
> 赞同：0
> 
> 时间：2012-07-07T03:15:44.630
> 
> 标签：c++, stl

出于性能原因（内存速度），我发现自己需要保留两个对象列表。

我正在使用对象指针，例如

```
std::list<MyClass*> m_list1;
std::list<MyClass*> m_list2; 
```

我将对象添加到列表中

```
MyClass* myObject = new MyClass();
m_list1.push_back(myObject);
m_list2.push_back(myObject); 
```

我面临的问题是我所做的更改`m_list1`并没有影响`m_list2`，所以很明显它们是副本而不是真正的交易。

存储这些的正确方法是什么，以免它们成为副本？不使用指针不是一种选择，因为这些都将在堆上分配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T03:19:02.587

标准容器复制传入的值，但由于您传入了指针，所以复制的是指针。因此它们仍然指向同一个对象。问题一定出在其他地方。也许您可以发布您认为表现出这种行为的特定代码？

# wordpress - WordPress 是否预加载页面？

> ID：11371977
> 
> 赞同：2
> 
> 时间：2012-07-07T03:17:17.930
> 
> 标签：wordpress, apache, access-log

在浏览我的网站并查看我的服务器访问日志时，我的网站中的“下一页”似乎与我导航到的页面一起提供（单击，两页）。有时它按顺序执行，有时它似乎是随机的，抓取未列出的页面并提供这些页面。

也就是说，我点击“关于”页面，日志报告服务“关于”和“联系”。

前端没有明显的错误，一切都得到验证。我在我的画廊中使用 HighslideJS，它使用图像预加载器，我研究了 WP-supercache 的潜在错误，但没有找到答案。

这似乎不是正常行为，因为它污染了我的日志。任何线索将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T10:53:07.443

那是您的网络浏览器预取下一页。WordPress 只是让您的浏览器知道下一个页面，使用[链接 rel='next' 元素](http://www.w3.org/TR/html401/struct/links.html#h-12.3)。如果您想防止这种情况发生，请将其添加到主题中的 functions.php 文件中：

```
remove_action('wp_head', 'adjacent_posts_rel_link_wp_head', 10, 0); 
```

# ios - 使用 Audio Units 播放多个重叠的短音频文件

> ID：11371980
> 
> 赞同：2
> 
> 时间：2012-07-07T03:17:54.017
> 
> 标签：ios, audio, core-audio, audiounit

我已经阅读了正弦波发生器的音频单元教程并阅读了一些内容，我基本上了解它是如何工作的。我真正想为我的应用程序做的是播放一个简短的声音文件以响应一些外部事件。这些声音的持续时间大约为 1-2 秒，并以大约每秒 1-2 次的速率发生。

基本上我现在所处的位置是试图弄清楚如何使用我的音频单元播放实际的音频文件，而不是生成正弦波。所以基本上我的问题是，如何让音频单元播放音频文件？

我是否只是将音频文件中的字节读入渲染回调中的缓冲区？（如果是这样，我需要处理什么类来打开/转换/解压缩/读取音频文件）

还是有一些更简单的方法可以让我把整个缓冲区交给我并告诉它播放？

我需要查看任何特定类或 API 的名称来完成此操作将非常有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T03:44:35.210

好的，检查一下：http: [//developer.apple.com/library/ios/samplecode/MixerHost/Introduction/Intro.html](http://developer.apple.com/library/ios/samplecode/MixerHost/Introduction/Intro.html)

编辑：这是一个示例项目。此页面包含用于设置常用配置的内联代码的详细说明：http: [//developer.apple.com/library/ios/ipad/#DOCUMENTATION/MusicAudio/Conceptual/AudioUnitHostingGuide_iOS/ConstructingAudioUnitApps/ConstructingAudioUnitApps.html#//apple_ref/doc/ uid/TP40009492-CH16-SW1](http://developer.apple.com/library/ios/ipad/#DOCUMENTATION/MusicAudio/Conceptual/AudioUnitHostingGuide_iOS/ConstructingAudioUnitApps/ConstructingAudioUnitApps.html#//apple_ref/doc/uid/TP40009492-CH16-SW1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T02:04:22.937

如果您不介意绑定到 IOS 5+，您应该查看 AUFilePlayer。使用回调要容易得多，而且您不必担心设置自己的环形缓冲区（如果您想避免在启动时将所有音频数据加载到内存中，则需要这样做）

# ruby-on-rails - 监控 Rails 邮件活动的最佳方法

> ID：11371984
> 
> 赞同：0
> 
> 时间：2012-07-07T03:20:22.143
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, actionmailer

我有一个邮件程序（由 rake 任务触发），它根据几个不同的因素（性别、位置、年龄等）向用户发送交易。

一切都很好，我只需要一种方法来监控和报告有多少电子邮件发送给我们的客户。

在 Rails 应用程序中监控电子邮件活动的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T04:07:08.387

你应该使用观察者。

关于如何使用的答案在这里：[How do I create a Mailer Observer](https://stackoverflow.com/questions/4850484/how-do-i-create-a-mailer-observer)

# iphone - 使用 NSMutableURLRequest 请求

> ID：11371985
> 
> 赞同：2
> 
> 时间：2012-07-07T03:20:23.377
> 
> 标签：iphone, objective-c

我试图制作一个登录页面以使用户对网站进行身份验证。我试过类似的东西：

```
 NSURL *myURL = [NSURL URLWithString:@"https://www.freelancer.com/users/onlogin.php"];
NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:myURL
                                                       cachePolicy:NSURLRequestReloadIgnoringLocalCacheData
                                            timeoutInterval:60];    
NSLog(@"ispost");
[request setHTTPMethod:@"POST"];
[request setValue:usernameField.text forKey:@"username"];
[request setValue:passwordField.text forKey:@"passwd"];

NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self];

if (!theConnection) {
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Network Error" message:@"Could not login!" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alert show];
    [alert release];
    return;
} 
```

我得到一个错误如下：

`2012-07-07 10:09:37.354 Auth[6062:f803] ispost 2012-07-07 10:09:37.357 Auth[6062:f803] *** Terminating app due to uncaught exception 'NSUnknownKeyException', reason: '[<NSMutableURLRequest 0x68d69d0> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key username.'`

谁能建议我做错了什么？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T03:44:24.807

你为什么不使用like

```
[request setValue:usernameField.text forHTTPHeaderField:@"username"];
[request setValue:passwordField.text forHTTPHeaderField:@"passwd"]; 
```

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T03:25:42.663

NSMutableURLRequest 没有用户名属性（因此出现错误）。您需要执行以下操作（尽管这取决于您的服务器期望的格式）：

```
[request setHTTPMethod:@"POST"];
NSString* str = [NSString stringWithFormat:@"username=%@&passwd=%@", usernameField.text, passwordField.text];
[request setHTTPBody:[str dataUsingEncoding:NSUTF8StringEncoding]]; 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T03:25:27.810

提示在您的错误字符串中：

> 此类与键用户名的键值编码不兼容。

我很确定您不能以您尝试的方式进行基本身份验证。快速搜索一下[，](http://www.chrisumbel.com/article/basic_authentication_iphone_cocoa_touch)我确实记得在尝试通过每个请求传递它时都必须执行 base64（替代方法是实现连接委托方法，并正确处理 auth.xml 请求）。

# android - 如何保存android活动历史并在以后检索？

> ID：11371987
> 
> 赞同：0
> 
> 时间：2012-07-07T03:20:39.583
> 
> 标签：android, android-listview, history, android-activity, savestate

如何保存以前的活动并将更新保存到列表视图中，以便当用户稍后启动应用程序时，他可以单击名为历史的菜单选项，该选项将显示最后几个活动的列表视图。假设列表视图包含 5 个活动，在 5 个活动之后，它会删除保存的最旧活动并将新活动保存在它的位置。

例如，如果有人想查看他两天前查看的 android 活动的历史记录，他可以简单地单击一个名为 history 的按钮并查看他过去的 5 个条目，这些条目将显示在列表视图中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T03:33:40.160

默认情况下，您无法做到这一点 Android 活动方法。

只需将状态保存在 onResume/onCreate 中（作为文件系统或 SharedPreference 中的文件）并从您的 History Activity 中读取它。

抱歉英语不好））问是否不明白。

# php - 在表单中调出表单 (PHP)

> ID：11371989
> 
> 赞同：0
> 
> 时间：2012-07-07T03:21:10.377
> 
> 标签：php, sqlite

我试图在第二个表单操作不起作用的表单中调用一个表单。它没有解析。我的示例程序有一个附加到我的提交按钮的主表单，内部表单是一个下载按钮。

更新代码：

```
<?php
$fullPath = "staff.doc";
<form id="Staff" name="Staff" method="post" action="download_preview.php">
echo "<input type=\"hidden\" name=\"fullPath\" value=\"$fullPath\"/>";
echo "<input type=\"submit\" name=\"submit\" value=\"Download\"/>";
echo "<input type=\"submit\" id=\"Submit\" name=\"Submit\" value\="Submit\"/>";
echo "</form>";

<?php
switch($_POST['submit']) 
{
case "Submit":

break;
case "Download":
$fullPath = $_POST['fullPath'];
// download file

     opendir("$fullPath");

break;
default:
}
?> 
```

我已经更新了多处理程序方法。但是我仍然无法调用下载路径。下载代码以前使用单个表单。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T03:28:53.440

如[XHTML 规范中所述](http://www.w3.org/TR/xhtml1/#prohibitions)，

> ***form***：不得包含其他表单元素。

如果它在规范中，您不应该依赖任何给定的用户代理供应商如何处理它。如果你不熟悉那边的人如何使用“不得”之类的短语，那就是：

> ***Must***：在本规范中，“必须”一词被解释为对实现或严格符合 XHTML 文档的强制要求，具体取决于上下文。术语“应”与“必须”具有相同的定义。

编辑：我很好奇，发现[HTML5 规范](http://developers.whatwg.org/forms.html#the-form-element)还包括禁止嵌套表单的语言。

编辑（代码建议）：

# 方法一：兄弟形式方法

```
<?php $fullPath = $_SERVER['DOCUMENT_ROOT']."/doc/store"."$T"; ?>
<form id="Staff" name="Staff" method="post" action="gotonextpage.php">
  <input type="submit" name="Submit" value='Submit'>
</form>
<form name="download" action="download.php" method="post">";
  <input type="hidden" name="fullPath" value="<?php echo $fullPath ?>"/>";
  <input type="submit" name="submit" value="Download"/>";
</form> 
```

# 方法二：多用途处理程序方法

```
<?php $fullPath = $_SERVER['DOCUMENT_ROOT']."/doc/store"."$T"; ?>
<form id="Staff" name="Staff" method="post" action="downlod_or_gotonextpage.php">
  <input type="submit" name="Submit" value='Submit'>
  <input type="hidden" name="fullPath" value="<?php echo $fullPath ?>"/>";
  <input type="submit" name="submit" value="Download"/>";
</form> 
```

然后制作 downlod_or_gotonextpage.php

```
switch($_POST['submit']) {
  case "Submit":
    // go to next page, either with 302, include, or whatever is appropriate
    break;
  case "Download":
    // do downloading, perhaps also with a 302 first...
    break;
  default:
    // 404, or 302 to the original form page
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T03:30:06.890

您不能根据 HTML 将表单放入表单中。我不太清楚为什么，在这个例子中，无论如何你都需要它。摆脱外部形式。

# python - 查找 vim 的 virtualenv 当前包目录

> ID：11371991
> 
> 赞同：1
> 
> 时间：2012-07-07T03:21:17.853
> 
> 标签：python, vim, virtualenv, ctags

我希望能够通过 ctags 从我的 virtualenv 库中获取源代码，但为了能够做到这一点，我需要知道哪个 virtualenv 当前处于活动状态，因此例如，我的 .vimrc 中有这段代码，它将 django 附加到我的 ctags指数：

```
nnoremap <F7> :!ctags -R --python-kinds=-i -a ~/.virtualenvs/MYPROJECT/lib/python2.7/site-packages/django/*<CR> 
```

我不想硬编码路径，而是希望它执行以下操作：

```
nnoremap <F7> :!ctags -R --python-kinds=-i -a CURRENT_PROJECT_PACKAGES_PATH/django/* 
```

所以我可以索引我正在处理的当前项目中的包。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-09T13:34:31.973

您可以使用 $VIRTUAL_ENV 进入您的图书馆，所以它会是这样的

```
nnoremap <F7> :!ctags -R --python-kinds=-i -a $VIRTUAL_ENV/lib/python2.7/site-packages/django/* 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T06:20:09.867

使用变量，`let g:current_proj = "~/.virtualenvs/MYPROJECT/lib/python2.7/site-packages/"`然后使用 exe 读取它：

```
nnoremap <F7> :exe "!ctags -R --python-kinds=-i -a " . g:current_proj . "django/*"<cr> 
```

或者您可以直接使用环境变量：

```
nnoremap <F7> :exe "!ctags -R --python-kinds=-i -a " . $CURRENT_PROJECT_PACKAGES . "django/*"<cr> 
```

# javascript - javascript代码中的三明治模式

> ID：11371993
> 
> 赞同：0
> 
> 时间：2012-07-07T03:21:26.173
> 
> 标签：javascript, python, aop

如果问题的标题具有误导性，请道歉。实际上我正在寻找以下python代码的javascript等价物：

```
 ## python code
def call_with_context(fn, *args):
  ## code to create context, e.g. profiling, db.connect, or drawing context store stack
  fn(*args)
  ## code to close context 
```

这实现了与python中的“with语句”类似的功能，它实现了面向方面的范例。

所以我的问题是做这些事情的javascript方式是什么？我已经看到一些代码使用 Array.prototype.slice(arguments, 1) 这样做，但我不知道这是否是 javascript 中的常见模式，或者 javascript 中支持更好的模式（例如通过闭包）所以 ppl不要那样做。如果我使用了错误的关键字，请也纠正我，因为我真的不知道如何用比三明治更好的名字来指代我的问题。

EDT 1：如果有人能解释如何从包装器 call_with_context 中返回 fn(*args) 的结果，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T04:14:10.893

我认为更典型的 JS 方法可能是装饰函数。所以如果你想把你的函数包装在记录时间的东西中，你可以创建一个像这样的函数（在我的脑海中）：

```
var createTimer = function(fn) {
    return function() {
        var start = new Date();
        var result = fn.apply(this, arguments);
        console.log("Took " + (new Date() - start) + " ms.");
        return result;
    }
};

var test = function(a, b, c) {
    return a * b + c;
}

test = createTimer(test);

console.log(test(3, 4, 5));

// Took 0 ms.
// 17 
```

要点是你可能不会这样称呼：

```
runTimerAround(test, 3, 4, 5); 
```

虽然这也可以在 JS 中完成，但我相信它比直接覆盖函数更常见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T03:32:46.067

听起来您想调用具有特定上下文的方法。

在 js 中，你通常会做...

```
function someFunction( fn, context ) {
   fn.call( context );
}

var Button = {
   isClicked: false
};
someFunction(function () {
   // this === Button
   this.isClicked = true;
}, Button ); 
```

现在`this`里面的关键字`fn`将代表传递给方法的上下文`someFunction`。这种模式经常出现。尤其是回调。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T03:47:03.723

像这样的东西

```
// javascript code
function call_with_context(fn) {
  // code to create context, e.g. profiling, db.connect, or drawing context store stack
  var r = fn.call(Array.prototype.slice.call( arguments, 1)); // remove first arg - fn 
  //code to close context 
  return r; 
} 
```

所以你将能够做到这一点：

```
call_with_context(myfun,1,2,3); 
```

最终会打电话

```
myfun(1,2,3); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-25T17:47:54.613

在仔细阅读每篇文章/评论后，我认为 OP 正在寻找`[javascript]`和`[method-modification]`. *并立即回答 OP 关于术语的问题，更改 JavaScript 中的封闭功能与面向方面的编程*无关，除非声称是*AO*的实现至少为*Aspect*、*Advice*和*Pointcut*提供抽象和代码重用级别。

[正如Scott Sauyet](https://stackoverflow.com/users/1243641/scott-sauyet)[已经评论](https://stackoverflow.com/q/11371993/2627243) 过的那样，其他所有事情都可以通过（手动）将功能相互包装来完成。再说一次，我不会走那么远并将其称为*function-composition*。为了符合条件，至少应该有一些工具集，因为它们已经存在于各种实现`compose`和/或`curry`方法/模式中。

对于 OP 将要实现的目标，有一大堆`before`, `after` `around`/`wrap`解决方案，不幸的是提到*AO(P)*，并且在很多情况下没有考虑*上下文*或者`target`这是必不可少的，并且也被 OP 要求.

我提供的示例使用`Function.around`. 由于`bind`JavaScript 已经 具有*标准化* 的 . `Function.prototype`_ _ _ *`[before](https://gist.github.com/petsel/37bf42a6fc0b7f9549b8)``[after](https://gist.github.com/petsel/21677f85aa598d262c66)``[around](https://gist.github.com/petsel/895cd9eb04239e10e8eb)``[afterThrowing](https://gist.github.com/petsel/9ddf5ce515f1344c84bd)``[afterFinally](https://gist.github.com/petsel/3b31cd5e63d43b9e7c4e)`*

 *将支持以下示例的代码库：

```
(function (Function) {
  var
    isFunction = function (type) {
      return (
           (typeof type == "function")
        && (typeof type.call == "function")
        && (typeof type.apply == "function")
      );
    },
    getSanitizedTarget = function (target) {
      return ((target != null) && target) || null;
    }
  ;
  Function.prototype.around = function (handler, target) { // [around]
    target  = getSanitizedTarget(target);

    var proceed = this;
    return (isFunction(handler) && isFunction(proceed) && function () {

      return handler.call(target, proceed, handler, arguments);

    }) || proceed;
  };
}(Function)); 
```

示例代码，通过在它之前和之后额外提供的行为来改变给定的封闭函数，并提供它的*上下文*。

```
var loggingDelegate = function () { // closed code that can not be changed for any reason.

  this.log.apply(this, arguments);
};

loggingDelegate.call(console, "log", "some", "arguments");

var interceptedLoggingDelegate = loggingDelegate.around(function (proceed, interceptor, args) {

  // everything that needs to be done before proceeding with the intercepted functionality.

  // [this] in this example refers to [console], the second argument of the [around] modifier.

  this.log("proceed:", proceed);         // the original functionality  - here [loggingDelegate].
  this.log("interceptor:", interceptor); // the modifying functionality - [around]s 1st argument.
  this.log("args:", args);               // the arguments that get passed around.

  proceed.apply(this, args);
  // or:
  //return proceed.apply(this, args);
  // or:
  //var result = proceed.apply(this, args);

  // everything that still needs to be done after invoking the intercepted functionality.

  // if necessary:
  //return result;

}, console); // [console] has to be provided as target to the modified [loggingDelegate].

interceptedLoggingDelegate("intercept", "and", "log", "some", "arguments"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-07T07:59:13.280

经过一番搜索，这是我的解决方案。希望对其他人有所帮助。

```
 function call_with_context(fn) {
  // some beginning code
  console.log('begin');

  r = fn.apply(null, Array.prototype.slice.call(arguments, 1));

  // some ending code
  console.log('end');

  return r;
} 
```*