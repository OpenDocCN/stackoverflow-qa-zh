# StackOverflow 问答 000167000-000167999

# perforce - 用于 Windows 的 Perforce 存储库监视器

> ID：167002
> 
> 赞同：1
> 
> 时间：2008-10-03T13:56:34.787
> 
> 标签：perforce

我曾经使用 Subversion 和一个系统托盘工具 ( [SVN Notifier](http://svnnotifier.tigris.org/) ) 来监控存储库，所以我会立即看到我的本地副本何时不再是最新的，我想知道 Perforce 是否可以使用一些等价物（在视窗）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T23:10:38.270

stimms 的答案肯定会完全按照您的要求进行。

但是，如果您想更进一步，另一种选择是使用 P4 Review 机制，如果对用户指定的 depot 部分进行了更改，您可以让 Perforce 向您发送电子邮件。它需要在服务器上进行设置，但很简单。请参阅 Perforce 文档和网站并查找“review daemon”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-01T13:31:15.120

如果您使用 Perforce GUI 客户端，您可以通过以下方式为任意数量的文件夹设置电子邮件通知：

1.  连接 > 编辑当前用户... > 评论选项卡
2.  右键单击您有兴趣跟踪的每个位置，然后单击“包含树”
3.  点击确定

这假设已经在服务器上设置了审查守护程序。

请参阅[http://public.perforce.com/wiki/Frequently_Asked_Questions#How_do_I_track_changes_to_a_project_I_am_interested_in.3F](http://public.perforce.com/wiki/Frequently_Asked_Questions#How_do_I_track_changes_to_a_project_I_am_interested_in.3F)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T14:02:43.760

我没见过这样的东西，但写起来很简单。只需检查 p4 sync -n 的输出是否包含任何信息。

# regex - 需要一个正则表达式来匹配三个字符串

> ID：167003
> 
> 赞同：1
> 
> 时间：2008-10-03T13:56:51.853
> 
> 标签：regex

我通常远离，`regular expressions`因为我很少找到它们的好用处。但在这种情况下，我认为我别无选择。

对于以下情况，我需要一个正则表达式。我将查看三个字符串。`1-9 or the letters o,n,d (lower or upper)` 如果第一个字符是AND 第二个字符是`1,2 or 3`并且第三个字符是 ，这将是一个匹配`0-9`。

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-03T14:06:20.040

其他一些答案略有不同。将输入限制为完全匹配的文本。

```
 ^[1-9ondOND][123][0-9]$ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T13:58:06.217

```
[1-9ondOND][123][0-9] 
```

我省略了`^`and `$`（字符串的开始和结束标记），因为你说你会有三个字符的字符串，但是包括它们并没有什么坏处，而且它们可能会提高速度，并不是说这对这么短有什么大不了的输入。

当然，这假设您使用的语言和语言环境中 , 和 的大写等效项是`o`,和. 如果没有，您需要告诉您的正则表达式解释器忽略大小写。该机制因语言/框架而异。`n``d``O``N``D`

对于 python，你会使用类似的东西：

```
re.match('[1-9ond][123][0-9]', inputstring, re.IGNORECASE) 
```

强制在`re.match`字符串开头进行匹配，因此`^`在任何情况下都不需要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T13:58:40.913

Perl 正则表达式：`/^[1-9ondOND][1-3][0-9]$/`

`^`在字符串的开头；
`$`在字符串的末尾。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T14:07:38.367

```
[1-9ond][123][0-9] 
```

[这是测试您的 RegEx 的有用地方。](http://web.archive.org/web/20151030080919/http://osteele.com:80/tools/rework/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-29T17:01:40.207

一个很晚的答案，但希望这会有所帮助

```
([1-9]|(?i)(o|n|d))[123][\d] 
```

[http://regex101.com/r/vE2jT1/1](http://regex101.com/r/vE2jT1/1)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-10-03T14:00:10.223

在基于 PREG 的系统中（现在大多数）：

```
^(?:[1-9]|[ond])[1-3][0-9]$ 
```

有些系统需要开始/结束标记（例如 PHP、Perl，但不是 .NET），如果你需要，它最终会是这样的：

```
/^(?:[1-9]|[ond])[1-3][0-9]$/ 
```

# png - 在 makefile 中使用带有通配符的 nmake

> ID：167004
> 
> 赞同：9
> 
> 时间：2008-10-03T13:57:41.537
> 
> 标签：png, export, nmake, balsamiq

我正在尝试设置一个 nmake makefile 以自动将我们的 balsamiq 模型文件导出为 png 文件，但恐怕我无法确定如何制定通用规则，而无需明确列出所有文件我要出口。

[此页面](http://www.balsamiq.com/blog/?p=231)详细介绍了用于导出文件的命令行语法，并且[此页面](http://msdn.microsoft.com/en-us/library/ms925728.aspx)包含一个示例，该示例看起来包含将 .obj 文件转换为 .exe 文件的通用规则。

到目前为止，我尝试过的 makefile 如下所示：

```
.bmml.png:
    "C:\Program Files\Balsamiq Mockups\Balsamiq Mockups.exe" export $< $@ 
```

但这不起作用。

如果我只是简单地运行 nmake（带有一些过时的 png 文件），nmake 就会这样做：

```
[C:\Temp] :nmake

Microsoft (R) Program Maintenance Utility Version 9.00.30729.01
Copyright (C) Microsoft Corporation.  All rights reserved.

[C:\Temp] : 
```

如果我要求它构建一个特定的文件，它会这样做：

```
[C:\Temp] :nmake "TestFile.png"

Microsoft (R) Program Maintenance Utility Version 9.00.30729.01
Copyright (C) Microsoft Corporation.  All rights reserved.

NMAKE : fatal error U1073: don't know how to make '"TestFile.png"'
Stop.

[C:\Temp] : 
```

那里有任何可以让我直截了当的nmake大师吗？

一个示例 makefile，它通过复制 .txt 文件来简单地制作 .dat 文件，以进行试验，如下所示：

```
.txt.dat:
    copy $< $@ 
```

这也无济于事，所以很明显我不明白这些通用规则是如何工作的。我是否需要在上面指定一个目标，以某种方式列出我想要的文件？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-12T23:28:41.067

NMAKE 模式规则很像 GNU make old-school 后缀规则。在您的情况下，您一开始几乎是正确的，但是您缺少 .SUFFIXES 声明。例如：

```
.SUFFIXES: .bmml .png
.bmml.png:
    @echo Building $@ from $< 
```

我认为这只是您解决方案的一部分，因为您还提到要避免明确列出所有要转换的文件。不幸的是，我不知道在 NMAKE 中有一种非常干净的方法来做到这一点，因为它只在依赖项列表中扩展通配符，而你在依赖项列表中真正想要的不是已经存在的文件列表（* .bmml文件），但将从这些文件（*.png 文件）创建的文件列表。不过，我认为您可以通过这样的递归 NMAKE 调用来实现您的目标：

```
all: *.bmml
    $(MAKE) $(**:.bmml=.png) 
```

在这里，NMAKE 将`*.bmml`在 prereq 列表中扩展`all`为目录中的 .bmml 文件列表，然后它将启动一个新的 NMAKE 实例，将要构建的目标指定为该文件列表，其中所有实例`.bmml`替换为`.png`. 所以，把它们放在一起：

```
.SUFFIXES: .bmml .png
all: *.bmml
    @echo Converting $(**) to .png...
    @$(MAKE) $(**:.bmml=.png)

.bmml.png:
    @echo Building $@ from $< 
```

如果我创建文件 Test1.bmml 和 Test2.bmml 然后运行这个 makefile，我会得到以下输出：

```
Converting Test1.bmml Test2.bmml to .png...
Building Test1.png from Test1.bmml
Building Test2.png from Test2.bmml 
```

当然，如果您有很多这样的 .bmml 文件，您可能会违反命令行长度限制，因此请注意这一点。在这种情况下，我建议要么明确列出源文件，要么使用功能更强大的 make 工具，例如 GNU make（它可用于 Windows，有多种形式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T18:45:15.083

这对你有用吗？把它放在 MAKEFILE 中：

```
export : *.bmml
    "C:\Program Files\Balsamiq Mockups\Balsamiq Mockups.exe" export $** $(**B).png 
```

然后运行：

```
nmake /A 
```

我没有 Balsamiq，所以我无法测试这个，但在我的情况下，如果我有以下 MAKEFILE。：

```
export : *.txt
    copy $** $(**B).dat 
```

并`nmake /A`在带有 myFile.txt 的文件夹中运行，它将创建 myFile.dat。

# java - Eclipse 中的快速编译器错误消息

> ID：167007
> 
> 赞同：3
> 
> 时间：2008-10-03T13:58:15.670
> 
> 标签：java, eclipse, ide

作为一个新的 Eclipse 用户，我经常为编译器错误消息显示需要多长时间而烦恼。这主要只是状态栏或“问题”选项卡中不适合的长错误的问题。但是我在 Java 中遇到了足够长的错误——尤其是泛型——这是一个令人烦恼的问题。（注意：这个问题的正确答案不是“更好地使用泛型。”;-)

我发现显示错误的方法是：

1.  按`Ctrl+.`或执行命令“Next Annotation”。下一个错误将突出显示，并且其相关消息出现在状态栏中（如果它足够短）。该错误也会在“问题”选项卡中突出显示，如果它已打开，但该选项卡不会自动置于顶部。
2.  将鼠标悬停在错误上。在明显滞后后，错误消息显示为“工具提示”，以及任何相关的“快速修复”。
3.  将鼠标悬停在编辑窗格左侧的错误图标上。在明显滞后之后，该行的所有错误消息都显示为“工具提示”。单击该图标会弹出“快速修复”。

我想要的是`Ctrl+.`自动并立即显示完整的错误消息（我不在乎在哪里）。这是一个可配置的选项吗？

[更新] @asterite 的 " `Ctrl+. F2`" 差不多了。如何使“下一个注释，然后显示工具提示描述”成为绑定到单个击键的宏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T14:02:04.900

好吧，您可以按 F2 显示通常显示 javadoc 的弹出窗口。如果有错误，它将显示错误消息以及可用的快速修复。

所以你可以反复按Ctrl+.、F2来达到你想要的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T15:58:47.037

是的，烦人的问题。`Ctrl+1`如果您从同一行使用它，则会显示快速修复。有时我不得不求助于从问题视图中复制错误消息:(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T21:07:29.720

> “在明显滞后后，错误消息显示为“工具提示”，以及任何相关的“快速修复”。

不知道这是否对您有帮助，但您可以通过更改位于以下菜单中的自动激活延迟值来减少弹出窗口中的延迟：

```
Window>Preferences>Java>>Editor>ContentAssist 
```

# visual-studio - 创建颠覆存储库的最佳实践？

> ID：167014
> 
> 赞同：26
> 
> 时间：2008-10-03T13:59:01.690
> 
> 标签：visual-studio, svn, tortoisesvn, visualsvn-server, visualsvn

我们的团队（5-10 名开发人员）计划为我们的 .NET (Visual Studio) 项目/解决方案（VisualSVN 服务器、TortoiseSVN / VisualSVN）**采用 Subversion 。**

**组织新存储库树**的最佳方法是什么？可以使用*一个大存储库*还是为每个解决方案/产品线等创建*不同*的存储库更好？

我们的项目可以这样分类（示例）：

*   主要产品线
    *   主网络应用程序
        *   图书馆 1
        *   图书馆 2
        *   ...
    *   视窗客户端
    *   另一个 Windows 客户端
    *   视窗服务
*   工具
    *   工具 A
    *   工具 B
*   产品线2
    *   软件 1
    *   软件 2
*   产品线 3
    *   应用程序 1
    *   应用程序 2

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-03T15:14:18.047

我的灵感来源：

*   [使用 Subversion 进行版本控制](http://svnbook.red-bean.com/en/1.8/svn.reposadmin.planning.html#svn.reposadmin.projects.chooselayout)
*   [Subversion 存储库布局](http://blogs.collab.net/subversion/2007/04/subversion_repo/)
*   [单个存储库或多个](http://blogs.collab.net/subversion/2007/04/single_reposito/)
*   [多个 Subversion 存储库](http://blogs.collab.net/subversion/2007/03/multiple_subver/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-03T14:10:52.137

通常，在您期望不同的访问权限的任何情况下，您都希望使用单独的存储库（即，一些开发人员应该对一个项目具有提交访问权限，但对另一个项目没有，或者一个项目具有公共只读匿名接口但另一个没有） t)。

如果您不需要该级别的访问控制，尤其是当您需要能够在项目之间复制或移动文件（即项目可能共享代码）时，您希望所有内容都在一个存储库中。

将你的trunk/tags/branch拆分放在与你可能作为单个包发布的代码块相对应的任何级别（即考虑你将标记的位置）。一开始这并不重要，因为它们在内部与任何其他文件夹没有什么不同，所以你可以稍后移动东西，当然没有这个问题会更整洁。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-03T14:08:20.440

*   SVN 管理观点我更喜欢 1 个存储库。
*   程序员的立场我更喜欢 1 个存储库。
*   服务器管理员 我更喜欢 1 个存储库。
*   从安全角度来看，最好不要把所有的鸡蛋都放在一个篮子里。

您的存储库结构对于您的业务和产品来说有些独特。我们将我们的保存在一个存储库中。我们的结构有点像这样。

*   /
    *   项目
        *   项目名
            *   树干
            *   分支机构
            *   标签
    *   文档
        *   项目一
    *   共享库
        *   超弦类
    *   小型公用事业
        *   vim 增强 X

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-03T14:01:40.033

我们使用一个大存储库，并将所有内容都结构化在子文件夹（/project1、/project2 等）中，这似乎工作正常。

Apache 项目有一个[巨大的 svn 存储库](http://svn.apache.org/viewvc/)，它似乎对他们来说还不错！:)

在组织方面，你给出的结构看起来很合理。我认为任何事情都会发生，只要它是合理的（即将每个工具与每个项目混合可能是一个坏主意等）。所以选择适合你的东西（工具/项目/等）。Subversion 也很好地支持在存储库中移动内容，因此您可以随时根据需要进行更改。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-03T14:01:48.877

我们有一个结构类似的单一回购。任何由几个人以上和/或在积极开发中工作的东西都在主文件夹下设置了trunk/ tags/ branch/。

我们可能会将那些 trunk-tags-branch 文件夹集放在您列出的每个子文件夹下，除了可能没有处于积极开发中的一两个库。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-04T07:35:45.317

尝试将定期访问的材料（代码、脚本）与*“一次写入并提交到备份”的*内容分开。仅仅为了更改几行代码就必须签出/更新数千个 jpeg，这很快就会变得乏味。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-06T15:54:50.207

我们对每个项目都有单独的回购；但主要原因是访问原因加上如果客户想要一份他们的来源的副本，我们可以将其与历史一起提供给他们而不会大惊小怪。如果您查看 conf 中的配置文件，那么拥有一个适用于所有项目的通用配置文件并不难。我们这样做：

```
[general]
anon-access = none
auth-access = write
password-db = ../../conf/passwd
authz-db = ../../conf/authz 
```

授权：

```
[groups]
AOS = nathan,mark

[AOS:/]
@AOS = rw
frew = rw 
```

然后当然是密码：

```
[users]
frew = password
nathan = awesome
mark = station 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-06T20:55:02.727

我正在使用一个存储库和许多项目，如下所示：

```
Projects
   Project Name
      trunk
      branches
      tags 
```

我唯一关心的是备份和恢复。SVN 备份是在存储库级别完成的，因此还原将还原所有项目，而不仅仅是一个。

吉荣

# multithreading - 我应该一起使用线程和递归吗？

> ID：167018
> 
> 赞同：9
> 
> 时间：2008-10-03T13:59:28.790
> 
> 标签：multithreading, recursion

我一直在修补 BSP 树一段时间，也在玩线程。将三角形添加到 BSP 树时，就有机会创建一个新线程以并行处理数据。

```
插入（三角形，bspnode）
{
  ……
  else if(三角形跨越 bspnode)
  {
    (frontpiece, backpiece) = plane_split(triangle, bspnode)

    插入（前端，bspnode.front）
    插入（背板，bspnode.back）
  }
  ……
}

```

上面的两个插入操作可以由两个线程执行，并且由于它们不会修改相同的数据，因此可以使用廉价的同步。

```
插入（三角形，bspnode）
{
  ……
  else if(三角形跨越 bspnode)
  {
    (frontpiece, backpiece) = split(triangle, bspnode)

    句柄 = beginthread（插入（后件，bspnode.front））
    插入（前端，bspnode.back）
    如果（句柄）
    {
      等待线程（句柄）
    }
    别的
    {
      插入（后端，bspnode.front）
    }
  }
  ……
}

```

这种新方法尝试创建一个线程以并行完成操作，但如果无法创建线程也不应该失败（它将简单地恢复到原始算法）。

这是一种合理的编程习惯，还是我不正确地使用线程？我还没有找到任何关于这种技术的文献。我喜欢它倾向于充分利用我的 CPU（2 个内核），并且理论上可以扩展到任意数量的可用处理器。我不喜欢这可能会严重浪费 CPU 和内存。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-03T14:03:01.450

如果处理的某些部分正在等待外部的某些东西（用户输入、I/O、其他一些处理），那么线程会很棒——等待的线程可以继续等待，而没有等待的线程会继续等待。

但是，对于处理密集型任务，实际上比处理器多的线程会产生开销。看起来你的线程正在做所有的“CPU工作”，所以我会坚持每个核心一个线程——不过，测试以找到最佳数量。

产生的最大开销来自上下文切换（冻结一个线程并加载下一个线程的执行上下文），以及线程使用不同内存执行任务时的缓存未命中（如果您的线程可以有效地使用 CPU 缓存）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T14:29:32.910

您最好的选择是创建一个线程池，然后“透明地”使用它来添加节点。

例如，在程序启动时创建 2 个线程，让它们等待信号量或事件。当您有要添加的节点时，您将数据弹出到队列中，然后触发信号量。这唤醒了将数据从队列中弹出并执行处理的线程之一。（确保对队列的访问是线程安全的 - 最好与关键部分完全同步）。

由于在将数据复制到队列和运行额外线程方面有更多开销，因此应用程序的整体性能会变慢，但如果您以前在单核上运行，现在将在 2 核上运行。如果线程加工成本高。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T14:36:00.150

当然，例如，Quicksort 可以很容易地进行多线程编程，并在多核系统上获得一些较大的性能提升，而在非多线程系统上获得一些小的性能损失。请记住，您现在添加了两次开销 - 一次用于堆栈保存递归，一次用于线程，因此如果您正在执行大量递归，那么它可能比非多线程方法更快地压倒系统。

# html - 如何右对齐 HTML 文本框中的文本？

> ID：167027
> 
> 赞同：73
> 
> 时间：2008-10-03T14:01:19.160
> 
> 标签：html, css

我需要在列中显示许多数值。这些值需要易于编辑，因此我不能只在表格中显示它们。我正在使用文本框来显示它们。有没有办法让我右对齐文本框中显示的文本？如果用户在输入数据时开始显示他们从右侧键入的内容，那也很好。

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2008-10-03T14:03:47.250

您是否尝试设置样式：

```
input {
    text-align:right;
} 
```

刚刚测试过，这很好用（至少在 FF3 中）：

```
<html>
    <head>
        <title>Blah</title>
        <style type="text/css">
        input { text-align:right; }
        </style>
    </head>
    <body>
        <input type="text" value="2">
    </body>
</html> 
```

您可能希望在这些输入上抛出一个类，并将该类用作选择器。我会回避“rightAligned”或类似的东西。在类名中，您想描述元素的功能是什么，而不是应该如何呈现。“数字”可能很好，或者可能是文本框的业务功能。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-03T14:05:07.497

使用内联样式：

```
<input type="text" style="text-align: right"/> 
```

或者，将其放入样式表中，如下所示：

```
<style>
   .rightJustified {
        text-align: right;
    }
</style> 
```

并引用类：

```
<input type="text" class="rightJustified"/> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T14:05:48.760

应用于`style="text-align: right"`输入标签。这将允许条目右对齐，并且（至少在 Firefox 3、IE 7 和 Safari 中）甚至会出现从右侧流动。

# windows - 以编程方式将键盘更改为 Dvorak

> ID：167031
> 
> 赞同：28
> 
> 时间：2008-10-03T14:02:09.017
> 
> 标签：windows, dvorak

有谁知道我可以用来将 Windows 机器上的键盘布局更改为 Dvorak 的 API 调用？通过 UI 执行此操作很容易，但我想要一个可以在新 VM 上运行的脚本来自动化该过程。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-02T19:04:38.950

我可能迟到了四年，但你有没有发现这个：

[Intlcfg 命令行选项](http://technet.microsoft.com/en-us/library/cc722068%28v=WS.10%29.aspx)

我没有 Windows Vista（非常坏的习惯，Windows），但是查看此页面以及[可用语言包](http://technet.microsoft.com/en-us/library/cc722435%28v=ws.10%29.aspx)和[默认输入区域设置](http://technet.microsoft.com/en-us/library/cc766503%28v=ws.10%29.aspx)我认为您想要的命令很可能是：

```
intlcfg.exe -inputlocale:0409:00010409 
```

用于具有美国 Dvorak 输入区域设置的英语（美国）语言。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-03T14:07:46.743

您可以通过注册表执行此操作。只需将其保存为 .reg 文件，然后在新 VM 上打开它。我相信这应该可以重新映射到德沃夏克：

```
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout]
"ScanCode Map"=hex:00,00,00,00,00,00,00,00,22,00,00,00,2d,00,30,00,24,00,2e,00,\
11,00,33,00,33,00,11,00,12,00,20,00,34,00,12,00,1b,00,0d,00,0d,00,1b,00,16,\
00,21,00,17,00,22,00,20,00,23,00,1a,00,0c,00,2e,00,17,00,23,00,24,00,14,00,\
25,00,31,00,26,00,35,00,1a,00,30,00,31,00,13,00,18,00,26,00,19,00,2f,00,34,\
00,28,00,10,00,0c,00,28,00,19,00,13,00,18,00,1f,00,1f,00,27,00,2c,00,35,00,\
15,00,14,00,22,00,16,00,25,00,2f,00,10,00,2d,00,21,00,15,00,27,00,2c,00,00,\
00,00,00 
```

如果你想回去：

```
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout]
"ScanCode Map"=hex:00,00,00,00,00,00,00,00,01,00,00,00,00,00,00,00 
```

# ruby-on-rails - 多数据库连接

> ID：167053
> 
> 赞同：5
> 
> 时间：2008-10-03T14:08:08.037
> 
> 标签：ruby-on-rails, ruby

我正在尝试了解连接到我的数据库的最佳方式。

目前我有一个解析 URL 的方法（取决于调用的 URL，应用程序必须连接到不同的数据库，比如 customer1.example.com 将连接到 customer1 数据库）并调用

```
ActiveRecord::Base.establish_connection(conn_string) 
```

其中 conn_string 包含数据库的名称。

此方法 (set_db) 使用

```
before_filter :set_db 
```

在我的应用程序控制器中，所以基本上对于我收到的每个请求，都会解析 URL，并且应用程序会尝试进行建立连接。

我想知道我是否可以在某个地方建立一个连接池....您对此有什么建议吗？拥有一个保持所有连接并返回正确连接的单例会更好吗？

谢谢！罗伯托

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T14:53:37.463

数据库是否在同一台服务器上？

我有一个应用程序，其中一些模型对象来自一个数据库，而其他模型对象来自不同的数据库。我覆盖 table_name 函数来指定数据库。如果它们是不同的服务器，则将不起作用，但适用于同一服务器中的不同数据库。

```
class xx < ActiveRecord.base

def self.table_name
  "otherdatabase.table"
end 
```

看起来数据库池可能正在为即将推出的 Rails 版本开发。

[Edge Rails 的新功能](http://ryandaigle.com/articles/2008/9/7/what-s-new-in-edge-rails-connection-pools)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-04T13:11:58.307

First regarding the comment left on your initial post : this has *nothing* to do with ruby. it has everything to do with the design of rails.

with that said, you could probably hijack the ActiveRecord::Base behaviour to keep a hash of connections indexed by a key (in your case the key would be the user name) then intercept establish_connection to check in the pool if the connection is open already

that would require that you reopen ActiveRecord base,which makes your change dependant on AR internals.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-04T17:29:44.167

我不打算讨论你关于池的问题。但是，我相信汇集将有助于改善很多事情。我还有一个安装，每个客户端都有自己的数据库，并且代码库在它们之间共享。

解析 url 的方法是在 Apache Rewrite 配置中的 Rails 外部实现的，因为可以将多个主机映射到单个客户。我还使用客户“密钥”访问网络服务器磁盘上的缓存文件。重写配置看起来像这样：

```
RewriteMap accounts prg:domain_mapper.rb
RewriteMap lowercase int:tolower

RewriteCond %{HTTP_HOST} ^(.*)$
RewriteCond ${accounts:${lowercase:%1}} ^(.+)$
RewriteRule . - [E=ACCOUNT:%1]
RequestHeader set Customer-Key %{ACCOUNT}e 
```

客户键将直接映射到将在 before_filter 方法中连接的数据库名称。

到目前为止，在 Rails 端切换数据库连接不是性能问题。问题出在 MySQL 配置中，我们面临的问题是数据库过多，请求过多会导致 MySQL 中打开的数据库过多。

我确定您一直在考虑迁移问题。一开始使用 < 2000 个数据库模式并不是问题。现在有超过 15,000 个客户数据库（并且还在增长），因此我们将它们合并回少量的分片数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T14:48:24.323

我不是 Ruby 程序员，但一般来说连接池是个好主意。您可以使该连接池成为单例并分发/收回连接。池可以在恢复连接后检查一切是否仍然正常。

每个连接都应该有不同的生命周期和所有权，这样两个线程就不会同时使用一个连接。

小心使用临时表，因为它们属于一个数据库会话。我们有一个错误，在高负载情况下我们会遇到奇怪的错误。最后我们记得我们在应用程序中使用了临时表。在高负载情况下，数据库连接中断并由连接对象自动重新生成，而应用程序代码不知道它（我们已经实现了重新连接，但忘记了在这种情况下这是一个问题）。我们要读取的临时表消失了。

# serialization - 为内存数据结构增加持久性

> ID：167063
> 
> 赞同：9
> 
> 时间：2008-10-03T14:11:25.707
> 
> 标签：serialization, data-structures

**您可以采用哪些流行技术来增加内存数据结构的持久性（即，如果进程崩溃，您可以保留之前对该数据结构执行的所有操作？**

如果我的数据结构只涉及一个元组列表，那么我只需将它们存储在 SQL DB 中，这样我就可以免费获得持久性。但是，如果我的数据结构是图或树怎么办？

我能想到的一件事是将所有操作显式记录到磁盘（仅附加日志），并在发生崩溃时重播日志以保留以前的状态。如果日志变得太大，那么就会有一个压缩步骤。我猜这是数据库引擎在内部为持久性所做的事情（检查点就是这个过程的名称）？

顺便说一句，这不是整个数据集不适合内存的情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T14:25:33.120

您可能想尝试[对象流行引擎](http://www.ibm.com/developerworks/library/wa-objprev/)。对于 .NET，您可能想尝试[Bamboo.Prevalence ，它是一个名为](http://bbooprevalence.sourceforge.net/)[Prevayler](http://www.prevayler.org/wiki/) for Java的类似引擎的端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-26T00:54:15.747

我已经在 2 家公司的产品中实施了“Mrjb”技术，这基本上正是您在问题中所建议的：“内存驻留日志支持”数据库，一个内存数据结构，每个更改都被记录到磁盘，因为它发生。它对我们很有用！

[http://www.edval.biz/memory-resident-programming-object-databases](http://www.edval.biz/memory-resident-programming-object-databases)

我很乐意分享我们在生产环境中使用它的实际经验。我喜欢能够回放精确的事件序列或回滚到任何时间点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T14:12:49.107

您要查找的词是“序列化”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T14:15:18.007

您可以想出一些方法来序列化您的结构，无论是使用 XML、YAML、JSON 等。然后您可以将其存储在数据库中，或者在程序的主要执行点周围放置一个大的 try/catch。然后，如果发生一些未捕获的异常，这将导致程序崩溃，您可以序列化您的数据，并记录任何错误消息、堆栈跟踪等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T14:15:47.493

是的，您可能希望将数据序列化为某种格式——xml、二进制等。根据编程语言，这可能是为您内置的。Java 有[ObjectStreams](http://java.sun.com/javase/6/docs/platform/serialization/spec/serialTOC.html)，.NET 有[XmlSerializer](http://msdn.microsoft.com/en-us/library/ms950721.aspx)和[BinaryFormatter](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.binary.binaryformatter(VS.71).aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T14:16:42.467

对您的问题的任何回答都需要执行类似于 ACID 数据库系统的操作。所以我想说你最好的选择是使用 RDBMS 来存储你的应用程序状态，每当你有一个不能丢失的（应用程序）事务时更新。

# macos - 在 Mac OS 上本地化应用程序

> ID：167066
> 
> 赞同：0
> 
> 时间：2008-10-03T14:12:04.817
> 
> 标签：macos, localization

我有一个应用程序，它应该可以在 Windows 和 Mac 上运行，并且本地化为葡萄牙语、西班牙语和德语。我有一个 ini 文件，从中读取本地化字符串。但是 ini 文件不适用于两个平台上的文件的相同编码。对于 Windows，我必须拥有 ANSI 格式的文件，否则本地化字符串中的重音字母会变得混乱，并且在 Mac 上，相同的文件应该采用西方（Mac OS）编码，否则结果相同。有什么办法可以让一个文件在两个平台上工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T14:20:58.153

(1) 不存在ANSI 格式*之类的东西。*对于 Windows 上的“本地代码页”来说，这是一个不幸的术语。特别是，这意味着在欧洲，将字节 128-255 解释为“ANSI 格式”在不同国家/地区之间会有所不同。因此，我强烈倾向于认为它甚至无法在您的第一个平台上运行，更不用说两者了。

您最终将迁移到的解决方案是 Unicode。这适用于所有字符，字符数不取决于国家或当前日期（参见 € 的介绍）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T18:10:37.723

在 Mac 上，您可以将本地化资源（文本文件等）放在 .lproj 文件夹中，Cocoa 库将找到用户语言的版本。例如 English.lproj、Spanish.lproj 等。最好使用这个系统而不是拥有自己的自定义本地化机制。

如果您使用的不是 Cocoa，并且出于可移植性原因需要使用自定义本地化内容，那么您可以尝试加载指定文本编码的文件。在 Windows 上，它通常是 ISO-8859-1（也称为 Windows Latin 1）。或者，您可以将文本文件转换为 Unicode 并指定其为 UTF-8 来读取它们。您没有告诉您为此使用什么语言或框架，因此如果没有更多信息，我们将无法为您提供任何进一步的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T07:35:29.013

欢迎来到痛苦的世界。我还建议切换到 Unicode，它会给你一个可验证的基础，让你以后的生活更轻松

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T14:30:40.787

[gettext](http://www.gnu.org/software/gettext/)是一个广泛使用的框架，用于翻译应用程序、网站等。

# mysql - MySQL 限制多对多关系

> ID：167067
> 
> 赞同：2
> 
> 时间：2008-10-03T14:12:38.217
> 
> 标签：mysql, database, tags, tagging

给定用于实现标签的 SCHEMA

项目项目 ID、项目内容

标记标记 ID、标记名称

ITEM_TAG 项目 ID、标签 ID

使用标签选择时限制返回的项目数量的最佳方法是什么？

```
SELECT i.ItemContent, t.TagName FROM item i 
INNER JOIN ItemTag it ON i.id = it.ItemId 
INNER JOIN tag t ON t.id = it.TagId 
```

当然是让它们全部恢复的最简单方法，但是使用限制子句会失效，因为您会得到每个标签的所有项目的副本，这会计入 LIMIT 中的行数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T16:03:57.587

我的第二个解决方案使用 MySQL 函数 GROUP_CONCAT() 将与项目匹配的所有标签组合成结果集中的逗号分隔字符串。

```
SELECT i.ItemContent, GROUP_CONCAT(t.TagName ORDER BY t.TagName) AS TagList
FROM item AS i 
  INNER JOIN ItemTag AS it ON i.id = it.ItemId 
  INNER JOIN tag AS t ON t.id = it.TagId
GROUP BY i.ItemId; 
```

GROUP_CONCAT() 函数是 MySQL 的一个特性，它不是标准 SQL 的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T14:31:49.957

也许像

```
select i.ItemContent, t.TagName from (SELECT ItemId, ItemContent FROM item limit 10) i
INNER JOIN ItemTag it ON i.ItemId = it.ItemId --You will miss tagless items here!
INNER JOIN tag t ON t.id = it.TagId 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T15:59:59.857

我的第一个建议是使用子查询来生成项目 ID 列表并返回与这些项目 ID 匹配的项目。但这不包括结果集中的 TagName。我将使用另一个解决方案提交单独的答案。

```
SELECT i.ItemContent
FROM item AS i
WHERE i.id IN (
  SELECT it.ItemId
  FROM ItemTag AS it
    INNER JOIN tag AS t ON (t.id = it.TagId)
  WHERE t.TagName IN ('mysql', 'database', 'tags', 'tagging')
); 
```

这是一个不相关的子查询，所以一个好的 SQL 引擎应该把它分解出来并且只运行一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T16:13:11.717

您还可以使用 Distinct/Group By：

`SELECT DISTINCT TagID, TagName FROM ((TAG T INNER JOIN ITEM_TAG I_T ON T.TagID = I_T.TagID) INNER JOIN ITEM I ON I_T.ItemID = I.ItemID) GROUP BY TagID, TagName`

# c# - 从桌面到 Web 的 C# 代码

> ID：167073
> 
> 赞同：1
> 
> 时间：2008-10-03T14:14:52.173
> 
> 标签：c#

如果我使用 C# 开发桌面应用程序，然后想将其转换为 web 应用程序但不想使用 ASP.NET，我有什么选择？

我做了一些搜索，看起来除了将 C# 代码作为 Web 服务运行并进行 SOAP 调用之外，似乎没有一个好的解决方案可以将 C# 代码与任何脚本语言集成。

还有其他想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T14:18:01.280

你为什么要让自己的事情变得如此困难？最好的办法是将几乎所有代码放入一个程序集中，并仅使用 winforms 应用程序进行显示。然后，稍后，您可以在 asp.net 中重新实现显示逻辑。

所以，我想答案是否定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T15:54:43.877

对于您关于托管的回复，我无法发表评论，但我已经使用 Lunarpages 进行 .net 托管多年了，发现它与 linux 托管一样实惠，并且具有 php 支持、无限 mysql 和 ms 等相同的好处sql 数据库等

要回答单声道问题，这很好，但我认为单声道最多只支持 3.0 ATM。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T16:22:50.030

我投单轨电车。保持一个好的 MVC 模型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T14:20:32.803

AJAX + WebService + 纯 HTML

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T14:22:04.907

您可以在应用程序中嵌入网络服务器。这很容易，即使使用线程，您也可以处理同时请求。

网上有很多例子，这里有一个在 codeplex： http: [//www.codeplex.com/webserver](http://www.codeplex.com/webserver)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T15:36:04.773

让您的应用程序提供 SOAP 服务很容易，然后您可以将其与几乎任何语言的前端集成。

如果您真的想避免这种情况，那么只需选择一些不那么推荐但便宜的 ASP.Net 托管并使用它 - 如果应用程序成功，您以后可以随时转向专用托管。花一点钱让你的生活变得更轻松是值得的，从你所说的来看，如果这意味着你必须做四倍的工作，那么避免使用 ASP.Net 确实没有什么意义。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T15:49:45.993

Mono 上的 ASP.NET 怎么样？这在现实中有多痛苦？

# css - ASP.net MVC 中的 MembershipProviders 会影响样式表链接吗？

> ID：167074
> 
> 赞同：0
> 
> 时间：2008-10-03T14:15:16.933
> 
> 标签：css, asp.net-mvc, href, membership-provider

我在我的 ASP.net MVC 网站中更改了 MembershipProvider，现在登录页面的样式表没有被正确引用。如果这可能是原因，下面是我的 web.config 中表单标签的副本。除了名称和超时属性之外，它看起来与新项目生成的相同。

```
<authentication mode="Forms">
      <forms loginUrl="~/Account/Login" name=".ADAuthCookie" timeout="10" />
</authentication> 
```

当我现在访问该页面时，CSS 的链接标记如下所示：

```
<link href="../Content/Site.css" rel="stylesheet" type="text/css" /> 
```

什么时候*应该*是这样的：

```
<link href="../../Content/Site.css" rel="stylesheet" type="text/css" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T14:53:37.447

我自己还没有使用过 ASP.NET MVC，但是你可以在写出 CSS 的 href 时尝试使用[ResolveClientUrl ：](http://msdn.microsoft.com/en-us/library/system.web.ui.control.resolveclienturl.aspx)

```
<link href="<%= ResolveClientUrl("../../content/Site.css") %> rel="stylesheet" type="text/css" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-07T18:08:28.003

谢谢伊恩·奥克斯利。不过，ResolveClientUrl 并没有解决这个问题。

它必须处理 web.config 文件。我的代码如下所示：

```
<authorization>
  <deny users="?" />
  <allow users="*" />
</authorization> 
```

我在主要元素下方添加了一个位置元素，并说任何人都可以查看该内容，并且现在可以使用。事实证明，像 CSS 文件这样的文件在获得授权之前是无法查看的。现在已经解决了。

这是我添加的：

```
<location path="Content">
   <system.web>
      <authorization>
         <allow users="*" />
      </authorization>
   </system.web>
</location> 
```

# c# - 将现有代码迁移到测试驱动开发

> ID：167079
> 
> 赞同：36
> 
> 时间：2008-10-03T14:16:04.713
> 
> 标签：c#, tdd, nunit

最近发现了这种开发方法，我发现它是一种相当不错的方法。所以，对于我的第一个项目，我有一个小的 DLL 代码（在 C#.NET 中，因为它的价值），我想为这个代码做一组测试，但我有点迷茫如何和从哪儿开始。

我正在使用 NUnit 和 VS 2008，任何关于从何种类开始、为什么编写测试以及一般如何将代码移动到基于测试的开发的任何提示都将不胜感激。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-10-03T14:20:45.157

请参阅Michael Feathers所著的[《有效处理遗留代码》一书。](http://www.amazon.co.uk/Working-Effectively-Legacy-Robert-Martin/dp/0131177052)

总之，将现有代码重构为可测试和经过测试的代码需要做很多工作；有时工作量太大而不能实用。这取决于代码库有多大，以及各种类和函数相互依赖的程度。

没有测试的重构将引入行为的变化（即错误）。纯粹主义者会说这并不是真正的重构，因为缺乏测试来检查行为是否没有改变。

与其一次性向整个应用程序全面添加测试，不如在代码区域工作时添加测试。很可能您将不得不再次返回这些“热点”。

自下而上添加测试：测试小的、独立的类和函数的正确性。

自上而下添加测试：将整个子系统作为黑盒进行测试，看看它们的行为是否会随着代码的变化而变化。因此，您可以逐步查看它们以了解发生了什么。这种方法可能会给你带来最大的好处。

在添加测试时不要太在意“正确”行为是什么，寻找并避免行为变化。未经测试的大型系统通常具有看似不正确但系统的其他部分依赖的内部行为。

考虑隔离数据库、文件系统、网络等依赖项，以便在测试期间将它们替换为模拟数据提供者。

如果程序没有内部接口，即定义一个子系统/层与另一个子系统/层之间边界的线，那么您可能必须尝试引入这些，并对其进行测试。

此外，像[Rhinomocks](http://ayende.com/projects/rhino-mocks.aspx)或[Moq](http://code.google.com/p/moq/)这样的自动模拟框架可能有助于在这里模拟现有的类。在为可测试性设计的代码中，我还没有真正发现对它们的需求。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-03T17:10:40.837

我称之为“测试驱动的逆向工程”。

从“底部”开始——每个类都可以单独检查并为其编写测试。如有疑问，请猜测。

当您正向执行普通的 TDD 时，您将测试视为神圣的，并假设代码可能已损坏。有时测试是错误的，但你的出发点是它是代码。

当你在做 TDRE 时，代码是神圣的——直到你能**证明**代码有一个长期存在的错误。在相反的情况下，您围绕代码编写测试，调整测试直到它们工作并声称代码工作。

然后，您可以深入研究错误的代码。一些糟糕的 cade 会有合理的测试用例——这只是需要清理。然而，一些糟糕的代码也会有一个毫无意义的测试用例。这可能是您可以纠正的错误或笨拙的设计。

要判断代码是否真的错误，您还需要从整体测试用例开始。真正有效的实时数据是一个开始。此外，产生任何已知错误的实时数据也是一个很好的起点。

我编写了一些代码生成器来将实时数据转换为单元测试用例。这样，我就有了一致的测试和重构基础。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-03T14:24:26.600

[在将未经测试的代码迁移到单元测试环境中时，有效地使用遗留代码](https://rads.stackoverflow.com/amzn/click/com/0131177052)是我的圣经，它还提供了很多关于什么使代码易于测试以及如何测试它的见解。

我还发现[Test Driven Development by Example](https://rads.stackoverflow.com/amzn/click/com/0321146530)和[Pragmatic Unit Testing: in C# with NUnit](https://rads.stackoverflow.com/amzn/click/com/0321146530)是对该环境中单元测试的一个不错的介绍。

启动 TDD 的一种简单方法是从今天开始首先编写测试，并确保无论何时需要接触现有（未经单元测试）的代码，在更改之前编写通过测试来验证系统的现有行为这样您就可以在之后重新运行这些测试，以增加您没有破坏任何东西的信心。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-03T14:24:24.073

可测试的代码很容易被发现 - 通过附带的测试。如果有的话，它必须是可测试的。如果没有 - 假设相反。;)

也就是说：测试驱动开发（TDD）与其说是一种测试策略，不如说是一种设计策略。您首先编写的测试有助于设计类的接口，以及正确确定类（或子系统）的范围。

拥有您在 TDD 期间创建的测试并在以后执行它们是很好的测试，但这只是该设计理念的一个（非常受欢迎的）副作用。

这就是说，预计您的代码会对测试产生一些阻力。聆听您的代码并更改界面以便于测试。当您开始编写测试时，您很可能会重新设计它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T17:02:10.730

您的 DLL 提供某种服务。对于每一个服务，在获取这个服务之前你要做什么，你应该传递什么参数来获取这个服务，你怎么知道请求的服务已经正确执行了？

一旦你有了这些问题的答案，你就可以编写第一个测试。这样的测试宁愿被称为特性测试而不是单元测试，但如果 DLL 不是使用 TDD 开发的，它可能比单元测试更容易编写。

M. Feathers 的“有效地使用遗留代码”中也讨论了表征测试，在其他回复中也推荐了这一点。

此外，请务必在添加任何新代码行之前编写失败的测试。

# .net - 在 .NET 中检测图形选项

> ID：167084
> 
> 赞同：0
> 
> 时间：2008-10-03T14:16:54.247
> 
> 标签：.net, vb.net, multiple-monitors

在.net中检测和稍后更改屏幕分辨率和多个桌面的最佳方法是什么

我有一个小应用程序，虽然在我的多显示器/高（ish）分辨率上运行，但我希望能够检测到用户的主显示器并将应用程序设置为该（主要目标）并调整分辨率以确保该应用程序适合（更多出于我自己的好奇心）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T14:20:55.047

我永远不会建议改变用户的分辨率，除非你在做全屏游戏，你可以使用

```
 System.Windows.Forms.Screen.PrimaryScreen 
```

为您提供有关该主监视器的指标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T14:27:21.150

如果您正在开发基于 WinForms 的应用程序，除了使用 Bob King 描述的 Screen 指标外，您还可以使用布局控件，例如 TableLayout 和 FlowLayout。布局控件允许您设计 UI 以干净地适应屏幕/窗口大小。（我目前正在开发的 WinForms 应用程序在这方面做得非常好，最小为 1024x768，可以随心所欲地缩放控件。）

先发制人的评论：是的，TableLayouts 确实会影响性能。但是，我的经验是，用户在展示好处时往往会接受它。（新显示器：该应用程序看起来仍然很棒并且可以正常工作！）

# .net - .NET 中 Web 服务的正确命名约定是什么？

> ID：167088
> 
> 赞同：4
> 
> 时间：2008-10-03T14:18:28.003
> 
> 标签：.net, web-services

我正在创建一个 web 服务，并且我想适当地命名它。

现在我的服务根据 /App_Code/Service.cs 命名为 Service

我应该将其重命名为：*com.example.MyWebService.cs*吗？

我如何绕过类文件而不是“。” 在文件名中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T14:20:58.340

“com.example.whatever”命名空间是 java 特有的。Microsoft 建议您使用 Company.Product.etc.。

查看命名指南：http: [//msdn.microsoft.com/en-us/library/ms229002.aspx](http://msdn.microsoft.com/en-us/library/ms229002.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T14:25:27.583

com.example 将是命名空间，而不是类/服务名称的一部分。

你应该做：

```
namespace Com.Example
{
    public class MyWebService
    {
        // class contents
    }
} 
```

# c# - FOREACH 返回的对象顺序是否稳定？

> ID：167096
> 
> 赞同：19
> 
> 时间：2008-10-03T14:19:41.137
> 
> 标签：c#, .net, collections, foreach, ienumerable

假设对同一个集合的两次迭代将以相同的顺序返回对象是否安全？显然，假设该集合没有以其他方式改变。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-03T14:21:58.667

这取决于集合类型。对于大多数收藏，答案是“是”。

但是，这不能保证。集合类型的文档应该指定它是否这样做，但与大多数人一样，通常会忽略该细节。但是，如果它不稳定，如果文档没有提及，那将是一个巨大的疏忽。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-03T14:21:27.217

简短的回答 - 是的。

但是，显然，集合中项目的顺序可能与插入时不完全相同，具体取决于集合的类型（例如字典）。

但是，每次使用 foreach 循环遍历一个未修改的集合时，都会得到相同的结果。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-03T14:30:24.140

除非您知道要迭代的类的具体实现，否则您无法保证这一点。

具有已定义元素顺序（例如 ）的集合`List<T>`将以稳定的顺序进行枚举。

对于对象状态不改变的集合，元素很可能会以相同的顺序返回，例如`Dictionary<K,V>`，尽管规范不保证这一点。

作为一个不属于这种情况的示例，您可以想象一个基于哈希表的字典实现，它异步压缩或调整表的大小。这样的实现不能保证稳定的迭代顺序。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-03T14:26:54.177

虽然对于所有内置集合以及可能存在的任何健全的集合类，答案都是“是”，但文档没有为`IEnumerable`. 因此，没有什么告诉我们每次迭代都必须是稳定的。

我可以想象以下用例：

```
foreach (int i in new Shuffler(1, 2, 3, 4, 5, 6, 7, 8, 9))
    Console.WriteLine(i); 
```

这很可能被实现为一个为每次迭代产生不同排序的类。

所以——如果你还想考虑奇怪的边缘情况，答案应该是“<strong>no”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-03T14:29:15.953

虽然通常情况下，元素将以相同的顺序返回，但绝对不能保证。它完全依赖于集合类的内部实现。

例如，我可以看到一个专门设计用于以随机顺序返回元素的集合类的案例。

简而言之，除非你知道集合类的内部实现，*否则不要*假设任何关于顺序的事情。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-04-27T13:31:00.853

Linq为此目的定义了[IOrderedEnumerable接口。](http://msdn.microsoft.com/en-us/library/bb534852.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T14:31:45.587

重新“未修改”（NM 的回复） - 请注意，像 Dictionary 这样的许多复杂容器不保证保留顺序。有时添加一个项目会使它出现在最后（给人以保留顺序的印象），有时它会导致内部存储桶重新组织，给出完全不同的顺序。

SortedList<,> 之类的东西显然有自己的规则。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-03T14:24:34.557

我会说，对于大多数收藏来说，假设这一点是安全的。某个集合可能以非确定性方式实现枚举器并没有超出可能性范围，但这可能不会发生......

# php - 如何限制哪些国家可以查看我的网站（PHP）

> ID：167106
> 
> 赞同：11
> 
> 时间：2008-10-03T14:21:37.903
> 
> 标签：php, geolocation

在 PHP 中有一个简单的方法来做到这一点。我想确保只有来自某些国家的网络请求才能访问我的网站。

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-03T14:24:04.323

使用 IP 地理定位数据库（有些是免费的）和 $_SERVER["REMOTE_ADDR"] 来获取访问者的 IP 地址。

[http://www.maxmind.com/app/geolitecity](http://www.maxmind.com/app/geolitecity)是商业版本的免费（不太准确）版本。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-03T15:12:10.997

像 Gilles 一样，我过去曾为此使用过 MaxMind 的 GeoIP - 配置了 PECL 扩展以提高速度。它工作得相当好，但是......

对这种事情的需求往往来自不了解以这种方式可靠地确定访问者位置的人。鼓励请求它的人理解它*几乎*没有用是非常重要的。在这种情况下，地理位置发生的典型事情：

> > > 客户：我希望能够通过 IP 限制内容
> > > Dev：你知道那是不可能可靠地做到的吗？
> > > 客户：是的，但是这家公司说他们会卖给我一些可以做到的东西
> > > 开发人员：是的，但它不准确，很容易规避，通常表明基于互联网的内容的商业模式很差
> > > 客户：你能做到吗？
> > > 开发者：随便……

……六个月后……

> > > 客户：我的一些访问者一直在抱怨他们看不到我的内容，而一些不应该看到的坏人却能看到！
> > > 开发者：/me 拍脑袋

从那里开始只有一步*“我可以拥有它，这样当用户在他们的浏览器中右键单击时，会弹出一个小标志，上面写着**‘这些图像是白痴公司版权所有。’”** ？”*

对不起，今天显然是玩世不恭！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-03T14:40:27.957

两个答案（地理定位、用户代理）都可以，但可能会失败。有人可以使用代理服务器，或更改他们的用户代理。Firefox 甚至为此目的提供了一个插件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-22T13:02:07.653

如果您使用 Ben Dowling 的答案并且代码不起作用，请尝试以下操作：

```
if (!in_array(substr($country, 0, 2), $allowed_countries)) { 
```

代替：

```
if(!in_array($country, $allowed_countries)) { 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T14:57:36.143

还有一个梨包

[http://pear.php.net/package/Net_Geo](http://pear.php.net/package/Net_Geo)

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-10-03T14:23:11.033

有某些类可以检测用户代理的语言环境。尝试类似的东西。Zend 框架为此 Zend_Locale 提供了一个很棒的类

# c++ - 静态数组常量是否会影响共享库布局？

> ID：167109
> 
> 赞同：1
> 
> 时间：2008-10-03T14:22:25.107
> 
> 标签：c++, dll, linker, constants

考虑以下两种 C++ 标头案例：

情况1：

```
class Test {
  public:
    static int TEST_DATA[];
};
int Test::TEST_DATA[] = { 1, 2, 3, 4 }; 
```

案例二：

```
class Test {
  public:
    static int const TEST_DATA[];
};
int const Test::TEST_DATA[] = { 1, 2, 3, 4 }; 
```

后一种情况下的 const 仅用于自我强加的编译时检查，还是会影响 Mac/Linux/Windows 上的共享库布局？

*更新：*根据答案，编译器*可能*会将 const 内容放在只读页面上。*Windows 上的 Visual C++ 或 Mac 或 Linux 上的 GCC是否*实际上将 const 数据放在只读页面上？也许我测试了错误的方式，但在英特尔的 Mac 上，const 版本的元素似乎是可写的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T14:31:08.833

编译器可能会将数据放入二进制文件的不同部分，具体取决于它是否为 const - 这完全由编译器决定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T16:15:42.883

编译器（或者实际上是链接器）可以将第二个放入标记为只读的段中，以在您尝试写入时触发硬件异常。由于写入不打算写入的内容是安全攻击的载体，因此越来越多的系统正在保护其只读数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T15:03:36.803

尽管不能保证，但 const 不太可能在数组的情况下破坏二进制兼容性，因此共享库应该以相同的布局结束。

请注意，对于单个 int，情况可能*并非如此：*

```
struct Test
{
    static int const TEST;
};
int const Test::TEST = 7; 
```

因为 TEST 是一个编译时常量。

# python - 从列表中删除 dict 的子集

> ID：167120
> 
> 赞同：6
> 
> 时间：2008-10-03T14:24:35.383
> 
> 标签：python, list, containers

这真的很容易用一个例子来解释，所以要从 dict 中删除列表的交集，我通常会这样做：

```
a = {1:'', 2:'', 3:'', 4:''}
exclusion = [3, 4, 5]

# have to build up a new list or the iteration breaks
toRemove = []
for var in a.iterkeys():
    if var in exclusion:
        toRemove.append(var)

for var in toRemove:
    del a[var] 
```

这似乎是一个不寻常的例子，但令人惊讶的是我不得不做这样的事情的次数。使用集合执行此操作会更好，但我显然想保留字典的“值”。

这种方法很烦人，因为它需要两个循环和一个额外的数组。有没有一种更清洁、更有效的方法来做到这一点。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-03T14:28:29.043

考虑[dict.pop](http://docs.python.org/library/stdtypes.html#dict.pop)：

```
for key in exclusion:
     a.pop(key, None) 
```

当不是关键时，`None`保持弹出不会引发异常。`key`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T14:34:20.917

```
a = dict((key,value) for (key,value) in a.iteritems() if key not in exclusion) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T14:32:12.547

为什么不直接使用`keys`方法，而不是`iterkeys`? 这样你就可以在一个循环中完成它，因为它返回一个列表，而不是一个迭代器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T15:09:12.143

您可以将排除列表更改为一组，然后只需使用交集来获得重叠。

```
exclusion = set([3, 4, 5])

for key in exclusion.intersection(a):
    del a[key] 
```

# c# - C# - IEnumerable 到分隔字符串

> ID：167129
> 
> 赞同：21
> 
> 时间：2008-10-03T14:26:49.873
> 
> 标签：c#, functional-programming

`IEnumerable<string>`将 a 转换为分隔字符串的函数式编程方法是什么？我知道我可以使用循环，但我正试图围绕函数式编程。

这是我的例子：

```
var selectedValues =
from ListItem item in checkboxList.Items
where item.Selected
select item.Value;

var delimitedString = ?? 
```

.. 或者我可以在第一个 var 分配中执行此操作（将每个结果附加到前一个结果）？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-03T14:29:23.830

```
string.Join(", ", string[] enumerable) 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-10-03T15:02:07.180

这是一个带有`StringBuilder`. 好消息是`Append()`返回`StringBuilder`实例本身。

```
 return list.Aggregate( new StringBuilder(), 
                               ( sb, s ) => 
                               ( sb.Length == 0 ? sb : sb.Append( ',' ) ).Append( s ) ); 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-10-03T14:36:39.010

```
var delimitedString = selectedValues.Aggregate((x,y) => x + ", " + y); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-03T14:29:26.810

```
var delimitedString = string.Join(",", checkboxList.Items.Where(i => i.Selected).Select(i => i.Value).ToArray()); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-03T14:38:46.137

AviewAnew 是最好的答案，但是如果您正在寻找的是学习如何在函数式中思考，您应该做的是使用折叠操作（或在 NET 中调用的聚合）。

```
items.Aggregate((accum, elem) => accum + ", " + elem); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-03T14:36:14.690

好吧，在这种情况下，函数式方法可能不是最适合的，只是因为没有 LINQ“ForEach”，并且您不想使用字符串连接：您想使用 StringBuilder。您可以使用 ToArray （上面刚刚出现了一个示例），但我很想简单地使用：

```
 StringBuilder sb = new StringBuilder();
    foreach(ListViewItem item in checkboxList.SelectedItems) {
        if(sb.Length > 0) sb.Append(',');
        sb.Append(item.Text);
    }
    string s = sb.ToString(); 
```

不是函数式编程，但它可以工作......当然，如果您的源代码*已经*是 string[] 那么 string.Join 是完美的。（LINQ 是一个很棒的工具，但不一定总是适合每项工作的最佳工具）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T14:38:31.393

这是一种 LINQ/功能性的方法。

```
 string[] toDelimit = CallSomeFunction();
return toDelimit.Aggregate((x, y) => x + "," + y); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-05T15:20:08.963

这是 3.5 兼容的：

```
var selectedValues = String.Join(",", (from ListItem item in checkboxList.Items where item.Selected select item.Value).ToArray()); 
```

# java - 如何正确使用 Struts ActionForms、Value Objects 和 Entities？

> ID：167131
> 
> 赞同：3
> 
> 时间：2008-10-03T14:27:07.157
> 
> 标签：java, design-patterns, architecture, oop

我继承了一个使用 Struts、Spring 和 Hibernate 的大型 Java 应用程序。我每天处理的类和接口有：Struts Actions、Struts ActionForms、值对象、服务接口和实现、DAO 接口和实现以及实体。我很清楚其中大多数的方式和原因，除了我不确定 ActionForms、Value Objects 和 Entities 之间的职责是否正确分离。我还应该提到域模型（即所有实体）不包含太多（如果有的话）真实的业务逻辑。这本质上是一个 CRUD 应用程序，大部分真正的逻辑都在数据库中（糟糕！）。无论如何，我想知道几个不同的 Java 相关问题：

1) Entities 和 Value Objects (VOs) 之间似乎没有太大区别，并且当它们以任一方向通过服务层时，必须编写大量代码才能转换为另一个（Struts Actions 只处理VOs、DAOs 只处理实体）。因此，VO 和实体似乎有些多余。为什么两者都有？

2）VO<->实体翻译代码应该去哪里？服务层、实体、VO？

3) VO 被直接放入ActionForms 并直接绑定到JSP 中的标签（例如）。这是一个好习惯吗？如果不是，那么合适的设计是什么？

4) 不清楚如何正确处理值对象中的外键依赖关系。例如，某些 VO 有一个类型字段，在数据库术语中，它表示与类型表的外键关系。在 UI 中，这转换为一个下拉字段，允许用户选择类型，或者一个标签，仅显示类型的文本表示（取决于它是哪个屏幕）。现在，VO 是否应该具有类型 ID 的属性、类型的文本表示，或两者兼而有之？谁负责在两者之间进行翻译，何时翻译？

5) VO 有一个字段作为其数据库 ID。我以为VO没有身份？这是怎么回事？

我希望这些问题足够笼统，足以引起人们的普遍兴趣。在这种类型的架构中，这似乎会一直出现。

另外，我怀疑这个架构对于这个应用来说太重了，如果你有更好的建议，请继续。但我主要对上述问题的答案感兴趣，因为不同的架构是我现在无法进行的长期重构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T20:58:03.513

1.考虑DAO-VO转换；这是否有用取决于如何使用 Hibernate。如果整个 Web 请求处理在单个 Hibernate 会话中，则您实际上不需要单独的 VO。

但是，如果您的 DAO 层打开会话以检索对象并在您完成使用 DAO 之前关闭会话，您可能会遇到集合和对其他对象的引用的问题。那些被延迟加载的可能性很大，这意味着在请求这些属性时仍然必须打开 Session。

简而言之，在您开始放弃这些 VO 之前，请仔细检查您的数据库事务和会话边界。

3.关于在Form中使用VO；如果 VO 很好地映射到 JSP，我会说为什么不呢？我要么对数据模型与它支持的过程如此紧密地匹配印象深刻，要么对数据库尚未标准化（这可能会也可能不会在未来造成问题）有点怀疑。

回到 1。如果您使用带有延迟加载和集合的 DAO，请记住数据库会话还必须包括 JSP 阶段，因为 DAO 将在该阶段被读取。

5.  服务层必须具有知道要更改哪些数据库对象的工具，而 id 就是为此而设计的。服务层必须从数据库中检索 DAO 并将来自 VO 的字段写入 DAO 中，尽管它显然不需要用 VO 的 id 更新 DAO 的 id :)

6.  您从请求中需要的是外键字段的 id。由于它来自客户端，您可能应该在业务逻辑中检查是否存在具有此类 id 的对象。

根据 VO 是接受外来对象的 id 还是需要对象，您应该：

*   设置 id，或
*   使用服务层通过 id 将外来对象作为 VO 并将其放入您的 VO 中，并使用服务层将其存储

您的业​​务层负责翻译，因为服务层只处理对象检索和存储。并且文本或 id 不是对象，而是对象的标识符。服务层可以提供搜索工具，但它不应该需要上下文信息。

如果我正确地阅读了您的问题，您的 VO 通过 id 引用数据库中的其他对象。在这种情况下，您输入 id。如果你从客户端得到一个字符串，你应该在业务层（使用服务层）查找它，并将找到的对象的 id 放在 VO 中。或者，如果没有找到 ID，则返回一个体面的错误消息。

作为结束语；除非您知道自己在做什么，否则不要碰 DAO-VO。Hibernate 是一个强大而复杂的工具，看似简单易用。你很容易犯错误，而且很难找到。客户和老板们似乎都不喜欢在过去可以工作的东西中引入错误。

顺便一提; 我在 DAO-VO 方面的保守主义来自于修复由于 EJB2 到 Hibernate 转换中的类似问题而导致的问题。魔鬼在细节中，改变你处理数据层的方式是一个重大的重构，即使它看起来像小菜一碟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T15:51:27.987

1) 不需要单独的 VO 和实体：一些公司为其项目规定了这样的结构。它可能在不同的项目中有意义，因此它是强制性的（我只能猜测）

2）服务层：与DAO和Action层自然分离，对吧？

3) 只要在发送到 DAO 之前正确地验证了值对象，它就不会受到伤害

4）服务层应该负责两者之间的转换。在加载和节省时间期间

5）如果他们没有身份，那么你将如何防止重复？

我希望这些简洁的答案有所帮助。我会尝试回来并稍后给出更长的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T20:20:39.423

要回答您的最后一部分，请使用 Spring MVC 而不是 Struts。然后你可以在所有层使用相同的域对象——绑定到表单参数的类也在 Hibernate 中使用，并且包含真正的业务逻辑。

例如，在我使用 Spring MVC 做的应用程序中，我有一个成员类。登录、注册、更改密码和编辑个人资料表单都绑定到这个类。该类还有一个休眠映射和一个很好的内部业务逻辑（例如，对于社交网络，一个“添加朋友”方法）。

# asp.net - 每个开发人员都应该知道的 asp.net 框架和库...并使用

> ID：167151
> 
> 赞同：1
> 
> 时间：2008-10-03T14:31:10.253
> 
> 标签：asp.net, frameworks

我还是 ASP.NET 的新手，最近我发现了我开始使用的 SubSonic。现在，当我回顾我在没有 SubSonic 和 jQuery 的情况下进行开发时，这似乎很有趣，而且是在浪费时间（和神经）。并且可能有很多库和框架可以加快开发速度。您使用哪些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T14:35:24.410

目前我喜欢使用的：

*   休眠
*   自动法
*   ASP.NET MVC
*   jQuery

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T14:33:01.013

我是在开始使用[MVC 框架](http://weblogs.asp.net/scottgu/archive/2007/10/14/asp-net-mvc-framework.aspx)后才开始喜欢制作网站的。 如果您还没有这样做，请务必查看[Rob Conery](http://blog.wekeroad.com/blog/)的日志。他是 SubSonic 的父亲，最近开始在 MVC 团队为 MS 工作。

# sql-server - 使用 Microsoft SQLServer 和 Unicode 避免代码更改

> ID：167152
> 
> 赞同：1
> 
> 时间：2008-10-03T14:31:38.553
> 
> 标签：sql-server, unicode, data-migration

如何让 MSSQL 服务器默认接受 Unicode 数据到 VARCHAR 或 NVARCHAR 列？

我知道你可以通过在要放置在字段中的字符串前面放置一个 N 来做到这一点，但老实说，这在 2008 年似乎有点过时，尤其是使用 SQL Server 2005。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T14:59:13.397

`N`语法是在 SQL Server 中指定 unicode 字符串文字的方式。

```
N'Unicode string'
'ANSI string' 
```

SQL Server 将尽可能在两者之间自动转换，使用列的排序规则或数据库的排序规则。

因此，如果您的字符串文字实际上不包含 unicode 字符，则无需指定`N`前缀。

但是，如果您的字符串文字**确实**包含 unicode 字符，那么使用`N`前缀是必要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T14:45:45.310

如果这是一个 Web 应用程序，您可能会让您的 Web 服务器使用 UTF8 作为默认编码。这样，所有往返于浏览器的数据都是 UTF8，可以插入到 VARCHAR 字段中。UTF8 是让不知道 Unicode 的应用程序处理它的好方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-04T23:01:53.337

他们真的需要一种方法来关闭对 ​​N'' 前缀的需求。“向后兼容需要它”参数对我来说是零意义 - 当然，将这种行为作为旧应用程序的默认行为，但为我提供默认打开 Unicode 字符串的选项（即，不需要 N'' 前缀。）我发现我需要去弄乱我的应用程序的大部分区域以适应 SQL Server 上的 Unicode，而这在 Oracle 和 Postgresql 中不是问题。来吧，微软！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-23T21:10:08.430

虽然您可以简单地将 UTF8 内容存储在 MSSQL Server 的 VARCHAR 字段中，但前提是未完成字符集转换，但您应该注意：

1.  您的应用程序之外的任何管理/报告/数据工具都无法理解您的非英语字符。

2.  特定于语言的处理（例如对名称列表进行排序）可能不会按照每种语言可接受的顺序进行。

3.  必须小心数据截断。截断多字节 UTF8 字符通常会导致相关字符的数据损坏。如果输入超过字段长度，您应该始终拒绝输入。

4.  禁用字符集转换可能不像您想象的那么容易。即使您在客户端驱动程序中将其关闭，如果客户端和使用的 RDBMS 代码页之间存在显着的区域设置差异，它仍然可以在某些情况下被覆盖，这会立即导致数据损坏。

5.  如果您认为这就是全部，您将不得不担心自己自欺欺人。

总而言之，虽然您可能很想走这条路，但它不是一个好主意。多字节时需要更改代码。

# database - 逻辑：数据库或应用程序/2（约束检查）

> ID：167154
> 
> 赞同：9
> 
> 时间：2008-10-03T14:31:45.870
> 
> 标签：database, business-logic-layer

这是[此问题](https://stackoverflow.com/questions/119540/business-logic-database-or-application-layer)的特定版本。
我想检查我是否插入了重复的行。我应该在我的应用程序层中以编程方式检查它：

```
if (exists(obj))
{
    throw new DuplicateObjectException();
}
HibernateSessionFactory.getSession().save(obj); 
```

或者我应该捕获数据库层抛出的异常并在我违反约束时触发？

```
try
{
    HibernateSessionFactory.getSession().save(obj);
}
catch(ConstraintViolationException e)
{
    throw new DuplicateObjectException();
} 
```

**编辑：**换句话说：虽然约束仍然存在（无论如何它是很好的数据库设计，我不能确定我的应用程序将是唯一访问表的应用程序）我是否应该依赖约束并处理异常它的违规会加注，还是我还是过牌？

**EDIT2：**当然我在事务中进行检查+插入，锁定表以确保同时没有其他进程正在写入另一条记录

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-03T14:44:03.380

首先，您**必须**在数据库上有一个主键或唯一约束，才能正确地强制执行这种唯一性——毫无疑问。

鉴于存在约束，您应该以哪种方式在应用程序中编码？我的偏好是尝试插入并捕获异常。因为可能大多数插入都会成功，只有少数会因为重复而失败（这就是“异常”的含义！）：在每次插入之前执行存在检查是低效的，因为无论如何数据库都将执行自己的约束检查。

此外，理论上存在检查可能是错误的 - 如果其他人设法在您的存在检查和插入之间的小间隔内提交具有相同键值的记录。然后，如果您不捕获数据库异常，您将相信插入成功，而实际上它没有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T14:37:45.280

您需要捕获数据库异常，除非您可以保证您的应用程序是唯一向数据库插入行（并且永远将插入行）的应用程序。

**编辑：**我可能误解了这个问题，但我仍然认为选项 B（HibernateSessionFactory 从数据库中抛出 ConstraintException）是更好的选择。在您的检查和实际函数调用之间的一小段时间内，另一个应用程序总是有很小的机会插入一些东西。此外，检查欺骗的唯一方法是执行额外的查询，这只是对性能的不必要消耗。

我对这个问题的最初理解是，在选项 A 中，重复检查将在内部执行（即仅使用程序已经创建的数据结构，并且在插入之前没有查询）。我最初的答案是对这种方法的回应。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T16:13:25.710

您检查该对象是否仅存在于应用程序代码中，然后一旦确定它不存在，就愉快地保存该对象。但是另一个并发客户端可能会在您的两行代码之间插入他们自己的对象。所以无论如何你都会得到一个重复的异常，只是这次你没有捕捉到它。

您必须执行 save() 并捕获异常。否则，您将与其他在同一数据库上工作的并发客户端发生争用情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T14:36:25.220

一般来说，我会尽量避免依赖于抛出错误的编码，因为我做错了。但有时，这就是你所能做的。在你的情况下，我认为你应该先检查。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T14:56:14.960

如果由于某种原因（通常是 DBA 忽略重新启用它的维护工作）删除了约束，这将中断（允许重复条目）。您应该在应用程序中检查这种情况。

但是，让数据库强制执行约束是一种很好的数据库设计（正如您非常正确地指出的那样），因为其他人也可能正在使用该数据库。作为概括，最好假设应用程序和数据库存在 M:M 关系——几乎所有时间都是这种情况。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T15:09:10.990

Hibernate（或任何 ORM 组件）抛出的异常往往难以解释。

如果异常有足够的信息，您可以生成一条真正帮助用户的错误消息，那么只需捕获异常，分析它，然后继续。

如果异常没有足够的信息，那么您必须检查错误情况，并向用户提供有用的错误消息，说明他们做错了什么。

问题是“例外有多不透明”之一？有些非常不透明。其他人有足够的能力来解析消息字符串并弄清楚要对用户说什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T15:11:02.327

一旦休眠从会话中抛出异常，您[必须丢弃会话](http://www.hibernate.org/hib_docs/reference/en/html/transactions-demarcation.html)（参见第 11.2.3 节）。因此，如果您需要检查重复数据并继续使用同一会话，那么您别无选择，只能先在应用程序中检查。

此外，第一个片段中的代码可能会导致另一个进程插入一条记录，这会导致在您检查重复记录的时间和实际插入它的时间之间引发重复异常。

# macos - 如何将文件从一个代码项目复制到另一个

> ID：167159
> 
> 赞同：0
> 
> 时间：2008-10-03T14:32:45.507
> 
> 标签：macos, unix

我签出了一个项目的多个分支，每个分支都在自己的目录下（非常标准）。

src/branch1/some/code/directories src/branch2/some/code/directories

我经常发现自己想将选定的文件从一个分支复制到另一个分支。一个例子是复制 cvsignore 文件或 intellij 模块文件。我正在尝试做的伪命令是“将匹配模式的branch1下的所有文件复制到branch2，保留复制文件的相对路径”。

[这个问题](https://stackoverflow.com/questions/96264/batch-file-to-copy-files-from-one-directory-to-another)看起来很接近我正在寻找的内容，但我需要一个 OS X/linux/unix 解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T14:51:05.563

在 branch1 目录中使用像这样的“cp -r --parents”命令

```
find . -name ".cvsignore" -exec cp -r --parents {} ../branch2/ \; 
```

或者

在 src/ 目录中时，运行此脚本。如果需要，您可以从命令行参数中获取变量。

```
SOURCE="branch1/"
TARGET="branch2/"
PATTERN=".cvsignore"

find $SOURCE -name $PATTERN | while read f ;
do
        FILEPATH=$(dirname $f | cut -d'/' -f2-)
        FILENAME=$(basename $f)
        DESTPATH=$TARGET/$FILEPATH;
        if [ ! -d $DESTPATH ]
                then mkdir -p $DESTPATH
        fi
        cp $f $DESTPATH
done 
```

# c++ - 哪些 C/C++ 函数最常被错误使用并可能导致缓冲区溢出？

> ID：167165
> 
> 赞同：17
> 
> 时间：2008-10-03T14:33:56.957
> 
> 标签：c++, c, buffer-overflow, buffer-overrun

我被要求维护一个充满内存泄漏的大型 C++ 代码库。在四处寻找时，我发现我们有很多导致泄漏的缓冲区溢出（它是如何变得如此糟糕，我不想知道）。

我决定先删除缓冲区溢出，从危险函数开始。哪些 C/C++ 函数最常被错误使用并可能导致缓冲区溢出？

对于用于帮助查找缓冲区溢出的编译器和/或工具，我[创建了另一个处理此问题的问题](https://stackoverflow.com/questions/167199/what-cc-tools-can-check-for-buffer-overflows)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-03T14:37:06.293

通常，任何不检查参数边界的函数。一个列表将是

*   获取（）
*   扫描函数（）
*   strcpy()
*   strcat()

您应该使用大小有限的版本，如 stncpy、strncat、fgets 等。然后在给出大小限制时要小心；考虑到 '\0' 终止字符串。

此外，数组未在 C 或 C++ 中进行绑定检查。以下示例将导致错误。[一错](http://en.wikipedia.org/wiki/Off-by-one_error)就走

```
int foo[3];
foo[3] = WALKED_OFF_END_OF_ARRAY; 
```

**编辑**：@MrValdez、@Denton Gentry 的复制答案

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T15:11:03.030

Valgrind 是你最好的新朋友。

valgrind --tool=memcheck --leak-check=full ./a.out

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T15:08:02.473

恐怕问题是从错误的结尾开始的。假设缓冲区溢出发生在其他函数中。根据我的经验，最常见的原因是 operator++，或者缺少 operator!=。

找到其中一批的最佳解决方案是 Visual Studio 2005/8 中的 /GS。它不会找到所有这些，但它是一种减少所需手动工作量的廉价方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T14:34:17.377

以下是我发现的一些危险功能：

*   gets() - 它不检查变量的长度，如果输入大于变量的缓冲区，它可以覆盖内存。
*   scanf() - 我很高兴 Visual Studio 告诉我这个函数已被弃用。这是一个简单的解决方法。
*   strcpy() - 如果源的内存空间大于目标的内存空间，则覆盖目标之后的数据。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T14:36:07.933

以下链接应让您全面了解 C++ 中的安全功能（后置“_s”以解决溢出等问题的安全功能）：http: [//msdn.microsoft.com/en-us/library/8ef0s5kh( VS.80).aspx](http://msdn.microsoft.com/en-us/library/8ef0s5kh(VS.80).aspx)

**编辑：**此链接包含已被替换的特定功能：http: [//msdn.microsoft.com/en-us/library/wd3wzwts (VS.80).aspx](http://msdn.microsoft.com/en-us/library/wd3wzwts(VS.80).aspx)

**编辑：**我应该提到这些是 Microsoft 方法，但该链接对于识别被视为危险信号的功能仍然很有用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-03T14:36:43.487

不幸的是，任何数组都可能导致缓冲区溢出：

```
uint32_t foo[3];
foo[3] = WALKED_OFF_END_OF_ARRAY; 
```

就功能而言， sprintf 将愉快地离开缓冲区的末端。可以用 snprintf 代替。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-03T14:39:33.950

Memcpy() 是另一个危险的。

任何访问数组的循环都是一个危险点，因为超出数组末尾没有停止。

内存泄漏是由分配内存而不是释放它引起的。构造函数和析构函数应该是另一个重要的审查点，后者确保释放任何分配的内存。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-03T14:43:24.723

您使用的是哪个版本的视觉工作室？在 2008 年启用所有警告的情况下，您提到的所有功能（以及更多）都会警告您它们已被弃用。

也许您可以检查所有警告是否已打开并让编译器为您完成繁重的工作？

附带说明一下，出色的[编写安全代码](http://www.amazon.co.uk/Writing-Secure-Second-Michael-LeBlanc/dp/0735617228/ref=sr_1_1?ie=UTF8&s=books&qid=1223044585&sr=8-1)很好地解释了一些旧功能的不同缺陷。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-03T14:43:28.623

在我工作的代码库上，我遇到了同样的问题。我的建议：警惕任何看起来像 str*() 和 mem*() 的 C 函数。还要警惕任何带有指向缓冲区的指针的东西，没有长度。因为看起来你有机会使用 C++，所以在最糟糕的情况下，我会尝试使用 C++ 容器来做一些事情：向量、字符串、地图等。这些让你的生活变得更轻松。

此外，自动化问题检测工具也很棒。如果你可以使用 valgrind，我会推荐它。此外，Rational Purify 非常强大，虽然并不便宜。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-08T00:11:36.113

C 中的另一个问题是“strncpy()”函数。许多人没有意识到返回一个非空终止的字符串是免费的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-03T14:38:40.207

基本上，任何接受指针并写入它的东西，而不检查长度。所以像 strcpy()、sprintf() 等。

# database - JPA 和 2 个简单的表格

> ID：167193
> 
> 赞同：2
> 
> 时间：2008-10-03T14:39:10.457
> 
> 标签：database, jpa

我有 2 张桌子：

```
A
s_id(key) name cli type

B
sa_id(key) s_id user pwd 
```

所以在 Jpa 我有：

```
@Entity
class A...{
   @OneToMany(fetch=FetchType.EAGER)
    @JoinTable( name="A_B", 
    joinColumns={@JoinColumn(name="a_id", table="a",unique=false)}, 
    inverseJoinColumns={@JoinColumn(name="b_id", table="b", unique=true)} )
   Collection<B> getB(){...}
} 
```

b 类只是一个基本实体类，没有引用 A。

希望这很清楚。我的问题是：我真的需要一个连接表来做这样一个简单的连接吗？这不能用一个简单的joincolumn之类的东西来完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T14:43:09.403

不，您不需要 OneToMany 的连接表。查看@mappedBy 注释

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T14:21:06.727

为此，您不需要 JoinTable。如果 B 类没有引用 A 类，那么以下内容就足够了

```
@Entity class A...{ 
@OneToMany(fetch=FetchType.EAGER)     
Collection getB(){...} } 
```

在大多数情况下，您可能需要双向关系，在这种情况下 B 引用 A。在这种情况下，您需要查找 @mappedBy 注释。保罗提到的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T14:44:38.947

快速回答是，如果您有一个多对多关系，您将需要另一个表。如果您有一对多或多对一的关系，则不会。

# c++ - 哪些 C/C++ 工具可以检查缓冲区溢出？

> ID：167199
> 
> 赞同：23
> 
> 时间：2008-10-03T14:40:07.943
> 
> 标签：c++, c, buffer-overflow, buffer-overrun

我被要求维护一个充满内存泄漏的大型 C++ 代码库。在四处寻找时，我发现我们有很多导致泄漏的缓冲区溢出（它是如何变得如此糟糕，我不想知道）。

我决定先删除缓冲区溢出。为了让我更容易寻找错误，可以使用哪些工具来检查缓冲区溢出？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-03T14:42:24.507

在 Linux 上，我会使用 Valgrind。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-03T14:54:50.953

考虑使用更现代的数据结构来避免缓冲区溢出。读入 std::string 不会溢出，而且 std::vectors 比数组安全得多。我不知道您的应用程序是什么，并且可能会使用原始缓冲区，因为您需要速度，但更常见的是使用它们，因为原始程序员对此感到满意。

使用提到的工具搜索内存泄漏是个好主意，但它们可能无法找到所有潜在的泄漏，而使用标准字符串和容器类可以消除您没有意识到的问题。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-03T14:44:31.427

IBM 的 Purify 将执行此操作，您在其下运行您的应用程序，它将为您提供所有错误（包括其他错误）的报告。

要消除内存泄漏，请使用 UMDH - 运行您的应用程序，拍摄内存快照，再次运行它，进行快照，然后使用差异工具查看自第一次运行以来所做的分配（请注意，您必须运行您的应用程序一次，并且尽可能拍摄快照）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-03T14:44:58.103

检查[电子围栏](http://freshmeat.net/projects/efence/)，它是专为缓冲区溢出而设计的！它不会减慢代码本身的速度（但会减慢分配/解除分配的速度）。它适用于linux和windows。

它通过在每个分配的空间之前和之后添加一个没有读写访问权限的段来工作。在 UNIX 上尝试访问此内存最终会导致分段错误，而在 Windows 上会导致内存冲突（或类似情况）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-03T14:43:46.063

/GS 的问题是它实际上不会扫描错误。它只会在事后提醒你。似乎您正在寻找一种工具来扫描您现有的代码以查找潜在的缓冲区过度/不足运行。

Microsoft PreFAST 工具是解决此问题和其他缺陷的好工具。

[信息在这里](http://msdn.microsoft.com/en-us/library/ms933794.aspx)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-03T14:48:20.953

多发性硬化症：

*   UMDH.exe 工具： http: [//support.microsoft.com/kb/268343](http://support.microsoft.com/kb/268343)
*   /analyze 编译器选项（来自最新的 Microsoft SDK）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-07-19T01:58:28.320

我很惊讶在 Windows 上没有人提到[Application Verifier（免费！） 。](http://msdn.microsoft.com/en-us/library/ms220948.aspx)Visual Leak Detector（在另一个答案中提到）对于跟踪多种类型的内存泄漏绝对是惊人的，但 Application Verifier 是跟踪内存错误（如缓冲区溢出、双重释放和释放后缓冲区使用）的首选工具（还有很多很多）。

编辑：而且它非常非常容易使用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-03T14:45:32.563

我投票给 Rational Purify。功能强大，价格相称。做很多问题的短工作，并且可以真正为自己付出代价。此外，在大多数 *nix 上都可用。不过，不确定Windows。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-03T15:15:33.190

[Compuware 的 Devpartner](http://www.compuware.com/solutions/default.htm)的 BoundsChecker 组件在动态执行方面做得很好。对于静态测试，我建议将[pc-lint 和 flex-lint](http://www.gimpel.com/)与[Riverblade 的可视化 lint](http://www.riverblade.co.uk/)结合使用，以提高可用性和报告功能。如果你得到了一个新的代码库，我建议你从静态分析开始，规则相当宽松，这样你就可以抓住那些讨厌的东西。随着代码库的改进，您可以收紧规则集。

如果您需要在 Windows Mobile / Windows CE 上执行此操作，请查看[Entrek 的代码告密者](http://www.entrek.com/)

另一个需要考虑代码是否进入现场的工具是[AQtrace](http://www.automatedqa.com/products/aqtrace/index.asp)，它主要分析用户机器上的崩溃并向您发送详细信息。（以防万一所有的边界检查、净化、棉绒、valgrinding 等.. 遗漏了一些东西）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-02-26T03:40:33.233

我的公司[Semantic Designs](http://www.semanticdesigns.com)正在寻找用于检测所有类型的内存访问违规的运行时[内存安全检查器](http://www.semanticdesigns.com/Products/MemorySafety)（包括缓冲区溢出）的 beta 测试人员，即使是 valgrind 和 Purify 无法检测到的那些。目前这仅适用于 Windows C 程序，不适用于 C++ 或其他操作系统。

编辑 2011 年 6 月 1 日：CheckPointer 工具已投入生产。仍然只有 C/Windows。处理多种 C 方言：MS Visual C、GCC 3/4。

编辑 2012 年 5 月 5 日：CheckPointer 现在处理 C99，包括检查对标准 C 和 C99 库的调用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-03T14:40:14.823

Visual Studio 有一个 /GS 编译器标志，可添加缓冲区溢出保护。还有其他人吗？

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-03T14:43:32.087

您可以尝试[Visual Leak Detector](http://dmoulding.googlepages.com/vld) - 我自己使用它，这是我推荐用于内存泄漏检测的第一件事。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-03T14:47:30.610

我推荐 Jochen Kalmbach 的 CodeProject 上的免费“泄漏查找器”工具。[有关此内存泄漏问题](https://stackoverflow.com/questions/45627/how-do-you-detectavoid-memory-leaks-in-your-unmanaged-code#45717)的此线程（和其他答案）的更多详细信息，请参阅我的帖子

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-03T15:07:26.513

在 Windows 上进行内存泄漏/缓冲区溢出和其他运行时错误检测，您可以使用：

*   Compuware 的边界检查器 ( [http://www.compuware.com/products/devpartner/visualc.htm](http://www.compuware.com/products/devpartner/visualc.htm) )
*   IBM Rational Purify

如果您有需要清理的大型项目，我认为它们物有所值。

# php - 用于读取种子文件的 PHP 模块

> ID：167206
> 
> 赞同：17
> 
> 时间：2008-10-03T14:41:49.157
> 
> 标签：php, bittorrent

是否有一个 PHP 模块可用于以编程方式读取 torrent 以查找有关它的信息，例如 Seeders？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-02T09:37:28.430

我曾经在自己做的一个小网站中使用过这些功能。我想我用一个叫做 OpenTracker 的 php bittorrent 跟踪器或其他东西找到了它们，但找不到该网站......

但是，您不会在 torrent 文件中找到播种机。种子文件只包含有关文件、哈希码和长度等的信息。我相信还有一些跟踪器信息。您必须从跟踪器中获得多少播种机等。[您可以在BitTorrent.org](http://BitTorrent.org)阅读有关该协议的信息。我相信通信是经过编码的，因此您也可以使用这些功能。这意味着你只需要弄清楚要发送什么来获得你想要的东西。

**注意：**这三个函数不是我写的。就像我说的，我在一个开源种子跟踪器的源代码中找到了它们。这些函数没有注释，但是函数名称和一个在 torrent 文件结果中的 print_r 你知道的信息应该足以理解如何使用它们。我在底部添加了一些示例代码来展示我是如何使用它们的。他们工作了。

```
function bdecode($str) {
    $pos = 0;
    return bdecode_r($str, $pos);
}

function bdecode_r($str, &$pos) {
    $strlen = strlen($str);
    if (($pos < 0) || ($pos >= $strlen)) {
            return null;
    }
    else if ($str{$pos} == 'i') {
            $pos++;
            $numlen = strspn($str, '-0123456789', $pos);
            $spos = $pos;
            $pos += $numlen;
            if (($pos >= $strlen) || ($str{$pos} != 'e')) {
                    return null;
            }
            else {
                    $pos++;
                    return intval(substr($str, $spos, $numlen));
            }
    }
    else if ($str{$pos} == 'd') {
            $pos++;
            $ret = array();
            while ($pos < $strlen) {
                    if ($str{$pos} == 'e') {
                            $pos++;
                            return $ret;
                    }
                    else {
                            $key = bdecode_r($str, $pos);
                            if ($key == null) {
                                    return null;
                            }
                            else {
                                    $val = bdecode_r($str, $pos);
                                    if ($val == null) {
                                            return null;
                                    }
                                    else if (!is_array($key)) {
                                            $ret[$key] = $val;
                                    }
                            }
                    }
            }
            return null;
    }
    else if ($str{$pos} == 'l') {
            $pos++;
            $ret = array();
            while ($pos < $strlen) {
                    if ($str{$pos} == 'e') {
                            $pos++;
                            return $ret;
                    }
                    else {
                            $val = bdecode_r($str, $pos);
                            if ($val == null) {
                                    return null;
                            }
                            else {
                                    $ret[] = $val;
                            }
                    }
            }
            return null;
    }
    else {
            $numlen = strspn($str, '0123456789', $pos);
            $spos = $pos;
            $pos += $numlen;
            if (($pos >= $strlen) || ($str{$pos} != ':')) {
                    return null;
            }
            else {
                    $vallen = intval(substr($str, $spos, $numlen));
                    $pos++;
                    $val = substr($str, $pos, $vallen);
                    if (strlen($val) != $vallen) {
                            return null;
                    }
                    else {
                            $pos += $vallen;
                            return $val;
                    }
            }
    }
}

function bencode($var) {
    if (is_int($var)) {
            return 'i' . $var . 'e';
    }
    else if (is_array($var)) {
            if (count($var) == 0) {
                    return 'de';
            }
            else {
                    $assoc = false;
                    foreach ($var as $key => $val) {
                            if (!is_int($key)) {
                                    $assoc = true;
                                    break;
                            }
                    }
                    if ($assoc) {
                            ksort($var, SORT_REGULAR);
                            $ret = 'd';
                            foreach ($var as $key => $val) {
                                    $ret .= bencode($key) . bencode($val);
                            }
                            return $ret . 'e';
                    }
                    else {
                            $ret = 'l';
                            foreach ($var as $val) {
                                    $ret .= bencode($val);
                            }
                            return $ret . 'e';
                    }
            }
    }
    else {
            return strlen($var) . ':' . $var;
    }
} 
```

* * *

一些示例用法：

```
# Read a file
$content = file_get_contents("file.torrent");
$content_d = bdecode($content);

# Check if bdecode succeeded
if(empty($content_d)) exit('Something is wrong with the torrent. BDecode failed.');

# Calculate info_hash
$info_hash = sha1(bencode($content_d['info']), true);

# Calculate length
$length = 0;
function add_length($value, $key)
{
    global $length;
    if($key == 'length') $length += $value;
}
array_walk_recursive($content_d, 'add_length'); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-03T14:51:53.347

Google在 sourceforge上提供了这个[PHP 客户端，在 PHP 类上提供了](http://sourceforge.net/projects/torrentflux/)[这个 torrent](http://www.phpclasses.org/browse/package/3138.html)类。应该是你所需要的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-02T09:11:18.213

Torrent 文件基本上是用[BEncode](http://en.wikipedia.org/wiki/Bencode)编码的嵌套字典。BEncode 是一种简单的编码，有几个 BDecode PHP 类，比如[这个](http://www.phpclasses.org/browse/package/3473.html)。

torrent 文件的结构在[BEP0003](http://bittorrent.org/beps/bep_0003.html#metainfo-files-are-bencoded-dictionaries-with-the-following-keys)中描述。

请注意，种子文件不包含您提到的“播种者”字段。播种者列表是动态的，由跟踪服务器管理。拥有 torrent`hash_info`和`tracker_url`（都可以从 torrent 文件中获得）您可以将抓取请求发送到跟踪器，它将在“完整”字段中返回播种机的数量，请参阅[Tracker Scrape Convention](http://wiki.theory.org/BitTorrentSpecification#Tracker_.27scrape.27_Convention)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-02-26T22:20:31.230

这个库包含一个很好的子库：http: [//www.binpress.com/app/phptracker/177](http://www.binpress.com/app/phptracker/177)

# ruby-on-rails - RSpec 故事和规格：何时使用什么？

> ID：167210
> 
> 赞同：13
> 
> 时间：2008-10-03T14:42:29.343
> 
> 标签：ruby-on-rails, ruby, rspec, bdd, rspec-stories

所以我想开始使用 RSpec 故事，但我不确定在哪里编写控制器、模型和视图规范。

例如，您有“登录”和“用户提供错误密码”场景的故事，您最终不会测试与控制器/模型规范相同的东西（response.should render...，user.should be_nil 等.)

所以我的问题是：对于那些习惯用 RoR 做 bdd（或故事 dd）的人，你还写模型/控制器规范吗？如果是这样，您遵循的工作流程如何（“第一个故事，然后缩小到特定规格”）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-05T11:27:23.883

如果您现在从故事开始（而不是有很多遗留故事），您可能想看看[Cucumber](http://github.com/aslakhellesoy/cucumber/wikis/migration-from-rspec-stories)，它是 RSpec 故事运行器的长期替代品。

在规范和故事之间进行拆分的最简单方法是使用故事进行业务需求的全栈测试，并使用规范对组件（视图、帮助程序、控制器和模型）的隔离低级规范进行测试。“全栈”的范围可以从控制器/模型/数据库到使用 Webrat 的客户端模拟，再到使用 Watir 或 Selenium 进行的浏览器内测试。

BDD 的最终“外在”做事方式是从基于客户需求的故事开始，然后为您在实施故事时发现需要的组件添加规范。理想情况下，您将使用规范完全覆盖各个组件，并为用户最重要的工作流程提供故事，以便您可以在最高级别检查您的应用程序是否提供了您所要求的功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-05T11:33:20.160

我发现故事在测试用户实际执行或观察到的行为时很有用 - 因此，与其测试“登录失败”模板是否呈现，不如测试响应是否包含“登录失败”。恕我直言，如果故事从不直接引用模型、视图或控制器会更好，尽管有时如果不手动创建模型实例就很难让这些步骤正常工作。

在我看来，视图、控制器和模型规格只是图片的一部分。他们讲实现的语言（“控制器操作 X 应该对模型 Z 做 Y”），并测试你的应用程序的各个部分是否都做正确的事情。故事通过说出用户的语言（“当我发表评论时，我应该看到我发表的评论”）并测试部件以符合客户接受标准的方式组合在一起来完成图片。

我发现一个有用的工作流程是：

*   写一个故事场景来描述我需要添加的功能。
*   尽快为该故事编写步骤，以便您可以运行它（即使所有步骤都失败了）。
*   为那个故事需要的东西写一个规范（模型可能是一个很好的起点）。
*   编写代码以使该规范通过。
*   编写更多规范和代码，直到故事结束。

这样，故事就可以指导您了解您的规格需要测试的内容。

**编辑**：[这](http://www.joesniff.co.uk/ruby/telling-a-good-story-rspec-stories-from-the-trenches.html)是一篇很好的文章，涉及故事和规格之间的关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-19T02:26:18.107

Pat Maddox（RSpec 核心团队）认为，在某些假设下，您可以在使用 Cucumber 故事/功能时跳过控制器规范

[在这里](http://www.nabble.com/Re%3A-Working-outside-in-with-Cucumber-and-RSpec-p20168163.html)阅读他的观点

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-18T13:00:34.450

如果你有 Cucumber+Capybara，那么跳过视图规范怎么样。我倾向于找到不需要的视图规范。

# flash - 如何在 ActionScript 3.0 中获取数字的符号？

> ID：167224
> 
> 赞同：4
> 
> 时间：2008-10-03T14:44:54.970
> 
> 标签：flash, actionscript-3

我有一个数字类型的变量，我喜欢获得符号（如果是'-'我喜欢有-1，如果'+'我喜欢有1）。所以，我做了这个：

```
var sign = Math.abs(n) / n; 
```

但是，还有别的办法吗？比这个好吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-03T14:51:52.223

如果 n == 0，你会遇到麻烦......这个怎么样：

```
var sign = n < 0 ? -1 : 1; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-03T14:54:28.210

如果 n 为零，这会给你一个错误。

蛮力法：

```
function sign(num) {
  if(num > 0) {
    return 1;
  } else if(num < 0) {
    return -1;
  } else {
    return 0;
  }
} 
```

或者，对于那些喜欢条件运算符的人：

```
function sign(num) {
  return (num > 0) ? 1 : ((num < 0) ? -1 : 0);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T14:52:07.653

你也可以这样做：

```
var sign = (n>=0)?1:-1; 
```

使用所谓的[三元运算符](http://en.wikipedia.org/wiki/%3F:)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T10:20:15.150

我用这个：

```
return (number < 0 && -1) || 1; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T18:14:48.800

如果您的号码适合 31 位，那么您可以使用：

```
var sign = 1 + 2*(n >> 31); 
```

知道这是否更快会很有趣！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T18:21:12.527

我继承的代码片段：

```
function getSign(number:int):int {
    var tmp:String = new String(number);
    if (tmp.indexOf(0) == '-') {
        return -1;
    }
    return 1;
} 
```

PS：请不要使用此代码。这是个笑话

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-06T00:22:56.513

//n = 你的号码 //nSign = 你的号码的符号

nSign = Math.round(Math.sin(n)*-1);

/* Math.sin 返回一个介于 -1 和 1 之间的数字。您必须将其四舍五入以获得非 DEC 数字。该数字将与您的数字相反。乘以 -1 */

// 或者你可以这样做

Math.round(Math.sin(/ *n* /)*-1)

# c# - 通过 Web 部署项目更改应用程序池

> ID：167232
> 
> 赞同：11
> 
> 时间：2008-10-03T14:45:45.467
> 
> 标签：c#, deployment, windows-installer, asp.net-2.0

有没有办法配置 Visual Studio 2005 Web 部署项目以将应用程序安装到命名的应用程序池而不是给定网站的默认应用程序池中？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-03T18:58:06.363

这里有一篇描述自定义操作的好文章： [ScottGu's Blog](http://weblogs.asp.net/scottgu/archive/2007/06/15/tip-trick-creating-packaged-asp-net-setup-programs-with-vs-2005.aspx)

你问的问题在'Ryan'的评论中得到了回答，不幸的是它在VB中，但翻译起来应该不难：

```
Private Sub assignApplicationPool(ByVal WebSite As String, ByVal Vdir As String, ByVal appPool As String)
   Try
     Dim IISVdir As New DirectoryEntry(String.Format("IIS://{0}/W3SVC/1/Root/{1}", WebSite, Vdir))
     IISVdir.Properties.Item("AppPoolId").Item(0) = appPool
     IISVdir.CommitChanges()
   Catch ex As Exception
     Throw ex
   End Try
 End Sub

 Private strServer As String = "localhost"
 Private strRootSubPath As String = "/W3SVC/1/Root"
 Private strSchema As String = "IIsWebVirtualDir"
 Public Overrides Sub Install(ByVal stateSaver As IDictionary)
   MyBase.Install(stateSaver)
   Try
     Dim webAppName As String = MyBase.Context.Parameters.Item("TARGETVDIR").ToString
     Dim vdirName As String = MyBase.Context.Parameters.Item("COMMONVDIR").ToString
     Me.assignApplicationPool(Me.strServer, MyBase.Context.Parameters.Item("TARGETVDIR").ToString, MyBase.Context.Parameters.Item("APPPOOL").ToString)
   Catch ex As Exception
     Throw ex
   End Try
 End Sub 
```

...其中 APPPOOL 作为自定义操作中的参数提供。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T19:02:33.980

您可以在部署期间使用 CustomAction 来修改 IIS，这里有一篇文章如何做到这一点： [使用自定义操作在部署期间修改 Internet 信息服务](http://msdn.microsoft.com/en-us/library/aa289522.aspx)

文章中的示例是在 VB.Net 中，并没有明确显示如何更改应用程序池，但应该很容易弄清楚。

# rsync - rsync 忽略 --SUFFIX 选项

> ID：167233
> 
> 赞同：1
> 
> 时间：2008-10-03T14:45:48.820
> 
> 标签：rsync

```
rsync -auve ssh --backup --suffix='2008-10-03-1514539' --backup-dir='/tmp/' module.pm root@web1:/path/to/module.pm 
```

我在没有 --backup-dir 选项的情况下运行此命令，当它复制文件时，它会创建一个带有当前时间戳的备份。当我包含 --backup-dir 选项时，它将备份到 /tmp/ 目录但从不附加我的后缀。

[手册](http://samba.anu.edu.au/ftp/rsync/rsync.html)中没有任何内容建议您不能同时使用这两个选项。我也玩过这个命令，似乎没有什么能解决它。

有人对此有解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T14:49:47.703

手册说：

> --backup 进行备份（参见 --suffix & --backup-dir）
> 
> --backup-dir=DIR 根据 DIR 进行层次结构备份
> 
> --suffix=SUFFIX 备份后缀（默认 ~ w/o --backup-dir）

所以看起来你可以使用一个或另一个，而不是两者（我猜你想要一种方法来确定你使用后缀或目录的备份）。

作为解决此问题的一种方法，为什么不保留后缀并修改目标以包含备份目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-06T17:08:44.870

你也可以使用这样的东西

```
# Backup
mkdir -p /tmp/`date +\%Y-\%m-\%d`-`date +\%A`/
rsync -avz /tmp/`date --date=yesterday +\%Y-\%m-\%d`-`date --date=yesterday +\%A`/ /tmp/`date +\%Y-\%m-\%d`-`date +\%A`/
rsync -avz -e ssh root@web1:/path/to/module.pm /tmp/`date +\%Y-\%m-\%d`-`date +\%A`/ 
```

# perl - 判断你的 perl 是否在 -e 上运行的最好方法是什么？

> ID：167238
> 
> 赞同：13
> 
> 时间：2008-10-03T14:47:33.950
> 
> 标签：perl

问题不在于如何在单行中分辨。如果您正在单行编写代码，*那么您知道*自己是。但是，包含在内的一个模块如何`-MMy::Module::Name`知道这一切都是从一个单行器开始的。

这是我的。虽然它是不可移植的，并且依赖于 UNIX 标准命令（尽管它可以或多或少地移植。）

```
my $process_info = `ps $$ | tail -1`;
my $is_oneliner  
    = $process_info =~ m/perl.*?\s+-[^\P{IsLower}e]*e[^\P{IsLower}e]*\s+/m
    ; 
```

如果你有一个更时髦的正则表达式，请随时改进我的。

* * *

有几个人问我为什么要这样做。brian 正确地猜到了我想根据它是脚本来更改导出行为，我们可以假设它已经进行了一些设计，或者它是否是用户试图在单个命令行中尽可能多地执行操作的单行器。

这听起来很糟糕，因为出口商应该尊重其他包的信条——有时被称为“`@EXPORT`是*邪恶*的！” 但在我看来，当应用于 oneliners 时，这是一种愚蠢的一致性。毕竟 perl 本身会不遗余力地违反其语言的结构，并且如果您在命令行上要求它们，则可以为您提供简单的循环，我只是想将这个想法扩展到我的运营/业务领域。如果有帮助，我什至想应用源过滤器（*喘气！ ）。*

但这个问题也表明我可能也想成为 Perl 的好公民，因为我只是在某些情况下违反社区准则。能够仅通过更改批处理调度程序中的命令行而不是编写一个全新的模块来创建主要的业务级操作，这真是太棒了。测试周期大大压缩。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-03T14:54:07.010

`$0``"-e"`如果您从 运行，则设置为`-e`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-03T15:02:10.223

你为什么要找出模块是否包含在命令行中？你有什么重要的情况吗？你对进口有什么奇怪的吗？告诉我们你想要做什么，我可能会想出一个更好的方法:)

* * *

好的，你问的是出口。您要解决的问题是什么？你想要哪种方式？从命令行额外或更少的默认导出？你知道你可以用 -M 指定一个导入列表，包括一个导出标签（所以，来自 %EXPORT_TAGS 的东西）？如果你想要一个空的导出列表，你可以使用 -m（小写的 m）来代替。[请参阅perlrun](http://perldoc.perl.org/perlrun.html)中 -M/-m 的条目。

您可能还对模块文件既可以是模块又可以是脚本的“模数”技巧感兴趣。您可以将其用作常规模块，在这种情况下您可以访问其所有方法，或者将其作为脚本调用，在这种情况下它会运行。我在*Perl Journal 的*[“脚本作为模块”](http://www.ddj.com/184416165)文章以及Perlmonks[的“脚本如何成为模块”中描述了它。](http://www.perlmonks.org/index.pl?node_id=396759)

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-04T04:21:26.287

在您的中`import()`，如果您的模块是通过. *无论何时*使用 -M （是否使用 -e）都是如此，但我认为这是行号为 的唯一情况。`caller()``0``-M`*`0`*

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-05T04:23:34.753

如果您想要不同的导出行为，“干净”的方法是使用不同的模块名称。如果你真的希望做很多单行使用，你甚至可以给它一个简短的名字。例如MMN.pm：

```
package MMN;
use My::Module::Name '/./';
use Exporter ();
@ISA = 'Exporter';
@EXPORT = @My::Module::Name::EXPORT_OK;
1; 
```

请注意，Exporter 有一个鲜为人知的正则表达式功能；你可能只想做

```
perl -MMy::Module::Name=/./ -e ... 
```

# linq-to-sql - 如何围绕 Membership.CreateUser 进行交易？

> ID：167242
> 
> 赞同：3
> 
> 时间：2008-10-03T14:48:19.407
> 
> 标签：linq-to-sql, asp.net-membership

我在爱好/学习应用程序中使用 asp.net SqlMembershipProvider 和 LinqToSql。我在 LinqtoSql 中保留了一些用户属性，所以我的流程是：Membership.CreateUser -> MyClass.AddUserDetails。我想将整个事情包装在一个事务中，所以如果 myclass 位失败，我可以回滚成员资格位。关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T17:42:02.083

我的真实生活经历（不止一次发生）：

*   初级程序员编写一个站点。
*   在代码审查期间，我发现了用户创建和配置文件创建之间缺少的事务（通常使用自定义 SqlProvider）
*   我们将所有内容都包装在 DTC 事务中。
*   在初级程序员的计算机上没有任何效果。
*   修复初级程序员计算机上的 DTC。
*   部署到共享主机环境。
*   在托管环境中没有任何作用。
*   与试图修复其 DTC 的托管公司争论 4 小时。
*   删除交易，因为网站*必须*上线。
*   祈祷。

我真的不喜欢会员了...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T17:35:14.297

提供商没有明确支持交易，我前段时间要求提供此功能：

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=102268](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=102268)

我认为如果您使用 TransactionScope 类，它应该可以工作，尽管您将承担 MSDTC 协调事务的开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T17:25:57.547

您可以设置 DataContext 的 Transaction 属性以使其参与您已有的事务。

# delphi - 停止函数在 Delphi 中被覆盖

> ID：167247
> 
> 赞同：10
> 
> 时间：2008-10-03T14:49:10.093
> 
> 标签：delphi, oop, class

如何阻止超类中的函数/过程在 Delphi (2007) 的子类中被覆盖？

我想标记它以使其无法更改，我相信有一个 final 关键字，但我一生都找不到它的文档，所以我不能 100% 确定这就是我需要的。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-03T14:59:59.010

关键字`final`如你所想。请参阅[http://dn.codegear.com/article/34324](http://dn.codegear.com/article/34324)和[http://blogs.teamb.com/rudyvelthuis/2005/05/13/4311](http://blogs.teamb.com/rudyvelthuis/2005/05/13/4311)。您也可以将您的类标记为密封，以防止任何人继承它。你需要一个高于 7 的 Delphi 版本。

```
type
  TSomeClass = class
  protected
    procedure SomeVirtualMethod; virtual;
  end;

  TOtherClass = class(TSomeClass)
  protected
    procedure SomeVirtualMethod; override; final;
  end; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-03T15:07:58.963

你是对的——它是“最终的”。这个片段显示了它。（来自[Marco Cantu](http://www.marcocantu.com)的一本书）

```
type
  TDeriv1 = class (TBase)
    procedure A; override; final;
  end;

  TDeriv2 = class (TDeriv1)
    procedure A; override; // error: "cannot override a final method"
  end; 
```

编译给出：

```
[Pascal Error] Unit1.pas(11): E2352 Cannot override a final method 
```

One thing that surprised me: This feature is supported in Win32 Delphi, not just Delphi for .NET

# c# - 如何使用 ASPNET 用户帐户访问私钥？

> ID：167252
> 
> 赞同：1
> 
> 时间：2008-10-03T14:50:38.547
> 
> 标签：c#, encryption, certificate

我在使用 ASPNET 用户导入和访问私钥时遇到了一些问题。我知道当手动导入私钥（.pfx 文件）时，在 Windows 中，您可以选择将密钥标记为可导出。现在，据我所知，这是为了稍后检索该私钥所必需的。

我的问题在于我以 ASPNET 用户的身份在代码中导入私钥，并且似乎没有办法将其标记为可导出，就像 Windows 证书导入向导那样。澄清一下，导入工作正常，但是当我访问现在导入的证书的详细信息时，没有私钥数据。

这是我用来导入证书的代码，一旦我已经使用正确的密码打开了 .pfx 文件。

```
public void ImportCertificate(X509Certificate2 cert, StoreName name, StoreLocation loc)
{
    X509Store certStore = new X509Store(name, loc);
    StorePermission permission = new StorePermission(PermissionState.Unrestricted);
    permission.Flags = StorePermissionFlags.AddToStore;
    permission.Assert();
    certStore.Open(OpenFlags.ReadWrite);
    certStore.Add(cert);
    certStore.Close();
} 
```

我是在搞砸权限还是我导入此私钥的方式？还是我完全以错误的方式解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T15:17:01.253

我相信您在导入证书时需要设置 X509KeyStorageFlags.Exportable 标志。您没有显示该代码，但是具有此签名的 Import 方法有一个重载：

```
public override void Import(string fileName, string password, 
                            X509KeyStorageFlags keyStorageFlags); 
```

或者这个：

```
public override void Import(byte[] rawData, string password, 
                            X509KeyStorageFlags keyStorageFlags); 
```

这将让您在导入之前设置它。否则，一切看起来都很好！

理查德

# mysql - 在 MySQL 中查看表以进行更改？

> ID：167254
> 
> 赞同：24
> 
> 时间：2008-10-03T14:51:28.730
> 
> 标签：mysql, database

除了每隔 n 次或类似的时间从表中进行选择之外，还有更好的方法来观察表中的新条目吗？

我有一个外部程序经常更新的表，客户可以在新数据到达时观察它，我怎样才能做到这一点，而不必设置固定周期的可重复选择语句？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-03T14:58:18.407

在 MySQL 中，没有比轮询更好的方法（尽管您创建一个特定的表来简化轮询），但在其他数据库中，您可以拥有对数据库外部产生影响的触发器。在 MySQL中，[触发器](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)只能在数据库内部做一些事情（例如，填充帮助表）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-03T15:27:00.157

另一种类似的方法是添加

```
add column Last_Modified TIMESTAMP ON UPDATE CURRENT_TIMESTAMP DEFAULT CURRENT_TIMESTAMP 
```

到每个表并在您的选择查询前加上最后一个请求日期/时间与最大值（Last_Modified）。

数据库通常是*拉取*源而不是*推送*，因此无论如何您仍然需要以编程方式探测更改。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-03T14:56:20.517

这就是我所做的：我为表设置了一些触发器（插入、删除、更新），这些触发器增加了另一个表中的计数器。我的数据库访问代码保留一个本地计数器并将其与返回值进行比较，最终将布尔值发送回调用者，回答 IsDataCurrent() 问题。

我们使用此数据库访问代码的程序会根据请求轮询或检查它，然后进行适当的调用以使自己保持最新状态。

我敢肯定还有其他方法可以解决这个问题。不过，它对我来说效果很好。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-05-30T06:11:11.997

如果您可以控制主机，则*可以*在数据库之外触发行为。

A） [这个问题的答案建议](https://stackoverflow.com/questions/2686148/monitor-mysql-table-for-changes-within-a-c-sharp-program?lq=1)使用“select into outfile”写入文件，并使用一些系统进程监视该文件的更改（例如，基于 inotify 的方法，如[node-inotify](https://github.com/c4milo/node-inotify)甚至[Grunt-watch](https://github.com/gruntjs/grunt-contrib-watch)可能就足够了）

B) 对于勇敢 [者：这个问题的答案](https://stackoverflow.com/questions/4418598/is-there-a-way-to-watch-a-mysql-database-for-changes-using-perl)指出，如果您可以将 C/C++ 附加组件安装到您的数据库服务器，您可以使用用户定义函数 (UDF) 来调用 sys_exec() 从而触发外部进程，或者大概直接在UDF中写实际的过程。

[http://dev.mysql.com/doc/refman/5.0/en/faqs-triggers.html#qandaitem-B-5-1-11](http://dev.mysql.com/doc/refman/5.0/en/faqs-triggers.html#qandaitem-B-5-1-11)

（我目前正在研究这个，对于 AWS RDS 托管的应用程序，所以不幸的是，这些选项都不适合我。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T14:56:54.867

这只是对您的方法的一个小改进。在您正在监视的表上编写触发器以更新 Last_Changed 表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-26T10:03:17.107

对于那些正在这样做的人。您可以启用 binlog 并读取 binlog 以在任何表上进行新的插入/更新/删除。[这里](https://github.com/siddontang/go-mysql)有一个 go 包可以解决问题。这是一个示例实现[。](https://github.com/JackShadow/go-binlog-example)

# clojure - 如何在 Clojure 中制作 Web 应用程序？

> ID：167262
> 
> 赞同：216
> 
> 时间：2008-10-03T14:52:58.087
> 
> 标签：clojure

我想这对于每天使用 Java 的绝大多数程序员来说是一个奇怪的问题。我不。我知道 Java 语言，因为我从事 Java 项目，而不是 Java 世界。我从来没有用 Java 从头开始​​制作过 Web 应用程序。如果我必须使用 Python、Ruby，我知道该去哪里（Django 或 Rails），但如果我想在 Clojure 中制作一个 Web 应用程序，不是因为我被迫生活在 Java 世界中，而是因为我喜欢这种语言，我想尝试一下，我应该使用哪些库和框架？

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2010-07-17T15:54:47.180

Compojure 不再是用于开发 Web 应用程序的完整框架。自 0.4 版本以来，compojure 已分解为多个项目。

[Ring](https://github.com/ring-clojure/ring "戒指")通过抽象出 HTTP 请求和响应过程来提供基础。Ring 将解析传入的请求并生成一个包含请求所有部分的映射，例如 uri、服务器名称和请求方法。然后应用程序将处理请求并根据请求生成响应。响应表示为包含以下键的映射：状态、标题和正文。所以一个简单的应用程序看起来像：

```
(def app [req]
  (if (= "/home" (:uri req))
    {:status 200
     :body "<h3>Welcome Home</h3>"}
    {:status 200 
     :body "<a href='/home'>Go Home!</a>"})) 
```

Ring 的另一部分是中间件的概念。这是位于处理程序和传入请求和/或传出响应之间的代码。一些内置的中间件包括会话和堆栈跟踪。会话中间件将向请求映射添加一个 :session 键，其中包含发出请求的用户的所有会话信息。如果 :session 密钥存在于响应映射中，它将被存储以供当前用户发出的下一个请求。而堆栈跟踪中间件将捕获在处理请求时发生的任何异常，并生成一个堆栈跟踪，如果确实发生任何异常，该堆栈跟踪将作为响应发回。

直接使用 Ring 可能很乏味，因此[Compojure](http://weavejester.github.com/compojure/)构建在 Ring 之上，抽象掉了细节。应用程序现在可以用路由来表示，所以你可以有这样的东西：

```
(defroutes my-routes
  (GET "/" [] "<h1>Hello all!</h1>")
  (GET "/user/:id" [id] (str "<h1>Hello " id "</h1>"))) 
```

Compojure 仍在使用请求/响应映射，因此您可以在需要时随时访问它们：

```
(defroutes my-routes
  (GET "*" {uri :uri} 
           {:staus 200 :body (str "The uri of the current page is: " uri)})) 
```

在这种情况下，{uri :uri} 部分访问请求映射中的 :uri 键并将 uri 设置为该值。

最后一个组件是[Hiccup](http://github.com/weavejester/hiccup)，它可以更轻松地生成 html。各种 html 标签被表示为向量，第一个元素表示标签名称，其余元素是标签的主体。`"<h2>A header</h2>"`变成`[:h2 "A Header"]`. 标记的属性在可选映射中。`"<a href='/login'>Log In Page</a>"`变成`[:a {:href "/login"} "Log In Page"]`. 这是一个使用模板生成 html 的小示例。

```
(defn layout [title & body]
  (html
    [:head [:title title]]
    [:body [:h1.header title] body])) 

(defn say-hello [name]
  (layout "Welcome Page" [:h3 (str "Hello " name)]))

(defn hiccup-routes
  (GET "/user/:name" [name] (say-hello name))) 
```

以下是 compojure 的作者目前正在编写的一些文档的粗略草稿的链接，您可能会发现这些文档对您有帮助：[Compojure Doc](https://docs.google.com/Doc?docid=0AQqGP1CDN0uIZGhmZjJmcGZfMjNjNHIycGZu&hl=en)

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2008-10-11T17:23:33.680

到目前为止，我遇到的最好的 Clojure Web 框架是 Compojure：http: [//github.com/weavejester/compojure/tree/master](http://github.com/weavejester/compojure/tree/master)

它体积小但功能强大，语法优美优雅。（它在底层使用了 Jetty，但它对你隐藏了 Servlet API，除非你想要它，这不会经常发生）。去查看那个 URL 上的 README，然后下载一个快照并开始播放。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2011-06-23T05:31:36.503

还有“Noir”（[http://www.webnoir.org/](http://www.webnoir.org/)），它是一个新的 Clojure Web 框架（所以还没有新的文档）。来自 Django/Rails，我挖掘了简单、直接的语法，它非常精简。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2014-11-26T20:24:46.350

考虑[Luminus Web 框架](http://www.luminusweb.net/)。我没有从属关系，但从我尊敬的朋友那里听到了好话。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2015-08-23T10:27:46.433

我目前的首选网络图书馆现在是[yada](https://github.com/juxt/yada)。

如果您刚刚开始，介绍服务器是[`Compojure`](https://github.com/weavejester/compojure). 我将其视为`apache`Clojure 世界中的 Web 服务器（在这种情况下，yada/aleph 将是 nginx）。您可以[`Luminus`](http://www.luminusweb.net/)用作模板。它有多种变体，例如[`compojure-api`](https://github.com/metosin/compojure-api).

我试过[`Pedestal`](https://github.com/pedestal/pedestal)了，全球都对它感到满意。我并没有声称自己掌握了它，但它有一种令人愉快的语法，感觉非常有凝聚力，而且看起来它确实有很好的性能。它也得到了`Cognitect`（Rich Hickey 工作的 Clojure/Datomic 公司）的支持。

我发现[`Aleph`](https://github.com/ztellman/aleph)提出了一个有趣的抽象，内置的背压似乎很有趣。我还没有玩过它，但它肯定在我的清单上。

在使用了各种 Web 服务器之后，这是我的快速优缺点列表：

简短的回答：看看[Luminus](http://www.luminusweb.net/)以快速入门，也许随着您的需求发展（也许是 Yada）转向其他东西。

## 复合

*   优点（1）：

    *   简单，大量模板/示例（例如 Luminous）
*   缺点（2）：

    *   性能不佳（每个请求一个线程），预计性能略好于 rails
    *   不简单，中间件模型有不便之处

## 座

*   优点（3）：

    *   拦截器模型，将拦截器添加到路由子集的令人愉悦的语法
    *   高性能路由器
    *   开箱即用地透明地支持 json/transit/multipart 表单，无需询问任何内容。很酷 ！
*   缺点（4）：

    *   没有 websocket 支持（还），返回 core.async 通道会很好
    *   如果将其放入 Stuart Sierra 的组件中，重新加载会有点慢（我认为您应该使用重新加载拦截器）
    *   没有异步拦截器的测试工具
    *   需要买进（？）

## 阿莱夫

临 (3):

*   高性能
*   背压
*   返回歧管流时的 Websocket/SSE 支持

缺点（1）：

*   低级，自己做的风格（即，它只是给你一种让你的处理程序做某事的方法。没有路由器，什么都没有）。不是真正的缺点，只是意识到这一点。

## 雅达

临 (3):

*   建立在 Aleph 上
*   内容协商
*   大摇大摆的整合
*   比迪很好（虽然我更喜欢基座路由器语法）

缺点（1）：

*   文档（虽然不如 nginx-clojure 差，但很快改进）。

## HttpKit

临 (2):

*   用 Clojure 写的！（和 Java ......）
*   性能看起来不错（请参阅 600K 并发连接帖子）

缺点（2）：

*   不支持 CORS
*   虫子？此外，最近的提交并不多

## Nginx-Clojure

注意：我没有玩过它，主要是因为缺乏文档。不过它看起来很有趣，而且非常高效。

优点（2）：

*   Nginx（高性能、卸载 ssl、重启工作人员......）
*   这种模型可以实现零停机更新吗？那太棒了！

缺点（1）：

*   文档（改进）。此外，如果这是唯一的方法，我不想在嵌入在 nginx 配置文件中的字符串中进行编程。
*   第一次部署可能有点复杂（？）

## 不变的

注意：我没有玩过它。

优点：

*   集成（缓存、消息传递、调度、wildfly 部署）

缺点：

*   没有http客户端

## 卡塔孔巴

注意：虽然文档看起来很棒，但我没有玩过它。接下来我可能会尝试一下。有一些看起来很有趣的示例聊天项目，它们大量使用协议让我一开始是个 Clojure 开发新手。

优点（6）：

*   文档！像所有 funcool 项目一样，该文档读起来*非常*愉快。
*   基座式路由语法
*   应该是高性能的（在 Ratpack 之上）
*   背压
*   websockets、sse、cors、安全、ssl...
*   独特的挖掘功能：邮政

缺点（2）：

*   不完全确定 ct/routes 语法有多令人愉快，以及放弃 Ring 规范（据说是为了异步故事，但我认为基座人员已经解决了这个问题）
*   不知道如何整合招摇等。
*   当我尝试它时，我无法立即使其工作

**注意**：如果原始性能最重要，可以使用[Clojure Web 服务器的基准测试。](https://github.com/ptaoussanis/clojure-web-server-benchmarks)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2013-08-13T08:53:33.250

如今， [Pedestal](http://pedestal.io/)是一个值得一看的框架。[它是一个构建在Ring](https://github.com/ring-clojure/ring)之上的服务器端框架，但也可以通过暂停和恢复该特定请求（否则一个缓慢的请求实际上会阻塞该服务器线程）来释放来自初始线程的传入请求。也许有点像JavaBean。

其他很酷的框架是[hoplon.io](http://hoplon.io/)和 David Nolen 的[Om](http://swannodette.github.io/2013/12/17/the-future-of-javascript-mvcs/)（基于 React）

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-10-20T05:51:22.340

[Webjure](http://code.google.com/p/webjure/)，Clojure 的 Web 编程框架。

特点： Dispatch servlet 调用 Clojure 函数。动态 HTML 生成。SQL 查询接口（通过 JDBC）。

此答案旨在作为 Webjure 信息的占位符。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-03-04T13:42:55.737

Compojure 是我用来构建小型博客应用程序的工具。它以 Sinatra 为模型，Sinatra 是一个用于 Ruby 的最小、轻量级 Web 框架。我主要只是使用路由，就像 Sinatra 的一样。看起来像：

```
(GET "/post/:id/:slug"
  (some-function-that-returns-html :id :slug)) 
```

没有 ORM 或模板库，但它确实具有将向量转换为 HTML 的功能。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-05-21T09:02:42.600

您还可以查看这些框架（取自[disclojure/projects](http://disclojure.org/projects/)）：

*   [级联](https://github.com/hlship/cascade)
*   [变戏法](https://github.com/macourtney/Conjure)

Stack Overflow 上还有一个相关问题：[成熟的 Clojure Web 框架？](https://stackoverflow.com/questions/3551805/mature-clojure-web-frameworks)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-04-28T11:17:21.117

免责声明：我是作者。

我整理了一个结合了 luminusweb 和栗子模板的 leiningen 模板。所以你得到了一些东西，你可以用它来构建 clojure 代码和用于前端和后端的 clojurescript 代码。
此外，它还提供用户管理以及一些简单的 CRUD 生成和一些更小的优点：[https ://github.com/sveri/closp](https://github.com/sveri/closp)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-10-05T23:06:48.053

我将为[Duct](https://github.com/duct-framework/duct)投入两分钱，同样来自Compojure 和 Ring 的维护者[@weavejester 。](https://github.com/weavejester)

它的核心是将[Component](https://github.com/stuartsierra/component)和 Ring 路由器集中在一个屋檐下。我使用 Duct 的原因：

*   优秀的哲学基础：它鼓励您将应用程序构建为一系列小组件，并且在保持少量意见和提供合理的默认值之间取得了很好的平衡。
*   稳定的道路：我为自己说话，但多年来我一直觉得 Clojure 社区提出了一个又一个不太可信的 Web 框架。一对夫妇只是觉得“把事情做好”（并不是说他们不会在未来证明是优越的）太具有实验性（我对 Om 和客户端 Pedestal 的经验）。另一方面，我觉得@weavejester 为 Duct 带来了与他为 Compojure 和 Ring 所做的相同的稳定性和可衡量的进步，这在社区中已经非常出色地诞生了。
*   它*超*轻量级，并且不妨碍我的组件。

主要特点：

*   通过“端点”组织路由，您可以将这些小组件视为迷你 Web 服务器（或 HTTP 路由的小横截面）。
*   [对重新加载的工作流](http://thinkrelevance.com/blog/2013/06/04/clojure-workflow-reloaded)的开箱即用支持。
*   与 Ring 和 Compojure 完美结合。
*   开发和生产配置（我在其他地方发现明显缺失的东西）。
*   带有示例的良好文档。

**注意：**这是不言而喻的，但为了 Web 开发新手的利益，像大多数 Clojure 东西一样，Duct 需要对 Clojure 语言有扎实的掌握。我还建议先阅读有关 Component 的内容。

另一方面，我已经在多个生产应用程序中使用 Duct 一年多了，对此我感到非常满意。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-08-14T12:32:37.543

你也可以在 Coils 上尝试 Clojure， http: [//github.com/zubairq/coils](http://github.com/zubairq/coils) - 免责声明：我是作者

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-05-20T14:24:04.490

另一个有趣的网络服务器是[Http-kit](http://www.http-kit.org/)。它具有良好的性能并且符合环形标准，并且还支持 WebSockets。它主要是用 clojure 制作的，缺少 Jetty/Tomcat 中的一些奇怪的东西。

这很容易修补。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-12-22T08:04:30.527

Reframe 和 om.next 可能是您正在寻找的。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-02-19T20:28:47.177

[Arachne](http://arachne-framework.org/)是一个新来的 Web 框架。引用网站的描述：

> Arachne 是一个完整的、高度模块化的 Clojure Web 开发框架。它强调易用性、简单性和可靠、可扩展的设计。

它有一个 [kickstarter 活动](https://www.kickstarter.com/projects/1346708779/arachne-rapid-web-development-for-clojure) ，声称提供类似于Rails 的“入门”体验。它是由 Cognitect 开发的。

[这](https://www.reddit.com/r/Clojure/comments/4f2j1w/introducing_arachne_a_full_rapiddevelopment_web/)是与 Luminus (yogthos) 的作者的一个很好的讨论。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-05-04T14:35:17.120

我已经在生产中成功使用[Liberator](http://clojure-liberator.github.io/liberator/)有一段时间了。如果您只想要简单的框架，例如，如果您正在构建一个 RESTful Web 服务或类似的东西，那么它是一个很棒的框架。它本质上是 ring 和 compojure 的包装器，并在验证传入请求时提供决策图。与其他更庞大的 Web 框架相比，它的速度也非常快。如果您想从某个地方快速开始并慢慢扩展，那么 Liberator 是一个不错的选择。

# sql - 如何防止多个数据库用户覆盖彼此的数据？

> ID：167282
> 
> 赞同：1
> 
> 时间：2008-10-03T14:57:24.007
> 
> 标签：sql

如果两个用户正在访问同一个数据库表，我们如何防止用户覆盖彼此的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T15:03:17.537

查看[此讨论](https://stackoverflow.com/questions/129329/optimistic-vs-pessimistic-locking#129397)，了解应用程序中数据库锁定的不同策略或技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T15:02:54.760

没有直接的方法可以做到这一点。您可以使用事务来确保正确解析更新（即您不会获得部分更新），但您可能会丢失第一组更改，因为它将被第二组覆盖。

您可能有两个选择：

*   在应用程序级别实现一些锁定机制（即，当有人开始编辑记录时，在某处放置一些标志，以防止其他用户执行相同操作）
*   实施版本控制，因此每次有人写入数据库时​​都会创建一条*新*记录。这样，两组数据都将在数据库中，您可以在应用程序中使用逻辑来合并它们或选择您喜欢的数据集

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T15:04:34.897

嗯，这取决于。当您编辑表格时，它不像在 MSWord 或其他东西中打开文件。

您正在发出一次专门添加或更改一行或一组行的命令，因此除非两个人正在编辑同一行，否则两个用户的更改将被保留。

也可以在执行操作时（或在事务中）隐式锁定表，或者在您确切知道要阻止编辑的内容时显式锁定表。大多数数据库都提供“行级锁定”，这意味着不需要每次操作都锁定整个表。

[当您开始考虑事务和MVCC](http://en.wikipedia.org/wiki/Multiversion_concurrency_control)时，它会变得更加复杂。如果您让我们知道更多关于您感兴趣的具体情况的信息，我们可以为您提供一些更具体的帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T15:15:32.597

一些数据库服务器支持如下结构：

```
SELECT column FROM table WHERE something = 'whatever' FOR UPDATE; 
```

它将锁定选择返回的所有行，直到发出 COMMIT 或 ROLLBACK。

MySQL (InnoDB) 和 Oracle 是支持这一点的两个数据库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T15:06:47.157

我遇到的最巧妙的方法是使用一个名为的附加字段`last_actv_dtm`，每次有人修改记录时都会更新该字段。假设您的应用程序首先查询记录，您应该拥有`last_actv_dtm`正在修改的记录。

使用此 SQL 执行更新。

```
UPDATE tab1
SET
    col1 = ?
    , col2 = ?
    , last_actv_dtm = GETDATE()
WHERE
    pkcol = rec.pkcol
    AND last_actv_dtm = rec.last_actv_dtm; 
```

这只会在应用程序选择记录后没有被修改的情况下更新该行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T15:07:09.993

这是一个没有简单答案的大问题。它要求您在另一个用户正在使用它时阻止一个用户的意愿如何，以及在它发生时您如何防止死锁和糟糕的性能。此外，您是否试图阻止一个用户更新与另一个用户相同的行，或者只是更新同一个表中的不同行？如果用户 A 更新了该行，然后用户 B 尝试更新该行，它应该失败、更新还是静默忽略它？一旦你更多地定义了问题，你就可以决定是否需要表级锁、行级锁、事务，以及是否需要各种级别的事务隔离。

# url - 如何获取 Https URL 内容

> ID：167294
> 
> 赞同：0
> 
> 时间：2008-10-03T14:59:47.373
> 
> 标签：url, https, request, server-side

我有一个需要用户登录名和密码的 https 链接。如果我像这样在 FX 中运行它： [https://usernameassword@www.example.com/link/sublink](https://usernameassword@www.example.com/link/sublink)

它将按预期返回 xml 数据。

但是，我想要做的是自动化这个过程。我尝试在 PHP中使用[file_get_contents() 。](http://php.net/manual/en/function.file-get-contents.php)

我什至尝试使用 AJAX，但仍然无法正常工作。

我试图在服务器或前端（ajax）中获取内容（XML），但两者都不起作用。

有谁知道我需要做什么才能获得内容？我需要获得 SSL 证书吗？

任何其他语言的解决方案也将受到欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T15:07:09.823

你应该使用 curl 库，如果你想防止中间人攻击，还应该验证证书。或者只是使用 curl 选项忽略它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T15:25:56.540

支持 SSL 的 cURL 或 wget。

cURL，您可以通过编译的 PHP 库运行或从 PHP 调用可执行文件。

Wget，您将不得不调用可执行文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T21:59:09.897

通过其[Java 绑定](http://curl.haxx.se/libcurl/java/)使用[libcurl](http://curl.haxx.se/libcurl/)。

# winforms - 如何将 DataGridView 数据中的数据导出到 Excel 电子表格？

> ID：167297
> 
> 赞同：4
> 
> 时间：2008-10-03T15:00:14.580
> 
> 标签：winforms, excel, datagridview

在我的 Winforms 应用程序中，我想将数据从 DataGridView 导出到 Excel 电子表格。

它只是循环和输出逗号分隔的结果的工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T15:06:43.020

*它只是循环和输出逗号分隔的结果的工作吗？*是的。这是一种没有任何依赖关系的更简单的方法。

如果您需要更多控制，您始终可以从[vb.net](http://support.microsoft.com/kb/301982)或[C#](http://support.microsoft.com/kb/302084)自动化 excel ..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T15:24:09.540

以逗号分隔的输出结果将为您提供 .csv 而不是 excel 电子表格；虽然 excel 可以读取 csv，并且一旦在 excel 中打开，您就可以将其保存为 excel 文件。要实际以 excel 格式编写文件，我相信您必须使用 Ole Provider 或类似的东西，但我从来没有打扰过，因为创建 csv 和在代码之外使其成为 excel 文件的解决方法很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T15:52:56.767

有点 hacky，但 Excel 也会打开一个以 .xls 扩展名保存的 html 文件。这具有能够包含格式的优点。

# ruby-on-rails - Rails 中的非 DB attr_accessor 属性持久性

> ID：167302
> 
> 赞同：0
> 
> 时间：2008-10-03T15:02:54.730
> 
> 标签：ruby-on-rails, ruby, activerecord

我有一个应用程序，其中 attr_accessor 用于保留将传递给 rake 任务的模型的临时数据。看到这些属性没有数据库字段并且它们不是从数据库数据中计算出来的，attr_accessor 数据是否会持续存在并可供 rake 任务使用？如果我需要重新启动服务器会发生什么 - 如果数据没有保存到数据库中，数据会丢失吗？或者要实现这一点，我是否需要保存到临时文件或数据库字段？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-03T18:33:51.637

我假设您在问存储在源自 Web 请求的 ActiveRecord 对象的属性中的数据在通过 Rake 任务访问它们时是否可用？

不，他们不会。该数据甚至无法用于下一个 Web 请求。如果您两次加载相同的记录，则该数据甚至都不存在。

```
class Thing < ActiveRecord::Base
  attr_accessor :data
end

#try this in script/console
thing = Thing.find(:first)
thing.data = "Something"
thing = Thing.find(:first)

puts thing.data
-> nil 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-17T04:10:11.560

这取决于您如何将数据传递给 rake 任务以及原因。如果您尝试对请求进行带外工作，这意味着不要让用户等到完成，我建议您在此处查看 Ryan 的出色截屏视频[http://railscasts.com/episodes/128-starling-and -工作](http://railscasts.com/episodes/128-starling-and-workling "Railscasts - Starling 和 Workling")以了解工作队列。

如果它有一些其他奇怪的原因，你必须像这样使用 rake，你可以将数据作为命令行参数传递。这取决于您需要传递多少数据及其复杂性，因为它可能很快就会失控。

使用上面丹尼尔的例子：

thing = Thing.find(:first) thing.data = "Something"

`rake myraketask thing_id=#{thing.id} data=#{thing.data}`

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-10-03T18:17:36.927

当然会丢失，你认为数据死后会去哪里？到数据 h(e)aven 从哪里它总是可以返回？

我想知道您需要这些数据来做什么，但最终的答案可能是数据属于数据库，除非它是大型二进制数据（例如图像），您应该将其保存在文件系统中。

# linq - 是否可以使用 LINQ 透视数据？

> ID：167304
> 
> 赞同：183
> 
> 时间：2008-10-03T15:03:07.833
> 
> 标签：linq, pivot-table

我想知道是否可以使用 LINQ 从以下布局中透视数据：

```
CustID | OrderDate | Qty
1      | 1/1/2008  | 100
2      | 1/2/2008  | 200
1      | 2/2/2008  | 350
2      | 2/28/2008 | 221
1      | 3/12/2008 | 250
2      | 3/15/2008 | 2150 
```

变成这样的东西：

```
CustID  | Jan- 2008 | Feb- 2008 | Mar - 2008 |
1       | 100       | 350       |  250
2       | 200       | 221       | 2150 
```

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2008-10-03T17:18:11.680

像这样的东西？

```
List<CustData> myList = GetCustData();

var query = myList
    .GroupBy(c => c.CustId)
    .Select(g => new {
        CustId = g.Key,
        Jan = g.Where(c => c.OrderDate.Month == 1).Sum(c => c.Qty),
        Feb = g.Where(c => c.OrderDate.Month == 2).Sum(c => c.Qty),
        March = g.Where(c => c.OrderDate.Month == 3).Sum(c => c.Qty)
    }); 
```

`GroupBy`在 Linq 中的工作方式与 SQL 不同。在 SQL 中，您可以获得键和聚合（行/列形状）。在 Linq 中，您将键和任何元素作为键的子级（分层形状）。要进行透视，您必须将层次结构投影回您选择的行/列形式。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-06-08T17:21:11.070

我使用 linq 扩展方法回答[了类似的问题：](https://stackoverflow.com/questions/963491/pivot-data-using-linq)

```
// order s(ource) by OrderDate to have proper column ordering
var r = s.Pivot3(e => e.custID, e => e.OrderDate.ToString("MMM-yyyy")
    , lst => lst.Sum(e => e.Qty));
// order r(esult) by CustID 
```

(+) 通用实现
(-) 肯定比 Amy B 慢

谁能改进我的实现（即该方法对列和行进行排序）？

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-03-29T10:56:52.973

我认为最简洁的方法是使用查找：

```
var query =
    from c in myList
    group c by c.CustId into gcs
    let lookup = gcs.ToLookup(y => y.OrderDate.Month, y => y.Qty)
    select new
    {
        CustId = gcs.Key,
        Jan = lookup[1].Sum(),
        Feb = lookup[2].Sum(),
        Mar = lookup[3].Sum(),
    }; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-08-23T13:59:44.410

以下是如何使用 LINQ 透视数据的更通用的方法：

```
IEnumerable<CustData> s;
var groupedData = s.ToLookup( 
        k => new ValueKey(
            k.CustID, // 1st dimension
            String.Format("{0}-{1}", k.OrderDate.Month, k.OrderDate.Year // 2nd dimension
        ) ) );
var rowKeys = groupedData.Select(g => (int)g.Key.DimKeys[0]).Distinct().OrderBy(k=>k);
var columnKeys = groupedData.Select(g => (string)g.Key.DimKeys[1]).Distinct().OrderBy(k=>k);
foreach (var row in rowKeys) {
    Console.Write("CustID {0}: ", row);
    foreach (var column in columnKeys) {
        Console.Write("{0:####} ", groupedData[new ValueKey(row,column)].Sum(r=>r.Qty) );
    }
    Console.WriteLine();
} 
```

其中 ValueKey 是一个表示多维键的特殊类：

```
public sealed class ValueKey {
    public readonly object[] DimKeys;
    public ValueKey(params object[] dimKeys) {
        DimKeys = dimKeys;
    }
    public override int GetHashCode() {
        if (DimKeys==null) return 0;
        int hashCode = DimKeys.Length;
        for (int i = 0; i < DimKeys.Length; i++) { 
            hashCode ^= DimKeys[i].GetHashCode();
        }
        return hashCode;
    }
    public override bool Equals(object obj) {
        if ( obj==null || !(obj is ValueKey))
            return false;
        var x = DimKeys;
        var y = ((ValueKey)obj).DimKeys;
        if (ReferenceEquals(x,y))
            return true;
        if (x.Length!=y.Length)
            return false;
        for (int i = 0; i < x.Length; i++) {
            if (!x[i].Equals(y[i]))
                return false;
        }
        return true;            
    }
} 
```

这种方法可用于按 N 维 (n>2) 进行分组，并且适用于相当小的数据集。对于大型数据集（最多 100 万条记录或更多）或无法对数据透视配置进行硬编码的情况，我编写了特殊[的 PivotData](http://www.nrecosite.com/pivot_data_library_net.aspx)库（它是免费的）：

```
var pvtData = new PivotData(new []{"CustID","OrderDate"}, new SumAggregatorFactory("Qty"));
pvtData.ProcessData(s, (o, f) => {
    var custData = (TT)o;
    switch (f) {
        case "CustID": return custData.CustID;
        case "OrderDate": 
        return String.Format("{0}-{1}", custData.OrderDate.Month, custData.OrderDate.Year);
        case "Qty": return custData.Qty;
    }
    return null;
} );
Console.WriteLine( pvtData[1, "1-2008"].Value ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-16T05:58:48.387

这是最有效的方法：

检查以下方法。而不是每个月每次都遍历客户组。

```
var query = myList
    .GroupBy(c => c.CustId)
    .Select(g => {
        var results = new CustomerStatistics();
        foreach (var customer in g)
        {
            switch (customer.OrderDate.Month)
            {
                case 1:
                    results.Jan += customer.Qty;
                    break;
                case 2:
                    results.Feb += customer.Qty;
                    break;
                case 3:
                    results.March += customer.Qty;
                    break;
                default:
                    break;
            }
        }
        return  new
        {
            CustId = g.Key,
            results.Jan,
            results.Feb,
            results.March
        };
    }); 
```

或者这个：

```
var query = myList
    .GroupBy(c => c.CustId)
    .Select(g => {
        var results = g.Aggregate(new CustomerStatistics(), (result, customer) => result.Accumulate(customer), customerStatistics => customerStatistics.Compute());
        return  new
        {
            CustId = g.Key,
            results.Jan,
            results.Feb,
            results.March
        };
    }); 
```

完整的解决方案：

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace ConsoleApp
{
    internal class Program
    {
        private static void Main(string[] args)
        {
            IEnumerable<CustData> myList = GetCustData().Take(100);

            var query = myList
                .GroupBy(c => c.CustId)
                .Select(g =>
                {
                    CustomerStatistics results = g.Aggregate(new CustomerStatistics(), (result, customer) => result.Accumulate(customer), customerStatistics => customerStatistics.Compute());
                    return new
                    {
                        CustId = g.Key,
                        results.Jan,
                        results.Feb,
                        results.March
                    };
                });
            Console.ReadKey();
        }

        private static IEnumerable<CustData> GetCustData()
        {
            Random random = new Random();
            int custId = 0;
            while (true)
            {
                custId++;
                yield return new CustData { CustId = custId, OrderDate = new DateTime(2018, random.Next(1, 4), 1), Qty = random.Next(1, 50) };
            }
        }

    }
    public class CustData
    {
        public int CustId { get; set; }
        public DateTime OrderDate { get; set; }
        public int Qty { get; set; }
    }
    public class CustomerStatistics
    {
        public int Jan { get; set; }
        public int Feb { get; set; }
        public int March { get; set; }
        internal CustomerStatistics Accumulate(CustData customer)
        {
            switch (customer.OrderDate.Month)
            {
                case 1:
                    Jan += customer.Qty;
                    break;
                case 2:
                    Feb += customer.Qty;
                    break;
                case 3:
                    March += customer.Qty;
                    break;
                default:
                    break;
            }
            return this;
        }
        public CustomerStatistics Compute()
        {
            return this;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-16T21:37:46.490

```
// LINQPad Code for Amy B answer
void Main()
{
    List<CustData> myList = GetCustData();

    var query = myList
        .GroupBy(c => c.CustId)
        .Select(g => new
        {
            CustId = g.Key,
            Jan = g.Where(c => c.OrderDate.Month == 1).Sum(c => c.Qty),
            Feb = g.Where(c => c.OrderDate.Month == 2).Sum(c => c.Qty),
            March = g.Where(c => c.OrderDate.Month == 3).Sum(c => c.Qty),
            //April = g.Where(c => c.OrderDate.Month == 4).Sum(c => c.Qty),
            //May = g.Where(c => c.OrderDate.Month == 5).Sum(c => c.Qty),
            //June = g.Where(c => c.OrderDate.Month == 6).Sum(c => c.Qty),
            //July = g.Where(c => c.OrderDate.Month == 7).Sum(c => c.Qty),
            //August = g.Where(c => c.OrderDate.Month == 8).Sum(c => c.Qty),
            //September = g.Where(c => c.OrderDate.Month == 9).Sum(c => c.Qty),
            //October = g.Where(c => c.OrderDate.Month == 10).Sum(c => c.Qty),
            //November = g.Where(c => c.OrderDate.Month == 11).Sum(c => c.Qty),
            //December = g.Where(c => c.OrderDate.Month == 12).Sum(c => c.Qty)          
        });

    query.Dump();
}

/// <summary>
/// --------------------------------
/// CustID  | OrderDate     | Qty
/// --------------------------------
/// 1       | 1 / 1 / 2008  | 100
/// 2       | 1 / 2 / 2008  | 200
/// 1       | 2 / 2 / 2008  | 350
/// 2       | 2 / 28 / 2008 | 221
/// 1       | 3 / 12 / 2008 | 250
/// 2       | 3 / 15 / 2008 | 2150 
/// </ summary>
public List<CustData> GetCustData()
{
    List<CustData> custData = new List<CustData>
    {
        new CustData
        {
            CustId = 1,
            OrderDate = new DateTime(2008, 1, 1),
            Qty = 100
        },

        new CustData
        {
            CustId = 2,
            OrderDate = new DateTime(2008, 1, 2),
            Qty = 200
        },

        new CustData
        {
            CustId = 1,
            OrderDate = new DateTime(2008, 2, 2),
            Qty = 350
        },

        new CustData
        {
            CustId = 2,
            OrderDate = new DateTime(2008, 2, 28),
            Qty = 221
        },

        new CustData
        {
            CustId = 1,
            OrderDate = new DateTime(2008, 3, 12),
            Qty = 250
        },

        new CustData
        {
            CustId = 2,
            OrderDate = new DateTime(2008, 3, 15),
            Qty = 2150
        },      
    };

    return custData;
}

public class CustData
{
    public int CustId;
    public DateTime OrderDate;
    public uint Qty;
} 
```

[![在此处输入图像描述](https://i.stack.imgur.com/zKrmD.png)](https://i.stack.imgur.com/zKrmD.png)

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2008-10-03T15:08:34.280

按月对数据进行分组，然后将其投影到一个新的数据表中，其中包含每个月的列。新表将是您的数据透视表。

# c# - 验证和调整树视图标签

> ID：167306
> 
> 赞同：1
> 
> 时间：2008-10-03T15:03:27.537
> 
> 标签：c#, forms, treeview

我有一个树视图控件，并且已经捕获了它的标签后编辑事件。我希望能够验证用户的输入并进行调整——例如它太长了——但我似乎只能取消新值，而不是改变它。有任何想法吗？

我不想打开一个新表单，用户可能正在重命名其中的一个范围，它不应该太麻烦。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T15:42:12.293

您不能从 EventArgs 中获取正在编辑的节点并手动设置其文本吗？如果这导致 AfterLabelEdit 再次被触发，那么如果它来自手动编辑，则应该添加一个标志以退出它。

# sql-server - 如何获得特定日期的最后可能时间

> ID：167316
> 
> 赞同：22
> 
> 时间：2008-10-03T15:06:27.360
> 
> 标签：sql-server, date, time

我正在尝试实现特定日期的最后可能时间，例如日期为 2008-01-23 00:00:00.000 我可能需要 2008-01-23 23:59:59.999 可能通过在日期上使用 dateadd 函数场地？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-03T15:12:50.873

答案是`SELECT DATEADD(ms, -3, '2008-01-24')`，解释如下。

来自[马克的博客](http://musingmarc.blogspot.com/2006/07/more-on-dates-and-sql.html)：

> 但是等等，马克……你说你喜欢使用`BETWEEN`，但那个查询没有……那是因为它`BETWEEN` [是 inclusive](http://www.techonthenet.com/sql/between.php)，这意味着它包括端点。如果我有一份在下个月第一天午夜到期的订单，它将被包括在内。那么如何获得期末的适当值呢？肯定**不是**通过使用日期部分来组装一个（但你必须这样做，请记住它是 23:59:59.997 作为最长时间......不要忘记毫秒）。为了做到这一点，我们使用 Microsoft SQL Server`DATETIME`列*最多具有的乱伦知识*3毫秒的分辨率（不会改变的东西）。所以我们所做的就是从上面给出的任何期末公式中减去 3 毫秒。例如，昨天（当地时间）的最后一个可能瞬间是：

```
 SELECT DATEADD(ms, -3, DATEADD(dd, DATEDIFF(dd, 0, GetDate()), 0)) 
```

因此，要将本月到期的订单作为`BETWEEN`查询，您可以使用以下命令：

```
 SELECT [ID]
    FROM [dbo].[Orders]
    WHERE [ShipDue] BETWEEN DATEADD(mm, DATEDIFF(mm, 0, GetUTCDate()), 0)
    AND DATEADD(ms, -3, DATEADD(mm, DATEDIFF(mm, 0, GetUTCDate()) + 1, 0)) 
```

请记住，始终确保您对输入参数而**不是**列进行数学运算，否则您将杀死查询的[SARG](http://www.databasejournal.com/features/mssql/article.php/1436301)能力，这意味着可能已使用的索引不是。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-03T15:10:41.953

```
SELECT DATEADD(ms, -2, DATEADD(dd, 1, DATEDIFF(dd, 0, GetDate()))) 
```

起初我以为你有 c#。我会把这个留在这里，以防其他人偶然发现这个。

```
DateTime now = DateTime.Now;
DateTime endofDay = now.Date.AddDays(1).AddMilliseconds(-1); 
```

您可以将“现在”变量替换为您想要找出的任何一天

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-03T15:28:43.040

将 -1*毫秒*添加到*第二天*的*开始*（DateAdd 甚至支持纳秒，如果你想得到真正的罚款）。

 *但很可能你只是想在比较中使用这个值，在这种情况下它会更简单。

而不是这样的：

```
AND @CompareDate <= [LastTimeforThatday] 
```

或这个：

```
@compareDate BETWEEN [StartDate] AND [LastTimeforThatday] 
```

像这样做：

```
AND @CompareDate < [BeginningOfNextDay] 
```

或这个：

```
AND (@CompareDate >= [StartDate] AND @CompareDate < [BeginningOfNextDay]) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-20T19:39:13.993

为什么要重蹈覆辙？

```
SELECT DATEADD(ms, 86399997, *yourDate*) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-17T21:22:26.870

我能够使用：

```
select {fn curdate()} + ' 23:59:59.000' 
```

或者

```
select DATEADD(ss,-1,DATEADD(DAY,1,CAST({fn curdate()} as DATETIME))) 
```

结束一天

# .net - 如何在线程中打开表单并强制它保持打开状态

> ID：167323
> 
> 赞同：8
> 
> 时间：2008-10-03T15:07:27.293
> 
> 标签：.net, winforms, multithreading

我仍然无法弄清楚如何在我在[这里](https://stackoverflow.com/questions/164789/winforms-implementation-question-for-having-my-ui-run-independently-of-my-bll-l)讨论的单独的 UI 线程中创建 winforms 。

为了弄清楚这一点，我编写了以下简单的测试程序。我只是希望它在名为“UI 线程”的单独线程上打开一个表单，并在表单打开时保持线程运行，同时允许用户与表单交互（旋转是作弊）。我理解为什么下面会失败并且线程会立即关闭，但我不确定我应该怎么做才能修复它。

```
using System;
using System.Windows.Forms;
using System.Threading;

namespace UIThreadMarshalling {
    static class Program {
        [STAThread]
        static void Main() {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            var tt = new ThreadTest();
            ThreadStart ts = new ThreadStart(tt.StartUiThread);
            Thread t = new Thread(ts);
            t.Name = "UI Thread";
            t.Start();
            Thread.Sleep(new TimeSpan(0, 0, 10));
        }

    }

    public class ThreadTest {
        Form _form;
        public ThreadTest() {
        }

        public void StartUiThread() {
            _form = new Form1();
            _form.Show();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-03T15:17:11.410

在一个新线程上，调用 Application.Run 传递表单对象，这将使线程在窗口打开时运行自己的消息循环。

然后，您可以在该线程上调用 .Join 以使您的主线程等到 UI 线程终止，或者使用类似的技巧来等待该线程完成。

例子：

```
public void StartUiThread()
{
    using (Form1 _form = new Form1())
    {
        Application.Run(_form);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T15:23:16.623

```
private void button1_Click(object sender, EventArgs e)
{
    var t = new Thread(RunNewForm);
    t.Start();
}
public static void RunNewForm()
{
     Application.Run(new Form2());
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T15:28:55.287

我认为您的问题在于这个想法：“在名为'UI线程'的单独线程上打开一个表单”

Windows 的工作方式是这样的（请注意 Vista 可能会改变其中的一些现实）：

有一个重要的线程称为“**主线程**”或“ **UI 线程**”。该线程是处理[Windows 消息](http://www.geocities.com/practicalvb/vb/windows/messages.html)的线程，例如“嘿，鼠标点击了这个像素”。

这些消息进入队列，主线程**在不忙于做其他事情时**处理它们。

因此，如果你在主线程上调用 foo() 函数，如果需要很长时间，则在此期间不会处理任何 windows 消息，因此不会发生用户交互。

主线程还在屏幕上绘制 UI，因此长时间运行的 foo() 也会阻止您的应用绘制。

除了这个神圣而特殊的主线程之外的所有其他线程都是 grunt 工作线程。这些工作线程可以做事，但它们永远不能直接与用户界面交互。

这种现实导致了两个问题：

1.  摆脱主线程：由于您不希望长时间运行的 foo() 停止所有用户交互，因此您需要将该工作交付给工作线程。

2.  回到主线程：当长时间运行的 foo() 完成时，您可能希望通过在 UI 中执行某些操作来通知用户，但您无法在工作线程中执行此操作，因此您需要“返回”到主线程。

因此，我相信您在上述程序中的问题非常普遍：您的目标是不正确的，因为除了神圣的主线程之外，不应在任何线程中调用 _form.Show() 。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T15:19:20.250

您不能在任何线程中打开 GUI 表单，因为它将缺少消息泵。您必须通过在线程方法中调用 Application.Run() 来显式启动该线程中的消息泵。另一种选择是在循环中调用 DoEvents()，如果您需要执行其他操作，因为在 Application.Run() 之后，该线程将等待用户在该执行点关闭表单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T15:32:45.027

我认为只调用 ShowDialog 而不是 Show 会有所帮助。问题似乎是线程在调用 Show 之后就完成了，之后 Form get 的垃圾被收集了。ShowDialog 将停止线程，但仍会在其上运行表单事件，因此线程将继续运行，直到表单关闭。

通常我会反过来做。当您想要启动长时间运行的后台任务时，在启动线程上运行表单并启动后台线程。

我还阅读了您的其他问题，但无法弄清楚您要做什么。MVP 架构不需要您在不同的线程上运行业务逻辑。多线程很难做到正确，所以如果我真的需要多线程，我只会使用它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-01T10:28:28.770

而不是在表单上调用 show() 将在表单上执行，然后在函数 StartUiThread() 中的线程执行结束时关闭，您可以锁定线程直到表单在方法中停止，因为您只是锁定另一个线程。前任：

```
public void StartUiThread() {
        _form = new Form1();
        _form.ShowDialog(); //Change Show() to ShowDialog() to wait in thread
    } 
```

这将导致新线程等待对话框关闭。我不知道这是否会解决您的问题，但它解决了我的问题。

# java - （声码）需要一些帮助来寻找文字转语音插件

> ID：167325
> 
> 赞同：2
> 
> 时间：2008-10-03T15:07:37.950
> 
> 标签：java, flash, text-to-speech

我正在寻找一个可以语音说出字符的插件。它是用于非商业用途的，如果它可以发出更多的语言，比如亚洲、英语等，那就太好了……我用谷歌搜索了它，但似乎找不到任何免费使用的东西。

更新：这是供网络使用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T15:11:27.973

您可以尝试[http://espeak.sourceforge.net/](http://espeak.sourceforge.net/)并制作单词的 mp3，然后将其流式传输到 Flash 应用程序（您可以使用 darwin 进行流式传输）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-28T12:17:16.563

您可以使用 freetts1.2 API 将文本转换为 Java 中的语音。使用起来非常简单。此链接可能对您有用，它有一个示例程序。

[http://learnsharelive.blogspot.com/2011/01/convert-text-to-speech-java-freetts12.html](http://learnsharelive.blogspot.com/2011/01/convert-text-to-speech-java-freetts12.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T15:15:36.670

你在寻找什么是 ist [Sphinx4](http://cmusphinx.sourceforge.net/html/cmusphinx.php)。可以在[此处](http://www.voxforge.org/home/downloads)找到其他语言的一些自由语音模型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T17:40:01.137

关于 Java Text-to-Speech 引擎的类似问题被问到。查看问题[Java：文本到语音引擎概述](https://stackoverflow.com/questions/143390/java-text-to-speech-engines-overview#150278)，看看是否有任何响应有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T22:17:38.457

您不太可能找到 Actionscript 2.0 或 3.0 文本到语音代码库，因为声音合成只是在即将推出的 Flash Player 版本 10 中引入。

然而Java有很多，试试[这个](http://freetts.sourceforge.net/docs/index.php)，[这个](http://mary.dfki.de/)，甚至[那个](http://www.say-it-now.com/mainsite.htm)！

# design-patterns - 类数据职责

> ID：167330
> 
> 赞同：3
> 
> 时间：2008-10-03T15:08:25.997
> 
> 标签：design-patterns, class-design

我有一个“采购订单”课程。它包含有关单个采购订单的信息。我有一个用于数据库方法的 DAO 类。

负责加载和更新采购订单的方法的责任在哪里？

PurchaseOrder 类是否应该具有直接使用 DAO 类的“.update”、“insert”、“delete”和“.load”方法，或者 PurchaseOrder 类是否应该不了解 DAO 方法并具有管理这些方法的 POController 类互动？

用户一次只能处理一个 PurchaseOrder。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T15:13:04.397

采购订单应该不知道其持久性的细节。这就是拥有某种数据访问层的意义所在，它处理对象的管理，而对象本身可以专注于只是一个采购订单。

这也使系统更易于测试，因为您可以创建模拟采购订单并测试系统如何处理它们的逻辑，而不会陷入持久性问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T15:42:08.067

我会通过使 PurchaseOrder 成为接口并将所有 DAO 代码放入实现中来保持简单，然后使用工厂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T15:17:05.497

这取决于您认为您的应用程序将存在多长时间。我公司的金属切削应用程序自 1985 年以来一直在不断发展，并通过计算机架构的多次变化进行移植。在我们的例子中，我们几乎总是将事情推到接口（或使用您的术语的控制器类）后面，因为我们不知道 5、10、15 年后的事情状态。

通过使用控制器类，我们可以更改底层 API，而不会篡改上面的业务逻辑级别和 UI 调整。这些级别代表了多年的工作，因此保持他们的行为很重要。

请记住，您的项目将在生命周期中的大部分时间处于维护状态。您现在所做的任何使以后更改设计变得更容易的事情都将在以后节省大量时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T15:20:09.593

PurchaseOrder 类应该不知道 DAO。purchaseOrder 类应该代表数据本身，仅此而已。使用控制器或服务管理器或任何您想要调用它的东西来使用 DAO 持久/加载 PurchaseOrder 记录。这为您的设计提供了最大的灵活性。您有一个数据模型的位置，一个用于存储/检索 PurchaseOrders 的业务逻辑（控制器）的位置，以及一个实际持久化的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T16:24:32.630

让我带你了解我的推理：

**类方法**
基本原则：*持久性是一种类行为，应该是一种类方法*
你需要关注点分离，所以你把数据库的细节放在一个DAO类中，并使用类中的它来实现方法。
第一个问题：如果您需要支持不同的 DAO 集，您需要通过工厂创建它们。第二个问题：并非所有持久性行为都与类的实例特别相关。例如 List 和 Search 方法：它们返回类列表，而不是类，并且不依赖于实例。所以它们基本上是*静态*方法。
第三个问题：你想支持这个类的继承。因此，持久性细节因父母而异。如果您有静态方法，那将是一个问题。

所以你继续

**控制器**
基本原理：*持久化方法不属于单个类，它们更大，因此应该分开*
。再次需要关注点分离，因此需要DAO。这是一个 Utility 类，所以方法基本上都是*静态*的。
第一个问题：如果你想支持多个持久化方法，你需要一个工厂来创建 DAO。
第二个问题：你想支持类的层次结构，所以你不能使用静态类。您需要通过工厂生成控制器。
第三个问题：您正在向开发人员提供过于复杂的 API。
客户端代码示例：

```
PurchaseOrder po;
PurchaseOrderController poc;
poc = PurchaseOrderControllerFactory.Instance.Create();
po = poc.GetPurchaseOrder(42);
// do stuff
poc.SavePurchaseOrder(po); 
```

然后我会从头开始。

**Start from behaviours**
Basic principle: *Persistence is not a behaviour. Behaviours are larger than persistence.*
In your system there will be a Purchase Order subsystem. Your user will be able to interact with it only at high level (use case level). So,the methods will implement Purchase Order use cases. These methods will use DAOs, through a factory if needed, to access the database and do whatever they need to do.
In short, your PurchaseOrder is basically a DTO, a quick way of passing data around. It should not have behaviours.
Example of client code:

```
// It could be a factory if needed.
PurchaseOrderSystem pos = new PurchaseOrderSystem(); 

List<PurchaseOrder> transacted;
transacted = pos.TransactPurchaseOrders(john, 23);

// Show transacted purchase orders or whatever... 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-03T15:12:51.840

我肯定会将“业务逻辑”（PurchaseOrder）与数据库交互/访问分开。如果您转移到不同的供应商等，您将更容易对访问进行更改而不会潜在地干扰业务实施，而且您将更容易避免向数据库访问层添加行为。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-03T15:16:16.747

就个人而言，我会创建一个管理交互的对象。我不能为不将此逻辑放在 PurchaseOrder 类本身中提出强有力的理由，但创建此控制器对象会导致更松散耦合的对象。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-03T15:22:43.880

这里要考虑的关键是您将来可能想做的事情。也许你想用另一个替换你的数据库？这就是为什么您绝对应该将用于与数据库交互的代码与代表 PO 的类分开的原因。这是基本的职责分离，我希望你已经做到了。

现在的问题是：您是否想要第三个类（控制器）来管理 PO 和 DAO 类之间的交互？我认为这取决于您可以为 DAO 类创建接口的通用程度。如果 DAO 接口足够通用，您可以使用不同的存储机制编写插件替代它，但不更改接口，那么我会让 PO 类与之交互。如果没有，那么我会编写一个控制器类。

要考虑的另一件事是结构的其余部分。保存/加载从哪里开始？如果您要对 PO 进行大量操作（保存、加载、打印、发送给客户），那么拥有一个控制器来完成所有这些操作而不是将功能集成到 PO 类中可能是有意义的. 它为您提供了无需修改 PO 类即可添加 PO 操作的优势。

# c# - C# Lambda 表达式：我为什么要使用它们？

> ID：167343
> 
> 赞同：316
> 
> 时间：2008-10-03T15:11:14.527
> 
> 标签：c#, c#-3.0, lambda

我已经快速阅读了[Microsoft Lambda Expression](http://msdn.microsoft.com/en-us/library/bb397687.aspx)文档。

但是，这种示例帮助我更好地理解：

```
delegate int del(int i);
del myDelegate = x => x * x;
int j = myDelegate(5); //j = 25 
```

不过，我不明白为什么它是这样的创新。这只是“方法变量”结束时死亡的方法，对吗？为什么我要使用这个而不是真正的方法？

* * *

## 回答 #1

> 赞同：286
> 
> 时间：2008-10-03T15:20:38.860

[Lambda 表达式](http://weblogs.asp.net/scottgu/archive/2007/04/08/new-orcas-language-feature-lambda-expressions.aspx)是一种更简单的匿名委托语法，可以在任何可以使用匿名委托的地方使用。然而，事实并非如此。lambda 表达式可以转换为表达式树，这允许许多魔法，如 LINQ to SQL。

以下是使用匿名委托和 lambda 表达式的[LINQ to Objects](http://msdn.microsoft.com/en-us/library/bb397919.aspx)表达式的示例，以显示它们在视觉上是多么容易：

```
// anonymous delegate
var evens = Enumerable
                .Range(1, 100)
                .Where(delegate(int x) { return (x % 2) == 0; })
                .ToList();

// lambda expression
var evens = Enumerable
                .Range(1, 100)
                .Where(x => (x % 2) == 0)
                .ToList(); 
```

与编写单独的函数相比，Lambda 表达式和匿名委托有一个优势：它们实现了[闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))，允许您[将本地状态传递给函数，而无需向函数添加参数](http://www.srtsolutions.com/Looking-Inside-C-Closures)或创建一次性使用的对象。

[表达式树](http://www.interact-sw.co.uk/iangblog/2005/09/30/expressiontrees)是 C# 3.0 的一项非常强大的新功能，它允许 API 查看表达式的结构，而不仅仅是获取对可以执行的方法的引用。API 只需要将委托参数转换为`Expression<T>`参数，编译器将从 lambda 而不是匿名委托生成表达式树：

```
void Example(Predicate<int> aDelegate); 
```

称为：

```
Example(x => x > 5); 
```

变成：

```
void Example(Expression<Predicate<int>> expressionTree); 
```

后者将获得描述表达式的[抽象语法树](http://en.wikipedia.org/wiki/Abstract_syntax_tree)`x > 5`的表示。LINQ to SQL 依靠这种行为能够将 C# 表达式转换为服务器端过滤/排序等所需的 SQL 表达式。

* * *

## 回答 #2

> 赞同：138
> 
> 时间：2008-10-03T15:14:59.137

匿名函数和表达式对于无法从创建完整方法所需的额外工作中受益的一次性方法很有用。

考虑这个例子：

```
 List<string> people = new List<string> { "name1", "name2", "joe", "another name", "etc" };
 string person = people.Find(person => person.Contains("Joe")); 
```

相对

```
 public string FindPerson(string nameContains, List<string> persons)
 {
     foreach (string person in persons)
         if (person.Contains(nameContains))
             return person;
     return null;
 } 
```

这些在功能上是等效的。

* * *

## 回答 #3

> 赞同：84
> 
> 时间：2008-12-18T18:19:35.940

当我想使用另一个控件为某个控件的事件声明一个处理程序时，我发现它们很有用。要正常执行此操作，您必须将控件的引用存储在类的字段中，以便您可以在与创建它们不同的方法中使用它们。

```
private ComboBox combo;
private Label label;

public CreateControls()
{
    combo = new ComboBox();
    label = new Label();
    //some initializing code
    combo.SelectedIndexChanged += new EventHandler(combo_SelectedIndexChanged);
}

void combo_SelectedIndexChanged(object sender, EventArgs e)
{
    label.Text = combo.SelectedValue;
} 
```

感谢 lambda 表达式，您可以像这样使用它：

```
public CreateControls()
{
    ComboBox combo = new ComboBox();
    Label label = new Label();
    //some initializing code
    combo.SelectedIndexChanged += (s, e) => {label.Text = combo.SelectedValue;};
} 
```

容易得多。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2008-10-03T15:27:56.503

Lambda 清理了 C# 2.0 的匿名委托语法……例如

```
Strings.Find(s => s == "hello"); 
```

在 C# 2.0 中是这样完成的：

```
Strings.Find(delegate(String s) { return s == "hello"; }); 
```

从功能上讲，它们做的事情完全相同，只是语法更简洁。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2008-10-03T15:20:36.987

这只是使用 lambda 表达式的一种方式。**您可以在任何**可以使用委托的地方使用 lambda 表达式。这使您可以执行以下操作：

```
List<string> strings = new List<string>();
strings.Add("Good");
strings.Add("Morning")
strings.Add("Starshine");
strings.Add("The");
strings.Add("Earth");
strings.Add("says");
strings.Add("hello");

strings.Find(s => s == "hello"); 
```

此代码将在列表中搜索与单词“hello”匹配的条目。另一种方法是实际将委托传递给 Find 方法，如下所示：

```
List<string> strings = new List<string>();
strings.Add("Good");
strings.Add("Morning")
strings.Add("Starshine");
strings.Add("The");
strings.Add("Earth");
strings.Add("says");
strings.Add("hello");

private static bool FindHello(String s)
{
    return s == "hello";
}

strings.Find(FindHello); 
```

**编辑**：

在 C# 2.0 中，这可以使用匿名委托语法来完成：

```
 strings.Find(delegate(String s) { return s == "hello"; }); 
```

Lambda 显着清理了该语法。

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2008-10-09T14:23:47.067

Microsoft 为我们提供了一种更简洁、更方便的方式来创建称为 Lambda 表达式的匿名委托。**但是，该语句的表达式**部分并没有引起太多关注。Microsoft 发布了一个完整的命名空间[System.Linq.Expressions](http://msdn.microsoft.com/en-us/library/system.linq.expressions.aspx)，其中包含用于创建基于 lambda 表达式的表达式树的类。表达式树由表示逻辑的对象组成。例如，x = y + z 是一个表达式，它可能是 .Net 中表达式树的一部分。考虑以下（简单）示例：

```
using System;
using System.Linq;
using System.Linq.Expressions;

namespace ExpressionTreeThingy
{
    class Program
    {
        static void Main(string[] args)
        {
            Expression<Func<int, int>> expr = (x) => x + 1; //this is not a delegate, but an object
            var del = expr.Compile(); //compiles the object to a CLR delegate, at runtime
            Console.WriteLine(del(5)); //we are just invoking a delegate at this point
            Console.ReadKey();
        }
    }
} 
```

这个例子很简单。而且我敢肯定你在想，“这是没用的，因为我可以直接创建委托，而不是创建表达式并在运行时编译它”。你是对的。但这为表达式树提供了基础。表达式命名空间中有许多可用的表达式，您可以构建自己的。我认为您可以看到，当您在设计或编译时不确切知道算法应该是什么时，这可能很有用。我在某处看到了一个使用它来编写科学计算器的示例。您也可以将其用于[贝叶斯](http://en.wikipedia.org/wiki/Bayesian_probability)系统或[遗传编程](http://en.wikipedia.org/wiki/Genetic_programming)（人工智能）。在我的职业生涯中，有几次我不得不编写类似于 Excel 的功能，允许用户输入简单的表达式（加法、减法等）来对可用数据进行操作。在 .Net 3.5 之前的版本中，我不得不求助于 C# 之外的一些脚本语言，或者不得不在反射中使用代码生成功能来动态创建 .Net 代码。现在我会使用表达式树。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2008-10-03T15:14:24.363

它避免了必须在远离它们使用的地方定义的特定地方只使用一次的方法。良好的用途是作为通用算法（例如排序）的比较器，然后您可以在其中定义自定义排序函数，在其中调用排序而不是更远地迫使您查看其他地方以查看您正在排序的内容。

这并不是真正的创新。LISP 已经拥有 lambda 函数大约 30 年或更长时间了。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-01-07T10:25:56.273

您还可以在编写泛型代码以作用于您的方法时发现使用 lambda 表达式。

例如：计算方法调用所用时间的通用函数。（即`Action`在这里）

```
public static long Measure(Action action)
{
    Stopwatch sw = new Stopwatch();
    sw.Start();
    action();
    sw.Stop();
    return sw.ElapsedMilliseconds;
} 
```

您可以使用 lambda 表达式调用上述方法，如下所示，

```
var timeTaken = Measure(() => yourMethod(param)); 
```

表达式允许您从方法和输出参数中获取返回值

```
var timeTaken = Measure(() => returnValue = yourMethod(param, out outParam)); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-03T15:19:16.023

Lambda 表达式是一种表示匿名方法的简洁方式。匿名方法和 Lambda 表达式都允许您内联定义方法实现，但是，匿名方法明确要求您定义方法的参数类型和返回类型。Lambda 表达式使用 C# 3.0 的类型推断功能，它允许编译器根据上下文推断变量的类型。这非常方便，因为这样可以节省我们大量的打字时间！

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-12-20T13:01:05.513

lambda 表达式就像是代替委托实例编写的匿名方法。

```
delegate int MyDelagate (int i);
MyDelagate delSquareFunction = x => x * x; 
```

考虑 lambda 表达式`x => x * x;`

> 输入参数值为x（=>左侧）
> 
> 函数逻辑是x * x（在=>的右边）

lambda 表达式的代码可以是语句块而不是表达式。

```
x => {return x * x;}; 
```

**例子**

注意：`Func`是一个预定义的通用委托。

```
 Console.WriteLine(MyMethod(x => "Hi " + x));

    public static string MyMethod(Func<string, string> strategy)
    {
        return strategy("Lijo").ToString();
    } 
```

**参考**

1.  [委托和接口如何互换使用？](https://stackoverflow.com/questions/2012095/c-sharp-how-can-a-delegate-interface-method-interchangable/20703787#20703787)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-03T15:14:21.337

很多时候，您只在一个地方使用该功能，因此创建一个方法只会使类变得混乱。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-03T15:19:00.390

这是一种进行小操作并将其放置在非常靠近使用位置的方式（与声明靠近其使用点的变量不同）。这应该使您的代码更具可读性。通过匿名化表达式，如果该函数在其他地方使用并被修改以“增强”它，那么您也使某人更难破坏您的客户端代码。

同样，为什么需要使用foreach？您可以在 foreach 中使用普通的 for 循环或直接使用 IEnumerable 来完成所有操作。答：您*不需要*它，但它使您的代码更具可读性。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-08-21T14:56:37.207

创新在于类型安全性和透明度。尽管您没有声明 lambda 表达式的类型，但它们是推断出来的，并且可以被代码搜索、静态分析、重构工具和运行时反射使用。

例如，在您可能使用过 SQL 并可能受到 SQL 注入攻击之前，因为黑客在通常期望数字的地方传递了一个字符串。现在您将使用 LINQ lambda 表达式，该表达式受到保护。

不可能在纯委托上构建 LINQ API，因为它需要在评估它们之前将表达式树组合在一起。

2016 年，大多数流行语言都支持[lambda 表达式](http://dobegin.com/lambda-functions-everywhere/)，而 C# 是主流命令式语言中这一演变的先驱之一。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-03-19T22:40:36.580

这也许是关于为什么使用 lambda 表达式的最佳解释 -> [https://youtu.be/j9nj5dTo54Q](https://youtu.be/j9nj5dTo54Q)

总之，它是为了提高代码的可读性，通过重用而不是复制代码来减少出错的机会，并利用幕后发生的优化。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-02-22T15:15:24.367

lambda 表达式和匿名函数的最大好处是它们允许库/框架的客户端（程序员）通过给定库/框架中的代码注入功能（因为它是 LINQ、ASP.NET Core 和许多其他人）以常规方法无法做到的方式。然而，对于单个应用程序程序员来说，它们的优势并不明显，但对于创建库的人来说，这些库稍后将被其他想要配置库代码行为的人或使用库的人使用。因此，有效使用 lambda 表达式的上下文是库/框架的使用/创建。

此外，由于它们描述了一次性使用代码，因此它们不必成为会导致更多代码复杂性的类的成员。想象一下，每次我们想要配置类对象的操作时，都必须声明一个焦点不明确的类。

# svn - 如何查看两次修订之间更改了哪些文件？

> ID：167371
> 
> 赞同：21
> 
> 时间：2008-10-03T15:16:11.410
> 
> 标签：svn, tortoisesvn

我只想看看在 2 个任意修订之间修改/添加/删除了哪些文件。我该怎么做呢？

我也可以在乌龟身上这样做吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-03T15:17:55.323

```
svn log -v -rX:Y . 
```

“详细”开关的 -v 将为您提供有关哪些文件在该修订版中受到影响的详细输出。

注意 ”。” 假设您当前位于工作副本目录中，但您也可以使用诸如“ [http://svn.myawesomesoftwareproject.com/trunk/lib/foo.c](http://svn.myawesomesoftwareproject.com/trunk/lib/foo.c) ”之类的 URL。

可以通过键入“svn help log”或阅读免费在线获得的[SVN Book找到此信息。](http://svnbook.red-bean.com/)不要**忘记**阅读**友好**手册！**_** _ **_**

 ******* * *

## 回答 #2

> 赞同：30
> 
> 时间：2011-04-20T20:56:29.803

如果您想要一个没有时间和提交消息的简明文件列表，您可以这样做：

```
svn diff -r X:Y --summarize 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-03T15:18:43.950

右键单击包含您的存储库的目录。选择 SVN 显示日志。Control+单击这两个修订。右键单击一个并选择比较修订。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-09T20:24:29.773

svn diff -r "start_revision_number":"end_revision_number" "url_of_svn_repo" --summarize

然后将其通过管道传递给 grep ^AD 或 M

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T15:19:20.000

[像这样](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-diff.html#tsvn-dug-compare-revs)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T15:23:57.853

如果您是源代码控制和 SVN 的新手，您可能想要学习[实用](http://www.pragprog.com/titles/svn/pragmatic-version-control-using-subversion)的 SVN 版本控制。它解释了许多概念和命令。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-14T12:59:14.697

这在 Windows 上对我有用

1.  转到您拥有存储库的文件夹，
2.  右键单击并选择 SVN 显示日志，
3.  在对话框中有一个“显示范围”按钮，单击它并填写*Start Revision* = {your revision} 和*End Revision* = {your revision}
4.  根据需要选择开始和日期范围

注意：{您的修订版}=提供至少一个文件更改的修订版号。与该修订相关的所有文件都应列出。

# visual-studio - 只有在构建成功的情况下才能在 Visual Studio 中启动生成文件的任何巧妙方法？

> ID：167388
> 
> 赞同：3
> 
> 时间：2008-10-03T15:20:19.313
> 
> 标签：visual-studio, build-process, makefile

我们有一个在构建过程中最后构建的 makefile，它使用 Visual Studio 启动我们的单元测试。不幸的是，如果构建失败，makefile 仍然会被处理，并且我们会有额外的（烦人的）错误。有什么办法可以防止吗？

示例项目 A：构建 dummy.exe 项目 B（makefile）：构建命令是：运行 dummy.exe /unittest

当项目 A 出现构建错误时，我们希望项目 B 跳过其构建命令。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T15:26:25.243

将项目 B（您的 makefile 项目）设置为依赖于项目 A。这样，项目 B 将始终在构建项目 A 之前尝试构建项目 A。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T15:24:30.083

转到项目属性。我假设您已经在“构建后事件命令行”框中有一些东西？有一个“运行构建后事件”组合框，将其设置为“成功构建”。

那是你要找的吗？

# lisp - Lisp 网络框架？

> ID：167397
> 
> 赞同：60
> 
> 时间：2008-10-03T15:22:20.137
> 
> 标签：lisp, scheme, guile

各种 LISP 风格的流行（好吧，流行是相对的）Web 框架是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-03T18:04:46.657

[PLT Scheme](http://racket-lang.org/)具有[内置的、基于延续的 Web 服务器](http://docs.racket-lang.org/web-server/)。

更新：PLT 方案现在称为 Racket。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-03T16:32:49.400

[Hunchentoot](http://weitz.de/hunchentoot/)也相当普遍

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-03T16:46:29.717

什么是微区块？

Weblocks 是一个基于 continuation 的 Web 框架，用 Common Lisp 编写。

[http://common-lisp.net/project/cl-weblocks/](http://common-lisp.net/project/cl-weblocks/)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-05T15:14:33.253

大多数（也许是全部）著名的 Common Lisp Web 框架已经被提及，所以我将添加一些评论。

Hunchentoot 并不是大多数人所说的“网络框架”。它是一个 HTTP 服务器（非常好的一个）。

Drew Crampsie 的“Lisp on Lines”看起来很有前途，但我不确定它有多远。我一直在等待听到一个通知。

Marco Baringer 的 UnCommon Web 在许多著名的 CL 实现上运行：Allegro CL、CMUCL、Clozure CL（以前称为 OpenMCL）、GNU clisp 和 SBCL。唯一缺少的主要是 LispWorks。我不知道这是否意味着它没有经过测试可以工作，或者已知不工作，或者什么；但如果它在所有其他方言上运行，它可能很容易让它在任何其他方言上运行。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-27T14:57:22.290

对于[Clojure](http://clojure.org)，您可以尝试[Compojure](http://github.com/weavejester/compojure)。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-30T08:14:10.590

**通用 Lisp**

已经提到了很多常见的嫌疑人（Hunchentoot、UCW、LoL）。Franz 使 Allegro Common Lisp 可用（并移植到其他 Lisp）：

*   在较低级别（自己处理 HTTP 请求），[AllegroServe](http://opensource.franz.com/aserve/)。
*   在更高级别（更多的是“框架”），[WebActions](http://opensource.franz.com/aserve/aserve-dist/webactions/doc/webactions.html)。

两者都是开源的。我倾向于使用 AllegroServe，根据需要将实用程序分解出来，但有些人真的很喜欢 WebActions。

我使用[Araneida](http://www.cliki.net/araneida)已经有一段时间了，我更喜欢它的风格而不是 AllegroServe，但它自 2006 年以来就没有得到维护。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-16T20:03:04.613

我已经非常广泛地搜索了一个好的 Lisp 网络框架，但我发现它们都有些难以访问。UCW 的架构对我来说似乎不是很自然（我不记得为什么；我已经有一段时间没有研究它了），并且不再维护 KPAX（我认为）。

Symbolic web 看起来很有趣，我认为 Weblocks 是最有趣的，但是 Weblocks 没有很好的文档记录，对新手来说可能会很吓人。我上次看时 SymbolicWeb 还不成熟，但从那时起它可能已经成长了一些。[功能](http://groups.google.com/group/symbolicweb/web/features)页面今天看起来不错。

您可以采取不同的方法。如果你想要一个纯粹的 lisp 方法，那么你可以：

*   如果您可以熟练阅读代码并理解延续，您可以尝试使用 Hunchentoot 后端的 Weblocks（Weblocks 依赖于尚未抽象的 Hunchentoot）。一两个月内应该会有一本真正的用户手册，但与任何 OSS 项目一样，这样的承诺都是粗略的。
*   同样，您可以尝试 SymbolicWeb。[**更新**：没关系，这个项目已经没有了]
*   滚动你自己的。说真的 - 有 cl-who 可以帮助生成 HTML，有可用的 javascript 和 json 库，usockets、lephant、cl-sql、hunchentoot、aserve，以及许多可以一起烘焙的实用程序库。

如果您对混合方法感到满意，这是我目前正在试验的东西：我已经为 Qooxdoo 编写了一个 Lisp JSON-RPC 后端，因此我可以通过像 Cherokee 和让 Cherokee 尽可能多地连接到在 Lisp 中运行的后端 json-rpc 服务器。非常非常可扩展。我远未弄清楚问题和挑战，但开始工作非常简单。json 库让后端工作变得非常简单——我认为 Qooxdoo 本身实际上更难（但我真的不是 JS 开发人员）。

我还将检查 allegro 的 WebActions，因为付费支持的可用性具有一定的吸引力——更不用说 Allegro 可能是可用的最佳 CL 实现（他的 Kennyness 使用它:-)）。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-10-03T16:10:13.517

UnCommonWeb (UCW) 经常被提及[http://www.common-lisp.net/project/ucw/——](http://www.common-lisp.net/project/ucw/) 它不是目前流行的 REST，更像是 Smalltalk 的 SeaSide（但话又说回来，SeaSide 相当时尚）。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-10-03T16:49:28.773

Lisp-on-lines 是一个建立在 CLSQL 和 UCW 之上的 Web 应用程序框架，它提供了在许多方面类似于 Ruby on Rails 的应用程序开发模型。现在可以在[http://versions.tech.coop/lisp-on-lines/](http://versions.tech.coop/lisp-on-lines/)找到它。

[http://www.cliki.net/lisp-on-lines](http://www.cliki.net/lisp-on-lines)

[http://kevin.casa.cavewallarts.com/LISP/LOL/lol.html](http://kevin.casa.cavewallarts.com/LISP/LOL/lol.html)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-10-03T15:25:07.383

[左括号](http://blog.leftparen.com/)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-27T14:58:15.910

对于[Clojure](http://clojure.org)，您可以尝试[Webjure](http://code.google.com/p/webjure/)。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2012-09-04T05:30:32.090

我刚刚为 common lisp 发现了一个名为 Clack 的 Web 框架，并且发现它很容易上手。

见[http://clacklisp.org/](http://clacklisp.org/)

引用它的网站“Clack 是受 Python 的 WSGI 和 Ruby 的 Rack 启发的 Common Lisp 的 Web 应用程序环境。”

Caveman 是一个基于 Clack 的微型 Web 框架。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-03T16:41:49.960

另一个很酷（但远非“流行”）的东西是 SymbolicWeb—— [http ://groups.google.com/group/symbolicweb](http://groups.google.com/group/symbolicweb)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-05-13T19:41:17.837

**回复：** SymbolicWeb（及其夸张的消亡）

[Gitorious](http://gitorious.org/ "狡猾的")上的[SymbolicWeb 项目页面](http://gitorious.org/symbolicweb "Gitorious 上的 SymbolicWeb 项目页面")和[Wikipedia](http://wikipedia.org/ "维基百科")上的[SymbolicWeb 文章](http://en.wikipedia.org/wiki/SymbolicWeb "维基百科上的 SymbolicWeb 文章")。Google Groups 页面肯定已经死了（并且未归档？，），但 Gitorious 树显示最近的签到日期为[2010 年 4 月 29 日](http://gitorious.org/symbolicweb/symbolicweb/commit/07a9cfeb8f567b43864f2e6515d3377154e852e7 "2010 年 4 月 29 日 05:00 - Lars Rune Nøstdal：“更新一些示例……”")。项目页面还提到“[一些正在运行的示例](http://nostdal.org/ "一些运行示例")”在[nostdal.org](http://nostdal.org/ "一些运行示例")上“偶尔可用” （在我写这篇文章时这是无法访问的，加强了“偶尔”限定词:-)。）

（**注意：**我不是 SymbolicWeb 用户。我只是在阅读此线程时跟踪了 SymbolicWeb 链接。）

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-11-19T16:14:34.930

Restas 是另一个最近更新的 Web 框架：

[http://restas.lisper.ru/en/](http://restas.lisper.ru/en/)

其概述

```
RESTAS is a Common Lisp web application framework. Its key features are:

RESTAS was developed to simplify development of web applications following the REST architectural style.

RESTAS is based on the Hunchentoot HTTP server. Web application development with RESTAS is in many ways simpler than with Hunchentoot, but some knowledge of Hunchentoot is required, at least about working with hunchentoot:*request* and hunchentoot:*reply*.

Request dispatch is based on a route system. The route system is the key concept of RESTAS and provides unique features not found in other web frameworks.

The other key RESTAS concept is its module system, which provides a simple and flexible mechanism for modularized code reuse.

Interactive development support. Any RESTAS code (such as the definition of a route, a module or a submodule) can be recompiled at any time when you work in SLIME and any changes you made can be immediately seen in the browser. No web server restart or other complicated actions are needed.

SLIME integration. The inner structure of a web application can be investigated with the standard "SLIME Inspector." For example, there is a "site map" and a simple code navigation with this map.

Easy to use, pure Lisp web application daemonization facility based on RESTAS and SBCL in Linux without the use of Screen or detachtty.

RESTAS is not an MVC framework, although it is not incompatible with the concept. From the MVC point of view, RESTAS provides the controller level. Nevertheless, RESTAS provides an effective and flexible way for separation of logic and representation, because it does not put any constraints on the structure of applications. Separation of model and controller can be effectively performed with Common Lisp facilities, and, hence, doesn't need any special support from the framework.

RESTAS does not come with a templating library. cl-closure-template and HTML-TEMPLATE are two good templating libraries that can be used with RESTAS. 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-08-31T09:20:53.623

这个问题有点老了，但我想我会分享我最近的发现：基于 Scheme 并且相当完整的[Hop 语言。](http://hop.inria.fr/)

> HOP 是一种用于 Web 2.0 和所谓的扩散 Web 的多层编程语言。它专为多媒体（网络画廊、音乐播放器等）、无处不在的家庭自动化（智能手机、个人电器）、混搭、办公室（网络议程、邮件客户端、... ）， ETC。
> 
> 跳的特点：
> 
> *   一组广泛的小部件，用于编写精美和可移植的 Web GUI，
> *   与传统 Web 技术（JavaScript、HTML、CSS）完全兼容，
> *   HTML5 支持，支持 HTTP/1.0 和 HTTP/1.1 的多功能 Web 服务器，
> *   支持无处不在的 Web 多媒体应用程序的原生多媒体支持，
> *   快速 WebDAV 1 级支持，
> *   用于服务器代码的优化本机代码编译器，
> *   用于客户端代码的即时 JavaScript 编译器，
> *   用于邮件、日历、数据库、电话、...的大量库

# eclipse - IntelliJ Idea 用户的 Eclipse

> ID：167400
> 
> 赞同：12
> 
> 时间：2008-10-03T15:22:51.990
> 
> 标签：eclipse, intellij-idea, switch-statement, transition

我有一位同事希望从 InteilliJ Idea 切换到 Eclipse，并且担心不知道 Eclipse 的命令集。

我想知道 - 有没有人可以链接到可以将 Eclipse 命令设置为至少与 Idea 匹配的键盘映射？

你做过这个开关吗？我们应该注意的任何“陷阱”、提示或信息？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-10-18T11:57:16.427

我自己经历了这段经历——结果是我博客上的一系列文章：

*   [http://virgo47.wordpress.com/2011/01/30/eclipse-vs-intellij-idea/](http://virgo47.wordpress.com/2011/01/30/eclipse-vs-intellij-idea/)
*   [http://virgo47.wordpress.com/2011/02/22/from-intellij-idea-to-eclipse-2/](http://virgo47.wordpress.com/2011/02/22/from-intellij-idea-to-eclipse-2/)
*   [http://virgo47.wordpress.com/2011/03/24/from-intellij-idea-to-eclipse-3/](http://virgo47.wordpress.com/2011/03/24/from-intellij-idea-to-eclipse-3/)
*   [http://virgo47.wordpress.com/2011/02/28/why-to-synchronize-with-svn-in-eclipse/](http://virgo47.wordpress.com/2011/02/28/why-to-synchronize-with-svn-in-eclipse/)
*   [http://virgo47.wordpress.com/2011/04/10/from-intellij-idea-to-eclipse-4/](http://virgo47.wordpress.com/2011/04/10/from-intellij-idea-to-eclipse-4/)
*   [http://virgo47.wordpress.com/2011/06/28/from-intellij-idea-to-eclipse-5/](http://virgo47.wordpress.com/2011/06/28/from-intellij-idea-to-eclipse-5/)

他们都偏向于 Idea（显然），但充满了相关的 Idea-Eclipse 比较、键盘快捷键、小故事和观察。总的来说，它们都是非常好的 IDE，但如果 IDEA 是 100%，Eclipse 是 90%，甚至可能是 95%——最大的区别是：

*   需要不同的心态，项目、模块、工作区可能意味着不同的东西，或者根本没有在一个或另一个 IDE 中使用，您在 Eclipse 中拥有/需要 Perspectives，而不是在 IDEA 中等等......
*   IDEA 中默认 Maven/SVN 支持的质量更好（它也是内置的），更流畅，问题更少 + IDEA 中的 3way diff 非常棒，通常 Eclipse 家伙害怕合并 - 现在我明白了为什么
*   IDEA 更加精致，图形故障更少，突出显示的默认颜色更好，等等。
*   IDEA 的免费版本没有 Eclipse 拥有的所有可能的免费插件那么多的东西 - Eclipse 插件生态系统是如此之大！
*   IDEA 在完成、重构和其他小事情方面更聪明，IDEA 自 2000 年以来一直是同类产品中的佼佼者

我很幸运，我最终不必进行转换，因为我们使用的 Maven 项目在两个 IDE 中都能正常工作。但是我仍然将 Eclipse 用于其他项目（xtext）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-13T17:18:00.057

[从这里](http://www.jroller.com/santhosh/entry/intellij_idea_key_scheme_for)获取插件。它似乎比 Bartosz 的答案更容易安装，而且没有 404s ......

对于懒惰的人：[直接链接到插件](http://jroller.com/santhosh/resource/IdeaKeyScheme_1.0.0.jar)

将插件 jar 放入 eclipse/plugins 文件夹并重新启动 eclipse。现在在 General > Keys 下的首选项对话框中，您可以找到“Intellij Idea”键方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T15:35:16.897

如果他确实想这样做：

[http://www.jroller.com/ervines/resource/eclipse-intellij-key-bindings.java](http://www.jroller.com/ervines/resource/eclipse-intellij-key-bindings.java)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-05-07T02:25:08.337

在回答 Bartosz 时，flash builder 是一个很好的理由，直到 jetbrains 推出可视化 mxml 编辑器。

上面发布的直接链接已过时，版本在这里：[http ://code.google.com/p/ideakeyscheme/updates/list](http://code.google.com/p/ideakeyscheme/updates/list)

更新：也找到了这个：[http](http://www.bharathganesh.com/idea-prefs.php) ://www.bharathganesh.com/idea-prefs.php ，虽然它的描述很简单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-10-14T19:09:34.863

我可以列出一堆技巧、陷阱等，因为我已经切换了好几次了。我曾多次尝试切换到 Eclipse，但无法做到，于是又回到了 IntelliJ。

第一个提示：
Intellj“项目”-> Eclipse“工作区” Intellij“模块”-> Eclipse“项目”

第二个提示：Eclipse 有“透视图”的概念，这意味着当你在做不同的事情时它会围绕你的 UI 重新洗牌，比如调试时有调试透视图。我不太明白这一点，我个人更喜欢窗口的概念，或者停靠在底部或侧面的工具窗口。

# codeigniter - 如何从 CodeIgniter 中时间跨度（）的输出中获取“年份”部分？

> ID：167406
> 
> 赞同：2
> 
> 时间：2008-10-03T15:23:59.023
> 
> 标签：codeigniter, timespan

我有一个“出生日期”字段，并尝试使用该`timespan()`方法来获取年龄。但返回“28 年、2 个月、2 周、3 天、15 小时、16 分钟”。

知道如何才能获得“28 年”部分吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-23T11:16:26.553

我建议你使用 PHP 的 strftime() 函数。而不是使用 CI 的时间跨度（）。

`echo strftime('%Y', 1226239392);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T15:36:05.537

## 有很多方法可以做到这一点，使用 $date 中的字符串，如下所示：

```
$date = '28 Years, 2 Months, 2 Weeks, 3 Days, 15 Hours, 16 Minutes'; 
```

这会给你“28年”

```
$yearsPart = substr($date, 0, strpos($date, 'Years') + 5); 
```

这也会：

```
$parts = split(', ', $date);
$yearsPart = $parts[0]; 
```

# svn - 颠覆和修订工程——最好的网络资源是什么？

> ID：167413
> 
> 赞同：0
> 
> 时间：2008-10-03T15:25:23.530
> 
> 标签：svn, revision

我们正在从 CVS 迁移到 SVN，并采用某种修订管理来强制执行开发/测试/发布周期的顺序。我们目前正在同一代码行上进行测试、开发和发布，我们知道这是一种不好的做法，我们希望结束它。

你有什么经验，知道如何使用源代码树的建议。

我们正在构建小型/平均（2-5 个月）定制项目，我们必须尽早让客户进行审查。需求蠕变很常见。

编辑：请注意，我不仅需要关于颠覆的建议，还需要更多关于整个开发/测试/部署周期如何反映在主干/分支/标签/版本等方面的建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T15:39:35.357

*   “早分支，常分支。”
*   所有构建都应该是完全可重现的，而不必通过日志倾倒（考虑标记每个构建）
*   如果您使用问题跟踪器，则要求所有签入在提交消息中包含一个（有效）问题 ID（添加一个预挂钩来检查这一点）。
*   只应允许构建团队创建生产分支（应鼓励开发人员为任何重要的任务创建个人分支）
*   持续构建并确保每个人都意识到破坏构建是一件大事。
*   阅读整个 SVN 书籍，然后再阅读一遍。您需要前后了解此工具。为您的开发人员举办培训课程（“如何为我的工作创建临时分支”、“如何合并”等）。

......关于这个主题缺乏好的阅读，但如果我不得不向 SCM 中完全绿色的商店推荐一本书，那将是 Vincent Maraia 的“The Build Master”。它的细节非常简短，但易于阅读，并提供了（非常非常简短的）SCM 好想法的概述，一旦您了解它们就会非常有意义，但由于某种原因，许多商店完全缺乏这些想法。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T15:41:19.363

Subversion 使得分支比 CVS 更容易（在[GIT](http://git.or.cz/)分支中甚至更便宜）。我建议您为主要修订创建分支，并计划将分支合并回主干。 *请注意不要长时间不合并回分支*，因为等待的时间越长，它就会变得越来越困难。

如果您需要快速起步，并且不想管理所有服务器/设置内容，那么还有一些服务可以提供集成的错误跟踪/部署等：

*   [http://beanstalkapp.com/](http://beanstalkapp.com/)
*   [http://unfuddle.com/](http://unfuddle.com/)
*   [http://www.assembla.com/](http://www.assembla.com/)

**一些资源：**

**这本书回答了我最初的很多问题：http:**
[//www.pragprog.com/titles/svn/pragmatic-version-control-using-subversion](http://www.pragprog.com/titles/svn/pragmatic-version-control-using-subversion)

**在 stackoverflow 上进一步搜索：**
[TortoiseSVN 的良好分支和合并教程？](https://stackoverflow.com/questions/90/good-branchmerge-tutorials-for-tortoise-svn)

**Cal Henderson（Flickr.com 的开发人员）**我参加的迈阿密 FOWA 演讲：http:
[//cdn4.libsyn.com/carsonsystems/Cal_Henderson.mp3](http://cdn4.libsyn.com/carsonsystems/Cal_Henderson.mp3)

**颠覆的免费“圣经”（合并章节）**：
[http ://svnbook.red-bean.com/en/1.1/ch04.html](http://svnbook.red-bean.com/en/1.1/ch04.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T16:53:48.747

一个非常好的源代码控制资源：

*   [敏捷版本控制](http://www.infoq.com/articles/agile-version-control)

# windows - Windows 上是否可以进行原子文件重命名（带覆盖）？

> ID：167414
> 
> 赞同：77
> 
> 时间：2008-10-03T15:25:25.433
> 
> 标签：windows, winapi, posix

在 POSIX 系统上 rename(2) 提供原子重命名操作，包括在目标文件存在且权限允许的情况下覆盖目标文件。

有没有办法在 Windows 上获得相同的语义？我知道 Vista 和 Server 2008 上的 MoveFileTransacted()，但我需要它来支持 Win2k 及更高版本。

这里的关键词是*原子*的……解决方案不能以任何方式失败，从而使操作处于不一致的状态。

我看到很多人说这在win32上是不可能的，但我问你，真的吗？

如果可能，请提供可靠的引用。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2010-03-03T01:56:24.173

参见`ReplaceFile()`Win32 ( [http://research.microsoft.com/pubs/64525/tr-2006-45.pdf](http://research.microsoft.com/pubs/64525/tr-2006-45.pdf) )

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-03T15:55:50.317

Win32 不保证原子文件元数据操作。我会提供引文，但没有——没有书面或书面保证的事实同样重要。

您将不得不编写自己的例程来支持这一点。很不幸，但你不能指望 win32 提供这种级别的服务——它根本不是为它设计的。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-19T00:49:15.930

在 Windows Vista 和 Windows Server 2008 中添加了原子移动函数 - MoveFileTransacted()

不幸的是，这对旧版本的 Windows 没有帮助。

[MSDN 上的有趣文章](http://blogs.msdn.com/adioltean/archive/2005/12/28/507866.aspx)。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2018-08-08T01:53:05.747

从 Windows 10 1607 开始，NTFS 确实支持原子取代重命名操作。要执行此调用`NtSetInformationFile(..., FileRenameInformationEx, ...)`并指定`FILE_RENAME_POSIX_SEMANTICS`标志。

或者等效地在 Win32 调用中`SetFileInformationByHandle(..., FileRenameInfoEx, ...)`指定`FILE_RENAME_FLAG_POSIX_SEMANTICS`标志。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-03T15:39:18.137

您仍然可以在 Windows 上调用 rename() ，尽管我想在不知道您正在使用的文件系统的情况下无法做出您想要的保证 - 例如，如果您使用的是 FAT，则无法保证。

但是，您可以使用 MoveFileEx 并使用 MOVEFILE_REPLACE_EXISTING 和 MOVEFILE_WRITE_THROUGH 选项。后者在 MSDN 中有这样的描述：

> 设置此值可确保在函数返回之前将作为复制和删除操作执行的移动刷新到磁盘。刷新发生在复制操作结束时。

我知道这不一定与重命名操作相同，但我认为这可能是你能得到的最好保证——如果它是为了文件移动，它应该是为了更简单的重命名。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-08-05T12:13:56.733

MSDN 文档避免明确说明哪些 API 是原子的，哪些不是，但 Niall Douglas 在他的[Cppcon 2015 演讲](https://www.youtube.com/watch?v=uhRWMGBjlO8)中指出，唯一的原子函数是

[按句柄设置文件信息](https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-setfileinformationbyhandle)

设置`FILE_RENAME_INFO.ReplaceIfExists`为真。它从 Windows Vista / 2008 Server 开始可用。

Niall 是一个高度复杂的[LLFIO 库](https://ned14.github.io/llfio/)的作者，并且是文件系统竞争条件方面的专家，所以我相信如果你正在编写一个原子性至关重要的算法，最好是安全而不是抱歉，并使用建议的函数，即使`ReplaceFile`'s中没有任何内容描述表明它不是原子的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-07-01T01:03:09.677

相当多的答案，但不是我所期望的......我有这样的理解（也许是错误的），只要正确的星对齐，使用标志，并且源文件系统与目标文件系统相同，MoveFile*可以是*原子的. 否则，操作将退回到[复制->删除]文件。

鉴于; 我也了解到 MoveFile - 当它是原子的时 - 只是设置文件信息，这也可以在这里完成：[setfileinfobyhandle](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365539(v=vs.85).aspx)。

[有人做了一个名为“ Racing the Filesystem](https://github.com/CppCon/CppCon2015/blob/master/Tutorials/Racing%20the%20Filesystem/Racing%20the%20Filesystem%20-%20Niall%20Douglas%20-%20CppCon%202015.pdf) ”的演讲，对此进行了更深入的讨论。（大约 2/3 下他们谈论原子重命名）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-04-01T04:22:26.047

有[std::rename](https://en.cppreference.com/w/cpp/io/c/rename)并从[C++17](https://en.wikipedia.org/wiki/C%2B%2B17) [std::filesystem::rename](https://en.cppreference.com/w/cpp/filesystem/rename)开始。如果destination存在于`std::rename`：

> 如果 new_filename 存在，则行为是实现定义的。

但是，POSIX [rename](https://pubs.opengroup.org/onlinepubs/009695399/functions/rename.html)[需要以原子方式替换现有文件](https://pubs.opengroup.org/onlinepubs/009695399/functions/rename.html#tag_03_608_08)：

> 对于常规文件，此 rename() 函数等效于 ISO C 标准定义的文件。它在这里的包含扩展了该定义以包括对目录的操作，并指定新参数命名已存在的文件时的行为。该规范要求函数的操作是原子的。

值得庆幸的是，`std::filesystem::rename`它要求它的行为就像 POSIX：

> 将由 old_p 标识的文件系统对象移动或重命名为 new_p，就像通过 POSIX 重命名一样

但是，当我尝试调试时，似乎`std::filesystem::rename`VS2019（截至 2020 年 3 月）实现的只是调用[MoveFileEx](https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-movefileexa)，在某些情况下这不是原子的。因此，可能，当其实现中的所有错误都得到修复时，我们将看到可移植的 atomic `std::filesystem::rename`。

# debugging - 使用 .Net Framework 源码调试

> ID：167415
> 
> 赞同：0
> 
> 时间：2008-10-03T15:25:31.393
> 
> 标签：debugging, .net-3.5

我在 XsltCompiledTransform 深处遇到了一个空对象异常，我想使用[.Net Framework Source 调试](http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx)功能来查看未初始化的内容，但即使按照启用它的说明进行操作，我也不能弄清楚如何进入 .Transform() 方法并开始探索。

我在网上找到的教程说您可以在调试时使用“调用堆栈”窗口加载框架库的符号，但是当调用堆栈尚未包含您要调试的库时，这没有用。我也尝试从“模块”窗口加载符号，但 Step-Into 仍然不起作用。

System.Xml.Xslt 命名空间源甚至可以在调试时进入吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-06T13:38:30.483

如果您无法即时获取源代码，您可能需要尝试[.NET Mass Downloader](http://www.codeplex.com/NetMassDownloader)

看起来，包含 XsltCompiledTransform 的源代码。

# sql - 在两个表之间共享自增主键

> ID：167416
> 
> 赞同：10
> 
> 时间：2008-10-03T15:25:48.380
> 
> 标签：sql, sql-server

嗨，我希望有两个表，每个表都有一个 INT“id”列，它将自动递增，但我不希望任何一个“id”列共享相同的数字。这叫什么，最好的方法是什么？顺序？迭代器？指数？增量器？

动机：我们正在从一个模式迁移到另一个模式，并且有一个网页可以读取两个表并显示（int）ID，但我不能为两个表使用相同的 ID。

我正在使用 SQL Server 9.0.3068。

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-03T15:48:36.323

只需将标识增量配置为 >1，例如表一使用 IDENTITY (1, 10) [1,11,21...]，表二使用 IDENTITY (2, 10) [2,12,22...]。如果以后需要，这也将为您提供一些扩展空间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T15:26:40.687

如果我理解正确，我认为使用[GUID将是最直接的方法。](http://en.wikipedia.org/wiki/Guid)

```
SELECT NEWID() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T15:30:25.877

使用具有 GUID（全局唯一标识符）类型的列。它是 16 字节，并且对于每一行将始终是唯一的。

请注意，与普通整数键相比，您将获得显着的性能影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T15:38:32.693

使用另一个具有 int 类型 ID 键的表，默认为 1，称为 KeyID 或其他。

让存储过程检索值，加 1，然后更新 KeyID，然后将其返回到存储过程，该存储过程正在更新需要新唯一键的两个表。

这将确保 ID 是一个 int，并且它在使用存储过程生成新 ID 的表集之间是唯一的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T17:01:12.713

您可以在第三个表中定义一个 IDENTITY 列，使用它来生成 ID 值，但您总是回滚您在表中所做的任何插入（以避免使其增长）。回滚事务不会回滚生成 ID 的事实。

我不是 Microsoft SQL Server 的普通用户，所以请原谅任何语法错误。但是我想到的是以下内容：

```
CREATE TABLE AlwaysRollback (
  id IDENTITY(1,1)
);

BEGIN TRANSACTION;
INSERT INTO AllwaysRollBack () VALUES ();
ROLLBACK TRANSACTION;

INSERT INTO RealTable1 (id, ...) VALUES (SCOPE_IDENTITY(), ...);

BEGIN TRANSACTION;
INSERT INTO AllwaysRollBack () VALUES ();
ROLLBACK TRANSACTION;

INSERT INTO RealTable2 (id, ...) VALUES (SCOPE_IDENTITY(), ...); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T15:42:41.343

我不知道你会怎么称呼它。

如果您不想使用 GUID 或单独的表，您还可以创建一个函数来查看两个表中 id 的最大值并将一个添加到该值（或类似的值）。

然后，您可以在两个表的插入触发器中调用该函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T15:50:49.890

我个人是 GUID 解决方案的粉丝，但这是一个可行的选择。

此问题的许多解决方案都避免使用 GUID 并使用良好的旧整数。这在许多卫星站点与主站点合并并且需要避免密钥冲突的合并复制情况下也很常见。

如果 GUID 对您不起作用，并且您绝对必须具有 int、bigint 等，您始终可以只使用 IDENTITY 列，并为每个表设置不同的 SEED 值。这些数据类型的范围很广，将范围拆分为可用段并不难，特别是如果您想要的只是两个拆分。例如，基本 int 的范围从 -2^31 (-2,147,483,648) 到 2^31 - 1 (2,147,483,647)。例如，这对于客户表来说已经绰绰有余了。

**Transact-SQL 参考 (SQL Server 2000)** [int、bigint、smallint 和 tinyint](http://msdn.microsoft.com/en-us/library/aa933198(SQL.80).aspx)

例子：

```
--Create table with a seed of 1 billion and an increment of 1
CREATE TABLE myTable
(
primaryKey int IDENTITY (1000000000, 1),
columnOne varchar(10) NOT NULL
) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-19T10:59:29.270

如果您确实需要使用 int 执行此操作并且您有一个自动递增的数字，那么我之前这样做的方法是将 id 字段自动递增函数更改为另一个表的序列。我不太确定在 ms sql 或 my sql 但在 pgsql 中这意味着在 sql 中你会有这个字段

```
 id integer NOT NULL DEFAULT nextval('table_two_seq'::regclass), 
```

其中 table_two_sequence 是另一个表的序列函数。然后通过插入一些数据来测试它。如果这在 ms sql 中不起作用，我真的很抱歉，我会尽量避开它。未能证明 GUID 是其他人提到的最佳方式。或者在插入您使用的代码时，您可以在其中放置一个算法，但它可能会变得混乱。

或者，考虑将数据放在一个表中，因为这是一种解决方法。如果你需要，你可以有一个模拟两个表的视图。只是一个想法。

希望我有帮助

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-18T00:45:16.640

从 SQL Server 2012 开始，您可以声明一个序列对象 [https://msdn.microsoft.com/en-us/library/ff878091.aspx](https://msdn.microsoft.com/en-us/library/ff878091.aspx)，这正是您所需要的。

用包含下一个序列值的表和一个存储过程原子地选择值和增量来模拟一个序列对象应该很简单。[你想使用函数，但函数不能有副作用。]

这个黑客怎么样？创建一个包含两列的表 (MySequence)：以及标识列 (SequenceValue) 和一个虚拟列 (DummyValue)，并使用此存储过程获取新的序列值。表中唯一的行将是检索到的最后一个序列值。

```
CREATE PROCEDURE GetNextValue 
AS
BEGIN
    DECLARE @value int = null;

    -- Insert statements for procedure here
    INSERT into MySequence (DummyValue) Values (null);

    SET @value = SCOPE_IDENTITY();

    DELETE from MySequence where SequenceValue <> @value

    SELECT @value as Sequence

    return @value
END 
```

要使用序列，您必须管理对目标表的插入——触发器可能会起作用。

# javascript - Python 套接字的问题：如何在任何浏览器中获取可靠的 POST 数据？

> ID：167426
> 
> 赞同：1
> 
> 时间：2008-10-03T15:28:36.067
> 
> 标签：javascript, python, sockets, comet

我用 socket 模块编写了小的 Python+Ajax 程序（在最后列出）来研究异步通信的 COMET 概念。

这个想法是允许浏览器通过我的 python 程序互相实时发送消息。

诀窍是让“GET messages/...”连接打开，等待消息回复。

我的问题主要在于我通过 socket.recv 所拥有的可靠性......

当我从 Firefox 发布时，它运行良好。

当我从 Chrome 或 IE 发布时，我在 Python 中获得的“数据”是空的。

有人知道浏览器之间的这个问题吗？

某些浏览器是否注入了一些 EOF 或其他字符会杀死“recv”的接收？

这个问题有什么已知的解决方案吗？

Python 中的 server.py：

```
 import socket
connected={}
def inRequest(text):
   content=''
   if text[0:3]=='GET':
      method='GET'
   else:
      method='POST'
      k=len(text)-1
      while k>0 and text[k]!='\n' and text[k]!='\r':
         k=k-1
      content=text[k+1:]
   text=text[text.index(' ')+1:]
   url=text[:text.index(' ')]
   return {"method":method,"url":url,"content":content}

mySocket = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
mySocket.bind ( ( '', 80 ) )
mySocket.listen ( 10 )
while True:
   channel, details = mySocket.accept()
   data=channel.recv(4096)
   req=inRequest(data)
   url=req["url"]
   if url=="/client.html" or url=="/clientIE.html":
      f=open('C:\\async\\'+url)
      channel.send ('HTTP/1.1 200 OK\n\n'+f.read())
      f.close()
      channel.close()
   elif '/messages' in url:
      if req["method"]=='POST':
         target=url[10:]
         if target in connected:
            connected[target].send("HTTP/1.1 200 OK\n\n"+req["content"])
            print req["content"]+" sent to "+target
            connected[target].close()
            channel.close()
      elif req["method"]=='GET':
         user=url[10:]
         connected[user]=channel
         print user+' is connected' 
```

HTML+Javascript中的client.html：

```
<html>
<head>
    <script>
        var user=''
        function post(el) {
            if (window.XMLHttpRequest) {
                var text=el.value;
                var req=new XMLHttpRequest();
                el.value='';
                var target=document.getElementById('to').value
            }
            else if (window.ActiveXObject) {
                var text=el.content;
                var req=new ActiveXObject("Microsoft.XMLHTTP");
                el.content='';
            }
            else 
                return;
            req.open('POST','messages/'+target,true)
            req.send(text);
        }
        function get(u) {
            if (user=='')
                user=u.value
            var req=new XMLHttpRequest()
            req.open('GET','messages/'+user,true)
            req.onload=function() {
                var message=document.createElement('p');
                message.innerHTML=req.responseText;
                document.getElementById('messages').appendChild(message);
                get(user);
            }
            req.send(null)
        }
    </script>
</head>
<body>
<span>From</span>
<input id="user"/>
<input type="button" value="sign in" onclick="get(document.getElementById('user'))"/>
<span>To</span>
<input id="to"/>
<span>:</span>
<input id="message"/>

<input type="button" value="post" onclick="post(document.getElementById('message'))"/>
<div id="messages">
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T08:47:12.693

你遇到的问题是

*   您的 tcp 套接字处理没有读到应有的内容
*   您的 http 处理不完整

我推荐以下讲座：

*   [RFC2616](http://www.w3.org/Protocols/rfc2616/rfc2616.html)
*   Stevens[的套接字网络 API](http://www.kohala.com/start/unpv12e.html)

请参阅下面的示例，了解可以处理帖子的工作 http 服务器

```
index = '''
<html>
    <head>
    </head>
    <body>
        <form action="/" method="POST">
            <textarea name="foo"></textarea>
            <button type="submit">post</button>
        </form>
        <h3>data posted</h3>
        <div>
            %s
        </div>
    </body>
</html>
'''

bufsize = 4048
import socket
import re
from urlparse import urlparse

class Headers(object):
    def __init__(self, headers):
        self.__dict__.update(headers)

    def __getitem__(self, name):
        return getattr(self, name)

    def get(self, name, default=None):
        return getattr(self, name, default)

class Request(object):
    header_re = re.compile(r'([a-zA-Z-]+):? ([^\r]+)', re.M)

    def __init__(self, sock):
        header_off = -1
        data = ''
        while header_off == -1:
            data += sock.recv(bufsize)
            header_off = data.find('\r\n\r\n')
        header_string = data[:header_off]
        self.content = data[header_off+4:]

        lines = self.header_re.findall(header_string)
        self.method, path = lines.pop(0)
        path, protocol = path.split(' ')
        self.headers = Headers(
            (name.lower().replace('-', '_'), value)
            for name, value in lines
        )

        if self.method in ['POST', 'PUT']:
            content_length = int(self.headers.get('content_length', 0))
            while len(self.content) <  content_length:
                self.content += sock.recv(bufsize)

        self.query = urlparse(path)[4]

acceptor = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
acceptor.setsockopt(
    socket.SOL_SOCKET,
    socket.SO_REUSEADDR,
    1,
)
acceptor.bind(('', 2501 ))
acceptor.listen(10)

if __name__ == '__main__':
    while True:
        sock, info = acceptor.accept()
        request = Request(sock)
        sock.send('HTTP/1.1 200 OK\n\n' + (index % request.content) )
        sock.close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-04T13:46:12.433

非常感谢弗洛里安，您的代码正在运行！！！！
我重用了模板并用我的 COMET 机制完成了**主体**
，它运行得更好 Chrome 和 Firefox 运行良好
IE 仍然存在“long GET”系统问题
当它收到 GET 的答案时，它不会停止重新执行循环以打印消息。
现在调查这个问题

这是我为非常基本的 JQuery+Python 跨浏览器系统更新的代码。

Python 程序，基于 Florian 的代码：

```
bufsize = 4048
import socket
import re
from urlparse import urlparse
connected={}
class Headers(object):
    def __init__(self, headers):
        self.__dict__.update(headers)

    def __getitem__(self, name):
        return getattr(self, name)

    def get(self, name, default=None):
        return getattr(self, name, default)

class Request(object):
    header_re = re.compile(r'([a-zA-Z-]+):? ([^\r]+)', re.M)

    def __init__(self, sock):
        header_off = -1
        data = ''
        while header_off == -1:
            data += sock.recv(bufsize)
            header_off = data.find('\r\n\r\n')
        header_string = data[:header_off]
        self.content = data[header_off+4:]
        furl=header_string[header_string.index(' ')+1:]
        self.url=furl[:furl.index(' ')]
        lines = self.header_re.findall(header_string)
        self.method, path = lines.pop(0)
        path, protocol = path.split(' ')
        self.headers = Headers(
            (name.lower().replace('-', '_'), value)
            for name, value in lines
        )
        if self.method in ['POST', 'PUT']:
            content_length = int(self.headers.get('content_length', 0))
            while len(self.content) <  content_length:
                self.content += sock.recv(bufsize)
        self.query = urlparse(path)[4]

acceptor = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
acceptor.setsockopt(
    socket.SOL_SOCKET,
    socket.SO_REUSEADDR,
    1,
)
acceptor.bind(('', 8007 ))
acceptor.listen(10)

if __name__ == '__main__':
    while True:
        sock, info = acceptor.accept()
        request = Request(sock)
        m=request.method
        u=request.url[1:]
        if m=='GET' and (u=='client.html' or u=='jquery.js'):
            f=open('c:\\async\\'+u,'r')
            sock.send('HTTP/1.1 200 OK\n\n'+f.read())
            f.close()
            sock.close()
        elif 'messages' in u:
            if m=='POST':
                target=u[9:]
                if target in connected:
                    connected[target].send("HTTP/1.1 200 OK\n\n"+request.content)
                    connected[target].close()
                    sock.close()
            elif m=='GET':
                user=u[9:]
                connected[user]=sock
                print user+' is connected' 
```

并且压缩了 Jquery 的 HTML：

```
 <html>
<head>
    <style>
        input {width:80px;}
        span {font-size:12px;}
        button {font-size:10px;}
    </style>
    <script type="text/javascript" src='jquery.js'></script>
    <script>
        var user='';
        function post(el) {$.post('messages/'+$('#to').val(),$('#message').val());}
        function get(u) {
            if (user=='') user=u.value
            $.get('messages/'+user,function(data) { $("<p>"+data+"</p>").appendTo($('#messages'));get(user);});
        }
    </script>
</head>
<body>
<span>From</span><input id="user"/><button onclick="get(document.getElementById('user'))">log</button>
<span>To</span><input id="to"/>
<span>:</span><input id="message"/><button onclick="post()">post</button>
<div id="messages"></div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T17:31:22.013

我建议在客户端使用 JS/Ajax 库，以消除代码跨浏览器问题的可能性。出于同样的原因，如果前者不允许低级控制，我建议使用 Python http 服务器库，如[SimpleHTTPServer](http://docs.python.org/library/simplehttpserver.html)或[Twisted的东西。](http://twistedmatrix.com/trac/wiki/Documentation)

另一个想法 - 使用 Wireshark 之类的东西来检查浏览器发送的内容。

# c++ - 在 MFC 中创建标尺条

> ID：167427
> 
> 赞同：1
> 
> 时间：2008-10-03T15:28:37.407
> 
> 标签：c++, winapi, visual-c++, mfc

在 SDI 应用程序中创建垂直和水平标尺条的最佳方法是什么？你会让它成为框架或视图的一部分吗？从CControlBar派生出来，还是有更好的方法？

垂直标尺也必须停靠在窗格而不是框架上。

为了让我更清楚地了解我所追求的，想象一下 Visual Studio 中对话框编辑器中的垂直标尺（仅限 MFC）。每当调整树视图的大小时，它都会重新定位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T16:24:09.450

我***不会***用控制吧。我没有其他充分的理由（IMOHO）很难做你想做的事——如果你想要的不是停靠工具栏的话。

我会使用 GDI 调用直接在视图窗口上绘制它们。

我想我*可能会*考虑让每个标尺都有自己的窗口，然后在自己的窗口上绘制标尺。然后，我将在视图中创建这两个 CWnd 派生类并将其定位为子窗口。如果您想在这些标尺上与鼠标进行交互，这很好（更容易理清哪些消息是针对标尺的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T23:12:41.807

我最终按照您的建议从 CWnd 派生了标尺，并跳过了控制栏路线。此代码适用于任何一种情况：

```
m_wndSplitter.CreateStatic(this, 1, 3);

m_wndLeftPane.Create(&m_wndSplitter,WS_CHILD|WS_VISIBLE,m_wndSplitter.IdFromRowCol(0, 0));
m_ruler.Create(&m_wndSplitter,WS_CHILD|WS_VISIBLE,m_wndSplitter.IdFromRowCol(0, 1));

m_wndSplitter.CreateView(0, 2, pContext->m_pNewViewClass, CSize(300, 0), pContext);
SetActiveView((CScrollView*)m_wndSplitter.GetDlgItem(m_wndSplitter.IdFromRowCol(0, 2))); 
```

# vbscript - 为字符串中的所有数字添加小数位的最佳 vbscript 代码是什么？

> ID：167432
> 
> 赞同：1
> 
> 时间：2008-10-03T15:29:37.593
> 
> 标签：vbscript

例子

G76 I0.4779 J270 K7 C90

X20 Y30

如果一个数字以 IJKCXY 开头并且没有小数，则添加小数。上面的示例应如下所示：

G76 I0.4779 J270 K7。C90。

X20。Y30。

此代码的目的是为较旧的 Fanuc OPC 控制器转换 CNC 代码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T15:50:23.277

```
`Set RegEx = New RegExp
RegEx.Global = True
RegEx.Pattern = "([IJKCXY]\d+)([^\.]|$)"
newVar = RegEx.Replace (oldString, "$1.$2")` 
```

其中 oldString 是原始字符串，newVar 是添加了小数的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T16:12:57.303

```
function convert(str)
    Set RegEx = New RegExp
    RegEx.Global = True
    RegEx.Pattern = "([IJKCXY]\d*\.?\d*)"
    Set Matches = regEx.Execute(str)

    For Each Match in Matches
        if instr(Match.value, ".") = 0 then
            str = Replace(str, Match.value, Match.value & ".")
        end if
    Next
    convert = str
end function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T17:21:15.840

tloach仍然回答不起作用

韦恩斯工作，但也放了一个 . 在每次出现 IJKCXY 之后

如果 instr(Match.value, ".") = 0 那么我改变了

就像 if instr(Match.value, ".") = 0 and len(Match.value) > 1 then

# python - 如何在 Mac OS X 上的 Python 交互式 shell 中输入英镑字符 (£)？

> ID：167439
> 
> 赞同：4
> 
> 时间：2008-10-03T15:30:59.667
> 
> 标签：python, bash, macos, shell, terminal

**更新：**谢谢大家的建议。经过进一步研究，我在这里重新提出了问题：[OS X 上的 Python/editline：£ 符号似乎绑定到 ed-prev-word](https://stackoverflow.com/questions/217020/pythoneditline-on-os-x-163-sign-seems-to-be-bound-to-ed-prev-word)

在 Mac OS XI 上，无法在 Python 交互式 shell 中输入英镑符号 (£)。

*   Mac OS X 10.5.5
*   Python 2.5.1（r251:54863，2008 年 1 月 17 日，19:35:17）
*   欧式键盘（£ 是 shift-3）

当我在空的 Python shell 中键入“£”（即按 shift-3）时，什么也没有出现。

如果我已经输入了一些字符，例如

```
>>> 1234567890 1234567890 1234567890 
```

... 然后按 shift-3 将使光标自身定位在最近的空格之后，或者如果光标和行首之间没有空格，则定位在行首。

在普通的 bash shell 中，按 shift-3 会按预期键入“£”。

知道如何在 Python 交互式 shell 中键入文字“£”吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T15:47:29.243

不是最好的解决方案，但您可以键入：

```
 pound = u'\u00A3' 
```

然后你把它放在一个变量中，你可以在剩下的会话中使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T15:37:38.967

在 unicode 中是 00A003。使用 Unicode 转义，它将是 u'\u00a003'。

编辑：@Patrick McElhaney 说你可能需要使用 00A3。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T17:31:58.453

`u'\N{pound sign}'`

如果您使用的是 ipython，请将

`execute pound = u'\N{pound sign}'`

在您的 ipythonrc 文件中（在“部分：要执行的 Python 代码”）中，您将始终将“磅”定义为交互式 shell 中的磅符号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T15:39:05.687

我想终端仿真器正在将击键作为控制代码吃掉。也许看看它是否有一个你可以弄乱的配置文件？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T15:36:35.817

必须是您的设置，我可以在 IDLE 或 python 命令行下使用 £（也是欧洲键盘）。（蟒蛇2.5）。

编辑：我使用的是windows，所以python在mac OS下的工作方式可能有问题？

# plugins - 有人知道 IntelliJ Idea 的一些很酷的 PL/SQL 插件吗？

> ID：167440
> 
> 赞同：14
> 
> 时间：2008-10-03T15:31:08.120
> 
> 标签：plugins, plsql, intellij-idea

我已经评估了官方 IntelliJ 存储库中的一些插件，但它们似乎都没有提供比基本语法突出显示更多的功能。即使突出显示也是有限的。例如，Database Navigator 不会突出显示 IF。有适当的突出显示会很棒。如果它具有自动完成功能并提供文件结构视图，我会非常高兴。当我需要向数据库发布一些小东西或从中查询一些东西时，我会使用 SQL 查询插件。当我需要做更复杂的事情，或者当我需要修改 PL/SQL 时，我会使用 PL/SQL Developer。但大多数时候，我需要浏览 Java、JavaScript 和 PL/SQL 代码的组合。不幸的是，SQL 查询插件在这方面并没有 PL/SQL Developer 提供帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T19:15:50.477

您是否尝试过[SQL 查询插件](http://java.sstiller.de/sql/index.html "KiwiSoft - SQL 查询插件")？它具有许多功能，包括多个查询窗口、直接编辑表，当然还有适当突出显示 PL/SQL 语法和内部数据库结构的浏览器。

它还与主编辑器很好地集成：您可以右键单击任何包含 SQL 和“Send to SQLPlugin”的选定 Java 字符串，以去除所有引号和非 SQL 语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T12:25:31.250

我已经开始使用[SQL Code Assistant](http://plugins.intellij.net/plugin/?objc&pluginId=4486)插件，它可以立即识别出我的 PL/SQL 包和所有这些 PL/SQL 结构（光标等），开箱即用的 IntelliJ 功能无法理解并标记为红色。到目前为止，它不仅可以识别 dblink，但这已经足够公平了。当然，您必须将 *.sql 文件类型与插件相关联，但它会在您安装/重新启动 IDE 后智能地通知您。

# asp.net - trace.axd 返回 404 错误

> ID：167449
> 
> 赞同：0
> 
> 时间：2008-10-03T15:34:15.227
> 
> 标签：asp.net, iis

在 .Net 生产服务器上，我无法查看应用程序跟踪。Web 服务器返回 404 错误。在我的本地计算机上复制文件时，跟踪工作，使进一步测试不切实际。

跟踪似乎设置正确：

```
<trace enabled="true" requestLimit="20" pageOutput="true" 
traceMode="SortByTime" localOnly="false" /> 
```

*编辑：*

废话，我试图直接回复它，因为我为此浪费了 2 个小时，而且一些谷歌搜索表明我不是唯一一个在那里绊倒的人。显然我不能接受我自己的答案:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T15:34:22.233

首先，检查跟踪是否使用最小跟踪指令：

```
<trace enabled="true" /> 
```

在任何情况下都应该工作。

然后检查 IIS 配置：URL 重写规则可能会干扰 trace.axd url。

如果不是这种情况，请检查服务器是否接受 .axd 扩展名（管理 IIS>属性>主目录>配置：应该存在 .axd 扩展名，由 aspnet_isapi.dll 执行，并且不验证文件是否存在）

# html - XSLT 抽象

> ID：167453
> 
> 赞同：10
> 
> 时间：2008-10-03T15:34:50.360
> 
> 标签：html, xml, xslt

我正在探索 XML -> XSLT -> HTML meme 以生成 Web 内容。我的 XSLT 经验很少。

我很好奇 XSLT 中有哪些机制可用于处理抽象或“重构”。

例如，使用通用 HTML 和服务端包含，可以将许多页面模板化并分解到有公共页眉、导航和页脚段的地方，而页面本身基本上就是正文。

常见的标记语言 JSP、PHP、ASP 甚至允许所有这些段具有动态内容（例如将用户名添加到每个标题块）。

JSP 更进一步，它允许您创建标记文件，这些文件可以接受生成内容时要使用的参数，甚至可以在标记本身内包围和处理内容。

我很好奇类似的功能是在 XSLT 中完成的。有哪些工具可以为创建 HTML 页面之类的事情制作可重用的 XSLT 块？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-03T15:53:06.437

对于我自己的项目，这就是我划分页面的方式。我的每个 XSL 都导入了一个 template.xsl 文件。大多数页面只有 template.xsl，但有些页面（如购物车等）需要自己的，因为它们解析的数据类型不同。

```
<page title="Home">
    <navigation>
        <!-- something here -->
    </navigation>
    <main>
        <!-- something here -->
    </main>
</page> 
```

这是我的 template.xsl 中的一个片段。我把所有常见的东西都扔在这里，然后让我的页面有机会通过`call-template`.

```
<xsl:template match="/page" name="page">  
    <html>
    <head>  
        <title><xsl:value-of select="(@title)" /></title>           
        <xsl:call-template name="css" />
        <xsl:call-template name="script" />
    </head>
    <body>
        <xsl:call-template name="container" />
    </body>
    </html>
</xsl:template> 
```

我的 css 标签如何响应的示例。请注意，它调用`css-extended.`的 css 仅具有适用于所有页面的通用 css'。有些页面需要更多。那些可以覆盖css-extended。请注意，这是必需的，因为`call-template`如果页面调用模板但未在任何地方定义它，则会失败。

```
 <xsl:template name="css">
        <link rel="stylesheet" type="text/css" href="{$cssPath}reset.css"  />
        <link rel="stylesheet" type="text/css" href="{$cssPath}style.css"  />
        <link rel="stylesheet" type="text/css" href="{$cssPath}layout.css" />
        <xsl:call-template name="css-extended" />
    </xsl:template>   

    <!-- This is meant to be blank. It gets overriden by implementing stylesheets -->
    <xsl:template name="css-extended" /> 
```

我的容器将以类似的方式工作——定义了常见的东西，然后每个页面都可以提供一个实现。默认实现是在 XSL 中。（在`content`）

```
 <xsl:template name="container">
        <div id="container">
            <xsl:call-template name="header" />
            <xsl:call-template name="content" />
            <xsl:call-template name="footer" />
        </div>
    </xsl:template>  

    <xsl:template name="content">
        <div id="content">
            <div id="content-inner">
                <xsl:call-template name="sideBar" />
                <xsl:call-template name="main" />
            </div>
        </div>
    </xsl:template>   

    <xsl:template name="main">
        <div id="main">
            <xsl:apply-templates select="main" />
            <xsl:call-template name="main-extended" />
       </div>
    </xsl:template>

    <!-- This is meant to be blank. It gets overriden by implementing stylesheets -->
    <xsl:template name="main-extended" />

<xsl:template name="footer">
        <div id="footer">
        <div id="footer-inner">
        <!-- Footer content here -->
        </div>
        </div>
</xsl:template> 
```

它对我来说非常漂亮。如果有任何问题我可以为您解答，请告诉我。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T15:37:53.083

模板，包括。

Xsl 与任何其他编程语言都非常不同。`Its rule based.`

我建议您阅读有关[Xslt](http://www.topxml.com/xsl/tutorials/intro/default.asp)的内容，然后再问一些更具体的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T15:44:30.917

您可以使用 xsl Include 和 Import 语句来抽象出页面的某些部分。XSLT 本身就是那种可以重现标签文件类型行为的东西。您可以使用所需的标签编辑 xml 数据文件。同时，您的 xsl 模板将知道如何处理这些标签然后遇到它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T15:51:25.660

您可以给模板名称，然后通过'call-template'调用它们

在 XSLT 2.0 中，您可以创建自己的函数（尽管我发现语法很曲折）

一个很好的探索领域是使用 XSLT 生成 XSLT 样式表。这使您可以自动化常见的转换场景，其中 90% 的样式表是样板。为此，您需要熟悉“命名空间别名”。这是扩展您的语言知识的好方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-05T12:50:43.497

XSL**基于**模板。

XML 数据可以在三个级别上“重用”。在最基本的层面上，您可以`<xsl:for-each />`通过 XML。

注意：XSL 中的 for-each 不是循环遍历数据，它只是匹配数据。同样，当您的“内部”为每个您的内部 XML 的“上下文”时（这就像编程中的“范围”概念）

使用和重用 for-each 的示例

```
<xsl:for-each select="/xml/data/here">
    ... do some stuff ...
</xsl:for-each>
<xsl:for-each select="/xml/data/here">
    ... do some DIFFERENT stuff ...
</xsl:for-each> 
```

for-each 节点包含在模板节点中（第二级重用）。有两种类型的模板节点：匹配和命名。**匹配模板**节点，作用类似于上面提到的 for-each 节点，但如果在 XSL 处理开始时匹配到任何节点，模板引擎会自动调用该节点。匹配模板节点也可以显式应用。另一方面，**命名模板**节点总是被显式应用，并且可以被认为是类似的函数。

将*始终*调用的匹配模板示例（因为根节点将始终存在）

```
<xsl:template match="/">
    ... do some stuff ...
</xsl:template> 
```

一个匹配模板显式调用另一个匹配模板

```
<xsl:template match="/">
    <xsl:apply-templates select="xml/data/too" />
</xsl:template>

<xsl:template match="xml/data/too">
     ... do something ...
</xsl:template> 
```

注意：为了使匹配模板工作，它匹配的 XML 节点需要存在。如果不匹配，**则不**调用该模板。

命名模板示例

```
<xsl:template name="WriteOut">
    ... data with NO Context Here ...
</xsl:template> 
```

或从匹配的模板调用命名模板

```
<xsl:template match="/">
   <xsl:call-template name="WriteOut" />
<xsl:template> 
```

注意：你可以在调用匹配和命名模板的地方混合和匹配，你只需要注意你所处的上下文。

所有模板节点都保存在**XSL Stylesheets**中，您可以**包含**和**导入**各种样式表。例如，您可以将处理 HTML 标头节点的所有模板保存在一个模板中，并将处理 HTML 正文节点的所有模板保存在另一个模板中。然后，您可以创建一个包含 Header 和 Body 样式表的样式表。

包含节点的示例

```
<xsl:include href="header.xsl" /> 
```

总之，有三种方法可以抽象数据块，通过 for-eaching、通过模板或通过包含样式表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T16:21:12.870

XSLT 功能强大，但它与大多数编程语言有很大不同，它为您提供的功能非常有限，因此您使用另一种语言内置的东西可能需要一些非常复杂的 xsl 操作才能使用。几周前，当我进行大量 XSLT 工作时，我发现[这里的备忘单很有用。](http://www.mulberrytech.com/quickref/)

不要期望 XSLT 会以特定的方式做事，您可能会找到做这些事的好方法，但是如果您对某事应该如何工作有太多固定的想法，那么很容易陷入困境。

# java - 我可以从 Java EE webapp 使用 Windows 身份验证连接到 SQL Server 吗？

> ID：167464
> 
> 赞同：55
> 
> 时间：2008-10-03T15:36:21.650
> 
> 标签：java, sql-server, tomcat, jdbc, jakarta-ee

我目前正在研究如何使用 Windows 身份验证而不是 SQL Server 身份验证从我的 Java EE Web 应用程序连接到 SQL Server 数据库。我在 Tomcat 6.0 上运行这个应用程序，并且正在使用 Microsoft JDBC 驱动程序。我的连接属性文件如下所示：

```
dbDriver              = com.microsoft.sqlserver.jdbc.SQLServerDriver
dbUser                = user
dbPass                = password
dbServer              = localhost:1433;databaseName=testDb
dbUrl                 = jdbc:sqlserver://localhost:1433 
```

在使用 SQL Server 身份验证时，我以这种方式连接到 SQL Server 数据库的问题为零。

有什么方法可以检索用户的 Windows 身份验证凭据并将**该**身份验证用于 SQL Server？

**更新**：我知道在 ASP.net 中有一种方法可以设置 Windows 身份验证以访问 webapp，这正是我正在寻找的，除了我想将该令牌传递给 SQL Server 以访问数据库。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-12-10T15:23:02.570

我不认为可以将用户凭据从浏览器推送到数据库（这有意义吗？我认为不是）

但是，如果您想使用运行 Tomcat 的用户的凭据连接到 SQL Server，那么您可以使用 Microsoft 的 JDBC 驱动程序。只需像这样构建您的 JDBC URL：

```
jdbc:sqlserver://localhost;integratedSecurity=true; 
```

并将相应的DLL复制到Tomcat的bin目录下（驱动提供的sqljdbc_auth.dll）

[MSDN > 使用 JDBC 驱动程序连接到 SQL Server > 构建连接 URL](http://msdn.microsoft.com/en-us/library/ms378428.aspx)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-04-29T06:29:11.380

看着

[http://jtds.sourceforge.net/faq.html#driverImplementation](http://jtds.sourceforge.net/faq.html#driverImplementation)

jTDS 使用的 URL 格式是什么？

jTDS 的 URL 格式为：

```
jdbc:jtds:<server_type>://<server>[:<port>][/<database>][;<property>=<value>[;...]] 
```

... domain 指定要在其中进行身份验证的 Windows 域。如果存在并且提供了用户名和密码，jTDS 使用 Windows (NTLM) 身份验证而不是通常的 SQL Server 身份验证（即提供的用户和密码是域用户和密码）。这允许非 Windows 客户端登录到仅配置为接受 Windows 身份验证的服务器。

如果域参数存在但没有提供用户名和密码，jTDS 使用其本地单点登录库并使用已登录的 Windows 用户凭据登录（为此，显然需要在 Windows 上登录一个域，并且还安装了 SSO 库——请参阅发行版中的 README.SSO，了解如何执行此操作）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-01-12T14:42:43.030

这实际上对我有用：

根据 jtdsd 发行版附带的 README.SSO：

为了使单点登录工作，jTDS 必须能够加载本机 SPPI 库`ntlmauth.dll`。将此 DLL 放在系统路径中的任何位置（由`PATH`系统变量定义），一切就绪。

我把它放在我的 jre/bin 文件夹中

我配置了一个专用于 sql server 实例 (2302) 的端口，以减轻对实例名称的需求——这正是我所做的。lportal 是我的数据库名称。

```
jdbc.default.url=jdbc:jtds:sqlserver://192.168.0.147:2302/lportal;useNTLMv2=true;domain=mydomain.local 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-04T21:42:02.770

除非你有一些真正令人信服的理由不这样做，否则我建议放弃 MS JDBC 驱动程序。

相反，请使用[jtds jdbc 驱动程序](http://jtds.sourceforge.net/)。阅读 jtds 发行版中的 README.SSO 文件，了解如何配置单点登录（本机身份验证）以及将本机 DLL 放置在何处以确保它可以被 JVM 加载。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-12-17T01:03:59.077

我在使用 Windows 身份验证连接到 MS SQL 2005 时遇到问题。在这个论坛和其他论坛的帮助下，我能够解决这个问题。这是我所做的：

1.  安装 JTDS 驱动程序
2.  不要在 jdbc:jtds:://[:][/][;=[;...]] 字符串中使用“domain=”属性
3.  在 Web 服务器计算机上的 c:\windows\system32 目录中安装 ntlmauth.dll（不需要注册 dll）。
4.  将 Apache Tomcat 服务的登录身份更改为有权访问 SQL 数据库服务器的域用户（用户不必有权访问 dbo.master）。

我的环境：Windows XP 客户端在 Windows 2003 上托管带有 MS SQL 2005 后端的 Apache Tomcat 6

# oracle - Oracle 将常量合并到单个表中

> ID：167471
> 
> 赞同：20
> 
> 时间：2008-10-03T15:38:33.427
> 
> 标签：oracle, jdbc, merge

在 Oracle 中，给定一个简单的数据表：

```
create table data (
    id       VARCHAR2(255),
    key      VARCHAR2(255),
    value    VARCHAR2(511)); 
```

假设我想“插入或更新”一个值。我有类似的东西：

```
merge into data using dual on 
    (id='someid' and key='testKey')
when matched then 
    update set value = 'someValue' 
when not matched then 
    insert (id, key, value) values ('someid', 'testKey', 'someValue'); 
```

还有比这更好的方法吗？该命令似乎有以下缺点：

*   每个文字都需要输入两次（或通过参数设置添加两次）
*   “使用双重”语法似乎很老套

如果这是最好的方法，有没有办法在 JDBC 中设置每个参数两次？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-03T16:29:38.143

我不认为使用双重是一种黑客行为。为了摆脱绑定/打字两次，我会做类似的事情：

```
merge into data
using (
    select
        'someid' id,
        'testKey' key,
        'someValue' value
    from
        dual
) val on (
    data.id=val.id
    and data.key=val.key
)
when matched then 
    update set data.value = val.value 
when not matched then 
    insert (id, key, value) values (val.id, val.key, val.value); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-03T15:48:07.510

我会将 MERGE 隐藏在 PL/SQL API 中，然后通过 JDBC 调用它：

```
data_pkg.merge_data ('someid', 'testKey', 'someValue'); 
```

作为 MERGE 的替代方案，API 可以：

```
begin
   insert into data (...) values (...);
exception
   when dup_val_on_index then
      update data
      set ...
      where ...;
end; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T19:45:28.607

我更喜欢在插入之前尝试更新，以节省检查异常的时间。

```
update data set ...=... where ...=...;

if sql%notfound then

    insert into data (...) values (...);

end if; 
```

即使现在我们有了合并语句，我仍然倾向于以这种方式进行单行更新——只是看起来更自然的语法。当然，在处理更大的数据集时，**合并确实发挥了作用。**

# c# - 是否可以有一个列表 作为活动记录类的属性

> ID：167485
> 
> 赞同：1
> 
> 时间：2008-10-03T15:41:25.290
> 
> 标签：c#, collections, castle-activerecord

是否可以在 ActiveRecord 类上具有基本类型（例如 String）的 HasMany 关系，而无需创建另一个实体（例如（TodoListItem））来保存该值。

```
[ActiveRecord]
public class TodoList
{

  [PrimaryKey]
  public int Id
  {
    get { return _id; }
    set { _id = value; }
  }

  [HasMany(typeof(string)]
  public IList<string> Items
  {
    get { return _items; }
    set { _items= value; }
  }
} 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-07T00:29:28.577

是的，你可以这样做。您可以将一对多关系映射到内置或简单类型（值类型或字符串）而不是持久类型。

您需要在属性声明中指定`ColumnKey`,`Table`和`Element`params 以`HasMany`使其正确连接。您必须有一个代理键列，以便 AR 可以处理更新和级联，然后`Element`告诉 AR 表中的哪一列包含它将用于创建列表的简单值。

```
[HasMany(typeof(string), Table="ToDoList_Items", 
         ColumnKey = "ListItemID", Element = "Item")]
public IList<string> Items { get; set; } 
```

（或类似的东西——我没有在这个盒子上方便的编译器来检查它；但是根据 API 文档它应该可以工作。）

说到这一点，如果您还没有看过，[http](http://api.castleproject.org) ://api.castleproject.org 对于任何使用 Castle 堆栈的工作来说都是必不可少的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-10-03T16:03:11.143

在 ActiveRecord 中，您的类型映射到表中的记录（默认情况下）。您似乎对这种类型应该如何映射到您的表感到困惑。

MyClass 类型应该有一个类似这样的定义（不包括 PK 设置）：

```
[ActiveRecord(Table = "MyTable")]
public class MyClass : ActiveRecordBase<MyClass>
{
    [Property]
    public int Id { get; set; }

    [Property]
    public int MyClassId { get; set; }

    [Property]
    public string ListItem { get; set; }
} 
```

然后，加载列表：

```
public void LoadMyClasses()
{
    MyClass[] results = MyClass.FindAll();
} 
```

我建议您花一些时间阅读[ActiveRecord 文档](http://www.castleproject.org/activerecord/documentation/index.html)（或[教程](http://www.castleproject.org/activerecord/gettingstarted/index.html)），因为这也有助于消除任何混淆。

# iphone - NSThread 和 UIViewController 交互

> ID：167487
> 
> 赞同：5
> 
> 时间：2008-10-03T15:42:07.630
> 
> 标签：iphone, cocoa, multithreading

如果我产生一个新线程，然后在其中我将一个新控制器推送到我的 UINavigationController 上，使用这样的代码......

(a) 不工作

```
-(void)myCallbackInThread
{
    // move on...
    UIApplication* app = [UIApplication sharedApplication];
    [app changeView];
} 
```

然后我发现视图出现了，但没有响应用户输入。

如果我像这样更改代码

(b) 工作

```
-(void)myCallbackInThread
{
    // move on...
    UIApplication* app = [UIApplication sharedApplication];
    [app performSelectorOnMainThread:@selector(moveToMain) withObject:nil waitUntilDone:FALSE];
} 
```

然后一切正常。

关于为什么的任何提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T15:42:56.757

刚刚在 iPhone 线程文档中找到了这个

> 如果您的应用程序具有图形用户界面，建议您接收与用户相关的事件并从应用程序的主线程启动界面更新。这种方法有助于避免与处理用户事件和绘制窗口内容相关的同步问题。一些框架，例如 Cocoa，通常需要这种行为，但它也具有简化管理用户界面的逻辑的优点。

我仍然看不到实际会导致某些内容显示但无法接收用户输入的原因，但我将来会遵循该指南。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T16:12:43.403

正如文档所说，“如果您不确定某个特定的图形操作，请计划从您的主线程中执行它。”

一个好的经验法则是，如果一个类没有明确记录为线程安全的，那么它可能不是。此外，未记录为线程安全的代码在被多个线程使用时可能不会很快失败，但可能只是表现出未定义的行为，如您所见。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T00:35:34.020

在您的情况下，这实际上取决于 [app changeView] 中发生的情况，但它停止响应的原因很可能是您在新的辅助线程上没有运行循环调度事件（更多内容见下文）。然而，一般来说，从辅助线程更新 GUI 是一个非常糟糕的主意。正如您已经发现的那样，所有这些事件都应该通过主线程。

您的第二个示例而不是您的第一个示例有效的主要原因是 UIApplication 在主线程上为您设置和处理运行循环和事件调度程序。因此，当您调用 performSelectorInMainThread 时，选择器会被分派到主运行循环，然后主运行循环能够处理您的 gui 输入和其他事件。事件分派器也由 UIApplication 在主线程上运行和管理。

所以基本上，不要在辅助线程上执行任何 GUI 管理活动。将它们发送到主线程。如果您需要在辅助线程上进行处理（例如计时器或异步调用等），那么您必须在该线程上启动和管理自己的运行循环（有关管理运行循环的更多信息，请参见[NSRunLoop](http://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Classes/NSRunLoop_Class/Reference/Reference.html)）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T01:11:00.313

UIKit 或 AppKit 中的 UI 代码几乎都不是线程安全的。它如何失败是无关紧要的，因为如果你担心它是如何失败的，那么你正在做的事情会导致各种奇怪的错误，这些错误无论如何都会在不同的操作系统版本之间发生微妙的变化。

我最好的建议是不要使用后台线程中的东西，除非文档说它是安全的。

# sql - SQL Server 2005 使用 DateAdd 将日期添加到日期

> ID：167491
> 
> 赞同：66
> 
> 时间：2008-10-03T15:42:39.830
> 
> 标签：sql, sql-server, tsql, date, dateadd

如何在 SQL Server 2005 中使用 DateAdd 函数将日期添加到日期

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2008-10-03T15:51:53.210

使用以下功能：

```
DATEADD(type, value, date) 
```

*   **date**是您要操作的日期

*   **value**是您要添加的整数值（如果您提供负数，则减去）

*   **类型**是以下之一：

    *   yy, yyyy: 年
    *   qq，q：季度
    *   毫米，米：月
    *   dy, y: 一年中的一天
    *   dd，d：天
    *   wk, ww：周
    *   dw，w：工作日
    *   hh：小时
    *   mi, n: 分钟
    *   ss 或 s: 第二
    *   ms：毫秒
    *   mcs：微秒
    *   ns：纳秒

SELECT DATEADD(dd, 1, GETDATE()) 将返回当前日期 + 1 天

[http://msdn.microsoft.com/en-us/library/ms186819.aspx](http://msdn.microsoft.com/en-us/library/ms186819.aspx)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-03T15:44:44.380

```
DECLARE @MyDate datetime

-- ... set your datetime's initial value ...'

DATEADD(d, 1, @MyDate) 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-03-03T13:25:17.507

尝试以下代码将添加一天到当前日期

```
select DateAdd(day, 1, GetDate()) 
```

并且以同样的方式可以在同一功能中使用年、月、小时、秒等代替日

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-10-25T12:54:33.000

我在 sql-server 2008 中使用过以下查询，它可能会对您有所帮助。

```
For add day  DATEADD(DAY,20,GETDATE()) 
```

*20 为当天数量

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-03T15:45:47.140

```
DECLARE @date DateTime
SET @date = GetDate()
SET @date = DateAdd(day, 1, @date)

SELECT @date 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-02-05T02:43:14.040

```
Select getdate() -- 2010-02-05 10:03:44.527

-- To get all date format
select CONVERT(VARCHAR(12),getdate(),100) +' '+ 'Date -100- MMM DD YYYY' -- Feb 5 2010
union
select CONVERT(VARCHAR(10),getdate(),101) +' '+ 'Date -101- MM/DDYYYY'
Union
select CONVERT(VARCHAR(10),getdate(),102) +' '+ 'Date -102- YYYY.MM.DD'
Union
select CONVERT(VARCHAR(10),getdate(),103) +' '+ 'Date -103- DD/MM/YYYY'
Union
select CONVERT(VARCHAR(10),getdate(),104) +' '+ 'Date -104- DD.MM.YYYY'
Union
select CONVERT(VARCHAR(10),getdate(),105) +' '+ 'Date -105- DD-MM-YYYY'
Union
select CONVERT(VARCHAR(11),getdate(),106) +' '+ 'Date -106- DD MMM YYYY' --ex: 03 Jan 2007
Union
select CONVERT(VARCHAR(12),getdate(),107) +' '+ 'Date -107- MMM DD,YYYY' --ex: Jan 03, 2007
union
select CONVERT(VARCHAR(12),getdate(),109) +' '+ 'Date -108- MMM DD YYYY' -- Feb 5 2010
union
select CONVERT(VARCHAR(12),getdate(),110) +' '+ 'Date -110- MM-DD-YYYY' --02-05-2010
union
select CONVERT(VARCHAR(10),getdate(),111) +' '+ 'Date -111- YYYY/MM/DD'
union
select CONVERT(VARCHAR(12),getdate(),112) +' '+ 'Date -112- YYYYMMDD' -- 20100205
union
select CONVERT(VARCHAR(12),getdate(),113) +' '+ 'Date -113- DD MMM YYYY' -- 05 Feb 2010

SELECT convert(varchar, getdate(), 20) -- 2010-02-05 10:25:14
SELECT convert(varchar, getdate(), 23) -- 2010-02-05
SELECT convert(varchar, getdate(), 24) -- 10:24:20
SELECT convert(varchar, getdate(), 25) -- 2010-02-05 10:24:34.913
SELECT convert(varchar, getdate(), 21) -- 2010-02-05 10:25:02.990

---==================================
-- To get the time
select CONVERT(VARCHAR(12),getdate(),108) +' '+ 'Date -108- HH:MM:SS' -- 10:05:53

select CONVERT(VARCHAR(12),getdate(),114) +' '+ 'Date -114- HH:MM:SS:MS' -- 10:09:46:223
SELECT convert(varchar, getdate(), 22) -- 02/05/10 10:23:11 AM
----=============================================
SELECT getdate()+1
SELECT month(getdate())+1
SELECT year(getdate())+1 
```

# asp.net - UpdatePanelAnimationExtender - 调整大小不起作用

> ID：167502
> 
> 赞同：1
> 
> 时间：2008-10-03T15:44:46.300
> 
> 标签：asp.net, updatepanelanimationexte

这是我拥有的页面。但是该部分中的调整大小部分似乎不起作用。[我从Ajax 站点](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/UpdatePanelAnimation/UpdatePanelAnimation.aspx)复制了大部分代码。我在标签（第 108 行）中放置了一个 alert() 来查找“b._originalHeight”的值，它显示为“44”。我还尝试了上述教程（第 132 行）中的代码，但也没有用。（我不确定它是从哪里得到这个值的。但我需要它来显示表单上的所有控件。

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="AddEditContest.ascx.cs" Inherits="TMPInternational.Spawn2DotComAdmin.Contest.UserControls.AddEditContest" %>
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="uc" %>
<%@ Register Assembly="System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
    Namespace="System.Web.UI" TagPrefix="asp" %>
<%@ Register TagPrefix="ew" Assembly="eWorld.UI, Version=1.9.0.0, Culture=neutral, PublicKeyToken=24d65337282035f2" Namespace="eWorld.UI" %>
<h1 style="margin-left:8px">Add/Edit Contest</h1>
<asp:ScriptManager ID="ScriptManager1" runat="server" EnablePartialRendering="true" />

<div style="text-align:left;width:500px; margin-left:8px">
    <div id="PanelContainer">
        <asp:UpdatePanel ID="AddEditContestUpdatePanel" runat="server" UpdateMode="Always">
            <ContentTemplate>
                <div id="background" style="text-align:left; height: 44px;">
                    <asp:Panel ID="ContestList" runat="server">
                        <asp:datagrid AllowSorting="false" id="ContestGrid" GridLines="None" CellPadding="5" 
                            Width="100%" AutoGenerateColumns="False" AlternatingItemStyle-BackColor="#cccccc" 
                            HeaderStyle-Font-Size="15px" HeaderStyle-Font-Bold="true" HeaderStyle-BackColor="#888f9b" 
                            Runat="server" AllowPaging="True" PageSize="10"
                            PagerStyle-NextPageText="Next >>" PagerStyle-PrevPageText="<< Back" >
                            <Columns>
                                <asp:HyperLinkColumn DataNavigateUrlField="ContestID" DataNavigateUrlFormatString="../?Load=AddEditContest&Type=Edit&ContestID={0}" 
                                    DataTextField="Title" ItemStyle-width="30%" headertext="Contest Title" />
                                <asp:BoundColumn DataField="StartDate" ItemStyle-Width="35%" HeaderText="Start Date" />
                                <asp:BoundColumn DataField="EndDate" ItemStyle-Width="35%" HeaderText="End Date" />
                            </Columns>
                        </asp:datagrid>
                        <div style="text-align:right;">
                            <asp:ImageButton ID="AddContest" runat="server" 
                                ImageUrl="~/Contest/Images/Add.png" AlternateText="Add Contest" 
                                onclick="AddContest_Click" />
                        </div>
                    </asp:Panel>
                    <asp:Panel ID="FieldsPanel" runat="server">
                        <p /><b>Title</b>
                        <br />
                            <asp:TextBox Runat="server" id="TitleText" />
                            <asp:RequiredFieldValidator id="TitleValidator" runat="server" ForeColor="Red"
                                ErrorMessage="Please add a title" ControlToValidate="TitleText">*</asp:RequiredFieldValidator>
                        <p /><b>Contest Description</b>
                            <br />
                            Use HTML tags to format this area. Start paragraphs with 
                            &lt;p /&gt; tag, bold items with &lt;b&gt;&lt;/b&gt; tags. Create a 
                            line-break between lines with one &lt;br /&gt; tag.<br />
                            <asp:TextBox Runat="server" ID="DescriptionText" TextMode="MultiLine" Width="400" Height="200" />
                            <asp:RequiredFieldValidator id="DescriptionValidator" runat="server" ErrorMessage="Please add a description" 
                                ControlToValidate="DescriptionText" ForeColor="Red">*</asp:RequiredFieldValidator>
                        <p />
                            <b>Contest Start Date</b>
                        <br />
                        <ew:CalendarPopup id="StartDate" runat="server" Text="Change Date" Width="75px" MonthYearArrowImageUrl="~/Images/monthchange.gif"
                            CalendarLocation="Left" ControlDisplay="TextBoxImage" ImageUrl="~/Images/calendar.gif" MonthYearPopupApplyText="Select"
                            CalendarWidth="150" UseExternalResource="True" ExternalResourcePath="~/Scripts/CalendarPopup.js" Nullable="False">
                            <WeekdayStyle Font-Names="Arial" ForeColor="Black" BackColor="White" Font-Size="9pt" />
                            <MonthHeaderStyle Font-Size="9pt" Font-Names="Arial" Font-Bold="True" ForeColor="White" BackColor="#669AC1" />
                            <OffMonthStyle ForeColor="Gray" BackColor="White" Font-Size="9pt" />
                            <GoToTodayStyle Font-Names="Arial" ForeColor="Black" BackColor="White"/>
                            <TodayDayStyle Font-Bold="True" ForeColor="#669AC1" BackColor="White" />
                            <DayHeaderStyle Font-Size="9pt" Font-Names="Arial" Font-Bold="True" ForeColor="Blue" BackColor="White" />
                            <WeekendStyle Font-Names="Arial" ForeColor="Blue" BackColor="LightGray" Font-Size="9pt" />
                            <SelectedDateStyle Font-Bold="True" ForeColor="White" BackColor="#669AC1" Font-Size="9pt"/>
                            <HolidayStyle Font-Names="Arial" ForeColor="Black" BackColor="White" />
                        </ew:CalendarPopup>
                        &nbsp;
                        <ew:TimePicker id="StartTime" runat="server" ControlDisplay="TextboxImage" Text="Change Time" 
                                ImageUrl="~/Images/clock.gif" NumberOfColumns="4" Scrollable="True" Width="75px">
                            <TimeStyle ForeColor="Blue" BackColor="White" Font-Size="9pt" />
                            <SelectedTimeStyle ForeColor="Blue" BackColor="Gray" />
                        </ew:TimePicker>
                        <p/><b>Contest End Date</b>
                        <br />
                        <ew:CalendarPopup id="EndDate" runat="server" Text="Change Date" Width="75px" MonthYearArrowImageUrl="~/Images/monthchange.gif"
                            CalendarLocation="Left" ControlDisplay="TextBoxImage" ImageUrl="~/Images/calendar.gif" MonthYearPopupApplyText="Select"
                            CalendarWidth="150" UseExternalResource="True" ExternalResourcePath="~/Scripts/CalendarPopup.js" Nullable="False">
                            <WeekdayStyle Font-Names="Arial" ForeColor="Black" BackColor="White" Font-Size="9pt" />
                            <MonthHeaderStyle Font-Size="9pt" Font-Names="Arial" Font-Bold="True" ForeColor="White" BackColor="#669AC1" />
                            <OffMonthStyle ForeColor="Gray" BackColor="White" Font-Size="9pt" />
                            <GoToTodayStyle Font-Names="Arial" ForeColor="Black" BackColor="White"/>
                            <TodayDayStyle Font-Bold="True" ForeColor="#669AC1" BackColor="White" />
                            <DayHeaderStyle Font-Size="9pt" Font-Names="Arial" Font-Bold="True" ForeColor="Blue" BackColor="White" />
                            <WeekendStyle Font-Names="Arial" ForeColor="Blue" BackColor="LightGray" Font-Size="9pt" />
                            <SelectedDateStyle Font-Bold="True" ForeColor="White" BackColor="#669AC1" Font-Size="9pt"/>
                            <HolidayStyle Font-Names="Arial" ForeColor="Black" BackColor="White" />
                        </ew:CalendarPopup>
                        &nbsp;
                        <ew:TimePicker id="EndTime" runat="server" ControlDisplay="TextboxImage" Text="Change Time" 
                                ImageUrl="~/Images/clock.gif" NumberOfColumns="4" Scrollable="True" Width="75px">
                            <TimeStyle ForeColor="Blue" BackColor="White" Font-Size="9pt" />
                            <SelectedTimeStyle ForeColor="Blue" BackColor="Gray" />
                        </ew:TimePicker>
                    <p />
                        <asp:ImageButton ID="SaveContestButton" runat="server" AlternateText="Confirm" 
                        ImageUrl="~/Contest/Images/Confirm.png" onclick="SaveContestButton_Click" />
                </asp:Panel>
                <br />
                <asp:Label ID="MessageLabel" runat="server" />
                </div>
            </ContentTemplate>
            <Triggers>
                <asp:AsyncPostBackTrigger ControlID="SaveContestButton" EventName="Click" />
            </Triggers>
        </asp:UpdatePanel>
    </div>
    <uc:UpdatePanelAnimationExtender ID="upae" BehaviorID="animation" runat="server" TargetControlID="AddEditContestUpdatePanel">
        <Animations>
            <OnUpdating>
                <Sequence>
                    <%-- Store the original height of the panel --%>
                    <ScriptAction Script="var b = $find('animation'); b._originalHeight = b._element.offsetHeight;" />

                    <%-- Disable all the controls --%>
                    <Parallel duration="0">
                        <EnableAction AnimationTarget="SaveDefaultDescriptionButton" Enabled="false" />
                    </Parallel>
                    <StyleAction Attribute="overflow" Value="hidden" />

                    <%-- Do each of the selected effects --%>
                    <Parallel duration=".25" Fps="30">
                        <FadeOut AnimationTarget="PanelContainer" minimumOpacity=".2" />
                        <Resize Height="0px" />
                    </Parallel>
                </Sequence>
            </OnUpdating>
            <OnUpdated>
                <Sequence>
                    <%-- Do each of the selected effects --%>
                    <Parallel duration=".25" Fps="30">
                        <FadeIn AnimationTarget="PanelContainer" minimumOpacity=".2" />
                        <Length duration="2" fps="40" Property="style"  PropertyKey="height" 
                            StartValue="10"  EndValueScript="$get('animation').offsetHeight" 
                            AnimationTarget="animation" />
                        <%--Also tried the below
                        <Resize HeightScript="$find('animation')._originalHeight" />
                        --%>
                    </Parallel>

                    <%-- Enable all the controls --%>
                    <Parallel duration="0">
                        <EnableAction AnimationTarget="SaveDefaultDescriptionButton" Enabled="true" />
                    </Parallel>                            
                </Sequence>
            </OnUpdated>
        </Animations>
    </uc:UpdatePanelAnimationExtender>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T18:08:31.890

我不确定这是否是唯一的——这只是我跳出来的第一件事：但根据[参考文档](http://ajaxcontroltoolkit.com/Walkthrough/AnimationReference.aspx#ResizeAnimation)，你的`<Resize Height="0px" />`标签应该是`<Resize Height="0" Unit="px" />`.

为什么第二个比第二个`<Parallel> Duration`短`<Length> Duration`？

抱歉，这不是一个真正的答案，只是我乍一看可能遇到的一些问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-14T14:09:19.500

看了[Joe Stagner 的视频](http://www.asp.net/Learn/ajax-videos/video-164.aspx)后，我也尝试实现 ASP.NET AJAX UpdatePanelAnimation Extender，但我也很难实现调整大小动画。

我的问题如下：

> 我没有向*服务器端*事件处理程序添加 System.Threading.Thread.Sleep(1000) 语句。

您的代码示例不包含您的代码隐藏，因此这可能是您的问题。

这是另一个猜测：

> 如果您在“调整大小”标签上指定“AnimationTarget”属性可能会有所帮助。

```
<Resize AnimationTarget="PanelContainer" Height="0px" />
{...}
<Resize AnimationTarget="PanelContainer" HeightScript="$find('animation')._originalHeight" /> 
```

# asp.net - 如何按包含可空整数的列对gridview进行排序？

> ID：167509
> 
> 赞同：1
> 
> 时间：2008-10-03T15:46:20.070
> 
> 标签：asp.net, gridview

我有一个 GridView，其中一列绑定到一个包含可为空整数的对象属性。我将 SortExpression 设置为属性的名称，只要所有行都包含一个值，排序就可以完美地工作。但是，如果任何行包含 null，我会得到一个异常：

System.InvalidOperationException ：无法比较数组中的两个元素。你调用的对象是空的。

如何自定义排序或比较逻辑以处理 null 情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T15:48:13.577

Nullable 类型暴露了比较可空类型的比较方法，所以解决方法是重写 gridview 排序逻辑，手动指定比较：

```
gridview.Sorting += new GridViewSortEventHandler(gridView_Sorting);

protected void gridView_Sorting(object sender, GridViewSortEventArgs e)
{
    // Only add custom handling for the sort expression on the 
    // Nullable<int> column
    if (e.SortExpression == "MySortExpression")
    {
        // Convert datasource to a List<T>
        list.Sort(new Comparison<MyObjectType>(delegate(MyObjectType item1, MyObjectType item2)
        {
            return Nullable.Compare<int>(item1.NullableIntProp, item2.NullableIntProp);
        }));

        // Bind the sorted list back to the gridview
    }
    else
    {
        // delegate to the gridview to handle its own sorting
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T15:56:53.577

您也可以在绑定数据时覆盖 null，而是放置一个 0。你的答案要好得多。:)

您还可以创建一个覆盖比较运算符的自定义类型。但这只会重复（并复杂化）您上面的内容。

# development-environment - 在 PC 上的 VM 上进行开发的优缺点

> ID：167512
> 
> 赞同：11
> 
> 时间：2008-10-03T15:46:30.837
> 
> 标签：development-environment, virtual-machine, environment

我最近为自己构建了一台半增强型 PC（Q9450、8GB DDR2 1066、1TB 硬盘、双 8600GT、Vista Ultimate 和双 22' 显示器），我正在评估我是否应该在 Vista 之上的 VPC/VMWare 会话上进行开发，或者不是？

我可以看到的一个好处是我可以在我的 Vista 笔记本电脑上运行相同的 VM，因此我的开发环境在我的任何机器上都是相同的。我还计划在年底之前购买 MBP。

在网上找到了几篇对[这里有帮助的文章](http://www.devx.com/vmspecialreport/Article/30410/1954)

任何其他想法将不胜感激？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T18:06:35.840

VM 的另一个优点是拥有干净的安装基础。除了开发之外，我还将台式机和笔记本电脑用于很多事情。您永远不知道您安装的软件何时会发生冲突，或者小调整以及您不玩的东西是否会破坏您的操作系统。重新安装/配置所有工具以使它们完全符合您的要求可能需要相当长的时间。如果您有开发 VM 映像的备份，您可以随意弄乱您的 PC，但仍然可以在不停机的情况下进行编码。它还允许您在您更喜欢 Linux 或 MacOS 的机器上运行 Win/Visual Studio/Etc。

您还可以制作同一图像的多个副本，并将每个副本用于单独的项目。

能够在笔记本电脑/台式机/服务器/远程连接之间进行转换，并且始终处于相同的环境中也非常有帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T16:35:20.393

对于 web 开发，我喜欢将服务器部分分离到一个 VM 中。我目前的设置是一台 Macbook Pro，里面有几个 Debian VM。我喜欢它的隔离方面。我可以在服务器上尝试新软件，如果出现问题，我可以将它们恢复。

我通过主机系统上的 Textmate 中的网络共享（samba）进行编程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T16:03:38.867

我发现的一个问题（至少在使用 VMWare Server 时）是，无论你的机器有多快，屏幕刷新率仍然在 ~30hz 左右。使用一段时间后，这会带来一点不愉快的体验。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-03T17:28:13.330

我现在工作的地方是我的所有开发都使用 VM，因为我没有 XP 基础副本的管理员权限。

优点：我喜欢使用虚拟机，因为它给了你一些灵活性——你可以在机器之间切换——有程序在两者上运行并且有一个很酷的工作环境。

缺点：
您必须启动多个操作系统。这需要时间、内存和资源。

VM 上的剪贴板操作有时会很有趣。有时复制到剪贴板不起作用或在 VM 之间混淆。（使用 VMWare）。

当您插入 USB 驱动器和其他外部设备时，文件操作可能会很有趣。虚拟机有时看不到设备，有时会。

如果您的 VM 映像损坏 - 您可以轻松地丢失其中的所有内容......除非它被备份......

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T15:49:43.730

它非常适合展示开发演讲，您可以恢复到快照，每次都从完全相同的起点开始演讲。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T16:01:50.337

我最近在 Linux 上使用 Windows XP vm 使用 Visual Studio 做一些工作，不知何故，制作 vm (vmware) 的人使 Windows 机器实际上运行得更快。我们做了一些时间测试以确保它不是主要的，但有一些东西（例如自动完成）确实弹出得更快。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T18:26:20.450

很长一段时间以来，我们一直在开发非常早期的 Visual Studio 2005 版本以及随之而来的相关 .Net 位。为了保护我们的真实机器免受与预发布软件相关的各种问题，我们在虚拟机中完成了所有的开发工作。它工作得非常好。我一直在考虑回到那个模型，因为它使升级物理硬件变得轻而易举（更不用说通过更换整台机器更容易处理硬件故障）：你只需复制 VM 映像。

在我当前的机器（4GB RAM 的 Core2Duo）上，运行一个 VM 时的性能下降几乎不明显。然而，运行两个虚拟机是很痛苦的。

我也无法弄清楚如何让 VMWare Server 在两台显示器上正常工作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-26T19:23:48.963

我不想在虚拟机中开发，而是在虚拟机中测试东西。例如，最好设置几个虚拟机来模拟 n 层架构，或者客户端-服务器设置，或者最后只是在多个操作系统上测试代码

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-03T16:42:58.490

如果您使用的是 Windows，Virtual PC 非常适合开发工作。VMWare 虚拟服务器并不是真正为用作桌面而设计的，长时间使用它会让您感到非常厌倦。Sun 的 VirtualBox 是与 Virtual PC 竞争的另一个选择。VMWare 有一个工作站产品，但它不是免费的。

通常，我在真实桌面（非虚拟）上进行开发，然后部署或测试到可以轻松快照和回滚的虚拟机。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-03T15:48:50.377

如果要使用 VMWare，请在未来的 MacBookPro 上增加 RAM。我还没有（还），打开其他几个（mac 端）应用程序的性能确实开始变得迟缓。

一切顺利。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-03T16:03:33.750

这取决于您正在开发什么以及使用什么语言。

VM 在磁盘访问上往往会受到相当大的打击，因此编译可能会显着减慢，尤其是对于大型 C/C++ 项目。不确定这是否是 .NET/Java 的问题。

如果您正在做任何图形密集型（3D、视频等）的事情，那么我也会避开虚拟机。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-03T18:25:16.413

在家里进行开发时，我必须通过 VPN 进入我的公司才能使用 Intranet 上的协作工具。我还有一台台式机+笔记本电脑，它们通过 Synergy 连接在一起。

我遇到的问题是，我们的 VPN 软件希望事情如此安全，以至于它会强制所有网络路由通过 VPN 网关——即使我使用额外的 NIC 通过单独的专用网络将我的台式机和笔记本电脑联网。最终结果是我无法同时在我的台式机和笔记本电脑之间使用 Synergy 以及 VPN 进入我的公司。

一位同事向我建议的解决方案是在我的桌面上设置一个 VM 实例并将其用于我所有的 VPN 需求。奇迹般有效！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-03T16:23:44.380

我不知道它作为开发平台是否如此有用，除非您正在做一些与您不想安装在常规工作机器上的软件相关的事情，或者需要解决您需要解决的某个事件可以定期重置。当您使用可能导致计算机崩溃的代码时，它也很方便，因为它至少只会使您的 VM 崩溃。

测试不同的配置和设置非常棒 - 与安装程序等一起工作，这就是我所关心的虚拟化真正闪耀的地方，能够在需要时回滚并重复运行东西对于识别非常有用在最终用户遇到问题之前解决问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-12-30T14:58:15.527

根据在 Windows 7 上的 Ubuntu VM 中开发 Java 的个人经验，我发现这非常有效。主要是因为我的本地 IT 支持支持 Windows 7，所以我可以做一些事情，比如访问 Windows 中的所有本地文件共享和打印机，然后将我的 Ubuntu VM 配置为我心中的内容。

远程访问和桌面共享带来的巨大生产力优势。Windows 让我能够非常快速、轻松地使用 logmein.com 和 join.me 等工具从家里访问我的机器，并与公司中的其他人共享桌面上的虚拟机（两者都可以在几乎全屏的窗口中与虚拟机无缝协作） . Linux 不支持这些服务，我不想在 Ubuntu 上处理所有相关的 VNC/X 设置和网络配置。

我的机器相当强大。四核，16Gb RAM - 8Gb 用于 VM。VM 中的 Java 开发速度非常快。

# java - 裸对象。是好是坏

> ID：167517
> 
> 赞同：16
> 
> 时间：2008-10-03T15:47:55.420
> 
> 标签：java, frameworks, naked-objects

我最近接触过裸露的物体。它看起来像一个相当不错的框架。但是，我没有看到它像 Spring 这样广泛使用。那么为什么这个框架没有得到任何主流应用的认可。如您所见，它的缺点是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-30T19:50:10.560

根据我使用 NOF 3.0.3 的经验...

好的：

*   自动为您的域对象生成 DnD UI，就像 db4o 为持久性所做的那样。
*   根据 MVC 模式创建者的说法，这就是 MVC 一直以来的意义所在。
*   该框架仅要求您的域对象 (POJO) 从 AbstractDomainObject 子类化，这就是所有最少的布线。
*   该框架支持约定 OVER 配置：大量注释没有可怕的 XML 配置文件。
*   非常适合与 db4o 一起进行原型设计以实现持久性。
*   Hibernate 的开箱即用功能。
*   就我而言，从下载到 Hello world 应用程序需要 30 分钟。(IntelliJ IDEA IDE)
*   部署为 JNLP、独立、Web（NOX​​ 嵌入式 Jetty 或 Simpi 风格）和 Eclipse RCP。
*   当您在论坛中寻求帮助时，NOF 团队始终在您身边。
*   裸对象模式是一个很棒的想法，帮自己一个忙，花点时间去了解它。
*   围绕拖放 GUI 存在很多可用性问题，但如果您的潜在最终用户根本***无法*** 使用 DnD UI，那么无论如何您都会遇到大麻烦。

坏处：

*   没有我能想到的。

有点丑：

*   不允许使用 Swing 组件，因此告别 JGoodies 和所有您喜欢的 Swing 组件集。UI 组件是定制的；让您了解它们看起来像 90 年代早期的 VB 控件。但是有一个 SWT 端口正在开发中。
*   长字符串的多行行字段存在一些问题。（NOF 3.0.3）
*   图像的 DnD UI 有点问题。
*   仅当从 UI 修改域对象时才会触发 getter n setter 的验证代码。（由于我的 n00bness，这可能是错误的，希望 NOF 提交者纠正我）
*   如果一个对象是从一个非 ui 线程修改的，比如说一个 bg worker，这样的对象将
    不会更新它在屏幕上的视图。这会使用例（例如在 DnD 自动生成的 UI 上实时表示邮件队列）无效。（再次）

*   维克

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-09-15T00:58:06.473

我已经研究裸对象方法一年多了，我什至还没有开始触及它为您的系统架构提供的可能性的表面。但是，要正确利用它，它需要您创建一个范式转变并寻找完整的 OO 解决方案，并从诉诸功能性的鸭带式磁带中恢复过来，因为范式似乎只有在您创建允许高级开发的设计时才有效。

话虽如此，我绝对喜欢 Django 如何在其 Django 模型中实现裸对象。我喜欢这个框架的大部分东西，我开始相信，它的模型的直接结果，我想分享一些关于架构的令人惊叹的东西：

映射到表列的模型字段在行为上是完整的对象——它们知道它们在应用程序和数据库域中是如何表示的，它们如何在两者之间进行转换，以及它们所持有的信息如何被验证并显示给用户视觉输入。所有这些都在您的模型中使用了一行代码。**哇**！

管理器附加到模型并提供 CRUD 和集合上的任何通用操作，例如可重用查询（给我最近五篇博文、最常出现的标签等）、批量删除/更新操作以及在实例上执行的业务逻辑。**哇**！

现在考虑您有一个代表用户的模型。有时，您只想查看用户模型所持有的所有信息的部分视图（重置用户密码时，您可能只需要用户的电子邮件和他的秘密问题）。他们提供了一个 Forms API，可以准确地显示和管理模型数据的一部分的输入。允许对处理用户输入的内容/方式进行任何自定义。**哇**！

最终结果是您的模型仅用于描述您用于描述特定领域的信息；管理人员对模型执行所有操作；表单用于创建视图和处理用户输入；控制器（视图）仅用于处理 HTTP 动词，如果它们与模型一起使用，则仅通过管理器和表单；视图（模板）用于演示（无法自动生成的部分）。恕我直言，这是一个非常干净的架构。不同的管理器可以跨不同的模型使用和重用，可以为模型创建不同的表单，不同的视图可以使用不同的管理器。这些分离度允许您快速设计您的应用程序。

您创建了一个智能对象生态系统，并通过它们相互连接的方式获得了一个完整的应用程序。假设它们是松散耦合的（有很多可能性让它们以不同的方式进行通信）并且可以很容易地修改和扩展（针对特定要求的几行代码），遵循范式，你确实得到了一个架构，你可以组件编写一次，然后在您的其他项目中重复使用。这就是 MVC 应该一直做的，但我经常不得不从头开始编写一些东西，即使我在几个项目前做过同样的事情。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-03T15:56:45.993

它已[在爱尔兰](http://www.nakedobjects.org/case-study/dsfa-intro.shtml)成功使用。

我认为它没有更受欢迎的原因是：

*   您需要对正在使用的工具包充满信心
*   它使 GUI 成为一个风险因素，而不是一个不费吹灰之力的因素（无论是在技术上还是在可用性测试中）
*   它不适用于网络（据我所知），这是大多数焦点所在的地方......

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-19T12:30:42.597

我才看到这个。一些小的更正，否则大多数评论都非常公平。

1）“框架只要求您的域对象（PO​​JO）从 AbstractDomainObject 子类化，这就是所有最少的布线。”

裸对象不需要从 AbstractDomainObject 子类化域对象，尽管这通常是最方便的做法。

如果您不想继承，您只需提供 IDomainObjectContainer 类型的属性，然后框架将在创建或检索对象时将容器注入到您的对象中。该容器具有 Resolve()、ObjectChanged() 和 NewTransientInstance() 方法，它们是您必须使用的与框架的三个极简接触点，以便框架与您的域对象保持同步。

2) '非常适合与 db4o 一起进行原型设计以实现持久性'。我们非常热衷于使用 db4o 的想法，但我不知道有谁让 Naked Objects 和 db4o 一起玩。如果有人做过这件事，我想听听更多关于它的信息。

3) '在 smalltalk 和裸对象社区中所拥护的公民程序员的一般模型......'。我们从来没有支持过这个想法，我也不同意。Naked Objects 并不是要鼓励用户编程。我坚信专业开发人员的角色 - Naked Objects 只是帮助他们编写更好的软件和更高效。

理查德

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-03T19:17:56.353

去年左右我玩过它，并得出结论它很容易使用。

Naked Objectsis 的优势在于您可以免费获得根据您的数据模型构建的 GUI。缺点是典型的用户不会将他的过程视为记录的集合。

我的结论是，Naked Objects 非常适合在概念上处理记录的内部应用程序，例如库存应用程序或账单处理应用程序。

如果您需要任何不同的东西，使框架适应您的愿望可能比使用为支持您想要的应用程序而编写的框架要多得多的工作。

顺便说一句，有一个 Web 渲染选项；请参阅[Naked Objects Demo](http://www.nakedobjects.org/demo/index.shtml)中的演示。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-03T16:03:08.167

Gareth 提出了一些很好的观点。

还有其他问题，例如很难控制外观和感觉，对于已经习惯了窗口模型的人来说，它们是违反直觉的。还有一些建模问题，因为并非所有应用程序域都适合直接对象表示。

在 smalltalk 和裸对象社区中所拥护的“公民程序员”的一般模型也被认为是一个值得怀疑的想法。大多数用户似乎对自己更改功能并不太在意，因此在对象中思考并不是那么有用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-04T01:31:12.870

可能它没有得到更多关注的原因是 J2EE 世界已经习惯于在应用程序上堆积如此多的层，以至于裸对象显得幼稚。

我们的服务在哪里？你的意思是任何裸对象都可以让我立即访问数据库？如果我们需要使用 RMI 调用公开应用程序怎么办？

另外，市场上没有那么多，因为它将开发成功应用程序的负担直接放在应用程序开发人员而不是框架开发人员身上:)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-08T15:48:53.550

我想 NakedObject 肯定有它的相关性，而且开发人员社区重新关注真正支付给他们的东西：业务不仅仅是时间。相反，我们大部分时间都花在基础设施、协议和所有那些技术垃圾上。我见过这样的构建应用程序，我什至按照主流自己做了一些，告诉你分层系统总是一件好事。最糟糕的是，如果你问一些开发人员他们所在的公司从事什么样的业务，你会发现至少有一些在公司工作多年但对业务没有深入了解的人。然而，

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-04-30T06:23:44.180

NakedObjects (NO) 适用于快速原型设计。您可以专注于领域模型，而无需关注 GUI、DB 和解决方案的其他部分。对于生产，它需要在 NakedObjects 框架本身中进行大量改进（错误修复、数据映射、gui 等）。

因此，如果您需要为您的解决方案获得某种“概念证明”，您可以使用 NO。但是对于生产来说，准备好将资源投入到 NO 框架的开发中。

顺便说一句，最近我们正在努力为 NO 4.0 创建基于 GWT 的 DnD 查看器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-23T09:40:51.537

*   技术的广泛使用与技术质量没有很强的相关性。
*   裸对象系统很难与类型对象结合使用：如果我销售不同种类的产品并且需要针对不同产品的不同数据，则很难将数据限制在产品类型上。
*   他们转换许可证时没有失去动力。（到 GPL+Commercial，而不是最近转向 Apache）

你看过jmatter吗？

[编辑] 还有一个：如果你能交付，这对非程序员来说是显而易见的。Spring 在技术领域非常重要，NO 意味着开发人员必须与用户交谈。大型组织不这样做。

# audio - 最佳语音压缩算法/格式

> ID：167533
> 
> 赞同：8
> 
> 时间：2008-10-03T15:50:53.870
> 
> 标签：audio, compression

我们有一些原始语音音频，需要通过互联网分发。我们需要体面的质量，但它不需要具有音乐质量。我们主要关心的是消费者的可用性（即他们可以播放什么以及在哪里播放）和下载的大小。我的经验表明，mp3 不会产生最佳的语音音频压缩数字，但我不知道最好的选择是什么。最终，我们希望将转换过程自动化，以允许消费者选择他们想要的质量与尺寸水平。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-08-19T22:56:34.030

你应该试试[Opus 。](http://en.wikipedia.org/wiki/Opus_%28codec%29)压缩命令行示例：

```
ffmpeg -i x.wav -b:a 32k x.opus 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T16:04:44.060

[从这里开始。](http://en.wikipedia.org/wiki/Speech_encoding)

正如您正确指出的那样，语音压缩不同于一般的音频压缩。您会发现许多专用于电话应用程序的编解码器，从 PCM 和 ADPCM 到后来的基于数据包的编码，例如用于 GSM 蜂窝网络的 CELP。

尽管如此，由于所使用的介质，VOIP 语音编码与语音编码略有不同。[您可以在Speex 软件库](http://en.wikipedia.org/wiki/Speex)中找到用于语音编码/解码的良好、免费（无阻碍和开源 (BSD)）库。

同样，您选择哪种取决于您正在编码的语音和传输它的介质。另请注意，许多库有几种算法可以根据情况使用，有些甚至会根据声音和网络的条件即时切换。

要获得更多帮助，请缩小您的问题范围。

-亚当

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T16:06:12.807

现场语音音频（如 VoIP 电话）中最常用的压缩格式是 μ-Law（在美国使用 mu-Law/u-Law）和 a-Law（在欧洲使用等），这与未压缩PCM，不支持那么宽的频率范围（较小的可能值范围会忽略必要频谱之外的声音，并且需要较少的存储空间）。

出于可用性考虑，最简单的方法是使用 mpeg 压缩 (mp2/3/4) 流式传输到标准媒体播放器，因为算法很容易获得并且通常非常快并且几乎所有媒体播放器都应该支持它，但对于语音，您可以尝试指定较低的比特率或首先从较低质量的文件进行转换（WAV 可以有多个采样率，语音需要比音乐或效果低得多的采样率，它基本上就像视频上的每秒帧数）。或者，您可以使用 Real Media、WMA 或其他专有格式，但这会限制可用性，因为用户需要特定的第三方软件才能播放，尽管 WMA 具有出色的压缩率以及特定于语音音频的压缩选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T16:04:19.207

假设您的用户将运行 Windows，您可以将 WMA 语音压缩编解码器与 Windows Media Encoder SDK 一起使用。否则，您可以使用 ACM 来使用 G723/G728、ADPCM、mu-law 或 a-law 之类的东西，其中一些在 Windows XP 及更高版本上作为标准安装。这些可以打包在 WAV 文件中。您需要进行一些试验才能找到合适的比特率/质量（可能不要打扰 mu-law 或 a-law）。对于语音数据，您可以使用非常低的采样率（例如 16000 或 8000），因为在人类口语中没有超过 4Khz 的频率。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T16:06:48.190

我认为[AMR](http://en.wikipedia.org/wiki/Adaptive_Multi-Rate)是最好的语音编解码器之一。大约一年前我在使用它，我记得质量非常好，尺寸也很小。

一个缺点，尤其是在您的情况下，据我所知，它不受广泛的媒体播放器的支持。QuickTime 和 RealPlayer 是我知道播放 .amr 文件的两个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T16:52:49.987

试试[speex](http://speex.org/) ... 不受专利的限制，在尺寸和 CPU 方面都有良好的性能。我一直很幸运在 iPhone 上使用它。

# mysql - 如何在 MySQL 中声明多列 PK

> ID：167542
> 
> 赞同：1
> 
> 时间：2008-10-03T15:52:44.083
> 
> 标签：mysql, sql, database, ddl

我正在尝试创建一个包含两列的表，其中包含 MySQL 中的主键，但我无法弄清楚语法。我了解单列 PK，但创建具有两列的主键的语法不同。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-03T15:56:14.530

```
CREATE TABLE table_name 
(
    c1 INT NOT NULL,
    c2 INT NOT NULL,
    PRIMARY KEY (c1, c2)
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T15:57:09.567

尝试：

```
create table .....

primary key (`id1`, `id2`)
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T15:55:22.893

例子：

```
 CREATE TABLE `synthesis`.`INV_MasterItemList` (
   `MasterItemList_ID` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
   `Customer_ID` INTEGER UNSIGNED NOT NULL,
   `Model_ID` INTEGER UNSIGNED NOT NULL,
   `Serial` VARCHAR(45) NOT NULL,
   PRIMARY KEY (`MasterItemList_ID`),
   UNIQUE INDEX `INDEX_UNIQUE`(`Customer_ID`, `Model_ID`, `Serial`)
 ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T15:57:15.277

一个例子（来自 osCommerce）：

```
CREATE TABLE categories_description (
 categories_id int DEFAULT '0' NOT NULL,
 language_id int DEFAULT '1' NOT NULL,
 categories_name varchar(32) NOT NULL,
 PRIMARY KEY (categories_id, language_id),
 KEY idx_categories_name (categories_name)
); 
```

# linux - 如何知道是否有（编译入/内核模块）设备驱动程序控制正在运行的 linux 上的设备？

> ID：167562
> 
> 赞同：2
> 
> 时间：2008-10-03T15:56:35.573
> 
> 标签：linux, kernel-module, drivers

我如何知道正在运行的 Linux 上是否支持某个设备，如果支持，哪个设备驱动程序控制它？例如，`lspci`在服务器 (PowerEdge 2900) 上提供：

```
00:00.0 Host bridge: Intel Corporation 5000X Chipset Memory Controller Hub (rev 12)
00:02.0 PCI bridge: Intel Corporation 5000 Series Chipset PCI Express x4 Port 2 (rev 12)
00:03.0 PCI bridge: Intel Corporation 5000 Series Chipset PCI Express x4 Port 3 (rev 12)
00:04.0 PCI bridge: Intel Corporation 5000 Series Chipset PCI Express x4 Port 4 (rev 12)
00:05.0 PCI bridge: Intel Corporation 5000 Series Chipset PCI Express x4 Port 5 (rev 12)
00:06.0 PCI bridge: Intel Corporation 5000 Series Chipset PCI Express x8 Port 6-7 (rev 12)
00:07.0 PCI bridge: Intel Corporation 5000 Series Chipset PCI Express x4 Port 7 (rev 12)
00:08.0 System peripheral: Intel Corporation 5000 Series Chipset DMA Engine (rev 12)
00:10.0 Host bridge: Intel Corporation 5000 Series Chipset FSB Registers (rev 12)
00:10.1 Host bridge: Intel Corporation 5000 Series Chipset FSB Registers (rev 12)
00:10.2 Host bridge: Intel Corporation 5000 Series Chipset FSB Registers (rev 12)
00:11.0 Host bridge: Intel Corporation 5000 Series Chipset Reserved Registers (rev 12)
00:13.0 Host bridge: Intel Corporation 5000 Series Chipset Reserved Registers (rev 12)
00:15.0 Host bridge: Intel Corporation 5000 Series Chipset FBD Registers (rev 12)
00:16.0 Host bridge: Intel Corporation 5000 Series Chipset FBD Registers (rev 12)
00:1c.0 PCI bridge: Intel Corporation 631xESB/632xESB/3100 Chipset PCI Express Root Port 1 (rev 09)
00:1d.0 USB Controller: Intel Corporation 631xESB/632xESB/3100 Chipset UHCI USB Controller #1 (rev 09)
00:1d.1 USB Controller: Intel Corporation 631xESB/632xESB/3100 Chipset UHCI USB Controller #2 (rev 09)
00:1d.2 USB Controller: Intel Corporation 631xESB/632xESB/3100 Chipset UHCI USB Controller #3 (rev 09)
00:1d.3 USB Controller: Intel Corporation 631xESB/632xESB/3100 Chipset UHCI USB Controller #4 (rev 09)
00:1d.7 USB Controller: Intel Corporation 631xESB/632xESB/3100 Chipset EHCI USB2 Controller (rev 09)
00:1e.0 PCI bridge: Intel Corporation 82801 PCI Bridge (rev d9)
00:1f.0 ISA bridge: Intel Corporation 631xESB/632xESB/3100 Chipset LPC Interface Controller (rev 09)
00:1f.1 IDE interface: Intel Corporation 631xESB/632xESB IDE Controller (rev 09)
00:1f.2 IDE interface: Intel Corporation 631xESB/632xESB/3100 Chipset SATA IDE Controller (rev 09)
01:00.0 PCI bridge: Intel Corporation 80333 Segment-A PCI Express-to-PCI Express Bridge
01:00.2 PCI bridge: Intel Corporation 80333 Segment-B PCI Express-to-PCI Express Bridge
02:0e.0 RAID bus controller: Dell PowerEdge Expandable RAID controller 5
04:00.0 PCI bridge: Broadcom EPB PCI-Express to PCI-X Bridge (rev c3)
05:00.0 Ethernet controller: Broadcom Corporation NetXtreme II BCM5708 Gigabit Ethernet (rev 12)
06:00.0 PCI bridge: Intel Corporation 6311ESB/6321ESB PCI Express Upstream Port (rev 01)
06:00.3 PCI bridge: Intel Corporation 6311ESB/6321ESB PCI Express to PCI-X Bridge (rev 01)
07:00.0 PCI bridge: Intel Corporation 6311ESB/6321ESB PCI Express Downstream Port E1 (rev 01)
07:01.0 PCI bridge: Intel Corporation 6311ESB/6321ESB PCI Express Downstream Port E2 (rev 01)
08:00.0 PCI bridge: Broadcom EPB PCI-Express to PCI-X Bridge (rev c3)
09:00.0 Ethernet controller: Broadcom Corporation NetXtreme II BCM5708 Gigabit Ethernet (rev 12)
0b:02.0 Multimedia audio controller: Creative Labs SB Audigy (rev 03)
0b:02.1 Input device controller: Creative Labs SB Audigy Game Port (rev 03)
0b:02.2 FireWire (IEEE 1394): Creative Labs SB Audigy FireWire Port
10:0d.0 VGA compatible controller: ATI Technologies Inc ES1000 (rev 02) 
```

我怎样才能找到：

1.  哪个设备驱动程序（内核模块）控制每个设备？
2.  哪个设备由内核中编译的设备驱动程序控制*（*而不是作为模块）
3.  哪个设备没有设备驱动程序（编译或作为模块编译）？

这个脚本（改编自“Linux Kernel in a Nutshell”中的另一个脚本）部分解决了 #1：

```
#!/bin/bash
for i in $(find /sys/ -name modalias); do
    echo "----------------------------------"
    modalias=$(cat $i)
    echo "$(dirname $i) -->  $modalias" 
    /sbin/modprobe --config /dev/null --show-depends $(cat $i) 2>&1
done 
```

但它存在一些问题：

1.  我不知道转换 为 的*自动方式*`/sys/devices/pci0000:00/0000:00:1e.0/0000:10:0d.0 --> pci:v00001002d0000515Esv00001028sd000001B1bc03sc00i00``10:0d.0 VGA compatible controller: ATI Technologies Inc ES1000 (rev 02)`

2.  在某些情况下，这些设备是 MB 内部的，我什至不知道如何找到设备的真实名称。例如：

```
/sys/devices/platform/dcdbas -->  platform:dcdbas
/sys/devices/platform/iTCO_wdt -->  platform:iTCO_wdt
/sys/devices/LNXSYSTM:00 -->  acpi:LNXSYSTM:
/sys/devices/LNXSYSTM:00/device:00/PNP0C33:00 -->  acpi:PNP0C33:PNP0C01:
/sys/devices/LNXSYSTM:00/device:00/PNP0A08:00 -->  acpi:PNP0A08:PNP0A03:
/sys/devices/LNXSYSTM:00/device:00/PNP0A08:00/device:0d/PNP0200:00 -->  acpi:PNP0200: 
```

和许多其他人。

3.  当设备驱动程序被*编译*（或不存在）时，响应是`FATAL: Module _XXXX_ not found.`指示设备没有模块。

在某些情况下，驱动程序被编译在（例如）

```
/sys/devices/platform/serial8250 -->  platform:serial8250
FATAL: Module platform:serial8250 not found.

/sys/devices/platform/i8042 -->  platform:i8042
FATAL: Module platform:i8042 not found. 
```

在其他情况下，驱动程序根本不存在。但我不知道如何区分。

有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T16:04:31.813

我认为您无法在 Windows 设备管理器中获得 100% 明确的答案。

*   一个设备可以由几个内核模块（比如`nvidia`+ `agpgart`）控制。
*   一个内核模块可以控制多个设备 ( `usbhid`)。
*   你也可以有多对多的关系（`usbcore`+ `usbhid`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T20:23:33.943

试试**HAL 设备管理器**，它也可用作“KDE HAL 设备管理器”和“gnome-device-manager”。基本上，这些是硬件抽象层（HAL）的前端，它读取`/sysfs/`等。

它提供诸如“info.linux.driver”之类的信息，请参见下面的屏幕截图：

[![](https://i3.photobucket.com/albums/y69/kagesenshi/blog-uploads/060728-1.jpg)](https://i3.photobucket.com/albums/y69/kagesenshi/blog-uploads/060728-1.jpg)

对不起，我不知道如何自己在 sysfs 中整理出这些信息，但如果 HAL 能够找到它，它一定在某个地方:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-05T02:30:24.997

lspci -n 将为您提供您可以在[linux 内核驱动程序数据库](http://cateee.net/lkddb/)中搜索的 PCI id 。这将告诉您要启用哪些内核选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-03T17:00:29.507

好吧，这有点晚了，也许当时（2008 年）甚至不存在，但是 lspci -n 或更好的 lspci -k 应该可以解决问题；例如：

> 04:00.0 网络控制器：Broadcom Corporation BCM4312 802.11b/g (rev 01)
> 
> ```
>  Kernel driver in use: wl
>     Kernel modules: wl, ssb 
> ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T06:39:34.077

以下脚本将告诉您哪些动态加载的驱动程序正在运行，尽管我还想要一种自动化的方式来确定哪些编译的模块实际上也在使用中，这样我就可以进一步消除内核的膨胀。

```
#!/bin/bash
/sbin/lsmod | tail -n+2 | cut -d" " -f1 | xargs /sbin/modinfo -n | sort ; 
```

我不确定其余部分与您的问题有多大的相关性，但认为您或其他人可能会发现它很有用。

以下代码将确定哪些 .config 选项控制每个动态加载的内核模块，尽管我还没有想出对 ubuntu lum 包中的动态模块执行相同操作的方法（此脚本仍在进行中):

```
#!/usr/bin/perl -w

use strict;
use Getopt::Long;

my ($kernConfigIn, $kernConfigOut, $kernSourceDir, $lumSourceDir, $lumConfigIn, $lumConfigOut, $help);

GetOptions(
    'ksd=s'   => \$kernSourceDir,
    'lsd=s'    => \$lumSourceDir,
    'kci=s'      => \$kernConfigIn,
    'lci=s'       => \$lumConfigIn,
    'kco=s'      => \$kernConfigOut,
    'lco=s'       => \$lumConfigOut,
    'help' => \$help);

if ($help || !$kernSourceDir || !$lumSourceDir ) { Usage($0); }

sub Usage {  print "usage error\n"; exit; };

my @modules = `/sbin/lsmod | tail -n+2 | cut -d" " -f1 | xargs /sbin/modinfo -n | sort ;`;
my @kconfig;

foreach my $module (@modules) {
    my ($package, $path, $modName) = ( $module =~ m/\/((?:kernel)|(?:ubuntu))\/(.*)\/(.*)\.ko/) ;
    $package eq 'kernel' ? push @kconfig, kernel($package, $path, $modName) : ubuntu($package, $path, $modName); 
}

# kernel package
sub kernel {
    my ($package, $path, $modName) = @_;
    my $makefile = $kernSourceDir.$path."/Makefile"; 
#    print "$package, $path, $modName\n";
#    print "$makefile\n";
    my $option;
    chomp($option = `cat $makefile | sed -n "s/^obj-\\\$(CONFIG_\\([A-Z0-9_]*\\))\\W*+=.*"$modName"\\.o.*/CONFIG_\\1/p"`);
    print "$option\n";
    return $option;
}

# deal with lum configs
sub ubuntu {

} 
```

Andreas Goelzer 有一个脚本，稍加修改就会关闭 .config 中所有未使用的内核模块，从而显着加快编译速度。

你可以在这里找到它：

[http://andreas.goelzer.de/kernel-config-based-on-lsmod-output](http://andreas.goelzer.de/kernel-config-based-on-lsmod-output)

# c# - NUnit：在单个测试中运行多个断言

> ID：167567
> 
> 赞同：6
> 
> 时间：2008-10-03T15:57:13.280
> 
> 标签：c#, unit-testing, nunit

我被要求编写一个测试应用程序，需要在数据库中的多行上测试一个新的存储过程，本质上我想做这样的事情：

```
[Test]
public void TestSelect()
{
    foreach(id in ids)
    {
        DataTable old = Database.call("old_stored_proc",id);
        DataTable new_ = Database.call("new_stored_proc",id);

        Assert.AreEqual(old.Rows[0]["column"],ne_.Rows[0]["column"]);
    }
} 
```

当我运行此测试时，如果 1 行与另一行不匹配，则整个测试失败；相反，我想计算断言通过了多少次，失败了多少次。有没有办法用 NUnit 做到这一点？

我意识到 NUnit 可能是矫枉过正，没有它这是一项简单的任务......我只是想学习它。;)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-03T16:07:19.403

好像你只是在断言错误的事情。如果您想检查所有值，然后断言没有错误（或显示错误数），请尝试以下操作：

```
[Test]
public void TestSelect()
{
    int errors = 0;
    foreach(id in ids)
    {
        DataTable old = Database.call("old_stored_proc",id);
        DataTable new_ = Database.call("new_stored_proc",id);

        if (old.Rows[0]["column"] != new_.Rows[0]["column"])
        {
            errors++;
        }            
    }

    Assert.AreEqual(0, errors, "There were " + errors + " errors.");
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T16:21:56.130

1) 如果 id 是恒定的并且在测试运行时未查找，则为每个 id 创建一个单独的单元测试夹具。这样你就会知道哪个 id 实际失败了。有关数据驱动测试问题的文章，请参见此处：http:
[//googletesting.blogspot.com/2008/09/tott-data-driven-traps.html](http://googletesting.blogspot.com/2008/09/tott-data-driven-traps.html)

2）如果您需要动态查找 id，从而无法为每个 id 创建一个固定装置，请使用 akmad 的建议进行一次更改。保留值不相等的 id 列表，并将列表添加到错误消息中。诊断仅说明错误数量的失败测试将非常困难，因为您不知道是什么 id 导致了错误。

3）我不知道在 NUnit 中做起来有多难，但是在 PyUnit 中，当我们需要对动态生成的数据运行测试时，我们会动态创建测试夹具并将它们附加到 TestCase 类，这样我们就有了失败对每条未通过的数据进行测试。虽然我想如果没有 python 的动态能力，这会更加困难。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-05-28T06:22:03.517

我知道这个问题是专门针对 NUnit 的，但有趣的是，[Gallio/MbUnit](http://gallio.org)有一个特性，它允许同时运行和捕获多个断言。

```
[Test]
public void MultipleTest()
{
    Assert.Multiple(() =>
    {
       Assert.IsTrue(blabla);
       Assert.AreEqual(pik, pok);
       // etc.
    }
} 
```

`Assert.Multiple`正在捕获**所有**失败的断言，并将在测试结束时报告它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T16:03:54.107

我将计算不匹配的行数，然后编写一个断言，将这个数字与 0 进行比较，并返回消息中不匹配字符串的数量。

你也可以用`Assert.Greater`这个。

PS原则上，您应该尝试为每个单元测试做一个断言。这就是它的要点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T16:01:12.910

好吧，您可以声明一个计数器，然后断言计数器的值以确定通过/失败

此外，您可以在测试设置中完成大部分工作，然后创建多个测试。

我不清楚为什么您需要在同一个测试中使用所有断言 stmts。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-09T13:43:53.357

根据您制定的目标，如果一行与另一行不匹配，整个测试**应该会失败。**计算一个断言通过或失败的次数比将预期结果与实际得到的结果进行比较所提供的信息更少。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-09T17:48:39.607

我最近有同样的问题。我将计数错误的想法与 Yann Trevin 提到的 Assert.Multiple 结合到 IEnumberable 的扩展方法中，它让我可以执行以下操作：

```
[Test]
public void TestEvenNumbers()
{
    int[] numbers = new int[] { 2, 4, 12, 22, 13, 42 };
    numbers.AssertAll((num) => Assert.That((num % 2) == 0, "{0} is an odd number", num));
} 
```

这导致 NUnit 输出：

```
TestEvenNumbers:
  5 of 6 tests passed; 0 inconclusive
FAILED: 13:   13 is an odd number
  Expected: True
  But was:  False

  Expected: 6
  But was:  5 
```

OP问题的解决方案是：

```
[Test]
public void TestSelect()
{
    ids.AssertAll(CheckStoredProcedures);
}

private void CheckStoredProcedures(Id id)
{
    DataTable old = Database.call("old_stored_proc",id);
    DataTable new_ = Database.call("new_stored_proc",id);

    Assert.AreEqual(old.Rows[0]["column"], new_.Rows[0]["column"]);
} 
```

这是扩展方法（请注意，为了与 Linq 术语保持一致，我使用了“All”而不是“Multiple”）：

```
using System;
using System.Text;
using System.Collections.Generic;
using NUnit.Framework;

public static class NUnitExtensions
{
    public static void AssertAll<T>(this IEnumerable<T> objects, Action<T> test)
    {
        int total = 0;
        int passed = 0;
        int failed = 0;
        int inconclusive = 0;
        var sb = new StringBuilder();
        foreach (var obj in objects)
        {
            total++;
            try
            {
                test(obj);
                passed++;
            }
            catch (InconclusiveException assertion)
            {
                inconclusive++;
                string message = string.Format("INCONCLUSIVE: {0}: {1}", obj.ToString(), assertion.Message);
                Console.WriteLine(message);
                sb.AppendLine(message);
            }
            catch (AssertionException assertion)
            {
                failed++;
                string message = string.Format("FAILED: {0}: {1}", obj.ToString(), assertion.Message);
                Console.WriteLine(message);
                sb.AppendLine(message);
            }
        }

        if (passed != total)
        {
            string details = sb.ToString();
            string message = string.Format("{0} of {1} tests passed; {2} inconclusive\n{3}", passed, total, inconclusive, details);
            if (failed == 0)
            {
                Assert.Inconclusive(message);
            }
            else
            {
                Assert.AreEqual(total, passed, message);
            }
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-06-20T15:15:08.317

如果是简单的硬编码 ID 列表，则可以使用[`[TestCase()]`属性。](https://github.com/nunit/docs/wiki/TestCase-Attribute)

```
[Test]
[TestCase(1234)]
[TestCase(5678)]
[TestCase(7654)]
public void TestSelect(int id)
{
    DataTable old = Database.call("old_stored_proc", id);
    DataTable new_ = Database.call("new_stored_proc", id);

    Assert.AreEqual(old.Rows[0]["column"], new_.Rows[0]["column"]);
} 
```

这将为每个 ID 生成三个单独的测试，并且您使用的任何 nunit 测试运行器都将显示通过/失败计数。

如果需要生成 ID 的动态列表，则建议使用[`[TestCaseSource()]`属性](https://github.com/nunit/docs/wiki/TestCaseSource-Attribute)。

# c# - 在只有 2.0 框架的服务器上执行编译的 3.5 代码时出现问题

> ID：167569
> 
> 赞同：3
> 
> 时间：2008-10-03T15:58:19.890
> 
> 标签：c#, asp.net, .net-3.5

我似乎无法在我的开发服务器上启动并运行我的应用程序，我不知道为什么。

我在 VS 2008 中编译了我的代码，目标框架为 3.5。我使用 3.5 主要是因为我已经相当广泛地实现了 LINQ。在本地编译和运行没有任何问题。

问题是我的服务器只有 2.0 .Net 框架，升级到 3.5 显然不会发生。

在做了一些研究之后，我的印象是，只要我尝试执行已编译的代码，服务器就不需要安装 3.5。

今天我试图发布到服务器，但我无法在我的 WEB.CONFIG 中解决这个错误

配置错误

解析器错误消息：不允许子节点。

providerOption name="CompilerVersion" value="v3.5"/

编辑附加问题：我已经看到一些关于可能将我的引用设置为“复制本地”的帖子，这可能允许我在 2.0 服务器上运行。想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-03T16:01:38.027

3.5 在 2.0 CLR 上运行是对的，但是 3.5 包含库，如果您使用过其中的任何一个，那么除非您在该服务器上安装 3.5，否则您很不走运。

3.5 程序有很多选项不能仅在 2.0 上正确运行，所以我会考虑降级程序或升级服务器。

* * *

关于*复制本地*的注意事项。即使您复制了应用程序使用的所有 3.5 库，也不能保证它会工作，而且很可能不会。即便如此，.NET 许可证明确禁止将库与您的应用程序一起分发。

由于您已声明您使用 LINQ，因此让您的应用程序运行的唯一合法方法是安装 3.5 许可证。

或者，您可以仅使用 2.0 重写您的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T16:02:50.740

我很确定 LINQ 是要求 3.5 的原因之一。很多其他的东西，比如 lambda 表达式等，只是编译器的诡计。

因为 System.Linq 是 3.5 的功能，所以框架必须是那个版本。

确定的一个好方法是将目标框架更改为 2.0 并查看它是否可以构建。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T16:48:27.963

针对 3.0 或 3.5 编译的代码*可以*在 2.0 框架上运行，但前提是您不使用任何特定于 3.0+ 框架的库。找出导致代码失败的原因的一种好方法是将目标切换到 2.0 并进行更改以使其能够编译。由于您的目标安装之一是 .NET 2.0，因此您将不得不编写 .NET 2.0 代码；这不是 .NET 独有的。过去，编写一个在 Win95 和 WinNT 中执行的应用程序需要开发人员额外的工作来仔细确保使用适当的 API。

从技术上讲，面向 3.5 的代码可以毫无问题地在 2.0 上运行，但是您必须注意一些问题。如果*有任何东西*访问了 .NET 2.0 中不可用的东西，那将会失败。这不会在应用程序启动时发生，它会在应用程序尝试进​​行调用时发生。我通过制作一个控制台应用程序来测试这一点，该应用程序执行一点输出，然后尝试显示一个 WPF 窗口。输出已生成，但当应用程序尝试在只有 .NET 2.0 的机器上显示窗口时，它会引发异常。

另一个问题是 VS 2008 实际上带有 .NET Framework 2.0 SP1，并且 SP1 中有一些类型和方法是普通 2.0 Framework 中没有的。Visual Studio 不会将这些方法标记为不安全。

Finally, if this is a web application, the default web.config file for 3.5-targeted projects is very different than the web.config file for 2.0-targeted projects. Make sure you're distributing a compatible web.config. This is likely the problem you are encountering. A cheap workaround might be to change your target to .NET 2.0, copy that web.config, and use it in this case. Keep in mind that if you are using any 3.0+-specific language features or types your code will still fail, but this should get you past the web.config.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T16:01:35.033

除非您在服务器上安装了 3.5，否则您将无法在服务器上运行以 3.5 为目标的代码。

问题不在于您的代码，而在于缺少所需的库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T16:01:51.380

这是不可能的。尽管 CLR 没有改变（就像它在 v1.1 和 v2.0 之间所做的那样），但库有。您无法运行未安装 3.5 框架的 3.5 应用程序。3.5 框架使所有 Linq 功能成为可能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T16:03:16.603

Web.Config 中存在一个错误。已发布的 Web.Config 设置为允许从 .NET 3.5 进行编译，这就是它包含构建提供程序信息的原因。

除此之外，您的代码将无法运行。通过使用 LINQ，您可以引用 .NET 2.0 中不存在的程序集。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T16:15:41.197

您可以在面向 .NET 2.0 的同时使用一些 C# 3 功能。它的语言功能在编译到 IL 时将在 2.0 CLR 上运行，无论该 CLR 是否是 2.0 或更高框架安装的一部分。

因此，您可以使用匿名类型、扩展方法和 Lambda 表达式，但是一旦您执行 LINQ 之类的操作，您就需要属于 3.5 的外部库

如果您只做 LINQ to Object，您可以将[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)添加到您的发行版中。

您可能会遇到的另一个问题是，如果您发布的 Web 应用程序包含源代码，例如文件隐藏代码、行代码和 App_Code 文件夹中的 .cs。

您最终可以交付 C# 源代码，该代码在存在 C# 3 编译器的开发机器上编译，但无法在仅配备 C# 2 的服务器上编译。在这种情况下，您也不能使用任何新的语言功能。

更糟糕的是，在 Visual Studio 中将 .NET 2.0 框架指定为目标并不会阻止您使用 C# 3 语言功能。您不会收到这样的语法无法在 2.0 机器上编译的警告。

因此，如果您要发布这样的网络应用程序，您需要先编译几乎所有内容。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-03T16:17:15.937

我只是要发表评论，我的代表不在那里。到目前为止，我同意人群的看法，并相信 lassevk 的回答是最好的，所以请给他代表。我想让你知道的一个问题是，一旦你在 IIS 服务器上安装了 3.5（6 或更高版本）。当您转到 IIS 管理器并右键单击您的网站以访问 ASP.Net 选项卡时。安装 3.5 框架后，您将看到没有可用的 3.5 选项。它仍将显示为 2.0.50727。不用担心，它仍然可以正常工作。由于这种不一致（感谢 Microsoft），造成了一些混乱。实际上，我认为这就是为什么您可能认为 2.0 可以很好地运行您的 3.5 代码的原因。希望这会有所帮助，任何人都请编辑它，这样它就更有意义了。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-10-03T16:12:46.353

您可以将 3.5 dll 复制到服务器上。您绝对可以在 2.0 服务器上运行 3.5 代码。

# bug-tracking - 如何为 ClearQuest 创建包？

> ID：167572
> 
> 赞同：0
> 
> 时间：2008-10-03T15:59:41.557
> 
> 标签：bug-tracking, clearquest

我正在修改 ClearQuest 数据库模式，我想知道有没有办法为将来的部署创建一个包。如果没有跟踪和部署模式修改的最佳实践是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-10-25T08:14:12.903

在您的 CQ 安装路径中，查找此“cqload”工具。

基本上...

*   cqoload exportintegration - 将特定的 schame 版本导出到文本文件中
*   cqload importintegration - 将导出的文本文件导入 CQ
    模式

通常的做法是您至少有 2 个 CQ 环境、一个 Dev/QA 环境和一个生产环境。开发人员在 Dev/QA 环境（签出/修改/签入）上工作，直到他们满意为止，QA 在同一环境中验证了更改。然后实施者将使用 cqload 命令将更改传输到生产环境。

我个人认为这个工作流程是滞后的，因为它需要很多手动过程，如果你在 CQ 中有额外的“包”升级或安装，它就不能正常工作，例如 UCM 包等。不幸的是，我认为这不会随时改变。

# sql-server - 检查 SQL Server 中是否存在表

> ID：167576
> 
> 赞同：1311
> 
> 时间：2008-10-03T16:00:33.803
> 
> 标签：sql-server, tsql, sql-server-2005, sql-server-2000

我希望这是关于如何使用 SQL 语句检查 SQL Server 2000/2005 中是否存在表的最终讨论。

当你用谷歌搜索答案时，你会得到很多不同的答案。是否有官方/向后和向前兼容的方式来做到这一点？

这里有两种可能的方法。两者中的哪一个是标准/最佳方式？

第一种方式：

```
IF EXISTS (SELECT 1 
           FROM INFORMATION_SCHEMA.TABLES 
           WHERE TABLE_TYPE='BASE TABLE' 
           AND TABLE_NAME='mytablename') 
   SELECT 1 AS res ELSE SELECT 0 AS res; 
```

第二种方式：

```
IF OBJECT_ID (N'mytablename', N'U') IS NOT NULL 
   SELECT 1 AS res ELSE SELECT 0 AS res; 
```

**MySQL**提供了简单的

```
SHOW TABLES LIKE '%tablename%'; 
```

陈述。我正在寻找类似的东西。

* * *

## 回答 #1

> 赞同：1508
> 
> 时间：2008-10-03T16:17:35.343

对于这样的查询，最好使用`INFORMATION_SCHEMA`视图。这些视图（大部分）是跨许多不同数据库的标准视图，并且很少在版本之间更改。

要检查表是否存在，请使用：

```
IF (EXISTS (SELECT * 
                 FROM INFORMATION_SCHEMA.TABLES 
                 WHERE TABLE_SCHEMA = 'TheSchema' 
                 AND  TABLE_NAME = 'TheTable'))
BEGIN
    --Do Stuff
END 
```

* * *

## 回答 #2

> 赞同：323
> 
> 时间：2010-01-28T14:50:03.297

另请注意，如果出于任何原因您需要检查临时表，您可以这样做：

```
if OBJECT_ID('tempdb..#test') is not null
 --- temp table exists 
```

* * *

## 回答 #3

> 赞同：279
> 
> 时间：2008-10-03T16:05:16.727

`OBJECT_ID`只要我记得，我们总是使用这种风格

```
IF OBJECT_ID('*objectName*', 'U') IS NOT NULL 
```

* * *

## 回答 #4

> 赞同：167
> 
> 时间：2014-12-22T12:01:58.050

请参阅以下方法，

**方法 1：使用 INFORMATION_SCHEMA.TABLES 视图**

我们可以编写如下查询来检查当前数据库中是否存在客户表。

```
IF EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = N'Customers')
BEGIN
    PRINT 'Table Exists'
END 
```

**方法 2：使用 OBJECT_ID() 函数**

我们可以使用下面的 OBJECT_ID() 函数来检查当前数据库中是否存在客户表。

```
IF OBJECT_ID(N'dbo.Customers', N'U') IS NOT NULL
BEGIN
    PRINT 'Table Exists'
END 
```

**方法 3：使用 sys.Objects 目录视图**

我们可以使用 Sys.Objects 目录视图来检查 Table 是否存在，如下所示：

```
IF EXISTS(SELECT 1 FROM sys.Objects WHERE  Object_id = OBJECT_ID(N'dbo.Customers') AND Type = N'U')
BEGIN
   PRINT 'Table Exists'
END 
```

**方法 4：使用 sys.Tables 目录视图**

我们可以使用 Sys.Tables 目录视图来检查 Table 是否存在，如下所示：

```
 IF EXISTS(SELECT 1 FROM sys.Tables WHERE  Name = N'Customers' AND Type = N'U')
 BEGIN
      PRINT 'Table Exists'
 END 
```

**方法 5：避免使用 sys.sysobjects 系统表**

我们应该避免直接使用 sys.sysobjects 系统表，在未来的一些 Sql Server 版本中将不推荐直接访问它。根据 Microsoft BOL 链接，Microsoft 建议直接使用目录视图 sys.objects/sys.tables 而不是 sys.sysobjects 系统表。

```
 IF EXISTS(SELECT name FROM sys.sysobjects WHERE Name = N'Customers' AND xtype = N'U')
  BEGIN
     PRINT 'Table Exists'
  END 
```

引用自：[http ://sqlhints.com/2014/04/13/how-to-check-if-a-table-exists-in-sql-server/](http://sqlhints.com/2014/04/13/how-to-check-if-a-table-exists-in-sql-server/)

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2012-03-15T17:19:42.577

在不同的数据库中查找表：

```
if exists (select * from MyOtherDatabase.sys.tables where name = 'MyTable')
    print 'Exists' 
```

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2016-06-22T17:18:48.553

只想提一种情况，使用该`OBJECT_ID`方法可能会更容易一些。`INFORMATION_SCHEMA`视图是每个数据库下的对象-

> 信息模式视图在名为 INFORMATION_SCHEMA 的特殊模式中定义。此模式包含在每个数据库中。

[https://msdn.microsoft.com/en-us/library/ms186778.aspx](https://msdn.microsoft.com/en-us/library/ms186778.aspx)

因此，您使用访问的所有表

```
IF EXISTS (SELECT 1 
           FROM [database].INFORMATION_SCHEMA.TABLES 
           WHERE TABLE_TYPE='BASE TABLE' 
           AND TABLE_NAME='mytablename') 
   SELECT 1 AS res ELSE SELECT 0 AS res; 
```

只会反映`[database]`. 如果您想检查*另一个*`[database]`数据库中的表是否存在，而不是每次都动态更改，`OBJECT_ID`那么您可以开箱即用地执行此操作。前任-

```
IF OBJECT_ID (N'db1.schema.table1', N'U') IS NOT NULL 
   SELECT 1 AS res ELSE SELECT 0 AS res; 
```

效果一样好

```
IF OBJECT_ID (N'db2.schema.table1', N'U') IS NOT NULL 
   SELECT 1 AS res ELSE SELECT 0 AS res; 
```

**SQL SERVER 2016 编辑**：

`if exists`从 2016 年开始，Microsoft 通过将关键字添加到`drop`语句中，简化了在删除之前检查不存在对象的能力。例如，

```
drop table if exists mytablename 
```

将在 1 行代码中执行与`OBJECT_ID`/包装器相同的操作。`INFORMATION_SCHEMA`

[https://blogs.msdn.microsoft.com/sqlserverstorageengine/2015/11/03/drop-if-exists-new-thing-in-sql-server-2016/](https://blogs.msdn.microsoft.com/sqlserverstorageengine/2015/11/03/drop-if-exists-new-thing-in-sql-server-2016/)

* * *

## 回答 #7

> 赞同：31
> 
> 时间：2013-11-22T09:59:29.997

```
IF OBJECT_ID('mytablename') IS NOT NULL 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-10-03T16:03:54.777

使用信息模式是执行此操作的 SQL 标准方式，因此所有支持它的数据库都应该使用它。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2011-04-07T10:39:34.297

```
IF EXISTS 
(
    SELECT   * 
    FROM     sys.objects 
    WHERE    object_id = OBJECT_ID(N'[dbo].[Mapping_APCToFANavigator]') 
             AND 
             type in (N'U')
)
BEGIN

    -- Do whatever you need to here.

END 
```

在上面的代码中，表名是`Mapping_APCToFANavigator`.

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2019-09-15T05:47:39.003

您可以使用以下代码

```
IF (OBJECT_ID('TableName') IS NOT NULL )
BEGIN
  PRINT 'Table Exists'
END
ELSE
BEGIN 
  PRINT 'Table NOT Exists'
END 
```

或者

```
IF (EXISTS (SELECT * FROM sys.tables WHERE [name] = 'TableName'))
BEGIN
  PRINT 'Table Exists'
END
ELSE
BEGIN 
  PRINT 'Table NOT Exists'
END 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2009-10-21T14:58:15.393

如果您需要处理不同的数据库：

```
DECLARE @Catalog VARCHAR(255)
SET @Catalog = 'MyDatabase'

DECLARE @Schema VARCHAR(255)
SET @Schema = 'dbo'

DECLARE @Table VARCHAR(255)
SET @Table = 'MyTable'

IF (EXISTS (SELECT * FROM INFORMATION_SCHEMA.TABLES   
    WHERE TABLE_CATALOG = @Catalog 
      AND TABLE_SCHEMA = @Schema 
      AND TABLE_NAME = @Table))
BEGIN
   --do stuff
END 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2011-01-21T15:37:37.120

我知道这是一个老问题，但如果您打算经常调用它，我发现了这种可能性。

```
create procedure Table_Exists
@tbl varchar(50)
as
return (select count(*) from sysobjects where type = 'U' and name = @tbl)
go 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2015-01-23T17:40:57.443

为了开发人员和其他 DBA 的利益，只需在此处添加

接收@Tablename 作为参数的脚本

（可能包含也可能不包含 schemaname）并在 schema.table 存在时返回以下信息：

```
the_name                object_id   the_schema  the_table       the_type
[Facts].[FactBackOrder] 758293761   Facts       FactBackOrder   Table 
```

每次我需要测试表或视图是否存在时，我都会生成此脚本以在其他脚本中使用，并且当它存在时，获取其 object_id 以用于其他目的。

当您传递空字符串、错误的模式名称或错误的表名时，它会引发错误。

例如，这可能在一个过程中并返回 -1。

例如，我的一个数据仓库数据库中有一个名为“Facts.FactBackOrder”的表。

这就是我实现这一目标的方式：

```
PRINT 'THE SERVER IS ' + @@SERVERNAME
--select db_name()
PRINT 'THE DATABASE IS ' + db_NAME() 
PRINT ''
GO

SET NOCOUNT ON
GO

--===================================================================================
-- @TableName is the parameter
-- the object we want to deal with (it might be an indexed view or a table)
-- the schema might or might not be specified
-- when not specified it is DBO
--===================================================================================

DECLARE @TableName SYSNAME

SELECT @TableName = 'Facts.FactBackOrder'
--===================================================================================
--===================================================================================
DECLARE @Schema SYSNAME
DECLARE @I INT
DECLARE @Z INT 

SELECT @TableName = LTRIM(RTRIM(@TableName))
SELECT @Z = LEN(@TableName)

IF (@Z = 0) BEGIN

            RAISERROR('Invalid @Tablename passed.',16,1)

END 

SELECT @I = CHARINDEX('.',@TableName )
--SELECT @TableName ,@I

IF @I > 0 BEGIN

        --===================================================================================
        -- a schema and table name have been passed
        -- example Facts.FactBackOrder 
        -- @Schema = Fact
        -- @TableName = FactBackOrder
        --===================================================================================

   SELECT @Schema    = SUBSTRING(@TABLENAME,1,@I-1)
   SELECT @TableName = SUBSTRING(@TABLENAME,@I+1,@Z-@I)

END
ELSE BEGIN

        --===================================================================================
        -- just a table name have been passed
        -- so the schema will be dbo
        -- example Orders
        -- @Schema = dbo
        -- @TableName = Orders
        --===================================================================================

   SELECT @Schema    = 'DBO'     

END

        --===================================================================================
        -- Check whether the @SchemaName is valid in the current database
        --===================================================================================

IF NOT EXISTS ( SELECT * FROM INFORMATION_SCHEMA.SCHEMATA K WHERE K.[SCHEMA_NAME] = @Schema ) BEGIN

            RAISERROR('Invalid Schema Name.',16,1)

END 

--SELECT @Schema  as [@Schema]
--      ,@TableName as [@TableName]

DECLARE @R1 TABLE (

   THE_NAME SYSNAME
  ,THE_SCHEMA SYSNAME
  ,THE_TABLE SYSNAME
  ,OBJECT_ID INT
  ,THE_TYPE SYSNAME
  ,PRIMARY KEY CLUSTERED (THE_SCHEMA,THE_NAME)

)

;WITH RADHE_01 AS (
SELECT QUOTENAME(SCHEMA_NAME(O.schema_id)) + '.' + QUOTENAME(O.NAME) AS [the_name]
      ,the_schema=SCHEMA_NAME(O.schema_id)
      ,the_table=O.NAME
      ,object_id =o.object_id 
      ,[the_type]= CASE WHEN O.TYPE = 'U' THEN 'Table' ELSE 'View' END 
from sys.objects O
where O.is_ms_shipped = 0
AND O.TYPE IN ('U','V')
)
INSERT INTO @R1 (
   THE_NAME 
  ,THE_SCHEMA 
  ,THE_TABLE 
  ,OBJECT_ID
  ,THE_TYPE 
)
SELECT  the_name
       ,the_schema
       ,the_table
       ,object_id
       ,the_type
FROM RADHE_01
WHERE the_schema = @Schema 
  AND the_table  = @TableName

IF (@@ROWCOUNT = 0) BEGIN 

             RAISERROR('Invalid Table Name.',16,1)

END 
ELSE BEGIN

    SELECT     THE_NAME 
              ,THE_SCHEMA 
              ,THE_TABLE 
              ,OBJECT_ID
              ,THE_TYPE 

    FROM @R1

END 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2015-04-16T13:42:06.100

在**SQL Server 2000**中，您可以尝试：

```
IF EXISTS(SELECT 1 FROM sysobjects WHERE type = 'U' and name = 'MYTABLENAME')
BEGIN
   SELECT 1 AS 'res' 
END 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2013-10-24T11:04:32.467

```
IF EXISTS 
(
    SELECT  * 

    FROM    INFORMATION_SCHEMA.TABLES 

    WHERE   TABLE_SCHEMA = 'PutSchemaHere'     
            AND  
            TABLE_NAME   = 'PutTableNameHere'
) 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2014-07-23T13:55:00.187

对于尚未找到解决方案的任何人来说，重要的是要知道： **SQL server != MYSQL**。如果你想用**MYSQL**来做，这很简单

```
 $sql = "SELECT 1 FROM `db_name`.`table_name` LIMIT 1;";
    $result = mysql_query($sql);
    if( $result == false )
        echo "table DOES NOT EXIST";
    else
        echo "table exists"; 
```

在此处发布此内容是因为它是 Google 的热门内容。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2014-11-18T14:36:47.300

你可以使用这个：

```
 IF OBJECT_ID (N'dbo.T', N'U') IS NOT NULL 
        BEGIN 
            print 'deleted table';
            drop table t 
        END
     else 
        begin 
            print 'table not found' 
        end

 Create table t (id int identity(1,1) not null, name varchar(30) not null, lastname varchar(25) null)
 insert into t( name, lastname) values('john','doe');
 insert into t( name, lastname) values('rose',NULL);

 Select * from t
1   john    doe
2   rose    NULL

 -- clean
 drop table t 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2019-03-22T05:31:33.583

从 INFORMATIONAL_SCHEME 和 OBJECT_ID 中选择时，我遇到了一些问题。我不知道这是否是 ODBC 驱动程序的问题或其他问题。来自 SQL 管理工作室的查询都可以。

这是解决方案：

```
SELECT COUNT(*) FROM <yourTableNameHere> 
```

因此，如果查询失败，数据库中可能没有这样的表（或者您没有访问权限）。

检查是通过比较处理 ODBC 驱动程序的 SQL 执行程序返回的值（在我的情况下为整数）来完成的。

```
if (sqlexec(conectionHandle, 'SELECT COUNT(*) FROM myTable') == -1) {
  // myTable doesn't exist..
} 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2019-07-03T10:03:12.977

```
IF EXISTS (
SELECT *
FROM INFORMATION_SCHEMA.TABLES
WHERE 
TABLE_CATALOG = 'Database Name' and
TABLE_NAME = 'Table Name' and 
TABLE_SCHEMA = 'Schema Name') -- Database and Schema name in where statement can be deleted

BEGIN
--TABLE EXISTS
END

ELSE BEGIN
--TABLE DOES NOT EXISTS
END 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2018-06-19T08:54:28.760

```
IF EXISTS (   SELECT * FROM   dbo.sysobjects WHERE  id = OBJECT_ID(N'dbo.TableName') AND OBJECTPROPERTY(id, N'IsUserTable') = 1 )
BEGIN
  SELECT * FROM dbo.TableName;
END
GO 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2020-11-30T17:35:36.140

我总是这样检查。

```
IF OBJECT_ID('TestXML..tblCustomer') IS NOT NULL  
BEGIN  
    PRINT 'Exist'
END  
ELSE
BEGIN
    PRINT 'Not Exist'
END 
```

谢谢

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2014-02-07T18:48:06.830

如果有人试图在 linq to sql（或特别是 linqpad）中做同样的事情，请打开选项以包含系统表和视图并执行以下代码：

```
let oSchema = sys.Schemas.FirstOrDefault(s=>s.Name==a.schema )
where oSchema !=null
let o=oSchema!=null?sys.Objects.FirstOrDefault (o => o.Name==a.item && o.Schema_id==oSchema.Schema_id):null
where o!=null 
```

假设您有一个对象，该对象的名称位于名为 item 的属性中，而模式位于名为 schema 的属性中，其中源变量名称为`a`

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-02-10T18:54:51.620

```
select name from SysObjects where xType='U' and name like '%xxx%' order by name 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-09-06T09:39:37.427

* * *

-- -- 创建过程以检查表是否存在

* * *

```
DELIMITER $$

DROP PROCEDURE IF EXISTS `checkIfTableExists`;

CREATE PROCEDURE checkIfTableExists(
    IN databaseName CHAR(255),
    IN tableName CHAR(255),
    OUT boolExistsOrNot CHAR(40)
)

  BEGIN
      SELECT count(*) INTO boolExistsOrNot FROM information_schema.TABLES
      WHERE (TABLE_SCHEMA = databaseName)
      AND (TABLE_NAME = tableName);
  END $$

DELIMITER ; 
```

* * *

-- -- 使用方法：检查表迁移是否存在

* * *

```
 CALL checkIfTableExists('muDbName', 'migrations', @output); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-01-06T08:22:29.350

我以这里**创建一个视图为例**。

因为 ALTER/CREATE 命令不能在 BEGIN/END 块内。您需要在创建之前测试是否存在并删除它

```
IF Object_ID('TestView') IS NOT NULL
DROP VIEW TestView

GO

CREATE VIEW TestView
   as
   . . .

GO 
```

如果您担心权限丢失，您也可以编写 GRANT 语句并在最后重新运行这些语句。

您可以将 create/alter 包装成一个字符串并执行 EXEC - 这对于大视图可能会变得很难看

```
DECLARE @SQL as varchar(4000)

-- set to body of view
SET @SQL = 'SELECT X, Y, Z FROM TABLE' 

IF Object_ID('TestView') IS NULL
    SET @SQL = 'CREATE VIEW TestView AS ' + @SQL
ELSE    
    SET @SQL = 'ALTER VIEW TestView AS ' + @SQL 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2014-08-18T22:08:21.883

如果这是“终极”讨论，那么应该注意，如果服务器是链接的，Larry Leonard 的脚本也可以查询远程服务器。

```
if exists (select * from REMOTE_SERVER.MyOtherDatabase.sys.tables where name = 'MyTable')
    print 'Exists' 
```

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2019-05-29T13:38:32.273

运行此查询以检查该表是否存在于数据库中：

```
IF(SELECT TABLE_NAME from INFORMATION_SCHEMA.TABLES where TABLE_NAME = 'YourTableName') IS NOT NULL
PRINT 'Table Exists'; 
```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2020-02-27T05:18:15.090

还有一个选项可以检查表是否跨数据库存在

```
IF EXISTS(SELECT 1 FROM [change-to-your-database].SYS.TABLES WHERE NAME = 'change-to-your-table-name')
BEGIN
    -- do whatever you want
END 
```

* * *

## 回答 #29

> 赞同：-5
> 
> 时间：2013-04-10T18:32:06.477

考虑在一个数据库中，您有一个表 t1。你想在其他数据库上运行脚本，比如 - 如果 t1 存在，那么什么都不做，创建 t1。为此打开视觉工作室并执行以下操作：

右键单击 t1，然后 Script table as，然后 DROP 和 Create To，然后是 New Query Editor

你会找到你想要的查询。但是在执行该脚本之前不要忘记注释掉查询中的 drop 语句，因为如果已经有一个，您不想创建新的。

谢谢

# rss - 访问旧的、不再可用的提要条目

> ID：167577
> 
> 赞同：6
> 
> 时间：2008-10-03T16:00:42.570
> 
> 标签：rss, feed, atom-feed

我正在开展一个项目，该项目需要可靠地访问网站当前提要中不一定可用的历史提要条目。我找到了几种访问此类数据的方法，但没有一种方法能够提供我需要的所有特征。

将其视为一场头脑风暴。我会告诉你我发现了多少，如果你有任何其他想法，你可以贡献。

1.  [Google AJAX Feed API](http://code.google.com/apis/ajaxfeeds/) - 将您限制为 250 个项目

2.  [Unofficial Google Reader API](http://www.niallkennedy.com/blog/2005/12/google-reader-api.html) - 完美但非官方，因此不可靠（也许是准非法的？）。此外，身份验证似乎很棘手。

3.  [Spinn3r](http://spinn3r.com/) - 花费很多钱

4.  在提要的网站上搜索[互联网档案](http://www.archive.org)- 非常复杂，覆盖范围参差不齐，只能在不得已的情况下使用

5.  [雅虎！Feed API](http://www.niallkennedy.com/blog/2005/12/my-yahoo-feed-a.html)或[Yahoo! Search BOSS](http://developer.yahoo.com/search/boss/) - 第一个看起来更像是一个聚合器，这意味着我需要为每个提要进行不同的注册，第二个应该提供对雅虎数据的更多访问权限，但我找不到提要。

6.  （感谢 Lou Franco）[Bloglines Sync API](http://www.bloglines.com/services/api/sync) - 除了需要一个帐户和被设计成一个聚合器的问题之外，它没有办法向帐户添加提要。因此，无需检索任意提要。您需要先通过阅读器手动添加它们。

7.  其他搜索引擎/博客搜索/什么的？

这是一个非常令人恼火的问题，因为我们所讨论的语义信息曾经存在，但（通常）仍然有效，但难以可靠、自由且不受限制地访问。有人知道饲料进入好处的任何替代来源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T17:16:58.080

Bloglines 有一个用于同步帐户的 API

[http://www.bloglines.com/services/api/sync](http://www.bloglines.com/services/api/sync)

您必须创建一个帐户，订阅您要下载的提要，然后您可以根据日期下载，这可能是过去的方式。不确定条款。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-29T09:02:49.947

到目前为止，我找到的最佳答案是：Google 阅读器的非官方 API 为他们的提要提供了一个公共访问点，这意味着不需要身份验证。使用如下：

[http://www.google.com/reader/public/atom/feed/](http://www.google.com/reader/public/atom/feed/) {您的提要 uri 在这里}?n=1000

用您感兴趣的提要 URI 替换 squigglies（包括 squigglies 本身）中的文本。有关精确参数的更多信息可以在这里找到：

[http://blog.martindoms.com/2009/10/16/using-the-google-reader-api-part-2/](http://blog.martindoms.com/2009/10/16/using-the-google-reader-api-part-2/)

但如果您不想弄乱身份验证，请记住使用 /public/ url

# vb6 - 有没有办法防止 VB6 编译器打乱文件的内容？

> ID：167580
> 
> 赞同：4
> 
> 时间：2008-10-03T16:01:16.140
> 
> 标签：vb6

由于未知的原因，VB6 编译器经常喜欢重新排序 .vbp 文件的内容和 .frm 文件顶部的控件描述符块（描述窗体上控件属性的代码。您在IDE，但您确实在文本编辑器中看到，并且*在与版本控制中的先前版本进行比较时*看到。）。在比较文件的修订版时，这非常烦人并且非常分散注意力。

有没有办法防止这种情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-04T04:08:47.717

我认为您对此无能为力。我注意到了同样的问题：IDE 似乎没有明显的原因喜欢重新排列事物。我注意到的一些事情：

*   当您使用 SSTab 控件时，VB 喜欢重新排列选项卡的属性，尤其是 TabEnabled 属性。

*   对于项目文件，它会随机重新排列文件出现的顺序，我想我记得看到类似文件类型并不总是组合在一起并最终与项目属性混合在一起的情况。您对此没有太多控制权，除非您通过某种类型的清理程序运行所有 VBP，这些清理程序将文件组合在一起（一组中的表单，另一组中的模块等）并按字母顺序或其他方式对它们进行排序，以便它们保持一致。处理此问题的一种可能方法是编写一个 IDE 插件，每次您将更改保存到项目文件时，它都会自动执行此操作，或者提出一些批处理过程，它只会递归您的源目录并清理所有 VBP一口气。

*   IDE 似乎随机改变事物的大小写；这似乎经常发生在项目引用中。有时以小写输出，有时以大写输出。当您在 SourceSafe 中比较文件时，您可以通过选择“忽略大小写”来解决此问题。

*   控制坐标，例如 Top、Left、Height 和 Width，在同一表单的两个修订版之间可能不同。这是由于不同的开发人员在处理同一个表单时使用不同的屏幕分辨率和/或不同的屏幕 DPI 设置。如果您还没有这样做，我强烈建议您让每个人都使用相同的分辨率和相同的 DPI 设置进行开发。不同的值是由在不同分辨率/DPI 设置下的逻辑屏幕坐标转换为缇（VB 用于布局表单的默认坐标空间）时发生的舍入误差引起的。此外，当我谈到这个话题时，请确保每个人都将其显示设置为 96dpi，因为如果您以 120dpi 开发 VB 表单，它们很有可能无法在设置为 96dpi 的显示上正确显示。

*   可能还有其他事情我现在不记得了……

至于在表单文件中更改控件的顺序，这是正常的，如果碰巧从表单的一个版本更改为下一个版本，您通常不想尝试手动重新排列控件的顺序。控件出现在表单文件中的顺序决定了它们在表单上的 Z 顺序。如果 .frm 文件中控件的顺序发生更改，这将更改它们在表单上的相对 Z 顺序，这可能会导致表单显示方式出现意外结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T16:04:18.287

当您不编辑它（即添加模块等）时，您可以将 .vbp 文件设为只读吗？

至于表单文件......我想不出任何好的方法来让 VB 不对它们重新排序。但我不得不说我以前从未遇到过这种情况。你确定没有其他事情发生吗？

完全有可能我过去从来没有关注过这个，所以我不是说你错了，只是提供我自己的观察。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-16T12:13:56.170

我注意到重新打开表单并再次保存通常会恢复一致的顺序。

# sql-server - Visual Studio 数据库项目设计者

> ID：167586
> 
> 赞同：2
> 
> 时间：2008-10-03T16:02:30.350
> 
> 标签：sql-server, visual-studio

我有这个庞大的遗留数据库，我正试图对其进行源代码控制。我在 stackoverflow 上环顾四周，决定使用 Visual Studio 2008 数据库项目，然后在 svn 上提交内容。我成功地将模式导入到项目中，但是我找不到任何方法来使用用户友好的表设计器与这种项目。每当我打开一个表时，它都会打开 DDL 定义。我需要设计师，否则我不会得到团队的支持。有什么建议/解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T20:12:17.583

我会使用[Microsoft® Visual Studio Team System 2008 Database Edition GDR](http://www.microsoft.com/downloads/details.aspx?FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed&displaylang=en)。哪个脚本在它自己的文件中的每个对象，以便在版本控制中轻松跟踪。

对于不想使用该工具的开发人员，让他们在 Management Studio 中进行开发，然后在准备签入时使用 Database Edition 中的架构比较工具自动将开发数据库中的更改提取到项目文件中。

您也许可以编写一些（狡猾的）Visual Studio 宏来自动进行架构比较，而开发人员只需点击最少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T14:14:45.993

我发现 sql server management studio（express free 或完整产品）比 Visual Studio 数据库项目更容易使用。我喜欢 vs 的一个好处是您可以在服务器资源管理器中选择多个对象（例如所有表）并为它们生成一个脚本。这些不容易维护，但有利于快速备份所有对象。Management Studio 具有表格和查询设计器，还允许显示执行计划和客户端统计信息，以便您可以在需要时优化查询/sps。

我只将它与可视源代码安全一起用于源代码控制，从 Management Studio 的角度来看，它工作得很好，但是 vss 不是很好！（错误、崩溃、损坏等）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-16T11:57:06.910

尝试打开服务器资源管理器（查看 > 服务器资源管理器）。您可能需要添加一个连接，然后您可以连接到数据库表，右键单击它们并选择“显示表数据”。

0nce 你在那里你得到查询设计器工具栏，你可以使用表设计器。

# c# - 将程序集加载到单独的 AppDomain 中，得到 InvalidCastException

> ID：167587
> 
> 赞同：6
> 
> 时间：2008-10-03T16:02:44.470
> 
> 标签：c#, .net

我正在尝试在单独的应用程序域中加载程序集，但遇到了一个非常奇怪的问题。这是一些代码：

```
 public static void LoadAssembly(string assemblyPath)
    {

        string pathToDll = Assembly.GetCallingAssembly().CodeBase;
        AppDomainSetup domainSetup = new AppDomainSetup
        {
            PrivateBinPath = pathToDll
        };

        AppDomain newDomain = AppDomain.CreateDomain("AssemblyLoader",null,domainSetup);

        AssemblyLoader loader = (AssemblyLoader)newDomain.CreateInstanceFromAndUnwrap(
            pathToDll,
            typeof(AssemblyLoader).FullName);

    } 
```

AssemblyLoader 是与这个相同的程序集中的另一个类，它继承自 MarshalByRef，但是由于某些奇怪的原因，每次尝试运行它时都会出现强制转换异常。我什至硬编码了 DLL 的路径，而不是使用 GetCallingAssembly().CodeBase，但我一直收到这个异常。

我知道在没有实际看到它并获得更多信息的情况下很难回答这样的问题，但也许有人遇到了类似的情况并且会知道常见的“陷阱”以及我应该注意什么。

编辑：我不想直接加载它的原因是因为这只是代码的一部分。最终目标是这个类将有一个方法来加载程序集，获取它们的 GUID 和一些关于它们的其他信息，并将它们存储在我正在处理的项目的数据库中。因此，如果我将此程序集加载到单独的应用程序域中，我也可以在那里加载其他程序集，然后卸载应用程序域。如果我只需要这些数据，那么在应用程序运行期间加载所有这些程序集毫无意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T16:31:34.053

*（编辑：阅读给出的异常后，完全改变答案）*

看来问题是 CreateInstanceFromAndUnwrap 调用，它使用“pathToDll”的 LoadFrom 语义。[Suzanne Cook 在她的博客上详细介绍了可能的症结](http://blogs.msdn.com/suzcook/archive/2003/05/29/choosing-a-binding-context.aspx#57147)，其中您的原始 AppDomain 在尝试解析有问题的类型时尝试调用 Load("SomeAssembly, [...]") 而不是 LoadFrom("pathToDll")。

她的建议是挂钩当前域上的 AssemblyResolve 事件以执行正确的 LoadFrom 以获取类型。根据 Suzanne 的建议，进行一些有针对性的谷歌搜索会[为该问题提供可能的解决方案。](http://www.codeguru.com/forum/showpost.php?s=dc0b90f26601b3cca385d2c9fdaac2a4&p=1450762&postcount=5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T16:13:52.620

我不认为 PrivateBinPath 配置是必要的，除此之外，您不需要使用 DLL 的路径，而是第一个参数的程序集的完全限定名称；尝试：

```
AssemblyLoader loader = (AssemblyLoader)newDomain.CreateInstanceFromAndUnwrap(
        typeof(AssemblyLoader).Assembly.FullName,
        typeof(AssemblyLoader).FullName); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T13:07:33.273

有很多关于您在这里尝试做的事情的好信息：[如何加载 .NET 程序集以进行反射操作并随后将其卸载？](https://stackoverflow.com/questions/225330/how-to-load-a-net-assembly-for-reflection-operations-and-subsequently-unload-it)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-29T06:39:04.553

看看[这篇文章。](http://www.west-wind.com/WebLog/posts/601200.aspx)

使用那篇文章中的代码，我得到了一个跨应用程序域对象。我用泛型抽象了一些东西，并有三个程序集。（即1定义接口，1定义插件实现，以及告诉泛型加载什么的主程序。）原始文章代码很容易理解。

# c# - 如何将 Dispose 功能添加到 C# UserControl？

> ID：167602
> 
> 赞同：60
> 
> 时间：2008-10-03T16:04:17.680
> 
> 标签：c#, user-controls, dispose

我有一个实现 UserControl 的类。在 .NET 2005 中，会在 MyClass.Designer.cs 部分类文件中自动创建一个 Dispose 方法，如下所示：

```
 protected override void Dispose(bool disposing)
  {
     if (disposing && (components != null))
     {
        components.Dispose();
     }
     base.Dispose(disposing);
  } 
```

如果我想添加自己的 Dispose 功能，我应该把它放在哪里？由于生成了此文件，因此我不想在此处添加代码并冒着被吹走的风险。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-12-01T04:03:48.203

所有`Component`类都实现一个`Disposed`事件。您可以为该事件添加事件处理程序并清理其中的内容。

例如，`UserControl`您可以添加以下方法：

```
private void OnDispose(object sender, EventArgs e)
{
    // do stuff on dispose
} 
```

并在构造函数（或`Load`事件处理程序）中添加以下行：

```
Disposed += OnDispose; 
```

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2008-10-03T16:12:16.960

在这种情况下，我将生成的`Dispose`方法移动到主文件并扩展它。Visual Studio 尊重这一点。

另一种方法是使用部分方法（C# 3.0）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-03T16:07:59.607

我相信在这种情况下，代码生成器会尊重您的代码。将它放在代码隐藏中应该是安全的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-03T16:08:43.270

在 VS 2005（和 2008）中，您可以更新该`Dispose`方法，当您从设计器编辑控件时，它不会被删除。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T16:09:23.427

如果需要，您可以将其从 .designer.cs 文件中移出并移到主 .cs 文件中。如前所述，它不会被覆盖。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-22T10:35:27.240

您只需要重载用户控件继承的组件类中的公共 void Dispose() 方法。

确保您将调用传递给基本方法并在功能上进行处理，否则您将破坏功能，除非您完全实现它

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-13T05:35:07.570

我认为最干净的方法是让您的控件订阅它自己的 Disposed() 事件并在那里进行清理。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-05-25T14:48:14.910

UserControl 有一个 Unloaded 事件，可用于清理，

# asp.net - 网络服务帐户是否应该默认接收临时文件权限？

> ID：167605
> 
> 赞同：3
> 
> 时间：2008-10-03T16:04:28.333
> 
> 标签：asp.net, crystal-reports, administration

最近我正在通过网络表单从 Crystal Reports 生成 PDF。它失败了，我确定这是由 c:\windows\temp 目录上的权限设置引起的。我授予网络服务帐户对此文件夹的完全访问权限，从而迅速解决了问题。但是网络服务帐户默认没有这些权限是有原因的吗？

Rick Strahl[在这里](http://west-wind.com/WebLog/posts/112111.aspx)提出了这个问题。听起来这样做不应该有任何问题，但 Rick 并不清楚为什么会这样设置默认值。

Web 服务器是 Windows Server 2003

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T17:42:05.330

如今，默认选项往往更安全。我不认为有任何其他原因。

我和你有同样的问题，在我的环境中只是给予许可并继续前进。

[这篇文章](https://stackoverflow.com/questions/167605/should-the-network-service-account-receive-temp-file-permissions-by-default#172337)表明这​​是 Crystal Reports 的错，它明确引用了 %WINDIR%\Temp 而不是使用诸如 Path.GetTempPath() 之类的 API。事实上，当在 Windows 2003 上的网络服务帐户下运行时，我已经看到 Path.GetTempPath() 返回 %WINDIR%\Temp。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-07T20:41:39.193

这篇关于创建临时文件[的帖子](https://stackoverflow.com/questions/16656/creating-tempory-folders#16672)有支持使用 Windows 临时文件夹的评论。

一篇关于使用网络服务帐户的 msdn[文章](http://msdn.microsoft.com/en-us/library/ms998320.aspx#paght000015_fileaccess)指出“如果您的 ASP.NET 应用程序需要使用其他位置的文件或文件夹，则必须专门启用访问权限”这告诉我，对临时文件夹的默认限制不是因为temp 文件夹被单独挑出，但默认情况下，除了 IIS 根文件夹之外的所有其他位置都受到限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T17:38:42.777

**%windows%\temp**不适用于一般的临时和呕吐。很明显，Crystal Reports 正在滥用该目录。当开发人员懒得用管理员帐户以外的任何东西启动他们的机器时，这种情况经常发生。

**每个用户（包括网络服务）在Documents & Settings**下都有自己的临时空间，具有完全访问权限。获胜者的行为不像 CR，而是使用自己的临时空间。

简而言之，win\temp 上的默认权限没有任何问题。我相信它只是用于 Windows 的内部工作。（再说一次，如果那个目录从一开始就不存在，对每个相关的人都会好得多。）

# spring - 如果我关心 IOC，如何最好地在 Spring MVC 中修改我的模型

> ID：167609
> 
> 赞同：3
> 
> 时间：2008-10-03T16:05:01.500
> 
> 标签：spring, spring-mvc, inversion-of-control

我正在使用 Spring MVC 构建一个应用程序。我想为应用程序中的每个控制器对我的模型进行某些更改。特别是，我想将某些额外的数据插入到模型中，这些数据将出现在应用程序的所有页面中。

我可以通过几种方式做到这一点：只需在每个控制器的末尾添加数据，使用模型的子类添加我的额外数据，使用包装我的模型的 ModelAndView 的子类，在使用之前使用包装模型的 VelocityView 的子类它...我确定还有其他选择。

但是我有一个“优雅”的约束：我不想在每个控制器中编写代码，我希望在[一个唯一的](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)地方定义这种行为。理想情况下，它将由我的 IOC bean 配置文件控制。

有没有人建议如何优雅地实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T19:30:45.640

Aspects 是一个很好的方法，但是 Spring MVC 使它变得更容易——您可以定义一个[HandlerInterceptor](http://static.springframework.org/spring/docs/2.5.x/reference/mvc.html#mvc-handlermapping-interceptor)，它将在每次处理请求之前或之后调用。在 HandlerInterceptor postHandle 方法中（在实现 HandlerInterceptor 接口的类中），您可以将数据添加到 ModelAndView。您可以在配置文件中定义应拦截哪些处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T17:11:34.937

你可以看看使用方面。Spring 甚至有一个您可以使用的[AOP](http://static.springframework.org/spring/docs/2.0.x/reference/aop.html)扩展。

简而言之，一个方面将允许您定义一次代码，然后在您编译类或由类加载器加载它们时“编织”到您的类中。它是相对先进的东西，对于新程序员来说并不是最直观的东西，但它旨在准确解决您所指的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T15:06:10.680

我可能错了，但我怀疑您可能错误地描述了您的要求。

您似乎在说“我希望将某些数据添加到我的模型中，适用于所有控制器”。

我怀疑您的意思是“我希望某些数据可用于所有视图”。

如果我的怀疑是正确的，那么将数据添加到您的模型就是污染您的模型并违反单一责任原则。如果要将相同的数据添加到多个模型中，则尤其如此。请注意，您不只是将模型用作数据的方便“载体” - 其中数据与模型没有任何关系。

诚然，我并不完全熟悉 Spring MVC 的做事方式，但是您尝试实现的更详细的示例可能允许进行更明智的讨论。

# bindable-linq - 可绑定 LINQ 与连续 LINQ

> ID：167622
> 
> 赞同：23
> 
> 时间：2008-10-03T16:08:00.120
> 
> 标签：bindable-linq

可绑定 LINQ 和连续 LINQ 之间的主要区别是什么？

•可绑定LINQ：www.codeplex.com/bindablelinq

• 连续 LINQ：www.codeplex.com/clinq

根据提供的反馈，又添加了一个项目：

•Obtics：obtics.codeplex.com

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-10-06T16:05:26.427

它们是这两个包都试图解决的两个问题：缺少 CollectionChanged 事件和动态结果集。还有一个额外的问题可绑定解决，额外的自动事件触发器。

* * *

**这两个软件包旨在解决 **的第一个问题是：****

 **> LINQ 查询返回的对象不提供 CollectionChanged 事件。

**连续 LINQ**自动对所有查询执行此操作，无需更改：

```
from item in theSource select item ; 
```

**当您将 .asBindable 添加到查询源对象时，**可绑定 LINQ会执行此操作：****

 **```
from item in theSource.AsBindable() select item ; 
```

* * *

**两个软件包旨在解决**的第二个问题是：****

 **> 从 LINQ 查询返回的结果集是静态的。

通常，当您执行 LINQ 查询时，您的*结果集*不会更改，直到您执行新查询。使用这两个包，只要*源更新，您的**结果集*就会更新。（对性能不利，对实时更新有利）

 ***例子**

```
var theSource = new ContinuousCollection<Customer>();
var theResultSet = from item in theSource where item.Age > 25 select item;
//theResultSet.Count would equal 0. 
```

因为您使用 Bindable 或 Continuous LINQ，您可以修改*theSource*，并且*theResultSet*将自动包含新项目。

```
theSource.Add(new Customer("Bob", "Barker" , 35, Gender.Male)); //Age == 35
//theResultSet.Count would now equal 1. 
```

* * *

**可绑定 LINQ 提供的附加问题**：（直接从他们自己的页面引用）

```
contactsListBox.ItemsSource = from c in customers
                              where c.Name.StartsWith(textBox1.Text)
                              select c; 
```

> 可绑定 LINQ 将检测到查询依赖于 TextBox 对象 textBox1 的 Text 属性。由于 TextBox 是 WPF 控件，因此 Bindable LINQ 知道订阅控件上的 TextChanged 事件。
> 
> 最终结果是，当用户键入时，查询中的项目会被重新评估，并且更改会出现在屏幕上。处理事件不需要额外的代码。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T14:26:58.167

我可以提请您注意另一个 codeplex 项目吗？它被称为 Obtics 并处理相同的问题 ( [http://obtics.codeplex.com](http://obtics.codeplex.com) )。

它解决了第一个问题和第二个问题以及其他问题，并将反应性提升到了非常深的水平（具有基于 LINQ 的光线跟踪器的演示）。

它声称完全支持所有 LINQ 语句和 Enumerable 类的方法。

它使用另一种机制来创建实时查询：

```
var theResultSet = ExpressionObserver.Execute(
    () => from item in theSource where item.Age > 25 select item
).Cascade(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-11T19:45:26.143

要记住的另一件事是，尽管 BindableLinq 需要在 LINQ 语句中调用“.AsBindable()”，但 CLINQ 要求您使用 ContinuousCollection<T> 而不是 ObservableCollection<T>。在简单地看了两者之后，我想我将使用可绑定的 LINQ。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-04T17:27:33.180

确实; Continuous LINQ 的主要问题是无法使用任何实现通用 IEnumerable 和 INotifyCollectionChanged 的​​集合。可绑定 LINQ 使用实现这两个接口的自定义集合没有问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T15:58:21.573

使用可绑定 LINQ，因为它实现了 IDisposable，因此您可以控制何时释放查询。当您处置它时，对 INotifyPropertyChanged 的​​所有订阅都将取消订阅。

连续 LINQ 应该通过弱事件来解决这个问题，但就我能够测试的情况而言，它不起作用。

嗯...这似乎是可绑定 LINQ 的问题（第二个断言失败）：

```
var _source = CreateSource_6People(); //(David, 27), (Mark, 15), (Steve, 30), (Jordan, 43), (Shiva, 30), (Erb, 43)
IBindable<int> bindable = _source.AsBindable().Sum(x => x.Age);
var agesSum = 27+15+30+43+30+43;
Assert.AreEqual(agesSum, bindable.Current); //PASSES

_source[0].Age += 1;
Assert.AreEqual(agesSum + 1, bindable.Current); //FAILS... DISAPPOINTING 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-11-20T09:29:27.393

我认为可绑定 LINQ 和连续 LINQ 大致相同：它们提供对 LINQ 计算变化的观察。提供的实现和 API 可能有所不同。看来我的[ObservableComputations](https://github.com/IgorBuchelnikov/ObservableComputations)库涵盖了 Bindable LINQ 和连续 LINQ 预期的功能，并且在[https://stackoverflow.com/a/174924/2663791](https://stackoverflow.com/a/174924/2663791)中没有提到任何问题。该库与[INotifyPropertyChanged](https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.inotifypropertychanged?view=netframework-4.8)和[INotifyCollectionChanged](https://docs.microsoft.com/en-us/dotnet/api/system.collections.specialized.inotifycollectionchanged?view=netframework-4.8)接口一起使用，从而可以直接使用[ObservableCollection](https://docs.microsoft.com/en-us/dotnet/api/system.collections.objectmodel.observablecollection-1?view=netframework-4.8)进行操作。使用该库，您可以编写如下代码：

```
using System;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Linq;
using IBCode.ObservableComputations;

namespace ObservableComputationsExamples
{
    public class Order : INotifyPropertyChanged
    {
        public event PropertyChangedEventHandler PropertyChanged;

        public int Num {get; set;}

        private decimal _price;
        public decimal Price
        {
            get => _price;
            set
            {
                _price = value;
                PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(nameof(Price)));
            }
        }

        public Order(int num, decimal price)
        {
            Num = num;
            _price = price;
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            ObservableCollection<Order> orders = 
                new ObservableCollection<Order>(new []
                {
                    new Order(1, 15),
                    new Order(2, 15),
                    new Order(3, 25),
                    new Order(4, 27),
                    new Order(5, 30),
                    new Order(6, 75),
                    new Order(7, 80),
                });

            //********************************************
            // We start using ObservableComputations here!
            Filtering<Order> expensiveOrders = orders.Filtering(o => o.Price > 25); 

            checkFiltering(orders, expensiveOrders); // Prints "True"

            expensiveOrders.CollectionChanged += (sender, eventArgs) =>
            {
                // see the changes (add, remove, replace, move, reset) here
            };

            // Start the changing...
            orders.Add(new Order(8, 30));
            orders.Add(new Order(9, 10));
            orders[0].Price = 60;
            orders[4].Price = 10;
            orders.Move(5, 1);
            orders[1] = new Order(10, 17);

            checkFiltering(orders, expensiveOrders); // Prints "True"

            Console.ReadLine();
        }

        static void checkFiltering(
            ObservableCollection<Order> orders, 
            Filtering<Order> expensiveOrders)
        {
            Console.WriteLine(expensiveOrders.SequenceEqual(
                orders.Where(o => o.Price > 25)));
        }
    }
} 
```

请将[ObservableComputations](https://github.com/IgorBuchelnikov/ObservableComputations)库添加到问题列表中（在 Obtics 之后）。

# migration - 迁移到 Trac

> ID：167628
> 
> 赞同：7
> 
> 时间：2008-10-03T16:09:09.183
> 
> 标签：migration, trac, mediawiki, bugzilla

我们正在使用基于 HTTPS、Bugzilla 和 Mediawiki 的 Subversion 来管理我们的开发。我们的一些开发人员表示有兴趣迁移到 Trac，因此我必须评估这样做的成本。

对于 wiki 和 bugzilla，我们需要将现有数据迁移到 Trac 或与 trac 集成的方法。有两个应用程序来创建 wiki 页面或记录错误是不可接受的。此外，目前这些应用程序中的每一个都需要单独登录，因此我们需要将这些帐户中的每一个映射到 Trac。

那么知道将这些系统与 Trac 导入或集成的任何简单方法和/或这样做的教程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T16:15:32.353

## 维基页面

如果您可以将页面导出为文本文件，您可以使用 Trac-Admin：[http](http://trac.edgewall.org/wiki/TracAdmin) `wiki import` ://trac.edgewall.org/wiki/TracAdmin命令导入它们。一些格式化清理迁移可能是有序的

## 门票/错误

*   这个由[Tom Lazar编写的](http://tomster.org/blog/)[脚本](http://tomster.org/geek/trac/csv2trac.3.py/view)使您能够将票证系统与 CSV 文件同步。

*   这使您能够从 BugZilla 迁移：http: [//bitten.edgewall.org/wiki/TracImport](http://bitten.edgewall.org/wiki/TracImport)

*   您还可以查看此资源：[http ://trac.edgewall.org/wiki/TracSynchronize](http://trac.edgewall.org/wiki/TracSynchronize)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T16:17:46.670

对于 Bugzilla，Trac 有一个脚本[bugzilla2trac.py](http://trac.edgewall.org/wiki/TracImport)，它将为您自动将 Bugzilla 错误导入 Trac 票证的过程。当然，Trac 不支持开箱即用的阻塞/阻塞票证，所以如果你也想导入这些数据，你必须使用[MasterTicketsPlugin](http://trac-hacks.org/wiki/MasterTicketsPlugin)然后自己修改脚本（这是我们在我们迁移）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-01T09:43:11.253

导入脚本（尚未）涵盖的一件事是解决 bugzilla 链接类型`bug X`或`bug X comment Y`.

一种解决方案是使用 RegexLinkPlugin ( [http://trac-hacks.org/wiki/RegexLinkPlugin](http://trac-hacks.org/wiki/RegexLinkPlugin) ) 并在`trac.ini`文件中进行以下配置：

```
[regexlink]
regex1=\bbug (?P<bug_id_comment>\d+) comment #(?P<commentid>\d+)\b
url1=http://your.trac.instance.com/ticket/\g<bug_id_comment>#comment:\g<commentid>
regex2=\bbug (?P<bug_id>\d+)\b
url2=http://your.trac.instance.com/ticket/\g<bug_id> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-04T00:37:47.127

对于 MediaWiki，也存在一个脚本：[http ://trac.edgewall.org/ticket/5241](http://trac.edgewall.org/ticket/5241)

它有一些错误，但会导入所有重要信息（页面、修订、图像、用户）。连同其他提到的脚本，您应该能够迁移到 Trac。

# linux - 在 Linux 上使用 ldconfig

> ID：167635
> 
> 赞同：20
> 
> 时间：2008-10-03T16:10:35.030
> 
> 标签：linux

假设我已将库 foo.so.1.1.1 添加到包含在的路径中`/etc/ld.so.conf` 当我在系统上运行 ldconfig 时，我得到链接 foo.so.1.1 和 foo.so.1 到 foo.so.1.1 .1

如何更改行为以获取指向 foo.so.1.1.1 的 foo.so 链接？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-10-03T16:25:30.537

ldconfig 查看它找到的所有共享对象，以查找 soname。然后，它使用该 soname 作为链接名称创建一个链接。soname 是库的名称和主要版本是常规的（但远非普遍使用），因此您的库 foo.so.1.1 将具有 foo.so.1 的 soname 并且 ldconfig 将创建一个名为该链接的链接。

运行时系统的任何部分都不查找或知道关于名称 foo.so 的任何信息。当您将程序链接到库时使用它。除非您还拥有该库的所有其他开发文件（头文件等），否则拥有该链接是没有意义的，因此 ldconfig 自动创建它是没有意义的。而且由于要使用的链接名称只是另一种约定，在这种情况下根本不存储在文件中，因此 ldconfig 无法知道要创建什么名称。

通常这将在 Makefile 的安装目标中手动创建；当为 linux 发行版打包库时，链接通常与头文件一起存在于 -dev 包中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-03T16:20:10.143

只需自己制作符号链接：

```
ln -s /usr/lib/foo.so.1.1.1 /usr/lib/foo.so 
```

请注意，对于以这种方式使用库的应用程序，它们需要显式链接到未版本化的共享对象。IE：这是一种完全绕过动态加载器版本匹配系统的机制。

# sql - 如何在 SQL Server 2005 中插入值数组？

> ID：167643
> 
> 赞同：2
> 
> 时间：2008-10-03T16:12:30.003
> 
> 标签：sql, sql-server, sql-server-2005, bulkinsert

如何在不进行简单迭代的情况下编写 SQL 代码以插入（或更新）一个值数组（可能带有一个伴随的字段名数组，或者带有它们的矩阵）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-03T16:16:21.197

我将列表构造为 xml 字符串并将其传递给存储的过程。在 SQL 2005 中，它增强了 xml 功能来解析 xml 并进行批量插入。

查看这篇文章： [使用 XML 参数将列表传递给 SQL Server 2005](http://weblogs.asp.net/jgalloway/archive/2007/02/16/passing-lists-to-sql-server-2005-with-xml-parameters.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-12T21:16:33.850

将值连接到列表并将其传递给 sp 的简单方法。

在 sp 中使用 dbo.Split udf 转换回结果集（表）。

创建这个函数：

```
CREATE FUNCTION dbo.Split(@String nvarchar(4000), @Delimiter char(1))
returns @Results TABLE (Items nvarchar(4000))
as
begin
declare @index int
declare @slice nvarchar(4000)

select @index = 1
if @String is null return

while @index != 0

begin
select @index = charindex(@Delimiter,@String)
if @index !=0
select @slice = left(@String,@index - 1)
else
select @slice = @String

insert into @Results(Items) values(@slice)
select @String = right(@String,len(@String) - @index)
if len(@String) = 0 break
end return
end 
```

然后尝试：

```
select * from dbo.split('a,b,c,d,e,f,g,h,i,j,k,l', ',') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T16:17:06.547

我了解您正在谈论编写存储过程以接受值数组

使用 SQL Server 2005，您需要使用 XML 变量

SQL 2008 增加了对表变量作为参数的支持

[在这里，您可以找到将表作为XML](http://www.sqlservercentral.com/articles/Stored+Procedures/2977/)和[表变量](http://www.sqlservercentral.com/articles/News/3182/)(SQL Server 2008)传递给存储过程的好例子

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T16:26:27.727

如果您的数据已经在数据库中，您可以使用`INSERT SELECT`语法。它与 INSERT VALUES one 略有不同...

```
INSERT recipient_table (field1, field2)
SELECT field1_from, field2_from
FROM donor_table
WHERE field1_from = 'condition' 
```

# html - 使用条件注释定位 IE8 是否有效？

> ID：167657
> 
> 赞同：18
> 
> 时间：2008-10-03T16:13:26.820
> 
> 标签：html, css, internet-explorer, internet-explorer-8, stylesheet

当 IE8 发布时，以下代码是否可以添加条件样式表？

```
<!--[if IE 8]>
  <link rel="stylesheet" type="text/css" href="ie-8.0.css" />
<![endif]--> 
```

我已经阅读了关于这是否适用于测试版的相互矛盾的报告。我希望有人可以分享他们的经验。谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-03T18:05:11.477

需要注意的一件事：

它确实有效，***但是***如果您正在加载页面/站点***本地网络（例如 Intranet）***，它将***默认以******IE7***模式加载！（更新 - [localhost](http://blogs.msdn.com/ie/archive/2008/12/03/compatibility-view-improvements-to-come-in-ie8.aspx#9180796) [*] 是一种特殊情况，它**会**以标准模式呈现）

 ***这违背了 MSFT 最初默认采用 STANDARDS 的声明。

例如

```
http://127.0.0.1/mysite/mypage.php  <-- IE8 by default (updated!)
http://localhost/mysite/mypage.php  <-- IE8 by default (updated!)
http://machinename/mysite/mypage.php  <-- IE7 by default
http://192.168.100.x/mysite/mypage.php  <-- IE7 by default
http://google.com/  <-- IE8 by default 
```

[*] - Scott Dickens [MSFT] 在[IE 博客上](http://blogs.msdn.com/ie/archive/2008/12/03/compatibility-view-improvements-to-come-in-ie8.aspx#9180796)的评论中指出，localhost 是 Intranet 中的一个特殊场景（通常用于开发 Internet 站点），因此默认情况下会以标准模式呈现。

要测试 IE8 中的页面真正呈现的模式，您可以使用检查开发人员工具或使用此小书签代码（仅适用于 IE8）：

```
javascript:
var vMode=document.documentMode;
var rMode='IE5 Quirks Mode';
if(vMode==8){
  rMode='IE8 Standards Mode';
} else if(vMode==7){
  rMode='IE7 Strict Mode';
}
alert('Rendering in: '+rMode); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-03T16:18:24.703

它对我有用——无论是在怪癖模式还是在标准合规模式下。但是，切换到 IE8 兼容模式时它不起作用*。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T15:05:09.537

工具/兼容性视图设置

取消选中它们

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-07T19:29:18.943

感谢您的帮助。我发现了解决方案，显然问题是让每个样式表都使用自己的标题属性。一旦我从除主样式表之外的所有标题中删除了标题，就没有问题了。

这是 IE8 独有的一个奇怪问题 - 虽然我被告知它应该以这种方式工作，但与“样式表首选项”有关 - 它只会产生问题，因为解决方案要求您删除可能有帮助的标题编写脚本时等 - 当您需要调用样式表时。

无论如何，不​​确定这是否是一个错误，或者它应该是这样，但我希望微软进一步调查。

谢谢

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-16T21:52:14.557

为什么还要为 IE8 编写单独的样式表？

如果您已经针对 IE7 进行了调试，则可以强制 IE8 进入兼容模式，从而将您的代码显示为 IE8 是 IE7。

你所要做的就是把这个放在开头标签的正下方。其他任何地方都行不通。

然后每个项目平均只需要半小时左右的时间，不需要对 IE8 进行密集调试！

甚至 Msn.com 也这样做 - 有点讽刺，嗯？

最近写了一篇关于它的博客文章：http: [//blog.sankhomallik.com/2009/11/16/stop-wasting-time-debugging-on-ie8-when-you-dont-have-to-or-get- ie8-to-behave-like-ie7/](http://blog.sankhomallik.com/2009/11/16/stop-wasting-time-debugging-on-ie8-when-you-dont-have-to-or-get-ie8-to-behave-like-ie7/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-21T23:34:00.223

与 IE7 相比，IE8 的渲染效果非常好，我有 IE6、IE7 和 IE8 的样式表；起初我认为条件注释不适用于 IE8 经过一些实验后我发现 IE8 没有应用一些规则只是因为我需要先放置祖先类或父类，例如我有一个类

`.niceclass {some:properties;more:properties;}`

**仅**当我将其更改为以下内容时它才有效：

`.parentclass .niceclass {some:properties;more:properties;}` **或者**

`#parentselector .niceclass {some:properties;more:properties;}`

顺便说一句，在我的仅限 IE8 的 css 中，我只有一个压倒一切的规则，其余的几乎就像 firefox 一样呈现，尽管那不会让我离开 FF！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-28T09:36:26.670

就我而言，我想使用 css 使用圆角边框。Vista 上的 IE8 不支持这样的。而且由于图形的圆形边框也会显示出漂亮的圆形阴影，因此页面在 IE8 中看起来很糟糕。

我尝试使用条件注释，但无济于事，IE8 不会评估 if IE 表达式，因此不会包含外部样式表。

然后我看了一下将其置于 quirks / compatiblity 模式，但是，这仍然不起作用，因为我使用的 CSS hack 不再适用于 IE8。

最后但最不重要的是，我发现了一个可以在兼容模式下正确呈现页面的 CSS hack。

```
* + html #test[id] { color:lime } 
```

现在，我不知道这是否适用于 IE7 或更低版本，因此对于要支持的每个 IE 版本，您至少有三种不同的 hack，ee

```
* + html #test,
    html+body #test,
    * html body #test
    { color:lime } 
```

我想知道 Internet Exploiter 的下一次回归会为我们带来什么。

# nsis - 如何更改有关 CRCCheck 的 NSIS 错误消息

> ID：167667
> 
> 赞同：1
> 
> 时间：2008-10-03T16:16:12.227
> 
> 标签：nsis, crc

我的一些用户抱怨我的安装程序在从我的网络服务器下载后遇到了一些奇怪的错误。

这是 NSIS 安装程序，当下载时出现瘫痪或不完整（通常是因为 Internet 连接速度慢），消息非常清楚“您尝试使用的安装程序已损坏或不完整......”用英语！！（我有没有提到我的用户只会说西班牙语？）。

如何更改语言或创建自定义错误消息？

我已经使用以下方法创建了西班牙语安装程序：

```
; Language files
!insertmacro MUI_LANGUAGE "Spanish" 
```

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T09:55:30.673

CRC 检查在您/nsis 可以访问语言字符串之前运行，因此更改此消息的唯一方法是重新编译源代码。

该消息在几个版本前已更改，现在包含 NSIS wiki 的 URL，人们会认为您的用户将能够在该页面上运行翻译器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T16:21:36.257

我没有做过 NSIS 包，因为它被称为 Super Pimp（伟大的名字）。看看这是否有帮助： [NSIS 语言表](http://nsis.sourceforge.net/Adding_Language_strings_as_resources)

# svn - 多列（制表符分隔）文本文件上的 SVN 合并有任何问题吗？

> ID：167670
> 
> 赞同：2
> 
> 时间：2008-10-03T16:16:41.163
> 
> 标签：svn, merge, line, tabs, delimited

我有一个多列文本文件（制表符分隔），用于项目中的本地化文本。

我选择了这种格式，因为任何人都可以在大多数文本编辑器（以及 excel）中轻松编辑它。

我的 makefile 将它处理成一堆定义和二进制数据，以便直接包含到我的应用程序中。

您知道 SVN 合并是否只进行逐行合并还是也可以进行子行合并？

例如：

原始文件（未翻译）包含：

```
DEFINE         ENGLISH  GERMAN   FRENCH
STRING_YES     YES      *YES*    *YES*
STRING_NO      NO       *NO*     *NO* 
```

然后法语翻译更新它：

```
DEFINE         ENGLISH  GERMAN   FRENCH
STRING_YES     YES      *YES*    OUI
STRING_NO      NO       *NO*     NON 
```

然后德语翻译更新它：

```
DEFINE         ENGLISH  GERMAN   FRENCH
STRING_YES     YES      JA       *YES*
STRING_NO      NO       NEIN     *NO* 
```

然后他们都将结果合并回 int SVN，所以他们会覆盖彼此的更改还是可以处理一行上的多个更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T16:23:08.983

它是一行一行的。

1.  稍后尝试提交的人会收到“过时”错误，当他们尝试更新它时，他们会在更改的行中遇到冲突。
2.  与合并相同。稍后合并的人将不得不手动解决冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-06T14:49:57.267

SVN 合并是逐行的，因此在您概述的情况下，将创建冲突并且必须手动合并。然而，使用不错的合并工具，翻译人员自己可能会处理这个问题——这些工具可以逐个字符地显示差异。

[TortoiseSVN](http://tortoisesvn.tigris.org/)是事实上的 Windows SVN 客户端，其中包括[TortoiseMerge（截图）](http://tortoisesvn.tigris.org/TortoiseMerge.html)。

Linux 中有几个合并工具，[Meld](http://meld.sourceforge.net/)是我目前（gnome）最喜欢的。

还有几个我希望有这个功能的[Mac 客户端。](https://stackoverflow.com/questions/899/best-subversion-client-for-mac-os#902)

# .net - 如何为 .NET 控制台应用程序设置配置文件？

> ID：167671
> 
> 赞同：17
> 
> 时间：2008-10-03T16:16:41.570
> 
> 标签：.net, configuration, web-config, app-config, console-application

是否可以为 .NET 控制台应用程序使用“.net 配置”文件？

我正在寻找与 web.config 等效的东西，但专门用于控制台应用程序......

我当然可以自己动手，但是如果我可以使用 .NET 的内置配置阅读器，那么我想这样做......我真的只需要存储一个连接字符串......

谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-03T16:18:37.103

是的 - 使用 app.config。

与 web.config 完全相同的语法、选项等，但用于控制台和 WinForms 应用程序。

要将一个添加到您的项目，请在解决方案资源管理器中右键单击该项目，添加...，新建项目...，然后从“模板”框中选择“应用程序配置文件”。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-03T16:18:52.237

app.config... 如果您的项目中有 App.config，则在控制台应用程序的情况下，它将被复制为 executableName.exe.config。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-26T08:59:46.677

这可能对一些处理 Settings.settings 和 App.config 的人有所帮助：在 Visual Studio 中编辑 Settings.settings 网格中的任何值（行）时，请注意“属性”窗格中的 GenerateDefaultValueInCode 属性（在我的情况下为 VS2008）。如果将 GenerateDefaultValueInCode 设置为 True（此处默认为 True！），则默认值会编译到 exe（或 dll）中，当您在纯文本编辑器中打开文件时，可以发现它嵌入在文件中。我正在开发一个控制台应用程序，如果我在 exe 中有默认值，该应用程序总是忽略放置在同一目录中的配置文件！一场噩梦，整个互联网上都没有这方面的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T16:18:18.883

是的，这是可能的。你只需要制作一个 app.config 文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T16:18:20.070

是的。在文档中查找“应用程序配置文件”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T16:28:04.667

因为我还没有完全实现 TDD 的飞跃（虽然我希望在一些即将到来的项目中）我使用控制台应用程序来测试我为我们公司的另一个 Web 开发人员生成的库代码。

我将 app.config 用于所有这些设置，正如[@Dylan](https://stackoverflow.com/questions/167671/how-can-i-set-up-a-configuation-file-for-net-console-applications#167693)所说，它和 web.config 之间的语法完全相同，这意味着我也可以将 app.config 的内容交给其他开发人员，然后他可以将它们直接放在他的 web.config 中。非常便利。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T17:03:16.517

几天前我问了几乎同样的问题，得到了很好的答案，看看：

[在 Windows 窗体 C# 应用程序中拥有配置文件的最简单方法](https://stackoverflow.com/questions/114527/simplest-way-to-have-a-configuration-file-in-a-windows-forms-c-application)

# git - 我可以将本地分支映射到 git 中具有不同前缀的远程分支吗？

> ID：167697
> 
> 赞同：15
> 
> 时间：2008-10-03T16:19:22.937
> 
> 标签：git, heroku, phpfog, nodester

我们在我工作的地方使用半集中式 git 存储库。每个开发人员在中央 git 存储库中都有自己的子树，所以它看起来像这样：

```
掌握
爱丽丝/分支1
爱丽丝/分支2
鲍勃/分支1
迈克尔/功能
发布/1.0
发布/1.1
```

我在我的树中本地工作`topic/feature`，这对应`michael/feature`于中央树。

我一直在使用

```
git push origin topic/feature:michael/feature 
```

将我的更改推送到远程树。然而，这很麻烦并且容易出错（例如省略开发者名称、拼写错误的功能名称等）。

我正在寻找一种更清洁的方法来做到这一点。例如，“ `git push`”。我怀疑使用修改后的 fetch refspec 设置一个不同的遥控器会做到这一点，但我不确定该怎么做。我也不确定如何修改我当前的分支定义以使用不同的遥控器。

我的电流`.git/config`看起来像：

```
[遥远的“起源”]
    url = git://central/git/project
    fetch = +refs/heads/*:refs/remotes/origin/*
[分支“主题/功能”]
    远程=原点
    合并 = refs/heads/michael/project
```

**编辑：**我也想将此应用于拉取/获取。但是管家`branch.<name>.merge`管这事吗？

如果我发现了什么，我会继续研究这个并在这里发布，但我希望能得到一些其他的好主意。

**编辑 2：**我决定保持本地和远程分支名称相同。看来这将是最少的工作，也最不容易出现未来的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T22:19:13.180

在您的 [remote "origin"] 部分中，为每个映射添加一行。包括大师对大师。

```
push = refs/heads/master:master
push = refs/heads/topic/feature:michael/feature 
```

我不确定如何使用 git-config 命令执行此操作。

请注意，从现在开始，当您执行直接 git push（没有参数）时，所有分支都会被同时推送。

您愿意解释一下为什么不在本地和远程保留相同的分支名称吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-04T05:09:17.050

如果可以，我建议您在本地和远程使用相同的分支名称。然后`git push`将所有本地分支推送到中央存储库中的相应分支。

要在本地和远程存储库中使用不同的前缀，您需要在每次创建新功能分支时向配置文件添加映射。为 topic/BRANCH_NAME 设置映射的命令是

```
 git config remote.origin.push refs/heads/topic/BRANCH_NAME:michael/BRANCH_NAME 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-10-23T14:30:51.423

采用

```
git branch --set-upstream-to=origin/remoteBranch localBranch 
```

其中 origin/remoteBranch 是远程名称，localBranch 是本地分支名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-13T23:44:46.823

您可以使用以下方式将您的分支映射到远程上的不同跟踪分支：

```
git remote add heroku git@heroku.com:YOURAPPNAME.git
git checkout -b heroku -t heroku/master 
```

您的配置最终类似于@Paul 的建议（实际上有点“简单”）。

请参阅此要点（我进行了调整）以了解适合我的使用步骤[https://gist.github.com/2002048](https://gist.github.com/2002048)。

# emacs - 在不重启 Emacs 的情况下重新加载配置

> ID：167705
> 
> 赞同：91
> 
> 时间：2008-10-03T16:21:12.090
> 
> 标签：emacs, loading, restart

如何在`.emacs`不重新启动 Emacs 的情况下加载编辑的文件？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2008-10-03T16:23:00.277

Mx 评估缓冲区

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-10-05T21:31:51.277

我通常使用 Mx 加载文件。但请注意，某些初始化仅在第一次完成。诸如在加载时设置默认值的库之类的东西，但第二次不会重新加载。从头开始启动 emacs 总是一个好主意，作为最后检查一切是否正常。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-08-19T03:23:15.050

在`*scratch*`缓冲区中，键入：

```
(load-file user-init-file) 
```

然后按`C-x C-e`评估表达式。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-03T16:29:56.427

Mx load-file 然后选择 .emacs 文件也应该可以工作

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-08-25T23:55:09.657

Mx 加载文件 ~/.emacs

打开 .emacs 文件时的 eval-buffer

eval-region 当你想应用选定的行时

Cx Ce 计算前面的表达式

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-10-05T18:30:58.987

```
M-x load-file ENTER
~/.emacs
ENTER 
```

（[来源](http://www.saltycrane.com/blog/2007/07/how-to-reload-your-emacs-file-while/)）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-03T16:23:42.210

打开 .emacs 文件，选择其内容并点击 Cx,Ce

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-02-29T14:42:08.320

您可以使用`C-x C-e`which 将评估 s 表达式。确保光标位于 elisp 代码的最后一个括号中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-01T21:30:12.943

我在 melpa 上使用并推荐 restart-emacs 包

# database - CouchDB 和 Lotus Notes 有什么区别？

> ID：167716
> 
> 赞同：22
> 
> 时间：2008-10-03T16:22:24.087
> 
> 标签：database, couchdb, lotus-notes

我正在研究使用 CouchDB 的可能性。我听说它类似于每个人都喜欢讨厌的 Lotus Notes。这是真的？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-11-21T11:39:16.023

Lotus Notes 的开发始于 20 多年前，[版本 1 于 1989 年发布](http://www.ibm.com/developerworks/lotus/library/ls-NDHistory/)。它是由现任微软首席软件架构师 Ray Ozzie 开发的。

Lotus Notes（客户端）和 Domino（服务器）已经存在了很长时间，并且是成熟且功能强大的产品。它有：

*   一个完整的客户端服务器堆栈，具有快速的应用程序设计和面向文档的数据库的部署。
*   用于安全和加密的完整公钥基础设施。
*   一个健壮的复制模型和跨异构平台的主动集群（有人曾经展示了一个带有[xbox 和巨大 AIX 服务器](http://www.nashcom.de/nshweb/pages/xbox.htm)的多米诺集群）。
*   用于管理用户的内置本机目录，也可以通过 LDAP 访问。
*   一个内置的本地邮件系统，可以扩展以管理数百万具有多 GB 邮件文件的用户，具有实时服务器访问权限或本地复制以进行离线访问。这可以通过 SMTP 与标准 Internet 邮件交互，并且还内置了 POP 和 IMAP 访问。邮件基础结构是一个核心功能，可用于构建在 Notes Domino 上的所有应用程序（数据库中的任何文档都可以通过邮件发送到任何其他数据库）一个简单的 doc.send() 命令）。
*   一个内置的 HTTP 堆栈，允许通过 Web 访问服务器托管的数据库。
*   用于访问、传输和与 RDBMS 和 ERP 系统互操作的大量集成选项，与可用的 DB2 紧密耦合的集成允许 Notes 数据库在需要时由关系存储支持。

向后兼容性一直是 Notes Domino 的一个强大功能，并且经常发现为版本 3 开发的数据库在最新版本中完美运行。IBM 在这方面付出了巨大的努力，它对产品当前的运行方式有很大的影响。

-

CouchDB 由 Damien Katz 创建，于 2004 年开始开发。他之前曾在 IBM 工作过 Notes Domino，开发模板并最终完全重写了 ND6 的核心功能之一，即公式引擎。

CouchDB 与 Notes Domino 具有的视图共享面向文档的数据库的基本概念。

在此模型中，“文档”只是以某种方式存储的任意值集合。在 CouchDB 中，文档是任意复杂度的 JSON 对象。在 Notes 中，值是简单的名称值对，其中的值可以是字符串、数字、日期或它们的数组。

视图是数据库中文档的索引，显示特定值，计算其他值并排除不需要的文档。建立索引后，当数据库中的任何文档更改（创建更新或删除）时，它们会增量更新。

在 CouchDB 中，视图是通过在数据库中的每个文档上运行映射函数来构建的。映射函数为它想要为给定文档创建的每个索引条目调用带有 JSON 对象的 emit 方法。这个 JSON 对象可以是任意复杂的。然后，CouchDB 可以在视图的映射索引上运行第二个归约函数。

在 Notes Domino 中，视图是通过在数据库中的每个文档上运行选择函数（以 Notes Domino 公式语言编写的）来构建的。select 函数只是定义文档是否应该在视图中。Notes Domino 视图设计还为视图定义了许多列。每列都有一个针对选定文档运行的公式，以确定该列的值。

CouchDB 能够生成比 Notes Domino 更复杂的视图索引。

CouchDB 也有一个复制系统。

-

**总结**( ***TL;DR*** )：CouchDB 是全新的软件，它正在开发一个核心，该核心具有与 Lotus Notes Domino 中使用的相似的概念但更复杂的设计。Lotus Notes Domino 是一个成熟的、功能齐全的产品，可以在今天进行部署。CouchDB 是从零开始，为未来的功能开发打下坚实的基础。Lotus Notes Domino 正在继续开发新特性，但是是在一个已经有 20 年历史的平台上开发的，该平台努力保持向后兼容性。Notes Domino 中有一些您可能希望在 CouchDB 中出现的功能，但 Notes Domino 中也有一些在当今世界不合时宜的功能。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-06T08:57:57.383

人们通常讨厌的是 Notes 应用程序和 UI。不是背后的架构。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-06T21:55:17.197

Damien Katz 在 Iris (Lotus) 工作，但他不是 Notes 数据库背后的人。[他在 Lotus Notes 社区中以重新设计Notes 公式引擎](http://damienkatz.net/2005/01/formula-engine-rewrite.html)而闻名。
CouchDB 和 Lotus Notes 之间肯定有一些相似之处，例如它们面向文档、非关系数据和复制功能，但它们之间的差异大于相似之处。CouchDB 是数据库服务器，Lotus Notes 是企业级协作平台。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-10-30T07:08:53.140

@Lex，您应该先说一下您正在使用的 Notes/Domino 版本，因为您的评论不正确。

“不支持事务” - Domino 具有事务日志记录。如果您想要在编码中也可用的更复杂的事务日志记录。

“不太适合处理多个数据事务” - 实际上它可以很好地处理它们。您有文档锁定和复制冲突解决方案。很大程度上取决于您如何设置应用程序来处理工作流程。

“生产/开发环境之间没有分离。” - 错误的。如果您的环境部署不当，这可能是正确的唯一方法。开发人员通常应该有 0 访问权限来将设计更改部署到生产环境。他们将使用不会复制到主服务器的模板。一旦更新完成并获得批准，管理员就会部署它。他们通过获取模板并使用允许在生产中运行的受控签名对其进行签名，然后将模板放入并更新相关应用程序的设计。

“lotus notes 包含的数据越多，可能会创建更多的视图” - 这个评论绝对没有任何意义。我不相信您在任何专业能力中都使用过 Notes/Domino。

“莲花脚本不是面向对象的” - 是的，你在那里提出了很好的观点。然而，这并不意味着语言有缺陷。自 8.x 和 8.5.1 以来，他们也进行了大量改进。例如内置的 Web 服务支持（指向 WSDL 和 LS 代码是为您制作的）。8.5.1 还有很多新的设计器功能，如代码模板、自动完成、对您自己的功能的 LSDoc 弹出帮助等。

您也只涉及 LotusScript。然而，您还可以编写以下代码：Java、SSJS/DOJO (XPages)、Javascript、@Formula 语言、Web 服务 (SOAP/REST)、C-API、Eclipse 插件 (RCP)。以 JSON 和 XML 格式输出。

8.5.1 Designer 客户端现在可以免费下载，如果您想测试一下。

因此，虽然我认为我无法对 CouchDb 发表评论，但您肯定不在 Notes/Domino 上。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T16:35:17.070

Lotus Notes 客户端/Domino 服务器由对象（“文档”）存储（非关系）机制组成，具有完全集成的基于证书的安全模型/用户管理和冲突解决方案，用于同步离线/在线数据更改 - 这是一个分布式应用平台。

“ [CouchDB](http://wiki.apache.org/couchdb/FrequentlyAskedQuestions#what_is_couchdb)是一个面向文档的非关系数据库管理服务器 (NRDBMS)。”

CouchDB 可通过 REST 风格的 API 访问。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T16:46:17.673

[这里](http://twit.tv/floss36)有 CouchDB 团队的 Jan Lehnardt 的播客采访。

无需回头再听一遍，我相信 Damien Katz，他是 CouchDB 的发起人，并且仍然是首席开发人员，也是 Notes 数据库的幕后推手。所以在某种意义上，我猜 CouchDB 是一个更好的 Notes DB。[他在博客](http://damienkatz.net/2008/01/faq_about_couch.html)中解释了一些不同之处。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T22:27:01.330

它与 Notes 处理数据的方式类似，因为一切都是任意结构的文档，您可以查看这些文档，而不是像在关系数据库中那样拥有表格和记录。复制等也有一些相似之处。

Notes 服务器架构没有任何问题，人们并不那么讨厌它。更多的是 Notes 附带的实现和膨胀。

CouchDB 也没有前端，只有一个服务器组件。Notes 客户端很糟糕，而这正是人们真正讨厌的地方。你有没有试过用电子邮件发送，*呃，我的意思是“备忘录”*来自 Notes 的东西？不愉快:(

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-05T19:53:51.640

比较苹果和橙子

Lotus Notes Domino 没有太大变化，并且没有针对 Notes Domino v12 或任何更早版本的本地或云 NoSQL 服务选项。Domino 不是基于云的技术。

谈到 NoSQL，Domino 将 NoSQL 用于其在 Domino 中构建的自己的应用程序解决方案。曾尝试使用基于 Java 6 的 Domino Access Services，Rest API 在 v12 中仍然使用 Vectors。该服务还可以，但不可靠，它提供了一种与 NSF 中的数据交互的方法。请记住，Domino 是键值对存储，并且由于安全模型，在大型数据集上非常慢，每次搜索都会检查每个文档的读者和作者，以确定用户是否可以查看该文档。Domino 仍然是 Web 1.0。

使用 CouchDB，您可以在移动设备上构建应用程序并进行部署。由于 Domino 服务器，无法对 Notes/Domino 执行相同操作。Domino dev 也只支持 MS Windows 并且 IDE 基于旧版本的 Eclipse，直到今天 v12，没有办法在 Domino IDE 中使用双显示器。问任何 Domino 开发人员，他们讨厌被迫在无法跟上行业发展的特定平台上使用 IDE。

沙发也经历了许多变化，简史：

*   CouchDB 由 IBM Lotus Domino 工程师 Damian Katz 创立
*   Apache 项目 BigCouch 诞生；添加了可扩展性和集群
*   Cloudant 诞生；大数据和 IBM 资金以及 IBM Cloud 产品
*   CouchDB 2.0 诞生；Cloudant + BigData 合并回 CouchDB
*   CouchDB 3.0 诞生；增强了 Foundation DB 的安全性和准备工作
*   CouchDB 4.0 诞生；架构更改为 Apples Foundation DB

[https://www.dataengineeringpodcast.com/couchdb-document-database-episode-124/](https://www.dataengineeringpodcast.com/couchdb-document-database-episode-124/)

# database - 再次使用 JPA 没有意义

> ID：167729
> 
> 赞同：-2
> 
> 时间：2008-10-03T16:24:08.310
> 
> 标签：database, jpa

我早些时候[问过这个问题](https://stackoverflow.com/questions/167193/jpa-and-2-simple-tables)，并被告知要查看映射的依据。

> 我有 2 个表：一个 s_id(key) 名称 cli 类型
> 
> ```
> B sa_id(key) s_id user pwd. 
> ```
> 
> 所以在 Jpa 我有：
> 
> ```
> @Entity class A...{
> @OneToMany(fetch=FetchType.EAGER)
> @JoinTable( name="A_B",
> joinColumns={@JoinColumn(name="a_id",
> table="a",unique=false)},
> inverseJoinColumns={@JoinColumn(name="b_id",
> table="b", unique=true)} ) Collection
> getB(){...} } 
> ```
> 
> b 类只是一个基本实体类，没有引用 A。
> 
> 希望这很清楚。我的问题是：我真的需要一个连接表来做这样一个简单的连接吗？这不能用一个简单的joincolumn之类的东西来完成吗？

所以现在如果有这个，但是 jpa 正在尝试用一些不存在的新列编写查询（`s_s_id`）

```
@Entity
class A{
...
@OneToMany(fetch=FetchType.EAGER, mappedBy="s")
Collection<B> x;
}

@Entity
class B{
@ManyToOne
A s;
}

With these tables:
A 
s_id(key) name cli type

B
sa_id(key) s_id(the keys from A) user pwd. 
```

如何进行`OneToMany`和`ManyToOne`连接，这样我就不需要新列或新表？请给我一个例子。问题是 B 表中缺少外键吗？

如果我省略了映射，我会得到`Unknown column 't1.S_S_ID' in 'field list'`

如果我输入映射，我会得到`Unknown column 'S_S_ID' in 'field list'`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T16:42:54.623

我找到了，我需要添加`@JoinColumn`并给它一个名字......

# c++ - 用于程序内容的快速伪随机数生成器

> ID：167735
> 
> 赞同：14
> 
> 时间：2008-10-03T16:25:35.157
> 
> 标签：c++, x86, random

我正在寻找一个伪随机数生成器，当它在生成每个数字之前被赋予种子时，它将专门用于快速工作。到目前为止，我见过的大多数生成器都假设您设置一次种子，然后生成一长串数字。到目前为止，唯一看起来与我看到的有点相似的是 Perlin Noise，但它生成的数据过于“平滑”——对于类似的输入，它往往会产生类似的结果。

生成器的声明应该类似于：

```
int RandomNumber1(int seed); 
```

或者：

```
int RandomNumber3(int seedX, int seedY, int seedZ); 
```

我认为拥有良好的 RandomNumber1 就足够了，因为可以通过散列其输入并将结果传递给 RandomNumber1 来实现 RandomNumber3，但我编写了第二个原型，以防某些实现可以使用独立输入。

此生成器的预期用途是将其用于程序内容生成器，例如通过将树木放置在网格中并确定每个位置的随机树种和随机空间偏移来生成森林。

生成器需要非常高效（低于 500 个 CPU 周期），因为在渲染过程中会实时大量创建程序内容。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-03T16:30:53.197

似乎您要的是散列函数而不是 PRNG。谷歌搜索“快速哈希函数”会产生几个看起来很有希望的结果。

[例如](http://burtleburtle.net/bob/hash/integer.html)：

```
uint32_t hash( uint32_t a)
    a = (a ^ 61) ^ (a >> 16);
    a = a + (a << 3);
    a = a ^ (a >> 4);
    a = a * 0x27d4eb2d;
    a = a ^ (a >> 15);
    return a;
} 
```

**编辑：**是的，一些哈希函数看起来肯定比其他函数更合适。

出于您的目的，观察函数并检查输入中的单个位变化是否会传播到许多输出位就足够了。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-03T16:38:44.973

是的，您正在寻找一种快速整数哈希算法而不是 PRNG。

这个[页面](http://www.concentric.net/~Ttwang/tech/inthash.htm)有一些算法，我相信你现在知道正确的搜索词会发现更多。

**编辑**：原始页面已被删除，可以[在 GitHub 上找到](https://gist.github.com/badboy/6267743)实时版本。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-19T01:07:03.630

这是一个由 George Marsaglia 开发的小型随机数生成器。他是该领域的专家，因此您可以确信生成器具有良好的统计特性。

```
v = 36969*(v & 65535) + (v >> 16);
u = 18000*(u & 65535) + (u >> 16);
return (v << 16) + (u & 65535); 
```

这里 u 和 v 是无符号整数。将它们初始化为任何非零值。每次生成随机数时，将 u 和 v 存储在某处。您可以将其包装在一个函数中以匹配您上面的签名（除了整数未签名。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T17:48:36.923

请参阅`std::tr1::ranlux3`或其他随机数生成器，它们是 TR1 添加到标准 C++ 库的一部分。我最初建议使用 mt19937，但后来看到您的说明，它需要非常快。TR1 应该在[Microsoft VC++](http://msdn.microsoft.com/en-us/library/bb982847.aspx)和 GCC 上可用，也可以在支持更多编译器的 boost 库中找到。

改编自[boost 文档](http://www.boost.org/doc/libs/1_36_0/libs/random/index.html)的示例：

```
#include <random>
#include <iostream>
#include <iterator>
#include <functional>
#include <algorithm>
#include <ctime>
using namespace std;
using namespace std::tr1;
int main(){
    random_device trueRand;
    ranlux3 rng(trueRand);  // produces randomness out of thin air
                            // see pseudo-random number generators
    uniform_int<> six(1,6); // distribution that maps to 1..6
                            // see random number distributions
    variate_generator<ranlux3&, uniform_int<> >
           die(rng, six);   // glues randomness with mapping

    // simulate rolling a die
    generate_n( ostream_iterator<int>(cout, " "), 10, ref(die));
} 
```

示例输出：

```
2 4 4 2 4 5 4 3 6 2 
```

任何 TR1 随机数生成器都可以播种任何*其他*随机数生成器。如果您需要更高质量的结果，请考虑将 mt19937（速度较慢，但​​质量更高）的输出输入到 minstd_rand 或 randlux3，它们是更快的生成器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-05T00:04:19.253

如果内存不是真正的问题并且速度是最重要的，那么您可以预先构建大量随机数并在运行时迭代它。例如，有一个单独的程序生成 100,000 个随机数并将其保存为自己的文件，例如

无符号整数 randarray []={1,2,3,....}

然后将该文件包含到您的编译中，并且在运行时您的随机数函数只需要从该数组中提取数字并在它到达结尾时循环回到开头。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-18T21:21:05.170

我在我的 Java 随机数库中使用以下代码 - 这对我来说效果很好。我也用它来生成程序内容。

```
/**
 * State for random number generation
 */
private static volatile long state=xorShift64(System.nanoTime()|0xCAFEBABE);

/**
 * Gets a long random value
 * @return Random long value based on static state
 */
public static long nextLong() {
    long a=state;
    state = xorShift64(a);
    return a;
}

/**
 * XORShift algorithm - credit to George Marsaglia!
 * @param a initial state
 * @return new state
 */
public static final long xorShift64(long a) {
    a ^= (a << 21);
    a ^= (a >>> 35);
    a ^= (a << 4);
    return a;
} 
```

# java - Java 应用程序中加载的类数中可能存在内存泄漏

> ID：167740
> 
> 赞同：9
> 
> 时间：2008-10-03T16:26:49.803
> 
> 标签：java, profiling

我最近开始分析我正在使用 VisualVM 编写的 osgi java 应用程序。我注意到的一件事是，当应用程序开始（通过 JMS）向客户端发送数据时，加载的类的数量开始以稳定的速度增加。但是，堆大小和 PermGen 大小保持不变。即使停止发送数据，类的数量也不会下降。这是内存泄漏吗？我认为是这样，因为加载的类必须存储在某个地方，但是即使在我运行应用程序几个小时后，堆和 permgen 也不会增加。

有关我的分析应用程序的屏幕截图，请转到[此处](http://sites.google.com/site/javaperformacescreenshot/Home/profile.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-03T17:25:00.590

> 您是否以某种方式动态创建新类？

谢谢你的帮助。我弄清楚了问题所在。在我的一个课程中，我使用 Jaxb 创建了一个 XML 字符串。在这样做时，JAXB 使用反射来创建一个新类。

```
JAXBContext context = JAXBContext.newInstance(this.getClass()); 
```

因此，尽管 JAXBContext 没有在堆中说明，但类已经加载。

我再次运行我的程序，我看到了一个正常的高原，正如我所期望的那样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-03T17:03:50.757

您可能会发现一些热点标志可用于理解此行为，例如：

*   -XX:+TraceClassLoading
*   -XX:+TraceClass卸载

这是一个很好的参考：

[http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-03T17:44:55.840

我敢打赌，您的问题与字节码生成有关。

许多库使用 CGLib、BCEL、Javasist 或 Janino 在运行时为新类生成字节码，然后从受控类加载器加载它们。释放这些类的唯一方法是释放对类加载器的所有引用。

由于类加载器由每个类持有，这也意味着您不应该释放对所有类的引用 [1]。你可以用一个不错的分析器来捕捉这些（我使用 Yourkit - 搜索具有相同保留大小的多个类加载器实例）

一个问题是 JVM 默认不卸载类（原因是向后兼容性——人们（错误地）假设静态初始化程序只会执行一次。事实是每次加载类时它们都会执行。）启用卸载，您应该通过一些使用以下选项：

```
-XX:+CMSPermGenSweepingEnabled -XX:+CMSClassUnloadingEnabled 
```

（使用 JDK 1.5 测试）

即便如此，过多的字节码生成也不是一个好主意，所以我建议你在你的代码中查找罪魁祸首并缓存生成的类。常见的违规者是脚本语言、动态代理（包括由应用程序服务器生成的代理）或巨大的 Hibernate 模型（在这种情况下，您可以增加 permgen）。

也可以看看：

1.  [http://blogs.oracle.com/watt/resource/jvm-options-list.html](http://blogs.oracle.com/watt/resource/jvm-options-list.html)
2.  [http://blogs.oracle.com/jonthecollector/entry/presenting_the_permanent_generation](http://blogs.oracle.com/jonthecollector/entry/presenting_the_permanent_generation)
3.  [http://forums.sun.com/thread.jspa?messageID=2833028](http://forums.sun.com/thread.jspa?messageID=2833028)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-03T16:52:53.573

除非我误解了，否则我们在这里查看的是加载的类，而不是实例。

当您的代码第一次引用一个类时，JVM 让 ClassLoader 出去并从 .class 文件或类似文件中获取有关该类的信息。

我不确定它会在什么条件下卸载一个类。当然，它不应该卸载任何带有静态信息的类。

因此，我希望有一个与您的模式大致相似的模式，当您的应用程序运行时，它会进入区域并引用新类，因此加载的类的数量会越来越多。

但是，有两件事对我来说似乎很奇怪：

1.  为什么这么线性？
2.  为什么不平稳？

我预计它会呈上升趋势，但在一条不稳定的线中，然后随着 JVM 已经加载您的程序引用的大部分类而逐渐减少。我的意思是，在大多数应用程序中引用的类数量是有限的。

您是否以某种方式动态创建新类？

我建议通过相同的调试器运行一个更简单的测试应用程序以获得基线案例。然后你可以考虑实现你自己的 ClassLoader 吐出一些调试信息，或者也许有一个工具可以让它报告。

您需要弄清楚这些正在加载的类是什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T16:36:33.073

是的，这通常是内存泄漏（因为我们并没有真正直接处理内存，它更像是类实例泄漏）。我之前已经经历过这个过程，通常它是一些添加到旧工具包中的侦听器，它不会自行删除。

在旧代码中，侦听器关系会导致“侦听器”对象保留。我会查看较旧的工具包或未经过多次修订的工具包。在更高版本的 JDK 上运行的任何长期存在的库都会知道引用对象，这消除了对“删除侦听器”的要求。

此外，如果您每次都重新创建它们，请在 Windows 上调用 dispose。如果您不这样做，我认为它们永远不会消失（实际上也有关闭设置的处置）。

不要担心 Swing 或 JDK 侦听器，它们都应该使用引用，所以你应该没问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T15:24:58.023

使用[Eclipse Memory Analyzer](http://www.eclipse.org/mat/)检查重复的类和内存泄漏。同一个类可能会被多次加载。

问候， [马库斯](http://kohlerm.blogspot.com/)

# c++ - 实现 C++ Win32 启动画面的最快方法

> ID：167743
> 
> 赞同：9
> 
> 时间：2008-10-03T16:27:13.343
> 
> 标签：c++, winapi

什么是实现 C++ Win32 程序的简单方法...
- 显示 800x600x24 未压缩位图图像
- 在没有边框的窗口中（唯一可见的是图像）
- 十秒后关闭
- 并且不使用 MFC

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-06T14:46:39.817

如果您的目标是现代版本的 Windows (Windows 2000) 及更高版本，您可以使用[UpdateLayeredWindow](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-updatelayeredwindow)函数来显示任何位图（包括带有 alpha 通道的位图，如果需要的话）。

我[写了一个由四部分组成的系列博客](https://faithlife.codes/blog/2008/09/displaying_a_splash_screen_with_c_introduction/)，介绍如何编写一个 C++ Win32 应用程序来做到这一点。如果您需要等待正好十秒钟来关闭启动屏幕（而不是等到主窗口准备好），您需要使用 Dan Cristoloveanu 建议的调用 DestroyWindow 的计时器技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T17:12:46.027

为启动窗口注册一个类并使用这些样式创建一个窗口：

*   WS `_`POPUPWINDOW：将确保您的窗口没有标题/系统菜单
*   WS `_`EX `_`TOPMOST：将启动画面置于一切之上。请注意，这有点侵入性。将启动窗口作为主窗口的子窗口可能会更好。但是，您可能必须操纵 z 顺序，以将任何其他弹出窗口（如果您创建）保留在启动屏幕下方。

使用 CreateDIBSection 加载位图。这应该很容易，因为 BMP 文件本质上是 DIB 结构的转储。或者按照 Ken 所说的使用 LoadImage。

处理 WM `_`PAINT 或 WM `_`ERASEBKGND 消息以在窗口上绘制位图。

在 WM `_`CREATE 上设置一个 10 秒的计时器，当 Windows 发送 WM `_`TIMER 消息时，让窗口自行销毁。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T17:57:28.527

这里的关键是使用[分层窗口](http://msdn.microsoft.com/en-us/library/ms632599(VS.85).aspx#layered)。

您可以从 win32 向导生成的项目开始，将 CreateWindow 调用更改为[CreateWindowEx](http://msdn.microsoft.com/en-us/library/ms632680.aspx)，并将 WS_EX_LAYERED 设置为扩展窗口样式，并将 WS_POPUP 和 WS_SYSMENU 的组合设置为窗口样式。当你这样做启动你的应用程序时，它将是不可见的。然后你应该使用[UpdateLayeredWindow](http://msdn.microsoft.com/en-us/library/ms633556(VS.85).aspx)来绘制你的图像。如果您想使用带有 Alpha 层的 PNG 图像，您可能还需要[AlphaBlend功能。](http://msdn.microsoft.com/en-us/library/ms532324(VS.85).aspx)

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T17:08:41.887

*   使用 LoadImage 加载位图
*   使用 CreateWindowEx 创建窗口。
*   在窗口 proc 中捕获 WM_PAINT。使用 BitBlt 绘制位图。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-04T19:42:47.923

你可以：

*   在资源文件中创建一个对话框
*   让它包含一个图片控件
*   设置图片控件类型为Bitmap
*   在资源文件中创建/导入您的位图，并将该位图 ID 设置为对话框中的图片控件
*   使用 CreateDialogParam 创建窗口
*   处理 WM_INITDIALOG 以设置 10 秒的计时器（使用 SetTimer）
*   处理 WM_TIMER 以捕获您的计时器事件并销毁窗口（使用 DestroyWindow）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-04T11:55:34.780

这是一个 Win32 api 常见问题解答

看专业的Win32api论坛新闻：//194.177.96.26/comp.os.ms-windows.programmer.win32 20年来已经被回答了数百次。

# java - Spring：根据MessageSource获取ResourceBundle

> ID：167745
> 
> 赞同：1
> 
> 时间：2008-10-03T16:27:41.330
> 
> 标签：java, hibernate, validation, spring

我正在使用带有 Spring 的休眠验证器框架。实现 Spring Validator 的类使用 Hibernate 的 ClassValidator 验证对象。要本地化 ClassValidator 的错误消息，我需要将 ResourceBundle 传递给类的构造函数。我的 ApplicationCountext 有一个 MessageSource bean (ReloadableResourceBundleMessageSource)，它通过应用程序使用。对 ClassValidator 使用相同的 MessafeSource 是有意义的。但是如何将 MessageSource 转换为 ResourceBundle？有没有适配器类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-04T12:44:04.790

[MessageSourceResourceBundle](http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/context/support/MessageSourceResourceBundle.html)听起来像您正在寻找的东西。（我自己没试过。）

# c# - 在哪里可以找到使用 ADO.NET 的开源 C# 项目？

> ID：167746
> 
> 赞同：1
> 
> 时间：2008-10-03T16:27:44.857
> 
> 标签：c#, database, open-source, ado.net

我正在尝试为我拥有的一个非常小的数据库概念编写一个 Windows 窗体和 ASP.NET C# 前端和 MSAccess 后端。

我之前曾在 MSAccess 中编写过此应用程序，但现在我需要将应用程序和数据库放在不同的位置。我现在发现（感谢 StackOverflow 用户）ADO 将是一个糟糕的选择，因为它必须始终打开一个连接。

我购买了 Microsoft ADO.Net 2.0 Step-by-Step 并且我已经阅读了其中的一些内容并理解（我认为）ADO.NET 中的基本概念。（数据集等）

我感到困惑的是实际的实现。我想知道的是你们中的任何人都知道一个 C# 项目，它有一个开源的数据库后端，我可以去看看代码，看看他们是如何做到的。我发现我这样学得更好。这本书有一张包含代码示例的 CD，我可能会参考，但我更愿意在真实的应用程序中看到真实的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-03T16:34:21.783

看看 MySQL .net 连接器。这是 ADO.net 类如何与 DB 引擎对话的具体细节。ADO.net 作为一个整体不会保持连接打开。某些更高级别的课程可以。从技术上讲，连接和命令对象等较低级别的对象是 ADO.net 的一部分，但您可以高度控制它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T16:36:39.690

我没有用过这个，但看起来它可能很合适：

[http://www.codeproject.com/KB/database/DBaseFactGenerics.aspx](http://www.codeproject.com/KB/database/DBaseFactGenerics.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T16:38:29.153

检查 CodePlex，他们有大量的 .NET 项目。我想不出适合您要求的具体内容，但您应该能够找到一些东西。

www.codeplex.com

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T17:39:02.997

我通过在 codeproject 上搜索 ADO.NET 找到了这篇文章[http://www.codeproject.com/KB/database/DatabaseAcessWithAdoNet1.aspx](http://www.codeproject.com/KB/database/DatabaseAcessWithAdoNet1.aspx)，所以我要给 Chris Porter 答案。感谢大家的帮助。

# javascript - 如何使用 Javascript 或 jQuery 库显示打字速度？

> ID：167752
> 
> 赞同：7
> 
> 时间：2008-10-03T16:29:03.200
> 
> 标签：javascript

我想在我们联系表格上使用的文本区域下方添加一个打字速度指示器。这只是为了好玩，并在用户填写表单时为他们提供与页面的一些交互性。

它应该在打字时显示平均速度，并在击键空闲时保持最后的平均速度。当他们离开文本区域时，最后一个平均值应该坚持。

理想情况下，如果可用，我想拥有一个 jQuery 插件。

[编辑] 这最初只适用于我的几个网站。但是在我发布了这个问题之后，这让我很震惊，这对于 SO 来说是一个很好的功能。如果你同意[在这里投票](http://stackoverflow.uservoice.com/pages/general/suggestions/32755)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-03T17:09:37.097

这是一个经过测试的实现，看起来不错，但我不保证数学。

一个演示：http: [//jsfiddle.net/iaezzy/pLpx5oLf/](http://jsfiddle.net/iaezzy/pLpx5oLf/)

和代码：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Type Speed</title>
        <script type="text/javascript" src="js/jquery-1.2.6.js"></script>
        <style type="text/css">
            form {
                margin: 20px auto;
                width: 500px;
            }

            #textariffic {
                width: 400px;
                height: 400px;
                font-size: 12px;
                font-family: monospace;
                line-height: 15px;
            }
        </style>
        <script type="text/javascript">
            $(function() {
                $('textarea')
                    .keyup(checkSpeed);
            });

            var iLastTime = 0;
            var iTime = 0;
            var iTotal = 0;
            var iKeys = 0;

            function checkSpeed() {
                iTime = new Date().getTime();

                if (iLastTime != 0) {
                    iKeys++;
                    iTotal += iTime - iLastTime;
                    iWords = $('textarea').val().split(/\s/).length;
                    $('#CPM').html(Math.round(iKeys / iTotal * 6000, 2));
                    $('#WPM').html(Math.round(iWords / iTotal * 6000, 2));
                }

                iLastTime = iTime;
            }

        </script>
    </head>
    <body>
        <form id="tipper">
            <textarea id="textariffic"></textarea>
            <p>
                <span class="label">CPM</span>
                <span id="CPM">0</span>
            </p>
            <p>
                <span class="label">WPM</span>
                <span id="WPM">0</span>
            </p>
        </form>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-07T09:37:39.310

这是我自己的自我参与：

```
<textarea id="b" onblur="clc();"></textarea>
<script>
t=0;
document.getElementById('b').onkeypress=function()
{
t==0 ? s=new Date() : e=new Date();
t=1;
}
function clc()
{
d = e.getTime() - s.getTime();
c = b.value.length;
b.value += "\n"+c+"s in "+d+"ms: "+c/d+" cpms";
}
</script> 
```

我花了一个多星期的时间从零开始学习 JavaScript（切割和切割）。这将是一个很好的起点。它现在如此简单，需要简单的解释。你可以添加任何东西。它是最著名的极简主义和最纯粹的形式。

它只是让你进入一个文本区域： ![在此处输入图像描述](https://i.stack.imgur.com/Wi2yj.jpg)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T16:41:37.167

打字速度通常以每分钟的字数减去错别字的惩罚来计算。要做到这一点，您至少需要一个内联拼写检查器，再加上一些繁重的语言和编码方案。（然后它开始变得复杂；例如，时钟什么时候开始？你对正在输入代码的人怎么办？复制和粘贴呢？）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-03T16:48:02.787

一个非常简单，**未经测试**的实现：

```
var lastrun = new Date();
textarea.onkeyup = function() {
    var words = textarea.value.split(' ');
    var minutes_since_last_check = somefunctiontogetminutesdifference(new Date(), lastrun);
    var wpm = (words.length-1)/minutes_since_last_check;
    //show the wpm in a div or something
}; 
```

# c# - 隐藏函数

> ID：167760
> 
> 赞同：2
> 
> 时间：2008-10-03T16:30:27.283
> 
> 标签：c#, visual-studio, intellisense

我有一堂课，里面有复杂的科学计算。它设置为仅允许用户创建正确实例化的案例。然而，为了正确测试代码，需要直接设置内部状态变量，因为参考文档在其测试用例中提供了这些数据。但是，如果操作不当，可能会使状态无效。

所以我必须有能力，一个成员函数，从单元测试程序中设置内部变量。但我想**强烈劝阻**普通用户不要调用这个函数。（是的，一个坚定的用户可以做任何事情......但我不想*宣传*有办法*做错*事。）

例如，如果能够告诉 Intellisense 不显示该功能，那就太好了。

我目前最好的解决方案是将函数命名为：DangerousSet()。

我还有什么其他选择？

**跟进**

我发现 Amy B 的回答对我的情况最有用。谢谢！
Mufasa 使用反射的建议很棒，但更难实施（对我来说）。
克里斯关于使用装饰器的建议很好，但没有成功。
BFree关于XML的建议也不错，已经在使用，但并没有真正解决问题。

最后，BillTheLizard 提出的问题出在源文档中的建议不是我能控制的。国际专家出版技术含量高的书籍和期刊文章，供其社区使用。他们没有解决我的特殊需求这一事实是生活中的事实。根本没有替代文件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-03T16:31:34.130

您可以使用[InternalsVisibleToAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)将内部成员标记为对您的测试程序集可见。在这种情况下使用它似乎会发光，尽管它不是“朋友”。

1.  标记您的`DangerousSet`函数`internal`而不是`public`.

2.  在项目的 Properties\AssemblyInfo.cs 中包含`DangerousSet`：

    `[assembly:InternalsVisibleTo("YourTestAssembly")]`

如果出于某种原因有两个测试程序集，则语法为：

```
[assembly:InternalsVisibleTo("TestAssembly1"), 
    InternalsVisibleTo("TestAssembly2")] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T16:33:03.317

用这个属性装饰你的方法：

```
[System.ComponentModel.EditorBrowsable(System.ComponentModel.EditorBrowsableState.Never)] 
```

这将从 Intellisense 隐藏它。

**编辑：**

但显然这有一个相当重要的警告：“在 Visual C# 中，`EditorBrowsableAttribute`不会禁止来自同一程序集中的类的成员。” [通过 MSDN](http://msdn.microsoft.com/en-us/library/system.componentmodel.editorbrowsableattribute.aspx)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-03T17:54:05.523

假设您想通过操作它的字段来测试这个对象。

```
public class ComplexCalculation
{
    protected int favoriteNumber;
    public int FavoriteNumber
    {
        get { return favoriteNumber; }
    }
} 
```

将此对象放在您的测试程序集/命名空间中：

```
public class ComplexCalculationTest : ComplexCalculation
{
    public void SetFavoriteNumber(int newFavoriteNumber)
    {
        this.favoriteNumber = newFavoriteNumber;
    }
} 
```

并编写您的测试：

```
 public void Test()
    {
        ComplexCalculationTest myTestObject = new ComplexCalculationTest();
        myTestObject.SetFavoriteNumber(3);
        ComplexCalculation myObject = myTestObject;

        if (myObject.FavoriteNumber == 3)
            Console.WriteLine("Win!");

    } 
```

PS：我知道你说的是*internal*，但我不认为你的意思是[internal](http://msdn.microsoft.com/en-us/library/7c5ka91b(VS.80).aspx)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-03T16:36:54.913

听起来您真正的问题出在您的参考文档中。你不应该测试在正确使用你的类的情况下不可能遇到的用例。如果不应该允许用户更改这些变量的状态，那么您的测试也不应该。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T17:53:32.077

您也可以使用反射。谷歌搜索出现了[使用反射的单元测试私有方法](http://sjbdeveloper.blogspot.com/2005/02/unit-testing-private-methods-using.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T16:32:50.070

您的测试代码可以包含计算类的子类吗？如果是这样，您可以标记该函数`protected`，并且只有继承者才能使用它。我很确定这也使它脱离了智能感知，但我可能是错的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T16:42:26.743

我过去所做的是将 XML Comments 放在方法中，并使用该部分以大粗体字母书写。不要使用此方法或其他方法。这样，如果有人试图使用它，Intellisense 会给他们一个很好的警告。

# css - 如何用 CSS 实现照片“堆叠”边框效果？

> ID：167761
> 
> 赞同：3
> 
> 时间：2008-10-03T16:30:40.560
> 
> 标签：css

我希望能够为图像添加一个类，该类添加一个边框，使它们看起来像一堆照片。有人知道怎么做吗？

说明：理想情况下，类似于[此处](http://designreviver.com/tutorials/create-an-interactive-stack-of-photos/)显示的堆栈，但它不需要是交互式的，只需要为单张照片工作。如果需要，我也不介意使用 javascript（不过最好使用 jQuery）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T16:37:59.203

将您的 IMG 标签放在一组嵌套的 DIV 元素中（div 的数量将决定堆栈中的照片数量）。然后使用 CSS 设置边框和填充，以便 DIV 元素逐渐大于照片。通常，您会在底部和右侧添加更多填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T16:38:36.487

“深度”影响可能是某种类型的 [阴影](http://www.webtoolkit.info/css-drop-shadow.html)。您是否还需要旋转照片以获得“凌乱的照片堆”效果，或者您是否正在寻找“整齐堆叠”的外观？

“凌乱的照片堆”效果在我看来可以分解为三个部分：

1.  为“宝丽来”外观在图像后面放置背景（在其他评论中解释）
2.  在图像后面放置阴影以获得“深度”效果（在上面和其他评论中解释）
3.  旋转图像。我自己从未这样做过，但看起来有人编写了您正在寻找的[Jquery 插件。](http://code.google.com/p/jquery-rotate/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T16:39:50.633

CSS3 现在每个人都支持它，但你可能想看看[border-image](http://www.css3.info/preview/border-image/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T16:41:34.500

在图像周围放置一个 div，然后定义 2 种样式。

```
<div class="img-shadow"><img ...></div>

.img-shadow {style.css (line 456)
background-color:#505050;
float:left;
margin:5px 0 0 0;
}
.img-shadow img {style.css (line 461)
background-color:#FFFFFF;
border:3px solid #000000;
display:block;
margin:-8px 8px 8px -8px;
padding:10px;
position:relative;
} 
```

在 .img-shadow 类中，为您的背景定义一个图形，该图形对于您的图像来说足够大，并且看起来像一堆照片。以上使照片看起来像是在投射阴影。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-19T04:20:38.340

下面是我的推荐，它有一个清晰简单的 CSS，可以生成完美的照片堆栈。

[http://dabblet.com/gist/2023431](http://dabblet.com/gist/2023431)

# html - 允许用户拖放表格行以更改其顺序的最简单方法是什么？

> ID：167772
> 
> 赞同：12
> 
> 时间：2008-10-03T16:33:13.487
> 
> 标签：html, ruby-on-rails, ajax

我有一个我正在编写的 Ruby on Rails 应用程序，用户可以选择编辑发票。他们需要能够重新分配行的顺序。现在我在数据库中有一个索引列，用作默认排序机制。我只是公开了它并允许用户对其进行编辑。

这不是很优雅。我希望用户能够拖放表格行。我使用过一些 Scriptaculous 和 Prototype 并且对它们很熟悉。我已经完成了拖放列表，但还没有像这样完成表格行。有人对不仅重新排序而且有效地捕获重新排序有任何建议吗？

此外，用户现在可以在 JS 中动态创建一个新行，因此该行也必须是可重新排序的。

如果可以使用 RJS 而不是直接 JavaScript 来完成，则可以加分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T16:36:35.010

我以前使用 Yahoo 用户界面库来执行此操作：

[http://developer.yahoo.com/yui/dragdrop/](http://developer.yahoo.com/yui/dragdrop/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T17:10:11.197

[MooTools](http://mootools.net/) sortables 实际上比[script.aculo.us](http://script.aculo.us/)更好，因为它们是动态的；MooTools 允许向列表中添加/删除项目。将新项目添加到 script.aculo.us 可排序时，您必须销毁/重新创建可排序以使新项目可排序。如果列表有很多元素，这样做会产生很多开销。由于这个限制，我不得不从 script.aculo.us 切换到更轻量级的 MooTools，并最终对这个决定非常满意。

MooTools 使新添加的项目可排序的方法是：

```
sortables.addItems(node); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T17:30:44.150

好的，我做了更多的搜索，发现了一些似乎主要工作的东西。

编辑.html.erb：

```
...
<table id="invoices">
   <thead>
     <tr>
      <th>Id</th>
      <th>Description</th>
     </tr>
   </thead>
   <tbody id="line_items">
      <%= render :partial => 'invoice_line_item', :collection => @invoice.invoice_line_items.sort %>
   </tbody>
</table>

<%= sortable_element('line_items', {:url => {:action => :update_index}, :tag => :tr, :constraint => :vertical}) -%>
... 
```

应用程序/控制器/发票.rb

```
...
def update_index
  params["line_items"].each_with_index do |id, index|
    InvoiceLineItem.update(id, :index => index)
  end
  render :nothing => true
end
... 
```

重要的部分是 "sortable_element" 和 params["line_items"] 中的 :tag => :tr -- 这给出了新的 id 列表并在放置时触发。

缺点：使 AJAX 调用下降，我想我更喜欢存储订单并在用户点击“保存”时更新。在 IE 上未经测试。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-08T23:18:39.500

我喜欢 jQuery [http://docs.jquery.com/UI/Sortables](http://docs.jquery.com/UI/Sortables)

$("#myList").sortable({});

您将需要编写一些代码来持久化它，但这并不难。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T16:47:16.297

雅虎的界面比我想象的要简单，不到四个小时就完成了一些时髦的工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T16:43:06.167

Scriptaculous sortables 似乎是要走的路，因为它是内置的。 [http://github.com/madrobby/scriptaculous/wikis/sortable](http://github.com/madrobby/scriptaculous/wikis/sortable)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-31T06:54:47.013

`Prototype`和`Scriptaculous`：_

```
Sortable.create('yourTable', {
    tag: 'tr',
    handles: $$('a.move'),
    onUpdate: function() {
        console.log('onUpdate');
    }
}); 
```

# windows - 使用单个鼠标和键盘控制多台 PC

> ID：167791
> 
> 赞同：16
> 
> 时间：2008-10-03T16:38:51.977
> 
> 标签：windows, keyboard, mouse, desktop

作为一名程序员，我发现很难将我的笔记本电脑和工作站与两种不同的输入设备一起使用，任何人都可以提出一个好的解决方案来使用单个鼠标和键盘来控制我的两台机器

我不是在寻找虚拟机或 RDP 解决方案来在单个监视器中查看我的机器，

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-03T16:39:48.513

[协同作用。](http://synergy-foss.org/)

> *Synergy 让您可以轻松地在具有不同操作系统的多台计算机之间共享单个鼠标和键盘，每台计算机都有自己的显示器，无需特殊硬件。它适用于桌面上有多台计算机的用户，因为每个系统都使用自己的监视器。重定向鼠标和键盘就像将鼠标移出屏幕边缘一样简单。Synergy 还将所有系统的剪贴板合并为一个，允许在系统之间进行剪切和粘贴。此外，它会同步屏幕保护程序，使它们一起启动和停止，如果启用屏幕锁定，只需一个屏幕需要密码即可将它们全部解锁。*

附言

另请参阅[如何修复 Vista 上的 Synergy 问题](http://www.howtogeek.com/howto/windows-vista/fixing-problems-with-synergy-on-windows-vista/)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-03T16:44:33.947

你想要的是一个叫做[KVM 切换器](http://en.wikipedia.org/wiki/KVM_switch)（键盘、视频和鼠标切换器）的小工具。用谷歌搜索这个词会让你找到很多供应商。

还有一个名为[Synergy](http://synergy2.sourceforge.net/)的简洁软件解决方案，可让您在通过网络连接的多台计算机上使用光标和键盘输入。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-03T17:32:23.540

又一次投票支持 Synergy 的软件 KVM 解决方案。我不确定其他人，但如果您的计算机运行不同的操作系统，这是独一无二的。当我在 3 台计算机上安装 W2k/Linux 时，它运行得非常好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T16:43:39.923

Synergy 很棒，但也可以尝试一下 VNC：它不仅整合了键盘和鼠标，还整合了屏幕。就我而言，我的台式机显示器比我的笔记本电脑大得多，而且无论如何我都更舒服地面向前方（不要看向笔记本电脑所在的一侧。）

与使用 KVM 切换器相比有延迟，但视频质量没有损失。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-03T17:08:40.543

根据我的经验，Synergy 是合并多个显示器的最佳方式。

其他包括： - x2vnc - x2x - win2vnc - osx2x - win2x

... 几乎只需选择您所在的操作系统/平台，您要连接到哪个操作系统/平台，然后在中间放一个“2”。把它输入谷歌，你就很好了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-03T17:36:13.157

对于我的 linux 机器，我使用[QuickSynergy](http://quicksynergy.sourceforge.net/)，因为它提供了一个 gui 以便于配置。它也有一个 Mac OS 版本。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T16:40:23.363

最好的...

[协同作用](http://synergy2.sourceforge.net/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-03T17:26:01.070

我将再次投票支持 Synergy，但需要注意的是 - 设置可能有点棘手。第一次尝试时，我可以将光标移到另一台 PC 上，但无法将其移回。在继续之前花一些时间阅读[文档。](http://synergy2.sourceforge.net/running.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-25T05:27:21.560

**[InputDirector](http://www.inputdirector.com/)**比 Synergy 好。这就是为什么...

1.  它具有**内置的 AES 加密**功能（无需您安装 OpenSSH），用于在机器之间安全传输输入。
2.  它允许在机器之间剪切和粘贴文本**和文件**（通过自动转换为 C$ 和 D$ 共享）
3.  基于与笔记本电脑的广泛使用，在断开和对接后重新连接时，它比 Synergy更加**可靠和稳定。**Synergy 经常会在对接和脱离对接后停止工作，需要我将其杀死、重新启动并重新连接。InputDirector 很少有任何问题。
4.  配置 UI比 Synergy**更易于使用**，并且具有**更多选项。**
5.  很多小事情，比如在屏幕边缘转换期间机器之间的光标位置匹配，以及覆盖“从”机器的鼠标设置与“主”机器的鼠标设置。

除此之外，据我所知，它完成了 Synergy 所做的一切。只有一个 Windows 版本，但显然它也兼容 Vista。

我已经广泛使用了这两种工具，首先是 Synergy，然后是 InputDirector。InputDirector 只是一个更强大的应用程序。它具有 Synergy 的所有功能，还有一些功能，以及上面列出的关键功能。它的网站没有那么吸引人，虽然它不像 Synergy 那样是 GNU GPL 的，但它仍然是免费的，并且是一个功能非常出色的工具。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-03T16:41:33.970

我曾经使用 KVM 切换器，但最近我开始在单个硬件平台上将所有计算机作为虚拟机运行。每个“系统”都是我桌面上的一个窗口！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-03T16:45:29.000

我有一个三重显示器，我只是将桌面远程连接到我的其他机器上。在任何给定时间，我的办公桌上都有 2-3 台笔记本电脑，还有 3 台服务器要管理。通过 1 gbps 的连接，我几乎不需要担心延迟，而且我可以同时在三台计算机上工作而不会遇到太多麻烦。这可能会或可能不会帮助你，但我想我会把它扔给你。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-03T16:45:48.657

如果你的意思是：桌面上有两台机器，很多地方都使用 KVM 风格的交换机。

它们采用传统的 PC 风格和 USB。USB 版本适用于 Mac 和 PC。

我的经验是，小型桌面开关很划算，如果你学会了键盘快捷键，你会来回跳动，没有太大问题。

机房、3 级树形 KVM 也很实用。它们更频繁地脱落，但是当您有 60 台机器时，您根本无法在输入设备上使用 60 对。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-03T17:13:35.417

我将第二次 Zarkonnens 关于[KVM 切换](http://en.wikipedia.org/wiki/Kvm_switch)器的评论，因为我一直为此目的使用一个。但是，我可能会与他们分享一些相当令人沮丧的经历：

我发现 PS/2 接口在 KVM 切换器上往往比 USB 更可靠——我在[Gefen](http://www.gefen.com/kvm/dproduct.jsp?prod_id=3113)和[Avocent](http://www.avocent.com/SwitchView_DVI_4-port.aspx)的一些所谓的高档 DVI-USB KVM 套件上遇到了非常糟糕的经历。由于我的[Viewsonic](http://www.viewsonic.com/products/desktopdisplays/lcddisplays/proseries/vp2030b/)显示器的一个怪癖，在大多数情况下它会回到模拟状态，这些情况会加剧到系统几乎无法使用的程度。

DVI和USB很挑剔。如果没有信号，DVI 显示器通常会超时并休眠。如果 KVM 切换器未处于活动状态，它将假定没有监视器，然后将其传递回视频卡。USB 接口也会随机进入睡眠状态。

这样做的最终结果是很难让两台机器启动并在 KVM 切换器上工作，并且每隔几天切换器就会失去一台或两台机器上的键盘或鼠标输入。接下来是一个小时或更长时间，试图让所有硬件都能正常运行。我在几台不同的机器上使用 Avocent 和 Gefen 开关时遇到了同样的问题。

我的旧版[Belkin VGA/PS2 套件](http://catalog.belkin.com/IWCatSectionView.process?Section_Id=206977)在 VGA 上的 Viewsonic 显示器上运行良好，但我花了将近 1000 英镑购买开关和布线，以尝试获得一个正常工作的 DVI-USB KVM 设置。

最后，我得到了两块[HP LP2065](http://h10010.www1.hp.com/wwpc/uk/en/sm/WF05a/382087-382087-64283-444767-444767-1815933.html)屏幕，它们没有 Viewsonics 展示的错误。它们有两个 DVI 输入，我使用我的旧 Belkin PS/2 开关之一来切换键盘和鼠标。计算机直接插入显示器，显示器的输入选择器用于选择计算机。KVM 切换器关闭键盘和鼠标。这是我今天使用的设置。

显示器和 KVM 必须单独切换，但它比根本不工作的 DVI-USB KVM 切换器可靠得多。买者自负。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-03T19:03:00.487

您还应该查看 Stardock 的[Multiplicity](http://www.stardock.com/products/multiplicity/)。

# asp.net - AJAX、回发和浏览器刷新

> ID：167808
> 
> 赞同：3
> 
> 时间：2008-10-03T16:43:20.300
> 
> 标签：asp.net, ajax

我创建了一个用户控件来处理向某些业务实体（如联系人和客户）添加评论。效果很好......除了一个问题。

我正在使用一个 ListView 控件来编辑和删除评论，并在一个单独的区域中，在同一个用户控件上添加新评论。所有这些都包含在一个 UpdatePanel 中。

![截屏](https://farm4.static.flickr.com/3239/2909377399_888d42b595.jpg?v=0)

这是我的场景……用户添加了一条新评论……页面进行了回发，成功保存了数据，并且更新了 ListView 控件以显示新评论。现在，如果用户**刷新**浏览器，它自然会再次回发并添加另一条重复记录。

关于如何最好地防止这种情况的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T16:52:43.353

您可以尝试使用[Post/Redirect/Get](http://www.theserverside.com/patterns/thread.tss?thread_id=20936)模式。基本上不是让回发发送数据，而是重定向到页面。这样，如果用户刷新，他/她正在刷新 GET 命令而不是 POST。

* * *

抱歉.. 错过了 UpdatePanel 部分。确保您的提交按钮也在该更新面板中。页面刷新不会影响您的 AJAX 调用，但当按钮位于面板外时，它会定期回发，因此您将再次发送添加请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T16:48:47.480

几年来我没有使用过 ASP.NET，但您应该将“在回发时执行此操作”代码包装在 `Page.IsPostBack`：

```
if(IsPostBack) {
    //do your data-saving code...
} 
```

[MSDN 链接](http://msdn.microsoft.com/en-us/library/system.web.ui.page.ispostback(VS.71).aspx)

# java - Mac 上的 Java 开发 - Xcode、Eclipse 或 Netbeans

> ID：167812
> 
> 赞同：23
> 
> 时间：2008-10-03T16:43:54.307
> 
> 标签：java, eclipse, xcode, macos, netbeans

我一直在使用 Xcode 进行通常的 C/C++/ObjC 开发。我想知道在 Mac 上用于 Java 开发的 Xcode、Eclipse 或 NetBeans 的实际考虑和意见是什么？

请不要在您的分析中包含我当前对 Xcode 的使用。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-05T18:43:32.693

你错过了所有 IDE 的劳斯莱斯。[IntelliJ 理念](http://www.jetbrains.com/idea/)。

如果您有能力购买个人许可证，那就去买吧。编辑：有一个免费的社区版，它是开始使用 Java、Scala 或 Kotlin 的绝佳方式。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-10-03T17:11:50.337

我喜欢OS X for Java 上的[NetBeans 。](http://netbeans.org/)

似乎我花了更多时间配置 eclipse 以获得一个像样的 java 编程环境。使用 NetBeans，设置时间更短，我可以更快地开始编程......

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-10-03T16:57:10.413

我会提倡在 Mac 上使用[Eclipse](http://www.eclipse.org/downloads/) for Java，主要是因为我有很好的体验。我不会大肆谈论它作为 IDE 的优点，但这里有一些我发现的意想不到的优势：

1.  当我的雇主将 IDE 切换到 Eclipse 时，我遥遥领先。
2.  几乎所有我想尝试的语言都有一个免费的 IDE 作为 Eclipse 插件，所以我有一个非常一致的多语言开发环境。
3.  当我最终转向 Windows 的黑暗面时，我可以使用相同的开发环境，这让我松了一口气。

但这有点宗教话题，所以期待得到一大堆不同的意见

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-10-03T18:30:35.933

只是为了确保您给予他们公平的考虑，Eclipse 和 Netbeans 已经来回折腾了一段时间。Eclipse 过去要快很多，因为他们不使用 Swing。

现在 Netbeans 已经赶上（或许已经超越）并且势头强劲。

您将获得更多 Eclipse 的选票。时期。这是因为它更好，更多的人使用它——感觉你使用的东西是最好的，每个人都应该使用它，这只是人类的天性。

因为它更好并不意味着它现在更好。Netbeans 支持更多的语言和更全面的支持——因此它的增长速度更快。

目前我使用 Eclipse——我都使用过（以及 IntelliJ 和 TextMate 和记事本......），我可以告诉你 Eclipse 与 netbeans 相比只有一个功能...... Mylyn（它已被重命名，它曾经被称为 Mylar ）。这东西很酷，但似乎很少有人知道它的存在。

因此，如果您不知道已经将您与编辑器联系在一起的一堆击键，那么即将出现的是 Netbeans——不要因为一堆 Eclipse 投票而放弃它。

更好的是，两者都要好——当一家公司需要一个或另一个时，它不会伤害我，让我更舒服。当他们让你改变时，不要抱怨。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-03T16:47:02.040

不要使用 Xcode - 后期版本非常缺乏对 Java 的支持。甚至制造它的 Apple 也建议您使用不同的 IDE。至于 NetBeans 和 Eclipse，它们各有长处，也有大量的拥趸。我建议您尝试两者并使用您觉得更舒适的任何一个。

我一方面使用[TextMate](http://macromates.com/)和 shell 脚本。但我很奇怪。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-03T16:52:10.033

好吧，我可以加入 Netbeans，它似乎工作得很好。有一些功能键问题我认为有解决方案，但我还没有解决。我对 Netbeans 非常满意。我喜欢它的“开箱即用”特性，而不是 Eclipse 的选择插件特性，但这只是个人喜好问题。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-05T23:31:14.220

再次投票给 IntelliJ。[http://www.jetbrains.com/idea/](http://www.jetbrains.com/idea/)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-07-16T04:04:27.660

我同时使用了 Eclipse 和 Netbeans。比起 Eclipse，我更喜欢 Netbeans。从 java 编辑器的角度来看，两者都具有出色的上下文相关帮助和通常的好处。在设置其他团队成员可以打开和使用的项目时，Eclipse 很糟糕。我们有一个大项目（大约 60 万行代码），组织在许多文件夹中。Eclipse 不允许您包含项目根文件夹之外的源代码。一切都必须在项目根文件夹下。通常您希望拥有单独的项目并能够在它们之间建立依赖关系。构建完成后，您会将它们签入源代码管理。eclipse 的问题是项目（即.classpath 文件）依赖项保存在用户的工作区文件夹中。如果你想看看这个文件夹，你会发现很多文件读起来像 org.eclipse.* 等。这意味着您不能将这些文件放在源代码管理中。我们有 20 个步骤的说明表供某人在每次从源代码管理开始新结帐时阅读。我们最终没有使用它的默认项目管理东西（即类路径文件等）。相反，我们提出了一个 Ant 构建文件并从 Eclipse 内部启动它。那是笨拙的方式。如果你必须跳过这么多圈，IDE 基本上就失败了。我敢打赌 Eclipse 项目管理是由从未使用过 IDE 的人设计的。许多 IDES 允许您使用不同的配置来运行代码（发布、调试、使用 JDK 1.5 发布等）。他们让您将这些内容保存为项目文件的一部分。团队中的每个人都可以使用它们而无需大的学习曲线。您可以在 Eclip 中创建配置，但您可以 t 将它们保存为您的项目文件的一部分（即它不会进入您的源代码管理）。我在 6 个月的时间里完成了六次新的结账工作。我厌倦了在每次新结账时重新创建它们。

另一方面，Netbeans 按预期工作。它没有这个项目管理的噩梦。

我听说过有关 IntelliJ 的好消息。如果您刚开始，请使用 Netbeans。

我的 2 美分。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-03T17:25:47.843

这取决于你想做什么。到目前为止，我在 Mac 上使用 Java 的经验已经有一年左右了，但是 NetBeans 对 Tomcat（尤其是）部署提供了更好的开箱即用支持，而且通常看起来对用户更友好一些。例如，与 Eclipse 的普通 XML 编辑器（至少在 Europa 中，XML 编辑器的行重绘在 Mac 上有点粗略）相比，我尝试了用于 web.xml 配置的 Netbeans 测试版。

也就是说，对于那个项目，我最终在 NetBeans 中进行了一些配置（因为 a 是 n00b），然后将 XML 配置文件移至 Eclipse，并在那里开发其余部分。正如其他人所提到的，无数的插件都很棒，而且总的来说体验非常一致。特别是如果您必须在另一个平台上工作。

如果 Eclipse 有更好的 OS X 绑定（它有吗？我不知道），我也会将它用于 Obj-C 开发。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-03T20:15:43.320

如果您使用的是 Eclipse，请务必使用 Ganymede (3.4) 或更高版本。他们跑得很好。以前的版本（Europa）在我的 Macbook Pro 上运行不佳。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-02-03T19:21:08.777

我已经对 Java 编辑器进行了广泛的测试，并且在很大程度上更喜欢 Netbeans 而不是 Eclipse。NetBeans 具有对 Java 的出色支持、非常漂亮的用户界面和强大的功能。它还对 C++ 有很好的支持，我会选择它而不是 Visual Studio。考虑一下 JCreator 经典版，虽然不如 NetBeans 强大，但一开始更容易上手，这是一个很好的起点。

我也会针对 Eclipse 为 NetBeans 插件辩护，因为尽管 Eclipse 因其插件所提供的灵活性而备受赞誉，但我认为这主要是因为 NetBeans 的同样强大的插件功能并没有受到太多人的关注，即使它在这方面也很强大。我见过基于NetBeans平台的计算流体动力学应用，非常令人印象深刻，我只是不认为NetBeans开发者对它有什么大不了的，因为它从你下载它的那一刻起就已经是一个完整的包，强大而无需任何配置带插件。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-03T18:58:04.583

我碰巧在我的 Mac 上使用 Eclipse（实际上是预配置了最重要插件的 EasyEclipse），我必须说它运行良好。不过，我在 Linux 上的体验不太积极。

我最近也使用过 NetBeans 6，印象非常深刻。它似乎内置了更多功能。大多数功能无疑也可以作为 Eclipse 插件使用，如果你能找到的话。

目前我的印象是，如果您开始开发 Swing，Netbeans 是您的最佳选择。否则，带有一组方便的插件的 Netbeans 或 Eclipse 都是极好的选择。

如果您确实查看了 eclipse，请考虑一下 EasyEclipse（免费）或者甚至是 MyEclipse（非免费）。它们预装了最有用的插件。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-03T17:01:16.533

我曾使用过 Eclipse CDT 和 NetBeans 的 C++ 支持，而且我必须说，根据我的经验，CDT 在稳定性和功能方面都远远优于它。CDT 索引器的工作效果确实令人印象深刻。该工具几乎和Java一样好。与用于 Java 开发的 NetBeans 相比，我也是 JDT 的忠实粉丝。如果只是由于增量编译器（保存时编译），工作流程就会更加顺畅。

不过，关于 NetBeans 的一件事是，它的 UI 在“Mac 风格”中确实流动得更好，这很讽刺，因为 SWT 是为了提供*更*原生的界面而创建的。Eclipse 的下一个版本应该基于 Cocoa（而不是当前的 Carbon），但这要到明年 6 月。

最后一点：整个“in box”与“plugins”问题完全没有实际意义，自 Eclipse Calisto（两年前）以来一直存在。现在，使用 P2（新的更新管理器），在 IDE 中获得不同的功能非常容易。我可以从下载开始，并在安装后五分钟内启动并运行一个功能齐全的 JDT/CDT/Mylyn 环境（假设互联网连接可靠）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-03T16:48:39.430

我会推荐 Eclipse，因为它有无数插件，几乎是 Java 开发的标准。但是我听说 NetBeans 自从最新版本以来真的很棒，特别是如果你想做桌面应用程序（Swing）。

我无法评论 Xcode，因为我没有玩过它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-01-15T19:52:13.057

我使用 Eclipse 进行开发，除了痛苦什么都没有。它的 bug 比诱饵店还多，是我用过的最糟糕的编写程序之一。如果您想节省时间和挫败感，请使用 Xcode。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-08-12T18:39:05.413

Eclipse，因为它在mac上对C++有更好的支持。我很久以前用过Netbeans，不喜欢它。

仅在必要时才在 mac 上使用基于 Java 的 IDE（尤其是在进行 Java 开发时）。Xcode 已经支持 C/C++ 开发，无需切换。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-08-01T17:01:53.653

根据我的经验，Eclipse 是一个非常大的 IDE。它需要更多的工作才能更好地适应 Mac 环境。Netbeans 是最好的开箱即用体验。安装后，基本上就可以使用了。在我尝试了 IntelliJ IDEA 之后，我忘记了所有其他类型的 IDE：P

但最终没有人能战胜对方。

恕我直言，像往常一样！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-05-16T14:47:58.173

我错过了这里的重点还是开发人员仍在考虑使用 Mac 进行 Java 开发？我是 Mac 作为开发环境的坚定支持者，但自从 Apple 决定不在更高版本的 os x 上移植 java 后，我的信心就动摇了一点。并且请不要考虑在 Mac 上进行任何 j2EE 部署，因为它会带来灾难的海啸。这么长的Java，但我太喜欢我的mac book pro了。仅供参考：我仍然使用 Mac 进行 Java 开发，但有时我希望我是一名 Python 开发人员 :(

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-08-04T08:12:36.973

根据我的经验，我使用 Eclipse 和 Intellij（许可证）进行 J2EE 开发。

就 IDE 的整体速度而言，Intellij 比 Eclipse 更快且崩溃更少。我首先使用 Eclipse，后来我习惯了 Intellij 并爱上了它。然而，谷歌的 Android Studio 是基于 Intellij 的。它更加现代化。调试要容易得多，尤其是您可以在调试模式下评估块代码以查看其行为方式，而不仅仅是检查对象。我强烈推荐！

# php - PHP 脚本压缩/“编译”工具

> ID：167816
> 
> 赞同：3
> 
> 时间：2008-10-03T16:45:16.880
> 
> 标签：php, optimization, compilation, merge

是否有任何更通用的工具可以“编译”或基本上将多个 PHP 文件合并到基于包含和自动加载类的单个文件中？我正在考虑类似于 Doctrine 的编译功能或许多主要 JS 框架为“生产”站点所做的编译以减轻文件大小并提高性能。

在编写自己的脚本之前，我只想了解是否已经存在任何值得一看的东西（到目前为止，Google 并没有提供太多帮助）。

**编辑：**我实际上已经写了[一篇](http://www.nickawilliams.com/2008/09/04/the-new-phar-php-package/)关于 .phar 存档格式的博客文章，对此我感到非常兴奋。我实际上更关心性能，但听起来合并文件不会产生任何好处。

有没有人有任何真实数据可能表明将多个脚本合并到一个文件中可以获得性能提升（或缺乏性能提升）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T16:51:26.507

我不是 php 程序员，但我见过一个叫做“phar”的文件。它就像 php 的 jar。也许你应该调查一下

一个快速的谷歌搜索显示

[http://pear.php.net/pepr/pepr-proposal-show.php?id=88](http://pear.php.net/pepr/pepr-proposal-show.php?id=88)

[http://www.pixelated-dreams.com/archives/78-PHAR-PHPs-Answer-to-.jar.html](http://www.pixelated-dreams.com/archives/78-PHAR-PHPs-Answer-to-.jar.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T17:18:30.243

出于好奇，你为什么要这样做？如果是为了性能，请不要打扰。只需使用常规包含而不是自动加载，它就会产生很多相同的效果。为了提高性能，您最好查看其中一种运行时缓存解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T17:33:29.963

我已经运行过托管在 codeplex上的[YUI Compressor for .NET 。](http://www.codeplex.com/YUICompressor)

它将压缩项目中的 JavaScript 和 CSS 文件。

我还没有尝试过，但我对它很感兴趣。

您可以轻松地将其集成到您的 msbuild 脚本中。

有关更多信息，您可以访问[http://developer.yahoo.com/yui/compressor/](http://developer.yahoo.com/yui/compressor/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T17:53:47.863

正如有人所说，Phar 就是你要找的东西。但我认为这不会提高性能。而且，它将在 PHP 的下一个版本中提供。

# version-control - 我在 SCM/build 工作。我如何告诉非程序员我在做什么？

> ID：167827
> 
> 赞同：2
> 
> 时间：2008-10-03T16:47:54.347
> 
> 标签：version-control, build

朋友/家人/等问我做什么，这总是让我在思考如何解释时停下来。他们知道什么是软件开发人员，但我如何用 10 个词解释 SCM 是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T17:01:04.647

我会告诉人们“我从事软件开发工作”。除非他们要求更多详细信息，否则我不会费心解释您在软件开发中所做的事情。我发现 90% 的人对这个答案感到满意，并将更多细节提供给 10% 感兴趣的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T17:30:28.410

令人惊讶的是，他们知道软件开发人员做什么！

Anwyay，这对俳句爱好者来说听起来像是一个挑战：

在 5-7-5 中（我在做英语俳句时很懒惰，我的季节性参考是 flakey - 如果你愿意，试试 3-5-3）

```
from many good parts:
one programme on your PC;
lose track, get winter 
```

（嗯，13 个字）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T16:52:30.657

确保部署的东西就是要部署的东西的人。

# language-agnostic - 您是否应该担心网站上的虚假帐户/登录？

> ID：167835
> 
> 赞同：8
> 
> 时间：2008-10-03T16:50:52.030
> 
> 标签：language-agnostic

我特别考虑了 BugMeNot 服务，它为大量站点提供用户名和密码组合。现在，我意识到付费内容网站可能会担心这一点（我怀疑大多数人会关注共享帐户），但其他网站呢？管理员应该留意这些帐户吗？Web 开发人员是否应该采取不同的措施来考虑它们（并可能阻止它们的使用）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-03T16:54:49.340

我认为这取决于您网站的目标。如果使用分析非常重要，那么您必须注意这一点。如果广告是您唯一的收入来源，那么使用哪个用户名真的很重要吗？

阻止使用 bugmenot 帐户的最佳方法可能是让拥有一个实际帐户变得值得。例如：没有人会在这里使用它，因为我们都需要代表和个人资料，或者如果您要发送有用的电子邮件，人们希望收到它们。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-03T17:04:22.783

问自己一个问题“为什么我们要求用户注册才能访问我的网站？” 一旦您有此要求的业务原因，您就可以尝试找出可疑帐户信息绕过某些部分的影响。

在至少 10% 到 15% 的帐户信息将是垃圾的基础上工作 - 如果使用该网站的人看不到他们个人注册的任何好处，并且如果注册过程甚至远程乏味或强加于人，那么接受您要么将更多潜在访问者赶走，要么增加您的“废话与有用信息”的比率。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-03T16:54:02.617

不强制注册才能阅读？即，当您为他们提供一些“保存”一些设置、数据等的功能时，要求人们注册。我想像 stackoverflow 这样的网站获得的虚假注册比纽约时报少（阅读问题不需要帐户），您需要有一个帐户才能阅读文章。

如果这不受您的控制，您可以考虑删除休眠帐户。即在一定数量的不活动后删除帐户。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-03T17:06:27.477

这完全取决于。

大多数在 bugmenot.com 中列出的网站往往是需要注册才能访问其他免费内容的网站。

如果需要注册才能与站点交互（即添加评论/帖子/等），那么大多数人可能宁愿创建自己的帐户，也不愿使用已公开的帐户。

因此，在考虑是否执行诸如自动检查 bugmenot 之类的事情之前，请先考虑一下它们是否与您的业务模型有关。

在某些情况下，付费访问内容网站（我在想诸如咳咳，“成人”网站之类的东西）最终会公开发布一些用户帐户（通常是因为有人暴力破解了某些帐户详细信息） ，在这种情况下，可能会有人为此付出巨大努力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T16:56:11.303

绝对从管理员的角度来看。需要进行注册是有原因的，即使它与用户跟踪/配置文件维护一样简单。数千人使用该登录名完全违背了目的。IP 跟踪可以帮助缓解这个问题，但肯定很难完全消除。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-03T17:17:30.683

无需担心 BugMeNot：[http ://www.bugmenot.com/report.php](http://www.bugmenot.com/report.php)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-03T17:19:53.847

使用 bugmenot，请记住，该服务实际上并不是为了损害网站，而是为了更容易使用它们。如果您的网站是按次付费的、基于社区的（即论坛或 Wiki）或帐户包含敏感信息（如银行业务），您可以[请求阻止您的网站。](http://www.bugmenot.com/report.php)这意味着在几乎所有您认为 bugmenot 是坏事的情况下，都不想使用 bugmenot。所以也许事情并没有你想象的那么糟糕。

# winforms - 如何在 Winforms 应用程序中创建可全局访问的数据表？

> ID：167844
> 
> 赞同：0
> 
> 时间：2008-10-03T16:53:56.423
> 
> 标签：winforms, datatable

免责声明：我是 Winforms 的新手。

我需要声明一个数据表，我可以在主窗体加载时加载数据。然后我希望能够从事件中引用数据表，例如单击按钮时等。

我应该在哪里/如何声明这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T17:03:19.930

我建议在表单类的顶部设置一个私有成员，这意味着它可以在整个表单中访问。不需要公共属性，除非您必须在表单之外访问它，但如果您不确定，最好默认为私有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T17:37:04.373

```
Public 

Class Form3

Private myTable as New DataTable

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

MsgBox(t.Rows.Count)

End Sub

Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click

MsgBox(t.Rows.Count)

End Sub

End Class 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T16:56:18.323

更新：如果它是一个简单的表单应用程序，请查看 Quarrelsome 的建议。

只需声明为您的数据访问类的公共属性。

# php - 托管在 Windows 服务内的 WCF 服务 (basicHttpBinding) 的 WSDL URL

> ID：167852
> 
> 赞同：12
> 
> 时间：2008-10-03T16:56:21.507
> 
> 标签：php, wcf, url, wsdl, basichttpbinding

我在我们的一台服务器上的 Windows 服务中托管 WCF 服务。在使其在 basicHttpBinding 中工作并在 .NET 中构建测试客户端（最终成功）之后，我继续尝试使用 SoapClient 类从 PHP 访问它。最终消费者将是一个 PHP 站点，因此我需要使其在 PHP 中可用。

当我不得不在 PHP 代码的 SoapClient 类的构造函数中输入 WSDL url 时，我感到很困惑。WSDL 在哪里？我所拥有的是：

[http://172.27.7.123:8000/WordService](http://172.27.7.123:8000/WordService)和 [http://172.27.7.123:8000/WordService/mex](http://172.27.7.123:8000/WordService/mex)

这些都没有公开 WSDL。

作为 WCF 的新手，我可能会问一个愚蠢的问题（或者我可能在某处有错误的假设）。请温柔 :D

不， http: [//172.27.7.123](http://172.27.7.123:8000/WordService) :8000/WordService?wsdl没有显示与 http://172.27.7.123:8000/WordService 不同的任何[内容](http://172.27.7.123:8000/WordService?wsdl):(

我是否被迫在 IIS 中托管它？我是否被迫使用常规 WebService？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-03T17:24:40.527

这可能会有所帮助：

[http://msdn.microsoft.com/en-us/library/ms734765.aspx](http://msdn.microsoft.com/en-us/library/ms734765.aspx)

简而言之，您需要配置服务端点和行为。这是一个最小的例子：

```
<system.serviceModel>
  <services>

    <service 
      <!-- Namespace.ServiceClass implementation -->
      name="WcfService1.Service1" 

      <!-- User behaviour defined below -->
      behaviorConfiguration="SimpleServiceBehaviour"> 

      <endpoint 
        address="" 
        binding="basicHttpBinding"
        <!-- Namespace.Interface that defines our service contract -->
        contract="WcfService1.IService1"/>

    </service>
  </services>
  <behaviors>
    <serviceBehaviors>
      <behavior name="SimpleServiceBehaviour">

        <serviceMetadata 
          <!-- We allow HTTP GET -->
          httpGetEnabled="true" 

          <!-- Conform to WS-Policy 1.5 when generating metadata -->
          policyVersion="Policy15"/>

      </behavior>
    </serviceBehaviors>
  </behaviors>
</system.serviceModel> 
```

不要忘记删除 XML 注释，因为它们在它们所在的位置是无效的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T17:24:07.393

请看这个链接：

[公开具有多个绑定和端点的 WCF 服务](http://keithelder.net/blog/archive/2008/01/17/Exposing-a-WCF-Service-With-Multiple-Bindings-and-Endpoints.aspx)

```
与以前的 ASMX 服务不同，WCF 的 WSDL（Web 服务定义语言）
服务不会自动生成。上一张图片甚至告诉我们
“此服务的元数据发布当前已禁用。”。  
这是因为我们还没有配置我们的服务来公开任何关于它的元数据。
 要为服务公开 WSDL，我们需要配置我们的服务以提供元信息。笔记：  
mexHttpBinding 还用于共享有关服务的元信息。尽管
这个名字不是很“gump”它代表元数据交换。

```

# javascript - Selenium Drag&Drop 在测试 javascript

> ID：167857
> 
> 赞同：1
> 
> 时间：2008-10-03T16:58:22.127
> 
> 标签：javascript, selenium

在这种特殊情况下需要您的帮助。我使用 Selenium 框架来测试基于“ *ext js* ”库的应用程序。有2棵元素树。我需要将一个元素从一棵树移动到第二棵树中的另一个元素。我用`dragAndDropToObject(xpath1,xpath2)`; 我可以看到该方法采用 ' `xpath1`' 元素，尝试将其带到 ' `xpath2`' 元素并且没有结果 - 元素 ' `xpath1`' 回到了以前的位置。似乎该方法没有看到指向的对象，也没有在其上释放已获取的元素。如果我使用 Selenium-fe 的另一种方法，`click(xpath2);`它会单击指向的对象，所以问题出在`dragAndDropToObject`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-06T14:10:38.670

我认为您必须通过 user-extensions.js 文件扩展 selenium。

[在SweetDEV RIA](http://sweetdev-ria.sourceforge.net/)开源标签库上进行了拖放硒测试。

您可能会[在 SweetDEV RIA SVN 存储库中找到一个非常有趣的方法 (Selenium.prototype.doDragTo)](http://sweetdev-ria.svn.sourceforge.net/viewvc/sweetdev-ria/sweetdev-ria/trunk/sweetdev-ria-test/src/test/resources/user-extensions.js?revision=7533&view=markup#l_122)。

# ruby - 在 Ruby 中需要串行端口通信方面的帮助

> ID：167858
> 
> 赞同：4
> 
> 时间：2008-10-03T16:58:24.963
> 
> 标签：ruby, serial-port, communication

我需要通过 Ruby 中的串行端口进行一些通信。根据我的研究，用于串行通信的现代库似乎并不多，我能找到的最新材料是 2006 年的。有什么我不知道的宝石吗？

我最终需要与连接到 USB 的串行设备保持通信（我可以弄清楚端口没问题），以便像这样（有点 Ruby 式的伪代码）来回通信。

```
def serial_write_read
  if serial.read == "READY"
    serial.write "1"
    until serial.read == "OK"
      serial.write "5"
    end
    return when serial.read == "DONE"
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-09-28T10:53:28.227

仅仅因为搜索 ruby​​-serialport 有时会引导您：

toholio 的 github repo 似乎不再活跃（截至 09/2010）。发布的gem来自

[http://github.com/hparra/ruby-serialport](http://github.com/hparra/ruby-serialport)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T18:05:22.460

串口规范永远不会改变，我不会担心库有多旧。

我假设您从 2006 年开始看到[这篇](http://www.rubyinside.com/cross-platform-ruby-serial-port-library-328.html)关于 ruby​​ 和串行端口的文章

[今年](http://www.openlogic.com/blogs/2008/04/access-serial-ports-through-ruby/)有人得到了那里提到的[Ruby-SerialPort库在 Mac 上工作。](http://rubyforge.org/projects/ruby-serialport/)

还有一篇来自 ruby​​ talk 的[旧帖子](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/35355)，关于与 Win32 Serial API 的接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-27T23:06:13.083

虽然串行标准没有改变，但 Ruby Gems 与 Ruby C 扩展交互的方式多年来发生了足够大的变化，以至于 RubyForge 串行端口扩展不能很好地发挥作用。多年来，RubyForge 上有一些补丁可以解决这个问题，但效果并不好。好消息是 Github 在清理 Ruby 串行端口扩展的活动中实现了令人难以置信的加速。至少三个不同的人在 Github 上交叉分支他们的串口代码。你可以在 Github 上搜索，但我相信 Toholio 有最新的代码，它将 Ruby 串口重新编码并重新打包为 Ruby Gem。（是的！）

[http://github.com/toholio/ruby-serialport/tree/master](http://github.com/toholio/ruby-serialport/tree/master)

它在 Linux 上非常适合我，解决了早期与最新 Ruby Gems 版本的冲突。在 Windows 上，我仍然无法正常工作。在 Windows 上编译 Ruby 扩展从来都不是一件容易的事，但那是一团糟。我很高兴人们再次致力于 Ruby 串行端口支持。我已经要求 Toholio 生成一个 Windows 二进制 gem，它可以解决每个人的问题，他说这是他要做的事情。

# c++ - 如何“取消使用”命名空间？

> ID：167862
> 
> 赞同：88
> 
> 时间：2008-10-03T16:59:58.720
> 
> 标签：c++, namespaces, c++builder

我的开发系统（Codegear C++Builder）的变幻莫测之一是一些自动生成的标题坚持...

```
using namespace xyzzy 
```

...其中的语句，当我最不想要或期望它时会影响我的代码。

有没有办法我可以以某种方式取消/覆盖以前的“使用”语句来避免这种情况。

也许...

```
unusing namespace xyzzy; 
```

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-10-03T17:39:08.487

没有。但是有一个潜在的解决方案：如果你将你的 include 指令包含在它自己的命名空间中，就像这样......

```
namespace codegear {
    #include "codegear_header.h"
} // namespace codegear 
```

...然后该标头中的任何 using 指令的效果都会被中和。

在某些情况下，这可能是有问题的。这就是为什么每个 C++ 风格指南都强烈建议*不要*在头文件中放置“使用命名空间”指令的原因。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-10-03T17:34:06.373

不，您*不能取消*使用命名空间。您唯一能做的就是将`using namespace`-statement 放在一个块中以限制其范围。

例子：

```
{
    using namespace xyzzy;

} // stop using namespace xyzzy here 
```

也许您可以更改用于自动生成的标题的模板。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-03T17:38:35.460

您可能会在冲突中使用显式命名空间：

```
string x; // Doesn't work due to conflicting declarations
::string y; // use the class from the global namespace
std::string z; // use the string class from the std namespace 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-01-10T23:17:22.717

供将来参考：由于 XE 版本有一个新值，您可以#define 以避免可怕`using namespace System;`的 int 包含：DELPHIHEADER_NO_IMPLICIT_NAMESPACE_USE

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-03T17:55:23.930

使用 sed、perl 或其他一些命令行工具作为构建过程的一部分，在生成头文件之后但在使用之前修改它们如何？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T17:37:54.620

使用 Visual Studio 2005 的快速实验表明，您可以将这些标头包含在您自己命名的命名空间中，然后`use`从该命名空间中获得您需要的内容（但不要`use`包含整个命名空间，因为它会引入您想要隐藏的命名空间。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-04-26T09:18:48.590

```
#include<iostream>
#include<stdio.h>
namespace namespace1 {
    int t = 10;
}
namespace namespace2 {
    int t = 20;
}
int main() {
using namespace namespace1;
    printf("%d" , t);
    printf("%d" , namespace2::t);
} 
```

# cookies - 重复 cookie 查询或存储在视图状态中？哪个是更好的做法？

> ID：167873
> 
> 赞同：1
> 
> 时间：2008-10-03T17:01:49.810
> 
> 标签：cookies, asp.net-2.0, viewstate

我有一个用户登录的内部网站。此数据保存为 cookie。从那里，用户继续他们的快乐之路。应用程序每隔一段时间就会查询身份验证记录以确定用户拥有哪些权限。

我的问题是：在需要时仅在 cookie 中查询用户数据或将用户信息保存在视图状态中是否更有效？

[编辑] 如下所述，Session 也是一个选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T17:05:38.943

就个人而言，我更喜欢使用[会话](http://msdn.microsoft.com/en-us/library/ms178581(VS.80).aspx)来存储东西，尽管这里的其他开发人员似乎认为这是一个禁忌。

有一个警告：您可能希望将用户的 IP 存储在会话中，并将其与用户的当前 IP 进行比较，以帮助避免会话劫持。可能这里的其他人对如何防止会话劫持有更好的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T17:43:30.990

Viewstate 特定于他们正在查看的页面，因此一旦他们沿着他们的快乐方式前进，它就消失了。不是持久化数据的好方法。

最好的办法是使用 Forms Authentication，它内置于 ASP.NET 中，您还可以将任何用户特定的信息推送到 Forms Authentication Ticket 的值中。您可以在其中（加密后）获得 4000 个字节，这些字节应该包含您需要的任何内容。它还将负责允许和拒绝用户访问网站上的页面，您可以将其设置为在需要时过期。

存储在会话中是一个禁忌，**因为**它的扩展性非常差（占用服务器上的资源），并且对于具有多个浏览器连接到同一服务器的用户来说可能会很烦人。有时这是不可避免的，但如果可以的话，你应该努力避免它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T17:06:44.450

您可以使用会话数据 - 这样您就知道一旦将其存储在那里，用户就无法通过更改查询字符串来愚弄它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T18:29:10.487

我会使用cookie方法。会话没问题，但在重新编译时会被 asp.net 处理掉，如果你想在会话之后保留它，你必须使用非会话 cookie。此外，如果您曾经使用过状态服务器，它基本上会做同样的事情（将会话存储在数据库中）。会话就像一个快速而肮脏的修复，真正的男人使用cookie。

# excel - 如何仅使用 .xla 文件中的代码从 Excel VBA 压缩文件？

> ID：167888
> 
> 赞同：4
> 
> 时间：2008-10-03T17:04:02.317
> 
> 标签：excel, gzip, add-in, vba

我需要能够 GZip 压缩 Excel VBA 函数中的文件。具体来说，我需要能够使用“放气”算法。

有没有办法做到这一点而不必执行命令行应用程序？由于不依赖外部工具，代码将更加健壮。

理想情况下，代码将使用预安装的 VBA 或 COM 库函数——我不想自己实现这个逻辑或安装 DLL 等。

如果可能的话，我希望该功能的安装与将 .xla 文件添加到可用的 Excel 加载项一样简单。不需要 DLL、EXE、注册表项等。

**编辑**我可以使用.NET GZipStream 来做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-03T19:35:48.250

VBA（实际上是 VB6 的一种方言）对于这类应用程序来说速度很慢。我记得我曾经在 VB6 和 C 上实现过 Shannon-Fano 算法，C 版本的速度大约快 10 倍，即使在变成 DLLMain 并从那里调用而不是在命令行可执行文件上调用之后也是如此。

有许多提供压缩服务的 COM DLL，包括开源和共享软件，其中一些实现了 GZIP 的 deflate 算法。仅从您的 VBA 代码中调用此类 DLL 中的一个函数来代表您进行压缩非常简单。

我理解您不愿意使用应用程序外部的东西，但在这种情况下，为了性能起见，您可能必须应用例外。

为了彻底破坏您的乐趣，请检查 windows\system32 上的文件 ZIPFLDR.DLL。您可能还想看看这些链接：

*   这有一个示例，说明如何从 VB.NET 执行您想要的操作（使用 windows 内置 ZIP 功能进行压缩），它与 VBA 或 VB6 应该没有太大区别： [带 DLL 调用的透明 ZIP](http://www.autohotkey.com/forum/topic15135.html)
*   这个在 VB6 上有一个示例应用程序，使用 Windows 内置功能来压缩（当然是 ZIP 而不是 GZIP 格式）：[使用 Windows XP“压缩文件夹”外壳扩展来处理 .zip 文件](http://www.mvps.org/emorcillo/en/code/vb6/index.shtml)

通过谷歌搜索找到了两个，你应该能够找到更多/更好的例子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T21:29:41.297

好的，我想我有一个答案给你。

zlib 是由编写您不想实现的放气算法的人编写的库。有一个 win32 DLL 可用。以下是有关从 Windows 使用它的常见问题解答：

[http://www.zlib.net/DLL_FAQ.txt](http://www.zlib.net/DLL_FAQ.txt)

查看问题 7。作者似乎不太热衷于 Windows 用户，似乎根本不热衷于 VB 用户，但只要他们好心提供库，我们就可以完成剩下的工作。

如果这足以帮助您，那就太好了。如果您需要从 VBA 调用 C 库的帮助，请添加评论，我们会解决的。多年来我没有做过任何 VB-to-C 调用——这听起来很有趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T17:10:16.500

如果要在 VBA 中实现该算法，则需要（在 VBA 中）保存电子表格，然后使用 VB 的 I/O 函数打开文件，将其放气，然后再次保存。出于所有意图和目的，它与编写处理文件的普通 VB 应用程序相同。您可能需要将 VBA 宏放在单独的工作簿中以避免“文件正在使用”类型的错误，但如果您以只读方式重新打开文件并使用不同的文件名保存它，您应该可以将所有内容保存在一个工作簿中。

但我几乎可以肯定，从 VBA 中提取 gzip 在功能上是相同的并且非常容易。

**编辑：**一些代码。我运行它时它没有失败，因此可以将所有内容保存在同一个工作簿中。

```
Sub main()
    ActiveWorkbook.Save
    Open "macrotest.xls" For Binary Access Read As #1
    Open "newfile.zip" For Binary Access Write As #2
        'do your stuff here
    Close #2
    Close #1
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T20:51:00.080

似乎你想打开一瓶酒，但你肯定拒绝使用开瓶器。只要没有允许 GZipping 文件的 VBA 功能，如果没有一些外部资源（例如 dll 或 exe 文件），您将无法完成这项工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-04T14:52:10.787

如果有人想在不依赖第 3 方软件的情况下压缩文件，他们通常会将其实现为 COM 对象/DLL，因此它不仅适用于 Excel。如果有人想将 zip 功能合并到 Excel 中，他们会使用 3rd-party 工具，这样他们就不必重新实现算法。所以你在逆流而上。然而...

[http://www.cpearson.com/excel/SaveCopyAndZip.htm](http://www.cpearson.com/excel/SaveCopyAndZip.htm)

有两个版本。COM 插件版本“...允许您压缩已保存到磁盘的任何工作簿（但它可能处于未保存状态）。” 它依赖于 Moonlight Software 组件，但所有组件和设置都包含在安装程序中。它不是完全公共领域，但许可比 GPL 限制更少。最终结果是一个 Excel 加载项（使用第 3 方组件）。

但是，如果您真的，真的不希望对外部工具有任何依赖，您要么必须自己实现压缩算法，要么等到 Microsoft 将该功能构建到 Windows 中并通过 Excel 公开它。

我希望这有帮助。

# asp.net - Visual Studio 2005 网站管理工具的响应非常慢

> ID：167893
> 
> 赞同：2
> 
> 时间：2008-10-03T17:06:23.077
> 
> 标签：asp.net, visual-studio, authentication, permissions

我正在开发一个 ASP.NET 应用程序并尝试添加用户身份验证。作为第一步，我使用网站管理工具（网站 | ASP.NET 配置）来管理用户和权限。

访问这个网站非常慢。加载主页需要 30 秒。导航到“安全”页面（也是 30 秒）时，出现以下错误：

我在 web.config 文件中将身份验证模式设置为“表单”。

* * *

您选择的数据存储存在问题。这可能是由无效的服务器名称或凭据或权限不足引起的。这也可能是由于未启用角色管理器功能造成的。单击下面的按钮可重定向到您可以选择新数据存储的页面。

以下消息可能有助于诊断问题：无法连接到 SQL Server 数据库。

* * *

它要求我运行“C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_regsql.exe”，这也给了我一条错误消息。

如何快速解决这些问题并启用安全性/用户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T17:32:49.107

您遇到的问题是由于 SQL Server 连接无效，您可以在 web.config 中设置 SQL Server 连接，一旦它能够实际连接到数据库，它将以正确的方式执行。

**下面的编辑**是 web.config 中设置新连接所需的代码

```
<connectionStrings>
    <clear />
    <add name="LocalSqlServer" connectionString="server=yourservername;database=somedatabasename;etc..." />
</connectionStrings> 
```

# language-agnostic - 你如何阻止临时解决方案永远持续下去？

> ID：167904
> 
> 赞同：79
> 
> 时间：2008-10-03T17:10:01.040
> 
> 标签：language-agnostic

假设一个问题有两种可能的解决方案：第一种是快速但很老套；第二个是可取的，但需要更长的时间来实施。您需要快速解决问题，因此您决定尽快解决问题，并计划在之后开始研究更好的解决方案。问题是，一旦问题得到缓解，它就会从待办事项列表中直线下降。您仍然计划在某个时候提出更好的解决方案，但现在很难证明实施它的合理性。突然你发现你已经用了五年的时间使用这个不太完美的解决方案，同时诅咒它。

这听起来很熟悉吗？我知道这在我工作的地方不止一次发生过。一位同事描述了故意制作一个糟糕的 GUI，这样它就不会被意外地长期采用。你有更好的策略吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-03T17:56:22.337

编写一个 hack 失败的测试用例。

如果您无法编写黑客失败的测试，那么黑客毕竟没有任何问题，或者您的测试框架不足。如果是前者，在你把生命浪费在不必要的优化上之前，赶紧跑掉。如果是后者，请寻求另一种方法（标记黑客或测试......）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-03T17:19:04.643

策略1（几乎从未选择过）：不要实施kluge。甚至不要让人们知道这是一种可能性。只需第一次以正确的方式进行即可。就像我说的，由于时间限制，这个几乎从未被选中。

策略2（不诚实）：撒谎和欺骗。告诉管理层黑客中存在错误，它们可能会在以后引起重大问题。不幸的是，大多数时候，经理只是说等到错误成为问题，然后再修复错误。

策略 2a：与策略 2 相同，但确实存在错误。不过，同样的问题。

策略 3（也是我个人最喜欢的）：尽可能设计解决方案，并且做得足够好，让实习生或代码猴都能做到。证明花费少量代码猴钱的合理性比证明自己的薪水合理容易，所以它可能会完成。

策略4：等待重写。继续等待。迟早（可能更晚），有人将不得不重写这件事。还不如当时就做。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-03T17:33:35.813

[这是一篇关于技术债务](http://forums.construx.com/blogs/stevemcc/archive/2007/11/01/technical-debt-2.aspx)的精彩相关文章。

基本上，它与您做出的所有技术决策类似债务。有好债务和坏债务……你必须选择能够以最低的长期成本实现你想要的目标的债务。

最糟糕的债务是类似于信用卡债务的小额累积捷径……每个人都不会受到伤害，但很快你就会陷入困境。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-10-03T17:15:02.780

在进行最后期限驱动的工作时，这是一个主要问题。我发现添加关于为什么选择这种方式的非常详细的评论以及应该如何编码的一些提示会有所帮助。通过这种方式，查看代码的人可以看到并保持新鲜。

另一个可行的选择是在您的跟踪框架中添加一个 bug.feature（您确实有一个，对吗？）详细说明返工。这样它是可见的，并且可能会在某些时候强制解决问题。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-03T17:31:02.107

唯一一次你可以证明修复这些东西是合理的（因为它们并没有真正损坏，只是丑陋）是当你有另一个功能或错误修复触及同一段代码时，你不妨重新编写它。

您必须计算开发人员的时间成本。如果满足了软件要求，而唯一的错误是代码在后台令人尴尬，那么它真的不值得修复。

整个公司都可能倒闭，因为过分热心的工程师每年都会在他们感到不安时坚持重新架构。

如果它没有错误并且满足要求，那么它就完成了。装运它。继续前行。

***[编辑]***

当然，我并不是主张一切都被黑客入侵。在开发过程的正常过程中，您必须仔细设计和编写代码。但是当你最终不得不快速完成黑客攻击时，你必须对清理代码是否值得进行成本效益分析。如果在应用程序的整个生命周期中，您将花费更多的时间围绕一个凌乱的黑客进行编码而不是修复它，那么当然要修复它。但如果不是这样，仅仅因为看源代码会让你生病，就重新编写一个*工作的、没有错误的应用程序太昂贵和太冒险了。*

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-03T17:22:58.473

你不做临时解决方案。

有时我认为程序员只需要被告知这一点。

对此感到抱歉，但说真的——一个 hacky 解决方案毫无价值，即使在第一次迭代中也可能比正确完成部分解决方案花费更长的时间。

请停止将您的垃圾代码留给我维护。始终正确编码。不管需要多长时间，谁对你大喊大叫。

当你早早交付后坐在那里摆弄拇指，而其他人都在调试他们愚蠢的黑客行为时，你会感谢我的。

即使你认为自己不是一个伟大的程序员，也要始终努力做到最好，永远不要走捷径——这不会花费你任何时间来做正确的事。如果你不相信我，我可以证明这个说法。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-10-03T17:23:42.107

> > 突然你发现你已经用了五年的时间使用这个不太完美的解决方案，同时诅咒它。

如果你在诅咒它，为什么它在 TODO 列表的底部？

*   如果它不影响你，你为什么要诅咒它？
*   如果它正在影响您，那么这是一个需要立即解决的问题。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-03T17:16:41.840

*   我确保我对长期修复的优先级直言不讳，特别是在短期修复进入之后。
*   我详细说明了为什么它是一个 hack 而不是一个好的长期解决方案，并使用这些来让利益相关者（经理、客户等）了解为什么需要修复它
*   根据具体情况，我什至可能会在其中注入一些最坏情况的恐惧。“如果这条安全线断了，整座桥都可能倒塌！”
*   我负责提出长期解决方案并确保其得到部署

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-03T17:15:49.250

这是一个艰难的决定。我个人做过一些黑客行为，有时你必须把产品**拿出**来交给客户。但是，我照顾它的方式就是去做。

告诉项目负责人、你的老板或客户：有些地方需要清理，并且编码得更好。我需要一周的时间来做，现在做的成本会更低，然后在 6 个月后做，那时我们需要在子系统上实现扩展。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-03T17:19:14.127

通常这样的问题是由于与管理层或客户的沟通不畅造成的。如果解决方案对客户有效，那么他们认为没有理由要求对其进行更改。因此，他们需要被告知您事先做出的权衡，以便他们可以在您实施快速解决方案后计划额外的时间来解决问题。

如何解决它取决于为什么它是一个糟糕的解决方案。如果您的解决方案很糟糕，因为它很难更改或维护，那么您第一次必须进行维护并且有更多的时间，那么这是升级到更好解决方案的正确时机。在这种情况下，如果您首先告诉客户或您的老板您走捷径，这会有所帮助。这样他们就知道下一次他们不能指望一个快速的解决方案。削弱 UI 可能是确保客户回来修复问题的好方法。

如果解决方案很糟糕，因为它有风险或不稳定，那么你真的需要与做计划的人交谈，并计划一些时间来尽快解决问题。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-03T17:33:58.700

祝你好运。以我的经验，这几乎是不可能实现的。

一旦你因为压力而走下实施黑客的滑坡，那么你最好习惯于一直忍受它。几乎没有足够的时间来重新工作已经工作的东西，无论它在内部实施得多么糟糕。是什么让您认为“在以后的某个日期”您会神奇地有更多时间来修复黑客？

我能想到的唯一例外是，如果黑客完全阻止您实现客户需要的另一项功能。然后你别无选择，只能重新工作。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-15T14:59:07.370

我们使用 Java 和 Hudson 进行持续集成。“临时解决方案”必须注释：

```
// TODO: Better solution required. 
```

每次 Hudson 运行构建时，它都会提供每个*TODO*项目的报告，以便我们对任何需要改进的未完成项目有一个最新的、高度可见的记录。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-03T19:19:18.970

教育负责做出最终决定的人，为什么从长远来看，这种老套的做事方式是不好的。

*   用他们可能涉及的术语来描述问题。
*   包括成本、生产力和收入曲线图。
*   教他们有关[技术债务](http://forums.construx.com/blogs/stevemcc/archive/2007/11/01/technical-debt-2.aspx)的知识。
*   如果您被推进，请定期重构。
*   永远不要在非技术人员面前称其为“重构”或“回去清理”。相反，将其称为“适应”系统以处理“新功能”。

基本上，不懂软件的人不会有重新审视已经工作的东西的概念。在他们看来，开发人员就像机械师一样，每次有人想要添加一个功能时，他们都想不断地拆开并重新组装整辆汽车，这对他们来说听起来很疯狂。

它有助于对日常事物进行类比。向他们解释当您制定临时解决方案时，您如何做出适合快速构建它的选择，而不是稳定、可维护等。这就像选择用木头而不是钢来建造，因为木头更容易切割，因此，您可以更快地构建临时解决方案。然而，木头根本无法支撑一座20层楼的地基。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-03T17:26:33.880

我尝试构建 hacky 解决方案，以便可以尽可能轻松地将其迁移到长期方式。假设您有一个人正在 SQL Server 中构建数据库，因为这是他最强大的数据库，但您的公司标准是 Oracle。使用尽可能少的不可转移特性（如 Bit 数据类型）构建数据库。在此示例中，避免位类型并不难，但它使稍后的转换过程变得更容易。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-03T19:30:03.927

您针对您自己的“修复”提交了第二个非常具有描述性的错误，并在受影响的区域放置了一个待办事项评论，上面写着“这个区域需要大量工作。请参阅缺陷 #555”（当然使用正确的数字） . 说“不要进行黑客攻击”的人似乎不理解这个问题。假设您有一个需要立即启动并运行的系统，您的非黑客解决方案是 8 天的工作，您的黑客是 38 分钟的工作，黑客在那里为您争取时间来完成工作而不是赔钱你在做。

现在，除了现在修复它所需的 N 分钟之外，您仍然需要让您的客户或管理层同意安排 N*100 分钟的时间来进行真正的修复。如果您必须在获得此类协议之前拒绝实施黑客攻击，那么也许这就是您必须做的，但我在这方面与一些了解的人合作过。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-12-05T13:33:17.817

您可以故意以过于严格和单一目的的方式编写它，并且需要重新编写才能进行修改。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-03T18:21:47.527

这让我想起了“CTool”的故事。一开始 CTool 是由我们的一位开发人员提出的，我称他为 Don，作为解决我们遇到的问题的一种可能方法。作为一个认真勤奋的人，Don 插手并交付了一个工作原型。你知道我要去哪里。一夜之间，CTool 成为公司工作流程的一部分，整个部门都依赖它。到了第二天或第三天，关于 CTool 的缺点的抱怨开始涌现。用户质疑唐的能力、承诺和智商。唐关于这不应该是一个生产应用程序的抗议被置若罔闻。这种情况持续了*多年*. 终于，在 Don 离开之后，有人开始重新编写应用程序。到了这个时候，CTool 这个名字已经引起了如此多的厌恶，以至于将其命名为 CTool 版本 2 是不可能的。*甚至还为 CTool 举办了一场正式的葬礼，有点让人想起Office Space*中的复印机（或者是打印机？）执行场景。

有人可能会说，Don 没有正确地修复 CTool，因此应该受到批评。我唯一的观点是，说你**永远不**应该破解解决方案在现实世界中可能是不合理的。但是，如果您是这样做的人，请谨慎行事。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-10-03T19:12:11.793

*   以书面形式（电子邮件）获取。因此，当它成为问题后，管理层不会“忘记”它应该是暂时的。

*   使其对用户可见。它越明显，人们就越不可能在危机结束后忘记回去并以正确的方式做事。

*   在为项目、资源和时间表制定临时解决方案之前进行谈判，以得到真正的解决方案。为真正的解决方案工作可能应该在临时解决方案完成后立即开始。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-03T17:21:02.220

好问题。这也让我很困扰——而且大多数时候我是唯一负责在我自己的项目中优先处理问题的人（是的，小企业）。

我发现需要解决的问题通常只是问题的一个子集。IOW，需要紧急修复的客户不需要解决整个问题，只需解决其中的一部分 - 更小或更大。这有时使我能够创建一个解决方法，它不是解决完整问题而只是解决客户的子集，并且允许我在问题跟踪器中留下更大的问题。

这当然可能根本不适用于您的工作环境:(

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-10-03T22:27:18.187

引入快速修复的真正代价是，当其他人需要引入第二个快速修复时，他们会根据您自己的快速修复来引入它。因此，快速修复的时间越长，它就会变得越根深蒂固。很多时候，hack 只需要比做正确的事情稍长一点的时间，直到你遇到第二个 hack，它是在第一个 hack 的基础上构建的。

因此，显然有时需要（或似乎是）引入快速修复。

假设您的版本控制支持它，一种可能的解决方案是在您进行此类 hack 时从源代码中引入一个 fork。如果鼓励人们避免在这些特殊的“完成”分叉中编写新功能，那么最终将新功能与分叉集成将比摆脱黑客攻击更多的工作。不过，更有可能的是，“好”的分叉会被丢弃。而且，如果您离发布太远以至于制作这样的分叉将不切实际（因为不值得进行上面提到的双重集成），那么您可能甚至都不应该使用 hack。

一种非常理想主义的方法。

一个更现实的解决方案是将您的程序分割成尽可能多的正交组件，并偶尔对某些组件进行完全重写。

一个更好的问题是为什么 hacky 解决方案不好。如果它因为降低灵活性而不好，请忽略它，直到您需要灵活性为止。如果它是坏的，因为它影响程序的行为，忽略它，最终它将成为一个错误修复，并将得到解决。如果它因为看起来丑陋而不好，请忽略它，只要破解是本地化的。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-10-04T05:55:19.467

我过去看到的一些解决方案：

*   用代码中的注释标记它`HACK`（或类似的方案，例如`XXX`）
*   每周运行自动报告并通过电子邮件发送给那些关心`HACK`评论出现次数的人
*   在错误跟踪系统中添加一个新条目，其中包含正确解决方案的行号和描述（因此在编写 hack 之前从研究中获得的知识不会丢失）
*   编写一个测试用例来演示黑客如何失败（如果可能）并将其检查到适当的测试套件中（即它会抛出最终有人想要清理的错误）
*   一旦安装了hack并且压力消失，立即开始正确的解决方案

这是一个很好的问题。当我获得更多经验时，我注意到一件事：黑客给你带来了非常短的时间，而且通常会让你付出更多的代价。与之密切相关的是“快速修复”，它解决了你认为是问题的问题——只是在它崩溃时才发现它根本不是问题。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-10-04T06:32:07.397

撇开关于你是否应该这样做的争论，让我们假设你必须这样做。现在的诀窍是以一种最大限度地减少远程影响的方式来做，它很容易在以后被撕掉，并且使自己成为一个麻烦，所以你记得修复它。

令人讨厌的部分很简单：每次执行 kludge 时都会发出警告。

撕掉的部分很容易：我喜欢这样做，将杂物放在子例程名称后面。由于您对代码进行了划分，因此更易于更新。当您获得永久解决方案时，您的子程序可以实现它或成为无操作。有时子类也可以很好地工作。但是，不要让其他人依赖于您的快速解决方案。在没有看到情况的情况下很难推荐任何特定的技术。

如果代码的其余部分很好，那么最小化远程影响应该很容易。总是通过发布的界面，等等。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-10-04T07:54:50.553

尝试让业务人员清楚地了解黑客的成本。然后他们可以以任何一种方式做出明智的决定。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-10-03T18:32:04.543

我的回答和其他人有点不同。我的经验是，以下做法可帮助您保持敏捷，并从 hackey 的第一次迭代/alpha 解决方案过渡到 beta/生产就绪：

1.  测试驱动开发

2.  小单元重构

3.  持续集成
4.  良好的配置管理
5.  敏捷数据库技术/数据库重构

不言而喻，您必须获得利益相关者的支持才能正确执行其中任何一项。但有了这些产品，您就有了正确的工具和流程，可以自信地以主要方式快速更改产品。有时，你改变的能力就是你管理改变风险的能力，从开发的角度来看，这些工具/技术可以让你站稳脚跟。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-10-03T18:13:51.037

忏悔：

我在 C++ 中使用了“#define private public”来从其他代码层读取数据。它作为黑客进入，但运行良好，修复它从未成为优先事项。现在是3年后...

黑客没有被删除的主要原因之一是在修复黑客时引入新错误的风险。（尤其是在处理 TDD 之前的代码库时。）

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-10-03T17:34:06.080

我们必须这样做一次——制作一个我们知道不想保留的短期演示版本。客户希望它在一个 winTel 盒子上，所以我们在 SGI/XWindows 中开发了原型。（我们两者都很流利，所以这不是问题）。

# .net - F# 适合物理应用吗？

> ID：167909
> 
> 赞同：4
> 
> 时间：2008-10-03T17:10:38.950
> 
> 标签：.net, f#, physics

我讨厌物理，但我喜欢软件开发。感恩节后我回到学校时，在完成这件可怕的事情之前，我还要再上两个季度的物理课。我目前正在阅读有关 F# 度量单位功能的帖子，但我从未使用过 F# 之类的语言。是否适合编写应用程序，以便我可以在做我喜欢的事情的同时学习一些物理知识？

我对运动学、平面运动、牛顿定律、万有引力、功、能量、动量和冲量、系统粒子、旋转运动学和动力学、角动量、静态平衡、振荡运动、波动、声音、物理光学、静电学、高斯定律、电场和电势、电容、电阻、直流电路、磁场、安培定律和电感.

我对 F# 感兴趣的原因是该语言提供的度量单位功能。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-03T17:56:48.980

在我看来，F# 是物理学的理想选择。它有一个名为“测量单位”的功能，可以为您进行尺寸分析，如果您弄错了，它会提供错误。例如，如果你写：

```
let distance : float<meters> = gravity * 3.0<seconds> 
```

这会**产生编译错误**，因为重力是 < 米/秒 ^2 > 而不是 < 米 >。这可以防止大量与物理相关的编程错误。

有关更多信息，请查看[Andrew Kennedy 的博客](http://blogs.msdn.com/andrewkennedy/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T17:24:31.747

我引用了一本名为“F# 为科学家”的书的介绍（介绍是免费的），这似乎是对该领域的一个很好的介绍，因为 F# 似乎非常适合这种领域。

你可能想看看介绍。

[http://www.ffconsultancy.com/products/fsharp_for_scientists/](http://www.ffconsultancy.com/products/fsharp_for_scientists/)

（不，我和作者没有关系；-）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T17:44:11.270

是（任何语言都是）和否（了解你未来的同事将使用什么，比如他们可能使用 python。）。一个有趣的地方是[堡垒](http://en.wikipedia.org/wiki/Fortress_(programming_language))。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-04T14:53:14.437

关于维度分析：我的一位物理学教授曾经给过我一个有趣的微积分技巧：假设在给定的烤箱中完美烹饪一磅火鸡需要一个小时，那么烹饪 2 磅火鸡需要多长时间是同一个烤箱?

嗯，维度分析显示

(1) 烹调火鸡所需的热能总量与火鸡的质量成正比，而质量本身与火鸡的体积成正比，而体积本身与平均“半径”的立方成正比，
即
烹饪热量所需能量 = k1 * (turkeyRadius" ^3) ==> 单位：m^3 * k（其中 k1 单位为 J / m^3）

(2) 烤箱提供的总热能与火鸡的表面乘以你煮它的时间成正比，
即
烤箱提供的热量=k2*时间*(turkeyRadius^2)（其中k2 单位为 J / s / m^2 )

然后通过使用 (1) = (2) ，您获得
时间 = k1 / k2 * turkeyRadius ^ (3/2)

即
- 烹饪时间与半径成正比 ^ 3/2
- 鉴于 turkeyRadius 与质量的立方根成正比，我们得到
烹饪时间 = k3 * sqrt(mass)

因此，烹饪我们的 2 磅火鸡需要 sqrt(2) 倍的时间，而且根本无需计算即可获得结果 - 仅进行尺寸分析。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-31T23:58:49.243

是的，正如 Chris Smith 在回复中所说，F# 是构建函数式编程的好方法。我正在使用 F# 构建关于物理、工程和生物学的广泛讨论。我当然可以使用像你这样的学生的意见。没有考虑现实生活问题的编程是一种编程方式。另一种成功的方式是提供只有使用计算机的人才能使用的解决方案，当然这是另一种方式，也是一种创造财富的方式。

F# 专为物理等知识领域而设计。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T17:29:51.657

Fsharp 是一种选择。如果你想学习一项可能对长期有益的技能，为什么不学习 python。你也将拥有 numpy 和 scipy 在你的指尖。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-03T17:17:25.770

学习任何计算机语言都不会教你物理，你可以通过用任何语言编写程序来学习物理。

维度分析是解决物理问题的一个相当方便的工具，它可以引导你远离“甚至没有错”。

我总是以 10^34 的系数得到错误的答案，因为我在某个地方弄错了我的单位；-)

# oracle - 通过分区交换 (Oracle 10g) 加载表

> ID：167916
> 
> 赞同：2
> 
> 时间：2008-10-03T17:12:11.210
> 
> 标签：oracle, statistics, oracle10g, partitioning

我对优化这种类型的负载有几个问题。

构建一个新的数据表以加载到分区表中，然后在这个新表上构建索引。

1.  您应该使用 COMPUTE STATISTICS 选项构建索引还是使用 DBMS_Stats 的 Cascade 选项？

2.  您应该在交换之前的表上还是在交换之后的分区上收集统计信息？

3.  如果你在交换之后做，并且你在参数列表中指定分区名称，粒度参数有什么相互作用？例如，如果我指定一个分区名称，然后将粒度设置为“全局和分区”，那是否会全局？它*只做*一个分区吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T23:45:58.120

> 您应该使用 COMPUTE STATISTICS 选项构建索引还是使用 DBMS_Stats 的 Cascade 选项？

如果这是一个数据仓库，那么首先考虑根本不收集统计数据，并使用动态抽样。其次，如果您确实收集了统计信息，那么一定要对索引使用计算统计信息。

> 您应该在交换之前的表上还是在交换之后的分区上收集统计信息？

在交换之前收集新数据表的统计信息以获取有关新数据的分区统计信息 -- 之后收集分区表的统计信息以收集表统计信息

> 如果你在交换之后做，并且你在参数列表中指定分区名称，粒度参数有什么相互作用？例如，如果我指定一个分区名称，然后将粒度设置为“全局和分区”，那是否会全局？它只做一个分区吗？

往上看。

说真的，不要给统计和动态抽样机会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-03T18:57:35.443

1.  `DBMS_STATS`被认为是计算此版本的统计数据的正确方法。使用 构建索引`COMPUTE STATISTICS`是可行的，但通常您希望一次计算所有统计数据并拍摄快照。

2.  您想在交换后收集统计数据。这样，优化器将对使用该分区的数据执行查询做出最佳猜测。

3.  为什么要两个都放？

# security - 你如何强制使用强密码？

> ID：167917
> 
> 赞同：9
> 
> 时间：2008-10-03T17:12:14.017
> 
> 标签：security, passwords

有许多技术可以在网站上强制使用强密码：

*   要求密码通过不同复杂度的正则表达式
*   自主设置密码，让普通用户拥有强密码
*   让密码过期
*   等等

另一方面也有缺点，因为所有这些都使用户的生活变得不那么容易，这意味着更少的注册。

那么，**您使用什么技术？哪个提供最好的保护与不便比率？**

*澄清一下，我不是指银行网站或存储信用卡的网站。更多地考虑仍然需要注册的流行（或不那么流行）网站。*

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-03T17:19:16.203

我认为强制使用强密码是不可能的，但是您可以做很多事情来尽可能地鼓励它们。

*   对每个密码进行评分，并以分数或图形条等形式向用户提供反馈。
*   设置最低密码分数以清除*糟糕*的密码分数
*   有一个被禁止的常用词列表，或者坦克密码分数

我喜欢使用的一个**绝妙**技巧是将密码的到期日期与密码分数相关联。因此，不需要经常更改更强的密码。如果您可以直接向用户提供有关他们选择的密码将使用多长时间的反馈（并动态更新它，以便他们可以看到添加字符如何影响日期），则此方法*特别有效。*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-03T17:17:08.657

不要强制执行任何事情……如果您没有保护财务信息或同样重要的事情，那么不要**让**用户选择强密码。

我在需要注册论坛等的所有网站上都有相同的弱密码。我真的不在乎有人猜到它并且可以像我一样发布消息（并且不认为有人这样做的动机很大所以）。我不能做的是记住十几个网站的不同强密码，并且真的不想使用另一个软件来为我管理它们。

最好的折衷办法是向用户显示某种关于密码强度的反馈（基于它是否是字典单词、不同字符类型的数量、长度等）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-03T17:20:48.883

为什么要*强制执行*？

我发现“密码强度计”（在您键入时指示密码强度的条）通常是一种很好的非侵入性措施。它使那些关心安全的人对密码弱点感到内疚，但不会让那些不那么关心的人感到沮丧。

此外，还有一篇很有见地的文章，说明了[为什么定期密码更改策略对于当今的威胁模型来说是个坏主意](http://www.cerias.purdue.edu/site/blog/post/password-change-myths/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-03T17:23:22.107

正如您所说，根据我的经验，这实际上取决于网站的类型。

如果您正在创建银行或金融网站，那么用户通常会了解您是否拥有更安全的密码，因为他们的个人数据可能存在风险。

但是，对于通常不包含大量个人信息的网站，更简单的密码就可以了。他们可能不太容易受到黑客攻击，而且无论如何也不会得到任何有价值的东西。

我还发现大多数人似乎也有几个他们经常使用的密码。一个是复杂的，另一个是简单的。因此，要求他们使用复杂的密码通常不会阻止人们注册。

我从来没有发现过期密码可以成功工作。正如我之前所说，许多人已经拥有一组他们经常使用的密码，因此要求他们为您的网站而离开此密码可能会让他们不想回来。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T17:16:52.573

最好的方法实际上取决于您的网站和您使用的内容。但理想的方法是在客户端提交之前尽可能多地在客户端进行操作。使用 RegEx 是一个好方法。如果您可以让他们不必再次提交表单，那是理想的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-03T17:18:14.317

在让密码过期时，这种做法有两个值得注意的问题：

*   用户发现很难记住他们当前的密码，因此他们更有可能做一些愚蠢的事情，比如把密码写在贴在显示器上的便利贴上。
*   用户不会在每次尝试时生成一个新的、强大的、不相关的密码。大多数时候，他们使用某种方案来生成与旧密码相似的密码。因此，如果攻击者获得旧密码，他们仍然很容易推断出新密码。

**编辑：**这并不是说我反对整个想法，而是说这需要与其他因素一起考虑。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-03T17:51:54.233

有一个 Ajax 工具 PasswordStrength，它可以让用户知道他们的密码是否有用。我喜欢它，因为它不必禁止创建密码。

[http://www.asp.net/AJAX/AjaxControlToolkit/Samples/PasswordStrength/PasswordStrength.aspx](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/PasswordStrength/PasswordStrength.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-04T17:37:20.517

我从未见过这样做，但它似乎会很好地工作：密码创建页面可以有一个可扩展的列表，例如 50 个最[常见的密码](http://www.openwall.com/wordlists/)，迫使用户在输入密码之前向下滚动一点. 这与 Checkers 的建议相结合，将有助于防止粗心的选择。

但是，解决防止密码重用的问题......没有线索。

# python - 使用Python从字符串中删除与正则表达式匹配的重复行的最佳方法是什么？

> ID：167923
> 
> 赞同：2
> 
> 时间：2008-10-03T17:13:37.167
> 
> 标签：python, regex

这是一个非常直接的尝试。我已经很久没有使用python了。似乎工作，但我相信我有很多东西要学。如果我离开这里，有人告诉我。需要查找模式，写入匹配的第一行，然后为剩余的匹配模式的连续行添加摘要消息并返回修改后的字符串。

只是要清楚......正则表达式`.*Dog.*`需要

```
Cat
Dog
My Dog
Her Dog
Mouse 
```

并返回

```
Cat
Dog
::::: Pattern .*Dog.* repeats 2 more times.
Mouse

#!/usr/bin/env python
#

import re
import types

def remove_repeats (l_string, l_regex):
   """Take a string, remove similar lines and replace with a summary message.

   l_regex accepts strings and tuples.
   """

   # Convert string to tuple.
   if type(l_regex) == types.StringType:
      l_regex = l_regex,

   for t in l_regex:
      r = ''
      p = ''
      for l in l_string.splitlines(True):
         if l.startswith('::::: Pattern'):
            r = r + l
         else:
            if re.search(t, l): # If line matches regex.
                m += 1
                if m == 1: # If this is first match in a set of lines add line to file.
                   r = r + l
                elif m > 1: # Else update the message string.
                   p = "::::: Pattern '" + t + "' repeats " + str(m-1) +  ' more times.\n'
            else:
                if p: # Write the message string if it has value.
                   r = r + p
                   p = ''
                m = 0
                r = r + l

      if p: # Write the message if loop ended in a pattern.
          r = r + p
          p = ''

      l_string = r # Reset string to modified string.

   return l_string 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-03T17:34:20.337

rematcher 功能似乎可以满足您的要求：

```
def rematcher(re_str, iterable):

    matcher= re.compile(re_str)
    in_match= 0
    for item in iterable:
        if matcher.match(item):
            if in_match == 0:
                yield item
            in_match+= 1
        else:
            if in_match > 1:
                yield "%s repeats %d more times\n" % (re_str, in_match-1)
            in_match= 0
            yield item
    if in_match > 1:
        yield "%s repeats %d more times\n" % (re_str, in_match-1)

import sys, re

for line in rematcher(".*Dog.*", sys.stdin):
    sys.stdout.write(line) 
```

# 编辑

在您的情况下，最终字符串应该是：

```
final_string= '\n'.join(rematcher(".*Dog.*", your_initial_string.split("\n"))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T17:44:00.800

更新了您的代码以更有效

```
#!/usr/bin/env python
#

import re
import types

def remove_repeats (l_string, l_regex):
   """Take a string, remove similar lines and replace with a summary message.

   l_regex accepts strings/patterns or tuples of strings/patterns.
   """

   # Convert string/pattern to tuple.
   if not hasattr(l_regex, '__iter__'):
      l_regex = l_regex,

   ret = []
   last_regex = None
   count = 0

   for line in l_string.splitlines(True):
      if last_regex:
         # Previus line matched one of the regexes
         if re.match(last_regex, line):
            # This one does too
            count += 1
            continue  # skip to next line
         elif count > 1:
            ret.append("::::: Pattern %r repeats %d more times.\n" % (last_regex, count-1))
         count = 0
         last_regex = None

      ret.append(line)

      # Look for other patterns that could match
      for regex in l_regex:
         if re.match(regex, line):
            # Found one
            last_regex = regex
            count = 1
            break  # exit inner loop

   return ''.join(ret) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-08T23:45:20.063

首先，您的正则表达式的匹配速度将比您停止贪婪匹配时更慢。

```
.*Dog.* 
```

相当于

```
Dog 
```

但后者匹配得更快，因为不涉及回溯。字符串越长，“Dog”出现多次的可能性就越大，因此正则表达式引擎必须做的回溯工作就越多。事实上，“.*D”实际上保证了回溯。

也就是说，怎么样：

```
#! /usr/bin/env python

import re            # regular expressions
import fileinput    # read from STDIN or file

my_regex = '.*Dog.*'
my_matches = 0

for line in fileinput.input():
    line = line.strip()

    if re.search(my_regex, line):
        if my_matches == 0:
            print(line)
        my_matches = my_matches + 1
    else:
        if my_matches != 0:
            print('::::: Pattern %s repeats %i more times.' % (my_regex, my_matches - 1))
        print(line)
        my_matches = 0 
```

目前尚不清楚非相邻匹配会发生什么。

也不清楚被不匹配行包围的单行匹配会发生什么。将“Doggy”和“Hula”附加到输入文件中，您将获得更多匹配消息“0”。

# css - 寻找 CSS 示例，或下面的布局说明

> ID：167926
> 
> 赞同：0
> 
> 时间：2008-10-03T17:15:49.923
> 
> 标签：css

我已经学习 CSS 有一段时间了，但是下面的简化布局仍然有点超出我的能力，所以我想问是否有人知道这种布局的模型，或者会有一个解释来完成这项工作。

页面应该有 3 个波段或块：

标题、底部和内容。

“标题”将从可见屏幕中的左 0、顶部 0 开始，一直到右边缘，高度为 70 像素。

“底部”带将从左 0 开始，但在可见屏幕的底部，并且高度也是 70 像素（例如，从可见屏幕底部减去 70 像素开始）。它会一直延伸到可见屏幕的右边缘。

“内容”带将从左 0 开始，顶部将从“标题”带的底部开始，内容块的底部将向下延伸至“底部”带的顶部。

如果 'header' 和 'bottom' band 固定在它们的位置上也会很好，但是如果块中有更多的内容，那么 'content' 块是可滚动的。

我觉得是可行的，但我目前的水平只能做到这一点，所以我想看看高手是怎么做的。

非常感谢迈克·托马斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-03T17:19:11.023

页面底部的固定标题很难实现和维护。你能保证你的内容总是合适的吗？只滚动一个块而不是整个页面对于用户来说可能很乏味，因为您必须在使用向上翻页和向下翻页之前获得焦点。

更好的解决方案是让页脚在内容完成后自然消失。您可以为没有太多内容的页面设置内容的最小高度。

抱歉，这不是一个真正的答案，但您的网站这样会更好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T17:24:03.743

我不确定这是否解决了它，但是对于带有滚动中间内容部分的固定页眉和页脚，您可以查看此链接：

[http://www.cssplay.co.uk/layouts/basics2.html](http://www.cssplay.co.uk/layouts/basics2.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T17:23:16.023

这是我遇到的关于 CSS 的很棒的网站

[CSS 提示和教程](http://www.noupe.com/css/css-layouts-40-tutorials-tips-demos-and-best-practices.html)

我认为最好只遵循那里的一些基本设计并从中学习:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-03T17:24:47.143

你想要的是一个[粘性页脚](http://ryanfait.com/sticky-footer/)。至于内容，您需要实现一个[可滚动的 DIV](http://www.dreamincode.net/code/snippet132.htm) - 处理溢出的关键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-03T19:47:56.620

## CSS 框架

[此示例](http://www.456bereastreet.com/lab/cssframes/)涵盖了在顶部和底部保持固定的页眉和页脚，尽管宽度小于 100%。我相信你可以调整。

顺便说一句，我发现这一点的方法是**搜索“CSS 框架”** ——保持一部分内容静止而其余部分滚动有时被称为这种方式，因为它类似于人们过去对 HTML 框架所做的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-07T22:22:21.200

示例 - Css 列表属性/示例 - Css 图层属性/示例 - Css 文本框属性/示例 - Css 字体属性/示例 - Css 文本属性/示例 - Css 光标属性/示例 - Css 背景属性/示例 - Css 表格属性/示例 - Css 滚动条属性/示例 - 工具 - 单位 - 参数 - 模板页面 - 网页设计

[http://www.css-lessons.ucoz.com/](http://www.css-lessons.ucoz.com/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-07T22:46:39.763

[Blueprint CSS](http://www.blueprintcss.org/)是一个很好的工具，可以简化 CSS 布局的制作。

# c - 是否有在 C 中调用堆栈转储的函数？

> ID：167927
> 
> 赞同：3
> 
> 时间：2008-10-03T17:16:10.747
> 
> 标签：c, linux, debugging, exception

有人可以提供一个 C 函数的实现，该函数被调用以转储当前堆栈吗？它适用于 x86 linux 系统。它可以通过两种方式调用：由另一个函数显式调用，或者在崩溃之后（可能作为陷阱/int 处理程序）。输出可以是屏幕或文件，由参数（句柄）指示。对堆栈如何展开的清晰解释/评论显然会非常有帮助。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T17:46:40.500

在 Adam 的回答之后，显示如何执行实际堆栈回溯的源代码位于 gnu libc 的 backtrace() 中，位于 /libc/debug/backtrace.c 下 - 不确定下面的完整链接是否会被 stackoverflow 的 html 过滤器接受。 ..

[http://cvs.savannah.gnu.org/viewvc/*checkout*/libc/debug/backtrace.c?root=libc&revision=1.1.2.1&content-type=text%2Fplain](http://cvs.savannah.gnu.org/viewvc/*checkout*/libc/debug/backtrace.c?root=libc&revision=1.1.2.1&content-type=text%2Fplain)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-05T18:05:47.277

backtrace() 函数的文档在[GNU LIBC MANUAL](http://www.gnu.org/software/libc/manual/html_node/Backtraces.html#Backtraces)中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-02T04:18:15.057

当函数调用嵌套时，堆栈向下增长并构建堆栈帧链。在程序中的任何给定点，理论上都可以将堆栈帧序列回溯到原始调用点。该`backtrace()`函数将堆栈帧从调用点导航到程序的开头，并提供一个返回地址数组。glibc 库中的实现`backtrace()`包含每个平台的特定于平台的代码。

在 x86 平台的情况下，ebp（基指针）和 esp（堆栈指针）CPU 寄存器的内容，它们保存当前堆栈帧的地址和任何给定函数的堆栈指针的地址，用于跟随指针链并向上移动到初始堆栈帧。这允许收集返回地址序列以构建回溯。

如果您想了解有关如何`backtrace()`工作以及如何使用它的更多信息，我建议您阅读***[Stack Backtracing Inside Your Program](http://www.linuxjournal.com/article/6391)*** (LINUX Journal)。

* * *

由于您提到从 x86 平台的信号处理程序执行回溯，我想添加到[Adam 的答案](https://stackoverflow.com/questions/167927/is-there-a-function-to-invoke-a-stack-dump-in-c/167959#167959)，并引导您阅读**[我对](https://stackoverflow.com/questions/77005/how-to-generate-a-stacktrace-when-my-gcc-c-app-crashes/1925461#1925461)**他链接到的问题的回复，以获取有关如何确保从信号处理程序指向的回溯的详细信息故障的实际位置。

# c# - 您将如何比较两个 XML 文档？

> ID：167946
> 
> 赞同：67
> 
> 时间：2008-10-03T17:19:34.890
> 
> 标签：c#, .net, xml, compare, xmldocument

作为一些扩展单元测试的基类的一部分，我正在编写一个帮助函数，它递归地将一个 XmlDocument 对象的节点与 C# (.NET) 中的另一个对象进行比较。对此的一些要求：

*   第一个文档是**源**文件，例如我希望 XML 文档的样子。因此，第二个是我想要找到差异的那个，它不能包含不在第一个文档中的*额外节点。*
*   当发现太多显着差异时必须抛出异常，并且应该很容易通过人类的描述来理解。
*   子元素顺序很重要，属性可以是任意顺序。
*   有些属性是可以忽略的；具体来说`xsi:schemaLocation`和`xmlns:xsi`，尽管我希望能够传递哪些是。
*   命名空间的前缀必须在属性和元素中匹配。
*   元素之间的空白是无关紧要的。
*   元素*要么*有子元素，*要么* `InnerText`有，但不能同时有。

当我一起废弃一些东西时：**有没有人写过这样的代码，可以在这里分享吗？**

顺便说一句，你会怎么称呼第一个和第二个文件？我一直将它们称为“源”和“目标”，但感觉不对，因为**源**是我希望**目标**看起来的样子，否则我会抛出异常。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-10-03T17:22:46.397

Microsoft 有一个您可以使用的[XML diff API 。](http://msdn.microsoft.com/en-us/library/aa302294.aspx)

非官方 NuGet：[https](https://www.nuget.org/packages/XMLDiffPatch) ://www.nuget.org/packages/XMLDiffPatch 。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-08-30T20:27:52.110

我今天在谷歌上搜索了一个更完整的解决方案列表，我将很快尝试其中一个：

*   [http://xmlunit.sourceforge.net/](http://xmlunit.sourceforge.net/)
*   [http://msdn.microsoft.com/en-us/library/aa302294.aspx](http://msdn.microsoft.com/en-us/library/aa302294.aspx)
*   [http://jolt.codeplex.com/wikipage?title=Jolt.Testing.Assertions.XML.Adaptors](http://jolt.codeplex.com/wikipage?title=Jolt.Testing.Assertions.XML.Adaptors)
*   [http://www.codethinked.com/checking-xml-for-semantic-equivalence-in-c](http://www.codethinked.com/checking-xml-for-semantic-equivalence-in-c)
*   [https://vkreynin.wordpress.com/tag/xml/](https://vkreynin.wordpress.com/tag/xml/)
*   [http://gandrusz.blogspot.com/2008/07/recently-i-have-run-into-usual-problem.html](http://gandrusz.blogspot.com/2008/07/recently-i-have-run-into-usual-problem.html)
*   [http://xmlspecificationcompare.codeplex.com/](http://xmlspecificationcompare.codeplex.com/)
*   [https://github.com/netbike/netbike.xmlunit](https://github.com/netbike/netbike.xmlunit)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-05-05T14:57:29.653

这段代码不能满足您的所有要求，但它很简单，我正在用于我的单元测试。属性顺序无关紧要，但元素顺序很重要。不比较元素内部文本。在比较属性时我也忽略了大小写，但您可以轻松删除它。

```
public bool XMLCompare(XElement primary, XElement secondary)
{
    if (primary.HasAttributes) {
        if (primary.Attributes().Count() != secondary.Attributes().Count())
            return false;
        foreach (XAttribute attr in primary.Attributes()) {
            if (secondary.Attribute(attr.Name.LocalName) == null)
                return false;
            if (attr.Value.ToLower() != secondary.Attribute(attr.Name.LocalName).Value.ToLower())
                return false;
        }
    }
    if (primary.HasElements) {
        if (primary.Elements().Count() != secondary.Elements().Count())
            return false;
        for (var i = 0; i <= primary.Elements().Count() - 1; i++) {
            if (XMLCompare(primary.Elements().Skip(i).Take(1).Single(), secondary.Elements().Skip(i).Take(1).Single()) == false)
                return false;
        }
    }
    return true;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-03T17:28:01.940

比较 XML 文档很复杂。Google for xmldiff（甚至还有 Microsoft 解决方案）用于某些工具。我已经解决了这几种方法。我使用 XSLT 对元素和属性进行排序（因为有时它们会以不同的顺序出现，我并不关心），并过滤掉我不想比较的属性，然后使用[XML::Diff](http://search.cpan.org/dist/XML-Diff)或[XML::SemanticDiff](http://search.cpan.org/dist/XML-SemanticDiff) perl 模块，或在单独的行上漂亮地打印每个文档，每个元素和属性，并在结果上使用 Unix 命令行差异。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-11-23T13:45:37.867

试试[XMLUnit](http://xmlunit.sourceforge.net/)。该库可用于 Java 和 .Net

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-12-20T14:15:04.320

为了比较自动化测试中的两个 XML 输出，我发现`XNode.DeepEquals`.

> 比较两个节点的值，包括所有后代节点的值。

用法：

```
var xDoc1 = XDocument.Parse(xmlString1);
var xDoc2 = XDocument.Parse(xmlString2);

bool isSame = XNode.DeepEquals(xDoc1.Document, xDoc2.Document);
//Assert.IsTrue(isSame); 
```

参考：[https ://docs.microsoft.com/en-us/dotnet/api/system.xml.linq.xnode.deepequals?view=netcore-2.2](https://docs.microsoft.com/en-us/dotnet/api/system.xml.linq.xnode.deepequals?view=netcore-2.2)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-11-07T07:08:04.683

[https://github.com/CameronWills/FatAntelope](https://github.com/CameronWills/FatAntelope) Microsoft XML Diff API 的另一个替代库。它有一个 XML diffing 算法来对两个 XML 文档进行无序比较并产生最佳匹配。

它是此处描述的 X-Diff 算法的 C# 端口：http: [//pages.cs.wisc.edu/~yuanwang/xdiff.html](http://pages.cs.wisc.edu/~yuanwang/xdiff.html)

**免责声明**：我写的:)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-11-16T14:20:41.140

我正在使用[ExamXML](http://www.a7soft.com/)来比较 XML 文件。你可以试试看。作者 A7Soft 还提供了用于比较 XML 文件的 API

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-08-30T19:20:29.150

另一种方法是 -

1.  将两个文件的内容放入两个不同的字符串中。
2.  使用 XSLT 转换字符串（它只会将所有内容复制到两个新字符串）。这将确保元素外的所有空格都被删除。这将产生两个新字符串。
3.  现在，只需将两个字符串相互比较。

这不会为您提供差异的确切位置，但如果您只想知道是否存在差异，无需任何第三方库即可轻松完成。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-09-01T12:40:12.093

与 OP 无关，因为它目前忽略子订单，但如果您想要一个仅代码的解决方案，您可以尝试[XmlSpecificationCompare](http://xmlspecificationcompare.codeplex.com/)，我[有点误导](http://formaldev.blogspot.com.au/2013/08/introducing-xml-specification-compare.html)地开发了它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-03-09T15:08:43.810

以上所有答案都很有帮助，但我尝试了[XMLUnit](https://github.com/xmlunit/user-guide/wiki/DiffBuilder)，它看起来很容易使用 Nuget 包来检查两个 XML 文件之间的差异，这里是 C# 示例代码

```
public static bool CheckXMLDifference(string xmlInput, string xmlOutput)
    {
        Diff myDiff = DiffBuilder.Compare(Input.FromString(xmlInput))
            .WithTest(Input.FromString(xmlOutput))
            .CheckForSimilar().CheckForIdentical()
            .IgnoreComments()
            .IgnoreWhitespace().NormalizeWhitespace().Build();

        if(myDiff.Differences.Count() == 0)
        {
            // when there is no difference 
            // files are identical, return true;
            return true;
        }
        else
        {
            //return false when there is 1 or more difference in file
            return false;
        }

    } 
```

如果有人想测试它，我也创建了使用它的在线工具，你可以看看这里

[https://www.minify-beautify.com/online-xml-difference](https://www.minify-beautify.com/online-xml-difference)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-09-08T12:55:18.683

基于@Two Cents 的回答并使用此链接[XMLSorting](http://www.java2s.com/Code/CSharp/XML/AlphabeticalsortingoftheXmlNodes.htm)我创建了自己的 XmlComparer

**比较 XML 程序**

```
private static bool compareXML(XmlNode node, XmlNode comparenode)
    {

        if (node.Value != comparenode.Value)
            return false;

            if (node.Attributes.Count>0)
            {
                foreach (XmlAttribute parentnodeattribute in node.Attributes)
                {
                    string parentattributename = parentnodeattribute.Name;
                    string parentattributevalue = parentnodeattribute.Value;
                    if (parentattributevalue != comparenode.Attributes[parentattributename].Value)
                    {
                        return false;
                    }

                }

            }

          if(node.HasChildNodes)
            {
            sortXML(comparenode);
            if (node.ChildNodes.Count != comparenode.ChildNodes.Count)
                return false;
            for(int i=0; i<node.ChildNodes.Count;i++)
                {

                string name = node.ChildNodes[i].LocalName;
                if (compareXML(node.ChildNodes[i], comparenode.ChildNodes[i]) == false)
                    return false;
                }

            }

        return true;
    } 
```

**对 XML 程序进行排序**

```
 private static void sortXML(XmlNode documentElement)
    {
        int i = 1;
        SortAttributes(documentElement.Attributes);
        SortElements(documentElement);
        foreach (XmlNode childNode in documentElement.ChildNodes)
        {
            sortXML(childNode);

        }
    }

  private static void SortElements(XmlNode rootNode)
    {

            for(int j = 0; j < rootNode.ChildNodes.Count; j++) {
                for (int i = 1; i < rootNode.ChildNodes.Count; i++)
                {
                    if (String.Compare(rootNode.ChildNodes[i].Name, rootNode.ChildNodes[1 - 1].Name) < 0)
                    {
                        rootNode.InsertBefore(rootNode.ChildNodes[i], rootNode.ChildNodes[i - 1]);

                    }

                }
            }
           // Console.WriteLine(j++);

    }
 private static void SortAttributes(XmlAttributeCollection attribCol)
    {
        if (attribCol == null)
            return;
        bool changed = true;
        while (changed)
        {
            changed = false;
            for (int i = 1; i < attribCol.Count; i++)
        {
                if (String.Compare(attribCol[i].Name, attribCol[i - 1].Name) < 0)
                {
                    //Replace
                    attribCol.InsertBefore(attribCol[i], attribCol[i - 1]);
                    changed = true;

                }
            }
        }
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-04-23T11:59:36.937

我使用 XSLT 1.0 解决了这个 xml 比较问题，它可用于使用无序树比较算法比较大型 xml 文件。 [https://github.com/sflynn1812/xslt-diff-turbo](https://github.com/sflynn1812/xslt-diff-turbo)

# mysql - 我应该使用 NULL 还是空字符串来表示表列中没有数据？

> ID：167952
> 
> 赞同：27
> 
> 时间：2008-10-03T17:21:13.047
> 
> 标签：mysql, database, null

Null 或空字符串——一个比另一个更好表示表列中没有数据？（我专门使用 MySQL，但我认为这是与系统无关的。）使用其中一个是否有主要优点/缺点，或者仅仅是程序员的偏好？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-05T17:22:29.620

我强烈不同意所有说无条件使用 NULL 的人。允许列为 NULL 会引入额外的状态，如果您将列设置为 NOT NULL，则不会出现这种状态。如果您不需要附加状态，请不要这样做。也就是说，如果你想不出空字符串的含义和null的含义的区别，那么将该列设置为NOT NULL，并使用空字符串来表示空。以两种不同的方式表示同一事物是一个坏主意。

大多数告诉您使用 NULL 的人还举了一个示例，其中 NULL 的含义与空字符串不同。在这些例子中，他们是对的。

然而，大多数时候，NULL 是一种不必要的额外状态，它只会迫使程序员不得不处理更多的情况。正如其他人所提到的，Oracle 不允许这种额外的状态存在，因为它将 NULL 和空字符串视为同一件事（在 Oracle 中不允许将空字符串存储在不允许 null 的列中）。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-03T17:22:37.957

空值。空字符串不是“无数据”，而是恰好为空的数据。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-03T17:24:25.723

Null 更好 "" 实际上代表数据，它不会在您的代码中注册相同

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-03T17:35:10.693

在关系数据库模型的上下文中，null 表示“无值”或“未知值”。它的存在正是您描述的目的。

更新：对不起，我忘了补充一点，虽然大多数（全部？）RDMBS 对 null 使用相同的定义，但 null 的处理方式存在细微差别。例如，MySQL 和 Oracle 允许在一个 UNIQUE 列（或一组列）中有多个空值，因为空值不是一个值，不能被认为是唯一的（空值！=空值）。但我上次使用 MS SQL Server 时，它只允许一个空值。因此，您可能需要考虑 RDBMS 行为，以及相关列是否会受到约束或索引。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-04T19:23:23.673

两者都不。将数据的缺失表示为关系中元组的缺失。

出于性能原因，您可能希望避免在某些 RDBMS 中进行连接，但尝试设计模型，以便可能丢失的信息处于单独的关系中。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-03T17:43:48.197

以下是来自 MySQL 网站的几个链接：

[http://dev.mysql.com/doc/refman/5.0/en/problems-with-null.html](http://dev.mysql.com/doc/refman/5.0/en/problems-with-null.html)

[http://dev.mysql.com/doc/refman/5.0/en/working-with-null.html](http://dev.mysql.com/doc/refman/5.0/en/working-with-null.html)

我确实读过一次，`NULL`值是 2 位，而空字符串只有 1 位。`NULL`99% 的情况下这不会有任何区别，但是在一个非常大的表中，如果或无关紧要，那么如果这是真的`''`，那么使用它可能会更好。`''`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-03T17:44:37.650

始终使用 NULL。考虑一下“我不知道这个人的电话号码是什么”（NULL）和“这个人把它留空”（空白）之间的区别。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-03T17:47:15.677

为工作使用正确的工具。NULL 可以表示（还）没有提供值，也可以表示没有值是适用的。

但是空字符串也是信息。它可以表示一个值是适用的，并且是给定的，但它恰好是一个空字符串。

允许列同时包含 NULL 和 '' 使您有机会区分这些情况。无论如何，用一个来表示另一个是不好的。

请注意，在字符串连接中，任何与 NULL 结合的东西都会产生 NULL。例如： CONCAT(NULL, 'foo') 产生 NULL。如果要将 NULL 转换为 SQL 表达式中的某个默认值，请学习使用 COALESCE() 函数。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-03T17:29:12.157

大多数时候null更好。可能在某些情况下它几乎没有什么区别，但它们很少。请记住，当您查询`field = ''`与`field is null`（至少在 MySQL 中）不同时。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-03T17:27:33.020

据我所知，甲骨文没有区别。

```
select 1 from (select '' as col  from dual) where col is null; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-03T17:30:09.767

考虑一下为什么列中没有数据。这是否意味着桌子设计马虎？尽管不喜欢空值，但有时它们是合适的（或足够合适的），并且系统通常不会死机。只是永远不允许在任何候选键（主键或备用键）中出现空值。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-04T19:26:46.023

仅为可空列和主表的外键创建一个单独的表。如果一条记录没有该列的数据，那么它在第二个表中将没有记录。这是最干净的解决方案，您不必担心处理空值或为空字符串赋予特殊含义。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-05T17:46:24.173

NULL 是一个非值，应该归入它出现的黑暗时代。我发现处理特殊的 NULL 情况需要大量的编程，这些情况可以很容易地用默认值处理。

将列的默认值设置为空字符串。强制列不允许 null，一旦您分配了默认值，这很可能永远不会发生。愉快地编写代码，忽略列值为空的情况。

对于 NULL，我一直遇到的一个大问题是“SELECT * from tbl WHERE column = NULL”将始终返回一个空的结果集。NULL 永远不能等于任何东西，包括 NULL。特殊关键字“column is null”是检查是否为 null 的唯一方法。如果你远离null，那么比较就会成功：“column = ''”返回7行。

我从头开始完成了两个主要的数据库实现，最后我后悔使用 NULL。下一次，我没有空值！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-14T15:04:20.480

有一个重要的例外。Bill Karwin 说“CONCAT(NULL, 'foo') 产生 NULL”这对于大多数 RDBMS 来说是正确的，但对于 Oracle 则不然。

正如上面 James Curran 所建议的那样，Oracle 选择了这个相当关键的时刻，通过对 NULL 和空字符串的处理完全相同来脱离标准 SQL。然而，更糟糕的是，它实际上可以通过在连接时返回 NULL 以外的值来破坏 NULL 值的含义。

具体来说，在 oracle 中 CONCAT(NULL, 'foo') 产生 'foo'。感谢 Oracle，我现在丢失了我的空值，这对你来说可能无关紧要，但当数据传递到其他 RDBMS 进行进一步处理时，肯定会有所不同。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-07-03T04:38:54.503

列中的“无数据”值应由默认值表示。请记住，NULL 表示未知值，即该列可以有值或没有值，但此时您还不知道。

例如，在贷款申请系统中，驾驶执照号码字段上的 NULL 值表示申请人或贷款处理人没有输入驾驶执照号码。NULL 值并不自动意味着申请人没有许可证。他可能有也可能没有执照，你只是不知道，这就是为什么它是 NULL。

歧义在于字符串列。如果没有值，数字列显然包含零。你怎么能表示一个没有值的字符串？在上面的示例中，对于没有驾驶执照的申请人，您可以分配任意默认值，例如“none”或更好的空字符串。只需确保您在其他表中使用默认的空值以保持一致性。

关于不使用 NULL 作为原则的问题，在某些情况下它们实际上是必不可少的。作为广泛使用统计数据的人，数据提供者通常会为您提供数据不完整的数据集。例如，在每个国家的 GDP 数据集中，您可以找到早年和晚年缺失的 GDP 数据。原因之一是该国政府没有这些年的官方数据。断定他们的 GDP 为零（DUH！）并在提取的数据或图表中显示零值是不正确的。正确的值为 NULL，这意味着您还没有数据。最终用户将提取的数据和图表中缺失的数据点正确解释为非零。此外，它不会导致计算错误，尤其是在进行平均时。

在您的情况下，一些理论上有意义的“规则”实际上是一个糟糕或不正确的解决方案。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-04-06T15:13:10.223

我发现 NULL 值有助于参照完整性。在 MySQL 的情况下，如果字段设置为 NOT NULL，则插入需要设置数据；否则，NULL 是一个可能的值，并且不强制执行外键约束。

1.  id：主键
2.  product_id：外键不为空
3.  ref_id: (NULLABLE)

id 和 product_id 区域始终需要。ref_id 可以设置为 NULL。但是，如果使用任何其他值，它必须满足 FOREIGN KEY 约束。

# php - 按即将到来的订购日期

> ID：167954
> 
> 赞同：3
> 
> 时间：2008-10-03T17:21:52.843
> 
> 标签：php, arrays, sorting

所以我建立了一系列不同的日期。生日、纪念日和节假日。我想订购接下来发生的数组，基本上是从 10 月到 9 月（包装到明年）

所以如果我的数组是

```
$a = ([0]=>"1980-04-14", [1]=>"2007-06-08", 
  [2]=>"2008-12-25", [3]=>"1978-11-03") 
```

我想对其进行排序，以便安排好

```
$a = ([0]=>"1978-11-03", [1]=>"2008-12-25", 
  [2]=>"1980-04-14", [3]=>"2007-06-08") 
```

因为 11 月的“事件”是接下来会发生的事件（基于现在是 10 月）。

我正在尝试我的 cmp 函数在哪里

```
function cmp($a, $b)
{
  $a_tmp = split("-", $a);
  $b_tmp = split("-", $b);
  return strcmp($a_tmp[1], $b_tmp[1]);
} 
```

我不确定如何修改它以获得我想要的效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T17:49:00.683

```
function relative_year_day($date) {
    $value = date('z', strtotime($date)) - date('z');

    if ($value < 0)
        $value += 365;

    return $value;
}

function cmp($a, $b)
{
    $aValue = relative_year_day($a);
    $bValue = relative_year_day($b);

    if ($aValue == $bValue)
        return 0;

    return ($aValue < $bValue) ? -1 : 1;
}

$a = array("1980-04-14", "2007-06-08",
    "2008-12-25", "1978-11-03");

usort($a, "cmp"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-03T17:33:27.563

我很想确定事件的原始年份，然后添加足够的整年，以确保该值大于您的参考日期（通常是今天的日期）。或者，可能大于或等于参考日期。然后，您可以按简单的日期顺序进行排序。

**编辑添加**：

我在 PHP 方面不够流利，无法给出答案，但这里有一个 Perl 解决方案。

```
#!/bin/perl -w

# Sort sequence of dates by next occurrence of anniversary.
# Today's "birthdays" count as low (will appear first in sequence)

use strict;

my $refdate = "2008-10-05";

my @list = (
    "1980-04-14", "2007-06-08",
    "2008-12-25", "1978-11-03",
    "2008-10-04", "2008-10-05",
    "2008-10-06", "2008-02-29"
);

sub date_on_or_after
{
    my($actdate, $refdate) = @_;
    my($answer) = $actdate;
    if ($actdate lt $refdate)   # String compare OK with ISO8601 format
    {
        my($act_yy, $act_mm, $act_dd) = split /-/, $actdate;
        my($ref_yy, $ref_mm, $ref_dd) = split /-/, $refdate;
        $ref_yy++ if ($act_mm < $ref_mm || ($act_mm == $ref_mm && $act_dd < $ref_dd));
        $answer = "$ref_yy-$act_mm-$act_dd";
    }
    return $answer;
}

sub anniversary_compare
{
    my $r1 = date_on_or_after($a, $refdate);
    my $r2 = date_on_or_after($b, $refdate);
    return $r1 cmp $r2;
}

my @result = sort anniversary_compare @list;

print "Before:\n";
print "* $_\n" foreach (@list);
print "Reference date: $refdate\n";
print "After:\n";
print "* $_\n" foreach (@result); 
```

显然，这不是非常高效 - 为了使其高效，您将计算一次 date_on_or_after() 值，然后对这些值进行排序。Perl 的比较有点奇怪 - 变量 $a 和 $b 很神奇，看起来好像是凭空出现的。

运行时，脚本会产生：

```
Before:
* 1980-04-14
* 2007-06-08
* 2008-12-25
* 1978-11-03
* 2008-10-04
* 2008-10-05
* 2008-10-06
* 2008-02-29
Reference date: 2008-10-05
After:
* 2008-10-05
* 2008-10-06
* 1978-11-03
* 2008-12-25
* 2008-02-29
* 1980-04-14
* 2007-06-08
* 2008-10-04 
```

请注意，它在很大程度上回避了 2 月 29 日发生的事情的问题，因为这样做是“有效的”。基本上，它将生成“日期”2009-02-29，它按顺序正确比较。2000-02-28 的周年纪念日将在 2008-02-29 的周年纪念日之前列出（如果 2000-02-28 包含在数据中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-03T17:34:33.300

所以我想到只要在任何小于我的目标月份的月份上加上 12。现在正在工作。

所以最终的功能

```
function cmp($a, $b)
{
    $a_tmp = explode('-', $a['date']);
    $b_tmp = explode('-', $b['date']);
    if ($a_tmp[1] < date('m')) {
        $a_tmp[1] += 12;
    }
    if ($b_tmp[1] < date('m')) {
        $b_tmp[1] += 12;
    }
    return strcmp($a_tmp[1] . $a_tmp[2], $b_tmp[1] . $b_tmp[2]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-03T17:51:08.277

使用 strtotime() 将所有日期转换为时间戳，然后再将它们添加到数组中，然后您可以将数组排序为升序（也按时间顺序）。现在您所要做的就是处理过去的日期，这很容易通过将它们与当前时间戳进行比较来完成

IE

```
for ($i=0; $i<count($a); $i++){
  if ($currentTimestamp > $a[$i]){
    unset($a[$i]);
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-07T19:48:33.840

没有理由重新发明轮子。如果您不关心密钥，则可以使用它。

```
$a = array_combine(array_map('strtotime', $a), $a);
ksort($a); 
```

或者，如果您想定义自己的回调。

```
function dateCmp($date1, $date2) {
  return (strtotime($date1) > strtotime($date2))?1:-1;
}

usort($a, 'dateCmp'); 
```

如果您想保持正确关联的键，只需调用 uasort 即可。

```
uasort($a, 'dateCmp'); 
```

我做了一个快速的速度检查，回调函数慢了一个数量级。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-03T17:30:57.113

不要比较字符串，而是使用自 1970 年以来的秒数（整数）：

```
$date1 = split("-", $a);
$date2 = split("-", $b);
$seconds1 = mktime(0,0,0,$date1[1],$date1[2],$date1[0]);
$seconds2 = mktime(0,0,0,$date2[1],$date2[2],$date2[0]);
// eliminate years
$seconds1 %= 31536000;
$seconds2 %= 31536000;
return $seconds1 - $seconds2; 
```

我也不知道 PHP，但我认为要点是正确的。

编辑：比较函数被封装来进行比较，仅此而已。要对原始问题的列表进行排序，请对包含今天日期的数组进行排序，在数组中找到今天的日期，然后按位置升序将该位置之前的元素移动到末尾。

# ant - 如何使用 Ant 将一个文件嵌入到另一个文件中？

> ID：167990
> 
> 赞同：3
> 
> 时间：2008-10-03T17:30:02.593
> 
> 标签：ant, groovy, build

我正在开发一个小型 Web 应用程序项目 (ColdFusion)，我试图在开发过程中将我的项目拆分为多个文件，但在完成时只部署一个文件。

我引用了外部文件，例如：

```
<script type="text/javascript" src="jquery-1.2.6.pack.js"></script>
<link type="text/css" rel="stylesheet" href="project.css" /> 
```

当我构建我的项目时，我希望将文件包含并嵌入到单个成品文件中。

```
<script type="text/javascript">eval(function(p,a,c,k,e,r) [...]</script>
<style type="text/css">div{font:normal;} [...]</style> 
```

无论如何，Ant 似乎没有基本的方法来做到这一点。有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-03T21:56:11.043

这是做你想做的吗？

```
<property
    name="filename"
    value="jquery-1.2.6.pack.js"
/>

<loadfile
    property="contents"
    srcfile="${filename}"
/>

<replace dir=".">
    <include name="index.cfm"/>
    <replacetoken><![CDATA[<script type="text/javascript" src="${filename}"></script>]]></replacetoken>
    <replacevalue><![CDATA[<script type="text/javascript">${contents}</script>]]></replacevalue>
</replace> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T16:54:58.567

对于纯蚂蚁的解决方案，请尝试以下操作：

```
<target name="replace">
    <property name="js-filename" value="jquery-1.2.6.pack.js"/>
    <property name="css-filename" value="project.css"/>
    <loadfile property="js-file" srcfile="${js-filename}"/>
    <loadfile property="css-file" srcfile="${css-filename}"/>
    <replace file="input.txt">
        <replacefilter token="&lt;script type=&quot;text/javascript&quot; src=&quot;${js-filename}&quot;&gt;&lt;/script&gt;" value="&lt;script type=&quot;text/javascript&quot;&gt;${js-file}&lt;/script&gt;"/>
        <replacefilter token="&lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;${css-filename}&quot; /&gt;" value="&lt;style type=&quot;text/css&quot;&gt;${css-file}&lt;/style&gt;"/>
    </replace>
</target> 
```

我测试了它，它按预期工作。在要替换的文本和您插入的值中，所有字符 '<'、'>' 和 '"' 都应引用为 <、> 和 "。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-06T17:21:14.433

经过几个小时的黑客攻击后回答我自己的问题......

```
<script language="groovy" src="build.groovy" /> 
```

并且这个 groovy 脚本将任何引用的 javascript 或 css 文件替换为文件内容本身。

```
f = new File("${targetDir}/index.cfm")
fContent = f.text
fContent = jsReplace(fContent)
fContent = cssReplace(fContent)
f.write(fContent)

// JS Replacement
def jsReplace(htmlFileText) {
    println "Groovy: Replacing Javascript includes"
    // extract all matched javascript src links
    def jsRegex = /<script [^>]*src=\"([^\"]+)\"><\/script>/
    def matcher = (htmlFileText =~ jsRegex)
    for (i in matcher) {
        // read external files in
        def includeText = new File(matcher.group(1)).text
        // sanitize the string for being regex replace string (dollar signs like jQuery/Prototype will screw it up)
        includeText = java.util.regex.Matcher.quoteReplacement(includeText)
        // weak compression (might as well)
        includeText = includeText.replaceAll(/\/\/.*/, "") // remove single-line comments (like this!)
        includeText = includeText.replaceAll(/[\n\r\f\s]+/, " ") // replace all whitespace with single space
        // return content with embedded file
        htmlFileText = htmlFileText.replaceFirst('<script [^>]*src="'+ matcher.group(1) +'"[^>]*></script>', '<script type="text/javascript">'+ includeText+'</script>');
    }
    return htmlFileText;
}

// CSS Replacement
def cssReplace(htmlFileText) {
    println "Groovy: Replacing CSS includes"
    // extract all matched CSS style href links
    def cssRegex = /<link [^>]*href=\"([^\"]+)\"[^>]*>(<\/link>)?/
    def matcher = (htmlFileText =~ cssRegex)
    for (i in matcher) {
        // read external files in
        def includeText = new File(matcher.group(1)).text
        // compress CSS
        includeText = includeText.replaceAll(/[\n\r\t\f\s]+/, " ")
        // sanitize the string for being regex replace string (dollar signs like jQuery/Prototype will screw it up)
        includeText = java.util.regex.Matcher.quoteReplacement(includeText)
        // return content with embedded file
        htmlFileText = htmlFileText.replaceFirst('<link [^>]*href="'+ matcher.group(1) +'"[^>]*>(<\\/link>)?', '<style type=\"text/css\">'+ includeText+'</style>');
    }
    return htmlFileText;
} 
```

所以我想这对我有用。它工作得很好，而且是可扩展的。绝对不是有史以来最好的 Groovy，但它是我的第一个。此外，它需要一些类路径 jar 才能编译。我不知道是哪个，但我相信它是 javax.scripting 引擎、groovy-engine.jar 和 groovy-all-1.5.6.jar*******************