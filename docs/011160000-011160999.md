# StackOverflow 问答 11160000-11160999

# ios - SSL - 哈希密码与否

> ID：11160002
> 
> 赞同：1
> 
> 时间：2012-06-22T16:06:50.230
> 
> 标签：ios, security, authentication, ssl

我对身份验证/ssl 非常陌生，尤其是与 ios 结合使用。我的问题是，如果我要发送用户名和密码，让我们说`https://server.com/login.php`我需要在 iOS 客户端中对我的密码进行哈希处理，还是我可以发布密码文本然后在将它们存储到数据库之前对其进行哈希处理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T20:20:39.163

一定要事先对它们进行哈希处理！当然，您使用的是 https，但如果您能提供帮助，最好不要以纯文本形式发送敏感信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T10:54:52.757

发送散列或明文密码本质上是相同的问题。

如果攻击者可以从客户端和服务器之间的连接中捕获数据，他可以稍后通过向服务器发送散列或明文密码来验证自己冒充客户端。

关键点是使用 HTTPS，它对客户端和服务器之间的通信进行加密，这样攻击者就无法截获客户端发送给服务的数据（哈希或密码）。

也就是说，对客户端的密码进行哈希处理是一种很好的做法，这样没有人会知道真正的用户密码（即使客户端为了可用性将哈希存储在内存中，你也不应该在任何地方存储明文密码）。

# javascript - 子 iframe 调用父 iframe，但仅在使用 jquery 完成加载时

> ID：11160004
> 
> 赞同：0
> 
> 时间：2012-06-22T16:07:35.883
> 
> 标签：javascript, jquery, iframe

我有一个包含 3 个 iframe 的网页 default.html。

第二个 iframe 像这样调用父级：

```
var someHtml = "...";
parent.setSomeHtml(someHtml); 
```

在 default.html 中，setSomeHtml 函数只是从子 iframe 中设置 html，如下所示：

```
$("#a").html(someHtml); 
```

所以这行得通，但有时它不起作用，我怀疑这是一个时间问题。

Default.html 已加载 jquery，如何确保我的调用仅在所有 iframe（和父级）已加载后发生，即 $(document).ready

这可能吗？

# r - R - 逐行迭代 csv 文件并以 5 个为一组进行求和

> ID：11160005
> 
> 赞同：1
> 
> 时间：2012-06-22T16:07:49.010
> 
> 标签：r, csv, row, infinite-loop

我有一个使用尺寸为 130、395 的 read.csv() 创建的数据结构。我试图逐行迭代数据并返回一个向量，其中包含以 5 为增量的每行总和列表的列表（仅从数据[,13:395])。我编写了以下代码，但它返回一个向量，其总和超过 5 列的间隔，它也是一个无限循环。换句话说，我试图弄清楚如何使这段代码有限并按行工作。

```
data <- read.csv(file = "Table.csv")
indexes <- c(13:395)
counter <- 0
a <- c()
list <- c()

for(line in data){
    for(index in indexes){
        while(counter<5){
            a <- c(a, line[index])
            counter = counter + 1
            }
        list <- c(list, sum(a, na.rm = TRUE))
        counter = 0
        a = c()
        }
    } 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:24:42.443

这个怎么样？

```
library(zoo)
d <- as.data.frame(matrix(1:100,nrow = 4))
> t(apply(d,1,function(x) { rollapply(x,width = 5,FUN = "mean",align = "left") }))
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20]
[1,]    9   13   17   21   25   29   33   37   41    45    49    53    57    61    65    69    73    77    81    85
[2,]   10   14   18   22   26   30   34   38   42    46    50    54    58    62    66    70    74    78    82    86
[3,]   11   15   19   23   27   31   35   39   43    47    51    55    59    63    67    71    75    79    83    87
[4,]   12   16   20   24   28   32   36   40   44    48    52    56    60    64    68    72    76    80    84    88
     [,21]
[1,]    89
[2,]    90
[3,]    91
[4,]    92 
```

出于您的目的，您只会传递列`13:365`（即类似于`d[,13:365]`而不是只是`d`）。

我现在看到我使用`mean`而不是`sum`错误地使用，但这种改变很容易做出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:38:44.383

你的意思可能是这样的：

```
lapply(1:nrow(data),function(i) rowSums(data[i:min(i+5,nrow(data)),13:395])) 
```

使用内置数据集的初始结果是：

```
 head(lapply(1:nrow(mtcars),function(i) rowSums(mtcars[i:min(i+5,nrow(mtcars)),])))
[[1]]
        Mazda RX4     Mazda RX4 Wag        Datsun 710    Hornet 4 Drive 
          328.980           329.795           259.580           426.135 
Hornet Sportabout           Valiant 
          590.310           385.540 

[[2]]
    Mazda RX4 Wag        Datsun 710    Hornet 4 Drive Hornet Sportabout 
          329.795           259.580           426.135           590.310 
          Valiant        Duster 360 
          385.540           656.920 

[[3]]
       Datsun 710    Hornet 4 Drive Hornet Sportabout           Valiant 
          259.580           426.135           590.310           385.540 
       Duster 360         Merc 240D 
          656.920           270.980 

[[4]]
   Hornet 4 Drive Hornet Sportabout           Valiant        Duster 360 
          426.135           590.310           385.540           656.920 
        Merc 240D          Merc 230 
          270.980           299.570 

[[5]]
Hornet Sportabout           Valiant        Duster 360         Merc 240D 
           590.31            385.54            656.92            270.98 
         Merc 230          Merc 280 
           299.57            350.46 

[[6]]
   Valiant Duster 360  Merc 240D   Merc 230   Merc 280  Merc 280C 
    385.54     656.92     270.98     299.57     350.46     349.66 
```

# javascript - 使用 javascript 更改 url 和修改历史记录？

> ID：11160010
> 
> 赞同：0
> 
> 时间：2012-06-22T16:07:59.097
> 
> 标签：javascript, url

> **可能重复：**
> [更改浏览器中的 URL 而不使用 JavaScript 加载新页面](https://stackoverflow.com/questions/136458/change-the-url-in-the-browser-without-loading-the-new-page-using-javascript)

我正在尝试做的示例：

用户位于`/things/list`，然后单击“新事物”，这会将他们带到`/things/new`他们为事物填写所需信息并单击保存并且 url 更改为`/things/123`，然后他们单击浏览器中的后退按钮，它会将他们带到`/things/list`而不是`/things/new`。这样的事情可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T16:24:17.310

如果从`/things/new`到的代码`/things/123`使用`window.location.replace('/things/123')`，则后退按钮将按照`things/list`您的意愿进行，因为`/things/new`在浏览器中的历史记录将在历史记录列表中被替换。

# c++ - 动态实例化一个类然后立即删除它？

> ID：11160013
> 
> 赞同：2
> 
> 时间：2012-06-22T16:08:11.350
> 
> 标签：c++, pointers, memory-management

我创建了自己的类，但是当我尝试实例化它时，我碰到了一堵墙。

这是我的代码：

```
m_interpolation = new Interpolation(m_mesureList, width, height, parent);
delete m_interpolation; 
```

这会产生错误：

> 0B3E9E40 处的堆块在 0B3E9E68 处修改，请求大小为 20

我不明白我做错了什么......

这里的信息是我的类[Interpolation.h](http://pastebin.com/FMVWZwdj)和[Interpolation.cpp](http://pastebin.com/HeJAHtt4)的完整定义，如果有帮助的话。

添加了一个析构函数，但仍然没有解决问题。

```
Interpolation::~Interpolation()
{
    delete m_progress;
    m_progress = 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T16:25:52.130

在ctor中：填充`m_w`：最多`(m_N-1)`

```
for (int i(0); i < m_N; ++i)
{
    m_pt.push_back(QPointF(mesureList[i]->getX(), mesureList[i]->getY()));
    m_w.push_back(mesureList[i]->getAngle());
} 
```

稍后：访问`m_w[m_N]`, 超出向量的末尾

```
for (i = m_N; i >= 0; --i)
{
    sum = m_w[i];
    for (j = i+1; j < m_N; j++) sum -= LU[i][j]*m_w[j];
    m_w[i] = sum / LU[i][i];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:13:17.393

构造函数 Interpolation::Interopolation() 或析构函数 Interpolation::~Interpolation() 中的某些内容超出了对象的大小。

# android - 如何在android中的Library项目中使用项目布局

> ID：11160015
> 
> 赞同：2
> 
> 时间：2012-06-22T16:08:23.560
> 
> 标签：android

我正在开发一个包含库项目的 android 应用程序，我可以在我的主项目中使用库项目的资源（即布局、样式等）。但我想在我的图书馆项目中使用我的主要项目的资源。有没有办法做到这一点？我被这个问题困扰了很长一段时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T16:13:51.457

您可以在库项目中创建虚拟资源，并且主项目中具有相同名称的任何内容都将覆盖它。

例子：

**LibProject/res/values/strings.xml：**

```
<string name="greeting">Hello from Library Project</string> 
```

**MainProject/res/values/strings.xml：**

```
<string name="greeting">Hello from App Project</string> 
```

然后，无论您在哪里使用`R.string.greeting`，甚至在您的库项目中，都将使用主项目中的值。

从[文档](http://developer.android.com/tools/projects/projects-eclipse.html)：

> 应用程序本身具有最高优先级，并且其资源始终优先于库中定义的相同资源 ID 使用。

# joomla - Joomla 2.5 所有链接都显示主页

> ID：11160016
> 
> 赞同：-3
> 
> 时间：2012-06-22T16:08:24.020
> 
> 标签：joomla

我有 joomla 2.5 它显示了很多错误。

1.  所有链接甚至错误页面也显示主页。
2.  安装扩展时出现错误消息“无法移动文件”。
3.  无法重写configuration.php

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:18:35.760

您遇到了服务器配置/设置/权限问题，我很惊讶您在安装 Joomla 时没有收到任何警告。我首先会非常仔细地查看[http://www.joomla.org/technical-requirements.html](http://www.joomla.org/technical-requirements.html)，然后查看您的服务器/主机上缺少什么或有所不同。一旦完成（配置可写性将是第一条线索），Joomla 将能够正常运行。但是，您很可能必须重新安装，因为由于您的权限，某些步骤可能无法正确完成。

# windows - 在文件前面插入文本

> ID：11160017
> 
> 赞同：3
> 
> 时间：2012-06-22T16:08:24.160
> 
> 标签：windows, batch-file

如何使用 BAT 文件中的命令在已存在的文件开头插入文本？

如果你愿意，可以嘲笑我，但我的谷歌搜索技巧让我失望了：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T16:36:10.323

如果插入的文本已存在于文件中，则JimR[解决方案有效。](https://stackoverflow.com/a/11160116/1012053)

通过将新文件移动到旧名称，您可以在功能上使其与编辑原始文件相同。

如果要插入的文本尚不存在于文件中，则可以执行以下操作：

```
>originalFile.txt.new (
  echo New line of text
  echo A blank line follows this one
  echo(
  echo Another line of text
  type originalFile.txt
)
move /y originalFile.txt.new originalFile.txt 
```

如果您需要在现有第 1 行的前面插入文本，则：

```
>originalFile.txt.new (
  <nul set /p "=Prefix to insert in line 1: "
  type originalFile.txt
)
move /y originalFile.txt.new originalFile.txt 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T16:14:43.367

AFAIK 您不能在 Windows 上使用批处理文件语言在文件开头插入。但是，你可以把你的新东西放在一个文件中并使用

```
copy /b <beginningfile> + <endfile> <newfile> 
```

创建您所追求的文件。

# c# - 等待线程完成

> ID：11160021
> 
> 赞同：5
> 
> 时间：2012-06-22T16:08:32.827
> 
> 标签：c#

```
 private void button1_Click(object sender, EventArgs e)
    {
        for (int i = 0; i < 15; i++)
        {
            Thread nova = new Thread(Method);
            nova.Start();
        }
        listBox1.Items.Add("Some text");
    }

    private void Method()
    {
        for (int i = 0; i < 15; i++)
        {
            Console.WriteLine(i);
        }

    } 
```

这段代码确实写了：一些文本，然后是数字 111222333 .....我希望它写 111122223333.... 然后最后是一些文本。是否可以使用线程（父线程等待子线程）来做到这一点？还是我必须使用其他东西？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-22T16:10:29.400

您需要跟踪所有线程，并`Thread.Join`在每个线程上使用。这会等到指定的线程终止，然后继续执行。像这样：

```
var threads = new List<Thread>();
for (int i = 0; i < 15; i++)
{
    Thread nova = new Thread(Method);
    nova.Start();
    threads.Add(nova);
}
foreach (var thread in threads)
    thread.Join();
listBox1.Items.Add("Some text"); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-22T16:23:55.640

我建议使用 TPL 来完成这项工作。你不需要产生这么多线程。默认情况下，TPL 将为此使用线程池：

```
using System;
using System.Threading.Tasks;

namespace ConsoleApplication1
{
    class Program
    {
        private const int TaskCount = 15;

        static void Main(string[] args)
        {
            var tasks = new Task[TaskCount];
            for (var index = 0; index < TaskCount; index++)
            {
                tasks[index] = Task.Factory.StartNew(Method);
            }
            Task.WaitAll(tasks);

            Console.WriteLine("Some text");
        }

        private static void Method()
        {
            for (int i = 0; i < 15; i++)
            {
                Console.WriteLine(i);
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T16:13:16.660

你可以有两个线程，第二个等待信号从第一个触发。

```
private void Foo()
{
  var signals = new List<ManualResetEvent>();

  for (int i = 0; i < 15; i++)
  {
    var signal = new ManualResetEvent(false);
    signals.Add(signal);
    var thread = new Thread(() => { Method(); signal.Set(); });
    thread.Start();
  }

  var completionTask = new Thread(() =>
  {
    WaitHandle.WaitAll(signals.ToArray());
    CompletionWork();
  });
  completionTask.Start();

}

private void Method()
{
}

private void CompletionWork()
{
} 
```

现在使用 .Net 4.0（及更高版本）的更好解决方案是使用任务，并使用以下方法调用方法`ContinueWith`

```
private void Foo()
{
  var childThreads = new List<Task>();
  for (int i = 0; i < 15; i++)
  {
    var task = new Task(Method);
    task.Start();
    childThreads.Add(task);
  }

  var completionTask = new Task(() => 
  { 
    Task.WaitAll(childThreads.ToArray());
  }).ContinueWith(t => CompletionWork());

}

private void Method()
{
}

private void CompletionWork()
{
} 
```

连接答案也有效，但需要包含线程阻塞。如果您不希望 GUI 阻塞，请在 1 号附近生成一个附加线程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T16:11:17.077

您可以使用 thread.join 等待线程结束。有关如何使用它的页面，请参见[http://www.dotnetperls.com/thread-join 。](http://www.dotnetperls.com/thread-join)

# javascript - rapheal js Element.node.onclick() 和 Element.click()

> ID：11160024
> 
> 赞同：0
> 
> 时间：2012-06-22T16:08:42.077
> 
> 标签：javascript, jquery, raphael

你好我刚开始使用`Raphael`，但我对下面的代码很困惑

**为什么**此代码有效

```
 var paper = Raphael("canvas_container", 320, 200);
            var mycir = paper.circle(50, 40, 30);
            mycir.node.onclick = function() { alert("any thing") } 
```

**这**不

```
 var paper = Raphael("canvas_container", 320, 200);
            var mycir = paper.circle(50, 40, 30);
            mycir.click = function() { alert("any thing") } 
```

我也试过了，但没有用：

```
 mycir.click(function(){alert("any thing")}); 
```

有什么区别？当我查看他们使用的拉斐尔文件时`Element.click()`。为什么我不能使用它们，这是我的版本还是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:38:35.993

问题是您试图分配给点击，而不是调用它。这应该有效：

```
 var paper = Raphael("canvas_container", 320, 200);
        var mycir = paper.circle(50, 40, 30);
        mycir.click(function() { alert("any thing") }); 
```

请注意，Raphael 建议不要使用`.node`（正如它所说：“不要乱用它。”）

# google-places-api - 如何从搜索中获取更合适的 Places 图标

> ID：11160030
> 
> 赞同：0
> 
> 时间：2012-06-22T16:09:23.107
> 
> 标签：google-places-api

我正在对“types=cafe”和“keyword=Coffee%20Shops”进行特定搜索，大多数机构返回的图标是“restaurant”（叉子和勺子）图标。有没有办法格式化接收“咖啡”图标的请求，这是一个咖啡杯图像？这是 url 搜索字符串：

[https://maps.googleapis.com/maps/api/place/search/json?location=42.25850666666667,-87.94816&sensor=false&rankby=distance&keyword=Coffee%20Shops&types=cafe&key=mykey](https://maps.googleapis.com/maps/api/place/search/json?location=42.25850666666667,-87.94816&sensor=false&rankby=distance&keyword=Coffee%20Shops&types=cafe&key=mykey)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T14:51:11.700

返回更多类型或其他类型的错误何时修复，这很关键

即： [https ://maps.googleapis.com/maps/api/place/search/json?location=42.25850666666667,-87.94816&sensor=false&rankby=distance&types=cafe&key=mykey](https://maps.googleapis.com/maps/api/place/search/json?location=42.25850666666667,-87.94816&sensor=false&rankby=distance&types=cafe&key=mykey)

返回其他类型，如“商店”、“咖啡馆”、“食物”、“机构”，为什么不只是咖啡馆，如果我想要更多，我应该要求更多，比如 types=cafe|store..

谢谢你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T03:55:33.687

我已将此报告为错误，应尽快修复。

同时，您可以将[http://maps.gstatic.com/mapfiles/place_api/icons/cafe-71.png](http://maps.gstatic.com/mapfiles/place_api/icons/cafe-71.png)用于任何具有 type 的地方`cafe`。

# php - Zend PHP - 将 Google 图表另存为 PDF

> ID：11160032
> 
> 赞同：1
> 
> 时间：2012-06-22T16:09:36.450
> 
> 标签：php, ajax, zend-framework, fpdf, google-visualization

我正在使用 Zend PHP 框架开发一个站点。在一个页面上，我有一个使用 Google Chart API - [https://developers.google.com/chart/](https://developers.google.com/chart/)创建的图表。我想添加一个按钮以允许用户将图表下载为 PDF 文件（基本上将图表转换为图像并将其嵌入 PDF 中）。

我已经能够使用生成图像数据字符串的 javascript 函数将谷歌图表转换为图像 - [http://www.battlehorse.net/attach/topics/charts/google_charts_to_image.html](http://www.battlehorse.net/attach/topics/charts/google_charts_to_image.html)

```
function getImgData(chartId) {
    var chartContainer = document.getElementById(chartId);
    var chartArea = chartContainer.getElementsByTagName('iframe')[0].
    contentDocument.getElementById('chartArea');
    var svg = chartArea.innerHTML;
    var doc = chartContainer.ownerDocument;
    var canvas = doc.createElement('canvas');
    canvas.setAttribute('width', chartArea.offsetWidth);
    canvas.setAttribute('height', chartArea.offsetHeight);   
    canvas.setAttribute(
        'style',
        'position: absolute; ' +
        'top: ' + (-chartArea.offsetHeight * 2) + 'px;' +
        'left: ' + (-chartArea.offsetWidth * 2) + 'px;');
    doc.body.appendChild(canvas);
    canvg(canvas, svg);
    var imgData = canvas.toDataURL("image/png");
    canvas.parentNode.removeChild(canvas);
    return imgData;
} 
```

我还下载了一个免费的 PHP 类来处理生成 PDF - [http://www.fpdf.org/](http://www.fpdf.org/)

我已经能够使用 ajax 函数将图像数据字符串传递给 zend 控制器。然后我可以将图像保存在本地，并使用它来构建 PDF 文件并将其保存在本地。

```
//store the image locally
    $data = substr($image,strpos($image,",")+1); //removing the "data:image/png;base64," part
    file_put_contents ('downloads/'.$title.'.png', base64_decode($data));

    // create PDF document
    $pdf = new FPDF();
    $pdf->AliasNbPages();
    $pdf->AddPage();
    $pdf->Image('downloads/'.$title.'.png',10,6,30);

    //destroy the local copy of the image
    fclose('downloads/'.$title.'.png');
    unlink('downloads/'.$title.'.png');

    //save the PDF document
    $pdf->Output('downloads/'.$title.'.pdf'); 
```

我现在卡住了，因为我找不到提供 PDF 文件以供下载的方法。我需要使用 Ajax 请求来生成 PDF，因为图像数据字符串对于标准 URL 来说太长了。所以我认为我需要在生成文件后将用户重定向到文件的下载链接（然后再将其删除）。

有谁知道我如何提供文件以供下载，如果我在浏览器中输入文件路径，我会收到找不到路径的错误（例如“MyApp/public/downloads/myChart.pdf”）。我已经在几个地方阅读了如何在控制器中设置响应的标题和正文，但到目前为止没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:13:24.940

当您生成下载链接时。为什么不将 yourpath/public 替换为 domain.com？假设你的PDF是在目录public/downloads/blahblah中生成的

可能下一步会像

$path = '下载/'.$title.'.pdf';

Header("位置：[http](http://domain.com) ://domain.com .$path");

现在当用户使用 Ajax 调用这个脚本文件时，将生成 PDF 并将位置转移到 pdf 的路径！

# css - 使用 css sprite 而不是更改背景 url 的好处

> ID：11160033
> 
> 赞同：0
> 
> 时间：2012-06-22T16:09:36.677
> 
> 标签：css

我一直在使用纯 css 处理翻转图像，我知道有两种解决方案可以达到预期的效果。我想知道这些方法是否有任何我不知道的好处，以及是否有首选方法或者只是一种偏好（我只是想在完成一个巨大的项目之前确保没有任何意外）

**第一种方法**

我遇到的第一种方法是将多个图像保存为一个图像。然后将图像设置为分隔线的背景（小于整个图像）然后`:hover`将背景位置设置为负值并出现其他图像

我想到的一些缺点和优点是：

**优点**

*   您不需要手动预加载图像（通过将代码放在 css 文件的末尾）

*   组织图像文件可能更容易，因为它们可能会更少

**缺点**

*   很难知道图像到底移动了多少，特别是如果您有单独的团队设计图形

**第二种方法**

我遇到的第二种方法是设置分隔线的图像背景，然后更改背景网址`:hover`

我能想到的一些缺点和优点：

**优点**

*   开发时间可能更少

*   可以更轻松地交换翻转图像并且不需要指定分隔线的大小

**缺点**

*   需要在css文件末尾预加载图片

*   如果你有很多文件，你的图像文件夹可能会更乱

我有什么优点或缺点吗？一种方法通常优于另一种方法，为什么？或者是个人选择，使用任何一个都没有问题？

**更新：** [这](http://blog.weareakta.com/2011/12/quick-tip-how-to-preload-images-with-pure-css/)是使用纯 css 的第二种方法的简单预加载的链接。我认为有一种更简单的方法（只是放置链接），但我找不到它。这仍然是非常基本的。

**更新（2）：** 我了解到精灵有额外的

*   通过减少 http 请求的数量使网站更快的好处。

*   并且翻转的好处是尽可能快而没有闪烁

*   还有一个错误是使网站的可访问性降低，并且会限制 HTML 中 title 和 alt 属性的潜在好处。（如果不正确地用于所有图像，而不仅仅是装饰和按钮）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:17:10.973

CSS sprites（第一种方法）通常受到青睐，因为预加载对于保持高质量的用户体验不是必需的。

Wex 发布的 ALA 链接很好地介绍了精灵的好处，Smashing Magazine 最近发表了一篇文章，解决了您在使用带有许多图像的精灵时对背景位置的担忧

[http://coding.smashingmagazine.com/2012/04/11/css-sprites-revisited/](http://coding.smashingmagazine.com/2012/04/11/css-sprites-revisited/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:14:01.573

第一种方法比第二种方法好得多。您不必总是将每张图像捆绑成一张巨大的图像——这通常会导致添加新图像变得困难——但将每张图像及其悬停状态放在同一张图像中确实有意义，这样你就不会看到悬停时闪烁，因此您不必依赖某些预加载脚本。

这是一篇很好的文章，讨论了使用 CSS sprites 的好处：[http ://www.alistapart.com/articles/sprites](http://www.alistapart.com/articles/sprites)

# java - 如何将 int 和 boolean 存储为一对

> ID：11160034
> 
> 赞同：1
> 
> 时间：2012-06-22T16:09:39.587
> 
> 标签：java, memory-management, primitive-types

我们在几个类中有许多属性，这些属性目前是一个 int 和一个 boolean。int 是值，如果该 int 已设置，则布尔值为 true。

我们需要这种配对，因为我们表示一个具有多个属性级别的对象，如果它没有设置在一个级别，它会使用上面级别的设置。这种方法让我们可以在每个级别记录它的值是什么，以及它是在该级别设置还是继承。

它工作得很好。然而，我们最终可以得到 100,000 个这样的对象。那是大量的内存，大量的垃圾收集等等。所以，任何想法我们可以如何以某种方式更好地做到这一点。我们查看了以枚举为索引的整数和布尔数组。但这感觉真的很尴尬，这通常意味着有更多的机会出错（即引入错误）。

有什么建议么？

谢谢 - 戴夫

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T16:12:31.830

如果您没有使用 的全部范围，则`int`可以使用类似`Integer.MIN_VALUE`或的魔术值`-1`来表示“未设置”。

这方面的一个例子是 String 的方法，如果它没有找到匹配项`indexOf()`，它将返回。`-1`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T16:14:59.163

整数是否为正且按顺序排列（或者，如果不按顺序排列，它们不会达到巨大的值）？即 1,2,3,4...99999,100000？

如果是这样，您可以使用[java.util.BitSet](http://docs.oracle.com/javase/7/docs/api/java/util/BitSet.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-22T16:22:58.417

这里的大多数答案已经涵盖了我最初的建议，但如果这只是垃圾收集器压力而不是太多内存占用的问题，并且您确实需要完整的 32 位整数，您可以应用相同类型的位掩码用长招代替。

您将拥有一个具有以下功能的实用程序类

```
long setIntValue(int i) { return 0xFFFF0000 | i; }
int getIntValue(long l) { return (int)(0xFFFF & l); }
boolean isIntValueSet(long l) { return (0xFFFF0000 & l) != 0; } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-22T16:14:48.523

想到2个可能性，

*   使用`Integer`对象并使用`null`引用来指定该值尚未设置。
*   如果`int`s 值范围不跨越整个范围，您可以选择一个值，例如`Integer.MIN_INT`指定该值尚未设置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-22T16:25:18.893

你可以上一堂课

```
public class Tuple<X,Y>{
    private final X x;
    private final Y y;

    public Tuple(X x,Y y){
        this.x=x;
        this.y=y;
    }

    public X getX(){
        return x;
    }

    public Y getY(){
        return y;
    }

} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-22T16:26:45.513

每个具有 100K 元素的 int[] 和 boolean[] 将使用大约 500K 的内存（并且是两个对象）

您也可以使用一个`int`值来存储标志。但是，如果这不是一个选项，您可以使用 a`long`可以存储所有可能的 int 和 boolean 值。

您可以使用像 an 或什至 an and a 这样的集合`int[]`，`long[]`即将`int[]`数据`boolean[]`存储在基于列而不是基于行的结构中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-22T16:28:42.317

只需[`Pair<L,R>`](http://commons.apache.org/lang/api/org/apache/commons/lang3/tuple/Pair.html)从 apache.commons.lang 使用。您正在进行[过早的优化](http://c2.com/cgi/wiki?PrematureOptimization)，但没有任何事实证明这些对确实存在性能/内存问题。

# sql - 将日期从 varchar 转换为日期

> ID：11160038
> 
> 赞同：0
> 
> 时间：2012-06-22T16:09:50.673
> 
> 标签：sql, sql-server

我正在尝试更改列的日期格式，该列设置为 varchar 列名日期时间。问题是我实际上无法更改数据类型，因为数据是由自动化端的 PLC 自动输入的。我需要日期或数值中的日期，因为当我运行查询时，我需要给系统一个日期范围。我正在尝试使用子字符串来解决此问题，但收到一条错误消息，指出数据类型超出范围。这是我的查询的语法。

```
select cast(
     (substring(datetime, 1, 4) + '-' +
      SUBSTRING(DateTime, 5, 2) + '-' + 
      SUBSTRING(DateTime, 7, 2) + ' ' + '00:00:00.000') as dateTime) as "Date"
    , ID1
    , ID2
    ,  diameter
    , WeightTheoretical
    , WeightActual
    , StockType 
from table1 
where datetime is not null 
    and datetime <> '' 
    and datetime <> '0' 
order by "Date", ID1; 
```

编辑-日期格式是这样的 20120622:00:00:00:000

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:14:31.833

假设您的日期是 format `yyyymmdd`，您可以将 varchar 转换为 datetime ，如下所示：

```
select convert(datetime, columname, 112) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T16:15:15.143

从您的 SQL 中可以看出，您的日期字符串的格式为`YYYYMMDD`

使用`CAST`or`CONVERT`函数应该可以很好地转换：

例如

```
SELECT CONVERT(datetime,'20120601')
SELECT CAST('20120601' as datetime) 
```

两者都将预期值作为日期时间返回。

编辑：根据您指定的提供格式，我将使用 将`SubString`提供的数据稍微切下：

例如

```
SELECT CONVERT(datetime,SUBSTRING('20120601',1,8)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:19:19.900

根据表 ( `20120622:00:00:00:000`) 中数据的格式，您可以执行以下操作：

```
declare @date varchar(50)
set @date = '20120622:00:00:00:000'

select cast(left(@date, 8) as datetime) 
```

或者

```
select convert(datetime, left(@date, 8)) 
```

结果：

```
2012-06-22 00:00:00.000 
```

# python - Python 中的文件扫描守护进程 (OS X)

> ID：11160042
> 
> 赞同：1
> 
> 时间：2012-06-22T16:09:56.273
> 
> 标签：python, macos, filesystems

我目前正在使用Python的功能，

```
os.walk('/') 
```

在 OS X 上循环遍历我的整个文件系统。我的目标是制作一个个人守护进程来跟踪：

1.  新制作的文件/目录
2.  调整/触摸的文件/目录
3.  已删除的文件（可能）

**这个想法**

这更像是一个预防功能，我想添加到我的 Mac 中，以便能够查看奇怪的东西是否被放置在我不需要的目录中，所以如果我的 Mac 曾经被某些（但未知的）木马感染，我可能已经自己检测到了. 此外，我正在考虑稍后添加功能，以便在检测到某些问题时关闭我的互联网连接等。这可能是一个不合理的功能，但由于它只是一个个人脚本，我认为它还不错：P。

**我想要达到的目标**

所以我的主要问题是。第一次运行后，我将保存整个文件系统及其元数据（创建数据、修改日期）的数组。之后，我希望守护程序以“监视”模式在后台运行，实际上是用新循环的文件系统镜像文件系统的最后一个已知存储数组。现在的问题是，当我运行脚本来测试它时，我的 CPU 开始烧毁，一段时间后我的 MacBook 开始打嗝。我想在我的 for 循环中的每个目录步骤“os.walk()”之间添加睡眠。我的问题是：什么是正确的睡眠时间？我的 MacBook 的磁盘工具说我有 183.867 个文件夹和 1.013.320 个文件，总共有 1.197.187 个条目（因为文件夹实际上也是文件）。所以将我的代码设置为：

```
time.sleep(0.001) 
```

.. 大约需要 2 分钟处理这 120 万个条目。我不知道这是否好，我更喜欢根据文件/文件夹总数使其更加动态。

**一个额外的功能** 根据我的问题，我注意到 OS X 磁盘实用程序已经知道我的文件和文件夹总数。Python 也可以在不进行极端循环的情况下获取这些数据吗？也许调用 OS X 内置的终端功能。这样，如果使用小 GUI 来显示守护程序的状态，我也可以保留一个指示器。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:13:39.807

这不是直接的答案，而是针对跟踪的要求：

```
Newly made files/dirs
Adjusted/touched files/dirs
Deleted files (maybe) 
```

您可以使用：[http](http://pyinotify.sourceforge.net/) ://pyinotify.sourceforge.net/ ，它与 inotify 相关联，将发送有关文件更改、删除和创建的事件。这将避免遍历大型目录。

[这是Inotify](http://en.wikipedia.org/wiki/Inotify)的包装。这适用于 Linux。我还看到 fink 和 macports 中有用于 OSX 的库和模块。所以这应该是更优雅的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T17:37:05.637

不是一个完整的答案，而是一些指示：

对于 OSX，[fseventsd](http://en.wikipedia.org/wiki/FSEvents)实现了类似于 inotify 的机制。[fslogger](http://osxbook.com/software/fslogger/)是一个如何使用它的例子。[pymacadmin](http://code.google.com/p/pymacadmin/)似乎允许您从 Python 接口它。

您要实现的与[Tripwire](https://trac.macports.org/browser/trunk/dports/security/tripwire/Portfile)类似。

# c# - 对象上的 IQueryable 集合惰性属性设置

> ID：11160050
> 
> 赞同：2
> 
> 时间：2012-06-22T16:10:26.240
> 
> 标签：c#, linq, linq-to-sql, collections, iqueryable

我有以下代码：

```
var carsContext = new CarsDataContext();

IQueryable<Car> allCars = carsContext.Cars;

foreach (var car in allCars) 
    Console.WriteLine(car.Color); 
```

我希望每个汽车对象都知道用于检索它的原始数据上下文，以便我可以使用如下辅助方法来装饰它：

```
foreach (var car in allCars)
    Console.WriteLine(car.GetOwner().Lastname); 
```

GetOwner() 方法能够自动为下一个数据库重用原始数据上下文，而现在我必须做一些丑陋的事情才能获得相同的效果：

```
foreach (var car in allCars)
{
    car.SetDataContext(carsContext);
    Console.WriteLine(car.GetOwner().Lastname);
} 
```

这些信息是否已经可供对象使用，或者我应该尝试制作一个自定义 IQueryable 实现，以便在从集合中检索对象时为我自动分配此信息？

我正在尝试这样做，因为出于性能原因（我有大型数据集），我想将针对数据库的表达式的延迟评估保留为 SQL。

任何建议表示赞赏，谢谢。

编辑：这是简化的示例，例如对原始数据上下文的引用不一定立即可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:31:02.283

你用的是EF吗？当您最初获得汽车实体时，您可以执行 .Include(c => c.Owner) 。延迟加载被保留，但现在您将获得 Owner 实体以及 Car。此外，当您执行 1 个连接查询而不是为每个汽车实例返回数据库 100 次时，它可能会提高性能。

# java - 如何使用 Rhino shell 将 JavaScript 代码序列化为文件？

> ID：11160058
> 
> 赞同：0
> 
> 时间：2012-06-22T16:11:00.327
> 
> 标签：java, javascript, serialization, rhino

我在 Ant 构建过程中使用 Rhino 来捆绑和缩小 JavaScript。除此之外，我还想预编译客户端模板，即将它们从标记编译为 JavaScript。乍一看，我认为 Rhino 的 serialize() 方法可以做到这一点，但事实并非如此。

```
// Load templating engine
load( "engine.js" );

// Read template file
var template = readFile( "foo.template" ),

// Compile template
compiled = engine.compile( template );

// Write compiled template to file
serialize( compiled, "compiledFoo.js" ); 
```

这将导致写入二进制文件。我想要的是一个包含已编译模板的文本文件。

如果使用 serialize() 不是答案，那是什么？因为是 Rhino，所以也可以导入 Java 类。副手，我想不出办法。

我知道这可以在 Node 中完成，但我现在无法将构建过程从 Ant-Rhino 迁移到 Grunt-Node。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T18:20:24.187

在我寻找答案的过程中，我[发现](http://movieos.org/blog/2006/uneval-does-not-produce-json/)了这样一个事实：Rhino 的 C/C++ 姐妹 SpiderMonkey 有一个`uneval()`函数，你可以猜到它的作用与 JavaScript 的`eval()`函数相反。后来又谷歌一搜，[发现](http://www.mozilla.org/rhino/rhino15R5.html)Rhino`uneval()`是在1.5R5中实现的。这可能是**唯一**提到 Rhino 具有此功能（[或没有](http://kangax.github.io/es5-compat-table/non-standard/)）的文档。

话虽这么说，这里是解决方案：

```
// Load the templating engine
load( "engine.js" );

// Read the template file
var template = readFile( "foo.template" ),

// Compile the template markup to JavaScript
compiled = engine.compile( template ),

// Un-evaluate the compiled template to text
code = uneval( compiled ),

// Create the file for the code
out = new java.io.FileWriter( "foo.js" );

// Write the code to the file
out.write( code, 0, code.length );
out.flush();
out.close();

quit(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T20:21:40.233

在 javascript 中编写一个可以从 Java 调用的函数，该函数将您需要的值作为字符串返回。

# php - 组合框加载太慢

> ID：11160059
> 
> 赞同：1
> 
> 时间：2012-06-22T16:11:13.860
> 
> 标签：php, extjs, combobox, extjs4

我的页面现在加载速度非常慢。基本上，我想预先填充我拥有的组合框。现在，它单独预填充每个，然后选择默认值。这太慢了。在页面完全加载之前，用户将不得不等待大约一分钟。

我正在获取值以从服务器填充组合框。预先选择组合框值的值通过响应变量在数组中接收。我如何加快整个过程？

代码如下：

# EXTJS

```
 xtype: "combo",
                    width: 250,
                    id: "nameId",
                    name: "comboName",
                    labelStyle: 'width:100px',
                    fieldLabel:"Name",
                    allowBlank: true,
                    displayField: "nameDisplay",
                    valueField: "nameValue",
                    url: "/thelink/toGetAllComboboxValues/fromPHPFile/",

return {
    init: function (args) {

        formPanel.on({

            beforerender: function () {

                Ext.Ajax.request({
                    url: 'url/to/another/PHP/file/',
                    scope: this,
                    method: 'GET',
                    params: {
                        code_id: 'myUser',
                        number: '12345'
                    },

                    success: function (response, opts) {
                        var result = Ext.decode(response.responseText);
              Ext.getCmp('nameId').setValue(result.Name);

                    },

                });

            },

            scope: this
        });

      //add form panel here
    },

    getFormPanel: function () {

        return formPanel;
    },

    // load parameter values into the form
    loadParams: function () {

    },
    goHome: function () {

    },

};
}(); 
```

# PHP 获取组合框值

```
//makes call to server for each individual combo box values 
```

# PHP 获取预选值

```
//grabs all pre-selected values based on an ID and puts them in an array 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T18:51:57.700

如果您的每个商店的记录少于 300 条，并且您的页面上并没有真正“那么多”商店，那么您应该立即从 php 中返回所有内容（或者最好在页面加载时加载所有商店本身，但听起来你不能这样做）。因此，与其在一个 ajax 调用中获取组合框中所选项目的值，不如把它想象成这样：

为每个商店定义模型：

```
Ext.define("MyModel1", {
    extend: "Ext.data.Model",
    fields: [
        {name:"field_code", type:"string"},
        {name:"field_value",      type:"string"}
    ]
}); 
```

然后以非常简单的方式定义您的每个商店，请注意我省略了您当前可能包含的读取器和代理，为了提高性能，请使用 Ext.data.ArrayStore 因为它消除了记录中每个项目的必要性有一个命名属性（这减少了从服务器返回的文本以及前端的解析时间）：

```
var myStore = Ext.create("Ext.data.ArrayStore", {
    model: "MyModel1",
    data:  []
}); 
```

现在在您已经定义的 ajax 请求中，将来自 php 的所有数据作为返回的 json 对象中的属性添加到商店的响应中，并将它们作为数组数组执行，以确保元素顺序与您定义 Ext.data 的方式相匹配。模型。我的示例的返回对象看起来像这样（数据是数组数组）：

```
{
    my_combobox_value1: "CAD",
    my_combobox_data1: [
        ["CAD","Somthing for display of this record"],
        ["AN","Another Entry]
    ]
} 
```

然后将 ajax 请求更改为如下所示：

```
Ext.Ajax.request({
    url: 'url/to/another/PHP/file/',
    scope: this,
    method: 'GET',
    params: {
        code_id: 'myUser',
        number: '12345'
    },

    success: function (response, opts) {
         var result = Ext.decode(response.responseText);
         myStore.loadData(result.my_combobox_data1);
         Ext.getCmp('nameId').setValue(result.my_combobox_value1);
         ... and rinse and repeat for all stores, make sure you set the value for each combobox after the store has been loaded :)
    },

}); 
```

这将为您提供适合您情况的最佳性能。如果这不起作用，您将不得不使用代理商店来处理服务器端的所有内容并根据需要加载数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:02:10.670

首先，我建议不要检索每个组合的完整值列表，直到用户需要它（更改值或单击触发器时）。您可以通过为您的组合提供一个设置了指向您的 URL 的代理的商店来做到这一点。

为了节省显示的初始单值，一种选择是将字符串值以及 id 存储在您的记录中（或者可能不存储它，例如，但无论如何将其发送给客户端）。但是，这并不是那么好，并且在摆脱完整的列表请求后加载时间可能会足够快。如果不是，请尝试查看是否可以请求所有单个值显示在一个请求中。

# .net - 使用 mstest，我可以针对我支持的每种语言运行我的单元测试套件吗？

> ID：11160062
> 
> 赞同：5
> 
> 时间：2012-06-22T16:11:22.863
> 
> 标签：.net, unit-testing, internationalization, continuous-integration, mstest

我们使用 .resx 文件将我们的应用程序国际化为多种语言。我们的自动化单元测试在它们自己的程序集中，我们从 CI (Jenkins) 中的命令行在该项目上运行 mstest，如下所示：

> mstest.exe /testcontainer:unittests.dll /category:"!TemporaryExclude" /resultsfile:UnitTests.trx

我们发现如果在设置为我们的非英语支持文化之一的机器上运行特定单元测试会失败的情况。我们希望我们的 CI 针对每种文化运行单元测试，包括当前的 en-us 文化。这一定是其他人遇到的问题，但我没有找到任何东西。

**有没有办法针对特定文化运行 mstest？**[我在mstest.exe 的命令行文档中](http://msdn.microsoft.com/en-us/library/ms182489%28v=vs.80%29.aspx)没有看到任何内容

我知道我可以在我的测试中指定 Thread.CurrentThread.CurrentCulture 和 Thread.CurrentThread.CurrentUICulture，但我不希望我们团队的开发人员不得不复制粘贴他们的测试的副本，每种文化一个。这对他们来说将是额外的工作，并且仅因文化而异的重复将难以维护并且容易出错。

我想知道从 TestMethodAttribute 派生一个类并让它循环遍历我所有的语言资源 DLL，为每个 DLL 运行一次测试代码，但 Visual Studio 告诉我：

> 错误 2“ClassToExtendTestMethodAttribute”：不能从密封类型“Microsoft.VisualStudio.TestTools.UnitTesting.TestMethodAttribute”派生

与 TestClassAttribute 相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:45:08.370

一个想法可能是从`TestInitialize`方法中的配置文件中读取文化以便使用 with `Thread.CurrentThread.CurrentCulture`，并将此方法放入基本单元测试类（所有其他测试类都应该派生自该类）。如果这样做了，您可以`mstest`在循环中从批处理文件调用并在每一步之后更改配置文件（例如从“en-us”到“fr-FR”）。

或者，这里有一个指向“[单元测试可扩展性示例](http://archive.msdn.microsoft.com/UnitTestExtendSample)”的指针，我没有使用它，但可能会对您有所帮助。

# actionscript-3 - 如何使用动作脚本旋转由旋钮控制的矩形对象？

> ID：11160064
> 
> 赞同：0
> 
> 时间：2012-06-22T16:11:28.707
> 
> 标签：actionscript-3, flash

我坚持旋转我已将影片剪辑的注册点设置为加载上传图像的中心。我正在做类似的事情

[http://custom.case-mate.com/diy?bypassLandingPage=true](http://custom.case-mate.com/diy?bypassLandingPage=true)

我已经上传了图像，但无法正确旋转它，并且缩放也不能从中心工作。任何指导将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:56:10.527

我建议创建 a `Sprite`，将加载的图像添加为其子项（我想您正在使用 a `Loader`）并将其相对于其父项居中：

```
function onLoaded(e:Event):void{
    _parentSprite.addChild(_loader);
    _loader.x = -_loader.width / 2;
    _loader.y = -_loader.height / 2;
} 
```

之后，您将获得所需的旋转类型更改 `_parentSprite.rotation`。

每次缩放时，您都必须调用以下内容：

```
function centerContent():void{
    _loader.x = -(_loader.width * _loader.scaleX) / 2;
    _loader.y = -(_loader.height * _loader.scaleY) / 2;
} 
```

# php - 远程连接到 MySQL 可以通过命令行工作，但在从 Web 浏览器使用 php 的 mysql_connect 时失败

> ID：11160068
> 
> 赞同：2
> 
> 时间：2012-06-22T16:11:41.140
> 
> 标签：php, mysql, mysql-connect

我正在尝试使用 PHP 的 'mysql_connect()' 函数连接到 MySQL 服务器，但连接失败。这是我的代码：

```
$con = mysql_connect("example.net", "myusername","") or die("Could not connect: ".mysql_error()); 
```

我将此代码放在 PHP 脚本中，我尝试使用 Web 浏览器打开该脚本（该脚本存储在启用了 PHP 的远程主机上），但它不起作用。它也不返回`die`错误。`$con`在浏览器中成功输出之前回显某些内容，而在该行之后没有任何输出。如果我输入：

```
mysql -h example.net -u myusername 
```

从远程机器上，我可以毫无问题地连接到数据库并进行查询和其他修改。

更新：经过一些建议，我也尝试了这个，但没有改进：

```
<?php
    $usern = "myusername";
    $dbh = new PDO('mysql:host=servername.net;dbname=test', $usern, "");
    echo $usern;
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:05:50.007

运行 PHP 的远程主机使用什么操作系统？也许 MySQL 没有在`php.ini`. 另外，请不要将`mysql_*`函数用于新代码。它们不再被维护，社区已经开始[弃用过程](http://news.php.net/php.internals/53799)（见[红框](http://uk.php.net/manual/en/function.mysql-connect.php)）。相反，您应该了解[准备好的语句](http://en.wikipedia.org/wiki/Prepared_statement)并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)。如果你不能决定哪个，[这篇文章](http://php.net/manual/en/mysqlinfo.api.choosing.php)会帮助你。如果您想学习，[这是一个很好的 PDO 教程](http://www.php.net/manual/en/pdo.connections.php)。

您是否尝试过使用 PDO 或 MySQLi 接口？如果您正在尝试学习 PHP，*则无论如何都不应使用 mysql_* * 函数。看看你是否可以使用类似下面的行来访问数据库：

```
$dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass); 
```

如果您需要更详细的文档，此代码直接来自[文档本身](http://www.php.net/manual/en/pdo.connections.php)。

编辑：另外，尝试使用 PDO 的错误检查功能。此示例使用 PDO 创建数据库连接并尝试执行简单查询。它不使用准备好的语句或任何这些功能，因此它不是生产就绪代码（即*不要在不了解如何改进的情况下将其放入代码中），您需要对其进行编辑以包含`SELECT`与您的数据库相关的查询，但它至少应该告诉 PDO 提供有关它遇到的错误的更多信息。

```
<?php
error_reporting(E_ALL);
ini_set('display_errors', 1);

$dbhost     = "localhost";
$dbname     = "test";
$dbuser     = "root";
$dbpass     = "admin";

// database connection
$conn = new PDO("mysql:host=$dbhost;dbname=$dbname",$dbuser,$dbpass);

// query
$conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$sql = "SELECT * FROM booksa";
$q = $conn->query($sql) or die("ERROR: " . implode(":", $conn->errorInfo()));

$r = $q->fetch(PDO::FETCH_ASSOC);

print_r($r);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:17:21.633

php 文件是否与 mysql 数据库位于同一服务器上，如果是这样，您可能必须使用 'localhost' 作为 mysql_connect() 的第一个参数，而不是外部地址。

# internet-explorer-8 - 权限被拒绝 org.ajax.4jsf.framework.ajax.AjaxSxript.jsf + IE8

> ID：11160072
> 
> 赞同：0
> 
> 时间：2012-06-22T16:11:55.087
> 
> 标签：internet-explorer-8, permissions, ajax4jsf

我们的 Web 应用程序（JSF 1.2 + Ajax4jsf 1.1）出现问题。我们收到以下错误

```
**Message: Permission denied
Line: 27
Char: 222
Code: 0
URI: http://uat.example.com/ABC/a4j.res/org.ajax4jsf.framework.ajax.AjaxScript.jsf** 
```

这个问题是零星的，发生率为 50%。仅在所有其他浏览器中的 IE8 上发生，我们看不到此问题。发生此错误时，整个页面将变为空白。但是，刷新会使页面返回。

我们确实浏览了几篇关于 IE QUIRK VS 标准模式的文章。 [强制 IE8 进入 IE7 兼容模式](https://stackoverflow.com/questions/1014666/force-ie8-into-ie7-compatiblity-mode) 没有帮助。

注意：这不是跨站点脚本问题，因为脚本（由 JSF 生成）所在的域与安装我们的应用程序的域相同。

如果有人解决了这个问题，请告诉我们。我看到有人在 [http://www.coderanch.com/t/490213/JSF/java/support-IE上发布了类似的问题](http://www.coderanch.com/t/490213/JSF/java/support-IE)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:55:59.623

找到了问题的解决方法。通过修改ajax4jsf-1.1.0.jar来修复

根本原因：在 IE-8 的情况下，响应是从 Ajax 对象中获取的，尽管响应尚未读取。因此，我们通过检查 status==200 和 readystate=4 添加了 IE 修复。

这是我们所做的 打开 AJAX.js，它位于 jar 内的 \org\ajax4jsf\framework\ajax\scripts\AJAX.js 下

步骤 1\. 更改：

```
 getResponseText : function(){
       return this._request.responseText;
   } 
```

至：

```
 getResponseText : function(){
    if (this._request.readyState == 4){
        if (this._request.status == 200) {
            return this._request.responseText;
        }
    }
} 
```

STEP 2\. 寻找这个方法并改变从：

```
 window.setTimeout(function() {
    var isDocOpen=false;
    //This functions has few more lines , I have not pasted all code here... 
```

改成：

```
 //This is the Fix for IE....The isIE variable is pre defined inside the script.
    if (isIE){
 if (req.readyState == 4){
    if (req.status == 200) {
        window.document.open(req.getContentType(),true);
        isDocOpen=true;

        window.document.write(req.getResponseText());
        window.document.close();
    }
  }
    } 
    else {
    //This is the Original code...
    //Keep this for all other browsers...
    window.document.open(req.getContentType(),true);
     isDocOpen=true;
      window.document.write(req.getResponseText());
   window.document.close();
   } 
```

.. 其余代码应遵循原始脚本。

第 3 步：

```
 //COMMENT OUT THIS ORIGINAL CODE. Not sure why this reloading is done for IE
    //this was causing IE to send requests...more than once..   
    //if(isIE){
/ For Ie , scripts on page not activated.
//  window.location.reload(false);
//} 
```

完成上述更改后，我们使用 win rar 并将 Ajax.js 文件放回 ajax4jsf-1.1.0.jar，现在 IE 8 的问题得到解决。

希望它可以帮助那里的人。

# php - 带有一个变量的 MySQL 查询

> ID：11160074
> 
> 赞同：-1
> 
> 时间：2012-06-22T16:12:01.690
> 
> 标签：php, mysql

我有一个名为“main_table”的表，包含 3 列：
“player”、“points”和“drop_date”

我有 1 个具有不同值的变量 ($date)：

```
$date == '2012-06-01'  
$date == '2012-05-01'  
$date == '2012-04-01' 
```

我有 1 个 MySQL 查询：

```
$query = "
  select *
  from main_table
  where `drop_date` > '$date'
    AND `drop_date` <= DATE_ADD('$date', INTERVAL 1 YEAR)
  LIMIT 1
"; 
```

目标：
我想用不同的pass运行一个查询（每个值1pass）

我努力了 ：

```
<?php
$date['date'] = '2012-06-01';  
$date['date'] = '2012-05-01'; 
$date['date'] = '2012-04-01';

foreach($date as $title => $actual_date) {
  query = "
    select *
    from main_table
    where `drop_date` > '$actual_date'
      AND `drop_date` <= DATE_ADD('$actual_date', INTERVAL 1 YEAR)
    LIMIT 1
  ";
  $result = mysql_query($query) or die(mysql_error());
}

while($row = mysql_fetch_array($result)) {
  echo $row['Player'];
  echo $row['Points'];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:17:17.150

您一遍又一遍地覆盖相同的变量......然后您运行查询但只获取最后一个的结果。你期望它如何工作？

尝试这个：

```
$date = Array("2012-06-01","2012-05-01","2012-04-02");
foreach($date as $actual_date) {
    if( $result = mysql_fetch_assoc(mysql_query("select * from `main_table` where `drop_date`>'".$actual_date."' and `drop_date`<=date_add('".$actual_date."',interval 1 year) limit 1"))) {
        echo $result['Player'];
        echo $result['Points'];
    }
} 
```

请注意，我跳过了将查询放入变量中，并将查询结果放入变量中，而只是将整个内容放在一行中。由于您`limit 1`的查询将仅返回一行，因此无需`while`循环它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:16:28.367

只需在 foreach 循环中移动你的 while。

```
<?php
$date[0] = '2012-06-01';  
$date[1] = '2012-05-01'; 
$date[2] = '2012-04-01';
foreach($date as $title => $actual_date)
{
    query = "select * from main_table where `drop_date` > '$actual_date' AND `drop_date` <= DATE_ADD('$actual_date', INTERVAL 1 YEAR) LIMIT 1"; 
    $result = mysql_query($query) or die(mysql_error());

    while($row = mysql_fetch_array($result))
    {
        echo $row['Player'];
        echo $row['Points'];
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T16:21:29.637

不要覆盖您的值。这样做可以保留所有 3 个值。

```
<?php 
$date['date'][] = '2012-06-01';  
$date['date'][] = '2012-05-01'; 
$date['date'][] = '2012-04-01';

print_r($date);
?> 
```

输出：

```
Array
(
    [date] => Array
        (
            [0] => 2012-06-01
            [1] => 2012-05-01
            [2] => 2012-04-01
        )

) 
```

然后使用

```
foreach ($date['date'] as $actual_date) {

 $query = "
   select *
   from main_table
   where `drop_date` > '$actual_date'
     AND `drop_date` <= DATE_ADD('$actual_date', INTERVAL 1 YEAR)
   LIMIT 1";

   echo $query."<br />";

} 
```

输出：

```
select *
    from main_table
    where `drop_date` > '2012-06-01'
      AND `drop_date` <= DATE_ADD('2012-06-01', INTERVAL 1 YEAR)
    LIMIT 1
  <br />
    select *
    from main_table
    where `drop_date` > '2012-05-01'
      AND `drop_date` <= DATE_ADD('2012-05-01', INTERVAL 1 YEAR)
    LIMIT 1
  <br />
    select *
    from main_table
    where `drop_date` > '2012-04-01'
      AND `drop_date` <= DATE_ADD('2012-04-01', INTERVAL 1 YEAR)
    LIMIT 1
  <br /> 
```

# java - 需要 Java 库——远程（例如 S3）文件的本地文件缓存

> ID：11160076
> 
> 赞同：5
> 
> 时间：2012-06-22T16:12:13.737
> 
> 标签：java, caching, file-io, amazon-s3

我的应用程序需要 Java 和文件系统之间的一层，以使文件系统仅包含所有文件的子集（存储在 S3 上）这一事实变得透明。该层必须做很多普通文件 IO 所做的事情，即打开文件、锁定它们以进行读/写等，但在打开时它必须可能下载文件并驱逐关闭的文件。我需要的另一个功能是，如果文件被锁定以进行读/写，则打开调用可以解锁文件并关闭现有流（即，踢掉其他用户）。另一个是临时文件的管理。

是否有任何类似的开源软件，或者我只需要卷起袖子？我应该从头开始，还是应该挖掘 java IO 中的一些钩子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:18:25.190

我建议你检查一下[apache commons vfs](http://commons.apache.org/vfs/)即使它不是你所需要的，你也可以从中找到有用的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-05T17:14:12.387

该项目旨在简化为 Java 7 NIO (java7-fs-base) 创建自定义文件系统实现。作者实现了 Dropbox FS (java7-fs-dropbox)，并开始在 S3 (java7-fs-amazon-s3) 上工作。[https://github.com/fge/java7-filesystems](https://github.com/fge/java7-filesystems)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T11:09:23.637

在您的情况下，也许[AWS Storage Gateway](http://aws.amazon.com/storagegateway/)值得考虑

> **网关缓存卷：**您可以将主要数据存储在 Amazon S3 中，并将经常访问的数据保留在本地。网关缓存卷可显着节省主存储成本，最大限度地减少扩展本地存储的需求，并保持对经常访问的数据的低延迟访问。

# java - 使用 Java 访问 .tar 文件中的 Java 文件

> ID：11160085
> 
> 赞同：2
> 
> 时间：2012-06-22T16:12:39.587
> 
> 标签：java, file, tar

我正在创建一个 Java 应用程序，它将接收 .tar 文件并从这些 .tar 文件中检索所有文件。我知道您可以使用`GZIPInputStream`从 .tar 文件中获取文件，但是是否可以从`GZIPInputStream`as a中获取这些文件`FileInputStream`，如下所示？

```
InputStream is = new GZIPInputStream(new FileInputStream(file)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:25:41.820

是的，这是可能的，因为 GZipInputStream 的 CTOR 允许您接受 InputStream 作为参数（GZipInputStream 是 InputStream 的包装器）。然后你需要做的就是按照你可以在互联网上找到的例子[来](http://java.sun.com/developer/technicalArticles/Programming/compression/)提取文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:17:17.093

`GZIPInputStream`扩展`InputStream`（不是直接）所以我认为没关系。试试这个：

```
InputStream in = new java.util.GZIPInputStream(new FileInputStream(file));
byte[] buffer = new byte[1024];
int read = 0;
while (( read = in.read(buffer, 0, 1024)) > 0)
{
     // do sth
} 
```

# unobtrusive-javascript - 如何在 HTML 页面中的每个元素上交换两个类

> ID：11160089
> 
> 赞同：0
> 
> 时间：2012-06-22T16:12:47.083
> 
> 标签：unobtrusive-javascript

我的 HTML 页面上有以下 CSS：

```
<style type="text/css">
    .hidden           {display:none;}
    .visible          {display:block;}
</style> 
```

几乎页面上的每个和都属于这些 CSS 样式中的一种或另一种。我需要的是 javascript 将所有内容交换为相反的数字....即每个隐藏的都变得可见，反之亦然。

我在早期的项目中使用了类似的东西，但它只允许我一次交换一个东西，并迫使我直接指定它的 ID。我需要的是一个全局的“如果可见 - 更改为隐藏 - 反之亦然”脚本。

代码（我尝试过但未能扩展为具有此行为）如下：

```
<script type="text/javascript">
    function toggle(divID) {var item = document.getElementById(divID); if (item) {item.className=(item.className=='hidden')?'visible':'hidden';}}
</script> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:21:06.937

```
<style type="text/css">
.hidden           {display:none;}
.visible          {display:block;}
.temp           {display:none;}
</style>

function swap() {
$('.hidden').removeClass('hidden').addClass('temp');
$('.visible').removeClass('visible').addClass('hidden');
$('.temp').removeClass('temp').addClass('visible');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:18:41.273

只需使用 jQuery

```
$('.hidden').removeClass('.hidden').addClass('.visible'); 
```

# javascript - Thunderbird compose-send-message 事件不会触发

> ID：11160104
> 
> 赞同：4
> 
> 时间：2012-06-22T16:13:42.977
> 
> 标签：javascript, thunderbird, thunderbird-addon

我已经按照[教程](https://developer.mozilla.org/en/Extensions/Thunderbird)进行了 Thunderbird 扩展，并成功地获得了使用“加载”事件的扩展（基本的“日期”示例和使用`alert("hey");`两者的随机文本）。

但是，我似乎无法触发任何基于消息的事件。我尝试过使用各种类型的警报，但似乎我的代码没有被运行。例如：

```
function send_event_handler( evt ) {
  alert("hohoho");
}

window.addEventListener( "compose-send-message", send_event_handler, true ); 
```

如何触发允许我修改消息正文的事件？

我的测试平台使用的是 Thunderbird 13。

我的清单是：

```
content     thundersafe    chrome/content/
overlay chrome://messenger/content/messenger.xul chrome://thundersafe/content/thundersafe.xul 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T20:19:20.083

感谢 WladimirPalant，我寻找了其他覆盖。我没有想到这一点，因为我认为覆盖仅对通过 XUL 连接点调整 GUI 有用 - 显然我有很多东西要学。

我使用的正确叠加层是：

```
chrome://messenger/content/messengercompose/messengercompose.xul 
```

这个覆盖是通过查看其他扩展发现的。我在 MDN 上的任何地方都找不到覆盖列表及其预期用途。

# coldfusion - Coldfusion cfselect bind 仅在启用 cfdebug 时有效

> ID：11160114
> 
> 赞同：1
> 
> 时间：2012-06-22T16:14:39.327
> 
> 标签：coldfusion

我有一个绑定到远程 cfc 的 cfselect 语句。它将表单中另一个元素的值传递给 cfc 以填充 cfselect。我在启用 cfdebug 的情况下运行此代码，它似乎工作正常，但我发现如果我没有启用 cfdebug，则不会填充任何内容。我没有收到任何其他我知道的错误，我已经在 chrome 和 mozilla 中尝试过 - 同样的问题。

这是我的cfselect：

```
<cfselect name="intlRepID" id="intlRepID" required="yes" value="userID" display="businessName" bind="cfc:nsmg.extensions.components.user.getIntlRepRemote({programID})" bindonload="true" /> 
```

这是我的远程功能：

```
<cffunction name="getIntlRepRemote" access="remote" returntype="array" output="false" hint="Gets a list of Intl. Reps. assigned to a candidate">
    <cfargument name="programID" default="" hint="Get Intl. Reps. Based on a list of program ids">

    <cfscript>
        // Define variables
        var qGetIntlRepRemote='';
        var result=ArrayNew(2);
        var i=0;
    </cfscript>

    <cfquery 
        name="qGetIntlRepRemote" 
        datasource="#APPLICATION.DSN#">
            SELECT
                u.userID,
                u.businessName
            FROM 
                smg_users u
            INNER JOIN
                smg_students s ON s.intRep = u.userID
            WHERE
                s.companyid = <cfqueryparam cfsqltype="cf_sql_integer" value="#CLIENT.companyid#">
            <cfif LEN(ARGUMENTS.programID)>
                AND 
                    s.programID IN ( <cfqueryparam cfsqltype="cf_sql_integer" value="#ARGUMENTS.programID#" list="yes"> )
            </cfif>
            AND
                s.active = <cfqueryparam cfsqltype="cf_sql_integer" value="1">
            GROUP BY
                u.userID
            ORDER BY
                u.businessName
    </cfquery>

    <cfscript>
        // Add default value
        result[1][1]=0;
        result[1][2]="---- All - Total of " & qGetIntlRepRemote.recordCount & " International Representatives ----" ;

        // Convert results to array
        For (i=1;i LTE qGetIntlRepRemote.Recordcount; i=i+1) {
            result[i+1][1]=qGetIntlRepRemote.userID[i];
            result[i+1][2]=qGetIntlRepRemote.businessName[i];
        }

        return result;
    </cfscript>
</cffunction> 
```

# asp.net-mvc - 从 MVC3 中的操作方法返回 json 结果时，javascript 不加载

> ID：11160127
> 
> 赞同：0
> 
> 时间：2012-06-22T16:15:00.610
> 
> 标签：asp.net-mvc, json

我有这样的操作方法：

```
 public ActionResult Register()
    {
        RegisterModel rm = new RegisterModel();
        return Json(rm, JsonRequestBehavior.AllowGet);

    } 
```

当我浏览到该操作方法时，我没有看到正在加载该视图页面上的任何内容。我所看到的只是：

{"用户名":null,"电子邮件":null,"密码":null,"确认密码":null}

RegisterModel 包含这些属性。

但是，如果我这样做：

```
 public ActionResult Register()
    {
        return view();

    } 
```

当我浏览到相同的操作时，我可以看到视图页面加载的内容。

谁能告诉我返回 jsonresult 时如何在视图页面上呈现所有 javascript 和 html 内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:25:54.433

> 谁能告诉我返回 jsonresult 时如何在视图页面上呈现所有 javascript 和 html 内容？

`JsonResult`是将模型（Employee，Product..）序列化为[Json](http://en.wikipedia.org/wiki/JSON)格式并返回给客户端的一种操作结果。`Json`是一种类似于 xml 的格式。当您返回 Json 时，您不能附加脚本、css 或其他类似的东西。

如果您想返回带有 css、javascript 等的 html，那么您应该使用`ViewResult`( `reurn View()`)。如果您想返回一段 html 而不是完整的文档，您可以使用`PartialViewResult`( `return PartialView()`)。

# entity-framework - IQueryable 和混合延迟加载和急切加载

> ID：11160130
> 
> 赞同：1
> 
> 时间：2012-06-22T16:15:17.717
> 
> 标签：entity-framework, repository, lazy-loading, iqueryable, eager-loading

我有一种情况，我将使用存储库模式并使用返回 IQueryable 的延迟加载的 GetAll 方法从数据库中提取对象。但是，我还需要构建将包含在延迟加载对象（查询）中的动态对象。

是否可以将构建对象添加到延迟加载的 IQueryable 并仍然保留延迟加载的好处？例如

```
public override IQueryable<Foo> GetAll()
{
    return _entities; // lazy loaded
}  

public override IQueryable<Foo> GetAllPlusDynamic()
{
    var entities = GetAll(); 
    foreach(var d in GetAllDynamic())
    {
        entities.Add(d); // eagerly loaded
    }
    return entities;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T11:20:16.093

我不确定我是否正确理解你，但参考你的评论......

> 是的，基本上是在数据库中查询一组对象，然后查询另一个数据源（在本例中为服务）并构建一组对象。

...我会说这是不可能的。

与实体框架 (LINQ to Entities) 一起使用的类型对象`IQueryable<T>`基本上是对底层数据存储可以执行的查询的描述，通常是被转换为 SQL 的抽象描述（表达式树）。

这种查询描述的每个部分——`where`表达式、`select`表达式、`Any(...)`表达式等——都必须可翻译成数据存储的本地语言 (SQL)。尤其不可能在数据库无法理解和执行的表达式中包含一些方法调用（例如服务调用）。

`IQueryable<T>`知道潜在的“提供者”。该提供者负责将`IQueryable<T>`对象持有的表达式树翻译成“某物”，例如 SQL Server 使用的 T-SQL，或者 MySQL 或 Oracle 使用的 SQL 方言。我相信可以编写自己的提供程序，然后它可能能够以某种方式执行服务调用和数据库查询。但我也相信这不是一件容易的事。

使用实体框架的标准 SQL 提供程序，您必须执行数据库查询并一个接一个地单独调用服务：运行查询并在内存中实现实体 - 然后对每个实体的结果集合运行服务调用。

# jquery - Telerik Extensions 和 Kendo MVC javascript 不能按指示工作

> ID：11160131
> 
> 赞同：0
> 
> 时间：2012-06-22T16:15:20.320
> 
> 标签：jquery, telerik, telerik-mvc, kendo-ui

有没有其他人有这个问题？

根据所有文档，您应该能够使用以下代码访问任何 Telerik Extensions 或 Kendo 控件的数据

```
var data = $('#id').data('tControlType') 
```

但是，我从来没有真正让这个代码工作。无论我做什么，“数据”函数总是返回未定义的。该控件实际上可以正常工作，并且我可以通过其他几种方式获取控件数据，例如通过任何事件处理程序的 event.sender，但数据函数不起作用。

我正在使用 Telerik Script Registrar 在我的页面中包含 jQuery 和其他脚本。这目前看起来像这样：

```
@{Html.Telerik().ScriptRegistrar().jQuery(true).jQueryValidation(true)
    .Globalization(true).DefaultGroup(group => group
        .Add("~/Scripts/jquery-ui-1.8.11.js")
        .Add("~/Scripts/jquery.ui.touch-punch.js")
        .Add("~/Scripts/jquery.unobtrusive-ajax.js")
        .Add("~/Scripts/bootstrap-tab.js")
        .Add("~/Scripts/bootstrap-dropdown.js")
        .Add("~/Scripts/kendo/kendo.web.js")
        .Add("~/Scripts/kendo/kendo.aspnetmvc.js")
        .Add("~/Scripts/ui.watermark/ui.watermark.js")
        .Add("~/Scripts/date.js")
        .Add("~/Scripts/jquery.blockUI.js")
        .Add("~/Scripts/jquery.ba-bbq.js")} 
```

看起来 Telerik 正在使用 jQuery 1.7.1，因为那是 Telerik Scripts 文件夹中的内容。Telerik 版本是 2012.1.214，我也在使用 Kendo 测试版，尽管在加入 Kendo 之前我遇到了同样的问题。ScriptRegistrar 当前位于 <HEAD> 标记中，因为 Kendo 需要它，尽管我也尝试将它放在 <BODY> 标记的末尾之前，因为 Telerik Extensions 建议没有效果。我还确认问题存在于 IE、Firefox、Opera、Safari 和 Chrome。

因为我使用 Telerik Script Registrar 来包含所有 Telerik 和 jQuery 相关的脚本，所以我希望这应该“正常工作”。我还能做错什么？

编辑：这是一个例子：

```
@(Html.Telerik().NumericTextBox().Name("NumericTextBox"))

<script type="text/javascript">
$(function() {        
    var data = $("#NumericTextBox").data("tTextBox");
    alert(data); //displays "undefined"
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T10:17:09.823

确保包含 jQuery JavaScript 的次数不超过一次。`ScriptRegistrar`除非`jQuery(false)`设置，否则将自动包含一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T17:01:13.913

我认为问题在于当您尝试访问该值时该对象尚未在 DOM 上。尝试访问处理程序上的值（可能是单击按钮）并查看它是否有效。除此之外一切似乎都很好

# ios - 仅在必要时允许 iOS 应用用户通过 Facebook 进行身份验证

> ID：11160134
> 
> 赞同：1
> 
> 时间：2012-06-22T16:15:35.173
> 
> 标签：ios, facebook, facebook-graph-api, facebook-authentication, facebook-ios-sdk

我有一个 iPhone 应用程序允许用户录制视频，我希望他们能够在 Facebook 上分享这些视频。

但是，除非用户决定分享，否则我不希望他/她被重定向到 Facebook。我已经尝试过 Facebook iOS 教程中提供的方法，它要求用户在应用启动后立即重定向到 Facebook 并进行身份验证。

那是不必要的。

我想做的是有一个“分享”按钮，允许用户进行身份验证，然后使用`POST`请求自动上传视频。

这可能吗？有没有人达到类似的效果？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:57:24.597

我不确定您正在查看哪个教程，但它可能让您在启动时进行身份验证，就像演示一样。

在您的应用中，您可以在保存视频后使用类似的内容授权您的应用

```
// Share button action
- (IBAction)sharePressed {

    // If user is already authenticated
    if ([facebook isSessionValid]) {
        [self shareLinkToFacebook];
    } else {
    // Authenticate with just email permissions            
        NSArray* permissions = [NSArray arrayWithObjects:
                                @"email", nil];

        [facebook setSessionDelegate:self];
        [facebook authorize:permissions];  
    }
}

- (void) shareLinkToFacebook {

    // Create a simple post
    NSMutableDictionary *params = [[NSMutableDictionary alloc] init];

    [params setValue:[video url] forKey:@"link"];

    [params setValue:[video title] forKey:@"name"];
    [params setValue:@"description" forKey:@"description"];

    [facebook dialog:@"feed" andParams:params andDelegate:self];
}

// FBSessionDelegate
- (void) fbDidLogin {
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setObject:[facebook accessToken] forKey:kFBAccessToken];
    [defaults setObject:[facebook expirationDate] forKey:kFBExpirationDateKey];
    [defaults synchronize];

    [self shareLinkToFacebook];
} 
```

您将必须通过 facebook 进行身份验证才能获得访问密钥 - 没有办法解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T12:49:09.810

你不能做你想做的事。要发布某些内容，您必须拥有有效的 access_token。实现这一点的唯一方法是遵循您在官方示例中看到的登录过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:08:00.963

这个问题的答案在于创建一个同时作为 the`FBSessionDelegate`和 the运行的单例，并允许您在程序周围`FBRequestDelegate`传递一个实例。`Facebook`

我打电话给我的单例`FacebookVideoUploader`，并在我的应用程序委托中打电话：

```
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {
    return [[[FacebookVideoUploader sharedInstance] facebook] handleOpenURL:url]; 
```

就是这样。这使应用程序委托保持整洁，让单例处理委托方法。

在我处理视频上传的视图控制器的实现文件中，我放了：

*   (IBAction)shareWithFacebook:(UIButton *)sender { [[FacebookVideoUploader sharedInstance] postVideoToFacebook]; }

就是这样。所有的委托和会话方法以及 postVideoToFacebook 都在`FacebookVideoUploader`单例中处理。

这允许我的用户登录我的应用程序而不会被重定向到 Facebook，并让他们在决定要共享视频后立即进行身份验证。

# jasper-reports - 如何获取当前页码和总页数作为每页上的变量？

> ID：11160137
> 
> 赞同：0
> 
> 时间：2012-06-22T16:15:48.270
> 
> 标签：jasper-reports

我需要在报告上生成 OMR 代​​码。我考虑在每个页面上调用一些服务方法，以获取页码和总页数作为参数。问题是：如何将这些值（页码、总页数）作为每页上的变量？

```
<background>
    <band height="797">
        <textField>
            <reportElement x="30" y="684" width="100" height="97"/>
            <textFieldExpression><![CDATA[OMRService.generateCode($V{totalPages},$V{pageNumber})]]></textFieldExpression>
        </textField>
    </band>
</background> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-26T11:50:57.800

下面您有示例代码如何在 2 个不同的文本字段中执行此操作。

```
<textField evaluationTime="Page">
        <reportElement x="0" y="0" width="520" height="15"/>
        <textElement textAlignment="Right"/>
        <textFieldExpression class="java.lang.Integer"><![CDATA[$V{PAGE_NUMBER}+"/"]]>  </textFieldExpression>
</textField>
<textField evaluationTime="Report">
        <reportElement x="521" y="0" width="14" height="15"/>
        <textElement textAlignment="Left"/>
        <textFieldExpression class="java.lang.Integer"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
</textField> 
```

当evaluationTime="Page" 时你会得到页码，当"Report" 时会显示总页数。我不知道如何将它合并到一个文本字段中（甚至不知道它是否可能 - 我花了很多时间在它上面但无法解决这个问题）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-12-07T08:26:55.303

选择文本字段。
将表达式设置为：`msg("Page {0} of {1}", $V{V_CURRENT_PAGE_NUMBER}, $V{PAGE_NUMBER})`
将评估时间设置为：自动

# mysql - 在 MySQL 中加入 2 个 sql 查询

> ID：11160140
> 
> 赞同：1
> 
> 时间：2012-06-22T16:16:00.540
> 
> 标签：mysql, sql

我正在尝试在一个查询中加入 2 个 sql 查询。

第一个获取每家酒店的房间数。第二个获取酒店入住客人的数量。我正在尝试获取每家酒店的入住率。

```
SELECT hotel_id, count(room_id)  
FROM  room  
group by room.hotel_id

SELECT h.hotel_id, count(k.room_id) 
FROM room_reservation as kr , room as k , hotel as h
where kr.room_id = k.room_id and k.hotel_id = h.hotel_id 
group by k.hotel_id 
```

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:19:02.987

```
select aux.hotel_id, ((coalesce(aux2.total, 0)*1.0)/aux.total)*100 as 'ocupancy rate'
from (SELECT hotel_id, count(room_id) as 'total' 
      FROM  room  
      group by room.hotel_id) aux
LEFT OUTER JOIN (SELECT h.hotel_id, COUNT(k.room_id) as 'total'
                 FROM room_reservation as kr
                 INNER JOIN room as k ON (kr.room_id = k.room_id)
                 INNER JOIN hotel as h ON (k.hotel_id = h.hotel_id) 
                 GROUP BY k.hotel_id) aux2 on aux.hotel_id = aux2.hotel_id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:27:42.197

您绝对可以通过一个查询来做到这一点。一种方法是将您的查询合并在一起。

但是，我认为以下内容可以一次性完成您想要的操作：

```
SELECT r.hotel_id, count(distinct k.room_id) as numrooms,
       count(distinct kr.room_id) as numreserved
FROM room k left outer join
     room_reservation kr
     on kr.room_id = k.room_id 
group by r.hotel_id 
```

我不积极，不知道更多关于表格的信息。特别是，预订具有房间和酒店所没有的时间成分。这如何纳入您的查询中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:29:41.693

我希望这是不言自明的：

```
select hotel_id, sum(guests)/count(room_id) occupancy_level
from (
  select r.hotel_id, r.room_id, count(*) guests
  from room r
  left join room_reservation rr on rr.room_id = r.room_id
  group by r.hotel_id, r.room_id
) temp
group by hotel_id 
```

***更新**- 受@Gordon Linoff 启发，包括未预订的房间*：

```
select r.hotel_id, count(*) / count(distinct r.room_id) occupancy_level
from room r
left join room_reservation rr on rr.room_id = r.room_id
group by r.hotel_id, r.room_id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T16:34:19.443

加入您的所有查询，汇总以获得每家酒店的客房/预订数量，然后除以：

```
SELECT hotel_id, 
    COUNT(DISTINCT r.room_id) / CONVERT(decimal, COUNT(*)) * 100.0 AS occupancy_rate
FROM hotel h
    LEFT OUTER JOIN room r ON h.hotel_id = r.hotel_id
    LEFT OUTER JOIN room_reservation rr ON r.room_id = rr.room_id
GROUP BY h.hotel_id 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-22T17:56:53.507

可以非常简单地假设在表格中的任何给定时间总是有等于或少于总酒店房间的预订量，`room_reservation`并且一个酒店房间在表格中只有 0 或 1 个对应的行，`room_reservation`因为以前的房间预订量是已删除（似乎是这样，因为在您的第二个查询中，您没有进行任何类型的过滤，例如仅选择每个房间的最新预订等）：

```
SELECT 
    a.hotel_id, 
    (COUNT(b.room_id) / COUNT(*))*100 AS occupancy_rate  
FROM 
    room a
LEFT JOIN
    room_reservation b ON a.room_id = b.room_id
GROUP BY 
    a.hotel_id 
```

如果您需要更多关于酒店的详细信息，则需要额外的`hotel_id`信息`INNER JOIN`。

# bash - 合并linux中不同列的两个文件

> ID：11160145
> 
> 赞同：18
> 
> 时间：2012-06-22T16:16:18.630
> 
> 标签：bash, sed, awk

我在 linux 中有两个文件，第一个文件有 4 列，第二个文件有 2 列。我想将这些文件合并到一个新文件中，该文件包含文件 1 的前 3 列和文件 2 的第一列。我尝试了 awk，但文件 2 中的数据放在文件 1 下。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-06-22T16:25:15.750

```
paste file1 file2 | awk '{print $1,$2,$3,$5}' 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-22T16:30:16.347

Not sure which columns you want from each file, but something like this should work:

```
paste <file1> <file2> | awk '{print $1,$2,$3,$5}' 
```

The first three columns would be picked from `file1`, and the fourth skipped, then pick the first column from the second file.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-22T16:25:32.287

如果文件具有相同的行数，您可以执行以下操作：

```
awk '{ getline v < "file2"; split( v, a ); print a[2], $1, $3 }' file1 
```

打印文件 1 中的第 1 列和第 3 列以及文件 2 中的第 2 列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-10T10:32:01.393

```
you can try this one without paste command:
awk '{print $1}{print $2}{print $3}' file1 >> mergedfile
awk '{print $2}' file2 >> mergedfile 
```

# android - Android原生上网：下载文件

> ID：11160146
> 
> 赞同：0
> 
> 时间：2012-06-22T16:16:22.180
> 
> 标签：android, android-ndk

我想在我的 Android Native 应用程序中从 Internet 下载文件。我在网上搜索它的参考，但找不到任何东西。有人可以告诉我这是否可能，如果它是要寻找的东西或在哪里？是否有移植的 C++ 库可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T00:10:22.050

有可以访问 Internet 的 C 库 -`libcurl`浮现在脑海中 - 但为什么不使用 Android 的内置 Java 堆栈呢？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-22T16:21:27.493

检查您的清单以确保您允许互联网访问、修改 sim 卡上的信息等。

现在您可以访问 sim 卡和互联网。从那时起，你就可以做这些事情了。

另外，我注意到你提到了一个 C++ 库？Android 主要是用 java 完成的，除非你正在做一些跨平台的东西，比如用 C++ 编写的 cocos-2d-x

# jquery - Spring MVC 3.1 和 ajax 调用的错误消息

> ID：11160149
> 
> 赞同：0
> 
> 时间：2012-06-22T16:16:29.263
> 
> 标签：jquery, spring-mvc, bean-validation

我正在开发一个 Spring MVC 3.1 Web 应用程序，几乎我所有的表单提交都是使用 jQuery ajax 调用和表单序列化完成的。这很好用。我需要一种从服务器拉回验证错误消息的方法，所以我找了一个例子。我在网上找到了一个，它基本上将 BindingResult 对象放入自定义 JsonResponse 对象中，然后将其作为`@ResponseBody`. 这也很好用！这是我们遇到问题的地方，虽然`BindingResult`对象回来了，但没有任何消息像我使用 Spring:form 标签时那样被插值。我调查了这个问题，发现我可以尝试`SpringMessageSourceInterpolater`用自定义的覆盖，这有帮助，但现在只插入 JSR-303 验证错误，而不是实际的`TypeMismatch`来自 Spring 绑定的错误。这是我正在做的一个例子：

```
 public @ResponseBody
     JSonResponse addQuote(@ModelAttribute("quote") @Valid QuoteBean quote, BindingResult result, HttpServletRequest request, HttpServletResponse response) throws IOException
     {
        jsonResponse = new JsonResponse();

        //Some handle code

        jsonResponse.setStatus(JsonResponse.ResponseStatus.INVALID);
        jsonResponse.setResult(result.getAllErrors());

        return jsonResponse;
     } 
```

正如我所说，Json 被完美地序列化，对于 JSR-303 错误，`defaultMessage`错误对象的字段是一个插值消息，但如果错误是 Spring `TypeMismatch`（就像放入`1`一个字段我绑定到一个日期） ，我反而得到了一条长长的 Spring 生成消息。我尝试添加`error.getCodes()`与对象上的所有内容相对应的消息代码，但无济于事（例如`TypeMismatch.fieldname`）。肯定有人使用过 Spring 和 Ajax 并进行了此验证，但我找不到答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T20:31:49.377

我正在经历一个类似的问题，即使用 jQuery 发布表单。目前我只是从控制器返回绑定结果作为字符串，使用：

```
return bindingResult.getAllErrors() 
```

作为开发应用程序时的临时解决方案，我正在解析返回的 json 数据并在警报弹出窗口中简单地显示 defaultMessage(s)。

您是否设法以某种方式将返回的 json defaultmessage(s) 与关联的表单输入元素相关联？

真的很想知道你是如何处理这个（详细）的，因为关于这个的文档并不多，无论是从春季还是其他地方。

# asp.net-mvc - 错误 - 预申请开始

> ID：11160156
> 
> 赞同：1
> 
> 时间：2012-06-22T16:17:12.953
> 
> 标签：asp.net-mvc, vb.net, version-control

我目前正在编辑一个从我公司的源代码管理中打开的项目。尝试在本地调试时出现错误

> 验证网站
> 
> : Build (web): 应用程序启动前初始化方法 Start on type System.Web.WebPages.Deployment.PreApplicationStartCode 引发异常并显示以下错误消息：访问路径'C:\Users\gary\Documents\Visual Studio 2010\WebSites\DOISAdminPortal\' 被拒绝..

我做了一些研究，很多人说要从 web.config 文件中删除 add key="webpages:Enabled" value="true" 。它从未包含在配置文件中，因此不应该成为问题。

有人有什么建议吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T19:22:46.127

包含在 VS 2010 文件夹中的文件需要被授予 iis express 用户 iis_iusrs 的权限。完成此操作后，我就能够访问目录中的所有文件并能够调试页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-25T01:34:59.547

简短回答：尝试关闭模拟以进行本地测试。

就我而言，我们的 web.config 有以下行：

`<identity impersonate="true" userName="DOMAIN2\admin" password="12345"/>`

节下`</system.web>`。

这个模拟身份在生产服务器上运行，但是当在我的本地运行它时，`admin`来自域的用户`DOMAIN2`没有相同的权限，因为我的本地计算机位于不同的域上`DOMAIN3`，并且默认情况下没有授予`DOMAIN2\admin`系统上的任何权限。

我绕过这个问题的一种方法是关闭模拟，如下所示：

`<identity impersonate="false" userName="DOMAIN2\admin" password="12345"/>`

我想这将我的设置默认为使用当前登录用户的权限。

# jquery - 获取新添加的 li 的高度

> ID：11160161
> 
> 赞同：0
> 
> 时间：2012-06-22T16:17:26.730
> 
> 标签：jquery, height, append

我怎样才能得到`.height()`新附加的 li ？

```
$("#siri").bind('webkitspeechchange', function() {
  var speech = $(this).val();
  $('ul').append("<li>' + speech + '</li>");
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:20:27.000

您之前尝试过创建元素吗？

```
var $li = $("<li>' + speech + '</li>");
$('ul').append($li);
var height = $li.height(); 
```

我认为这应该可以正常工作...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:42:43.433

您可以为每个新附加的 li 赋予某种唯一标识符吗？

例如：

```
$("#siri").bind('webkitspeechchange', function() {
  var speech = $(this).val();
  $("ul").append("<li id='unique-id'>" + speech + "</li>");
  var itemHeight = $("#unique-id").height();
}); 
```

# c# - 如何将 DatePicker 添加到我的 MVC3 C# 站点

> ID：11160166
> 
> 赞同：6
> 
> 时间：2012-06-22T16:17:35.903
> 
> 标签：c#, asp.net-mvc-3, jquery-ui, razor, datepicker

我整个下午都在试图弄清楚如何做到这一点，但似乎无法掌握如何让 DatePicker 与我的网站一起工作。

此外，如果可能的话，我想删除 DateTime 的时间部分，因为我只对条目发布的日期感兴趣。

到目前为止，我已经在下面包含了代码，我几乎已经删除了到目前为止我尝试过的所有内容，所以它又回到了开头。我在 _Layout.cshtml 顶部引用了我认为正确的 JQuery 文件。

我在网上查看了许多指南，但很难理解它们，尽管我会继续阅读。

我已将这些行添加到我的 _Layout.cshtml 的顶部（我还解压缩并将 JQuery 文件夹复制到下面引用的位置）

```
<link href="@Url.Content("~/Content/jquery-ui/redmond/jquery-ui-1.8.21.custom.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/jquery-1.8.11.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/modernizr-1.7.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/ui/minified/jquery.ui.core.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/ui/minified/jquery.ui.datepicker.min.js")" type="text/javascript"></script> 
```

我的视图代码如下所示：

```
@model dale_harrison.Models.News

@{
    ViewBag.Title = "Create";
}

<h2>Create</h2>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript">    </script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")"     type="text/javascript"></script>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>News</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.News_Entry)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.News_Entry)
            @Html.ValidationMessageFor(model => model.News_Entry)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.News_Date)
        </div>
        <div class="editor-field">
            @*@Html.EditorFor(model => model.News_Date)*@
            @Html.EditorFor(model => model.News_Date, new object{ id = "news_date" } )
            @Html.ValidationMessageFor(model => model.News_Date)
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>

<script type="text/javascript">
    $(document).ready(function () {
    $("#news_date").datepicker({ dateFormat: 'dd/mm/yy' });
    });
</script> 
```

我的模型在这里：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data.Entity;

namespace dale_harrison.Models
{
    public class News
    {
        public int ID { get; set; }
        public string News_Entry { get; set; } 
        public DateTime News_Date { get; set; }
    }

    public class NewsDBContext : DbContext
    {
        public DbSet<News> News_Entries { get; set; }
    }
} 
```

非常感谢任何人的帮助

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-22T16:32:34.413

先试试这个：

添加没有 html 帮助器的 html 代码：

```
<input type="text" id="news_date" name="news_date" /> 
```

或者，如果您想`id`使用 Html 助手添加：

```
@Html.EditorFor(model => model.News_Date, new { id = "news_date" } ) 
```

然后添加这个 javascript 代码：

```
$(document).ready(function () {
            $("#news_date").datepicker({ dateFormat: 'dd/mm/yy' });
}); 
```

您可以先尝试此操作，以检查您是否已正确设置项目中的所有配置。你应该用这些线解决你的问题。

在您的站点中使用此功能后，请阅读有关 html 帮助程序以及如何封装代码的信息，这样您就不必每次都重写。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:26:56.857

在`Views/Shared/EditorTemplates`文件夹上，您需要为 DateTime 类型创建模板，因此每次使用`@Html.EditorFor`MVC 时都会显示您在模板上定义的任何内容

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T08:37:17.307

您可能还希望从文本框中隐藏时间，以便看到“08/11/2007”而不是“08/11/2007 00:00:00”。

为此，请将“[DataType(DataType.Date)]”添加到您的新闻类中，如下所示；

```
public class News
{
    public int ID { get; set; }
    public string News_Entry { get; set; } 
    [DataType(DataType.Date)]
    public DateTime News_Date { get; set; }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-25T10:32:34.703

EditorFor 忽略额外的属性。使用 TextBoxFor 或编写 EditorFor 模板...

# android - AsyncTask - 将 postExecute 中的字符串返回给 Activity，它在不阻塞 UI 线程的情况下启动了异步任务

> ID：11160170
> 
> 赞同：1
> 
> 时间：2012-06-22T16:18:14.800
> 
> 标签：android, android-activity, android-asynctask, return

我有一个 Activity，它启动一个带有已实现进程对话框的 AsyncTask。这很好用！但是我想在 asyncTask 完成后得到一个字符串返回。所以我必须在 onPostExecute - 方法中返回一些东西。我想在启动 AsyncTask 的 Activity 中获取该结果（字符串）。我不想使用 .get() 因为它阻塞了 UI 线程。

我必须在 onPostExecute 中写入什么，而 Activity 从 doInBackground 中获取字符串？

感谢您为解决此问题提供的任何帮助；）

现在使用代码：

```
class BgDL extends AsyncTask<String, Integer, String> {

    String finishString="";
    private Context context;

    ProgressDialog pdialog;

    public BgDL(Context cxt) {  //get the context (usually "this" from Activity / otherwise progressdialog wont show up!
        context = cxt;
        pdialog = new ProgressDialog(context);

    }

    @Override
    protected String doInBackground(String... strings) {
        OutputStream output;
        ByteArrayOutputStream baos = null;

        try {
            URL url = new URL(strings[0]);
            URLConnection connection = url.openConnection();
            connection.connect();

            int fileLength = connection.getContentLength();

            InputStream input = new BufferedInputStream(url.openStream());
            if (strings[1]=="toString") { // write byte to string  if a file is not given
                baos= new ByteArrayOutputStream();
                output = new DataOutputStream(baos);
            } else { //otherwise to string
                output = new FileOutputStream(strings[1]);
            }
            byte data[] = new byte[1024];
            long total = 0;
            int count;
            while ((count = input.read(data)) != -1) {
                total += count;
                publishProgress((int) (total * 100 / fileLength));
                output.write(data, 0, count);
       }
       output.flush();
       output.close();
       input.close();
       if (strings[1]=="toString") { 
           finishString = baos.toString(); //
       } // only write byte to string if a file is not given
    } catch (Exception e) {log.d("ex",e.toString());
    }
    return finishString;
    }

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        pdialog.setTitle("Please wait");
        pdialog.setIndeterminate(false);
        pdialog.setMax(100);
        pdialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        pdialog.show();
    }

    @Override
    protected void onProgressUpdate(Integer... progress) {
        super.onProgressUpdate(progress);
        pdialog.setProgress(progress[0]);

    }
    protected void onPostExecute(String...finishString) {
        pdialog.dismiss();//!!!!!!!!!finishString i want to pass over to my Activity, which started this asynctask with .execute();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T05:45:13.150

在您的项目中创建一个扩展活动的类，如下所示：

```
public class SomeClass extends Activity
{
    public void dataFromPostExecute(String data) 
    {
        System.out.println("in mainactivity");
    }
} 
```

如果您希望每个活动都有一个线程，只需创建一个扩展 [应用程序的类](http://developer.android.com/reference/android/app/Application.html)

```
public class Async extends Application
{
private Socket globalSocket;

    @Override
    public void onCreate()
    {
        //socket = null;
    }

    public Socket getglobalSocket() 
    {
        return globalSocket;
    }

    public void setGlobalSocket(Socket globalSocket) 
    {
        this.globalSocket = globalSocket;
    }
} 
```

在扩展 Asynctask 的套接字类中，执行以下操作：

```
public SocketClass extends AsyncTask<String,String,String>
{
    Async app;
    private SomeClass t_act;
    public SocketClass(SomeClass sct) 
    {
        t_act = sct;
        this.con = tst;
        app= ((Async)sct.getApplicationContext());
    }

    protected void onPostExecute(String data)
    {
        t_act.dataFromPostExecute(data);
    }
} 
```

然后，在您的活动中扩展 SomeClass 并执行如下所示：

```
public class Activity1 extends SomeClass
{
    public void dataFromPostExecute(String data)
        {
            //do whatever you want. "data" of this method contains the values from                                     
              postexecute()
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:47:59.617

> 我必须在 onPostExecute 中写入什么，而 Activity 从 doInBackground 中获取字符串？

当您使用时`AsyncTask`，您可以更新您`UI`唯一的 on`onProgressUpdate`和`onPostExecute`方法。

您的`doInBackground()`方法返回一些数据，这些数据将传递给`onPostExecute`方法（这也取决于您的泛型是如何声明的）。

通常，没有其他方法可以做到这一点。

你的意思是：

```
AsyncTask a = new AsyncTask(Context);
a.execute(Input); 
```

首先意味着您的构造函数看起来像

```
public MyAsync(Context c) {
   this.c = c;
} 
```

第二意味着您将第一个泛型类型（假设 Input param is `String`）声明为

```
private class MyAsync extends AsyncTask<String, Void, String> {
  //...
} 
```

并且您想`UI`使用`String`该返回`doInBackground()`方法进行更新，而只需放置带有返回参数的`onPostExecute`方法。`IN``String``doInBackground()`

```
protected void onPostExecute(String stringReturnedFromDoInBackground) 
{
   // some work
} 
```

因此，如果您想以不同的方式执行此操作，请更改您的应用程序逻辑并使用`ResultReceiver`例如`IntentService`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T16:22:01.650

doInBackground() 的返回值在 onPostExecute() 中是正式的。因此，您应该能够将其传递进去。

# javascript - 允许在 onfocus/onblur 显示/隐藏文本区域内单击

> ID：11160171
> 
> 赞同：0
> 
> 时间：2012-06-22T16:18:16.640
> 
> 标签：javascript, jquery, html

对不起，奇怪的标题问题。

我想知道如何执行以下操作：

当用户通过onfocus点击模糊的textarea时，会显示：挡住它周围的div，在textarea下方显示一个“textarea控制台”，然后是一个“add step”图标。如果您点击退出，它将模糊文本区域以及两个额外的项目。

但是，我想补充的是，如果他们单击“textarea 控制台”或“添加步骤”图标，则 div 不会模糊。

这是我到目前为止在[jsfiddle.net上的内容](http://jsfiddle.net/ninacess/wAaDz/5/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:50:01.960

检查这个[http://jsfiddle.net/wAaDz/13/](http://jsfiddle.net/wAaDz/13/)。做出了改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:44:53.567

我已经更新了 jsFiddle：[这里](http://jsfiddle.net/MkaKC/)

我认为这只是一些错误的事情......你在正确的轨道上。

```
$("#textareasteinstruc").focusout(function() {
  alert('focusout');
    $(".textareaconsole").hide();
    $("#addPrepStepButtonicon").hide(); 
```

focusout 函数中缺少 # ......并且没有正确引用类/ID。

它正在按照你想要的方式工作，我现在在想:)

更新：我添加了 $("#addPrepStepButtonicon").show(); 到点击事件，所以“提交”按钮将再次出现

# mysql - 试图攻击mysql？

> ID：11160173
> 
> 赞同：1
> 
> 时间：2012-06-22T16:18:26.750
> 
> 标签：mysql

是攻击吗？结果如何？

```
120406 15:47:32 44330 Connect   Access denied for user 'sdgfsdgfsdgfs'@'89.107.230.194' (using password: YES)  
44330 Connect   sdgfsdgfsdgfs@89.107.230.194 as  on 
```

如何预防？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:47:15.607

您应该真正禁用远程 MySQL 访问，设置为仅允许本地入站连接。如果您确实需要从其他地方连接，[请使用隧道脚本。](http://wiki.navicat.com/wiki/index.php/Where_can_i_get_the_HTTP_tunnel_script_file?)

这两行日志中的判断是拒绝访问。但是您可以搜索整个文件以获取访问权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:22:36.920

这可能是一次黑客攻击，他们无法连接。

我建议您安装防火墙以解决许多问题并防止将来发生这种情况。

# php - 如何在 Wamp 上安装 qt-faststart？

> ID：11160174
> 
> 赞同：1
> 
> 时间：2012-06-22T16:18:35.613
> 
> 标签：php, ffmpeg, qt-faststart

我已经在 WAMP 2 上安装了 FFMPEG。但是我相信我还需要 qt-faststart 以便快速加载 MP4 文件中的元数据。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T22:36:42.123

您需要 qt-faststart 使 MP4 文件可流式传输。这是 qt-faststart.exe 的 Windows 版本：http: [//notboring.org/downloads/video/qt-faststart.zip](http://notboring.org/downloads/video/qt-faststart.zip)

这对你有用吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-02T10:11:05.117

qt-faststart 的替代方案是 MP4Creator。 [http://mp4creator.sourceforge.net/](http://mp4creator.sourceforge.net/)

命令行：mp4creator -optimize videofile.mp4

我发现它在慢速磁盘（如 SD 卡）上比 qt-faststart 快得多

对不起，迈克；）

# .net - 如何在使用 JSON.NET 进行序列化期间更改数据？

> ID：11160176
> 
> 赞同：0
> 
> 时间：2012-06-22T16:18:36.517
> 
> 标签：.net, asp.net-mvc, json, datatables, json.net

我在 MVC4 非 api 项目中使用[Newtonsoft JSON.NET 4.5r7。](http://json.codeplex.com/documentation)

下面我将DataTables“mDataProp”的“id”重命名为DT_RowId，但也想更改数据，例如[42在序列化期间变为“row_42”](http://editor.datatables.net/release/DataTables/extras/Editor/examples/php/browsers.php)。

```
sealed public class Species
{
    [JsonProperty("DT_RowId")]
    public long id { get; private set; } // Change me to row_{n}

    public int amu { get; private set; }

    public string chemicalFormula { get; private set; }
...
} 
```

对于不熟悉该库的人来说，文档有点难以理解，并且缺少示例。

我可以为每个类添加一个“row_n”属性，但是将视图与模型耦合是邪恶的™</p>

问题是：如何使用 JSON.net 更改序列化数据以实现此结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:13:07.763

从操作而不是返回模型，您可以轻松地使用 linq 查询创建一个匿名对象并返回它。

```
public JsonNetResult TestAction()
{
     ...

     var query = species.Select(s => new // species is a collection
     {  
        DT_RowId = .. you can change data as you need from s.id,
        amu = s.amu,
        chemicalFormula = s.chemicalFormula 
        ...
     });

     return new JsonNetResult{ Data = query.ToList() };

 } 
```

# objective-c - si_user_byuid/getpwuid 中的内存泄漏源自 iOS 中的 CPSharedResourcesDirectory

> ID：11160178
> 
> 赞同：0
> 
> 时间：2012-06-22T16:18:42.660
> 
> 标签：objective-c, ios, memory-leaks, arm, getpwuid

我正处于产品的优化/分析阶段，该产品将在几周内上线，我很惊讶地发现一些漏洞（我相信）并非源自我的代码。其中之一是 iOS 5.1.1 中存在的 strdup/malloc 泄漏，对此我只能等待更新。然而今天我发现了一个新的，我目前正试图查明它在哪里以及如何泄漏。仪器报告：

```
 Bytes Used         # Leaks Symbol Name
     16 Bytes  100.0%   1       start
     16 Bytes  100.0%   1        main
     16 Bytes  100.0%   1         UIApplicationMain
     16 Bytes  100.0%   1          -[UIApplication _run]
     16 Bytes  100.0%   1           _UIAccessibilityInitialize
     16 Bytes  100.0%   1            -[UIApplication(UIKitApplicationAccessibility) _accessibilityInit]
     16 Bytes  100.0%   1             -[UIApplication(UIKitApplicationAccessibility) _updateAccessibilitySettingsLoader]
     16 Bytes  100.0%   1              _AXSAccessibilityEnabled
     16 Bytes  100.0%   1               _getBooleanPreference
     16 Bytes  100.0%   1                CPCopySharedResourcesPreferencesDomainForDomain
     16 Bytes  100.0%   1                 CPSharedResourcesDirectory
     16 Bytes  100.0%   1                  getpwuid
     16 Bytes  100.0%   1                   si_user_byuid
     16 Bytes  100.0%   1                    search_item_bynumber
     16 Bytes  100.0%   1                     si_user_byuid
     16 Bytes  100.0%   1                      _fsi_get_user
     16 Bytes  100.0%   1                       0x119048
     16 Bytes  100.0%   1                        0x1180e4
     16 Bytes  100.0%   1                         malloc 
```

从我做的一点挖掘中，我发现 getpwuid 是一个由`<pwd.h>`. 在 Instruments 中双击`si_user_byuid`会出现“No Source”标志，双击`getpwuid`会出现 arm7 组件（很抱歉通知您我不熟悉）：

```
+0x0    push                           {r4, r5, r7, lr}
+0x2    add                            r7, sp, #8
+0x4    movw.w                         r5, #18506  ; 0x484a
+0x8    movt.w                         r5, #3265  ; 0xcc1
+0xc    mov                            r4, r0
+0xe    add                            r5, r15
+0x10   ldr                            r0, [r5]
+0x12   cbnz                           getpwuid
+0x14   movw.w                         r0, #47748  ; 0xba84
+0x18   movt.w                         r0, #1  ; 0x1
+0x1c   add                            r0, r15
+0x1e   bl.w                           getpwuid
+0x22   str                            r0, [r5]
+0x24   mov                            r1, r4
+0x26   bl.w                           getpwuid
+0x2a   mov                            r4, r0
+0x2c   movs                           r0, #201  ; 0xc9
+0x2e   mov                            r1, r4
+0x30   bl.w                           getpwuid
+0x34   movs                           r0, #0  ; 0x0
+0x36   cmp                            r4, #0  ; 0x0
+0x38   it                             ne
+0x3a   addne.w                        r0, r4, #28  ; 0x1c
+0x3e   pop                            {r4, r5, r7, pc} 
```

所以：

*   有没有人见过这个 ？
*   会不会是假阳性？
*   会不会仅限于 iOS 5.1.1 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:10:39.090

这是[整个事情](http://www.opensource.apple.com/source/Libinfo/Libinfo-391/lookup.subproj/)的来源，从`getpwuid`. 快速浏览一下，似乎有一些缓存正在进行，所以除非泄漏很大，否则我不会太担心。

# c++ - 没有可用于“libstdc++-6!_ZNSo9_M_insertIlEERSoT_() at 0x6fc868a8”的源

> ID：11160179
> 
> 赞同：2
> 
> 时间：2012-06-22T16:18:50.400
> 
> 标签：c++, eclipse, mingw, libstdc++

我在 Windows 7 Starter 32bit 下将 MinGW（最初与 mingw-get-inst-20120426.exe 一起安装）与 Eclipse for C/C++（Indigo SR2）结合使用，我刚刚升级到 gcc/g++ 4.7.0：

```
mingw-get update
mingw-get upgrade 
```

我修复了 Eclipse 保留旧版本参考的问题 ( [https://bugs.eclipse.org/bugs/show_bug.cgi?id=206372#c2](https://bugs.eclipse.org/bugs/show_bug.cgi?id=206372#c2) )

但是当我尝试运行一个像这个一样简单的程序时，它崩溃了：

```
#include <iostream>
#include <cstdlib>
using namespace std;
int main (int argc, char* argv[])
{
    cout << "one = " << 1 << "\n";
    return EXIT_SUCCESS;
} 
```

当我尝试调试时，问题似乎来自以下`cout`行：

```
cout << "one = " << 1 << "\n"; 
```

如果我跨过它，Eclipse 会向我发出这个错误信号：

```
No source available for "libstdc++-6!_ZNSo9_M_insertIlEERSoT_() at 0x6fc868a8" 
```

这是单击“跳过”该行后的 IDE 屏幕截图：http: [//i.stack.imgur.com/QexxQ.png](http://i.stack.imgur.com/QexxQ.png)

同样的程序以前运行良好，但现在不行了。

我什至创建了一个新项目（我没有触及编译器/链接器选项中的任何内容），但同样的问题仍然存在。

请问有人有解决办法吗？

预先感谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-24T10:03:28.667

找到了 ！:D

正如 Dennis 所提到的，运行时 dll 似乎与链接时使用的不同。

实际上，Eclipse 链接到**C:\mingw\bin\libstdc++-6.dll**但在执行时，使用了另一个（即**C:\Program Files\gnuplot\bin\libstdc++-6.dll** >_<），因为[**gnuplot**](http://www.gnuplot.info/) （即我很久以前安装了，顺便说一句不错的软件；））将其安装目录添加到**PATH**（即使C：\ mingw \ bin也在PATH中）（它还添加了一些其他环境变量）

我很生气，我删除了与 gnuplot lol 相关的所有内容（即它从 PATH 中的路径、它的环境变量，然后我卸载了程序）。我还删除了 Cygwin（虽然它不在 PATH 中，但我已经很久没有使用它了，所以......）

然后，我升级到4.7

```
mingw-get update
mingw-get upgrade 
```

我也做了 Eclipse 的事情

现在一切都很好：

```
one = 1 
```

:)

```
C:\Windows\System32>gcc --version
gcc (GCC) 4.7.0
Copyright (C) 2012 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

C:\Windows\System32>g++ --version
g++ (GCC) 4.7.0
Copyright (C) 2012 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
```

如果有帮助，我使用[**Dependency Walker**](http://dependencywalker.com/)来确定可执行文件使用了哪个运行时 dll（只需在 Dependency Walker 中加载 exe，然后右键单击 LIBSTDC++-6.DLL > Properties ）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T11:22:44.450

好吧，我知道这个问题得到了很好的回答，但我只是想分享我的经验，因为我被它困惑了很长时间（是的，我很久没有用 C++ 编码了，哈哈）

我意识到这是因为我在安装 JAVA eclipse 时安装了 MinGW 4.8.1 并删除了旧版本（可能是 4.6.2 我记不太清楚了），并且找不到 dll。

我没有更改 Path 中的任何内容。我所做的只是重新安装 MinGW，单击并单击并更新它提供的所有 lib 文件，然后 cin & cout 工作。好吧，我真的不知道为什么会这样，但是现在可以了。

# macos - 强制将 LSUIElement“附件”应用程序放在前面

> ID：11160180
> 
> 赞同：2
> 
> 时间：2012-06-22T16:18:54.270
> 
> 标签：macos, cocoa, nswindow

我有一个`LSUIElement`应用程序需要将其状态保持为`LSUIElement`（它不能有停靠图标）此应用程序由插件启动和处理。

当我更改应用程序使其成为“常规”应用程序（不带`LSUIElement`）时，它`[NSApp activateIgnoringOtherApps:YES]`可以完美运行。但是，当我将其设置为`LSUIElement`它时，它会显示窗口，但该窗口被卡在 safari 后面（插件正在运行的地方），但在其他所有内容之上。我在打电话`-[NSWindow makeKeyAndOrderFront:self];`，但这没有任何区别。

需要明确的是，“插件”方面是无关紧要的，因为插件和应用程序是两个独立的进程。该插件向应用程序发送一个事件（通过一个马赫端口），该应用程序调用一些代码来打开窗口并使其成为焦点。问题是使其成为焦点的代码仅在它不是`LSUIElement`应用程序时才有效。

我已经详尽地搜索了一个现有的调用来完成这项工作，我愿意接受有关如何伪造鼠标点击的建议，甚至运行一些苹果脚本来完成这项工作，也许有一种未记录的方法可以做到这一点。

Apple 文档中的`LSUIElement`状态“应用程序没有出现在 Dock 中并且没有菜单栏，但它可以通过编程方式激活”，但我找不到启用此功能的魔法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-03-01T10:24:45.610

您需要先激活您的应用程序：

```
[NSApp activateIgnoringOtherApps:YES]; 
```

然后让你的窗口成为关键窗口：

```
[NSWindow makeKeyAndOrderFront:nil]; 
```

这适用于我的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T07:27:49.093

以下方法适用于“LSUIElement”设置为“1”的应用程序，即使整个应用程序都使用 Cocoa：

```
ProcessSerialNumber psn;
if (noErr == GetCurrentProcess(&psn))
{
    (OSStatus)SetFrontProcess(&psn);
} 
```

（这是 Carbon API 的一部分。）

# c# - 更新记录时性能非常慢

> ID：11160187
> 
> 赞同：0
> 
> 时间：2012-06-22T16:19:12.600
> 
> 标签：c#, performance, postgresql

我正在编写连接到数据库的 C# 应用程序，进行耦合选择，然后将记录插入网络中的服务器。

但是我有大约 40k 条记录，我的程序处理一个记录，比如 1 秒。

我不知道如何提高性能。这是我的 sql getter 和 inserter。有什么建议么？

```
 public bool insert_and_ConfirmSQL(String Query, String comments)
    {
        bool success = false;
        NpgsqlCommand cmd = new NpgsqlCommand();
        NpgsqlConnection mycon = new NpgsqlConnection();
        string connstring = String.Format("Server={0};Port={1}; User Id={2};Password={3};Database={4};", tbHost, tbPort, tbUser, tbPass, tbDataBaseName);
        mycon.ConnectionString = connstring;
        cmd = mycon.CreateCommand();
        cmd.CommandText = Query;
        mycon.Open();

        int temp = 0;
        try
        {
            temp = cmd.ExecuteNonQuery();
            success = true;
        }
        catch
        {
            success = false;
        }
        finally
        {
            if (mycon.State.ToString() == "Open")
            {
                mycon.Close();
            }
        }
        return success;
    }

    public String getString(String sql, NpgsqlConnection conn)
    {
        using (DataSet ds = new DataSet())
        {
            using (NpgsqlDataAdapter da = new NpgsqlDataAdapter(sql, conn))
            {
                da.Fill(ds);
                if (ds.Tables.Count > 0)
                {
                    DataTable dt = ds.Tables[0];
                    //  check count of Rows 
                    if (dt.Rows.Count > 0)
                    {
                        object o = dt.Rows[0][0];
                        if (o != DBNull.Value && o != null)
                        {
                            return o.ToString();
                        }
                    }
                }
            }
        }
        // Return default value 
        return "";
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:36:31.263

没有机会帮助您处理 sql 语句，因为我们不知道它们。

唯一（猜测）可见的问题是您每次都尝试使用新连接循环 40K 记录（您知道如何）。作为您的代码提供的两个例程正是这样做的。那么你需要 40K 调用 insert_and_ConfirmSQL 和/或另外 40K 调用 getString 例程吗？

如果您真的循环，则更新您的代码以仅使用一个连接而不关闭它；数据集也可以这样做（使用前必须清除它：ds.Clear()）。

不用说，如果您的查询很大（就数据而言），和/或索引不涵盖查询，那么预计会出现延迟。

试试这种方法，让我们知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T16:28:37.640

有时您可以通过使用 sql Datareader 而不是 DataSet 来提高性能。

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader(v=vs.100).aspx#Y0](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader(v=vs.100).aspx#Y0)

然后，您可以在从数据库中读取数据时检查数据。

所以我会用 DataReader 实现上面的代码并重新计时。

编辑：尤其是那个 getString 方法。如果 ds.Fill 占用了 40k 行，这可能是您的性能问题的原因。

# php - 从头开始创建基于表单的 PHP 应用程序

> ID：11160191
> 
> 赞同：0
> 
> 时间：2012-06-22T16:19:45.063
> 
> 标签：php, mysql

我在一家制造零件的公司实习，必须对色度、亮度、对比度等进行多项测试。目前，他们使用 MS Access 作为前端来输入他们的数据，然后在完成后将其作为报告打印出来。数据不存储在任何地方。此外，出于某种原因，他们还使用 excel 创建了这些“数据表格”，这些表格也不会将数据存储在任何地方。我的工作是找到一种解决方案，允许他们将所有数据存储在 mySQL 数据库中以供以后使用，但是，由于他们使用多个 UI 来输入数据，我不确定该怎么做。我已经和我的上级达成协议，他们需要合并到一个 UI 中，所以...

这是我的选择：

1) 尝试将他们已经正常工作的 MS Access UI 链接到我的 mySQL 数据库（这可能是一个可怕的失败，因为我对 Access 一无所知），并将所有 Excel 表单转换为 Access 表单

2) 将他们的 Access 表单转换为 Excel 表单，然后必须处理从 excel 捕获数据，这是一项极其繁琐的编码工作，因为我需要在数百个文档中捕获大约 50 多个单元格。

3) 创建一个 PHP 应用程序，允许管理员添加属性并定义字段，这些字段将为该表单创建一个表单和相应的 mySQL 表。基本上，获取 Access 表单构建器/表单的功能并将它们放入 Web 应用程序。从头开始这样做会需要很长时间吗？

对不起，这很长，但我是这里唯一有编程背景的人，我只是一名实习生，哈哈，所以我需要一些建议。

谢谢马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:40:15.963

方法 3 可以使用[Symphony CMS](http://symphony-cms.com/)快速完成。您将为每个表单创建一个[部分](http://symphony-cms.com/learn/concepts/view/sections/)，然后您（或管理员）将使用 Symphony 的 GUI 部分编辑器将字段添加到该部分。然后该表单将在 CMS 中可用，并准备好添加条目。

Symphony CMS 非常灵活，您可以使用它生成报告（HTML 或其他格式）。它还有一个[RESTful API](http://symphonyextensions.com/extensions/rest_api/)。

还有一个[CSV 导入扩展](http://symphonyextensions.com/extensions/importcsv/)，它可能对您的 Excel 数据有好处。

# parsing - 如何将自由格式的街道/邮政地址从文本中解析为组件

> ID：11160192
> 
> 赞同：157
> 
> 时间：2012-06-22T16:19:47.513
> 
> 标签：parsing, street-address

我们主要在美国开展业务，并试图通过将所有地址字段合并到一个文本区域来改善用户体验。但是有几个问题：

*   用户输入的地址可能不正确或格式不正确
*   地址必须分成几部分（街道、城市、州等）以处理信用卡付款
*   用户可以输入的不仅仅是他们的地址（比如他们的名字或公司）
*   谷歌可以做到这一点，但服务条款和查询限制令人望而却步，尤其是在预算紧张的情况下

显然，这是一个常见的问题：

*   [解析地址的PHP脚本？](https://stackoverflow.com/questions/5709260/php-script-to-parse-address)
*   [如何解析自由格式地址以保存到数据库中](https://stackoverflow.com/questions/2425899/how-do-i-parse-the-free-format-address-to-save-into-the-database)
*   [java邮政地址解析器](https://stackoverflow.com/questions/877742/java-postal-address-parser)
*   [提取地址组件的更有效方法](https://stackoverflow.com/questions/8313876/more-efficient-way-to-extract-address-components)
*   [如何在联系人屏幕中显示预先填充的邮政地址，并在 android 上显示街道、城市、zip](https://stackoverflow.com/questions/8488777/how-can-i-show-a-pre-populated-postal-address-in-contacts-screen-with-street-c)
*   [PHP正则表达式美国地址](https://stackoverflow.com/questions/1381085/php-regexp-us-address)

有没有办法将地址与其周围的文本隔离开来并将其分解成碎片？是否有正则表达式来解析地址？

* * *

## 回答 #1

> 赞同：320
> 
> 时间：2012-06-22T16:19:48.187

我在地址验证公司工作时经常看到这个问题。我在这里发布答案是为了让搜索相同问题的程序员更容易获得它。我所在的公司处理了数十亿个地址，我们在这个过程中学到了很多东西。

首先，我们需要了解一些关于地址的事情。

# 地址[不规则](http://en.wikipedia.org/wiki/Regular_language)

这意味着正则表达式已经过时了。我已经看到了这一切，从以特定格式匹配地址的简单正则表达式到这个：

> /\s+(\d{2,5}\s+)(?![a|p]m\b)(([a-zA-Z|\s+]{1,5}){1,2}) ?([\s|,|.]+)?(([a-zA-Z|\s+]{1,30}){1,4})(court|ct|street|st|drive|dr|车道|ln|道路|rd|blvd)([\s|,|.|;]+)?(([a-zA-Z|\s+]{1,30}){1,2})([ \s|,|.]+)?\b(AK|AL|AR|AZ|CA|CO|CT|DC|DE|FL|GA|GU|HI|IA|ID|IL|IN|KS|KY |LA|MA|MD|ME|MI|MN|MO|MS|MT|NC|ND|NE|NH|NJ|NM|NV|NY|OH|OK|OR|PA|RI|SC|SD|TN |TX|UT|VA|VI|VT|WA|WI|WV|WY)([\s|,|.]+)?(\s+\d{5})?([\s|,|.] +)/我

...[至此](http://usaddress.codeplex.com/SourceControl/changeset/view/8750#159596)，一个 900 多个行类文件会动态生成一个超大规模的正则表达式以匹配更多内容。我不推荐这些（例如，[这是上面正则表达式的一个小提琴，它会犯很多错误](http://jsfiddle.net/isuelt/rMC6P/11/)）。没有一个简单的魔法公式可以让它发挥作用。在理论上和理论上，*用*正则表达式匹配地址是不可能的。

[USPS 出版物 28](http://pe.usps.gov/text/pub28/welcome.htm)记录了可能的多种地址格式，以及它们的所有关键字和变体。最糟糕的是，地址通常不明确。单词可以表示不止一件事（“St”可以是“Saint”或“Street”），而且我很确定有些词是他们发明的。（谁知道“Stravenue”是街道后缀？）

您需要一些真正理解地址的代码，如果该代码确实存在，那就是商业机密。但如果你真的很喜欢，你可能会自己动手。

# 地址有意想不到的形状和大小

以下是一些人为的（但完整的）地址：

```
1)  102 main street
    Anytown, state

2)  400n 600e #2, 52173

3)  p.o. #104 60203 
```

即使这些也可能是有效的：

```
4)  829 LKSDFJlkjsdflkjsdljf Bkpw 12345

5)  205 1105 14 90210 
```

显然，这些都不是标准化的。不保证标点和换行符。这是发生了什么：

1.  **数字 1**是完整的，因为它包含街道地址以及城市和州。有了这些信息，就足以识别地址，它可以被认为是“可交付的”（通过一些标准化）。

2.  **数字 2**是完整的，因为它包含街道地址（带有次要/单元号）和 5 位数的邮政编码，这足以识别地址。

3.  **3 号**是一个完整的邮政信箱格式，因为它包含一个邮政编码。

4.  **数字 4**也是完整[的，因为邮政编码是唯一的](https://ribbs.usps.gov/cassmass/documents/tech_guides/CYCLEN/UniqueZIPCode.pdf)，这意味着私人实体或公司购买了该地址空间。唯一的邮政编码适用于大容量或集中的交付空间。任何地址为邮政编码 12345 的东西都会送到位于纽约州斯克内克塔迪的通用电气公司。此示例不会特别针对任何人，但 USPS 仍会提供。

5.  **5号**也是完整的，信不信由你。仅使用这些数字，就可以在针对所有可能地址的数据库进行解析时发现完整地址。当您将每个数字视为一个组成部分时，填写缺少的方向、辅助指示符和 ZIP+4 代码是微不足道的。这是完全扩展和标准化的样子：

> 205 N 1105 W Apt 14
> 
> 比佛利山庄 CA 90210-5221

# 地址数据不是您自己的

在大多数向许可供应商提供官方地址数据的国家/地区，地址数据本身属于管理机构。在美国，USPS 拥有这些地址。加拿大邮政、皇家邮政和其他公司也是如此，尽管每个国家/地区执行或定义所有权的方式略有不同。了解这一点很重要，因为它通常禁止对地址数据库进行逆向工程。您必须小心如何获取、存储和使用数据。

谷歌地图是快速修复地址的常用方法，但[TOS](https://developers.google.com/maps/terms)相当禁止；例如，您不能在不显示谷歌地图的情况下使用他们的数据或 API，并且只能用于非商业目的（除非您付费），并且您不能存储数据（临时缓存除外）。说得通。谷歌的数据是世界上最好的。但是，谷歌地图不会*验证*地址。如果地址不存在，它仍会显示地址*存在*时的位置（在您自己的街道上尝试；使用您知道*不*存在的门牌号）。这有时很有用，但请注意这一点。

Nominatim 的[使用政策](https://wiki.openstreetmap.org/wiki/Nominatim_usage_policy)同样受到限制，特别是对于大批量和商业用途，并且数据大多来自免费来源，因此维护得不好（例如开放项目的性质）。但是，这可能仍然适合您的需求。一个伟大的社区支持它。

USPS 本身有一个 API，但[它下降了很多](https://www.shippingapimonitor.com/history.html?api=usps)，并且没有任何保证或支持。它也可能很难使用。有些人很少使用它，没有任何问题。但很容易忽略 USPS 要求您仅使用他们的 API 来确认通过他们运送的地址。

# 人们希望地址很难

不幸的是，我们已经使我们的社会习惯于期望地址变得复杂。互联网上有很多关于此的优秀 UX 文章。尽管如此，事实是，如果您有一个包含单个字段的地址表单，这就是用户所期望的，即使它使不符合表单期望格式的边缘情况地址变得更加困难，或者表单可能需要一个字段它不应该。或者用户不知道将地址的某个部分放在哪里。

这些天我可以继续谈论糟糕的结帐表单的用户体验，但相反，我会说将地址组合到一个字段中将是一个*受欢迎*的变化——人们将能够以他们认为合适的方式输入他们的地址，而不是试图找出你冗长的表格。但是，这种变化是*出乎意料*的，用户一开始可能会觉得有点刺耳。请注意这一点。

通过将国家/地区字段放在地址之前，可以部分缓解这种痛苦。当他们首先填写国家/地区字段时，您就知道如何显示您的表单。也许你有一个处理单字段美国地址的好方法，所以如果他们选择美国，你可以将你的表单缩减为单个字段，否则显示组件字段。只是要考虑的事情！

# 现在我们知道为什么很难了；你能为这个做什么？

USPS 通过称为 CASS™ 认证的流程向供应商授予许可，以向客户提供经过验证的地址。这些供应商可以访问每月更新的 USPS 数据库。他们的软件必须符合严格的标准才能获得认证，而且他们通常不需要同意上述限制条款。

许多经过 CASS 认证的公司可以处理列表或拥有 API：Melissa Data、Experian QAS 和 SmartyStreets，仅举几例。

*（由于“广告”受到抨击，我在这一点上截断了我的答案。找到适合你的解决方案取决于你。）*

**真相：**真的，伙计们，我不在这些公司工作。这不是广告。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2017-07-11T08:34:28.167

libpostal：一个用于解析地址的开源库，使用来自 OpenStreetMap、OpenAddresses 和 OpenCage 的数据进行训练。

[https://github.com/openvenues/libpostal](https://github.com/openvenues/libpostal) （[有关它的更多信息](https://mapzen.com/blog/inside-libpostal/)）

其他工具/服务：

*   [http://www.gisgraphy.com](http://www.gisgraphy.com) 免费、开源、随时可用的地理编码器和地理定位网络服务，集成了 OpenStreetMap、GeoNames 和 Quattroshapes。

*   [https://github.com/kodapan/osm-common](https://github.com/kodapan/osm-common) 用于访问 OpenStreetMap 服务、解析和处理数据的库。

*   [http://wiki.openstreetmap.org/wiki/Nominatim](http://wiki.openstreetmap.org/wiki/Nominatim)

*   [http://address-parser.net/](http://address-parser.net/)

*   [http://geoservices.tamu.edu/Services/AddressNormalization/](http://geoservices.tamu.edu/Services/AddressNormalization/)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-04-05T05:25:59.197

有许多街道地址解析器。它们有两种基本风格——一种有地名和街道名称数据库，另一种没有。

正则表达式街道地址解析器可以轻松获得高达 95% 的成功率。然后你开始处理不寻常的情况。CPAN 中的 Perl，“Geo::StreetAddress::US”，差不多就是这样。有 Python 和 Javascript 端口，都是开源的。我在 Python 中有一个改进的版本，它通过处理更多的案例来略微提高成功率。但是，要正确完成最后 3%，您需要数据库来帮助消除歧义。

具有 3 位邮政编码和美国州名和缩写的数据库是一个很大的帮助。当解析器看到一致的邮政编码和州名时，它可以开始锁定格式。这对美国和英国非常有效。

正确的街道地址解析从末尾开始并向后工作。USPS 系统就是这样做的。最后地址最不模糊，国家名称、城市名称和邮政编码相对容易识别。街道名称通常可以被隔离。街道上的位置是最难解析的；在那里你会遇到诸如“五楼”和“斯台普斯馆”之类的东西。这时候数据库就大有帮助了。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-12-22T00:41:38.673

**更新：Geocode.xyz 现在可以在全球范围内使用。示例见[https://geocode.xyz](https://geocode.xyz)**

对于美国、墨西哥和加拿大，请参阅[geocoder.ca](http://geocoder.ca)。

例如：

> 输入：[main 和 arthur kill rd new york 交叉点附近发生的事情](http://geocoder.ca/?locate=something%20%20going%20on%20near%20the%20intersection%20of%20main%20and%20arthur%20kill%20rd%20new%20york&geoit=xml)
> 
> 输出：
> 
> ```
> <geodata>
>   <latt>40.5123510000</latt>
>   <longt>-74.2500500000</longt>
>   <AreaCode>347,718</AreaCode>
>   <TimeZone>America/New_York</TimeZone>
>   <standard>
>     <street1>main</street1>
>     <street2>arthur kill</street2>
>     <stnumber/>
>     <staddress/>
>     <city>STATEN ISLAND</city>
>     <prov>NY</prov>
>     <postal>11385</postal>
>     <confidence>0.9</confidence>
>   </standard>
> </geodata> 
> ```

您还可以在 Web 界面中检查结果或以 Json 或 Jsonp 的形式输出。例如。[我正在寻找纽约大街 123 号附近的餐馆](http://geocoder.ca/?locate=I%27m%20looking%20for%20restaurants%20around%20123%20Main%20Street%2C%20New%20York&geoit=GeoCode)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-03-15T18:59:44.003

没有代码？耻辱！

这是一个简单的 JavaScript 地址解析器。由于马特在上面的论文中给出的每一个原因，这都非常糟糕（我几乎 100% 同意：地址是复杂的类型，人类会犯错误；最好外包和自动化——当你负担得起的时候）。

但我没有哭，而是决定尝试：

此代码适用于解析大多数 Esri 结果`findAddressCandidate`以及其他一些（反向）地理编码器，它们返回单行地址，其中街道/城市/州由逗号分隔。您可以根据需要扩展或编写特定于国家/地区的解析器。或者只是用这个作为案例研究这个练习有多么具有挑战性，或者我在 JavaScript 上有多糟糕。我承认我只花了大约 30 分钟（未来的迭代可能会添加缓存、zip 验证和状态查找以及用户位置上下文），但它适用于我的用例：最终用户看到将地理编码搜索响应解析为 4 的表单文本框。如果地址解析出错（这很少见，除非源数据很差），这没什么大不了的——用户可以验证并修复它！（但对于自动化解决方案可以丢弃/忽略或标记为错误，因此开发人员可以支持新格式或修复源数据。）

```
/* 
address assumptions:
- US addresses only (probably want separate parser for different countries)
- No country code expected.
- if last token is a number it is probably a postal code
-- 5 digit number means more likely
- if last token is a hyphenated string it might be a postal code
-- if both sides are numeric, and in form #####-#### it is more likely
- if city is supplied, state will also be supplied (city names not unique)
- zip/postal code may be omitted even if has city & state
- state may be two-char code or may be full state name.
- commas: 
-- last comma is usually city/state separator
-- second-to-last comma is possibly street/city separator
-- other commas are building-specific stuff that I don't care about right now.
- token count:
-- because units, street names, and city names may contain spaces token count highly variable.
-- simplest address has at least two tokens: 714 OAK
-- common simple address has at least four tokens: 714 S OAK ST
-- common full (mailing) address has at least 5-7:
--- 714 OAK, RUMTOWN, VA 59201
--- 714 S OAK ST, RUMTOWN, VA 59201
-- complex address may have a dozen or more:
--- MAGICICIAN SUPPLY, LLC, UNIT 213A, MAGIC TOWN MALL, 13 MAGIC CIRCLE DRIVE, LAND OF MAGIC, MA 73122-3412
*/

var rawtext = $("textarea").val();
var rawlist = rawtext.split("\n");

function ParseAddressEsri(singleLineaddressString) {
  var address = {
    street: "",
    city: "",
    state: "",
    postalCode: ""
  };

  // tokenize by space (retain commas in tokens)
  var tokens = singleLineaddressString.split(/[\s]+/);
  var tokenCount = tokens.length;
  var lastToken = tokens.pop();
  if (
    // if numeric assume postal code (ignore length, for now)
    !isNaN(lastToken) ||
    // if hyphenated assume long zip code, ignore whether numeric, for now
    lastToken.split("-").length - 1 === 1) {
    address.postalCode = lastToken;
    lastToken = tokens.pop();
  }

  if (lastToken && isNaN(lastToken)) {
    if (address.postalCode.length && lastToken.length === 2) {
      // assume state/province code ONLY if had postal code
      // otherwise it could be a simple address like "714 S OAK ST"
      // where "ST" for "street" looks like two-letter state code
      // possibly this could be resolved with registry of known state codes, but meh. (and may collide anyway)
      address.state = lastToken;
      lastToken = tokens.pop();
    }
    if (address.state.length === 0) {
      // check for special case: might have State name instead of State Code.
      var stateNameParts = [lastToken.endsWith(",") ? lastToken.substring(0, lastToken.length - 1) : lastToken];

      // check remaining tokens from right-to-left for the first comma
      while (2 + 2 != 5) {
        lastToken = tokens.pop();
        if (!lastToken) break;
        else if (lastToken.endsWith(",")) {
          // found separator, ignore stuff on left side
          tokens.push(lastToken); // put it back
          break;
        } else {
          stateNameParts.unshift(lastToken);
        }
      }
      address.state = stateNameParts.join(' ');
      lastToken = tokens.pop();
    }
  }

  if (lastToken) {
    // here is where it gets trickier:
    if (address.state.length) {
      // if there is a state, then assume there is also a city and street.
      // PROBLEM: city may be multiple words (spaces)
      // but we can pretty safely assume next-from-last token is at least PART of the city name
      // most cities are single-name. It would be very helpful if we knew more context, like
      // the name of the city user is in. But ignore that for now.
      // ideally would have zip code service or lookup to give city name for the zip code.
      var cityNameParts = [lastToken.endsWith(",") ? lastToken.substring(0, lastToken.length - 1) : lastToken];

      // assumption / RULE: street and city must have comma delimiter
      // addresses that do not follow this rule will be wrong only if city has space
      // but don't care because Esri formats put comma before City
      var streetNameParts = [];

      // check remaining tokens from right-to-left for the first comma
      while (2 + 2 != 5) {
        lastToken = tokens.pop();
        if (!lastToken) break;
        else if (lastToken.endsWith(",")) {
          // found end of street address (may include building, etc. - don't care right now)
          // add token back to end, but remove trailing comma (it did its job)
          tokens.push(lastToken.endsWith(",") ? lastToken.substring(0, lastToken.length - 1) : lastToken);
          streetNameParts = tokens;
          break;
        } else {
          cityNameParts.unshift(lastToken);
        }
      }
      address.city = cityNameParts.join(' ');
      address.street = streetNameParts.join(' ');
    } else {
      // if there is NO state, then assume there is NO city also, just street! (easy)
      // reasoning: city names are not very original (Portland, OR and Portland, ME) so if user wants city they need to store state also (but if you are only ever in Portlan, OR, you don't care about city/state)
      // put last token back in list, then rejoin on space
      tokens.push(lastToken);
      address.street = tokens.join(' ');
    }
  }
  // when parsing right-to-left hard to know if street only vs street + city/state
  // hack fix for now is to shift stuff around.
  // assumption/requirement: will always have at least street part; you will never just get "city, state"  
  // could possibly tweak this with options or more intelligent parsing&sniffing
  if (!address.city && address.state) {
    address.city = address.state;
    address.state = '';
  }
  if (!address.street) {
    address.street = address.city;
    address.city = '';
  }

  return address;
}

// get list of objects with discrete address properties
var addresses = rawlist
  .filter(function(o) {
    return o.length > 0
  })
  .map(ParseAddressEsri);
$("#output").text(JSON.stringify(addresses));
console.log(addresses);
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<textarea>
27488 Stanford Ave, Bowden, North Dakota
380 New York St, Redlands, CA 92373
13212 E SPRAGUE AVE, FAIR VALLEY, MD 99201
1005 N Gravenstein Highway, Sebastopol CA 95472
A. P. Croll &amp; Son 2299 Lewes-Georgetown Hwy, Georgetown, DE 19947
11522 Shawnee Road, Greenwood, DE 19950
144 Kings Highway, S.W. Dover, DE 19901
Intergrated Const. Services 2 Penns Way Suite 405, New Castle, DE 19720
Humes Realty 33 Bridle Ridge Court, Lewes, DE 19958
Nichols Excavation 2742 Pulaski Hwy, Newark, DE 19711
2284 Bryn Zion Road, Smyrna, DE 19904
VEI Dover Crossroads, LLC 1500 Serpentine Road, Suite 100 Baltimore MD 21
580 North Dupont Highway, Dover, DE 19901
P.O. Box 778, Dover, DE 19903
714 S OAK ST
714 S OAK ST, RUM TOWN, VA, 99201
3142 E SPRAGUE AVE, WHISKEY VALLEY, WA 99281
27488 Stanford Ave, Bowden, North Dakota
380 New York St, Redlands, CA 92373
</textarea>
<div id="output">
</div>
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-06-04T23:27:17.717

[对于美国`usaddress`](https://usaddress.readthedocs.io/en/latest/)地址解析，我更[喜欢](https://usaddress.readthedocs.io/en/latest/)[使用`pip`](https://pypi.org/project/usaddress/).

```
python3 -m pip install usaddress 
```

使用示例：

```
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# address_parser.py
import sys
from usaddress import tag
from json import dumps, loads

if __name__ == '__main__':
    tag_mapping = {
        'Recipient': 'recipient',
        'AddressNumber': 'addressStreet',
        'AddressNumberPrefix': 'addressStreet',
        'AddressNumberSuffix': 'addressStreet',
        'StreetName': 'addressStreet',
        'StreetNamePreDirectional': 'addressStreet',
        'StreetNamePreModifier': 'addressStreet',
        'StreetNamePreType': 'addressStreet',
        'StreetNamePostDirectional': 'addressStreet',
        'StreetNamePostModifier': 'addressStreet',
        'StreetNamePostType': 'addressStreet',
        'CornerOf': 'addressStreet',
        'IntersectionSeparator': 'addressStreet',
        'LandmarkName': 'addressStreet',
        'USPSBoxGroupID': 'addressStreet',
        'USPSBoxGroupType': 'addressStreet',
        'USPSBoxID': 'addressStreet',
        'USPSBoxType': 'addressStreet',
        'BuildingName': 'addressStreet',
        'OccupancyType': 'addressStreet',
        'OccupancyIdentifier': 'addressStreet',
        'SubaddressIdentifier': 'addressStreet',
        'SubaddressType': 'addressStreet',
        'PlaceName': 'addressCity',
        'StateName': 'addressState',
        'ZipCode': 'addressPostalCode',
    }
    try:
        address, _ = tag(' '.join(sys.argv[1:]), tag_mapping=tag_mapping)
    except:
        with open('failed_address.txt', 'a') as fp:
            fp.write(sys.argv[1] + '\n')
        print(dumps({}))
    else:
        print(dumps(dict(address))) 
```

运行`address_parser.py`：

```
python3 address_parser.py 9757 East Arcadia Ave. Saugus MA 01906
{"addressStreet": "9757 East Arcadia Ave.", "addressCity": "Saugus", "addressState": "MA", "addressPostalCode": "01906"} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-08-25T11:40:44.533

我迟到了，但这是我多年前为澳大利亚编写的 Excel VBA 脚本。它可以很容易地修改以支持其他国家。我在这里创建了 C# 代码的 GitHub 存储库。我已经在我的网站上托管了它，你可以在这里下载它：http: [//jeremythompson.net/Rocks/ParseAddress.xlsm](http://jeremythompson.net/Rocks/ParseAddress.xlsm)

# 战略

对于任何邮政编码为数字或可以与正则表达式匹配的国家/地区，我的策略都非常有效：

1.  首先，我们检测假设为第一行的 First 和 Surname。通过取消选中复选框（称为“名称是顶行”，如下所示），可以轻松跳过名称并从地址开始。

2.  **接下来可以安全地预期由 Street 和 Number 组成的 Address 位于 Suburb 之前，而 St、Pde、Ave、Av、Rd、Cres、loop 等是分隔符。**

3.  检测 Suburb 与 State 甚至 Country 可以欺骗最复杂的解析器，因为可能存在冲突。为了克服这个问题，我使用 PostCode 查找基于这样一个事实，即在剥离街道和公寓/单元号码以及 PoBox、Ph、*Fax*、Mobile 等之后，只保留 PostCode 号码。这很容易与正则表达式匹配，然后查找郊区和国家。

    > 您的国家邮局服务将免费提供包含郊区和州的邮政编码列表，您可以将其存储在 Excel 表、数据库表、文本/json/xml 文件等中。

4.  最后，由于某些邮政编码有多个郊区，我们检查地址中出现的郊区。

* * *

# 例子

[![Excel 单元格的屏幕截图](../Images/68d4881190e141e8dbd4db54cb84db53.png)](https://i.stack.imgur.com/SbH9F.png)

# VBA 代码

免责声明，我知道这段代码并不完美，甚至写得很好，但是它很容易转换为任何编程语言并在任何类型的应用程序中运行。该策略是取决于您的国家和规则的答案，以此代码为例：

```
Option Explicit

Private Const TopRow As Integer = 0

Public Sub ParseAddress()
Dim strArr() As String
Dim sigRow() As String
Dim i As Integer
Dim j As Integer
Dim k As Integer
Dim Stat As String
Dim SpaceInName As Integer
Dim Temp As String
Dim PhExt As String

On Error Resume Next

Temp = ActiveSheet.Range("Address")

'Split info into array
strArr = Split(Temp, vbLf)

'Trim the array
For i = 0 To UBound(strArr)
strArr(i) = VBA.Trim(strArr(i))
Next i

'Remove empty items/rows    
ReDim sigRow(LBound(strArr) To UBound(strArr))
For i = LBound(strArr) To UBound(strArr)
    If Trim(strArr(i)) <> "" Then
        sigRow(j) = strArr(i)
        j = j + 1
    End If
Next i
ReDim Preserve sigRow(LBound(strArr) To j)

'Find the name (MUST BE ON THE FIRST ROW UNLESS CHECKBOX UNTICKED)
i = TopRow
If ActiveSheet.Shapes("chkFirst").ControlFormat.Value = 1 Then

SpaceInName = InStr(1, sigRow(i), " ", vbTextCompare) - 1

If ActiveSheet.Shapes("chkConfirm").ControlFormat.Value = 0 Then
ActiveSheet.Range("FirstName") = VBA.Left(sigRow(i), SpaceInName)
Else
 If MsgBox("First Name: " & VBA.Mid$(sigRow(i), 1, SpaceInName), vbQuestion + vbYesNo, "Confirm Details") = vbYes Then ActiveSheet.Range("FirstName") = VBA.Left(sigRow(i), SpaceInName)
End If

If ActiveSheet.Shapes("chkConfirm").ControlFormat.Value = 0 Then
ActiveSheet.Range("Surname") = VBA.Mid(sigRow(i), SpaceInName + 2)
Else
  If MsgBox("Surame: " & VBA.Mid(sigRow(i), SpaceInName + 2), vbQuestion + vbYesNo, "Confirm Details") = vbYes Then ActiveSheet.Range("Surname") = VBA.Mid(sigRow(i), SpaceInName + 2)
End If
sigRow(i) = ""
End If

'Find the Street by looking for a "St, Pde, Ave, Av, Rd, Cres, loop, etc"
For i = 1 To UBound(sigRow)
If Len(sigRow(i)) > 0 Then
    For j = 0 To 8
    If InStr(1, VBA.UCase(sigRow(i)), Street(j), vbTextCompare) > 0 Then

    'Find the position of the street in order to get the suburb
    SpaceInName = InStr(1, VBA.UCase(sigRow(i)), Street(j), vbTextCompare) + Len(Street(j)) - 1

    'If its a po box then add 5 chars
    If VBA.Right(Street(j), 3) = "BOX" Then SpaceInName = SpaceInName + 5

    If ActiveSheet.Shapes("chkConfirm").ControlFormat.Value = 0 Then
    ActiveSheet.Range("Street") = VBA.Mid(sigRow(i), 1, SpaceInName)
    Else
      If MsgBox("Street Address: " & VBA.Mid(sigRow(i), 1, SpaceInName), vbQuestion + vbYesNo, "Confirm Details") = vbYes Then ActiveSheet.Range("Street") = VBA.Mid(sigRow(i), 1, SpaceInName)
    End If
    'Trim the Street, Number leaving the Suburb if its exists on the same line
    sigRow(i) = VBA.Mid(sigRow(i), SpaceInName) + 2
    sigRow(i) = Replace(sigRow(i), VBA.Mid(sigRow(i), 1, SpaceInName), "")

    GoTo PastAddress:
    End If
    Next j
End If
Next i
PastAddress:

'Mobile
For i = 1 To UBound(sigRow)
If Len(sigRow(i)) > 0 Then
    For j = 0 To 3
    Temp = Mb(j)
        If VBA.Left(VBA.UCase(sigRow(i)), Len(Temp)) = Temp Then
        If ActiveSheet.Shapes("chkConfirm").ControlFormat.Value = 0 Then
        ActiveSheet.Range("Mobile") = VBA.Mid(sigRow(i), Len(Temp) + 2)
        Else
          If MsgBox("Mobile: " & VBA.Mid(sigRow(i), Len(Temp) + 2), vbQuestion + vbYesNo, "Confirm Details") = vbYes Then ActiveSheet.Range("Mobile") = VBA.Mid(sigRow(i), Len(Temp) + 2)
        End If
    sigRow(i) = ""
    GoTo PastMobile:
    End If
    Next j
End If
Next i
PastMobile:

'Phone
For i = 1 To UBound(sigRow)
If Len(sigRow(i)) > 0 Then
    For j = 0 To 1
    Temp = Ph(j)
        If VBA.Left(VBA.UCase(sigRow(i)), Len(Temp)) = Temp Then

            'TODO: Detect the intl or national extension here.. or if we can from the postcode.
            If ActiveSheet.Shapes("chkConfirm").ControlFormat.Value = 0 Then
            ActiveSheet.Range("Phone") = VBA.Mid(sigRow(i), Len(Temp) + 3)
            Else
              If MsgBox("Phone: " & VBA.Mid(sigRow(i), Len(Temp) + 3), vbQuestion + vbYesNo, "Confirm Details") = vbYes Then ActiveSheet.Range("Phone") = VBA.Mid(sigRow(i), Len(Temp) + 3)
            End If

        sigRow(i) = ""
        GoTo PastPhone:
        End If
    Next j
End If
Next i
PastPhone:

'Email
For i = 1 To UBound(sigRow)
    If Len(sigRow(i)) > 0 Then
        'replace with regEx search
        If InStr(1, sigRow(i), "@", vbTextCompare) And InStr(1, VBA.UCase(sigRow(i)), ".CO", vbTextCompare) Then
        Dim email As String
        email = sigRow(i)
        email = Replace(VBA.UCase(email), "EMAIL:", "")
        email = Replace(VBA.UCase(email), "E-MAIL:", "")
        email = Replace(VBA.UCase(email), "E:", "")
        email = Replace(VBA.UCase(Trim(email)), "E ", "")
        email = VBA.LCase(email)

            If ActiveSheet.Shapes("chkConfirm").ControlFormat.Value = 0 Then
            ActiveSheet.Range("Email") = email
            Else
              If MsgBox("Email: " & email, vbQuestion + vbYesNo, "Confirm Details") = vbYes Then ActiveSheet.Range("Email") = email
            End If
        sigRow(i) = ""
        Exit For
        End If
    End If
Next i

'Now the only remaining items will be the postcode, suburb, country
'there shouldn't be any numbers (eg. from PoBox,Ph,Fax,Mobile) except for the Post Code

'Join the string and filter out the Post Code
Temp = Join(sigRow, vbCrLf)
Temp = Trim(Temp)

For i = 1 To Len(Temp)

Dim postCode As String
postCode = VBA.Mid(Temp, i, 4)

'In Australia PostCodes are 4 digits
If VBA.Mid(Temp, i, 1) <> " " And IsNumeric(postCode) Then

    If ActiveSheet.Shapes("chkConfirm").ControlFormat.Value = 0 Then
    ActiveSheet.Range("PostCode") = postCode
    Else
      If MsgBox("Post Code: " & postCode, vbQuestion + vbYesNo, "Confirm Details") = vbYes Then ActiveSheet.Range("PostCode") = postCode
    End If

    'Lookup the Suburb and State based on the PostCode, the PostCode sheet has the lookup
    Dim mySuburbArray As Range
    Set mySuburbArray = Sheets("PostCodes").Range("A2:B16670")

    Dim suburbs As String
    For j = 1 To mySuburbArray.Columns(1).Cells.Count
    If mySuburbArray.Cells(j, 1) = postCode Then
        'Check if the suburb is listed in the address
        If InStr(1, UCase(Temp), mySuburbArray.Cells(j, 2), vbTextCompare) > 0 Then

        'Set the Suburb and State
        ActiveSheet.Range("Suburb") = mySuburbArray.Cells(j, 2)
        Stat = mySuburbArray.Cells(j, 3)
        ActiveSheet.Range("State") = Stat

        'Knowing the State - for Australia we can get the telephone Ext
        PhExt = PhExtension(VBA.UCase(Stat))
        ActiveSheet.Range("PhExt") = PhExt

        'remove the phone extension from the number
        Dim prePhone As String
        prePhone = ActiveSheet.Range("Phone")
        prePhone = Replace(prePhone, PhExt & " ", "")
        prePhone = Replace(prePhone, "(" & PhExt & ") ", "")
        prePhone = Replace(prePhone, "(" & PhExt & ")", "")
        ActiveSheet.Range("Phone") = prePhone
        Exit For
        End If
    End If
    Next j
Exit For
End If
Next i

End Sub

Private Function PhExtension(ByVal State As String) As String
Select Case State
Case Is = "NSW"
PhExtension = "02"
Case Is = "QLD"
PhExtension = "07"
Case Is = "VIC"
PhExtension = "03"
Case Is = "NT"
PhExtension = "04"
Case Is = "WA"
PhExtension = "05"
Case Is = "SA"
PhExtension = "07"
Case Is = "TAS"
PhExtension = "06"
End Select
End Function

Private Function Ph(ByVal Num As Integer) As String
Select Case Num
Case Is = 0
Ph = "PH"
Case Is = 1
Ph = "PHONE"
'Case Is = 2
'Ph = "P"
End Select
End Function

Private Function Mb(ByVal Num As Integer) As String
Select Case Num
Case Is = 0
Mb = "MB"
Case Is = 1
Mb = "MOB"
Case Is = 2
Mb = "CELL"
Case Is = 3
Mb = "MOBILE"
'Case Is = 4
'Mb = "M"
End Select
End Function

Private Function Fax(ByVal Num As Integer) As String
Select Case Num
Case Is = 0
Fax = "FAX"
Case Is = 1
Fax = "FACSIMILE"
'Case Is = 2
'Fax = "F"
End Select
End Function

Private Function State(ByVal Num As Integer) As String
Select Case Num
Case Is = 0
State = "NSW"
Case Is = 1
State = "QLD"
Case Is = 2
State = "VIC"
Case Is = 3
State = "NT"
Case Is = 4
State = "WA"
Case Is = 5
State = "SA"
Case Is = 6
State = "TAS"
End Select
End Function

Private Function Street(ByVal Num As Integer) As String
Select Case Num
Case Is = 0
Street = " ST"
Case Is = 1
Street = " RD"
Case Is = 2
Street = " AVE"
Case Is = 3
Street = " AV"
Case Is = 4
Street = " CRES"
Case Is = 5
Street = " LOOP"
Case Is = 6
Street = "PO BOX"
Case Is = 7
Street = " STREET"
Case Is = 8
Street = " ROAD"
Case Is = 9
Street = " AVENUE"
Case Is = 10
Street = " CRESENT"
Case Is = 11
Street = " PARADE"
Case Is = 12
Street = " PDE"
Case Is = 13
Street = " LANE"
Case Is = 14
Street = " COURT"
Case Is = 15
Street = " BLVD"
Case Is = 16
Street = "P.O. BOX"
Case Is = 17
Street = "P.O BOX"
Case Is = 18
Street = "PO BOX"
Case Is = 19
Street = "POBOX"
End Select
End Function 
```

# jquery-ui - jQuery ui 删除事件？如何知道丢弃了什么？

> ID：11160200
> 
> 赞同：0
> 
> 时间：2012-06-22T16:20:05.310
> 
> 标签：jquery-ui

我有一个使用 JQUERY UI 的小 javascript。

当我收到“drop”事件调用时，我想知道哪些 HTML 元素被删除了。有人可以告诉我如何解决这个问题。

我知道如何确定哪个 HTML 元素收到了事件，但我不知道如何确定哪个 HTML 元素被删除

```
$(function() {
        $( "#draggable,#draggable2,#draggable3" ).draggable({ revert: "invalid" });
        $( "#draggable,#draggable2,#draggable3" ).droppable({
            accept: "#draggable,#draggable2,#draggable3",
            activeClass: "ui-state-hover",
            hoverClass: "ui-state-active",
            drop: function( event, ui ) {

                alert("destination:"+ this.id+" source:"+event.target.id);
                            alert("source is "+"???");
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:21:17.903

在`drop`函数中它将是`ui.draggable`.

# java - 检查字符串是否是数学表达式？

> ID：11160203
> 
> 赞同：2
> 
> 时间：2012-06-22T16:20:24.063
> 
> 标签：java, mathematical-expressions

我正在尝试用 Java 编写一个接受字符串作为参数的方法。现在这个字符串可能是一个数学表达式，也可能只是一个普通的字符串。只有当它是一个数学表达式时，我才必须对其进行评估，如果不是，则不要理会它。我将使用 java 脚本引擎评估数学表达式，如下所示：

```
ScriptEngineManager mgr = new ScriptEngineManager();
ScriptEngine engine = mgr.getEngineByName("JavaScript");
String foo = "1+2*10";
System.out.println(engine.eval(foo)); 
```

但问题是，如果我传递一个不是数学表达式的字符串，则会引发异常。我不想在我的代码中出现异常。我想要实现的是这样的：

```
if(isExpression(foo))
{
engine.eval(foo);
} 
```

这样我在评估它之前检查它是否是一个数学表达式。isExpression(foo) 方法有简单的实现吗？可能正在使用一些正则表达式？如果有的话请告诉我。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T16:23:58.083

对于像这样非常复杂的操作，查看它是否是有效公式的努力几乎与实际进行评估的努力一样多。

我建议您只尝试评估，并在失败时抛出特定于域的异常，例如CannotEvaluateFormulaException，然后捕获它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-22T16:24:55.250

问：是否有一个内置的 Java 函数来评估`1+2*10`一个表达式，`AB@C#!`不是吗？

答：没有。

使用正则表达式可能会让您很接近，但是在您确定它是否真的是算术表达式之前，需要*有人解析并尝试评估该字符串。*

建议：

调用你的引擎，并捕获任何异常。

PS：

无论如何，您都应该这样做，与“有效表达/非表达”无关。正确的？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-22T16:23:52.553

也许可以编写一个正则表达式来检查它，但这将是一个非常长且复杂的正则表达式。你通常做的是解析，也许是递归的，当有些东西不适合时，在表达式的某个子部分深处，你抛出一个异常。

只要你抓住它们，抛出异常就没有什么可耻的，这就是它们的用途！当然，抛出和捕获异常会有一些开销，但是您必须根据初始预检查来评估它，这将对*所有*表达式运行，无论是否正确。

也就是说，如果没有人有更好的现成建议，请查看[解释器模式](http://en.wikipedia.org/wiki/Interpreter_pattern)来评估您的表达式，特别是如果您有普通的数学表达式而没有自定义扩展/逻辑/任何东西（例如查看 @user1264811 解决方案！）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-22T16:24:47.090

你需要试一试。

参考[异常处理](http://docs.oracle.com/javase/tutorial/essential/exceptions/index.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-22T16:23:48.683

如果您想制作某种计算器，您可能想检查一下：users.cis.fiu.edu/~weiss/dsj2/code/Evaluator.java

# facebook - 获取指向 facebook iframe 选项卡的引用 url

> ID：11160207
> 
> 赞同：3
> 
> 时间：2012-06-22T16:20:34.643
> 
> 标签：facebook, iframe, refer

是否可以获得指向 Facebook 页面选项卡的引用 URL？

现在引用的 url 总是[http://static.ak.facebook.com/platform/page_proxy.php?v=5](http://static.ak.facebook.com/platform/page_proxy.php?v=5)我找不到任何关于这个主题的文档。facebook 是否提供此参数（例如，我在signed_request 中找不到它）。或者有什么解决方法吗？例如，如果我使用画布应用程序与 iframe 选项卡，它会起作用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:40:13.573

> 例如，如果我使用画布应用程序与 iframe 选项卡，它会起作用吗？

不，它们都以几乎相同的方式加载。

如果您可以控制指向画布/页面选项卡应用程序的链接，那么您可以将“app_data”参数添加到这些链接——当 Facebook 加载它时传递给你的应用程序——然后只评估它以区分不同的原点。

如果它是关于来自网络上某个地方的外部链接——那么我不知道如何获得一个实际的引荐来源网址，因为它总是 Facebook “链接”到 iframe 中的应用程序。

*可能*是您的应用程序的见解中有一些信息，但我还没有从那个角度检查它们。

# javascript - nodeJS 聊天应用程序已创建。如何运行

> ID：11160209
> 
> 赞同：0
> 
> 时间：2012-06-22T16:20:37.887
> 
> 标签：javascript, jquery, node.js, chat, multi-user

我使用此处的链接创建了 nodeJS io.socket 聊天应用程序 - [http://cestfait.ch/content/chat-webapp-nodejs](http://cestfait.ch/content/chat-webapp-nodejs)

我可以在我的笔记本电脑上运行它。我没有找到关于谷歌如何从其他机器连接到 nodeJS 应用程序的任何帮助。我有另一台笔记本电脑，我通过 wifi 连接。

现在我真的很想知道如何将另一个用户从另一台笔记本电脑连接到我的第一台笔记本电脑上运行的 nodeJS 服务器。

我将非常感谢您的帮助。任何广义上的帮助也可以。

**编辑 1：** 当我尝试 Brandon 的方法时，出现以下错误。不知道出了什么问题。我必须`client.html`直接在浏览器中运行该文件。运行`http://192.168.43.244:8000/client.html`会引发错误。

```
C:\node>node server.js
   info  - socket.io started

C:\node\node_modules\socket.io\lib\manager.js:0
(function (exports, require, module, __filename, __dirname) { /*!
^
RangeError: Maximum call stack size exceeded 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:27:27.303

情况很复杂。

如果您没有静态 IP 地址（而且您可能没有），这意味着每次将计算机重新连接到互联网时，您都会获得一个新的 IP 地址，因此您必须每次更新您的代码时间。

此外，您的开发机器和（wifi）路由器上的防火墙都存在问题。

最佳解决方案是获取静态 IP。但它并不便宜

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:27:40.610

首先，确保 Socket.IO 正在连接到提供 HTML 的服务器。在`client.html`中，改变：

```
var socket = io.connect('http://localhost:8000'); 
```

至

```
var socket = io.connect(); 
```

省略主机/端口将导致 Socket.IO 连接到为 HTML 服务的同一主机和端口。

完成后，您可以通过访问从另一台计算机访问服务器`http://1.2.3.4:8000`，其中`1.2.3.4`是运行服务器的计算机的 IP 地址。连接计算机和服务计算机需要在同一网络上才能工作；如果您想（暂时）与不同网络上的某人连接，您可以使用类似[localtunnel](http://progrium.com/localtunnel/)的工具。

# css - 改变内部颜色 何时选中单选按钮？

> ID：11160213
> 
> 赞同：0
> 
> 时间：2012-06-22T16:20:51.143
> 
> 标签：css, input, css-selectors, checked

[http://jsfiddle.net/anvhw/1/](http://jsfiddle.net/anvhw/1/)

当检查第一个广播按钮时，我很难尝试更改`<a>`标签上的属性。当我想更改`<label>`属性时，它工作正常，但不是`<a>`

谁能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:23:07.107

选择`+`器意味着两个元素之间不能有任何其他元素。之所以`+ label`有效，是因为您`label`的单选按钮之后立即出现。但是，它`label`位于您的单选按钮和 之间`div`，因此`#radio-one:checked + div`不起作用。

你需要使用

```
#radio-one:checked + label + div a 
```

[更新的小提琴](http://jsfiddle.net/BoltClock/anvhw/4)

另请参阅[此答案](https://stackoverflow.com/questions/3382078/what-does-mean-in-css/3382096#3382096)以获取有关选择器如何`+`工作的说明。

# php - PHP计算分钟差异

> ID：11160216
> 
> 赞同：0
> 
> 时间：2012-06-22T16:20:54.503
> 
> 标签：php, date

我正在计算两个日期之间的月、日、小时和分钟，我已经成功地计算出月、日和分钟，但我不能让它计算出分钟，下面是我的代码.

```
<?php
    $date1 = "2012-07-01 00:00:00";
    $date2 = "2012-09-30 00:00:00";

    $diff = abs(strtotime($date2) - strtotime($date1));

    $years = floor($diff / (365*60*60*24));
    $months = floor(($diff - $years * 365*60*60*24) / (30*60*60*24));
    $days = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24)/ (60*60*24));
    $minutes = floor(($diff - $years * 365*60*60*24 - $months*30*60*60*24) / (60*60*24) / (60*60));

    printf("%d years, %d months, %d days, %d minutes\n", $years, $months, $days, $minutes);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:26:47.640

在解决其他所有问题时尝试减少`$diff`变量：

```
$years = floor($diff / 31557600); // 31557600 = 365.25 * 86400
$diff -= $years * 31557600;
// I'd skip months, since different months have a different number of days.
// If you *really* want it, calculate the number of months from the days below.
$days = floor($diff / 86400); // 86400 = 24 * 3600
$diff -= $days * 86400;
$hours = floor($diff / 3600); // 3600 = 60 * 60
$diff -= $days * 3600;
$minutes = floor($diff / 60);
$diff -= $minutes * 60;
// $diff now equals the number of seconds left over 
```

或者，查看 PHP 的[日期/时间对象](http://us3.php.net/manual/en/book.datetime.php)：

```
$date1 = new DateTime("2012-07-01 00:00:00");
$date2 = new DateTime("2012-09-30 00:00:00");
$diff = $date1->diff($date2); // $diff is a DateInterval object 
```

查看[DateInterval->format()](http://us3.php.net/manual/en/dateinterval.format.php)以确定如何格式化输出`$diff`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:29:59.733

解决这个问题的最好和最准确的方法是使用[`DateTime`](http://php.net/DateTime)类。否则，当您处理日期异常（闰年等）时，您会遇到问题。

```
$format = 'Y-m-d h:i:s';
$tz = new DateTimeZone('America/New_York');

// Create DateTime objs based on the above format
$t1 = DateTime::createFromFormat( $format, "2012-07-01 00:00:00", $tz);
$t2 = DateTime::createFromFormat( $format, "2012-09-30 00:00:00", $tz);

// Find the difference between them
$diff = $t1->diff( $t2);

// Print out the difference in each amount
$outputs = array( 'Y' => 'Year', 'm' => 'Month', 'd' => 'day', 'h' => 'hour', 'i' => 'minute', 's' => 'seconds');

foreach( $outputs as $key => $value)
    echo $diff->format( '%'.$key) . ' ' . $value . "\n"; 
```

这[输出](http://codepad.viper-7.com/B6xGn4)：

```
00 Year
2 Month
29 day
0 hour
0 minute
0 seconds 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:23:56.633

曾经具有以下功能之一，将秒转换为天/周/hh:mm:ss 时间等。这应该回答您的查询。

```
function duration ($sec, $padHours = false)  {
  if ($sec > 1209600) return "> ". intval(intval($sec) / 604800) . " weeks";
  if ($sec > 604800) return "1 week";
  if ($sec > 172800) return "> ". intval(intval($sec) / 86400) . " days";
  if ($sec > 86400) return "1 day";
  $hms = "";
  $hours = intval(intval($sec) / 3600);
  $hms .= ($padHours)
        ? str_pad($hours, 2, "0", STR_PAD_LEFT). ":"
        : $hours. ":";
  $minutes = intval(($sec / 60) % 60);
  $hms .= str_pad($minutes, 2, "0", STR_PAD_LEFT). ":";
  $seconds = intval($sec % 60);
  $hms .= str_pad($seconds, 2, "0", STR_PAD_LEFT);
  return $hms;

} 
```

# symfony - KnpMenuBundle 和建议的教程示例：有什么问题吗？

> ID：11160221
> 
> 赞同：1
> 
> 时间：2012-06-22T16:21:17.513
> 
> 标签：symfony, menu, knpmenubundle

[KNP MenuBundle](https://github.com/knplabs/KnpMenuBundle)是一个 Symfony2 包，用于以非常动态的方式处理菜单。该捆绑包附带一个简单的教程示例，[在此处](https://github.com/KnpLabs/KnpMenuBundle/blob/master/Resources/doc/index.md)提供。在建议的示例中，在 Builder 类中，作者假设必须在**$menu**对象上调用函数**setCurrentUri() 。**但是，**$menu 是 MenuItem**类的一个实例，它没有实现上述功能。

 ****为了使答案自成一体，我报告了[此处](https://github.com/KnpLabs/KnpMenuBundle/blob/master/Resources/doc/index.md)提供的示例类的代码：

```
<?php
// src/Acme/DemoBundle/Menu/Builder.php
namespace Acme\DemoBundle\Menu;

use Knp\Menu\FactoryInterface;
use Symfony\Component\DependencyInjection\ContainerAware;

class Builder extends ContainerAware
{
    public function mainMenu(FactoryInterface $factory, array $options)
    {
        $menu = $factory->createItem('root');
        $menu->setCurrentUri($this->container->get('request')->getRequestUri());

        $menu->addChild('Home', array('route' => 'homepage'));
        $menu->addChild('About Me', array(
            'route' => 'page_show',
            'routeParameters' => array('id' => 42)
        ));
        // ... add more children

        return $menu;
    }
} 
```

PS：请注意，此示例中缺少一个重要的导入，为了完整起见，我将其报告如下：

```
use Symfony\Component\HttpFoundation\Request; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:28:19.367

我也在寻找文档更新，但作为临时解决方案，您可以设置`deps`如下版本：

```
[KnpMenu]
    git=https://github.com/KnpLabs/KnpMenu.git
    version=v1.1.2

[KnpMenuBundle]
    git=https://github.com/KnpLabs/KnpMenuBundle.git
    target=/bundles/Knp/Bundle/MenuBundle
    version=v1.1.0 
```****

# css - 根据元素的高度和宽度转换 X 和 Y 百分比值？

> ID：11160227
> 
> 赞同：92
> 
> 时间：2012-06-22T16:21:28.433
> 
> 标签：css, translate, percentage, translate3d

将元素 Y 轴平移 50% 会将其向下移动 50% 的自身高度，而不是我期望的父级高度的 50%。如何告诉翻译元素将其翻译百分比基于父元素？还是我不明白什么？

[http://jsfiddle.net/4wqEm/2/](http://jsfiddle.net/4wqEm/2/)

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2014-01-17T00:28:16.933

在翻译中使用百分比时，它指的是自身的宽度或高度。看看[https://davidwalsh.name/css-vertical-center](https://davidwalsh.name/css-vertical-center)（[演示](https://davidwalsh.name/demo/css-vertical-center.php)）：

> 关于 CSS 变换的一件有趣的事情是，当使用百分比值应用它们时，它们会根据正在实现它们的元素的尺寸来确定该值，而不是像 top、right、bottom、left、margin 和 padding 这样的属性，仅使用父级的尺寸（或者在绝对定位的情况下，使用其最近的相对父级）。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2016-04-13T13:46:24.783

您可以使用 vw 和 vh 根据视口大小进行翻译

```
@keyframes bubbleup {
  0% {
    transform: translateY(100vh);
  }

  100% {
    transform: translateY(0vh);
  }
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2016-12-09T12:17:08.033

[仅使用 CSS](https://jsfiddle.net/roujx3dn/)对我有用的是：

```
.child {
    position: relative;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);

    /* Backward compatibility */
    -webkit-transform: translate(-50%, -50%);
    -moz-transform: translate(-50%, -50%);
    -o-transform: translate(-50%, -50%);
    -ms-transform: translate(-50%, -50%);
} 
```

这个怎么运作：

*   上下定位根据父坐标移动子控件。子部件的左上角将恰好出现在父部件的中心（这不是我们目前想要的）。
*   翻译将根据其大小（而不是父小部件）将子小部件 -50% 移动到顶部和左侧。这意味着，小部件的中心点将准确地移动到左上点所在的位置 - 之前设置为父级的中心，这就是我们想要的。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-12-30T13:50:55.600

要在翻译属性中使用百分比，您必须使用 Javascript：http: [//jsfiddle.net/4wqEm/27/](http://jsfiddle.net/4wqEm/27/)

HTML 代码：

```
<div id="parent">
    <div id="children"></div>
</div>​​​​​​​​​​​​​ 
```

CSS 代码：

```
#parent {
    width: 200px;
    height: 200px;
    background: #ff0;
}
#children {
    width: 10%;
    height: 10%;
    background: #f00;
} 
```

Javascript代码：

```
parent = document.getElementById('parent');
children = document.getElementById('children');

parent_height = parent.clientHeight;
​children_translate = parent_height * 50/100;
children.style.webkitTransform = "translateY("+children_translate+"px)";​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

我希望我能帮助你，如果你有任何其他问题，请告诉我。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-01-05T10:44:30.437

您对来自翻译元素的百分比的陈述是绝对正确的。在您的情况下，您应该使用绝对定位来保持相对于父 div，而不是使用 translate 属性。我在这里绝对垂直放置您的红色 div：（不要忘记添加相对于父 div 的位置。它必须定位在静态默认值之外）：

[js小提琴笔在这里](http://jsfiddle.net/4wqEm/184/)

```
 body {
    margin: 0;
    width: 100%;
    height: 100%;
    }
 body > div {
    width: 200px;
    height: 200px;
    background: #ff0;
    position: relative;
    }
 body > div > div {
    width: 10%;
    height: 10%;
    -webkit-transform: translateY(-50%);
    background: #f00;
    position: absolute;
    top: 50%;
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-10-02T12:10:51.943

您还可以使用一个额外的块并为其使用过渡，但子节点除外

HTML 代码：

```
<div id="parent">
    <div id="childrenWrapper">    
        <div id="children"></div>
    </div>
</div>​​​​​​​​​​​​​ 
```

CSS应该是这样的

```
#parent {
    position: relative;
    width: 200px;
    height: 200px;
    background: #ff0;
}
#childrenWrapper{
    width: 100%;
    height: 100%;
}
#children {
    width: 10%;
    height: 10%;
    background: #f00;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-06-17T05:06:10.990

您可以使元素绝对定位并使用 left 和 top 属性将百分比值作为父元素。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-05-26T13:55:47.877

它在以下 URL [工作示例中需要定位](http://jsfiddle.net/mabdelhaq/869mzrvy/)

```
body {
margin: 0;
width: 100%;
height: 100%;
}

body>div {
position: relative;
width: 200px;
height: 200px;
background: #ff0;
}

body>div>div {
position: absolute;
left: 50%;
top: 50%;
width: 10%;
height: 10%;
background: #f00;
transform: translate(-50%, -50%);
} 
```

笔记：

1.  您可以通过将父元素更改为相对位置来绝对定位您的红色方块
2.  然后使用 50% top 和 50% left 将根据其左上角定位红色方块
3.  使用 transform:translate(-50%,-50%) 将根据其中心定位红色方块

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-05-18T13:50:10.230

这个问题的解决方案是根本不使用翻译。当你翻译一个元素时，你选择的百分比是基于它自己的高度。

如果要根据父元素的高度定位元素，请使用 top: 50%;

所以代码将如下所示：

```
body {
    margin: 0;
    width: 100%;
    height: 100%;
}
body > div {
    width: 200px;
    height: 200px;
    background: #ff0;
    position: relative;
}
body > div > div {
    position: absolute;
    top: 50%;
    width: 10%;
    height: 10%;
/*     -webkit-transform: translateY(50%); */
    background: #f00;
} 
```

# oracle - 这是一个可能的 Oracle 错误还是我遗漏了什么？

> ID：11160230
> 
> 赞同：3
> 
> 时间：2012-06-22T16:21:36.780
> 
> 标签：oracle, oracle10g, union, sqlplus

数据库是 Oracle 10.2.0.1.0 - 64 位，在 Red Hat Enterprise Linux ES 版本 4 (Nahant Update 8) 上运行

在 SQL*Plus 中，以下代码完美运行：

```
var comment_id number
exec :comment_id := 3052753
select e.label as doc_name,
           e.url,
           i.item_id,
           'multi' as form_type
    from cr_items i, cr_extlinks e
    where i.parent_id = :comment_id
    and e.extlink_id = i.item_id
   UNION
    select null as doc_name,
           utl_raw.cast_to_varchar2(DBMS_LOB.SUBSTR(r.content, 2000, 1))  as url,
           r.item_id,
           'single' as form_type
    from cr_revisions r
    where r.revision_id = content_item.get_latest_revision(:comment_id);
/ 
```

在这种情况下，它返回 2 行，来自 UNION 的每个部分的 1。如果我如下更改对 content_item.get_latest_revision 的调用，它将中断如下：

```
var comment_id number
exec :comment_id := 3052753
select e.label as doc_name,
          e.url,
           i.item_id,
           'multi' as form_type
    from cr_items i, cr_extlinks e
    where i.parent_id = :comment_id
    and e.extlink_id = i.item_id
   UNION
    select null as doc_name,
           utl_raw.cast_to_varchar2(DBMS_LOB.SUBSTR(r.content, 2000, 1))  as url,
           r.item_id,
           'single' as form_type
    from cr_revisions r
    where r.revision_id = ( select content_item.get_latest_revision(:comment_id) 
                          from dual);

/ 
```

错误：

```
SQL> where r.revision_id = ( select content_item.get_latest_revision(:comment_id) from dual)
                                               *
ERROR at line 14:
ORA-00904: : invalid identifier 
```

现在，这段 SQL 真正令人疯狂的是，上面的第二个示例是**唯一**失败的情况。例如，如果我使用上面示例 2 中的查询并从联合的两侧删除 doc_name 字段，那么一切都会突然恢复正常。或者，如果我删除 utl_raw.cast_to_varchar2 位或联合本身（并分别运行每个部分）。正是 UNION、AND 子句和函数调用的精确组合会中断。

有人建议它可能是错误 6038461，“使用 UNION 和快速 DUAL 子查询的 SQL 结果错误”，但我认为这不太合适。

有人知道第二个查询是怎么回事吗？

PS 我应该补充一点，在 TOAD 中没有错误 - 查询运行良好......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T04:01:54.533

不是一个大粉丝`AND/WHERE column = (SELECT column....)`，整体上写得更好`AND/WHERE column IN (SELECT column...)`。但是在您的情况下，子查询中似乎没有多行或多列的可能性。怎么样-

```
var comment_id number
exec :comment_id := 3052753
select e.label as doc_name,
          e.url,
           i.item_id,
           'multi' as form_type
    from cr_items i, cr_extlinks e
    where i.parent_id = :comment_id
    and e.extlink_id = i.item_id
   UNION
    select null as doc_name,
           utl_raw.cast_to_varchar2(DBMS_LOB.SUBSTR(r.content, 2000, 1))  as url,
           r.item_id,
           'single' as form_type
    from cr_revisions r
    where r.revision_id IN ( select content_item.get_latest_revision(:comment_id) 
                          from dual);

/ 
```

或者

```
var comment_id number
exec :comment_id := 3052753
select e.label as doc_name,
          e.url,
           i.item_id,
           'multi' as form_type
    from cr_items i, cr_extlinks e
    where i.parent_id = :comment_id
    and e.extlink_id = i.item_id
   UNION
    select null as doc_name,
           utl_raw.cast_to_varchar2(DBMS_LOB.SUBSTR(r.content, 2000, 1))  as url,
           r.item_id,
           'single' as form_type
    from cr_revisions r
    where EXISTS (select 'x'
                   from dual
                    where content_item.get_latest_revision(:comment_id) =r.revision_id);

/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-16T02:40:23.457

我认为它不起作用，因为你有一个空行；SQLPlus 讨厌他们。

# php - 用于 sqlite 的 zend multidb

> ID：11160232
> 
> 赞同：0
> 
> 时间：2012-06-22T16:21:39.317
> 
> 标签：php, zend-framework, centos, zend-db

我正在尝试设置多数据库。多个数据库连接将由用户使用表单动态输入。

引导程序.php

```
private $_session = null;

    public function init() {

        Zend_Session::start();

        $this->_session = new Zend_Session_Namespace();

    }

    protected function _initDb()
    {
        $resource = $this->getPluginResource('multidb');
        Zend_Registry::set("multidb", $resource);

    } 
```

索引控制器.php

```
public function indexAction()
{
    // action body

    $request = $this->getRequest();
    $form    = new Application_Form_Project();

    if ($this->getRequest()->isPost()) {
        if ($form->isValid($request->getPost())) {
            $x = $form->getValues();                
            //return $this->_helper->redirector('index');
            $dbAdapter = Zend_Db::factory("pdo_sqlite", array("dbname"=>"/../data/db/".$x["username"].".db"));
            Zend_Db_Table::setDefaultAdapter($dbAdapter);

            //print_r($dbAdapter);
            Zend_Registry::set('index', $dbAdapter);

            $this->_redirect('/line');

        }
    }

    $this->view->form = $form;

} 
```

Application_Model_PgeLine2DMapper

```
protected $_dbTable;

public function setDbTable($dbTable)
{
    $multidb = Zend_Registry::get("multidb");

    $registry = Zend_Registry::getInstance();
    print_r($registry);
    foreach ($registry as $index => $value) {
        echo "Registry index $index contains: ";
        var_dump($value);
        echo  "<br>";
    }

    if (is_string($dbTable)) {
        $dbTable = new $dbTable($multidb->getDb('db1'));
    }
    if (!$dbTable instanceof Zend_Db_Table_Abstract) {
        throw new Exception('Invalid table data gateway provided');
    }
    $this->_dbTable = $dbTable;
    return $this;
}

public function getDbTable()
{
    if (null === $this->_dbTable) {
        $this->setDbTable('Application_Model_DbTable_PgeLine2D');
    }
    return $this->_dbTable;
}

public function save(Application_Model_PgeLine2D $pgeLine2D)
{
    $data = array(
            'PGA_Name'   => $pgeLine2D->getPGA_Name()
    );

    if( null === ($id = $pgeLine2D->getPGA_Id()) ) {
        unset($data['id']);
        $this->getDbTable()->insert($data);
    } else {
        $this->getDbTable()->update($data, array('PGA_Id = ?' => $id));
    }
}

public function find($id, Application_Model_PgeLine2D $pgeLine2D)
{
    $result = $this->getDbTable()->find($id);
    if (0 == count($result)) {
        return;
    }
    $row = $result->current();
    $pgeLine2D->setPGA_Id($row->PGA_Id)
        ->setPGA_Name($row->PGA_Name);
}

public function fetchAll()
{
    $resultSet = $this->getDbTable()->fetchAll();
    $entries   = array();
    foreach ($resultSet as $row) {
        $entry = new Application_Model_PgeLine2D();
        $entry->setPGA_Id($row->PGA_Id)
            ->setPGA_Name($row->PGA_Name);
        $entries[] = $entry;
    }
    return $entries;
} 
```

我得到的错误如下

```
Fatal error: Uncaught exception 'Zend_Db_Adapter_Exception' with message 'Configuration array must have a key for 'dbname' that names the database instance' in /opt/eposdatatransfer/library/Zend/Db/Adapter/Pdo/Sqlite.php:110 Stack trace: #0 /opt/eposdatatransfer/library/Zend/Db/Adapter/Abstract.php(183): Zend_Db_Adapter_Pdo_Sqlite->_checkRequiredOptions(Array) #1 /opt/eposdatatransfer/library/Zend/Db/Adapter/Pdo/Sqlite.php(94): Zend_Db_Adapter_Abstract->__construct(Array) #2 /opt/eposdatatransfer/library/Zend/Db.php(270): Zend_Db_Adapter_Pdo_Sqlite->__construct(Array) #3 /opt/eposdatatransfer/library/Zend/Application/Resource/Multidb.php(99): Zend_Db::factory('PDO_SQLITE', Array) #4 /opt/eposdatatransfer/library/Zend/Application/Bootstrap/BootstrapAbstract.php(683): Zend_Application_Resource_Multidb->init() #5 /opt/eposdatatransfer/library/Zend/Application/Bootstrap/BootstrapAbstract.php(626): Zend_Application_Bootstrap_BootstrapAbstract->_executeResource('multidb') #6 /opt/eposdatatransfer/library/Zend/Application/Bootst in /opt/eposdatatransfer/library/Zend/Db/Adapter/Pdo/Sqlite.php on line 110 
```

# regex - 通过正则表达式匹配带空格的字符串

> ID：11160233
> 
> 赞同：2
> 
> 时间：2012-06-22T16:21:40.867
> 
> 标签：regex, pattern-matching

我正在尝试使此正则表达式`^(?!\-\-\sRoaming)`与之匹配，`-- Roaming`但事实并非如此。`--`我是否正确匹配和之间的空白`Roaming`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:25:56.203

空格是正确的。但为什么不`--\sRoaming`适合你？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:27:00.103

是的，您正确匹配正则表达式的那部分。我对正则表达式有点模糊，但是什么？！意思是？[我尝试了http://regexpal.com/](http://regexpal.com/)中的 \-\-\sRoaming 部分，它工作正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T17:19:55.287

试试这个，如果输入中的任何地方*都不*匹配`-- Roaming`：

```
^(?!.*--\sRoaming) 
```

请注意，您不需要转义连字符。

# html - CSS 未在 FF 和 IE 中加载

> ID：11160235
> 
> 赞同：1
> 
> 时间：2012-06-22T16:21:43.333
> 
> 标签：html, css, firefox

我设计了一个网站，但我的 CSS 没有在 FF 和 IE 中加载。它在 Chrome 和 Safari 中完美运行。谁能帮我调试？我正在通过以下方式加载 CSS。

`<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"` `"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">`

`<html xmlns="http://www.w3.org/1999/xhtml">`

`<head>`

`<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />`

`<title>site title::</title>`

`<!--CSS Files-->`

`<link rel="stylesheet" href="stylesheets/style.css" type="txt/css" />`

`<link rel="stylesheet" href="stylesheets/reset.css" type="text/css" media="screen" />`

`<link rel="stylesheet" href="stylesheets/dark.css" type="text/css" media="screen" />`

`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T16:25:34.177

`style.css``e`在其`type`属性值中缺少一个（`txt`应该是`text`）。

# jquery-mobile - 是否可以在使用 jquery mobile 的搜索输入旁边有一个按钮？

> ID：11160236
> 
> 赞同：5
> 
> 时间：2012-06-22T16:21:59.447
> 
> 标签：jquery-mobile

jQuery mobile 文档中的所有表单示例都在自己的行中显示了每个表单元素。我想在搜索输入字段的右侧有一个标准按钮（它将链接到另一个页面）。jQuery Mobile 有可能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:01:48.070

不是本机作为内联单元。但是，表单元素可以合理有效地与布局网格系统一起使用：

[http://jquerymobile.com/demos/1.1.0/docs/content/content-grids.html](http://jquerymobile.com/demos/1.1.0/docs/content/content-grids.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-06T16:12:25.440

jQM 的 UI 网格强制等宽列。就我而言，我希望提交按钮只是一个图标，以便让搜索框有更多空间。我在几篇文章中看到`<table>`提到，但发现其他输入（特别是`selectmenu`）在它们是意外元素的子级时无法正常工作。[1]

所以为了避免小部件损坏，我管理了这个：

```
.ui-grid-a.my-grid-a .ui-block-a.my-block-8515-a {
    width: 84.95%;
}
.ui-grid-a.my-grid-a .ui-block-b.my-block-8515-b {
    width: 14.95%;
} 
```

它不是防弹的，但它可以扩展到其他网格定义。它使用特异性来获取现有 UI 的所有网格规则，然后重新定义列宽。没有内联样式，没有额外的标签，并且小部件不会中断。并且由于特殊性，它可以在 jQM 的结构样式表之前*或之后加载。*

[1]：[https](https://github.com/jquery/jquery-mobile/issues/6077) ://github.com/jquery/jquery-mobile/issues/6077 jQM Github 错误报告

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-01T11:06:55.367

使用新版本，您可以：http: [//view.jquerymobile.com/1.4.0/demos/controlgroup/#Textinputs](http://view.jquerymobile.com/1.4.0/demos/controlgroup/#Textinputs)

旧式解决方案仍然有效：覆盖 ui-input-search

```
div.ui-input-search{ 
  width: 55%;
  display: inline-block;
} 
```

不要忘记在 a href 的类中添加*ui-btn-inline*（如果您使用 Button 标记语法）

# javascript - javascript中无法识别来自全局范围的变量

> ID：11160238
> 
> 赞同：1
> 
> 时间：2012-06-22T16:22:03.640
> 
> 标签：javascript, jquery

就像这样：

```
<script>
  var global_var = {foo:1};
</script>

<script src="myscript.js"></script> 
```

在 myscript.js 我有

```
jQuery(document).ready(function($){    
  var global_var = typeof global_var == 'undefined' ? {foo:2} : global_var;
  console.log(global_var);    
}); 
```

但是 global_var 在我的第二个脚本中似乎没有被识别，即使我在第一个脚本中明确定义了它，就像一个全局变量。

[http://jsfiddle.net/tYErg/](http://jsfiddle.net/tYErg/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:26:45.040

问题是 jQuery 函数中“var global_var”中的“var”。这是在您的函数中创建一个不同的“global_var”变量，而不是使用真正的全局变量。删除它，您的代码将按预期工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T16:27:00.697

这是因为您`global_var`在当前范围内声明了另一个。删除`var`或更改变量名称：

例如

```
global_var = typeof global_var == 'undefined' ? {foo:2} : global_var;
var other_var = typeof global_var == 'undefined' ? {foo:2} : global_var; 
```

[http://jsfiddle.net/8Mptw/](http://jsfiddle.net/8Mptw/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-22T16:28:21.333

您不能在同一范围内使用来自不同范围的两个具有相同名称的不同变量。因此，当您`global_var`使用`var`关键字声明本地时，您的全局变得不可访问。

如果您需要创建一个与全局同名的局部变量，您可以使用如下闭包：

```
jQuery(document).ready(function($){
    (function(global_var){
        // global_var is a local copy of global_var from the outer scope
        global_var = typeof global_var == 'undefined' ? {foo:2} : global_var;
        console.log(global_var);
    })(global_var);    
}); 
```

`window`如果您知道它是全局的，您也可以将其称为对象的属性：

```
jQuery(document).ready(function($){
    var global_var = typeof window.global_var == 'undefined' ? 
      {foo:2} : window.global_var;
    console.log(global_var);
}); 
```

最后，如果您不想要本地副本而只想从外部范围访问变量，则不要使用`var`关键字，因为该关键字的目的是声明一个新变量：

```
jQuery(document).ready(function($){
    global_var = typeof global_var == 'undefined' ? {foo:2} : global_var;
    console.log(global_var);
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-22T16:31:46.140

You are having this problem because you are declaring a local variable with the same name as your global variable, therefore the global variable is not visible any more. You can still access it by explicitly specifying the scope:

```
jQuery(document).ready(function($){    
  var global_var = typeof window.global_var == 'undefined' ? {foo:2} : window.global_var;
  console.log(global_var);    
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-22T16:26:55.953

尝试在没有`var`关键工作的情况下定义它以使其在全局范围内

```
<script>
     var global_var = {foo:1};
    </script>   

<script>    
      jQuery(document).ready(function($){   
      global_var = typeof global_var === 'undefined' ? {foo:2} : global_var;    
      alert(global_var.foo); // should be 1    
    });        
</script> 
```

[http://jsfiddle.net/tYErg/3/](http://jsfiddle.net/tYErg/3/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-22T16:27:56.263

尝试这个

```
jQuery(document).ready(function($){    
 global_var = typeof global_var == 'undefined' ? {foo:2} : global_var;
  console.log(global_var);    
}); 
```

# android - 如何处理 REST 调用、数据持久性、同步和观察 ContentProvider

> ID：11160242
> 
> 赞同：6
> 
> 时间：2012-06-22T16:22:24.987
> 
> 标签：android, rest, android-contentprovider, android-syncadapter, contentobserver

我知道这个问题被问过太多次了，但我认为我试图针对的问题有点不同，可能更复杂。

我将开发一个使用**RESTful Web Service**的应用程序，并且需要满足以下要求：

*   该应用程序应在列表中详细显示一些书籍、作者和编辑

*   该应用程序还应该允许搜索一本书

*   书籍、作者和编辑从 RESTful Web 服务中获取

*   每个实体都必须被缓存，这样当我打开一个活动时，我首先会看到旧数据（如果有的话），而新数据则从网络更新。

*   每次实体更新时，都应通知相关方（`ContentObserver`？定期`Listener`实施？）

*   如果调用已经在执行（比如 to`api/books/1337`或 to `api/editors`），则应该通知调用者它正在加载数据，并且应该给予旧的调用者（如果存在），就好像它是原始调用者一样。

*   一些数据（只有书籍和作者）应该每 N 分钟更新一次（由用户决定），并且应该通知观察者（`SyncAdapter`？）

*问题*：

在观看并研究[了 Virgil Dobjanschi 在 Google I/O 2010 上提出的](http://www.google.com/events/io/2010/sessions/developing-RESTful-android-apps.html)所有组件之后，我的疑惑是：

1.  如何透明地处理任何调用者的“**实体正在更新”概念？**我应该`ContentObserver`在`ContentProvider`我必须实施的情况下使用吗？

2.  如果我使用 a**`ContentObserver`**我可以轻松地为单个实体设置状态标志（如 Dobjanschi 所建议的那样），例如`UPDATING`、`INSERTING`等。但是我应该如何处理列表？假设我想要一个书籍清单，我应该把状态标志放在哪里？我应该将它放在仅用于列表的状态表中吗？如果是这样，我应该*观察*两个`Cursor`s，一个用于状态，一个用于实际列表（即 table/Content URI）。如果我要求的实体不存在（还）或者 REST 调用返回一个`404`? 如何处理回调？

3.  如果我将所有 REST 方法放在一个 中`**SyncAdapter**`，我可以“强制”`SyncAdapter`从网络更新实体/实体列表（并因此将其放入正确的表中）吗？这样，状态标志将很有用。

4.  可以`SyncAdapter`在**多个实体**上工作（实际上是实体列表，因为我想不时更新书籍和编辑器），因为它只有一个`performSync`方法？

5.  如果`SyncAdapter`用户在设备设置中禁用了我的实现，它将不会更新任何内容（这很好）。但是，如果用户在 Activity 中单击“更新书籍”按钮，我仍然可以调用该`performSync`方法，还是它也会被禁用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T14:58:52.393

SyncAdapter 是一种涉及五个组件的设计模式：

1.  一个应用程序。这使用了一组`Activity`with `Cursor`and `ContentObserver`and might `CursorAdapter`and some 来为本地存储的数据提供一个 UI 来自`ContentProvider`.
2.  `ContentProvider` 本地设备的数据存储。处理 CRUD 调用，处理`SyncAdapter`需要将更新推送到服务器的通知。
3.  `Account`远程服务器上的用户身份。
4.  `SyncAdapter`一个后台进程，运行并保持本地数据存储与服务器同步。
5.  服务器本身。

所以。对于问题：

1.  “正在更新”的意思是，“具有尚未推送到服务器的本地更改。这是您在数据库中的一行上设置的标志。它在您创建/更新/删除一行时在 ContentProvider 中设置。当 SyncAdapter 运行时，它看到标志，将更新推送到服务器，清除标志。标志本身做了两件事：
    **a.** 告诉用户应用程序正忙于保存更改，以及何时完成
    **。b.** 将行标记为已更改SyncAdapter 知道将其推送到服务器。
    [阅读此处](https://stackoverflow.com/questions/6588770/prevent-network-sync-trigger-when-syncing-from-network-in-android-contentprovide/6602629#6602629)了解更多详细信息。

2.  如果您不同步整个目录，那么您的客户端将直接查询服务器并通过将结果放入 ContentProvider 来缓存结果。那里没有状态标志，因为它们来自服务器，因此与服务器状态匹配。编写您的 SyncAdapter 以忽略它们，或者在它们被缓存几天后丢弃它们。

3.  **一个。**为了确保将本地更新发送到服务器，您编写 ContentProvider 以在 ContentProvider 的 Create/Update/Delete 调用期间通知 SyncAdapter。[（在这里阅读...）](https://stackoverflow.com/questions/6588770/prevent-network-sync-trigger-when-syncing-from-network-in-android-contentprovide/6602629#6602629)
    **b。**为确保您定期从服务器获取更新，请将帐户配置为自动同步。 [（在这里阅读...）](https://stackoverflow.com/questions/5253858/why-does-contentresolver-requestsync-not-trigger-a-sync/5255360#5255360)

4.  是的。performSync 只是一个函数调用。写它来做你想做的事。让它从服务器获取表 1 并将其放入 ContentProvider 中的一个表中。然后让它获取表 2，并将其放入另一个表中。等等。

5.  **一个。**您可以通过在附加包中调用`ContentResolver.RequestSync()`with来强制同步。**湾。**您可以使用客户端代码手动获取某些内容并将其直接推送到 ContentProvider。`ContentResolver.SYNC_EXTRAS_MANUAL`

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-22T15:39:53.790

如果您查看[Google Developers Training中的](https://developer.android.com/training)[Running Sync Adapter](https://developer.android.com/training/sync-adapters/running-sync-adapter.html)部分，您会发现有关如何执行以下操作的完整详细说明：

1.  [服务器数据更改时运行同步适配器](https://developer.android.com/training/sync-adapters/running-sync-adapter.html#RunByMessage)
2.  [内容提供者数据更改时运行同步适配器](https://developer.android.com/training/sync-adapters/running-sync-adapter.html#RunDataChange)
3.  [在网络消息后运行同步适配器](https://developer.android.com/training/sync-adapters/running-sync-adapter.html#RunByNetwork)
4.  [定期运行同步适配器](https://developer.android.com/training/sync-adapters/running-sync-adapter.html#RunPeriodic)
5.  [按需运行同步适配器](https://developer.android.com/training/sync-adapters/running-sync-adapter.html#RunOnDemand)**

# c# - 使用母版页创建 Web 表单

> ID：11160253
> 
> 赞同：1
> 
> 时间：2012-06-22T16:22:56.593
> 
> 标签：c#, asp.net, .net, exception-handling, master-pages

我已经这样做了几个小时，并且一直出现同样的错误。我不知道为什么！我设法为母版页创建了第一个网络表单。不知何故，子序列网络表单出现了同样的错误。

这是我创建的网络表单：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/EIDShopMain.Master" AutoEventWireup="true" CodeBehind="WebForm3.aspx.cs" Inherits="mainWebsite_EID_Shop_.WebForm3" %>
<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
</asp:Content> 
```

当我想在浏览器中查看它时：

```
Server Error in '/' Application.
Parser Error  Description: An error occurred during the parsing of a resource required to service this request. Please review the following specific parse error details and modify your source file appropriately. 
Parser Error Message: Could not load type 'mainWebsite_EID_Shop_.Global'.
Source Error: 
Line 1:  <%@ Application Codebehind="Global.asax.cs" Inherits="mainWebsite_EID_Shop_.Global" Language="C#" %> 
```

**更新：**这是一个 ASP.Net Web 应用程序项目。

WebForm3 的代码隐藏：

```
namespace mainWebsite_EID_Shop_
{
    public partial class WebForm3 : Page
    {
    }
} 
```

谁能解释为什么有时网络表单有效，有时却无效。

**更新2：**更多错误：

```
Parser Error Description: An error occurred during the parsing of a resource required to  service this request. Please review the following specific parse error details and modify your source file appropriately.
Parser Error Message: Could not load type 'mainWebsite_EID_Shop_.EIDShopMain'.
Source Error:
Line 1: <%@ Master Language="C#" AutoEventWireup="true" CodeBehind="EIDShopMain.master.cs" Inherits="mainWebsite_EID_Shop_.EIDShopMain" %>
Line 2:
Line 3: <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:29:15.047

您的 Global.asax 应如下所示：

```
<%@ Application Inherits="mainWebsite_EID_Shop_.Global" %> 
```

和 Global.asax.cs：

```
namespace mainWebsite_EID_Shop_
{
    public class Global
    {
    }
} 
```

# python - SQL 变量缺少引号

> ID：11160257
> 
> 赞同：0
> 
> 时间：2012-06-22T16:23:19.777
> 
> 标签：python, sql, variables, quotes

我正在使用数据库，并且在 column_x 中一些变量为 NULL。由于有人不喜欢这个，我们决定将其更改为“无”。现在我使用以下命令在 Python 中更改它：

```
 query = "update stone set results = 'None' where results is null;" 
```

但是当我这样做时：

```
 query = "SELECT * FROM stone where part = 'ABC';" 
```

我得到一个输出 'x','y','z',None,'a'

但是当我这样做时：

```
 query = "SELECT * FROM stone where part = 'ABC' and results = 'None';" 
```

我得到（）返回。这可能是因为“无”不存在。这么短的问题很长，我如何通过 Python 更改 None -> 'None'？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:38:06.583

我不确定当你说无时你的意思是空的。如果您打算 None 表示 null 您可以使用类似这样的内容（MYSQL）：

sql = "UPDATE stone set results=\'None\' where results is null" cursor = conn.Execute($sql) rows = cursor.Affected_Rows()

对于 Oracle，执行以下 SQL：

sql = "UPDATE stone set results=''None'' where results='None'" cursor = conn.Execute($sql) rows = cursor.Affected_Rows()

对于 MYSQL，您需要使用反斜杠来转义刻度 - 类似于

sql = "UPDATE stone set results=\'None\' where results='None'" cursor = conn.Execute($sql) rows = cursor.Affected_Rows()

另请参阅 [http://phplens.com/lens/adodb/adodb-py-docs.htm](http://phplens.com/lens/adodb/adodb-py-docs.htm) http://www.codersrevolution.com/index.cfm/2008/7/13/Just-when-you-felt-safe -SQL 注入和 MySQL

# php - 头函数放在哪里

> ID：11160259
> 
> 赞同：0
> 
> 时间：2012-06-22T16:23:21.360
> 
> 标签：php

好的，这是一个简单的问题，也是一个愚蠢的问题，但由于我一直在 localhost 上进行开发，我什至没有意识到这是一个问题。登录脚本中重定向到成员页面的标题不起作用，因为它的位置不正确。这在 wamp 上没有引起问题，但在实时服务器上。该脚本包含在一个 html 文件中，原因太长，无法在此处说明。脚本中没有任何内容，直到出现问题，然后脚本停止。我应该把重定向标头放在哪里？

这是登录脚本：

```
<?php 

// Connects to your Database 

include ("database.php");

 //Checks if there is a login cookie

 if(isset($_SESSION['username']))

 //if there is, it logs you in and directes you to the members page

 {  
    echo '<div id="probwarn"><t1><b>You are already logged in! You do not need to do it again.</b></t1></div>';

}

 //if the login form is submitted 

 if (isset($_POST['submit'])) { // if form has been submitted

$flag = 0; // Safety net, if this gets to 1 at any point in the process, we don't upload.

 // makes sure they filled it in

if(!$_POST['username'] | !$_POST['pass']) {

    echo('<div id="probwarn"><t1>You did not fill in a required field.</t1></div>');
$flag = $flag + 1;
    }

// checks it against the database

    $pass = htmlspecialchars(mysql_real_escape_string($_POST['pass']));
    $username = htmlspecialchars(mysql_real_escape_string($_POST['username']));

   $check = mysql_query("SELECT * FROM members WHERE username = '".$username."'")or die(mysql_error());

 //Gives error if user dosen't exist

 $check2 = mysql_num_rows($check);

 if ($check2 == 0) {
if($flag == 0) {
    echo('<div id="probwarn"><t1>You must <a href="register.html">    <b>register</b></a> first.</t1></div>') ;

            }
    $flag = $flag + 1;
    }           

 $check = mysql_query("SELECT * FROM members WHERE username = '".$username."'")or     die(mysql_error());
 $pass = htmlspecialchars(mysql_real_escape_string($_POST['pass']));
    $username = htmlspecialchars(mysql_real_escape_string($_POST['username']));

 while($info = mysql_fetch_array( $check ))     

 {

 $_POST['pass'] = stripslashes($_POST['pass']);

$info['password'] = stripslashes($info['password']);

$_POST['pass'] = md5($_POST['pass']);

 //gives error if the password is wrong

if ($_POST['pass'] != $info['password']) {
 if($flag == 0) {
    echo('<div id="probwarn"><t1>Incorrect password, please try again.</t1>    </div>');
$flag ++;
     } }

   }        

 // if login is ok then we add a cookie 
 if($flag == 0) {
 $pass = htmlspecialchars(mysql_real_escape_string($_POST['pass']));
 $username = htmlspecialchars(mysql_real_escape_string($_POST['username']));

 $_SESSION['username']=$username;
 $_SESSION['password']=$pass;

 //then redirect them to the members area
//THIS IS THE HEADER 
 header("Location: ../members.html");

 } 

 } 

 else 

 // if they are not logged in 

 ?> 
 LOGIN FORM IS USUALLY HERE 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:26:04.620

`exit`您在设置 Location 标头后忘记了。除非您确切地知道自己在做什么，否则您应该始终将`exit`(或`die()`) 放在 Location 标头之后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:49:45.050

您可以在代码的任何地方使用 header('Location: address')，但最好在 header 之后使用 exit() 函数，如果未执行重定向，则其他代码不会执行。

# javascript - JavaScript 可以改变@page CSS 的值吗？

> ID：11160260
> 
> 赞同：24
> 
> 时间：2012-06-22T16:23:38.747
> 
> 标签：javascript, css, dom

以下 CSS 会影响默认情况下页面是纵向还是横向打印。

```
@page {
   size: landscape;
} 
```

我意识到这只适用于非常有限的浏览器集，并且用户可以覆盖它。没关系; 我只是想提供一个好的默认值。

这在 CSS 中作为静态值可以正常工作，但我想根据用户选择在纵向和横向之间动态切换。是否可以使用 JavaScript 来更改此值？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-06-22T17:48:51.583

一种简单的方法是为 @page 创建一个单独的样式并更改它：

```
var cssPagedMedia = (function () {
    var style = document.createElement('style');
    document.head.appendChild(style);
    return function (rule) {
        style.innerHTML = rule;
    };
}());

cssPagedMedia.size = function (size) {
    cssPagedMedia('@page {size: ' + size + '}');
};

cssPagedMedia.size('landscape'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-19T21:49:34.457

@jasssonpet 用他的回答拯救了我的屁股。话虽如此，我把它改得更简单一些（在我看来）。

** 不太清楚为什么会这样，但如果你知道，请教育我。如果只是偏好，那么我将分享我的代码示例，因为其他人的偏好可能更符合我的偏好。

```
// just create the style tag and set the page size
function setPageSize(cssPageSize) {
    const style = document.createElement('style');
    style.innerHTML = `@page {size: ${cssPageSize}}`;
    document.head.appendChild(style);
}

// how to use it
setPageSize('letter landscape'); 
```

* * *

编辑：我有一段时间第一次登录，看到了@jasssonpet 的回答，现在对我来说更有意义了。万一其他人感到困惑，他的方法的主要好处是两件事：

1.  他使用了闭包，因此只有 1 个样式标签添加到页面中，然后可以引用和更改。
2.  他在 cssPagedMedia 上进行了扩展，以便添加的任何方法都被命名空间。这样，全局命名空间就不会被污染。

这是Class形式的（我觉得更容易理解）：

```
class SingletonStyle {
  constructor() {
    this.style = document.createElement("style");
    document.head.appendChild(this.style);
  }

  apply(rule) {
    this.style.innerHTML = rule;
  }

  size(size) {
    this.apply("@page {size: " + size + "}");
  }
} 
```

# android - 试图只在edittexts上做数学函数，用户在android上输入了信息

> ID：11160263
> 
> 赞同：0
> 
> 时间：2012-06-22T16:23:52.233
> 
> 标签：android, android-edittext, average

我有一个 10 场平均圈数计算器。然而，在测试中，有人说他们通常只在练习中跑 X 圈，而不是 10 圈（比如说 7 圈）。

我想我可以使用 if 语句，但至少有 10 个语句和一堆笨拙的代码，而且我不确定数组/switch 语句是否准确。我认为所有这些都是可能的，但是我的经验水平很低，还没有完全理解这些有用的工具。

当前代码：

```
double tenLapAvgVar = ((lap1Var + lap2Var + lap3Var + lap4Var + lap5Var + lap6Var + lap7Var + lap8Var + lap9Var + lap10Var) / 10); 
```

因此，基本上，如果有人将一个或多个字段留空，我想根据填充的字段计算平均值，而不是 10（如果他们将 3 个字段留空，例如，基于 7 计算）。你们能提供的任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:30:13.783

Maybe it would be better if you used an array instead of 10 different variables.
Then you can use a for statement and initialize them to 0, afterwords let the user fill the array and count how many are not zero.
Finally sum up all the array and divide by the count you previously calculated.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:36:22.063

你可以有一个`ArrayList<EditText>`对象和一个方法来迭代它并将值相加。就像是：

```
 public double getLapAverage()
    {
    int noOfCompletedLaps = 0;

    double lapAve = 0;
    double lapsTotal = 0;    

    for(EditText text : textBoxes)
    {
       if(text.getText().toString().length() > 0)
       {
          //psuedo code, and assuming text is numerical
          lapsTotal += Double.parse(text.getText().toString());
          noOfCompletedLaps++;
       }
    }

    if( noOfCompletedLaps > 0)
    {
       lapAve = lapsTotal / noOfCompletedLaps;
    }

 return lapAve;
 } 
```

# objective-c - 获取 UIEvent 取消 UIGestureRecognizer

> ID：11160269
> 
> 赞同：1
> 
> 时间：2012-06-22T16:24:00.207
> 
> 标签：objective-c, ios, uigesturerecognizer, uievent

我有一个简单的滑动手势，我希望它的优先级很低。我希望它被视图上的控件发生的事件取消。起初，我认为这很简单。当手势发生时很容易取消事件，但我似乎不能做相反的事情。

如果手势与任何可触摸的东西冲突，我的解决方案是取消手势。这是我一起破解的代码：

```
- (BOOL)gestureRecognizerShouldBegin:(UIGestureRecognizer *)gestureRecognizer
{
    CGPoint touch = [gestureRecognizer locationInView:self.view];
    return [self.view hitTest:touch withEvent:nil] == self.view;
} 
```

我觉得这是解决问题的错误方法。我错过了什么？获取事件以取消手势的正确方法是什么？

* * *

有关更多上下文，我在视图中添加了两个 UISwipeGestureRecognizers（向左滑动和向右滑动）。视图中还有一个 UISlider（嵌入式 MPVolumeView 的一部分）。当我移动滑块来改变音量时，向左或向右滑动会触发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T13:07:34.947

这是做你想做的事情的正确方法。您是在告诉手势识别器，它应该只在触摸直接在视图中时才开始，而不是在任何子视图中（根据`hitTest:`哪个好，因为它允许视图决定它们是否被击中）。

阻止它启动总是比事后取消它要好。但是，如果您*确实*想在手势开始后取消它，请设置`enabled = NO`然后再返回`YES`。

如果您需要允许某些子视图而不是控件的手势，您可以测试返回的视图是否是（例如） using`hitTest:`的子类。`UIControl``isKindOfClass:`

我不知道这是什么类型的手势，但通常你不需要这样做，因为 UIKit 会自动找到想要触摸的最深视图，并且该视图会“吃掉”它们，因此外部手势识别器不会得到它们 - 但是我可以想象这对于识别器/控制的某些组合并不适用。

# javascript - jQuery UI 按钮通过另一个函数设置选中单选

> ID：11160271
> 
> 赞同：0
> 
> 时间：2012-06-22T16:24:10.033
> 
> 标签：javascript, jquery, html, jquery-ui

我使用 jquery ui`$(input).button()`效果很好，我想要做的就是将 2 个收音机之一设置为由其他东西“检查”，并在 ui 中更新图形。

我正在使用`$("#radio1").attr("checked",true); $("radio2").attr("checked",false);`没有 jquery ui 的情况下可以正常工作，但是当`.button()`应用时，没有外观更新（只有属性）。

有没有办法做到这一点？

# javascript - 如何使用 urls 而不是 hashbangs

> ID：11160272
> 
> 赞同：1
> 
> 时间：2012-06-22T16:24:16.187
> 
> 标签：javascript, backbone.js, express

我正在使用后端的 express.js 和前端的主干.js 构建一个 Web 应用程序。

我希望整个内部应用程序都在客户端处理（主干请求数据并呈现它，服务器不直接返回任何 html）。

为了使书签和第三方仍然可以访问资源，许多 JavaScript 前端使用 hashbang。

我知道想知道是否也可以使用 GET 参数（没有 hashbang）来执行此操作（类似于 github 处理文件浏览器的方式）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:27:40.233

[HTML5 pushState](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history/)是您所追求的。并非所有浏览器都支持它，有些库可以使用哈希来添加对它们的支持。

# c# - 我应该为每个 Web 请求使用静态缓存的 ResourceManager 还是一个新实例？有关系吗？

> ID：11160283
> 
> 赞同：6
> 
> 时间：2012-06-22T16:24:52.607
> 
> 标签：c#, asp.net-mvc, static, resx, resourcemanager

`ResourceManager`使用.Designer.cs`new ResourceManger(myResourceType.FullName, myResourceType.Assembly)`生成的类`MyResourceType.ResourceManager`（

我正在使用 .resx 文件的 ASP.NET MVC 3 应用程序的上下文中工作。

编辑：我对为新对象分配内存的成本之外的影响感兴趣。

编辑：查看 MSDN 文档`ResourceManager.ReleaseAllResources`，它指出：

`This method will shrink the working set in a running application. Any future resource lookups on this ResourceManager will be as extensive as the first lookup, since it will need to search and load resources again.`

这似乎意味着资源集的初始开放是昂贵的，这对我来说意味着在每个请求上创建一个新的管理器可能会很昂贵。但是，文档并未就资源管理器的生命周期/范围提出最佳实践。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-11T02:46:45.670

我对使用缓存管理器（我使用反射来查找每种资源类型的静态缓存管理器）和对每个键访问使用新管理器之间的区别进行了一些原始分析（使用 MiniProfiler）。结果表明，新管理器花费了大约 45 倍的时间，这对我来说表明使用缓存管理器方法确实有性能优势。然而，这两种方法都非常快，以至于在实践中差异可能并不重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:34:59.307

创建对象时，您将分配一个对象。

这意味着您将一遍又一遍地创建对象会对性能和内存产生影响。

您可以尝试并检查您有多少垃圾收集周期（使用性能计数器）与创建一次（每个进程）的“缓存”资源管理器实例的数量，因此没有不必要的分配

# ruby - 匹配字符串中的孤立 % 所需的正则表达式

> ID：11160285
> 
> 赞同：1
> 
> 时间：2012-06-22T16:24:55.407
> 
> 标签：ruby, regex, string

我想在我的字符串中用“%%”替换所有“%”。但是，我的字符串也可能有“%{abc}”，这不应该被替换。

> 输入：我的名字是 %{name}，我的分数是 %{percentage} %！
> 
> 输出：我的名字是 %{name}，我的 %% 分数是 %{percentage} %%！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T16:26:28.213

您可以使用此正则表达式匹配所有`%`未成功的`{`

```
s.gsub(/%(?!\{)/, '%%') 
```

**编辑**

为了防止替换`%%`(to `%%%%`)：

```
s.gsub(/(?<!%)%(?![{%])/, '%%') 
```

请注意，这将阻止替换`%%%`，以防万一出现其他行为。

归功于 @MichaelKohl 的 gsub。@ZainZafar (OP) 提供完整的解决方案。

# c# - 当前上下文中不存在名称“sqlDbType”

> ID：11160290
> 
> 赞同：7
> 
> 时间：2012-06-22T16:25:17.123
> 
> 标签：c#, c#-4.0

我要编辑文本框值.. 但我看到有问题

```
 protected void btn_edit_Click(object sender, EventArgs e)
    {
        DatabaseConnector con = new DatabaseConnector().CreateInstance();
        SqlCommand com = new SqlCommand("UPDATE tbl_BinCardManager SET ItemName = @ItemName WHERE ItemNo = @ItemNo");
        com.Parameters.Add("@ItemName",sqlDbType.VarChar);
        con.Open();
        cmd.ExecuteNonQuery();
        con.Close();

    } 
```

错误 1：

> 当前上下文中不存在名称“sqlDbType”

错误 2：

> “ERPSystem.DatabaseConnector”不包含“Open”的定义，并且找不到接受“ERPSystem.DatabaseConnector”类型的第一个参数的扩展方法“Open”（您是否缺少 using 指令或程序集引用？）

我的 DBConnector 类是：

```
 class DatabaseConnector
{
    private DatabaseConnector databaseConnector;
    private string connectionString = "Data Source=lernlap;Initial Catalog=ERPSystemDB;User ID=sa;Password=sa123";

    public DatabaseConnector()
    {

    }

    private SqlConnection connection;

    private bool Connect()
    {
        try
        {
            connection = new SqlConnection(connectionString);
            connection.Open();
            return true;
        }
        catch(Exception) {

            return false;

        }
    }

    internal DatabaseConnector CreateInstance()
    {
        if (databaseConnector == null)
        {
            databaseConnector = new DatabaseConnector();
            databaseConnector.Connect();
        }
        return databaseConnector;
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-22T16:27:49.970

C# 区分大小写...尝试使用智能感知。

```
SqlDbType 
```

如果您更正第一个错误，其他错误可能会消失。

* * *

附带说明一下，如果没有适当的资源处理，您将遇到连接/内存泄漏。就个人而言，我使用该`using`声明来避免陷阱。

我不完全确定“DatabaseConnector”是什么，可能是您自己的类，但您可能应该使用[SqlConnection](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.aspx)，或者可能是[SqlDatabase](http://msdn.microsoft.com/en-us/library/microsoft.practices.enterpriselibrary.data.sql.sqldatabase%28v=pandp.31%29.aspx)。

更新：我不确定 DBConnector 类应该是单例还是工厂，或两者兼而有之 - 所以我只是简化了我的答案以避免使用它。问另一个问题，详细说明如何创建您正在寻找的模式并提供 DBConnector 类。我认为这是可行的，但我只是没有足够的信息来解决你所拥有的问题。

```
public static CONN_STR = "Data Source=lernlap;Initial Catalog=ERPSystemDB;User ID=sa;Password=sa123";

  protected void btn_edit_Click(object sender, EventArgs e) 
    { 
        using(SqlConnection con = new SqlConnection(CONN_STR))
        {
          con.Open(); 

          using(SqlCommand cmd = new SqlCommand("UPDATE tbl_BinCardManager SET ItemName = @ItemName WHERE ItemNo = @ItemNo"), con)
          {

            // TODO: fill in param values with real values
            cmd.Parameters.AddWithValue("@ItemName", "my item name");
            cmd.Parameters.AddWithValue("@ItemNo", 1);

            cmd.ExecuteNonQuery(); 
          }
        }
     } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-22T16:27:31.867

SqlDbType 中的 s 需要大写！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-22T16:50:46.313

```
yes but theres no any case sensitivity problem know 
```

您实际上确实有语法错误，因为您使用`s`而不是`S`. 此外，SqlCommand 没有调用方法，`Open()`也没有用于`Close()`

您应该使用 SqlConnection，因为它包含方法`Open()`并将`Close()`SqlCommand 的`Connection`属性设置为您的实例，`SqlConnection`以便打开和关闭与数据库的连接。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-22T16:33:20.617

你有更多的错误。

*   根据您使用它的方式，我认为您的意思`SqlConnection`是`DatabaseConnector`
*   您创建一个名为 的 SqlCommand `com`，但将其称为`cmd`
*   您需要将 SqlConnection 分配给 SqlCommand，否则它将不知道要打开哪个连接。
*   您只向 SqlCommand 提供 1 个参数，而查询需要两个（`ItemNo`以及`ItemName`）。

根据您的新来源进行编辑：

*   错误“DatabaseConnector'不包含'Open'的定义”可以通过编写`con.Connect()`而不是更正`con.Open()`。
*   但是，另一个错误，即它没有“Close()”函数，无法更正 - 无法告诉它关闭连接。

这是你自己的代码吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-22T16:48:04.547

你在使用[The Code Project](http://www.codeproject.com/Articles/32909/Database-Connector)制作的课程吗？

好吧，我认为错误是因为连接字符串。连接字符串必须在 OdbcDatabaseConnector 类中。好吧，我从来没有使用过这类代码项目，但可以。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-09-16T07:58:47.517

如果您使用大写字母 'S' 编写，但仍然出现相同的错误，尤其是在 Visual Studio 2015 中，那么不要编写 'SqlDbType' ，而是编写：System.Data.SqlDbType

例如：

```
 param[0] = new SqlParameter("@Name", System.Data.SqlDbType.VarChar,50); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-17T05:04:10.250

SqlDbType 中的大写“S”，更正后，右键单击该单词，将鼠标悬停在解析选项上并添加 System.Data 命名空间。为我工作！

# wpf - 使用 Caliburn 微约定在 DataTemplate 中绑定 ViewModel 本身

> ID：11160293
> 
> 赞同：2
> 
> 时间：2012-06-22T16:25:25.517
> 
> 标签：wpf, binding, mvvm, caliburn.micro

我是 Caliburn.Micro 的新手，但我仍然没有得到一些东西。

视图模型优先：

首先是管理其他 ViewModel 集合的 ViewModel：

```
public class NavigationBarViewModel : PropertyChangedBase
{
    public BindableCollection<IHaveDisplayName> Items { get; set; }
} 
```

我有一个 ItemsControl（如果重要的话，它是 Telerik RadOutlookBar）作为 UserControl 的根

那个视图，我也设置了 ItemTemplate 确保我插入到集合中的 ViewModel 被包装在相应的 RadOutlookBarItem 中（我应该在这里使用 ItemContainer 而不是 ItemTemplate 吗？）。

```
<telerik:RadOutlookBar x:Name="Items">
    <telerik:RadOutlookBar.TitleTemplate>
        <DataTemplate>
            <ContentControl Content="{Binding Path=DisplayName}" />
        </DataTemplate>
    </telerik:RadOutlookBar.TitleTemplate>
    <telerik:RadOutlookBar.ItemTemplate>
        <DataTemplate>
            <telerik:RadOutlookBarItem cal:Bind.Model="{Binding}"
                                       Header="{Binding Path=DisplayName}">
                <ContentControl />
            </telerik:RadOutlookBarItem>
        </DataTemplate>
    </telerik:RadOutlookBar.ItemTemplate>
</telerik:RadOutlookBar> 
```

这样，我不希望集合中的 ViewModel 出现在 ContentControl 所在的位置。我将模型绑定到 DataTemplate 的根项以确保约定有效，但不知道如何使用约定绑定到 ContentControl。DataTemplate 中的 DataContext 当然是 ViewModel 本身。使用普通的 WPF 标准，我会输入 Content="{Binding}"。

现在模型在 RadOutlookBarItem 内，但它的视图没有被应用。连 View 都找不到，只有一个带有类名的字符串。

这不是正确的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:35:34.857

正如我在这里回答的那样：[动态 Telerik RadOutlookBar 标头与 ItemTemplate 出现错误](https://stackoverflow.com/questions/11136995/dynamic-telerik-radoutlookbar-headers-come-out-wrong-with-itemtemplate)，我认为这是一个不相关的问题，我使用了错误的属性。ItemTemplate 控制选择器和 contentTemplate 当您选择时出现的内容。这是有效的代码：

```
<telerik:RadOutlookBar x:Name="Items">
    <telerik:RadOutlookBar.ContentTemplate>
        <DataTemplate >
            <ContentControl cal:View.Model="{Binding}" />
        </DataTemplate>
    </telerik:RadOutlookBar.ContentTemplate>
    <telerik:RadOutlookBar.TitleTemplate>
        <DataTemplate>
            <TextBlock x:Name="DisplayName"
                       cal:Bind.Model="{Binding}" />
        </DataTemplate>
    </telerik:RadOutlookBar.TitleTemplate>
    <telerik:RadOutlookBar.ItemTemplate>
        <DataTemplate>
            <TextBlock x:Name="DisplayName"
                       cal:Bind.Model="{Binding}" />
        </DataTemplate>
    </telerik:RadOutlookBar.ItemTemplate>
</telerik:RadOutlookBar> 
```

# java - 如何在android中开发仅java部分

> ID：11160294
> 
> 赞同：3
> 
> 时间：2012-06-22T16:25:31.320
> 
> 标签：java, android

我想开发一个 Android 应用程序。它由三部分组成：

*   客户端（应用程序）
*   服务器（仅限 java）
*   域（由客户端和服务器使用）

如何在一个 Eclipse 项目中开发客户端和服务器？必须有一种方法可以为包而不是 AndroidVM 设置正确的纯 Java 环境 (jre7)。

如果我尝试启动一个类，控制台日志如下：

```
Error occurred during initialization of VM
java/lang/NoClassDefFoundError: java/lang/ref/FinalReference 
```

...即使我在运行配置中更改了 JRE。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:00:31.520

如果我理解正确，您希望一组类针对 AndroidVM 运行，一组类针对 jre7。在 Eclipse 中拥有项目的整个想法是为了方便，它们维护自己独立的环境。Eclipse 为您处理所有疯狂的事情，您可以针对任何您想要的环境编写代码。

此外，如果您试图将其置于版本控制之下，您将不得不找到一种将项目分成两半的方法，这可能会阻止您使用任何 Eclipse 插件来处理它。如果你不这样做，即使你只想更新一个，你最终也不得不推送客户端和服务器的“新”版本。

对不起，如果我在杂草中走得很远，希望这会有所帮助。

# timeout - iphone 4S 在后台一段时间后从 XMPP 服务器脱机？

> ID：11160306
> 
> 赞同：2
> 
> 时间：2012-06-22T16:26:17.827
> 
> 标签：timeout, xmpp, background-process, ejabberd, iphone-4

我有一个使用 XMPP 和 EJABBERD 服务器的 iPhone 聊天应用程序，如果应用程序进入后台（通过点击主页按钮或由于缺乏活动然后屏幕变黑），该服务器设置为正常运行，然后继续正常运行当被带到前台时。

该应用程序在进入后台和返回前台时在 iPad 上运行良好，但是当我在 iPhone 4S 上运行该应用程序时，在应用程序进入后台大约一个小时后，该应用程序从 XMPP 服务器脱机。然后当 iPhone 4S 回到前台时，应用程序不再连接到 XMPP 服务器。相比之下，在 iPad 上，该应用程序已经在后台运行了一天多，并且仍然与 XMPP 服务器联机。

我看到了这个 SO[帖子](https://stackoverflow.com/questions/6223768/xmpp-gets-disconnected-after-iphone-goes-idle-for-more-than-10-mins)，但是由于该应用程序已经在我的 iPad 上的后台运行了一天多，并且 iPad 上的应用程序仍然与 XMPP 服务器联机，我认为这不是问题所在。

```
1)  Is this because the iPhone 4S goes into Airplane mode after some time?

2)  If the answer to 1) is yes, is there a way for the app to programmatically stop the iPhone 4S from going into Airplane mode?

3)  Or is something else going on? 
```

**更新 1 -**

有趣的是 iPad 可以在 XMPP 服务器上离线，但是当 iPad 上的应用程序被带到前台时，XMPP 工作正常。但是如果 iPhone 4S 上的应用程序在 XMPP 服务器上离线，那么当 iPhone 4S 上的应用程序被带到前台时，XMPP 就不再工作了。此外，iPad 在 XMPP 服务器上会在 20 分钟左右后快速下线，而 iPhone 4S 需要几个小时才能下线。也许 iPad 和 iPhone 4S 之间出现了不同的离线方式？

如本文所述，我已尝试在 XMPPStream.h 中的 DEFAULT_KEEPALIVE_INTERVAL 进行游戏[，](https://stackoverflow.com/questions/6223768/xmpp-gets-disconnected-after-iphone-goes-idle-for-more-than-10-mins)但到目前为止没有成功。在 XXMPStream.h 我有代码：

```
#if TARGET_OS_IPHONE
#define MIN_KEEPALIVE_INTERVAL      20.0 // 20 Seconds
#define DEFAULT_KEEPALIVE_INTERVAL 120.0 //  2 Minutes
#else
#define MIN_KEEPALIVE_INTERVAL      10.0 // 10 Seconds
#define DEFAULT_KEEPALIVE_INTERVAL 300.0 //  5 Minutes
#endif 
```

**更新 2 -**

另一个奇怪的是，当应用程序在 iPhone 4 上处于后台时，如果 iPad 上的应用程序想与 iPhone 4 聊天，iPad 会向 iPhone 4 发送一个 Push Notification。这个 Push Notification 使应用程序启动iPhone 4 到前台，iPhone 4 尝试重新连接到 EJABBERD 服务器，但 iPhone 4 不再能够重新连接。

**更新 3 -**

iPad 只有 Wifi，而 iPhone 4 有 Wifi 和 4G 蜂窝连接。所以我想也许这就是区别。所以我把 iPhone 4 设置成飞行模式，然后连接 Wifi，所以 iPhone 4 只使用 Wifi。但 2-3 小时后，iPhone 4 再次与 EJABBERD 服务器脱机。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T15:47:07.103

[我终于通过这个SO post](https://stackoverflow.com/questions/4656214/iphone-backgrounding-to-poll-for-events)找到了解决问题的方法。即使 iPhone 4 从 EJABBERD 服务器脱机，当应用程序进入前台时，应用程序可以重新连接到 EJABBERD 服务器，而以前应用程序无法重新连接。

具体来说，我使用了代码

```
- (void)applicationDidEnterBackground:(UIApplication *)application {

UIApplication*    app = [UIApplication sharedApplication];

// it's better to move "dispatch_block_t expirationHandler"
// into your headerfile and initialize the code somewhere else
// i.e. 
// - (void)applicationDidFinishLaunching:(UIApplication *)application {
//
// expirationHandler = ^{ ... } }
// because your app may crash if you initialize expirationHandler twice.
dispatch_block_t expirationHandler;
expirationHandler = ^{

    [app endBackgroundTask:bgTask];
    bgTask = UIBackgroundTaskInvalid;

    bgTask = [app beginBackgroundTaskWithExpirationHandler:expirationHandler];
};

bgTask = [app beginBackgroundTaskWithExpirationHandler:expirationHandler];

// Start the long-running task and return immediately.
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{

    // inform others to stop tasks, if you like
    [[NSNotificationCenter defaultCenter] postNotificationName:@"MyApplicationEntersBackground" object:self];

    // do your background work here     
}); 
} 
```

# view - Yii：将 login.php 视图渲染到另一个视图的 Div 标签中

> ID：11160311
> 
> 赞同：1
> 
> 时间：2012-06-22T16:26:32.333
> 
> 标签：view, yii, render

所以我正在研究一个页面来学习 Yii。就是这样：[http ://devcave.freeiz.com/](http://devcave.freeiz.com/)

我想要做的是，当我点击登录时，一个 div 正在向下滑动，login.php 表单应该在哪里。问题是我如何将它呈现到 main.php 的 div 标签中。

我试过了`$this->renderPartial('//site/login',array('model'=>$model));`，但我得到未定义的变量：模型错误。我阅读了理解 yii 视图渲染流程，但似乎我没有放弃理解这一点。

请问有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T19:13:46.997

用这个：

```
$this->renderPartial('site/login',array('model'=>new LoginForm)); 
```

在*登录视图*中，您应该`action`这样定义：

```
$form=$this->beginWidget('CActiveForm', array(
    // ...
    'action' => $this->createUrl( 'site/login' ),
    // ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T17:25:40.427

错误是您没有在控制器中定义名为 $model 的变量，并且在 View 登录中需要此变量。

当你打电话时在你的控制器中

```
$this->render('yourView', array()); 
```

您必须在第二个数组中添加要传递给登录视图的数据

```
$this->render('yourView', array('model'=>$model)); 
```

如果您需要更具体的答案，请不要犹豫发布您的代码！

# image-processing - 如何仅使用两帧来确定运动

> ID：11160325
> 
> 赞同：0
> 
> 时间：2012-06-22T16:27:10.807
> 
> 标签：image-processing, tracking, motion-detection

我正在学习使用一系列帧进行移动对象检测。

这是两个帧的示例。我需要在右框架中选择移动的对象。

我可以从另一帧中减去一帧。在所选区域中，结果将不为零 => 那是该区域中的运动。但是，如果您查看正确的框架，您也可以看到选择的背景。

我可以以某种方式将汽车与背景分开吗？

![在此处输入图像描述](../Images/7d3ec8ef66304b11499e3a5844d77aa4.png)

我猜这个方法，当我们收集背景像素时，从背景中减去图像在两帧上是没用的，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T14:30:56.970

您是对的，该方法仅在两帧时效果不佳。当您有一张只有背景的图像时，您描述的方法效果最好，然后您可以使用它与新图像进行比较以寻找运动。

可以仅用两帧计算物体的运动，但您可能需要更高级的方法，例如[光流](http://en.wikipedia.org/wiki/Optical_flow)或[图像配准](http://en.wikipedia.org/wiki/Image_registration)算法。

# xpath - XPath 选择具有属性值和子节点值的节点

> ID：11160329
> 
> 赞同：1
> 
> 时间：2012-06-22T16:27:25.420
> 
> 标签：xpath

背景 - Visual Studio 2010、C#、.Net Framework 4.0 应用程序

我有一个接收 XML 的网站，并且基于该 XML，我需要触发额外的处理。

我收到以下 XML（我已将其缩短为最小 XML）

```
<Event xmlns="http://www.mysite.com"  et='a'>
<audit>
    <cb>foo</cb>
</audit>
</Event> 
```

我一直在使用以下 XPath 来查看文档是否与其他处理相匹配。（检查是否有任何“事件”节点返回）。

```
 //std:Event[@et='a'] 
```

我一直在努力的地方是我需要找到所有事件节点，其中 et 属性为“a”并且 audit/cb 节点的值为“foo”

这就是我挣扎的地方......有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:55:21.693

不确定 C# 和 .NET 但在纯 XPath 语法中我相信它会是：

```
//Event[@et='a']/audit[cb='foo']/.. 
```

在以下位置查看 Xpath 语法：[http ://www.w3schools.com/XPath/xpath_syntax.asp](http://www.w3schools.com/XPath/xpath_syntax.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:59:46.510

我自己不是 .NET 用户，但试试这个：

```
//Event[@et='a' and audit/cb = 'foo'] 
```

# logging - SSIS 可执行表达式日志记录

> ID：11160338
> 
> 赞同：2
> 
> 时间：2012-06-22T16:27:50.587
> 
> 标签：logging, ssis

我有一个 DataFlow 任务，我通过表达式编辑器为`[DataReader Source].[SqlCommand]`属性分配了一个 sql 语句。

此 sql 语句包含在运行时更改的变量。所以出于调试目的；如何在运行时记录 SqlCommand 值？

我知道我可以在脚本任务中记录简单变量，`Dts.Variables["YourVariable"].Value`但我想知道如何访问任务属性（如上面的属性）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:41:40.197

我不相信您将有权访问包中的这些属性。出于这个原因，我的偏好是总是让任务上的表达式是一个直接的变量赋值。否则，调试和日志记录比他们需要的要困难得多。

# asp-classic - 是否可以在经典 ASP 中处理来自 activeX 对象的事件

> ID：11160344
> 
> 赞同：2
> 
> 时间：2012-06-22T16:28:26.980
> 
> 标签：asp-classic, jscript

从我最近发布的另一个问题来看，Classic ASP 似乎无法处理 activeX 对象可能抛出的事件。

任何人都可以验证这一点，或者如果可以，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T20:40:17.373

你是正确的 ASP 不能处理事件。它既没有将`CreateObject`脚本函数连接到事件所需的签名，也不支持`<script FOR`您可能在客户端使用的语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T02:03:40.453

> 是否可以在经典 ASP 中处理来自 activeX 对象的事件

不，如果您谈论的是 COM 事件。
但是，根据您所说的“事件”一词的含义，答案是“也许”。

请参阅[在 C# 中创建 COM/ActiveXObject，从 JScript 中使用，带有简单事件](https://stackoverflow.com/questions/11175145/create-com-activexobject-in-c-use-from-jscript-with-simple-event)

可以创建 COM 类/ActiveX 事物，在 JScript/Classic ASP 中对其进行实例化，并让 COM 类调用在 ASP 页面中定义的回调。这不是通过 COM 事件完成的，但它可以满足您的要求。

ASP 代码可能如下所示：

```
<script language="Javascript" runat="server">

var greet = Server.CreateObject("Ionic.Greet");

greet.onHello = function(arg, num) {
    Response.Write("onHello (ASP) invoked.<br/>\n");
    Response.Write("  num = " + num + "  stat=" + arg.status + "<br/>\n");
};

response = greet.Hello("ASP");
Response.Write("response: " + response + "<br/>\n");
Response.Write("status: " + greet.status + "<br/>\n");

</script> 
```

仅当正在创建的 COM 类公开一个可以设置的属性，然后调用该属性的“默认方法”时，这才有效。像这样：

```
public partial class Greet : IGreet
{
    public Object onHello { get; set; }

    public String Hello(string name)
    {
        var r = FireEvent();
        return "Why, Hello, " + name + "!!!" + r;
    }
} 
```

... FireEvent 是这样的：

```
private string FireEvent()
{
    if (onHello == null) return " (N/A)";
    onHello
        .GetType()
        .InvokeMember
        ("",
         BindingFlags.InvokeMethod,
         null,
         onHello,
         new object [] {});

    return "ok";
} 
```

显然，如果您有一个无法更改的 COM 类，并且它使用 COM 事件，那么这种方法将不适用。

# javascript - 动态读取数组值形成 JSON 对象

> ID：11160345
> 
> 赞同：-1
> 
> 时间：2012-06-22T16:28:27.873
> 
> 标签：javascript, arrays

我正在研究一个接受 JSON 对象作为参数的函数。传入的对象的每个属性都是一个数组。我需要确定每个数组的长度。

我不会提前知道的是：属性的名称，或者有多少属性。

如何确定每个数组的长度？同样，我不能明确引用任何属性/键，因为我不会提前知道它们的名称。如何将每个未知属性引用为数组？

提前谢谢你，-RS

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:36:01.200

用于`JSON.parse`将 JSON 数据转换为 JS 对象，然后可以使用 Array 的长度等属性。

```
var myObject = JSON.parse(myJSONtext, reviver); 
```

JSON 参考： http: [//www.json.org/js.html](http://www.json.org/js.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:55:43.333

您可以使用循环遍历对象`for...in`以访问每个属性。

```
for (var key in myObject) {
  // Check to make sure the property is not part of the `Object` prototype (eg. toString)
  if (myObject.hasOwnProperty(key)) {
    console.log(key, myObject[key].length);
  }
} 
```

在上面的例子中，我们遍历了对象的属性`myObject`并记录了它们的长度值（假设它们都是数组）。

如果“JSON 对象”是指它是 JSON 字符串，则可以首先通过使用`myObject = JSON.parse(myObject)`（适用于现代浏览器）或被`myObject = eval("(" + myOjbect + ")")`认为不安全（但适用于所有浏览器）将 myObject 解析为真正的对象。解析后，您可以使用上述技术来细化数组长度。

注意：由于您更新了帖子以指定对象为 JSON，因此您可能不需要*检查*`hasOwnProperty`，但始终使用此测试更安全。

# html - 试图在网页上实现两个音频文件

> ID：11160346
> 
> 赞同：1
> 
> 时间：2012-06-22T16:28:29.850
> 
> 标签：html, audio

很遗憾，我对 html 完全是个菜鸟，所以我希望你能回答我的问题。

我正在尝试在我的网页上实现三个音频文件，但只有一个源文件正在播放。其他文件的按钮有效，但它们只能从一个来源播放。你能帮助我吗？

这是代码：

```
<div class="sound1">
        <div style="text-align:center; width:100px; height:100px; margin-left:390px; margin-top:0px; background-repeat:no-repeat; "> 
            <button style="background-image:url(speaker_bakur.png); width:100px; height:100px; border:transparent;
                ; "margin-top:0px; margin-left:0px;" onclick="playPause();" ></button> 

                <audio id="Sound">
                <source src="" type="audio/wav" />
                <source src="" type="audio/ogg" />
                <source src="svartbakur-4.mp3" type="audio/mpeg" />
                </audio> 
                </div>

                <script type="text/javascript"> 
                var myAudio=document.getElementById("Sound"); 

                function playPause()
                { 
                if (myAudio.paused) 
                myAudio.play(); 
                else 
                myAudio.pause(); 
                }

                </script>

                </div>

                </div><!--Div hyphenate-->

<div class="sound2">
                <div style="text-align:center; width:100px; height:100px; margin-left:390px; margin-top:0px; background-repeat:no-repeat; "> 
                <button style="background-image:url(speaker_likka.png); width:100px; height:100px; border:transparent;
                ; "margin-top:0px; margin-left:0px;" onclick="playPause();" ></button> 

            <audio id="Sound">
                <source src="" type="audio/wav" />
                <source src="" type="audio/ogg" />
                <source src="likka-6.mp3" type="audio/mpeg" />
            </audio> 
        </div>

        <script type="text/javascript"> 
            var myAudio=document.getElementById("Sound"); 

            function playPause()
            { 
                if (myAudio.paused) 
                myAudio.play(); 
                else 
                myAudio.pause(); 
            }

            </script>

    </div>

    </div><!--Div hyphenate-->

<div class="sound3">
        <div style="text-align:center; width:100px; height:100px; margin-left:390px; margin-top:0px; background-repeat:no-repeat; "> 
            <button style="background-image:url(speaker_fiskimasi.png); width:100px; height:100px; border:transparent;
                ; "margin-top:0px; margin-left:0px;" onclick="playPause();" ></button> 

                <audio id="Sound">
                <source src="" type="audio/wav" />
                <source src="" type="audio/ogg" />
                <source src="fiskimasi-21.mp3" type="audio/mpeg" />
                </audio> 
                </div>

                <script type="text/javascript"> 
                var myAudio=document.getElementById("Sound"); 

                function playPause()
                { 
                if (myAudio.paused) 
                myAudio.play(); 
                else 
                myAudio.pause(); 
                }

                </script>

                </div>

                </div><!--Div hyphenate--> 
```

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:30:55.273

您有多个具有相同 ID 的元素。您`playPause()`每次都在重新定义函数。一般来说，你似乎不知道自己在做什么。

最好将`controls`属性添加到`audio`标签中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:31:28.837

播放器正在寻找 ID“声音”。

```
getElementById("Sound"); 
```

你有 3`<audio id="Sound">`秒

尝试将它们更改为`<audio id="Sound1">`等`<audio id="Sound2">`

您需要更新播放器以反映您的新音频 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T17:06:44.560

我刚刚测试并发现您的问题与您用于播放音频文件的 JavaScript 代码有关，并且您将音频标签定义为单个标签的方式与所有 mp3 文件绑定：

```
<div style="text-align:center; width:100px; height:100px; margin-left:390px; margin-top:0px; background-repeat:no-repeat; "> 
   <audio id="Soundx1">
     <source  src="XXXXXX.mp3" type="audio/mp3">
       </audio> 
     <button style="background-image:url(speaker_bakur.png); width:100px; height:100px; border:transparent; "margin-top:0px; margin-left:0px;" onclick="playPause();" ></button> 
     </div>
     <script type="text/javascript"> 
        var myAudio1=document.getElementById("Soundx1"); 
        function playPause()
        { 
            if (myAudio1.paused) 
            myAudio1.play(); 
            else 
            myAudio1.pause(); 
        }
    </script>
</div> 
```

所以我有什么变化：

1.  音频 id=*每个音频文件唯一*
2.  每个音频 ID 的唯一 JavaScript 对象为 var myAudioXX=document.getElementById("_unique_id_");

此代码确实适用于多个 mp3 文件。此外，您应该使用一个 JavaScript 函数来播放所有文件，而不是使用 each 函数来播放每个文件。如果您将使用一个 JavaScript 函数来播放所有文件，则可以通过对象引用传递 ID 标记，它将简化为代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T17:26:03.170

以下是如何从一个 JavaScript 函数播放多个音频：

```
<HTML>
<head>
<title>aa</title>
 <script type="text/javascript"> 
function playPause(x)
{ 
    var myAudio=document.getElementById(x); 
    if (myAudio.paused) 
    myAudio.play(); 
    else 
    myAudio.pause(); 
}
</script>
</head>
<body>
<div class="sound1">
    <div style="text-align:center; width:100px; height:100px; margin-left:390px; margin-top:0px; background-repeat:no-repeat; "> 
            <audio id="Soundx1">
                <source  src="XXXXX.mp3" type="audio/mp3">
            </audio> 
            <button style="background-image:url(speaker_bakur.png); width:100px; height:100px; border:transparent; margin-top:0px; margin-left:0px;" onclick="playPause('Soundx1');" ></button> 
     </div>
</div>
<div class="sound2">
            <div style="text-align:center; width:100px; height:100px; margin-left:390px; margin-top:0px; background-repeat:no-repeat; "> 
        <audio id="Soundx2">
        <source  src="XXXXX.mp3" type="audio/mp3" />
        </audio> 
            <button style="background-image:url(speaker_likka.png); width:100px; height:100px; border:transparent; margin-top:0px; margin-left:0px;" onclick="playPause('Soundx2');" ></button> 
    </div>
</div>
<div class="sound3">
    <div style="text-align:center; width:100px; height:100px; margin-left:390px; margin-top:0px; background-repeat:no-repeat; "> 
            <audio id="Soundx3">
            <source  src="XXXXXX.mp3" type="audio/mp3" />
            </audio> 
        <button style="background-image:url(speaker_fiskimasi.png); width:100px; height:100px; border:transparent; margin-top:0px; margin-left:0px;" onclick="playPause('Soundx3');" ></button> 
    </div>
</div>
</body>
</html> 
```

# iphone - DetailView Page 从 RowView 继承代码

> ID：11160347
> 
> 赞同：0
> 
> 时间：2012-06-22T16:28:32.567
> 
> 标签：iphone, objective-c, ios, ios5, ios4

1.  我有一个详细视图页面，在它上面的标题标签似乎是我导航的行的标题。我只需要不在导航栏中显示任何内容，但会出现标题并且我不知道在哪里更改它。

2.  我也有一个后退按钮，但是如果我使用 navigation.backbarbuttonItem 那么上一页的标题会出现在按钮上。我希望按钮重新回到它上面。我使用 leftbarbuttonItem 创建了一个按钮，但是无法将该按钮设置为看起来像后退按钮（一侧指向）。它看起来只是一个我不喜欢的矩形按钮。

有谁知道如何调整这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:21:03.710

对于数字 1，您可以在 viewWillAppear 或 viewDidAppear 上设置 viewController 标题，可以说

```
- (void)viewWillAppear:(BOOL)animated
{
  [super viewWillAppear:animated];
  self.title = @"";
} 
```

对于数字 2，您可以使用此代码来设置“返回”尖头按钮。

```
UIViewController *viewController = [UIViewController alloc] init];

// This code    
UIBarButtonItem *backButton = [[UIBarButtonItem alloc] initWithTitle:@"Back" 
                                                               style:UIBarButtonItemStyleBordered
                                                              target:nil
                                                              action:nil];
self.navigationItem.backBarButtonItem = backButton;
[backButton release];

[self.navigationController pushViewController:viewController animated:YES]; 
```

# iphone - 如何让 AuGraph 从文件开头重新启动音频文件？

> ID：11160351
> 
> 赞同：0
> 
> 时间：2012-06-22T16:28:46.263
> 
> 标签：iphone, ios, audio, core-audio, mixer

我正在使用 Apple 的 MixerHost 应用程序。这是如何设置 AuGraph 的一个很好的例子，但是停止按钮实际上是一个暂停按钮。当您点击播放时，它会继续从最后一个位置播放声音文件。我想要一个真正的停止按钮，使播放头移回开始。我在苹果的文档中查找了 AuGraph，但如果创建一个全新的图形，我没有看到任何关于重新开始歌曲的内容，而我不想这样做，因为我有很大的加载延迟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:20:01.167

弄清楚了。这是我的方法

```
 for (int audioFile = 0; audioFile < NUM_FILES; ++audioFile)  {    

         soundStructArray[audioFile].sampleNumber = 0;

    } 
```

# java - 通过网络服务查询自定义字段

> ID：11160352
> 
> 赞同：0
> 
> 时间：2012-06-22T16:28:50.373
> 
> 标签：java, soap, rally

我在我的 Rally 工作区中自定义了 Defect 的内容，添加了一个新的自定义字段。

此自定义字段为字符串类型，其名称为 CustomTest，其显示名称为 CustomAttribute。

我在缺陷上添加了值“test”，但我无法在该自定义字段上创建工作查询（我正在使用 Java 开发并使用 ws api 进行集会）。

我试过的查询是

字符串 query8 = "(CustomAttribute = \"test\")"; 字符串 query9 = "(CustomAttribute = \"test\")";

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T15:36:02.760

在 Rally 查询中，您必须引用实际字段名称而不是显示名称。因此，如果你这样做：

```
 String query8 = "(CustomTest = \"test\")"; String query9 = "(CustomTest = \"test\")"; 
```

那么我希望您的查询能够正常工作。我的评论中的信息：使用 WSAPI 文档来帮助在代码之外运行/测试查询应该仍然对您有用。

# android - 如何在 Android 中使用 WCF .SVC

> ID：11160355
> 
> 赞同：3
> 
> 时间：2012-06-22T16:29:00.663
> 
> 标签：android, .net, wcf, web-services, ksoap2

我红色了很多关于的文件，但我不能使用这个 .svc 文件。我对 .ASMX 文件没有任何问题。只有 SVC 我无法消费。非常非常非常紧张……！我无法修改 WCF 部分。我发布 WSDL 文件并尝试使用它：

**WSDL**

```
<wsdl:definitions xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" 
 xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" 
 xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" 
 xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" 
 xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" 
 xmlns:tns="http://tempuri.org/" 
 xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing" 
 xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" 
 xmlns:wsap="http://schemas.xmlsoap.org/ws/2004/08/addressing/policy"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
 xmlns:msc="http://schemas.microsoft.com/ws/2005/12/wsdl/contract" 
 xmlns:wsaw="http://www.w3.org/2006/05/addressing/wsdl" 
 xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" 
 xmlns:wsa10="http://www.w3.org/2005/08/addressing" 
 xmlns:wsx="http://schemas.xmlsoap.org/ws/2004/09/mex" name="ValidateUser_wcf" 
 targetNamespace="http://tempuri.org/">
<wsp:Policy wsu:Id="WSHttpBinding_IValidateUser_wcf_policy">
<wsp:ExactlyOne>
<wsp:All>
<wsaw:UsingAddressing/>
</wsp:All>
</wsp:ExactlyOne>
</wsp:Policy>
<wsdl:types>
<xsd:schema targetNamespace="http://tempuri.org/Imports">
<xsd:import schemaLocation="http://URL/WebServices/validateuser.svc?xsd=xsd0" namespace="http://tempuri.org/"/>
<xsd:import schemaLocation="http://URL/WebServices/validateuser.svc?xsd=xsd1" namespace="http://schemas.microsoft.com/2003/10/Serialization/"/>
</xsd:schema>
</wsdl:types>
<wsdl:message name="IValidateUser_wcf_ValidateUser_InputMessage">
<wsdl:part name="parameters" element="tns:ValidateUser"/>
</wsdl:message>
<wsdl:message name="IValidateUser_wcf_ValidateUser_OutputMessage">
<wsdl:part name="parameters" element="tns:ValidateUserResponse"/>
</wsdl:message>
<wsdl:portType name="IValidateUser_wcf">
<wsdl:operation name="ValidateUser">
<wsdl:input wsaw:Action="http://tempuri.org/IValidateUser_wcf/ValidateUser" message="tns:IValidateUser_wcf_ValidateUser_InputMessage"/>
<wsdl:output wsaw:Action="http://tempuri.org/IValidateUser_wcf/ValidateUserResponse" message="tns:IValidateUser_wcf_ValidateUser_OutputMessage"/>
</wsdl:operation>
</wsdl:portType>
<wsdl:binding name="WSHttpBinding_IValidateUser_wcf" type="tns:IValidateUser_wcf">
<wsp:PolicyReference URI="#WSHttpBinding_IValidateUser_wcf_policy"/>
<soap12:binding transport="http://schemas.xmlsoap.org/soap/http"/>
<wsdl:operation name="ValidateUser">
<soap12:operation soapAction="http://tempuri.org/IValidateUser_wcf/ValidateUser" style="document"/>
<wsdl:input>
<soap12:body use="literal"/>
</wsdl:input>
<wsdl:output>
<soap12:body use="literal"/>
</wsdl:output>
</wsdl:operation>
</wsdl:binding>
<wsdl:service name="ValidateUser_wcf">
<wsdl:port name="WSHttpBinding_IValidateUser_wcf" binding="tns:WSHttpBinding_IValidateUser_wcf">
<soap12:address location="http://URL/WebServices/validateuser.svc"/>
<wsa10:EndpointReference>
<wsa10:Address>
http://URL/WebServices/validateuser.svc
</wsa10:Address>
</wsa10:EndpointReference>
</wsdl:port>
</wsdl:service>
</wsdl:definitions> 
```

**我的 Java #1**。简单地说，我已经复制了在嗅探有关原始 .NET 客户端的 HTTP POST 流量后出来的 xml，我必须使用 Microsoft .Net Monitor 应用程序在 java 中复制它：

```
private static final String NAMESPACE = "http://tempuri.org/";
private static final String NAMESPACE_INFOCAD = "http://xxxx.xxx/"; 

private static final String SOAP_ACTION_VALIDATION = "IValidateUser_wcf/ValidateUser";
private static final String VALIDATION_METHOD = "ValidateUser";
private final static String VALIDATION_URI = "http://URL/WebServices/validateuser.svc";

// only a1 node in the header i know, each other is unknown for me. I put them there only because i saw them in soap net client http post
String request = "<?xml version=\"1.0\" encoding=\"utf-8\"?>"+
        "<s:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">"
        + "<s:Header>"
        //+ "<a:Action s:mustUnderstand=\"1\"> http://tempuri.org/IValidateUser_wcf/ValidateUser </a:Action>"
        + "<a1 xmlns=\"http://xxxx.xxx/\">"+testtoken+"</a1>"
        + "<a:MessageID> urn:uuid:c075fc4e-1e70-48f7-838b-9fa68e7aaad1 </a:MessageID>"
        + "<ActivityId CorrelationId=\"0d4e09eb-5d09-4617-a8e1-ec99415caab5\" xmlns=\"http://schemas.microsoft.com/2004/09/ServiceModel/Diagnostics\">"
        + "25adfad8-ab5f-474a-afe3-56941d4ad408"
        + "</ActivityId>"
        + "<a:ReplyTo> http://www.w3.org/2005/08/addressing/anonymous </a:ReplyTo>"
        + "<a:To s:mustUnderstand=\"1\"> http://URL/WebServices/validateuser.svc </a:To>"
        + "</s:Header>"
        + "<s:Body><ValidateUser xmlns=\"http://tempuri.org/\"><username>"+username+"</username><password>"+password+"</password></ValidateUser></s:Body>"
        + "</s:Envelope>";

    String result = CallWebService(VALIDATION_URI, NAMESPACE+VALIDATION_METHOD, request);   

public String CallWebService(String url, String soapAction, String envelope) {  

    final DefaultHttpClient httpClient = new DefaultHttpClient();
    // request parameters
    HttpParams params = httpClient.getParams();
    HttpConnectionParams.setConnectionTimeout(params, 10000);
    HttpConnectionParams.setSoTimeout(params, 15000);
    // set parameter
    HttpProtocolParams.setUseExpectContinue(httpClient.getParams(), true);

    // POST the envelope
    HttpPost httppost = new HttpPost(url);
    // add headers
    httppost.setHeader("soapaction", soapAction);
    httppost.setHeader("Content-Type", "text/xml; charset=utf-8");

    String responseString = "Nothingggg";
    try {

        // the entity holds the request
        HttpEntity entity = new StringEntity(envelope);
        httppost.setEntity(entity);

        // Response handler
        ResponseHandler<String> rh = new ResponseHandler<String>() {
            // invoked when client receives response
            public String handleResponse(HttpResponse response)
                    throws ClientProtocolException, IOException {

                // get response entity
                HttpEntity entity = response.getEntity();                   

                // read the response as byte array
                StringBuffer out = new StringBuffer();
                byte[] b = EntityUtils.toByteArray(entity);

                // write the response byte array to a string buffer
                out.append(new String(b, 0, b.length));
                return out.toString();
            }
        };

         responseString = httpClient.execute(httppost, rh);

    } catch (Exception e) {
        e.printStackTrace();
        Log.d("me","Exc : "+ e.toString()); 

    }

    // close the connection
    httpClient.getConnectionManager().shutdown();
    return responseString;
} 
```

**我的 Java #2 由 Ksoap2 编写**。在这种情况下，我收到此错误：

```
XmlPullParserException: unexpected type 
(position:END_DOCUMENT null@1:1 in 
java.io.InputStreamReader@blablabla) 
```

但我将 xml 字符串请求放在验证 xml 应用程序中，没关系：

```
public String validateUser_WCF(String username, String password){

     String enctoken = TOKEN;
     String testtoken = TestTOKEN;      

     SoapSerializationEnvelope envelope = null;
     SoapObject request = null;
     HttpTransportSE httpTransportSE = null;

     try {
         request = new SoapObject(NAMESPACE, VALIDATION_METHOD);
         request.addProperty("username", username);
         request.addProperty("password", password);

         envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
         envelope.dotNet = true; 
         envelope.setOutputSoapObject(request);

         Element[] header = new Element[2];  
         header[0] = new Element().createElement(NAMESPACE, "To");
         header[0].setName("a1");                 
         header[0].addChild(Node.TEXT, VALIDATION_URI);

         header[1] = new Element().createElement(NAMESPACE_INFOCAD, "a1");                
         header[1].addChild(Node.TEXT, testtoken);

         envelope.headerOut = header;                                 

         httpTransportSE = new HttpTransportSE(VALIDATION_URI);

         httpTransportSE.debug = true;
         //httpTransportSE.setXmlVersionTag("<?xml version=\"1.0\" encoding=\"utf-8\"?>");

         httpTransportSE.call(NAMESPACE+SOAP_ACTION_VALIDATION, envelope);

         String response = (String) envelope.getResponse();
         Log.i("RESPONSE", response);
         return response;  

        } catch (Exception e) {
            // TODO: handle exception
            e.printStackTrace();
        }finally{
             Log.i(getClass().getSimpleName(),"requestDump : "+httpTransportSE.requestDump);
             Log.i(getClass().getSimpleName(),"responseDump : "+httpTransportSE.responseDump);
        } 
```

我真的很希望有人能帮助我。我来到了一个死角......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:08:08.593

您可以控制 WCF 部分吗？

最简单的方法是更新 WCF 绑定。目前是`WSHttpBinding`，该绑定比 *.asmx 复杂得多。

检查是否可以使用`basicHttpBinding`绑定发布端点。

[http://msdn.microsoft.com/en-us/library/ms731361.aspx](http://msdn.microsoft.com/en-us/library/ms731361.aspx)

该绑定与 *.asmx 兼容，您只需更新 java 代码中的 URL 即可使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-18T13:25:20.220

我自己解决了（WCF绑定必须是basicHttpBinding，否则不起作用）：

```
private static final String NAMESPACE = "http://tempuri.org/";
private static String URL="your url";

private static final String SOAP_ACTION_VALIDATION = "IValidateUser_wcf/ValidateUser";
private static final String VALIDATION_METHOD = "ValidateUser";

public boolean validateUser_WCF(String username, String password){

    SoapSerializationEnvelope envelope = null;
    SoapObject request = null;
    HttpTransportSE httpTransportSE = null;

    try {
        request = new SoapObject(NAMESPACE, VALIDATION_METHOD);
        request.addProperty("username", username);
        request.addProperty("password", password);

        envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.dotNet = true; 
        envelope.setOutputSoapObject(request);

        //////////////////////////////                               
        // here you can add a HEADER element if you want
        Element[] header = new Element[1];  

        header[0] = new Element().createElement(NAMESPACE_INFOCAD, "a1");                
        header[0].addChild(Node.TEXT, "HeaderTextContent");

        envelope.headerOut = header;
        //////////////////////////////                               

        httpTransportSE = new HttpTransportSE(URL+VALIDATION_URI, 10*10000); // second parameter is timeout
        httpTransportSE.debug = true;
        httpTransportSE.setXmlVersionTag("<?xml version=\"1.0\" encoding=\"utf-8\"?>");
        httpTransportSE.call(NAMESPACE+SOAP_ACTION_VALIDATION, envelope);

        // if response is a simple text result, you can call SoapPrimitive, if not, you have to call SoapObject result and navigate in response's tree like an xml file
        SoapPrimitive result = (SoapPrimitive)envelope.getResponse();

        //To get the data.
        String textResult = result.toString();
        Log.i("textResult", textResult); 

        return true;

    } catch (Exception e) {
        // TODO: handle exception
        e.printStackTrace();
    }finally{
                // here you can see in LOG what is request you send and what is response received
                Log.i(getClass().getSimpleName(),"requestDump : "+httpTransportSE.requestDump);
                Log.i(getClass().getSimpleName(),"responseDump : "+httpTransportSE.responseDump);
    }

    return false;
} 
```

# javascript - 你如何在 Javascript 中组合两个对象？

> ID：11160356
> 
> 赞同：6
> 
> 时间：2012-06-22T16:29:08.820
> 
> 标签：javascript, arrays, object

> **可能重复：**
> [如何动态合并两个 JavaScript 对象的属性？](https://stackoverflow.com/questions/171251/how-can-i-merge-properties-of-two-javascript-objects-dynamically)

如果我有两个 Javascript 对象用作键值对列表：

```
var a = {a:1};
var b = {b:2}; 
```

将它们组合成包含两者属性的第三个对象的最有效方法是什么？

```
var c = {a:1, b:2}; 
```

我不介意在此过程中是否对`a`和中的一个或两个进行了`b`修改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T16:30:55.720

You can do simply this :

```
 var c = {};
   for (var key in a) {
      c[key] = a[key];
   }
   for (var key in b) {
      c[key] = b[key];
   } 
```

* * *

If you want to do a deep merging (assuming you don't want to copy the functions and prototypes), you can use this :

```
 function goclone(source) {
        if (Object.prototype.toString.call(source)==='[object Array]') {
            var clone = [];
            for (var i=0; i<source.length; i++) {
                if (source[i]) clone[i] = goclone(source[i]);
            }
            return clone;
        } else if (typeof(source)=="object") {
            var clone = {};
            for (var prop in source) {
                if (source[prop]) {
                    var firstChar = prop.charAt(0);
                    clone[prop] = goclone(source[prop]);
                }
            }
            return clone;
        } else {
            return source;
        }
    }

   var c = {};
   for (var key in a) {
      c[key] = goclone(a[key]);
   }
   for (var key in b) {
      c[key] = goclone(b[key]);
   } 
```

But frankly I never saw the use for a deep merging in javascript...

# linux - 强制内核中的进程休眠 60 秒

> ID：11160357
> 
> 赞同：1
> 
> 时间：2012-06-22T16:29:15.267
> 
> 标签：linux, linux-kernel

假设我在内核中有一个“坏”进程，我想通过强制它休眠 60 秒然后重新安排它来惩罚它——我该怎么做？我必须操纵内核中的哪些功能和数据结构来实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:36:20.913

如果您在该进程的上下文中，并且没有持有任何锁，则只需执行 msleep / ssleep。

```
 ssleep(60); 
```

请注意，这不会是“完全” 60 秒，就像`sleep()`函数一样准确。

如果您在其他进程的上下文中，则需要暂停该进程的信号并安排唤醒。我想使用用户模式帮助程序会更简单。[有关如何调用 helper 的](http://people.ee.ethz.ch/~arkeller/linux/kernel_user_space_howto.html#s7)信息，请参阅this 。

# css - css没有在ipad中加载

> ID：11160359
> 
> 赞同：1
> 
> 时间：2012-06-22T16:29:16.217
> 
> 标签：css, ipad

最近有人指出我的个人网站无法在 ipad 上运行，因为 css 没有加载。这怎么可能？在 iphone 上，系统可以正常工作，在任何其他平台上也可以。可能是因为我通过一个 master.css 加载所有样式表以加快下载速度。我的个人网站是：webofdreams.ro

有没有人遇到过同样的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:33:37.470

我不认为那实际上是“更快”。最好将所有 css 放入一张表中，以实现最少的 http 请求。

作为旁注，它在我的 ipad 上加载，但你有一个半透明的 div 阻止一切。

# shell - 在 Jenkins 中构建后执行 Shell 脚本

> ID：11160363
> 
> 赞同：84
> 
> 时间：2012-06-22T16:29:28.867
> 
> 标签：shell, jenkins, jenkins-plugins

如果构建通过或在 Jenkins 中构建后失败，我正在尝试执行 shell 脚本。除了运行目标之外，我在构建后看不到这个选项来执行一些 shell 脚本。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-10-11T11:03:45.600

[使用后期构建任务](https://wiki.jenkins-ci.org/display/JENKINS/Post+build+task)插件很容易完成。

![詹金斯 -](../Images/0de4f848dd1b050b89e2646a762d1fc3.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-03T16:23:51.960

您还可以使用[Groovy Post Build](https://wiki.jenkins-ci.org/display/JENKINS/Groovy+Postbuild+Plugin)运行任意命令- 这将使您能够对它们何时运行等进行大量控制。在构建失败或不稳定的情况下，我们使用它来运行“指责”shell 脚本。

```
if (manager.build.result.isWorseThan(hudson.model.Result.SUCCESS)) {
  item = hudson.model.Hudson.instance.getItem("PROJECTNAMEHERE")
  lastStableBuild = item.getLastStableBuild()
  lastStableDate = lastStableBuild.getTime()
  formattedLastStableDate = lastStableDate.format("MM/dd/yyyy h:mm:ss a")
  now = new Date()
  formattedNow = now.format("MM/dd/yyyy h:mm:ss a")
  command = ['/appframe/jenkins/appframework/fob.ksh', "${formattedLastStableDate}", "${formattedNow}"]
  manager.listener.logger.println "FOB Command: ${command}"
  manager.listener.logger.println command.execute().text
} 
```

（我们的命令将最后一个稳定的构建日期和当前时间作为参数，因此它可以调查谁可能破坏了构建，但您可以以类似的方式运行您喜欢的任何命令）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-26T18:27:48.617

如果我没看错你的问题，你想在构建的构建后操作部分运行一个脚本。

我自己使用[PostBuildScript 插件](https://wiki.jenkins-ci.org/display/JENKINS/PostBuildScript+Plugin)`git clean -fxd`在构建归档工件并发布测试结果后运行。我的 Jenkins 奴隶有 SSD 磁盘，所以我没有房间在工作区中保存生成的文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-03T09:43:55.083

您应该可以使用[Batch Task 插件](https://wiki.jenkins-ci.org/display/JENKINS/Batch+Task+Plugin)来做到这一点。

1.  在项目中创建批处理任务。
2.  添加选择同一项目的“调用批处理任务”构建后选项。

替代方案也可以是[Post build task](https://wiki.jenkins-ci.org/display/JENKINS/Post+build+task)插件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-22T17:02:34.937

您必须将构建后的 shell 脚本设置为单独的 Jenkins 作业，并将其作为构建后步骤触发。看起来您需要使用[参数化触发器插件](http://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Trigger+Plugin)，因为标准的“构建其他项目”选项仅在您的触发构建成功时才有效。

# mysql - 使用 Rails 和 MySQL 表单数据未发布到数据库

> ID：11160364
> 
> 赞同：0
> 
> 时间：2012-06-22T16:29:34.910
> 
> 标签：mysql, ruby-on-rails, forms

我在 Rails 中提交了一个表单，其中表单上的一些参数没有发布到数据库中，而是作为“null”传递。未发布的参数是**:starthour**，**:endhour**，不知道为什么，但有时**:rentend**

我想不通..见下文

**表单视图**

```
<div class="gearside_date_top">
    <%= form_for LineItem.new do |f| %>
    <p><%= render :partial => "price" %> / 
        <%= f.select :day_or_hour, [['day', 'day'], ['hour', 'hour']], :id => 'day_or_hour' %>
    </p>
</div>
<script>
$('#line_item_day_or_hour').change(function() {
     if($('#line_item_day_or_hour').val() != 'hour') { 
     $('.hourlyshowhide').hide();
     $('#gear_daily').show();
     } 
     else {
     $('.hourlyshowhide').show();//else it is shown
     $('#gear_daily').hide();
     }
});
</script>
<div class="gearside_date_main">
    <h3 style="font-family: 'RockSaltRegular', 'JosefinSansStdLight', Helvetica, Arial, sans-serif;color: #71a41e; font-size: 16px; margin: 15px 0 5px 15px;">Rental Date</h3>      

    <%= f.text_field :rentstart, id: 'rentstart', :value => "Pickup"  %>
        <%= f.text_field :rentend, id: 'rentend', :value => "Drop Off"  %>
        <%= image_tag('calendar.png', :style => "float:left; padding-top: 8px") %>
        <%= f.hidden_field :gear_id, :value => @gear.id %>
        </br></br>
        <div class="gear_time_schedule hourlyshowhide">
        <span class="gear_time_schedule_container">
            <%= f.label :starthour, 'Pick Up Time', class: 'labeltext' %>
            <%= f.text_field :starthour, id: 'starthour', :value => "" %>
        </span>
        <span class="gear_time_schedule_container">
            <%= f.label :endhour, 'Drop Off Time', class: 'labeltext' %>
            <%= f.text_field :endhour, id: 'endhour', :value => "" %>
        </span>
    </div>
    <%= f.submit "", id: 'rent_it' %>
<% end %>
</div>
<script>
$('#starthour').timepicker({ 'step': 15 });
$('#endhour').timepicker({ 'step': 15 });
</script> 
```

**日志文件**

```
Started POST "/line_items" for 127.0.0.1 at 2012-06-22 10:24:54 -0600
Processing by LineItemsController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"MutF3dqAQpdtHtkvX1mTTxS+48styiHc1M94o8es3yA=", "line_item"=>{"day_or_hour"=>"hour", "rentstart"=>"06/05/2012", "rentend"=>"06/16/2012", "gear_id"=>"2"}, "commit"=>""}
  [1m[36mCart Load (0.3ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 28 LIMIT 1[0m
  [1m[35mGear Load (0.2ms)[0m  SELECT `gears`.* FROM `gears` WHERE `gears`.`id` = 2 LIMIT 1
  [1m[36mLineItem Load (0.3ms)[0m  [1mSELECT `line_items`.* FROM `line_items` WHERE `line_items`.`cart_id` = 28 AND `line_items`.`gear_id` = 2 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.6ms)[0m  [1mUPDATE `line_items` SET `quantity` = 2, `updated_at` = '2012-06-22 16:24:54' WHERE `line_items`.`id` = 9[0m
  [1m[35m (13.5ms)[0m  COMMIT
  [1m[36mCart Load (0.4ms)[0m  [1mSELECT `carts`.* FROM `carts` WHERE `carts`.`id` = 28 LIMIT 1[0m
Redirected to http://localhost:3000/carts/28
Completed 302 Found in 76ms (ActiveRecord: 15.5ms) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T07:22:47.547

有两个问题。

第一个是日期格式，我在这里找到了答案[Rails 3 jquery date picker date not save to database](https://stackoverflow.com/questions/7181220/rails-3-jquery-date-picker-date-not-saving-to-database)

第二个是 jquery 插件 jquery-timepicker-rails。我最终删除了供应商文件夹中的插件并安装了[gem](https://github.com/tkrotoff/jquery-timepicker-rails)。这解决了我的问题。

# android - 适用于 Android 的必应包装器

> ID：11160369
> 
> 赞同：0
> 
> 时间：2012-06-22T16:29:51.707
> 
> 标签：android, translation, google-translate, bing-api

我们正在开发一个 Android 项目。由于不推荐使用 Google Translate API，我们正在使用 Microsoft Translator (BING)。Android 上是否有适合 Bing 的包装器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T03:39:30.273

Microsoft Translator API 每月最多可免费使用 200 万个字符。

它支持此处列出的语言：http: [//msdn.microsoft.com/en-us/library/hh456380.aspx](http://msdn.microsoft.com/en-us/library/hh456380.aspx)

现在关于如何访问有点令人困惑，因为它们正处于从用于身份验证的 Bing AppID 机制向基于 Azure 市场 OAuth 的机制过渡的过程中。

有关注册服务和获取 OAuth 凭据的详细信息在这里：http://blogs.msdn.com/b/translation/p/gettingstarted1.aspx

然后可以通过 HTTP 服务或 SOAP Web 服务访问转换器服务。我没有在 Android 上尝试过 SOAP，但如果您的工具可以生成代理类（就像 VS 为 C#/VB 开发人员所做的那样），那将是最简单的访问它的方法。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T19:10:52.040

也许尝试在[这里查看](https://stackoverflow.com/questions/8672796/automatic-translation-tool-for-android)“辣椒”的第二个答案。我对此不太熟悉，但似乎可以使用“SOAP”进行设置。希望有帮助。

# java - Axis2 选项：setAction()

> ID：11160374
> 
> 赞同：0
> 
> 时间：2012-06-22T16:30:08.680
> 
> 标签：java, http, client, axis2

我已经成功地创建了一个 HTTP 基本身份验证客户端。

有一个特定的操作，我对它的目的有些怀疑。

我尝试了一个简单的 helloworld 脚本教程，其他一些教程是互联网，我看到了这个：

```
options.setAction("urn:echo"); 
```

如果我评论这行代码，客户端仍然可以工作。

那么它有什么作用呢？我找不到这方面的具体信息。

我知道我的服务有一个“回声”操作。

因此，如果我同时有“echo”和“echo2”操作，我必须为每个操作调用 setAction 吗？

问候，努诺。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T15:24:16.823

这是操作元素的 wsdl 绑定中的 soapAction 属性。如果 WSDL 中没有指定任何内容，那么它的值应该是空白字符串，或者应该使用 WSDL 中提到的确切值。它的目的不是很明确，但它可以用于过滤流量。

# forms - Chrome: HTML form fields with CSS3 background gradient take on parent background colour on focus

> ID：11160377
> 
> 赞同：1
> 
> 时间：2012-06-22T16:30:17.353
> 
> 标签：forms, google-chrome, css, gradient

I'm in the process of redesigning a website for a friend from school. Along the way I've encountered a weird bug in Google Chrome: I've styled the contact form (very basic, an `input` each for name and email address and a `textarea` for comments) using a CSS3 gradient background.

Everything works fine – until you click inside a field to enter data, whereupon the name `input` and `textarea` take on the background colour of their parent `form` element. The email `input`, meanwhile, retains the gradient both when focussed and when not (as desired).

Please visit [http://www.chrisphilpot.co.uk/lucycooper2012/](http://www.chrisphilpot.co.uk/lucycooper2012/) to see what I am getting at. As I say, it seems to look fine in Firefox and IE9 picks up on the flat background #FFF which will do for the time being!

Do you have any bright ideas to fix this? I've relinked the page to the full, uncompressed CSS so feel free to have a rummage. The main styles for the form are in: [http://www.chrisphilpot.co.uk/lucycooper2012/css/form.css](http://www.chrisphilpot.co.uk/lucycooper2012/css/form.css)

Thank you for your help and time!

# asp.net-mvc - ASP.NET WEB API 将 DateTime 作为 URI 的一部分传递给控制器

> ID：11160381
> 
> 赞同：5
> 
> 时间：2012-06-22T16:30:36.840
> 
> 标签：asp.net-mvc, rest, asp.net-web-api

假设我有一个具有以下方法的控制器：

```
public int Get(DateTime date)
{
    // return count from a repository based on the date
} 
```

我希望能够在将日期作为 URI 本身的一部分传递时访问方法，但目前我只能在将日期作为查询字符串传递时才能使其工作。例如：

```
Get/2012-06-21T16%3A49%3A54-05%3A00 // does not work
Get?date=2005-11-13%205%3A30%3A00 // works 
```

有什么想法可以让它发挥作用吗？我尝试过使用自定义 MediaTypeFormatters，但即使我将它们添加到 HttpConfiguration 的 Formatters 列表中，它们似乎从未被执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T08:36:00.400

如果您想将其作为 URI 本身的一部分传递，您必须考虑在 Global.asax 中定义的默认路由。如果您没有更改它，它表明 URI 在 /Controller/action/id 中分解。

例如 uri 'Home/Index/hello' 在 HomeController 类中转换为 Index("hello)。

**因此，在这种情况下，如果您将 DateTime 参数的名称更改为“id”而不是“日期”，它应该可以工作。**

将参数的类型从“日期时间”更改为“日期时间？”也可能更安全。以防止错误。另外，mvc 模式中的所有控制器方法都应该返回一个 ActionResult 对象。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T08:42:46.833

让我们看看你的默认 MVC 路由代码：

```
routes.MapRoute(
            "Default",
            "{controller}/{action}/{id}",
            new {controller = "Home", action = "Index", **id** = UrlParameter.Optional}
            ); 
```

好的。看到名字ID了吗？您需要将方法参数命名为“id”，以便模型绑定器知道您要绑定到它。

用这个 -

```
public int Get(DateTime id)// Whatever id value I get try to serialize it to datetime type.
{ //If I couldn't specify a normalized NET datetime object, then set id param to null.
    // return count from a repository based on the date
} 
```

# java - Java Map，使用值属性过滤

> ID：11160382
> 
> 赞同：7
> 
> 时间：2012-06-22T16:30:39.953
> 
> 标签：java, map, filter

我有一个

```
TreeMap resMap new TreeMap<String, Map<String, String>>(); 
```

我想过滤并只保留值包含已知对的条目，比如说（'mike' => 'jordan'），并避免像下面这样的循环

在我包含的库 apache.commons 和 google.common 中是否有一个过滤方法（这可能也会做一个循环，但至少它不那么冗长

```
for (Entry<String, TreeMap<String, String>> el : resMap.entrySet()){
    if (el.getValue().get("mike").equals("jordan")){
        //
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-22T16:42:53.457

您可以使用 Guava 和`Predicate`界面中的过滤器。

```
Predicate<T> yourFilter = new Predicate<T>() {
    public boolean apply(T o) {
        // your filter
    }
}; 
```

所以，简单的例子是：

```
Predicate<Integer> evenFilter = new Predicate<Integer>() {
    public boolean apply(Integer i) {
        return (i % 2 == 0);
    }
};

Map<Integer, Integer> map = new HashMap<Integer, Integer>();

Map<Integer, Integer> evenMap = Maps.filterValues(map, evenFilter); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-22T17:03:06.277

与其强制您的客户端代码使用过滤器/循环，不如将您需要的内容构建到您的类的 API 中：

```
public class MyClass {

    private TreeMap resMap new TreeMap<String, Map<String, String>>();

    public void filter(String key, String value) {
        // Some impl here. Either your loop or the guava approach
    }
} 
```

顺便说一句，如果您使用循环，请考虑更改为：

```
for (Iterator<Map.Entry<String, TreeMap<String, String>>> i = resMap.entrySet().iterator(); i.hasNext();) {
    Map.Entry<String, TreeMap<String, String>> entry = i.next();
    if (value.equals(entry.getValue().get(key))) {
        i.remove();
    }
} 
```

循环的变化是：

*   更改了等于的顺序以避免 NPE
*   用于`iterator`允许直接删除条目

* * *

即使您没有类，您也可以轻松地将其包装在实用程序类的静态方法中，也可以轻松地将其参数化以使用任何嵌套映射：

```
public static <K1, K2, V> void filter(Map<K1, Map<K2, V>> map, K2 key, V value) {
    // Some impl here
} 
```

这是静态方法的非番石榴实现：

```
for (Iterator<Map.Entry<K1, Map<K2, V>>> i = map.entrySet().iterator(); i.hasNext();) {
    Map.Entry<K1, Map<K2, V>> entry = i.next();
    if (value.equals(entry.getValue().get(key))) {
        i.remove();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:35:12.963

看看[Guava](http://code.google.com/p/guava-libraries/)的[谓词](http://code.google.com/p/guava-libraries/wiki/FunctionalExplained#Predicates)和[函数](http://code.google.com/p/guava-libraries/wiki/FunctionalExplained#Functions)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T18:21:48.347

这里有两个例子。两者都根据值属性中的匹配打印键。

```
private static void printMatchingEntriesUsingALoop(Map<String, Map<String, String>> resMap, String key, String value) {
    for (Map.Entry<String, Map<String, String>> entry : resMap.entrySet())
        if (value.equals(entry.getValue().get(key)))
            System.out.println(entry.getKey());
}

private static void printMatchingEntriesUsingGuava(Map<String, Map<String, String>> resMap, final String key, final String value) {
    Predicate<Map<String, String>> keyValueMatch = 
    new Predicate<Map<String, String>>() {
        @Override
        public boolean apply(@Nullable Map<String, String> stringStringMap) {
            return value.equals(stringStringMap.get(key));
        }
    };

    Maps.EntryTransformer<String, Map<String, String>, Void> printKeys = 
    new Maps.EntryTransformer<String, Map<String, String>, Void>() {
        @Override
        public Void transformEntry(@Nullable String s, 
                 @Nullable Map<String, String> stringStringMap) {
            System.out.println(s);
            return null;
        }
    };

    Maps.transformEntries(Maps.filterValues(resMap, keyValueMatch), printKeys);
}

public static void main(String... args) {
    Map<String, Map<String, String>> resMap = new TreeMap<String, Map<String, String>>();
    printMatchingEntriesUsingALoop(resMap, "first", "mike");
    printMatchingEntriesUsingGuava(resMap, "first", "mike");
} 
```

一种使用循环，一种使用 Guava。

虽然第一个性能更好，但您应该真正决定哪个最容易理解和维护。

来自@missingfaktor 的一些建议。你必须使用自己的判断，但他很好地强调了一些问题。

1.  大量的代码重复。
2.  特殊情况处理。
3.  圈复杂度更高。
4.  由于前三个项目符号，更多的错误机会。
5.  很难遵循代码。

想象一下，您是一名必须支持该软件的新开发人员。你更愿意面对哪个？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-14T18:25:41.567

您可以使用 java 8 和流过滤地图。此过程的第一步是使用`entrySet().stream()`. 这给了你一个`Stream<Map.Entry<String, TreeMap<String, String>>`. 然后，您可以使用`filter(...)`过滤列表。过滤时，如果传入值应包含在过滤结果中，则应返回 true。过滤结果后，您可以使用 foreach 循环遍历最终结果。

最终结果将如下所示：

```
resMap.entrySet().stream()
      .filter(e -> el.getValue().get("mike").equals("jordan"))
      .foreach(e -> {
        // Do something with your entry here
      }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-06T19:28:09.387

[来自@Ferrybig 在这篇文章中的回答。](https://stackoverflow.com/a/35863686/3107798)

[`Collection.removeIf`](https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html#removeIf-java.util.function.Predicate-)为此，您可以使用 Java 8 方法：

```
map.values().removeIf(Object o -> o.get("mike").equals("jordan")); 
```

这删除了与谓词匹配的所有值。

`[Online demo](https://ideone.com/KoYZby)`

这是因为调用`.values()`HashMap 会返回一个集合，该集合将修改委托给 HashMap 本身，这意味着我们的调用`removeIf()`实际上会更改 HashMap（这不适用于所有 java Map）

# dynamics-crm - Grab System Created Values CRM 2011

> ID：11160383
> 
> 赞同：0
> 
> 时间：2012-06-22T16:30:51.683
> 
> 标签：dynamics-crm, dynamics-crm-2011, crm, dynamics-crm-4

I'm facing a problem when I try to grab the Extended Amount Attribute inside the Opportunity Product Line Entity. As follows my requirements are that upon creation of a an Opportunity Product Line I have a post-create plugin on it which applies a discount onto the extended amount and creates another line, with the new discounted extended amount. When I try to output the value on another field just to check what it gets, I keep getting 0 strangley. My code is as follows:

```
// Part where I grab the value  
Entity entity = (Entity)context.InputParameters["Target"];
Money extenedAmount = (Money)entity["baseamount"];

//Create new line
Entity oppportunity_product = new Entity("opportunityproduct");
oppportunity_product["manualdiscountamount"] = extenedAmount;

service.Create(oppportunity_product); 
```

Is it even possible to grab the amount? Would really much appreciate if someone could help me out here. Thanks in advanace.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:48:29.907

创建后，您要添加一个帖子图像。然后引用帖子图像而不是目标。

```
if (context.PostEntityImages.Contains("PostImage") &&
    context.PostEntityImages["PostImage"] is Entity)
{
    postMessageImage = (Entity)context.PostEntityImages["PostImage"];
}
else
{
    throw new Exception("No Post Image Entity in Plugin Context for Message");
} 
```

# android - createBitmap error in Froyo but not on ICS

> ID：11160387
> 
> 赞同：0
> 
> 时间：2012-06-22T16:30:59.583
> 
> 标签：android, bitmap, nullpointerexception

My code runs without any errors on ICS but in Froyo it gives me a runtime `NullPointerException` on the `Bitmap.createBitmap()` call (line 7 in code below.) What can be causing it?

```
BitmapDrawable bd = (BitmapDrawable) getResources().getDrawable(R.drawable.title_bg_tile);
int width = view.getWidth();
int intrinsicHeight = bd.getIntrinsicHeight();
Rect bounds = new Rect(0,0,width,intrinsicHeight);
bd.setTileModeX(TileMode.REPEAT);
bd.setBounds(bounds);

Bitmap bitmap=Bitmap.createBitmap(bounds.width(),bounds.height(),bd.getBitmap().getConfig()); //<----Error on this line

Canvas canvas = new Canvas(bitmap);
bd.draw(canvas); 
```

EDIT: My Logcat during crash on Froyo:

```
06-23 10:50:14.900: E/AndroidRuntime(276): FATAL EXCEPTION: main
06-23 10:50:14.900: E/AndroidRuntime(276): java.lang.NullPointerException
06-23 10:50:14.900: E/AndroidRuntime(276):  at android.graphics.Bitmap.createBitmap(Bitmap.java:468)
06-23 10:50:14.900: E/AndroidRuntime(276):  at com.tab.fragment.TabsViewPagerFragmentActivity$1.onGlobalLayout(TabsViewPagerFragmentActivity.java:95)
06-23 10:50:14.900: E/AndroidRuntime(276):  at android.view.ViewTreeObserver.dispatchOnGlobalLayout(ViewTreeObserver.java:549)
06-23 10:50:14.900: E/AndroidRuntime(276):  at android.view.ViewRoot.performTraversals(ViewRoot.java:1094)
06-23 10:50:14.900: E/AndroidRuntime(276):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1727)
06-23 10:50:14.900: E/AndroidRuntime(276):  at android.os.Handler.dispatchMessage(Handler.java:99)
06-23 10:50:14.900: E/AndroidRuntime(276):  at android.os.Looper.loop(Looper.java:123)
06-23 10:50:14.900: E/AndroidRuntime(276):  at android.app.ActivityThread.main(ActivityThread.java:4627)
06-23 10:50:14.900: E/AndroidRuntime(276):  at java.lang.reflect.Method.invokeNative(Native Method)
06-23 10:50:14.900: E/AndroidRuntime(276):  at java.lang.reflect.Method.invoke(Method.java:521)
06-23 10:50:14.900: E/AndroidRuntime(276):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
06-23 10:50:14.900: E/AndroidRuntime(276):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
06-23 10:50:14.900: E/AndroidRuntime(276):  at dalvik.system.NativeStart.main(Native Method) 
```

# php - 在 php 中创建一个循环以在查询中工作

> ID：11160390
> 
> 赞同：1
> 
> 时间：2012-06-22T16:31:06.630
> 
> 标签：php, mysql

我正在构建这个小功能，

我需要的是这个查询来打印我的值。这意味着，我有一个名为 $checked1 的数组，我需要在查询中打印每个数组。

到目前为止，我的代码是：

```
$result = mysql_query("SELECT $checked FROM hostess");

while($row = mysql_fetch_array($result))
  {foreach( $checked1 as $key => $value){

      echo "<td>" . $row['$value'] . "</td>";

} 
```

但它不起作用。

你能告诉我有什么问题吗？

谢谢..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T16:33:25.110

```
echo "<td>" . $row['$value'] . "</td>"; 
```

应该

```
echo "<td>" . $row[$value] . "</td>"; 
```

# textmate - Textmate Hide/Show Comments

> ID：11160392
> 
> 赞同：0
> 
> 时间：2012-06-22T16:31:16.847
> 
> 标签：textmate

Is there any way with TextMate to hide comments when editing code? Sometimes I want to see my code with the full comments and other times just want to see the code itself with all comments hidden. I was hoping there would be a way to toggle the display of comments, but haven't been able to find anything about this.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T06:15:35.653

这是您需要逐个语言编辑的东西，但它非常可行。在`Bundles -> Bundle Editor -> Edit Languages`您的内部会发现 TextMate 用来突出显示特定语法的语言定义。在语法定义中，您会发现`foldingStartMarker`和`foldingStopMarker`。

您可以向那些添加注释语法以允许折叠注释本身。单行注释可能非常棘手，但多行注释，具有清晰和独特的开始和停止语法，应该可以正常工作。

例如，对于 PHP，我们将要添加`\/\*`到开始语法和`\*\/`结束语法。您需要重新加载捆绑包才能使这些更改生效（或重新启动 TM）。

# c# - Can somebody explain this C# constructor syntax - public Class1(Class 2 Obj) : this(obj.ToString())?

> ID：11160394
> 
> 赞同：2
> 
> 时间：2012-06-22T16:31:22.923
> 
> 标签：c#, methods, constructor, this

Here is the code:

```
class Class1
{    
    private Class2 object;

    public Class1(Class2 obj) : this(obj.ToString())
    {
        this.object = obj;
    }
} 
```

More specifically, what does the `: this` part do.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T16:32:58.827

这`:this(obj.ToString)`会导致使用字符串参数定义的构造函数的构造函数代码首先运行。一旦它运行，就会执行构造函数代码（设置`this.object = obj`）。

这在[MSDN 的构造函数页面](http://msdn.microsoft.com/en-us/library/ms173115.aspx)（最后一个示例集）中有所介绍。

请注意，在您上面的代码中，如所写，这将导致*编译器错误。* 您还需要有如下构造函数：

```
public Class1(string str) // Constructor taking a string, though it could be non-public
{
    // Do something with str
} 
```

有了这个构造函数，它将被调用，执行它的初始化步骤，然后第一个构造函数（设置`this.object`）将运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:32:45.867

`: this(obj.ToString())` calls overloaded version of constructor from same class.

It means that somewhere in this class you have another constructor which takes `string` as parameter and will be executed alongside current constructor.

```
class A
{
    public A(Class2 obj): this(obj.ToString()) // execute A(string text)
    {
        // your code
    }

    public A(string text)
    {
       // your code
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:32:54.257

类 1 将有另一个接受字符串参数的构造函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T16:32:57.010

它调用与该语法匹配的构造函数。在您的情况下，我假设有一个构造函数在某处接受字符串参数：

```
public Class1(string s)
{ 
} 
```

# objective-c - How to refer to other buttons in my xib file?

> ID：11160397
> 
> 赞同：0
> 
> 时间：2012-06-22T16:31:30.773
> 
> 标签：objective-c, xcode, button

I want a button action that will change the button title but also will change other buttons title, I don't know how to refer those buttons (I have 9 (3X3) buttons).

Is there anyway i can refer those by their tags?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:42:12.313

您可以[为这些按钮创建一个出口](https://stackoverflow.com/questions/9779069/how-do-i-add-an-action-or-outlet-to-a-class-in-xcode-4-3-1)，或者通过它们的标签值获取它们：

```
UIButton *myButton = (UIButton *)[self.view viewWithTag:TAG_VALUE];
[myButton setTitle:@"New Title" forState:UIControlStateNormal]; 
```

首选的 iOS 方式是使用 outlet，但您也可以使用您正在抓取的视图的标签值。

# php - need to increment a group of results only using multiple loop statements

> ID：11160398
> 
> 赞同：0
> 
> 时间：2012-06-22T16:31:35.390
> 
> 标签：php

I have the following php code:

```
 $k=1;
    for($i=0; $i < 5; $i++)
    {
        $stmt = $db->query('SELECT * FROM services_main');
        while($row = $stmt->fetch(PDO::FETCH_ASSOC)) {

            if ($row['ID'] == $i) {

                for($j=1; $j <= 3; $j++)
                {
                    echo $row['name'].' - k='.$k++.'<br />';
                }

            }
        }
    } 
```

This code generates this:

```
 John - k=1
    John - k=2
    John - k=3
    Paul - k=4
    Paul - k=5
    Paul - k=6
    George - k=7
    George - k=8
    George - k=9 
```

What i am trying to do it have it generate this:

```
 John - k=1
    John - k=1
    John - k=1
    Paul - k=2
    Paul - k=2
    Paul - k=2
    George - k=3
    George - k=3
    George - k=3 
```

I can't figure out how to make k increment for each grouping as opposed to incrementing on every single line.

Thanks in advance for your help!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:34:08.960

替换这个：

```
for($j=1; $j <= 3; $j++)
            {
                echo $row['name'].' - k='.$k++.'<br />';
            } 
```

有了这个

```
for($j=1; $j <= 3; $j++)
            {
                echo $row['name'].' - k='.$k.'<br />';
            }
$k++; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:33:40.613

把`k++`外面的`while`循环。

```
$k=1;
for($i=0; $i < 5; $i++)
{
    $stmt = $db->query('SELECT * FROM services_main');
    while($row = $stmt->fetch(PDO::FETCH_ASSOC)) {

        if ($row['ID'] == $i) {

            for($j=1; $j <= 3; $j++)
            {
                echo $row['name'].' - k='.$k.'<br />';
            }

        }
    }
    $k++;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:33:52.573

不要在每次通过内部“for”循环时递增 $k，而是在每次“while”循环迭代时递增一次：

```
for($j=1; $j <= 3; $j++)
{
    echo $row['name'].' - k='.$k.'<br />';
}
$k++; 
```

# heroku - Heroku 上的 MongoHQ “数据库断言失败”

> ID：11160406
> 
> 赞同：1
> 
> 时间：2012-06-22T16:32:00.680
> 
> 标签：heroku, mongoose, mongohq

我正在尝试将我的 Node 应用程序以及所有模块从 0.4 升级到 0.6。我想我的一切都是正确的，但是 MongoHQ 返回：

```
db assertion failure 
```

在每个 find/distinct 调用（连接没有错误）

这是我的 package.json，我已将所有模块固定为一个特定版本，因为我最初在 local 和 Heroku 之间存在一些差异。现在唯一的区别是我在本地运行 Node 0.6.19 而 Heroku 运行 0.6.18：

```
{ "name": "expensesspreadsheet"
, "version": "0.0.1"
, "engines":
  { "node" : "0.6.18"
  , "npm"  : "1.1.9"
  } 
, "main": "server.js"
, "dependencies":
  { "ejs":             "0.7.1"
  , "ejs-ext":         "0.1.1"
  , "express":         "2.5.10"
  , "railway":         "0.2.17-pre3"
  , "jugglingdb":      "0.1.10"
  , "yaml":            "0.2.3"
  , "coffee-script":   "1.3.3"
  , "mime":            "1.2.5"
  , "qs":              "0.5.0"
  , "mongoose":        "2.7.0"
  , "mongodb":         "1.0.2"
  , "connect-mongodb": "1.1.4"
  , "connect-auth":    "0.5.2"
  , "moment" :         "1.6.2"
  , "connect-heroku-redis" : "0.1.5"
  , "node-markdown" :  "0.1.0"
  , "recaptcha" :      "1.1.0"
  , "sendgrid":        "0.2.1"
  }
, "scripts":
  { "test": "nodeunit test/*/*"
  }
} 
```

我正在使用 Mongoose 来定义模式。连接到 MongoHQ 工作正常（回调中没有错误）。如果您想查看该代码，请告诉我，但它非常标准，几乎直接来自 Mongoose 站点。

但是，如上所述，每当我尝试实际查找任何数据时，都会收到这个难以描述的错误。

我已经手动连接到数据库并执行了查询：工作正常。我已将本地环境连接到我的 mongohq：​​工作正常。

所有这些仍然可以在节点 0.4 上使用 mongoose 2.3.13 和 mongodb 驱动程序 0.9.6-7

所以我的问题：

*   有谁知道如何调试这个“db assertion failure”错误？
*   任何其他想法可能有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T10:00:14.723

在使用 MongoHQ 支持对此进行调查后，结果证明这是一个身份验证问题。

Heroku 提供的 MongoHQ URL 与 MongoHQ 上的密码不同步。

在旧版本的应用程序中，我使用的是手动构建的 URL，这解释了为什么该 URL 有效。

我们是怎么想出来的？通过查看 MongoDB 日志，这些日志包含明显的身份验证错误。遗憾的是，返回的 JSON 仅包含通用的“数据库断言失败”消息，没有其他详细信息。

# java - Cannot delete or update a parent row: a foreign key constraint fails and Entity hierarchy mustn't change

> ID：11160409
> 
> 赞同：2
> 
> 时间：2012-06-22T16:32:16.043
> 
> 标签：java, spring, hibernate, jpa

This is a tough one. I know there is plenty of questions like that here, but my problem is, that I'm not allowed to change/edit the class heirarchy, because this is an already productive application, which if changed fundamentally, must be tested thoroughly and this will cost to much. Even if there's something stupid in the hierarchy, I'm not allowed to change it, because the whole application might stop functioning, and it will take long hours to bring it back on. (Nasty, I know). So, basically, what I am looking for here is some kind of workaround, that will give me a chance to delete entity instances without constraint violation and changing the hierarchy.

On top of the hieararchy is an entity "Request", that splits further in "Import Request" and "Export Request". So ImportRequest extends Request and ExportRequest extends Request. Every ExportRequest has a Set of Position, which is defined like that:

```
@OneToMany(fetch = FetchType.LAZY, cascade = CascadeType.ALL)
@JoinColumn(name = "antrag_id")
@ForeignKey(name= "FK_EXPAN_POS")
public Set<Position> getPosition() {
    try {
        position.size();
    } catch (Exception e) {
        // NO Need just make hibernate load the list
    }

    return position;
} 
```

Position is just another Entity. And every ImportRequest has a Set of ImportPosition, like that:

```
@OneToMany(fetch = FetchType.LAZY, cascade = CascadeType.ALL)
@JoinColumn(name = "antrag_id")
@ForeignKey(name= "FK_IMPAN_POS")
public Set<ImportPosition> getImportPosition() {

    try {
        importPosition.size();
    }
    catch (Exception e)
    {
        // hallo 
    }
    return importPosition;
} 
```

whereas ImportPosition extends Position.

Every Position has only one Probe assigned to it, which is defined like that:

```
@OneToOne(cascade = CascadeType.ALL)
@JoinColumn(name = "probe")
@ForeignKey(name = "FK_POS_PROB")
public Probe getProbe() {
    return probe;
} 
```

Implicitly evert ImportPosition will have one too, because it extends the Position. Which also works on a database level.

I'm deleting an IMportRequets with a method like this:

```
@Transactional
public void cleanArchivedRequests() {
    List<Integer> archivedRequestList = requestDao.retrieveAllArchivedRequests();
    for (Integer antragId : archivedRequestList) {
        Request requestToDelete = requestDao.loadById(requestId);
        requestDao.delete(requestToDelete);

        StringBuffer protocolEntry = new StringBuffer("Request mit der ID: ");
        protocolEntry.append(requestId);
        protocolEntry.append(" gelöscht!");
        protocol(protocolEntry.toString());
    }
} 
```

Apparently Hibernate has problems deleting the Probe which is referenced by an ImportPosition in an ImportRequet, because I get this:

```
 [java] java.sql.BatchUpdateException: Cannot delete or update a parent row: a foreign key constraint fails (`position`, CONSTRAINT `FK_POS_PROB` FOREIGN KEY (`probe`) REFERENCES `probe` (`id`)) 
```

requestDao is injected via Spring with applicationContext-daos.xml in my class, where the method "cleanArchivedRequests" is.

So my question is, given that hierarchy, is it possible at all to successfully delete the Probe instances from the ImportPosition and if so, how would that work. I've already tried to delete the Probe instances first and than the ImportRequest, but that didn't work, supposedly because the whole thing happens in one transaction. Or at least this is my explanation.

PS. The whole Stacktrace goes like this:

```
 [java] java.sql.BatchUpdateException: Cannot delete or update a parent row: a foreign key constraint fails (`position`, CONSTRAINT `FK_POS_PROB` FOREIGN KEY (`probe`) REFERENCES `probe` (`id`))
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:1257)
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:943)
 [java]     at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeBatch(NewProxyPreparedStatement.java:1723)
 [java]     at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:70)
 [java]     at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:268)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:114)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:109)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareBatchStatement(AbstractBatcher.java:244)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2507)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2725)
 [java]     at org.hibernate.action.EntityDeleteAction.execute(EntityDeleteAction.java:97)
 [java]     at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:172)
 [java]     at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
 [java]     at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)
 [java]     at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)
 [java]     at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:365)
 [java]     at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)
 [java]     at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:655)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:732)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:701)
 [java]     at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:321)
 [java]     at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:116)
 [java]     at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
 [java]     at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
 [java]     at $Proxy33.cleanArchivedRequests(Unknown Source)
 [java]     at de.fast.hama.util.HamaRequestArchiver.main(HamaRequestArchiver.java:66)
 [java] 2012-06-22 17:56:07,925 [DEBUG] - com.mchange.v2.sql.SqlUtils.toSQLException:85 - Attempted to convert SQLException to SQLException. Leaving it alone. [SQLState: 23000; errorCode: 1451]
 [java] java.sql.BatchUpdateException: Cannot delete or update a parent row: a foreign key constraint fails (`position`, CONSTRAINT `FK_POS_PROB` FOREIGN KEY (`probe`) REFERENCES `probe` (`id`))
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:1257)
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:943)
 [java]     at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeBatch(NewProxyPreparedStatement.java:1723)
 [java]     at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:70)
 [java]     at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:268)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:114)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:109)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareBatchStatement(AbstractBatcher.java:244)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2507)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2725)
 [java]     at org.hibernate.action.EntityDeleteAction.execute(EntityDeleteAction.java:97)
 [java]     at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:172)
 [java]     at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
 [java]     at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)
 [java]     at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)
 [java]     at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:365)
 [java]     at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)
 [java]     at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:655)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:732)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:701)
 [java]     at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:321)
 [java]     at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:116)
 [java]     at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
 [java]     at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
 [java]     at $Proxy33.cleanArchivedRequests(Unknown Source)
 [java]     at de.fast.hama.util.HamaRequestArchiver.main(HamaRequestArchiver.java:66)
 [java] 2012-06-22 17:56:07,925 [DEBUG] - com.mchange.v2.c3p0.impl.DefaultConnectionTester.statusOnException:126 - Testing a Connection in response to an Exception:
 [java] java.sql.BatchUpdateException: Cannot delete or update a parent row: a foreign key constraint fails (`position`, CONSTRAINT `FK_POS_PROB` FOREIGN KEY (`probe`) REFERENCES `probe` (`id`))
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:1257)
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:943)
 [java]     at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeBatch(NewProxyPreparedStatement.java:1723)
 [java]     at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:70)
 [java]     at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:268)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:114)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:109)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareBatchStatement(AbstractBatcher.java:244)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2507)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2725)
 [java]     at org.hibernate.action.EntityDeleteAction.execute(EntityDeleteAction.java:97)
 [java]     at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:172)
 [java]     at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
 [java]     at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)
 [java]     at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)
 [java]     at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:365)
 [java]     at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)
 [java]     at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:655)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:732)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:701)
 [java]     at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:321)
 [java]     at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:116)
 [java]     at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
 [java]     at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
 [java]     at $Proxy33.cleanArchivedRequests(Unknown Source)
 [java]     at de.fast.hama.util.HamaRequestArchiver.main(HamaRequestArchiver.java:66)
 [java] 22.06.2012 17:56:07 org.hibernate.util.JDBCExceptionReporter logExceptions
 [java] WARNUNG: SQL Error: 1451, SQLState: 23000
 [java] 22.06.2012 17:56:07 org.hibernate.util.JDBCExceptionReporter logExceptions
 [java] SCHWERWIEGEND: Cannot delete or update a parent row: a foreign key constraint fails (`position`, CONSTRAINT `FK_POS_PROB` FOREIGN KEY (`probe`) REFERENCES `probe` (`id`))
 [java] 22.06.2012 17:56:07 org.hibernate.event.def.AbstractFlushingEventListener performExecutions
 [java] SCHWERWIEGEND: Could not synchronize database state with session
 [java] org.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update
 [java]     at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:94)
 [java]     at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
 [java]     at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:275)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:114)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:109)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareBatchStatement(AbstractBatcher.java:244)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2507)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2725)
 [java]     at org.hibernate.action.EntityDeleteAction.execute(EntityDeleteAction.java:97)
 [java]     at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:172)
 [java]     at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
 [java]     at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)
 [java]     at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)
 [java]     at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:365)
 [java]     at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)
 [java]     at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:655)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:732)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:701)
 [java]     at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:321)
 [java]     at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:116)
 [java]     at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
 [java]     at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
 [java]     at $Proxy33.cleanArchivedRequests(Unknown Source)
 [java]     at de.fast.hama.util.HamaRequestArchiver.main(HamaRequestArchiver.java:66)
 [java] Caused by: java.sql.BatchUpdateException: Cannot delete or update a parent row: a foreign key constraint fails (`position`, CONSTRAINT `FK_POS_PROB` FOREIGN KEY (`probe`) REFERENCES `probe` (`id`))
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:1257)
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:943)
 [java]     at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeBatch(NewProxyPreparedStatement.java:1723)
 [java]     at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:70)
 [java]     at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:268)
 [java]     ... 23 more
 [java] 2012-06-22 17:56:07,941 [DEBUG] - org.springframework.orm.hibernate3.HibernateTransactionManager.doRollbackOnCommitException:871 - Initiating transaction rollback after commit exception
 [java] org.springframework.dao.DataIntegrityViolationException: Could not execute JDBC batch update; nested exception is org.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update
 [java]     at org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:636)
 [java]     at org.springframework.orm.hibernate3.HibernateTransactionManager.convertHibernateAccessException(HibernateTransactionManager.java:789)
 [java]     at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:663)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:732)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:701)
 [java]     at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:321)
 [java]     at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:116)
 [java]     at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
 [java]     at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
 [java]     at $Proxy33.cleanArchivedRequests(Unknown Source)
 [java]     at de.fast.hama.util.HamaRequestArchiver.main(HamaRequestArchiver.java:66)
 [java] Caused by: org.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update
 [java]     at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:94)
 [java]     at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
 [java]     at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:275)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:114)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:109)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareBatchStatement(AbstractBatcher.java:244)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2507)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2725)
 [java]     at org.hibernate.action.EntityDeleteAction.execute(EntityDeleteAction.java:97)
 [java]     at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:172)
 [java]     at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
 [java]     at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)
 [java]     at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)
 [java]     at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:365)
 [java]     at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)
 [java]     at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:655)
 [java]     ... 8 more
 [java] Caused by: java.sql.BatchUpdateException: Cannot delete or update a parent row: a foreign key constraint fails (`position`, CONSTRAINT `FK_POS_PROB` FOREIGN KEY (`probe`) REFERENCES `probe` (`id`))
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:1257)
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:943)
 [java]     at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeBatch(NewProxyPreparedStatement.java:1723)
 [java]     at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:70)
 [java]     at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:268)
 [java]     ... 23 more
 [java] 2012-06-22 17:56:07,941 [DEBUG] - org.springframework.orm.hibernate3.HibernateTransactionManager.doRollback:670 - Rolling back Hibernate transaction on Session [org.hibernate.impl.SessionImpl@1c10834]
 [java] 2012-06-22 17:56:07,956 [DEBUG] - org.springframework.orm.hibernate3.HibernateTransactionManager.doCleanupAfterCompletion:730 - Closing Hibernate Session [org.hibernate.impl.SessionImpl@1c10834] after transaction
 [java] 2012-06-22 17:56:07,956 [DEBUG] - org.springframework.orm.hibernate3.SessionFactoryUtils.closeSession:789 - Closing Hibernate Session
 [java] 2012-06-22 17:56:07,956 [DEBUG] - com.mchange.v2.resourcepool.BasicResourcePool.trace:1644 - trace com.mchange.v2.resourcepool.BasicResourcePool@1a37fac [managed: 10, unused: 9, excluded: 0] (e.g. com.mchange.v2.c3p0.impl.NewPooledConnection@f1b25e)
 [java] Exception in thread "main" org.springframework.dao.DataIntegrityViolationException: Could not execute JDBC batch update; nested exception is org.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update
 [java]     at org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:636)
 [java]     at org.springframework.orm.hibernate3.HibernateTransactionManager.convertHibernateAccessException(HibernateTransactionManager.java:789)
 [java]     at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:663)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:732)
 [java]     at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:701)
 [java]     at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:321)
 [java]     at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:116)
 [java]     at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
 [java]     at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
 [java]     at $Proxy33.cleanArchivedRequests(Unknown Source)
 [java]     at de.fast.hama.util.HamaRequestArchiver.main(HamaRequestArchiver.java:66)
 [java] Caused by: org.hibernate.exception.ConstraintViolationException: Could not execute JDBC batch update
 [java]     at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:94)
 [java]     at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
 [java]     at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:275)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:114)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareStatement(AbstractBatcher.java:109)
 [java]     at org.hibernate.jdbc.AbstractBatcher.prepareBatchStatement(AbstractBatcher.java:244)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2507)
 [java]     at org.hibernate.persister.entity.AbstractEntityPersister.delete(AbstractEntityPersister.java:2725)
 [java]     at org.hibernate.action.EntityDeleteAction.execute(EntityDeleteAction.java:97)
 [java]     at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)
 [java]     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:172)
 [java]     at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
 [java]     at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)
 [java]     at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)
 [java]     at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:365)
 [java]     at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)
 [java]     at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:655)
 [java]     ... 8 more
 [java] Caused by: java.sql.BatchUpdateException: Cannot delete or update a parent row: a foreign key constraint fails (`position`, CONSTRAINT `FK_POS_PROB` FOREIGN KEY (`probe`) REFERENCES `probe` (`id`))
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatchSerially(PreparedStatement.java:1257)
 [java]     at com.mysql.jdbc.PreparedStatement.executeBatch(PreparedStatement.java:943)
 [java]     at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeBatch(NewProxyPreparedStatement.java:1723)
 [java]     at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:70)
 [java]     at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:268)
 [java]     ... 23 more
 [java] Java Result: 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T20:06:15.737

这里的问题似乎不是 Hibernate 继承......您正在尝试从 Probe 表中删除通过 Position 表（及其类层次结构）中的外键引用的行。

我假设您使用的是`@ForeignKey`使用从 Hibernate 对象生成的脚本来生成数据库 DDL 脚本的注释。默认情况下，这些约束不指定引用删除的任何行为，因此您会看到错误。您可以修改约束以指定 @OnDelete 行为，或者为您删除的每个 Probe 对象显式设置外键引用为 null。

# regex - Trying to extract information in a regular expression

> ID：11160410
> 
> 赞同：0
> 
> 时间：2012-06-22T16:32:25.817
> 
> 标签：regex, data-extraction

I'm trying to write a regular expression that will allow me to extract the data in between the quotation marks, and then allow me to replace it with new information.

> title="Information here"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:34:47.430

```
(title=")([^"]*)(".*) 
```

.* 将匹配任何字符

然后替换为

```
\1This is the new information\3

\2 
```

将保存提取的值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T18:12:25.723

您需要使用具有正则表达式替换功能的语言或工具。此正则表达式应与您尝试执行的操作相匹配：

```
^title="(.*)"$ 
```

正则表达式替换示例：

```
preg_replace('^title=[\]?"(.*)[\]?"$','new information','title="information here"'); 
```

将“此处的信息”替换为“新信息”

# android - Why use Fragment#setRetainInstance(boolean)?

> ID：11160412
> 
> 赞同：71
> 
> 时间：2012-06-22T16:32:35.907
> 
> 标签：android, android-fragments, android-lifecycle

I find Fragment#setRetainInstance(true) confusing. Here is the Javadoc, extracted from the [Android Developer API](http://developer.android.com/reference/android/app/Fragment.html#setRetainInstance%28boolean%29):

> public void **setRetainInstance** (boolean retain)
> 
> Control whether a fragment instance is retained across Activity re-creation (such as from a configuration change). This can only be used with fragments not in the back stack. If set, the fragment lifecycle will be slightly different when an activity is recreated:
> 
> *   onDestroy() will not be called (but onDetach() still will be, because the fragment is being detached from its current activity).
> *   onCreate(Bundle) will not be called since the fragment is not being re-created.
> *   onAttach(Activity) and onActivityCreated(Bundle) **will** still be called.

**Question: How do you as a developer use this, and why does it make things easier?**

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-06-22T16:38:50.443

> 作为开发人员，您如何使用它

打电话`setRetainInstance(true)`。我通常在我使用它的`onCreateView()`或中执行此操作。`onActivityCreated()`

> 为什么它让事情变得更容易？

它往往比`onRetainNonConfigurationInstance()`处理跨配置更改的数据保留更简单（例如，将设备从纵向旋转到横向）。未保留的片段在配置更改时被销毁并重新创建；保留的片段不是。因此，那些保留的片段所持有的任何数据都可用于配置更改后的活动。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2012-06-22T16:39:36.380

这对于保持长时间运行的资源（例如套接字）打开非常有帮助。拥有一个包含对蓝牙套接字的引用的无 UI 片段，当用户翻转手机时，您不必担心重新连接它们。

它还可以方便地保留对需要很长时间才能加载的资源的引用，例如位图或服务器数据。加载一次，将其保存在保留的片段中，当活动重新加载时，它仍然存在，您不必重建它。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2013-09-08T08:23:36.430

很晚才添加这个答案，但我认为它会让事情变得更清楚。跟我说。什么时候`setRetainInstance`：

**错误的**

*   片段在配置更改时重新创建。新实例已创建。
*   所有生命周期方法都会在配置更改时调用，包括`onCreate()`和`onDestroy()`。

**真的**

*   配置更改时不会重新创建片段。使用相同的实例。
*   所有生命周期方法都在配置更改、APART FROM`onCreate()`和`onDestroy()`.
*   添加到后台堆栈时，保留实例将不起作用。

不要忘记，上面的内容适用于`DialogFragment`s 和 Fragments。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-03-12T06:05:06.217

## 不推荐使用 setRetainInstance(boolean) 方法，请改用 ViewModels。

Fragments 上的`setRetainInstance(boolean)`方法在 Fragment API的[1.3.0](https://developer.android.com/jetpack/androidx/releases/fragment#1.3.0-alpha01)版本中已被[弃用。](https://android-review.googlesource.com/c/platform/frameworks/support/+/1159084/)

随着[ViewModels](https://developer.android.com/topic/libraries/architecture/viewmodel)的引入，开发人员有一个特定的 API 用于保留可以与活动、片段和导航图相关联的状态。这允许开发人员使用正常的、未保留的 Fragment 并将他们想要保留的特定状态分开。

这确保了开发人员对这些 Fragment 有一个更易于理解的生命周期（匹配所有其余 Fragment 的生命周期），同时保持单次创建和单次销毁的有用属性（在这种情况下`ViewModel`，）`onCleared()`。`ViewModel`

# jquery - 在 jQuery 中过滤具有多个记录 ID 的分层 JSON 数据

> ID：11160419
> 
> 赞同：2
> 
> 时间：2012-06-22T16:32:56.537
> 
> 标签：jquery, regex, json, filter, match

参考以下链接：

[https://stackoverflow.com/posts/4391119/revisions](https://stackoverflow.com/posts/4391119/revisions)

[在 jQuery 中过滤具有多个记录 ID 的 JSON 数据](https://stackoverflow.com/questions/10870334/filter-json-data-with-multiple-record-ids-in-jquery)

如果 JSON 中有分层数据怎么办.. 我尝试在该 filterStore 函数中进行修改.. 但没有成功。你能帮我吗？

当前的 filterStore 是这样的：

```
var filter = {
    "brand_id": [1,2,3],
    "productname": new RegExp('(.*?)', 'gi'),
    "price": new RegExp('.*?', 'gi')
};

function filterStore(dataStore, filter) {
    return $(dataStore).filter(function(index, item) {
        for( var i in filter ) {
            if(filter[i] instanceof Array){   
              if($.inArray(parseInt(item[i],10),filter[i]) == -1)
                 return null;
              else
                 continue;                  
            }
           if( ! item[i].toString().match( filter[i] ) ) return null;
        }
        return item;
    });
} 
```

但是json响应是这样的：

```
[
    {
      "brandInfo": {
          "brand": "Lg",
          "productname": "Microwave",
      },
      "prodInfo": {
          "size": "1.5 ltr",
          "price": 200,
          "color": "black"
      },
      "Category": "Electronic",
      "shop": "Walmart"
    }
    {
      "brandInfo": {
          "brand": "Samsung",
          "productname": "Microwave",
      },
      "prodInfo": {
          "size": "1.5 ltr",
          "price": 250,
          "color": "Ivory"
      },
      "Category": "Electronic",
      "shop": "Walmart"
    }
    {
      "brandInfo": {
          "brand": "Toshiba",
          "productname": "Microwave",
      },
      "prodInfo": {
          "size": "1.6 ltr",
          "price": 310,
          "color": "Silver"
      },
      "Category": "Electronic",
      "shop": "Walmart"
    }
    {
      "brandInfo": {
          "brand": "Hitachi",
          "productname": "Microwave",
      },
      "prodInfo": {
          "size": "1.5 ltr",
          "price": 280,
          "color": "black"
      },
      "Category": "Electronic",
      "shop": "Walmart"
    }
] 
```

乔伊，你能帮我为这样的分层数据设置过滤器吗？新功能 filterStore?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:24:51.647

首先重写过滤器以反映嵌套结构。

```
var filter = {
    "brandInfo": {
        "brand_id": [1,2,3]
    },
    "prodInfo": {
        "productname": new RegExp('(.*?)', 'gi'),
        "price": new RegExp('.*?', 'gi')
    }
}; 
```

现在您可以像这样编写过滤器代码（只需添加一个嵌套循环来循环遍历诸如*brandInfo*之类的外部属性）。

```
function filterStore(dataStore, filter) {
    return $(dataStore).filter(function(index, item) {
        for( var prop in filter ) {
            if (item[prop] == null) return null;
            for( var i in prop ) {
                if (item[prop][i] == null) return null;
                if(filter[prop][i] instanceof Array){  
                    if($.inArray(parseInt(item[prop][i],10),filter[prop][i]) == -1) return null;
                    else continue; 
                }
                if( ! item[prop][i].toString().match( filter[prop][i] ) ) return null;
            }
        }
        return item;
    });
} 
```

就您示例中的数据结构而言，这应该有效。但请记住，此代码假定您的过滤器仅包含二级嵌套属性。对于过滤嵌套属性的更通用的解决方案，您需要将过滤器逻辑放在单独的函数中并递归使用它。

# backbone.js - 如何使用 Backbone Marionette 渲染视图

> ID：11160421
> 
> 赞同：0
> 
> 时间：2012-06-22T16:32:58.797
> 
> 标签：backbone.js, marionette

我正在使用 Backbone.Marionette，需要呈现员工及其各自部门的视图。我希望它看起来像这样：

```
 Department 1
***

Employee1

Employee2

Employee3

Department 2
***
Employee4

Employee5

Employee6

Employee7

Employee8

Department 3
***
Employee9

Employee10 
```

我的收藏看起来像这样：

```
 Employee1 / Department1

Employee2 / Department1

Employee3 / Department1

Employee4 / Department2

Employee5 / Department2

etc. 
```

作为`department`我需要渲染`department`标题的更改。

我将使用哪种视图类型组合。`Collection view`, `Composite view`. 我需要将逻辑放在视图/模板中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T18:27:08.587

最终结果可以很容易地分解，以确定要使用的视图类型。

您有一组要渲染的部门。A`CollectionView`会处理这个问题，允许每个部门自己呈现。

部门本身就有复杂的需求。它需要显示标题（部门名称）和一些详细信息 - 员工列表。这听起来像一个带有包装模板的集合视图......一个复合视图。

然后，每个部门的复合视图都需要呈现员工列表。员工信息看起来相当简单，所以一个 ItemView 就足够了。

最终结果将是：

```
 CollectionView
  - CompositeView (department)
    - ItemView (employee) 
```

...当然，您的实际数据结构不适用于此布局，因为您将关系反转，员工知道它属于哪个部门。您要么需要反转数据/关系，以便部门知道他们在服务器上拥有哪些员工/返回的 JSON，要么进行一些客户端过滤和分组以获得该结果。

# ruby - Ruby - 使用 3 个参数进行初始化的重载解决方案

> ID：11160423
> 
> 赞同：0
> 
> 时间：2012-06-22T16:33:00.550
> 
> 标签：ruby, constructor-overloading

我正在将一些代码从其他语言移植到 Ruby，在我的类中我需要保持与这 4 个构造函数的兼容性：

```
def initialize(b)
def initialize(a, b)
def initialize(b, c)
def initialize(a, b, c) 
```

我正在尝试这种方式，但它不起作用：

```
def initialize(a="", b, c="") 
```

有没有聪明的解决方案？我不能使用哈希。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:58:56.167

如果`a,b,c`是完全不同的类型，并且永远都是，那么可能是这样的：

```
def initialize(*args)
   args.each do |arg| 
      do_a if arg.is_a?(first_type)
      do_b if arg.is_a?(second_type)
      do_c if arg.is_a?(third_type)
   end
end 
```

我承认，它并不漂亮，但它应该可以工作。如果您只需要 3 个参数，则将其限制`each`为仅运行`3.times`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T16:35:22.920

如果你不能使用哈希（为什么不呢？），而且它们*必须*是`initialize`方法，那么你很可能不走运。如果没有键入或位置信息，就无法解构，例如，数组，并确定哪个参数是哪个。

IMO 最干净的方法是提供执行构造并接受特定于构造函数（在本例中为工厂）的参数的类方法。

我想，如果参数是不同类型的，您可以使用该信息来确定传入哪些值，但 IMO 很快就会变得非常难看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T17:29:58.823

这可能是一个解决方案，但它很丑！

```
def initialize(*args)
    case (args.length)
        when 1
            super(XXX)
            @y = args[0]
        when 2
            if args[0].kind_of?(A) then
                super(args[0])
                @x = args[0]
                @y = args[1]
            elsif args[0].kind_of?(B) then
                super(XXX)
                @y = args[0]
                @z = args[1]
            end 
        when 3
            super(args[0])
            @x = args[0] 
            @y = args[1]
            @z = args[2]
    end
end 
```

# javascript - 在jquery中将输入转换为链接

> ID：11160426
> 
> 赞同：1
> 
> 时间：2012-06-22T16:33:13.937
> 
> 标签：javascript, jquery, jquery-ui

目前脚本是这样的：

1.  单击链接通过使输入可见来编辑链接
2.  单击链接之前/下一个 通过使输入可见来编辑链接

我希望当您单击一次链接时不要编辑而是在新窗口中打开页面，并且当您单击双击进行编辑时。

这是脚本：

[jsfiddle - 代码](http://jsfiddle.net/pFyNY/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:35:59.253

~~[http://jsfiddle.net/jaspermogg/pFyNY/1/](http://jsfiddle.net/jaspermogg/pFyNY/1/) - 您可以双击 div 进行编辑，或单击链接打开。那是你想要的吗？~~

 ~~```
$('.a0').dblclick(function(e){
    e.preventDefault();
    $(this).parent().find('input').val($(this).find('a').text()).show().focus();
    $(this).hide();
})

$('#url0, #url1').each(
    function(index, element){
        $(element).blur(function(){
            $(this).hide().prev().show().find('a').html(this.value);
    })
    }    
); 
```~~ 

~~这是一个 jsFiddle，它将 href 更改为`a`您将其编辑为的值，以防万一您接下来要尝试执行此操作:-) [http://jsfiddle.net/jaspermogg/pFyNY/2/](http://jsfiddle.net/jaspermogg/pFyNY/2/)~~

这是你想要的 jsFiddle - [http://jsfiddle.net/jaspermogg/pFyNY/5/](http://jsfiddle.net/jaspermogg/pFyNY/5/)

JS-

```
$('.a0 a').click(function(){

    var href = $(this).attr('href');

    // Redirect only after 500 milliseconds (CHANGE THE 500 IN THE CODE TO DETERMINE HOW LONG THE USER GETS TO DBLCLICK)
    if (!$(this).data('timer')) {
       $(this).data('timer', setTimeout(function () {
          window.location = href;
       }, 500));
    }
    return false; // Prevent default action (redirecting)
});

$('.a0').dblclick(function(){
    clearTimeout($(this).find('a').data('timer'));
    $(this).find('a').data('timer', null);

    $(this).parent().find('input').val($(this).find('a').text()).show().focus();
    $(this).hide();
})

$('#url0, #url1').each(
    function(index, element){
        $(element).blur(function(){
            $(this).hide().prev().show().find('a').html(this.value);
    })
    }    
); 
```

受[Jquery 启发，在 A Href 上创建双击事件](https://stackoverflow.com/questions/4818085/jquery-create-double-click-event-on-a-href)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:42:33.510

使用`target="_blank"`属性在新页面中打开链接。

```
<a target="_blank" href="dsad.cas">dsad.cas</a> 
```

并使用 . [jquery的dblclick](http://api.jquery.com/dblclick/)函数来编辑链接

```
$('.a0').dblclick(function(e){
    e.preventDefault();
    $(this).parent().find('input').val($(this).find('a').text()).show().focus();
    $(this).hide();
})

$('#url0, #url1').each(
    function(index, element){
        $(element).blur(function(){
            $(this).hide().prev().show().find('a').html(this.value);
    })
    }    
);
​ 
```

这是[演示](http://jsfiddle.net/pFyNY/3/)

# java - 如何将 MySql 中的时间格式转换为 Java 中的字符串？

> ID：11160427
> 
> 赞同：0
> 
> 时间：2012-06-22T16:33:14.357
> 
> 标签：java, mysql, string, time

我正在使用休眠从 MySql 数据库中取出一些记录。我表中的 DepTime 属性是时间格式 (hh:mm:ss)。如何在 Java 中将其转换为字符串？以下代码在第 6 行给出类型不匹配错误。

```
List<?> dataList3 = DBOperation.getqpidfromAssessment(6);
if(dataList3.size()>0)
{
   for (Iterator<?> iterator = dataList.iterator(); iterator.hasNext();) {
    Route rt = (Route) iterator.next(); 
    String depTime=rt.getDepTime();
    double lt=rt.getLatitude();
    log.debug("Lat : "+lat);

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:24:10.730

在java中使用`.toString()`函数将anydata转换为字符串。

```
 String depTime=rt.getDepTime().toString(); 
```

# php - 获取文本框文本

> ID：11160429
> 
> 赞同：1
> 
> 时间：2012-06-22T16:33:17.697
> 
> 标签：php, html

当我单击按钮时，文本框中的文本应写入`.txt`文件，然后应下载该文件。不知何故，该`isset`功能不起作用，我已经尝试使用`<form`> 链接 php 文件，但是我无法读取文本框文本。

这是我的代码：

```
<?PHP

if(isset($_POST['submit']))
{
    $text = $_POST['text'];
    print ($text);

    $filename = 'test.txt';
    $string = $text;

    $fp = fopen($filename, "w");
    fwrite($fp, $string);
    fclose($fp);

    header('Content-disposition: attachment; filename=test.txt');
    header('Content-type: application/txt');
    readfile('test.txt');
}

?>

<html>
    <head>
        <title>Text Editor</title> 
    </head>
    <body>
        <textarea name="text" rows="20" cols="100"></textarea>
        <p>
        <button type="submit" value="submit">Download Text</button>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:36:35.223

首先，您需要有一个`<form>`标签才能提交您的数据：

```
<body>
<form action="add your php filename here" method="post">

...

</form>
</body> 
```

你可能还需要把你`<button type="submit"`的`<input type="submit"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:42:25.837

如果 php 文档在同一个文件中，则添加一个表单标签并回发到同一个页面。

```
<?php

if(isset($_POST['submit']))
 {
    $text = $_POST['text'];
    print ($text);

    $filename = 'test.txt';
    $string = $text;

    $fp = fopen($filename, "w");
    fwrite($fp, $string);
    fclose($fp);

    header('Content-disposition: attachment; filename=test.txt');
    header('Content-type: application/txt');
    readfile('test.txt');
 }?> 

<html>
<head>
  <title>Text Editor</title>
</head>
<body>
  <form method="post">
    <textarea name="text" rows="20" cols="100"></textarea><p>
  <input type="submit" value="submit">Download Text</button>
</form>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:36:30.997

您尚未在 HTML 中添加表单 TaG。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T16:37:11.143

在您当前的 HTML 中，您需要一个`<form>`标签。

尝试在此处阅读有关此内容[。](http://www.tizag.com/phpT/postget.php)

# django - 如何在起始页上使用 Django 构建登录小部件？

> ID：11160441
> 
> 赞同：0
> 
> 时间：2012-06-22T16:34:02.157
> 
> 标签：django

如何在左上角的小部件中的起始页上构建登录表单？

我想要一个时尚的 web 2.0，比如登录……在右上角滑入（就像在 dropbox.com 上）……到目前为止，设计部分……

当谈到 django (1.4) 的视图和默认登录行为时，我无法让自己走向正确的方向。我得到了与 django.contrib.auth 等一起使用的标准示例......但是如果我在第一个站点上有我的登录小部件怎么办：

> (r'^$', 'myproject.views.home')

我尝试将表单集成到我的模板（home.html）中，如下所示：

```
<form action="/login/" method="post">{% csrf_token %}
        {% if next %}
        <input type="hidden" name="next" value="{{ next }}" />
        {% endif %}
        username:
        <input type="text" name="username" value="{{ username}}" /><br />
        password:
        <input type="password" name="password" value="" /><br />
                <input type="hidden" name="next" value="{{'something'}}" />
        <input type="submit" value="anmelden" />
    </form> 
```

我的观点是这样的：

```
def home(request):
    title='home'

    try:
         username = request.POST.get('username', '')
         password = request.POST.get('password', '')
         user = auth.authenticate(username=username, password=password)
         if user is not None and user.is_active:
        # Correct password, and the user is marked "active"
            auth.login(request, user)
        # Redirect to a success page.
            return HttpResponseRedirect("/im_in/")
        else:
        # Show an error page
            return HttpResponseRedirect("/im_not/")
    except:

        return render_to_response('home.html',locals()) 
```

[编辑] 我的 urlconf：

```
urlpatterns = patterns('',

    (r'^$', 'edumin.views.home'),
) 
```

**我的问题：**

提交 django 后将我带到 /login 并说：

当前的 URL，login/，与其中任何一个都不匹配。

任何帮助或在第一页登录的好例子......或用于此目的的自定义登录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:42:27.167

根据我在这里看到的所有内容，您实际上没有任何东西`/login/`可以捕获登录信息，而是尝试通过当前 URL 登录。在这种情况下，您应该从登录表单中完全删除该`action`属性。

# r - 在保持课程日期的同时将日期格式化为月-年

> ID：11160445
> 
> 赞同：6
> 
> 时间：2012-06-22T16:34:13.093
> 
> 标签：r, date

我觉得有一个非常简单的方法可以做到这一点，但我不容易找到它......

我正在使用 R 从数据集中提取数据，并通过许多不同的特征对其进行总结。其中之一是安排/发生事件的月份。我们在数据库中有确切的事件日期，如下所示：

```
person_id    date_visit
1            2012-05-03
2            2012-08-13
3            2012-12-12
... 
```

我想使用该`table()`函数生成一个如下所示的汇总表：

```
Month    Freq
Jan 12   1
Feb 12   2
Mar 12   1
Apr 12   3
... 
```

我的问题是这个。我已读取数据并用于`as.Date()`将字符串转换为日期。我可以`format.Date()`用来获取格式为 Jan 12、Mar 12 等的日期。但是当你使用 时`format.Date()`，你会再次得到字符串。这意味着当您`table()`向他们申请时，他们会按字母顺序出现（我目前的设置是 8 月 12 日、7 月 12 日、6 月 12 日、3 月 12 日，依此类推）。

我知道在 SAS 中，您可以使用格式来更改日期的外观，同时将其保留为日期（因此您仍然可以对其进行日期运算符）。可以用 R 完成同样的事情吗？

我的计划是通过多个步骤构建一个漂亮的数据框，然后（在确保所有日期都转换为字符串之后，出于兼容性原因）使用`xtable()`来制作一个漂亮的 LaTeX 输出。

这是我目前的代码。

```
load("temp.RData")
ds$date_visit <- as.Date(ds$date_visit,format="%Y-%m-%d")
table(format.Date(safebeat_recruiting$date_baseline,format="%b %Y")) 
```

ETA：如果可以的话，我宁愿只在 Base R 中做，但如果必须，我总是可以使用额外的包。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T16:39:18.380

您可以使用包中的`yearmon`类`zoo`

```
require("zoo")
ds <- data.frame(person_id=1:3, date_visit=c("2012-05-03", "2012-08-13", "2012-12-12"))
ds$date_visit <- as.yearmon(ds$date_visit)
ds
  person_id date_visit
1         1   May 2012
2         2   Aug 2012
3         3   Dec 2012 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T17:06:50.207

`month.abb`是 R 中的一个常量向量，可用于对`names`表的字符串的前三个字母进行排序。

```
ds <- data.frame(person_id=1:3, date_visit=as.Date(c("2012-05-03", "2012-08-13", "2012-12-12")))
table(format( ds$date_visit, format="%b %Y"))
tbl <- table(format( ds$date_visit, format="%b %Y"))
tbl[order(  match(substr(names(tbl), 1,3), month.abb) )]

May 2012 Aug 2012 Dec 2012 
       1        1        1 
```

再过几年，您会看到“五月”一起出现，因此需要这样做：

```
 tbl[order( substr(names(tbl), 5,8),  match(substr(names(tbl), 1,3), month.abb) )] 
```

# highcharts - 如何使用 Highcharts 创建具有对数 (log) 刻度的堆积面积图？

> ID：11160448
> 
> 赞同：1
> 
> 时间：2012-06-22T16:34:36.097
> 
> 标签：highcharts

我有两个系列的数据点。我想使用 Highcharts JS（javascript 库）生成堆积面积图。这很简单。

但是，现在我想对 Y 轴使用对数刻度，因为几个月来，数据点非常高。

问题是：在生成的图表中，底线下方的区域没有像使用正常 y 轴时那样阴影。

这是我的代码：

```
$(function () {
    var chart = new Highcharts.Chart({

        chart: {
            type: 'area',
            renderTo: 'container'
        },  

        xAxis: {
            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May',
                         'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
        },  

        yAxis: {
            type: 'logarithmic'
        },  
        plotOptions: {
          area: {
            stacking: 'normal'
          }   
        },  
        series: [{
            data: [10, 29, 45, 1200, 25, 19, 70],
        },{ 
            data: [5, 10, 30, 800, 20, 30, 20],
        }   
                ]   

    }); 
}); 
```

你可以在这里试试：http: [//jsfiddle.net/CK8vf/](http://jsfiddle.net/CK8vf/)

我认为问题可能是 Y 的最小值是 1，而不是 0，这对于对数刻度是不允许的。

任何想法如何使这项工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T18:34:26.217

You just need to remove your plotOptions settings. For some reason the stacking: 'normal' appears to put the two data series on different scales. Without that, you will get the fill under both.

So:

```
$(function () {
var chart = new Highcharts.Chart({

    chart: {
        type: 'area',
        renderTo: 'container'
    },  

    xAxis: {
        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May',
                     'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
    },  

    yAxis: {
        type: 'logarithmic'
    },  
    series: [{
        data: [10, 29, 45, 1200, 25, 19, 70],
    },{ 
        data: [5, 10, 30, 800, 20, 30, 20],
    }   
            ]   

}); 
}); 
```

# android - Android ADK 附件弹出一个空的空对话框

> ID：11160455
> 
> 赞同：0
> 
> 时间：2012-06-22T16:35:11.490
> 
> 标签：android, usb, host, adk

我正在使用 Sparkfun 的电动羊板制作配件。以前，我的代码运行良好，可以与 USB 配件通信。但是最近，它没有弹出消息框来授予附件权限，而是弹出了一个空白消息框，该消息框占据了整个屏幕，没有文字或按钮。我昨天用完全相同的代码重新创建了我的整个 Eclipse 项目，它再次完美运行。但是，今天我开始研究它，却发现我又得到了空白消息框。

以前有人经历过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T21:19:08.933

发布后立即找到答案。我正在为图标使用快速图像并且还不担心重新调整它的大小，而是让应用程序在必要时重新缩放它，直到我开始缩小它。事实证明，消息/对话框不会将图标缩放到应用程序并试图呈现它。

# ios - iOS 中的图像选择器是否支持 RAW 图像格式？

> ID：11160458
> 
> 赞同：0
> 
> 时间：2012-06-22T16:35:19.623
> 
> 标签：ios, image, ios5, import

它不会出现在 UTI 图像内容类型中。另外，如果是这种情况，RAW 图像文件是否有大小限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:01:11.397

不支持 RAW。如果您处理文件并将其自己转换为 UIImage 以显示在 UIImageView 或其他内容中，则文件的大小（如果假设您通过另一种方法引入）仍然可以显示和使用。

至于大小，唯一真正的限制不是文件大小本身，而是实时处理大小。虽然没有很好的记录，但应用程序可以明智地使用数据的总大小约为 24 MB（或者至少它曾经被限制在这个范围内）。文件iteslf 可以相当大，但您一次只能处理有限的块（如果它大于应用程序大小限制）。

还可以在此处查找 UIImage 对象识别的文件类型。这也是 UIImagePicker 不支持它的原因，因为它在 UIImageView 对象中使用 UIImage 对象。因此它只能原生支持 UIImage 对象支持的类型。

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html)

# apache2 - 看不到图像 Symfony 1.4.18

> ID：11160460
> 
> 赞同：0
> 
> 时间：2012-06-22T16:35:26.497
> 
> 标签：apache2, symfony-1.4, ubuntu-12.04

我正在尝试在 Linux 环境中设置 Symfony 1.4.18。我正在运行 Ubuntu 12.04LTS。

问题是，一旦我进入 Symfony 设置页面，您应该以图形方式看到“Symfony Project Created”，我得到的只是文本形式。

由于某种原因，它没有访问 /sf 文件夹。我已经添加了别名，但它仍然无法正确呈现。这是我添加到 httpd.conf 文件末尾的信息：

```
<VirtualHost 127.0.0.1:8080>
DocumentRoot "/var/www/sfproject/web"
DirectoryIndex index.php
<Directory "/var/www/sfproject/web">
  AllowOverride All
  Allow from All
</Directory>

Alias /sf /var/www/sfproject/lib/vendor/symfony/data/web/sf
<Directory "/var/www/sfproject/lib/vendor/symfony/data/web/sf">
  AllowOverride All
  Allow from All
</Directory> 
```

如您所见，我修改了路径以反映我的系统设置方式。var/www 是我的根网络文件夹；我的一切都以此为基础。

当我在浏览器中访问该页面时，按照 Symfony 的说明输入“http://localhost/sfproject/web/index.php”，而不是“http://localhost:8080/index.php/”。也许这会对这个问题有所启发。

感谢您的帮助，上帝保佑！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T17:22:00.690

如果您使用 http://localhost/sfproject/web/index.php 访问代码，我确信您编写的所有这些 apache 配置都不起作用。

在这里，您有一些关于 apache2-symfony 工作的说明：

*   删除您添加的此配置（不起作用）
*   定义一些测试域四个你的应用程序（如“my_test”）
*   在 /etc/apache2/sites-available 中创建一个文件，例如：“my_test_apache_config”，或简称为“my_test”

    ```
     <VirtualHost *:80>
              ServerAdmin webmaster@localhost        
              ServerName my_test  
              # this will be your app url, like http://my_test/

              DocumentRoot /var/www/sfproject/web  
              # point to the symfony project web folder

              DirectoryIndex index.php     

              <Directory "/var/www/sfproject/web" > 
              # point to the symfony project web folder
                    AllowOverride All
                    Allow from All
              </Directory>

              Alias /sf /var/www/sfproject/lib/vendor/symfony/data/web/sf  
              # path for default images

              <Directory "/var/www/sfproject/lib/vendor/symfony/data/web/sf" > 
              # path for default images
                    AllowOverride All
                    Allow from All
             </Directory>

              # I recommend you to have some special log for every site
              ErrorLog /var/log/apache2/my_test_error.log   
              LogLevel warn   # idem
              CustomLog /var/log/apache2/my_test_access.log combined

            </VirtualHost> 
    ```

*   运行“sudo a2ensite my_test”

*   运行“sudo /etc/init.d/apache2 重启”
*   编辑（以 root 身份）/etc/hosts 并为您的开发域添加一个指向 localhost 的条目，例如：

    127.0.0.1 my_test

*   重新启动浏览器

*   浏览到 http://my_test/index.php

就这样。这可能看起来很重，但事实并非如此。如果有一天您希望在本地关闭您的站点，只需运行：“sudo a2dissite my_test”

# javascript - Google Earth Capture 当前地球视图的 KML

> ID：11160461
> 
> 赞同：0
> 
> 时间：2012-06-22T16:35:35.290
> 
> 标签：javascript, kml, google-earth

除了当前的 LookAt 或包含 Earth View 内所有元素的 Camera 之外，是否有人知道使用类似于 polygon.getKml() 的东西？

我已经尝试过类似 ge.getView().getKml() 的方法，但 getKml 只能应用于某些对象。

您还可以使用循环单独获取每个元素 KML，并且：

```
ge.getFeatures().getChildNodes().item(#).getKml(); 
```

然而，这不会给你看或相机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T21:54:19.183

你可以使用

```
var lookAt = ge.getView().copyAsLookAt(ge.ALTITUDE_RELATIVE_TO_GROUND); 
```

或者

```
var camera = ge.getView().copyAsCamera(ge.ALTITUDE_RELATIVE_TO_GROUND); 
```

请参阅此页面以获取文档 [https://developers.google.com/earth/documentation/camera_control](https://developers.google.com/earth/documentation/camera_control)

# hibernate - 未配置 CurrentSessionContext！：ThreadLocalSessionContext.bind(session); 没有正确绑定我的会话

> ID：11160463
> 
> 赞同：2
> 
> 时间：2012-06-22T16:35:42.910
> 
> 标签：hibernate, session, junit

我正在使用 Hibernate 4.0.1.Final。

我在测试我的服务时无法绑定会话。我曾经`ThreadLocalSessionContext.bind(session)`尝试绑定会话，以便`sessionFactory.getCurrentSession()`返回有效的会话，但它不起作用。

调用`sessionFactory.getCurrentSession()`会产生异常（如下）。在我的服务课上，我有：

```
public class OrganizationServiceImpl extends AbstractTransactionService implements OrganizationService {

public void saveOrganization(final String eodbId,
                             final String parentEodbId,
                             final String name,
                             final String description,
                             final String organizationType,
                             final String url,
                             final String stateAbbrev) {
    Session session = null;
    try {
        session = startOperation();
        final State state = orgDao.findStateByAbbrev(stateAbbrev);

…

protected Session startOperation() throws HibernateException {
    final Session session = sessionFactory.openSession();
    ThreadLocalSessionContext.bind(session);
    tx = session.beginTransaction();
    return session;
} 
```

这是调用此服务的 JUnit 测试……</p>

```
@Before
public void setupOrgServiceTest() { 
    Configuration config = new Configuration()
        .setProperty("hibernate.dialect", "org.hibernate.dialect.HSQLDialect")
        .setProperty("hibernate.connection.driver_class", "org.hsqldb.jdbcDriver")
        .setProperty("hibernate.connection.url", "jdbc:hsqldb:mem:lyceaTestDb")
        .setProperty("hibernate.connection.username", "sa")
        .setProperty("hibernate.connection.password", "")
        .setProperty("hibernate.connection.pool_size", "1")
        .setProperty("hibernate.connection.autocommit", "true")
        .setProperty("hibernate.cache.provider_class", "org.hibernate.cache.HashtableCacheProvider")
        .setProperty("hibernate.hbm2ddl.auto", "create-drop")
        .setProperty("hibernate.show_sql", "true")
        .addAnnotatedClass(Organization.class)
        .addAnnotatedClass(State.class); 
    final ServiceRegistry serviceRegistry = new ServiceRegistryBuilder().applySettings(config.getProperties()).buildServiceRegistry();
    sessionFactory = config.buildSessionFactory(serviceRegistry);
    orgService = new OrganizationServiceImpl(sessionFactory);
}   // setupOrgSErviceTest

@Test
public void testSaveOrg() { 
    orgService.saveOrganization(testProps.getProperty("test.school.eodbId"),
                                testProps.getProperty("test.school.parent.eodbId"),
                                testProps.getProperty("test.school.name"), 
                                testProps.getProperty("test.school.description"), 
                                testProps.getProperty("test.school.org.type"), 
                                testProps.getProperty("test.school.url"), 
                                testProps.getProperty("test.school.state"));
}   // testSaveOrg 
```

我打电话时得到的例外`sessionFactory.getCurrentSession()`是

```
org.myco.myproject.orgsclient.exceptions.DataAccessLayerException: org.hibernate.HibernateException: No CurrentSessionContext configured!
    at org.myco.myproject.orgsclient.service.AbstractTransactionService.handleException(AbstractTransactionService.java:28)
    at org.myco.myproject.orgsclient.service.OrganizationServiceImpl.saveOrganization(OrganizationServiceImpl.java:42)
    at org.myco.myproject.orgsclient.service.OrganizationServiceTest.testSaveOrg(OrganizationServiceTest.java:40)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
    at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
    at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
    at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: org.hibernate.HibernateException: No CurrentSessionContext configured!
    at org.hibernate.internal.SessionFactoryImpl.getCurrentSession(SessionFactoryImpl.java:881)
    at org.myco.myproject.orgsclient.dao.OrganizationDAOImpl.findStateByAbbrev(OrganizationDAOImpl.java:29)
    at org.myco.myproject.orgsclient.service.OrganizationServiceImpl.saveOrganization(OrganizationServiceImpl.java:30)
    ... 24 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:09:04.843

您没有指定告诉`SessionFactory`使用`ThreadLocalSessionContext`.

```
setProperty("hibernate.current_session_context_class", "thread") 
```

这意味着当你`SessionFactory`构建 Hibernate 时不会设置 currentSessionContext。当您调用`getCurrentSession()`时，Hibernate 无处可从中检索当前会话。

其他选项是`jta`和`managed`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-31T09:53:43.283

将以下属性添加到 hibernate.cfg.xml 文件：

```
<property name="hibernate.current_session_context_class">thread</property> 
```

# iphone - iPhone 开发人员：任何片段来调整图像大小并保持比例？

> ID：11160464
> 
> 赞同：2
> 
> 时间：2012-06-22T16:35:47.487
> 
> 标签：iphone, ios

我是在 iPhone 中开发代码的新手，我想搜索一些代码以将我的 UIImage 调整为指定大小但保持比例。指定的大小类似于图像不能越过边界的框架，在该边界内，图像应该缩放以适合框架并保持比例，我目前使用的代码可以调整大小但不能保持比率，只需将其粘贴在这里，看看我是否可以进行一些琐碎的修改，使其成为可能。

```
- (UIImage *)resizeImage:(UIImage*)image newSize:(CGSize)newSize {
CGRect newRect = CGRectIntegral(CGRectMake(0, 0, newSize.width, newSize.height));
CGImageRef imageRef = image.CGImage;

UIGraphicsBeginImageContextWithOptions(newSize, NO, 0);
CGContextRef context = UIGraphicsGetCurrentContext();

// Set the quality level to use when rescaling
CGContextSetInterpolationQuality(context, kCGInterpolationHigh);
CGAffineTransform flipVertical = CGAffineTransformMake(1, 0, 0, -1, 0, newSize.height);

CGContextConcatCTM(context, flipVertical);  
// Draw into the context; this scales the image
CGContextDrawImage(context, newRect, imageRef);

// Get the resized image from the context and a UIImage
CGImageRef newImageRef = CGBitmapContextCreateImage(context);
UIImage *newImage = [UIImage imageWithCGImage:newImageRef];

CGImageRelease(newImageRef);
UIGraphicsEndImageContext();    

return newImage; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:48:38.187

好吧，您可以更简单地调整图像的大小：

```
+ (UIImage *)imageWithImage:(UIImage *)image scaledToSize:(CGSize)newSize {
    UIGraphicsBeginImageContextWithOptions(newSize, NO, 0.0);
    [image drawInRect:CGRectMake(0, 0, newSize.width, newSize.height)];
    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();    
    UIGraphicsEndImageContext();
    return newImage;
} 
```

然后你需要计算一个新的尺寸来维持纵横比。例如，要获取图像大小的一半，您将提供这样创建的大小：

```
 CGSize halfSize = CGSizeMake(image.size.width*0.5, image.size.height*0.5); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T16:50:33.080

用于在保持纵横比的同时将图像大小调整为特定边界的伪代码：

```
imageSize // The image size, for example {1024,768}
boundarySize // The boundary to fit the image into, for example {960,640}

boundaryAspectRatio = boundarySize.width / boundarySize.height
imageAspectRatio = imageSize.width / imageSize.height

if ( imageAspectRatio == boundaryAspectRatio )
{
    // The aspect ratio is equal
    // Resize image to boundary
}
else if ( imageAspectRatio > boundaryAspectRatio )
{
    // The image is wider
    // Resize to:
    // - Width:   boundarySize.width
    // - Height:  boundarySize.height / imageAspectRatio
} 
else if ( imageAspectRatio < boundaryAspectRatio )
{
    // Resize to:
    // - Width:   boundarySize.width * imageAspectRatio
    // - Height:  boundarySize.height
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T16:54:06.337

只需将 MAX 更改为 MIN 以适合而不是填充 ;)

```
- (UIImage *)imageByFillingSize:(CGSize)newSize useScreenScale:(BOOL)useScreenScale
{
    CGSize size = [self size];
    CGRect frame;
    float ratioW = newSize.width / size.width;
    float ratioH = newSize.height / size.height;
    float ratio = MAX(ratioW, ratioH);

    frame.size.width = size.width * ratio;
    frame.size.height = size.height * ratio;
    frame.origin.x = (newSize.width - frame.size.width) / 2.0;
    frame.origin.y = (newSize.height - frame.size.height) / 2.0;

    UIGraphicsBeginImageContextWithOptions(newSize, YES, useScreenScale ? 0.0 : 1.0);
    [self drawInRect:frame];
    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();    
    UIGraphicsEndImageContext();
    return newImage;
} 
```

# google-app-engine - 在 GAE 上实施“本地”用户管理

> ID：11160466
> 
> 赞同：2
> 
> 时间：2012-06-22T16:35:55.510
> 
> 标签：google-app-engine, user-management, openid-provider

我想在 GAE 上开发一个商业应用程序。经营者不知何故不喜欢或误解 OpenID 的理念，坚持实施本地用户管理：使用存储在应用程序数据存储中的登录名和密码进行注册。

我想通过使用“本地”OpenID 提供程序来实现他想要的。这似乎是最直接的方法。有没有办法“插入”现有的 OpenID 提供程序库（+登录对话框 +也许是注册工作流程）并在同一个应用程序中使用它？例如，Janrain 是否需要大量修补才能做到这一点？

如果不是这样，我可以自己创建用户实例并使用本地商店的用户名+密码吗？那么如何处理会话管理呢？

抱歉，我在这件事上不是很有经验，从主要业务主题上被用户管理分心真的让我很恼火:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T16:44:15.937

我认为实施“虚拟”OpenID 提供程序并不是解决您的问题的最佳方法。您只需将自己的 cookie/会话存储在当前登录用户的位置上。在 Google App Engine 上手动做到这一点并不容易，但幸运的是，有很多框架可以解决这个问题（[gae-sessions](https://github.com/dound/gae-sessions)就是其中之一）。

我建议您查看[Flask-Login](http://packages.python.org/Flask-Login/)，它可以与您的 Google App Engine 集成。Flask-Login 为您提供了一个登录管理器，它通过安全会话处理所有后台工作，由您决定谁是登录用户。她是使用自定义登录名（用户名/密码）还是 OpenID 登录名登录并不重要，因为在这两种情况下，您都将拥有一个`User`模型来存储特定用户的额外信息。然后，您只需将该`user_db`实体设置为登录用户。

您可以查看[gae-init](https://bitbucket.org/lipis/gae-init)（免责声明：我是创建者）作为示例，了解如何使用 Flask-Login 以及其他内容，包括 Google、Facebook 和 Twitter 登录。请注意，Facebook 和 Twitter 不属于 Google 提供的联合登录。

# c#-4.0 - 如何分配复杂的配置文件值

> ID：11160470
> 
> 赞同：0
> 
> 时间：2012-06-22T16:36:03.030
> 
> 标签：c#-4.0, asp.net-profiles

根据[这篇文章](https://stackoverflow.com/questions/426609/how-to-assign-profile-values)，我能够相当轻松地让 FullName 工作。

我有以下类也有子类：

```
[DataContract]
[Serializable]
public class SettingSection
{
    public SettingSection()
    {
        this.UserSettings = new List<UserSettingPair>();
    } // SettingSection - Constructor

    public SettingSection(List<UserSettingPair> UserSettings)
    {
        this.UserSettings = UserSettings;
    } // SettingSection - Constructor

    [DataMember(Name = "sectionName")]
    public string SectionName { get; set; }

    [DataMember(Name = "userSettings")]
    public List<UserSettingPair> UserSettings { get; set; }

} // SettingSection - Class

[DataContract]
[Serializable]
public class UserSettingPair
{
    [DataMember(Name = "key")]
    public string Key { get; set; }

    [DataMember(Name = "value")]
    public string Value { get; set; }
} // UserSettingPair - Class 
```

然后我有一种方法可以使用以下代码将其序列化为 JSON：

```
public static string Serialize<T>(object input)
{
    string Result = "";
    DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(T));

    using (MemoryStream ms = new MemoryStream())
    {
        ser.WriteObject(ms, input);
        Result = Encoding.Default.GetString(ms.ToArray());
    }

    return Result;
} 
```

当我执行上述文章中的操作时，以下工作：

```
UserProfileContract.CurrentUser.FullName = "Testing"; 
```

当我用我的 List/Complex 对象（现在是一个 json 格式字符串）尝试它时......

```
base["sectionSettings"] = (Utilities.Serialize<List<SettingSection>>(Settings)).ToString();
Save(); 
```

我收到以下错误（请注意，上面我什至使用 .ToString() 将其双重强制为字符串，但没有运气：

```
The settings property 'sectionSettings' is of a non-compatible type. 
```

我显然做错了什么，我不得不假设我不是第一个想要在 ASP.Net 默认配置文件提供程序中保存 json 数据的人。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T20:23:36.133

在做了一些测试后，我将 Utilities.Serialize... 代码放入工作的 FullName 中，这很有效。然后我将 FullName 重命名为 FullNameXX，但它失败了。经过几次测试后，我得出的结论是，要保存在 Profile 中的所有属性都需要是字符串（或者我假设是二进制，但我没有使用 SQL 中的 PropertyValuesBinary 数据字段。）所以当我有一个复杂的字段时，就像我的 List 一样，我有一个用于获取和设置 List 的程序员的属性以及存储的同一属性的字符串版本。所以我现在有一个 SectionSettings 和一个 SectionSettingsValue 属性。需要进行的另一个调整是使其仅成为 DataContract 而不是可序列化的，否则您将获得额外的值，例如 k__backingField 恕我直言看起来很糟糕。

以下应该是完整的代码...

这是我的数据合同：

```
[DataContract]
public class UserProfileContract : ProfileBase
{

    #region Constructors

    public UserProfileContract()
    {
    } // UserProfileContract - Constructor

    public UserProfileContract(List<SettingSection> SectionSettings)
    {
        this.SectionSettings = SectionSettings;
    } // UserProfileContract - Constructor

    #endregion Constructors

    public static UserProfileContract CurrentUser
    {
        get { return (UserProfileContract)(ProfileBase.Create(Membership.GetUser().UserName)); }
    }

    public string FullNameValue { get; set; }
    public string SectionSettingsValue { get; set; }

    [DataMember(Name = "FullName")]
    public string FullName
    {
        get { return ((string)(base["FullNameValue"])); }
        set {
            base["FullNameValue"] = value;
            Save();
        }
    } // FullName - Property

    [DataMember(Name = "SectionSettings")]
    public List<SettingSection> SectionSettings
    {
        get { return Utilities.Deserialize<List<SettingSection>>(base["SectionSettingsValue"].ToString()); }
        set
        {
            base["SectionSettingsValue"] = Utilities.Serialize<List<SettingSection>>(value);
            Save();
        }
    } // SectionSettings - Property

} // UserProfileContract - Class

[DataContract]
public class SettingSection
{
    public SettingSection()
    {
        this.UserSettings = new List<UserSettingPair>();
    } // SettingSection - Constructor

    public SettingSection(List<UserSettingPair> UserSettings)
    {
        this.UserSettings = UserSettings;
    } // SettingSection - Constructor

    [DataMember]
    public string SectionName { get; set; }

    [DataMember]
    public List<UserSettingPair> UserSettings { get; set; }

} // SettingSection - Class

[DataContract]
public class UserSettingPair
{
    [DataMember]
    public string Key { get; set; }

    [DataMember]
    public string Value { get; set; }
} // UserSettingPair - Class 
```

这是我的静态实用程序类：

```
public static T Deserialize<T>(string json)
{
    var obj = Activator.CreateInstance<T>();

    if (string.IsNullOrWhiteSpace(json))
        return obj;

    using (var ms = new MemoryStream(Encoding.Unicode.GetBytes(json)))
    {
        var serializer = new DataContractJsonSerializer(obj.GetType());
        obj = (T)serializer.ReadObject(ms);

        return obj;
    } // using the memory stream
} // Deserialize - Method

public static string Serialize<T>(object input)
{
    string Result = "";
    DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(T));

    using (MemoryStream ms = new MemoryStream())
    {
        ser.WriteObject(ms, input);
        Result = Encoding.Default.GetString(ms.ToArray());
    }

    return Result;
} // Serialize - Method 
```

以下是如何在多个部分中保存数据以及 FullName 属性的示例：

```
// First Section
SettingSection s = new SettingSection();
s.SectionName = "ContractSearch";

UserSettingPair usp = new UserSettingPair();
usp.Key = "Default Control";
usp.Value = "txtFirstTextBox";

s.UserSettings.Add(usp);

usp = new UserSettingPair();
usp.Key = "Field1Choice";
usp.Value = "SchoolName";

s.UserSettings.Add(usp);

List<SettingSection> ss = new List<SettingSection>();
ss.Add(s);

// Second Section
s = new SettingSection();
s.SectionName = "Workflow Settings";

usp = new UserSettingPair();
usp.Key = "Primart Thing";
usp.Value = "Blabla bla";

s.UserSettings.Add(usp);

usp = new UserSettingPair();
usp.Key = "Allowable Tries";
usp.Value = "3";

s.UserSettings.Add(usp);

usp = new UserSettingPair();
usp.Key = "Extra Value";
usp.Value = "Gigity";

s.UserSettings.Add(usp);
ss.Add(s);

UserProfileContract.CurrentUser.FullName = "Grigsby";
UserProfileContract.CurrentUser.SectionSettings = ss; 
```

这是我创建的一个扩展方法，可以更轻松地提取 SectionSetting 值：

```
public static T GetSectionValue<T>(this UserProfileContract up, string Section, string Property)
{
    string value = (from ss in up.SectionSettings
                                        from us in ss.UserSettings
                                        where ss.SectionName == Section
                                        && us.Key == Property
                                        select us.Value).FirstOrDefault();

    try
    {
        return (T)Convert.ChangeType(value, typeof(T));
    }
    catch (InvalidCastException)
    {
        return default(T);
    }
} // GetSectionValue - Extension Method 
```

最后，上面的扩展方法的一个例子：

```
string k = x.GetSectionValue<string>("Workflow Settings", "Primary Thing");
string g = x.GetSectionValue<string>("Workflow Settings", "Extra Value");
int three = x.GetSectionValue<int>("Workflow Settings", "Allowable Tries"); 
```

这是我输入的值的字符串版本：

```
[{"SectionName":"ContractSearch","UserSettings":[{"Key":"Default Control","Value":"txtFirstTextBox"},{"Key":"Field1Choice","Value":"SchoolName"}]},{"SectionName":"Workflow Settings","UserSettings":[{"Key":"Primart Thing","Value":"Blabla bla"},{"Key":"Allowable Tries","Value":"3"},{"Key":"Extra Value","Value":"Gigity"}]}]Grigsby 
```

在上面的字符串 k = ... 示例中，请注意它返回 null 因为数据是“Primart Thing”而不是“Primary Thing”。

希望这可以帮助那里的人。

# php - 通过 php 和 sql 检查帐户详细信息

> ID：11160477
> 
> 赞同：0
> 
> 时间：2012-06-22T16:36:32.523
> 
> 标签：php, sql, passwords

我最近刚开始搞乱php，我正在测试我的新知识，试图使用数据库来存储用户名和密码来制作一个简单的登录页面。一切顺利，但我遇到了一堵巨大的墙！`$result = $stmt->fetch();`出于某种原因，即使我在 phpmyadmin 中运行 sql 查询，我的 fetch 方法也没有返回任何结果，它返回一行就好了！这与我从表单或加密获取输入的方式有关吗？

这是我的完整代码。谢谢大家温柔我是全新的哈哈

```
<?php 
include 'inc/db.inc.php';
$link = new PDO(DB_INFO, DB_USER, DB_PASS);

?>

<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title></title>
  <meta name="description" content="">

  <meta name="viewport" content="width=device-width">

  <link rel="stylesheet" href="css/style.css">

<script src="js/libs/modernizr-2.5.3.min.js"></script>
</head>
<body>
<?php
if($_SERVER['REQUEST_METHOD'] == 'POST' && isset($_POST['register'])) {
$sql = "INSERT INTO account (account_name, account_pass) VALUES (:name, :pass)";
$stmt = $link->prepare($sql);
$stmt->bindParam(':name', $name);
$stmt->bindParam(':pass', $pass);
$name = $_POST["username"];
$pass = md5($_POST["password"]);
$stmt->execute();

echo "Thank you for registering!";
} else if ($_SERVER['REQUEST_METHOD'] == 'POST' && isset($_POST['login'])) {
$sql = "SELECT account_name, account_pass FROM account WHERE account_name=:name AND account_pass=:pass";
$stmt = $link->prepare($sql);
$stmt->bindParam(':name', $name, PDO::PARAM_STR);
$stmt->bindParam(':pass', $pass, PDO::PARAM_STR);
$pass = strip_tags(md5($_POST["password"]));
$name = strip_tags($_POST["username"]);
$stmt->execute();
$result = $stmt->fetch();
print_r($result);

if(empty($name) || empty($pass)){
echo "please enter a username and password!";
} else {
if(empty($result)){

echo "yes";
} else {
echo "no";
}
}

} else {
?>
<form method="post" action="test.php">
<label for="username">Username: </label>
<input type="text" name="username" />
<label for="password">Password: </label>
<input type="password" name="password" />
<input type="submit" name="login" value="Login" />
<input type="submit" name="register" value="register" />
</form>
<?php } ?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:41:45.153

您正在使用`$stmt->bindParam`尚未设置的变量。像这样调整你的代码：

```
$sql = "SELECT account_name, account_pass FROM account WHERE account_name=:name AND account_pass=:pass";
$pass = strip_tags(md5($_POST["password"]));
$name = strip_tags($_POST["username"]);
$stmt = $link->prepare($sql);
$stmt->bindParam(':name', $name, PDO::PARAM_STR); // $name needs to be set before this
$stmt->bindParam(':pass', $pass, PDO::PARAM_STR); // $pass needs to be set before this
$stmt->execute();
$result = $stmt->fetch();
print_r($result); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:43:44.003

在绑定参数之前不必设置变量吗？

```
$pass = strip_tags(md5($_POST["password"]));
$name = strip_tags($_POST["username"]);
$stmt->bindParam(':name', $name, PDO::PARAM_STR);
$stmt->bindParam(':pass', $pass, PDO::PARAM_STR); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:45:58.307

你有一种非常有趣的做事方式。呵呵。

我会做类似的事情

```
$resource = mysql_query($sql);
if(!$resource){
  die("query error: ".mysql_error());
}
$count = mysql_num_rows($resource);
if($count > 0){
  //match found.
}else{
  //incorrect login.
} 
```

也许我只是不习惯你的语法

# jquery-mobile - 阻止带有大量选项的 jquerymobile 多选控件的对话框视图

> ID：11160479
> 
> 赞同：8
> 
> 时间：2012-06-22T16:36:36.613
> 
> 标签：jquery-mobile, dialog, multi-select

所以我喜欢 jquery-mobile 拥有的自定义多选控件并想使用它。所以请不要建议放 data-role="none"。但是，如果选项列表很长，我只是不希望选择列表的默认行为在新的对话框窗口中打开。

我不希望这种行为的原因是它在 ipad 上运行得不太好。使用对话框左侧的“X”关闭它变得很困难。由于某种原因，它在 ipad 上变得无响应，但在桌面上运行良好。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-28T16:26:10.023

因此，深入研究了 jquery 移动 javascript（这很痛苦），以找出多选列表的全屏决定是在哪里做出的。这段代码告诉我没有可以设置的标志来避免它。

但是，由于它取决于列表的高度（menuHeight），对我有用的修复是进行一些 css 更改（减少每个列表项的填充），以便减小我的列表大小：

```
.ui-selectmenu-list li .ui-btn-inner a.ui-link-inherit
{
    padding: .5em 15px .5em 15px;    
} 
```

如果你想死肯定不显示对话框，那么一个肮脏的修复方法是在你的 jquery 移动代码的本地副本中放置一些覆盖（我讨厌这样做，但这是唯一的方法）：

```
//TODO: vishalkumar : I can override here by replacing below line by if (false)           
if (menuHeight > screenHeight - 80 || !$.support.scrollTop) {

                self.menuPage.appendTo($.mobile.pageContainer).page();
                self.menuPageContent = menuPage.find(".ui-content");
                self.menuPageClose = menuPage.find(".ui-header a");

                // prevent the parent page from being removed from the DOM,
                // otherwise the results of selecting a list item in the dialog
                // fall into a black hole
                self.thisPage.unbind("pagehide.remove");

                //for WebOS/Opera Mini (set lastscroll using button offset)
                if (scrollTop == 0 && btnOffset > screenHeight) {
                    self.thisPage.one("pagehide", function () {
                        $(this).jqmData("lastScroll", btnOffset);
                    });
                }

                self.menuPage.one("pageshow", function () {
                    focusMenuItem();
                    self.isOpen = true;
                });

                self.menuType = "page";
                self.menuPageContent.append(self.list);
                self.menuPage.find("div .ui-title").text(self.label.text());
                $.mobile.changePage(self.menuPage, {
                    transition: $.mobile.defaultDialogTransition
                });
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-10-11T09:50:18.433

也许我找到了一个使用 css 的更简单的解决方案

```
.ui-selectmenu{
    max-height: 500px;
} 
```

这会阻止 jquery mobile 识别选项的长列表并且它不会创建对话框。

请注意，所有选择控件都会发生这种情况。

最好将此选项限制为仅适用于桌面用户，以便在移动设备中使用整页对话框，这非常有用。例如使用

```
@media screen and (min-width: 768px) {
    .ui-selectmenu{
        max-height: 500px;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-04-25T23:13:29.900

这是一个简单的 CSS，它会阻止对话框版本，并在列表中给你一个滚动条。

```
.ui-selectmenu { max-height: calc(95vh - 100px); } 
.ui-selectmenu-list { max-height: calc(95vh - 150px); overflow-y: auto; } 
```

# c++ - EnterCriticalSection 在超过 64 个线程时崩溃

> ID：11160485
> 
> 赞同：0
> 
> 时间：2012-06-22T16:37:06.987
> 
> 标签：c++, windows, multithreading, winapi

EnterCriticalSection() 是否有线程限制？以下代码适用于 64 个线程，但在使用 65 个或更多线程时会崩溃：

```
CRITICAL_SECTION TestCritSection;

unsigned int threadId;

int getThreadId()
{
    int tid = -1;

    EnterCriticalSection(&TestCritSection);

    tid= threadId;
    threadId++;

    LeaveCriticalSection(&TestCritSection);

    return tid;
}

void parallelTest()
{
    int tid = getThreadId();
    cout << "Thread " << tid << " executed" << endl;
}

void
multiThreadTest()
{
    unsigned int numThreads = 64; // fine, but program crashes when numThreads is set to 65 or more
    HANDLE *threads = new HANDLE[numThreads];
    DWORD ThreadID;
    threadId = 1;

    if (!InitializeCriticalSectionAndSpinCount(&TestCritSection, 0x00000400)) return;

    for (int i=0; i<numThreads; ++i)
    {
        threads[i] = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE) parallelTest, (LPVOID) NULL, 0, &ThreadID);
    }

    WaitForMultipleObjects(numThreads, threads, TRUE, INFINITE);

    DeleteCriticalSection(&TestCritSection);

    for (int i=0; i<numThreads; ++i)
    {
        CloseHandle(threads[i]);
    }

    delete [] threads;
} 
```

我猜 CRITICAL_SECTION 在内部使用最大计数为 64 的信号量。我能以某种方式改变它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T10:13:33.180

由于没有人愿意回答我的问题，我将根据 HansPassant 对我的问题的评论自己回答。

他指出问题是`WaitForMultipleObjects()`，它需要一个参数

> nCount [in]
> 
> ```
> The number of object handles in the array pointed to by lpHandles. 
> ```
> 
> 对象句柄的最大数量是 MAXIMUM_WAIT_OBJECTS。此参数不能为零。

（来自[msdn](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687025%28v=vs.85%29.aspx)）

`MAXIMUM_WAIT_OBJECTS`被定义为 64，更多信息在[这个](https://stackoverflow.com/questions/5131807/is-maximum-wait-objects-really-64)线程中。

这意味着：是的，线程数量有硬编码限制，但限制不是 on`EnterCriticalSection`而是 on `WaitForMultipleObjects`，它返回一个我应该检查的错误代码。

[以下](https://stackoverflow.com/questions/5136775/increasing-maximum-wait-objects-for-waitformultipleobjects)是有关如何让超过 64 个线程并行工作的更多信息。

# asp.net - aspnet_merge 导致 dll not found 错误

> ID：11160487
> 
> 赞同：0
> 
> 时间：2012-06-22T16:37:20.313
> 
> 标签：asp.net, aspnet-compiler, aspnet-merge

我使用 aspnet_compiler 来预编译一个 asp.net 网站。然后，我运行 aspnet_merge 将预编译的程序集合并为一个。

不幸的是，aspnet_merge 在其合并过程中不包括其中一个程序集。因此，该组件保持不变。更不幸的是，这个程序集引用了一个*确实*被合并（现在已被删除）的程序集，并且这个引用没有被 aspnet_merge 更新。因此，当使用此 dll 时，我得到一个*FileNotFoundException“无法加载文件或程序集” 。*

到目前为止，我发现在预编译步骤之后，大多数程序集都被命名为

```
App_Web_xxxxxxxx.dll. 
```

而有问题的 dll 的名称如下：

```
App_Web_nameofusercontrol.ascx.xxxxxxxx.dll 
```

我想这就是 aspnet_merge 忽略它的原因。我通过使用 -log 选项确认 aspnet_merge 会忽略它，它会生成一个输入程序集列表。

我这样调用 aspnet_compiler 和 aspnet_merge ：

```
aspnet_compiler.exe -v VirtualDirectoryName -p ActualDirectory c:\precompileoutput
aspnet_merge.exe c:\precompileoutput -o mergeddllname 
```

我目前正在查看反编译的 aspnet_merge 代码，试图弄清楚它在决定合并哪些 dll 时采用什么逻辑，但也许有人以前见过这个问题或有建议？

我正在寻找一种方法让 aspnet_compiler 生成 aspnet_merge 理解的 dll，或者让 aspnet_merge 更新所有引用它删除的任何 app_web* dll 的程序集。谢谢！

**更新**：aspnet_merge 忽略 App_Web_nameofusercontrol.ascx.xxxxxxxx.dll，因为 aspnet_compiler 不会生成相应的 .compiled 文件。此外，用户控件似乎也被编译到 App_Web_xxxxxxxx.dll 程序集中之一。但是，我不知道为什么同一个用户控件被编译成两个不同的程序集。也许是一个奇怪的循环引用问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:13:30.000

结果发现问题是由文件夹 A 中的一个用户控件 U1 引用文件夹 B 中的另一个控件 U2 引起的，而文件夹 B 中的第三个控件 u3 引用了 U1，从而导致循环引用。将 U2 移动到文件夹 A 似乎可以解决问题。

# mysql - 子选择不遵守 GROUP BY

> ID：11160488
> 
> 赞同：2
> 
> 时间：2012-06-22T16:37:21.793
> 
> 标签：mysql, sql

尝试过一百万种不同的方法后，我似乎无法正确选择“count_lonely_vehicles”。'count_lonely_vehicles' 子选择当前只计算一个车辆 ID 关联的照片总数，但不像其他选择那样对经销商.id 进行分组。

```
dealerships (has many vehicles)
-----------
id | name

vehicles (has many photos and belongs to dealership)
--------
id | dealership_id

photos (belongs to vehicle)
------
id | vehicle_id

SELECT DISTINCT
    dealerships.id,
    dealerships.name,
    COUNT(photos.id) AS 'count_photos',
    FLOOR(COUNT(photos.id) / COUNT(DISTINCT vehicles.id)) AS 'photos_per_vehicle',
    (
        SELECT COUNT(*)
        FROM (
            SELECT COUNT(photos.vehicle_id) AS 'count'
            FROM photos
            GROUP BY photos.vehicle_id
            HAVING COUNT(photos.vehicle_id) = 1
        ) AS tbl
    ) AS 'count_lonely_vehicles'
FROM dealerships
JOIN vehicles ON vehicles.dealership_id = dealerships.id
JOIN photos ON photos.vehicle_id = vehicles.id
GROUP BY dealerships.id
ORDER BY count_photos DESC 
```

因此，当在模板中循环遍历经销商数组并吐出“count_lonely_vehicles”时，它始终是相同的数字。预期的行为是收集照片记录的数量，每个经销商只有一个 vehicle_id 关联。

我怎样才能重写这个查询来完成这个？

## 编辑：已回答

在所选答案的帮助下，这个查询终于奏效了。还必须修复一些在所选答案中错误的字段名称。

```
SELECT
    dealerships.id,
    dealerships.name,
    COUNT(photos.id) AS 'count_photos',
    FLOOR(COUNT(DISTINCT photos.id) / COUNT(DISTINCT vehicles.id)) AS 'photos_per_vehicle',
    l.num_lonely
FROM dealerships
JOIN vehicles ON vehicles.dealership_id = dealerships.id
JOIN photos ON photos.vehicle_id = vehicles.id
LEFT OUTER JOIN (
    SELECT
        v.dealership_id,
        COUNT(*) AS num_lonely
    FROM dealerships d
    JOIN vehicles v ON v.dealership_id = d.id
    JOIN (
        SELECT p.vehicle_id
        FROM photos p
        GROUP BY p.vehicle_id
        HAVING COUNT(*) = 1
    ) p ON p.vehicle_id = v.id
    GROUP BY d.id
) l ON vehicles.dealership_id = l.dealership_id

GROUP BY dealerships.id
ORDER BY count_photos DESC 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T16:47:24.827

您需要加入经销商信息才能获得您想要的东西。我更喜欢通过将子查询移动到“FROM”子句中来做到这一点：

```
FROM dealerships JOIN
     vehicles
     ON vehicles.dealership_id = dealerships.id JOIN
     photos ON photos.vehicle_id = vehicles.id left outer join
     (select d.dealership_id, count(*) as num_lonely
      from dealerships d JOIN
           vehicles v
           ON v.dealership_id = d.id JOIN
           (select p.vehicle_id
            from photos p
            group by p.vehicle_id
            having count(*) = 1
           ) p
           ON p.vehicle_id = v.id
     group by d.dealership_id
     ) l
     on d.dealership_id = l.dealership_id 
```

您还可以通过加入表并执行相关子查询来修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:47:29.290

您需要在子查询中获取主要经销商 ID 值。尝试这个：

```
SELECT DISTINCT
    dealerships.id,
    dealerships.name,
    COUNT(photos.id) AS 'count_photos',
    FLOOR(COUNT(photos.id) / COUNT(DISTINCT vehicles.id)) AS 'photos_per_vehicle',
    (
        SELECT COUNT(*)
        FROM (
            SELECT COUNT(photo2.vehicle_id) AS 'count'
            FROM photos photo2
            JOIN vehicles vehicle2 on photo2.vehicle_id = vehicle2.vehicle_id 
            WHERE vehicle2.dealership_id = dealerships.dealership_id
            GROUP BY photo2.vehicle_id
            HAVING COUNT(photo2.vehicle_id) = 1
        ) AS tbl
    ) AS 'count_lonely_vehicles'
FROM dealerships
JOIN vehicles ON vehicles.dealership_id = dealerships.id
JOIN photos ON photos.vehicle_id = vehicles.id
GROUP BY dealerships.id
ORDER BY count_photos DESC 
```

# tsql - 删除没有键链接的光标

> ID：11160492
> 
> 赞同：0
> 
> 时间：2012-06-22T16:37:48.060
> 
> 标签：tsql, sql-server-2005

以为我已经解决了这个问题，但它又回来了！！试图消除我正在重构的存储过程上的最后一个光标。

我的问题是我没有将表中的列加载到游标中以链接到我的#UTM2 表以消除游标并将其全部带回一组。有解决方法吗？？？

```
 DECLARE @ChannelId INT, 
         @URLSignature Varchar(30), 
         @RawSQL VARCHAR(2000), 
         @SQLQuery VARCHAR(4000), 
         @ThisUTMId BIGINT  

 DECLARE cursChannels CURSOR STATIC 
     FOR 
     SELECT ChannelId, URLSignature, RawSQL  
     FROM dbo.TrackingChannel_tbl (NOLOCK)  
     WHERE ProcessVisitDate = 1  

  IF @URLSignature <> ''  
  SET @SQLQuery = @SQLQuery + 'AND u.RawURLRequest like ''%' + @URLSignature + '%'' '    

  IF @RawSQL <> ''  
  SET @SQLQuery = @SQLQuery + @RawSQL  

  EXEC (@SQLQuery)  

INSERT INTO dbo.TrackingChannelDailyTotal_tbl 
           (ChannelId, TrackingDate, Conversions, TotalMargin)  
SELECT @ChannelId, @ConvDate, Count(u1.trpUTMID), IsNUll(SUM(TotalMargin),0)  
FROM #UTM u1 
JOIN #UTM2 u2 
ON u1.TRputmid = u2.trputmid  

FETCH cursChannels INTO @ChannelId, @URLSignature, @RawSQL 
```

修正，如何填充#temp 表

```
 CREATE TABLE #UTM 
      (trpUTMID BIGINT PRIMARY KEY, 
       TotalMArgin MONEY, 
       RawURLRequest Varchar(2000), 
       Keywords VARCHAR(1000), VisitDate DATETIME, 
       RefererURL VARCHAR(2000))  

    INSERT INTO #UTM (trputmid, TotalMargin)  
       SELECT trpUTMID, SUM(b.TotalMArgin)  
       FROM TrackingConversion_tbl  c (NOLOCK) 
       JOIN  Booking_tbl b (NOLOCK)             
       ON c.BookingId = b.BookingId 
       WHERE
          c.bookedDate > @convDate 
       GROUP BY trputmid  

    UPDATE u  
       SET RawURLRequest = v.RawURLRequest,  
           Keywords = v.Keywords,  
           VisitDate = v.VisitDate,  
           RefererURL = v.RefererURL  
      FROM #UTM u,    
           TrackingVisit_tbl (NOLOCK)  v   
      WHERE v.trpUTMID = u.trpUTMId 
```

希望取得成果

```
ChannelId  TrackingDate             Conversions  TotalMargin
---------  -----------------------  -----------  -----------
1          2012-03-14 00:00:00.000  0            0.00
2          2012-03-14 00:00:00.000  22           557.0296
3          2012-03-14 00:00:00.000  0            0.00 
```

直到当前日期的每一天或 41 个频道

# hadoop - 如何在hadoop上处理大量图像

> ID：11160493
> 
> 赞同：0
> 
> 时间：2012-06-22T16:37:51.683
> 
> 标签：hadoop, hdfs

我想在 HDFS 上处理大量小图像。Hadoop 提供归档 API 和顺序文件格式来存储大量小文件，以节省名称节点上的内存。但是，我需要在 map-reduce 之后检索符合我要求的图像。我不确定，但我认为从存档和顺序文件格式中检索图像可能很困难。但是如果我们不使用这些方法，我们可以选择返回文件的路径并让服务器通过这些路径从 HDFS 下载这些图像，尽管这可能会给 namenode 带来更大的压力。我无法决定使用哪种方案。任何人都可以提出任何建议吗？我真的很好奇谷歌如何将他们的图像存储在其数据中心并返回这些图像以响应用户的查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:23:01.253

您应该看看 HBase，它一方面允许您存储小文件和随机读/写，另一方面完全参与 map/reduce 作业

# android - ListView下的按钮在Android中不可见

> ID：11160497
> 
> 赞同：9
> 
> 时间：2012-06-22T16:38:10.500
> 
> 标签：android, xml-layout

我正在研究一些`ListView`我想`Button`在它下面显示的我正在使用以下代码，但这不起作用。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

<ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:cacheColorHint="#00000000"
    android:drawSelectorOnTop="false" />

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button" />

</LinearLayout> 
```

按钮不可见，为什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-22T16:51:12.470

列表视图占据整个页面。尝试为代码中的元素赋予所需的权重。使用此代码，

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

<ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:cacheColorHint="#00000000"
    android:drawSelectorOnTop="false"
    android:layout_weight="5" />

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button"
    android:layout_weight="1" />

</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-22T16:42:12.050

发生这种情况是因为`ListView`将高度设置为`wrap_content`，这使得它可以扩展以容纳所有项目，在屏幕上没有为按钮留下空间。您可以使用相对布局设置按钮沿底部，然后列表视图占用剩余空间：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button"
    android:layout_alignParentBottom="true" />

<ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:cacheColorHint="#00000000"
    android:drawSelectorOnTop="false"
    android:layout_above="@id/button1" />

</RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-07-06T11:31:24.053

我在列表视图中添加了这一行............ android:weight="1" .......... 如下所示

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

<ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:cacheColorHint="#00000000"
    android:drawSelectorOnTop="false" 
    android:weight="1" 
/>

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button" />

</LinearLayout> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-20T06:01:01.043

为此，按钮和列表视图应该在同一个线性布局中，如果所有视图都处于相对布局中，则将列表视图和按钮添加到线性布局并将列表视图权重设为 1，这对我有用。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:id="@+id/activity_shipping_address"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/background_all"
android:paddingBottom="@dimen/activity_vertical_margin"
android:paddingLeft="@dimen/activity_horizontal_margin"
android:paddingRight="@dimen/activity_horizontal_margin"
android:paddingTop="@dimen/activity_vertical_margin"
tools:context="com.reallymake.android.pottery.ShippingAddressActivity">

<Button
    android:id="@+id/button1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textView9"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="13dp"
    android:background="@drawable/button_shape"
    android:text="@string/ok"
      />

   <LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_below="@+id/btn_add_new_address"
    android:orientation="vertical">

    <ListView
        android:id="@+id/lv_addresses"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentStart="true"
        android:layout_below="@+id/list"
        android:layout_marginTop="14dp"
        android:layout_weight="1" />

    <Button
        android:id="@+id/btn2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/lv_addresses"
        android:layout_marginTop="14dp"
        android:background="@drawable/button_shape"
        android:text="@string/proceed" />
</LinearLayout> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-15T10:32:14.503

添加权重或对齐底部将使按钮始终浮动在屏幕底部。该列表将位于其下方。

如果要在向下滚动列表后显示按钮，则将按钮作为页脚添加到列表视图中。

# iphone - CoreGraphics 或 Quartz Drawing 不断清除

> ID：11160499
> 
> 赞同：0
> 
> 时间：2012-06-22T16:38:27.880
> 
> 标签：iphone, ios5, core-graphics, quartz-graphics

我在用着

penLayer 是一个 UIView

```
UIGraphicsBeginImageContext(penLayer.frame.size);

CGContextRef  context = UIGraphicsGetCurrentContext();
    //My Drawing Code
penLayer.image = UIGraphicsGetImageFromCurrentImageContext();
[penLayer setNeedsDisplay]; 
```

这画得很好，但每次我调用 drawRect 它都会清除之前的内容目前我必须将所有绘图数据保存到字典中

有没有办法阻止它在每次调用 drawRect 时清除，并且可能有一个 UIButton 在需要时调用 clear ？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:43:45.937

[UIView 上`clearsContextBeforeDrawing`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/instp/UIView/clearsContextBeforeDrawing)有一个名为 的 BOOL 属性。我假设你没有使用它。从文档中的讨论：

> 设置为 时，在调用该方法`YES`之前，绘图缓冲区会自动清除为透明黑色。`drawRect:`此行为确保在重绘视图内容时不会留下任何视觉伪影。如果视图的`opaque`属性也设置为`YES`，则视图的属性`backgroundColor`不能为 nil，否则可能会出现绘图错误。此属性的默认值为`YES`。
> 
> 如果将此属性的值设置为`NO`，则您有责任确保视图的内容在您的`drawRect:`方法中正确绘制。如果您的绘图代码已经进行了高度优化，则将此属性设置为 NO 可以提高性能，尤其是在滚动期间，可能只需要重绘视图的一部分。

# c++ - 有没有办法区分来 自两个模板化基类的这些函数调用？

> ID：11160501
> 
> 赞同：-1
> 
> 时间：2012-06-22T16:38:32.243
> 
> 标签：c++, templates, inheritance, virtual-functions

我有以下情况： -

```
template <typename T>
class Base {
  public:
    virtual void someFunc() {}
};

class Derived : public Base<int>,
                public Base<float> {
  public:
    virtual void someFunc() { 
      // do something different if Base<int> than if Base<float>
    }
};

Derived *d = new D();
Base<int>* b1 = (Base<int>*) d;
Base<float>* b2 = (Base<float>*) d;

b1->someFunc();
b2->someFunc(); 
```

我希望能够区分这两个函数调用。或者换句话说，用不同的函数体覆盖两个基本函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:12:24.520

您可以使用 shim（这适用于基类之间的任何名称冲突实例，无论是否与模板相关）：

```
template <typename T>
class Base
{
  public:
    virtual void someFunc() {}
};

class IntShim : public Base<int>
{
  protected:
    virtual void someFuncViaInt() = 0;
  public:
    virtual void someFunc() { return someFuncViaInt(); }
};

class FloatShim : public Base<float>
{
  protected:
    virtual void someFuncViaFloat() = 0;
  public:
    virtual void someFunc() { return someFuncViaFloat(); }
};

class Derived : public IntShim, public FloatShim
{
  protected:
    virtual void someFuncViaInt()
    { 
      // do something for Base<int>
    }
    virtual void someFuncViaFloat()
    { 
      // do something for Base<float>
    }
};

Derived *d = new D();
Base<int>* b1 = (Base<int>*) d;
Base<float>* b2 = (Base<float>*) d;

b1->someFunc();
b2->someFunc(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:12:10.797

您可以实现这一点的一种方法是将虚拟参数添加到`someFunc`on `Base`：

```
virtual void someFunc(T *dummy = nullptr); 
```

在派生类中，您的覆盖是然后

```
virtual void someFunc(int *);
virtual void someFunc(float *); 
```

而不是`T *`你可以创建一个空类型

```
template<typename T> struct dispatch {};
...
virtual void someFunc(dispatch<T> = dispatch<T>());
...
virtual void someFunc(dispatch<int>);
virtual void someFunc(dispatch<float>); 
```

这消除了传递 nullptr 的（最小）开销，并有助于阐明参数的用途。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T17:12:21.650

您不需要为此使用虚拟函数和派生类。您可以将 Base 类中的函数专门用于已知类型。

你可以做某事。像这样：

```
template <typename T>
class Base {
  public:
    void someFunc()
    {
        // default implementation for any type
    }
};

// specialization for int
template<> void Base<int>::someFunc()
{
}

// specialization for float
template<> void Base<float>::someFunc()
{
}

int main(int argc, char** argv)
{
    Base<int>* b1 = new Base<int>();
    Base<float>* b2 = new Base<float>();

    b1->someFunc();
    b2->someFunc();
} 
```

# wpf - WPF 容器/网格布局

> ID：11160502
> 
> 赞同：2
> 
> 时间：2012-06-22T16:38:32.557
> 
> 标签：wpf, layout, grid, containers

我需要创建一个可以显示 3 种不同控件类型的集合的 WPF 容器。每个控件的高度和宽度都基于其他控件。例如，如果 controlA 为 200X200，则 controlB 为 100X200，controlC 为 50X50。我需要找出如何通过根据可用空间和每种控件类型的数量找到最佳布局来创建足够智能的容器来安排这些控件。

以下面的例子为例，我们有 1 个 controlA 实例、1 个 controlB 实例和 2 个 controlC 实例。请注意，与顺序控件列表相比，它是如何优雅地定位给它一个紧凑的外观。

[容器 http://onlinegolfpool.com/images/grid.png](http://onlinegolfpool.com/images/grid.png)

关于如何解决的任何想法？我应该使用网格并自己计算吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:42:07.707

您绝对应该使用 Grid，但甚至不要考虑自己计算它 :) 使用星号 (*) 定义每个单元格的相对大小。WPF 将为您完成剩下的工作。

例子：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="2*"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="*"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <Rectangle Fill="Pink" Stroke="Black" Grid.RowSpan="2"/>
    <Rectangle Fill="Blue" Stroke="Black" Grid.Column="1" Grid.ColumnSpan="2"/>
    <Rectangle Fill="Yellow" Stroke="Black" Grid.Row="1" Grid.Column="1"/>
    <Rectangle Fill="Yellow" Stroke="Black" Grid.Row="1" Grid.Column="2"/>
</Grid> 
```

Asterisk 非常强大，很多人甚至都不知道它:) 享受吧！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:46:30.863

我的建议是使用堆栈面板而不是网格面板。然后为您想要的任何控件提供硬编码宽度，该区域的其余部分将自行调整。

```
<StackPanel Orientation=Horizontal>
    <leftcontrol/>
    <StackPanel Orientation=Vertical>
        <firstcontrol/>
        <StackPanel Orientation=Horizontal>
            <bottomLeftControl/>
            <bottomRightControl/>
        </StackPanel> 
    </StackPanel>
</StackPanel> 
```

# python - 从 Python 运行 Expect 脚本的最简单方法

> ID：11160504
> 
> 赞同：9
> 
> 时间：2012-06-22T16:38:36.117
> 
> 标签：python, ssh, subprocess, expect

我正在尝试指示我的 Python 安装执行[Expect](https://en.wikipedia.org/wiki/Expect)脚本“myexpect.sh”：

```
#!/usr/bin/expect
spawn ssh usr@myip
expect "password:"
send "mypassword\n";
send "./mycommand1\r"
send "./mycommand2\r"
interact 
```

我在 Windows 上，因此无法将 Expect 脚本中的行重写为 Python。有什么建议么？有什么东西可以像“./myexpect.sh”那样从 bash shell 运行吗？

* * *

我使用 subprocess 命令取得了一些成功：

```
subprocess.call("myexpect.sh",  shell=True) 
```

我收到错误：

> myexpect.sh 不是有效的 Win32 应用程序。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-22T16:41:54.860

使用[pexpect 库](http://pexpect.readthedocs.org/en/stable/index.html)。这是 Expect 功能的 Python 版本。

例子：

```
child = pexpect.spawn('Some command that requires password')
child.expect('Enter password:')
child.sendline('password')
child.expect(pexpect.EOF, timeout=None)
cmd_show_data = child.before
cmd_output = cmd_show_data.split('\r\n')
for data in cmd_output:
    print data 
```

Pexpect 提供了许多可供学习的示例。要使用 interact()，请查看`script.py`示例：

*   [https://github.com/pexpect/pexpect/tree/master/examples](https://github.com/pexpect/pexpect/tree/master/examples)

（对于 Windows，有 pexpect 的替代方法。）

*   *[我可以在不安装 Cygwin 的情况下在 Windows 上使用 Expect 吗？](https://stackoverflow.com/questions/1042778/can-i-use-expect-on-windows-without-installing-cygwin)*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-28T20:17:19.287

由于它是一个 .expect 脚本，我认为您应该更改脚本的扩展名。

而不是使用

```
subprocess.call("myexpect.sh", shell=True) 
```

你应该使用

```
subprocess.call("myexpect.expect", shell=True) 
```

# javascript - Javascript 生成的验证码

> ID：11160510
> 
> 赞同：1
> 
> 时间：2012-06-22T16:39:15.237
> 
> 标签：javascript, python, html, mechanize, captcha

如果你们去[这个](https://edit.yahoo.com/registration?.src=fpctx&.intl=us&.done=http://www.yahoo.com/)页面，你会看到一个验证码。但是，每当我使用 Python 的 mechanize 模块加载此页面时，我都不会在 HTML 中获得标签。这让我觉得它是使用 Javascript 生成的。但是，如果我在浏览器中访问该页面，我可以“检查元素”并找到图像标签。你们知道我可以用什么方法来自动完成获取验证码的任务吗？我在这里有点不知所措......

非常感谢，

贾斯汀

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:00:24.217

验证码 DOM 元素通过 javascript 插入，验证码图像本身在服务器端创建，然后显示在页面中。

自己创建相同验证码信息的唯一两种方法是：

1.  让页面中的 javascript 运行，然后以某种方式获取 javascript 创建的 DOM 元素。

2.  对他们的验证码插入代码进行逆向工程，并尝试弄清楚它在做什么，这样您就可以运行自己的代码来创建类似的东西。

在他们的验证码处理中也至少有几个 ajax 调用。也许如果你能解释你真正想要完成的事情，我们可以提供一些更好的想法。希望您不会尝试自动填写验证码，因为它的目的是防止这种情况发生。

# mysql - NOT IN() 在 mysql 中返回奇怪的结果

> ID：11160512
> 
> 赞同：1
> 
> 时间：2012-06-22T16:39:18.847
> 
> 标签：mysql

我有这个mysql语句：

```
SELECT  `review_userid` ,  `book_id` ,  `review_id` ,  `user_class` , COUNT( review_id ) 
FROM  `booklist_books` 
LEFT JOIN  `booklist_reviews` ON booklist_books.book_id = booklist_reviews.review_bookid
LEFT JOIN  `e107_user` ON booklist_reviews.review_userid = e107_user.user_id
WHERE '12' NOT IN (`user_class`)
GROUP BY  `review_userid` 
ORDER BY COUNT(`review_id`) DESC 
LIMIT 0 , 100 
```

`user_class`是一个逗号分隔的字符串（例如：1,2,3,4,5），如下所示。

使用 phpmyadmin，我得到以下结果：

![mysql结果](../Images/aec27176b2c64488fe05db77d8f8bf56.png)

为什么我使用的结果在 user_class 字段中有“12” `'12' NOT IN(...` ？

如果我不能`user_class`在 IN() 运算符中使用，有什么替代方法？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:44:23.657

`IN`或者`NOT IN`不是那样工作，检查函数[FIND_IN_SET](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set)

```
WHERE FIND_IN_SET('12', `user_class`) = 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:44:08.977

语法是 expr IN (value,...)

```
WHERE `user_class` NOT IN ('12') 
```

如果两个或多个表使用相同的列名，则说明不明确，您需要为表添加前缀或昵称，以明确定义您正在调用的列。

```
WHERE table.column NOT IN ('12') 
```

昵称：

```
SELECT table a, table2 b 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T16:45:00.053

`value IN (...)`检查是否`value`是 中列出的项目之一`(...)`。在您的情况下，列表仅包含一个值：`user_class`列的值。string`'12'`不等于 string `'3,6,9,12'`，因此找不到匹配项。`IN`不在列值中搜索匹配的子字符串。

因为您在一个字段中有多个逗号分隔的值，所以您希望使用[`FIND_IN_SET()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_find-in-set).

* * *

如果您可以选择重组数据，您应该使用[数据库规范化](http://en.wikipedia.org/wiki/Database_normalization)来避免在一个字段中有多个值的混乱。

# angularjs - AngularJS ng-options 创建范围

> ID：11160513
> 
> 赞同：42
> 
> 时间：2012-06-22T16:39:21.353
> 
> 标签：angularjs

我正在尝试创建一个选择元素，其中包含数字 1 到页面的列表，其中 pages 是一个变量，即我拥有的页数。我不知道该怎么做是构造 ng-options 表达式，以便它给我我需要的数字。这是我到目前为止所拥有的

```
<select ng-model="page" ng-options="???"></select> 
```

我需要在 ng-options 表达式中添加什么才能创建我的选择

```
<select>
    <option value="1">1</option>
    ...
    <option value="35">35</option>
</select> 
```

我是否需要创建一个函数来返回一个数字数组并以某种方式在其中使用它，还是有更简单的方法来做到这一点？

任何帮助将不胜感激。

谢谢

**编辑**

在发布我的问题后，我想出了一种方法，方法是在我的控制器中创建一个名为 Range 的函数，该函数接受两个数字并返回一个包含该范围内所有值的数组。

```
$scope.Range = function(start, end) {
    var result = [];
    for (var i = start; i <= end; i++) {
        result.push(i);
    }
    return result;
}; 
```

然后在我做的HTML中

```
<select ng-name="page" ng-options="page for page in Range(1, pages)"></select> 
```

这是最简单的方法还是有更好的方法？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-06-22T17:36:05.670

你的方法很好。我想到的另一个选择是使用过滤器，这样您就不必用 Range 污染控制器。

JS：

```
var myApp = angular.module('myApp', []);
myApp.filter('range', function() {
  return function(input, min, max) {
    min = parseInt(min); //Make string input int
    max = parseInt(max);
    for (var i=min; i<max; i++)
      input.push(i);
    return input;
  };
}); 
```

HTML：

```
<select ng-model="page" ng-options="n for n in [] | range:1:30"></select> 
```

示例：http: [//jsfiddle.net/N3ZVp/1/](http://jsfiddle.net/N3ZVp/1/)

PS 在您的主要帖子中的示例中，您没有`var`放在`i`. 所以`i`在您的示例中被声明为全局变量。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-12-23T21:04:45.330

将其全部保存在模板中的另一种解决方案：

```
<select>
  <option ng-repeat="n in [].constructor(10) track by $index+1">{{$index+1}}</option>
</select> 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-23T10:07:51.353

请添加 ng-model，如下所示

```
<select ng-model="test" ng-options="n for n in [] | range:1:30"></select> 
```

在此之后，您的示例将在 jsfiddle 中工作

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-01-29T22:19:24.773

另一种没有 for 循环的方法是：

控制器：

```
 $scope.arr = [];
 $scope.arr.length = count; 
```

视图绑定：

```
 ng-options="arr.indexof(i) for i in arr" 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-05-28T11:28:57.217

安迪的解决方案很棒，但是范围不能倒退。这是改进的版本：

```
/* 
 * Creates a range
 * Usage example: <option ng-repeat="y in [] | range:1998:1900">{{y}}</option>
 */
myApp.filter('range', function() {
  return function(input, start, end) {    
    start = parseInt(start);
    end = parseInt(end);
    var direction = (start <= end) ? 1 : -1;
    while (start != end) {
        input.push(start);
        start += direction;
    }
    return input;
  };
}); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-05-28T05:48:52.073

捎带马蒂纳斯的回答。我对其进行了修改以包含范围中的最后一个值：

```
/*
 * Creates a range
 * Usage example: <option ng-repeat="y in [] | range:1998:1900">{{y}}</option>
 */

.filter('range', function () {
    return function (input, start, end) {
        var direction;

        start = parseInt(start);
        end = parseInt(end);

        if (start === end) { return [start]; }

        direction = (start <= end) ? 1 : -1;

        while (start != end) {
            input.push(start);

            if (direction < 0 && start === end + 1) {
                input.push(end);
            }

            if (direction > 0 && start === end - 1) {
                input.push(end);
            }

            start += direction;
        }

        return input;
    };
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-18T22:33:17.157

在 CoffeeScript 中：

```
app.filter 'range', ->
  (input, min, max) ->
    input.push(i) for i in [parseInt(min)..parseInt(max)] 
```

和 HTML：

```
<select ng-options="n for n in [] | range:1:30"></select> 
```

这是[Javascript 的要点](https://gist.github.com/Dorian/311c7563fe6af6563d6f)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-24T14:38:57.737

如果要在选择中添加占位符，请使用以下给定的解决方案。您需要首先[像这样](https://stackoverflow.com/a/11161353/1230188)定义过滤器。

```
<select>
    <option value="">-- Birth Year --</option>
    <option ng-repeat="n in [] | range:1900:2000">{{n}}</option>
</select> 
```

# extjs4 - 在 ExtJs 控制器上从 html 表单传递值

> ID：11160516
> 
> 赞同：0
> 
> 时间：2012-06-22T16:39:25.463
> 
> 标签：extjs4, extjs

我是 ExtJS 的新手，仍在学习那里的工作原理。在我的情况下，我有一个 html 页面，我通过 ajax 在我的索引页面中加载它，在这个 html 中有一个表单元素。到目前为止，我已经设法为我的表单按钮设置了一个事件侦听器，因此当我单击按钮时，事件运行良好。我不确定如何通过在我的控制器中处理表单的字段值来传递它们。

这是示例代码：

**表格：**

```
 <form id="loginform">
        <fieldset>
            <input type="text" id="usn" placeholder="User" /><br />
            <input type="password" id="pwd" placeholder="Password"/>
        </fieldset>
        <p><input type="button" id="lg" value="Enter" /></p>
    </form> 
```

**我的观点：**

```
Ext.define('App.view.Login', {
extend: 'Ext.container.Container',
alias: 'widget.login',

renderTo: 'wrap',

initComponent: function() {

    this.items = [{ 
        loader: {
            autoLoad: true,
            url: "web/login.html",
            renderer: function(loader, response, active) {
                var res = response.responseText;
                loader.getTarget().update(res);
            }
        }    
    }];

    this.addEvents('loginUser');

    this.callParent(arguments);
},

afterRender: function() {
    this.mon(this.el, 'click', this.onUserClick, this, {
        delegate: '#lg'
    });

    this.callParent(arguments);
},

onUserClick: function(ev, t) {
    ev.stopEvent();

    var params = Ext.fly(t).getAttribute('value');

    this.fireEvent('loginUser', params, this, ev);
} 
```

});

**控制器：**

```
Ext.define('App.controller.Login', {
extend: 'Ext.app.Controller',

views: [ 'Login' ], 

refs: [{
    selector: 'login',
    ref: 'login'
}],

init: function() {

    this.control({

        'login':{

            loginUser: this.onLoginAuth

        }
    });
},

onLoginAuth: function(params, component, event){

    Ext.widget('users');

    this.getLogin().destroy();

} 
```

});

有人知道我们如何实现它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T05:47:32.610

我认为你误解了extjs。主要是我使用 extjs 来实现浏览器兼容性。我们不是直接写html，extjs为我们做。

在 html 端，我们只包含 extjs 库和 app.js

```
<html>
  <head>
<title>Account Manager</title>

<link rel="stylesheet" type="text/css" href="ext-4/resources/css/ext-all.css">

<script type="text/javascript" src="ext-4/ext-debug.js"></script>

<script type="text/javascript" src="app.js"></script>
</head>
<body></body>
</html> 
```

在 app.js 中

每个 Ext JS 4 应用程序都以 Application 类的一个实例开始。Application 包含应用程序的全局设置（例如应用程序的名称），并维护对应用程序使用的所有模型、视图和控制器的引用。应用程序还包含一个启动功能，该功能在加载所有内容时自动运行。

检查[http://docs.sencha.com/ext-js/4-1/#/guide/application_architecture](http://docs.sencha.com/ext-js/4-1/#/guide/application_architecture)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T06:25:05.213

正如其他海报所说，使用 Ext.form 类更有意义，但是如果你必须这样做：

```
this.fireEvent('loginUser', this, Ext.getDom('usn').value, Ext.getDom('pwd').value); 
```

# android - 自动完成 TextView 从 android 中的服务器填充

> ID：11160519
> 
> 赞同：2
> 
> 时间：2012-06-22T16:39:42.823
> 
> 标签：android, autocompletetextview

我需要从服务器获取数据并填充到 android 的 autocompleteTextView 中。我在 onPerformFiltering() 中获取并在 onPublishResults() 中显示的地方使用了自定义过滤器。但是我不需要为每个字符更改从服务器获取数据。我需要为特定长度的字符执行此操作。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-21T11:26:31.623

```
class ProcessUpdater extends AsyncTask <Void, Void, Void>{

            @Override
            protected Void doInBackground(Void... params) {
                // TODO Auto-generated method stub

                    DefaultHttpClient httpclient = new DefaultHttpClient();
                    HttpGet httpget = new HttpGet("url");
                    HttpResponse response = httpclient.execute(httpget);
                    BufferedReader in = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));
                    StringBuffer sb = new StringBuffer("");
                    String line = "";
                    String NL = System.getProperty("line.separator");
                    while ((line = in.readLine()) != null) {
                        sb.append(line + NL);
                    }
                    in.close();
                    String result = sb.toString();
                    Log.v("My Response :: ", result);
                    JSONObject jsonObject = new JSONObject(result);
                    JSONArray resultArray = jsonObject.getJSONArray("Process");
                    for (int i = 0; i < resultArray.length(); i++) {
                        JSONObject c = resultArray.getJSONObject(i);
                        String sbs = c.getString("ProcessCode");
                        ProcessList.add(sbs);
                    }
                } catch (Exception e) {
                    // TODO: handle exception
                }
                return null;
            }
            @Override
            protected void onPostExecute(Void result) {
                SelectProcess.setAdapter(new ArrayAdapter<String>(youractivtyname.this, android.R.layout.simple_dropdown_item_1line, ProcessList));

            }
        } 
```

# mysql - 为什么并行执行查询时 MySQL 的性能会下降？

> ID：11160522
> 
> 赞同：14
> 
> 时间：2012-06-22T16:40:07.177
> 
> 标签：mysql, performance, perl

**问题**：为什么并行执行时连接几乎空表的查询的 MySQL 性能下降？

以下是对我所面临问题的更详细说明。我在 MySQL 中有两个表

```
CREATE TABLE first (
    num int(10) NOT NULL,
    UNIQUE KEY key_num (num)
) ENGINE=InnoDB

CREATE TABLE second (
    num int(10) NOT NULL,
    num2 int(10) NOT NULL,
    UNIQUE KEY key_num (num, num2)
) ENGINE=InnoDB 
```

第一个包含大约一千条记录。第二个是空的或包含很少的记录。它还包含与问题有关的双索引：单索引问题就消失了。现在我正在尝试对这些表并行进行许多相同的查询。每个查询如下所示：

```
SELECT first.num
FROM first
LEFT JOIN second AS second_1 ON second_1.num = -1 # non-existent key
LEFT JOIN second AS second_2 ON second_2.num = -2 # non-existent key
LEFT JOIN second AS second_3 ON second_3.num = -3 # non-existent key
LEFT JOIN second AS second_4 ON second_4.num = -4 # non-existent key
LEFT JOIN second AS second_5 ON second_5.num = -5 # non-existent key
LEFT JOIN second AS second_6 ON second_6.num = -6 # non-existent key
WHERE second_1.num IS NULL
  AND second_2.num IS NULL
  AND second_3.num IS NULL
  AND second_4.num IS NULL
  AND second_5.num IS NULL
  AND second_6.num IS NULL 
```

我遇到的问题是，在 8 核机器上性能几乎没有线性提升，实际上我有下降。即有一个进程，我每秒的典型请求数约为 200。有两个进程而不是预期的每秒增加 300 - 400 个查询，我实际上下降到 150 个。对于 10 个进程，我只有 70 个查询每秒。我用于测试的 Perl 代码如下所示：

```
#!/usr/bin/perl

use strict;
use warnings;

use DBI;
use Parallel::Benchmark;
use SQL::Abstract;
use SQL::Abstract::Plugin::InsertMulti;

my $children_dbh;

foreach my $second_table_row_count (0, 1, 1000) {
    print '#' x 80, "\nsecond_table_row_count = $second_table_row_count\n";
    create_and_fill_tables(1000, $second_table_row_count);
    foreach my $concurrency (1, 2, 3, 4, 6, 8, 10, 20) {
        my $bm = Parallel::Benchmark->new(
            'benchmark' => sub {
                _run_sql();
                return 1;
            },
            'concurrency' => $concurrency,
            'time' => 3,
        );
        my $result = $bm->run();
    }
}

sub create_and_fill_tables {
    my ($first_table_row_count, $second_table_row_count) = @_;
    my $dbh = dbi_connect();
    {
        $dbh->do(q{DROP TABLE IF EXISTS first});
        $dbh->do(q{
            CREATE TABLE first (
                num int(10) NOT NULL,
                UNIQUE KEY key_num (num)
            ) ENGINE=InnoDB
        });
        if ($first_table_row_count) {
            my ($stmt, @bind) = SQL::Abstract->new()->insert_multi(
                'first',
                ['num'],
                [map {[$_]} 1 .. $first_table_row_count],
            );
            $dbh->do($stmt, undef, @bind);
        }
    }
    {
        $dbh->do(q{DROP TABLE IF EXISTS second});
        $dbh->do(q{
            CREATE TABLE second (
                num int(10) NOT NULL,
                num2 int(10) NOT NULL,
                UNIQUE KEY key_num (num, num2)
            ) ENGINE=InnoDB
        });
        if ($second_table_row_count) {
            my ($stmt, @bind) = SQL::Abstract->new()->insert_multi(
                'second',
                ['num'],
                [map {[$_]} 1 .. $second_table_row_count],
            );
            $dbh->do($stmt, undef, @bind);
        }
    }
}

sub _run_sql {
    $children_dbh ||= dbi_connect();
    $children_dbh->selectall_arrayref(q{
        SELECT first.num
        FROM first
        LEFT JOIN second AS second_1 ON second_1.num = -1
        LEFT JOIN second AS second_2 ON second_2.num = -2
        LEFT JOIN second AS second_3 ON second_3.num = -3
        LEFT JOIN second AS second_4 ON second_4.num = -4
        LEFT JOIN second AS second_5 ON second_5.num = -5
        LEFT JOIN second AS second_6 ON second_6.num = -6
        WHERE second_1.num IS NULL
          AND second_2.num IS NULL
          AND second_3.num IS NULL
          AND second_4.num IS NULL
          AND second_5.num IS NULL
          AND second_6.num IS NULL
    });
}

sub dbi_connect {
    return DBI->connect(
        'dbi:mysql:'
            . 'database=tmp'
            . ';host=localhost'
            . ';port=3306',
        'root',
        '',
    );
} 
```

对于比较像这样的查询并发执行以提高性能：

```
SELECT first.num
FROM first
LEFT JOIN second AS second_1 ON second_1.num = 1 # existent key
LEFT JOIN second AS second_2 ON second_2.num = 2 # existent key
LEFT JOIN second AS second_3 ON second_3.num = 3 # existent key
LEFT JOIN second AS second_4 ON second_4.num = 4 # existent key
LEFT JOIN second AS second_5 ON second_5.num = 5 # existent key
LEFT JOIN second AS second_6 ON second_6.num = 6 # existent key
WHERE second_1.num IS NOT NULL
  AND second_2.num IS NOT NULL
  AND second_3.num IS NOT NULL
  AND second_4.num IS NOT NULL
  AND second_5.num IS NOT NULL
  AND second_6.num IS NOT NULL 
```

测试结果、cpu 和磁盘使用测量在这里：

```
* 表 `first` 有 1000 行
* 表 `second` 有 6 行：`[1,1],[2,2],..[6,6]`

查询：
    SELECT first.num
    从第一
    LEFT JOIN second AS second_1 ON second_1.num = -1 # 不存在的键
    LEFT JOIN second AS second_2 ON second_2.num = -2 # 不存在的键
    LEFT JOIN second AS second_3 ON second_3.num = -3 # 不存在的键
    LEFT JOIN second AS second_4 ON second_4.num = -4 # 不存在的键
    LEFT JOIN second AS second_5 ON second_5.num = -5 # 不存在的键
    LEFT JOIN second AS second_6 ON second_6.num = -6 # 不存在的键
    在哪里 second_1.num 为空
      AND second_2.num 为空
      AND second_3.num 为空
      AND second_4.num 为空
      AND second_5.num 为空
      AND second_6.num 为空

结果：
    并发：1，速度：162.910/秒
    并发：2，速度：137.818/秒
    并发：3，速度：130.728/秒
    并发：4，速度：107.387/秒
    并发：6，速度：90.513/秒
    并发：8，速度：80.445/秒
    并发：10，速度：80.381/秒
    并发：20，速度：84.069/秒

在 6 个进程中运行查询的最后 60 分钟后的系统使用情况：
    $ iostat -cdkx 60

    平均 CPU：%user %nice %system %iowait %steal %idle
              74.82 0.00 0.08 0.00 0.08 25.02

    设备：rrqm/s wrqm/sr/sw/s rkB/s wkB/s avgrq-sz avgqu-sz await svctm %util
    sda1 0.00 0.00 0.00 0.12 0.00 0.80 13.71 0.00 1.43 1.43 0.02
    sdf10 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    sdf4 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 30.00 15.00 0.05
    sdm 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdf8 0.00 0.00 0.00 0.37 0.00 1.24 6.77 0.00 5.00 3.18 0.12
    sdf6 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    sdf9 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 0.00 0.00 0.00
    自卫队 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdf3 0.00 0.00 0.00 0.08 0.00 1.33 32.00 0.00 4.00 4.00 0.03
    sdf2 0.00 0.00 0.00 0.17 0.00 1.37 16.50 0.00 3.00 3.00 0.05
    sdf15 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdf14 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdf1 0.00 0.00 0.00 0.05 0.00 0.40 16.00 0.00 0.00 0.00 0.00
    sdf13 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    sdf5 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 50.00 25.00 0.08
    sdm2 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdm1 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdf12 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    sdf11 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    sdf7 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    md0 0.00 0.00 0.00 0.97 0.00 13.95 28.86 0.00 0.00 0.00 0.00

################################################# ##############################

查询：
    SELECT first.num
    从第一
    LEFT JOIN second AS second_1 ON second_1.num = 1 # 存在键
    LEFT JOIN second AS second_2 ON second_2.num = 2 # 存在键
    LEFT JOIN second AS second_3 ON second_3.num = 3 # 存在键
    LEFT JOIN second AS second_4 ON second_4.num = 4 # 存在键
    LEFT JOIN second AS second_5 ON second_5.num = 5 # 存在键
    LEFT JOIN second AS second_6 ON second_6.num = 6 # 存在键
    在哪里 second_1.num 不为空
      AND second_2.num 不为空
      AND second_3.num 不为空
      并且 second_4.num 不为空
      并且 second_5.num 不为空
      并且 second_6.num 不为空

结果：
    并发：1，速度：875.973/秒
    并发：2，速度：944.986/秒
    并发：3，速度：1256.072/秒
    并发：4，速度：1401.657/秒
    并发：6，速度：1354.351/秒
    并发：8，速度：1110.100/秒
    并发：10，速度：1145.251/秒
    并发：20，速度：1142.514/秒

在 6 个进程中运行查询的最后 60 分钟后的系统使用情况：
    $ iostat -cdkx 60

    平均 CPU：%user %nice %system %iowait %steal %idle
              74.40 0.00 0.53 0.00 0.06 25.01

    设备：rrqm/s wrqm/sr/sw/s rkB/s wkB/s avgrq-sz avgqu-sz await svctm %util
    sda1 0.00 0.00 0.00 0.02 0.00 0.13 16.00 0.00 0.00 0.00 0.00
    sdf10 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    sdf4 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    sdm 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdf8 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    sdf6 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 0.00 0.00 0.00
    sdf9 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    自卫队 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdf3 0.00 0.00 0.00 0.13 0.00 2.67 40.00 0.00 3.75 2.50 0.03
    sdf2 0.00 0.00 0.00 0.23 0.00 2.72 23.29 0.00 2.14 1.43 0.03
    sdf15 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdf14 0.00 0.00 0.00 0.98 0.00 0.54 1.10 0.00 2.71 2.71 0.27
    sdf1 0.00 0.00 0.00 0.08 0.00 1.47 35.20 0.00 8.00 6.00 0.05
    sdf13 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdf5 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    sdm2 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdm1 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdf12 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00
    sdf11 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 0.00 0.00 0.00
    sdf7 0.00 0.00 0.00 0.03 0.00 1.07 64.00 0.00 10.00 5.00 0.02
    md0 0.00 0.00 0.00 1.70 0.00 15.92 18.74 0.00 0.00 0.00 0.00

################################################# ##############################

这个服务器有很多可用内存。顶部示例：
    top - 19:02:59 up 4:23, 4 users, load average: 4.43, 3.03, 2.01
    任务：共 218 个，运行 1 个，睡眠 217 个，停止 0 个，僵尸 0 个
    CPU：72.8%us、0.7%sy、0.0%ni、26.3%id、0.0%wa、0.0%hi、0.0%si、0.1%st
    内存：总计 71701416k，已使用 22183980k，可用 49517436k，284k 缓冲区
    交换：总共 0k，使用 0k，免费 0k，缓存 1282768k

      PID 用户 PR NI VIRT RES SHR S %CPU %MEM TIME+ 命令
     2506 mysql 20 0 51.7g 17g 5920 S 590 25.8 213:15.12 mysqld
     9348 topadver 20 0 72256 11m 1428 S 2 0.0 0:01.45 perl
     9349 topadver 20 0 72256 11m 1428 S 2 0.0 0:01.44 perl
     9350 topadver 20 0 72256 11m 1428 S 2 0.0 0:01.45 perl
     9351 topadver 20 0 72256 11m 1428 S 1 0.0 0:01.44 perl
     9352 topadver 20 0 72256 11m 1428 S 1 0.0 0:01.44 perl
     9353 topadver 20 0 72256 11m 1428 S 1 0.0 0:01.44 perl
     9346 顶部 20 0 19340 1504 1064 R 0 0.0 0:01.89 顶部

```

有谁知道为什么使用不存在的键进行查询会降低性能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-05T09:19:28.033

写得很好的问题，显示了一些研究。

出于好奇，我尝试了 MySQL 5.6 来看看那里的工具对这些查询有什么看法。

首先，请注意查询是不同的：

*   将存在/不存在的关键案例的值从“1”更改为“-1”是一回事
*   在 WHERE 子句中将“second_1.num IS NOT NULL”更改为“second_1.num IS NULL”是另一个。

使用 EXPLAIN 给出不同的计划：

```
EXPLAIN SELECT `first`.num
FROM `first`
LEFT JOIN `second` AS second_1 ON second_1.num = -1 # non-existent key
LEFT JOIN `second` AS second_2 ON second_2.num = -2 # non-existent key
LEFT JOIN `second` AS second_3 ON second_3.num = -3 # non-existent key
LEFT JOIN `second` AS second_4 ON second_4.num = -4 # non-existent key
LEFT JOIN `second` AS second_5 ON second_5.num = -5 # non-existent key
LEFT JOIN `second` AS second_6 ON second_6.num = -6 # non-existent key
WHERE second_1.num IS NULL
AND second_2.num IS NULL
AND second_3.num IS NULL
AND second_4.num IS NULL
AND second_5.num IS NULL
AND second_6.num IS NULL
;
id      select_type     table   type    possible_keys   key     key_len ref     rows    Extra
1       SIMPLE  first   index   NULL    key_num 4       NULL    1000    Using index
1       SIMPLE  second_1        ref     key_num key_num 4       const   1       Using where; Not exists; Using index
1       SIMPLE  second_2        ref     key_num key_num 4       const   1       Using where; Not exists; Using index
1       SIMPLE  second_3        ref     key_num key_num 4       const   1       Using where; Not exists; Using index
1       SIMPLE  second_4        ref     key_num key_num 4       const   1       Using where; Not exists; Using index
1       SIMPLE  second_5        ref     key_num key_num 4       const   1       Using where; Not exists; Using index
1       SIMPLE  second_6        ref     key_num key_num 4       const   1       Using where; Not exists; Using index 
```

与

```
EXPLAIN SELECT `first`.num
FROM `first`
LEFT JOIN `second` AS second_1 ON second_1.num = 1 # existent key
LEFT JOIN `second` AS second_2 ON second_2.num = 2 # existent key
LEFT JOIN `second` AS second_3 ON second_3.num = 3 # existent key
LEFT JOIN `second` AS second_4 ON second_4.num = 4 # existent key
LEFT JOIN `second` AS second_5 ON second_5.num = 5 # existent key
LEFT JOIN `second` AS second_6 ON second_6.num = 6 # existent key
WHERE second_1.num IS NOT NULL
AND second_2.num IS NOT NULL
AND second_3.num IS NOT NULL
AND second_4.num IS NOT NULL
AND second_5.num IS NOT NULL
AND second_6.num IS NOT NULL
;
id      select_type     table   type    possible_keys   key     key_len ref     rows    Extra
1       SIMPLE  second_1        ref     key_num key_num 4       const   1       Using index
1       SIMPLE  second_2        ref     key_num key_num 4       const   1       Using index
1       SIMPLE  second_3        ref     key_num key_num 4       const   1       Using index
1       SIMPLE  second_4        ref     key_num key_num 4       const   1       Using index
1       SIMPLE  second_5        ref     key_num key_num 4       const   1       Using index
1       SIMPLE  second_6        ref     key_num key_num 4       const   1       Using index
1       SIMPLE  first   index   NULL    key_num 4       NULL    1000    Using index; Using join buffer (Block Nested Loop) 
```

使用 JSON 格式，我们有：

```
EXPLAIN FORMAT=JSON SELECT `first`.num
FROM `first`
LEFT JOIN `second` AS second_1 ON second_1.num = -1 # non-existent key
LEFT JOIN `second` AS second_2 ON second_2.num = -2 # non-existent key
LEFT JOIN `second` AS second_3 ON second_3.num = -3 # non-existent key
LEFT JOIN `second` AS second_4 ON second_4.num = -4 # non-existent key
LEFT JOIN `second` AS second_5 ON second_5.num = -5 # non-existent key
LEFT JOIN `second` AS second_6 ON second_6.num = -6 # non-existent key
WHERE second_1.num IS NULL
AND second_2.num IS NULL
AND second_3.num IS NULL
AND second_4.num IS NULL
AND second_5.num IS NULL
AND second_6.num IS NULL
;
EXPLAIN
{
  "query_block": {
    "select_id": 1,
    "nested_loop": [
      {
        "table": {
          "table_name": "first",
          "access_type": "index",
          "key": "key_num",
          "key_length": "4",
          "rows": 1000,
          "filtered": 100,
          "using_index": true
        }
      },
      {
        "table": {
          "table_name": "second_1",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "not_exists": true,
          "using_index": true,
          "attached_condition": "<if>(found_match(second_1), isnull(`test`.`second_1`.`num`), true)"
        }
      },
      {
        "table": {
          "table_name": "second_2",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "not_exists": true,
          "using_index": true,
          "attached_condition": "<if>(found_match(second_2), isnull(`test`.`second_2`.`num`), true)"
        }
      },
      {
        "table": {
          "table_name": "second_3",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "not_exists": true,
          "using_index": true,
          "attached_condition": "<if>(found_match(second_3), isnull(`test`.`second_3`.`num`), true)"
        }
      },
      {
        "table": {
          "table_name": "second_4",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "not_exists": true,
          "using_index": true,
          "attached_condition": "<if>(found_match(second_4), isnull(`test`.`second_4`.`num`), true)"
        }
      },
      {
        "table": {
          "table_name": "second_5",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "not_exists": true,
          "using_index": true,
          "attached_condition": "<if>(found_match(second_5), isnull(`test`.`second_5`.`num`), true)"
        }
      },
      {
        "table": {
          "table_name": "second_6",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "not_exists": true,
          "using_index": true,
          "attached_condition": "<if>(found_match(second_6), isnull(`test`.`second_6`.`num`), true)"
        }
      }
    ]
  }
} 
```

与

```
EXPLAIN FORMAT=JSON SELECT `first`.num
FROM `first`
LEFT JOIN `second` AS second_1 ON second_1.num = 1 # existent key
LEFT JOIN `second` AS second_2 ON second_2.num = 2 # existent key
LEFT JOIN `second` AS second_3 ON second_3.num = 3 # existent key
LEFT JOIN `second` AS second_4 ON second_4.num = 4 # existent key
LEFT JOIN `second` AS second_5 ON second_5.num = 5 # existent key
LEFT JOIN `second` AS second_6 ON second_6.num = 6 # existent key
WHERE second_1.num IS NOT NULL
AND second_2.num IS NOT NULL
AND second_3.num IS NOT NULL
AND second_4.num IS NOT NULL
AND second_5.num IS NOT NULL
AND second_6.num IS NOT NULL
;
EXPLAIN
{
  "query_block": {
    "select_id": 1,
    "nested_loop": [
      {
        "table": {
          "table_name": "second_1",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "using_index": true
        }
      },
      {
        "table": {
          "table_name": "second_2",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "using_index": true
        }
      },
      {
        "table": {
          "table_name": "second_3",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "using_index": true
        }
      },
      {
        "table": {
          "table_name": "second_4",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "using_index": true
        }
      },
      {
        "table": {
          "table_name": "second_5",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "using_index": true
        }
      },
      {
        "table": {
          "table_name": "second_6",
          "access_type": "ref",
          "possible_keys": [
            "key_num"
          ],
          "key": "key_num",
          "key_length": "4",
          "ref": [
            "const"
          ],
          "rows": 1,
          "filtered": 100,
          "using_index": true
        }
      },
      {
        "table": {
          "table_name": "first",
          "access_type": "index",
          "key": "key_num",
          "key_length": "4",
          "rows": 1000,
          "filtered": 100,
          "using_index": true,
          "using_join_buffer": "Block Nested Loop"
        }
      }
    ]
  }
} 
```

查看运行时性能模式检测的表 io，我们有：

```
truncate table performance_schema.objects_summary_global_by_type;
select * from performance_schema.objects_summary_global_by_type
where OBJECT_NAME in ("first", "second");
OBJECT_TYPE OBJECT_SCHEMA   OBJECT_NAME COUNT_STAR  SUM_TIMER_WAIT  MIN_TIMER_WAIT  AVG_TIMER_WAIT  MAX_TIMER_WAIT
TABLE   test    first   0   0   0   0   0
TABLE   test    second  0   0   0   0   0
SELECT `first`.num
FROM `first`
LEFT JOIN `second` AS second_1 ON second_1.num = -1 # non-existent key
LEFT JOIN `second` AS second_2 ON second_2.num = -2 # non-existent key
LEFT JOIN `second` AS second_3 ON second_3.num = -3 # non-existent key
LEFT JOIN `second` AS second_4 ON second_4.num = -4 # non-existent key
LEFT JOIN `second` AS second_5 ON second_5.num = -5 # non-existent key
LEFT JOIN `second` AS second_6 ON second_6.num = -6 # non-existent key
WHERE second_1.num IS NULL
AND second_2.num IS NULL
AND second_3.num IS NULL
AND second_4.num IS NULL
AND second_5.num IS NULL
AND second_6.num IS NULL
;
(...)
select * from performance_schema.objects_summary_global_by_type
where OBJECT_NAME in ("first", "second");
OBJECT_TYPE OBJECT_SCHEMA   OBJECT_NAME COUNT_STAR  SUM_TIMER_WAIT  MIN_TIMER_WAIT  AVG_TIMER_WAIT  MAX_TIMER_WAIT
TABLE   test    first   1003    5705014442  1026171 5687889 87356557
TABLE   test    second  6012    271786533972    537266  45207298    1123939292 
```

相对于：

```
select * from performance_schema.objects_summary_global_by_type
where OBJECT_NAME in ("first", "second");
OBJECT_TYPE OBJECT_SCHEMA   OBJECT_NAME COUNT_STAR  SUM_TIMER_WAIT  MIN_TIMER_WAIT  AVG_TIMER_WAIT  MAX_TIMER_WAIT
TABLE   test    first   1003    5211074603  969338  5195454 61066176
TABLE   test    second  24  458656783   510085  19110361    66229860 
```

可扩展的查询在 table 中几乎没有表 IO `second`。不伸缩的查询在表中做 6K 表 IO `second`，或表大小的 6 倍`first`。

这是因为查询计划不同，反过来又因为查询不同（IS NOT NULL 与 IS NULL）。

我认为这回答了与性能相关的问题。

请注意，在我的测试中，这两个查询都返回了 1000 行，这可能不是您想要的。在调整查询以使其更快之前，请确保它按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T17:09:17.027

我建议尝试一种方法，每个人都`fork`使用自己的连接（在我看来，现在`$children_dbh`拥有数据库连接的 是一个共享变量）。或者，更好的是，实现所谓的`connection pool`，每个客户端进程将在需要时从中获取连接，并在不再需要时将其“归还”。

检查[此答案](https://stackoverflow.com/a/1482192/1229023)以获取更多详细信息：给出它的线程是关于 Java 的，但它实际上是关于 MySQL 组织的一些通用原则。[这个答案](https://stackoverflow.com/questions/1455190/how-to-access-mysql-from-multiple-threads-concurrently)也可能有用。

[PS这里](https://stackoverflow.com/questions/3127229/perl-parallelforkmanager-with-dbi-database-handlers)描述了有点类似的情况（我认为），并且有关于如何组织连接池的详细说明。

# magento - 将免费送货标签添加到价格超过一定金额的 magento 产品页面？

> ID：11160529
> 
> 赞同：0
> 
> 时间：2012-06-22T16:40:45.467
> 
> 标签：magento, label, magento-1.6, php

我想在我的 Magento 产品页面的某处添加“免费送货”标签。该代码非常简单：

```
<?php echo $this->__('FREE SHIPPING') ?> 
```

问题是，我只为价格超过 199 美元的产品提供免费送货服务。

如何设置 if 语句仅在价格超过 199 美元时显示此标签？

感谢您的帮助（顺便说一下，我正在使用 Magento v1.6.1）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T21:11:50.480

你可以尝试做这样的事情：

```
 // somewhere on product page, e.g. view.phtml
<?php if ($_product->getPrice() > 199) :
//if you don't have direct access to $_product variable from your template or to $this->getProduct() method of block template belongs to, try using registry,e.g.
//if (Mage::registry('current_product')->getPrice() > 199):
    echo $this->__('FREE SHIPPING');
endif; ?> 
```

希望它会有所帮助。

# java - 如何使用 maven 创建基于 spring 的可执行 jar？

> ID：11160534
> 
> 赞同：32
> 
> 时间：2012-06-22T16:41:02.017
> 
> 标签：java, spring, maven, spring-ws, maven-shade-plugin

我有一个基于 Maven 的 Spring-WS 客户端项目，我想将其打包为单个 jar。在eclipse中，一切运行正常。当我尝试将其打包为可执行 jar 时，我得到 ClassNotFound 异常，因为 Spring jar 不包含在我的应用程序 jar 中。

所以我添加了[maven-shade-plugin](http://maven.apache.org/plugins/maven-shade-plugin/usage.html)以在我的应用程序 jar 中包含我的所有依赖项。当我查看我的应用程序 jar 时，我看到了所有依赖项中的所有类文件（所有库 jar 都被分解了）。

```
<build>
    <plugins>
        <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
                <source>1.6</source>
                <target>1.6</target>
            </configuration>
        </plugin>

        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.4</version>
            <configuration>
                <archive>
                    <manifest>
                        <addClasspath>true</addClasspath>
                        <mainClass>com.cws.cs.Client</mainClass>
                    </manifest>
                </archive>
            </configuration>
        </plugin>

        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-shade-plugin</artifactId>
            <version>1.7</version>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>shade</goal>
                    </goals>
                </execution>
            </executions>

        </plugin>
    </plugins>
</build> 
```

我的问题是，在打包过程中，我的多个 spring 依赖项有不同[的 META-INF/spring.schemas](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/extensible-xml.html#extensible-xml-registration-spring-schemas)文件，它们相互覆盖。因此，我的最终 jar 有一个不完整的 spring.schemas 文件。

因此，当我尝试运行我的可执行 jar 时，我收到 Spring 错误消息，指出由于 spring.schemas 文件不完整（Spring-WS 的 jar 覆盖了 Spring-core 的 spring.schemas 文件），因此找不到文件。

我的可执行 jar 的 META-INF/spring.schemas：

```
http\://www.springframework.org/schema/web-services/web-services-1.5.xsd=/org/springframework/ws/config/web-services-1.5.xsd
http\://www.springframework.org/schema/web-services/web-services-2.0.xsd=/org/springframework/ws/config/web-services-2.0.xsd
http\://www.springframework.org/schema/web-services/web-services.xsd=/org/springframework/ws/config/web-services-2.0.xsd 
```

而不是 Spring-beans.jar META-INF/spring.schemas：

```
http\://www.springframework.org/schema/beans/spring-beans-2.0.xsd=org/springframework/beans/factory/xml/spring-beans-2.0.xsd
http\://www.springframework.org/schema/beans/spring-beans-2.5.xsd=org/springframework/beans/factory/xml/spring-beans-2.5.xsd
http\://www.springframework.org/schema/beans/spring-beans-3.0.xsd=org/springframework/beans/factory/xml/spring-beans-3.0.xsd
http\://www.springframework.org/schema/beans/spring-beans-3.1.xsd=org/springframework/beans/factory/xml/spring-beans-3.1.xsd
http\://www.springframework.org/schema/beans/spring-beans.xsd=org/springframework/beans/factory/xml/spring-beans-3.1.xsd
http\://www.springframework.org/schema/tool/spring-tool-2.0.xsd=org/springframework/beans/factory/xml/spring-tool-2.0.xsd
http\://www.springframework.org/schema/tool/spring-tool-2.5.xsd=org/springframework/beans/factory/xml/spring-tool-2.5.xsd
http\://www.springframework.org/schema/tool/spring-tool-3.0.xsd=org/springframework/beans/factory/xml/spring-tool-3.0.xsd
http\://www.springframework.org/schema/tool/spring-tool-3.1.xsd=org/springframework/beans/factory/xml/spring-tool-3.1.xsd
http\://www.springframework.org/schema/tool/spring-tool.xsd=org/springframework/beans/factory/xml/spring-tool-3.1.xsd
http\://www.springframework.org/schema/util/spring-util-2.0.xsd=org/springframework/beans/factory/xml/spring-util-2.0.xsd
http\://www.springframework.org/schema/util/spring-util-2.5.xsd=org/springframework/beans/factory/xml/spring-util-2.5.xsd
http\://www.springframework.org/schema/util/spring-util-3.0.xsd=org/springframework/beans/factory/xml/spring-util-3.0.xsd
http\://www.springframework.org/schema/util/spring-util-3.1.xsd=org/springframework/beans/factory/xml/spring-util-3.1.xsd
http\://www.springframework.org/schema/util/spring-util.xsd=org/springframework/beans/factory/xml/spring-util-3.1.xsd 
```

我难住了。我不确定是否/如何将所有内容打包为单个可执行 jar。我不知道这是否是一个阴影插件配置问题，或者我是否正在尝试做一些不可能的事情。我必须手动创建自己的 spring.schemas 文件（其他文件的串联）似乎不正确。

我可能有点过激了。在挖掘有关阴影插件的更多信息时，我注意到了我之前错过的[AppendingTransformer 。](http://maven.apache.org/plugins/maven-shade-plugin/examples/resource-transformers.html#AppendingTransformer)但是，我关心的是如何知道哪些其他文件有同样的问题？我发现/发现了这个特殊的 Spring 问题。我不知道任何其他可能正在做类似事情的图书馆......

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-06-22T16:45:21.280

您可以添加以下配置，以便将所有 jar 中的 .schema 文件的内容附加在一起。

```
<configuration>
  <transformers>
    <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
      <resource>META-INF/spring.handlers</resource>
    </transformer>
    <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
      <resource>META-INF/spring.schemas</resource>
    </transformer>
  </transformers>
</configuration> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-22T16:46:10.733

而不是 maven-shade-plugin 使用[onejar-maven-plugin](http://code.google.com/p/onejar-maven-plugin/)。[One-JAR](http://one-jar.sourceforge.net/)允许您将 Java 应用程序及其依赖项 Jar 打包到单个可执行 Jar 文件中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-02T03:51:14.360

昨天我也遇到了这个问题。

解决方案是通过手动连接和配置程序集插件来准备所需的文件：

```
 <files>
    <file>
        <source>src/META-INF/spring.schemas</source>
        <outputDirectory>META-INF</outputDirectory>
    </file>
    <file>
        <source>src/META-INF/spring.handlers</source>
        <outputDirectory>META-INF</outputDirectory>
    </file>
  </files>
  <dependencySets>
    <dependencySet>
      <outputDirectory>/</outputDirectory>
      <useProjectArtifact>true</useProjectArtifact>
      <unpack>true</unpack>
      <scope>runtime</scope>
      <unpackOptions>
        <excludes>
            <exclude>META-INF/spring.handlers</exclude>
            <exclude>META-INF/spring.schemas</exclude>
        </excludes>
      </unpackOptions>  
    </dependencySet>
  </dependencySets> 
```

注意：使用一种 jar 方法还不够好 - 你不能确定手头的混合文件，尽量保持原样导出所有依赖项......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-15T18:32:01.523

```
assembly plugin have issues, use below plugin

<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-shade-plugin</artifactId>
    <executions>
        <execution>
            <phase>package</phase>
            <goals>
                <goal>shade</goal>
            </goals>
            <configuration>
                <transformers>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
                        <mainClass>at.seresunit.lecturemanager_connector.App</mainClass>
                    </transformer>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                        <resource>META-INF/spring.handlers</resource>
                    </transformer>
                    <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                        <resource>META-INF/spring.schemas</resource>
                    </transformer>
                </transformers>
            </configuration>
        </execution>
    </executions>
</plugin>

you may get security exception resolve it using below configuration

 <configuration>
    <filters>
        <filter>
            <artifact>*:*</artifact>
            <excludes>
                <exclude>META-INF/*.SF</exclude>
                <exclude>META-INF/*.DSA</exclude>
                <exclude>META-INF/*.RSA</exclude>
            </excludes>
        </filter>
    </filters>
</configuration> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-26T15:28:53.180

您是否尝试过[maven-assembly-plugin](http://maven.apache.org/plugins/maven-assembly-plugin)？

它将为您创建一个带有依赖项的 jar，而且它可以使这个 jar 可执行：

使用 mainClass 指定要执行的类。

```
<plugin>
    <artifactId>maven-assembly-plugin</artifactId>
    <version>2.3</version>
    <configuration>
      <descriptorRefs>
        <descriptorRef>jar-with-dependencies</descriptorRef>
      </descriptorRefs>
      <archive>
        <manifest>
          <mainClass>org.sample.App</mainClass>
        </manifest>
      </archive>
    </configuration>
    <executions>
      <execution>
        <id>make-assembly</id> <!-- this is used for inheritance merges -->
        <phase>package</phase> <!-- bind to the packaging phase -->
        <goals>
          <goal>single</goal>
        </goals>
      </execution>
    </executions>
  </plugin> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-06-25T01:43:18.223

对于希望为 Spring Boot 应用程序找到答案的人，您只需要：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
        </plugin>
    </plugins>
</build> 
```

# php - 需要有关在 Mac OS X 上管理 php 和 mysql 的软件的帮助

> ID：11160537
> 
> 赞同：0
> 
> 时间：2012-06-22T16:41:12.637
> 
> 标签：php, mysql, osx-lion, mamp, wampserver

我需要有关 MAMP、Wamp Server 等软件的帮助，以在 mac os x 上管理 php 和 mysql。你能和我分享一个清单之类的东西吗？这对我来说很重要，因为我正在从 windows 切换到 mac，以提高我的开发和编程技能......

此致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:02:55.040

您应该认真研究[Zend Server Community Edition](http://www.zend.com/en/products/server-ce/)。这是许多 PHP 专业人士使用的令人惊叹的软件。它与 Zend Studio 相结合，这是一个很棒的 IDE，并允许您通过单击几个按钮来管理您的 HTTP 服务器、MySQL 和 PHP 配置。

# html - 从 HTML 或其他 GUI 执行批处理文件

> ID：11160539
> 
> 赞同：1
> 
> 时间：2012-06-22T16:41:17.760
> 
> 标签：html, batch-file

我的 Windows 系统中有一个简单的批处理文件 -
@echo off
echo %1 >> %2

这个批处理文件有两个参数，第一个是字符串，第二个是文件名。它将传递的字符串附加到文件中。

从命令行执行这个批处理文件很简单，但我需要从 GUI 执行它。

是否可以从浏览器执行此批处理文件？我可以编写一个简单的 HTML 文件，它接受两个参数并在按下按钮时执行这个批处理文件吗？

有没有其他方法可以创建一个简单的 GUI 来执行这个批处理文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:54:07.863

无法在您的网络浏览器中从 javascript 运行命令行调用，这是由于安全风险。

但是，您可以使用多种其他方法。如果您了解任何 Java，您可以使用调用命令行的 Swing 接口创建一个非常简单的 Java 程序。您还可以选择在您的本地主机上运行一个 php 页面，这将允许您在浏览器中拥有一个 html 前端，该前端向您的服务器发送请求，然后可以为您进行调用。

# svn - SVN 提交和合并旧版本

> ID：11160542
> 
> 赞同：0
> 
> 时间：2012-06-22T16:41:23.873
> 
> 标签：svn, tortoisesvn

有没有一种方法可以在我将分支更新到我想要的修订版之后 - 提交它并合并到主干？

我试过：`svn update -r REV`REV 是以前的修订号，效果很好，但是我如何从我的分支合并到主干？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-22T16:45:38.103

这与从分支到主干的正常合并没有什么不同。TortoiseSVN 有一个[重新集成分支选项](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-merge.html)。

# database - Crystal Reports DatabaseTable 对象中没有字段

> ID：11160545
> 
> 赞同：1
> 
> 时间：2012-06-22T16:41:30.967
> 
> 标签：database, delphi, crystal-reports

我在 Crystal Reports 应用程序中遇到问题，我在 DatabaseTable 对象的 Fields 属性中没有获得任何字段。Fields.Count 为每个表返回零。这仅发生在我们用户的一台计算机上。它适用于办公室中的所有开发人员。我们看不到任何不同的东西。我也想知道我是否在做一些根本错误的事情。文档说对于 Fields 属性“报表访问的每个数据库字段的集合中都存在一个对象”，但我们看到每个表的数据库中存在的每个字段都有一个对象，而不仅仅是由报告（顺便说一句，这确实是我们想要的）。我们正在使用 CR 运行时版本 11.5。任何想法，将不胜感激。这是我们正在使用的代码（Delphi）：

```
 procedure TfrmPCMSCrystalReportViewer.BuildColumnList;
    { Populate slColumns with the list of column. 
      For each table in the report, add every column. }
    var
      I, J: Integer;
      Tbl: DatabaseTable;
    begin
      slColumns.Clear;
      with crReport1.Database do begin
        for I := 1 to Tables.Count do begin
          Tbl := Tables[I];
          //process each column in table
          for J := 1 to Tbl.Fields.Count do   
            //add column to list
            slColumns.Add(Tbl.Fields[J].DatabaseFieldName);  
        end; //for
      end; //with
    end; 
```

# c# - SMO 存储过程发现

> ID：11160546
> 
> 赞同：0
> 
> 时间：2012-06-22T16:41:35.303
> 
> 标签：c#, sql-server-2008, stored-procedures, smo

我试图找出任何 SQL Server 2008 存储过程的输入和输出。

我正在使用 SMO 连接到数据库实例，然后获取所有数据库和每个数据库存储过程。

目前，我可以获取`StoredProcedure`对象并获取输入参数，但我无法找到结果。

我知道我可以使用`ExecuteWithResults`传递我的存储过程来运行它，但是我怎样才能得到结果呢？

另外，我如何传递参数？我是否构建了一个 exec 命令并将其传入？

编辑：我发现我需要使用 SET FMTONLY ON，但我究竟如何将它传递给 ExecuteWithResults？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:48:02.980

弄清楚了。使用 StringCollection 构建字符串集合。确保 Add("SET FMTONLY ON") 这样您就不会影响任何真实数据。使用存储过程参数集合中的所有参数构建一个 exec 命令，然后在该集合上执行 executeWithResults。这将返回一个 DataSet[]。在数据集数组中获取与在 StringCollection 中添加 exec 命令相同的索引。从这里，您可以获取结果表集，然后是其列，其中包含所有列名及其数据类型。

# c++ - C(++) struct 强制额外填充

> ID：11160551
> 
> 赞同：10
> 
> 时间：2012-06-22T16:41:46.807
> 
> 标签：c++, c, gcc, struct, memory-alignment

我已经看到无数类似“我不喜欢填充如何将其关闭”形式的问题，但还没有找到任何关于强制编译器提供额外填充的内容。

我的具体情况看起来像

```
struct particle{
  vect2 s;
  vect2 v;
  int rX;
  int rY;
  double mass;
  int boxNum;
}; 
```

哪里`vect2`有简单的`struct {double x; double y;} vect2`。为了使用 SSE2，我需要能够加载一对双精度，对齐到 16 字节边界。这曾经有效，直到我添加了 extra `int`，将我的结构大小从 48 字节推到 56 字节。结果是段错误。

是否有某种编译器指令我可以使用，或者说“填充这个结构以使其长度为 16 字节的倍数”，或者“这个结构有 16 字节的对齐”？我知道我可以手动完成（例如添加一个额外的 char[12]），但我真的宁愿只告诉编译器（GCC，最好是 ICC 兼容），如果我更改了就不必手动完成未来的结构。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-22T17:01:14.603

您可以嵌套两个结构以自动填充它，而无需自己跟踪大小。

```
struct particle
{
    // ...
};

{
    particle p;
    char padding[16-(sizeof(particle)%16)];
}; 
```

如果结构已经是 16 的倍数，这个版本不幸地增加了 16 个字节。这是不可避免的，因为标准不允许长度为零的数组。

一些编译器确实允许零长度数组作为扩展，在这种情况下，您可以这样做：

```
struct particle_wrapper
{
    particle p;
    char padding[sizeof(particle)%16 ? 16-(sizeof(particle)%16) : 0];
}; 
```

如果结构已经是 16 的倍数，则此版本不会添加任何填充字节。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-23T18:28:33.107

在`gcc`中，您可以将任意类型和变量与[`__attribute__((aligned(...)))`](http://gcc.gnu.org/onlinedocs/gcc/Variable-Attributes.html). 对于您的示例，这将是

```
struct particle{
  vect2 s;
  vect2 v;
  int rX;
  int rY;
  double mass;
  int boxNum;
} __attribute__((aligned (16))); 
```

这会自动填充结构，以便其数组正确对齐。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-23T18:04:05.573

我正在为此添加自己的答案，以防有人来寻找解决方案。马克的解决方案是一个简洁的解决方案，并且满足了自动要求，但它不是我最终选择的。我想避免这种情况，这就是我问这个问题的原因，但是有一个“微不足道”的解决方案：

```
struct particle{
  vect2 s;
  vect2 v;
  int rX;
  int rY;
  double mass;
  int boxNum;
  char padding[12];
}; 
```

通过手动检查 的当前大小`struct`，您可以添加适当数量的字符（或其他任何内容，但`char`允许您以字节为单位），以使其大小正确。这显示了最佳性能和简单性，即使每次结构更改时都需要更新。在这种情况下，这很好，尽管如果您有一个可以根据选项改变大小的结构，那将是有问题的。

请注意，my`struct`是 56 字节，我添加了 12 使其成为 64。这个数学不起作用，因为尾随`int`已经被 4 字节填充到 8 字节边界；之前`struct`实际上只有 52 个字节。通过使 57 字节长，这将被填充到 64，只添加 5 `char`s 会起作用，`struct`但这不是一个很好的解决方案，这就是为什么我使用 12 来使其准确地工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-22T16:46:16.810

新的 C++11 规范也为此提供了一个[新功能](http://en.cppreference.com/w/cpp/language/alignas)，尽管我不相信很多供应商已经实现了它们。

~~您可以尝试 pack pragma，尽管规范不支持它。GCC 和 MS 都支持它。~~

~~这会在 1 字节边界上对齐结构，尽管您可以将数字更改为您想要的任何值。~~

```
#pragma pack(push,1)
// ...
#pragma pack(pop) 
```

更新：

所以显然上述方法不起作用，因为它只会缩小填充，从不扩展它。很遗憾，今天下午我没有测试环境。

也许使用匿名工会会起作用。我知道它会扩展到最大尺寸，但我不知道你是否能得到任何关于对齐的保证。

```
template<typename T, size_t padding_size>
  struct padded_field {
    union {
      T value;
      uint8_t padding[padding_size];
    };
  }; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-22T16:52:32.680

未经测试，但这可能有效：

```
#include <xmmintrin.h>

struct particle{
  union {
    vect2 s;
    __m128 s_for_alignment;
  };
  union {
    vect2 v;
    __m128 v_for_alignment;
  };
  ...
}; 
```

我知道 gcc 之前有`__m128`正确对齐的问题，但现在应该修复这些问题。

# javascript - 如何获取使用JQuery单击的行的表格单元格

> ID：11160552
> 
> 赞同：1
> 
> 时间：2012-06-22T16:41:53.970
> 
> 标签：javascript, jquery, html, html-table, row

我有一个 HTML 表格，并且我的行有一个 onclick 事件。

我想知道是否有可能找出单击了该行的哪个单元格，而无需为每个单元格设置单独的处理程序？

我有一张桌子：

```
<tr class="new_row">
   <td class="date">date</td>
   <td class="name">name</td>
   <td class="delete">delete</td>
</tr> 
```

和jQuery：

```
$(".new_row").click(function(){
   if(delete was clicked){
       delete the row
   }
}); 
```

这就是我想要做的基本上，检测是否单击了删除单元格。

这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T16:44:08.260

首先你不应该定义多个具有相同id的元素，这会造成麻烦，你可以替换`id='delete'`为`class='delete'`。

```
// on click td with class delete:
$("td.delete").click(function(){
   //delete was clicked so remove tr
   $(this).parent().remove();
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T16:55:33.557

你可以这样做

**[现场演示](http://jsfiddle.net/rajaadil/vGS22/)**

```
$(".new_row").click(function(event){       
    if($(event.target).text() == 'delete')
    {       
      $(this).remove();      
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T16:44:42.160

查看 id 的[`event.target`](http://api.jquery.com/event.target/)。如果匹配`delete`，则可以处理删除。

但是，由于这是在一个表中，我猜你有多行。如果是这种情况，这是否意味着您有多个具有相同 ID 的单元格？如果是这样，这不是有效的 HTML，当您尝试使用 CSS 选择器时，它可能会导致您的 jQuery 代码出现问题。

# jquery - 使用隐藏/显示 jquery animate 时出现奇怪的“双重回调”

> ID：11160554
> 
> 赞同：0
> 
> 时间：2012-06-22T16:41:59.207
> 
> 标签：jquery, jquery-animate, show-hide

我有一个用 .hide 隐藏的 div 并在点击打开时使用`.show("slide", { direction: "left" }, 1000);`它一切正常，在那个我有按钮的内部，点击触发 div 被隐藏，这是使用完成的

```
$('.hide-content').click(function () {
     $(".slide-out").hide("slide", {
         direction: "left"
     }, 1000);
}); 
```

它可以工作，但是一旦隐藏它就会再次打开然后很快关闭..这真的很奇怪，因为我看不出有任何 js 导致它。

我在这里解决了这个问题 - [http://jsfiddle.net/vUZuY/](http://jsfiddle.net/vUZuY/) - 复制它：单击打开然后滚动到打开的 div 的底部并点击隐藏，你会看到它是如何反弹回来的关闭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:49:23.657

好的，我注意到这有两个问题：

1.  *每次打开 div 时，*您都在重新绑定 hide 事件。不过，看起来您是从另一个来源加载的，所以这在您的实际实现中可能没问题。
2.  **真正的问题**：在你的标记中，你有一个“关闭”链接和一个段落。两者都有“隐藏内容”类——因此您已将其设置为触发此事件两次。（单击 时一次，单击

    被点击）；

我对您的小提琴进行了快速编辑：http: [//jsfiddle.net/vUZuY/2/](http://jsfiddle.net/vUZuY/2/)通过提供唯一的 id 并绑定到它。

# java - 发生异常时关闭数据库连接的最佳设计模式

> ID：11160557
> 
> 赞同：9
> 
> 时间：2012-06-22T16:42:13.443
> 
> 标签：java, oracle, jdbc

我是 Java 新手（我使用的是 Java 6）。我一直在为我的所有 Java POJO 和 servlet 使用以下设计模式，以通过 GlassFish 3.1.2 Web 服务器访问 Oracle 11G 数据库。

当所有可用进程（或会话，不确定有什么区别）都被消耗时，我收到间歇性数据库错误（ORA-12519），这让我认为应用程序没有释放进程。

看看下面的设计模式，有没有更好的方法来确保在发生异常时释放与数据库的 JDBC 连接？例如，我是否也应该将`if ( conn != null) conn.close();`代码放在 catch 块内？或者，有没有更好的设计模式？提前感谢您的任何评论/提示。

```
public String MyFunction() throws Exception {     

    Connection conn;
    CallableStatement cs;

  try {

      Context context = new InitialContext();
      DataSource ds = (DataSource)context.lookup("jdbc/MyPool");
      conn = ds.getConnection();        

      cs = conn.prepareCall( "{call my_sproc (?)}" );

      cs.registerOutParameter(1, Types.VARCHAR);

      cs.execute();

      String outParam = cs.getString(1); 

      if ( conn != null )  // close connection
         conn.close();

  } catch (Exception e) {
      outParam = "an error occurred";
  }
    return outparam;
} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-22T16:47:26.037

```
if ( conn != null )  // close connection
         conn.close(); 
```

在这一行`conn` *不能*为空。在 Java 6 之前最流行的模式是：

```
Connection conn = null;
try {
   // initialize connection
   // use connection 
} catch {
  // handle exception
} finally {
  if (conn != null) {
     try { conn.close(); } catch (Exception e) { /* handle close exception, quite usually ignore */ } 
     }
} 
```

在**Java 7中，它的**[try-with-resource](http://www.oracle.com/technetwork/articles/java/trywithresources-401775.html)结构将变得不那么繁琐。上面的代码可以更改为更短

```
try (Connection conn  = createConnection()) {
    // use connection 
} catch {
    // handle exception
}
// close is not required to be called explicitly 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-22T16:43:23.380

始终使用[`finally`](http://docs.oracle.com/javase/tutorial/essential/exceptions/finally.html)块来释放资源。

> finally 块总是在 try 块退出时执行。这样可以确保即使发生意外异常也会执行 finally 块。

```
 try {

      Context context = new InitialContext();
      DataSource ds = (DataSource)context.lookup("jdbc/MyPool");
      conn = ds.getConnection();        

      cs = conn.prepareCall( "{call my_sproc (?)}" );

      cs.registerOutParameter(1, Types.VARCHAR);

      cs.execute();

      String outParam = cs.getString(1); 

  } catch (Exception e) {
      outParam = "an error occurred";
  }
 finally {
       conn.close();
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-22T16:58:49.070

java se 7 支持 try-with-resources 功能。最终为您生成。[http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)

finally 块将关闭 try 中分配的资源。就像您在 c# 中使用关键字 using

但是用户正在使用java se6 ...查看其他用户的选项:)

重要提示：使用的语句也应该关闭。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-22T17:42:14.823

我更喜欢另一种更优雅的方式：

```
} finally {
  if (conn != null) {
     try {
         conn.close();
     } catch (Exception e) {
         /* handle close exception, quite usually ignore */
     } 
  }
} 
```

您可以使用 DbUtils.closeQuietly：[http ://commons.apache.org/dbutils/apidocs/org/apache/commons/dbutils/DbUtils.html](http://commons.apache.org/dbutils/apidocs/org/apache/commons/dbutils/DbUtils.html)

# jquery - jquery 错误消息放在 div (jquery.validate.js)

> ID：11160565
> 
> 赞同：0
> 
> 时间：2012-06-22T16:42:46.177
> 
> 标签：jquery

我有以下脚本，它通过测验使用 jquery.validate.js 验证页面并且运行良好。我希望将必填字段的错误消息放入名为 errormessage 的 div 中。jQuery validate 通常会返回一条消息“此字段是必需的”。

这是脚本

```
<script type="text/javascript">
var curPage=1;
function NextPage() {
    if (curPage < <?= $num; ?>) {
        var group = "#page_" + curPage.toString();
        var isValid =true;
         $(group).find(':input').each(function (i, item) {
              if (!$(item).valid())
                isValid = false;
            });

        if( !isValid){ alert("PLEASE MAKE A SELECTION"); }
        else{
            $("#page_" + curPage.toString()).hide(); //hide current page div
            curPage++;  //increment curpage
            $("#page_" + curPage.toString()).show(); //show new current page div
        }
    }
}
 function PrevPage() {

     if (curPage > 1) {
         $("#page_" + curPage.toString()).hide(); //show new current page div
         curPage--;  //increment curpage
         $("#page_" + curPage.toString()).show(); //hide current page div
     }
 }

 function InitializePage() {
     $(".wizardPage").hide();
     $("#page_" + curPage.toString()).show();

     $("#surveyForm").validate({onsubmit: false});

 }

 $(document).ready(InitializePage
    );
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:11:01.447

尝试设置错误容器元素，如下所述：

[http://mitchlabrador.com/2010/11/05/how-to-change-the-way-jquery-validate-handles-error-messages/](http://mitchlabrador.com/2010/11/05/how-to-change-the-way-jquery-validate-handles-error-messages/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:07:40.720

将此行切换`$("#surveyForm").validate({onsubmit: false});`为以下内容-

```
$("#surveyForm").validate({
    rules: {
    xyz: {
        required: true
    }
},
messages: {
    xyz: {
    required: $('div#errormessage').append("xyz is a required field!");
    }
}
}, onsubmit: false) 
```

它将检查是否`xyz`已填充。如果没有，它将放入`xyz is a required field!`一个`div`with `id` `errormessage`。

有关规则的更多详细信息，请查看[此页面](http://docs.jquery.com/Plugins/Validation/validate#options)。向下滚动，直到您到达“规则”。

上面的代码通过为每个字段添加规则，将允许您为每个错误消息指定不同的位置。蜘蛛答案中的博客文章包含一种更简单的做事方式，因此如果您不需要这种可定制性，则更可取。

# visio - 如何将接口归因于 Visio UML 模型中的类

> ID：11160567
> 
> 赞同：1
> 
> 时间：2012-06-22T16:43:06.557
> 
> 标签：visio, uml

我在 Visio 2010 中创建了一个 UML 模型。我创建了几个类和接口。在 UML 模型中，如何配置我的类之一来实现我的接口之一？换句话说，如何在模型中的一个类上配置接口实现？我可以通过将棒棒糖接口连接到类来在类图中显示实现，但这无助于在模型本身中建立实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T09:06:23.547

根据这个超级用户的回答：[https ://superuser.com/questions/240098/microsoft-visio-2010-umlclass-interfaces](https://superuser.com/questions/240098/microsoft-visio-2010-umlclass-interfaces)

> 打开模型资源管理器工具栏（如果尚未打开），您将在那里看到您的界面。再次将其拖到页面并连接到新类。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-07-10T17:48:18.770

这非常有帮助。另外，我右键单击并选择“显示为类接口”以在我的图表中的接口对象上显示打开三角形类型的箭头和虚线

# iphone - 寻找 iOS 按钮图像样本

> ID：11160568
> 
> 赞同：-1
> 
> 时间：2012-06-22T16:43:07.963
> 
> 标签：iphone, ios

是否有图书馆或其他东西可以获取 iPhone 和 iPad 按钮图像，例如添加、删除、新联系人、...

我真的找不到任何关于那的东西，但必须有一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:46:40.100

对于工具栏和标签栏，有[glyphish](http://glyphish.com)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T17:46:28.427

您正在寻找的内置元素位于[此页面的底部](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/UIElementGuidelines/UIElementGuidelines.html)

# c# - HTTP POST 请求问题

> ID：11160570
> 
> 赞同：0
> 
> 时间：2012-06-22T16:43:09.557
> 
> 标签：c#, .net, http, post, client-server

我正在使用 向 PHP 服务器发送 HTTP POST 请求`HttpWebRequest`。我的代码是这样工作的：

```
 /// <summary>
    /// Create Post request.
    /// </summary>
    /// <param name="requestUrl">Requested url.</param>
    /// <param name="postData">Post data.</param>
    /// <exception cref="RestClientException">RestClientException</exception>
    /// <returns>Response message, can be null.</returns>
    public string Post(string requestUrl, string postData)
    {
        try
        {
            //postData ends with &
            postData = "username=XXX&password=YYYY&" + postData;

            byte[] data = UTF8Encoding.UTF8.GetBytes(postData);

            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(requestUrl);
            request.Method = RequestMethod.Post.ToString().ToUpper();
            request.ContentType = "application/x-www-form-urlencoded";
            request.ContentLength = data.Length;

            using (Stream stream = request.GetRequestStream())
            {
                stream.Write(data, 0, data.Length);
                stream.Flush();
            }

            string responseString;
            using (WebResponse response = request.GetResponse())
            {
                responseString = GetResponseString(response);
            }

            return responseString;
        }
        catch (WebException ex)
        {
            var httpResponse = (HttpWebResponse)ex.Response;
            if (httpResponse != null)
            {
                throw new RestClientException(GetExceptionMessage(httpResponse));
            }

            throw;
        }
    } 
```

我正在经历奇怪的行为。每分钟我都会使用这个发送大约 100 个请求。但有时，此请求会在没有 POST 数据的情况下执行。然后我的 PHP 服务器返回错误（因为我正在检查请求是否为 POST 以及是否有任何 POST 数据）。

这是客户端/服务器通信。装有 Windows 服务应用程序的计算机使用 Wifi 连接到互联网。连接有时真的很差。可以提到这个原因问题吗？如何使 HTTP POST 请求对这种行为安全。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:53:41.583

我没有看到您使用的任何“自定义”行为，那么您为什么不使用该`WebClient.UploadData`方法呢？那么你就会知道这不是你做错了什么

它为您完成所有“脏”工作，您也可以添加内容类型标题。

查看该链接了解更多信息： http: [//msdn.microsoft.com/en-us/library/tdbbwh0a (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/tdbbwh0a(v=vs.80).aspx)

例子：

```
public string Post(string requestUrl, string postData)
{
   WebClient myWebClient = new WebClient();
   myWebClient.Headers.Add("Content-Type","application/x-www-form-urlencoded");
   byte[] data = UTF8Encoding.UTF8.GetBytes(postData);
   byte[] responseArray = myWebClient.UploadData(requestUrl,data);
   return responseArray;
} 
```

# javascript - 使 jquery 增加一个文本框编号和 id

> ID：11160577
> 
> 赞同：-1
> 
> 时间：2012-06-22T16:43:49.610
> 
> 标签：javascript, jquery, dom

我希望能够单击按钮并让它复制：

```
<tr id="1">
<td>
    <input type="number" class="cue">
</td>
<td>
    <input type="time">
</td>
<td>
    <input type="text">
</td>
</tr> 
```

并且能够`<tr>`根据之前的内容更改其 id。我还希望它根据变量 cueset 更改数字框的值。

当您按下按钮添加一行时，它会调用`add_row()`

```
function add_row(rowCount)
   {
    for(i=0; i<rowCount; i++)
    {
        index = index + 1;
        $('table').append( $('#1').prop('id', index));
    }
   } 
```

我不知道该怎么做是让它改变 id 或数字框的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:00:34.027

我不明白你的解释中 rowCount 和 for 循环的使用，所以这里没有它们

```
function add_row()
{               
    var mostRecentTr = [].pop.call($("tr"));                
    var newNum = 1+$(mostRecentTr).attr("id");      
    var newTr = $(mostRecentTr).clone().attr("id", newNum);             
    newTr.find(".cue").val(newNum);                 
    $("table").append(newTr);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:02:01.613

```
var lastRow = jQuery('tr[id]').last();
var currCount = parseInt(lastRow.id);
var newRow = lastRow.clone()
newRow.id = currCount++;
lastRow.parent().append(newRow); 
```

虽然我建议像这样更好的东西：

```
var lastRow = jQuery('tr[counter]').last();
var currCount = parseInt(lastRow.attr('counter'));
var newRow = lastRow.clone()
newRow.attr('counter', currCount + 1).id = ('myRow' + currCount + 1);
lastRow.parent().append(newRow); 
```

# php - 如何插入天以保持 MYSQL 日历表最新？

> ID：11160581
> 
> 赞同：1
> 
> 时间：2012-06-22T16:44:09.087
> 
> 标签：php, mysql, datetime, insert

`calendar`我的MYSQL 数据库中有一个表，其中有一个名为`datefield`(type `DATE`) 的字段。

以前我插入了从 2008-01-01 到 2010-01-01 的日期，但现在我想每天添加直到当前日期。不幸的是，我完全忘记了我是怎么做到的。

我还想知道是否有任何方法可以自动化保持此表最新的过程。

我正在使用 PHP，所以我想我可以`INSERT`每天做一个新的？或者有什么方法可以直接在 MYSQL 中做到这一点？

谢谢，蒂姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:22:42.690

这是一个快速破解：

```
drop table if exists dates;
create table dates(datefield date);

drop procedure if exists insertDates;

delimiter $$
create procedure insertDates(start_date date)
begin
set @days = 0;
set @end_date = str_to_date('1970-01-01', '%Y-%m-%d');

while (@end_date < curdate()) do
insert into dates
select
date_add(start_date, interval @days day)
from (select @days:=@days+1) r
;
set @end_date:=(select max(datefield) from dates);
end while
;

end $$

delimiter ;

call insertDates('2012-06-06');

select * from dates; 
```

对于每日插入，您可以尝试 cron 作业或 MySQL 提供“事件”，例如：

```
CREATE EVENT yourDB_Schema.insertDateEachDay
ON SCHEDULE EVERY 1 DAY
DO
INSERT INTO yourTable (yourDateColumn) VALUES (CURDATE()); 
```

在此处阅读更多信息：

[MySQL 创建事件手动输入](http://dev.mysql.com/doc/refman/5.1/en/create-event.html)

> 事件与模式相关联。如果未将模式指示为 event_name 的一部分，则假定默认（当前）模式。

_

> 不指定 STARTS 与使用 STARTS CURRENT_TIMESTAMP 相同，即为事件指定的操作在创建事件后立即开始重复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:50:05.090

我认为执行您所描述的最简单的方法是设置每日重复任务来运行 php 脚本，例如 cron 作业。还有一个基于 Web 的提供程序，它会以廉价、重复的时间表从您的 Web 服务器调用脚本。[http://webcron.org](http://webcron.org)

# javascript - 浏览器供应商是否针对 jQuery 优化他们的浏览器？

> ID：11160584
> 
> 赞同：0
> 
> 时间：2012-06-22T16:44:23.620
> 
> 标签：javascript, jquery, browser, cross-browser

浏览器供应商是否针对 jQuery 进行了优化？

我知道这听起来很荒谬的反标准，但我可以想象浏览器供应商对内置在他们的 JS 编译器/解释器中的 jQuery 代码进行了优化。

例如，假设 JS 编译器/解释器看到 $('.blah > p')，浏览器可以说，嗯，我看到用户正在尝试抓取一个元素，而不是让 jQuery 进行所有浏览器检测，它可以只获取 [实际 DOM 对象]，并立即返回 $([实际 DOM 对象])。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T16:46:47.503

没有猜测`$`会破坏任何`$`用于不同目的的脚本。考虑这样的页面[（](http://jsfiddle.net/Paulpro/NqP2Y/)这实际上是一个相对于在野外可以找到的非常弱的示例，但我认为它仍然很好地证明了难度）：

```
<div class="bar">
    <div class="foo">
        <div class="bar">
            How will the browser know to select this div with the selector '.bar .foo .bar', without actually running this script the way it is designed?
        </div>
    </div>
</div>
<script>
    window.onload = function(){
        var x = $('.foo');
        console.log(x);
        console.log(x.selector) // '.bar .foo .bar'
    };
</script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>
    var $ = function(){
        return arguments[0];
    };
    $ = (function($){
        return function(selector){
            return jQuery('.bar ' + selector + ' ' + $('.bar'));
        }
    })($);
</script> 
```

浏览器提前知道要选择哪个 div 超出了优化范围。事实上，浏览器必须按照设计的方式运行脚本才能选择正确的 div。

然而，许多浏览器将 Javascript 编译为稍低级别的语言，例如 Java 或 C++ 代码。然后，如果浏览器下载并缓存 jQuery，一旦它被缓存，它就会在用户计算机上编译成一个表单。这不是一个`jQuery`特定的优化，因为它会发生在任何缓存的脚本中，但对于大型脚本（如`jQuery`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:57:18.987

目前没有浏览器供应商宣布这样的功能。

然而，这是可能的。您可以轻松地为 JS 引擎中最常用的 jQuery 版本存储已解析的 Javascript（IL/字节码，无论您在引擎中使用什么）以供参考，并且当传入函数与该签名匹配时，将其替换为本机版本。

我想您唯一需要考虑的是您将花费多少时间来实现它与现代 JIT 引擎的速度增益。因为它们中的一些已经将代码编译成某种本机形式，至少部分是这样，因此尚不清楚是否会有任何实质性的收益。

# testing - 测试 CouchDB 视图、过滤器、列表、显示等

> ID：11160587
> 
> 赞同：8
> 
> 时间：2012-06-22T16:44:30.583
> 
> 标签：testing, couchdb

哪些测试框架可用于测试我的 CouchDB 的视图及其`map`功能`reduce`、过滤器、列表、显示等？

理想情况下，该框架允许对每个功能进行单元测试，并提供支持以针对 CouchDB 实例上的数据集测试给定的一组视图、过滤器等。

我找到了一篇关于[为 CouchDB API 编写测试套件](http://web.archive.org/web/20121210024521/http://lenaherrmann.net/2010/04/28/writing-a-testsuite-for-the-couchdb-api)的博客文章，但它是从 2010 年开始的，我想知道从那以后发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T10:44:09.473

我会为 Node.js 使用[Expresso](http://visionmedia.github.com/expresso/ "快递") TDD 框架。编写 Node.js 应用程序的开销不会白费。

从下载页面安装 Node.js：[nodejs.org/download](http://nodejs.org/download/)

确保您还获得了 npm（node.js 包管理器）。

使用 expresso 框架，您可以轻松地测试 CouchDB 中的任何 RESTful 函数。

这是一个与 CouchDB 通信的示例 node.js 测试：

```
var http = require('http');
var url = require('url');
var log_level = 5;
var base_url = 'http://localhost:5984/';
var delete_db_at_end = false;

/**
* This test fetches all the data from a database and verifies that the data is
* returned as it should.
*/
exports.testCouchDBCartoonsAllDocs = function(beforeExit, assert) {
    curl('GET', base_url + 'cartoons/_all_docs', null, function(response) {
        assert.equal(7, response.total_rows);
        assert.equal('Donald Duck', response.rows[1].id);
    });
}

/**
* This test creates a database for this test only and deletes it at the end if the
* global parameter delete_db_at_end is set to true, otherwise it is left as is for
* human inspection.
* 
*/
exports.testCreateDatabaseTestAddAndDestroy = function(beforeExit, assert) {
    var dbname = 'test_db_cartoon';
    deleteExistingDatabase(dbname, assert, function(response) {
        /* Create the database */
        curl('PUT', base_url + dbname, null, function(response) {
            assert.equal(true, response.ok);
            curl('PUT', base_url + dbname + '/Donald+Duck', '{"publisher":"Walt Disney"}', function(response){
                assert.equal(true, response.ok);
                assert.equal('Donald Duck', response.id);
                curl('GET', base_url + dbname + '/Donald+Duck', null, function(response) {
                    assert.equal('Donald Duck', response._id);
                    assert.equal('Walt Disney', response.publisher);
                    /* Finally we delete the database from CouchDB */
                    if (delete_db_at_end) {
                        deleteExistingDatabase(dbname, assert, function(response) {
                            assert.equal(true, response.ok);
                        });
                    }
                });
            });
        });
    });
}

/**
* This is a helper function that deletes the database if it exists so
* that the tests can run even if they where interrupted.
*/
function deleteExistingDatabase(dbname, assert, callback) {
    curl('GET', base_url + dbname, null, function(response) {
        if (response.db_name === dbname) {
            log(1, 'About to delete the database ' + dbname);
            curl('DELETE', base_url + '/' + dbname, null, function(response) {
                callback(response);
            });
        } else {
            callback(response);
        }
    });
}

/**
* This is a helper method to manage the RESTful sending to the database
*/
function curl(method, urlString, payload, callback) {
    log(1, method + ' ' + urlString);
    var auth = 'Basic ' + new Buffer('username:password').toString('base64');
    log(7, auth);

    var options = url.parse(urlString);
    options.method = method;
    options.headers = {
            'Content-Encoding': 'UTF8',
            'Content-Type': 'application/json',
            'Authorization' : auth
    };
    log(7, options);

    var req = http.request(options, function (res) {
        var data = "";
        res.setEncoding('UTF8');
        res.on('data', function (chunk) {
            data += chunk;
        });
        res.on('end', function (chunk) {
            var response = JSON.parse(data);
            log(5, response);
            callback(response);
        });
    });
    if (payload) {
        req.write(payload);
    }
    req.end();
}

/**
* This simple logger logs message depending on the log_level set at
* the top of this file.
*/
function log(level, message) {
    if (level<=log_level) {
        console.log(message);
    }
} 
```

在存储此文件的同一文件夹中，执行以下命令：

```
npm install expresso 
```

通过发出以下命令运行测试：

```
node_modules/expresso/bin/expresso test.js 
```

这是上面命令的控制台输出：

```
GET http://localhost:5984/cartoons/_all_docs
GET http://localhost:5984/test_db_cartoon
{ error: 'not_found', reason: 'no_db_file' }
PUT http://localhost:5984/test_db_cartoon
{ total_rows: 7,
  offset: 0,
  rows: 
   [ { id: 'Batman', key: 'Batman', value: [Object] },
     { id: 'Donald Duck', key: 'Donald Duck', value: [Object] },
     { id: 'Iron Man', key: 'Iron Man', value: [Object] },
     { id: 'Mickey Mouse', key: 'Mickey Mouse', value: [Object] },
     { id: 'Spider-Man', key: 'Spider-Man', value: [Object] },
     { id: 'Superman', key: 'Superman', value: [Object] },
     { id: '_design/select', key: '_design/select', value: [Object] } ] }
{ ok: true }
PUT http://localhost:5984/test_db_cartoon/Donald+Duck
{ ok: true,
  id: 'Donald Duck',
  rev: '1-1c431dfb2c46991ec999743830a5363b' }
GET http://localhost:5984/test_db_cartoon/Donald+Duck
{ _id: 'Donald Duck',
  _rev: '1-1c431dfb2c46991ec999743830a5363b',
  publisher: 'Walt Disney' }

   100% 2 tests 
```

您可以轻松地扩展测试

```
exports.testname = function(beforeExit, assert) {
} 
```

# grails - activemq 2 监听器 grails

> ID：11160588
> 
> 赞同：1
> 
> 时间：2012-06-22T16:44:33.017
> 
> 标签：grails, activemq

我在 grails 中使用 activemq 插件。当我在tomcat中部署2个使用activemq的war文件时，tomcat永远不会完成启动。是因为在某些东西上使用了端口吗？

我在 WAR A 中的服务方法：

```
def jmsService
static transactional = false
static exposes = ['jms']

@Queue(name='msgs.new')    
def createMessage(msg) {}

    jmsService.send(queue:'msgs.new', json.toString()) 
```

我在战争B中的服务方法

```
def jmsService
static transactional = false
static exposes = ['jms']

@Queue(name='msg.new')    
def createMessage(msg) {}

    jmsService.send(queue:'msg.new', json.toString()) 
```

# java - 在 NullPointerException 和 IllegalArgumentException 之间进行选择以在对象构造时发出错误信号

> ID：11160589
> 
> 赞同：1
> 
> 时间：2012-06-22T16:44:33.283
> 
> 标签：java, exception, nullpointerexception

我有一个关于 Java 最佳实践的问题。我正在写一个类，它非常依赖于构造中的对象。事实上，如果在构造时传入的对象为空，那么大部分功能都没有意义。我认为最好在对象构造时将 null 作为参数传递的情况下抛出异常，但我不知道在这种情况下最合适的异常是什么。我应该抛出 NullPointer、IllegalArgument、Instatiation 还是初始化异常。

我已经看到这些都在整个 Java 源代码库中使用，我似乎无法区分为什么在某些情况下使用 NullPointer 而在其他情况下使用 IllegalArgument。我个人会认为，如果在构造时传入了错误的参数，则应该会发生一些初始化错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T16:47:36.763

首先，您*绝对*应该抛出异常。这只是正确的事情。

至于你应该扔`IllegalArgumentException`还是`NullPointerException`- Josh Bloch 在 Effective Java 中谈到了这一点，并普遍认为这`NullPointerException`是一个合理的选择。我不完全确定我是否同意（我可能会选择`IllegalArgumentException`），但最终这不太重要：您不应该直接捕获这些异常中的任何一个，并且堆栈跟踪会告诉您哪里有问题。

（很遗憾 Java 没有与 .NET 等效的 .NET [`ArgumentNullException`](http://msdn.microsoft.com/en-us/library/system.argumentnullexception.aspx)，这意味着它听起来的样子。）

就我个人而言，我是 Guava 课程的忠实粉丝[`Preconditions`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Preconditions.html)：

```
public class Foo {
  private final Bar bar;

  public Foo(Bar bar) {
    this.bar = Preconditions.checkNotNull(bar);
  }
} 
```

（有时与 . 的静态导入一起使用`checkNotNull`。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-22T16:50:50.770

IllegalArgument 向使用该代码的开发人员清楚地说明了问题是什么以及如何解决它。它还清楚地表明，如果没有该对象，该方法将无法工作。

NullPointer 意味着他们必须考虑一下问题是什么（不多），并且可能意味着代码更干净，但就像我上面所说的那样。从文档的角度来看，尚不清楚您的代码是否可以使用空值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T16:49:24.767

`NullPointerException`当您期望一个有效的对象但得到`null`而不是使用时。这在尝试调用`null`对象上的方法时尤其相关。这是它最常见的用途。但是，您的情况也可能有必要。

`IllegalArgumentException`当您收到的参数不是您期望的或错误的类型/样式/等时使用。*在我看来*，这在你的情况下会更合适。您期望一个有效的对象，但您收到`null`了一个参数。这个参数值是无效的 - 所以我会抛出`IllegalArgumentException`并在异常的消息中指定什么是错误的，例如：

```
public MyClass(InputObject obj) {
    if(obj == null) {
        throw new IllegalArgumentException("null passed to MyClass constructor");
    }

    ...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-22T22:45:26.153

如果您认为平台异常没有为客户提供正确数量的信息来理解和解决问题，您可以创建自己的在这方面更合适的异常，比如 .NET 的`ArgumentNullException`；这将告诉客户**问题是什么**以及**如何解决它**。

# javascript - 在这个模块中避免 eval

> ID：11160590
> 
> 赞同：1
> 
> 时间：2012-06-22T16:44:33.853
> 
> 标签：javascript, eval

我有这个存储一堆变量的模块模式。我想创建一个可以返回任何给定 var 的函数（真正的模块具有真正的功能——这只是一个精简的版本）。

```
var myObject = (function() {
  var _savings = '100',
      _year = new Date().getFullYear(),
      _phone = '1-800-555-1234';

return {
  getMe: function(param) {
    return eval(param);
} 
```

一个示例用法是`myObject.getMe('phone');`会弹出“1-800-555-1234”

我想避免使用 eval()，因为它太邪恶了。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:50:29.763

在 javascript 中，`object.field`等价于`object["field"]`.

现在，这里的问题是您创建了一些不属于对象的私有变量，因此访问它们会很棘手。

另一种方法是：

```
var myObject = (function() {
  var _privates = {
    savings: '100',
    year: new Date().getFullYear(),
    phone: '1-800-555-1234'
  };

return {
  getMe: function(param) {
    return _privates[param];
  }
}()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:48:18.947

尝试以下操作：

```
var myObject = (function() {
    var data = {
        savings: '100',
        year: new Date().getFullYear(),
        phone: '1-800-555-1234'
    };
    return {
        getMe: function(param) {return data[param];}
    };
})(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:47:06.933

以面向对象的方式执行此操作，您可以首先使用成员 *_savings*、*_year*、*_phone* 创建一个原型定义。将*getMe*添加到原型中：

```
var myClass = function() {
    this._savings = '100',
    this._year = new Date().getFullYear(),
    this._phone = '1-800-555-1234';

    myClass.prototype.getMe = function(param) {
       return this[param]; 
    }
} 
```

然后实例化对象并运行方法：

```
var myObject = new myClass();
console.log(myObject.getMe("_savings"));
  // "100" 
```

* * *

*编辑了原始答案*（正如 Dancrumb 指出的那样，这不起作用；它们是私人成员，因此在*getMe*函数内部无法看到它们）。

~~使用括号表示法：~~

返回这个[参数];

 ~~* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T16:52:08.887

```
var myObject = {
    phone: '1-800-555-1234',
    year: new Date().getFullYear(),
    savings: 100,
    getMe: function(param) {
        return this[param];
    }
};
alert(myObject.getMe('phone')); 
```~~

# java - 我可以对 2 个 JComboBoxes 内的项目进行数学运算吗？

> ID：11160592
> 
> 赞同：0
> 
> 时间：2012-06-22T16:44:43.720
> 
> 标签：java, swing, jcombobox

所以我有两个`JComboBox`es，我想做的是能够将一个中的值与第二个中的值进行比较，然后找出差异或总数。我希望能够在第一个框中输入时间（比如说`8:00 A.M`），然后我希望能够`5:00 P.M`在第二个框中输入，并让它显示`9`。

有没有办法做到这一点？

我没有任何工作代码，只需要朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T11:12:08.407

您可以`itemListener`在组合框和这些项目侦听器中添加，检查是否在其他组合框中选择了某些内容...因此您可以执行计算...。

# c# - C# 中带有单选按钮的 groupBox 的事件处理程序

> ID：11160594
> 
> 赞同：15
> 
> 时间：2012-06-22T16:44:54.820
> 
> 标签：c#, event-handling, radio-button, groupbox

我在 groupBox 中有一些单选按钮，我需要执行我可以称之为“单选按钮之一已更改”的操作，或者从单选按钮中找出更改的索引。我试图在事件列表中找到它，但找不到合适的。

**编辑：** 为了更清楚：我需要知道是否存在一些handel，我将为goupBox而不是单个radioButton编写处理程序方法。我知道如何使用 radiButton.checkedChanged，但这不是我发现的......或者不同的是，我需要知道 groupBox 有哪些选项来监控这个 groupBox 内部发生的事情——我的意思是只有 groupBox 的处理程序。我正在寻找处理程序“在组框中发生了什么事”或类似的情况（如果存在）。

它位于 Visual Studio 2012的**WFA（Windows 演示应用程序）中。**

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-06-22T16:56:44.213

我认为您想要做的是将所有 RadioButtons 的 CheckedChanged 事件连接到同一个处理程序。

```
public Form1()
{
    radioButton1.CheckedChanged += new EventHandler(radioButtons_CheckedChanged);
    radioButton2.CheckedChanged += new EventHandler(radioButtons_CheckedChanged);

    // ...
}

private void radioButtons_CheckedChanged (object sender, EventArgs e)
{
    RadioButton radioButton = sender as RadioButton;

    if (radioButton1.Checked)
    {
        // Do stuff 
    }
    else if (radioButton2.Checked)
    {
        // Do other stuff
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-17T13:34:22.777

我遇到了同样的问题：一个名为*Button Type* **(gbxButtonType)**的组合框有 6 个单选按钮，另一个名为*Icon Type* **(gbxIconType)**的组合框有 8 个单选按钮。当用户从每个组框中选择一个单选按钮时，将出现一个 MessageBox 并在单击*DisplayButton*后应用选择。我的问题是组框没有 CheckedChanged 事件。AKN 的解决方案完美运行：

```
public Form1()
    {
        InitializeComponent();

        for (int i = 0; i < gbxButtonType.Controls.Count; i++)
        {
            RadioButton rdb = (RadioButton)gbxButtonType.Controls[i];
            rdb.CheckedChanged += new System.EventHandler(gbxButtonType_CheckedChanged);
        }

        for (int i = 0; i < gbxIconType.Controls.Count; i++)
        {
            RadioButton rdb = (RadioButton)gbxIconType.Controls[i];
            rdb.CheckedChanged += new System.EventHandler(gbxIconType_CheckedChanged);
        }
    }

private void gbxIconType_CheckedChanged(object sender, EventArgs e)
    {
        if (sender == rdbAsterisk)
        {
            iconType = MessageBoxIcon.Asterisk;
        }
        else if (sender == rdbError)
        {
            iconType = MessageBoxIcon.Error;
        }
        ...
        else
        {
            iconType = MessageBoxIcon.Warning;
        }
   } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-22T17:02:35.727

据我所知，没有任何内置功能。

将标记属性设置为某种指示符（0 到 n）就可以了。

添加一个 CheckChangedHandler

将所有按钮 CheckChanged 事件指向它。

然后类似的东西。

```
private void radioButtons_CheckedChanged (object sender, EventArgs e) 
{     
  RadioButton radioButton = sender as RadioButton;      
  int buttonid = (int)radioButton.Tag;
  switch (buttonid)
  {
    case 0 : // do something; break
  }
} 
```

如果您有其中的一些，我会看一下 radiogroup 组件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-12-21T18:14:42.197

类似于 davenewza 的答案（可能应该是评论，但我的声誉不足），但事件仅针对整个单选按钮组触发一次。

```
public Form1()
{
    // Add a "CheckedChanged" event handler for each radio button.
    // Ensure that all radio buttons are in the same groupbox control.
    radioButton1.CheckedChanged += new EventHandler(radioButtons_CheckedChanged);
    radioButton2.CheckedChanged += new EventHandler(radioButtons_CheckedChanged);
}

private void radioButtons_CheckedChanged (object sender, EventArgs e)
{
    // Do stuff only if the radio button is checked (or the action will run twice).
    if (((RadioButton)sender).Checked)
    {
        if (((RadioButton)sender) == radioButton1)
        {
            // Do stuff 
        }
        else if (((RadioButton)sender) == radioButton2)
        {
            // Do other stuff
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-22T16:55:22.107

System.Windows.Forms.RadioButton.CheckedChanged

是你需要的事件

所以做类似的事情：

```
 public Form1()
    {
        InitializeComponent();

        this.radioButton1.CheckedChanged += new EventHandler(radioButton1_CheckedChanged);
    }

    private void radioButton1_CheckedChanged(object sender, EventArgs e)
    {
        // your action
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-02-28T04:26:34.100

**Groupbox 将限制仅选中一个单选按钮**

所以**Setp1：**您可以为所有单选按钮分配一个“CheckedChanged”事件处理程序

```
private void initRadio()
{
        radio_button1.CheckedChanged += Radio_show_CheckedChanged;
        radio_button2.CheckedChanged +=Radio_show_CheckedChanged;
} 
```

和**Setp2：**像这样实现这个事件处理程序（按单选按钮的文本过滤）

```
private void Radio_show_CheckedChanged(object sender, EventArgs e)
{
    RadioButton radioButton = sender as RadioButton;
    if (radioButton.Checked == true) { //limited only checked button do function
        switch (radioButton.Text)
        {
            case "name1":
                // do your stuff ...
                break;
            case "name2":
                // do your stuff ...
                break;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-13T13:42:08.250

**我认为您想使用 groupbox 控件本身**来处理 groupbox 内的一些单选按钮的选择。

可能是你想要这个基本上是为了避免代码重复。

（即）为设计器中的所有单选按钮添加检查更改事件，当有更多控制时，这可能很乏味。既然它已经存在于一个组下，为什么不使用组控件对象来操作其中的控件并设置事件。

这就是我理解您的问题的方式，因此解决方案如下所示。

为组框中的所有单选按钮控件设置一个通用处理程序

```
for (int i = 0; i < groupBox.Controls.Count; i++)
{
    RadioButton rb = (RadioButton)groupBox.Controls[i];
    rb.CheckedChanged += new System.EventHandler(evntHandler);
} 
```

在处理程序中，您可以根据其他人的指示确定更改了哪个按钮并执行必要的操作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-01-12T11:11:08.357

//这里由乔克·弗兰克·哈利迪提供

```
 //^subscribe events to radio button check changed 
    private void seriesTxtBxEvent()
    {
        //Show txtBx
        this.radBtn_RoomSeries.CheckedChanged += new EventHandler(showSeriesTxtBx_Event);
        //Hide txtBx
        this.radBtn_RoomNumber.CheckedChanged += new EventHandler(hideSeriesTxtBx_Event);
        this.radBtn_RoomName.CheckedChanged += new EventHandler(hideSeriesTxtBx_Event);
        this.radBtn_RoomLevel.CheckedChanged += new EventHandler(hideSeriesTxtBx_Event);
        this.radBtn_RoomDep.CheckedChanged += new EventHandler(hideSeriesTxtBx_Event);
    }

    private void hideSeriesTxtBx_Event(object sender, EventArgs e)
    {
        tbx_SheetSeries.Visible = false;
    }

    private void showSeriesTxtBx_Event(object sender, EventArgs e)
    {
        tbx_SheetSeries.Visible = true;
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-20T03:15:30.217

1.  在 Designer Events 列表中的一个单选按钮上创建 Event Checked_Changed。

2.  从每个单选的 Checked_Changed 事件前面的下拉列表中向每个单选按钮添加相同的事件

3.  内部检查更改事件使用

    ```
    private void CheckedChanged(object sender,EventArgs e)
    {
     var radio = groupBox.Controls.OfType<RadioButton>                  
                ().FirstOrDefault(r => r.Checked).Name;
    } 
    ```

你可以得到哪个收音机现在是活跃的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-02-21T10:46:35.193

您也许可以使用 Timer 来做到这一点，但这不利于优化，简单的解决方案是，对于每个单选按钮，您只需添加一个函数作为 ChekedChanged 事件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-11T15:56:35.023

1.  通过双击任何单选按钮创建一个 Checked 事件，复制 Visual Studio 为该事件创建的方法的名称
2.  转到所有单选按钮并将事件更改为从“属性资源管理器”>“事件部分”复制的事件
3.  在生成的方法中使用以下代码。这将触发所有单选按钮的事件，但只有一次“做你的事”

代码：

```
private void radioButtons_CheckedChanged (object sender, EventArgs e)
{
    RadioButton rb = sender as RadioButton;

    if (rb.Checked == false) return;

    // Do your thing
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-02-13T14:52:32.060

```
//Form Start

void MainFormLoad(object sender, EventArgs e)
{

    Control.ControlCollection locais =  groupBoxLocalização.Controls;

        foreach (CheckBox chkBox in locais)
        {
            chkBox.MouseUp += chkBoxLocais_MouseUp;
        }
}

// Event
void chkBoxLocais_MouseUp(object sender, MouseEventArgs e)
{

    //Tratar individualmente
    CheckBox chk = (CheckBox)sender;

    //ou para tratar todos objetos de uma vez

    Control.ControlCollection locais =  groupBoxLocalização.Controls;
    foreach (CheckBox chkBox in locais) {
        //chkBox....
    }

} 
```

# ajax - 如何确保托管在 S3 上的 ajax 内容被索引？

> ID：11160600
> 
> 赞同：2
> 
> 时间：2012-06-22T16:45:33.633
> 
> 标签：ajax, seo, amazon-s3

我有许多完全托管在 Amazon S3 上的网站，但页面是通过 JavaScript 生成的。我想确保这些网站已被 Google 索引，但由于它们托管在 S3 上，我似乎没有提供页面的 _escaped_fragment_ 版本的机制。有谁知道如何将 Ajax 内容编入索引？我宁愿不必复制我的模板服务器端。

这是我的一个网站的示例： [http ://www.web608.org/](http://www.web608.org/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T01:11:50.363

没有真正简单的方法可以做到这一点。我建议您阅读 Google 关于此主题的建议：

[https://developers.google.com/webmasters/ajax-crawling/](https://developers.google.com/webmasters/ajax-crawling/)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-22T17:55:11.607

我见过的最佳实践是渐进增强。用纯 html 创建一个工作页面，然后使用 JavaScript 让它变得很酷。

# javascript - 无法写入 asp.net 中的脚本标记

> ID：11160602
> 
> 赞同：0
> 
> 时间：2012-06-22T16:45:58.133
> 
> 标签：javascript, asp.net, nullpointerexception, servercontrols

我有一个脚本，我只想在满足某个条件时才加载，所以我想我应该这样做：

```
//Head tag
<script type="text/javascript" id="scriptArea" runat="server"></script>
//Rest of the page 
```

.cs（Page_Load 事件）

```
if(someCondition)
{
    scriptArea.InnerHtml = "Javascript code";
} 
```

问题是我得到一个空指针异常，当它停止时，我发现 scriptArea 是`null`出于某种原因。为什么会发生这种情况，您知道另一种解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:48:43.690

使用 asp.net webforms 和脚本`runat="server"`最终成为服务器执行的代码，请参阅有关此文档的[MSDN 。](http://msdn.microsoft.com/en-us/library/f0111sbh.aspx)

如果你只想要javascript，试试这个：

```
<script type="text/javascript">
    <asp:literal id="scriptArea" runat="server" />
</script> 
```

然后在你的代码后面

```
scriptArea.Text = "Javascript code"; 
```

# c# - 在 Outlook 中执行搜索查询

> ID：11160610
> 
> 赞同：8
> 
> 时间：2012-06-22T16:46:20.053
> 
> 标签：c#, search, outlook

您好我想知道是否可以从我的 WinForms 应用程序向 Outlook 2010 发送搜索查询。也就是说，不是像我一直在搜索和发现的那样搜索 .PST 文件，而是尝试在 Outlook 中显示结果列表，就好像我自己在搜索框中键入一样。

如果可能，任何示例代码都会有所帮助。此外，是否可以直接在所有邮件项目中执行搜索，而不是通常在您进行搜索时梳理当前文件夹。谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-22T18:29:19.320

如果您想访问 Outlook 数据（例如邮件），您必须将 COM 引用添加到 Microsoft Outlook XX 对象库。

对于 Outlook，您可以使用 COM 互操作。打开“添加引用”对话框并选择 .NET 选项卡，然后添加对 Microsoft.Office.Interop.Outlook 程序集的引用。

![在此处输入图像描述](../Images/4c8f10bff63c760cee1c7841444460d9.png)

之后不要忘记将命名空间“Microsoft.Office.Interop.Outlook”添加到您的 using 子句中。

现在您可以创建 Outlook 应用程序对象的实例：

```
Microsoft.Office.Interop.Outlook.Application outlook;
outlook = new Microsoft.Office.Interop.Outlook.Application(); 
```

让我们在您的收件箱上执行查询：

```
MAPIFolder folder =
    outlook.GetNamespace("MAPI").GetDefaultFolder(OlDefaultFolders.olFolderInbox);
    IEnumerable<MailItem> mail = 
        folder.Items.OfType<MailItem>().Where(m => m.Subject == "Test").Select(m => m); 
```

您将要搜索的文件夹指定为 GetDefaultFolder(...) 方法的参数。您可以指定收件箱以外的其他文件夹。

*   olFolderSentMail
*   ol文件夹发件箱
*   olFolderJunk
*   ...

查看 MSDN 上的每个可能值：

[OlDefaultFolders 枚举](http://msdn.microsoft.com/en-us/library/ff861868.aspx)

Stefan Cruysbergs 创建了一个[OutlookProvider 组件](http://www.scip.be/index.php?Page=ArticlesNET05&Lang=NL)，该组件充当 Outlook 应用程序对象的包装器。您可以使用 LINQ 查询此提供程序并检索联系人、邮件等数据。只需[下载](http://www.scip.be/index.php?Page=DownloadNETOfficeItems&Lang=NL)他的代码并查看。这应该足以让你开始。

# forms - 在我调整它们之后，是否可以让 Access 停止自动调整表单上的控件的大小？

> ID：11160611
> 
> 赞同：1
> 
> 时间：2012-06-22T16:46:23.923
> 
> 标签：forms, ms-access, controls, vba

例如，我有一个文本框，我需要一个`Left`恰好为 18.281cm 的属性，但只要我按下回车键，它就会自动更改为 18.282cm。

最大的问题是它改变数字的方式是不可预测的。例如，它似乎只对特定数字执行此操作，因为有时它会单独留下数字。

还有一点要提的是，它改变数字的量是不同的，并不总是增加0.001cm，有时甚至会减少。有时候我可以欺骗它，所以如果它不让我把它改成18.279cm，我可以输入18.280cm，然后它会自动把它改成18.279cm，但这种情况很少发生。

不同的控件也会出现此问题，而不仅仅是`Left`. 它还通过另外`Height`两个`Width`示例执行此操作。我一直在尝试搜索发生这种情况的另一个实例，但我找不到任何其他人发生此问题的记录。有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T16:56:12.293

这样做的原因是因为测量值实际上是[**缇**](https://en.wikipedia.org/wiki/Twip)

18.280cm 不是一个确切的缇数，所以它计算到最近的
缇 18.280cm = 10363.464566929 缇

10363 缇 = 18.279180556cm
10364 缇 = 18.280944444cm

# android - Android：图像从 XML 布局到 Bitmaps in Code 解决 OOM 错误

> ID：11160612
> 
> 赞同：1
> 
> 时间：2012-06-22T16:46:26.857
> 
> 标签：android, xml, image, out-of-memory, bitmapfactory

我越来越臭名昭著了 `java.lang.OutOfMemoryError: bitmap size exceeds VM budget error`。我有几个 XML 布局，并且很多元素都有图像（按钮背景、线性布局背景等）。在完成发布的问题之后，比如[将图像加载到 Bitmap 对象时出现奇怪的内存不足问题](https://stackoverflow.com/questions/477572/android-strange-out-of-memory-issue-while-loading-an-image-to-a-bitmap-object/823966#823966)和[外部分配太大对于此过程](https://stackoverflow.com/questions/8250704/external-allocation-too-large-for-this-process)和[OutofMemoryError：位图大小超出 VM 预算（Android）](https://stackoverflow.com/questions/1586685/outofmemoryerror-bitmap-size-exceeds-vm-budget-android)和[Android：加载图像时出错：OutOfMemoryError：位图大小超出 VM 预算](https://stackoverflow.com/questions/10786996/android-error-loading-images-outofmemoryerror-bitmap-size-exceeds-vm-budget) 我知道我应该使用这些`BitMapFactory`方法。但是我所有的图像都是在我`XML`的例子中定义的，

```
 <ImageView
        android:layout_width="80dp"
        android:layout_height="20dp"
        android:layout_marginBottom="3dp"
        android:src="@drawable/username" /> 
```

如何从在我的 XML 中定义图像到以编程方式定义它们，以便我可以尝试使用`BitMapFactory`它来消除我的`OOM`异常？

# c# - 从句子中获取数字的最佳方法是什么？

> ID：11160613
> 
> 赞同：0
> 
> 时间：2012-06-22T16:46:28.167
> 
> 标签：c#, regex

我只是想得到一个句子中的数字。

它们可以是货币、常规数字、+ 和 -。

示例是：

健身房会员**7**个月 @每月**20****美元 140.00 美元**

健身房会员退款**$-100.00**

我一直在使用这个表达式：

\$?(\d{1,3},?(\d{3},?)*\d{3}(.\d{0,2})?|\d{1,3}(.\ d{2})?)

我一直在使用这个网站来测试它。

[http://rubular.com/](http://rubular.com/)

唯一的问题是它没有收到**$-100.00，**它只收到**100.00**。

如果有更好的方法可以做到这一点，或者这是唯一的方法，我也很感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:48:05.390

> \$？**-？**(\d{1,3},?(\d{3},?)*\d{3}(.\d{0,2})?|\d{1,3}(.\d{2 })?)

只需在`-?`那里添加一个。

是否有更好的方法取决于您的要求。如果这对您来说效果很好并且可以满足您的所有需求，那么我认为没有理由使用其他东西。

# ruby-on-rails - Paypal - 我在哪里可以找到沙盒帐户中的“加密支付设置”？

> ID：11160619
> 
> 赞同：1
> 
> 时间：2012-06-22T16:46:56.473
> 
> 标签：ruby-on-rails, paypal

我创建了沙盒帐户，在此帐户中我为卖家和买家创建了一个帐户。现在我需要获取**Encrypted Payment Settings**，但是当我点击仪表板中的 PROFILE 链接时，我看到的只是我名字的输入......

我正在尝试遵循本教程：[http ://www.fortytwo.gr/blog/14/Using-Paypal-with-Rails](http://www.fortytwo.gr/blog/14/Using-Paypal-with-Rails)

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T22:26:15.877

Paypal 不是用户最友好的网站。您所遵循的教程已经很老了，从那时起他们已经大大改变了网站的工作流程。

转到测试帐户，如果您还没有创建一个商业帐户。选择新创建的业务帐户，然后单击“进入沙盒测试站点”。您将被重定向到新的登录屏幕，输入您的测试企业帐户登录凭据。现在您将看到一个成熟的 Paypal 商业帐户。单击个人资料，您将在那里看到**加密付款设置**。

# wpf - 使用 UIPropertyMetadata 的 .NET 4.0 依赖属性不起作用

> ID：11160620
> 
> 赞同：1
> 
> 时间：2012-06-22T16:46:56.597
> 
> 标签：wpf, .net-4.0, dependency-properties

我有以下在 .NET 3.5 中完美运行的依赖属性定义：

```
 public static readonly DependencyProperty SelectedIdsProperty =
         DependencyProperty.Register(
         "SelectedIds",
         typeof(IEnumerable),
         typeof(AddressBookSelector),
         new UIPropertyMetadata(null, UpdateUIText));

    public IEnumerable SelectedIds 
        {
            get { return (IEnumerable)GetValue(SelectedIdsProperty); }
            set 
            { 
                SetValue(SelectedIdsProperty, value);                 
            }
        }

   static void UpdateUIText(DependencyObject depObj, DependencyPropertyChangedEventArgs e)
        {            
            (depObj as AddressBookSelector).UpdateRichTextBox();            
        } 
```

当我编译代码以在 .NET 4.0 上运行时，当 SelectedIds 的值发生更改时，不再调用 UpdateUIText。我该如何纠正？

# java - 如何传递命令行参数包括“|” 到java程序

> ID：11160622
> 
> 赞同：4
> 
> 时间：2012-06-22T16:47:06.060
> 
> 标签：java, command-line, arguments

传递给我的 java 程序的参数之一是这样的，`ab|cd`. 最初，当我像这样运行java程序时，

> $ java 类名 ab|cd

它失败了，因为`|`在 linux shell 中被解释为管道符号。所以只有`ab`传入java程序。所以我做了第二次尝试：

> $ java 类名 "ab|cd"

这一次，`"ab|cd"`是传入的，但该值包含双引号。该程序真正打算拥有的是`ab|cd`. 如何在没有引号的情况下传递正确的值？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-22T16:50:16.073

在命令 shell 中，您可以使用 '\' 字符转义字符。

```
 java className ab\|cd 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T16:54:13.310

尝试（对于 Linux）：

```
$ java className ab\|cd 
```

对于 Windows：

```
java className ab^|cd 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-22T16:57:59.440

尝试这个，

`"\" is used inorder to nullify the effect of the characters which have special meanings.`

```
java className ab\|cd 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-22T16:54:20.953

您可以像以下代码一样使用转义字符：

```
$ java className ab\|cd 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-06-22T16:53:11.853

也许试试这个：

```
arg="ab|cd"
java className $arg 
```

# php - 使用 PHP 变量自定义 SQL 语句？

> ID：11160626
> 
> 赞同：1
> 
> 时间：2012-06-22T16:47:23.057
> 
> 标签：php, mysql, sql

我正在编写一个函数，如果它已经存在，它将删除一个表。它将询问用户他们想调用什么表，获取该响应并将其放入 php 变量中。我想为 sql 创建一个自定义的 drop 语句，以便 sql 没有错误。这就是我所拥有的。

```
$table = $_POST["tablename"];      //gets table name from html page

drop_table($db, $table);           //call function

function drop_table($db,$table){            
    $drop = "DROP TABLE IF EXISTS .$table. ";     //this is the part I can't figure out. How do I add in the table name to the statement, 
    $q = mysqli_query($db, $drop); //since the sql statement has to be in quotes?
} 
```

谢谢！

P.Ss 这是一个仅用于分析的内部系统。如果我和我的同事都在使用它，不用担心丢桌子

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T16:50:33.320

您的问题是尝试`$table`用点连接时出现语法错误。删除那些。

```
$drop = "DROP TABLE IF EXISTS $table "; 
```

但*更大的*问题是您允许最终用户删除数据库中的任何表，因为您没有以任何方式过滤输入。

您需要确保您的用户只在当前选定的数据库中删除表，这意味着至少不允许`.`内部`$table`阻止类似的事情`$table = 'information_schema.user'`

```
if (strpos($table, '.') !== FALSE) {
  // don't allow the action!
} 
```

要采取的另一个步骤是在执行语句之前验证 的值是否`$table`存在于`information_schema.TABLES`并且属于正确的当前数据库。`DROP`

```
// If this returns 1, the table exists in the correct database and can be dropped.
// note that $table is escaped here.  I didn't fill in the mysqli_query() but obviously
// this is to be executed.  It would be even better with a MySQLi prepared statement
"SELECT 1 
 FROM information_schema.TABLES
 WHERE
   TABLE_SCHEMA='the_allowed_database' 
   AND TABLE_NAME='" . mysqli_real_escape_string($db, $table) . "'"` 
```

通过此检查后，您最好为在环境中灵活并因此可以删除的表指定一个前缀，这样用户就无法删除活动数据库中的*每个*表。例如，只允许删除前缀为 的表`usertable_`。

```
if (strpos($table, 'usertable_') !== 0) {
   // don't permit deletion
} 
```

这是一个非常难以保护的设计，我建议您退后一步，重新考虑这里的策略。在允许用户根据表单输入删除表时，您需要非常小心。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T16:50:36.127

你的意思是：

```
$drop = "DROP TABLE IF EXISTS " . $table; 
```

我真的，真的希望您已经考虑过有人能够通过在 URL 中输入正确的名称从您的数据库中删除表的后果。

# ruby-on-rails - Rails 3使用activerecord将外键与ID列表进行比较

> ID：11160630
> 
> 赞同：1
> 
> 时间：2012-06-22T16:47:28.463
> 
> 标签：ruby-on-rails, arrays, postgresql, in-clause

我在两个模型之间有关系，**Registers**和**Competitions**。我有一个非常复杂的动态查询正在构建中，如果条件合适，我需要将注册记录限制为仅其竞赛父级满足特定条件的那些。为了在没有从竞争表中选择的情况下做到这一点，我想了一些类似...

```
Register.where("competition_id in ?", Competition.where("...").collect {|i| i.id}) 
```

这会产生这个 SQL：

```
SELECT "registers".* FROM "registers" WHERE (competition_id in 1,2,3,4...) 
```

我不认为 PostgreSQL 喜欢 in 参数没有被括号包围的事实。如何将注册外键与竞赛 ID 列表进行比较？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T20:40:58.950

您可以缩短一点并跳过收集（这在 3.2.3 中对我有用）。

```
Register.where(competition_id: Competition.where("...")) 
```

这将导致以下 sql：

```
SELECT "registers".* FROM "registers" WHERE "registers"."competition_id" IN (SELECT "competitions"."id" FROM "competitions" WHERE "...") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T17:00:34.323

试试这个：

```
competitions = Competition.where("...").collect {|i| i.id}
Register.where(:competition_id => competitions) 
```

# c# - 为什么 Lucene 不索引/搜索“-”字符....？

> ID：11160636
> 
> 赞同：0
> 
> 时间：2012-06-22T16:47:41.987
> 
> 标签：c#, lucene.net

我对 Lucene 有真正的问题。我必须在大量代码中找到错误，但我无法弄清楚问题所在。基本上我们在 global.asax 文件中有一些代码，它会创建索引。然后我们有一些搜索的代码。我只是无法判断是搜索代码还是索引代码是问题所在。有什么方法可以打开索引以查看它是否会接受“-”字符？

# python - sqlite3.OperationalError：无法识别的令牌：“01T00”Python 日期戳

> ID：11160637
> 
> 赞同：6
> 
> 时间：2012-06-22T16:47:43.017
> 
> 标签：python, sqlite

我在将值插入 SQLite 数据库时遇到问题。我从挪威议会网站 data.stortinget.no 下载的数据。我得到的错误是： sqlite3.OperationalError: unrecognized token: "01T00"

这是发生错误的方法：（我知道此摘录中的缩进错误）

```
def get_perioder(cur):
DOK = "stortingsperioder"
try:
     page = urllib2.urlopen(SITE+DOK)
except:
    print "Failed to fetch item "+DOK
if page:
    tree = ElementTree.parse(page)
    root = tree.getroot()
    top = list(root)[2]
    elements = list(top)
    for el in elements:
        fra = el.find('{http://data.stortinget.no}fra').text
        per_id = el.find('{http://data.stortinget.no}id').text
        til = el.find('{http://data.stortinget.no}til').text
        print "id: %s fra: %s til: %s" % (per_id, fra, til)
        cur.execute("INSERT INTO perioder(fra, id, til) VALUES(%s,%s,%s)" % (fra, per_id, til))
else:
    print "Could not load page: "+DOK 
```

cur.execute 上面的 print 打印的消息是： id: 2009-2013 fra: 2009-10-01T00:00:00 til: 2013-09-30T23:59:59 整个错误跟踪是：

```
BigMac:Stortingsdata ola$ python getBasicData.py 
id: 2009-2013 fra: 2009-10-01T00:00:00 til: 2013-09-30T23:59:59
Traceback (most recent call last):
  File "getBasicData.py", line 169, in <module>
    get_perioder(cur)
   File "getBasicData.py", line 26, in get_perioder
     cur.execute("INSERT INTO perioder(fra, id, til) VALUES(%s,%s,%s)" % (fra, per_id, til))
 sqlite3.OperationalError: unrecognized token: "01T00" 
```

我参考了 SQLite 手册，似乎支持该格式，所以我想知道问题出在哪里。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-22T16:55:49.703

正确的方法是使用参数化查询。
例子：

```
cur.execute("""INSERT INTO perioder(fra, id, til) 
               VALUES (?,?,?);""", (fra, per_id, til)) 
```

每个数据库驱动程序都有一个特定的参数“样式”。
在 SQLite 的情况下，参数样式是`?`.

另请注意，参数值作为第二个参数传递给`execute()`.
使用字符串插值会使您容易受到各种引用问题（例如将您带到这里的问题）和 SQL 注入攻击的可能性。

有关更多信息，请阅读[DB-API](http://www.python.org/dev/peps/pep-0249/)和[数据库编程 wiki](http://wiki.python.org/moin/DatabaseProgramming/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-08T18:51:22.253

如果您想`TEXT`在 SQLite 中将日期标记存储为字符串 ( )，我建议您将要执行的文本格式化如下：

```
cur.execute("""INSERT INTO perioder(fra, id, til) 
           VALUES (\"%s\",\"%s\",\"%s\")""" % (fra, per_id, til)) 
```

如果您插入的值没有逗号，SQLite 会返回错误。`\"%s\"`使用而不是格式化文本`%s`将在格式化字符串中插入带引号的字符串值：

```
"INSERT INTO perioder(fra, id, til) 
           VALUES ("2009-2013", "2009-10-01T00:00:00","2013-09-30T23:59:59")" 
```

# android - 带有按钮的列表项不再可点击

> ID：11160639
> 
> 赞同：20
> 
> 时间：2012-06-22T16:47:44.163
> 
> 标签：android, listview, button

我有一个列表项，里面有一个按钮。

显示按钮时，列表项不再可单击。为了让它再次可点击，我用视图替换了按钮。问题是，当单击列表项时，按钮会更改背景图像（就像单击它一样）。如何避免这种不良行为？

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-06-22T12:48:12.507

为您的按钮设置以下属性

```
 android:focusable="false"
  android:focusableInTouchMode="false" 
```

对于 ImageButton，还要将以下内容添加到父视图

```
 android:descendantFocusability="blocksDescendants" 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-06-22T17:21:17.110

其实我刚刚找到了一个很好的解释：[http ://android.cyrilmottier.com/?p=525](http://android.cyrilmottier.com/?p=525)

问题和解决方案在那里得到了很好的解释。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-05-05T13:22:35.990

@Matroska 提供的链接部分回答了这个问题：
您必须添加

```
android:descendantFocusability="blocksDescendants" 
```

到定义 ListView 项目布局的父 ViewGroup。

注意：这将不再允许您专注于带有硬件按钮的内部按钮。（对不起，我还不能评论）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-23T06:52:16.467

你可以试试这个：

```
 yourButton.setFocusable(false);
             yourButton.setFocusableInTouchMode(false); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-21T10:26:13.100

下面是 ListView 中可点击按钮的示例。如果要下载项目，可以从我的网站下载 IntelliJ Gradle 项目：http: [//developersfound.com/ListButtonClickExample.zip](http://developersfound.com/ListButtonClickExample.zip)

此示例中的自定义适配器具有单击侦听器，而不是位于 Fragment 或 Activity 中的侦听器。这样做的方式是只有在侦听器对象上，并且所有按钮都绑定到它们以提高效率。

这是 ListItem 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context="com.jc_systems.listbuttonclickexample.app.ItemFragment">

    <LinearLayout
        android:id="@+id/test_container"
        android:orientation="horizontal"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">

        <ImageView
            android:id="@+id/image_list_image"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/exaple_icon"
            android:layout_weight=".1"
            android:layout_gravity="left|top"/>

        <TextView
            android:id="@+id/lbl_list_item"
            android:layout_width="168dp"
            android:layout_height="wrap_content"
            android:text="I think this should take up two lines..."
            android:layout_marginLeft="5dp"
            android:layout_marginRight="5dp"
            android:gravity="center_vertical|center_horizontal"
            android:layout_gravity="center_vertical"/>

        <Button
            android:id="@+id/cmd_list_button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Hello"
            android:layout_weight="0.2"
            android:paddingLeft="0dp"
            android:paddingRight="0dp"
            android:paddingTop="0dp"
            android:paddingBottom="0dp"
            android:layout_gravity="right|top"/>

    </LinearLayout>

</FrameLayout> 
```

这是CustomAdapter：

```
import android.app.Activity;
import android.app.AlertDialog;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;

import java.util.ArrayList;

public class MyCustomAdapter extends ArrayAdapter {

    private final ArrayList<FragmentItems> list;
    private static Activity context;
    private View.OnClickListener adaptrDynaListener = null;

    public MyCustomAdapter(Activity context, ArrayList<FragmentItems> list) {

        super(context, R.layout.fragment_items, list);
        this.context = context;
        this.list = list;

        adaptrDynaListener = new View.OnClickListener() {
            @Override
            public void onClick(View v) {

                String buttonText = ((Button) v).getText().toString();
                new AlertDialog.Builder(MyCustomAdapter.context).setTitle("Alert").setMessage(buttonText).setNeutralButton("OK", null).show();

            }

        };

    }

    static class ViewHolder {

        protected ImageView image_list_image;
        protected TextView lbl_list_item;
        protected Button cmd_list_button;

    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View view = null;
        ViewHolder viewHolder = new ViewHolder();

        if (convertView == null) {

            LayoutInflater inflator = context.getLayoutInflater();
            view = inflator.inflate(R.layout.fragment_items, null);
            viewHolder.image_list_image = (ImageView) view.findViewById(R.id.image_list_image);
            viewHolder.lbl_list_item = (TextView) view.findViewById(R.id.lbl_list_item);
            viewHolder.cmd_list_button = (Button) view.findViewById(R.id.cmd_list_button);
            viewHolder.cmd_list_button.setTag(viewHolder);
            view.setTag(viewHolder);

        }
        else {

            view = convertView;
            viewHolder = (ViewHolder) view.getTag();

        }

        ViewHolder holder = (ViewHolder) view.getTag();

        holder.lbl_list_item.setText(list.get(position).getMessage());
        holder.cmd_list_button.setText(list.get(position).getButtonText());
        holder.cmd_list_button.setOnClickListener(adaptrDynaListener);

        return view;

    }//public View getView(int position, View convertView, ViewGroup parent)

    public int getCount() {

        if(list.size() <= 0) {

            return 1;

        }

        return list.size();

    }

    public Object getItem(int position) {

        return position;

    }

    public long getItemId(int position) {

        return position;

    }

} 
```

我已经非常广泛地测试了这个适配器模式，它在 ListView、ListActivities 和 ListFragments 中看起来非常稳定。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-06-22T17:10:30.230

您可以创建一个包含视图单击行为的 xml 文件。创建一个 xml 文件 custom_button.xml（或任何你想调用的文件）并用以下代码填充它：

```
<?xml version="1.0" encoding="UTF-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <!-- Focused -->
    <item android:state_focused="true" android:state_pressed="false" android:color="@color/black"/>
    <!-- Pressed -->
    <item android:state_focused="false" android:state_pressed="true" android:color="@color/black"/>
    <!-- Focused+Pressed -->
    <item android:state_focused="true" android:state_pressed="true" android:color="@color/black"/>
    <!-- Disabled -->
    <item android:state_enabled="false" android:color="@color/dark_grey_text"/>
    <!-- Default -->
    <item android:color="@color/white"/>

</selector> 
```

然后您可以更改

```
android:color="" 
```

到

```
android:drawable="" 
```

并将它们分配给您在可绘制文件夹中拥有的任何可绘制资源。然后在包含视图的布局的 xml 文件中，添加：

```
android:background="custom_button" 
```

# python - 如何将模块导入为 __main__？

> ID：11160643
> 
> 赞同：12
> 
> 时间：2012-06-22T16:47:58.290
> 
> 标签：python

我有一个具有通常的模块

```
if __name__ == '__main__':
    do stuff... 
```

成语。

我想从另一个模块导入它，并欺骗它运行该代码。有没有办法做到这一点？

我应该提一下，由于我不会在这里讨论的原因，我无法更改导入模块中的代码。我需要以某种方式修改导入过程，以便在导入时它的名称是主要的，可能使用 ihooks 或类似的。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-07-14T00:55:08.450

正如其他答案中指出的那样，这是一个坏主意，您应该以其他方式解决问题。

无论如何，Python 的做法是这样的：

```
import runpy
result = runpy._run_module_as_main("your.module.name")) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-22T16:51:34.987

有，执行脚本而不是导入它。但我认为这是一个非常骇人听闻的解决方案。

然而，理想的模式是：

```
def do_stuff():
    ... stuff happens ...

if __name__ == '__main__':
    do_stuff() 
```

这样你就可以做到：

```
from mymodule import do_stuff
do_stuff() 
```

**编辑**：在澄清无法编辑模块代码后回答。

**我永远不会在任何生产代码中推荐这个，这是一个“自担风险”的解决方案。**

```
import mymodule

with open(os.path.splitext(mymodule.__file__)[0] + ".py") as fh:
    exec fh.read() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-22T16:50:45.660

将该代码放入一个函数中，并从您将其导入的模块中调用它。

```
def stuff():
    ...

if __name__ == '__main__':
    stuff() 
```

然后在模块中将其导入：

```
import module
module.stuff() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-27T09:08:36.733

正确答案已经给出，但它仅限于评论中（请参阅[如何将模块导入为 __main__？](https://stackoverflow.com/questions/11160643/how-to-import-a-module-as-main#comment86906440_31395912) 和[如何将模块导入为 __main__？](https://stackoverflow.com/questions/11160643/how-to-import-a-module-as-main#comment103989404_31395912)）。

与正确的格式相同：

```
import runpy
runpy.run_module("your.module.name", {}, "__main__") 
```

或者

```
import runpy
runpy.run_path("path/to/my/file.py", {}, "__main__") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-22T16:51:44.530

主节中的代码直接运行通常*毫无*意义。如果要运行它，请使用`subprocess`在另一个 Python 解释器中运行它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T23:28:29.670

以下是 Python 中主模块的示例：

```
#! /usr/bin/env python
import sys
import os

def main(arg1, arg2, arg3):
    print(arg1, arg2, arg3)

if __name__ == "__main__":
    main(*sys.argv) 
```

但你也可以包括

```
def main():
   #The module contains Python code specific to the library module, 
   #like tests, and follow the module with this:

if __name__ == "__main__":
    main(*sys.argv) 
```

在您想作为主要运行的任何模块中。

例如，如果你有一个库模块，你总是可以使用这个结构来执行特定的东西，比如测试。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-06-22T16:51:03.080

把它放在一个函数中：

```
def _main():
   do stuff

if __name__ == '__main__':
    main() 
```

# spring - Spring MVC：如何从提交到视图的模型中检索数据

> ID：11160644
> 
> 赞同：2
> 
> 时间：2012-06-22T16:47:59.243
> 
> 标签：spring, model-view-controller, spring-mvc

我有以下要求。我将模型对象提交给视图，如下所示...

```
@RequestMapping(value ="/addItem", method = RequestMethod.GET)
     public ModelAndView showContacts() {           
         ModelAndView modelAndView = new ModelAndView("addItem", "command", new Item());
         return modelAndView;
     } 
```

但是在发布后，我需要检索返回给我的“项目”对象（模型）之外的值。我不能让这个变量成为 Item 模型对象的一部分，因为它不属于那里。但我需要它返回以便对该值采取行动。我该怎么做呢？

即在我的 JSP 文件中，我有以下字段...

```
<form:input type="text" path="val1"/>
<form:input type="text" path="val2"/>
<form:input type="text" path="val3"/> 
```

在上述之外，只有字段 val1 和 val2 具有到 Item 对象的映射，而 val3 没有。尽管如此，我还需要将 val3 的值传递回我的控制器。我现在处理 POST 的代码如下，但我不知道如何获取 val3 的值。该代码现在无法编译，因为它说在 val3 的 Item 类中没有字段或适当的 getter 方法。

```
@RequestMapping(value = "/postItem", method = RequestMethod.POST)
    public String postItem(@ModelAttribute("item") Item item , BindingResult result) {
        logger.info("Post Item:");
        return "home";
    } 
```

如何修改上述代码以满足我的要求？

对此问题的一些指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:19:26.877

您可以将地图作为模型传递，并在其中包含各种不同的东西。您不仅限于单个域对象，构造函数只是为了方便，它不是唯一的方法。构造函数有[一个变体](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/web/portlet/ModelAndView.html#ModelAndView%28java.lang.Object,%20java.util.Map%29)：

```
public ModelAndView(Object view,
                    Map model)

    Create a new ModelAndView given a View object and a model.

    Parameters:
        view - View object to render (usually a Servlet MVC View object)
        model - Map of model names (Strings) to model objects (Objects). 
        Model entries may not be null, but the model Map may be null if 
        there is no model data. 
```

# ruby-on-rails-3 - 在 Rails 中计算经过的时间

> ID：11160646
> 
> 赞同：1
> 
> 时间：2012-06-22T16:48:01.083
> 
> 标签：ruby-on-rails-3, datetime, model

我正在编写一个应用程序，我需要比较两个 :datetime 字段并将差异显示为从记录开始的“经过”时间。我认为我的代码是正确的，但我不断收到以下错误。有人可以告诉我我做错了什么吗？

```
Error on view:
undefined method `-' for nil:NilClass line 26:
26:     <td><%= link_to call.elapsed_time, call %></td>

Call.rb (abbreviated)
before_create :set_dispatched_time

def set_dispatched_time
  self.dispatched_time = Time.now
end

def elapsed_time
  self.dispatched_time - Time.now
end 
```

我在 PG 中的字段设置为 :datetime 以便我可以计算时间（我确实将它们作为字符串.. ooops）但由于某种原因它没有计算。我是否需要先调用 Time.parse 或类似的方法？我不确定该往哪个方向走。我只想从 Time.now 中减去 dispatched_time 字段

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T16:55:56.703

根据错误消息，您的`self.dispatched_time`不存在，它为零。这可能是因为`before_create`第一次将对象持久化到数据库中时调用，并且此特定实例尚未保存。

首先尝试确保这个变量有一个值，或者如果它没有被分配，则分配一个默认值。例如：

```
def elapsed_time
  Time.now - (self.dispatched_time || Time.now)
end 
```

# ssh - 尝试从其他计算机访问 ec2 时 ssh 权限被拒绝（公钥）

> ID：11160652
> 
> 赞同：0
> 
> 时间：2012-06-22T16:48:08.710
> 
> 标签：ssh, amazon-ec2, public-key

我正在尝试使用不同的（mac）计算机访问 ec2 实例。为此，我创建了一个新的密钥对，使用 chmod 600 设置权限，然后使用 ssh-add。当我尝试 ssh 进入我的 ec2 实例时，我得到“权限被拒绝（公钥）”。我确定我的错误是愚蠢而简单的，但我似乎找不到它，任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:56:12.707

您需要确保将`~/.ssh/id_rsa.pub`Mac 中的（如果它是 RSA 密钥）附加到`~/.ssh/authorized_keys`目标计算机上的文件中。通常，如果这是默认的 Amazon API，则用户是“ec2-user”——`~ec2-user/.ssh/authorized_keys`

**记住要追加**而不是删除该文件中的其他条目——否则，您可能会将自己锁定在该机器之外...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:52:01.253

你的私钥在新电脑上吗？

您需要将其放在您使用 ssh 的计算机上。我通常把我的放在闪存驱动器上……我没有运行 linux atm，所以我忘记了它检查的默认目录。也许这会唤起你的记忆。我认为目录会像 ~/.id_rsa/ 什么的？

# objective-c - 为什么clang允许没有@implementation的@interface？它有什么作用？

> ID：11160655
> 
> 赞同：0
> 
> 时间：2012-06-22T16:48:22.130
> 
> 标签：objective-c, clang, objective-c-category

我有以下类/协议：

```
@interface Super
@end
@implementation Super
@end
@interface Sub1
@end
@implementation Sub1
@end
@interface Sub2
@end
@implementation Sub2
@end

@protocol FooProtocol
- (void) foo;
@end
@interface Sub1 (FooCategory) <FooProtocol>
@end
@implementation Sub1 (FooCategory)
- (void) foo {}
@end
@interface Sub2 (FooCategory) <FooProtocol>
@end
@implementation Sub2 (FooCategory)
- (void) foo {}
@end
@interface Super (FooCategory) <FooProtocol>
@end
// Notice that there is no @implementation Super (FooCategory) 
```

这允许我编写一个类似的函数：

```
void callFoo(NSArray *supers) {
  for (Super *theSuper in supers) {
    [theSuper foo];
  }
} 
```

`Sub1`和`Sub2`是`Super`仅有的两个子类。我本质上想要类别方法中的多态性。如果我指定`@interface`for `Super`，但提供 no `@implementation`，clang 不会给我任何警告/错误。

这是一个非常糟糕的黑客行为吗？

潜在的不利因素是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-02T18:24:47.213

*（最初来自对 zneak 答案的评论。）*

正如[The Objective-C Programming Language](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocCategories.html#//apple_ref/doc/uid/TP30001163-CH20-SW1)中所解释的，一个类别中的方法在运行时真正成为目标类的一部分——这就是为什么破坏现有方法可能很危险，以及为什么实现相同方法的多个类别的行为是不明确的。一旦安装了该方法，它实际上与最初存在的东西没有什么不同：

> 类别方法可以做任何在类中定义的方法可以做的事情。在运行时，没有区别。类别添加到类的方法被该类的所有子类继承，就像其他方法一样。

可以在其子类上设置一个类别，`Super`并在其子类上设置一个类别来实现相同的方法，并且如果它们是类本身的一部分，它的工作方式将完全一样。（虽然我确实建议遵循 zneak 的建议，即实现一个存根方法`Super`以帮助调试，如果它被意外调用。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:52:28.153

Objective-C 没有“抽象方法”的概念。当您需要一个时，您几乎必须选择使用一些技巧。

尽管我建议您将方法放入`Super`并在调用时抛出异常。

# django - 如何将 UserProfile 绑定到 User 和另一个模型？

> ID：11160659
> 
> 赞同：1
> 
> 时间：2012-06-22T16:48:46.450
> 
> 标签：django

我创建了一个公司模型和一个配置文件模型。

**每个用户属于一个公司，一个公司可以属于多个用户。**

两者中哪一个是正确的建模方式？

```
class Company(models.Model):
    company_name = models.CharField(max_length=50)
    company_code = models.CharField(max_length=40)
    company_email = models.EmailField()

    def save(self, *args, **kwargs):

        if not self.company_code:
            self.company_code = uuid.uuid1()

        super(Company, self).save(*args, **kwargs) 
```

现在 UserProfile 定义如下：

```
class UserProfile(models.Model):
    # This field is required.
    user = models.OneToOneField(User)
    # Other fields here
    company = models.ManyToManyField(Company)

    #  !!!! OR  !!!!

    company = models.ForeignKey(Company) 
```

**更新：**

```
class UserProfile(models.Model):
    user = models.OneToOneField(User)
    company = models.ForeignKey(Company)

    def create_user_profile(self, instance, created, **kwargs):
        if created:
            UserProfile.objects.create(user=instance)

    post_save.connect(create_user_profile, sender=User) 
```

我现在已将此位添加到 UserProfile 类中，也添加`AUTH_PROFILE_MODULE = 'MyApp.UserProfile'`到设置中。

当我执行 syncdb 时，我收到一条错误消息：

```
>> company = models.ForeignKey(Company)
NameError: name 'Company' is not defined 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:56:08.697

A`ManyToManyField`将允许 a`User`属于多个`Company`s。根据您的规格，a`ForeignKey`将是合适的。

# c# - 允许子程序在父应用程序中的表单上调用 Close

> ID：11160661
> 
> 赞同：1
> 
> 时间：2012-06-22T16:48:48.670
> 
> 标签：c#, .net, winforms, process, ipc

我有一个小型启动程序，它在自己的线程上加载启动画面并显示它。如果满足一组条件，则需要启动另一个应用程序并保持启动屏幕可见，直到另一个应用程序说可以关闭启动屏幕。

![在此处输入图像描述](../Images/1243fb221109d6b19af7e6a06c88810f.png)

Launcher 的生命周期总是在 Child App 之前开始，在 Child App 关闭之后结束。

这是一些相关代码的片段

常用DLL：

```
namespace Example.Common
{
    public partial class SplashScreen : Form
    {
        public SplashScreen()
        {
            InitializeComponent();
        }

        static SplashScreen splashScreen = null;
        static Thread thread = null;

        static public void ShowSplashScreen()
        {
            // Make sure it is only launched once.
            if (splashScreen != null)
                return;

            thread = new Thread(new ThreadStart(SplashScreen.ShowForm));
            thread.IsBackground = true;
            thread.SetApartmentState(ApartmentState.STA);
            thread.Start();
        }

        // A static entry point to launch SplashScreen.
        static private void ShowForm()
        {
            splashScreen = new SplashScreen();
            Application.Run(splashScreen);
        }

        // A static method to close the SplashScreen
        static public void CloseForm()
        {
            splashScreen.Close();
        }
    }
} 
```

初始启动器：

```
/// <summary>
/// This application is a small launcher to launch the real graphical launcher. It is small and lightweight and should be rarely be updated.
/// It will call the ProgramLauncher, the program launcher will return in it's status code the PID of the instance it launched or -1
/// if no subsequent program was started.
/// </summary>
[STAThread]
static void Main()
{
    //Show the Splash screen;
    Example.Common.SplashScreen.ShowSplashScreen();

    //(Snip)

    if (rights == UserRights.None)
    {
        SplashScreen.CloseForm();
        MessageBox.Show("Your user does not have permission to connect to the server.", "Unable to logon", MessageBoxButtons.OK, MessageBoxIcon.Error);
        return;
    }
    //If the user has full desktop access, give it to them and launch a new instance of the launcher.
    else if (rights.HasFlag(UserRights.FullDesktopAccess))
    {
        Process explorer = new Process();
        explorer.StartInfo.FileName = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.Windows), "explorer.exe");
        if (explorer.Start() == false)
        {
            MessageBox.Show("Explorer failed to start.");
        }
        else
        {
            //Close the splash screen.
            SplashScreen.CloseForm();

            //If the user can shadow start a new instance of the launcher inside explorer.
            if (rights.HasFlag(UserRights.ShadowNormalUser) || rights.HasFlag(UserRights.ShadowDemoUser))
            {
                //Start a new copy of the program so people can use it to shadow easily.
                var shadowProc = new Process();
                shadowProc.StartInfo.FileName = "ProgramLauncher.exe";
                shadowProc.StartInfo.UseShellExecute = false;
                shadowProc.Start();
            }
            explorer.WaitForExit();
        }
    }
    else
    {
        Process programLauncher = new Process();
        programLauncher.StartInfo.FileName = "ProgramLauncher.exe";
        programLauncher.StartInfo.UseShellExecute = false;

        //Launch the graphical launcher.
        programLauncher.Start();
        programLauncher.WaitForExit();

        //Check to see if the graphical launcher launched some other process.
        if (programLauncher.ExitCode >= 0)
        {
            //If there was a pid, don't close the micro launcher till after it closes.
            Process runningProcess = Process.GetProcessById(programLauncher.ExitCode);
            runningProcess.WaitForExit();
        }

    }
} 
```

让 ProgramLauncher 关闭 MicroLauncher 创建的 SplashScreen 实例的最简单方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:00:32.107

有很多方法可以做到这一点，各有利弊。可能*最简单*的方法是从您的 ProgramLauncher 进程重定向标准输出并将其连接到 MicroLauncher 应用程序中的事件（请参见[此处](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.beginoutputreadline.aspx)的示例）。从您的 ProgramLauncher 程序中，您将某个消息写入标准输出。当 MicroLauncher 收到该消息时，您关闭窗口。

另一种选择是将初始屏幕的 HWND 作为命令行参数传递给 ProgramLauncher，然后 ProgramLauncher 可以使用 SendMessage(WM_SYSCOMMAND, SC_CLOSE) 关闭窗口（参见[此处](http://www.codeproject.com/Articles/22257/Find-and-Close-the-Window-using-Win-API)的示例）。

您还可以研究 IPC 方法、发送自定义 Windows 消息或可能有上千种其他可能性，但这两个想法可能会让您入门。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:55:17.007

您需要`SplashScreen`将其窗口句柄 (HWND) 传递给`ProgramLauncher`. 然后，`ProgramLauncher`可以使用winapi函数向目标窗口[`SendMessage`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644950%28v=vs.85%29.aspx)发送消息：`WM_SYSCOMMAND`

```
public const int WM_SYSCOMMAND = 0x0112;
public const int SC_CLOSE = 0xF060;
SendMessage(hwnd, WM_SYSCOMMAND, SC_CLOSE, 0); 
```

在 WinForms 中，您可以使用[`Handle`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.handle.aspx). 平台调用代码[`SendMessage`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644950%28v=vs.85%29.aspx)在[这里](http://www.pinvoke.net/default.aspx/user32.sendmessage)。

至少我现在没有看到更简单的方法，但我认为它比任何 IPC 机制都更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:57:12.283

我能想到的最简单的方法：让子应用程序创建一个命名互斥体，让父应用程序等到有人创建它，不时检查。

不是很优雅并且容易被滥用（另一个应用程序故意创建一个同名的互斥锁），但在实践中，我怀疑这会是一个问题。

# c# - 如何在新线程中启动包含计时器的对象？

> ID：11160663
> 
> 赞同：-1
> 
> 时间：2012-06-22T16:49:22.100
> 
> 标签：c#, multithreading, timer, garbage-collection

如何开始在新线程中运行包含计时器的对象？

我有以下代码，我可能应该更改它：

```
 class MemoryCleaner : IDisposable
    {
        private readonly static MemoryCleaner Instance = new MemoryCleaner();

        private readonly Timer _memoryWatcher = new Timer(15 * 1000);

        public Timer MemoryWatcher
        {
            get
            {
                return this._memoryWatcher;
            }
        }

        public void Dispose()
        {
            _memoryWatcher.Elapsed -= memoryWatcher_Elapsed;
            this._memoryWatcher.Stop();
        }

        private void memoryWatcher_Elapsed(object sender, ElapsedEventArgs e)
        {
            var currentProcess = Process.GetCurrentProcess();
            var megaBytes = currentProcess.PrivateMemorySize64 / (1024 * 1024);
            if (megaBytes > 100)
            {
                // force an immediate garbage collection to free some unused memory quickly; this is an expensive process!
                GC.Collect();
            }
        }

        internal static void Start()
        {
            // this should be created in a new thread
            Instance.MemoryWatcher.Elapsed += Instance.memoryWatcher_Elapsed;
            Instance.MemoryWatcher.Start();
            GC.KeepAlive(Instance);
        }

        internal static void Stop()
        {
Instance.Dispose();
        }
    } 
```

我想像这样使用它：

```
MemoryCleaner.Start();
// my memory thirsty code which generates so much garbage, e.g. downloads a document then disposes it.
MemoryCleaner.Stop(); 
```

它应该做的是我应该创建一个新线程，然后在该线程上它应该创建 MemoryCleaner 对象的新实例并启动该对象。

那怎么可能呢？

一些背景信息：基本上，代码应该做的是它应该每 15 秒检查一次主进程使用的内存，如果内存使用量超过 100MB，则强制进行垃圾收集，因为会创建这么多垃圾。

希望问题很清楚。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T16:56:09.553

如果您正在创建一个`System.Threading.Timer`，或者`System.Timers.Timer`在哪个线程上创建它并不重要 - 除非您指定一个同步对象，否则计时器无论如何都会在线程池线程上触发。为什么要为创建部分创建一个线程？

（无论如何我都不确定所有这些都是一个好主意，但这是另一回事......您还应该考虑制作单例实现`IDisposable`是否真的很明智。）

# php - 使用 simplexml_load_string、循环和变量从哈希数组创建重复节点

> ID：11160665
> 
> 赞同：0
> 
> 时间：2012-06-22T16:49:24.420
> 
> 标签：php, xml, hash, multidimensional-array, simplexml

我一直在研究这个问题，但我找不到我需要的东西。应该不难，可能是语法问题=)

我在函数内部创建了一个表示 XML 的字符串，如下所示：

```
$sxe = simplexml_load_string('
<xmlFile>
 <item param="'.$variable.'">
  <subitem>'.$var2s.'</subitem>
 </item>
</xmlFile>
'); 
```

变量的内容在两个变量中都是这样的纯字符串`abc,def,ghi`，我通过这种方式从哈希中获得：

```
isset($variable);
$variable="";
isset($vars2);
$vars2="";

foreach ($hashArray as $stringKey => $stringValue) {
 // I separate each result with a comma
 $variable .= $stringKey.",";
 $vars2 .= $stringValue.",";
}
// Then remove the last comma
$variable = substr($variable, 0, -1);
$vars2 = substr($vars2, 0, -1); 
```

当我保存我的 XML 时，`$sxe->asXml('xml/myGreatFile.xml');`我得到了类似于：

```
<xmlFile>
 <item param="abc,def,ghi">
  <subitem>JKL,MNO,PQR</subitem>
 </item>
</xmlFile> 
```

这很好，但现在对于我的新要求，我需要一个类似于这样的结果：

```
<xmlFile>
 <item param="abc">
  <subitem>JKL</subitem>
 </item>
 <item param="def">
  <subitem>MNO</subitem>
 </item>
 <item param="ghi">
  <subitem>PQR</subitem>
 </item>
</xmlFile> 
```

如何创建这个重复节点？我尝试`simplexml_load_string`像处理变量一样在字符串中连接 PHP 函数，但似乎不可能：

```
$sxe = simplexml_load_string('
<xmlFile>'.
 // Syntax Error u_u
 foreach ($hashArray as $stringKey => $stringValue) {
  $variable .= $stringKey.",";
  $vars2 .= $stringValue.",";.

 '<item param="'.$variable.'">
  <subitem>'.$var2s.'</subitem>
 </item>'.
 }
.'</xmlFile>
'); 
```

当然我的语法是错误的，但我想以某种方式创建这个重复节点，可能有一个循环，也可能直接使用我的哈希数组而不是将其传递给字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:10:53.420

答案很简单：在 simplexml 函数之外构建字符串变量，然后在函数中使用它。

```
 $mystring = "<xmlFile>";
  foreach($array as $key => $value)
  {
      $mystring .= "<item param='$key'><subitem>$value</subitem></item>";
  }
  $mystring .= "</xmlFile>";

  $sxe = simplexml_load_string($mystring); 
```

如果您使用的是多维数组？只需嵌套您的`foreach`字符串构建语句。

# ios - UISlider 值更改更新结果

> ID：11160673
> 
> 赞同：0
> 
> 时间：2012-06-22T16:50:06.170
> 
> 标签：ios, objective-c, uislider

我有三个标签接收来自三个的输出`UISliders`。当触摸分段控件时，计算结果并将其放置在第四个标签中。

如果更改滑块值之一而不再次触摸分段控件，如何更新结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:51:29.307

首先，为您的滑块更改值添加一个事件：

```
[mySlider addTarget:self 
             action:@selector(sliderValueChanged:) 
   forControlEvents:UIControlEventValueChanged]; 
```

您需要为每个滑块执行此操作。

在您的`sliderValueChanged:`功能中：

```
- (void)sliderValueChanged:(id)sender {
    [self calculateResult];
} 
```

`calculateResult`您可以在其中进行计算并设置结果框。

如果您需要确保您的分段控件首先处于某种状态，只需添加一个`if`子句`sliderValueChanged:`

```
- (void)sliderValueChanged:(id)sender {
    if ([mySegmentedControl selectedSegmentIndex] == 1) {
        [self calculateResult];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-14T22:31:12.257

我想出了一些使用[mopsled 的答案的](https://stackoverflow.com/a/11161561/814730)东西：

```
if (UIControlEventValueChanged && mySeg.selectedSegmentIndex == 0) {
    float floatResult = [f3.text floatValue]-[f2.text floatValue];
    float coldFactor = [fcold.text floatValue]*floatResult;
    float result = [f1.text floatValue]+coldFactor;

    NSString *tpResult = [[NSString alloc] initWithFormat:@"%.0f",result];
    f4Result.text = tpResult;             
} 
```

# playframework-2.0 - 如何激活javascript缩小？

> ID：11160674
> 
> 赞同：6
> 
> 时间：2012-06-22T16:50:08.120
> 
> 标签：playframework-2.0

播放文档说 « 默认情况下，[资产] 控制器提供缓存、ETag、gzip 压缩和 JavaScript 缩小支持。»

如何设置播放以缩小 javascripts 文件？在 dev 或 prod mod 中的默认设置中都没有完成，并且文档没有解释它。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T20:21:39.233

确保您的 javascript 资源位于您的`/app/assets/javascript`文件夹中（因此您将从[Google Closure Compiler](https://www.playframework.com/documentation/2.0/AssetsGoogleClosureCompiler)中受益），然后，您只需使用 anyname**.min**.js 命名您的 js 文件

视图中的示例：

```
<script src="@controllers.Assets.at("public", "javascripts/whatevername.min.js")" type="text/javascript"></script> 
```

# javascript - 切换其他表格行的可见性

> ID：11160675
> 
> 赞同：6
> 
> 时间：2012-06-22T16:50:08.227
> 
> 标签：javascript, jquery, html, css

我有一个表，默认情况下我只想显示第一行，但如果用户单击“显示更多”链接，则显示额外的 X 行（如果用户然后单击“显示更少”，则相反隐藏 X 行）。

例如，我希望页面加载时的默认视图如下所示：

```
 Top Scores
====================================
|   1 | show this row always!      |
====================================
 -show more- 
```

然后，如果用户点击“显示更多”，表格应该会展开额外的行，如下所示：

```
 Top Scores
====================================
|   1 | show this row always!      |
|   2 | newly displayed row        |
|   3 | newly displayed row        |
|   4 | newly displayed row        |
|   5 | newly displayed row        |
====================================
 -show less- 
```

然后很明显，如果用户单击“显示更少”，表格将恢复为默认值（再次仅显示第一行）。

我对`.toggle()`jQuery 中的函数很熟悉，但不确定它是否可以在这里应用，或者我是否需要做更多的手动工作。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T16:56:46.357

不需要额外的类，不需要标题 - [http://jsfiddle.net/wgSZs/](http://jsfiddle.net/wgSZs/)

```
$('table').find('tr:gt(0)').hide();

$("button").on("click", function() {
    $('table').find('tr:gt(0)').toggle();
}); 
```

**更新**

通过 CSS 而不是 jQuery 隐藏额外的行可能会更好，以避免在下载和应用 JS 时元素移动。但是仍然不需要添加类 - 保持标记尽可能干净是个好主意。你可以这样做：

```
table tr { display: none }
table tr:first-child { display: block } 
```

这是工作示例 - [http://jsfiddle.net/wgSZs/1/](http://jsfiddle.net/wgSZs/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T16:52:19.703

如果您使用类似的类标记添加的行`.collapsible`，那么您可以轻松地在 javascript 中切换它们的可见性。

`$('.collapsible').show()`或`$('.collapsible').hide()`或`$('.collapsible').toggle()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T16:54:53.653

[http://jsfiddle.net/iambriansreed/uwfk8/](http://jsfiddle.net/iambriansreed/uwfk8/)

```
var initial_rows_to_show = 2;

(function(_rows){    
    _rows.hide();
    $('a.more').toggle(function(){
        _rows.show(); $(this).text('less');
    },function(){    
        _rows.hide(); $(this).text('more');
    });
})($('tr:gt(' + (initial_rows_to_show - 1) + ')')); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T16:53:19.943

您可以通过隐藏表格并仅显示来做到这一点

```
$('thead').click(function(){

  $('tbody').show();
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-22T16:53:49.740

好的，所以在输入整个问题后，StackOverflow 决定向我展示一个[相关的相关问题](https://stackoverflow.com/questions/1296729/dynamically-hiding-table-rows-with-jquery?rq=1)。:)

看起来我可以`gt`通过 jQuery 使用选择器来仅切换大于指定行号的行，这对于我想要实现的目标来说应该是完美的。

对不起，多余的问题（假设这对我有用，还没有尝试过）！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T16:54:25.487

切换将完美地工作：

$('#show-link').toggle(function(){

} ， 功能（）{

});

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-22T17:21:54.100

在这里你去......在jsFiddle的工作示例：

[http://jsfiddle.net/ndFgF/8/](http://jsfiddle.net/ndFgF/8/)

```
<table width="500" border="1" cellspacing="0" cellpadding="0">
  <tr>
    <th width="25%" id="expand" scope="col">Show More</th>
    <th width="25%" scope="col">&nbsp;</th>
    <th width="25%" scope="col">&nbsp;</th>
    <th width="25%" id="collapse" scope="col">Show Less</th>
  </tr>
  <tr data-rows="togglerow" style="display:none">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-rows="togglerow" style="display:none">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-rows="togglerow" style="display:none">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr data-rows="togglerow" style="display:none">
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table> 
```

请注意，表格行中的 data 属性在下面的 jQuery 中被引用：

```
<script>
$("#collapse").click(function() {
      $("[data-rows='togglerow']").hide(400);
    })
$("#expand").click(function() {
      $("[data-rows='togglerow']").show(400);
    })
</script> 
```

我使用 'data' 属性而不是类名，因为我喜欢将它们分开......如果你愿意，你可以使用类名，但不要使用 ID，因为它不是正确的方法（ID应该是唯一的，而不是重复的）。

# c# - 通过 GetSchema() 方法获取表的列

> ID：11160685
> 
> 赞同：19
> 
> 时间：2012-06-22T16:50:41.430
> 
> 标签：c#, ado.net, schema

`GetSchema`我想使用in 方法获取表的列列表`ADO.Net`，我的代码是：

```
var dtCols = con.GetSchema("Columns", new[] { "DBName", "TableName" }); 
```

我得到一个空的`DataTable`，有什么问题？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-22T17:06:19.567

您必须为“所有者”限制指定一个参数。

```
var dtCols = con.GetSchema("Columns", new[] { "DBName", null, "TableName" }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-16T18:53:38.453

这两个答案都可以概括为：

`dtCols = con.GetSchema("Columns", new[] {con.DataSource, null, "TableName"});`

这是假设“TableName”是您想要架构的表的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-25T09:12:29.327

我有一个类似的问题，以下工作..

```
using(SqlCommand command = new SqlCommand(sqlText, con)) {
    var sqlReader = command.ExecuteReader();
    var a = sqlReader.GetColumnSchema();                        
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-03-03T15:12:13.703

这是我的完整解决方案。

你只需要提供`tableName`和`connectionString`这个方法：

```
// I took HUGE help from this Microsoft website: - AshishK
// https://docs.microsoft.com/en-us/dotnet/api/system.data.sqlclient.sqlconnection.getschema?view=netframework-4.7.2#System_Data_SqlClient_SqlConnection_GetSchema_System_String_System_String___
public static List<string> GetAllColumnNamesOfATable(string tableName, string connectionString)
{
    var allColumnNames = new List<string>();

    using (var connection = new SqlConnection(connectionString))
    {
        // Connect to the database then retrieve the schema information.  
        connection.Open();

        // You can specify the Catalog, Schema, Table Name, Column Name to get the specified column(s).
        // You can use four restrictions for Column, so you should create a 4 members array.
        String[] columnRestrictions = new String[4];

        // For the array, 0-member represents Catalog; 1-member represents Schema;
        // 2-member represents Table Name; 3-member represents Column Name.
        // Now we specify the Table_Name and Column_Name of the columns what we want to get schema information.
        columnRestrictions[2] = tableName;

        DataTable allColumnsSchemaTable = connection.GetSchema("Columns", columnRestrictions);

        foreach (DataRow row in allColumnsSchemaTable.Rows)
        {
            var columnName = row.Field<string>("COLUMN_NAME");

            //You can capture other fields as well, like so:
            var dataType = row.Field<string>("DATA_TYPE");
            var characterMaxLength = row.Field<int?>("CHARACTER_MAXIMUM_LENGTH");

            allColumnNames.Add(columnName);
        }

        connection.Close();
    }

    return allColumnNames;
} 
```

# python - 图片托管网站：Django vs Pyramid

> ID：11160688
> 
> 赞同：5
> 
> 时间：2012-06-22T16:50:50.730
> 
> 标签：python, django, pylons, pyramid

我是图像托管网站的所有者。过去一个月我一直在学习 python，因为我计划将我的网站从 PHP 重建为 Python，因为它正在增长，我发现 Python 将非常有效地满足我的需求。

我一直在研究 Python 的两个最流行的 Web 框架，Django 和 Pyramid。从我通过阅读各种来源收集到的信息来看，Pyramid 似乎是一个较低级别的框架，赋予它更快的速度和更大的灵活性。而另一方面，Django 适用于不需要投入大量工作的高级网站，而且设置起来更快。

我倾向于 Pyramid，因为我的网站可能会及时扩大规模，并且需要尽可能高效。如果我能获得更多关于这两个框架之间差异的事实以及哪个更适合我对大型图像托管公司的需求，那就太棒了。

谢谢 ：）

# android - 调用onActivityResult android

> ID：11160694
> 
> 赞同：0
> 
> 时间：2012-06-22T16:51:03.750
> 
> 标签：android, bluetooth

我有下一个代码：

```
class Printer{
Activity activity;
public Printer (Activity activity) {
    this.activity = activity;
    initializeBluetooth();
}

public boolean initializeBluetooth() {
    BluetoothAdapter mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
    if (mBluetoothAdapter == null) {
        Context context = activity.getApplicationContext();
        Toast toast = Toast.makeText(context, activity.getString(R.string.notSupportedBluetooth), 3000);
        toast.show();
        return false;
    } else {
        if (!mBluetoothAdapter.isEnabled()) {
            Intent enableBtIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
            activity.startActivityForResult(enableBtIntent, 0);
            return false;
        }
    }
    return true;
}

protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
    System.out.println(resultCode);
    if (resultCode == 0) {
        System.out.println("one");
    } else {
        System.out.println("two");
    }
}} 
```

问题是onActivityResult，我知道它不能被调用，因为该类不是一个活动，所以我如何检查用户是否点击了蓝牙请求而不将我的类变成活动？`activity.startActivityForResult(enableBtIntent, 0);` 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:58:07.560

你为什么做这个？只需在类中包含所有蓝牙功能`Activity`......无需为此创建单独的类。

`onActivityResult`无论如何，只需将您的代码复制并粘贴到您的`Activity`文件中：

```
protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
    System.out.println(resultCode);
    if (resultCode == 0) {
        System.out.println("one");
    } else {
        System.out.println("two");
    }
} 
```

`onActivityResult`包含在您的`Printer`课程中是没有意义的，因为 call`onActivityResult`将被*调用`Activity`*。

# iphone - 为什么我的 XCode 单元测试根本不起作用？

> ID：11160697
> 
> 赞同：1
> 
> 时间：2012-06-22T16:51:12.547
> 
> 标签：iphone, ios, xcode, ipad

我创建了一个启用单元测试的空测试项目（静态库类型）。

但是之后单元测试的产品是红色的，如下图所示。

我也找不到测试的模式，我什至无法运行测试。

任何人都可以帮助我吗？

![xcode 单元测试](../Images/c919ed9c538bbfb500360a41220968c7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:57:37.293

按住运行按钮并选择测试。或者从工具栏中转到产品>测试。然后它将构建您想要测试的目标并在其上运行测试。

# authorize.net - Authorize.net "x_description"

> ID：11160703
> 
> 赞同：0
> 
> 时间：2012-06-22T16:51:45.457
> 
> 标签：authorize.net

我需要能够将识别信息传递到 Authorize.net 的服务器，以便在确认返回时可以使用此信息进行日志记录。我们有我们在网站上销售的商品的 ID 等信息，我希望 Authorize.net 的响应中包含这些信息，以便与 Authorize.net 的 API 本身提供的其他交易数据一起插入我们的数据库。有点像 Google Checkout 购物车中的“商家私人数据”。

我在 Authorize.net 的 API 中看到的唯一不包含其他特定信息的字段是 x_description。我的问题是 x_description 中的数据是否会随时显示给客户？我想包含的信息是敏感的，而不是客户的眼睛。我已经阅读了 Authorize.net 提供的 API 文档，但我不清楚这个字段是做什么的。

如果此字段不是私有的，是否有更好的解决方案来解决我没有看到的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:01:48.923

挖掘[他们的 API 字段列表，](http://developer.authorize.net/guides/AIM/Appendix_B/Appendix_B_Alphabetized_List_of_API_Fields.htm)看看你可以使用什么。例如，如果您要构建订单项列表，请查看它们的`x_line_item`字段。如果您使用的是 AIM/CIM SDK 并且没有告诉 Authorize.net 通过电子邮件发送收据，那么除了信用卡上的费用外，我看不到客户会如何看到您提交给 Authorize.net 的*任何内容。*但是，如果您的客户*确实*直接从 Authorize.net 收到电子邮件，他们很可能会看到您提交的所有内容。但是请仔细检查我链接的文档以确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-08T20:02:46.293

您有 x_description，还有 x_invoice_num 和 x_po_num。这些字段供商家内部使用。字段 x_description 和 x_invoice_num 可以在虚拟终端中设置，如果您使用它来提交交易，也可以通过 API。Authorize.net 将在响应中返回它们。如果您在自动定期计费订阅中设置这两个字段中的任何一个，它将在每个单独的付款响应中返回。它们也可能包含在电子邮件收据中 - 我从未使用 authorize.net 电子邮件收据给买家。您可以禁用此电子邮件收据并发送您自己的电子邮件收据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-09T01:52:00.000

我知道`x_description`会以纯文本形式发送到商家的电子邮件中，所以我不会将它用于任何***过于***敏感的事情。但是，描述并没有出现在我的信用卡对帐单上（作为客户）。

您可以使用另一个字段，`refId`. 它没有很好的记录，但是您传入的`refId`内容将在响应对象中返回为`refId`.

就个人而言，我建议创建一个数据库表来存储您的数据，然后使用它`refId`来跟踪插入 ID。

# android - 经纬度 NullPointerException

> ID：11160705
> 
> 赞同：0
> 
> 时间：2012-06-22T16:51:56.597
> 
> 标签：android, nullpointerexception, locationmanager

我正在制作这个类来获取用户的当前位置并将其与数据库中的经度和纬度进行比较，它给了我空指针异常，有人可以帮我吗？我只想与纬度进行比较，我想获得 50 范围内的所有对象。

```
public class locationFinder extends ListActivity implements LocationListener {

    EgyptDataSource datasource;
    Location locObject;
    String loc;
    double lat;
    double longi;
    List<Integer> indexes;
    List<Hotel> newHotels = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        LocationManager locManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, this);

        Intent i = getIntent();
        String category = i.getStringExtra("category");

        if(category.equals("hotels"))
        {
            List<Hotel> Latvalues = datasource.getAllHotelsLat();

            float[] distance = new float[Latvalues.size()];
            for (int j = 0; j < Latvalues.size(); j++) {
            Location.distanceBetween(lat, longi, Latvalues.get(j).toDoubleLat(), 0.0, distance);
            if(distance[0] <50)
            {
                indexes.add(j);
            }
        }
        List<Hotel> allHotels = datasource.getAllHotels();
        for (int q = 0; q < allHotels.size(); q++) {
            for (int w = 0; w < indexes.size(); w++) {
                if(q == indexes.get(w))
                {
                    newHotels.add(allHotels.get(q));
                }
            }
        }

        if (newHotels.isEmpty())
        {
            Toast.makeText(this, "No results found!", Toast.LENGTH_LONG).show();
            Intent i1 = new Intent(locationFinder.this, hotelSearch.class);
            startActivity(i1);
        }

        ArrayAdapter<Hotel> adapter = new ArrayAdapter<Hotel>(this, android.R.layout.simple_list_item_1, newHotels);
        setListAdapter(adapter);

        }
    }

    public void onLocationChanged(Location location) {
        lat = location.getLatitude();
        longi = location.getLongitude();        
    }

    public void onProviderDisabled(String provider) {       
}

public void onProviderEnabled(String provider) {        
}

public void onStatusChanged(String provider, int status, Bundle extras) {       
}

} 
```

这是 LogCat

```
06-22 18:29:04.261: E/AndroidRuntime(30183): FATAL EXCEPTION: main
06-22 18:29:04.261: E/AndroidRuntime(30183): java.lang.RuntimeException: Unable to start activity ComponentInfo{egypt.interfaceAct/egypt.interfaceAct.locationFinder}: java.lang.NullPointerException
06-22 18:29:04.261: E/AndroidRuntime(30183):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2781)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2797)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at android.app.ActivityThread.access$2300(ActivityThread.java:135)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2132)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at android.os.Handler.dispatchMessage(Handler.java:99)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at android.os.Looper.loop(Looper.java:143)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at android.app.ActivityThread.main(ActivityThread.java:4914)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at java.lang.reflect.Method.invokeNative(Native Method)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at java.lang.reflect.Method.invoke(Method.java:521)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:858)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at dalvik.system.NativeStart.main(Native Method)
06-22 18:29:04.261: E/AndroidRuntime(30183): Caused by: java.lang.NullPointerException
06-22 18:29:04.261: E/AndroidRuntime(30183):    at egypt.interfaceAct.locationFinder.onCreate(locationFinder.java:47)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1065)
06-22 18:29:04.261: E/AndroidRuntime(30183):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2745)
06-22 18:29:04.261: E/AndroidRuntime(30183):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T16:58:10.040

您尚未初始化`newHotels`变量。在方法的开头添加以下行`onCreate`：

```
newHotels = new ArrayList<Hotel>(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T17:13:45.803

您可能还需要在使用前检查**类别**：

```
String category = i.getStringExtra("category");

if(category.equals("hotels")) 
```

注意**类别**可能为空，因此您最好执行以下操作：

```
if(category != null && category.equals("hotels")) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T19:51:12.057

您可以通过查找包含您“知道”的类的行来在 LogCat 中找到您的错误。例如，在您的 LogCat 中有一行“在 egypt.interfaceAct.locationFinder.onCreate(locationFinder.java:47)”

在 LogCat 的所有类中，这是最知名的类，因此您可以检查第 47 行的类 locationFinder 并找出第 47 行的问题。

我假设您的 List newHotels 仍然为空。所以只需初始化 newsHotels

```
newHotels = new ArrayList<Hotel>(); 
```

在 onCreate 中添加此代码

# c# - 绑定 IP 地址

> ID：11160706
> 
> 赞同：0
> 
> 时间：2012-06-22T16:51:57.717
> 
> 标签：c#, c++, .net

我正在将一些 C++ 代码重写为 C#。我正在重构的代码在 C++ 中使用[AddIPAddress](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365801%28v=vs.85%29.aspx)，但我找不到在 C# 中执行相同操作的方法。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T16:55:31.753

您可以使用[P/Invoke](http://msdn.microsoft.com/en-us/library/aa288468%28v=vs.71%29.aspx)直接调用该方法。[此页面](http://www.pinvoke.net/default.aspx/iphlpapi.addipaddress)包含有关如何执行此操作的详细信息（和示例）。

基本思想是通过将其声明为 来创建对应于本机方法的 C# 方法`extern`，并使用`DllImport`属性对其进行装饰：

```
DllImport("iphlpapi.dll", EntryPoint = "AddIPAddress", SetLastError = true)]
private static extern UInt32 AddIPAddress(UInt32 Address, UInt32 IpMaskint, int IfIndex, out int NTEContext, out int NTEInstance); 
```

# css - XAML 中的简单悬停效果？

> ID：11160715
> 
> 赞同：2
> 
> 时间：2012-06-22T16:52:38.437
> 
> 标签：css, xaml, windows-8, microsoft-metro, winrt-xaml

所以，我最近对复制这种效果的挑战感到沮丧：

```
<style>
a:hover {background-color:yellow; }
</style> 
```

在 WinRT 中使用 XAML 实现。

什么是最简洁的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-02T15:47:18.147

好的，这是我的尝试：

```
<VisualStateManager.VisualStateGroups>
    <VisualStateGroup x:Name="VisualStateGroup">
        <VisualState x:Name="Normal"/>
        <VisualState x:Name="Hover">
            <Storyboard>
                <ColorAnimation To="Yellow" Duration="0"
                    Storyboard.TargetProperty="(Panel.Background).(SolidColorBrush.Color)" 
                    Storyboard.TargetName="MyTextBox" />
            </Storyboard>
        </VisualState>
    </VisualStateGroup>
</VisualStateManager.VisualStateGroups>

<Grid x:Name="MyTextBox" Background="White"
        PointerEntered="MyTextBox_PointerEntered" 
        PointerExited="MyTextBox_PointerExited"
        Height="114" Width="537">
</Grid> 
```

和这个：

```
private void MyTextBox_PointerEntered(object sender, PointerRoutedEventArgs e)
{
    VisualStateManager.GoToState(this, Hover.Name, false);
}

private void MyTextBox_PointerExited(object sender, PointerRoutedEventArgs e)
{
    VisualStateManager.GoToState(this, Normal.Name, false);
} 
```

但是，肯定有更好的方法！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-29T19:11:19.233

```
<VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="CommonStates">
                <VisualState x:Name="Normal"/>
                <VisualState x:Name="PointerOver">
                    <Storyboard>
                        <ColorAnimation To="Yellow" Duration="0"
                Storyboard.TargetProperty="(Panel.Background).(SolidColorBrush.Color)" 
                Storyboard.TargetName="MyTextBox" />
                    </Storyboard>
                </VisualState>
                <VisualState x:Name="Pressed"/>
            </VisualStateGroup>
</VisualStateManager.VisualStateGroups> 
```

RT 中的“悬停”状态为“PointerOver”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T13:20:40.343

我认为您必须研究 Visual States 和[VisualStateManager](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.visualstatemanager)。我认为 Button 控件是唯一具有视觉状态的控件，这意味着您的视觉实体必须定义为一个 Button（尽管它不必作为一个）。在该文章的底部，您会找到一个示例。

[这个 SO-question](https://stackoverflow.com/questions/10425124/where-are-the-possible-visualstates-for-windows-8-metro-controls-documented)也可能会有所帮助，描述如何从现有按钮中提取控件模板。这将为您提供一个起点，您可以根据需要进行修改。

至于“最简洁的解决方案”，我也想看看。我见过的例子都需要20多行XAML代码，对我来说感觉不是很简洁......

# php - PHP中的简单表回显

> ID：11160716
> 
> 赞同：1
> 
> 时间：2012-06-22T16:52:41.167
> 
> 标签：php, mysql, html

我正在构建这个功能，但我没有得到想要的输出，我仍然在这个上面已经超过 5 个小时了。

我有这个代码：

```
$result = mysql_query("SELECT $checked FROM hostess");
echo "<table border='1'>";
foreach( $checked1 as $key => $value){
   echo "<th> $value </th>";

   while($row = mysql_fetch_array($result)){
      foreach($checked1 as $key => $value){
         echo "<tr>" . $row[$value] . "</tr>"; 
      }
   }
}
echo "</table>"; 
```

我需要的是打印第一个`$value`作为表`$row[value]`的标题，然后作为行，但我要打印标题，然后其余的只是打印在一行中，所有这些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:56:59.113

为了正确调试您的问题，请记住表格通常的外观：

```
<table>
  <thead>
    <th>
      <td></td>
      <td></td>
    </th>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table> 
```

`<pre>`因此，通过将输出包装在一些标签中来查看您的代码输出的内容。你会看到你错过了什么。

此外，还有很多关于将 mysql 表输出为 html 的主题的教程——也许你可以从某个地方偷一个。

```
http://forums.devshed.com/php-development-5/display-results-from-query-in-html-table-4095.html
or http://www.anyexample.com/programming/php/php_mysql_example__display_table_as_html.xml 
```

另外，如果你真的想和我一起呆一会儿，如果你看一下一种流行的设计模式，称为[工厂模式](http://www.webgeekly.com/tutorials/php/how-to-create-a-php-factory-pattern/)，你真的可以用它构建一个很棒的表类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T16:56:55.170

好的，我现在明白了。您的问题是您没有以正确的顺序打印标签和值。尝试这个：

```
$result = mysql_query("SELECT $checked FROM hostess");
echo "<table border='1'>";
echo "<thead><tr>"
foreach( $checked1 as $key => $value){
   echo "<th> $value </th>";
}
echo "</tr></thead>";

while($row = mysql_fetch_array($result)) {
    echo "<tr>";
    foreach($checked1 as $key => $value){
        echo "<td>" . $row[$value] . "</td>"; 
    }
    echo "</tr>";
}
echo "</table>"; 
```

# php - 从同级子目录访问 CodeIgniter 应用程序

> ID：11160717
> 
> 赞同：0
> 
> 时间：2012-06-22T16:52:41.873
> 
> 标签：php, .htaccess, codeigniter, dry

我有一个场景，我必须为不同的语言部署多个目录。开发最初集中在其中一种语言上，整个网站的一部分只是一个小型 CI 应用程序。

我试图避免为其他几种语言复制整个应用程序，并使用`.htacces`. 后者工作正常，但是当从与*真实*URL 不同的 URL 访问时，CI 会返回 404 错误。

我最好的猜测是某些配置文件必须存在具有配置附加根 URL 的唯一属性，但我不知道从哪里开始（谷歌没有提出类似的方案）。

文件结构：

```
public_html/
    lang1/
        app/    
            (the actual CI app)
        other static stuff...
    lang2/
        app/
            .htaccess (redirecting to /lang1/app/)
        other static stuff...
    lang3/
        ... 
```

附加信息：

`$config['base_url']`设置`http://.../lang1/app/`为。

`.htaccess`: _

```
RewriteEngine on
RewriteRule ^(.*)$ /lang1/app/$1 [L] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T14:52:41.080

我能够自己完成这项工作。对于那些将来可能会发现这个问题的人，这些是从不同目录访问您的应用程序的步骤。考虑到上面问题中介绍的场景，以下示例将适用于在目录中部署应用程序的*幽灵*版本`lang2`：

1.-*仅*将 index.php 文件从 CI 安装的根目录（从）复制到**目录** 。*`lang1/app/index.php``lang2/app/`*

 *2.-**编辑**以下行：

```
$system_path = '../../lang1/app/system';

$application_folder = '../../lang1/app/application';
//Even if the documentation suggests the necessity of a _full path_, 
//this works perfectly well for 2.1.0 
```

3.-**添加**您可能希望为所述子目录显式设置的任何配置，这些将设置为 $this->config，替换基本应用程序中配置文件中设置的值：

```
$assign_to_config['lang_version'] = 'lang2'; 
```

4.- 你必须设置一个适当的`base_url`. 在这种情况下，我们可以重用`lang_version`刚刚包含的配置。这样，我们可以在需要创建的下一个语言中忘记这一行。

```
$assign_to_config['base_url'] = 
    'http://www.example.com/' . $assign_to_config['lang_version'] . '/app/'; 
```

5.-在里面**创建**一个`.htaccess`文件`lang2/app`，以确保 HTML 访问的任何静态资产（js、css、图像）都是从原始应用程序目录中的实际资产文件夹中获取的，例如`lang1/app/assets`：

```
RewriteEngine on
RewriteRule ^assets/(.*)$ /lang1/app/assets/$1 [L] 
```

6.-**添加**到`.htaccess`您通常的规则以保持您的 URL 友好，但这次将所有流量引导到您的应用程序的*幽灵副本：*

```
RewriteCond $1 !^(index\.php|assets|robots\.txt)
RewriteRule ^(.*)$ /lang2/app/index.php/$1 [L] 
```

7.-**喝啤酒**或任何其他饮料来庆祝成功，始终遵守当地法律。利润。您的控制器必须读取该`config('lang_version')`值才能以适当的语言向用户呈现内容。您可以为此使用包含的语言助手，或您喜欢的任何其他解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T18:18:34.893

你为什么要这样做？有一个东西叫i18n。

[http://codeigniter.com/wiki/CodeIgniter_2.1_internationalization_i18n/](http://codeigniter.com/wiki/CodeIgniter_2.1_internationalization_i18n/)

为什么不使用这个？复制应用文件夹对您来说是不是有点乏味？有一个语言助手是有原因的。

我希望这有帮助。*

# javascript - Javascript Wordpress 停止工作

> ID：11160718
> 
> 赞同：0
> 
> 时间：2012-06-22T16:53:00.750
> 
> 标签：javascript, jquery, wordpress

任何人都可以快速查看一下，看看为什么 jquery 似乎不起作用？它今天早些时候工作，我不确定我可以触摸什么会导致它停止。

我在这里设置了一个 jsfiddle：http: [//jsfiddle.net/Nqdb3/](http://jsfiddle.net/Nqdb3/) 但如果这不利于故障排除，我可以提供实际站点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T19:23:00.360

我无法登录，但我可以告诉你，我在 wordpress 的管理和前端都遇到过很多次 jQuery 问题。

这些通常的嫌疑人是插件，但它在过去发生在我身上，甚至没有接触过网站。

1）开始一一**禁用所有插件 - 这将消除导致它的不同脚本的可能性。**如果你幸运的话，你会发现罪魁祸首。

2）从同一个wordpress安装上传js文件夹。-- 下载你已有的相同版本 -- 上传**wp-includes**下的 js 目录-- 全部。并替换您当前的目录。

对我来说，它工作了很多（很多）次。

# javascript - 用js修改类中的所有元素

> ID：11160721
> 
> 赞同：0
> 
> 时间：2012-06-22T16:53:14.987
> 
> 标签：javascript

我试图根据用户所做的下拉菜单选择隐藏/显示表单中的一类元素。见：http: [//jsfiddle.net/3FmHK/2/](http://jsfiddle.net/3FmHK/2/)

我是 js 新手，有两个问题，所以也许它们很明显，请耐心等待。

1）我正在通过 div id 进行修改，所以只有第一个元素发生了变化（由于某种原因，不在这个小提琴中，但它在项目中发生了）。但是，我希望修改一个类的所有元素，但我无法做到这一点。那么如何修改整个类的 style="display" 而不是单个元素呢？

2) remove 不适用于新添加的元素，当表单返回项目中的值时，它们是可移除的。据我所知，使用 firebug，GET 返回生成的元素与用户添加的元素的代码看起来相同。为什么删除功能不适用于新添加的元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:02:12.043

如果可以的话，我建议使用 jQuery。您可以使用 .on() 功能将操作绑定到新创建的元素，并使用类选择器 .hide() 所有类，然后 .show() 当前通过 id 选择的类。

它看起来像这样：

```
jQuery(document).ready( function() {
    jQuery(document).on('click', '.classname', function() {
        jQuery('.' + jQuery(this).attr('class') ).hide();
        jQuery(this).show();
        // Or you can use the following to show a specific ID element.
        //jQuery('#idtoshow').show();
    )};
}); 
```

这将隐藏所有具有类名的元素。您需要在脚本之前包含 jQuery 库。虽然我在这里只使用了显示和隐藏，但您可以使用 .remove()，只要您使用 .on 而不仅仅是 .click 来绑定您的操作。您需要 .on 才能绑定到新创建的元素。

[http://api.jquery.com/on/](http://api.jquery.com/on/)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:00:25.123

尝试：

```
$(this).parent('div').first().remove(); 
```

# wpf - 将一个依赖属性绑定到另一个

> ID：11160736
> 
> 赞同：1
> 
> 时间：2012-06-22T16:54:30.650
> 
> 标签：wpf, xaml, dependency-properties

我有一个已创建的自定义选项卡控件，但我遇到了问题。我有一个可编辑的文本框作为自定义 TabControl 视图的一部分。

```
<Controls:EditableTextControl x:Name="PageTypeName" 
                                  Style="{StaticResource ResourceKey={x:Type Controls:EditableTextControl}}" Grid.Row="0" TabIndex="0" 
                                  Uid="0"
                                  AutomationProperties.AutomationId="PageTypeNameTextBox"
                                  AutomationProperties.Name="PageTypeName"
                                  Visibility="{Binding ElementName=PageTabControl,Path=ShowPageType}">
        <Controls:EditableTextControl.ContextMenu>
            <ContextMenu x:Name="TabContextMenu">
                <MenuItem Header="Rename Page Type" Command="{Binding Path=PlacementTarget.EnterEditMode, RelativeSource={RelativeSource AncestorType=ContextMenu}}" 
                          AutomationProperties.AutomationId="RenamePageTypeMenuItem"
                          AutomationProperties.Name="RenamePageType"/>
                <MenuItem Header="Delete Page Type" Command="{Binding Path=PageTypeDeletedCommand}" 
                          AutomationProperties.AutomationId="DeletePageTypeMenuItem"
                          AutomationProperties.Name="DeletePageType"/>
            </ContextMenu>
        </Controls:EditableTextControl.ContextMenu>
        <Controls:EditableTextControl.Content>
            <!--<Binding Path="CurrentPageTypeViewModel.Name" Mode="TwoWay"/>-->
            <Binding ElementName="PageTabControl" Path="CurrentPageTypeName" Mode ="TwoWay"/>
        </Controls:EditableTextControl.Content>
    </Controls:EditableTextControl> 
```

在内容部分，我绑定到一个名为 CurrentPageTypeName 的 Dependency Prop。这个 Dependency 属性是这个自定义选项卡控件的一部分。

```
public static DependencyProperty CurrentPageTypeNameProperty = DependencyProperty.Register("CurrentPageTypeName", typeof(object), typeof(TabControlView));
    public object CurrentPageTypeName
    {
        get { return GetValue(CurrentPageTypeNameProperty) as object; }
        set { SetValue(CurrentPageTypeNameProperty, value); }
    } 
```

在另一个视图中，我使用自定义 TabControl 然后将我的属性与实际名称值绑定到 CurrentPageTypeName 属性，如下所示：

```
 <Views:TabControlView Grid.Row="0" Name="RunPageTabControl" 
                          TabItemsSource="{Binding RunPageTypeViewModels}"                              
                          SelectedTab="{Binding Converter={StaticResource debugConverter}}" 
                          CurrentPageTypeName="{Binding Path=RunPageName, Mode=TwoWay}" 
                          TabContentTemplateSelector="{StaticResource tabItemTemplateSelector}"  
                          SelectedIndex="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}, Path=DataContext.SelectedTabIndex}"
                          ShowPageType="Hidden" >           
        <!--<Views:TabControlView.TabContentTemplate>
            <DataTemplate DataType="{x:Type ViewModels:RunPageTypeViewModel}">
                <RunViews:RunPageTypeView/>
            </DataTemplate>
        </Views:TabControlView.TabContentTemplate>-->

    </Views:TabControlView> 
```

我的问题是似乎什么都没有发生。它是从 Itemsource 中获取其内容，而不是从我的链式 Dependency 道具中获取。我正在尝试的甚至可能吗？如果是这样，我做错了什么。

感谢您的关注。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T21:13:56.720

除非我遗漏了什么，否则这绝对是可能的。这是一个简化的工作示例。

具有名为 TestValue 的依赖属性的用户控件，其中包含绑定到此属性的 TextBox：

```
<UserControl x:Class="TestApp.TestControl" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" mc:Ignorable="d" d:DesignHeight="300" d:DesignWidth="300"
             x:Name="TestControlName">
  <Grid>
    <TextBox Text="{Binding ElementName=TestControlName, Path=TestValue, Mode=TwoWay}"/>
  </Grid>
</UserControl> 
```

使用此用户控件的不同视图，将上述依赖项属性绑定到某些东西：

```
<Window x:Class="TestApp.MainWindow" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:TestApp="clr-namespace:TestApp" Title="MainWindow"
        Height="350" Width="525">
  <StackPanel>
    <TestApp:TestControl TestValue="{Binding ElementName=SourceTextBox, Path=Text, Mode=TwoWay}" />
    <TextBox Name="SourceTextBox" />
  </StackPanel>
</Window> 
```

听起来问题出在您未发布的代码部分中（例如，内容绑定中使用了错误的名称）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T21:16:07.700

我认为您已经为 " `SelectedIndex`" 属性解决了这个问题。`CurrentPageType`只需对 " " 属性执行相同的操作，即使用`RelativeSource`

# iphone - iPhone - 将 50 帧保存到电影后应用程序停止

> ID：11160737
> 
> 赞同：0
> 
> 时间：2012-06-22T16:54:50.180
> 
> 标签：iphone, ios, ipad

我有几个 UIImages，我想用它们创建一个视频。

我使用了[基于此的解决方案](https://stackoverflow.com/questions/6061092/make-movie-file-with-picture-array-and-song-file-using-avasset)

从 UIImages 创建视频。就我而言，我想创建一个 30 fps 的视频。因此，每张图像都是 1/30 秒。

在设置完所有内容以开始保存视频后，如该页面所述，我创建了一个将一个图像保存到电影的方法，该方法由循环调用。就像是：

```
for (int i=0; i<[self.arrayOfFrames count]; i++ {
  UIImage *oneImage = [self.arrayOfFrames objectAtIndex:i];
  [self saveOneFrame:oneImage atTime:i];
} 
```

方法是

```
-(void)saveOneFrame:(UIImage *)imagem atTime:(NSInteger)time {
    // I have tried this autorelease pool to drain memory after the method is finished
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

    CVPixelBufferRef buffer = NULL;

    buffer = [self pixelBufferFromCGImage:imagem.CGImage size:imagem.size];

    BOOL append_ok = NO;
    int j = 0;
    while (!append_ok && j < 30) 
    {
        if (adaptor.assetWriterInput.readyForMoreMediaData) 
        {
            printf("appending %d attemp %d\n", time, j);

            CMTime oneFrameLength = CMTimeMake(1, 30.0f );  // one frame = 1/30 s
            CMTime lastTime;
            CMTime presentTime;

            if (time == 0) {
                presentTime = CMTimeMake(0, self.FPS);
            } else {
                lastTime = CMTimeMake(tempo-1, self.FPS);
                presentTime = CMTimeAdd(lastTime, duracaoUmFrame);

            }
            // this will always add 1/30 to every new keyframe
            CMTime presentTime = CMTimeAdd(lastTime, oneFrameLength);

            append_ok = [adaptor appendPixelBuffer:buffer withPresentationTime:presentTime];
            CVPixelBufferPoolRef bufferPool = adaptor.pixelBufferPool;
            NSParameterAssert(bufferPool != NULL); 

            [NSThread sleepForTimeInterval:0.05];
        } 
        else 
        {
            printf("adaptor not ready %d, %d\n", time, j);
            [NSThread sleepForTimeInterval:0.1];
        }
        j++;
    }
    if (!append_ok) {
        printf("error appending image %d times %d\n", time, j);
    }
    CVBufferRelease(buffer);
    [pool drain]; // I have tried with and without this autorelease pool in place... no difference

} 
```

在将 50 帧保存到电影后，应用程序会在没有任何警告的情况下直接退出......

这是另一种方法：

```
-(CVPixelBufferRef) pixelBufferFromCGImage:(CGImageRef)image size:(CGSize)size
{
    NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:
                             [NSNumber numberWithBool:YES], kCVPixelBufferCGImageCompatibilityKey,
                             [NSNumber numberWithBool:YES], kCVPixelBufferCGBitmapContextCompatibilityKey,
                             nil];
    CVPixelBufferRef pxbuffer = NULL;
    CVReturn status = CVPixelBufferCreate(kCFAllocatorDefault, size.width,
                                          size.height, kCVPixelFormatType_32ARGB, (CFDictionaryRef) options, 
                                          &pxbuffer);
    status=status;//Added to make the stupid compiler not show a stupid warning.
    NSParameterAssert(status == kCVReturnSuccess && pxbuffer != NULL);

    CVPixelBufferLockBaseAddress(pxbuffer, 0);
    void *pxdata = CVPixelBufferGetBaseAddress(pxbuffer);
    NSParameterAssert(pxdata != NULL);

    CGColorSpaceRef rgbColorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef context = CGBitmapContextCreate(pxdata, size.width,
                                                 size.height, 8, 4*size.width, rgbColorSpace, 
                                                 kCGImageAlphaNoneSkipFirst);
    NSParameterAssert(context);

    //CGContextTranslateCTM(context, 0, CGImageGetHeight(image));
    //CGContextScaleCTM(context, 1.0, -1.0);//Flip vertically to account for different origin

    CGContextDrawImage(context, CGRectMake(0, 0, CGImageGetWidth(image), 
                                           CGImageGetHeight(image)), image);
    CGColorSpaceRelease(rgbColorSpace);
    CGContextRelease(context);

    CVPixelBufferUnlockBaseAddress(pxbuffer, 0);

    return pxbuffer;
} 
```

我运行仪器并且在电影开始保存之前没有检测到任何泄漏或夸大的内存使用情况。

任何线索？

* * *

笔记：

查看设备日志后，我发现：

```
<Notice>: (UIKitApplication:com.myID.myApp[0xc304]) Bug: launchd_core_logic.c:3732 (25562):3
<Notice>: (UIKitApplication:com.myID.myApp[0xc304]) Assuming job exited: <rdar://problem/5020256>: 10: No child processes
<Warning>: (UIKitApplication:com.myID.myApp[0xc304]) Job appears to have crashed: Segmentation fault: 11
<Warning>: Application 'myApp' exited abnormally with signal 11: Segmentation fault: 11 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T18:02:34.120

也许您已经尝试过，但这有[帮助](https://stackoverflow.com/questions/7645399/unexplainable-segmentation-fault-on-iphone)吗？

> 最后，解决方案是重新启动 iPhone，因为某些数据已损坏。重启后一切正常。
> 
> 应该想到经典的“你试过把它关掉再打开吗？”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T19:35:42.367

这样看，您有一组图像（占用大量内存的东西）。您正在制作每个图像的副本并将副本保存到完成的电影中。因此，您的要求基本上是您开始时的两倍。如果在添加框架后释放每个框架会怎样？这意味着您最终可能会获得相同大小（或可能稍大，但仍小于您所拥有的）内存使用量。

# facebook - C# facebook 通过更新延长长期访问令牌到期日

> ID：11160739
> 
> 赞同：1
> 
> 时间：2012-06-22T16:55:06.773
> 
> 标签：facebook, c#-4.0, facebook-c#-sdk

目前我正在使用长期访问令牌（60 天过期长期）。

我在 facebook 上看到一个帖子，我可以通过首先取回短期访问令牌然后将其更新为新的长期访问令牌来扩展长期访问令牌。我希望这可以在没有用户参与的情况下完成。（用户不必为此过程再次登录并授予权限）

有人在c#中做过这个吗？

如果您可以共享代码或链接，将不胜感激。

以下是来自 facebook 网站的说明：

“如果你想刷新一个仍然有效的长寿命 access_token，你必须先获取一个新的短寿命用户 access_token，然后调用下面的相同端点。返回的 access_token 将有一个新的长寿命到期时间，但是，access_token 本身可能与先前授予的长寿命 access_token 相同，也可能不同。”

这里有一些示例贴在我不熟悉如何使用的说明下方：

```
https://graph.facebook.com/oauth/access_token?             
    client_id=APP_ID&
    client_secret=APP_SECRET&
    grant_type=fb_exchange_token&
    fb_exchange_token=EXISTING_ACCESS_TOKEN 
```

网站来源：http: [//developers.facebook.com/roadmap/offline-access-removal/](http://developers.facebook.com/roadmap/offline-access-removal/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:13:17.177

> [...] y 首先取回短期访问令牌，然后将其更新为新的长期令牌。我希望这可以在没有用户参与的情况下完成。

不，当然**不能**，至少在没有*任何*用户交互的情况下不能。

您至少必须让用户访问其中一个页面，您可以在客户端检查他的登录状态，并在他仍然连接到您的应用程序时获得一个短暂的访问令牌作为回报。

# mysql - MySQL如何插入一个值而不影响其他值

> ID：11160746
> 
> 赞同：0
> 
> 时间：2012-06-22T16:55:33.233
> 
> 标签：mysql, insert

在我的表“帐户”中，我有四列，例如

*user, pass, column1, column2* 我需要将值插入 column2，其中 user='special_user_value'。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:00:27.303

使用更新查询，如：

```
Update table_nm set field1=value1,  Field2=value2 Where condition; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T16:58:36.430

您不会将值“插入”到列中。您插入*一行*，该行具有您在表创建中指定的所有列的值；就像一张真正的桌子，或者这方面的 Excel 表格。

如果您需要*更改*特定行的列值，可以使用[`UPDATE`](http://www.w3schools.com/php/php_mysql_update.asp)：

`UPDATE table_name SET column2='new value' WHERE user='special_user_value'`

这是一个非常基本的例子。如果您点击我提供的链接[`UPDATE`](http://www.w3schools.com/php/php_mysql_update.asp)，您可能会了解有关更改特定行的表值的更多信息。

如果您正在寻找为该列实际插入具有特定值的新行，那么[`INSERT INTO`](http://www.w3schools.com/php/php_mysql_insert.asp)您可以遵循这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-22T16:58:46.383

```
UPDATE Accounts SET column2='NewValue' WHERE user='special_user_value' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-22T16:59:16.667

```
UPDATE accounts
SET    column2 = 'New Value'
WHERE  user = 'special_user_value'; 
```

# python - 使用 dateutil 解析

> ID：11160749
> 
> 赞同：1
> 
> 时间：2012-06-22T16:55:48.520
> 
> 标签：python

我有一个 csv 文件，其中的数据看起来像（见下文）。我需要帮助解析日期时间并填写缺失的日期时间并将缺失的数据分配为“M”（缺失）：

```
Datetime, Data

19920101 00:00,2
19920101 01:00,3
19920101 23:00,5
19920505 12:00,5 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:08:42.547

不是一个完整的答案，但只是试图解析日期时间字符串

```
>>> s="19920101 00:00"
>>> format = "%Y%m%d %H:%M"
>>> d = datetime.datetime.strptime(s, format)
>>> print d
1992-01-01 00:00:00 
```

这是否有助于为您找出丢失的日期和时间。

我无法理解字符串中的 3 是什么`3 19920101 23:00`。

[编辑：根据您的评论]

```
>>> expected = d + datetime.timedelta(days=1)
>>> print expected
1992-01-02 00:00:00 
```

所以在你的代码中，你可以尝试这样的事情（你需要工作和完善它）

[编辑：代码替换]

```
import csv
import sys
import datetime
import pprint

all_data_points = {}
all_dates = []
expected = ''
format = "%Y%m%d %H:%M"

with open('datafile', 'rt') as f:
    reader = csv.reader(f)
    for row in reader:
        if row and 'Datetime' not in row:
            day_str = row[0]
            rain_str = row[1]
            if not expected:
                all_data_points[day_str] = rain_str
                all_dates.append(day_str)
                d = datetime.datetime.strptime(day_str, format)
                expected = d + datetime.timedelta(days=1)
            else:
                d = datetime.datetime.strptime(day_str, format)
                gap_in_days = d - expected 
                start_day = expected
                if gap_in_days.days > 1:
                    for i in xrange(gap_in_days.days):
                        next_day = start_day + datetime.timedelta(days=1+i)
                        day_str = next_day.strftime(format)
                        all_data_points[day_str] = 'M'
                        all_dates.append(day_str)
                all_data_points[day_str] = rain_str
                expected = d

    pprint.pprint(all_data_points) 
```

# php - 通过 $_POST 回显一个数组

> ID：11160752
> 
> 赞同：0
> 
> 时间：2012-06-22T16:55:55.780
> 
> 标签：php, arrays, forms, post, include

所以我对php相当陌生，我一直在尝试寻找解决我的问题的方法；我发现了其他类似的帖子，但从未找到我理解足以尝试的答案。

评论应该解释我想要什么，但如果有点太模糊，我很抱歉。我真的不知道如何解释这一点。

提前感谢您提供的任何帮助。

```
<?php include ("calc.php"); ?>

<form method="post" name="form">
<input type="text" name="username"/>
</form>

<form>
<input id="info" type="text" value="<?php echo $info[1]; //This just appears blank, and I don't know how to fix ?>"/>
</form>

<?php
if(isset($_POST["username"])) {
    calc($_POST["username"]); //Posts to calc.php where the function "calc" will put some info into an array called $info[1]
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T06:55:52.990

尝试更改指令的顺序，首先在数组中添加数据，然后访问该数据

```
<?php
if(isset($_POST["username"])) {
 calc($_POST["username"]); //Posts to calc.php where the function "calc" will put some info into an array called $info[1]
}
?>
<form>
<input id="info" name="info" type="text" value="<?php if(isset($info[1])) echo $info[1]; ?>"/>
</form> 
```

# c# - 即使添加了明确的错误语句，PredicateBuilder 仍然为真

> ID：11160756
> 
> 赞同：0
> 
> 时间：2012-06-22T16:55:58.663
> 
> 标签：c#, .net, expression-trees, predicatebuilder

我有以下声明。

```
var search = PredicateBuilder.True<SomeType>();
search.And(f => false);

// Still the "search" variable value is: {f => true}. 
```

起初，我在尝试一种表达方式；没有成功，所以我尝试了这个“假”。不管我做了什么，它仍然是一样的。怎么了？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-22T16:58:44.640

`PredicateBuilder`方法不会改变表达式（它们不能，因为表达式树是不可变的） - 您需要使用返回值：

```
var search = PredicateBuilder.True<SomeType>();
search = search.And(f => false); 
```

# php - 检查 cURL 输出 PHP

> ID：11160760
> 
> 赞同：3
> 
> 时间：2012-06-22T16:56:11.023
> 
> 标签：php, curl

我正在尝试检查 cURL 的输出。

```
<?php

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,"https://blablabla.com");
    curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
    $curlresult=curl_exec ($ch);
      curl_close ($ch);

    if ($curlresult == "OK") {
        $result = "The curl action was succeeded! (OUTPUT of curl is: ".$curlresult.")";
    } else {
        $result = "The curl action has FAILED! (OUTPUT of curl is: ".$curlresult.")";
    }

echo $result;

?> 
```

URL (https://blablabla.com) 是一个显示 OK 的 URL。所以，使用代码，我希望看到

> “卷曲动作成功！（卷曲的输出为：OK）”

但是，我得到的是：

> 卷曲动作失败了！（卷曲的输出是：OK）

我想我犯了一些愚蠢的错误。如何检查[https://blablabla.com](https://blablabla.com)是否包含“OK”？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-23T03:42:09.507

You may be getting extra white spaces before or after the OK or other characters.

I suggest doing what the people above suggested by testing what is exactly inside the array with `var_dump($curlresult);` or `print_r($curlresult);`

But alternatively you could instead of matching that $curlresult equals only "OK", you could test if $curlresult contains "OK" inside of it.

```
<?php

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,"https://blablabla.com");
    curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
    $curlresult=curl_exec ($ch);
      curl_close ($ch);

    if (preg_match("/OK/i", $curlresult)) {
        $result = "The curl action was succeeded! (OUTPUT of curl is: ".$curlresult.")";
    } else {
        $result = "The curl action has FAILED! (OUTPUT of curl is: ".$curlresult.")";
    }

echo $result;

?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T17:49:04.057

you can do

```
$info = curl_getinfo($ch);
var_dump($info); 
```

gives you info on http status code returned and connect time etc.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T17:22:42.907

您应该尝试`var_dump($curlresult);`看看您真正得到了什么，否则我认为使用 SSL (HTTPS) 可能存在问题，以快速解决此问题（接受任何服务器证书）：

```
<?php

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,"https://blablabla.com");
    curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    $curlresult=curl_exec ($ch);
     curl_close ($ch);

    if ($curlresult == "OK") {
        $result = "The curl action was succeeded! (OUTPUT of curl is: ".$curlresult.")";
    } else {
        $result = "The curl action has FAILED! (OUTPUT of curl is: ".$curlresult.")";
    }

//var_dump($curlresult);
echo $result;

?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T17:29:18.667

看，在这个代码块中：

```
if ($curlresult == "OK") {
        $result = "The curl action was succeeded! (OUTPUT of curl is: ".$curlresult.")";
    } else {
        $result = "The curl action has FAILED! (OUTPUT of curl is: ".$curlresult.")";
    } 
```

it is assumed that `$curlresult` is string, First try `var_dump($curlresult)` to know what datatype response is returned from this call. May be return type is not string.
Then use the check for that datatype in if condition.

# c - 创建动态线程数

> ID：11160763
> 
> 赞同：6
> 
> 时间：2012-06-22T16:56:17.043
> 
> 标签：c, multithreading, pthreads

我想创建用户指定的多个线程。我为此编写的代码是：

```
int nhijos = atoi(argv[1]);

thread = malloc(sizeof(pthread_t)*nhijos);

for (i = 0; i < nhijos; i++){
  if (pthread_create ( &thread[i], NULL, &hilos_hijos, (void*) &info ) != 0){
  perror("Error al crear el hilo. \n");
  exit(EXIT_FAILURE);
} 
```

它是否正确？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T17:08:32.863

是的，但我会执行以下操作：

1.  在调用 atoi(argv[1]) 之前验证 argc > 1

2.  validate numberOfThreads 是一个正数并且小于一个合理的范围。（如果用户键入 1000000）。

3.  验证 malloc 的返回值不为空。

4.  pthread_create 不会在失败时设置 errno。所以 perror 可能不是调用失败的正确函数。

...

```
if (argc > 1)
{
    int numberOfThreads = atoi(argv[1]); 
    if ((numberOfThreads <= 0) || (numberOfThreads > REASONABLE_THREAD_MAX))
    {
        printf("invalid argument for thread count\n");
        exit(EXIT_FAILURE);
    }

    thread = malloc(sizeof(pthread_t)*numberOfThreads); 
    if (thread == NULL)
    {
       printf("out of memory\n");
       exit(EXIT_FAILURE);
    }

    for (i = 0; i < numberOfThreads; i++)
    { 
        if (pthread_create ( &thread[i], NULL, &hilos_hijos, (void*) &info ) != 0)
        { 
            printf("Error al crear el hilo. \n"); 
            exit(EXIT_FAILURE); 
        }    
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T17:06:22.137

```
#include<stdio.h>
#include<pthread.h>

void* thread_function(void)
{
    printf("hello");
}
int main(int argc,char *argv[])
{
    int noOfThread= atoi(argv[1]);
    pthread_t thread_id[noOfThread];
    int i;
    int status;
    for(i=0;i<noOfThread;i++)
    {
        pthread_create (&thread_id[i], NULL , &thread_function, NULL);
    }  

    for(i=0;i<noOfThread;i++)
        pthread_join(thread_id[i],NULL);   
} 
```

现在编译 thi 并运行为

```
./a.exe 3 
```

所以将创建3个线程

* * *

在您的代码中

1> 你为什么要去 malloc ？

2> 如果 malloc 那么为什么你不打算释放它呢？

# c# - 如何处理大图像？

> ID：11160765
> 
> 赞同：1
> 
> 时间：2012-06-22T16:56:26.527
> 
> 标签：c#, asp.net-mvc-3

我正在为摄影师创建一个作品集网站。

我面临从大到小调整照片大小的问题。如果我缩小尺寸，质量就会丢失很多。如何压缩图片以免损失质量？

我的代码：

```
using (var input = new Bitmap(imageFile.InputStream))
            {
                int width;
                int height;
                if (input.Width > input.Height)
                {
                    width = 411 * input.Width / input.Height;
                    height = 411;
                }
                else
                {
                    height = 411;
                    width = 411 * input.Width / input.Height;
                }

                using (var thumb = new Bitmap(width, height))
                using (var graphic = Graphics.FromImage(thumb))
                {
                    graphic.InterpolationMode = InterpolationMode.HighQualityBicubic;
                    graphic.SmoothingMode = SmoothingMode.AntiAlias;
                    graphic.PixelOffsetMode = PixelOffsetMode.HighQuality;

                    graphic.DrawImage(input, 0, 0, width, height);
                    using (var output = System.IO.File.Create(imagePath))
                    {
                        thumb.Save(output, ImageFormat.Jpeg);
                    }
                }
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:04:27.807

逐步调整大小（如每步10-25 %）**可能会**获得更好的结果。也可以尝试保存无损格式（如 ImageFormat.Png）。

如果质量非常重要，则在适当的照片编辑工具中手动转换可能是正确的方法。

# asp.net - 使用公共路径在 ASP.NET 中强制下载音频文件

> ID：11160769
> 
> 赞同：0
> 
> 时间：2012-06-22T16:56:49.143
> 
> 标签：asp.net, file, audio, download

有谁知道如何使用公共路径通过“...另存为”窗口强制下载文件，例如：

www.domain.com/audio/myfile.mp3

我找到了很多示例，但使用的是虚拟路径而不是公共路径。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:42:37.463

你也许可以做一些 IIS url rewrite voodoo 来实现这一点。您可以轻松地进行一些 URL 路由，使其看起来像是从 /audio/file.mp3 下载，但实际上是通过特殊的处理程序提取文件。

但是，如果您只是提供具有 mimetype 的文件，那么您将无能为力 - 客户端在没有指示时真正控制他们如何处理文件，如果您只是以可直接访问的方式发布文件以供下载。

# css - 排除奇怪的伪 CSS 错误

> ID：11160770
> 
> 赞同：1
> 
> 时间：2012-06-22T16:56:52.067
> 
> 标签：css, z-index, pseudo-class, cross-browser

我正在做一个独特的工作项目。我遇到的问题是我只能控制这个项目中使用的 CSS 样式表，我的任务是真正改变它的布局，这很好。但是，我遇到了这个“密封”链接按钮的奇怪问题。

最初，他们有一个图像作为背景和打开一个弹出窗口以选择印章的链接，这是从 #searchSeal 内部触发的

它适用于较新的浏览器，但我需要支持 IE8+，在这些浏览器中，链接只需单击按钮的外缘，如果您将鼠标悬停在 :after 我为按钮创建后，它实际上只是一个占位符按钮的文本...然后链接丢失。

如果可以的话请帮忙！有问题的 CSS 在下面，我可能只是错过了这个问题。

谢谢！！

```
#divSeal {
    z-index: 2;
    display: block;
    position: absolute;
    left: 290px;
    top: 50px;
    width: 176px;
    height: 41px;}

#searchSeal {
    z-index: 3;
    display: block;
    position: absolute;
    left: 0px;
    top: 30px; 
    width: 176px;
    height: 40px; 
    border: 1px solid #B18D44; 
    color: white;
    background: #F9D791;
    border-radius: 15px 15px 15px 15px;
    -webkit-border-radius: 15px 15px 15px 15px;
    -moz-border-radius: 15px 15px 15px 15px;}

#searchSeal:hover {
    background: #B18D44;
    color: #004AFF;}

#searchSeal:after {
    content: "Choose Seal";
    z-index: 2;
    position: absolute;
    left: 0px;
    top: 0px;
    width: 176px;
    height: 40px;
    font: bold 24px Arial;
    line-height: 40px;
    text-align: center;
    text-shadow: 2px 2px #B18D44;}

#searchSeal a, #_ctl0_ContenPlaceHolderContent_hSearchSeal {
    z-index: 500;
    display: block;
    position: relative;
    left: 0px;
    top: 0px;
    width: 100% !important;
    height: 100% !important;
    text-decoration: none;} 
```

感谢您的所有帮助！

# c++ - 使用 GetDIBits 访问图像的像素颜色

> ID：11160773
> 
> 赞同：0
> 
> 时间：2012-06-22T16:56:57.637
> 
> 标签：c++, image, getdibits

我可以使用 GetDIBits 加载当前窗口的颜色内容，但我不知道如何从某个位置加载图像的颜色。有人可以告诉我该怎么做吗？

```
 char str[256];
        HDC hdc; 
        HWND hDesktopWnd; HDC hDesktopDC; HDC hCaptureDC;
        HBITMAP hCaptureBitmap; BITMAPINFO bmi = {0};
        RGBQUAD *pPixels; 
        int nScreenWidth, nScreenHeight;
        hdc = GetDC(hwnd);
        GetWindowRect(hwnd,&rect);

        hdc = GetDC(hwnd);
        if(GetWindowRect(hwnd, &rect))
        {
        width = rect.right - rect.left;
        height = rect.bottom - rect.top;
        }

            nScreenWidth =  GetSystemMetrics(SM_CXSCREEN);
            nScreenHeight = GetSystemMetrics(SM_CYSCREEN);
            hDesktopWnd = GetDesktopWindow();
            hDesktopDC = GetDC(hwnd);
            hCaptureDC = CreateCompatibleDC(hDesktopDC);
            hCaptureBitmap = CreateCompatibleBitmap(hDesktopDC, nScreenWidth, nScreenHeight);
            SelectObject(hCaptureDC, hCaptureBitmap); 
            BitBlt(hCaptureDC, 0, 0, nScreenWidth, nScreenHeight, hDesktopDC, 0,0, SRCCOPY|CAPTUREBLT); 

            bmi.bmiHeader.biSize = sizeof(bmi.bmiHeader);
            bmi.bmiHeader.biWidth = nScreenWidth;
            bmi.bmiHeader.biHeight = nScreenHeight;
            bmi.bmiHeader.biPlanes = 1;
            bmi.bmiHeader.biBitCount = 32;
            bmi.bmiHeader.biCompression = BI_RGB;

            pPixels = new RGBQUAD[nScreenWidth * nScreenHeight];

            ::GetDIBits(hCaptureDC,
                        hCaptureBitmap,
                        0,  
                        nScreenHeight,  
                        pPixels, 
                        &bmi,  
                        DIB_RGB_COLORS); 
```

我以这种方式将颜色加载到数组中

```
 for(int i= 0;i< nScreenHeight; i++){
            for(int j= 0;j< nScreenWidth; j++){
                col.red_palette[i][j]   = pPixels[(nScreenWidth * (nScreenHeight-(i+1))) + j].rgbRed;   
                col.green_palette[i][j] = pPixels[(nScreenWidth * (nScreenHeight-(i+1))) + j].rgbGreen; 
                col.blue_palette[i][j]  = pPixels[(nScreenWidth * (nScreenHeight-(i+1))) + j].rgbBlue;  
            }
            }

            delete [] pPixels;
            ReleaseDC(hDesktopWnd, hDesktopDC);
            DeleteDC(hCaptureDC);
            DeleteObject(hCaptureBitmap); 
```

我是 Windows 编程新手，只想知道如何将图像加载到 hdc 上。

正如雷蒙德建议的那样，我将第二个参数传递为

```
HBITMAP hCaptureBitmap;
hCaptureBitmap = (HBITMAP)LoadImage( NULL, szFileName, IMAGE_BITMAP, 0, 0,
            LR_CREATEDIBSECTION | LR_DEFAULTSIZE | LR_LOADFROMFILE ); 
```

我仍然只捕获活动窗口的颜色而不是图像的颜色。我如何更改设备句柄以反映这一点。

```
HWND hDesktopWnd; HDC hDesktopDC; HDC hCaptureDC;
hDesktopWnd = GetDesktopWindow();
hDesktopDC = GetDC(hwnd);
hCaptureDC = CreateCompatibleDC(hDesktopDC); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:06:25.323

```
RGBQUAD rgba = pPixels[y * nScreenWidth + x]; 
```

请注意，y=0 位于图像的底部，而不是您可能期望的顶部。

# php - 使用 PHP、AJAX 和 JavaScript 的简单按钮点击计数器

> ID：11160777
> 
> 赞同：2
> 
> 时间：2012-06-22T16:57:08.010
> 
> 标签：php

我只是想计算一个按钮的点击次数并将点击次数保存到一个文本文件中，但我似乎无法让这段代码工作。它不会节省点击次数。

在 HTML 文件中，我有一个运行 JavaScript 的按钮`onClick`：

```
function do() {
    if (window.XMLHttpRequest){
              xhr = new XMLHttpRequest()
    }
    else 
    {
    if (window.ActiveXObject){
              var xhr = new ActiveXObject("Microsoft.XMLHTTP");
              }
              }
            xhr.open('GET','count.php',false);
            xhr.onreadystatechange = function() {
                if( xhr.readyState === 4 && xhr.status === 200 ) {
                    while(results.hasChildNodes()) {
                        results.removeChild(results.lastChild);
                    }
                    results.appendChild(document.createTextNode(xhr.responseText));
                }
            }
            xhr.send();
    } 
```

在我们调用的 PHP 文件中，我们有以下代码：

```
<?php

    $clicks = file_get_contents("clicks.txt");
    $clicks++;

    $fp = fopen("clicks.txt", "w+");

    while ( !flock($fp, LOCK_EX) ) {    
        usleep(500000); // Delay half a second
    }

    fwrite($fp, $clicks);
    fclose($fp);
    flock($fp, LOCK_UN);

?> 
```

你能帮我找出我的代码中的问题吗？
我将如何阅读另一个 HTML 页面中的文本文件？
（只显示文本文件的信息。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:19:18.430

假设`PHP`页面运行正常，以下应该可以工作：

```
<html>
    <head>
        <title>Example</title>
    </head>
    <body>
        <script type="text/javascript">

function getXMLHttp()
{
  var xmlHttp
  try
  {
    xmlHttp = new XMLHttpRequest();
  }
  catch(e)
  {
    try
    {
      xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");
    }
    catch(e)
    {
      try
      {
        xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
      }
      catch(e)
      {
        alert("AJAX not supported.")
        return false;
      }
    }
  }
  return xmlHttp;
}

function MakeRequest()
{
  var xmlHttp = getXMLHttp();
  xmlHttp.onreadystatechange = function()
  {
    if(xmlHttp.readyState == 4)
    {
      HandleResponse(xmlHttp.responseText);
    }
  }
  xmlHttp.open("GET", "count.php", true); 
  xmlHttp.send(null);
}

function HandleResponse(response)
{
  document.getElementById('ResponseDiv').innerHTML = response;
}
        </script>
        <input type='button' onclick='MakeRequest();' value='Button'/>
        <br />
        <br />
        <div id='ResponseDiv'>
            Count
        </div>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T17:47:08.183

在 php 方面需要注意一些事项。

1) You're opening the file with w+ which is for writing and reading what you've wrote. This also truncates your file BEFORE your lock is in place.

2) Your lock will cause parallel read and writes to fail. This can set $clicks to false and possibly wipe out your counter if the file is unlocked before fopen gets called.

3) You are not correctly releasing your lock because you close the handle while the lock is active. If this happens to be a long running script the lock will not be released until the script terminates.

This should solve all of those problems.

```
<?php

$fp = false;
// Open file for reading, then writing
while ( ($fp=fopen('clicks.txt','r+'))===false ) {
    usleep(250000); // Delay 1/4 second
}
// Obtain lock
while ( !flock($fp, LOCK_EX) ) {    
    usleep(250000); // Delay 1/4 second
}
// Read Clicks
$clicks = trim(fread($fp,1024));
// Add click
$clicks++;
// Empty file
ftruncate($fp,0);
// Write clicks
fwrite($fp, $clicks);
// Release Lock
flock($fp, LOCK_UN);
// Release handle
fclose($fp);

?> 
```

# joomla - 如何设置 Joomla！默认指向 index.php？

> ID：11160782
> 
> 赞同：0
> 
> 时间：2012-06-22T16:57:17.633
> 
> 标签：joomla, content-management-system, joomla2.5

我在 joomla 中有这个问题，输入 mydomain.com 不会拉网站，我必须指定 mydomain.com/index.php 我一定做了一些愚蠢的事情，有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:59:56.240

看起来您已经调整了服务器设置（apache？），如果没有指定，服务器默认使用 index.html。Joomla 在大多数文件夹中使用空 index.html 文件以确保安全，因此您需要将服务器默认设置为 index.php。

如果您使用的*是*Apache，请检查配置（httpd.conf？），并将其更改为如下内容：

```
DirectoryIndex index.php index.html index.htm default.htm 
```

我突然想到您可能无法更改您的 apache 配置，因此您可以通过 htaccess 进行更改：创建一个名为 .htaccess 的文本文件，其中包含同一行，并将其放入您的 Joomla 主目录。如果您已经有一个 .htaccess 文件，请务必将此命令添加到文件末尾。

# java - Java SE - 自定义按钮（Jcomponent）和ActionListener？

> ID：11160785
> 
> 赞同：1
> 
> 时间：2012-06-22T16:57:21.757
> 
> 标签：java, swing, actionlistener, jcomponent

我实现了类 MyButton，它扩展了类 Jcomponent。问题是，我在主类中有一些 MyButton 对象（实现 ActionListener），我想向它们添加动作监听器。

如何处理？所以我可以使用 addActionListener 吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:05:40.863

*   在不实现/继承或方法的情况下使用[MouseListener](http://docs.oracle.com/javase/tutorial/uiswing/events/mouselistener.html) / [KeyBindings](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)`MyButton objects``JButton``AbstractButton`

*   如果实现`JButton`或`AbstractButton`然后你可以使用

    一个）`ButtonModel`

    b)`Swing Action`

    C）`ActionListener`

*   尽快发布[SSCCE以获得更好的帮助](http://sscce.org/)

# c# - 传递到字典中的模型项的类型为“ ”，但此字典需要类型为“System.Collections.Generic.IEnumerable?”的模型项

> ID：11160786
> 
> 赞同：0
> 
> 时间：2012-06-22T16:57:22.007
> 
> 标签：c#, asp.net, asp.net-mvc

执行应用程序后，我得到**“传递到字典中的模型项的类型为‘ClubStarterKit.Web.ViewData.Forum.NewMessageListViewData’，但此字典需要‘System.Collections.Generic.IEnumerable`1 类型的模型项[ ClubStarterKit.Web.ViewData.Forum.NewMessageListViewData]'。**

鉴于我有以下代码

 **```
 <%if ( User.Identity.IsAuthenticated) { %>

        <div class="fullwidth" id="message-add-block">
          <%using (Ajax.AsyncForm(Website.Shared.Views.DisplayTemplates.NewForumMessageList, new AsyncFormOptions(AsyncFormType.TargetUpdate, FormMethod.Post, "newMessages", targetUpdate: "messages", elementBlockId: "message-add-block", postRequestFunction: "afterMessageUpdate")))
          {%>
                <h3>Add New Message Final Test</h3>
                <br />
                <%: Html.Wysiwyg("message") %>
                <br />
               <%-- <input type="hidden" value="<%: Model.ThreadSlug %>" name="thread" />--%>
                <input type="hidden" value="-1" name="messageId" />
                <input type="submit" value="Add Message4 final" />
          <%}%>

          <br />
          <a id="newmessage" href="#">New message4 final</a>
        </div>

          <%}%> 
```

在控制器中，代码是

```
 public virtual ActionResult Index()
    {
        ViewData.Title("New Message");
        return View(Views.List, new ClubStarterKit.Web.Infrastructure.Forum.NewMessageListAction().Execute());
    } 
```

在下面的屏幕截图中是：

![错误](../Images/cb8b3b71fe76ab697f0270f497dd8642.png)

传入字典的模型项的类型为“Myapplication.Web.ViewData.application.NewMessageListViewData”，但此字典需要类型为“System.Collections.Generic.IEnumerable”的模型项

请告知哪个代码区域是问题所在

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:13:02.443

您正在向视图传递单个 NewMessageListViewData，但它已被强类型化为仅接受实现`IEnumerable<T>`T 为 NewMessageListViewData 的对象。例如， a`List<NewMessageListViewData>`会起作用。

正如评论中提到的，我将首先查看 ClubStarterKit.Web.Infrastructure.Forum.NewMessageListAction.Execute() 的返回类型，或者，如果您只打算在此视图中显示 NewMessageListViewData 的单个实例，则需要在视图中设置模型以反映这一点。**

# svn - Ant/Subversion 钩子：如何设置 ${user.dir}？

> ID：11160787
> 
> 赞同：2
> 
> 时间：2012-06-22T16:57:24.050
> 
> 标签：svn, ant, svn-hooks

我的公司正在从 Visual Source Safe 过渡到 Subversion；我们的管道管理工具依赖于 VSS 提供的“影子文件夹”的存在，以便将代码从版本控制移动到各种测试环境。注意：我们使用一种解释性语言并将我们的源代码翻译成目标代码——目前，源代码和目标代码都处于版本控制之下（特别是为了满足管道管理机制的需要）。

作为一个迭代步骤，我试图用一点天赋来模仿影子文件夹功能，因为我希望在提交时开始翻译，这样我们就不需要在 Subversion 中存储源代码和目标代码。注意：我不得不破解这个过程，从执行所有内容的干净“构建”到只在提交期间翻译受影响的文件，因为否则它需要太长时间才能成为实时提交操作（将来我希望我们会放弃这个过程有利于一些不太互动的东西，例如每小时构建或诸如此类的东西）。

所有这些背景故事只是为了问一个问题：${user.dir} 属性是如何设置的？

这是我的提交后挂钩批处理文件（一切都在 Windows 上完成）：

```
SET REPO=%1
SET REV=%2

FOR %%* IN (%REPO%) DO SET REPONAME=%%~n*

SET BUILDROOT=E:\builds
IF NOT EXIST %BUILDROOT% ( MKDIR %BUILDROOT% )
SET BUILDDIR=%BUILDROOT%\%REPONAME%
IF NOT EXIST %BUILDDIR% ( MKDIR %BUILDDIR% )
CD %BUILDDIR%

ECHO %CD%
ECHO %BUILDDIR%

C:\apache-ant-1.8.3\bin\ant -f C:\dev\shadow\build.xml -DWorkingDir=%BUILDDIR%\!build_work_dir -DSvnRepoUrl=file:///%REPO% -DFromRevision=%REV% > %BUILDDIR%\!last_build_result.txt 2>&1 
```

最后一行是实际的 Ant 调用；您可以看到我正在将输出重定向到一个文件，该文件位于 %BUILDDIR% 或 E:\builds\ 中。该文件按预期创建，这表明 %BUILDDIR% 已正确设置，因此：

```
CD %BUILDDIR% 
```

行应该已经执行。我知道 SVN 使用[空环境](http://svnbook.red-bean.com/en/1.1/ch05s02.html)启动提交后挂钩，但我希望更改其中的目录应该在启动 Ant 后保留状态。

后来，在我的 Ant 脚本中，我设置了我的 ${build.dir} 属性：

```
<property name="build.dir" value="${user.dir}\.build.${build.time}" />
<!-- delete the build.dir, just in case we attempt a new build within the same minute...
     TODO: we may need to account for concurrent builds; does SVN single-thread commits? -->
<delete dir="${build.dir}" />
<mkdir dir="${build.dir}" /> 
```

如果 %REPONAME%（在批处理文件中）是 DEMO，我预计当前工作目录是：E:\builds\DEMO，因此 ${build.dir} 应该类似于：E:\builds\DEMO.build。 20120622.1127，但它是：C:\dev\shadow.build.20120622.1127，而不是。

据我了解，Ant 只是从 Java 中提取[System.Properties](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/System.html#getProperties%28%29)来获取 ${user.dir} 之类的东西—— ${user.dir} 被描述为*User's current working directory*。显然，根据我的实验，批处理文件中的初始设置和关于工作目录的 Java 调用之间存在交叉。

Ant 是否将工作目录更改为构建文件的位置？我没有找到任何文件表明它确实如此，但我可能只是忽略了一些东西。我已经定义了 %ANT_HOME%，但是考虑到 Subversion 的“空环境”，它不会被加载......也许这有效果？我需要进行调查，但希望有人可能会简单地*知道*这是如何工作的。

编辑（2012-06-22-16:38）：

我尝试设置 %ANT_HOME%、%JAVA_HOME% 和 %JAVA_CMD%，但无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T20:45:53.903

当您在执行各种钩子的服务器上执行提交时，没有工作目录。这使得不可能通过钩子做你想做的事。

我建议你看看[Jenkins](http://jenkins-ci.org)。Jenkins 是一个持续集成服务器，可以在每次提交后运行您的 Ant 脚本。Jenkins 执行工作目录所需的检查和更新，并且可以在每次提交后执行此操作。因为 Jenkins 有一个工作目录，所以它可以毫无问题地运行你的 ant 程序。

另外，由于 Jenkins 是在提交完成后执行的，因此您的提交不会等待，这给了您的开发人员足够的时间来建立对您的仇恨。例如，如果您的钩子脚本执行需要 20 秒，则开发人员必须等待整整 20 秒才能继续。

Jenkins 还允许您将构建的对象存储在 Jenkins 中，因此它们不必存储在您的 Subversion 存储库中。这意味着很容易找到正确的版本，因为它在 Jenkins 中很容易找到。它可以防止您的 Subversion 存储库增长过快。

因此，请查看 Jenkins 作为您想要做的事情的解决方案。

# php - 使用 openssl 命令行工具解密数据

> ID：11160788
> 
> 赞同：2
> 
> 时间：2012-06-22T16:57:27.083
> 
> 标签：php, openssl, mcrypt, rijndael

我必须遵循代码，据我所知它是正确的，但它不起作用。我正在尝试使用 PHP 的 Mcrpyt 对数据进行编码，然后使用 openssl 命令行工具对其进行解码。

这是我的 PHP 代码：

```
/*
 * Convert a normal ascii string to a hexadecimal string.
 * Complement of hexToString().
*/
function stringToHex($str)
{
    $hex_str = "";
    for ($i = 0; $i < strlen($str); ++$i)
    {
        $hex_str .= sprintf("%02X", ord($str[$i]));
    }

    return $hex_str;
}

    $iv = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), MCRYPT_DEV_RANDOM);

    $block_size = mcrypt_get_block_size("rijndael-128", "cbc");
    $pad = $block_size - (strlen($data) % $block_size);
    $data .= str_repeat(chr($pad), $pad);

    $encrypted = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, "1234567812345678", $data, MCRYPT_MODE_CBC, $iv);

    $message = stringToHex($iv) . base64_encode($encrypted); 
```

我将 IV 附加到编码的消息中。例如，IV 是 00000000000000000000000000000000（大小为 32），然后我使用以下命令进行解密：

```
openssl enc -d -aes-128-cbc -A -nosalt -K 31323334353637383132333435363738 -iv 00000000000000000000000000000000 -in file_in > file_out 
```

另请注意，1234567812345678 是十六进制是 31323334353637383132333435363738。但我不断收到相同的错误消息：

> 错误解密 1340：错误：0606506D：数字信封例程：EVP_DecryptFinal_ex：错误的最终块长度：./crypto/evp/evp_enc.c:454：

任何人？

在此先感谢，所有的爱，乔里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-24T08:45:57.300

好吧，我测试了您的代码，并进行了一些更改。

1）openssl的输入应该只包括密文，而不是前置IV（因为你的代码不完整，我不确定你是否确实在用openssl处理之前从密文中剥离了IV）。

2) 您的 openssl 命令缺少实际执行 Base64 解码所需的参数 (-a)（仅使用 -A 不会启用此功能）。同样，由于您的描述不完整，我不确定您是否确实在将消息存储到 file_in 之前对其进行了 Base64 解码。

为了完整起见，这是我用来测试您的代码的代码（我从命令行运行它，而不是使用 Web 服务器）。

```
<?php

$data = "
This is a test. This is only a test.
Stack Overflow is collaboratively built and maintained
by your fellow programmers.
";
$keybin = "1234567812345678";

//$iv = mcrypt_create_iv (mcrypt_get_iv_size (MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), MCRYPT_DEV_RANDOM);
$iv = mcrypt_create_iv (mcrypt_get_iv_size (MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC), MCRYPT_RAND);
$block_size = mcrypt_get_block_size ("rijndael-128", "cbc");
$pad = $block_size - (strlen ($data) % $block_size);
$data .= str_repeat (chr ($pad), $pad);
$encrypted = mcrypt_encrypt (MCRYPT_RIJNDAEL_128, $keybin, $data, MCRYPT_MODE_CBC, $iv);
$message = base64_encode ($encrypted);

echo "CIPHERTEXT=  " . $message . "\n";
echo "IV=  " . bin2hex ($iv) . "\n";
echo "KEY=  " . bin2hex ($keybin) . "\n";

echo "\nTest with:\n\necho $message | openssl enc -d -aes-128-cbc -nosalt -a -A -K " . bin2hex ($keybin) . " -iv " . bin2hex ($iv) . "\n\n";

?> 
```

其他细微差别是我使用了 PHP 的 bin2hex。

它将产生如下输出：

```
CIPHERTEXT=  /e81Ua/0jxgff3j5GjKXaNilv5WqPYV7yRYy4AzsTUmGQeK0hcMjuUYp1Yrfthaox9zTI0DeDQT4fba+y/qTQahZpYRAKcZa209RVg4W1HrySfZPMRCxE+y8r8scL3Xmj+oMGFpS+cDo111OPqwHhNwWSHbMlsoJLvMr70ZiQmE=
IV=  56c7c7248c68127cee8f0e54d89b4fc1
KEY=  31323334353637383132333435363738

Test with:

echo /e81Ua/0jxgff3j5GjKXaNilv5WqPYV7yRYy4AzsTUmGQeK0hcMjuUYp1Yrfthaox9zTI0DeDQT4fba+y/qTQahZpYRAKcZa209RVg4W1HrySfZPMRCxE+y8r8scL3Xmj+oMGFpS+cDo111OPqwHhNwWSHbMlsoJLvMr70ZiQmE= | openssl enc -d -aes-128-cbc -nosalt -a -A -K 31323334353637383132333435363738 -iv 56c7c7248c68127cee8f0e54d89b4fc1 
```

您遇到的错误（错误的解密、数字信封例程 EVP_DecryptFinal_ex）通常意味着错误的密钥或损坏的密文。我认为在您的示例中，问题是由前置 IV 和/或缺少 Base64 解码引起的损坏的密文。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-24T08:47:57.053

[`openssl enc`](http://www.openssl.org/docs/apps/enc.html)使用您实现的 PKCS#5 填充，如果数据是块大小的倍数，则强制填充块除外。由于您使用 16 个字节（即块大小）进行测试，因此您需要添加另外 16 个字节，其中包含`chr(16)`.

# android - 具有多个 ListFragment 的 Android SherlockFragmentActivity

> ID：11160794
> 
> 赞同：0
> 
> 时间：2012-06-22T16:57:51.177
> 
> 标签：android, android-fragments, actionbarsherlock, simplecursoradapter, android-loadermanager

我有一个显示几个选项卡的 SherlockFragmentActivity。每个选项卡都是 ListFragment。

每个 ListFragment 都是这样创建的：

```
ActionBar bar = getSupportActionBar();
bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
bar.setDisplayOptions(0, ActionBar.DISPLAY_SHOW_TITLE);
bar.setDisplayHomeAsUpEnabled(true);
bar.setDisplayShowTitleEnabled(true);

// users event list
bar.addTab(bar.newTab()
    .setTag("contacts_list")
    .setText(getString(R.string.list_contacts_header))
    .setTabListener(new TabListener<ContactListFragment>(
        this, getString(R.string.list_events_header), ContactListFragment.class, null))); 
```

然后，每个 ListFragments 都像这样加载：

```
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

    // database cursor containing all venues for this event
    venuesCursor = getDatasource().getAllVenues(((EventActivity) getActivity()).getEventId());

    // hand the cursor to the system to manage
    getActivity().startManagingCursor(venuesCursor);  

    // bind the columns of the cursor to the list
    String[] from = new String[] { VenuesDataSource.KEY_NAME, VenuesDataSource.KEY_DESCRIPTION };
    int[] to = new int[] { R.id.list_item_title, R.id.list_item_subtitle };

    cursorAdapter = new SimpleCursorAdapter(getActivity(), R.layout.list_item, venuesCursor, from, to);

    // retrieve the listview to populate
    ListView lv = (ListView) getActivity().findViewById(android.R.id.list);

    // set the adapter on the listview
    lv.setAdapter(cursorAdapter);

    // click event for each row of the list
    lv.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> arg0, View view,
                int position, long id) {
            Cursor cursor = cursorAdapter.getCursor();
            cursor.moveToPosition(position);
            Toast.makeText(getActivity(), "Tapped row " + position + "!", Toast.LENGTH_SHORT).show();

        }
    });

    // Start out with a progress indicator.
    setListShown(false);

    // prepare the loader -- either re-connect with an existing one, or start a new one.
    // getLoaderManager().initLoader(0, null, this);

    // load the data
    getActivity().getSupportLoaderManager().initLoader(0, null, this);
} 
```

就像我说的，这个活动有多个以 ListFragments 形式存在的选项卡。我遇到的问题是，当单击选项卡以选择它们时，我得到

```
E/AndroidRuntime(2519): java.lang.IllegalArgumentException: column 'name' does not exist 
```

这是错误的，我用 adb 来查看数据库，它抱怨的列是 100% 在那里，所以它必须与不关闭游标或其他东西有关，并且当上面加载它时实际使用错误光标。

**编辑：添加 CursorLoader 代码**

```
public static final class VenueCursorLoader extends SimpleCursorLoader {

    Context mContext;

    public VenueCursorLoader(Context context) {
        super(context);

        mContext = context;
    }

    @Override
    public Cursor loadInBackground() {
        Cursor cursor = null;
        VenuesDataSource datasource = new VenuesDataSource(mContext);

        // TODO: provide the event_id to the getAllVenues method
        cursor = datasource.getAllVenues(((EventActivity) mContext).getEventId());

        if (cursor != null) {
            cursor.getCount();
        }

        return cursor;
    }

} 
```

非常感谢任何帮助..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:30:22.660

## [这个问题基本上在这里得到了回答](https://stackoverflow.com/a/11158889/844882)

基本上，您需要了解的所有内容都在答案中列出。您应该进行几个修复：

* * *

*   您应该先传递`CursorAdapter`一个`null`光标。`LoaderManager`将为`CursorLoader`您执行初始查询。（见我上面的回答）。另请注意，您当前使用的构造函数已[弃用](http://tinyurl.com/77j7lej)。您应该改用[这个](http://tinyurl.com/6rynm69)（将其`0`作为标志传递）。

    cursorAdapter = new SimpleCursorAdapter(getActivity(), R.layout.list_item, null, from, to, 0);

* * *

*   删除这一行：

    ```
    getActivity().startManagingCursor(venuesCursor); 
    ```

    的全部意义`LoaderManager`在于它为您管理光标。您不需要“将光标交给系统进行管理”……这*正是*`LoaderManager`. :)

* * *

*   由于我在 #1 和 #2 中描述的原因，这行代码看起来是不必要的：

    ```
    venuesCursor = getDatasource().getAllVenues(
            ((EventActivity) getActivity()).getEventId()); 
    ```

* * *

*   我也不确定你为什么要压倒一切`onItemClick`。由于您使用的是`ListFragment`s，因此我怀疑您想要覆盖`onListItemClick`。

* * *

*   我不确定您为什么包含这些行，但看起来您也想删除它们。

    ```
    Cursor cursor = cursorAdapter.getCursor();
    cursor.moveToPosition(position); 
    ```

    在大多数情况下，您不应操纵适配器的光标，因为它由内部系统管理并绑定到`LoaderManager`.

# ios - 当视图缩小时，drawRect总是想更新整个屏幕

> ID：11160796
> 
> 赞同：3
> 
> 时间：2012-06-22T16:58:00.383
> 
> 标签：ios, uiscrollview, drawrect, cgcontextdrawimage

我有一个显示在由 UIScrollView 控制的 UIView 中的 CGImage。图像通常是 1680*1050 的 24 位颜色，没有 Alpha 通道。

图像是这样创建的：

```
CGImageRef bitmapClass::CreateBitmap(int width, int height, int imageSize, int colorDepth, int bytesPerRow)
{
   unsigned char* m_pvBits = malloc(imageSize);

   // Initializt bitmap buffer to black (red, green, blue)
   memset(m_pvBits, 0, imageSize);

   m_DataProviderRef = 
      CGDataProviderCreateWithData(NULL, m_pvBits, imageSize, NULL); 

   m_ColorSpaceRef = 
      CGColorSpaceCreateDeviceRGB();   

   return
      CGImageCreate(width, height, 
                    8, //kBitsPerComponent 
                    colorDepth, 
                    bytesPerRow, 
                    m_ColorSpaceRef, 
                    kCGBitmapByteOrderDefault | kCGImageAlphaNone, 
                    m_DataProviderRef, 
                    NULL, false, kCGRenderingIntentDefault);
} 
```

图像内容通过更改 m_pvBits 中的像素在后台定期更新，并使用以下方法在 UIView 中更新：

```
[myView setNeedsDisplayInRect:rect]; 
```

这会调用 drawRect 来显示图像，如下所示：

```
- (void)drawRect:(CGRect)rect
{
   CGRect imageRect;
   imageRect.origin = CGPointMake(0.0, 0.0);
   imageRect.size = CGSizeMake(self.imageWidth, self.imageHeight);

   CGContextRef context = UIGraphicsGetCurrentContext();

   CGContextSetInterpolationQuality(context, kCGInterpolationNone);

   // Drawing code
   CGContextDrawImage(context, imageRect, (CGImageRef)pWindow->GetImageRef());
} 
```

只要视图没有缩小（缩小），这种方法就可以很好地工作。我知道'rect'实际上并没有直接在drawRect中使用，但'context'似乎知道CGContextDrawImage应该更新屏幕的哪个部分。

我的问题是，即使我只使用 setNeedsDisplayInRect 使屏幕的一小部分区域无效，但当视图缩小时，整个屏幕都会调用 drawRect。因此，如果我的图像是 1680*1050 并且我使一个小矩形 (x,y,w,h)=(512, 640, 32, 32) 无效，则使用 (x,y,w,h)=(0 , 0, 1680, 1050)。

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T07:33:14.673

Apple 提供了一个有趣的示例代码项目，可能会对您有所帮助。它被称为[大图像缩小](http://developer.apple.com/library/ios/#samplecode/LargeImageDownsizing/Introduction/Intro.html#//apple_ref/doc/uid/DTS40011173)。它做了很多事情，但真正有趣的部分是`TiledImageView.m`. 在其中，视图的图层类设置为`CATiledLayer`：

```
+ (Cl ass)layerClass {
    return [CATiledLayer class];
} 
```

tiledLayer 属性正在`init`方法中设置：

```
// Create a new TiledImageView with the desired frame and scale.
-(id)initWithFrame:(CGRect)_frame image:(UIImage*)_image scale:(CGFloat)_scale {
    if ((self = [super initWithFrame:_frame])) {
        self.image = _image;
        imageRect = CGRectMake(0.0f, 0.0f, CGImageGetWidth(image.CGImage), CGImageGetHeight(image.CGImage));
        imageScale = _scale;
        CATiledLayer *tiledLayer = (CATiledLayer *)[self layer];
        // levelsOfDetail and levelsOfDetailBias determine how
        // the layer is rendered at different zoom levels.  This
        // only matters while the view is zooming, since once the 
        // the view is done zooming a new TiledImageView is created
        // at the correct size and scale.
        tiledLayer.levelsOfDetail = 4;
        tiledLayer.levelsOfDetailBias = 4;
        tiledLayer.tileSize = CGSizeMake(512.0, 512.0); 
    }
    return self;
} 
```

最后，这是真正有趣的部分，这是`drawRect:`实现（NSLog 来自我）：

```
-(void)drawRect:(CGRect)_rect {
    CGContextRef context = UIGraphicsGetCurrentContext();    
    CGContextSaveGState(context);
    // Scale the context so that the image is rendered 
    // at the correct size for the zoom level.
    CGContextScaleCTM(context, imageScale,imageScale);  
    NSLog(@"rect: %@, imageScale: %.4f, clip: %@", NSStringFromCGRect(_rect), imageScale, NSStringFromCGRect(CGContextGetClipBoundingBox(context)));
    CGContextDrawImage(context, imageRect, image.CGImage);
    CGContextRestoreGState(context);    
} 
```

`drawRect:`为每个 512x512 瓦片调用。`_rect`但是，在方法内部根本不使用传入的值。不必这样做，因为当前上下文的剪切路径设置为正确的区域（正如您将在 的输出中看到的那样`CGContextGetClipBoundingBox`）。所以就像 Rob 说的，`CGContextDrawImage`可以使用并且只绘制大图像的请求“平铺”，尽管看起来好像整个图像一次又一次地绘制。如果您不使用`CATiledLayer`，则确实会一次又一次地绘制整个图像，这会减慢一切。但是当您使用 时`CATiledLayer`，只会绘制当前需要的“图块”，这会使其速度更快。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-24T21:52:14.593

谢谢你的回答。

据我观察，传递给 drawRect 的 rect 参数的内容与我查询 CGContextGetClipBoundingBox() 时得到的内容相同。

你建议我应该将我的绘图优化到剪裁范围 - 但我在这里没有做任何计算。我只是在调用 CGContextDrawImage()。我可以看到其他程序员抱怨 CGContextDrawImage 的性能不佳，而且它显然从 iPhone 3 到 iPhone 4 变慢了。我当然希望性能更好，但现在最大的问题是 iOS 更新整个图像，即使只有一小部分无效（使用 setNeedsDisplay）。

缩小是指我可以看到更多图像，但图像缩小了。我不会经常放大和缩小，但图像的一小部分会定期更新并调用 setNeedsDisplay。当我缩放或平移时，它非常缓慢且突然，因为整个屏幕由 iOS 设置为更新。

没错，CGContextDrawImage 优化了实际绘制的内容 - 我可以通过测量操作所花费的时间来看到这一点。

如您所见，我使用 malloc 分配图像位。是否有另一种方法可以分配更适合图形处理器的图像位？

CGImageCreate 是否有更优化的 ColorRef 模式或其他标志？

# objective-c - 带有文本字段和 NSPopUpButtonCell 标题的基本 IBAction 函数问题

> ID：11160799
> 
> 赞同：0
> 
> 时间：2012-06-22T16:58:12.470
> 
> 标签：objective-c, nspopupbutton

我只是在了解目标 c 的基础知识。我想创建一个文本字段，其字符串与我选择的 Dropbox 单元格的标题相同。我有：

```
- (IBAction)dropbox:(id)sender{
NSPopUpButtonCell *sampleCell = [sender selectedCell];
[self setWord:@"%@",sampleCell.title]; 

[sampleCell release];
} 
```

word 被声明为

```
@property (readwrite, nonatomic, retain) IBOutlet NSTextField *word;
@synthesize word = _word; 
```

显然我在使用 [self setWord:] 时不允许使用占位符参数。你能为我指出正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:06:20.783

首先，您没有获得所有权，`sampleCell`因此您不应该发布它。这将触发异常。此外，您将 NSTextField 设置为字符串。

这就是我要做的：

```
- (IBAction)dropbox:(id)sender{
NSPopUpButtonCell *sampleCell = [sender selectedCell];
[self.word setTextValue:sampleCell.title]; 
} 
```

# openstreetmap - 使用 osmosis 将 MapsForge 的 .osm 转换为 .map 文件格式时出错

> ID：11160801
> 
> 赞同：2
> 
> 时间：2012-06-22T16:58:33.870
> 
> 标签：openstreetmap

我想将从 geofabrik.de 下载的 .osm 文件转换为 .map 以在 MapsForge 中使用。我已经安装了 osmosis 及其 MapsForge 插件。当我想将 osm 文件转换为映射文件时，出现此错误/异常：

```
crosby.binary.file.FileFormatException: Unexpectedly long header 65536 bytes. Possibly corrupt file.
    at crosby.binary.file.FileBlockHead.readHead(FileBlockHead.java:50)
    at crosby.binary.file.FileBlock.process(FileBlock.java:130)
    at crosby.binary.file.BlockInputStream.process(BlockInputStream.java:34)
    at crosby.binary.osmosis.OsmosisReader.run(OsmosisReader.java:37)
    at java.lang.Thread.run(Unknown Source) 
```

我使用的命令行是：

```
osmosis --rb file=kyrgyzstan.osm --mapfile-writer file=kyrgyzstan.map type=hd 
```

任何的想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T08:29:34.457

您正在调用`--read-binary`( `--rb`) 任务来读取显然是 OSM XML 文件（.osm 扩展名）的内容。要读取 OSM XML 文件，请使用[`--read-xml`](http://wiki.openstreetmap.org/wiki/Osmosis/Detailed_Usage#--read-xml_.28--rx.29)( `--rx`) 任务。

# java - Java JDBC 连接 ClassNotFoundException 错误

> ID：11160803
> 
> 赞同：2
> 
> 时间：2012-06-22T16:58:41.967
> 
> 标签：java

我是 java 初学者，在连接 JDBC 连接时遇到问题，`java.lang.ClassNotFoundException: oracle.jdbc.OracleDriver`运行代码时出现“”错误。这是我的源代码

* * *

```
 import java.sql.*;
    public class Connect 
    {
        public static void main(String[] args) 
        {
            try
            {
                Class.forName("oracle.jdbc.OracleDriver");
                System.out.println("Drivers Loaded");
                Connection con = DriverManager.getConnection("jdbc:oracle:thin:SYSTEM/rambabu@localhost:8081:XE");
                System.out.println("Connection established");
                con.close();
            }
            catch(Exception e)
                {
                    System.out.println(e);
                }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:00:36.853

您将需要在类路径中使用 Oracle JDBC 驱动程序。

如果没有，可以从[http://www.oracle.com/technetwork/database/features/jdbc/index-091264.html下载](http://www.oracle.com/technetwork/database/features/jdbc/index-091264.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T17:00:28.507

您只需要将 Oracle 驱动程序 jar 文件放在您的类路径中。例如：

```
java -cp oracle.jar Connect 
```

（我不知道jar文件叫什么，但想必你有一个......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T17:02:03.667

试试这个方法......

```
public class DataBaseClass {

    Connection conn;

    public void receivedConnection() {

        try {
            conn = getConnection();
            System.out.println("I GOT THE CONNECTION");

        } catch (SQLException e) {

            System.out.println("I DID NOT GET THE CONNECTION");
            e.printStackTrace();
        }

        try {

            Statement stat = conn.createStatement();
            stat.executeUpdate("DROP TABLE VIVEK_DA_TABLE");
        } catch (SQLException e) {
            System.out.println("Table didnt exist");
            //e.printStackTrace();
        }

    }

    public static Connection getConnection() throws SQLException{

        String drivers = "com.mysql.jdbc.Driver";
        String url    = "jdbc:mysql://localhost:3306/test";
        String username = "root";
        String password = "vicky";

        System.setProperty(drivers,"");
        return DriverManager.getConnection(url,username,password);

    }

    public static void main(String[] args) throws SQLException{

        DataBaseClass db = new DataBaseClass();
        db.receivedConnection();
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T17:02:26.420

可能是包含 jdbc 驱动程序的 .jar 文件不在“引用的库”中。如果您在 Eclipse 中进行开发，您只需右键单击项目 > 构建路径 > 配置构建路径 > 库选项卡 > 添加外部 jars > 找到并添加您的 jdbc 驱动程序版本。

希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-22T17:05:19.500

我认为你必须设置`oracle
[的类路径设置类路径](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/classpath.html)
或简单地调用..
**in unix**

```
java -cp .:oracle.jar Connect 
```

**在窗户里**

```
java -cp .;oracle.jar Connect 
```

冒号/分号分隔两条路径。这 。是您所在的目录（希望是类或基础包），后一个 jar 是驱动程序

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T18:02:14.230

在项目菜单中，右键单击库文件夹，选择添加 jar/文件夹，然后选择 ojdbc jar，它将被添加到项目库中，您应该可以使用驱动程序了。

尝试以下简单的方法来测试连接

```
Connection conn = null;
try{
  DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());
  conn = DriverManager.getConnection("dburl","username", "password");
  if(conn != null){
    System.out.println("Connection to Phoenix unsuccessful");
  }else{
    System.out.println("Connection to Phoenix successful");
  }

}catch(SQLException e){
  System.out.println("Exception creating DB connection: " + e);
  for(StackTraceElement ste : e.getStackTrace())
    System.out.println(ste.toString());
} 
```

# arrays - 在文件中搜索任何匹配项并为结果分配一个编号，您可以将其作为选项调用

> ID：11160804
> 
> 赞同：0
> 
> 时间：2012-06-22T16:58:43.230
> 
> 标签：arrays, perl, indexing

我想像下面这样运行它

```
$ perl test.pl tex
```

```
结果：
1\. 德克萨斯州
2\. 休斯敦，德克萨斯州
3\. DFW 德克萨斯州

选项？2
远程登录：德克萨斯州休斯顿
```

我基本上是想搜索一个数组，并为其分配一个数值，然后每次调用它而不是完整的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T20:17:54.977

这是一件比看起来更简单的事情。

```
use strict;
use warnings;

@ARGV == 1 or die "Usage: perl test.pl <location>\n";

my $place = quotemeta shift;

open my $fh, '<', 'telnets.txt' or die $!;
my @telnets = grep /$place/i, <$fh>;
die "No matching telnets\n" unless @telnets;
chomp @telnets;

print "RESULTS:\n";
printf "%d . %s\n", $_ + 1, $telnets[$_] for 0 .. $#telnets;
print "\n";

print "Option? ";

my $option = <STDIN>;
$option =~ s/\s+//g;

die "Invalid selection $option\n" unless $option > 0 and $telnets[$option-1];

print "Telneting to: $telnets[$option-1]\n"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T18:00:48.643

让文件*places.txt*包含

```
Texas
Houston Texas
DFW Texas 
```

然后，以下 Perl 脚本会执行您想要的操作。脚本中的注释解释。

```
#!/usr/bin/perl

use warnings;
use strict;
use integer;

our $filename_place = 'places.txt';
our $index_field_width = 2;

# Read in the place data.
my @place;
open PLACE, '<', $filename_place;
while (<PLACE>) {
    chomp;
    push @place, $_;
}
close PLACE;

# Print a menu.
for (my $i = 0; $i < @place; ++$i) {
    printf "%${index_field_width}d. %s\n", $i+1, $place[$i];
}

# Let the user choose.
print "\nOption? ";
my $option = <>;
chomp $option;
$option >= 1 && $option <= @place
  or die "$0: the option chosen is out of range\n";

# Act on the user's choice.  (Of course, you can put
# here whatever action you like but, as written, the
# following produces your sample output.)
print "Telneting to: ${place[$option-1]}\n\n"; 
```

# ios - Flickr API：新 iPad 的 Retina 图像

> ID：11160815
> 
> 赞同：3
> 
> 时间：2012-06-22T16:59:24.040
> 
> 标签：ios, image, retina-display, flickr

Flickr API 中可用的照片尺寸似乎已过时：Flickr[最近](http://blog.flickr.net/en/2012/05/03/introducing-two-new-photo-sizes-and-a-new-setting-for-pro-members/)为视网膜显示器引入了新的照片尺寸，但似乎无法从 API 中获取这些尺寸。然而，像 FlickStackr 这样的应用程序[似乎正在使用](http://news.softpedia.com/news/FlickStackr-for-Flickr-2-5-Supports-iPad-Retina-Resolutions-273841.shtml)这些新的图像尺寸。我目前正在为新 iPad 加载原始图像，这些图像并不总是可用并且加载和渲染速度很慢。如何使用这些新尺寸？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T18:39:31.687

我在最近的一张图片上尝试了 flickr.photos.getSizes，并收到了部分回复：

```
<size label="Large" width="1024" height="768" source="http://farm8.staticflickr.com/7224/7174681563_4fc5b7d952_b.jpg" url="http://www.flickr.com/photos/32054489@N00/7174681563/sizes/l/" media="photo" />
<size label="Large 1600" width="1600" height="1200" source="http://farm8.staticflickr.com/7224/7174681563_cbbb7ca273_h.jpg" url="http://www.flickr.com/photos/32054489@N00/7174681563/sizes/h/" media="photo" />
<size label="Large 2048" width="2048" height="1536" source="http://farm8.staticflickr.com/7224/7174681563_15742b18a2_k.jpg" url="http://www.flickr.com/photos/32054489@N00/7174681563/sizes/k/" media="photo" /> 
```

看起来新的后缀分解如下：

*   大，长边 1600：h
*   大，长边 2048：k

# internet-explorer - event.target.style.cursor 不起作用 IE

> ID：11160816
> 
> 赞同：0
> 
> 时间：2012-06-22T16:59:31.047
> 
> 标签：internet-explorer, raphael

我有这行代码：

```
event.target.style.cursor = "pointer"; 
```

它在 FF 和 Chrome 中运行良好，但在 IE7 中运行良好。我已经四处寻找适用于 IE 的语法，但我的结果是空的。

我应该提到我的 event.target 是一个经过 Raphaeljs 的 svg 形状。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T12:24:25.107

在较旧的 IE`event.target`中是`event.srcElement`. 在 IE9 中你也可以使用`target`. 在这种情况下，您需要使用`addEventListener()`方法分配事件处理程序，而不是使用例如`onclick=some_function;`

参见[MSDN](http://msdn.microsoft.com/en-us/library/ms536913%28v=vs.85%29.aspx)`event.srcElement`中的使用示例

# c# - 如何自定义 SSRS 列/行？

> ID：11160817
> 
> 赞同：0
> 
> 时间：2012-06-22T16:59:34.543
> 
> 标签：c#, asp.net, sql-server

我需要能够在我们的 SSRS 报告查看器中更改标题文本和间距问题。我们的版本不是最近的版本（不超过 2010 年）。但我能找到的唯一信息与代码无关：

[http://technet.microsoft.com/en-us/library/cc645971(v=SQL.100).aspx](http://technet.microsoft.com/en-us/library/cc645971(v=SQL.100).aspx)

我不知道他们是否希望我们在设计视图中编辑它或什么。但是有没有人知道如何或提供有关如何执行此操作的编码示例的来源？![在此处输入图像描述](../Images/e3b207bb12a29dbef24f51aa7e1c0a7e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:14:17.643

是的，您需要 VS 2005 或 2008 来执行此操作。您需要安装 BIDS 和 SSRS。

[http://www.petri.co.il/sql-reporting-services-create-edit-reports.htm](http://www.petri.co.il/sql-reporting-services-create-edit-reports.htm)

至于报告在哪里 - 试试你的源代码控制或询问某人......

您正在寻找与您的报告相对应的 .rdl 文件。

# facebook - 当用户在他的墙上写帖子时，我可以收到通知吗？

> ID：11160818
> 
> 赞同：0
> 
> 时间：2012-06-22T16:59:40.600
> 
> 标签：facebook, facebook-graph-api, facebook-comments

我是FB平台的新手。到目前为止，我使用 PHP 并设法获取用户数据并对一篇帖子发表评论。

当特定用户发表新帖子或评论时，我似乎找不到任何通知方式。

当用户在他的 Facebook 墙上写新帖子时，我希望触发一个事件。

显而易见的解决方案是每隔一分钟左右发出一次请求，并手动检查数据是否有新的变化。但我觉得这将是一种非常笨拙且带宽昂贵的做事方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:06:54.077

您可以通过将用户添加到列表中来获取任何用户的每个通知，在 facebook 中，列表是管理您的联系人（朋友）的一种方式，因此，假设您希望在 X 用户更新他时收到通知状态，当他上传照片/视频时，当他从单身转变为恋爱关系等（保持有关 X 用户/用户的更新）您只需将它们添加到您的“最好的朋友”智能列表中。一探究竟。

[https://blog.facebook.com/blog.php?post=10150278932602131](https://blog.facebook.com/blog.php?post=10150278932602131)

# html - 将页面 URL 添加到域

> ID：11160832
> 
> 赞同：1
> 
> 时间：2012-06-22T17:00:36.617
> 
> 标签：html, redirect, indexing, dns

问这个我感觉很糟糕，但我在网上找不到任何答案。基本上，我正在制作我的图形设计组合，并且我正在静态制作每个页面，就像 HTML 文档一样。我遇到了域问题。

我有一个主页`index.html`，所以域（`http://blieque.comli.com`）直接在那里，但是当涉及到另一个页面时，我被卡住了。我想去`domain.com/page`，没有`domain.com/page.html`。我知道为每个页面创建另一个目录/文件夹并调用它们都是可行的`index.html`，但这似乎是一种混乱的方法，我无法像通常那样制作页面。

网站不再是静态的了吗？所有帮助表示赞赏。:)

哦，而且`comli.com`是一个`000webhost.com`域。我很快就会得到自己的，但我想先让一切都完美。

-Blieque

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T18:17:48.847

您可以使用`.htaccess ReWriteRule`

```
RewriteEngine on
RewriteRule public$ public.html
RewriteRule about$ about.html 
```

等等，希望对你有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:08:13.997

是的，在服务器上为每个页面创建一个新目录，并将 index.html 扔到每个目录中。假设您没有太多页面，它不会像您想象的那么混乱..

我想不出任何其他方法..

# sencha-touch - Sencha Touch Charts - 按字段分组

> ID：11160834
> 
> 赞同：0
> 
> 时间：2012-06-22T17:00:38.180
> 
> 标签：sencha-touch, sencha-touch-2, sencha-charts

我在 tabPanel 中有一个来自商店的列表，该列表基于下面的模型。在第二个选项卡中，我想要一个饼图（使用 Sencha Charts 2.0 Beta 构建），其中包含我的**投票**字段的三个可能值的总数（值可以是“是”、“否”或“AB”，所以我期望是三个饼图部分）。

Store grouper 函数按列表的**名称**第一个字符对商店进行分组。

```
groupFn: function(record) {                
            return record.get('name')[0].toUpperCase();                        
        } 
```

我考虑过动态创建一个新的商店，但是数据的数量非常大（数据库中约 31k 行），所以如果我可以处理我已经拥有的商店，那就太好了。

模型 ：

```
{
  name : 'someName',
  vote : 'someVote',
  ID   : 'someID'
} 
```

希望我提供所有信息。

预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T12:25:37.460

好的更新，现在我有了每个投票结果的总数。我使用了以下代码：

```
var store = Ext.getCmp('myList').getStore();                            
store.findBy(function(rec) {
        if (rec.get('vote') === 'YES') {
              countYES++;
           } 
}); 
```

我现在正在尝试在我的饼图中使用这些数据。

# jquery - jQuery AJAX 无法填充 Internet Explorer 中的选择框

> ID：11160845
> 
> 赞同：1
> 
> 时间：2012-06-22T17:01:54.463
> 
> 标签：jquery, html, ajax

我有一些这样的代码：

```
var mySelect = document.getElementById("mySelect");
mySelect.innerHTML = "<option>Loading...</option>";
$.get("ajaxPage.php", {"args":args}, function(r) {
    mySelect.innerHTML = r;
}); 
```

ajax 响应是这样的：

```
<option value="1">Option 1</option>
<option value="2">Option 2</option> 
```

它在 Chrome、Aurora / Firefox、Opera 和 Safari 中运行良好（我已经测试过每一个），但 IE9 拒绝接受响应。

查看 IE9 的“检查元素”窗口（我不知道它的确切名称）后，我可以看到 IE9 尝试将响应呈现为简单的文本节点，例如：

```
Option 1Option 2 
```

为什么会发生这种情况是困扰我的。

很抱歉，如果这里已经对此提出质疑，我做了一些搜索，但看不到任何可以帮助我的答案。

TIA，安德烈

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:06:03.013

只要我记得，这就是一个 IE 错误：http: [//support.microsoft.com/kb/276228](http://support.microsoft.com/kb/276228)

我认为 JQuery 等效已修复错误：

```
mySelect.innerHTML = r;
//change to
$(mySelect).html(r); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T17:07:00.427

尝试使用

```
$('#mySelect').html("<option>Loading...</option>"); 
```

似乎 IE 没有评估您的 HTML，jQuery 应该为您解决这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-22T17:17:39.420

任何浏览器的唯一良好做法，以及唯一与 Internet Explorer 一起使用的方法是使用 DOM，而不仅仅是 html'ed 字符串。像这样的东西：

代码：

```
<script>
$('select#my_select')
    .append($( document.createElement('option') ).val('opt1').html('Option 1'))
    .append($( document.createElement('option') ).val('opt2').html('Option 2'));
</script> 
```

**之前**：

```
<select id="my_select"></select> 
```

**之后**：

```
<select id="my_select">
    <option value="opt1">Option 1</option>
    <option value="opt2">Option 2</option>
<select> 
```

# gradle - 如何记录 gradle 编译中使用的 jar

> ID：11160846
> 
> 赞同：1
> 
> 时间：2012-06-22T17:01:58.753
> 
> 标签：gradle

我尝试记录 compileClasspath 但它是空集（注意 allprojects 中的构建任务会记录日志）。为什么这没有记录我放入依赖项的所有内容？（试图在这里学习如何钓鱼/调试我的 gradle 问题，因为我真正的问题是编译没有为我的子项目找到我的 jar）。

请注意，构建输出以下行......数组中没有元素:(

MASTER：我现在正在构建 classpath=[]

```
allprojects {
    apply plugin: 'java'
    apply plugin: 'eclipse'

    buildDir = 'output'

    task hello << { task -> println "I'm $task.project.name" }
    build << { task -> println "MASTER: I'm building now classpath=$sourceSets.main.compileClasspath.files" }
}

subprojects {

    version = 'Developer-Build'
    project.ext.genLibDir = file('lib')
    project.ext.fixedLibDir = file('libother')

    repositories {
         mavenCentral()
    }

    //configurations.compile {
    //  exclude group: 'javax.jms',        module: 'jms'
    //  exclude group: 'com.sun.jdmk',     module: 'jmxtools'
    //  exclude group: 'com.sun.jmx',      module: 'jmxri'
    //}

    dependencies {
        compile group: 'org.hibernate',   name: 'hibernate-entitymanager', version: '4.1.4.Final'
        compile group: 'org.slf4j',       name: 'slf4j-api',               version: '1.6.6'
        compile group: 'org.slf4j',       name: 'log4j-over-slf4j',        version: '1.6.6'
        compile group: 'ch.qos.logback',  name: 'logback-core',            version: '1.0.6'
        compile group: 'joda-time',       name: 'joda-time',               version: '2.1'
        compile group: 'com.google.inject',name: 'guice',                  version: '3.0'
        compile group: 'com.google.protobuf',name: 'protobuf-java',        version: '2.4.1'

        //to be erased soon
        compile group: 'commons-configuration',name:'commons-configuration',version: '1.8'
        compile group: 'org.jboss.netty', name: 'netty',                   version: '3.2.7.Final'

        //compile group: 'org.asteriskjava',name: 'asterisk-java',         version: '1.0.0.M3'            
        compile fileTree(dir: project.ext.fixedLibDir, include: '*.jar')

        compile fileTree(dir: 'webserver/play-1.2.4/framework/lib', include: '*.jar')
        compile fileTree(dir: 'webserver/play-1.2.4/framework', include: '*.jar')
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T18:39:43.650

我认为这现在有效，我发现 fileTree 不适合我，但其余的都在工作

毕业：依赖

或者

梯度依赖

更好的答案在这里......

[使用配置注入时，gradle 中路径的根是什么？](https://stackoverflow.com/questions/11162432/what-is-the-root-of-the-path-in-gradle-when-using-configuration-injection)

# nhibernate - 命名空间 'urn:nhibernate-mapping-2.2' 中的元素 'class' 具有无效的子元素 'id'

> ID：11160865
> 
> 赞同：2
> 
> 时间：2012-06-22T17:03:13.500
> 
> 标签：nhibernate, mapping

我是 Nhibernate 的新手。希望我能在这里找到答案。这是我的课：

```
public class PaymentAudit : EntityBase<int>, IAggregateRoot
{
    public PaymentAudit() { }
    public  System.Guid PaymentStateId { get; set; }
    public  System.DateTime DateStamp { get; set; }
    public  Payment Trn { get; set; }
    public  PaymentSaga PaymentSaga { get; set; }
    public  ProcessState ProcessState { get; set; }
    public  PublishState PublishState { get; set; }
    public  System.Nullable<short> ChgCount { get; set; }
    public  string UserName { get; set; }

    protected override void Validate()
    {
    }
} 
```

这是我的映射：

```
<?xml version="1.0" encoding="utf-8" ?>

<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
    namespace="Praweda.Interface.Framework.Model.Payment"
        assembly="Praweda.Interface.Framework.Model">

  <class name="PaymentAudit" table="PaymentAudit" lazy="false" >
    <composite-id>
      <key-property name="PaymentStateId" column="PaymentStateId" />
      <key-property name="DateStamp" column="DateStamp" />
      <key-property name="ProcessState" column="ProcessState" />
    </composite-id>
    <id name="PaymentState">
      <generator class="identity" />
      <column name="PaymentStateId" sql-type="uniqueidentifier" not-null="true" />
    </id>    
    <id name="ProcessState">
      <generator class="identity" />
      <column name="ProcessState" sql-type="varchar" not-null="true" />
    </id>
    <id name="DateStamp">
      <generator class="identity" />
      <column name="DateStamp" sql-type="datetime" not-null="true" />
    </id>   
    <many-to-one insert="false" update="false" lazy="false" name="PaymentStateId">
      <column name="PaymentStateId" sql-type="uniqueidentifier" not-null="true" />
    </many-to-one>
    <property name="PaymentStateId">
      <column name="PaymentStateId" sql-type="uniqueidentifier" not-null="true" />
    </property>
    <many-to-one insert="false" update="false" lazy="false" name="ProcessState">
      <column name="ProcessState" sql-type="varchar" not-null="true" />
    </many-to-one>
    <property name="ProcessState">
      <column name="ProcessState" sql-type="varchar" not-null="true" />
    </property>
    <many-to-one insert="false" update="false" lazy="false" name="PublishState">
      <column name="PublishState" sql-type="varchar" not-null="false" />
    </many-to-one>
    <property name="PublishState">
      <column name="PublishState" sql-type="varchar" not-null="false" />
    </property>
    <many-to-one insert="false" update="false" lazy="false" name="Trn">
      <column name="Trn" sql-type="varchar" not-null="false" />
    </many-to-one>
    <property name="Trn">
      <column name="Trn" sql-type="varchar" not-null="false" />
    </property>
    <property name="ChgCount">
      <column name="ChgCount" sql-type="smallint" not-null="false" />
    </property>
    <property name="UserName">
      <column name="UserName" sql-type="nvarchar" not-null="false" />
    </property>
  </class>

</hibernate-mapping> 
```

当我尝试在会话工厂中添加存储库程序集时，这是代码

```
 Configuration config = new Configuration();
        config.AddAssembly("MyProject.Nhibernate.Repository");

        log4net.Config.XmlConfigurator.Configure();

        config.Configure();

        _sessionFactory = config.BuildSessionFactory(); 
```

给我错误：命名空间“urn:nhibernate-mapping-2.2”中的元素“类”在命名空间“urn:nhibernate-mapping-2.2”中有无效的子元素“id”。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:05:16.353

您有一个`composite-id`元素后跟一个`id`元素。你不能两者兼得。

`composite-id`当表中的主键跨越多个列时使用。

除此之外，您只能拥有一个`id`元素。它定义了如何唯一标识您的实体。对于属性，您应该使用`property`元素。

查看 NHibernate 文档可能会有所帮助： [http ://www.nhforge.org/doc/nh/en/#mapping](http://www.nhforge.org/doc/nh/en/#mapping)

# mysql - 将 MySQL 迁移到 SQL Server - 外键给出一个不清楚的错误（对我来说）

> ID：11160866
> 
> 赞同：2
> 
> 时间：2012-06-22T17:03:14.183
> 
> 标签：mysql, sql, sql-server, database-design, foreign-keys

我正在将数据库从 MySQL 5 迁移到 SQL Server 2008。我正在使用 SQL Server 迁移助手，它给了我一个我不明白的错误。

我有看起来像这样的表：

```
Table A
  ID (primary key)
  ProductionBatch
  Manufacturer
  LotNo
  Cost
  (and a bunch of other fields)

Table B
  ProductionBatch (primary key)
  Manufacturer (primary key)
  LotNo (primary key)
  Cost (primary key)
  (and a bunch of other fields) 
```

在 MySQL 中，我在两个表中指出的四个字段构成表 B 中的主键和表 A 中的外键；我不希望将任何新记录插入到表 B 中，除非表 A 中的这些字段匹配。在 MySQL 中工作正常，但迁移助手给我以下错误：

```
M2SS0048: Foreign Key does not contains all the columns of Primary/Unique Key 
```

除了语法错误，我无法弄清楚这个错误是什么意思。是不是我允许表 A 中的那些字段为空值？或者它们在表 A 中不必是唯一的？我尝试使用自动递增整数作为表 B 的主键（而不是复合键），但这似乎没有帮助。

任何想法或建议将不胜感激。

编辑：要清楚，我的外键在表 B 上。我先将记录放入表 A，然后将记录放入表 B。但我不想将与表 A 中的任何不匹配的记录放入表 B .

第二次编辑：我被要求展示这个问题的代码。正如我对提问者所说，我一直在用一个简单的例子来提问；我的表格实际上更复杂，我认为简化版本会更容易回答。但这里是实际的表格，如果有人想看看我真正在做什么。我链接的实际字段是 QCBatchID、LaboratoryName、Constituent 和 Fraction（我在上面的示例中使用了通用字段）。

表 A 是：

```
CREATE TABLE `chemistry_qc` (
`QCBatchID` varchar(12) COLLATE utf8_unicode_ci NOT NULL,
`LaboratoryName` varchar(45) COLLATE utf8_unicode_ci NOT NULL,
`Constituent` varchar(45) COLLATE utf8_unicode_ci NOT NULL,
`Fraction` enum('Not Reported','NA','Total','Dissolved','TR') COLLATE utf8_unicode_ci    
NOT NULL,
`LabSampleType` varchar(12) COLLATE utf8_unicode_ci DEFAULT NULL,
`PercentRecovery` decimal(5,2) DEFAULT NULL,
`RPD` double(5,2) DEFAULT NULL,
PRIMARY KEY (`QCBatchID`,`LaboratoryName`,`Constituent`,`Fraction`),
CONSTRAINT `fk_chem_qc_chem` FOREIGN KEY (`QCBatchID`, `LaboratoryName`,   `Constituent`, `Fraction`) REFERENCES `chemistry` (`LaboratoryName`, `QCBatchID`, `Constituent`, `Fraction`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci 
```

表 B 是：

```
CREATE TABLE `chemistry` (
`ChemistryID` int(11) NOT NULL AUTO_INCREMENT,
`StationID` varchar(45) COLLATE utf8_unicode_ci NOT NULL,
`EventStartDateTime` datetime NOT NULL,
`SampleStartDateTime` datetime DEFAULT NULL,
`SampleEndDateTime` datetime DEFAULT NULL,
`SampleType` varchar(45) COLLATE utf8_unicode_ci DEFAULT NULL,
`FieldSampleID` varchar(45) COLLATE utf8_unicode_ci DEFAULT NULL,
`Matrix` varchar(12) COLLATE utf8_unicode_ci DEFAULT NULL,
`FieldQC` varchar(20) COLLATE utf8_unicode_ci DEFAULT NULL,
`GrabComposite` enum('C','G') COLLATE utf8_unicode_ci DEFAULT NULL,
`EventRepresentation` varchar(20) COLLATE utf8_unicode_ci DEFAULT NULL,
`CollectionMethod` varchar(12) COLLATE utf8_unicode_ci DEFAULT NULL,
`LaboratoryName` varchar(45) COLLATE utf8_unicode_ci DEFAULT NULL,
`LabSampleID` varchar(45) COLLATE utf8_unicode_ci DEFAULT NULL,
`ConstituentType` varchar(20) COLLATE utf8_unicode_ci DEFAULT NULL,
`Constituent` varchar(45) COLLATE utf8_unicode_ci DEFAULT NULL,
`CASNumber` varchar(20) COLLATE utf8_unicode_ci DEFAULT NULL,
`Fraction` enum('TR','Dissolved','Total','Not Reported','NA') COLLATE utf8_unicode_ci   DEFAULT NULL,
`QCBatchID` varchar(12) COLLATE utf8_unicode_ci DEFAULT NULL,
`SamplePrepMethod` varchar(45) COLLATE utf8_unicode_ci DEFAULT NULL,
`AnalysisType` varchar(5) COLLATE utf8_unicode_ci DEFAULT NULL,
`LabSampleType` varchar(4) COLLATE utf8_unicode_ci DEFAULT NULL,
`AnalyteType` varchar(5) COLLATE utf8_unicode_ci DEFAULT NULL,
`SamplePrepDate` date DEFAULT NULL,
`ReportedValue` double DEFAULT NULL,
`Units` varchar(12) COLLATE utf8_unicode_ci DEFAULT NULL,
`NumericQualifier` enum('>=','<=','>','<','=') COLLATE utf8_unicode_ci DEFAULT NULL,
`DataQualifier` text COLLATE utf8_unicode_ci,
`ReportingLimit` double DEFAULT NULL,
`MethodDetectionLimit` double DEFAULT NULL,
`PercentMoisture` decimal(3,2) DEFAULT NULL,
`MethodReference` varchar(12) COLLATE utf8_unicode_ci DEFAULT NULL,
`MethodNumber` varchar(20) COLLATE utf8_unicode_ci DEFAULT NULL,
`AnalysisDateTime` datetime DEFAULT NULL,
`Dilution` int(3) DEFAULT NULL,
`SampleNotes` longtext COLLATE utf8_unicode_ci,
PRIMARY KEY (`ChemistryID`),
KEY `fk_chemistry_event1` (`StationID`,`EventStartDateTime`),
KEY `fk_chemistry_laboratory1` (`LaboratoryName`),
KEY `ChemistryID` (`ChemistryID`,`StationID`,`EventStartDateTime`),
KEY `fk_chemistry_c_EventRepresentation1` (`EventRepresentation`),
KEY `fk_chemistry_c_collectionmethod1` (`CollectionMethod`),
KEY `fk_chemistry_c_sampletype1` (`SampleType`),
KEY `fk_chemistry_c_matrix` (`Matrix`),
KEY `fk_chemistry_c_methods`      (`Constituent`,`ConstituentType`,`Units`,`MethodReference`,`MethodNumber`),
KEY `fk_chemistry_sampleprepmethod1` (`SamplePrepMethod`),
KEY `fk_chemistry_analysistype` (`AnalysisType`),
KEY `fk_chemistry_analytetype` (`AnalyteType`),
KEY `fk_chemistry_labsampletype` (`LabSampleType`),
KEY `ChemistryID_2` (`ChemistryID`,`StationID`),
KEY `LaboratoryName` (`LaboratoryName`,`Constituent`,`Fraction`,`QCBatchID`),
KEY `QCBatchID_4` (`QCBatchID`,`LaboratoryName`,`Constituent`,`Fraction`),
KEY `LaboratoryName_4` (`LaboratoryName`,`QCBatchID`,`Constituent`,`Fraction`),
CONSTRAINT `chemistry_analysistype` FOREIGN KEY (`AnalysisType`) REFERENCES   `c_analysistype` (`AnalysisType`) ON DELETE NO ACTION ON UPDATE NO ACTION,
CONSTRAINT `chemistry_ibfk_10` FOREIGN KEY (`SamplePrepMethod`) REFERENCES `c_sampleprepmethod` (`SamplePrepMethod`) ON DELETE NO ACTION ON UPDATE NO ACTION,
CONSTRAINT `chemistry_ibfk_11` FOREIGN KEY (`Constituent`, `ConstituentType`, `Units`, `MethodReference`, `MethodNumber`) REFERENCES `c_methods` (`Constituent`, `ConstituentType`, `Units`, `MethodReference`, `MethodNumber`) ON DELETE NO ACTION ON   UPDATE NO ACTION,
CONSTRAINT `chemistry_ibfk_2` FOREIGN KEY (`AnalyteType`) REFERENCES `c_analytetype` (`AnalyteType`) ON DELETE NO ACTION ON UPDATE NO ACTION,
CONSTRAINT `chemistry_ibfk_3` FOREIGN KEY (`CollectionMethod`) REFERENCES `c_collectionmethod` (`CollectionMethod`) ON DELETE NO ACTION ON UPDATE NO ACTION,
CONSTRAINT `chemistry_ibfk_4` FOREIGN KEY (`EventRepresentation`) REFERENCES `c_eventrepresentation` (`EventRepresentation`) ON DELETE NO ACTION ON UPDATE NO ACTION,
CONSTRAINT `chemistry_ibfk_5` FOREIGN KEY (`Matrix`) REFERENCES `c_matrix` (`Matrix`) ON DELETE NO ACTION ON UPDATE NO ACTION,
CONSTRAINT `chemistry_ibfk_6` FOREIGN KEY (`SampleType`) REFERENCES `c_sampletype` (`SampleType`) ON DELETE NO ACTION ON UPDATE NO ACTION,
CONSTRAINT `chemistry_ibfk_7` FOREIGN KEY (`StationID`, `EventStartDateTime`)   REFERENCES `event` (`StationID`, `EventStartDateTime`) ON DELETE NO ACTION ON UPDATE NO ACTION,
CONSTRAINT `chemistry_ibfk_8` FOREIGN KEY (`LaboratoryName`) REFERENCES `laboratory` (`LaboratoryName`) ON DELETE NO ACTION ON UPDATE NO ACTION,
CONSTRAINT `chemistry_ibfk_9` FOREIGN KEY (`LabSampleType`) REFERENCES `c_labsampletype` (`LabSampleType`) ON DELETE NO ACTION ON UPDATE NO ACTION) ENGINE=InnoDB AUTO_INCREMENT=206971 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:20:15.893

错误本身只是说您的 FK 不包含构成表 B 的 PK 的所有四列。仔细检查您的 FK 规范，看看它是否包含所有四列。

话虽如此，@Kevin 的评论（在问题中）是正确的，FK 不能那样工作，你必须先插入 PK 表。

编辑：现在我看到 FK 在表 B 而不是 A 上（根据您的评论和编辑）这是问题所在，您在表 B 中有一个 FK 引用 A，但是 A 上的 PK 只是一个 ID ...不起作用，表 B 上的 FK 和它所引用的表上的 PK（在本例中为 A）需要相同。您可以将 ID 列作为 PK 从 A 中删除，并使其成为与 B 相同的复合键，如果您希望它起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T22:49:04.623

我将只保留 2 个表中的相关列：

**表 A：**

```
CREATE TABLE chemistry_qc (
  QCBatchID       varchar(12) COLLATE utf8_unicode_ci  NOT NULL,
  LaboratoryName  varchar(45) COLLATE utf8_unicode_ci  NOT NULL,
  Constituent     varchar(45) COLLATE utf8_unicode_ci  NOT NULL,
  Fraction        enum('Not Reported','NA','Total','Dissolved','TR') 
                              COLLATE utf8_unicode_ci  NOT NULL,
  --- more columns

  PRIMARY KEY (QCBatchID, LaboratoryName, Constituent, Fraction),

  CONSTRAINT fk_chem_qc_chem 
    FOREIGN KEY (QCBatchID, LaboratoryName, Constituent, Fraction) 
      REFERENCES chemistry 
                (LaboratoryName, QCBatchID, Constituent, Fraction) 
    ON DELETE NO ACTION 
    ON UPDATE NO ACTION

) ENGINE=InnoDB 
  DEFAULT CHARSET=utf8 
  COLLATE=utf8_unicode_ci ; 
```

**表 B：**

```
CREATE TABLE chemistry (
  ChemistryID     int(11) NOT NULL AUTO_INCREMENT,
  --- more columns
  LaboratoryName  varchar(45) COLLATE utf8_unicode_ci  DEFAULT NULL,
  --- more columns
  Constituent     varchar(45) COLLATE utf8_unicode_ci  DEFAULT NULL,
  Fraction        enum('TR','Dissolved','Total','Not Reported','NA') 
                             COLLATE utf8_unicode_ci  DEFAULT NULL,
  QCBatchID       varchar(12) COLLATE utf8_unicode_ci  DEFAULT NULL,
  --- more columns

PRIMARY KEY (ChemistryID),

KEY fk_chemistry_laboratory1 (LaboratoryName),
--- more KEYs
KEY LaboratoryName (LaboratoryName, Constituent, Fraction, QCBatchID),
KEY QCBatchID_4 (QCBatchID, LaboratoryName, Constituent, Fraction),
      --- this key should have been needed for your FK reference

KEY LaboratoryName_4 (LaboratoryName , QCBatchID, Constituent, Fraction),
      --- this key was needed for your FK reference

--- CONSTRAINTS 

) ENGINE=InnoDB 
  AUTO_INCREMENT=206971 
  DEFAULT CHARSET=utf8 
  COLLATE=utf8_unicode_ci ; 
```

* * *

为了记录，这是一个`FOREIGN KEY`从表`A (chemistry_qc)`到表`B (chemistry)`

* * *

`FOREIGN KEY`您的约束中有两个错误。第一个是由您完成的（并由 MySQL 协助）。您有两个引用和具有不同顺序的引用复合键：

```
CONSTRAINT fk_chem_qc_chem 
    FOREIGN KEY (QCBatchID, LaboratoryName, Constituent, Fraction) 
      REFERENCES chemistry 
                (LaboratoryName, QCBatchID, Constituent, Fraction) 
             ---    |||             |||   
             --- *** wrong order here *** --- 
```

它应该是：

```
CONSTRAINT fk_chem_qc_chem 
    FOREIGN KEY (QCBatchID, LaboratoryName, Constituent, Fraction) 
      REFERENCES chemistry 
                (QCBatchID, LaboratoryName, Constituent, Fraction) 
```

当您尝试在 a`VARCHAR(45)`引用 a`VARCHAR(12)`但它没有添加 FK 时，MySQL 应该会抱怨。

* * *

第二个错误是您的 FK 引用的键既不是`PRIMARY`也不是`UNIQUE`。MySQL 的另一个帮助是通过允许 FK 到非唯一的列复合来解决问题。

因此，您应该将 (case-1) 声明为`UNIQUE`table中的键，`chemistry`或者 (case-2) 您的 FK 应该是相反的，从 table`B`到（在此化合物上`A`已经有 a ）。`PRIMARY KEY`

两者中哪一个是正确的，取决于您的数据关系：

每个`chemistry`都有 0 或 1`chemistry_qc`吗？那是 case-1 （你有一个`1:1`关系，或者更准确地说是 a `0..1 :: 1`）。

每个`chemistry_qc`都有 0 或更多`chemistry`吗？那是case-2（你有一个共同的`1:n`关系，`1 :: 0..n`在上面的符号中）。

* * *

最后，应该清楚导致迁移错误的原因是您使用的向导（正确地）期望一个`FOREIGN KEY`约束来引用一个`PRIMARY`或一个`UNIQUE`化合物。

# java - Netbeans / Java如何连接到远程数据库

> ID：11160869
> 
> 赞同：2
> 
> 时间：2012-06-22T17:03:26.210
> 
> 标签：java, mysql, database, netbeans

我正在尝试创建一个连接到远程主机的 java 应用程序，检索一些数据并将一些数据添加到数据库中。问题是我无法从我的应用程序中连接到远程主机上的数据库。

该应用程序是使用 netbeans 在 Java 中创建的。

```
connection informations:
host adress  : subadr.myadress.com
database name: mydatabase_name
user name    : mydatabase_name
user password: name123 
```

我试过这个：在netbeans中，服务>右键单击数据库>新连接。然后我使用了一个连接器：**mysql-connector-java-5.1.20-bin.jar**然后我输入了需要的信息。当我单击**测试连接**时 ，我一直收到此错误：

> 无法建立与 jdbc 的连接：mysql://subadr.myadress.com/mydatabase_name using com.mysql.jdbc.Driver (Communications link failure 最后一个成功发送到服务器的数据包是 0 毫秒前。驱动程序没有收到任何数据包来自服务器。）

我不知道是否必须在主机中配置其他内容。我已经连接到我自己的 PC 上的数据库（唯一的区别是 subadr.myadress.com 我使用了 localhost）问题是我无法访问我主机上的那个。谢谢你的任何建议。

# cordova - 如何将 PhoneGap App 部署到 Android 平板电脑市场？

> ID：11160871
> 
> 赞同：3
> 
> 时间：2012-06-22T17:03:35.887
> 
> 标签：cordova, google-play, tablet

我构建了一个 phonegap 应用程序，它只是一个网站的启动器。您下载该应用程序，单击它，它将在特定 URL 处打开您的网络浏览器。

使用 Android 手机的人会在 Google Play 市场中看到此应用。使用 Samsung Galaxy Tab 的人在 Google Play 市场中看不到此应用程序。如何让 Galaxy Tab 用户可以访问此应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T18:37:45.233

在我的评论的扩展中，您可能想看看[this](http://developer.android.com/guide/topics/manifest/compatible-screens-element.html)和[this](https://stackoverflow.com/questions/4647116/how-to-publish-android-app-into-market-for-particular-screen-resolution)。

# django - 通过对子项进行排序来检索所有父项和子项

> ID：11160873
> 
> 赞同：0
> 
> 时间：2012-06-22T17:04:00.770
> 
> 标签：django, django-models, django-queryset

我是 Django 新手，并尝试在线开发我的简历。

这是我的两个模型：

```
#MODELS
class Category( models.Model ):
    help_text = 'Category respresents a category of experience, or school experiments'
    # Name
    name = models.CharField( max_length=500, blank=False )
    # ...

    def __unicode__( self ):
        return self.name

class Experience( models.Model ):
    help_text = 'An experience can be a skill, a school experiment etc.'
    # ordering = ['-end_date']
    parent_category = models.ForeignKey( Category )
    # Name
    # ...
    end_date = models.DateField( 'date of end', blank=True, null=True )
    # ...

    def __unicode__(self):
        return self.name

#View
# index view
def index( request ):
        # Would like something to just order the children
    all_categories = Category.objects.filter().order_by( ???? )
    return render_to_response( 'CMSCV/index.html',
            { 'categories' : all_categories },
            context_instance=RequestContext(request) ) 
```

正如您在我看来，我不知道如何通过查询中的“end_date”字段仅对子项（经验）进行排序。

我试过这个：

`Category.objects.all().order_by( 'experience__end_date' ).distinct()`

`Category.objects.all().order_by( 'experience__end_date' ).distinct('experience__end_date')`

`Category.objects.all().order_by( 'experience__end_date' ).distinct( 'name' )`

但它让我有太多的父母......

想知道我该如何解决？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:11:14.240

您可以为此使用 Django 的[聚合](https://docs.djangoproject.com/en/dev/topics/db/aggregation/)来获取最大 end_date，然后对其进行排序。例如：

```
from django.db.models import Max
Category.objects.all().annotate(max_date=Max('experiences_set__end_date')).order_by('max_date') 
```

# sql-server-2005 - 递归 SQL 查询

> ID：11160876
> 
> 赞同：1
> 
> 时间：2012-06-22T17:04:24.793
> 
> 标签：sql-server-2005, recursive-query

我正在使用 SQL Server 2005 并且熟悉基础知识，但是有一个问题让我有点头晕目眩，我将不胜感激。

我有两张我正在尝试使用的桌子。一个是员工数据库表，一个是组织表。在员工表中，每个员工都有一个与他们相关联的部门 ID 和当前的就业状态。在组织表中有一个部门 ID 列表，该部门在哪个部门下汇总，以及当前的活动状态。我需要创建一个查询，我可以给它一个部门 ID，它将返回该部门中的活动（值 - A）员工总数以及它下面的所有活动（值 - A）部门一直到底部。

相关表和列：
**EE_Persons_today**
DEPTID
EMPL_STATUS

**DEPARTMENT_DATA**
DEPTID
REPORTS_TO_DEPT
EFF_STATUS

示例：
IT 部门有 300 人直接分配给它，但也有 2 个子组，软件和硬件。硬件有 100 人直接分配给它，没有子组。Software 有 100 人直接分配给它，1 个子组称为 Enterprise，有 50 人直接分配给它。如果我问有多少人在 IT，那将是 300+100+100+50 = 550。如果我问有多少人在软件领域，那将是 100+50=150。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:30:39.193

查看递归 SQL 查询的 CTE（通用表表达式）。我在下面包含了一个示例。请让我知道它是否适用于您的设置。

将@INPUT 的值更改为您请求人数的部门（其中 EMPL_STATUS= 'A'）。

```
DECLARE @INPUT INT
SET @INPUT = 1

DECLARE @DEPARTMENT_DATA TABLE
(
    DEPTID INT,
    REPORTS_TO_DEPT INT,
    EFF_STATUS INT
)

INSERT INTO @DEPARTMENT_DATA
SELECT 1, NULL, 1
UNION SELECT 2, 1, 1
UNION SELECT 3, 2, 1
UNION SELECT 4, 1, 1
UNION SELECT 5, 4, 1

DECLARE @EE_Persons_today TABLE
(
    ID INT IDENTITY(1,1),
    DEPTID INT,
    EMPL_STATUS VARCHAR(1)
)

INSERT INTO @EE_Persons_today
SELECT 2, 'A'
UNION ALL SELECT 2, 'A'
UNION ALL SELECT 2, 'A'
UNION ALL SELECT 2, 'A'
UNION ALL SELECT 2, 'B'
UNION ALL SELECT 3, 'A'
UNION ALL SELECT 3, 'A'
UNION ALL SELECT 3, 'B'
UNION ALL SELECT 3, 'A'
UNION ALL SELECT 3, 'A'
UNION ALL SELECT 3, 'A'
UNION ALL SELECT 3, 'A'
UNION ALL SELECT 3, 'B'
UNION ALL SELECT 3, 'A'
UNION ALL SELECT 3, 'A'
UNION ALL SELECT 4, 'B'
UNION ALL SELECT 4, 'A'
UNION ALL SELECT 5, 'A'
UNION ALL SELECT 5, 'A'
UNION ALL SELECT 5, 'B'
UNION ALL SELECT 5, 'A'

; WITH CTE AS
(
    SELECT a.DEPTID
    FROM @DEPARTMENT_DATA a
    WHERE a.DEPTID = @INPUT

        UNION ALL

    SELECT a.DEPTID
    FROM @DEPARTMENT_DATA a
    JOIN CTE c
        ON a.REPORTS_TO_DEPT = c.DEPTID
) 
SELECT COUNT(*)
FROM @EE_Persons_today a
JOIN CTE c
    ON a.DEPTID = c.DEPTID
WHERE a.EMPL_STATUS = 'A' 
```

# html - Firefox 和 Chrome 之间的神秘 2px 差异

> ID：11160879
> 
> 赞同：3
> 
> 时间：2012-06-22T17:04:46.540
> 
> 标签：html, css, cross-browser, margin, background-position

我的问题提到了我一直在开发的[这个网站。](http://novaecomm.com.br/blog/)看到里面有4个圆圈和4个按钮的地方了吗？这是他们相关的 CSS：

```
/* STEPS HIGHLIGHT */
.steps {
background: transparent url(img/bg-steps.gif) 37px 92px no-repeat;
    clear: both;
    float: left;
    text-transform: uppercase;  
} 
.steps .col {
    margin-top: 15px;
    text-align: center;
}
.col.steps-1 {
    width: 194px;
}
.col.steps-2 {
    margin-left: 40px;
    width: 196px;
}
.col.steps-3 {
    margin-left: 21px;
    width: 232px;
}
.steps .col.last {
    margin-left: 11px;
    width: 226px;
}
.steps .col.last h3 {
    margin: 0 auto;
    width: 129px;
}
.steps h2 {
    font: 24px 'ProximaNovaLight';
}
.steps h3 {
    color: #7f7f7f;
    display: block;
    font: 14px 'ProximaNovaSemibold';
    height: 20px;
}
.steps p {
    font: 9px 'Arial';
}
.steps .col .icon {
    margin: 28px 0 40px 0;
    position: relative;
    left: 43px;
    width: 98px;
    height: 98px;
}
.steps-1:hover h3,
.steps-2:hover h3,
.steps-3:hover h3,
.steps .col.last:hover h3 {
    color: #c03a2f;
}
.steps-1:hover .icon,
.steps-2:hover .icon,
.steps-3:hover .icon,
.steps .col.last:hover .icon {
    background: transparent url(img/ico-steps-hover.gif) -6px 3px no-repeat;
}
.steps-2:hover .icon {
    background-position: -240px 3px;
}
.steps-3:hover .icon {
    background-position: -457px 3px;
}
.steps .col.last:hover .icon {
    background-position: -700px 3px
} 
```

如您所见，我为圆圈和`<a>`元素使用了背景图像来构建悬停效果。原来，主播没有背景。在悬停时，它们被分配相同的精灵和不同的背景位置。我使用相对定位和边距来定位`<a>`元素。

我的问题是Chrome 和 Firefox 之间存在*2px 的差异，这破坏了后者的效果。*我不知道差异是否出现在背景位置的边距中，也不知道为什么存在。

以前有人遇到过这种问题吗？为什么会这样？我如何解决它？我一直在努力寻找解决方案几个小时。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-17T19:10:10.020

我可以建议一种更好的方法来实现这一点吗？您有 2 个 21.8K 和 23k 的大图像。圆形背景只需要 1 张图像。以及精灵中带有红色悬停状态的图标。而且你不需要水平线的图像，你可以用纯CSS来做。点击下面的链接。它应该是这样的：[fiddle](http://jsfiddle.net/9YTAJ/3/)

你的 HTML：

```
 <div class="anchorSection">
        <div class="circle">
            <a href="#" class="wheel"></a>
        </div>
        <div class="circle">
            <a href="#" class="wheel"></a>
        </div>          
        <div class="circle">
            <a href="#" class="wheel"></a>
        </div> 
        <div class="circle" style="margin-right:0">
            <a href="#" class="wheel"></a>
        </div> 
        <div class="horizontal">
    </div> 
```

和你的 CSS：

```
 .anchorSection{
            width:838px;
            height:102px;
            position:relative;
        }
        .circle{
            width:99px;
            height:102px;
            background:url("circle.gif");
            float:left;
            margin-right:147px;
            z-index:-1;

        }
        .circle:last-child{
            margin-right:0;
        }
        .circle a{
            width:39px;
            height:39px;
            display:block;
            margin:0 auto;
            margin-top:29px;
        }

        .circle a.wheel{
            background:url("wheel.gif") 0 0 no-repeat
        }
        .circle a.wheel:hover{
            background-position:-39px 0;
        }
        .horizontal{
            position:absolute;
            top:50%;
            border-top:1px solid #cfcfcf;
            border-bottom:1px solid #ececec;
            width:100%;
            z-index:1
        } 
```

我只为你做了第一个图标，但重复了 4 次。你显然需要做剩下的 3 个图标和它们各自的悬停状态。确保将所有 8 个图标放在一个 sprite 中，因此您只加载 1 个图像并使用正确的背景位置来为每个图标及其悬停状态获取正确的图像。希望这可以帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-17T14:27:41.103

在 Firefox 中，自定义字体“ProximaNovaLight”未加载，因此`h2`内部元素的高度与`.steps`Chrome 中的略有不同。

在 Chrome 中，`h2`计算高度为 26 像素，而在 Firefox 中为 30 像素。添加此 CSS 以使 Chrome 和 Firefox 保持一致：

```
.steps h2 {
    height: 26px;
} 
```

这是最快的“修复”。

根本的问题是高度的根本`h2` *没有任何区别*。您实现网站这一部分的方式并不可靠。您将整个“非活动”图像作为背景图像`.steps`，但随后您将“活动”图像单独定位在每个`<a class="icon">`元素中。这很容易破裂。

例如，即使在 Chrome 中它现在应该可以工作，尝试放大一点然后悬停。图像在左右晃动。

* * *

该站点的另一个问题是您在文档类型上方有一个 HTML 注释，这会导致[怪癖模式](http://en.wikipedia.org/wiki/Quirks_mode)（即使[在 Firefox 中](https://developer.mozilla.org/en/Mozilla%2527s_Quirks_Mode)）。

```
<!-- BEGIN WP_HEADER -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

删除评论！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T11:12:13.850

在你的CSS上添加这个：

```
* {box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-17T20:16:46.900

好的。下载了您的所有资源，并确认如果 webfont 没有加载，即使在 Chrome 中也确实出现了问题，就像在 Firefox 中一样。（仅仅在开发工具中停用字体并不能重现它，因为在您这样做时元素大小已经确定。）所以，我们可以回答“*为什么它发生在 Firefox 而不是 Chrome？* ”那：这是字体。所以，如果你能在 FF 中正确加载你的字体，问题就解决了。

否则如何解决？通过将背景分配给两个不同的元素，您的生活变得更加困难。（主背景打开`.steps`，`:hover`背景在`.col`子元素上。）当您简单地在同一元素上交换背景时，排列起来总是更容易。我将水平线设为背景`.steps`，然后将圆形徽章图标都应用于`.col`div。这样，无论页面的其余部分如何重排，它们仍然会相互对齐，最坏的情况是背景线会稍微偏离中心。但...

但为什么会发生在这里？据我所知，无法下载您的 webfont 文件进行进一步测试，这是因为您的`.steps h2`样式没有提供明确的高度，而高度是在渲染时根据字体特征确定的。当 webfont 存在时，该元素的高度为 26px。缺失时，高度为 28px。如果您明确将高度设置为 28 像素，则可以涵盖并计划任何一种情况。当我将该高度设置为 28px，然后将图标`:hover`条件的背景偏移设置为 -15px 而不是当前的 33px 时，一切似乎都正常。当我使用开发工具在您的生产站点上进行这些更改时，它似乎在 Chrome 和 Firefox 中都可以使用，无论是否使用 webfont。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-17T14:34:23.867

为什么不使用重置样式表来平衡两个浏览器，然后应用您的样式。

[http://meyerweb.com/eric/thoughts/2011/01/03/reset-revisited/](http://meyerweb.com/eric/thoughts/2011/01/03/reset-revisited/)

# java - 如何使用 Java 从谷歌搜索结果中提取 URL

> ID：11160880
> 
> 赞同：-1
> 
> 时间：2012-06-22T17:04:47.337
> 
> 标签：java, parsing

我之前已经问过这个问题并且这个问题已经结束，因为它之前已经被问过并且在下面得到了很好的回答：[你如何以编程方式搜索谷歌 Java API](https://stackoverflow.com/questions/3727662/how-can-you-search-google-programmatically-java-api)

不幸的是，“Google Web Search API 已于 2010 年 11 月 1 日正式弃用”。所以，任何人都可以为我的问题提供一个答案。我需要从谷歌搜索结果中提取 URL 并将它们保存到 txt 文件中，而不会出现重复的结果。我能够使用 JSoup 从网页中提取 URL，但不能从谷歌搜索结果中提取。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T20:05:48.217

[是的，您可以通过JSON](https://developers.google.com/custom-search/v1/using_rest) （javascript 对象表示法）获取链接信息 ，然后使用[它在 java 中获取 json](http://code.google.com/p/google-gson/)

# c# - 创建可能引发 IndexOutOfRangeException 的属性

> ID：11160883
> 
> 赞同：7
> 
> 时间：2012-06-22T17:05:03.823
> 
> 标签：c#, api-design

我有一个包含项目集合的类。为方便起见，我提供了 GetCurrentItem ，它由

```
public Type GetCurrentItem
{
     get { return this.items[this.items.Count - 1]; }  
} 
```

如果列表中没有项目，这将引发异常。

我应该让异常被抛出还是应该返回`null`？如果这是我交给你的 API，你会期待什么？异常还是空？有没有更好的方法来处理这个？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-22T17:10:22.767

至于哪个更正确？正如柯克的评论所暗示的：这取决于。有时 a`null`是合乎逻辑的，有时如果没有合理的默认值，则异常更适合。我尝试做的一件事是考虑“是称`GetCurrentItem`逻辑失败还是安全的事情？”

如果是在没有的情况下调用失败`GetCurrentItem`，那么抛出异常是正确的做法。例如，如果您的集合有一个`HasCurrent`or`IsEmpty`属性，某人可以在调用 之前检查结果`GetCurrentItem`，那么他们应该“知道得更好”。但是，如果当前项目是`null`使用您的类的正确逻辑方式，那么一定要以这种方式设计它。无论哪种方式，我都会在代码注释中记录行为，让用户知道预期的行为。

不过我会这么说，暴露`ArgumentOutOfRange`异常可能会影响实现细节。`List<T>`也就是说，如果这个类`InvalidOperationException`的用户不知道内部结构是一个数组或.

由于它们并没有真正直接传递参数，因此它们获得`ArgumentOutOfRange`异常可能会令人困惑:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T17:09:52.867

让它抛出一个错误。这就是其他集合的工作方式。应该由用户应用程序来处理潜在的异常（尤其是在使用集合时）。可能应该有一个`bool HasSelection()`用户可以在继续之前调用的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-22T17:10:14.347

例外情况应该用于例外情况。如果 CurrentItem 可以为 null，则不应引发异常。我不明白为什么没有 CurrentItem 是例外。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-22T17:11:05.123

那么问题是您是否希望 GetCurrentItem 返回一个安全值。如果 Type 可以为空，则 GetCurrentItem 应该在没有当前项目时返回 null。如果您总是希望列表不为空并且默认情况下总是选择某些内容，那么抛出一个有意义的异常。

除非您的案例确实是异常而不是正常用例，否则您通常不应该抛出异常。然而，这可能是相当主观的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-22T17:15:26.950

我尝试从用户的角度来考虑它。去找最不惊讶的[校长](http://en.wikipedia.org/wiki/Principle_of_least_astonishment)。

如果我正在使用库或对象并调用`GetCurrentItem`并抛出 an `IndexOutOfRangeException`，我会想，“我没有调用任何带有索引的东西，我想要当前项目。” 因此，我的建议是返回 null，这会让我想，“哦，没有当前项目。”

或者，如果该属性是一个索引器并且我想在某个索引处获取一个项目，我不会对`IndexOutOfRangeException`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T17:13:56.320

如果此 GetCurrentItem 对您的 API 有意义，我会在没有项目时抛出“InvalidOperationException”。如果允许 null 作为有效结果，您可能希望以不同的方式命名它。

考虑现有的[LINQ Last](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.last.aspx)方法是否已经提供了相同的功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-22T17:16:43.713

如有疑问，请遵循 .NET。此功能类似于 List.Last()，如果为空则抛出异常。

[http://msdn.microsoft.com/en-us/library/bb358775](http://msdn.microsoft.com/en-us/library/bb358775)

# android - 反编译apk并注入代码

> ID：11160893
> 
> 赞同：0
> 
> 时间：2012-06-22T17:05:24.383
> 
> 标签：android, android-4.0-ice-cream-sandwich, decompiling, launcher

有没有办法反编译apk（来自ics的Launcher2.apk）并编辑它的代码并再次编译？

我需要用发送自定义广播或在 sd 上创建文件或从其他应用程序方式向它发出其他 CATCHABLE 信号的代码替换 toast 消息“已安装快捷方式”。

我知道baksmali。在它的帮助下，我可以删除 Toast 消息。但是我如何添加自己的代码呢？Jd-gui 不生成工作代码。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T20:30:08.940

[Apktool](http://code.google.com/p/android-apktool/)是您最好的选择，但您必须学习如何编辑 Smali。无法反编译为原始 Java，对其进行编辑，然后重新编译。既然要反编译Launcher2.apk，不如直接下载源码，修改，自己编译。假设您运行的是 Android AOSP API 级别 15 及更高版本，您还可以[通过 Accessibility](https://stackoverflow.com/posts/comments/14661968)捕获Toast 事件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-04-27T11:30:35.113

对于混合应用程序，我们可以通过以下简单步骤来完成：-

1.  将 app.apk 重命名为 app.zip。
2.  提取文件夹。

就是它文件夹将包含所有文件和资源。

# java - Android强制停止回调到应用程序？

> ID：11160897
> 
> 赞同：6
> 
> 时间：2012-06-22T17:05:43.530
> 
> 标签：java, android

如果按照 Settings->Application->ManageApplications -> --> Force Stop 的步骤强制停止应用程序，android 会调用 Activity 或 Application 的 onDestroy 吗？（如果没有，有什么方法可以知道应用程序是否由于用户触发的强制停止而死亡）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-22T17:39:46.667

强制停止应用程序将终止整个进程（即使用[`Process.killProcess(int pid)`](http://tinyurl.com/74fy7sx)）。与应用程序关联的所有资源都将被内核删除和释放。所以不，您无法拦截此操作。

当您在市场上发布您的应用程序时，开发人员控制台将为您提供有关强制关闭、崩溃等的统计信息（如果这就是您询问的原因）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T17:30:05.393

简而言之，不，`onDestroy()`不叫，你不能这样做。安卓不支持。

一个更广泛的答案......

`onDestroy()`在这种情况下似乎没有被调用。`Toast`我通过在调用 super.onDestroy 之前尝试拥有它来测试这一点，但该`Toast`消息从未出现过。（根据[这篇文章](https://stackoverflow.com/questions/6553941/force-closing-an-app-with-a-service-ondestroy-is-not-called-in-service)，`onDestroy()`它真的不可靠，不会经常在手机上调用，如果有的话，它可能会在模拟器上调用——所以要注意这一点）。相反`killProcess()`被调用，我们不能拦截它。

此外，根据[这篇文章](https://stackoverflow.com/questions/9477606/disabling-force-stop-button-in-android)中接受的答案，在用户控制的强制停止后，我们似乎甚至无法捕获和执行任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T17:39:16.053

不，这真的不可能。我没有查看有问题的 Android 代码，但我想“强制停止”只是调用`kill`您的应用程序的进程 ID。因此，您可以拦截的唯一方法是捕获信号，我认为 Android 不允许这样做。

如果您已扎根，则可以这样做，但不是以任何标准方式。

# android - 重用片段创建对话框

> ID：11160898
> 
> 赞同：2
> 
> 时间：2012-06-22T17:05:47.947
> 
> 标签：android, dialog, fragment

我通过在支持包（v4）中扩展 Fragment 创建了一个 Fragment。此视图包含一个列表和一个按钮。我的应用程序同时支持手机和 10 英寸平板电脑。在手机中，我使用片段将其显示为普通屏幕，使用选项卡中的 Activity 我需要显示与对话框相同的视图。我是否能够重用片段来显示对话框?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T18:32:46.273

我想这取决于您是否只想要布局，或者您是否想要其背后的逻辑。您可以在对话框中使用相同的布局，但逻辑通常以不同的方式实现，因为对话框更简单，并且使用基本实现来完成诸如 ok/cancel 之类的操作。他们可以访问对话框中的视图，但没有插入片段的好地方。

这里引用了一个名为 DialogFragment 的单独类： [http ://android-developers.blogspot.com/2012/05/using-dialogfragments.html](http://android-developers.blogspot.com/2012/05/using-dialogfragments.html)

它说“正在弃用 Activity 中的 showDialog/dismissDialog 方法以支持 DialogFragments”

# c# - Resharper 错误的可能 nullReferenceException 警告与任务并行库

> ID：11160900
> 
> 赞同：3
> 
> 时间：2012-06-22T17:05:51.003
> 
> 标签：c#, resharper, task-parallel-library, resharper-6.1

考虑这个例子

```
var task =Task.Factory.StartNew(()=>Console.WriteLine("test"));

task.ContinueWith(antecendent =>
        {
            ExceptionProcessor.HandleError(task.Exception.Flatten());
        }, TaskContinuationOptions.OnlyOnFaulted); 
```

在此示例中，resharper 预测 task.Exception.Flatten() 中可能存在空指针异常，因为它假定 task.Exception 可能为 null 。

但对于所有实际情况，它不会为 null，因为参数 TaskContinuationOptions.OnlyOnFaulted 确保仅在发生异常时调用该方法。

那么我如何告诉 Resharper 忽略所有类似的警告呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:52:47.947

我认为你有几个选择：

1.  在这种情况下忽略警告。
2.  将所有“可能的 NullReferenceException”的严重性降低到类似于提示的程度，甚至不显示。
3.  通过评论禁用此警告实例。
4.  假装 ReSharper 是正确的并添加`null`检查。

我不喜欢#4，你会降低你的代码的可读性，这样 ReSharper 才会开心。我也不喜欢 #3，因为这些注释可能会严重污染您的代码。#2 更好，但我认为 #1 是最好的选择：“Posible NullReferenceException”总是会有误报，因此您应该将其用作指导：“小心，*可能*有问题”，而不是严格的“你必须解决这个问题”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-28T03:49:00.180

Resharper 支持团队已将此视为错误，可以在此处进行跟踪[http://youtrack.jetbrains.com/issue/RSRP-316492](http://youtrack.jetbrains.com/issue/RSRP-316492)

# xml - 使用通配符替换 XSL 中的文本

> ID：11160901
> 
> 赞同：1
> 
> 时间：2012-06-22T17:05:59.507
> 
> 标签：xml, xslt

这*类似于*我之前遇到的一个问题，你们在不到一天的时间内就解决了。

我正在处理由数码摄像机生成的 XML 文件。相机允许用户将相机的所有设置保存到 SD 卡中，以便可以调用设置或将设置加载到另一台相机中。我正在编写的 XSL 样式表将允许用户查看相机的设置，这些设置保存在 Web 浏览器中的 SD 卡中。

虽然 XML 文件中的大多数值（由我的样式表格式化）对人类来说是有意义的，但有些则不然。我想做的是让样式表显示文本基于 XML 文件中的值，但更容易被人类理解。

可以写入 XML 文件的典型值是“_23_970”，它表示相机的帧速率。这将更好地显示为 23.970（或 023.970）。第一个下划线是一种占位符，为超过 099.999 的值留出空间。第二个下划线，显然代表小数。

我之前的（类似）问题涉及替换可预测的文本，解决方案是匹配模板。然而，在这种情况下，相机可以设置为 119,999 帧速率中的任何一个（我认为我的计算是正确的）。

我猜这种方法是将一个值传递给显示的网页，该网页保留数值（每个数字），用小数替换第二个下划线，并用 nbsp 或零替换第一个下划线（以更容易的为准） ）。如果字符串中的第一个字符是“1”（相机可以以高达 120.000 的帧速率运行），则应将其传递到样式表显示的页面。

我在这里阅读了有关通配符的其他帖子，但找不到回答这个问题的帖子。

编辑：很抱歉遗漏了重要信息。我在第一次尝试提问时表现得更好！我想我得意了。无论如何。. .

我应该向您展示在 XSL 文件中显示文本的代码：

```
<tr>
  <xsl:for-each select="Settings/Groups/Recording">
    <tr><td class="title_column">Frame Rate</td><td><xsl:value-of select="RecOutLinkSpeed"/></td></tr>
   </xsl:for-each>
</tr> 
```

我还应该给你我一直在使用的示例文件的 URL：http: [//josephthomas.info/Alexa/Setup_120511_140322.xml](http://josephthomas.info/Alexa/Setup_120511_140322.xml)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:31:09.620

假设具有这些值的元素被命名`frame-rate`为以下使用模板来处理两种情况：

```
<xsl:template match="frame-rate[starts-with(., '_')]">
  <xsl:value-of select="concat('&#160;', translate(substring(., 2), '_', '.'))"/>
</xsl:template>

<xsl:template match="frame-rate[not(starts-with(., '_'))]">
  <xsl:value-of select="translate(., '_', '.')"/>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T01:47:55.210

**使用**：

```
concat(translate(substring(.,1,1), '_', '&#xA0;'),
       translate(substring(.,2), '_', '.')
      ) 
```

**这是一个完整的转换：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>
 <xsl:template match=
  "td[preceding-sibling::*[1][self::td and . = 'Frame Rate']]/text()">
  <xsl:value-of select=
   "concat(translate(substring(.,1,1), '_', '&#xA0;'),
           translate(substring(.,2), '_', '.')
          )
   "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于一个简单的 XML 文档时，该文档包含`tr`来自实际 XML 文档的一个实际元素（并添加一个以测试第二种情况），如提供的链接所指**：

```
<t>
    <tr>
        <td class="title_column">Frame Rate</td>
        <td>_23_976</td>
    </tr>
    <tr>
        <td class="title_column">Frame Rate</td>
        <td>118_235</td>
    </tr>
</t> 
```

**产生了想要的正确结果：**

```
<t>
   <tr>
      <td class="title_column">Frame Rate</td>
      <td> 23.976</td>
   </tr>
   <tr>
      <td class="title_column">Frame Rate</td>
      <td>118.235</td>
   </tr>
</t> 
```

**说明**：

表达方式：

```
concat(translate(substring(.,1,1), '_', '&#xA0;'),
       translate(substring(.,2), '_', '.')
      ) 
```

通过以下方式进行评估：

1.  函数的两个参数**[`concat()`](http://www.w3.org/TR/1999/REC-xpath-19991116/#function-concat)**分别计算（彼此独立）。

2.  `concat()`就像它的名字所暗示的那样——将它的两个字符串参数连接成一个字符串。

3.  该**[`translate()`](http://www.w3.org/TR/1999/REC-xpath-19991116/#function-translate)**函数在此表达式中被引用了两次——它用于生成 `concat() 的每个参数。

4.  的第一个调用`translate()`是：`translate(substring(.,1,1), '_', '&#xA0;')`。在这种情况下，传递给函数的第一个参数是当前节点的字符串值的前导字符（在 XPath 中，当前（或上下文）节点由 表示`.`）。这个前导字符是由函数调用产生的：`substring(.,1,1)`它接受一个从偏移量 1 开始并且长度为 1的**[子字符串](http://www.w3.org/TR/1999/REC-xpath-19991116/#function-substring)**`translate()`。这个调用的第二个参数是一个包含我们想要替换或删除的所有字符的字符串——在这种情况下只是单个`"_"`字符。第三个参数`translate()`是一串“替换字符”，应该替换第二个参数中对应的（按位置）字符。在这种情况下，第三个参数包含单个字符`'&#xA0;'`(nbsp)，这意味着对`translate()`函数的调用会将当前节点的字符串值的第一个字符替换为nbsp *，如果*它恰好是一个下划线。

5.  第二个调用`translate()`类似于第一个调用：`translate(substring(.,2), '_', '.')`. 但是，它将应用于当前节点的字符串值的剩余部分（从位置 2 开始），并用点字符替换该剩余部分中的任何下划线。

**更新**：

由于 OP 难以理解如何将此解决方案调整为他自己的代码。这是我的猜测（因为他的源 XML 文档不是所提供的链接所指向的文档，我无法猜测真正的 XML 文档是什么）：

```
<tr>
    <xsl:for-each select="Settings/Groups/Recording">
        <tr>
            <td class="title_column">Frame Rate</td>
            <td>
          <xsl:value-of select=
           "concat(translate(substring(RecOutLinkSpeed,1,1), '_', '&#xA0;'),
                   translate(substring(RecOutLinkSpeed,2), '_', '.')
                  )
           "/>
            </td>
        </tr>
    </xsl:for-each>
</tr> 
```

# ruby-on-rails - 存储在实例变量中，每个块结果 ruby

> ID：11160910
> 
> 赞同：0
> 
> 时间：2012-06-22T17:06:24.497
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

这句话`b.followees_by_type("biscuit")`返回如下内容：

```
=> [#<Biscuit _id: 4fdf5aa11d41c829ea000020, _type: "Biscuit", created_at: 2012-06-18 16:43:13 UTC, title: "biscuit biscuit", is_complete: true>, #<Biscuit _id: 4fdf5aa11d41c829ea000021, _type: "Biscuit", created_at: 2012-06-18 17:40:10 UTC, title: "biscuit2 biscuit2", is_complete: true> ] 
```

**可以退回一个或多个饼干。**

我想在一个实例变量`@biscuits`中添加，我从这个块的每个循环中得到的所有饼干：

```
boards.each do |b| 
  b.followees_by_type("biscuit")
end 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:12:02.533

使用[Enumerable#flat_map](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-flat_map)：

```
@biscuits = boards.flat_map {|b| b.followees_by_type('biscuit') } 
```

# android - 无需输入每个条目即可填充字符串数组

> ID：11160918
> 
> 赞同：0
> 
> 时间：2012-06-22T17:06:47.103
> 
> 标签：android, arrays

我正在我当前的布局文件中创建一个微调器，这个微调器的内容范围从 1.0 mA，一直到 100.0mA。每个增量增加 0.1 mA。除了在我的字符串数组文件中手动输入每个条目之外，有没有办法让某种循环来填充这个字符串数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:17:21.060

您可以使用 BigDecimal 来执行此操作。这是一个从 1.0 到 3.0 将它们打印到屏幕上的示例。您可以根据需要进行调整。

通过使用 BigDecimal，您将不会在内部或外部出现舍入错误，这意味着如果您将其扩展到更大的数字，您将不会遇到这些问题。Big Decimal 就是为这种事情而设计的。

```
import java.util.*;
import java.math.*;
class Amps {
    public static void main(String[] args) {
        List<String> strs = new ArrayList<String>();
        BigDecimal max = new BigDecimal("3.0");
        BigDecimal inc = new BigDecimal("0.1");
        for(BigDecimal cur = new BigDecimal("1.0"); cur.compareTo(max) <= 0; cur = cur.add(inc)) {
            strs.add(cur.toString() + "mA");
        }
        System.out.println(strs);
    }

} 
```

如果您想知道速度，使用 BigDecimal 实际上比使用格式化程序更快。这是一个小测试，它来回运行它们，样本大小约为 1,000,000 个字符串：

```
import java.math.*;
import java.text.*;
import java.util.*;
class Amps {
    public static void main(String[] args) {
        usingBig();
        usingPrim();
        usingBig();
        usingPrim();
        usingBig();
        usingPrim();
        usingBig();
        usingPrim();
        usingBig();
        usingPrim();
    }

    static void usingBig() {
        long then = System.currentTimeMillis();
        List<String> strs = new ArrayList<String>(1000000);
        BigDecimal max = new BigDecimal("100000.0");
        BigDecimal inc = new BigDecimal("0.1");
        for(BigDecimal cur = new BigDecimal("1.0"); cur.compareTo(max) <= 0; cur = cur.add(inc)) {
            strs.add(cur.toString() + "mA");
        }
        long now = System.currentTimeMillis();
        System.out.println("Big: " + (now - then));
    }

    static void usingPrim() {
        long then = System.currentTimeMillis();
        DecimalFormat formatter = new DecimalFormat("0.0");
        List<String> strs = new ArrayList<String>(1000000);
        float max = 100000.0f;
        float inc = 0.1f;
        for(float cur = 1.0f; cur <= max; cur += inc) {
            strs.add(formatter.format(cur) + "mA");
        }
        long now = System.currentTimeMillis();
        System.out.println("Prim: " + (now - then));
    }

} 
```

结果是：

```
C:\files\j>java Amps
Big: 1344
Prim: 5172
Big: 1047
Prim: 4656
Big: 1172
Prim: 4531
Big: 1125
Prim: 4453
Big: 1141
Prim: 4547 
```

即使没有 DecimalFormatter，原语仍然比 BigDecimal 慢。如果我注释掉 DecimalFormatter 及其格式调用（使用而不是`cur + "mA"`添加到列表中），请参见下面的结果。

```
C:\files\j>java Amps
Big: 1328
Prim: 1469
Big: 1093
Prim: 1438
Big: 1375
Prim: 1562
Big: 1204
Prim: 1500
Big: 1109
Prim: 1469 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T17:10:18.820

创建一个 SpinnerAdapter 并将其连接到您的微调器。然后你可以循环调用adapter.add(item1)、adapter.add(item2)等...

另请查看：[如何将项目添加到 Android 中的微调器？](https://stackoverflow.com/questions/5241660/how-can-i-add-items-to-a-spinner-in-android)

例如，

```
Spinner spinner = (Spinner) findViewById(R.id.spinner);

ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, YOUR_STRING_ARRAY);

adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

spinner.setAdapter(adapter); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T17:11:06.150

当然可以：

```
String[] data = new String[991];

int i = 0;
for(float f=1.0f; f<=100.0f; f+=0.1f) {
    data[i++] = "" + f + "A";
} 
```

**编辑：**如果你想把这个数组放在你的 XML 文件中，你可以使用任何你想一次性生成这个数组的编程语言。例如，这个 java 代码将为您完成繁重的工作：

```
import java.text.*;
public class T {
  public static void main(String[] args) {
  DecimalFormat formatter = new DecimalFormat("0.0");

    for(float f=1.0f; f<=100.0f; f+=0.1f) {
      System.out.println("\"" + formatter.format(f) + "A\",");
    }
  }
} 
```

编译/运行它：`javac T.java`后跟`java T > output.txt`. 现在`output.txt`在文本编辑器中打开文件并复制/粘贴您的数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-22T17:11:06.580

```
List<String> list = new ArrayList<String>(); 
```

现在使用`for loop you can add data in list and set list to spinner..`

```
for(float value=1.0f;value<100.0f;){
        String str = String.valueOf(value);
        list.add(value+"mA");
          value+=0.1f;       
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-22T18:07:59.320

你必须实现一个 SpinnerAdapter 类，类似于这个：

```
public class MySpinnerAdapter implements SpinnerAdapter {
   private List<String> steps = new ArrayList<String>();
   public MySpinnerAdapter(double min,double max,double increment) {
      for(double f=min;f < max;f+=increment) steps.add(String.valueOf(f)+" mA");
   }
   public int getCount() {
      return steps.size();
   }
   public View getView(int position, View convertView, ViewGroup parent) {
      TextView t = new TextView(YourActivity.this);
      t.setText(steps.get(position));
      return t;
   }
   public boolean isEmpty() {
      return (steps.size() == 0);
   }
   public View getDropDownView(int position, View convertView,ViewGroup paret) {
      if(convertView != null) return(convertView);
      return(getView(position,convertView,parent));
   }
   public Object getItem(int position) {
      return(steps.get(position));
   }
   public long getItemId(int position) {
      return position;
   }
   public int getItemViewType(int position) {
      return 0;
   }
   public int getViewTypeCount() {
      return 1;
   }
   public boolean hasStableIds() {
      return true;
   }
   public void registerDataSetObserver(DataSetObserver observer) {
   }
   public void unregisterDataSetObserver(DataSetObserver observer) {
   }
} 
```

然后你必须在你的 Spinner 中设置这个类的一个新实例：

```
Spinner s = (Spinner) findViewById(R.id.YourSpinnerId);
s.setAdapter(new MySpinnerAdapter(1.0,100.0,0.1)); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-22T17:13:17.333

尝试生成字符串的循环

```
List<String> list = new ArrayList<String>();
int endCount = (100\. - 1.0) / .1
For(int i = 0; i < endCount; i++){

    String stringToAdd = String.format("%.1f mA", 1.0 + ((float)i * 0.1));

    // Add stringToAdd to your array
    list.add(stringToAdd);
} 
```

# netty - 使用 DelimiterBasedFrameDecoder 可变的服务器性能

> ID：11160920
> 
> 赞同：1
> 
> 时间：2012-06-22T17:06:53.693
> 
> 标签：netty

我有一个服务器读取入站换行符分隔的字符串。管道如下所示：

```
 ...
    pipeline.addLast("framer",
        new DelimiterBasedFrameDecoder(65535, Delimiters.lineDelimiter()));

    // plain old strings
    pipeline.addLast("decoder", new StringDecoder());

    // callback to handler
    pipeline.addLast("handler", new ConnectorHandler(collector));
    ... 
```

当我将解码器更改为以下内容时：

```
 pipeline.addLast("framer", 
        new DelimiterBasedFrameDecoder(65535, 
            new ChannelBuffer[] { ChannelBuffers.wrappedBuffer(
                new byte[] {'\n'})})); 
```

我的服务器速度提高了 3-4 倍。我不明白为什么会这样。入站字符串的长度在 1K-4K 之间变化，大约 10K 字符串/秒。查看源代码，它似乎循环遍历所有定界符以找到产生最小帧长度的定界符 - 通过检查，我看不出只寻找一个定界符会比寻找两个分隔符。我很想尝试编写自己的解码器，但我想了解这里发生了什么。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T18:31:21.300

就是这样..只找一个便宜得多。

# image - 强大的 PHP 图像上传

> ID：11160923
> 
> 赞同：0
> 
> 时间：2012-06-22T17:07:00.393
> 
> 标签：image, upload

我正在构建处理图像上传（在 PHP 中）的解决方案的一部分 - 我已经阅读了一些关于可以找到漏洞利用的方法，我想防止所有他们。

考虑到这一点，验证图像上传并确保它们安全的最可靠的方法是什么（/不能对服务器造成任何损坏？）。不幸的是，将图像存储在 HTTP 可访问区域之外是不可能的，因为它是一个共享主机。

图像将通过邮寄表格发送到服务器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:22:58.103

是的，您是对的，您必须检查上传的图像是图像还是任何损坏服务器的脚本。
为此，您可以检查**图像的标题信息** 是否为有效图像。
如果是有效图像，则进行进一步处理。
为此，您还可以检查“exif 信息”。

# facebook - 站点 URL 参数：http 与 https

> ID：11160927
> 
> 赞同：1
> 
> 时间：2012-06-22T17:07:11.813
> 
> 标签：facebook, fb.ui

我遇到了一个问题，即必须在 Facebook 应用程序设置中的站点 URL 参数中选择 http 或 https 作为方案。

在调用 FB.ui 时，SDK 会自行发送一个“origin”参数，该参数具有当前页面的域。如果此源域与应用设置中的站点 URl 参数不匹配，则会引发“无效重定向 uri”错误。我们调用的页面不安全 (http)，但我们的站点 URL 设置为 https，因为我们在安全登录页面 (https) 上使用 FB 连接。

我们希望避免将这些无关的 FB.ui 页面也设为 https 的开销，但据我们所知，我们无法指定多个站点 URL（以同时考虑 http 和 https）。

有没有好的解决方案？也许是一种“阻止”或修改 FB.ui 发送的原始参数的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T03:31:41.787

您还可以通过 REST 或 Open Graph API 以编程方式设置安全画布 URL 的参数。

**财产** `secure_canvas_url`

REST - [https://developers.facebook.com/docs/appproperties/](https://developers.facebook.com/docs/appproperties/)

开放图 - [https://developers.facebook.com/docs/reference/api/application/#props](https://developers.facebook.com/docs/reference/api/application/#props)

请注意以下关于 FBML 应用程序上的 HTTPS

***FBML 应用程序***

> 我们听说对于 FBML 应用程序是否必须支持 HTTPS 存在一些混淆。FBML 开发人员仍然需要知道用户是否通过安全连接浏览 Facebook，因为他们需要检测是否通过 HTTPS 提供 iframe 或视频内容。因此，FBML 应用程序必须获得 SSL 证书才能向通过安全连接浏览的用户提供此类内容。如果您有 FBML 应用程序，请为您的应用程序获取 SSL 证书，以接收来自通过安全连接浏览 Facebook 的用户的流量。
> 
> 如果您为 FBML 应用启用 SSL，请确保您的 SSL 证书包含信任链中的所有中间证书，因为我们的 SSL 验证非常严格。您可以使用第三方 SSL 分析工具（例如[https://www.ssllabs.com/index.html](https://www.ssllabs.com/index.html)）检查您的证书状态并修复任何错误（和警告）。如果您的 SSL 证书有问题，您可能会在加载 FBML 画布应用程序时看到“收到空响应”错误。

有关完整说明，请参阅以下内容

[http://developers.facebook.com/blog/post/567/](http://developers.facebook.com/blog/post/567/)

在所有其他方法都失败之前，请在应用程序设置中将您的应用程序标记为画布应用程序（即使它在技术上不是画布应用程序）。并设置一个 https 网址。这可以在必须以编程方式解决之前解决任何与 https 相关的问题。

# powershell - powershell逗号问题

> ID：11160931
> 
> 赞同：9
> 
> 时间：2012-06-22T17:07:40.787
> 
> 标签：powershell, wmic

我正在尝试编写一个非常简短的 powershell 脚本，它运行一些命令，将它们的输出通过管道传输到文本文件，然后对关键字进行搜索。

我无法弄清楚这条线要改变什么：

```
wmic service get name, startname | out-File "$pwd\admin\wmic.txt"

WMIC.exe : Invalid GET Expression.
At \\test.ps1:7 char:5
+ wmic <<<<  service get name startname | out-File "$pwd\admin\wmic.txt"
+ CategoryInfo          : NotSpecified: (Invalid GET Expression.:String) [], RemoteException
+ FullyQualifiedErrorId : NativeCommandError 
```

我相信错误是由“，”产生的，因为 powershell 使用逗号创建一个数组。有什么想法或建议吗？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-09-24T01:23:23.133

```
wmic service get name"," startname| out-File "$pwd\admin\wmic.txt" 
```

这很容易解决逗号，根本没有变化。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-07-06T22:45:49.517

从 PowerShell 3.0 开始，可以使用新的转义运算符`--%`（请参阅[发行说明](https://devblogs.microsoft.com/powershell/new-v3-language-features/)中的*​​魔术参数*）：

```
wmic --% service get name, startname | out-File "$pwd\admin\wmic.txt" 
```

此运算符称为*停止解析*运算符，它指示 PowerShell 从该点开始停止将输入解释为 PowerShell 命令或表达式（请参阅[此处](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_parsing?view=powershell-7.1)的文档）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T17:49:47.713

这个问题的答案在于使用 Start-Process cmdlet。这将使命令行参数的解释更加容易，因为您还可以提前构造命令行参数，将它们存储在变量中，然后使用变量名称引用它们。

```
$WmicArgs = 'service get name, startname';
Start-Process -FilePath wmic.exe -ArgumentList $WmicArgs; 
```

但是，你为什么还要使用 WMIC.exe？

使用 WMI 有更简单的方法，例如使用 PowerShell 类型加速器 [wmi]、[wmiclass]、[wmisearcher] 和 Get-WmiObject cmdlet。

# javascript - 用于编辑（和保存）XML 文件的 Javascript 插件？

> ID：11160938
> 
> 赞同：1
> 
> 时间：2012-06-22T17:08:17.933
> 
> 标签：javascript, xml, plugins, wysiwyg, client-side

是否可以使用 JavaScript 插件从运行它的同一服务器和目录打开和保存 XML 文件？我对 JavaScript 没有任何经验，而且对它的功能一无所知。

我试图为用户提供通过浏览器编辑基于 XML 的配置文件的能力。基于浏览器的编辑器（例如 CodeMirror 和 ACE）似乎非常适合这种情况，但它们能否从文件中读取 XML 格式然后将其保存回来？

在这种情况下，服务器端代码是不可能的。这个简单的插件（如果完成）将上传到 SharePoint 2003 服务器并通过 IFrame 包含在网页中（带有限制性 CMS）。

我已经看到一个 JQuery 插件，一位同事通过这种方法（托管在 SharePoint 上，与 n iFrame 链接）添加到页面中，因此 JQuery 也可能是一种可能性。

如果在基于 Web 的编辑器中也可以进行模式验证，那也很有用。

预先感谢您的建议。

编辑：可以访问此页面的任何人也可以访问托管它（以及他们要编辑的 XML 文件）的 SharePoint 服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:14:53.420

不可以。客户端代码不能写在服务器上。

你需要一个服务器脚本来做到这一点（想象一下，如果有人能够自由地写入服务器，那将是一场安全噩梦）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T17:23:38.607

正如 AlfonsoML[所说](https://stackoverflow.com/a/11161049/586621)，您不能在客户端执行此操作，而必须在服务器端执行此操作。

您可以使用 JQuery 进行 Ajax 调用以从服务器获取 XML，如本文[所示](http://think2loud.com/224-reading-xml-with-jquery/)。如果要将 XML 内容发送回服务器以保存它，则必须再次使用 Ajax。

# python - 使用 out.write() 将整数值写入文件

> ID：11160939
> 
> 赞同：26
> 
> 时间：2012-06-22T17:08:18.570
> 
> 标签：python

我正在生成一些数字（比如说，num）并将数字写入输出文件，`outf.write(num).`
但编译器抛出错误：

```
"outf.write(num)  
TypeError: argument 1 must be string or read-only character buffer, not int". 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-06-22T17:10:41.220

[write()](http://docs.python.org/library/stdtypes.html?highlight=write#file.write)只接受一个*字符串*参数，所以你可以这样做：

```
outf.write(str(num)) 
```

或者

```
outf.write('{}'.format(num))  # more "modern"
outf.write('%d' % num)        # deprecated mostly 
```

另请注意，它`write`不会在您的输出中附加换行符，因此如果您需要它，您必须自己提供。

**旁白**：

使用字符串格式可以让你更好地控制你的输出，所以例如你可以写（这两个是等价的）：

```
num = 7
outf.write('{:03d}\n'.format(num))

num = 12
outf.write('%03d\n' % num) 
```

获得三个空格，整数值前导零，后跟换行符：

```
007
012 
```

[format()](http://docs.python.org/library/string.html#format-string-syntax)将存在很长时间，因此值得学习/了解。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T17:12:34.957

这些中的任何一个都应该有效

```
outf.write("%s" % num)

outf.write(str(num))

print >> outf, num 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-26T13:33:42.127

```
i = Your_int_value 
```

像这样写字节值，例如：

```
the_file.write(i.to_bytes(2,"little")) 
```

取决于您的 int 值大小和您喜欢的位顺序

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-19T21:37:22.787

您也可以使用 f-string 格式将整数写入文件

对于附加使用以下代码，用于编写一次将 'a' 替换为 'w'。

```
for i in s_list:
    with open('path_to_file','a') as file:
        file.write(f'{i}\n')

file.close() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-04-21T08:07:29.127

```
f = open ('file1.txt','a') ##you can also write here 'w' for create or writing into file
while True :
    no = int(input("enter a number (0 for exit)"))
    if no == 0 :
        print("you entered zero(0) ....... \nnow you are exit  !!!!!!!!!!!")
        break
    else :
        f.write(str(no)+"\n")

f.close()

f1 = open ('Ass1.txt','r')

print("\n content of file :: \n",f1.read())

f1.close() 
```

# json - 尝试减小 JSON 大小是否值得？

> ID：11160941
> 
> 赞同：27
> 
> 时间：2012-06-22T17:08:23.687
> 
> 标签：json, performance, http, bandwidth

我从移动应用程序（最多 1000 个 JSON 对象）提交了相对大量的数据，我通常会像这样编码：

```
[{
    id: 12,
    score: 34,
    interval: 5678,
    sub: 9012
}, {
    id: ...
}, ...] 
```

我可以通过提交数组数组来减小有效负载：

```
[[12, 34, 5678, 9012], [...], ...] 
```

在属性名称上节省一些空间，并在服务器上重新创建对象（因为模式是固定的，或者至少它是服务器和客户端之间的合同）。

然后在`POST`请求中提交有效负载，很可能通过 3G 连接（或可能是 wifi）。

看起来我通过使用嵌套数组节省了一些带宽，但我不确定应用*gzip*时它是否明显，我不确定如何精确和客观地测量差异。

另一方面，嵌套数组*感觉*不是一个好主意：它们的可读性较差，因此在调试时更难发现错误。此外，由于我们将可读性冲到马桶上，我们可以将数组展平，因为每个子数组都有固定数量的元素，服务器可以将其切分并再次重建对象。

非常感谢有关此主题的任何进一步阅读材料。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-03T00:38:19.200

JSONH，又名 hpack，[https:](https://github.com/WebReflection/JSONH) //github.com/WebReflection/JSONH与您的示例非常相似：

```
[{
    id: 12,
    score: 34,
    interval: 5678,
    sub: 9012
}, {
    id: 98,
    score: 76,
    interval: 5432,
    sub: 1098
}, ...] 
```

会变成：

```
[["id","score","interval","sub"],12,34,5678,9012,98,76,5432,1098,...] 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-22T17:13:12.267

JSON 旨在提高可读性。如果您担心空间，您可以使用中间格式。创建一个序列化/反序列化函数，该函数接受一个 JSON 文件并创建一个压缩二进制文件，尽可能紧凑地存储您的数据，然后在该行的另一端读取该格式。

请参阅：[http](http://en.wikipedia.org/wiki/Json) ://en.wikipedia.org/wiki/Json 第一句话：“JSON……是一种轻量级的基于文本的开放标准，专为人类可读的数据交换而设计。”

本质上，我的观点是人类总是会看到 JSON，而机器主要会看到二进制文件。您将获得两全其美：可读性和小数据传输（以少量计算为代价）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-06-22T17:18:50.183

Gzip 将使用对第一次出现的小反向引用替换您的消息的重复部分。该算法非常“愚蠢”，但对于这种重复数据来说它很棒。我认为您不会看到线上大小的明显减小，因为您的对象“结构”仅发送一次。

您可以通过压缩两个示例 JSON 来粗略地测试这一点。或者通过使用 Fiddler 捕获 HTTP 请求。它可以显示压缩和未压缩的大小。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-04-09T02:42:42.573

虽然是个老问题，但我还是想说几句。

根据我的经验，json 原始大小的巨大差异，压缩后的数量很少。我更喜欢让它保持人类可读性。

实际数字：1,29MB 的 json 文件和 145KB 的优化版本，压缩后分别为 32KB 和 9KB。

除了在极端条件下，我认为这种差异可以忽略不计，可读性的成本是巨大的。

A：

```
{
  "Code": "FCEB97B6",
  "Date": "\/Date(1437706800000)\/",
  "TotalQuantity": 1,
  "Items": [
    {
      "CapsulesQuantity": 0,
      "Quantity": 1,
      "CurrentItem": {
        "ItemId": "SHIELD_AXA",
        "Order": 30,
        "GroupId": "G_MODS",
        "TypeId": "T_SHIELDS",
        "Level": 0,
        "Rarity": "R4",
        "UniqueId": null,
        "Name": "AXA Shield"
      }
    }
  ],
  "FormattedDate": "2015-Jul.-24"
} 
```

乙：

```
{
  "fDate": "2016-Mar.-01",
  "totCaps": 9,
  "totIts": 14,
  "rDays": 1,
  "avg": "1,56",
  "cells": {
    "00": {
      "30": 1
    },
    "03": {
      "30": 1
    },
    "08": {
      "25": 1
    },
    "09": {
      "26": 3
    },
    "12": {
      "39": 1
    },
    "14": {
      "33": 1
    },
    "17": {
      "40": 3
    },
    "19": {
      "41": 2
    },
    "20": {
      "41": 1
    }
  }
} 
```

这是两个文件的片段。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-06-22T17:24:21.300

由于您在移动设备上使用它（您提到了 3G），您可能实际上想要关心大小，而不是可读性。此外，您是否经常希望阅读通过网络传输的内容？

这是对替代形式的建议。

[ProtoBuf](https://developers.google.com/protocol-buffers/)是一种选择。Google 在内部使用它，并且有一个 ProtoBuf “编译器”，它可以读取`.proto`文件（包含消息描述）并生成**Java/C++/Python**序列化器/反序列化器，它们使用二进制形式通过网络传输。您只需在两端使用生成的类，而忘记通过网络传输时对象的外观。还有一个[外部维护的 Obj-C 端口](http://code.google.com/p/metasyntactic/wiki/ProtocolBuffers)。

这是[ProtoBuf 与 XML](https://developers.google.com/protocol-buffers/docs/overview#whynotxml)的比较，在 ProtoBuf 网站上（我知道 XML 不是你使用的，仍然）。

最后，这是一个[Python 教程](https://developers.google.com/protocol-buffers/docs/pythontutorial)。

# http - 停止由代理或反向代理缓冲的流式 Comet 连接？

> ID：11160946
> 
> 赞同：0
> 
> 时间：2012-06-22T17:09:00.647
> 
> 标签：http, proxy, comet, reverse-proxy, grizzly

我有一个类似聊天的应用程序，它使用 Glassfish 中的 Grizzly Comet 和 HTTP 流（“永远的 iframe”）技术。当浏览器直接连接时它可以工作，但如果它们之间有反向代理则不能。似乎反向代理正在缓冲 Javascript Comet 事件流 - 如果您在 Chrome 中打开代理的 Comet 事件流 URL，您可以看到没有收到任何内容。

如何禁用此缓冲？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T08:18:15.260

代替

```
response.setContentType("text/html"); 
```

做

```
response.getWriter().println("<!DOCTYPE html>"); 
```

在向响应作者写任何其他内容之前。

我不认为这是在任何地方指定的，但与浏览器相比，我基本上依赖于代理的愚蠢性。

# javascript - 如何知道 JQuery 是否已完成加载

> ID：11160948
> 
> 赞同：4
> 
> 时间：2012-06-22T17:09:13.420
> 
> 标签：javascript, jquery

在某些情况下，我需要使用这样的一段 javascript 加载 jQuery：

```
 <script type="text/javascript">
    if (typeof jQuery == 'undefined') 
    {
    var script = document.createElement('script');
    script.type = "text/javascript";
    script.src = "https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js";
    document.getElementsByTagName('head')[0].appendChild(script);
    }
 </script> 
```

但是我怎么知道 JQuery 已经完成加载以便我可以使用它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T17:14:44.013

您将不得不编写代码来检测何时加载动态加载的脚本，不幸的是，它在一些旧浏览器中的工作方式略有不同，因此它并不像它可能的那么简单。这是一篇关于如何做到这一点的很好的参考文章：[http ://www.ejeliot.com/blog/109](http://www.ejeliot.com/blog/109)

以下是那篇文章中的一些代码：

```
function loadScript(sScriptSrc, oCallback) {

    var oHead = document.getElementsByTagName('head')[0];
    var oScript = document.createElement('script');

    // make sure callback isn't run more than once
    function runCallback() {
        if (oCallback) {
            oCallback();
            oScript.onload = oScript.onreadystatechange = null;
            oCallback = null;
        }
    }

    oScript.type = 'text/javascript';
    // most browsers
    oScript.onload = runCallback;
    // IE 6 & 7
    oScript.onreadystatechange = function() {
        if (this.readyState === 'complete') {
            runCallback();
        }
    }
    oScript.src = sScriptSrc;
    oHead.appendChild(oScript);
} 
```

或者，您可以使用其中一个为您工作的小型库。您可以在此处查看其中的一些列表：http: [//microjs.com/#loader](http://microjs.com/#loader)。虽然我不确定您是否想使用另一个库来帮助加载您的主库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T17:15:37.050

尝试`onload`事件：

```
 //.....
 script.onload = function(){
     alert('jQuery is loaded succesfully').
 };
 script.src = "https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T17:18:55.863

感谢jfriend的回答。回调很性感。

第二次破解它。

```
function loadJQ(callback) {
  if(!window.jQuery) {
    // Create jQuery script element.
    var script = document.createElement('script');
    script.type = 'text/javascript';
    script.src = 'path/to/jquery.js';
    document.body.appendChild(script);

    script.onload = function(){ callback(jQuery); };
    // IE 6 & 7 ala jfriend00
    script.onreadystatechange = function() {
      if (this.readyState == 'complete') callback(jQuery);
    }
  } else {
    callback(jQuery);
  }
} 
```

调用

```
loadJQ(function($){
  alert($ === jQuery); // true. jquery is loaded.
}); 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-06-22T17:11:34.650

你可以把代码放进去

```
$(document).ready(function() {
   // Handler for .ready() called.
}); 
```

以下是文档：[http ://api.jquery.com/ready/](http://api.jquery.com/ready/)

编辑：猜猜我的问题错了。所以我无法回答如何查看它的加载，但可以提供另一种加载库的方法。

```
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script>window.jQuery || document.write("\x3Cscript src=\"path/to/js/jquery-1.7.1.min.js') }}\">\x3C/script>")</script> 
```

如果 google api 不可用，这里会加载本地版本的 jQuery。比上面的片段应该足够安全，知道 jQuery 已加载。

# mysql - 将动态值发送到 mysql 数据库时出错

> ID：11160950
> 
> 赞同：-1
> 
> 时间：2012-06-22T17:09:19.690
> 
> 标签：mysql

我正在尝试制作一个出席表格，但 from 包含从另一个 mysql 表调用的值，我要发送的表格是

```
<?php require_once('Connections/db.php'); ?>
<?php

$result = mysql_query("SELECT id,Name,Roll_No FROM examination_creg WHERE attendence='1'");

echo "<form  method=POST action=send.php >";
echo "<table border='1'>
<tr>
<th>Name</th>
<th>Roll_No</th>
<th>Present</th>
</tr>";

while($row = mysql_fetch_array($result))
  {
  echo "<tr>";
  echo "<td>" . "<input type=text name=std_name value=".$row['Name']." readonly=readonly     />" . "</td>";
    echo "<td>" . "<input type=text name=std_roll value=".$row['Roll_No']." readonly=readonly />" . "</td>";

echo "<td>" . "<Select name=present>
<option>Yes</option>
<option>No</option>
</select>" . "</td>";

  echo "</tr>";

  }
echo "</table>";
   echo "<td>" . "<input type=submit name=send value=Submit />" . "</td>";
echo "</form>";

?> 
```

文件 send.php 是

```
<?php 
$name=$_POST['std_name'];
$roll=$_POST['std_roll'];
$present=$_POST['present'];
echo $name;
echo $roll;
echo $present;

?> 
```

我只是在这里打印这些值以了解问题

在第一个代码中，值名称，roll no 来自 mysql 表，其中 id=1 当我发送表单时它只打印最后一个字段上的单个值？？？此处未打印剩余数据，因此如果变量不包含数据，数据将如何存储在数据库中，因此请 尽早
帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:37:45.027

也许您的 send.php 只接收一个值的原因是因为它来自您的一个且唯一的可写字段，而您的前两个文本字段具有以下属性：

```
readonly=readonly 
```

尝试删除该属性。

# java - Java中For循环中的GoTo Next迭代

> ID：11160952
> 
> 赞同：204
> 
> 时间：2012-06-22T17:09:27.927
> 
> 标签：java, for-loop

java中是否有一个标记跳过了for循环的其余部分？类似[VB的Continue](http://msdn.microsoft.com/en-us/library/801hyx6f.aspx) in java。

* * *

## 回答 #1

> 赞同：390
> 
> 时间：2012-06-22T17:10:16.560

```
continue; 
```

`continue;`关键字将在调用时开始下一次迭代

**例如**

```
for(int i= 0 ; i < 5; i++){
 if(i==2){
  continue;
 }
System.out.print(i);
} 
```

这将打印

```
0134 
```

* * *

**看**

*   [文档](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html)

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2012-06-22T17:12:40.400

试试这个，

1.  如果要跳过特定迭代，请使用`continue`.

2.  如果要跳出立即循环，请使用`break`

3.  如果有 2 个循环，外部和内部......并且您想从内部循环中跳出两个循环，请使用 break with [label](https://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html)（[关于 label 的另一个问题](https://stackoverflow.com/questions/14960419/is-using-a-labeled-break-a-good-practice-in-java)）。

* * *

例子：

**继续**

```
for(int i=0 ; i<5 ; i++){

    if (i==2){

      continue;
    }
 } 
```

**休息**

```
for(int i=0 ; i<5 ; i++){

        if (i==2){

          break;
        }
     } 
```

**打破标签**

```
lab1: for(int j=0 ; j<5 ; j++){
     for(int i=0 ; i<5 ; i++){

        if (i==2){

          break lab1;
        }
     }
  } 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2013-10-25T20:58:01.130

**如果要跳过当前迭代，请使用`continue;`.**

```
for(int i = 0; i < 5; i++){
    if (i == 2){
        continue;
    }
 } 
```

**需要打破整个循环？采用`break;`**

```
for(int i = 0; i < 5; i++){
    if (i == 2){
        break;
    }
} 
```

**如果您需要跳出多个循环，请使用`break someLabel;`**

```
outerLoop:                                           // Label the loop
for(int j = 0; j < 5; j++){
     for(int i = 0; i < 5; i++){
        if (i==2){
          break outerLoop;
        }
     }
  } 
```

*请注意，在这种情况下，您不是在代码中标记要跳转到的点，而是在标记循环！所以在 break 之后，代码将在循环之后继续！

**当您需要在嵌套循环中跳过一次迭代时，请使用`continue someLabel;`，但您也可以将它们全部组合起来。**

```
outerLoop:
for(int j = 0; j < 10; j++){
     innerLoop:
     for(int i = 0; i < 10; i++){
        if (i + j == 2){
          continue innerLoop;
        }
        if (i + j == 4){
          continue outerLoop;
        }
        if (i + j == 6){
          break innerLoop;
        }
        if (i + j == 8){
          break outerLoop;
        }
     }
  } 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-06-22T17:21:04.280

正如所有其他答案中提到的，关键字`continue`将跳到当前迭代的末尾。

此外，您可以标记循环开始，然后使用`continue [labelname];`or`break [labelname];`来控制嵌套循环中发生的事情：

```
loop1: for (int i = 1; i < 10; i++) {
    loop2: for (int j = 1; j < 10; j++) {
        if (i + j == 10)
            continue loop1;

        System.out.print(j);
    }
    System.out.println();
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-22T17:10:54.927

使用`continue`关键字。[在这里](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html)阅读。

> continue 语句跳过 for、while 或 do-while 循环的当前迭代。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-22T17:12:14.973

使用[continue](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html)关键字。

**前任：**

```
for(int i = 0; i < 10; i++){
  if(i == 5){
    continue;
   }
} 
```

# ruby - 安装 gems 时，如何自动安装依赖项？

> ID：11160953
> 
> 赞同：1
> 
> 时间：2012-06-22T17:09:29.273
> 
> 标签：ruby, rubygems, gem

```
gem install mygem
ERROR:  Error installing mygem:
        mygem requires mygem-adapter (>= 0, runtime) 
```

我想知道当我想安装 gem 时是否有一种简单的方法可以自动安装依赖的 gem？类似的东西`gem install mygem -with_dependancies`。这样的事情可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:25:05.407

`gem`没有找到该依赖项，因为它仅从已安装的 gems 和 ruby​​gems.org 中提取依赖项。您需要：

添加您自己的 gem 源，因为您的 gem 可能不在 ruby​​gems.org 上（默认）

```
gem install your-gem --source http://mygemserver.com 
```

或者

```
 gem install /path/to/mygem.gem 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-22T17:18:32.167

看看 Bundler (http://gembundler.com) - 它简化了使用 gems 的工作。

# android - @id 和@+id 有什么区别？

> ID：11160954
> 
> 赞同：43
> 
> 时间：2012-06-22T17:09:33.610
> 
> 标签：android, xml

我刚开始使用 android，完成了大约 5 个布局文件。但是，我刚刚意识到我一直在交替使用@id 和@+id，但我不确定两者之间的确切区别是什么。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-06-22T17:13:08.897

`@+id`在为视图定义自己的 Id 时需要使用。

完全来自**文档**：

> 字符串开头的符号 (@) 表示 XML 解析器应该解析和扩展 ID 字符串的其余部分，并将其标识为 ID 资源。加号 (+) 表示这是一个新资源名称，必须创建并添加到我们的资源中（在 R.java 文件中）。Android 框架提供了许多其他 ID 资源。引用 Android 资源 ID 时，不需要加号，但必须添加 android 包命名空间。

这是一个实际的例子：

```
<Button 
   android:id="@+id/start"
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
/>

<Button 
   android:id="@+id/check"
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
   android:layout_below="@id/start"
/> 
```

所以在这里，您创建了两个`IDs`，启动和检查。然后，在您的应用程序中，您可以使用`findViewById(R.id.start)`.

这`android:layout_below="@id/start"`指的是现有的`id.start`，意味着您的`Button`带有 id的**检查**将位于`Button`带有 id **start**的下方。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-10-13T17:06:37.760

所有其他答案都忘了提到这件小事。

当使用**@id/**来引用已经生成的android 资源时，请确保您所引用的资源是在之前而不是之后定义的。

那不是这个：

```
<Button 
 android:id="@+id/check"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 android:layout_below="@id/start" 
 />
<Button 
 android:id="@+id/start"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 /> 
```

用这个：

```
<Button 
 android:id="@+id/start"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 />
<Button 
 android:id="@+id/check"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 android:layout_below="@id/start"
 /> 
```

在第一个示例中，您指的是在您访问它之后生成的资源**@id/start 。**虽然这适用于原生 android，但如果您要在 react-native 或 ionic 或任何其他混合平台中使用此代码，则会产生资源未找到错误。

**所以在使用它作为@id/**之前要小心生成资源id

 *** * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-13T15:24:28.840

有时您必须使用 + 号。例如，当您使用时`<include ... />`，包含的文件如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<android.support.design.widget.FloatingActionButton xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    (...)
    app:layout_anchor="@+id/view_pager"
    app:layout_anchorGravity="top|right|end"
 /> 
```

如果您不添加`+`，`"@+id/view_pager"`您将在构建项目时出错：

```
Error:(9, 24) No resource found that matches the given name (at 'layout_anchor' with value '@id/view_pager'). 
```

它发生在我的图书馆项目中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-03T03:57:28.090

***android:id="@+id/my_button"***

+id 加 sing 告诉 android 在 Resources 中添加或创建一个新的 id。

***android:layout_below="@id/my_button"***

它只是帮助参考已经生成的 id ..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-18T00:51:18.467

为了访问 Java 中的小部件（或组件）或使其他人依赖它，我们需要一个唯一的值来表示它。该唯一值由 android:id 属性提供，该属性实质上将作为 @+id/ 后缀提供的 id 添加到 id 资源文件中，以供其他人查询。Toolbar 的 id 可以这样定义，

```
android:id=”@+id/toolbar 
```

findViewById(…) 现在可以跟踪以下 id，它在 res 文件中查找它的 id，或者只是 R.id 目录并返回相关视图的类型。另一个 @id 的行为与 findViewById(...) 相同——通过提供的 id 查找组件，但仅保留用于布局。它最一般的用途是相对于它返回的组件放置一个组件。

```
android:layout_below=”@id/toolbar” 
```**

# javascript - 如何从文档中排除某些字段

> ID：11160955
> 
> 赞同：66
> 
> 时间：2012-06-22T17:09:36.403
> 
> 标签：javascript, mongodb, express, mongoose

我有以下简单的shema：

```
 var userSchema = new Schema({
    name : String,
   age: Number,
   _creator: Schema.ObjectId
  });

  var User = mongoose.model('User',userSchema); 
```

我想要做的是创建新文档并返回给客户端，但我想从一个中排除“创建者”字段：

```
app.post('/example.json', function (req, res) {
   var user = new User({name: 'John', age: 45, _creator: 'some ObjectId'});
   user.save(function (err) {
      if (err) throw err;

      res.json(200, {user: user});     // how to exclude the _creator field?
   });
}); 
```

最后，我想发送没有 _creator 字段的新创建用户：

```
{
   name: 'John',
   age: 45
} 
```

是否可以在没有额外查找请求的情况下制作猫鼬？

**PS**：最好是通过

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-06-23T06:41:59.000

在模式级别处理此问题的另一种方法是覆盖模型的 toJSON。

```
UserSchema.methods.toJSON = function() {
  var obj = this.toObject()
  delete obj.passwordHash
  return obj
} 
```

我遇到了这个问题，寻找一种从我提供给客户端的 json 中排除密码哈希的方法，并`select: false`破坏了我的 verifyPassword 函数，因为它根本没有从数据库中检索值。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2013-06-12T10:49:37.537

记录的方式是

```
UserSchema.set('toJSON', {
    transform: function(doc, ret, options) {
        delete ret.password;
        return ret;
    }
}); 
```

**更新 - 您可能想要使用白名单：**

```
UserSchema.set('toJSON', {
    transform: function(doc, ret, options) {
        var retJson = {
            email: ret.email,
            registered: ret.registered,
            modified: ret.modified
        };
        return retJson;
    }
}); 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-11-18T05:39:34.327

当我试图用 pymongo 找到类似的答案时，遇到了你的问题。事实证明，在 mongo shell 中，通过 find() 函数调用，您可以传递第二个参数，该参数指定结果文档的外观。当您传递属性值为 0 的字典时，您将在此查询产生的所有文档中排除此字段。

例如，在您的情况下，查询将类似于：

```
db.user.find({an_attr: a_value}, {_creator: 0}); 
```

它将为您排除 _creator 参数。

在 pymongo 中，find() 函数几乎相同。不知道它是如何转化为猫鼬的。与事后手动删除字段相比，我认为这是一个更好的解决方案。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2014-08-06T04:29:29.363

我会使用 lodash 实用程序[*.pick()*](http://lodash.com/docs#pick)*或*[。忽略（）](http://lodash.com/docs#omit)

```
var _ = require('lodash');

app.post('/example.json', function (req, res) {
    var user = new User({name: 'John', age: 45, _creator: 'some ObjectId'});
    user.save(function (err) {
        if (err) throw err;
        // Only get name and age properties
        var userFiltered = _.pick(user.toObject(), ['name', 'age']);
        res.json(200, {user: user});
    });
}); 
```

另一个例子是：

```
var _ = require('lodash');

app.post('/example.json', function (req, res) {
    var user = new User({name: 'John', age: 45, _creator: 'some ObjectId'});
    user.save(function (err) {
        if (err) throw err;
        // Remove _creator property
        var userFiltered = _.omit(user.toObject(), ['_creator']);
        res.json(200, {user: user});
    });
}); 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2012-06-22T17:16:35.073

您可以调用[`toObject()`](http://mongoosejs.com/docs/api.html#document_Document-toObject)文档将其转换为可以自由修改的纯 JS 对象：

```
user = user.toObject();
delete user._creator;
res.json(200, {user: user}); 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-11-22T10:46:19.750

通过遵循 MongoDB 文档，您可以通过将第二个参数传递给查询来排除字段，例如：

```
User.find({_id: req.user.id}, {password: 0})
        .then(users => {
          res.status(STATUS_OK).json(users);
        })
        .catch(error => res.status(STATUS_NOT_FOUND).json({error: error})); 
```

在这种情况下，密码将从查询中排除。

字体：[https ://docs.mongodb.com/v2.8/tutorial/project-fields-from-query-results/#return-all-but-the-excluded-field](https://docs.mongodb.com/v2.8/tutorial/project-fields-from-query-results/#return-all-but-the-excluded-field)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-08-26T19:06:01.423

我正在使用 Mongoosemask，对此非常满意。

它确实支持根据您的需要隐藏和公开具有其他名称的属性

[https://github.com/mccormicka/mongoosemask](https://github.com/mccormicka/mongoosemask)

var maskedModel = mongomask.mask(model, ['name', 'age']); //你就完成了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-23T18:30:15.517

您可以在**架构**文件本身上执行此操作。

```
// user.js
var userSchema = new Schema({
    name : String,
    age: Number,
   _creator: Schema.ObjectId
  });

userSchema.statics.toClientObject = function (user) {
  const userObject = user?.toObject();
  // Include fields that you want to send
  const clientObject = {
    name: userObject.name,
    age: userObject.age,
  };

  return clientObject;
};

var User = mongoose.model('User',userSchema); 
```

现在，在您响应客户端的**控制器方法中，执行以下操作**

```
return res.json({
    user: User.toClientObject(YOUR_ENTIRE_USER_DOC),
  }); 
```

# asp.net-mvc-3 - 无法在 ASP.NET MVC3 的部分视图中访问 ViewData

> ID：11160962
> 
> 赞同：5
> 
> 时间：2012-06-22T17:10:04.030
> 
> 标签：asp.net-mvc-3, partial-views, viewdata

我有一个控制器调用视图。在视图中有一个局部视图，插入如下：

```
@{ Html.RenderPartial("PartialViewName", this.Model);} 
```

这工作正常。

但是在控制器中，我希望在 ViewData 或 ViewBag 中放置一些我将在局部视图中使用的东西。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T17:24:16.103

你应该能够很好地做到这一点。View Bag 和 View Data 在 Action 方法的整个生命周期中都可用，因此如果您在获取视图的控制器方法中添加项目以查看数据，则在该视图上呈现的任何后续部分都可以访问视图数据. 从局部视图中的视图数据获取值的语法非常简单。例子：

```
 @{
       var variable = ViewData["My Key"];
   } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-22T17:17:42.273

Html.Partial 和 Html.RenderPartial 都有一个接受 ViewDataDictionary 的重载。您可以构建一个新的，或者简单地传递现有的。

```
@{ Html.RenderPartial("_MyPartial", Model.Property, new ViewDataDictionary { ... });} 
```

或者

```
@{ Html.RenderPartial("_MyPartial", Model.Property, ViewData);} 
```

我相当肯定 ViewBag 可供您的部分访问，而无需传递任何参数。

**编辑：**

ViewBag 和 ViewData 绝对可用于部分模板和编辑器/显示模板。您可以在从属视图访问它们之前在视图中编辑它们，如下所示：

```
@{ ViewBag.MyNewValue = "..."; }
@Html.Partial("_MyPartial", Model) 
```

然后在你的部分：

```
@{ string myString = ViewBag.MyNewValue; } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-22T17:49:31.107

正如其他人所说，只要您在操作方法中分配 ViewBag 值，您就应该能够在局部视图中访问它。

此外，您应该能够像这样渲染部分块：

```
@Html.Partial("PartialViewName", Model) 
```

而不是这个

```
@{ Html.RenderPartial("PartialViewName", this.Model);}. 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-22T17:18:44.570

你可以用最简单的方法做到这一点。

只需`Viewbag.sth = value;`在您的控制器中设置。

并在您的部分使用中`@ViewBag.sth`

# c++ - 同一对象的多个副本（C++）：线程安全吗？

> ID：11160964
> 
> 赞同：3
> 
> 时间：2012-06-22T17:10:07.093
> 
> 标签：c++, multithreading

我有一个相当简单的问题，但答案似乎让我难以捉摸。如果我有同一个 c++ 类的多个对象，每个对象在它自己的线程中，我是否需要注意并发访问问题？或者对于单独的实例，事情是否自动线程安全？当然，我希望静态方法会出现问题，但是实例方法呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T17:13:02.877

如果您在每个线程中有单独的对象，那么您会没事的。但是，如果您在该类中有一个静态成员变量，您可能会遇到问题。

显然，这仅适用于所讨论的类对象的数据，如果您的线程函数正在访问全局或共享数据，那么通常的多线程问题将适用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T17:13:23.073

这取决于。通常，一个类的一个实例将独立于对其他实例的操作。如果在单个线程中是这种情况，那么在多个线程中也是如此。

例如，考虑一个表示 Point 的值类型类。

```
class Point { 
public:
   int x, y, z 
}; 
```

一个线程中此类的实例将不受另一个线程中不同实例上的操作的影响。

但是，类的实例可以与其他对象交互。如果两个实例可以与同一个对象交互，那么是的，您确实需要关注线程安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T17:12:19.597

实例变量都是独立的。因此，如果您的实例方法仅使用实例和局部变量，则无需担心线程安全。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T17:12:26.273

只要来自一个对象的线程不调用另一个对象的方法，那么应该没有问题。

但是，如果您有递归方法并且正在获取方法中的互斥锁，您可能仍然会遇到死锁。如果是这种情况，您将需要使用递归互斥锁。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-22T17:29:05.127

您问题的根源在于关于对象如何在内存中布局的问题。假设不涉及静态数据成员（很少见），每个对象都独立于其他相同类型的对象，因为在内存中布局的对象本身仅由对象的几个数据成员组成。例如，假设类型定义

```
class Location {
  private:
    double latitude1;
    double longitude1;
  public:
    double latitude () const { return latitude1;  }
    double longitude() const { return longitude1; }
    Location(const double lat0, const double long0) {
      latitude1  = lat0;
      longitude1 = lon0;
    }
    // Calculate the Location at exactly the furthest
    // point on earth (implemented elsewhere).
    Location antipode();
}; 
```

假设该类型的单独对象在别处实例化为

```
Location my_loc(-100.0, 35.0);
const Location your_loc(15.0, 45.5); 
```

然后，`my_loc`它本身*只包含内存中的一对双精度数*（在这种情况下，堆栈上的一对连续双精度数）；并且`your_loc`它本身只包含一对单独的双打。所以，你看，就数据而言，a`Location`只不过是两个双精度数的结构。

但是，你问：构造函数和`antipode()`，等等呢？答案是它们每个类都只存在一次——而且，就内存而言，它们与数据没有直接关联。只有编译器才能将数据与函数关联起来。线程不关心这个。

如果您根据上述情况考虑到这一点，那么人们会怀疑您一直没有得到的答案将落在您身上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T17:52:55.380

您可以大致将 C++ 的项目分为 4 类：

*   只读：字面量、常量、函数等......在代码执行期间不能修改，因此共享本质上是安全的
*   全局变量：命名空间范围内的全局变量、类的静态属性、函数中的局部静态等……可以修改，因此必须使用适当的多线程感知机制
*   线程局部变量：以上所有，但标有`thread_local`存储限定符；看下一点
*   实例变量：类或结构属性，函数局部变量，......**只要它们没有被显式共享，就可以安全使用**

综上所述，您不必担心方法或函数，并且可以自由共享常量。

在中间范围内，确保不共享（即使是无意的）局部变量，至少在确保访问时正确同步的情况下不共享。

最后，要特别警惕全局变量。

# sql - 我可以将多行值视为 group by 子句中的一个吗？

> ID：11160965
> 
> 赞同：1
> 
> 时间：2012-06-22T17:10:11.720
> 
> 标签：sql

我有下表：

```
Col1  Col2
A     ...
A     ...
A
B
B
C
D 
```

我希望能够考虑 A & B 就好像它们是出于 group by 目的的一个，所以

```
select Col1, count(*) from table group by Col1 
```

将返回

```
Col1  count(*)
AB    5
C     1
D     1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:12:06.007

通过`CASE`语句对条件列进行分组：

```
SELECT
  CASE WHEN Col1 IN ('A','B') THEN 'AB' ELSE Col1 END AS Col1Group,
  COUNT(*)
FROM table
GROUP BY
    CASE WHEN Col1 IN ('A','B') THEN 'AB' ELSE Col1 END 
```

您没有指定您的 RDBMS，但有些（如 MySQL）将允许您在`Col1Group`内部使用别名，`GROUP BY`而不必在那里复制整个表达式。

# batch-file - 调用其他批处理文件

> ID：11160966
> 
> 赞同：0
> 
> 时间：2012-06-22T17:10:12.720
> 
> 标签：batch-file

我制作了一个调用另一个批处理文件，`program.bat`第一批执行它的命令，然后`program.bat`像这样调用第二个，

```
 @echo off
    bla bla bla
    ....
    ...
    ...
    call program.bat 
```

但是通过这种方式，它将执行显示其输出的第二个 bat，但是我希望它隐藏`program.bat`输出并显示短语`please wait ...`，当`program.bat`完成他的工作时，我希望第一个 bat 返回执行它的其他命令

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:40:11.977

利用：

```
echo Please wait ...
call program.bat >nul 2>&1 
```

将`>nul`标准输出重定向`program.bat`到`nul`（无），这意味着它不显示。`2>&1`将其他错误（是的，它们被视为不同的输出）重定向到标准输出，该标准输出被重定向到`nul`.

# javascript - 表单提交不断循环

> ID：11160971
> 
> 赞同：0
> 
> 时间：2012-06-22T17:10:18.567
> 
> 标签：javascript, jquery, html

PHe 是应该发生的事情：

单击按钮时，表单的提交被禁用。然后运行文本交换。文本交换完成后，cancel 的 var 切换为 false，然后提交表单。

问题是一旦 form.submit() 触发，它就会循环并且文本不断地淡入淡出。这也会导致表单无法提交。

```
<script type="text/javascript">
    var cancel = true;

    $("#btn-submit").click(

    function () {
        if (cancel == true) {
            $('form').on('submit', function (ev) {
                ev.preventDefault();
                form = $(".submit-form");
                fp = $('#free-planner');
                fp.fadeOut(350, function () {
                    fp.text('Check your email!');
                });
                fp.fadeIn(350, function () {
                    cancel = false;
                    if (cancel == false) {
                        form.submit();
                    }
                });
            });

        }
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:21:07.657

您通过将 cancel 变量设置为 false 来创建循环，然后声明只要它为 false，就提交表单。

尝试以下操作：

```
var cancel = true;

$("#btn-submit").click(function () {
    if (cancel == true) {
        form = $(".submit-form");
        fp = $('#free-planner');
        fp.fadeOut(350, function () {
            fp.text('Check your email!');
        });
        fp.fadeIn(350, function () {                                       
            if (cancel == true) { 
               cancel = false;           
               form.submit();                     
            }                 
        });
    }
}); 
```

这会稍微修改您的逻辑以检查取消变量是否尚未从其原始状态修改为 true，然后将状态修改为 false，然后提交表单。这导致表单只提交一次。

另外，如果`btn-submit`是提交按钮，则将输入类型更改为，`button`而不是`submit`，进行此更改意味着您不需要将侦听器添加到 onSubmit 事件，因为按钮本身就是用作提交事件。这也减轻了调用`preventDefault()`事件的需要，因为事件在使用 触发之前不会发生`form.submit()`。

# javascript - 如何使它成为提交按钮？

> ID：11160983
> 
> 赞同：2
> 
> 时间：2012-06-22T17:11:02.913
> 
> 标签：javascript, html

```
<a id="submit_signup" class="submit-button button-link" href="">
    <div class="button-container">
        <div class="button-left"></div>
        <div class="button-content">Log in</div>
        <div class="button-right"></div>
    </div>
</a> 
```

我不知道如何使它成为一个有效的提交按钮。我有一个表单，它不会重定向到我的操作！顺便说一句，模板是我在互联网上找到的，我正在尝试对其进行调整。我想要一个提交按钮，但外观相同，具有相同的 div..

有没有专业人士知道的？我今年 10 岁，我想我很喜欢这个 :)

整个表格：

```
<form id="register_form" method="post" action="data.php">
    <div class="input-area">
        <h4>Username / Email</h4>
        <input id="id_usermail" type="text" class="text" value="Username or Email" name="id_usermail" />
    </div>
    <div class="input-area">
        <h4>Password</h4>
        <input id="id_password" type="password" class="text" value="password" name="id_password" />
    </div>

    <a id="submit_signup" class="submit-button button-link" href="">
        <div class="button-container">
            <div class="button-left"></div>
            <div class="button-content">Log in</div>
            <div class="button-right"></div>
        </div>
    </a>

    <div id="errors" class="errors"></div>
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:14:18.350

我会把整个东西放在一个`<button>`标签里，应该这样做。顺便说一句，对你早点进入网络开发有好处。

**编辑：** @Gareth 是对的：转换为并保留属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T17:24:04.793

全部替换为`<input type=submit value="Log in">`or `<button type=submit>Log in</button>`。

您在某处找到的代码使用棘手的标记从片段中创建类似按钮的东西，大概使用带有 CSS 的背景和您包含的代码段中不存在的各种代码（包括使其在功能上模拟提交按钮的代码）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T17:15:59.483

您必须使用标签并确定操作和 .. 此处

```
<form action="target_page">
  ...
  <input type="submit" value="submit" />
</form> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T22:58:57.680

使用`<input type="submit" value="Log in" />`, 并使用 CSS 设置样式。

如果你想使用一个`<a>`元素，你需要添加一些 JavaScript。[使用jQuery](http://jquery.com/)做起来很简单，但是依靠 JavaScript 来做这么简单的事情是没有意义的。

# ruby-on-rails - 命名空间控制器的Rails帮助文件？

> ID：11160990
> 
> 赞同：2
> 
> 时间：2012-06-22T17:11:30.687
> 
> 标签：ruby-on-rails

我在文件夹“api”中有一个控制器“ott_controller.rb”。

我的路线如下所示： `map.namespace :api, :path_prefix => 'api' do |api| api.connect 'ott/playlists/:id.xml', :controller => 'ott', :action => 'playlists', :conditions => { :method => :get } end`

我正在尝试为此创建一个帮助文件，但我无法获取它。

在 helpers 文件夹中，我尝试了以下操作

1.  带有模块“OttHelper”的文件“ott_helper.rb”
2.  带有模块“OttHelper”的文件“api_ott_helper.rb”
3.  带有模块“Api::OttHelper”的文件“ott_helper.rb”
4.  带有模块“Api::OttHelper”的文件“api_ott_helper.rb”

这些都不起作用。

这是一个 Rails 2 项目。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T17:15:32.367

您是否也命名了帮助文件？这应该有效：

`app/helpers/api/ott_helper.rb`

在文件中：

`module Api::OttHelper`