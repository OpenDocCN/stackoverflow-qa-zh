# StackOverflow 问答 000456000-000456999

# python - 使用 Python 类有什么好处吗？

> ID：456001
> 
> 赞同：20
> 
> 时间：2009-01-18T22:09:07.270
> 
> 标签：python, class, static-methods

我有一个充满静态方法的 Python 类。将这些封装在一个类而不是原始函数中的优点和缺点是什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-18T22:12:04.487

没有了。这就是模块的用途：对相关功能进行分组。使用一个充满静态方法的类让我对 Javaitis 感到畏缩。我唯一会使用静态函数的情况是该函数是类的一个组成部分。（事实上​​，我可能还是想使用类方法。）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-18T22:17:46.610

不，最好让它们发挥作用，如果它们相关，则将它们放入自己的模块中。例如，如果您有这样的课程：

```
class Something(object):

    @staticmethod
    def foo(x):
        return x + 5

    @staticmethod
    def bar(x, y):
        return y + 5 * x 
```

那么最好有一个像这样的模块，

```
# something.py

def foo(x):
    return x + 5

def bar(x, y):
    return y + 5 * x 
```

这样，您可以通过以下方式使用它们：

```
import something
print something.foo(10)
print something.bar(12, 14) 
```

不要害怕命名空间。`;-)`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-19T00:16:32.817

如果您的函数相互依赖或依赖全局状态，请考虑第三种方法：

```
class Something(object):
    def foo(self, x):
        return x + 5

    def bar(self, x, y):
        return y + 5 * self.foo(x)

something = Something() 
```

使用此解决方案，您可以单独测试一个函数，因为您可以覆盖另一个函数的行为或使用构造函数注入依赖项。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-18T23:02:28.160

只有当您拥有一组功能而不是与一组需要在函数调用之间持久化并以离散方式引用的数据（实例属性）交互时，类才有用。

如果您的类只包含静态方法，那么您的类只是语法上的杂乱无章，而直接函数则更清晰，并且满足您的所有需求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T22:16:26.787

不仅没有优势，而且比使用充满方法的模块更慢。python中对静态方法的需求比java或c#中对静态方法的需求要少得多，它们在非常特殊的情况下使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-18T22:15:47.287

我同意本杰明的观点。与其拥有一堆静态方法，不如拥有一堆函数。如果你想组织它们，你应该考虑使用模块而不是类。但是，如果您想将代码重构为 OO，那就另当别论了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T00:31:36.793

取决于函数的性质。如果它们不是非常不相关（它们之间的调用量最少）并且它们没有任何状态，那么是的，我会说将它们转储到一个模块中。但是，如果您在将继承扔出窗外时需要修改行为，您可能会自责。所以我的答案是**也许**，并且确保你查看你的特定场景，而不是总是假设一个模块是收集一组方法的最佳方式。

# java - 用 Java 显示花哨的方程式

> ID：456002
> 
> 赞同：14
> 
> 时间：2009-01-18T22:09:39.887
> 
> 标签：java, math, open-source

我正在开发一个需要显示“花哨”方程式的 Java 小程序。是否有任何用于 MathML 或 LaTeX 的开源 Java 渲染器？理想情况下，它将是一个不使用 JNI 的纯 Java 解决方案。

理想情况下，它还允许对生成的字形进行动画处理（例如，在等式的两边添加一个常数的动画，通过取消项的线条等）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-20T20:08:39.243

我知道这些 Java 库：

*   [JEuclid](http://jeuclid.sourceforge.net/)（MathML 渲染器；Apache 许可证）

*   [JLatexMath](https://github.com/opencollab/jlatexmath)（Latex 渲染器；GNU 许可）改进了[JMathTeX](http://jmathtex.sourceforge.net/)

*   [JMathTeX](http://jmathtex.sourceforge.net/)（乳胶渲染器；GNU 许可证）

*   [HotEqn](http://www.atp.ruhr-uni-bochum.de/VCLab/software/HotEqn/HotEqn.html)（乳胶渲染器；GNU 许可证？）

*   [SnuggleTex](http://sourceforge.net/projects/snuggletex/)（乳胶渲染器；BSD 许可证）

对于您问题的动画部分，您可以查看以下项目：

*   [DragMath](https://github.com/maths/dragmath)方程编辑器（Swing 界面；GNU 许可）

*   [Mirai Calc](http://mirai.sourceforge.net/)计算器（SWT 界面；GNU 许可证；使用 JMathTeX）

*   [Java 摆动方程构建器](https://github.com/oliverwatkins/calculation_project)

对于 Web 界面，您还可以使用[jsMath JavaScript](http://www.math.union.edu/~dpvc/jsMath/)或其后继的[Mathjax](http://www.mathjax.org/)库作为 Latex/MathML 渲染器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-18T22:23:31.157

看看[JEuclid](http://jeuclid.sourceforge.net/)，它似乎做了你想要的第一部分。

# java - 如何在几百万的列表中找到 1 个或多个部分相交的时间间隔？

> ID：456034
> 
> 赞同：9
> 
> 时间：2009-01-18T22:27:45.123
> 
> 标签：java, algorithm, data-structures

我需要一个有效的索引/搜索算法和/或数据结构的想法，以确定时间间隔是否与列表中的零个或多个时间间隔重叠，请记住，完全重叠是部分重叠的特殊情况. 到目前为止，我还没有想出任何快速或优雅的东西......

考虑一组间隔，每个间隔有 2 个日期 - 开始和结束。

间隔可以大也可以小，它们可以部分重叠，也可以完全不重叠。在 Java 表示法中，如下所示：

```
interface Period 
{
  long getStart(); // millis since the epoch
  long getEnd();
  boolean intersects(Period p); // trivial intersection check with another period
}

Collection<Period> c = new ArrayList<Period>(); // assume a lot of elements 
```

目标是有效地找到与新到达的输入区间部分相交的所有区间。对于 c 作为 ArrayList 这可能看起来像......

```
Collection<Period> getIntersectingPeriods(Period p)
{
  // how to implement this without full iteration?
  Collection<Period> result = new ArrayList<Period>();
  for (Period element : c)
    if (element.intersects(p))
      result.add(element);
  return result;
} 
```

线性迭代整个列表需要太多的比较才能满足我的性能目标。而不是 ArrayList，需要更好的东西来指导搜索，并最大限度地减少比较次数。

到目前为止，我最好的解决方案是在内部维护两个排序列表，并对每个请求进行 4 次二进制搜索和一些列表迭代。有更好的想法吗？

* * *

编者注：时间间隔是沿单个轴（即 X 或在本例中为 T（时间））使用线性段的特定情况。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-18T22:30:28.287

[区间树](http://en.wikipedia.org/wiki/Interval_tree)会：

> 在[计算机科学](https://en.wikipedia.org/wiki/Computer_science)中，**区间树**是保存[区间的](https://en.wikipedia.org/wiki/Interval_(mathematics))[树数据结构](https://en.wikipedia.org/wiki/Tree_(data_structure))。具体来说，它允许人们有效地找到与任何给定区间或点重叠的所有区间。它通常用于窗口查询，例如，在矩形视口内查找计算机地图上的所有道路，或查找 3D 场景内的所有可见元素。一个类似的数据结构是[段树](https://en.wikipedia.org/wiki/Segment_tree)......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:13:19.417

似乎Wiki文章解决的问题比要求的要多。你和Java绑定了吗？

你有一个“巨大的对象集合”，它对我说“数据库”你问过“内置的周期索引功能”，索引对我来说就是数据库。

只有你可以决定这条 SQL 是否符合你对“优雅”的认知：

```
 Select A.Key as One_Interval,
        B.Key as Other_Interval
 From Big_List_Of_Intervals as A join Big_List_Of_Intervals as B
   on A.Start between B.Start and B.End OR
      B.Start between A.Start and A.End 
```

如果开始和结束列被索引，关系数据库（根据广告）在这方面将非常有效。

# boost - 如何使用 asio 执行非阻塞读取？

> ID：456042
> 
> 赞同：16
> 
> 时间：2009-01-18T22:32:01.917
> 
> 标签：boost, serial-port, boost-asio

我正在尝试使用 boost::asio 从串行端口上的设备读取和写入。boost::asio:read() 和 boost::asio::serial_port::read_some() 都会在没有可读取的内容时阻塞。相反，我想检测这种情况并向端口写入命令以启动设备。

我怎样才能检测到没有可用的数据？

如有必要，我可以异步执行所有操作，如果可以的话，我宁愿避免额外的复杂性。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-11-17T18:42:31.840

实际上，您有几个选择。您可以使用串口的内置`async_read_some`功能，也可以使用单机功能`boost::asio::async_read`（或`async_read_some`）。

您仍然会遇到您被有效“阻止”的情况，因为除非（1）已读取数据或（2）发生错误，否则这些都不会调用回调。为了解决这个问题，您需要使用一个`deadline_timer`对象来设置超时。如果超时首先触发，则没有可用的数据。否则，您将读取数据。

增加的复杂性并不是那么糟糕。您最终会得到两个具有相似行为的回调。如果“读取”或“超时”回调因错误而触发，您就知道它是比赛失败者。如果其中一个触发没有错误，那么您知道它是比赛的获胜者（并且您应该取消另一个调用）。在您将阻止呼叫的地方`read_some`，您现在将呼叫`io_svc.run()`。您的函数在调用时仍会像以前一样阻塞`run`，但这次您可以控制持续时间。

这是一个例子：

```
void foo()
{
  io_service     io_svc;
  serial_port    ser_port(io_svc, "your string here");
  deadline_timer timeout(io_svc);
  unsigned char  my_buffer[1];
  bool           data_available = false;

  ser_port.async_read_some(boost::asio::buffer(my_buffer),
      boost::bind(&read_callback, boost::ref(data_available), boost::ref(timeout),
                  boost::asio::placeholders::error,
                  boost::asio::placeholders::bytes_transferred));
  timeout.expires_from_now(boost::posix_time::milliseconds(<<your_timeout_here>>));
  timeout.async_wait(boost::bind(&wait_callback, boost::ref(ser_port),
                  boost::asio::placeholders::error));

  io_svc.run();  // will block until async callbacks are finished

  if (!data_available)
  {
    kick_start_the_device();
  }
}

void read_callback(bool& data_available, deadline_timer& timeout, const boost::system::error_code& error, std::size_t bytes_transferred)
{
  if (error || !bytes_transferred)
  {
    // No data was read!
    data_available = false;
    return;
  }

  timeout.cancel();  // will cause wait_callback to fire with an error
  data_available = true;
}

void wait_callback(serial_port& ser_port, const boost::system::error_code& error)
{
  if (error)
  {
    // Data was read and this timeout was canceled
    return;
  }

  ser_port.cancel();  // will cause read_callback to fire with an error
} 
```

这应该可以让您开始在这里和那里进行一些调整以满足您的特定需求。我希望这有帮助！

另一个注意事项：处理回调不需要额外的线程。一切都在对 的调用中处理`run()`。不知道你是否已经意识到这一点......

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-01-06T01:26:07.820

它实际上比这里暗示的答案要简单得多，您可以同步进行：

假设您的阻塞读取是这样的：

```
size_t len = socket.receive_from(boost::asio::buffer(recv_buf), sender_endpoint); 
```

然后你用

```
socket.non_blocking(true);
size_t len = 0;
error = boost::asio::error::would_block;
while (error == boost::asio::error::would_block)
    //do other things here like go and make coffee
    len = socket.receive_from(boost::asio::buffer(recv_buf), sender_endpoint, 0, error);
std::cout.write(recv_buf.data(), len); 
```

您使用几乎所有发送/接收方法都有的另一种重载形式的receive_from。不幸的是，他们采用了 flags 参数，但 0 似乎工作正常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T22:49:57.597

你必须使用自由函数 asio::async_read。

# php - 我可以在 PHP 中使用 GD 库交换图像中的颜色吗？

> ID：456044
> 
> 赞同：14
> 
> 时间：2009-01-18T22:32:25.600
> 
> 标签：php, colors, gd, swap, imagefilter

我得到了这样的图像（它是一个图表）：

[![黄金交易图表](https://i.stack.imgur.com/vyayH.gif)](https://i.stack.imgur.com/vyayH.gif)
[（来源：[kitconet.com](http://www.kitconet.com/charts/metals/platinum/tny_pt_en_caoz_2.gif)）]

我想改变颜色，所以白色是黑色，图形线是浅蓝色等。GD和PHP可以实现吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-01-19T00:04:16.740

这将用灰色替换白色

```
$imgname = "test.gif";
$im = imagecreatefromgif ($imgname);

$index = imagecolorclosest ( $im,  255,255,255 ); // get White COlor
imagecolorset($im,$index,92,92,92); // SET NEW COLOR

$imgname = "result.gif";
imagegif($im, $imgname ); // save image as gif
imagedestroy($im); 
```

[![在此处输入图像描述](https://i.stack.imgur.com/1Wp1f.gif)](https://i.stack.imgur.com/1Wp1f.gif)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-04-30T21:36:48.220

我无法使这个解决方案发挥作用。图像不能是真彩色图像。首先用 imagetruecolortopalette() 转换它；

```
$imgname = "test.gif";
$im = imagecreatefromgif ($imgname);

imagetruecolortopalette($im,false, 255);

$index = imagecolorclosest ( $im,  255,255,255 ); // get White COlor
imagecolorset($im,$index,92,92,92); // SET NEW COLOR

$imgname = "result.gif";
imagegif($im, $imgname ); // save image as gif
imagedestroy($im); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-02-04T04:45:35.010

我知道这已经很晚了，但我已经编写了一个脚本，可以在更大的范围内执行此操作。希望看到这篇文章的人可以使用它。它需要许多单色层的源图像（您的选择）。您为其提供源颜色和每一层的色调，脚本返回一个合成图像（具有完全透明度），专门为您提供的十六进制代码着色。

查看下面的代码。更详细的解释可以在我的[博客](http://www.stephenwalcher.com/blog/2012/02/02/how-to-make-a-transparent-image-with-dynamic-color-layers/)上找到。

```
function hexLighter($hex, $factor = 30) {
    $new_hex = '';

    $base['R'] = hexdec($hex{0}.$hex{1});
    $base['G'] = hexdec($hex{2}.$hex{3});
    $base['B'] = hexdec($hex{4}.$hex{5});

    foreach ($base as $k => $v) {
        $amount = 255 - $v;
        $amount = $amount / 100;
        $amount = round($amount * $factor);
        $new_decimal = $v + $amount;

        $new_hex_component = dechex($new_decimal);

        $new_hex .= sprintf('%02.2s', $new_hex_component);
    }

    return $new_hex;
}

// Sanitize/Validate provided color variable
if (!isset($_GET['color']) || strlen($_GET['color']) != 6) {
    header($_SERVER['SERVER_PROTOCOL'] . ' 400 Bad Request', true, 400);

    exit(0);
}

if (file_exists( "cache/{$_GET['color']}.png" )) {
    header( 'Content-Type: image/png' );
    readfile( "cache/{$_GET['color']}.png" );

    exit(0);
}

// Desired final size of image
$n_width = 50;
$n_height = 50;

// Actual size of source images
$width = 125;
$height = 125;

$image =    imagecreatetruecolor($width, $height);
            imagesavealpha($image, true);
            imagealphablending($image, false);

$n_image =  imagecreatetruecolor($n_width, $n_height);
            imagesavealpha($n_image, true);
            imagealphablending($n_image, false);

$black = imagecolorallocate($image, 0, 0, 0);
$transparent = imagecolorallocatealpha($image, 255, 255, 255, 127);

imagefilledrectangle($image, 0, 0, $width, $height, $transparent);

$layers = array();
$layers_processed = array();

$layers[] = array( 'src' => 'layer01.gif', 'level' => 0 );  // Border
$layers[] = array( 'src' => 'layer02.gif', 'level' => 35 );     // Background
$layers[] = array( 'src' => 'layer03.gif', 'level' => 100 );    // White Quotes

foreach ($layers as $idx => $layer) {
    $img = imagecreatefromgif( $layer['src'] );
    $processed = imagecreatetruecolor($width, $height);

    imagesavealpha($processed, true);
    imagealphablending($processed, false);

    imagefilledrectangle($processed, 0, 0, $width, $height, $transparent);

    $color = hexLighter( $_GET['color'], $layer['level'] );
    $color = imagecolorallocate($image,
        hexdec( $color{0} . $color{1} ),
        hexdec( $color{2} . $color{3} ),
        hexdec( $color{4} . $color{5} )
    );

    for ($x = 0; $x < $width; $x++)
        for ($y = 0; $y < $height; $y++)
            if ($black === imagecolorat($img, $x, $y))
                imagesetpixel($processed, $x, $y, $color);

    imagecolortransparent($processed, $transparent);
    imagealphablending($processed, true);

    array_push($layers_processed, $processed);

    imagedestroy( $img );
}

foreach ($layers_processed as $processed) {
    imagecopymerge($image, $processed, 0, 0, 0, 0, $width, $height, 100);

    imagedestroy( $processed );
}

imagealphablending($image, true);

imagecopyresampled($n_image, $image, 0, 0, 0, 0, $n_width, $n_height, $width, $height);

imagealphablending($n_image, true);

header( 'Content-Type: image/png' );
imagepng( $n_image, "cache/{$_GET['color']}.png" );
imagepng( $n_image );

// Free up memory
imagedestroy( $n_image );
imagedestroy( $image ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T22:58:28.980

我自己没有尝试过，但是您可以查看 GD 库中的函数[imagecolorset()](http://is2.php.net/manual/en/function.imagecolorset.php)它具有类似颜色填充的效果，可以帮助处理白色背景。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T22:58:31.177

您可以尝试使用 imagefilter 功能[http://lv.php.net/imagefilter](http://lv.php.net/imagefilter) - 但这不会让您直接访问用另一种颜色替换一种颜色，只需更改 r/g/b 组件。

[可以使用 imagesetpixel http://nl2.php.net/imagesetpixel](http://nl2.php.net/imagesetpixel)来设置新的像素值来实现非常低级的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-29T09:51:54.780

IMG_FILTER_NEGATE：反转图像的所有颜色。

[http://www.php.net/manual/en/function.imagefilter.php](http://www.php.net/manual/en/function.imagefilter.php)

这可能是一个解决方案吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-28T22:13:12.650

缓慢但确定的方法，迭代每个像素。

```
function ReplaceColour($img, $r1, $g1, $b1, $r2, $g2, $b2)
{
    if(!imageistruecolor($img))
        imagepalettetotruecolor($img);
    $col1 = (($r1 & 0xFF) << 16) + (($g1 & 0xFF) << 8) + ($b1 & 0xFF);
    $col2 = (($r2 & 0xFF) << 16) + (($g2 & 0xFF) << 8) + ($b2 & 0xFF);

    $width = imagesx($img); 
    $height = imagesy($img);
    for($x=0; $x < $width; $x++)
        for($y=0; $y < $height; $y++)
        {
            $colrgb = imagecolorat($img, $x, $y);
            if($col1 !== $colrgb)
                continue; 
            imagesetpixel ($img, $x , $y , $col2);
        }   
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-18T22:57:47.263

我不知道任何现成的功能。但我想你可以遍历图像的每个像素并改变它的颜色......

# asp.net - 可视化WebGui

> ID：456045
> 
> 赞同：5
> 
> 时间：2009-01-18T22:32:51.760
> 
> 标签：asp.net, visual-web-gui

嗨，我正在为我的项目寻找一些 web 框架，我发现[Visual WebGui](http://www.visualwebgui.com/) 它看起来很棒，但我对奇迹感到悲观:) 比我更有经验的人可以帮助我吗？

经典的 asp.net 与 Visual WebGui

*   速度呢？
*   数据的大小呢？
*   安全呢？

有人亲身体验过这项技术吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-02-01T00:08:51.187

在过去的 5 年里，我在许多项目中使用了 VWG，我可以告诉你，这确实是一个奇迹 :-)。我以前从未制作过如此出色的 Web 应用程序。即时 AJAX，无需接触 HTML 或 CSS，产品不断完善。我知道很难证明我是真正的用户而不是公司，所以请随时问我更多问题，我会继续检查这个线程。

我不是受过专业培训的开发人员，我对 ASP 或 VWG 的内部运作了解不多，但就您的问题而言......

速度呢？- 速度非常快。AJAX 比现有的大多数 AJAX 框架都快。

数据的大小呢？- 发回的数据被压缩并保持在绝对最小值。您可以使用跟踪工具亲自查看。仅将所需的 UI 更改和数据发送回客户端/服务器。

安全呢？- 它和 ASP 一样安全。他们甚至举办了一场 10,000 美元的比赛，看是否有人能破解 VWG——到目前为止，还没有获胜者。

-丹尼

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-02-01T15:41:47.407

多年来，我们一直在使用 Visual WebGui 并取得了巨大的成功。我们的应用程序需要零 DHTML/JavaScript/AJAX/JSON/CSS 编码。严重地。对于基于 Web 的 .NET 业务应用程序 - Visual WebGui 非常适合。我强烈推荐 Gizmox 用于您的下一个网络平台。

**ASP.NET**

ASP.NET 是一个无状态的开发平台。每个用户的当前视图都保留在客户端 - ViewState 上。每个请求都必须将 ViewState 发送到 ASP.NET 服务器 这使得到服务器的往返行程很繁重，即使在 AJAX 场景中也是如此。在 ASP.NET 中，服务器生成 DHTML/JavaScript/CSS 并将其发送到浏览器。这增加了每个 ASP.NET AJAX 调用的权重。

此外，连接一个真正的 ASP.NET 应用程序所需的管道，包括 JSON/AJAX/REST 调用、跨浏览器 JavaScript、DOM 管理和 CSS 等，是困难的，也是维护的噩梦。

**Visual WebGui - 有状态的 UI**

Visual WebGui 确实是一场革命。Visual WebGui 是一个有状态的开发平台，建立在 ASP.NET 之上。所有用户状态都保存在服务器上。服务器确切地知道用户的屏幕是什么样的。因此，客户端/服务器之间的管道变得非常细且非常快。因为服务器知道客户端的当前状态——VWG 服务器能够执行 Diff 例程——所以只有对 UI 的更改通过网络发送。

**管道和屏幕绘图**

此外，VWG 客户端绘制自己的视图。换句话说 - 服务器不会发送任何 DHTML/JavaScript/CSS ......相反，客户端会根据服务器发送的指令即时生成。例如，要创建一个控件 ID 为 1 的新 Button - 服务器只需告诉客户端绘制“”。VWG 客户端知道如何绘制它自己的控件。有了这项技术——这就是管道的细度。

**安全**

对于安全性，Visual WebGui 完全能够在 SSL 上运行。Gizmox 还采用专有的混淆算法来防止未经授权的脚本访问 Visual WebGui JavaScript 调用和 DOM 元素。它工作得非常好。

**应用程序设计**

Visual WebGui 带有一个令人惊叹的表单设计器。以 WinForms 设计器和 API 为蓝本——编写 Visual WebGui Web 业务应用程序现在非常容易设计。拖放、调整大小、移动表单和用户控件上的所有控件，并完成数据绑定。

**双向数据绑定**

使用 Visual WebGui 完全支持 INotifyPropertyChanged 的​​双向数据绑定 - 就像 WinForms。将您的控件数据绑定到您的数据对象（驻留在服务器上）以及任何时候这些数据对象更改 - 您的控件会立即更新。不需要 ASP.NET UpdatePanels 等。你甚至不用考虑它。只需在屏幕上编写您的应用程序和任何需要更新的内容 - 都会更新。

**单一语言方法 - 调试和应用程序可管理性**

Visual WebGui 的核心优势之一是其单一语言方法。您在 C#/VB.NET 中编写和调试所有代码。不再需要破解 JavaScript/JSON/AJAX 调用和维护 Web 服务。不再需要客户端调试器/Firebug 等。无需了解 5 种不同的 Web 语言即可编写单个应用程序。

想象一下 - 用一种语言编写您的应用程序。专注于解决您的业务需求，而不是软件障碍和管道。招聘和寻找合格的开发人员也变得更加容易。

Visual WebGui 立即使这成为现实。像编写商务桌面应用程序一样编写商务网络应用程序。

**概括**

它确实是开发基于 Web 的 .NET 企业业务应用程序的一场革命。

我希望这有助于解释为什么 Visual WebGui 非常值得您研究下一个基于 Web 的企业业务应用程序。

真挚地，

Ryan D. Hatch，客户和 Visual WebGui MVP

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-30T20:07:47.580

我的名字是来自 Visual WebGui 背后的公司 gizmox 的 Eyal Albert。我希望现在回答这个问题还不算晚:-) 但我是由一位朋友推荐给你的问题的。但我有一些信息给你。

1.  速度的需要。 [http://visualwebgui.com/Gizmox/CIOs/WhitePapers/tabid/528/ArticleType/ArticleView/ArticleID/390/PageID/386/Default.aspx](http://visualwebgui.com/Gizmox/CIOs/WhitePapers/tabid/528/ArticleType/ArticleView/ArticleID/390/PageID/386/Default.aspx) 查看 MVP Victor Zychla 所做的测试。

2.  数据大小您可以查看我们的展示案例。 [http://visualwebgui.com/Gizmox/Showcases/tabid/358/Default.aspx](http://visualwebgui.com/Gizmox/Showcases/tabid/358/Default.aspx)

3.  安全 [http://visualwebgui.com/Gizmox/Technology/Security/tabid/624/Default.aspx](http://visualwebgui.com/Gizmox/Technology/Security/tabid/624/Default.aspx)

与您提出问题时相比，所有这些链接都是新信息，我希望您觉得它有效。有关更多信息，您可以联系我 eyal.albert(AT)Gizmox.com

# php - 邮件功能

> ID：456051
> 
> 赞同：0
> 
> 时间：2009-01-18T22:36:28.633
> 
> 标签：php, sendmail

如何使用 php.ini 中的邮件功能发送电子邮件。我要不要把mailServer IP地址放在这个函数中

我在等你回复

不管怎么说，还是要谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-18T23:26:55.083

PHPMailer is pretty much the defacto drop in mailer class for every day use.

[http://phpmailer.codeworxtech.com/](http://phpmailer.codeworxtech.com/)

I personall wrote my own: [http://neranjara.org/article/title/PHP_Socket_based_Mail_class_with_CRAM-MD5_Authentication](http://neranjara.org/article/title/PHP_Socket_based_Mail_class_with_CRAM-MD5_Authentication)

Have fun!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T22:44:54.887

[此处](http://si2.php.net/manual/en/function.mail.php)描述了您需要了解的有关 Mail() 函数的所有信息。话虽如此，Mail() 不接受邮件服务器配置。您在 php.ini 文件中配置邮件服务器（如果您不知道它的位置，您可能应该联系您的系统管理员为您配置它）。

我还建议使用一些 PHP 邮件程序类来发送电子邮件。例如[PHP Mailer](http://phpmailer.codeworxtech.com/)或[SwiftMailer](http://www.swiftmailer.org/)。这些课程将为您省去很多标题、附件等方面的麻烦

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T22:52:43.467

```
<?php
$to='someone@gmail.com';
$subject='hi!';
$msg='Test';
mail($to,$subject,$msg);
?> 
```

您可以在 Php 手册中查看有关可以随电子邮件提供的附加标头的详细信息，以提供发件人姓名和回复电子邮件地址等。

# javascript - Jquery 事件冒泡复选框

> ID：456059
> 
> 赞同：2
> 
> 时间：2009-01-18T22:46:22.653
> 
> 标签：javascript, jquery, events

我有一个带有复选框的表单，然后是复选框右侧的文本。复选框的单击事件附加了 jquery 事件。我想要的是允许用户单击标签或复选框并让复选框选中/取消选中并触发事件。下面是我正在尝试做的简化版本（**不要**运行下面的代码，因为它会创建一个无限循环）。

```
<script>
$(document).ready(function() {
  $("form p").click(function() {
    $(this).find("input").click();
  });

  $("form input").click(function() {
    alert("clicked");
  });  
});
</script>

<form>
<p> <input type="checkbox" name="checker" value="1" /> Click anywhere</p>
<p> <input type="checkbox" name="checker2" value="2" /> Click anywhere</p>
</form> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-18T22:50:42.550

使用 LABEL 标签：[http ://www.w3schools.com/tags/tag_label.asp](http://www.w3schools.com/tags/tag_label.asp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-10T16:00:35.387

点击任何`<input>`标签都会触发标签的点击事件`<p>`（因为`<input>`标签在`<p>`标签内），然后触发`<input>`标签的点击事件导致无限循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-29T14:52:11.037

[您可以使用jQuery 的 event.stopPropagation 方法](http://api.jquery.com/event.stopPropagation/)来防止“无限循环” 。

# winforms - 将按钮添加到 WinForms 中的 Listview

> ID：456063
> 
> 赞同：28
> 
> 时间：2009-01-18T22:50:33.910
> 
> 标签：winforms, listview, button

有没有办法在 WinForms 应用程序的 ListView 内的单元格中添加按钮控件？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2010-12-28T10:27:10.483

`ListViewExtender`这是您可以重用的类的代码。它不是 的派生类`ListView`，基本上你只是声明一个特定的列显示为按钮而不是文本。按钮的文本是子项的文本。

它允许大尺寸的列表视图没有问题，不使用 p/invoke，并且还可以与水平滚动条一起使用（这里作为答案提出的一些代码没有或者对于大量项目非常慢）。请注意，它要求扩展的 ListView`FullRowSelect`设置为`true`并且视图类型设置为`Details`。

这是一个使用它的示例代码：

```
namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent(); // you need to add a listView named listView1 with the designer
            listView1.FullRowSelect = true;
            ListViewExtender extender = new ListViewExtender(listView1);
            // extend 2nd column
            ListViewButtonColumn buttonAction = new ListViewButtonColumn(1);
            buttonAction.Click += OnButtonActionClick;
            buttonAction.FixedWidth = true;

            extender.AddColumn(buttonAction);

            for (int i = 0; i < 10000; i++)
            {
                ListViewItem item = listView1.Items.Add("item" + i);
                item.SubItems.Add("button " + i);
            }
        }

        private void OnButtonActionClick(object sender, ListViewColumnMouseEventArgs e)
        {
            MessageBox.Show(this, @"you clicked " + e.SubItem.Text);
        }
    }
} 
```

这是 ListViewExtender 代码和相关类：

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;
using System.Windows.Forms.VisualStyles;

namespace WindowsFormsApplication1
{
    public class ListViewExtender : IDisposable
    {
        private readonly Dictionary<int, ListViewColumn> _columns = new Dictionary<int, ListViewColumn>();

        public ListViewExtender(ListView listView)
        {
            if (listView == null)
                throw new ArgumentNullException("listView");

            if (listView.View != View.Details)
                throw new ArgumentException(null, "listView");

            ListView = listView;
            ListView.OwnerDraw = true;
            ListView.DrawItem += OnDrawItem;
            ListView.DrawSubItem += OnDrawSubItem;
            ListView.DrawColumnHeader += OnDrawColumnHeader;
            ListView.MouseMove += OnMouseMove;
            ListView.MouseClick += OnMouseClick;

            Font = new Font(ListView.Font.FontFamily, ListView.Font.Size - 2);
        }

        public virtual Font Font { get; private set; }
        public ListView ListView { get; private set; }

        protected virtual void OnMouseClick(object sender, MouseEventArgs e)
        {
            ListViewItem item;
            ListViewItem.ListViewSubItem sub;
            ListViewColumn column = GetColumnAt(e.X, e.Y, out item, out sub);
            if (column != null)
            {
                column.MouseClick(e, item, sub);
            }
        }

        public ListViewColumn GetColumnAt(int x, int y, out ListViewItem item, out ListViewItem.ListViewSubItem subItem)
        {
            subItem = null;
            item = ListView.GetItemAt(x, y);
            if (item == null)
                return null;

            subItem = item.GetSubItemAt(x, y);
            if (subItem == null)
                return null;

            for (int i = 0; i < item.SubItems.Count; i++)
            {
                if (item.SubItems[i] == subItem)
                    return GetColumn(i);
            }
            return null;
        }

        protected virtual void OnMouseMove(object sender, MouseEventArgs e)
        {
            ListViewItem item;
            ListViewItem.ListViewSubItem sub;
            ListViewColumn column = GetColumnAt(e.X, e.Y, out item, out sub);
            if (column != null)
            {
                column.Invalidate(item, sub);
                return;
            }
            if (item != null)
            {
                ListView.Invalidate(item.Bounds);
            }
        }

        protected virtual void OnDrawColumnHeader(object sender, DrawListViewColumnHeaderEventArgs e)
        {
            e.DrawDefault = true;
        }

        protected virtual void OnDrawSubItem(object sender, DrawListViewSubItemEventArgs e)
        {
            ListViewColumn column = GetColumn(e.ColumnIndex);
            if (column == null)
            {
                e.DrawDefault = true;
                return;
            }

            column.Draw(e);
        }

        protected virtual void OnDrawItem(object sender, DrawListViewItemEventArgs e)
        {
            // do nothing
        }

        public void AddColumn(ListViewColumn column)
        {
            if (column == null)
                throw new ArgumentNullException("column");

            column.Extender = this;
            _columns[column.ColumnIndex] = column;
        }

        public ListViewColumn GetColumn(int index)
        {
            ListViewColumn column;
            return _columns.TryGetValue(index, out column) ? column : null;
        }

        public IEnumerable<ListViewColumn> Columns
        {
            get
            {
                return _columns.Values;
            }
        }

        public virtual void Dispose()
        {
            if (Font != null)
            {
                Font.Dispose();
                Font = null;
            }
        }
    }

    public abstract class ListViewColumn
    {
        public event EventHandler<ListViewColumnMouseEventArgs> Click;

        protected ListViewColumn(int columnIndex)
        {
            if (columnIndex < 0)
                throw new ArgumentException(null, "columnIndex");

            ColumnIndex = columnIndex;
        }

        public virtual ListViewExtender Extender { get; protected internal set; }
        public int ColumnIndex { get; private set; }

        public virtual Font Font
        {
            get
            {
                return Extender == null ? null : Extender.Font;
            }
        }

        public ListView ListView
        {
            get
            {
                return Extender == null ? null : Extender.ListView;
            }
        }

        public abstract void Draw(DrawListViewSubItemEventArgs e);

        public virtual void MouseClick(MouseEventArgs e, ListViewItem item, ListViewItem.ListViewSubItem subItem)
        {
            if (Click != null)
            {
                Click(this, new ListViewColumnMouseEventArgs(e, item, subItem));
            }
        }

        public virtual void Invalidate(ListViewItem item, ListViewItem.ListViewSubItem subItem)
        {
            if (Extender != null)
            {
                Extender.ListView.Invalidate(subItem.Bounds);
            }
        }
    }

    public class ListViewColumnMouseEventArgs : MouseEventArgs
    {
        public ListViewColumnMouseEventArgs(MouseEventArgs e, ListViewItem item, ListViewItem.ListViewSubItem subItem)
            : base(e.Button, e.Clicks, e.X, e.Y, e.Delta)
        {
            Item = item;
            SubItem = subItem;
        }

        public ListViewItem Item { get; private set; }
        public ListViewItem.ListViewSubItem SubItem { get; private set; }
    }

    public class ListViewButtonColumn : ListViewColumn
    {
        private Rectangle _hot = Rectangle.Empty;

        public ListViewButtonColumn(int columnIndex)
            : base(columnIndex)
        {
        }

        public bool FixedWidth { get; set; }
        public bool DrawIfEmpty { get; set; }

        public override ListViewExtender Extender
        {
            get
            {
                return base.Extender;
            }
            protected internal set
            {
                base.Extender = value;
                if (FixedWidth)
                {
                    base.Extender.ListView.ColumnWidthChanging += OnColumnWidthChanging;
                }
            }
        }

        protected virtual void OnColumnWidthChanging(object sender, ColumnWidthChangingEventArgs e)
        {
            if (e.ColumnIndex == ColumnIndex)
            {
                e.Cancel = true;
                e.NewWidth = ListView.Columns[e.ColumnIndex].Width;
            }
        }

        public override void Draw(DrawListViewSubItemEventArgs e)
        {
            if (_hot != Rectangle.Empty)
            {
                if (_hot != e.Bounds)
                {
                    ListView.Invalidate(_hot);
                    _hot = Rectangle.Empty;
                }
            }

            if ((!DrawIfEmpty) && (string.IsNullOrEmpty(e.SubItem.Text)))
                return;

            Point mouse = e.Item.ListView.PointToClient(Control.MousePosition);
            if ((ListView.GetItemAt(mouse.X, mouse.Y) == e.Item) && (e.Item.GetSubItemAt(mouse.X, mouse.Y) == e.SubItem))
            {
                ButtonRenderer.DrawButton(e.Graphics, e.Bounds, e.SubItem.Text, Font, true, PushButtonState.Hot);
                _hot = e.Bounds;
            }
            else
            {
                ButtonRenderer.DrawButton(e.Graphics, e.Bounds, e.SubItem.Text, Font, false, PushButtonState.Default);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-09T23:46:20.797

The ListView itself (or ListViewItem) does not function as a container of any kind so no way to add controls directly, however it is doable. I have used this extended ListView with a lot of success: [Embedding Controls in a ListView](http://www.codeproject.com/KB/list/ListViewEmbeddedControls.aspx).

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-02-25T22:44:49.010

这是 WinForms 的**最佳**自定义列表视图控件。
[对象列表视图](http://objectlistview.sourceforge.net/cs/index.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-19T14:18:48.317

为了使 Simon Mourier 的扩展器工作，缺少以下行：

```
extender.AddColumn(buttonAction); 
```

也就是说，它应该如下所示：

```
ListViewExtender extender = new ListViewExtender(listSummary);
ListViewButtonColumn buttonAction = new ListViewButtonColumn(2);
buttonAction.Click += OnButtonActionClick;
buttonAction.FixedWidth = true;
extender.AddColumn(buttonAction); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-02T13:24:40.087

不，是的，ListView 本身不支持此类功能，但您可以在其上创建一个按钮，以便它作为列表视图的组成部分向用户显示。（我想这也是上面提到的 ExtendedListView 所做的）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T17:57:14.337

也许这可能是有趣的？

[http://www.codeproject.com/KB/list/extendedlistviews.aspx](http://www.codeproject.com/KB/list/extendedlistviews.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-07-30T22:34:43.817

不，标准的 Windows 窗体 ListView 不支持嵌入式控件。您可以尝试构建自己的自定义控件，也可以使用类似[http://www.codeproject.com/KB/list/EXListView.aspx](http://www.codeproject.com/KB/list/EXListView.aspx)的东西。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-12-23T08:45:50.523

也许值得一提的是，列表视图控件可能在 WPF 中设计为用户控件/自定义控件，在其 ListViewItems 中带有按钮，然后在 WinForms 应用程序中的[ElementHost](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.elementhost.aspx)控件中使用此控件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-12-23T06:52:41.590

我之前无意中遇到过一个讨论，希望对您有所帮助：[http ://social.msdn.microsoft.com/Forums/en-US/winforms/thread/ee232cc4-68c5-4ed3-9ea7-d4d999956504/](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/ee232cc4-68c5-4ed3-9ea7-d4d999956504/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-08-14T16:04:28.873

您可以使用[GlacialList](https://www.codeproject.com/Articles/4012/C-List-View-v1-3?fid=15258&df=90&mpp=25&sort=Position&spc=Relaxed&prof=True&view=Normal&fr=26#xx0xx)。它允许您将任何控件放在列表单元格中，并且使用起来很简单。您只需将 GlacialList.dll 文档加入解决方案的参考部分。如果您单击该链接，它将向您展示它的工作原理以及如何使用和下载它。

如果您有从上面`System.IO.FileNotFoundException`的`InitializeComponent()`链接下载的源代码，编译并使用这个 .dll（在 bin/Debug 子文件夹中）到您的项目。

这是它的外观示例：

[![例子](https://i.stack.imgur.com/Zc8mi.png)](https://i.stack.imgur.com/Zc8mi.png)

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2012-07-04T00:23:34.837

这看起来像是我遇到的最简单的答案......只是`ItemCommand`在`ListView`.

请参阅此链接：[handle-the-button-click-event-from-an-asp-net-listview-control](http://weblogs.asp.net/jeffwids/archive/2009/12/08/handle-the-button-click-event-from-an-asp-net-listview-control.aspx)

# c# - 建立底层连接时，asp.net页面加载两次

> ID：456065
> 
> 赞同：1
> 
> 时间：2009-01-18T22:51:22.223
> 
> 标签：c#, asp.net

我有一个 aspx 页面，当我输入页面的 URL 时，它似乎加载了两次。

在此页面的加载事件中，我连接到服务器以检索文档，然后将下载的字节输出到页面的输出流。

由于某种奇怪的原因，这导致页面加载两次。如果我在不建立此连接的情况下对字节数组进行硬编码，则页面加载一次，一切都很好。

以下是用于检索外部文档的方法。也许你能看到我看不到的东西。

```
public static byte[] GetDocument(string url)
        {
            HttpWebRequest myHttpWebRequest = (HttpWebRequest)WebRequest.Create(url);
            HttpWebResponse myHttpWebResponse = (HttpWebResponse)myHttpWebRequest.GetResponse();
            Stream stream = myHttpWebResponse.GetResponseStream();

            byte[] _Data = StreamToBytes(stream);

            return _Data;
        }

        private static byte[] StreamToBytes(System.IO.Stream theStream)
        {
            if (theStream == null)
                throw new ArgumentException("URL null.");

            int bytesRead = 0;
            byte[] buffer = new byte[8096];
            MemoryStream bufferStream = new MemoryStream();

            try
            {
                do
                {
                    bytesRead = theStream.Read(buffer, 0, 8096);
                    bufferStream.Write(buffer, 0, bytesRead);

                } while (bytesRead > 0);

            }
            finally
            {
                bufferStream.Flush();
                theStream.Close();
                theStream.Dispose();
            }

            return bufferStream.ToArray();
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-18T22:59:47.633

除了 OnInit() 具有 this.Page_Load += Page_Load; 之外，可能的罪魁祸首还有**AutoEventWireup="true"的页面指令；**

Auto Event Wireup 就像它听起来的那样。如果有遵循命名约定的方法，则该事件会自动连接起来。

您还经常在按钮处理程序上看到这一点。*按钮处理程序会被专门设置，如果名称遵循约定按钮名_OnClick* (sender,args) ，页面也会创建按钮处理程序

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T22:54:40.717

这类问题通常是由于 img 标签的 src 为空...

# powershell - 如何让 Windows Powershell Get-ItemProperty 仅显示我想要的属性？

> ID：456068
> 
> 赞同：5
> 
> 时间：2009-01-18T22:54:35.460
> 
> 标签：powershell

使用 powershell 时，有时我只想显示文件的名称或全名。
据我所知，这样做的方法是使用`Get-ItemProperty`(alias of `gp`) 和 pass `-n fullname`，例如

```
PS C:\Dev> gp . -n fullname 
```

值得注意的是，我想在更长的脚本中使用它，并结合`foreach`and`where`等等

Powershell 然后显示全名，但它也显示一堆其他的东西，如下：

```
PSPath       : Microsoft.PowerShell.Core\FileSystem::C:\Dev
PSParentPath : Microsoft.PowerShell.Core\FileSystem::C:\
PSChildName  : Dev
PSDrive      : C
PSProvider   : Microsoft.PowerShell.Core\FileSystem
fullname     : C:\Dev 
```

我的问题是，我怎样才能让 powershell**只显示我想要的属性**（全名）而不是用所有其他东西来破坏显示。甚至是正确的方法吗`Get-ItemProperty`？

### 更新：

如果我这样做：

```
ls -r | ?{ $_.fullname -match "foo" } 
```

这给了我一系列列表，每个目录一个，显示每个目录中的所有“foo”文件。我想做的是将这些多个列表合并到一个列表中，而不显示,`Mode`或任何其他不相关的东西。如果不是展示这些东西的正确方式，那是什么？`LastWriteTime``Length``Get-ItemProperty`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-19T00:09:55.013

有很多方法。我认为您正在寻找 Get-ChildItem：

PS > get-childitem x.txt | 选择全名

```
 FullName
    --------
    C:\WINDOWS\system32\WindowsPowerShell\v1.0\x.txt

    PS > get-childitem x.txt | select name

    Name
    ----
    x.txt

    PS > get-childitem x.txt | % { $_.fullname }
    C:\WINDOWS\system32\WindowsPowerShell\v1.0\x.txt
    PS > 
```

您可以使用 Get-ItemProperty，但我认为它更适用于注册表之类的东西。

```
PS > Get-ItemProperty x.txt | select name

Name
----
x.txt 
```

Format-Table，别名 ft 也很好了解...

```
PS > gci x.txt | format-table -a fullname,length

FullName                                         Length
--------                                         ------
C:\WINDOWS\system32\WindowsPowerShell\v1.0\x.txt    126 
```

Get-ChildItem 的常用别名是 ls、dir 和 gci。在罗马时，我会选择 gci。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T14:32:28.333

你可以使用（取决于你到底需要什么）：

```
(gi c:\temp\file -ea 0).fullname

(gi c:\temp\file -ea 0) | select -ExpandProperty fullname 
```

> C:\临时\文件

-ea：如果文件不存在则不显示错误

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T03:20:20.573

只是附加评论... PowerShell 向屏幕显示信息的方式也可以通过更改其扩展类型系统 (ETS) 来修改。

查看 Update-TypeData 的帮助。

走这条路确实会引入一些更高级的主题......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-18T23:16:55.243

如果您在 foreach 循环中并且您有对您感兴趣的对象的引用，那么您是否尝试过类似以下的方法来回显该属性。

```
foreach ($file in dir)
{
  $file.fullname
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T23:52:32.647

我一直限制将 Get-ItemProperty 用于导航提供程序，例如通过 Get-Item 或 get-ChildItem 获取数据的注册表。比较

```
ls hklm:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
gp hklm:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run 
```

你想要做的是直接使用属性

```
ls | ? { $_.FullName -match "whatever"} 
```

# version-control - SCM 中的版本控制和遗留错误修复

> ID：456071
> 
> 赞同：3
> 
> 时间：2009-01-18T22:56:34.847
> 
> 标签：version-control, release, maintenance

对于糟糕的问题标题，我感到非常抱歉，但我会尝试更详细地解释一下自己：

我正在为我的软件项目使用 Git（但我猜在这种情况下特定软件并不重要）。与许多项目一样，我计划发布各种版本。当有发布时，我可能会为提交分配一个标签——例如“1.0”。时间流逝，代码被黑，最终发布了一个带有另一个标签的版本——这次是“2.0”。

有一天，我注意到一个严重的错误，它存在于 1.0 和 2.0 版本中，需要修复。为了让事情变得困难（也可能更现实），我不能只在当前的主干/主干中修复它并假设每个人都会使用它，因为 2.0 与 1.0 存在一些向后不兼容，人们很懒惰并且不要不想升级。

那么，为了支持这种行为，有什么好的方案：能够在旧版本中进行更改。`git describe`由于命令（“ `[latest tag]-[commits since the tag]-[current commit hash]`”）的输出，Git 似乎在某种程度上将标签等同于发布。那么，我可能无法避免完全使用标签。

我觉得标签和分支的组合是个好主意，但由于某种原因，我无法用这个来解决细节问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T23:10:56.787

您需要一个分支 - 您将在从发布标记开始的分支上进行维护修复和发布，同时在主（主）分支上继续进行持续开发。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T23:41:47.910

当您提到分支和标签时，您似乎已经有了大部分答案。一个标签用于标记某个偶数（如发布），分支用于并行开发。某个版本的维护通常在分支上完成，您可以使用大多数当前 VCS 挑选变更集，以将给定的错误修复从 head/trunk 导入分支，反之亦然。

您可以处理 head/trunk/master（无论您“当前”开发分支的名称是什么），并在您的各种维护分支中合并错误修复。一旦您完成了主要或次要版本，您就可以创建一个用于维护的分支。

有很多方法可以实现您想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T00:31:03.363

您肯定想考虑为此使用分支。Git 很好地支持这种类型的开发分支。

例如，您的线性版本历史可能如下所示：

```
---A---B---C[1.0]---D---E---F[2.0]---G---H 
```

如果你在 1.0 中发现了一个 bug 并想要修复它，你不能简单地在提交 C 和 D 之间插入一个新的提交。所以，你可以像这样创建一个分支：

```
---A---B---C[1.0]---D---E---F[2.0]---G---H[2.1]
            \
             C1---C2[1.1] 
```

提交 C1 和 C2 修复了该分支中的问题，您可以在其中标记版本 1.1。现在假设您在 2.1 版中进行了更改 (G)，您希望将其向后移植到 1.1 版以在那里进行相同的更改。您可以使用`git cherry-pick`执行以下操作：

```
---A---B---C[1.0]---D---E---F[2.0]---G---H[2.1]
            \
             C1---C2[1.1]---G1[1.2] 
```

提交 G1 与提交 G 相关，但它可以应用在 1.1 版而不是 2.0 版之上。

在这些示例中，分支（额外的开发流）是关键概念，而标签只是一种方便的方式来命名项目在特定时间点所处的状态。Git 支持许多其他操作分支的方法，尤其是使用强大的`git rebase`命令。

# asp.net-mvc - 将两个查询的结果添加到 ViewData.Model

> ID：456076
> 
> 赞同：1
> 
> 时间：2009-01-18T22:58:53.627
> 
> 标签：asp.net-mvc

我的控制器中有以下代码：

```
 public ActionResult Details(int id)
    {
        var dataContext = new BuffetSuppliersDBDataContext();
        var supplier = (from m in dataContext.BO_Suppliers 
                        where m.SupplierID == id
                        select m).FirstOrDefault();

        ViewData.Model = supplier;

        return View();
    } 
```

这会呈现一个视图，其中包含从 linq to sql 查询返回的属性。我现在需要做的是添加另一个查询，它将为每个供应商返回 x 数量的评级，然后我将遍历视图中的记录并显示评级。

如何将评分查询的结果连同已有的内容一起推送到视图中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T05:15:45.270

您最好的选择是创建一个可以传递到视图中的类。

```
public class SupplierDetail
{
    public Supplier { get; set; }
    public SupplierRating { get; set; }
}

public class SupplierDetailViewData
{
    public IEnumerable<SupplierDetail> SupplierDetails { get; set; }
} 
```

然后在您的控制器操作中使用连接并在 LINQ 查询中选择一个新的 SupplierDetail 类。之后，您可以使用代码隐藏并将其更改为此...

```
public partial class Details : ViewPage<SupplierDetailViewData>
{
} 
```

之后，在您的视图中——ViewData.Model 将是 SupplierDetailViewData。当然，第二部分是可选的，但它确实有助于更好的编译时验证。

# sql-server - SQL Server 2008 中存储过程的使用历史

> ID：456080
> 
> 赞同：2
> 
> 时间：2009-01-18T23:02:14.650
> 
> 标签：sql-server

我使用具有数万行存储过程代码的遗留系统，其中许多存储过程已过时且不再使用。似乎没有办法检查执行历史记录，所以我的问题是，通过在保存执行记录的表中插入一行来启动每个存储过程是否是个好主意？

可能非常简单，例如：

插入 executionHistory ( name, date ) select 'spName', getdate()

-- 然后剩下的程序

我想这对于清理旧的未使用代码可能非常有用，并且在尝试决定优化的位置时也可能很方便。我的意思是，在每天执行 50 次的程序上减少 10 秒的执行时间，比在每年只使用一次的程序上节省 10 分钟的执行时间要好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T23:26:44.617

SQL server 中有一个跟踪选项（SQL Profiler）。您可以跟踪一天的 SQL 活动并查看在那里执行了哪些存储过程。

这将使您很好地了解优化的重点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T12:58:18.440

因为您使用的是 sql server 2008，所以我不会执行 rwmnau 建议的操作，因为这意味着您必须修改所有存储过程。SQL Server 2008 引入了一种称为扩展事件和基于它们的 SQL Server 审计的功能。扩展事件是高性能的跟踪系统。通过使用 SQL Server 审计，您可以跟踪您的系统，而无需 sql 跟踪的开销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T23:39:59.083

我认为您的想法很简单，并且可以实现您的目标。虽然它会涉及修改每个 SP，但这是我会选择的路线。然后，您可以确保准确记录数据库上的所有活动。

另一位发帖人建议你做一个追踪——虽然这在短时间内有效，但它只会抓住你正在观看的时间。您必须确保跟踪任何重要的高流量时期，例如月末财务结算，即使那样，您也会错过其他您认为没什么大不了的时间，所以您是主观的。

# python - 如何在 Python 中执行 strtok() 在 C 中执行的操作？

> ID：456084
> 
> 赞同：9
> 
> 时间：2009-01-18T23:03:45.957
> 
> 标签：python

我正在学习 Python 并试图找出一种有效的方法来将用逗号分隔的一串数字标记为一个列表。格式良好的案例按我的预期工作，但格式不太好的案例并没有那么多。

如果我有这个：

```
A = '1,2,3,4'
B = [int(x) for x in A.split(',')]

B results in [1, 2, 3, 4] 
```

这是我所期望的，但如果字符串更像

```
A = '1,,2,3,4,' 
```

如果我对 B 使用与上述相同的列表理解表达式，则会出现异常。我想我明白为什么（因为一些“x”字符串值不是整数），但我认为有一种方法可以非常优雅地解析它，这样字符串 a 的标记化就可以更直接地工作了***strtok(A,",\n\t")***在 C 中迭代调用时会完成。

要清楚我在问什么；我在 Python 中寻找一种优雅/高效/典型的方式来拥有以下所有字符串示例：

```
A='1,,2,3,\n,4,\n'
A='1,2,3,4'
A=',1,2,3,4,\t\n'
A='\n\t,1,2,3,,4\n' 
```

返回相同的列表：

```
B=[1,2,3,4] 
```

通过某种紧凑的表达方式。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-18T23:09:34.807

这个怎么样：

```
A = '1, 2,,3,4  '
B = [int(x) for x in A.split(',') if x.strip()] 
```

x.strip() 从字符串中修剪空格，如果字符串全是空格，这将使其为空。空字符串在布尔上下文中为“假”，因此它被列表推导的 if 部分过滤。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T01:54:24.583

一般来说，我尽量避免使用正则表达式，但如果你想拆分一堆不同的东西，它们就可以了。试试这个：

```
import re
result = [int(x) for x in filter(None, re.split('[,\n,\t]', A))] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-19T02:54:49.627

嗯，功能上的好处（加入了一些生成器表达式）：

```
a = "1,2,,3,4,"
print map(int, filter(None, (i.strip() for i in a.split(',')))) 
```

为了获得完整的功能乐趣：

```
import string
a = "1,2,,3,4,"
print map(int, filter(None, map(string.strip, a.split(',')))) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-10-16T14:55:10.087

为了完整起见，我将回答这个七年前的问题：使用 strtok 的 C 程序：

```
int main()
{
    char myLine[]="This is;a-line,with pieces";
    char *p;
    for(p=strtok(myLine, " ;-,"); p != NULL; p=strtok(NULL, " ;-,"))
    {
        printf("piece=%s\n", p);
    }
} 
```

可以在 python 中使用 re.split 来完成：

```
import re
myLine="This is;a-line,with pieces"
for p in re.split("[ ;\-,]",myLine):
    print("piece="+p) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T23:41:52.933

如果所有数字都是整数，这将起作用，并且永远不会引发异常。`isdigit()`如果字符串中有小数点，则调用为假。

```
>>> nums = ['1,,2,3,\n,4\n', '1,2,3,4', ',1,2,3,4,\t\n', '\n\t,1,2,3,,4\n']
>>> for n in nums:
...     [ int(i.strip()) for i in n if i.strip() and i.strip().isdigit() ]
... 
[1, 2, 3, 4]
[1, 2, 3, 4]
[1, 2, 3, 4]
[1, 2, 3, 4] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T01:49:23.750

这个怎么样？

```
>>> a = "1,2,,3,4,"
>>> map(int,filter(None,a.split(",")))
[1, 2, 3, 4] 
```

filter 将删除所有假值（即空字符串），然后将其映射到 int。

编辑：刚刚针对上面发布的版本进行了测试，它似乎比 strip() 快了 15% 左右，比 isdigit() 快了一倍多

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-19T16:43:40.763

为什么要接受不能对您的解释器造成段错误的劣质替代品？使用 ctypes 你可以调用真实的东西！:-)

```
# strtok in Python
from ctypes import c_char_p, cdll

try: libc = cdll.LoadLibrary('libc.so.6')
except WindowsError:
     libc = cdll.LoadLibrary('msvcrt.dll')

libc.strtok.restype = c_char_p
dat = c_char_p("1,,2,3,4")
sep = c_char_p(",\n\t")
result = [libc.strtok(dat, sep)] + list(iter(lambda: libc.strtok(None, sep), None))
print(result) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-19T02:50:52.100

为什么不直接包装一个 try except 块来捕获任何不是整数的东西呢？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-12T17:47:43.950

我迫切需要 Python 中的 strtok 等价物。所以我自己开发了一个简单的

```
def strtok(val,delim):
    token_list=[]
    token_list.append(val)  
    for key in delim:       
        nList=[]        
        for token in token_list:            
            subTokens = [ x for x in token.split(key) if x.strip()]
            nList= nList + subTokens            
        token_list = nList  
    return token_list 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-18T23:12:18.420

我猜正则表达式是要走的路：http: [//docs.python.org/library/re.html](http://docs.python.org/library/re.html)

# linq - Linq 和检索主键

> ID：456091
> 
> 赞同：1
> 
> 时间：2009-01-18T23:10:15.100
> 
> 标签：linq, primary-key

这段代码有效，但我不明白为什么。使用 DeferredLoadingEnabld = false，我希望它不会返回主键。有人可以解释我错过了什么吗？

```
public void SaveOrder (Order order)
{
        using (DataContext dc= new DataContext)
        {
           dc.DeferredLoadingEnabled = false;
           ...
           order.Total= total;
           dc.order.InsertOnSubmit(order);
           dc.SubmitChanges();
         }
} 
```

订购服务：

```
public void ServiceSaveOrder(Order order)
{     
    Order order= new Order();
    SaveOrder(order);
    Print(order.ID);  //ID= unique primary key
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T23:13:12.817

DeferredLoadingEnabled 属性仅用于跨外键填充其他关系，而不是用于在插入后返回 ID。您的密钥将始终被填充。将 DeferredLoadingEnabled 设置为 true 时，不会自动填充任何父子关系。

更多信息可在[MSDN](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.deferredloadingenabled.aspx)文章中找到。

# python - SCons 问题 - 不理解变量类

> ID：456100
> 
> 赞同：4
> 
> 时间：2009-01-18T23:13:16.640
> 
> 标签：python, variables, scons

我正在为一个项目处理 SConstruct 构建文件，并且我正在尝试从选项更新为变量，因为选项已被弃用。我不明白如何使用变量。我有 0 次 python 经验，这可能是造成这种情况的原因。

例如，我有这个：

```
opts = Variables()
opts.Add('fcgi',0)
print opts['fcgi'] 
```

但我收到一个错误：

```
AttributeError: Variables instance has no attribute '__getitem__': 
```

不知道这应该如何工作

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-12T16:18:08.380

通常，您会将变量存储在您的环境中以供以后测试。

```
opts = Variables()
opts.Add('fcgi',0)
env = Environment(variables=opts, ...) 
```

然后你可以稍后测试：

```
if env['fcgi'] == 0:
    # do something 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-24T17:47:47.683

该特定错误告诉您该类`Variables`尚未实现`__getitem__` [允许](http://docs.python.org/reference/datamodel.html#object.__getitem__)您`[ ...]`在 `opts`. 如果您只想打印出您的密钥，`Variables` [文档](http://www.scons.org/doc/1.2.0.d20090113/HTML/scons-api/SCons.Variables.Variables-class.html)似乎表明您可以迭代您的密钥：

```
for key in opts.keys():
    print key 
```

或者您可以打印出帮助文本：

```
print opts.GenerateHelpText() 
```

# .net - 将在线订单门户与本地数据库同步

> ID：456107
> 
> 赞同：0
> 
> 时间：2009-01-18T23:19:14.397
> 
> 标签：.net, database, external, sync

因此，我们正在构建一个本地（在客户站点）托管的自定义销售点系统，没有什么特别之处。它都是 .NET、C# 和 SQL Server。

其中一项要求是系统也允许通过互联网接收订单。出于各种原因（连接可靠性/速度、备份、稳定性、维护等），门户网站将由一些标准的网络托管公司在场外托管。

产品详细信息在本地数据库中，因此我们需要以某种方式将外部网站数据库与此数据同步。显然它必须是安全的，而且带宽不能太重。

我们提出了一个解决方案，可以最大限度地减少本地数据库对外界的暴露：

*   Web 应用程序无法从本地应用程序访问任何内容。
*   移动数据的唯一方法是通过从本地应用程序发送到 Web 应用程序的推送。
*   Web 应用程序唯一能做的就是向本地数据库发送通知，告知已收到新订单。然后，本地应用程序将连接到外部应用程序并提取订单详细信息。

所以我们正在考虑这样的设计，使用网络服务，并在网络应用程序上定义基本操作，如 addProduct(id, blah blah blah)

但是我们必须编写例程来保持同步，比如如果从本地应用程序中删除了一个产品，但外部应用程序暂时不可用，等等......

这是一种合理的方法，还是有更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T23:39:55.213

这是 SOA 似乎适用于我的一个案例。我会考虑使用 WCF 从 POS 应用程序中公开某些功能。这至少有以下几点：

*   您可以重复使用 POS 系统的功能，而不是在网站上复制部分功能
*   使用例如 MSMQ 绑定，您可以在断开连接的情况下运行
*   WCF 具有出色的安全机制、事务支持等...

这样，您最终会为 POS 系统增加价值，而不是在 POS 和网站之间进行一次性耦合。

要了解有关 WCF 的更多信息，我可以推荐Juval Lowy 的[Programming WCF services](https://rads.stackoverflow.com/amzn/click/com/0596526997)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-18T23:29:08.747

不是直接回答您的问题...我会尝试在两个站点之间建立一个 VPN 隧道，如果不能，请尝试使用 SSH 隧道？

除了安全性很好之外，根据我的经验，一旦有 VPN 就可以打开更多选项，因为以前考虑的事情太不安全了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T23:34:08.717

@olle 这看起来很有希望。一个问题是黑白在线门户和本地应用程序的连接不可靠。但是，我们仍然希望在链接断开时能够接受订单。所以，我想我们将在 webapp 中使用 WCF 从服务器读取数据，并将其缓存在本地表中。Web 应用程序将通过中间层请求数据，如果 WCF 调用在短时间内没有返回，该层会从缓存的表中提供内容。如果它确实返回成功，缓存将被擦除并替换为结果。听起来像一个计划？

# asp.net - WCF 安全 - 我不明白的列表

> ID：456109
> 
> 赞同：24
> 
> 时间：2009-01-18T23:24:51.280
> 
> 标签：asp.net, wcf, web-services, security, wcf-security

关于 WCF 和安全性，我正在兜圈子，所以我只想在这里提出很多问题，希望有人能帮助我清楚地了解情况。

1.  有人可以给我一个关于传输与消息级别安全性的简单英语解释。

2.  我*想*我有一个在 SSL 下运行的服务，它将根据用户的 Windows 凭据对用户进行身份验证。我还*认为*我了解如何通过 PrincipalPermission 限制对服务方法的访问。但是我如何实际检索当前的 IPrinciple，以便我可以根据谁在调用服务返回不同的结果？

3.  我已经弄清楚如何打开跟踪，并且可以使用“Microsoft 服务跟踪日志查看器”查看我的跟踪日志，但如果我能弄清楚我正在显示什么，那我就该死了。有没有像样的资源来解释如何使用这个东西？

4.  使用“证书”clientCredentialType 时，这与 SSL 有什么不同吗？

5.  使用“Windows”clientCredentialType 时，如何查看正在传递的 Windows 用户？

6.  我的要求意味着我必须使用 basicHttpBindings - 我是否正确假设：

    *   我只有传输级别的安全性可供我使用？
    *   我无法为此绑定实现自定义用户名/密码？

我知道这些问题可能看起来很愚蠢，但任何有助于澄清的帮助都会有帮助。

编辑：

7.  如何以与 .asmx 服务类似的方式将自定义 SOAP 标头添加到我的服务中？这是一种有效的方法吗？

编辑：

除了上述问题，我想知道是否可以通过检查 Active Directory 来根据其 Windows 用户对 Windows 移动设备进行身份验证。到目前为止，我发现这似乎不太可能。

NB 对于那些不知道 Windows CE 版本的 WCF 有什么可用的人：仅传输级别安全性，以及客户端凭据类型的无/证书。因此，CE 的 WCF 似乎默认情况下不允许这样做，但我可以在消息中安全地发送此信息（通过方法签名）吗？这是发送此类信息的可接受方式吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-19T00:15:24.067

我不知道所有答案，但这是我知道的答案

1.  传输安全性意味着在传输消息时对通信进行加密，因此无法读取和/或篡改。消息安全性意味着消息本身的内容在传输过程中是加密的，但不一定。例如，消息安全可以与 HTTP 一起使用，而传输安全则需要使用 HTTPS（或其他绑定）。
2.  IPrincipal 主体 = Thread.CurrentPrincipal;
3.  没有答案
4.  是的，尽管 SSL 本身使用证书，但它并不相同。您可以让客户端发送一个服务已知的证书或由受信任的权威机构签署的证书，以使服务知道客户端是谁以及是否允许他们进行呼叫。使用 SSL 只会确保第三方无法通过拦截网络包来读取客户端与服务之间的通信。
5.  IPrincipal 主体 = Thread.CurrentPrincipal; 主体.身份.名称；
6.  不。
    *   您可以选择无、传输、消息和混合安全性，但是传输安全性将需要使用 HTTPS 调用端点，因为那是协议的安全版本
    *   编辑：查看[此论坛上](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/dd5175cd-3791-4213-8716-d45783ce58b1/)的讨论。

这些问题当然并不愚蠢。

PS 我可以推荐 Juval Lowy 所著的[Programming WCF services](https://rads.stackoverflow.com/amzn/click/com/0596526997)一书，它非常深入，并且附带了一个非常有用的框架来扩展 WCF/简化某些事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T07:29:38.603

查看[WCF 安全指南](http://www.codeplex.com/WCFSecurity/Wiki/View.aspx?title=Guidelines)。如果您需要更多信息，您应该可以在那里找到所有信息，它非常完整。虽然看起来@olle 给出了一个非常完整的答案......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T03:36:03.963

还要检查这些[WCF 常见安全方案](http://msdn.microsoft.com/en-us/library/ms730301.aspx)

> ID：456110
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# asp.net-mvc - ASP.NET MVC - Routes and UrlHelper

> ID：456111
> 
> 赞同：4
> 
> 时间：2009-01-18T23:26:19.907
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, urlhelper

I have the following route

```
routes.MapRoute(
    "GigDayListings",                                   // Route name
    "gig/list/{year}/{month}/{day}",                    // URL with parameters
    new { controller = "Gig", action = "List" },
    new
    {
        year = @"^[0-9]+$",
        month = @"^[0-9]+$",
        day = @"^[0-9]+$"
    }  // Parameter defaults
); 
```

When I visit the URL

```
gig/list/2009/01/01 
```

This route matches perfectly and my action is called.

Inside my view I have a helper which does the following:

```
var urlHelper = new UrlHelper(ViewContext);
string url = urlHelper.RouteUrl(ViewContext.RouteData.Values); 
```

The string generated is:

```
http://localhost:3539/gig/list?year=2005&month=01&day=01 
```

Why is it not

```
http://localhost:3539/gig/list/2005/01/01 
```

What am I doing wrong?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-18T23:55:07.553

I think your problem is that you didn't specify the route name in your call. Try to use

```
UrlHelper.RouteUrl(**"GigDayListings"**, ViewContext.RouteData.Values); 
```

overload with route name.

Cheers!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T05:19:19.397

当您提供 gig/list/2008/01/01 时，您是否检查过它实际上正在使用 GigDayListings 路线？也许它正在使用不同的

# windows - 订阅到期后，MSDN Windows 许可证是否仍然有效？

> ID：456124
> 
> 赞同：18
> 
> 时间：2009-01-18T23:32:24.340
> 
> 标签：windows, msdn

订阅关闭后，我的 Windows 许可证密钥仍然有效吗？它不是批量许可。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-18T23:57:52.930

您仍然可以访问在 MSDN 订阅处于活动状态时发布的产品的产品密钥。

我们公司有一个 MSDN 操作系统版本。当该订阅结束时，我们购买了 MSDN Universal（或 Premium 或本周他们称之为的任何名称）。当我们登录到 MSDN 时，我们可以选择操作系统帐户（已过期）或通用帐户。我们仍然可以从操作系统帐户下载，但只能下载在订阅期间发布的那些产品。您仍然受许可证的约束，因此您将有安装次数等上限，但产品仍然有效。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-21T17:49:10.193

大多数 MSDN 订阅是永久许可证。当订阅到期时，您仍然拥有使用其中包含的所有内容的合法权利。但是，某些批量许可订阅可能并非如此，因此您需要检查您的特定订阅以确保确定。过去，我的批量许可证订阅已过期，这使我无法查看密钥 - 因此您需要确保在过期日期之前下载所有密钥。

引用 MSDN 常见问题解答 - “在大多数情况下，MSDN 订阅附带“永久”使用权——订阅到期后继续使用软件的能力。”

有关更多信息，请参见此处... [http://msdn.microsoft.com/en-us/subscriptions/cc150618.aspx](http://msdn.microsoft.com/en-us/subscriptions/cc150618.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-05-03T13:48:16.207

答案是这取决于您购买 MSDN 订阅的渠道。大多数渠道不允许您在 MSDN 到期后继续使用该软件：

永久使用权 通过某些渠道购买的 Visual Studio 订阅提供永久使用权，允许订阅者在订阅到期后继续使用通过有效订阅获得的某些软件产品。但是，订阅者在订阅到期后无权获得该软件的更新，他们也不能继续通过订阅者下载或其他订阅服务访问软件或产品密钥，这些订阅服务是有效订阅的好处。在订阅处于活动状态时获取的产品密钥可以继续使用，直到这些密钥的所有激活都用完为止。如果 Visual Studio 订阅被转让或出售，任何永久使用权都会转让给新的一方，并且卖方不能再使用该软件。一般来说，**不**提供永久使用权包括：

 Visual Studio 云订阅

 通过企业协议订阅、开放价值订阅、校园协议或其他“订阅”批量许可计划购买的 Visual Studio 订阅

 通过 Microsoft 合作伙伴网络向能力合作伙伴和 Microsoft Action Pack 合作伙伴提供的 Visual Studio 订阅。

在上述情况下，订阅者在 Visual Studio 订阅到期后将无法再使用任何通过 Visual Studio 订阅提供的软件。

来源：[https ://www.microsoft.com/en-ca/download/details.aspx?id=13350](https://www.microsoft.com/en-ca/download/details.aspx?id=13350)

# java - 有没有令人信服的理由不使用 Groovy？

> ID：456140
> 
> 赞同：35
> 
> 时间：2009-01-18T23:44:23.003
> 
> 标签：java, groovy, jvm

在离开平台很久之后，我正在用 Java 开发一个 LoB 应用程序（在过去 8 年左右的时间里，我一直在 Fortran、C、C++ 和后来的 .Net 中根深蒂固）。

Java，这门语言，与我记忆中的相比并没有太大变化。我喜欢它的优势，我可以解决它的弱点——平台已经发展壮大，并且决定无数不同的框架似乎做同样的事情是另一回事；但这可以再等一天——总的来说，我对 Java 很满意。然而，在过去的几周里，我已经迷上了 Groovy，这纯粹是出于自私的观点：但不仅仅是因为它使针对 JVM 的开发变得更加简洁和有趣（而且，嗯，“groovy”）命题比Java（语言）。

Groovy 最让我印象深刻的是它固有的可维护性。我们都（我希望！）努力编写有据可查、易于理解的代码。然而，有时我们自己使用的语言会打败我们。一个例子：2001 年，我用 C 语言编写了一个库，用于将 EDIFACT EDI 消息转换为 ANSI X12 消息。这不是一个特别复杂的过程，如果稍微涉及的话，我当时认为我已经正确地记录了代码 - 我可能已经 - 但大约六年后，当我重新访问该项目时（并且在适应 C# 之后）我发现我自己迷失在如此多的 C 样板（malloc、指针等）中，以至于我花了三天的时间进行深思熟虑的分析，才终于明白了六年前我一直在做什么。

今天晚上我写了大约 2000 行 Java 代码（毕竟是休息日！）。我已经尽我所知记录了最好的文档，但是，在这 2000 行 Java 中，很大一部分是 Java 样板。

这就是我看到 Groovy 和其他动态语言通过可维护性和后来的理解而获胜的地方。Groovy 让您专注于您的意图，而不会陷入特定于平台的实现；它几乎是但不完全是自我记录。当我在几年后重新审视我当前的项目（我将尽快移植到 Groovy）时，我认为这对我来说是一个巨大的福音，对我的继任者来说，他们将继承它并继续做好工作。

那么，有什么理由不使用 Groovy 吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-19T00:11:02.093

我认为不使用 Groovy（或 Jython 或 JRuby）的原因有两个：

*   如果你真的，真的需要性能
*   如果你会错过静态类型检查

这两个都是大如果。在大多数应用程序中，性能可能没有人们想象的那么重要，静态类型检查是一个宗教问题。也就是说，所有这些语言的优势之一是它们能够与本地 Java 代码混合和匹配。两全其美。

由于我不对您的业务负责，所以我说“去吧”。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-05-09T21:26:12.850

如果您使用 Groovy，您基本上会丢弃有关类型的有用信息。这使您的代码“时髦”：简洁明了。

```
Bird b 
```

变成

```
def b 
```

此外，您还可以使用所有的元类内容和动态方法调用，这在 Java 中是一种折磨。

但是——**是**的，我已经广泛尝试过 IntelliJ、Netbeans 和 Eclipse——在 Groovy 中不可能进行严重的自动重构。这不是 IntelliJ 的错：类型信息**不存在。**开发人员会说，“但是如果您对每条代码路径都进行了单元测试 (hmmmm)，那么您可以更轻松地进行重构。” 但不要相信炒作：添加更多代码（单元测试）会增加大规模重构的安全性，但它们不会使工作更容易。现在您必须手动修复原始代码**和**单元测试。

所以这意味着您**不会在 Groovy 中经常进行重构，**尤其是在项目成熟时。虽然您的代码将简洁易读，但它不会像每天、每小时和每周自动重构的代码那样出色。

当您意识到不再需要由 Java 中的类表示的**概念时，您可以将其删除。**在 Eclipse 或 Netbeans 或其他任何东西中，您的项目层次结构就像一棵圣诞树一样亮起，准确地告诉您您在此更改中搞砸了什么。`def thing`不会告诉编译器（以及您的 IDE）如何使用变量、方法是否存在等。而且 IDE 只能做这么多的猜测。

最后，Java 代码充满了“样板”，但经过多次重构，它已被揉捏成最终形式。对我来说，这是为未来的程序员获得高质量、可读代码的唯一方法，包括那些未来的程序员是你未来的时候。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-19T00:15:31.990

[Scala](http://www.scala-lang.org/)可能成为 Groovy 的一个引人注目的替代品的两个原因：

*   性能与 Java 相当
*   没有杂乱的静态类型

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-23T06:25:03.647

当您使用动态语言时，尤其是在大型代码库中，您失去的最大的事情之一就是使用 IDE 进行重构的能力。允许向对象动态添加代码的语言根本无法被当今的 IDE 解析，从而允许您可以从 Eclipse 等中获得用于 Java、C++ 等的简单重构方法。

这并不是“动态语言比静态语言更好”的情况。使用最适合您的。特别是关于 Groovy 的真正酷的事情是您可以在同一个项目中混合和匹配 Java 和 Groovy，并且它们都在 VM 上运行。是的，Scala 是另一个例子。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T04:47:13.847

我认为最大的问题是与 java 相比缺乏 IDE 支持，但是 Eclipse 和 Netbeans 的插件一直在变得更好。另外，如果我没记错的话，如果您出于某种原因确实需要匿名内部类，Groovy 不支持它们。不过，我个人会随时选择 Groovy。

# asp.net - 需要类设计帮助

> ID：456146
> 
> 赞同：1
> 
> 时间：2009-01-18T23:48:52.107
> 
> 标签：asp.net, oop

我是编程新手，所以我想我会从那些知道它的人那里得到帮助。

我目前正在编写一个注册应用程序，它基本上将接受用户输入，验证输入的数据，显示一个审查屏幕（用户必须打印出来并邮寄一份副本），然后将输入的信息保存到数据库中。

以下是需要捕获和保存的字段。

```
public class Person 
{
   private string id;
   private string currentLastName;
   private string currentFirstName;
   private string currentMiddleName;
   private string currentSuffixtName;

   private string formerLastName;
   private string formerFirstName;
   private string formerMiddleName;
   private string formerSuffixtName;

   private string currentAddressNumber;
   private string currentAddressDirection;
   private string currentAddressStreet;
   private string currentAddressStreetType;
   private string currentAddressAptNum;
   private string currentAddressrCity;
   private string currentAddressState;
   private string currentAddressZipcode;
   private string currentAddressCounty;

   private string formerAddressNumber;
   private string formerAddressDirection;
   private string formerAddressStreet;
   private string formerAddressStreetType;
   private string formerAddressAptNum;
   private string formerAddressrCity;
   private string formerAddressState;
   private string formerAddressZipcode;
   private string formerAddressCounty;

   private string mailAddressLineOne;
   private string mailAddressLineTwo;
   private string mailAddressLineThree;

   private DateTime birthdate;
   private string gender;
    private string HomePhone;
    private string WorkPhone;
    private string CellPhone;
    private string FaxNumber;
   private string driversLicense;
   private string ssNumber;
   private string membershipType;
   private DateTime registrationDate;
   private string ipAddress;
   private string browserInfo; 
} 
```

在再看一眼之后，我想我会把常见的东西分开并为它们中的每一个创建一个类，并让一个人拥有每个类或类的接口。IE

```
public interface IName
{
    string getLastName();
    string getFirstName();
    string getMiddleName();
    string getSuffixName();
}

    public class Name : IName
{
    private string _lastName;
    private string _firstName;
    private string _middleName;
    private string _suffixName;

    // Validation Methods
    // private set methods

    //#region IName Members
}

public interface IAddress
{
    string getAddressNumber();
    string getAddressDirection();
    string getAddressStreet();
    string getAddressStreetType();
    string getAddressAptNum();
    string getAddressCity();
    string getAddressState();
    string getAddressZipcode();
    string getAddressCounty();
}

public class Address : IAddress
{
    private string _addressNumber;
    private string _addressDirection;
    private string _addressStreet;
    private string _addressStreetType;
    private string _addressAptNum;
    private string _addressrCity;
    private string _addressState;
    private string _addressZipcode;
    private string _addressCounty;

    // Validation Methods
    // private Set Methods
    // public get methods

    //#region IAddress Members
}
public interface IPerson
{
    int getId();
    IName getCurrentName();
    IName getFormerName();

    IAddress getCurrentAddress();
    IAddress getFormerAddress();
    IAddress getMailingAddress();

    DateTime getBirthdate();
    string getGender();
    string getSSNumber();
    string getPersonType();
    DateTime getRegistrationDate();
    string getIPAddress();
    string getBrowserInfo();
    string getDriversLicense();

    string getHomePhone();
    string getWorkPhone();
    string getCellPhone();
    string getFaxNumber();
    string getEmailAddress();
    string getSecondaryEmailAddress();

    bool save();
    void load();

}

public class Person : IPerson
{
    private int _id;
    private IName _currentName;
    private IName _formerName;

    private IAddress _currentAddress;
    private IAddress _formerAddress;
    private IAddress _mailingAddress;

    private DateTime _birthdate;
    private string _gender;
    private string _ssNumber;
    private string _personType;
    private DateTime _registrationDate;
    private string _ipAddress;
    private string _browserInfo;
    private string _driversLicense;

    private string _homePhone;
    private string _workPhone;
    private string _cellPhone;
    private string _faxNumber;
    private string _emailAddress;
    private string _secondaryEmailAddress;

    // private set methods

    // #region IPerson Members
    // .... Get Methods 
    public bool save()
    {
        DataLayer dl = new DataLayer();
        if (_id == 0)
            return dl.insertPerson(this);
        else
            return dl.updatePerson(this);
    }
} 
```

这是我的数据层插入方法

```
public bool insertPerson(IPerson person)
{
    bool inserted = false;
    SqlConnection cnDB = DatabaseConnection.GetOpenDBConnection();
    try
    {
        SqlCommand cmDB = new SqlCommand("sp_InsertName", cnDB);
        cmDB.CommandType = CommandType.StoredProcedure;
        cmDB.Parameters.Add("@last_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@last_name"].Value = person.getCurrentName().getLastName();
        cmDB.Parameters.Add("@first_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@first_name"].Value = person.getCurrentName().getFirstName();
        cmDB.Parameters.Add("@middle_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@middle_name"].Value = person.getCurrentName().getMiddleName();
        cmDB.Parameters.Add("@suffix_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@suffix_name"].Value = person.getCurrentName().getSuffixName();
        int id = cmDB.ExecuteNonQuery();

        cmDB = new SqlCommand("sp_InsertName", cnDB);
        cmDB.Parameters.Add("@person_id", System.Data.SqlDbType.Int);
        cmDB.Parameters["@person_id"].Value = id;
        cmDB.Parameters.Add("@last_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@last_name"].Value = person.getFormerName().getLastName();
        cmDB.Parameters.Add("@former_first_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@former_first_name"].Value = person.getFormerName().getFirstName();
        cmDB.Parameters.Add("@middle_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@middle_name"].Value = person.getFormerName().getMiddleName();
        cmDB.Parameters.Add("@suffix_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@suffix_name"].Value = person.getFormerName().getSuffixName();
        cmDB.ExecuteNonQuery();

        // Insert Current Address

        cmDB = new SqlCommand("sp_InsertAddress", cnDB);
        cmDB.Parameters.Add("@person_id", System.Data.SqlDbType.Int);
        cmDB.Parameters["@person_id"].Value = id;
        cmDB.Parameters.Add("@address_number", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_number"].Value = person.getCurrentAddress().getAddressNumber();
        cmDB.Parameters.Add("@address_direction", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_direction"].Value = person.getCurrentAddress().getAddressDirection();
        cmDB.Parameters.Add("@address_street", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_street"].Value = person.getCurrentAddress().getAddressStreet();
        cmDB.Parameters.Add("@address_street_type", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_street_type"].Value = person.getCurrentAddress().getAddressStreetType();
        cmDB.Parameters.Add("@address_apt_number", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_apt_number"].Value = person.getCurrentAddress().getAddressAptNum();
        cmDB.Parameters.Add("@address_city", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_city"].Value = person.getCurrentAddress().getAddressCity();
        cmDB.Parameters.Add("@address_state", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_state"].Value = person.getCurrentAddress().getAddressCity();
        cmDB.Parameters.Add("@address_zipcode", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_zipcode"].Value = person.getCurrentAddress().getAddressZipcode();
        cmDB.Parameters.Add("@address_county", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_county"].Value = person.getCurrentAddress().getAddressCounty();
        cmDB.ExecuteNonQuery();

        // Insert Former Address

        cmDB = new SqlCommand("sp_InsertAddress", cnDB);
        cmDB.Parameters.Add("@person_id", System.Data.SqlDbType.Int);
        cmDB.Parameters["@person_id"].Value = id;
        cmDB.Parameters.Add("@address_number", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_number"].Value = person.getFormerAddress().getAddressNumber();
        cmDB.Parameters.Add("@address_direction", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_direction"].Value = person.getFormerAddress().getAddressDirection();
        cmDB.Parameters.Add("@address_street", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_street"].Value = person.getFormerAddress().getAddressStreet();
        cmDB.Parameters.Add("@address_street_type", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_street_type"].Value = person.getFormerAddress().getAddressStreetType();
        cmDB.Parameters.Add("@address_apt_number", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_apt_number"].Value = person.getFormerAddress().getAddressAptNum();
        cmDB.Parameters.Add("@address_city", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_city"].Value = person.getFormerAddress().getAddressCity();
        cmDB.Parameters.Add("@address_state", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_state"].Value = person.getFormerAddress().getAddressCity();
        cmDB.Parameters.Add("@address_zipcode", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_zipcode"].Value = person.getFormerAddress().getAddressZipcode();
        cmDB.Parameters.Add("@address_county", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_county"].Value = person.getFormerAddress().getAddressCounty();
        cmDB.ExecuteNonQuery();

        // Insert Mailing Address

        cmDB = new SqlCommand("sp_InsertAddress", cnDB);
        cmDB.Parameters.Add("@person_id", System.Data.SqlDbType.Int);
        cmDB.Parameters["@person_id"].Value = id;
        cmDB.Parameters.Add("@address_number", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_number"].Value = person.getMailingAddress().getAddressNumber();
        cmDB.Parameters.Add("@address_direction", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_direction"].Value = person.getMailingAddress().getAddressDirection();
        cmDB.Parameters.Add("@address_street", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_street"].Value = person.getMailingAddress().getAddressStreet();
        cmDB.Parameters.Add("@address_street_type", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_street_type"].Value = person.getMailingAddress().getAddressStreetType();
        cmDB.Parameters.Add("@address_apt_number", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_apt_number"].Value = person.getMailingAddress().getAddressAptNum();
        cmDB.Parameters.Add("@address_city", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_city"].Value = person.getMailingAddress().getAddressCity();
        cmDB.Parameters.Add("@address_state", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_state"].Value = person.getMailingAddress().getAddressCity();
        cmDB.Parameters.Add("@address_zipcode", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_zipcode"].Value = person.getMailingAddress().getAddressZipcode();
        cmDB.Parameters.Add("@address_county", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@address_county"].Value = person.getMailingAddress().getAddressCounty();
        cmDB.ExecuteNonQuery();

        // insert Personal Info

        cmDB = new SqlCommand("sp_InsertPersonalInfo", cnDB);
        cmDB.Parameters.Add("@person_id", System.Data.SqlDbType.Int);
        cmDB.Parameters["@person_id"].Value = id;
        cmDB.Parameters.Add("@birthdate", System.Data.SqlDbType.DateTime);
        cmDB.Parameters["@birthdate"].Value = person.getBirthdate();
        cmDB.Parameters.Add("@gender", System.Data.SqlDbType.VarChar, 1);
        cmDB.Parameters["@gender"].Value = person.getGender();
        cmDB.Parameters.Add("@ss_number", System.Data.SqlDbType.VarChar, 20);
        cmDB.Parameters["@ss_number"].Value = person.getSSNumber();
        cmDB.Parameters.Add("@person_type", System.Data.SqlDbType.VarChar, 20);
        cmDB.Parameters["@person_type"].Value = person.getPersonType();
        cmDB.Parameters.Add("@registration_date", System.Data.SqlDbType.DateTime);
        cmDB.Parameters["@registration_date"].Value = person.getRegistrationDate();
        cmDB.Parameters.Add("@ip_address", System.Data.SqlDbType.VarChar, 20);
        cmDB.Parameters["@ip_address"].Value = person.getIPAddress();
        cmDB.Parameters.Add("@browser_info", System.Data.SqlDbType.VarChar, 20);
        cmDB.Parameters["@browser_info"].Value = person.getBrowserInfo();
        cmDB.Parameters.Add("@drivers_license", System.Data.SqlDbType.VarChar, 20);
        cmDB.Parameters["@drivers_license"].Value = person.getDriversLicense();
        cmDB.ExecuteNonQuery();

        //insert email address contact type
        cmDB = new SqlCommand("sp_InsertContactType", cnDB);
        cmDB.Parameters.Add("@person_id", System.Data.SqlDbType.Int);
        cmDB.Parameters["@person_id"].Value = id;
        cmDB.Parameters.Add("@contact_type", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@contact_type"].Value = "Email";
        cmDB.Parameters.Add("@contact", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@gender"].Value = person.getEmailAddress();
        cmDB.ExecuteNonQuery();

        //insert secondary email address contact type
        cmDB = new SqlCommand("sp_InsertContactType", cnDB);
        cmDB.Parameters.Add("@person_id", System.Data.SqlDbType.Int);
        cmDB.Parameters["@person_id"].Value = id;
        cmDB.Parameters.Add("@contact_type", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@contact_type"].Value = "Secondary Email";
        cmDB.Parameters.Add("@contact", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@gender"].Value = person.getSecondaryEmailAddress();
        cmDB.ExecuteNonQuery();

        //insert home phone contact type
        cmDB = new SqlCommand("sp_InsertContactType", cnDB);
        cmDB.Parameters.Add("@person_id", System.Data.SqlDbType.Int);
        cmDB.Parameters["@person_id"].Value = id;
        cmDB.Parameters.Add("@contact_type", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@contact_type"].Value = "Home Phone";
        cmDB.Parameters.Add("@contact", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@contact"].Value = person.getHomePhone();
        cmDB.ExecuteNonQuery();

        //insert work phone contact type
        cmDB = new SqlCommand("sp_InsertContactType", cnDB);
        cmDB.Parameters.Add("@person_id", System.Data.SqlDbType.Int);
        cmDB.Parameters["@person_id"].Value = id;
        cmDB.Parameters.Add("@contact_type", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@contact_type"].Value = "Work Phone";
        cmDB.Parameters.Add("@contact", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@contact"].Value = person.getWorkPhone();
        cmDB.ExecuteNonQuery();

        //insert cell phone contact type
        cmDB = new SqlCommand("sp_InsertContactType", cnDB);
        cmDB.Parameters.Add("@person_id", System.Data.SqlDbType.Int);
        cmDB.Parameters["@person_id"].Value = id;
        cmDB.Parameters.Add("@contact_type", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@contact_type"].Value = "Cell Phone";
        cmDB.Parameters.Add("@contact", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@contact"].Value = person.getCellPhone();
        cmDB.ExecuteNonQuery();

        //insert cell phone contact type
        cmDB = new SqlCommand("sp_InsertContactType", cnDB);
        cmDB.Parameters.Add("@person_id", System.Data.SqlDbType.Int);
        cmDB.Parameters["@person_id"].Value = id;
        cmDB.Parameters.Add("@contact_type", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@contact_type"].Value = "Fax Number";
        cmDB.Parameters.Add("@contact", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@contact"].Value = person.getFaxNumber();
        cmDB.ExecuteNonQuery();

        inserted = true;
    }
    catch (SqlException sqlEx)
    {
        throw new Exception(GetSqlExceptionMessage(sqlEx.Number));
    }
    catch (Exception ex)
    {
        throw ex;
    }
    finally
    {
        if (cnDB.State == ConnectionState.Open)
            cnDB.Close();
    }
    return inserted;
} 
```

编辑：我觉得这段代码以后将很难维护。谁能帮我找出一种更简单/可维护的方法来做到这一点？我也很困惑在添加记录后我应该如何更新记录。

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T16:57:14.763

首先，如果您想简化维护，我会考虑使用 ORM 进行映射。我会看看 nHibernate、Linq2Sql、Entity Framework 或其他十亿左右的一个。它会从上面消除很多噪音。

第二个建议是继续你正在做的重构。我喜欢你抽象地址的方式，如果你看一下你的人，一个人没有以前的名字，你所做的就是在你的域模型中泄露一个跟踪以前信息的要求。我会将所有这些移出，并定义一个 DTO，它有两个属性：

```
public class PersonDTO
{
    public Person Current;
    Public Person Previous;
} 
```

我认为这可以消除很多噪音。我也喜欢使用字典来处理多个电话号码，基本上我们有：

```
public class Phone
{
   PhoneType PhoneType;
   string Number
   string AreaCode
   string Extension
} 
```

有些人可能会让电话有数字，所以我不想争论，或者你可以像你一样只有一个字符串。要记住的一件事是国际化（如果适用）。

现在在我个人身上，我会有一个字典，这允许您在遍历电话字典时将四个插入内容分成一个循环。如果您有帐单或送货地址，我会使用类似的模型。

如果您不使用 ORM，使用 sql 参数帮助遵守 DRY 的一种方法很简单。下面的代码并不是要编译的，只是为了向您展示一个再次最小化噪声的模式：

```
public class DALLayer
{
   public void InsertPerson(Person p)
   {
       using (SqlCommand sqlCmd=CreateNewCommand())
       {
           AddPersonParams(p,sqlCmd);
           sqlCmd.ExecuteNonQuery();
       }
   }

   public void UpdatePerson(Person p)
   {
       using (SqlCommand sqlCmd=CreateNewCommand())
       {
           AddPersonParams(p,sqlCmd);
           //We add the Id since we have it in updates but not in inserts
           sqlCmd.AddParameter("@PersonId",p.Id);
           sqlCmd.ExecuteNonQuery();
       }

   }

   private void AddPersonParams(Person p, Sqlcommand sqlCmd)
   {
       //Do all the code to add Params which exists in both insert and updates
   }

} 
```

现在，您所做的事情已得到巩固，因此当您向某人添加新属性时，您只需在处理参数时修改一个函数。

插入您当前和以前的地址的另一件事是，您不是 DRY。你可以这样做：

```
private void InserAddress(Address address, int Id, AddressType addType)
{

} 
```

现在从您的插入 Person 例程中，您将调用此方法两次：

```
InsertAddress(p.CurrentAddress,id,CurrentAddress);
InsertAddress(p.FormerAddress,id,FormerAddress); 
```

当然，如果您接受我之前的建议，这可能看起来非常不同。

# 编辑

我完全错过了这一点，但我想强调克里斯所说的话（我+1你，但觉得这是一件好事，我不得不重复它。使用属性:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T17:21:27.490

根据您列出的要求，您似乎不需要对应用程序中的数据进行太多操作。特别是其中一些看起来可以被视为与用户相关的数据列表，即姓名、地址和电话列表。您发布的数据访问代码似乎是这样构造的，我认为在您的场景中您不需要使应用程序的逻辑方面更加严格。

给定的名称被视为与此人相关的数据列表，我认为您不想将其第一个插入内容作为创建用户的部分。您还有其他可以添加到主记录的信息，例如 driversLicense、ssn、birthdate。

对于接口，请考虑您是否从中得到任何东西。这是打破类之间直接依赖关系的好方法，但看起来您在代码中没有这种情况。另请注意，声明接口不会强制您使用 get/set 方法，因为您可以要求类实现具有 get 的属性。

为列表中使用的每个类添加一个类型属性。您可以使用它来减少接口和数据访问层中的代码。在后面，您现在可以循环遍历列表并以相同的方式插入所有这些。

考虑使用可以帮助您访问数据的工具，例如 linq2sql 或 nhibernate。这将简化数据访问代码并使其不易出错。

附言。并非所有场景都没有单一的解决方案，即使在特定场景中，个人经历也会影响每个人解决问题的方式。有一些旨在减少这种情况的实践和原则，但即便如此，差异还是会出现。也就是说，我建议你阅读一些关于 SOLID、DDD 和 TDD 的信息。它们不是解决这些问题的秘诀，但了解这些肯定有助于软件开发。

**更新：**关于评论中的问题。Linq2sql支持存储过程，查看scott gu关于linq2sql的系列：[http ://weblogs.asp.net/scottgu/archive/2007/09/07/linq-to-sql-part-9-using-a-custom-linq-带有-lt-asp-linqdatasource-gt-control.aspx 的表达式](http://weblogs.asp.net/scottgu/archive/2007/09/07/linq-to-sql-part-9-using-a-custom-linq-expression-with-the-lt-asp-linqdatasource-gt-control.aspx)。通过使用 sp，您失去了 linq2sql 的部分灵活性，但无论如何它都会对您有所帮助。

关于更新。有不同的策略，主要问题是关于对相同信息的并发更新。如果并发更新不是问题，那么您可以保留最新版本，因此您只需保存数据。在这种情况下，您需要的唯一原始数据是记录的 ID，然后您让数据被覆盖。如果您需要检测并发更新，则必须保留所有原始值的副本或使用时间戳。sp 代码在更新记录时需要检查原始值是否匹配。

您可以在设计器中配置 linq2sql 来控制您使用的并发更新策略类型以及您发送的原始值。SO中可能有一些与此相关的问题/答案。你如何具体连接它，将取决于你给它的用途（使用它生成的实体或滚动你自己的，将 sp 附加到实体或单独）甚至你使用的控件，因为其中一些可以保存原始值你（使用视图状态）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T01:42:09.397

我注意到您使用 ASP.NET，您应该知道 Membership Provider 可以为您处理所有繁重的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T17:42:13.643

我会让人员记录具有子表的外键（姓名、地址、联系信息等）。

然后我有一个普通的旧对象，其中包含每个字段的属性和一个负责将类映射到数据库存储过程参数的存储库类。

我没有填写所有字段，但这里应该有足够的内容让您继续前进。此外，您可以提取每个类的接口以进行编程（用于测试、模拟等）。

决定保存是否应该插入或更新将涉及编写 udpate 语句，然后执行

```
public void Save()
{
    string.IsNullOrEmpty(Id) ? Insert() : Update();
} 
```

清理数据类：

```
using System;
public class PersonName
{
    public string Id { get; set; }

    public string Last { get; set; }
    public string First{ get; set; }
    public string Middle{ get; set; }
    public string Suffix { get; set; }
}

public class PersonNameRepository
{
    public void Insert(PersonName pa)
    {
        SqlCommand cmDB = new SqlCommand("sp_InsertName", cnDB);
        cmDB.CommandType = CommandType.StoredProcedure;
        cmDB.Parameters.Add("@last_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@last_name"].Value = pa.Last;
        cmDB.Parameters.Add("@first_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@first_name"].Value = pa.First;
        cmDB.Parameters.Add("@middle_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@middle_name"].Value = pa.Middle;
        cmDB.Parameters.Add("@suffix_name", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@suffix_name"].Value = pa.Suffix;
        int id = cmDB.ExecuteNonQuery();
        pa.Id = id.ToString();
    }
}

public class PersonAddress
{
    public string Id { get; set; }

    public string Number { get; set; }
    public string Direction { get; set; }
    public string Street { get; set; }
    public string City { get; set; }
}

public class PersonAddressRepository
{
    public void Insert(PersonAddress pa)
    {
        // Same as PersonNameRepository
    }
}

public class PersonInfo
{
    public string Id { get; set; }

    public DateTime BirthDate { get; set; }
    public string Gender { get; set; }
    public string SsNumber { get; set; }

}

public class PersonInfoRepository
{
    public void Insert(PersonInfo pa)
    {
        // Same as PersonNameRepository
    }
}
public class Person
{
    public string Id { get; set; }
    public PersonName CurrentName { get; set; }
    public PersonName FormerName { get; set; }

    public PersonAddress CurrentAddress { get; set; }
    public PersonAddress FormerAddress { get; set; }

    public PersonInfo Info { get; set; }
}

public class PersonRepository
{
    public void Insert(Person p)
    {
        // TODO: Begin Transaction

        p.CurrentName.Insert();
        p.FormerName.Insert();
        p.CurrentAddress.Insert();
        p.FormerAddress.Insert();
        p.Info.Insert();

        SqlCommand cmDB = new SqlCommand("sp_InsertPerson", cnDB);
        cmDB.CommandType = CommandType.StoredProcedure;
        cmDB.Parameters.Add("@current_name_id", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@current_name_id"].Value = p.CurrentName.Id;
        cmDB.Parameters.Add("@former_name_id", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@former_name_id"].Value = p.FormerName.Id; ;
        cmDB.Parameters.Add("@current_address_id", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@current_address_id"].Value = p.CurrentAddress.Id;
        cmDB.Parameters.Add("@former_address_id", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@former_address_id"].Value = p.FormerAddress.Id;
        cmDB.Parameters.Add("@info_id", System.Data.SqlDbType.VarChar, 50);
        cmDB.Parameters["@info_id"].Value = p.Info.Id;
        int id = cmDB.ExecuteNonQuery();
        pa.Id = id.ToString();

        // TODO: End Transaction
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T03:40:04.517

我很好奇您将如何处理一个人的地址等的未来更新。您可能需要考虑一个审计跟踪表，而不是将当前和以前的元素合并到一个对象中。让您的 Person 对象仅包含一组数据。查询当前数据的实际表，并针对审计表查询以前的和“以前的-以前的”数据。除非出于某种奇怪的原因，软件要求在创建人物之前需要以前的名字等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T16:42:44.113

抱歉，我不会在这里为您提供完整的解决方案（只是想从它开始）。

我真的建议使用某种生成的数据访问层；例如。Linq to SQL 或 NHibernate（还有更多，但这两个都很流行）。你说你将难以维护的代码是你真的不应该维护的代码。让其他人在那里做繁重的工作。

顺便说一句，我会说您将所有数据拆分为实现接口的单独类是正确的。不过我要提一件事——使用 .Net 你不需要明确的“getxxxx()”方法；使用带有公共 getter 的属性。它看起来像这样：

```
public class Name : IName
{
    private string _lastName;
    private string _firstName;
    private string _middleName;
    private string _suffixName;

    public string LastName { get { return _lastName; } }

    //Alternative automatic property:
    public string FirstName { get; protected set; } 
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-27T18:40:26.390

一般来说，有很多很好的答案展示了不同的数据访问和业务逻辑层。我要补充的一件事是摆脱每个类的接口。当您确定只有一个类实现它时编写接口是过度设计并且不必要地使事情复杂化。现在，如果您正在编写一个类库并且只提供一个类作为模板或其他类的起点，那将是不同的。但是这里显示的界面并没有留下很多重新解释的空间。

# java - 对 Java 电子邮件模板的建议？

> ID：456148
> 
> 赞同：44
> 
> 时间：2009-01-18T23:50:08.283
> 
> 标签：java, email, frameworks, templates

我们有一个应用程序需要发送各种不同类型的模板电子邮件。当前的代码非常繁琐，也不是很灵活。有没有人知道图书馆可以帮助完成这类工作......我们正在寻找某种用于电子邮件的模板库。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-19T00:05:59.187

[StringTemplate](http://www.stringtemplate.org)也是一个非常不错的模板引擎。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-18T23:51:40.680

也许[Apache Velocity](https://velocity.apache.org/)可以为您工作？

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-12-30T21:13:35.530

Jack Leow 说他编写了一个自定义 HttpServletResponse 以便他可以重用 JSP 来生成电子邮件模板，我只是做了同样的事情，并想与那些不确定从哪里开始的人分享我的代码示例/原型：

通常在提供 JSP 页面时，您会执行以下操作：

```
res.setContentType("text/html");
RequestDispatcher jsp = req.getRequestDispatcher("/WEB-INF/templates/" + template);
res.setStatus(200);
jsp.forward(req, res); 
```

现在，不要对 HttpServletResponse 执行 jsp.forward，而是对您的自定义 Servlet 响应执行 jsp.forward：

```
EmailServletResponse res2 = new EmailServletResponse();
jsp.forward(req, res2);
System.out.println(res2.toString()); <<-- email gets printed here 
```

您的 EmailServlet 响应将只是一个实现 HttpServletResponse 的类，填写空白并使用底层 StringWriter 来完成 toString 转换：

```
public class EmailServletResponse implements HttpServletResponse {

private int status;
private StringWriter sw = new StringWriter();

@Override
public void flushBuffer() throws IOException {
    sw.flush();
}

@Override
public int getBufferSize() {
    return 1024;
}

@Override
public String getCharacterEncoding() {
    return "UTF-8";
}

@Override
public String getContentType() {
    return "text/html";
}

@Override
public Locale getLocale() {
    return Locale.getDefault();
}

@Override
public ServletOutputStream getOutputStream() throws IOException {
    return new ServletOutputStream() {
        @Override
        public void write(int b) throws IOException {
            sw.write(b);
        }
    };
}

@Override
public PrintWriter getWriter() throws IOException {
    PrintWriter pw = new PrintWriter(sw);
    return pw;
}

@Override
public boolean isCommitted() {
    return false;
}

@Override
public void reset() {       
}

@Override
public void resetBuffer() {
}

@Override
public void setBufferSize(int arg0) {
}

@Override
public void setCharacterEncoding(String arg0) {
}

@Override
public void setContentLength(int arg0) {
}

@Override
public void setContentType(String arg0) {
}

@Override
public void setLocale(Locale arg0) {
}

@Override
public void addCookie(Cookie arg0) {
}

@Override
public void addDateHeader(String arg0, long arg1) {
}

@Override
public void addHeader(String arg0, String arg1) {
}

@Override
public void addIntHeader(String arg0, int arg1) {
}

@Override
public boolean containsHeader(String arg0) {
    return false;
}

@Override
public String encodeRedirectURL(String arg0) {
    return "";
}

@Override
public String encodeRedirectUrl(String arg0) {
    return "";
}

@Override
public String encodeURL(String arg0) {
    return "";
}

@Override
public String encodeUrl(String arg0) {
    return "";
}

@Override
public void sendError(int arg0) throws IOException {

}

@Override
public void sendError(int arg0, String arg1) throws IOException {

}

@Override
public void sendRedirect(String arg0) throws IOException {

}

@Override
public void setDateHeader(String arg0, long arg1) {

}

@Override
public void setHeader(String arg0, String arg1) {

}

@Override
public void setIntHeader(String arg0, int arg1) {

}

@Override
public void setStatus(int status) {
    this.status = status;
}

@Override
public void setStatus(int status, String message) {
    setStatus(status);
}

public String toString(){
    return sw.getBuffer().toString();
}
} 
```

随意在需要的地方改进代码，这是一个快速的原型制作会议:)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-01-19T15:59:42.177

大约一年前，我遇到了类似的问题。在我们的例子中，我们的前端开发人员都熟悉 JSP，我真的不想在混合中加入另一个模板引擎。我想要依靠 servlet 容器的 JSP 处理器为我生成电子邮件内容的东西。

这很简单：

1.  我的应用程序中必须有一个 JSP 页面（如果您不想从外部访问它，可以将它放在 /WEB-INF 中）。
2.  我编写了一个自定义`HttpServletResponse`，`ServletOutputStream`它捕获由 servlet 容器编写的内容并将其转换为字符串，并依靠`RequestDispatcher.include(...)`向模板 JSP 发出“请求”（我还编写了一个自定义`HttpServletRequest`以将原始请求与突变隔离开来）。
3.  因为这有点小技巧，而不是 servlet API 的预期使用方式，所以我将所有这些封装在一个实用程序类中，因此所有客户端代码所要做的就是传递到 JSP 模板的路径，并取回处理后的内容。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-01-19T04:04:40.030

我更喜欢[Freemarker](http://www.freemarker.org/)，而不是 Velocity；imo，Freemarker 在这种情况下要简单得多。

如果您使用的是 Spring，那么您可能会对[Spring MVC 中的 Freemarker](https://www.baeldung.com/freemarker-in-spring-mvc-tutorial)感兴趣。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-06-30T07:39:30.367

Here's a [Java template benchmark](https://github.com/PerfectCarl/template-engine-benchmarks/blob/master/README.md)

![enter image description here](https://i.stack.imgur.com/oUpkp.png)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-03-02T21:39:08.397

如果您喜欢[StringTemplate](http://www.stringtemplate.org/)，您可能更喜欢[Google Soy](https://developers.google.com/closure/templates/)。更好的可用性、更好的组织、更好的文档和更好的支持，IMO。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-04-26T10:59:42.857

也可以创建一个“邮件内容 jsp”，如

```
mails/orderConfirmed.jsp
mails/sendingYourOrderNotification.jsp 
```

然后只需执行 http 客户端请求“/mails/*.jsp”即可获取您想要的邮件内容。

我认为这是对 jsp 的合理使用，因为无论如何您都想生成 HTML，并且请求您自己的服务器并不消耗带宽。

The good thing is that you can do jsp inclusion, or even use more advanced libraries like tiles, jsf, struts, wicket. You don't need to learn a new tool for that, you can use what you already know. Jsps are a quite performant templating engine, they exists since the years 2000.

The bad point is that you can't use your typed variables to compose your jsp, you're limited to strings as request parameters (or a good huge json :-))

It is also a good way to isolate code and even to split servers later if you need performance optimization.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-12T14:39:41.173

有一个使用 Snippetory 处理电子邮件的[示例。](http://www.jproggy.org/snippetory/EmailExample.html)

# xml - xml到json的往返转换

> ID：456149
> 
> 赞同：1
> 
> 时间：2009-01-18T23:51:16.937
> 
> 标签：xml, json

有没有做任何工作来提供从 xml 到 json 的往返往返？

如果是这样，是否有人对此有一些实用的建议？

我知道您可能不得不限制模式和 json 结构的复杂性，但是双方的成本是多少？而且是太禁止了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-18T23:57:43.540

有关可以完成的一些方法，请参阅这篇文章：[在 XML 和 JSON 之间转换](http://www.xml.com/pub/a/2006/05/31/converting-between-xml-and-json.html)

# visual-studio-2008 - 如何确定为什么在 VS2008 中阻止将 Web 服务引用添加到我的项目中？

> ID：456154
> 
> 赞同：6
> 
> 时间：2009-01-18T23:53:33.237
> 
> 标签：visual-studio-2008, web-services, visual-studio-2005, upgrade

我有一个 VS2005 项目，其中包含几个 Web 服务引用。该项目最近已升级到 VS2008，但现在 Web 参考存在问题......可能是因为它们可能没有正确升级。

当我选择更新 Web 参考时，我收到以下错误：

“值不能为空。参数名称：discoveryError % mexError”非常有用。

然后我删除了网络参考，目的是重新添加它......

Add Web Reference 对话框出现并成功加载了与 Web 服务相关的每个方法的信息。

但是，我无法添加引用，因为这样做的按钮是灰色的，并且有一个标题为“在此 URL 找到的 Web 服务：”的文本框，其中包含文本“由于当前状态，操作无效目的”。

现在终于，这给我带来了我的主要问题......那么我该如何添加这个网络参考？或者更好的是，我如何找出“对象的当前状态”的无效之处？

有没有人在VS2008有过类似的经历？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-12T07:48:48.663

我在 VS2010 上遇到了同样的问题。就我而言，问题是代理服务器。我从外部 url 获得了 wsdl。我的解决方案：在VS2010中设置代理。编辑 devenv.exe.config 并在`<defaultProxy>`下面添加`<system.net>`：

```
<system.net>
        <defaultProxy enabled="true" useDefaultCredentials="true">
            <proxy bypassonlocal="True" proxyaddress="http://yourproxyserver:port"/>
        </defaultProxy>
</system.net> 
```

如果代理来自 .pac 文件，则可以省略`<proxy>`标记：

```
 <system.net>
        <defaultProxy enabled="true" useDefaultCredentials="true">
        </defaultProxy>
   </system.net> 
```

关于相关问题的旧帖子：http:
[//fhtino.blogspot.it/2006/11/visual-studio-2005-proxy-problem-in-add.html](http://fhtino.blogspot.it/2006/11/visual-studio-2005-proxy-problem-in-add.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T00:21:54.473

终于想通了。

我使用[WebService Studio](http://www.codeplex.com/WebserviceStudio)让我更好地了解正在发生的事情。它返回错误消息“请求失败，HTTP 状态 407：需要代理身份验证”......这让我知道我必须安装新的安全证书......旧的安全证书已过期。

我想这回答了这个关于如何找到更多关于网络服务无效的问题的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-04T10:40:27.473

我遇到了同样的错误：使用 Visual Studio 2008 的更新参考

```
"Value cannot be null. Parameter name: discoveryError % mexError 
```

我已经修复了它检查项目的文件夹 ACL 列表。当然，我需要将 IUSR 添加到文件夹的安全性中……就是这样！

我为我工作，我希望也能帮助任何人......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-26T14:49:58.340

我不知道是什么导致了我这个错误。我无法向服务添加 Web 引用，但可以添加服务引用。不幸的是，我需要网络参考。

所以我所做的就是将 WSDL 下载到我的机器上。当 VS 2012 要求提供参考 URL 时，我在我的机器上输入了 WSDL 文件的路径。这为我创建了 Web 参考。

然后我进入了reference.map，把WSDL的位置从本地路径改成了URL。我还没有尝试过，但我认为它应该可以工作......至少我创建了我的网络参考。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-09T14:52:11.247

有人摆弄了我的 IIS。该服务已禁用匿名身份验证，一旦重新启用，此错误消息就会消失。

# c# - System.Diagnostics.Process.Start() cannot start process when called from Windows service

> ID：456155
> 
> 赞同：4
> 
> 时间：2009-01-18T23:54:15.183
> 
> 标签：c#, .net, windows-services

I am trying to start an external process from a .NET Windows service. In the past I have used the `Process.Start()` overload that takes the executable path and a command line string. This works. But now I would like to start the process and have it run in the context of a particular user. So I call this version of `Start()`

```
public static Process Start(
    string fileName,
    string userName,
    SecureString password,
    string domain) 
```

However, when I call the method, the application I am trying to run generates an unhandled exception:

`The application failed to initialize properly (0xc0000142). Click on OK to terminate the application.`

I have tried to start different applications and they all generate the same exception. I have run the code outside of the Windows service and the application starts correctly.

So is there a way to get this to work in a Windows service?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T00:01:03.860

Maybe the user has to have, "logon as a service" security right. This is done with the "local security policy" application. And/or "logon as a batch job".

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-02T22:30:56.483

[这与这里](https://stackoverflow.com/questions/677874/starting-a-process-with-credentials-from-a-windows-service)的这个问题非常相似。答案通常是由于运行进程的桌面和窗口站的安全问题。有关解释和一些示例代码，请参阅[本文。](http://asprosys.blogspot.com/2009/03/perils-and-pitfalls-of-launching.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T00:23:21.303

This is just a shot in the dark, but perhaps you can try to run the Windows Service in Interactive mode. If that works, though, this can't be done in Windows Vista (because of Session 0 Isolation).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T00:00:43.440

Use Filemon and see if it is trying to open a config file and not finding it. I once had this error due to a malformed config.

# flash - 有谁知道现在哪个幻灯片脚本正在使用 Tumblr.com？

> ID：456158
> 
> 赞同：1
> 
> 时间：2009-01-18T23:57:14.087
> 
> 标签：flash, scripting

这是网址。

[http://www.tumblr.com/](http://www.tumblr.com/)

我认为它基于原型，并且使用 XML 作为配置文件。

任何的想法？

我需要这样的脚本，底部有一个标题栏。

谢谢！

PD：这是源代码：

```
<div id="featured_tumblelogs" style="margin-bottom:25px;">
    <a href="http://hrrrthrrr.tumblr.com/" target="_blank"><img src="http://assets.tumblr.com/images/featured_tumblelogs/hrrrthrrr_375.jpg"/></a>
</div>

<script type="text/javascript">
    var so = new SWFObject("/swf/slideshow.swf", "featured", "600", "375", "7", "#000000");
    so.addVariable("showLogo", "false"); 
    so.addVariable("showVersionInfo", "false");
    so.addVariable("dataFile", "/index_slideshow.xml?4");
    if (so.write("featured_tumblelogs")) {
        // $('featured_tumblelogs').style.marginBottom = '25px';
    }
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T00:03:44.260

看起来是这个：[http ://www.monoslideshow.com/](http://www.monoslideshow.com/)

# java - 在后台在服务器上运行定期任务

> ID：456162
> 
> 赞同：4
> 
> 时间：2009-01-18T23:57:58.860
> 
> 标签：java, web-services, tomcat, daemon

在 tomcat/jetty 服务器上运行定期任务（如守护线程）的最佳/最简单方法是什么？如何启动线程？是否有一个简单的机制或者这是一个坏主意？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T01:17:22.850

如果想将所有内容都保留在 java 端，请查看[Quartz](http://www.quartz-scheduler.org/)。
它处理故障转移和作业的细粒度重新分区，具有与 cron 作业相同的灵活性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T02:22:28.927

在ServeletContext 中存储一个java.util.Timer（或更好的ScheduledExecutor）实例是可行且有效的。在 Servlet 的 init() 调用中创建它，您的所有 servlet 都可以将 TimerTasks 添加到它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T00:00:54.093

适用于许多系统的一种通用方法是简单地拥有一个对您的应用程序执行定期 wget 的 cron 作业。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T00:24:55.217

我无法回答 tomcat/jetty 的问题，但我已经用基于 Python 的网络应用程序做过类似的事情。

我通常只运行一个单独的应用程序来执行所需的定期任务。如果网站和应用程序之间需要互操作，则可以通过某种 API（使用 XML-RPC/unix 套接字/等）或仅通过数据库层进行通信，如果这足够的话。

希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T21:05:09.923

如果您想使用 cron 作业但没有对开发系统的管理访问权限，您可以通过执行以下命令来执行用户 crontab：

```
crontab -e 
```

它在大多数系统上默认使用 vi，但您可以通过以下方式将其更改为您选择的编辑器：

```
export EDITOR=/usr/local/bin/my_editor 
```

然后，执行 crontab -e 命令将在您的编辑器中启动您的 crontab 文件。保存后，更改将提交回系统的 cron。

# javascript - 如何制作像 Stackoverflow 这样的可折叠评论框

> ID：456163
> 
> 赞同：3
> 
> 时间：2009-01-18T23:58:58.607
> 
> 标签：javascript, jquery, asp.net-mvc

我正在建立一个网站，我有一个状态更新列表，我希望允许用户为列表中的每个项目写评论

但是，我正在尝试实现一个类似于堆栈溢出方式的 UI，特别是可折叠的评论表单/列表，其中用户单击添加评论列表中的特定状态更新，并在列表中的该项目下方显示评论输入表单以及已经发布的具体评论。

如何使用 Jquery 完成此任务？

**注意：**还要寻找标记示例，另一个词是工作示例。谢谢，是的，如果您可以显示异步回发，那也很好

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T22:25:58.683

要加载内容，您只需连接一个单击事件以使用 load 方法填充 div。

例如，在视图中，您可能有以下内容：-

 `````
<%= Html.ActionLink("Comments", "CommentList", "Questions", new { Id = this.ViewData.Model.Id }, new { id = "commentLink" })%>

<div id="commentContainer" style="display:none;">
    Loading...
</div> 
````  `而连接所有内容的javascript将是：-

 `````
 $(function() {
        $("#commentLink").click(function() {
            $("#commentContainer").toggle();
            if ($("#commentContainer").is(":visible")) {
                $("#commentContainer").load($(this).attr("href"));
            } else {
                $("#commentContainer").html("Loading..."); //Or just leave it as is...
            }
            return false; //Prevent default action
        });
    }); 
````  `* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T00:21:33.147

快速方法（仅用于显示/隐藏评论区域）类似于以下内容：

```
$(function(){
   $('#id_of_element_to_use_for_click').click(function(){
      $('#id_of_comment_area').slideToggle();
   });
}); 
```

jQuery 站点将为您提供有关不同方法的文档，例如淡入淡出、幻灯片或其他组合动画。

我在此处的示例中使用的“评论区”可能是一个`<div>`标签，其中包含您现有的评论，以及您希望用户输入答案的任何文本区域或文本输入框。

你需要做一个异步回发吗？

# sql - 如何在递归 SQL 查询中查找子树中的所有节点？

> ID：456172
> 
> 赞同：5
> 
> 时间：2009-01-19T00:03:47.943
> 
> 标签：sql, recursion, tree, odbc

我有一个表，它定义了节点之间的子父关系：

```
CREATE TABLE node (                           ' pseudo code alert
  id        INTEGER PRIMARY KEY,
  parentID  INTEGER, ' should be a valid id.
) 
```

如果`parentID`总是指向一个有效的现有节点，那么这自然会定义一个树结构。

如果`parentID`是，`NULL`那么我们可以假设该节点是根节点。

我将如何：

1.  查找作为给定节点的后代的所有节点？
2.  查找给定节点下的所有节点到特定深度？

我想将这些中的每一个都作为一个 SQL（我希望它一定是递归的）或两个相互递归的查询来完成。

我在 ODBC 上下文中执行此操作，因此我不能依赖任何供应商特定的功能。

**编辑**

*   还没有写表，所以添加额外的列/表是完全可以接受的。
*   树可能会经常更新和添加；辅助数据结构/表/列是可能的，但需要保持最新。如果您有任何魔法书籍可以进行此类查询，我想知道。

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T12:38:34.970

[此链接](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)提供有关邻接列表模型（如问题中所述）和嵌套集模型的教程。它是作为 MySQL 文档的一部分编写的。

那篇文章中没有讨论的是插入/删除时间，以及这两种方法的维护成本。例如：

*   使用嵌套集模型的动态生长树似乎需要一些维护来维护嵌套（例如重新编号所有左右集编号）
*   删除邻接表模型中的节点需要至少更新另一行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T00:31:33.067

> 如果您有任何魔法书籍可以进行此类查询，我想知道。

Celko*在 SQL 中的树和层次结构*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T13:19:33.593

将根节点 ID 的整个“路径”存储在单独的列中，确保在开头和结尾也使用分隔符。例如，假设 1 是 5 的父级，它是 17 的父级，并且您的分隔符是破折号，您可以将值 -1-5-17- 存储在路径列中。

现在要查找 5 的所有孩子，您只需选择路径包含 -5- 的记录

末尾的分隔符是必需的，因此当您使用 LIKE 时，您无需担心位于字段最左端或最右端的 ID。

至于你的深度问题，如果你在表中添加一个深度列来指示当前的嵌套深度，这也变得很容易。您查找起始节点的深度，然后将 x 添加到其中，其中 x 是您要搜索的深度级别数，然后过滤掉深度大于该深度的记录。

# c# - C#如何确保焦点丢失时选定的节点保持突出显示

> ID：456174
> 
> 赞同：6
> 
> 时间：2009-01-19T00:04:29.703
> 
> 标签：c#, treeview

我改变了 Treeview.HideSelection = false; 但是我如何确保在失去焦点时所选项目保持原来的所选颜色？

编辑：

我在一个包含流程事件列表的表单上有一个列表视图。在同一表单上的 Treeview 旁边是用户完成的一系列选择，用于对列表视图中的事件进行分类。但是，当用户在其中一个分类控件上进行选择时，蓝色突出显示的选定 Treeview 项目变为灰色。我希望找到定义这种颜色的属性，使其成为相同的蓝色。

有什么建议么。

更新：

```
 public partial class myTreeView : TreeView
{
    TreeNode tn = null;
    public myTreeView()
    {
        InitializeComponent();
    }

    protected override void OnAfterSelect(TreeViewEventArgs e)
    {
        if (tn != null)
        {
            tn.BackColor = this.BackColor;
            tn.ForeColor = this.ForeColor;
        }
        tn = e.Node;
        base.OnAfterSelect(e);
    }
    protected override void OnBeforeSelect(TreeViewCancelEventArgs e)
    {

        e.Node.BackColor = Color.Green;
        e.Node.ForeColor = Color.White;
        base.OnBeforeSelect(e);
    }
    protected override void OnGotFocus(System.EventArgs e)
    {

        base.OnGotFocus(e);
    }

    protected override void OnLostFocus(System.EventArgs e)
    {

        if (tn != null)
        {
            tn.BackColor = Color.Green;
            tn.ForeColor = Color.White;
        }
        // tn.BackColor = Color.Red;

        base.OnLostFocus(e);
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-19T02:46:58.830

设置`ListView.HideSelection`为 true 意味着当失去焦点时，它将隐藏选择。通过设置`HideSelection`为 false，所选项目仍将有颜色指示器显示已选择的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T02:10:36.517

一般来说，你不会。颜色的变化是指示哪个控件具有焦点的视觉提示之一。不要通过摆脱它来混淆你的客户。

如果你想打破惯例，那么你可以让你的控件由所有者绘制，然后你可以为项目绘制任何你想要的颜色。

在您的情况下，另一种选择是使用下拉组合框而不是列表框。那么当前的选择总是清晰的，不管控件是否有焦点。或者，您可以考虑使用网格，其中每个事件的所有设置都单独给出，然后“选择”根本不重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T12:35:18.050

如果我这样做，我只需在 ListView 旁边有一个额外的标签，在选择的分类控件上方，它会指示选择了哪个流程事件。您还可以使用所述标签添加有关事件的额外详细信息（如果有）。

这样，您就可以坚持标准的 UI 约定**，**让用户更清楚他们当前的选择是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-09T06:45:09.213

我使用此代码；这个对我有用。

设计：`Mytreeview.HideSelection = True`您将手动突出显示失去焦点的选定节点。

```
Private Sub MyTreeview_Leave(sender As Object, e As EventArgs) Handles MyTreeview.Leave
    MyTreeview.SelectedNode.BackColor = Color.LemonChiffon
End Sub

Private Sub MyTreeview_BeforeSelect(sender As Object, e As TreeViewCancelEventArgs) Handles MyTreeview.BeforeSelect
    If MyTreeview.SelectedNode IsNot Nothing Then 
        MyTreeview.SelectedNode.BackColor = Color.White
End Sub 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-10-21T11:01:01.190

我喜欢 HideSelection = false; 回答，因为：

1.  这简单

2.  我有一个搜索功能，可以循环遍历节点并通过将其背景更改为黄色来标记相关节点，当用户单击节点时，文本框会在我使用此方法之前填充附加到该节点的相关信息，如果用户单击文本框滚动浏览它，它会取消突出显示节点，并且很难跟踪选择了哪个节点，这样它仍然以浅灰色突出显示它没有焦点，与蓝色突出显示相反对焦时使用。我本可以“绘制”节点，但搜索结果的黄色背景会使生活变得比需要的更复杂。

3.  我有没有提到这很容易？

# algorithm - 确定文件身份的算法

> ID：456175
> 
> 赞同：5
> 
> 时间：2009-01-19T00:05:25.380
> 
> 标签：algorithm, filesystems, virtualfilesystem

对于一个开源项目，我正在文件系统之上编写一个抽象层。

该层允许我将元数据和关系附加到每个文件。

如果文件被重命名/移动或复制，我希望该层能够优雅地处理文件重命名并维护元数据。

为此，我需要一种计算文件身份的机制。显而易见的解决方案是为每个文件计算一个 SHA1 哈希，然后针对该哈希分配元数据。但是……那真的很贵，尤其是电影。

所以，我一直在考虑一种算法，虽然不是 100% 正确，但在绝大多数情况下都是正确的，而且很便宜。

一种这样的算法可能是使用文件大小和该文件的字节样本来计算散列。

我应该为样本选择哪些字节？如何保持计算便宜且相当准确？我知道这里需要权衡，但性能至关重要。并且用户将能够处理系统出错的情况。

我需要这个算法来处理非常大的文件（1GB+ 和 5K 的小文件）

**编辑**

我需要这个算法在 NTFS 和所有 SMB 共享（基于 Linux 或 Windows）上工作，我希望它支持文件从一个位置复制到另一个位置的情况（存在 2 个物理副本被视为一个身份）。我什至可能会考虑希望它在 MP3 被重新标记的情况下工作（物理文件已更改，因此我可能对每种文件类型都有一个身份提供者）。

**编辑 2**

相关问题：[确定文件身份的算法（优化）](https://stackoverflow.com/questions/788761/algorithm-for-determining-a-files-identity-optimisation)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T16:36:58.467

Bucketing，多层比较应该在您正在讨论的文件范围内最快且可扩展。

第一级索引只是文件的长度。

第二级是哈希。低于一定大小，它是整个文件的散列。除此之外，是的，我同意您对采样算法的想法。我认为可能会影响采样速度的问题：

1.  为避免碰到可能高度相似或相同的规则间隔的标题，您需要插入一个不一致的数字，例如：素数或连续素数的倍数。
2.  避免可能最终遇到常规记录标头的步骤，因此，如果尽管位置不同，您仍从样本字节中获得相同的值，请尝试将步骤调整为另一个素数。
3.  处理具有大量相同值的异常文件，因为它们是未编码的图像，或者只是填充了空值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T01:11:07.680

做第一个 128k，在 1mb 标记处再做 128k，在 10mb 标记处再做 128k，在 100mb 标记处再做 128k，在 1000mb 标记处再做 128k，等等。随着文件大小变大，你更有可能将能够仅根据它们的大小来区分两个文件，你散列的数据越来越小。128k以下的一切都得到了彻底的照顾。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T00:09:19.913

信不信由你，我使用刻度作为文件的最后写入时间。它尽可能便宜，我仍然看到不同文件之间的冲突。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-14T22:42:31.053

如果您可以放弃 Linux 共享要求并将自己限制在 NTFS，那么 NTFS 备用数据流将是一个完美的解决方案，它：

*   不需要任何类型的散列；
*   在重命名后幸存下来；和
*   在移动中幸存下来（即使在不同的 NTFS 卷之间）。

[你可以在这里](http://www.flexhex.com/docs/articles/alternate-streams.phtml)阅读更多关于它的信息。基本上，您只需为您的流添加一个冒号和一个名称（例如“:meta”），然后在其中写入您喜欢的任何内容。因此，如果您有一个目录“D:\Movies\Terminator”，请使用普通文件 I/O 将元数据写入“D:\Movies\Terminator:meta”。如果要保存特定文件（而不是整个文件夹）的元数据，也可以这样做。

如果您希望将元数据存储在其他地方并且只能够检测同一 NTFS 卷上的移动/重命名，则可以使用 GetFileInformationByHandle API 调用（请参阅 MSDN /en-us/library/aa364952(VS.85)。 aspx) 来获取文件夹的唯一 ID（结合 VolumeSerialNumber 和 FileIndex 成员）。如果文件/文件夹在同一卷上移动/重命名，此 ID 不会更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T00:57:50.127

如何存储一些随机整数 r [i]并查找字节（r [i] mod n），其中 n 是文件的大小？对于带有标题的文件，您可以先忽略它们，然后对剩余的字节执行此过程。

如果您的文件实际上非常不同（不仅仅是某处单个字节的差异，而是说至少有 1% 的差异），那么随机选择的字节会注意到这一点。例如，在字节数相差 1% 的情况下，100 个随机字节将无法注意到的概率为 1/e ~ 37%；增加您查看的字节数会使此概率呈指数下降。

使用随机字节背后的想法是，它们基本上可以保证（好吧，从概率上讲）与任何其他字节序列一样好，除非它们*不易*受到其他序列的一些问题的影响（例如碰巧查看每个文件格式的第 256 个字节，其中该字节必须为 0 或其他值）。

更多建议：

*   与其抓取字节，不如抓取更大的块来证明寻找的成本是合理的。
*   我建议始终查看文件的第一个块左右。由此，您可以确定文件类型等。（例如，您可以使用该`file`程序。）
*   至少权衡整个文件的CRC之类的成本/收益。它不像真正的加密哈希函数那样昂贵，但仍然需要读取整个文件。好处是它*会*注意到单字节的差异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T00:09:50.037

嗯，首先你需要更深入地研究文件系统是如何工作的。您将使用哪些文件系统？大多数文件系统都支持硬链接和软链接，因此“文件名”信息不一定存储在文件本身的元数据中。

实际上，这是可堆叠分层文件系统的全部要点，您可以通过各种方式对其进行扩展，例如支持压缩或加密。这就是“vnodes”的全部意义所在。您实际上可以通过多种方式做到这一点。其中一些非常依赖于您正在查看的平台。这在使用 VFS 概念的 UNIX/Linux 系统上要简单得多。例如，您可以在 ext3 之上实现您自己的层，或者您拥有什么。

** 阅读您的编辑后，还有更多内容。如前所述，文件系统已经使用 inode 之类的东西来做到这一点。散列可能不是一个好主意，不仅因为它很昂贵，而且因为两个或多个原像可以共享同一个图像；也就是说，两个完全不同的文件可以具有相同的哈希值。我认为您真正想做的是利用文件系统已经公开的元数据。当然，这在开源系统上会更简单。:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T00:57:01.393

> 我应该为样本选择哪些字节？

我想我会尝试使用一些算术级数，比如斐波那契数。这些很容易计算，并且它们的密度越来越小。小文件比大文件具有更高的采样率，并且样本仍然会超过整个文件中的点。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-19T03:49:50.637

这项工作听起来可以在文件系统级别更有效地实现，或者使用版​​本控制系统的一些松散近似（两者？）。

为了解决最初的问题，您可以为每个文件保留一个（文件大小、散列的字节数、散列）数据库，并尝试最小化每个文件大小的散列字节数。每当您检测到冲突时，您要么拥有相同的文件，要么增加哈希长度以超过第一个差异。

毫无疑问，需要进行优化以及 CPU 与 I/O 的权衡，但对于不会出现误报的事情来说，这是一个好的开始。

# javascript - Javascript 中的函数重载 - 最佳实践

> ID：456177
> 
> 赞同：860
> 
> 时间：2009-01-19T00:06:27.343
> 
> 标签：javascript, overloading

在 Javascript 中伪造函数重载的最佳方法是什么？

我知道不可能像在其他语言中那样重载 Javascript 中的函数。如果我需要一个具有两种用途的功能，`foo(x)`并且`foo(x,y,z)`这是最好/首选的方式：

1.  首先使用不同的名称
2.  使用可选参数，如`y = y || 'default'`
3.  使用参数数量
4.  检查参数的类型
5.  或者怎么做？

* * *

## 回答 #1

> 赞同：678
> 
> 时间：2009-01-19T13:32:17.107

使用参数进行函数重载的最好方法是不检查参数长度或类型；检查类型只会让你的代码变慢，你会享受到数组、空值、对象等的乐趣。

大多数开发人员所做的是将对象作为其方法的最后一个参数。这个对象可以容纳任何东西。

```
function foo(a, b, opts) {
  // ...
  if (opts['test']) { } //if test param exists, do something.. 
}

foo(1, 2, {"method":"add"});
foo(3, 4, {"test":"equals", "bar":"tree"}); 
```

然后你可以用你的方法来处理它。[开关、if-else 等]

* * *

## 回答 #2

> 赞同：191
> 
> 时间：2012-02-15T17:19:46.420

我经常这样做：

C＃：

```
public string CatStrings(string p1)                  {return p1;}
public string CatStrings(string p1, int p2)          {return p1+p2.ToString();}
public string CatStrings(string p1, int p2, bool p3) {return p1+p2.ToString()+p3.ToString();}

CatStrings("one");        // result = one
CatStrings("one",2);      // result = one2
CatStrings("one",2,true); // result = one2true 
```

JavaScript 等价物：

```
function CatStrings(p1, p2, p3)
{
  var s = p1;
  if(typeof p2 !== "undefined") {s += p2;}
  if(typeof p3 !== "undefined") {s += p3;}
  return s;
};

CatStrings("one");        // result = one
CatStrings("one",2);      // result = one2
CatStrings("one",2,true); // result = one2true 
```

这个特定的例子实际上在 javascript 中比在 C# 中更优雅。未指定的参数在 javascript 中为“未定义”，在 if 语句中计算为 false。但是，函数定义没有传达 p2 和 p3 是可选的信息。如果需要大量重载，jQuery 决定使用一个对象作为参数，例如 jQuery.ajax(options)。我同意他们的观点，这是最强大且可清楚记录的重载方法，但我很少需要超过一两个快速可选参数。

编辑：根据 Ian 的建议更改了 IF 测试

* * *

## 回答 #3

> 赞同：100
> 
> 时间：2009-01-19T00:12:54.693

JavaScript 中没有真正的函数重载，因为它允许传递任意数量的任意类型的参数。您必须在函数内部检查传递了多少[参数](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Functions_and_function_scope/arguments)以及它们是什么类型。

* * *

## 回答 #4

> 赞同：94
> 
> 时间：2015-11-03T18:21:52.953

正确答案是 JAVASCRIPT 没有重载。

函数内部的检查/切换不是过载。

重载的概念：在某些编程语言中，函数重载或方法重载是能够创建多个具有不同实现的同名方法。对重载函数的调用将运行适合于调用上下文的该函数的特定实现，允许一个函数调用根据上下文执行不同的任务。

例如，doTask() 和 doTask(object O) 是重载方法。要调用后者，必须将对象作为参数传递，而前者不需要参数，并且使用空参数字段调用。一个常见的错误是在第二种方法中为对象分配默认值，这将导致不明确的调用错误，因为编译器不知道要使用这两种方法中的哪一种。

[https://en.wikipedia.org/wiki/Function_overloading](https://en.wikipedia.org/wiki/Function_overloading)

所有建议的实现都很棒，但说实话，JavaScript 没有原生实现。

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2009-01-19T00:50:52.153

有两种方法可以更好地解决这个问题：

1.  如果您想保留很大的灵活性，请传递字典（关联数组）

2.  将对象作为参数并使用基于原型的继承来增加灵活性。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2011-12-26T12:13:22.350

这是一种允许使用参数类型进行真实方法重载的方法，如下所示：

```
Func(new Point());
Func(new Dimension());
Func(new Dimension(), new Point());
Func(0, 0, 0, 0); 
```

**编辑（2018）**：自 2011 年编写以来，直接方法调用的速度大大提高，而重载方法的速度却没有。

这不是我推荐的方法，但考虑如何解决这些类型的问题是一个值得思考的练习。

* * *

这是不同方法的基准 - [https://jsperf.com/function-overloading](https://jsperf.com/function-overloading)。**它表明，从16.0(beta)**开始，Google **Chrome 的 V8**中的函数重载（考虑到类型）可能会**慢 13 倍**左右。

 ****除了传递一个对象（即`{x: 0, y: 0}`），还可以在适当的时候采用 C 方法，相应地命名方法。例如，Vector.AddVector(vector)、Vector.AddIntegers(x, y, z, ...) 和 Vector.AddArray(integerArray)。您可以查看 C 库，例如 OpenGL，以获得命名灵感。

**编辑**：我添加了一个用于传递对象并使用 and 测试对象的基准`'param' in arg`，`arg.hasOwnProperty('param')`并且函数重载比传递对象和检查属性要快得多（至少在这个基准中）。

从设计的角度来看，函数重载只有在重载的参数对应于相同的动作时才有效或合乎逻辑。所以理所当然地应该有一个只关注特定细节的底层方法，否则可能表明设计选择不合适。因此，还可以通过将数据转换为相应的对象来解决函数重载的问题。当然，必须考虑问题的范围，因为如果您的意图只是打印一个名称，则无需进行精心设计，但是对于框架和库的设计，这种想法是合理的。

我的例子来自一个 Rectangle 实现——因此提到了 Dimension 和 Point。或许Rectangle可以给和原型加个`GetRectangle()`方法，然后函数重载问题就解决了。那么原始人呢？好吧，我们有参数长度，现在这是一个有效的测试，因为对象有一个方法。`Dimension``Point``GetRectangle()`

```
function Dimension() {}
function Point() {}

var Util = {};

Util.Redirect = function (args, func) {
  'use strict';
  var REDIRECT_ARGUMENT_COUNT = 2;

  if(arguments.length - REDIRECT_ARGUMENT_COUNT !== args.length) {
    return null;
  }

  for(var i = REDIRECT_ARGUMENT_COUNT; i < arguments.length; ++i) {
    var argsIndex = i-REDIRECT_ARGUMENT_COUNT;
    var currentArgument = args[argsIndex];
    var currentType = arguments[i];
    if(typeof(currentType) === 'object') {
      currentType = currentType.constructor;
    }
    if(typeof(currentType) === 'number') {
      currentType = 'number';
    }
    if(typeof(currentType) === 'string' && currentType === '') {
      currentType = 'string';
    }
    if(typeof(currentType) === 'function') {
      if(!(currentArgument instanceof currentType)) {
        return null;
      }
    } else {
      if(typeof(currentArgument) !== currentType) {
        return null;
      }
    } 
  }
  return [func.apply(this, args)];
}

function FuncPoint(point) {}
function FuncDimension(dimension) {}
function FuncDimensionPoint(dimension, point) {}
function FuncXYWidthHeight(x, y, width, height) { }

function Func() {
  Util.Redirect(arguments, FuncPoint, Point);
  Util.Redirect(arguments, FuncDimension, Dimension);
  Util.Redirect(arguments, FuncDimensionPoint, Dimension, Point);
  Util.Redirect(arguments, FuncXYWidthHeight, 0, 0, 0, 0);
}

Func(new Point());
Func(new Dimension());
Func(new Dimension(), new Point());
Func(0, 0, 0, 0); 
```

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2009-01-19T01:30:40.997

最好的方法实际上取决于函数和参数。在不同的情况下，您的每个选项都是一个好主意。我通常按​​以下顺序尝试这些，直到其中一个起作用：

1.  **使用可选参数，如 y = y || '默认'。**如果你能做到，这很方便，但它可能并不总是有效，例如当 0/null/undefined 是一个有效的参数时。

2.  **使用参数数量。**类似于最后一个选项，但当 #1 不起作用时可能会起作用。

3.  **检查参数的类型。**这可以在参数数量相同的某些情况下起作用。如果您不能可靠地确定类型，则可能需要使用不同的名称。

4.  **首先使用不同的名称。**如果其他选项不起作用、不实用或与其他相关功能保持一致，您可能需要执行此操作。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2014-09-13T06:44:33.470

> 如果我需要一个有两个用途的函数 foo(x) 和 foo(x,y,z) 哪个是最好/首选的方式？

**问题是 JavaScript 本身并不支持方法重载。因此，如果它看到/解析两个或多个具有相同名称的函数，它只会考虑最后定义的函数并覆盖以前的函数。**

我认为适合大多数情况的一种方式如下 -

假设你有方法

```
function foo(x)
{
} 
```

您可以定义一个新方法**，而不是在 javascript 中不可能**的重载方法

```
fooNew(x,y,z)
{
} 
```

然后修改第一个函数如下 -

```
function foo(arguments)
{
  if(arguments.length==2)
  {
     return fooNew(arguments[0],  arguments[1]);
  }
} 
```

如果您有许多这样的重载方法，请考虑使用`switch`不仅仅是`if-else`语句。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2015-04-06T14:31:25.307

我不确定最佳实践，但这是我的做法：

```
/*
 * Object Constructor
 */
var foo = function(x) {
    this.x = x;
};

/*
 * Object Protoype
 */
foo.prototype = {
    /*
     * f is the name that is going to be used to call the various overloaded versions
     */
    f: function() {

        /*
         * Save 'this' in order to use it inside the overloaded functions
         * because there 'this' has a different meaning.
         */   
        var that = this;  

        /* 
         * Define three overloaded functions
         */
        var f1 = function(arg1) {
            console.log("f1 called with " + arg1);
            return arg1 + that.x;
        }

        var f2 = function(arg1, arg2) {
             console.log("f2 called with " + arg1 + " and " + arg2);
             return arg1 + arg2 + that.x;
        }

        var f3 = function(arg1) {
             console.log("f3 called with [" + arg1[0] + ", " + arg1[1] + "]");
             return arg1[0] + arg1[1];
        }

        /*
         * Use the arguments array-like object to decide which function to execute when calling f(...)
         */
        if (arguments.length === 1 && !Array.isArray(arguments[0])) {
            return f1(arguments[0]);
        } else if (arguments.length === 2) {
            return f2(arguments[0], arguments[1]);
        } else if (arguments.length === 1 && Array.isArray(arguments[0])) {
            return f3(arguments[0]);
        }
    } 
}

/* 
 * Instantiate an object
 */
var obj = new foo("z");

/*
 * Call the overloaded functions using f(...)
 */
console.log(obj.f("x"));         // executes f1, returns "xz"
console.log(obj.f("x", "y"));    // executes f2, returns "xyz"
console.log(obj.f(["x", "y"]));  // executes f3, returns "xy" 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2013-06-16T20:16:34.167

我刚试过这个，也许它适合你的需要。根据参数的数量，您可以访问不同的函数。您在第一次调用它时对其进行初始化。并且函数映射隐藏在闭包中。

```
TEST = {};

TEST.multiFn = function(){
    // function map for our overloads
    var fnMap = {};

    fnMap[0] = function(){
        console.log("nothing here");
        return this;    //    support chaining
    }

    fnMap[1] = function(arg1){
        //    CODE here...
        console.log("1 arg: "+arg1);
        return this;
    };

    fnMap[2] = function(arg1, arg2){
        //    CODE here...
        console.log("2 args: "+arg1+", "+arg2);
        return this;
    };

    fnMap[3] = function(arg1,arg2,arg3){
        //    CODE here...
        console.log("3 args: "+arg1+", "+arg2+", "+arg3);
        return this;
    };

    console.log("multiFn is now initialized");

    //    redefine the function using the fnMap in the closure
    this.multiFn = function(){
        fnMap[arguments.length].apply(this, arguments);
        return this;
    };

    //    call the function since this code will only run once
    this.multiFn.apply(this, arguments);

    return this;    
}; 
```

测试一下。

```
TEST.multiFn("0")
    .multiFn()
    .multiFn("0","1","2"); 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2021-06-01T07:55:51.300

不是每个人都知道您可以直接在函数签名中进行[解构赋值。](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)

多亏了这一点，您可以轻松定义一个非常灵活的方法签名，即恕我直言，优于 Java 方法重载。

例子：

```
const myFunction = (({a, b, c}) => {
    console.log(a, b, c);
});

myFunction({a: 1, b: 2});
myFunction({a: 1, b: 2, c: 3}); 
```

您甚至不需要尊重参数的顺序，调用语句和目标方法签名之间存在命名一致性。

您还可以分配**默认值**：

```
const myFunction = (({a = 1, b = 2, c}) => {
    console.log(a, b, c);
}); 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2014-01-09T02:30:21.290

由于 JavaScript 没有函数重载选项，因此可以使用对象来代替。如果有一个或两个必需的参数，最好将它们与选项对象分开。这是一个关于如何使用选项对象并将值填充为默认值的示例，以防选项对象中未传递值。

```
 function optionsObjectTest(x, y, opts) {
        opts = opts || {}; // default to an empty options object

        var stringValue = opts.stringValue || "string default value";
        var boolValue = !!opts.boolValue; // coerces value to boolean with a double negation pattern
        var numericValue = opts.numericValue === undefined ? 123 : opts.numericValue;

        return "{x:" + x + ", y:" + y + ", stringValue:'" + stringValue + "', boolValue:" + boolValue + ", numericValue:" + numericValue + "}";

} 
```

[这](http://jsfiddle.net/vlad_bezden/4ZqH7/)是一个关于如何使用选项对象的示例

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2017-08-24T14:17:56.520

**介绍**

到目前为止，阅读这么多答案会让任何人头疼。任何想了解这个概念的人都需要知道**以下先决条件**。

**`Function overloading Definition`**, **`Function Length property`**,**`Function argument property`**

`Function overloading`最简单的形式意味着函数根据传递给它的参数数量执行不同的任务。值得注意的是 TASK1、TASK2 和 TASK3 在下面突出显示，它们是根据`arguments`传递给同一函数的数量来执行的`fooYo`。

```
// if we have a function defined below
function fooYo(){
     // do something here
}
// on invoking fooYo with different number of arguments it should be capable to do different things

fooYo();  // does TASK1
fooYo('sagar'); // does TASK2
fooYo('sagar','munjal'); // does TAKS3 
```

**注意** - JS 不提供函数重载的内置能力。

**选择**

*John E Resig（JS 的创建者）指出了一个替代方案，它使用上述先决条件来实现实现函数重载的能力。*

`if-else`下面的代码通过 using or`switch`语句使用了一种简单但幼稚的方法。

*   评估`argument-length`属性。
*   不同的值会导致调用不同的函数。

```
var ninja = {
  whatever: function() {
       switch (arguments.length) {
         case 0:
           /* do something */
           break;
         case 1:
           /* do something else */
           break;
         case 2:
           /* do yet something else */
           break;
       //and so on ...
    } 
  }
}
```

另一种技术更加干净和动态。这种技术的亮点是`addMethod`泛型函数。

*   我们定义了一个函数`addMethod`，用于向**同名**但功能不同的对象添加不同的**函数**。

*   函数下面`addMethod`接受三个参数对象名`object`、函数名`name`和我们要调用的函数`fn`。

*   内部`addMethod`定义`var old`存储了对先前`function`通过闭包存储的引用 - 一个保护性气泡。

```
function addMethod(object, name, fn) {
  var old = object[name];
  object[name] = function(){
    if (fn.length == arguments.length)
      return fn.apply(this, arguments)
    else if (typeof old == 'function')
      return old.apply(this, arguments);
  };
};
```

*   使用调试器了解代码流。
*   下面`addMethod`添加了三个函数，当使用`ninja.whatever(x)`参数数量调用它们时，参数数量`x`可以是任何值，即空白或一个或多个，在使用函数时调用定义的不同`addMethod`函数。

```
var ninja = {};
debugger;

addMethod(ninja,'whatever',function(){ console.log("I am the one with ZERO arguments supplied") });
addMethod(ninja,'whatever',function(a){ console.log("I am the one with ONE arguments supplied") });
addMethod(ninja,'whatever',function(a,b){ console.log("I am the one with TWO arguments supplied") });

ninja.whatever();
ninja.whatever(1,2);
ninja.whatever(3);
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2011-12-01T09:01:20.973

没有办法在 javascript 中实现函数重载。因此，我建议使用以下`typeof()`方法而不是多个函数来伪造重载。

```
function multiTypeFunc(param)
{
    if(typeof param == 'string') {
        alert("I got a string type parameter!!");
     }else if(typeof param == 'number') {
        alert("I got a number type parameter!!");
     }else if(typeof param == 'boolean') {
        alert("I got a boolean type parameter!!");
     }else if(typeof param == 'object') {
        alert("I got a object type parameter!!");
     }else{
        alert("error : the parameter is undefined or null!!");
     }
} 
```

祝你好运！

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2017-08-24T08:03:06.883

另一种解决方法是使用特殊变量：**arguments**，这是一个实现：

```
function sum() {
    var x = 0;
    for (var i = 0; i < arguments.length; ++i) {
        x += arguments[i];
    }
    return x;
} 
```

因此您可以将此代码修改为：

```
function sum(){
    var s = 0;
    if (typeof arguments[0] !== "undefined") s += arguments[0];
.
.
.
    return s;
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2012-03-12T16:58:29.863

看一下这个。这很酷。 [http://ejohn.org/blog/javascript-method-overloading/](http://ejohn.org/blog/javascript-method-overloading/) 使用 Javascript 让您可以进行如下调用：

```
var users = new Users();
users.find(); // Finds all
users.find("John"); // Finds users by name
users.find("John", "Resig"); // Finds users by first and last name 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2016-07-19T08:18:09.140

#Forwarding Pattern => JS 重载转发到另一个函数的最佳实践，该函数的名称是从第 3 点和第 4 点构建的：

> 3.  使用参数数量
> 4.  检查参数的类型

```
window['foo_'+arguments.length+'_'+Array.from(arguments).map((arg)=>typeof arg).join('_')](...arguments) 
```

#申请您的案例：

```
 function foo(...args){
          return window['foo_' + args.length+'_'+Array.from(args).map((arg)=>typeof arg).join('_')](...args);

  }
   //------Assuming that `x` , `y` and `z` are String when calling `foo` . 

  /**-- for :  foo(x)*/
  function foo_1_string(){
  }
  /**-- for : foo(x,y,z) ---*/
  function foo_3_string_string_string(){

  } 
```

#其他复杂样本：

```
 function foo(...args){
          return window['foo_'+args.length+'_'+Array.from(args).map((arg)=>typeof arg).join('_')](...args);
       }

        /** one argument & this argument is string */
      function foo_1_string(){

      }
       //------------
       /** one argument & this argument is object */
      function foo_1_object(){

      }
      //----------
      /** two arguments & those arguments are both string */
      function foo_2_string_string(){

      }
       //--------
      /** Three arguments & those arguments are : id(number),name(string), callback(function) */
      function foo_3_number_string_function(){
                let args=arguments;
                  new Person(args[0],args[1]).onReady(args[3]);
      }

       //--- And so on .... 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2014-02-19T09:13:37.793

由于这篇文章已经包含很多不同的解决方案，我想我会发布另一个。

```
function onlyUnique(value, index, self) {
    return self.indexOf(value) === index;
}

function overload() {
   var functions = arguments;
   var nroffunctionsarguments = [arguments.length];
    for (var i = 0; i < arguments.length; i++) {
        nroffunctionsarguments[i] = arguments[i].length;
    }
    var unique = nroffunctionsarguments.filter(onlyUnique);
    if (unique.length === arguments.length) {
        return function () {
            var indexoffunction = nroffunctionsarguments.indexOf(arguments.length);
            return functions[indexoffunction].apply(this, arguments);
        }
    }
    else throw new TypeError("There are multiple functions with the same number of parameters");

} 
```

这可以如下所示使用：

```
var createVector = overload(
        function (length) {
            return { x: length / 1.414, y: length / 1.414 };
        },
        function (a, b) {
            return { x: a, y: b };
        },
        function (a, b,c) {
            return { x: a, y: b, z:c};
        }
    );
console.log(createVector(3, 4));
console.log(createVector(3, 4,5));
console.log(createVector(7.07)); 
```

这个解决方案并不完美，但我只想演示如何做到这一点。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2014-08-25T08:07:37.013

您可以使用 John Resig 的“addMethod”。使用此方法，您可以根据参数计数“重载”方法。

```
// addMethod - By John Resig (MIT Licensed)
function addMethod(object, name, fn){
    var old = object[ name ];
    object[ name ] = function(){
        if ( fn.length == arguments.length )
            return fn.apply( this, arguments );
        else if ( typeof old == 'function' )
            return old.apply( this, arguments );
    };
} 
```

我还创建了此方法的替代方法，它使用缓存来保存函数的变体。[此处描述了差异](http://jsbegin.blogspot.gr/2014/08/method-overloading-based-on-john-resigs_22.html)

```
// addMethod - By Stavros Ioannidis
function addMethod(obj, name, fn) {
  obj[name] = obj[name] || function() {
    // get the cached method with arguments.length arguments
    var method = obj[name].cache[arguments.length];

    // if method exists call it 
    if ( !! method)
      return method.apply(this, arguments);
    else throw new Error("Wrong number of arguments");
  };

  // initialize obj[name].cache
  obj[name].cache = obj[name].cache || {};

  // Check if a method with the same number of arguments exists  
  if ( !! obj[name].cache[fn.length])
    throw new Error("Cannot define multiple '" + name +
      "' methods with the same number of arguments!");

  // cache the method with fn.length arguments
  obj[name].cache[fn.length] = function() {
    return fn.apply(this, arguments);
  };
} 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2017-12-27T19:51:59.490

## 100行JS中通过动态多态实现函数重载

*   VanillaJS，没有外部依赖
*   完整的浏览器支持 - [Array.prototype.slice](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice) , [Object.prototype.toString](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/toString)
*   1114 字节 uglify'd / 744 字节 g 压缩

这是来自更大的代码主体，其中包括`isFn`,`isArr`等类型检查功能。下面的 VanillaJS 版本已经过重新设计以删除所有外部依赖项，但是您必须定义自己的类型检查函数以在`.add()`调用中使用。

**注意：**这是一个自执行函数（因此我们可以有一个闭包/封闭范围），因此分配给`window.overload`而不是`function overload() {...}`.

```
window.overload = function () {
    "use strict"

    var a_fnOverloads = [],
        _Object_prototype_toString = Object.prototype.toString
    ;

    function isFn(f) {
        return (_Object_prototype_toString.call(f) === '[object Function]');
    } //# isFn

    function isObj(o) {
        return !!(o && o === Object(o));
    } //# isObj

    function isArr(a) {
        return (_Object_prototype_toString.call(a) === '[object Array]');
    } //# isArr

    function mkArr(a) {
        return Array.prototype.slice.call(a);
    } //# mkArr

    function fnCall(fn, vContext, vArguments) {
        //# <ES5 Support for array-like objects
        //#     See: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply#Browser_compatibility
        vArguments = (isArr(vArguments) ? vArguments : mkArr(vArguments));

        if (isFn(fn)) {
            return fn.apply(vContext || this, vArguments);
        }
    } //# fnCall

    //# 
    function registerAlias(fnOverload, fn, sAlias) {
        //# 
        if (sAlias && !fnOverload[sAlias]) {
            fnOverload[sAlias] = fn;
        }
    } //# registerAlias

    //# 
    function overload(vOptions) {
        var oData = (isFn(vOptions) ?
                { default: vOptions } :
                (isObj(vOptions) ?
                    vOptions :
                    {
                        default: function (/*arguments*/) {
                            throw "Overload not found for arguments: [" + mkArr(arguments) + "]";
                        }
                    }
                )
            ),
            fnOverload = function (/*arguments*/) {
                var oEntry, i, j,
                    a = arguments,
                    oArgumentTests = oData[a.length] || []
                ;

                //# Traverse the oArgumentTests for the number of passed a(rguments), defaulting the oEntry at the beginning of each loop
                for (i = 0; i < oArgumentTests.length; i++) {
                    oEntry = oArgumentTests[i];

                    //# Traverse the passed a(rguments), if a .test for the current oArgumentTests fails, reset oEntry and fall from the a(rgument)s loop
                    for (j = 0; j < a.length; j++) {
                        if (!oArgumentTests[i].tests[j](a[j])) {
                            oEntry = undefined;
                            break;
                        }
                    }

                    //# If all of the a(rgument)s passed the .tests we found our oEntry, so break from the oArgumentTests loop
                    if (oEntry) {
                        break;
                    }
                }

                //# If we found our oEntry above, .fn.call its .fn
                if (oEntry) {
                    oEntry.calls++;
                    return fnCall(oEntry.fn, this, a);
                }
                //# Else we were unable to find a matching oArgumentTests oEntry, so .fn.call our .default
                else {
                    return fnCall(oData.default, this, a);
                }
            } //# fnOverload
        ;

        //# 
        fnOverload.add = function (fn, a_vArgumentTests, sAlias) {
            var i,
                bValid = isFn(fn),
                iLen = (isArr(a_vArgumentTests) ? a_vArgumentTests.length : 0)
            ;

            //# 
            if (bValid) {
                //# Traverse the a_vArgumentTests, processinge each to ensure they are functions (or references to )
                for (i = 0; i < iLen; i++) {
                    if (!isFn(a_vArgumentTests[i])) {
                        bValid = _false;
                    }
                }
            }

            //# If the a_vArgumentTests are bValid, set the info into oData under the a_vArgumentTests's iLen
            if (bValid) {
                oData[iLen] = oData[iLen] || [];
                oData[iLen].push({
                    fn: fn,
                    tests: a_vArgumentTests,
                    calls: 0
                });

                //# 
                registerAlias(fnOverload, fn, sAlias);

                return fnOverload;
            }
            //# Else one of the passed arguments was not bValid, so throw the error
            else {
                throw "poly.overload: All tests must be functions or strings referencing `is.*`.";
            }
        }; //# overload*.add

        //# 
        fnOverload.list = function (iArgumentCount) {
            return (arguments.length > 0 ? oData[iArgumentCount] || [] : oData);
        }; //# overload*.list

        //# 
        a_fnOverloads.push(fnOverload);
        registerAlias(fnOverload, oData.default, "default");

        return fnOverload;
    } //# overload

    //# 
    overload.is = function (fnTarget) {
        return (a_fnOverloads.indexOf(fnTarget) > -1);
    } //# overload.is

    return overload;
}(); 
```

## 用法：

调用者通过将变量分配给`overload()`. 多亏了链接，额外的重载可以串联定义：

```
var myOverloadedFn = overload(function(){ console.log("default", arguments) })
    .add(function(){ console.log("noArgs", arguments) }, [], "noArgs")
    .add(function(){ console.log("str", arguments) }, [function(s){ return typeof s === 'string' }], "str")
; 
```

`overload()`如果无法识别签名，则定义要调用的“默认”函数的单个可选参数。的论据`.add()`是：

1.  `fn`：`function`定义重载；
2.  `a_vArgumentTests`: `Array`of `function`s 定义要在`arguments`. 每个都`function`接受一个参数并`true`根据参数是否有效返回 thy；
3.  `sAlias`（可选）：`string`定义别名以直接访问重载函数（`fn`），例如`myOverloadedFn.noArgs()`将直接调用该函数，避免参数的动态多态性测试。

这个实现实际上允许的不仅仅是传统的函数重载，因为在实践中定义自定义类型的第二个`a_vArgumentTests`参数。`.add()`因此，您不仅可以基于类型，还可以基于范围、值或值集合来对参数进行门控！

如果您查看 145 行代码，`overload()`您会发现每个签名都按`arguments`传递给它的数量进行分类。这样做是为了限制我们正在运行的测试数量。我还跟踪呼叫计数。通过一些额外的代码，重载函数的数组可以重新排序，以便首先测试更常用的函数，再次添加一些性能增强措施。

现在，有一些警告......由于 Javascript 的类型很松散，你必须小心你的`vArgumentTests`as an`integer`可以被验证为 a`float`等。

JSCompress.com 版本（1114 字节，744 字节 g 压缩）：

```
window.overload=function(){'use strict';function b(n){return'[object Function]'===m.call(n)}function c(n){return!!(n&&n===Object(n))}function d(n){return'[object Array]'===m.call(n)}function e(n){return Array.prototype.slice.call(n)}function g(n,p,q){if(q=d(q)?q:e(q),b(n))return n.apply(p||this,q)}function h(n,p,q){q&&!n[q]&&(n[q]=p)}function k(n){var p=b(n)?{default:n}:c(n)?n:{default:function(){throw'Overload not found for arguments: ['+e(arguments)+']'}},q=function(){var r,s,t,u=arguments,v=p[u.length]||[];for(s=0;s<v.length;s++){for(r=v[s],t=0;t<u.length;t++)if(!v[s].tests[t](u[t])){r=void 0;break}if(r)break}return r?(r.calls++,g(r.fn,this,u)):g(p.default,this,u)};return q.add=function(r,s,t){var u,v=b(r),w=d(s)?s.length:0;if(v)for(u=0;u<w;u++)b(s[u])||(v=_false);if(v)return p[w]=p[w]||[],p[w].push({fn:r,tests:s,calls:0}),h(q,r,t),q;throw'poly.overload: All tests must be functions or strings referencing `is.*`.'},q.list=function(r){return 0<arguments.length?p[r]||[]:p},l.push(q),h(q,p.default,'default'),q}var l=[],m=Object.prototype.toString;return k.is=function(n){return-1<l.indexOf(n)},k}(); 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2019-03-02T12:15:35.870

您现在可以在 ECMAScript 2018 中进行函数重载，无需 polyfill、检查 var 长度/类型等，**只需使用[扩展语法](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax#Spread_in_object_literals)。**

```
function foo(var1, var2, opts){
  // set default values for parameters
  const defaultOpts = {
    a: [1,2,3],
    b: true,
    c: 0.3289,
    d: "str",
  }
  // merge default and passed-in parameters
  // defaultOpts must go first!
  const mergedOpts = {...defaultOpts, ...opts};

  // you can now refer to parameters like b as mergedOpts.b,
  // or just assign mergedOpts.b to b
  console.log(mergedOpts.a);
  console.log(mergedOpts.b);
  console.log(mergedOpts.c);  
  console.log(mergedOpts.d);
}
// the parameters you passed in override the default ones
// all JS types are supported: primitives, objects, arrays, functions, etc.
let var1, var2="random var";
foo(var1, var2, {a: [1,2], d: "differentString"});

// parameter values inside foo:
//a: [1,2]
//b: true
//c: 0.3289
//d: "differentString"
```

## 什么是传播语法？

> ECMAScript 提案的 Rest/Spread Properties（第 4 阶段）将扩展属性添加到对象文字。它将自己的可枚举属性从提供的对象复制到新对象上。 [更多关于 mdn](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax#Spread_in_object_literals)

注意：对象字面量中的扩展语法在 Edge 和 IE 中不起作用，它是一个实验性功能。[查看浏览器兼容性](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax#Browser_compatibility)

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2019-04-01T08:05:54.947

JS 中没有实际的重载，无论如何我们仍然可以通过以下几种方式模拟方法重载：

**方法#1：** *使用对象*

```
function test(x,options){
  if("a" in options)doSomething();
  else if("b" in options)doSomethingElse();
}
test("ok",{a:1});
test("ok",{b:"string"}); 
```

**方法#2：** *使用剩余（传播）参数*

```
function test(x,...p){
 if(p[2])console.log("3 params passed"); //or if(typeof p[2]=="string")
else if (p[1])console.log("2 params passed");
else console.log("1 param passed");
} 
```

**方法#3：** *使用未定义*

```
function test(x, y, z){
 if(typeof(z)=="undefined")doSomething();
} 
```

**方法#4：** *类型检查*

```
function test(x){
 if(typeof(x)=="string")console.log("a string passed")
 else ...
} 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2019-04-14T02:45:36.643

可以为函数重载做这样的事情。

```
function addCSS(el, prop, val) {
  return {
    2: function() {
      // when two arguments are set
      // now prop is an oject
      for (var i in prop) {
          el.style[i] = prop[i];
      }
    },
    3: function() {
      // when three arguments are set
      el.style[prop] = val;
    }
    }[arguments.length]();
}
// usage
var el = document.getElementById("demo");
addCSS(el, "color", "blue");
addCSS(el, {
    "backgroundColor": "black",
  "padding": "10px"
}); 
```

[来源](https://developer.hyvor.com/tricks/js-function-overloading)

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2019-06-23T09:42:43.600

## Javascript中的函数重载：

函数重载是编程语言创建具有不同实现的多个同名函数的能力。当调用重载函数时，它将运行适合于调用上下文的该函数的特定实现。这个上下文通常是接收的参数数量，它允许一个函数调用根据上下文表现不同。

Javascript**没有**内置函数重载。但是，可以通过多种方式模拟此行为。这是一个方便简单的：

```
function sayHi(a, b) {
  console.log('hi there ' + a);
  if (b) { console.log('and ' + b) } // if the parameter is present, execute the block
}

sayHi('Frank', 'Willem');
```

在您不知道将获得多少参数的情况下，您可以使用**rest 运算符**，即三个点`...`。它将剩余的参数转换成一个数组。不过要注意浏览器的兼容性。这是一个例子：

```
function foo (a, ...b) {
  console.log(b);
}

foo(1,2,3,4);
foo(1,2);
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2020-01-16T15:36:59.353

虽然**默认参数**没有重载，但它可能会解决开发人员在这方面面临的一些问题。输入严格由顺序决定，您不能像在经典重载中那样随意重新排序：

```
function transformer(
    firstNumber = 1,
    secondNumber = new Date().getFullYear(),
    transform = function multiply(firstNumber, secondNumber) {
        return firstNumber * secondNumber;
    }
) {
    return transform(firstNumber, secondNumber);
}

console.info(transformer());
console.info(transformer(8));
console.info(transformer(2, 6));
console.info(transformer(undefined, 65));

function add(firstNumber, secondNumber) {
    return firstNumber + secondNumber;
}
console.info(transformer(undefined, undefined, add));
console.info(transformer(3, undefined, add)); 
```

结果（2020 年）：

```
2020
16160
12
65
2021
2023 
```

更多信息：[https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters)

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2013-10-07T15:58:07.430

我们提出[over.js](http://github.com/stretchr/over.js)来解决这个问题是一种非常优雅的方式。你可以做：

```
var obj = {

  /**
   * Says something in the console.
   *
   * say(msg) - Says something once.
   * say(msg, times) - Says something many times.
   */
  say: Over(
    function(msg$string){
      console.info(msg$string);
    },
    function(msg$string, times$number){
      for (var i = 0; i < times$number; i++) this.say(msg$string);
    }
  )

}; 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2014-05-20T18:38:40.937

这是一个古老的问题，但我认为需要另一个条目（尽管我怀疑有人会阅读它）。立即调用函数表达式 (IIFE) 的使用可以与闭包和内联函数结合使用，以允许函数重载。考虑以下（人为的）示例：

```
var foo;

// original 'foo' definition
foo = function(a) {
  console.log("a: " + a);
}

// define 'foo' to accept two arguments
foo = (function() {
  // store a reference to the previous definition of 'foo'
  var old = foo;

  // use inline function so that you can refer to it internally
  return function newFoo(a,b) {

    // check that the arguments.length == the number of arguments 
    // defined for 'newFoo'
    if (arguments.length == newFoo.length) {
      console.log("a: " + a);
      console.log("b: " + b);

    // else if 'old' is a function, apply it to the arguments
    } else if (({}).toString.call(old) === '[object Function]') {
      old.apply(null, arguments);
    }
  }
})();

foo(1);
> a: 1
foo(1,2);
> a: 1
> b: 2
foo(1,2,3)
> a: 1 
```

简而言之，IIFE 的使用创建了一个局部范围，允许我们定义私有变量`old`来存储对函数初始定义的引用`foo`。然后，此函数返回一个内联函数`newFoo`，如果恰好传递了两个参数，则该函数记录两个参数的内容，`a`或者`b`调用`old`函数 if `arguments.length !== 2`。这种模式可以重复任意次数，以赋予一个变量几个不同的功能定义。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2014-12-15T09:13:53.190

我想分享一个类似重载方法的有用示例。

```
function Clear(control)
{
  var o = typeof control !== "undefined" ? control : document.body;
  var children = o.childNodes;
  while (o.childNodes.length > 0)
    o.removeChild(o.firstChild);
} 
```

用法：清除（）；// 清除所有文档

清除（myDiv）；// 清除 myDiv 引用的面板

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2016-11-25T19:39:55.473

JavaScript 是无类型语言，我只认为在参数数量方面重载方法/函数才有意义。因此，我建议检查参数是否已定义：

```
myFunction = function(a, b, c) {
     if (b === undefined && c === undefined ){
          // do x...
     }
     else {
          // do y...
     }
}; 
```

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2017-07-24T08:10:28.473

截至 2017 年 7 月，以下是常用技术。请注意，我们还可以在函数内执行类型检查。

```
function f(...rest){   // rest is an array
   console.log(rest.length);
   for (v of rest) if (typeof(v)=="number")console.log(v);
}
f(1,2,3);  // 3 1 2 3 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2017-11-01T06:40:03.377

对于您的用例，这就是我将如何处理它`ES6`（因为它已经是 2017 年底）：

```
const foo = (x, y, z) => {
  if (y && z) {
    // Do your foo(x, y, z); functionality
    return output;
  }
  // Do your foo(x); functionality
  return output;
} 
```

您显然可以调整它以使用任何数量的参数，并相应地更改您的条件语句。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2020-11-04T15:38:48.770

Typescript Handbook 提到了[Overloads](https://www.typescriptlang.org/docs/handbook/functions.html#overloads)。虽然之前已经提到过检查类型并根据结果执行不同的逻辑，但这种定义多个命名函数以与类型系统一起工作的方法可能对读者来说很有趣。以下是 TypeScript 如何实现创建一个接受多种类型参数的函数，这些参数将指导函数逻辑根据传入的参数和类型执行不同的操作：

> 答案是为同一个函数提供多种函数类型作为重载列表。这个列表是编译器用来解析函数调用的。让我们创建一个重载列表来描述我们的 pickCard 接受什么以及它返回什么。

```
let suits = ["hearts", "spades", "clubs", "diamonds"];

function pickCard(x: { suit: string; card: number }[]): number;
function pickCard(x: number): { suit: string; card: number };
function pickCard(x: any): any {
  // Check to see if we're working with an object/array
  // if so, they gave us the deck and we'll pick the card
  if (typeof x == "object") {
    let pickedCard = Math.floor(Math.random() * x.length);
    return pickedCard;
  }
  // Otherwise just let them pick the card
  else if (typeof x == "number") {
    let pickedSuit = Math.floor(x / 13);
    return { suit: suits[pickedSuit], card: x % 13 };
  }
}

let myDeck = [
  { suit: "diamonds", card: 2 },
  { suit: "spades", card: 10 },
  { suit: "hearts", card: 4 },
];

let pickedCard1 = myDeck[pickCard(myDeck)];
alert("card: " + pickedCard1.card + " of " + pickedCard1.suit);

let pickedCard2 = pickCard(15);
alert("card: " + pickedCard2.card + " of " + pickedCard2.suit); 
```

> 通过此更改，重载现在为我们提供了对 pickCard 函数的类型检查调用。

> 为了让编译器选择正确的类型检查，它遵循与底层 JavaScript 类似的过程。它查看重载列表，并继续第一个重载，尝试使用提供的参数调用函数。如果找到匹配项，它将选择此重载作为正确的重载。出于这个原因，习惯上按照从最具体到最不具体的顺序对重载进行排序。

> 请注意，函数 pickCard(x):any piece 不是重载列表的一部分，因此它只有两个重载：一个接受对象，另一个接受数字。使用任何其他参数类型调用 pickCard 会导致错误。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2013-09-10T08:07:29.387

第一个选项确实值得关注，因为这是我在相当复杂的代码设置中提出的。所以，我的回答是

> 1.  首先使用不同的名称

有了一点但必不可少的提示，名称对于计算机来说应该看起来不同，但对你来说却不一样。命名重载函数，例如：func、func1、func2。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2014-02-07T05:43:02.083

所以我真的很喜欢我在 javascript ninja 的秘密中发现的这种做事方式

```
function addMethod(object,name,fn){
  var old = object[name];
  object[name] = function(){
    if (fn.length == arguments.length){
      return fn.apply(this,arguments);
    } else if(typeof old == 'function'){
        return old.apply(this,arguments);
    }
  }
} 
```

然后使用 addMethod 将重载函数添加到任何对象。对我来说，这段代码中的主要混淆是使用 fn.length == arguments.length - 这是因为 fn.length 是预期参数的数量，而 arguments.length 是实际调用的参数数量功能。匿名函数没有参数的原因是您可以在 javascript 中传入任意数量的参数，并且该语言是宽容的。

我喜欢这个，因为你可以在任何地方使用它——只需创建这个函数，然后在你想要的任何代码库中简单地使用该方法。

它还避免了一个大得离谱的 if/switch 语句，如果你开始编写复杂的代码，就会变得难以阅读（接受的答案将导致这种情况）。

就缺点而言，我猜代码最初有点晦涩......但我不确定其他人？

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2015-05-28T11:56:19.417

我喜欢@AntouanK 的方法。我经常发现自己提供了一个具有不同数量的参数和不同类型的函数。有时他们不遵守命令。我用来映射查看参数的类型：

```
findUDPServers: function(socketProperties, success, error) {
    var fqnMap = [];

    fqnMap['undefined'] = fqnMap['function'] = function(success, error) {
        var socketProperties = {name:'HELLO_SERVER'};

        this.searchServers(socketProperties, success, error);
    };

    fqnMap['object'] = function(socketProperties, success, error) {
        var _socketProperties = _.merge({name:'HELLO_SERVER'}, socketProperties || {});

        this.searchServers(_socketProperties, success, error);
    };

    fqnMap[typeof arguments[0]].apply(this, arguments);
} 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2018-06-29T01:21:46.933

多年来，我一直在使用这个函数来美化我的重载：

```
function overload(){
  const fs = arguments, fallback = fs[fs.length - 1];
  return function(){
    const f = fs[arguments.length] || (arguments.length >= fs.length ? fallback : null);
    return f.apply(this, arguments);
  }
} 
```

演示：

```
function curry1(f){
  return curry2(f, f.length);
}

function curry2(f, minimum){
  return function(...applied){
    if (applied.length >= minimum) {
      return f.apply(this, applied);
    } else {
      return curry2(function(...args){
        return f.apply(this, applied.concat(args));
      }, minimum - applied.length);
    }
  }
}

export const curry = overload(null, curry1, curry2); 
```

看一下jQuery的`off`方法：

```
 function off( types, selector, fn ) {
    var handleObj, type;
    if ( types && types.preventDefault && types.handleObj ) {

        // ( event )  dispatched jQuery.Event
        handleObj = types.handleObj;
        jQuery( types.delegateTarget ).off(
            handleObj.namespace ?
                handleObj.origType + "." + handleObj.namespace :
                handleObj.origType,
            handleObj.selector,
            handleObj.handler
        );
        return this;
    }
    if ( typeof types === "object" ) {

        // ( types-object [, selector] )
        for ( type in types ) {
            this.off( type, selector, types[ type ] );
        }
        return this;
    }
    if ( selector === false || typeof selector === "function" ) {

        // ( types [, fn] )
        fn = selector;
        selector = undefined;
    }
    if ( fn === false ) {
        fn = returnFalse;
    }
    return this.each( function() {
        jQuery.event.remove( this, types, fn, selector );
    } );
  } 
```

许多重载函数在优化性能时几乎是不可读的。你必须破译函数的头部。这可能比使用`overload`我提供的功能更快；但是，从人类的角度来看，它在识别调用了哪个过载方面会比较慢。

* * *

## 回答 #37

> 赞同：-1
> 
> 时间：2013-11-21T22:11:11.247

我正在开发一个为 Javascript 提供类代码功能的库，目前它支持构造函数、继承、按参数数量和参数类型、mixin、静态属性和单例的方法重载。

请参阅使用该库的方法重载示例：

```
eutsiv.define('My.Class', {
    constructor: function() {
        this.y = 2;
    },
    x: 3,
    sum: function() {
        return this.x + this.y;
    },
    overloads: {
        value: [
            function() { return this.x + ', ' + this.y },
            function(p1) { this.x = p1; },
            function(p1, p2) { this.x = p1; this.y = p2; }  // will set x and y
        ]
    }
});

var test = new My.Class({ x: 5 });   // create the object
test.value();                        // will return '5, 2'
test.sum();                          // will return 7
test.value(13);                      // will set x to 13
test.value();                        // will return '13, 2'
test.sum();                          // will return 15
test.value(10, 20);                  // will set x to 10 and y to 20
test.value();                        // will return '10, 20'
test.sum();                          // will return 30 
```

欢迎任何反馈、错误修复、文档和测试改进！

[https://github.com/eutsiv/eutsiv.js](https://github.com/eutsiv/eutsiv.js)

# nhibernate - 在 HQL 选择中使用 CASE 语句

> ID：456181
> 
> 赞同：19
> 
> 时间：2009-01-19T00:10:34.370
> 
> 标签：nhibernate, hibernate, hql

有没有办法在 HQL 中执行以下操作：

```
SELECT 
    case when flag = true then SUM(col1) else SUM(col2)
FROM 
    myTable 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-19T00:19:01.763

我想你可以（[3.6](http://docs.jboss.org/hibernate/orm/3.6/reference/en-US/html/queryhql.html#queryhql-expressions)，[4.3](https://docs.jboss.org/hibernate/orm/4.3/devguide/en-US/html/ch11.html#d5e3280)）*[内联编辑]* ...对于 where 子句：

> “简单”案例，`case ... when ... then ... else ... end`和“搜索”案例，`case when ... then ... else ... end`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-19T12:11:51.140

显然，[在 3.0.4 中添加了](http://opensource.atlassian.com/projects/hibernate/browse/HHH-467)执行此操作的功能，但限制是您不能在 else 子句中使用子选择。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-01-15T09:41:39.537

参见 Hibernate 论坛：[https ://forum.hibernate.org/viewtopic.php?t=942197](https://forum.hibernate.org/viewtopic.php?t=942197)

Team (Gavin) 的回答：where 子句支持 case，但 HB3 中的 select 子句不支持 case。

并在 JIRA 中看到状态为“未解决”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-12T12:44:28.283

您可以在下面找到一个工作查询（postgresql 上的休眠），它使用 2 个 case 语句将布尔值替换为相应的文本表示。

> SELECT CASE ps.open WHEN true THEN 'OPEN' else 'CLOSED' END, CASE ps.full WHEN true THEN 'FULL' else 'FREE' END, ps.availableCapacity FROM ParkingState as ps

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-27T08:38:48.367

我在 HQL 中遇到了同样的问题，然后我解决了以下查询

```
select CONCAT(event.address1,', ', CASE WHEN event.address2 IS NULL THEN '' ELSE concat(event.address2,', ') END, event.city from EventDetail event where event.startDate>=:startDate and event.endDate<=:endDate; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-06T10:54:27.887

我们广泛使用休眠 HQL 查询，我认为最终有一种骇人听闻的方式来做这样的事情：

假设我们最初有一个查询

`i2.element.id = :someId`

然后决定将其扩展为如下所示：

`((i.element.id = :someId and i2.element.id=:someId) or (i2.element.id = :someId))`

但是有一个问题，我们希望它只根据 classType 查找这个，所以一个 case 语句：

```
(case when type(i)=Item then 
((i.element.id = :someId and i2.element.id=:someId) or (i2.element.id = :someId))
else
i.element.id = :someId
end) 
```

以上将不起作用，您可以通过执行以下操作来制作上述工作的简单版本：

```
(case when type(i)=Item then 
i2.element.id
else
i.element.id
end)=:elementId 
```

但这实际上并没有做我们需要它做的事情，我们希望它做上面的查询，所以知道你可以在 case 语句的末尾分配一个变量，其中 HQL 位：

```
(
                            (
                                (case when 
                                    type(r)=Item then 
                                        i.element.id 
                                    else 
                                        i.element.id end) = :elementId 
                                and 
                                (case when 
                                    type(r)=Item then 
                                        i2.element.id 
                                    else 
                                        i.element.id end) = :elementId
                            )
                            or 
                            (case when 
                                    type(r)=Item then 
                                        i2.element.id 
                                    else 
                                        i.element.id end) = :elementId 
                            ) 
```

我已经设法使查询现在基于 case 语句工作，确保它更加冗长但实际上与第一个实例相同

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-06-10T15:06:43.360

这是在条件中使用字符串比较的示例：

```
SELECT CASE f.type WHEN 'REMOVE'
                   THEN f.previousLocation 
                   ELSE f.currentLocation 
       END 
FROM FileOperation f 
```

# xlib - XDrawString 参数的 16 位限制

> ID：456185
> 
> 赞同：1
> 
> 时间：2009-01-19T00:12:49.610
> 
> 标签：xlib

从 XDrawString[手册页](http://www.xfree86.org/current/XDrawString.3.html)看来，它接受签名的 32 位 x 和 y 坐标

> `int XDrawString(Display *display, Drawable d, GC gc, int x, int y, char *string, int length);`

注意 x 和 y 都是 int （即：至少在 gcc/linux2.6-i386 上的 32 位有符号整数）

问题是当我通过`y = 32767`( 2^15 - 1) 时，字符串被绘制在正确的位置，但任何高于此值的字符串都不会被绘制。

我怀疑内部没有使用 32 位整数，而是使用 16 位有符号整数作为坐标。

鉴于手册页似乎表明该函数接受 32 位整数，是否需要打开一些编译选项以允许使用更长的整数？或者这是 Xlib 的限制？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T01:07:32.697

X11 协议确实指定了 16 位。

看一下`xPolyTextReq`in的定义`<X11/Xproto.h>`

```
typedef struct {
    CARD8 reqType;
    CARD8 pad;
    CARD16 length B16;
    Drawable drawable B32;
    GContext gc B32;
    INT16 x B16, y B16;         /* items (xTextElt) start after struct */
} xPolyTextReq; 
```

# c# - C# 写入输出流

> ID：456191
> 
> 赞同：0
> 
> 时间：2009-01-19T00:15:54.203
> 
> 标签：c#, asp.net, load

此代码将始终使我的 aspx 页面加载两次。这与 AutoEventWireup 无关。

```
Response.Clear();
Response.ContentType = "application/pdf";
Response.AppendHeader("Content-Disposition", "inline;filename=data.pdf");
Response.BufferOutput = true;
byte[] response = GetDocument(doclocation);
Response.AddHeader("Content-Length", response.Length.ToString());
Response.BinaryWrite(response);
Response.End(); 
```

当我硬编码一些虚拟值时，此代码只会使我的页面加载一次（应该如此）。

```
Response.Clear();
Response.ContentType = "application/pdf";
Response.AppendHeader("Content-Disposition", "inline;filename=data.pdf");
Response.BufferOutput = true;
byte[] response = new byte[] {10,11,12,13};
Response.AddHeader("Content-Length", response.Length.ToString());
Response.BinaryWrite(response);
Response.End(); 
```

我还在 web.config 文件中增加了请求长度以获得良好的度量。

```
<httpRuntime executionTimeout="180" maxRequestLength="400000"/> 
```

依然没有。有人看到我看不到的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T00:37:09.187

```
GetDocument(doclocation); 
```

这种方法可能会以某种方式返回重定向代码吗？或者可能是您的动态内容的 iframe 或 img？

*如果是这样的话：*

通常，由于 url 响应，控件可能会被调用两次。首先它呈现内容。之后，您的浏览器会尝试下载实际上是生成的动态内容的标记 (iframe,img) 源。因此它向 Web 服务器发出另一个请求。在这种情况下，创建的另一个页面对象具有不同的视图状态，因为它是不同的请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T00:40:27.760

快速猜测：会不会是在页面生命周期的这个阶段，包含 GetDocument() 的类已经进行了垃圾回收？ASP.NET Worker 进程是否需要重新加载页面才能再次读取该方法？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-28T21:22:49.733

您是否在 Page_Load 中尝试过？为什么 GetDocument 是静态方法？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T11:52:13.920

你找到解决方案了吗？我有同样的问题，我的代码几乎是你的镜像。主要区别是我的 pdf 托管在 IFrame 中。

我发现了如此有趣的线索：如果我流回 Word.doc，它只会被加载一次，如果是 pdf，它会被加载两次。此外，我从不同的客户端桌面看到了不同的行为。我在想 Adob​​e 版本可能与它有关。

**更新：**

就我而言，我将 HttpCacheability 设置为 NoCache。在验证这一点时，任何非客户端缓存选项都会导致 pdf 的双重下载。只有完全不设置（默认为私有）或明确将其设置为私有或公共才能解决问题，所有其他设置都重复了文档的双重加载。

# asp.net - 有没有办法检测更新面板何时完成刷新？

> ID：456195
> 
> 赞同：1
> 
> 时间：2009-01-19T00:17:02.783
> 
> 标签：asp.net, javascript, asp.net-ajax, updatepanel, asp.net-3.5

有没有办法检测更新面板何时完成刷新？我想在更新面板完成后触发一些 javascript 方法。

也许通过 UpdateProgress 控件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T00:32:27.290

您可以使用：

```
Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler);

function EndRequestHandler(sender, args) {
   // do what you want here
} 
```

当然，这将捕获每个 AJAX EndRequest 调用，因此您必须让 EndRequestHandler 函数查看已请求的内容或使用 BeginRequestHandler。更多信息[在这里](http://www.asp.net/ajax/documentation/live/overview/PageRequestManagerOverview.aspx)。

# c - 源文件中的代码排序 - 前向声明与“不要重复自己”？

> ID：456198
> 
> 赞同：4
> 
> 时间：2009-01-19T00:19:32.967
> 
> 标签：c, coding-style

如果您使用 C 编写代码并配置编译器以坚持在使用所有函数之前声明它们（或者如果您使用 C++ 编写代码），那么您的源文件可能会得到（至少）两个组织之一。

任何一个：

*   标头
*   此文件中（静态）函数的前向声明
*   外部函数（主要入口点）
*   静态 - 非公共 - 函数

或者：

*   标头
*   静态 - 非公共 - 函数
*   外部函数（主要入口点）

我认识到在 C++ 中，“静态”一词不是首选，但我主要是 C 程序员，C++ 中存在等效概念，即文件内匿名命名空间中的函数。

### 问题：

*   您使用哪个组织，为什么喜欢它？

作为参考，我自己的代码使用第二种格式，以便在使用静态函数之前定义它们，这样就不需要声明它们并定义它们，这样就节省了两次写出有关函数接口的信息 -反过来，当内部接口需要更改时，这会（略微）减少开销。不利的一面是，文件中定义的第一个函数是最低级别的例程 - 由文件中稍后定义的函数调用的例程 - 因此与其将最重要的代码放在顶部，它更接近底部的文件。这对你有多重要？

我假设所有外部可访问的函数都在标头中声明，并且这种重复形式是必要的——我认为这不应该引起争议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T00:26:28.833

我一直使用方法#1，原因是我希望能够快速判断特定文件中定义了哪些函数并在一个地方查看它们的签名。我没有发现必须更改原型以及函数定义的论点特别有说服力，因为您通常最终会更改所有调用更改后的函数的代码，而在您使用时更改函数原型似乎相对微不足道。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T03:43:29.950

在 C 代码中，我使用一个简单的规则：

*   每个具有非静态成员的 C 文件都会有一个相应的头文件来定义这些成员。

这在过去对我来说非常有效 - 可以很容易地找到函数的定义，因为如果我需要查找它，它位于同名的 .h 文件中。它也适用于 doxygen（我的首选工具），因为所有的杂乱无章都保存在我大部分时间不会花费的标题中 - C 文件中充满了代码。

对于文件中的静态成员，我坚持以这样一种方式对声明进行排序，即它们在使用之前由实例化定义。而且，我几乎一直都在避免函数调用中的循环依赖。

对于 C++ 代码，我尝试了以下操作：

*   头文件中定义的所有代码。使用#pragma interface/#pragma implementation 通知编译器；与模板将所有代码放在标题中的方式相同。

这在 C++ 中对我来说非常有效。这意味着您最终会得到巨大的头文件，这在某些情况下会增加编译时间。您最终还会得到一个 C++ 正文文件，您只需在其中包含头文件并进行编译。您可以在此处实例化您的静态成员变量。这也成为一场噩梦，因为更改方法参数和破坏代码太容易了。

我搬到

*   带有 doxygen 注释的头文件（模板除外，其中代码必须包含在标头中）和完整的正文文件，除了我知道我希望在使用时内联的短方法。

将实现与定义分开具有明显的优势，即更难更改您的方法/函数签名，因此您不太可能这样做并破坏事物。这也意味着我可以在头文件中有巨大的 doxygen 块，记录事情是如何工作的，并且在代码中相对无中断地工作，除了有用的注释，如“声明一个名为 i 的变量”（面颊上的舌头）。

Ada 将约定和文件命名方案强加给您。大多数动态语言，如 Ruby、Python 等，通常不关心你在哪里/如果你声明了东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T00:23:40.523

2号给我。

我认为使用静态或其他方法使模块函数和变量对模块私有是一种很好的做法。

我更喜欢将我的 api 函数放在模块的底部。相反，我将 api 函数放在类的顶部，因为类通常是可重用的。将api函数放在最上面可以更容易快速找到它们。大多数 IDE 可以非常直接地将您带到任何功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T01:31:55.737

第 2 点：因为我编写了许多短函数并自由地重构它们，所以维护前向声明会很麻烦。如果有一个 Emacs 扩展可以轻松地为您做到这一点，我会很感兴趣，因为自上而下的组织更具可读性。（我更喜欢在 Python 中自上而下。）

实际上并不完全是您的第二个，因为我通常将相关功能组合在 .c 中，无论它们是公共的还是私有的。如果我想查看所有公共声明，我会查看标题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T00:44:29.763

（谈C代码）

对我来说排名第二，因为我*总是*忘记更新前向 decls 以反映静态函数的变化。

但我认为最好的做法应该是

*   标题
*   前向声明 + 对每个函数行为的注释
*   当代码不够清晰时，导出的函数+关于实现细节的最终注释
*   静态函数 + 关于实现细节的最终评论

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T08:46:37.357

> 这对你有多重要？

它不是。

重要的是所有本地函数都将被标记为`static`，但我认为定义如何在文件中分组函数太多了。任何版本都没有强有力的理由，我也没有发现任何强烈的劣势。

一般来说，编码约定非常重要，我们试图尽可能多地定义，但在这种情况下，我的感觉是，这是不合理的开销。

再次阅读所有帖子后，我似乎应该简单地投票（我确实这样做了） [Darius](https://stackoverflow.com/questions/456198/code-ordering-in-source-files-forward-declarations-vs-dont-repeat-yourself#456301)的回答，而不是写下所有这些......

# android - 旋转Android上的活动重启

> ID：456211
> 
> 赞同：1444
> 
> 时间：2009-01-19T00:28:29.657
> 
> 标签：android, rotation, android-activity

在我的 Android 应用程序中，当我旋转设备（滑出键盘）时，我的设备`Activity`会重新启动（`onCreate`被调用）。现在，这可能是它应该的样子，但是我在方法中做了很多初始设置`onCreate`，所以我需要：

1.  将所有初始设置放在另一个函数中，这样它就不会在设备旋转或
2.  使它`onCreate`不再被调用，布局只是调整或
3.  将应用程序限制为仅纵向，这样`onCreate`就不会被调用。

* * *

## 回答 #1

> 赞同：990
> 
> 时间：2009-01-19T08:47:59.960

**使用应用程序类**

根据您在初始化中所做的事情，您可以考虑创建一个新类，该类扩展`Application`并将您的初始化代码移动到`onCreate`该类中的重写方法中。

```
public class MyApplicationClass extends Application {
  @Override
  public void onCreate() {
    super.onCreate();
    // TODO Put your application initialization code here.
  }
} 
```

应用程序类中的`onCreate`仅在创建整个应用程序时调用，因此 Activity 在方向或键盘可见性更改时重新启动不会触发它。

将此类的实例公开为单例并公开使用 getter 和 setter 初始化的应用程序变量是一种很好的做法。

*注意：您需要在清单中指定新应用程序类的名称才能注册和使用它：*

```
<application
    android:name="com.you.yourapp.MyApplicationClass" 
```

**对配置更改做出反应** *[更新：自 API 13 起已弃用；[请参阅推荐的替代方案](http://www.androiddesignpatterns.com/2013/04/retaining-objects-across-config-changes.html)]*

作为进一步的选择，你可以让你的应用程序监听会导致重启的事件——比如方向和键盘可见性的改变——并在你的 Activity 中处理它们。

首先将`android:configChanges`节点添加到 Activity 的清单节点

```
 <activity android:name=".MyActivity"
      android:configChanges="orientation|keyboardHidden"
      android:label="@string/app_name"> 
```

或适用于[Android 3.2（API 级别 13）及更高版本](https://stackoverflow.com/a/9550231/2291)：

```
<activity android:name=".MyActivity"
      android:configChanges="keyboardHidden|orientation|screenSize"
      android:label="@string/app_name"> 
```

然后在 Activity 中覆盖该`onConfigurationChanged`方法并调用`setContentView`以强制在新方向上重新完成 GUI 布局。

```
@Override
public void onConfigurationChanged(Configuration newConfig) {
  super.onConfigurationChanged(newConfig);
  setContentView(R.layout.myLayout);
} 
```

* * *

## 回答 #2

> 赞同：192
> 
> 时间：2012-03-03T21:56:40.480

Android 3.2 及更高版本的更新：

> **注意**：从 Android 3.2（API 级别 13）开始，当设备在纵向和横向之间切换时， **“屏幕尺寸”也会发生变化。**因此，如果您想在为 API 级别 13 或更高级别（由 minSdkVersion 和 targetSdkVersion 属性声明）进行开发时防止由于方向更改而导致运行时重新启动，则必须在`"screenSize"`值之外包含该`"orientation"`值。也就是说，您必须声明`android:configChanges="orientation|screenSize"`. 但是，如果您的应用程序以 API 级别 12 或更低级别为目标，那么您的 Activity 始终会自行处理此配置更改（此配置更改不会重新启动您的 Activity，即使在 Android 3.2 或更高版本的设备上运行时也是如此）。

* * *

## 回答 #3

> 赞同：135
> 
> 时间：2012-08-04T21:04:23.783

与其试图完全阻止`onCreate()`被触发，不如尝试检查`Bundle` `savedInstanceState`被传递到事件中以查看它是否为空。

例如，如果我有一些逻辑应该在`Activity`真正创建时运行，而不是在每次方向更改时运行，我只在`onCreate()`只有`savedInstanceState`为空时才运行该逻辑。

否则，我仍然希望布局为方向正确重绘。

```
public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_game_list);

        if(savedInstanceState == null){
            setupCloudMessaging();
        }
} 
```

不确定这是否是最终答案，但它对我有用。

* * *

## 回答 #4

> 赞同：104
> 
> 时间：2011-01-04T01:26:44.193

我做了什么...

在清单的活动部分中，添加了：

```
android:configChanges="keyboardHidden|orientation" 
```

在活动的代码中，实现：

```
//used in onCreate() and onConfigurationChanged() to set up the UI elements
public void InitializeUI()
{
    //get views from ID's
    this.textViewHeaderMainMessage = (TextView) this.findViewById(R.id.TextViewHeaderMainMessage);

    //etc... hook up click listeners, whatever you need from the Views
}

//Called when the activity is first created.
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    InitializeUI();
}

//this is called when the screen rotates.
// (onCreate is no longer called when screen rotates due to manifest, see: android:configChanges)
@Override
public void onConfigurationChanged(Configuration newConfig)
{
    super.onConfigurationChanged(newConfig);
    setContentView(R.layout.main);

    InitializeUI();
} 
```

* * *

## 回答 #5

> 赞同：72
> 
> 时间：2009-01-19T02:28:45.933

您描述的是默认行为。您必须自己检测和处理这些事件，方法是添加：

```
android:configChanges 
```

到您的清单，然后是您要处理的更改。因此，对于方向，您将使用：

```
android:configChanges="orientation" 
```

对于打开或关闭的键盘，您将使用：

```
android:configChanges="keyboardHidden" 
```

如果你想同时处理这两种情况，你可以使用管道命令将它们分开，例如：

```
android:configChanges="keyboardHidden|orientation" 
```

这将在您调用的任何 Activity 中触发 onConfigurationChanged 方法。如果您覆盖该方法，您可以传入新值。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：51
> 
> 时间：2010-12-22T21:50:52.807

我刚刚发现了这个传说：

为了通过方向更改保持 Activity 活着，并通过 处理它`onConfigurationChanged`，上面[的文档](http://developer.android.com/guide/topics/resources/runtime-changes.html#HandlingTheChange)和[代码示例](https://stackoverflow.com/questions/456211/activity-restart-on-rotation-android/456918#456918)在 Manifest 文件中建议了这一点：

```
<activity android:name=".MyActivity"
      android:configChanges="orientation|keyboardHidden"
      android:label="@string/app_name"> 
```

它具有始终有效的额外好处。

额外的知识是省略`keyboardHidden`似乎合乎逻辑，但它会导致模拟器失败（至少对于 Android 2.1）：仅指定`orientation`将使模拟器有时调用，`OnCreate`并且`onConfigurationChanged`仅在`OnCreate`其他时间调用。

我还没有看到设备上的故障，但我听说过其他人的模拟器失败了。所以值得记录。

* * *

## 回答 #7

> 赞同：40
> 
> 时间：2011-09-22T03:03:00.180

您还可以考虑使用 Android 平台跨方向更改持久化数据的方式： `onRetainNonConfigurationInstance()`和`getLastNonConfigurationInstance()`.

这允许您在配置更改中持久保存数据，例如您可能从服务器获取的信息或其他已经计算过的信息`onCreate`，同时还允许 Android 使用 xml 文件重新布局您`Activity`现在使用的方向.

见[这里](http://android-developers.blogspot.com/2009/02/faster-screen-orientation-change.html)或[这里](http://developer.android.com/guide/topics/resources/runtime-changes.html "处理运行时更改")。

应该注意的是，这些方法现在已被弃用（尽管仍然比上述大多数解决方案所建议的自己处理方向更改更灵活），建议每个人都切换到您想要保留的每个`Fragments`方法上。`setRetainInstance(true)``Fragment`

* * *

## 回答 #8

> 赞同：34
> 
> 时间：2012-09-21T09:09:25.313

该方法很有用，但在使用 Fragments 时不完整。

片段通常会在配置更改时重新创建。如果您不希望发生这种情况，请使用

`setRetainInstance(true);`在片段的构造函数中

这将导致在配置更改期间保留片段。

[http://developer.android.com/reference/android/app/Fragment.html#setRetainInstance(boolean)](http://developer.android.com/reference/android/app/Fragment.html#setRetainInstance%28boolean%29)

* * *

## 回答 #9

> 赞同：27
> 
> 时间：2012-08-09T09:58:55.297

我只是简单地添加了

```
 android:configChanges="keyboard|keyboardHidden|orientation" 
```

在清单文件中，**并没有**`onConfigurationChanged`在我的活动中添加任何方法。

[所以每次键盘滑出或什么都没有发生](http://www.coboltforge.com/2012/08/tech-stuff-prevent-android-app-from-restarting-after-sliding-out-the-hardware-keyboard/)。

* * *

## 回答 #10

> 赞同：21
> 
> 时间：2010-01-21T10:40:44.900

`onCreate`即使您更改了`orientation`android的方法，该方法仍然会被调用。因此，将所有繁重的功能移至此方法不会对您有所帮助

* * *

## 回答 #11

> 赞同：21
> 
> 时间：2014-08-21T11:55:28.200

将以下代码放入您的`<activity>`标签中`Manifest.xml`：

```
android:configChanges="screenLayout|screenSize|orientation" 
```

* * *

## 回答 #12

> 赞同：20
> 
> 时间：2015-12-14T06:39:04.617

非常简单，只需执行以下步骤：

```
<activity
    android:name=".Test"
    android:configChanges="orientation|screenSize"
    android:screenOrientation="landscape" >
</activity> 
```

这对我有用：

**注意：**方向取决于您的回报

* * *

## 回答 #13

> 赞同：19
> 
> 时间：2012-02-01T15:55:53.810

> ```
>  onConfigurationChanged is called when the screen rotates. 
>  (onCreate is no longer called when screen rotates due to manifest, see:  
>  android:configChanges) 
> ```

清单的哪一部分告诉它“不要调用`onCreate()`”？

此外，谷歌的文档说要避免使用`android:configChanges`（除非作为最后手段）......但是他们建议所有的替代方法*都*使用`android:configChanges`.

根据我的经验，模拟器总是要求`onCreate()`轮换。
但是我在上面运行相同代码的 1-2 台设备……没有。（不知道为什么会有任何区别。）

* * *

## 回答 #14

> 赞同：17
> 
> 时间：2011-11-11T12:20:03.190

在 Android 清单中进行的更改是：

```
android:configChanges="keyboardHidden|orientation" 
```

在活动内部进行的补充是：

```
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);

    // Checks the orientation of the screen
    if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE) {
        Toast.makeText(this, "landscape", Toast.LENGTH_SHORT).show();
    } else if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT) {
        Toast.makeText(this, "portrait", Toast.LENGTH_SHORT).show();
    }
} 
```

* * *

## 回答 #15

> 赞同：17
> 
> 时间：2014-07-23T10:00:56.433

将此行添加到您的清单中：-

```
android:configChanges="orientation|keyboard|keyboardHidden|screenSize|screenLayout|uiMode" 
```

和这个活动片段：-

```
@Override
    public void onConfigurationChanged(Configuration newConfig) {
        super.onConfigurationChanged(newConfig);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
                WindowManager.LayoutParams.FLAG_FULLSCREEN);
    } 
```

* * *

## 回答 #16

> 赞同：16
> 
> 时间：2016-01-07T18:55:10.533

做这件事有很多种方法：

## **保存活动状态**

您可以将活动状态保存在`onSaveInstanceState`.

```
@Override
public void onSaveInstanceState(Bundle outState) {
    /*Save your data to be restored here
    Example : outState.putLong("time_state", time); , time is a long variable*/
    super.onSaveInstanceState(outState);
} 
```

然后使用`bundle`来恢复状态。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    if(savedInstanceState!= null){
       /*When rotation occurs
        Example : time = savedInstanceState.getLong("time_state", 0); */
    } else {
      //When onCreate is called for the first time
    }
} 
```

## 自己处理方向变化

另一种选择是自己处理方向变化。但这不是一个好的做法。

将此添加到您的清单文件中。

```
android:configChanges="keyboardHidden|orientation" 
```

对于 Android 3.2 及更高版本：

```
android:configChanges="keyboardHidden|orientation|screenSize"

@Override
public void onConfigurationChanged(Configuration config) {
    super.onConfigurationChanged(config);

if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT) {
        //Handle rotation from landscape to portarit mode here
    } else if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE){
        //Handle rotation from portrait to landscape mode here
    }
} 
```

## 限制轮换

您还可以将活动限制为纵向或横向模式以避免旋转。

将此添加到清单文件中的活动标记中：

```
 android:screenOrientation="portrait" 
```

或在您的活动中以编程方式实现此功能：

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
} 
```

* * *

## 回答 #17

> 赞同：12
> 
> 时间：2012-03-16T09:13:20.680

尽管它不是“Android 方式”，但我通过自己处理方向更改并简单地在视图中重新定位小部件以考虑更改的方向，从而获得了非常好的结果。这比任何其他方法都快，因为您的视图不必保存和恢复。它还为用户提供了更无缝的体验，因为重新定位的小部件是完全相同的小部件，只是移动和/或调整大小。以这种方式不仅可以保存模型状态，还可以保存视图状态。

`RelativeLayout`有时，对于必须不时重新定位的视图来说，这可能是一个不错的选择。您只需为每个子小部件提供一组纵向布局参数和一组横向布局参数，每个参数具有不同的相对定位规则。然后，在您的`onConfigurationChanged()`方法中，您将适当的方法传递`setLayoutParams()`给每个孩子的调用。如果任何子控件本身需要在*内部*重新定向，您只需调用该子控件的方法来执行重新定向。该子项类似地调用其任何*需要*内部重新定向的子控件的方法，依此类推。

* * *

## 回答 #18

> 赞同：12
> 
> 时间：2012-12-21T20:15:08.237

我发现这样做的方法是使用`onRestoreInstanceState`和`onSaveInstanceState`事件在其中保存一些东西`Bundle`（即使你不需要保存任何变量，只需在里面放一些东西，这样它就`Bundle`不会为空）。然后，在`onCreate`方法上，检查是否`Bundle`为空，如果是，则进行初始化，如果不是，则进行初始化。

* * *

## 回答 #19

> 赞同：10
> 
> 时间：2017-02-03T10:47:46.020

每次旋转屏幕时，打开的 Activity 都会完成并再次调用 onCreate()。

1\. 当屏幕旋转时，您可以做一件事来保存活动的状态，以便在再次调用活动的 onCreate() 时恢复所有旧的东西。参考[这个](https://stackoverflow.com/a/41804128/3578677.) 链接

2\. 如果您想阻止重新启动活动，只需在 manifest.xml 文件中添加以下行。

```
 <activity android:name=".Youractivity"
  android:configChanges="orientation|screenSize"/> 
```

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2016-12-07T10:23:07.427

您需要使用 onSavedInstanceState 方法将所有值存储到它的参数 is has that is bundle

```
@Override
    public void onSaveInstanceState(Bundle outState, PersistableBundle outPersistentState) {
        super.onSaveInstanceState(outState, outPersistentState);
        outPersistentState.putBoolean("key",value);
    } 
```

并使用

```
@Override
    protected void onRestoreInstanceState(Bundle savedInstanceState) {
        super.onRestoreInstanceState(savedInstanceState);
        savedInstanceState.getBoolean("key");
    } 
```

检索并设置值以查看它将处理屏幕旋转的对象

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2014-04-24T14:40:42.850

**注意：**如果将来有人遇到与我相同的问题，我会发布此答案。对我来说，以下行是不够的：

```
android:configChanges="orientation" 
```

当我旋转屏幕时，方法 `onConfigurationChanged(Configuration newConfig) 没有被调用。

**解决方案：**即使问题与方向有关，我也必须添加“screenSize”。因此，在 AndroidManifest.xml - 文件中，添加以下内容：

```
android:configChanges="keyboardHidden|orientation|screenSize" 
```

然后实现方法`onConfigurationChanged(Configuration newConfig)`

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2017-03-10T08:14:52.043

在 的活动部分中`manifest`，添加：

```
android:configChanges="keyboardHidden|orientation" 
```

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2017-11-28T12:42:56.683

**在清单中添加这一行：** `android:configChanges="orientation|screenSize"`

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2018-01-09T10:03:55.280

人们说你应该使用

```
android:configChanges="keyboardHidden|orientation" 
```

但在 Android 中处理旋转最好和最专业的方法是使用 Loader 类。它不是一个著名的类（我不知道为什么），但它比 AsyncTask 好得多。有关更多信息，您可以阅读 Udacity 的 Android 课程中的 Android 教程。

当然，作为另一种方式，您可以使用 onSaveInstanceState 存储值或视图，并使用 onRestoreInstanceState 读取它们。这真的取决于你。

* * *

## 回答 #25

> 赞同：5
> 
> 时间：2018-10-24T10:37:31.040

谷歌推出的 android 体系结构的最佳组件之一将满足您对 ViewModel 的所有要求。

这旨在以生命周期的方式存储和管理 UI 相关数据，并且允许数据在屏幕旋转时存活

```
class MyViewModel : ViewModel() { 
```

请参考：[https ://developer.android.com/topic/libraries/architecture/viewmodel](https://developer.android.com/topic/libraries/architecture/viewmodel)

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2013-02-15T11:14:06.350

修复屏幕方向（横向或纵向）`AndroidManifest.xml`

`android:screenOrientation="portrait"`或者`android:screenOrientation="landscape"`

为此，您的`onResume()`方法不会被调用。

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2013-07-29T07:09:51.510

把下面的代码放在你的`Activity`in 中`Android Manifest`。

```
android:configChanges="orientation" 
```

当您更改方向时，这不会重新启动您的活动。

* * *

## 回答 #28

> 赞同：4
> 
> 时间：2015-02-04T06:58:40.963

使用`orientation`监听器在不同的方向上执行不同的任务。

```
@Override
public void onConfigurationChanged(Configuration myConfig) 
{
    super.onConfigurationChanged(myConfig);
    int orient = getResources().getConfiguration().orientation; 
    switch(orient) 
    {
       case Configuration.ORIENTATION_LANDSCAPE:
          setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
                    break;
       case Configuration.ORIENTATION_PORTRAIT:
          setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
                    break;
       default:
          setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED);
    }
} 
```

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2015-10-30T03:53:29.013

经过一段时间的反复试验，我找到了一个在大多数情况下都能满足我需求的解决方案。这是代码：

**清单配置：**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
          package="com.pepperonas.myapplication">

    <application
        android:name=".App"
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:supportsRtl="true"
        android:theme="@style/AppTheme">
        <activity
            android:name=".MainActivity"
            android:configChanges="orientation|keyboardHidden|screenSize">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>

                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

**主要活动：**

```
import android.content.res.Configuration;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentTransaction;
import android.support.v7.app.AppCompatActivity;
import android.util.Log;
import android.view.View;
import android.widget.Button;

public class MainActivity extends AppCompatActivity implements View.OnClickListener {

    private static final String TAG = "MainActivity";

    private Fragment mFragment;

    private int mSelected = -1;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.d(TAG, "onCreate  " + "");

        // null check not realy needed - but just in case...
        if (savedInstanceState == null) {

            initUi();

            // get an instance of FragmentTransaction from your Activity
            FragmentManager fragmentManager = getSupportFragmentManager();
            FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();

            /*IMPORTANT: Do the INITIAL(!) transaction only once!
            * If we call this everytime the layout changes orientation,
            * we will end with a messy, half-working UI.
            * */
            mFragment = FragmentOne.newInstance(mSelected = 0);
            fragmentTransaction.add(R.id.frame, mFragment);
            fragmentTransaction.commit();
        }
    }

    @Override
    public void onConfigurationChanged(Configuration newConfig) {
        super.onConfigurationChanged(newConfig);
        Log.d(TAG, "onConfigurationChanged  " +
                   (newConfig.orientation
                    == Configuration.ORIENTATION_LANDSCAPE
                    ? "landscape" : "portrait"));

        initUi();

        Log.i(TAG, "onConfigurationChanged - last selected: " + mSelected);
        makeFragmentTransaction(mSelected);
    }

    /**
     * Called from {@link #onCreate} and {@link #onConfigurationChanged}
     */
    private void initUi() {
        setContentView(R.layout.activity_main);
        Log.d(TAG, "onCreate  instanceState == null / reinitializing..." + "");
        Button btnFragmentOne = (Button) findViewById(R.id.btn_fragment_one);
        Button btnFragmentTwo = (Button) findViewById(R.id.btn_fragment_two);
        btnFragmentOne.setOnClickListener(this);
        btnFragmentTwo.setOnClickListener(this);
    }

    /**
     * Not invoked (just for testing)...
     */
    @Override
    protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        Log.d(TAG, "onSaveInstanceState  " + "YOU WON'T SEE ME!!!");
    }

    /**
     * Not invoked (just for testing)...
     */
    @Override
    protected void onRestoreInstanceState(Bundle savedInstanceState) {
        super.onRestoreInstanceState(savedInstanceState);
        Log.d(TAG, "onSaveInstanceState  " + "YOU WON'T SEE ME, AS WELL!!!");
    }

    @Override
    protected void onResume() {
        super.onResume();
        Log.d(TAG, "onResume  " + "");
    }

    @Override
    protected void onPause() {
        super.onPause();
        Log.d(TAG, "onPause  " + "");
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        Log.d(TAG, "onDestroy  " + "");
    }

    @Override
    public void onClick(View v) {

        switch (v.getId()) {
            case R.id.btn_fragment_one:
                Log.d(TAG, "onClick btn_fragment_one " + "");
                makeFragmentTransaction(0);
                break;

            case R.id.btn_fragment_two:
                Log.d(TAG, "onClick btn_fragment_two " + "");
                makeFragmentTransaction(1);
                break;

            default:
                Log.d(TAG, "onClick  null - wtf?!" + "");
        }
    }

    /**
     * We replace the current Fragment with the selected one.
     * Note: It's called from {@link #onConfigurationChanged} as well.
     */
    private void makeFragmentTransaction(int selection) {

        switch (selection) {
            case 0:
                mFragment = FragmentOne.newInstance(mSelected = 0);
                break;
            case 1:
                mFragment = FragmentTwo.newInstance(mSelected = 1);
                break;
        }

        // Create new transaction
        FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();

        // Replace whatever is in the fragment_container view with this fragment,
        // and add the transaction to the back stack
        transaction.replace(R.id.frame, mFragment);

        /*This would add the Fragment to the backstack...
        * But right now we comment it out.*/
        //        transaction.addToBackStack(null);

        // Commit the transaction
        transaction.commit();
    }

} 
```

**和样本片段：**

```
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

/**
 * @author Martin Pfeffer (pepperonas)
 */
public class FragmentOne extends Fragment {

    private static final String TAG = "FragmentOne";

    public static Fragment newInstance(int i) {
        Fragment fragment = new FragmentOne();
        Bundle args = new Bundle();
        args.putInt("the_id", i);
        fragment.setArguments(args);
        return fragment;
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        Log.d(TAG, "onCreateView  " + "");
        return inflater.inflate(R.layout.fragment_one, container, false);
    }

} 
```

可以在[github](https://github.com/pepperonas/AndroidTest)上找到。

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2018-09-19T16:24:38.987

您可以在活动中使用 ViewModel 对象。

ViewModel 对象在配置更改期间自动保留，以便它们保存的数据可立即用于下一个活动或片段实例。阅读更多：

[https://developer.android.com/topic/libraries/architecture/viewmodel](https://developer.android.com/topic/libraries/architecture/viewmodel)

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2020-02-11T10:46:50.850

有多种方法可以做到这一点：

***自己处理方向变化***

另一种选择是自己处理方向变化。但这不是一个好的做法。

将此添加到您的清单文件中。

```
android:configChanges="keyboardHidden|orientation" 
```

对于 Android 3.2 及更高版本：

```
android:configChanges="keyboardHidden|orientation|screenSize"

@Override
public void onConfigurationChanged(Configuration config) {
    super.onConfigurationChanged(config);

if (newConfig.orientation == Configuration.ORIENTATION_PORTRAIT) {
        //Handle rotation from landscape to portarit mode here
    } else if (newConfig.orientation == Configuration.ORIENTATION_LANDSCAPE){
        //Handle rotation from portrait to landscape mode here
    }
} 
```

***或 限制轮换***

您还可以将活动限制为纵向或横向模式以避免旋转。

将此添加到清单文件中的活动标记中：

安卓：screenOrientation="人像"

或在您的活动中以编程方式实现此功能：

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
} 
```

***或保存活动状态***

您可以在 onSaveInstanceState 中保存活动状态。

```
@Override
public void onSaveInstanceState(Bundle outState) {
    /*Save your data to be restored here
    Example : outState.putLong("time_state", time); , time is a long variable*/
    super.onSaveInstanceState(outState);
} 
```

然后使用捆绑包恢复状态。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    if(savedInstanceState!= null){
       /*When rotation occurs
        Example : time = savedInstanceState.getLong("time_state", 0); */
    } else {
      //When onCreate is called for the first time
    }
} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-05-06T06:23:17.373

您可以使用此代码锁定到屏幕的当前方向...

```
int currentOrientation =context.getResources().getConfiguration().orientation;
        if (currentOrientation == Configuration.ORIENTATION_PORTRAIT) {
            ((Activity) context).setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
        } else {
            ((Activity) context). setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
        } 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2020-03-11T06:54:17.890

将此代码添加到您的 menufests.xml 中。

这是你的活动。

```
<activity
....
..
android:configChanges="orientation|screenSize"/> 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2021-09-11T14:55:46.597

**在该活动中，`config changes`如下所示**

```
 android:configChanges="orientation|screenSize|keyboardHidden" 
```

# c# - Destructor vs IDisposable?

> ID：456213
> 
> 赞同：67
> 
> 时间：2009-01-19T00:29:11.090
> 
> 标签：c#, .net

I've read about disposing objects/IDisposable interface and destructors in C#, but to me they seem to do the same thing?

What is the difference between the two? Why would I use one over the other? In fact, in this example (link below) this code uses both the IDisposable interface and a destructor:

[http://msdn.microsoft.com/en-us/library/system.idisposable.aspx](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)

The comment says the destructor is if the finalization code is not used, but how do I decide when to use one over the other?

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-01-19T00:34:27.880

I wrote a fairly in-depth post which should help to explain about finalizers, IDisposable, and when you should use one or the other: [http://gregbee.ch/blog/implementing-and-using-the-idisposable-interface](http://gregbee.ch/blog/implementing-and-using-the-idisposable-interface)

Probably the most relevant part is quoted below:

> When you are using unmanaged resources such as handles and database connections, you should ensure that they are held for the minimum amount of time, using the principle of acquire late and release early. In C++ releasing the resources is typically done in the destructor, which is deterministically run at the point where the object is deleted. The .NET runtime, however, uses a garbage collector (GC) to clean up and reclaim the memory used by objects that are no longer reachable; as this runs on a periodic basis it means that the point at which your object is cleaned up is nondeterministic. The consequence of this is that destructors do not exist for managed objects as there is no deterministic place to run them.
> 
> Instead of destructors, C# has finalizers which are implemented by overriding the Finalize method defined on the base Object class (though C# somewhat confusingly uses the C++ destructor syntax ~Object for this). If an object overrides the Finalize method then rather than being collected by the GC when it is out of scope, the GC places it on a finalizer queue. In the next GC cycle all finalizers on the queue are run (on a single thread in the current implementation) and the memory from the finalized objects reclaimed. It's fairly obvious from this why you don't want to do clean up in a finalizer: it takes two GC cycles to collect the object instead of one and there is a single thread where all finalizers are run while every other thread is suspended, so it's going to hurt performance.
> 
> So if you don't have destructors, and you don't want to leave the cleanup to the finalizer, then the only option is to manually, deterministically, clean up the object. Enter the IDisposable interface which provides a standard for supporting this functionality and defines a single method, Dispose, where you put in the cleanup logic for the object. When used within a finally block, this interface provides equivalent functionality to destructors. The reason for finally blocks in code is primarily to support the IDisposable interface; this is why C++ uses simply try/except as there is no need for a finally block with destructors.

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-07-22T00:38:27.427

## 精简版

终结器让您有*机会*在对象的用户忘记调用`IDisposable.Dispose`.

如果您的对象实现`IDisposable`，则您的对象的用户**必须**调用`.Dispose`. 您不必清理用户的烂摊子*；*但这是一件好事。

* * *

我[在 Stackoverflow 上最受欢迎的回答](https://stackoverflow.com/questions/538060/proper-use-of-the-idisposable-interface/538238#538238)从一开始就引导您为什么拥有 IDisposable，它应该做什么，终结器可以做什么，不应该做什么。

> 这个答案融化了面孔

已被用来描述它：P

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-22T01:52:25.177

在托管编程语言中使用析构函数 (~Object()) 是最愚蠢的想法。对于像 C、C++ 这样的非托管语言来说，使用 RAII 惯用语具有析构函数是完全有意义的，但对于像 Java、C# 这样的托管语言来说，这太荒谬了。

Java Collection Framework 的前项目负责人 Joshua Bloch 曾指出，Java 中的 finalize() 方法（相当于 C# 的 C++ 类析构函数）的想法是有史以来最大的错误。与 C# 一样，Java 中的 finallize() 给“new”带来了开销，因为它必须在分配期间添加到 finallizer 队列中。此外，垃圾收集器必须在队列中弹出并运行 finallize()，因此 gc 期间的开销增加了一倍。

C# 有许多增强功能，例如“using(IDisposable) {}”，它不仅允许 IDisposable 变量被限制在“using”块的范围内，而且还保证了它的清理。我的问题是，为什么 C# 遵循 Java 的相同轨迹导致了大错误。可能如果dotnet的开发是在2003~2005年左右开始的，当时很多Java架构师发现finallize()的谬误，那么这个错误就可以避免了。

一种语言的许多好主意经常被转移到其他语言，例如 C# 中的“IDisposable/using combo”，它在“try(object-to-dispose) {}”语句中被转移到 Java 1.7。但是太糟糕了，语言架构师在从一个转移到另一个的过程中没有发现伪装成好主意的坏主意。

如果您需要手动清理数据库连接等非托管资源，我的建议是永远不要使用 ~Destructor() 并坚持使用 IDisposable/使用组合。

# class - 类如何帮助您管理大型应用程序？

> ID：456216
> 
> 赞同：12
> 
> 时间：2009-01-19T00:29:50.027
> 
> 标签：class, oop, functional-programming, code-reuse, scale

这出现在我在网上进行的一次谈话中，我突然想到我不知道这应该如何工作：相当多的程序员似乎只是把它当作一个给定的——事实上，很明显，类是一种必要的语言用于管理大型软件项目的功能。

他们如何做到这一点对我来说并不明显。

我的问题是，你怎么知道？有哪些客观措施表明类可以提高生产力、代码重用并降低程序生产的复杂性？类的哪些方面使它们成为大型团队协作的理想选择？

现在，我想问一个问题，这有点难以表达。如果我弄错了并最终使任何人感到困惑或激怒，我很抱歉：

客观地说，你怎么知道类的使用不是导致应用程序变大的原因呢？也就是说，是否可以使用其他代码重用策略编写具有等效功能的程序，代码少得多，小到不需要任何特殊措施来“管理”它？（有很多可供选择，例如函数式编程范例或面向方面的编程）。

最后一点是史蒂夫·耶格（Steve Yegge）在他的博客上暗示的。但我对争论的双方都持怀疑态度，因为真正缺乏任何人的任何硬数据，也没有足够的经验来独自得出结论。

你怎么看？

编辑：我特别感兴趣的是为什么许多程序员认为原型样式继承在大型应用程序中不能胜任这项任务。我很抱歉这个问题含糊不清 - 这是我对这个话题缺乏了解的产物。

编辑2：我所说的函数式编程似乎有些混乱。（我认为任何版本的 VB 都没有功能，当然不是旧版本）。请参阅维基百科文章。 [http://en.wikipedia.org/wiki/Functional_programming](http://en.wikipedia.org/wiki/Functional_programming)

编辑3：让我强调我正在寻找客观的措施。不是主观意见。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T01:12:05.137

这个问题问得好。将代码组织成类是开发团队创建小型、可重用模块的一种方式。此外，这些模块具有表达性和有限的接口，只表达类的能力，而不是它是如何做到的。每个类都与其他类正交，因此在出现错误时具有高度的可测试性和模块化。

现在我刚才描述的是一个完美世界的奇异景象。但是任何从事 OOP 工作的优秀开发人员都应该为这样的事情而努力。

OOP 承认我们，开发人员，只是人类，不能立即理解整个系统。因此，我们将系统分解为可重复使用的微小部分并专注于这些部分。

以一个十位数的美国电话号码为例。在你的头脑中记住一个十位数是很困难的，所以我们做了心理学家所说的“分块”。这意味着我们在精神上将数字分解成我们可以更好地记住的块。

就这样`1234567890`变成了`123-456-7890`。对我们来说幸运的是，电话公司也以同样的方式将这些数字分解并分配块的含义。 `123`是区号，`456`是前缀，`7890`是行号。这些块中的每一个都像一个类，它们都有各自的职责、格式和含义。

所以总而言之，我能说的最好的事情是 OOP 允许我们构建具有集中和封装功能的大型、可扩展系统。它使我们不必一直看大局，而能够专注于做一件事并把它做好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T00:35:17.300

我绝不是对任何编程范式的偏执狂，但我已经以 OO 方式操作了一段时间。

就个人而言，我有很多'a-HA！课程直接帮助我更好地理解我正在工作的领域的时刻。

最值得注意的是，如果对系统故障的原因或系统应该做什么感到困惑，课堂经常迫使我思考这个离散的整体应该做什么，而且往往不是领导重构手头的类/方法。

总之，封装真的让我成为一个更快乐的人。;)

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T01:23:05.863

我认为类可以提供帮助，因为它们对应于非常普遍的[分类](http://en.wikipedia.org/wiki/Categorization)认知概念，因此可以帮助自然地描述大型应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T18:34:41.727

封装理论提供了一个客观原因，为什么类比没有类更好。

国际标准化组织将封装定义为“对象中包含的信息只能通过对象支持的接口上的交互来访问的特性”。

因此，由于某些信息可通过这些接口访问，因此某些信息必须在对象内隐藏且不可访问。此类信息表现出的属性称为信息隐藏，Parnas 通过认为模块应该被设计为隐藏困难的决策和可能改变的决策来定义。

注意那个词：改变。信息隐藏涉及潜在事件，例如未来困难设计决策的变化。

考虑一个具有两种方法的类：方法 a() 是隐藏在类中的信息，方法 b() 是公共的，因此其他类可以直接访问。

将来对方法 a() 的更改很有可能需要更改其他类中的方法。未来对方法 b() 的更改也有一定的可能性需要更改其他类中的方法。然而，方法 a() 发生这种波动变化的概率通常低于方法 b() 的概率，这仅仅是因为方法 b() 可能会被更多类所依赖。

这种减少涟漪影响的可能性是封装的一个关键好处。

考虑任何程序中源代码依赖项（MPE - 首字母缩写词来自图论）的最大潜在数量。从上面的定义推断，我们可以说，给定两个向用户提供相同功能的程序，MPE 最低的程序封装得更好，并且从统计上来说，封装得更好的程序维护和开发成本更低，因为成本它的最大潜在变化将低于封装不太好的系统的最大潜在变化。

此外，考虑一种只有方法而没有类的语言，因此没有相互隐藏信息的方法。假设我们的程序有 1000 个方法。这个程序的 MPE 是多少？

封装理论告诉我们，给定一个有 n 个公共节点的系统，这个系统的 MPE 为 n(n-1)。因此，我们的 1000 个公共方法的 MPE 为 999,000。

现在让我们将该系统分成两个类，每个类有 500 个方法。由于我们现在有类，我们可以选择将一些方法设为公共的，而将一些方法设为私有的。除非每种方法实际上都依赖于其他所有方法（这不太可能），否则情况就是如此。假设每个类中有 50 个方法是公共的。系统的 MPE 是多少？

封装理论告诉我们它是：n((n/r) -1 + (r-1)p) 其中 r 是类的数量，p 是每个类的公共方法的数量。这将使我们的二分类系统的 MPE 为 499,000。因此，在这种二类系统中进行更改的最大潜在成本已经大大低于未封装系统的最大潜在成本。

假设您将您的系统分成 3 个类，每个类有 333 个类（好吧，一个将有 334 个），并且每个类都有 50 个公共方法。什么是 MPE？再次使用上述等式，MPE 约为 482,000。

如果将系统分成 4 类，每类 250 个方法，则 MPE 将为 449,000。

如果看起来增加我们系统中的类数量总是会降低它的 MPE，但事实并非如此。封装理论表明，为了最小化 MPE，系统应该分解成的类数是： r = sqrt(n/p)，对于我们的系统，实际上是 4。例如，具有 6 个类的系统将具有 MPE 465,666。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T01:11:28.117

我更喜欢类，以便我可以将一个大问题分成可作为单独单元进行测试的可管理部分。恕我直言，代码重用被高估了——我几乎没有看到它发生在我工作的地方。对我来说，我从好的 OO 中得到的最大好处是良好的可测试性。

另一个极端是使用一堆全局变量，把你所有的逻辑都塞进`public static void main`（或`Page_Load`在ASP.NET中），然后调用调用其他静态方法的静态方法等等……（我在最后一句话的结尾头晕了） .)

唯一会打破我的 OO 思维方式的是，如果我使用的是纯函数式语言，不幸的是，这是我自大学以来就没有考虑过的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T02:31:50.997

通过使简单的问题变得不必要的复杂（一直到OO），可能会过度设计一个简单的问题。但是，对于任何足够大的问题，我认为 OO 范式不太可能是导致它首先变大的原因。以操作系统为例，如果它不是以面向对象的方式编写的，很难想象它易于维护（代码方面）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-19T02:34:55.983

如果您在大型应用程序中有一堆“裸”功能，则很难对这些功能进行更改。

*   更难看出谁在使用该功能（“如果我改变它，它会影响谁？”）
*   很难在不破坏其他人代码的情况下对功能进行更改。

如果将函数包装在类中，则有助于隔离代码的范围。这不是灵丹妙药，但它有帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-19T01:18:52.987

两件事情。

第一个是类是**不透明**的域实体的想法。*如果做得正确*，面向对象的程序会引入一个抽象层：在下一个最高层，您可以将对象编组为您想做的事情，而不是处理细节。您不需要知道对象和类是如何工作的：只需要知道它们的作用。这是一种信息隐藏，它降低了团队在工作时必须记住的复杂性。

第二个是OO编程允许一种代码重用：您可以定义覆盖其他类中某些行为的类（继承），或者其实例包含其他类实例的类，使用它们来实现其目的（封装和组合） .

*正确*使用 OO 技术可以减少您需要管理的代码量，并减少您在工作或维护系统时需要记住的事情的数量。在实践中，这种方法并不总是有效。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-19T02:03:56.110

> 客观地说，你怎么知道类的使用不是导致应用程序变大的原因呢？

以任何不是用 OO 语言（例如 C、COBOL，甚至是普通 SQL）编写的大型程序/应用程序为例，您应该能够看到代码大小并不直接归因于语言范式。对于每一个设计良好、高度精炼、可重用的 C# 或 Java 组件，也有相同数量的精心设计、高度精炼、可重用的 C DLL。相反，有同样数量的可怕、臃肿的代码。

关键是，优秀的程序员能够改进他们的系统设计，而不管语言/平台如何。

关于 OOP，至少对我而言，它带来了一种“潜力”——一种*更接近*我们现实世界的编程世界观。我们都知道我们的世界和这个物质宇宙充满了由*更小的物体组成的物体*。从银河系的恒星系统一直放大到分子、原子和亚原子粒子，令人惊叹的是，由相同的微小粒子以各种模式组合而成的截然不同的物质是多么的惊人。甚至看看我们自己的生物学，有时认为我们身体的 60% 被分解到最好的状态实际上只是水，这令人难以置信。然而，看看所有不同的系统和器官都在燃烧着化学物质，让我们保持运转和活着。

当我们学会理解构成我们在日常生活中看到的现实世界系统的构建块的简单性（哦，真的......哈哈），我们应该能够理解设计和构建极其复杂或复杂的系统应该从自己做的很少的小组件开始。通过慢慢地将它们组合和网格化成更大的组件，我们可以获得更多的功能和能力。直到我们达到我们设想的所需系统。

（正确）使用类是将系统分解成最好的。尽可能。这样您就可以一次查看某些内容和特定的抽象级别，而不会被与您当前关注的领域无关的目的和逻辑所淹没。每当你设计一个系统时，想想你自己的解剖结构；想想你将*如何*设计人体。每当您设计系统时，请考虑*创办一家新公司*；什么是主要部门，您需要经营业务的部门。谁是管理这些部门所需的员工类型。他们需要使用并与之交互以执行工作的各种设备。您如何将业务运营分解为最精细的部分，以便让自己更好地理解它？

当您了解某些物体只是由较小的物体组成的基本原理时，您将开始创建高度可重复使用的细胞或分子。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-19T02:05:50.473

在我可以一次处理复杂项目的一小部分方面，课程对我最有帮助。能够将代码的一个方面与大型项目分离是非常有帮助的，这样您就不会不知所措。最后，这些类之间的凝聚力可以​​让您快速了解程序的工作原理，而无需处理内部问题。

就可维护性而言，在我看来，查看 UML 类图并弄清楚所有内容的布局比查看函数列表要容易得多。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-19T02:29:40.830

我认为通过说类，你应该指对象。类只不过是您可以放入对象的地方。OOP 范式如此成功是有原因的。一旦你有那个'啊哈！当您认为您终于理解了 OOP 的概念时，您可以开始以更有条理的方式进行编程。

我已经在 Visual Basic 3 中编程了很长时间，所以我在函数式编程方面有很多经验，然后来到 VB5 并发现对象是一种巨大的解脱，因为我可以将现实世界的实体与我的代码联系起来，它帮助很多。

这就是它的全部意义，在您的代码中重新创建真实世界的实体。它使阅读和工作更容易，因为您可以拿起一些东西并用它做一些事情，或者对它做一些事情。

# c# - 调试 ASP.NET 会话状态服务器问题

> ID：456220
> 
> 赞同：3
> 
> 时间：2009-01-19T00:31:08.357
> 
> 标签：c#, .net, asp.net, session

我们有一个在负载平衡服务器实例上运行的应用程序，因此配置为使用 ASP.NET 会话状态服务，该服务在我们的一个数据库服务器上运行。虽然我们的应用程序的两个实例都可以成功连接到状态服务器，但会话状态数据的更改并没有反映在它们之间。FI，如果我`Session.Add('SomeKey', SomeData)`在服务器 A 上调用，如果我随后尝试`Session['SomeKey']`在服务器 B上访问，则不会反映这一点。

Session.SessionID 在两台服务器上返回相同的值，并且我检查它们是否都使用在 machine.config 的 machinekey 部分中配置的相同验证密钥和解密密钥值。我什至尝试在应用程序 web.config 中指定这些值。

我应该注意哪些其他可能导致这些症状的事情，人们可以推荐哪些步骤来帮助调试此问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T00:39:46.327

这有帮助吗：

[http://support.microsoft.com/kb/325056](http://support.microsoft.com/kb/325056)？

> 要跨 Web 场中的不同 Web 服务器维护会话状态，Microsoft Internet 信息服务 (IIS) 元数据库中网站的应用程序路径（例如 \LM\W3SVC\2）对于所有 Web 必须相同Web 场中的服务器。大小写也需要相同，因为应用程序路径区分大小写。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T01:53:24.680

我最终使用 iiscnfg /copy 将 IIS 元数据库从一台服务器完整复制到另一台服务器，这解决了问题。感谢 EJ Brennan 让我走上了通往荣耀的道路。

# python - 如何将 cvxopt 与 DSDP 一起使用？

> ID：456224
> 
> 赞同：2
> 
> 时间：2009-01-19T00:33:12.563
> 
> 标签：python, convex-optimization

我正在尝试将 DSDP（半定编程包）与 cvxopt 一起使用。我已经安装了它们（DSDP 的 matlab 版本）。我有 Python 2.5.2。

尝试使用时

```
dsp(..., solver='dsdp') 
```

我收到一个错误，提示未安装solvers.dsdp。

我如何让它们一起工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T05:39:24.973

我建议在[cvxopt](http://groups.google.com/group/cvxopt)组上问这个问题。

# c# - Error 10048 when trying to open TcpChannel

> ID：456229
> 
> 赞同：1
> 
> 时间：2009-01-19T00:35:31.357
> 
> 标签：c#, .net, remoting, winsock

I'm pretty inexperienced in Remoting. I'm trying to use it and keep receiving WinSock error 10048 when opening TcpChannel.

I use the simplest code from MSDN:

```
 TcpChannel serverChannel = new TcpChannel(9090);
    ChannelServices.RegisterChannel(serverChannel);
    RemotingConfiguration.RegisterWellKnownServiceType(
        typeof(RemoteObject), "RemoteObject.rem", 
        WellKnownObjectMode.Singleton); 
```

When ran for the first time, it work and quit correctly, but for second and so on I keep receiving error 10048, like socket 9090 is already in use. Netstat -a do not show port 9090 at all, like it was closed already.

What am I doing wrong?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T00:43:34.790

Prior to asking here I've spent four days trying to solve this, and already here's an answer: it's just WinSock in Windows XP was corrupted.

Two simple Windows commands solved the problem:

netsh int ip reset resetlog.txt

netsh winsock reset

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T02:12:26.887

Error 10048 corresponds to WSAEADDRINUSE, which means that the address is in use already. From what I can tell, it would most likely mean that port 9090 is already taken by another application.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T02:17:07.220

Yes, of course. Problem was that there wasn't any applications using that port (at least visible by netstat). I've tried many other ports like 39000, 9095 and so on, with exactly same results.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T14:43:56.987

我怀疑 ISA Server Firewall Client 有时可能会导致这种行为。

# c# - 一个列表中多个对象类型的 XmlSerialization

> ID：456231
> 
> 赞同：2
> 
> 时间：2009-01-19T00:36:14.477
> 
> 标签：c#, serialization, xml-serialization

我有一个包含抽象“aninamls”列表的对象。IE

```
var animals = new Animals
{
   new Bird{ TailFeatherColour = "Blue" },
   new Cat{ Colour = "Brown" }
}; 
```

使用xmlserializer，是否可以将上面的序列化为以下xml，

```
<?xml version="1.0" encoding="utf-16"?>
<Animals>
    <Bird>
        <TailFeatherColour>Blue</TailFeatherColour>
    </Bird>
    <Cat>
        <Colour>Brown</Colour>
    </Cat>
</Animals> 
```

目前，我只能得到以下内容：

```
<?xml version="1.0" encoding="utf-16"?>
<Animals>
    <Animal xsi:type="Bird">
        <TailFeatherColour>Blue</TailFeatherColour>
    </Animal>
    <Animal xsi:type="Cat">
        <Colour>Brown</Colour>
    </Animal>
</Animals> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T00:47:41.567

当列表是另一个类中的字段时，可以使用[`XmlElementAttribute`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlelementattribute.aspx)and[`XmlArrayItemAttribute`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlarrayitemattribute.aspx)属性来执行此操作（区别在于前者没有在列表元素周围放置容器元素，而后者有）。

我不相信你可以只用一个列表来实现你想要的，即当被序列化的实际对象是一个列表时（尽管我在这里可能是错的）但是你可以通过在一个类中嵌套一个列表来伪造它，例如

```
[XmlRoot("Animals")]
[XmlType("Animals")]
public class AnimalsWrapper
{
    [XmlElement(typeof(Bird), ElementName = "Bird")]
    [XmlElement(typeof(Cat), ElementName = "Cat")]
    public List<Animal> Animals;
} 
```

这有点笨拙，但会序列化为您要查找的内容。

# iphone - NSMutableArray 内存管理

> ID：456233
> 
> 赞同：23
> 
> 时间：2009-01-19T00:36:48.810
> 
> 标签：iphone, cocoa, macos

```
NSMutableArray *a1 = [[NSMutableArray alloc] init];
NSMutableArray *a2 = [NSMutableArray array];

TempObj *obj = [[TempObj alloc] init]; //assume this line is repeated for each obj
[a1 addObject:obj];
[a1 addObject:obj2];
[a1 addObject:obj3];
[a1 addObject:obj4];

[obj release];
[obj2 release];
[obj3 release];
[obj4 release];

[a1 release]; 
```

好的，所以 a2 是一个 autorelease obj，所以我不必调用 release 吗？另外，您如何知道何时获得自动释放对象？

而对于a1，我不必循环遍历数组并首先释放每个对象？如果我调用 [a1 removeAllObjects]; 怎么办？是否调用 [[a1 objectAtIndex:#] release];

我应该在将这些对象添加到数组后释放它们吗？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-19T00:51:11.950

当您将对象添加到数组时，它会调用`retain`该对象。如果您不释放指向该对象的指针，那将是泄漏。当你释放数组时，它会调用`release`它持有的所有对象，因为它之前调用`retain`过。

至于 autorelease 与 release，唯一确定的方法（除了可能阅读文档）是通过方法的名称。我相信一般的规则是，如果你没有分配对象，那么你不负责释放它。

关于对象创建方法，所有便捷方法（`array:`、`arrayWithObjects:`、`arrayWithArray:`等）都返回自动释放的对象。但是，它们对应的 init 方法（`init:`、`initWithObjects:`、`initWithArray:`等）不会 - 如果您调用它们，则您有责任调用`release`返回的对象。

我似乎在这里想起了有关此主题的其他一些问题-您可以尝试四处寻找更详尽的解释。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-19T00:57:26.163

*将 Objective-C 内存管理视为所有权*而不是保留释放更容易。当您将对象添加到数组时，数组现在是对象的共同所有者，并负责正确管理内存。当所有者（任何包含您发布的代码`release`的对象）调用对象时，它就会放弃所有权，现在数组是唯一的所有者。

Apple 对所有权在 Cocoa 中的工作方式（包括您如何知道何时负责调用`release`对象）有很好的入门：[Memory Management Programming Guide For Cocoa](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)。如果您想使用 Cocoa，这是必读的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T13:00:34.847

要记住的基本事项是：您必须平衡对“init”、“retain”或“copy”的每次调用与对“release”或“autorelease”的相应调用。这就是你需要知道的一切。

在您的示例中， a1 调用了“init”，因此您需要在其上的某处有一个“发布”。与“obj”同上。你没有在其他任何东西上调用“init”、“retain”或“copy”，所以你不需要在其他任何东西上调用“release”或“autorelease”。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-05-20T03:42:32.127

我不知道我是对还是错

```
NSMutableArray *a1 = [[NSMutableArray alloc] init]; // will be autorelease
NSMutableArray *a1 = [NSMutableArray alloc]; // will not autorelease 
```

您先请`[a1 removeAllObjects];`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-11-24T20:12:47.713

在将 obj、obj2、obj3、obj4 添加到数组后（最好的方法），您就释放了它们。否则你必须循环并释放每个对象（这是愚蠢的方式：我到目前为止所做的那个）。

# browser - 推荐的网站分辨率（宽度和高度）？

> ID：456250
> 
> 赞同：124
> 
> 时间：2009-01-19T00:53:41.477
> 
> 标签：browser, standards, resolution

常见的网站分辨率有什么标准吗？

我们的目标是较新的显示器，宽度可能至少为 1280 像素，但高度可能会有所不同，并且每个浏览器的工具栏高度也可能不同。

这有什么标准吗？

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2009-02-12T15:57:00.160

这几天的建议是：

**针对 1024x768 进行优化**。对于大多数网站，这将涵盖大多数访问者。大多数日志显示，您 92-99% 的访问将超过 1024 宽。虽然 1280 越来越普遍，但仍有很多 1024 和一些低于此。为此进行优化，但不要忽略其他。

**1024 = ~960**。考虑到滚动条、窗口边缘等意味着 1024x768 屏幕的实际宽度[约为 960 像素](http://www.cameronmoll.com/archives/001220.html)。一些工具基于**稍小的尺寸，大约 940**。这是[twitter bootstrap](http://getbootstrap.com/docs/4.1/layout/overview/)中的默认容器宽度。

**不要为一种尺寸设计**。窗口大小各不相同。不要假设屏幕大小等于窗口大小。设计一个合理的最小值，但假设它会调整。

**使用响应式设计和流动布局**。使用在调整窗口大小时会调整的布局。人们经常这样做，尤其是在大显示器上。这只是一个很好的 CSS 实践。有几个前端框架支持这一点。

**把手机当一等公民**。您一直在从移动设备获得更多流量。这些引入了更多的屏幕尺寸。您仍然可以针对 960 进行优化，但使用响应式网页设计技术意味着您的页面将根据屏幕大小进行调整。

**记录浏览器显示信息**。您可以获得有关此的实际数字。[我在这里](http://www.w3schools.com/browsers/browsers_display.asp)、[这里](http://www.boutell.com/newfaq/creating/resolution.html)和[这里](http://www.upsdell.com/BrowserNews/stat_trends.htm#res)找到了一些数字。您还可以操纵您的网站来收集相同的数据。

**用户会滚动，所以不要太担心 height**。旧的论点是用户不会滚动，任何重要的东西都应该“放在首位”。这在几年前就被推翻了。[用户滚动很多](http://www.useit.com/alertbox/scrolling-attention.html)。

有关屏幕分辨率的更多信息：

*   [屏幕分辨率和页面布局](http://www.useit.com/alertbox/screen_resolution.html)
*   [设计网站的最佳屏幕分辨率](http://www.hobo-web.co.uk/tips/25.htm)
*   [为浏览器尺寸设计 - 不是屏幕尺寸](http://justaddwater.dk/2006/08/17/design-for-browser-size-not-screen-size/)

更多关于响应式设计：

*   [响应式网页设计](http://www.alistapart.com/articles/responsive-web-design/)（2010 年，5 月 25 日），Ethan Marcotte，A List Apart。
*   维基百科的[响应式网页设计](http://en.wikipedia.org/wiki/Responsive_Web_Design)
*   [多设备布局模式](http://www.lukew.com/ff/entry.asp?1514)（2012 年 3 月 14 日）Luke Wroblewski。为可适应的多设备屏幕布局列出最流行的模式。

用于响应式设计和流动布局的工具和前端框架：

*   [推特引导](http://getbootstrap.com/)
*   [祖布基金会](https://foundation.zurb.com/)
*   [用于响应式网页设计的 50 个出色工具](http://www.creativebloq.com/css3/tools-responsive-web-design-5132770)（2012 年 4 月 24 日）Denise Jacobs 和 Peter Gasston

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-19T00:57:26.040

坏主意，我相信。将内容与布局分开的重点是使您的网页能够显示在任何类型的浏览器上。

设置最小屏幕尺寸等人为限制将限制您的市场。

话虽如此，我相信每个桌面都应该能够显示 1024x768。但是，在 iPhone 或其他屏幕挑战设备上运行的浏览器，甚至是那些不使用整个桌面浏览器的浏览器呢？

在回答您的具体问题时，不，我认为浏览器中的最小或公共显示区域没有任何标准。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-19T01:07:31.963

强制用户水平滚动是一种严重的 UI 违规行为。除非您专门为具有已知屏幕尺寸的人群构建网站，否则您最安全的做法是确保您的设计适用于小至 800 像素宽的屏幕（如果我没记错的话，约占网上冲浪人群的 8%）。让它很好地适应更大的屏幕是明智的，但不以仍在以 800x600 冲浪的人们为代价。

这里还有一件事需要考虑：不是每个人都全屏运行他们的浏览器（我没有）。因此，如果可以为特定（和大）“屏幕尺寸”进行设计的想法由于多种原因确实行不通。

2010 年 12 月 15 日更新：当我第一次回答这个问题时，800 像素是一个合适的答案。但是，在这一点上，我会推荐 1024 像素宽（或其他人指出的 960 像素）。科技在前进...

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-19T01:04:35.370

以下是2008年浏览器显示统计：http: [//www.w3schools.com/browsers/browsers_display.asp](http://www.w3schools.com/browsers/browsers_display.asp)

大约 50% 的用户仍在使用 1024x768。如果您希望您的网站在高分辨率下看起来不错，请使用灵活的布局。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-25T01:02:01.720

实际上有宽度的行业标准（至少根据雅虎）。它们支持的宽度为 750、950、974、100%

这些宽度的优势在于其预定义的网格（列布局），如果您要包含任何广告，它们可以很好地与广告的标准尺寸配合使用。

有趣的谈话也值得一看。

见[YUI 基地](http://developer.yahoo.com/yui/base/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-02-13T23:22:08.200

这是一个很棒的工具：[Google Labs Browser Size](http://browsersize.googlelabs.com/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-19T00:59:46.143

我想说你应该只期望用户拥有一台分辨率为 800x600 的显示器。加拿大政府的标准将此列为要求之一。尽管对于拥有精美宽屏显示器的人来说，这似乎很低，但请记住，并不是每个人都有一台好的显示器。我仍然知道很多人在 1024x768 上运行。并且在 800x600 中运行的人并不罕见，尤其是在旅行时在廉价的网吧中。此外，如果您不想让浏览器窗口全屏显示，这也不错。您可以在更宽的显示器上使站点更宽，但不要让用户水平滚动。曾经。支持较低分辨率的另一个优点是您的网站可以在手机和 Nintendo Wii 上轻松运行。

关于您至少 1280 宽的注释，我不得不说这太过分了。大多数 17 甚至我的 19 英寸非宽屏显示器仅支持 1280x1024 的最大分辨率。而我现在正在打字的 14 英寸宽屏笔记本电脑只有 1280 像素宽。我会说你应该争取的最大最小分辨率是 1024x768，但 800x600 是理想的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-19T01:14:35.367

到目前为止所有的答案都是关于桌面显示器，但我在我的 iPhone 上使用堆栈溢出，我认为你不应该通过定位 1024 或 1280 水平像素来排除任何移动平台。标记您的页面，以便浏览器知道这一切意味着什么，使其可用将免费提供，即使在屏幕阅读器和您没有想到的其他工具包上也是如此。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-19T00:57:54.527

最好不要针对任何特定的分辨率，而是轻松适应许多不同的分辨率。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-19T01:07:28.937

虽然最佳宽度可能达到 1024，但您必须根据各种浏览器设置（导航工具栏、书签工具栏、状态工具栏等）和任务栏设置调整高度。它会迅速将 768 降至 550 左右。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-19T01:08:34.333

无论您的目标浏览器大小如何，请确保包含上述浏览器工具栏、状态栏和滚动条的空间。Internet Explorer (IME) 的工具栏和状态栏通常有超过 100 像素的垂直空间。通常，如果我要拍摄 1024 x 768，我会尝试创建大约 960 - 980 像素宽和 600 像素高的设计以确保安全。这样，您可以在必要时容纳滚动和一些漂亮的空白（如果设计需要）。对于需要针对特定​​尺寸的实例，我强烈推荐 YUI 网格：

[YUI 网格](http://developer.yahoo.com/yui/grids/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-19T18:19:13.397

我从设计师那里得到了很多问题，不仅是关于宽度，还有关于使用什么高度来“让所有东西都保持在折叠之上”。这是我最近给出的一个答案——

对于宽度，我不是设计师，但我已经读到 960 像素宽度是这些天要走的路，因为它有助于将其分成看起来不错的列，并且非常适合大多数显示器。如果可以的话，设计一个流动的布局——但这并不总是实用的，这取决于你的设计师、你的 CSS 技能、图像和文本的数量。

（您总是希望每行有 65-80 个字符，行高约为 1.15）。这是文本的最佳列宽，并且已被证明比非常宽或窄的列更快、更令人愉悦）

至于“首屏”，我只需要注意不要在网络上使用任何此类概念。水平滚动可以而且应该避免，但垂直滚动是你不能 100% 避免的。我只能告诉你的是，在 1024x768 显示器上（至少 95% 的用户有这个或更高）你应该可以使用固定的 600px 高块。但是那里有许多不同的显示格式，浏览器 chrome 会占用很多空间，并不是每个人都会最大化浏览器窗口。

这里还有一些其他网站或多或少说了同样的话——但计划让每个人都“首当其冲”的一切都很难，因为根据实际统计数据，你可能只有 400px 左右。

最后是一篇非常详细的长篇文章（我会发布更多，但我说我太菜鸟了） -[如何设计浏览器大小 - baekdal.com](http://www.baekdal.com/articles/Usability/browser-size-design/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-07-23T13:08:36.490

我个人一直坚持最大宽度为 1000 像素，位于页面中间（通过左/右边距：自动）。

如果您运行的分辨率低于 1024x768，则该升级了。严重地。快到 2010 年了。您可以购买原生分辨率为 1280x1024 的廉价 bin 液晶显示器。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-12-13T19:06:12.647

我建议你看看媒体查询。这是对 CSS 的一个有用的新增功能，它真的很有意义，你会想知道为什么它没有早点实现。基本上，它允许您直接通过 CSS 定位浏览器属性（例如最大和最小宽度）并从那里分支您的布局代码。与创建打印样式表类似，您可以在同一个文件中并行创建桌面和移动布局，这对开发很有帮助。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-03-31T08:57:15.103

灵活或流动的布局确实会限制设计，例如，如果您使用必须与主体背景图像匹配的背景图像。

我宁愿为网站制作不同的 css 布局，并根据用户的分辨率应用它们，或者如果这不可能（尚未深入研究），请将其设为可选选项。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-09-11T19:58:38.340

好吧，我在这里看到很多错误信息。对于初学者，使用特定分辨率（例如 800x600）创建网页时，仅使用该分辨率即可正确呈现该页面！当同一页面显示在其他人的笔记本电脑或家用 PC 显示器上时，该页面将使用该屏幕的当前分辨率显示，而不是您在设计页面时使用的分辨率。不要为一种特定的分辨率创建网页！有太多不同的纵横比和屏幕分辨率，无法期待“一刀切”的场景，而网页设计不存在这种场景。这是解决方案：使用 CSS3 媒体查询创建分辨率自适应代码。这是一个例子：

```
@media screen and (max-width: 800px) {
styles
}
@media screen and (max-width: 1024px) {
styles
}
@media screen and (max-width: 1280px) {
styles
} 
```

看，我们刚刚所做的是指定了 3 组以不同分辨率呈现的样式。在我们的示例中，如果屏幕的分辨率大于 800 像素，则将执行 1024 的 CSS。同样，如果显示内容的屏幕是 1224 像素，则将执行 1280，因为 1224 大于 1024。我正在处理的网站现在可以在 800x600 到 1920x1080 的所有分辨率下运行。要记住的另一件事是，并非所有具有相同分辨率的显示器都具有相同尺寸的屏幕。您可以将 15.4 台笔记本电脑并排放置，虽然它们看起来相同，但它们的分辨率可能截然不同，因为并非所有像素在不同的 LCD 屏幕上的大小都相同。因此，使用媒体查询，并开始使用具有高分辨率（尤其是 1280+）的笔记本电脑屏幕创建您的网站。还，在您的笔记本电脑上使用不同的分辨率创建每个媒体查询。您可以使用 Windows 中的分辨率设置向下调整 800x600 并在该分辨率处创建媒体查询，然后切换到 1024x768 并在该分辨率处创建另一个媒体查询。我可以继续说下去，但我认为你们应该明白这一点。

更新：这里是使用媒体查询的链接，这将有助于解释更多， [带有媒体查询的移动设备的创新网页设计](http://www.pctechauthority.com/innovative-web-design-for-mobile-devices.html)

该教程将向您展示如何为所有设备进行设计。还有专门针对媒体查询的教程。我开发了整个网站以在所有设备、所有屏幕和所有分辨率上呈现，不使用子域，只使用 CSS！我仍在努力支持平板电脑和智能手机。该网站可以在任何笔记本电脑或您的 50 英寸液晶电视上完美呈现，并且许多页面可以在所有移动设备上完美运行。如果您将所有代码都放在页面上，那么您的页面将快速加载！另外，一定要注意那篇文章中关于 CSS“background-size:cover;”的讨论。或“包含”属性，它们将使您的背景图形流畅并能够在所有分辨率下完美呈现。

按照网站教程，您可以制作一个可以呈现所有内容的网页！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-19T01:03:38.697

我们使用的指南似乎被广泛使用，并得到了我们从 Google Analytics 获得的数据的支持，旨在设计网站，使其能够在 1024 像素宽和 768 像素高的屏幕上运行（1024x768 1280x800 是我们看到的最常见的分辨率，至少占所有流量的 70%）。

这就是为什么您会看到许多网站（包括这个网站）使用大约 1000 像素宽的中心列，并且最重要的内容位于顶部 500-600 像素中，因此在这种尺寸的屏幕中查看时它位于首屏之上。

使用 1000 像素宽的布局在高达约 1680 像素宽的屏幕尺寸上效果相当好（通常与您在笔记本电脑上看到的一样高，除了大的 17 英寸笔记本电脑），但在 1920 像素上看起来有点傻宽的（高端计算机，通常是工作站），但是这些非常高的分辨率在一般互联网上的流量中所占的比例并不大 - 2% 或更少（另一方面，如果你有像这个网站这样的专业观众，高分辨率的数字可能会更高一些）。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-01-19T01:03:59.583

尝试将 1024 作为最小宽度。试试它看起来如何 800，但不要太费心让它工作。在 800x600 时，几乎所有主要网站都无法正常工作，因此以该分辨率工作的人无论如何都会遇到问题。

如果您打算采用流线型布局，请确保文本不会**太宽**，因为当行太长时，它们会变得难以阅读。这就是大多数网站具有固定宽度的主要原因。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-19T01:09:17.793

我的目标是 1024 像素显示器（但不要使用 100% 的空间）。我已经放弃了那些800x600的。我宁愿用过时的硬件惩罚少数人，让他们在需要时滚动，而不是通过浪费空间用新设备惩罚每个人。

我想这取决于您的受众，以及您的应用程序的性质。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-01-19T02:51:55.577

归根结底，这不是标记标准或最佳实践的问题，而是了解您的*受众*并确保您的网站做您想做的事情。

考虑浏览器视口的宽度而不是屏幕分辨率更重要——您不能假设显示器上的每个像素都将分配给浏览器（即使是这样，您也必须减去浏览器镶边）。如果您有权访问报告浏览器宽度（*nb*浏览器宽度，而不是屏幕分辨率）的分析，那么请密切注意。

尝试容纳尽可能宽的视口范围很好，但也有一些限制。有些挑战可以用[CSS 媒体类型](http://www.w3.org/TR/CSS2/media.html)处理，有些则不能。有些可以用流体布局来处理。但是流畅的布局不能在所有情况下都起作用，这取决于要显示的信息类型、行长、阅读舒适度*等。*一些流畅的布局在宽屏显示器中不起作用。大多数在尺寸低于一定宽度时会断裂，*等等。*

尽管我个人希望为约 960 像素及以上的视口进行设计，但您不能总是这样做。所以在某些情况下，为 <=760 像素左右的视口（800 像素宽显示，最大化）设计仍然是最安全的——尽管我们最终可以一劳永逸地抛弃这个限制——至少对于桌面——正在快速接近。

在转换是一个问题的地方——并且你有一个固定宽度的布局——你最好有一个很好的理由来放置用户需要点击的任何东西，以便收银机在 760th 以东的任何地方“ka-ching”像素。

主导航同上。

最后，在你能得到的所有东西上测试你的布局。大的。小的。桌面。手持式。作品。没有替代品。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-01-19T03:30:23.720

我刚刚从我可以访问的所有客户端站点中获取了屏幕分辨率的样本，其中包括超过 8 个行业的 20 多个站点，结果如下：
[alt text http://unkwndesign.com/so/percentScreenResolutions.png](http://unkwndesign.com/so/percentScreenResolutions.png)
基于此，我会说确保它在 1024x768 上看起来不错，因为这是大多数情况下的远景。也不必担心高度，但是尽量避免以默认字体大小使大多数页面超过 1-2 个打印页面，大多数人不会阅读那么长的页面，并且如果用户安装的工具栏占用垂直空间，我个人的偏好是这是他们的问题，但我认为这没什么大不了的。

*请注意，由于四舍五入，百分比加起来为 100.05%。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-12T16:32:14.193

请记住，分辨率越高，互联网浏览器被最大化的可能性就越小。

有些浏览器也有横向栏。

这取决于您要渲染的内容，但我会使用不会在大约 800-900 宽度处中断的可变宽度布局。

身高其实不是问题。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-07-23T13:04:46.863

sbeam 说'你总是希望每行有 65-80 个字符'。那不是真的。例如，维基百科每行可能有 180 个字符。或者它是一个特定的网站？

# visual-c++ - 为什么 bind() 返回 SOCKET_ERROR

> ID：456256
> 
> 赞同：1
> 
> 时间：2009-01-19T00:57:53.560
> 
> 标签：visual-c++, winsock

没有：

*   MFC
*   ATL

使用纯 C++，**WSAGetLastError()**返回**10014** - 错误地址

*   我错过了什么/做错了什么？

代码说明：

```
sockaddr_in sin;
SOCKET server;

if ((server = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP)) == SOCKET_ERROR)
{
    cerr << "Error: socket() return value == SOCKET_ERROR" << endl;
    WSACleanup();
    exit (EXIT_FAILURE);
}

sin.sin_family = AF_INET;
sin.sin_addr.s_addr = INADDR_ANY;
sin.sin_port = htons(1234); //random port

if(bind(server, (sockaddr *)&sin, sizeof(sin) == SOCKET_ERROR))
{
    wError = WSAGetLastError();
    cerr << "Error: bin() return value == SOCKET_ERROR\n"
            "Details: " << wError << endl;
    WSACleanup();
    exit (EXIT_FAILURE);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T01:02:20.430

如果那是您的真实代码，那么您在绑定调用中将括号放在错误的位置。最后的两个之一应立即移至“sizeof(sin)”之后。

换句话说，将其更改为：

```
if(bind(server, (sockaddr *)&sin, sizeof(sin) == SOCKET_ERROR)) 
```

到：

```
if(bind(server, (sockaddr *)&sin, sizeof(sin)) == SOCKET_ERROR) 
```

这是一个与套接字编程无关的细微 C 错误，但说明了在使用一种易于拥有语法正确但语义不正确的语句的语言时需要格外小心。

你有它的方式，它计算“ `sizeof(sin) == SOCKET_ERROR`”（它总是假的（零），因为 sizeof(something) 总是一个或多个，并且 SOCKET_ERROR 总是 -1，至少对于 WinSock）。

然后它将这个零作为第三个参数传递给 bind() ，它自然会抱怨您没有为地址结构提供足够大的大小。

并且，正因为如此，bind() 返回一个非零错误代码，这就是你的 if 块正在执行的原因。

一个非常微妙的。尽管我已经使用 C 语言 20 多年，但我对 C 语言的尊重仍然很高——尊重是“我在塞伦盖蒂时尊重狮子”而不是“我尊重我妻子的意见”： -)

# .net - 是否有一个好的、可重用的解析器将字符串转换为列表的层次结构？

> ID：456259
> 
> 赞同：0
> 
> 时间：2009-01-19T00:59:25.740
> 
> 标签：.net, string, parsing, hierarchy

我想采用这样的字符串：

```
[One, Two[A, B[i, ii, iii, iv], C], Three] 
```

并将其转换为列表层次结构，这样如果我执行如下代码：

```
Console.Write(myList[1][1][2]); 
```

输出将是：

```
iii 
```

我希望这是一个足够普遍的要求，有一些用 C# 编写的简单解析代码。

让我知道我的问题是否可以更清楚地表达。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T01:47:54.613

XML 或[JSON](http://www.json.org/)是存储此类内容的绝佳方法。

正如斯宾塞所说——这是一个难题——我不建议你自己动手。

向下滚动到该 JSON 链接的底部，以了解大多数语言的实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T01:57:09.103

我必须使用正则表达式。子字符串匹配和子表达式可以为您提供递归以获取 sub-sub-... 级别。

在 preg 中使用 /^\[(.+)\]$/ 之类的东西来收集单个级别的项目。处理它直到你不再收到一个级别，在你获得单个系列的胆量后在'，'上爆炸。

用 ',' 分割结果。

应该像

*   [一，二[A，B[i，ii，iii，iv]，C]，三]
    *   一
    *   二
    *   [A, B[i, ii, iii, iv], C]
        *   一种
        *   乙
        *   [一、二、三、四]
            *   一世
            *   ii
            *   三
            *   iv
        *   C
    *   三

最后修剪左/右空间以获得完美的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T01:46:05.817

你追求的是数组还是列表？

这对于字符串来说是非常困难的，因为你必须处理空格，或者在元素中使用逗号等。

如果您可以控制此列表中的内容，我建议您查看 XML 或二进制序列化，它们具有帮助您执行此操作的库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T01:53:48.127

这不是一个实用的答案，但如果您能够使用 .NET 4.0 测试版，您可以查看微软正在为文本 DSL 开发的 Oslo（以及后续工具），这似乎正是您所需要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T03:40:02.700

如果您有能力控制格式，我也会投票支持 XML 或 JSON 或其他格式。但是缺少这些，这是解析器的 Python 实现，因为我很无聊。

```
class ExprParser(object):
current = []
list_stack = []

def __init__(self):
    pass

def parse(self,input):
    for atom in [s.strip() for s in input.split(',')]:
        self.parse_atom(atom)
    return self.current

def do_pushes(self,atom):
    """ Strip off the '[' and push new lists """
    i = 0
    while i < len(atom) and atom[i] == '[':
        self.push()
        i += 1
    return atom[i:]

def do_pops(self,atom):
    """ Pop the lists """
    i = 0
    while i < len(atom) and atom[i] == ']':
        self.pop()
        i += 1

def parse_atom(self,atom):
    push_start = atom.find('[')

    rest = self.do_pushes(atom[push_start:]) if push_start >= 0 else atom

    pop_start = rest.find(']')

    val = rest[:pop_start] if pop_start >= 0 else rest

    self.add(val)

    if pop_start >= 0:
        self.do_pops(rest[pop_start:])

def push(self):
    self.current = []
    self.list_stack.append(self.current)

def pop(self):
    done = self.list_stack.pop()
    self.current = self.list_stack[-1] if self.list_stack else done
    if self.current is not done:
        self.add(done)

def add(self,val):
    self.current.append(val) 
```

像这样使用：

```
parser = ExprParser()
parser.parse('[One, Two[A, B[i, ii, iii, iv], C], Three]') 
```

尽管对格式错误的输入没有错误处理。

# svn - Is svn copy cheap when not done in the repository?

> ID：456263
> 
> 赞同：5
> 
> 时间：2009-01-19T01:00:55.003
> 
> 标签：svn

If I do an svn copy using two urls, I get a 'cheap' copy in the repository...

```
svn copy http://repo_url/trunk http://repo_url/tags/release_foo 
```

But what if do the copy in the working directory and then commit it like this...

```
svn copy trunk tags/release_foo
svn commit tags/release_foo 
```

The copy creates local copies of the files which are automatically svn added. They only go into the repository when committed.

The examples in the doco always seem to use the url to url copy for tagging or branching but I couldn't find anything that explicitly states that you should not use WC to WC followed by a commit.

So are these two methods the same? Do both create a cheap copy inside the repository?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T22:27:12.677

当您在本地进行复制时，您当然会因在本地机器上复制文件而产生空间和时间成本（您的本地文件系统不知道 SVN 增量），但是当您提交时，您应该只看到复制的目录结构的根被列为已添加（带有历史记录）。因此，当您提交时，它将在服务器上创建“廉价”副本。

也就是说，URL 复制方法通常更适合分支或标记，因为它不需要您检查存储库根目录（包括所有分支和标签——这将是巨大的！）。正常的用例是在服务器端分支/标记（使用 URL 副本），然后根据工作需要检查分支/标记。

如果您出于某种原因只是在工作副本中复制文件或文件夹（例如，您将一个类文件分成两个并且您想保留共同的历史记录），那么只需`svn copy`在您的 WC 中使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T01:11:51.143

I believe that a url copy and a WC copy are pretty much the same thing when it comes to being "cheap". In your WC any copy that is made isn't a copy like copying a file on a file system.

svn is smart in that it basically creates some soft links from the origin to your new tag, branch or whatever.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T01:28:05.697

Don't do this:

```
svn merge <local copy>/branch <local copy>/trunk 
```

Your commands like this, can be similarly troublesome:

```
svn copy trunk tags/release_foo
svn commit tags/release_foo 
```

While copying in a local working copy is fine, but these commands make it look like you've checked out the entire repository into a single working copy. I had someone do this and we ended up having to delete trunk and copy it from a previous revision. Unforutnately, I don't remember the details of what boxed us into that corner. I do remember, things go south very quickly when you try to do merges between branches on "local" directories.

Always use repository URLs for creating/managing/merging tags and branches. It's safer. It guarantees your working copy isn't out-of-date for creating the tag/branch and also guarantees the creation is transactional.

I think the problem may have happened like this:

1.  Person A updates their mass everything working copy
2.  Person A makes some tags, does some branches, does some merges, but has not committed, yet.
3.  Person B commits some changes to the source of those tags, or the branch that was merged.
4.  Person A tries to commit and svn won't let them.

Again it was a number of years ago, so I don't remember the specifics, but there isn't really a good reason to set your working copy up like that.

# c# - 有没有办法创建一个随着树被修改而更新的 Linq XElement 迭代器？

> ID：456271
> 
> 赞同：3
> 
> 时间：2009-01-19T01:07:32.230
> 
> 标签：c#, xml, linq

我是 C# 和 Linq 的新手。我正在尝试使用 Linq 生成的元素集合来迭代和修改 XDocument 中的某些元素。我的理解是更新树时枚举不会更新。

例如，给定文档

```
<root xmlns:ns="http://dummy">
<ns:a/>
<ns:b/>
<c/>
<ns:a><ns:a/></ns:a>
</root> 
```

和代码

```
XDocument doc = XDocument.Load(@"test_input.xml", LoadOptions.PreserveWhitespace);
XNamespace ns = "http://dummy";

IEnumerable<XElement> elem_list = from elem in doc.Descendants()
                                  where elem.Name.Namespace == ns
                                  select elem;

foreach (XElement elem in elem_list) {
   if (elem.Name.LocalName == "a") {
      elem.Remove();
   }
} 
```

给出一个错误，因为（我认为）嵌套的“a”元素已从树中删除，但在 elem_list 中仍然“存在”。

我该如何解决这个问题，请记住（1）我想要做的实际操作涉及比上面的示例更复杂的树操作（即复制），以及（2）我正在处理混合内容有显着的空白？其他 .Net XML 文档类中的一个是否有一种迭代方式，随着树的变化而更新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T01:24:32.927

通常，当集合发生变化时，枚举器无法继续运行。但是，如果您在它们上使用`ToArray()`或`ToList()`，则整个结果集合将位于静态列表中。然后，您可以对列表进行枚举，并且将它们（从文档中，而不是从列表中）删除并不重要。

```
XDocument doc = XDocument.Load(@"test_input.xml", LoadOptions.PreserveWhitespace);
XNamespace ns = "http://dummy";

IEnumerable<XElement> elem_list = from elem in doc.Descendants()
                                  where elem.Name.Namespace == ns
                                  select elem;

XElement[] elem_array = elem_list.ToArray();

foreach (XElement elem in elem_array) {
   if (elem.Name.LocalName == "a") {
      elem.Remove();
   }
} 
```

# javascript - 从 IFrame 源中更改 IFrame 属性。是否可以？

> ID：456274
> 
> 赞同：2
> 
> 时间：2009-01-19T01:08:06.643
> 
> 标签：javascript, iframe, adblock

在我的计算机上，我正在使用基于 HOSTS 重定向的自定义广告拦截（因此我可以在 Chrome 中使用广告拦截）。我在我的机器上运行 IIS，所以我有一个自定义的空白 404 错误，当`iframe`页面上显示基于 - 的广告时会显示该错误。

我已经修改了我的 404 错误以从其父级继承其背景颜色，这样广告在非白色背景的网站上看起来就不会令人讨厌。我的下一个挑战是使用我的 404 页面完全折叠`iframe`它，使其根本不会显示在页面上。

`<iframe />`是否可以从 iframe中更改包含标签？如果可能的话，我只想更改高度和宽度属性。如果是这样，我将如何去做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T01:54:42.353

应该不可能，因为 iframe 中的站点可以是外部站点。允许他们操纵他们所显示的环境将是浏览器安全风险。

您最好使用广告拦截代理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T02:19:22.147

如果我理解正确，您是说您希望 404 页面在 iframe 加载到其中时触发它的折叠。最简单的方法是在父页面中创建一个函数，然后在加载时从 404 调用它。

例如，如果您的 iframe 的 id 为“advertFrame”，您可以将以下 javascript 函数添加到父页面：

```
function hideAdvertFrame() {
  var advertFrame = document.getElementById("advertFrame");
  advertFrame.style.height = 0;
  advertFrame.style.width = 0;
} 
```

然后在404页面中，可以在加载时立即调用该函数：

```
<body onload="window.parent.hideAdvertFrame();"> 
```

也就是说，我认为您可能仍然需要考虑除跨框架脚本之外的其他不太容易出现安全漏洞的选项。也许您的父页面可以使用 AJAX 在加载之前检查广告块是否具有有效的 URL，然后在确定后将其动态添加到页面中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T06:41:27.530

填充 iframe 的页面无法更改包含 iframe 的页面的任何内容。如果可以，那将是一个巨大的安全风险。可以肯定的是，我使用我在学校提供的两个域尝试了您所要求的内容。简而言之，它不起作用。我在 Firebug 中收到权限被拒绝错误。

# c# - How do I exit a foreach loop in C#?

> ID：456276
> 
> 赞同：101
> 
> 时间：2009-01-19T01:09:16.657
> 
> 标签：c#, foreach

```
foreach (var name in parent.names)
{
    if name.lastname == null)
    {
        Violated = true;
        this.message = "lastname reqd";
    }

    if (!Violated)
    {
        Violated = !(name.firstname == null) ? false : true;
        if (ruleViolated)
            this.message = "firstname reqd";
    }
} 
```

Whenever violated is true, I want to get out of the `foreach` loop immediately. How do I do it?

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2009-01-19T01:11:13.703

Use [`break`](http://msdn.microsoft.com/en-us/library/adbctzc4.aspx).

* * *

Unrelated to your question, I see in your code the line:

```
Violated = !(name.firstname == null) ? false : true; 
```

In this line, you take a boolean value `(name.firstname == null)`. Then, you apply the `!` operator to it. Then, if the value is true, you set Violated to false; otherwise to true. So basically, Violated is set to the same value as the original expression `(name.firstname == null)`. Why not use that, as in:

```
Violated = (name.firstname == null); 
```

* * *

## 回答 #2

> 赞同：133
> 
> 时间：2009-01-19T01:12:08.287

Just use the statement:

```
break; 
```

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-01-19T01:12:04.870

Use the [`break`](http://msdn.microsoft.com/en-us/library/adbctzc4.aspx) keyword.

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2016-06-06T23:10:49.830

看看这段代码，它可以帮助你快速跳出循环！

```
foreach (var name in parent.names)
{
   if (name.lastname == null)
   {
      Violated = true;
      this.message = "lastname reqd";
      break;
   }
   else if (name.firstname == null)
   {
      Violated = true;
      this.message = "firstname reqd";
      break;
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-22T09:48:36.720

在测试期间，我发现 break 后的 foreach 循环进入循环而不是循环之外。因此，我将 foreach 更改为 for ，并且在这种情况下 break 可以正常工作-在 break 程序流退出循环后。

# dll - 在单个类库中处理多个标准

> ID：456296
> 
> 赞同：0
> 
> 时间：2009-01-19T01:26:14.860
> 
> 标签：dll, specifications, class-library

我目前正在开发一个名为 ADIF 的项目，该项目将支持多种文件编写规范（想象一下，如果您必须支持 XML 1.0、XML 2.0、XML 3.0 等）。目前有两个标准（1.0 版和 2.2.2 版），它们都在商业上使用并且仍然被大量使用。

规范版本 2.2.2 包含了版本 1.0 的大部分内容，但存在一些细微差别，排除了一些继承和其他 OOP 工具。

您将如何组织您的项目以支持旧版本，同时继续跟上新标准。

*   单个类库中的命名空间（Standard.Version1、Standard.Version222、Standard.Version223（下一个版本？）等）？看起来很马虎
*   在同一解决方案中为每个单独的类库（Version222.dll、Version223.dll 等）？显得过分了。
*   等等

我确实打算实现一些代码，这些代码将从一个版本转换为另一个版本。

基本上，我正在寻找一些关于如何最好地组织此类项目的建议。

[http://www.adif.org/](http://www.adif.org/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T01:53:38.470

您说没有可以实现的良好继承层次结构？

如果是这样，我建议您遵循库的命名空间技术，它可以使用 dll 中可能的任何共性来减少自己的工作量。拥有两个 api 将使您的测试变得更加容易，并且还可以很好地处理有关版本之间差异的问题。

即您的 2.2.2 版 api 将只接受 2.2.2 版的对象以防止库中出现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T02:00:36.303

> 规范版本 2.2.2 包含了版本 1.0 的大部分内容，但存在一些细微差别，排除了一些继承和其他 OOP 工具。

对于 OOP，对象组合可能是比 IMO 过度使用的继承更强大的工具。

您能找到哪些方法将问题分解为更简单的子系统？

# .net - 最佳实践：在组件上覆盖 OnDispose(bool disposing) 与 Disposed 事件

> ID：456299
> 
> 赞同：5
> 
> 时间：2009-01-19T01:31:16.143
> 
> 标签：.net, components, idisposable

在 .Net 中，`Component`该类公开了一个`Disposed`事件。它还提供了一个受保护的成员`OnDispose(bool disposing)`。

扩展自定义组件的最佳实践是什么`Component`？覆盖`OnDispose(bool)`或附加事件处理程序到`Disposed`构造？

我的感觉是，一个人应该超越`OnDispose(bool)`和封印班级。

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T01:50:43.170

通常情况下，消费者会使用事件，以便在事件发生时通知他们。如果您正在扩展类型并需要清理资源，则应覆盖 Dispose(bool disposing)

Spence 关于事件处理程序部分是正确的，可以分配多个事件，但问题是您不能保证事件处理的顺序。

密封类通常取决于您的设计。

FxCop 规则也有一些很好的信息： http: [//msdn.microsoft.com/en-us/library/ms244737 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms244737(VS.80).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T01:41:58.213

我建议覆盖该行为，因为您的组件的实现者可以访问事件处理程序，因此可能会意外取消注册您的处置器实现。我相信您可能还需要根据您的自定义组件正在执行的操作来执行此操作，因为如果您有状态对象或外部接口等，您可能需要在调用基本处置器之前运行您的处置任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-11T16:36:53.633

正如我听说过的那样，它是一个 .Net 标准，继承者覆盖基类 OnXxxxx 方法，用户处理 Xxxxx 事件。

# algorithm - 如何判断两个网页是否相同？

> ID：456302
> 
> 赞同：15
> 
> 时间：2009-01-19T01:33:15.390
> 
> 标签：algorithm, diff

有哪些技术可以很好地检测一个网页是否与另一个网页相同？

同样，我不是指 char-for-char 等效项（这很容易），而是足够强大，可以忽略页面上的当前日期/时间等内容。

例如，去 Yahoo! 新闻文章加载页面，10 分钟后在另一个浏览器中打开同一页面。霸菱重写，这些页面会有一些差异（时间戳，可能是广告之类的东西，可能是相关故事之类的东西），但人类可以看着两者并说它们是相同的。

注意我不是试图修复（或依赖）URL 规范化。即，找出 foo.html 和 foo.html?bar=bang 是相同的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T02:05:51.877

听起来您正在寻求一种可靠的方法来衡量两个页面的相似性。

鉴于页面结构不会发生太大变化，我们可以将问题归结为测试页面上的文本是否大致相同。当然，通过这种方法[，nickf 提到的](https://stackoverflow.com/a/456322/30433)关于摄影师页面的问题仍然存在，但如果您主要关注的是 Yahoo！新闻之类的应该没问题。

要与页面进行比较，您可以使用机器学习中的一种称为“字符串内核”的方法。这是一篇早期[论文](http://jmlr.csail.mit.edu/papers/volume2/lodhi02a/lodhi02a.pdf)，一组关于 R 包的最新[幻灯片](http://www.logic.at/staff/feinerer/publications/talks/237_GfKl_2006.pdf)和一个[视频讲座](http://videolectures.net/eml07_sonnenburg_lsl/)。

非常粗略地，字符串内核会查找两个文档共有多少个词、词对、词组等。如果 A 和 B 是两个文档并且 k 是一个字符串内核，那么 k(A,B) 的值越高，两个文档就越相似。

如果你设置一个阈值 t 并且只说两个文档对于 k(A,B) > t 是相同的，那么你应该有一个相当好的方法来做你想做的事。当然，您必须调整阈值才能为您的应用程序获得最佳结果。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-19T20:47:03.513

对于这类问题，我发现搜索学术论文比询问 StackOverflow 好得多，在处理具体问题时，专家通常比人群聪明得多。

每个网络爬虫或搜索引擎都有这个问题并且已经解决了。可能有一种使用基于内核的方法的好方法，[就像公认的答案所建议的那样](https://stackoverflow.com/a/456342/30433)，但是您可能希望从已知效果很好的更简单的技术开始。之后您可以转到内核方法并测试它们是否可以改善您的结果。

最好的办法是阅读[Henzinger 2006 年的论文“查找几乎重复的网页：算法的大规模评估”](http://scholar.google.ca/scholar?q=finding%20near-duplicate%20web%20pages:%20a%20large-scale%20evaluation%20of%20algorithms&btnG=&hl=en&as_sdt=0,5)

[并且您可能会将生成 Rabin 指纹作为使用'Fingerprinting by random polynomials' Rabin 1986 的](http://scholar.google.ca/scholar?hl=en&q=fingerprinting+by+random+polynomials&btnG=&as_sdt=1%2C5&as_sdtp=)第一步。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-19T02:09:23.650

您可以通过使用某种相似度度量（例如[余弦相似度](http://en.wikipedia.org/wiki/Cosine_similarity)）来检测两个页面是否相同。然后您必须定义一个最小阈值，您可以使用它来接受两个文档是否相同。例如，在应用余弦度量时，我会选择一个最接近 1 的值，因为它的范围从 -1 表示完全不同，1 表示相同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T02:05:41.643

我使用 vgrep 来处理这类事情。

这是一个鲜为人知的工具，称为visual-grep，它依赖于智能眼设备和视觉皮层等先进技术，可以非常快速地确定并排页面的相同性，而且它非常准确和高效（应该是因为它已经开发了很长时间）。

标记社区维基，以防幽默警察今天出局:-)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T04:36:01.777

根据您的工作，您可能对[TemplateMaker](http://www.holovaty.com/blog/archive/2007/07/06/0128)感兴趣。你给它一些字符串（比如网页），它会标记出变化的部分。

在你的*雅虎！新闻*示例，您将获取页面一次并告诉 TemplateMaker 学习它。然后你会再次获取它并告诉它学习那个。

当您对您的 TemplateMaker 每次都知道相同的内容感到高兴时，您可以获取另一个页面并询问 TemplateMaker 它是否与其他页面的模板匹配。（如果您对此感兴趣，它将为您提供*已更改的部分。）*

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T03:18:06.910

您可以使用 Web 浏览器组件呈现两个页面的屏幕截图，然后比较图像。可能是最简单的选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T01:51:50.500

如果不深入了解您要比较的页面的结构，那么这可能会非常棘手。也就是说，一台机器应该如何判断带有几张不同图片的页面是相同的——如果它是一个带有广告的新闻网站，那么它应该是相同的，但如果它是一个摄影师的作品集，那么它肯定是不同的。

如果您确实知道页面的结构，那么我要做的就是手动选择页面的各个部分（使用 ID、CSS 选择器、XPath 等）进行比较。例如，只比较`#content`页面刷新之间的 div。从那里，您可能需要在逐个字符比较中添加容差级别。

实际上，有一项服务可以做类似的事情。它被称为[Rsspect](http://www.rsspect.com/)（由 Qwantz 名声的 Ryan North 编写），即使您不控制页面，它也会检测任何网站的更改并从中创建 RSS 提要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-19T01:53:08.407

您可以为它们中的每一个生成一个 MD5 哈希，然后进行比较。就像你说的，很简单。

您正在寻找的是一种技术，用于比较具有可以更改的任意元素的两个页面。这是一个难题。

1.  确定页面中可以更改且您不关心的区域。小心！他们总会四处走动。
2.  散列或对您关心的页面部分的 DOM 进行校验和。小心！这些也将一直在变化。

您违反了屏幕抓取的第一条规则：页面本质上是易变的。所以这是一个棘手的问题。您的解决方案永远不会足够强大，无法解决您的源数据将受到的无数种细微变化，除非您还可以直接控制源页面并且可以针对此设计您的解决方案。

祝你好运！我有过尝试解决这个问题的系统的经验，这确实是一个难以破解的难题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-19T01:53:23.760

做到这一点的方法是不比较整个页面，因为正如你所说的那样，人类也不会被欺骗。假设您对 Yahoo! 的新闻文章感兴趣 页面，所以你应该只看新闻部分。然后你可以做任何事情，新旧版本之间的哈希或文字比较。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-19T03:11:09.873

我的第一个想法是使用 BeautifulSoup (Python) 将页面处理为 XML 文档，对它们运行 diff，并计算不同的行数。如果计数 > X%，则它们是不同的。不是很健壮并且可能容易出错，但这将是我为测试所做的快速破解。

您可能想看看这个讨论比较两个 XML 文档的页面：http:
[//www.ibm.com/developerworks/xml/library/x-diff/index.html](http://www.ibm.com/developerworks/xml/library/x-diff/index.html)

可以将 html 文档强制转换为 XML 文档，然后使用此处列出的技术进行比较。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-19T03:40:23.403

我有一个类似的问题。我试图为用户提交的链接目录设计一个安全的链接系统。用户将在博客或新闻站点上发布页面并提交指向索引的链接。人类会验证链接是否合适，然后将页面添加到索引中。

问题是想出一种自动检查的方法，以确保链接随着时间的推移仍然合适。例如，是否有人在几周后修改了页面并插入了种族诽谤？新闻网站是否开始告诉人们“你必须订阅才能阅读这个故事”？

我最终提取了段落 <p> 元素并将缓存的副本与当前逐字比较。用最简单的话来说：

```
cached[] = { "Lorem", "Ipsum", "..." };
scanned[] = { "Lorem, "foo", ... }; 
```

在那之后，一系列的分类器会在处理它的同时忽略常用词“if but can or and”，同时以更重的权重对待其他词（亵渎等）。

这导致了一个评分系统几乎忽略了微小的编辑和修订（错别字、句子结构等），但会迅速揭示是否需要再次检查内容。然后返回一个分数，超过阈值的分数将被放入队列中以供人类重新验证。

这也有助于解释网站的重大外观变化。我不相信它会完全独立运行，但在人类的一点帮助下，它确实可以很好地完成它的工作。诚然，就方法论而言，该系统的效率并不高。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-19T15:07:35.933

您可以尝试使用 HTTP 标头，例如 If-Modified-Since，或其他一些与缓存相关的标头。此外，查看站点地图文件可能会有所帮助，以了解搜索引擎应该多久查看一次。

我的另一个尝试（可能结合使用）是列出页面上 s 中找到的所有`id`s 和`class`es `div`。如果这些列表不匹配，则很可能发生了相当明显的变化。否则，它们可能非常相似。

编辑：您也可以比较元素的`src`s 。`img`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-09-02T08:36:55.713

我最近遇到了这个问题并在这里研究了一个 JavaScript 解决方案： [https ://github.com/kennychua/pdiffy/](https://github.com/kennychua/pdiffy/)

它允许您比较页面的图像（最好是无损 PNG 格式），它会告诉您图像是否不同，如果不同，它将突出显示差异。

它还能够忽略您描述的时间戳问题等区域

# c++ - 如何使用 scanf 验证输入

> ID：456303
> 
> 赞同：5
> 
> 时间：2009-01-19T01:34:39.973
> 
> 标签：c++, c, scanf

如何使用 scanf 验证用户输入。现在我有这样的东西，但不起作用。

注意：我有 atoi 只是为了验证 scanf 验证是否有效。

```
scanf("%[0987654321.-]s",buf);

i = atoi(buf);

if(i)
    index = i; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-19T01:44:52.137

对于用户输入，使用`scanf()`通常是一个坏主意，因为失败会使`FILE`指针处于未知位置。那是因为`scanf`代表“扫描格式化”并且没有比用户输入更多的*未格式化。*

我建议使用`fgets()`输入一行，然后`sscanf()`在字符串上实际检查和处理它。

这还允许您检查字符串中是否有您想要的字符（通过循环或使用正则表达式），这`scanf`是函数系列并不真正适合的。

例如，`scanf()`与`"%d"`or一起使用`"%f"`将在第一个非数字字符处停止，因此不会捕获尾随错误，例如`"127hello"`，只会给您 127。而与无界一起使用它`%s`只是*乞求*缓冲区溢出。

如果你真的必须使用`[]`格式说明符（in `scanf` *or* `sscanf`），我认为它不应该被`s`.

并且，对于使用该建议的稳健输入解决方案，请参见[此处](https://stackoverflow.com/questions/4023895/how-to-read-string-entered-by-user-in-c/4023921#4023921)。一旦您将输入行作为字符串，您就`sscanf`可以满足您的需求。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-19T01:45:25.693

您似乎想验证一个字符串作为输入。这取决于您是否要验证您的字符串是否包含双精度数或整数。以下检查双精度（允许前导和尾随空格）。

```
bool is_double(char const* s) {
    int n;
    double d;
    return sscanf(s, "%lf %n", &d, &n) == 1 && !s[n];
} 
```

`sscanf`将返回转换的项目（不带 '%n'）。`n`将设置为处理的输入字符的数量。如果所有输入都已处理，s[n] 将返回终止 0 字符。两个格式说明符之间的空格是可选的尾随空格。

以下检查 int，使用相同的技术：

```
bool is_int(char const* s) {
    int n;
    int i;
    return sscanf(s, "%d %n", &i, &n) == 1 && !s[n];
} 
```

[这里](https://stackoverflow.com/questions/392981/how-can-i-convert-string-to-double-in-c)有一个问题，其中还包括更多的 C++ 方法，比如使用来自 boost 的字符串流和函数，比如 lexical_cast 等等。它们通常比 scanf 之类的函数更受欢迎，因为很容易忘记将一些 '%' 传递给 scanf 或一些地址。scanf 不会认识到这一点，而是会做任意的事情，而 lexical_cast，例如，如果任何事情都不正确，就会抛出异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T07:27:40.277

我的方法是将用户输入读入字符串，然后使用`strtol()`. `strtol()`返回指向无法处理的输入字符串中第一个字符的指针，因此通过检查此字符，您将知道是否解析了完整的字符串，如下所示：

```
char *string;
char *endptr;
long result;

scanf("%as", string);
errno = 0;
result = strtol(string, &endptr, 10);
if (ERANGE == errno)
    printf("Input number doesn't fit into long\n");
else if (*endptr)
    printf("%s is not a valid long number - it contains invalid char %c\n",
        string, *endptr);
else
    printf("Got %ld\n", result); 
```

在此代码段`scanf()`中，指示`string`使用格式修饰符“a”（这是 GNU 扩展）自动分配足够大的空间。如果您不在 GNU 上，请手动分配并限制格式`string`的最大大小。`scanf()`

这种方法允许更好的错误处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T01:43:18.583

您在第一个参数中指定的`scanf`是*转换说明符*。`scanf`将尝试将输入转换为格式，但有时您可能会惊讶于它将匹配的内容:)

您应该做的第一个检查是 scanf 的返回值（它将为您提供匹配输入的数量）。如果你没有得到你期望的数字，那么你就知道输入有问题。在你的情况下，它应该是 1。

```
if( scanf("%[0987654321.-]s", buf) == 1 )
{
      if( sanit_check( buf ) ) 
      {
      /* good input */
      }
      else
      {
      /* invalid input */
      }
}
else 
{
/* invalid input */
} 
```

除此之外，您还需要对您要求`scanf`进行的转换进行自己的健全性检查。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-19T01:38:25.817

如果您只想读取数字，请使用：

```
int i;
scanf( "%d", &i ); 
```

如果您需要进行更复杂的检查，则必须自己进行。Scanf 不会为你做这件事。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-01-19T01:43:37.053

“buf”需要是一个指针。看起来你是按价值传递的。

# c++ - 内置类型的析构函数（int、char 等）

> ID：456310
> 
> 赞同：66
> 
> 时间：2009-01-19T01:43:36.400
> 
> 标签：c++, constructor, destructor, typedef

在 C++ 中，以下代码给出了编译器错误：

```
void destruct1 (int * item)
{
  item->~int();
} 
```

这段代码几乎相同，我只是将 int 类型定义为另一种类型，然后发生了一些神奇的事情：

```
typedef int myint;

void destruct2 (myint * item)
{
  item->~myint();
} 
```

为什么第二个代码有效？一个 int 是否仅仅因为它已被类型定义而得到一个析构函数？

如果您想知道为什么有人愿意这样做：这来自重构 C++ 代码。我们正在删除标准堆并用自制池替换它。这需要我们调用placement-new 和析构函数。我知道为原始类型调用析构函数是没有用的，但是我们仍然希望在代码中使用它们，以防我们以后用真正的类替换 POD。

发现裸 int 不起作用但 typedefed 起作用是相当令人惊讶的。

顺便说一句 - 我有一个涉及模板功能的解决方案。我们只是在模板中键入定义，一切都很好。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-01-19T02:05:09.290

这就是使您的代码适用于泛型参数的原因。考虑一个容器 C：

```
template<typename T>
struct C {
    // ...
    ~C() {
        for(size_t i = 0; i<elements; i++)
            buffer[i].~T();
    }
}; 
```

为内置类型引入特殊情况会很烦人。因此 C++ 允许您执行上述操作，即使 T 恰好等于`int`. 神圣的标准在`12.4 p15`：

> 显式调用析构函数的符号可用于任何标量类型名称。允许这样做可以编写代码，而不必知道给定类型是否存在析构函数。

使用普通 int 和 typedef'ed int 之间的区别在于它们在语法上是不同的东西。规则是，在析构函数调用中，后面的东西`~`是类型名。`int`不是这样的事情，但 typedef-name 是。在 中查找`7.1.5.2`。

# mysql - Oracle 到 MySQL 的语法

> ID：456321
> 
> 赞同：0
> 
> 时间：2009-01-19T01:51:44.823
> 
> 标签：mysql, oracle, syntax

有人可以告诉我以下语句的 MySQL 等效项（在 Oracle 10g 中有效）吗？

```
INSERT INTO VOUCHER (VOUCHER_NUMBER, BOOK_ID, DENOMINATION) 
  SELECT a.a1, b.ID, b.DENOMINATION FROM (SELECT rownum a1 
                                            FROM dual 
                                      CONNECT BY rownum <= 10000000) a, BOOK b
  WHERE a.a1 BETWEEN b.START_NUMBER AND b.START_NUMBER + b.UNITS - 1; 
```

基本上，这样做是针对 table 中的每个条目`BOOK`，它正在table 中创建条目`VOUCHER`。表中的条目数由表中相应行中的`VOUCHER`数量决定。如果不清楚，我可以提供更多信息。`UNITS``BOOK`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T04:37:56.203

这里发生的主要怪事是`SELECT ROWNUM FROM DUAL CONNECT BY...`——一个让你从 BOOKS.START_NUMBER 值开始递增数字的杂物；这些似乎被用作 VOUCHER 表中的主键。

真的，这是一个糟糕的底层数据模型的症状：跟踪表中的“起始编号”和“单位”——就像数据库中的 C 数组坏了一样。

如果您花时间将其从 Oracle 移植到 MySQL，请认真考虑修复数据模型。也许你想：

*   将 book_id 列添加到 VOUCHER 表，并将后续外键添加到 BOOK 表
*   使 MySQL 中新 VOUCHER 表上的 VOUCHER_NUMBER 列成为自动增量类型，这样您就可以消除整个起始编号/单位混乱

有了这些，使用你正在使用的任何语言在 MySQL 中实现业务逻辑并实现这个伪代码：

```
for 1 to BOOK.units loop

  INSERT INTO VOUCHER (
      -- VOUCHER_NUMBER handled by auto-increment
      BOOK_ID
    , DENOMINATION
  )
  SELECT 
      b.ID
    , b.DENOMINATION
  FROM BOOK b
  WHERE b.ID = [book ID];

end loop 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T10:16:45.507

select from`DUAL`有效地为您提供了一个大的临时表来加入`BOOK`。您允许`BOOK.UNITS`值高达 10,000,000。

如果单位通常比这个低很多，那么一个选项是创建一个包含该数量记录的虚拟表并加入该表而不是`DUAL`构造。

# c++ - 静态/动态运行时链接

> ID：456323
> 
> 赞同：6
> 
> 时间：2009-01-19T01:51:53.980
> 
> 标签：c++, windows, linker

在 VC++ 中选择链接方法的最佳实践是什么？任何东西/一切都可以静态链接吗？

在动态链接的项目中，链接库的相对/绝对位置重要吗？

优缺点都有什么 ？

**补充**：我主要指的是lib文件。它们的行为与 dll 链接相同吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T01:56:56.060

动态链接允许您升级单个 DLL，而无需重新编译您的应用程序。这就是为什么可以在不重新编译应用程序的情况下升级 windows 的原因，因为动态链接器能够确定 dll 中的入口点，前提是方法名称存在。

静态链接您的应用程序的好处是对链接代码的调用不会被间接调用，因此它们运行得更快。这可能会对极其依赖性能的代码产生影响。

使用 DLL 还可以帮助您减少内存占用，因为您只在需要时加载库，完成后可以卸载它们（想想应用程序插件，仅在打开图像时加载图像浏览库等）

编辑：Robert Gamble 添加了一条我错过的评论：DLL 被加载到操作系统中所有进程共享的内存中。这意味着如果两个程序（或程序的两个实例）使用相同的 DLL，它们将使用加载到内存中的相同 DLL，这将进一步减少您的整体内存使用量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T03:32:02.797

*如果应用程序的编写方式可以*管理DLL之间的上下文切换（例如，对于较大的应用程序，您可以将应用程序功能划分为逻辑边界以在自包含的 DLL 中实现并允许加载器在运行时加载）。

虽然 DLL 确实主要安装/复制到与 .exe 相同的文件夹中，但要求是遵守加载程序加载规则（包括系统文件夹（坏主意）、PATH、当前目录 [参见 LoadLibrary API 帮助文档优先级的完整描述]）。

您“添加”了有关 LIB 文件的评论。在动态和静态中，您使用 LIB 文件进行链接。但是在动态加载的情况下，您将 .exe 与所有相关的 DLL 一起交付（LIB 文件包含相应 DLL 的导出入口点）。

我更喜欢 DLL，因为我的应用程序往往更大且分段，这允许我只交付那些更新的组件 (DLL)。我们甚至将业务逻辑与他们自己的 DLL 中的表示分开[允许独立于逻辑的纯资源 dll 的本地化。

使用 DLL 进行编程确实会导致您强迫自己遵守导出的类/方法或函数的约定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T02:32:44.723

dll 的明显优势是您可以升级单个组件而不仅仅是整个应用程序（理论上）并共享通用组件（通过将它们封装在 dll 中）。不幸的是，在实践中，dll（s）之间存在一定数量的绑定（即使定义得很好）。这导致您需要升级匹配集中的 dll 并隔离不能很好地协同工作的 dll。

如果不仔细升级 DLL 会导致被称为[DLL Hell](http://en.wikipedia.org/wiki/DLL-hell)的问题。

在现实生活中，应用程序倾向于将它们使用的所有 dll 与可执行文件放在同一目录中。这允许升级但不促进共享。然后升级包括升级应用程序目录中的 DLL 集，使其与 Windows 中央存储库中的 DLL 同步。

# svn - Version control with the least disk-space overhead

> ID：456336
> 
> 赞同：5
> 
> 时间：2009-01-19T02:01:59.170
> 
> 标签：svn, version-control

I've been considering using a version control system like SVN as a general-purpose backup and synchronisation tool between the few PCs I use. This would be for all sorts of data, including MP3s and ripped DVDs - a LOT of data (120gb+).

My main issue is that SVN creates a copy of each versioned file in the `.svn` directory. While I can see that this is very useful in most cases, it's entirely unnecessary for my purposes, and a massive waste of disk space.

Is there a VCS which doesn't create a duplicate of the files in your working copy?

*Edit to clarify:* I'm just talking about the size of the required files on each computer. For SVN, that'd mean the size of the working copy and its meta files - for a DVCS, that'd be the size of the WC and the repository.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T02:06:30.813

[Git](http://git-scm.com/) is extremely thrifty when it comes to disk space.

The [Git vs SVN Comparison Wiki](http://git.or.cz/gitwiki/GitSvnComparsion) states:

> Git's repository and working directory sizes are extremely small when compared to SVN.
> 
> For example the Mozilla repository is reported to be almost **12 GiB when stored in SVN** using the fsfs backend. The fsfs backend also requires over 240,000 files in one directory to record all 240,000 commits made over the 10 year project history. The **exact same history is stored in Git by only two files totaling just over 420 MiB. SVN requires 30x the disk space to store the same history.**
> 
> An SVN working directory always contains two copies of each file: one for the user to actually work with and another hidden in .svn/ to aid operations such as status, diff and commit. In contrast a Git working directory requires only one small index file that stores about 100 bytes of data per tracked file. On projects with a large number of files this can be a substantial difference in the disk space required per working copy.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T02:10:27.547

I think you need to ask a more specific question to get the proper answer for what you are trying to do. You don't actually want a Version Control system, but a digital asset management system.

[http://en.wikipedia.org/wiki/Digital_asset_management](http://en.wikipedia.org/wiki/Digital_asset_management)

Does that sound better?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T02:10:55.067

Version control doesn't work very well with binary files. I would recommend backing up using rsync and not worrying about the history, you're probably not going to be changing the files if you're only ripping and storing.

If you don't want to delete the stuff off the backup that you have on the source, just don't add the --delete option to rsync.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T02:06:13.310

Actually, I believe, at least for text files, SVN only stores the differences between the files, not the entire file, for each change. Also, for each revision, it only stores the changes to the files that were changed, and nothing else for files that weren't changed. Unless the actual MP3 files are constantly changing (probably not), this would be a decent system for tracking the files. However, for files like this, you'd probably be better off just using rsync to synchronize the files, and not worry about tracking their actual history.

# sql-server - What is the T-SQL To grant read and write access to tables in a database in SQL Server?

> ID：456346
> 
> 赞同：80
> 
> 时间：2009-01-19T02:07:35.510
> 
> 标签：sql-server, tsql

What is the exact SQL to assign `db_datareader` and `db_datawriter` roles to a user in SQL Server?

The user name is `MYUSER` and the database is `MYDB`.

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-01-19T02:23:26.960

In SQL Server 2012, 2014:

```
USE mydb
GO

ALTER ROLE db_datareader ADD MEMBER MYUSER
GO
ALTER ROLE db_datawriter ADD MEMBER MYUSER
GO 
```

In SQL Server 2008:

```
use mydb
go

exec sp_addrolemember db_datareader, MYUSER 
go
exec sp_addrolemember db_datawriter, MYUSER 
go 
```

To also assign the ability to execute all Stored Procedures for a Database:

```
GRANT EXECUTE TO MYUSER; 
```

To assign the ability to execute specific stored procedures:

```
GRANT EXECUTE ON dbo.sp_mystoredprocedure TO MYUSER; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-12-18T14:40:28.337

From SQLServer 2012 more elegant [alter role](http://technet.microsoft.com/en-us/library/ms189775.aspx):

```
use mydb
go

ALTER ROLE db_datareader
  ADD MEMBER MYUSER 
go
ALTER ROLE db_datawriter
  ADD MEMBER MYUSER 
go 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-04-21T09:30:11.777

It will be better to Create a New role, then grant execute, select ... etc permissions to this role and finally assign users to this role.

Create role

```
CREATE ROLE [db_SomeExecutor] 
GO 
```

Grant Permission to this role

```
GRANT EXECUTE TO db_SomeExecutor
GRANT INSERT  TO db_SomeExecutor 
```

to Add users database>security> > roles > databaseroles>Properties > Add ( bottom right ) you can search AD users and add then

OR

```
 EXEC sp_addrolemember 'db_SomeExecutor', 'domainName\UserName' 
```

Please refer this [post](https://stackoverflow.com/questions/3998634/sql-server-2008-how-do-i-grant-privileges-to-a-username)

# requirements - 为什么这么多网站讨论编程而不是描述他们试图生产的系统？

> ID：456349
> 
> 赞同：26
> 
> 时间：2009-01-19T02:10:14.880
> 
> 标签：requirements

有很多网站可以教人们如何构建更好的软件，但为什么很少有网站能够真正详细描述我们（作为程序员）应该创建的领域呢？在不同类型的系统开始出现共同需求模式之前，人们只能构建如此多的库存、会计和 ERP 系统。从逻辑上讲，如果程序员花费大量时间试图在他们的架构中创建可重用的组件，这是否意味着他们应该有一些可重用的“蓝图”来描述他们应该创建的系统？换句话说，似乎软件开发的重点过于关注“如何”

所以我的问题是：是否有任何工作将所有不同类型的系统规范分类到一个地方，都在一个站点上？如果在项目开始时缺乏适当的需求是软件开发的祸根之一，那么能够“重用”以前已经编写的相同类型系统的需求规范不是更有意义吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T02:28:22.347

有，但它们通常由想要向您出售解决方案的供应商运营。:-/;

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-19T02:54:47.457

有一个站点[Database Answers](http://databaseanswers.org/)试图为常见的数据库设计提供解决方案。这与您所描述的完整解决方案不同，但这是朝着正确方向迈出的一步。

你评论“[o]ne can only build so many [...] systems before”共性变得显而易见。然而，那些已经构建了足够多的此类系统以发现共性的人然后试图通过创建他们的通用系统版本来从中受益，然后他们将其出售。向可能做同样事情的其他人伸出援助之手不符合他们的利益（被认为是）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-19T02:48:02.230

我完全同意，“虚拟库存 IT 指南”、客户、地址和联系方式等的认可数据模型在哪里。我发现自己在许多不同的地方重新实现相同的代码，但字段略有不同和逻辑，但基本相同。几年前，我发现了一个预先准备好的数据模型网站——朝着正确方向迈出了一小步，但不是[通用数据模型](http://www.univdata.com/ "通用数据模型")的全部内容（无连接）。你会注意到他们对他们的产品没有太大的兴趣。

我还曾在一些正在开发自己的“通用”数据模型作为可销售产品的组织中工作。一个是在金融服务领域，他们获得了 1500 多个 DB2 表，然后放弃了。组织以自己的独特性而自豪，而我们（技术人员）意识到，大多数人在幕后都在做非常相似的事情——我认为这可能对企业自我造成太大的伤害，无法坦白，并承认他们和其他人一样使用 UniversalCustomer (TM) 1.7。这也使这些公司成熟了一些 SAP、Peopleware 等。

作为最后的想法 - 这里的企业家有很多低调的果实。一套体面的描述共同领域的短书。我的意思是超级简单的东西，人名、地址、电话等——所有的小缺点，比如不同文化中的标题，以及处理的电话号码布局——现在有很多人可以使用的书/wiki。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T09:06:37.923

根据我的经验，它分崩离析的是 UI 包含的用例。事实上，我已经设计并构建了一个库存系统，该系统已应用于各种组织和行业（电信、食品、医疗保健、电子制造和分销、消费品、服装、航空航天等）。上半年之后——十几个，一个很好的数据模型出现了，对所有这些模型几乎没有变化（扩展，但不是变化）。

但即使在一个行业内，由于各种原因（产品性质、数量变化、进出的平均订单大小、会计要求、员工积极性等），真人完成工作的方式差异很大，有充分的理由。

请注意，以上所有示例似乎都是关于更深层次的抽象级别 - 特别是数据模型 - 我们程序员可以按照自己的方式进行操作，这对我们有利。我们离用户越近，我们的兴趣就越需要成为次要的。

最坏的例子：有没有其他人注意到员工计划和工作时间报告系统中每个屏幕显示一周和多屏幕数据输入表单的模式？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-19T03:54:43.233

查看 Len Silverston 的数据模型资源书：

[http://www.amazon.com/Data-Model-Resource-Book-Vol/dp/0471380237/ref=pd_bbs_sr_1?ie=UTF8&s=books&qid=1232336996&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0471380237)

它从数据模型的角度接近可重用设计，而不是最终用户需求或 OO 设计。但是，我发现这非常有用——一旦你很好地掌握了数据模型，你就会对最终将被建模为类的需求和实体有了很大的了解。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T02:59:27.633

它会卖不出去。您不可避免地从任何为系统分发 RFQ 的人那里得到的第一个断言是：“我们与其他公司不同。我们的要求是独一无二的。” （而且从来都不是。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-19T03:07:23.827

如果你要重用需求，你也可以重用代码。但是在较低级别上，我认为您正在寻找的是“需求模式”，类似于“编程模式”。

现在[这里有一本](http://www.microsoft.com/learning/en/us/Books/10808.aspx)来自 Microsoft 的关于该主题的书，但与所有域模式一样，其想法是它们应该有机地发展并满足域用户和专家的需求。如果您想了解这个想法的真正来源，请查看[关于模式的开创性书籍](http://www.patternlanguage.com/leveltwo/books.htm)，尽管它来自架构而不是编程，但令人惊讶 :)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-29T12:12:37.343

早在 80 年代和 90 年代初期，就有一场巨大的“软件重用”运动。建立和调整软件组件目录的人员规模相当大。许多人认为它是软件的未来。一个很好的概述是 Will Tracz 的“二手软件推销员的自白”；谷歌术语“Brad Cox Software IC”、“Martin Griss”。我记得，胜利宣告了，每个人都转向其他问题。

我看到布拉德考克斯的“规划软件工业革命”在线： http:
[//www.virtualschool.edu/cox/pub/PSIR/](http://www.virtualschool.edu/cox/pub/PSIR/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-19T03:10:16.850

政府为尝试标准化数据模型以实现不同机构之间的共享做出了各种努力，但除了需要的地方之外，这些方法几乎没有采用。例如，在加拿大，我们有[CPSIN](http://www.dss-snd.gc.ca/publication/en/chap/chap00503.html)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-29T12:30:25.043

您可能想查看 Martin Fowler 的[企业应用程序架构模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)- 虽然不是规范，但它似乎与您所追求的东西有关。

免责声明：我自己没有读过它，我只知道它的存在。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-10-13T14:02:36.417

拥有一个包含各种语言的代码模式的中央存储库会很好。然后，我们既可以展示我们令人惊叹的代码，让彼此更容易学习，也可以通过提供 xyz 服务/产品的良好示例来提高整体代码质量。

我的意思是，我们有多少独一无二的编码项目是其他人从未做过的？

我粗略的猜测是，我们 98% 的工作都是由许多不同公司、类似行业、类似功能需求的其他人完成的。

我的意思是这是stackoverflow应该落后的那种事情。不仅要分享和讨论问题，还要学习彼此的代码。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-19T02:53:34.667

谁会创造这样的东西？谁会*使用*它？

据我所知，您说的是应用程序设计库。愿意分享这些详细设计的人们已经在这样做了——以开放规范或开源的形式。前者往往会吸引大部分已经参与创建实现此类规范的产品的人员和组织，或者与实现此类规范的系统互操作的产品。后者……好吧，既然可以破解源代码，为什么还要费心重新实现设计呢？

正如[Mark Harrison 所说](https://stackoverflow.com/questions/456349/why-are-there-so-many-sites-dedicated-to-programming-and-yet-there-are-relatively#456370)，有*很多*公司愿意推广他们的通用业务系统设计。“购买我们的系统，然后为您的组织添加必要的功能”，他们会告诉您；“为什么要浪费时间重新实现我们已经做过的事情？” 他们真的很少有动力分享详细的实施规范，因为他们真的不希望你重新实施他们试图卖给你的东西。

最后......这些事情真的没有那么复杂。或者更确切地说，它们是……但复杂性源于规模，源于任何给定组织可能对系统施加的各种神秘要求的组合。真正的工作在于解释这些需求，将它们构建到基础系统中——尽管可能很乏味，但这是不可避免的。

# c++ - C++ ifstream 失败，为什么这条线不去它应该去的地方？

> ID：456357
> 
> 赞同：0
> 
> 时间：2009-01-19T02:14:32.327
> 
> 标签：c++, ifstream

我想让标有 // THIS LINE SHOULD BE PRINTING 的行做它的事情，即打印“同义词”和“反义词”之间的 int 值。

这是文本文件：

字典.txt

```
1 cute
2 hello
3 ugly
4 easy
5 difficult
6 tired
7 beautiful
synonyms
1 7
7 1
antonyms
1 3
3 1 7
4 5
5 4
7 3

#include <iostream>
#include <fstream>
#include <string>

#include <sstream>
#include <vector>

using namespace std;

class WordInfo{

      public:

             WordInfo(){}

             ~WordInfo() {     
             }

             int id() const {return myId;}

             void readWords(istream &in)
             {
               in>>myId>>word;     
             }

             void pushSynonyms (string synline, vector <WordInfo> wordInfoVector)

             {

             stringstream synstream(synline);

             vector<int> synsAux;

             int num;

             while (synstream >> num) synsAux.push_back(num);

              for (int i=0; i<synsAux.size(); i++){
              cout<<synsAux[i]<<endl;  //THIS LINE SHOULD BE PRINTING

             }       

             }

             void pushAntonyms (string antline, vector <WordInfo> wordInfoVector)
             {

             }

             //--dictionary output function

             void printWords (ostream &out)
             {
                out<<myId<< " "<<word;     
             }

             //--equals operator for String
             bool operator == (const string &aString)const
             {
                           return word ==aString; 

             }

             //--less than operator

             bool operator <(const WordInfo &otherWordInfo) const
             { return word<otherWordInfo.word;}

             //--more than operator

             bool operator > (const WordInfo &otherWordInfo)const
             {return word>otherWordInfo.word;}

             private:
                   vector <int> mySynonyms;
                   vector <int> myAntonyms;
                   string word;
                   int myId;

      };

      //--Definition of input operator for WordInfo
      istream & operator >>(istream &in, WordInfo &word)
      {
         word.readWords(in); 

      }

      //--Definition of output operator

      ostream & operator <<(ostream &out, WordInfo &word)
      {
            word.printWords(out);  

      }

      int main() {

          string wordFile;
          cout<<"enter name of dictionary file: ";
          getline (cin,wordFile);

          ifstream inStream (wordFile.data());

          if(!inStream.is_open())
          {
          cerr<<"cannot open "<<wordFile<<endl; 
          exit(1);                      

          }

          vector <WordInfo> wordVector; 

          WordInfo aword;

          while (inStream >>aword && (!(aword=="synonyms")))
          {
              wordVector.push_back(aword);      
          }

          int i=0;          
          while (i<wordVector.size()){
                cout<<wordVector[i]<<endl;
                i++;
                }

          vector <int> intVector;
          string aLine; //suspect

          // bad statement?
          while (getline(inStream, aLine)&&(aLine!=("antonyms"))){

                aword.pushSynonyms(aLine, wordVector);

                }

          system("PAUSE");

          return 0;
      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T02:46:06.587

问题似乎在这里：

```
in>>myId>>word; 
```

On the "synonyms" line the extraction of `myId` fails and sets `failbit` on the stream, which causes the following extractions to also fail. You have to reset the error control state before extracting further elements (like the word "synonyms") from the stream:

```
in.clear(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T02:42:23.910

首先，打开编译器警告。它可能会帮助您找到一些您认为可以但实际上不是的事情。例如，具有非`void`返回类型的函数应该总是返回一些东西。如果他们不这样做，那么你的程序的行为是未定义的，未定义的行为包括“完全按照你的意愿工作，除了程序后面的一些细微差别”。如果您使用的是 g++，则警告选项是`-Wall`.

其次，请注意，不只是突出显示的行没有运行。整个*函数**永远`pushSynonyms`*不会被调用。您的课程是否涵盖了如何使用调试器？如果是这样，那么考虑使用它。如果没有，那么试着`cout`在你的程序中加入一些“”语句，这样你就可以准确地看到你的程序在出错之前能走多远。

第三，注意当流读取失败时，流的失败位被设置。在您清除它之前（[如 sth's answer 所示](https://stackoverflow.com/questions/456357/c-ifstream-failure-why-is-this-line-not-going-where-its-supposed-to#456390)），无法从该流中进行进一步提取，因此所有进一步的使用`>>`and`getline`都将失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T02:41:34.800

你做过诊断打印吗？例如，什么是`synsAux.size()`？您在`synline`开始处理之前检查过里面的内容吗？您是否检查过从输入流中收集了哪些数字？

# objective-c - 为什么 Xcode 3 会为每个实际发生的错误或警告显示多个编译器错误或警告

> ID：456361
> 
> 赞同：9
> 
> 时间：2009-01-19T02:19:08.667
> 
> 标签：objective-c, xcode, macos

当我在 Xcode 中构建时，任何错误或警告都会被复制。所以在 IDE 中，我在状态栏中的图标附近得到两倍的数字，并且在编辑器中出现黄色或红色气泡的地方，在警告（或错误）所在的行下方有两条警告线（或错误线） ） 发生了。其他人有这个问题，或者知道如何解决它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-19T02:53:53.043

你在做一个发布版本吗？如果是这样，它可能会在进行 PPC 构建时遇到错误，然后在英特尔构建时再次遇到错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T03:27:36.703

当 GCC 使用多个`-arch`标志运行时，它将为每个架构产生警告和/或错误，因为编译器本质上是多次运行。

如果您已将项目设置为包含 PPC 和 i386 二进制文件的通用应用程序，那么您将收到两个错误/警告，前提是错误/警告适用于两种架构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-11T23:28:04.060

上面的答案是正确的，但不告诉如何解决它。转到项目 -> 编辑项目设置，然后选中架构部分中的“仅构建活动架构”按钮。为什么 Apple 在默认情况下不检查调试项目的这一点超出了我的理解。

# javascript - 需要经典 asp 环境中的 onclick 语法帮助

> ID：456366
> 
> 赞同：1
> 
> 时间：2009-01-19T02:24:48.093
> 
> 标签：javascript, html, asp-classic

似乎无法正确使用语法来传递 AttID 变量。这行代码在 for 循环中，所以我必须使用 vbs response.write 打印，而不仅仅是 straignt html。

```
Response.Write "<TD class=alt><input type=button onclick=deleteRecordAtt(AttID) value=remove></TD></TR>" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T02:48:18.780

我已经 8 年多没有做过 VBScript 了，但你可能想试试：

```
Response.Write "<td class=""alt""><input type=""button"" onclick=""deleteRecordAtt(AttID) value=""remove"" /></td>" 
```

这将为您提供更可接受的 html 属性引用。

另外，您的 AttID 变量是客户端脚本变量吗？如果没有，您需要连接服务器变量内联，例如

```
...onclick=""deleteRecordAtt(" & AttID & ")""... 
```

# java - Arrays.toString(int[]) 的反向（解析输出）

> ID：456367
> 
> 赞同：18
> 
> 时间：2009-01-19T02:24:56.473
> 
> 标签：java, serialization, tostring

JDK 或 Jakarta Commons（或其他任何地方）是否有一种方法可以解析 Arrays.toString 的输出，至少对于整数数组？

```
int[] i = fromString(Arrays.toString(new int[] { 1, 2, 3} ); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-01-19T02:47:34.553

很容易自己做：

```
public class Test {
  public static void main(String args[]){
    int[] i = fromString(Arrays.toString(new int[] { 1, 2, 3} ));
  }

  private static int[] fromString(String string) {
    String[] strings = string.replace("[", "").replace("]", "").split(", ");
    int result[] = new int[strings.length];
    for (int i = 0; i < result.length; i++) {
      result[i] = Integer.parseInt(strings[i]);
    }
    return result;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-05T10:05:25.683

一个带有 fastjson 的示例，一个 JSON 库：

```
 String s = Arrays.toString(new int[] { 1, 2, 3 });
    Integer[] result = ((JSONArray) JSONArray.parse(s)).toArray(new Integer[] {}); 
```

另一个番石榴样品：

```
 String s = Arrays.toString(new int[] { 1, 2, 3 });
    Iterable<String> i = Splitter.on(",")
        .trimResults(CharMatcher.WHITESPACE.or(CharMatcher.anyOf("[]"))).split(s);
    Integer[] result = FluentIterable.from(i).transform(Ints.stringConverter())
        .toArray(Integer.class); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2011-06-16T15:01:56.230

您还可以使用 Apache Commons 的[StringUtils中的 split/join](http://commons.apache.org/lang/api-release/org/apache/commons/lang/StringUtils.html)

# opengl - 在OpenGL中访问像素的最佳方法？

> ID：456376
> 
> 赞同：7
> 
> 时间：2009-01-19T02:33:03.803
> 
> 标签：opengl

我几乎是opengl的新手。我想 glReadPixels 很可怕，那么最好的方法是什么？我正在考虑使用一个锁定纹理矩形的功能，执行 glTexSubImage2D 之类的操作将像素复制到 RAM，对其进行修改，然后使用 glTexSubImage2D 将 ram 复制回纹理中。这是一个好方法吗？我可以把优化想象成一个标志，说不要复制纹理，因为你会覆盖它并缓存。

我还可以使用哪些其他方法？你们谁能告诉我我可能想要的 gl 函数的名称（以便我可以阅读手册）或指向我的教程？我尝试用谷歌搜索，但大多数结果看起来不像我想的那样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T02:37:20.487

glReadPixels 是要走的路。

是的，它很慢——慢得可怕。但事实就是这样。DirectX 对应物（例如锁定和读取像素）也不会快多少。

通常，您希望避免读回像素并使用 CPU 处理数据。您可以使用像素着色器进行相当多的处理，但如果您想做屏幕截图（数据必须在 CPU 中结束），这对您没有帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-11-08T04:14:27.560

如前所述， glReadPixels 是要走的路。加快读取帧缓冲区或访问像素的一种方法是使用 ARB_pixel_buffer_object 扩展。这将使您可以异步执行 glReadPixels，并且当您需要读取大量像素时性能会更快。性能可以更快，因为如果您使用“正确”格式，传输是使用 DMA 完成的，不会消耗宝贵的 CPU 周期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T02:32:36.427

最好的办法是将视频卡上的帧缓冲存储器视为只写。我认为原因是视频内存针对从 CPU 端写入进行了优化，但以牺牲读取为代价。（显然显存可以从显卡端快速读取——它必须实时发送到显示器）

最快的解决方案将取决于您要做什么（要详细说明吗？）。

没有什么能阻止您将自己的帧缓冲区保存在主内存中，然后将其复制到每帧的纹理并在 OpenGL 中渲染。我以前做过这个，它比 glReadPixels 快得多，但是你失去了读取其他 OpenGL 渲染活动结果的能力。如果您需要做的就是保持场景一部分的逐帧状态，请使用它。例如：生成无法通过像素着色器完成的动态纹理。

您也可以通过读回更小的数据集而侥幸逃脱。当我在玩非现实渲染时，我这样做了。我拍摄了我的场景，将其渲染为 160x120，将其读回主内存，然后将其重新渲染为 2D 精灵的集合。

# ruby - 加载 ruby 文件时显示其完整路径名

> ID：456379
> 
> 赞同：11
> 
> 时间：2009-01-19T02:35:27.543
> 
> 标签：ruby

在阅读源码的时候，我总是想知道文件加载时的完整路径，ruby中有没有回调方法可以做到这一点，或者有没有其他方法可以做到这一点？提前致谢。

**编辑**评论中的澄清：

我想知道执行此行时加载的“somefile”的位置：“load somefile”

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-07-05T21:43:55.173

# 在 Ruby 中显示文件的路径名

简单如何（来自[Camping](https://camping.github.io/camping.io/)中的快速测试）：

```
File.expand_path(File.dirname(__FILE__)) 
```

?

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-19T02:57:53.050

我能想到的最好方法是修补`Kernel`模块。根据[文档](http://www.ruby-doc.org/core/classes/Kernel.html#M005966) `Kernel::load`搜索`$:`文件名。如果我们找到它，我们可以做同样的事情并打印路径。

```
module Kernel
  def load_and_print(string)
    $:.each do |p|
      if File.exists? File.join(p, string)
        puts File.join(p, string)
        break
      end
    end
    load_original(string)
  end

  alias_method :load_original, :load
  alias_method :load, :load_and_print

end 
```

我们`alias_method`用来存储原始`load`方法，我们在我们的末尾调用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-05-29T04:38:28.003

Gordon Wilson 的回答很棒，只是想补充一点，您还可以通过查看变量 $" 的输出来查看加载了*哪些*库（以及它们的完整路径！）（返回一个绝对文件名数组）

例如，最近加载的库的路径位于数组的末尾

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T10:32:55.020

我很好奇你为什么使用`load`而不是`require`- 在我所有的时间使用 Ruby。我从来没有机会使用`load`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-16T20:38:45.847

要获取文件的完整路径，您必须按以下方式组装一个字符串（其中*yourfileobject*是 Ruby 的 File 类的对象）。

```
File.expand_path(File.dirname(yourfileobject)) + "/" + yourfileobject.path 
```

# c# - Determining scope of a MemberExpressions target

> ID：456383
> 
> 赞同：2
> 
> 时间：2009-01-19T02:37:33.640
> 
> 标签：c#, .net, linq, expression-trees, custom-linq-providers

Is there anyone here with experience writing custom Linq providers?

What I'm trying to do is tell whether a MemberExpression that is a property on a business object should be included in the SQL, or treated as a constant, because its from a local variable that just happens to be a business object.

So for example, if you have this:

```
Customer c = LoadCustomerFromDatabase();

var orders = from o in db.Orders() where o.CustomerID == c.CustomerID select o; 
```

At the moment, my query translator will try to execute `SELECT * FROM orders o where o.CustomerID = c.CustomerID`, which of course doesn't work.

What I would like to do is examine the MemberExpression on the `c.CustomerID` and try to work out if its a local variable, or just something that is being used as part of the Linq expression.

I have managed to do it as a 2nd pass over the query, looking for fields that SQL Server won't be able to bind, and injecting their values instead, but if possible I'd like to get it all happening at the same time. I tried looking at the expression `Type` property, and `IsAutoClass`, but that was just a guess because it contained the word Auto. And it didn't work :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T10:06:34.433

在 Where 表达式中，您正在查看`Expression<Func<T,bool>>`- 这意味着最外层的 lambda 应该有一个`ParameterExpression`带有 type的单个`T`。

如果比较与该行有关，它将具有（作为祖先） this `ParameterExpression`; 如果它是局部变量，它将具有（作为祖先）a `ConstantExpression`- 但是，此常量表达式的类型将由编译器生成，以处理表达式中使用的所有捕获变量。

像这样：

```
using System;
using System.Linq.Expressions;
class Foo
{
    public string Name { get; set; }
    static void Main()
    {
        var exp = (LambdaExpression) GetExpression();
        WalkTree(0, exp.Body, exp.Parameters[0]);

    }
    static void WriteLine(int offset, string message)
    {
        Console.WriteLine(new string('>',offset) + message);
    }
    static void WalkTree(int offset, Expression current,
        ParameterExpression param)
    {
        WriteLine(offset, "Node: " + current.NodeType.ToString());
        switch (current.NodeType)
        {
            case ExpressionType.Constant:
                WriteLine(offset, "Constant (non-db)"
                    + current.Type.FullName);
                break;
            case ExpressionType.Parameter:
                if (!ReferenceEquals(param, current))
                {
                    throw new InvalidOperationException(
                        "Unexpected parameter: " + param.Name);
                }
                WriteLine(offset, "db row: " + param.Name);
                break;
            case ExpressionType.Equal:
                BinaryExpression be = (BinaryExpression)current;
                WriteLine(offset, "Left:");
                WalkTree(offset + 1, be.Left, param);
                WriteLine(offset, "Right:");
                WalkTree(offset + 1, be.Right, param);
                break;
            case ExpressionType.MemberAccess:
                MemberExpression me = (MemberExpression)current;
                WriteLine(offset, "Member: " + me.Member.Name);
                WalkTree(offset + 1, me.Expression, param);
                break;
            default:
                throw new NotSupportedException(
                    current.NodeType.ToString());
        }
    }

    static Expression<Func<Foo, bool>> GetExpression()
    {
        Foo foo = new Foo { Name = "abc" };

        return row => row.Name == foo.Name;
    }    
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T02:47:44.023

Well, I don't know if you can cut it down to one pass, but you can get information on the member, and if it coincides with another variable you have declared as being part of the query (in this case "o"), you use it to generate your query.

Otherwise, you would assume it is a constant, and then plug that value in.

Unfortunately, because you can have from statements (in addition to the let statement) in multiple places in the query, it doesn't seem like you can do it in just one pass, since you need to know all of the query variables up front.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T04:03:21.703

好的，经过一些快速的统计分析（即手动比较各个属性），DeclaringType、ReflectedType 和 Namespace 是 Lambda 参数不在范围内时触发的。

因此，除非有人提出更好的答案，否则我可能只需要继续下去。

# java - Make application run in its own directory

> ID：456388
> 
> 赞同：1
> 
> 时间：2009-01-19T02:44:45.683
> 
> 标签：java, runtime, exec

I'm trying to get an application (a game) to start with a Java script. There is a long explanation behind why, so I'll skip that part.

The game won't run unless it is executed from its own directory, IE: Just telling Java to launch the EXE gives errors within the game. It must be launched from its directory.

I've Googled for hours over this and can't seem to find any real answers. After a lot of Googleing, I've learned this should be right:

```
String workingDir = "F:\\Games\\COD4\\";
String cmd = "iw3mp.exe";           

Runtime.getRuntime().exec(cmd,null,new File(workingDir)); 
```

However, I get this error:

```
Exception in thread "main" java.io.IOException: Cannot run program "iw3mp.exe" (in directory "F:\Games\COD4"): CreateProcess error=2, The system cannot find the file specified
at java.lang.ProcessBuilder.start(Unknown Source)
at java.lang.Runtime.exec(Unknown Source)
at java.lang.Runtime.exec(Unknown Source)
at cod4launcher.main(cod4launcher.java:29)
Caused by: java.io.IOException: CreateProcess error=2, The system cannot find the file specified
at java.lang.ProcessImpl.create(Native Method)
at java.lang.ProcessImpl.<init>(Unknown Source)
at java.lang.ProcessImpl.start(Unknown Source)
... 4 more 
```

Please help! Thanks.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T03:27:56.640

Try this instead:

```
String workingDir = "F:\\Games\\COD4\\";
String cmd = workingDir + "iw3mp.exe";
Runtime.getRuntime().exec(cmd,null,new File(workingDir)); 
```

iw3mp.exe probably isn't on your system path so you have to give Java an absolute path to the executable.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-15T15:33:16.740

利用[`java.lang.ProcessBuilder#directory(java.io.File)`](http://download.oracle.com/javase/6/docs/api/java/lang/ProcessBuilder.html#directory%28java.io.File%29)

```
Processs p = 
    new ProcessBuilder(cmd).
        directory(new File(workingDir)).
        start(); 
```

# xcode - git可以与Xcode集成吗？

> ID：456403
> 
> 赞同：121
> 
> 时间：2009-01-19T02:52:26.137
> 
> 标签：xcode, git, version-control, integration

有没有办法使用带有 Xcode 内置 SCM 功能的 git 存储库？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2010-06-17T19:47:51.977

Xcode 4 原生支持 git（开发者工具在 WWDC 2010 上发表的国情咨文地址）

在此处了解更多信息：[Xcode 4 中的新功能](http://developer.apple.com/technologies/tools/whats-new.html#version-editor)Apple
的[文档很长，但值得阅读。](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/xcode_guide-continuous_integration/PublishYourCodetoaSourceRepository/PublishYourCodetoaSourceRepository.html)

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2009-01-19T03:08:43.013

***注意：****尽管有所有的赞成票，但截至 2010 年 6 月，此答案已过时*

* * *

Xcode 中没有 git 支持，但这没有理由*不在*您的 Xcode 项目中使用 git。我使用标准 git 命令行或[GitX](http://wiki.github.com/pieter/gitx)管理我的 Xcode 项目取得了很好的效果。

Shane Vitarana 有一组不错的`.gitignore` [设置](http://shanesbrain.net/2008/7/9/using-xcode-with-git)可用作起点。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-06-03T13:06:57.450

将 git 与 Xcode “集成”的一个好方法是使用[DTerm](http://www.decimus.net/dterm.php)。您使用组合键在浮动窗口中调出 DTerm。DTerm 知道编辑器中当前文档的完整路径。

例如，在您正在编辑的文件上运行差异：

1) 按 Ctrl-Return 调出 DTerm 窗口。（此组合键是可配置的）。

2) 输入“git diff cmd-shift-V”。当您开始键入并在窗口中插入当前文件的名称时，这将覆盖最后一个命令。由于您的工作目录设置为所选文件的父目录，因此该命令非常简洁。

我和Decimus一点关系都没有。我只是一个满意的用户，通过 DTerm 运行了数千条命令。

**编辑**：截至 2009 年 8 月 27 日，DTerm 是免费的。如果您购买了 DTerm 副本，则无论您何时购买 DTerm，都可以免费升级到下一个版本。查看他们的[博客文章](http://www.decimus.net/support.php?path=DTerm/dterm-free)

**编辑 2**：[DTerm](http://itunes.apple.com/us/app/dterm/id415520058?mt=12)现在在 Mac App Store 上可用。看看他们是否遵守了他们在[博客文章中做出的承诺将会很有趣。](http://www.decimus.net/support.php?path=DTerm/dterm-free)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-01-27T17:10:14.580

除了上面帖子中引用的 .gitignore 设置之外，我还将生成的文件添加到我的配置文件中。

build/
*.pyc
*~.nib/
*.pbxuser
*.perspective
*.perspectivev3
*.xcworkspace/
xcuserdata/

这有助于将噪音排除在我的仓库之外。

如果我需要添加生成的文件，我会添加一个 Release 文件夹并将 *.framework 和 *.app 文件夹保存到我的项目目录中。我将发布到测试组的任何内容添加到 Release 文件夹并标记它。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-01-19T04:58:47.083

不，没有，老实说，我很感激，因为 Xcode 中的 SVN 支持对我来说似乎真的很不稳定。在我为我的个人项目迁移到 Git 之后，我只打开了一个终端窗口，我可以根据需要启动`git add`它`git commit`。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-20T10:29:57.430

Xcode 没有公开的插件 API，所以不，没有办法直接向 Xcode 添加对 git 的支持。

但是，您可以为 Xcode 的脚本菜单创建脚本，以执行各种 git 操作。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-19T03:22:12.550

好吧，有一个叫做 git-cvsserver 的东西可以让 git 假装它是 CVS。但我不知道这方面的情况，或者 Xcode 中的 CVS 支持。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-19T03:42:47.860

我不相信有办法为 Xcode 提供插件支持。因此，在 Apple 热身到 git 之前，我们将被第 3 方工具和命令行所困。并不是说那是一件坏事……

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-07-22T23:24:57.233

最新的 Xcode 4 beta 集成了 git，但是，它默认不安装它，也不使用您当前安装的 git。

我必须做的是在 Xcode 安装程序中安装“系统工具”选项。（默认跳过）之后，主办方认识到我的项目已经在git控制下，并且顺利集成。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-07-27T22:10:17.907

使用 Xcode 4，如果您想使用自己的 Git 版本，您可以创建从 /usr/bin/git 到安装 Git 二进制文件的任何位置的符号链接

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-08-31T05:56:08.473

使用最新的 Xcode 4.1 这绝对是可能的，并且您需要的一切都默认安装。

我写了一篇关于这个主题的博客文章：

[Xcode iPhone 初学者项目与 GitHub 集成](http://www.leniel.net/2011/08/xcode-iphone-beginner-projects-git.html)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-05-16T02:11:31.527

您可以将 Xcode 与 Git 存储库一起使用。[Visual Studio Team Services](https://www.visualstudio.com/products/visual-studio-team-services-vs)在云中提供[免费、私有和无限制的 Git 存储库。](https://www.visualstudio.com/features/version-control-vs)您不仅可以使用 Xcode，还可以使用 Eclipse、Visual Studio、Team Services 自己的 Web 浏览器界面或您喜欢的任何其他编辑器/IDE。也可以免费与前 5 位用户共享代码。

YouTube 视频：[https ://youtu.be/S83kn0i4WYs](https://youtu.be/S83kn0i4WYs)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-02-11T09:24:10.430

我想知道，是否可以使用 Xcode 脚本功能完成包装器？检查：[http ://www.cimgf.com/category/version-control/git/](http://www.cimgf.com/category/version-control/git/)

顺便说一句，如果 Xcode 不能完成这项工作，eclipse 可以完成这项工作，但它可能缺少 Cocoa api 等......

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-05-04T22:58:18.520

无论如何，我使用外部编辑器。其中许多支持 git 命令。这样，git就“集成”到了Xcode中

# java - VS2008+ReSharper 与 IntelliJ IDEA 相比如何？

> ID：456409
> 
> 赞同：13
> 
> 时间：2009-01-19T02:55:07.940
> 
> 标签：java, ide, resharper, intellij-idea

我曾经是一名 Java 用户，但 4 年前我开始使用 100% .NET。习惯了 ReSharper 及其提供的所有命令后，它与 IntelliJ 相比如何？两者都来自 JetBrains，我想它们很接近 - 但我没有使用它。（我知道我可以这样做并回答自己，但是 YMMV。）

谢谢;

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-19T19:56:25.210

我曾经与idea和vs+resharper并肩工作。我发现它们足够接近，以至于我在某些时候认为语法着色是最大的区别。我不确定这是否*真的*正确，但当时确实有这种感觉。

当时我正在用 C# 编写一个 Web 前端，用 Java 编写一个后端，我相当肯定我为每项工作都使用了合适的工具。请记住，IntelliJ Idea 是一个相当以代码为中心的 IDE，而 Visual Studio 是一个非常可视化的 IDE。直接比较它们中的任何一个都不完全公平。

Visual Studio（以及用于 java 的 Netbeans）试图通过向导和设计器来尽可能地帮助您，这些向导和设计器有时会从您的视图中隐藏代码（Visual Studio 与设计器一起做得很好，他们甚至在语言中添加了部分类让它变得更好）。Idea 试图给你最大的冲击力，但使用代码而不是创建太多的“视觉抽象”。相反，它在光标处为您提供了非常好的帮助，并且感觉更像是我的手/脑运动的延伸，而不是 Visual Studio。我想这一定是音乐会钢琴家的感受。我在这里过头了吗？

当谈到 resharper 向 Visual Studio 引入的东西时，我认为代码分析和重构选项是完全相同的。我也认为 resharper 用户会在想法上感到非常自在。作为一个 Idea 用户，我在 Visual Studio 中感觉很赤裸，没有重新锐化 :)

# version-control - Drupal and versioning

> ID：456414
> 
> 赞同：5
> 
> 时间：2009-01-19T03:00:35.870
> 
> 标签：version-control, drupal

I looked for similar questions to mine and one seemed promising, but the accepted anser was not applicable to me (I think.)

[Drupal Source Control Strategy?](https://stackoverflow.com/questions/282858/drupal-source-control-strategy)

Basically one has to have rights on the server you are deploying to. That is not my situation. I use a hosting service and I do not think I can install SVN on it.

So, do i just develop on a "dummy" site and somehow do a lots of juggling by testing ont eh dummy site, getting the content (Including the database) and putting that in SVN and then releasing it to my live site?

What does the Drupal database look like? My dummy and live sites wo not/will not have the same admin/user logins, etc.

What are others doing for developing in Drupal and managing revisions?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T16:49:26.400

相当多的托管服务——甚至是便宜的共享主机——都安装了 SVN 或 CVS 客户端。这与 SVN 托管不同，SVN*托管*是一些托管公司明确提供的服务。值得检查；无论如何，拥有一个源代码控制客户端将使您的生活更轻松。

我们的启动工作流程往往是这样的：

*   设置代码库
*   放入 SVN/git/whatever 开发、编码、创建内容、配置等
*   定期制作数据库快照以保持理智
*   删除在开发期间创建的任何虚拟内容或虚拟用户帐户
*   将代码推送到生产或测试盒
    *   如果您的主机上有源代码控制客户端，请使用它来部署代码库。
    *   如果您不这样做，请使用您选择的源代码控制系统提供的任何机制来创建代码库的显式分支或标记版本。
    *   不要更改实时服务器上的代码。始终使用源代码控制更新，或上传“祝福”分支/标签的完整副本。使实时站点的代码与自身不同步是地狱。
*   如果您需要在线推送新快照，要么在 webroot 之外有一个单独的 /db 目录，该目录也受源代码控制，要么只使用 SFT 并临时上传数据库快照。显然，您不想将它们保存在可通过 Web 访问的目录中，因为下载原始数据库快照的人会加倍不利。

大约一个月前，我做了一个关于部署内容的演示，并将幻灯片发布到网上；它可能有用。[幻灯片分享链接](http://www.slideshare.net/eaton/drupal-deployment-presentation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-15T18:15:31.350

使用 Drupal 进行版本控制有两个方面。

**1/ 结构**

**GIT**是我选择的武器，它在 Drupal 社区中被广泛采用，实际上也在外部，而且非常灵活。

使用 Drupal，您需要一些基本工具。

*   **Features**，一个模块将帮助您对通常驻留在数据库中的一些站点结构进行编码。视图、内容类型、分类词汇，甚至分类术语，如果您使用 UUID 和 UUID 功能模块等...

*   **Drush**不仅可以帮助您创建和更新您的功能，而且它是构建 Drupal 站点时必不可少的工具。除非您对命令行过敏，否则使用 Drush 管理功能比使用功能的 UI 更加灵活和强大。

**2/ 内容**

这个更简单，只要你没有大量的内容，你可以使用**备份和迁移**模块。

一些 Drupal 友好的托管服务会为您提供预装的 GIT，如果您真的无法访问服务器，GIT 仍然是一个出色的开发工具。

抱歉，我没有提供任何链接，这里有点晚了，但是这些工具很容易找到，我相信你不会有任何问题！

# pdf - 从pdf文件中提取照片

> ID：456415
> 
> 赞同：0
> 
> 时间：2009-01-19T03:02:12.153
> 
> 标签：pdf, automation, adobe

有谁知道我可以从pdf文件中提取所有jpg图像的方法？我目前正在使用 Acrobat，并且我有一个包含大约 1500 张照片的文件，我需要提取这些照片，但一次提取一张会非常耗时。有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T03:08:58.847

只是做了一点搜索，我发现了这个，我希望它有帮助......我想不出任何理由在 pdf 中有 1500 张图像。

[http://pdf-image-extraction-wizard.lastdownload.com/](http://pdf-image-extraction-wizard.lastdownload.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T03:09:17.037

有免费的实用程序可以帮助您做到这一点。例如，一个快速的谷歌搜索出现了[这个](http://somepdf.com/some-pdf-image-extract.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-23T16:13:34.473

在 Mac 上尝试应用[FileJuicer](https://echoone.com/filejuicer/) - 这通常非常适合从 PDF 中提取图像

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-22T17:07:48.997

编码答案（需要 tesseract（免费软件））。我不确定我实际为那段代码使用了哪些包，一些包用于同一代码块中的其他功能。

```
from PIL import Image
import pytesseract
import cv2
import os
import subprocess

#Strip images and put them in the relevant directory
def image_exporter(pdf_path, output_dir):
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)

    cmd = ['pdfimages', '-all', pdf_path,
           '{}/prefix'.format(output_dir)]
    subprocess.call(cmd)
    print('Images extracted:')
    print(os.listdir(output_dir)) 
```

# drupal - 初学者 Drupal 问题 - 在 /drupal 上安装时如何获取内容到 root

> ID：456417
> 
> 赞同：1
> 
> 时间：2009-01-19T03:06:01.867
> 
> 标签：drupal

必须有一个答案，但我是一个完全的网络开发新手。我的托管站点在 <site domain>/Drupal 上安装了 Drupal。

一切都很好，但我如何发布网站，这样我就不必去`domain.com/drupal`？

我只想`domain.com`工作。

我必须将内容复制到我的 www 的根目录吗？显然我完全无能为力。

编辑

注意 - 我还希望浏览器窗口中的 URL 删除 drupal 路径。所以只重定向到子目录是不可取的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T03:28:30.773

您可以配置网络服务器为您执行此操作。

这是一个简单的 Apache2 主机配置示例。（这是来自 Ubuntu，但应该与其他安装类似）

```
<VirtualHost *> 
        ServerName example.com 
        ServerAlias example.com *.example.com 
        DocumentRoot /var/www/drupal 
        <Directory /var/www/drupal> 
                Include /etc/apache2/drupal-clean-url.conf 

                Allow from all 
                Options +Includes +Indexes +FollowSymLinks 
                AllowOverride None 
        </Directory> 
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T06:49:48.183

除其他可能性外，听起来您可能托管在 DreamHost.com 或具有类似设置的 ISP 上。我在 Dreamhost.com 上托管，并且在开始时遇到了类似的问题。

如果这适用于您，您需要弄乱您的域设置。我不想在这里解释它，而是将您推荐给 ISP 的技术支持。他们可能对此有一个简单的答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T03:16:57.273

您可以配置网络服务器使 /Drupal 成为根节点，具体如何执行取决于您的网络服务器，但应该相当简单。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T22:31:31.433

感谢大家的回应。

这是drupal网站内容：

[http://drupal.org/node/135206](http://drupal.org/node/135206)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T14:44:54.247

你可以试试这个。

只需将drupal 子目录中的所有文件和目录复制到上面的那个。即与drupal 文件夹处于同一级别。Drupal 本身并不关心它在哪里。将流量驱动到 Drupal 中正确位置的是 .htaccess 文件。

此外，请确保您尝试在 Drupal 中使用干净的 url，以获得 SEO 友好的 url，而无需 q=admin 等查看 pathauto 和 token 模块以帮助解决此问题，它们将为您提供诸如 mysite.com/How_to_run_Drupal 之类的 url，以获得如何做的标题运行 Drupal。

# sql-server - 计算列的全文搜索

> ID：456422
> 
> 赞同：2
> 
> 时间：2009-01-19T03:09:01.673
> 
> 标签：sql-server, sql-server-2008, full-text-search

我需要允许对连接在一起的两个字段进行全文搜索。在这种情况下，FullName = FirstName + ' ' + LastName。简单的方法似乎是创建一个 FullName 计算列，然后将其作为一列包含在全文索引中。这是一种可接受的方法吗？你会怎么做？

UPDATE 和 INSERT 很少发生，相比之下，使用 CONTAINS 的 SELECT 很常见。我正在使用 SQL 2008。

示例表定义，其中 FirstName、LastName、NickName 和 FullName 是全文搜索中使用的列：

```
TABLE Player
    Id uniqueidentifier ROWGUIDCOL NOT NULL DEFAULT (newid()),
    ...
    FirstName nvarchar(128),
    LastName nvarchar(128),
    NickName nvarchar(128),
    FullName  AS ([FirstName]+' '+[LastName]) PERSISTED 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T03:20:59.307

您可以将全文索引添加到视图。

创建一个包含连接的两列的视图。确保使用“模式绑定”创建它：

使用 SCHEMABINDING 等创建视图 [dbo].[v_MyView]。

如果您使用的是 Management Studio，那么其余的过程应该很简单。

# sql - 是否可以从我的 MySQL 数据库的一个表中的一行中获取一个值并插入到同一数据库中的另一个表中？

> ID：456427
> 
> 赞同：3
> 
> 时间：2009-01-19T03:14:31.427
> 
> 标签：sql, mysql

假设我有一张`products`包含产品列表的表格，其中一个字段是`price`. 该表也有一个`id`字段。当有人购买时，我在另一个名为`purchases`. 此表还有一个名为的字段`price`和一个`productid`映射到 products 表字段的`id`字段。我想知道是否可以在一个 SQL 查询中从产品表中获取价格并将其插入到购买表中。

这在 MySQL 中可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-19T03:22:26.200

当然。在我的正常实践中，我只是将价格作为插入的一部分发送，但如果您确实需要在此时从产品表中提取它，您可以使用子选择来完成，例如：

```
INSERT INTO `purchase`
SET `product_id` = $whatever,
`price` = (
    SELECT `price`
    FROM `product`
    WHERE `id` = $whatever
) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-19T03:22:20.117

```
INSERT INTO purchases (
    price
    ,productid
    ,add your other columns here
)
SELECT price
    ,id
    ,add your other columns here
FROM products
WHERE add your selection criteria here 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-19T03:20:05.377

可能的：

```
insert into purchases(purchase_id, product_id, price) 
select 88, product_id, current_price from product 
where product_id = 'KEYB' 
```

包括当前折扣：

```
insert into purchases(purchase_id, product_id, price, discount) 
select 88, product_id, current_price, current_discount from product 
where product_id = 'KEYB' 
```

# c# - 什么时候应该使用 IEnumerator 在 c# 中循环？

> ID：456433
> 
> 赞同：24
> 
> 时间：2009-01-19T03:19:00.513
> 
> 标签：c#, iterator, ienumerable, loops

我想知道是否有任何时候在 foreach 循环上使用 IEnumerator 来遍历集合是有利的？例如，是否有任何时候使用以下代码示例中的任何一个比另一个更好？

```
IEnumerator<MyClass> classesEnum = myClasses.GetEnumerator();
while(classesEnum.MoveNext())
    Console.WriteLine(classesEnum.Current); 
```

代替

```
foreach (var class in myClasses)
    Console.WriteLine(class); 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-19T05:07:43.197

首先，请注意，您的示例（介于`foreach`和之间`GetEnumerator`）的一个很大区别是，如果迭代器是 ，则`foreach`保证调用`Dispose()`迭代器`IDisposable`。这对于许多迭代器很重要（例如，它们可能正在使用外部数据馈送）。

实际上，有些情况并`foreach`没有我们想要的那么有用。

首先，这里讨论了“第一项”情况[（foreach / detection first iteration）](https://stackoverflow.com/questions/420774/foreach-with-generic-list-detecting-first-iteration-when-using-value-type#420786)。

还有一点; 如果您尝试编写将`Zip`两个可枚举序列拼接在一起的缺失方法（或`SequenceEqual`方法），您会发现您可以`foreach`在两个序列上使用，因为这将执行交叉连接。您需要直接将迭代器用于其中之一：

```
static IEnumerable<T> Zip<T>(this IEnumerable<T> left,
    IEnumerable<T> right)
{
    using (var iter = right.GetEnumerator())
    {
        // consume everything in the first sequence
        foreach (var item in left)
        {
            yield return item;

            // and add an item from the second sequnce each time (if we can)
            if (iter.MoveNext())
            {
                yield return iter.Current;
            }
        }
        // any remaining items in the second sequence
        while (iter.MoveNext())
        {
            yield return iter.Current;
        }                
    }            
}

static bool SequenceEqual<T>(this IEnumerable<T> left,
    IEnumerable<T> right)
{
    var comparer = EqualityComparer<T>.Default;

    using (var iter = right.GetEnumerator())
    {
        foreach (var item in left)
        {
            if (!iter.MoveNext()) return false; // first is longer
            if (!comparer.Equals(item, iter.Current))
                return false; // item different
        }
        if (iter.MoveNext()) return false; // second is longer
    }
    return true; // same length, all equal            
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-19T04:01:22.907

根据[C# 语言规范](http://msdn.microsoft.com/en-us/vcsharp/aa336809.aspx)：

> 形式的 foreach 语句

```
foreach (V v in x) embedded-statement 
```

> 然后扩展为：

```
{
    E e = ((C)(x)).GetEnumerator();
    try {
            V v;
            while (e.MoveNext()) {
                    v = (V)(T)e.Current;
                    embedded-statement
            }
    }
    finally {
            ... // Dispose e
    }
} 
```

你的两个例子的本质是一样的，但是有一些重要的区别，最明显的是`try`/ `finally`。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-19T03:20:53.833

在 C# 中，所做的事情与您在上面发布的代码`foreach`完全相同。`IEnumerator`提供该`foreach`构造是为了使程序员更容易。我相信在这两种情况下生成的 IL 是相同/相似的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-19T04:42:35.617

我有时会在第一次迭代做一些与其他人不同的事情时使用它。

例如，如果要将成员打印到控制台并按行分隔结果，则可以编写。

```
using (IEnumerator<MyClass> classesEnum = myClasses.GetEnumerator()) {
    if (classEnum.MoveNext())
        Console.WriteLine(classesEnum.Current);
    while (classesEnum.MoveNext()) {
        Console.WriteLine("-----------------");
        Console.WriteLine(classesEnum.Current);
    }
} 
```

然后结果是

```
myClass 1
-----------------
myClass 2
-----------------
myClass 3 
```

另一种情况是当我一起迭代 2 个枚举器时。

```
using (IEnumerator<MyClass> classesEnum = myClasses.GetEnumerator()) {
    using (IEnumerator<MyClass> classesEnum2 = myClasses2.GetEnumerator()) {
        while (classesEnum.MoveNext() && classEnum2.MoveNext())
            Console.WriteLine("{0}, {1}", classesEnum.Current, classesEnum2.Current);
    }
} 
```

结果

```
myClass 1, myClass A
myClass 2, myClass B
myClass 3, myClass C 
```

使用枚举器可以让您在迭代中更加灵活。但在大多数情况下，您可以使用 foreach

# c# - c# codegen 最佳实践的资源

> ID：456434
> 
> 赞同：0
> 
> 时间：2009-01-19T03:19:44.507
> 
> 标签：c#, code-generation

我正在寻找有关 c# codegen 最佳实践的一个或多个资源（在运行时通过代码编写 c#）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T03:29:33.143

实际上，我不久前写[了一篇](http://blog.pnbconsulting.com.au/?p=120)关于此的文章。

# cocoa - 如何以不同的颜色显示旋转的 NSProgressIndicator？

> ID：456445
> 
> 赞同：26
> 
> 时间：2009-01-19T03:25:31.623
> 
> 标签：cocoa

我在我的可可应用程序中使用“微调器”NSProgressIndicator：

[![微调器图像](https://i.stack.imgur.com/NTzoW.png)](https://i.stack.imgur.com/NTzoW.png)

我想以不同的颜色显示它，以便在深色背景上很好地显示：

[![倒转旋转图像](https://i.stack.imgur.com/eytEK.png)](https://i.stack.imgur.com/eytEK.png)

我该怎么做呢？我最后的手段是编写我自己的自定义 NSView 子类来呈现自定义动画，但我什至不知道从哪里开始。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-04-07T13:37:59.547

这就是我所做的：

```
 #import <QuartzCore/QuartzCore.h>

    ...

    CIFilter *lighten = [CIFilter filterWithName:@"CIColorControls"];
    [lighten setDefaults];
    [lighten setValue:@1 forKey:@"inputBrightness"];
    [self.indicator setContentFilters:[NSArray arrayWithObjects:lighten, nil]]; 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-16T07:13:39.640

我实际上已经实现了可能适合您需求的旋转 NSProgressIndicator 的克隆。它们可以以任何尺寸和任何颜色绘制。一个是 NSView 的子类，可以在 OS X 10.4 上使用，另一个是 CALayer 的子类，可以在基于 CoreAnimation 的项目中使用。代码在 github 上（[基于 NSView 的](https://github.com/kelan/yrk-spinning-progress-indicator)版本和[基于 CoreAnimation 的](https://github.com/kelan/yrk-spinning-progress-indicator-layer)版本），在我的博客上有一个[带有一些截图的帖子。](http://yeahrightkeller.com/2009/yrkspinningprogressindicators/)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-22T14:59:38.100

不确定这是否可以与 NSProgressIndicator 一起正常工作，但您可以尝试使用 Core Image 过滤器来反转进度指示器视图的显示。您必须支持视图层，然后将 a 添加`CIFilter`到其层的过滤器中。您可以在 Interface Builder 的效果检查器中完成所有这些操作，否则您也可以在代码中完成。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-06-27T19:45:01.447

虽然我确信 Kelan 的代码前一阵子可以工作，但很难更新。我最终选择了[ITProgressIndicator](https://github.com/iluuu1994/ITProgressIndicator)，使用 Xcode 6 (Beta 1) 和 Yosemite (Beta 2) 大约需要 2 分钟。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-09-04T11:07:26.947

对于更细粒度的解决方案，您可以使用使用以下类别的多项式颜色方法。请注意，为简单起见，我仅使用向量的 x 分量。如需更准确的颜色匹配，请参阅参考：[https ://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CIColorMatrix](https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CoreImageFilterReference/index.html#//apple_ref/doc/filter/ci/CIColorMatrix)

```
@import QuartzCore;
#import <Cocoa/Cocoa.h>

@interface NSProgressIndicator (Colors)

- (void)setCustomColor:(NSColor *)aColor;

@end

@implementation NSProgressIndicator (Colors)

- (void)setCustomColor:(NSColor *)aColor {
    CIFilter *colorPoly = [CIFilter filterWithName:@"CIColorPolynomial"];
    [colorPoly setDefaults];

    CIVector *redVector = [CIVector vectorWithX:aColor.redComponent Y:0 Z:0 W:0];
    CIVector *greenVector = [CIVector vectorWithX:aColor.greenComponent Y:0 Z:0 W:0];
    CIVector *blueVector = [CIVector vectorWithX:aColor.blueComponent Y:0 Z:0 W:0];
    [colorPoly setValue:redVector forKey:@"inputRedCoefficients"];
    [colorPoly setValue:greenVector forKey:@"inputGreenCoefficients"];
    [colorPoly setValue:blueVector forKey:@"inputBlueCoefficients"];
    [self setContentFilters:[NSArray arrayWithObjects:colorPoly, nil]];
}

@end 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-05-13T20:50:45.143

如果您的目标是 Mojave 或更高版本，您可以将微调器的外观设置为深绿色。无论用户的系统外观如何，这将始终为您提供白色微调器。

```
spinner.appearance = NSAppearance(named: .darkAqua) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-03-13T22:01:22.073

在斯威夫特：

```
override func viewDidLoad() {
    super.viewDidLoad()
    let brightness = CIFilter(name: "CIColorControls")!
    brightness.setDefaults()
    brightness.setValue(1, forKey: "inputBrightness")
    self.spinner.contentFilters = [brightness]
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-19T04:24:14.203

我见过一些第三方 HUD 风格的控制框架，包括栏风格的 NSProgressIndicator，但不幸的是我不记得见过微调器。如果你找不到让它做你想做的事情的方法，[这个页面](http://www.ajaxload.info/)可以生成一个动画 gif，这可能有助于你自己制作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-11T20:29:36.090

**斯威夫特 4 解决方案**

```
guard let lighten = CIFilter(name: "CIColorControls") else { return }
lighten.setDefaults()
lighten.setValue(1, forKey: "inputBrightness")
contentFilters = [lighten] 
```

# syntax - sql更新查询语法错误，经典asp环境

> ID：456446
> 
> 赞同：1
> 
> 时间：2009-01-19T03:26:37.267
> 
> 标签：syntax

我在下面的代码行中收到以下错误：

查询表达式 'REPLACE(LTRIM(RTRIM(ATTACHMENTS)), ,'')' 中的语法错误（缺少运算符）。

任何帮助都是极好的...

```
-----------the line of code that is giving me problems--------------------------------

objConn.Execute("UPDATE EMAIL_SEND_ATTACHMENTS set ATTACHMENTS = REPLACE(LTRIM(RTRIM(ATTACHMENTS)), "& StoredPath & " ,'') WHERE EMAIL_LETTERS_HOLD_ID= "& AttID & " ")

-----------------------full asp page being called by a function------------------
<%

Dim AttID, RedirectURL
Dim objConn
dim StoredPath

AttID=request("EMAIL_LETTERS_HOLD_ID")
RedirectURL=request("RedirURL")

Set objConn = CreateObject("ADODB.Connection")
objConn.Open "DSN=AccessDSN"
objConn.Execute("UPDATE EMAIL_SEND_ATTACHMENTS set ATTACHMENTS = REPLACE(LTRIM(RTRIM(ATTACHMENTS)), " & StoredPath & " ,'') WHERE EMAIL_LETTERS_HOLD_ID= "& AttID & " ")
objConn.Close
Set objConn = Nothing

response.redirect RedirectURL
%> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T03:31:49.240

我认为您缺少一些引号-在 StoredPath 变量之前和之后检查：

objConn.Execute("UPDATE EMAIL_SEND_ATTACHMENTS set ATTACHMENTS = REPLACE(LTRIM(RTRIM(ATTACHMENTS)), '"& StoredPath & "' ,'') WHERE EMAIL_LETTERS_HOLD_ID= "& AttID & "")

安迪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T03:31:58.583

您缺少引号：

xxx" & StoredPath & "'xxx where xxx is a ' - 单引号分隔符。

# java - 如何将我的 java 文件转换为应用程序？

> ID：456451
> 
> 赞同：4
> 
> 时间：2009-01-19T03:29:59.307
> 
> 标签：java, executable, executable-jar

我编写了 4 个 .java 文件。问题是我只能从 IDE 执行 .java 文件，如何像应用程序一样执行 .class 文件？我在大学学习，有人告诉我 Java 是独立于平台的。任何教程/书籍推荐将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T03:35:43.270

基本思想（给你一些搜索的东西）是：

*   将已编译的 .class 文件捆绑到“jar”中。
*   将清单添加到您的 jar 中，指定要运行的主类。

当您运行“干净构建”时，您可能会发现您的 IDE 已经创建了它。Netbeans 将其放入“dist”文件夹中。

现代 JRE 将允许您通过双击它等来运行 jar。

您还可以通过使用诸如 JSmooth 之类的工具将 jar 包装在本机可执行文件中来更进一步。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-19T03:34:03.260

查看[可执行 jar](http://java.sun.com/docs/books/tutorial/deployment/jar/)。这是精确的，没有任何细节，[创建可执行的 jar 文件](http://csdl.ics.hawaii.edu/~johnson/613f99/modules/04/jar-files.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-19T03:52:49.197

你用的是什么IDE？

根据 IDE，有些支持[导出](http://www.fsl.cs.sunysb.edu/~dquigley/cse219/index.php?it=eclipse&tt=jar&pf=y)功能，可以为您创建 .jar 可执行文件。例如，在[Eclipse](http://www.eclipse.org/downloads/)中，您有该选项。此外，还有用于 Eclipse 的附加插件，例如[Fat-Jar](http://fjep.sourceforge.net/)，它将包含您包含的任何附加库，这些库不是 Sun 标准库的一部分。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T03:35:36.843

Java 文件必须通过 Java 虚拟机运行，因此您可以从命令行运行您的类文件。

如果您有一个名为*filename.java*的文件，请将其编译为*filename.class ，然后您可以通过键入**java filename*从命令行运行它

 ** * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T02:51:27.883

如果您想在 Windows 上分发您的应用程序，请查看[JSmooth](http://jsmooth.sourceforge.net/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T15:04:50.010

JNLP/Web 启动

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T15:34:16.637

> “基本的想法（给你一些搜索的东西）是：
> 
> 将已编译的 .class 文件捆绑到“jar”中。将清单添加到您的 jar 中，指定要运行的主类。当您运行“干净构建”时，您可能会发现您的 IDE 已经创建了它。Netbeans 把它放到一个 'dist' 文件夹中。”（by Cogsy）

另外要实现这一点，您可以选择：

> 根据 IDE，有些支持导出功能，可以为您创建 .jar 可执行文件。例如，在 Eclipse 中，您有该选项。此外，还有用于 Eclipse 的附加插件，例如 Fat-Jar，它将包括您包含的任何附加库，这些库不属于 Sun 的标准库的一部分。（作者：kchau）

或者，如果您要处理严肃的事情，请选择 Ant 或 Maven 之类的构建脚本。下面是一个 Ant build.xml 脚本的示例：

```
<project name="jar with libs" default="compile and build" basedir=".">
    <!-- this is used at compile time -->
    <path id="example-classpath">
        <pathelement location="${root-dir}" />
        <fileset dir="D:/LIC/xalan-j_2_7_1" includes="*.jar" />
    </path>

    <target name="compile and build">
        <!-- deletes previously created jar -->
        <delete file="test.jar" />

        <!-- compile your code and drop .class into "bin" directory -->
        <javac srcdir="${basedir}" destdir="bin" debug="true" deprecation="on">
            <!-- this is telling the compiler where are the dependencies -->
            <classpath refid="example-classpath" />
        </javac>

        <!-- copy the JARs that you need to "bin" directory  -->
        <copy todir="bin">
            <fileset dir="D:/LIC/xalan-j_2_7_1" includes="*.jar" />
        </copy>

        <!-- creates your jar with the contents inside "bin" (now with your .class and .jar dependencies) -->
        <jar destfile="test.jar" basedir="bin" duplicate="preserve">
            <manifest>
                <!-- Who is building this jar? -->
                <attribute name="Built-By" value="${user.name}" />
                <!-- Information about the program itself -->
                <attribute name="Implementation-Vendor" value="ACME inc." />
                <attribute name="Implementation-Title" value="GreatProduct" />
                <attribute name="Implementation-Version" value="1.0.0beta2" />
                <!-- this tells which class should run when executing your jar -->
                <attribute name="Main-class" value="ApplyXPath" />
            </manifest>
        </jar>
    </target>
</project> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-04T15:57:58.117

只需离开 IDE 并熟悉命令行工具即可。[Java 教程在](http://java.sun.com/docs/books/tutorial/index.html)[这里](http://java.sun.com/docs/books/tutorial/getStarted/cupojava/index.html)有一个关于这个主题的线索（选择 Windows 或 Solaris/Linux 部分）。

# jquery - jQuery 1.3 只选择第一个元素

> ID：456457
> 
> 赞同：3
> 
> 时间：2009-01-19T03:32:28.427
> 
> 标签：jquery, jquery-1.3

我不确定这是一个错误还是只是 jQuery 1.3 中我不知道的一些疯狂的新事物，或者我只是发疯了。

我有一个包含 11 个复选框的表格，我无法使用 jQuery 1.3 将它们全部选中：

```
// jQuery 1.2.6
$(".myTable").find(":checkbox");  // finds 11 elements

// jQuery 1.3
$(".myTable").find(":checkbox");  // finds 1 element: the first checkbox
$(":checkbox", $(".myTable"));    // finds 1 element
$('.myTable :checkbox'));         // finds all 11 elements 
```

如果我使用结果是一样的`.find('*')`：它只选择 1.3 中的第一个元素，所以它不是`:checkbox`.

在我自己的页面上，我每次都可以重新创建它，但是当我将（看似）相关的部分粘贴到 JSBin 中时，它就可以工作了！

原始页面也包含 Mootools，但我对范围界定非常小心，jQ 1.2.6 没有任何问题，所以我认为不可能是这样。还有其他想法吗？

*在任何人说之前，在这种情况下使用该`.find()`函数比组合选择器 ( ) 方便得多`".myTable :checkbox"`，并且将我的所有代码更改为该样式不是一种选择！*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T03:54:03.407

如果它确实是一个错误，您应该访问 jQuery 错误跟踪站点并报告它（参见[http://dev.jquery.com/](http://dev.jquery.com/)）。

尤其如此，因为 1.3 刚刚发布。但是，考虑到它经过的测试量，我强烈建议您尝试一个非常简单的网页，看看它是否真的是 jQuery 的问题，或者，正如您所建议的，与您的其他工具（即 Mootools）的可能交互. 只有几个复选框、1.3 jQuery 和您在问题中给出的代码的基本页面将是理想的。

只有当它仍然是一个问题时，我才会在 jQuery 上提出一个错误，否则我会从各种讨论组开始，看看他们是否能提供帮助。

例如，这段代码*确实*有效，因此不太可能是 jQuery 的错误。

```
<html>
  <head>
    <script type="text/javascript" src="jquery-1.3.js"></script>
    <script type="text/javascript">
      $(document).ready(function(){
        $(document).find(":checkbox").attr('checked',false);
        $("a").click(function(event){
          $(".myTable").find(":checkbox").attr('checked',true);
          event.preventDefault();
        });
      });
    </script>
  </head>
  <body>
    <a href="http://nowhere.com/">Click me!</a><hr>
    <table class="myTable"><tr>
      <td><input type="checkbox">One</input></td>
      <td><input type="checkbox">Two</input></td>
      <td><input type="checkbox">Three</input></td>
    </tr></table>
  </body>
</html> 
```

# gridview - 更新 GridView 时获取 DataItem

> ID：456467
> 
> 赞同：3
> 
> 时间：2009-01-19T03:37:56.480
> 
> 标签：gridview, dataitem, onupdate

如何从处于编辑模式且用户单击“更新”的 GridView 行中获取基础 DataItem？

我有一个可编辑的 GridView。我已将 CustomValidator 添加到其中一列的编辑视图中。当用户单击更新时，我运行服务器验证方法并需要获取正在编辑的行的底层 DataItem，以便我可以获得数据项的主键以用于验证。

```
GridView1.Rows[GridView1.EditIndex].DataItem; 
```

这不起作用。我猜是因为 GridView 没有在更新命令上进行数据绑定？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T05:34:05.670

```
GridView1.DataKeys[GridView1.EditIndex].Value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-22T04:42:50.947

我有一个类似的问题。我使用 rowdatabound 事件而不是 gridview 的更新事件。

这是一个例子

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewrow.dataitem%28VS.80%29.aspx#](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewrow.dataitem%28VS.80%29.aspx#)

# c# - NHibernate Insert is Committing but object is not persisted in table

> ID：456471
> 
> 赞同：1
> 
> 时间：2009-01-19T03:41:35.053
> 
> 标签：c#, database, nhibernate, forms, orm

When debugging everything appears good. The insert commits and there is no roll back, no exceptions. I sure hope some can help with this.

Here is my call:

```
using (ITransaction transaction = _session.BeginTransaction())
       {

           _session.Save(calc);
           transaction.Commit();
       } 
```

Real simple mapping:

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
               assembly="SigCalculator"
               namespace="SigCalculator.Domain"> 
```

```
<id name="ID">
  <generator class="guid" />
</id>
<property name="Time" />
<property name="Equation" /> 
```

here's the object:

```
public class Calculation
{
    public virtual Guid ID { get; set; }
    public virtual DateTime Time { get; set; }
    public virtual string Equation { get; set; }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T05:14:47.423

I'm a bonehead! Make sure you set your PK to a... PK..

Shheesh.. I need to take a break :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T03:56:06.273

What happens if you call:

```
session.Flush(); 
```

before the transaction Commit? What is your application's FlushMode set to?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T03:59:40.167

我尝试了以下..没有任何改变。

public void AddCalc(Calculation calc) { using (ITransaction transaction = _session.BeginTransaction()) {

```
 _session.Save(calc);
           _session.Flush();
           transaction.Commit();
       }

   } 
```

# python - 无法让 Python 从其他文件夹导入

> ID：456481
> 
> 赞同：100
> 
> 时间：2009-01-19T03:53:35.637
> 
> 标签：python

我似乎无法让 Python 在子文件夹中导入模块。当我尝试从导入的模块创建类的实例时出现错误，但导入本身成功。这是我的目录结构：

```
Server
    -server.py
    -Models
        --user.py 
```

这是 server.py 的内容：

```
from sys import path
from os import getcwd
path.append(getcwd() + "\\models") #Yes, i'm on windows
print path
import user

u=user.User() #error on this line 
```

和用户.py：

```
class User(Entity):
    using_options(tablename='users')

    username = Field(String(15))
    password = Field(String(64))
    email    = Field(String(50))
    status   = Field(Integer)
    created  = Field(DateTime) 
```

错误是：AttributeError：“模块”对象没有属性“用户”

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-01-19T04:00:15.110

我相信您需要在 Models 目录中创建一个名为的文件`__init__.py`，以便 python 将其视为一个模块。

然后你可以这样做：

```
from Models.user import User 
```

您可以在其中包含代码`__init__.py`（例如一些不同类需要的初始化代码）或将其留空。但它必须在那里。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-01-19T04:02:22.297

您必须`__init__.py`在`Models`子文件夹上创建。该文件可能为空。它定义了一个包。

然后你可以这样做：

```
from Models.user import User 
```

在 python 教程中阅读有关它的所有内容，请[点击此处](http://docs.python.org/tutorial/modules.html#packages)。

[这里](http://jcalderone.livejournal.com/39794.html)还有一篇关于 python 项目文件组织的好文章。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-19T13:51:51.500

> 导入用户
> 
> u=user.User() #error 在这一行

由于缺少上面提到的 __init__，您会期望 ImportError 可以使问题更清楚。

你没有得到一个，因为“用户”也是标准库中的一个现有模块。您的 import 语句抓住了那个并尝试在其中找到 User 类；那不存在，只有这样你才会得到错误。

使您的导入绝对是一个好主意：

```
import Server.Models.user 
```

为了避免这种歧义。实际上，从 Python 2.7 开始，'import user' 看起来与当前模块完全不同。

如果你真的想要相对导入，你可以在 Python 2.5 及更高版本中使用有点难看的语法明确地拥有它们：

```
from .user import User 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-03-10T01:15:35.963

当您没有标准的包结构时，导入位于父文件夹中的模块的正确方法是：

```
import os, sys
CURRENT_DIR = os.path.dirname(os.path.abspath(__file__))
sys.path.append(os.path.dirname(CURRENT_DIR)) 
```

（您可以合并最后两行，但这种方式更容易理解）。

该解决方案是跨平台的，并且足够通用，无需在其他情况下进行修改。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-19T04:02:31.830

您缺少 __init__.py。来自 Python 教程：

> 需要 __init__.py 文件才能使 Python 将目录视为包含包；这样做是为了防止具有通用名称（例如字符串）的目录无意中隐藏了稍后出现在模块搜索路径上的有效模块。在最简单的情况下，__init__.py 可以只是一个空文件，但它也可以执行包的初始化代码或设置 __all__ 变量，稍后将介绍。

在你的模型目录中放置一个名为 __init__.py 的空文件，所有文件都应该是金色的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-20T06:51:17.090

你如何写出参数`os.path.dirname`....命令？

```
import os, sys
CURRENT_DIR = os.path.dirname(os.path.abspath(__file__))
sys.path.append(os.path.dirname(CURRENT_DIR)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-08-25T18:45:55.600

我的首选方法是在每个包含其他模块使用的模块的目录上都有 __init__.py ，并在入口点覆盖 sys.path ，如下所示：

```
def get_path(ss):
  return os.path.join(os.path.dirname(__file__), ss)
sys.path += [
  get_path('Server'), 
  get_path('Models')
] 
```

这使得指定目录中的文件对导入可见，我可以从 Server.py 导入用户。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-09T15:37:32.690

在查看了上面这些贡献者给出的答案之后 - **Zorglub29、Tom、Mark、Aaron McMillin、lucasamaral、JoeyZhao、Kjeld Flarup、Procyclinsur、martin.zaenker、tooty44**并调试了我面临的问题，我发现了一个不同的用例我正面临这个问题。因此，在下面添加我的观察以供任何人参考。

在我的代码中，我循环导入了类。例如：

```
src
 |-- utilities.py (has Utilities class that uses Event class)  
 |-- consume_utilities.py (has Event class that uses Utilities class)
 |-- tests
      |-- test_consume_utilities.py (executes test cases that involves Event class) 
```

当我尝试执行**python -m pytest tests/test_utilities.py**以执行用 test_utilities.py 编写的 UT 时出现以下错误。

```
ImportError while importing test module '/Users/.../src/tests/test_utilities.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
tests/test_utilities.py:1: in <module>
    from utilities import Utilities
...
...
E   ImportError: cannot import name 'Utilities' 
```

我解决错误的方法是重构我的代码以移动循环导入类中的功能，以便我可以删除类的循环导入。

请注意，我`__init__.py`的“ **src** ”文件夹和“**测试**”文件夹中都有文件，并且仍然能够通过重构代码来摆脱“ **ImportError** ”。

[以下 stackoverflow 链接提供了有关Python 中循环依赖的](https://stackoverflow.com/questions/894864/circular-dependency-in-python)更多详细信息。

# delphi - How to add mouse wheel support to a component descended from TGraphicControl?

> ID：456488
> 
> 赞同：4
> 
> 时间：2009-01-19T03:58:42.850
> 
> 标签：delphi, vcl, mousewheel

I have created a delphi component which descends from TGraphicControl. Is it possible to add support for mouse wheels?

--- Edit ---

I've exposed the MouseWheel events as shown below but they aren't called.

```
TMyComponent = class(TGraphicControl)
published
  property OnMouseWheel;
  property OnMouseWheelDown;
  property OnMouseWheelUp;
end; 
```

--- Edit ---

As suggested below, I've tried to trap the WM_MOUSEWHEEL and CM_MOUSEWHEEL messages, but it doesn't seem to work. However I've managed to trap the CM_MOUSEENTER message. I don't understand why i can trap one type of message, but not the other.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-12-25T13:29:21.217

由于几个 VCL 构造（无论它们是故意的实现选择还是可能是错误^(1）)，我留在中间）只有焦点控件及其所有父级收到鼠标滚轮消息，以及捕获鼠标和的控件有一个专注的父母。

在`TControl`级别上，可以强制执行后一个条件。`CM_MOUSEENTER`当鼠标进入控件的客户空间时，控件会收到来自 VCL 的消息。要强制它接收鼠标滚轮消息，请关注其父级并在该消息处理程序中捕获鼠标：

```
procedure TWheelControl.CMMouseEnter(var Message: TMessage);
begin
  FPrevFocusWindow := SetFocus(Parent.Handle);
  MouseCapture := True;
  inherited;
end; 
```

但这些设置必须在鼠标退出控件时撤消。由于控件现在正在捕获鼠标，`CM_MOUSELEAVE`因此它没有接收到鼠标，因此您必须手动检查这一点，例如在`WM_MOUSEMOVE`消息处理程序中：

```
procedure TWheelControl.WMMouseMove(var Message: TWMMouseMove);
begin
  if MouseCapture and
    not PtInRect(ClientRect, SmallPointToPoint(Message.Pos)) then
  begin
    MouseCapture := False;
    SetFocus(FPrevFocusWindow);
  end;
  inherited;
end; 
```

现在，您会假设控件接收到的滚轮消息随后会触发`OnMouseWheel`,`OnMouseWheelDown`和`OnMouseWheelUp`事件。但是不，还需要一次干预。消息进入控件，`MouseWheelHandler`其中恰好将消息传递给窗体或活动控件。要触发这些事件，`CM_MOUSEWHEEL`应发送控制消息：

```
procedure TWheelControl.MouseWheelHandler(var Message: TMessage);
begin
  Message.Result := Perform(CM_MOUSEWHEEL, Message.WParam, Message.LParam);
  if Message.Result = 0 then
    inherited MouseWheelHandler(Message);
end; 
```

这导致了这个最终代码：

```
unit WheelControl;

interface

uses
  System.Classes, Winapi.Windows, Winapi.Messages, Vcl.Controls;

type
  TWheelControl = class(TGraphicControl)
  private
    FPrevFocusWindow: HWND;
    procedure CMMouseEnter(var Message: TMessage); message CM_MOUSEENTER;
    procedure WMMouseMove(var Message: TWMMouseMove); message WM_MOUSEMOVE;
  public
    procedure MouseWheelHandler(var Message: TMessage); override;
  published
    property OnMouseWheel;
    property OnMouseWheelDown;
    property OnMouseWheelUp;
  end;

implementation

{ TWheelControl }

procedure TWheelControl.CMMouseEnter(var Message: TMessage);
begin
  FPrevFocusWindow := SetFocus(Parent.Handle);
  MouseCapture := True;
  inherited;
end;

procedure TWheelControl.MouseWheelHandler(var Message: TMessage);
begin
  Message.Result := Perform(CM_MOUSEWHEEL, Message.WParam, Message.LParam);
  if Message.Result = 0 then
    inherited MouseWheelHandler(Message);
end;

procedure TWheelControl.WMMouseMove(var Message: TWMMouseMove);
begin
  if MouseCapture and
    not PtInRect(ClientRect, SmallPointToPoint(Message.Pos)) then
  begin
    MouseCapture := False;
    SetFocus(FPrevFocusWindow);
  end;
  inherited;
end;

end. 
```

如您所见，这会更改焦点控件，这违反了[基于 Windows 的桌面应用程序的用户体验指南，](https://msdn.microsoft.com/en-us/library/windows/desktop/dn742466(v=vs.85).aspx)并且当焦点控件具有明确的焦点状态时，可能会导致视觉干扰。

作为替代方案，您可以通过覆盖`Application.OnMessage`并在那里处理它来绕过所有默认的 VCL 鼠标滚轮处理。这可以按如下方式完成：

```
unit WheelControl2;

interface

uses
  System.Classes, Winapi.Windows, Winapi.Messages, Vcl.Controls, Vcl.AppEvnts,
  Vcl.Forms;

type
  TWheelControl = class(TGraphicControl)
  published
    property OnMouseWheel;
    property OnMouseWheelDown;
    property OnMouseWheelUp;
  end;

implementation

type
  TWheelInterceptor = class(TCustomApplicationEvents)
  private
    procedure ApplicationMessage(var Msg: tagMSG; var Handled: Boolean);
  public
    constructor Create(AOwner: TComponent); override;
  end;

procedure TWheelInterceptor.ApplicationMessage(var Msg: tagMSG;
  var Handled: Boolean);
var
  Window: HWND;
  WinControl: TWinControl;
  Control: TControl;
  Message: TMessage;
begin
  if Msg.message = WM_MOUSEWHEEL then
  begin
     Window := WindowFromPoint(Msg.pt);
     if Window <> 0 then
     begin
       WinControl := FindControl(Window);
       if WinControl <> nil then
       begin
         Control := WinControl.ControlAtPos(WinControl.ScreenToClient(Msg.pt),
           False);
         if Control <> nil then
         begin
           Message.WParam := Msg.wParam;
           Message.LParam := Msg.lParam;
           TCMMouseWheel(Message).ShiftState :=
             KeysToShiftState(TWMMouseWheel(Message).Keys);
           Message.Result := Control.Perform(CM_MOUSEWHEEL, Message.WParam,
             Message.LParam);
           Handled := Message.Result <> 0;
         end;
       end;
     end;
  end;
end;

constructor TWheelInterceptor.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
  OnMessage := ApplicationMessage;
end;

initialization
  TWheelInterceptor.Create(Application);

end. 
```

注意将事件的`Handled`参数设置为，否则焦点控件也会滚动。`MouseWheel*``True`

另请参阅[如何将鼠标滚轮输入控制在光标下而不是聚焦？](https://stackoverflow.com/a/34386680/757830)有关鼠标滚轮处理的更多背景信息和更通用的解决方案。

^(1))请参阅[Quality Central 错误报告 #135258](http://qc.embarcadero.com/wc/qcmain.aspx?d=135258)和[Quality Central 错误报告 #135305](http://qc.embarcadero.com/wc/qcmain.aspx?d=135305)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T05:38:58.373

`TGraphicControl`继承自`TControl`，它已经具有鼠标滚轮支持。查看`wm_MouseWheel`消息、`DoMouseWheel`、`DoMouseWheelDown`、`DoMouseWheelUp`和`MouseWheelHandler`方法以及`WheelAccumulator`属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T12:54:49.863

我也有同样的问题。还没有找到解决方案的运气，但也许这会有所帮助：

> 我怀疑另一个组件正在调用 Win API 方法 SetCapture，根据 API 帮助：
> 
> “SetCapture 函数将鼠标捕获设置为属于当前线程的指定窗口。一旦窗口捕获了鼠标，所有鼠标输入都将定向到该窗口，无论光标是否在该窗口的边界内。只有一个一次窗口可以捕获鼠标。”

作为新用户，我无法发布指向完整主题的链接。

已编辑

如果您将组件创建为 TCustomControl 的后代，则可以如下所述解决您的问题：

1.  使用 OnMouseEnter 事件来检测鼠标何时进入您的组件。
2.  在 OnMouseEnter 调用 SetFocus 方法使您的组件聚焦。现在您的组件可以接收 WM_MOUSEWHEEL 消息

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T12:09:40.770

只有 TWinControl 后代可以接收鼠标滚轮消息。TGraphicControl 不是基于窗口的控件，因此不能。如果 VCL 将消息路由到 TGraphicControl，它可以工作，但显然没有。您可以从 TCustomControl 下降，然后它会起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T05:36:20.533

捕获 WM_MOUSEWHEEL 消息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-09-02T13:06:33.347

我正在使用以下技术，我订阅了表单事件`MouseWheelUp()`并在其中，我搜索带有`WindowFromPoint()`(win32 api 函数)的小部件`Vcl.Controls.FindControl()`，然后我检查我是否得到了正确的 UI 小部件，当我不检查`ActiveControl`(当前具有焦点的表单上的小部件）。

此技术确保当小部件位于光标下或不在光标下但具有**焦点**时，鼠标滚轮向上/向下事件起作用。

下面的示例对鼠标滚轮向上事件作出反应，并在光标下或有焦点`TSpinEdit`时递增。`TSpinEdit`

```
function TFormOptionsDialog.FindSpinEdit(const AMousePos: TPoint): TSpinEdit;
var
  LWindow: HWND;
  LWinControl: TWinControl;
begin
  Result := nil;

  LWindow := WindowFromPoint(AMousePos);
  if LWindow = 0 then
    Exit;

  LWinControl := FindControl(LWindow);
  if LWinControl = nil then
    Exit;

  if LWinControl is TSpinEdit then
    Exit(LWinControl as TSpinEdit);

  if LWinControl.Parent is TSpinEdit then
    Exit(LWinControl.Parent as TSpinEdit);

  if ActiveControl is TSpinEdit then
    Exit(ActiveControl as TSpinEdit);
end;

procedure TFormOptionsDialog.FormMouseWheelUp(Sender: TObject; Shift: TShiftState; MousePos: TPoint;
  var Handled: Boolean);
var
  LSpinEdit: TSpinEdit;
begin
  LSpinEdit := FindSpinEdit(MousePos);
  if LSpinEdit = nil then
    Exit;

  LSpinEdit.Value := LSpinEdit.Value + LSpinEdit.Increment;
  Handled := True;
end; 
```

# php - wml问题

> ID：456489
> 
> 赞同：1
> 
> 时间：2009-01-19T03:59:09.323
> 
> 标签：php, wml

我是 Wap/Wml 的新手。我必须开发现有 php/mysql 网站的某个部分，以便人们可以通过手机访问某些信息。我有以下疑问：

1）我应该用哪种语言开发这个移动部分？我猜是WML。但是如果我在 WML 中开发它，它会在所有手机上都可以吗？

2) 我没有可以上网的手机。有没有可以查看我的wml页面的软件？这样我就知道它正在工作并且看起来不错？

3) 我的 wml 页面将有一个表单，人们可以在其中登录并访问一些私人数据。cookie 可以在移动设备中使用吗？

4) 我的 wml 页面也必须连接到 php 页面才能从 MySQL 中检索一些数据。我的问题是我可以从 php 编写 wml 页面吗？

如您所见，我很困惑，请帮忙。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T09:44:49.330

我过去使用 php 和 wml 开发了几个应用程序，并将分享我遇到的一些事情。

1) 您可以将 wml 用于界面，但功能有限，而 xhtml 移动配置文件允许您在 wap 站点上做更多事情，在提交 wml 之前，我会说花一些时间探索 xhtml 移动配置文件。

或者，您可以开发您的站点以同时容纳 wml 和 xhtml，并使用诸如[http://wurfl.sourceforge.net/](http://wurfl.sourceforge.net/)之类的库来确定正在访问您的站点的手机以及它支持的 xhtml 主要和 wml 作为故障转移的功能。

2) 是 firefox 扩展，您可以添加它来使用 firefox 查看 wml 页面，或者您可以使用原生支持 wml 的 opera。

3) 我从未在 wml 平台上使用过 cookie，我不会推荐它，我使用 $_SESSIONS 来跟踪页面之间的移动。

4) 你可以用 php 编写代码并在 wml 中输出，你只需要添加标题让浏览器知道它是 wml。

```
header("Content-type: text/vnd.wap.wml"); 
 echo "<?xml version=\"1.0\"?>\n";
 echo "<!DOCTYPE wml PUBLIC \"-//WAPFORUM//DTD WML 1.1//EN\" \"http://www.wapforum.org/DTD/wml_1.1.xml\">"; 
```

我上传了一个 php 测试脚本，你可以在 wml 中使用这些输出，我很难将代码添加到帖子中，所以我选择上传文件。 [http://www.devbox.co.za/exp/test.wml.tar](http://www.devbox.co.za/exp/test.wml.tar)

如果您决定使用 wml，请记住该语言非常严格，并且在处理它时请获取一个 xml 验证器。它会告诉你很多时间。

我希望这会有所帮助，祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-01T11:13:53.580

我不会使用 WML，因为今天出现的大多数手机都使用某种形式的 HTML/XHTML。

诺基亚 N80 等一些手机甚至不支持 WML。

在 PHP 中，您可以使用以下框架：HAWHAW [http://hawhaw.de](http://hawhaw.de) 它允许您将页面编写为一堆对象，然后根据访问页面的设备以 WML 或 XHTML 输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T06:55:08.533

1.  有许多设备可以处理 XHTML——但大多数也接受 WML。
2.  以OpenWave[模拟器](http://developer.openwave.com/dvl/member/downloadManager.htm?softwareId=23)为例 - 那里有很多。
3.  作为校长 - 是的，但有些人可能不会......
4.  不相关 - WML 是PHP 完成工作**后**设备将收到的标记（输出将在 WML 中，而不是在 Web 开发中通常使用 HTML）

我建议您阅读[w3schools的 WML 和](http://www.w3schools.com/WAP/wml_reference.asp)[mobiforge](http://mobiforge.com/starting/story/a-beginners-guide-mobile-web-development)的移动开发。

# wikipedia - 从维基百科检索音乐艺术家数据？

> ID：456498
> 
> 赞同：8
> 
> 时间：2009-01-19T04:03:20.393
> 
> 标签：wikipedia

在按流派分类音乐时，我发现维基百科比大多数其他数据源拥有更多有趣的流派信息。

我似乎记得有一个数据库从 Wikipedia 收集了此类信息并使其更易于访问，但我今天无法搜索任何内容。

如果我要尝试检索这些数据，我有哪些选择？有什么像我描述的那样，还是我需要去屏幕抓取？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-19T04:05:33.057

您应该查看[Freebase](http://www.freebase.com/)（例如，参见他们的[音乐艺术家表](http://www.freebase.com/view/music/views/artist?domain=%2Fmusic)）。如果您确实选择了 Wikipedia，那么您可能应该下载一个[数据库转储](http://en.wikipedia.org/wiki/Wikipedia:Database_download)。

比较 Radiohead 乐队的 Freebase 和 Wikipedia 的流派列表的示例：

*   [Freebase](http://www.freebase.com/view/en/radiohead)：另类摇滚、艺术摇滚、电子音乐、前卫摇滚、电子乐和实验摇滚。
*   [维基百科](http://en.wikipedia.org/wiki/Radiohead)：另类摇滚、电子摇滚和实验摇滚。

*编辑*：更重要的是，我包含了一个使用 mjt 的工作示例，这是一个为 Freebase 设计的 Javascript 框架。将其复制粘贴到文件中，用浏览器打开，输入艺术家的姓名，然后查看 Freebase 为他们提供的流派。

不太重要的是，我更改了我的示例并默认为 Radiohead。=)

```
<html>
<head>
  <script type="text/javascript" src="http://mjtemplate.org/dist/mjt-0.6/mjt.js"></script>
</head>
<body onload="mjt.run()">
<pre mjt.script="">
var name = mjt.urlquery.name ? mjt.urlquery.name : 'Radiohead';
</pre>
<div mjt.task="q">
mjt.freebase.MqlRead([{
  type: '/music/artist',
  name: {
    value:name,
    lang:{name:{value:'English'}}
  },
  genre: [{
    name: {
      value:null,
      lang:{name:{value:'English'}}}
  }]
}])
</div>

<form method="get" action="">
<input type="text" name="name" value="$name" />
<input type="submit" value="search" />
</form>

<table mjt.for="topic in q.result">
  <tr mjt.for="(var rowi = 0; rowi &lt; topic.genre.length; rowi++)">
    <td><pre mjt.script="">var gname = topic.genre[rowi].name;</pre>$gname.value</td>
  </tr>
</table>
</body></html> 
```

您很可能使用另一种语言，但希望您可以轻松翻译上述查询。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-19T07:41:49.047

MusicBrainz ( [http://musicbrainz.org/](http://musicbrainz.org/) ) 可能是你想要的，而不是维基百科。这是一个制作免费许可的高质量音乐元数据（作曲家姓名、专辑名称、曲目标题、该曲目上长号手的姓名等）的项目。他们开发了一个很棒的数据库、一个详细的数据库架构、用于使元数据准确和一致的综合风格指南、可以将元数据插入音乐数据文件中的标签的应用程序软件，以及一个您可以使用数据的 API。所有免费提供和协作编辑。

MusicBrainz 元数据的一个薄弱环节是音乐流派。这是因为这是一个非常棘手的问题：一个人的“放克”是另一个人的“流行”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T00:26:35.213

当我发布我的问题时，我发现了我的想法。[Infochimps](http://infochimps.org/)收集了来自 Wikipedia 的信息框，例如音乐艺术家[的信息框。](http://infochimps.org/dataset/infobox_infobox_musical_artist)不过，这并不是我真正想要的，因为它只能作为下载提供。

在我寻找的过程中，我发现了如何使用未呈现的 wiki 标记访问[XML 格式的文章。](http://en.wikipedia.org/wiki/Special:Export/Radiohead)显然它在维基百科服务器上更容易，但我不确定它是否更容易解析。

# c++builder - 获取给定目录及其子目录中所有文件的路径和文件名

> ID：456504
> 
> 赞同：0
> 
> 时间：2009-01-19T04:06:44.067
> 
> 标签：c++builder, subdirectory

不久前我收到了这个代码。我终于开始测试它（通过一些更改将文件放在不同的位置）......

```
void AddFiles(AnsiString path/*, TDataSet *DataSet*/)
{
TSearchRec sr;
int f;
    f = FindFirst(path+"\\*.*", faAnyFile, sr);
    while( !f )
    {
        if(sr.Attr & faDirectory)
        {
                if(sr.Name != "."   &&   sr.Name != "..")
                {
                        path.sprintf("%s%s%s", path, "\\", sr.Name);
                        AddFiles(path/*, DataSet*/);
                }
        }
        else
        {
                Form1->ListBox1->Items->Add(path+ "\\"+ sr.Name);
                //DataSet->Append();
                //DataSet->FieldByName("Name")->Value = sr.Name;
                /* other fields ... */
                //DataSet->Post();
        }
        f = FindNext(sr);
    }
    FindClose(sr);
} 
```

它不能正常工作。一开始就混了。。

一个真正的结构...

根根\subdir1 根\subdir2 根\subdir3

乱成这样……

根根\subdir1 根\subdir1\subdir2 根\subdir1\subdir2\subdir3

最终它停止包含根文件夹或子\子文件夹，并且“路径”只包含一个子文件夹（没有根文件夹）

这对于获取可用的完整路径文件名完全没有用。

所以你能告诉我代码哪里出错了...... **或者**给我一些关于如何在一个目录及其所有子目录中获取完整路径文件名的建议**。**

我希望它尽可能基本。即没有不常见的高级 C++ 功能。构建器新手可能能够调试的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T04:32:05.873

在这里，您将每个子路径附加到当前路径：

```
path.sprintf("%s%s%s", path, "\\", sr.Name);
AddFiles(path/*, DataSet*/); 
```

为组合路径使用新变量，因此您不会弄乱`path`目录中其余文件/目录仍需要的变量：

```
AnsiString subpath;
subpath.sprintf("%s%s%s", path, "\\", sr.Name);
AddFiles(subpath/*, DataSet*/); 
```

# web-applications - 您如何处理 Web 应用程序 (SaaS) 的发布管理？

> ID：456507
> 
> 赞同：4
> 
> 时间：2009-01-19T04:11:40.687
> 
> 标签：web-applications, release, release-management

发布托管 Web 应用程序新版本的最佳方法是什么？您通常多久发布一次？您是否选择任意日期，例如每周、每月等来推出一组累积的修复（可能使用类似于[Joel 的发货日期方法](http://www.joelonsoftware.com/articles/PickingShipDate.html)）？等待比这更长的时间似乎破坏了托管应用程序的部分主要优势。另一方面，您不希望不断推出可能使用户感到困惑的新功能（即，如果他/她每次登录时都有不同的东西）。

直到最近，我的经验主要是安装基于服务器或桌面应用程序。我很想知道人们在托管应用程序中使用什么类型的发布管理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T04:24:24.733

谷歌的方法可能是最适合最终用户的方法，但它是以复杂性为代价的。

他们在相当稳定的基础上推出新版本（有时只是个别更改）（经常每天，取决于项目）。但问题是：只有一小部分用户获得了新版本。

谷歌的大产品拥有大量用户，因此设置“5% 的用户应该看到此功能”之类的规则是切实可行的。

然后他们可以分析结果并计划他们的下一个版本，可能面向另外 15% 的用户群。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T01:23:12.573

尽管工程师想要定义一个日常工作，但它实际上将由系统背后的业务需求驱动。它还真的取决于更新的性质，等等......

推出内容和 HTML 更新应该没什么大不了的。应用程序更改应该是一件大事，并且在被推送之前在预览站点上通过已建立的测试例程。

可以肯定的一件事是，您需要有一种非常“干净”的方式来部署（和取消部署）更改。您还需要一种“简单”的方法来在更改上线之前对其进行审核和审核。

混合使用“git”和“rsync”可以让我们完全控制整个过程。我们项目的所有更改都是在从“生产”分支分支出来的分支中开发的。在任何更改上线之前，必须完全合并“生产”分支。上线的行为只是将适当的分支合并到“生产”中并将其同步到实时服务器。Git 让这变得非常简单。

这确保了生效的更改不可能与正在进行的其他更改发生冲突。

自从采用该系统以来，我们的部署程序在效率和清晰度上都得到了显着提高。顺便说一句，我们的部署范围从每天多次到每几个月一次。这一切都取决于。我希望在一个活跃项目上每周发布 1-2 个版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T04:16:05.170

尽早并经常发布是我所做的，也是我们在工作的地方所做的。每当我们进行更新时，我们也会在博客中介绍我们的更新。如果您一次尽可能地将所有更新滚动到一个更新中（对于 QA，必须回滚等），这可能对您来说更容易。从用户的角度来看，我认为大量更新没有任何问题。只要它们不是糟糕的更新。我认为如果您等待一整年或六个月，然后将所有更新整合到一个大版本中，就会出现问题。这就是我曾经从事的一个项目（你可能听说过的流行的 feedreader）的原因。人们认为我们已经死了，感知变成了现实。我们被遗弃了。所以我完全赞成消防水管的发布时间表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T04:16:13.300

每两周应该足够了，但这在很大程度上取决于您的市场。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-11T13:01:26.307

在 Planbox（基于 Web 的敏捷项目管理 SaaS），我们每天都会发布。我们可以这样做，因为我们的大部分应用程序逻辑和我们所有的表示逻辑都在前端（Javascript）中。甚至 HTML 也是使用模板引擎通过 Javascript 生成的。但后端 (PHP) 及其 REST API 很少更改。这使我们可以随时推送新版本的客户端，而不会破坏兼容性。

如果您可以迁移到这样的架构，您将节省大量时间并提高效率。

# c# - 在 C# 字符串中的 HTML 中搜索特定文本并标记文本的最佳方法是什么？

> ID：456508
> 
> 赞同：7
> 
> 时间：2009-01-19T04:12:50.780
> 
> 标签：c#, html, string

在 C# 字符串变量中搜索 HTML 以查找特定单词/短语并用高亮标记（或换行）该单词/短语的最佳方法是什么？

谢谢，

杰夫

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-07-30T17:08:51.447

我喜欢使用非常好用的[Html Agility Pack](http://www.codeplex.com/htmlagilitypack)，虽然最近更新不多，但还是可以使用的。例如抓取所有链接

```
HtmlWeb client = new HtmlWeb();
HtmlDocument doc = client.Load("http://yoururl.com");            
HtmlNodeCollection Nodes = doc.DocumentNode.SelectNodes("//a[@href]");         

foreach (var link in Nodes)
{                
    Console.WriteLine(link.Attributes["href"].Value);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T18:13:32.627

您可以查看使用[Html DOM](http://sourceforge.net/projects/html-dom/ "HTML DOM")，这是 SourceForge.net 上的一个开源项目。通过这种方式，您可以以编程方式操作您的文本，而不是依赖正则表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T04:14:42.960

正则表达式将是我的方式。;)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T04:25:34.793

如果您使用的 HTML 与 XHTML 兼容，您可以将其加载为 XML 文档，然后使用 XPath/XSL - 冗长但有点优雅？

我过去使用的一种方法是使用[HTMLTidy](http://tidy.sourceforge.net/ "HTML整洁")将杂乱的 HTML 转换为 XHTML，然后使用 XSL/XPath 将屏幕内容抓取到数据库中，以创建反向内容管理系统。

正则表达式可以做到这一点，但是一旦您尝试剥离标签、图像名称等以消除误报，可能会变得复杂。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T04:37:38.513

在简单的情况下，正则表达式就可以了。

字符串输入=“ttttttgottttttt”；
字符串输出 = Regex.Replace(input, "go", "<strong>$0</strong>");

将产生：“tttttt<strong>去</strong>tttttt”

但是当您说 HTML 时，如果您指的是最终呈现的文本，那就有点混乱了。假设你有这个 HTML：

<span class="firstLetter">B</span>ok

要突出显示“Book”这个词，您需要适当的 HTML 渲染器的帮助。为简化起见，可以先删除所有标签，只保留内容，然后进行通常的替换，但感觉不对。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T04:20:38.407

搜索字符串时，您需要查找正则表达式。至于标记它，一旦你有了子字符串的位置，它应该很简单，可以使用它来添加一些东西来包裹短语。

# svn - 如何在 git 中跟踪多个 svn 分支

> ID：456514
> 
> 赞同：2
> 
> 时间：2009-01-19T04:17:31.190
> 
> 标签：svn, git, branch

给猫剥皮的方法有很多，有人能改进一下吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T22:51:17.230

这是一篇很棒的文章，但真正帮助我的是理解`git svn`.

假设您的 SVN 设置如下：

```
$SVN_ROOT/project/trunk
$SVN_ROOT/project/branches
$SVN_ROOT/project/tags 
```

你的`.git/config`样子是这样的：

```
[svn-remote "svn"]
    url = $SVN_ROOT
    fetch = project/trunk:refs/remotes/git-svn
    branches = project/branches/*:refs/remotes/*
    tags = project/tags/*:refs/remotes/tags/* 
```

然后 a`git branch -r`将列出所有远程分支。“project/branches/*”表示分支目录中 SVN 上的任何内容都映射到远程分支。

`git checkout $branch`会检查出来，但你真正想做的是`git checkout -b my_feature $branch`工作你的本地分支（植根于远程分支），然后在你完成后合并。

# php - 使用命令行 curl 模拟 HTTP POST 并将输出导出到文本文件

> ID：456519
> 
> 赞同：3
> 
> 时间：2009-01-19T04:23:20.553
> 
> 标签：php, arrays, curl

如何使用 curl 模拟 HTTP POST 请求并在文本文件中捕获结果？我已经有一个名为 dump.php 的脚本：

```
<?php
  $var = print_r($GLOBALS, true);
  $fp = fopen('raw-post.txt','w');
  fputs($fp,$var);
  fclose($fp);
?> 
```

我做了一个简单的测试：

```
curl -d 'echo=hello' http://localhost/dump.php 
```

但我没有看到我在输出文件中转储的数据。我期待它出现在 POST 数组之一中，但它是空的。

```
[_POST] => Array
    (
    )

[HTTP_POST_VARS] => Array
    (
    ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T04:37:36.937

您需要使用`$_GLOBALS`而不是`$GLOBALS`.

此外，您可以这样做而不是使用输出缓冲：

```
$var = print_r($_GLOBALS, true); 
```

提供`true`作为第二个参数`print_r`将返回结果而不是自动打印它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T05:58:26.807

从 curl 命令行中删除刻度线 (')：

```
curl -d hello=world -d test=yes http://localhost/dump.php 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T05:32:07.810

如果您只是想捕获 POST 数据，请为您的`dump.php`文件执行类似的操作。

```
<?php
    $data = print_r($_POST, true);
    $fp = fopen('raw-post.txt','w');
    fwrite($fp, $data);
    fclose($fp);
?> 
```

所有 POST 数据都存储在`$_POST`变量中。此外，如果您还需要 GET 数据，`$_REQUEST`则将两者都保存。

# c# - 检索用户信息的快捷方式 Active Directory

> ID：456523
> 
> 赞同：32
> 
> 时间：2009-01-19T04:24:28.197
> 
> 标签：c#, active-directory

如何从[Active Directory](http://en.wikipedia.org/wiki/Active_Directory)中查询用户信息？我有有效的代码，但它真的很慢。我正在使用 C#。这是我目前使用的代码：

```
 static void Main(string[] args)
    {
        SearchResultCollection sResults = null;

        try
        {
            //modify this line to include your domain name
            string path = "LDAP://EXTECH";
            //init a directory entry
            DirectoryEntry dEntry = new DirectoryEntry(path);

            //init a directory searcher
            DirectorySearcher dSearcher = new DirectorySearcher(dEntry);

            //This line applies a filter to the search specifying a username to search for
            //modify this line to specify a user name. if you want to search for all
            //users who start with k - set SearchString to "k"
            dSearcher.Filter = "(&(objectClass=user))";

            //perform search on active directory
            sResults = dSearcher.FindAll();

            //loop through results of search
            foreach (SearchResult searchResult in sResults)
            {
                if (searchResult.Properties["CN"][0].ToString() == "Adit")
                {
                    ////loop through the ad properties
                    //foreach (string propertyKey in
                    //searchResult.Properties["st"])
                    //{

                        //pull the collection of objects with this key name
                        ResultPropertyValueCollection valueCollection =
                        searchResult.Properties["manager"];

                        foreach (Object propertyValue in valueCollection)
                        {

                            //loop through the values that have a specific name
                            //an example of a property that would have multiple
                            //collections for the same name would be memberof
                            //Console.WriteLine("Property Name: " + valueCollection..ToString());
                            Console.WriteLine("Property Value: " + (string)propertyValue.ToString());

                            //["sAMAccountName"][0].ToString();
                        }
                    //}
                    Console.WriteLine(" ");
                }
            }
        }
        catch (InvalidOperationException iOe)
        {
            //
        }
        catch (NotSupportedException nSe)
        {
            //
        }
        finally
        {

            // dispose of objects used
            if (sResults != null)
                sResults.Dispose();

        }
        Console.ReadLine();
    } 
```

从 AD 获取用户信息的更快代码是什么样的？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-06-18T18:52:54.853

你可以[`UserPrincipal.FindByIdentity`](https://docs.microsoft.com/en-us/dotnet/api/system.directoryservices.accountmanagement.userprincipal.findbyidentity?view=netframework-4.8)在里面打电话`System.DirectoryServices.AccountManagement`：

```
using System.DirectoryServices.AccountManagement;

using (var pc = new PrincipalContext(ContextType.Domain, "MyDomainName"))
{
    var user = UserPrincipal.FindByIdentity(pc, IdentityType.SamAccountName, "MyDomainName\\" + userName);
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-19T05:33:44.063

您的代码运行缓慢的原因是您的[LDAP](http://en.wikipedia.org/wiki/LDAP)查询会检索域中的每个用户对象，即使您只对一个通用名称为“Adit”的用户感兴趣：

```
dSearcher.Filter = "(&(objectClass=user))"; 
```

因此，要进行优化，您需要将 LDAP 查询范围缩小到您感兴趣的用户。尝试以下操作：

```
dSearcher.Filter = "(&(objectClass=user)(cn=Adit))"; 
```

此外，完成后不要忘记处置这些对象：

*   目录条目`dEntry`
*   目录搜索器`dSearcher`

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-31T22:29:14.773

好吧，如果您知道您的用户在 AD 层次结构中的位置（例如，很可能在“用户”容器中，如果它是一个小型网络），您也可以直接绑定到用户帐户，而不是搜索它。

```
DirectoryEntry deUser = new DirectoryEntry("LDAP://cn=John Doe,cn=Users,dc=yourdomain,dc=com");

if (deUser != null)
{
  ... do something with your user
} 
```

如果您已经使用 .NET 3.5，您甚至可以使用极大扩展的 System.DirectorySrevices.AccountManagement 命名空间以及每个最常见的 AD 对象的强类型类：

```
// bind to your domain
PrincipalContext pc = new PrincipalContext(ContextType.Domain, "LDAP://dc=yourdomain,dc=com");

// find the user by identity (or many other ways)
UserPrincipal user = UserPrincipal.FindByIdentity(pc, "cn=John Doe"); 
```

System.DirectoryServices.AccountManagement 上有大量信息 - 查看Joe Kaplan 和 Ethan Wilansky 在 MSDN 上关于该主题的这篇优秀[文章。](http://www.nxtbook.com/nxtbooks/cmp/msdnmag0108/index.php?startid=98)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-19T06:25:50.730

您可以将此代码简化为：

```
 DirectorySearcher searcher = new DirectorySearcher();
        searcher.Filter = "(&(objectCategory=user)(cn=steve.evans))";

        SearchResultCollection results = searcher.FindAll();

        if (results.Count == 1)
        {
            //do what you want to do
        }
        else if (results.Count == 0)
        {
            //user does not exist
        }
        else
        {
            //found more than one user
            //something is wrong
        } 
```

如果您可以缩小用户所在的范围，您可以将 searcher.SearchRoot 设置为您知道该用户所在的特定 OU。

您还应该使用 objectCategory 而不是 objectClass，因为 objectCategory 是默认索引的。

您还应该考虑搜索 CN 以外的属性。例如，搜索用户名 (sAMAccountName) 可能更有意义，因为它保证是唯一的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T04:43:45.693

我不确定你的“缓慢”有多少是由于你正在寻找具有特定属性值的条目的循环，但你可以通过更具体的过滤器来删除这个循环。试试这个页面以获得一些指导......[搜索过滤器语法](http://msdn.microsoft.com/en-us/library/aa746475(VS.85).aspx "搜索过滤器语法")

# camera - 如何以编程方式控制 Casio Exilim EX-F1 数码相机？

> ID：456524
> 
> 赞同：1
> 
> 时间：2009-01-19T04:24:59.350
> 
> 标签：camera

我希望能够以编程方式模拟卡西欧 Exilim EX-F1 数码相机上的快门按钮按下。

它带有一个可以模拟快门按下的 USB 连接遥控器，所以我认为有一种方法可以从 PC 上模拟它。

我已经查看并找不到任何用于控制此相机的库或任何东西。

有人有什么想法吗？如何“嗅探”从遥控器发送的 USB 的方法（我无法想象这很容易）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T04:33:12.500

好的，尽管它可能是开箱即用的想法，是我能想到的最简单的解决方案，没有专利文件+技术规范摆在我面前（这是人们用来做这类事情的正常途径）你总是可以使用乐高 Mindstorm 机器人。

**编辑：**无论如何，除了乐高，这将是我的行动方案，我提到过，核心方法是使用规格表，你通常可以从网站上得到它们，但是你基本上进入驱动程序编程。如果您发现该潜在客户无论如何都具有吸引力，那么[此链接](http://www.embedded.com/story/OEG20020321S0027)将为您提供一些在 Windows 上执行此操作的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-17T17:41:25.260

万一有人发现这个问题，卡西欧终于发布了一个官方方法，使用免费的 EX-F1 控制器软件（包括特殊固件）：

[http://support.casio.com/download.php?rgn=5&cid=001&pid=573](http://support.casio.com/download.php?rgn=5&cid=001&pid=573)

它有其局限性，但可以肯定的是，它使更多可能成为可能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-18T09:18:59.947

有一个非官方的 API 可以控制 Casio EX-F1。这是一个反向工程免费（如自由）产品。

[http://code.google.com/p/exf1ctrl/](http://code.google.com/p/exf1ctrl/)

# java - SQLException：在执行 while (rs.getNext()) 时，获取的列值被截断

> ID：456532
> 
> 赞同：4
> 
> 时间：2009-01-19T04:33:23.420
> 
> 标签：java, sql, database, oracle

我有一个程序使用相当简单的查询从 Oracle 10g (10.2.0.3) 中提取一个大型数据集。您几乎可以将查询/逻辑称为排序的“导出”，因为它从带有最小 where 子句的表中选择列（即，它返回大部分（如果不是全部）行）。

[Java] 代码是我们都见过的样板：

```
Connection con = null;
PreparedStatement pstmt = null;
ResultSet rs = null;
try {
    con = getConnection(Person);
    pstmt = con.prepareStatement(
            "SELECT ID, FIRST_NAME, LAST_NAME, ... FROM PERSON WHERE ...");
    rs = pstmt.executeQuery();
    while (rs.next()) {
        // write the data to a file
    }
}
finally {
    if (rs != null) try { rs.close(); } catch (Exception e) { }
    if (pstmt != null) try {pstmt.close(); } catch (Exception e) { }
    if (con != null) try { con.close() ; } catch (Exception e) { }
} 
```

getConnection 是我自己的方法，它将一个 Connection 对象返回给用于“PERSON”表的 Oracle 数据库。这感觉像是一个普通的编程问题，但我已经多次编写过这样的代码，从来没有遇到过这个问题。

我收到 java.sql.SQLException: ORA-01406: fetched column value was truncated on the while (rs.next()) 行。我读过的 Oracle 文档说“一个 FETCH 操作被强制截断一个字符串”。它建议使用更大的列缓冲区来保存最大的列。但这没有意义。在上面注释为“将数据写入文件”的代码部分中，我只是将每一列写入 rs.getBigDecimal("ID")、rs.getString("FIRST_NAME" 等。事实上，我可以，使用对 ResultSet 不执行任何操作的空 while 循环重现该区域。也就是说，仅遍历 ResultSet 会导致引发 SQLException。

返回的数据集大小应约为 100 万行。在循环进行大约 600,000 行/迭代后，我得到了异常。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T08:04:24.057

PERSON 是表还是视图？

在某些时候，在幕后，Java 必须计算出数据的数据长度。我猜它做错了。首先，逐一删除列，以便确定哪一列出错。然后可能会通过块（例如1-100000、100001-200000等）的数据，找到导致错误的块。然后缩小块（100000-150000 等），直到找到导致问题的单行。通过查看该行，可能很明显问题出在哪里。如果没有，请尝试使用 DUMP 函数查看数据中的字节。

数值列中的数据可能与列定义不对应。这通常是一个错误，可能是磁盘损坏，有时是通过 OCI 创建的奇怪数据。你可以尝试做一个

```
SELECT COUNT(*) FROM PERSON WHERE ID != TRUNC(ID); 
```

如果您的数据库使用多字节字符集，则可能会将内容与字符串混淆。此外，如果字符串中有非常规字符（例如 ASCII 0-31）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T23:52:13.627

First try getMaxFieldSize on the query, that way you know explictly what the max feild size is. I am not an Oracle programmer(PostgreSQL) but I do know that Oracle is supposed to have one of, if not the best, metadata support. Modify your sql query with a limit on the max field size. That at least will get you half way there.

> public int getMaxFieldSize() throws SQLException
> 
> ```
> Returns the maximum number of bytes allowed for any column value. 
> ```
> 
> This limit is the maximum number of bytes that can be returned for any column value. The limit applies only to BINARY, VARBINARY, LONGVARBINARY, CHAR, VARCHAR, and LONGVARCHAR columns. If the limit is exceeded, the excess data is silently discarded.
> 
> ```
> Returns:
>     the current max column size limit; zero means unlimited
> Throws:
>     SQLException - if a database access error occurs 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T08:17:06.947

顺便说一句，您应该考虑使用[Apache Commons DBUtils](http://commons.apache.org/dbutils/)来关闭您的资源。这将允许您用一行替换 finally 子句的内容：

```
DBUtils.closeQuietly(con, pstmt, rs); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T23:43:11.087

对我来说，首先要做的是查看“错误”数据，方法是修改循环以显示触发异常的行。

# php - 如何确保文件路径在给定的子目录中？

> ID：456546
> 
> 赞同：5
> 
> 时间：2009-01-19T04:42:58.440
> 
> 标签：php, security, sanitization

我想确保通过查询字符串设置的文件路径不会超出所需的子目录。现在，我正在检查：

1.  路径不以“ `/`”开头，防止用户给出绝对路径。
2.  该路径不包含“ `..`”，以防止用户提供位于所需子目录之外的路径。
3.  路径不包含“ `:`”，防止使用url（即“ `http://`”、“ `ftp://`”等）。如果我曾经在 Windows 服务器上运行这个脚本（不太可能），这也会阻止以驱动器说明符（即“ `C:\`”）开头的绝对路径。注意：我知道冒号是 Unix 文件名中的有效字符，但我永远不会在文件名中使用它。
4.  路径不以“ `\`”开头。以防万一我改变主意在 Windows 服务器上运行，这可以防止指定 Windows 网络路径（即“ `\\someserver\someshare`”）。同样，我知道反斜杠是有效的 Unix 文件名字符，但我也不会在任何文件名中使用它。

这些检查是否足够？

**背景**

我有一个 PHP 脚本，它（通过查询字符串）获取要显示给用户的示例源文件的路径。所以我可能会给他们一个“ `view_sample.php?path=accounting_app/report_view.php`”或“ `view_sample.php?path=ajax_demo/get_info.js`”之类的链接。

该脚本看起来基本上是这样的：

```
$path = $_GET['path'];
if(path_is_valid($path) && is_file("sample/$path"))
{
  header('Content-Type: text/plain');
  readfile("sample/$path");
} 
```

我担心的是恶意用户会看到 url 并尝试执行类似“ `view_sample.php?path=../../database/connection_info.php`”的操作并获得对**不在**“sample”目录中的文件的访问权限。

我上面定义的四项检查（将在`path_is_valid()`函数中实现）是否足以锁定恶意用户？（另外，我认为检查 1、3 和 4 基本上是无关紧要的，因为我预先设置了一个相对路径，但如果我不这样做，检查就足够了吗？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-19T04:50:43.900

称呼

```
$path = realpath("sample/$path"); 
```

然后检查生成的路径是否以您期望的目录开头。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-19T05:39:52.210

```
<?php
    // Current path information
    $path = $_GET['path'];
    $vroot = "sample";

    // Validate that the $path is a subfolder of $vroot
    $vroot = realpath($vroot);
    if(substr(realpath($path), 0, strlen($vroot)) != $vroot or !is_dir($path)) {lid!
        exit("Invalid path");
    } else {
       echo "Ah, everything is alright!";
    }
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-26T09:41:18.937

The use of [realpath](http://php.net/manual/de/function.realpath.php "PHP function: realpath") should not change the path, so I use it in the following way:

```
function checkPath($pathToCheck) {
    global $basepath;
    $fullpath = $basepath.'/'.$pathToCheck;
    if ($fullpath==realpath($fullpath) && is_dir($fullpath)) {
        return $fullpath;
    } else {
        error_die('path not allowed: '.htmlentities($pathToCheck));
    }
} 
```

# c# - 在 Dispose(bool) 方法实现中，不应该将成员设置为空吗？

> ID：456551
> 
> 赞同：4
> 
> 时间：2009-01-19T04:45:54.580
> 
> 标签：c#, .net, memory-management, garbage-collection, dispose

讨论模式的指南/注释/文章都没有`IDisposable`建议应该`null`在`Dispose(bool)`方法中设置内部成员（特别是如果它们是占用内存的野兽）。

在调试内部基准测试工具时，我开始意识到它的重要性。过去发生的事情是，这个缓冲区里面包含一个大数组。我们曾经为整个基准测试程序使用静态缓冲区。一旦我们完成了缓冲区，我们就无法释放这个内部数组，我们也不能让这个缓冲区可释放（因为它是静态的）。

所以，我相信，在`Dispose()`被调用之后，该类应该尽其所能释放它正在使用的所有资源并使它们再次可用，即使被处理的对象本身没有被 GC 回收，也没有设置成员为 null，因此，不允许 GC 收集内部对象意味着 Dispose 实现并不完美。

您对此有何看法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T05:01:27.810

在此期间发布任何额外的引用`Dispose`肯定是我尝试做的事情，原因有两个：

*   即使处置的对象仍在范围内，它也允许对内部对象进行垃圾收集
*   如果内部对象是一次性的，这意味着即使`Dispose()`在外部对象上被重复调用，我们也只会处理一次

例如，我倾向于使用以下内容：

```
if(someDisposableObject != null)
{
    someDisposableObject.Dispose();
    someDisposableObject = null;
}
(for non-disposable, just set to null)
someNonDisposableObject = null; // etc 
```

您可能还想将任何事件设置为 null：

```
someEventHandler = null; 
```

如果调用者目前无法完全释放他们的引用（或只是忘记），这有助于将影响降至最低。虽然您应该尝试释放外部对象（对于 GC），但相对容易意外延长对象的生命周期，例如通过捕获的变量（匿名方法/lambda）、事件等。

如果您有终结器，那么在 GC 过程中这样做没有任何好处，并且您不应该真正调用外部对象（甚至`Dispose()`）上的方法 - 所以简而言之：不要在 GC 扫描期间执行任何这些操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T04:59:45.893

也许我错过了你的观点，但是一旦你的对象被释放，它相对于它的成员所代表的根或“子根”就被分离了。似乎您正在考虑像引用计数系统一样的垃圾收集（可以做到，但......通常不是）。

相反，将其视为一棵多根树，其中每个对象都有其链接到的分支。归根结底，“最终根”是静态变量以及从“主”循环中实例化的任何内容。

当垃圾收集器运行时，考虑它所做的最简单的方法是考虑它将遍历“真正的根”列表并将“颜色”应用于它可以“到达”的所有内容。

现在，假设收集器可以访问“所有内容”，无论它是否已植根。任何没有颜色的东西都可以清理干净。

回到您最初的问题，当您的对象被处置时，人们假设（或至少希望）没有人再引用它。如果是这种情况，它就不再有根，因此它不会有助于“着色”它所接触的任何东西。

长话短说 - 如果在 Dispose 例程中取消成员正在修复某些问题 - 我会是你有一个不同的，真实的问题，有人持有指向你的已处置对象的链接，并在不应该的时候保持它“可访问” .

我为这可能是我写过的最过度引用的信息道歉，但我有点滥用标准条款。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T04:56:43.967

好吧，一般来说，这不会有什么不同。唯一会产生影响的地方是当您引用大对象堆上的对象时，您已经看到了该对象的行为）。

有一篇关于 LOH 的好文章在这里更详细地介绍了这一点：

[http://msdn.microsoft.com/en-us/magazine/cc534993.aspx](http://msdn.microsoft.com/en-us/magazine/cc534993.aspx)

# git - Git：获取分支上的最新提交

> ID：456552
> 
> 赞同：6
> 
> 时间：2009-01-19T04:46:09.293
> 
> 标签：git, branch

我正在努力了解有关 GIT 的一些信息。

我们有一个包含许多分支的存储库。我可以获取其中一个分支的本地副本（git checkout -b ...），进行一些更改，然后将它们推回。但是，如果我未能标记分支的末尾，那么其他用户如何获得分支的负责人？当他们使用 git checkout 来获取分支时，他们会在分支点获取代码 - 而不是该分支的头部。

我在这里想念什么？

编辑：我很晚才加入这个项目，并参与了 CVS 到 GIT 的转换。我假设 FOO_3_4_0001... 标记沿分支的所有标记点以 FOO_3_4_0001_INITIAL 开始。我该如何检查？

**编辑2：感谢所有提供答案的人。事实证明，标签 FOO_3_4_0001 不在 3.4 分支上，这就是我一直缺少的。我已经安排好了私刑派对。**

* * *

@goseb，没用。我试过这个：

```
16:19:29 (1) foo $ git checkout --track -b FOO_3_4_0001_INITIAL origin/FOO_3_4_0001_INITIAL
Branch FOO_3_4_0001_INITIAL set up to track remote branch refs/remotes/origin/FOO_3_4_0001_INITIAL.
Switched to a new branch "FOO_3_4_0001_INITIAL"
16:19:36 (1) foo $ git branch
* FOO_3_4_0001_INITIAL
  master
16:19:39 (1) foo $ git pull
remote: Counting objects: 68, done.
remote: Compressing objects: 100remote: % (59/59), done.
remote: Total 61 (delta 18), reused 0 (delta 0)
Unpacking objects: 100% (61/61), done.
From ssh://***
   f0c5a5f..99f6c1e  master     -> origin/master
Already up-to-date.
16:19:42 (1) foo $ 
```

此时我检查了我在这个分支上所做的更改，但它不存在。如果我查看标记为 FOO_3_4_0001_RC5a 的代码，我的更改就在那里。

* * *

好的，@Dustin 和 @mipadi 的更多信息。

当我运行时`git branch -r`，我看到：

```
16:12:02 (1) foo $ git branch -r
  origin/FOO_3_3_0001_BUILT_VF_BRANCH
  origin/FOO_3_4_0001_INITIAL
  origin/FOO_3_5_0000_RC5
  origin/FOO_3_5_0001_BRANCH
  origin/HEAD
  origin/master
  origin/origin
16:12:05 (1) foo $ 
```

如果我查看标签列表，我会看到以下内容：

```
16:12:05 (1) foo $ git tag -l
FOO_3_4_0000_RC1
FOO_3_4_0000_RC2
FOO_3_4_0000_RC2b
FOO_3_4_0000_RC3
FOO_3_4_0000_RC4
FOO_3_4_0000_RC4b
FOO_3_4_0000_RC5
FOO_3_4_0000_RELEASE
FOO_3_4_0000_TC1
FOO_3_4_0000_TC2
FOO_3_4_0001_RC2
FOO_3_4_0001_RC3
FOO_3_4_0001_RC4
FOO_3_4_0001_RC5
FOO_3_4_0001_RC5a
FOO_3_4_0001_TC1
16:14:33 (1) foo $ 
```

我面临的挑战是知道 FOO_3_4_0001_INITIAL 分支上的最新代码是什么。

现在在这种情况下，我碰巧知道它是 FOO_3_4_0001_RC5a，但如果我不知道（我们的一些开发人员有时会出现这种情况），我如何查看 origin_FOO_3_4_0001_INITIAL 分支知道我已经获得了最新的代码那个分支？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-19T05:08:43.803

他们可以从远程存储库中获取远程分支的 HEAD。

```
$ git remote update
$ git checkout <branch_name>
$ git pull origin <branch_name>
$ <edit> ...
$ git commit
$ git push origin <branch_name> 
```

我在这里假设远程存储库的名称为原点，您可以用实际名称替换它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-19T04:56:43.983

*听起来*你在做正确的事。分支的名称只是指向分支上最新提交的指针。您确定您正在将更改推送回每个人都从中提取的存储库吗*？**当您*提交时，您只是提交到本地存储库，因此要获得更改，协作必须（a）从本地存储库中提取，或（b）从您使用`git push`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T05:51:47.380

Git clone、pull 和 fetch 正在与整个存储库树一起工作。分支只是本地存储库中的标签。

完成克隆后，您在源中拥有远程存储库的副本。您可以通过在本地签出来访问它。

```
git co -b origin_local_master origin 
```

这将创建原始主节点的本地可编辑分支。

但是您也可以访问此存储库中的分支。

```
git co -b origin_local_dev origin/dev 
```

这将创建原始分支 dev 的本地可编辑分支。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T05:48:40.773

只是为了确保我们不会忽视显而易见的事情：

当您进行更改时，您是否在将它们推回之前提交它们？Git分支指向分支上的最新*提交*，因此如果尚未提交更改，那么分支仍然会指向分支点，这就是您所说的正在发生的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-15T20:52:26.777

如果您谈论的是本地分支而不是远程分支，那么这两种方法都可以为您提供最新的提交哈希：

```
git rev-parse HEAD 
```

和

```
git log -n 1 --pretty=format:"%H" 
```

尝试它们，它们应该是等效的

# parsing - 如何将令牌流转换为解析树

> ID：456554
> 
> 赞同：7
> 
> 时间：2009-01-19T04:47:08.837
> 
> 标签：parsing, token, lexical-analysis, parse-tree

我构建了一个词法分析器，可以从输入中流出标记，但我不确定如何构建该过程的下一步 - 解析树。有没有人有任何好的资源或例子来说明如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T04:51:56.177

我真的会推荐[http://www.antlr.org/](http://www.antlr.org/)，当然还有经典的 Dragon Compilers 书。

对于像 JavaScript 这样的简单语言，手动滚动递归下降解析器并不难，但使用 yacc 或 antlr 这样的工具几乎总是更容易。

我想回到你问题的基础，你真的想研究 BNF 式的语法语法并为你的目标选择一种语法。如果你有这个，解析树应该会掉出来，成为该语法的“实例”表现。

另外，不要试图将解析树的创建变成最终解决方案（例如生成代码或其他什么）。它可能看起来可行且更有效；但总会有一段时间，你真的希望你有那个解析树'原样'。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T05:36:20.890

您应该为您的平台研究解析器生成器工具。解析器生成器允许您为您的语言指定上下文无关语法。该语言由许多规则组成，这些规则将一系列符号“简化”为一个新符号。您通常还可以为不同的规则指定优先级和关联性，以消除语言中的歧义。例如，一个非常简单的计算器语言可能看起来像这样：

```
%left PLUS, MINUS           # low precedence, evaluated left-to-right
%left TIMES, DIV            # high precedence, left-to-right

expr ::= INT
| expr PLUS expr
| expr MINUS expr
| expr TIMES expr
| expr DIV expr
| LEFT_PAREN expr RIGHT_PAREN 
```

通常，您可以将一些代码与每个规则相关联，以从该规则中的其他符号构造一个新值（在本例中为表达式）。解析器生成器将接收语法并以您的语言生成代码，将令牌流转换为解析树。

大多数解析器生成器都是特定于语言的。ANTLR 是众所周知的，支持 C、C++、Objective C、Java 和 Python。不过听说很难用。我在 C/C++ 中使用过 bison，在 Java 中使用过 CUP，在 OCaml 中使用过 ocamlyacc，它们都非常好。如果您已经在使用词法分析器生成器，则应该寻找专门与之兼容的解析器生成器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T04:52:54.800

我相信一种常见的方法是使用[Finite State Machine](http://en.wikipedia.org/wiki/Finite_state_machine)。例如，如果您读取一个操作数，您将进入下一个期望操作符的状态，并且您通常使用该操作符作为操作数的根节点，依此类推。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-22T10:18:14.967

正如上面 Marcos Marin 所描述的，如果你想自己做的话，一个使用 BNF 中的语言规则来解析你的令牌列表的状态机可以解决问题。只是，正如 Paul Hollingsworth 在上面的评论中所说，更简单的方法是使用具有简单 FiFo 内存堆栈的[下推自动机。](http://en.wikipedia.org/wiki/Pushdown_automaton)在你的语法中，每一类令牌都有一个下一个预期的令牌，它也在你的状态机中表示。堆栈用于“记住”前一个标记类是什么，以减少所需的状态（可以在没有堆栈的情况下完成，但您需要为语法树中的每个类和子类拆分一个新状态）。接受状态将是（在自然语言和大多数编程语言中）起始状态，在特定情况下可能是其他一些状态。

如果您想使用工具（速度更快，范围更小），[Antlr将是我的建议。](http://www.antlr.org/)祝你好运！

# java - 我应该为 j2ee 应用程序服务器配置文件实现源代码控制吗？

> ID：456556
> 
> 赞同：2
> 
> 时间：2009-01-19T04:48:17.447
> 
> 标签：java, version-control, jakarta-ee, configuration-management

对于典型的 J2EE Web 应用程序，数据源连接设置存储为应用程序服务器配置的一部分。

有没有办法对这些配置细节进行版本控制？我想要对数据源和其他应用程序服务器配置更改进行更多控制。

这样做的标准做法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T06:35:28.777

使用 WebSphere 时，我们发现最好的方法是编写部署脚本，并将脚本置于版本控制之下，以及每个目标环境的响应文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T10:56:54.973

通过版本控制跟踪应用程序服务器的配置更改是一件好事。但是，这确实意味着所有更改都是通过脚本完成的，而不是管理 Web 界面。我建议

[http://www.ibm.com/developerworks/java/library/j-ap01139/index.html?ca=drs-](http://www.ibm.com/developerworks/java/library/j-ap01139/index.html?ca=drs-)

作为关于这个主题的一篇很好的背景信息文章。

更新：就在最近，第 2 部分已在此处发布：[http ://www.ibm.com/developerworks/java/library/j-ap02109/index.html?ca=drs-](http://www.ibm.com/developerworks/java/library/j-ap02109/index.html?ca=drs-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T11:02:42.060

Websphere 可能很棘手，因为目录结构是一堆文件 - 通常似乎有重复，很难确定哪个是您需要备份/恢复的神奇文件。如何去做这件事的问题不应该减损做这件事的必要性。- 这是肯定的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T05:02:38.790

我们的（Spring）应用在 spring 配置文件中有一个硬编码的 jndi 名称。这样，同一个耳朵可以部署到 dev、qa 和 prod 环境中，您不必担心数据库连接细节。

应用服务器管理员确保针对该 jndi 名称注册数据源，并在每个环境中使用适当的连接详细信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T05:47:30.387

但这如何让我管理对应用程序服务器中数据源配置的更改。这是一个场景：

1.  DBA 更改数据库服务器的连接密码。

2.  Webspehere/Weblogic 管理员通过管理员控制台对服务器配置进行相应的更改。

上述更改不受版本控制，因此无法清楚地了解此类更改的历史记录。

问题不在于应如何配置应用程序，而在于应如何对配置更改进行版本控制。也许对于简单的项目来说这听起来有点矫枉过正，但对于某些项目来说，控制这样的变化确实成为一个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T08:13:19.203

每当您问自己“X 是否应该在版本控制中”时，默认答案都是“是”。

要获得更精确的答案，请问自己：文件是由人创建的（如源文件或文档）还是由另一个程序生成的（如目标文件或分发 PDF）？

由人创建和/或维护的文件应受配置控制。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T21:20:15.170

我们一直在为我们的应用服务器设置使用版本控制。它是一个名为 WLST（weblogic 脚本工具）的工具，它是 weblogic 服务器分发的一部分。域配置存储在 Jython 脚本中，该脚本可以通过命令行轻松执行，因此与我们的构建工具 maven 完美集成。

创建一个预配置的运行 weblogic 域只需要执行一个 maven 目标。所有那些错误配置的 jdbc 连接或错误的 jms 目标参数的烦人问题都消失了。您将始终拥有一个在给定时间与源代码匹配的 appserver 配置。您永远不需要记住必须为您正在处理的项目的这个特定版本应用哪个应用服务器设置。

我真的推荐这个。

我也想知道，其他应用服务器是否有类似的解决方案可用。据我所知，有一种通过蚂蚁来处理玻璃鱼的方法。JBoss 如何做到这一点？

# c++ - 把这个垃圾从我的向量中取出

> ID：456557
> 
> 赞同：-2
> 
> 时间：2009-01-19T04:50:32.497
> 
> 标签：c++, ifstream

我想消除我在`vector<int> synsAux`下面遇到的垃圾。它应该打印：

```
1 
7
7
1 
```

我在第一位和第三位数字前多了一个 2，为什么？这 2 是空格的 ascii 值还是什么？我如何避免它的阅读？

这是运行程序所需的字典文件：

```
dictionary.txt
1 cute
2 hello
3 ugly
4 easy
5 difficult
6 tired
7 beautiful
synonyms
1 7
7 1
antonyms
1 3
3 1 7
4 5
5 4
7 3 
```

* * *

```
#include <iostream>
#include <fstream>
#include <string>

#include <sstream>
#include <vector>

using namespace std;

class WordInfo{
      public:
             WordInfo(){}
             ~WordInfo() {     
             }

             int id() const {return myId;}

             void readWords(istream &in)
             {
               in>>myId>>word;     
             }

             void pushSynonyms (string synline, vector <WordInfo> wordInfoVector)
             {
                 stringstream synstream(synline);
                 vector<int> synsAux;
                 int num;
                 while (synstream >> num) synsAux.push_back(num);
                 cout<<synsAux.size();

                  for (int i=0; i<synsAux.size(); i++){
                      cout<<synsAux[i]<<endl;  
                      // THIS LINE SHOULD BE PRINTING
                      //1
                      //7
                      //7
                      //1
                 }       
             }

             void pushAntonyms (string antline, vector <WordInfo> wordInfoVector)
             {

             }

             //--dictionary output function
             void printWords (ostream &out)
             {
                out<<myId<< " "<<word;     
             }

             //--equals operator for String
             bool operator == (const string &aString)const
             {
                           return word ==aString; 
             }

             //--less than operator
             bool operator <(const WordInfo &otherWordInfo) const
             { return word<otherWordInfo.word;}

             //--more than operator
             bool operator > (const WordInfo &otherWordInfo)const
             {return word>otherWordInfo.word;}

             private:
                   vector <int> mySynonyms;
                   vector <int> myAntonyms;
                   string word;
                   int myId;
      };

      //--Definition of input operator for WordInfo
      istream & operator >>(istream &in, WordInfo &word)
      {
         word.readWords(in); 
      }

      //--Definition of output operator
      ostream & operator <<(ostream &out, WordInfo &word)
      {
            word.printWords(out);  
      }

  int main() {
      string wordFile;
      cout<<"enter name of dictionary file: ";
      getline (cin,wordFile);

      ifstream inStream (wordFile.data());

      if(!inStream.is_open())
      {
          cerr<<"cannot open "<<wordFile<<endl; 
          exit(1);                      
      }

      vector <WordInfo> wordVector; 
      WordInfo aword;

      while (inStream >>aword && (!(aword=="synonyms")))
      {
          wordVector.push_back(aword);
      }

      inStream.clear(); // clears failbit on the ifstream

      int i=0;          
      while (i<wordVector.size()){
            cout<<wordVector[i]<<endl;
            i++;
      }

      vector <int> intVector;
      string synLine; //suspect

      while (getline(inStream, synLine)&&(synLine!=("antonyms"))){
            aword.pushSynonyms(synLine, wordVector);
      }

      system("PAUSE");
      return 0;
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T05:00:49.917

你在这里打印两个：

```
cout<<synsAux.size(); 
```

# excel - 任何jsp标签库来执行简单的excel编辑？

> ID：456566
> 
> 赞同：0
> 
> 时间：2009-01-19T04:57:40.533
> 
> 标签：excel, jsp-tags

有没有jsp标签库可以在web上进行简单的excel编辑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T14:17:32.603

[Apache POI](http://poi.apache.org/)似乎是做类似事情的另一种常见方式。[这是一个带有一些示例代码](http://www.roseindia.net/jsp/poi/createBox.shtml)的网页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T14:14:32.467

[JExcel](http://jexcelapi.sourceforge.net/)为您提供 Java 中的 excel 编辑。从此，滚动您自己的 JSP 标记应该不会太难。这不是您想要的，但没有其他人回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-26T09:38:12.743

没有这么简单的 jsp 标签，但您可以使用 EasyXLS，一种基于 java 的 API，可以用作[JSP excel 库](http://www.easyxls.com/java-excel-library)，如您在此链接中看到的并创建自己的。

使用 Apache POI 并不难，这里有一个关于如何实现目标的示例： [http ://www.easyxls.com/manual/html/programmerGuide/basics/importFromXLSFiles.html](http://www.easyxls.com/manual/html/programmerGuide/basics/importFromXLSFiles.html)

基本上，您需要像上一个示例一样将单元格加载到您的 JSP 控件并编辑 Excel 数据。

# c# - 如何合并数据集中的两列？

> ID：456568
> 
> 赞同：2
> 
> 时间：2009-01-19T04:59:08.423
> 
> 标签：c#, merge, dataset

以前我问过关于[将列插入数据集的](https://stackoverflow.com/questions/351557/how-does-one-insert-a-column-into-a-dataset-between-two-existing-columns)问题。我现在有一个类似的问题......即将两列或多列合并为一列。

假设我有以下数据集：

```
DataSet ds = new DataSet();
ds.Tables.Add(new DataTable());
ds.Tables[0].Columns.Add("id", typeof(int));
ds.Tables[0].Columns.Add("firstname", typeof(string));
ds.Tables[0].Columns.Add("lastname", typeof(string)); 
```

我需要将“名字”和“姓氏”列组合成一个名为“名称”的列。

我最好创建一种将两列合并在一起的方法，还是创建一种可用于将多列合并在一起的更通用的方法？

我的想法是创建一个类似于以下的通用方法：

MergeColumns（字符串格式，字符串mergeColumn，DataTable dt，params string[] columnsToMerge）

用户提供如下格式：“{0} {1}”

mergeColumn 是新列的名称...但它必须能够与将要合并的列之一相同，因为在我的真实世界案例中，我将“name”和“given_names”合并为“name” ...但是如果我需要将“街道”、“城市”、“州”、“邮政编码”等合并到一个名为“地址”的列中，我仍然希望能够使用它。

我认为这将被使用的方式如下：

MergeColumns("{0} {1}", "name", dataTable, "firstname", "lastname");

鉴于上述数据集，我希望得到的数据集如下所示：

```
DataSet ds = new DataSet();
ds.Tables.Add(new DataTable());
ds.Tables[0].Columns.Add("id", typeof(int));
ds.Tables[0].Columns.Add("name", typeof(string)); 
```

这看起来是一种合理的方法吗？这样的方法是否已经存在？我不想重新发明轮子。另外，我是否正在创建一种比我现在实际需要的方法更多的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T05:53:49.203

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        DataSet ds = new DataSet();
        ds.Tables.Add(new DataTable());
        ds.Tables[0].Columns.Add("id", typeof(int));
        ds.Tables[0].Columns.Add("firstname", typeof(string));
        ds.Tables[0].Columns.Add("lastname", typeof(string));

        ds.Tables[0].Rows.Add(1,"torvalds", "linus");
        ds.Tables[0].Rows.Add(2,"lennon", "john");            

        ds.Tables[0].MergeColumns("name", "lastname", "firstname");

        foreach (DataRow dr in ds.Tables[0].Rows)
            MessageBox.Show(dr["name"].ToString());

    }

}

public static class Helper
{
    public static void MergeColumns(this DataTable t, string newColumn, params string[] columnsToMerge)
    {
        t.Columns.Add(newColumn, typeof(string));

        var sb = new StringBuilder();

        sb.Append("{0}, ");
        for (int i = 1; i < columnsToMerge.Length; ++i)
            sb.Append("{" + i.ToString() + "}");

        string format = sb.ToString();

        foreach(DataRow r in t.Rows)
            r[newColumn] = string.Format(format, columnsToMerge.Select(col => r[col]).ToArray() );
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T05:09:47.043

如果数据集足够具体，那么 MergeName() 方法就可以了。如果您认为您不会在不止一次的地方使用它，则尤其如此。通用方法将需要更多的工作，但如果您正在进行大量合并，则可能是值得的。

我能想到的一些事情是你必须处理的：

*   您可能会遇到的一个问题是类型检查。如果用户想要合并日期字段或数字字段会发生什么。
*   旧田地怎么办？它们会保留还是被删除？如果您将其用作直接数据源，您可能希望删除剩余的列，因此某种`RemoveOldColumns`标志可能是个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T05:11:33.220

在我看来，这应该发生在数据层而不是逻辑层。据推测，数据集消费者知道它需要什么数据，并且可以明确地从数据存储中请求它，而无需操作数据集。

在数据库场景中，我本质上是在提倡一种多存储过程方法，并且数据集使用者将从适当的方法中检索数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T05:56:39.447

或者，您可以这样做：

```
 public Form1()
    {
        InitializeComponent();

        DataSet ds = new DataSet();
        ds.Tables.Add(new DataTable());
        ds.Tables[0].Columns.Add("id", typeof(int));
        ds.Tables[0].Columns.Add("firstname", typeof(string));
        ds.Tables[0].Columns.Add("lastname", typeof(string));

        ds.Tables[0].Rows.Add(1,"torvalds", "linus");
        ds.Tables[0].Rows.Add(2,"lennon", "john");    

        ds.Tables[0].Columns.Add("name", typeof(string), "lastname + ', ' + firstname"); 

        foreach (DataRow dr in ds.Tables[0].Rows)
            MessageBox.Show(dr["name"].ToString());

    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T05:34:10.193

```
 DataSet ds = new DataSet();
        ds.Tables.Add(new DataTable());
        ds.Tables[0].Columns.Add("id", typeof(int));
        ds.Tables[0].Columns.Add("firstname", typeof(string));
        ds.Tables[0].Columns.Add("lastname", typeof(string));

        ds.Tables[0].Rows.Add(1,"torvalds", "linus");
        ds.Tables[0].Rows.Add(2,"lennon", "john");

        ds.Tables[0].Columns.Add("name", typeof(string));
        foreach (DataRow dr in ds.Tables[0].Rows) dr["name"] = dr["lastname"] + ", " + dr["firstname"];

        foreach (DataRow dr in ds.Tables[0].Rows)
            MessageBox.Show(dr["name"]); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-15T11:50:47.447

这正是我的要求，经过大量搜索后，我最终决定最好创建自己的数据表并将其用作 ListBox 或 DropDownList 的数据源，无论哪个需要。

```
DataTable dt = new DataTable();
dt.Columns.Add("Test",typeof(String));
foreach (DataRow r in ds.Tables[0].Rows)
{
  DataRow dr = dt.NewRow();
  dr["Test"] = r["LastName"] + " ," + r["firstName"];
  dt.Rows.Add(dr);
} 
```

这`ds`是包含该过程的主要返回表的数据集。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-03T05:29:55.207

```
string result = string.Join(",", dtTotalQuery.AsEnumerable().Select(row => dtTotalQuery.Rows[0].ItemArray[0] + " " + dtTotalQuery.Rows[0].ItemArray[1])); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-09-17T09:54:48.490

扩展方法带有可选**的分隔符**和**位置**，

```
public static class Helper
{
    public static void MergeColumns(this DataTable t, string newColumn, params string[] columnsToMerge)
    {
        t.Columns.Add(newColumn, typeof(string));

        var sb = new StringBuilder();

        sb.Append("{0}, ");
        for (int i = 1; i < columnsToMerge.Length; ++i)
            sb.Append("{" + i.ToString() + "}");

        string format = sb.ToString();

        foreach(DataRow r in t.Rows)
            r[newColumn] = string.Format(format, columnsToMerge.Select(col => r[col]).ToArray() );
    }
} 
```

用法

```
//DataTable dt
dt.MergeColumns("name", 0, " ", "lastname", "firstname"); 
```

# java - Java Wrapper 相等性测试

> ID：456575
> 
> 赞同：23
> 
> 时间：2009-01-19T05:05:43.107
> 
> 标签：java, wrapper

```
 public class WrapperTest {

    public static void main(String[] args) {

        Integer i = 100;
        Integer j = 100;

        if(i == j)
            System.out.println("same");
        else
            System.out.println("not same");
    }

   } 
```

上面的代码给出了`same`运行时的输出，但是如果我们将`i`和的值更改`j`为 1000，则输出将更改为`not same`. 当我为 SCJP 做准备时，需要弄清楚这背后的概念。有人可以解释这种行为吗。谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-19T05:14:16.817

在 Java 中，-128 到 127（含）之间的整数通常由同一个 Integer 对象实例表示。这是通过使用称为 IntegerCache 的内部类来处理的（包含在 Integer 类中，例如在调用 Integer.valueOf() 时或在自动装箱期间使用）：

```
private static class IntegerCache {
    private IntegerCache(){}

    static final Integer cache[] = new Integer[-(-128) + 127 + 1];

    static {
        for(int i = 0; i < cache.length; i++)
            cache[i] = new Integer(i - 128);
    }
} 
```

另见：[http ://www.owasp.org/index.php/Java_gotchas](http://www.owasp.org/index.php/Java_gotchas#Immutable_Objects_.2F_Wrapper_Class_Caching)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-19T05:12:41.453

基本上 -127 和 127 之间的整数以这样的方式“缓存”，当你使用这些数字时，你总是在内存中引用相同的数字，这就是你`==`工作的原因。

该范围之外的任何整数都不会被缓存，因此引用是不一样的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-19T05:11:56.137

@tunaranch 是正确的。这也与此[Python question](https://stackoverflow.com/questions/306313/python-is-operator-behaves-unexpectedly-with-integers)中的问题相同。要点是 Java 为从 -128 到 127 的整数保留一个对象（Python 是 -5 到 256），并且每次您请求一个对象时都返回相同的对象。如果你要求一个超出这个固定范围的整数，它每次都会给你一个新对象。

（回想一下，`==`返回两个对象是否*实际上*相同，同时`equals`比较它们的内容。）

*编辑*：这是[Java 语言规范](http://java.sun.com/docs/books/jls/)[第 5.1.7 节](http://java.sun.com/docs/books/jls/third_edition/html/conversions.html#5.1.7)中的相关段落：

> 如果被装箱的值*p*`true`是, `false`, a `byte`, a`char`在 to 的范围内 `\u0000`，`\u007f`或者是一个介于 -128 和 127 之间的 int 或 short 数，则令 *r1*和*r2*是 p 的任意两次装箱转换的结果。*r1* == *r2*总是如此。

请注意，这也描述了其他类型会发生什么。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-19T05:08:42.210

这与平等和自动装箱有关：[http ://web.archive.org/web/20090220142800/http://davidflanagan.com/2004/02/equality-and-autoboxing.html](http://web.archive.org/web/20090220142800/http://davidflanagan.com/2004/02/equality-and-autoboxing.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T08:53:20.510

您的代码无法编译。这就是我得到的：

> 线程“main”java.lang.Error 中的异常：未解决的编译问题：类型不匹配：无法从 int 转换为 Integer 类型不匹配：无法从 int 转换为 Integer

```
at WrapperTest.main(WrapperTest.java:5) 
```

变量 i 和 j 是 Integer 对象的实例。不要使用“==”运算符比较对象的实例，而是使用“等于”方法。

问候

# asp.net - 使用 ASP.NET 实现“反向”或“嵌套”母版页

> ID：456581
> 
> 赞同：0
> 
> 时间：2009-01-19T05:10:53.220
> 
> 标签：asp.net, master-pages

我希望我的神秘标题不是太神秘，但我会尝试解释我真正想做的事情。

我有一个母版页“A”，它有子页“B”和“C”。这是用 ASP.NET 中的标准母版页模型实现的。

我的网站有两个主题“T1”和“T2”。他们实际上代表不同的合作伙伴，T1 是我们自己的公司，T2 是合作伙伴。

我想根据我使用的主题在“B”和“C”页上显示特定的内容。例如，我可能想在“B”页上插入额外的按钮或图形，专门用于主题“T2”的合作伙伴。根据页面本身，此内容将位于页面上的任意位置。一些合作伙伴甚至可能不会使用此功能。

问题是我想尽可能以声明方式执行此操作，并尽量减少页面对主题的了解。

这就是“反向”母版页概念的用武之地。**我想在子页面上定义一个可以插入“主题”特定内容的区域。**（我说的是“主题”，因为这就是 ASP.NET 使用的内容——而且很可能是我将内容绑定到的内容）。

所以你可能想知道：

*   为什么您不能为此使用母版页并添加额外的内容部分？原因是内容可能出现在页面上特定于该页面的位置的任何位置。
*   为什么不能使用“嵌套”母版页？本质上是一样的原因。

可能的解决方案：

我想知道创建某种用户控件，该控件将有一个文本键，表示将在那里插入什么类型的内容。用户控件必须知道要为每个“主题”显示什么——可能是通过动态创建相关的附加用户控件。

这似乎有点笨拙 - 所以我想知道其他人可能为类似情况创建了什么样的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T05:31:18.327

您可以使用 CSS 将内容部分放置在页面上的任何位置。所以我不会担心页面位置等。

如果是我，我只是将 2 个不同的 css 文件动态加载到一个母版页中，并基于相同的逻辑将不同的内容呈现到占位符中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T11:32:44.807

我目前正在一个具有类似要求的网站上工作，这些要求对 CSS 来说太多了。在一种布局中，登录是水平朝向呈现顺序的顶部，而在另一种布局中，它位于右侧列中。

我们使用标准的 ASP.NET 主题来推出 CSS、通过 SkinID 的徽标 URL 等。

为了获得自定义布局，我创建了一个“Loader”控件，该控件通过 Loader 属性中指定的列表加载 UserControls。该属性可以直接在加载器标记中定义，也可以通过主题中的 .skin 文件定义。

列表中的每个键都只是 UserControl 的基本名称（我添加了路径和扩展名）。这些控件是通过 Page.LoadControl() 创建的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T05:27:53.327

你有针对不同合作伙伴的固定布局吗？还是您希望合作伙伴在运行时选择布局？

如果布局是固定的，那么一种方法是创建 zen 风格的 CSS ( [http://www.csszengarden.com/](http://www.csszengarden.com/) )，然后根据客户/合作伙伴动态加载它。如果您希望合作伙伴在运行时修改布局，那么您可能想要使用 Webparts。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T11:40:19.127

您可以在 VS2008 中使用嵌套母版页！

看这里 -

[斯科特·格思里的博客](http://weblogs.asp.net/scottgu/archive/2007/07/09/vs-2008-nested-master-page-support.aspx)

# c++ - mem_fun 失败，pthread 和类 ptr

> ID：456588
> 
> 赞同：0
> 
> 时间：2009-01-19T05:14:40.873
> 
> 标签：c++, pthreads, std, member-functions

`pthread`接受作为它的参数`void *(*start_routine)(void* userPtr)`，我希望我可以用它`std::mem_fun`来解决我的问题，但我不能。

我想使用该功能`void * threadFunc()`并将其`userPtr`作为类`(userPtr->threadFunc())`。有没有类似于`std::mem_func`我可以使用的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T05:42:05.700

一种方法是使用调用主线程函数的全局函数：

```
class MyThreadClass {
public:
  void main(); // Your real thread function
};

void thread_starter(void *arg) {
  reinterpret_cast<MyThreadClass*>(arg)->main();
} 
```

然后，当您要启动线程时：

```
MyThreadClass *th = new MyThreadClass();
pthread_create(..., ..., &thread_starter, (void*)th); 
```

另一方面，如果您真的不需要手动使用 pthread，那么看看[Boost.Thread](http://www.boost.org/doc/libs/1_37_0/doc/html/thread.html)可能是个好主意，这是一个很好的 C++ 线程库。在那里，您可以获得线程、锁、互斥锁等类，并且可以以更加面向对象的方式进行多线程处理。

# asp.net - 如何保持 ASP.NET 用户控件的属性

> ID：456596
> 
> 赞同：0
> 
> 时间：2009-01-19T05:18:41.130
> 
> 标签：asp.net

我有一个托管“HtmlImage”的 ASP.NET 用户控件。src 属性在运行时设置成功，但是将呈现的控件添加到另一个容器会导致 src 属性丢失。

呈现的控件存储在 Session 中（我知道这并不理想）。然后重定向到另一个使用 Session 中的控件的页面。

也许是因为 url 没有编码？

代码：

```
<img id="ctlImage" runat="server" style="border-style: none;" />

ctlImage.Src = String.Format("..\image.aspx?{0}", "...") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T05:21:03.340

您是否尝试过使用 asp:Image 控件而不是普通的旧 img 标签？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T21:41:16.263

这可能是因为 HtmlControls（包括 HtmlImage）的属性存储在 ViewState 中。ViewState 不会被发送到其他页面似乎是合理的。

与其将控件存储在 Session 中，不如直接存储生成的 html 代码？轻了很多。

# php - 使用实时 HTTP 标头

> ID：456599
> 
> 赞同：4
> 
> 时间：2009-01-19T05:20:12.030
> 
> 标签：php, curl, http-headers, live

在网站上，我在表单中输入一些参数，单击搜索，然后得到一个页面，其中包含“正在检索您的结果”消息。搜索完成后，我会看到另一个页面，其中显示了我的结果。

我正在尝试以编程方式重新创建它，并使用 Live HTTP Headers 来了解背后发生的事情，即 url、表单变量等。但是，我只获得有关显示“检索结果”的页面的信息。Live HTTP Header 没有向我提供包含最终结果的页面的信息。

我能做些什么来获得最后一点信息（即 url、表单变量等）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T05:39:20.933

我使用[Charles HTTP Proxy](http://www.charlesproxy.com/)来满足我所有的 HTTP 故障排除需求。它有很多选项，适用于任何浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T10:46:24.417

这听起来很奇怪？我很确定 LiveHttpHeaders 应该显示这一点。你能仔细检查一下你没有遗漏什么吗？否则尝试使用 Firebug。它有一个“网络”选项卡，显示所有请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T11:00:44.793

I'm using [Fiddler2](http://www.fiddler2.com/fiddler2/), which is a free (as in beer), highly configurable proxy; works with all browsers, allows header inspection/editing/automodification on request/response.

Disclaimer: I'm in no way affiliated with Fiddler, just a (very happy) user.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T11:14:52.003

I for such problems always fire-on an [Ethereal](http://www.ethereal.com/) or similar network spying tool, to see exactly, what is going on.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T07:25:22.480

@马克哈里森

我已经安装了 webdeveloper。最初，我使用它来关闭元重定向和引荐来源网址，以便更清楚地了解 http 交互。但是当我这样做时，该网站无法运行（即它无法完成检索我的搜索结果的过程）所以我重新打开它。

我想知道是否有人必须为在用户输入页面和结果页面之间有处理页面的网站捕获 http 信息

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T05:30:53.320

“Web 开发人员”这样做：

[https://addons.mozilla.org/en-US/firefox/addon/60](https://addons.mozilla.org/en-US/firefox/addon/60)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T12:58:57.097

该文档正在创建一个名为 XMLHTTPRequest 的浏览器组件，在提交事件时调用对象方法 send()，在等待服务器响应期间，html 元素被替换为“等待消息”成功响应时调用回调html 元素，然后插入到选定的 html 元素中。（这称为ajax）。

如果您想遵循该过程，您可以使用[Firefox Live HTTP Headers Extension](https://addons.mozilla.org/en-US/firefox/addon/3829)或[Wireshark](http://www.wireshark.org/)来查看完整的 HTTP 标头和操作 (get/post/)。

# c - C/Objective-C 中的 ANSI 颜色提取库

> ID：456604
> 
> 赞同：4
> 
> 时间：2009-01-19T05:23:41.900
> 
> 标签：c, objective-c, cocoa

我正在寻找一个库，或者我可以合并到 Cocoa 项目中的一些代码，我可以将带有 ansi 颜色控制代码的文本流转换为属性字符串。有很多项目可以做到这一点，但是在检查了他们的代码之后，它们要么是混乱的，要么是过于复杂的。有没有人知道我可以用一段*简单*的代码、库或框架来完成这个简单的任务？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-11T11:20:43.267

我编写了一个类（称为[ANSIEscapeHelper](http://hasseg.org/ansiEscapeHelper/)）来在`NSStrings`包含 ANSI 转义序列和类似格式的`NSAttributedStrings`. 它是在 MIT 许可下发布的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T09:49:32.487

我不知道库或框架。我认为这样做不会太难——我是 Cocoa 的新手，但我可能会走正则表达式处理路径。

# c# - 如何最好地在 C# 中构造类层次结构以启用对父类成员的访问？

> ID：456616
> 
> 赞同：1
> 
> 时间：2009-01-19T05:33:29.447
> 
> 标签：c#

我在决定如何最好地在 C# (.NET 3.5) 中描述某个数据结构时遇到了几个问题。

我必须创建一个类库，为命令行程序的输入创建一些文本文件。有几十种文件类型，但大多数都有类似的页眉、页脚和其他一些属性。

所以一个文件可能看起来像这样：

```
timestamp filename company

....lots of attributes that make up the file body....

footerdetail1 footerdetail2 footerdetail3 
```

现在，在这几十种文件类型中，实际上只有三个独特的页眉/页脚组合。

所以我想创建一个包含大部分 headerItems 和 footeritems 的父类，然后在派生类中实现实际的文件类型：

```
class BaseFileType {

public List<HeaderItems>; 
public List<BodyItems>;   
public List<FooterItems>;
FileType filetype;
String filename;

public BaseFileType1 (FileType filetype,String filename) {

   this.filetype = filetype;
   this.filename = filename;

   // add stuff to the header list
   // add stuff to the footer list

} 

    // some methods to find items in the header/ footer lists

}

class ActualFile1 : BaseFileType {

    ActualFile() {

    //add stuff to the bodyitems list
    }

    //some other generic methods

} 
```

问题是，我想从派生类的基类继承构造函数，但是从我所读到的内容来看这是无法做到的。这里最好的策略是什么？

我已经看到我可以从派生类构造函数中调用基本构造函数，如下所示：

ActualFile() ：基础（父参数）

这甚至是完成我的任务的最佳方式吗？最后，我只是在为所有这些文件信息寻找最好的数据结构，所以当我制作这些类时我不需要重复自己。

人事物的其他替代方法会起作用吗？有一个 FileFactory 可以吐出包含我需要的结构的类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T05:41:56.370

正如您所说，构造函数不是继承的。

如果您需要在构造期间知道值，则强制派生类在构造函数中提供详细信息将是理想的情况。如果不这样做，请考虑派生类必须提供的抽象属性：

```
// base-class
public abstract FileType FileType {get;}

// derived-class
public override FileType FileType {
    get {return FileType.Excel;} // or whatever
} 
```

请注意，除非您**非常**清楚地记录它（并理解其含义），否则您不应该在构造函数中调用虚方法（例如上面的方法）（因为派生类型的构造函数尚未执行） - 但之后就可以了.

由于文件名并不真正依赖于子类型，因此我怀疑我会将其保留为 ctor 参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T05:57:43.093

您可以创建读取页眉和页脚的基类，并提供对中间属性的访问。然后定义一个接口，几十个特定的属性读取器将实现。该接口可能需要接受“基类”，并且每个实现都将定义如何读取中间的内容。

在实践中，您将有一种通用的方式来读取通用部分和一种通用的方式来访问属性。这部分是松散耦合的，因此更改的限制性较小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T06:42:06.110

这看起来像是模板方法可以解决的问题......（终于可以使用模式了：）

```
public abstract class DocumentGenerator
{
  abstract protected void AddHeader();
  abstract protected void AddBody();
  abstract protected void AddFooter();

  // Template Method http://en.wikipedia.org/wiki/Template_method_pattern
  public FileInfo Generate(string sFileName)
  {
    FileInfo f = null;  
    //create file

    // either pass in the file to the below methods or use member vars + an additional write step 
    AddHeader();
    AddBody();
    AddFooter();

    // write out everything to the file
    return f;
  }
} 
```

接下来对于 3 种独特组合中的每一种，中级课程如

```
abstract public class UniqueHeaderFooterCombination1 : DocumentGenerator
{
  protected override void AddHeader()
  {
    Console.WriteLine("unique combination1 header");
  }
  protected override void AddFooter()
  {
    Console.WriteLine("unique combination1 footer");
  }
} 
```

最后是每个唯一文件类型的具体类

```
public class LetsSayCSVGenerator : UniqueHeaderFooterCombination1
{
  protected override void AddBody()
  {
    Console.WriteLine("csv body items");
  }
} 
```

将此与 Factory 结合起来，为 FileType 返回正确类型的生成器，您就完成了。

```
abstract class DocumentGeneratorFactory
{
  public static DocumentGenerator GetGenerator(FileType eFileType)
  {
    switch (eFileType)
    {
      // a hash of FileType => Generator
      default:
        return new LetsSayCSVGenerator();
    }

  }
}

class Program
{
  static void Main(string[] args)
  {
    DocumentGenerator d = DocumentGeneratorFactory.GetGenerator(FileType.CSV);
    FileInfo f = d.Generate("ItsAlive.CSV");
  }
} 
```

# .net - 将属性与 .net 中的代码生成属性相关联

> ID：456624
> 
> 赞同：18
> 
> 时间：2009-01-19T05:36:26.070
> 
> 标签：.net, attributes, code-generation

我希望在 .NET 中的公共属性上设置一个属性，但是我无权访问显式属性本身，因为这是在另一个文件中生成的代码。

我有这个领域：

```
public virtual string Name { get; set; } 
```

我想设置这个：

```
[ValidateNonEmpty("Name is required", ExecutionOrder = 1)]
public virtual string Name { get; set; } 
```

我的课程被标记为部分，但你不能有部分属性。我以为我正在使用 MetadataType 类，它是动态数据和 DataAnnotations 的一个新功能，但是我觉得它只能与动态数据一起使用，这是真的吗？

引文： http: [//blogs.oosterkamp.nl/blogs/jowen/archive/2008/10/16/metadatatype-attribute.aspx](http://blogs.oosterkamp.nl/blogs/jowen/archive/2008/10/16/metadatatype-attribute.aspx) [http://blogs.msdn.com/davidebb/archive/2008/06/16/dynamic -data-and-the-related-metadata-class.aspx](http://blogs.msdn.com/davidebb/archive/2008/06/16/dynamic-data-and-the-associated-metadata-class.aspx)

有什么方法可以设置这个属性（甚至通过 web.config！）而不接触代码生成的类？

在此先感谢，格雷厄姆

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-19T05:54:37.173

这是一个已知的麻烦。您根本无法将元数据添加到生成的成员。

这里有 6 个选项（按努力增加的顺序）：

*   如果您拥有该属性，则可以针对该类声明它，例如：`[ValidateNonEmpty("Name", "Name is required", ExecutionOrder = 1)]`- 然后将多个属性添加到部分类定义中
*   使用 virtual/interface/etc 方法来查询这个，而不是通过属性
*   子类化生成的类型；覆盖或重新声明成员，添加元数据（真的很乱）
*   使用自定义`TypeDescriptionProvider`提供动态元数据（大量工作） - 假设消费者尊重`TypeDescriptor`；大多数与绑定相关的消费者都这样做，但例如，`Expression`（许多 LINQ 提供者使用）没有
*   更改代码生成器/编写自己的
*   尝试扩展 PostSharp 之类的东西来完成这项工作（我还没有找到这样做的方法，但我很想听听你是否找到方法！）

我通常会成功使用第一个选项，除非它是系统定义的属性（`[DisplayName]`等）。如果`[ValidateNonEmpty]`由动态数据定义，那么您可能无法做到这一点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-10-16T10:04:24.077

由于生成的类是一个部分类，以下应该可以工作：

1.  创建一个在其中声明此属性的接口，并使用 ValidateNonEmpty 属性对其进行装饰。
2.  创建您自己的与 AutoGenerated 类同名的分部类，并使其实现您刚刚创建的接口。
3.  该属性现在应该使用该属性进行装饰

例如：

```
// Decorate the properties with attributes as required
public interface IMyInterface
{
    [ValidateNonEmpty("Name is required")]
    string Name { get; set; }
}

// This is the partial class I created, that implements the interface
public partial class MyGeneratedClass : IMyInterface
{    
}

// This is the auto-generated class
public partial class MyGeneratedClass
{
    public virtual string Name { get; set; }
} 
```

我从[geekswithblogs](http://geekswithblogs.net/Martinez/archive/2011/09/26/howtoaddattributestoclassesgeneratedbylinq2sqlorentityframework.aspx)得到这个想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-07T16:24:01.993

这是一个很好的解决方案，但它对我的问题不起作用。我将 EF 6 与现有数据库中的代码优先生成的类一起使用。表中的一列是具有自动生成值的 IDENTITY。但是，生成的部分类没有提供让数据库生成密钥所需的**[DatabaseGenerated(DatabaseGeneratedOption.Identity)]属性。**结果是错误“*当 IDENTITY_INSERT 设置为 OFF 时，无法在表 'mytable' 中插入标识列的显式值。* ”。我尝试了您的解决方案，但没有奏效。但是，如果我将属性添加到原始生成的类中，它确实有效。所以我仍在尝试寻找不需要修改自动生成文件的解决方案。

这是我尝试使用您的解决方案的代码：

```
public interface IMyTable
{
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    int ID { get; set; }
}

public partial class MyTable : IMyTable
{
} 
```

原始生成代码：

```
[Table("MyTable")]
public partial class MyTable
{
    [Key]
    [Column(Order = 1)]
    public int ID { get; set; }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-15T04:14:06.607

另一种选择是将属性包装在同一类中的非生成属性中。不理想，因为您最终可能会拥有双重属性，但如果您可以让生成器生成受保护的属性，那将是一个非常好的方法。

只需要处理这个问题：实体框架生成类，我想用更简单的名称将它们序列化为 JSON。

```
// GENERATED BY EF
public partial class ti_Users
{
    public ti_Users()
    {
        this.ti_CardData = new HashSet<ti_CardData>();
        this.ti_Orders = new HashSet<ti_Orders>();
    }

    protected int userId { get; set; }
    protected string userName { get; set; }
    protected string userEmail { get; set; }
    protected string userPassHash { get; set; }
    protected Nullable<System.DateTime> userLastLogin { get; set; }
    protected string userLastIP { get; set; } 

    public virtual ICollection<ti_CardData> ti_CardData { get; set; }
    public virtual ICollection<ti_Orders> ti_Orders { get; set; }
} 
```

和附加类：

```
[JsonObject(memberSerialization: MemberSerialization.OptIn)]
public partial class ti_Users
{
    [JsonProperty]
    public int UserId
    {
        get { return this.userId; }
        set { this.userId = value; }
    }

    [JsonProperty]
    public string Name
    {
        get { return this.userName; }
        set { this.userName = value; }
    }

    [JsonProperty]
    public string Email
    {
        get { return this.userEmail; }
        set { this.userEmail = value; }
    }

    [JsonProperty]
    public string PassHash
    {
        get { return this.userPassHash; }
        set { this.userPassHash = value; }
    }
} 
```

# c# - .NET Remoting：如何从远程对象访问服务器应用程序对象？

> ID：456628
> 
> 赞同：2
> 
> 时间：2009-01-19T05:39:32.867
> 
> 标签：c#, .net, remoting

我正在编写一个 Windows 服务应用程序，它将通过 .NET Remoting 访问。问题是我不知道如何从远程类访问服务对象。

例如，我有一个处理程序类：

```
class Service_console_handler
   {
    public int something_more = 20;

    //some code...

            TcpChannel serverChannel = new TcpChannel(9090);
            ChannelServices.RegisterChannel(serverChannel);
            RemotingConfiguration.RegisterWellKnownServiceType(
                        typeof(RemoteObject), "RemoteObject.rem", 
                        WellKnownObjectMode.Singleton);

    //from here on RemoteObject is accessible by clients.
    //some more code doing something and preparing the data...
   } 
```

我有一个远程课程：

```
public class RemoteObject : MarshalByRefObject
{
    private int something = 10;

    public int Get_something()
    {
        return something;
    }
} 
```

客户端可以毫无问题地访问 RemoteObect 中的数据。但是我怎样才能访问`Service_console_handler`对象（即从中检索有用的信息`something_more`）？

对不起，愚蠢的问题，并在此先感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T23:14:09.010

你想要的是以某种方式`ServiceConsoleHandler`通过实例访问`RemoteObject`实例，这对客户端是可见的。

为此，您需要考虑两件事：(1) 控制`RemoteObject`实例的对象构造并使其可访问；(2) 进行修改`ServiceConsoleHandler`以便可以远程访问它。

## (1)

如果您不需要考虑远程处理，您将如何在 中构建`RemoteObject`实例？`ServiceConsoleHandler`

我猜你会做这样的事情：

```
class ServiceConsoleHandler
{
   …
   RemoteObject remoteObject = new RemoteObject();
   // now assume that you also already have
   // modified the RemoteObject class so it can hold
   // a reference to your server:
   remoteObject.Server = this;
   …
} 
```

如果您可以使该对象可供客户端访问，那就太好了。您可以通过使用[RemotingServices.Marshal](http://msdn.microsoft.com/en-us/library/sc4fc258.aspx)而不是 RemotingConfiguration.RegisterWellKnownServiceType 来做到这一点：

```
class ServiceConsoleHandler
{
     …
     TcpServerChannel channel = new TcpServerChannel(9090);
     ChannelServices.RegisterChannel(channel, true);
     RemoteObject remoteObject = new RemoteObject();
     remoteObject.Server = this;
     RemotingServices.Marshal(remoteObject, "RemoteObject.rem");
     …
} 
```

## (2)

如果您现在执行代码并访问`remoteObject.Server`客户端代码中的 ，您会得到一些远程异常，因为`ServiceConsoleHandler`无法远程访问该类。因此，您需要添加`[Serializable]`属性：

```
[Serializable]
class ServiceConsoleHandler
{ … } 
```

原因：应该远程访问的类型需要被编组为一些特殊的可传输表示。这样它们就可以通过 TCP 端口被挤压并通过 TCP 协议传输。基本数据类型可以由框架编组，因此您无需考虑它们。对于自定义类型，您需要说明如何执行此操作。一种方法是从`MarshalByRefObject`. 这正是您已经完成的`RemoteObject`。另一种方法是`[Serializable]`如上所示标记您的自定义类。

而已。现在您应该能够访问客户端代码中的服务器字段。请注意，您不需要现有代码来激活对象：

```
 TcpClientChannel channel = new TcpClientChannel();
        ChannelServices.RegisterChannel(channel, true);

        RemoteObject remoteObject = (RemoteObject)Activator.GetObject(
            typeof(RemoteObject), "tcp://localhost:9090/RemoteObject.rem");

        Console.WriteLine(remoteObject.Server.SomethingMore); 
```

对我来说，.NET 远程处理充满了有趣的惊喜和不眠之夜。为了解决这个问题，请让自己熟悉远程处理概念（从我的角度来看，这些概念记录得很差）。深入研究序列化概念（`MarshalByRefObject`vs. `[Serializable]`）。如果您想从中制作生产代码，请考虑一种处理远程异常的非常好的方法。还要考虑多线程。一次可能有多个客户端使用此远程对象。

玩得开心！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T02:51:17.620

谢谢！我非常感谢您回答的彻底和清晰。

最奇怪的是我什至不知道你可以发布对象实例。我研究过的大约十几个简单的教程被提议`RemotingConfiguration.RegisterWellKnownServiceType`作为进行远程处理的唯一方法。愚蠢的我。

现在远程处理对我来说看起来更有用。我刚刚写了一个快速测试应用程序，它工作。再次感谢。

# rest - RESTful Grails：如何在我的 XML 中包含相关实体？

> ID：456633
> 
> 赞同：3
> 
> 时间：2009-01-19T05:43:09.660
> 
> 标签：rest, grails, groovy

假设我有一个名为 Store 的类，它有很多员工。我的 RESTful listXML 方法如下所示：

```
def listXML = {
    render Store.list() as XML
} 
```

结果如下所示：

```
<stores>
  <store id="1">
   <name>My Store</name>
   <employees>
     <employee id="1" />
   </employees>
  </store>
</store> 
```

我的问题是，如何包含每个 Employee 类的所有数据，以便我的 XML 看起来像这样？

```
 <stores>
      <store id="1">
       <name>My Store</name>
       <employees>
         <employee id="1">
           <name>John Smith</name>
           <hireDate>2008-01-01</hireDate>
         </employee>
       </employees>
      </store>
    </store> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T05:45:02.480

在您的控制器中，您需要导入深度转换器：

```
import grails.converters.deep.XML 
```

[您可以在Converters Reference](http://grails.org/Converters+Reference)的前几段中了解它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T10:32:50.763

从 Grails 1.1 开始，您可以通过在 grails-app/conf/Config.groovy 中包含它来将 Grails 配置为默认深度序列化：

```
grails.converters.xml.default.deep = true 
```

1.1 还为转换器引入了命名配置。深度转换器将被弃用，而应使用命名配置“深度”。

```
XML.use("deep") {
   render model as XML
} 
```

# c# - Visual Studio - 如何在调试器中更改方法的返回值？

> ID：456634
> 
> 赞同：9
> 
> 时间：2009-01-19T05:43:38.287
> 
> 标签：c#, .net, vb.net, visual-studio, debugging

在调试时，我经常不得不处理不使用中间变量来存储返回值的方法：

```
 private int myMethod_1()
   {
      return 12;
   }

   private int myMethod_2()
   {
      return someCall( someValue );
   } 
```

好吧，为了重现错误，我经常不得不即时更改值。在这里，我想看看`myMethode_1`返回零时会发生什么。同样的事情`myMethod_2`。

有没有办法在*不修改代码*的情况下做到这一点？我想做的是在返回行（或右括号）上放置一个断点并输入一个新的返回值。

注意：我使用的是 Visual Studio 2005 和 Visual Studio 2008。

谢谢 ！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T06:18:39.013

函数的返回值通常在 EAX 寄存器中返回。

如果您在函数末尾设置断点，那么更改 EAX 可能会更改返回值。您只需在监视窗口中写入名称即可更改和查看 Visual Studio 中的任何寄存器。
如果您对函数进行了优化，或者即使该函数很简单，例如`return 12`. 如果您返回的东西不适合 32 位寄存器，它也可能不起作用。至少值得一试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T06:44:38.163

**对于那些在 VB.NET 中寻找解决方案的人：**

它是如此简单，我不敢相信我没有看到它：查看函数将返回的值：只需将指针放在函数的名称上。该值将显示在工具提示中。

更改值：只需单击此工具提示，更改值并按 Enter。

Visual Studio 非常酷！

注意：我在 Visual Studio Team System 2008 上的 VB.NET 中对其进行了测试。刚刚尝试使用 C#，但它不起作用...... :-(

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T06:12:01.520

不要这么想。
您需要在被调用者或调用者中有一个临时变量，以便获取值的句柄以在 IDE 调试器/QuickWatch 窗口中修改它。因此，最简单和最快的方法是注释现有代码并临时更改调试假设。

任何一个

```
private int myMethod_1()
{
  var x = 12;
  return x;
} 
```

或者

```
private int myMethod_2()
{
  var y = someCall( someValue);
  return y;
} 
```

不要认为这样做值得“避免代码更改”的恶化。如果我 FUBAR，我会结帐，我们又是金子了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T06:01:01.870

为什么要更改被调用方法中的返回值？您可以在 Calling 方法中轻松地即时更改它。一旦你的函数返回，你就会得到返回的值，你可以在那里改变它。

```
   私有 int myMethod_1()
   {
      返回 12；
   }
//调用会是这样的
int x = myMethod_1();
//这里你可以在上面的行执行后改变值。

```

即使您没有将返回值存储在变量中，而是直接将其传递给其他方法，即使这样，您也可以通过进入该方法并在那里更改参数值来更改值。我在这里错过了什么吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T06:53:33.450

你需要的是模拟。检查模拟框架，如 Rhinomock、Moq 或 Typemock。

对于您所描述的那种场景，我将假设您可能没有干净的合同驱动的开发，并且可能需要以虚假的行为/状态返回。在这种情况下，Typemock 可能是您的最佳选择，尽管它是商业的

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-19T05:54:10.543

我认为你可以在 Visual Studio 中做到这一点，但这对我来说感觉很脏。

我的想法是，您真的应该研究一个单元测试框架并进行模拟，以便您可以将 myMethod_2 的输出伪造为 0 并查看它对您的代码有什么影响。国际海事组织。这样，您可以在单元测试中保留 return 0 检查，以确保丑陋的错误不会再次抬头。

# jar - 如何在执行时将参数传递给 jar 文件？

> ID：456636
> 
> 赞同：109
> 
> 时间：2009-01-19T05:44:46.927
> 
> 标签：jar

如何在执行时将参数传递给 JAR 文件？

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2009-01-19T06:27:21.193

将参数传递给 jar：

```
java -jar myjar.jar one two 
```

您可以在“Main-Class”的 main() 方法中访问它们（在`manifest.mf`JAR 文件中提到）。

```
String one = args[0];  
String two = args[1]; 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-01-19T06:20:54.233

[JAVA 文档](https://docs.oracle.com/en/java/javase/12/tools/jar.html#GUID-51C11B76-D9F6-4BC2-A805-3C847E857867)说：

> java [选项] -jar file.jar [参数...]

和

> ...类名或JAR文件名后的非选项参数传递给主函数...

也许您必须将参数放在单引号中。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-06-23T21:41:06.507

你可以用这样的东西来做，所以如果没有指定参数，它会继续：

```
public static void main(String[] args) {
    try {
        String one = args[0];
        String two = args[1];
    }
    catch (ArrayIndexOutOfBoundsException e){
        System.out.println("ArrayIndexOutOfBoundsException caught");
    }
    finally {

    }
} 
```

然后启动应用程序：

```
java -jar myapp.jar arg1 arg2 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-04-05T09:18:15.153

```
java [ options ] -jar file.jar [ argument ... ] 
```

如果您需要传递 log4j 属性文件，请使用以下选项

```
-Dlog4j.configurationFile=directory/file.xml

java -Dlog4j.configurationFile=directory/file.xml -jar <JAR FILE> [arguments ...] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-09-28T05:56:29.080

如果参数中有空格，您可以如下所示传递。

```
java -jar myjar.jar 'first argument' 'second argument' 
```

# c# - 使用带有 .html 文件扩展名的 HttpModule

> ID：456639
> 
> 赞同：1
> 
> 时间：2009-01-19T05:47:06.453
> 
> 标签：c#, asp.net, httpmodule

我需要访问 httpmodule 中的会话。当我的页面是 aspx 页面时它可以正常工作，但是当请求 url 为 .html 时 context.session 为 null 我将 .html 映射为使用 aspnet_isapi.dll

我正在尝试访问 context_PreRequestHandlerExecute 中的会话，并且我有 httpmodule 继承 IReadOnlySessionState

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T09:49:37.917

根据我的经验，IReadOnlySessionState 和 IRequiresSessionState 仅适用于 HttpHandlers。

有关如何实现它，请参阅以下 SO 链接：

[我可以从 HTTPModule 访问会话状态吗？](https://stackoverflow.com/questions/276355/can-i-access-session-state-from-an-httpmodule)

[IIS HttpModule 无法设置会话](https://stackoverflow.com/questions/427951/iis-httpmodule-unable-to-set-session)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-22T09:15:54.113

它不适用于 HTML 扩展，因为 aspnet_isapi.dll 不处理扩展，而是处理 .aspx 页面。

您应该使用另一个扩展而不是使用 HTML，并且应该在 IIS 应用程序配置（网站属性 -> 主目录选项卡 -> 配置按钮 -> 映射选项卡）中注册新的扩展。以 .aspx 为例，添加您自己的扩展名。

# mysql - MySQL 语法错误消息“操作数应包含 1 列”

> ID：456644
> 
> 赞同：24
> 
> 时间：2009-01-19T05:50:15.170
> 
> 标签：mysql, mysql-error-1241

我尝试运行以下语句：

```
INSERT INTO VOUCHER (VOUCHER_NUMBER, BOOK_ID, DENOMINATION)
SELECT (a.number, b.ID, b.DENOMINATION) 
FROM temp_cheques a, BOOK b
WHERE a.number BETWEEN b.START_NUMBER AND b.START_NUMBER+b.UNITS-1; 
```

据我了解，应该将 temp_cheques 中的每条记录插入到 VOUCHER 中，其中 ID 和 DENOMINATION 字段对应于 BOOK 表中的条目（temp_cheques 来自数据库备份，我试图以不同的格式重新创建）。但是，当我运行它时，我收到一个错误：

```
Error: Operand should contain 1 column(s)
SQLState:  21000
ErrorCode: 1241 
```

我在 SQuirrel 中运行它并且没有遇到任何其他查询的问题。我的查询语法有问题吗？

编辑：

BOOK的结构是：

```
ID  int(11)
START_NUMBER    int(11)
UNITS   int(11)
DENOMINATION    double(5,2) 
```

temp_cheques 的结构是：

```
ID  int(11)
number  varchar(20) 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-01-19T06:34:55.360

尝试从 SELECT 子句中删除括号。在[Microsoft TechNet](http://technet.microsoft.com/en-us/library/ms188263.aspx)中，使用 SELECT 子句的 INSERT 语句的正确语法如下。

```
INSERT INTO MyTable  (PriKey, Description)
       SELECT ForeignKey, Description
       FROM SomeView 
```

* * *

你得到的错误，“SELECT 会检查超过 MAX_JOIN_SIZE 行；检查你的 WHERE 并使用 SET SQL_BIG_SELECTS=1 或 SET SQL_MAX_JOIN_SIZE=# 如果 SELECT 没问题。”，实际上是正确的，假设你在两者都有很多行BOOK 和 temp_cheques。您正在尝试查询两个表中的所有行并进行交叉引用，从而产生 m*n 大小的查询。SQL Server 会在执行可能较长的操作之前尝试警告您这一点。

在运行此语句之前设置`SQL_BIG_SELECTS`= 1，然后重试。它应该可以工作，但请注意，此操作可能需要很长时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T05:58:48.490

B 是否包含 UNITS 列？

temp_cheques 和 Book 的表结构是什么？

编辑：正如我在评论中所说，在进行 +/- 和比较时，所有列都应该是数字。
以下简单的 SELECT 是否有效？

`SELECT b.START_NUMBER+b.UNITS-1 FROM Books B`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T06:11:29.057

我没有方便的 MySQL 实例，但我的第一个猜测是 WHERE 子句：

```
WHERE a.number BETWEEN b.START_NUMBER AND b.START_NUMBER+b.UNITS-1; 
```

我想 MySQL 解析器可能将其解释为：

```
WHERE number
(BETWEEN start_number AND start_number) + units - 1 
```

尝试将所有内容都括在括号中，即：

```
WHERE a.number BETWEEN b.START_NUMBER AND (b.START_NUMBER + b.UNITS - 1); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T06:33:19.717

查询的最终版本如下：

```
Set SQL_BIG_SELECTS = 1;
INSERT INTO VOUCHER (VOUCHER_NUMBER, BOOK_ID, DENOMINATION)
SELECT a.number, b.ID, b.DENOMINATION
FROM temp_cheques a, BOOK b
WHERE a.number BETWEEN b.START_NUMBER AND (b.START_NUMBER+b.UNITS-1); 
```

BETWEEN 语句的解析需要括号，SELECT 不需要，并且由于两个表的大小（temp_cheques 中的 215000 条记录，BOOK 中的 8000 条记录）我打破了选择大小的限制，要求我设置 SQL_BIG_SELECTS = 1 .

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-04T07:19:52.193

我在使用 Spring Repositories 时遇到了同样的错误。

我的存储库包含一个方法，如：

```
List<SomeEntity> findAllBySomeId(List<String> ids); 
```

这在针对内存数据库 (h2) 运行集成测试时工作正常。然而，对于像 MySql 这样的独立数据库，却因同样的错误而失败。

我通过将方法接口更改为：

```
List<someEntity findBySomeIdIn(List<String> ids); 
```

`find`注意：和之间没有区别`findAll`。如此处所述： [Spring Data JPA 之间 findBy / findAllBy 的区别](https://stackoverflow.com/a/37321365/1546042)

# php - jQuery：print_r() 显示等效？

> ID：456646
> 
> 赞同：64
> 
> 时间：2009-01-19T05:51:43.200
> 
> 标签：php, jquery, debugging

> **可能重复：**
> [JavaScript 数据格式/漂亮的打印机](https://stackoverflow.com/questions/130404/javascript-data-formatting-pretty-printer)

我有点厌倦了在 FireBug 中查看未格式化的 json blob。

有谁知道 jQuery 的 PHP 的 print_r() 等价物？

可以从对象或数组递归地生成显示字符串的东西，我可以在页面上显示以进行快速调试？

谢谢！

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-01-19T06:00:43.090

[`console.log`](http://getfirebug.com/wiki/index.php/Console_API#console.log.28object.5B.2C_object.2C_....5D.29)是我调试时最常使用的。

不过我能找到这个[`jQuery extension`](http://plugins.jquery.com/taxonomy/term/471)。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-01-19T06:11:39.713

您可以非常轻松地使用[反射](http://pietschsoft.com/post/2008/02/Simple-JavaScript-Object-Reflection-API-(NET-Style).aspx)来列出所有属性、方法和值。

对于基于 Gecko 的浏览器，您可以使用 .toSource() 方法：

```
var data = new Object();
data["firstname"] = "John";
data["lastname"] = "Smith";
data["age"] = 21;

alert(data.toSource()); //Will return "({firstname:"John", lastname:"Smith", age:21})" 
```

但是既然你使用了 Firebug，为什么不直接使用 console.log 呢？

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-11-01T14:05:52.143

怎么样：

```
<script src='http://code.jquery.com/jquery-latest.js'></script>

function print_r(o){
return JSON.stringify(o,null,'\t').replace(/\n/g,'<br>').replace(/\t/g,'&nbsp;&nbsp;&nbsp;'); } 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-19T06:25:44.053

你也可以做

```
console.log("a = %o, b = %o", a, b); 
```

其中 a 和 b 是对象。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-01-17T15:38:23.250

我制作了一个 jQuery 插件，相当于

```
<pre>
<?php echo print_r($data) ?>
</pre> 
```

您可以在[https://github.com/tomasvanrijsse/jQuery.dump下载它](https://github.com/tomasvanrijsse/jQuery.dump)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-07-10T06:28:58.317

```
$.each(myobject, function(key, element) {
    alert('key: ' + key + '\n' + 'value: ' + element);
}); 
```

这对我有用。:)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-04-18T21:03:04.107

顶部评论有一个指向 Firebug 的 console.log 文档的断开链接，所以这里是[关于 Console 的 wiki 文章的链接](http://getfirebug.com/wiki/index.php/Console_API#console.log.28object.5B.2C_object.2C_....5D.29)。我开始使用它并且对它作为 PHP 的 print_r() 的替代品非常满意。

另外值得注意的是，即使您没有手动记录它们，Firebug 也可以让您访问返回的 JSON 对象：

*   在控制台中，您可以看到 AJAX 响应的 url。
*   单击三角形以展开响应并查看详细信息。
*   单击详细信息中的 JSON 选项卡。
*   您将看到以扩展三角形组织的响应数据。

此方法需要多点击几次才能获取数据，但不需要在您的实际 javascript 中添加任何内容，并且不会将您在 Firebug 中的焦点转移到控制台之外（使用 console.log 创建指向 firebug 的 DOM 部分的链接，强制您点击后返回控制台）。

为了我的钱，当我想检查而不是弄乱日志时，我宁愿多点击几次，特别是因为通过不添加任何额外的杂物来保持控制台整洁。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-03-05T18:43:22.197

看看这个： http: [//phpjs.org/functions/index](http://phpjs.org/functions/index)并找到 print_r 或使用带有 firebug 的 console.log()。

# python - 使用 urllib2 进行节流

> ID：456649
> 
> 赞同：12
> 
> 时间：2009-01-19T05:53:58.250
> 
> 标签：python, urllib2, bandwidth-throttling

使用时是否可以轻松限制 kbps `urllib2`？如果是这样，您可以指导我访问的任何代码示例或资源将不胜感激。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-19T06:06:17.040

模块中有`urlretrieve(url, filename=None, reporthook=None, data=None)`功能`urllib`。如果您将`reporthook`-function/object 实现为[令牌桶](http://en.wikipedia.org/wiki/Token_bucket "维基百科：令牌桶")或漏桶，则您有全局速率限制。

**编辑：**经过仔细检查，我发现进行全局速率限制并不`reporthook`像我想象的那么容易。`reporthook`仅给出下载量和总大小，这本身不足以提供与令牌桶一起使用的信息。解决它的一种方法是将最后下载的数量存储在每个速率限制器中，但使用全局令牌桶。

* * *

**编辑 2：**将两个代码合并为一个示例。

```
"""Rate limiters with shared token bucket."""

import os
import sys
import threading
import time
import urllib
import urlparse

class TokenBucket(object):
    """An implementation of the token bucket algorithm.
    source: http://code.activestate.com/recipes/511490/

    >>> bucket = TokenBucket(80, 0.5)
    >>> print bucket.consume(10)
    True
    >>> print bucket.consume(90)
    False
    """
    def __init__(self, tokens, fill_rate):
        """tokens is the total tokens in the bucket. fill_rate is the
        rate in tokens/second that the bucket will be refilled."""
        self.capacity = float(tokens)
        self._tokens = float(tokens)
        self.fill_rate = float(fill_rate)
        self.timestamp = time.time()
        self.lock = threading.RLock()

    def consume(self, tokens):
        """Consume tokens from the bucket. Returns 0 if there were
        sufficient tokens, otherwise the expected time until enough
        tokens become available."""
        self.lock.acquire()
        tokens = max(tokens,self.tokens)
        expected_time = (tokens - self.tokens) / self.fill_rate
        if expected_time <= 0:
            self._tokens -= tokens
        self.lock.release()
        return max(0,expected_time)

    @property
    def tokens(self):
        self.lock.acquire()
        if self._tokens < self.capacity:
            now = time.time()
            delta = self.fill_rate * (now - self.timestamp)
            self._tokens = min(self.capacity, self._tokens + delta)
            self.timestamp = now
        value = self._tokens
        self.lock.release()
        return value

class RateLimit(object):
    """Rate limit a url fetch.
    source: http://mail.python.org/pipermail/python-list/2008-January/472859.html
    (but mostly rewritten)
    """
    def __init__(self, bucket, filename):
        self.bucket = bucket
        self.last_update = 0
        self.last_downloaded_kb = 0

        self.filename = filename
        self.avg_rate = None

    def __call__(self, block_count, block_size, total_size):
        total_kb = total_size / 1024.

        downloaded_kb = (block_count * block_size) / 1024.
        just_downloaded = downloaded_kb - self.last_downloaded_kb
        self.last_downloaded_kb = downloaded_kb

        predicted_size = block_size/1024.

        wait_time = self.bucket.consume(predicted_size)
        while wait_time > 0:
            time.sleep(wait_time)
            wait_time = self.bucket.consume(predicted_size)

        now = time.time()
        delta = now - self.last_update
        if self.last_update != 0:
            if delta > 0:
                rate = just_downloaded / delta
                if self.avg_rate is not None:
                    rate = 0.9 * self.avg_rate + 0.1 * rate
                self.avg_rate = rate
            else:
                rate = self.avg_rate or 0.
            print "%20s: %4.1f%%, %5.1f KiB/s, %.1f/%.1f KiB" % (
                    self.filename, 100\. * downloaded_kb / total_kb,
                    rate, downloaded_kb, total_kb,
                )
        self.last_update = now

def main():
    """Fetch the contents of urls"""
    if len(sys.argv) < 4:
        print 'Syntax: %s rate url1 url2 ...' % sys.argv[0]
        raise SystemExit(1)
    rate_limit  = float(sys.argv[1])
    urls = sys.argv[2:]
    bucket = TokenBucket(10*rate_limit, rate_limit)

    print "rate limit = %.1f" % (rate_limit,)

    threads = []
    for url in urls:
        path = urlparse.urlparse(url,'http')[2]
        filename = os.path.basename(path)
        print 'Downloading "%s" to "%s"...' % (url,filename)
        rate_limiter = RateLimit(bucket, filename)
        t = threading.Thread(
            target=urllib.urlretrieve,
            args=(url, filename, rate_limiter))
        t.start()
        threads.append(t)

    for t in threads:
        t.join()

    print 'All downloads finished'

if __name__ == "__main__":
    main() 
```

# ants - ANTS 4 OMP 中止错误

> ID：456654
> 
> 赞同：4
> 
> 时间：2009-01-19T05:57:11.847
> 
> 标签：ants

我已经下载了 ANTS 和 dotTrace 分析器的试用版。

在 ANTS 中进行分析时，程序在某个点停止，我在控制台窗口中收到此错误：

> 系统错误（-2147467259）：__kmp_setaffinity：SetThreadAffinityMask：未指定的错误
> 
> OMP 中止：检测到致命的系统错误。

dotTrace 中没有戏剧性的程序配置文件。错误是什么意思，是我的代码问题还是 ANTS 问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-11-20T16:34:24.987

ANTS Profiler needs to set the thread affinity to save having to implement complicated cross-thread synchronization that would slow down the application and introduce serious complication to the Profiler code.

This is done using the Win32 API function `SetThreadAffinityMask` -- the failure message leaves a lot to be desired, but what you could do as a workaround is open

> %userprofile%\Local Settings\Application Data\Red Gate\ANTS Performance Profiler 5\PerformanceProfilerSettings.xml

and change `UseThreadAffinity` to False.

If any problems occur during profiling, you could try downloading a third-party program to set the affinity for your application.

# silverlight - 在 Silverlight 中下载 html 文件

> ID：456663
> 
> 赞同：0
> 
> 时间：2009-01-19T06:01:46.533
> 
> 标签：silverlight

我正在尝试使用 WebClient 类从另一个网站下载 html 文件并将其呈现为文本流，但是我遇到了一个安全错误，我做错了什么，或者这是 Silverlights 安全性“功能的另一个” "

[代码]

命名空间 ImageScrape { 公共部分类 Page : UserControl { public Page() { InitializeComponent();

```
 }

    private void UserControl_Loaded(object sender, RoutedEventArgs e)
    {
        WebClient cl = new WebClient();
        cl.OpenReadCompleted += new OpenReadCompletedEventHandler(cl_OpenReadCompleted);
        cl.OpenReadAsync(new Uri(@"http://www.google.co.uk/",UriKind.Absolute));

    }

    void cl_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e)
    {
        testTextBlock.Text = e.Result.ToString();
    }
} 
```

}

[/代码]

编辑

谢谢大家，我真的希望我不必将其创建为 WCF 服务，因为 1）我只知道基础知识和 2）您可以使用此 .xap 而无需连接到中央服务器，主要是因为为此我没有可以在其上托管 WCF 服务的服务器。

有谁知道解决这个问题的方法，或者任何可以免费托管 WCF 服务的地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T06:11:51.787

我认为从 silverlight 客户端直接访问另一个站点存在安全问题。

最好的解决方法是将此代码移动到 Web 服务中，然后从那里将您需要的内容提供给客户端。

# asp.net - 在 ASP.net 中显示剪贴板信息

> ID：456667
> 
> 赞同：1
> 
> 时间：2009-01-19T06:06:05.137
> 
> 标签：asp.net, clipboard

我需要将剪贴板中的数据显示给可读控件。剪贴板数据可以是文本、文档或任何类型。控件应显示信息。

ASP.net 中是否有可用的控件

这是客户端剪贴板

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T16:57:15.400

您应该能够创建 Silverlight 2 控件并将其嵌入到您的网页中。使用正确的安全设置，这应该允许您间接访问剪贴板。

[使用 Silverlight 2 在剪贴板中存储文本](http://www.jeff.wilcox.name/2008/05/clipboard-access/)

[Silverlight 2 入门](http://silverlight.net/GetStarted/)

[有用的博客入门教程](http://jesseliberty.com/2008/03/18/tip-of-the-day-getting-started-with-silverlight-2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T06:13:17.807

你说的是哪个剪贴板？

服务器端剪贴板或客户端剪贴板（我假设它是客户端）。

据我所知，如果您只想显示有关剪贴板中保存的内容的信息 - javascript 具有您可以使用的剪贴板对象。它可能有安全限制（当您尝试访问客户端剪贴板时）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T06:17:13.553

服务器不可能从客户端的剪贴板中读取。因此，如果您的意思是**用户**在剪贴板（在服务器上）中拥有的内容：这是无法完成的。你也许可以用 javascript 做一些事情，但是 ASP.NET 作为一个细节在很大程度上变得无关紧要。

或者，这样说：你见过这样做吗？

通常，要让网站处理非文本数据，您需要使用文件/上传控件（浏览...）将数据发送到服务器。您可能想要调查此选项。

如果您在客户端需要更多功能，请考虑 Silverlight、Flash、ClickOnce 等（但尽量避免使用 OCX——这是一种死技术）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T07:23:13.610

可以在网页中嵌入 .NET Windows 窗体用户控件。使用它，您可能能够访问剪贴板以使数据可用于您的网页。

我不确定这是否可行，因为用户控件将以非常有限的权限运行，但值得一试。

# python - Python中的类工厂

> ID：456672
> 
> 赞同：73
> 
> 时间：2009-01-19T06:08:16.537
> 
> 标签：python, factory

我是 Python 新手，需要一些建议来实现以下场景。

我有两个课程用于在两个不同的注册商处管理域。两者都有相同的接口，例如

```
class RegistrarA(Object):
    def __init__(self, domain):
        self.domain = domain

    def lookup(self):
        ...

    def register(self, info):
        ... 
```

和

```
class RegistrarB(object):
    def __init__(self, domain):
        self.domain = domain

    def lookup(self):
        ...

    def register(self, info):
        ... 
```

我想创建一个域类，给定一个域名，根据扩展名加载正确的注册商类，例如

```
com = Domain('test.com') #load RegistrarA
com.lookup()

biz = Domain('test.biz') #load RegistrarB
biz.lookup() 
```

我知道这可以使用工厂函数来完成（见下文），但这是最好的方法还是使用 OOP 功能有更好的方法？

```
def factory(domain):
  if ...:
    return RegistrarA(domain)
  else:
    return RegistrarB(domain) 
```

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-01-19T06:49:03.443

我认为使用函数很好。

更有趣的问题是如何确定要加载哪个注册商？一种选择是拥有一个抽象基类 Registrar 类，该类具体实现子类，然后迭代其`__subclasses__()`调用`is_registrar_for()`类方法：

```
class Registrar(object):
  def __init__(self, domain):
    self.domain = domain

class RegistrarA(Registrar):
  @classmethod
  def is_registrar_for(cls, domain):
    return domain == 'foo.com'

class RegistrarB(Registrar):
  @classmethod
  def is_registrar_for(cls, domain):
    return domain == 'bar.com'

def Domain(domain):
  for cls in Registrar.__subclasses__():
    if cls.is_registrar_for(domain):
      return cls(domain)
  raise ValueError

print Domain('foo.com')
print Domain('bar.com') 
```

这将让您透明地添加新`Registrar`的 s 并将每个支持哪些域的决定委托给它们。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-19T06:39:00.390

假设您需要为不同的注册商提供单独的类（尽管在您的示例中并不明显），您的解决方案看起来还不错，尽管**RegistrarA**和**RegistrarB**可能共享功能并且可以从[Abstract Base Class](https://docs.python.org/3.7/library/abc.html)派生。

作为您的`factory`函数的替代方案，您可以指定一个字典，映射到您的注册器类：

```
Registrar = {'test.com': RegistrarA, 'test.biz': RegistrarB} 
```

然后：

```
registrar = Registrar['test.com'](domain) 
```

一个小问题：你不是真的在这里做一个类工厂，因为你返回的是实例而不是类。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-13T09:51:01.903

在 Python 中，您可以直接更改实际类：

```
class Domain(object):
  def __init__(self, domain):
    self.domain = domain
    if ...:
      self.__class__ = RegistrarA
    else:
      self.__class__ = RegistrarB 
```

然后以下将起作用。

```
com = Domain('test.com') #load RegistrarA
com.lookup() 
```

我成功地使用了这种方法。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2016-05-27T06:34:03.497

您可以创建一个“包装器”类并重载其`__new__()`方法以返回专用子类的实例，例如：

```
class Registrar(object):
    def __new__(self, domain):
        if ...:
            return RegistrarA(domain)
        elif ...:
            return RegistrarB(domain)
        else:
            raise Exception() 
```

此外，为了处理非互斥条件，这是其他答案中提出的一个问题，首先要问自己的问题是您是否希望扮演调度程序角色的包装类来管理条件，或者它将委托给专门的课程。我可以建议一种共享机制，其中专用类定义自己的条件，但包装器会像这样进行验证（假设每个专用类都公开一个类方法来验证它是否是特定域的注册器，is_registrar_for(. ..）如其他答案中所建议）：

```
class Registrar(object):
    registrars = [RegistrarA, RegistrarB]
    def __new__(self, domain):
        matched_registrars = [r for r in self.registrars if r.is_registrar_for(domain)]

        if len(matched_registrars) > 1:
            raise Exception('More than one registrar matched!')
        elif len(matched_registrars) < 1:
            raise Exception('No registrar was matched!')
        else:
            return matched_registrars[0](domain) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-06-05T18:10:20.310

我一直有这个问题。如果您的应用程序（及其模块）中嵌入了类，那么您可以使用函数；但是如果你动态加载插件，你需要一些更动态的东西——通过元类自动向工厂注册类。

这是我确定我最初从 StackOverflow 中提取的一种模式，但我仍然没有原始帖子的路径

```
_registry = {}

class PluginType(type):
    def __init__(cls, name, bases, attrs):
        _registry[name] = cls
        return super(PluginType, cls).__init__(name, bases, attrs)

class Plugin(object):
    __metaclass__  = PluginType # python <3.0 only 
    def __init__(self, *args):
        pass

def load_class(plugin_name, plugin_dir):
    plugin_file = plugin_name + ".py"
    for root, dirs, files in os.walk(plugin_dir) :
        if plugin_file in (s for s in files if s.endswith('.py')) :
            fp, pathname, description = imp.find_module(plugin_name, [root])
            try:
                mod = imp.load_module(plugin_name, fp, pathname, description)
            finally:
                if fp:
                    fp.close()
    return

def get_class(plugin_name) :
    t = None
    if plugin_name in _registry:
        t = _registry[plugin_name]
    return t

def get_instance(plugin_name, *args):
    return get_class(plugin_name)(*args) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-05T17:13:53.333

怎么样

```
class Domain(object):
  registrars = []

  @classmethod
  def add_registrar( cls, reg ):
    registrars.append( reg )

  def __init__( self, domain ):
    self.domain = domain
    for reg in self.__class__.registrars:
       if reg.is_registrar_for( domain ):
          self.registrar = reg  
  def lookup( self ):
     return self.registrar.lookup()    

Domain.add_registrar( RegistrarA )
Domain.add_registrar( RegistrarB )

com = Domain('test.com')
com.lookup() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-09-25T13:13:00.630

好的，这是基于 Alec Thomas 的答案的答案，经过修改和扩展：照顾多级继承和歧义。如果 _resolve 应该比简单的唯一性检查更复杂并且可能会更改，则它可以作为参数提供而不是类方法。

基类模块 bbb.py：

```
from __future__ import annotations

from abc import ABC, abstractmethod
from typing import Sequence, Type

class Base(ABC):

    def __init__(self, *args, **kwargs):
        ...

    @classmethod
    def isit(cls, _s: str) -> bool:
        return False

    @classmethod
    def from_str(cls, s: str, *args, **kwargs) -> Base:
        subs = cls._findit(s)
        sc = cls._resolve(s, subs)
        return sc(*args, **kwargs)

    @classmethod
    def _findit(cls, s: str) -> Sequence[Type[Base]]:
        subs = [cls] if cls.isit(s) else []
        subs += [ssc for sc in cls.__subclasses__() for ssc in sc._findit(s)]
        return subs

    @classmethod
    def _resolve(cls, s: str, subs: Sequence[Type[Base]]) -> Type[Base]:
        if len(subs) == 0:
            raise Exception(f'Cannot find subclass for {s}')

        if len(subs) > 1:
            raise Exception(
                f'Cannot choose unique subclass for {s}: {subs}')
        sc = subs[0]
        return sc

class B(Base):
    @classmethod
    def isit(cls, s: str) -> bool:
        res = s == 'b class'
        return res
    enter code here 
```

派生类模块 ccc.py：

```
from bbb import Base

class C(Base):
    @classmethod
    def isit(cls, s: str) -> bool:
        res = s == 'c class'
        return res

class CC(Base):
    @classmethod
    def isit(cls, s: str) -> bool:
        res = s == 'cc class'
        return res 
```

如何使用：

```
In [4]: from bbb import Base

In [5]: import ccc

In [6]: Base.from_str('b class')
Out[6]: <bbb.B at 0x1adf2665288>

In [7]: Base.from_str('c class')
Out[7]: <ccc.C at 0x1adf266a908>

In [8]: Base.from_str('cc class')
Out[8]: <ccc.CC at 0x1adf2665608> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-17T14:32:02.240

由于这些方法可能是共享的，因此使用一些基类是有意义的。 `getattr`可以在工厂函数中用于动态调用另一个类。

计算 registrartype 的逻辑不应该是这些类的一部分，而应该是一些辅助函数。

```
import sys

class RegistrarBase():
    """Registrar Base Class"""
    def __init__(self, domain):
        self.name = domain

    def register(self, info):
        pass

    def lookup(self):
        pass
    def __repr__(self):
        return "empty domain"

class RegistrarA(RegistrarBase):
    def __repr__(self):
        return ".com domain"

class RegistrarB(RegistrarBase):
    def __repr__(self):
        return ".biz domain"

def create_registrar(domainname, registrartype):
    try: 
        registrar = getattr(sys.modules[__name__], registrartype)
        return registrar(domainname)
    except:
        return RegistrarBase(domainname)

domain = create_registrar(domainname = 'test.com', registrartype='RegistrarA')    

print(domain)    
print(domain.name)
#.com domain
#test.com 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-05-25T08:02:46.127

*这里的元类隐式地在ENTITIES* dict中收集 Registar 类

```
class DomainMeta(type):
    ENTITIES = {}

    def __new__(cls, name, bases, attrs):
        cls = type.__new__(cls, name, bases, attrs)
        try:
            entity = attrs['domain']
            cls.ENTITIES[entity] = cls
        except KeyError:
            pass
        return cls

class Domain(metaclass=DomainMeta):
    @classmethod
    def factory(cls, domain):
        return DomainMeta.ENTITIES[domain]()

class RegistrarA(Domain):
    domain = 'test.com'
    def lookup(self):
        return 'Custom command for .com TLD'

class RegistrarB(Domain):
    domain = 'test.biz'
    def lookup(self):
        return 'Custom command for .biz TLD'

com = Domain.factory('test.com')
type(com)       # <class '__main__.RegistrarA'>
com.lookup()    # 'Custom command for .com TLD'

com = Domain.factory('test.biz')
type(com)       # <class '__main__.RegistrarB'>
com.lookup()    # 'Custom command for .biz TLD' 
```

# python - 如何处理在 Python 中的函数调用中提供错误数量的参数时发生的错误？

> ID：456673
> 
> 赞同：0
> 
> 时间：2009-01-19T06:09:47.407
> 
> 标签：python, function-call

当我在函数中给出错误数量的参数时，我会得到错误。我该如何处理？

我给了

```
def fun_name(...):
    try:
        ...

    except TypeError:
        print 'Wrong no of arg' 
```

它不工作。

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T06:13:08.320

调用者触发此异常，而不是接收者。

如果您希望接收函数显式检查参数计数，则需要使用可变参数：

```
def fun_name(*args):
  if len(args) != 2:
    raise TypeError('Two arguments required') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T06:13:24.390

您需要在调用函数的地方处理它。

```
try:
  fun_name(...)
except TypeError:
  print "error!" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T09:38:55.583

如果您使用错误数量的参数调用函数，则有两种可能性：

*   要么你设计你的函数来处理任意数量的参数。然后你应该知道如何处理额外的参数。亚历克托马斯的回答告诉你如何处理这个案子。
*   或者你的设计存在根本缺陷，你陷入了大麻烦。在这种情况下，捕捉错误无济于事。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-19T06:13:01.660

如果您删除这些`try...catch`部分，它应该向您显示它抛出了什么样的异常。

# sql - 在 Oracle ANSI 连接中混合使用“USING”和“ON”

> ID：456684
> 
> 赞同：8
> 
> 时间：2009-01-19T06:14:03.187
> 
> 标签：sql, oracle, ora-00918

我写了一个这样的 Oracle SQL 表达式：

```
SELECT
...
FROM mc_current_view a
JOIN account_master am USING (account_no)
JOIN account_master am_loan ON (am.account_no = am_loan.parent_account_no)
JOIN ml_client_account mca USING (account_no) 
```

当我尝试运行它时，Oracle 在“ON”自连接行中抛出错误：“ORA-25154：USING 子句的列部分不能有限定符”。

如果我省略“am”限定词，它会显示：“ORA-00918：列不明确定义”。

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-26T18:25:08.533

错误消息实际上是（惊喜！）告诉您问题出在哪里。一旦对特定列使用 USING 子句，就不能在查询的任何其他部分中为该列名使用列限定符/表别名。解决此问题的唯一方法是不要在查询中的任何地方使用 USING 子句，因为您必须在第二个连接条件上使用限定符：

```
SELECT
...
FROM mc_current_view a
JOIN account_master am ON (a.account_no = am.account_no)
JOIN account_master am_loan ON (am.account_no = am_loan.parent_account_no)
JOIN ml_client_account mca ON (a.account_no = mca.account_no); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-19T10:02:53.163

我的偏好是从不使用**USING**；始终使用**ON**。我喜欢我的 SQL 非常明确，并且我认为**USING**子句感觉少了一步。

在这种情况下，由于您`account_no`在`mc_current_view`,中出现错误`account_master`，`ml_client_account`因此无法解析实际的连接。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-14T18:45:46.823

使用更干净（imo），但仍然希望外部引用连接字段，如 org 示例或如下示例：

```
select A.field,
       B.field,
       (select count(C.number)
          from tableC C
         where C.join_id = join_id  -- wrong answer w/o prefix, exception with.
        ) avg_number
  from tableA A
  join tableB B using (join_id); 
```

它给出了错误的答案，因为子查询中的 join_id 意味着 C.join_id （匹配所有记录）而不是 A 或 B。也许解决的最佳方法可能只是允许显式引用 using，两全其美。由于这些情况，似乎有必要。

# c# - C# 应用程序 - 我应该将存储过程或 ADO.NET 与 C# 编程技术一起使用吗？

> ID：456689
> 
> 赞同：5
> 
> 时间：2009-01-19T06:17:50.357
> 
> 标签：c#, .net, sql-server, ado.net

我有一个正在创建的 C# 应用程序，它将所有数据存储在 SQL Server 中。

有时以编程方式进行数据更改对我来说更容易，有时在 SQL Server 数据库中存储过程和函数并调用它们更容易。

我对编程比较陌生，我不知道每种方法的微妙优点和/或缺点是什么。

我想我可能应该以一种或另一种方式做事，而不是使用多种方法。

我的代码开始看起来像是一个随机的想法集合，所有这些想法都被塞到了一个地方。对乔尔·斯波尔斯基没有冒犯。我喜欢他的书。

这是一个单独的项目，所以我可以重构任何我想让它变得更好的代码。所有选项都摆在桌面上。

谢谢，

J3r3myK

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-19T06:27:15.407

好吧，如果您将数据库视为对象或服务，则存储过程可以是额外的抽象级别或一组功能/方法。这可能是有益的，因为您可以隐藏底层实现细节并在需要时更改它而不会破坏应用程序（只要您单独离开界面，例如存储的过程参数）。此外，如果您可以将表详细信息隐藏在一组存储过程后面，那么无论有人如何访问您的数据库，他们都只能使用您为其设计和编写的方法与它进行交互 --> 更少有人启动 Excel 并侵入您的数据库的风险。

另一方面，存储过程需要广泛的 T-SQL 知识，并且您将在两组代码库中传播您的业务和应用程序逻辑，这可能是一个缺点。您可以在存储过程中执行的任何操作也可以在 ADO.NET 中使用直接 SQL 语句完成，而且速度不再慢了。

Stored Procs 的另一个优点是，如果您的 proc 出现问题，您可以仅通过部署带有修复程序的 proc 来修复它 - 您无需触摸您的 C# 应用程序。如果您每年只获得 3 个版本，这在“托管”环境中可能是一个很大的优势 - 通过修复存储过程来应用修补程序可以成为您的活生生的救星！:-)

总而言之：存储过程有很多优点和缺点；我建议，如果您对编写 T-SQL 感到满意，何不试一试，看看它对您是如何工作的。如果从长远来看觉得繁琐或太不灵活或喜欢太多工作，您可以随时切换回在您的 C# 应用程序中使用直接 SQL。

只是我的 0.02 美元。马克

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-19T07:00:00.037

还没有涉及的两点：

SProcs 可以放在一个模式中，并模拟不同的模式。这意味着您可以锁定数据库访问并仅授予用户执行 SProcs 的权限，而不是选择更新等，这是一个非常好的安全奖励。

其次，sproc 可以显着更快，具体取决于您执行的操作。如果您受到网络 IO 的限制并且您能够对数据执行集合操作，那么在单个存储过程中执行此操作而不是获取整个数据集，处理它，然后传输更改将给您带来不错的速度提升。

Same goes for transactions, if you need to perform operations serially (i.e change a value in two tables at once which involves some logic) then you will need to hold a transaction for the time it takes for you to compute the value and transmit back in two SQL queries, whereas the stored procedure can do it in a single procedure.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-19T06:29:20.533

好吧，无论哪种方式，您最终都会使用 ADO.NET ......听起来您的意思是存储过程与命令文本。不幸的是，两者都有优点，所以这不是一个简单的问题，但是，如果您正在查看 LINQ 之类的工具，命令文本有更多优点，因为它可以更“可组合”（即调用者可以添加///`Skip`并使其影响整体查询`Take`）`Where`。`OrderBy`

混合两者优点的另一个选项是表值函数（通过 UDF）——它们还具有更强元数据的优势（很难准确地查询存储过程的模式）。

只要您正确使用参数，任何方法都应该是注入安全的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T06:29:46.493

请允许我重新表述一下：您是否应该拉下数据，在代码中对其进行修改，然后**让 SP 使用新值更新 DB**，或者您是否应该将 SP 称为“函数”。
我的重点是，即使您在代码中进行数据操作，您仍然应该只访问数据库上的 SP。

无论您是这样做，还是让更复杂的 SP 进行数据操作，都取决于几个因素：

*   您对复杂 SQL 的熟悉程度（相对于 C#）
*   您需要下拉和修改多少数据 - 可能存在性能方面（将所有数据提取到代码中需要花费）
*   连接到前一个，您的架构可能会发挥作用 - 例如，您是访问本地数据库服务器还是远程
*   你需要做什么样的操作，它可能太复杂了你不想弄乱你的sql
*   你需要执行什么样的业务逻辑，依赖什么数据等等。

这真的归结为一个判断电话，没有**正确的**方法（尽管有很多*错误*的方法......）。尽管保持一致很重要，但在您的系统中拥有不同类型的数据库访问是完全可以接受的，只要上下文/需要证明它是合理的。
我会说选择你最喜欢的那个，并坚持下去——**直到你有理由改变它**。没有理由对此持教条主义...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T06:54:31.420

我建议遵循一种约定或另一种约定（将您的 SQL 代码作为类中的字符串或使用存储过程）。关于这一点有无数的争论，但实际上没有任何重要的理由来选择其中一个。

# c# - 在 using 语句中 LINQ 如何延迟执行

> ID：456691
> 
> 赞同：12
> 
> 时间：2009-01-19T06:18:27.733
> 
> 标签：c#, .net, linq, idisposable, using

想象一下，我有以下内容：

```
private IEnumerable MyFunc(parameter a)
{
   using(MyDataContext dc = new MyDataContext)
   {
      return dc.tablename.Select(row => row.parameter == a);
   }
}

private void UsingFunc()
{
   var result = MyFunc(new a());

   foreach(var row in result)
   {
      //Do something
   }
} 
```

根据文档，linq 执行将推迟到我实际枚举结果，该结果出现在 foreach 的行中。然而 using 语句应该强制在调用 MyFunct() 结束时可靠地收集对象。

实际发生了什么，处置器何时运行和/或结果运行？

我唯一能想到的是延迟执行是在编译时计算的，所以编译器将实际调用移动到 foreach 的第一行，导致 using 正确执行，但直到 foreach 行才运行？有大神可以帮忙吗？

编辑：~~注意：这段代码确实有效，我只是不明白如何。~~

我做了一些阅读，并在我的代码中意识到我调用了 ToList() 扩展方法，该方法当然会枚举结果。勾选答案的行为对于回答的实际问题是完全正确的。

很抱歉有任何混淆。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T06:22:04.043

我希望这根本行不通。是`Select`延迟的，因此此时没有消耗任何数据。但是，由于您已经处置了数据上下文（在离开之前`MyFunc`），因此它将永远无法获取数据。更好的选择是将数据上下文传递*到*方法中，以便消费者可以选择生命周期。另外，我建议返回`IQueryable<T>`，以便消费者可以“组合”结果（即添加///`OrderBy`等，并使其影响最终查询）：`Skip``Take``Where`

```
// this could also be an instance method on the data-context
internal static IQueryable<SomeType> MyFunc(
    this MyDataContext dc, parameter a)
{
   return dc.tablename.Where(row => row.parameter == a);
}

private void UsingFunc()
{
    using(MyDataContext dc = new MyDataContext()) {
       var result = dc.MyFunc(new a());

       foreach(var row in result)
       {
           //Do something
       }
    }
} 
```

* * *

更新：如果您（评论）不想推迟执行（即您不希望调用者处理数据上下文），那么您需要评估结果。您可以通过调用`.ToList()`或`.ToArray()`在结果上缓冲值来做到这一点。

```
private IEnumerable<SomeType> MyFunc(parameter a)
{
   using(MyDataContext dc = new MyDataContext)
   {
      // or ToList() etc
      return dc.tablename.Where(row => row.parameter == a).ToArray();
   }
} 
```

如果你想在这种情况下保持延迟，那么你需要使用“迭代器块”：

```
private IEnumerable<SomeType> MyFunc(parameter a)
{
   using(MyDataContext dc = new MyDataContext)
   {
      foreach(SomeType row in dc
          .tablename.Where(row => row.parameter == a))
      {
        yield return row;
      }
   }
} 
```

现在在不传递数据上下文的情况下将其推迟。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-23T08:38:20.557

[我刚刚在此处](http://solutionizing.net/2009/07/23/using-idisposables-with-linq/)发布了针对此问题的另一个延迟执行解决方案，包括以下示例代码：

```
IQueryable<MyType> MyFunc(string myValue)
{
    return from dc in new MyDataContext().Use()
           from row in dc.MyTable
           where row.MyField == myValue
           select row;
}

void UsingFunc()
{
    var result = MyFunc("MyValue").OrderBy(row => row.SortOrder);
    foreach(var row in result)
    {
        //Do something
    }
} 
```

扩展方法本质上`Use()`就像一个延迟`using`块。

# c# - x64 上的 TypeLoadException 但在带有结构布局的 x86 上很好

> ID：456696
> 
> 赞同：9
> 
> 时间：2009-01-19T06:20:51.753
> 
> 标签：c#, .net, x86, 64-bit

如果您想查看实际的异常，您将需要一台 64 位机器。我创建了一些重现问题的虚拟类。

```
[StructLayout(LayoutKind.Sequential, Pack = 1)]
    public class InnerType
    {
        char make;
        char model;
        UInt16 series;
    }

 [StructLayout(LayoutKind.Explicit)]
    public class OutterType
    {
        [FieldOffset(0)]
        char blah;

        [FieldOffset(1)]
        char blah2;

        [FieldOffset(2)]
        UInt16 blah3;

        [FieldOffset(4)]
        InnerType details;
    }

    class Program
    {
        static void Main(string[] args)
        {
            var t = new OutterType();
            Console.ReadLine();
        }
    } 
```

如果我在 64 clr 上运行它，我会收到一个类型加载异常，

```
System.TypeLoadException was unhandled 
  Message="Could not load type 'Sample.OutterType' from assembly 'Sample, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' because it contains an object field at offset 4 that is incorrectly aligned or overlapped by a non-object field." 
```

如果我将目标 cpu 强制为 32，它工作正常。

此外，如果我将 InnerType 从类更改为结构，它也可以工作。有人可以解释发生了什么或我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-19T17:54:10.653

The part about overlapping types is misleading here. The problem is that in .Net reference types must always be aligned on pointer size boundaries. Your union works in x86 since the field offset is 4 bytes which is the pointer size for a 32 bit system but fails on x64 since there it must be offset a multiple of 8\. The same thing would happen if you set the offset to 3 or 5 on the x86 platform.

EDIT: For the doubters - I couldn't find a ready reference on the internet but check out [Expert .NET 2.0 IL Assembler By Serge Lidin](https://rads.stackoverflow.com/amzn/click/com/1590596463) page 175.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T05:15:22.493

I have also noticed that you are packing your char data type into 1 byte. Char types in .NET are 2 bytes in size. I cannot verify if this is the actual issue, but I would double-check that.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T17:33:14.750

如果您想将结构放置在本身就是 Layoutind.Explict 的其他结构中，如果您希望它们以不同的位数模式（或在具有不同打包要求的机器上）工作，则应该使用显式 Size 值（以字节为单位）您在说什么有“按顺序排列东西，不要在内部打包，但在最后使用尽可能多的空间”。如果您未指定 Size，则运行时可以随意添加任意数量的空间。

它通常拒绝让结构和对象类型重叠的原因是 GC 例程必须可以自由地遍历活动对象图。这样做时，它无法知道联合（重叠）字段作为对象引用还是作为原始位（例如 int 或 float）有意义。由于它*必须*遍历所有活动对象引用才能正确运行，因此最终会遍历“随机”位，这些位可能指向堆中的任何位置（或堆外），就好像它们是在您知道它之前的引用一样，您是一般保护错误。

由于根据运行时 32/64 引用将占用 32 位或 64 位，因此您必须使用 Explict，因此只有带有引用的联合引用和带有值类型的值类型，如果它们不同，请确保您的引用类型与两个目标平台的边界对齐（注意：运行时依赖见下文）并执行以下操作之一：

1.  确保所有引用字段都是结构中的最后一个条目 - 然后可以根据运行时环境的位数自由地使结构更大/更小。
2.  无论您是在 32 位还是 64 位环境中，强制所有对象引用使用 64 位

关于对齐的注意事项：抱歉，我在未对齐的引用字段上出错了 - 编译器删除了类型加载，除非我对结构执行了一些操作。

```
[StructLayout(LayoutKind.Explicit)]
public struct Foo
{
    [FieldOffset(0)]
    public byte padding;
    [FieldOffset(1)]
    public string InvalidReference;
}

public static void RunSnippet()
{
    Foo foo;
    foo.padding = 0;
    foo.ValidReference = "blah";
    // Console.WriteLine(foo); // uncomment this to fail
} 
```

相关细节在 ECMA 规范[http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-335.pdf](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-335.pdf)见第 16.6.2 节，它要求对齐原生大小值，包括 &。它指出，如果需要，存在未对齐的前缀指令可以解决此问题。

然而，在单声道（OSX intel 和 Win32 intel 32 位）上，上述代码有效。运行时要么不尊重布局并默默地“正确”事物，要么允许任意对齐（从历史上看，它们在这方面不如 MS 运行时灵活，这令人惊讶）。mono 生成的 CLI 中间形式不包含任何 .unaligned 指令前缀，因此它似乎不符合规范。

那会教我只检查单声道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T14:52:59.443

I struggled with the same problem and hated I couldn't find a clear reference on this topic on MSDN. After reading the answer here, I started concentrating me on the x86 and x64 differences in .NET and found the following: [Migrating 32-bit Managed Code to 64-bit](http://msdn.microsoft.com/en-us/library/ms973190.aspx#64mig_topic7). Here they clearly state that pointers are 4 bytes on x86 and 8 bytes on x64\. Hope it can be helpful for others.

There are by the way many related questions here on Stack Overflow. I will add two of them, that mention other interesting things.

*   [Incorrectly-aligned/non-object field in struct](https://stackoverflow.com/questions/6891867/incorrectly-aligned-non-object-field-in-struct)
*   [Incorrectly aligned or overlapped by a non-object field error](https://stackoverflow.com/questions/1190079/incorrectly-aligned-or-overlapped-by-a-non-object-field-error)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-19T08:08:18.120

Uint16 可能有问题，因为它不符合 CLS（请参见此处：http: [//msdn.microsoft.com/en-us/library/system.uint16.aspx](http://msdn.microsoft.com/en-us/library/system.uint16.aspx)）

# c++ - 如何检测从“启动”文件夹快捷方式启动？

> ID：456707
> 
> 赞同：0
> 
> 时间：2009-01-19T06:26:41.383
> 
> 标签：c++, windows, winapi, startup, windows-shell

我需要在我的程序 CintaNotes 中添加“Windows 启动时运行”选项，但不想牺牲它的“清洁度”：它是 100% 可移植的免费软件，不应在系统中留下痕迹。我想出了从启动快捷方式自动检测运行并自动最小化到系统托盘的想法。有没有办法做到这一点？我正在使用 C++ 和原始 Winapi。

所以： - 没有写入注册表 - 没有命令行参数

谢谢！

UPD：问题不是如何最小化到系统托盘！问题是程序如何在不使用注册表和命令行参数的情况下区分正常运行和从启动文件夹快捷方式运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T07:46:04.750

您的“清洁”似乎充其量只是一种人为的构造。如果您告诉用户在启动文件夹中创建快捷方式，那么您已经留下了足迹（老实说，“myprog.exe”和“myprog.exe -m”之间几乎没有区别） . 在这种情况下，有一些比自动尝试检测您从哪里运行更简单的方法。

我只需在您的程序中提供一个菜单选项（“安装”），然后将软件安装到固定磁盘位置（而不是闪存驱动器），包括必要的程序条目（开始、所有程序、CintaNotes）。

作为该过程的一部分（甚至在安装之后），您可以让他们指定“从 Windows 启动”，然后**使用**命令行选项为用户创建启动文件夹快捷方式，以便您的程序可以判断它是否以这种方式运行. 除非程序可用（即，在固定磁盘上，而不是闪存驱动器上），否则允许“从 Windows 启动”是没有意义的。

您的用户根本不必担心创建快捷方式，更不用说带有参数的快捷方式了。这使您的程序可以控制它的运行方式 - 两种模式，“已安装”（并开始最小化）或“运行而不先安装”（并正常启动）。

诸如查找可执行文件的目录之类的东西不会起作用，因为启动程序的启动文件夹项可能是它的快捷方式，因此您将没有该路径。

我认为这是一个典型的问错问题的案例。在回答您的具体问题时，我说：不，如果没有一些命令行参数，就无法判断您是从启动文件夹条目启动的。但是，我以前错了，请问我的妻子:-)。其他人很可能知道一种方法。

添加此编辑，因为评论不允许足够的空间：

你问：

> 当程序检测到它正在从闪存驱动器运行时，您如何看待仅禁用“Windows 启动时启动”选项？我想有一种方法可以检测到这一点。

这是一个好主意，因为在安装之前允许自动运行是没有意义的（因为闪存驱动器可能不存在）。一种可能：

1/ 从 Flash 运行，您从“myprog.exe”开始，因为您只是双击可执行文件并在普通窗口中运行。这提供了“安装到固定磁盘”选项，但没有“从 Windows 启动”选项。作为安装过程的一部分，您可以允许他们将已安装的副本设置为“从 Windows 开始”，而不是当前运行的副本。

2/ 您已安装的程序可以设置为以“myprog.exe -i”运行，因为您在 Start/AllPrograms 中创建了该项目。这将禁用“安装到固定磁盘”，但允许您切换“从 Windows 开始”。您可以选择是否希望显式运行（由用户）正常启动或最小化（参见 (3)）。

3/ StartUp 中的快捷方式可以是“myprog.exe -s”（同样，您可以控制它，因为您创建了它）。这与 (2) 相同，但开始最小化（如果 (2) 无论如何开始最小化，则 (2) 和 (3) 之间没有区别，也没有理由使用不同的命令行选项）。

这样，每个选项都可以具有您认为合适的不同行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-11-11T12:36:15.457

即使您已经解决了问题，我只是想说，可以检测程序是否从快捷方式启动。获得快捷方式路径后，您可以将其与启动文件夹进行比较。

[请参阅Undocumented CreateProcess](http://www.catch22.net/tuts/undoc01)中的“检测可执行文件是否从快捷方式启动”部分

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T06:35:17.013

检查注册表中的此项。HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run 并添加一个新的字符串键，并将应用程序的路径作为值。并使用 NOTIFYICONDATA 结构将您的应用程序最小化到托盘。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T06:31:37.800

为什么不使用参数来启动最小化的应用程序，例如：

```
YourProgram.exe -m 
```

# c++ - 为什么在使用模板时会出现“未解析的外部符号”错误？

> ID：456713
> 
> 赞同：107
> 
> 时间：2009-01-19T06:29:08.880
> 
> 标签：c++, templates, linker

当我使用模板为类编写 C++ 代码并在源 (CPP) 文件和头 (H) 文件之间拆分代码时，在链接最终可执行文件时会出现很多“未解析的外部符号”错误，尽管目标文件已正确构建并包含在链接中。这里发生了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2009-01-19T06:29:52.827

模板类和函数在使用之前不会被实例化，通常在单独的 .cpp 文件中（例如程序源）。使用模板时，编译器需要该函数的完整代码才能构建具有适当类型的正确函数。但是，在这种情况下，该函数的代码在模板的源文件中有详细说明，因此不可用。

由于所有这些，编译器只是假设它是在其他地方定义的，并且只插入对模板化函数的调用。在编译模板的源文件时，程序源中使用的特定模板类型并没有在那里使用，因此它仍然不会生成函数所需的代码。这会导致无法解析的外部符号。

可用的解决方案是：

1.  在模板的头文件中包含成员函数的完整定义，并且没有模板的源文件，
2.  ~~将模板源文件中的所有成员函数定义为“内联”~~（更新：[这不适用于 Visual Studio 2017+]），或者
3.  ~~使用“export”关键字在模板的源代码中定义成员函数。不幸的是，很多编译器都不支持这一点。~~（更新：[从 C++11 开始，这已从标准中删除](http://www.parashift.com/c++-faq/separate-template-fn-defn-from-decl-export-keyword.html)。）

1 和 2 基本上都通过让编译器在尝试在程序源中构建类型化函数时访问模板化函数的完整代码来解决问题。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-19T06:46:44.040

另一种选择是将代码放在 cpp 文件中，并在同一个 cpp 文件中添加具有您希望使用的类型的模板的显式实例化。如果您知道您只会将它用于您预先知道的几种类型，这将很有用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-24T19:59:14.773

对于包含 .h 文件的每个文件，您应该插入两行：

```
#include "MyfileWithTemplatesDeclaration.h"
#include "MyfileWithTemplatesDefinition.cpp" 
```

* * *

样本

```
#include "list.h"
    #include "list.cpp" //<---for to fix bug link err 2019

    int main(int argc, _TCHAR* argv[])
    {
        list<int> my_list;
        my_list.add_end(3);
    .
    .
    } 
```

此外，您不要忘记将声明类放在 centinel 常量中

```
#ifndef LIST_H
#define LIST_H
#include <iostream>
.
.
template <class T>
class list
{
private:
    int m_size,
        m_count_nodes;
    T m_line;
    node<T> *m_head;
public:
    list(void);
    ~list(void);
    void add_end(T);
    void print();
};
#endif 
```

# c# - 有人如何在 C# 中编写“宏”？

> ID：456717
> 
> 赞同：2
> 
> 时间：2009-01-19T06:29:57.197
> 
> 标签：c#, macros

我对宏有所了解。我不是指 ASSEMBLY 语言类型。我说的是那些你可以用来在另一个程序上执行重复动作的程序。我说的是那些您可以用来在计算机上记录一系列事件的程序，例如鼠标移动和按钮单击，然后您可以回放它们。其中一些非常精细，只能在您指定的特定应用程序上运行。

我曾经写过一种。它是一个启动 Excel 会话的程序，然后使用某种动态数据交换管道来提供 Excel 会话脚本命令。有效。

但我想，操作系统层面的事情是完全不同的故事。

有人如何在 C# 中编写“宏”？

我认为我将采用的方法是使用开发环境附带的 spy 例程来获取正确消息和参数的列表（例如 wm_lbuttondown），然后使用动态数据交换将这些消息发送到应用程序。

所以我有三个问题。

1.  这是最好的方法吗？
2.  如何获取已经运行的应用程序的句柄？
3.  如何向已经运行的应用发送类似用户的消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T08:40:56.697

基于以下许多因素，有不同的答案：

*   是第三方还是您自己的应用程序？
*   是否有自动化接口
*   应用程序中使用的 GUI 工具包

如果它是第 3 方应用程序，那么您需要通过 PInvoke 在 Windows API 级别上工作 - 子类化 WinMain proc、捕获和发送输入消息等。该任务有第 3 方库。C# 显然不是此类任务的正确选择。

如果应用程序具有自动化模型（如 Excel），那么编写将与该应用程序交互的程序非常简单。

如果您想使用宏功能增强您自己的应用程序，那么您应该在设计状态时考虑到这一点。如果您从一开始就使用命令模式，那么对宏录制进行编程并不难。

您应该提供更多详细信息以获得更好的答案。

哦，我差点忘了回答这三个问题

> 1.  这是最好的方法吗？

视具体情况而定

> 2.  如何获取已经运行的应用程序的句柄？

取决于应用程序。如果它是本机 Win 应用程序，您可以通过 WinApi 轻松获取进程 ID 和窗口句柄。

> 3.  如何向已经运行的应用发送类似用户的消息？

再次取决于应用程序类型。对于原生 win 应用程序，您可以通过 WinAPI 轻松发送 WM_XXX 消息

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2010-06-10T07:56:52.930

除非您需要在自己的程序中添加它，否则您只需下载键盘/鼠标宏程序并使用它来执行这些可重复的操作。

另一方面，要在您自己的程序中执行宏，您需要找到一种方法来记录单击的按钮并将它们写入可以保存的临时列表，然后通过单击按钮（以编程方式）运行该列表。

# asp.net - asp.net 中的自定义嵌套属性/方法

> ID：456721
> 
> 赞同：1
> 
> 时间：2009-01-19T06:34:29.573
> 
> 标签：asp.net, properties, class, methods, nested

我正在寻找一种方法来编写允许嵌套方法的自定义 .net 类。

例如...假设我有一个类 X，其函数 Y 返回一个列表。然后我有另一个返回排序列表的函数......

我希望能够执行类似 xy().z() 的操作，其中 z 将接受 y() 的输出作为其输入。

基本上如何 .toLower() 或 .toUpper() 可以附加到任何字符串上。

我正在尝试用谷歌搜索它，但我什至不确定我是否在问正确的问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T06:41:30.027

扩展方法可能是您正在寻找的（可以接受 y() 的输出），但这取决于您使用的 .NET 版本。

因此，如果您想创建一个名为 x 并以 y 作为参数的扩展方法，您将创建一个方法：

```
public static object z(input as y)
{
    //do your manipulations here
} 
```

因此，如果您希望您的函数进行排序，您将调用您的排序方法，传递对象 y，然后返回已排序的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-17T00:14:54.137

史蒂夫是对的（没有双关语）：扩展方法就是您所要求的。在 C# 中，你会做这样的事情：

```
namespace ExtensionsNamespace; // Name this whatever you want.
public static class ListExtensions // must be public static!
{
    // must be public static and the first parameter needs a "this"
    public static IList<T> ToOrderedList<T>(this IList<T> originalList, IComparer<T> comparer)
    {
        // Code to take the original list and return an ordered version
    }
} 
```

然后在您的代码中：

```
using ExtensionsNamespace;
...
IComparer<Book> comparer = GetBookComparer();
IList<BooK> books = GetBookList().ToOrderedList(comparer); 
```

您可以使用 lambda 表达式做一些额外的事情，以避免在某些情况下需要编写自己的比较器类，等等。但是，在您重新发明轮子之前，我建议您查看 LINQ to Objects，它已经内置了很多这些功能。例如：

```
using System.Linq;
...
IEnumerable<Book> booksInOrder1 = GetBookList().OrderBy(b => b.Title); 
```

这是否回答你的问题？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T20:30:03.443

在 asp.net vb 中，您可以使用模块而不是像这样的类：

```
 Imports System.Runtime.CompilerServices
    Public Module Extensions
       <Extension()> _
       Public Function extendedMethod(ByRef input As String) As String
           Return input & "extended method"
       End Function
    End Module 
```

然后在你后面的代码中导入它，就像你导入任何类一样：

```
 Imports Extensions
    Partial Class _Default
    Inherits System.Web.UI.Page
       Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim st As String = "a string "
        Response.Write(st.ToUpper.extendedMethod)
       End Sub
    End Class 
```

在这种情况下，您可以对任何字符串值使用模块中的“extendedMethod”方法，就像使用 .toUpper() 或 .toLower() 一样

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T09:27:05.980

没有什么魔法需要发生。如果 A 类有一个返回 B 类对象的方法，那么您可以直接在 A 中的函数上调用方法。

鉴于：

```
public static class MyClass     
{
  public MyList getList()
  {
    MyList retVal = new MyList();
    ...
    return retVal;
  }
}

public class MyList
{
    public MyList sort()
    {
        // Sort list
        ...
        return sortedList;
    }
} 
```

那么这是合法的： `MyList list = MyClass.getList().sort();`

# c - 如何打印出存储在二维数组中的字符串记录？

> ID：456722
> 
> 赞同：1
> 
> 时间：2009-01-19T06:34:49.760
> 
> 标签：c, arrays, string

我正在使用 C 开发一个项目。我将几条记录存储在一个二维字符串数组中，其中一个字符串是记录名称，另一个字符串是实际值。例如：

```
myArray[0][0] = "filename1";
myArray[0][1] = "somefile.txt";
myArray[1][0] = "filename2";
myArray[1][1] = "anotherfile.txt";
// and so on ... 
```

我知道如何将值存储在数组中，但我不确定如何将它们打印出来。你能帮我弄清楚吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T06:41:56.983

尝试使用二维数组字符（即一维字符串数组）

```
your_2d_array[0] = "file_name_1" /* and so on ... */

for( i = 0 ; i < num_of_file_names ; i++ )
{
    printf("%s\n", your_2d_array[i]);
} 
```

如果您正在使用 2d 字符串数组（即 3d 字符数组），因为编辑似乎表明，那么只需执行以下操作

```
for( i = 0; i < num_of_file_names ; i++ )
{
    printf("%s : %s \n", your_2d_array[i][0], your_2d_array[i][1] );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T07:30:35.823

我会选择以下内容：

```
int recordIndex;
for (recordIndex = 0; recordIndex < num_records; recordIndex++)
{
    printf("%s: %s\n", myArray[recordIndex][0], myArray[recordIndex][1]);
} 
```

这将输出如下：

```
filename1: somefile.txt
filename2: anotherfile.txt
... 
```

# stored-procedures - Sql Server 2005 中的动态存储过程

> ID：456727
> 
> 赞同：0
> 
> 时间：2009-01-19T06:36:14.360
> 
> 标签：stored-procedures

是否可以在sql server 2005中编写带有动态参数的存储过程

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T22:23:23.993

技术上没有，但有一个解决方法：临时表。创建一个临时表，然后设置您的存储过程以从临时表中读取其配置。

这是一个如何调用它的示例：

```
CREATE TABLE #inputParams (ParamName VARCHAR(20), ParamValue VARCHAR(20))
INSERT INTO #inputParams (ParamName, ParamValue) VALUES ('First Name', 'John')
INSERT INTO #inputParams (ParamName, ParamValue) VALUES ('Last Name', 'Doe')
EXEC dbo.USP_MyStoredProcedure 
```

然后在您的存储过程中，您可以通过检查该临时表是否存在并从中查询参数来检索所需的任何参数，如下所示：

```
CREATE PROCEDURE dbo.USP_MyStoredProcedure AS
DECLARE @FirstName VARCHAR(20)
SET @FirstName = SELECT ParamValue FROM #inputParams WHERE ParamName = 'First Name'
GO 
```

这样，您的存储过程的参数数量永远不会改变，这使得一些开发应用程序更容易随着时间的推移调用它，但这非常危险。从存储过程的外部，你永远不知道你正在调用什么版本的存储过程，以及它是否会对你发送的参数做任何事情。

相反，您可能会考虑将您的存储过程抽象为另一个存储过程作为包装器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T06:49:58.903

不，计数和参数类型都作为存储过程声明的一部分固定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T11:39:31.873

如果有一组离散的参数，您可以将它们作为 XML 传递到存储过程中。然后，您可以将 XML 分解为 sproc 主体内的变量，例如

```
CREATE PROCEDURE MyDynamicStoredProc  
@ParameterXML XML
AS

SET NOCOUNT ON

DECLARE @Parameter1 NVARCHAR(50)
DECLARE @Parameter2 INT

SET @Parameter1 = @ParameterXML.value('/Root/Parameters/StringParameter/@Value','nvarchar(50)')
SET @Parameter2 = @ParameterXML.value('/Root/Parameters/IntegerParameter/@Value','int')
... 
```

注意：我的 XQuery-fu 很弱，不要依赖这个例子！

# .net - 我想将 PostrgeSQL 与 .NET 一起使用。我该怎么做？

> ID：456728
> 
> 赞同：3
> 
> 时间：2009-01-19T06:37:16.667
> 
> 标签：.net, database, postgresql

我正在使用 Sql Server 2005 在 .NET 中进行一个小型实践项目。我想学习 PostgreSQL 并在最终版本中在 PostgreSQL 中实现我的项目。请就我需要做的所有事情提出建议，使用 .NET 设置 PostgreSQL 并成功运行它。

衷心感谢
fsck。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T06:54:38.767

有一个 postgres .Net 数据提供程序[Npgsql](http://npgsql.projects.postgresql.org/)应该很有用。

# c++ - 我应该将 throw() 添加到我的 C++ 析构函数的声明中吗？

> ID：456738
> 
> 赞同：6
> 
> 时间：2009-01-19T06:42:08.403
> 
> 标签：c++, exception, destructor

我见过一些 C++ 类的析构函数定义如下：

```
class someClass
{
    public:
        someClass();
        ~someClass() throw();
}; 
```

这是一个好主意吗？

我很清楚析构函数永远不应该抛出异常，但这实际上会阻止我在析构函数中抛出异常吗？我不是 100% 确定它保证了什么。

参考：[这个最近的问题](https://stackoverflow.com/questions/130117/throwing-exceptions-out-of-a-destructor)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T06:49:34.473

它不会阻止您从析构函数中抛出异常。编译器仍然会让你这样做。不同之处在于，*如果*您确实允许从该析构函数中逃脱异常，您的程序将立即调用`unexpected`. 该函数调用任何`unexpected_handler`指向，默认情况下是`terminate`. 因此，除非您采取措施处理意外异常，否则您的程序将终止，这完全不是一个坏主意。毕竟，如果异常确实出乎意料，那么您的程序无论如何也无法处理它。

这对于析构函数来说并没有什么特别之处。相同的规则适用于所有方法的异常规范。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T06:48:50.230

这不是一个糟糕的主意。如果您在没有传播异常的情况下抛出 dtor，您将立即中止，这让您知道您忘记了创建一个实际的非抛出 dtor。

另一方面，如果您将 throw 规范排除在外，那么您只会在实际上抛出异常时才知道错误的 dtor 实现。

# video-processing - 自动化视频捕获

> ID：456739
> 
> 赞同：1
> 
> 时间：2009-01-19T06:43:20.913
> 
> 标签：video-processing

我有一堆来自我的数码相机的短视频。我知道如何使用 ffmpeg 将它们转换为更好的编解码器，但我也想为视频制作预览图像。不是那个窗口的缩略图，就像媒体播放器经典一样，它需要大约 5-30 个视频镜头。我希望 MPC 能够通过 cmd 行来做到这一点，但事实并非如此。

我可以使用什么（命令行）实用程序来执行此操作，或者我可以使用什么库（最好是 c/c++）来生成图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T07:41:27.533

您可以使用可编程自动化工具（例如[wintask](http://www.wintask.com/)）使用现有的手动应用程序来执行此操作。

# .net - WebClient 与代理设置 - 或下载加速器的乐趣

> ID：456741
> 
> 赞同：4
> 
> 时间：2009-01-19T06:45:06.680
> 
> 标签：.net, proxy, webclient

我有一个相对简单的功能，它使用 WebClient 类对 Web 服务器执行 HTTPS POST。此代码运行可靠，但在使用 EarthLink 或 AT&T 下载加速器功能时遇到问题。

下载加速器通过将拨号连接的代理设置更改为仅为 HTTP 协议指定 localhost:8080 来工作。在这种配置下，想必 HTTPS 协议应该不受影响。事实上，当使用 Internet Explorer 导航到[https://www.wellsfargo.com](https://www.wellsfargo.com)时，并没有错误。

但是，在使用 .NET 2.0（或 3.5）时，WebClient 类无法在此配置中从[https://www.wellsfargo.com执行简单的 HTTPS GET。](https://www.wellsfargo.com)

作为一个简单的测试，我执行以下操作：

指定高级 LAN 代理配置，其中：

HTTP地址：**重击：8080**

安全地址：**securewhacked:8081**

在 C# 中，我调用以下函数：

```
IWebProxy defaultWebProxy = WebRequest.DefaultWebProxy;
Uri proxyUri = defaultWebProxy.GetProxy("https://www.wellsfargo.com"); 
```

我希望 proxyUri 应该是“securewhacked:8081”。

相反，proxyUri 是“重击：8080”。

这似乎是.NET“自动”代理使用中的一个错误。结果是打开下载加速器时我们的软件失败了。

有谁知道这里发生了什么？

我知道客户禁用加速器相对容易，但我希望我们的软件开箱即用，无需用户禁用加速器。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-19T09:56:57.510

加速器是否设置在用户 (IE) 代理设置、机器 (WinHTTP) 代理设置或两者上？如果是 IE，您可能想尝试使用`proxycfg -u`将 IE 设置导入 WinHTTP（因为我相信这是`WebClient`（和一般 .NET）使用的）。

# java - 如何创建既具有样式又具有自定义字体的 Java/Swing 文本组件？

> ID：456742
> 
> 赞同：1
> 
> 时间：2009-01-19T06:45:09.443
> 
> 标签：java, swing, fonts

如何创建既具有样式又具有自定义字体的 Java/Swing 文本组件？我想用红色突出显示一小部分文本，但同时使用自定义（通过嵌入`Font.createFont`）字体。JLabel 接受 HTML 文本，它允许我突出显示部分文本，但在呈现 HTML 时它会忽略字体设置。其他文本组件（例如 JTextArea）将使用自定义字体，但它们不会呈现 HTML。最简单的方法是什么？

这是使用 JTextPane 失败的示例：

```
 JTextPane textPane = new JTextPane();
    textPane.setFont(myCustomFont);
    textPane.setText(text);
    MutableAttributeSet attributes = new SimpleAttributeSet();
    StyleConstants.setForeground(attributes, Color.RED);
    textPane.getStyledDocument().setCharacterAttributes(
        text.indexOf(toHighlight),
        toHighlight.length(),
        attributes, true
    ); 
```

这成功地显示了文本，其中“toHighlight”部分以红色突出显示，但它不使用 myCustomFont。请注意，我可以使用 设置字符串字体`StyleConstants.setFontFamily()`，但不能设置自定义字体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T23:49:53.680

好的，我现在更好地看到了这个问题。

在检查了一些 Swing 源代码之后，很明显您不能使用并且让它使用开箱`DefaultStyledDocument`即用的物理字体（您自己创建的字体）。`createFont`

但是，我认为你可以做的是以`StyleContext`这种方式实现你自己的：

```
public class MyStyleContext extends javax.swing.text.StyleContext
{
    @Override public Font getFont(AttributeSet attr)
    {
        Font font = attr.getAttribute("MyFont");
        if (font != null)
            return font;
        else
            return super.getFont(attr);
    }
} 
```

然后你必须：

1.  `DefaultStyledDocument`用一个创建一个`new MyStyleContext()`
2.  将其“附加”到`JTextPane`
3.  `attributes.addAttribute("MyFont", myCustomFont);`在上面的代码段中调用

我没有尝试过，但我认为它应该可以工作，或者它可能是一个很好的调查途径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T01:46:36.050

jfpoilpret 的解决方案效果很好！为了后代的缘故，这是一个有效的代码片段：

```
 JTextPane textPane = new JTextPane();
    textPane.setStyledDocument(new DefaultStyledDocument(new StyleContext() {
        @Override
        public Font getFont(AttributeSet attr) {
            return myCustomFont;
        }
    }));
    textPane.setText(text);
    MutableAttributeSet attributes = new SimpleAttributeSet();
    StyleConstants.setForeground(attributes, Color.RED);
    textPane.getStyledDocument().setCharacterAttributes(
        text.indexOf(toHighlight),
        toHighlight.length(),
        attributes, true
    ); 
```

谢谢，jfpoilpret！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T07:14:50.880

您应该尝试改用 JEditorPane 或 JTextPane。

它们以更复杂的 API 为代价，让内容具有丰富的风格。不幸的是，如果您正在寻找像素完美的 UI，它们还有一个额外的问题：它们不支持基线对齐（Java 6 特性）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-06T03:44:10.243

在 Clojure 中编写程序时，我遇到了同样的问题，即。在显示 HTML 文本的 JEditorPane 中使用从 TTF 加载的字体。这里的解决方案工作正常 - 我在这里复制有趣的部分以供将来参考：

```
(def font1 (with-open [s (FileInputStream. "SomeFont.ttf")]
             (.deriveFont (Font/createFont Font/TRUETYPE_FONT s) (float 14))))
(def font2 (Font. "SansSerif") Font/PLAIN 14)
(let [editor (JEditorPane. "text/html" "")]
  (.setDocument editor
                (proxy [HTMLDocument] []
                  (getFont [attr]
                    (if (= (.getAttribute attr StyleConstants/FontFamily)
                           "MyFont")
                      font1
                      font2))))) 
```

这假设 HTML 文档引用了一个字体系列“MyFont”，例如，带有类似的 CSS 片段

```
p { font-family: "MyFont" } 
```

请注意，您必须处理*所有*字体请求。这是因为*代理*的限制不能调用超类的成员函数。此外，如果您想处理不同的字体大小，您必须“手动”执行此操作，检查 StyleConstants/FontSize 属性并相应地创建一个带有 derivedFont 的字体。

我希望这会对某人有所帮助:)

# mysql - 删除与某些通配符匹配的 MySQL 数据库？

> ID：456751
> 
> 赞同：62
> 
> 时间：2009-01-19T06:50:12.410
> 
> 标签：mysql, sql

我在需要删除大量数据库的服务器上运行 mySQL（在对服务器进行了一些测试之后）。我需要删除的所有数据库都具有相同的前缀“Whatever_”。

在前缀之后，名称是随机的。所以你有你的whatever_something，whatever_232，whatever_blabla，....，whatever_imthelast。

我将多次从事这项工作，所以我想知道最好的方法是什么？

**编辑：** 我可以使用任何类型的语言或插入 mysql ......所以我们可以通过某些方式做到这一点。现在，我要求生成数据库的人给我一个 .txt，每个名称都在一行中...所以我编写了一个快速 php，它将获取一个文件并删除其中的所有数据库，稍后我会尝试% 答案（如果它有效，它肯定会采用正确的答案，这是更简单的方法）。无论如何，我想以更简单的方式做到这一点，因为我无法支持此代码（其他人会，你知道......）

**编辑 2：** 使用通配符不起作用：#1008 - Can't drop database 'whatever_%'; 数据库不存在

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-01-19T07:23:43.890

基本思想是在您的数据库中运行“显示表”，并使用其中的结果来选择您想要的表。我不认为 MySQL 允许您对“显示表”的结果集做任何事情，但我可能错了。

这是使用外壳的快速而肮脏的解决方案：

```
mysql -u your_user -D your_database_name -e "show tables" -s | 
  egrep "^Whatever_" | 
  xargs -I "@@" echo mysql -u your_user -D your_database_name -e "DROP TABLE @@" 
```

这将打印出所有 shell 命令以删除以“Whatever_”开头的表。如果您希望它实际执行这些命令，请删除“echo”一词。

**编辑**：我忘了解释上面的内容！我不知道你对 shell 脚本有多熟悉，但这里有：

```
mysql -u your_user -D your_database_name -e "show tables" -s 
```

打印出所有表的列表，标题为“Tables_in_your_database_name”。通过下一个命令将输出通过管道传输（| 符号表示“管道”，如传递）：

```
egrep "^Whatever_" 
```

搜索以单词“Whatever_”开头的任何行（^ 符号表示“存在”）并仅打印这些行。最后，我们通过以下命令管道“Whatever_*”表列表：

```
xargs -I "@@" echo mysql -u your_user -D your_database_name -e "DROP TABLE @@" 
```

它获取表名列表中的每一行，并在命令中插入它而不是“@@”

```
echo mysql -u your_user -D your_database_name -e "DROP TABLE @@" 
```

因此，如果您有一堆名为“Whatever_1”、“Whatever_2”、“Whatever_3”的表，生成的命令将是：

```
echo mysql -u your_user -D your_database_name -e "DROP TABLE Whatever_1"
echo mysql -u your_user -D your_database_name -e "DROP TABLE Whatever_2"
echo mysql -u your_user -D your_database_name -e "DROP TABLE Whatever_3" 
```

这将输出以下内容：

```
mysql -u your_user -D your_database_name -e "DROP TABLE Whatever_1"
mysql -u your_user -D your_database_name -e "DROP TABLE Whatever_2"
mysql -u your_user -D your_database_name -e "DROP TABLE Whatever_3" 
```

我希望这是足够的细节，而且我不只是用太多的信息打败任何人。祝你好运，使用“DROP TABLE”命令时要小心！

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-02-02T14:59:33.500

**scraimer**回答的原则是正确的，但是由于问题是关于删除数据库而不是数据库中的表，因此正确的命令应该是：

```
mysql -u your_username -p'your password' -e 'show databases' 
| grep Whatever_* 
| xargs -I "@@" mysql -u your_username -p'your password' -e "DROP database \`@@\`" 
```

有关命令的解释，请查看**scraimer**的解释。

最后一点... \`@@\` 我们将生成的数据库名称用 bacticks(`) 引用，以防我们的数据库名称包含特殊字符，例如 `-`

干杯

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-03-16T11:20:32.363

我们可以使用存储过程来做到这一点。这是下面的一个：

```
drop procedure if exists droplike;
delimiter //
create procedure droplike(pattern varchar(20))
begin
  set group_concat_max_len = 65535;
  select @drop:= concat( 'drop table ', group_concat(table_name) , ';' ) from information_schema.tables where table_schema = "database_name" and table_name like pattern;
  prepare statement from @drop;
  execute statement;
end //
delimiter ; 
```

将 database_name 替换为数据库的名称（需要写入权限）。要删除模式为 XYZ 的表，请调用输入为 XYZ 后跟通配符的过程，如下所示：

```
call droplike("XYZ%"); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-09-06T09:45:58.437

这里有一些不错的整洁解决方案。但我所做的只是：

```
SHOW TABLES LIKE 'migrate%'; 
```

在 MySQL 工作台中。

然后我将结果复制到一个体面的文本编辑器中，该编辑器可以使用转义序列查找/替换，并替换`\n`为`;\nDROP TABLE`，并整理了开始和结束。然后复制回 MySQL 工作台。比一些建议的解决方案更手动且不那么优雅，但实际上同样快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-17T09:30:18.187

好吧，我认为您不能在 MySql 中删除多个数据库。

但我有一个非常令人讨厌的解决方案。您可以使用 C/C++/C#/JAVA 编程多次将“ `DROP DATABASE WHATEVER_<name>;`”打印到记事本或任何文本编辑器中。之后，您可以在 MySql 的客户端命令提示符中复制粘贴，然后就可以了。不要忘记`;`每个`DROP`命令后的“”。

我相信这是可能的。试着写这个。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-24T18:18:11.337

这个（Jython）呢？

```
rs = stmt.executeQuery( "SHOW DATABASES LIKE 'Whatever_%'" )
databases_for_dropping = []
while rs.next():
  databases_for_dropping.append( rs.getString( 1 ))
for database_for_dropping in databases_for_dropping:
  stmt.execute( "DROP DATABASE %s" % database_for_dropping ) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-27T22:33:14.310

如果有人正在寻找一个反映**scraimer**和**Explorer**的简单答案，但它是使用 JDBC 用 Ja​​va 编写的（我知道我是这样的），这里有一个快速而肮脏的答案，可以为我完成工作：

```
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;

public class DatabaseDeleter {
    // Pass your database wildcard as the only argument to program ( "%MY_CRAZY_PATTERN%")
    public void main(String[] args) throws SQLException, ClassNotFoundException{

        Class.forName("com.mysql.jdbc.Driver");
        Connection connection = DriverManager.getConnection("jdbc:mysql://databaseURL");
        PreparedStatement pst = connection.prepareStatement("show databases like ?");
        pst.setString(1, args[0]);
        ResultSet rs = pst.executeQuery();

        ArrayList<String> databases = new ArrayList<String>();
        while (rs.next()) databases.add(rs.getString(1));

        for (String s : databases){
            Statement st = connection.createStatement();
            st.execute("drop database " + s);
        }
        connection.close();
    }
} 
```

**警告：如果您不希望您的 SQL 服务器遭到洗劫，请不要向客户甚至其他开发人员透露此信息。**

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-01-19T07:03:39.297

抱歉，我们不能使用 sql 命令一次删除多个数据库

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2009-01-19T07:00:20.003

您可以尝试[mysql 5 通用例程库](http://datacharmer.blogspot.com/2005/12/mysql-5-general-purpose-routine.html) （可从[此处](https://sourceforge.net/project/showfiles.php?group_id=166288)下载）。使用它，您可以删除与正则表达式匹配的多个表。我建议仔细检查正则表达式，以防止删除您确实需要的表。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2012-02-22T10:56:16.767

```
DROP DATABASE `any-database_name`; 
```

```我只是在我的数据库名称之前和之后使用这个字符（反引号）。

* * *

## 回答 #11

> 赞同：-7
> 
> 时间：2009-01-19T07:05:42.507

使用

```
DROP {DATABASE | SCHEMA} [IF EXISTS] db_name 
```

[此处描述的](http://dev.mysql.com/doc/refman/5.0/en/drop-database.html)声明。

我不知道你是否可以使用通配符来做类似的事情

```
DROP DATABASE Whatever_% 
```

但我认为你应该尝试一下。

# python - 评估我的 Python 服务器结构

> ID：456753
> 
> 赞同：5
> 
> 时间：2009-01-19T06:51:37.137
> 
> 标签：python

我正在用 Python 构建一个游戏服务器，我只是想获得一些关于我正在考虑的服务器架构的输入。

因此，众所周知，Python 无法通过单个进程跨内核扩展。因此，在具有 4 个内核的服务器上，我需要生成 4 个进程。

以下是客户端希望连接到服务器集群时采取的步骤：

客户端最初与之通信的 IP 是网关节点。网关跟踪每台机器上有多少客户端，并将连接请求转发到客户端数量最少的机器。

在每台机器上，有一个 Manager 进程和 X Server 进程，其中 X 是处理器上的内核数（由于 Python 无法跨内核扩展，我们需要生成 4 个内核才能使用 100% 的四核处理器）

管理器的工作是跟踪每个进程上有多少客户端，并在其中任何一个进程崩溃时重新启动进程。当连接请求从网关发送到管理器时，管理器查看该机器上的服务器进程（图中的 3）并将请求转发到客户端数量最少的任何进程。

服务器进程实际上是与客户端进行通信的。

这是一个 3 机器集群的样子。为了图表的缘故，假设每个节点有 3 个核心。 [替代文字 http://img152.imageshack.us/img152/5412/serverlx2.jpg](http://img152.imageshack.us/img152/5412/serverlx2.jpg)

这也让我思考——我可以用这种方式实现热插拔吗？由于每个进程都由管理器控制，所以当我想换入新版本的服务器进程时，我只是让管理器知道它不应该再向它发送任何连接，然后我将注册新版本的进程到旧的。只要客户端连接到旧版本，它就会保持活动状态，然后在没有更多客户端时终止。

呸。让我知道你们的想法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T07:50:14.023

听起来你会想看看[PyProcessing ，它现在作为](http://pyprocessing.berlios.de/)[multiprocessing](http://docs.python.org/library/multiprocessing.html)包含在 Python 2.6 及更高版本中。它负责处理多个进程的许多机制。

另一种架构模型是使用诸如[beanstalkd](http://xph.us/software/beanstalkd/)之类的东西设置一个工作队列，并让每个“服务器”从队列中提取作业。这样，您可以根据需要添加服务器，将它们换掉等，而不必担心向管理器注册它们（这是假设您在服务器上分配的工作可以量化为“工作”）。

最后，在 HTTP 上构建整个东西并利用现有的众所周知且高度可扩展的负载分配机制（例如[nginx](http://nginx.net/) ）可能是值得的。如果您可以使通信基于 HTTP，那么您将能够使用许多现成的工具来处理您所描述的大部分内容。

# c# - linq to sql LoadWith 限制字段返回

> ID：456754
> 
> 赞同：5
> 
> 时间：2009-01-19T06:51:47.697
> 
> 标签：c#, linq

有没有办法使用 LoadWith 但指定返回的字段？

例如，如果我有两个表 1) Products 2) Categories

并做类似的事情

```
DataLoadOptions dlo = new DataLoadOptions();
dlo.LoadWith<Products>(d => d.Categories);
db.LoadOptions = dlo;

MyDataContext db = new MyDataContext();
var result = from d in db.Products
             select d; 
```

当我在探查器中检查查询时，我看到类别表中的所有行都被返回。我真正需要的是“名称”字段。

我知道我可以使用联接重写查询，但我需要将结果集作为“产品”数据类型返回，这就是我使用 LoadWith 的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T08:10:14.950

不，LoadWith 不可能。

您可以尝试在投影中使用嵌套查询，但这会很慢：每个父项 1 个查询（因此每个加载的产品需要 1 个相关类别的查询）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-22T20:20:32.000

您可以使用投影，但之后需要处理任意类型

```
select new {Order = order, ProductName = order.Product.Name,
             CustomerName = order.Customer.Name,
             OrderType = order.OrderType.Name } // etc 
```

# c++ - win32 C++ 打印 PRINTDLGEX 未声明？

> ID：456766
> 
> 赞同：0
> 
> 时间：2009-01-19T07:01:24.073
> 
> 标签：c++, winapi, printing

我想弄清楚如何用 C++ 打印。我想使用 PrintDlgEx 函数获取设备上下文，该函数需要 PRINTDLGEX 结构。但是，我无法创建 PRINTDLGEX，因为它说它未声明。我已经包含了 Commdlg.h 和 Windows.h 并链接了 Comdlg32.lib，但都无济于事。有什么我想念的吗？我可以进入 Commdlg 头文件并看到 PRINTDLGEX 已声明，但由于某种原因我不能使用它？我的操作系统是Window Vista。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T07:34:01.933

它可能未声明，因为它位于`#ifdef STDMETHOD`Commdlg.h 的第 878 行开始的块内

[`STDMETHOD`](http://msdn.microsoft.com/en-us/library/ms693342(VS.85).aspx)定义在`basetyps.h`

这篇文章[Customizing PrintDlgEx 和 IPrintDialogCallback](http://www.eggheadcafe.com/software/aspnet/30397445/customizing-printdlgex-an.aspx)也可能有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-01T16:48:40.303

您需要声明您的目标 Windows 版本足够现代以支持该结构，默认值假定一些古老的东西。通常这将在您的`stdafx.h`文件中完成。这些定义必须在包含 Windows 头文件之前。

```
#define WINVER 0x0500
#define _WIN32_WINNT 0x0500
#define _WIN32_IE 0x0501 
```

# javascript - 如何将回调函数添加到 javascript 类？

> ID：456767
> 
> 赞同：3
> 
> 时间：2009-01-19T07:02:15.727
> 
> 标签：javascript, oop, class-design, callback

javascript中的以下代码给了我错误*“this.callback is not a function*

```
function ajaxRequest()
{
    var httpObject;

    this.open = open;
    this.callback = function(){};

    function getHTTPObject()
    {
        if (window.ActiveXObject) 
            return new ActiveXObject("Microsoft.XMLHTTP");
        else if (window.XMLHttpRequest)
            return new XMLHttpRequest();
        else 
        {
            alert("Your browser does not support AJAX.");
            return null;
        }
    }

    function onstatechange()
    {
        if(httpObject.readyState == 4)
        {
            this.callback(httpObject.responseText);
        }

    }

    function open(url, callback)
    {
        httpObject = getHTTPObject();
        if (httpObject != null) 
        {
            httpObject.open("GET", url, true);
            httpObject.send(null);
            this.callback = callback;
            httpObject.onreadystatechange = onstatechange;
        }
    }
} 
```

为什么 open 方法不将回调参数视为函数？

如果是这样，那么为什么我不能在 onstatechange 函数中调用它？

我如何使这项工作？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-19T07:28:38.217

原因是因为`onstatechange`被调用为事件处理程序，并且`this`指针可能指向触发事件的`ajaxRequest`对象，而不是您期望的对象。

下面的重写将变量存储在 onstatechange() 函数有权访问的执行上下文中`this`调用的变量中。`that`这应该可以解决问题。

总而言之，如果您不彻底了解 Javascript 闭包和执行上下文，即使您了解，使用框架来执行 AJAX 请求也会好得多。jQuery 和 Prototype 是不错的选择。

```
function ajaxRequest()
{
    var httpObject;

    this.open = open;
    this.callback = function(){};
    var that = this;

    function getHTTPObject()
    {
        if (window.ActiveXObject) 
                return new ActiveXObject("Microsoft.XMLHTTP");
        else if (window.XMLHttpRequest)
                return new XMLHttpRequest();
        else 
        {
                alert("Your browser does not support AJAX.");
                return null;
        }
    }

    function onstatechange()
    {
        if(httpObject.readyState == 4)
        {
                that.callback(httpObject.responseText);
        }

    }

    function open(url, callback)
    {
        httpObject = getHTTPObject();
        if (httpObject != null) 
        {
                httpObject.open("GET", url, true);
                httpObject.send(null);
                this.callback = callback;
                httpObject.onreadystatechange = onstatechange;
        }
    }
} 
```

# visual-studio - 调试托管代码：查看返回值

> ID：456771
> 
> 赞同：2
> 
> 时间：2009-01-19T07:04:48.373
> 
> 标签：visual-studio, debugging, cpu-registers, managed-code

在 Win32 上，对于非托管代码，返回值通常存储在 EAX 寄存器中。当程序不将返回值保存在变量中时，这很有用。这可以在 Visual Studio 调试器中轻松看到。

托管代码是否有等价物？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T07:23:46.273

确实，JIT 编译器仍将 EAX 寄存器用于简单值类型，该技巧需要启用混合的本机和托管调试。事实是，目前在 Visual Studio 中没有简单的方法可以做到这一点。这是正在考虑的未来版本。我应该将其视为正式请求吗？:-)

# java - 如何使用 java 访问开放文档格式 (.ods) 的电子表格？

> ID：456778
> 
> 赞同：11
> 
> 时间：2009-01-19T07:20:54.317
> 
> 标签：java, api, spreadsheet, odf

我想用 Java 阅读、编写和创建开放文档格式的电子表格。我希望生成的 Java 程序在没有安装 OpenOffice.org 或其他支持 ODS 的程序的计算机上运行。是否存在访问此格式的库？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-19T08:01:10.037

看看 jOpenDocument： [http ://www.jopendocument.org/documentation.html](http://www.jopendocument.org/documentation.html)

特别是： http: [//www.jopendocument.org/start_spreadsheet_3.html](http://www.jopendocument.org/start_spreadsheet_3.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-10T17:34:59.910

jOpenDocument 是您所需要的。

# navigation - C#的软件可视化

> ID：456780
> 
> 赞同：7
> 
> 时间：2009-01-19T07:22:03.487
> 
> 标签：navigation, visualization

你们中有人知道用于软件可视化或 c# 中的可视化代码导航的工具吗？

我找到了一堆工具，但出于某种原因，它们都是用于 Java 的。

维基百科中有一个它们的列表，但没有一个是针对 .Net 平台的。

[http://en.wikipedia.org/wiki/Software_visualization#Tools](http://en.wikipedia.org/wiki/Software_visualization#Tools)

我对可视化代码导航非常感兴趣，因为我对大型项目非常迷失方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T08:09:27.523

我认为[NDepend](http://www.ndepend.com/Features.aspx#DependenciesView)是您正在寻找的，但不幸的是它不是免费的。

* * *

编辑：我刚刚看到也有一个[有限的开源版本](http://www.ndepend.com/Editions.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T08:26:44.837

[Reflector](http://www.red-gate.com/products/reflector/)本身可能无法提供合理的代码可视化。但是有一些插件可以通过这样的功能来增强它。

[在此](http://www.codeplex.com/reflectoraddins)页面上尝试以下插件：

*   图形
*   自动绘图仪
*   序列可视化

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T18:46:15.007

它只是沧海一粟，但当您使用它时，不妨试试 Stephan Brenner 的[.NET Reference Explorer](http://www.stephan-brenner.com/?page_id=53)。它非常简单，但我发现它对它的作用非常有用 - 图形引用程序集。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T07:30:25.403

[Red Gate 的反射器（以前是 Lutz Roeder 的）](http://www.red-gate.com/products/reflector/)允许您浏览程序集并查看它们的依赖关系。使用分析功能，您可以查看一个类的使用位置和用途。

还有一些插件可以使浏览更轻松。

除此之外，您可以使用 Visual Studios 对象浏览器浏览所有引用程序集中的所有类并查看它们的依赖关系，或者您可以使用 Visual Studio 的类视图功能来获取类及其属性的概述。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T08:19:23.620

你也可以使用 VS 自己的类图来为一些项目提供图形化的视图。虽然我认为它一次仅限于一个项目。将新的“类图”添加到项目中，然后将类或程序集等从类视图拖到其上以添加它们；或转到类视图并右键单击，查看图表。我发现这些对于环顾四周非常有用，但对于编辑来说并不是那么好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T08:56:30.223

Frederick，那些 Reflector 插件绝对很棒。我一定会尝试一下。

我也对“代码的空间表示”感兴趣。这是关于使用空间记忆来浏览代码（而不是迷路）。

有一个关于这个主题的微软研究小组： [http ://research.microsoft.com/en-us/projects/SpatialCode/](http://research.microsoft.com/en-us/projects/SpatialCode/)

在那个页面上有一些非常酷的想法，但没有软件可以下载和使用（这是你的研究！）。

有谁知道这方面有什么实用的吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T07:58:03.570

反射器当然是一种选择。

我更倾向于视觉解决方案。可能是一张图，显示哪个类正在使用哪个类，或者是一张图，显示哪个方法正在调用哪个方法。

示例（尽管不在 C# 中）包括 CodeCity、EvoSpaces、CodeCrawler 以及我在原始帖子中发布的维基百科链接中的一些示例。

所以我想知道是否有任何现有的软件\开源项目可以处理这些东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-09-06T06:38:16.087

[Softagram](https://softagram.com "Softagram.com 网站")为多种语言提供软件可视化和可视化代码导航。除了 .NET C#，它还支持 C、C++、Java、JavaScript、TypeScript、Python、PHP、Scala 和 Go。

Softagram 具有特殊的抽象功能，可以在最大的项目中实现可视化代码导航，例如 Chromium。

它是唯一能够提供集成到 Github、Bitbucket 和 VSTS 及其托管对应物（Github Enterprise、Bitbucket Server 和 TFS）的拉取请求的软件更改可视化的可视化工具。

# c++ - 创建 CPU 利用率 >70% 的线程

> ID：456786
> 
> 赞同：4
> 
> 时间：2009-01-19T07:26:42.650
> 
> 标签：c++, windows

我正在创建一个测试程序来测试计算 CPU 利用率的程序的功能。

现在我想在 CPU 利用率为 100%、50% 0% 等的不同时间测试该程序。

我的问题是如何使 CPU 利用率达到 100% 或可能 > 80%。

我认为创建一个while循环就足够了

```
while(i++< 2000)
{
   cout<<" in while "<< endl;
   Sleep(10); // sleep for 10 ms.
} 
```

运行此之后，我没有得到高 CPU 利用率。使高 CPU 密集型的可能解决方案是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T07:41:00.373

你使用循环是对的，但是：

*   你有 IO
*   你睡了

与休眠或等待 IO 的时间相比，该循环基本上不会占用太多 CPU 时间。

*要杀死一个 CPU，你只需*要给它CPU 的东西。唯一棘手的一点是确保 C++ 编译器不会优化循环。这样的事情可能应该没问题：

```
// A bit like generating a hashcode. Pretty arbitrary choice,
// but simple code which would be hard for the compiler to
// optimise away.
int running_total = 23;
for (int i=0; i < some_large_number; i++)
{
    running_total = 37 * running_total + i;
}
return running_total; 
```

请注意，我将值从循环中返回。这应该会阻止 C++ 编译器注意到循环是无用的（如果您从未在任何地方使用过该值，则循环将毫无用处）。您可能也希望禁用内联，否则我猜智能编译器可能会注意到您在不使用返回值的情况下调用该函数，并将其内联为空。（正如 Suma 在答案中指出的那样，`volatile`在调用函数时使用应该禁用内联。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T07:45:55.763

您的循环大部分时间都在休眠，这意味着它的 CPU 负载非常轻。除了睡眠之外，一定要包含一些执行任何计算的循环，像这样（因子实现留给读者作为练习，你可以用任何其他重要的函数替换它）。

```
while(i++< 2000)
{
   int sleepBalance = 10; // increase this to reduce the CPU load
   int computeBalance = 1000; // increase this to increase the CPU load
   for (int i=0; i<computeBalance; i++)
   {
     /* both volatiles are important to prevent compiler */
     /* optimizing out the function */
     volatile int n = 30;
     volatile int pretendWeNeedTheResult = Factorial(n);
   }
   Sleep(sleepBalance);
} 
```

通过调整 sleepBalance / computeBalance 你可以调整这个程序占用多少 CPU。如果您想将此作为 CPU 负载模拟，您可能需要采取一些额外的步骤：

*   在多核系统上，请确保在多个线程中生成这样的循环（每个 CPU 一个），或者多次执行该进程，并使调度可预测，显式分配线程/进程关联
*   有时您可能还想增加线程/进程的优先级来模拟 CPU 负载高且优先级高的应用程序的环境。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T20:54:29.760

使用 Windows SDK 中的 consume.exe。

当其他人已经完成工作并将其免费提供给您时，请不要自己动手。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T07:35:43.600

如果您在循环中调用 Sleep，则循环的大部分时间将花在什么都不做（睡眠）上。这就是 CPU 利用率低的原因——因为与 CPU 在每次循环迭代中执行其余代码所花费的时间相比，10 毫秒的睡眠时间是巨大的。编写代码以准确地浪费 CPU 时间是一项艰巨的任务。Roger 关于使用 CPU Burn-In 的建议是一个很好的建议。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T07:37:02.770

要使线程使用大量 CPU，请确保它不会阻塞/等待。您的 Sleep 调用将暂停线程并且不会将其调度到至少 Sleep 调用指示的毫秒数，在此期间它不会使用 CPU。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T21:09:07.950

我知道 UNIX 系统上的“是”命令，当路由到 /dev/null 时，会在单核上消耗 100% 的 CPU（它没有线程）。您可以启动它的多个实例以利用每个核心。您可能可以在您的应用程序中编译“是”代码并直接调用它。您没有指定用于 Windows 的 C++ 编译器，但我假设它具有某种 POSIX 兼容性（ala Cygwin）。如果是这种情况，“是”应该可以正常工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T07:28:01.680

获取一份[CPU Burn-In](http://users.bigpond.net.au/CPUburn/)的副本。

# vim - Vim：对目录中的文件应用设置

> ID：456792
> 
> 赞同：109
> 
> 时间：2009-01-19T07:29:59.367
> 
> 标签：vim

如何为当前目录下的所有文件指定 Vim 设置？

理想的解决方案是，如果 Vim 在搜索 ~/.vimrc 之前搜索并读取当前目录中的 .vimrc，并将那里的设置应用于整个树。

我见过一个[插件](http://www.vim.org/scripts/script.php?script_id=1860)，但这意味着应用的设置不透明，因为它们需要安装插件。相反，模式行是透明的，因为无论用户的 vimrc 或特定的 vim 调用如何，模式行设置都将应用于该文件。

我尝试过的事情是

*   在工作目录中放置一个 .vimrc
*   `:so vimrc`在模型行中。

我想出于安全原因，两者都不起作用。我不需要 vimrc 的全部功能；绑定到模式行可接受的设置就足够了。我的目标是让 vimer 更容易在项目中采用编码标准。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-01-19T08:04:29.453

你可以把这样的东西放进去`$VIM/vimrc`

```
autocmd BufNewFile,BufRead /path/to/files/* set nowrap tabstop=4 shiftwidth=4 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2010-07-02T10:16:45.340

我强烈建议不要使用`set exrc`

即使使用`set secure`, 在 *nix 下，如果您拥有该文件，vim 仍将运行自动命令、shell 等。因此，如果您碰巧编辑了该 tarball 中的文件，我发送给您的文件`.vimrc`包含：

```
autocmd BufEnter * :silent! !echo rm -rf ~/ 
```

你可能会比我更不开心。

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2009-01-19T08:33:12.983

我是[插件方式](https://github.com/LucHermitte/local_vimrc)的倡导者。有几个原因：

*   模式特别有限：我们不能设置变量（调整其他（ft）插件，比如“for-snippet 的大括号应该在换行符上吗？”），或者从它们调用函数（我不限制自己为了编码标准，我还根据当前目录设置了要使用的makefile）
*   [DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself) : 对于modelines，需要在每个文件中重复设置，如果要设置的东西太多或要更改的调整太多，很快就会变得难以维护，而且需要使用[模板扩展插件](http://vim.wikia.com/wiki/Category:Automated_Text_Insertion)（如果您的项目中有多个 vimer，您应该考虑这一点）。
*   不是每个人都使用vim来开发。我不想被其他人的编辑设置打扰，我为什么要寄生他们的？
*   要求 vimer 安装相同的插件更容易，而不是要求他们复制粘贴和维护 .vimrc 中的相同行
*   设置可以与其他项目文件一起保存（cvs/svn/git/whatever）
*   每个项目都有一个配置文件真的很容易——通过插件，我有一个全局配置文件，用于整个项目的编码标准，以及每个子项目的特定配置文件（使用哪个 makefile，调用哪个可执行文件, ...)

顺便说一句，[某事的解决方案](https://stackoverflow.com/questions/456792/vim-apply-settings-on-files-in-directory#456846)可用于获取单个配置文件。这与插件方法非常相似，除了 .vimrc 必须使用非全局选项寄生，并且它不支持轻松的多个/共享配置文件。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2013-04-18T23:30:02.397

这个问题很老，但它似乎是一个非常自然和持久的问题。

我的解决方案很简单。`.vimrc`我在项目的根目录中放置了一个文件。文件的第一行`.vimrc`通常是 sources `~/.vimrc`，然后添加我想要的特定配置。我别名`tvim='vim -u .vimrc'`, 并`tvim`在我的个人项目目录中使用。“tvim”代表“受信任的 vim”，这意味着如果我在一个包含`.vimrc`文件的目录中执行它并且出现问题，除了我自己之外，我没有人可以责备，因为我明确表示我信任它。此外，我将其中的一组存储起来，以便有时我可以软链接我想要用于特定类型项目的那个。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-01-19T23:25:15.960

实际上支持将 .vimrc 放在工作目录中，默认情况下仅禁用。有关详细信息，请参阅`:h 'exrc'`，`:h startup`设置将启用从当前目录`'exrc'`读取。`.vimrc`

使用时也建议`:set secure`这样做。这会在当前目录中锁定`:autocmd`、shell 和 write 命令。`.vimrc`

可能值得关注的另一件事是`:h session`使用标准视图和项目设置设置会话 ( )。

综上所述，我可能会选择 Luc Hermitte 本人详述的插件选项。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-11-02T09:40:52.957

为了最大限度地减少这些天任何“自动运行”功能的安全风险，我可以建议您使用 vim 的现有功能而不是插件（便携包）吗？

例如。

我的本地文件夹的 vimrc 文件名为“_gvimrc”（故意）。这降低了像 phen 这样的人以我们为代价自娱自乐的希望。:-)

在我的 $VIM/.vimrc 文件中，我插入了：

```
if filereadable("_gvimrc")
    source _gvimrc
endif 
```

在末尾。

我在“fileexists()”上使用“filereadable()”，因为后者在同时打开多个（10+）文件时会有些古怪（不知道为什么）。

当然，您可以提供自己独特的文件名，以进一步混淆潜在的麻烦制造者。例如“_mygvimrc”、“_gobbledygook”等。你只需要确定一个标准化的名称并在你的 $VIM/.vimrc 中相应地获取它。依靠 vi/vim 内部来排除可移植性问题。但是，不要将其命名为 .vimrc（或 _vimrc）以防止递归获取，以防您稍后使用 vim 编辑 $VIM/.vimrc 文件。

从 Windoze 98SE 到 Windork XP Pro 以及现在的 Windorkier 7（已经 5 年以上）一直在使用它。我将在资源管理器中标记一个 .txt 文件列表，然后使用“使用多个 Vim 编辑”，导致同时打开多个 vim 窗口。对于我的工作，我每天都会这样做几次。所有文件都使用我在本地 _gvimrc 中设置的内容进行处理。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-19T07:37:56.090

假设人们不是每隔几天就添加文件，您可能可以在每个文件的顶部添加一个模式行。事实上，如果您的版本控制系统允许，您可能会强制执行一条规则，即每个文件在签入时必须有一个模式行。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-08-17T02:34:39.783

## 使用“编辑器配置”

如果您想强制执行的编码标准种类与缩进样式、制表符大小、文件格式和字符集有关，那么您可能需要查看["editorconfig"](https://editorconfig.org/)，这是一个用于指定此类设置的交叉编辑器标准一个特定的项目，并让所有编辑人员都遵循该配置。

“editorconfig”规范允许项目根据项目中的文件扩展名或名称请求不同的设置。（所以你可以使用 TAB 来生成 Makefile，你的 Python 脚本使用 4 个空格，你的 shell 脚本使用 2 个空格来缩进。）

你需要一个插件才能在 Vim 中使用“editorconfig”。官网提供了一个，但我个人推荐[sgur/vim-editorconfig](https://github.com/sgur/vim-editorconfig)，它是用纯 Vimscript 编写的，所以你不必太担心外部依赖。

由于“editorconfig”旨在跨编辑器兼容性，它的功能非常有限，所以如果你想要一致的空格、文件格式（DOS vs. Unix）和编码（Unicode utf-8等），那么“editorconfig” “ 是给你的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-05-05T06:24:05.053

出于安全原因，我同意插件方法。

有一个非常好的插件尚未提及。它允许您`.lvimrc`在项目目录中使用 a 。

试试“localvimrc”：

[http://www.vim.org/scripts/script.php?script_id=441](http://www.vim.org/scripts/script.php?script_id=441)

[https://github.com/embear/vim-localvimrc](https://github.com/embear/vim-localvimrc)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-03-15T19:48:22.497

试试 vim-localrc

```
~/
|- .local.vimrc     (1)
`- project/
   |- .local.vimrc  (2)
   `- src/
      |- .local.vimrc   (3)
      `- main.c 
```

[https://github.com/thinca/vim-localrc/blob/master/doc/localrc.txt](https://github.com/thinca/vim-localrc/blob/master/doc/localrc.txt)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-08-02T06:58:24.310

我查看了存在的插件，并没有真正喜欢其中的任何一个，所以我编写了一个简单的函数来搭载[vim-fugitive](https://github.com/tpope/vim-fugitive)。这样做的好处是它知道项目的根始终是存储库的根，另外我可以散列文件以保留信任表。只需将以下内容放入您的`.vimrc`文件中。

```
function LoadRepoVimrc()
  let l:path = fugitive#repo().tree('.vimrc')
  if filereadable(l:path)
    let l:sha1 = fugitive#repo().git_chomp('hash-object',l:path)
    if !exists('g:SAFE_VIMRC') | let g:SAFE_VIMRC = {} | endif
    if has_key(g:SAFE_VIMRC,l:path) && g:SAFE_VIMRC[l:path] ==? l:sha1
      execute 'source '.fnameescape(l:path)
    elseif confirm("Trust ".l:path."?", "&Yes\n&No",2) == 1
      let g:SAFE_VIMRC[l:path] = l:sha1
      execute 'source '.fnameescape(l:path)
    else
      execute 'sandbox source '.fnameescape(l:path)
    endif
  endif
endfunction
autocmd User FugitiveBoot call LoadRepoVimrc()
set viminfo ^= ! 
```

如果在`!`设置中设置了该选项`viminfo`，则`SAFE_VIMRC`字典将在运行之间保留（请注意在`^`选项前面添加，以免弄乱该`n`选项）。

# winforms - 在 C# Windows 窗体中将 AD 身份验证凭据传递给 IE 浏览器

> ID：456798
> 
> 赞同：1
> 
> 时间：2009-01-19T07:33:28.143
> 
> 标签：winforms

我有一个 Sharepoint 站点，我想使用 C# Windows 应用程序在 IE 中打开这个站点。我在 IE 中成功打开了该站点，但我的问题是如何将 UserCredentials 发送到该站点。它使用默认凭据在 IE 中打开该站点。我的默认凭据是用户名：systemaccount 密码=123，但我想在 IE 中使用一些不同的凭据打开 Sharepoint 站点，例如用户名：abc 密码：123（我有“abc”作为 AD 和 Sharepoint 用户）

这是我在 IE 中打开 Sharepoint 站点的代码

```
SecureString sec = new SecureString();
             sec.AppendChar('1');
             sec.AppendChar('2');
             sec.AppendChar('3');

Process.Start("IEXPLORE.EXE", url,"abc",sec,"moss.local"); 
```

这是我的 Sharepoint 站点 URL....... abc 是我要登录的用户名 sec 是密码 SecureString 密码 moss.local 是我存在“abc”AD 用户的域......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-25T05:38:52.537

试试这个，它似乎对我有用，并且“用户”可以访问该站点，而不是登录的站点：

```
ProcessStartInfo startInfo = new ProcessStartInfo(@"c:\Program Files\Internet Explorer\iexplore.exe", "http://server/sites/spsite/page.aspx");
startInfo.UserName = @"user";
SecureString p = new SecureString();
p.AppendChar('p');
p.AppendChar('w');
p.AppendChar('d');
startInfo.Password = p;
startInfo.Domain = "mydomain";
startInfo.UseShellExecute = false;
Process.Start(startInfo); 
```

# iphone - iPhone 应用程序 - 在执行 IBAction 时显示 UIActivityIndi cator

> ID：456802
> 
> 赞同：1
> 
> 时间：2009-01-19T07:36:27.560
> 
> 标签：iphone

我想在我的导航栏中有一个按钮，让用户刷新表格视图的内容。表格视图已经填充，一旦用户按下刷新按钮，我想在获取要显示在表格上的项目时显示 UIActivityIndi​​cator。

我尝试在调用方法之前放置一个 [indicator startAnimating] 以获取表的新数据（其中指标的类型为 IBOutlet UIActivityIndi​​cator* 并映射到 IB 中的控件），但指标没有显示。相反，导航栏刷新按钮处于按下位置，直到控制从此 IBAction 方法返回。

如何在方法执行完成时显示指标？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T08:30:38.840

您需要在后台获取表格的新数据。这可能是异步网络调用或线程，具体取决于您的刷新代码的作用，但 UI 类型假定按钮按下几乎是瞬时的。

你会注意到你的整个 UI 都被锁定了（不仅仅是刷新按钮），所以无论如何这都是一件好事，尽管实现起来要困难得多。

# asp.net - ASP MVC Cookie 不持久

> ID：456807
> 
> 赞同：56
> 
> 时间：2009-01-19T07:38:16.510
> 
> 标签：asp.net, asp.net-mvc, cookies

我有一个 ASP MVC 应用程序，其中包含一些看似简单的代码来保存和检索 cookie，但由于某种原因它们不会持续存在。控制器中的代码是：

```
if (System.Web.HttpContext.Current.Response.Cookies["CountryPreference"] == null)
{
    HttpCookie cookie = new HttpCookie("CountryPreference");
    cookie.Value = country;
    cookie.Expires = DateTime.Now.AddYears(1);
    System.Web.HttpContext.Current.Response.Cookies.Add(cookie);
} 
```

并再次加载它：

```
if (System.Web.HttpContext.Current.Request.Cookies["CountryPreference"] != null)
{
    System.Web.HttpContext.Current.Request.Cookies["CountryPreference"].Expires = DateTime.Now.AddYears(1);
    data.Country = System.Web.HttpContext.Current.Request.Cookies["CountryPreference"].Value;
} 
```

出于某种原因，cookie 始终为空？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-02-26T12:03:17.880

问题在于以下代码：

```
if (System.Web.HttpContext.Current.Response.Cookies["CountryPreference"] == null) 
```

当您尝试使用 Response 对象而不是 Request 来检查 cookie 的存在时，ASP.net 会自动创建一个 cookie。

在此处查看此详细帖子：[http ://chwe.at/blog/post/2009/01/26/Done28099t-use-ResponseCookiesstring-to-check-if-a-cookie-exists!.aspx](http://chwe.at/blog/post/2009/01/26/Done28099t-use-ResponseCookiesstring-to-check-if-a-cookie-exists!.aspx)

* * *

如果链接再次断开，请引用文章中的内容....

> 简短的解释，如果您不喜欢阅读整个故事
> 
> 如果您使用“if (Response.Cookies[“mycookie”] != null) { ... }”之类的代码，ASP.Net 会在后台自动生成一个名为“mycookie”的新 cookie 并覆盖您的旧 cookie！始终使用 Request.Cookies-Collection 来读取 cookie！

[[文章中的更多详细信息](http://chwe.at/blog/post/2009/01/26/Done28099t-use-ResponseCookiesstring-to-check-if-a-cookie-exists!.aspx)]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-13T14:35:37.923

在简历中，不要使用“ **Response** ”读取cookies，使用“ **Request** ”。

# asp.net - 创建我自己的服务器以运行数据库并处理 WCF 服务

> ID：456808
> 
> 赞同：-1
> 
> 时间：2009-01-19T07:39:26.510
> 
> 标签：asp.net, sql-server, web-services

我真的很想得到一些帮助，因为我几乎不知道从哪里开始。

我厌倦了没有地方可以正确测试任何网络代码，而且我发现的免费托管网站只支持我想要的一半。

**我想设置我自己的服务器，能够发送网页、运行数据库和处理 WCF 服务。**

我将使用旧的 Windows 盒子，但我并不完全期待大量的流量^_^

目前我唯一的想法是安装 Windows Server 2008 企业版（作为学生有它的用途）并尝试找出互联网信息服务。这会让我提供一个 ASP.NET 网站吗？

**我正在寻找的是一些指导以及您认为可能对我有帮助的任何资源。**

编辑：

不知道为什么我被否决了，也许与编程无关？如果我现在无处运行，我无法正确测试我的代码，可以吗？我正在拼命寻找教程或文章，告诉我我需要做什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T08:09:23.267

**编辑**

我误解了这个问题。我会保留我的旧答案，以防它帮助任何人:)

要安装，请转到添加/删除程序（或 Vista 中的程序和功能），在左侧栏中将有 XP 中的“添加或删除 Windows 组件”和 Vista 中的“打开或关闭 Windows 功能”（为什么更改名称DAMN-IT !!!??) 找到“Internet Information Services”并检查它是否还没有。继续安装它。

安装后，进入管理服务，然后进入 IIS 管理器。在这里您可以配置您的 IIS 安装。

我会自己玩弄它，然后发回我发现的任何东西。但我不是 ASP.net 的人。我喜欢 PHP :)

**旧答案**

请注意，如果您还不知道：如果您在您的机器上设置了一个网络服务器，您只需访问**[http://（您的](http://(your)服务器的 IP）就可以从您的网络中访问它**

要找出你在 Windows 中的 IP，点击**Start**然后**Run**，输入**cmd**回车，然后输入**ipconfig**，你会得到类似的东西：

```
Windows IP Configuration

Ethernet adapter Local Area Connection:

        Connection-specific DNS Suffix  . : <BLABLABLA>
        IP Address. . . . . . . . . . . . : 192.168.1.155
        Subnet Mask . . . . . . . . . . . : 255.255.255.0
        Default Gateway . . . . . . . . . : 192.168.1.18

Ethernet adapter Wireless Network Connection:

        Media State . . . . . . . . . . . : Media disconnected 
```

“IP 地址”（在我的示例中为**192.168.1.155**）是您的本地（即仅在您的路由器后面有效）IP

最简单的方法是在你的旧盒子上安装一个网络服务器，然后设置你的路由器将端口 80 转发到那个盒子（假设你有电缆连接）。有关详细信息，请查看[http://www.portforward.com/](http://www.portforward.com/)。

然后，您可以使用路由器的 IP 地址从网络外部访问您的网站。要查找该 IP 地址，请从您的网络*内部*[访问 http://www.whatismyip.com/ 。](http://www.whatismyip.com/)

 *因此，例如（虚构的 IP 警告），如果您的 IP 是**300.424.234.123**，那么您可以从您的网络外部（互联网上的任何地方）访问：http: **[//300.424.234.123](http://300.424.234.123)**

如果您想为域服务，事情变得更加棘手。您必须在[http://godaddy.com](http://godaddy.com)之类的公司注册域，然后将其指向您的 IP。然后，您必须配置您的网络服务器以根据请求的域提供正确的文档。在 Apache 中，您使用 VirtualHosts 来执行此操作。我不知道如何使用 IIS 执行此操作。

这些是涉及的步骤。如果您对某个特定问题有任何疑问，我很乐意提供帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T08:33:09.177

首先，您无需为学习/测试目的而安装 Windows Server 2008 企业版。

您真正需要的是：

*   Web 服务器 - IIS 包含在所有最新版本的 Windows 中，包括 XP 和 Vista。
*   数据库引擎 - SQL Server Express 是免费的，包含在 Visual Studio 中，或可从[http://www.microsoft.com/express/](http://www.microsoft.com/express/)获得。您还应该从[http://www.microsoft.com/downloadS/details.aspx?familyid=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&displaylang=en](http://www.microsoft.com/downloadS/details.aspx?familyid=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&displaylang=en)获取 SQL Server Management Studio Express 。

不知道您的经验水平，我不想详细介绍所有细节，但由于您也在做 WCF，所以任何有关 WCF 的书都以设置 IIS 的章节开头。如果您需要有关设置 IIS 和 SQL Server 的确切资源，请发表评论。

# javascript - 嵌套和多重 烦恼 实际上，我正在尝试在另一个盒子中移动一些盒子。我让它工作了，但是两个块都不会互相干扰。我该怎么办？我怎样才能使块相互交叉？我尝试使用样式：位置，但它不起作用。 这是我一直在使用的代码： <marquee direction="down" behavior="alternate" scrollAmount=10 style="border:2px solid blue;"> 问问题 praveenjayapal 问问题 2009-01-19T07:43:33.083 11460 次 This question shows research effort; it is useful and clear 66 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 实际上，我正在尝试在另一个盒子中移动一些盒子。我让它工作了，但是两个块都不会互相干扰。我该怎么办？我怎样才能使块相互交叉？我尝试使用样式：位置，但它不起作用。 这是我一直在使用的代码： <marquee direction="down" behavior="alternate" scrollAmount=10 style="border:2px solid blue;"> <marquee behavior="alternate" scrollAmount=50 > <img src="img1.JPG"> </marquee> <marquee behavior="alternate" scrollAmount=10 > <img src="img1.JPG"> </marquee> </marquee> 我究竟做错了什么？ 请不要使用 marquee 标签，它是非标准的且已弃用。为任何类型的动画使用一些 JavaScript 库，如jQuery UI 。 javascripthtmlmarquee 4 4 回答 4 This answer is useful 69 哦，亲爱的主！ 好。它们不会交叉，因为它们静态地一个在另一个之上。第二个选框不能超过第一个。 您可以通过使用绝对定位将选取框彼此分开来解决*这个问题。然后用不同的水平和垂直运动对每一个进行双重嵌套： <div style="border:2px solid blue; position: relative;"> <marquee direction="down" behavior="alternate" scrollAmount="10"> <marquee behavior="alternate" scrollAmount="50"><img src="img1.jpeg" alt="oh no" /></marquee> </marquee> <marquee direction="down" behavior="alternate" scrollAmount="20" style="position: absolute; top: 0;"> <marquee behavior="alternate" scrollAmount="10"><img src="img1.jpeg" alt="help meee" /></marquee> </marquee> </div> *：对于“解决”的值“x”，其中 x=“弄得一团糟”。 这仅用于说明目的。请不要使用这个。 于 2009-01-19T13:24:30.930 回答 This answer is useful 51 请不要使用 marquee 标签，它是非标准的且已弃用。为任何类型的动画使用一些 JavaScript 库，如jQuery UI 。 于 2009-01-19T07:48:31.403 回答 This answer is useful 5 使用 JavaScript 库，或者如果不使用 JavaScript 的 settimeout 加上绝对定位和 dhmtl。 于 2009-01-19T08:25:17.430 回答 This answer is useful 3 我曾经收到一封来自一家公司的电子邮件（无 javascript 环境），试图向我推销一些东西。签名使用选取框标签一次一条地滑入行中，然后它们保持不变。它做得非常出色 - 足以吸引眼球的动作，当然不会像我们通常对选框所期望的那样令人畏惧。 The lessons I learned are a) that marquee still has its place, no matter how small, and b) 'All generalisations are bad'. As for non-standard/deprecated - Outlook has pretty much dictated that the only rule in HTML emails is that if it works, it's good. There no use in polishing a you-know-what. 于 2009-03-04T18:24:51.407 回答 Related 4 java - 如何计算 Criteria Api 中的行数 1 sql - 从单独的表单中选择数据表子表单上的下一条记录？ 1 php - 蛋糕PHP。每页多个表格 2 sql - 在 where 上使用 LIKE 缓慢更新 2 html - 如何在 Blogger 中使我的博客元素的背景透明？ 3 php - 正则表达式在一些斜线之间替换 4 c# - 使用 LINQ 进行延迟分区序列 2 objective-c - OSX 串行读取冻结/挂起 1 django - django south - 使用 AbstractUser 时过时的用户模型 1 dart - Dart 1.0 上 web ui 的新构建选项 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：456815
> 
> 赞同：66
> 
> 时间：
> 
> 标签：javascript, html, marquee

实际上，我正在尝试在另一个盒子中移动一些盒子。我让它工作了，但是两个块都不会互相干扰。我该怎么办？我怎样才能使块相互交叉？我尝试使用样式：位置，但它不起作用。

这是我一直在使用的代码：

```
<marquee direction="down" behavior="alternate" scrollAmount=10 style="border:2px solid blue;">
  <marquee behavior="alternate" scrollAmount=50 >
    <img src="img1.JPG">
  </marquee>
  <marquee behavior="alternate" scrollAmount=10 >
    <img src="img1.JPG">
  </marquee>
</marquee> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-01-19T13:24:30.930

哦，亲爱的主！

好。它们不会交叉，因为它们静态地一个在另一个之上。第二个选框不能超过第一个。

您可以通过使用绝对定位将选取框彼此分开来解决*这个问题。然后用不同的水平和垂直运动对每一个进行双重嵌套：

```
<div style="border:2px solid blue; position: relative;">
    <marquee direction="down" behavior="alternate" scrollAmount="10">
        <marquee behavior="alternate" scrollAmount="50"><img src="img1.jpeg" alt="oh no" /></marquee>
    </marquee>
    <marquee direction="down" behavior="alternate" scrollAmount="20" style="position: absolute; top: 0;">
        <marquee behavior="alternate" scrollAmount="10"><img src="img1.jpeg" alt="help meee" /></marquee>
    </marquee>
</div> 
```

*：对于“解决”的值“x”，其中 x=“弄得一团糟”。

这仅用于说明目的。请不要使用这个。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-01-19T07:48:31.403

请不要使用 marquee 标签，它是非标准的且已弃用。为任何类型的动画使用一些 JavaScript 库，如[jQuery UI 。](http://ui.jquery.com)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-19T08:25:17.430

使用 JavaScript 库，或者如果不使用 JavaScript 的 settimeout 加上绝对定位和 dhmtl。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-04T18:24:51.407

我曾经收到一封来自一家公司的电子邮件（无 javascript 环境），试图向我推销一些东西。签名使用选取框标签一次一条地滑入行中，然后它们保持不变。它做得非常出色 - 足以吸引眼球的动作，当然不会像我们通常对选框所期望的那样令人畏惧。

The lessons I learned are a) that marquee still has its place, no matter how small, and b) 'All generalisations are bad'. As for non-standard/deprecated - Outlook has pretty much dictated that the only rule in HTML emails is that if it works, it's good. There no use in polishing a you-know-what.

# sql-server - SQL Server Management Studio 是否像看起来那样糟糕？如何查看relatiosnip属性？

> ID：456817
> 
> 赞同：2
> 
> 时间：2009-01-19T07:45:20.367
> 
> 标签：sql-server, sql-server-2005

所以，我使用的是 SQL Server Management Studio Express，到目前为止它的工作还不错，忽略了一些奇怪的地方。

但是，当我碰巧删除父表中的一行时，我碰巧删除了一大堆数据。所以我想我必须在这种关系中启用级联删除。但是，如何确定这一点？如果您在 DB Diagram 中双击一个关系，您唯一的选择是删除，并且工具提示只显示 FK 关系名称。

这个家伙和我有同样的问题：http: [//social.msdn.microsoft.com/forums/en-US/sqldatabaseengine/thread/1f9c1e8f-b719-476d-828e-91ac6722096a/](http://social.msdn.microsoft.com/forums/en-US/sqldatabaseengine/thread/1f9c1e8f-b719-476d-828e-91ac6722096a/)

那么，我是否遗漏了什么，或者这是另一种情况，软件公司故意做了一半的工作？我有一个 MSDN 超（或任何最高级别）许可证，那会更好吗，或者，有没有可以使用的第 3 方工具？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T08:13:33.443

在 SQL Server Management Studio Express 中，您是否没有“设计”表的选项。（右击表格，然后设计） ? 然后，您应该有一个带有图标的附加工具栏，该图标看起来像 3 个表格及其关系。该按钮的工具提示显示“关系”。当您单击该按钮时，您将看到该表的外键约束，并且在对话框中，您可以指定 FK 的 UPDATE & DELETE 规则。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T08:59:22.760

图表工具不是很好。

如果您使用对象资源管理器打开表，打开您感兴趣的表，打开键，您应该能够找到您的外键，右键单击它并选择修改（或选择脚本出来（到窗口/文件/等））。

这适用于 SSMS 2008，尚未在 2005 Express 中尝试过，但如果它不存在我会感到惊讶（因为它基本上是很久以前内置于查询分析器中的功能）

# msdn - 编码测试 - 允许使用网络？

> ID：456818
> 
> 赞同：5
> 
> 时间：2009-01-19T07:45:40.460
> 
> 标签：msdn

在招聘 .NET Web 开发人员期间，我给候选人进行了编码测试。

我倾向于将候选人限制在测试服务器上安装的 MSDN - 我认为它包含候选人完成任务所需的一切。

我承认，这不是正常情况，因为我不希望候选人在不使用网络的情况下完成他的工作。
另一方面，我不希望候选人在谷歌上搜索完整的示例并复制粘贴，我想评估他的技能。

问题是**我需要**在考试期间允许免费使用网络吗？

如果您认为整个编码测试是错误的 - 我想听听您可能为我提供的替代方案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-19T08:07:43.770

正如您所说，*“我不希望候选人在不使用网络的情况下完成他的工作”，*为什么在考试期间也不允许这样做呢？如果他确实复制和粘贴怎么办？我也这样做。当然，关键是要知道去哪里寻找，辨别你发现的东西并*聪明*地应用它。您想雇用记忆力极好的人还是可以为您开发软件的人？

当我在学校时，计算器刚刚变得负担得起。由于它们的使用被认为是不可避免的，因此考试发生了变化。不再像以前那样测试简单的数字运算（这在当时很重要）。而是要测试解决问题的技巧。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-19T09:13:05.773

我通常允许候选人使用他们想要的任何资源。在他们完成后，我和他们坐下来一起检查他们的代码，询问他们为什么选择这种特定方法等问题。

如果几分钟的谷歌搜索不仅足以复制粘贴一些代码，而且足以了解它以能够捍卫其中的决定，那么他就足够聪明了！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-19T07:57:26.503

有一些测试可以提供 Web 访问，但也有一些没有真正意义的地方。

**允许 Web 访问的情况**

*   当它不太可能在网上找到 60% 的代码时
*   当他/她完成代码后你会要求解释代码时
*   使用 SQL 查询的一个非常具体的解决方案，在网络上不太可能找到

**不允许网络访问的情况**

*   一些基本程序，如递归、斐波那契、阶乘、字符串操作、小技巧程序等。即使在某些情况下也不需要计算机

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-19T07:57:49.280

我对面试中的编码测试持怀疑态度。我认为我看到的很多测试都代表了非常具体的（人造的，非现实世界的）问题，你可以使用互联网来解决它们。

我认为知道如何用心去解决这些问题并不重要——通常更重要的是你知道如何以及在哪里寻找答案。

如果你想在面试中测试这些人，我认为最好问他们一些概念性的问题，而不是具体的编程问题。例如：关于面向对象、多态性、n 层应用程序设计等问题。

或者作为来自 ASP.NET 世界的示例，向受访者提出以下问题：什么是 ViewState、什么是回发、什么是会话/应用程序状态等。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-19T07:57:50.090

如果你想了解应聘者在工作中的表现，我认为最好尝试使测试条件尽可能接近实际工作条件。

通过要求候选人解释他/她的代码应该很容易防止复制和粘贴从裂缝中溜走。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-19T07:57:22.433

好吧，您需要注意的一件事是，您雇用的开发人员可能不知道他在为您工作期间会遇到的所有事情。如果你问他一个他不知道的问题，你会希望他研究这个问题，然后带着证明他理解他刚刚学到的概念的证据回到你身边。

我说让他们使用网络——但请他们用自己的话解释他们的代码是如何工作的。我的大部分知识来自在线资源。但是，我确保我写的每一行代码我都理解。

有一个特定领域的开发人员应该知道的基线知识；但你也想弄清楚他能多快学习新事物。一个很好的测试 IMO 是提出一个你知道他*不*知道的问题，看看他能用他是贵公司员工时所拥有的资源解决多久。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-19T07:59:44.597

你的目标是查看候选人有哪些基本知识，如果他可以在不从网上复制解决方案的情况下进行编码，那么就不要允许互联网访问。如果你想看看他采用什么策略来解决问题，如果他愿意，让他使用网络。

如果候选人能够解决更大规模的问题，而不仅仅是解决简单的编程问题，我个人觉得会更有趣。所以我倾向于问他在编程时使用的方法（单元测试？曾经使用过它吗？你怎么看？）。这给了我比在面试情况下编码更好的画面。

有时，如果您事先要求应聘者带上一页的编码示例，以了解他们的编码风格，这会有所帮助。这也节省了你面试的时间。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-19T08:41:30.127

确保候选人足智多谋是很重要的——你不希望你的程序员在遇到困难时坐在那里，不前进；您希望他们使用手头的任何资源——无论是 MSDN、挑选别人的大脑、使用网络等——来完成工作。从网上剪切粘贴似乎是作弊，但是（a）如果你仔细设计你的任务，那么它将是独一无二的，以至于没有他们可以从网上复制的标准答案，并且（b）不是'重用现有代码是构建软件的关键部分吗？这与使用 3rd-party 库没有太大区别，以避免重新发明轮子。当然，不利的一面是，您还希望他们展示他们可以开发算法，因此独特的任务需要包含一些元素，而这些元素需要在网络上没有解决方案的情况下。麻烦的是，

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-19T09:15:28.640

允许应聘者使用网络，但事先告诉他，如果他使用网络，你必须评估他是如何解决问题的。

如果他将网络用于一些简单的事情，例如查找他忘记的语法或参数，请不要标记他。这很正常。

如果他使用网络来查看特定功能的使用方式，请不要标记他。这很正常。

如果他搜索了一个特定的代码，然后复制粘贴它，然后询问他该代码是如何工作的。如果他能解释代码是如何工作的，那么就没有理由给他打分。如果他不看他得到代码的网站就无法解释，你必须标记他。

如果他使用 stackoverflow.com，请查看他的个人资料中的问题、答案和徽章。从那里，您可以检查他的程序员有多好。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-18T23:22:56.703

这一切都取决于你想从你成功的候选人身上得到什么。我反对这样一种观点，即知道如何 google 会让你成为一名优秀的程序员，因为一个简单的事实是，互联网上到处都是坏例子和好例子。您真的不希望您的代码库反映您的谷歌用户在他从网络上剪切和粘贴所有代码的那一天是多么幸运。您希望它展示您的团队理解和热衷的合理实践、经过验证的方法和优雅、高效的解决方案。不是一堆彼此不相似的风格。知道如何从互联网获得帮助会带来很多好处，但是真正的知识和古老的智慧每天都在丢失，那些不知道的人

如果你真的想让你的候选人访问网络，那么一定要这样做，但要让问题变得困难并仔细检查结果，看看他们是否选择了他们找到的第一个解决方案，或者他们是否选择了最佳解决方案。问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-19T10:00:07.567

与许多其他受访者一样，我宁愿雇佣一个足智多谋的开发人员，他们知道如何充分利用网络来充分利用其他人的经验和以前的工作，而不是一个将自己和他的应用程序限制在 MSDN 做事方式的开发人员。

我一直在复制其他人的代码——实际上是每天。它的诀窍在于快速找到正确的解决方案并将其集成到您现有的工作中。

因此，让您的候选人使用网络并询问他是如何得出解决方案的。您可能会从他的方法中了解更多关于他的信息，而不是从他如何记住以前的解决方案。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-19T10:33:44.737

我会做的三件事。

让申请人连同他们的简历一起发送一个编码示例。

让申请人编写一些真实的代码（甚至可能与团队中的开发人员结对编程），这将向您展示他们是否可以实际使用这些工具。互联网也是一种工具，所以他们应该能够使用互联网。

面试时让应聘者在黑板上用伪代码解决问题。在这种情况下，您可以通过帮助他们成为他们的“互联网”。

这三种方法将向您展示不同的东西。第一个是一个很好的预警机制，但很容易被伪造（他们可以从网上的某个地方下载 oss 代码）。第二个是看看他们是否真的可以编码，但如果他们不熟悉你使用的工具，他们可能会得分很差。第三个将向您展示他们是否可以解决理论问题，但不会向您展示他们是否真的是优秀的团队成员，或者他们是否编写了可维护的代码。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-19T13:59:24.777

我最近有一个朋友开始在 IM 上与我交谈，他正在参加编码测试工作面试。他有几个 SQL 问题。起初我想，见鬼，你必须自己做这件事。我不会帮你在面试时**作弊。**

然后我又想了一遍。作为他工作的一部分，多年来我一直在回答问题并与他讨论有关 IM 的各种技术问题。所以当他在现实世界中遇到工作问题时，如果他被录用，他会做同样的事情。

我们很少谈论它，但是拥有一个很好的朋友网络来提问，并且知道如何在网上搜索相关的答案是成为一名有效的程序员或系统管理员的重要组成部分。我遇到过一些超级聪明的程序员，但并不真正知道如何在网上查找信息。他们错过了很多，有点脱离了循环。知道如何使用资源应该很重要。

当我进行采访时，我经常问人们他们阅读了哪些网站，他们使用了哪些开发工具，以及为什么。这是一个类似的事情。当然这不是关于他们如何编写 x 行代码，而是关于他们如何工作。

没有如何绕过某人只需复制和粘贴“答案”。首先，不要问有答案的问题。其次，当我面试时，我喜欢给人们一些代码，要求他们重构它，让他们谈论他们的想法。然后让他们编写一些实现某个功能的新代码。与他们配对程序。结对编程时很难隐藏无法编码。当他们配对时，说“让我们去查找日期时间库上的 api”是完全有道理的。

# c - GMP不能应付一个领先的“+”？

> ID：456826
> 
> 赞同：2
> 
> 时间：2009-01-19T07:51:20.010
> 
> 标签：c, gmp

考虑以下代码

```
// BOGP.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include "gmp-static\gmp.h"
#include <stdlib.h>         /* For _MAX_PATH definition */
#include <stdio.h>
#include <malloc.h>

#define F(x) mpf_t x; mpf_init( x );

int main(int argc, char* argv[])
{
    F(foo);
    char * buff;
    mp_exp_t exp;

    mpf_init_set_str( foo, "123", 10 );
    buff = mpf_get_str(NULL, &exp, 10, 0, foo);
    puts( buff );
    puts("\n");
    free(buff); 

    mpf_init_set_str( foo, "-123", 10 );
    buff = mpf_get_str(NULL, &exp, 10, 0, foo);
    puts( buff );
    puts("\n");
    free(buff); 

    mpf_init_set_str( foo, "+123", 10 );
    buff = mpf_get_str(NULL, &exp, 10, 0, foo);
    puts( buff );
    puts("\n");
    free( buff );

} 
```

在第一个实例中，在 mpf_get_str 调用之后，buff 包含“123”。在第二个中，buff 包含“-123”。但在第三个中，buff 包含一个空字符串（“”）。

这是使用 GMP 4.2.4。也许我需要再次查看手册，但我认为前导“+”会像前导“-”一样容易处理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T08:18:11.080

[据我所知， GMP 手册](http://gmplib.org/#DOC)中的任何地方都没有提到您的问题。但是，您可以直接检查[mpf_set_str](http://www.google.com/codesearch/p?hl=en#1WHZ8OTMs38/gmp-4.2.1/mpf/set_str.c&q=mpf_set_str)的代码以查看它不处理“+”。

我不知道你在什么情况下需要这个，但如果你真的需要一个字符来表示正/负，你可以利用这些函数忽略前导空格的事实，从而使用`" 123"`.

# cuda - 使用 Nvidia 的 CUDA 的压缩库

> ID：456829
> 
> 赞同：54
> 
> 时间：2009-01-19T07:54:50.067
> 
> 标签：cuda, compression, gpgpu

有谁知道使用 NVIDIA 的[CUDA 库](http://www.nvidia.com/object/cuda_home.html)实现标准压缩方法（如 Zip、GZip、BZip2、LZMA...）的项目？

我想知道可以利用大量并行任务（如压缩）的算法在显卡上的运行速度是否不会比双核或四核 CPU 快得多。

您如何看待这种方法的利弊？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2011-04-22T16:46:23.143

我们已经完成了第一阶段的研究，以提高无损数据压缩算法的性能。选择 Bzip2 作为原型，我们的团队只优化了一项操作 - Burrows-Wheeler 转换，我们得到了一些结果：在良好的可压缩文件上速度提高了 2 到 4 倍。该代码在我们所有的测试中运行得更快。

我们将完成 bzip2，支持 deflate 和 LZMA 以完成一些现实生活中的任务，例如：HTTP 流量和备份压缩。

博客链接： [http ://www.wave-access.com/public_en/blog/2011/april/22/breakthrough-in-cuda-data-compression.aspx](http://www.wave-access.com/public_en/blog/2011/april/22/breakthrough-in-cuda-data-compression.aspx)

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-01-20T22:41:39.713

不知道有人这样做并将其公开。只是恕我直言，这听起来不太有希望。

正如 Martinus 所指出的，一些压缩算法是高度串行的。像 LZW 这样的块压缩算法可以通过独立编码每个块来并行化。压缩大型文件树可以在文件级别并行化。

但是，这些都不是真正的 SIMD 式并行（单指令多数据），而且它们不是大规模并行的。

GPU 基本上是矢量处理器，您可以在其中执行数百或数千条 ADD 指令，所有这些指令都在同步执行，并在很少有数据相关分支的情况下执行程序。

一般来说，压缩算法听起来更像是 SPMD（单程序多数据）或 MIMD（多指令多数据）编程模型，更适合多核 CPU。

视频压缩算法可以通过像 CUDA 这样的 GPGPU 处理来加速，只有在有大量像素块被并行进行余弦变换或卷积（用于运动检测）的情况下，IDCT 或卷积子程序可以表示为使用无分支代码。

GPU 还喜欢具有高数值强度（数学运算与内存访问的比率）的算法。具有低数值强度的算法（例如添加两个向量）可以大规模并行和 SIMD，但在 gpu 上的运行速度仍然比 cpu 慢，因为它们'被记忆束缚。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-19T08:04:27.987

通常压缩算法不能利用并行任务，使算法高度可并行化并不容易。在您的示例中，TAR 不是压缩算法，唯一可能高度并行化的算法是 BZIP，因为它是块压缩算法。每个块都可以单独压缩，但这需要大量的内存。LZMA 也不能并行工作，当您看到 7zip 使用多个线程时，这是因为 7zip 将数据流分成 2 个不同的流，每个流在单独的线程中用 LZMA 压缩，因此压缩算法本身不是并行的。这种拆分仅在数据允许时才有效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T08:32:02.330

加密算法在这方面已经相当成功，所以你可能想研究一下。这是一篇与 CUDA 和 AES 加密相关的论文：[http://www.manavski.com/downloads/PID505889.pdf](http://www.manavski.com/downloads/PID505889.pdf)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-23T11:39:41.673

我们正在尝试将 bzip2 移植到 CUDA。:) 到目前为止（并且只进行了粗略的测试），我们的 Burrows-Wheeler 变换比串行算法快 30%。[http://bzip2.github.com](http://bzip2.github.com)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-03-05T15:58:49.490

30% 很好，但对于像备份这样的应用程序来说，这远远不够。

我的经验是，在这种情况下，平均数据流使用 gzip 进行 1.2-1.7:1 压缩，最终限制为 30-60Mb/s 的输出速率（这是在广泛的现代（大约 2010-2012 年）媒体- 高端 CPU。

这里的限制通常是数据输入 CPU 本身的速度。

不幸的是，为了让 LTO5 磁带机满意，它需要大约 160Mb/s 的*原始*（不可压缩）数据速率。如果输入可压缩数据，它需要更快的数据速率。

LTO 压缩显然要快得多，但效率有些低（相当于 gzip -1 - 对于大多数用途来说已经足够了）。LTO4 及以上驱动器通常内置 AES-256 加密引擎，该引擎也可以保持这些速度。

这对我来说意味着我需要 400% 或更好的改进才能认为它值得。

类似的考虑也适用于 LAN。在 30Mb/s 时，压缩是 Gb 级网络的障碍，问题是在网络或压缩上花费更多... :)

# c# - 在 CLR 中，从远程文件夹运行 exe 时是否会创建 exe 的本地副本？

> ID：456837
> 
> 赞同：0
> 
> 时间：2009-01-19T08:00:29.167
> 
> 标签：c#, security

在 CLR 中，从远程文件夹运行 exe 时是否会创建 exe 的本地副本？

如果是，在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T02:42:05.563

CLR 在执行之前将远程代码复制到其下载缓存中。

要查看缓存的内容，请使用“GacUtil /ldl”

要刷新缓存，请使用“GacUtil /cdl”

GacUtil 页面有更多详细信息[http://msdn.microsoft.com/en-us/library/ex0ss12c(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ex0ss12c(VS.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T08:39:04.813

定义遥控器？

.net 的实现涉及从不安全的位置（例如网络文件夹等）运行代码。将代码推送到部分信任区域（这是浏览器中运行的任何 .net 代码或 clickonce 代码所在的位置）。

它不会创建 exe 的新副本，而是运行它，并且 CLR 将在 exe 加载时以部分信任的方式运行。

我们需要更多信息...

# .net - 您使用什么约定/习惯用法/模式使用新的 Fluent 接口配置 IOC 容器

> ID：456839
> 
> 赞同：6
> 
> 时间：2009-01-19T08:01:39.443
> 
> 标签：.net, inversion-of-control, structuremap, fluent-interface

我正在将大量代码移至 Castle Trunk，其中包括用于配置容器的新流利界面。由于该项目有一个无法维护的巨大 windsorConfig xml 文件，我想我会开始利用这个新功能。我知道其他容器（例如 StructureMap 2.0）也包含用于容器配置的流畅接口，所以这个问题不是基于 Windsor。

我的问题是，您使用新的流利样式接口进行容器配置时使用了哪些约定/习惯用法/模式？

我的第一个想法是在某处创建一个静态方法（例如 ContainerConfig.Config），它将应用程序使用的所有相关类型加载到容器中。我担心最终这个单一功能最终会像 xml 配置文件一样难以维护（减去尖括号税）。

我的第二个想法是将其分解，以便每个依赖程序集按照约定导出其默认配置。我可以看到这对于程序集内部使用的层次结构很有用。但是对于外部使用的类型，是否应该在内部定义配置？

我想得越多，我似乎提出的问题就越多。你对此有什么想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-22T16:40:22.703

深入了解 StructureMap 2.5。它提供了几个功能来显着减少引导 IOC 容器的工作。它提供了一种配置技术的约定（请参阅下面的博客条目）

请参阅 Jeremy Miller（StructureMap 的作者）最近发表的以下博客文章

[使用 StructureMap 创建您自己的自动注册约定](http://codebetter.com/blogs/jeremy.miller/archive/2009/01/20/create-your-own-auto-registration-convention-with-structuremap.aspx)

```
 // Example from the blog post above
        var container = new Container(registry =>
        {
            registry.Scan(x =>
            {
                x.TheCallingAssembly();
                x.With<DefaultConventionScanner>();
            });
        }); 
```

[StructureMap 2.5.2 发布](http://codebetter.com/blogs/jeremy.miller/archive/2009/01/11/structuremap-2-5-2-is-released.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T20:24:33.397

我有一个使用 Unity 的项目，我观看了有关 StructureMap 的视频，我从一开始就喜欢注册的想法。

所以我创建了以下界面：

```
/// <summary>
/// An interface which must be implemented to create a configurator class for the UnityContainer.
/// </summary>
public interface IUnityContainerConfigurator
{
    /// <summary>
    /// This method will be called to actually configure the container.
    /// </summary>
    /// <param name="destination">The container to configure.</param>
    void Configure(IUnityContainer destination);
} 
```

并让程序集提供默认的 Configurator 类。我们还使用静态类包装了 Unity IoC，以便我们可以调用`IoC.Resolve<T>`，我刚刚在该包装器中添加了以下函数：

```
 /// <summary>
    /// Configure the IoC
    /// </summary>
    public static class Configure
    {
        /// <summary>
        /// Configure the IoC using by calling the supplied configurator.
        /// </summary>
        /// <typeparam name="TConfigurator">The configurator to use</typeparam>
        public static void From<TConfigurator>() where TConfigurator : IUnityContainerConfigurator, new()
        {
            From(new TConfigurator());
        }
        /// <summary>
        /// Configure the IoC using by calling the supplied configurator.
        /// </summary>
        /// <param name="configurationInterface">The configurator instance to use</param>
        public static void From(IUnityContainerConfigurator configurationInterface)
        {
            configurationInterface.Configure(instance);
        }
        // other configuration.
    } 
```

因此，在程序或网站的初始化表单中，我只需调用：

```
IoC.Configure.From<BLL.DefaultMapping>(); 
```

在 BLL 中有这样一个类：

```
public class DefaultMapping:IUnityContainerConfigurator
{
    public void Configure(IUnityContainer destination)
    {
        destionation.RegisterType<IRepository, SQLRepository>();
        // and more..
    }
} 
```

唯一的缺点是你所有的层都耦合到所选的 IoC 容器。

**更新**：自从有了这个答案，我在我的博客上发布了一篇包含[Unity 包装器](http://landman-code.blogspot.com/2009/02/adding-structuremaps-registry.html)的文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T18:11:20.850

棘手的问题 [而且我不是 IoC 专家] 但请记住，任何“整体静态函数”都不应该*像*配置文件那样可怕。您可以为事物定义自己的约定，并尝试将事物抽象化。我使用 Ninject，但对于 Windsor，我想这将涉及使用诸如 Register 和 AllTypesOf 策略之类的东西来制作简短的小功能：

```
kernel.Register(AllTypesOf<ISomethingProvider>.
    FromAssembly(Assembly.Load("SomeAssembly"))); 
```

不知道内部层次结构导出自己的默认配置。这似乎有点可怕和倒置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T18:10:28.353

您可以尝试检查 Ninject 框架。非常简单、流畅的界面和闪电般的速度；) 没有 XML 配置，API 非常简单。强烈推荐

[忍者](http://www.ninject.org/)

# php - 使用PHP检测浏览器是否刷新

> ID：456841
> 
> 赞同：5
> 
> 时间：2009-01-19T08:02:41.750
> 
> 标签：php, refresh

我想检测是否使用 PHP 刷新了浏览器，如果刷新了浏览器，应该执行哪些特定的 PHP 代码。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-19T08:47:45.717

如果页面被刷新，那么您会期望两个请求彼此跟随，它们针对的是相同的 URL（路径、文件名、查询字符串）和相同的表单内容（如果有）（POST 数据）。这可能是相当多的数据，因此最好对其进行哈希处理。所以 ...

```
 <?php
session_start();

//The second parameter on print_r returns the result to a variable rather than displaying it
$RequestSignature = md5($_SERVER['REQUEST_URI'].$_SERVER['QUERY_STRING'].print_r($_POST, true));

if ($_SESSION['LastRequest'] == $RequestSignature)
{
  echo 'This is a refresh.';
}
else
{
  echo 'This is a new request.';
  $_SESSION['LastRequest'] = $RequestSignature;
} 
```

在 AJAX 情况下，您必须小心将此代码放入哪些文件，以免更新异步调用的脚本的 LastRequest 签名。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-05-25T16:29:33.810

当用户点击刷新按钮时，浏览器会包含一个额外的标题，该标题出现在 $_SERVER 数组中。

使用以下命令测试刷新按钮：

```
 $refreshButtonPressed = isset($_SERVER['HTTP_CACHE_CONTROL']) && 
                            $_SERVER['HTTP_CACHE_CONTROL'] === 'max-age=0'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T08:15:20.603

```
<?php

    session_start();
    if (!isset($_SESSION["visits"]))
        $_SESSION["visits"] = 0;
    $_SESSION["visits"] = $_SESSION["visits"] + 1;

    if ($_SESSION["visits"] > 1)
    {
        echo "You hit the refresh button!";
    }
    else
    {
        echo "This is my site";
    }

    // To clear out the visits session var:
    // unset($_SESSION["visits"]);

?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T08:08:26.497

如果您的意思是要区分用户第一次访问该页面的时间和他们重新加载该页面的时间，请检查引荐来源网址。在 php 中是：$_SERVER["HTTP_REFERER"]。查看它是否与您的脚本正在运行的页面相同。可能是客户端不提供此信息的情况，如果发生这种情况，您可以设置 cookie 或会话变量来跟踪最后请求的页面是什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-31T22:33:45.430

当用户点击浏览器刷新或返回按钮时，为了防止重复的表单处理，您需要使用页面实例 id 会话变量，以及包含该变量的隐藏表单输入。当两者不匹配时，则用户已刷新页面，您不应重新处理表单。有关详细信息，请参阅：

[https://www.spotlesswebdesign.com/blog.php?id=11](https://www.spotlesswebdesign.com/blog.php?id=11)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T15:31:26.133

如果有人刷新页面，将发送与前一个相同的请求。所以你应该检查当前请求是否与上一个请求相同。这可以按如下方式完成：

```
session_start();

$pageRefreshed = false;
if (isset($_SESSION['LAST_REQUEST']) && $_SERVER['REQUEST_URI'] === $_SESSION['LAST_REQUEST']['REQUEST_URI']) {
    if (isset($_SERVER['HTTP_REFERER'])) {
         // check if the last request’s referrer is the same as the current
         $pageRefreshed = $_SERVER['HTTP_REFERER'] === $_SESSION['LAST_REQUEST']['HTTP_REFERER'];
    } else {
         // check if the last request didn’t have a referrer either
         $pageRefreshed = $_SERVER['HTTP_REFERER'] === null;
    }
}

// set current request as "last request"

$_SERVER['LAST_REQUEST'] = array(
    'REQUEST_URI'  => $_SERVER['REQUEST_URI'],
    'HTTP_REFERER' => isset($_SERVER['HTTP_REFERER']) ? $_SERVER['HTTP_REFERER'] : null
); 
```

我没有测试过它，但它应该可以工作。

# html - 有什么方法可以将表格列宽与 HTML + CSS 同步？

> ID：456859
> 
> 赞同：46
> 
> 时间：2009-01-19T08:13:43.663
> 
> 标签：html, css

我有许多具有相同列的表，如果它们共享相同的列宽，它看起来会更好。这样的事情可能吗？将它们放在同一个表中，其中一些行之间没有边框，这不是一种选择。

**编辑：**是的，我知道我可以自己修复宽度，但我希望能够与浏览器的列宽算法相关联，但只是将两个或多个表绑定在一起以进行该布局。

我不认为这样的事情是可能的，但我想我会检查以防万一。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-19T21:48:02.397

如果您对浏览器提供的列宽不太挑剔，只要它们在不同的表格中相同，您可以[`table-layout`](http://www.w3.org/TR/CSS2/tables.html#propdef-table-layout)结合表格宽度使用 CSS 属性（所有主流浏览器都支持）：

```
table {
    table-layout: fixed;
    width: 100%;
} 
```

这会导致所有列（没有指定宽度）具有相同的宽度，而与表格内容无关。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-19T08:24:39.600

只有当您可以固定列宽时才有可能。如果你可以设置一个固定的宽度，那么像这样的一些 css 应该可以工作：

```
td {
    width: 25%;
} 
```

您可以像这样自定义每个列的宽度：

```
<table>
  <tr>
    <td class="col1">...</td>
    <td class="col2">...</td>
  </tr>
</table>
...
<table>
  <tr>
    <td class="col1">...</td>
    <td class="col2">...</td>
  </tr>
</table> 
```

然后像这样指定宽度：

```
.col1 {
   width: 25%;
}
.col2 {
   width: 75%;
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-19T19:10:45.567

这是我制作的一个小 JavaScript，用于调整单元格的大小以使它们在页面上的所有表格中的宽度相等。

```
function resizeTables()
{
    var tableArr = document.getElementsByTagName('table');
    var cellWidths = new Array();

    // get widest
    for(i = 0; i < tableArr.length; i++)
    {
        for(j = 0; j < tableArr[i].rows[0].cells.length; j++)
        {
           var cell = tableArr[i].rows[0].cells[j];

           if(!cellWidths[j] || cellWidths[j] < cell.clientWidth)
                cellWidths[j] = cell.clientWidth;
        }
    }

    // set all columns to the widest width found
    for(i = 0; i < tableArr.length; i++)
    {
        for(j = 0; j < tableArr[i].rows[0].cells.length; j++)
        {
            tableArr[i].rows[0].cells[j].style.width = cellWidths[j]+'px';
        }
    }
}

window.onload = resizeTables; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-19T08:39:23.720

要扩展 Ken 的答案，您还可以以像素为单位指定确切的宽度：

```
td { width: 250px } 
```

或 ems（字母 m 的宽度）：

```
td { width: 32em } 
```

或 ex 或 pt 或其他任何东西（嗯...实际上 %, pt, px, em, ex 可能是它）。如果你需要你的列是不同的宽度，那么简单的方法是给表格单元格类：

```
<table><tr>
    <td class="col1">...</td><td class="col2">...</td>...
</tr></table> 
```

并将列宽分配给类：

```
td.col1 { width: 48em }
td.col2 { width: 200px }
... 
```

将列宽分配给每个表中的第一行就足够了。 *[编辑：看起来我在写作的时候已经被人注意到了]*

你可能也会对 CSS 2 兄弟选择器发疯，然后写下类似的东西

```
tr > td:first-child { width:48em } /* first column */
tr > td:first-child + td { width: 200px } /* second column */
tr > td:first-child + td + td { width: 5% } /* third column  */
... 
```

但如果你有多个列，那可能会变得很难看。如果您使用某种模板系统或脚本来生成这些表格，我相信只需将 class="col#" 属性放在模板中的每个单元格上一次会更容易/更清晰。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-23T08:25:55.943

Luis Siquot 的答案是我使用的答案。但是，您应该使用 jquery width() 函数来规范浏览器之间的宽度，而不是使用 clientWidth，而不是计算填充。由于填充（如果在 TD 中使用填充），使用 clientWidth 会导致表格单元格在 ajaxpostbacks 上扩展。因此，使用 Luis Siquot 答案的正确代码将是替换

```
var cell = $(this)[0].rows[0].cells[j];
       if(!cellWidths[j] || cellWidths[j] < cell.clientWidth) cellWidths[j] = cell.clientWidth; 
```

和

```
var cell = $($(this)[0].rows[0].cells[j]);
            if (!cellWidths[j] || cellWidths[j] < cell.width()) cellWidths[j] = cell.width(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-19T19:41:45.553

我几乎感到震惊，没有人建议[列组](http://htmlhelp.com/reference/html40/tables/colgroup.html)！使用它，您可以为列指定特定的类、宽度和其他有用的属性。由于它是 HTML 4.01，因此所有支持 doctype 的浏览器都支持它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-08-03T06:47:09.007

最简单的方法是一种“肮脏”的方法，但效果最好。它完全符合要求：

只需将两张表合并为一张表即可。就我而言，两张桌子之间唯一的东西是`h3`

所以我的桌子

```
<table>
<tr></tr>
<table>

<h3>Title<h3>

<table>
<tr></tr>
<table> 
```

变成了这样：

```
<table>
<tr></tr>

<tr><td colspan="6">
<h3>Title<h3>
</td></tr>

<tr></tr>
<table> 
```

这样，您的表将“同步”它的大小。当然，这只有在两张表之间没有太多复杂的东西时才有效，但我猜在大多数情况下它不是。如果是，则首先不需要同步。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-09-09T18:55:27.933

每对表将其列的大小调整为与**Ole J. Helgesen**
类似的相同宽度，但使用 jquery 和一个参数来选择哪些表相等。 （我不能投票，但这本质上是你的解决方案）

 **```
<table data-ss="1" border="1">
  <tr><td>asdf<td>129292<td>text
</table>
<table data-ss="1" border=1>
  <tr><td>a<td>1<td>each column here has the same size than the table above
</table>
<table data-ss="2" border=1>
  <tr><td>asdf<td>129292<td>text
</table>
<table data-ss="2" border=1>
  <tr><td>each column here has the same size than the table above<td>a<td>1
</table> 
```

并使用这个脚本

```
$(function(){
  resizeTables('1');
  resizeTables('2');
});

//please set table html attribute `data-ss="something"` to properly call this js
// ss is short for SharedSize
function resizeTables(sharedSize){
  var tableArr = $('table[data-ss='+sharedSize+']');
  var cellWidths = new Array();
  $(tableArr).each(function() {
    for(j = 0; j < $(this)[0].rows[0].cells.length; j++){
       var cell = $(this)[0].rows[0].cells[j];
       if(!cellWidths[j] || cellWidths[j] < cell.clientWidth) cellWidths[j] = cell.clientWidth;
    }
  });
  $(tableArr).each(function() {
    for(j = 0; j < $(this)[0].rows[0].cells.length; j++){
        $(this)[0].rows[0].cells[j].style.width = cellWidths[j]+'px';
    }
  });
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-12T20:42:40.113

您可以通过组合表格来同步列宽（如@Stefanvds 建议的那样），但对每个表格使用`tbody`+ `th`：

```
table {
  border-collapse: collapse;
}

table thead,
table tbody {
  border-bottom: solid;
}

table tbody th {
  text-align: left;
}
```

```
<table>
  <thead>
    <tr> <th> ID <th> Measurement <th> Average <th> Maximum
  <tbody>
    <tr> <td> <th scope=rowgroup> Cats <td> <td>
    <tr> <td> 93 <th scope=row> Legs <td> 3.5 <td> 4
    <tr> <td> 10 <th scope=row> Tails <td> 1 <td> 1
  <tbody>
    <tr> <td> <th scope=rowgroup> English speakers <td> <td>
    <tr> <td> 32 <th scope=row> Legs <td> 2.67 <td> 4
    <tr> <td> 35 <th scope=row> Tails <td> 0.33 <td> 1
</table>
```

来源：[HTML 规范本身的示例](https://html.spec.whatwg.org/multipage/tables.html#the-th-element)

# java - 如何使用 Java-WS 缓存 WSDL

> ID：456865
> 
> 赞同：4
> 
> 时间：2009-01-19T08:19:09.923
> 
> 标签：java, netbeans, wsdl, java-ws

我创建了一个使用 java WS 与 SOAP 服务交互的应用程序。我使用内置的 netbeans 函数生成类并管理 WSDL。

每次我运行应用程序时，它都必须下载 WSDL 并再次解析它。WSDL 在每个版本中都被冻结，所以我认为这没有必要。我试图将它作为本地文件引用，但后来我的应用程序抱怨它安装在另一台机器上时找不到该文件。

有谁知道我如何阻止 Java WS 需要重新解析 WSDL，或者至少在本地缓存它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-21T11:35:23.990

我已经想通了...

这个页面有信息

[使用本地打包的 WSDL 开发客户端应用程序](https://javaee.github.io/metro/doc/user-guide/ch02.html#developing-client-application-with-locally-packaged-wsdl)

# python - AttributeError：“模块”对象没有属性“模型”

> ID：456867
> 
> 赞同：24
> 
> 时间：2009-01-19T08:19:25.447
> 
> 标签：python, django

谁能帮我解决这个问题..

```
from django.db import models

# Create your models here.
class Poll(models.model):
    question = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published')

class Choice(models.Model):
    poll = models.ForeignKey(Poll)
    choice = models.CharField(max_length=200)
    votes = models.IntegerField() 
```

跑步：

```
c:\projects\mysite>python manage.py sql polls
Traceback (most recent call last):
  File "manage.py", line 11, in <module>
    execute_manager(settings)
  File "C:\Python25\Lib\site-packages\django\core\management\__init__.py", line 340, in execute_manager
    utility.execute()
  File "C:\Python25\Lib\site-packages\django\core\management\__init__.py", line 295, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "C:\Python25\Lib\site-packages\django\core\management\base.py", line 195, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "C:\Python25\Lib\site-packages\django\core\management\base.py", line 221, in execute
    self.validate()
  File "C:\Python25\Lib\site-packages\django\core\management\base.py", line 249, in validate
    num_errors = get_validation_errors(s, app)
  File "C:\Python25\lib\site-packages\django\core\management\validation.py", line 28, in get_validation_errors
    for (app_name, error) in get_app_errors().items():
  File "C:\Python25\lib\site-packages\django\db\models\loading.py", line 128, in get_app_errors
    self._populate()
  File "C:\Python25\lib\site-packages\django\db\models\loading.py", line 57, in _populate
    self.load_app(app_name, True)
  File "C:\Python25\lib\site-packages\django\db\models\loading.py", line 72, in load_app
    mod = __import__(app_name, {}, {}, ['models'])
  File "c:\projects\mysite\..\mysite\polls\models.py", line 4, in <module>
    class Poll(models.model):
AttributeError: 'module' object has no attribute 'model' 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-01-19T08:32:41.753

它称为 models.Model 而不是 models.model（区分大小写）。像这样修复您的投票模型 -

```
class Poll(models.Model):
    question = models.CharField(max_length=200) 
    pub_date = models.DateTimeField('date published') 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-11-25T16:04:54.057

我也遇到了同样的错误，但我注意到我输入了 Foreign* *k* *ey 而不是 Foreign* *K* *ey,(capital K) 如果那里有新手，请检查拼写和大写。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-21T21:01:48.853

搜索

> AttributeError：“模块”对象没有属性“BinaryField”

把我降落在这里。

上面的答案没有解决问题，所以我发布了我的答案。

[`BinaryField`](https://docs.djangoproject.com/en/1.10/releases/1.6/#binaryfield-model-field)从 Django 1.6 开始添加。如果你有旧版本，它会给你上面的错误。

您可能需要首先检查属性的拼写，如上述答案中所建议的那样，然后检查以确保 Django 版本中的模块确实具有该属性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-19T08:29:13.570

正如错误消息在最后一行中所说：`models`文件中的模块`c:\projects\mysite..\mysite\polls\models.py`不包含 class `model`。这个错误发生在`Poll`类的定义中：

```
class Poll(models.model): 
```

该类`model`在类的定义中拼写`Poll`错误，或者在模块中拼写错误`models`。另一种可能性是模块中完全缺少它`models`。也许它在另一个模块中，或者它尚未在`models`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-02T15:04:32.883

我意识到通过查看堆栈跟踪它试图加载我自己的脚本来代替另一个以相同方式调用的模块，即我的脚本被称为 random.py 并且当我使用的模块试图导入“随机”时包，它正在加载我的脚本导致循环引用，所以我重命名它并删除了它从工作文件夹创建的 .pyc 文件，一切正常。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-02-25T16:20:52.457

在`class poll`中，您继承了您的类，`models.model`但模型中没有名为该名称的模块。

因为 Python 区分大小写，所以您需要使用大写字母`Model`而不是`model`.

```
class poll(models.Model):
... 
```

# c++ - C++：跨线程的错误处理问题

> ID：456873
> 
> 赞同：3
> 
> 时间：2009-01-19T08:23:43.020
> 
> 标签：c++, multithreading, exception, error-handling

一般来说，我使用异常来处理错误，但是我在这里遇到的问题是错误适用于与导致它的线程不同的线程。

基本上窗口有自己的线程，direct3d 设备必须由创建窗口的同一线程创建和重置。但是创建设备可能会失败，所以我需要在试图创建实例的线程中抛出异常，而不是窗口代码

回调函数：

```
void Callback(HWND hwnd, boost::function<void(HWND,LPARAM)> call, LPARAM lParam)
{
    //Make our stack allocated function object into a heap allocated one
    boost::function<void(HWND,LPARAM)> *callH = new boost::function<void(HWND,LPARAM)>(call);
    //send a message with a pointer to our function object in the WPARAM
    PostMessage(hwnd, WM_CALLBACK, (unsigned)callH, lParam);
}
LRESULT CALLBACK HookProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    //check for our custom message
    if(msg == WM_CALLBACK)
    {
        //retreive the function pointer from the WPARAM
        boost::function<void(HWND,LPARAM)> *callH = (boost::function<void(HWND,LPARAM)>*)wParam;
        //call it
        (*callH)(hwnd,lParam);
        //delete our heap allocated function object
        delete callH;
        return 0;
    }
    else
        //if there was nothing relevant to us, call the old message procedure
        return CallWindowProc(hooked[hwnd], hwnd, msg, wParam, lParam);
}
//std::map<HWND, WNDPROC> hooked; 
```

请求窗口线程创建设备的代码

```
Graphics::Graphics(IWindow *_window, Size2<unsigned> _size)
:lost(false), reset(false), refCnt(0), backCol(0xFF000000),
started(false), exited(false),
window(_window), size(_size)
{
    window->AddRef();
    HWND hwnd = *((HWND*)window->GetHandle());
    CallbackHook(hwnd);
    Callback(hwnd, boost::bind(&Graphics::create, this), 0);

    while(!started)Sleep(100);
}
void Graphics::create()
{
...code that may throw various exceptions
    started = true;
} 
```

所以基本上我需要 create() 方法抛出的异常被创建 Graphics 对象的异常处理程序捕获，这是另一个线程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T09:39:14.613

也许您可以使用[Boost.Exception](http://www.boost.org/doc/libs/1_37_0/libs/exception/doc/boost-exception.html)将调用包装在另一个函数中。

以下代码虽然不起作用，但您可能会明白。

```
class Context
{
public:
    Context(HWND hwnd, const boost::function<void(HWND,LPARAM)>& f, LPARAM lParam)
    {
        // TODO: reroute call through Wrapper function.
    }

    void wait()
    {
        mutex::scoped_lock l(m);
        while (!finished)
        {
            c.wait(l);
        }
        if (ex)
            rethrow_exception(ex);
    }

private:
    void Wrapper()
    {
        try
        {
            f(/*params*/);
        }
        catch (...)
        {
            ex = current_exception();
        }
        mutex::scoped_lock l(m);
        finished = true;
        c.notify_all();
    }

    boost::function<void(HWND,LPARAM)> f;
    exception_ptr ex;
    bool finished;
    mutex m;
    condition c;
};

void Callback(HWND hwnd, const boost::function<void(HWND,LPARAM)>& f, LPARAM lParam)
{
    Context ctx(hwnd, f, lParam);

    ctx.wait();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T09:33:47.603

我看到您`PostMessage`从那时`Callback`起使用循环和`Sleep`. 替换`PostMessage`为[`SendMessage`](http://msdn.microsoft.com/en-us/library/ms644950(VS.85).aspx)，它将等待消息处理完成。这样，处理器密集型循环就消失了。此外，您可以使用`SendMessage`调用的返回码（来自`WM_CALLBACK`arm 的`HookProc`）来传递错误信息。使用简单的数字代码（例如非零表示错误）或传递异常对象（在这种情况下，您必须从异常处理程序在堆上分配，您不能直接传递参数，因为它是堆栈分配的）。

最后，使用同步`SendMessage`而不是异步`PostMessage`意味着您不再需要从 构建中间`callH`函数对象`HookProc`，因为您可以传递堆栈分配的`call`参数。这导致更简单的代码。

例如：

```
void Callback(HWND hwnd, boost::function<void(HWND,LPARAM)> call, LPARAM lParam)
{
    //send a message with a pointer to our function object in the WPARAM
    if (SendMessage(hwnd, WM_CALLBACK, &call, lParam))
    {
        // error handling.
    }
}
LRESULT CALLBACK HookProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    //check for our custom message
    if(msg == WM_CALLBACK)
    {
        //retreive the function pointer from the WPARAM
        boost::function<void(HWND,LPARAM)> *callH = (boost::function<void(HWND,LPARAM)>*)wParam;
        //call it, catching exceptions in the process.
        try 
        {
            (*callH)(hwnd,lParam);
            return 0;
        } 
        catch (...) 
        {
            return 1;
        }
    }
    else
        //if there was nothing relevant to us, call the old message procedure
        return CallWindowProc(hooked[hwnd], hwnd, msg, wParam, lParam);
}
//std::map<HWND, WNDPROC> hooked; 
```

和：

```
Graphics::Graphics(IWindow *_window, Size2<unsigned> _size)
:lost(false), reset(false), refCnt(0), backCol(0xFF000000),
started(false), exited(false),
window(_window), size(_size)
{
    window->AddRef();
    HWND hwnd = *((HWND*)window->GetHandle());
    CallbackHook(hwnd);
    Callback(hwnd, boost::bind(&Graphics::create, this), 0);

    // No need to wait, as SendMessage is synchronous.
}
void Graphics::create()
{
...code that may throw various exceptions
    started = true;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T09:14:23.197

一个简单的解决方案是在抛出异常的线程中捕获异常（或在调用函数之前检查参数以确定是否会抛出异常），然后通过静态变量将异常传递给主线程所在的主线程可以扔。

我会在*WaitForSingleObject*之后添加一个检查，以发现是否有异常正在等待抛出，以防万一 - 抛出它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-14T07:50:00.623

请参阅[http://www.boost.org/doc/libs/release/libs/exception/doc/tutorial_exception_ptr.html](http://www.boost.org/doc/libs/release/libs/exception/doc/tutorial_exception_ptr.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T09:09:49.307

嗯，答案是你不能。一个可行的替代方案是只做不会失败的必要工作，比如在回调函数中从参数中提取值，然后在主线程中调用 create() 函数。

此外，您不应该忙于等待创建、使用信号量或互斥和事件等。

```
Graphics::Graphics(IWindow *_window, Size2<unsigned> _size)
:lost(false), reset(false), refCnt(0), backCol(0xFF000000),
started(false), exited(false),
window(_window), size(_size)
{
    window->AddRef();
    HWND hwnd = *((HWND*)window->GetHandle());
    semaphore = CreateSemaphore(NULL, 0, 1, NULL);
    if (semaphore == NULL) throw whatever;
    CallbackHook(hwnd);
    Callback(hwnd, boost::bind(&Graphics::create, this), 0);

    WaitForSingleObject(semaphore);
    create();

    CloseHandle(semaphore); /* you won't need it */
}
void Graphics::create()
{
...code that may throw various exceptions
}
void Graphics::create_callback()
{
    ReleaseSemaphore(semaphore, 1, NULL);
} 
```

# delphi - Delphi 文件夹扫描器 - Unicode 文件夹名称

> ID：456874
> 
> 赞同：1
> 
> 时间：2009-01-19T08:24:26.433
> 
> 标签：delphi, unicode, recursion

哟。

我需要扫描一个目录及其子文件夹，我使用了 FindFirst 和 FindNext 程序，但是 TSearchRec 的 Name 属性是一个字符串，因此 unicode 文件夹名称（希伯来语、阿拉伯语等）是 '?????' 在名称属性中。

我尝试使用带有 WideFindFirst、WideFindNext 和 TSearchRecW 的 TntComponent。但我还是得到了？？？？？？用于文件夹名称。

```
 Flname:=WideExtractFileName(FileSpec);
 validres := WideFindFirst(FileSpec+'\*', faDirectory, SearchRec);
 AssignFile(LogFile, ResultFilePath);

 while validres=0 do begin
   if (SearchRec.Attr and faDirectory>0) and (SearchRec.Name[1]<>'.') then begin
     {invalid entry Findnext returns}
     Append(LogFile);
     WriteLn(LogFile, FileSpec+'\'+LowerCase(SearchRec.Name));
     CloseFile(LogFile);
     DirScan(FileSpec+'\'+SearchRec.Name, ResultFilePath)
   end;
   validres:=WideFindNext(SearchRec);
 end;
 WideFindClose(SearchRec); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T10:05:03.097

Delphi 通过使用 WideString 在编译器中支持 unicode。

但是你会面临以下问题：

*   Delphi < 2009 在其 VCL 中不支持 unicode。
*   许多 API 映射是在 API 的 ANSI（例如 OpenFileA）变体上完成的。
*   delphi 编译器会大量地将 WideStrings 转换为字符串，因此对它们要非常明确。

如果您使用原始的 unicode windows api，它将起作用。

所以 FindFirst 使用了 delphi 映射到 FindFirstFileA 变体的 api [FindFirstFile](http://msdn.microsoft.com/en-us/library/aa364418(VS.85).aspx)，你需要直接调用 FindFirstW。

因此，您将有 2 个选择。

1.  升级到 Delphi 2009 并为您完成大量 unicode 映射
    *   编写自己的 unicode 映射函数

对于文本文件的编写，您可以使用 Primoz Gabrijelcic（又名 gabr）的[GpTextFile](http://gp.17slon.com/gp/gptextfile.htm)或[GpTextSteam](http://gp.17slon.com/gp/gptextstream.htm)，它们支持 unicode。

她是使用 unicode 文件名打开文件的示例：

```
function OpenLongFileName(const ALongFileName: WideString; SharingMode: DWORD): THandle;  overload;
begin
  if CompareMem(@(WideCharToString(PWideChar(ALongFileName))[1]), @('\\'[1]), 2) then
    { Allready an UNC path }
    Result := CreateFileW(PWideChar(ALongFileName), GENERIC_READ, SharingMode, nil, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0)
  else
    Result := CreateFileW(PWideChar('\\?\' + ALongFileName), GENERIC_READ, SharingMode, nil, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, 0);
end;

function CreateLongFileName(const ALongFileName: WideString; SharingMode: DWORD): THandle; overload;
begin
  if CompareMem(@(WideCharToString(PWideChar(ALongFileName))[1]), @('\\'[1]), 2) then
    { Allready an UNC path }
    Result := CreateFileW(PWideChar(ALongFileName), GENERIC_WRITE, SharingMode, nil, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, 0)
  else
    Result := CreateFileW(PWideChar('\\?\' + ALongFileName), GENERIC_WRITE, SharingMode, nil, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, 0);
end; 
```

I've used these functions because the ANSI api's have a path limit of 254 chars, the unicode have a limit of 2^16 chars if I'm not mistaken.

After you've got the handle to the file you can just call the regular ReadFile delphi api mapping, to read data from your file.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T08:59:48.327

2009 年之前的 Delphi 版本对 unicode 的支持非常有限。所以如果你真的想要 unicode，那么我强烈建议你升级到 2009。在 2009 中，默认字符串是 unicode。

你说你仍然有宽版本的垃圾字符。您是否尝试过使用调试器检查这些值？2009 年之前的 delphi 的 vcl 不能显示 unicode 字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T09:40:45.080

一些更新.. 如果我在 SearchRec.Name 上使用 UTF8Encode，我会得到 unicode 字符串！下一个问题是我使用的 TFileStream。我找不到它的 WideString 版本（用于文件名）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T09:58:51.080

您可以使用 CreateFileW 打开文件并获取句柄，然后使用 THandleStream 而不是 TFileStream 来读取文件。

Tnt Unicode（现在是 TMS Unicode）有一个 TTntFileStream 可以打开基于宽字符串的文件。正如 Gamecat 所说，如果你想做 unicode，你真的应该升级到 Delphi 2009。（一般来说很棒的版本）

# validation - 企业库验证块 - 应该将验证放在类还是接口上？

> ID：456877
> 
> 赞同：1
> 
> 时间：2009-01-19T08:26:18.600
> 
> 标签：validation, class, interface, enterprise-library

我不确定放置验证（使用企业库验证块）的最佳位置在哪里？它应该在类上还是在界面上？

可能影响它的事情

*   从接口继承的类中不会更改验证规则。
*   从类继承的类中不会更改验证规则。
*   在大多数情况下，类会发生继承——我怀疑一些边缘情况会从接口继承（但我会尽量避免它）。
*   接口主要用于 DI，这将通过 Unity 块完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T20:22:30.743

您尝试将验证块与 DI 一起使用的方式，如果您在接口级别设置属性，我认为这不是问题。另外，我认为它不应该在继承链中产生问题。但是，我大多看到这个块在类级别使用，目的是保持接口不过度指定事物。IMO 我不认为这样做有很大的威胁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-09T19:18:30.860

这里要非常小心，你的测试太简单了。

对于 SelfValidation 验证器或类验证器，这不会像您期望的那样工作，仅适用于您那里的简单属性验证器。

此外，如果您在 ASP.NET 页面中使用 PropertyProxyValidator，我也不相信它会起作用，因为它只看起来是一个字段验证器，而不是继承/实现的验证器......

是的，如果你问我，VAB 上有大洞。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T05:54:18.687

为了完整起见，我决定编写一个小测试以确保它能够按预期工作并且确实如此，我只是将其发布在这里以防其他人将来需要它。

```
using System;
using Microsoft.Practices.EnterpriseLibrary.Validation;
using Microsoft.Practices.EnterpriseLibrary.Validation.Validators;

namespace ConsoleApplication1
{
    class Program
    {
    static void Main(string[] args)
    {
        ISpike spike = new Spike();
        spike.Name = "A really long name that will fail.";
        ValidationResults r = Validation.Validate<ISpike>(spike);
        if (!r.IsValid)
        {
            throw new InvalidOperationException("Validation error found.");
        }

    }
}

public class Spike : ConsoleApplication1.ISpike
{
    public string Name { get; set; }
}

interface ISpike
{
    [StringLengthValidator(2, 5)]
    string Name { get; set; }
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:49:59.907

您的代码示例使用什么版本的企业库？我使用 Enterprise Library 5.0 进行了尝试，但没有成功。

我将其追踪到 EL5.0 源代码中的以下代码部分：

```
[namespace Microsoft.Practices.EnterpriseLibrary.Validation]
[public static class Validation]

public static ValidationResults Validate<T>(T target, ValidationSpecificationSource source)
{
    Type targetType = target != null ? target.GetType() : typeof(T);
    Validator validator = ValidationFactory.CreateValidator(targetType, source);
    return validator.Validate(target);
} 
```

如果定义了目标对象，则 target.GetType() 将返回最具体的类定义，而不是接口定义。

我的解决方法是更换您的线路：

```
ValidationResults r = Validation.Validate<ISpike>(spike); 
```

和：

```
ValidationResults r ValidationFactory.CreateValidator<ISpike>().Validate(spike); 
```

这让它为我工作。

# python - 扩展 python - swig，而不是 swig 或 Cython

> ID：456884
> 
> 赞同：70
> 
> 时间：2009-01-19T08:32:06.433
> 
> 标签：python, c++, c, swig, cython

我在我的 python 代码中发现了瓶颈，玩弄了 Psycho 等。然后决定编写 ac/c++ 扩展来提高性能。

在 swig 的帮助下，您几乎不需要关心争论等。一切正常。

现在我的问题是：swig 创建了一个相当大的 py 文件，它在调用实际的 .pyd 或 .so 代码之前会执行大量“检查”和“PySwigObject”。

如果你手写这个文件或者让 swig 来做，你们中的任何人是否有任何经验是否可以获得更多的性能。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-01-19T09:00:41.417

如果您不打算使用 swig 为其他语言生成绑定，则应该考虑使用 Boost.Python。

如果你有很多函数和类要绑定，[Py++](http://sourceforge.net/projects/pygccxml/)是一个很棒的工具，它可以自动生成所需的代码来进行绑定。

[Pybindgen](http://code.google.com/p/pybindgen/) 也可能是一种选择，但它是一个新项目，不如 Boost.Python 完整。

* * *

编辑：

也许我需要更明确地说明利弊。

*   痛饮：

    pro：您可以为许多脚本语言生成绑定。

    缺点：我不喜欢解析器的工作方式。我不知道是否取得了一些进展，但两年前 C++ 解析器非常有限。大多数时候，我不得不复制/过去我的 .h 标头添加一些`%`字符并向 swig 解析器提供额外的提示。

    我还需要不时处理 Python C-API 以进行（不是那么）复杂的类型转换。

    我不再使用它了。

*   Boost.Python：

    pro：这是一个非常完整的库。它允许您使用 C-API 做几乎所有可能的事情，但在 C++ 中。我从来不需要用这个库编写 C-API 代码。由于图书馆，我也从未遇到过错误。绑定代码要么像魅力一样工作，要么拒绝编译。

    如果您已经有一些 C++ 库要绑定，它可能是当前可用的最佳解决方案之一。但是如果你只有一个小的 C 函数要重写，我可能会尝试使用 Cython。

    缺点：如果您没有预编译的 Boost.Python 库，您将使用 Bjam（类似于 make 替换）。我真的很讨厌 Bjam 和它的语法。

    使用 BP 创建的 Python 库往往会变得臃肿。编译它们也需要**很多**时间。

*   Py++（已停产）：让 Boost.Python 变得简单。Py++ 使用 C++ 解析器来读取您的代码，然后自动生成 Boost.Python 代码。您还得到了作者的大力支持（不，不是我 ;-)）。

    缺点：只有 Boost.Python 本身的问题。更新：截至 2014 年，该项目现在看起来已停产。

*   比宾根：

    它生成处理 C-API 的代码。您可以在 Python 文件中描述函数和类，或者让 Pybindgen 读取您的标头并自动生成绑定（为此它使用 pygccxml，一个由 Py++ 的作者编写的 Python 库）。

    缺点：这是一个年轻的项目，团队比 Boost.Python 小。仍然有一些限制：您不能对 C++ 类使用多重继承，回调（不是自动的，可以编写自定义回调处理代码）。Python 异常到 C 的翻译。

    绝对值得一看。

*   一个新的：在 2009/01/20，Py++ 的作者宣布了一个用于将 C/C++ 代码与 python 接口的[新包](http://mail.python.org/pipermail/cplusplus-sig/2009-January/014198.html)。它基于 ctypes。我还没有尝试过，但我会的！注意：这个项目看起来像 Py++ 一样中断。

*   [CFFI](http://cffi.readthedocs.org/)：直到最近我才知道这个的存在，所以现在我不能发表我的意见。看起来您可以在 Python 字符串中定义 C 函数并直接从同一个 Python 模块中调用它们。

*   [Cython](http://cython.org/)：这是我目前在我的项目中使用的方法。基本上你在特殊的 .pyx 文件中编写代码。这些文件被编译（翻译）成 C 代码，而 C 代码又被编译成 CPython 模块。Cython 代码可能看起来像常规 Python（实际上纯 Python 是有效的 .pyx Cython 文件），但您还可以提供更多信息，例如变量类型。这种可选类型允许 Cython 生成更快的 C 代码。Cython 文件中的代码既可以调用纯 Python 函数，也可以调用 C 和 C++ 函数（以及 C++ 方法）。

    我花了一些时间在 Cython 中思考，在同一代码中调用 C 和 C++ 函数，混合 Python 和 C 变量等等。但它是一种非常强大的语言，拥有一个活跃的（2014 年）和友好的社区。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2011-07-05T09:47:58.603

SWIG 2.0.4 引入了一个新的 -builtin 选项，可提高性能。我使用一个对 C++ 扩展进行大量快速调用的示例程序进行了一些基准测试。我使用 boost.python、PyBindGen、SIP 和 SWIG 构建了扩展，带有和不带有 -builtin 选项。以下是结果（平均 100 次运行）：

```
SWIG with -builtin     2.67s
SIP                    2.70s
PyBindGen              2.74s
boost.python           3.07s
SWIG without -builtin  4.65s 
```

SWIG 曾经是最慢的。使用新的 -builtin 选项，SWIG 似乎是最快的。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-01-19T09:20:19.583

当然，手动执行此操作总会获得性能提升，但与执行此操作所需的努力相比，增益将非常小。我没有任何图可以给你，但我不推荐这个，因为你需要手动维护界面，如果你的模块很大，这不是一个选项！

您选择使用脚本语言是正确的，因为您想要快速开发。这样你就避免了早期优化综合症，现在你想优化瓶颈部分，太棒了！但是如果你手动做 C/python 接口，你肯定会陷入早期优化综合症。

如果你想要一些接口代码更少的东西，你可以考虑从你的 C 代码创建一个 dll，然后直接从 python 中使用该库和[cstruct](http://python.net/crew/theller/ctypes/)。

如果您只想在程序中使用 python 代码，也可以考虑[Cython 。](http://www.cython.org/)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-01-19T10:05:52.923

使用[Cython](http://cython.org/)非常好。您可以使用类似 Python 的语法编写 C 扩展并让它生成 C 代码。包括样板。由于您已经在 python 中编写了代码，因此您只需对瓶颈代码进行一些更改，即可从中生成 C 代码。

例子。`hello.pyx`：

```
cdef int hello(int a, int b):
    return a + b 
```

这会生成**601 行**样板代码：

```
/* Generated by Cython 0.10.3 on Mon Jan 19 08:24:44 2009 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#include "structmember.h"
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#if PY_VERSION_HEX < 0x02040000
  #define METH_COEXIST 0
#endif
#if PY_VERSION_HEX < 0x02050000
  typedef int Py_ssize_t;
  #define PY_SSIZE_T_MAX INT_MAX
  #define PY_SSIZE_T_MIN INT_MIN
  #define PyInt_FromSsize_t(z) PyInt_FromLong(z)
  #define PyInt_AsSsize_t(o)   PyInt_AsLong(o)
  #define PyNumber_Index(o)    PyNumber_Int(o)
  #define PyIndex_Check(o)     PyNumber_Check(o)
#endif
#if PY_VERSION_HEX < 0x02060000
  #define Py_REFCNT(ob) (((PyObject*)(ob))->ob_refcnt)
  #define Py_TYPE(ob)   (((PyObject*)(ob))->ob_type)
  #define Py_SIZE(ob)   (((PyVarObject*)(ob))->ob_size)
  #define PyVarObject_HEAD_INIT(type, size) \
          PyObject_HEAD_INIT(type) size,
  #define PyType_Modified(t)

  typedef struct {
       void *buf;
       PyObject *obj;
       Py_ssize_t len;
       Py_ssize_t itemsize;
       int readonly;
       int ndim;
       char *format;
       Py_ssize_t *shape;
       Py_ssize_t *strides;
       Py_ssize_t *suboffsets;
       void *internal;
  } Py_buffer;

  #define PyBUF_SIMPLE 0
  #define PyBUF_WRITABLE 0x0001
  #define PyBUF_LOCK 0x0002
  #define PyBUF_FORMAT 0x0004
  #define PyBUF_ND 0x0008
  #define PyBUF_STRIDES (0x0010 | PyBUF_ND)
  #define PyBUF_C_CONTIGUOUS (0x0020 | PyBUF_STRIDES)
  #define PyBUF_F_CONTIGUOUS (0x0040 | PyBUF_STRIDES)
  #define PyBUF_ANY_CONTIGUOUS (0x0080 | PyBUF_STRIDES)
  #define PyBUF_INDIRECT (0x0100 | PyBUF_STRIDES)

#endif
#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
#endif
#if PY_MAJOR_VERSION >= 3
  #define Py_TPFLAGS_CHECKTYPES 0
  #define Py_TPFLAGS_HAVE_INDEX 0
#endif
#if (PY_VERSION_HEX < 0x02060000) || (PY_MAJOR_VERSION >= 3)
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyString_Type                PyBytes_Type
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_Divide(x,y)
  #define PyBytes_Type                 PyString_Type
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyMethod_New(func, self, klass) PyInstanceMethod_New(func)
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
#else
  #define _USE_MATH_DEFINES
#endif
#ifdef __cplusplus
#define __PYX_EXTERN_C extern "C"
#else
#define __PYX_EXTERN_C extern
#endif
#include <math.h>
#define __PYX_HAVE_API__helloworld

#ifdef __GNUC__
#define INLINE __inline__
#elif _WIN32
#define INLINE __inline
#else
#define INLINE 
#endif

typedef struct 
    {PyObject **p; char *s; long n; 
     char is_unicode; char intern; char is_identifier;} 
     __Pyx_StringTabEntry; /*proto*/

static int __pyx_skip_dispatch = 0;

/* Type Conversion Predeclarations */

#if PY_MAJOR_VERSION < 3
#define __Pyx_PyBytes_FromString PyString_FromString
#define __Pyx_PyBytes_AsString   PyString_AsString
#else
#define __Pyx_PyBytes_FromString PyBytes_FromString
#define __Pyx_PyBytes_AsString   PyBytes_AsString
#endif

#define __Pyx_PyBool_FromLong(b) ((b) ? (Py_INCREF(Py_True), Py_True) : (Py_INCREF(Py_False), Py_False))
static INLINE int __Pyx_PyObject_IsTrue(PyObject* x);
static INLINE PY_LONG_LONG __pyx_PyInt_AsLongLong(PyObject* x);
static INLINE unsigned PY_LONG_LONG __pyx_PyInt_AsUnsignedLongLong(PyObject* x);
static INLINE Py_ssize_t __pyx_PyIndex_AsSsize_t(PyObject* b);

#define __pyx_PyInt_AsLong(x) (PyInt_CheckExact(x) ? PyInt_AS_LONG(x) : PyInt_AsLong(x))
#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))

static INLINE unsigned char __pyx_PyInt_unsigned_char(PyObject* x);
static INLINE unsigned short __pyx_PyInt_unsigned_short(PyObject* x);
static INLINE char __pyx_PyInt_char(PyObject* x);
static INLINE short __pyx_PyInt_short(PyObject* x);
static INLINE int __pyx_PyInt_int(PyObject* x);
static INLINE long __pyx_PyInt_long(PyObject* x);
static INLINE signed char __pyx_PyInt_signed_char(PyObject* x);
static INLINE signed short __pyx_PyInt_signed_short(PyObject* x);
static INLINE signed int __pyx_PyInt_signed_int(PyObject* x);
static INLINE signed long __pyx_PyInt_signed_long(PyObject* x);
static INLINE long double __pyx_PyInt_long_double(PyObject* x);
#ifdef __GNUC__
/* Test for GCC > 2.95 */
#if __GNUC__ > 2 ||               (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)) 
#define likely(x)   __builtin_expect(!!(x), 1)
#define unlikely(x) __builtin_expect(!!(x), 0)
#else /* __GNUC__ > 2 ... */
#define likely(x)   (x)
#define unlikely(x) (x)
#endif /* __GNUC__ > 2 ... */
#else /* __GNUC__ */
#define likely(x)   (x)
#define unlikely(x) (x)
#endif /* __GNUC__ */

static PyObject *__pyx_m;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;
static const char **__pyx_f;

static void __Pyx_AddTraceback(const char *funcname); /*proto*/

/* Type declarations */
/* Module declarations from helloworld */

static int __pyx_f_10helloworld_hello(int, int); /*proto*/

/* Implementation of helloworld */

/* "/home/nosklo/devel/ctest/hello.pyx":1
 * cdef int hello(int a, int b):             # <<<<<<<<<<<<<<
 *     return a + b
 * 
 */

static  int __pyx_f_10helloworld_hello(int __pyx_v_a, int __pyx_v_b) {
  int __pyx_r;

  /* "/home/nosklo/devel/ctest/hello.pyx":2
 * cdef int hello(int a, int b):
 *     return a + b             # <<<<<<<<<<<<<<
 * 
 */
  __pyx_r = (__pyx_v_a + __pyx_v_b);
  goto __pyx_L0;

  __pyx_r = 0;
  __pyx_L0:;
  return __pyx_r;
}

static struct PyMethodDef __pyx_methods[] = {
  {0, 0, 0, 0}
};

static void __pyx_init_filenames(void); /*proto*/

#if PY_MAJOR_VERSION >= 3
static struct PyModuleDef __pyx_moduledef = {
    PyModuleDef_HEAD_INIT,
    "helloworld",
    0, /* m_doc */
    -1, /* m_size */
    __pyx_methods /* m_methods */,
    NULL, /* m_reload */
    NULL, /* m_traverse */
    NULL, /* m_clear */
    NULL /* m_free */
};
#endif
static int __Pyx_InitCachedBuiltins(void) {
  return 0;
  return -1;
}

static int __Pyx_InitGlobals(void) {
  return 0;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC inithelloworld(void); /*proto*/
PyMODINIT_FUNC inithelloworld(void)
#else
PyMODINIT_FUNC PyInit_helloworld(void); /*proto*/
PyMODINIT_FUNC PyInit_helloworld(void)
#endif
{
  __pyx_empty_tuple = PyTuple_New(0); 
  if (unlikely(!__pyx_empty_tuple))
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; 
       __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  /*--- Library function declarations ---*/
  __pyx_init_filenames();
  /*--- Initialize various global constants etc. ---*/
  if (unlikely(__Pyx_InitGlobals() < 0)) 
     {__pyx_filename = __pyx_f[0]; 
      __pyx_lineno = 1; 
      __pyx_clineno = __LINE__; 
      goto __pyx_L1_error;}
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4("helloworld", __pyx_methods, 0, 0, PYTHON_API_VERSION);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (!__pyx_m) 
     {__pyx_filename = __pyx_f[0]; 
      __pyx_lineno = 1; __pyx_clineno = __LINE__; 
      goto __pyx_L1_error;};
  #if PY_MAJOR_VERSION < 3
  Py_INCREF(__pyx_m);
  #endif
  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME);
  if (!__pyx_b) 
     {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; 
      __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) 
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; 
       __pyx_clineno = __LINE__; goto __pyx_L1_error;};
  /*--- Builtin init code ---*/
  if (unlikely(__Pyx_InitCachedBuiltins() < 0)) 
      {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; 
       __pyx_clineno = __LINE__; goto __pyx_L1_error;}
  __pyx_skip_dispatch = 0;
  /*--- Global init code ---*/
  /*--- Function export code ---*/
  /*--- Type init code ---*/
  /*--- Type import code ---*/
  /*--- Function import code ---*/
  /*--- Execution code ---*/

  /* "/home/nosklo/devel/ctest/hello.pyx":1
 * cdef int hello(int a, int b):             # <<<<<<<<<<<<<<
 *     return a + b
 * 
 */
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
  __pyx_L1_error:;
  __Pyx_AddTraceback("helloworld");
  #if PY_MAJOR_VERSION >= 3
  return NULL;
  #endif
}

static const char *__pyx_filenames[] = {
  "hello.pyx",
};

/* Runtime support code */

static void __pyx_init_filenames(void) {
  __pyx_f = __pyx_filenames;
}

#include "compile.h"
#include "frameobject.h"
#include "traceback.h"

static void __Pyx_AddTraceback(const char *funcname) {
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    PyObject *py_globals = 0;
    PyObject *empty_string = 0;
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;

    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(__pyx_filename);
    #else
    py_srcfile = PyUnicode_FromString(__pyx_filename);
    #endif
    if (!py_srcfile) goto bad;
    if (__pyx_clineno) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, 
             __pyx_cfilenm, __pyx_clineno);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, 
             __pyx_cfilenm, __pyx_clineno);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_globals = PyModule_GetDict(__pyx_m);
    if (!py_globals) goto bad;
    #if PY_MAJOR_VERSION < 3
    empty_string = PyString_FromStringAndSize("", 0);
    #else
    empty_string = PyBytes_FromStringAndSize("", 0);
    #endif
    if (!empty_string) goto bad;
    py_code = PyCode_New(
        0,            /*int argcount,*/
        #if PY_MAJOR_VERSION >= 3
        0,            /*int kwonlyargcount,*/
        #endif
        0,            /*int nlocals,*/
        0,            /*int stacksize,*/
        0,            /*int flags,*/
        empty_string, /*PyObject *code,*/
        __pyx_empty_tuple,  /*PyObject *consts,*/
        __pyx_empty_tuple,  /*PyObject *names,*/
        __pyx_empty_tuple,  /*PyObject *varnames,*/
        __pyx_empty_tuple,  /*PyObject *freevars,*/
        __pyx_empty_tuple,  /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        __pyx_lineno,   /*int firstlineno,*/
        empty_string  /*PyObject *lnotab*/
    );
    if (!py_code) goto bad;
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        py_globals,          /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = __pyx_lineno;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    Py_XDECREF(empty_string);
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

/* Type Conversion Functions */

static INLINE Py_ssize_t __pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject* x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}

static INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   if (x == Py_True) return 1;
   else if (x == Py_False) return 0;
   else return PyObject_IsTrue(x);
}

static INLINE PY_LONG_LONG __pyx_PyInt_AsLongLong(PyObject* x) {
    if (PyInt_CheckExact(x)) {
        return PyInt_AS_LONG(x);
    }
    else if (PyLong_CheckExact(x)) {
        return PyLong_AsLongLong(x);
    }
    else {
        PY_LONG_LONG val;
        PyObject* tmp = PyNumber_Int(x); if (!tmp) return (PY_LONG_LONG)-1;
        val = __pyx_PyInt_AsLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE unsigned PY_LONG_LONG __pyx_PyInt_AsUnsignedLongLong(PyObject* x) {
    if (PyInt_CheckExact(x)) {
        long val = PyInt_AS_LONG(x);
        if (unlikely(val < 0)) {
            PyErr_SetString(PyExc_TypeError, "Negative assignment to unsigned type.");
            return (unsigned PY_LONG_LONG)-1;
        }
        return val;
    }
    else if (PyLong_CheckExact(x)) {
        return PyLong_AsUnsignedLongLong(x);
    }
    else {
        PY_LONG_LONG val;
        PyObject* tmp = PyNumber_Int(x); if (!tmp) return (PY_LONG_LONG)-1;
        val = __pyx_PyInt_AsUnsignedLongLong(tmp);
        Py_DECREF(tmp);
        return val;
    }
}

static INLINE unsigned char __pyx_PyInt_unsigned_char(PyObject* x) {
    if (sizeof(unsigned char) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        unsigned char val = (unsigned char)long_val;
        if (unlikely((val != long_val)  || (long_val < 0))) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to unsigned char");
            return (unsigned char)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE unsigned short __pyx_PyInt_unsigned_short(PyObject* x) {
    if (sizeof(unsigned short) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        unsigned short val = (unsigned short)long_val;
        if (unlikely((val != long_val)  || (long_val < 0))) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to unsigned short");
            return (unsigned short)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE char __pyx_PyInt_char(PyObject* x) {
    if (sizeof(char) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        char val = (char)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to char");
            return (char)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE short __pyx_PyInt_short(PyObject* x) {
    if (sizeof(short) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        short val = (short)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to short");
            return (short)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE int __pyx_PyInt_int(PyObject* x) {
    if (sizeof(int) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        int val = (int)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to int");
            return (int)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE long __pyx_PyInt_long(PyObject* x) {
    if (sizeof(long) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        long val = (long)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to long");
            return (long)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed char __pyx_PyInt_signed_char(PyObject* x) {
    if (sizeof(signed char) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed char val = (signed char)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed char");
            return (signed char)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed short __pyx_PyInt_signed_short(PyObject* x) {
    if (sizeof(signed short) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed short val = (signed short)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed short");
            return (signed short)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed int __pyx_PyInt_signed_int(PyObject* x) {
    if (sizeof(signed int) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed int val = (signed int)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed int");
            return (signed int)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE signed long __pyx_PyInt_signed_long(PyObject* x) {
    if (sizeof(signed long) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        signed long val = (signed long)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to signed long");
            return (signed long)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
}

static INLINE long double __pyx_PyInt_long_double(PyObject* x) {
    if (sizeof(long double) < sizeof(long)) {
        long long_val = __pyx_PyInt_AsLong(x);
        long double val = (long double)long_val;
        if (unlikely((val != long_val) )) {
            PyErr_SetString(PyExc_OverflowError, "value too large to convert to long double");
            return (long double)-1;
        }
        return val;
    }
    else {
        return __pyx_PyInt_AsLong(x);
    }
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-07-02T15:58:44.650

一个观察：基于 pybindgen 开发人员进行的基准测试，boost.python 和 swig 之间没有显着差异。我还没有进行自己的基准测试来验证这有多少取决于正确使用 boost.python 功能。

另请注意，pybindgen 似乎通常比 swig 和 boost.python 快很多是有原因的：它*可能*不像其他两个那样产生通用的绑定。例如，异常传播、调用参数类型检查等。我还没有机会使用 pybindgen，但我打算这样做。

Boost 通常是一个相当大的安装包，最后我看到你不能只安装 boost python 你几乎需要整个 Boost 库。正如其他人所提到的，由于大量使用模板编程，编译会很慢，这也意味着在编译时通常会出现相当神秘的错误消息。

总结：鉴于 SWIG 的安装和使用非常简单，它生成了强大且通用的良好绑定，并且一个接口文件允许您的 C++ DLL 可以从其他几种语言（如 LUA、C# 和 Java）中使用，我更喜欢它超过了 boost.python。但除非你真的需要多语言支持，否则我会仔细研究 PyBindGen，因为它声称的速度，并密切关注它生成的绑定的稳健性和多功能性。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-01-20T13:56:30.973

这里有龙。不要痛饮，不要助长。对于任何复杂的项目，您必须自己填写以使其工作的代码很快就会变得难以管理。如果它是您的库的纯 C API（没有类），您可以只使用 ctypes。这将是简单和无痛的，您不必花费数小时浏览这些迷宫般的包装项目的文档，试图找到关于您需要的功能的一个小注释。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-26T05:07:53.243

由于您关心速度和开销，我建议考虑[PyBindGen](http://code.google.com/p/pybindgen/)。

我有使用它来包装大型内部 C++ 库的经验。在尝试了 SWIG、SIP 和 Boost.Python 之后，我更喜欢 PyBindGen，原因如下：

1.  PyBindGen 包装器是纯 Python，无需学习其他文件格式
2.  PyBindGen 直接生成 Python C API 调用，没有像 SWIG 那样抢速的间接层。
3.  生成的 C 代码简洁易懂。我也喜欢 Cython，但有时尝试读取它的 C 输出可能很困难。
4.  支持 STL 序列容器（我们使用了很多 std::vector 的）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-19T08:34:30.050

如果它不是一个大的扩展，boost::python 也可能是一个选项，它比 swig 执行得更快，因为你可以控制正在发生的事情，但它会花费更长的时间来开发。

无论如何，如果单个调用中的工作量足够大，swig 的开销是可以接受的。例如，如果您的问题是您有一些中等大小的逻辑块要移动到 C/C++，但该块在紧密循环中被调用，通常，您可能不得不避免痛饮，但我真的不认为除了脚本图形着色器之外的任何真实世界的示例。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-19T09:02:57.027

在放弃你的 python 代码之前，看看[ShedSkin](http://code.google.com/p/shedskin/)。他们声称在某些代码上比 Psyco 有更好的性能（并且还声明它仍处于试验阶段）。

否则，将 C/C++ 代码绑定到 python 有多种选择。

Boost 编译起来很长，但确实是最灵活和易于使用的解决方案。

我从未使用过 SWIG，但与 boost 相比，它不如通用绑定框架灵活，而不是专用于 python 的框架。

下一个选择是[Pyrex](http://www.cosc.canterbury.ac.nz/greg.ewing/python/Pyrex/)。它允许编写被编译为 C 扩展的伪 Python 代码。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-05-28T08:05:52.850

有一篇关于[Cython、pybind11、cffi 主题的文章值得一读——你应该选择哪个工具？](http://blog.behnel.de/posts/cython-pybind11-cffi-which-tool-to-choose.html)

不耐烦的快速回顾：

*   **Cython**将您的 python 编译为 C/C++，允许您将 C/C++ 嵌入到 python 代码中。使用静态绑定。对于python程序员。

*   **pybind11**（和 boost.python）正好相反。在编译时从 C++ 端绑定你的东西。对于 C++ 程序员。

*   **CFFI**允许您在运行时动态绑定本机内容。使用简单，但性能损失更高。

# jquery - 如何使用jQuery读取多级Json数据？

> ID：456887
> 
> 赞同：2
> 
> 时间：2009-01-19T08:32:49.007
> 
> 标签：jquery, json

这是我的 Json 数据：

```
[{"ok" : false,
  "details" : [{"n" : "Email",
                "v" : "The email address you entered is not correct."},
               {"n" : "NameFull",
                "v" : "Please enter your full name."}]
 }] 
```

我发现读取单级 Json 数据非常容易，但是对于像上面这样的多级数据，我无法通过搜索互联网找到答案。我只想阅读上述值。就像从“详细信息”下的“n”和“v”读取值一样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T08:45:49.137

**数据在数组中**

请注意数据周围的方括号。您必须在上述数据集中对数组进行索引。

这应该让您访问电子邮件值：

```
var json = '[{"ok":false,"details":[{"n":"Email","v":"The email address you entered is not correct."},{"n":"NameFull","v":"Please enter your full name."}]}]';

var k = eval( json );

alert( k[0].details[0].v ); 
```

这是出现的警告文本：

```
The email address you entered is not correct. 
```

也许您的 JSON 源将它放在一个数组中，因为他们想要返回多个元素？

实际上，您不需要 jQuery。JSON 代表 JavaScript 对象表示法。这基本上意味着它是一个 Javascript 代码块，可以直接在 JavaScript 中按原样评估以获取序列化数据，在您的情况下，它恰好是一个数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T08:39:29.163

对不起，也许我不明白你的问题。这对你不起作用？

`var data = eval('(' + strJson + ')');`

# .net - 如何设置 socket.connect() 调用的时间？

> ID：456891
> 
> 赞同：2
> 
> 时间：2009-01-19T08:33:25.603
> 
> 标签：.net, sockets, connect

我有一个连接到可能已关闭的主机的应用程序。如果主机关闭，我不想等待 30 秒左右的时间超时。我目前正在使用阻塞套接字。

我一直在查看 socket.poll() 和 socket.select() 但我宁愿在套接字上设置一个时间。我不介意这是否是我必须在系统中某处进行的设置。另外，我似乎理解 poll 和 select 不适用于面向连接的通信 - 这是正确的吗？

如果这绝对不可能，那么使用 poll、select 或其他一些技术获得我想要的结果的好方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T08:48:52.547

请参阅[BeginConnect](http://msdn.microsoft.com/en-us/library/system.net.sockets.socket.beginconnect.aspx)和[异步编程概述](http://msdn.microsoft.com/en-us/library/2e08f6yc(VS.71).aspx)

```
IAsyncResult asr = socket.BeginConnect( ip, port, null, null );

bool res = asr.AsyncWaitHandle.WaitOne( 10000, true );  // 10 sec timeout 
```

更新：这里有一个更好的[例子](http://channel9.msdn.com/forums/TechOff/41602-TcpClient-or-Socket-Connect-timeout/?CommentID=212796)。

# .net - 如何撤消 LINQtoSQL 中的更改集

> ID：456895
> 
> 赞同：4
> 
> 时间：2009-01-19T08:35:10.233
> 
> 标签：.net, linq-to-sql

在我的数据层类中，我创建了一个手动刷新数据源的函数。

```
Public Sub DiscardAllChanges()

    _Context.Refresh(RefreshMode.OverwriteCurrentValues)

End Sub 
```

问题是此操作之后的上下文**ChangeSet**仍然跟踪我之前手动调用的插入、删除和更新操作*InsertOnSubmit*等。

是否可以通过某种方式清除 ChangeSet？或者，如果没有，您能否建议我另一种解决方案？我必须在业务中创建一个 ChangeSet 层吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T09:41:21.787

处理此问题的最简单方法是将`DataContext`视为您的工作单元。在单个 上执行一组原子的相关操作`DataContext`，然后在成功或失败后，`Dispose()`它（理想情况下通过`using`）并将其丢弃。

开始你的下一组操作就一个新的`DataContext`。同样，您可以重新查询数据。

在逐个对象的基础上，您可以使用`GetOriginalEntityState`（在表格上）获取原始值，但您需要重新应用于“活动”对象，这不处理删除/插入情况.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T08:47:54.530

听起来你在尝试处理并发问题？这是您提交时，数据库已经更改导致您提交失败的地方。让我知道这是否是您的追求：

```
DataClasses1DataContext dc = new DataClasses1DataContext();
try
{
    dc.SubmitChanges(System.Data.Linq.ConflictMode.ContinueOnConflict);
}
catch (System.Data.Linq.ChangeConflictException ex)
{
    foreach (var conflict in dc.ChangeConflicts)
    {
        conflict.Resolve(System.Data.Linq.RefreshMode.KeepChanges);
    }
    dc.SubmitChanges();
} 
```

这种模式在并发问题上为您完成了繁重的工作。RefreshMode 具有重载，可以强制您进行更改，刷新除您的更改之外的最新值，或者让数据库覆盖您的更改。然后您可以再次提交。请注意，完全提交是一个递归过程，您随后调用提交更改也可能会失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-10T20:50:25.540

dc.Refresh(System.Data.Linq.RefreshMode.OverwriteCurrentValues, item);

# mysql - 在 MySQL 中同步两个数据库模式

> ID：456900
> 
> 赞同：19
> 
> 时间：2009-01-19T08:38:58.027
> 
> 标签：mysql, synchronization

我一直在寻找可以同步两个 MySQL 数据库模式的可移植脚本或命令行程序。我不是在寻找基于 GUI 的解决方案，因为它无法自动化或使用构建/部署工具运行。

基本上它应该做的是扫描database1和database2。检查模式差异（表和索引）并提出一堆 SQL 语句在一个上运行，以便它获得与另一个相似的结构，尽可能减少数据损坏。

如果有人可以指出实现此类解决方案的 PHP、Python 或 Ruby 包，我可以尝试从那里复制代码。

很多 MySQL GUI 工具可能可以做到这一点，但我正在寻找一个可编写脚本的解决方案。

编辑：抱歉没有更清楚：我正在寻找的是表结构中的同步，同时尽可能保持数据完整。不是数据复制。

更多信息：

为什么复制不起作用。

1.  安装基地遍布全州。
2.  我们希望安装程序根据最新版本中的 chagnes 对数据库执行动态修复，而不管最终用户可能使用的旧版本是什么。
3.  更改大多像向表添加新列，创建新索引或删除索引，添加表或删除系统内部使用的表（我们不删除用户数据表）。

如果是 GUI：不，不能使用。我们不想仅仅为了 DB diff 将 20MB 的应用程序与我们的安装程序捆绑在一起。特别是当原始安装程序小于 1 MB 时。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T08:43:06.897

您是否考虑过使用[MySQL 复制](http://dev.mysql.com/doc/refman/5.0/en/replication.html)？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-04-09T11:28:18.277

[SQLyog](http://www.webyog.com/)可以做到这一点，而且非常棒。我们经常在生产中使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T07:48:31.640

我知道这是一个老问题，但这是我在谷歌上搜索的第一个结果（与最初的问题完全相同）

我仍然在这里找到了答案，但我不记得 URL 它是从以下开始的脚本：

```
mysqldump --skip-comments --skip-extended-insert -u root -p dbName1>file1.sql
mysqldump --skip-comments --skip-extended-insert -u root -p dbName2>file2.sql
diff file1.sql file2.sql 
```

结果更像这样

```
#!/bin/sh

echo "Usage: dbdiff [user1:pass1@dbname1] [user2:pass2@dbname2] [ignore_table1:ignore_table2...]"

dump () {
  up=${1%%@*}; user=${up%%:*}; pass=${up##*:}; dbname=${1##*@};
  mysqldump --opt --compact --skip-extended-insert -u $user -p$pass $dbname $table > $2
}

rm -f /tmp/db.diff

# Compare
up=${1%%@*}; user=${up%%:*}; pass=${up##*:}; dbname=${1##*@};
for table in `mysql -u $user -p$pass $dbname -N -e "show tables" --batch`; do
  if [ "`echo $3 | grep $table`" = "" ]; then
    echo "Comparing '$table'..."
    dump $1 /tmp/file1.sql
    dump $2 /tmp/file2.sql
    diff -up /tmp/file1.sql /tmp/file2.sql >> /tmp/db.diff
  else
    echo "Ignored '$table'..."
  fi
done
less /tmp/db.diff
rm -f /tmp/file1.sql /tmp/file2.sql 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T00:00:44.947

对于长期、专业的解决方案，您应该关注 Schemamatic ( [http://versabanq.com/products/schemamatic.php](http://versabanq.com/products/schemamatic.php) )。此链接显示了一个 GUI 应用程序，但它所做的只是操作一个命令行软件。在此页面中，有指向其 google 代码站点的链接，可以在其中找到 C# .Net 版本的 Schemamatic。您的完美解决方案是将 MySQL 支持添加到 Schemamatic。对于 SQL Server，它非常完美，并且完全符合您的要求。

现在，对于短期解决方案，我建议使用 MySQL 的命令行工具转储您想要的数据，例如： mysqldump -A -c -uroot -ppassword >bkpmysql.sql

和它一起玩，虽然它需要相当长的时间来实现你想要的。在我看来，Schemamatic 确实是您的最佳选择。如果您在尝试 Schemamatic 时需要任何说明，请告诉我。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T00:20:14.920

[您可能想查看一些](http://dbdeploy.com/documentation/competition/)工具，例如[dbdeploy](http://dbdeploy.com/)（这是 java 或 .net 版本）和[liquidbase](http://www.liquibase.org/)等。

尽管我认为其中大多数会以受控方式将一组更改应用于数据库。不知道他们是否可以从现有模式进行逆向工程并进行比较。

E.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-20T06:12:57.663

检查这个是codeigniter数据库差异脚本生成器[![在此处输入图像描述](https://i.stack.imgur.com/17HmE.png)](https://i.stack.imgur.com/17HmE.png)

[https://github.com/vaimeo/ci-database-diff-generator](https://github.com/vaimeo/ci-database-diff-generator)

# wcf - wcf配置文件中的自定义ServiceHost？

> ID：456911
> 
> 赞同：0
> 
> 时间：2009-01-19T08:45:39.310
> 
> 标签：wcf, .net-3.5, servicehost

我想知道是否有办法在配置中指定自定义 ServiceHost（即 ServiceHost 派生类）？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T16:48:38.773

我认为您无需在配置文件中指定任何内容即可使用自定义 ServiceHost。我以前没有尝试过这样做，但是我在配置文件中看不到任何可以指定有关 ServiceHost 的信息的内容。

[这是 MSDN 上一个名为“ Custom Service Host](http://msdn.microsoft.com/en-us/library/aa395224.aspx) ”的网页。

希望其中一些有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-09T11:49:11.457

是的，我们也遇到了这种痛苦，我们希望在 ServiceHost 上有不同的端点，在客户端它已经死了，你只需在创建 ChannelFactory 时传入你想要的端点，但是在服务器端不是这样简单的。

我同意上述您需要创建自定义服务主机并覆盖 ApplyConfiguration() 方法。

这里有一个很好的例子：http: [//social.msdn.microsoft.com/forums/en-US/wcf/thread/3af366c1-3b11-42e6-85a4-ea63cd48be18/](http://social.msdn.microsoft.com/forums/en-US/wcf/thread/3af366c1-3b11-42e6-85a4-ea63cd48be18/)

希望能帮助到你

# regex - 用于查找具有表达式的方法的正则表达式

> ID：456914
> 
> 赞同：0
> 
> 时间：2009-01-19T08:46:59.587
> 
> 标签：regex

我尝试找到具有表达式 createNamedQuery 的方法

我试试

```
public[\d\D]*?createNamedQuery 
```

但它找到了第一种方法，但我想要具有表达式 createNamedQuery 的方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T09:07:54.803

我猜你的问题是你找不到所有这些，而只是第一个。检索所有这些的方法因语言而异。例如，在 Python 中，可以执行类似于以下的操作：

```
import re

my_data = "some long piece of data that may or may not contain what you're looking for."

for match in re.findall("public[\d\D]*?createNamedQuery", my_data):
    if m is not None:
        print "A match found at position %s" % m.start() 
```

基本上，只需尝试`FindAll`. 做单曲`Match`只会给你第一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T01:08:25.737

如果您试图找到以“public”开头并以“createNamedQuery”结尾的最短序列，那么使用非贪婪量词是不够的。这只会从“public”的第*一次*出现匹配到“createNamedQuery”的第一次（后续）出现。要找到最短序列，您必须确保两个标记（“public”和“createNamedQuery”）之间的部分不能再次匹配第一个标记。这是一种方法：

```
public(?:(?!public).)*?createNamedQuery 
```

这不是最快或最健壮的正则表达式，只是演示原理的最简单方法（我认为）。根据您使用的正则表达式风格，我将使用单词边界（大多数风格）和原子组（Perl、.NET）或所有格量词（Java、PHP、JGSoft）。

# sharepoint - SharePoint 要求

> ID：456916
> 
> 赞同：1
> 
> 时间：2009-01-19T08:47:50.303
> 
> 标签：sharepoint

我是 SharePoint 的新手。我需要一个工作流门户 Web 应用程序。请有人指导安装共享点以及在 SharePoint 中工作的硬件和软件要求是什么。

请让我知道 Windows SharePoint Services 或 MOSS2007 哪个更好用于创建 Web 应用程序门户

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T08:52:18.640

部署指南：[部署指南下载](http://technet2.microsoft.com/Office/logredir.aspx?MODE=CT&CTT=ToExternal&target=http%3A%2F%2Fgo.microsoft.com%2Ffwlink%2F%3FLinkId%3D79589%26clcid%3D0x409&referrer=http%3A%2F%2Ftechnet2.microsoft.com%2FOffice%2Fen-us%2Flibrary%2F8fe98aa3-23cd-4175-aa45-760e83e8a3bc1033.mspx&reldir=en-us%2Flibrary)

要求

*   WSS 3.0：[WSS 系统要求](http://technet.microsoft.com/en-us/library/cc288751.aspx)
*   MOSS 2007：[MOSS 系统要求](http://office.microsoft.com/en-us/sharepointserver/HA101945391033.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T08:55:45.043

根据您的需要，您需要 Windows SharePoint Services (WSS)，它像啤酒一样免费，可以从 Microsoft 下载，或者 Microsoft Office SharePoint Server (MOSS)，它不是免费的，包含 WSS 和“企业”功能，例如作为 Excel Server（用于对 Excel 工作表的 Web 访问）、Forms Server（用于 InfoPath）、许多站点模板和好东西以及所有商业智能的东西。

对于开发，您需要 Visual Studio 2005 或 2008，并且很可能需要 SharePoint SDK。

作为旁注，我从来没有能够在没有安装所有服务器东西的机器上编写 MOSS 工作流，所以我建议你使用 win2003 服务器 + sql 服务器 + 活动目录设置一个 vmware 或虚拟 PC 盒+ sharepoint 如果您必须开发工作流程。

至于系统要求，这完全取决于您的场景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T23:02:56.893

只要您拥有 Windows Server 2003 许可证，Windows SharePoint Services (WSS) 就免费。您可以使用 WSS 做很多事情，尤其是对于较小的公司来说可能足以满足他们的要求。

MOSS 2007 具有建立在 WSS 之上的额外功能，例如更具可扩展性的搜索架构、表单服务器等等。较大的公司很可能会为 MOSS 许可证支付额外费用。

如果您的公司介于两者之间，那么您需要通过 MOSS 的成本/收益来满足您的要求。

哪个更好的答案类似于对许多其他事情提出相同的问题 - 哪个更好，红色还是蓝色？- 这取决于。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-24T17:47:17.607

以下是我遇到的一些非常好的文章：

[Miscrosft 的 SharePoint 容量规划工具执行概述（这个非常好！）](http://technet.microsoft.com/en-us/library/bb961988.aspx)

[Dell 的 SharePoint 2007 规模调整指南 (PDF)（非常好）](http://www.dell.com/downloads/global/services/sharepoint_2007_sizing_guide_v2.pdf)

[SharePoint 容量规划关键信息（由 Joel Oleson 提供，有很多链接）](http://blogs.msdn.com/joelo/archive/2007/07/09/capacity-planning-key-links-and-info.aspx)

[SharePoint 2007 硬件规格和服务器规模](http://geekswithblogs.net/MainaD/archive/2007/10/17/116101.aspx)

[确定硬件和软件要求 (Office SharePoint Server)](http://technet.microsoft.com/en-us/library/cc262485.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T14:53:25.917

还有一个*免费*的 WSS 搜索插件，称为**[Search Server Express](http://www.microsoft.com/enterprisesearch/serverproducts/searchserverexpress/features.aspx)**，可以帮助您。

# language-agnostic - 用户输入的递归——优雅还是奇怪？

> ID：456919
> 
> 赞同：1
> 
> 时间：2009-01-19T08:48:36.993
> 
> 标签：language-agnostic, recursion

Dev-cpp 附带一个示例程序 Jackpot，其中有一个 GetResults 函数：

```
void
GetResults ()
{
   .
   .
   .

     else if (i>j)
     {
        cout << "Too BIG\n";
        life = life - 1;    // -1 to the user's "life"
        cout << "Number of remaining life: " << life << "\n\n";
        GetResults();
     } 
```

这是一种反复询问用户输入的优雅方式吗？`do-while`当然，它比用循环环绕大约 20 行更具可读性。我倾向于喜欢它，但我不经常看到这样的东西，所以我不确定。你怎么看？

**编辑：** *在你的例子中，递归深度被生命的数量所阻止，所以这看起来不错，因为它不会大于 1000 甚至 100* - 这正是我考虑它的原因，但现在我可以看到它是相当愚蠢的想法:)我想知道谁把它放在一个*示例程序*中......

感谢您的输入！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T08:51:49.670

这肯定会导致堆栈溢出，所以不应该这样做！取决于堆栈大小，您可以多久执行一次，但它肯定会崩溃。在您的示例中，生命数阻止了递归深度，因此这看起来不错，因为它不会大于 1000 甚至 100，但您通常不应该使用它。

我也不同意可读性，因为缩进有助于识别 while 循环内的块，但递归对于这样的任务非常罕见，我认为它经常会使人们感到困惑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T08:53:20.277

这不是一个好方法，除非您想测试应用程序的堆栈大小。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T08:54:41.660

不！坏的！

这根本不是好的设计。最好的方法是将它包装在调用者的 while 循环中。IE

```
int input = 0;
while (GetInt(&input))
{
    if (input > something)
    {
        cout << "Too big";
        life--;
    }
    else
        break;
} 
```

有没有想过 StackOverflow 是什么？尝试输入一个对于编写代码的方式来说太大的数字，您会发现:)

# c# - IIS 中有没有 ASP.NET 网站管理工具？

> ID：456921
> 
> 赞同：13
> 
> 时间：2009-01-19T08:50:20.610
> 
> 标签：c#, asp.net, visual-studio-2008, iis

我正在使用 asp.net 网站管理工具来管理我项目中的不同角色（目前是客户和管理员）。在开发过程中，在 vs 2008 中，角色管理非常容易。（项目-> Asp.Net 配置）。部署系统 (IIS) 时如何管理我的角色和用户？是否可以在 IIS 上运行“asp.net web 管理工具服务”？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-09T14:09:58.283

本文介绍了如何创建一个，包括您可以直接嵌入到您的网站中的代码：

[http://aspnet.4guysfromrolla.com/articles/053007-1.aspx](http://aspnet.4guysfromrolla.com/articles/053007-1.aspx)

本文介绍如何在 IIS 上运行 ASP.NET 配置网站管理工具：http: [//blogs.msdn.com/rahulso/archive/2006/03/09/547402.aspx](http://blogs.msdn.com/rahulso/archive/2006/03/09/547402.aspx)

更新：这是 MVC3/Razor 中的一个非常基本的示例：http: [//www.mikepope.com/blog/DisplayBlog.aspx? permalink=2240#Create_a_page_to_manage_roles](http://www.mikepope.com/blog/DisplayBlog.aspx?permalink=2240#Create_a_page_to_manage_roles)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T08:54:52.957

据说，开发人员打算使用 Visual Studio 网站管理工具来管理网站。前端这些东西没有开箱即用的 Web 界面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T12:41:36.387

如果您使用的是 SQL Server 实例，而不是 APP_DATA 中的映射数据库文件，您可以使用 ASP.Net 配置工具，方法是临时更改数据库的连接字符串以指向您的实时数据库而不是本地数据库 - 这将启用您可以编辑角色/用户等。

但是，这是您可能应该考虑编写/查找工具来正确编辑/管理这些的领域之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-12T05:58:18.057

您可以在 IIS 中创建应用程序，您只知道 Web 管理工具的方向（C:\Windows\Microsoft.NET\Framework64\v4.0.30319\ASP.NETWebAdminFiles）

您现在应该注意的另一点是 URL 中需要两个参数。

例如： [http://localhost/PMIS-Security/default.aspx?applicationPhysicalPath=C](http://localhost/PMIS-Security/default.aspx?applicationPhysicalPath=C) :\PMIS&applicationUrl=/PMIS

applicationPhysicalPath=C:\PMIS applicationUrl=/PMIS

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-19T03:41:20.693

你可以使用仆人。在这里获取它[http://servant.io/](http://servant.io/)只需将其安装在您的服务器上就可以了

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-07T03:19:08.810

试试这个 ASP.NET 网站管理工具 [http://sourceforge.net/projects/wsatudri/](http://sourceforge.net/projects/wsatudri/)

# windows-xp - 压力客户端：限制XP中的并发连接数

> ID：456923
> 
> 赞同：1
> 
> 时间：2009-01-19T08:51:05.773
> 
> 标签：windows-xp, connection, stress-testing

我的网站有一个网络服务器，我正在尝试对其进行压力测试，但我似乎无法做到。我认为问题在于XP（Pro）中的并发连接数量有限。

我用 C# 编写了一个简单的客户端进行压力测试：

```
...

for (int i = 0; i < _numThread; i++)
{

 Thread t = new Thread(CallGetHttp);

 t.Start(); 

}

...

private void CallGetHttp()

{

WebRequest wrGETURL;
 wrGETURL = WebRequest.Create(_url);

 WebProxy myProxy = new WebProxy("myproxy", 80);
 myProxy.BypassProxyOnLocal = true;

 wrGETURL.Proxy = WebProxy.GetDefaultProxy();

 Stream objStream;
 objStream = wrGETURL.GetResponse().GetResponseStream();

 StreamReader objReader = new StreamReader(objStream);

 ..
} 
```

这合适吗？如果是这样，我怎样才能增加并发连接数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T09:05:56.490

连接限制在入站套接字上，它被硬编码到 XP 的网络堆栈中，以防止它们被用作服务器（微软更多的钱......）如果你在微软堆栈上，你唯一的选择是移动到 Windows Server，或者合法移动如果您的代码支持它，请转到 linux。如果您没有做任何太具体的事情，请查看单声道。

还要小心落入虚拟PC陷阱。microsoft virtual PC 的网络访问是通过 XP 网络堆栈进行的。因此，如果您在 XP 中的 VM 中运行 linux，您仍然受限于 10 个入站连接。

# java - 使用内存超过 70% 的代码

> ID：456926
> 
> 赞同：1
> 
> 时间：2009-01-19T08:52:11.777
> 
> 标签：java, c++, python, c

请告诉我使用内存超过 70% 的 C++/Java 代码。

例如，我们有 3 个虚拟机，在内存资源中，我们希望
根据用户分配的内存资源来测试内存利用率。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T09:00:13.383

哪个内存？在 64 位平台上，一个 64 位进程可以使用远远超过 4GB。在达到这些限制之前，您将需要数小时才能完成交换。

如果您想测试“70% 的物理 RAM”，您可能会发现无法分配 32 位地址空间的 70%。操作系统已经认领了一大笔款项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T08:58:28.517

```
#include malloc.h
#DEFINE MB 512
void main(int argc, char **argv)
{
    int i;
    for (i = 0; i < MB; i++)
    {
        malloc(1024* 1024);
    }
    getchar();
} 
```

按回车键释放内存，将 MB 常量设置为您希望程序占用的内存量。

我的 C 有点生疏，所以如果有人来这里踩我，1000 道歉，我的强项是 C#。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T06:24:40.403

我想测试内存利用率，但在执行代码后我无法测试。

因为我是新手，所以在这方面帮助我更多。

让我们有 3 个虚拟机 V1,V2,V3

对于 V1 - 将共享资源设置为高

对于 V2 - 将共享资源设置为正常

对于 V3 - 将共享资源设置为正常

所以这意味着总共是 2 GB，然后 V1 获得 1 GB，V2、V3 获得 512 MB。因此，如果有人更改共享或保留或限制，我想使用编程进行测试，然后它是如何工作的。

# javascript - JavaScript 中的哈希表

> ID：456932
> 
> 赞同：44
> 
> 时间：2009-01-19T08:54:35.657
> 
> 标签：javascript, hashtable

我在 JavaScript 中使用哈希表，我想在哈希表中显示以下值

```
one   -[1,10,5]
two   -[2]
three -[3, 30, 300, etc.] 
```

我找到了以下代码。它适用于以下数据。

```
 one  -[1]
   two  -[2]
   three-[3] 
```

如何将 one-[1,2] 值分配给哈希表以及如何访问它？

```
<script type="text/javascript">
    function Hash()
    {
        this.length = 0;
        this.items = new Array();
        for (var i = 0; i < arguments.length; i += 2) {
            if (typeof(arguments[i + 1]) != 'undefined') {
                this.items[arguments[i]] = arguments[i + 1];
                this.length++;
            }
        }

        this.removeItem = function(in_key)
        {
            var tmp_value;
            if (typeof(this.items[in_key]) != 'undefined') {
                this.length--;
                var tmp_value = this.items[in_key];
                delete this.items[in_key];
            }
            return tmp_value;
        }

        this.getItem = function(in_key) {
            return this.items[in_key];
        }

        this.setItem = function(in_key, in_value)
        {
            if (typeof(in_value) != 'undefined') {
                if (typeof(this.items[in_key]) == 'undefined') {
                    this.length++;
                }

                this.items[in_key] = in_value;
            }
            return in_value;
        }

        this.hasItem = function(in_key)
        {
            return typeof(this.items[in_key]) != 'undefined';
        }
    }

    var myHash = new Hash('one',1,'two', 2, 'three',3 );

    for (var i in myHash.items) {
        alert('key is: ' + i + ', value is: ' + myHash.items[i]);
    }
</script> 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-01-19T09:43:32.217

使用上面的函数，你会做：

```
var myHash = new Hash('one',[1,10,5],'two', [2], 'three',[3,30,300]); 
```

当然，以下也可以工作：

```
var myHash = {}; // New object
myHash['one'] = [1,10,5];
myHash['two'] = [2];
myHash['three'] = [3, 30, 300]; 
```

因为 JavaScript 中的所有对象都是哈希表！然而，它会更难迭代，因为 using`foreach(var item in object)`也会让你获得它的所有功能等，但这可能就足够了，这取决于你的需要。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-01-19T09:47:05.223

如果您只想在查找表中存储一些静态值，则可以使用[Object Literal](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Values,_variables,_and_literals#Object_literals)（与[JSON](http://json.org)使用的格式相同）紧凑地执行此操作：

```
var table = { one: [1,10,5], two: [2], three: [3, 30, 300] } 
```

然后使用 JavaScript 的关联数组语法访问它们：

```
alert(table['one']);    // Will alert with [1,10,5]
alert(table['one'][1]); // Will alert with 10 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-07-08T22:05:59.720

你可以使用我的 JavaScript 哈希表实现，[jshashtable](http://www.timdown.co.uk/jshashtable/)。它允许将任何对象用作键，而不仅仅是字符串。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-07-25T19:48:40.383

Javascript 解释器本机将对象存储在哈希表中。如果您担心原型链的污染，您可以随时执行以下操作：

```
// Simple ECMA5 hash table
Hash = function(oSource){
  for(sKey in oSource) if(Object.prototype.hasOwnProperty.call(oSource, sKey)) this[sKey] = oSource[sKey];
};
Hash.prototype = Object.create(null);

var oHash = new Hash({foo: 'bar'});
oHash.foo === 'bar'; // true
oHash['foo'] === 'bar'; // true
oHash['meow'] = 'another prop'; // true
oHash.hasOwnProperty === undefined; // true
Object.keys(oHash); // ['foo', 'meow']
oHash instanceof Hash; // true 
```

# java - 在 Java 中，您将如何编写可能引发异常的 Iterable 等价物？

> ID：456935
> 
> 赞同：5
> 
> 时间：2009-01-19T08:55:01.800
> 
> 标签：java, exception

在 java 中，一个类可以实现 Iterable，它允许您使用 foreach() 语句和迭代语法糖：

```
for(T t:ts) ... 
```

但是，这不允许您在构造迭代器时抛出异常。如果您正在迭代网络、文件、数据库等，那么能够抛出异常会很好。明显的候选者是 java.io.InputStream、Reader 和 java.nio.Channel 代码，但这些都不能像 Iterable 接口那样使用泛型。

这种情况是否有通用的成语或Java API？

澄清：这是询问是否存在用于从非内存源迭代对象的模式或替代接口。正如响应者所说，仅抛出 RuntimeExceptions 来解决问题是不推荐的，也不是我想要的。

编辑2：感谢到目前为止的答案。共识似乎是“你不能”。那么我可以将问题扩展到“在这种情况下你会做什么，这种情况什么时候有用？” 只写自己的界面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T09:21:16.227

像网络这样的流在传统意义上并不是真正可迭代的。数据可以随时通过，所以每个循环都有一个 for each 循环是没有意义的。

对于文件读取或数据库快照（如选择查询），您没有理由不能获取该数据，将其分割成逻辑块并实现可迭代接口。

如果这是一个问题，您还可以首先调用一个将捕获任何异常的初始化方法。

```
try{
   ts.initializeIOIterator();
}catch(...)

for(T t:ts)
... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T10:01:10.153

不幸的是你不能。有两个问题：

*   Iterator API 没有声明要抛出的任何异常，因此您必须抛出 RuntimeExceptions（或非异常可抛出对象）
*   增强的 for 循环不做任何尝试在循环结束时释放资源

这很烦人。例如，在 C# 中，您可以很容易地编写代码来遍历文本文件的行：

```
public static IEnumerable<string> ReadLines(string filename)
{
    using (TextReader reader = File.OpenText(filename))
    {
        string line;
        while ( (line=reader.ReadLine()) != null)
        {
            yield return line;
        }
    }
} 
```

用于：

```
foreach (string line in ReadLines("foo.txt")) 
```

foreach 循环在 finally 块中调用`Dispose`，`IEnumerator`它转换为“检查我们是否需要在迭代器块的 finally 中执行任何操作（来自 using 语句）”。显然 C# 中没有检查异常，所以这方面的事情也不是问题。

由于这个原因，一个完整的（有用的！）习语在 Java 中几乎是行不通的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T10:19:44.347

您可以做的最好的事情是创建 RuntimeIOException，如果出现错误，您将从 hasNext/next 实现中抛出该异常。

```
try {
  for (...) {
    // do my stuff here
  }
catch (RuntimeIOException e) {
  throw e.getCause(); // rethrow IOException
} 
```

RuntimeIOException 将是运行时异常，包装您的 IOException：

```
class RuntimeIOException extends RuntimeException {
  RuntimeIOException(IOException e) {
    super(e);
  }

  IOException getCause() {
    return (IOException) super.getCause();
  }
} 
```

有时没有其他办法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T09:03:00.850

我会说你不能，即使你可以，你也可能不应该。你从这些东西中得到字节，如果它们在 for 循环中使用，每个字节可能最终都会被装箱。

您可以做的是将已检查的异常包装在未检查的异常中并遵守可迭代接口，尽管这也是不可取的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T10:52:29.020

`RuntimeException`通常在这种情况下，我会在 Iterable 的实现中抛出一个适当的子类。

在清理资源方面，`try - finally`块的工作原理与包装 foreach 块的效果一样好，就像它围绕任何其他代码位一样，因此从客户端的角度来看，它可以轻松地使用它来清理任何资源。如果您想在 Iterable 中管理资源，则可能会比较棘手，因为没有明显的生命周期起点和终点。

在这种情况下，您可能做的最好的事情是按需创建资源（即第一次调用`next()`），然后在调用即将返回*时*销毁它们，*或者*在. 这样做当然意味着当你的 next() 方法因异常退出时，迭代器就不能再使用了——这不是一个不合理的约束（考虑到异常是更容易出错的返回版本），但它是您应该记录，因为界面并未严格涵盖这一点。`next()``false`*`next()``false`*

 *也就是说，上面假设您只是将某些东西创建*为*可迭代对象。我发现在实践中，当我在一个类上实现 Iterable 时，它​​更像是一个“超级getter”（即客户方便地访问存储在其中的信息的一种方式），而不是类本身的重点。大多数情况下，这些对象将独立设置并通过其他方法访问，因此它们的生命周期可以完全独立于它们作为 Iterable 的存在进行管理。

这似乎与问题无关，但问题的直接答案很简单（“使用运行时异常”） - 棘手的部分是在存在这些异常的情况下保持适当的状态。

# macos - 是否可以将多个命令添加到 readline .inputrc 文件？

> ID：456936
> 
> 赞同：5
> 
> 时间：2009-01-19T08:55:38.413
> 
> 标签：macos, unix, readline

我正在尝试配置我的终端，我想一键插入**@{}**。这适用于以下代码

```
# .inputrc
"\e\"": "@{}" 
```

但我也希望光标在大括号内结束。我怎样才能做到这一点？以下不起作用。

```
# .inputrc
"\e\"": "@{}": backward-char 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T17:24:51.633

尝试：

```
"\e\"": "@{}\e[D" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T10:38:36.773

我解决您的总体目标的直接方法（不是真正回答您的问题，但希望对您有所帮助）：为它编写一个 bash 别名或函数。grev() 也许，或类似的东西 - 至少，如果我处于你的情况，这就是我会做的。

但是，我很想知道您最初提出的问题是否可行，因此请投票支持您的问题，希望您能得到“真正的答案”！

# workflow-foundation - WF - 创建选择性列表

> ID：456938
> 
> 赞同：0
> 
> 时间：2009-01-19T08:55:51.440
> 
> 标签：workflow-foundation

我有一个愚蠢的问题。我创建了一个工作流设计器主机，我在其中发布了我自己的活动。我还有一个属性网格，它只显示用特殊属性装饰的属性。该设计器不会被任何 IT 人员使用。

我想要的是在活动中用户可以从列表中选择一个属性值。我知道我可以创建一个枚举，但我希望它是动态的。即特定接口上的所有事件（使用反射提取）。

这完全有可能还是我被枚举困住了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T09:06:47.863

好的，我再次设法提出一个问题，然后自己找到答案。

答案是 TypeConverter。

# sql - SQL 查询 - 太慢有多慢？

> ID：456940
> 
> 赞同：6
> 
> 时间：2009-01-19T08:57:03.077
> 
> 标签：sql

对于可合理实现的 SQL 查询速度，您有任何正式或非正式的标准吗？你如何执行它们？假设一个生产 OLTP 数据库在每秒几十个查询的完全实际生产负载下，正确配备和配置。

用于说明目的的个人示例（不是建议，高度取决于许多因素，有些超出您的控制范围）：

期待：

每个事务单元（单个语句、从开始到结束事务边界的多个 SQL 语句或单个存储过程，以最大者为准）必须平均在 1 秒或更短时间内执行，没有异常异常值。

解析度：

较慢的查询必须优化为标准。报告和其他分析的慢查询被移动到 OLAP 多维数据集（最佳情况）或静态快照数据库。

（显然某些执行查询（插入/更新/删除）无法移动，因此必须进行优化，但到目前为止，根据我的经验，它是可以实现的。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T09:31:43.990

鉴于您不能期望系统上的确定性性能（至少在理论上）会受到瞬态负载峰值的影响，您希望性能 SLA 是概率性的。这方面的一个例子可能是：

95% 的交易在 2 秒内完成。
95% 的搜索查询（更适合搜索屏幕）在 10 秒内完成。
95% 的运营报告在 10 秒内完成。

事务和搜索查询无法从事务系统中移出，因此您可以采取的唯一措施是调整数据库或应用程序，或者购买更快的硬件。

对于运营报告，您需要对符合运营报告的条件毫不留情。只有*绝对*需要访问最新数据的报告才应该在实时系统之外运行。执行大量 I/O 的报告在生产系统上是非常反社会的，并且规范化的模式对于报告来说往往效率很低。将不需要实时数据的任何报告移至数据仓库或其他一些单独的报告设施。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T17:05:52.700

在编写/重构存储过程时，我通常遵循一秒规则，尽管我的工作场所对此没有任何具体规则。这只是我的常识。经验告诉我，如果执行一个不执行任何大容量插入的过程需要 10 秒或更长的时间，那么代码中通常会出现很容易纠正的严重问题。

我在 SP:s 中遇到的最常见问题是性能较差的索引使用不正确，导致索引查找操作代价高昂。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T21:11:10.723

N 中的 O 是好的，像 N^2 这样更糟糕的东西最终会太慢。

# recursion - 易递归算法的迭代版本

> ID：456942
> 
> 赞同：3
> 
> 时间：2009-01-19T08:57:58.363
> 
> 标签：recursion, iteration

我想我有一个很简单的问题。我有这个问题，可以用递归函数很容易地解决，但我无法迭代地解决。

假设您有任何布尔矩阵，例如：

男：

```
111011111110
110111111100
001111111101
100111111101
110011111001
111111110011
111111100111
111110001111 
```

我知道这不是一个普通的布尔矩阵，但它对我的示例很有用。你可以注意到那里有某种零路径......

我想创建一个函数来接收这个矩阵和一个存储零的点，并将同一区域中的每个零转换为 2（假设矩阵可以存储任何整数，即使它最初是布尔值）

（就像在 Paint 或任何图像编辑器中绘制区域时一样）

假设我用这个矩阵 M 和右上角零坐标调用函数，结果将是：

```
111011111112
110111111122
001111111121
100111111121
110011111221
111111112211
111111122111
111112221111 
```

好吧，我的问题是如何迭代地做到这一点......希望我没有把它搞砸太多

提前致谢！

曼努埃尔

ps：如果您能用 C、S、python 或伪代码显示该函数，我将不胜感激：D

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T09:13:20.080

有一种标准技术可以将特定类型的递归算法转换为迭代算法。它被称为[尾递归](http://en.wikipedia.org/wiki/Tail_recursion)。

此代码的递归版本看起来像（伪代码 - 没有边界检查）：

```
paint(cells, i, j) {
   if(cells[i][j] == 0) {
      cells[i][j] = 2;
      paint(cells, i+1, j);
      paint(cells, i-1, j);
      paint(cells, i, j+1);
      paint(cells, i, j-1);
   }
} 
```

这不是简单的尾递归（不止一个递归调用），因此您必须添加某种堆栈结构来处理中间内存。一个版本看起来像这样（伪代码，java-esque，再次，没有边界检查）：

```
paint(cells, i, j) {
    Stack todo = new Stack();
    todo.push((i,j))
    while(!todo.isEmpty()) {
       (r, c) = todo.pop();
       if(cells[r][c] == 0) {
          cells[r][c] = 2;
          todo.push((r+1, c));
          todo.push((r-1, c));
          todo.push((r, c+1));
          todo.push((r, c-1));              
       }          
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T09:04:04.717

伪代码：

```
Input: Startpoint (x,y), Array[w][h], Fillcolor f

Array[x][y] = f
bool hasChanged = false;
repeat
  for every Array[x][y] with value f:
    check if the surrounding pixels are 0, if so:
      Change them from 0 to f
      hasChanged = true
until (not hasChanged) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T09:10:05.030

为此，我将使用 Stack ou Queue 对象。这是我的伪代码（类似 python）：

```
stack.push(p0)
while stack.size() > 0:
    p = stack.pop()
    matrix[p] = 2
    for each point in Arround(p):
       if matrix[point]==0:
          stack.push(point) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T09:10:19.227

将递归函数转换为迭代函数的最简单方法是利用堆栈数据结构来存储数据，而不是通过递归调用将其存储在*调用堆栈中。*

伪代码：

```
var s = new Stack();

s.Push( /*upper right point*/ );

while not s.Empty:

    var p = s.Pop()        
    m[ p.x ][ p.y ] = 2

    s.Push ( /*all surrounding 0 pixels*/ ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-19T09:19:16.010

并非所有递归算法都可以转换为迭代算法。通常只有具有单个分支的线性算法可以。这意味着具有两个或多个分支的树算法和具有更多路径的 2d 算法在不使用堆栈的情况下极难转换为递归（这基本上是作弊）。

例子：

递归：

```
listsum: N* -> N
listsum(n) ==
  if n=[] then 0 
          else hd n + listsum(tl n) 
```

迭代：

```
listsum: N* -> N
listsum(n) ==
  res = 0;
  forall i in n do
    res = res + i
  return res 
```

递归：

```
treesum: Tree -> N
treesum(t) ==
  if t=nil then 0
  else let (left, node, right) = t in
    treesum(left) + node + treesum(right) 
```

部分迭代（尝试）：

```
treesum: Tree -> N
treesum(t) ==
  res = 0
  while t<>nil 
    let (left, node, right) = t in
      res = res + node + treesum(right)
      t = left
  return res 
```

如您所见，有两条路径（左和右）。可以将这些路径之一转换为迭代，但要将另一个转换为迭代，您需要保留可以使用堆栈完成的状态：

迭代（带堆栈）：

```
treesum: Tree -> N
treesum(t) ==
  res = 0

  stack.push(t)
  while not stack.isempty()
    t = stack.pop()
    while t<>nil 
      let (left, node, right) = t in
        stack.pop(right)
        res = res + node + treesum(right)
        t = left

  return res 
```

这可行，但递归算法更容易理解。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T10:58:14.487

如果迭代执行比性能更重要，我会使用以下算法：

1.  设置初始 2
2.  扫描矩阵以在 2 附近找到 0
3.  如果找到这样的 0，请将其更改为 2，然后在步骤 2 中重新开始扫描。

这很容易理解并且不需要堆栈，但是非常耗时。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-03T22:27:31.700

迭代地执行此操作的一种简单方法是使用队列。

1.  将起点插入队列
2.  从队列中获取第一个元素
3.  设置为 2
4.  将所有仍为 0 的邻居放入队列
5.  如果队列不为空，则跳转到 2。

# c++ - 检查基类指针类型的最佳方法是什么？

> ID：456951
> 
> 赞同：1
> 
> 时间：2009-01-19T09:02:13.253
> 
> 标签：c++, pointers

我想知道一个基类指针的运行时类型，我知道你可以使用dynamic_cast。有没有更好的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-19T09:19:08.103

dynamic_cast 只会证实你的猜测，即使这样也不完美。如果 C 继承自 B 继承自 A，`dynamic_cast<B*>((A*)&theC)`则将起作用。`typeid`会给你实际的类型，但在某种程度上对任何事情都不太有用。例如，您不能创建相同类型的新对象。

所以，剩下的 biq 问题就是你的真正目标是什么。在正确的 OO 设计中，您永远不需要知道可以从基类型派生的无限类型集。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T09:11:02.610

操作员会这样做[`typeid`](http://msdn.microsoft.com/en-us/library/fyf39xec(VS.80).aspx)。它[`type_info`](http://msdn.microsoft.com/en-us/library/70ky2y6k(VS.80).aspx)在恒定时间内为您提供对对象的恒定引用。

还可以在 devx.com 上查看[typeid 与 dynamic_cast<>的性能。](http://www.devx.com/tips/Tip/5496)

# asp.net - Asp.net 在开发时是否让调试服务器保持打开状态？

> ID：456957
> 
> 赞同：1
> 
> 时间：2009-01-19T09:06:14.557
> 
> 标签：asp.net

我是 ASP.net 的新手，但不是 C#、.net 或 Web 开发的新手。

在 PHP 中，每当我进行更改时能够直接进入浏览器并刷新，这真是太好了。然而，将 ASP.net 与 VS08 一起使用似乎有点尴尬。

我应该启动开发服务器并保持打开状态，在进行更改时刷新浏览器，还是应该在编辑代码之间关闭开发服务器？

抱歉，如果这听起来很愚蠢，但我只是不确定这里的“接受”做法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T09:08:06.923

使用 Cassini 进行开发时，我总是让它运行，因为它可以节省我想要调试的启动时间。这样做并没有什么坏处，它总是会反映当前构建的 DLL 并且运行良好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T09:12:54.917

从 Visual Studio 转到浏览器时，您有两种选择。第一种是通过按 F5 并运行它来调试应用程序。第二种是选择“在浏览器中查看”命令（或使用键盘快捷键 Ctrl+Shift+W）。后者不将调试器附加到 Web 服务器，这使得它比调试快得多，但不支持诸如代码隐藏断点或在未处理的 asp.net 异常时中断代码之类的东西。

为了实现最快的开发，请尽量减少 Web 服务器的启动次数以及将调试器附加到 Web 服务器的次数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T21:24:24.237

我启动我的开发服务器，然后让它一直运行。我没有关闭开发服务器，而是分离了调试器，当我需要单步执行代码时，我再次附加它。这给了我两全其美的好处：节省了我的 Web 服务器启动时间，并且大部分时间都可以快速运行页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T21:31:28.310

我什至使用 IIS 进行开发，因此根本没有“启动”Web 服务器。话虽如此，当我微调 HTML、Ajax 调用或背后的代码时，我通常会在我正在处理的代码和浏览器窗口之间使用 alt-tab。*更大的更改需要重新启动，当您必须*重新启动时，您将收到一条消息，指出代码不再与网站同步（在异常期间）。

底线：您可以在 ASP.NET 应用程序中运行时进行调试，只要您可以摆脱它，这是调整软件的有效方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T09:10:30.740

取决于我处于什么发展阶段。

如果我要添加大量文件（在调试模式下无法执行的操作）、更改 App_Code 中的大量代码（这将重置应用程序）或从工具箱中添加大量组件，那么我倾向于关闭调试.

一旦我开始积极调试一个站点，我就会尽可能地保持它处于打开状态。

# asp.net - 在 JavaScript 中验证日期

> ID：456964
> 
> 赞同：1
> 
> 时间：2009-01-19T09:08:00.043
> 
> 标签：asp.net, javascript, validation, date

我需要对日期字段进行用户验证，它的格式应为*yyyyMMdd*，并且未来不应超过一年。我该怎么做呢？目前我只有一个粗略的正则表达式，这是不够的。

```
function VerifyDate(source, args)
{
    var regexp = /^([1-2]{1}[0-9]{1})\d{2}([0][1-9]|[1][0-2])([0][1-9]|[1-2][0-9]|[3][0-1])$/
    var result = args.Value.match(regexp);     
    if(result) {
        args.IsValid = true;
    } else {
        args.IsValid = false;
    }       
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T09:29:06.320

使用正则表达式仅检查格式。你可以保持简单：

```
^(\d{4})(\d{2})(\d{2})$ 
```

然后解析日期并检查范围：

```
function VerifyDate(source, args)
{
  args.IsValid = false;
  var regexp = /^(\d{4})(\d{2})(\d{2})$/;
  var daysInMonth = function (y, m) {return 32-new Date(y, m, 32).getDate(); };

  var ma = regexp.exec(args.Value);
  if (ma && ma.length == 4 && ma[2] < 12 && ma[3] <= daysInMonth(ma[1], ma[2]))
  {
    var diff = new Date(ma[1], ma[2], ma[3]) - new Date();
    args.IsValid = diff < 31536000000; // one year = 1000ms*60*60*24*365
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T10:33:54.473

如果月份或日期超出范围，new Date() 不会抛出异常。它使用内部 MakeDay 来计算日期（参见[ECMAScript 语言规范](http://www.ecma-international.org/publications/standards/Ecma-262.htm)第 15.9.3.1 和 15.9.1.13 节）。为了确保日期在下面的函数中有效，将输入转换为整数，然后将其转换为日期，然后将日期的部分与整数进行比较。

由于日期使用 MakeDay，因此即使*现在是睡眠日，* *maxDate*的计算也有效（xxxx0229 将是 yyyy0301，其中 yyyy=xxxx+1）

 *```
function verifyDate(args)
{
    var result=false,
        match = args.Value.match(/^(\d{4})(\d{2})(\d{2})$/);
    if (match && match.length === 4)
    {
        var year = parseInt(match[1],10),
            month =parseInt(match[2],10) -1, // 0 = January
            day = parseInt(match[3],10),
            testDate= new Date(year,month,day),
            now = new Date(),
            maxDate = new Date(now.getFullYear() + 1, now.getMonth(), now. getDate()),
            minDate = new Date(1800,0,1),
            result = (
                 testDate.getFullYear() === year &&
                 testDate.getMonth() === month &&
                 testDate.getDate() === day &&
                 testDate >= minDate &&
                 testDate <= maxDate
            );
   }
   args.IsValue = result;
   return result;   
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T12:40:46.137

我最终采用的解决方案是结合了您的答案，我使用了 datejs，这看起来很不错。这是我的最终验证功能。由于某种原因，该月似乎使用了基于 0 的索引，所以这就是它在 .set() 中显示 -1 的原因。

```
function VerifyDate(source, args)
{
    args.IsValid = false;
    var regexp = /^(\d{4})(\d{2})(\d{2})$/;
    var m = regexp.exec(args.Value);
    if (m && m.length == 4) {
        try {
            var result = Date.today().set({ year: Number(m[1]), month: Number(m[2]-1), day: Number(m[3]) });
            if (result < Date.today().add({ years: 1 })) {
                args.IsValid = true;
            }
        }
        catch (ex) {
        }
    }
} 
```

# html - 默认值我有一个带有两个“特殊”选项的选择，有点像这样：<select> <option value="????">选择一个：</option> <option value="1">option1< /option> <option value="2">option2</option> .... <option value="????">自由输入</option> </selec

> ID：456966
> 
> 赞同：1
> 
> 时间：2009-01-19T09:08:15.580
> 
> 标签：html, html-select

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T09:11:35.713

我会使用下一个将要阅读代码的开发人员可以理解的东西。因此，像“freeInput”或“textFieldLookupValue”这样的东西可能是合适的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T09:15:33.647

如果您的其余选项具有数值，请为特殊选项选择具有“说话值”的非数值。

这样，服务器逻辑可以通过一个简单的`IsNumeric()`调用来决定要做什么，您以后可以自由添加其他特殊选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-19T09:12:15.980

为什么不使用“免费”和“无”。您不限于整数值，因此使用描述性值会提高可理解性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T09:15:06.987

您如何处理您的数据？

在 C# 中，我将定义一个常量来表示 ID，并使用它来标识它。

```
public string CONSTANT_OPTION_FreeInput = "-1";

// Test for value in a different method:
if (selectedValue == CONSTANT_OPTION_FreeInput) {
  // Do Stuff
} 
```

你也可以用其他语言做类似的事情。

无论您使用什么值，只要确保您自己和将来查看代码的任何其他开发人员都能轻松理解它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T09:15:23.727

在第一个上，您甚至不需要`value`存在该属性。无论如何，它都不会在服务器端设置。

关于免费输入选择，我会简单地选择`free_input`.

当然，这一切都取决于你。只需选择有意义且与其目的相关的东西。`;-)`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T09:15:24.053

将第一个选项设为选项组，然后对“免费输入”不使用任何值。选项组不可选择。

# javascript - 轻松设置“this”变量？

> ID：456967
> 
> 赞同：142
> 
> 时间：2009-01-19T09:09:08.217
> 
> 标签：javascript, variables, scope, this

我对 Javascript 有很好的理解，除了我想不出一种设置“this”变量的好方法。考虑：

```
var myFunction = function(){
    alert(this.foo_variable);
}

var someObj = document.body; //using body as example object
someObj.foo_variable = "hi"; //set foo_variable so it alerts

var old_fn = someObj.fn;   //store old value
someObj.fn = myFunction;   //bind to someObj so "this" keyword works
someObj.fn();              
someObj.fn = old_fn;       //restore old value 
```

如果没有最后 4 行，有没有办法做到这一点？这很烦人......我尝试绑定一个匿名函数，我认为它既漂亮又聪明，但无济于事：

```
var myFunction = function(){
    alert(this.foo_variable);
}

var someObj = document.body;        //using body as example object
someObj.foo_variable = "hi";        //set foo_variable so it alerts
someObj.(function(){ fn(); })();    //fail. 
```

显然，将变量传递给 myFunction 是一种选择......但这不是这个问题的重点。

谢谢。

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2009-01-19T09:20:33.577

JavaScript 中为所有函数定义了两种方法[`call()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call)， 和[`apply()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply)。函数语法如下所示：

```
call( /* object */, /* arguments... */ );
apply(/* object */, /* arguments[] */); 
```

这些函数所做的是调用它们被调用的函数，将*对象*参数的值分配给**this**。

```
var myFunction = function(){
    alert(this.foo_variable);
}
myFunction.call( document.body ); 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-01-19T09:19:05.013

我想你正在寻找[`call`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/call)：

```
myFunction.call(obj, arg1, arg2, ...); 
```

这调用`myFunction`设置`this`为`obj`。

还有一种稍有不同的方法[`apply`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)，它将函数参数作为一个数组：

```
myFunction.apply(obj, [arg1, arg2, ...]); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-07-08T18:57:41.243

如果您想将`this`值“存储”到函数中以便以后可以无缝调用它（例如，当您不再有权访问该值时），您可以`bind`这样做（但并非在所有浏览器中都可用）：

```
var bound = func.bind(someThisValue);

// ... later on, where someThisValue is not available anymore

bound(); // will call with someThisValue as 'this' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-14T06:32:06.310

我对如何绑定的搜索`this`把我带到了这里，所以我发布了我的发现：在“ECMAScript 2015”中，我们还可以使用箭头函数将其设置为词法。

请参阅：[https ://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/Arrow_functions](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Functions/Arrow_functions)

代替：

```
function Person() {
  setInterval(function growUp() {
    // The callback refers to the `self` variable of which
    // the value is the expected object.
    this.age++;
  }.bind(this), 1000);
} 
```

我们现在可以这样做：

```
function Person(){
  this.age = 0;

  setInterval(() => {
    this.age++; // |this| properly refers to the person object
  }, 1000);
}

var p = new Person(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-07T13:30:42.507

## 在javascript中设置`this`关键字。

Javascript 有 3 种内置方法可以`this`方便地设置关键字。它们都位于`Function.prototype`对象上，因此每个函数都可以使用它们（因为每个函数都通过原型继承从这个原型继承）。这些功能如下：

1.  `Function.prototype.call()`：此函数将您要使用的对象`this`作为第一个参数。然后其余的参数是被调用函数的各自参数。
2.  `Function.prototype.apply()`：此函数将您要使用的对象`this`作为第一个参数。然后第二个参数是一个数组，其中包含被调用函数的参数值（数组的第一个元素是函数的第一个参数，数组的第二个参数是函数的第二个参数等）。
3.  `Function.prototype.bind()`: 这个函数返回一个新函数，它的值不同`this`。它将您要设置为`this`值的对象作为第一个参数，然后返回一个新的函数对象。

## 调用/应用和绑定之间的区别：

*   `call`并且`apply`相似之处在于它们**立即调用函数**（具有预定义的值`this`）
*   `bind``call`与此函数不同`apply`的是，此函数**返回一个**具有不同值绑定的新函数`this`。

## 例子：

```
const thisObj = {
  prop1: 1,
  prop2: 2,
};

function myFunc(arg1, arg2) {
  console.log(this.prop1, this.prop2);
  console.log(arg1, arg2);
}

// first arg this obj, other arguments are the  
// respective arguments of the function
myFunc.call(thisObj, 'Call_arg1', 'Call_arg2');

// first arg this obj, other argument is an array which  
// are the respective arguments of the function
myFunc.apply(thisObj, ['Apply_arg1', 'Apply_arg2']);

// the bind method returns a new function with a different
// this context which is stored in the newMyFunc variable
const newMyFunc = myFunc.bind(thisObj);

// now we can call the function like a normal function 
newMyFunc('first', 'second');
```

# apache-flex - 移动被底层 Papervision3D 视口混淆的 Flex GUI 窗口

> ID：456978
> 
> 赞同：1
> 
> 时间：2009-01-19T09:14:10.390
> 
> 标签：apache-flex, actionscript-3, user-interface, papervision3d, flex2

`TitleWindow`我正在开发一个 Flex 2 应用程序，我注意到当你用鼠标拖动它们时负责移动 GUI 窗口 (s) 的库的一部分如果`buttonMode = true`它们下面有一个可点击的 () 精灵会感到困惑。当我说困惑时，我的意思是窗口正常移动了一段时间，但在某些时候“跳”到了 Flash 应用程序的左上角，并在那里进行了非常小的移动。然后在另一个点它跳回来。解释比体验更难，所以请自己去看看。以下是重现问题的方法：

1.  访问[http://www.panocast.com](http://www.panocast.com)
2.  在左侧边栏中，选择“房地产”
3.  在 Flash 窗口的右下角，单击最右侧的图标选择“高分辨率”。
4.  当（部分）视频加载时，单击楼梯。将弹出一个标题窗口。
5.  尝试在屏幕上拖动它。当鼠标光标移到可点击区域之一（如楼梯）上方时，窗口会错位。

（抱歉，不能直接给你链接，部分页面是动态生成的。）

（让问题更有趣的是，对我来说，在“低分辨率”模式下，问题不会发生！各种模式之间几乎没有区别。）如果有人告诉我这里发生了什么，我将不胜感激以及如何修复它。

我不确定它是否重要，但底层精灵实际上不仅仅是普通精灵，而是一个 Papervision3D 渲染器对象，其中包含一些 3D 元素。我之所以这么说，是因为不正确的鼠标坐标可能来自映射在可点击对象上的纹理 UV。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T15:46:49.397

我也设法在低分辨率模式下复制了它，所以我认为它与分辨率无关。

这看起来是因为 MouseEvent 正在由 TitleWindow 和 Papervision3D 窗口处理。也许您需要在其中一个上强制 stopImmediatePropagation() ？或者当 TitleWindow 弹出时关闭 Pv3D 窗口的 MouseEvent 处理？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-19T17:51:01.937

没有源代码很难调试。有些东西显然在调用 move() 或在 TitleWindow 上设置 x 和 y 属性并安排它被移动。

当我第一次阅读这篇文章时，它“闻起来”像是某个地方的旋转错误计算（使用 Math.atan 与 Math.atan2 有时会产生这种效果），所以你是对的，它可能与 PaperVision 有关，假设您没有在任何地方使用 Math.atan 或自己设置旋转属性。只是想我会提到它，尽管在您的情况下可能不会发生。不过，你永远不知道。;)

LayoutManager 更有可能移动组件以响应组件上的属性更改。 [Flex 文档解释](http://livedocs.adobe.com/flex/2/langref/mx/core/UIComponent.html#event:move)说，除了设置其 x 和 y 属性以及显式调用 move() 之外，当以下任何其他属性发生更改时，也可以触发UIComponent 的**移动事件：**

*   最小宽度
*   最小高度
*   最大宽度
*   最大高度
*   显式宽度
*   显式高度

PaperVision 与否，也许该信息可以帮助您隔离移动的来源。祝你好运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T11:02:10.357

我想通了。显然，这是一个 Papervision3D 问题。Papervision3D 内部有一个名为 的类`VirtualMouse`，它应该以`MouseEvent`编程方式生成 s。例如，当用户与舞台上的任何交互式对象交互时，就会发生这种情况，例如，上面`Plane`有交互式材料（如我的例子）。

问题是生成事件的 x 和 y 坐标代表纹理 UV 坐标（正如我所怀疑的那样），而不是真实世界的屏幕坐标。当一个`TitleWindow`（或任何`Panel`对象）被拖动时，一个“mouseMove”处理程序（以及其他）被添加到`SystemManager`，然后使用事件对象的`stageX`和`stageY`属性来确定窗口的新位置。不幸的是，对于`VirtualMouse`的鼠标事件，这些是无效的，因为可能用于确定全局舞台坐标的原始 x,y 坐标，正如我所说的，**不是屏幕坐标**。

老实说，我仍然不确定由`VirtualMouse`Papervision3D 内部的任何地方是否使用派发的事件，或者它们只是为了方便而提供，但它们确实使得将视口集成到 Flex 程序中变得困难。假设 PV3D 本身不需要此类事件，我的问题有一个单行修复，必须在创建视口后立即添加：

```
viewport.interactiveSceneManager.virtualMouse.
    disableEvent(MouseEvent.MOUSE_MOVE); 
```

顺便说一句，拖动滑块有一个非常相似（或者更确切地说是相同）的错误，也由这条线修复。

# c# - Microsoft Reporting：在代码中设置子报表参数

> ID：456982
> 
> 赞同：10
> 
> 时间：2009-01-19T09:15:15.020
> 
> 标签：c#, reporting-services, parameters, reporting, subreport

如何设置子报表的参数？我已经成功连接到 SubreportProcessing 事件，我可以通过 e.ReportPath 找到正确的子报表，我可以通过 e.DataSources.Add 添加数据源。但是我找不到添加报告参数的方法？？

我发现有人建议将它们添加到主报告中，但我真的不想这样做，因为主报告根本不必连接到子报告，除了它正在包装子报告。

我使用一个报表作为主模板，打印报表名称、页码等。子报表将是报表本身。如果我只能找到一种方法来设置子报告的那些报告参数，我会很高兴......

***澄清：****创建/定义参数不是问题。问题是设置它们的值。我认为自然的做法是在 SubreportProcessing 事件中进行。而且 SubreportProcessingEventArgs 实际上有一个 Parameters 属性。但它是只读的！那么你如何使用它呢？如何设置它们的值？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-25T02:32:30.010

它确实有效，但它肯定是挑剔的。

我建议的第一件事是将您的报告开发为 .rdl。以这种方式测试报告要容易得多。您还可以将子报表参数设置和测试为 rdl，确保子报表的每个参数也定义为父报表的参数。一旦您获得报告（包括子报告）以这种方式工作，您可以将 .rdl 重命名为 rdlc 并将 rdlc 文件添加到您的 ReportViewer 项目中。无需进一步更改。使用 rdl 数据源的名称作为代码中的数据源名称，以向 SubreportProcessing 事件处理程序中的报表提供数据。

您不会为传递的参数赋值。子报表将按原样使用它们。（听起来您缺少的步骤是将参数添加到父报表以及上面提到的子报表。）您可以评估参数并将它们用作查询参数以获取您将添加的数据源。您必须考虑数据源，就像它在子报表的未发现维度上一样。在事件处理程序中调试时，您将不得不四处寻找以了解我的意思。您的应用程序中的某些值将很容易获得，而您在其他地方轻松使用的其他值将引发 object not found 异常。例如，我在应用程序主窗体上创建的类的实例中创建数据集。我在整个应用程序中使用数据集。在 SubreportProcessing 事件处理程序中，我不能使用公共数据集，所以我必须为报告创建一个我需要的表的新实例并填充它。在主报告中，我将能够访问公共数据集。还有其他类似的限制。只需要涉水而过。

这是来自工作中的 VB.NET ReportViewer 应用程序的 SubreportProcessing 事件处理程序。显示获取子报表数据源的几种不同方法。subreport1 从应用程序业务对象构建单行数据表，subreport2 提供报表所需的数据，不带参数，subreport3 是 subreport2，但会评估传递给子报表的参数之一，以便在创建 ReportDataSource 的查询所需的日期值中使用。

```
 Public Sub SubreportProcessingEventHandler(ByVal sender As Object, _
                                               ByVal e As SubreportProcessingEventArgs)
    Select Case e.ReportPath
        Case "subreport1"
            Dim tbl As DataTable = New DataTable("TableName")
            Dim Status As DataColumn = New DataColumn
            Status.DataType = System.Type.GetType("System.String")
            Status.ColumnName = "Status"
            tbl.Columns.Add(Status)
            Dim Account As DataColumn = New DataColumn
            Account.DataType = System.Type.GetType("System.String")
            Account.ColumnName = "Account"
            tbl.Columns.Add(Account)
            Dim rw As DataRow = tbl.NewRow()
            rw("Status") = core.GetStatus
            rw("Account") = core.Account
            tbl.Rows.Add(rw)
            e.DataSources.Add(New ReportDataSource("ReportDatasourceName", tbl))
        Case "subreport2"
            core.DAL.cnStr = My.Settings.cnStr
            core.DAL.LoadSchedule()
            e.DataSources.Add(New ReportDataSource("ScheduledTasks", _
                                                   My.Forms.Mother.DAL.dsSQLCfg.tSchedule))
        Case "subreport3"
            core.DAL.cnStr = My.Settings.cnStr
            Dim dt As DataTable = core.DAL.GetNodesForDateRange(DateAdd("d", _
                                                                          -1 * CInt(e.Parameters("NumberOfDays").Values(0)), _
                                                                          Today), _
                                                                  Now)
            e.DataSources.Add(New ReportDataSource("Summary", dt))
    End Select
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-25T13:20:18.897

最近我遇到了同样的问题，通过所有的搜索我没有发现任何有用的东西，但最终我找到了解决方案。

我创建了一个类，其中包含子报表中的所有参数作为它的属性（我们可以将其称为 DTO）

```
public class MyDto
{
    public string EmployeeFirstName{get; set;}
    public string EmployeeLastName{get; set;}
    // and so on
} 
```

然后在主报表中使用这种类型的列表作为另一个数据源，然后在“子报表属性”中为实际子报表中的每个参数添加一个参数，并从数据源中选择相应的字段作为它们的值。

![添加子报表参数](https://i.stack.imgur.com/AtPBV.jpg)

然后在加载报告时将输入（员工列表）转换为 MyDto 列表并将其设置为报告的数据源：

```
private void LoadReport(List<Employee> employees)
{
    reportviewerMain.ProcessingMode = ProcessingMode.Local;
    reportviewerMain.LocalReport.ReportPath = Application.StartupPath + "\\Reports\\PayChecksReport.rdlc";

    List<MyDto> employeesDataSource = employees.ConvertAll<MyDto>(emp => new MyDto { EmployeeFirstName = emp.FirstName, EmployeeLastName = emp.LastName}).ToList();
    reportviewerMain.LocalReport.DataSources.Add(new ReportDataSource("EmployeesDataSet", employeesDataSource));

    Organization myOrganization = new OranizationFacade().GetOrganizationInfo();
    reportviewerMain.LocalReport.SetParameters(new ReportParameter("OrganizationName", myOrganization.Name));

    this.reportviewerMain.RefreshReport();
} 
```

和...

它对我有用:) 我希望它对某人有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-01T21:31:20.273

我知道这是一个已被标记为已回答的老问题，但由于我今天只是在搜索这个问题，并且我看到它在过去几个月内已经被评论过，我想我会提出一个后续答案。

为了在主报表上的每条记录的上下文中呈现子报表，您需要声明一个`SubreportProcessingEventHandler`，然后在该处理程序中为子报表的每个实例加载数据集，因为它发生。`SubreportProcessingEventArgs`有一个参数集合，该集合在事件触发时从父报表传递。

因此，如果您已在主报表上配置了子报表参数，并在主报表上的字段上绑定了类似的命名参数，则在呈现子报表时可以访问这些值。

[这](http://www.codeproject.com/Articles/473844/Using-Custom-Data-Source-to-create-RDLC-Reports)是一篇非常好的文章，解释得更清楚。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-17T01:26:40.667

我有一个类似的问题，我需要传递一个 Properties.Settings.... 值来添加到数据库中的路径。为此，我必须在主报表中设置一个属性，并使用该属性在子报表中设置第二个属性。设置主属性，然后依次设置子报表属性。您可以在代码中设置 main 属性，如下所示：

假设您有一个 ReportViewer 名称 rv，那么我们将编写代码：

```
var rp = new ReportParameter("MainReportParamName", Properties.Settings....);
rv.LocalReport.SetParameters(new ReportParameters[] { rp }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T02:55:40.933

您可以通过 xml 定义添加它们。我使用 xml 根据选定的子报告和其他选项创建整个报告。如果您想将其视为可能的解决方案，我可以在星期一在这里粘贴一些代码。

编辑：您可以在部署报表之前在 XML 中的子报表上设置值。这不是很灵活，我假设如果您想提示这些值，您很可能在父报表中需要它们。

如果您想查看 XML 的样子，请添加一个子报表，在子报表属性 > 参数中为其输入值，然后执行查看代码。

```
<Subreport Name="subreport1">
    <Parameters>
      <Parameter Name="StartDate">
        <Value>=Parameters!StartDate.Value</Value>
      </Parameter>
      <Parameter Name="EndDate">
        <Value>1/1/2009</Value>
      </Parameter> 
```

而不是使用 =Parameters!StartDate.Value 我猜你会想要在 EndDate 上放置一个实际值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-22T08:42:32.370

看了又看，得出的结论是，在代码中设置子报表的参数是不可能的。除非你做一些花哨的事情，比如在加载之前开始编辑报告定义的 xml 或类似的东西。

（但如果其他人知道我错了，请回答，因为我仍然很想知道！）

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-11T16:23:07.507

Svish - 我不确定您在管道的哪一侧遇到问题。

要将参数添加到父报表打开它，然后右键单击子报表并选择属性 > 参数。

然后，您可以定义参数名称并为其分配一个值，例如

```
Parameter Name | Parameter Value
---------------+---------------------
MyParameter    | =Fields!Params.Value 
```

因此，在管道的这一侧，参数从父报表数据源获取它们的值。

要将参数添加到子报表，请打开子报表并从工具栏中选择报表 > 报表参数

在这里定义一个参数来接收来自父报表的参数，例如

```
Name      | myParameter
----------+---------------------
Data Type | String 
```

对于听起来你想做的事情，难道你不能取消子报告而只拥有一份报告吗？您试图在报告中包含的信息听起来非常适合仅包含在报告的页眉和页脚中。

# background-service - 为什么 update at-startup-background-update-services 存在？

> ID：456987
> 
> 赞同：2
> 
> 时间：2009-01-19T09:16:42.397
> 
> 标签：background-service

[我认为winrot](http://www.urbandictionary.com/define.php?term=Winrot)的主要原因之一是在启动时运行（并且不关闭）的服务数量之多，每隔 x 秒就会打电话回家，看看是否有某个软件的新版本。

就我个人而言，我禁用了它们中的每一个，因为它们对我来说似乎完全没用。大多数使用这些东西的软件包都可以选择在您启动程序本身时检查更新。这对我来说看起来更有效率。

我在问自己，像 Adob​​e 和 Apple 这样的公司为什么要创建这样的服务，让客户的计算机陷入瘫痪，同时增加他们自己的更新服务器的负担，因为在我看来，这两者都没有什么回报价值他们。

我的客户要求提供这样的服务，但我看不出有任何理由。我想确保我没有遗漏任何一块拼图，这样我就可以就为什么应该或不应该成为所需的功能提出有根据的意见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-19T09:23:46.627

管理层通常希望获得品牌认可。它是这样的：

> 不好了。如果我们的程序只是完成它的工作，用户将永远不会看到它的存在，他们也永远不会知道我们是谁，以及我们是一家多么棒的公司。
> 
> 我们需要托盘中的图标；我们需要在桌面、快速启动工具栏中以及“开始”菜单的顶层有一个快捷方式。如果我们可以添加一个控制面板小程序，在 Windows Explorer 的右键菜单中添加一个项目，在 Internet Explorer 中添加一个图标，那就太棒了。
> 
> 当然，由于我们的程序非常重要，用户会经常使用它。让我们添加一个在启动时运行的“加速”程序，以确保我们所有的二进制文件和依赖项都预加载到缓存中。
> 
> 哦，我们需要一个自动更新程序，以确保所有这些组件都像我们能做到的那样出色。
> 
> 你也可以在上面放一个闪屏吗？

你能说我很苦吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-19T13:09:34.067

罗杰的位置。

另外，一旦一个应用程序发展到它已经拥有了你可以期望它为它的预期目的覆盖的所有功能，供应商就会陷入困境。他们需要不断推出令人兴奋的新版本，因此范围膨胀会蔓延。与其把一件事做好并让开，我们必须做与它相关的所有事情。我们必须始终面对用户；绝不允许他们使用不属于我们的软件；他们必须始终与我们的品牌互动。当然，我们必须注意始终在后台启动更新程序任务，因为我们添加了一个完全不必要的面向 Internet 的浏览器插件/工具栏/ActiveX 东西，肯定会出现安全漏洞。

获取性软件是一个巨大的问题，它正在稳步降低 Windows 上的用户体验。这是一场军备竞赛：微软隐藏旧的应用程序界面界面（弃用经典的开始菜单、删除快速启动、隐藏系统托盘图标、自动删除不活动的桌面图标），因为它们充满了获取性软件垃圾，基本上是无法使用，同时引入了“会更好”的新产品。但是，应用程序开始“有用地”将自己添加到“开始”菜单的 MRU 列表（因为您肯定会经常使用我们出色的软件！）并将自己固定到 Windows 7 扩展坞需要多长时间？

Linux 在这里做得更好，因为发行版拥有对用户的访问权限，并且不会忍受任何这些废话。不幸的是，微软无法逃脱。

您知道吗？有趣的事实：曾几何时，Nero 是一个不错的、优雅的 CD 刻录工具。**********````